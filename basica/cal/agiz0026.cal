|FICHEROS;
     agiz0026 #0;

     agifigen #1;
     agim0019 #19;
     agim0047 #47;
     agim0056 #56;

     refen00@ #900;
|FIN;

|VARIABLES;

     &eaPathContasoc = "";
     &eaPrograma     = "";
     &eaExtension    = "";

     nSwContasoc     = 0;
     nLinea          = 0;
     aAlfa           = "";
     nNume1          = 0;
     aDef00          = "";
     aPathDef        = "";
     aPathFic        = "";
     nSwError        = 0;
     nSw             = 0;
     nRegistro       = 0;
|FIN;

|| ------------------------------------------------------------------
|PROCESO CargarSoc;
   aDef00   = "";
   nSwError = 0;
   aPathDef = eaPathContasoc + "def/";
   aPathFic = eaPathContasoc + "fich/";

   aDef00 = aPathDef + "cuacceso";
   |CARGA_DEF aDef00, refen00@;
   |SI FSalida ! 0;
       |MENAV "     Error en Cargar el Def cuacceso";
       nSwError = 1;
       aDef00   = "";
   |SINO;
       |PATH_DAT #900 aPathFic
   |FINSI;
|FPRC;

|PROCESO DesCargarSoc;
    |SI aDef00 ! "";
        |DESCARGA_DEF #refen00@; aDef00 = "";
    |FINSI;
|FPRC;

|| ------------------------------------------------------------------
|PROCESO ActualizaSoc;
   #900#3  = #19#27;
   #900#21 = #19#91;
   |GRABA 020#900a;
   |LIBERA #900;
|FPRC;

|DEFBUCLE ActualizaSoc;
    #900#1002;
    ;
    #1#0, 2010;
    #1#0, 2099;
    be;
    NULL, ActualizaSoc;
|FIN;

|PROCESO  LeoRegistrador;
      nSw   = 0;
      |DDEFECTO #47;
      #47#0 = nRegistro;
      |LEE 001#47=;
      |SI FSalida = 0;
          nSw = 1;
      |FINSI;
|FPRC;

|| ------------------------------------------------------------------
|PROCESO agifigen;

  nLinea = 0;
  #19#0 = #1#0;
  #19#1 = 99;
  |LEE 040#19];
  |SI FSalida = 0;
      |LEE 141#19a;
  |SINO;
      |LEE 141#19u;
  |FINSI;
  |SI FSalida = 0; |Y #1#0 = #19#0;
      nLinea = #19#1;
  |FINSI;

  |SI nLinea ! 0;
      nSw       = 0;
      nRegistro = #19#53;
      |HAZ LeoRegistrador;
      |SI nSw = 1;
          #19#25 = #47#1;
          #19#27 = #47#4;
          #19#91 = #47#5;
          |GRABA 020#19a;
      |FINSI;
      |SI nSwContasoc = 1; |Y nSwError = 0;
          |BUCLE ActualizaSoc;
      |FINSI;
  |FINSI;
  |LIBERA #19;
|FPRC;

|DEFBUCLE agifigen;
    #1#1;
    ;
    00001;
    99999;
    be;
    NULL, agifigen;
|FIN;

|| ==================================
|PROCESO ComM0047;
    nNume1 = nNume1 + 1;
|FPRC;

|DEFBUCLE ComM0047;
    #47#1;
    5;
    01, "     ";
    99, "     ";
    e;
    NULL, ComM0047;
|FIN;
||===================================

|PROCESO Tipo3;  |TIPO 3;

      |HAZ eVerRegMer;

      |SI #0#0 = "SI";
          |HAZ BusquedaApli;
          |SI eaPathContasoc ! ""; nSwContasoc = 1; |FINSI;

          nNume1 = 0;
          |BUCLE ComM0047;
          |SI nNume1 ! 0;
              |CONFI "    NNo estan completos los datos en los Reg. Mercantiles. Continuar";
              |SI FSalida ! 0;
                  |ACABA;
              |FINSI;
          |FINSI;

          |SI nSwContasoc = 1;
              |HAZ CargarSoc;
          |FINSI;

          |ABRE #47;
          |ABRE #19;
          |BUCLE agifigen;
          |CIERRA #19;
          |CIERRA #47;

          |SI nSwContasoc = 1;
              |HAZ DesCargarSoc;
          |FINSI;
     |FINSI;
|FPRC;
