|FICHEROS;
     agim0010;

     :/dsarchi/def/dsarm001;
     :/dsarchi/def/dsarm002;
     :/dsarchi/def/dsarm003;
     :/dsarchi/def/dsarm004;
|FIN;

|VARIABLES;
      nArchi     = 0;
      nHandle    = 0;

      aBase      = "";
      aMas       = "";
      aAlfa      = "";
      aFich      = "";
|FIN;

|PROCESO Tipo0C8;  |TIPO 0;
     |C_M #agim0010#9, 1, "S";
     |SI #agim0010#8 = "N";
         |C_M #agim0010#9, 1, "N";
         #agim0010#9 = 0;
     |FINSI;

     |PINTA #agim0010#9;
|FPRC;

|PROCESO Tipo66C2;  |TIPO 66;
     |ABRE #dsarm002;
     #dsarm002#0 = #agim0010#2;
     |LEE 000#dsarm002.=;
     |CONSULTA_CLAVE #1#dsarm002;
     |SI FSalida = 0;
         #agim0010#2 = #dsarm002#0;  |PINTA #agim0010#2;
         #agim0010#5 = #dsarm002#1;  |PINTA #agim0010#5;
     |FINSI;
     |CIERRA #dsarm002;
|FPRC;

|PROCESO Tipo0C2;  |TIPO 0;
     |C_M #agim0010#2, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |ABRE #dsarm002;
     #dsarm002#0 = #agim0010#2;
     |LEE 000#dsarm002.=;
     |SI FSalida ! 0;
         |MENAV "0000No existe el grupo";
         |ERROR;
     |SINO;
         #agim0010#5 = #dsarm002#1;

         |SI #dsarm001#8 = "N";
             #agim0010#3 = 1;
             #agim0010#4 = 1;
             #agim0010#6 = "";
             #agim0010#7 = "";
         |FINSI;
     |FINSI;
     |CIERRA #dsarm002;

     |PINTA #agim0010#3;
     |PINTA #agim0010#4;
     |PINTA #agim0010#5;
     |PINTA #agim0010#6;
|FPRC;

|PROCESO Baja3;
     #dsarm003#0 = #agim0010#2;
     #dsarm003#1 = 1;
|FPRC;

|PROCESO Alta3;
     #dsarm003#0 = #agim0010#2;
     #dsarm003#1 = 999;
|FPRC;

|PROCESO Tipo66C3;  |TIPO 66;
     |ABRE #dsarm003;
     #dsarm003#0 = #agim0010#2;
     #dsarm003#1 = #agim0010#3;
     |LEE 000#dsarm003.=;
     |CONSULTA_F_CLAVE #1#dsarm003, Baja3, Alta3;
     |SI FSalida = 0;
         #agim0010#3 = #dsarm003#1;  |PINTA #agim0010#3;
         #agim0010#6 = #dsarm003#2;  |PINTA #agim0010#6;
     |FINSI;
     |CIERRA #dsarm003;
|FPRC;

|PROCESO Tipo0C3;  |TIPO 0;
     |C_M #agim0010#3, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |ABRE #dsarm003;
     #dsarm003#0 = #agim0010#2;
     #dsarm003#1 = #agim0010#3;
     |LEE 000#dsarm003.=;
     |SI FSalida ! 0;
         |MENAV "0000No existe el subgrupo";
         |ERROR;
     |FINSI;
     |CIERRA #dsarm003;

     #agim0010#6 = #dsarm003#2;  |PINTA #agim0010#6;
|FPRC;

|PROCESO Baja4;
     #dsarm004#0 = #agim0010#2;
     #dsarm004#1 = #agim0010#3;
     #dsarm004#2 = 1;
|FPRC;

|PROCESO Alta4;
     #dsarm004#0 = #agim0010#2;
     #dsarm004#1 = #agim0010#3;
     #dsarm004#2 = 999;
|FPRC;

|PROCESO Tipo66C4;  |TIPO 66;
     |ABRE #dsarm004;
     #dsarm004#0 = #agim0010#2;
     #dsarm004#1 = #agim0010#3;
     #dsarm004#2 = #agim0010#4;
     |LEE 000#dsarm004.=;
     |CONSULTA_F_CLAVE #1#dsarm004, Baja4, Alta4;
     |SI FSalida = 0;
         #agim0010#4 = #dsarm004#2;  |PINTA #agim0010#4;
         #agim0010#7 = #dsarm004#3;  |PINTA #agim0010#7;
     |FINSI;
     |CIERRA #dsarm004;
|FPRC;

|PROCESO Tipo0C4;  |TIPO 0;
     |C_M #agim0010#4, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |ABRE #dsarm004;
     #dsarm004#0 = #agim0010#2;
     #dsarm004#1 = #agim0010#3;
     #dsarm004#2 = #agim0010#4;
     |LEE 000#dsarm004.=;
     |SI FSalida ! 0;
         |MENAV "0000No existe el tipo";
         |ERROR;
     |FINSI;
     |CIERRA #dsarm004;

     #agim0010#7 = #dsarm004#3;  |PINTA #agim0010#7;
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     nArchi = 0;

     |DBASS aBase;
     aMas = aBase + "dsarchi/def/dsarm001.mas";
     |XABRE "E", aMas, nHandle;
     |SI FSalida ] 0;
         nArchi = 1;
     |FINSI;

     |C_M #agim0010#2, 1, "N";
     |C_M #agim0010#3, 1, "N";
     |C_M #agim0010#4, 1, "N";
     |C_M #agim0010#7, 1, "N";
     |C_M #agim0010#8, 1, "N";
     |C_M #agim0010#9, 1, "N";

     |SI nArchi = 0;  |ACABA;  |FINSI;

     aFich = aBase + "dsarchi/fich/";
     |PATH_DAT #dsarm001#aFich#;
     |PATH_DAT #dsarm002#aFich#;
     |PATH_DAT #dsarm003#aFich#;
     |PATH_DAT #dsarm004#aFich#;

     |ABRE #dsarm001;
     |LEE 000#dsarm001.p;
     |SI FSalida ! 0;  |DDEFECTO #dsarm001;  |FINSI;
     |CIERRA #dsarm001;

     |C_M #agim0010#8, 1, "S";
     |C_M #agim0010#9, 1, "S";

     |SI #dsarm001#8 = "S";
         |C_M #agim0010#2, 1, "S";
         |C_M #agim0010#3, 1, "S";
         |C_M #agim0010#4, 1, "S";
     |SINO;
         |C_M #agim0010#2, 1, "S";
     |FINSI;
|FPRC;
