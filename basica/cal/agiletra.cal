|FICHEROS;
    agiletra #0;
    agifigen #1;
    agicen03 #4;
    agicen15 #5;
    agicen06 #6;
    agicen11 #31;
    agicen13 #33;

    agim0003 #13;
    agim0004 #14;
    agim0021 #21;
    agim0024 #24;
    agim0025 #25;
    agim0026 #26;
    agim0027 #27;
    agirefer #28;
    agim0028 #29;

    agim0016 #99;
    agiw0029 #100;

    &provinc@ #700;
|FIN;

|VARIABLES;
     xxx       = 0;
     Valfa     = "";

     &eaVarDni  = "";
     &enCalcCif = 0;
     &enCodProv = 0;
|FIN;

|INCLUYE i_ficher;

|PROCESO Pinta;
  #0#1 = #0#1 + 1;
  |PINTA #0#1;
|FPRC;

|PROCESO empresas;   || viene del bucle de empresas y va a calcular
  |HAZ Pinta;
  eaVarDni = #1#13;  |HAZ CalculoDNI;
  #1#13 = eaVarDni;
  |GRABA 140#1a;
  |LIBERA #1;
|FPRC;

|DEFBUCLE agifigen;
  #1#1;
  ;
  00000;
  99999;
  be;
  NULL, empresas;
|FIN;

|PROCESO cen03;
  |HAZ Pinta;
  eaVarDni = #4#17;  |HAZ CalculoDNI;
  #4#17 = eaVarDni;
  |GRABA 140#4a;
  |LIBERA #4;
|FPRC;

|DEFBUCLE agicen03;
  #4#1;
  ;
  00000, 00;
  99999, 99;
  be;
  NULL, cen03;
|FIN;

|PROCESO cen05;
  |HAZ Pinta;
  eaVarDni = #5#4; |HAZ CalculoDNI;
  #5#4 = eaVarDni;
  |GRABA 140#5a;
  |LIBERA #5;
|FPRC;

|DEFBUCLE agicen15;
  #5#1;
  ;
  00000;
  99999;
  be;
  NULL, cen05;
|FIN;

|PROCESO cen06;
  |HAZ Pinta;
  eaVarDni = #6#3; |HAZ CalculoDNI;
  #6#3 = eaVarDni;
  |GRABA 140#6a;
  |LIBERA #6;
|FPRC;

|DEFBUCLE agicen06;
  #6#1;
  ;
  00000, 00, 00;
  99999, 99, 99;
  be;
  NULL, cen06;
|FIN;

|PROCESO cen11;
  |HAZ Pinta;
  eaVarDni = #31#17;  |HAZ CalculoDNI;
  #31#17 = eaVarDni;
  |GRABA 140#31a;
  |LIBERA #31;
|FPRC;

|DEFBUCLE agicen11;
  #31#1;
  ;
  00000, 00;
  99999, 99;
  be;
  NULL, cen11;
|FIN;

|PROCESO cen13;
  |HAZ Pinta;
  eaVarDni = #33#3; |HAZ CalculoDNI;
  #33#3 = eaVarDni;
  |GRABA 140#33a;
  |LIBERA #33;
|FPRC;

|DEFBUCLE agicen13;
  #33#1;
  ;
  00000, 00, 00;
  99999, 99, 99;
  be;
  NULL, cen13;
|FIN;

|PROCESO w0029;
  |PARA xxx = 0; |SI xxx [ 8; |HACIENDO xxx = xxx + 1;
        #100xxx = #13xxx;
  |SIGUE;

  eaVarDni = #100#0;
  |HAZ CalculoDNI;
  #100#0 = eaVarDni;

  |GRABA 140#100n;
  |LIBERA #100;
|FPRC;

|DEFBUCLE agim0003;
  #13#1;
  ;
  "            ";
  "zzzzzzzzzzzz"
  ;
  NULL, w0029;
|FIN;

|PROCESO PasaRepre;
  |HAZ Pinta;
  |PARA xxx = 0; |SI xxx [ 8; |HACIENDO xxx = xxx + 1;
        #13xxx = #100xxx;
  |SIGUE;

  |GRABA 140#13n;
  |LIBERA #13;
|FPRC;

|DEFBUCLE agiw0029;
  #100#1;
  ;
  "            ";
  "zzzzzzzzzzzz"
  ;
  NULL, PasaRepre;
|FIN;

|PROCESO agim0003;
  comienza = "rp";
  |HAZ fichero;
  |NOME_DAT #100 fichero;
  |ABRE #100; |CIERRA #100; |DELINDEX #100;

  |ABRE #100;
  |BUCLE agim0003;
  |CIERRA #100;

  |ABRE #13; |CIERRA #13; |DELINDEX #13;

  |ABRE #13;
  |BUCLE agiw0029;
  |CIERRA #13;

  |ABRE #100; |CIERRA #100; |DELINDEX #100;
|FPRC;

|PROCESO m0004;
  |HAZ Pinta;
  eaVarDni = #14#2; |HAZ CalculoDNI;
  #14#2 = eaVarDni;
  |GRABA 140#14a;
  |LIBERA #14;
|FPRC;

|DEFBUCLE agim0004;
  #14#1;
  ;
  00000, 00;
  99999, 99;
  be;
  NULL, m0004;
|FIN;

|PROCESO m0021;
  |HAZ Pinta;
  eaVarDni = #21#3; |HAZ CalculoDNI;
  #21#3 = eaVarDni;
  |GRABA 140#21a;
  |LIBERA #21;
|FPRC;

|DEFBUCLE agim0021;
  #21#1;
  ;
  00000, 00, 00;
  99999, 99, 99;
  be;
  NULL, m0021;
|FIN;

|PROCESO m0024;
  |HAZ Pinta;
  eaVarDni = #24#3; |HAZ CalculoDNI;
  #24#3 = eaVarDni;
  |GRABA 140#24a;
  |LIBERA #24;
|FPRC;

|DEFBUCLE agim0024;
  #24#1;
  ;
  00000, 00, 00;
  99999, 99, 99;
  be;
  NULL, m0024;
|FIN;

|PROCESO m0025;
  |HAZ Pinta;
  eaVarDni = #25#3; |HAZ CalculoDNI;
  #25#3 = eaVarDni;
  |GRABA 140#25a;
  |LIBERA #25;
|FPRC;

|DEFBUCLE agim0025;
  #25#1;
  ;
  00000, 00, 000;
  99999, 99, 999;
  be;
  NULL, m0025;
|FIN;

|PROCESO m0026;
  |HAZ Pinta;
  eaVarDni = #26#3; |HAZ CalculoDNI;
  #26#3 = eaVarDni;
  |GRABA 140#26a;
  |LIBERA #26;
|FPRC;

|DEFBUCLE agim0026;
  #26#1;
  ;
  00000, 00, 00;
  99999, 99, 99;
  be;
  NULL, m0026;
|FIN;

|PROCESO m0027;
  |HAZ Pinta;
  eaVarDni = #27#3; |HAZ CalculoDNI;
  #27#3 = eaVarDni;
  |GRABA 140#27a;
  |LIBERA #27;
|FPRC;

|DEFBUCLE agim0027;
  #27#1;
  ;
  00000, 00, 00;
  99999, 99, 99;
  be;
  NULL, m0027;
|FIN;

|PROCESO refer;
  |HAZ Pinta;
  eaVarDni = #28#13; |HAZ CalculoDNI;
  #28#13 = eaVarDni;
  |GRABA 140#28a;
  |LIBERA #28;
|FPRC;

|DEFBUCLE agirefer;
  #28#1;
  ;
  00000;
  99999;
  be;
  NULL, refer;
|FIN;

|PROCESO ficha;
  |HAZ Pinta;
  eaVarDni = #29#3; |HAZ CalculoDNI;
  #29#3 = eaVarDni;
  |GRABA 140#29a;
  |LIBERA #29;
|FPRC;

|DEFBUCLE agim0028;
  #29#1;
  ;
  00000;
  99999;
  be;
  NULL, ficha;
|FIN;

|PROCESO Tipo3; |TIPO 3;
  |NOPARA;
  #0#1 = 0; #0#0 = "Ficha de Clientes        "; |PINTA #0#0; |BUCLE agifigen;
  #0#1 = 0; #0#0 = "Situacion Tributaria 97  "; |PINTA #0#0; |BUCLE agicen03;
  #0#1 = 0; #0#0 = "Situacion Tributaria 98  "; |PINTA #0#0; |BUCLE agicen11;
  #0#1 = 0; #0#0 = "Repre.,Oblig.,Tribut.    "; |PINTA #0#0; |BUCLE agicen15;
  #0#1 = 0; #0#0 = "Participes 97            "; |PINTA #0#0; |BUCLE agicen06;
  #0#1 = 0; #0#0 = "Participes 98            "; |PINTA #0#0; |BUCLE agicen13;
  #0#1 = 0; #0#0 = "Representantes Empresas  "; |PINTA #0#0; |BUCLE agim0004;
  #0#1 = 0; #0#0 = "T.Fiscal Relacion Socios "; |PINTA #0#0; |BUCLE agim0021;
  #0#1 = 0; #0#0 = "Repres.Admist.Socio      "; |PINTA #0#0; |BUCLE agim0024;
  #0#1 = 0; #0#0 = "Socios R.Sociedades      "; |PINTA #0#0; |BUCLE agim0025;
  #0#1 = 0; #0#0 = "Cargo Sociedades         "; |PINTA #0#0; |BUCLE agim0026;
  #0#1 = 0; #0#0 = "Part.Otras Empresas      "; |PINTA #0#0; |BUCLE agim0027;
  #0#1 = 0; #0#0 = "Referencias              "; |PINTA #0#0; |BUCLE agirefer;
  #0#1 = 0; #0#0 = "Representantes           "; |PINTA #0#0; |HAZ agim0003;
  #0#1 = 0; #0#0 = "Ficha Sociedades         "; |PINTA #0#0; |BUCLE agim0028;
|FPRC;
