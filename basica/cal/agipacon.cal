|FICHEROS;
    agipacon #0;
    agifigen #1;
    :/contagen/def/canempre #2;

    &provinc@ #700;
|FIN;

|VARIABLES;
    contador = 0;
    sw = 0;
    informe = "paserror"
    aviso1 = "     NO EXISTE INFORME";
    aviso2 = "     NO EXISTE IMPRESORA";
    ficha = "";
    nada = "";
    nada1 = "";
    codi1 = "";
    codi2 = "";
    &aplica = "";
    &codigo = 0;
    &nombre1 = "";
    &nombre2 = "";
    &cif1 = "";
    &cif2 = "";
    directorio = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";

    &enCodProv = 0;
|FIN;

|CALCULO pasafich;
|DDEFECTO #1;
    #1#0 = #2#2;
|LEE 101#1=;
|SI FSalida = 0;
    |HAZ existe;
|SINO;
    |HAZ noexiste;
|FINSI;
|FCAL;

|DEFBUCLE agipacon0;
 #2#1;
 ;
 #0#0, 0;
 #0#1, 9;
 e;
 NULL, pasafich;
|FIN;

|CALCULO provincia;
     enCodProv = #1#9;
     |HAZ LeeProvincia;
|FCAL;


|CALCULO pase; |TIPO 3;
contador = 0;
sw       = 0;
|ABRE #1;
|IMPRE 0;
|SI FSalida = 0;
    |INFOR informe;
    |SI FSalida = 0;
        |BUCLE agipacon0;
        |SI sw = 1; |PIEINF; |FINSI;
        |FININF;
    |SINO;
        |MENAV aviso2;
    |FINSI;
    |FINIMP;
|SINO;
    |MENAV aviso1;
|FINSI;
|CIERRA #1;
|FCAL;

|CALCULO noexiste;
    contador = contador + 1;
    #1#00 = #2#2;        || codigo empresa
    #1#01 = #2#4;        || razon social
    #1#02 = #2#1;        || nombre comercial
    #1#04 = #2#5;        || direccion
    #1#16 = #2#6;        || codigo postal
    nume1 = #1#16;
    #1#09 = (nume1 - (nume1 $ 1000)) / 1000;      || codigo provincia
    #1#10 =  nume1 $ 1000;                        || codigo poblacion
    #1#11 = #2#7;        || poblacion
|HAZ provincia;
    #1#12 = #700#1;        || provincia
    #1#13 = #2#8;        || cif
    #1#14 = #2#9;        || telefono
    #1#15 = #2#10;       || fax
    #1#23 = "S";         || contabilidad 'SI'
    |HAZ pon_demas;
|GRABA 020#1n;
|ATRI I;
|SI FSalida = 0; |PINTA 1344, contador;  |FINSI;
|ATRI 0;
|FCAL;

|CALCULO existe;
    cif1 = #1#13;
|QBF cif1;
    cif2 = #2#8;
|QBF cif2;
|SI cif1 ! cif2;
        sw = 1;
        nombre1 = #1#1;
        nombre2 = #2#1;
        codigo = #1#0;
        aplica = directorio;
    |PRINT;
|SINO;
        #1#23 = "S";
    |GRABA 020#1a;
|FINSI;
|LIBERA #1;
|FCAL;

|PROCESO pon_demas;
#1#41 = #1#3;
#1#42 = #1#4;
#1#43 = #1#5;
#1#44 = #1#6;
#1#45 = #1#7;
#1#46 = #1#8;
#1#47 = #1#9;
#1#48 = #1#10;
#1#49 = #1#11;
#1#50 = #1#12;

#1#51 = #1#3;
#1#52 = #1#4;
#1#53 = #1#5;
#1#54 = #1#6;
#1#55 = #1#7;
#1#56 = #1#8;
#1#57 = #1#9;
#1#58 = #1#10;
#1#59 = #1#11;
#1#60 = #1#12;
|FPRC;

|CALCULO tipo_8; |TIPO 8;
|FCAL;
