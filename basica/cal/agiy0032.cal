|FICHEROS;
     agiy0032 #0;
     agifigen #1;
     agim0028 #2;
     agim0019 #3;
     agim0026 #4;

     :/contasoc/def/meempmem #100;
     :/contasoc/def/meempme1 #101;
     :/contasoc/def/megwordn #102;

     :/integral/def/dsam0054 #54;
|FIN;

|VARIABLES;
     nCampo          = 0;
     nContador       = 0;
     nContador1      = 0;
     nContador2      = 0;
     nSwContar       = 0;
     nImporte        = 0;
     nWord           = 0;
     nCopia          = 0;
     nSwDialogo      = 0;
     nLinea          = 0;

     aMas            = "";
     aFich           = "";
     aAlfa           = "";
     aAlfa1          = "";
     aAlfa2          = "";
     aIPRemoto       = "";
     aBase           = "";
     aOrigen         = "";
     aDestino        = "";
     aAbre           = "";

     a01 = ""; a02 = ""; a03 = ""; a04 = ""; a05 = "";
     a06 = ""; a07 = ""; a08 = ""; a09 = ""; a10 = "";
     a11 = ""; a12 = ""; a13 = ""; a14 = ""; a15 = "";
     a16 = ""; a17 = ""; a18 = ""; a19 = ""; a20 = "";
     a21 = ""; a22 = ""; a23 = ""; a24 = ""; a25 = "";
     a26 = ""; a27 = ""; a28 = ""; a29 = ""; a30 = "";
     a31 = ""; a32 = ""; a33 = ""; a34 = ""; a35 = "";
     a36 = ""; a37 = ""; a38 = ""; a39 = ""; a40 = "";
     a41 = ""; a42 = ""; a43 = ""; a44 = ""; a45 = "";
     a46 = ""; a47 = ""; a48 = "";

   {100}aCamWord      = "";
        nCamWord      = 0;

     &eaPathIntegral = "";
     &eaPathContasoc = "";

     &eaAplica        = "";
     &eaPrograma      = "";
     &eaDocumento     = "";
     &eaNomDocumento  = "";
     &enEmpresa       = 0;
     &eaAlfa          = 0;
     &eaImporte       = 0;
     &eaRutaDocumento = "";
     &enFSalida       = 0;
     &enCodUbica      = 0;
     &eaNomUbicacion  = "";
     &eaUnidadBasico = "";
|FIN;

|INCLUYE i_consul;

|PROCESO Parrilla;
     |SI #0#0 = 0;
         #0#0 = 0;  |PINTA #0#0;
         #0#1 = 0;  |PINTA #0#1;  |C_M #0#1, 1, "N";
         |PARA nCampo = 2;  |SI nCampo [ 33;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |SINO;
         |C_M #0#1, 1, "S";
         |PARA nCampo = 2;  |SI nCampo [ 33;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
               #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |FINSI;

     |C_M #0#38, 1, "S";
     |C_M #0#39, 1, "S";

     |HAZ BusquedaApli;
     |SI eaPathIntegral = "";
         |C_M #0#38, 1, "N";  #0#38 = "N";  |PINTA #0#38;
         |C_M #0#39, 1, "N";  #0#39 = 0;    |PINTA #0#39;
     |FINSI;

     |SI eaPathContasoc = "";
         |MENAV "     No esta instalado el Impuesto de Sociedades";
         |PTEC 807;
     |FINSI;
|FPRC;

|PROCESO NoMasEmpresas;
     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 33;  |HACIENDO nCampo = nCampo + 1;
               #0Campo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 33;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Ubicacion;  |TIPO 0;
     |C_M #0#39, 1, "S";
     |SI #0#38 = "N";
         |C_M #0#39, 1, "N";  #0#39 = 0;  |PINTA #0#39;
     |FINSI;
|FPRC;

|PROCESO BuscaUbicacion;
     |SI #0#38 = "N";  |ACABA;  |FINSI;

     enCodUbica = #0#39;
     |HAZ LeeUbicaciones;
     |SI enFSalida ! 0;  |ERROR;  |ACABA;  |FINSI;

     #0#40 = eaNomUbicacion;  |PINTA #0#40;
|FPRC;

|PROCESO Firmantes;
     |SI nSwContar = 0;
         nContador1 = nContador1 + 1;
         |ACABA;
     |FINSI;

     nContador2 = nContador2 + 1;

     |SI nContador2 = 1;
         a01  = #101#3;                    |QBF a01;
         |ACABA;
     |FINSI;

     |SI nContador2 = nContador1;
         a01 = a01  +  " y " + #101#3;  |QBF a01;
         |ACABA;
     |FINSI;

     a01  = a01  + ", " + #101#3;        |QBF a01;
|FPRC;

|DEFBUCLE meempme1;
     #101#1;
     ;
     #100#0, 01;
     #100#0, 99;
     ;
     NULL, Firmantes;
|FIN;

|PROCESO PonSecretario;
     eaAlfa = #4#4;  |HAZ QuitaRaros;  a11 = eaAlfa;  |QBF a11;
                                       a24 = eaAlfa;  |QBF a24;
                                       a12 = #4#3;    |QBF a12;
|FPRC;

|DEFBUCLE agim0026;
     #4#1;
     16;
     #3#0, #3#1, 01, 03;
     #3#0, #3#1, 99, 03;
     ;
     NULL, PonSecretario;
|FIN;

|PROCESO CargaCampos;
     IaCamWord = aCamWord1<-;
     |PARA nCamWord = 1;  |SI nCamWord [ 100;  |HACIENDO nCamWord = nCamWord + 1;
           aCamWord = "";
           IaCamWord = IaCamWord + 1;
     |SIGUE;

     a01 = ""; a02 = ""; a03 = ""; a04 = ""; a05 = "";
     a06 = ""; a07 = ""; a08 = ""; a09 = ""; a10 = "";
     a11 = ""; a12 = ""; a13 = ""; a14 = ""; a15 = "";
     a16 = ""; a17 = ""; a18 = ""; a19 = ""; a20 = "";
     a21 = ""; a22 = ""; a23 = ""; a24 = ""; a25 = "";
     a26 = ""; a27 = ""; a28 = ""; a29 = ""; a30 = "";
     a31 = ""; a32 = ""; a33 = ""; a34 = ""; a35 = "";
     a36 = ""; a37 = ""; a38 = ""; a39 = ""; a40 = "";
     a41 = ""; a42 = ""; a43 = ""; a44 = ""; a45 = "";
     a46 = ""; a47 = ""; a48 = "";

     |ABRE #100;
     #100#0 = #3#0;
     |LEE 040#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;
     |CIERRA #100;

     |ABRE #102;
     #102#0 = #3#56;
     |LEE 040#102=;
     |SI FSalida ! 0;  |DDEFECTO #102;  |FINSI;
     |CIERRA #102;

     nContador1 = 0;
     nContador2 = 0;
     nSwContar  = 0;  |BUCLE meempme1;
     nSwContar  = 1;  |BUCLE meempme1;

|| Encabezamiento ________________________________________________________

     a47 = a01;                                    |QBF a47;
     eaAlfa = a47 + ",";  |HAZ QuitaRaros;  a47 = eaAlfa;

     a01 = a01 + " como " + #100#127;              |QBF a01;
     a01 = a01 + " " + &34 + #100#1;               |QBF a01;
     a01 = a01 + &34 + ",";
     a01 = a01 + " con domicilio fiscal en " + #1#11; |QBF a01;
     a01 = a01 + " " + "(" + #1#12;                |QBF a01;
     a01 = a01 + "), " + #1#3;                     |QBF a01;
     a01 = a01 + " " + #1#4;                       |QBF a01;
     a01 = a01 + ", n. " + #1#5;                   |QBF a01;
     a01 = a01 + ", y C.I.F. " + #1#13;            |QBF a01;
     eaAlfa = a01 + ",";  |HAZ QuitaRaros;  a01 = eaAlfa;

|| Nombre Empresa ________________________________________________________

     eaAlfa = #100#1;  |HAZ QuitaRaros;  a03 = eaAlfa;

|| CIF ___________________________________________________________________

     a04 = #1#13;

|| Capital Social ________________________________________________________

     nImporte = #3#14;                                   || Capital Social
     |SI #3#51 = "P";
         nImporte = (nImporte / 166.386) ! 2;
     |FINSI;

     eaImporte = nImporte;   |HAZ PonLetraEuro; a25 = eaImporte;
     eaImporte = nImporte;   |HAZ Importe;      a05 = eaImporte;

|| Numero de Participaciones ________________________________________________

     nImporte = #3#15 + #3#19 + #3#23;
     aAlfa    = nImporte;  |LETRA  aAlfa;  a26 = aAlfa;
                                           a42 = nImporte;

|| Valor Nominal ____________________________________________________________

     nImporte  = #3#16 + #3#20 + #3#24;
     |SI #3#51 = "P";
         nImporte = (nImporte / 166.386) ! 6;
     |FINSI;
     eaImporte = nImporte;   |HAZ PonLetraEuro6; a27 = eaImporte;
     eaImporte = nImporte;   |HAZ Importe6;      a06 = eaImporte;

|| Del Numero de Accion _____________________________________________________

     nImporte  = #3#17 + #3#21 + #3#49;
     aAlfa     = "M" + nImporte;   |LETRA  aAlfa;  a28 = aAlfa;
     eaImporte = nImporte;   |HAZ Importe;   a07 = eaImporte;

|| Al Numero de Accion ______________________________________________________

     nImporte  = #3#18 + #3#22 + #3#50;
     aAlfa     = "M" + nImporte;   |LETRA  aAlfa;  a29 = aAlfa;
     eaImporte = nImporte;   |HAZ Importe;   a08 = eaImporte;

|| Poblacion ________________________________________________________________

     eaAlfa = #1#11;  |HAZ QuitaRaros;  a09 = eaAlfa;

|| Fecha Extendida __________________________________________________________

     eaAlfa = #0#37;  |HAZ SacaFecha;   a10 = eaAlfa;
                                        a43 = #0#37;

|| Nombre Secretario ________________________________________________________

     |BUCLE agim0026;

|| Domicilio Social _________________________________________________________

     a13 = #1#11; |QBF a13;
     a13 = a13 + " " + "(" + #1#12;           |QBF a13;
     a13 = a13 + "), " + #1#3;                |QBF a13;
     a13 = a13 + " " + #1#4;                  |QBF a13;
     a13 = a13 + ", n. " + #1#5;              |QBF a13;

|| Inscrita _________________________________________________________________

     a14 = #3#59;  |QBF a14;

|| Fecha Inscripcion ________________________________________________________

     a15 = #3#60;

|| Aportacion Minima Trabajador _____________________________________________

     a16 = #3#61;  |QBF a16;

|| Falta muy grave de _______________________________________________________

     a17 = #3#62;  |QBF a17;

|| Falta muy grave a ________________________________________________________

     a18 = #3#63;  |QBF a18;

|| Falta grave de ___________________________________________________________

     a19 = #3#64;  |QBF a19;

|| Falta grave a  ___________________________________________________________

     a20 = #3#65;  |QBF a20;

|| Falta leve de  ___________________________________________________________

     a21 = #3#66;  |QBF a21;

|| Falta leve a  ____________________________________________________________

     a22 = #3#67;  |QBF a22;

|| Firma del Presidente _____________________________________________________

     eaAlfa = #100#130;  |HAZ QuitaRaros;  a23 = eaAlfa;  |QBF a23;

|| Acciones No Reservadas ___________________________________________________

     a30 = #3#68;   |QBF a30;

|| Acciones No Reservadas De ________________________________________________

     a31 = #3#69;   |QBF a31;

|| Acciones No Reservadas a _________________________________________________

     a32 = #3#70;   |QBF a32;

|| Acciones Reservadas ______________________________________________________

     a33 = #3#71;   |QBF a33;

|| Acciones Reservadas de ___________________________________________________

     a34 = #3#72;   |QBF a34;

|| Acciones Reservadas a ____________________________________________________

     a35 = #3#73;   |QBF a35;

|| Acciones Laboral _________________________________________________________

     a36 = #3#74;   |QBF a36;

|| Acciones Laboral De ______________________________________________________

     a37 = #3#75;   |QBF a37;

|| Acciones Laboral a _______________________________________________________

     a38 = #3#76;   |QBF a38;

|| Acciones General _________________________________________________________

     a39 = #3#77;   |QBF a39;

|| Acciones General De ______________________________________________________

     a40 = #3#78;   |QBF a40;

|| Acciones General a _______________________________________________________

     a41 = #3#79;   |QBF a41;

|| Fecha de la Diligencia ___________________________________________________

     eaAlfa = #0#42;  |HAZ SacaFechaLetra; |HAZ QuitaRaros;  a45 = eaAlfa;

|| Nombre Notario  __________________________________________________________

     eaAlfa = #102#1; |HAZ QuitaRaros;  a44 = eaAlfa;  |QBF a44;

|| Colegio de Notario _______________________________________________________

     eaAlfa = #102#3; |HAZ QuitaRaros;  a46 = eaAlfa;  |QBF a46;

|| Poblacion del Notario ____________________________________________________

     eaAlfa = #102#2; |HAZ QuitaRaros;  a48 = eaAlfa;  |QBF a48;
|FPRC;

|PROCESO CargaVarWord;
     IaCamWord = aCamWord1<-;
     aCamWord  = "#1#";  IaCamWord = IaCamWord + 1; aCamWord  = a01; IaCamWord = IaCamWord + 1;
     aCamWord  = "#2#";  IaCamWord = IaCamWord + 1; aCamWord  = a02; IaCamWord = IaCamWord + 1;
     aCamWord  = "#3#";  IaCamWord = IaCamWord + 1; aCamWord  = a03; IaCamWord = IaCamWord + 1;
     aCamWord  = "#4#";  IaCamWord = IaCamWord + 1; aCamWord  = a04; IaCamWord = IaCamWord + 1;
     aCamWord  = "#5#";  IaCamWord = IaCamWord + 1; aCamWord  = a05; IaCamWord = IaCamWord + 1;
     aCamWord  = "#6#";  IaCamWord = IaCamWord + 1; aCamWord  = a06; IaCamWord = IaCamWord + 1;
     aCamWord  = "#7#";  IaCamWord = IaCamWord + 1; aCamWord  = a07; IaCamWord = IaCamWord + 1;
     aCamWord  = "#8#";  IaCamWord = IaCamWord + 1; aCamWord  = a08; IaCamWord = IaCamWord + 1;
     aCamWord  = "#9#";  IaCamWord = IaCamWord + 1; aCamWord  = a09; IaCamWord = IaCamWord + 1;
     aCamWord  = "#10#"; IaCamWord = IaCamWord + 1; aCamWord  = a10; IaCamWord = IaCamWord + 1;
     aCamWord  = "#11#"; IaCamWord = IaCamWord + 1; aCamWord  = a11; IaCamWord = IaCamWord + 1;
     aCamWord  = "#12#"; IaCamWord = IaCamWord + 1; aCamWord  = a12; IaCamWord = IaCamWord + 1;
     aCamWord  = "#13#"; IaCamWord = IaCamWord + 1; aCamWord  = a13; IaCamWord = IaCamWord + 1;
     aCamWord  = "#14#"; IaCamWord = IaCamWord + 1; aCamWord  = a14; IaCamWord = IaCamWord + 1;
     aCamWord  = "#15#"; IaCamWord = IaCamWord + 1; aCamWord  = a15; IaCamWord = IaCamWord + 1;
     aCamWord  = "#16#"; IaCamWord = IaCamWord + 1; aCamWord  = a16; IaCamWord = IaCamWord + 1;
     aCamWord  = "#17#"; IaCamWord = IaCamWord + 1; aCamWord  = a17; IaCamWord = IaCamWord + 1;
     aCamWord  = "#18#"; IaCamWord = IaCamWord + 1; aCamWord  = a18; IaCamWord = IaCamWord + 1;
     aCamWord  = "#19#"; IaCamWord = IaCamWord + 1; aCamWord  = a19; IaCamWord = IaCamWord + 1;
     aCamWord  = "#20#"; IaCamWord = IaCamWord + 1; aCamWord  = a20; IaCamWord = IaCamWord + 1;
     aCamWord  = "#21#"; IaCamWord = IaCamWord + 1; aCamWord  = a21; IaCamWord = IaCamWord + 1;
     aCamWord  = "#22#"; IaCamWord = IaCamWord + 1; aCamWord  = a22; IaCamWord = IaCamWord + 1;
     aCamWord  = "#23#"; IaCamWord = IaCamWord + 1; aCamWord  = a23; IaCamWord = IaCamWord + 1;
     aCamWord  = "#24#"; IaCamWord = IaCamWord + 1; aCamWord  = a24; IaCamWord = IaCamWord + 1;
     aCamWord  = "#25#"; IaCamWord = IaCamWord + 1; aCamWord  = a25; IaCamWord = IaCamWord + 1;
     aCamWord  = "#26#"; IaCamWord = IaCamWord + 1; aCamWord  = a26; IaCamWord = IaCamWord + 1;
     aCamWord  = "#27#"; IaCamWord = IaCamWord + 1; aCamWord  = a27; IaCamWord = IaCamWord + 1;
     aCamWord  = "#28#"; IaCamWord = IaCamWord + 1; aCamWord  = a28; IaCamWord = IaCamWord + 1;
     aCamWord  = "#29#"; IaCamWord = IaCamWord + 1; aCamWord  = a29; IaCamWord = IaCamWord + 1;
     aCamWord  = "#30#"; IaCamWord = IaCamWord + 1; aCamWord  = a30; IaCamWord = IaCamWord + 1;
     aCamWord  = "#31#"; IaCamWord = IaCamWord + 1; aCamWord  = a31; IaCamWord = IaCamWord + 1;
     aCamWord  = "#32#"; IaCamWord = IaCamWord + 1; aCamWord  = a32; IaCamWord = IaCamWord + 1;
     aCamWord  = "#33#"; IaCamWord = IaCamWord + 1; aCamWord  = a33; IaCamWord = IaCamWord + 1;
     aCamWord  = "#34#"; IaCamWord = IaCamWord + 1; aCamWord  = a34; IaCamWord = IaCamWord + 1;
     aCamWord  = "#35#"; IaCamWord = IaCamWord + 1; aCamWord  = a35; IaCamWord = IaCamWord + 1;
     aCamWord  = "#36#"; IaCamWord = IaCamWord + 1; aCamWord  = a36; IaCamWord = IaCamWord + 1;
     aCamWord  = "#37#"; IaCamWord = IaCamWord + 1; aCamWord  = a37; IaCamWord = IaCamWord + 1;
     aCamWord  = "#38#"; IaCamWord = IaCamWord + 1; aCamWord  = a38; IaCamWord = IaCamWord + 1;
     aCamWord  = "#39#"; IaCamWord = IaCamWord + 1; aCamWord  = a39; IaCamWord = IaCamWord + 1;
     aCamWord  = "#40#"; IaCamWord = IaCamWord + 1; aCamWord  = a40; IaCamWord = IaCamWord + 1;
     aCamWord  = "#41#"; IaCamWord = IaCamWord + 1; aCamWord  = a41; IaCamWord = IaCamWord + 1;
     aCamWord  = "#42#"; IaCamWord = IaCamWord + 1; aCamWord  = a42; IaCamWord = IaCamWord + 1;
     aCamWord  = "#43#"; IaCamWord = IaCamWord + 1; aCamWord  = a43; IaCamWord = IaCamWord + 1;
     aCamWord  = "#44#"; IaCamWord = IaCamWord + 1; aCamWord  = a44; IaCamWord = IaCamWord + 1;
     aCamWord  = "#45#"; IaCamWord = IaCamWord + 1; aCamWord  = a45; IaCamWord = IaCamWord + 1;
     aCamWord  = "#46#"; IaCamWord = IaCamWord + 1; aCamWord  = a46; IaCamWord = IaCamWord + 1;
     aCamWord  = "#47#"; IaCamWord = IaCamWord + 1; aCamWord  = a47; IaCamWord = IaCamWord + 1;
     aCamWord  = "#48#"; IaCamWord = IaCamWord + 1; aCamWord  = a48; IaCamWord = IaCamWord + 1;

     nCamWord  = 48;

     IaCamWord = aCamWord1<-;
     aAlfa     = nCamWord; |QBT aAlfa;
     |WORD_ASIGNA_TEXTO nWord, aAlfa, aCamWord;
|FPRC;

|PROCESO GuardaDocumento;
     |ABRE #54;
     #54#0  = #1#0;
     #54#1  = 9999;
     |LEE 040#54];
     |SI FSalida = 0;
         |LEE 040#54a;
     |SINO;
         |LEE 040#54u;
     |FINSI;
     |SI FSalida = 0;  |Y #54#0 = #1#0;
         nLinea = #54#1 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #54;
     |HORA aAlfa;
     aAlfa1 = aAlfa % 102;
     aAlfa2 = aAlfa % 402;

     #54#0  = #1#0;
     #54#1  = nLinea;
     #54#2  = eaNomDocumento;
     #54#3  = "DOC" + (("00000" + #54#0) % -105) + (("0000" + #54#1) % -104) + ".DOC";
     #54#4  = ~;
     #54#5  = aAlfa1;
     #54#6  = aAlfa2;
     #54#7  = ~;
     #54#8  = aAlfa1;
     #54#9  = aAlfa2;
     #54#10 = #0#39;
     #54#11 = "";
     #54#12 = "";
     |GRABA 020#54n;
     |LIBERA #54;
     |CIERRA #54;

     aOrigen  = eaUnidadBasico + "/MODELOS/DOCUMENTOS/" + eaDocumento;
     aDestino = eaRutaDocumento + "/" + "DOC" + (("00000" + #1#0) % -105) + (("0000" + nLinea) % -104) + ".DOC";
     |QBT aOrigen;
     |QBT aDestino;

     |RCOPIA_FICHERO aOrigen, aDestino;
     |SI FSalida ! 0;
         |MENAV "     No se ha podido copia el Documento al Cliente.";
     |FINSI;
|FPRC;

|PROCESO CargaDocumento;
     aAlfa = eaUnidadBasico + "/MODELOS";                   |RMKDIR aAlfa;
     aAlfa = eaUnidadBasico + "/MODELOS/DOCUMENTOS";        |RMKDIR aAlfa;

     |DBASE aBase;
     aOrigen   = aBase + "word/" + eaDocumento;
     aDestino  = eaUnidadBasico + "/MODELOS/DOCUMENTOS/" + eaDocumento;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     nWord  = 1;
     aAbre  = aDestino;

     |MENSA "      Abriendo el Documento, espere un Momento.";

     |WORD_ABRE nWord, aAbre;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     |MENSA "      Cargando Campos al Documento, espere un Momento.";

     |HAZ CargaVarWord;

     |MENSA "      Imprimiendo el Documento, espere un Momento.";

     |SI eaDocumento ! "word0012.doc";
         |PARA nCopia = 1;  |SI nCopia [ #0#41;  |HACIENDO nCopia = nCopia + 1;
               |WORD_IMPRIME nWord, "";
               |WORD_PROPIEDADES nWord, "Visible", "NO";

               nSwDialogo = 1;
         |SIGUE;

         |SLEEP 10;

         |MENSA "      Cerrando Documento";

         |WORD_SALVA nWord, "";
     |SINO;
          |WORD_PROPIEDADES nWord, "Visible", "SI";
          FSalida = "NO";
          |PARA;  |SI FSalida = "NO";  |HACIENDO;
                  |PULSATECLA;
                  |WORD_PROPIEDADES nWord, "Quit", "";
          |SIGUE;
     |FINSI;

     |SI #0#38 = "S";  |HAZ GuardaDocumento;  |FINSI;

     |RFBORRA aAbre;
|FPRC;

|PROCESO AlRollo;
     |ABRE #2;
     #2#0 = #1#0;
     |LEE 040#2=;
     |SI FSalida ! 0;  |CIERRA #2;  |ACABA;  |FINSI;
     |CIERRA #2;

     aAlfa = #1#62;  |QBF aAlfa;
     |SI #0#36 = "A";
         |SI aAlfa ! "ACTIVA";
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #0#36 = "I";
         |SI aAlfa ! "INACTIVA";
             |ACABA;
         |FINSI;
     |FINSI;

     enEmpresa = #1#0;

     |SUB_EJECUTA_NP ":contasoc/meempmem";

     |ABRE #3;
     #3#0 = #2#0;
     #3#1 = 99;
     |LEE 040#3];
     |SI FSalida = 0;
         |LEE 040#3a;
     |SINO;
         |LEE 040#3u;
     |FINSI;

     |SI FSalida ! 0;  |O #3#0 ! #2#0;
         |CIERRA #3;
         |ACABA;
     |FINSI;
     |CIERRA #3;

     |HAZ CargaCampos;
     |HAZ CargaDocumento;
|FPRC;

|DEFBUCLE agifigen;
     #1#1;
     87;
     #0#0, #0#34;
     #0#1, #0#35;
     ;
     NULL, AlRollo;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |HAZ LeeUnidadBasico;

     eaAplica    = "basica";
     eaPrograma  = "agiy0032";
     eaDocumento = "";
     |SUB_EJECUTA_NP "wordm000;SACA";
     |QBF eaDocumento;
     |SI eaDocumento = "";
         |MENAV "     No ha seleccionado un Documento.";
         |ACABA;
     |FINSI;

     |SI #0#0 ! 0;
         |BUCLE agifigen;
     |SINO;
         |PARA nCampo = 2;  |SI nCampo [ 33;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo ! 0;
                   #0#0 = #0nCampo;
                   #0#1 = #0nCampo;
                   |BUCLE agifigen;
               |FINSI;
         |SIGUE;
     |FINSI;
|FPRC;
