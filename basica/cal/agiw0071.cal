|FICHEROS;
     agiw0071 #0,MANTE;
     agifigen #1;
     agicen20 #20;

     agiw0072 #72;
     agiw0073 #73;

     agicen42 #42,MANTE;       || causas presentacion
     agicen43 #43,MANTE;       || identificacion personas fisicas
     agicen44 #44,MANTE;       || identificacion personas juridicas
     agicen45 #45,MANTE;       || identificacion establecimientos permanentes
     agicen46 #46,MANTE;       || datos de representantes
     agicen47 #47;             || datos de actividades economicas
     agicen48 #480;            || datos de locales
     agicen49 #49,MANTE;       || sujeto pasivo - IVA
     agicen50 #50,MANTE;       || IRPF, Sociedades, No Residentes y Reg.Fiscal Especial
     agicen51 #51,MANTE;       || Retenc. e Ing. a Cta. y Otros Impuestos
     agicen52 #52,MANTE;       || Regimenes especiales comercio intracomunitario
     agicen53 #53,MANTE;       || Socios
     agicen54 #54,MANTE;       || Socios

     t1803601;
     t1803604;
     t180362a;
     t180362b;
     t180362c;
     t1803608;
     t1803609;

     t190362a;
     t190362b;
     t190367b;
|FIN;

|VARIABLES;
     nHandle      = 0;
     nConta       = 0;
     nNumCampos   = 0;
     nNume1       = 0;
     nNumero      = 0;
     aNumCalle    = "";
     nCaracter    = 0;
     nObliga      = 0;
     nPorDonde    = 0;
     nSocio       = 0;
     nCampo0      = 0;
     nPara1       = 0;
     nPara2       = 0;
     aAlfaS1      = "";
     aAlfaS2      = "";
     aApellidos   = "";
     aNombre      = "";

     aIP          = "";
     aDestinoTxt  = "";
     aArchivoTxt  = "";

     i            = 0;
     aMiCaracter  = "";
     aBlanco      = " ";
     swFecha      = 0;
     aFecha       = "";
     nRepre       = 0;
     swRepite     = 0;
     nActiv       = 0;
     nLocal       = 0;
     aLocal       = "";
     aLocalesDet  = "";
     nLocalesDet  = 0;
     aLocalesInd  = "";
     nLocalesInd  = 0;
     nLocales     = 0;
     nLineaLocal  = 0;
     nSw          = 0;
     swCual       = 0;
     aMensaje     = "";
     aHoja        = "";
     aLon         = "";
     FEstado      = 0;
     nSalir       = 0;

     aDes              = "";
     aSigla            = "";
     swDefectoA        = 0;
     swDefectoB        = 0;
     swDefectoC        = 0;
     aRuta             = "";
     aRuta0            = "";
     aAlfa0            = "";

     aPath             = "";
     {1}aVersion       = "";
     aLongitud         = "";
     nLongitud         = 0;
     nSwPunto          = 0;

     aDocRemoto        = "";
     aDocServidor      = "";
     aPathLocal        = "";
     aPathServidor     = "";
     {1}aContiene      = "";

     &enRegistro       = 0;
     &eaTipo           = "";
     &eaDSMAC          = "";
     &eaTabla          = "";
     &eaDestino        = "";
     &enComp           = 0;
     &enPosicion       = 0;
|FIN;

|INCLUYE i_varemi;

|| _________________________________________________________________________
|| PROCESOS DE LA PANTALLA
|| _________________________________________________________________________

|PROCESO TipoEmision7; |TIPO 7;
     |MENSA "0000<1> Por formulario Web; <2> Solo generar fichero; <F3> Presentacion Directa";
|FPRC;

|PROCESO TipoEmision;
     |BLIN 4;

     |C_M #0#6, 1, "N";
     |C_M #0#8, 1, "S";
     |SI #0#0 = 2;
          |C_M #0#6, 1, "N";
          |C_M #0#8, 1, "N";
     |FINSI;
|FPRC;

|PROCESO Tipo0C8; |TIPO 0;
     |SI FSalida = 10;
         eaForzExplorador = "S";
         |HAZ Explorador;
         |SI eaPathExplorador ! "";
             #0#8 = eaPathExplorador; |PINTA #0#8;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO ExtraePath;

     aPath     = aVersion1;
     aLongitud = aPath % 0;
     nLongitud = aLongitud;
     |PARA nPos = 1; |SI nPos [ nLongitud; |HACIENDO nPos = nPos + 1;
          nCaracter = (nPos * 100) + 1;
          aCaracter = aPath % nCaracter;
          |SI aCaracter = ",";
               nPos = nLongitud - nPos;
               nPos = nPos + 100;
               nPos = (-1) * nPos;
               aPath = aPath % nPos;
               |SAL;
          |FINSI;
     |SIGUE;

     aPath = aPath - "[";
     aPath = aPath - "]";
     |QBF aPath;
     #0#6 = aPath;
     |PINTA #0#6;
|FPRC;

|PROCESO CompruebaRuta;
     |QBF aPath;
     |XABRE "CE", aPath, nHandle;
     |SI aPath = ""; |O FSalida < 0;
          |XCIERRA nHandle;
          aAlfa = "    No se ha encontrado el directorio donde esta instalado ";
          aAlfa = aAlfa + "Adobe Acrobat Reader. ";
          |MENAV aAlfa;

          aAlfa = "    Debera efectuar la instalacion manualmente.";
          |MENAV aAlfa;

          #0#6 = "";
          |PINTA #0#6;
     |FINSI;
|FPRC;

|PROCESO MensajeFallo;
     |CUADRO 1616 2166;
     |ATRI I;
     |PINTA 1717, " No se ha podido localizar  de manera automatica ";
     |PINTA 1817, " la carpeta donde esta instalado Acrobat Reader. ";
     |PINTA 1917, " Compruebe que la aplicacion esta instalada y si ";
     |PINTA 2017, "  es asi, efectue la busqueda de manera manual.  ";
     |ATRI 0;
|FPRC;

|PROCESO SacaBrowse;  |TIPO 7;
     |SI #0#0 = 2;  |ACABA;  |FINSI;

     aAlfa = #0#6;  |QBF aAlfa;
     |SI aAlfa ! "";  |Y nObliga = 0;
         |ACABA;
     |FINSI;

     aVersion1 = "AcroExch.Document";
     |ESPECIFICA "VERSION_PROGRAMA", aVersion;
     |HAZ ExtraePath;
     |SI aPath = "NO LOCALIZADO";
          aVersion1 = "AcroExch.App";
          |ESPECIFICA "VERSION_PROGRAMA", aVersion;
          |HAZ ExtraePath;
     |FINSI;

     |SI aPath ! "NO LOCALIZADO";
          |HAZ CompruebaRuta;
          nObliga = 0;
     |SINO;
          |HAZ MensajeFallo;       || se supone que no esta instalado
          |PAUSA;                  || el Acrobat
          #0#6 = "";
          |PINTA #0#6;
     |FINSI;

     aAlfa = #0#6;  |QBF aAlfa;
     |SI aAlfa ! "";  |Y nObliga = 0;
         |ACABA;
     |FINSI;

     aRuta = "F";
     |BROWSE aRuta;  |QBF aRuta;
     |SI aRuta = "F";
         |ERROR;
         |ACABA;
     |FINSI;

     #0#6 = aRuta % 280;  |PINTA #0#6;
|FPRC;

||Esto es lo nuevo
|PROCESO ManualBrowse;
     aRuta = "F";
     aFic = "";
     |BROWSE aRuta;

     |SI aRuta ! "F";
          nSw = 0;
          aRuta0 = "";
          aLon = aRuta % A0;
          |PARA i = 1; |SI i < aLon; |HACIENDO i = i + 1;
               nPos = -1 * (i * 100 + 1);
               aAlfa = aRuta % nPos;
               |SI aAlfa = "/"; |O aAlfa = "\"; |O nSw = 1;
                    nSw = 1;
                    aRuta0 = aAlfa + aRuta0;
               |SINO;
                    aRuta0 = aAlfa + aRuta0;
                    aFic = aAlfa + aFic;
               |FINSI;
          |SIGUE;
          |QBT aFic;
          aFic = aFic < "";
          aDes = aPath + aFic;
          aDes = aDes < "";
          #0#6 = aRuta0; |PINTA #0#6;
     |FINSI;
|FPRC;

|PROCESO Browse;  |TIPO 0;
     |SI #0#0 = 2;  |ACABA;  |FINSI;

     nObliga = 1;
     |SI FSalida = 10;  |HAZ SacaBrowse;  |FINSI;

     |SI FSalida = 11;  |HAZ ManualBrowse; |FINSI;


     aAlfa = #0#6;  |QBF aAlfa;
     |SI aAlfa = "";  |HAZ SacaBrowse;  |FINSI;

     nObliga = 0;
|FPRC;

|PROCESO SacaCalidadw61;  |TIPO 7;
     eaTabla = "txtn1005.txt";
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompruebaCalidadw61;  |TIPO 0;
     nCampo   = Campo + 1;
     |SI FSalida = 10;
         enPosicion = 55;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 102;
         #0Campo  = aAlfa1;
         |PINTA #0Campo;
     |FINSI;

     enComp = 2;
     eaAlfa = #0Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 102;
     aAlfa2   = eaDestino % 415;
     #0Campo  = aAlfa1;
     #0nCampo = aAlfa2;

     |PINTA #0Campo;
     |PINTA #0nCampo;

     |HAZ FinTabla;

     |C_M #0nCampo, 1, "N";
     |SI #0Campo = " ";  |C_M #0nCampo, 1, "S";  |FINSI;
|FPRC;

|| _________________________________________________________________________
|| PROCESOS DE LA EMISION
|| _________________________________________________________________________

|PROCESO Conver3E2D;
     aAlfa     = (nNume + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     aAlfa = (("000" + aAlfa1) % -103) + ((aAlfa2 + "00") % 102);
|FPRC;

|PROCESO QuitaRaros;
     nEspa   = 0;
     aCadena = "";
     aLong   = aAlfa % 0;
     nLong   = aLong;
     |PARA nCampo = 1;  |SI nCampo [ aLong;  |HACIENDO nCampo = nCampo + 1;
           nPos = (100 * nCampo) + 1;
           aCaracter = aAlfa % nPos;
           |SI aCaracter = "¥";  aCaracter = &209; |FINSI;
           |SI aCaracter = "¤";  aCaracter = &209; |FINSI;
           |SI aCaracter = "§";  aCaracter = &176; |FINSI;
           |SI aCaracter = "¦";  aCaracter = &170; |FINSI;
           |SI aCaracter = "(";  aCaracter = " ";  |FINSI;
           |SI aCaracter = ")";  aCaracter = " ";  |FINSI;
           aCadena = aCadena + aCaracter;
     |SIGUE;
     aAlfa = aCadena;
|FPRC;

|PROCESO BuscaNombre;
     |QBF eaAlfa;
     aAlfa1 = "";
     aAlfa2 = "";
     aLong  = eaAlfa % 0;
     nLong  = aLong;
     nComa  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ nLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPos      = (nCaracter * 100) + 1;
           aCaracter = eaAlfa % nPos;

           |SI aCaracter = ",";
               nComa = 1;
           |SINO;
               |SI nComa = 0;
                   aAlfa1 = aAlfa1 + aCaracter;
               |SINO;
                   |SI aCaracter = " ";  |Y aAlfa2 = "";
                   |SINO;
                       aAlfa2 = aAlfa2 + aCaracter;
                   |FINSI;
               |FINSI;
           |FINSI;
      |SIGUE;
|FPRC;

|PROCESO LeeSigla;
     eaTabla = "txtm0001.txt";
     |HAZ CargaTabla;

     eaAlfa = aSigla;
     enComp = 2;
     |HAZ CompruebaTabla;

     aSigla = eaDestino % 415;

     |HAZ FinTabla;
|FPRC;

|PROCESO BuscaCaracter;
     aLongitud = aCadena % 0;
     nLongitud = aLongitud;
     |PARA nPos = 1; |SI nPos [ nLongitud; |HACIENDO nPos = nPos + 1;
          nCaracter = ((nPos * 100) + 1) * nPorDonde;
          aCaracter = aCadena % nCaracter;
          |SI aCaracter = aMiCaracter;
               |SAL;
          |FINSI;
     |SIGUE;
|FPRC;
|| ///////////////////////////////////////////////////////////////////

|PROCESO AbreFichero;
     eaPathInternet = eaUnidadBasico + "\AEAT";                    |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "\INTERNET";                |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "\036";                     |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "\";

 |SI #0#0 ! 2;
     eaPathLanza = eaUnidadBasico + "\AEAT";                    |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\036";                        |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\";

     aAlfa = eaPathLanza + "*.bat";
     |R_PDIR aAlfa;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
          |RFBORRA aAlfa;

          |R_SDIR aAlfa;
     |SIGUE;
     aAlfa = eaPathLanza + "*.txt";
     |R_PDIR aAlfa;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
          |RFBORRA aAlfa;

          |R_SDIR aAlfa;
     |SIGUE;
 |FINSI;

     |DBASE eaPathEmision;
     eaPathEmision = eaPathEmision + "emisiones";                     |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/036";                          |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/";

     aArchivoTxt = "M" + (("00000" + enEmpresa) % -105) + (("00" + enRegistro) % -102) + ".txt";

     |SI #0#0 = 2;
         aAlfa = eaPathInternet + aArchivoTxt;
         |RFBORRA aAlfa;
     |FINSI;

     aAlfa = eaPathEmision + aArchivoTxt;
     |FBORRA aAlfa;

     enDirecta = 0;
     |SI #0#0 = 3;
         enDirecta = 1;
||         |HAZ PermisoPortal;
||         |SI enPortal = 0;
||             enDirecta = 0;
||             |ACABA;
||         |FINSI;
     |FINSI;

     |XABRE "BW", aAlfa, nHandle;
|FPRC;

|PROCESO CierraFichero;
     |XCIERRA nHandle;

     |SI #0#0 ! 2;
         aDestino = eaPathLanza;
     |SINO;
         aDestino = eaPathInternet;
     |FINSI;

     aDestino    = aDestino + aArchivoTxt;
     aOrigen     = eaPathEmision + aArchivoTxt;

     aIP = "";
     |IP_REMOTO aIP;  |QBF aIP;
     |SI aIP ! "";
         |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     aDestinoTxt  = aDestino;
     |SI #0#0 = 2;
         aAlfa = "0000 El fichero generado está en: " + eaPathInternet + " de su PC";
         |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO TraeSoloWait;
     aPathLocal  = eaPathLanza;

     |DBASS aPathPdf; |QBT aPathPdf;
     aPathPdf = aPathPdf + "modelos/";
     aPathPdf = aPathPdf + "plugins";                    |MKDIR aPathPdf;
     aOrigen  = aPathPdf   + "/wait.exe";
     aDestino = aPathLocal + "wait.exe";

     aContiene1 = aDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = aOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     aIP = "";
     |IP_REMOTO aIP;  |QBT aIP;
     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         |SI aIP ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO IrPagina;
     |HAZ TraeSoloWait;

     eaPathExplorador = #0#8; |QBF eaPathExplorador;

     aAbre = eaPathLanza + "imprime.bat";
     |XABRE "WBC", aAbre, nHandle;

     aAlfa = eaPathLanza + "wait ";
     aAlfa = aAlfa + eaPathExplorador + " " + &34;
     aAlfa = aAlfa + "https://www1.agenciatributaria.gob.es/static_files/common/internet/dep/aplicaciones/ov/i703600a.html";
||    aAlfa = aAlfa + aDestinoTxt;

     eaAlfa  = aAlfa;
     eaAlfa = eaAlfa + &13 + &10;
     |XGRABA nHandle, eaAlfa;

     aAlfa = eaPathLanza + "PAUSE";
     eaAlfa  = aAlfa;
     eaAlfa = eaAlfa + &13 + &10;
     |XGRABA nHandle, eaAlfa;

     |XCIERRA nHandle;

     |RSYSTEM aAbre;

     aAlfa = eaPathLanza + "imprime.bat";  |RFBORRA aAlfa;
     aAlfa = eaPathLanza + "wait.exe";     |RFBORRA aAlfa;
|FPRC;

|| ///////////////////////////////////////////////////////////////////
|PROCESO SoyUnaFecha;
     |QBF aFecha;
     |SI aFecha = "01.01.0000"; |O aFecha = "";
          aFecha = "00.00.0000";
     |FINSI;
     nNumero = nNumero;
     aAlfa = aFecha % 102;
     |HAZ QuitaRaros;
     |XGRABA nHandle, aAlfa;
     nNumero = nNumero + 1;
     aAlfa = aFecha % 402;
     |HAZ QuitaRaros;
     |XGRABA nHandle, aAlfa;
     nNumero = nNumero + 1;
     aAlfa = aFecha % -104;
     |HAZ QuitaRaros;
     |XGRABA nHandle, aAlfa;
     swFecha = 1;
|FPRC;

|PROCESO Numerico;
     aLong = aAlfa % 0;
     nLong = aLong;
     |QBF aAlfa;
     aAlfa1 = "0" * nLong;
     aAlfa = aAlfa1 + aAlfa;

     nNume = 100 + nLong;
     nNume = nNume * -1;
     aAlfa = aAlfa % nNume;
|FPRC;

|PROCESO Excep_1;
     |SI nNumero = 1; aAlfa = "<T036010>"; |FINSI;
     |SI nNumero = 2; aAlfa = " "; |FINSI;

     |SI nNumero = 3; aAlfa = "20130701"; |FINSI;  || tique 700000_8400 01.10.2013
     |SI nNumero = 3; |Y fFecha ] "01.06.2017"; aAlfa = "20170601"; |FINSI;

     |SI nNumero = 6; aAlfa = "             "; |FINSI;
     |SI nNumero = 30;
          aFecha = #42#27; |HAZ SoyUnaFecha;
     |FINSI;
     |SI nNumero = 35;
         aFecha = #42#30; |HAZ SoyUnaFecha;
     |FINSI;
     |SI nNumero = 39;
         aFecha = #42#32; |HAZ SoyUnaFecha;
     |FINSI;

     |SI fFecha ] "01.06.2017";
         |SI nNumero = 44; aAlfa = #42#37;  |FINSI;
         |SI nNumero = 45; aAlfa = #42#38;  |FINSI;
         |SI nNumero = 46; aAlfa = aNombre; |FINSI;
         |SI nNumero = 47; aAlfa = aBlanco * 83; |FINSI;
         |SI nNumero = 48; aAlfa = "</T036010>";  |FINSI;
         |SI nNumero = 49; aAlfa = &13 + &10;     |FINSI;
     |SINO;
         |SI nNumero = 44; aAlfa = aBlanco * 110; |FINSI;
         |SI nNumero = 45; aAlfa = "</T036010>";  |FINSI;
         |SI nNumero = 46; aAlfa = &13 + &10;     |FINSI;
     |FINSI;
|FPRC;

|PROCESO Excep_2A;
     |SI nNumero = 1; aAlfa = "<T03602A>"; |FINSI;
     |SI nNumero = 2; aAlfa = " "; |FINSI;
     |SI nNumero = 3;
         aAlfa = " ";
         |SI fFecha ] "01.06.2017";
             aAlfa = #43#2;
         |SINO;
             |SI #43#2 = "S"; aAlfa = "S"; |FINSI;
             |SI #43#3 = "S"; aAlfa = "N"; |FINSI;
         |FINSI;
     |FINSI;
     |SI nNumero = 6; aAlfa = "00000"; |FINSI;
     |SI nNumero = 11; aAlfa = "00000"; |FINSI;
     |SI nNumero = 24; aAlfa = "00000"; |FINSI;
     |SI nNumero = 43; aAlfa = "00000"; |FINSI;
     |SI nNumero = 56; aAlfa = "00000"; |FINSI;
     |SI nNumero = 75; aAlfa = "00000"; |FINSI;
     |SI nNumero = 88; aAlfa = "00000"; |FINSI;
     |SI nNumero = 91; aAlfa = aBlanco * 100; |FINSI;

     |SI nNumero = 100;
         aAlfa = " ";
         |SI #43#116 = "S"; aAlfa = "B"; |FINSI;
         |SI #43#115 = "S"; aAlfa = "A"; |FINSI;
     |FINSI;
     |SI nNumero = 101;
         aFecha = #43#117; |HAZ SoyUnaFecha;
     |FINSI;

     |SI nNumero = 104; aAlfa = #43#119; |FINSI;
     |SI nNumero = 105; aAlfa = #43#118; |FINSI;

     |SI fFecha ] "01.06.2017";
         |SI nNumero = 106; aAlfa = #43#120; |FINSI;
         |SI nNumero = 107; aAlfa = #43#121; |FINSI;
         |SI nNumero = 108; aAlfa = aBlanco * 147; |FINSI;
         |SI nNumero = 109; aAlfa = "</T03602A>"; |FINSI;
         |SI nNumero = 110; aAlfa = &13 + &10; |FINSI;
     |SINO;
         |SI nNumero = 106; aAlfa = aBlanco * 150; |FINSI;
         |SI nNumero = 107; aAlfa = "</T03602A>"; |FINSI;
         |SI nNumero = 108; aAlfa = &13 + &10; |FINSI;
     |FINSI;
|FPRC;

|PROCESO Excep_2B;
    |SI nNumero = 1; aAlfa = "<T03602B>"; |FINSI;
    |SI nNumero = 2; aAlfa = " "; |FINSI;
    |SI nNumero = 3;
        aAlfa = " ";
        |SI #44#2 = "S"; aAlfa = "S"; |FINSI;
        |SI #44#3 = "S"; aAlfa = "N"; |FINSI;
    |FINSI;
    |SI nNumero = 9;
        aFecha = #44#9; |HAZ SoyUnaFecha;
    |FINSI;
    |SI nNumero = 12;
        aFecha = #44#10; |HAZ SoyUnaFecha;
    |FINSI;
    |SI nNumero = 15;
        aFecha = #44#11; |HAZ SoyUnaFecha;
    |FINSI;
    |SI nNumero = 19; aAlfa = "00000"; |FINSI;
    |SI nNumero = 32; aAlfa = "00000"; |FINSI;
    |SI nNumero = 51; aAlfa = "00000"; |FINSI;
    |SI nNumero = 64; aAlfa = "00000"; |FINSI;
    |SI nNumero = 83; aAlfa = "00000"; |FINSI;
    |SI nNumero = 96; aAlfa = "00000"; |FINSI;

    |SI nNumero = 99;  aAlfa = aBlanco * 100; |FINSI;
    |SI nNumero = 124; aAlfa = #44#137;       |FINSI;
    |SI nNumero = 125; aAlfa = #44#136;       |FINSI;
    |SI fFecha ] "01.06.2017";
        |SI nNumero = 126; aAlfa = #44#138;       |FINSI;
        |SI nNumero = 127; aAlfa = #44#139;       |FINSI;
        |SI nNumero = 128; aAlfa = aBlanco * 147; |FINSI;
        |SI nNumero = 129; aAlfa = "</T03602B>";  |FINSI;
        |SI nNumero = 130; aAlfa = &13 + &10;     |FINSI;
    |SINO;
        |SI nNumero = 126; aAlfa = aBlanco * 149; |FINSI;
        |SI nNumero = 127; aAlfa = "</T03602B>";  |FINSI;
        |SI nNumero = 128; aAlfa = &13 + &10;     |FINSI;
    |FINSI;
|FPRC;

|PROCESO Excep_2C;

    |SI nNumero = 1; aAlfa = "<T03602C>"; |FINSI;
    |SI nNumero = 2; aAlfa = " "; |FINSI;
    |SI nNumero = 12; aAlfa = "00000"; |FINSI;
    |SI nNumero = 25; aAlfa = "00000"; |FINSI;
    |SI nNumero = 33; aAlfa = "00000"; |FINSI;
    |SI nNumero = 46; aAlfa = "00000"; |FINSI;

    |SI nNumero = 46; aAlfa = "00000"; |FINSI;
    |SI nNumero = 51; |O nNumero = 60;  aAlfa = "   "; |FINSI;
    |SI nNumero = 52; |O nNumero = 61;  aAlfa = aBlanco * 9; |FINSI;

    |SI nNumero = 64; aAlfa = #45#116; |FINSI;
    |SI nNumero = 65; aAlfa = #45#115; |FINSI;

    |SI fFecha ] "01.06.2017";
        |SI nNumero = 66; aAlfa = #45#117;       |FINSI;
        |SI nNumero = 67; aAlfa = aBlanco * 208; |FINSI;
        |SI nNumero = 68; aAlfa = "</T03602C>";  |FINSI;
        |SI nNumero = 69; aAlfa = &13 + &10;     |FINSI;
    |SINO;
        |SI nNumero = 66; aAlfa = aBlanco * 209; |FINSI;
        |SI nNumero = 67; aAlfa = "</T03602C>";  |FINSI;
        |SI nNumero = 68; aAlfa = &13 + &10;     |FINSI;
    |FINSI;
|FPRC;


|PROCESO Excep_3;
    |SI nNumero = 3;
        aAlfa = " ";
        |SI #46#3 = "S";
             aAlfa = "A";
        |SINO;
             |SI #46#4 = "S";
                 aAlfa = "B";
             |SINO;
                 |SI #46#5 = "S";
                     aAlfa = "M";
                 |FINSI;
             |FINSI;
        |FINSI;
    |FINSI;

    |SI nNumero = 4;
        aFecha = #46#6; |HAZ SoyUnaFecha;
    |FINSI;

    |SI nNumero = 11;
        aFecha = #46#39; |HAZ SoyUnaFecha;
    |FINSI;

    |SI nNumero = 18;
        |SI fFecha ] "01.06.2017";
            aAlfa = aBlanco * 182;
        |SINO;
            aAlfa = aBlanco * 125;
        |FINSI;
    |FINSI;

    |SI nNumero = 19;
        aAlfa = " ";
        |SI #agicen46#30 = "S";
            aAlfa = "L";
        |FINSI;
        |SI #agicen46#32 = "S";
            aAlfa = "V";
        |FINSI;
    |FINSI;
|FPRC;

|PROCESO Excep_5;
    |SI nNumero = 1; aAlfa = "<T036050>"; |FINSI;
    |SI nNumero = 2; aAlfa = " "; |FINSI;
    |SI nNumero = 4; aFecha = #49#47; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 8; aFecha = #49#80; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 14; aFecha = #49#5; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 18; aFecha = #49#7; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 22; aFecha = #49#9; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 26; aFecha = #49#11; |HAZ SoyUnaFecha; |FINSI;

    |SI nNumero = 31; aFecha = #49#14; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 36; aFecha = #49#18; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 41; aFecha = #49#22; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 46; aFecha = #49#26; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 51; aFecha = #49#30; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 54; aAlfa  = aBlanco * 15; |FINSI;

    |SI nNumero = 55;
         aAlfa = " ";
         |SI #49#36 = "S"; aAlfa = "1"; |FINSI;
         |SI #49#40 = "S"; aAlfa = "2"; |FINSI;
         |SI #49#44 = "S"; aAlfa = "3"; |FINSI;
         |SI #49#48 = "S"; aAlfa = "4"; |FINSI;
         |SI #49#72 = "S"; aAlfa = "5"; |FINSI;
    |FINSI;
    |SI nNumero = 56;
         aAlfa = "      ";
         |SI #49#36 = "S"; aAlfa = #49#37; |FINSI;
         |SI #49#40 = "S"; aAlfa = #49#41; |FINSI;
         |SI #49#44 = "S"; aAlfa = #49#45; |FINSI;
         |SI #49#48 = "S"; aAlfa = #49#49; |FINSI;
         |SI #49#72 = "S"; aAlfa = #49#73; |FINSI;
    |FINSI;
    |SI nNumero = 57;
         aAlfa = "        ";
         |SI #49#36 = "S"; aFecha = #49#38; |FINSI;
         |SI #49#40 = "S"; aFecha = #49#42; |FINSI;
         |SI #49#44 = "S"; aFecha = #49#46; |FINSI;
         |SI #49#48 = "S"; aFecha = #49#50; |FINSI;
         |SI #49#72 = "S"; aFecha = #49#74; |FINSI;
         |HAZ SoyUnaFecha;
    |FINSI;

    |SI nNumero = 60;
         aAlfa = "";
         |SI #49#52 = "S"; aAlfa = "1"; |FINSI;
         |SI #49#56 = "S"; aAlfa = "2"; |FINSI;
         |SI #49#60 = "S"; aAlfa = "3"; |FINSI;
         |SI #49#64 = "S"; aAlfa = "4"; |FINSI;
         |SI #49#68 = "S"; aAlfa = "5"; |FINSI;
         |SI aAlfa = ""; aAlfa = "0"; |FINSI;
    |FINSI;
    |SI nNumero = 61;
         aAlfa = "      ";
         |SI #49#52 = "S"; aAlfa = #49#53; |FINSI;
         |SI #49#56 = "S"; aAlfa = #49#57; |FINSI;
         |SI #49#60 = "S"; aAlfa = #49#61; |FINSI;
         |SI #49#64 = "S"; aAlfa = #49#65; |FINSI;
         |SI #49#68 = "S"; aAlfa = #49#69; |FINSI;
    |FINSI;
    |SI nNumero = 62;
         aAlfa = "        ";
         |SI #49#52 = "S"; aFecha = #49#54; |FINSI;
         |SI #49#56 = "S"; aFecha = #49#58; |FINSI;
         |SI #49#60 = "S"; aFecha = #49#62; |FINSI;
         |SI #49#64 = "S"; aFecha = #49#66; |FINSI;
         |SI #49#68 = "S"; aFecha = #49#70; |FINSI;
         |HAZ SoyUnaFecha;
    |FINSI;
    |SI nNumero = 67; aFecha = #49#78; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 72; aFecha = #49#86; |HAZ SoyUnaFecha; |FINSI;

    |SI nNumero = 75;
         nNume = #49#88 * 100;
         aAlfa = nNume;
         aAlfa = ("00000" + aAlfa) % -105;
    |FINSI;
    |SI nNumero = 77;
         nNume = #49#90; aAlfa = nNume; aAlfa = ("000" + aAlfa) % -103;
    |FINSI;
    |SI nNumero = 78;
         nNume = #49#91; aAlfa = nNume; aAlfa = ("000" + aAlfa) % -103;
    |FINSI;
    |SI nNumero = 79;
         nNume = #49#92; aAlfa = nNume; aAlfa = ("000" + aAlfa) % -103;
    |FINSI;
    |SI nNumero = 81;
         nNume = #49#94; aAlfa = nNume; aAlfa = ("000" + aAlfa) % -103;
    |FINSI;
    |SI nNumero = 82;
         nNume = #49#95; aAlfa = nNume; aAlfa = ("000" + aAlfa) % -103;
    |FINSI;
    |SI nNumero = 83;
         nNume = #49#96; aAlfa = nNume; aAlfa = ("000" + aAlfa) % -103;
    |FINSI;
    |SI nNumero = 85;
         nNume = #49#98; aAlfa = nNume; aAlfa = ("000" + aAlfa) % -103;
    |FINSI;
    |SI nNumero = 86;
         nNume = #49#99; aAlfa = nNume; aAlfa = ("000" + aAlfa) % -103;
    |FINSI;
    |SI nNumero = 87;
         nNume = #49#100; aAlfa = nNume; aAlfa = ("000" + aAlfa) % -103;
    |FINSI;

    |SI nNumero = 89;
         aAlfa = " ";
         |SI #49#102 = "S"; aAlfa = "1"; |FINSI;
         |SI #49#105 = "S"; aAlfa = "2"; |FINSI;
         |SI #49#108 = "S"; aAlfa = "3"; |FINSI;
         |SI #49#111 = "S"; aAlfa = "4"; |FINSI;
         |SI #49#114 = "S"; aAlfa = "5"; |FINSI;
    |FINSI;
    |SI nNumero = 90;
         aAlfa = "      ";
         |SI #49#102 = "S"; aAlfa = #49#103; |FINSI;
         |SI #49#105 = "S"; aAlfa = #49#106; |FINSI;
         |SI #49#108 = "S"; aAlfa = #49#109; |FINSI;
         |SI #49#111 = "S"; aAlfa = #49#112; |FINSI;
         |SI #49#114 = "S"; aAlfa = #49#115; |FINSI;
    |FINSI;
    |SI nNumero = 91;
         aAlfa = "        ";
         |SI #49#102 = "S"; aFecha = #49#104; |FINSI;
         |SI #49#105 = "S"; aFecha = #49#107; |FINSI;
         |SI #49#108 = "S"; aFecha = #49#110; |FINSI;
         |SI #49#111 = "S"; aFecha = #49#113; |FINSI;
         |SI #49#114 = "S"; aFecha = #49#116; |FINSI;
         |HAZ SoyUnaFecha;
    |FINSI;

    |SI nNumero = 95;
         aAlfa = " ";
         |SI #49#118 = "S"; aAlfa = "1"; |FINSI;
         |SI #49#119 = "S"; aAlfa = "3"; |FINSI;
    |FINSI;
    |SI nNumero = 96; aFecha = #49#121; |HAZ SoyUnaFecha; |FINSI;

    |SI nNumero = 99;
         aAlfa = " ";
         |SI #49#124 = "S"; aAlfa = "1"; |FINSI;
         |SI #49#125 = "S"; aAlfa = "3"; |FINSI;
    |FINSI;
    |SI nNumero = 100; aFecha = #49#126; |HAZ SoyUnaFecha; |FINSI;

    |SI nNumero = 104; aFecha = #49#123; |HAZ SoyUnaFecha; |FINSI;

    |SI nNumero = 107;  aAlfa = aBlanco * 80; |FINSI;
    |SI nNumero = 108;  aAlfa = "</T036050>"; |FINSI;
    |SI nNumero = 109;  aAlfa = &13 + &10;    |FINSI;

|FPRC;

|PROCESO Excep_6;
    |SI nNumero = 1; aAlfa = "<T036060>"; |FINSI;
    |SI nNumero = 2; aAlfa = " "; |FINSI;
    |SI nNumero = 4; aFecha = #50#4; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 8; aFecha = #50#5; |HAZ SoyUnaFecha; |FINSI;

    |SI nNumero = 11;
         aAlfa = " ";
         |SI #50#6 = "S"; aAlfa = "1"; |FINSI;
         |SI #50#7 = "S"; aAlfa = "3"; |FINSI;
         |SI #50#8 = "S"; aAlfa = "4"; |FINSI;
         |SI #50#9 = "S"; aAlfa = "2"; |FINSI;
         |SI #50#39 = "S"; aAlfa = "5"; |FINSI;
    |FINSI;
    |SI nNumero = 12; aFecha = #50#40; |HAZ SoyUnaFecha; |FINSI;

    |SI nNumero = 15;
         aAlfa = " ";
         |SI #50#10 = "S"; aAlfa = "1"; |FINSI;
         |SI #50#41 = "S"; aAlfa = "5"; |FINSI;
    |FINSI;
    |SI nNumero = 16; aFecha = #50#42; |HAZ SoyUnaFecha; |FINSI;

    |SI nNumero = 19;
         aAlfa = " ";
         |SI #50#11 = "S"; aAlfa = "1"; |FINSI;
         |SI #50#12 = "S"; aAlfa = "3"; |FINSI;
         |SI #50#13 = "S"; aAlfa = "4"; |FINSI;
         |SI #50#14 = "S"; aAlfa = "2"; |FINSI;
         |SI #50#43 = "S"; aAlfa = "5"; |FINSI;
    |FINSI;
    |SI nNumero = 20; aFecha = #50#78; |HAZ SoyUnaFecha; |FINSI;

    |SI nNumero = 48; aFecha = #50#71; |HAZ SoyUnaFecha; |FINSI;

    |SI nNumero = 51;
         aFecha = #50#70;
         |QBF aFecha;
         |SI aFecha > "01.01.0000"
              aAlfa = aFecha % 102;
         |SINO;
              aAlfa = "00";
         |FINSI;
    |FINSI;
    |SI nNumero = 52;
         aFecha = #50#70;
         |QBF aFecha;
         |SI aFecha > "01.01.0000"
              aAlfa = aFecha % 402;
         |SINO;
              aAlfa = "00";
         |FINSI;
    |FINSI;

    |SI nNumero = 54; aFecha = #50#72; |HAZ SoyUnaFecha; |FINSI;

    |SI nNumero = 58;
         aAlfa = " ";
         |SI #50#53 = "S"; aAlfa = "1"; |FINSI;
         |SI #50#54 = "S"; aAlfa = "3"; |FINSI;
         |SI #50#55 = "S"; aAlfa = "2"; |FINSI;
         |SI #50#85 = "S"; aAlfa = "4"; |FINSI;
    |FINSI;
    |SI nNumero = 59;
         aAlfa = "        ";
         |SI #50#53 = "S"; aFecha = #50#73; |FINSI;
         |SI #50#54 = "S"; aFecha = #50#74; |FINSI;
         |SI #50#55 = "S"; aFecha = #50#75; |FINSI;
         |SI #50#85 = "S"; aFecha = #50#86; |FINSI;
         |HAZ SoyUnaFecha;
    |FINSI;

    |SI nNumero = 63; aFecha = #50#76; |HAZ SoyUnaFecha; |FINSI;

    |SI nNumero = 66;
         aAlfa = " ";
         |SI #50#60 = "S"; aAlfa = "1"; |FINSI;
         |SI #50#61 = "S"; aAlfa = "2"; |FINSI;
         |SI #50#62 = "S"; aAlfa = "3"; |FINSI;
    |FINSI;

    |SI nNumero = 68; aFecha = #50#66; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 72; aFecha = #50#67; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 76; aFecha = #50#68; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 80; aFecha = #50#81; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 84; aFecha = #50#82; |HAZ SoyUnaFecha; |FINSI;

    |SI nNumero = 87; aAlfa = aBlanco * 184; |FINSI;
    |SI nNumero = 88; aAlfa = "</T036060>"; |FINSI;
    |SI nNumero = 89; aAlfa = &13 + &10; |FINSI;
|FPRC;

|PROCESO Excep_7A;
    |SI nNumero = 1; aAlfa = "<T036070>"; |FINSI;
    |SI nNumero = 2; aAlfa = " "; |FINSI;

    |SI nNumero = 4; aFecha = #51#22; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 8; aFecha = #51#23; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 12; aFecha = #51#24; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 16; aFecha = #51#25; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 20; aFecha = #51#26; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 24; aFecha = #51#27; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 28; aFecha = #51#28; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 32; aFecha = #51#29; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 36; aFecha = #51#32; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 40; aFecha = #51#33; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 44; aFecha = #51#34; |HAZ SoyUnaFecha; |FINSI;
    |SI nNumero = 48; aFecha = #51#35; |HAZ SoyUnaFecha; |FINSI;
|FPRC;

|PROCESO Excep_7B;  || tique 700000_8400

    |SI nNumero = 135; aAlfa = #52#87; |FINSI;
    |SI nNumero = 136; aAlfa = #52#88; |FINSI;
    |SI nNumero = 137; aAlfa = #52#89; |FINSI;

    |SI nNumero = 138; aAlfa  = #51#36; |FINSI;
    |SI nNumero = 139; aFecha = #51#37; |HAZ SoyUnaFecha; |FINSI;

    |SI nNumero = 142; aAlfa = aBlanco * 176; |FINSI;
    |SI nNumero = 143; aAlfa = "</T036070>"; |FINSI;
    |SI nNumero = 144; aAlfa = &13 + &10; |FINSI;

|FPRC;

|PROCESO Excep_8;
    |SI nNumero = 3;
         aAlfa = " ";
         |SI #53#3 = "S";
              aAlfa = "A";
         |SINO;
              |SI #53#4 = "S";
                   aAlfa = "B";
              |SINO;
                   |SI #53#5 = "S";
                        aAlfa = "M";
                   |FINSI;
              |FINSI;
         |FINSI;
    |FINSI;
    |SI nNumero = 4;
         aFecha = #53#6; |HAZ SoyUnaFecha;
    |FINSI;

  ||  |SI nNumero = 10; aAlfa = "00000"; |FINSI;
  ||  |SI nNumero = 23; aAlfa = "00000"; |FINSI;
  ||  |SI nNumero = 26; aAlfa = aBlanco * 100; |FINSI;

    |SI nNumero = 41;
         nNume = #53#18 * 100;
         aAlfa = nNume;
         aAlfa = ("00000" + aAlfa) % -105;
    |FINSI;
    |SI nNumero = 42;
         aAlfa = " ";
         |SI #53#19 = "S"; |O #53#20 = "S"; aAlfa = "S"; |FINSI;
    |FINSI;
    |SI nNumero = 43;
         aAlfa = " ";
         |SI #53#21 = "S"; |O #53#22 = "S"; aAlfa = "S"; |FINSI;
    |FINSI;
    |SI nNumero = 44;
         aAlfa = " ";
         |SI #53#23 = "S"; |O #53#24 = "S"; aAlfa = "S"; |FINSI;
    |FINSI;
    |SI nNumero = 45;
         aAlfa = " ";
         |SI #53#25 = "S"; |O #53#26 = "S"; aAlfa = "S"; |FINSI;
    |FINSI;

|FPRC;

|PROCESO Agiw0073F;
   nNume1 = nNume1 + 1;
   |SI nNume1 [ nNumCampos;
       |PARA nNumero = nNume1; |SI nNumero [ nNumCampos; |HACIENDO nNumero = nNumero + 1;
             swFecha = 0;  aFecha = "";
             aAlfa   = "";
             |SI aHoja = "1 ";   |HAZ Excep_1;  |FINSI;
             |SI aHoja = "2A";   |HAZ Excep_2A; |FINSI;
             |SI aHoja = "2B";   |HAZ Excep_2B; |FINSI;
             |SI aHoja = "2C";   |HAZ Excep_2C; |FINSI;
             |SI aHoja = "3 ";   |HAZ Excep_3;  |FINSI;
             |SI aHoja = "5 ";   |HAZ Excep_5;  |FINSI;
             |SI aHoja = "6 ";   |HAZ Excep_6;  |FINSI;
             |SI aHoja = "7A";   |HAZ Excep_7A; |FINSI;
             |SI aHoja = "7B";   |HAZ Excep_7B; |FINSI;
             |SI aHoja = "8 ";   |HAZ Excep_8;  |FINSI;

             |SI swFecha = 0; |Y aAlfa ! "";
                 |HAZ QuitaRaros;
                 |XGRABA nHandle, aAlfa;
             |FINSI;
       |SIGUE;
   |FINSI;
|FPRC;

|PROCESO Agiw0073C;
   nNume1 = nNume1 + 1;
   nConta = #73#1;

   |PARA nNumero = nNume1; |SI nNumero [ nConta; |HACIENDO nNumero = nNumero + 1;
         swFecha = 0;  aFecha = "";
         aAlfa   = "";
         |SI nConta = nNumero;   || Campo del Fichero
             nCampo = #73#2;

             |SI #73#0 = "1 ";
                 aAlfa = #42nCampo;
                 |SI nCampo = 33;  aAlfa = aAlfa % 101;  |FINSI;
             |FINSI;
             |SI #73#0 = "2A";
                 |SI fFecha ] "01.06.2017";
                     |SI nCampo = 29; |O nCampo = 41; |O nCampo = 57;
                      |O nCampo = 58; |O nCampo = 59; |O nCampo = 66;
                       |O nCampo = 67; |O nCampo = 68; |O nCampo = 71;
                         |O nCampo = 87; |O nCampo = 88; |O nCampo = 89;
                            #43nCampo = "";
                     |FINSI;
                 |FINSI;
                 aAlfa = #43nCampo;
             |FINSI;
             |SI #73#0 = "2B";
                 |SI fFecha ] "01.06.2017";
                     |SI nCampo = 29; |O nCampo = 41; |O nCampo = 57;
                      |O nCampo = 58; |O nCampo = 59; |O nCampo = 66;
                       |O nCampo = 67; |O nCampo = 68; |O nCampo = 71;
                         |O nCampo = 87; |O nCampo = 88; |O nCampo = 89;
                            #44nCampo = "";
                     |FINSI;
                 |FINSI;
                 aAlfa = #44nCampo;
             |FINSI;
             |SI #73#0 = "2C";
                 |SI nCampo = 29; |O nCampo = 59; |O nCampo = 68;
                     #45nCampo = "";
                 |FINSI;
                 aAlfa = #45nCampo;
             |FINSI;
             |SI #73#0 = "3 ";
                 |SI fFecha ] "01.06.2017";
                     aAlfa = #46nCampo;
                 |SINO;
                     |SI nCampo < 10; |O nCampo > 19;
                         aAlfa = #46nCampo;
                     |SINO;
                         #73#3 = "A";
                         |SI nCampo = 10;
                             aAlfa = aBlanco * 200;
                         |FINSI;
                     |FINSI;
                 |FINSI;
             |FINSI;
             |SI #73#0 = "5 ";
                 aAlfa = #49nCampo;
                 |SI nCampo = 32; aAlfa = " ";      |FINSI;
                 |SI nCampo = 33; aAlfa = "      "; |FINSI;
             |FINSI;
             |SI #73#0 = "6 ";  aAlfa = #50nCampo; |FINSI;
             |SI #73#0 = "7A";  aAlfa = #51nCampo; |FINSI;
             |SI #73#0 = "7B";  aAlfa = #52nCampo; |FINSI;
             |SI #73#0 = "8 ";
                 aAlfa = #53nCampo;    || tique 2430_318
                 |SI nConta = 9;   aAlfa = aBlanco * 250; |FINSI;
                 |SI nConta = 11;  aAlfa = aBlanco * 75;  |FINSI;
                 |SI nConta ] 12; |Y nConta [ 29; aAlfa = ""; |FINSI;
              |FINSI;

             |SI #73#3 = "N";  |HAZ Numerico; |FINSI;
         |SINO;
             |SI #73#0 = "1 ";   |HAZ Excep_1;  |FINSI;
             |SI #73#0 = "2A";   |HAZ Excep_2A; |FINSI;
             |SI #73#0 = "2B";   |HAZ Excep_2B; |FINSI;
             |SI #73#0 = "2C";   |HAZ Excep_2C; |FINSI;
             |SI #73#0 = "3 ";   |HAZ Excep_3;  |FINSI;
             |SI #73#0 = "5 ";   |HAZ Excep_5;  |FINSI;
             |SI #73#0 = "6 ";   |HAZ Excep_6;  |FINSI;
             |SI #73#0 = "7A";   |HAZ Excep_7A; |FINSI;
             |SI #73#0 = "7B";   |HAZ Excep_7B; |FINSI;
             |SI #73#0 = "8 ";   |HAZ Excep_8;  |FINSI;
         |FINSI;
         |SI swFecha = 0;
             |HAZ QuitaRaros;
             |SI aAlfa ! "";
                 |XGRABA nHandle, aAlfa;
             |FINSI;
         |FINSI;
   |SIGUE;
   nNume1 = #73#1;
|FPRC;

|DEFBUCLE Agiw0073;
  #73#1;
  ;
  aHoja, 001;
  aHoja, 999;
  ;
  NULL, Agiw0073C, NULL, NULL, Agiw0073F;
|FIN;


|PROCESO Hoja1_2007;     || CAUSAS DE PRESENTACION

     |ABRE #42;
     #42#0 = enEmpresa;
     #42#1 = enRegistro;
     |LEE 040#42=;
     |SI FSalida ! 0;  |DDEFECTO #42;  |FINSI;
     |CIERRA #42;
     |HAZ PersonaFisica;

     aHoja      = "1 ";
     nNume1     = 0;
     |SI fFecha ] "01.06.2017";
          nNumCampos = 49;
     |SINO;
          nNumCampos = 46;
     |FINSI;
     |BUCLE Agiw0073;
|FPRC;

|PROCESO Hoja2A_2007;    || IDENTIFICACION PERSONAS FISICAS
     |ABRE #43;
     #43#0 = enEmpresa;
     #43#1 = enRegistro;
     |LEE 040#43=;
     |SI FSalida ! 0; |O swDefectoA = 1;
          |DDEFECTO #43;
     |FINSI;
     |CIERRA #43;

     aHoja      = "2A";
     nNume1     = 0;
     |SI fFecha ] "01.01.2017";
          nNumCampos = 110;
     |SINO;
          nNumCampos = 108;
     |FINSI;
     |BUCLE Agiw0073;
|FPRC;

|PROCESO Hoja2B_2007;    || IDENTIFICACION PERSONAS JURIDICAS
     |ABRE #44;
     #44#0 = enEmpresa;
     #44#1 = enRegistro;
     |LEE 040#44=;
     |SI FSalida ! 0; |O swDefectoB = 1;
          |DDEFECTO #44;
     |FINSI;
     |CIERRA #44;

     aHoja      = "2B";
     nNume1     = 0;
     |SI fFecha ] "01.06.2017";
         nNumCampos = 130;
     |SINO;
         nNumCampos = 128;
     |FINSI;
     |BUCLE Agiw0073;
|FPRC;

|PROCESO Hoja2C_2007;    || IDENTIFICACION ESTABLECIMENTOS PERMANENTES
     |ABRE #45;
     #45#0 = enEmpresa;
     #45#1 = enRegistro;
     |LEE 040#45=;
     |SI FSalida ! 0; |O swDefectoB = 1;
          |DDEFECTO #45;
     |FINSI;
     |CIERRA #45;

     aHoja      = "2C";
     nNume1     = 0;
     |SI fFecha ] "01.06.2017";
         nNumCampos = 69;
     |SINO;
         nNumCampos = 68;
     |FINSI;
     |BUCLE Agiw0073;
|FPRC;

|PROCESO ElRepre;
     aHoja      = "3 ";
     nNume1     = 2;
     nNumCampos = 22;
     |BUCLE Agiw0073;
|FPRC;

|PROCESO Hoja3_2007;    || REPRESENTANTES

     swCual = 0;
     |ABRE #46;
     |PARA nRepre = 1; |SI nRepre [ 20; |HACIENDO nRepre = nRepre + 1;

           #46#0 = enEmpresa;
           #46#1 = enRegistro;
           #46#2 = nRepre;
           |LEE 040#46=;
           FEstado = FSalida;
           |SI FSalida ! 0;  |DDEFECTO #46;  |FINSI;

           |SI FEstado = 0; |O nRepre = 1;

               |SI swCual [ 1;
                   nNumero = 1; aAlfa = "<T036030>";
                   |XGRABA nHandle, aAlfa;

                   nNumero = 2; aAlfa = " ";
                   |SI swCual = 1; aAlfa = "C"; |FINSI;
                   |XGRABA nHandle, aAlfa;

                   |HAZ ElRepre;
                   swCual = 2;

               |SINO;

                   |HAZ ElRepre;
                   aAlfa = aBlanco * 228;
                   |XGRABA nHandle, aAlfa;
                   aAlfa = "</T036030>";
                   |XGRABA nHandle, aAlfa;
                   aAlfa = &13 + &10;
                   |XGRABA nHandle, aAlfa;
                   swCual = 1;

               |FINSI;
           |SINO;
               |SI nRepre = 20; |Y swCual = 2;
                   |HAZ ElRepre;
                   aAlfa = aBlanco * 228;
                   |XGRABA nHandle, aAlfa;
                   aAlfa = "</T036030>";
                   |XGRABA nHandle, aAlfa;
                   aAlfa = &13 + &10;
                   |XGRABA nHandle, aAlfa;
                   swCual = 1;
               |FINSI;
           |FINSI;
     |SIGUE;
     |CIERRA #46;
|FPRC;

|PROCESO Locales;
     |PARA nNumero = 19;  |SI nNumero [ 44;  |HACIENDO nNumero = nNumero + 1;
          swFecha = 0; aFecha = "";
          aAlfa = "";
          #73#0 = "4B";
          #73#1 = nNumero;
          |LEE 000#73=;
          |SI FSalida = 0;
               nCampo = #73#2;
               aAlfa = #480nCampo;
               |SI #73#3 = "N"; |HAZ Numerico; |FINSI;
          |SINO;
               |SI nNumero = 27;
                    aAlfa = #480#11 % 102;
               |FINSI;
               |SI nNumero = 28; aAlfa = "000000"; |FINSI;
               |SI nNumero = 29;
                    aAlfa = #480#16;
                    aAlfa = ("0000000" + aAlfa) % -107;
               |FINSI;
               |SI nNumero = 30;
                    aAlfa = #480#17;
                    aAlfa = ("000" + aAlfa) % -103;
                    |SI nLocal = 1; |O nLocal = 2;
                         aAlfa = aAlfa;
                    |SINO;
                         aAlfa = aAlfa + #480#27;
                    |FINSI;
               |FINSI;
               |SI nNumero = 32;
                    aFecha = #480#19; |HAZ SoyUnaFecha;
               |FINSI;
               |SI nNumero = 36;
                    aFecha = #480#22; |HAZ SoyUnaFecha;
               |FINSI;
               |SI nNumero = 41;
                    aFecha = #480#25; |HAZ SoyUnaFecha;
               |FINSI;
          |FINSI;
          |SI swFecha = 0;
               |HAZ QuitaRaros;
               |XGRABA nHandle, aAlfa;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Actividades;
     |PARA nNumero = 3;  |SI nNumero [ 18;  |HACIENDO nNumero = nNumero + 1;
          swFecha = 0; aFecha = "";
          aAlfa = "";
          #73#0 = "4A";
          #73#1 = nNumero;
          |LEE 000#73=;
          |SI FSalida = 0;
               nCampo = #73#2;
               aAlfa = #47nCampo;
               |SI nCampo = 3;
                   |SI aAlfa = "E"; aAlfa = "1"; |FINSI;
                   |SI aAlfa = "P"; aAlfa = "2"; |FINSI;
                   |SI aAlfa = "A"; aAlfa = "3"; |FINSI;
               |FINSI;
               |SI #73#3 = "N"; |HAZ Numerico; |FINSI;
          |SINO;
               |SI nNumero = 8;
                    aFecha = #47#10; |HAZ SoyUnaFecha;
               |FINSI;
               |SI nNumero = 12;
                    aFecha = #47#13; |HAZ SoyUnaFecha;
               |FINSI;
               |SI nNumero = 17;
                    aAlfa = #47#16; |QBF aAlfa; aAlfa = ("00" + aAlfa) % -102;
                    |SI aAlfa = "00";
                         aAlfa = "  ";
                    |FINSI;
               |FINSI;
               |SI nNumero = 18; aAlfa = "000000"; |FINSI;
          |FINSI;
          |SI swFecha = 0;
               |HAZ QuitaRaros;
               |XGRABA nHandle, aAlfa;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Hoja4_2007;    || LOCALES
     swRepite = 0;
     |ABRE #47;
     |PARA nActiv = 1; |SI nActiv [ 9; |HACIENDO nActiv = nActiv + 1;
           #47#0 = enEmpresa;
           #47#1 = enRegistro;
           #47#2 = nActiv;
           |LEE 040#47=;
           |SI FSalida ! 0;
               |SI nActiv = 1;
                   |DDEFECTO #47;      || el principal siempre
               |SINO;
                   |CIERRA #47;
                   |SAL;
               |FINSI;
           |FINSI;

           nNumero = 1; aAlfa = "<T036040>";
           |HAZ QuitaRaros; |XGRABA nHandle, aAlfa;

           nNumero = 2;
           |SI nActiv = 1;
               aAlfa = " ";
           |SINO;
               aAlfa = "C";
           |FINSI;
           |HAZ QuitaRaros; |XGRABA nHandle, aAlfa;

           |ABRE #73;
           |HAZ Actividades;

           |PARA nLocal = 1; |SI nLocal [ 25; |Y swRepite = 0;
           |HACIENDO nLocal = nLocal + 1;
                 |ABRE #480;
                 #480#0 = enEmpresa;
                 #480#1 = enRegistro;
                 #480#2 = nActiv;
                 #480#3 = nLocal;
                 |LEE 040#480=;
                 |SI FSalida = 0;
                     aLocal = nLocal;
                     aLocal = ("00" + aLocal) % -102;
                     |SI #480#4 = "D";
                          aLocalesDet = aLocalesDet + aLocal;
                          nLocalesDet = nLocalesDet + 1;
                     |FINSI;
                     |SI #480#4 = "I";
                          aLocalesInd = aLocalesInd + aLocal;
                          nLocalesInd = nLocalesInd + 1;
                     |FINSI;
                     nLocales = nLocales + 1;
                 |FINSI;
           |SIGUE;
           |SI nLocales = 0;
               nLocales = 4;
               nLocalesDet = 2;
               aLocalesDet = "0000";
               nLocalesInd = 2;
               aLocalesInd = "0000";
           |FINSI;
           |SI nLocales > 0;
               |PARA nLocal = 1; |SI nLocal [ 4; |HACIENDO nLocal = nLocal + 1;
                     nLineaLocal = 0;
                     |SI nLocal = 1; |O nLocal = 2;
                         |SI nLocalesDet > 0;
                             aLocal = aLocalesDet % 102;
                             nLineaLocal = aLocal;

                             aLocalesDet = aLocalesDet - aLocal;
                             nLocalesDet = nLocalesDet - 1;
                             nLocales = nLocales - 1;
                         |FINSI;
                     |FINSI;
                     |SI nLocal = 3; |O nLocal = 4;
                         |SI nLocalesInd > 0;
                             aLocal = aLocalesInd % 102;
                             nLineaLocal = aLocal;

                             aLocalesInd = aLocalesInd - aLocal;
                             nLocalesInd = nLocalesInd - 1;
                             nLocales = nLocales - 1;
                         |FINSI;
                     |FINSI;

                     |SI nLineaLocal = 0;
                         |DDEFECTO #480;
                     |SINO;
                         |ABRE #480;
                         #480#0 = enEmpresa;
                         #480#1 = enRegistro;
                         #480#2 = nActiv;
                         #480#3 = nLineaLocal;
                         |LEE 040#480=;
                         |CIERRA #480;
                     |FINSI;
                     |HAZ Locales;
               |SIGUE;
               |CIERRA #73;
          |FINSI;
          |SI nLocales > 0;
              swRepite = 1;
              nActiv = nActiv - 1;
          |SINO;
              swRepite = 0;
          |FINSI;
           aAlfa = "</T036040>";
           |HAZ QuitaRaros; |XGRABA nHandle, aAlfa;
           aAlfa = &13 + &10;
           |HAZ QuitaRaros; |XGRABA nHandle, aAlfa;
     |SIGUE;
     |CIERRA #47;
|FPRC;

|PROCESO Hoja5_2007;    || SUJETO PASIVO GRAN EMPRESA - IVA
     |ABRE #49;
     #49#0 = enEmpresa;
     #49#1 = enRegistro;
     |LEE 141#49=;
     |SI FSalida ! 0;
         |DDEFECTO #49;
     |SINO;
         |SI #49#118 = "N"; #49#118 = " "; |FINSI;
         |SI #49#119 = "N"; #49#119 = " "; |FINSI;
         |SI #49#120 = "N"; #49#120 = " "; |FINSI;
         |SI #49#118 = " "; |Y #49#119 = " ";
             #49#121 = "01.01.0000";
         |FINSI;
         |SI #49#124 = " "; |Y #49#125 = " ";
             #49#126 = "01.01.0000";
         |FINSI;
         |GRABA 020#49a;
     |FINSI;
     |LIBERA #49;
     |CIERRA #49;

     aHoja      = "5 ";
     nNume1     = 0;
     nNumCampos = 109;
     |BUCLE Agiw0073;
|FPRC;

|PROCESO Hoja6_2007;    || IRPF
     |ABRE #50;
     #50#0 = enEmpresa;
     #50#1 = enRegistro;
     |LEE 040#50=;
     |SI FSalida ! 0;  |DDEFECTO #50;  |FINSI;
     |CIERRA #50;

     aHoja      = "6 ";
     nNume1     = 0;
     nNumCampos = 89;
     |BUCLE Agiw0073;
|FPRC;

|PROCESO Hoja7_2007;    || REGIMENES ESPECIALES COMERCIO INTRACOMUNITARIO
     |ABRE #51;
     #51#0 = enEmpresa;
     #51#1 = enRegistro;
     |LEE 040#51=;
     |SI FSalida ! 0;  |DDEFECTO #51;  |FINSI;
     |CIERRA #51;

     aHoja      = "7A";
     nNume1     = 0;
     nNumCampos = 48;
     |BUCLE Agiw0073;

     |ABRE #52;
     #52#0 = enEmpresa;
     #52#1 = enRegistro;
     |LEE 040#52=;
     |SI FSalida ! 0;  |DDEFECTO #52;  |FINSI;
     |CIERRA #52;

     aHoja      = "7B";
     nNume1     = 50;
     nNumCampos = 144;
     |BUCLE Agiw0073;
|FPRC;

|PROCESO ElSocio;
     aHoja      = "8 ";
     nNume1     = 2;
     nNumCampos = 45;
     |BUCLE Agiw0073;

     nNume  = #53#72 * 100;
     aAlfa2 = nNume;
     aAlfa2 = ("00000" + aAlfa2) % -105;
     |SI swCual [ 1;  aAlfaS1 = aAlfa2; |FINSI;
     |SI swCual = 2;  aAlfaS2 = aAlfa2; |FINSI;
|FPRC;

|PROCESO Hoja8_2007;     || SOCIOS MIEMBROS O PARTICIPES
     swCual = 0;
     aAlfaS1 = ""; aAlfaS2 = "";
     |ABRE #53;
     |PARA nSocio = 1; |SI nSocio [ 20; |HACIENDO nSocio = nSocio + 1;
          #53#0 = enEmpresa;
          #53#1 = enRegistro;
          #53#2 = nSocio;
          |LEE 040#53=;
          FEstado = FSalida;
          |SI FSalida ! 0;  |DDEFECTO #53;  |FINSI;

          |SI FEstado = 0; |O nSocio = 1;
               |SI swCual [ 1;

                    aAlfaS1 = ""; aAlfaS2 = "";
                    nNumero = 1; aAlfa = "<T036080>"; |XGRABA nHandle, aAlfa;
                    nNumero = 2;
                    aAlfa = " "; |SI swCual = 1; aAlfa = "C"; |FINSI;
                    |XGRABA nHandle, aAlfa;
                    |HAZ ElSocio;
                    swCual = 2;

               |SINO;

                    |HAZ ElSocio;
                    aAlfa = aAlfaS1; |XGRABA nHandle, aAlfa;
                    aAlfa = aAlfaS2; |XGRABA nHandle, aAlfa;

                    aAlfa = aBlanco * 142; |XGRABA nHandle, aAlfa;

                    aAlfa = "</T036080>";  |XGRABA nHandle, aAlfa;
                    aAlfa = &13 + &10;     |XGRABA nHandle, aAlfa;
                    swCual = 1;

               |FINSI;
          |SINO;
               |SI nSocio = 20; |Y swCual = 2;

                    |HAZ ElSocio;
                    aAlfa = aAlfaS1; |XGRABA nHandle, aAlfa;
                    aAlfa = aAlfaS2; |XGRABA nHandle, aAlfa;

                    aAlfa = aBlanco * 142; |XGRABA nHandle, aAlfa;

                    aAlfa = "</T036080>";  |XGRABA nHandle, aAlfa;
                    aAlfa = &13 + &10;     |XGRABA nHandle, aAlfa;
                    swCual = 1;

               |FINSI;
          |FINSI;

     |SIGUE;
     |CIERRA #53;
|FPRC;

|PROCESO PersonaFisica;
     aNombre = aBlanco * 25;

     |SI fFecha ] "01.06.2017";
         aAlfa   = #42#2 % 101;
         |SI aAlfa = "0"; |O aAlfa = "1"; |O aAlfa = "2"; |O aAlfa = "3";
          |O aAlfa = "4"; |O aAlfa = "5"; |O aAlfa = "6"; |O aAlfa = "7";
          |O aAlfa = "8"; |O aAlfa = "9"; |O aAlfa = "X"; |O aAlfa = "Y";
          |O aAlfa = "Z";
             eaAlfa = #agicen42#3;  |HAZ BuscaNombre;
             aApellidos = aAlfa1;
             aNombre    = (aAlfa2 + aNombre) % 125;
          |SINO;
             aApellidos = #agicen42#3;
          |FINSI;
          #agicen42#3 = aApellidos;
     |FINSI;
|FPRC;

|PROCESO Hoja1_2018;

     |ABRE #42;
     #42#0 = enEmpresa;
     #42#1 = enRegistro;
     |LEE 040#42=;
     |SI FSalida ! 0;  |DDEFECTO #42;  |FINSI;
     |CIERRA #42;
     |HAZ PersonaFisica;

     |DDEFECTO #t1803601;

     nNumCampos = 50;

     |SI fFecha ] "01.01.2019";
         #t1803601#3  = "20190101";
     |FINSI;

     aAlfa = #agicen42#2;  |HAZ QuitaRaros;  #t1803601#4  = aAlfa;
     aAlfa = #agicen42#3;  |HAZ QuitaRaros;  #t1803601#5  = aAlfa;

     |PARA nPara1 = 7; |SI nPara1 [ 29;  |HACIENDO nPara1 = nPara1 + 1;
           nPara2 = nPara1 - 3;
           #t1803601#nPara1# = #agicen42#nPara2#;
     |SIGUE;

     |SI #agicen42#27 > "01.01.0000";
         aAlfa  = #agicen42#27;
         aAlfa1 = aAlfa % 102;  #t1803601#30 = aAlfa1;
         aAlfa1 = aAlfa % 402;  #t1803601#31 = aAlfa1;
         aAlfa1 = aAlfa % -104; #t1803601#32 = aAlfa1;
     |FINSI;

     #t1803601#33 = #agicen42#28;
     #t1803601#34 = #agicen42#29;

     |SI #agicen42#30 > "01.01.0000";
         aAlfa  = #agicen42#30;
         aAlfa1 = aAlfa % 102;  #t1803601#35 = aAlfa1;
         aAlfa1 = aAlfa % 402;  #t1803601#36 = aAlfa1;
         aAlfa1 = aAlfa % -104; #t1803601#37 = aAlfa1;
     |FINSI;

     aAlfa = #agicen42#31;  |HAZ QuitaRaros;  #t1803601#38 = aAlfa;

     |SI #agicen42#32 > "01.01.0000";
         aAlfa  = #agicen42#32;
         aAlfa1 = aAlfa % 102;  #t1803601#39 = aAlfa1;
         aAlfa1 = aAlfa % 402;  #t1803601#40 = aAlfa1;
         aAlfa1 = aAlfa % -104; #t1803601#41 = aAlfa1;
     |FINSI;

                                              #t1803601#42 = #agicen42#33;
     aAlfa = #agicen42#34;  |HAZ QuitaRaros;  #t1803601#43 = aAlfa;
     aAlfa = #agicen42#37;  |HAZ QuitaRaros;  #t1803601#44 = aAlfa;
     aAlfa = #agicen42#38;  |HAZ QuitaRaros;  #t1803601#45 = aAlfa;
     aAlfa = aNombre;       |HAZ QuitaRaros;  #t1803601#46 = aAlfa;
     aAlfa = &13 + &10;                       #t1803601#50 = aAlfa;

     |PARA nPara1 = 1; |SI nPara1 [ nNumCampos; |HACIENDO nPara1 = nPara1 + 1;
           aAlfa = #t1803601#nPara1#;
           |XGRABA nHandle, aAlfa;
     |SIGUE;
|FPRC;

|PROCESO Hoja2A_2018;
     |ABRE #43;
     #43#0 = enEmpresa;
     #43#1 = enRegistro;
     |LEE 040#43=;
     |SI FSalida ! 0; |O swDefectoA = 1;
          |DDEFECTO #43;
     |FINSI;
     |CIERRA #43;

     |DDEFECTO #t180362a;
     nNumCampos = 103;

     #t180362a#3 = #agicen43#2;
     #t180362a#4 = #agicen43#4;
     aAlfa = #agicen43#5;  |HAZ QuitaRaros;  #t180362a#5 = aAlfa;
     aAlfa = #agicen43#6;  |HAZ QuitaRaros;  #t180362a#6 = aAlfa;
     aAlfa = #agicen43#7;  |HAZ QuitaRaros;  #t180362a#7 = aAlfa;
     aAlfa = #agicen43#8;  |HAZ QuitaRaros;  #t180362a#8 = aAlfa;
     aAlfa = #agicen43#9;  |HAZ QuitaRaros;  #t180362a#9 = aAlfa;
     aAlfa = #agicen43#12; |HAZ QuitaRaros;  #t180362a#10 = aAlfa;

     aAlfa = #agicen43#13; |HAZ QuitaRaros;  #t180362a#12 = aAlfa;
     aAlfa = #agicen43#14; |HAZ QuitaRaros;  #t180362a#13 = aAlfa;

     nNume = #agicen43#15;
     aAlfa = ("00000" + nNume) % -105; #t180362a#14 = aAlfa;

     aAlfa = #agicen43#16; |HAZ QuitaRaros;  #t180362a#15 = aAlfa;
     aAlfa = #agicen43#17; |HAZ QuitaRaros;  #t180362a#16 = aAlfa;
     aAlfa = #agicen43#18; |HAZ QuitaRaros;  #t180362a#17 = aAlfa;
     aAlfa = #agicen43#19; |HAZ QuitaRaros;  #t180362a#18 = aAlfa;
     aAlfa = #agicen43#20; |HAZ QuitaRaros;  #t180362a#19 = aAlfa;
     aAlfa = #agicen43#21; |HAZ QuitaRaros;  #t180362a#20 = aAlfa;
     aAlfa = #agicen43#22; |HAZ QuitaRaros;  #t180362a#21 = aAlfa;
     aAlfa = #agicen43#23; |HAZ QuitaRaros;  #t180362a#22 = aAlfa;

     nNume = #agicen43#24;
     aAlfa = ("00000" + nNume) % -105; #t180362a#23 = aAlfa;

     aAlfa = #agicen43#25; |HAZ QuitaRaros;  #t180362a#25 = aAlfa;
     aAlfa = #agicen43#26; |HAZ QuitaRaros;  #t180362a#26 = aAlfa;
     aAlfa = #agicen43#30; |HAZ QuitaRaros;  #t180362a#27 = aAlfa;

     aAlfa = #agicen43#32; |HAZ QuitaRaros;  #t180362a#29 = aAlfa;
     aAlfa = #agicen43#33; |HAZ QuitaRaros;  #t180362a#30 = aAlfa;
     aAlfa = #agicen43#35; |HAZ QuitaRaros;  #t180362a#31 = aAlfa;
     aAlfa = #agicen43#100; |HAZ QuitaRaros; #t180362a#32 = aAlfa;
     aAlfa = #agicen43#34;  |HAZ QuitaRaros; #t180362a#33 = aAlfa;
     aAlfa = #agicen43#36;  |HAZ QuitaRaros; #t180362a#34 = aAlfa;
     aAlfa = #agicen43#37;  |HAZ QuitaRaros; #t180362a#35 = aAlfa;
     aAlfa = #agicen43#38;  |HAZ QuitaRaros; #t180362a#36 = aAlfa;

     aAlfa = #agicen43#123; |HAZ QuitaRaros; #t180362a#37 = aAlfa;
     aAlfa = #agicen43#124; |HAZ QuitaRaros; #t180362a#38 = aAlfa;

     aAlfa = #agicen43#42;  |HAZ QuitaRaros; #t180362a#40 = aAlfa;
     aAlfa = #agicen43#43;  |HAZ QuitaRaros; #t180362a#42 = aAlfa;
     aAlfa = #agicen43#44;  |HAZ QuitaRaros; #t180362a#43 = aAlfa;
     nNume = #agicen43#45;
     aAlfa = ("00000" + nNume) % -105;        #t180362a#44 = aAlfa;

     aAlfa = #agicen43#46;  |HAZ QuitaRaros; #t180362a#45 = aAlfa;
     aAlfa = #agicen43#47;  |HAZ QuitaRaros; #t180362a#46 = aAlfa;
     aAlfa = #agicen43#48;  |HAZ QuitaRaros; #t180362a#47 = aAlfa;
     aAlfa = #agicen43#49;  |HAZ QuitaRaros; #t180362a#48 = aAlfa;
     aAlfa = #agicen43#50;  |HAZ QuitaRaros; #t180362a#49 = aAlfa;
     aAlfa = #agicen43#51;  |HAZ QuitaRaros; #t180362a#50 = aAlfa;
     aAlfa = #agicen43#52;  |HAZ QuitaRaros; #t180362a#51 = aAlfa;
     aAlfa = #agicen43#53;  |HAZ QuitaRaros; #t180362a#52 = aAlfa;
     aAlfa = #agicen43#54;  |HAZ QuitaRaros; #t180362a#53 = aAlfa;

     aAlfa = #agicen43#55;  |HAZ QuitaRaros; #t180362a#55 = aAlfa;
     aAlfa = #agicen43#56;                   #t180362a#56 = aAlfa;
     aAlfa = #agicen43#122;                  #t180362a#57 = aAlfa;

     aAlfa = #agicen43#60;  |HAZ QuitaRaros; #t180362a#59 = aAlfa;
     aAlfa = #agicen43#61;  |HAZ QuitaRaros; #t180362a#60 = aAlfa;
     aAlfa = #agicen43#62;  |HAZ QuitaRaros; #t180362a#61 = aAlfa;
     aAlfa = #agicen43#63;  |HAZ QuitaRaros; #t180362a#62 = aAlfa;
     nNume = #agicen43#64;
     aAlfa = ("00000" + nNume) % -105;       #t180362a#63 = aAlfa;
     aAlfa = #agicen43#65;  |HAZ QuitaRaros; #t180362a#64 = aAlfa;

     aAlfa = #agicen43#69;  |HAZ QuitaRaros; #t180362a#66 = aAlfa;
     aAlfa = #agicen43#70;  |HAZ QuitaRaros; #t180362a#67 = aAlfa;
     aAlfa = #agicen43#72;  |HAZ QuitaRaros; #t180362a#68 = aAlfa;

     aAlfa = #agicen43#73;  |HAZ QuitaRaros; #t180362a#70 = aAlfa;
     aAlfa = #agicen43#74;  |HAZ QuitaRaros; #t180362a#71 = aAlfa;

     nNume = #agicen43#75;
     aAlfa = ("00000" + nNume) % -105;       #t180362a#72 = aAlfa;
     aAlfa = #agicen43#76;  |HAZ QuitaRaros; #t180362a#73 = aAlfa;
     aAlfa = #agicen43#77;  |HAZ QuitaRaros; #t180362a#74 = aAlfa;
     aAlfa = #agicen43#78;  |HAZ QuitaRaros; #t180362a#75 = aAlfa;
     aAlfa = #agicen43#79;  |HAZ QuitaRaros; #t180362a#76 = aAlfa;
     aAlfa = #agicen43#80;  |HAZ QuitaRaros; #t180362a#77 = aAlfa;
     aAlfa = #agicen43#81;  |HAZ QuitaRaros; #t180362a#78 = aAlfa;
     aAlfa = #agicen43#82;  |HAZ QuitaRaros; #t180362a#79 = aAlfa;
     aAlfa = #agicen43#83;  |HAZ QuitaRaros; #t180362a#80 = aAlfa;
     nNume = #agicen43#84;
     aAlfa = ("00000" + nNume) % -105;       #t180362a#81 = aAlfa;
     aAlfa = #agicen43#85;  |HAZ QuitaRaros; #t180362a#83 = aAlfa;
                                             #t180362a#84 = #agicen43#86;

                                             #t180362a#86 = #agicen43#92;
     nNume = #agicen43#93;
     aAlfa = ("000" + nNume) % -103;         #t180362a#87 = aAlfa;

     aAlfa = #agicen43#95;  |HAZ QuitaRaros; #t180362a#88 = aAlfa;
     aAlfa = #agicen43#97;  |HAZ QuitaRaros; #t180362a#89 = aAlfa;
     aAlfa = #agicen43#99;  |HAZ QuitaRaros; #t180362a#90 = aAlfa;

     aAlfa = " ";
     |SI #agicen43#116 = "S"; aAlfa = "B"; |FINSI;
     |SI #agicen43#115 = "S"; aAlfa = "A"; |FINSI;
     #t180362a#91 = aAlfa;

     |SI #agicen43#117 > "01.01.0000";
         aAlfa  = #agicen43#117;
         aAlfa1 = aAlfa % 102;  #t180362a#92 = aAlfa1;
         aAlfa1 = aAlfa % 402;  #t180362a#93 = aAlfa1;
         aAlfa1 = aAlfa % -104; #t180362a#94 = aAlfa1;
     |FINSI;

     aAlfa = #agicen43#119;  |HAZ QuitaRaros; #t180362a#95 = aAlfa;
     aAlfa = #agicen43#118;  |HAZ QuitaRaros; #t180362a#96 = aAlfa;

     #t180362a#97  = #agicen43#120;
     #t180362a#98  = #agicen43#121;
     |SI #agicen43#125 = "S"; #t180362a#99  = #agicen43#125; |FINSI;
     |SI #agicen43#126 = "S"; #t180362a#100 = #agicen43#126; |FINSI;

     aAlfa = &13 + &10; #t180362a#103 = aAlfa;

     |PARA nPara1 = 1; |SI nPara1 [ nNumCampos; |HACIENDO nPara1 = nPara1 + 1;
           aAlfa = #t180362a#nPara1#;
           |XGRABA nHandle, aAlfa;
     |SIGUE;
|FPRC;

|PROCESO Hoja2B_2018;
     |ABRE #44;
     #44#0 = enEmpresa;
     #44#1 = enRegistro;
     |LEE 040#44=;
     |SI FSalida ! 0; |O swDefectoB = 1;
          |DDEFECTO #44;
     |FINSI;
     |CIERRA #44;

     |DDEFECTO #t180362b;
     nNumCampos = 123;

     aAlfa = " ";
     |SI #agicen44#2 = "S"; aAlfa = "S"; |FINSI;
     |SI #agicen44#3 = "S"; aAlfa = "N"; |FINSI;
     #t180362b#3 = aAlfa;
     #t180362b#4 = #agicen44#4;

     aAlfa = #agicen44#5;   |HAZ QuitaRaros; #t180362b#5 = aAlfa;
     aAlfa = #agicen44#6;   |HAZ QuitaRaros; #t180362b#6 = aAlfa;
     aAlfa = #agicen44#7;   |HAZ QuitaRaros; #t180362b#7 = aAlfa;
     aAlfa = #agicen44#8;   |HAZ QuitaRaros; #t180362b#8 = aAlfa;

     |SI #agicen44#9 > "01.01.0000";
         aAlfa  = #agicen44#9;
         aAlfa1 = aAlfa % 102;  #t180362b#9  = aAlfa1;
         aAlfa1 = aAlfa % 402;  #t180362b#10 = aAlfa1;
         aAlfa1 = aAlfa % -104; #t180362b#11 = aAlfa1;
     |FINSI;
     |SI #agicen44#10 > "01.01.0000";
         aAlfa  = #agicen44#10;
         aAlfa1 = aAlfa % 102;  #t180362b#12 = aAlfa1;
         aAlfa1 = aAlfa % 402;  #t180362b#13 = aAlfa1;
         aAlfa1 = aAlfa % -104; #t180362b#14 = aAlfa1;
     |FINSI;
     |SI #agicen44#11 > "01.01.0000";
         aAlfa  = #agicen44#11;
         aAlfa1 = aAlfa % 102;  #t180362b#15 = aAlfa1;
         aAlfa1 = aAlfa % 402;  #t180362b#16 = aAlfa1;
         aAlfa1 = aAlfa % -104; #t180362b#17 = aAlfa1;
     |FINSI;

     aAlfa = #agicen44#12;   |HAZ QuitaRaros; #t180362b#18 = aAlfa;
     aAlfa = #agicen44#13;   |HAZ QuitaRaros; #t180362b#20 = aAlfa;
     aAlfa = #agicen44#14;   |HAZ QuitaRaros; #t180362b#21 = aAlfa;

     nNume = #agicen44#15;
     aAlfa = ("00000" + nNume) % -105;        #t180362b#22 = aAlfa;

     aAlfa = #agicen44#16;   |HAZ QuitaRaros; #t180362b#23 = aAlfa;
     aAlfa = #agicen44#17;   |HAZ QuitaRaros; #t180362b#24 = aAlfa;
     aAlfa = #agicen44#18;   |HAZ QuitaRaros; #t180362b#25 = aAlfa;
     aAlfa = #agicen44#19;   |HAZ QuitaRaros; #t180362b#26 = aAlfa;
     aAlfa = #agicen44#20;   |HAZ QuitaRaros; #t180362b#27 = aAlfa;
     aAlfa = #agicen44#21;   |HAZ QuitaRaros; #t180362b#28 = aAlfa;
     aAlfa = #agicen44#22;   |HAZ QuitaRaros; #t180362b#29 = aAlfa;
     aAlfa = #agicen44#23;   |HAZ QuitaRaros; #t180362b#30 = aAlfa;
     nNume = #agicen44#24;
     aAlfa = ("00000" + nNume) % -105;        #t180362b#31 = aAlfa;

     aAlfa = #agicen44#25;   |HAZ QuitaRaros; #t180362b#33 = aAlfa;
     #t180362b#34 = #agicen44#26;

     aAlfa = #agicen44#30;   |HAZ QuitaRaros; #t180362b#35 = aAlfa;

     aAlfa = #agicen44#32;   |HAZ QuitaRaros; #t180362b#37 = aAlfa;
     aAlfa = #agicen44#33;   |HAZ QuitaRaros; #t180362b#38 = aAlfa;
     aAlfa = #agicen44#35;   |HAZ QuitaRaros; #t180362b#39 = aAlfa;
     aAlfa = #agicen44#100;  |HAZ QuitaRaros; #t180362b#40 = aAlfa;
     aAlfa = #agicen44#34;   |HAZ QuitaRaros; #t180362b#41 = aAlfa;
     aAlfa = #agicen44#36;   |HAZ QuitaRaros; #t180362b#42 = aAlfa;
     aAlfa = #agicen44#37;   |HAZ QuitaRaros; #t180362b#43 = aAlfa;
     aAlfa = #agicen44#38;   |HAZ QuitaRaros; #t180362b#44 = aAlfa;

     aAlfa = #agicen44#141;  |HAZ QuitaRaros; #t180362b#45 = aAlfa;
     aAlfa = #agicen44#142;  |HAZ QuitaRaros; #t180362b#46 = aAlfa;

     aAlfa = #agicen44#42;   |HAZ QuitaRaros; #t180362b#48 = aAlfa;
     aAlfa = #agicen44#43;   |HAZ QuitaRaros; #t180362b#50 = aAlfa;
     aAlfa = #agicen44#44;   |HAZ QuitaRaros; #t180362b#51 = aAlfa;
     nNume = #agicen44#45;
     aAlfa = ("00000" + nNume) % -105;        #t180362b#52 = aAlfa;
     aAlfa = #agicen44#46;   |HAZ QuitaRaros; #t180362b#53 = aAlfa;
     aAlfa = #agicen44#47;   |HAZ QuitaRaros; #t180362b#54 = aAlfa;
     aAlfa = #agicen44#48;   |HAZ QuitaRaros; #t180362b#55 = aAlfa;
     aAlfa = #agicen44#49;   |HAZ QuitaRaros; #t180362b#56 = aAlfa;
     aAlfa = #agicen44#50;   |HAZ QuitaRaros; #t180362b#57 = aAlfa;
     aAlfa = #agicen44#51;   |HAZ QuitaRaros; #t180362b#58 = aAlfa;
     aAlfa = #agicen44#52;   |HAZ QuitaRaros; #t180362b#59 = aAlfa;
     aAlfa = #agicen44#53;   |HAZ QuitaRaros; #t180362b#60 = aAlfa;
     nNume = #agicen44#54;
     aAlfa = ("00000" + nNume) % -105;        #t180362b#61 = aAlfa;

     aAlfa = #agicen44#55;   |HAZ QuitaRaros; #t180362b#63 = aAlfa;
     #t180362b#64 = #agicen44#56;

     aAlfa = #agicen44#140;  |HAZ QuitaRaros; #t180362b#65 = aAlfa;

     aAlfa = #agicen44#60;   |HAZ QuitaRaros; #t180362b#67 = aAlfa;
     #t180362b#68 = #agicen44#61;
     aAlfa = #agicen44#62;   |HAZ QuitaRaros; #t180362b#69 = aAlfa;
     aAlfa = #agicen44#63;   |HAZ QuitaRaros; #t180362b#70 = aAlfa;
     nNume = #agicen44#64;
     aAlfa = ("00000" + nNume) % -105;        #t180362b#71 = aAlfa;
     #t180362b#72 = #agicen44#65;
     aAlfa = #agicen44#69;   |HAZ QuitaRaros; #t180362b#74 = aAlfa;
     #t180362b#75 = #agicen44#70;
     aAlfa = #agicen44#72;   |HAZ QuitaRaros; #t180362b#76 = aAlfa;
     aAlfa = #agicen44#73;   |HAZ QuitaRaros; #t180362b#78 = aAlfa;
     aAlfa = #agicen44#74;   |HAZ QuitaRaros; #t180362b#79 = aAlfa;
     nNume = #agicen44#75;
     aAlfa = ("00000" + nNume) % -105;        #t180362b#80 = aAlfa;
     aAlfa = #agicen44#76;   |HAZ QuitaRaros; #t180362b#81 = aAlfa;
     aAlfa = #agicen44#77;   |HAZ QuitaRaros; #t180362b#82 = aAlfa;
     aAlfa = #agicen44#78;   |HAZ QuitaRaros; #t180362b#83 = aAlfa;
     aAlfa = #agicen44#79;   |HAZ QuitaRaros; #t180362b#84 = aAlfa;
     aAlfa = #agicen44#80;   |HAZ QuitaRaros; #t180362b#85 = aAlfa;
     aAlfa = #agicen44#81;   |HAZ QuitaRaros; #t180362b#86 = aAlfa;
     aAlfa = #agicen44#82;   |HAZ QuitaRaros; #t180362b#87 = aAlfa;
     aAlfa = #agicen44#83;   |HAZ QuitaRaros; #t180362b#88 = aAlfa;
     nNume = #agicen44#84;
     aAlfa = ("00000" + nNume) % -105;        #t180362b#89 = aAlfa;

     aAlfa = #agicen44#85;   |HAZ QuitaRaros; #t180362b#91 = aAlfa;
     #t180362b#92 = #agicen44#86;

     #t180362b#94 = #agicen44#115;
     |PARA nPara1 = 95; |SI nPara1 [ 106;  |HACIENDO nPara1 = nPara1 + 1;
           nPara2 = nPara1 + 23;
           #t180362b#nPara1# = #agicen44#nPara2#;
     |SIGUE;
     #t180362b#107 = #agicen44#92;
     nNume = #agicen44#93;
     aAlfa = ("000" + nNume) % -103;       #t180362b#108 = aAlfa;

     aAlfa = #agicen44#94;   |HAZ QuitaRaros; #t180362b#109 = aAlfa;
     aAlfa = #agicen44#95;   |HAZ QuitaRaros; #t180362b#110 = aAlfa;
     aAlfa = #agicen44#96;   |HAZ QuitaRaros; #t180362b#111 = aAlfa;
     aAlfa = #agicen44#97;   |HAZ QuitaRaros; #t180362b#112 = aAlfa;
     aAlfa = #agicen44#98;   |HAZ QuitaRaros; #t180362b#113 = aAlfa;
     aAlfa = #agicen44#99;   |HAZ QuitaRaros; #t180362b#114 = aAlfa;
     aAlfa = #agicen44#137;  |HAZ QuitaRaros; #t180362b#115 = aAlfa;
     aAlfa = #agicen44#136;  |HAZ QuitaRaros; #t180362b#116 = aAlfa;

     #t180362b#117 = #agicen44#138;
     #t180362b#118 = #agicen44#139;
     |SI #agicen44#143 = "S"; #t180362b#119 = #agicen44#143; |FINSI;
     |SI #agicen44#144 = "S"; #t180362b#120 = #agicen44#144; |FINSI;

     aAlfa = &13 + &10; #t180362b#123 = aAlfa;

     |PARA nPara1 = 1; |SI nPara1 [ nNumCampos; |HACIENDO nPara1 = nPara1 + 1;
           aAlfa = #t180362b#nPara1#;
           |XGRABA nHandle, aAlfa;
     |SIGUE;
|FPRC;

|PROCESO Hoja2C_2018;

     |SI eaTipo ! "C"; |ACABA; |FINSI;

     |ABRE #45;
     #45#0 = enEmpresa;
     #45#1 = enRegistro;
     |LEE 040#45=;
     |SI FSalida ! 0; |O swDefectoC = 1;
          |DDEFECTO #45;
          #agicen45#123 = 0;
     |FINSI;
     |CIERRA #45;

     |DDEFECTO #t180362c;
     nNumCampos = 69;

     aAlfa = #agicen45#2;   |HAZ QuitaRaros; #t180362c#3  = aAlfa;
     aAlfa = #agicen45#3;   |HAZ QuitaRaros; #t180362c#4  = aAlfa;
     aAlfa = #agicen45#4;   |HAZ QuitaRaros; #t180362c#5  = aAlfa;
     aAlfa = #agicen45#5;   |HAZ QuitaRaros; #t180362c#6  = aAlfa;
     aAlfa = #agicen45#6;   |HAZ QuitaRaros; #t180362c#7  = aAlfa;
     aAlfa = #agicen45#7;   |HAZ QuitaRaros; #t180362c#8  = aAlfa;
     aAlfa = #agicen45#8;   |HAZ QuitaRaros; #t180362c#9  = aAlfa;
     aAlfa = #agicen45#9;   |HAZ QuitaRaros; #t180362c#10 = aAlfa;

     aAlfa = #agicen45#12;  |HAZ QuitaRaros; #t180362c#11 = aAlfa;
     aAlfa = #agicen45#13;  |HAZ QuitaRaros; #t180362c#13 = aAlfa;
     aAlfa = #agicen45#14;  |HAZ QuitaRaros; #t180362c#14 = aAlfa;
     nNume = #agicen45#15;
     aAlfa = ("00000" + nNume) % -105;       #t180362c#15 = aAlfa;
     aAlfa = #agicen45#16;  |HAZ QuitaRaros; #t180362c#16 = aAlfa;
     aAlfa = #agicen45#17;  |HAZ QuitaRaros; #t180362c#17 = aAlfa;
     aAlfa = #agicen45#18;  |HAZ QuitaRaros; #t180362c#18 = aAlfa;
     aAlfa = #agicen45#19;  |HAZ QuitaRaros; #t180362c#19 = aAlfa;
     aAlfa = #agicen45#20;  |HAZ QuitaRaros; #t180362c#20 = aAlfa;
     aAlfa = #agicen45#21;  |HAZ QuitaRaros; #t180362c#21 = aAlfa;
     aAlfa = #agicen45#22;  |HAZ QuitaRaros; #t180362c#22 = aAlfa;
     aAlfa = #agicen45#23;  |HAZ QuitaRaros; #t180362c#23 = aAlfa;
     nNume = #agicen45#24;
     aAlfa = ("00000" + nNume) % -105;       #t180362c#24 = aAlfa;
     aAlfa = #agicen45#25;  |HAZ QuitaRaros; #t180362c#26 = aAlfa;
     #t180362c#27 = #agicen45#26;

     aAlfa = #agicen45#30;  |HAZ QuitaRaros; #t180362c#28 = aAlfa;

     aAlfa = #agicen45#42;  |HAZ QuitaRaros; #t180362c#30 = aAlfa;
     aAlfa = #agicen45#43;  |HAZ QuitaRaros; #t180362c#32 = aAlfa;
     aAlfa = #agicen45#44;  |HAZ QuitaRaros; #t180362c#33 = aAlfa;
     nNume = #agicen45#45;
     aAlfa = ("00000" + nNume) % -105;       #t180362c#34 = aAlfa;
     aAlfa = #agicen45#46;  |HAZ QuitaRaros; #t180362c#35 = aAlfa;
     aAlfa = #agicen45#47;  |HAZ QuitaRaros; #t180362c#36 = aAlfa;
     aAlfa = #agicen45#48;  |HAZ QuitaRaros; #t180362c#37 = aAlfa;
     aAlfa = #agicen45#49;  |HAZ QuitaRaros; #t180362c#38 = aAlfa;
     aAlfa = #agicen45#50;  |HAZ QuitaRaros; #t180362c#39 = aAlfa;
     aAlfa = #agicen45#51;  |HAZ QuitaRaros; #t180362c#40 = aAlfa;
     aAlfa = #agicen45#52;  |HAZ QuitaRaros; #t180362c#41 = aAlfa;
     aAlfa = #agicen45#53;  |HAZ QuitaRaros; #t180362c#42 = aAlfa;
     nNume = #agicen45#54;
     aAlfa = ("00000" + nNume) % -105;       #t180362c#43 = aAlfa;
     aAlfa = #agicen45#55;  |HAZ QuitaRaros; #t180362c#45 = aAlfa;
     #t180362c#46 = #agicen45#56;

     aAlfa = #agicen45#71;  |HAZ QuitaRaros; #t180362c#47 = aAlfa;
     aAlfa = #agicen45#119; |HAZ QuitaRaros; #t180362c#48 = aAlfa;
     aAlfa = #agicen45#120; |HAZ QuitaRaros; #t180362c#49 = aAlfa;

     aAlfa = #agicen45#60;  |HAZ QuitaRaros; #t180362c#51 = aAlfa;
     aAlfa = #agicen45#61;  |HAZ QuitaRaros; #t180362c#52 = aAlfa;

     nNume = #agicen45#62;
     aAlfa = ("0000000000" + nNume) % -110;  #t180362c#53 = aAlfa;

     aAlfa = #agicen45#63;  |HAZ QuitaRaros; #t180362c#54 = aAlfa;
     nNume = #agicen45#64;
     aAlfa = ("00000" + nNume) % -105;       #t180362c#55 = aAlfa;
     #t180362c#56 = #agicen45#65;

     aAlfa = #agicen45#69;  |HAZ QuitaRaros; #t180362c#58 = aAlfa;
     #t180362c#59 = #agicen45#70;

     aAlfa = #agicen45#116; |HAZ QuitaRaros; #t180362c#60 = aAlfa;
     aAlfa = #agicen45#115; |HAZ QuitaRaros; #t180362c#61 = aAlfa;
     #t180362c#62 = #agicen45#117;
     aAlfa = #agicen45#118; |HAZ QuitaRaros; #t180362c#63 = aAlfa;

     |SI #agicen45#121 = "S"; #t180362c#64 = #agicen45#121; |FINSI;
     |SI #agicen45#122 = "S"; #t180362c#65 = #agicen45#122; |FINSI;

     |SI #agicen45#123 > 0;
         #t180362c#66 = #agicen45#123;
     |FINSI;

     aAlfa = &13 + &10; #t180362c#69 = aAlfa;

     |PARA nPara1 = 1; |SI nPara1 [ nNumCampos; |HACIENDO nPara1 = nPara1 + 1;
           aAlfa = #t180362c#nPara1#;
           |XGRABA nHandle, aAlfa;
     |SIGUE;
|FPRC;

|PROCESO Hoja2A_2019;

     |SI eaTipo ! "A"; |ACABA; |FINSI;

     |ABRE #43;
     #43#0 = enEmpresa;
     #43#1 = enRegistro;
     |LEE 040#43=;
     |SI FSalida ! 0; |O swDefectoA = 1;
          |DDEFECTO #43;
          #agicen43#128 = 0;
     |FINSI;
     |CIERRA #43;

     |DDEFECTO #t190362a;
     nNumCampos = 107;

     #t190362a#3 = #agicen43#2;
     #t190362a#4 = #agicen43#4;
     aAlfa = #agicen43#5;  |HAZ QuitaRaros;  #t190362a#5 = aAlfa;
     aAlfa = #agicen43#6;  |HAZ QuitaRaros;  #t190362a#6 = aAlfa;
     aAlfa = #agicen43#7;  |HAZ QuitaRaros;  #t190362a#7 = aAlfa;
     aAlfa = #agicen43#8;  |HAZ QuitaRaros;  #t190362a#8 = aAlfa;
     aAlfa = #agicen43#9;  |HAZ QuitaRaros;  #t190362a#9 = aAlfa;
     aAlfa = #agicen43#12; |HAZ QuitaRaros;  #t190362a#10 = aAlfa;

     aAlfa = #agicen43#13; |HAZ QuitaRaros;  #t190362a#12 = aAlfa;
     aAlfa = #agicen43#14; |HAZ QuitaRaros;  #t190362a#13 = aAlfa;

     nNume = #agicen43#15;
     aAlfa = ("00000" + nNume) % -105; #t190362a#14 = aAlfa;

     aAlfa = #agicen43#16; |HAZ QuitaRaros;  #t190362a#15 = aAlfa;
     aAlfa = #agicen43#17; |HAZ QuitaRaros;  #t190362a#16 = aAlfa;
     aAlfa = #agicen43#18; |HAZ QuitaRaros;  #t190362a#17 = aAlfa;
     aAlfa = #agicen43#19; |HAZ QuitaRaros;  #t190362a#18 = aAlfa;
     aAlfa = #agicen43#20; |HAZ QuitaRaros;  #t190362a#19 = aAlfa;
     aAlfa = #agicen43#21; |HAZ QuitaRaros;  #t190362a#20 = aAlfa;
     aAlfa = #agicen43#22; |HAZ QuitaRaros;  #t190362a#21 = aAlfa;
     aAlfa = #agicen43#23; |HAZ QuitaRaros;  #t190362a#22 = aAlfa;

     nNume = #agicen43#24;
     aAlfa = ("00000" + nNume) % -105; #t190362a#23 = aAlfa;

     aAlfa = #agicen43#25; |HAZ QuitaRaros;  #t190362a#25 = aAlfa;
     aAlfa = #agicen43#26; |HAZ QuitaRaros;  #t190362a#26 = aAlfa;
     aAlfa = #agicen43#30; |HAZ QuitaRaros;  #t190362a#27 = aAlfa;

     aAlfa = #agicen43#32; |HAZ QuitaRaros;  #t190362a#29 = aAlfa;
     aAlfa = #agicen43#33; |HAZ QuitaRaros;  #t190362a#30 = aAlfa;
     aAlfa = #agicen43#35; |HAZ QuitaRaros;  #t190362a#31 = aAlfa;
     aAlfa = #agicen43#100; |HAZ QuitaRaros; #t190362a#32 = aAlfa;
     aAlfa = #agicen43#34;  |HAZ QuitaRaros; #t190362a#33 = aAlfa;
     aAlfa = #agicen43#36;  |HAZ QuitaRaros; #t190362a#34 = aAlfa;
     aAlfa = #agicen43#37;  |HAZ QuitaRaros; #t190362a#35 = aAlfa;
     aAlfa = #agicen43#38;  |HAZ QuitaRaros; #t190362a#36 = aAlfa;

     aAlfa = #agicen43#123; |HAZ QuitaRaros; #t190362a#37 = aAlfa;
     aAlfa = #agicen43#124; |HAZ QuitaRaros; #t190362a#38 = aAlfa;

     aAlfa = #agicen43#42;  |HAZ QuitaRaros; #t190362a#40 = aAlfa;
     aAlfa = #agicen43#43;  |HAZ QuitaRaros; #t190362a#42 = aAlfa;
     aAlfa = #agicen43#44;  |HAZ QuitaRaros; #t190362a#43 = aAlfa;
     nNume = #agicen43#45;
     aAlfa = ("00000" + nNume) % -105;        #t190362a#44 = aAlfa;

     aAlfa = #agicen43#46;  |HAZ QuitaRaros; #t190362a#45 = aAlfa;
     aAlfa = #agicen43#47;  |HAZ QuitaRaros; #t190362a#46 = aAlfa;
     aAlfa = #agicen43#48;  |HAZ QuitaRaros; #t190362a#47 = aAlfa;
     aAlfa = #agicen43#49;  |HAZ QuitaRaros; #t190362a#48 = aAlfa;
     aAlfa = #agicen43#50;  |HAZ QuitaRaros; #t190362a#49 = aAlfa;
     aAlfa = #agicen43#51;  |HAZ QuitaRaros; #t190362a#50 = aAlfa;
     aAlfa = #agicen43#52;  |HAZ QuitaRaros; #t190362a#51 = aAlfa;
     aAlfa = #agicen43#53;  |HAZ QuitaRaros; #t190362a#52 = aAlfa;
     nNume = #agicen43#54;
     aAlfa = ("00000" + nNume) % -105; #t190362a#53 = aAlfa;

     aAlfa = #agicen43#55;  |HAZ QuitaRaros; #t190362a#55 = aAlfa;
     aAlfa = #agicen43#56;                   #t190362a#56 = aAlfa;
     aAlfa = #agicen43#122;                  #t190362a#57 = aAlfa;

     aAlfa = #agicen43#60;  |HAZ QuitaRaros; #t190362a#59 = aAlfa;
     aAlfa = #agicen43#61;  |HAZ QuitaRaros; #t190362a#60 = aAlfa;

     nNume = #agicen43#62;
     aAlfa = ("0000000000" + nNume) % -110;  #t190362a#61 = aAlfa;

     aAlfa = #agicen43#63;  |HAZ QuitaRaros; #t190362a#62 = aAlfa;
     nNume = #agicen43#64;
     aAlfa = ("00000" + nNume) % -105;       #t190362a#63 = aAlfa;
     aAlfa = #agicen43#65;  |HAZ QuitaRaros; #t190362a#64 = aAlfa;

     aAlfa = #agicen43#69;  |HAZ QuitaRaros; #t190362a#66 = aAlfa;
     aAlfa = #agicen43#70;  |HAZ QuitaRaros; #t190362a#67 = aAlfa;
     aAlfa = #agicen43#72;  |HAZ QuitaRaros; #t190362a#68 = aAlfa;

     aAlfa = #agicen43#73;  |HAZ QuitaRaros; #t190362a#70 = aAlfa;
     aAlfa = #agicen43#74;  |HAZ QuitaRaros; #t190362a#71 = aAlfa;

     nNume = #agicen43#75;
     aAlfa = ("00000" + nNume) % -105;       #t190362a#72 = aAlfa;
     aAlfa = #agicen43#76;  |HAZ QuitaRaros; #t190362a#73 = aAlfa;
     aAlfa = #agicen43#77;  |HAZ QuitaRaros; #t190362a#74 = aAlfa;
     aAlfa = #agicen43#78;  |HAZ QuitaRaros; #t190362a#75 = aAlfa;
     aAlfa = #agicen43#79;  |HAZ QuitaRaros; #t190362a#76 = aAlfa;
     aAlfa = #agicen43#80;  |HAZ QuitaRaros; #t190362a#77 = aAlfa;
     aAlfa = #agicen43#81;  |HAZ QuitaRaros; #t190362a#78 = aAlfa;
     aAlfa = #agicen43#82;  |HAZ QuitaRaros; #t190362a#79 = aAlfa;
     aAlfa = #agicen43#83;  |HAZ QuitaRaros; #t190362a#80 = aAlfa;
     nNume = #agicen43#84;
     aAlfa = ("00000" + nNume) % -105;       #t190362a#81 = aAlfa;
     aAlfa = #agicen43#85;  |HAZ QuitaRaros; #t190362a#83 = aAlfa;
                                             #t190362a#84 = #agicen43#86;

                                             #t190362a#86 = #agicen43#92;
     nNume = #agicen43#93;
     aAlfa = ("000" + nNume) % -103;         #t190362a#87 = aAlfa;

     aAlfa = #agicen43#95;  |HAZ QuitaRaros; #t190362a#88 = aAlfa;
     aAlfa = #agicen43#97;  |HAZ QuitaRaros; #t190362a#89 = aAlfa;
     aAlfa = #agicen43#99;  |HAZ QuitaRaros; #t190362a#90 = aAlfa;

     aAlfa = " ";
     |SI #agicen43#116 = "S"; aAlfa = "B"; |FINSI;
     |SI #agicen43#115 = "S"; aAlfa = "A"; |FINSI;
     #t190362a#91 = aAlfa;

     |SI #agicen43#117 > "01.01.0000";
         aAlfa  = #agicen43#117;
         aAlfa1 = aAlfa % 102;  #t190362a#92 = aAlfa1;
         aAlfa1 = aAlfa % 402;  #t190362a#93 = aAlfa1;
         aAlfa1 = aAlfa % -104; #t190362a#94 = aAlfa1;
     |FINSI;

     aAlfa = #agicen43#119;  |HAZ QuitaRaros; #t190362a#95 = aAlfa;
     aAlfa = #agicen43#118;  |HAZ QuitaRaros; #t190362a#96 = aAlfa;

     #t190362a#97  = #agicen43#120;
     #t190362a#98  = #agicen43#121;
     |SI #agicen43#125 = "S"; #t190362a#99  = #agicen43#125; |FINSI;
     |SI #agicen43#126 = "S"; #t190362a#100 = #agicen43#126; |FINSI;

     |SI #agicen43#127 > "01.01.0000";
         aAlfa  = #agicen43#127;
         aAlfa1 = aAlfa % 102;  #t190362a#101 = aAlfa1;
         aAlfa1 = aAlfa % 402;  #t190362a#102 = aAlfa1;
         aAlfa1 = aAlfa % -104; #t190362a#103 = aAlfa1;
     |FINSI;

     |SI #agicen43#128 > 0;
         #t190362a#104 = #agicen43#128;
     |FINSI;

     aAlfa = &13 + &10; #t190362a#107 = aAlfa;

     |PARA nPara1 = 1; |SI nPara1 [ nNumCampos; |HACIENDO nPara1 = nPara1 + 1;
           aAlfa = #t190362a#nPara1#;
           |XGRABA nHandle, aAlfa;
     |SIGUE;
|FPRC;

|PROCESO Hoja2B_2019;

     |SI eaTipo ! "B"; |ACABA; |FINSI;

     |ABRE #44;
     #44#0 = enEmpresa;
     #44#1 = enRegistro;
     |LEE 040#44=;
     |SI FSalida ! 0; |O swDefectoB = 1;
          |DDEFECTO #44;
          #agicen44#146 = 0;
     |FINSI;
     |CIERRA #44;

     |DDEFECTO #t190362b;
     nNumCampos = 127;

     aAlfa = " ";
     |SI #agicen44#2 = "S"; aAlfa = "S"; |FINSI;
     |SI #agicen44#3 = "S"; aAlfa = "N"; |FINSI;
     #t190362b#3 = aAlfa;
     #t190362b#4 = #agicen44#4;

     aAlfa = #agicen44#5;   |HAZ QuitaRaros; #t190362b#5 = aAlfa;
     aAlfa = #agicen44#6;   |HAZ QuitaRaros; #t190362b#6 = aAlfa;
     aAlfa = #agicen44#7;   |HAZ QuitaRaros; #t190362b#7 = aAlfa;
     aAlfa = #agicen44#8;   |HAZ QuitaRaros; #t190362b#8 = aAlfa;

     |SI #agicen44#9 > "01.01.0000";
         aAlfa  = #agicen44#9;
         aAlfa1 = aAlfa % 102;  #t190362b#9  = aAlfa1;
         aAlfa1 = aAlfa % 402;  #t190362b#10 = aAlfa1;
         aAlfa1 = aAlfa % -104; #t190362b#11 = aAlfa1;
     |FINSI;
     |SI #agicen44#10 > "01.01.0000";
         aAlfa  = #agicen44#10;
         aAlfa1 = aAlfa % 102;  #t190362b#12 = aAlfa1;
         aAlfa1 = aAlfa % 402;  #t190362b#13 = aAlfa1;
         aAlfa1 = aAlfa % -104; #t190362b#14 = aAlfa1;
     |FINSI;
     |SI #agicen44#11 > "01.01.0000";
         aAlfa  = #agicen44#11;
         aAlfa1 = aAlfa % 102;  #t190362b#15 = aAlfa1;
         aAlfa1 = aAlfa % 402;  #t190362b#16 = aAlfa1;
         aAlfa1 = aAlfa % -104; #t190362b#17 = aAlfa1;
     |FINSI;

     aAlfa = #agicen44#12;   |HAZ QuitaRaros; #t190362b#18 = aAlfa;
     aAlfa = #agicen44#13;   |HAZ QuitaRaros; #t190362b#20 = aAlfa;
     aAlfa = #agicen44#14;   |HAZ QuitaRaros; #t190362b#21 = aAlfa;

     nNume = #agicen44#15;
     aAlfa = ("00000" + nNume) % -105;        #t190362b#22 = aAlfa;

     aAlfa = #agicen44#16;   |HAZ QuitaRaros; #t190362b#23 = aAlfa;
     aAlfa = #agicen44#17;   |HAZ QuitaRaros; #t190362b#24 = aAlfa;
     aAlfa = #agicen44#18;   |HAZ QuitaRaros; #t190362b#25 = aAlfa;
     aAlfa = #agicen44#19;   |HAZ QuitaRaros; #t190362b#26 = aAlfa;
     aAlfa = #agicen44#20;   |HAZ QuitaRaros; #t190362b#27 = aAlfa;
     aAlfa = #agicen44#21;   |HAZ QuitaRaros; #t190362b#28 = aAlfa;
     aAlfa = #agicen44#22;   |HAZ QuitaRaros; #t190362b#29 = aAlfa;
     aAlfa = #agicen44#23;   |HAZ QuitaRaros; #t190362b#30 = aAlfa;
     nNume = #agicen44#24;
     aAlfa = ("00000" + nNume) % -105;        #t190362b#31 = aAlfa;

     aAlfa = #agicen44#25;   |HAZ QuitaRaros; #t190362b#33 = aAlfa;
     #t190362b#34 = #agicen44#26;

     aAlfa = #agicen44#30;   |HAZ QuitaRaros; #t190362b#35 = aAlfa;

     aAlfa = #agicen44#32;   |HAZ QuitaRaros; #t190362b#37 = aAlfa;
     aAlfa = #agicen44#33;   |HAZ QuitaRaros; #t190362b#38 = aAlfa;
     aAlfa = #agicen44#35;   |HAZ QuitaRaros; #t190362b#39 = aAlfa;
     aAlfa = #agicen44#100;  |HAZ QuitaRaros; #t190362b#40 = aAlfa;
     aAlfa = #agicen44#34;   |HAZ QuitaRaros; #t190362b#41 = aAlfa;
     aAlfa = #agicen44#36;   |HAZ QuitaRaros; #t190362b#42 = aAlfa;
     aAlfa = #agicen44#37;   |HAZ QuitaRaros; #t190362b#43 = aAlfa;
     aAlfa = #agicen44#38;   |HAZ QuitaRaros; #t190362b#44 = aAlfa;

     aAlfa = #agicen44#141;  |HAZ QuitaRaros; #t190362b#45 = aAlfa;
     aAlfa = #agicen44#142;  |HAZ QuitaRaros; #t190362b#46 = aAlfa;

     aAlfa = #agicen44#42;   |HAZ QuitaRaros; #t190362b#48 = aAlfa;
     aAlfa = #agicen44#43;   |HAZ QuitaRaros; #t190362b#50 = aAlfa;
     aAlfa = #agicen44#44;   |HAZ QuitaRaros; #t190362b#51 = aAlfa;
     nNume = #agicen44#45;
     aAlfa = ("00000" + nNume) % -105;        #t190362b#52 = aAlfa;
     aAlfa = #agicen44#46;   |HAZ QuitaRaros; #t190362b#53 = aAlfa;
     aAlfa = #agicen44#47;   |HAZ QuitaRaros; #t190362b#54 = aAlfa;
     aAlfa = #agicen44#48;   |HAZ QuitaRaros; #t190362b#55 = aAlfa;
     aAlfa = #agicen44#49;   |HAZ QuitaRaros; #t190362b#56 = aAlfa;
     aAlfa = #agicen44#50;   |HAZ QuitaRaros; #t190362b#57 = aAlfa;
     aAlfa = #agicen44#51;   |HAZ QuitaRaros; #t190362b#58 = aAlfa;
     aAlfa = #agicen44#52;   |HAZ QuitaRaros; #t190362b#59 = aAlfa;
     aAlfa = #agicen44#53;   |HAZ QuitaRaros; #t190362b#60 = aAlfa;
     nNume = #agicen44#54;
     aAlfa = ("00000" + nNume) % -105;        #t190362b#61 = aAlfa;

     aAlfa = #agicen44#55;   |HAZ QuitaRaros; #t190362b#63 = aAlfa;
     #t190362b#64 = #agicen44#56;

     aAlfa = #agicen44#140;  |HAZ QuitaRaros; #t190362b#65 = aAlfa;

     aAlfa = #agicen44#60;   |HAZ QuitaRaros; #t190362b#67 = aAlfa;
                                              #t190362b#68 = #agicen44#61;
     nNume = #agicen44#62;
     aAlfa = ("0000000000" + nNume) % -110;   #t190362b#69 = aAlfa;

     aAlfa = #agicen44#63;   |HAZ QuitaRaros; #t190362b#70 = aAlfa;
     nNume = #agicen44#64;
     aAlfa = ("00000" + nNume) % -105;        #t190362b#71 = aAlfa;
     #t190362b#72 = #agicen44#65;
     aAlfa = #agicen44#69;   |HAZ QuitaRaros; #t190362b#74 = aAlfa;
     #t190362b#75 = #agicen44#70;
     aAlfa = #agicen44#72;   |HAZ QuitaRaros; #t190362b#76 = aAlfa;
     aAlfa = #agicen44#73;   |HAZ QuitaRaros; #t190362b#78 = aAlfa;
     aAlfa = #agicen44#74;   |HAZ QuitaRaros; #t190362b#79 = aAlfa;
     nNume = #agicen44#75;
     aAlfa = ("00000" + nNume) % -105;        #t190362b#80 = aAlfa;
     aAlfa = #agicen44#76;   |HAZ QuitaRaros; #t190362b#81 = aAlfa;
     aAlfa = #agicen44#77;   |HAZ QuitaRaros; #t190362b#82 = aAlfa;
     aAlfa = #agicen44#78;   |HAZ QuitaRaros; #t190362b#83 = aAlfa;
     aAlfa = #agicen44#79;   |HAZ QuitaRaros; #t190362b#84 = aAlfa;
     aAlfa = #agicen44#80;   |HAZ QuitaRaros; #t190362b#85 = aAlfa;
     aAlfa = #agicen44#81;   |HAZ QuitaRaros; #t190362b#86 = aAlfa;
     aAlfa = #agicen44#82;   |HAZ QuitaRaros; #t190362b#87 = aAlfa;
     aAlfa = #agicen44#83;   |HAZ QuitaRaros; #t190362b#88 = aAlfa;
     nNume = #agicen44#84;
     aAlfa = ("00000" + nNume) % -105;        #t190362b#89 = aAlfa;

     aAlfa = #agicen44#85;   |HAZ QuitaRaros; #t190362b#91 = aAlfa;
     #t190362b#92 = #agicen44#86;

     #t190362b#94 = #agicen44#115;
     |PARA nPara1 = 95; |SI nPara1 [ 106;  |HACIENDO nPara1 = nPara1 + 1;
           nPara2 = nPara1 + 23;
           #t190362b#nPara1# = #agicen44#nPara2#;
     |SIGUE;
     #t190362b#107 = #agicen44#92;
     nNume = #agicen44#93;
     aAlfa = ("000" + nNume) % -103;       #t190362b#108 = aAlfa;

     aAlfa = #agicen44#94;   |HAZ QuitaRaros; #t190362b#109 = aAlfa;
     aAlfa = #agicen44#95;   |HAZ QuitaRaros; #t190362b#110 = aAlfa;
     aAlfa = #agicen44#96;   |HAZ QuitaRaros; #t190362b#111 = aAlfa;
     aAlfa = #agicen44#97;   |HAZ QuitaRaros; #t190362b#112 = aAlfa;
     aAlfa = #agicen44#98;   |HAZ QuitaRaros; #t190362b#113 = aAlfa;
     aAlfa = #agicen44#99;   |HAZ QuitaRaros; #t190362b#114 = aAlfa;
     aAlfa = #agicen44#137;  |HAZ QuitaRaros; #t190362b#115 = aAlfa;
     aAlfa = #agicen44#136;  |HAZ QuitaRaros; #t190362b#116 = aAlfa;

     #t190362b#117 = #agicen44#138;
     #t190362b#118 = #agicen44#139;
     |SI #agicen44#143 = "S"; #t190362b#119 = #agicen44#143; |FINSI;
     |SI #agicen44#144 = "S"; #t190362b#120 = #agicen44#144; |FINSI;

     |SI #agicen44#145 > "01.01.0000";
         aAlfa  = #agicen44#145;
         aAlfa1 = aAlfa % 102;  #t190362b#121 = aAlfa1;
         aAlfa1 = aAlfa % 402;  #t190362b#122 = aAlfa1;
         aAlfa1 = aAlfa % -104; #t190362b#123 = aAlfa1;
     |FINSI;

     |SI #agicen44#146 > 0;
         #t190362b#124 = #agicen44#146;
     |FINSI;

     aAlfa = &13 + &10; #t190362b#127 = aAlfa;

     |PARA nPara1 = 1; |SI nPara1 [ nNumCampos; |HACIENDO nPara1 = nPara1 + 1;
           aAlfa = #t190362b#nPara1#;
           |XGRABA nHandle, aAlfa;
     |SIGUE;
|FPRC;

|| ///////////////////////////
|PROCESO GrabaHoja4;
     aAlfa = &13 + &10;
     #t1803604#126 = aAlfa;

     |PARA nPara1 = 1; |SI nPara1 [ nNumCampos; |HACIENDO nPara1 = nPara1 + 1;
           aAlfa = #t1803604#nPara1#;
           |XGRABA nHandle, aAlfa;
     |SIGUE;
|FPRC;

|PROCESO LeeAgicen48;
     nLocal = #agicen48#3;
     aLocal = nLocal;
     aLocal = ("00" + aLocal) % -102;

     |SI #agicen48#4 = "D";
          aLocalesDet = aLocalesDet + aLocal;
          nLocalesDet = nLocalesDet + 1;
     |FINSI;
     |SI #480#4 = "I";
         aLocalesInd = aLocalesInd + aLocal;
         nLocalesInd = nLocalesInd + 1;
     |FINSI;
     nLocales = nLocales + 1;
|FPRC;

|DEFBUCLE LeeAgicen48;
     #agicen48#1;
     ;
     #agicen47#0, #agicen47#1, #agicen47#2, 01;
     #agicen47#0, #agicen47#1, #agicen47#2, 99;
     ;
     NULL, LeeAgicen48;
|FIN;

|PROCESO Local2018;
    |DDEFECTO #agicen48;
    #agicen48#0 = #agicen47#0;
    #agicen48#1 = #agicen47#1;
    #agicen48#2 = #agicen47#2;
    #agicen48#3 = nLineaLocal;
    |LEE 040#agicen48.=;

    aAlfa = #agicen48#5;  |HAZ QuitaRaros; #t1803604#nNumero# = aAlfa;
    nNumero = nNumero + 1;
    aAlfa = #agicen48#6;  |HAZ QuitaRaros; #t1803604#nNumero# = aAlfa;
    nNumero = nNumero + 1;
    aAlfa = #agicen48#7;  |HAZ QuitaRaros; #t1803604#nNumero# = aAlfa;

    nNumero = nNumero + 1; aNumCalle = #agicen48#8; |QBF aNumCalle;
    aAlfa = ("00000" + aNumCalle) % -105; #t1803604#nNumero# = aAlfa;

    nNumero = nNumero + 1;
    aAlfa = #agicen48#9;  |HAZ QuitaRaros; #t1803604#nNumero# = aAlfa;
    nNumero = nNumero + 1;
    aAlfa = #agicen48#10; |HAZ QuitaRaros; #t1803604#nNumero# = aAlfa;

    nNumero = nNumero + 1;
    aAlfa = ("00000" + #agicen48#11) % -105; #t1803604#nNumero# = aAlfa;

    nNumero = nNumero + 1;
    aAlfa = #agicen48#13;   |HAZ QuitaRaros; #t1803604#nNumero# = aAlfa;

    nNumero = nNumero + 1;
    aAlfa = #agicen48#30; |QBF aAlfa; aAlfa = ("00" + aAlfa) % -102;
    |SI aAlfa = "00";  aAlfa = "  "; |FINSI; #t1803604#nNumero# = aAlfa;

    nNumero = nNumero + 2;
    aAlfa = #agicen48#16; aAlfa = ("0000000" + aAlfa) % -107;
    #t1803604#nNumero# = aAlfa;

    nNumero = nNumero + 1;
    aAlfa = #agicen48#17; aAlfa = ("000" + aAlfa) % -103;
    #t1803604#nNumero# = aAlfa;

    |SI #agicen48#4 = "I";
        nNumero = nNumero + 1; #t1803604#nNumero# = #agicen48#27;
    |FINSI;

    nNumero = nNumero + 1; #t1803604#nNumero# = #agicen48#18;

    |SI #agicen48#19 > "01.01.0000";
        aAlfa  = #agicen48#19;
        nNumero = nNumero + 1; aAlfa1 = aAlfa % 102;  #t1803604#nNumero# = aAlfa1;
        nNumero = nNumero + 1; aAlfa1 = aAlfa % 402;  #t1803604#nNumero# = aAlfa1;
        nNumero = nNumero + 1; aAlfa1 = aAlfa % -104; #t1803604#nNumero# = aAlfa1;
    |SINO;
        nNumero = nNumero + 3;
    |FINSI;

    nNumero = nNumero + 1; #t1803604#nNumero# = #agicen48#21;

    |SI #agicen48#22 > "01.01.0000";
        aAlfa  = #agicen48#22;
        nNumero = nNumero + 1; aAlfa1 = aAlfa % 102;  #t1803604#nNumero# = aAlfa1;
        nNumero = nNumero + 1; aAlfa1 = aAlfa % 402;  #t1803604#nNumero# = aAlfa1;
        nNumero = nNumero + 1; aAlfa1 = aAlfa % -104; #t1803604#nNumero# = aAlfa1;
    |SINO;
        nNumero = nNumero + 3;
    |FINSI;

    nNumero = nNumero + 1;
    aAlfa = #agicen48#23;   |HAZ QuitaRaros; #t1803604#nNumero# = aAlfa;

    nNumero = nNumero + 1; #t1803604#nNumero# = #agicen48#24;

    |SI #agicen48#25 > "01.01.0000";
        aAlfa  = #agicen48#25;
        nNumero = nNumero + 1; aAlfa1 = aAlfa % 102;  #t1803604#nNumero# = aAlfa1;
        nNumero = nNumero + 1; aAlfa1 = aAlfa % 402;  #t1803604#nNumero# = aAlfa1;
        nNumero = nNumero + 1; aAlfa1 = aAlfa % -104; #t1803604#nNumero# = aAlfa1;
    |SINO;
        nNumero = nNumero + 3;
    |FINSI;

    nNumero = nNumero + 1;
    aAlfa = #agicen48#26;   |HAZ QuitaRaros; #t1803604#nNumero# = aAlfa;

    nLocal = nLocal + 1;
|FPRC;

|PROCESO LeeAgicen47;

   |DDEFECTO #t1803604;

   nActiv = #agicen47#2;
   |SI swCual = 1;  #t1803604#2 = "C";  |FINSI;

   aAlfa = #agicen47#6;   |HAZ QuitaRaros; #t1803604#3  = aAlfa;
   aAlfa = #agicen47#3;
   |SI aAlfa = "E"; aAlfa = "1"; |FINSI;
   |SI aAlfa = "P"; aAlfa = "2"; |FINSI;
   |SI aAlfa = "A"; aAlfa = "3"; |FINSI;
                                           #t1803604#4  = aAlfa;
   aAlfa = #agicen47#5;   |HAZ QuitaRaros; #t1803604#5  = aAlfa;
   aAlfa = #agicen47#7;   |HAZ QuitaRaros; #t1803604#6  = aAlfa;
   aAlfa = #agicen47#9;   |HAZ QuitaRaros; #t1803604#7  = aAlfa;

   |SI #agicen47#10 > "01.01.0000";
       aAlfa  = #agicen47#10;
       aAlfa1 = aAlfa % 102;  #t1803604#8  = aAlfa1;
       aAlfa1 = aAlfa % 402;  #t1803604#9  = aAlfa1;
       aAlfa1 = aAlfa % -104; #t1803604#10 = aAlfa1;
   |FINSI;
   aAlfa = #agicen47#12;   |HAZ QuitaRaros; #t1803604#11  = aAlfa;

   |SI #agicen47#13 > "01.01.0000";
       aAlfa  = #agicen47#13;
       aAlfa1 = aAlfa % 102;  #t1803604#12 = aAlfa1;
       aAlfa1 = aAlfa % 402;  #t1803604#13 = aAlfa1;
       aAlfa1 = aAlfa % -104; #t1803604#14 = aAlfa1;
   |FINSI;
   aAlfa = #agicen47#14;   |HAZ QuitaRaros; #t1803604#15  = aAlfa;
   aAlfa = #agicen47#15;   |HAZ QuitaRaros; #t1803604#16  = aAlfa;

   aAlfa = #agicen47#16; |QBF aAlfa; aAlfa = ("00" + aAlfa) % -102;
   |SI aAlfa = "00"; aAlfa = "  "; |FINSI;  #t1803604#17  = aAlfa;

   nLocales    = 0;
   nLocalesDet = 0;
   aLocalesDet = "";
   nLocalesInd = 0;
   aLocalesInd = "";
   |BUCLE LeeAgicen48;
   |SI nLocales = 0;
       |HAZ GrabaHoja4;
       swCual = 1;
       |ACABA;
   |FINSI;

   |ABRE #agicen48;
   nLocal  = 0;
   nSalir  = 0;
   nPara2  = 1;
   |PARA; |SI nSalir = 0; |HACIENDO;

         |PDEFECTO #t1803604, 19, 127;
         nNumero     = 19;
         nNume1      = (nPara2 * 100 + 2);
         aLocal      = aLocalesDet % nNume1;
         nLineaLocal = aLocal;
         |SI nLineaLocal ! 0;
             |HAZ Local2018;
             nNumero     = 45;
             nNume1      = ((nPara2 + 2) * 100 + 2);
             aLocal      = aLocalesDet % nNume1;
             nLineaLocal = aLocal;
             |SI nLineaLocal ! 0; |HAZ Local2018; |FINSI;
         |FINSI;

         nNumero     = 71;
         nNume1      = (nPara2 * 100 + 2);
         aLocal      = aLocalesInd % nNume1;
         nLineaLocal = aLocal;
         |SI nLineaLocal ! 0;
             |HAZ Local2018;
             nNumero     = 98;
             nNume1      = ((nPara2 + 2) * 100 + 2);
             aLocal      = aLocalesInd % nNume1;
             nLineaLocal = aLocal;
             |SI nLineaLocal ! 0; |HAZ Local2018; |FINSI;
         |FINSI;
         nPara2 = nPara2 + 4;

         |HAZ GrabaHoja4;
         #t1803604#2 = "C";

         |SI nLocales = nLocal; nSalir = 1; |FINSI;
   |SIGUE;
   |CIERRA #agicen48;

   swCual = 1;
|FPRC;

|DEFBUCLE LeeAgicen47;
   #agicen47#1;
   ;
   enEmpresa, enRegistro, 01;
   enEmpresa, enRegistro, 99;
   ;
   NULL, LeeAgicen47;
|FIN;

|PROCESO Hoja4_2018;    || LOCALES
     nNumCampos = 126;
     swCual = 0;
     |DDEFECTO #t1803604;

     nActiv = 0;
     |BUCLE LeeAgicen47;
|FPRC;

|| /////////////////////////
|PROCESO Hoja7b_2019;

     |ABRE #52;
     #52#0 = enEmpresa;
     #52#1 = enRegistro;
     |LEE 040#52=;
     |SI FSalida ! 0;  |DDEFECTO #52;  |FINSI;
     |CIERRA #52;

     |DDEFECTO #t190367b;
     nNumCampos = 20;

     aAlfa = " ";
     |SI #agicen52#90 = "S"; aAlfa = "S"; |FINSI;
     |SI #agicen52#91 = "S"; aAlfa = "N"; |FINSI;
     #t190367b#3 = aAlfa;
     #t190362b#4 = #agicen52#92;
     #t190362b#5 = #agicen52#93;

     |SI #agicen52#94 > "01.01.0000";
         aAlfa  = #agicen52#94;
         aAlfa1 = aAlfa % 102;  #t190367b#6 = aAlfa1;
         aAlfa1 = aAlfa % 402;  #t190367b#7 = aAlfa1;
         aAlfa1 = aAlfa % -104; #t190367b#8 = aAlfa1;
     |FINSI;

     aAlfa = " ";
     |SI #agicen52#95 = "S"; aAlfa = "S"; |FINSI;
     |SI #agicen52#96 = "S"; aAlfa = "N"; |FINSI;
     #t190367b#9  = aAlfa;
     #t190362b#10 = #agicen52#97;
     #t190362b#11 = #agicen52#98;

     |SI #agicen52#99 > "01.01.0000";
         aAlfa  = #agicen52#99;
         aAlfa1 = aAlfa % 102;  #t190367b#12 = aAlfa1;
         aAlfa1 = aAlfa % 402;  #t190367b#13 = aAlfa1;
         aAlfa1 = aAlfa % -104; #t190367b#14 = aAlfa1;
     |FINSI;

     aAlfa = &13 + &10; #t190367b#20 = aAlfa;

     |PARA nPara1 = 1; |SI nPara1 [ nNumCampos; |HACIENDO nPara1 = nPara1 + 1;
           aAlfa = #t190367b#nPara1#;
           |XGRABA nHandle, aAlfa;
     |SIGUE;
|FPRC;

|| /////////////////////////
|PROCESO LeeAgicen53;

     |SI nSocio = 1;
         |DDEFECTO #t1803608;
         |SI swCual = 1;
             #t1803608#2 = "C";
         |FINSI;
     |FINSI;

     nNumero = 3 + (nSocio - 1) * 13;

     aAlfa = " ";
     |SI #agicen53#3 = "S";
         aAlfa = "A";
     |SINO;
         |SI #agicen53#4 = "S";
              aAlfa = "B";
         |SINO;
              |SI #agicen53#5 = "S";
                  aAlfa = "M";
              |FINSI;
         |FINSI;
    |FINSI;
    #t1803608#nNumero# = aAlfa;

    |SI #agicen53#6 > "01.01.0000";
         aAlfa  = #agicen53#6;
         aAlfa1 = aAlfa % 102;  nNumero = nNumero + 1; #t1803608#nNumero# = aAlfa1;
         aAlfa1 = aAlfa % 402;  nNumero = nNumero + 1; #t1803608#nNumero# = aAlfa1;
         aAlfa1 = aAlfa % -104; nNumero = nNumero + 1; #t1803608#nNumero# = aAlfa1;
    |SINO;
         nNumero = nNumero + 3;
    |FINSI;

    nNumero = nNumero + 1;
    aAlfa = #agicen53#7; |HAZ QuitaRaros; #t1803608#nNumero# = aAlfa;
    nNumero = nNumero + 1;
    aAlfa = #agicen53#8; |HAZ QuitaRaros; #t1803608#nNumero# = aAlfa;

    aAlfa = "";
    |SI #agicen53#20 = "S"; aAlfa = "N"; |FINSI;
    |SI #agicen53#19 = "S"; aAlfa = "S"; |FINSI;
    nNumero = nNumero + 1; #t1803608#nNumero# = aAlfa;

    aAlfa = "";
    |SI #agicen53#22 = "S"; aAlfa = "N"; |FINSI;
    |SI #agicen53#21 = "S"; aAlfa = "S"; |FINSI;
    nNumero = nNumero + 1; #t1803608#nNumero# = aAlfa;

    aAlfa = "";
    |SI #agicen53#24 = "S"; aAlfa = "N"; |FINSI;
    |SI #agicen53#23 = "S"; aAlfa = "S"; |FINSI;
    nNumero = nNumero + 1; #t1803608#nNumero# = aAlfa;

    aAlfa = "";
    |SI #agicen53#26 = "S"; aAlfa = "N"; |FINSI;
    |SI #agicen53#25 = "S"; aAlfa = "S"; |FINSI;
    nNumero = nNumero + 1; #t1803608#nNumero# = aAlfa;

    nNume = #agicen53#18 * 100; aAlfa = nNume;
    aAlfa = ("00000" + aAlfa) % -105;
    nNumero = nNumero + 1; #t1803608#nNumero# = aAlfa;

    nNume = #agicen53#72 * 100; aAlfa = nNume;
    aAlfa = ("00000" + aAlfa) % -105;
    nNumero = nNumero + 1; #t1803608#nNumero# = aAlfa;

     nSocio = nSocio + 1;
     |SI nSocio = 5;
         |HAZ GrabaHoja8;
         nSocio = 1;
         swCual = 1;
     |FINSI;
|FPRC;

|DEFBUCLE LeeAgicen53;
     #agicen53#1;
     ;
     enEmpresa, enRegistro, 01;
     enEmpresa, enRegistro, 99;
     e;
     NULL, LeeAgicen53;
|FIN;

|PROCESO Hoja8_2018;

     nNumCampos = 58;
     swCual = 0;
     |DDEFECTO #t1803608;

     nSocio = 1;
     |BUCLE LeeAgicen53;
     |SI nSocio > 1;
         |HAZ GrabaHoja8;
     |FINSI;
|FPRC;

|PROCESO GrabaHoja8;
     aAlfa = &13 + &10;
     #t1803608#58 = aAlfa;

     |PARA nPara1 = 1; |SI nPara1 [ nNumCampos; |HACIENDO nPara1 = nPara1 + 1;
           aAlfa = #t1803608#nPara1#;
           |XGRABA nHandle, aAlfa;
     |SIGUE;
|FPRC;

|PROCESO LeeAgicen54;

    |SI nSocio = 1;
         |DDEFECTO #t1803609;
         |SI swCual = 1;
             #t1803609#2 = "C";
         |FINSI;
    |FINSI;

    nNumero = 3 + (nSocio - 1) * 5;
    aAlfa = #agicen54#3; |HAZ QuitaRaros; #t1803609#nNumero# = aAlfa;
    nNumero = nNumero + 1;
    aAlfa = #agicen54#4; |HAZ QuitaRaros; #t1803609#nNumero# = aAlfa;

    nNume = #agicen54#5 * 100; aAlfa = nNume;
    aAlfa = ("00000" + aAlfa) % -105;
    nNumero = nNumero + 1; #t1803609#nNumero# = aAlfa;

    nNume = #agicen54#6 * 100; aAlfa = nNume;
    aAlfa = ("00000000000000" + aAlfa) % -114;
    nNumero = nNumero + 1; #t1803609#nNumero# = aAlfa;

     nSocio = nSocio + 1;
     |SI nSocio = 7;
         |HAZ GrabaHoja9;
         nSocio = 1;
         |SI swCual = 1; |ERROR10; |FINSI;
          swCual = 1;
     |FINSI;
|FPRC;

|DEFBUCLE LeeAgicen54;
     #agicen54#1;
     ;
     enEmpresa, enRegistro, 01;
     enEmpresa, enRegistro, 99;
     e;
     NULL, LeeAgicen54;
|FIN;

|PROCESO Hoja9_2018;

     nNumCampos = 34;
     swCual = 0;
     |DDEFECTO #t1803609;

     nSocio = 1;
     |BUCLE LeeAgicen54;
     |SI nSocio > 1;
         |HAZ GrabaHoja9;
     |FINSI;
|FPRC;

|PROCESO GrabaHoja9;
     aAlfa = &13 + &10;
     #t1803609#34 = aAlfa;

     |PARA nPara1 = 1; |SI nPara1 [ nNumCampos; |HACIENDO nPara1 = nPara1 + 1;
           aAlfa = #t1803609#nPara1#;
           |XGRABA nHandle, aAlfa;
     |SIGUE;
|FPRC;

|PROCESO Emitir;

     |HAZ AbreFichero;

     nCampo0 = #0#0;                    ||Si es igual a 1, lo paso al 2
     |SI #0#0 = 1; #0#0 = 2; |FINSI;

     |SI fFecha ] "01.07.2018";
         |HAZ Hoja1_2018;
         |SI fFecha ] "01.01.2019";
             |HAZ Hoja2A_2019;
             |HAZ Hoja2B_2019;
         |SINO;
             |HAZ Hoja2A_2018;
             |HAZ Hoja2B_2018;
         |FINSI;
         |HAZ Hoja2C_2018;
     |SINO;
         |HAZ Hoja1_2007;
         |HAZ Hoja2A_2007;
         |HAZ Hoja2B_2007;
         |HAZ Hoja2C_2007;
     |FINSI;

     |HAZ Hoja3_2007;
     |SI fFecha ] "01.07.2018";
         |HAZ Hoja4_2018;
     |SINO;
         |HAZ Hoja4_2007;
     |FINSI;
     |HAZ Hoja5_2007;
     |HAZ Hoja6_2007;
     |HAZ Hoja7_2007;

     |SI fFecha ] "01.01.2019";
         |HAZ Hoja7b_2019;
     |FINSI;

     |SI fFecha ] "01.07.2018";
         |HAZ Hoja8_2018;
         |HAZ Hoja9_2018;
     |SINO;
         |HAZ Hoja8_2007;
     |FINSI;

     #0#0 = nCampo0;
     |HAZ CierraFichero;

     |SI #0#0 = 1;
         |HAZ IrPagina;
     |FINSI;

     |SI #0#0 = 3;
         eaX002_10    = #t1803601#4
         eaX002_11    = #t1803601#5;
         eaX002_12    = "036";
         eaX002_13    = #t1803601#41;
         eaX002_14    = 99;

||         |HAZ PresentaPortal;
     |FINSI;
|FPRC;


|PROCESO Chequeos3;
     |SI eaTipo = "A";
          |SI #42#5 = " "; |Y #42#8 = " "; |Y #42#9 = " "; |Y #42#10 = " ";
          |Y #42#11 = " "; |Y #42#37 = " ";
               swDefectoA = 1;
               || aMensaje = "    La página 2A sólo es accesible si se marca la casilla ";
               || aMensaje = aMensaje + "111, 122, 123, 124 o 125";
          |FINSI;
     |FINSI;
     |SI eaTipo = "B";
         |SI #42#4 = " "; |Y #42#5 = " "; |Y #42#6 = " "; |Y #42#8 = " ";
             |Y #42#9 = " "; |Y #42#10 = " "; |Y #42#11 = " "; |Y #42#37 = " ";
               swDefectoB = 1;
               || aMensaje = "    La página 2B sólo es accesible si se marca la casilla ";
               || aMensaje = aMensaje + "111, 120, 122, 123, 124 o 125";
          |FINSI;
     |FINSI;
     |SI eaTipo = "C";
          |SI #42#4 = " "; |Y #42#5 = " "; |Y #42#6 = " "; |Y #42#8 = " ";
              |Y #42#10 = " "; |Y #42#11 = " "; |Y #42#37 = " ";
               swDefectoC = 1;
               || aMensaje = "    La página 2C sólo es accesible si se marca la casilla ";
               || aMensaje = aMensaje + "111, 122, 124 o 125";
          |FINSI;
     |FINSI;

|FPRC;

|PROCESO Chequeos2;
     aMensaje = "";

     aAlfa = #42#2; |QBF aAlfa;
     |SI aAlfa = ""; |Y #0#0 = 2;
          aMensaje = "NIF en las causas de presentación.";
          |ACABA;
     |FINSI;
     aAlfa = #42#3; |QBF aAlfa;
     |SI aAlfa = "";
          aMensaje = "Identificación en las causas de presentación.";
          |ACABA;
     |FINSI;
     aAlfa = #0#1; |QBF aAlfa;
     |SI aAlfa = "";
          aMensaje = "Lugar, Fecha y Firma."
     |FINSI;
     aAlfa = #0#2; |QBF aAlfa;
     |SI aAlfa = "";
          aMensaje = "Lugar, Fecha y Firma."
     |FINSI;
     aAlfa = #0#5; |QBF aAlfa;
     |SI aAlfa = "";
          aMensaje = "Lugar, Fecha y Firma."
     |FINSI;
|FPRC;

|PROCESO EmiteEsto;
     fFecha = ~;
     |ABRE #42;
     #42#0 = enEmpresa;
     #42#1 = enRegistro;
     |LEE 101#42=;
     |SI FSalida ! 0;
          |CIERRA #42;
          |MENAV "0000 Datos incompletos, rellene el registro del modelo 036.";
          |ACABA;
     |FINSI;

     |HAZ CogeMac;

     aIP = "";
     |IP_REMOTO aIP;  |QBF aIP;

     |ABRE #0;
     #0#7 = eaDSMAC;
     |LEE 000#0=;
     |SI FSalida ! 0;
         #0#7 = aIP;
         |LEE 000#0=;
         |SI FSalida = 0;
             #0#7 = eaDSMAC;
         |SINO;
             |DDEFECTO #0;
             #0#7 = eaDSMAC;
         |FINSI;
         |GRABA 020#0n;
         |LIBERA #0;
     |FINSI;

     #0#7 = eaDSMAC;
     |LEE 101#0=;

     |PUSHV 0501 2380;

     #0#1 = #42#31;
     #0#2 = #42#32;
     #0#3 = #42#33;
     #0#4 = #42#36;
     #0#5 = #42#34;

     eaForzExplorador = "N";
     |HAZ Explorador;
     #0#8 = eaPathExplorador;

     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
         #42#31 = #0#1;
         #42#32 = #0#2;
         #42#33 = #0#3;
         #42#36 = #0#4;
         #42#34 = #0#5;
         |GRABA 020#42a;
         |LIBERA #42;

         |HAZ Chequeos2;

         swDefectoA = 0;
         swDefectoB = 0;
         swDefectoC = 0;
         |HAZ Chequeos3;
         |SI aMensaje = "";
              |HAZ Emitir;
         |SINO;
              |SI aMensaje = "Lugar, Fecha y Firma."
                   aMensaje = "    Es obligatorio rellenar los campos " + aMensaje;
              |SINO;
                   aMensaje = "    Es obligatorio rellenar el campo " + aMensaje;
              |FINSI;
              |MENAV aMensaje;
              |SI #42#4 = "S"; |Y #0#0 = 2;
                    aMensaje = "    La solicitud de NIF no se puede realizar telemáticamente. ";
                    aMensaje = aMensaje + "Es necesaria la impresión en PDF.";
              |FINSI;
              |MENAV aMensaje;
         |FINSI;
     |FINSI;
     |POPV;

     |PDEFECTO #0, 1, 6;
     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;

     |CIERRA #42;
|FPRC;
