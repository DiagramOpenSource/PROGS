|FICHEROS;
     :/modelos/def/dsmox002;
|FIN;

|VARIABLES;
     nHandleError   = 0;
     nReg           = 0;
     nError         = 0;
     nCodError      = 0;
     nCaracter      = 0;
     nConta         = 0;
     nErrorCC       = 0;
     nErrorEE       = 0;
     nCopiado       = 0;
     nNoLoHago      = 0;
     nHandle        = 0;
     nOk            = 0;

     aFicPortal     = "";
     aFicError      = "";
     aPathPatrones  = "";
     aPath          = "";
     aPatron        = "";
     aEjecutable    = "";
     aCadena1       = "";
     aCadena2       = "";
     aCadena3       = "";
     aCadena4       = "";
     aRegistro      = "";
     aNif           = "";
     aNombre        = "";
     aDescri        = "";
     aValidar       = "";
     aEnsobrar      = "";
     aEjecu         = "";
     aNum           = "";
     aPrgJava       = "";
     aPathLocal     = "";
     aPathPlugins   = "";
     aDocRemoto     = "";
     aDocServidor   = "";
     aIPRemoto      = "";
     aDIR           = "";
     aBase          = "";
     aLinea         = "";
     aFicCert       = "";
     aName          = "";
     aVal           = "";
     aLee           = "";
     aMod           = "";

     {1}aContiene   = "";

     {99}aCodEE     = "";
     {99}aCodDCC    = "";
     {99}aCodPCC    = "";
|FIN;

|INCLUYE i_varemi;

|PROCESO PermisoPortal;
     enPortal = 1;

/*
     enPortal = 0;

     |DBASS aBase;  |QBF aBase;

     aArchivo = aBase + "integral/integral.ini";

     |XABRE "U", aArchivo, nHandle;
     |SI FSalida ] 0;
         |PARA; |SI; |HACIENDO;
               |XLEE nHandle, 250, aCadena;
               |SI FSalida < 0;  |SAL;  |FINSI;
               |QBF aCadena;

               |SI aCadena = "PORTAL";
                    enPortal = 1;
                    |SAL;
               |FINSI;
          |SIGUE;
          |XLEE nHandle, 100, aLinea;
     |FINSI;
     |XCIERRA nHandle;

     |SI enPortal = 0;
          aAlfa = "0000Esta opción requiere tener instalado ";
          aAlfa = aAlfa + "el Portal Asesor DsElephant.";
          aAlfa = aAlfa + "Consulte con su comercial.";
          |MENAV aAlfa;
     |FINSI;

     |PULSATECLA;
*/
|FPRC;

|| ///////////////////////////////
|PROCESO PortalDirecto;
     |DBASS aBase;
     aPath = aBase + "modelos/fich/";

     aFic = "dsmox002" + Usuario;
     |NOME_DAT #dsmox002#aFic#;
     |PATH_DAT #dsmox002#aPath#;

     |ABRE #dsmox002;  |CIERRA #dsmox002;  |DELINDEX #dsmox002;

     eaForzExplorador = "N";
     |HAZ Explorador;

     |ABRE #dsmox002;
     #dsmox002#0  = 1;
     #dsmox002#2  = eaPathEmision;
     #dsmox002#3  = eaPathInternet;
     #dsmox002#4  = eaPathPreDecla;
     #dsmox002#5  = eaPathLanza;
     #dsmox002#6  = eaPathExplorador;
     #dsmox002#7  = eaFicheroPlano;
     #dsmox002#10 = eaX002_10;
     #dsmox002#11 = eaX002_11;
     #dsmox002#12 = eaX002_12;
     #dsmox002#13 = eaX002_13;
     #dsmox002#14 = eaX002_14;
     #dsmox002#15 = eaX002_15;
     #dsmox002#16 = eaX002_16;
     #dsmox002#17 = eaX002_17;
     #dsmox002#18 = eaX002_18;
     #dsmox002#19 = eaX002_19;
     #dsmox002#20 = eaX002_20;
     #dsmox002#21 = eaX002_21;
     #dsmox002#22 = eaX002_22;
     #dsmox002#23 = eaX002_23;
     #dsmox002#24 = eaX002_24;
     #dsmox002#25 = eaX002_25;
     #dsmox002#26 = eaX002_26;
     #dsmox002#27 = eaX002_27;
     #dsmox002#28 = eaX002_28;
     #dsmox002#29 = eaX002_29;
     #dsmox002#30 = eaX002_30;
     #dsmox002#31 = eaX002_31;
     #dsmox002#32 = eaX002_32;
     #dsmox002#33 = eaX002_33;
     #dsmox002#34 = eaX002_34;
     #dsmox002#35 = eaX002_35;
     #dsmox002#36 = eaX002_36;
     #dsmox002#38 = eaX002_38;
     #dsmox002#39 = eaX002_39;
     #dsmox002#40 = eaX002_40;
     #dsmox002#41 = eaX002_41;
     #dsmox002#42 = eaX002_42;
     #dsmox002#43 = eaX002_43;
     #dsmox002#44 = eaX002_44;
     #dsmox002#45 = eaX002_45;
     #dsmox002#46 = eaX002_46;

     |GRABA 020#dsmox002.n;
     |LIBERA #dsmox002;
     |CIERRA #dsmox002;

     |SUB_EJECUTA "|:modelos/dsmox002.tab";
     eaX002_10 = "";
     eaX002_11 = "";
     eaX002_12 = "";
     eaX002_13 = "";
     eaX002_14 = "";
     eaX002_15 = "";
     eaX002_16 = "";
     eaX002_17 = "";
     eaX002_18 = "";
     eaX002_19 = "";
     eaX002_20 = "";
     eaX002_21 = "";
     eaX002_22 = "";
     eaX002_23 = "";
     eaX002_24 = "";
     eaX002_25 = "";
     eaX002_26 = "";
     eaX002_27 = "";
     eaX002_28 = "";
     eaX002_29 = "";
     eaX002_30 = "";
     eaX002_31 = "";
     eaX002_32 = "";
     eaX002_33 = "";
     eaX002_34 = "";
     eaX002_35 = "";
     eaX002_36 = "";
     eaX002_38 = "";
     eaX002_39 = "";
     eaX002_40 = "";
     eaX002_41 = "";
     eaX002_42 = "";
     eaX002_43 = "";
     eaX002_44 = "";
     eaX002_45 = "";
     eaX002_46 = "";
|FPRC;

|PROCESO PresentaPortal;
     |SI enDirecta = 1;
         enOK = 0;
         |HAZ PortalDirecto;

         aAbre = eaPathEmision + Usuario + ".ok";
         |XABRE "E", aAbre, 0;
         |SI FSalida ] 0;
             enOK = 1;
             eaJusti = "";
             |||HAZ GrabaImpresoPortal;
             |FBORRA aAbre;
         |FINSI;

         |ACABA;
     |FINSI;
|FPRC;
