|FICHEROS;
     agiz0025 #0;

     agifigen #1;     ||Ficha de Cliente

     refen00@ #900;
     refen01@ #901;
|FIN;

|VARIABLES;
     &eaPathBasica   = "";
     &eaPathContagen = "";
     &eaPathContasoc = "";
     &eaPathRen2018  = "";
     &eaPathRen2017  = "";
     &eaPathRen2016  = "";
     &eaPathRen2015  = "";
     &eaPathRen2014  = "";
     &eaPathRen2013  = "";
     &eaPathRen2012  = "";
     &eaPathRen2011  = "";
     &eaPathRen2010  = "";
     &eaPathRen2009  = "";
     &eaPathRen2008  = "";
     &eaPathRen2007  = "";
     &eaPathRen2006  = "";
     &eaPathRen2005  = "";
     &eaPathRen2004  = "";
     &eaPathRen2003  = "";
     &eaPathRen2002  = "";
     &eaPathRen2001  = "";
     &eaPathRen2000  = "";
     &eaPathRen1999  = "";
     &eaPathRen1998  = "";
     &eaPathRen1997  = "";
     &eaPathRen1996  = "";
     &eaPathRen1995  = "";
     &eaPathRen1994  = "";
     &eaPathFacturar = "";
     &eaPathLaboral  = "";
     &eaPathIntegral = "";
     &eaPathDsmodelo = "";
     &eaPathFiscal   = "";
     &eaPrograma     = "";
     &eaExtension    = "";
     &eaRenta        = "";
     nRenta          = 0;
     nSwMen          = 0;
     nInkey          = 0;
     aAlfa           = "";
     aAlfa1          = "";
     aAlfa2          = "";
     nNume1          = 0;
     nNume2          = 0;
     nNume3          = 0;

     &eaAlfa         = "";
     nSwError        = 0;
     aPath           = "";
     aPathDef        = "";
     aPathFic        = "";
     aPathFicE       = "";
     aDef00          = "";
     aDef01          = "";
     aQueQuiero      = "";
     aNomDef         = "";
     aNomDefE        = "";
     nSw             = 0;
     aMensa1         = "";
     aMensa2         = "";
     aEmpresa        = "";
     nSwEmpresa      = 0;

     fFecha1         = @;
     fFecha2         = @;

     nCampo1         = 0;
     nCampo2         = 0;
     nCampo3         = 0;

     nDPara1         = 0;
     nDPara2         = 0;
     nDPara3         = 0;
     nDPara4         = 0;
     nHPara1         = 0;
     nHPara2         = 0;
     nHPara3         = 0;
     nHPara4         = 0;
     nDPara11        = 0;
     nHPara11        = 0;
     nDPara12        = 0;
     nHPara12        = 0;
     aDPara1         = "";
     aDPara2         = "";
     aDPara3         = "";
     aDPara4         = "";
     aDPara5         = "";
     aHPara1         = "";
     aHPara2         = "";
     aHPara3         = "";
     aHPara4         = "";
     aHPara5         = "";
     fDPara1         = @;
     fHPara1         = @;
     fDPara2         = @;
     fHPara2         = @;

     nDAny           = 0;
     nHAny           = 0;
     nAny            = 0;
|FIN;

|CALCULO DesdeHasta; |TIPO 0;
  |C_M #0Campo, 0, aAlfa;
  |SI aAlfa = "N"; |ACABA; |FINSI;

  |SI nInkey = 2; |ACABA; |FINSI;

  |SI Campo = 1; nNume1 = 5; nNume2 = 6; |FINSI;
  |SI Campo = 2; nNume1 = 7; nNume2 = 8; |FINSI;
  |SI Campo = 4; nNume1 = 9; nNume2 = 10; |FINSI;
  aAlfa = #0Campo;
  |C_M #0nNume1,1,aAlfa;
  |C_M #0nNume2,1,aAlfa;
|FCAL;

|CALCULO Hasta; |TIPO 0;
  |C_M #0Campo, 0, aAlfa;
  |SI aAlfa = "N"; |ACABA; |FINSI;

  |SI nInkey = 2; |ACABA; |FINSI;

  nNume1 = Campo - 1;
  |SI #0Campo < #0nNume1;
      |MENAV "    Error en Seleccion Desde/Hasta";
      |ERROR;
  |FINSI;
|FCAL;
|| ------------------------------------------------------------------

|PROCESO CargoReferencia;
   aDef00   = "";
   nSwError = 0;
   aPathDef = aPath + "def/";
   aPathFic = aPath + "fich/";
   |SI nSwEmpresa = 1; aPathFicE = aPathFic + aEmpresa + "/";  |FINSI;

   aDef00 = aPathDef + aNomDef;
   |CARGA_DEF aDef00, refen00@;
   |SI FSalida ! 0;
       aAlfa1 = "     Error en Cargar el Def " + aNomDef;
       |SI nSwMen = 0; |MENAV aAlfa1; |FINSI;
       nSwError = 1;
       aDef00   = "";
   |FINSI;
|FPRC;

|PROCESO CargoReferencia_E;
   aDef01   = "";
   nSwError = 0;
   aPathDef = aPath + "def/";
   aPathFic = aPath + "fich/";

   aDef01 = aPathDef + aNomDefE;
   |CARGA_DEF aDef01, refen01@;
   |SI FSalida ! 0;
       aAlfa1 = "     Error en Cargar el Def " + aNomDefE;
       |SI nSwMen = 0; |MENAV aAlfa1; |FINSI;
       nSwError = 1;
       aDef01   = "";
   |FINSI;
|FPRC;

|PROCESO DesCargoReferencia_E;
  |SI aDef01 ! ""; |DESCARGA_DEF #refen01@; aDef01 = ""; |FINSI;
|FPRC;

|PROCESO DesCargoReferencia;
  |SI aDef00 ! ""; |DESCARGA_DEF #refen00@; aDef00 = ""; |FINSI;
|FPRC;

|| ------------------------------------------------------------------
|PROCESO Mensaje;

  |SI nSw = 0;
     |CUADRO 1902 2360;
     |PINTA 2003, " Espere por favor. Procesando ...                        ";
     |PINTA 2103, "                                                         ";
     |PINTA 2203, "                                                         ";
     nSw = 1;
  |FINSI;

  |SI nSw = 1;
      |PINTA 2037, "                       ";
      |PINTA 2103, "                                                         ";
      |ATRI P; |PINTA 2037, aMensa1; |ATRI 0;
      nSw     = 2;
  |FINSI;

  |SI nSw = 2;
      |PINTA 2103, "                                                         ";
      |PINTA 2104, aMensa2;
  |FINSI;
|FPRC;

|PROCESO CambioCampos;
   |SI nCampo1 ! -1;
       eaAlfa = #900nCampo1; |HAZ QuitaRarosTfno; #900nCampo1 = eaAlfa;
   |FINSI;
   |SI nCampo2 ! -1;
       eaAlfa = #900nCampo2; |HAZ QuitaRarosTfno; #900nCampo2 = eaAlfa;
   |FINSI;
   |SI nCampo3 ! -1;
       eaAlfa = #900nCampo3; |HAZ QuitaRarosTfno; #900nCampo3 = eaAlfa;
   |FINSI;
|FPRC;

|| ------------------------------------------------------------------
|PROCESO agifigen;
  |PINTA 2137, #1#0;

  eaAlfa = #1#14; |HAZ QuitaRarosTfno; #1#14 = eaAlfa;  || Telefono
  eaAlfa = #1#15; |HAZ QuitaRarosTfno; #1#15 = eaAlfa;  || Fax

||  eaAlfa = #1#61; |HAZ QuitaRarosTfno; #1#61 = eaAlfa;  || Otros telefonos
  |GRABA 020#1a;
  |LIBERA #1;
|FPRC;

|DEFBUCLE agifigen;
 #1#1;
 ;
 00001;
 99999;
 be;
 NULL, agifigen;
|FIN;

|| ------------------------------------------------------------------
|| .... Cambios para todas las aplicaciones
|PROCESO UnSoloRegistro;

    |HAZ CargoReferencia;

    |SI nSwError = 0;

        |SI nSwEmpresa = 0;
            |PATH_DAT #900 aPathFic;
        |SINO;
            |PATH_DAT #900 aPathFicE;
        |FINSI;

        |ABRE #900;
        |LEE 101#900p;
        |SI FSalida = 0;
            |HAZ CambioCampos;
            |GRABA 020#900a;
        |FINSI;
        |LIBERA #900;
        |CIERRA #900;
    |FINSI;
    |HAZ DesCargoReferencia;
|FPRC;

|PROCESO agiz0025Cambio;
     |SI aNomDef = "mey00003"; |O aNomDef = "rem00005";
         |SI #900#2 < #0#7; |O #900#2 > #0#8;
             |ACABA;
         |FINSI;
     |FINSI;

     |HAZ CambioCampos;

     |SI aNomDef = "agicen43"; |O aNomDef = "agicen44"; |O aNomDef = "agicen45";
         nCampo1 = 57; nCampo2 = 58; nCampo3 = 59; |HAZ CambioCampos;
         nCampo1 = 66; nCampo2 = 67; nCampo3 = 68; |HAZ CambioCampos;
         |SI aNomDef ! "agicen45";
             nCampo1 = 39; nCampo2 = 40; nCampo3 = 41; |HAZ CambioCampos;
             nCampo1 = 87; nCampo2 = 88; nCampo3 = 89; |HAZ CambioCampos;
         |FINSI;
         nCampo1 = 27; nCampo2 = 28; nCampo3 = 29;
     |FINSI;
     |SI aNomDef = "agicen53";
         nCampo1 = 69; nCampo2 = 70; nCampo3 = 71; |HAZ CambioCampos;
         nCampo1 = 56; nCampo2 = 57; nCampo3 = 58;
     |FINSI;
     |SI aNomDef = "agitelef";
         nCampo1 = 8;  nCampo2 = 10; nCampo3 = -1; |HAZ CambioCampos;
         nCampo1 = 4;  nCampo2 = 5;  nCampo3 = 6;
     |FINSI;
     |SI aNomDef = "dsam0003";
         nCampo1 = 72; nCampo2 = 74; nCampo3 = 91; |HAZ CambioCampos;
         nCampo1 = 12; nCampo2 = 13; nCampo3 = 71;
     |FINSI;
     |SI aNomDef = "rem00100";
         |SI nAny > 2005;
             nCampo1 = 112; nCampo2 = 129; nCampo3 = -1; |HAZ CambioCampos;
         |FINSI;
         |SI nAny > 2004;
             nCampo1 = 109; nCampo2 = 110; nCampo3 = -1; |HAZ CambioCampos;
         |FINSI;
         nCampo1 = 12; nCampo2 = 13; nCampo3 = 68;
     |FINSI;
     |SI aNomDef = "abom0502"; |O aNomDef = "abom0503"; |O aNomDef = "abom0504";
         |O aNomDef = "abom0505"; aNomDef = "abom0517";
         nCampo1 = 13; nCampo2 = 14; nCampo3 = 15; |HAZ CambioCampos;
         nCampo1 = 10; nCampo2 = 11; nCampo3 = 12;
     |FINSI;
     |SI aNomDef = "abom0515";
         nCampo1 = 17; nCampo2 = 19; nCampo3 = -1; |HAZ CambioCampos;
         nCampo1 = 11; nCampo2 = 13; nCampo3 = 15;
     |FINSI;

     |GRABA 020#900a;
     |LIBERA #900;

     nNume3 = nNume3 + 1;
     |SI nNume3 [ 1; aAlfa = "/"; |FINSI;
     |SI nNume3 = 2; aAlfa = "-"; |FINSI;
     |SI nNume3 ] 3; aAlfa = "\"; nNume3 = 0; |FINSI;
     |PINTA 2137, aAlfa;
|FPRC;

|DEFBUCLE agiz0025_N;
     #900#1001;
     ;
     nDPara1;
     nHPara1;
     be;
     NULL, agiz0025Cambio;
|FIN;

|DEFBUCLE agiz0025_NN;
     #900#1002;
     ;
     nDPara1, nDPara2;
     nHPara1, nHPara2;
     be;
     NULL, agiz0025Cambio;
|FIN;

|DEFBUCLE agiz0025_NNN;
     #900#1003;
     ;
     nDPara1, nDPara2, nDPara3;
     nHPara1, nHPara2, nHPara3;
     be;
     NULL, agiz0025Cambio;
|FIN;

|DEFBUCLE agiz0025_NNNN;
     #900#1004;
     ;
     nDPara1, nDPara2, nDPara3, nDPara4;
     nHPara1, nHPara2, nHPara3, nHPara4;
     be;
     NULL, agiz0025Cambio;
|FIN;

|DEFBUCLE agiz0025_NNAA;
     #900#1004;
     ;
     nDPara1, nDPara2, aDPara3, aDPara4;
     nHPara1, nHPara2, aHPara3, aHPara4;
     be;
     NULL, agiz0025Cambio;
|FIN;

|DEFBUCLE agiz0025_NNAN;
     #900#1004;
     ;
     nDPara1, nDPara2, aDPara3, nDPara4;
     nHPara1, nHPara2, aHPara3, nHPara4;
     be;
     NULL, agiz0025Cambio;
|FIN;

|DEFBUCLE agiz0025_A;
     #900#1001;
     ;
     aDPara1;
     aHPara1;
     be;
     NULL, agiz0025Cambio;
|FIN;

|DEFBUCLE agiz0025_AA;
     #900#1002;
     ;
     aDPara1, aDPara2;
     aHPara1, aHPara2;
     be;
     NULL, agiz0025Cambio;
|FIN;

|DEFBUCLE agiz0025_AAAFA;
     #900#1005;
     ;
     aDPara1, aDPara2, aDPara3, fDPara2, aDPara5;
     aHPara1, aHPara2, aHPara3, fHPara2, aHPara5;
     be;
     NULL, agiz0025Cambio;
|FIN;

|DEFBUCLE agiz0025_AN;
     #900#1002;
     ;
     aDPara1, nDPara2;
     aHPara1, nHPara2;
     be;
     NULL, agiz0025Cambio;
|FIN;

|DEFBUCLE agiz0025_NF;
     #900#1002;
     ;
     nDPara1, fDPara2;
     nHPara1, fHPara2;
     be;
     NULL, agiz0025Cambio;
|FIN;

|PROCESO ModuloIntegrador;

    || ...  Ficheros de basica
    |SI eaPathBasica = "";        || Imposible que sea en blanco
        |DBASE eaPathBasica;
    |FINSI;

    nSwEmpresa = 0;  ||Sin empresa;
    aPath      = eaPathBasica;

    nSw        = 0;
    aMensa1 = "Basica ";
    aMensa2 = "Fichero -Fich.General Cliente"; |HAZ Mensaje;
    |BUCLE agifigen;

    aNomDef = "agiapl25";
    aMensa2 = "Fichero -Defectos Aplazamientos"; |HAZ Mensaje;
    nCampo1 = 12; nCampo2 = -1; nCampo3 = -1;
    |HAZ UnSoloRegistro;

    aNomDef = "agicen02";
    aMensa2 = "Fichero -Causa y O.D.Censales"; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        nDPara1 = 00001; nHPara1 = 99999;
        nDPara2 = 00;    nHPara2 = 99;
        nCampo1 = 21; nCampo2 = 32; nCampo3 = -1;
        |BUCLE agiz0025_NN;
    |FINSI;
    |HAZ DesCargoReferencia;

    aNomDef = "agicen06";
    aMensa2 = "Fichero -Part¡cipes 97 "; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        nDPara1 = 00001; nHPara1 = 99999;
        nDPara2 = 00;    nHPara2 = 99;
        nDPara3 = 00;    nHPara3 = 99;
        nCampo1 = 16; nCampo2 = -1; nCampo3 = -1;
        |BUCLE agiz0025_NNN;
    |FINSI;
    |HAZ DesCargoReferencia;

    aNomDef = "agicen08";
    aMensa2 = "Fichero -Modelo 845 "; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        nDPara1 = 00001; nHPara1 = 99999;
        nDPara2 = 00;    nHPara2 = 99;
        nDPara3 = 00;    nHPara3 = 99;
        nCampo1 = 19; nCampo2 = 49; nCampo3 = -1;
        |BUCLE agiz0025_NNN;
    |FINSI;
    |HAZ DesCargoReferencia;

    aNomDef = "agicen13";
    aMensa2 = "Fichero -Part¡cipes 98 "; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        nDPara1 = 00001; nHPara1 = 99999;
        nDPara2 = 00;    nHPara2 = 99;
        nDPara3 = 00;    nHPara3 = 99;
        nCampo1 = 22; nCampo2 = -1; nCampo3 = -1;
        |BUCLE agiz0025_NNN;
    |FINSI;
    |HAZ DesCargoReferencia;

    aNomDef = "agicen15";
    aMensa2 = "Fichero -Repres.,Oblig.Tribut"; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        nDPara1 = 00001; nHPara1 = 99999;
        nCampo1 = 14; nCampo2 = -1; nCampo3 = -1;
        |BUCLE agiz0025_N;
    |FINSI;
    |HAZ DesCargoReferencia;

    aNomDef = "agicen21";
    aMensa2 = "Fichero -Datos Identific. 036"; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        nDPara1 = 00000; nHPara1 = 99999;
        nDPara2 = 00;    nHPara2 = 99;
        nCampo1 = 10; nCampo2 = 24; nCampo3 = -1;
        |BUCLE agiz0025_NN;
    |FINSI;
    |HAZ DesCargoReferencia;

    aNomDef = "agicen25";
    aMensa2 = "Fichero -Socios,Herederos 036"; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        nDPara1 = 00000; nHPara1 = 99999;
        nDPara2 = 00;    nHPara2 = 99;
        nDPara3 = 00;    nHPara3 = 99;
        nCampo1 = 11; nCampo2 = -1; nCampo3 = -1;
        |BUCLE agiz0025_NNN;
    |FINSI;
    |HAZ DesCargoReferencia;

    aNomDef = "agicen43";
    aMensa2 = "Fichero -Id.Per.Fis.036"; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        nDPara1 = 00000; nHPara1 = 99999;
        nDPara2 = 00;    nHPara2 = 99;
        nCampo1 = 27; nCampo2 = 28; nCampo3 = 29;
        |BUCLE agiz0025_NN;
    |FINSI;
    |HAZ DesCargoReferencia;

    aNomDef = "agicen44";
    aMensa2 = "Fichero -Id.Per.Jur.036"; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        nDPara1 = 00000; nHPara1 = 99999;
        nDPara2 = 00;    nHPara2 = 99;
        nCampo1 = 27; nCampo2 = 28; nCampo3 = 29;
        |BUCLE agiz0025_NN;
    |FINSI;
    |HAZ DesCargoReferencia;

    aNomDef = "agicen45";
    aMensa2 = "Fichero -Id.Est.Per.036"; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        nDPara1 = 00000; nHPara1 = 99999;
        nDPara2 = 00;    nHPara2 = 99;
        nCampo1 = 27; nCampo2 = 28; nCampo3 = 29;
        |BUCLE agiz0025_NN;
    |FINSI;
    |HAZ DesCargoReferencia;

    aNomDef = "agicen46";
    aMensa2 = "Fichero -Representantes 036"; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        nDPara1 = 00000; nHPara1 = 99999;
        nDPara2 = 00;    nHPara2 = 99;
        nDPara3 = 00;    nHPara3 = 99;
        nCampo1 = 26; nCampo2 = 27; nCampo3 = 28;
        |BUCLE agiz0025_NNN;
    |FINSI;
    |HAZ DesCargoReferencia;

    aNomDef = "agicen53";
    aMensa2 = "Fichero -Socios 036"; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        nDPara1 = 00000; nHPara1 = 99999;
        nDPara2 = 00;    nHPara2 = 99;
        nDPara3 = 00;    nHPara3 = 99;
        nCampo1 = 56; nCampo2 = 57; nCampo3 = 58;
        |BUCLE agiz0025_NNN;
    |FINSI;
    |HAZ DesCargoReferencia;

    aNomDef = "agidanif";
    aMensa2 = "Fichero -Datos Personales"; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        aDPara1 = "            "; aHPara1 = "            ";
        nDPara2 = 00;             nHPara2 = 99;
        nCampo1 = 34; nCampo2 = 35; nCampo3 = -1;
        |BUCLE agiz0025_AN;
    |FINSI;
    |HAZ DesCargoReferencia;

    aNomDef = "agidatos";
    aMensa2 = "Fichero -Datos -2-"; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        nDPara1 = 00000; nHPara1 = 99999;
        nCampo1 = 14; nCampo2 = 15; nCampo3 = -1;
        |BUCLE agiz0025_N;
    |FINSI;
    |HAZ DesCargoReferencia;

    aNomDef = "agihenvi"; || no cambiar

    aNomDef = "agim0003";
    aMensa2 = "Fichero -Registro de NIF"; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        aDPara1 = "            "; aHPara1 = "            ";
        nCampo1 = 8; nCampo2 = 17; nCampo3 = -1;
        |BUCLE agiz0025_A;
    |FINSI;
    |HAZ DesCargoReferencia;

    aNomDef = "agim0004";
    aMensa2 = "Fichero -Repres. Empresa"; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        nDPara1 = 00000; nHPara1 = 99999;
        nDPara2 = 00;    nHPara2 = 99;
        nCampo1 = 12; nCampo2 = -1; nCampo3 = -1;
        |BUCLE agiz0025_NN;
    |FINSI;
    |HAZ DesCargoReferencia;

    aNomDef = "agim0007";
    aMensa2 = "Fichero -Registrad.Mercantil"; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        nDPara1 = 00000;         nHPara1 = 99999;
        fDPara2 = fFecha1;       fHPara2 = fFecha2;
        nCampo1 =  3; nCampo2 = 11; nCampo3 = -1;
        |BUCLE agiz0025_NF;
    |FINSI;
    |HAZ DesCargoReferencia;

    aNomDef = "agim0024";
    aMensa2 = "Fichero -Repres.Admist.Socie."; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        nDPara1 = 00000; nHPara1 = 99999;
        nDPara2 = 00;    nHPara2 = 99;
        nDPara3 = 00;    nHPara3 = 99;
        nCampo1 = 13; nCampo2 = -1; nCampo3 = -1;
        |BUCLE agiz0025_NNN;
    |FINSI;
    |HAZ DesCargoReferencia;

    aNomDef = "agim0025";
    aMensa2 = "Fichero -Socios R.Sociedades"; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        nDPara1 = 00000; nHPara1 = 99999;
        nDPara2 = 00;    nHPara2 = 99;
        nDPara3 = 000;   nHPara3 = 999;
        nCampo1 = 11; nCampo2 = -1; nCampo3 = -1;
        |BUCLE agiz0025_NNN;
    |FINSI;
    |HAZ DesCargoReferencia;

    aNomDef = "agim0026";
    aMensa2 = "Fichero -Cargos Sociedades "; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        nDPara1 = 00000; nHPara1 = 99999;
        nDPara2 = 00;    nHPara2 = 99;
        nDPara3 = 00;    nHPara3 = 99;
        nCampo1 = 11; nCampo2 = -1; nCampo3 = -1;
        |BUCLE agiz0025_NNN;
    |FINSI;
    |HAZ DesCargoReferencia;

    aNomDef = "agim0028";
    aMensa2 = "Fichero -Acceso F.Sociedades "; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        nDPara1 = 00000; nHPara1 = 99999;
        nCampo1 =  5; nCampo2 = -1; nCampo3 = -1;
        |BUCLE agiz0025_N;
    |FINSI;
    |HAZ DesCargoReferencia;

    aNomDef = "agim0031";
    aMensa2 = "Fichero -Subvenciones "; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        nDPara1 = 000;   nHPara1 = 999;
        nCampo1 =  7; nCampo2 = -1; nCampo3 = -1;
        |BUCLE agiz0025_N;
    |FINSI;
    |HAZ DesCargoReferencia;

    aNomDef = "agirefer";
    aMensa2 = "Fichero -Referencias"; |HAZ Mensaje;
    |HAZ CargoReferencia;
    |SI nSwError = 0;
        nDPara1 = 00000; nHPara1 = 99999;
        nCampo1 =  14; nCampo2 = 15; nCampo3 = -1;
        |BUCLE agiz0025_N;
    |FINSI;
    |HAZ DesCargoReferencia;


    || ...  Ficheros de Integral
    |SI eaPathIntegral ! "";

        nSwEmpresa = 0;  ||Sin empresa;
        aPath      = eaPathIntegral;
        nSw        = 0;

        aMensa1 = "Integral";
        aNomDef = "dsam0000";
        aMensa2 = "Fichero -Fich.General Cliente"; |HAZ Mensaje;
        |HAZ CargoReferencia;
        |SI nSwError = 0;
            nDPara1 = 00001;  nHPara1 = 99999;
            nCampo1 = 54; nCampo2 = 55; nCampo3 = -1;
            |BUCLE agiz0025_N;
        |FINSI;
        |HAZ DesCargoReferencia;

        aNomDef = "dsam0001";
        aMensa2 = "Fichero -Datos del Despacho"; |HAZ Mensaje;
        nCampo1 = 6; nCampo2 = 7; nCampo3 = -1;
        |HAZ UnSoloRegistro;

        aNomDef = "dsam0003";
        aMensa2 = "Fichero -Datos Rentas "; |HAZ Mensaje;
        |HAZ CargoReferencia;
        |SI nSwError = 0;
            nDPara1 = 00001;  nHPara1 = 99999;
            nCampo1 = 12; nCampo2 = 13; nCampo3 = 71;
            |BUCLE agiz0025_N;
        |FINSI;
        |HAZ DesCargoReferencia;

        aNomDef = "dsam0050";
        aMensa2 = "Fichero -Historico Clientes"; |HAZ Mensaje;
        |HAZ CargoReferencia;
        |SI nSwError = 0;
            aDPara1 = "            "; aHPara1 = "zzzzzzzzzzzz";
            nCampo1 = 33; nCampo2 = 35; nCampo3 = -1;
            |BUCLE agiz0025_A;
        |FINSI;
        |HAZ DesCargoReferencia;

        aNomDef = "dsam0103";
        aMensa2 = "Fichero -Registro de NIF"; |HAZ Mensaje;
        |HAZ CargoReferencia;
        |SI nSwError = 0;
            aDPara1 = "            "; aHPara1 = "zzzzzzzzzzzz";
            nCampo1 =  8; nCampo2 = 17; nCampo3 = -1;
            |BUCLE agiz0025_A;
        |FINSI;
        |HAZ DesCargoReferencia;

        aNomDef = "dsam0105";
        aMensa2 = "Fichero -Agentes"; |HAZ Mensaje;
        |HAZ CargoReferencia;
        |SI nSwError = 0;
            nDPara1 = 00;    nHPara1 = 99;
            nCampo1 = 12; nCampo2 = -1; nCampo3 = -1;
            |BUCLE agiz0025_N;
        |FINSI;
        |HAZ DesCargoReferencia;

        aNomDef = "dsam0107";
        aMensa2 = "Fichero -Listin Telefonico  L"; |HAZ Mensaje;
        |HAZ CargoReferencia;
        |SI nSwError = 0;
            aDPara1 = " " * 40; aHPara1 = "z" * 40;
            nDPara2 = 00;       nHPara2 = 99;
            nCampo1 =  4; nCampo2 = -1; nCampo3 = -1;
            |BUCLE agiz0025_AN;
        |FINSI;
        |HAZ DesCargoReferencia;
    |FINSI;
|FPRC;
||**********************************************************************

|PROCESO Canempre;

     |PINTA 2051, #901#2;
     |SI #901#26 ] 80;
         nAny = 1900 + #901#26;
     |SINO;
         nAny = 2000 + #901#26;
     |FINSI;

     |SI nAny < #0#5; |O nAny > #0#6; |ACABA; |FINSI;

     eaAlfa = #901#9;  |HAZ QuitaRarosTfno; #901#9  = eaAlfa;  || Telefono
     eaAlfa = #901#10; |HAZ QuitaRarosTfno; #901#10 = eaAlfa;  || Fax

     |GRABA 020#901a;
     |LIBERA #901;

     aAlfa1 = #901#2; aAlfa1 = ("00000" + aAlfa1) % -105;
     aAlfa2 = #901#3; aAlfa2 = ("0"     + aAlfa2) % -101;
     aEmpresa = aAlfa1 + aAlfa2;

 ||..... Ficheros de contagen

     aNomDef = "caclipro";
     aMensa2  = "Fichero -Cli./Prov. General "; |HAZ Mensaje;
     |HAZ CargoReferencia;
     |SI nSwError = 0;
         |PATH_DAT #900 aPathFicE;
         aDPara1 = " ";           aHPara1 = "z";
         aDPara2 = "           "; aHPara2 = "999999999999";
         nCampo1 = 7; nCampo2 = 8; nCampo3 = -1;
         |BUCLE agiz0025_AA;
     |FINSI;
     |HAZ DesCargoReferencia;

     aNomDef = "caconexc";
     aMensa2 = "Fichero -Carta Partidas Pdtes "; |HAZ Mensaje;
     nCampo1 = 30; nCampo2 = 31; nCampo3 = -1;
     |HAZ UnSoloRegistro;

     aNomDef = "carepres";
     aMensa2  = "Fichero -Representantes"; |HAZ Mensaje;
     |HAZ CargoReferencia;
     |SI nSwError = 0;
         |PATH_DAT #900 aPathFicE;
         aDPara1 = "  "; aHPara1 = "zz";
         nCampo1 = 8; nCampo2 = 9; nCampo3 = 11;
         |BUCLE agiz0025_A;
     |FINSI;
     |HAZ DesCargoReferencia;

     aNomDef = "caportad";
     aMensa2  = "Fichero -Datos Empresa"; |HAZ Mensaje;
     |HAZ CargoReferencia;
     |SI nSwError = 0;
         aPathFic = aPathFic + "000000/";
         |PATH_DAT #900 aPathFic;
         |ABRE #900;
         #900#0 = #901#2;
         #900#1 = #901#26;
         |LEE 141#900=;
         |SI FSalida = 0;
             nCampo1 = 14; nCampo2 = 46; nCampo3 = 91;
             |HAZ agiz0025Cambio;
         |FINSI;
         |LIBERA #900;
         |CIERRA #900;
     |FINSI;
     |HAZ DesCargoReferencia;
|FPRC;

|DEFBUCLE Canempre;
    #901#1002;
    26;
    nDPara11, nDPara12, nDAny;
    nHPara11, nHPara12, nHAny;
    be;
    NULL, Canempre;
|FIN;

|PROCESO Contabilidad;

    |SI eaPathContagen ! "";
        nSwEmpresa = 1;  ||Con empresa;
        aPath      = eaPathContagen;
        nSw        = 0;
        aAlfa1 = #0#5; aAlfa1 = aAlfa1 % -102; nDAny = aAlfa1;
        aAlfa1 = #0#6; aAlfa1 = aAlfa1 % -102; nHAny = aAlfa1;
        |SI nDAny > nHAny; nDAny = 00; nHAny = 99; |FINSI;

        aMensa1  = "Contabilidad";
        aNomDefE = "canempre";
        aMensa2  = "Fichero -Empresas Contables "; |HAZ Mensaje;
        |HAZ CargoReferencia_E;
        |SI nSwError = 0;
            nDPara11 = 00001;  nHPara11 = 99999;
            nDPara12 = 0;      nHPara12 = 9;
            |BUCLE Canempre;
        |FINSI;
        |HAZ DesCargoReferencia_E;
    |FINSI;
|FPRC;

||**********************************************************************
|PROCESO Modelos;
    || ...  Ficheros de Modelos
    |SI eaPathDsmodelo ! "";

        nSwEmpresa = 0;  ||Sin empresa;
        aPath      = eaPathDsmodelo;
        nSw        = 0;

        aMensa1 = "Modelos";
        aNomDef = "dsm18401";
        aMensa2 = "Fichero -General Mod.184 "; |HAZ Mensaje;
        |HAZ CargoReferencia;
        |SI nSwError = 0;
            |PATH_DAT #900 aPathFic;
            nDPara1 = 00001; nHPara1 = 99999;
            nDPara2 = #0#7;  nHPara2 = #0#8;
            nDPara3 = 184;   nHPara3 = 184;
            nDPara4 = 00;    nHPara4 = 99;
            nCampo1 = 16; nCampo2 = -1; nCampo3 = -1;
            |BUCLE agiz0025_NNNN;
        |FINSI;
        |HAZ DesCargoReferencia;

        aNomDef = "dsm60001";
        aMensa2 = "Fichero -Trans.Patrim.2005"; |HAZ Mensaje;
        |HAZ CargoReferencia;
        |SI nSwError = 0;
            |PATH_DAT #900 aPathFic;
            nDPara1 = 00001; nHPara1 = 99999;
            nDPara2 = 00;    nHPara2 = 99;
            nCampo1 = 17; nCampo2 = 39; nCampo3 = 76;
            |BUCLE agiz0025_NN;
        |FINSI;
        |HAZ DesCargoReferencia;

        aNomDef = "dsm60002";
        aMensa2 = "Fichero -Relacion S.P./Trans."; |HAZ Mensaje;
        |HAZ CargoReferencia;
        |SI nSwError = 0;
            |PATH_DAT #900 aPathFic;
            nDPara1 = 00001;          nHPara1 = 99999;
            nDPara2 = 00;             nHPara2 = 99;
            aDPara3 = "            "; aHPara3 = "zzzzzzzzzzzz";
            aDPara4 = " ";            aHPara4 = "z";
            nCampo1 = 15; nCampo2 = 16; nCampo3 = -1;
            |BUCLE agiz0025_NNAA;
        |FINSI;
        |HAZ DesCargoReferencia;

    |FINSI;

    |SI eaPathContasoc ! "";

        nSwEmpresa = 0;  ||Sin empresa;
        aPath      = eaPathContasoc;
        nSw        = 0;

        aMensa1 = "Sociedades";
        aNomDef = "maempr01";
        aMensa2 = "Fichero -Datos Empresas"; |HAZ Mensaje;
        |HAZ CargoReferencia;
        |SI nSwError = 0;
            |PATH_DAT #900 aPathFic;
            nDPara1 = 00001; nHPara1 = 99999;
            nDPara2 = #0#7;  nHPara2 = #0#8;
            nCampo1 = 15; nCampo2 = -1; nCampo3 = -1;
            |BUCLE agiz0025_NN;
        |FINSI;
        |HAZ DesCargoReferencia;

        aNomDef = "mey00003";
        aMensa2 = "Fichero -Carta Dist.Resultado."; |HAZ Mensaje;
        |HAZ CargoReferencia;
        |SI nSwError = 0;
            |PATH_DAT #900 aPathFic;
            nDPara1 = 00001; nHPara1 = 99999;
            nCampo1 = 8; nCampo2 = -1; nCampo3 = -1;
            |BUCLE agiz0025_N;
        |FINSI;
        |HAZ DesCargoReferencia;

        aNomDef = "zregpres";
        aMensa2 = "Fichero -Datos Presentante"; |HAZ Mensaje;
        |HAZ CargoReferencia;
        |SI nSwError = 0;
            |PATH_DAT #900 aPathFic;
            nDPara1 = #0#7; nHPara1 = #0#8;
            nCampo1 = 6; nCampo2 = 7; nCampo3 = -1;
            |BUCLE agiz0025_N;
        |FINSI;
        |HAZ DesCargoReferencia;

    |FINSI;

    |SI nRenta ! 0;
        nSwMen = 1;
        nSwEmpresa = 0;  ||Sin empresa;

        |PARA nAny = #0#7; |SI nAny [ #0#8; |HACIENDO nAny = nAny + 1;
             aPath = "";
            |SI nAny = 2018; aPath = eaPathRen2018; |FINSI;
            |SI nAny = 2017; aPath = eaPathRen2017; |FINSI;
            |SI nAny = 2016; aPath = eaPathRen2016; |FINSI;
            |SI nAny = 2015; aPath = eaPathRen2015; |FINSI;
            |SI nAny = 2014; aPath = eaPathRen2014; |FINSI;
            |SI nAny = 2013; aPath = eaPathRen2013; |FINSI;
            |SI nAny = 2012; aPath = eaPathRen2012; |FINSI;
            |SI nAny = 2011; aPath = eaPathRen2011; |FINSI;
            |SI nAny = 2010; aPath = eaPathRen2010; |FINSI;
            |SI nAny = 2009; aPath = eaPathRen2009; |FINSI;
            |SI nAny = 2008; aPath = eaPathRen2008; |FINSI;
            |SI nAny = 2007; aPath = eaPathRen2007; |FINSI;
            |SI nAny = 2006; aPath = eaPathRen2006; |FINSI;
            |SI nAny = 2005; aPath = eaPathRen2005; |FINSI;
            |SI nAny = 2004; aPath = eaPathRen2004; |FINSI;
            |SI nAny = 2003; aPath = eaPathRen2003; |FINSI;
            |SI nAny = 2002; aPath = eaPathRen2002; |FINSI;
            |SI nAny = 2001; aPath = eaPathRen2001; |FINSI;
            |SI nAny = 2000; aPath = eaPathRen2000; |FINSI;
            |SI nAny = 1999; aPath = eaPathRen1999; |FINSI;
            |SI nAny = 1998; aPath = eaPathRen1998; |FINSI;
            |SI nAny = 1997; aPath = eaPathRen1997; |FINSI;
            |SI nAny = 1996; aPath = eaPathRen1996; |FINSI;
            |SI nAny = 1995; aPath = eaPathRen1995; |FINSI;
            |SI nAny = 1994; aPath = eaPathRen1994; |FINSI;

            |SI aPath ! "";
                nSw        = 0;
                aMensa1 = "Renta " + nAny;

                aNomDef = "rem00003";
                aMensa2 = "Fichero -Modelo 210"; |HAZ Mensaje;
                |HAZ CargoReferencia;
                |SI nSwError = 0;
                    |PATH_DAT #900 aPathFic;
                    nDPara1 = 00001; nHPara1 = 99999;
                    nDPara2 = 00;    nHPara2 = 99;
                    nCampo1 = 24; nCampo2 = 46; nCampo3 = -1;
                   |BUCLE agiz0025_NN;
               |FINSI;
               |HAZ DesCargoReferencia;

               aNomDef = "rem00004";
               aMensa2 = "Fichero -Modelo 212"; |HAZ Mensaje;
               |HAZ CargoReferencia;
               |SI nSwError = 0;
                   |PATH_DAT #900 aPathFic;
                   nDPara1 = 00001; nHPara1 = 99999;
                   nDPara2 = 00;    nHPara2 = 99;
                   nCampo1 = 83; nCampo2 = 91; nCampo3 = -1;
                   |SI nAny < 2003; nCampo2 = -1; |FINSI;
                   |BUCLE agiz0025_NN;
               |FINSI;
               |HAZ DesCargoReferencia;

               aNomDef = "rem00005";
               aMensa2 = "Fichero -Modelo 214"; |HAZ Mensaje;
               |HAZ CargoReferencia;
               |SI nSwError = 0;
                   |PATH_DAT #900 aPathFic;
                   nDPara1 = 00001; nHPara1 = 99999;
                   nDPara2 = 00;    nHPara2 = 99;
                   nCampo1 = 15; nCampo2 = 39; nCampo3 = 53;
                   |BUCLE agiz0025_NN;
               |FINSI;
               |HAZ DesCargoReferencia;

               |SI nAny > 1998;
                   aNomDef = "rem00016";
                   aMensa2 = "Fichero -Adq.y Trans.Mod.211 "; |HAZ Mensaje;
                   |HAZ CargoReferencia;
                   |SI nSwError = 0;
                       |PATH_DAT #900 aPathFic;
                       nDPara1 = 00001; nHPara1 = 99999;
                       nDPara2 = 00;    nHPara2 = 99;
                       aDPara3 = " ";   aHPara3 = "z";
                       nDPara4 = 00;    nHPara4 = 99;
                       nCampo1 = 20; nCampo2 = -1; nCampo3 = -1;
                       |BUCLE agiz0025_NNAN;
                  |FINSI;
                  |HAZ DesCargoReferencia;
               |FINSI;

               aNomDef = "rem00017";
               aMensa2 = "Fichero -Modelo 211"; |HAZ Mensaje;
               |HAZ CargoReferencia;
               |SI nSwError = 0;
                   |PATH_DAT #900 aPathFic;
                   nDPara1 = 00001; nHPara1 = 99999;
                   nDPara2 = 00;    nHPara2 = 99;
                   nCampo1 = 25; nCampo2 = -1; nCampo3 = -1;
                   |BUCLE agiz0025_NN;
               |FINSI;
               |HAZ DesCargoReferencia;

               aNomDef = "rem00100";
               aMensa2 = "Fichero -Datos Contribuyente"; |HAZ Mensaje;
               |HAZ CargoReferencia;
               |SI nSwError = 0;
                   |PATH_DAT #900 aPathFic;
                   nDPara1 = 00001; nHPara1 = 99999;
                   nCampo1 = 12; nCampo2 = 13; nCampo3 = 68;
                   |BUCLE agiz0025_N;
               |FINSI;
               |HAZ DesCargoReferencia;

               aNomDef = "rem03000";
               aMensa2 = "Fichero -Transm.Patrimoniales"; |HAZ Mensaje;
               |HAZ CargoReferencia;
               |SI nSwError = 0;
                   |PATH_DAT #900 aPathFic;
                   nDPara1 = 00001; nHPara1 = 99999;
                   nCampo1 = 17; nCampo2 = 39; nCampo3 = -1;
                   |BUCLE agiz0025_N;
               |FINSI;
               |HAZ DesCargoReferencia;

               aNomDef = "rem03004";
               aMensa2 = "Fichero -Trans.Patrim." + nAny; |HAZ Mensaje;
               |HAZ CargoReferencia;
               |SI nSwError = 0;
                   |PATH_DAT #900 aPathFic;
                   nDPara1 = 00001; nHPara1 = 99999;
                   nDPara2 = 00;    nHPara2 = 99;
                   nCampo1 = 17; nCampo2 = 39; nCampo3 = 76;
                   |BUCLE agiz0025_NN;
               |FINSI;
               |HAZ DesCargoReferencia;

               aNomDef = "rem03005";
               aMensa2 = "Fichero -Relacion S.P./Trans."; |HAZ Mensaje;
               |HAZ CargoReferencia;
               |SI nSwError = 0;
                   |PATH_DAT #900 aPathFic;
                   nDPara1 = 00001;          nHPara1 = 99999;
                   nDPara2 = 00;             nHPara2 = 99;
                   aDPara3 = "            "; aHPara3 = "zzzzzzzzzzzz";
                   aDPara4 = " ";            aHPara4 = "z";
                   nCampo1 = 15; nCampo2 = 16; nCampo3 = -1;
                   |BUCLE agiz0025_NNAA;
               |FINSI;
               |HAZ DesCargoReferencia;

               aNomDef = "rerenpre";
               aMensa2 = "Fichero -Representantes"; |HAZ Mensaje;
               |HAZ CargoReferencia;
               |SI nSwError = 0;
                   |PATH_DAT #900 aPathFic;
                   nDPara1 = 00001;          nHPara1 = 99999;
                   nCampo1 = 9; nCampo2 = -1; nCampo3 = -1;
                   |BUCLE agiz0025_N;
               |FINSI;
               |HAZ DesCargoReferencia;

            |FINSI;
        |SIGUE;
        nSwMen = 0;
    |FINSI;
|FPRC;

||**********************************************************************
|PROCESO Laboral;
    |SI eaPathLaboral ! "";

        nSwMen = 0;
        nSwEmpresa = 0;  ||Sin empresa;
        aPath      = eaPathLaboral;
        nSw        = 0;

        aMensa1 = "Laboral";
        aNomDef = "labacuer";
        aMensa2 = "Fichero -ACUERDO FORM.APREND."; |HAZ Mensaje;
        |HAZ CargoReferencia;
        |SI nSwError = 0;
            |PATH_DAT #900 aPathFic;
            nDPara1 = 00001; nHPara1 = 99999;
            nDPara2 = 00001; nHPara2 = 99999;
            nCampo1 = 5; nCampo2 = 25; nCampo3 = 36;
            |BUCLE agiz0025_NN;
        |FINSI;
        |HAZ DesCargoReferencia;

        aNomDef = "labcenfo";
        aMensa2 = "Fichero -MTO. CENTROS FORMAC."; |HAZ Mensaje;
        |HAZ CargoReferencia;
        |SI nSwError = 0;
            |PATH_DAT #900 aPathFic;
            aDPara1 = "       "; aHPara1 = "zzzzzzz";
            nCampo1 = 5; nCampo2 = 25; nCampo3 = 36;
            |BUCLE agiz0025_A;
        |FINSI;
        |HAZ DesCargoReferencia;

        aNomDef = "labcomac";
        aMensa2 = "Fichero -MODALIDAD S.ACREED"; |HAZ Mensaje;
        nCampo1 = 14; nCampo2 = -1; nCampo3 = -1;
        |HAZ UnSoloRegistro;

        aNomDef = "labcomic";
        aMensa2 = "Fichero -Cert.Ingr.Cuot.II"; |HAZ Mensaje;
        nCampo1 = 14; nCampo2 = 15; nCampo3 = -1;

        aNomDef = "labcomne";
        aMensa2 = "Fichero -Certif.Nivel Empleo"; |HAZ Mensaje;
        nCampo1 = 14; nCampo2 = 15; nCampo3 = -1;
        |HAZ UnSoloRegistro;

        aNomDef = "labempre";
        aMensa2 = "Fichero -Empresas"; |HAZ Mensaje;
        |HAZ CargoReferencia;
        |SI nSwError = 0;
            |PATH_DAT #900 aPathFic;
            nDPara1 = 00000; nHPara1 = 99999;
            nCampo1 = 111; nCampo2 = 112; nCampo3 = -1;
            |BUCLE agiz0025_N;
        |FINSI;
        |HAZ DesCargoReferencia;

        nSwMen = 1;
        aNomDef = "laborn01";
        aMensa2 = "Fichero -Altas"; |HAZ Mensaje;
        |HAZ CargoReferencia;
        |SI nSwError = 0;
            |PATH_DAT #900 aPathFic;
            aDPara1 = " ";          aHPara1 = "z";
            aDPara2 = "          "; aHPara2 = "zzzzzzzzzz";
            aDPara3 = "          "; aHPara3 = "zzzzzzzzzz";
            fDPara2 = fFecha1;      fHPara2 = fFecha2;
            aDPara5 = "        ";   aHPara5 = "zzzzzzzz";
            nCampo1 = 221; nCampo2 = 222; nCampo3 = -1;
            |BUCLE agiz0025_AAAFA;
        |FINSI;
        |HAZ DesCargoReferencia;

        aNomDef = "laborn06";
        aMensa2 = "Fichero -Parte Accidente  (R)"; |HAZ Mensaje;
        |HAZ CargoReferencia;
        |SI nSwError = 0;
            |PATH_DAT #900 aPathFic;
            aDPara1 = " ";          aHPara1 = "z";
            aDPara2 = "          "; aHPara2 = "zzzzzzzzzz";
            aDPara3 = "          "; aHPara3 = "zzzzzzzzzz";
            fDPara2 = fFecha1;      fHPara2 = fFecha2;
            aDPara5 = "        ";   aHPara5 = "zzzzzzzz";
            nCampo1 = 8; nCampo2 = -1; nCampo3 = -1;
            |BUCLE agiz0025_AAAFA;
        |FINSI;
        |HAZ DesCargoReferencia;

        nSwMen = 0;
        aNomDef = "labparan";
        aMensa2 = "Fichero -PARTES ACCID.TRABAJ."; |HAZ Mensaje;
        nCampo1 = 68; nCampo2 = -1; nCampo3 = -1;
        |HAZ UnSoloRegistro;

        || .. no laparhi

        aNomDef = "labrecon";
        aMensa2 = "Fichero -RELACION CONTR.INEM "; |HAZ Mensaje;
        nCampo1 = 11; nCampo2 = -1; nCampo3 = -1;
        |HAZ UnSoloRegistro;

        aNomDef = "labtraba";
        aMensa2 = "Fichero -Trabajadores"; |HAZ Mensaje;
        |HAZ CargoReferencia;
        |SI nSwError = 0;
            |PATH_DAT #900 aPathFic;
            nDPara1 = 00000; nHPara1 = 99999;
            nDPara2 = 00000; nHPara2 = 99999;
            nCampo1 = 244; nCampo2 = -1; nCampo3 = -1;
            |BUCLE agiz0025_NN;
        |FINSI;
        |HAZ DesCargoReferencia;

        aNomDef = "nominfre";
        aMensa2 = "Fichero -INFORME RECIBOS EMIT"; |HAZ Mensaje;
        nCampo1 = 6; nCampo2 = 7; nCampo3 = -1;
        |HAZ UnSoloRegistro;

        aNomDef = "silcon13";
        aMensa2 = "Fichero -MOVIMIENTOS AFI"; |HAZ Mensaje;
        |HAZ CargoReferencia;
        |SI nSwError = 0;
            |PATH_DAT #900 aPathFic;
            nDPara1 = 00000; nHPara1 = 99999;
            nCampo1 = 19; nCampo2 = -1; nCampo3 = -1;
            |BUCLE agiz0025_N;
        |FINSI;
        |HAZ DesCargoReferencia;

    |FINSI;
|FPRC;

||**********************************************************************
|PROCESO Facempr;

     |PINTA 2051, #901#0;

     aAlfa1 = #901#0; aAlfa1 = ("00" + aAlfa1) % -102;
     aEmpresa = aAlfa1;

 ||..... Ficheros de facturar

     nSwMen = 1;
     aNomDef = "abom0001";
     aMensa2  = "Fichero -Expedientes"; |HAZ Mensaje;
     |HAZ CargoReferencia;
     |SI nSwError = 0;
         |PATH_DAT #900 aPathFicE;
         nDPara1 = 0; nHPara1 = 99999999;
         nCampo1 = 58; nCampo2 = 59; nCampo3 = -1;
         |BUCLE agiz0025_N;
     |FINSI;
     |HAZ DesCargoReferencia;

     aNomDef = "abom0501";
     aMensa2  = "Fichero -Organismos Oficiales"; |HAZ Mensaje;
     |HAZ CargoReferencia;
     |SI nSwError = 0;
         |PATH_DAT #900 aPathFicE;
         nDPara1 = 1; nHPara1 = 9999999999;
         nCampo1 = 7; nCampo2 = 8; nCampo3 = -1;
         |BUCLE agiz0025_N;
     |FINSI;
     |HAZ DesCargoReferencia;

     aNomDef = "abom0502";
     aMensa2  = "Fichero -Abogados"; |HAZ Mensaje;
     |HAZ CargoReferencia;
     |SI nSwError = 0;
         |PATH_DAT #900 aPathFicE;
         nDPara1 = 1; nHPara1 = 999999;
         nCampo1 = 10; nCampo2 = 11; nCampo3 = 12;
         |BUCLE agiz0025_N;
     |FINSI;
     |HAZ DesCargoReferencia;

     aNomDef = "abom0503";
     aMensa2  = "Fichero -Procuradores "; |HAZ Mensaje;
     |HAZ CargoReferencia;
     |SI nSwError = 0;
         |PATH_DAT #900 aPathFicE;
         nDPara1 = 1; nHPara1 = 999999;
         nCampo1 = 10; nCampo2 = 11; nCampo3 = 12;
         |BUCLE agiz0025_N;
     |FINSI;
     |HAZ DesCargoReferencia;

     aNomDef = "abom0504";
     aMensa2  = "Fichero -Contrarios "; |HAZ Mensaje;
     |HAZ CargoReferencia;
     |SI nSwError = 0;
         |PATH_DAT #900 aPathFicE;
         nDPara1 = 1; nHPara1 = 999999;
         nCampo1 = 10; nCampo2 = 11; nCampo3 = 12;
         |BUCLE agiz0025_N;
     |FINSI;
     |HAZ DesCargoReferencia;

     aNomDef = "abom0505";
     aMensa2  = "Fichero -Personal Despacho"; |HAZ Mensaje;
     |HAZ CargoReferencia;
     |SI nSwError = 0;
         |PATH_DAT #900 aPathFicE;
         nDPara1 = 1; nHPara1 = 99;
         nCampo1 = 10; nCampo2 = 11; nCampo3 = 12;
         |BUCLE agiz0025_N;
     |FINSI;
     |HAZ DesCargoReferencia;

     aNomDef = "abom0515";
     aMensa2  = "Fichero -Libreta Direcciones"; |HAZ Mensaje;
     |HAZ CargoReferencia;
     |SI nSwError = 0;
         |PATH_DAT #900 aPathFicE;
         nDPara1 = 00000; nHPara1 = 99999;
         nCampo1 = 11; nCampo2 = 13; nCampo3 = 15;
         |BUCLE agiz0025_N;
     |FINSI;
     |HAZ DesCargoReferencia;

     aNomDef = "abom0516";
     aMensa2  = "Fichero -Corredurias"; |HAZ Mensaje;
     |HAZ CargoReferencia;
     |SI nSwError = 0;
         |PATH_DAT #900 aPathFicE;
         nDPara1 = 1; nHPara1 = 999;
         nCampo1 = 7; nCampo2 = 8; nCampo3 = -1;
         |BUCLE agiz0025_N;
     |FINSI;
     |HAZ DesCargoReferencia;

     aNomDef = "abom0517";
     aMensa2  = "Fichero -Agentes Seguros"; |HAZ Mensaje;
     |HAZ CargoReferencia;
     |SI nSwError = 0;
         |PATH_DAT #900 aPathFicE;
         nDPara1 = 1;  nHPara1 = 99999;
         nCampo1 = 10; nCampo2 = 11; nCampo3 = 12;
         |BUCLE agiz0025_N;
     |FINSI;
     |HAZ DesCargoReferencia;

     nSwMen = 0;
     aNomDef = "asclient";
     aMensa2  = "Fichero -Clientes"; |HAZ Mensaje;
     |HAZ CargoReferencia;
     |SI nSwError = 0;
         |PATH_DAT #900 aPathFicE;
         nDPara1 = 00001;  nHPara1 = 99999;
         nCampo1 = 9; nCampo2 = 10; nCampo3 = 56;
         |BUCLE agiz0025_N;
     |FINSI;
     |HAZ DesCargoReferencia;

      nSwMen = 1;
      aNomDef = "cmsocios";
      aMensa2  = "Fichero -Maestro Socios"; |HAZ Mensaje;
      |HAZ CargoReferencia;
      |SI nSwError = 0;
          |PATH_DAT #900 aPathFicE;
          nDPara1 = 00001;  nHPara1 = 99999;
          nCampo1 = 10; nCampo2 = -1; nCampo3 = -1;
          |BUCLE agiz0025_N;
      |FINSI;
      |HAZ DesCargoReferencia;

      aNomDef = "excontra";
      aMensa2  = "Fichero -Contrarios"; |HAZ Mensaje;
      |HAZ CargoReferencia;
      |SI nSwError = 0;
          |PATH_DAT #900 aPathFicE;
          nDPara1 = 00001;  nHPara1 = 99999;
          nCampo1 = 7; nCampo2 = 8; nCampo3 = -1;
          |BUCLE agiz0025_N;
      |FINSI;
      |HAZ DesCargoReferencia;

      aNomDef = "exletrad";
      aMensa2  = "Fichero -Letrados"; |HAZ Mensaje;
      |HAZ CargoReferencia;
      |SI nSwError = 0;
          |PATH_DAT #900 aPathFicE;
          nDPara1 = 00001;  nHPara1 = 99999;
          nCampo1 = 7; nCampo2 = 8; nCampo3 = -1;
          |BUCLE agiz0025_N;
      |FINSI;
      |HAZ DesCargoReferencia;

      aNomDef = "exprocur";
      aMensa2  = "Fichero -Procuradores"; |HAZ Mensaje;
      |HAZ CargoReferencia;
      |SI nSwError = 0;
          |PATH_DAT #900 aPathFicE;
          nDPara1 = 00001;  nHPara1 = 99999;
          nCampo1 = 7; nCampo2 = 8; nCampo3 = -1;
          |BUCLE agiz0025_N;
      |FINSI;
      |HAZ DesCargoReferencia;

      aNomDef = "visam004";
      aMensa2  = "Fichero -Delegaciones Cliente"; |HAZ Mensaje;
      |HAZ CargoReferencia;
      |SI nSwError = 0;
          |PATH_DAT #900 aPathFicE;
          nDPara1 = 00001;  nHPara1 = 99999;
          nDPara2 = 0001;   nHPara2 = 9999;
          nCampo1 = 7; nCampo2 = 8; nCampo3 = 10;
          |BUCLE agiz0025_NN;
      |FINSI;
      |HAZ DesCargoReferencia;

      aNomDef = "facge280";
      aMensa2  = "Fichero -Datos Facturae"; |HAZ Mensaje;
      |HAZ CargoReferencia;
      |SI nSwError = 0;
         |PATH_DAT #900 aPathFic;
         |ABRE #900;
         #900#0 = #901#0;
         |LEE 141#900=;
         |SI FSalida = 0;
             nCampo1 = 8; nCampo2 = 9; nCampo3 = -1;
             |HAZ agiz0025Cambio;
         |FINSI;
         |LIBERA #900;
         |CIERRA #900;
     |FINSI;
     |HAZ DesCargoReferencia;

      nSwMen = 0;
|FPRC;

|DEFBUCLE Facempr;
    #901#1001;
    ;
    nDPara11;
    nHPara11;
    be;
    NULL, Facempr;
|FIN;

|PROCESO Facturacion;

    |SI eaPathFacturar ! "";
        nSwEmpresa = 1;  ||Con empresa;
        aPath      = eaPathFacturar;
        nSw        = 0;

        aMensa1  = "Facturacion";
        aNomDefE = "facemp";
        aMensa2  = "Fichero -Empresas Facturacion"; |HAZ Mensaje;
        |HAZ CargoReferencia_E;
        |SI nSwError = 0;
            nDPara11 = #0#9; nHPara11 = #0#10;
            |BUCLE Facempr;
        |FINSI;
        |HAZ DesCargoReferencia_E;
    |FINSI;
|FPRC;


|PROCESO Tipo3;  |TIPO 3;

     fFecha1 = "01.01.0000";
     fFecha2 = "31.12.2999";
     |SI #0#2 = "S"; nNume1 = #0#7; nNume2 = #0#8;|FINSI;
     |SI #0#1 = "S"; nNume1 = #0#5; nNume2 = #0#6; |FINSI;
     |SI #0#1 = "S"; |O #0#2 = "S";
         aAlfa = nNume1; aAlfa = "01.01." + aAlfa; fFecha1 = aAlfa;
         aAlfa = nNume2; aAlfa = "31.12." + aAlfa; fFecha2 = aAlfa;
     |FINSI;

     |SI #0#11 = "SI";

         |SI #0#0 = "S";
             |HAZ ModuloIntegrador;
         |FINSI;

         |SI #0#1 = "S";
             |HAZ Contabilidad;
         |FINSI;

         |SI #0#2 = "S";
             |HAZ Modelos;
         |FINSI;

         |SI #0#3 = "S";
             |HAZ Laboral;
         |FINSI;

         |SI #0#4 = "S";
             |HAZ Facturacion;
         |FINSI;

     |FINSI;
|FPRC;


|PROGRAMA;
  |HAZ BusquedaApli;

  nRenta = 0;
  |SI eaPathRen2018 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen2017 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen2016 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen2015 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen2014 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen2013 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen2012 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen2011 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen2010 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen2009 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen2008 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen2007 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen2006 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen2005 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen2004 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen2003 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen2002 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen2001 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen2000 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen1999 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen1998 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen1997 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen1996 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen1995 ! ""; nRenta = 1; |FINSI;
  |SI eaPathRen1994 ! ""; nRenta = 1; |FINSI;

  |CLS;
  |CABEZA "Limpiar Telefonos";

  |DDEFECTO #0;
  |PINPA #0#0;

  |SI eaPathContagen = "";
      |C_M #0#1, 1, "N"; #0#1 = "N";
  |FINSI;
  |SI eaPathContasoc = ""; |Y nRenta = 0; |Y eaPathDsmodelo = "";
      |C_M #0#2, 1, "N"; #0#2 = "N";
  |FINSI;
  |SI eaPathLaboral  = "";
      |C_M #0#3, 1, "N"; #0#3 = "N";
  |FINSI;
  |SI eaPathFacturar = "";
      |C_M #0#4, 1, "N"; #0#4 = "N";
  |FINSI;
  |PINDA #0#0;

  |ENDATOS #1#0;
|FPRO;
