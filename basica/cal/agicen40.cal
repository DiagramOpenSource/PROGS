|FICHEROS;
     agifigen #1;
     agicen40 #40;
     agicen42 #42,MANTE;
     agicen43 #43,MANTE;
     agicen44 #44,MANTE;
     agicen45 #45,MANTE;
     agicen46 #46,MANTE;
     agicen49 #49,MANTE;
     agicen50 #50,MANTE;
     agicen51 #51,MANTE;
     agicen52 #52,MANTE;
     agicen53 #53,MANTE;
     agicen54 #54,MANTE;

     :/integral/def/dsam0115 #115;
|FIN;

|VARIABLES;
     &aAlfa        = "";
     aTipo1       = "";
     aTipo2       = "";

     nForma       = 0;
     nModo        = 0;
     nEmpresa     = 0;
     nRegistro    = 0;

     &enEmpresa   = 0;
     &enModo      = 0;
     &eaNombreEmp = "";
     &enRegistro  = 0;
     &eaTipo      = "";
     &enOpcion    = 0;

 {-1} aMenu    = "";
      aMenu1   = "1200";
      aMenu2   = "1";
      aMenu3   = "10";
      aMenu4   = "Causas de presentación                                    (Pág. 1)";
      aMenu5   = "Identificación                                  (Pág. 2A, 2B y 2C)";
      aMenu6   = "Representantes                                            (Pág. 3)";
      aMenu7   = "Declaración de actividades económicas y locales           (Pág. 4)";
      aMenu8   = "Sujeto pasivo Gran Empresa y Adm. Púb. Impto. Valor A¤ad .(Pág. 5)";
      aMenu9   = "IRPF, Impto. Sociedades y No Residentes. Rég. Fiscal Esp .(Pág. 6)";
      aMenu10  = "Retenciones, ingresos a cuenta. Otros Impuestos.          (Pág. 7)";
      aMenu11  = "Regímenes especiales comercio intracomunitario            (Pág. 7)";
      aMenu12  = "Relación de socios, miembros o partícipes y sucesores (Pág. 8 y 9)";
      aMenu13  = "Emisión del Modelo en PDF o Fichero para Internet.                ";

 {-1} aSubMenu    = "";
      aSubMenu1   = "1900";
      aSubMenu2   = "1";
      aSubMenu3   = "2";
      aSubMenu4   = "Relación de socios, miembros o partícipes (Pág. 8)";
      aSubMenu5   = "Relación de sucesores                     (Pág. 9)";

     fFecha   = @;
     FEstado  = 0;
     aAlfa1   = "";
     aAlfa2   = "";
     &aNom    = "";
     &aApel1  = "";
     &aApel2  = "";
     aLong    = "";
     nLong    = 0;
     nInd     = 0;
     nPos     = 0;
     nCalc    = 0;
     SwSalir  = 0;
     aMensaje = "";
     aParam   = "";
     nSubOpcion = 0;

     &eaUnidadBasico = "";
     &eaPathIntegral = "";
     &eaSigla5       = "";
|FIN;

|PROCESO Tipo12; |TIPO 12;
|FPRC;

|PROCESO SeparaNombre;
   aNom = ""; aApel1 = ""; aApel2 = "";
   nInd = 1;
   aLong = aAlfa % 0; nLong = aLong;
   aAlfa1 = "";
   |PARA nCalc = 1; |SI nCalc [ nLong; |HACIENDO nCalc = nCalc + 1;
      nPos = (nCalc * 100) + 1;
      aAlfa2 = aAlfa % nPos;
      |SI aAlfa2 = " "; |O aAlfa2 = ",";
         |SI aAlfa1 ! "DE";  |Y aAlfa1 ! "de";
          |Y aAlfa1 ! "LA";  |Y aAlfa1 ! "la";
          |Y aAlfa1 ! "LAS"; |Y aAlfa1 ! "las";
          |Y aAlfa1 ! "LOS"; |Y aAlfa1 ! "los";
          |Y aAlfa1 ! "DEL"; |Y aAlfa1 ! "del";
            |SI nInd = 1; |Y aAlfa1 ! ""; aApel1 = aApel1 + aAlfa1 + " "; |FINSI;
            |SI nInd = 2; |Y aAlfa1 ! ""; aApel2 = aApel2 + aAlfa1 + " "; |FINSI;
            |SI nInd ] 3; |Y aAlfa1 ! ""; aNom   = aNom   + aAlfa1 + " "; |FINSI;
             nInd = nInd + 1;
         |SINO;
            |SI nInd > 1; nInd = nInd - 1; |FINSI;
            |SI nInd = 1; |Y aAlfa1 ! ""; aApel1 = aApel1 + aAlfa1 + " "; |FINSI;
            |SI nInd = 2; |Y aAlfa1 ! ""; aApel2 = aApel2 + aAlfa1 + " "; |FINSI;
            |SI nInd ] 3; |Y aAlfa1 ! ""; aNom   = aNom   + aAlfa1 + " "; |FINSI;
         |FINSI;
         aAlfa1 = "";
      |SINO;
         aAlfa1 = aAlfa1 + aAlfa2;
      |FINSI;
   |SIGUE;

   |PARA; |SI SwSalir = 0; |HACIENDO;
      SwSalir = 1;
      aAlfa1 = aApel1 % 0101;
      |SI aAlfa1 = " "; aApel1 = aApel1 % 0299; SwSalir = 0; |FINSI;
      aAlfa1 = aApel2 % 0101;
      |SI aAlfa1 = " "; aApel2 = aApel2 % 0299; SwSalir = 0; |FINSI;
      aAlfa1 = aNom   % 0101;
      |SI aAlfa1 = " "; aNom   = aNom   % 0299; SwSalir = 0; |FINSI;
   |SIGUE;
|FPRC;

|PROCESO Superior54;
     #54#0 = enEmpresa;
     #54#1 = enRegistro;
     #54#2 = 99;
|FPRC;

|PROCESO Inferior54;
     #54#0 = enEmpresa;
     #54#1 = enRegistro;
     #54#2 = 01;
|FPRC;

|PROCESO Sucesores;
     |ENTLINEAL #1#54, -3, 2, 22, 1, Inferior54, Superior54;
|FPRC;

|PROCESO Superior53;
     #53#0 = enEmpresa;
     #53#1 = enRegistro;
     #53#2 = 99;
|FPRC;

|PROCESO Inferior53;
     #53#0 = enEmpresa;
     #53#1 = enRegistro;
     #53#2 = 01;
|FPRC;

|PROCESO Socios;
     |ENTLINEAL #1#53, -3, 2, 22, 1, Inferior53, Superior53;
|FPRC;

|PROCESO MenuSocios;
  nSubOpcion = 0;
  |PUSHV 0501 2380;
  |PARA;  |SI;  |HACIENDO;
          |MENUG aSubMenu;
          nSubOpcion = FSalida;
          |SI nSubOpcion = 1; |O nSubOpcion = 2;

              enOpcion = 9;
              |HAZ Chequeos;
              |SI aMensaje ! "";
                  |MENAV aMensaje;
                  nSubOpcion = 0;  || no entres
              |FINSI;

              |PUSHV 0501 2380;
              |SI nSubOpcion = 1; |HAZ Socios;     |FINSI;
              |SI nSubOpcion = 2; |HAZ Sucesores;  |FINSI;
              |POPV;
          |SINO;
              |SAL;
          |FINSI;
  |SIGUE;
  |POPV;
|FPRC;

|PROCESO Intracomunitario;
     |ABRE #52;
     #52#0 = enEmpresa;
     #52#1 = enRegistro;
     |LEE 040#52=;
     FEstado = FSalida;
     |SI FSalida ! 0;
          |DDEFECTO #52;
     |FINSI;

     #52#0 = enEmpresa;
     #52#1 = enRegistro;
     |PINPA #0#52;
     |PINDA #0#52;
     |ENDATOS #1#52;

     |SI FEstado = 0;
          |GRABA 020#agicen52.a;
     |SINO;
          |GRABA 020#agicen52.n;
     |FINSI;

     |CIERRA #52;
|FPRC;

|PROCESO Retenciones;
     |ABRE #51;
     #51#0 = enEmpresa;
     #51#1 = enRegistro;
     |LEE 040#51=;
     FEstado = FSalida;
     |SI FSalida ! 0;
          |DDEFECTO #51;
     |FINSI;

     #51#0 = enEmpresa;
     #51#1 = enRegistro;
     |PINPA #0#51;
     |PINDA #0#51;
     |ENDATOS #1#51;

     |SI FEstado = 0;
          |GRABA 020#agicen51.a;
     |SINO;
          |GRABA 020#agicen51.n;
     |FINSI;

     |CIERRA #51;
|FPRC;

|PROCESO IRPF;
     |ABRE #50;
     #50#0 = enEmpresa;
     #50#1 = enRegistro;
     |LEE 040#50=;
     FEstado = FSalida;
     |SI FSalida ! 0;
          |DDEFECTO #50;
     |FINSI;

     #50#0 = enEmpresa;
     #50#1 = enRegistro;
     |PINPA #0#50;
     |PINDA #0#50;
     |ENDATOS #1#50;

     |SI FEstado = 0;
          |GRABA 020#agicen50.a;
     |SINO;
          |GRABA 020#agicen50.n;
     |FINSI;

     |CIERRA #50;
|FPRC;

|PROCESO GEMP_IVA;
     |ABRE #49;
     #49#0 = enEmpresa;
     #49#1 = enRegistro;
     |LEE 040#49=;
     FEstado = FSalida;
     |SI FSalida ! 0;
          |DDEFECTO #49;
     |FINSI;

     #49#0 = enEmpresa;
     #49#1 = enRegistro;
     |PINPA #0#49;
     |PINDA #0#49;
     |ENDATOS #1#49;

     |SI FEstado = 0;
          |GRABA 020#agicen49.a;
     |SINO;
          |GRABA 020#agicen49.n;
     |FINSI;

     |CIERRA #49;
|FPRC;

|PROCESO Superior46;
     #46#0 = enEmpresa;
     #46#1 = enRegistro;
     #46#2 = 99;
|FPRC;

|PROCESO Inferior46;
     #46#0 = enEmpresa;
     #46#1 = enRegistro;
     #46#2 = 01;
|FPRC;

|PROCESO Representantes;
     |ENTLINEAL #1#46, -3, 2, 22, 1, Inferior46, Superior46;
|FPRC;

|PROCESO DatosPersonales
     |SI eaTipo = "A";
          |ABRE #43;
          #43#0 = enEmpresa;
          #43#1 = enRegistro;
          |LEE 040#43=;
          FEstado = FSalida;
          |SI FSalida ! 0;
               |DDEFECTO #43;
          |FINSI;

          |ABRE #1;
          #1#0 = #43#0;
          |LEE 040#1=;
          |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
          |CIERRA #1;

          aAlfa = #43#5;
          |QBF aAlfa;
          |SI aAlfa = "";
               #43#5 = #1#13;      || nif

               aAlfa = #1#2;
               |HAZ SeparaNombre;
               #43#6 = aApel1;
               #43#7 = aApel2;
               #43#8 = aNom;

               #43#9 = #1#1;       || nombre comercial
               eaSigla5 = #1#3; |HAZ Lee5DigSg;
               #43#12 = eaSigla5;  || tipo via
               #43#13 = #1#4;      || nombre via
               #43#15 = #1#5;      || numero
               #43#19 = #1#6;      || escalera
               #43#20 = #1#7;      || planta
               #43#21 = #1#8;      || puerta
               aAlfa1 = #1#9; |QBF aAlfa1; aAlfa1 = ("00" + aAlfa1) % -102;
               #43#26 = aAlfa1;    || codigo provincia
               aAlfa2 = #1#10; |QBF aAlfa2; aAlfa2 = ("000" + aAlfa2) % -103;
               aAlfa = aAlfa1 + aAlfa2;
               #43#24 = aAlfa;
               #43#25 = #1#11;     || nombre municipio
               #43#11 = #1#12;     || nombre provincia
               #43#27 = #1#14;     || fijo
               #43#29 = #1#15;     || fax
          |FINSI;

          #43#0 = enEmpresa;
          #43#1 = enRegistro;
          |PINPA #0#43;
          |PINDA #0#43;
          |ENDATOS #1#43;

          |SI FEstado = 0;
               |GRABA 020#agicen43.a;
          |SINO;
               |GRABA 020#agicen43.n;
          |FINSI;

          |CIERRA #43;
     |FINSI;
     |SI eaTipo = "B";
          |ABRE #44;
          #44#0 = enEmpresa;
          #44#1 = enRegistro;
          |LEE 040#44=;
          FEstado = FSalida;
          |SI FSalida ! 0;
               |DDEFECTO #44;
          |FINSI;

          |ABRE #1;
          #1#0 = #44#0;
          |LEE 040#1=;
          |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
          |CIERRA #1;

          aAlfa = #44#5;
          |QBF aAlfa;
          |SI aAlfa ! "";
               #44#5 = #1#13;      || nif
               || #44#8 = #1#2;       || nombre
               #44#6 = #1#1;       || razon social
               eaSigla5 = #1#3; |HAZ Lee5DigSg;
               #44#12 = eaSigla5;  || tipo via
               #44#13 = #1#4;      || nombre via
               #44#15 = #1#5;      || numero
               #44#19 = #1#6;      || escalera
               #44#20 = #1#7;      || planta
               #44#21 = #1#8;      || puerta
               aAlfa1 = #1#9; |QBF aAlfa1; aAlfa1 = ("00" + aAlfa1) % -102;
               #44#26 = aAlfa1;    || codigo provincia
               aAlfa2 = #1#10; |QBF aAlfa2; aAlfa2 = ("000" + aAlfa2) % -103;
               aAlfa = aAlfa1 + aAlfa2;
               #44#24 = aAlfa;
               #44#25 = #1#11;     || nombre municipio
               #44#107 = #1#12;     || nombre provincia
               #44#27 = #1#14;     || fijo
               #44#29 = #1#15;     || fax
          |FINSI;

          #44#0 = enEmpresa;
          #44#1 = enRegistro;
          |PINPA #0#44;
          |PINDA #0#44;
          |ENDATOS #1#44;

          |SI FEstado = 0;
               |GRABA 020#agicen44.a;
          |SINO;
               |GRABA 020#agicen44.n;
          |FINSI;

          |CIERRA #44;
     |FINSI;
     |SI eaTipo = "C";
          |ABRE #45;
          #45#0 = enEmpresa;
          #45#1 = enRegistro;
          |LEE 040#45=;
          FEstado = FSalida;
          |SI FSalida ! 0;
               |DDEFECTO #45;
          |FINSI;

          |ABRE #1;
          #1#0 = #45#0;
          |LEE 040#1=;
          |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
          |CIERRA #1;

          aAlfa = #45#2;
          |QBF aAlfa;
          |SI aAlfa ! "";
               #45#2 = #1#13;      || nif
               || #44#8 = #1#2;       || nombre
               #45#3 = #1#1;       || razon social
               eaSigla5 = #1#3; |HAZ Lee5DigSg;
               #45#12 = eaSigla5;  || tipo via
               #45#13 = #1#4;      || nombre via
               #45#15 = #1#5;      || numero
               #45#19 = #1#6;      || escalera
               #45#20 = #1#7;      || planta
               #45#21 = #1#8;      || puerta
               aAlfa1 = #1#9; |QBF aAlfa1; aAlfa1 = ("00" + aAlfa1) % -102;
               #45#26 = aAlfa1;    || codigo provincia
               aAlfa2 = #1#10; |QBF aAlfa2; aAlfa2 = ("000" + aAlfa2) % -103;
               aAlfa = aAlfa1 + aAlfa2;
               #45#24 = aAlfa;
               #45#25 = #1#11;     || nombre municipio
               #45#11 = #1#12;     || nombre provincia
               #45#27 = #1#14;     || fijo
               #45#29 = #1#15;     || fax
          |FINSI;

          #45#0 = enEmpresa;
          #45#1 = enRegistro;
          |PINPA #0#45;
          |PINDA #0#45;
          |ENDATOS #1#45;

          |SI FEstado = 0;
               |GRABA 020#agicen45.a;
          |SINO;
               |GRABA 020#agicen45.n;
          |FINSI;

          |CIERRA #45;
     |FINSI;
|FPRC;

|PROCESO Causas;
     |ABRE #42;
     #42#0 = enEmpresa;
     #42#1 = enRegistro;
     |LEE 040#42=;
     FEstado = FSalida;
     |SI FSalida ! 0;
          |DDEFECTO #42;
     |FINSI;

     #42#0 = enEmpresa;
     #42#1 = enRegistro;
     |PINPA #0#42;
     |PINDA #0#42;
     |ENDATOS #1#42;

     |SI FEstado = 0;
          |GRABA 020#agicen42.a;
     |SINO;
          |GRABA 020#agicen42.n;
     |FINSI;

     |CIERRA #42;
|FPRC;

|PROCESO Chequeos;
     aMensaje = "";

     |ABRE #42;
     #42#0 = enEmpresa;
     #42#1 = enRegistro;
     |LEE 000#42=;
     |SI FSalida = 0;
          |SI enOpcion = 2;
               |SI eaTipo = "A";
                    |SI #42#5 = " "; |Y #42#8 = " "; |Y #42#9 = " "; |Y #42#10 = " ";
                       |Y #42#11 = " "; |Y #42#37 = " ";
                         aMensaje = "    La página 2A sólo es accesible si se marca la casilla ";
                         aMensaje = aMensaje + "111, 122, 123, 124, 125 o 142";
                    |FINSI;
               |FINSI;
               |SI eaTipo = "B";
                    |SI #42#4 = " "; |Y #42#5 = " "; |Y #42#6 = " "; |Y #42#8 = " ";
                       |Y #42#9 = " "; |Y #42#10 = " "; |Y #42#11 = " "; |Y #42#37 = " ";
                         aMensaje = "    La página 2B sólo es accesible si se marca la casilla ";
                         aMensaje = aMensaje + "110, 111, 120, 122, 123, 124, 125 o 142";
                    |FINSI;
               |FINSI;
               |SI eaTipo = "C";
                    |SI #42#4 = " "; |Y #42#5 = " "; |Y #42#6 = " "; |Y #42#8 = " "; |Y #42#10 = " "; |Y #42#11 = " "; |Y #42#37 = " ";
                         aMensaje = "    La página 2C sólo es accesible si se marca la casilla ";
                         aMensaje = aMensaje + "110, 111, 122, 124, 125 o 142";
                    |FINSI;
               |FINSI;
          |FINSI;
          |SI enOpcion = 3;
               |SI #42#4 = " "; |Y #42#5 = " "; |Y #42#12 = " ";
                    aMensaje = "    La página 3 sólo es accesible si se marca la casilla ";
                    aMensaje = aMensaje + "110, 111 o 126";
               |FINSI;
          |FINSI;
          |SI enOpcion = 4;
               |SI #42#4 = " "; |Y #42#5 = " "; |Y #42#13 = " ";
                    aMensaje = "    La página 4 sólo es accesible si se marca la casilla ";
                    aMensaje = aMensaje + "110, 111 o 127";
               |FINSI;
          |FINSI;
          |SI enOpcion = 5;
               |SI #42#4 = " "; |Y #42#5 = " "; |Y #42#14 = " "; |Y #42#15 = " "; |Y #42#16 = " ";
               |Y #42#17 = " "; |Y #42#38 = " ";
                    aMensaje = "    La página 5 sólo es accesible si se marca la casilla ";
                    aMensaje = aMensaje + "110, 111, 128, 129, 130, 131 o 143";
               |FINSI;
          |FINSI;
          |SI enOpcion = 6;
               |SI #42#4 = " "; |Y #42#5 = " "; |Y #42#6 = " "; |Y #42#18 = " "; |Y #42#19 = " "; |Y #42#20 = " ";
               |Y #42#21 = " ";
                    aMensaje = "    La página 6 sólo es accesible si se marca la casilla ";
                    aMensaje = aMensaje + "110, 111, 120, 132, 133, 134 o 135";
               |FINSI;
          |FINSI;
          |SI enOpcion = 7; |O enOpcion = 8;
               |SI #42#4 = " "; |Y #42#5 = " "; |Y #42#22 = " "; |Y #42#23 = " "; |Y #42#24 = " ";
                    aMensaje = "    La página 7 sólo es accesible si se marca la casilla ";
                    aMensaje = aMensaje + "110, 111, 136, 137 o 138";
               |FINSI;
          |FINSI;

          |SI enOpcion = 9;
              |SI nSubOpcion = 1;
                  |SI #42#4 = " "; |Y #42#5 = " "; |Y #42#25 = " ";
                       aMensaje = "    La página 8 sólo es accesible si se marca la casilla ";
                       aMensaje = aMensaje + "110, 111 o 139";
                  |FINSI;
              |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #42;

  |SI enOpcion = 10;
     |SI #42#28 = "S";
         |SI #42#29 = "2"; |O #42#29 = "4"; |O #42#29 = "5";
            |O #42#29 = "6"; |O #42#29 = "A";
               |ABRE #54;
               #54#0 = enEmpresa;
               #54#1 = enRegistro;
               #54#2 = 1;
               |LEE 041#54];
               |SI FSalida ! 0; |O #54#0 ! enEmpresa; |O #54#1 ! enRegistro;
                   |MENAV "0000Aviso. No hay informado ningun sucesor de la pagina 9";
               |FINSI;
               |CIERRA #54;
         |FINSI;
     |FINSI;
  |FINSI;
|FPRC;

|PROGRAMA;

     |HAZ LeeUnidadBasico;

     aParam = PARAMETRO;
     |QBF aParam;
     |SI aParam = "EMISION";
          |HAZ EmiteEsto;
          |ACABA;
     |FINSI;

     |HAZ Tipo88;
     |HAZ BusquedaApli;

     enOpcion = 1;
     |BLANCO 0901 2301;

     |PARA; |SI;  |HACIENDO;
            aMenu2 = enOpcion;
            |MENUG aMenu;
            enOpcion = FSalida;
            |SI enOpcion < 1;  |O enOpcion > 10;
                |SAL;
            |FINSI;

          nSubOpcion = 0;
          |HAZ Chequeos;
          |SI aMensaje ! "";
              |MENAV aMensaje;
              enOpcion = 0;  || no entres
          |FINSI;

          |SI enOpcion ! 4;   || no en los SUBEJECUTAS
               |PUSHV 05010980;
          |FINSI;

          |SI enOpcion = 1;  |HAZ Causas;                |FINSI;
          |SI enOpcion = 2;  |HAZ DatosPersonales;       |FINSI;
          |SI enOpcion = 3;  |HAZ Representantes;        |FINSI;
          |SI enOpcion = 4;  |SUB_EJECUTA_NP "agicen47"; |FINSI;
          |SI enOpcion = 5;  |HAZ GEMP_IVA;              |FINSI;
          |SI enOpcion = 6;  |HAZ IRPF;                  |FINSI;
          |SI enOpcion = 7;  |HAZ Retenciones;           |FINSI;
          |SI enOpcion = 8;  |HAZ Intracomunitario;      |FINSI;
          |SI enOpcion = 9;  |HAZ MenuSocios;            |FINSI;
          |SI enOpcion = 10; |HAZ EmiteEsto;             |FINSI;

          |SI enOpcion ! 4;    || no en los SUBEJECUTAS
               |BLANCO 09012380;
               |POPV;
          |FINSI;
     |SIGUE;
|FPRO;
