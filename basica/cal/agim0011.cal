|FICHEROS;
     agim0011 #0;
     agim0012 #1;

     :/laboral/def/labtraba #200;

     imagen@  #2;
     &usuarios@ #712;
     &clientes@ #715;
|FIN;

|VARIABLES;
     aAlfa1 = "";
     aAlfa  = "";
     aFich  = "";
     aMas   = "";
     nLinea = 0;
     aBase  = "";
     aAbre  = "";
     nHandle = 0;

     &eaCodUsu    = "";
     &enCodCli    = 0;
     &enSwDeDonde = 0;
|FIN;

|PROCESO PintaCliente;  |TIPO 7;
     enCodCli = #0#0;
     |HAZ LeePersona;
     |SI enSwDeDonde = 1;
         #0#1 = #715#1;
         #0#2 = #715#10;
         #0#3 = #715#11;
         #0#4 = #715#13;
         #0#5 = #715#14;
         #0#6 = #715#6;
         #0#7 = #715#7;
     |SINO;
         #0#1 = #715#1;
         #0#2 = #715#88;
         #0#3 = #715#89;
         #0#4 = #715#90;
     |FINSI;

     |SI #0#4 ! 0;
         enCodCli = #0#4;
         |HAZ LeePersona;
         #0#5 = #715#1;
     |FINSI;

     |PINTA #0#1;
     |PINTA #0#2;
     |PINTA #0#3;
     |PINTA #0#4;
     |PINTA #0#5;
|FPRC;

|PROCESO PintaUsuario;
     eaCodUsu = #1#8;
     |HAZ LeeUsuario;

     #1#9 = #712#1;
     |PINTA #1#9;
|FPRC;

|PROCESO MayorC;
#0Campo = #0Campo > #0Campo;
|PINTA #0Campo
|FPRC;

|PROCESO MayorL;
#1Campo = #1Campo > #1Campo;
|PINTA #1Campo
|FPRC;

|PROCESO Clave;
|SI #1#5 = "N"; #1#6 = "NO TIENE "; |FINSI;
|SI #1#5 = "A"; #1#6 = "ARCHIVADO"; |FINSI;
|SI #1#5 = "E"; #1#6 = "ENTREGADO"; |FINSI;
|PINTA #1#6;
|FPRC;

|PROCESO CreaTempo;
     #2#0 = #1#0;
     #2#1 = 9999;
     |LEE 040#2];
     |SI FSalida = 0;
         |LEE 040#2a;
     |SINO;
         |LEE 040#2u;
     |FINSI;
     |SI FSalida = 0;  |Y #2#0 = #1#0;
         nLinea = #2#1 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     #2#0  = #1#0;
     #2#1  = nLinea;
     #2#2  = #1#2;
     #2#3  = #1#3;
     #2#4  = #1#4;
     #2#5  = #1#5;
     #2#6  = #1#6;
     #2#7  = #1#7;
     #2#8  = #1#8;
     #2#9  = #1#9;
     #2#10 = #1#10;
     #2#11 = #1#11;
     |GRABA 020#2n;
     |LIBERA #2;
|FPRC;

|DEFBUCLE agim0012;
     #1#2;
     ;
     00000, "     ", 0000, 00;
     99999, "zzzzz", 9999, 99;
     be;
     NULL, CreaTempo;
|FIN;

|PROCESO CreaFichero;
     #1#0  = #2#0;
     #1#1  = #2#1;
     #1#2  = #2#2;
     #1#3  = #2#3;
     #1#4  = #2#4;
     #1#5  = #2#5;
     #1#6  = #2#6;
     #1#7  = #2#7;
     #1#8  = #2#8;
     #1#9  = #2#9;
     #1#10 = #2#10;
     #1#11 = #2#11;
     |GRABA 020#1n;
     |LIBERA #1;
|FPRC;

|PROCESO Tipo20;  |TIPO 20;
     aAlfa1 = FSalida;

     |SI aAlfa1 = "OPCION";
         FSalida = "Organizar";
         |ACABA;
     |FINSI;

     |MENAV "     Debe ser el UNICO Usuario dentro del programa.";
     |CONFI "2400NEsta seguro de que esta solo en el fichero : ";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |DBASE aAlfa;
     aFich  = aAlfa + "fich/";
     aMas   = aAlfa + "def/agim0012.mas";
     |CARGA_DEF aMas, imagen@;
     |SI FSalida ! 0;
         |MENAV  "         Error en cargar el Def ... Proceso Abortado.";
         |ACABA;
     |FINSI;

     |NOME_DAT #2 "archivos";
     |ABRE #2;
     |LEE 040#2p;
     |SI FSalida = 0;
         |DESCARGA_DEF #imagen@;
         |MENAV "      YA HAY UNA TAREA ORGANIZANDO.";
         |CIERRA #2;
         |ACABA;
     |FINSI;
     |CIERRA #2;

     |ABRE #2;
     |BUCLE agim0012;

     |ABRE #1;  |CIERRA #1;  |DELINDEX #1;

     |ABRE #1;
     |LEE 040#2p;
     |PARA; |SI FSalida = 0;  |HACIENDO;
            |HAZ CreaFichero;
            |LEE 040#2s;
     |SIGUE;
     |CIERRA #1;
     |CIERRA #2;

     |DELINDEX #2;
     |DESCARGA_DEF #imagen@;

     |MENAV "    Organizacion termina sastifactoriamente.";
|FPRC;


|PROCESO Traba7;  |TIPO 7;
     |DBASS aBase;  |QBF aBase;
     aAbre = aBase + "laboral/def/labtraba.mas";
     |XABRE "E", aAbre, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |C_M #1#12, 1, "S";

     |ABRE #200;
     #200#0 = #0#0;
     #200#1 = 1;
     |LEE 000#200];
     |SI FSalida ! 0;  |O #200#0 ! #0#0;
         |C_M #1#12, 1, "N";  #1#12 = 0;    |PINTA #1#12;
                              #1#13 = "";   |PINTA #1#13;
     |FINSI;
     |CIERRA #200;
|FPRC;

|PROCESO Baja200;
     #200#0 = #0#0;
     #200#1 = 1;
|FPRC;

|PROCESO Alta200;
     #200#0 = #0#0;
     #200#1 = 99999;
|FPRC;

|PROCESO Traba66;  |TIPO 66;
     |ABRE #200;
     #200#0 = #0#0;
     #200#1 = #1#12;
     |LEE 000#200=;

     |CONSULTA_F_CLAVE #1#200, Baja200, Alta200;
     |SI FSalida = 0;
         #1#12 = #200#1;  |PINTA #1#12;
         #1#13 = #200#2;  |PINTA #1#13;
     |FINSI;
     |CIERRA #200;

     |ERROR;
|FPRC;

|PROCESO Traba0;  |TIPO 0;
     |SI #1#12 = 0;
         #1#13 = "";  |PINTA #1#13;
         |ACABA;
     |FINSI;

     |ABRE #200;
     #200#0 = #0#0;
     #200#1 = #1#12;
     |LEE 000#200=;
     |SI FSalida ! 0;
         |MENAV "0000 Trabajador Inexistente.";
         |ERROR;
     |SINO;
         #1#13 = #200#2;  |PINTA #1#13;
     |FINSI;
     |CIERRA #200;
|FPRC;
