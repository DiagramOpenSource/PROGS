|FICHEROS;
     agiepim1 #1;
     agiepim2 #2;
|FIN;

|VARIABLES;
     aAlfa        = "";
     nNume        = 0;

     &enModoModi  = 0;
     &eaTipoEpi   = "";
     &enAgrupa    = 0;
     &eaEpigrafe  = "";
     &eaNombEpi   = "";
     &eaCNAE2008  = "";
     &eaCNAE2009  = "";
     &enSectAct   = 0;
|FIN;

|RUTINA ClaveBaja2;
     |SI FSalida = "POSICION";
         |ABRE #2;
         #2#0 = eaTipoEpi;
         #2#1 = enAgrupa;
         #2#2 = eaEpigrafe;
         |LEE 040#2];
         |SI FSalida ! 0;  |O  #2#0 ! eaTipoEpi; |O #2#1 ! enAgrupa;
             #2#0 = eaTipoEpi;
             #2#1 = enAgrupa;
             #2#2 = "";
         |FINSI;
         |CIERRA #2;
         |ACABA;
     |FINSI;

     #2#0 = eaTipoEpi;
     #2#1 = enAgrupa;
     #2#2 = "     ";
|FRUT;

|RUTINA ClaveAlta2;
     #2#0 = eaTipoEpi;
     #2#1 = enAgrupa;
     #2#2 = "zzzzz";
|FRUT;

|PROCESO EntraEpigrafe;

     aAlfa = #1#0;  aAlfa = aAlfa % 101;
     nNume = aAlfa; nNume = nNume * 100;
     enAgrupa = nNume;
     |SI enAgrupa ! #1#0;
         eaEpigrafe = #1#0;
         #1#0 = enAgrupa; |PINTA #1#0;
     |FINSI;

     |ENTLINEAL #1#2, -3, 4, 22, 0, ClaveBaja2, ClaveAlta2;
     |SI enModoModi = 1;
         enAgrupa = #1#0;
         |ENTLINEAL #1#2, -3, 2, 22, 0, ClaveBaja2, ClaveAlta2;
         |ATRI N;  |PINTA 1460, "         "; |ATRI n;
         enModoModi = 0;
     |FINSI;
|FPRC;

|PROCESO Tipo7m1;  |TIPO 7;
     eaTipoEpi = "E";
     enAgrupa  = #1#0;
     |ENTLINEAL #1#2, -3, 7, 22, 0, ClaveBaja2, ClaveAlta2;
|FPRC;
