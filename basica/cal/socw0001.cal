|FICHEROS;
     socm0001;
     socw0001;

     agim0024;
|FIN;

|VARIABLES;
     nHay           = 0;
     nPasada        = 0;

     aAlfa          = "";

     &enReg         = 0;
     &eaVarDni      = "";
     &enCalcCif     = 0;
     &eaCta         = "";
|FIN;

|INCLUYE i_agicon;

|PROCESO agim0024;
     |SI nPasada = 1;
         #socw0001#2  = #agim0024#4;   |PINTA #socw0001#2;
         #socw0001#3  = #agim0024#5;   |PINTA #socw0001#3;
         #socw0001#4  = #agim0024#6;   |PINTA #socw0001#4;
         #socw0001#5  = #agim0024#7;   |PINTA #socw0001#5;
         #socw0001#6  = #agim0024#8;   |PINTA #socw0001#6;
         #socw0001#7  = #agim0024#9;   |PINTA #socw0001#7;
         #socw0001#8  = #agim0024#10;  |PINTA #socw0001#8;
         #socw0001#9  = #agim0024#11;  |PINTA #socw0001#9;
         #socw0001#10 = #agim0024#12;  |PINTA #socw0001#10;
         #socw0001#11 = #agim0024#13;  |PINTA #socw0001#11;
         #socw0001#12 = #agim0024#14;  |PINTA #socw0001#12;
         #socw0001#13 = #agim0024#15;  |PINTA #socw0001#13;
         #socw0001#14 = #agim0024#16;  |PINTA #socw0001#14;
         #socw0001#15 = #agim0024#17;  |PINTA #socw0001#15;
         #socw0001#16 = #agim0024#18;  |PINTA #socw0001#16;
     |FINSI;

     |SI nPasada = 2;
         #agim0024#19 = "S";
         |GRABA 020#agim0024.a;
     |FINSI;

     |LIBERA #agim0024;

     nHay = 1;
     |ERROR10;
|FPRC;

|DEFBUCLE agim0024;
     #agim0024#1;
     3;
     #socw0001#0, enReg, 01, #socw0001#1;
     #socw0001#0, enReg, 99, #socw0001#1;
     be;
     NULL, agim0024;
|FIN;

|PROCESO Tipo12Fsocw1;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     nPasada = 2;
     |BUCLE agim0024;

     |SI nHay = 1;  |ACABA;  |FINSI;
|FPRC;

|PROCESO PtecFinal;
     |SI FSalida = 1;  |ACABA;  |FINSI;

     |POSICIONATE #socw0001#18;
|FPRC;

|PROCESO Tipo0C17socw1; |TIPO 0;
     eaCta = #socw0001#17;
     |HAZ EFiltraPtos;
     #socw0001#17 = eaCta;
     |PINTA #socw0001#17;
|FPRC;

|PROCESO Tipo0C1Fsocw1;  |TIPO 0;
     |C_M #socw0001#1, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     #socm0001#0 = #socw0001#0;
     #socm0001#1 = #socw0001#1;
     |LEE 000#socm0001.=;
     |SI FSalida = 0;
         |MENAV "0000El administrador ya est  introducido.";
         |ERROR;
         |ACABA;
     |FINSI;

     nPasada = 1;
     |BUCLE agim0024;

     |SI nHay = 0;
         |MENAV "0000No existe el administrador en la ficha de sociedades, por favor informelo alli primero.";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tipo6C1Fsocw1;  |TIPO 6;
     |SI FSalida = 10;
         eaVarDni  = #socw0001#1;
         enCalcCif = 1;
         |HAZ CalculoDNI;
         #socw0001#1 = eaVarDni;
         |PINTA #socw0001#1;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #socw0001#1;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 112;
     |SI #socw0001#1 ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #socw0001#1 = eaVarDni;
             |PINTA #socw0001#1;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Bajam024;
     #agim0024#0 = #socw0001#0
     #agim0024#1 = enReg;
     #agim0024#2 = 01;
|FPRC;

|PROCESO Altam024;
     #agim0024#0 = #socw0001#0
     #agim0024#1 = enReg;
     #agim0024#2 = 99;
|FPRC;

|PROCESO Tipo66C1Fsocw1;  |TIPO 66;
     |ABRE #agim0024;
     |CONSULTA_F_CLAVE #1#agim0024, Bajam024, Altam024;
     |SI FSalida = 0;
         #socw0001#1 = #agim0024#3;
         |PINTA #socw0001#1;
     |FINSI;
     |CIERRA #agim0024;
|FPRC;
