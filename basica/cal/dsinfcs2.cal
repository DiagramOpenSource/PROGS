|FICHEROS;
    dsinfcs2 #12,MANTE;
|FIN;

|VARIABLES;
   aAlfa1     = "";
   aAlfa2     = "";
   nNume1     = 0;
   &NumMes    = 0;
   &NombreMes = "";
   &eaCuenta  = "";
   &salidas   = 0;
   &eaFecha   = "";
   &nSwMal    = 0;

   mesh = "";
   diah = "";
|FIN;

|PROCESO seleccio; |TIPO 0;
   |SI #dsinfcs2#4 = "N";
      |C_M #dsinfcs2#05, 1, "S"; |C_M #dsinfcs2#06, 1, "S";
      |C_M #dsinfcs2#07, 1, "S"; |C_M #dsinfcs2#08, 1, "S";
      |C_M #dsinfcs2#09, 1, "S"; |C_M #dsinfcs2#10, 1, "S";
      |C_M #dsinfcs2#11, 1, "S"; |C_M #dsinfcs2#12, 1, "S";
      |C_M #dsinfcs2#13, 1, "S"; |C_M #dsinfcs2#14, 1, "S";
      |C_M #dsinfcs2#15, 1, "S"; |C_M #dsinfcs2#16, 1, "S";
      |C_M #dsinfcs2#17, 1, "S"; |C_M #dsinfcs2#18, 1, "S";
      |C_M #dsinfcs2#19, 1, "S"; |C_M #dsinfcs2#20, 1, "S";
      |C_M #dsinfcs2#21, 1, "S"; |C_M #dsinfcs2#22, 1, "S";
      |C_M #dsinfcs2#23, 1, "S"; |C_M #dsinfcs2#24, 1, "S";
      |C_M #dsinfcs2#25, 1, "S"; |C_M #dsinfcs2#26, 1, "S";
      |C_M #dsinfcs2#27, 1, "S"; |C_M #dsinfcs2#28, 1, "S";
      |C_M #dsinfcs2#29, 1, "N"; |C_M #dsinfcs2#30, 1, "N";
      #dsinfcs2#29 = 1;       |PINTA #dsinfcs2#29;
      #dsinfcs2#30 = 999;     |PINTA #dsinfcs2#30;
   |SINO;
      |C_M #dsinfcs2#05, 1, "N"; |C_M #dsinfcs2#06, 1, "N";
      |C_M #dsinfcs2#07, 1, "N"; |C_M #dsinfcs2#08, 1, "N";
      |C_M #dsinfcs2#09, 1, "N"; |C_M #dsinfcs2#10, 1, "N";
      |C_M #dsinfcs2#11, 1, "N"; |C_M #dsinfcs2#12, 1, "N";
      |C_M #dsinfcs2#13, 1, "N"; |C_M #dsinfcs2#14, 1, "N";
      |C_M #dsinfcs2#15, 1, "N"; |C_M #dsinfcs2#16, 1, "N";
      |C_M #dsinfcs2#17, 1, "N"; |C_M #dsinfcs2#18, 1, "N";
      |C_M #dsinfcs2#19, 1, "N"; |C_M #dsinfcs2#20, 1, "N";
      |C_M #dsinfcs2#21, 1, "N"; |C_M #dsinfcs2#22, 1, "N";
      |C_M #dsinfcs2#23, 1, "N"; |C_M #dsinfcs2#24, 1, "N";
      |C_M #dsinfcs2#25, 1, "N"; |C_M #dsinfcs2#26, 1, "N";
      |C_M #dsinfcs2#27, 1, "N"; |C_M #dsinfcs2#28, 1, "N";
      |C_M #dsinfcs2#29, 1, "S"; |C_M #dsinfcs2#30, 1, "S";
   |FINSI;
|FPRC;

|PROCESO seleccio2; |TIPO 0;
   |SI #dsinfcs2#37 = "N";
      |C_M #dsinfcs2#38, 1, "S"; |C_M #dsinfcs2#39, 1, "S";
      |C_M #dsinfcs2#40, 1, "S"; |C_M #dsinfcs2#41, 1, "S";
      |C_M #dsinfcs2#42, 1, "S"; |C_M #dsinfcs2#43, 1, "S";
      |C_M #dsinfcs2#44, 1, "S"; |C_M #dsinfcs2#45, 1, "S";
      |C_M #dsinfcs2#46, 1, "S"; |C_M #dsinfcs2#47, 1, "S";
      |C_M #dsinfcs2#48, 1, "S"; |C_M #dsinfcs2#49, 1, "S";
      |C_M #dsinfcs2#0,  1, "N"; |C_M #dsinfcs2#1,  1, "N";
      #dsinfcs2#0 = "            "; |PINTA #dsinfcs2#0;
      #dsinfcs2#1 = "zzzzzzzzzzzz"; |PINTA #dsinfcs2#1;
   |SINO;
      |C_M #dsinfcs2#0,  1, "S"; |C_M #dsinfcs2#1,  1, "S";
      |C_M #dsinfcs2#38, 1, "N"; |C_M #dsinfcs2#39, 1, "N";
      |C_M #dsinfcs2#40, 1, "N"; |C_M #dsinfcs2#41, 1, "N";
      |C_M #dsinfcs2#42, 1, "N"; |C_M #dsinfcs2#43, 1, "N";
      |C_M #dsinfcs2#44, 1, "N"; |C_M #dsinfcs2#45, 1, "N";
      |C_M #dsinfcs2#46, 1, "N"; |C_M #dsinfcs2#47, 1, "N";
      |C_M #dsinfcs2#48, 1, "N"; |C_M #dsinfcs2#49, 1, "N";
   |FINSI;
|FPRC;

|CALCULO cuentaS2; |TIPO 6;
     |C_M #dsinfcs2#Campo#,0,aAlfa1;
     |SI aAlfa1 = "N"; |ACABA; |FINSI;

     eaCuenta = #dsinfcs2#Campo#;
     salidas  = FSalida;
     |HAZ FiltraPuntos;
     #dsinfcs2#Campo# = eaCuenta;
     |PINTA #dsinfcs2#Campo#;
|FCAL;

|PROCESO VerFechaS2; |TIPO 0;

  eaFecha = #dsinfcs2#Campo#;
  |HAZ VerLaFecha;

  |SI nSwMal = 1;
      |MENAV "0000Fecha Erronea";
      |ERROR;
  |FINSI;
|FPRC;

|PROCESO colummes; |TIPO 7;
|| Calculo para saber en que columna del plan contable
|| se encuentra el mes hasta, y hacer no modificable
|| el campo de (Con saldo S/N)

   |C_M #dsinfcs2#31, 1, "S";
   diah  = #dsinfcs2#3 % 102;
   mesh  = #dsinfcs2#3 % 402;

   |SI diah = "31"; |O diah = "30"; |O diah = "28"; |O diah = "29";
      |SI diah = "30";
         |SI mesh = "01"; |O mesh = "03"; |O mesh = "05"; |O mesh = "07";
            |O mesh = "08"; |O mesh = "10"; |O mesh = "12";

            |C_M #dsinfcs2#31, 1, "N";
         |FINSI;
      |FINSI;
      |SI diah = "28"; |O diah = "29";
         |SI mesh ! "02";
            |C_M #dsinfcs2#31, 1, "N";
         |FINSI;
      |FINSI;
   |SINO;
      |C_M #dsinfcs2#31, 1, "N";
   |FINSI;
|FPRC;
