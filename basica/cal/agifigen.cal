|FICHEROS;
    agifigen #0;         || ficha general clientes

    agicen01 #101;       || Actividades
    agiconpa #11,MANTE;
    agitelef #19;
    agiconpa #11,MANTE;
    agiw0015 #98,MANTE;
    agim0001 #99,MANTE;
    agim0004 #96,MANTE;
    agiw0021 #95;
    agim0015 #94;

    agim0003 #500;       || Clientes Proveedores
    agitelef #501;       || Listin Telefonico
    agim0036 #503;
    agim0028 #528;

    &haciend@ #706;
    &provinc@ #700;

     cliente@ #900;
     portada@ #901;
|FIN;

|VARIABLES;
    NMovi     = 0;
    NombreCli = "";
    Reg       = 0;
    FEstado   = 0;
    modo      = 0;
    nume1     = 0;
    nume2     = 0;
    nume3     = 0;
    nume4     = 0;
    alfa1     = "";
    alfa2     = "";
    alfa3     = "";
    alfa4     = "";
    lugar     = 0;
    nifnum    = 0;
    resto     = 0;
    ficha     = "";
    particion = "";
    pfactur   = "";
    pnomina   = "";
    psociedad = "";
    pficha    = "";
    prenta    = "";
    pconta    = "";
    emprefac  = "";
    confor    = "2410NDesea modificar los datos en los demas ficheros S/N: ";
    aste      = "*";
    si        = "S";
    no        = "N";
    fiac      = "  ";
    guarda    = "  ";
    poner     = "  ";
    relleno   = "                                       ";
    nada      = "";
    nada1     = "";
    numero    = 0;
    vale      = 0;
    juan      = 0;
    periodo   = 0;
    letra     = "";
    final     = "";
    x         = "";
    pos1      = "";
    pos2      = "";
    pos3      = "";
    pos4      = "";
    QueRenta  = "";
    SwSalida = 0;
    Tope      = 0;
    f2        = "";
    f3        = "";
    f4        = "";
    f5        = "";
    f6        = "";
    tecla     = "";
    Campos    = 0;
    Campos1   = 0;
    Campos2   = 0;
    Direc     = "";
    Programa  = "";
    Fichero   = "";
    Fichero1  = "";
    Fichero2  = "";
    Fich      = "";
    Valfa     = "";
    Campo1    = 0;

    &Empresa     = 0;
    &QuePrograma = 0;
    &em_borr     = 0;
    &tr_borr     = 0;
    &empresa     = 0;
    &anyo        = 0;
    &eaVarDni    = "";
    &enCalcCif   = 0;

    Comodin = "";
    Campo2 = 0;
    Campo3 = 0;
    Campo4 = 0;
    Cont = 0;
    aAlfa       = "";

    aDef         = "";

    &enEmpresa   = 0;
    &enActividad = 0;
    &enCodProv   = 0;
    &enCodPobl   = 0;

     &eaPathBasica   = "";
     &eaPathContagen = "";
     &eaPathContanex = "";
     &eaPathContasoc = "";
     &eaPathRen2000  = "";
     &eaPathRen1999  = "";
     &eaPathRen1998  = "";
     &eaPathRen1997  = "";
     &eaPathRen1996  = "";
     &eaPathRen1995  = "";
     &eaPathRen1994  = "";
     &eaPathFacturar = "";
     &eaPathLaboral  = "";
     &eaPathIntegral = "";
     &eaPathDsmodelo = "";

|FIN;

|PROCESO Tipo8; |TIPO 8;
     |HAZ BusquedaApli;
|FPRC;

|PROCESO cdpostal;
     numero = #0#9 * 1000;
     numero = numero + #0#10;
     numero = 100000 + numero;
     nada = numero;
     #0#16 = nada % A205;
|FPRC;


|PROCESO tipo_serv; |TIPO 0;
     |SI #0#85 = 1; #0#86 = "CONTRATO"; |FINSI;
     |SI #0#85 = 2; #0#86 = "SERVICIO"; |FINSI;
     |PINTA #0#86;
|FPRC;

|PROCESO repetir; |TIPO 0;
     modo = (FEntrada / 100) ! 0;
     |SI modo ! 1; |ACABA; |FINSI;

     #0#41 = #0#03;  |PINTA #0#41;
     #0#42 = #0#04;  |PINTA #0#42;
     #0#43 = #0#05;  |PINTA #0#43;
     #0#44 = #0#06;  |PINTA #0#44;
     #0#45 = #0#07;  |PINTA #0#45;
     #0#46 = #0#08;  |PINTA #0#46;
     #0#47 = #0#09;  |PINTA #0#47;
     #0#48 = #0#10;  |PINTA #0#48;
     #0#49 = #0#11;  |PINTA #0#49;
     #0#50 = #0#12;  |PINTA #0#50;

     #0#51 = #0#03;  |PINTA #0#51;
     #0#52 = #0#04;  |PINTA #0#52;
     #0#53 = #0#05;  |PINTA #0#53;
     #0#54 = #0#06;  |PINTA #0#54;
     #0#55 = #0#07;  |PINTA #0#55;
     #0#56 = #0#08;  |PINTA #0#56;
     #0#57 = #0#09;  |PINTA #0#57;
     #0#58 = #0#10;  |PINTA #0#58;
     #0#59 = #0#11;  |PINTA #0#59;
     #0#60 = #0#12;  |PINTA #0#60;
|FPRC;

|PROCESO CogeHacienda;
     enCodProv = #0#63;
     enCodPobl = #0#64;
     |HAZ LeeHacienda;
     #0#91 = #706#2;  |PINTA #0#91;
     #0#92 = #706#3;  |PINTA #0#92;
|FPRC;

|PROCESO Tipo7;  |TIPO 7;
  |ABRE #503;
  |LEE 040#503p;
  |SI FSalida ! 0;  |CIERRA #503;  |ACABA;  |FINSI;
  |CIERRA #503;

  Campo1 = Campo - 23;
  Valfa  = "     " + #503Campo1;   |QBF Valfa;

  |ATRI R;  |BLIN 04;  |ATRI 0;

  |SI Valfa ! "";  |MENSA Valfa;  |FINSI;
|FPRC;

|| *************************************************************************
||                        PROCESO TECLAS DE FUNCION
|| *************************************************************************

|PROCESO Tipo13; |TIPO 13;
     |SI FSalida ! 16; |ACABA; |FINSI;

     |HAZ funcion;
|FPRC;

|PROCESO funcion;
     |SI FSalida ! 16; |ACABA; |FINSI;

     |PUSHV 0501 2380;

     |ET aqui;
         |D_CUADRO 1119, 1761;
         |ATRI R;

         |PINTA 1220, " <F2> Representantes                     ";
         |PINTA 1320, " <F3> Control de Pases                   ";
         |PINTA 1420, " <F4> Conceptos Contratados              ";
         |PINTA 1520, " <F5> Consulta de Rendimientos           ";
         |PINTA 1620, " <F6> Consulta de certif.Contratistas    ";

         |ATRI r;

         |LEETECLA tecla;

         f2    = &255 + "824";
         f3    = &255 + "825";
         f4    = &255 + "826";
         f5    = &255 + "827";
         f6    = &255 + "828";

         |SI tecla = f2; |HAZ pulsa_f2; |VETE aqui; |FINSI;
         |SI tecla = f3; |HAZ pulsa_f3; |VETE aqui; |FINSI;
         |SI tecla = f4; |HAZ pulsa_f4; |VETE aqui; |FINSI;
         |SI tecla = f5;
             enEmpresa   = #0#0;
             enActividad = 0;
             |SUB_EJECUTA_NP "agim0002";
         |FINSI;
         |SI tecla = f6;
             aAlfa = "|tadz0001.tab;" + #0#0; |QBF aAlfa;
             aAlfa = aAlfa + "," + #0#13; |QBF aAlfa;
             aAlfa = aAlfa + "," + #0#1; |QBF aAlfa;
             |SUB_EJECUTA_NP aAlfa;
         |FINSI;
    |POPV;
|FPRC;

|| *************************************************************************
||                        PROCESO CARGA REPRESENTANTES
|| *************************************************************************

|RUTINA infer_96;
    #96#0 = #0#0;
    #96#1 = 1;
|FRUT;

|RUTINA super_96;
    #96#0 = #0#0;
    #96#1 = 99;
|FRUT;

|PROCESO pulsa_f2;
     |SI juan = 0; juan = 1; |FINSI;

     |PUSHV 0501 2380;
     |PINPA #0#96;
     |SI juan = 1; |ENTLINEAL #1#96, -2, 1, 21, 0, infer_96, super_96; |FINSI;
     |SI juan = 2; |ENTLINEAL #1#96, -2, 2, 21, 0, infer_96, super_96; |FINSI;

     |POPV;
|FPRC;

|PROCESO LetraDni;  |TIPO 0;
     |SI FSalida = 10;
         eaVarDni  = #0Campo;
         enCalcCif = 1;
         |HAZ CalculoDNI;
         #0Campo = eaVarDni;
         |PINTA #0Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #0Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 112;
     |SI #0Campo ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #0Campo = eaVarDni;  |PINTA #0Campo;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|| *************************************************************************
||                        PROCESO CARGA AGICONPA
|| *************************************************************************

|RUTINA infer;
     #11#0 = #0#0;
     #11#1 = 1;
|FRUT;

|RUTINA super;
     #11#0 = #0#0;
     #11#1 = 99;
|FRUT;

|PROCESO pulsa_f3;
     |SI juan = 0; juan = 1; |FINSI;

     |PUSHV 0501 2380;
     |PINPA #0#11;
     |SI juan = 1; |ENTLINEAL #1#11, -2, 1, 21, 0, infer, super; |FINSI;
     |SI juan = 2; |ENTLINEAL #1#11, -2, 2, 21, 0, infer, super; |FINSI;
     |POPV;
|FPRC;


|| *************************************************************************
||                        PROCESO CARGA AGIM0001
|| *************************************************************************

|RUTINA infer_99;
     #99#0 = #0#0;
     #99#1 = 01;
|FRUT;

|RUTINA super_99;
     #99#0 = #0#0;
     #99#1 = 99;
|FRUT;

|PROCESO pulsa_f4;
     |PUSHV 0501 2380;
     |PINPA #0#98;
     |PINPA #0#99;

     #98#0 = #0#0;
     #98#1 = #0#1;
     #98#2 = #0#79;
     #98#3 = #0#80;
     #98#4 = #0#81;
     #98#5 = #0#82;
     #98#6 = #0#83;
     #98#7 = #0#84;
     #98#9 = #0#95;
     #98#10 = #0#98;
     #98#11 = #0#99;
     #98#12 = #0#105;
     |PINDA #0#98;

     SwSalida = 0;
     |ENTLINEAL #1#99, -2, 4, 20, 0, infer_99, super_99;

     |ENDATOS #2#98;
     |SI FSalida = 0;
         #0#79 = #98#2;
         #0#80 = #98#3;
         #0#81 = #98#4;
         #0#82 = #98#5;
         #0#83 = #98#6;
         #0#84 = #98#7;
         #0#95 = #98#9;
         #0#98 = #98#10;
         #0#99 = #98#11;
         #0#105 = #98#12;
     |FINSI;

     SwSalida = 1;
     |ENTLINEAL #1#99, -2, 2, 20, 0, infer_99, super_99;

     |POPV;
|FPRC;

|PROCESO Salida; |TIPO 7;
     |SI SwSalida = 0; |PTEC 807; |FINSI;
|FPRC;

|PROCESO Pinta; |TIPO 0;
     |PINTA #98Campo;
|FPRC;

|PROCESO Mayor;
     #99Campo = #99Campo > #99Campo;
     |PINTA #99Campo;
|FPRC;

|PROCESO Filtros;
     Tope = 31;

     |SI #99#6 = 2;  Tope = 29; |FINSI;
     |SI #99#6 = 4;  Tope = 30; |FINSI;
     |SI #99#6 = 6;  Tope = 30; |FINSI;
     |SI #99#6 = 9;  Tope = 30; |FINSI;
     |SI #99#6 = 11; Tope = 30; |FINSI;

     |SI Tope < #99#7;
         |MENAV "      El dia no coincide con los dias del mes introducido.";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Pantalla;
     |SI FSalida ! 9; |ACABA; |FINSI;

     |PUSHV 0501 2380;
     |CUADRO 0856 1577;

     |ATRI R;
     |PINTA 0957, " 01 al 12 Meses     ";
     |PINTA 1057, " 13.- Mensual       ";
     |PINTA 1157, " 14.- Bimensual     ";
     |PINTA 1257, " 15.- Trimestral    ";
     |PINTA 1357, " 16.- Cuatrimestral ";
     |PINTA 1457, " 17.- Semestral     ";
     |ATRI r;

     |PAUSA;
     |POPV;

     |ERROR;
|FPRC;

|PROCESO SNIva; |TIPO 0;
     |SI #99#8 = "S";
         |CAMPO_MODIFICA #99#9, 1, "S";
     |SINO;
         |CAMPO_MODIFICA #99#9, 1, "N";
         #99#9 = 0; |PINTA #99#9;
     |FINSI;
|FPRC;

|PROCESO CalcuTotal; |TIPO 0;
     |SI #99Campo = Contenido; |ACABA; |FINSI;

     #99#10 = #99#5 + (#99#5 % #99#9);
     |PINTA #99#10;
|FPRC;

|PROCESO Tipo2;
|FPRC;

|PROCESO defectos;
|FPRC;

|PROCESO totales;
|FPRC;

|| *************************************************************************
||                   PROCESO CHEQUEO A LAS APLICACIONES
|| *************************************************************************

|PROCESO ExFactur;
     |SI eaPathFacturar = "";  |ACABA;  |FINSI;
     |SI #0#17 ! "S"; |ACABA; |FINSI;

     aDef      = eaPathFacturar + "def/asclient.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     emprefac  = ("00" + #0#40) % -102;
     particion =  eaPathFacturar + "fich/" + emprefac + "/";
     |PATH_DAT #900 particion;

     |ABRE #900;
     #900#0 = #0#0;
     |LEE 101#900=;
     |SI FSalida = 0;
         nada  = #900#8;  |QBF nada;
         nada1 = #0#13; |QBF nada1;
         |SI nada ! nada1;
             |MENAV "    EL DNI DEL CLIENTE NO ES EL MISMO QUE EN FACTURACION";
         |FINSI;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #cliente@;
|FPRC;

|PROCESO ExLaboral;
     |SI eaPathLaboral = "";  |ACABA;  |FINSI;
     |SI #0#18 ! "S"; |ACABA; |FINSI;

     aDef      = eaPathLaboral + "def/labempre.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     #900#0 = #0#0;
     #900#1 = 1;
     |LEE 040#900];
     |SI FSalida = 0;
         |SI #900#0  = #0#0;
             nada  = #900#10; |QBF nada;
             nada1 = #900#13; |QBF nada1;
             |SI nada ! nada1;
                 |MENAV "    EL DNI DEL CLIENTE NO ES EL MISMO QUE EN NOMINAS/CONTRATOS";
             |FINSI;
         |FINSI;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #cliente@;
|FPRC;

|PROCESO anyo;
     anyo = #900#1;
|FPRC;

|DEFBUCLE maacceso;
     #900#1002;
     ;
     #0#0, 0000;
     #0#0, 9999;
     e;
     NULL, anyo;
|FIN;

|PROCESO ExSociedad;
     |SI eaPathContasoc = "";  |ACABA;  |FINSI;
     |SI #0#20 ! "S"; |ACABA; |FINSI;

     aDef      = eaPathContasoc + "def/maacceso.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     anyo = 0;
     |BUCLE maacceso;
     |SI anyo = 0; |ACABA; |FINSI;

     |ABRE #900;
     #900#0   = #0#0;
     #900#1   = anyo;
     |LEE 040#900=;
     |SI FSalida = 0;
         nada  = #900#3;  |QBF nada;
         nada1 = #0#13;   |QBF nada1;
         |SI nada ! nada1;
             |MENAV  "    EL DNI DEL CLIENTE NO COINCIDE CON EL IMPUESTO DE SOCIEDADES";
         |FINSI;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #cliente@;
|FPRC;

|PROCESO ExRenta94;
     aDef      = eaPathRen1994 + "def/redatcon.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     #900#0 = #0#0;
     |LEE 040#900=;
     |SI FSalida = 0;
         |SI #900#0 = #0#0;
             nada  = #900#2;  |QBF nada;
             nada1 = #0#13;   |QBF nada1;
             |SI nada ! nada1;
                 |MENAV "    EL DNI DEL CLIENTE NO ES EL MISMO QUE EN LA RENTA";
             |FINSI;
         |FINSI;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #cliente@;
|FPRC;

|PROCESO ExRenta95;
     aDef      = eaPathRen1995 + "def/redatcon.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     #900#0 = #0#0;
     |LEE 040#900=;
     |SI FSalida = 0;
         |SI #900#0 = #0#0;
             nada  = #900#2;  |QBF nada;
             nada1 = #0#13;   |QBF nada1;
             |SI nada ! nada1;
                 |MENAV "    EL DNI DEL CLIENTE NO ES EL MISMO QUE EN LA RENTA";
             |FINSI;
         |FINSI;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #cliente@;
|FPRC;

|PROCESO ExRenta96;
     aDef      = eaPathRen1996 + "def/redatcon.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     #900#0 = #0#0;
     |LEE 040#900=;
     |SI FSalida = 0;
         |SI #900#0 = #0#0;
             nada  = #900#2;  |QBF nada;
             nada1 = #0#13;   |QBF nada1;
             |SI nada ! nada1;
                 |MENAV "    EL DNI DEL CLIENTE NO ES EL MISMO QUE EN LA RENTA";
             |FINSI;
         |FINSI;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #cliente@;
|FPRC;

|PROCESO ExRenta97;
     aDef      = eaPathRen1997 + "def/redatcon.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     #900#0 = #0#0;
     |LEE 040#900=;
     |SI FSalida = 0;
         |SI #900#0 = #0#0;
             nada  = #900#2;  |QBF nada;
             nada1 = #0#13;   |QBF nada1;
             |SI nada ! nada1;
                 |MENAV "    EL DNI DEL CLIENTE NO ES EL MISMO QUE EN LA RENTA";
             |FINSI;
         |FINSI;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #cliente@;
|FPRC;

|PROCESO ExRenta98;
     aDef      = eaPathRen1998 + "def/redatcon.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     #900#0 = #0#0;
     |LEE 040#900=;
     |SI FSalida = 0;
         |SI #900#0 = #0#0;
             nada  = #900#2;  |QBF nada;
             nada1 = #0#13;   |QBF nada1;
             |SI nada ! nada1;
                 |MENAV "    EL DNI DEL CLIENTE NO ES EL MISMO QUE EN LA RENTA";
             |FINSI;
         |FINSI;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #cliente@;
|FPRC;

|PROCESO ExRenta99;
     aDef      = eaPathRen1999 + "def/rem00100.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     #900#0 = #0#0;
     |LEE 040#900=;
     |SI FSalida = 0;
         |SI #900#0 = #0#0;
             nada  = #900#1;  |QBF nada;
             nada1 = #0#13;   |QBF nada1;
             |SI nada ! nada1;
                 |MENAV "    EL DNI DEL CLIENTE NO ES EL MISMO QUE EN LA RENTA";
             |FINSI;
         |FINSI;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #cliente@;
|FPRC;

|PROCESO ExRenta00;
|FPRC;

|PROCESO ExRenta;
     |SI #0#22 ! "S"; |ACABA; |FINSI;

     |SI eaPathRen2000 ! "";  |HAZ ExRenta00;  |ACABA;  |FINSI;
     |SI eaPathRen1999 ! "";  |HAZ ExRenta99;  |ACABA;  |FINSI;
     |SI eaPathRen1998 ! "";  |HAZ ExRenta98;  |ACABA;  |FINSI;
     |SI eaPathRen1997 ! "";  |HAZ ExRenta97;  |ACABA;  |FINSI;
     |SI eaPathRen1996 ! "";  |HAZ ExRenta96;  |ACABA;  |FINSI;
     |SI eaPathRen1995 ! "";  |HAZ ExRenta95;  |ACABA;  |FINSI;
     |SI eaPathRen1994 ! "";  |HAZ ExRenta94;  |ACABA;  |FINSI;
|FPRC;

|PROCESO ExConta; |TIPO 0;
     |SI #0#23 ! "S"; |ACABA; |FINSI;

     aDef      = eaPathContagen + "def/canempre.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     |PARA periodo = 9; |SI periodo ] 0; |HACIENDO periodo = periodo - 1;
           #900#2 = #0#0;
           #900#3 = periodo;
           |LEE 101#900=;
           |SI FSalida = 0;
               |SI #900#2 = #0#0;
                   nada  = #900#8;   |QBF nada;
                   nada1 = #0#13; |QBF nada1;
                   |SI nada ! nada1;
                       |MENAV "    EL CIF DEL CLIENTE NO ES EL MISMO QUE EN CONTABILIDAD";
                   |FINSI;
               |FINSI;
               |SAL;
           |FINSI;
     |SIGUE;
     |CIERRA #900;

     |DESCARGA_DEF #cliente@;
|FPRC;

|PROCESO MoFactur; |TIPO 7;
     |CAMPO_MODIFICA #0#17, 1, "S";
     |CAMPO_MODIFICA #0#66, 1, "S";
     |SI eaPathFacturar = "";
         |CAMPO_MODIFICA #0#17, 1, "N";
         |CAMPO_MODIFICA #0#66, 1, "N";
         #0#17 = "N";  |PINTA #0#17;
         #0#66 = 0;    |PINTA #0#66;
     |FINSI;
|FPRC;

|PROCESO mofactu1; |TIPO 7;
     |CAMPO_MODIFICA #0#40, 1, "S";
     |SI eaPathFacturar = "";
         |CAMPO_MODIFICA #0#40, 1, "N";
         #0#40 = 0;
         |PINTA #0#40;
     |FINSI;
|FPRC;

|PROCESO MoLaboral; |TIPO 7;
     |CAMPO_MODIFICA #0#18, 1, "S";
     |CAMPO_MODIFICA #0#67, 1, "S";
     |SI eaPathLaboral = "";
          |CAMPO_MODIFICA #0#18, 1, "N";
          |CAMPO_MODIFICA #0#67, 1, "N";
          #0#18 = "N";  |PINTA #0#18;
          #0#67 = 0;    |PINTA #0#67;
     |FINSI;
|FPRC;

|PROCESO MoSociedad;|TIPO 7;
     |CAMPO_MODIFICA #0#20, 1, "S";
     |CAMPO_MODIFICA #0#68, 1, "S";
     |SI eaPathContasoc = "";
         |CAMPO_MODIFICA #0#20, 1, "N";
         |CAMPO_MODIFICA #0#68, 1, "N";
         #0#20 = "N";  |PINTA #0#20;
         #0#68 = 0;    |PINTA #0#68;
     |FINSI;
|FPRC;

|PROCESO MoRenta;|TIPO 7;
     prenta = "";
     |SI eaPathRen1994 ! "";  prenta = eaPathRen1994;   |FINSI;
     |SI eaPathRen1995 ! "";  prenta = eaPathRen1995;   |FINSI;
     |SI eaPathRen1996 ! "";  prenta = eaPathRen1996;   |FINSI;
     |SI eaPathRen1997 ! "";  prenta = eaPathRen1997;   |FINSI;
     |SI eaPathRen1998 ! "";  prenta = eaPathRen1998;   |FINSI;
     |SI eaPathRen1997 ! "";  prenta = eaPathRen1999;   |FINSI;
     |SI eaPathRen2000 ! "";  prenta = eaPathRen2000;   |FINSI;

     |CAMPO_MODIFICA #0#22, 1, "S";
     |CAMPO_MODIFICA #0#69, 1, "S";
     |SI prenta = "";
         |CAMPO_MODIFICA #0#22, 1, "N";
         |CAMPO_MODIFICA #0#69, 1, "N";
         #0#22 = "N";  |PINTA #0#22;
         #0#69 = "N";  |PINTA #0#69;
     |FINSI;
|FPRC;

|PROCESO MoConta; |TIPO 7;
     |CAMPO_MODIFICA #0#23, 1, "S";
     |CAMPO_MODIFICA #0#72, 1, "S";
     |SI eaPathContagen = "";
         |CAMPO_MODIFICA #0#23, 1, "N";
         |CAMPO_MODIFICA #0#72, 1, "N";
         #0#23 = "N";  |PINTA #0#23;
         #0#72 = "N";  |PINTA #0#72;
     |FINSI;
|FPRC;

|| ***********************************************************************
||                  PROCESO MODIFICACIONES DE LAS APLICACIONES
|| ***********************************************************************

|PROCESO GrabaFacturar;
     aDef      = eaPathFacturar + "def/asclient.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     emprefac  = ("00" + #0#40) % -102;
     particion =  eaPathFacturar + "fich/" + emprefac + "/";
     |PATH_DAT #900 particion;

     |ABRE #900;
     #900#0 = #0#0;
     |LEE 101#900=;
     |SI FSalida = 0;
         #900#1  = #0#1;
         #900#2  = #0#2;
         nada    = #0#4; |QBF nada;
         nada  = nada + ", " + #0#5;
         #900#3  = nada;
         #900#4  = #0#9;
         #900#5  = #0#10;
         #900#6  = #0#11;
         #900#7  = #0#12;
         #900#8  = #0#13;
         #900#9  = #0#14;
         #900#10 = #0#15;
         #900#53 = #0#79;
         #900#11 = #0#80;
         #900#13 = #0#81 + #0#82 + #0#83;
         #900#14 = #0#84;
         |GRABA 0202#900a;
         |LIBERA #900;
    |FINSI;
    |CIERRA #900;

    |DESCARGA_DEF #cliente@;
|FPRC;

|PROCESO GrabaLaboral;
     aDef      = eaPathLaboral + "def/labempre.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     #900#0 = #0#0;
     #900#1 = 1;
     |LEE 101#900];
     |ET masnomi;
         |SI FSalida = 0;
             |SI #900#0  = #0#0;
                 #900#0  = #0#0;
                 #900#2  = #0#1;
                 #900#3  = #0#42;
                 #900#4  = #0#43;
                 #900#5  = #0#45;
                 #900#6  = #0#49;
                 #900#7  = #0#47;
                 #900#8  = #0#48;
                 #900#9  = #0#50;
                 #900#10 = #0#13;
                 #900#111 = #0#14;
                 |GRABA 020#900a;
                 |LEE 140#900s;
                 |LIBERA #900;
                 |VETE masnomi;
             |FINSI;
             |LIBERA #900;
         |FINSI;
     |CIERRA #900;
     |DESCARGA_DEF #cliente@;
|FPRC;

|PROCESO GrabaSociedad;
     aDef      = eaPathContasoc + "def/maacceso.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     anyo = 0;
     |BUCLE maacceso;
     |SI anyo = 0; |ACABA; |FINSI;

     |ABRE #900;
     #900#0 = #0#0;
     #900#1 = anyo;
     |LEE 101#900=;
     |SI FSalida = 0;
         #900#2 = #0#1;
         #900#3 = #0#13;
         |GRABA 020#900a;
         |LIBERA #900;
     |FINSI;
     |CIERRA #900;
     |DESCARGA_DEF #cliente@;

     aDef      = eaPathContasoc + "def/maempr01.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     #900#0 = #0#0;
     #900#1 = anyo;
     |LEE 101#900=;
     |SI FSalida = 0;
         #900#2  = #0#1;           || Nombre
         #900#3  = #0#13;          || Nif
         #900#4  = #0#3;           || SG
         #900#5  = #0#4;           || Domicilio
         #900#6  = #0#5;           || Numero
         #900#7  = #0#6;           || Escalera
         #900#8  = #0#7;           || Piso
         #900#9  = #0#8;           || Puerta
         #900#10 = #0#9;           || Codigo Provincia
         #900#11 = #0#10;          || Codigo Poblacion
         #900#12 = #0#16;          || Codigo Postal Alfanumerico
         #900#13 = #0#11;          || Poblacion
         #900#14 = #0#12;          || Provincia
         #900#15 = #0#14;          || Telefono
         |GRABA 020#900a;
         |LIBERA #900;
     |FINSI;
     |CIERRA #900;
     |DESCARGA_DEF #cliente@;
|FPRC;

|PROCESO GrabaRenta94;
     aDef      = eaPathRen1994 + "def/redatcon.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     #900#0 = #0#0;
     |LEE 101#900=;
     |SI FSalida = 0;
         #900#1  = #0#2;
         #900#2  = #0#13;
         #900#6  = #0#3;
         #900#7  = #0#4;
         #900#8  = #0#5;
         #900#9  = #0#6;
         #900#10 = #0#7;
         #900#11 = #0#8;
         #900#12 = #0#9;
         #900#13 = #0#10;
         #900#14 = #0#11;
         #900#15 = #0#14;
         #900#16 = #0#16;
         |GRABA 020#900a;
         |LIBERA #900;
     |FINSI;
     |CIERRA #900;
     |DESCARGA_DEF #cliente@;

     aDef      = eaPathRen1994 + "def/reacceso.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     #900#0 = #0#0;
     |LEE 101#900=;
     |SI FSalida = 0;
         #900#1  = #0#2;
         #900#2  = #0#13;
         |GRABA 020#900a;
         |LIBERA #900;
     |FINSI;
     |CIERRA #900;
     |DESCARGA_DEF #cliente@;
|FPRC;

|PROCESO GrabaRenta95;
     aDef      = eaPathRen1995 + "def/redatcon.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     #900#0 = #0#0;
     |LEE 101#900=;
     |SI FSalida = 0;
         #900#1  = #0#2;
         #900#2  = #0#13;
         #900#6  = #0#3;
         #900#7  = #0#4;
         #900#8  = #0#5;
         #900#9  = #0#6;
         #900#10 = #0#7;
         #900#11 = #0#8;
         #900#12 = #0#9;
         #900#13 = #0#10;
         #900#14 = #0#11;
         #900#15 = #0#14;
         #900#16 = #0#16;
         |GRABA 020#900a;
         |LIBERA #900;
     |FINSI;
     |CIERRA #900;
     |DESCARGA_DEF #cliente@;

     aDef      = eaPathRen1995 + "def/reacceso.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     #900#0 = #0#0;
     |LEE 101#900=;
     |SI FSalida = 0;
         #900#1  = #0#2;
         #900#2  = #0#13;
         |GRABA 020#900a;
         |LIBERA #900;
     |FINSI;
     |CIERRA #900;
     |DESCARGA_DEF #cliente@;
|FPRC;

|PROCESO GrabaRenta96;
     aDef      = eaPathRen1996 + "def/redatcon.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     #900#0 = #0#0;
     |LEE 101#900=;
     |SI FSalida = 0;
         #900#1  = #0#2;
         #900#2  = #0#13;
         #900#6  = #0#3;
         #900#7  = #0#4;
         #900#8  = #0#5;
         #900#9  = #0#6;
         #900#10 = #0#7;
         #900#11 = #0#8;
         #900#12 = #0#9;
         #900#13 = #0#10;
         #900#14 = #0#11;
         #900#15 = #0#14;
         #900#16 = #0#16;
         |GRABA 020#900a;
         |LIBERA #900;
     |FINSI;
     |CIERRA #900;
     |DESCARGA_DEF #cliente@;

     aDef      = eaPathRen1996 + "def/reacceso.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     #900#0 = #0#0;
     |LEE 101#900=;
     |SI FSalida = 0;
         #900#1  = #0#2;
         #900#2  = #0#13;
         |GRABA 020#900a;
         |LIBERA #900;
     |FINSI;
     |CIERRA #900;
     |DESCARGA_DEF #cliente@;
|FPRC;

|PROCESO GrabaRenta97;
     aDef      = eaPathRen1997 + "def/redatcon.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     #900#0 = #0#0;
     |LEE 101#900=;
     |SI FSalida = 0;
         #900#1  = #0#2;
         #900#2  = #0#13;
         #900#6  = #0#3;
         #900#7  = #0#4;
         #900#8  = #0#5;
         #900#9  = #0#6;
         #900#10 = #0#7;
         #900#11 = #0#8;
         #900#12 = #0#9;
         #900#13 = #0#10;
         #900#14 = #0#11;
         #900#15 = #0#14;
         #900#16 = #0#16;
         |GRABA 020#900a;
         |LIBERA #900;
     |FINSI;
     |CIERRA #900;
     |DESCARGA_DEF #cliente@;

     aDef      = eaPathRen1997 + "def/reacceso.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     #900#0 = #0#0;
     |LEE 101#900=;
     |SI FSalida = 0;
         #900#1  = #0#2;
         #900#2  = #0#13;
         |GRABA 020#900a;
         |LIBERA #900;
     |FINSI;
     |CIERRA #900;
     |DESCARGA_DEF #cliente@;
|FPRC;

|PROCESO GrabaRenta98;
     aDef      = eaPathRen1998 + "def/redatcon.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     #900#0 = #0#0;
     |LEE 101#900=;
     |SI FSalida = 0;
         #900#1  = #0#2;
         #900#2  = #0#13;
         #900#6  = #0#3;
         #900#7  = #0#4;
         #900#8  = #0#5;
         #900#9  = #0#6;
         #900#10 = #0#7;
         #900#11 = #0#8;
         #900#12 = #0#9;
         #900#13 = #0#10;
         #900#14 = #0#11;
         #900#15 = #0#14;
         #900#16 = #0#16;
         |GRABA 020#900a;
         |LIBERA #900;
     |FINSI;
     |CIERRA #900;
     |DESCARGA_DEF #cliente@;

     aDef      = eaPathRen1998 + "def/reacceso.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     #900#0 = #0#0;
     |LEE 101#900=;
     |SI FSalida = 0;
         #900#1  = #0#2;
         #900#2  = #0#13;
         |GRABA 020#900a;
         |LIBERA #900;
     |FINSI;
     |CIERRA #900;
     |DESCARGA_DEF #cliente@;
|FPRC;

|PROCESO GrabaRenta99;
     aDef      = eaPathRen1999 + "def/rem00100.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     #900#0 = #0#0;
     |LEE 140#900=;
     |SI FSalida = 0;
         #900#5  = #0#2;
         #900#1  = #0#13;
         #900#14 = #0#3;
         #900#15 = #0#4;
         #900#16 = #0#5;
         #900#17 = #0#6;
         #900#18 = #0#7;
         #900#19 = #0#8;
         #900#20 = #0#9;
         #900#21 = #0#10;
         #900#22 = #0#11;
         #900#12 = #0#14;
         #900#23 = #0#16;
         |GRABA 020#900a;
    |FINSI;
    |CIERRA #900;
    |DESCARGA_DEF #cliente@;

     aDef      = eaPathRen1999 + "def/reacceso.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     #900#0 = #0#0;
     |LEE 101#900=;
     |SI FSalida = 0;
         #900#1  = #0#2;
         #900#2  = #0#13;
         |GRABA 020#900a;
         |LIBERA #900;
     |FINSI;
     |CIERRA #900;
     |DESCARGA_DEF #cliente@;
|FPRC;

|PROCESO GrabaRenta00;
|FPRC;

|PROCESO GrabaRentas;
     |SI eaPathRen2000 ! "";  |HAZ GrabaRenta00;  |ACABA;  |FINSI;
     |SI eaPathRen1999 ! "";  |HAZ GrabaRenta99;  |ACABA;  |FINSI;
     |SI eaPathRen1998 ! "";  |HAZ GrabaRenta98;  |ACABA;  |FINSI;
     |SI eaPathRen1997 ! "";  |HAZ GrabaRenta97;  |ACABA;  |FINSI;
     |SI eaPathRen1996 ! "";  |HAZ GrabaRenta96;  |ACABA;  |FINSI;
     |SI eaPathRen1995 ! "";  |HAZ GrabaRenta95;  |ACABA;  |FINSI;
     |SI eaPathRen1994 ! "";  |HAZ GrabaRenta94;  |ACABA;  |FINSI;
|FPRC;

|PROCESO GrabaPortada;
     |ABRE #901;
     #901#0 = #agifigen#0;
     #901#1 = #900#26;
     |LEE 101#901=;
     |SI FSalida = 0;
                  ||************************** DATOS GENERALES

        #901#2  = #agifigen#1;      || Nombre
        #901#13 = #agifigen#13;     || DNI
        #901#3  = #agifigen#3;      || SG
        #901#4  = #agifigen#4;      || Calle
        #901#5  = #agifigen#5;      || Numero
        #901#6  = #agifigen#6;      || Escalera
        #901#7  = #agifigen#7;      || Piso
        #901#8  = #agifigen#8;      || Puerta
        #901#9  = #agifigen#9;      || Cod.Postal (Provincia)
        #901#10 = #agifigen#10;     || Cod.Postal (Poblacion)
        #901#11 = #agifigen#11;     || Poblacion
        #901#12 = #agifigen#12;     || Provincia
        #901#14 = #agifigen#14;     || Telefono
        #901#16 = #agifigen#63;     || Codigo Hacienda (Delegacion)
        #901#17 = #agifigen#64;     || Codigo Hacienda (Administracion)
        #901#18 = #agifigen#91;     || Nombre Deleg. Hacienda
        #901#19 = #agifigen#92;     || Nombre Admin. Hacienda
        #901#66 = #agifigen#81;     || Nombre Banco
        #901#67 = #agifigen#82;     || Entidad
        #901#68 = #agifigen#83;     || Sucursal
        #901#69 = #agifigen#84;     || DC
        #901#70 = #agifigen#80;     || Cuenta

                  ||************************** DATOS DE ACTIVIDADES

        |ABRE #agicen01;
        Campo2 = 32;
        Campo3 = 20;
        #agicen01#0 = #agifigen#0;
        #agicen01#1 = 1;
        |LEE 010#agicen01.];
        FEstado = FSalida;
        |SI #agifigen#0 ! #agicen01#0; FEstado = -1; |FINSI;

        |PARA Cont = 0; |SI Cont [ 5; |HACIENDO Cont = Cont + 1;
           |SI FEstado = 0;
               #901#Campo2# = #agicen01#2 + #agicen01#3;  || Epigrafe
               #901#Campo3# = #agicen01#4;  || Nombre Actividad
               Campo2 = Campo2 + 1;
               Campo3 = Campo3 + 1;
           |FINSI;
           |LEE 010#agicen01.s;
           |SI FSalida ! 0; |SAL; |FINSI;
           |SI #agifigen#0 ! #agicen01#0; |SAL; |FINSI;
           FEstado = FSalida;
        |SIGUE;
        |CIERRA #agicen01;

                   ||************************** DATOS DE REPRESENTANTES


        Campo1 = 53;
        Campo2 = 51;
        Campo3 = 54;
        Campo4 = 55;
        |ABRE #agim0004;
        #agim0004#0 = #agifigen#0;
        #agim0004#1 = 1;
        |LEE 010#agim0004.];
        FEstado = FSalida;
        |SI #agim0004#0 ! #agifigen#0; FEstado = -1; |FINSI;

        |PARA Cont = 0; |SI Cont [ 3; |HACIENDO Cont = Cont + 1;
            |SI FEstado = 0;
                |SI Cont = 0;
                    #901#38 = #agim0004#2;
                    #901#39 = #agim0004#3;
                    #901#41 = #agim0004#6;
                    #901#42 = #agim0004#7;
                    #901#47 = #agim0004#8;
                    #901#48 = #agim0004#9;
                    #901#49 = #agim0004#10;
                    #901#50 = #agim0004#11;
                    #901#46 = #agim0004#12;
                |SINO;
                    #901#Campo1# = #agim0004#2;
                    #901#Campo2# = #agim0004#3;
                    #901#Campo3# = #agim0004#4;
                    #901#Campo4# = #agim0004#5;
                    Campo1 = Campo1 + 5;
                    Campo2 = Campo2 + 5;
                    Campo3 = Campo3 + 5;
                    Campo4 = Campo4 + 5;
                |FINSI;
            |FINSI;
            |LEE 010#agim0004.s;
            |SI FSalida ! 0; |SAL; |FINSI;
            |SI #agim0004#0 ! #agifigen#0; |SAL; |FINSI;
             FEstado = FSalida;
        |SIGUE;
        |CIERRA #agim0004;

        |GRABA 020#901a;
   |FINSI;
   |LIBERA #901;
   |CIERRA #901;
|FPRC;

|PROCESO GrabaContagen;
     aDef      = eaPathContagen + "def/canempre.mas";
     |CARGA_DEF aDef, cliente@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     aDef      = eaPathContagen + "def/caportad.mas";
     |CARGA_DEF aDef, portada@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #900;
     |SI FSalida = 0;
         |PARA periodo = 0; |SI periodo [ 9; |HACIENDO periodo = periodo + 1;
               #900#2 = #0#0;
               #900#3 = periodo;
               |LEE 101#900=;
               |SI FSalida = 0;
                   alfa1 = #0#0; alfa1 = "00000" + alfa1; alfa1 = alfa1 % -105;
                   alfa2 = periodo;
                   alfa3 = alfa1 + alfa2;
                   #900#0 = alfa3;      || codigo+periodo
                   #900#1 = #0#1;       || nombre comercial
                   #900#2 = #0#0;       || codigo empresa
                   #900#3 = periodo;    || periodo
                   #900#4 = #0#1;       || razon social
                   nada = #0#4;   |QBF nada;
                   nada = nada + ", " + #0#5;
                   #900#5 = nada;       || direccion
                   #900#6 = #0#16;      || codigo postal
                   #900#7 = #0#11;      || poblacion
                   #900#8 = #0#13;      || cif
                   #900#9 = #0#14;      || telefono
                   #900#10= #0#15;      || fax
                   |GRABA 020#900a;
                   Comodin = ("00000" + #900#2) % -105;
                   Comodin = Comodin + #900#3;
                   |QBF Comodin;
                   Comodin = eaPathContagen + "fich/" + Comodin + "/";

                   |PATH_DAT #901Comodin;
                   |HAZ GrabaPortada;
               |FINSI;
               |LIBERA #900;
         |SIGUE;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #portada@;
     |DESCARGA_DEF #cliente@;
|FPRC;

|PROCESO modifica; |TIPO 30;
     juan = (FEntrada / 100) ! 0;

     |ABRE #528;
     #528#0 = #0#0;
     |LEE 101#528=;
      |SI FSalida = 0;
          #528#1 = #0#1;
          #528#2 = #0#2;
          #528#3 = #0#13;
          #528#4 = #0#62;
          #528#5 = #0#14;
          #0#21  = "S";

          |GRABA 020#528a;
          |LIBERA #528;
     |FINSI;
     |CIERRA #528;

     |ABRE #500;
     #500#0 = #0#13;   || cif
     |LEE 101#500=;
     |SI FSalida ! 0;
         |DDEFECTO #500;
         #500#0  = #0#13;   || cif
         |GRABA 020#500b;
     |FINSI;

     #500#1  = #0#1;    || Nombre
     #500#9  = #0#3;    || SG
     #500#2  = #0#4;    || Direccion
     #500#3  = #0#5;    || Numero
     #500#10 = #0#7;    || Piso
     #500#11 = #0#8;    || Puerta
     #500#4  = #0#9;    || Codigo provincia
     #500#5  = #0#10;   || Codigo poblacion
     #500#7  = #0#12;   || Provincia
     #500#6  = #0#11;   || Poblaciones
     |GRABA 020#500a;
     |LIBERA #500;
     |CIERRA #500;

     |ABRE #501;
     #501#0 = #0#1;   || Nombre cliente
     |LEE 101#501=;
     |SI FSalida ! 0;
         |DDEFECTO #501;
         #501#0 = #0#1;   || Nombre cliente
         |GRABA 020#501b;
     |FINSI;

     #501#1  = #0#11;   || Poblaciones
     #501#2  = #0#12;   || Provincia
     #501#4  = #0#14;   || Telefono
     #501#6  = #0#15;   || Fax

     enCodProv = #0#9;
     |HAZ LeeProvincia;

     #501#3 = #700#2;

     |GRABA 020#501a;
     |LIBERA #501;
     |CIERRA #501;

     |SI juan ! 2; |ACABA; |FINSI;

     |CONFI confor;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |ABRE #19;
     #19#0 = #0#1;
     |LEE 101#19=;
     |SI FSalida = 0;
         #19#1 = #0#11;
         #19#2 = #0#12;
         #19#4 = #0#14;
         #19#6 = #0#15;
         |GRABA 020#19a;
         |LIBERA #19;
     |FINSI;
     |CIERRA #19;

     |SI #0#17 = "S";   |HAZ GrabaFacturar;   |FINSI;
     |SI #0#18 = "S";   |HAZ GrabaLaboral;    |FINSI;
     |SI #0#20 = "S";   |HAZ GrabaSociedad;   |FINSI;
     |SI #0#22 = "S";   |HAZ GrabaRentas;     |FINSI;
     |SI #0#23 = "S";   |HAZ GrabaContagen;   |FINSI;
|FPRC;
