|FICHEROS;
     agifigen #1;
     agicen20 #20;
     agicen21 #21;
     agicen22 #22;
     agicen23 #23;
     agicen24 #24;
     agicen25 #25;

     agiy0001 #999,MANTE;

     agicen42 #42;
     agicen43 #43;
     agicen44 #44;
     agicen45 #45;
     agicen46 #46;
     agicen47 #47;
     agicen48 #480;
     agicen49 #49;
     agicen50 #50;
     agicen51 #51;
     agicen52 #52;
     agicen53 #53;
|FIN;

|VARIABLES;
     aAlfa        = "";
     aTipo1       = "";
     aTipo2       = "";
     aTipoAnt     = "";
     nExiste      = 0;
     nForma       = 0;
     nModo        = 0;
     nEmpresa     = 0;
     nRegistro    = 0;
     nDEmpresa    = 0;
     nHEmpresa    = 0;

     &enEmpresa   = 0;
     &enModo      = 0;
     &eaNombreEmp = "";
     &enRegistro  = 0;
     &eaTipo      = "";
     &enOpcion    = 0;
     &eaParametro = "";

     &eaRef036    = "";
     &efFec036    = "";

     fFecha       = @;

 {-1} aMenu    = "";
      aMenu1   = "1209";
      aMenu2   = "1";
      aMenu3   = "10";
      aMenu4   = "Datos Identificativos                                            ";
      aMenu5   = "Causas presentacion declaracion censal                           ";
      aMenu6   = "Datos tributarios de caracter general                            ";
      aMenu7   = "Declaracion de actividades y locales                             ";
      aMenu8   = "Impuesto sobre el Valor A¤adido                                  ";
      aMenu9   = "Impuesto sobre IRPF, Sociedades y No Residentes                  ";
      aMenu10  = "Retenciones, ingresos a cuenta, Impuestos especiales y otros     ";
      aMenu11  = "Anexo I: Relacion de socios, herederos, miembros o participes    ";
      aMenu12  = "Anexo II: Regimenes especiales comercio intracomunitario         ";
      aMenu13  = "Emision del Modelo en PDF o Fichero para Internet.               ";

     aOpcion = "";
     nVersion = 0;

     &eaUnidadBasico = "";
|FIN;

|PROCESO Version;  |TIPO 7;
     || PARA ACTIVAR CUANDO ENTRE EN VIGOR Y ESTE TERMINADO TODO ESTO
     || CON ESTO AUTOMATICAMENTE SE DAN DE ALTA LOS NUEVOS COMO DEL A¤O 2007
     || CON LO QUE LOS MODELOS QUE SE EMITIRAN SERAN LOS NUEVOS
     || ADEMAS DE ESTO HAY QUE PONER EL CAMPO A¥O (VERSION) EN LA PANTALLA
     || DEBAJO DE "Modelo 036"

     fFecha = ~;
     nModo = (FEntrada / 100) ! 0;
     |SI fFecha ] "01.07.2007"; |Y nModo = 1;
          #20#8 = 2007;
          |PINTA #20#8;
     |FINSI;
     |SI fFecha ] "01.07.2013"; |Y nModo = 1;
          #20#8 = 2013;
          |PINTA #20#8;
     |FINSI;
|FPRC;

|PROCESO Tipo7;  |TIPO 7;
     |SI eaParametro = "";  |ACABA;  |FINSI;

     |MENSA "0000 <F2> Emitir Registro.";

     |ABRE #1;
     #1#0 = #20#0;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     #20#5 = #1#1;

     |PINTA 0702, #20#0;
     |PINTA 0710, #20#5;
|FPRC;

|PROCESO AntesFecha; |TIPO 7;
  fFecha = ~;
  |SI #20Campo [ "01.01.0000";
      #20Campo = fFecha; |PINTA #20Campo;
  |FINSI;
|FPRC;

|PROCESO Tipo11;  |TIPO 11;
     |SI FSalida     ! 10;  |ACABA;  |FINSI;
     |SI eaParametro = "";  |ACABA;  |FINSI;

     |LEE 101#21=;

     enEmpresa  = #20#0;
     enRegistro = #20#1;
     eaTipo     = #20#3;

     |ABRE #22;
     #22#0 = #20#0;
     #22#1 = #20#1;
     |LEE 040#22=;
     |SI FSalida ! 0;  |DDEFECTO #22;  |FINSI;
     |CIERRA #22;

     |SI #20#8 = 2003;
          |HAZ EmiteEsto;
     |SINO;
          |SUB_EJECUTA_NP "agicen40;EMISION";
     |FINSI;

     |LIBERA #21;
|FPRC;

|PROCESO agicen53G;
     #53#1 = nRegistro;
     |GRABA 020#53n;
     |LIBERA #53;
|FPRC;

|DEFBUCLE agicen53G;
     #53#1;
     ;
     #20#0, #20#1, 01;
     #20#0, #20#1, 99;
     be;
     NULL, agicen53G;
|FIN;


|PROCESO agicen480G;
     #480#1 = nRegistro;
     |GRABA 020#480n;
     |LIBERA #480;
|FPRC;

|DEFBUCLE agicen480G;
     #480#1;
     ;
     #20#0, #20#1, 01, 01;
     #20#0, #20#1, 99, 99;
     be;
     NULL, agicen480G;
|FIN;

|PROCESO agicen47G;
     #47#1 = nRegistro;
     |GRABA 020#47n;
     |LIBERA #47;
|FPRC;

|DEFBUCLE agicen47G;
     #47#1;
     ;
     #20#0, #20#1, 01;
     #20#0, #20#1, 99;
     be;
     NULL, agicen47G;
|FIN;

|PROCESO agicen46G;
     #46#1 = nRegistro;
     |GRABA 020#46n;
     |LIBERA #46;
|FPRC;

|DEFBUCLE agicen46G;
     #46#1;
     ;
     #20#0, #20#1, 01;
     #20#0, #20#1, 99;
     be;
     NULL, agicen46G;
|FIN;

|PROCESO RegAnterior2007;
     nEmpresa  = #20#0;
     nRegistro = #20#1;
     aTipo1    = #20#3;
     aTipo2    = #20#4;
     nVersion  = #20#8;

     |SALVA_FICHA #20;
     |LEE 040#20a;
     |SI #20#0 = nEmpresa;
          |SI nVersion = #20#8;
               aTipo1    = #20#3;
               aTipo2    = #20#4;

               |ABRE #42;
               #42#0 = #20#0;
               #42#1 = #20#1;
               |LEE 101#42=;
               |SI FSalida = 0;
                   #42#1 = nRegistro;
                   |GRABA 020#42n;
                   |LIBERA #42;
               |FINSI;
               |CIERRA #42;

               |ABRE #43;
               #43#0 = #20#0;
               #43#1 = #20#1;
               |LEE 101#43=;
               |SI FSalida = 0;
                   #43#1 = nRegistro;
                   |GRABA 020#43n;
                   |LIBERA #43;
               |FINSI;
               |CIERRA #43;

               |ABRE #44;
               #44#0 = #20#0;
               #44#1 = #20#1;
               |LEE 101#44=;
               |SI FSalida = 0;
                   #44#1 = nRegistro;
                   |GRABA 020#44n;
                   |LIBERA #44;
               |FINSI;
               |CIERRA #44;

               |ABRE #45;
               #45#0 = #20#0;
               #45#1 = #20#1;
               |LEE 101#45=;
               |SI FSalida = 0;
                   #45#1 = nRegistro;
                   |GRABA 020#45n;
                   |LIBERA #45;
               |FINSI;
               |CIERRA #45;

               |ABRE #49;
               #49#0 = #20#0;
               #49#1 = #20#1;
               |LEE 101#49=;
               |SI FSalida = 0;
                   #49#1 = nRegistro;
                   |GRABA 020#49n;
                   |LIBERA #49;
               |FINSI;
               |CIERRA #49;

               |ABRE #50;
               #50#0 = #20#0;
               #50#1 = #20#1;
               |LEE 101#50=;
               |SI FSalida = 0;
                   #50#1 = nRegistro;
                   |GRABA 020#50n;
                   |LIBERA #50;
               |FINSI;
               |CIERRA #50;

               |ABRE #51;
               #51#0 = #20#0;
               #51#1 = #20#1;
               |LEE 101#51=;
               |SI FSalida = 0;
                   #51#1 = nRegistro;
                   |GRABA 020#51n;
                   |LIBERA #51;
               |FINSI;
               |CIERRA #51;

               |ABRE #52;
               #52#0 = #20#0;
               #52#1 = #20#1;
               |LEE 101#52=;
               |SI FSalida = 0;
                   #52#1 = nRegistro;
                   |GRABA 020#52n;
                   |LIBERA #52;
               |FINSI;
               |CIERRA #52;

               |BUCLE agicen46G;    || Representantes
               |BUCLE agicen47G;    || Actividades
               |BUCLE agicen480G;    || Locales
               |BUCLE agicen53G;    || Socios
          |SINO;
               aAlfa = "    ATENCION: No se pueden copiar los datos del registro anterior";
               aAlfa = aAlfa + " por ser de una versión diferente";
               |MENAV aAlfa;
          |FINSI;
     |FINSI;
     |REPON_FICHA #20;

     || #20#3 = aTipo1;  |PINTA #20#3;
     || #20#4 = aTipo2;  |PINTA #20#4;
|FPRC;

|PROCESO agicen23G;
     #23#1 = nRegistro;
     |GRABA 020#23n;
     |LIBERA #23;
|FPRC;

|DEFBUCLE agicen23G;
     #23#1;
     ;
     #20#0, #20#1, 01;
     #20#0, #20#1, 99;
     be;
     NULL, agicen23G;
|FIN;

|PROCESO agicen24G;
     #24#1 = nRegistro;
     |GRABA 020#24n;
     |LIBERA #24;
|FPRC;

|DEFBUCLE agicen24G;
     #24#1;
     ;
     #20#0, #20#1, 01, 01;
     #20#0, #20#1, 99, 99;
     be;
     NULL, agicen24G;
|FIN;

|PROCESO agicen25G;
     #25#1 = nRegistro;
     |GRABA 020#25n;
     |LIBERA #25;
|FPRC;

|DEFBUCLE agicen25G;
     #25#1;
     ;
     #20#0, #20#1, 01;
     #20#0, #20#1, 99;
     be;
     NULL, agicen25G;
|FIN;

|PROCESO RegistroAnterior;
     nEmpresa  = #20#0;
     nRegistro = #20#1;
     aTipo1    = #20#3;
     aTipo2    = #20#4;
     nVersion  = #20#8;

     |SALVA_FICHA #20;
     |LEE 040#20a;
     |SI #20#0 = nEmpresa;
          |SI nVersion = #20#8;
               aTipo1    = #20#3;
               aTipo2    = #20#4;

               |ABRE #21;
               #21#0 = #20#0;
               #21#1 = #20#1;
               |LEE 101#21=;
               |SI FSalida = 0;
                   #21#1 = nRegistro;
                   |GRABA 020#21n;
                   |LIBERA #21;
               |FINSI;
               |CIERRA #21;

               |ABRE #22;
               #22#0 = #20#0;
               #22#1 = #20#1;
               |LEE 101#22=;
               |SI FSalida = 0;
                   #22#1 = nRegistro;
                   |GRABA 020#22n;
                   |LIBERA #22;
               |FINSI;
               |CIERRA #22;

               |BUCLE agicen23G;
               |BUCLE agicen24G;
               |BUCLE agicen25G;
          |SINO;
               aAlfa = "    ATENCION: No se pueden copiar los datos del registro anterior";
               aAlfa = aAlfa + " por ser de una versión diferente";
               |MENAV aAlfa;
          |FINSI;
     |FINSI;
     |REPON_FICHA #20;

     || #20#3 = aTipo1;  |PINTA #20#3;
     || #20#4 = aTipo2;  |PINTA #20#4;
|FPRC;

|PROCESO Mensaje;  |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;  |Y #20#1 ! 1;
         |CONFI "0000SRecoger datos del Registro Anterior";
         |SI FSalida = 0;
             |SI #20#8 = 2003;
                  |HAZ RegistroAnterior;
             |SINO;
                  |HAZ RegAnterior2007;
             |FINSI;
         |FINSI;
     |FINSI;

     |PUSHV 0501 2380;
     |BLANCO 0501 1080;
     |CUADRO 0501 1080;

     |ATRI S;
     |SI #20#8 = 2003;
          |PINTA 0602, "<A> Persona fisica residente";
          |PINTA 0702, "<B> Persona juridica o entidad residente o constituida en Espa¤a";
          |PINTA 0802, "<C> Persona o entidad no residente o constituida en el extranjero";
          |PINTA 0902, "<D> Establecimiento permanente de una persona juridica o entidad no residente";
     |SINO;
          |PINTA 0602, "<A> Persona física";
          |PINTA 0702, "<B> Persona jurídica o entidad";
          |PINTA 0802, "<C> Establecimiento permanente de una persona jurídica o entidad no residente";
     |FINSI;
     |ATRI s;
|FPRC;

|PROCESO VerExiste;
    nExiste = 0;
    |SI aTipoAnt = "A";
        |ABRE #agicen43;
        #agicen43#0 = enEmpresa;
        #agicen43#1 = enRegistro;
        |LEE 041#agicen43.=;
        |SI FSalida = 0;
            nExiste = 1;
        |FINSI;
        |CIERRA #agicen43;
    |FINSI;
    |SI aTipoAnt = "B";
        |ABRE #agicen44;
        #agicen44#0 = enEmpresa;
        #agicen44#1 = enRegistro;
        |LEE 041#agicen44.=;
        |SI FSalida = 0;
            nExiste = 1;
        |FINSI;
        |CIERRA #agicen44;
    |FINSI;
    |SI aTipoAnt = "C";
        |ABRE #agicen45;
        #agicen45#0 = enEmpresa;
        #agicen45#1 = enRegistro;
        |LEE 041#agicen45.=;
        |SI FSalida = 0;
            nExiste = 1;
        |FINSI;
        |CIERRA #agicen45;
    |FINSI;
    |SI nExiste = 1;
        |CONFI "0000NDesea cambiar el tipo Identificacion, ya existen datos";
        |SI FSalida = 0;
            nExiste = 0;
        |FINSI;
    |FINSI;
|FPRC;

|PROCESO Identificacion;
     aTipoAnt  = Contenido;
     nModo     = (FEntrada / 100) ! 0;
     enEmpresa  = #20#0;
     enRegistro = #20#1;
     |SI #20#8 = 2003;
          |SI #20#3 = "A";  #20#4 = "PERS.FISICA ";  |FINSI;
          |SI #20#3 = "B";  #20#4 = "JURD.O E.RES";  |FINSI;
          |SI #20#3 = "C";  #20#4 = "NO RESIDENTE";  |FINSI;
          |SI #20#3 = "D";  #20#4 = "ESTAB.NO RES";  |FINSI;
     |SINO;
          |SI #20#3 = "A";  #20#4 = "PERS. FISICA";  |FINSI;
          |SI #20#3 = "B";  #20#4 = "JUR. O ENT. ";  |FINSI;
          |SI #20#3 = "C";  #20#4 = "ESTAB.NO RES";  |FINSI;
          |SI #20#3 = "D";
               |ERROR;
               |POPV;
               |ACABA;
          |FINSI;
          |SI aTipoAnt ! #20#3; |Y nModo = 2;
              |HAZ VerExiste;
              |SI nExiste = 1;
                  #20#3 = aTipoAnt;
                  |PINTA #20#3;
                  |ERROR;
              |FINSI;
          |FINSI;
     |FINSI;
     |POPV;
     || PINTA #20#4;
|FPRC;

|PROCESO agicen23B;
     |BORRA 020#23a;
     |LIBERA #23;
|FPRC;

|DEFBUCLE agicen23B;
     #23#1;
     ;
     #20#0, #20#1, 01;
     #20#0, #20#1, 99;
     be;
     NULL, agicen23B;
|FIN;

|PROCESO agicen24B;
     |BORRA 020#24a;
     |LIBERA #24;
|FPRC;

|DEFBUCLE agicen24B;
     #24#1;
     ;
     #20#0, #20#1, 01, 01;
     #20#0, #20#1, 99, 99;
     be;
     NULL, agicen24B;
|FIN;

|PROCESO agicen25B;
     |BORRA 020#25a;
     |LIBERA #25;
|FPRC;

|DEFBUCLE agicen25B;
     #25#1;
     ;
     #20#0, #20#1, 01;
     #20#0, #20#1, 99;
     be;
     NULL, agicen25B;
|FIN;

|PROCESO agicen53B;
     |BORRA 020#53a;
     |LIBERA #53;
|FPRC;

|DEFBUCLE agicen53B;
     #53#1;
     ;
     #20#0, #20#1, 01;
     #20#0, #20#1, 99;
     be;
     NULL, agicen53B;
|FIN;

|PROCESO agicen480B;
     |BORRA 020#480a;
     |LIBERA #480;
|FPRC;

|DEFBUCLE agicen480B;
     #480#1;
     ;
     #20#0, #20#1, 01, 01;
     #20#0, #20#1, 99, 99;
     be;
     NULL, agicen480B;
|FIN;

|PROCESO agicen47B;
     |BORRA 020#47a;
     |LIBERA #47;
|FPRC;

|DEFBUCLE agicen47B;
     #47#1;
     ;
     #20#0, #20#1, 01;
     #20#0, #20#1, 99;
     be;
     NULL, agicen47B;
|FIN;

|PROCESO agicen46B;
     |BORRA 020#46a;
     |LIBERA #46;
|FPRC;

|DEFBUCLE agicen46B;
     #46#1;
     ;
     #20#0, #20#1, 01;
     #20#0, #20#1, 99;
     be;
     NULL, agicen46B;
|FIN;

|PROCESO BorraFicheros;
     |ABRE #21;
     #21#0 = #20#0;
     #21#1 = #20#1;
     |BORRA 000#21c;
     |LIBERA #21;
     |CIERRA #21;

     |ABRE #22;
     #22#0 = #20#0;
     #22#1 = #20#1;
     |BORRA 000#22c;
     |LIBERA #22;
     |CIERRA #22;

     |BUCLE agicen23B;
     |BUCLE agicen24B;
     |BUCLE agicen25B;

     || LOS DEL 2007

     |ABRE #42;
     #42#0 = #20#0;
     #42#1 = #20#1;
     |BORRA 000#42c;
     |LIBERA #42;
     |CIERRA #42;

     |ABRE #43;
     #43#0 = #20#0;
     #43#1 = #20#1;
     |BORRA 000#43c;
     |LIBERA #43;
     |CIERRA #43;

     |ABRE #44;
     #44#0 = #20#0;
     #44#1 = #20#1;
     |BORRA 000#44c;
     |LIBERA #44;
     |CIERRA #44;

     |ABRE #45;
     #45#0 = #20#0;
     #45#1 = #20#1;
     |BORRA 000#45c;
     |LIBERA #45;
     |CIERRA #45;

     |BUCLE agicen46B;
     |BUCLE agicen47B;
     |BUCLE agicen480B;

     |ABRE #49;
     #49#0 = #20#0;
     #49#1 = #20#1;
     |BORRA 000#49c;
     |LIBERA #49;
     |CIERRA #49;

     |ABRE #50;
     #50#0 = #20#0;
     #50#1 = #20#1;
     |BORRA 000#50c;
     |LIBERA #50;
     |CIERRA #50;

     |ABRE #51;
     #51#0 = #20#0;
     #51#1 = #20#1;
     |BORRA 000#51c;
     |LIBERA #51;
     |CIERRA #51;

     |ABRE #52;
     #52#0 = #20#0;
     #52#1 = #20#1;
     |BORRA 000#52c;
     |LIBERA #52;
     |CIERRA #52;

     |BUCLE agicen53B;
|FPRC;

|PROCESO Alta;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          #20#8 = 2013;
          |PINTA #20#8;
     |FINSI;
|FPRC;

|PROCESO Tipo2;  |TIPO 2;
     nModo = (FEntrada / 100) ! 0;

     |SI nModo = 3;
         |CONFI "0000NSeguro de Borrar el Registro.";
         |SI FSalida = 0;
             |HAZ BorraFicheros;
         |SINO;
             |ERROR;
         |FINSI;
         |ACABA;
     |FINSI;

     nForma = 0 +. 1;

     |SI nForma ! 1;  |ACABA;  |FINSI;

     enEmpresa  = #20#0;
     enRegistro = #20#1;
     eaTipo     = #20#3;
     eaRef036   = #20#6;
     efFec036   = #20#7;

     |SI #20#8 = 2003;
          |PUSHV 0501 2380;
          |BLANCO 0901 2380;

          |ATRI S;
          |PINTA 0905, #20#1;
          |PINTA 0911, #20#2;
          |PINTA 0966, #20#3;
          |PINTA 0968, #20#4;
          |ATRI s;

          enOpcion = 1;
          |PARA; |SI;  |HACIENDO;
               aMenu2 = enOpcion;
               |MENUG aMenu;
               enOpcion = FSalida;
               |SI enOpcion < 1;  |O enOpcion > 10;
                   |SAL;
               |FINSI;


               |ABRE #22;
               #22#0 = #20#0;
               #22#1 = #20#1;
               |LEE 040#22=;
               |SI FSalida ! 0;  |DDEFECTO #22;  |FINSI;
               |CIERRA #22;

               |SI enOpcion = 1;   |SUB_EJECUTA_NP "agicen21";  |FINSI;
               |SI enOpcion = 2;   |SUB_EJECUTA_NP "agicen22";  |FINSI;
               |SI enOpcion = 3;   |SUB_EJECUTA_NP "agicen22";  |FINSI;

               |SI enOpcion = 4;
                   |SI #22#62 = "N";
                       |SUB_EJECUTA_NP "agicen23";
                   |SINO;
                       |MENAV "0000 Para Abrir esta opcion debera marcar con una N la casilla 344 de la pagina 3";
                   |FINSI;
               |FINSI;

               |SI enOpcion = 5;   |SUB_EJECUTA_NP "agicen22";  |FINSI;
               |SI enOpcion = 6;   |SUB_EJECUTA_NP "agicen22";  |FINSI;
               |SI enOpcion = 7;   |SUB_EJECUTA_NP "agicen22";  |FINSI;
               |SI enOpcion = 8;   |SUB_EJECUTA_NP "agicen25";  |FINSI;
               |SI enOpcion = 9;   |SUB_EJECUTA_NP "agicen21";  |FINSI;
               |SI enOpcion = 10;  |HAZ EmiteEsto;              |FINSI;
          |SIGUE;

          |POPV;
     |SINO;

          || AQUI EL SUBEJECUTA QUE ME LLEVARA A EMITIR LOS MODELOS
          || DEL 2007

          |BLANCO 0901 0980;

          |ATRI S;
          |PINTA 0905, #20#1;
          |PINTA 0911, #20#2;
          |PINTA 0966, #20#3;
          |PINTA 0968, #20#4;
          |ATRI s;
          enEmpresa  = #20#0;
          enRegistro = #20#1;
          eaTipo     = #20#3;
          |SUB_EJECUTA_NP "agicen40";
          |PINTA 0901, "ÚÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ";
          |PINTA 0940, "ÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄ¿";
     |FINSI;

     |ABRE #1;
     #1#0 = #20#0;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     #20#5 = #1#1;
|FPRC;

|PROCESO agicen20B;
     |HAZ BorraFicheros;

     |BORRA 020#20a;
     |LIBERA #20;
|FPRC;

|DEFBUCLE agicen20B;
     #20#1;
     ;
     enEmpresa, 00;
     enEmpresa, 99;
     be;
     NULL, agicen20B;
|FIN;

|RUTINA ClaveBaja20;
     #20#0 = nDEmpresa;
     #20#1 = 01;
|FRUT;

|RUTINA ClaveAlta20;
     #20#0 = nHEmpresa;
     #20#1 = 99;
|FRUT;

|PROGRAMA;
     |HAZ LeeUnidadBasico;

     eaParametro = PARAMETRO;  |QBF eaParametro;

     |SI eaParametro ! "";
         |PINPA #0#999;
         |PINTA 1221, "                                           ";
         |PINTA 1321, "                                           ";
         |C_V #999#4, 1, "N";  |C_M #999#4, 1, "N";
         |C_V #999#5, 1, "N";  |C_M #999#5, 1, "N";
         |DDEFECTO #999;
         |PINDA #0#999;
         |ENDATOS #1#999;
         |SI FSalida = 0;
             |CLS;
             |PINPA #0#20;
             |CUADRO 0501 0850;
             |ATRI R;
             |PINTA 0602, "Empresa                                         ";
             |ATRI r;

             nDEmpresa = #999#0;
             nHEmpresa = #999#1;
             |ENTLINEAL #1#20, -2, 4, 22, 0, ClaveBaja20, ClaveAlta20;
          |FINSI;
     |SINO;
         nDEmpresa = enEmpresa;
         nHEmpresa = enEmpresa;

         |SI enModo ! 3;
             |ENTLINEAL #1#20, -2, enModo, 22, 1, ClaveBaja20, ClaveAlta20;
         |SINO;
             |BUCLE agicen20B;
         |FINSI;
     |FINSI;
|FPRO;
