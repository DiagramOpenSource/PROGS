|FICHEROS;
   agiz0001 #0;

   &provinc@ #700;
    agiprovi #701;
    :/integral/def/dsam0100 #702;

   &poblaci@ #703;
    agipobla #704;
    :/integral/def/dsam0101 #705;

   &regisnif@ #709;
    agim0003  #710;
    :/integral/def/dsam0103 #711;

   &sgpaises@ #718;
     agim0016  #719;
     :/integral/def/dsam0104 #720;

   &haciend@ #706;  || no hace falta
    agihacie #707;
    :/integral/def/dsam0102 #708;

   :/integral/def/dsam0114 #721;  || autonimia
|FIN;


|VARIABLES;
   &eaPathIntegral = "";
   &enSwDeDonde    = 0;
   aDNif           = "";
   aHNif           = "";

   nGrabo = 0;
   nExis  = 0;
   aAlfa1 = "";
   nPobl  = 0;
   aPobl  = "";
   nProv  = 0;
   aProv  = "";
   nPais  = 0;
   aPais  = "";
   nAuto  = 0;
   aAuto  = "";
|FIN;

|| *************************************************************
|PROCESO LPobl;
     nExis = 0;
     |ABRE #703;
     #703#0 = nProv;
     #703#1 = nPobl;
     |LEE 040#703=;
     |SI FSalida ! 0;
         |DDEFECTO #703;
         nExis = 1;
     |FINSI;
     |CIERRA #703;
     |SI enSwDeDonde = 0; aPobl = #703#2; |FINSI;
     |SI enSwDeDonde = 1; aPobl = #703#3; |FINSI;
|FPRC;

|PROCESO LProv;
     nExis = 0;
     |ABRE #700;
     #700#0 = nProv;
     |LEE 040#700=;
     |SI FSalida ! 0;
         |DDEFECTO #700;
         nExis = 1;
     |FINSI;
     |CIERRA #700;
     aProv = #700#1;
|FPRC;

|PROCESO LPais;
     nExis = 0;
     |ABRE #718;
     #718#0 = nPais;
     |LEE 040#718=;
     |SI FSalida ! 0;
         |DDEFECTO #718;
         nExis = 1;
     |FINSI;
     |CIERRA #718;
     aPais = #718#1;
|FPRC;

|PROCESO LAuto;
     nExis = 0;
     |ABRE #721;
     #721#0 = nAuto;
     |LEE 040#721=;
     |SI FSalida ! 0;
         |DDEFECTO #721;
         nExis = 1;
     |FINSI;
     |CIERRA #721;
     aAuto = #721#1;
|FPRC;

|PROCESO LeoNifsTodos;

 nGrabo = 0;
 |SI #0#0 = "S";
     aAlfa1 = #709#6; |QBF aAlfa1;
     |SI aAlfa1 = ""; |O #0#4 = "N";
         nProv = #709#4;
         nPobl = #709#5;
         |HAZ LPobl;
         |SI nExis = 0;
             #709#6 = aPobl;
             |SI enSwDeDonde = 1;
                 #709#14 = #703#4; #709#15 = #703#5;
                 #709#12 = #703#6; #709#13 = #703#7;
             |FINSI;
             nGrabo = 1;
         |FINSI;
     |FINSI;
 |FINSI;

 |SI #0#1 = "S";
     aAlfa1 = #709#7; |QBF aAlfa1;
     |SI aAlfa1 = ""; |O #0#4 = "N";
         nProv = #709#4;
         |HAZ LProv;
         |SI nExis = 0;
             #709#7 = aProv;
             nGrabo = 1;
         |FINSI;
     |FINSI;
 |FINSI;

 |SI #0#2 = "S";
     aAlfa1 = #709#13; |QBF aAlfa1;
     |SI aAlfa1 = ""; |O #0#4 = "N";
         nPais = #709#12;
         |HAZ LPais;
         |SI nExis = 0;
             #709#13 = aPais;
             nGrabo = 1;
         |FINSI;
     |FINSI;
 |FINSI;

 |SI #0#3 = "S"; |Y enSwDeDonde = 1;
     aAlfa1 = #709#15; |QBF aAlfa1;
     |SI aAlfa1 = ""; |O #0#4 = "N";
         nAuto = #709#14;
         |HAZ LAuto;
         |SI nExis = 0;
             #709#15 = aAuto;
             nGrabo = 1;
         |FINSI;
     |FINSI;
 |FINSI;

 |SI nGrabo = 1;
     |PINTA 2219, #709#0;
     |PINTA 2232, #709#1;
     |GRABA 020#709a;
 |FINSI;
 |LIBERA #709;

|FPRC;

|DEFBUCLE LeoNifsTodos;
 #709#1001;
 ;
 aDNif;
 aHNif;
 be;
 NULL, LeoNifsTodos;
|FIN;

|PROCESO LaModificacion; |TIPO 3;
  |SI #0#5 = "S";
      |CUADRO 2103 2373;
      |ATRI P; |PINTA 2205, "REGISTRO NIF: "; |ATRI 0;
      aDNif = #0#6;
      aHNif = #0#7;
      |BUCLE LeoNifsTodos;
  |FINSI;
|FPRC;

|PROGRAMA;
 |CLS;
 |CABEZA "Recuperar Datos en Registro de NIF";

 |HAZ BusquedaApli;
 enSwDeDonde = 0;  |SI eaPathIntegral ! ""; enSwDeDonde = 1; |FINSI;

 |SI enSwDeDonde = 1;    ||Tenemos Integral
    |REFERENCIA_DEF provinc@, #702;
    |REFERENCIA_DEF poblaci@, #705;
    |REFERENCIA_DEF regisnif@, #711;
    |REFERENCIA_DEF sgpaises@, #720;
    |REFERENCIA_DEF haciend@, #708;
 |SINO;
    |REFERENCIA_DEF provinc@, #701;
    |REFERENCIA_DEF poblaci@, #704;
    |REFERENCIA_DEF regisnif@, #710;
    |REFERENCIA_DEF sgpaises@, #719;
    |REFERENCIA_DEF haciend@, #707;
 |FINSI;


 |PINPA #0#0;
 |SI enSwDeDonde = 0;
     |C_M #0#3, 1, "N"; |C_V #0#3, 1, "N"; #0#3 = "N";
     |PINTA 1310, "                                "
 |FINSI;

 |PINDA #0#0;
 |ENDATOS #1#0;
|FPRO;
