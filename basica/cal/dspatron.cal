|FICHEROS;
     dspatron #0;
     refere1@ #999;
     refere2@ #998;
     agim0057 #57;
|FIN;

|VARIABLES;
     nHandle         = 0;
     nCampo          = 0;
     nDTexto         = 0;
     nHTexto         = 0;

     aExtension      = "";
     aAplicacion     = "";
     aNombAplica     = "";
     aPathFich       = "";
     aPathDef        = "";
     aDirecBuscar    = "";
     aDirPatrones    = "";
     aFicheroOrigen  = "";
     aQueQuiero      = "";
     aTitulo         = "";
     aDef            = "";
     aFich           = "";
     aInstalar       = "";
     aOrigen         = "";
     aDestino        = "";
     aFichero        = "";
     aAlfa           = "";
     aBase           = "";
     aDirPatron      = "";
     aDExt           = "";
     aHExt           = "";

     &eaPathBasica   = "";
     &eaPathContagen = "";
     &eaPathContanex = "";
     &eaPathContasoc = "";
     &eaPathRen2019  = "";
     &eaPathRen2018  = "";
     &eaPathRen2017  = "";
     &eaPathRen2016  = "";
     &eaPathRen2015  = "";
     &eaPathRen2014  = "";
     &eaPathRen2013  = "";
     &eaPathRen2012  = "";
     &eaPathRen2011  = "";
     &eaPathRen2010  = "";
     &eaPathRen2009  = "";
     &eaPathRen2008  = "";
     &eaPathRen2007  = "";
     &eaPathRen2006  = "";
     &eaPathRen2005  = "";
     &eaPathRen2004  = "";
     &eaPathRen2003  = "";
     &eaPathRen2002  = "";
     &eaPathRen2001  = "";
     &eaPathRen2000  = "";
     &eaPathRen1999  = "";
     &eaPathRen1998  = "";
     &eaPathRen1997  = "";
     &eaPathRen1996  = "";
     &eaPathRen1995  = "";
     &eaPathRen1994  = "";
     &eaPathFacturar = "";
     &eaPathLaboral  = "";
     &eaPathIntegral = "";
     &eaPathDsmodelo = "";
     &eaPathFiscal   = "";
     &eaPrograma     = "";
     &eaExtension    = "";
     &eaRenta        = "";
     &enPlan         = 0;
     nDPlan          = 0;
     nHPlan          = 0;
     &enDesde        = 0;
     &enHasta        = 0;
     &enSignos       = 0;
     nPara1          = 0;
     nPara2          = 0;
     nEstado         = 0;
     nNumCampos      = 0;
     aPassword       = "";
     aUsuario        = "";
     aUsuari1        = "";
     aTipoInstala    = "";
     nTipoInstala    = 0;
     aHora           = "";
     nSwNombre       = 0;
|FIN;

|PROCESO Mensaje;  |TIPO 7;
     |SI #0#1 = "soplanca";  |O #0#1 = "soplanli"; |O #0#1 = "vaplanca"; |O #0#1 = "vaplanli";
         |MENSA "    Introduzca <1> Instalacion Completa; <2> Solo Registros Inexistentes"

     |FINSI;

     |SI #0#1 = "metextos";
         |MENSA "    <1> Memoria Ant. BOE 19/05/99; <2> Memoria BOE 19/05/99; <3> Mem. Revisada";
     |FINSI;

     |SI #0#1 = "ca8agmay";  |O #0#1 = "ca8comay"; |O #0#1 = "ca8cumay";
        |O #0#1 = "ca8eqmay"; |O #0#1 = "ca8m0010";
         |MENSA "0000Introduzca <1> Instalacion Completa; <2> Solo pat.ofic.(0,1,20,21,30,31,40,41)"
     |FINSI;

     |SI #0#1 = "ca8accaa";
         |MENSA "0000Introd. <1> Instalacion Completa; <2> Solo pat.of.(2008,2015,2016,2018,2019)"
     |FINSI;

     |SI #0#1 = "ca8m0000";  |O #0#1 = "ca8m0001"; |O #0#1 = "ca8m0002";
          |O #0#1 = "ca8m0021"; |O #0#1 = "ca8m0022"; |O #0#1 = "soda8m02";
            |O #0#1 = "soda8m03"; |O #0#1 = "soda8tco"; |O #0#1 = "soda8tli";
              |O #0#1 = "soda8m22"; |O #0#1 = "soda8m23";
                |O #0#1 = "ca8m0006"; |O #0#1 = "ca8m0007"; |O #0#1 = "ca8mtcol"; |O #0#1 = "ca8mtlin";
         |MENSA "    <1> Inst.Completa; <2> Solo pat.ofic.(0,1,10,30,31,32,40,41,42)";
     |FINSI;
     |SI #0#1 = "va8planc"; |O #0#1 = "va8planl";
         |MENSA "    Introduzca <1> Instalacion Completa; <2> Solo patrones oficiales (1)"
     |FINSI;
|FPRC;

|PROCESO TInsta;
     aAlfa = #0#1 % 103;
     |SI #0#1 = "soplanca";  |O #0#1 = "soplanli"; |O #0#1 = "vaplanca"; |O #0#1 = "vaplanli"; |O #0#1 = "va8planc"; |O #0#1 = "va8planl";
         |SI #0#5 = "3"; |ERROR; |FINSI;
     |FINSI;
     |SI aAlfa = "ca8";
         |SI #0#5 = "3"; |ERROR; |FINSI;
     |FINSI;
     aAlfa = #0#1 % 105;
     |SI aAlfa = "soda8";
         |SI #0#5 = "3"; |ERROR; |FINSI;
     |FINSI;
|FPRC;

|PROCESO ClaveBaja57;
     #57#0 = "   ";
     #57#1 = "        ";
     #57#5 = 0;
|FPRC;

|PROCESO ClaveAlta57;
     #57#0 = "zzz";
     #57#1 = "zzzzzzzz";
     #57#5 = 9;
|FPRC;

|PROCESO Tipo11;  |TIPO 11;
     |SI FSalida ! 10;  |Y FSalida ! 11; |ACABA;  |FINSI;

     |SI FSalida = 11;
         |ABRE #57;
         #57#0 = #0#0;
         #57#1 = #0#1;
         |CONSULTA_F_CLAVE #1#57, ClaveBaja57, ClaveAlta57;
         |CIERRA #57;
         |ERROR;
         |ACABA;
     |FINSI;

     |LEE 101#0=;
     |SI #0#4 = "N";
         #0#4 = "S";
     |SINO;
         #0#4 = "N";
     |FINSI;

     |PINTA #0#4;

     |SI #0#1 = "soplanca";  |O #0#1 = "soplanli";  |O #0#1 = "metextos"; |O #0#1 = "vaplanli";
        |O #0#1 = "vaplanca"; |O #0#1 = "va8planc"; |O #0#1 = "va8planl";
         |O #0#1 = "ca8agmay"; |O #0#1 = "ca8comay"; |O #0#1 = "ca8cumay"; |O #0#1 = "ca8eqmay";
           |O #0#1 = "ca8m0000"; |O #0#1 = "ca8m0001"; |O #0#1 = "ca8m0002"; |O #0#1 = "ca8m0010";
             |O #0#1 = "ca8m0021"; |O #0#1 = "ca8m0022"; |O #0#1 = "soda8m02"; |O #0#1 = "soda8m03";
               |O #0#1 = "soda8tco"; |O #0#1 = "soda8tli"; |O #0#1 = "soda8m22"; |O #0#1 = "soda8m23";
                 |O #0#1 = "ca8m0006"; |O #0#1 = "ca8m0007"; |O #0#1 = "ca8mtcol"; |O #0#1 = "ca8mtlin";
                    |O #0#1 = "ca8accaa";
         |SI #0#4 = "S";
             |C_M #0#5, 1, "S";

             |ENCAMPO #5#0;

             |C_M #0#5, 1, "N";
         |SINO;
             #0#5 = "";
         |FINSI;
         |PINTA #0#5;
     |FINSI;

     |GRABA 020#0a;
     |LIBERA #0;

     |SI #0#1 = "dsmom030"; |Y #0#4 = "S";
         |MENAV "2400Es conveniente instalar tambien el dsmom031";
     |FINSI;

     |SI #0#1 = "dsmom033"; |Y #0#4 = "S";
         |SALVA_FICHA #0;
         #0#0 = "mod";
         #0#1 = "dsmom133";
         |LEE 041#0=;
         |SI FSalida = 0; |Y #0#4 ! "S";
             |MENAV "2400Instala tambien el dsmom133";
             #0#4 = "S";
             |GRABA 020#0a;
         |FINSI;
         |REPON_FICHA #0;
         |PONCONTROL 23, "SI";
     |FINSI;
     |SI #0#1 = "dsmom133"; |Y #0#4 = "S";
         |SALVA_FICHA #0;
         #0#0 = "mod";
         #0#1 = "dsmom033";
         |LEE 041#0=;
         |SI FSalida = 0; |Y #0#4 ! "S";
             |MENAV "2400Instala tambien el dsmom033";
             #0#4 = "S";
             |GRABA 020#0a;
         |FINSI;
         |REPON_FICHA #0;
         |PONCONTROL 23, "SI";
     |FINSI;
|FPRC;

|PROCESO GrabaLineal;
     aDef = aPathDef + (aFicheroOrigen % 108) + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aQueQuiero = "|TITULO";
     aTitulo    = #999#aQueQuiero#;

     |DESCARGA_DEF #refere1@;

     aInstalar = "S";
     aFich     = aPathFich + (aFicheroOrigen % 108) + ".dat";  |QBT aFich;
     |XABRE "E", aFich, nHandle;
     |SI FSalida ] 0;  aInstalar = "N";  |FINSI;

     |DDEFECTO #0;
     #0#0 = (aFicheroOrigen % -103) < "";
     #0#1 = (aFicheroOrigen % 108) < "";
     #0#2 = aTitulo > "";
     #0#3 = aNombAplica;
     #0#4 = aInstalar;

     |SI eaRenta = "soc";
         |SI #0#1 = "soplanca";  |O #0#1 = "soplanli";
             #0#4  = "S";
             #0#5  = "2";
         |FINSI;
     |FINSI;

     |SI #0#1 = "agiprovi"; |O #0#1 = "agipobla"; |O #0#1 = "agim0016"; |O #0#1 = "agihacie";
         |SI eaPathIntegral ! ""; |ACABA; |FINSI;
     |FINSI;

     |GRABA 020#0n;
     |LIBERA #0;
|FPRC;


|PROCESO BorraTextos;
     |BORRA 020#999a;
     |LIBERA #999;
|FPRC;

|DEFBUCLE metextoBorra;
     #999#1003;
     ;
     000000, 00, 99996;
     999999, 99, 99999;
     be;
     NULL, BorraTextos;
|FIN;

|PROCESO GrabaTextos;
     |PARA nCampo = 0;  |SI nCampo [ 34;  |HACIENDO nCampo = nCampo + 1;
           #999nCampo = #998nCampo;
     |SIGUE;

     |SI #999#17 = 99996;  #999#17 = 99998;  |FINSI;
     |SI #999#17 = 99997;  #999#17 = 99999;  |FINSI;

     |SI #999#17 = 99994;  #999#17 = 99998;  |FINSI;
     |SI #999#17 = 99995;  #999#17 = 99999;  |FINSI;

     |GRABA 020#999n;
     |LIBERA #999;
|FPRC;

|DEFBUCLE metextoGraba;
     #998#1003;
     ;
     000000, 00, nDTexto;
     999999, 99, nHTexto;
     ;
     NULL, GrabaTextos;
|FIN;

|PROCESO metextos;
     |SI #0#5 = "1";
         nDTexto = 99998;
         nHTexto = 99999;
     |FINSI;
     |SI #0#5 = "2";
         nDTexto = 99996;
         nHTexto = 99997;
     |FINSI;
     |SI #0#5 = "3";
         nDTexto = 99994;
         nHTexto = 99995;
     |FINSI;

     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             |BUCLE metextoBorra;

             |ABRE #999;
             |BUCLE metextoGraba;
             |CIERRA #999;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|PROCESO b_oficial;
     |BORRA 020#999a;
     |LIBERA #999;
|FPRC;

|DEFBUCLE b_ca8agmay;
     #999#1003;
     ;
     nPara1, " ", 00;
     nPara1, "z", 99;
     be;
     NULL, b_oficial;
|FIN;

|DEFBUCLE b_ca8xxmay;  ||numero balance + cta
     #999#1002;
     ;
     nPara1, "     ";
     nPara1, "zzzzz";
     be;
     NULL, b_oficial;
|FIN;

|DEFBUCLE b_ca8cumay;  ||numero balance + cta
     #999#1003;
     ;
     nDPlan, nPara1, "     ";
     nHPlan, nPara1, "zzzzz";
     be;
     NULL, b_oficial;
|FIN;

|DEFBUCLE b_ca8m0001;
     #999#1010;
     ;
     nDPlan, nPara1, 0, 0, " ", 00, 0, 00, 00, 0;
     nHPlan, nPara1, 9, 9, "z", 99, 9, 99, 99, 9;
     be;
     NULL, b_oficial;
|FIN;

|DEFBUCLE b_ca8m0002;
     #999#1011;
     ;
     nDPlan, nPara1, 0, 0, " ", 00, 0, 00, 00, 0, 001;
     nHPlan, nPara1, 9, 9, "z", 99, 9, 99, 99, 9, 999;
     be;
     NULL, b_oficial;
|FIN;

|PROCESO Grabaca8agmay;
     #999#3 = #998#3;
     #999#0 = #998#0;
     #999#1 = #998#1;
     |LEE 101#999=;
     nEstado = FSalida;
     #999#0  = #998#0;
     #999#1  = #998#1;
     #999#2  = #998#2;
     #999#3  = #998#3;
     #999#4  = #998#4;
     |SI nEstado ! 0; |GRABA 020#999n; |FINSI;
     |SI nEstado = 0; |GRABA 020#999a; |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE ca8agmay;
     #998#1003;
     ;
     nPara1, " ", 00;
     nPara1, "z", 99;
     ;
     NULL, Grabaca8agmay;
|FIN;

|PROCESO Grabaca8titulo;
     |ABRE #998;
     #998#0 = nPara1;
     |LEE 001#998=;
     |SI FSalida = 0;
         #999#0 = #998#0;
         |LEE 101#999=;
         nEstado = FSalida;
         #999#0  = #998#0;
         #999#1  = #998#1;
         #999#2  = #998#2;
         |SI #0#1 = "ca8comay"; #999#3 = #998#3; |FINSI;
         |SI nEstado ! 0; |GRABA 020#999n; |FINSI;
         |SI nEstado = 0; |GRABA 020#999a; |FINSI;
         |LIBERA #999;
    |FINSI;
    |CIERRA #998;
|FPRC;

|PROCESO Grabaca8cumay;
     #999#12 = #998#12;
     #999#10 = #998#10;
     #999#0  = #998#0;
     |LEE 101#999=;
     nEstado = FSalida;
     #999#12 = #998#12;
     #999#0  = #998#0;
     #999#1  = #998#1;
     #999#2  = #998#2;
     #999#3  = #998#3;
     #999#4  = #998#4;
     #999#5  = #998#5;
     #999#6  = #998#6;
     #999#7  = #998#7;
     #999#8  = #998#8;
     #999#9  = #998#9;
     #999#10 = #998#10;
     #999#11 = #998#11;
     |SI nEstado ! 0; |GRABA 020#999n; |FINSI;
     |SI nEstado = 0; |GRABA 020#999a; |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE ca8cumay;
     #998#1003;
     ;
     nDPlan, nPara1, "     ";
     nHPlan, nPara1, "zzzzz";
     ;
     NULL, Grabaca8cumay;
|FIN;

|PROCESO Grabaca8m0010;
     #999#5 = #998#5;
     #999#0 = #998#0;
     #999#1 = #998#1;
     |LEE 101#999=;
     nEstado = FSalida;
     #999#5 = #998#5;
     #999#0 = #998#0;
     #999#1 = #998#1;
     #999#2 = #998#2;
     #999#3 = #998#3;
     #999#4 = #998#4;
     |SI nEstado ! 0; |GRABA 020#999n; |FINSI;
     |SI nEstado = 0; |GRABA 020#999a; |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE ca8m0010;
     #998#1003;
     ;
     nDPlan, nPara1, "     ";
     nHPlan, nPara1, "zzzzz";
     ;
     NULL, Grabaca8m0010;
|FIN;

|PROCESO Grabaca8xxmay;
     #999#0 = #998#0;
     #999#1 = #998#1;
     |LEE 101#999=;
     nEstado = FSalida;
     #999#0  = #998#0;
     #999#1  = #998#1;
     #999#2  = #998#2;
     #999#3  = #998#3;
     #999#4  = #998#4;
     |SI nEstado ! 0; |GRABA 020#999n; |FINSI;
     |SI nEstado = 0; |GRABA 020#999a; |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE ca8xxmay;
     #998#1002;
     ;
     nPara1, "     ";
     nPara1, "zzzzz";
     ;
     NULL, Grabaca8xxmay;
|FIN;

|PROCESO Grabaca8m0001;
     #999#14 = #998#14;
     #999#0  = #998#0;
     #999#1  = #998#1;
     #999#2  = #998#2;
     #999#3  = #998#3;
     #999#4  = #998#4;
     #999#5  = #998#5;
     #999#6  = #998#6;
     #999#7  = #998#7;
     #999#10 = #998#10;
     |LEE 101#999=;
     nEstado = FSalida;
     #999#14 = #998#14;
     #999#0  = #998#0;
     #999#1  = #998#1;
     #999#2  = #998#2;
     #999#3  = #998#3;
     #999#4  = #998#4;
     #999#5  = #998#5;
     #999#6  = #998#6;
     #999#7  = #998#7;
     #999#8  = #998#8;
     #999#9  = #998#9;
     #999#10 = #998#10;
     #999#11 = #998#11;
     #999#12 = #998#12;
     #999#13 = #998#13;
     |SI nEstado ! 0; |GRABA 020#999n; |FINSI;
     |SI nEstado = 0; |GRABA 020#999a; |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE ca8m0001;
     #998#1010;
     ;
     nDPlan, nPara1, 0, 0, " ", 00, 0, 00, 00, 0;
     nHPlan, nPara1, 9, 9, "z", 99, 9, 99, 99, 9;
     ;
     NULL, Grabaca8m0001;
|FIN;

|PROCESO Grabaca8m0002;
     #999#14 = #998#14;
     #999#0  = #998#0;
     #999#1  = #998#1;
     #999#2  = #998#2;
     #999#3  = #998#3;
     #999#4  = #998#4;
     #999#5  = #998#5;
     #999#6  = #998#6;
     #999#7  = #998#7;
     #999#12 = #998#12;
     #999#8  = #998#8;
     |LEE 101#999=;
     nEstado = FSalida;
     #999#14 = #998#14;
     #999#0  = #998#0;
     #999#1  = #998#1;
     #999#2  = #998#2;
     #999#3  = #998#3;
     #999#4  = #998#4;
     #999#5  = #998#5;
     #999#6  = #998#6;
     #999#7  = #998#7;
     #999#8  = #998#8;
     #999#9  = #998#9;
     #999#10 = #998#10;
     #999#11 = #998#11;
     #999#12 = #998#12;
     #999#13 = #998#13;
     |SI nEstado ! 0; |GRABA 020#999n; |FINSI;
     |SI nEstado = 0; |GRABA 020#999a; |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE ca8m0002;
     #998#1011;
     ;
     nDPlan, nPara1, 0, 0, " ", 00, 0, 00, 00, 0, 001;
     nHPlan, nPara1, 9, 9, "z", 99, 9, 99, 99, 9, 999;
     ;
     NULL, Grabaca8m0002;
|FIN;

|PROCESO ctamayor;
     nDPlan = enPlan;
     nHPlan = enPlan;
     |SI enPlan = 0; |O enPlan = 2999;
         nDPlan = 2008;
         nHPlan = 2019;
     |FINSI;

     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             |PARA nPara1 = 0; |SI nPara1 [ 41; |HACIENDO nPara1 = nPara1 + 1;
                  |SI #0#1 = "ca8agmay"; |BUCLE b_ca8agmay; |FINSI;
                  |SI #0#1 = "ca8cumay"; |BUCLE b_ca8cumay; |FINSI;
                  |SI #0#1 = "ca8eqmay"; |BUCLE b_ca8xxmay; |FINSI;
                  |SI #0#1 = "ca8m0010"; |BUCLE b_ca8cumay; |FINSI;

                  |ABRE #999;
                  |SI #0#1 = "ca8agmay"; |BUCLE ca8agmay; |FINSI;
                  |SI #0#1 = "ca8comay"; |HAZ Grabaca8titulo; |FINSI;
                  |SI #0#1 = "ca8cumay"; |BUCLE ca8cumay; |FINSI;
                  |SI #0#1 = "ca8eqmay"; |BUCLE ca8xxmay; |FINSI;
                  |SI #0#1 = "ca8m0010"; |BUCLE ca8m0010; |FINSI;
                  |CIERRA #999;

                  |SI nPara1 = 1;  nPara1 = 19; |FINSI;
                  |SI nPara1 = 21; nPara1 = 29; |FINSI;
                  |SI nPara1 = 31; nPara1 = 39; |FINSI;
             |SIGUE;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|PROCESO Grabaca8accaa;
     #999#0  = #998#0;
     |LEE 101#999=;
     nEstado = FSalida;
     #999#0  = #998#0;
     #999#1  = #998#1;
     |SI nEstado ! 0; |GRABA 020#999n; |FINSI;
     |SI nEstado = 0; |GRABA 020#999a; |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE ca8accaa;
     #998#1001;
     ;
     nDPlan;
     nHPlan;
     ;
     NULL, Grabaca8accaa;
|FIN;

|PROCESO ca8accaa;
     nDPlan = enPlan;
     nHPlan = enPlan;
     |SI enPlan = 0; |O enPlan = 2999;
         nDPlan = 2008;
         nHPlan = 2019;
     |FINSI;

     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             |ABRE #999;
             |BUCLE ca8accaa;
             |CIERRA #999;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|DEFBUCLE b_soda8xxx;
     #999#1003;
     ;
     nDPlan, nPara1, 001;
     nHPlan, nPara1, 999;
     be;
     NULL, b_oficial;
|FIN;

|DEFBUCLE b_soda8m03;
     #999#1005;
     ;
     nDPlan, nPara1, 001, 01, 001;
     nHPlan, nPara1, 999, 99, 999;
     be;
     NULL, b_oficial;
|FIN;

|DEFBUCLE b_soda8tco;
     #999#1003;
     ;
     nDPlan, nPara1, 01;
     nHPlan, nPara1, 99;
     be;
     NULL, b_oficial;
|FIN;

|PROCESO Grabasoda8tco;
     #999#5  = #998#5;
     #999#0  = #998#0;
     #999#1  = #998#1;
     |LEE 101#999=;
     nEstado = FSalida;
     #999#5  = #998#5;
     #999#0  = #998#0;
     #999#1  = #998#1;
     #999#2  = #998#2;
     #999#3  = #998#3;
     #999#4  = #998#4;
     |SI nEstado ! 0; |GRABA 020#999n; |FINSI;
     |SI nEstado = 0; |GRABA 020#999a; |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE soda8tco;
     #998#1003;
     ;
     nDPlan, nPara1, 01;
     nHPlan, nPara1, 99;
     ;
     NULL, Grabasoda8tco;
|FIN;

|PROCESO Grabasoda8m03;
     #999#7  = #998#7;
     #999#0  = #998#0;
     #999#1  = #998#1;
     #999#2  = #998#2;
     #999#3  = #998#3;
     |LEE 101#999=;
     nEstado = FSalida;
     #999#7  = #998#7;
     #999#0  = #998#0;
     #999#1  = #998#1;
     #999#2  = #998#2;
     #999#3  = #998#3;
     #999#4  = #998#4;
     #999#5  = #998#5;
     #999#6  = #998#6;
     |SI nEstado ! 0; |GRABA 020#999n; |FINSI;
     |SI nEstado = 0; |GRABA 020#999a; |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE soda8m03;
     #998#1005;
     ;
     nDPlan, nPara1, 001, 01, 001;
     nHPlan, nPara1, 999, 99, 999;
     ;
     NULL, Grabasoda8m03;
|FIN;

|PROCESO Grabasoda8xxx;
     #999nNumCampos = #998nNumCampos;
     #999#0  = #998#0;
     #999#1  = #998#1;
     |LEE 101#999=;
     nEstado = FSalida;
     #999nNumCampos = #998nNumCampos;
     #999#0  = #998#0;
     #999#1  = #998#1;
     |PARA nPara2 = 2; |SI nPara2 [ nNumCampos; |HACIENDO nPara2 = nPara2 + 1;
           #999nPara2  = #998nPara2;
     |SIGUE;
     |SI nEstado ! 0; |GRABA 020#999n; |FINSI;
     |SI nEstado = 0; |GRABA 020#999a; |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE soda8xxx;
     #998#1003;
     ;
     nDPlan, nPara1, 001;
     nHPlan, nPara1, 999;
     ;
     NULL, Grabasoda8xxx;
|FIN;

|PROCESO defbalance;
     nDPlan = enPlan;
     nHPlan = enPlan;
     |SI enPlan = 0; |O enPlan = 2999;
         nDPlan = 2008;
         nHPlan = 2019;
     |FINSI;

     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             |PARA nPara1 = 0; |SI nPara1 [ 42; |HACIENDO nPara1 = nPara1 + 1;
                  |SI #0#1 = "ca8m0001"; |O #0#1 = "ca8m0021"; |BUCLE b_ca8m0001; |FINSI;
                  |SI #0#1 = "ca8m0002"; |O #0#1 = "ca8m0022"; |BUCLE b_ca8m0002; |FINSI;
                  |SI #0#1 = "ca8m0006"; |O #0#1 = "ca8mtlin"; |BUCLE b_soda8xxx; |FINSI;
                  |SI #0#1 = "ca8m0007";  |BUCLE b_soda8m03; |FINSI;
                  |SI #0#1 = "ca8mtcol";  |BUCLE b_soda8tco; |FINSI;

                  |ABRE #999;
                  |SI #0#1 = "ca8m0000"; |HAZ Grabaca8titulo; |FINSI;
                  |SI #0#1 = "ca8m0001"; |O #0#1 = "ca8m0021"; |BUCLE ca8m0001; |FINSI;
                  |SI #0#1 = "ca8m0002"; |O #0#1 = "ca8m0022"; |BUCLE ca8m0002; |FINSI;
                  |SI #0#1 = "ca8m0006"; nNumCampos = 34; |BUCLE soda8xxx; |FINSI;
                  |SI #0#1 = "ca8m0007"; |BUCLE soda8m03; |FINSI;
                  |SI #0#1 = "ca8mtcol"; |BUCLE soda8tco; |FINSI;
                  |SI #0#1 = "ca8mtlin"; nNumCampos = 8;  |BUCLE soda8xxx; |FINSI;
                  |CIERRA #999;

                  |SI nPara1 = 1;  nPara1 = 4;  |FINSI;
                  |SI nPara1 = 7;  nPara1 = 9;  |FINSI;
                  |SI nPara1 = 10; nPara1 = 19; |FINSI;
                  |SI nPara1 = 22; nPara1 = 29; |FINSI;
                  |SI nPara1 = 32; nPara1 = 39; |FINSI;
             |SIGUE;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|PROCESO defbalansoc;

     nDPlan = enPlan;
     nHPlan = enPlan;
     |SI enPlan = 0; |O enPlan = 2999;
         nDPlan = 2008;
         nHPlan = 2019;
     |FINSI;

     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             |PARA nPara1 = 0; |SI nPara1 [ 42; |HACIENDO nPara1 = nPara1 + 1;
                  |SI #0#1 = "soda8m02"; |O #0#1 = "soda8m22"; |BUCLE b_soda8xxx; |FINSI;
                  |SI #0#1 = "soda8m03"; |O #0#1 = "soda8m23"; |BUCLE b_soda8m03; |FINSI;
                  |SI #0#1 = "soda8tco"; |BUCLE b_soda8tco; |FINSI;
                  |SI #0#1 = "soda8tli"; |BUCLE b_soda8xxx; |FINSI;

                  |ABRE #999;
                  |SI #0#1 = "soda8m02"; |O #0#1 = "soda8m22"; nNumCampos = 34; |BUCLE soda8xxx; |FINSI;
                  |SI #0#1 = "soda8m03"; |O #0#1 = "soda8m23"; |BUCLE soda8m03; |FINSI;
                  |SI #0#1 = "soda8tco"; |BUCLE soda8tco; |FINSI;
                  |SI #0#1 = "soda8tli"; nNumCampos = 8;  |BUCLE soda8xxx; |FINSI;
                  |CIERRA #999;

                  |SI nPara1 = 1;  nPara1 = 4;  |FINSI;
                  |SI nPara1 = 7;  nPara1 = 9;  |FINSI;
                  |SI nPara1 = 10; nPara1 = 19; |FINSI;
                  |SI nPara1 = 22; nPara1 = 29; |FINSI;
                  |SI nPara1 = 32; nPara1 = 39; |FINSI;
             |SIGUE;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|PROCESO Grabava8planc;
     #999#0 = #998#0;
     |LEE 101#999=;
     |SI FSalida ! 0;
         #999#0 = #998#0;
         #999#1 = #998#1;
         #999#2 = #998#2;
         |GRABA 020#999n;
     |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE va8planc;
     #998#1001;
     ;
     00;
     99;
     ;
     NULL, Grabava8planc;
|FIN;

|PROCESO Grabava8planl;
     #999#0 = #998#0;
     #999#1 = #998#1;
     |LEE 101#999=;
     |SI FSalida ! 0;
         #999#0 = #998#0;
         #999#1 = #998#1;
         |GRABA 020#999b;
     |FINSI;
         #999#2 = #998#2;
         #999#3 = #998#3;
         #999#4 = #998#6;
         #999#5 = #998#5;
         #999#6 = #998#6;
         #999#7 = #998#7;
         #999#8 = #998#8;
         #999#9 = #998#9;
         #999#10 = #998#10;
         |GRABA 020#999a;
     |LIBERA #999;
|FPRC;

|DEFBUCLE va8planl;
     #998#1002;
     ;
     nPara1, 000;
     nPara1, 999;
     ;
     NULL, Grabava8planl;
|FIN;

|DEFBUCLE b_va8planl;
     #999#1002;
     ;
     nPara1, 001;
     nPara1, 999;
     be;
     NULL, b_oficial;
|FIN;

|PROCESO va8planc;
     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             |ABRE #999;
             |BUCLE va8planc;
             |CIERRA #999;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|PROCESO va8planl;
     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             nPara1 = 1;
             |BUCLE b_va8planl;

             |ABRE #999;
             |BUCLE va8planl;
             |CIERRA #999;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|PROCESO Grabavaplanca;
     #999#0 = #998#0;
     |LEE 101#999=;
     |SI FSalida ! 0;
         #999#0 = #998#0;
         #999#1 = #998#1;
         |GRABA 020#999n;
     |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE vaplanca;
     #998#1001;
     ;
     00;
     99;
     ;
     NULL, Grabavaplanca;
|FIN;

|PROCESO Grabavaplanli;
     #999#0 = #998#0;
     #999#1 = #998#1;
     |LEE 101#999=;
     |SI FSalida ! 0;
         #999#0 = #998#0;
         #999#1 = #998#1;
         #999#2 = #998#2;
         #999#3 = #998#3;
         #999#4 = #998#6;
         #999#5 = #998#5;
         #999#6 = #998#6;
         #999#7 = #998#7;
         #999#8 = #998#8;
         #999#9 = #998#9;
         |GRABA 020#999n;
     |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE vaplanli;
     #998#1002;
     ;
     00, 000;
     99, 999;
     ;
     NULL, Grabavaplanli;
|FIN;

|PROCESO vaplanca;
     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             |ABRE #999;
             |BUCLE vaplanca;
             |CIERRA #999;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|PROCESO vaplanli;
     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             |ABRE #999;
             |BUCLE vaplanli;
             |CIERRA #999;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|PROCESO Grabasoplanca;
     #999#0 = #998#0;
     |LEE 101#999=;
     |SI FSalida ! 0;
         #999#0 = #998#0;
         #999#1 = #998#1;
         |GRABA 020#999n;
     |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE soplanca;
     #998#1001;
     ;
     00;
     99;
     ;
     NULL, Grabasoplanca;
|FIN;

|PROCESO Grabasoplanli;
     #999#0 = #998#0;
     #999#1 = #998#1;
     |LEE 101#999=;
     |SI FSalida ! 0;
         #999#0 = #998#0;
         #999#1 = #998#1;
         #999#2 = #998#2;
         #999#3 = #998#3;
         #999#4 = #998#6;
         #999#5 = #998#5;
         #999#6 = #998#6;
         #999#7 = #998#7;
         #999#8 = #998#8;
         #999#9 = #998#9;
         |GRABA 020#999n;
     |SINO;
         |SI #999#6 = "214000";  |Y #999#0 ! 16;
             #999#6 = "214070";
             |GRABA 020#999a;
         |FINSI;
     |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE soplanli;
     #998#1002;
     ;
     00, 000;
     99, 999;
     ;
     NULL, Grabasoplanli;
|FIN;

|PROCESO soplanca;
     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             |ABRE #999;
             |BUCLE soplanca;
             |CIERRA #999;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|PROCESO soplanli;
     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             |ABRE #999;
             |BUCLE soplanli;
             |CIERRA #999;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|PROCESO Grabavaticuen;
     #999#2 = #998#2;
     #999#0 = #998#0;
     |LEE 101#999=;
     |SI FSalida ! 0;
         #999#0  = #998#0;
         #999#1  = #998#1;
         #999#2  = #998#2;
         |GRABA 020#999n;
     |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE vaticuen;
     #998#1002;
     ;
     enPlan, "            ";
     enPlan, "zzzzzzzzzzzz";
     ;
     NULL, Grabavaticuen;
|FIN;

|PROCESO vaticuen;
     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             |ABRE #999;
             |BUCLE vaticuen;
             |CIERRA #999;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|PROCESO Grabasodacuen;
     #999#2 = #998#2;
     #999#0 = #998#0;
     |LEE 101#999=;
     |SI FSalida ! 0;
         #999#0  = #998#0;
         #999#1  = #998#1;
         #999#2  = #998#2;
         |GRABA 020#999n;
     |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE sodacuen;
     #998#1002;
     ;
     enPlan, "            ";
     enPlan, "zzzzzzzzzzzz";
     ;
     NULL, Grabasodacuen;
|FIN;

|PROCESO sodacuen;
     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             |ABRE #999;
             |BUCLE sodacuen;
             |CIERRA #999;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|PROCESO Borradsmom014;
     |BORRA 040#999a;
     |LIBERA #999;
|FPRC;

|DEFBUCLE dsmom014B;
     #999#1002;
     ;
     enPlan, "    ";
     enPlan, "zzzz";
     ;
     NULL, Borradsmom014;
|FIN;

|PROCESO Grabadsmom014;
     #999#10 = #998#10;
     #999#0  = #998#0;
     |LEE 101#999=;
     |SI FSalida ! 0;
         #999#10 = #998#10;
         #999#0  = #998#0;
         #999#1  = #998#1;
         #999#2  = #998#2;
         #999#3  = #998#3;
         #999#4  = #998#4;
         #999#5  = #998#5;
         #999#6  = #998#6;
         #999#7  = #998#7;
         #999#8  = #998#8;
         #999#9  = #998#9;
         |GRABA 020#999n;
     |SINO;
         |SI enSignos = 1;
              #999#2  = #998#2;
              #999#3  = #998#3;
              #999#5  = #998#5;
              #999#6  = #998#6;
              #999#7  = #998#7;
              #999#8  = #998#8;
              #999#9  = #998#9;
              |GRABA 020#999a;
         |FINSI;
     |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE dsmom014;
     #998#1002;
     ;
     enPlan, "    ";
     enPlan, "zzzz";
     ;
     NULL, Grabadsmom014;
|FIN;

|PROCESO dsmom014;
     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             |BUCLE dsmom014B;
             |ABRE #999;
             |BUCLE dsmom014;
             |CIERRA #999;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|PROCESO Grabadsmom030;
     #999#0  = #998#0;
     |LEE 101#999=;
     |SI FSalida ! 0;
         |DDEFECTO #999;
         #999#0  = #998#0;
         |GRABA 020#999b;
     |FINSI;

     |PARA nPara2 = 1; |SI nPara2 [ nNumCampos; |HACIENDO nPara2 = nPara2 + 1;
           #999nPara2  = #998nPara2;
     |SIGUE;
     |GRABA 020#999a;

     |LIBERA #999;
|FPRC;

|DEFBUCLE dsmom030;
     #998#1001;
     ;
     enDesde;
     enHasta;
     ;
     NULL, Grabadsmom030;
|FIN;

|PROCESO dsmom030;
     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             nNumCampos = 101;

             |ABRE #999;
             |BUCLE dsmom030;
             |CIERRA #999;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|PROCESO Bajadsmom031;
     |BORRA 020#999a;
     |LIBERA #999;
|FPRC;

|DEFBUCLE Bajadsmom031;
     #999#1002;
     ;
     enDesde,000;
     enHasta,999;
     be;
     NULL, Bajadsmom031;
|FIN;

|PROCESO Grabadsmom031;

     #999#0  = #998#0;
     #999#1  = #998#1;
     |LEE 101#999=;
     |SI FSalida ! 0;
         |DDEFECTO #999;
         #999#0  = #998#0;
         #999#1  = #998#1;
         |GRABA 020#999b;
     |FINSI;
     #999#2 = #998#2;
     |GRABA 020#999a;

     |LIBERA #999;
|FPRC;

|DEFBUCLE dsmom031;
     #998#1002;
     ;
     enDesde,000;
     enHasta,999;
     ;
     NULL, Grabadsmom031;
|FIN;

|PROCESO dsmom031;
     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             |BUCLE Bajadsmom031;

             |ABRE #999;
             |BUCLE dsmom031;
             |CIERRA #999;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|PROCESO Borradsmom060;
     |BORRA 040#999a;
     |LIBERA #999;
|FPRC;

|DEFBUCLE dsmom060B;
     #999#1004;
     ;
     enPlan, " ", " ", 00;
     enPlan, "z", "z", 99;
     ;
     NULL, Borradsmom060;
|FIN;

|PROCESO Grabadsmom060;
     #999#6  = #998#6;
     #999#0  = #998#0;
     #999#1  = #998#1;
     #999#2  = #998#2;
     |LEE 041#999=;
     |SI FSalida ! 0;
         #999#6  = #998#6;
         #999#0  = #998#0;
         #999#1  = #998#1;
         #999#2  = #998#2;
         #999#3  = #998#3;
         #999#4  = #998#4;
         #999#5  = #998#5;
         #999#7  = #998#7;
         |GRABA 020#999n;
     |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE dsmom060;
     #998#1004;
     ;
     enPlan, " ", " ", 00;
     enPlan, "z", "z", 99;
     ;
     NULL, Grabadsmom060;
|FIN;

|PROCESO dsmom060;
     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             |BUCLE dsmom060B;
             |ABRE #999;
             |BUCLE dsmom060;
             |CIERRA #999;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|PROCESO Borradsmom061;
     |BORRA 020#999a;
     |LIBERA #999;
|FPRC;

|DEFBUCLE dsmom061B;
     #999#1005;
     ;
     enPlan, " ", " ", 00, 000;
     enPlan, "z", "z", 99, 999;
     ;
     NULL, Borradsmom061;
|FIN;

|PROCESO Grabadsmom061;
     #999#6  = #998#6;
     #999#0  = #998#0;
     #999#1  = #998#1;
     #999#2  = #998#2;
     #999#3  = #998#3;
     |LEE 041#999=;
     |SI FSalida ! 0;
         #999#6  = #998#6;
         #999#0  = #998#0;
         #999#1  = #998#1;
         #999#2  = #998#2;
         #999#3  = #998#3;
         #999#4  = #998#4;
         #999#5  = #998#5;
         #999#7  = #998#7;
         |GRABA 020#999n;
     |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE dsmom061;
     #998#1005;
     ;
     enPlan, " ", " ", 00, 000;
     enPlan, "z", "z", 99, 999;
     ;
     NULL, Grabadsmom061;
|FIN;

|PROCESO dsmom061;
     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             |BUCLE dsmom061B;
             |ABRE #999;
             |BUCLE dsmom061;
             |CIERRA #999;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|PROCESO Grabadsmom050;
     #999#3  = #998#3;
     #999#0  = #998#0;
     |LEE 101#999=;
     |SI FSalida ! 0;
         #999#3  = #998#3;
         #999#0  = #998#0;
         #999#1  = #998#1;
         #999#2  = #998#2;
         |GRABA 020#999n;
     |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE dsmom050;
     #998#1002;
     ;
     enPlan, "    ";
     enPlan, "zzzz";
     ;
     NULL, Grabadsmom050;
|FIN;

|PROCESO dsmom050;
     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             |ABRE #999;
             |BUCLE dsmom050;
             |CIERRA #999;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|PROCESO Grabadsmom062;
     #999#4  = #998#4;
     #999#0  = #998#0;
     |LEE 101#999=;
     |SI FSalida ! 0;
         #999#4  = #998#4;
         #999#0  = #998#0;
         #999#1  = #998#1;
         #999#2  = #998#2;
         #999#3  = #998#3;
         |GRABA 020#999n;
     |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE dsmom062;
     #998#1002;
     ;
     enPlan, 00;
     enPlan, 99;
     ;
     NULL, Grabadsmom062;
|FIN;

|PROCESO dsmom062;
     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             |ABRE #999;
             |BUCLE dsmom062;
             |CIERRA #999;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|PROCESO Grabadsmom063;
     #999#4  = #998#4;
     #999#0  = #998#0;
     #999#1  = #998#1;
     |LEE 101#999=;
     |SI FSalida ! 0;
         #999#4  = #998#4;
         #999#0  = #998#0;
         #999#1  = #998#1;
         #999#2  = #998#2;
         #999#3  = #998#3;
         |GRABA 020#999n;
     |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE dsmom063;
     #998#1003;
     ;
     enPlan, 00, 0000;
     enPlan, 99, 9999;
     ;
     NULL, Grabadsmom063;
|FIN;

|PROCESO dsmom063;
     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             |ABRE #999;
             |BUCLE dsmom063;
             |CIERRA #999;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|PROCESO Grabadsmom064;
     #999#5  = #998#5;
     #999#0  = #998#0;
     #999#1  = #998#1;
     #999#2  = #998#2;
     |LEE 101#999=;
     |SI FSalida ! 0;
         #999#5  = #998#5;
         #999#0  = #998#0;
         #999#1  = #998#1;
         #999#2  = #998#2;
         #999#3  = #998#3;
         #999#4  = #998#4;
         |GRABA 020#999n;
     |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE dsmom064;
     #998#1004;
     ;
     enPlan, 00, 0000, "    ";
     enPlan, 99, 9999, "zzzz";
     ;
     NULL, Grabadsmom064;
|FIN;

|PROCESO dsmom064;
     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             |ABRE #999;
             |BUCLE dsmom064;
             |CIERRA #999;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;
||///////////
|PROCESO Grabaagitab99;
     #999#0  = #998#0;
     |LEE 101#999=;
     |SI FSalida ! 0;
         |DDEFECTO #999;
         #999#0  = #998#0;
         |GRABA 020#999b;
     |FINSI;

     |PARA nPara2 = 1; |SI nPara2 [ nNumCampos; |HACIENDO nPara2 = nPara2 + 1;
           #999nPara2  = #998nPara2;
     |SIGUE;
     |GRABA 020#999a;

     |LIBERA #999;
|FPRC;

|DEFBUCLE agitab99;
     #998#1001;
     ;
     enDesde;
     enHasta;
     ;
     NULL, Grabaagitab99;
|FIN;

|PROCESO agitab99;
     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida = 0;
         |CARGA_DEF aDef, refere2@;
         |SI FSalida = 0;
             aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
             aOrigen  = aDirPatrones + aFichero;
             aFichero = #0#1 + "." + "dat";  |QBT aFichero;
             aDestino = aDirPatrones + aFichero;
             |COPIA_FICHERO aOrigen, aDestino;

             |PATH_DAT #999 aPathFich;
             |PATH_DAT #998 aDirPatrones;

             nNumCampos = 8;

             |ABRE #999;
             |BUCLE agitab99;
             |CIERRA #999;

             |DELINDEX #998;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|| /////////////////////////////////////////////////////
|PROCESO GrabaAuxiliar;

     |SI nSwNombre = 1;
         #0#3 = aNombAplica;
         aDef = aPathDef + (#0#1 % 108) + ".mas";  |QBT aDef;
         |CARGA_DEF aDef, refere1@;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         aQueQuiero = "|TITULO";
         #0#2       = #999#aQueQuiero#;
         #0#2       = #0#2 > "";

         |DESCARGA_DEF #refere1@;
     |FINSI;

     aTipoInstala = "";
     nTipoInstala = #0#5;
     |SI nTipoInstala = 0; nTipoInstala = 1; |FINSI;
     |SI enPlan ] 2008;    nTipoInstala = 2; |FINSI;

     |SI nTipoInstala = 1;
         aTipoInstala = "Instalacion Completa";
     |FINSI;

     |SI nTipoInstala = 2;
         aTipoInstala = "Solo Patr.oficiales ";
         |SI #0#1 = "soplanca";  |O #0#1 = "soplanli"; |O #0#1 = "vaplanca"; |O #0#1 = "vaplanli";
             aTipoInstala = "Regis. Inexistentes";
         |FINSI;
     |FINSI;

     |SI enDesde ! 0;
          nTipoInstala = 2;
          aTipoInstala = "Desde " + (("000" + enDesde) % -103) + " Hasta " + (("000" + enHasta) % -103);
     |FINSI;

     |SI #0#1 = "metextos";
         nTipoInstala = 3; aTipoInstala = "Memoria Revisada";
         |SI #0#5 = 1; nTipoInstala = 1; aTipoInstala = "Ant BOE 19/05/99"; |FINSI;
         |SI #0#5 = 2; nTipoInstala = 2; aTipoInstala = "BOE 19/05/99";     |FINSI;
     |FINSI;

     |SI enPlan = 2008; |O enPlan = 2019;
         |SI #0#1 = "dsmom014"; |O #0#1 = "dsmom060"; |O #0#1 = "dsmom061";
             |O #0#1 = "dsmom050"; |O #0#1 = "dsmom062"; |O #0#1 = "dsmom063";
             |O #0#1 = "dsmom064"; |O #0#1 = "vaticuen"; |O #0#1 = "sodacuen";
           |SI enPlan = 2008; aTipoInstala = "Datos 2008"; |FINSI;
           |SI enPlan = 2019; aTipoInstala = "Datos 2019"; |FINSI;
         |FINSI;
     |FINSI;
     |SI enPlan = 2015;
         |SI #0#1 = "dsmom060"; |O #0#1 = "dsmom061";
             aTipoInstala = "Datos 2015";
         |FINSI;
     |FINSI;

     |ABRE #57;
     #57#0 = #0#0;
     #57#1 = #0#1;
     #57#5 = nTipoInstala;
     |LEE 141#57=;
     |SI FSalida ! 0;
         |DDEFECTO #57;
         #57#0 = #0#0;
         #57#1 = #0#1;
         #57#5 = nTipoInstala;
         |GRABA 020#57b;
     |FINSI;
     #57#2 = #0#2;
     #57#3 = #0#3;
     #57#4 = aUsuario;
     #57#6 = aTipoInstala;
     #57#7 = ~;
     |HORA aHora;
     #57#8 = aHora;
     #57#9 = aUsuari1;

     |GRABA 020#57a;
     |LIBERA #57;
     |CIERRA #57;
|FPRC;

|| ////////
|PROCESO CopiaFicheros;
     |HAZ GrabaAuxiliar;

     |SI #0#1 = "metextos";
         |SI #0#5 = " ";  #0#5 = "3";  |FINSI;
         |HAZ metextos;
         |ACABA;
     |FINSI;

     |SI #0#1 = "dsmom030";  |Y enPlan = 2008;
         |HAZ dsmom030;
         |ACABA;
     |FINSI;

     |SI #0#1 = "dsmom031";  |Y enPlan = 2008;
         |HAZ dsmom031;
         |ACABA;
     |FINSI;

     |SI #0#1 = "dsmom014";
         |SI enPlan = 2008; |O enPlan = 2019;
             |HAZ dsmom014;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #0#1 = "dsmom060";
         |SI enPlan = 2008; |O enPlan = 2015; |O enPlan = 2019;
             |HAZ dsmom060;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #0#1 = "dsmom061";
         |SI enPlan = 2008; |O enPlan = 2015; |O enPlan = 2019;
             |HAZ dsmom061;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #0#1 = "dsmom050";  |Y enPlan = 2008;
         |HAZ dsmom050;
         |ACABA;
     |FINSI;

     |SI #0#1 = "dsmom062";  |Y enPlan = 2008;
         |HAZ dsmom062;
         |ACABA;
     |FINSI;

     |SI #0#1 = "dsmom063";  |Y enPlan = 2008;
         |HAZ dsmom063;
         |ACABA;
     |FINSI;

     |SI #0#1 = "dsmom064";  |Y enPlan = 2008;
         |HAZ dsmom064;
         |ACABA;
     |FINSI;

     |SI #0#1 = "vaplanli";
         |SI enPlan = 2008; |O #0#5 = "2";
             |HAZ vaplanli;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #0#1 = "vaplanca";
         |SI enPlan = 2008; |O #0#5 = "2";
             |HAZ vaplanca;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #0#1 = "va8planl";
         |SI enPlan = 2008; |O #0#5 = "2";
             |HAZ va8planl;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #0#1 = "va8planc";
         |SI enPlan = 2008; |O #0#5 = "2";
             |HAZ va8planc;
             |ACABA;
        |FINSI;
     |FINSI;

     |SI #0#1 = "vaticuen";  |Y enPlan = 2008;
         |HAZ vaticuen;
         |ACABA;
     |FINSI;

     |SI #0#1 = "sodacuen";  |Y enPlan = 2008;
         |HAZ sodacuen;
         |ACABA;
     |FINSI;

     |SI #0#1 = "soplanca";  |Y #0#5 = "2";
         |HAZ soplanca;
         |ACABA;
     |FINSI;

     |SI #0#1 = "soplanli";  |Y #0#5 = "2";
         |HAZ soplanli;
         |ACABA;
     |FINSI;

     |SI #0#1 = "ca8accaa";
         |SI enPlan ] 2008; |O #0#5 = "2";
             |HAZ ca8accaa;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #0#1 = "ca8agmay"; |O #0#1 = "ca8comay"; |O #0#1 = "ca8cumay";
        |O  #0#1 = "ca8eqmay"; |O #0#1 = "ca8m0010";
         |SI enPlan ] 2008; |O #0#5 = "2";
             |HAZ ctamayor;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #0#1 = "ca8m0000"; |O #0#1 = "ca8m0001"; |O #0#1 = "ca8m0002";
         |O #0#1 = "ca8m0021"; |O #0#1 = "ca8m0022";
           |O #0#1 = "ca8m0006"; |O #0#1 = "ca8m0007";
             |O #0#1 = "ca8mtcol"; |O #0#1 = "ca8mtlin";
         |SI enPlan ] 2008; |O #0#5 = "2";
             |HAZ defbalance;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #0#1 = "soda8m02"; |O #0#1 = "soda8m03"; |O #0#1 = "soda8tco"; |O #0#1 = "soda8tli";
          |O #0#1 = "soda8m22"; |O #0#1 = "soda8m23";
         |SI enPlan ] 2008; |O #0#5 = "2";
             |HAZ defbalansoc;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #0#1 = "agitab99"; |Y enDesde ! 0; |Y enHasta ! 0;
         |HAZ agitab99;
         |ACABA;
     |FINSI;

     |SI #0#1 = "pdfdocca";
         |SUB_EJECUTA ":modelos/pdfdatos;CARGA";
     |FINSI;

     aFichero = #0#1 + "." + "ddx";  |QBT aFichero;
     aDestino = aPathFich    + aFichero;
     |FBORRA aDestino;

     aFichero = #0#1 + "." + "ixx";  |QBT aFichero;
     aDestino = aPathFich    + aFichero;
     |FBORRA aDestino;

     aFichero = #0#1 + "." + #0#0;   |QBT aFichero;
     aOrigen  = aDirPatrones + aFichero;
     aFichero = #0#1 + "." + "dat";  |QBT aFichero;
     aDestino = aPathFich    + aFichero;
     |COPIA_FICHERO aOrigen, aDestino;

     aDef = aPathDef + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en Cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #999 aPathFich;

     |ABRE #999;   |CIERRA #999;

     |DESCARGA_DEF #refere1@;

|FPRC;

|PROCESO Instalar;
     |SI #0#0 = "bas";
         aAplicacion = "basica";
         aNombAplica = "MODULO BASICO";
         aPathDef    = eaPathBasica + "def/";
         aPathFich   = eaPathBasica + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "soc";
         aAplicacion = "contasoc";
         aNombAplica = "SOCIEDADES";
         aPathDef    = eaPathContasoc + "def/";
         aPathFich   = eaPathContasoc + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "mod";
         aAplicacion = "modelos";
         aNombAplica = "MODELOS";
         aPathDef    = eaPathDsmodelo + "def/";
         aPathFich   = eaPathDsmodelo + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "r99";
         aAplicacion = "ren1999";
         aNombAplica = "RENTA Y PATRIM.1999";
         aPathDef    = eaPathRen1999 + "def/";
         aPathFich   = eaPathRen1999 + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "r00";
         aAplicacion = "ren2000";
         aNombAplica = "RENTA Y PATRIM.2000";
         aPathDef    = eaPathRen2000 + "def/";
         aPathFich   = eaPathRen2000 + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "r01";
         aAplicacion = "ren2001";
         aNombAplica = "RENTA Y PATRIM.2001";
         aPathDef    = eaPathRen2001 + "def/";
         aPathFich   = eaPathRen2001 + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "r02";
         aAplicacion = "ren2002";
         aNombAplica = "RENTA Y PATRIM.2002";
         aPathDef    = eaPathRen2002 + "def/";
         aPathFich   = eaPathRen2002 + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "r03";
         aAplicacion = "ren2003";
         aNombAplica = "RENTA Y PATRIM.2003";
         aPathDef    = eaPathRen2003 + "def/";
         aPathFich   = eaPathRen2003 + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "r04";
         aAplicacion = "ren2004";
         aNombAplica = "RENTA Y PATRIM.2004";
         aPathDef    = eaPathRen2004 + "def/";
         aPathFich   = eaPathRen2004 + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "r05";
         aAplicacion = "ren2005";
         aNombAplica = "RENTA Y PATRIM.2005";
         aPathDef    = eaPathRen2005 + "def/";
         aPathFich   = eaPathRen2005 + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "r06";
         aAplicacion = "ren2006";
         aNombAplica = "RENTA Y PATRIM.2006";
         aPathDef    = eaPathRen2006 + "def/";
         aPathFich   = eaPathRen2006 + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "r07";
         aAplicacion = "ren2007";
         aNombAplica = "RENTA Y PATRIM.2007";
         aPathDef    = eaPathRen2007 + "def/";
         aPathFich   = eaPathRen2007 + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "r08";
         aAplicacion = "ren2008";
         aNombAplica = "RENTA Y PATRIM.2008";
         aPathDef    = eaPathRen2008 + "def/";
         aPathFich   = eaPathRen2008 + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "r09";
         aAplicacion = "ren2009";
         aNombAplica = "RENTA Y PATRIM.2009";
         aPathDef    = eaPathRen2009 + "def/";
         aPathFich   = eaPathRen2009 + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "r10";
         aAplicacion = "ren2010";
         aNombAplica = "RENTA Y PATRIM.2010";
         aPathDef    = eaPathRen2010 + "def/";
         aPathFich   = eaPathRen2010 + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "r11";
         aAplicacion = "ren2011";
         aNombAplica = "RENTA Y PATRIM.2011";
         aPathDef    = eaPathRen2011 + "def/";
         aPathFich   = eaPathRen2011 + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "r12";
         aAplicacion = "ren2012";
         aNombAplica = "RENTA Y PATRIM.2012";
         aPathDef    = eaPathRen2012 + "def/";
         aPathFich   = eaPathRen2012 + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "r13";
         aAplicacion = "ren2013";
         aNombAplica = "RENTA Y PATRIM.2013";
         aPathDef    = eaPathRen2013 + "def/";
         aPathFich   = eaPathRen2013 + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "r14";
         aAplicacion = "ren2014";
         aNombAplica = "RENTA Y PATRIM.2014";
         aPathDef    = eaPathRen2014 + "def/";
         aPathFich   = eaPathRen2014 + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "r15";
         aAplicacion = "ren2015";
         aNombAplica = "RENTA Y PATRIM.2015";
         aPathDef    = eaPathRen2015 + "def/";
         aPathFich   = eaPathRen2015 + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "r16";
         aAplicacion = "ren2016";
         aNombAplica = "RENTA Y PATRIM.2016";
         aPathDef    = eaPathRen2016 + "def/";
         aPathFich   = eaPathRen2016 + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "r17";
         aAplicacion = "ren2017";
         aNombAplica = "RENTA Y PATRIM.2017";
         aPathDef    = eaPathRen2017 + "def/";
         aPathFich   = eaPathRen2017 + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "r18";
         aAplicacion = "ren2018";
         aNombAplica = "RENTA Y PATRIM.2018";
         aPathDef    = eaPathRen2018 + "def/";
         aPathFich   = eaPathRen2018 + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "r19";
         aAplicacion = "ren2019";
         aNombAplica = "RENTA Y PATRIM.2019";
         aPathDef    = eaPathRen2019 + "def/";
         aPathFich   = eaPathRen2019 + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "nex";
         aAplicacion = "contanex";
         aNombAplica = "UTILES CONTABILIDAD";
         aPathDef    = eaPathContanex + "def/";
         aPathFich   = eaPathContanex + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "gen";
         aAplicacion = "contagen";
         aNombAplica = "CONTABILIDAD";
         aPathDef    = eaPathContagen + "def/";
         aPathFich   = eaPathContagen + "fich/000000/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "lab";
         aAplicacion = "laboral";
         aNombAplica = "LABORAL";
         aPathDef    = eaPathLaboral + "def/";
         aPathFich   = eaPathLaboral + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;

     |SI #0#0 = "int";
         aAplicacion = "integral";
         aNombAplica = "INTEGRAL";
         aPathDef    = eaPathIntegral + "def/";
         aPathFich   = eaPathIntegral + "fich/";
         |HAZ CopiaFicheros;
     |FINSI;
|FPRC;

|DEFBUCLE dspatron;
     #0#1;
     4;
     aDExt, "        ", "S";
     aHExt, "zzzzzzzz", "S";
     ;
     NULL, Instalar;
|FIN;

|RUTINA ClaveBaja0;
     #0#0 = aDExt;
     #0#1 = "        ";
|FRUT;

|RUTINA ClaveAlta0;
     #0#0 = aHExt;
     #0#1 = "zzzzzzzz";
|FRUT;

|PROCESO CogeFicheros;
     aDirecBuscar = aDirPatrones + "*." + aExtension;
     |_PDIR aDirecBuscar;
     |PARA; |SI FSalida = 0; |HACIENDO;
            aFicheroOrigen = aDirecBuscar - aDirPatrones;

            |HAZ GrabaLineal;

            |_SDIR aDirecBuscar;
     |SIGUE;
|FPRC;

|PROCESO BorraFicheros;
     aDirecBuscar = aDirPatrones + "*";
     |_PDIR aDirecBuscar;
     |PARA; |SI FSalida = 0; |HACIENDO;
            aExtension = (aDirecBuscar % -103) > " ";
            |SI aExtension ! "TGZ";  |Y aExtension ! "EXE";
                |FBORRA aDirecBuscar;
            |FINSI;
            |_SDIR aDirecBuscar;
     |SIGUE;
|FPRC;

|PROGRAMA;
     |SI PARAMETRO ! "";
         eaRenta     = PARAMETRO;
         eaExtension = eaRenta;
     |FINSI;

     |DBASE aBase;  |QBF aBase;

     aDirPatron = aBase + "patrones/";
     aFichero   = aDirPatron + "zfichpat.tgz";
     |DESCOMPRIME aFichero;

     aFichero   = aDirPatron + "zfichpat.tar";
     |DETAR aFichero, aDirPatron;

     |FBORRA aFichero;

     |MENSA "     Gestionando Ficheros";
     |HAZ BusquedaApli;

     |DBASS aDirPatrones;  |QBF aDirPatrones;
     aDirPatrones = aDirPatrones + "basica/patrones/";

     aUsuario = Usuario % 108;
     aUsuari1 = Usuario % 840;

     |SI eaPrograma ! "";  |Y eaExtension ! "";
         aUsuari1 = "AUTOMATICO POR PROGRAMA";
         #0#0 = eaExtension;
         #0#1 = eaPrograma;
         nSwNombre = 1;
         |HAZ Instalar;
         |HAZ BorraFicheros;
         |ACABA;
     |FINSI;

     |SI PARAMETRO = "";
         |CUADRO 0501 2380;
         |BLANCO 0602 2279;
         |PINTA 1320, "Introduzca Password : ";
         E_inf = "";
         E_sup = "20";
         aPassword = 1342 ? -1;
         |SI aPassword ! "<MYPASWD>     ";
             |MENAV "     Permiso denegado.";
             |ACABA;
         |FINSI;
     |FINSI;

     |ABRE #0;  |CIERRA #0;  |DELINDEX #0;

     |ABRE #0;
     |SI eaPathBasica ! "";
         aExtension  = "bas";
         aAplicacion = "basica";
         aNombAplica = "MODULO BASICO";

         aPathFich   = eaPathBasica + "fich/";
         aPathDef    = eaPathBasica + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathContasoc ! "";
         aExtension  = "soc";
         aAplicacion = "contasoc";
         aNombAplica = "SOCIEDADES";

         aPathFich   = eaPathContasoc + "fich/";
         aPathDef    = eaPathContasoc + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathDsmodelo ! "";
         aExtension  = "mod";
         aAplicacion = "modelos";
         aNombAplica = "MODELOS";

         aPathFich   = eaPathDsmodelo + "fich/";
         aPathDef    = eaPathDsmodelo + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen1999 ! "";
         aExtension  = "r99";
         aAplicacion = "ren1999";
         aNombAplica = "RENTA Y PATRIM.1999";

         aPathFich   = eaPathRen1999 + "fich/";
         aPathDef    = eaPathRen1999 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2000 ! "";
         aExtension  = "r00";
         aAplicacion = "ren2000";
         aNombAplica = "RENTA Y PATRIM.2000";

         aPathFich   = eaPathRen2000 + "fich/";
         aPathDef    = eaPathRen2000 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2001 ! "";
         aExtension  = "r01";
         aAplicacion = "ren2001";
         aNombAplica = "RENTA Y PATRIM.2001";

         aPathFich   = eaPathRen2001 + "fich/";
         aPathDef    = eaPathRen2001 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2002 ! "";
         aExtension  = "r02";
         aAplicacion = "ren2002";
         aNombAplica = "RENTA Y PATRIM.2002";

         aPathFich   = eaPathRen2002 + "fich/";
         aPathDef    = eaPathRen2002 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2003 ! "";
         aExtension  = "r03";
         aAplicacion = "ren2003";
         aNombAplica = "RENTA Y PATRIM.2003";

         aPathFich   = eaPathRen2003 + "fich/";
         aPathDef    = eaPathRen2003 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2004 ! "";
         aExtension  = "r04";
         aAplicacion = "ren2004";
         aNombAplica = "RENTA Y PATRIM.2004";

         aPathFich   = eaPathRen2004 + "fich/";
         aPathDef    = eaPathRen2004 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2005 ! "";
         aExtension  = "r05";
         aAplicacion = "ren2005";
         aNombAplica = "RENTA Y PATRIM.2005";

         aPathFich   = eaPathRen2005 + "fich/";
         aPathDef    = eaPathRen2005 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2006 ! "";
         aExtension  = "r06";
         aAplicacion = "ren2006";
         aNombAplica = "RENTA Y PATRIM.2006";

         aPathFich   = eaPathRen2006 + "fich/";
         aPathDef    = eaPathRen2006 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2007 ! "";
         aExtension  = "r07";
         aAplicacion = "ren2007";
         aNombAplica = "RENTA Y PATRIM.2007";

         aPathFich   = eaPathRen2007 + "fich/";
         aPathDef    = eaPathRen2007 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2008 ! "";
         aExtension  = "r08";
         aAplicacion = "ren2008";
         aNombAplica = "RENTA Y PATRIM.2008";

         aPathFich   = eaPathRen2008 + "fich/";
         aPathDef    = eaPathRen2008 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2009 ! "";
         aExtension  = "r09";
         aAplicacion = "ren2009";
         aNombAplica = "RENTA Y PATRIM.2009";

         aPathFich   = eaPathRen2009 + "fich/";
         aPathDef    = eaPathRen2009 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2010 ! "";
         aExtension  = "r10";
         aAplicacion = "ren2010";
         aNombAplica = "RENTA Y PATRIM.2010";

         aPathFich   = eaPathRen2010 + "fich/";
         aPathDef    = eaPathRen2010 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2011 ! "";
         aExtension  = "r11";
         aAplicacion = "ren2011";
         aNombAplica = "RENTA Y PATRIM.2011";

         aPathFich   = eaPathRen2011 + "fich/";
         aPathDef    = eaPathRen2011 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2012 ! "";
         aExtension  = "r12";
         aAplicacion = "ren2012";
         aNombAplica = "RENTA Y PATRIM.2012";

         aPathFich   = eaPathRen2012 + "fich/";
         aPathDef    = eaPathRen2012 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2013 ! "";
         aExtension  = "r13";
         aAplicacion = "ren2013";
         aNombAplica = "RENTA Y PATRIM.2013";

         aPathFich   = eaPathRen2013 + "fich/";
         aPathDef    = eaPathRen2013 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2014 ! "";
         aExtension  = "r14";
         aAplicacion = "ren2014";
         aNombAplica = "RENTA Y PATRIM.2014";

         aPathFich   = eaPathRen2014 + "fich/";
         aPathDef    = eaPathRen2014 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2015 ! "";
         aExtension  = "r15";
         aAplicacion = "ren2015";
         aNombAplica = "RENTA Y PATRIM.2015";

         aPathFich   = eaPathRen2015 + "fich/";
         aPathDef    = eaPathRen2015 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2016 ! "";
         aExtension  = "r16";
         aAplicacion = "ren2016";
         aNombAplica = "RENTA Y PATRIM.2016";

         aPathFich   = eaPathRen2016 + "fich/";
         aPathDef    = eaPathRen2016 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2017 ! "";
         aExtension  = "r17";
         aAplicacion = "ren2017";
         aNombAplica = "RENTA Y PATRIM.2017";

         aPathFich   = eaPathRen2017 + "fich/";
         aPathDef    = eaPathRen2017 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2018 ! "";
         aExtension  = "r18";
         aAplicacion = "ren2018";
         aNombAplica = "RENTA Y PATRIM.2018";

         aPathFich   = eaPathRen2018 + "fich/";
         aPathDef    = eaPathRen2018 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2019 ! "";
         aExtension  = "r19";
         aAplicacion = "ren2019";
         aNombAplica = "RENTA Y PATRIM.2019";

         aPathFich   = eaPathRen2019 + "fich/";
         aPathDef    = eaPathRen2019 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathContanex ! "";
         aExtension  = "nex";
         aAplicacion = "contanex";
         aNombAplica = "UTILES CONTABILIDAD";

         aPathFich   = eaPathContanex + "fich/";
         aPathDef    = eaPathContanex + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathContagen ! "";
         aExtension  = "gen";
         aAplicacion = "contagen";
         aNombAplica = "CONTABILIDAD";

         aPathFich   = eaPathContagen + "fich/000000/";
         aPathDef    = eaPathContagen + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathLaboral ! "";
         aExtension  = "lab";
         aAplicacion = "laboral";
         aNombAplica = "LABORAL";

         aPathFich   = eaPathLaboral + "fich/";
         aPathDef    = eaPathLaboral + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathIntegral ! "";
         aExtension  = "int";
         aAplicacion = "integral";
         aNombAplica = "INTEGRAL";

         aPathFich   = eaPathIntegral + "fich/";
         aPathDef    = eaPathIntegral + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |CIERRA #0;

     aDExt = "   ";
     aHExt = "zzz";
     |SI eaRenta ! "";
         aDExt = eaRenta;
         aHExt = eaRenta;
         |BUCLE dspatron;
     |SINO;
         |ENTLINEAL #1#0, -2, 4, 22, 1, ClaveBaja0, ClaveAlta0;

         |CONFI "0000SDesea Realizar el pase en estos momentos : ";
         |SI FSalida = 0;
             |BUCLE dspatron;
         |FINSI;
     |FINSI;

     |DELINDEX #0;

     |HAZ BorraFicheros;
|FPRO;
