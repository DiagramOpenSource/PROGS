|FICHEROS;
     agiw0051 #0;

     &regisnif@ #709;
|FIN;

|VARIABLES;
     nCampo     = 0;
     nCampo1    = 0;
     nCampo2    = 0;
     aAlfa1     = "";
     aAlfa2     = "";


     &eaVarDni   = "";
     &enCalcCif  = 0;
     &eaCodNif   = "";

     &eaTabla    = "";
     &eaDestino  = "";
     &eaAlfa     = "";
     &enError    = 0;
     &enComp     = 0;
     &enPosicion = 0;
|FIN;

|PROCESO PonDatosw51;
     eaCodNif  = #0#0;
     |HAZ LeeNifs;

     #0#1  = #709#1;  |PINTA #0#1;
|FPRC;

|PROCESO Tipo12w51;  |TIPO 12;
     || Para que no pregunte el correcto si o no
|FPRC;

|PROCESO LetraDniw0051;  |TIPO 6;
     |SI FSalida = 10;
         eaVarDni  = #0Campo;
         enCalcCif = 1;
         |HAZ CalculoDNI;
         #0Campo = eaVarDni;
         |PINTA #0Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #0Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "         ") % 109;
     |SI #0Campo ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #0Campo = eaVarDni;  |PINTA #0Campo;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO SacaSgw51;  |TIPO 7;
     eaTabla = "txtm0001.txt";
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompruebaSgw51;  |TIPO 0;
     |SI FSalida = 10;
         enPosicion = 55;
         |HAZ SacaTabla;
         #0Campo = eaDestino % 102;
         |PINTA #0Campo;
     |FINSI;

     enComp = 2;
     eaAlfa = #0Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     |HAZ FinTabla;
|FPRC;

|PROCESO SacaCalidadw51;  |TIPO 7;
     eaTabla = "txtm0005.txt";
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompruebaCalidadw51;  |TIPO 0;
     nCampo   = Campo + 1;
     |SI FSalida = 10;
         enPosicion = 55;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 101;
         #0Campo  = aAlfa1;
         |PINTA #0Campo;
     |FINSI;

     enComp = 1;
     eaAlfa = #0Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 101;
     aAlfa2   = eaDestino % 415;
     #0Campo  = aAlfa1;
     #0nCampo = aAlfa2;

     |PINTA #0Campo;
     |PINTA #0nCampo;

     |HAZ FinTabla;

     |C_M #0nCampo, 1, "N";
     |SI #0Campo = " ";  |C_M #0nCampo, 1, "S";  |FINSI;
|FPRC;

|PROCESO SacaJuridicasw51;  |TIPO 7;
     nCampo1  = Campo - 1;
     nCampo2  = Campo + 1;

     |C_M #0Campo, 1, "S";
     |SI #0nCampo1 = " ";
         #0Campo   = "";
         #0nCampo2 = "";
         |C_M #0Campo, 1, "N";
     |FINSI;

     |SI Campo = 29;   eaTabla = "txtm0002.txt";  |FINSI;
     |SI Campo = 32;   eaTabla = "txtm0003.txt";  |FINSI;
     |SI Campo = 35;   eaTabla = "txtm0003.txt";  |FINSI;
     |SI Campo = 38;   eaTabla = "txtm0004.txt";  |FINSI;
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompruebaJuridicasw51;  |TIPO 0;
     nCampo   = Campo + 1;
     |SI FSalida = 10;
         enPosicion = 30;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 102;
         #0Campo  = aAlfa1;
         |PINTA #0Campo;
     |FINSI;

     enComp = 2;
     eaAlfa = #0Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 102;
     aAlfa2   = eaDestino % 440;
     #0Campo  = aAlfa1;
     #0nCampo = aAlfa2;

     |PINTA #0Campo;
     |PINTA #0nCampo;

     |HAZ FinTabla;
|FPRC;
