|FICHEROS;
     agiz0023 #23;
     dsinform #0,MANTE;
     refere1@ #999;
     refere2@ #998;
|FIN;

|VARIABLES;
     nHandle         = 0;
     nCampo          = 0;
     nDTexto         = 0;
     nHTexto         = 0;

     aExtension      = "";
     aAplicacion     = "";
     aNombAplica     = "";
     aPathFich       = "";
     aPathDef        = "";
     aDirecBuscar    = "";
     aDirPatrones    = "";
     aFicheroOrigen  = "";
     aQueQuiero      = "";
     aTitulo         = "";
     aDef            = "";
     aFich           = "";
     aInstalar       = "";
     aOrigen         = "";
     aDestino        = "";
     aFichero        = "";
     aAlfa           = "";
     aBase           = "";
     aDirPatron      = "";
     aDExt           = "";
     aHExt           = "";
     aParam          = "";
     aParam1         = "";

     &eaPathBasica   = "";
     &eaPathContagen = "";
     &eaPathContanex = "";
     &eaPathContasoc = "";
     &eaPathRen2019  = "";
     &eaPathRen2018  = "";
     &eaPathRen2017  = "";
     &eaPathRen2016  = "";
     &eaPathRen2015  = "";
     &eaPathRen2014  = "";
     &eaPathRen2013  = "";
     &eaPathRen2012  = "";
     &eaPathRen2011  = "";
     &eaPathRen2010  = "";
     &eaPathRen2009  = "";
     &eaPathRen2008  = "";
     &eaPathRen2007  = "";
     &eaPathRen2006  = "";
     &eaPathRen2005  = "";
     &eaPathRen2004  = "";
     &eaPathRen2003  = "";
     &eaPathRen2002  = "";
     &eaPathRen2001  = "";
     &eaPathRen2000  = "";
     &eaPathRen1999  = "";
     &eaPathRen1998  = "";
     &eaPathRen1997  = "";
     &eaPathRen1996  = "";
     &eaPathRen1995  = "";
     &eaPathRen1994  = "";
     &eaPathFacturar = "";
     &eaPathLaboral  = "";
     &eaPathIntegral = "";
     &eaPathDsmodelo = "";
     &eaPathFiscal   = "";
     &eaPrograma     = "";
     &eaExtension    = "";
     &eaRenta        = "";
     aTitMenu        = "";
     aTipoS          = "";
     aTipoP          = "";
     nContar         = 0;
     nContarI        = 0;
     nContarP        = 0;

     nNumero         = 0;
     &enSwalgun      = 0;
     aNomTgz         = "";
|FIN;

|PROCESO MTipo5;  |TIPO 5;
|FPRC;

|PROCESO Tipo11P;
|FPRC;

|PROCESO Tipo11;  |TIPO 11;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     |LEE 101#0=;
     |SI #0#4 = "N";
         #0#4 = "S";
     |SINO;
         #0#4 = "N";
     |FINSI;

     |PINTA #0#4;

     |GRABA 020#0a;
     |LIBERA #0;
|FPRC;

|PROCESO BuscoTilMenu;
  aTipoS   = "1";
  aTitMenu = "";
  aTipoP   = "I";
  |SI #0#1 = "agiy0016";
      aTitMenu = "Gestion y Emision de Caratulas para Libros Oficiales                    "; aTipoP = "I";
      nContarI = nContarI + 1; nContar = 1;
      |ACABA;
  |FINSI;
  |SI #0#1 = "agiy0012";
      aTitMenu = "Informe General de Rend. Anuales de Actividades Economicas de Clientes  "; aTipoP = "I";
      nContarI = nContarI + 1; nContar = 2;
      |ACABA;
  |FINSI;

  |SI #0#1 = "dsmoy050"; aTitMenu = "Informe de Comprobacion de la Valoracion Patrimonial de la Empresa      "; aTipoP = "I"; |FINSI;
  |SI #0#1 = "cay00001"; |Y nNumero = 1; aTitMenu = "Informe de Comprobacion de Situacion y Tesoreria                        "; aTipoP = "I"; |FINSI;
  |SI #0#1 = "cay00001"; |Y nNumero = 2; aTitMenu = "Carta de Situacion y Tesoreria                                          "; aTipoP = "I"; |FINSI;
  |SI #0#1 = "cabaresu"; aTitMenu = "Balance de Cuentas Contables                                            "; aTipoP = "I"; |FINSI;
  |SI #0#1 = "cabalgen"; aTitMenu = "Balance de Cuentas Contables General                                    "; aTipoP = "I"; |FINSI;
  |SI #0#1 = "agiy0023"; aTitMenu = "Informe General de Rend. Mensuales de Actividades Economicas de Clientes"; aTipoP = "I"; |FINSI;
  |SI #0#1 = "dsmoy005"; aTitMenu = "Inf. Gral Tributacion Historica Clientes Filtrado por Modelos Oficiales "; aTipoP = "I"; |FINSI;
  |SI #0#1 = "dsmoy006"; aTitMenu = "Inf. Gral Tributacion Historica Clientes Filtrado por Ejercicio Economico";aTipoP = "I"; |FINSI;
  |SI #0#1 = "cafaccue"; aTitMenu = "Informe de Comprobacion de Facturas por Cuentas Contables               "; aTipoP = "I"; |FINSI;
  |SI #0#1 = "dsmoy057"; aTitMenu = "Informe Interno de Situacion Contable                                   "; aTipoP = "I"; |FINSI;
  |SI #0#1 = "dsmoy046"; aTitMenu = "Inventario de Elementos Amort. Activos/Inactivos del Inmov. Empresarial "; aTipoP = "I"; |FINSI;
  |SI #0#1 = "dsmoy012"; |Y nNumero = 1; aTitMenu = "Cuenta de perdidas y ganancias en Estimacion Directa (por Trimestres)   "; aTipoP = "I"; |FINSI;
  |SI #0#1 = "dsmoy012"; |Y nNumero = 2; aTitMenu = "Cuenta de perdidas y ganancias en Estimacion Directa (Total)            "; aTipoP = "I"; |FINSI;
  |SI #0#1 = "caybames"; aTitMenu = "Balance de Movimientos Totales de Cuentas Contables por Periodos        "; aTipoP = "I"; |FINSI;
  |SI #0#1 = "cay3ivas"; |Y nNumero = 1; aTitMenu = "Informe de Comprobacion de Registros de IVA por Conceptos Contables     "; aTipoP = "I"; |FINSI;
  |SI #0#1 = "cay3ivas"; |Y nNumero = 2; aTitMenu = "Informe Resumen de Totales de Conceptos Contables en IVA                "; aTipoP = "I"; |FINSI;
  |SI #0#1 = "dsmoy084"; aTitMenu = "Resumen de Rendimientos de Actividades Ejercidas                        "; aTipoP = "I"; |FINSI;

  |SI #0#1 = "ca8ys001"; aTitMenu = "Balance de Situacion                                                    "; aTipoP = "I"; aTipoS = "1"; |FINSI;
  |SI #0#1 = "ca8ye001"; aTitMenu = "Cuenta de Perdidas y Ganancias                                          "; aTipoP = "I"; aTipoS = "1"; |FINSI;

  |SI #0#1 = "ca8yp001"; aTitMenu = "Balance de Estado de Ingresos y Gastos reconocidos                      "; aTipoP = "I"; aTipoS = "1"; |FINSI;
  |SI #0#1 = "ca8yc001"; aTitMenu = "Balance de Estado de Cambios en el Patrimonio Neto                      "; aTipoP = "I"; aTipoS = "1"; |FINSI;
  |SI #0#1 = "ca8yf001"; aTitMenu = "Balance de Estado de Flujos de efectivo                                 "; aTipoP = "I"; aTipoS = "1"; |FINSI;
  |SI #0#1 = "caybal01"; |Y nNumero = 1; aTitMenu = "Analisis Mensual de Ingresos y Gastos (DETALLADO)       "; aTipoP = "I"; aTipoS = "1"; |FINSI;
  |SI #0#1 = "caybal01"; |Y nNumero = 2; aTitMenu = "Analisis Mensual de Ingresos y Gastos (RESUMIDO)        "; aTipoP = "I"; aTipoS = "1"; |FINSI;
  |SI #0#1 = "caextinf"; aTitMenu = "Informe de las Anotaciones de Revision Contable                         "; aTipoP = "I"; aTipoS = "3"; |FINSI;
  |SI #0#1 = "caextrim"; aTitMenu = "Extracto de Cuentas Contables                                           "; aTipoP = "I"; aTipoS = "2"; |FINSI;
  |SI #0#1 = "caycosy0"; aTitMenu = "Balance de Sumas y Saldos                                               "; aTipoP = "I"; aTipoS = "1"; |FINSI;
  |SI #0#1 = "dsay0019"; aTitMenu = "Informe de Embargos Anotados                                            "; aTipoP = "I"; aTipoS = "4"; |FINSI;
  |SI #0#1 = "socz0001"; aTitMenu = "Informe de Retribuciones de Administradores                             "; aTipoP = "I"; aTipoS = "5"; |FINSI;
  |SI #0#1 = "socz0002"; |Y nNumero = 1; aTitMenu = "Ficha de prestamos con Socios                           "; aTipoP = "I"; aTipoS = "5"; |FINSI;
  |SI #0#1 = "socz0002"; |Y nNumero = 2; aTitMenu = "Resumen de Prestamos a Socios                           "; aTipoP = "I"; aTipoS = "5"; |FINSI;

  |SI aTipoP = "I"; nContarI = nContarI + 1; nContar = nContarI; |FINSI;
  |SI aTipoP = "P"; nContarP = nContarP + 1; nContar = nContarP; |FINSI;
|FPRC;

|PROCESO GrabaLineal;
     aDef = aPathDef + (aFicheroOrigen % 108) + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refere1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aQueQuiero = "|TITULO";
     aTitulo    = #999#aQueQuiero#;

     |DESCARGA_DEF #refere1@;

     aInstalar = "S";
     aFich     = aPathFich + (aFicheroOrigen % 108) + ".dat";  |QBT aFich;
     |XABRE "E", aFich, nHandle;
     |SI FSalida ] 0;  aInstalar = "N";  |FINSI;

     |DDEFECTO #0;
     #0#0 = (aFicheroOrigen % -103) < "";
     #0#1 = (aFicheroOrigen % 108) < "";
     #0#9 = nNumero;
     |LEE 101#0=;
     |SI FSalida ! 0;
          #0#0 = (aFicheroOrigen % -103) < "";
          #0#1 = (aFicheroOrigen % 108) < "";
          #0#4 = aInstalar;
          #0#9 = nNumero;
          |GRABA 020#0b;
     |FINSI;
     #0#2 = aTitulo > "";
     #0#3 = aNombAplica;
     #0#5 = ":"+aAplicacion+"/"+#0#1;
     |SI aParam1 = "CON";
         aAlfa = #0#1 % 104;
         |SI aAlfa = "ca8y"; |O aAlfa = "cayc";
             #0#5 = ":"+aAplicacion+"/ca8ytodo";
         |FINSI;
     |FINSI;
     |HAZ BuscoTilMenu;
     #0#6 = aTitMenu;
     #0#7 = nContar;
     #0#8 = aTipoP;
     |SI aParam1 = "CON"; #0#8 = aTipoS; |FINSI;
     |GRABA 020#0a;
     |LIBERA #0;

     enSwalgun = 1;
|FPRC;

|PROCESO GrabaLineal_Mas;

     nNumero = 1;
     |HAZ GrabaLineal;

     |SI aFicheroOrigen = "dsmoy012.mod";
         nNumero = 2;
         |HAZ GrabaLineal;
     |FINSI;
     |SI aFicheroOrigen = "cay3ivas.gen";
         nNumero = 2;
         |HAZ GrabaLineal;
     |FINSI;
     |SI aFicheroOrigen = "cay00001.gen";
         nNumero = 2;
         |HAZ GrabaLineal;
     |FINSI;

     |SI aFicheroOrigen = "caybal01.gen";
         nNumero = 2;
         |HAZ GrabaLineal;
     |FINSI;

     |SI aFicheroOrigen = "socz0002.bas";
         nNumero = 2;
         |HAZ GrabaLineal;
     |FINSI;
|FPRC;

|RUTINA ClaveBaja0;
     #0#0 = aDExt;
     #0#1 = "        ";
     #0#9 = 1;
|FRUT;

|RUTINA ClaveAlta0;
     #0#0 = aHExt;
     #0#1 = "zzzzzzzz";
     #0#9 = 9;
|FRUT;

|PROCESO CogeFicheros;
     aDirecBuscar = aDirPatrones + "*." + aExtension;
     |_PDIR aDirecBuscar;
     |PARA; |SI FSalida = 0; |HACIENDO;
            aFicheroOrigen = aDirecBuscar - aDirPatrones;

            |HAZ GrabaLineal_Mas;

            |_SDIR aDirecBuscar;
     |SIGUE;
|FPRC;

|PROCESO BorraFicheros;
     aDirecBuscar = aDirPatrones + "*";
     |_PDIR aDirecBuscar;
     |PARA; |SI FSalida = 0; |HACIENDO;
            aExtension = (aDirecBuscar % -103) > " ";
            |SI aExtension ! "TGZ";  |Y aExtension ! "EXE";
                |FBORRA aDirecBuscar;
            |FINSI;
            |_SDIR aDirecBuscar;
     |SIGUE;
|FPRC;

|PROGRAMA;
     aParam = PARAMETRO; |QBF aParam;

     aNomTgz = "zlistinf";
     aParam1  = aParam % 103;
     |SI aParam1  = "CON";
         aNomTgz  = "zlistcon";
         aParam   = aParam - aParam1;
         aFichero = ("lc" + Usuario) % 108;
         |NOME_DAT #0 aFichero;
         |DELINDEX #0;
     |FINSI;

     |DBASE aBase;  |QBF aBase;

     aDirPatron = aBase + "patrones/";
     aFichero   = aDirPatron + aNomTgz + ".tgz";
     |DESCOMPRIME aFichero;

     aFichero   = aDirPatron + aNomTgz + ".tar";
     |DETAR aFichero, aDirPatron;

     |FBORRA aFichero;

     |MENSA "     Gestionando Ficheros";
     |HAZ BusquedaApli;

     |DBASS aDirPatrones;  |QBF aDirPatrones;
     aDirPatrones = aDirPatrones + "basica/patrones/";

     || ... |ABRE #0;  |CIERRA #0;  |DELINDEX #0;
     nContar  = 0;
     nContarP = 0;
     nContarI = 0;

     |ABRE #0;
     |SI eaPathBasica ! "";
         aExtension  = "bas";
         aAplicacion = "basica";
         aNombAplica = "MODULO BASICO";

         aPathFich   = eaPathBasica + "fich/";
         aPathDef    = eaPathBasica + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathContasoc ! "";
         aExtension  = "soc";
         aAplicacion = "contasoc";
         aNombAplica = "SOCIEDADES";

         aPathFich   = eaPathContasoc + "fich/";
         aPathDef    = eaPathContasoc + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathDsmodelo ! "";
         aExtension  = "mod";
         aAplicacion = "modelos";
         aNombAplica = "MODELOS";

         aPathFich   = eaPathDsmodelo + "fich/";
         aPathDef    = eaPathDsmodelo + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen1999 ! "";
         aExtension  = "r99";
         aAplicacion = "ren1999";
         aNombAplica = "RENTA Y PATRIM.1999";

         aPathFich   = eaPathRen1999 + "fich/";
         aPathDef    = eaPathRen1999 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2000 ! "";
         aExtension  = "r00";
         aAplicacion = "ren2000";
         aNombAplica = "RENTA Y PATRIM.2000";

         aPathFich   = eaPathRen2000 + "fich/";
         aPathDef    = eaPathRen2000 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2001 ! "";
         aExtension  = "r01";
         aAplicacion = "ren2001";
         aNombAplica = "RENTA Y PATRIM.2001";

         aPathFich   = eaPathRen2001 + "fich/";
         aPathDef    = eaPathRen2001 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2002 ! "";
         aExtension  = "r02";
         aAplicacion = "ren2002";
         aNombAplica = "RENTA Y PATRIM.2002";

         aPathFich   = eaPathRen2002 + "fich/";
         aPathDef    = eaPathRen2002 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2003 ! "";
         aExtension  = "r03";
         aAplicacion = "ren2003";
         aNombAplica = "RENTA Y PATRIM.2003";

         aPathFich   = eaPathRen2003 + "fich/";
         aPathDef    = eaPathRen2003 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2004 ! "";
         aExtension  = "r04";
         aAplicacion = "ren2004";
         aNombAplica = "RENTA Y PATRIM.2004";

         aPathFich   = eaPathRen2004 + "fich/";
         aPathDef    = eaPathRen2004 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2005 ! "";
         aExtension  = "r05";
         aAplicacion = "ren2005";
         aNombAplica = "RENTA Y PATRIM.2005";

         aPathFich   = eaPathRen2005 + "fich/";
         aPathDef    = eaPathRen2005 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2006 ! "";
         aExtension  = "r06";
         aAplicacion = "ren2006";
         aNombAplica = "RENTA Y PATRIM.2006";

         aPathFich   = eaPathRen2006 + "fich/";
         aPathDef    = eaPathRen2006 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2007 ! "";
         aExtension  = "r07";
         aAplicacion = "ren2007";
         aNombAplica = "RENTA Y PATRIM.2007";

         aPathFich   = eaPathRen2007 + "fich/";
         aPathDef    = eaPathRen2007 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2008 ! "";
         aExtension  = "r08";
         aAplicacion = "ren2008";
         aNombAplica = "RENTA Y PATRIM.2008";

         aPathFich   = eaPathRen2008 + "fich/";
         aPathDef    = eaPathRen2008 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2009 ! "";
         aExtension  = "r09";
         aAplicacion = "ren2009";
         aNombAplica = "RENTA Y PATRIM.2009";

         aPathFich   = eaPathRen2009 + "fich/";
         aPathDef    = eaPathRen2009 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2010 ! "";
         aExtension  = "r10";
         aAplicacion = "ren2010";
         aNombAplica = "RENTA Y PATRIM.2010";

         aPathFich   = eaPathRen2010 + "fich/";
         aPathDef    = eaPathRen2010 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2011 ! "";
         aExtension  = "r11";
         aAplicacion = "ren2011";
         aNombAplica = "RENTA Y PATRIM.2011";

         aPathFich   = eaPathRen2011 + "fich/";
         aPathDef    = eaPathRen2011 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2012 ! "";
         aExtension  = "r12";
         aAplicacion = "ren2012";
         aNombAplica = "RENTA Y PATRIM.2012";

         aPathFich   = eaPathRen2012 + "fich/";
         aPathDef    = eaPathRen2012 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2013 ! "";
         aExtension  = "r13";
         aAplicacion = "ren2013";
         aNombAplica = "RENTA Y PATRIM.2013";

         aPathFich   = eaPathRen2013 + "fich/";
         aPathDef    = eaPathRen2013 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2014 ! "";
         aExtension  = "r14";
         aAplicacion = "ren2014";
         aNombAplica = "RENTA Y PATRIM.2014";

         aPathFich   = eaPathRen2014 + "fich/";
         aPathDef    = eaPathRen2014 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2015 ! "";
         aExtension  = "r15";
         aAplicacion = "ren2015";
         aNombAplica = "RENTA Y PATRIM.2015";

         aPathFich   = eaPathRen2015 + "fich/";
         aPathDef    = eaPathRen2015 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2016 ! "";
         aExtension  = "r16";
         aAplicacion = "ren2016";
         aNombAplica = "RENTA Y PATRIM.2016";

         aPathFich   = eaPathRen2016 + "fich/";
         aPathDef    = eaPathRen2016 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2017 ! "";
         aExtension  = "r17";
         aAplicacion = "ren2017";
         aNombAplica = "RENTA Y PATRIM.2017";

         aPathFich   = eaPathRen2017 + "fich/";
         aPathDef    = eaPathRen2017 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2018 ! "";
         aExtension  = "r18";
         aAplicacion = "ren2018";
         aNombAplica = "RENTA Y PATRIM.2018";

         aPathFich   = eaPathRen2018 + "fich/";
         aPathDef    = eaPathRen2018 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathRen2019 ! "";
         aExtension  = "r19";
         aAplicacion = "ren2019";
         aNombAplica = "RENTA Y PATRIM.2019";

         aPathFich   = eaPathRen2019 + "fich/";
         aPathDef    = eaPathRen2019 + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathContanex ! "";
         aExtension  = "nex";
         aAplicacion = "contanex";
         aNombAplica = "UTILES CONTABILIDAD";

         aPathFich   = eaPathContanex + "fich/";
         aPathDef    = eaPathContanex + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathContagen ! "";
         aExtension  = "gen";
         aAplicacion = "contagen";
         aNombAplica = "CONTABILIDAD";

         aPathFich   = eaPathContagen + "fich/000000/";
         aPathDef    = eaPathContagen + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathLaboral ! "";
         aExtension  = "lab";
         aAplicacion = "laboral";
         aNombAplica = "LABORAL";

         aPathFich   = eaPathLaboral + "fich/";
         aPathDef    = eaPathLaboral + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |SI eaPathIntegral ! "";
         aExtension  = "int";
         aAplicacion = "integral";
         aNombAplica = "INTEGRAL";

         aPathFich   = eaPathIntegral + "fich/";
         aPathDef    = eaPathIntegral + "def/";
         |HAZ CogeFicheros;
     |FINSI;

     |CIERRA #0;

     aDExt = "   ";
     aHExt = "zzz";
     |SI eaRenta ! "";
         aDExt = eaRenta;
         aHExt = eaRenta;
     |FINSI;

     |SI aParam = "MENU";
         |ENTLINEAL #1#0, -2, 4, 22, 1, ClaveBaja0, ClaveAlta0;
     |FINSI;

     |HAZ BorraFicheros;
|FPRO;
