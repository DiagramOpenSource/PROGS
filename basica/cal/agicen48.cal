|FICHEROS;
     agicen48 #480
     agimunic #100;
     :/integral/def/dsam0115 #115;
|FIN;

|VARIABLES;
     nCampo     = 0;
     nCampo1    = 0;
     nCampo2    = 0;
     nCampo3    = 0;
     nCampo4    = 0;
     aAlfa1     = "";
     aAlfa2     = "";

     &eaVarDni  = "";
     &enCalcCif = 0;

     &eaTabla    = "";
     &eaDestino  = "";
     &eaAlfa     = "";
     &enError    = 0;
     &enComp     = 0;
     &enPosicion = 0;
     &eaPathIntegral = "";
     &eaSigla5       = "";
|FIN;

|PROCESO inf115_48;
  #115#2 = "     ";
|FPRC;

|PROCESO sup115_48;
  #115#2 = "zzzzz";
|FPRC;


|PROCESO SacaSgCen48;  |TIPO 7;
     |SI eaPathIntegral = "";
         eaTabla = "txtn0001.txt";
         |HAZ CargaTabla;
     |FINSI;
|FPRC;

|PROCESO CompruebaSgCen48;  |TIPO 0;
     |SI eaPathIntegral = "";
          |SI FSalida = 10;
              enPosicion = 55;
              |HAZ SacaTabla;
              #480Campo = eaDestino % 105;
              |PINTA #480Campo;
          |FINSI;

          enComp = 5;
          eaAlfa = #480Campo;
          |HAZ CompruebaTabla;

          |SI enError = 1;
              |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
              || |ERROR;
              || |ACABA;
          |FINSI;

          |HAZ FinTabla;
    |SINO;
         |SI FSalida = 10;
             |ABRE #115;
             |CONSULTA_F_CLAVE #3#115, inf115_48, sup115_48;
             |CIERRA #115;
             #480Campo = #115#2; |PINTA #480Campo;
         |FINSI;

         aAlfa1 = #480Campo; |QBF aAlfa1;
         |SI aAlfa1 ! "";
             |ABRE #115;
             |SELECT #3#115;
             #115#2 = #480Campo;
             |LEE 040#115=
             |SI FSalida ! 0;
                |MENAV "0000 Contenido Incorrecto. Consulta el Fichero de Siglas con F2";
                ||  |ERROR;  tique 475_1346 que informen lo que quieran
             |FINSI;
             |SELECT #1#115;
             |CIERRA #115;
        |FINSI;
    |FINSI;
|FPRC;

|PROCESO SacaSiglaCen48;  |TIPO 7;
     |SI #480#4 = "D";  |ACABA;  |FINSI;

     eaTabla = "txtm0014.txt";
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompruebaSiglaCen48;  |TIPO 0;
     |SI #480#4 = "D";  |ACABA;  |FINSI;

     nCampo   = Campo + 1;
     |SI FSalida = 10;
         enPosicion = 55;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 102;
         #480Campo  = aAlfa1;
         |PINTA #480Campo;
     |FINSI;

     enComp = 2;
     eaAlfa = #480Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1    = eaDestino % 102;
     aAlfa2    = eaDestino % 425;
     #480Campo  = aAlfa1;
     #480nCampo = aAlfa2;

     |PINTA #480Campo;
     |PINTA #480nCampo;

     |HAZ FinTabla;
|FPRC;

|PROCESO FueraLocalCen48;
     |C_M #480#19, 1, "S";
     |SI #480#18 ! "S";
         |C_M #480#19, 1, "N";  #480#19 = "01.01.0000";  |PINTA #480#19;
     |FINSI;

     |C_M #480#22, 1, "S";
     |C_M #480#23, 1, "S";
     |SI #480#21 ! "S";
         |C_M #480#22, 1, "N";  #480#22 = "01.01.0000";  |PINTA #480#22;
         |C_M #480#23, 1, "N";  #480#23 = "";            |PINTA #480#23;
     |FINSI;

     |C_M #480#25, 1, "S";
     |C_M #480#26, 1, "S";
     |SI #480#24 ! "S";
         |C_M #480#25, 1, "N";  #480#25 = "01.01.0000";  |PINTA #480#25;
         |C_M #480#26, 1, "N";  #480#26 = "";            |PINTA #480#26;
     |FINSI;

     |C_M #480#27, 1, "S";
     |C_M #480#28, 1, "S";
     |SI #480#4 = "D";
         |C_M #480#27, 1, "N";  #480#27 = "";  |PINTA #480#27;
         |C_M #480#28, 1, "N";  #480#28 = "";  |PINTA #480#28;
     |FINSI;
|FPRC;

|PROCESO SacaMuni48;
     || nCampo = Cod. Postal
     || nCampo1 = Nombre Municipio
     || nCampo2 = Codigo Provincia
     || nCampo3 = Nombre Provincia
     || nCampo4 = Codigo Municipio

     |SI Campo = 11;
          nCampo1 = 13;
          nCampo2 = 30;
          nCampo3 = 14;
          nCampo4 = 29;
     |FINSI;
     |SI FSalida = 10;
          |SUB_EJECUTA "agimunic";
          |ABRE #100;
          |CONSULTA_CLAVE #1#100;
          |SI FSalida = 0;
               nCampo = Campo;
               #480nCampo = #100#0;     |PINTA #480nCampo;
               #480nCampo1 = #100#3;     |PINTA #480nCampo1;
               #480nCampo2 = (#100#0 % 102);     |PINTA #480nCampo2;
               #480nCampo3 = #100#2;     |PINTA #480nCampo3;
               #480nCampo4 = #100#1;     |PINTA #480nCampo4;
               |ACABA;
          |FINSI;
          |CIERRA #100;
     |FINSI;
     |ABRE #100;
     |SELECT #4#100;
     #100#0 = #480Campo;
     |LEE 000#100=;
     |SI FSalida = 0;
          |SI #480nCampo ! Contenido;
               nCampo = Campo;
               #480nCampo = #100#0;     |PINTA #480nCampo;
               #480nCampo1 = #100#3;     |PINTA #480nCampo1;
               #480nCampo2 = (#100#0 % 102);     |PINTA #480nCampo2;
               #480nCampo3 = #100#2;     |PINTA #480nCampo3;
               #480nCampo4 = #100#1;     |PINTA #480nCampo4;
          |FINSI;
     |SINO;
          |SI #480Campo ! "     ";
               |MENAV "    El Código Postal no existe. Pulse F2 para ver la lista."
               |ERROR;
          |FINSI;
               nCampo = Campo;
               #480nCampo = "";     |PINTA #480nCampo;
               #480nCampo1 = "";     |PINTA #480nCampo1;
               #480nCampo2 = "";     |PINTA #480nCampo2;
               #480nCampo3 = "";     |PINTA #480nCampo3;
               #480nCampo4 = "";     |PINTA #480nCampo4;
     |FINSI;
     |CIERRA #100;
|FPRC;
