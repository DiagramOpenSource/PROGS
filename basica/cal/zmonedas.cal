|FICHEROS;
     zmonedas #0;
|FIN;

|VARIABLES;
      aAlfa          = "";
      aAbre          = "";
      aContenido     = "";

      nHandle        = 0;
      nDsConver      = 0;

     &eaBase         = "";
     &eaAplica       = "";
     &eaEmpresa      = "";
     &eaMoneda       = "";
     &enDesdeConver  = 0;
     &eaPathIntegral = "";
     &eaPathBasica   = "";
     &eaPathLaboral  = "";
     &eaPathContasoc = "";
     &eaPathDsmodelo = "";
     &eaPathContanex = "";
|FIN;

|PROCESO Integra;
     eaAplica   = "integral";
     aContenido = Contenido;
     |SI eaPathIntegral  = "";  |ACABA;  |FINSI;

     #0#2 = "PESETAS";
     |SI #0#1 = "E";  #0#2 = "EUROS";  |FINSI;
     |PINTA #0#2;

     aAbre = eaBase + eaAplica + "/integral.sui"
     |XABRE "W", aAbre, nHandle;
     |SI #0#1 = "E";
         aAlfa = "DsEuroConvierte=166.386" + &13 + &10;  |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoOtro=0"   + &13 + &10;       |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoNormal=2" + &13 + &10;       |XGRABA nHandle, aAlfa;
     |SINO;
         aAlfa = "DsEuroConvierte=0.00601012" + &13 + &10;  |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoOtro=2"   + &13 + &10;       |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoNormal=0" + &13 + &10;       |XGRABA nHandle, aAlfa;
     |FINSI;
     |XCIERRA nHandle;

     |SI nDsConver = 0;
         |SI aContenido = #0#1;  |ACABA;  |FINSI;
     |FINSI;

     |SALVA_DATOS #0;
     |LEE 101#0p;
     |REPON_DATOS #0;
     |GRABA 020#0a;
     |LIBERA #0;

     eaAplica      = "integral";
     eaEmpresa     = "";
     eaMoneda      = #0#1;

     |SI enDesdeConver = 1;  |ACABA;  |FINSI;

     |SUB_EJECUTA_NP ":agitool/dsconver";
|FPRC;

|PROCESO Basica;
     eaAplica   = "basica";
     aContenido = Contenido;
     |SI eaPathBasica    = "";  |ACABA;  |FINSI;

     #0#4 = "PESETAS";
     |SI #0#3 = "E";  #0#4 = "EUROS";  |FINSI;
     |PINTA #0#4;

     aAbre = eaBase + eaAplica + "/basica.sui"
     |XABRE "W", aAbre, nHandle;
     |SI #0#3 = "E";
         aAlfa = "DsEuroConvierte=166.386" + &13 + &10;  |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoOtro=0"   + &13 + &10;       |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoNormal=2" + &13 + &10;       |XGRABA nHandle, aAlfa;
     |SINO;
         aAlfa = "DsEuroConvierte=0.00601012" + &13 + &10;  |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoOtro=2"   + &13 + &10;       |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoNormal=0" + &13 + &10;       |XGRABA nHandle, aAlfa;
     |FINSI;
     |XCIERRA nHandle;


     |SI nDsConver = 0;
         |SI aContenido = #0#3;  |ACABA;  |FINSI;
     |FINSI;

     |SALVA_DATOS #0;
     |LEE 101#0p;
     |REPON_DATOS #0;
     |GRABA 020#0a;
     |LIBERA #0;

     eaAplica      = "basica";
     eaEmpresa     = "";
     eaMoneda      = #0#3;

     |SI enDesdeConver = 1;  |ACABA;  |FINSI;

     |SUB_EJECUTA_NP ":agitool/dsconver";
|FPRC;

|PROCESO Laboral;
     eaAplica   = "laboral";
     aContenido = Contenido;
     |SI eaPathLaboral   = "";  |ACABA;  |FINSI;

     #0#6 = "PESETAS";
     |SI #0#5 = "E";  #0#6 = "EUROS";  |FINSI;
     |PINTA #0#6;

     aAbre = eaBase + eaAplica + "/laboral.sui"
     |XABRE "W", aAbre, nHandle;
     |SI #0#5 = "E";
         aAlfa = "DsEuroConvierte=166.386" + &13 + &10;  |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoOtro=0"   + &13 + &10;       |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoNormal=2" + &13 + &10;       |XGRABA nHandle, aAlfa;
     |SINO;
         aAlfa = "DsEuroConvierte=0.00601012" + &13 + &10;  |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoOtro=2"   + &13 + &10;       |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoNormal=0" + &13 + &10;       |XGRABA nHandle, aAlfa;
     |FINSI;
     |XCIERRA nHandle;

     |SI nDsConver = 0;
         |SI aContenido = #0#5;  |ACABA;  |FINSI;
     |FINSI;

     |SALVA_DATOS #0;
     |LEE 101#0p;
     |REPON_DATOS #0;
     |GRABA 020#0a;
     |LIBERA #0;

     eaAplica      = "laboral";
     eaEmpresa     = "";
     eaMoneda      = #0#5;

     |SI enDesdeConver = 1;  |ACABA;  |FINSI;

     |SUB_EJECUTA_NP ":agitool/dsconver";
|FPRC;

|PROCESO Contasoc;
     eaAplica   = "contasoc";
     aContenido = Contenido;
     |SI eaPathContasoc  = "";  |ACABA;  |FINSI;

     #0#8 = "PESETAS";
     |SI #0#7 = "E";  #0#8 = "EUROS";  |FINSI;
     |PINTA #0#8;

     aAbre = eaBase + eaAplica + "/contasoc.sui"
     |XABRE "W", aAbre, nHandle;
     |SI #0#7 = "E";
         aAlfa = "DsEuroConvierte=166.386" + &13 + &10;  |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoOtro=0"   + &13 + &10;       |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoNormal=2" + &13 + &10;       |XGRABA nHandle, aAlfa;
     |SINO;
         aAlfa = "DsEuroConvierte=0.00601012" + &13 + &10;  |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoOtro=2"   + &13 + &10;       |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoNormal=0" + &13 + &10;       |XGRABA nHandle, aAlfa;
     |FINSI;
     |XCIERRA nHandle;

     |SI nDsConver = 0;
         |SI aContenido = #0#7;  |ACABA;  |FINSI;
     |FINSI;

     |SALVA_DATOS #0;
     |LEE 101#0p;
     |REPON_DATOS #0;
     |GRABA 020#0a;
     |LIBERA #0;

     eaAplica      = "contasoc";
     eaEmpresa     = "";
     eaMoneda      = #0#7;

     |SI enDesdeConver = 1;  |ACABA;  |FINSI;

     |SUB_EJECUTA_NP ":agitool/dsconver";

|FPRC;

|PROCESO Modelos;
     eaAplica   = "modelos";
     aContenido = Contenido;
     |SI eaPathDsmodelo  = "";  |ACABA;  |FINSI;

     #0#10 = "PESETAS";
     |SI #0#9 = "E";  #0#10 = "EUROS";  |FINSI;
     |PINTA #0#10;

     aAbre = eaBase + eaAplica + "/modelos.sui"
     |XABRE "W", aAbre, nHandle;
     |SI #0#9 = "E";
         aAlfa = "DsEuroConvierte=166.386" + &13 + &10;  |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoOtro=0"   + &13 + &10;       |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoNormal=2" + &13 + &10;       |XGRABA nHandle, aAlfa;
     |SINO;
         aAlfa = "DsEuroConvierte=0.00601012" + &13 + &10;  |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoOtro=2"   + &13 + &10;       |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoNormal=0" + &13 + &10;       |XGRABA nHandle, aAlfa;
     |FINSI;
     |XCIERRA nHandle;

     |SI nDsConver = 0;
         |SI aContenido = #0#9;  |ACABA;  |FINSI;
     |FINSI;

     |SALVA_DATOS #0;
     |LEE 101#0p;
     |REPON_DATOS #0;
     |GRABA 020#0a;
     |LIBERA #0;

     eaAplica      = "modelos";
     eaEmpresa     = "";
     eaMoneda      = #0#9;

     |SI enDesdeConver = 1;  |ACABA;  |FINSI;

     |SUB_EJECUTA_NP ":agitool/dsconver";
|FPRC;

|PROCESO Contanex;
     eaAplica   = "contanex";
     aContenido = Contenido;
     |SI eaPathContanex  = "";  |ACABA;  |FINSI;

     #0#12 = "PESETAS";
     |SI #0#11 = "E";  #0#12 = "EUROS";  |FINSI;
     |PINTA #0#11;

     aAbre = eaBase + eaAplica + "/contanex.sui"
     |XABRE "W", aAbre, nHandle;
     |SI #0#11 = "E";
         aAlfa = "DsEuroConvierte=166.386" + &13 + &10;  |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoOtro=0"   + &13 + &10;       |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoNormal=2" + &13 + &10;       |XGRABA nHandle, aAlfa;
     |SINO;
         aAlfa = "DsEuroConvierte=0.00601012" + &13 + &10;  |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoOtro=2"   + &13 + &10;       |XGRABA nHandle, aAlfa;
         aAlfa = "DsDeciModoNormal=0" + &13 + &10;       |XGRABA nHandle, aAlfa;
     |FINSI;
     |XCIERRA nHandle;

     |SI nDsConver = 0;
         |SI aContenido = #0#11;  |ACABA;  |FINSI;
     |FINSI;

     |SALVA_DATOS #0;
     |LEE 101#0p;
     |REPON_DATOS #0;
     |GRABA 020#0a;
     |LIBERA #0;

     eaAplica      = "contanex";
     eaEmpresa     = "";
     eaMoneda      = #0#11;

     |SI enDesdeConver = 1;  |ACABA;  |FINSI;

     |SUB_EJECUTA_NP ":agitool/dsconver";
|FPRC;

|PROGRAMA;
     |DBASS eaBase;  |QBF eaBase;
     nDsConver = 0;

     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         |GRABA 020#0b;
         nDsConver = 1;
     |FINSI;

     |CLS;
     |CABEZA "     Control de Moneda";
     |PINPA #0#0;
     |PINDA #0#0;

     |HAZ BusquedaApli;
     |SI eaAplica ! "";
         |C_M #0#1,  1, "N";
         |C_M #0#3,  1, "N";
         |C_M #0#5,  1, "N";
         |C_M #0#7,  1, "N";
         |C_M #0#9,  1, "N";
         |SI eaAplica = "integral  ";  |C_M #0#1,  1, "S";  |FINSI;
         |SI eaAplica = "basica    ";  |C_M #0#3,  1, "S";  |FINSI;
         |SI eaAplica = "laboral   ";  |C_M #0#5,  1, "S";  |FINSI;
         |SI eaAplica = "contasoc  ";  |C_M #0#7,  1, "S";  |FINSI;
         |SI eaAplica = "modelos   ";  |C_M #0#9,  1, "S";  |FINSI;
     |SINO;
         |HAZ BusquedaApli;
         |C_M #0#1,  1, "S";
         |C_M #0#3,  1, "S";
         |C_M #0#5,  1, "S";
         |C_M #0#7,  1, "S";
         |C_M #0#9,  1, "S";
         |SI eaPathIntegral  = "";  |C_M #0#1,  1, "N";  |FINSI;
         |SI eaPathBasica    = "";  |C_M #0#3,  1, "N";  |FINSI;
         |SI eaPathLaboral   = "";  |C_M #0#5,  1, "N";  |FINSI;
         |SI eaPathContasoc  = "";  |C_M #0#7,  1, "N";  |FINSI;
         |SI eaPathDsmodelo  = "";  |C_M #0#9,  1, "N";  |FINSI;
         |SI eaPathContanex  = "";  |C_M #0#11, 1, "N";  |FINSI;
     |FINSI;

     |ENDATOS #1#0;

     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;
|FPRO;
