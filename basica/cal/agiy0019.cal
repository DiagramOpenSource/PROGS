|FICHEROS;
     agiy0019 #0;
     agim0010;
     agim0011;
     agim0012;

     :/dsarchi/def/dsarm001;
     :/dsarchi/def/dsarm002;
     :/dsarchi/def/dsarm003;
     :/dsarchi/def/dsarm004;

|FIN;

|VARIABLES;
      nArchi     = 0;
      nHandle    = 0;
      nCampo     = 0;
      nSwImprime = 0;

      aBase      = "";
      aMas       = "";
      aAlfa      = "";
      aFich      = "";
|FIN;

|INCLUYE i_consul;

|PROCESO Vacia;
     nSwImprime = 0;
|FPRC;

|PROCESO Imprime;
     |SI #agiy0019#23 ! 0;
         #agim0010#0 = #agim0012#2;
         |LEE 000#agim0010.=;

         |SI #agim0010#2 ! #agiy0019#23;
             |ACABA;
         |FINSI;

         |SI #agiy0019#24 ! 0;
             |SI #agim0010#3 ! #agiy0019#24;
                 |ACABA;
             |FINSI;

             |SI #agiy0019#25 ! 0;
                 |SI #agim0010#4 ! #agiy0019#25;
                     |ACABA;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #agim0012#5 ! "A";  |ACABA;  |FINSI;

     nSwImprime = 1;
     |PRINT;
|FPRC;

|PROCESO PieInf;
     |SI nSwImprime = 0; |ACABA; |FINSI;

     |PIEINF;
|FPRC;

|DEFBUCLE agim0011;
     #agim0011#1;
     ;
     #agiy0019#1;
     #agiy0019#2;
     ;
     NULL, Vacia, Imprime, PieInf;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |INFOR "agiy0019";
     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     |ABRE #agim0010;
     |SI #agiy0019#0 = "S";
         |BUCLE agim0011;
     |SINO;
         |PARA nCampo = 3; |SI nCampo [ 22; |HACIENDO nCampo = nCampo + 1;
               |SI #agiy0019#nCampo# ! 0;
                   #agiy0019#1 = #agiy0019#nCampo#;
                   #agiy0019#2 = #agiy0019#nCampo#;
                   |BUCLE agim0011;
               |FINSI;
         |SIGUE;
     |FINSI;
     |CIERRA #agim0010;

     |FININF;
     |FINIMP;
|FPRC;

|PROCESO Seleccion; |TIPO 0;
     #agiy0019#Campo# = #agiy0019#Campo# > #agiy0019#Campo#;
     |PINTA #agiy0019#Campo#;

     |SI #agiy0019#Campo# = "S";
         |PARA nCampo = 3; |SI nCampo [ 22; |HACIENDO nCampo = nCampo + 1;
               |C_M #agiy0019#nCampo#, 1, "N";
               #agiy0019#nCampo# = 0;
               |PINTA #agiy0019#nCampo#;

         |SIGUE;
         |PARA nCampo = 1; |SI nCampo [ 2; |HACIENDO nCampo = nCampo + 1;
               |C_M #agiy0019#nCampo#, 1, "S";
         |SIGUE;
     |SINO;
         |PARA nCampo = 1; |SI nCampo [ 2; |HACIENDO nCampo = nCampo + 1;
               |C_M #agiy0019#nCampo#, 1, "N";
               #agiy0019#nCampo# = 0;
               |PINTA #agiy0019#nCampo#;

         |SIGUE;
         |PARA nCampo = 3; |SI nCampo [ 22; |HACIENDO nCampo = nCampo + 1;
               |C_M #agiy0019#nCampo#, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Tipo66C23;  |TIPO 66;
     |ABRE #dsarm002;
     #dsarm002#0 = #agiy0019#23;
     |LEE 000#dsarm002.=;
     |CONSULTA_CLAVE #1#dsarm002;
     |SI FSalida = 0;
         #agiy0019#23 = #dsarm002#0;  |PINTA #agiy0019#23;
         #agiy0019#26 = #dsarm002#1;  |PINTA #agiy0019#26;
     |FINSI;
     |CIERRA #dsarm002;
|FPRC;

|PROCESO Tipo0C23;  |TIPO 0;
     |C_M #agiy0019#23, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |SI #agiy0019#23 = 0;
         #agiy0019#24 = 0;
         #agiy0019#25 = 0;

         #agiy0019#26 = "TODOS";
         #agiy0019#27 = "TODOS";
         #agiy0019#28 = "TODOS";

         |C_M #agiy0019#24, 1, "N";
         |C_M #agiy0019#25, 1, "N";

         |PINTA #agiy0019#24;
         |PINTA #agiy0019#25;
         |PINTA #agiy0019#26;
         |PINTA #agiy0019#27;
         |PINTA #agiy0019#28;

         |ACABA;
     |FINSI;

     |ABRE #dsarm002;
     #dsarm002#0 = #agiy0019#23;
     |LEE 000#dsarm002.=;
     |SI FSalida ! 0;
         |MENAV "0000No existe el grupo";
         |ERROR;
     |SINO;
         #agiy0019#26 = #dsarm002#1;

         |SI #dsarm001#8 = "N";
             #agiy0019#24 = 1;
             #agiy0019#25 = 1;
             #agiy0019#27 = "";
             #agiy0019#28 = "";
         |FINSI;
     |FINSI;
     |CIERRA #dsarm002;

     |PINTA #agiy0019#24;
     |PINTA #agiy0019#25;
     |PINTA #agiy0019#26;
     |PINTA #agiy0019#27;
|FPRC;

|PROCESO Baja3;
     #dsarm003#0 = #agiy0019#23;
     #dsarm003#1 = 1;
|FPRC;

|PROCESO Alta3;
     #dsarm003#0 = #agiy0019#23;
     #dsarm003#1 = 999;
|FPRC;

|PROCESO Tipo66C24;  |TIPO 66;
     |ABRE #dsarm003;
     #dsarm003#0 = #agiy0019#23;
     #dsarm003#1 = #agiy0019#24;
     |LEE 000#dsarm003.=;
     |CONSULTA_F_CLAVE #1#dsarm003, Baja3, Alta3;
     |SI FSalida = 0;
         #agiy0019#24 = #dsarm003#1;  |PINTA #agiy0019#24;
         #agiy0019#27 = #dsarm003#2;  |PINTA #agiy0019#27;
     |FINSI;
     |CIERRA #dsarm003;
|FPRC;

|PROCESO Tipo0C24;  |TIPO 0;
     |C_M #agiy0019#24, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |SI #agiy0019#24 = 0;
         #agiy0019#25 = 0;

         #agiy0019#27 = "TODOS";
         #agiy0019#28 = "TODOS";

         |C_M #agiy0019#25, 1, "N";

         |PINTA #agiy0019#25;
         |PINTA #agiy0019#27;
         |PINTA #agiy0019#28;

         |ACABA;
     |FINSI;

     |ABRE #dsarm003;
     #dsarm003#0 = #agiy0019#23;
     #dsarm003#1 = #agiy0019#24;
     |LEE 000#dsarm003.=;
     |SI FSalida ! 0;
         |MENAV "0000No existe el subgrupo";
         |ERROR;
     |FINSI;
     |CIERRA #dsarm003;

     #agiy0019#27 = #dsarm003#2;  |PINTA #agiy0019#27;
|FPRC;

|PROCESO Baja4;
     #dsarm004#0 = #agiy0019#23;
     #dsarm004#1 = #agiy0019#24;
     #dsarm004#2 = 1;
|FPRC;

|PROCESO Alta4;
     #dsarm004#0 = #agiy0019#23;
     #dsarm004#1 = #agiy0019#24;
     #dsarm004#2 = 999;
|FPRC;

|PROCESO Tipo66C25;  |TIPO 66;
     |ABRE #dsarm004;
     #dsarm004#0 = #agiy0019#23;
     #dsarm004#1 = #agiy0019#24;
     #dsarm004#2 = #agiy0019#25;
     |LEE 000#dsarm004.=;
     |CONSULTA_F_CLAVE #1#dsarm004, Baja4, Alta4;
     |SI FSalida = 0;
         #agiy0019#25 = #dsarm004#2;  |PINTA #agiy0019#25;
         #agiy0019#28 = #dsarm004#3;  |PINTA #agiy0019#28;
     |FINSI;
     |CIERRA #dsarm004;
|FPRC;

|PROCESO Tipo0C25;  |TIPO 0;
     |C_M #agiy0019#25, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |SI #agiy0019#25 = 0;
         #agiy0019#28 = "TODOS";

         |PINTA #agiy0019#28;

         |ACABA;
     |FINSI;

     |ABRE #dsarm004;
     #dsarm004#0 = #agiy0019#23;
     #dsarm004#1 = #agiy0019#24;
     #dsarm004#2 = #agiy0019#25;
     |LEE 000#dsarm004.=;
     |SI FSalida ! 0;
         |MENAV "0000No existe el tipo";
         |ERROR;
     |FINSI;
     |CIERRA #dsarm004;

     #agiy0019#28 = #dsarm004#3;  |PINTA #agiy0019#28;
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     nArchi = 0;

     |DBASS aBase;
     aMas = aBase + "dsarchi/def/dsarm001.mas";
     |XABRE "E", aMas, nHandle;
     |SI FSalida ] 0;
         nArchi = 1;
     |FINSI;

     |C_M #agiy0019#23, 1, "N";
     |C_M #agiy0019#24, 1, "N";
     |C_M #agiy0019#25, 1, "N";

     |SI nArchi = 0;  |ACABA;  |FINSI;

     aFich = aBase + "dsarchi/fich/";
     |PATH_DAT #dsarm001#aFich#;
     |PATH_DAT #dsarm002#aFich#;
     |PATH_DAT #dsarm003#aFich#;
     |PATH_DAT #dsarm004#aFich#;

     |ABRE #dsarm001;
     |LEE 000#dsarm001.p;
     |SI FSalida ! 0;  |DDEFECTO #dsarm001;  |FINSI;
     |CIERRA #dsarm001;

     |SI #dsarm001#8 = "S";
         |C_M #agiy0019#23, 1, "S";
         |C_M #agiy0019#24, 1, "S";
         |C_M #agiy0019#25, 1, "S";
     |SINO;
         |C_M #agiy0019#23, 1, "S";
     |FINSI;
|FPRC;
