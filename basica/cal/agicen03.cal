|FICHEROS;
     agicen03 #3;

     &regisnif@ #709;
     &clientes@ #715;
|FIN;

|VARIABLES;
     &enEmpresa   = 0;
     &enActividad = 0;
     &enContador  = 0;
     &enTipo      = 0;
     &eaNombreEmp = "";
     &eaNombreAct = "";
     &eaVarDni    = "";
     &enCalcCif   = 0;
     &eaCodNif    = "";
     &enCodCli    = 0;
     &enSwDeDonde = 0;
|FIN;

|PROCESO LetraDniCen03;  |TIPO 6;
     |SI FSalida = 10;
         eaVarDni  = #3Campo;
         enCalcCif = 1;
         |HAZ CalculoDNI;
         #3Campo = eaVarDni;
         |PINTA #3Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #3Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 112;
     |SI #3Campo ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #3Campo = eaVarDni;  |PINTA #3Campo;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Campo03;
     |SI enTipo = 2;
         |C_M #3#19, 1, "N";
         |C_M #3#20, 1, "N";
         |C_M #3#21, 1, "N";
         |C_M #3#22, 1, "N";

         #3#19 = "";  #3#20 = "";  #3#21 = "";  #3#22 = "";
     |SINO;
         |C_M #3#19, 1, "S";
         |C_M #3#20, 1, "S";
         |C_M #3#21, 1, "S";
         |C_M #3#22, 1, "S";
     |FINSI;
|FPRC;

|PROCESO CogeCliente;
     enCodCli = enEmpresa;
     |HAZ LeePersona;
     |SI enSwDeDonde = 1;
         #3#17 = #715#3;    || NIF
         #3#18 = #715#1;    || Razon social
     |SINO;
         #3#17 = #715#13;    || NIF
         #3#18 = #715#1;    || Razon social
     |FINSI;
|FPRC;

|PROCESO NombreRepre;
      eaCodNif  = #3#17;
      |HAZ LeeNifs;

      #3#18 = #709#1;  |PINTA #3#18;
|FPRC;

|PROGRAMA;
     |ABRE #3;
     |PINPA #0#3;
     #3#0  = enEmpresa;
     #3#1  = enContador;
     |LEE 101#3=;
     |SI FSalida = 0;
         |HAZ Campo03;
         |PINDA #0#3;
         |ENDATOS #2#3;
         |SI FSalida = 0; |GRABA 020#3a; |FINSI;
     |SINO;
         |DDEFECTO #3;
         #3#0  = enEmpresa;
         #3#1  = enContador;
         #3#2  = eaNombreEmp;
         #3#3  = eaNombreAct;

         |HAZ Campo03;
         |HAZ CogeCliente;

         |PINDA #0#3;
         |ENDATOS #1#3;
         |SI FSalida = 0; |GRABA 020#3n; |FINSI;
     |FINSI;
     |LIBERA #3;
     |CIERRA #3;
|FPRO;
