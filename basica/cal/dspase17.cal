|FICHEROS;
     dspase15;
     dspase16;
     dspase17;
     dsficher;

     :/basica/def/agifigen;
     :/laboral/def/labempre;
     :/contagen/def/canempre;
     :/contasoc/def/maacceso;
     :/facturar/def/asclient;

     espejo1@;
|FIN;

|VARIABLES;
     nCodigo      = 0;
     aAlfa        = "";
     aPath        = "";
     aDef         = "";

     &enEmpresa   = 0;
     &enEmpresaN  = 0;
     &enCambioCli = 0;
     &enEmpFac    = 0;
     &enTransfor  = 1;

     &eaPathFacturar   = "";
     &eaPathRen2018    = "";
     &eaPathRen2017    = "";
     &eaPathRen2016    = "";
     &eaPathRen2015    = "";
     &eaPathRen2014    = "";
     &eaPathRen2013    = "";
     &eaPathRen2012    = "";
     &eaPathRen2011    = "";
     &eaPathRen2010    = "";
     &eaPathRen2009    = "";
     &eaPathRen2008    = "";
     &eaPathRen2007    = "";
     &eaPathRen2006    = "";
     &eaPathRen2005    = "";
     &eaPathRen2004    = "";
     &eaPathRen2003    = "";
     &eaPathRen2002    = "";
     &eaPathRen2001    = "";
     &eaPathRen2000    = "";
     &eaPathRen1999    = "";
     &eaPathRen1998    = "";
     &eaPathRen1997    = "";
     &eaPathRen1996    = "";
     &eaPathRen1995    = "";
     &eaPathRen1994    = "";

     &eaPasaCact     = "";
     &eaPasaNuct     = "";
     &eaPasaCont     = "";
     &eaPasaFisc     = "";
     &eaPasaSoci     = "";
     &eaPasaRent     = "";
     &eaPasaLabo     = "";
     &eaPasaFact     = "";
     &eaPasaMaes     = "";
     &eaPasaArch     = "";
     &eaPasaR2000    = "";
     &eaPasaR1999    = "";
     &eaPasaR1998    = "";
     &eaPasaR1997    = "";
     &eaPasaR1996    = "";
     &eaPasaR1995    = "";
     &eaPasaR1994    = "";
     &eaPasaR2001    = "";
     &eaPasaR2002    = "";
     &eaPasaR2003    = "";
     &eaPasaR2004    = "";
     &eaPasaR2005    = "";
     &eaPasaR2006    = "";
     &eaPasaR2007    = "";
     &eaPasaR2008    = "";
     &eaPasaR2009    = "";
     &eaPasaR2010    = "";
     &eaPasaR2011    = "";
     &eaPasaR2012    = "";
     &eaPasaR2013    = "";
     &eaPasaR2014    = "";
     &eaPasaR2015    = "";
     &eaPasaR2016    = "";
     &eaPasaR2017    = "";
     &eaPasaR2018    = "";
|FIN;

|| Cambia Basica

|PROCESO CambiaCodigo4;
     #espejo1@#4 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_4;
     #espejo1@#1002;
     4;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo4;
|FIN;

|PROCESO Basica;
     |SI enCambioCli = 2;
         eaPasaMaes    = "SI";
         enEmpresa  = #dspase15#4;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaMaes    = "NO";
         |ACABA;
     |FINSI;

     |ABRE #agifigen;
     #agifigen#0 = #dspase15#3;
     |LEE 040#agifigen.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#agifigen.u;
         nCodigo = #agifigen#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #agifigen#0 = nCodigo;
                   |LEE 040#agifigen.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #agifigen;

     eaPasaMaes    = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#4;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_4;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#4;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaMaes    = "NO";
|FPRC;

|| Cambia Laboral

|PROCESO CambiaCodigo5;
     #espejo1@#5 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_5;
     #espejo1@#1002;
     5;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo5;
|FIN;

|PROCESO Laboral;
     |SI enCambioCli = 2;
         eaPasaLabo    = "SI";
         enEmpresa  = #dspase15#5;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaLabo    = "NO";
         |ACABA;
     |FINSI;

     |ABRE #labempre;
     #labempre#0 = #dspase15#3;
     |LEE 040#labempre.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#labempre.u;
         nCodigo = #labempre#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #labempre#0 = nCodigo;
                   |LEE 040#labempre.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #labempre;

     eaPasaLabo    = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#5;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_5;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#5;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaLabo    = "NO";
|FPRC;

|| Cambia Contabilidad

|PROCESO CambiaCodigo6;
     #espejo1@#6 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_6;
     #espejo1@#1002;
     6;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo6;
|FIN;

|PROCESO Contabilidad;
     |SI enCambioCli = 2;
         eaPasaCont    = "SI";
         enEmpresa  = #dspase15#6;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaCont    = "NO";
         |ACABA;
     |FINSI;

     |ABRE #canempre;
     #canempre#2 = #dspase15#3;
     #canempre#3 = 0;
     |LEE 040#canempre.];
     |SI FSalida ! 0;  |O #canempre#2 ! #dspase15#3;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#canempre.u;
         nCodigo = #canempre#2 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #canempre#2 = nCodigo;
                   #canempre#3 = 0;
                   |LEE 040#canempre.];
                   |SI FSalida ! 0;  |O #canempre#2 ! nCodigo;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #canempre;

     eaPasaCont    = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#6;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_6;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#6;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaCont    = "NO";
|FPRC;

|PROCESO CambiaCodigo7;
     #espejo1@#7 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_7;
     #espejo1@#1002;
     7;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo7;
|FIN;

|| Cambia Sociedad

|PROCESO Sociedad;
     |SI enCambioCli = 2;
         eaPasaSoci    = "SI";
         enEmpresa  = #dspase15#7;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaSoci    = "NO";
         |ACABA;
     |FINSI;

     |ABRE #maacceso;
     #maacceso#0 = #dspase15#3;
     #maacceso#1 = 0;
     |LEE 040#maacceso.];
     |SI FSalida ! 0;  |O #maacceso#0 ! #dspase15#3;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#maacceso.u;
         nCodigo = #maacceso#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #maacceso#0 = nCodigo;
                   #maacceso#1 = 0;
                   |LEE 040#maacceso.];
                   |SI FSalida ! 0;  |O #maacceso#0 ! nCodigo;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #maacceso;

     eaPasaSoci    = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#7;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_7;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#7;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaSoci    = "NO";
|FPRC;

|| Cambia Renta 2018

|PROCESO CambiaCodigo40;
     #espejo1@#40 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_40;
     #espejo1@#1002;
     40;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo40;
|FIN;

|PROCESO Renta2018;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR2018   = "SI";
         enEmpresa     = #dspase15#40;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR2018   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen2018 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR2018   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#40;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_40;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#40;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;

     eaPasaRent    = "NO";
     eaPasaR2018   = "NO";
|FPRC;

|| Cambia Renta 2017

|PROCESO CambiaCodigo39;
     #espejo1@#39 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_39;
     #espejo1@#1002;
     39;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo39;
|FIN;

|PROCESO Renta2017;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR2017   = "SI";
         enEmpresa     = #dspase15#39;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR2017   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen2017 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR2017   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#39;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_39;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#39;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;

     eaPasaRent    = "NO";
     eaPasaR2017   = "NO";
|FPRC;

|| Cambia Renta 2016

|PROCESO CambiaCodigo38;
     #espejo1@#38 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_38;
     #espejo1@#1002;
     38;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo38;
|FIN;

|PROCESO Renta2016;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR2016   = "SI";
         enEmpresa     = #dspase15#38;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR2016   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen2016 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR2016   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#38;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_38;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#38;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;

     eaPasaRent    = "NO";
     eaPasaR2016   = "NO";
|FPRC;

|| Cambia Renta 2015

|PROCESO CambiaCodigo37;
     #espejo1@#37 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_37;
     #espejo1@#1002;
     37;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo37;
|FIN;

|PROCESO Renta2015;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR2015   = "SI";
         enEmpresa     = #dspase15#37;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR2015   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen2015 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR2015   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#37;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_37;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#37;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;

     eaPasaRent    = "NO";
     eaPasaR2015   = "NO";
|FPRC;

|| Cambia Renta 2014

|PROCESO CambiaCodigo36;
     #espejo1@#36 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_36;
     #espejo1@#1002;
     36;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo36;
|FIN;

|PROCESO Renta2014;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR2014   = "SI";
         enEmpresa     = #dspase15#36;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR2014   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen2014 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR2014   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#36;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_36;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#36;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;

     eaPasaRent    = "NO";
     eaPasaR2014   = "NO";
|FPRC;

|| Cambia Renta 2013

|PROCESO CambiaCodigo35;
     #espejo1@#35 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_35;
     #espejo1@#1002;
     35;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo35;
|FIN;

|PROCESO Renta2013;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR2013   = "SI";
         enEmpresa     = #dspase15#35;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR2013   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen2013 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR2013   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#35;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_35;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#35;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;

     eaPasaRent    = "NO";
     eaPasaR2013   = "NO";
|FPRC;

|| Cambia Renta 2012

|PROCESO CambiaCodigo34;
     #espejo1@#34 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_34;
     #espejo1@#1002;
     34;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo34;
|FIN;

|PROCESO Renta2012;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR2012   = "SI";
         enEmpresa  = #dspase15#34;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR2012   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen2012 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR2012   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#34;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_34;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#34;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaRent    = "NO";
     eaPasaR2012   = "NO";
|FPRC;

|| Cambia Renta 2011

|PROCESO CambiaCodigo33;
     #espejo1@#33 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_33;
     #espejo1@#1002;
     33;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo33;
|FIN;

|PROCESO Renta2011;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR2011   = "SI";
         enEmpresa  = #dspase15#33;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR2011   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen2011 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR2011   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#33;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_33;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#33;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaRent    = "NO";
     eaPasaR2011   = "NO";
|FPRC;

|| Cambia Renta 2010

|PROCESO CambiaCodigo32;
     #espejo1@#32 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_32;
     #espejo1@#1002;
     32;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo32;
|FIN;

|PROCESO Renta2010;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR2010   = "SI";
         enEmpresa  = #dspase15#32;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR2010   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen2010 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR2010   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#32;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_32;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#32;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaRent    = "NO";
     eaPasaR2010   = "NO";
|FPRC;

|| Cambia Renta 2009

|PROCESO CambiaCodigo31;
     #espejo1@#31 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_31;
     #espejo1@#1002;
     31;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo31;
|FIN;

|PROCESO Renta2009;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR2009   = "SI";
         enEmpresa  = #dspase15#31;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR2009   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen2009 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR2009   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#31;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_31;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#31;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaRent    = "NO";
     eaPasaR2009   = "NO";
|FPRC;

|| Cambia Renta 2008

|PROCESO CambiaCodigo30;
     #espejo1@#30 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_30;
     #espejo1@#1002;
     30;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo30;
|FIN;

|PROCESO Renta2008;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR2008   = "SI";
         enEmpresa  = #dspase15#30;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR2008   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen2008 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR2008   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#30;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_30;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#30;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaRent    = "NO";
     eaPasaR2008   = "NO";
|FPRC;

|| Cambia Renta 2007

|PROCESO CambiaCodigo29;
     #espejo1@#29 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_29;
     #espejo1@#1002;
     29;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo29;
|FIN;

|PROCESO Renta2007;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR2007   = "SI";
         enEmpresa  = #dspase15#29;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR2007   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen2007 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR2007   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#29;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_29;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#29;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaRent    = "NO";
     eaPasaR2007   = "NO";
|FPRC;

|| Cambia Renta 2006

|PROCESO CambiaCodigo28;
     #espejo1@#28 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_28;
     #espejo1@#1002;
     28;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo28;
|FIN;

|PROCESO Renta2006;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR2006   = "SI";
         enEmpresa  = #dspase15#28;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR2006   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen2006 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR2006   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#28;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_28;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#28;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaRent    = "NO";
     eaPasaR2006   = "NO";
|FPRC;

|| Cambia Renta 2005

|PROCESO CambiaCodigo27;
     #espejo1@#27 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_27;
     #espejo1@#1002;
     27;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo27;
|FIN;

|PROCESO Renta2005;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR2005   = "SI";
         enEmpresa  = #dspase15#27;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR2005   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen2005 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR2005   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#27;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_27;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#27;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaRent    = "NO";
     eaPasaR2005   = "NO";
|FPRC;

|| Cambia Renta 2004

|PROCESO CambiaCodigo26;
     #espejo1@#26 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_26;
     #espejo1@#1002;
     26;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo26;
|FIN;

|PROCESO Renta2004;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR2004   = "SI";
         enEmpresa  = #dspase15#26;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR2004   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen2004 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR2004   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#26;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_26;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#26;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaRent    = "NO";
     eaPasaR2004   = "NO";
|FPRC;

|| Cambia Renta 2003

|PROCESO CambiaCodigo25;
     #espejo1@#25 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_25;
     #espejo1@#1002;
     25;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo25;
|FIN;

|PROCESO Renta2003;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR2003   = "SI";
         enEmpresa  = #dspase15#25;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR2003   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen2003 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR2003   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#25;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_25;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#25;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaRent    = "NO";
     eaPasaR2003   = "NO";
|FPRC;

|| Cambia Renta 2002

|PROCESO CambiaCodigo24;
     #espejo1@#24 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_24;
     #espejo1@#1002;
     24;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo24;
|FIN;

|PROCESO Renta2002;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR2002   = "SI";
         enEmpresa  = #dspase15#24;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR2002   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen2002 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR2002   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#24;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_24;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#24;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaRent    = "NO";
     eaPasaR2002   = "NO";
|FPRC;

|| Cambia Renta 2001

|PROCESO CambiaCodigo23;
     #espejo1@#23 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_23;
     #espejo1@#1002;
     23;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo23;
|FIN;

|PROCESO Renta2001;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR2001   = "SI";
         enEmpresa  = #dspase15#23;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR2001   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen2001 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR2001   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#23;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_23;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#23;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaRent    = "NO";
     eaPasaR2001   = "NO";
|FPRC;

|| Cambia Renta 2000

|PROCESO CambiaCodigo8;
     #espejo1@#8 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_8;
     #espejo1@#1002;
     8;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo8;
|FIN;

|PROCESO Renta2000;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR2000   = "SI";
         enEmpresa  = #dspase15#8;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR2000   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen2000 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR2000   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#8;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_8;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#8;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaRent    = "NO";
     eaPasaR2000   = "NO";
|FPRC;

|| Cambia Renta 1999

|PROCESO CambiaCodigo9;
     #espejo1@#9 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_9;
     #espejo1@#1002;
     9;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo9;
|FIN;

|PROCESO Renta1999;
     |SI enCambioCli = 2;
         eaPasaRent     = "SI";
         eaPasaR1999 = "SI";
         enEmpresa   = #dspase15#9;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent     = "NO";
         eaPasaR1999 = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen1999 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent     = "SI";
     eaPasaR1999 = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#9;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_9;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#9;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaRent     = "NO";
     eaPasaR1999 = "NO";
|FPRC;

|| Cambia Renta 1998

|PROCESO CambiaCodigo10;
     #espejo1@#10 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_10;
     #espejo1@#1002;
     10;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo10;
|FIN;

|PROCESO Renta1998;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR1998   = "SI";
         enEmpresa  = #dspase15#10;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR1998   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen1998 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR1998   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#10;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_10;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#10;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaRent    = "NO";
     eaPasaR1998   = "NO";
|FPRC;

|| Cambia Renta 1997

|PROCESO CambiaCodigo11;
     #espejo1@#11 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_11;
     #espejo1@#1002;
     11;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo11;
|FIN;

|PROCESO Renta1997;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR1997   = "SI";
         enEmpresa  = #dspase15#11;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR1997   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen1997 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR1997   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#11;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_11;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#11;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaRent    = "NO";
     eaPasaR1997   = "NO";
|FPRC;

|| Cambia Renta 1996

|PROCESO CambiaCodigo12;
     #espejo1@#12 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_12;
     #espejo1@#1002;
     12;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo12;
|FIN;

|PROCESO Renta1996;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR1996   = "SI";
         enEmpresa  = #dspase15#12;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR1996   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen1996 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR1996   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#12;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_12;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#12;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaRent    = "NO";
     eaPasaR1996   = "NO";
|FPRC;

|| Cambia Renta 1995

|PROCESO CambiaCodigo13;
     #espejo1@#13 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_13;
     #espejo1@#1002;
     13;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo13;
|FIN;

|PROCESO Renta1995;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR1995   = "SI";
         enEmpresa  = #dspase15#13;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR1995   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen1995 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR1995   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#13;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_13;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#13;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaRent    = "NO";
     eaPasaR1995   = "NO";
|FPRC;

|| Cambia Renta 1994

|PROCESO CambiaCodigo14;
     #espejo1@#14 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_14;
     #espejo1@#1002;
     14;
     "            ", 000, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase15#3;
     be;
     NULL, CambiaCodigo14;
|FIN;

|PROCESO Renta1994;
     |SI enCambioCli = 2;
         eaPasaRent    = "SI";
         eaPasaR1994   = "SI";
         enEmpresa  = #dspase15#14;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaRent    = "NO";
         eaPasaR1994   = "NO";
         |ACABA;
     |FINSI;

     aDef = eaPathRen1994 + "def/reacceso.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #espejo1@;
     #espejo1@#0 = #dspase15#3;
     |LEE 040#espejo1@.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#espejo1@.u;
         nCodigo = #espejo1@#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #espejo1@#0 = nCodigo;
                   |LEE 040#espejo1@.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #espejo1@;

     |DESCARGA_DEF #espejo1@;

     eaPasaRent    = "SI";
     eaPasaR1994   = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#14;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase15.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_14;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase15#14;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaRent    = "NO";
     eaPasaR1994   = "NO";
|FPRC;

|PROCESO CambiaCodigoFac;
     #espejo1@#3 = nCodigo;
     |GRABA 020#espejo1@.a;
     |LIBERA #espejo1@;
|FPRC;

|DEFBUCLE espejo1_Fac;
     #espejo1@#1003;
     3;
     "            ", 000, #dspase16#2, #dspase15#3;
     "zzzzzzzzzzzz", 999, #dspase16#2, #dspase15#3;
     be;
     NULL, CambiaCodigoFac;
|FIN;

|PROCESO PasaLaFacturacion;
     |SI enCambioCli = 2;
         enEmpFac   = #dspase16#2;
         eaPasaFact    = "SI";
         enEmpresa  = #dspase16#3;
         |SUB_EJECUTA_NP "dsborrad";
         eaPasaFact    = "NO";
         |ACABA;
     |FINSI;

     |SI #dspase16#3 = 0;     |ACABA;  |FINSI;
     |SI #dspase16#3 = #dspase15#3; |ACABA;  |FINSI;

     enEmpFac = #dspase16#2;
     aPath    = eaPathFacturar + "fich/" + (("00" + #dspase16#2) % -102) + "/";  |QBT aPath;
     |PATH_DAT #asclient#aPath#;

     |ABRE #asclient;
     #asclient#0 = #dspase15#3;
     |LEE 040#asclient.=;
     |SI FSalida ! 0;
         nCodigo = #dspase15#3;
     |SINO;
         |LEE 040#asclient.u;
         nCodigo = #asclient#0 + 1;
         |SI nCodigo > 99999;
             |PARA nCodigo = 99999; |SI nCodigo ] 1;  |HACIENDO nCodigo = nCodigo - 1;
                   #asclient#0 = nCodigo;
                   |LEE 040#asclient.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #asclient;

     eaPasaFact    = "SI";
     |SI nCodigo = #dspase15#3;
         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase16#3;
         |SUB_EJECUTA_NP "dsborrad";
     |SINO;
         |DBASE aPath;  |QBT aPath;
         aDef = aPath + "def/dspase16.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dspase15.mas";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |BUCLE espejo1_Fac;

         |DESCARGA_DEF #espejo1@;

         enEmpresaN = nCodigo;
         enEmpresa  = #dspase15#3;
         |SUB_EJECUTA_NP "dsborrad";

         enEmpresaN = #dspase15#3;
         enEmpresa  = #dspase16#3;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;
     eaPasaFact    = "NO";
|FPRC;

|DEFBUCLE dspase16;
     #dspase16#1;
     ;
     #dspase15#0, #dspase15#1, 00;
     #dspase15#0, #dspase15#1, 99;
     ;
     NULL, PasaLaFacturacion;
|FIN;

|PROCESO PasaLaFicha;
     |PINTA 1711, #dspase15#0;
     |PINTA 1724, #dspase15#1;
     |PINTA 1728, #dspase15#2;
     |PINTA 1768, #dspase15#3;

     enCambioCli = 1;
     |SI #dspase15#22 = "S";  enCambioCli = 2;  |FINSI;

     eaPasaCont     = "NO";
     eaPasaFisc     = "NO";
     eaPasaSoci     = "NO";
     eaPasaRent     = "NO";
     eaPasaLabo     = "NO";
     eaPasaFact     = "NO";
     eaPasaMaes     = "NO";
     eaPasaArch     = "NO";
     eaPasaR1994    = "NO";
     eaPasaR1995    = "NO";
     eaPasaR1996    = "NO";
     eaPasaR1997    = "NO";
     eaPasaR1998    = "NO";
     eaPasaR1999    = "NO";
     eaPasaR2000    = "NO";
     eaPasaR2001    = "NO";
     eaPasaR2002    = "NO";
     eaPasaR2003    = "NO";
     eaPasaR2004    = "NO";
     eaPasaR2005    = "NO";
     eaPasaR2006    = "NO";
     eaPasaR2007    = "NO";
     eaPasaR2008    = "NO";
     eaPasaR2009    = "NO";
     eaPasaR2010    = "NO";
     eaPasaR2011    = "NO";
     eaPasaR2012    = "NO";
     eaPasaR2013    = "NO";
     eaPasaR2014    = "NO";
     eaPasaR2015    = "NO";
     eaPasaR2016    = "NO";
     eaPasaR2017    = "NO";
     eaPasaR2018    = "NO";

     |SALVA_DATOS #dspase15;

     |SI enCambioCli = 2;
         |SI #dspase15#4  ! 0;  |HAZ Basica;       |FINSI;
         |SI #dspase15#5  ! 0;  |HAZ Laboral;      |FINSI;
         |SI #dspase15#6  ! 0;  |HAZ Contabilidad; |FINSI;
         |SI #dspase15#7  ! 0;  |HAZ Sociedad;     |FINSI;
         |SI #dspase15#40 ! 0;  |HAZ Renta2018;    |FINSI;   || 2018
         |SI #dspase15#39 ! 0;  |HAZ Renta2017;    |FINSI;   || 2017
         |SI #dspase15#38 ! 0;  |HAZ Renta2016;    |FINSI;   || 2016
         |SI #dspase15#37 ! 0;  |HAZ Renta2015;    |FINSI;   || 2015
         |SI #dspase15#36 ! 0;  |HAZ Renta2014;    |FINSI;   || 2014
         |SI #dspase15#35 ! 0;  |HAZ Renta2013;    |FINSI;   || 2013
         |SI #dspase15#34 ! 0;  |HAZ Renta2012;    |FINSI;
         |SI #dspase15#33 ! 0;  |HAZ Renta2011;    |FINSI;
         |SI #dspase15#32 ! 0;  |HAZ Renta2010;    |FINSI;
         |SI #dspase15#31 ! 0;  |HAZ Renta2009;    |FINSI;
         |SI #dspase15#30 ! 0;  |HAZ Renta2008;    |FINSI;
         |SI #dspase15#29 ! 0;  |HAZ Renta2007;    |FINSI;
         |SI #dspase15#28 ! 0;  |HAZ Renta2006;    |FINSI;
         |SI #dspase15#27 ! 0;  |HAZ Renta2005;    |FINSI;
         |SI #dspase15#26 ! 0;  |HAZ Renta2004;    |FINSI;
         |SI #dspase15#25 ! 0;  |HAZ Renta2003;    |FINSI;
         |SI #dspase15#24 ! 0;  |HAZ Renta2002;    |FINSI;
         |SI #dspase15#23 ! 0;  |HAZ Renta2001;    |FINSI;
         |SI #dspase15#8  ! 0;  |HAZ Renta2000;    |FINSI;
         |SI #dspase15#9  ! 0;  |HAZ Renta1999;    |FINSI;
         |SI #dspase15#10 ! 0;  |HAZ Renta1998;    |FINSI;
         |SI #dspase15#11 ! 0;  |HAZ Renta1997;    |FINSI;
         |SI #dspase15#12 ! 0;  |HAZ Renta1996;    |FINSI;
         |SI #dspase15#13 ! 0;  |HAZ Renta1995;    |FINSI;
         |SI #dspase15#14 ! 0;  |HAZ Renta1994;    |FINSI;

         |BUCLE dspase16;

         |REPON_DATOS #dspase15;
         |SELECT #3#dspase15;
         |LEE 101#dspase15.=;
         |SI FSalida = 0;
             #dspase15#15 = "S";
             |GRABA 020#dspase15.a;
             |LIBERA #dspase15;
         |FINSI;

         |ACABA;
     |FINSI;

     |SI #dspase15#4 ! 0;  |Y #dspase15#4 ! #dspase15#3;    || Basica
         |HAZ Basica;
     |FINSI;

     |SI #dspase15#5 ! 0;  |Y #dspase15#5 ! #dspase15#3;
         |HAZ Laboral;
     |FINSI;

     |SI #dspase15#6 ! 0;  |Y #dspase15#6 ! #dspase15#3;
         |HAZ Contabilidad;
     |FINSI;

     |SI #dspase15#7 ! 0;  |Y #dspase15#7 ! #dspase15#3;
         |HAZ Sociedad;
     |FINSI;

     |SI #dspase15#40 ! 0;  |Y #dspase15#40 ! #dspase15#3;   || 2018
         |HAZ Renta2018;
     |FINSI;

     |SI #dspase15#39 ! 0;  |Y #dspase15#39 ! #dspase15#3;   || 2017
         |HAZ Renta2017;
     |FINSI;

     |SI #dspase15#38 ! 0;  |Y #dspase15#38 ! #dspase15#3;   || 2016
         |HAZ Renta2016;
     |FINSI;

     |SI #dspase15#37 ! 0;  |Y #dspase15#37 ! #dspase15#3;   || 2015
         |HAZ Renta2015;
     |FINSI;

     |SI #dspase15#36 ! 0;  |Y #dspase15#36 ! #dspase15#3;   || 2014
         |HAZ Renta2014;
     |FINSI;

     |SI #dspase15#35 ! 0;  |Y #dspase15#35 ! #dspase15#3;   || 2013
         |HAZ Renta2013;
     |FINSI;

     |SI #dspase15#34 ! 0;  |Y #dspase15#34 ! #dspase15#3;
         |HAZ Renta2012;
     |FINSI;

     |SI #dspase15#33 ! 0;  |Y #dspase15#33 ! #dspase15#3;
         |HAZ Renta2011;
     |FINSI;

     |SI #dspase15#32 ! 0;  |Y #dspase15#32 ! #dspase15#3;
         |HAZ Renta2010;
     |FINSI;

     |SI #dspase15#31 ! 0;  |Y #dspase15#31 ! #dspase15#3;
         |HAZ Renta2009;
     |FINSI;

     |SI #dspase15#30 ! 0;  |Y #dspase15#30 ! #dspase15#3;
         |HAZ Renta2008;
     |FINSI;

     |SI #dspase15#29 ! 0;  |Y #dspase15#29 ! #dspase15#3;
         |HAZ Renta2007;
     |FINSI;

     |SI #dspase15#28 ! 0;  |Y #dspase15#28 ! #dspase15#3;
         |HAZ Renta2006;
     |FINSI;

     |SI #dspase15#27 ! 0;  |Y #dspase15#27 ! #dspase15#3;
         |HAZ Renta2005;
     |FINSI;

     |SI #dspase15#26 ! 0;  |Y #dspase15#26 ! #dspase15#3;
         |HAZ Renta2004;
     |FINSI;

     |SI #dspase15#25 ! 0;  |Y #dspase15#25 ! #dspase15#3;
         |HAZ Renta2003;
     |FINSI;

     |SI #dspase15#24 ! 0;  |Y #dspase15#24 ! #dspase15#3;
         |HAZ Renta2002;
     |FINSI;

     |SI #dspase15#23 ! 0;  |Y #dspase15#23 ! #dspase15#3;
         |HAZ Renta2001;
     |FINSI;

     |SI #dspase15#8 ! 0;  |Y #dspase15#8 ! #dspase15#3;
         |HAZ Renta2000;
     |FINSI;

     |SI #dspase15#9 ! 0;  |Y #dspase15#9 ! #dspase15#3;
         |HAZ Renta1999;
     |FINSI;

     |SI #dspase15#10 ! 0;  |Y #dspase15#10 ! #dspase15#3;
         |HAZ Renta1998;
     |FINSI;

     |SI #dspase15#11 ! 0;  |Y #dspase15#11 ! #dspase15#3;
         |HAZ Renta1997;
     |FINSI;

     |SI #dspase15#12 ! 0;  |Y #dspase15#12 ! #dspase15#3;
         |HAZ Renta1996;
     |FINSI;

     |SI #dspase15#13 ! 0;  |Y #dspase15#13 ! #dspase15#3;
         |HAZ Renta1995;
     |FINSI;

     |SI #dspase15#14 ! 0;  |Y #dspase15#14 ! #dspase15#3;
         |HAZ Renta1994;
     |FINSI;

     |BUCLE dspase16;

     |REPON_DATOS #dspase15;
     |SELECT #3#dspase15;
     |LEE 101#dspase15.=;
     |SI FSalida = 0;
         #dspase15#15 = "S";
         |GRABA 020#dspase15.a;
         |LIBERA #dspase15;
     |FINSI;
|FPRC;

|DEFBUCLE dspase15;
     #dspase15#3;
     15;
     00001, "            ", 000, "N";
     99999, "zzzzzzzzzzzz", 999, "N";
     ;
     NULL, PasaLaFicha;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |SI #dspase17#0 ! "SI";  |ACABA;  |FINSI;

     |HAZ BusquedaApli;
     eaPasaCact = "N";
     eaPasaNuct = "";

     enTransfor  = 1;
     |BUCLE dspase15;
|FPRC;

|PROGRAMA;
     |ABRE #dsficher;
     |LEE 040#dsficher.p;
     |SI FSalida ! 0;
         |MENAV "     No instalado fichero de cambios. Consulte a su Administrador del Programa";
         |CIERRA #dsficher;
         |ACABA;
     |FINSI;
     |CIERRA #dsficher;

     |ABRE #dspase15;
     |SELECT #3#dspase15;
     |LEE 040#dspase15.u;
     |SI FSalida = 0;
         |SI #dspase15#15 = "S";
             |MENAV "      La unificacion ya esta realizada.";
             |CIERRA #dspase15;
             |ACABA;
         |FINSI;
     |FINSI;

     |SELECT #1#dspase15;
     |LEE 040#dspase15.p;
     |SI FSalida = 0;
         |SI #dspase15#16 = "N";
             |MENAV "      Consulte las incidencias de la Plantilla de la Unificacion";
             |CIERRA #dspase15;
             |ACABA;
         |FINSI;
     |FINSI;
     |CIERRA #dspase15;

     |MANTE #dspase17;
|FPRO;
