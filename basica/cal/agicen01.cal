|FICHEROS;
     agicen01  #1;
     agicen08  #8;
     agicen09  #9;
     agicen10 #10;
|FIN;

|VARIABLES;
     &enEmpresa   = 0;
     &enActividad = 0;
     &enContador  = 0;
     &enTipo      = 0;
     &eaNombreEmp = "";
     &eaNombreAct = "";
     &enModo      = 0;
     &efFechaAlta = @;
     &efFechaBaja = @;
     &eaCodEpi1   = "";
     &eaCodEpi2   = "";

      nModo       = 0;
      nForma      = 0;

 {-1} menu    = "";
      menu1   = "1927";
      menu2   = "1";
      menu3   = "2";
      menu4   = "Modelo 845                          ";
      menu5   = "Modelo 846                          ";
|FIN;

|PROCESO Borra10;
     |BORRA 140#10a;
     |LIBERA #10;
|FPRC;

|DEFBUCLE agicen10;
     #10#1;
     ;
     #1#0, #1#17, #1#1, 01;
     #1#0, #1#17, #1#1, 99;
     be;
     NULL, Borra10;
|FIN;

|PROCESO Borrado;
     |ABRE #08; #08#0 = #1#0; #08#114= #1#17;  #08#1 = #1#1; |BORRA 140#08c; |LIBERA #08; |CIERRA #08;
     |ABRE #09; #09#0 = #1#0; #09#50 = #1#17;  #09#1 = #1#1; |BORRA 140#09c; |LIBERA #09; |CIERRA #09;
     |BUCLE agicen10;
|FPRC;

|PROCESO CargaMenu; |TIPO 2;
     nModo  = 0 +. 1;
     nForma = (FEntrada / 100) ! 0;

     |SI nForma = 3; |HAZ Borrado; |ACABA; |FINSI;
     |SI nModo ! 1;                |ACABA; |FINSI;

     #1#7 = eaNombreEmp;
     #1#4 = eaNombreAct;
     #1#2 = eaCodEpi1;
     #1#3 = eaCodEpi2;

     enContador  = #1#1;
     efFechaAlta = #1#5;
     efFechaBaja = #1#14;
     eaCodEpi1   = #1#2;
     eaCodEpi2   = #1#3;
     enTipo      = #1#6;

     |PUSHV 0501 2380;
     |PARA; |SI; |HACIENDO;
            |MENUG menu;
            menu2 = FSalida;
            |SI menu2 ] "1"; |Y menu2 [ "2";
                |SI menu2 = "1";  |SUB_EJECUTA_NP "agicen08"; |FINSI;
                |SI menu2 = "2";  |SUB_EJECUTA_NP "agicen09"; |FINSI;
            |SINO;
                |SAL;
            |FINSI;
      |SIGUE;
      |POPV;
|FPRC;

|RUTINA ClaveBaja1;
     #1#0  = enEmpresa;
     #1#17 = enActividad;
     #1#1  = 1;
|FRUT;

|RUTINA ClaveAlta1;
     #1#0  = enEmpresa;
     #1#17 = enActividad;
     #1#1  = 99;
|FRUT;

|PROGRAMA;
     |ENTLINEAL #1#1, -3, enModo, 22, 1, ClaveBaja1, ClaveAlta1;
|FPRO;
