|FICHEROS;
     agicen15 #5;
     agim0004 #4;
     &regisnif@ #709;
|FIN;

|VARIABLES;
     &enEmpresa   = 0;
     &enActividad = 0;
     &enContador  = 0;
     &enTipo      = 0;
     &eaNombreEmp = "";
     &eaNombreAct = "";
     &eaVarDni    = "";
     &enCalcCif   = 0;
     &enCodProv   = 0;
     &enCodPobl   = 0;
     &eaPoblacion = "";
     &enModoPob   = 1;
     &enModo      = 0;
     &eaCodNif    = "";

     aTecla       = "";
|FIN;

|PROCESO NombreRepre;
     |HAZ LeeNifs;     || Esto no haze n  pero quien lo toque
                       || los corto lo guevos  PARAQUITAR
|FPRC;

|PROCESO LeePorNif;
     eaCodNif = #5#4;
     |HAZ LeeNifs;

     #5#5  = #709#1;    |PINTA #5#5;
     #5#8  = #709#9;    |PINTA #5#5;
     #5#9  = #709#2;    |PINTA #5#9;
     #5#10 = #709#3;    |PINTA #5#10;
     #5#11 = #709#16;   |PINTA #5#11;
     #5#12 = #709#10;   |PINTA #5#12;
     #5#13 = #709#11;   |PINTA #5#13;
     #5#14 = #709#8;    |PINTA #5#14;
     #5#15 = #709#4;    |PINTA #5#15;
     #5#16 = #709#5;    |PINTA #5#16;
|FPRC;

|PROCESO LetraDniCen05;  |TIPO 6;
     |SI FSalida = 10;
         eaVarDni  = #5Campo;
         enCalcCif = 1;
         |HAZ CalculoDNI;
         #5Campo = eaVarDni;
         |PINTA #5Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #5Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 112;
     |SI #5Campo ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #5Campo = eaVarDni;  |PINTA #5Campo;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CogeRepre;
     #5#4  = #4#2;    || NIF
     #5#5  = #4#3;    || Apellidos y Nombre
     #5#9  = #4#6;    || Domicilio
     #5#10 = #4#7;    || Numero
     #5#15 = #4#8;    || Codigo Postal 1
     #5#16 = #4#9;    || Codigo Postal 2
     #5#17 = #4#10;   || Municipio
     #5#18 = #4#11;   || Provincia
     |ERROR10;
|FPRC;

|DEFBUCLE agim0004;
     #4#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     ;
     NULL, CogeRepre;
|FIN;

|PROGRAMA;

     |SI enModo ! 4;
          |ABRE #5;
          |PINPA #0#5;
          #5#0  = enEmpresa;
          |LIBERA #5;
          |LEE 140#5=;
          |SI FSalida = 0;
              #5#2  = eaNombreEmp;
              |PINDA #0#5;
              |ENDATOS #1#5;
              |SI FSalida = 0; |GRABA 140#5a; |FINSI;
          |SINO;
              |DDEFECTO #5;
              #5#0  = enEmpresa;
              #5#2  = eaNombreEmp;
              #5#3  = eaNombreAct;

              |BUCLE agim0004;

              |PINDA #0#5;
              |ENDATOS #1#5;
              |SI FSalida = 0; |GRABA 140#5n; |FINSI;
          |FINSI;
          |CIERRA #5;
     |SINO;
          |ABRE #5;
          #5#0  = enEmpresa;
          |LEE 040#5=;
          |SI FSalida = 0;
              |PINPA #0#5;
              |PINDA #0#5;
              |LEETECLA aTecla;
          |FINSI;
          |CIERRA #5;
     |FINSI;
|FPRO;
