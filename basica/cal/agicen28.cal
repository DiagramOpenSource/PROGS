|FICHEROS;
     agicen27 #27;
     agicen28 #28;
     agiw0066 #966,MANTE;
|FIN;

|VARIABLES;
      nCampo     = 0;
      nCampoD    = 0;
      nCampoH    = 0;

      aAlfa1     = "";
      aAlfa2     = "";

     &enEmpresa   = 0;
     &enActividad = 0;
     &enRegistro  = 0;
     &eaTipo      = "";
     &enOpcion    = 0;

     &eaVarDni   = "";
     &enCalcCif  = 0;

     &eaTabla    = "";
     &eaDestino  = "";
     &eaAlfa     = "";
     &enError    = 0;
     &enComp     = 0;
     &enPosicion = 0;
|FIN;

|PROCESO PonDatos;
     || Slo sirve para que no de error de compilacion.

     |HAZ LeeNifs;
|FPRC;

|PROCESO SacaSgCen28;  |TIPO 7;
     eaTabla = "txtm0001.txt";
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompruebaSgCen28;  |TIPO 0;
     |SI FSalida = 10;
         enPosicion = 55;
         |HAZ SacaTabla;
         #28Campo = eaDestino % 102;
         |PINTA #28Campo;
     |FINSI;

     enComp = 2;
     eaAlfa = #28Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     |HAZ FinTabla;
|FPRC;

|RUTINA ClaveBaja28;
     #28#0 = enEmpresa;
     #28#1 = enActividad;
     #28#2 = enRegistro;
     #28#3 = 1;
|FRUT;

|RUTINA ClaveAlta28;
     #28#0 = enEmpresa;
     #28#1 = enActividad;
     #28#2 = enRegistro;
     #28#3 = 99;
|FRUT;

|PROCESO agicen28;
     #27#141 = #27#141 + 1;
     #27#142 = #27#142 + #28#48;
     #27#143 = #27#143 + #28#49;
     #27#144 = #27#144 + #28#50;
|FPRC;

|DEFBUCLE agicen28;
     #28#1;
     ;
     enEmpresa, enActividad, enRegistro, 00;
     enEmpresa, enActividad, enRegistro, 99;
     ;
     NULL, agicen28;
|FIN;

|PROCESO Tipo2Cen28;  |TIPO 2;
     #27#141 = #27#141 +. 1;
     #27#142 = #27#142 +. #28#48;
     #27#143 = #27#143 +. #28#49;
     #27#144 = #27#144 +. #28#50;

     |PINTA 1111, #27#141;
     |PINTA 1121, #27#142;
     |PINTA 1146, #27#143;
     |PINTA 1170, #27#144;
|FPRC;

|PROGRAMA;
     |ABRE #27;
     #27#0 = enEmpresa;
     #27#1 = enActividad;
     #27#2 = enRegistro;
     |LEE 101#27=;
     |SI FSalida ! 0;
         |DDEFECTO #27;
         #27#0 = enEmpresa;
         #27#1 = enActividad;
         #27#2 = enRegistro;
         |GRABA 020#27b;
     |FINSI;

     #27#141 = 0;
     #27#142 = 0;
     #27#143 = 0;
     #27#144 = 0;
     |BUCLE agicen28;

     |PINPA #0#28;

     |PINTA 1111, #27#141;
     |PINTA 1121, #27#142;
     |PINTA 1146, #27#143;
     |PINTA 1170, #27#144;

     |ENTLINEAL #1#28, -4, 2, 22, 0, ClaveBaja28, ClaveAlta28;

     #27#141 = 0;
     #27#142 = 0;
     #27#143 = 0;
     #27#144 = 0;
     |BUCLE agicen28;
     |GRABA 020#27a;
     |LIBERA #27;
     |CIERRA #27;
|FPRO;

|PROCESO SacaPantalla;  |TIPO 7;
     |PUSHV 0501 2380;
     |DDEFECTO #966;

     |PARA nCampoD = 27;  |SI nCampoD [ 62;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH     = nCampoD - 12;
           #966nCampoD = #28nCampoH;
     |SIGUE;

     |PARA nCampoD = 0;  |SI nCampoD [ 26;  |HACIENDO nCampoD = nCampoD + 1;
           |C_V #966nCampoD, 1, "N";  |C_M #966nCampoD, 1, "N";
     |SIGUE;
     |C_V #966#63, 1, "N";  |C_M #966#63, 1, "N";
     |C_V #966#64, 1, "N";  |C_M #966#64, 1, "N";

     |PINPA #1#966;
     |PINDA #1#966;
     |ENDATOS #1#966;
     |SI FSalida = 0;
         |PARA nCampoD = 27;  |SI nCampoD [ 62;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH     = nCampoD - 12;
               #28nCampoH = #966nCampoD;
         |SIGUE;
     |FINSI;

     |POPV;

     |PINTA #28#48;
     |PINTA #28#49;
     |PINTA #28#50;
|FPRC;
