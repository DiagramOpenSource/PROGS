|FICHEROS;
   agiusuar #0;
   agiw0016 #1;
|FIN;

|VARIABLES;
    alfa1 = "";
    para1 = 0;
    dbase = "";
    buf_men = 0;
    top_men = 0;
    buf_usr = 0;
    ele_usr = 0;
    nGraba  = 0;
|FIN;

|INCLUYE i_ficher;

|PROCESO CargaUsr; |TIPO 8;
comienza = "16"; |HAZ fichero;
|NOME_DAT #1 fichero;
|ABRE #1; |CIERRA #1; |DELINDEX #1;

|ABRE #1;
|DIMENSIONA 1000, buf_men, 0;
    dbase = "";
    |DIRECTORIO dbase;
    alfa1  = dbase + "dev/usr/ds_sys.psw"
    nGraba = 0;
    |LEESECUENCIAL alfa1, buf_usr, ele_usr, 0, 0;
    |PARA para1 = 0; |SI para1 < ele_usr; |HACIENDO para1 = para1 + 1;
         |DEL_BUF buf_usr, para1, alfa1;
         |DDEFECTO #1;
         #1#0 = alfa1 % 103;             || nro.opcion
         #1#1 = alfa1 % 410;             || nombre
         |GRABA 020#1n;
         nGraba = 1;
    |SIGUE;

    |SI nGraba = 0;
        alfa1  = dbase + "dev/usr/agisys.psw"
        nGraba = 0;
        |LEESECUENCIAL alfa1, buf_usr, ele_usr, 0, 0;
        |PARA para1 = 0; |SI para1 < ele_usr; |HACIENDO para1 = para1 + 1;
             |DEL_BUF buf_usr, para1, alfa1;
             |DDEFECTO #1;
             #1#0 = alfa1 % 103;             || nro.opcion
             #1#1 = alfa1 % 410;             || nombre
             |GRABA 020#1n;
             nGraba = 1;
        |SIGUE;
    |FINSI;

|CIERRA #1;
|FINDIM buf_men;
|FPRC;

|PROCESO MiraUsr; |TIPO 7;
|SI #0#0 = "          "; |ACABA; |FINSI;

|ABRE #1;
|SELECT #2#1;
#1#1 = #0#0;
|LEE 040#1=;
|SI FSalida ! 0;
    |MENAV "      No Existe el codigo en el Registro de Usuarios";
    |PTEC 807;
|FINSI;
#0#2 = #1#0;  |PINTA #0#2;

|CIERRA #1;
|FPRC;

|PROCESO GrabaUsr;
#0#0 = #1#1;
|LIBERA #0;
|LEE 140#0=;
|SI FSalida ! 0;
    |CDEFECTO #0, 1;
    #0#1 = "";
    #0#2 = #1#0;
    |GRABA 140#0n;
|SINO;
    #0#2 = #1#0;
    |GRABA 140#0a;
|FINSI;
|FPRC;

|DEFBUCLE eosw0016;
#1#1;
;
000;
999;
;
NULL, GrabaUsr;
|FIN;

|PROCESO CogeUsr; |TIPO 0;
|SI FSalida ! 9; |ACABA; |FINSI;

|BUCLE eosw0016;
|FPRC;

|PROCESO DescargaUsr; |TIPO 9;
|ABRE #1; |CIERRA #1; |DELINDEX #1;
|FPRC;
