|FICHEROS;
     dspase01;
     dspase00;
     dspase15;
     dspase85;

     :/integral/def/dsam0002;
     :/integral/def/dsam0100;
     :/integral/def/dsam0009;
     :/integral/def/dsam0010;

     refer00@;
     refer01@;
     refer02@;
     refer03@;
     refer04@;
     refer05@;
     refer06@;
     refer07@;
     refer08@;
     refer09@;
     refer10@;
     refer11@;
|FIN;

|VARIABLES;
     aDef            = "";
     aFich           = "";
     aAlfa           = "";
     aAlfa1          = "";
     aAlfa2          = "";
     aAlfa3          = "";
     aAlfa4          = "";
     aFicheroD       = "";
     aFicheroH       = "";
     aOrigen         = "";
     aDestino        = "";
     aTPpal          = "";
     aTFax           = "";
     aTOtros         = "";
     aPathDefFiscal  = "";
     aPathFichFiscal = "";
     aPathDefLaboral = "";
     aPathFichLaboral= "";
     aPathAnterior   = "";

     nLinea          = 0;
     nCampo          = 0;
     nCodigo         = 0;
     nCodigoNue      = 0;
     nCodigoReo      = 0;
     nCodigoLab      = 0;
     nAnyo           = 0;
     nLineaTel       = 0;
     nRenta          = 0;
     nHastaCampo     = 0;
     nNume           = 0;
     nCampoD         = 0;
     nCampoH         = 0;

     aNif            = "";
     aLetra1         = "";
     aLetra2         = "";
     aLetra3         = "";
     aLetra4         = "";
     aLetra5         = "";
     aLetra6         = "";
     aLetra7         = "";
     aLetra8         = "";
     aCadena         = "";
     aCaracter       = "";
     aCarac1         = 0;
     aCarac2         = 0;
     aCarac3         = 0;
     aCarac4         = 0;
     aCarac5         = 0;
     nCaracter       = 0;
     nPosi           = 0;

     &eaPathBasica   = "";
     &eaPathContagen = "";
     &eaPathContanex = "";
     &eaPathContasoc = "";
     &eaPathRen2018  = "";
     &eaPathRen2017  = "";
     &eaPathRen2016  = "";
     &eaPathRen2015  = "";
     &eaPathRen2014  = "";
     &eaPathRen2013  = "";
     &eaPathRen2012  = "";
     &eaPathRen2011  = "";
     &eaPathRen2010  = "";
     &eaPathRen2009  = "";
     &eaPathRen2008  = "";
     &eaPathRen2007  = "";
     &eaPathRen2006  = "";
     &eaPathRen2005  = "";
     &eaPathRen2004  = "";
     &eaPathRen2003  = "";
     &eaPathRen2002  = "";
     &eaPathRen2001  = "";
     &eaPathRen2000  = "";
     &eaPathRen1999  = "";
     &eaPathRen1998  = "";
     &eaPathRen1997  = "";
     &eaPathRen1996  = "";
     &eaPathRen1995  = "";
     &eaPathRen1994  = "";
     &eaPathFacturar = "";
     &eaPathLaboral  = "";
     &eaPathIntegral = "";
     &eaPathDsmodelo = "";
     &eaPathFiscal   = "";

     &enAnyo         = 0;
     &enCalcCif      = 0;
     &eaVarDni       = "";
|FIN;

\\__________ Proceso Unificacion de Bancos Clientes
|PROCESO CogeCodigo;
     |SI #dspase15#22 = "S";  |ACABA;  |FINSI;

     nCodigoNue = #dspase15#3;
     |ERROR10;
|FPRC;

|DEFBUCLE dspase15;
     #dspase15#4;
     ;
     nCodigoReo, "            ", 000;
     nCodigoReo, "zzzzzzzzzzzz", 999;
     ;
     NULL, CogeCodigo;
|FIN;

|PROCESO CogeCodigoLab;
     |SI #dspase15#22 = "S";  |ACABA;  |FINSI;

     nCodigoNue = #dspase15#3;
     |ERROR10;
|FPRC;

|DEFBUCLE dspase15Lab;
     #dspase15#6;
     ;
     nCodigoLab, "            ", 000;
     nCodigoLab, "zzzzzzzzzzzz", 999;
     ;
     NULL, CogeCodigoLab;
|FIN;

|PROCESO GrabaFacBanco;
     aAlfa1 = #refer09@#13 % 104;  |QBF aAlfa1;
     aAlfa2 = #refer09@#13 % 504;  |QBF aAlfa2;
     |SI aAlfa1 = "";  |Y aAlfa2 = "";  |ACABA;  |FINSI;

     #dspase85#0 = aAlfa1;
     #dspase85#1 = aAlfa2;
     |LEE 101#dspase85.=;
     |SI FSalida ! 0;
         |DDEFECTO #dspase85;
         #dspase85#0 = aAlfa1;
         #dspase85#1 = aAlfa2;
         |GRABA 020#dspase85.b;
     |FINSI;

     #dspase85#2 = #refer09@#11;
     #dspase85#7 = #refer09@#12;
     #dspase85#4 = #refer09@#53;
     |GRABA 020#dspase85.a;
     |LIBERA #dspase85;
|FPRC;

|DEFBUCLE asclientB;
     #refer09@#1001;
     ;
     00000;
     99999;
     be;
     NULL, GrabaFacBanco;
|FIN;

|PROCESO GrabaTempoFac;
     aFich  = eaPathFacturar + "fich/" + (("00" + #refer08@#0) % -102) + "/";  |QBT aFich;

     aDef   = eaPathFacturar + "def/asclient.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PATH_DAT #refer09@#aFich#;

     |BUCLE asclientB;

     |DESCARGA_DEF #refer09@;
|FPRC;

|DEFBUCLE facemp1B;
     #refer08@#2002;
     ;
     "S", 00;
     "S", 99;
     ;
     NULL, GrabaTempoFac;
|FIN;

|PROCESO BancoFacturacion;
     aDef = eaPathFacturar + "def/facemp1.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;
         || |DESCARGA_DEF #refer10@;
         |ACABA;
     |FINSI;

     |BUCLE facemp1B;

     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO GrabaTempoBasica;
     aAlfa1 = #refer08@#81;  |QBF aAlfa1;
     aAlfa2 = #refer08@#82;  |QBF aAlfa2;
     |SI aAlfa1 = "";  |Y aAlfa2 = "";  |ACABA;  |FINSI;

     #dspase85#0 = aAlfa1;
     #dspase85#1 = aAlfa2;
     |LEE 101#dspase85.=;
     |SI FSalida ! 0;
         |DDEFECTO #dspase85;
         #dspase85#0 = aAlfa1;
         #dspase85#1 = aAlfa2;
         |GRABA 020#dspase85.b;
     |FINSI;

     #dspase85#2 = #refer08@#80;
     #dspase85#5 = #refer08@#79;
     |GRABA 020#dspase85.a;
     |LIBERA #dspase85;
|FPRC;

|DEFBUCLE agifigenB;
     #refer08@#1001;
     ;
     00001;
     99999;
     ;
     NULL, GrabaTempoBasica;
|FIN;

|PROCESO BancoAgicli;
     aDef = eaPathBasica + "def/agifigen.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BUCLE agifigenB;

     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO GrabaTempoLaboral1;
     nCodigoNue = 0;
     nCodigoLab = #refer08@#0;
     |BUCLE dspase15Lab;
     |SI nCodigoNue = 0;  |ACABA;  |FINSI;

     aAlfa1 = #refer08@#01 % 104;  |QBF aAlfa1;
     aAlfa2 = #refer08@#01 % 504;  |QBF aAlfa2;
     aAlfa3 = #refer08@#01 % 902;  |QBF aAlfa3;
     aAlfa4 = #refer08@#01 % 1110; |QBF aAlfa4;

     |SI aAlfa1 = "";  |Y aAlfa2 = "";  |ACABA;  |FINSI;

     #dspase85#0 = aAlfa1;
     #dspase85#1 = aAlfa2;
     |LEE 101#dspase85.=;
     |SI FSalida ! 0;
         |DDEFECTO #dspase85;
         #dspase85#0 = aAlfa1;
         #dspase85#1 = aAlfa2;
         |GRABA 020#dspase85.b;
     |FINSI;

     |GRABA 020#dspase85.a;
     |LIBERA #dspase85;

     |ABRE #dsam0009;
     #dsam0009#0 = nCodigoNue;
     #dsam0009#1 = 110;
     |LEE 101#dsam0009.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsam0009;
         #dsam0009#0 = nCodigoNue;
         #dsam0009#1 = 110;
         |GRABA 020#dsam0009.b;
     |FINSI;

     #dsam0009#2  = "BANCO PARA MODELO 110";
     #dsam0009#3  = 0;
     #dsam0009#4  = "";
     #dsam0009#5  = aAlfa1;
     #dsam0009#6  = aAlfa2;
     #dsam0009#7  = aAlfa3;
     #dsam0009#8  = aAlfa4;

                                 #dsam0009#9 = 1;
     |SI #dsam0009#8 ! "          ";  #dsam0009#9 = 2;  |FINSI;

     #dsam0009#11 = #refer08@#4;
     #dsam0009#12 = #refer08@#3;
     #dsam0009#18 = #refer08@#2;

     |GRABA 020#dsam0009.a;
     |LIBERA #dsam0009;

     #dsam0009#0 = nCodigoNue;
     #dsam0009#1 = 998;
     |LEE 101#dsam0009.=;
     |SI FSalida = 0;
         |LIBERA #dsam0009;
         |CIERRA #dsam0009;
         |ACABA;
     |FINSI;

     |DDEFECTO #dsam0009;
     #dsam0009#0 = nCodigoNue;
     #dsam0009#1 = 998;
     #dsam0009#2  = "BANCO PARA GESTION LABORAL";
     #dsam0009#3  = 0;
     #dsam0009#4  = "";
     #dsam0009#5  = aAlfa1;
     #dsam0009#6  = aAlfa2;
     #dsam0009#7  = aAlfa3;
     #dsam0009#8  = aAlfa4;

                                 #dsam0009#9 = 1;
     |SI #dsam0009#8 ! "          ";  #dsam0009#9 = 2;  |FINSI;

     #dsam0009#11 = #refer08@#4;
     #dsam0009#12 = #refer08@#3;
     #dsam0009#18 = #refer08@#2;

     |GRABA 020#dsam0009.n;
     |LIBERA #dsam0009;
     |CIERRA #dsam0009;
|FPRC;

|DEFBUCLE nomyb110B;
     #refer08@#1001;
     ;
     00001;
     99999;
     be;
     NULL, GrabaTempoLaboral1;
|FIN;

|PROCESO GrabaTempoLaboral2;
     aAlfa1 = #refer08@#113 % 104;   |QBF aAlfa1;
     aAlfa2 = #refer08@#113 % 504;   |QBF aAlfa2;
     aAlfa3 = #refer08@#113 % 902;   |QBF aAlfa3;
     aAlfa4 = #refer08@#113 % 1110;  |QBF aAlfa4;

     |SI aAlfa1 = "";  |Y aAlfa2 = "";  |ACABA;  |FINSI;

     #dspase85#0 = aAlfa1;
     #dspase85#1 = aAlfa2;
     |LEE 101#dspase85.=;
     |SI FSalida ! 0;
         |DDEFECTO #dspase85;
         #dspase85#0 = aAlfa1;
         #dspase85#1 = aAlfa2;
         |GRABA 020#dspase85.b;
     |FINSI;

     #dspase85#3 = #refer08@#30;
     |GRABA 020#dspase85.a;
     |LIBERA #dspase85;

     |ABRE #dsam0009;
     #dsam0009#0 = #refer08@#0;
     #dsam0009#1 = 998;
     |LEE 101#dsam0009.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsam0009;
         #dsam0009#0 = #refer08@#0;
         #dsam0009#1 = 998;
         |GRABA 020#dsam0009.b;
     |FINSI;

     #dsam0009#0  = #refer08@#0;
     #dsam0009#1  = 998;
     #dsam0009#2  = "BANCO PARA GESTION LABORAL";
     #dsam0009#3  = 0;
     #dsam0009#4  = "";
     #dsam0009#5  = aAlfa1;
     #dsam0009#6  = aAlfa2;
     #dsam0009#7  = aAlfa3;
     #dsam0009#8  = aAlfa4;

                                 #dsam0009#9 = 1;
     |SI #dsam0009#8 ! "          ";  #dsam0009#9 = 2;  |FINSI;

     #dsam0009#11 = #refer08@#136;
     #dsam0009#12 = #refer08@#135;
     #dsam0009#18 = #refer08@#134;

     |GRABA 020#dsam0009.a;
     |LIBERA #dsam0009;
     |CIERRA #dsam0009;
|FPRC;

|DEFBUCLE labempreB;
     #refer08@#1001;
     ;
     00001;
     99999;
     be;
     NULL, GrabaTempoLaboral2;
|FIN;

|PROCESO BancoLaboral;
     aDef = eaPathLaboral + "def/labempre.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BUCLE labempreB;

     |DESCARGA_DEF #refer08@;

     aDef = aPathDefLaboral + "nomyb110.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aFich = aPathFichLaboral;

     |PATH_DAT #refer08@#aFich#;

     |BUCLE nomyb110B;

     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO GrabaTempoEos;
     nCodigoNue = 0;
     nCodigoReo = #refer08@#0;
     |BUCLE dspase15;
     |SI nCodigoNue = 0;  |ACABA;  |FINSI;

     aAlfa1 = #refer08@#02; |QBF aAlfa1;
     aAlfa2 = #refer08@#03; |QBF aAlfa2;
     aAlfa3 = #refer08@#04;
     aAlfa4 = #refer08@#05;

     |SI aAlfa1 = "";  |Y aAlfa2 = "";  |ACABA;  |FINSI;

     #dspase85#0 = aAlfa1;
     #dspase85#1 = aAlfa2;
     |LEE 101#dspase85.=;
     |SI FSalida ! 0;
         |DDEFECTO #dspase85;
         #dspase85#0 = aAlfa1;
         #dspase85#1 = aAlfa2;
         |GRABA 020#dspase85.b;
     |FINSI;

     #dspase85#2 = #refer08@#1;
     |GRABA 020#dspase85.a;
     |LIBERA #dspase85;

     |ABRE #dsam0009;
     #dsam0009#0 = nCodigoNue;
     #dsam0009#1 = 999;
     |LEE 101#dsam0009.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsam0009;
         #dsam0009#0 = nCodigoNue;
         #dsam0009#1 = 999;
         |GRABA 020#dsam0009.b;
     |FINSI;
     #dsam0009#2  = "BANCO PARA GESTION MODELOS";
     #dsam0009#3  = 0;
     #dsam0009#4  = "";
     #dsam0009#5  = aAlfa1;
     #dsam0009#6  = aAlfa2;
     #dsam0009#7  = aAlfa3;
     #dsam0009#8  = aAlfa4;

                                 #dsam0009#9 = 1;
     |SI #dsam0009#8 ! "          ";  #dsam0009#9 = 2;  |FINSI;

     #dsam0009#11 = #refer08@#6;
     #dsam0009#12 = #refer08@#7;
     #dsam0009#18 = #refer08@#13;

     |GRABA 020#dsam0009.a;
     |LIBERA #dsam0009;
     |CIERRA #dsam0009;
|FPRC;

|DEFBUCLE eosdabanB;
     #refer08@#1001;
     ;
     00001;
     99999;
     be;
     NULL, GrabaTempoEos;
|FIN;

|PROCESO BancoEos;
     aDef = aPathDefFiscal + "eosdaban.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aFich = aPathFichFiscal;

     |PATH_DAT #refer08@#aFich#;

     |BUCLE eosdabanB;

     |DESCARGA_DEF #refer08@;
|FPRC;

|RUTINA ClaveBaja3;
     #dspase85#0 = "    ";
     #dspase85#1 = "    ";
|FRUT;

|RUTINA ClaveAlta3;
     #dspase85#0 = "zzzz";
     #dspase85#1 = "zzzz";
|FRUT;

|PROCESO dsam0009;
     #dsam0009#3 = #dspase85#6;
     #dsam0009#4 = #dspase85#2;
     |GRABA 020#dsam0009.a;
     |LIBERA #dsam0009;
|FPRC;

|DEFBUCLE dsam0009;
     #dsam0009#2;
     ;
     #dspase85#0, #dspase85#1, 998;
     #dspase85#0, #dspase85#1, 999;
     be;
     NULL, dsam0009;
|FIN;

|PROCESO GrabaBanco;
     nLinea = nLinea + 1;
     #dspase85#6  = nLinea;
     |GRABA 020#dspase85.a;
     |LIBERA #dspase85;

     |DDEFECTO #refer10@;
     #refer10@#0 = #dspase85#6;
     #refer10@#1 = #dspase85#2;
     #refer10@#2 = #dspase85#0;
     #refer10@#3 = #dspase85#1;
     #refer10@#6 = #dspase85#7;
     |GRABA 020#refer10@.n;
     |LIBERA #refer10@;

     |BUCLE dsam0009;
|FPRC;

|DEFBUCLE dspase85;
     #dspase85#1;
     ;
     "     ", "     ";
     "zzzzz", "zzzzz";
     be;
     NULL, GrabaBanco;
|FIN;

|PROCESO RecogeBancos;
     |ABRE #dspase85;  |CIERRA #dspase85;  |DELINDEX #dspase85;

     |ABRE #dspase85;
     |HAZ BancoFacturacion;
     |HAZ BancoAgicli;
     |HAZ BancoLaboral;
     |HAZ BancoEos;
     |CIERRA #dspase85;

     aDef   = eaPathIntegral + "def/dsam0116.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #refer10@;  |CIERRA #refer10@;  |DELINDEX #refer10@;

     |ABRE #refer10@;
     nLinea = 0;
     |BUCLE dspase85;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
|FPRC;

\\__________ Creacion de Ficheros de Siglas

|PROCESO GrabaDenomina;
     aAlfa1 = #refer05@#0; aAlfa1 = aAlfa1 > " ";
     #refer05@#1 = "";
     |SI aAlfa1 = "CL";  #refer05@#1 = "CALLE    ";  |FINSI;
     |SI aAlfa1 = "AV";  #refer05@#1 = "AVENIDA  ";  |FINSI;
     |SI aAlfa1 = "PA";  #refer05@#1 = "PARTIDA  ";  |FINSI;
     |SI aAlfa1 = "PZ";  #refer05@#1 = "PLAZA    ";  |FINSI;
     |SI aAlfa1 = "PL";  #refer05@#1 = "PLAZA    ";  |FINSI;
     |SI aAlfa1 = "CR";  #refer05@#1 = "CARRETERA";  |FINSI;
     |SI aAlfa1 = "AL";  #refer05@#1 = "ALAMEDA  ";  |FINSI;
     |SI aAlfa1 = "CM";  #refer05@#1 = "CAMINO   ";  |FINSI;
|FPRC;

\\__________ Creacion de Ficheros de Telefonos

|PROCESO GrabaLineaTelefono;
     #refer04@#0 = #refer03@#0;
     #refer04@#1 = nLineaTel;
     |LEE 101#refer04@.=;
     |SI FSalida ! 0;
         |DDEFECTO #refer04@;
          #refer04@#0 = #refer03@#0;
          #refer04@#1 = nLineaTel;
          |GRABA 020#refer04@.b;
     |FINSI;

     #refer04@#2 = aAlfa2;
     #refer04@#4 = aAlfa4;
     |GRABA 020#refer04@.a;
     |LIBERA #refer04@;
|FPRC;

|PROCESO GrabaTelefonos;
     #refer03@#0 = #refer00@#1;
     |LEE 101#refer03@.=;
     |SI FSalida ! 0;
         #refer03@#0 = #refer00@#1;
         #refer03@#1 = #refer00@#27;
         #refer03@#2 = #refer00@#28;
         |GRABA 000#refer03@.n;
     |FINSI;
     |LIBERA #refer03@;

     |SI aTPpal ! "";
         nLineaTel = 1;
         aAlfa2    = "TELEFONO PRINCIPAL";
         aAlfa4    = aTPpal;
         |HAZ GrabaLineaTelefono;

         nLineaTel = 2;
         aAlfa2    = "TELEFONO DE CONTACTO";
         aAlfa4    = aTPpal;
         |HAZ GrabaLineaTelefono;

         #refer00@#54 = aTPpal;
         #refer00@#55 = aTPpal;
     |FINSI;

     |SI aTFax ! "";
         nLineaTel = 3;
         aAlfa2    = "TELEFONO FAX";
         aAlfa4    = aTFax;
         |HAZ GrabaLineaTelefono;
     |FINSI;

     |SI aTOtros ! "";
         nLineaTel = 4;
         aAlfa2    = "OTROS TELEFONOS " + aTOtros;
         aAlfa4    = "";
         |HAZ GrabaLineaTelefono;
     |FINSI;

     #refer02@#0 = #refer00@#3;
     |LEE 040#refer02@.=;
     |SI FSalida ! 0;
         |DDEFECTO #refer02@;
         #refer02@#0  = #refer00@#3;
         #refer02@#1  = #refer00@#1;
         #refer02@#2  = #refer00@#20;
         #refer02@#3  = #refer00@#21;
         #refer02@#4  = #refer00@#25;
         #refer02@#5  = #refer00@#26;
         #refer02@#6  = #refer00@#27;
         #refer02@#7  = #refer00@#28;
         #refer02@#8  = #refer00@#54;
         #refer02@#9  = #refer00@#19;
         #refer02@#10 = #refer00@#23;
         #refer02@#11 = #refer00@#24;
         #refer02@#12 = #refer00@#98;
         #refer02@#13 = #refer00@#99;
         #refer02@#14 = #refer00@#86;
         #refer02@#15 = #refer00@#87;
         |GRABA 020#refer02@.n;
     |FINSI;
     |LIBERA #refer02@;

     #refer00@#98  = #refer02@#12;
     #refer00@#99  = #refer02@#13;
     #refer00@#86  = #refer02@#14;
     #refer00@#87  = #refer02@#15;
|FPRC;

\\__________ Creacion de Ficheros de Domicilios

|PROCESO GrabaDirecciones;
     #refer01@#0  = #refer00@#0;
     #refer01@#1  = 98;
     #refer01@#2  = "DOMICILIO FISCAL ";
     #refer01@#3  = #refer00@#29;
     #refer01@#4  = #refer00@#30;
     #refer01@#5  = #refer00@#31;
     #refer01@#6  = #refer00@#32;
     #refer01@#7  = #refer00@#33;
     #refer01@#8  = #refer00@#34;
     #refer01@#9  = #refer00@#35;
     #refer01@#10 = #refer00@#36;
     #refer01@#11 = #refer00@#37;
     #refer01@#12 = #refer00@#38;
     #refer01@#15 = #refer00@#86;
     #refer01@#16 = #refer00@#87;
     #refer01@#17 = #refer00@#98;
     #refer01@#18 = #refer00@#99;
     |GRABA 020#refer01@.n;
     |LIBERA #refer01@;

     #refer05@#0 = #refer01@#3;
     |LEE 101#refer05@.=;
     |SI FSalida ! 0;
         #refer05@#0 = #refer01@#3;
         |HAZ GrabaDenomina;
         |GRABA 020#refer05@.n;
     |FINSI;
     |LIBERA #refer05@;

     #refer01@#0  = #refer00@#0;
     #refer01@#1  = 97;
     #refer01@#2  = "DOMICILIO SOCIAL ";
     #refer01@#3  = #refer00@#19;
     #refer01@#4  = #refer00@#20;
     #refer01@#5  = #refer00@#21;
     #refer01@#6  = #refer00@#22;
     #refer01@#7  = #refer00@#23;
     #refer01@#8  = #refer00@#24;
     #refer01@#9  = #refer00@#25;
     #refer01@#10 = #refer00@#26;
     #refer01@#11 = #refer00@#27;
     #refer01@#12 = #refer00@#28;
     #refer01@#15 = #refer00@#86;
     #refer01@#16 = #refer00@#87;
     #refer01@#17 = #refer00@#98;
     #refer01@#18 = #refer00@#99;
     |GRABA 020#refer01@.n;
     |LIBERA #refer01@;

     #refer05@#0 = #refer01@#3;
     |LEE 101#refer05@.=;
     |SI FSalida ! 0;
         #refer05@#0 = #refer01@#3;
         |HAZ GrabaDenomina;
         |GRABA 020#refer05@.n;
     |FINSI;
     |LIBERA #refer05@;

     #refer01@#0  = #refer00@#0;
     #refer01@#1  = 99;
     #refer01@#2  = "DOMICILIO ENVIO ";
     #refer01@#3  = #refer00@#39;
     #refer01@#4  = #refer00@#40;
     #refer01@#5  = #refer00@#41;
     #refer01@#6  = #refer00@#42;
     #refer01@#7  = #refer00@#43;
     #refer01@#8  = #refer00@#44;
     #refer01@#9  = #refer00@#45;
     #refer01@#10 = #refer00@#46;
     #refer01@#11 = #refer00@#47;
     #refer01@#12 = #refer00@#48;
     #refer01@#15 = #refer00@#86;
     #refer01@#16 = #refer00@#87;
     #refer01@#17 = #refer00@#98;
     #refer01@#18 = #refer00@#99;
     |GRABA 020#refer01@.n;
     |LIBERA #refer01@;

     #refer05@#0 = #refer01@#3;
     |LEE 101#refer05@.=;
     |SI FSalida ! 0;
         #refer05@#0 = #refer01@#3;
         |HAZ GrabaDenomina;
         |GRABA 020#refer05@.n;
     |FINSI;
     |LIBERA #refer05@;
|FPRC;

\\__________ Creacion de Ficheros Maestros

|PROCESO Copialos;
     aOrigen  = eaPathBasica   + "fich/" + aFicheroD + ".dat";
     aDestino = eaPathIntegral + "fich/" + aFicheroH + ".dat";
     |COPIA_FICHERO aOrigen, aDestino;

     aOrigen  = eaPathBasica   + "fich/" + aFicheroD + ".ddx";
     aDestino = eaPathIntegral + "fich/" + aFicheroH + ".ddx";
     |COPIA_FICHERO aOrigen, aDestino;

     aOrigen  = eaPathBasica   + "fich/" + aFicheroD + ".ixx";
     aDestino = eaPathIntegral + "fich/" + aFicheroH + ".ixx";
     |COPIA_FICHERO aOrigen, aDestino;
|FPRC;

\\ ---------------- Pase de Ficheros de Autonomias

|PROCESO PonComunidad;
     #refer00@#0 = #refer01@#3;
     |LEE 101#refer00@.=;
     |SI FSalida ! 0;
         #refer00@#0 = #refer01@#3;
         #refer00@#1 = #refer01@#4;
         |GRABA 020#refer00@.n;
     |FINSI;
     |LIBERA #refer00@;
|FPRC;

|DEFBUCLE recofisc;
     #refer01@#1001;
     ;
     00;
     99;
     ;
     NULL, PonComunidad;
|FIN;

|PROCESO Autonomias;
     aDef = eaPathIntegral + "def/dsam0114.mas";
     |CARGA_DEF aDef, refer00@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathRen2001 + "def/recofisc.mas";
     |CARGA_DEF aDef, refer01@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     |ABRE #refer00@;   |CIERRA #refer00@;  |DELINDEX #refer00@;

     |ABRE #refer00@;
     |BUCLE recofisc;
     |CIERRA #refer00@;

     |DESCARGA_DEF #refer01@;
     |DESCARGA_DEF #refer00@;
|FPRC;

\\ ---------------- Pase de Ficheros de Poblaciones

|PROCESO GrabaPoblacion;
     #refer02@#0 = #refer03@#0;
     |LEE 040#refer02@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer02@;  |FINSI;

     #refer01@#0 = #refer03@#0;
     |LEE 040#refer01@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer01@;  |FINSI;

     |DDEFECTO #refer00@;
     #refer00@#0 = #refer03@#0;
     #refer00@#1 = #refer03@#1;
     #refer00@#2 = #refer02@#1;
     #refer00@#3 = #refer03@#2;
     #refer00@#4 = #refer01@#3;
     #refer00@#5 = #refer01@#4;
     |SI #refer00@#0 ] 1;  |Y #refer00@#0 [ 50;
         #refer00@#6 = "ES";
         #refer00@#7 = "ESPA¥A";
     |FINSI;
     |GRABA 020#refer00@.n;
     |LIBERA #refer00@;
|FPRC;

|DEFBUCLE agipobla;
     #refer03@#1002;
     ;
     00, 000;
     99, 999;
     be;
     NULL, GrabaPoblacion;
|FIN;

|PROCESO AutonomiasPobla;
     aDef = eaPathIntegral + "def/dsam0101.mas";
     |CARGA_DEF aDef, refer00@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathRen2001 + "def/recofisc.mas";
     |CARGA_DEF aDef, refer01@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0100.mas";
     |CARGA_DEF aDef, refer02@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathBasica + "def/agipobla.mas";
     |CARGA_DEF aDef, refer03@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer02@;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     |ABRE #refer00@;  |CIERRA #refer00@;  |DELINDEX #refer00@;

     |ABRE #refer00@;
     |ABRE #refer01@;
     |ABRE #refer02@;
     |BUCLE agipobla;
     |CIERRA #refer00@;
     |CIERRA #refer01@;
     |CIERRA #refer02@;

     |DESCARGA_DEF #refer03@;
     |DESCARGA_DEF #refer02@;
     |DESCARGA_DEF #refer01@;
     |DESCARGA_DEF #refer00@;
|FPRC;

\\ ---------------- Pase de Ficheros de Nif

|PROCESO GrabaNif;
     #refer04@#0 = #refer02@#14;
     |LEE 040#refer04@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer04@;  |FINSI;

     #refer03@#0 = #refer02@#7;
     #refer03@#1 = #refer02@#8;
     |LEE 101#refer03@.=;
     |SI FSalida = 0;
         #refer03@#6 = #refer04@#0;
         #refer03@#7 = #refer04@#1;
         |GRABA 020#refer03@.a;
     |SINO;
         |DDEFECTO #refer03@;
     |FINSI;
     |LIBERA #refer03@;

     enCalcCif = 3;
     eaVarDni  = #refer02@#0;
     |HAZ CalculoDNI;

     #refer00@#0 = eaVarDni;
     |LEE 101#refer00@.=;
     |SI FSalida ! 0;
         |DDEFECTO #refer00@;
         #refer00@#0 = eaVarDni;
         |GRABA 020#refer00@.b;
     |FINSI;

     #refer00@#1  = #refer02@#1;
     #refer00@#2  = #refer02@#3;
     #refer00@#3  = #refer02@#4;
     #refer00@#4  = #refer02@#7;
     #refer00@#5  = #refer02@#8;
     #refer00@#6  = #refer02@#10;
     #refer00@#7  = #refer02@#9;
     #refer00@#9  = #refer02@#2;
     #refer00@#10 = #refer02@#5;
     #refer00@#11 = #refer02@#6;
     #refer00@#12 = #refer02@#14
     #refer00@#13 = #refer04@#1;
     #refer00@#14 = #refer03@#4;
     #refer00@#15 = #refer03@#5;

     |GRABA 020#refer00@.a;
     |LIBERA #refer00@;

     #refer05@#0 = #refer00@#9;
     |LEE 101#refer05@.=;
     |SI FSalida ! 0;
         #refer05@#0 = #refer00@#9;
         |HAZ GrabaDenomina;
         |GRABA 020#refer05@.n;
     |FINSI;
     |LIBERA #refer05@;
|FPRC;

|DEFBUCLE eosclipr;
     #refer02@#1001;
     ;
     "              ";
     "zzzzzzzzzzzzzz";
     ;
     NULL, GrabaNif;
|FIN;

|PROCESO RegistrosNif;
     aDef = eaPathIntegral + "def/dsam0103.mas";
     |CARGA_DEF aDef, refer00@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = aPathDefFiscal + "eosaplic.mas";
     |CARGA_DEF aDef, refer01@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathBasica + "def/eosclipr.mas";
     |CARGA_DEF aDef, refer02@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0101.mas";
     |CARGA_DEF aDef, refer03@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer02@;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0104.mas";
     |CARGA_DEF aDef, refer04@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer03@;
         |DESCARGA_DEF #refer02@;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0115.mas";
     |CARGA_DEF aDef, refer05@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer04@;
         |DESCARGA_DEF #refer03@;
         |DESCARGA_DEF #refer02@;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     |PATH_DAT #refer01@#aPathFichFiscal#;

     |ABRE #refer01@;
     |LEE 040#refer01@.p;
     |SI FSalida ! 0;  |DDEFECTO #refer01@;  |FINSI;
     |CIERRA #refer01@;

     |ABRE #refer00@;
     |ABRE #refer03@;
     |ABRE #refer04@;
     |ABRE #refer05@;

     |SI #refer01@#11 = 1;
         aAlfa = aPathFichFiscal;
         |PATH_DAT #refer02@#aAlfa#;
     |SINO;
         aAlfa = eaPathBasica + "fich/";
         |PATH_DAT #refer02@#aAlfa#;
     |FINSI;

     |BUCLE eosclipr;

     |CIERRA #refer00@;
     |CIERRA #refer03@;
     |CIERRA #refer04@;
     |CIERRA #refer05@;

     |DESCARGA_DEF #refer05@;
     |DESCARGA_DEF #refer04@;
     |DESCARGA_DEF #refer03@;
     |DESCARGA_DEF #refer02@;
     |DESCARGA_DEF #refer01@;
     |DESCARGA_DEF #refer00@;
|FPRC;

\\ ---------------- Clientes desde la Aplicacion Basica

|PROCESO GrabaDesdeBasica;
     #refer06@#0 = #refer08@#63;
     #refer06@#1 = #refer08@#64;
     |LEE 040#refer06@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer06@;  |FINSI;

     |DDEFECTO #refer00@;

     #refer00@#0  = #refer08@#0;          || Codigo
     #refer00@#1  = #refer08@#2;          || Nombre
     #refer00@#2  = #refer08@#1;          || Nombre Comercial
     #refer00@#3  = #refer08@#13;         || NIF
     #refer00@#6  = #refer08@#93;         || Fecha Alta
     #refer00@#7  = #refer08@#94;         || Fecha Baja
     #refer00@#9  = #refer08@#87;         || Tipo de Empresa
     #refer00@#10 = #refer08@#88;         || Descripcion Tipo de Empresa
     #refer00@#15 = #refer08@#63;         || Codigo Delegacion
     #refer00@#16 = #refer08@#64;         || Codigo Administracion
     #refer00@#17 = #refer06@#2;          || Delegacion
     #refer00@#18 = #refer06@#3;          || Administracion

     #refer00@#19 = #refer08@#41;         || SG                  Social
     #refer00@#20 = #refer08@#42;         || Calle                 "
     #refer00@#21 = #refer08@#43;         || Numero                "
     #refer00@#22 = #refer08@#44;         || Escalera              "
     #refer00@#23 = #refer08@#45;         || Piso                  "
     #refer00@#24 = #refer08@#46;         || Puerta                "
     #refer00@#25 = #refer08@#47;         || Codigo Provincia      "
     #refer00@#26 = #refer08@#48;         || Codigo Poblacion      "
     #refer00@#27 = #refer08@#49;         || Poblacion             "
     #refer00@#28 = #refer08@#50;         || Provincia             "

     #refer00@#29 = #refer08@#3;          || SG                  Fiscal
     #refer00@#30 = #refer08@#4;          || Calle                 "
     #refer00@#31 = #refer08@#5;          || Numero                "
     #refer00@#32 = #refer08@#6;          || Escalera              "
     #refer00@#33 = #refer08@#7;          || Piso                  "
     #refer00@#34 = #refer08@#8;          || Puerta                "
     #refer00@#35 = #refer08@#9;          || Codigo Provincia      "
     #refer00@#36 = #refer08@#10;         || Codigo Poblacion      "
     #refer00@#37 = #refer08@#11;         || Poblacion             "
     #refer00@#38 = #refer08@#12;         || Provincia             "

     #refer00@#39 = #refer08@#51;         || SG                  Envio
     #refer00@#40 = #refer08@#52;         || Calle                 "
     #refer00@#41 = #refer08@#53;         || Numero                "
     #refer00@#42 = #refer08@#54;         || Escalera              "
     #refer00@#43 = #refer08@#55;         || Piso                  "
     #refer00@#44 = #refer08@#56;         || Puerta                "
     #refer00@#45 = #refer08@#57;         || Codigo Provincia      "
     #refer00@#46 = #refer08@#58;         || Codigo Poblacion      "
     #refer00@#47 = #refer08@#59;         || Poblacion             "
     #refer00@#48 = #refer08@#60;         || Provincia             "

     #refer00@#49 = #refer08@#65;         || Envio de Etiquetas
     #refer00@#53 = #refer08@#2;          || Persona de Contacto
     #refer00@#50 = #refer08@#85;
     #refer00@#51 = #refer08@#86;

     aAlfa = #refer08@#62 % 101;     || Situacion y Descripcion
     #refer00@#85  = "A";
     #refer00@#5   = "ACTIVA";
     |SI aAlfa = "I";
         #refer00@#85 = "I";
         #refer00@#5   = "INACTIVA";
     |FINSI;

     #refer00@#88  = #refer08@#79;        || Codigo Banco Cliente
     #refer00@#89  = #refer08@#80;        || Nombre Banco Cliente
     #refer00@#90  = #refer08@#81;        || Entidad
     #refer00@#91  = #refer08@#82;        || Oficina
     #refer00@#92  = #refer08@#83;        || Digito de Control
     #refer00@#93  = #refer08@#84;        || Cuenta Corriente

     #refer00@#114 = #refer08@#98;        || Codigo BIC
     #refer00@#115 = #refer08@#105;       || Pais banco
     #refer00@#116 = #refer08@#99;        || Codigo IBAN

     |SI #refer00@#93 ! "          ";  #refer00@#104 = 2;  |FINSI;  ||Forma de pago cliente

     aTPpal  = #refer08@#14;  |QBT aTPpal;
     aTOtros = #refer08@#61;  |QBT aTOtros;
     aTFax   = #refer08@#15;  |QBT aTFax;
     |HAZ GrabaTelefonos;
     |HAZ GrabaDirecciones;

     |GRABA 020#refer00@.n;
     |LIBERA #refer00@;

     nLinea = 0;
     |SI #refer08@#73 ! "01.01.0000";
         nLinea   = nLinea + 1;
         #refer07@#0   = #refer00@#0;
         #refer07@#1   = nLinea;
         #refer07@#2   = #refer08@#73;
         #refer07@#3   = #refer08@#76;
         |GRABA 020#refer07@.n;
         |LIBERA #refer07@;
     |FINSI;

     |SI #refer08@#74 ! "01.01.0000";
         nLinea   = nLinea + 1;
         #refer07@#0   = #refer00@#0;
         #refer07@#1   = nLinea;
         #refer07@#2   = #refer08@#74;
         #refer07@#3   = #refer08@#77;
         |GRABA 020#refer07@.n;
         |LIBERA #refer07@;
     |FINSI;

     |SI #refer08@#75 ! "01.01.0000";
         nLinea   = nLinea + 1;
         #refer07@#0   = #refer00@#0;
         #refer07@#1   = nLinea;
         #refer07@#2   = #refer08@#75;
         #refer07@#3   = #refer08@#78;
         |GRABA 020#refer07@.n;
         |LIBERA #refer07@;
     |FINSI;

     |ABRE #dsam0002;
     nHastaCampo = 0;
     |PARA nCampo = 39;  |SI nCampo ] 24;  |HACIENDO nCampo = nCampo - 1;
           aAlfa = #refer08@#nCampo#;  |QBF aAlfa;
           |SI aAlfa ! "";
               nHastaCampo = nCampo;
               |SAL;
           |FINSI;
     |SIGUE;

     |SI nHastaCampo ! 0;
         |PARA nCampo = 24;  |SI nCampo [ nHastaCampo;  |HACIENDO nCampo = nCampo + 1;
               #dsam0002#0 = #refer08@#0;
               #dsam0002#1 = nCampo - 23;
               |LEE 101#dsam0002.=;
               |SI FSalida ! 0;
                   #dsam0002#0 = #refer08@#0;
                   #dsam0002#1 = nCampo - 23;
                   #dsam0002#2 = #refer08@#nCampo#;
                   |GRABA 020#dsam0002.n;
               |FINSI;
               |LIBERA #dsam0002;
         |SIGUE;
     |FINSI;
     |CIERRA #dsam0002;
|FPRC;

|DEFBUCLE agifigen;
     #refer08@#1001;
     ;
     00001;
     99999;
     ;
     NULL, GrabaDesdeBasica;
|FIN;

|PROCESO DesdeBasica;
     aDef = eaPathBasica + "def/agifigen.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BUCLE agifigen;

     |DESCARGA_DEF #refer08@;
|FPRC;

\\ ---------------- Clientes desde la Aplicacion Fiscal


|PROCESO GrabaDesdeFiscal;
     nCodigoNue = 0;
     nCodigoReo = #refer08@#0;
     |BUCLE dspase15;
     |SI nCodigoNue = 0;  |ACABA;  |FINSI;

     #refer06@#0 = #refer08@#18;
     #refer06@#1 = #refer08@#19;
     |LEE 040#refer06@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer06@;  |FINSI;

     #refer00@#0 = nCodigoNue;
     |LEE 101#refer00@.=;
     |SI FSalida ! 0;
         |DDEFECTO #refer00@;
         #refer00@#0  = nCodigoNue;
         #refer00@#1  = #refer08@#2;
         #refer00@#2  = #refer08@#3;
         #refer00@#3  = #refer08@#1;
         #refer00@#4  = #refer08@#2;

         #refer00@#19 = #refer08@#4;
         #refer00@#20 = #refer08@#5;
         #refer00@#21 = #refer08@#6;
         #refer00@#22 = #refer08@#7;
         #refer00@#23 = #refer08@#8;
         #refer00@#24 = #refer08@#9;
         #refer00@#25 = #refer08@#10;
         #refer00@#26 = #refer08@#11;
         #refer00@#27 = #refer08@#13;
         #refer00@#28 = #refer08@#12;

         #refer00@#29 = #refer00@#11;
         #refer00@#30 = #refer00@#12;
         #refer00@#31 = #refer00@#13;
         #refer00@#32 = #refer00@#14;
         #refer00@#33 = #refer00@#15;
         #refer00@#34 = #refer00@#16;
         #refer00@#35 = #refer00@#17;
         #refer00@#36 = #refer00@#18;
         #refer00@#37 = #refer00@#19;
         #refer00@#38 = #refer00@#20;

         #refer00@#39 = "";
         #refer00@#40 = #refer08@#52;
         #refer00@#41 = #refer08@#53;
         #refer00@#42 = "";
         #refer00@#43 = #refer08@#54;
         #refer00@#44 = "";
         #refer00@#45 = #refer08@#55;
         #refer00@#46 = #refer08@#56;
         #refer00@#47 = #refer08@#58;
         #refer00@#48 = #refer08@#57;

         #refer00@#49 = #refer08@#64;

         aTPpal  = #refer08@#14;   |QBT aTPpal;
         aTOtros = "";        |QBT aTOtros;
         aTFax   = #refer08@#15;   |QBT aTFax;
         |HAZ GrabaTelefonos;
         |HAZ GrabaDirecciones;

         |GRABA 020#refer00@.b;
     |SINO;
         |SI #dspase01#2 = "2";
             aTPpal  = #refer08@#14;   |QBT aTPpal;
             aTOtros = "";        |QBT aTOtros;
             aTFax   = #refer08@#15;   |QBT aTFax;
             |HAZ GrabaTelefonos;
         |FINSI;
     |FINSI;

     #refer00@#56  = #refer08@#20;
     #refer00@#15  = #refer08@#18;
     #refer00@#16  = #refer08@#19;
     #refer00@#17  = #refer06@#2;
     #refer00@#18  = #refer06@#3;
     #refer00@#12  = #refer08@#51;
     #refer00@#57  = #refer08@#61;
     #refer00@#58  = #refer08@#62;
     #refer00@#59  = #refer08@#17;
     #refer00@#60  = #refer08@#60;
     #refer00@#61  = #refer08@#65;
     #refer00@#62  = #refer08@#66;
     #refer00@#63  = #refer08@#67;
     #refer00@#64  = #refer08@#68;
     #refer00@#66  = "S";

     #refer09@#0   = #refer08@#0;
     |LEE 040#refer09@.=;
     |SI FSalida = 0;
         #refer00@#104 = 2;

         #refer00@#89  = #refer09@#01;        || Nombre Banco Cliente
         #refer00@#90  = #refer09@#02;        || Entidad
         #refer00@#91  = #refer09@#03;        || Oficina
         #refer00@#92  = #refer09@#04;        || Digito de Control
         #refer00@#93  = #refer09@#05;        || Cuenta Corriente

         #refer00@#114 = #refer09@#06;        || Codigo BIC
         #refer00@#115 = #refer09@#13;        || Pais banco
         #refer00@#116 = #refer09@#07;        || Codigo IBAN
     |FINSI;

     #refer10@#0   = #refer08@#0;
     |LEE 040#refer10@.=;
     |SI FSalida = 0;
         #refer00@#57 = #refer10@#2;
     |FINSI;

     |GRABA 020#refer00@.a;
     |LIBERA #refer00@;
|FPRC;

|DEFBUCLE eosclien;
     #refer08@#1001;
     ;
     00001;
     99999;
     ;
     NULL, GrabaDesdeFiscal;
|FIN;

|PROCESO DesdeFiscal;
     aDef = aPathDefFiscal + "eosclien.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = aPathDefFiscal + "eosdaban.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = aPathDefFiscal + "eosm0050.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     |PATH_DAT #refer08@#aPathFichFiscal#;
     |PATH_DAT #refer09@#aPathFichFiscal#;
     |PATH_DAT #refer10@#aPathFichFiscal#;

     |ABRE #refer10@;
     |ABRE #refer09@;
     |BUCLE eosclien;
     |CIERRA #refer09@;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

\\ ---------------- Clientes desde la Aplicacion Renta 1994 a 1998

|PROCESO GrabaDesdeRentaAntes;
     #refer09@#0 = #refer08@#0;
     |LEE 040#refer09@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer09@;  |FINSI;

     #refer00@#0 = #refer08@#0;
     |LEE 101#refer00@.=;
     |SI FSalida ! 0;
         |DDEFECTO #refer00@;
         #refer00@#0   = #refer08@#0;
         #refer00@#1   = #refer08@#1;
         #refer00@#2   = #refer08@#1;
         #refer00@#3   = #refer08@#2;
         #refer00@#54  = #refer09@#15;
         #refer00@#55  = #refer09@#15;

         #refer00@#19  = #refer09@#6;
         #refer00@#20  = #refer09@#7;
         #refer00@#21  = #refer09@#8;
         #refer00@#22  = #refer09@#9;
         #refer00@#23  = #refer09@#10;
         #refer00@#24  = #refer09@#11;
         #refer00@#25  = #refer09@#12;
         #refer00@#26  = #refer09@#13;
         #refer00@#27  = #refer09@#14;

         #dsam0100#0   = #refer00@#25;
         |LEE 040#dsam0100.=;
         |SI FSalida ! 0;  |DDEFECTO #dsam0100;  |FINSI;

         #refer00@#28  = #dsam0100#1;

         #refer00@#29  = #refer00@#19;
         #refer00@#30  = #refer00@#20;
         #refer00@#31  = #refer00@#21;
         #refer00@#32  = #refer00@#22;
         #refer00@#33  = #refer00@#23;
         #refer00@#34  = #refer00@#24;
         #refer00@#35  = #refer00@#25;
         #refer00@#36  = #refer00@#26;
         #refer00@#37  = #refer00@#27;
         #refer00@#38  = #refer00@#28;

         #refer00@#39  = #refer09@#17;
         #refer00@#40  = #refer09@#18;
         #refer00@#41  = #refer09@#19;
         #refer00@#42  = #refer09@#20;
         #refer00@#43  = #refer09@#21;
         #refer00@#44  = #refer09@#22;
         #refer00@#45  = #refer09@#23;
         #refer00@#46  = #refer09@#24;
         #refer00@#47  = #refer09@#25;

         #dsam0100#0   = #refer00@#45;
         |LEE 040#dsam0100.=;
         |SI FSalida ! 0;  |DDEFECTO #dsam0100;  |FINSI;

         #refer00@#48  = #dsam0100#1;

         #refer00@#15  = #refer09@#40;
         #refer00@#16  = #refer09@#41;
         #refer00@#17  = #refer09@#17;
         #refer00@#18  = #refer09@#18;
         #refer00@#53  = #refer00@#1;

         |SI nRenta ! 1994;
             #refer00@#49  = #refer09@#208;
             #refer00@#100 = #refer09@#210;
             #refer00@#101 = #refer09@#211;
             #refer00@#102 = #refer09@#212;
         |FINSI;

         aAlfa = #refer09@#174 % 104;   #refer00@#90  = aAlfa;
         aAlfa = #refer09@#174 % 504;   #refer00@#91  = aAlfa;
         aAlfa = #refer09@#174 % 902;   #refer00@#92  = aAlfa;
         aAlfa = #refer09@#174 % 1110;  #refer00@#93  = aAlfa;

         |SI #refer00@#93 ! "          ";  #refer00@#104 = 2;  |FINSI;  ||Forma de pago cliente

         aTPpal   = #refer00@#54;   |QBT aTPpal;
         aTOtros  = #refer00@#55;   |QBT aTOtros;
         aTFax   = "";        |QBT aTFax;
         |HAZ GrabaTelefonos;
         |HAZ GrabaDirecciones;

         |GRABA 020#refer00@.b;
     |SINO;
         |SI #dspase01#2 = "3";
             #refer00@#54  = #refer09@#15;
             #refer00@#55  = #refer09@#15;

             aTPpal   = #refer00@#54;   |QBT aTPpal;
             aTOtros  = #refer00@#55;   |QBT aTOtros;
             aTFax   = "";         |QBT aTFax;
             |HAZ GrabaTelefonos;
         |FINSI;
     |FINSI;

     #refer00@#68  = "S";

     |GRABA 020#refer00@.a;
     |LIBERA #refer00@;
|FPRC;

|DEFBUCLE reacceso;
     #refer08@#1001;
     ;
     00001;
     99999;
     ;
     NULL, GrabaDesdeRentaAntes;
|FIN;

|PROCESO DesdeRentaAnteriores;
     |SI nAnyo = 1998;  aDef  = eaPathRen1998 + "def/reacceso.mas";  |FINSI;
     |SI nAnyo = 1997;  aDef  = eaPathRen1997 + "def/reacceso.mas";  |FINSI;
     |SI nAnyo = 1996;  aDef  = eaPathRen1996 + "def/reacceso.mas";  |FINSI;
     |SI nAnyo = 1995;  aDef  = eaPathRen1995 + "def/reacceso.mas";  |FINSI;
     |SI nAnyo = 1994;  aDef  = eaPathRen1994 + "def/reacceso.mas";  |FINSI;

     |SI nAnyo = 1998;  aFich = eaPathRen1998 + "fich/";             |FINSI;
     |SI nAnyo = 1997;  aFich = eaPathRen1997 + "fich/";             |FINSI;
     |SI nAnyo = 1996;  aFich = eaPathRen1996 + "fich/";             |FINSI;
     |SI nAnyo = 1995;  aFich = eaPathRen1995 + "fich/";             |FINSI;
     |SI nAnyo = 1994;  aFich = eaPathRen1994 + "fich/";             |FINSI;

     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI nAnyo = 1998;  aDef  = eaPathRen1998 + "def/redatcon.mas";  |FINSI;
     |SI nAnyo = 1997;  aDef  = eaPathRen1997 + "def/redatcon.mas";  |FINSI;
     |SI nAnyo = 1996;  aDef  = eaPathRen1996 + "def/redatcon.mas";  |FINSI;
     |SI nAnyo = 1995;  aDef  = eaPathRen1995 + "def/redatcon.mas";  |FINSI;
     |SI nAnyo = 1994;  aDef  = eaPathRen1994 + "def/redatcon.mas";  |FINSI;

     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PATH_DAT #refer08@#aFich#;
     |PATH_DAT #refer09@#aFich#;

     |ABRE #refer09@;
     |ABRE #dsam0100;
     |BUCLE reacceso;
     |CIERRA #dsam0100;
     |CIERRA #refer09@;

     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

\\ ---------------- Clientes desde la Aplicacion Renta 1999 y 2000

|PROCESO GrabaDesdeRenta991;
     #refer10@#0 = #refer08@#20;
     |LEE 040#refer10@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer10@;  |FINSI;

     #refer11@#0 = #refer08@#11;
     |LEE 040#refer11@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer11@;  |FINSI;

     #refer09@#0 = #refer08@#0;
     |LEE 040#refer09@.=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     |DDEFECTO #refer09@;
     |PARA nCampo = 0;  |SI nCampo [ 60;  |HACIENDO nCampo = nCampo + 1;
           #refer09@#nCampo# = #refer08@#nCampo#;
     |SIGUE;

     #refer09@#61 = #refer08@#88;
     #refer09@#62 = #refer08@#89;
     #refer09@#63 = #refer08@#93;
     #refer09@#64 = #refer08@#94;
     #refer09@#65 = #refer08@#95;

     |SI nRenta ] 2002;
         #refer09@#67 = #refer08@#103;
         #refer09@#68 = #refer08@#104;
         #refer09@#69 = #refer08@#105;
         #refer09@#70 = #refer08@#106;
     |FINSI;

     |SI nRenta ] 2006;
         |PARA nCampoD = 71;  |SI nCampoD [ 106;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH   = nCampoD + 38;
               #refer09@#nCampoD# = #refer08@#nCampoH#;
         |SIGUE;
     |FINSI;

     |GRABA 020#refer09@.n;
     |LIBERA #refer09@;

     #refer00@#0 = #refer09@#0;
     |LEE 101#refer00@.=;
     |SI FSalida ! 0;
         |DDEFECTO #refer00@;
         #refer00@#0   = #refer09@#0;
         #refer00@#1   = #refer09@#5;
         #refer00@#2   = #refer09@#5;
         #refer00@#3   = #refer09@#1;
         #refer00@#54  = #refer09@#12;
         #refer00@#55  = #refer09@#13;
         #refer00@#19  = #refer09@#14;
         #refer00@#20  = #refer09@#15;
         #refer00@#21  = #refer09@#16;
         #refer00@#22  = #refer09@#17;
         #refer00@#23  = #refer09@#18;
         #refer00@#24  = #refer09@#19;
         #refer00@#25  = #refer09@#20;
         #refer00@#26  = #refer09@#21;
         #refer00@#27  = #refer09@#22;
         #refer00@#28  = #refer10@#1;
         #refer00@#29  = #refer09@#14;
         #refer00@#30  = #refer09@#15;
         #refer00@#31  = #refer09@#16;
         #refer00@#32  = #refer09@#17;
         #refer00@#33  = #refer09@#18;
         #refer00@#34  = #refer09@#19;
         #refer00@#35  = #refer09@#20;
         #refer00@#36  = #refer09@#21;
         #refer00@#37  = #refer09@#22;
         #refer00@#38  = #refer10@#1;
         #refer00@#39  = #refer09@#24;
         #refer00@#40  = #refer09@#25;
         #refer00@#41  = #refer09@#26;
         #refer00@#42  = #refer09@#27;
         #refer00@#43  = #refer09@#28;
         #refer00@#44  = #refer09@#29;
         #refer00@#45  = #refer09@#30;
         #refer00@#46  = #refer09@#31;
         #refer00@#47  = #refer09@#32;
         #refer00@#48  = #refer10@#1;
         #refer00@#49  = #refer09@#34;
         #refer00@#15  = #refer08@#69;
         #refer00@#16  = #refer08@#70;
         #refer00@#17  = #refer08@#71;
         #refer00@#18  = #refer08@#72;
         #refer00@#53  = #refer00@#1;

         aTPpal  = #refer00@#54;   |QBT aTPpal;
         aTOtros = #refer00@#55;   |QBT aTOtros;
         aTFax   = "";        |QBT aTFax;
         |HAZ GrabaTelefonos;
         |HAZ GrabaDirecciones;

         |GRABA 020#refer00@.b;
     |SINO;
         |SI #dspase01#2 = "3";
             #refer00@#54  = #refer09@#12;
             #refer00@#55  = #refer09@#13;

             aTPpal  = #refer00@#54;   |QBT aTPpal;
             aTOtros = #refer00@#55;   |QBT aTOtros;
             aTFax   = "";        |QBT aTFax;
             |HAZ GrabaTelefonos;
        |FINSI;
     |FINSI;

     #refer00@#100 = #refer09@#2;
     #refer00@#101 = #refer09@#3;
     #refer00@#102 = #refer09@#4;
     #refer00@#86  = #refer09@#11;
     #refer00@#87  = #refer11@#1;
     |SI #refer00@#90 = "    ";
         aAlfa = #refer09@#53 % 104;   #refer00@#90  = aAlfa;
         aAlfa = #refer09@#53 % 504;   #refer00@#91  = aAlfa;
         aAlfa = #refer09@#53 % 902;   #refer00@#92  = aAlfa;
         aAlfa = #refer09@#53 % 1110;  #refer00@#93  = aAlfa;
         |SI #refer00@#93 ! "          ";  #refer00@#104 = 2;  |FINSI;  ||Forma de pago cliente
     |FINSI;
     #refer00@#68  = "S";

     |GRABA 020#refer00@.a;
     |LIBERA #refer00@;
|FPRC;

|DEFBUCLE rem00100;
     #refer08@#1001;
     ;
     00001;
     99999;
     ;
     NULL, GrabaDesdeRenta991;
|FIN;

|PROCESO GrabaDesdeRenta992;
     #refer10@#0 = #refer08@#0;
     |LEE 040#refer10@.=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ 15;  |HACIENDO nCampo = nCampo + 1;
           #refer09@#nCampo# = #refer08@#nCampo#;
     |SIGUE;

     |SI nRenta ] 2002;
         #refer09@#16 = #refer08@#17;
         #refer09@#17 = #refer08@#18;
         #refer09@#18 = #refer08@#19;
         #refer09@#19 = #refer08@#20;
         |SI nRenta ] 2003;
             #refer09@#20 = #refer08@#21;
         |FINSI;
         |SI nRenta ] 2004;
             #refer09@#21 = #refer08@#22;
         |FINSI;
     |FINSI;

     |GRABA 020#refer09@.n;
     |LIBERA #refer09@;
|FPRC;

|DEFBUCLE rem00101;
     #refer08@#1002;
     ;
     00001, 00;
     99999, 99;
     ;
     NULL, GrabaDesdeRenta992;
|FIN;

|PROCESO DesdeRenta1999;
     nRenta = 1999;

     aDef = eaPathRen1999 + "def/rem00101.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0004.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |BUCLE rem00101;
     |CIERRA #refer10@;
     |CIERRA #refer09@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;

     aDef = eaPathRen1999 + "def/rem00100.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0100.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0104.mas";
     |CARGA_DEF aDef, refer11@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer10@;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aAlfa = eaPathRen1999 + "fich/";
     |PATH_DAT #refer08@#aAlfa#;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |ABRE #refer11@;
     |BUCLE rem00100;
     |CIERRA #refer09@;
     |CIERRA #refer10@;
     |CIERRA #refer11@;

     |DESCARGA_DEF #refer11@;
     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO DesdeRenta2000;
     nRenta = 2000;

     aDef = eaPathRen2000 + "def/rem00101.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0004.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     |ABRE #refer09@;  |CIERRA #refer09@;  |DELINDEX #refer09@;
     |ABRE #refer10@;  |CIERRA #refer10@;  |DELINDEX #refer10@;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |BUCLE rem00101;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;

     aDef = eaPathRen2000 + "def/rem00100.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0100.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0104.mas";
     |CARGA_DEF aDef, refer11@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer10@;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aAlfa = eaPathRen2000 + "fich/";
     |PATH_DAT #refer08@#aAlfa#;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |ABRE #refer11@;
     |BUCLE rem00100;
     |CIERRA #refer09@;
     |CIERRA #refer10@;
     |CIERRA #refer11@;

     |DESCARGA_DEF #refer11@;
     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO DesdeRenta2001;
     nRenta = 2001;

     aDef = eaPathRen2001 + "def/rem00101.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0004.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     |ABRE #refer09@;  |CIERRA #refer09@;  |DELINDEX #refer09@;
     |ABRE #refer10@;  |CIERRA #refer10@;  |DELINDEX #refer10@;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |BUCLE rem00101;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;

     aDef = eaPathRen2001 + "def/rem00100.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0100.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0104.mas";
     |CARGA_DEF aDef, refer11@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer10@;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aAlfa = eaPathRen2001 + "fich/";
     |PATH_DAT #refer08@#aAlfa#;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |ABRE #refer11@;
     |BUCLE rem00100;
     |CIERRA #refer09@;
     |CIERRA #refer10@;
     |CIERRA #refer11@;

     |DESCARGA_DEF #refer11@;
     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO DesdeRenta2002;
     nRenta = 2002;

     aDef = eaPathRen2002 + "def/rem00101.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0004.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     |ABRE #refer09@;  |CIERRA #refer09@;  |DELINDEX #refer09@;
     |ABRE #refer10@;  |CIERRA #refer10@;  |DELINDEX #refer10@;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |BUCLE rem00101;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;

     aDef = eaPathRen2002 + "def/rem00100.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0100.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0104.mas";
     |CARGA_DEF aDef, refer11@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer10@;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aAlfa = eaPathRen2002 + "fich/";
     |PATH_DAT #refer08@#aAlfa#;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |ABRE #refer11@;
     |BUCLE rem00100;
     |CIERRA #refer09@;
     |CIERRA #refer10@;
     |CIERRA #refer11@;

     |DESCARGA_DEF #refer11@;
     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO DesdeRenta2003;
     nRenta = 2003;

     aDef = eaPathRen2003 + "def/rem00101.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0004.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     |ABRE #refer09@;  |CIERRA #refer09@;  |DELINDEX #refer09@;
     |ABRE #refer10@;  |CIERRA #refer10@;  |DELINDEX #refer10@;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |BUCLE rem00101;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;

     aDef = eaPathRen2003 + "def/rem00100.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0100.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0104.mas";
     |CARGA_DEF aDef, refer11@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer10@;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aAlfa = eaPathRen2003 + "fich/";
     |PATH_DAT #refer08@#aAlfa#;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |ABRE #refer11@;
     |BUCLE rem00100;
     |CIERRA #refer09@;
     |CIERRA #refer10@;
     |CIERRA #refer11@;

     |DESCARGA_DEF #refer11@;
     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO DesdeRenta2004;
     nRenta = 2004;

     aDef = eaPathRen2004 + "def/rem00101.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0004.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     |ABRE #refer09@;  |CIERRA #refer09@;  |DELINDEX #refer09@;
     |ABRE #refer10@;  |CIERRA #refer10@;  |DELINDEX #refer10@;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |BUCLE rem00101;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;

     aDef       = eaPathRen2004 + "def/rem00100.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0100.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0104.mas";
     |CARGA_DEF aDef, refer11@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer10@;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aAlfa = eaPathRen2004 + "fich/";
     |PATH_DAT #refer08@#aAlfa#;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |ABRE #refer11@;
     |BUCLE rem00100;
     |CIERRA #refer09@;
     |CIERRA #refer10@;
     |CIERRA #refer11@;

     |DESCARGA_DEF #refer11@;
     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO DesdeRenta2005;
     nRenta = 2005;

     aDef = eaPathRen2005 + "def/rem00101.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0004.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     |ABRE #refer09@;  |CIERRA #refer09@;  |DELINDEX #refer09@;
     |ABRE #refer10@;  |CIERRA #refer10@;  |DELINDEX #refer10@;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |BUCLE rem00101;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;

     aDef       = eaPathRen2005 + "def/rem00100.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0100.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0104.mas";
     |CARGA_DEF aDef, refer11@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer10@;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aAlfa = eaPathRen2005 + "fich/";
     |PATH_DAT #refer08@#aAlfa#;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |ABRE #refer11@;
     |BUCLE rem00100;
     |CIERRA #refer09@;
     |CIERRA #refer10@;
     |CIERRA #refer11@;

     |DESCARGA_DEF #refer11@;
     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO DesdeRenta2006;
     nRenta = 2006;

     aDef = eaPathRen2006 + "def/rem00101.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0004.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     |ABRE #refer09@;  |CIERRA #refer09@;  |DELINDEX #refer09@;
     |ABRE #refer10@;  |CIERRA #refer10@;  |DELINDEX #refer10@;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |BUCLE rem00101;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;

     aDef       = eaPathRen2006 + "def/rem00100.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0100.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0104.mas";
     |CARGA_DEF aDef, refer11@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer10@;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aAlfa = eaPathRen2006 + "fich/";
     |PATH_DAT #refer08@#aAlfa#;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |ABRE #refer11@;
     |BUCLE rem00100;
     |CIERRA #refer09@;
     |CIERRA #refer10@;
     |CIERRA #refer11@;

     |DESCARGA_DEF #refer11@;
     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO DesdeRenta2007;
     nRenta = 2007;

     aDef = eaPathRen2007 + "def/rem00101.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0004.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     |ABRE #refer09@;  |CIERRA #refer09@;  |DELINDEX #refer09@;
     |ABRE #refer10@;  |CIERRA #refer10@;  |DELINDEX #refer10@;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |BUCLE rem00101;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;

     aDef       = eaPathRen2007 + "def/rem00100.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0100.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0104.mas";
     |CARGA_DEF aDef, refer11@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer10@;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aAlfa = eaPathRen2007 + "fich/";
     |PATH_DAT #refer08@#aAlfa#;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |ABRE #refer11@;
     |BUCLE rem00100;
     |CIERRA #refer09@;
     |CIERRA #refer10@;
     |CIERRA #refer11@;

     |DESCARGA_DEF #refer11@;
     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO DesdeRenta2008;
     nRenta = 2008;

     aDef = eaPathRen2008 + "def/rem00101.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0004.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     |ABRE #refer09@;  |CIERRA #refer09@;  |DELINDEX #refer09@;
     |ABRE #refer10@;  |CIERRA #refer10@;  |DELINDEX #refer10@;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |BUCLE rem00101;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;

     aDef       = eaPathRen2008 + "def/rem00100.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0100.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0104.mas";
     |CARGA_DEF aDef, refer11@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer10@;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aAlfa = eaPathRen2008 + "fich/";
     |PATH_DAT #refer08@#aAlfa#;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |ABRE #refer11@;
     |BUCLE rem00100;
     |CIERRA #refer09@;
     |CIERRA #refer10@;
     |CIERRA #refer11@;

     |DESCARGA_DEF #refer11@;
     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO DesdeRenta2009;
     nRenta = 2009;

     aDef = eaPathRen2009 + "def/rem00101.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0004.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     |ABRE #refer09@;  |CIERRA #refer09@;  |DELINDEX #refer09@;
     |ABRE #refer10@;  |CIERRA #refer10@;  |DELINDEX #refer10@;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |BUCLE rem00101;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;

     aDef       = eaPathRen2009 + "def/rem00100.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0100.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0104.mas";
     |CARGA_DEF aDef, refer11@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer10@;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aAlfa = eaPathRen2009 + "fich/";
     |PATH_DAT #refer08@#aAlfa#;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |ABRE #refer11@;
     |BUCLE rem00100;
     |CIERRA #refer09@;
     |CIERRA #refer10@;
     |CIERRA #refer11@;

     |DESCARGA_DEF #refer11@;
     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO DesdeRenta2010;
     nRenta = 2010;

     aDef = eaPathRen2010 + "def/rem00101.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0004.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     |ABRE #refer09@;  |CIERRA #refer09@;  |DELINDEX #refer09@;
     |ABRE #refer10@;  |CIERRA #refer10@;  |DELINDEX #refer10@;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |BUCLE rem00101;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;

     aDef       = eaPathRen2010 + "def/rem00100.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0100.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0104.mas";
     |CARGA_DEF aDef, refer11@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer10@;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aAlfa = eaPathRen2010 + "fich/";
     |PATH_DAT #refer08@#aAlfa#;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |ABRE #refer11@;
     |BUCLE rem00100;
     |CIERRA #refer09@;
     |CIERRA #refer10@;
     |CIERRA #refer11@;

     |DESCARGA_DEF #refer11@;
     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO DesdeRenta2011;
     nRenta = 2011;

     aDef = eaPathRen2011 + "def/rem00101.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0004.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     |ABRE #refer09@;  |CIERRA #refer09@;  |DELINDEX #refer09@;
     |ABRE #refer10@;  |CIERRA #refer10@;  |DELINDEX #refer10@;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |BUCLE rem00101;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;

     aDef       = eaPathRen2011 + "def/rem00100.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0100.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0104.mas";
     |CARGA_DEF aDef, refer11@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer10@;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aAlfa = eaPathRen2011 + "fich/";
     |PATH_DAT #refer08@#aAlfa#;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |ABRE #refer11@;
     |BUCLE rem00100;
     |CIERRA #refer09@;
     |CIERRA #refer10@;
     |CIERRA #refer11@;

     |DESCARGA_DEF #refer11@;
     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO DesdeRenta2012;
     nRenta = 2012;

     aDef = eaPathRen2012 + "def/rem00101.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0004.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     |ABRE #refer09@;  |CIERRA #refer09@;  |DELINDEX #refer09@;
     |ABRE #refer10@;  |CIERRA #refer10@;  |DELINDEX #refer10@;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |BUCLE rem00101;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;

     aDef       = eaPathRen2012 + "def/rem00100.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0100.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0104.mas";
     |CARGA_DEF aDef, refer11@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer10@;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aAlfa = eaPathRen2012 + "fich/";
     |PATH_DAT #refer08@#aAlfa#;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |ABRE #refer11@;
     |BUCLE rem00100;
     |CIERRA #refer09@;
     |CIERRA #refer10@;
     |CIERRA #refer11@;

     |DESCARGA_DEF #refer11@;
     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO DesdeRenta2013;
     nRenta = 2013;

     aDef = eaPathRen2013 + "def/rem00101.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0004.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     |ABRE #refer09@;  |CIERRA #refer09@;  |DELINDEX #refer09@;
     |ABRE #refer10@;  |CIERRA #refer10@;  |DELINDEX #refer10@;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |BUCLE rem00101;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;

     aDef       = eaPathRen2013 + "def/rem00100.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0100.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0104.mas";
     |CARGA_DEF aDef, refer11@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer10@;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aAlfa = eaPathRen2013 + "fich/";
     |PATH_DAT #refer08@#aAlfa#;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |ABRE #refer11@;
     |BUCLE rem00100;
     |CIERRA #refer09@;
     |CIERRA #refer10@;
     |CIERRA #refer11@;

     |DESCARGA_DEF #refer11@;
     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO DesdeRenta2014;
     nRenta = 2014;

     aDef = eaPathRen2014 + "def/rem00101.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0004.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     |ABRE #refer09@;  |CIERRA #refer09@;  |DELINDEX #refer09@;
     |ABRE #refer10@;  |CIERRA #refer10@;  |DELINDEX #refer10@;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |BUCLE rem00101;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;

     aDef       = eaPathRen2014 + "def/rem00100.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0100.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0104.mas";
     |CARGA_DEF aDef, refer11@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer10@;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aAlfa = eaPathRen2014 + "fich/";
     |PATH_DAT #refer08@#aAlfa#;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |ABRE #refer11@;
     |BUCLE rem00100;
     |CIERRA #refer09@;
     |CIERRA #refer10@;
     |CIERRA #refer11@;

     |DESCARGA_DEF #refer11@;
     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO DesdeRenta2015;
     nRenta = 2015;

     aDef = eaPathRen2015 + "def/rem00101.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0004.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     |ABRE #refer09@;  |CIERRA #refer09@;  |DELINDEX #refer09@;
     |ABRE #refer10@;  |CIERRA #refer10@;  |DELINDEX #refer10@;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |BUCLE rem00101;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;

     aDef       = eaPathRen2015 + "def/rem00100.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0100.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0104.mas";
     |CARGA_DEF aDef, refer11@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer10@;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aAlfa = eaPathRen2015 + "fich/";
     |PATH_DAT #refer08@#aAlfa#;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |ABRE #refer11@;
     |BUCLE rem00100;
     |CIERRA #refer09@;
     |CIERRA #refer10@;
     |CIERRA #refer11@;

     |DESCARGA_DEF #refer11@;
     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO DesdeRenta2016;
     nRenta = 2016;

     aDef = eaPathRen2016 + "def/rem00101.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0004.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     |ABRE #refer09@;  |CIERRA #refer09@;  |DELINDEX #refer09@;
     |ABRE #refer10@;  |CIERRA #refer10@;  |DELINDEX #refer10@;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |BUCLE rem00101;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;

     aDef       = eaPathRen2016 + "def/rem00100.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0100.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0104.mas";
     |CARGA_DEF aDef, refer11@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer10@;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aAlfa = eaPathRen2016 + "fich/";
     |PATH_DAT #refer08@#aAlfa#;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |ABRE #refer11@;
     |BUCLE rem00100;
     |CIERRA #refer09@;
     |CIERRA #refer10@;
     |CIERRA #refer11@;

     |DESCARGA_DEF #refer11@;
     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO DesdeRenta2017;
     nRenta = 2017;

     aDef = eaPathRen2017 + "def/rem00101.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0004.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     |ABRE #refer09@;  |CIERRA #refer09@;  |DELINDEX #refer09@;
     |ABRE #refer10@;  |CIERRA #refer10@;  |DELINDEX #refer10@;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |BUCLE rem00101;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;

     aDef       = eaPathRen2017 + "def/rem00100.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0100.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0104.mas";
     |CARGA_DEF aDef, refer11@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer10@;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aAlfa = eaPathRen2017 + "fich/";
     |PATH_DAT #refer08@#aAlfa#;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |ABRE #refer11@;
     |BUCLE rem00100;
     |CIERRA #refer09@;
     |CIERRA #refer10@;
     |CIERRA #refer11@;

     |DESCARGA_DEF #refer11@;
     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO DesdeRenta2018;
     nRenta = 2018;

     aDef = eaPathRen2018 + "def/rem00101.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0004.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     |ABRE #refer09@;  |CIERRA #refer09@;  |DELINDEX #refer09@;
     |ABRE #refer10@;  |CIERRA #refer10@;  |DELINDEX #refer10@;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |BUCLE rem00101;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;

     aDef       = eaPathRen2018 + "def/rem00100.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0003.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0100.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0104.mas";
     |CARGA_DEF aDef, refer11@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer10@;
         |DESCARGA_DEF #refer09@;
         |DESCARGA_DEF #refer08@;
         |ACABA;
     |FINSI;

     aAlfa = eaPathRen2018 + "fich/";
     |PATH_DAT #refer08@#aAlfa#;

     |ABRE #refer09@;
     |ABRE #refer10@;
     |ABRE #refer11@;
     |BUCLE rem00100;
     |CIERRA #refer09@;
     |CIERRA #refer10@;
     |CIERRA #refer11@;

     |DESCARGA_DEF #refer11@;
     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

\\ ---------------- Clientes desde la Aplicacion Contagen

|PROCESO GrabaDesdeContagen;
     #refer00@#0 = #refer08@#2;
     |LEE 101#refer00@.=;
     |SI FSalida ! 0;
         |DDEFECTO #refer00@;
         #refer00@#0  = #refer08@#2;
         #refer00@#1  = #refer08@#1;
         #refer00@#2  = #refer08@#4;
         #refer00@#3  = #refer08@#8;
         #refer00@#4  = #refer08@#1;
         #refer00@#20 = #refer08@#5;
         aAlfa   = #refer08@#6 % 102;  #refer00@#25 = aAlfa;
         aAlfa   = #refer08@#6 % 303;  #refer00@#26 = aAlfa;
         #refer00@#27 = #refer08@#7;
         #refer00@#29 = #refer00@#19;
         #refer00@#30 = #refer00@#20;
         #refer00@#31 = #refer00@#21;
         #refer00@#32 = #refer00@#22;
         #refer00@#33 = #refer00@#23;
         #refer00@#34 = #refer00@#24;
         #refer00@#35 = #refer00@#25;
         #refer00@#36 = #refer00@#26;
         #refer00@#37 = #refer00@#27;
         #refer00@#38 = #refer00@#28;
         #refer00@#39 = #refer00@#19;
         #refer00@#40 = #refer00@#20;
         #refer00@#41 = #refer00@#21;
         #refer00@#42 = #refer00@#22;
         #refer00@#43 = #refer00@#23;
         #refer00@#44 = #refer00@#24;
         #refer00@#45 = #refer00@#25;
         #refer00@#46 = #refer00@#26;
         #refer00@#47 = #refer00@#27;
         #refer00@#48 = #refer00@#28;

         |HAZ GrabaDirecciones;
         |GRABA 020#refer00@.b;
     |FINSI;

     #refer00@#56  = #refer08@#26;
     #refer00@#65  = "S";

     |GRABA 020#refer00@.a;
     |LIBERA #refer00@;
|FPRC;

|DEFBUCLE canempre;
     #refer08@#1002;
     ;
     00000, 0;
     99999, 9;
     ;
     NULL, GrabaDesdeContagen;
|FIN;

|PROCESO DesdeContagen;
     aDef = eaPathContagen + "def/canempre.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BUCLE canempre;

     |DESCARGA_DEF #refer08@;
|FPRC;

\\ ---------------- Clientes desde la Aplicacion Contasoc

|PROCESO GrabaBancoSociedad;
     #dspase85#0 = #refer09@#2;
     #dspase85#1 = #refer09@#3;
     |LEE 101#dspase85.=;
     |SI FSalida ! 0;
         |DDEFECTO #dspase85;
         #dspase85#0 = #refer09@#2;
         #dspase85#1 = #refer09@#3;
         |GRABA 020#dspase85.b;
     |FINSI;

     |GRABA 020#dspase85.a;
     |LIBERA #dspase85;

     #dsam0009#0 = #refer09@#0;
     #dsam0009#1 = 200;
     |LEE 101#dsam0009.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsam0009;
         #dsam0009#0 = #refer09@#0;
         #dsam0009#1 = 200;
         |GRABA 020#dsam0009.b;
     |FINSI;

     #dsam0009#2  = "BANCO PARA MODELO 200";
     #dsam0009#3  = #dspase85#6;
     #dsam0009#4  = #dspase85#2;
     #dsam0009#5  = #refer09@#2;
     #dsam0009#6  = #refer09@#3;
     #dsam0009#7  = #refer09@#4;
     #dsam0009#8  = #refer09@#5;
     #dsam0009#12 = #refer09@#7;
     #dsam0009#18 = #refer09@#6;

                                 #dsam0009#9 = 1;
     |SI #dsam0009#8 ! "          ";  #dsam0009#9 = 2;  |FINSI;

     |GRABA 020#dsam0009.a;
     |LIBERA #dsam0009;

     #dsam0009#0 = #refer09@#0;
     #dsam0009#1 = 201;
     |LEE 101#dsam0009.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsam0009;
         #dsam0009#0 = #refer09@#0;
         #dsam0009#1 = 201;
         |GRABA 020#dsam0009.b;
     |FINSI;

     #dsam0009#2  = "BANCO PARA MODELO 201";
     #dsam0009#3  = #dspase85#6;
     #dsam0009#4  = #dspase85#2;
     #dsam0009#5  = #refer09@#2;
     #dsam0009#6  = #refer09@#3;
     #dsam0009#7  = #refer09@#4;
     #dsam0009#8  = #refer09@#5;
     #dsam0009#12 = #refer09@#7;
     #dsam0009#18 = #refer09@#6;

                                 #dsam0009#9 = 1;
     |SI #dsam0009#8 ! "          ";  #dsam0009#9 = 2;  |FINSI;

     |GRABA 020#dsam0009.a;
     |LIBERA #dsam0009;

     #dsam0009#0 = #refer09@#0;
     #dsam0009#1 = 202;
     |LEE 101#dsam0009.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsam0009;
         #dsam0009#0 = #refer09@#0;
         #dsam0009#1 = 202;
         |GRABA 020#dsam0009.b;
     |FINSI;

     #dsam0009#2  = "BANCO PARA MODELO 202";
     #dsam0009#3  = #dspase85#6;
     #dsam0009#4  = #dspase85#2;
     #dsam0009#5  = #refer09@#2;
     #dsam0009#6  = #refer09@#3;
     #dsam0009#7  = #refer09@#4;
     #dsam0009#8  = #refer09@#5;
     #dsam0009#12 = #refer09@#7;
     #dsam0009#18 = #refer09@#6;

                                 #dsam0009#9 = 1;
     |SI #dsam0009#8 ! "          ";  #dsam0009#9 = 2;  |FINSI;

     |GRABA 020#dsam0009.a;
|FPRC;

|PROCESO GrabaDesdeContasoc;
     #refer00@#0 = #refer08@#0;
     |LEE 101#refer00@.=;
     |SI FSalida ! 0;
         |DDEFECTO #refer00@;
         #refer00@#0 = #refer08@#0;
         #refer00@#1 = #refer08@#2;
         #refer00@#2 = #refer08@#2;
         #refer00@#3 = #refer08@#3;
         |GRABA 020#refer00@.b;
     |FINSI;

     #refer00@#67 = "S";

     |GRABA 020#refer00@.a;
     |LIBERA #refer00@;

     #refer09@#0 = #refer08@#0;
     #refer09@#1 = #refer08@#1;
     |LEE 000#refer09@.=;
     |SI FSalida = 0;
         |HAZ GrabaBancoSociedad;
     |FINSI;
|FPRC;

|DEFBUCLE maacceso;
     #refer08@#1002;
     ;
     00000, 0000;
     99999, 9999;
     ;
     NULL, GrabaDesdeContasoc;
|FIN;

|PROCESO DesdeContasoc;
     aDef = eaPathContasoc + "def/maacceso.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathContasoc + "def/isocie00.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #refer09@;
     |ABRE #dspase85;
     |ABRE #dsam0009;
     |BUCLE maacceso;
     |CIERRA #refer09@;
     |CIERRA #dspase85;
     |CIERRA #dsam0009;

     |DESCARGA_DEF #refer09@;
     |DESCARGA_DEF #refer08@;
|FPRC;

\\ ---------------- Clientes desde la Aplicacion Facturar
|PROCESO GrabaEmpFacBan;
  |ABRE   #dsam0010;
  #dsam0010#0 = #refer00@#0;
  #dsam0010#1 = #refer08@#0;
  |LEE 141#dsam0010.=;
  |SI FSalida ! 0;
      #dsam0010#0 = #refer00@#0;
      #dsam0010#1 = #refer08@#0;
      |GRABA 020#dsam0010.b;
  |FINSI;
  #dsam0010#2 = #refer08@#1;
  #dsam0010#3 = #refer10@#0;
  #dsam0010#4 = #refer10@#1;
  #dsam0010#5 = #refer10@#2;
  #dsam0010#6 = #refer10@#3;
  aAlfa  = #refer09@#13 % 902;
  #dsam0010#7 = aAlfa;
  #dsam0010#8 = #refer09@#14;
  #dsam0010#9 = #refer09@#15;

  #dsam0010#10 = #refer09@#16;
  #dsam0010#11 = #refer11@#1;

  #dsam0010#12 = #refer09@#17;
  #dsam0010#13 = #refer09@#22;
  #dsam0010#14 = #refer09@#23;
  #dsam0010#15 = #refer09@#52;
  #dsam0010#18 = #refer00@#1;

  #dsam0010#22 = #refer09@#77;
  #dsam0010#28 = #refer09@#76;
  #dsam0010#29 = #refer09@#84;
  #dsam0010#30 = #refer09@#83;
  #dsam0010#31 = #refer09@#85;
  #dsam0010#32 = #refer09@#86;

  |GRABA 020#dsam0010.a;
  |LIBERA #dsam0010;
  |CIERRA #dsam0010;
|FPRC;

|PROCESO GrabaClienteFacturar;
     #refer00@#0 = #refer09@#0;
     |LEE 101#refer00@.=;
     |SI FSalida  ! 0;
         |DDEFECTO #refer00@;
         #refer00@#0 = #refer09@#0;
         #refer00@#1 = #refer09@#1;
         #refer00@#2 = #refer09@#2;
         #refer00@#3 = #refer09@#8;

         #refer00@#20 = #refer09@#3;
         #refer00@#25 = #refer09@#4;
         #refer00@#26 = #refer09@#5;
         #refer00@#27 = #refer09@#6;
         #refer00@#28 = #refer09@#7;

         aTPpal  = #refer09@#9;   |QBT aTPpal;
         aTOtros = #refer09@#56;  |QBT aTOtros;
         aTFax   = #refer09@#10;  |QBT aTFax;
         |HAZ GrabaTelefonos;

         |GRABA 020#refer00@.b;
     |SINO;
         |SI #dspase01#2 = "5";
             aTPpal  = #refer09@#9;   |QBT aTPpal;
             aTOtros = #refer09@#56;  |QBT aTOtros;
             aTFax   = #refer09@#10;  |QBT aTFax;
             |HAZ GrabaTelefonos;
         |FINSI;
     |FINSI;

     aAlfa1 = #refer09@#13 % 104;  |QBF aAlfa1;
     aAlfa2 = #refer09@#13 % 504;  |QBF aAlfa2;
     |SI aAlfa1 ! "";  |O aAlfa2 ! "";
         #dspase85#0 = aAlfa1;
         #dspase85#1 = aAlfa2;
         |LEE 040#dspase85.=;
         |SI FSalida = 0;
             #refer10@#0 = #dspase85#6;
             |LEE 040#refer10@.=;
             |SI FSalida ! 0;  |DDEFECTO #refer10@;  |FINSI;
         |FINSI;
     |SINO;
         |DDEFECTO #refer10@;
     |FINSI;

     #refer11@#0 = #refer09@#16;
     |LEE 040#refer11@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer11@;  |FINSI;

     |SI #refer00@#88 = 0;
          #refer00@#73  = #refer09@#16;
          #refer00@#74  = #refer11@#1;
          #refer00@#88  = #refer10@#0;
          #refer00@#89  = #refer10@#1;
          #refer00@#90  = #refer10@#2;
          #refer00@#91  = #refer10@#3;
          aAlfa    = #refer09@#13 % 902;
          #refer00@#92  = aAlfa;
          #refer00@#93  = #refer09@#14;
          #refer00@#94  = #refer09@#15;
          #refer00@#95  = #refer09@#17;
          #refer00@#96  = #refer09@#22;
          #refer00@#97  = #refer09@#23;
          #refer00@#103 = #refer09@#52;

          |SI #refer00@#93 ! "          ";
              #refer00@#104 = 2;
          |FINSI;  ||Forma de pago cliente
     |FINSI;
          #refer00@#114 = #refer09@#76;
          #refer00@#115 = #refer09@#86;
          #refer00@#116 = #refer09@#77;
          #refer00@#117 = #refer09@#83;
          #refer00@#118 = #refer09@#84;
          #refer00@#119 = #refer09@#85;

     |HAZ GrabaEmpFacBan;

     |GRABA 020#refer00@.a;
     |LIBERA #refer00@;

     #refer09@#1  = #refer00@#2;
     #refer09@#2  = #refer00@#1;
     #refer09@#3  = #refer00@#19 + " " + #refer00@#20 + " " + #refer00@#21;
     #refer09@#4  = #refer00@#25;
     #refer09@#5  = #refer00@#26;
     #refer09@#6  = #refer00@#27;
     #refer09@#7  = #refer00@#28;
     #refer09@#8  = #refer00@#3;
     #refer09@#9  = #refer00@#54;
     #refer09@#53 = #refer00@#88;
     #refer09@#11 = #refer00@#89;
     #refer09@#12 = #refer09@#6;
     aAlfa   = #refer00@#90 + #refer00@#91 + #refer00@#92;
     #refer09@#13 = aAlfa;
     #refer09@#14 = #refer00@#93;
     #refer09@#15 = #refer00@#94;
     #refer09@#16 = #refer00@#73;
     #refer09@#17 = #refer00@#95;
     #refer09@#22 = #refer00@#96;
     #refer09@#23 = #refer00@#97;
     #refer09@#52 = #refer00@#103;

     |GRABA 020#refer09@.a;
     |LIBERA #refer09@;
|FPRC;

|DEFBUCLE asclient;
     #refer09@#1001;
     ;
     00000;
     99999;
     be;
     NULL, GrabaClienteFacturar;
|FIN;

|PROCESO GrabaBancosFacturar;
     #refer10@#0 = #refer09@#0;
     |LEE 101#refer10@.=;
     |SI FSalida ! 0;
         #refer10@#0  = #refer09@#0;
         #refer10@#1  = #refer09@#1;
         #refer10@#2  = #refer09@#2;
         #refer10@#3  = #refer09@#3;
         #refer10@#4  = #refer09@#4;
         #refer10@#5  = #refer09@#5;
         #refer10@#6  = #refer09@#6;
         aAlfa   = #refer09@#7 % 104;   #refer10@#7  = aAlfa;
         aAlfa   = #refer09@#7 % 504;   #refer10@#8  = aAlfa;
         aAlfa   = #refer09@#7 % 902;   #refer10@#9  = aAlfa;
         aAlfa   = #refer09@#7 % 1110;  #refer10@#10 = aAlfa;
         #refer10@#11 = #refer09@#23;
         |GRABA 020#refer10@.n;
         |LIBERA #refer10@;
     |FINSI;
|FPRC;

|DEFBUCLE asbancos;
     #refer09@#1001;
     ;
     00;
     99;
     ;
     NULL, GrabaBancosFacturar;
|FIN;

|PROCESO GrabaPagosFactu;
     #refer10@#0 = #refer09@#0;
     |LEE 101#refer10@.=;
     |SI FSalida ! 0;
         |PARA nCampo = 0;  |SI nCampo [ 36;  |HACIENDO nCampo = nCampo + 1;
               #refer10@#nCampo# = #refer09@#nCampo#;
         |SIGUE;
         |GRABA 020#refer10@.n;
         |LIBERA #refer10@;
     |FINSI;
|FPRC;

|DEFBUCLE asfpagos;
     #refer09@#1001;
     ;
     00;
     99;
     ;
     NULL, GrabaPagosFactu;
|FIN;

|PROCESO CambiaEjerCuotasLin;
     |BORRA 020#refer10@.a;

     #refer10@#9 = #dspase01#1;
     |GRABA 020#refer10@.n;
     |LIBERA #refer10@;
|FPRC;

|DEFBUCLE ascuolin;
     #refer10@#1003;
     ;
     00000, 1900, 001;
     99999, 1900, 999;
     be;
     NULL, CambiaEjerCuotasLin;
|FIN;

|PROCESO CambiaEjerCuotas;
     |BORRA 020#refer09@.a;

     #refer09@#8 = #dspase01#1;
     |GRABA 020#refer09@.n;
     |LIBERA #refer09@;
|FPRC;

|DEFBUCLE ascuocab;
     #refer09@#1002;
     ;
     00000, 1900;
     99999, 1900;
     be;
     NULL, CambiaEjerCuotas;
|FIN;

|PROCESO GrabaDesdeFacturar;
     aFich  = eaPathFacturar + "fich/" + (("00" + #refer08@#0) % -102) + "/";  |QBT aFich;

     aDef   = eaPathFacturar + "def/asclient.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef   = eaPathIntegral + "def/dsam0116.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |ACABA;
     |FINSI;

     aDef   = eaPathFacturar + "def/asbancos.mas";
     |CARGA_DEF aDef, refer11@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer10@;
         |DESCARGA_DEF #refer09@;
         |ACABA;
     |FINSI;

     |PATH_DAT #refer09@#aFich#;
     |PATH_DAT #refer11@#aFich#;

     |ABRE #refer10@;
     |ABRE #refer11@;
     |ABRE #dspase85;
     |BUCLE asclient;
     |CIERRA #dspase85;
     |CIERRA #refer10@;
     |CIERRA #refer11@;

     |DESCARGA_DEF #refer11@;
     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;

     aDef   = eaPathFacturar + "def/asbancos.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef   = eaPathIntegral + "def/dsam0117.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |ACABA;
     |FINSI;

     |PATH_DAT #refer09@#aFich#;

     |ABRE #refer10@;
     |BUCLE asbancos;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;

     aDef   = eaPathFacturar + "def/asfpagos.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef   = eaPathIntegral + "def/dsam0118.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |ACABA;
     |FINSI;

     |PATH_DAT #refer09@#aFich#;

     |ABRE #refer10@;
     |BUCLE asfpagos;
     |CIERRA #refer10@;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;

     aDef   = eaPathFacturar + "def/ascuocab.mas";
     |CARGA_DEF aDef, refer09@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef   = eaPathFacturar + "def/ascuolin.mas";
     |CARGA_DEF aDef, refer10@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer09@;
         |ACABA;
     |FINSI;

     |PATH_DAT #refer09@#aFich#;
     |PATH_DAT #refer10@#aFich#;

     |BUCLE ascuocab;
     |BUCLE ascuolin;

     |DESCARGA_DEF #refer10@;
     |DESCARGA_DEF #refer09@;
|FPRC;

|DEFBUCLE facemp1;
     #refer08@#2002;
     ;
     "S", 00;
     "S", 99;
     ;
     NULL, GrabaDesdeFacturar;
|FIN;

|PROCESO DesdeFacturar;
     aDef = eaPathFacturar + "def/facemp1.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BUCLE facemp1;

     |DESCARGA_DEF #refer08@;
|FPRC;

\\ ---------------- Clientes desde la Aplicacion Laboral

|PROCESO GrabaTrabajadores;
     |SELECT #2#dspase85;
     #dspase85#3 = #refer08@#71;
     |LEE 040#dspase85.=;
     |SI FSalida ! 0;  |DDEFECTO #dspase85;  |FINSI;

     |SI #dspase85#6    = 0;  |ACABA;  |FINSI;
     |SI #refer08@#71 = 0;  |ACABA;  |FINSI;

     #refer08@#71 = #dspase85#6;
     |GRABA 020#refer08@.a;
     |LIBERA #refer08@;
|FPRC;

|DEFBUCLE labtraba;
     #refer08@#1002;
     ;
     00000, 00000;
     99999, 99999;
     be;
     NULL, GrabaTrabajadores;
|FIN;

|PROCESO GrabaDesdeLaboral;
     aAlfa1 = #refer08@#113 % 104;  |QBF aAlfa1;
     aAlfa2 = #refer08@#113 % 504;  |QBF aAlfa2;
     |SI aAlfa1 ! "";  |O aAlfa2 ! "";
         #dspase85#0 = aAlfa1;
         #dspase85#1 = aAlfa2;
         |LEE 040#dspase85.=;
         |SI FSalida ! 0;  |DDEFECTO #dspase85;  |FINSI;
     |SINO;
         |DDEFECTO #dspase85;
     |FINSI;

     #refer08@#30 = #dspase85#6;
     |GRABA 020#refer08@.a;
     |LIBERA #refer08@;

     nNume  = #refer08@#21;
     aAlfa  = ("00000" + nNume) % -105;
     aAlfa1 = aAlfa % 102;
     aAlfa2 = aAlfa % 303;

     #refer06@#0 = aAlfa1;
     #refer06@#1 = aAlfa2;
     |LEE 040#refer06@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer06@;  |FINSI;

     #refer00@#0 = #refer08@#0;
     |LEE 101#refer00@.=;
     |SI FSalida ! 0;
         |DDEFECTO #refer00@;

         #refer00@#0   = #refer08@#0;
         #refer00@#1   = #refer08@#2;
         #refer00@#2   = #refer08@#2;
         #refer00@#3   = #refer08@#10;
         #refer00@#20  = #refer08@#3;
         #refer00@#21  = #refer08@#4;
         #refer00@#23  = #refer08@#5;
         #refer00@#27  = #refer08@#6;
         #refer00@#25  = #refer08@#7;
         #refer00@#26  = #refer08@#8;
         #refer00@#28  = #refer08@#9;
         #refer00@#15  = aAlfa1;
         #refer00@#16  = aAlfa2;
         #refer00@#17  = #refer06@#2;
         #refer00@#18  = #refer06@#3;
         #refer00@#88  = #refer08@#30;
         #refer00@#54  = #refer08@#111;
         #refer00@#55  = #refer08@#112;
         aAlfa1 = #refer08@#113 % 104;   |QBF aAlfa1;
         aAlfa2 = #refer08@#113 % 504;   |QBF aAlfa2;
         aAlfa3 = #refer08@#113 % 902;   |QBF aAlfa3;
         aAlfa4 = #refer08@#113 % 1110;  |QBF aAlfa4;
         #refer00@#90  = aAlfa1;
         #refer00@#91  = aAlfa2;
         #refer00@#92  = aAlfa3;
         #refer00@#93  = aAlfa4;

         |SI #refer00@#93 ! "          ";  #refer00@#104 = 2;  |FINSI;  ||Forma de pago cliente

         aTPpal  = #refer00@#54;  |QBT aTPpal;
         aTOtros = #refer00@#55;  |QBT aTOtros;
         aTFax   = "";       |QBT aTFax;
         |HAZ GrabaTelefonos;
         |HAZ GrabaDirecciones;

         |GRABA 020#refer00@.b;
     |SINO;
         |SI #dspase01#2 = "4";
             #refer00@#54  = #refer08@#111;
             #refer00@#55  = #refer08@#112;

             aTPpal   = #refer00@#54;  |QBT aTPpal;
             aTOtros  = #refer00@#55;  |QBT aTOtros;
             aTFax    = "";       |QBT aTFax;
             |HAZ GrabaTelefonos;
         |FINSI;
     |FINSI;

     #refer00@#69  = "S";

     |GRABA 020#refer00@.a;
     |LIBERA #refer00@;
|FPRC;

|DEFBUCLE labempre;
     #refer08@#1001;
     ;
     00001;
     99999;
     be;
     NULL, GrabaDesdeLaboral;
|FIN;

|PROCESO GrabaGrupos;
     |SALVA_DATOS #refer08@;
     |BORRA 020#refer08@.a;

     |SELECT #2#dspase85;
     #dspase85#3 = #refer08@#1;
     |LEE 040#dspase85.=;
     |SI FSalida ! 0;  |DDEFECTO #dspase85;  |FINSI;

     |SI #dspase85#6 ! 0;
         #refer08@#1 = #dspase85#6;
         |GRABA 020#refer08@.n;
         |LIBERA #refer08@;
     |FINSI;

     |REPON_DATOS #refer08@;
     |LEE 000#refer08@.];
|FPRC;

|DEFBUCLE nomgrubl;
     #refer08@#1002;
     ;
     000, 000;
     999, 999;
     be;
     NULL, GrabaGrupos;
|FIN;

|PROCESO DesdeLaboral;
     aDef   = eaPathLaboral + "def/labtraba.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #dspase85;
     |BUCLE labtraba;
     |CIERRA #dspase85;

     |DESCARGA_DEF #refer08@;

     aDef = eaPathLaboral + "def/labempre.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #dspase85;
     |SELECT #1#dspase85;
     |BUCLE labempre;
     |CIERRA #dspase85;

     |DESCARGA_DEF #refer08@;

     aDef = eaPathLaboral + "def/nomgrubl.mas";
     |CARGA_DEF aDef, refer08@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #dspase85;
     |BUCLE nomgrubl;
     |CIERRA #dspase85;

     |DESCARGA_DEF #refer08@;
|FPRC;

|PROCESO CargaCliente;
     aDef = eaPathIntegral + "def/dsam0000.mas";
     |CARGA_DEF aDef, refer00@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0005.mas";
     |CARGA_DEF aDef, refer01@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0103.mas";
     |CARGA_DEF aDef, refer02@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0106.mas";
     |CARGA_DEF aDef, refer03@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer02@;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0107.mas";
     |CARGA_DEF aDef, refer04@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer03@;
         |DESCARGA_DEF #refer02@;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0115.mas";
     |CARGA_DEF aDef, refer05@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer04@;
         |DESCARGA_DEF #refer03@;
         |DESCARGA_DEF #refer02@;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0102.mas";
     |CARGA_DEF aDef, refer06@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer05@;
         |DESCARGA_DEF #refer04@;
         |DESCARGA_DEF #refer03@;
         |DESCARGA_DEF #refer02@;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0007.mas";
     |CARGA_DEF aDef, refer07@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer06@;
         |DESCARGA_DEF #refer05@;
         |DESCARGA_DEF #refer04@;
         |DESCARGA_DEF #refer03@;
         |DESCARGA_DEF #refer02@;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     |ABRE #refer00@;  |CIERRA #refer00@;  |DELINDEX #refer00@;
     |ABRE #refer01@;  |CIERRA #refer01@;  |DELINDEX #refer01@;
     |ABRE #refer03@;  |CIERRA #refer03@;  |DELINDEX #refer03@;
     |ABRE #refer04@;  |CIERRA #refer04@;  |DELINDEX #refer04@;
     |ABRE #refer07@;  |CIERRA #refer07@;  |DELINDEX #refer07@;

     |ABRE #refer00@;
     |ABRE #refer01@;
     |ABRE #refer02@;
     |ABRE #refer03@;
     |ABRE #refer04@;
     |ABRE #refer05@;
     |ABRE #refer06@;
     |ABRE #refer07@;

     |MENSA "      Creando Fichero de Clientes desde Modulo Integrador";
     |HAZ DesdeBasica;

     |MENSA "      Creando Fichero de Clientes desde Fiscal ";
     |HAZ DesdeFiscal;

     |MENSA "      Creando Fichero de Clientes desde Renta 2018 ";
     |HAZ DesdeRenta2018;

     |MENSA "      Creando Fichero de Clientes desde Renta 2017 ";
     |HAZ DesdeRenta2017;

     |MENSA "      Creando Fichero de Clientes desde Renta 2016 ";
     |HAZ DesdeRenta2016;

     |MENSA "      Creando Fichero de Clientes desde Renta 2015 ";
     |HAZ DesdeRenta2015;

     |MENSA "      Creando Fichero de Clientes desde Renta 2014 ";
     |HAZ DesdeRenta2014;

     |MENSA "      Creando Fichero de Clientes desde Renta 2013 ";
     |HAZ DesdeRenta2013;

     |MENSA "      Creando Fichero de Clientes desde Renta 2012 ";
     |HAZ DesdeRenta2012;

     |MENSA "      Creando Fichero de Clientes desde Renta 2011 ";
     |HAZ DesdeRenta2011;

     |MENSA "      Creando Fichero de Clientes desde Renta 2010 ";
     |HAZ DesdeRenta2010;

     |MENSA "      Creando Fichero de Clientes desde Renta 2009 ";
     |HAZ DesdeRenta2009;

     |MENSA "      Creando Fichero de Clientes desde Renta 2008 ";
     |HAZ DesdeRenta2008;

     |MENSA "      Creando Fichero de Clientes desde Renta 2007 ";
     |HAZ DesdeRenta2007;

     |MENSA "      Creando Fichero de Clientes desde Renta 2006 ";
     |HAZ DesdeRenta2006;

     |MENSA "      Creando Fichero de Clientes desde Renta 2005 ";
     |HAZ DesdeRenta2005;

     |MENSA "      Creando Fichero de Clientes desde Renta 2004 ";
     |HAZ DesdeRenta2004;

     |MENSA "      Creando Fichero de Clientes desde Renta 2003 ";
     |HAZ DesdeRenta2003;

     |MENSA "      Creando Fichero de Clientes desde Renta 2002 ";
     |HAZ DesdeRenta2002;

     |MENSA "      Creando Fichero de Clientes desde Renta 2001 ";
     |HAZ DesdeRenta2001;

     |MENSA "      Creando Fichero de Clientes desde Renta 2000 ";
     |HAZ DesdeRenta2000;

     |MENSA "      Creando Fichero de Clientes desde Renta 1999 ";
     |HAZ DesdeRenta1999;

     |MENSA "      Creando Fichero de Clientes desde Contabilidad ";
     |HAZ DesdeContagen;

     |MENSA "      Creando Fichero de Clientes desde Sociedades ";
     |HAZ DesdeContasoc;

     |MENSA "      Creando Fichero de Clientes desde Facturacion ";
     |HAZ DesdeLaboral;

     |MENSA "      Creando Fichero de Clientes desde Facturacion ";
     |HAZ DesdeFacturar;

     |MENSA "      Creando Fichero de Clientes desde Renta 1998 ";
     nAnyo = 1998;  |HAZ DesdeRentaAnteriores;

     |MENSA "      Creando Fichero de Clientes desde Renta 1997 ";
     nAnyo = 1997;  |HAZ DesdeRentaAnteriores;

     |MENSA "      Creando Fichero de Clientes desde Renta 1996 ";
     nAnyo = 1996;  |HAZ DesdeRentaAnteriores;

     |MENSA "      Creando Fichero de Clientes desde Renta 1995 ";
     nAnyo = 1995;  |HAZ DesdeRentaAnteriores;

     |MENSA "      Creando Fichero de Clientes desde Renta 1994 ";
     nAnyo = 1994;  |HAZ DesdeRentaAnteriores;

     |CIERRA #refer00@;
     |CIERRA #refer01@;
     |CIERRA #refer02@;
     |CIERRA #refer03@;
     |CIERRA #refer04@;
     |CIERRA #refer05@;
     |CIERRA #refer06@;
     |CIERRA #refer07@;

     |DESCARGA_DEF #refer07@;
     |DESCARGA_DEF #refer06@;
     |DESCARGA_DEF #refer05@;
     |DESCARGA_DEF #refer04@;
     |DESCARGA_DEF #refer03@;
     |DESCARGA_DEF #refer02@;
     |DESCARGA_DEF #refer01@;
     |DESCARGA_DEF #refer00@;
|FPRC;

|PROCESO GrabaDirecAct;
     #refer00@#0 = #refer01@#0;
     #refer00@#1 = 97;
     |LEE 040#refer00@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer00@;  |FINSI;

     #refer00@#0 = #refer01@#0;
     #refer00@#1 = #refer01@#1;
     #refer00@#2 = #refer01@#4;
     |GRABA 020#refer00@.n;
     |LIBERA #refer00@;
|FPRC;

|DEFBUCLE agicen14;
     #refer01@#1002;
     ;
     00000, 00;
     99999, 99;
     ;
     NULL, GrabaDirecAct;
|FIN;

|PROCESO Actividades;
     aDef = eaPathIntegral + "def/dsam0005.mas";
     |CARGA_DEF aDef, refer00@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathBasica + "def/agicen14.mas";
     |CARGA_DEF aDef, refer01@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     |ABRE #refer00@;
     |BUCLE agicen14;
     |CIERRA #refer00@;

     |DESCARGA_DEF #refer01@;
     |DESCARGA_DEF #refer00@;
|FPRC;

|PROCESO GrabaLisTelefonos;
     #refer01@#0 = #refer03@#0;
     |LEE 101#refer01@.=;
     |SI FSalida ! 0;
         #refer01@#0 = #refer03@#0;
         #refer01@#1 = #refer03@#1;
         #refer01@#2 = #refer03@#2;
         |GRABA 000#refer01@.n;
     |FINSI;
     |LIBERA #refer01@;

     #refer02@#0 = #refer01@#0;
     #refer02@#1 = 1;
     |LEE 101#refer02@.=;
     |SI FSalida ! 0;
         #refer02@#0 = #refer01@#0;
         #refer02@#1 = 1;
         #refer02@#2 = "TELEFONO PRINCIPAL";
         aTPpal = #refer03@#3 + #refer03@#4; |QBT aTPpal;
         #refer02@#4 = aTPpal;
         |GRABA 020#refer02@.n;
     |SINO;
         aTPpal = #refer03@#3 + #refer03@#4; |QBT aTPpal;
         #refer02@#4 = aTPpal;
         |GRABA 020#refer02@.a;
     |FINSI;
     |LIBERA #refer02@;

     #refer02@#0 = #refer01@#0;
     #refer02@#1 = 2;
     |LEE 101#refer02@.=;
     |SI FSalida ! 0;
         #refer02@#0 = #refer01@#0;
         #refer02@#1 = 2;
         #refer02@#2 = "TELEFONO DE CONTACTO";
         aTPpal = #refer03@#3 + #refer03@#4; |QBT aTPpal;
         #refer02@#4 = aTPpal;
         |GRABA 020#refer02@.n;
     |SINO;
         aTPpal = #refer03@#3 + #refer03@#4; |QBT aTPpal;
         #refer02@#4 = aTPpal;
         |GRABA 020#refer02@.a;
     |FINSI;
     |LIBERA #refer02@;

     |SI #refer03@#6 ! "            ";
         #refer02@#0 = #refer01@#0;
         #refer02@#1 = 3;
         |LEE 101#refer02@.=;
         |SI FSalida ! 0;
             #refer02@#0 = #refer01@#0;
             #refer02@#1 = 3;
             #refer02@#2 = "TELEFONO FAX";
             aTPpal = #refer03@#3 + #refer03@#6; |QBT aTPpal;
             #refer02@#4 = aTPpal;
             |GRABA 020#refer02@.n;
         |SINO;
             aTPpal = #refer03@#3 + #refer03@#6; |QBT aTPpal;
             #refer02@#4 = aTPpal;
             |GRABA 020#refer02@.a;
         |FINSI;
         |LIBERA #refer02@;
     |FINSI;

     |SI #refer03@#5 ! "            ";
         #refer02@#0 = #refer01@#0;
         #refer02@#1 = 4;
         |LEE 101#refer02@.=;
         |SI FSalida ! 0;
             #refer02@#0 = #refer01@#0;
             #refer02@#1 = 4;
             #refer02@#2 = "PARTICULAR";
             aTPpal = #refer03@#3 + #refer03@#5; |QBT aTPpal;
             #refer02@#4 = aTPpal;
             |GRABA 020#refer02@.n;
         |SINO;
             aTPpal = #refer03@#3 + #refer03@#5; |QBT aTPpal;
             #refer02@#4 = aTPpal;
             |GRABA 020#refer02@.a;
         |FINSI;
         |LIBERA #refer02@;
     |FINSI;

     nLinea = 4;
     |SI #refer03@#8 ! "            ";
         |PARA;  |SI;  |HACIENDO;
              #refer02@#0 = #refer01@#0;
              #refer02@#1 = nLinea;
              |LEE 101#refer02@.=;
              |SI FSalida ! 0;
                  #refer02@#0 = #refer01@#0;
                  #refer02@#1 = nLinea;
                  #refer02@#2 = #refer03@#7;
                  #refer02@#4 = #refer03@#8;
                  |GRABA 020#refer02@.n;
                  |LIBERA #refer02@;
                  |SAL;
              |FINSI;
              nLinea = nLinea + 1;
         |SIGUE;
     |FINSI;

     |SI #refer03@#10 ! "            ";
         nLinea = nLinea + 1;
         |PARA;  |SI;  |HACIENDO;
              #refer02@#0 = #refer01@#0;
              #refer02@#1 = nLinea;
              |LEE 101#refer02@.=;
              |SI FSalida ! 0;
                  #refer02@#0 = #refer01@#0;
                  #refer02@#1 = nLinea;
                  #refer02@#2 = #refer03@#9;
                  #refer02@#4 = #refer03@#10;
                  |GRABA 020#refer02@.n;
                  |LIBERA #refer02@;
                  |SAL;
              |FINSI;
              nLinea = nLinea + 1;
         |SIGUE;
     |FINSI;

     |SELECT #2#refer00@;
     #refer00@#1 = #refer01@#0;
     |LEE 101#refer00@.=;
     |SI FSalida = 0;
         aTPpal  = #refer03@#3 + #refer03@#4; |QBT aTPpal;
         #refer00@#54 = aTPpal;
         #refer00@#55 = aTPpal;
         |GRABA 020#refer00@.a;
     |FINSI;
     |LIBERA #refer00@;
|FPRC;

|DEFBUCLE agitelef;
     #refer03@#1001;
     ;
     "                                        ";
     "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, GrabaLisTelefonos;
|FIN;

|PROCESO ListinTelefonico;
     aDef = eaPathIntegral + "def/dsam0000.mas";
     |CARGA_DEF aDef, refer00@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = eaPathIntegral + "def/dsam0106.mas";
     |CARGA_DEF aDef, refer01@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathIntegral + "def/dsam0107.mas";
     |CARGA_DEF aDef, refer02@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathBasica + "def/agitelef.mas";
     |CARGA_DEF aDef, refer03@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer02@;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     |ABRE #refer00@;
     |ABRE #refer01@;
     |ABRE #refer02@;
     |BUCLE agitelef;
     |CIERRA #refer00@;
     |CIERRA #refer01@;
     |CIERRA #refer02@;

     |DESCARGA_DEF #refer03@;
     |DESCARGA_DEF #refer02@;
     |DESCARGA_DEF #refer01@;
     |DESCARGA_DEF #refer00@;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;
     |SI #dspase01#0 ! "SI";  |ACABA;  |FINSI;

     enAnyo = #dspase01#1;
     |SUB_EJECUTA_NP "dspase02";

     |MENSA "      Creando Ficheros Maestros";

     aFicheroD = "agim0003";  aFicheroH = "dsam0103";  |HAZ Copialos;
     aFicheroD = "agiusuar";  aFicheroH = "dsam0108";  |HAZ Copialos;
     aFicheroD = "agim0001";  aFicheroH = "dsam0008";  |HAZ Copialos;
     |SI #dspase01#3 = "N";
         aFicheroD = "agiprovi";  aFicheroH = "dsam0100";  |HAZ Copialos;
         aFicheroD = "agim0016";  aFicheroH = "dsam0104";  |HAZ Copialos;
         aFicheroD = "agihacie";  aFicheroH = "dsam0102";  |HAZ Copialos;
     |FINSI;

     |HAZ RecogeBancos;

     |MENSA "      Creando Fichero de Autonomias";
     |HAZ Autonomias;

     |MENSA "      Creando Fichero de Poblaciones";
     |HAZ AutonomiasPobla;

     |MENSA "      Creando Fichero de Nif";
     |HAZ RegistrosNif;

     |HAZ CargaCliente;

     |MENSA "      Creando Direcciones de Actividades ";
     |HAZ Actividades;

     |MENSA "      Creando Telefonos ";
     |HAZ ListinTelefonico;

     |MENSA "      Reunificando todos los Clientes ";
     |SUB_EJECUTA_NP ":integral/dsaz0003";
|FPRC;

|PROGRAMA;
     |ABRE #dspase00;
     |LEE 040#dspase00.p;
     |SI FSalida ! 0;
         |MENAV "     Pase de Ficheros Generales no Realizado";
         |CIERRA #dspase00;
         |ACABA;
     |FINSI;
     |CIERRA #dspase00;

     |ABRE #dspase15;
     |LEE 040#dspase15.p;
     |SI FSalida ! 0;  |DDEFECTO #dspase15;  |FINSI;
     |CIERRA #dspase15;

     |SI #dspase15#15 ! "S";
         |MENAV "     Unificacion de Codigos de Cliente no Realizado";
         |ACABA;
     |FINSI;

     aPathAnterior    = #dspase00#0;  |QBT aPathAnterior;
     aPathDefFiscal   = aPathAnterior + "agieos/def/";
     aPathFichFiscal  = aPathAnterior + "agieos/fich/";
     aPathDefLaboral  = aPathAnterior + "aginom/def/";
     aPathFichLaboral = aPathAnterior + "aginom/fich/";

     |HAZ BusquedaApli;
     |SI eaPathIntegral = "";
         |MENAV "     No tiene instalada la Plataforma Integrada, Consulte con su Proveedor.";
         |ACABA;
     |FINSI;

     aDef  = eaPathIntegral + "def/dsam0000";
     |CARGA_DEF aDef, refer00@;
     |ABRE #refer00@;
     |LEE 040#refer00@.p;
     |SI FSalida = 0;
         |MENAV "     Ya existen Datos en la Plataforma Integrada.";
         |CIERRA #refer00@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;
     |DESCARGA_DEF #refer00@;

     |MANTE #dspase01;
|FPRO;
