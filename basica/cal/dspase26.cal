|FICHEROS;
     dspase26 #0;
     dspase27 #1;
     dspase28 #2,MANTE;
     agifigen #3;

     dspase00 #100;
     dspase15 #115;

     :/modelos/def/dsm210dp #10;
     :/modelos/def/dsm210ca #11;
     :/modelos/def/dsm210in #12;
     :/modelos/def/dsm210ni #13;
     :/modelos/def/dsm210ln #14;
     :/modelos/def/dsm210fp #15;
     :/modelos/def/dsm210db #16;
     :/modelos/def/dsm210hi #17;
     :/modelos/def/dsm210h1 #18;
     :/modelos/def/dsm210h2 #19;
     :/modelos/def/dsm210h3 #20;
     :/modelos/def/dsm210h4 #21;

     :/contasoc/def/maacceso  #30;       || Acceso Sociedades                º
     :/contasoc/def/maempr10  #31;       || Empresa Sociedades               º
     :/contasoc/def/cuacceso  #32;       || Cuentas Anuales
     :/contasoc/def/isacceso  #33;       || Impuesto de sociedades

     :/integral/def/dsam0000 #50;
     :/integral/def/dsam0003 #51;
     :/integral/def/dsam0115 #52;
     :/integral/def/dsam0116 #53;
     :/integral/def/dsam0104 #54;
     :/integral/def/dsam0005 #55;
     :/integral/def/dsam0106 #56;
     :/integral/def/dsam0107 #57;

     dsm210dp@ #1000;
     dsm210ca@ #1002;
     dsm210ni@ #1003;
     dsm210in@ #1004;
     dsm210ln@ #1005;
     dsm210fp@ #1006;
     dsm210db@ #1007;
     dsm210hi@ #1008;
     dsm210h1@ #1009;
     dsm210h2@ #1010;
     dsm210h3@ #1011;
     dsm210h4@ #1012;
|FIN;

|VARIABLES;
     &eaPathDsmodelo  = "";
     &eaPathIntegral  = "";

     &eaPathAnterior   = "";
     &eaPathDefFiscal  = "";
     &eaPathFichFiscal = "";

     nSwCargaDef = 0;
     nSwError    = 0;
     nSwNuevo    = 0;
     nSw         = 0;

     nCodigo     = 0;
     nCont       = 0;

     aAlfa       = "";
     aAlfa1      = "";
     aAlfa2      = "";
     aAlfa3      = "";

     nCalc  = 0;

     aBase       = "";

     nRango = 0;
     nPos1  = 0;
     nPos2  = 0;

     nPant  = 0;
     nPantVent = 0;
     nVent  = 0;
     nGrid1 = 0;
     nBoton1 = 0;
     nLabel = 0;

     aEsc1   = "";
     aEsc2   = "";
     aRetu   = "";
     aTecla  = "";

     aColorNoActivo  = "255,255,255;150,150,150  ";
     aColorSinCodigo = "0,0,0;153,213,190        ";

{-1}aVent      = "";
    aVent1     = 0;
    aVent2     = 0;
    aVent3     = 0;
    aVent4     = 0;
    aVent5     = "";
|FIN;

|PROCESO Final;
   |PTEC 801;
|FPRC;

|PROCESO Tipo00;
   |SELECT #1#dsam0000;
   #dsam0000#0 = #dspase28#0;
   |LEE 000#dsam0000.=;
   |SI FSalida ! 0;
      nSwError = 0;
      |SALVA_FICHA #dspase27;
      aAlfa = #dspase27#0;
      |SELECT #2#dspase27;
      #dspase27#3 = #dspase28#0;
      #dspase27#0 = "";
      |LEE 000#dspase27.]
      |PARA; |SI FSalida = 0; |Y #dspase27#3 = #dspase28#0; |HACIENDO;
         |SI #dspase27#0 ! aAlfa;
            aAlfa = #dspase27#0;
            nSwError = 1; |SAL;
         |FINSI;
         |LEE 000#dspase27.s;
      |SIGUE;
      |SELECT #1#dspase27;
      |REPON_FICHA #dspase27;
      |SI nSwError = 1;
         aAlfa = "    El codigo " + (("00000" + #dspase28#0) % -106) + " ya se esta usando en el nif " + aAlfa;
         |MENAV aAlfa; |ERROR;
      |FINSI;
   |SINO;
      |MENAV "    El contribuyente ya existe";
      |ERROR;
   |FINSI;
   |SELECT #3#dsam0000;
|FPRC;

|PROCESO Tipo66; |TIPO 66;
   #dsam0000#3 = #dspase28#0;
   |LEE 000#dsam0000.];
   |CONSULTA_CLAVE #3#dsam0000;
   |ERROR;
|FPRC;

|PROCESO Tipo12; |TIPO 12;
|FPRC;

|PROCESO CargaDef;
   nSwError = -1; nSwCargaDef = 0;

   aAlfa = eaPathDefFiscal + "dsm210dp.mas";
   |CARGA_DEF aAlfa, dsm210dp@;
   |SI FSalida ! 0;
      |ACABA;
   |FINSI;

   aAlfa = eaPathDefFiscal + "dsm210ca.mas";
   |CARGA_DEF aAlfa, dsm210ca@;
   |SI FSalida ! 0;
      |DESCARGA_DEF #dsm210dp@;
      |ACABA;
   |FINSI;

   aAlfa = eaPathDefFiscal + "dsm210in.mas";
   |CARGA_DEF aAlfa, dsm210in@;
   |SI FSalida ! 0;
      |DESCARGA_DEF #dsm210ca@; |DESCARGA_DEF #dsm210dp@;
      |ACABA;
   |FINSI;

   aAlfa = eaPathDefFiscal + "dsm210ni.mas";
   |CARGA_DEF aAlfa, dsm210ni@;
   |SI FSalida ! 0;
      |DESCARGA_DEF #dsm210in@;
      |DESCARGA_DEF #dsm210ca@; |DESCARGA_DEF #dsm210dp@;
      |ACABA;
   |FINSI;

   aAlfa = eaPathDefFiscal + "dsm210ln.mas";
   |CARGA_DEF aAlfa, dsm210ln@;
   |SI FSalida ! 0;
      |DESCARGA_DEF #dsm210ni@; |DESCARGA_DEF #dsm210in@;
      |DESCARGA_DEF #dsm210ca@; |DESCARGA_DEF #dsm210dp@;
      |ACABA;
   |FINSI;

   aAlfa = eaPathDefFiscal + "dsm210fp.mas";
   |CARGA_DEF aAlfa, dsm210fp@;
   |SI FSalida ! 0;
      |DESCARGA_DEF #dsm210ln@;
      |DESCARGA_DEF #dsm210ni@; |DESCARGA_DEF #dsm210in@;
      |DESCARGA_DEF #dsm210ca@; |DESCARGA_DEF #dsm210dp@;
      |ACABA;
   |FINSI;

   aAlfa = eaPathDefFiscal + "dsm210db.mas";
   |CARGA_DEF aAlfa, dsm210db@;
   |SI FSalida ! 0;
      |DESCARGA_DEF #dsm210fp@; |DESCARGA_DEF #dsm210ln@;
      |DESCARGA_DEF #dsm210ni@; |DESCARGA_DEF #dsm210in@;
      |DESCARGA_DEF #dsm210ca@; |DESCARGA_DEF #dsm210dp@;
      |ACABA;
   |FINSI;

   aAlfa = eaPathDefFiscal + "dsm210hi.mas";
   |CARGA_DEF aAlfa, dsm210hi@;
   |SI FSalida ! 0;
      |DESCARGA_DEF #dsm210db@;
      |DESCARGA_DEF #dsm210fp@; |DESCARGA_DEF #dsm210ln@;
      |DESCARGA_DEF #dsm210ni@; |DESCARGA_DEF #dsm210in@;
      |DESCARGA_DEF #dsm210ca@; |DESCARGA_DEF #dsm210dp@;
      |ACABA;
   |FINSI;

   aAlfa = eaPathDefFiscal + "dsm210h1.mas";
   |CARGA_DEF aAlfa, dsm210h1@;
   |SI FSalida ! 0;
      |DESCARGA_DEF #dsm210hi@; |DESCARGA_DEF #dsm210db@;
      |DESCARGA_DEF #dsm210fp@; |DESCARGA_DEF #dsm210ln@;
      |DESCARGA_DEF #dsm210ni@; |DESCARGA_DEF #dsm210in@;
      |DESCARGA_DEF #dsm210ca@; |DESCARGA_DEF #dsm210dp@;
      |ACABA;
   |FINSI;

   aAlfa = eaPathDefFiscal + "dsm210h2.mas";
   |CARGA_DEF aAlfa, dsm210h2@;
   |SI FSalida ! 0;
      |DESCARGA_DEF #dsm210h1@;
      |DESCARGA_DEF #dsm210hi@; |DESCARGA_DEF #dsm210db@;
      |DESCARGA_DEF #dsm210fp@; |DESCARGA_DEF #dsm210ln@;
      |DESCARGA_DEF #dsm210ni@; |DESCARGA_DEF #dsm210in@;
      |DESCARGA_DEF #dsm210ca@; |DESCARGA_DEF #dsm210dp@;
      |ACABA;
   |FINSI;

   aAlfa = eaPathDefFiscal + "dsm210h3.mas";
   |CARGA_DEF aAlfa, dsm210h3@;
   |SI FSalida ! 0;
      |DESCARGA_DEF #dsm210h2@; |DESCARGA_DEF #dsm210h1@;
      |DESCARGA_DEF #dsm210hi@; |DESCARGA_DEF #dsm210db@;
      |DESCARGA_DEF #dsm210fp@; |DESCARGA_DEF #dsm210ln@;
      |DESCARGA_DEF #dsm210ni@; |DESCARGA_DEF #dsm210in@;
      |DESCARGA_DEF #dsm210ca@; |DESCARGA_DEF #dsm210dp@;
      |ACABA;
   |FINSI;

   aAlfa = eaPathDefFiscal + "dsm210h4.mas";
   |CARGA_DEF aAlfa, dsm210h4@;
   |SI FSalida ! 0;
      |DESCARGA_DEF #dsm210h3@;
      |DESCARGA_DEF #dsm210h2@; |DESCARGA_DEF #dsm210h1@;
      |DESCARGA_DEF #dsm210hi@; |DESCARGA_DEF #dsm210db@;
      |DESCARGA_DEF #dsm210fp@; |DESCARGA_DEF #dsm210ln@;
      |DESCARGA_DEF #dsm210ni@; |DESCARGA_DEF #dsm210in@;
      |DESCARGA_DEF #dsm210ca@; |DESCARGA_DEF #dsm210dp@;
      |ACABA;
   |FINSI;

   nSwCargaDef = 1;

   |PATH_DAT #dsm210dp@#eaPathFichFiscal#; |ABRE #dsm210dp@;
   |PATH_DAT #dsm210ca@#eaPathFichFiscal#; |ABRE #dsm210ca@;
   |PATH_DAT #dsm210in@#eaPathFichFiscal#; |ABRE #dsm210in@;
   |PATH_DAT #dsm210ni@#eaPathFichFiscal#; |ABRE #dsm210ni@;
   |PATH_DAT #dsm210ln@#eaPathFichFiscal#; |ABRE #dsm210ln@;
   |PATH_DAT #dsm210fp@#eaPathFichFiscal#; |ABRE #dsm210fp@;
   |PATH_DAT #dsm210db@#eaPathFichFiscal#; |ABRE #dsm210db@;
   |PATH_DAT #dsm210hi@#eaPathFichFiscal#; |ABRE #dsm210hi@;
   |PATH_DAT #dsm210h1@#eaPathFichFiscal#; |ABRE #dsm210h1@;
   |PATH_DAT #dsm210h2@#eaPathFichFiscal#; |ABRE #dsm210h2@;
   |PATH_DAT #dsm210h3@#eaPathFichFiscal#; |ABRE #dsm210h3@;
   |PATH_DAT #dsm210h4@#eaPathFichFiscal#; |ABRE #dsm210h4@;
|FPRC;

|PROCESO DescargaDef;
   |CIERRA #dsm210h4@; |CIERRA #dsm210h3@;
   |CIERRA #dsm210h2@; |CIERRA #dsm210h1@;
   |CIERRA #dsm210hi@; |CIERRA #dsm210db@;
   |CIERRA #dsm210fp@; |CIERRA #dsm210ln@;
   |CIERRA #dsm210ni@; |CIERRA #dsm210in@;
   |CIERRA #dsm210ca@; |CIERRA #dsm210dp@;
   |DESCARGA_DEF #dsm210h4@; |DESCARGA_DEF #dsm210h3@;
   |DESCARGA_DEF #dsm210h2@; |DESCARGA_DEF #dsm210h1@;
   |DESCARGA_DEF #dsm210hi@; |DESCARGA_DEF #dsm210db@;
   |DESCARGA_DEF #dsm210fp@; |DESCARGA_DEF #dsm210ln@;
   |DESCARGA_DEF #dsm210ni@; |DESCARGA_DEF #dsm210in@;
   |DESCARGA_DEF #dsm210ca@; |DESCARGA_DEF #dsm210dp@;
|FPRC;

|PROCESO MiraCodigo;
   nCodigo = 0;

   #dsam0000#3 = #dsm210dp@#2;
   |LEE 000#dsam0000.=;
   |SI FSalida = 0;
      nCodigo = #dsam0000#0; nSwNuevo = 0;
   |SINO;
      nSwNuevo = 1;
      |SELECT #1#dsam0000;
      #dsam0000#0 = #dsm210dp@#0;
      |LEE 000#dsam0000.=;
      |SI FSalida ! 0;
         nCodigo = #dsm210dp@#0;
      |SINO;
         |LEE 000#dsam0000.u;
         |SI FSalida = 0;
            |SI #dsam0000#0 = 99999;
               nCodigo = 0;
               |PARA nCont = 1; |SI nCont [ 99999; |HACIENDO nCont = nCont + 1;
                  #dsam0000#0 = nCont;
                  |LEE 000#dsam0000.=;
                  |SI FSalida ! 0;
                     |SELECT #2#dspase27;
                     #dspase27#3 = #dsam0000#0;
                     #dspase27#0 = "";
                     |LEE 000#dspase27.];
                     |SI FSalida ! 0; |Y #dspase27#3 = #dsam0000#0;
                        |SELECT #1#dspase27;
                        nCodigo = #dsam0000#0; |SAL;
                     |SINO;
                        |SELECT #1#dspase27;
                     |FINSI;
                  |FINSI;
               |SIGUE;
            |SINO;
               nCodigo = #dsam0000#0 + 1;
            |FINSI;
         |SINO;
            nCodigo = 1;
         |FINSI;
      |FINSI;
      |SELECT #3#dsam0000;
   |FINSI;
|FPRC;

|PROCESO RecogeCtrREO;
   |HAZ MiraCodigo;

   |DDEFECTO #dspase27;
   #dspase27#0 = #dsm210dp@#2;
   #dspase27#1 = #dsm210dp@#0;
   #dspase27#2 = #dsm210dp@#1;
   |SI nSwNuevo = 0;
      #dspase27#3 = #dsam0000#0;
      #dspase27#4 = #dsam0000#1;
      #dspase27#5 = "S";
      #dspase27#6 = "";
      #dspase27#7 = "N";
   |SINO;
      |SI nCodigo ! 0;
         #dspase27#3 = nCodigo;
         #dspase27#4 = #dsm210dp@#1;
         #dspase27#5 = "S";
      |FINSI;
      #dspase27#6 = aColorSinCodigo;
      #dspase27#7 = "S";
   |FINSI;

   |GRABA 020#dspase27.n;
|FPRC;

|DEFBUCLE RecogeCtrREO;
#dsm210dp@#1001;
;
00000;
99999;
;
NULL, RecogeCtrREO;
|FIN;

|PROCESO CambiaCodigo;
   |VENTANA 1113, 1486, -1, 17, "Indique el codigo a usar en el pase"; nVent = 0;
   aVent1 = -1;
   aVent2 = -1;
   aVent3 = 0;
   aVent4 = nVent;
   aVent5 = "MODAL";
   |ESPECIFICA "ESTADO_VENTANA", aVent;

   |PINPA #0#dspase28; nPantVent = FSalida;
   |PINDA #0#dspase28;

   |ENDATOS #1#dspase28;
   |SI FSalida = 0;
      #dspase27#3 = #dspase28#0;
      #dspase27#4 = #dspase27#2;
      |GRABA 020#dspase27.a;
   |FINSI;

   aVent4 = nVent;
   aVent5 = "MODELESS";
   |ESPECIFICA "ESTADO_VENTANA", aVent;
   |FINVENTANA nVent;

   |REFRESCACONTROL nGrid1;
|FPRC;

|PROCESO EvtoGrid1;
   |SI FSalida = 1; |O FSalida = 2;
      |LEE 000#dspase27.c;

      |SI #dspase27#6 ! aColorSinCodigo;
         |ESTADO_CONTROL nBoton1, "DISABLE";
      |SINO;
         |ESTADO_CONTROL nBoton1, "ENABLE";
      |FINSI;
   |FINSI;
   |SI FSalida = 4;
      |SI #dspase27#5 = "S";
         #dspase27#5 = "N";
         #dspase27#6 = aColorNoActivo;
      |SINO;
         #dspase27#5 = "S";
         |SI #dspase27#7 = "S";
            #dspase27#6 = aColorSinCodigo;
         |SINO;
            #dspase27#6 = "";
         |FINSI;
      |FINSI;
      |GRABA 020#dspase27.a;
      |REFRESCACONTROL nGrid1;
   |FINSI;
|FPRC;

|PROCESO Tipo80; |TIPO 80;
   FSalida = 2499;
|FPRC;

|PROCESO GrabaBasica;
     |ABRE #agifigen;
     #agifigen#0 = #dsam0000#0;
     |LEE 101#agifigen.=;
     |SI FSalida ! 0;
         |DDEFECTO #agifigen;
         #agifigen#0 = #dsam0000#0;
         |GRABA 020#agifigen.b;
     |FINSI;

     #agifigen#2  = #dsam0000#1;
     #agifigen#1  = #dsam0000#2;
     #agifigen#13 = #dsam0000#3;
     #agifigen#14 = #dsam0000#54;
     #agifigen#61 = #dsam0000#55;
     #agifigen#15 = "";
     #agifigen#95 = #dsam0000#104;  ||Forma de pago Cliente
     #agifigen#96 = #dsam0000#53;   ||Persona Contacto

     #agifigen#18 = #dsam0000#69;
     #agifigen#20 = #dsam0000#67;
     #agifigen#21 = #dsam0000#67;
     #agifigen#22 = #dsam0000#68;
     #agifigen#23 = #dsam0000#65;

     || Direccion  Fiscal

     #agifigen#3  = #dsam0000#29;
     #agifigen#4  = #dsam0000#30;
     #agifigen#5  = #dsam0000#31;
     #agifigen#6  = #dsam0000#32;
     #agifigen#7  = #dsam0000#33;
     #agifigen#8  = #dsam0000#34;
     #agifigen#9  = #dsam0000#35;
     #agifigen#10 = #dsam0000#36;
     #agifigen#11 = #dsam0000#37;
     #agifigen#12 = #dsam0000#38;
/*
     ||Direccion  Actividad
     |ABRE #dsam0005;
     #dsam0005#0 = #dsam0000#0;
     #dsam0005#1 = 1;
     |LEE 040#dsam0005];
     |SI FSalida ! 0;  |DDEFECTO #dsam0005;  |FINSI;
     |SI #dsam0005#0 ! #dsam0000#0;  |DDEFECTO #dsam0005;  |FINSI;
     |SI #dsam0005#1 ] 97;    |DDEFECTO #dsam0005;  |FINSI;
*/
     #agifigen#41 = #dsam0000#19;
     #agifigen#42 = #dsam0000#20;
     #agifigen#43 = #dsam0000#21;
     #agifigen#44 = #dsam0000#22;
     #agifigen#45 = #dsam0000#23;
     #agifigen#46 = #dsam0000#24;
     #agifigen#47 = #dsam0000#25;
     #agifigen#48 = #dsam0000#26;
     #agifigen#49 = #dsam0000#27;
     #agifigen#50 = #dsam0000#28;

     ||Direccion  Envio
     #agifigen#51 = #dsam0000#39;
     #agifigen#52 = #dsam0000#40;
     #agifigen#53 = #dsam0000#41;
     #agifigen#54 = #dsam0000#42;
     #agifigen#55 = #dsam0000#43;
     #agifigen#56 = #dsam0000#44;
     #agifigen#57 = #dsam0000#45;
     #agifigen#58 = #dsam0000#46;
     #agifigen#59 = #dsam0000#47;
     #agifigen#60 = #dsam0000#48;
     #agifigen#16 = (("00" + #agifigen#57) % -102) + (("000" + #agifigen#58) % -103);
     |SI #agifigen#16 = "00000";
         #agifigen#16 = (("00" + #agifigen#9) % -102) + (("000" + #agifigen#10) % -103);
     |FINSI;

     #agifigen#79 = #dsam0000#88;
     #agifigen#80 = #dsam0000#89;
     #agifigen#81 = #dsam0000#90;
     #agifigen#82 = #dsam0000#91;
     #agifigen#83 = #dsam0000#92;
     #agifigen#84 = #dsam0000#93;

     #agifigen#62 = #dsam0000#5;
     #agifigen#63 = #dsam0000#15;
     #agifigen#64 = #dsam0000#16;
     #agifigen#65 = #dsam0000#49;
     #agifigen#91 = #dsam0000#17;
     #agifigen#92 = #dsam0000#18;
     #agifigen#93 = #dsam0000#6;
     #agifigen#94 = #dsam0000#7;

     #agifigen#87 = #dsam0000#9;
     #agifigen#88 = #dsam0000#10;
     #agifigen#85 = #dsam0000#50;
     #agifigen#86 = #dsam0000#51;

     |GRABA 020#agifigen.a;
     |LIBERA #agifigen;
     |CIERRA #agifigen;
|FPRC;

|PROCESO GrabaTelefonos;
     |ABRE #dsam0106;
     #dsam0106#0 = #dsam0000#1;
     |LEE 101#dsam0106.=;
     |SI FSalida ! 0;
         #dsam0106#0 = #dsam0000#1;
         #dsam0106#1 = #dsam0000#27;
         #dsam0106#2 = #dsam0000#28;
         |GRABA 020#dsam0106.n;
     |SINO;
         #dsam0106#1 = #dsam0000#27;
         #dsam0106#2 = #dsam0000#28;
         |GRABA 020#dsam0106.a;
     |FINSI;
     |LIBERA #dsam0106;
     |CIERRA #dsam0106;

     |ABRE #dsam0107;
     #dsam0107#0 = #dsam0106#0;
     #dsam0107#1 = 1;
     |LEE 001#dsam0107.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsam0107;
         #dsam0107#0 = #dsam0000#1; #dsam0107#1 = 1; #dsam0107#2 = "TELEFONO PRINCIPAL  "; #dsam0107#4 = #dsam0000#54;
         |GRABA 040#dsam0107.n;
     |FINSI;
     #dsam0107#0 = #dsam0000#1;
     #dsam0107#1 = 2;
     |LEE 040#dsam0107.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsam0107;
         #dsam0107#0 = #dsam0000#1;  #dsam0107#1 = 2;  #dsam0107#2 = "TELEFONO DE CONTACTO";   |GRABA 020#dsam0107.n;
     |FINSI;
     |CIERRA #dsam0107;
|FPRC;

|PROCESO GrabaSociedades;
     aBase = "";
     |DBASS aBase;  |QBT aBase;
     aBase = aBase + "contasoc/fich/";
     |PATH_DAT #maempr10#aBase#;
     |PATH_DAT #cuacceso#aBase#;

     |ABRE #maempr10;
     #maempr10#0 = #dsam0000#0;
     #maempr10#1 = 9999;
     |LEE 040#maempr10.];
     |SI FSalida = 0;
         |LEE 101#maempr10.a;
     |SINO;
         |LEE 101#maempr10.u;
     |FINSI;
     |SI FSalida = 0;  |Y  #maempr10#0 = #dsam0000#0;
         #maempr10#2  = #dsam0000#1;
         #maempr10#3  = #dsam0000#3;
         #maempr10#29 = #dsam0000#15;
         #maempr10#30 = #dsam0000#16;
         |GRABA 020#maempr10.a;

         |ABRE #maacceso;
         #maacceso#0 = #maempr10#0;
         #maacceso#1 = #maempr10#1;
         |LEE 101#maacceso.=;
         |SI FSalida = 0;
             #maacceso#2  = #maempr10#2;
             #maacceso#3  = #maempr10#3;
             |GRABA 020#maacceso.a;
             |LIBERA #maacceso;
         |FINSI;
         |CIERRA #maacceso;

         |ABRE #cuacceso;
         #cuacceso#0 = #maempr10#0;
         #cuacceso#1 = #maempr10#1;
         |LEE 101#cuacceso.=;
         |SI FSalida = 0;
             #cuacceso#2  = #maempr10#2;
             #cuacceso#4  = #maempr10#3;
             |GRABA 020#cuacceso.a;
             |LIBERA #cuacceso;
         |FINSI;
         |CIERRA #cuacceso;

         |ABRE #isacceso;
         #isacceso#0 = #maempr10#0;
         #isacceso#1 = #maempr10#1;
         |LEE 101#isacceso.=;
         |SI FSalida = 0;
             #isacceso#2  = #maempr10#2;
             #isacceso#3  = #maempr10#3;
             |GRABA 020#isacceso.a;
             |LIBERA #isacceso;
         |FINSI;
         |CIERRA #isacceso;
     |FINSI;
     |LIBERA #maempr10;
     |CIERRA #maempr10;
|FPRC;

|PROCESO GrabaDirecciones;

     #dsam0005#0  = #dsam0000#0;
     #dsam0005#1  = 98;
     |LEE 101#dsam0005.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsam0005;
         #dsam0005#0  = #dsam0000#0;
         #dsam0005#1  = 98;
         |GRABA 020#dsam0005.b;
     |FINSI;

     #dsam0005#2  = "DOMICILIO FISCAL ";
     #dsam0005#3  = #dsam0000#29;
     #dsam0005#4  = #dsam0000#30;
     #dsam0005#5  = #dsam0000#31;
     #dsam0005#6  = #dsam0000#32;
     #dsam0005#7  = #dsam0000#33;
     #dsam0005#8  = #dsam0000#34;
     #dsam0005#9  = #dsam0000#35;
     #dsam0005#10 = #dsam0000#36;
     #dsam0005#11 = #dsam0000#37;
     #dsam0005#12 = #dsam0000#38;
     #dsam0005#15 = #dsam0000#86;
     #dsam0005#16 = #dsam0000#87;
     #dsam0005#17 = #dsam0000#98;
     #dsam0005#18 = #dsam0000#99;
     |GRABA 020#dsam0005.a;
     |LIBERA #dsam0005;

     #dsam0005#0  = #dsam0000#0;
     #dsam0005#1  = 97;
     |LEE 101#dsam0005.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsam0005;
         #dsam0005#0  = #dsam0000#0;
         #dsam0005#1  = 97;
         |GRABA 020#dsam0005.b;
     |FINSI;

     #dsam0005#2  = "DOMICILIO SOCIAL ";
     #dsam0005#3  = #dsam0000#19;
     #dsam0005#4  = #dsam0000#20;
     #dsam0005#5  = #dsam0000#21;
     #dsam0005#6  = #dsam0000#22;
     #dsam0005#7  = #dsam0000#23;
     #dsam0005#8  = #dsam0000#24;
     #dsam0005#9  = #dsam0000#25;
     #dsam0005#10 = #dsam0000#26;
     #dsam0005#11 = #dsam0000#27;
     #dsam0005#12 = #dsam0000#28;
     #dsam0005#15 = #dsam0000#86;
     #dsam0005#16 = #dsam0000#87;
     #dsam0005#17 = #dsam0000#98;
     #dsam0005#18 = #dsam0000#99;
     |GRABA 020#dsam0005.a;
     |LIBERA #dsam0005;

     #dsam0005#0  = #dsam0000#0;
     #dsam0005#1  = 99;
     |LEE 101#dsam0005.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsam0005;
         #dsam0005#0  = #dsam0000#0;
         #dsam0005#1  = 99;
         |GRABA 020#dsam0005.b;
     |FINSI;

     #dsam0005#2  = "DOMICILIO ENVIO ";
     #dsam0005#3  = #dsam0000#39;
     #dsam0005#4  = #dsam0000#40;
     #dsam0005#5  = #dsam0000#41;
     #dsam0005#6  = #dsam0000#42;
     #dsam0005#7  = #dsam0000#43;
     #dsam0005#8  = #dsam0000#44;
     #dsam0005#9  = #dsam0000#45;
     #dsam0005#10 = #dsam0000#46;
     #dsam0005#11 = #dsam0000#47;
     #dsam0005#12 = #dsam0000#48;
     #dsam0005#15 = #dsam0000#86;
     #dsam0005#16 = #dsam0000#87;
     #dsam0005#17 = #dsam0000#98;
     #dsam0005#18 = #dsam0000#99;
     |GRABA 020#dsam0005.a;
     |LIBERA #dsam0005;
|FPRC;

|PROCESO GrabaDatosRentas;
   |DDEFECTO #dsam0003;
   #dsam0003#0  = #dspase27#3;
   #dsam0003#1  = #dspase27#0;
   aAlfa = #dsm210dp@#1; |QBF aAlfa;
   aAlfa1 = aAlfa - ",";
   |SI FSalida ! 0;
      nCalc = ((FSalida / 100) ! 0) + 99; aAlfa1 = aAlfa % nCalc;
      aAlfa2 = aAlfa1 + ","; aAlfa2 = aAlfa - aAlfa2;
      |QBF aAlfa2;
      |SI aAlfa2 ! "";
         aAlfa3 = aAlfa2 % 0101;
         |PARA; |SI aAlfa3 = " "; |HACIENDO;
            aAlfa2 = aAlfa2 % 0299;
            aAlfa3 = aAlfa2 % 0101;
         |SIGUE;
      |FINSI;
   |SINO;
      aAlfa1 = aAlfa;
      aAlfa2 = "";
   |FINSI;
   #dsam0003#2  = aAlfa1;
   #dsam0003#4  = aAlfa2;
   #dsam0003#5  = #dsm210dp@#1;
   |GRABA 020#dsam0003.b;

   #dsam0003#6  = "S";
   aAlfa = #dsm210dp@#64; |QBF aAlfa;
   |SI aAlfa ! ""; #dsam0003#6  = "C"; |FINSI;
   aAlfa = #dsm210dp@#4; |QBF aAlfa;
   aAlfa = aAlfa % -104;
   #dsam0003#7  = aAlfa;
   #dsam0003#10 = "N";
   #dsam0003#12 = #dsm210dp@#24;
   #dsam0003#13 = #dsm210dp@#25;
   #dsam0003#14 = #dsm210dp@#8;
   #dsam0003#15 = #dsm210dp@#9;
   #dsam0003#16 = #dsm210dp@#11;
   #dsam0003#17 = #dsm210dp@#15;
   #dsam0003#18 = #dsm210dp@#16;
   #dsam0003#19 = #dsm210dp@#17;
   #dsam0003#20 = #dsm210dp@#20;
   #dsam0003#21 = #dsm210dp@#21;
   #dsam0003#22 = #dsm210dp@#22;
   aAlfa = (("00" + #dsm210dp@#20) % -102) + (("000" + #dsm210dp@#21) % -103);
   #dsam0003#23 = aAlfa;

   #dsam0003#24 = #dsam0003#14;
   #dsam0003#25 = #dsam0003#15;
   #dsam0003#26 = #dsam0003#16;
   #dsam0003#27 = #dsam0003#17;
   #dsam0003#28 = #dsam0003#18;
   #dsam0003#29 = #dsam0003#19;
   #dsam0003#30 = #dsam0003#20;
   #dsam0003#31 = #dsam0003#21;
   #dsam0003#32 = #dsam0003#22;
   #dsam0003#33 = #dsam0003#23;

   #dsam0003#35 = #dsm210dp@#64;
   aAlfa = #dsm210dp@#63; |QBF aAlfa;
   aAlfa1 = aAlfa - ",";
   |SI FSalida ! 0;
      nCalc = ((FSalida / 100) ! 0) + 99; aAlfa1 = aAlfa % nCalc;
      aAlfa2 = aAlfa1 + ","; aAlfa2 = aAlfa - aAlfa2;
      |QBF aAlfa2;
      |SI aAlfa2 ! "";
         aAlfa3 = aAlfa2 % 0101;
         |PARA; |SI aAlfa3 = " "; |HACIENDO;
            aAlfa2 = aAlfa2 % 0299;
            aAlfa3 = aAlfa2 % 0101;
         |SIGUE;
      |FINSI;
   |SINO;
      aAlfa1 = aAlfa;
      aAlfa2 = "";
   |FINSI;
   #dsam0003#36  = aAlfa1;
   #dsam0003#38  = aAlfa2;
   #dsam0003#39 = #dsm210dp@#63;
   aAlfa = #dsm210dp@#66; |QBF aAlfa;
   aAlfa = aAlfa % -104;
   #dsam0003#40 = aAlfa;
   #dsam0003#44 = #dsm210dp@#70;
   #dsam0003#45 = #dsm210dp@#71;
   #dsam0003#46 = #dsm210dp@#73;
   #dsam0003#47 = #dsm210dp@#77;
   #dsam0003#48 = #dsm210dp@#78;
   #dsam0003#49 = #dsm210dp@#79;
   #dsam0003#50 = #dsm210dp@#82;
   #dsam0003#51 = #dsm210dp@#83;
   #dsam0003#52 = #dsm210dp@#84;

   aAlfa = #dsm210db@#2; |QBF aAlfa;
   |SI aAlfa ! "";
      aAlfa = #dsm210db@#2;
      aAlfa = aAlfa + #dsm210db@#3;
      aAlfa = aAlfa + #dsm210db@#4;
      aAlfa = aAlfa + #dsm210db@#5;
      aAlfa = aAlfa + #dsm210db@#6;
   |FINSI;
   #dsam0003#53 = aAlfa;
   aAlfa = #dsm210db@#27; |QBF aAlfa;
   |SI aAlfa ! "";
      aAlfa = #dsm210db@#27;
      aAlfa = aAlfa + #dsm210db@#28;
      aAlfa = aAlfa + #dsm210db@#29;
      aAlfa = aAlfa + #dsm210db@#30;
      aAlfa = aAlfa + #dsm210db@#31;
   |FINSI;
   #dsam0003#54 = aAlfa;
   #dsam0003#64 = "S";
   #dsam0003#67 = #dsm210dp@#4;
   #dsam0003#68 = #dsm210dp@#66;
   #dsam0003#71 = #dsm210dp@#25;
   #dsam0003#72 = #dsm210dp@#87;
   #dsam0003#74 = #dsm210dp@#36;
   #dsam0003#75 = "S";
   #dsam0003#76 = #dsm210dp@#10;
   #dsam0003#77 = #dsm210dp@#12;
   #dsam0003#78 = #dsm210dp@#13;
   #dsam0003#79 = #dsm210dp@#14;
   #dsam0003#80 = #dsm210dp@#18;
   #dsam0003#81 = #dsm210dp@#19;
   #dsam0003#82 = #dsm210dp@#27;
   #dsam0003#83 = #dsm210dp@#28;
   #dsam0003#84 = #dsm210dp@#29;
   #dsam0003#85 = #dsm210dp@#30;
   #dsam0003#86 = #dsm210dp@#31;
   #dsam0003#87 = #dsm210dp@#32;
   #dsam0003#88 = #dsm210dp@#33;

   #dsam0104#0  = #dsm210dp@#33;
   |LEE 000#dsam0104.=;
   |SI FSalida ! 0; |DDEFECTO #dsam0104; |FINSI;
   #dsam0003#89 = #dsam0104#1;

   #dsam0003#91  = #dsm210dp@#88;
   #dsam0003#92  = #dsm210dp@#89;
   #dsam0003#93  = #dsm210dp@#72;
   #dsam0003#94  = #dsm210dp@#74;
   #dsam0003#95  = #dsm210dp@#75;
   #dsam0003#96  = #dsm210dp@#76;
   #dsam0003#97  = #dsm210dp@#80;
   #dsam0003#98  = #dsm210dp@#81;
   #dsam0003#99  = #dsm210dp@#89;
   #dsam0003#100 = #dsm210dp@#90;
   #dsam0003#101 = #dsm210dp@#91;
   #dsam0003#102 = #dsm210dp@#92;
   #dsam0003#103 = #dsm210dp@#93;
   #dsam0003#104 = #dsm210dp@#94;
   #dsam0003#105 = #dsm210dp@#95;

   #dsam0104#0  = #dsm210dp@#95;
   |LEE 000#dsam0104.=;
   |SI FSalida ! 0; |DDEFECTO #dsam0104; |FINSI;
   #dsam0003#106 = #dsam0104#1;

   |GRABA 020#dsam0003.a; |LIBERA #dsam0003;
|FPRC;

|PROCESO PasaAIntegral;
   |SELECT #1#dsam0000;

   |DDEFECTO #dsam0000;
   #dsam0000#0  = #dspase27#3;
   #dsam0000#1  = #dsm210dp@#1;
   |GRABA 020#dsam0000.b;

   #dsam0000#2  = #dsm210dp@#1;
   #dsam0000#3  = #dsm210dp@#2;
   #dsam0000#5  = "ACTIVA";

   aAlfa = #dsm210db@#2; |QBF aAlfa;
   #dsam0116#2 = "";
   #dsam0116#3 = #dsm210db@#2;
   |LEE 000#dsam0116.];
   |SI FSalida ! 0; |O #dsam0116#3 ! #dsm210db@#2;
      |DDEFECTO #dsam0116;
   |FINSI;

   #dsam0115#2 = #dsm210dp@#8;
   |LEE 000#dsam0115.=;
   |SI FSalida ! 0; |DDEFECTO #dsam0115; |FINSI;

   #dsam0104#0  = #dsm210dp@#7;
   |LEE 000#dsam0104.=;
   |SI FSalida ! 0; |DDEFECTO #dsam0104; |FINSI;

   #dsam0000#19 = #dsam0115#0;
   #dsam0000#20 = #dsm210dp@#9;
   #dsam0000#21 = #dsm210dp@#11;
   #dsam0000#22 = #dsm210dp@#15;
   #dsam0000#23 = #dsm210dp@#16;
   #dsam0000#24 = #dsm210dp@#17;
   #dsam0000#25 = #dsm210dp@#20;
   #dsam0000#26 = #dsm210dp@#21;
   #dsam0000#27 = #dsm210dp@#22;
   #dsam0000#28 = #dsm210dp@#23;

   #dsam0000#29 = #dsam0000#19;
   #dsam0000#30 = #dsam0000#20;
   #dsam0000#31 = #dsam0000#21;
   #dsam0000#32 = #dsam0000#22;
   #dsam0000#33 = #dsam0000#23;
   #dsam0000#34 = #dsam0000#24;
   #dsam0000#35 = #dsam0000#25;
   #dsam0000#36 = #dsam0000#26;
   #dsam0000#37 = #dsam0000#27;
   #dsam0000#38 = #dsam0000#28;

   #dsam0000#39 = #dsam0000#29;
   #dsam0000#40 = #dsam0000#30;
   #dsam0000#41 = #dsam0000#31;
   #dsam0000#42 = #dsam0000#32;
   #dsam0000#43 = #dsam0000#33;
   #dsam0000#44 = #dsam0000#34;
   #dsam0000#45 = #dsam0000#35;
   #dsam0000#46 = #dsam0000#36;
   #dsam0000#47 = #dsam0000#37;
   #dsam0000#48 = #dsam0000#38;

   #dsam0000#53 = #dsm210dp@#1;
   #dsam0000#54 = #dsm210dp@#24;
   #dsam0000#55 = #dsm210dp@#25;

   #dsam0000#68 = "S";

   #dsam0000#71 = #dsm210dp@#30;

   #dsam0000#85 = "A";

   #dsam0000#88 = #dsam0116#0;
   #dsam0000#89 = #dsam0116#1;

   aAlfa = #dsm210db@#2; |QBF aAlfa;
   |SI aAlfa ! "";
      #dsam0000#90 = #dsm210db@#2;
      #dsam0000#91 = #dsm210db@#3;
      aAlfa = #dsm210db#4; aAlfa = aAlfa % 0102;
      #dsam0000#92 = aAlfa;
      aAlfa = #dsm210db#4; aAlfa = aAlfa % 0302;
      aAlfa = aAlfa + #dsm210db#5;
      aAlfa = aAlfa + #dsm210db#6;
      #dsam0000#93 = aAlfa;
   |FINSI;

   #dsam0000#98 = #dsm210dp@#7;
   #dsam0000#99 = #dsam0104#1;
   |GRABA 020#dsam0000.a; |LIBERA #dsam0000;

   |HAZ GrabaDirecciones;
   ||HAZ GrabaSociedades;
   |HAZ GrabaBasica;
   |HAZ GrabaTelefonos;

   |SELECT #3#dsam0000;

   |HAZ GrabaDatosRentas;
|FPRC;

|PROCESO PasaModelo210;
   #dsm210ca@#0 = #dspase27#1;
   |LEE 000#dsm210ca@.];
   |SI FSalida = 0; |Y #dsm210ca@#0 = #dspase27#1;
      |PARA; |SI FSalida = 0; |Y #dsm210ca@#0 = #dspase27#1; |HACIENDO;
         #dsm210ca#0 = #dspase27#3;
         #dsm210ca#1 = #dsm210ca@#1;
         |LEE 101#dsm210ca.=;
         |SI FSalida ! 0;
            |DDEFECTO #dsm210ca;
            #dsm210ca#0 = #dspase27#3;
            #dsm210ca#1 = #dsm210ca@#1;
            |GRABA 020#dsm210ca.b;
         |FINSI;
         |PARA nCont = 2; |SI nCont [ 11; |HACIENDO nCont = nCont + 1;
            #dsm210ca#nCont# = #dsm210ca@#nCont#;
         |SIGUE;
         |GRABA 020#dsm210ca.a;  |LIBERA #dsm210ca;

         |LEE 000#dsm210ca@.s;
      |SIGUE;
   |SINO;
      |DDEFECTO #dsm210ca@;
   |FINSI;

   #dsm210in@#0 = #dspase27#1;
   |LEE 000#dsm210in@.];
   |SI FSalida = 0; |Y #dsm210in@#0 = #dspase27#1;
      |PARA; |SI FSalida = 0; |Y #dsm210in@#0 = #dspase27#1; |HACIENDO;
         #dsm210in#0 = #dspase27#3;
         #dsm210in#1 = #dsm210in@#1;
         #dsm210in#2 = #dsm210in@#2;
         |LEE 101#dsm210in.=;
         |SI FSalida ! 0;
            |DDEFECTO #dsm210in;
            #dsm210in#0 = #dspase27#3;
            #dsm210in#1 = #dsm210in@#1;
            #dsm210in#2 = #dsm210in@#2;
            |GRABA 020#dsm210in.b;
         |FINSI;
         |PARA nCont = 3; |SI nCont [ 11; |HACIENDO nCont = nCont + 1;
            #dsm210in#nCont# = #dsm210in@#nCont#;
         |SIGUE;
         |GRABA 020#dsm210in.a;  |LIBERA #dsm210in;

         |LEE 000#dsm210in@.s;
      |SIGUE;
   |SINO;
      |DDEFECTO #dsm210in@;
   |FINSI;

   #dsm210ni@#0 = #dspase27#1;
   |LEE 000#dsm210ni@.];
   |SI FSalida = 0; |Y #dsm210ni@#0 = #dspase27#1;
      |PARA; |SI FSalida = 0; |Y #dsm210ni@#0 = #dspase27#1; |HACIENDO;
         #dsm210ni#0 = #dspase27#3;
         #dsm210ni#1 = #dsm210ni@#1;
         #dsm210ni#2 = #dsm210ni@#2;
         |LEE 101#dsm210ni.=;
         |SI FSalida ! 0;
            |DDEFECTO #dsm210in;
            #dsm210ni#0 = #dspase27#3;
            #dsm210ni#1 = #dsm210ni@#1;
            #dsm210ni#2 = #dsm210ni@#2;
            |GRABA 020#dsm210ni.b;
         |FINSI;
         |PARA nCont = 3; |SI nCont [ 4; |HACIENDO nCont = nCont + 1;
            #dsm210ni#nCont# = #dsm210ni@#nCont#;
         |SIGUE;
         |GRABA 020#dsm210ni.a;  |LIBERA #dsm210ni;

         |LEE 000#dsm210ni@.s;
      |SIGUE;
   |SINO;
      |DDEFECTO #dsm210ni@;
   |FINSI;

   #dsm210ln@#0 = #dspase27#1;
   |LEE 000#dsm210ln@.];
   |SI FSalida = 0; |Y #dsm210ln@#0 = #dspase27#1;
      |PARA; |SI FSalida = 0; |Y #dsm210ln@#0 = #dspase27#1; |HACIENDO;
         #dsm210ln#0 = #dspase27#3;
         #dsm210ln#1 = #dsm210ln@#1;
         #dsm210ln#2 = #dsm210ln@#2;
         #dsm210ln#3 = #dsm210ln@#3;
         #dsm210ln#4 = #dsm210ln@#4;
         #dsm210ln#5 = #dsm210ln@#5;
         |LEE 101#dsm210ln.=;
         |SI FSalida ! 0;
            |DDEFECTO #dsm210ln;
            #dsm210ln#0 = #dspase27#3;
            #dsm210ln#1 = #dsm210ln@#1;
            #dsm210ln#2 = #dsm210ln@#2;
            #dsm210ln#3 = #dsm210ln@#3;
            #dsm210ln#4 = #dsm210ln@#4;
            #dsm210ln#5 = #dsm210ln@#5;
            |GRABA 020#dsm210ln.b;
         |FINSI;
         |PARA nCont = 6; |SI nCont [ 34; |HACIENDO nCont = nCont + 1;
            #dsm210ln#nCont# = #dsm210ln@#nCont#;
         |SIGUE;
         |GRABA 020#dsm210ln.a;  |LIBERA #dsm210ln;

         |LEE 000#dsm210ln@.s;
      |SIGUE;
   |SINO;
      |DDEFECTO #dsm210ln@;
   |FINSI;

   #dsm210fp@#0 = #dspase27#1;
   |LEE 000#dsm210fp@.];
   |SI FSalida = 0; |Y #dsm210fp@#0 = #dspase27#1;
      |PARA; |SI FSalida = 0; |Y #dsm210fp@#0 = #dspase27#1; |HACIENDO;
         #dsm210fp#0 = #dspase27#3;
         #dsm210fp#1 = #dsm210fp@#1;
         #dsm210fp#2 = #dsm210fp@#2;
         #dsm210fp#3 = #dsm210fp@#3;
         #dsm210fp#4 = #dsm210fp@#4;
         #dsm210fp#37 = #dsm210fp@#37;
         |LEE 101#dsm210fp.=;
         |SI FSalida ! 0;
            |DDEFECTO #dsm210fp;
            #dsm210fp#0 = #dspase27#3;
            #dsm210fp#1 = #dsm210fp@#1;
            #dsm210fp#2 = #dsm210fp@#2;
            #dsm210fp#3 = #dsm210fp@#3;
            #dsm210fp#4 = #dsm210fp@#4;
            #dsm210fp#37 = #dsm210fp@#37;
            |GRABA 020#dsm210fp.b;
         |FINSI;
         |PARA nCont = 5; |SI nCont [ 69; |HACIENDO nCont = nCont + 1;
            #dsm210fp#nCont# = #dsm210fp@#nCont#;
         |SIGUE;
         |GRABA 020#dsm210fp.a;  |LIBERA #dsm210fp;

         |LEE 000#dsm210fp@.s;
      |SIGUE;
   |SINO;
      |DDEFECTO #dsm210fp@;
   |FINSI;

   #dsm210hi@#0 = #dspase27#1;
   |LEE 000#dsm210hi@.];
   |SI FSalida = 0; |Y #dsm210hi@#0 = #dspase27#1;
      |PARA; |SI FSalida = 0; |Y #dsm210hi@#0 = #dspase27#1; |HACIENDO;
         #dsm210hi#0 = #dspase27#3;
         #dsm210hi#1 = #dsm210hi@#1;
         #dsm210hi#2 = #dsm210hi@#2;
         #dsm210hi#3 = #dsm210hi@#3;
         #dsm210hi#4 = #dsm210hi@#4;
         |LEE 101#dsm210hi.=;
         |SI FSalida ! 0;
            |DDEFECTO #dsm210hi;
            #dsm210hi#0 = #dspase27#3;
            #dsm210hi#1 = #dsm210hi@#1;
            #dsm210hi#2 = #dsm210hi@#2;
            #dsm210hi#3 = #dsm210hi@#3;
            #dsm210hi#4 = #dsm210hi@#4;
            |GRABA 020#dsm210hi.b;
         |FINSI;
         |PARA nCont = 5; |SI nCont [ 21; |HACIENDO nCont = nCont + 1;
            #dsm210hi#nCont# = #dsm210hi@#nCont#;
         |SIGUE;
         |GRABA 020#dsm210hi.a;  |LIBERA #dsm210hi;

         |LEE 000#dsm210hi@.s;
      |SIGUE;
   |SINO;
      |DDEFECTO #dsm210hi@;
   |FINSI;

   #dsm210h1@#0 = #dspase27#1;
   |LEE 000#dsm210h1@.];
   |SI FSalida = 0; |Y #dsm210h1@#0 = #dspase27#1;
      |PARA; |SI FSalida = 0; |Y #dsm210h1@#0 = #dspase27#1; |HACIENDO;
         #dsm210h1#0 = #dspase27#3;
         #dsm210h1#1 = #dsm210h1@#1;
         #dsm210h1#2 = #dsm210h1@#2;
         #dsm210h1#3 = #dsm210h1@#3;
         #dsm210h1#4 = #dsm210h1@#4;
         #dsm210h1#5 = #dsm210h1@#5;
         |LEE 101#dsm210h1.=;
         |SI FSalida ! 0;
            |DDEFECTO #dsm210h1;
            #dsm210h1#0 = #dspase27#3;
            #dsm210h1#1 = #dsm210h1@#1;
            #dsm210h1#2 = #dsm210h1@#2;
            #dsm210h1#3 = #dsm210h1@#3;
            #dsm210h1#4 = #dsm210h1@#4;
            #dsm210h1#5 = #dsm210h1@#5;
            |GRABA 020#dsm210h1.b;
         |FINSI;
         |PARA nCont = 6; |SI nCont [ 14; |HACIENDO nCont = nCont + 1;
            #dsm210h1#nCont# = #dsm210h1@#nCont#;
         |SIGUE;
         |GRABA 020#dsm210h1.a;  |LIBERA #dsm210h1;

         |LEE 000#dsm210h1@.s;
      |SIGUE;
   |SINO;
      |DDEFECTO #dsm210h1@;
   |FINSI;

   #dsm210h2@#0 = #dspase27#1;
   |LEE 000#dsm210h2@.];
   |SI FSalida = 0; |Y #dsm210h2@#0 = #dspase27#1;
      |PARA; |SI FSalida = 0; |Y #dsm210h2@#0 = #dspase27#1; |HACIENDO;
         #dsm210h2#0 = #dspase27#3;
         #dsm210h2#1 = #dsm210h2@#1;
         #dsm210h2#2 = #dsm210h2@#2;
         #dsm210h2#3 = #dsm210h2@#3;
         #dsm210h2#4 = #dsm210h2@#4;
         #dsm210h2#5 = #dsm210h2@#5;
         |LEE 101#dsm210h2.=;
         |SI FSalida ! 0;
            |DDEFECTO #dsm210h2;
            #dsm210h2#0 = #dspase27#3;
            #dsm210h2#1 = #dsm210h2@#1;
            #dsm210h2#2 = #dsm210h2@#2;
            #dsm210h2#3 = #dsm210h2@#3;
            #dsm210h2#4 = #dsm210h2@#4;
            #dsm210h2#5 = #dsm210h2@#5;
            |GRABA 020#dsm210h2.b;
         |FINSI;
         |PARA nCont = 6; |SI nCont [ 7; |HACIENDO nCont = nCont + 1;
            #dsm210h2#nCont# = #dsm210h2@#nCont#;
         |SIGUE;
         |GRABA 020#dsm210h2.a;  |LIBERA #dsm210h2;

         |LEE 000#dsm210h2@.s;
      |SIGUE;
   |SINO;
      |DDEFECTO #dsm210h2@;
   |FINSI;

   #dsm210h3@#0 = #dspase27#1;
   |LEE 000#dsm210h3@.];
   |SI FSalida = 0; |Y #dsm210h3@#0 = #dspase27#1;
      |PARA; |SI FSalida = 0; |Y #dsm210h3@#0 = #dspase27#1; |HACIENDO;
         #dsm210h3#0 = #dspase27#3;
         #dsm210h3#1 = #dsm210h3@#1;
         #dsm210h3#2 = #dsm210h3@#2;
         #dsm210h3#3 = #dsm210h3@#3;
         #dsm210h3#4 = #dsm210h3@#4;
         #dsm210h3#5 = #dsm210h3@#5;
         #dsm210h3#6 = #dsm210h3@#6;
         #dsm210h3#7 = #dsm210h3@#7;
         #dsm210h3#8 = #dsm210h3@#8;
         |LEE 101#dsm210h3.=;
         |SI FSalida ! 0;
            |DDEFECTO #dsm210h3;
            #dsm210h3#0 = #dspase27#3;
            #dsm210h3#1 = #dsm210h3@#1;
            #dsm210h3#2 = #dsm210h3@#2;
            #dsm210h3#3 = #dsm210h3@#3;
            #dsm210h3#4 = #dsm210h3@#4;
            #dsm210h3#5 = #dsm210h3@#5;
            #dsm210h3#6 = #dsm210h3@#6;
            #dsm210h3#7 = #dsm210h3@#7;
            #dsm210h3#8 = #dsm210h3@#8;
            |GRABA 020#dsm210h3.b;
         |FINSI;
         |PARA nCont = 9; |SI nCont [ 38; |HACIENDO nCont = nCont + 1;
            #dsm210h3#nCont# = #dsm210h3@#nCont#;
         |SIGUE;
         |GRABA 020#dsm210h3.a;  |LIBERA #dsm210h3;

         |LEE 000#dsm210h3@.s;
      |SIGUE;
   |SINO;
      |DDEFECTO #dsm210h3@;
   |FINSI;

   #dsm210h4@#0 = #dspase27#1;
   |LEE 000#dsm210h4@.];
   |SI FSalida = 0; |Y #dsm210h4@#0 = #dspase27#1;
      |PARA; |SI FSalida = 0; |Y #dsm210h4@#0 = #dspase27#1; |HACIENDO;
         #dsm210h4#0 = #dspase27#3;
         #dsm210h4#1 = #dsm210h4@#1;
         #dsm210h4#2 = #dsm210h4@#2;
         #dsm210h4#3 = #dsm210h4@#3;
         #dsm210h4#4 = #dsm210h4@#4;
         #dsm210h4#5 = #dsm210h4@#5;
         #dsm210h4#6 = #dsm210h4@#6;
         #dsm210h4#7 = #dsm210h4@#7;
         #dsm210h4#37 = #dsm210h4@#37;
         |LEE 101#dsm210h4.=;
         |SI FSalida ! 0;
            |DDEFECTO #dsm210h4;
            #dsm210h4#0 = #dspase27#3;
            #dsm210h4#1 = #dsm210h4@#1;
            #dsm210h4#2 = #dsm210h4@#2;
            #dsm210h4#3 = #dsm210h4@#3;
            #dsm210h4#4 = #dsm210h4@#4;
            #dsm210h4#5 = #dsm210h4@#5;
            #dsm210h4#6 = #dsm210h4@#6;
            #dsm210h4#7 = #dsm210h4@#7;
            #dsm210h4#37 = #dsm210h4@#37;
            |GRABA 020#dsm210h4.b;
         |FINSI;
         |PARA nCont = 8; |SI nCont [ 40; |HACIENDO nCont = nCont + 1;
            #dsm210h4#nCont# = #dsm210h4@#nCont#;
         |SIGUE;
         |GRABA 020#dsm210h4.a;  |LIBERA #dsm210h4;

         |LEE 000#dsm210h4@.s;
      |SIGUE;
   |SINO;
      |DDEFECTO #dsm210h4@;
   |FINSI;
|FPRC;

|PROCESO PasaExtranjeros;
   |SI #dspase27#5 = "N"; |ACABA; |FINSI;

   #dsm210dp@#0 = #dspase27#1;
   |LEE 000#dsm210dp@.=;
   |SI FSalida = 0;
      #dsm210dp#0 = #dspase27#3;
      |LEE 101#dsm210dp.=;
      |SI FSalida ! 0;
         |DDEFECTO #dsm210dp;
         #dsm210dp#0 = #dspase27#3;
         |GRABA 020#dsm210dp.b;
      |FINSI;
      |PARA nCont = 1; |SI nCont [ 62; |HACIENDO nCont = nCont + 1;
         #dsm210dp#nCont# = #dsm210dp@#nCont#;
      |SIGUE;
      |PARA nCont = 64; |SI nCont [ 101; |HACIENDO nCont = nCont + 1;
         nCalc = nCont - 1;
         #dsm210dp#nCont# = #dsm210dp@#nCalc#;
      |SIGUE;
      |GRABA 020#dsm210dp.a; |LIBERA #dsm210dp;
   |FINSI;

   #dsm210db@#0 = #dspase27#1;
   |LEE 000#dsm210db@.=;
   |SI FSalida = 0;
      #dsm210db#0 = #dspase27#3;
      |LEE 101#dsm210db.=;
      |SI FSalida ! 0;
         |DDEFECTO #dsm210db;
         #dsm210db#0 = #dspase27#3;
         |GRABA 020#dsm210db.b;
      |FINSI;
      |PARA nCont = 1; |SI nCont [ 50; |HACIENDO nCont = nCont + 1;
         #dsm210db#nCont# = #dsm210db@#nCont#;
      |SIGUE;
      |GRABA 020#dsm210db.a;  |LIBERA #dsm210db;
   |SINO;
      |DDEFECTO #dsm210db@;
   |FINSI;

   |SI #dspase27#7 = "S"; |HAZ PasaAIntegral; |FINSI;

   |HAZ PasaModelo210;
|FPRC;

|DEFBUCLE PasaExtranjeros;
#dspase27#1;
;
INICIO;
FINAL;
;
NULL, PasaExtranjeros;
|FIN;

|PROGRAMA;
     |ABRE #100;
     |LEE 040#100p;
     |SI FSalida ! 0;
         |MENAV "     Pase de Ficheros Generales no Realizado";
         |CIERRA #100;
         |ACABA;
     |FINSI;
     |CIERRA #100;

     |ABRE #115;
     |LEE 040#115p;
     |SI FSalida ! 0;
         |DDEFECTO #115;
     |SINO;
         |SI #115#15 ! "S";
             |MENAV "      Unificacion de Codigos no Realizada.";
             |CIERRA #115;
             |ACABA;
         |FINSI;
     |FINSI;
     |CIERRA #115;

     |HAZ BusquedaApli;

     eaPathDsmodelo = eaPathDsmodelo + "fich/";
     eaPathAnterior   = #100#0; |QBT eaPathAnterior;
     eaPathDefFiscal  = eaPathAnterior + "agieos/def/";
     eaPathFichFiscal = eaPathAnterior + "agieos/fich/";

     aAlfa = "tm" + Usuario; |NOME_DAT #dspase27#aAlfa#;
     |DELINDEX #dspase27; |ABRE #dspase27;

     |PATH_DAT #dsm210dp#eaPathDsmodelo#; |ABRE #dsm210dp;
     |PATH_DAT #dsm210ca#eaPathDsmodelo#; |ABRE #dsm210ca;
     |PATH_DAT #dsm210ni#eaPathDsmodelo#; |ABRE #dsm210ni;
     |PATH_DAT #dsm210in#eaPathDsmodelo#; |ABRE #dsm210in;
     |PATH_DAT #dsm210ln#eaPathDsmodelo#; |ABRE #dsm210ln;
     |PATH_DAT #dsm210fp#eaPathDsmodelo#; |ABRE #dsm210fp;
     |PATH_DAT #dsm210db#eaPathDsmodelo#; |ABRE #dsm210db;
     |PATH_DAT #dsm210hi#eaPathDsmodelo#; |ABRE #dsm210hi;
     |PATH_DAT #dsm210h1#eaPathDsmodelo#; |ABRE #dsm210h1;
     |PATH_DAT #dsm210h2#eaPathDsmodelo#; |ABRE #dsm210h2;
     |PATH_DAT #dsm210h3#eaPathDsmodelo#; |ABRE #dsm210h3;
     |PATH_DAT #dsm210h4#eaPathDsmodelo#; |ABRE #dsm210h4;

     aAlfa = eaPathIntegral; |QBF aAlfa;
     aAlfa = aAlfa + "fich/";
     |PATH_DAT #dsam0000#aAlfa#; |PATH_DAT #dsam0115#aAlfa#;
     |PATH_DAT #dsam0116#aAlfa#; |PATH_DAT #dsam0104#aAlfa#;

     |ABRE #dsam0000; |SELECT #3#dsam0000;
     |ABRE #dsam0003; |ABRE #dsam0005;

     |HAZ CargaDef; |SI nSwCargaDef < 0; |ACABA; |FINSI;

     |PINPA #0#0; nPant = FSalida;
     |PINDA #0#0;

     nPos1 = 2403;  nPos2 = 2450;
     |CONTROL_SIMPLE nPant, "LABEL,{{13}}Doble click para marcar/desmarcar", nPos1, nPos2, NULL;
     nLabel = FSalida;

     nPos1 = 2478;  nPos2 = 2498;
     |CONTROL_SIMPLE nPant, "BOTON,{{197}}Cambiar codigo", nPos1, nPos2, CambiaCodigo;
     nBoton1 = FSalida;

     nRango = 4 + 8 + 16 + 32;
     nPos1 = 0802;  nPos2 = 2298;
     |LINEAL_SIMPLE #1#dspase27, nRango, nPos1, nPos2, NULL, NULL, EvtoGrid1;
     nGrid1 = FSalida;

     |BUCLE RecogeCtrREO;
     |SELECT #1#dsam0000;

     |SI FSalida = 0;
        |DESTRUYECONTROL nGrid1;

        |LINEAL_SIMPLE #1#dspase27, nRango, nPos1, nPos2, NULL, NULL, EvtoGrid1;
        nGrid1 = FSalida;

        aEsc1  = &255 + "806";
        aEsc2  = &255 + "807";
        aRetu  = &255 + "802";
        |PARA; |SI;  |HACIENDO;
           FSalida = "::{{001}}Salir," + nGrid1;
           |LEETECLA aTecla;
           |SI aTecla = aEsc1; |SAL; |FINSI;
           |SI aTecla = aEsc2; |SAL; |FINSI;
           |SI aTecla = aRetu; |SAL; |FINSI;
        |SIGUE;
     |FINSI;

     nSw = 0;
     aAlfa = "    N" + &191 + " Conforme con los datos editados ? ";
     |CONFI aAlfa;
     |SI FSalida = 0;
        |ABRE #dsam0115; |SELECT #3#dsam0115;
        |ABRE #dsam0116; |SELECT #2#dsam0116;
        |ABRE #dsam0104;
        |BUCLE PasaExtranjeros;
        |CIERRA #dsam0104;
        |SELECT #1#dsam0115; |CIERRA #dsam0115;
        |SELECT #1#dsam0116; |CIERRA #dsam0116;
        nSw = 1;
     |FINSI;

     |CIERRA #dsm210dp; |CIERRA #dsm210ca;
     |CIERRA #dsm210ni; |CIERRA #dsm210in;
     |CIERRA #dsm210ln; |CIERRA #dsm210fp;
     |CIERRA #dsm210db; |CIERRA #dsm210hi;
     |CIERRA #dsm210h1; |CIERRA #dsm210h2;
     |CIERRA #dsm210h3; |CIERRA #dsm210h4;

     |SI nSwCargaDef ] 0; |HAZ DescargaDef; |FINSI;
     |CIERRA #dsam0005;
     |CIERRA #dsam0003; |CIERRA #dsam0000;

     |SI nSw = 1; |HAZ SegundaParte; |FINSI;
     |DESTRUYECONTROL nGrid1;
     ||FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nLabel;

     |CIERRA #dspase27; |DELINDEX #dspase27;
|FPRO;
