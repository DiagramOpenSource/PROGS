|FICHEROS;
     agim0021 #0;

    &regisnif@ #709;
|FIN;

|VARIABLES;
     &Cliente   = 0;
     &Registro  = 0;
     &Modo      = 0;
     &eaVarDni  = "";
     &enCalcCif = 0;
     &eaCodNif  = "";
|FIN;

|PROCESO LetraDni021;  |TIPO 6;
     |SI FSalida = 10;
         eaVarDni  = #0Campo;
         enCalcCif = 1;
         |HAZ CalculoDNI;
         #0Campo = eaVarDni;
         |PINTA #0Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #0Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 112;
     |SI #0Campo ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #0Campo = eaVarDni;  |PINTA #0Campo;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO PonDatos;
     eaCodNif  = #0#3;
     |HAZ LeeNifs;

     #0#6  = #709#1;  |PINTA #0#6;
|FPRC;

|RUTINA ClaveBaja0;
    #0#0 = Cliente;
    #0#1 = Registro;
    #0#2 = 1;
|FRUT;

|RUTINA ClaveAlta0;
    #0#0 = Cliente;
    #0#1 = Registro;
    #0#2 = 99;
|FRUT;

|PROGRAMA;
     |SI Modo ! 4;
         |ENTLINEAL #1#0 , -3, 2, 22, 1, ClaveBaja0, ClaveAlta0;
     |SINO;
         |ENTLINEAL #1#0 , -3, 4, 22, 1, ClaveBaja0, ClaveAlta0;
     |FINSI;
|FPRO;

|PROCESO Mayus;
     #0Campo = #0Campo > #0Campo;
     |PINTA #0Campo;
|FPRC;
