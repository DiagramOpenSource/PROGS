|FICHEROS;
     dscambre;

     &referen@;
     &refesql@;
|FIN;

|VARIABLES;
     nDClave1        = 0;
     nHClave1        = 0;
     nDClave2        = 0;
     nHClave2        = 0;
     nDClave3        = 0;
     nHClave3        = 0;
     nDClave4        = 0;
     nHClave4        = 0;
     nDClave5        = 0;
     nHClave5        = 0;
     nDClave6        = 0;
     nHClave6        = 0;
     nDClave7        = 0;
     nHClave7        = 0;
     nCampo          = 0;
     nContador       = 0;

     nCampoClave     = 0;
     nCampo1         = 0;
     nCampo2         = 0;
     nCampo3         = 0;
     nClave          = 0;
     nPosClave       = 0;
     nDEmpresa       = 0;
     nHEmpresa       = 0;
     nCampoDef       = 0;
     nTCampo         = 0;
     nCampoCli       = 0;

     aAlfa           = "";
     aAlfa1          = "";
     aAlfa2          = "";
     aAlfa3          = "";
     aDAlfa1         = "";
     aHAlfa1         = "";
     aDAlfa2         = "";
     aHAlfa2         = "";
     aDAlfa3         = "";
     aHAlfa3         = "";
     aDAlfa4         = "";
     aHAlfa4         = "";
     aDAlfa5         = "";
     aHAlfa5         = "";
     aDAlfa6         = "";
     aHAlfa6         = "";
     aDAlfa7         = "";
     aHAlfa7         = "";
     aIPRemoto       = "";
     aPath           = "";
     aTipoBucle      = "";
     aOrigen         = "";
     aDestino        = "";
     aAplica         = "";
     aMaximo         = "";
     aMinimo         = "";
     aBase           = "";
     aDir            = "";
     aDirecBuscar    = "";
     aDirFichDestino = "";
     aQueQuiero      = "";
     aCampo          = "";
     aBaseAqui       = "";
     aBorrar         = "";
     aDef            = "";
     aFichero        = "";
     aSelect         = "";
     aFrom           = "";
     aInto           = "";
     aWhere          = "";
     aFichSql        = "";
     aFich           = "";
     aPassword       = "";

     &enBajaCli      = 0;
     &enCambioCli    = 0;
     &enDeFuera      = 0;
     &enEmpresa      = 0;
     &enEmpresaN     = 0;
     &enEmpFac       = -1;

     &eaPathBasica   = "";
     &eaPathContagen = "";
     &eaPathContanex = "";
     &eaPathContasoc = "";
     &eaPathRen2018  = "";
     &eaPathRen2017  = "";
     &eaPathRen2016  = "";
     &eaPathRen2015  = "";
     &eaPathRen2014  = "";
     &eaPathRen2013  = "";
     &eaPathRen2012  = "";
     &eaPathRen2011  = "";
     &eaPathRen2010  = "";
     &eaPathRen2009  = "";
     &eaPathRen2008  = "";
     &eaPathRen2007  = "";
     &eaPathRen2006  = "";
     &eaPathRen2005  = "";
     &eaPathRen2004  = "";
     &eaPathRen2003  = "";
     &eaPathRen2002  = "";
     &eaPathRen2001  = "";
     &eaPathRen2000  = "";
     &eaPathRen1999  = "";
     &eaPathRen1998  = "";
     &eaPathRen1997  = "";
     &eaPathRen1996  = "";
     &eaPathRen1995  = "";
     &eaPathRen1994  = "";
     &eaPathFacturar = "";
     &eaPathLaboral  = "";
     &eaPathIntegral = "";
     &eaPathDsmodelo = "";
     &eaPathFiscal   = "";

     &eaPasaCact     = "";
     &eaPasaNuct     = "";
     &eaPasaCont     = "";
     &eaPasaFisc     = "";
     &eaPasaSoci     = "";
     &eaPasaRent     = "";
     &eaPasaLabo     = "";
     &eaPasaFact     = "";
     &eaPasaMaes     = "";
     &eaPasaArch     = "";
     &eaPasaR2000    = "";
     &eaPasaR1999    = "";
     &eaPasaR1998    = "";
     &eaPasaR1997    = "";
     &eaPasaR1996    = "";
     &eaPasaR1995    = "";
     &eaPasaR1994    = "";
     &eaPasaR2001    = "";
     &eaPasaR2002    = "";
     &eaPasaR2003    = "";
     &eaPasaR2004    = "";
     &eaPasaR2005    = "";
     &eaPasaR2006    = "";
     &eaPasaR2007    = "";
     &eaPasaR2008    = "";
     &eaPasaR2009    = "";
     &eaPasaR2010    = "";
     &eaPasaR2011    = "";
     &eaPasaR2012    = "";
     &eaPasaR2013    = "";
     &eaPasaR2014    = "";
     &eaPasaR2015    = "";
     &eaPasaR2016    = "";
     &eaPasaR2017    = "";
     &eaPasaR2018    = "";

     &aPathFich      = "";
     &eaEjec         = "";
|FIN;

|PROCESO PorLectura;
     aDef = aPath + "def/" + aFichero;
     |CARGA_DEF aDef, referen@;
     |SI FSalida ! 0;
         |ACABA;
     |FINSI;

     aQueQuiero = "|NC";
     aCampo     = #referen@#aQueQuiero#;
     nTCampo    = aCampo;
     nTCampo    = nTCampo - 1;

     |PATH_DAT #referen@#aPathFich#;

     |DBASE aBaseAqui;   |QBF aBaseAqui;

     aFichSql = ("sql" + Usuario + "zzzzzzzz") % 108;

     aOrigen  = aDef;
     aDestino = aBaseAqui + "def/dsborsql.mas";
     |COPIA_FICHERO aOrigen, aDestino;
     aFich    = aBaseAqui + "fich/";

     |CARGA_DEF aDestino, refesql@;
     |SI FSalida = 0;
         |PATH_DAT #refesql@#aFich#;
         |NOME_DAT #refesql@#aFichSql#;

         aSelect = "SELECT * ";
         aFrom   = "FROM "  + "dsborsql ";
         aInto   = "INTO "  + aFichSql + ".def ";
         aWhere  = "WHERE " + nCampoCli + " == " + #dscambre#0;
         eaEjec  =  aSelect + aFrom + aInto + aWhere;
         |SUB_EJECUTA_NP "dsborra1;NOMEQUITESQUETECORTOLOSGUEVOS";

         |ABRET #referen@;
         |ABRET #refesql@;
         |LEE 040#refesql@.p;
         |PARA;  |SI FSalida = 0;  |HACIENDO;
              |PARA nCampoDef = 0;  |SI nCampoDef [ nTCampo;  |HACIENDO nCampoDef = nCampoDef + 1;
                    #referen@#nCampoDef# = #refesql@#nCampoDef#;
              |SIGUE;

              |LEE 101#referen@.=;
              |SI FSalida = 0;
                 |SALVA_DATOS #referen@;

                 #referen@#0 = #dscambre#1;
                 |GRABA 000#referen@.n;

                 |REPON_DATOS #referen@;
                 |LIBERA #referen@;
                 |LEE 101#referen@.=;
                 |BORRA 000#referen@.a;
                 |LIBERA #referen@;
              |FINSI;

              |LEE 040#refesql@.s;
          |SIGUE;
          |CIERRAT #referen@;
          |CIERRAT #refesql@;

          |DELINDEX #refesql@;

          |DESCARGA_DEF #refesql@;
     |FINSI;

     aBorrar = aBaseAqui + "def/" + aFichSql  + ".mas";  |FBORRA aBorrar;
     aBorrar = aBaseAqui + "def/" + "dsborsql.mas";      |FBORRA aBorrar;

     aOrigen  = aBaseAqui + "def/dsborsq1.mas";
     aDestino = aBaseAqui + "def/dsborsql.mas";
     |COPIA_FICHERO aOrigen, aDestino;

     |PULSATECLA;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;
     |CUADRO 0501 2380;
     |BLANCO 0602 2279;
     |PINTA 1320, "Introduzca Password : ";
     E_inf = "";
     E_sup = "21";
     aPassword = 1342 ? -1;
     |SI aPassword ! "mefaltanficheros     ";
         |MENAV "     Permiso denegado.";
         |ACABA;
     |FINSI;

     |DBASS aPath;  |QBF aPath;
     aPath     = aPath + "modelos/";
     aPathFich = aPath + "fich/";

     aFichero = "dsm190li.mas";  |HAZ PorLectura;
     aFichero = "dsmoc110.mas";  |HAZ PorLectura;
     aFichero = "dsmoc115.mas";  |HAZ PorLectura;
     aFichero = "dsmoc123.mas";  |HAZ PorLectura;
     aFichero = "dsmoc349.mas";  |HAZ PorLectura;
     aFichero = "dsmociva.mas";  |HAZ PorLectura;
|FPRC;
