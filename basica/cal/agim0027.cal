|FICHEROS;
     agim0027;
     agiw0111,MANTE;

     &regisnif@;
|FIN;

|VARIABLES;
     &Cliente   = 0;
     &Registro  = 0;
     &Modo      = 0;
     &eaVarDni  = "";
     &enCalcCif = 0;
     &eaCodNif  = "";
     nModo      = 0;
     aTecla     = "";
|FIN;

|PROCESO LetraDni027;  |TIPO 6;
     |SI FSalida = 10;
         eaVarDni  = #agim0027#Campo#;
         enCalcCif = 1;
         |HAZ CalculoDNI;
         #agim0027#Campo# = eaVarDni;
         |PINTA #agim0027#Campo#;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #agim0027#Campo#;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 112;
     |SI #agim0027#Campo# ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #agim0027#Campo# = eaVarDni;  |PINTA #agim0027#Campo#;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO PonDatos;
     eaCodNif  = #agim0027#3;
     |HAZ LeeNifs;

     #agim0027#4  = #regisnif@#1;  |PINTA #agim0027#4;
|FPRC;

|PROCESO maempw00;
     #agiw0111#0  = #agim0027#2;
     #agiw0111#1  = #agim0027#3;
     #agiw0111#2  = #agim0027#4;
     #agiw0111#3  = #agim0027#8;
     #agiw0111#4  = #agim0027#9;
     #agiw0111#5  = #agim0027#10;
     #agiw0111#6  = #agim0027#11;
     #agiw0111#7  = #agim0027#20;
     #agiw0111#8  = #agim0027#12;
     #agiw0111#9  = #agim0027#13;
     #agiw0111#10 = #agim0027#16;
     #agiw0111#11 = #agim0027#17;
     #agiw0111#12 = #agim0027#18;
     #agiw0111#13 = #agim0027#19;
     #agiw0111#14 = #agim0027#21;
     #agiw0111#15 = #agim0027#22;
     #agiw0111#16 = #agim0027#23;

     |PUSHV 0501 2380;
     |PINPA #0#agiw0111;
     |PINDA #0#agiw0111;

     |SI nModo ! 4;
         |ENDATOS #2#agiw0111;
         #agim0027#8  = #agiw0111#3;
         #agim0027#9  = #agiw0111#4;
         #agim0027#10 = #agiw0111#5;
         #agim0027#11 = #agiw0111#6;
         #agim0027#20 = #agiw0111#7;
         #agim0027#12 = #agiw0111#8;
         #agim0027#13 = #agiw0111#9;
         #agim0027#16 = #agiw0111#10;
         #agim0027#17 = #agiw0111#11;
         #agim0027#18 = #agiw0111#12;
         #agim0027#19 = #agiw0111#13;
         #agim0027#21 = #agiw0111#14;
         #agim0027#22 = #agiw0111#15;
         #agim0027#23 = #agiw0111#16;
     |SINO;
         |LEETECLA aTecla;
     |FINSI;

     |POPV;
|FPRC;

|PROCESO CamposNuevos;
     nModo = (FEntrada / 100) ! 0;
     |HAZ maempw00;
|FPRC;


|PROCESO Des2_27; |TIPO 11;
  |SI FSalida = 10;
      nModo = (FEntrada / 100) ! 0;
      |SI nModo ! 1;
          nModo = 4;
          |HAZ maempw00;
      |FINSI;
      |ERROR;
  |FINSI;
|FPRC;

|RUTINA ClaveBaja0;
  #agim0027#0 = Cliente;
  #agim0027#1 = Registro;
  #agim0027#2 = 1;
|FRUT;

|RUTINA ClaveAlta0;
  #agim0027#0 = Cliente;
  #agim0027#1 = Registro;
  #agim0027#2 = 99;
|FRUT;

|PROGRAMA;
  |SI Modo ! 4;
      |ENTLINEAL #1#agim0027, -3, 2, 22, 1, ClaveBaja0, ClaveAlta0;
  |SINO;
      |ENTLINEAL #1#agim0027, -3, 4, 22, 1, ClaveBaja0, ClaveAlta0;
  |FINSI;
|FPRO;
