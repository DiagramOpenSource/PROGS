|FICHEROS;
    agicen06 #6;
    agiw0001 #98;

    &clientes@ #715;
|FIN;

|VARIABLES;
     &enEmpresa   = 0;
     &enActividad = 0;
     &enContador  = 0;
     &enTipo      = 0;
     &eaNombreEmp = "";
     &eaNombreAct = "";
     &eaVarDni    = "";
     &enCalcCif   = 0;
     &enSwDeDonde = 0;
     &enCodCli    = 0;

     nCampo       = 0;
     nLinea       = 0;
     nForma       = 0;
     nModo        = 0;
     nContenido   = 0;
|FIN;

|PROCESO NombreRepre;
     |HAZ LeeNifs;     || Esto no haze n  pero quien lo toque
                       || los corto lo guevos  PARAQUITAR
|FPRC;

|PROCESO LetraDniCen06;  |TIPO 6;
     |SI FSalida = 10;
         eaVarDni  = #6Campo;
         enCalcCif = 1;
         |HAZ CalculoDNI;
         #6Campo = eaVarDni;
         |PINTA #6Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #6Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 112;
     |SI #6Campo ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #6Campo = eaVarDni;  |PINTA #6Campo;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Contenido;  |TIPO 6;
     nContenido = Contenido;
|FPRC;

|PROCESO LeeCliente;  |TIPO 0;
     |SI nContenido ! #6Campo;
         |ABRE #715;
         #715#0 = nContenido;
         |LEE 101#715=;
         |SI FSalida = 0;
             |SI enSwDeDonde = 1;
                 #715#13 = 0;
                 #715#14 = "";
                 #715#11 = 0;
             |SINO;
                 #715#90 = 0;
                 #715#89 = 0;
             |FINSI;
             |GRABA 020#715a;
             |LIBERA #715;
             |CIERRA #715;
         |FINSI;
     |FINSI;

     enCodCli = #6#22;
     |HAZ LeePersona;
     |SI enSwDeDonde = 1;
         #6#3   = #715#3;               || Nif
         #6#4   = #715#1;               || Apellidos y Nombre
         #6#6   = #715#11;              || % Participacion
         #6#10  = #715#19;              || SG
         #6#11  = #715#20;              || Calle
         #6#12  = #715#21;              || Numero
         #6#13  = #715#22;              || Escalera
         #6#14  = #715#23;              || Piso
         #6#15  = #715#24;              || Puerta
         #6#16  = #715#54;              || Telefono
         #6#17  = #715#25;              || Codigo Provincia
         #6#18  = #715#26;              || Codigo Poblacion
         #6#19  = #715#27;              || Municipio
         #6#20  = #715#28;              || Provincia
     |SINO;
         #6#3   = #715#13;             || Nif
         #6#4   = #715#1;              || Apellidos y Nombre
         #6#10  = #715#3;              || SG
         #6#11  = #715#4;              || Calle
         #6#12  = #715#5;              || Numero
         #6#13  = #715#6;              || Escalera
         #6#14  = #715#7;              || Piso
         #6#15  = #715#8;              || Puerta
         #6#16  = #715#14;             || Telefono
         #6#17  = #715#9;              || Codigo Provincia
         #6#18  = #715#10;             || Codigo Poblacion
         #6#19  = #715#11;             || Municipio
         #6#20  = #715#12;             || Provincia
      |FINSI;
      |PINTA #6#3;
      |PINTA #6#4;
|FPRC;

|PROCESO Fantasma;
     |PUSHV 0501 2380;
     |PINPA #0#98;

     |PARA nCampo = 5; |SI nCampo [ 20; |HACIENDO nCampo = nCampo + 1;
           #98nCampo = #6nCampo;
     |SIGUE;
     |PINDA #0#98;

     |ENDATOS #2#98;
     |SI FSalida = 0;
         |PARA nCampo = 5; |SI nCampo [ 20; |HACIENDO nCampo = nCampo + 1;
               #6nCampo = #98nCampo;
         |SIGUE;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO Tipo2Cen06;  |TIPO 2;
     nModo = (FEntrada / 100) ! 0;

     nForma = 0 +. 1;
     |SI nForma = 1;
         |HAZ Fantasma;

         |ABRE #715;
         #715#0 = #6#22;
         |LEE 101#715=;
         |SI FSalida = 0;
             |SI enSwDeDonde = 1;
                 #715#13 = #6#0;
                 #715#14 = eaNombreEmp;
                 #715#11 = #6#6;
             |SINO;
                 #715#90 = #6#0;
                 #715#89 = #6#6;
             |FINSI;
             |GRABA 020#715a;
             |LIBERA #715;
             |CIERRA #715;
         |FINSI;
    |SINO;
         |SI nModo ! 3;  |ACABA;  |FINSI;

         |ABRE #715;
         #715#0 = #6#22;
         |LEE 101#715=;
         |SI FSalida = 0;
             |SI enSwDeDonde = 1;
                 #715#13 = 0;
                 #715#14 = "";
                 #715#11 = 0;
             |SINO;
                 #715#90 = 0;
                 #715#89 = 0;
             |FINSI;
             |GRABA 020#715a;
             |LIBERA #715;
         |FINSI;
         |CIERRA #715;
     |FINSI;
|FPRC;

|PROCESO GrabaParticipes1;
     nLinea = nLinea + 1;
     #6#0   = enEmpresa;            || Empresa
     #6#1   = enContador;           || Contador
     #6#2   = nLinea;               || N§ Participe
     #6#3   = #715#3;               || Nif
     #6#4   = #715#1;               || Apellidos y Nombre
     #6#6   = #715#11;              || % Participacion
     #6#10  = #715#19;              || SG
     #6#11  = #715#20;              || Calle
     #6#12  = #715#21;              || Numero
     #6#13  = #715#22;              || Escalera
     #6#14  = #715#23;              || Piso
     #6#15  = #715#24;              || Puerta
     #6#16  = #715#54;              || Telefono
     #6#17  = #715#25;              || Codigo Provincia
     #6#18  = #715#26;              || Codigo Poblacion
     #6#19  = #715#27;              || Municipio
     #6#20  = #715#28;              || Provincia
     #6#22  = #715#0;               || Codigo Cliente
     |GRABA 020#6n;
     |LIBERA #6;
|FPRC;

|DEFBUCLE DesdeIntegra;
     #715#1001;
     13;
     00000, enEmpresa;
     99999, enEmpresa;
     ;
     NULL, GrabaParticipes1;
|FIN;

|PROCESO GrabaParticipes0;
     nLinea = nLinea + 1;
     #6#0   = enEmpresa;           || Empresa
     #6#1   = enContador;          || Contador
     #6#2   = nLinea;              || N§ Participe
     #6#3   = #715#13;             || Nif
     #6#4   = #715#1;              || Apellidos y Nombre
     #6#10  = #715#3;              || SG
     #6#11  = #715#4;              || Calle
     #6#12  = #715#5;              || Numero
     #6#13  = #715#6;              || Escalera
     #6#14  = #715#7;              || Piso
     #6#15  = #715#8;              || Puerta
     #6#16  = #715#14;             || Telefono
     #6#17  = #715#9;              || Codigo Provincia
     #6#18  = #715#10;             || Codigo Poblacion
     #6#19  = #715#11;             || Municipio
     #6#20  = #715#12;             || Provincia
     #6#22  = #715#0;              || Codigo Cliente
     |GRABA 140#6n;
     |LIBERA #6;
|FPRC;

|DEFBUCLE DesdeModulo;
     #715#1001;
     90;
     00000, enEmpresa;
     99999, enEmpresa;
     ;
     NULL, GrabaParticipes0;
|FIN;

|RUTINA ClaveBaja6;
     |SI FSalida = "POSICION";
         nLinea = 0;
         |ABRE #6;
         #6#0  = enEmpresa;
         #6#1  = enContador;
         #6#2  = 1;
         |LEE 040#6];
         |SI FSalida ! 0; |O #6#0 ! enEmpresa; |O #6#1 ! enContador;

             |SI enSwDeDonde = 1;
                 |BUCLE DesdeIntegra;
             |SINO;
                 |BUCLE DesdeModulo;
             |FINSI;
         |FINSI;
         |CIERRA #6;
     |FINSI;

     #6#0  = enEmpresa;
     #6#1  = enContador;
     #6#2  = 1;
|FRUT;

|RUTINA ClaveAlta6;
     #6#0  = enEmpresa;
     #6#1  = enContador;
     #6#2  = 99;
|FRUT;

|PROGRAMA;
     enCodCli = enEmpresa;
     |HAZ LeePersona;

     |ENTLINEAL #1#6, -3, 1, 21, 1, ClaveBaja6, ClaveAlta6;
|FPRO;
