|FICHEROS;
     agiz0008 #0;         || Este Def
     agim0008 #1,MANTE;   || Mantenimiento de Visitas

     &usuarios@ #712;
     &clientes@ #715;
|FIN;

|VARIABLES;
     nModo  = 0;

     &eaCodUsu = "";
     &enCodCli = 0;
|FIN;

|RUTINA ClaveBaja1;
  #1#0 = #0#0;
  #1#1 = #0#1;
  #1#2 = 0;
  #1#3 = 0;
|FRUT;

|RUTINA ClaveAlta1;
  #1#0 = #0#0;
  #1#1 = #0#1;
  #1#2 = 23;
  #1#3 = 59;
|FRUT;

|PROCESO Tipo3; |TIPO 3;
  |PINPA #0#1;
  |ENTLINEAL #1#1, -3, 2, 22, 0, ClaveBaja1, ClaveAlta1;
|FPRC;

|| ************************************************************************
||                     PROCESO DEL FICHERO AGIM0008
|| ************************************************************************

|PROCESO PintaUsuario;
     eaCodUsu = #1#1;
     |HAZ LeeUsuario;

     #1#4 = #712#1;
     |PINTA #1#4;
|FPRC;

|PROCESO PintaCliente;
     enCodCli = #1#5;
     |HAZ LeePersona;

     #1#6 = #715#1;
     |PINTA #1#6;
|FPRC;

|PROCESO Cliente; |TIPO 0;
  |C_M #1#6, 1, "N";
  |SI #1#5 = 0; |C_M #1#6, 1, "S"; |FINSI;
|FPRC;

|PROCESO GrabaTempo;
     #0#0 = #1#0;
     #0#1 = #1#1;
     |LEE 101#0=;
     |SI FSalida ! 0;
         #0#0 = #1#0;
         #0#1 = #1#1;
         |GRABA 020#0n;
     |FINSI;
     |LIBERA #0;
|FPRC;

|DEFBUCLE agim0008;
     #1#1;
     ;
     "01.01.0000", "          ", 00, 00;
     "31.12.2999", "zzzzzzzzzz", 99, 99;
     ;
     NULL, GrabaTempo;
|FIN;

|PROCESO Tipo7z0008;  |TIPO 7;
     |PTEC 807;
     |ENTLINEAL #1#1, -3, 4, 22, 0, ClaveBaja1, ClaveAlta1;
|FPRC;

|PROCESO BorraVisita;
     |BORRA 101#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE agim0008B;
     #1#1;
     ;
     #0#0, #0#1, 00, 00;
     #0#0, #0#1, 99, 99;
     ;
     NULL, BorraVisita;
|FIN;

|PROCESO Tipo2z0008;  |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
         |BUCLE agim0008B;
     |FINSI;
|FPRC;

|RUTINA ClaveBaja0;
     #0#0 = "01.01.0000";
     #0#1 = "          ";
|FRUT;

|RUTINA ClaveAlta0;
     #0#0 = "31.12.2999";
     #0#1 = "zzzzzzzzzz";
|FRUT;

|PROGRAMA;
     |ABRE #0
     |LEE 040#0p;
     |SI FSalida ! 0;
         |BUCLE agim0008;
     |FINSI;
     |CIERRA #0;

     |CABEZA "Visitas";
     |ENTLINEAL #1#0, -1, 1, 22, 1, ClaveBaja0, ClaveAlta0;
|FPRO;
