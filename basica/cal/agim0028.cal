|FICHEROS;
     agim0028 #0;           || Este def
     agim0019 #1,MANTE;     || Acceso Registros
     agiw0027 #2,MANTE;     || Ayuda Datos Notaria
     agiw0028 #3,MANTE;     || Ayuda Datos Registro
     agiw0034 #4,MANTE;     || Ayuda Datos Escritura
     agiw0036 #5,MANTE;     || Ayuda Datos Complementarios Escritura
     agiw0040 #6,MANTE;     || Ayuda Datos Grupo
     agiw0041 #7,MANTE;     || Estado Cuentas
     agiw0042 #8,MANTE;     || Datos generales
     agim0020 #9;           || Caracteres de la Declaracion

     agim0021 #21;          || Transparencia Fiscal Relacion Socios
     agim0022 #22;          || Transparencia Fiscal Internacional Cabecera
     agim0023 #23;          || Transparencia Fiscal Internacional Linea
     agim0004 #104;         || Representantes / Administradores
     agim0024 #24;          || Representantes / Administradores
     agim0025 #25;          || Socios
     agim0058 #58;          || Titularidad Real

     agim0026 #26;          || Cargos
     agim0027 #27;          || Participaciones otras Empresas
     agim0037 #37;          || Acciones Numeradas
     agim0038 #38;          || Acciones Propias T1
     agim0039 #39;          || acciones Propias T1
     agim0040 #40;          || acciones Propias T2
     agim0041 #41;          || acciones Propias T3
     agim0042 #42;          || acciones Propias T4
     agim0043 #43;          || acciones Propias T5
     agim0044 #44;          || acciones Propias T6
     agim0045 #45;          || acciones Propias T7
     agim0046 #46;          || acciones Propias TC
     agim0049 #49;          || Objeto Social
     agim0056 #56;          || Registro Mercantil
     :/contagen/def/ca8m0000 #420;

     agifigen #100;
     agicen14 #106;

     &clientes@ #715;
|FIN;

|VARIABLES;

      nEjercicio1 = 0;
      nEjercicio2 = 0;
      Path      = "";
      PathFich  = "";
      PathPan   = "";
      SwTranspa = 0;
      Linea     = 0;
      aTecla    = "";
      nMenu     = 0;
      nLinea    = 0;
      nCampo    = 0;
      nCampo1   = 0;
      nSuma     = 0;

 {-1} Menu      = "";
      Menu1     = "1244";
      Menu2     = "1";
      Menu3     = "10";
      Menu4     = "Datos Sociedad                  ";
      Menu5     = "Datos Notar¡a                   ";
      Menu6     = "Datos Escritura                 ";
      Menu7     = "Objeto Social                   ";
      Menu8     = "Datos Registro                  ";
      Menu9     = "Representantes / Administradores";
      Menu10    = "Socios                          ";
      Menu11    = "Cargos Administracion           ";
      Menu12    = "Participaciones otras empresas  ";
      Menu13    = "Acciones Propias                ";

 {-1} MenuDSoc    = "";
      MenuDSoc1   = "1744";
      MenuDSoc2   = "1";
      MenuDSoc3   = "5";
      MenuDSoc4   = "Datos generales                 ";
      MenuDSoc5   = "Caracteres de la Declaracion    ";
      MenuDSoc6   = "AIE., UTE. o Transp.fiscal Inter";
      MenuDSoc7   = "Estados de Cuentas              ";
      MenuDSoc8   = "Pertenencia a grupo sociedades  ";

 {-1} MenuTFis    = "";
      MenuTFis1   = "1630";
      MenuTFis2   = "1";
      MenuTFis3   = "2";
      MenuTFis4   = "Relacion de Socios              ";
      MenuTFis5   = "Internacional                   ";

 {-1} MenuEscr    = "";
      MenuEscr1   = "1630";
      MenuEscr2   = "1";
      MenuEscr3   = "2";
      MenuEscr4   = "Datos Escrituras                         ";
      MenuEscr5   = "Datos Complementarios Certificados Euros ";

 {-1} MenuAcciones   = "";
      MenuAcciones1  = "1430";
      MenuAcciones2  = "1";
      MenuAcciones3  = "8";
      MenuAcciones4  = "Tipo 1              ";
      MenuAcciones5  = "Tipo 2              ";
      MenuAcciones6  = "Tipo 3              ";
      MenuAcciones7  = "Tipo 4              ";
      MenuAcciones8  = "Tipo 5              ";
      MenuAcciones9  = "Tipo 6              ";
      MenuAcciones10 = "Tipo 7              ";
      MenuAcciones11 = "Texto Complementario";

      nInkey      = 0;
      nBal        = 0;
      aAlfa1      = "";
      aAlfa3      = "";
      nNume1      = 0;
      fFecha1     = @;
      nSw         = 0;

      aBase       = "";
      aMas        = "";
      aAlfa       = "";

      &eaPrograma  = "";
      &eaExtension = "";

      &enEmpresa   = 0;
      &enEmpSoc    = 0;
      &enAnyo      = 0;
      &Cliente     = 0;
      &Registro    = 0;
      &Programa    = "";
      &TipoLinea   = 0;
      &enCodCli    = 0;
      &enSwDeDonde = 0;
      &Modo        = 0;
      &enModo      = 0;
      &enModo1     = 0;
      &enVAccion   = 0;
      &enEjerBaja  = 0;
      &enErrorVer  = 0;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |CONFI "0000NDesea Actualizar los Datos en el Maestro del Impuesto de Sociedades ";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     enEmpSoc = #0#0;
     |HAZ BFechaDisolucion;

     |PUSHV 0501 2380;
     |CUADRO 1517 2163;
     |BLANCO 1618 2062;
     |PINTA 1619, "Introduzca los ejercicios a Actualizar";
     |PINTA 1824, "Ejercicio 1 :           ";
     |PINTA 1924, "Ejercicio 2 :           ";

     fFecha1 = ~;
     aAlfa1 = fFecha1; aAlfa1 = aAlfa1 % -104;
     nNume1 = aAlfa1;
     |SI enEjerBaja > 0; |Y enEjerBaja < nNume1;
         nEjercicio1 = enEjerBaja;
     |SINO;
         nEjercicio1 = nNume1 - 1;
     |FINSI;
     nEjercicio2 = nNume1;

     |ET nEjercicio1;
         E_inf = 1900;  E_sup = 2999;
         nEjercicio1 = 1838 ? 1;
         |SI FSalida = 2;  |VETE nEjercicio1;  |FINSI;
         |SI FSalida = 7;  |ACABA; |FINSI;
         |SI enEjerBaja > 0; |Y nEjercicio1 > enEjerBaja;
             |MENAV "    Atencion. Ejercicio Posterior a la fecha de baja de la Empresa.";
             |VETE nEjercicio1;
         |FINSI;

         E_inf = 0;  E_sup = 2999;
         nEjercicio2 = 1938 ? 1;
         |SI FSalida = 2;  |VETE nEjercicio1;  |FINSI;
         |SI enEjerBaja > 0; |Y nEjercicio2 > enEjerBaja;
             |MENAV "    Atencion. Ejercicio Posterior a la fecha de baja de la Empresa.";
             |VETE nEjercicio1;
         |FINSI;

         enEmpresa = #0#0;
         enAnyo    = nEjercicio1;
         enModo1   = 99;
         |SUB_EJECUTA_NP ":contasoc/maacceco";

         |SI nEjercicio2 ! 0;
             enEmpresa = #0#0;
             enAnyo    = nEjercicio2;
             enModo1   = 99;
             |SUB_EJECUTA_NP ":contasoc/maacceco";
         |FINSI;
         |POPV;
|FPRC;

|PROCESO PintaCliente;

      fFecha1 = "01.01.0000";
      enCodCli = #0#0;
      |HAZ LeePersona;

      |SI enSwDeDonde = 1;
          #0#1 = #715#2;
          #0#2 = #715#1;
          #0#3 = #715#3;
          #0#4 = #715#4;
          #0#5 = #715#54;
          fFecha1 = #715#7;
      |SINO;
          #0#1 = #715#1;
          #0#2 = #715#2;
          #0#3 = #715#13;
          #0#4 = #715#62;
          #0#5 = #715#14;
          fFecha1 = #715#94;
      |FINSI;

      |PINTA #0#1;
      |PINTA #0#2;
      |PINTA #0#3;
      |PINTA #0#4;
      |PINTA #0#5;
|FPRC;

|PROCESO Graba361;
     |SI #1#17 ! "        ";  |O #1#18 ! "        ";
         #37#0 = "agim0019";
         #37#1 = #1#0;
         #37#2 = #1#1;
         #37#3 = 1;
         #37#4 = 1;
         #37#5 = "ACCIONES NOMINATIVAS";
         #37#6 = #1#17;
         #37#7 = #1#18;
         |GRABA 020#37n;
         |LIBERA #37;
     |FINSI;

     |SI #1#21 ! "        ";  |O #1#22 ! "        ";
         #37#0 = "agim0019";
         #37#1 = #1#0;
         #37#2 = #1#1;
         #37#3 = 2;
         #37#4 = 1;
         #37#5 = "ACCIONES AL PORTADOR";
         #37#6 = #1#21;
         #37#7 = #1#22;
         |GRABA 020#37n;
         |LIBERA #37;
     |FINSI;

     |SI #1#49 ! "        ";  |O #1#50 ! "        ";
         #37#0 = "agim0019";
         #37#1 = #1#0;
         #37#2 = #1#1;
         #37#3 = 3;
         #37#4 = 1;
         #37#5 = "PARTICIPACIONES SOCIOS";
         #37#6 = #1#49;
         #37#7 = #1#50;
         |GRABA 020#37n;
         |LIBERA #37;
     |FINSI;
|FPRC;

|DEFBUCLE agim0019;
     #1#1;
     ;
     00000, 00;
     99999, 99;
     ;
     NULL, Graba361;
|FIN;

|PROCESO Graba362;
     |SI #25#15 ! "        ";  |O #25#16 ! "        ";
         #37#0 = "agim0025";
         #37#1 = #25#0;
         #37#2 = #25#1;
         #37#3 = #25#2;
         #37#4 = 1;
         #37#5 = "ACCIONES / PARTICIPACIONES";
         #37#6 = #25#15;
         #37#7 = #25#16;
         |GRABA 020#37n;
         |LIBERA #37;
     |FINSI;
|FPRC;

|DEFBUCLE agim0025;
     #25#1;
     ;
     00000, 00, 000;
     99999, 99, 999;
     ;
     NULL, Graba362;
|FIN;

|PROCESO Tipo8;  |TIPO 8;
  |ABRE #37;
  |LEE 040#37p;
  |SI FSalida ! 0;
      |BUCLE agim0019;
      |BUCLE agim0025;
  |FINSI;
  |CIERRA #37;
|FPRC;

|| ********************************
|| MENU TRANSPARENCIA FISCAL
|| ********************************

|PROCESO MenuTFis;
  SwTranspa = 0;

  |ABRE #9;
  || ... #9#0 = Cliente;
  || ... #9#1 = 12;       el caracter 12 no es trasparencia fiscal
  || ... |LEE 040#9=;
  || ... |SI FSalida = 0; SwTranspa = 1; |FINSI;

  #9#0 = Cliente;
  #9#1 = 13;
  |LEE 040#9=;
  |SI FSalida = 0; SwTranspa = 1;  |FINSI;

  #9#0 = Cliente;
  #9#1 = 15;
  |LEE 040#9=;
  |SI FSalida = 0; SwTranspa = 1;  |FINSI;
  |CIERRA #9;

  |SI SwTranspa = 0;
      |MENAV "     La Empresa no consta como AIE,UTE o Transp.Fiscal Inter.";
      |ACABA;
  |FINSI;

  |PARA;  |SI;  |HACIENDO;
          |MENUG MenuTFis;
          MenuTFis2 = FSalida;
          |SI MenuTFis2 ] 1; |Y MenuTFis2 [ 2;
              |PUSHV 0501 2380;
              |SI MenuTFis2 = 1; |SUB_EJECUTA_NP "agim0021";          |FINSI;
              |SI MenuTFis2 = 2; |SUB_EJECUTA_NP "agim0022";          |FINSI;
              |POPV;
          |SINO;
              |SAL;
          |FINSI;
  |SIGUE;
|FPRC;

|| ********************************
|| DATOS GRUPO
|| ********************************

|PROCESO DatosGrupo;
  |PUSHV 0501 2380;

  |DDEFECTO #6;
  #6#0  = #1#83;
  #6#1  = #1#84;
  #6#2  = #1#85;
  #6#3  = #1#86;

  |PINPA #0#6;
  |PINDA #0#6;
  |SI Modo ! 4;
       |ENDATOS #1#6;
       |SI FSalida = 0;
           #1#83 = #6#0;
           #1#84 = #6#1;
           #1#85 = #6#2;
           #1#86 = #6#3;
       |FINSI;
  |SINO;
       |LEETECLA aTecla;
  |FINSI;
  |POPV;
|FPRC;

|PROCESO LeoBal;
     |ABRE #420;
     |DDEFECTO #420;
     #420#0 = nBal;
     |LEE 041#420=;
     |CIERRA #420;
|FPRC;

|PROCESO EstadoCtas;
  |PUSHV 0501 2380;

  |DDEFECTO #7;
  #7#0  = #1#87; nBal = #7#0; |HAZ LeoBal; #7#1 = #420#1;
  #7#2  = #1#88; nBal = #7#2; |HAZ LeoBal; #7#3 = #420#1;

  |PINPA #0#7;
  |PINDA #0#7;
  |SI Modo ! 4;
       |ENDATOS #1#7;
       |SI FSalida = 0;
           #1#87 = #7#0;
           #1#88 = #7#2;
       |FINSI;
  |SINO;
       |LEETECLA aTecla;
  |FINSI;
  |POPV;
|FPRC;

|| ********************************
|| MENU DATOS DE SOCIEDADES
|| ********************************

|PROCESO DatosGenerales;
  |PUSHV 0501 2380;

  |DDEFECTO #8;
  #8#0  = #1#4;
  #8#1  = #1#5;
  #8#2  = #1#6;
  #8#3  = #1#7;
  #8#4  = #1#40;
  #8#5  = #1#41;
  #8#6  = #1#46;
  #8#7  = #1#47;
  #8#8  = #1#48;
  #8#9  = #1#54;
  #8#10 = #1#55;
  #8#11 = #1#81;
  #8#12 = #1#82;
  #8#13 = #1#89;
  #8#14 = #1#90;
  #8#15 = #1#92;
  #8#16 = #1#93;
  #8#17 = #1#94;

  |PINPA #0#8;
  |PINDA #0#8;
  |SI Modo ! 4;
       |ENDATOS #1#8;
       |SI FSalida = 0;
           #1#04 = #8#0;
           #1#05 = #8#1;
           #1#06 = #8#2;
           #1#07 = #8#3;
           #1#40 = #8#4;
           #1#41 = #8#5;
           #1#46 = #8#6;
           #1#47 = #8#7;
           #1#48 = #8#8;
           #1#54 = #8#9;
           #1#55 = #8#10;
           #1#81 = #8#11;
           #1#82 = #8#12;
           #1#89 = #8#13;
           #1#90 = #8#14;
           #1#92 = #8#15;
           #1#93 = #8#16;
           #1#94 = #8#17;
       |FINSI;
  |SINO;
       |LEETECLA aTecla;
  |FINSI;
  |POPV;
|FPRC;

|PROCESO Caracteres;
     |DBASS aBase;
     aMas = aBase + "contasoc/def/isow0021.mas";
     |XABRE "E", aMas, 0;
     |SI FSalida ] 0;
         aAlfa = "|:contasoc/isow0021;";
         aAlfa = aAlfa + "0000";
         aAlfa = aAlfa + (("00000" + #agim0019#0) % -105);

         |SUB_EJECUTA aAlfa;
         |PULSATECLA;
     |SINO;
         |SUB_EJECUTA_NP "agim0020";
    |FINSI;
|FPRC;



|PROCESO MenuDSoc;
  |PARA;  |SI;  |HACIENDO;
          |MENUG MenuDSoc;
          MenuDSoc2 = FSalida;
          |SI MenuDSoc2 ] 1; |Y MenuDSoc2 [ 5;
              |SI MenuDSoc2 = 1; |HAZ DatosGenerales;         |FINSI;
              |SI MenuDSoc2 = 2; |HAZ Caracteres;             |FINSI;
              |SI MenuDSoc2 = 3; |HAZ MenuTFis;               |FINSI;
              |SI MenuDSoc2 = 4; |HAZ EstadoCtas;             |FINSI;
              |SI MenuDSoc2 = 5; |HAZ DatosGrupo;             |FINSI;
          |SINO;
              |SAL;
          |FINSI;
  |SIGUE;
|FPRC;

|| ********************************
|| MENU DATOS DE ACCIONES
|| ********************************

|PROCESO MenuAcciones;

  |PUSHV 0501 2380;
  |PARA;  |SI;  |HACIENDO;
          |MENUG MenuAcciones;
          MenuAcciones2 = FSalida;
          |SI MenuAcciones2 ] 1; |Y MenuAcciones2 [ 8;
              |PUSHV 0501 2380;
              |SI MenuAcciones2 = 1; |SUB_EJECUTA_NP "agim0038";  |FINSI;
              |SI MenuAcciones2 = 2; |SUB_EJECUTA_NP "agim0040";  |FINSI;
              |SI MenuAcciones2 = 3; |SUB_EJECUTA_NP "agim0041";  |FINSI;
              |SI MenuAcciones2 = 4; |SUB_EJECUTA_NP "agim0042";  |FINSI;
              |SI MenuAcciones2 = 5; |SUB_EJECUTA_NP "agim0043";  |FINSI;
              |SI MenuAcciones2 = 6; |SUB_EJECUTA_NP "agim0044";  |FINSI;
              |SI MenuAcciones2 = 7; |SUB_EJECUTA_NP "agim0045";  |FINSI;
              |SI MenuAcciones2 = 8; |SUB_EJECUTA_NP "agim0046";  |FINSI;
              |POPV;
          |SINO;
              |SAL;
          |FINSI;
  |SIGUE;
  |POPV;
|FPRC;

|| ********************************
|| DATOS NOTARIA
|| ********************************


|PROCESO DatosNotaria;
     |PUSHV 0501 2380;

     |DDEFECTO #2;
     #2#0  = #1#8;
     #2#1  = #1#9;
     #2#2  = #1#10;
     #2#3  = #1#11;
     #2#4  = #1#12;
     #2#5  = #1#56;

     |PINPA #0#2;
     |PINDA #0#2;

     |SI Modo ! 4;
         |ENDATOS #1#2;
         |SI FSalida = 0;
             #1#8  = #2#0;
             #1#9  = #2#1;
             #1#10 = #2#2;
             #1#11 = #2#3;
             #1#12 = #2#4;
             #1#56 = #2#5;
         |FINSI;
     |SINO;
         |LEETECLA aTecla;
     |FINSI;
     |POPV;
|FPRC;

|| ********************************
|| DATOS ESCRITURA
|| ********************************

|PROCESO BorraAcciones;
     |ABRE #37;
     |ET Arriba;
          #37#0 = Programa;
          #37#1 = Cliente;
          #37#2 = Registro;
          #37#3 = TipoLinea;
          #37#4 = 1;
          |LIBERA #37;
          |LEE 140#37];
          |SI FSalida = 0; |Y #37#0 = Programa; |Y #37#1 = Cliente;
                           |Y #37#2 = Registro; |Y #37#3 = TipoLinea;
              |BORRA 140#37a;
              |VETE Arriba;
          |FINSI;
     |CIERRA #37;
|FPRC;

|PROCESO Parrilla;
     Cliente  = #1#0;
     Registro = #1#1;
     Programa = "agim0019";
     |SI Campo = 1;   TipoLinea = 1;  |FINSI;
     |SI Campo = 5;   TipoLinea = 2;  |FINSI;
     |SI Campo = 9;   TipoLinea = 3;  |FINSI;

     |SI #4Campo ! 0;
         |SUB_EJECUTA_NP "agim0037";
     |SINO;
         |HAZ BorraAcciones;
     |FINSI;

     |ABRE #37;
     #37#0 = Programa;
     #37#1 = Cliente;
     #37#2 = Registro;
     #37#3 = TipoLinea;
     #37#4 = 1;
     |LEE 040#37];
     |SI FSalida ! 0; |O #37#0 ! Programa; |O #37#1 ! Cliente;
                      |O #37#2 ! Registro; |O #37#3 ! TipoLinea;
        |DDEFECTO #37;
     |FINSI;

     |SI TipoLinea = 1;
         #4#3  = #37#6;  |PINTA #4#3;
         #4#4  = #37#7;  |PINTA #4#4;
     |FINSI;

     |SI TipoLinea = 2;
         #4#7  = #37#6;  |PINTA #4#7;
         #4#8  = #37#7;  |PINTA #4#8;
     |FINSI;

     |SI TipoLinea = 3;
         #4#11 = #37#6;  |PINTA #4#11;
         #4#12 = #37#7;  |PINTA #4#12;
     |FINSI;
|FPRC;

|PROCESO DatosEscritura;
     |PUSHV 0501 2380;

     |DDEFECTO #4;
     #4#0  = #1#14;
     #4#1  = #1#15;
     #4#2  = #1#16;
     #4#3  = #1#17;
     #4#4  = #1#18;
     #4#5  = #1#19;
     #4#6  = #1#20;
     #4#7  = #1#21;
     #4#8  = #1#22;
     #4#9  = #1#23;
     #4#10 = #1#24;
     #4#11 = #1#49;
     #4#12 = #1#50;
     #4#13 = #1#51;

     |PINPA #0#4;
     |PINDA #0#4;

     |SI Modo ! 4;
         |ENDATOS #1#4;
         |SI FSalida = 0;
             #1#14 = #4#0;
             #1#15 = #4#1;
             #1#16 = #4#2;
             #1#17 = #4#3;
             #1#18 = #4#4;
             #1#19 = #4#5;
             #1#20 = #4#6;
             #1#21 = #4#7;
             #1#22 = #4#8;
             #1#23 = #4#9;
             #1#24 = #4#10;
             #1#49 = #4#11;
             #1#50 = #4#12;
             #1#51 = #4#13;
         |FINSI;
     |SINO;
         |LEETECLA aTecla;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO DatosCompEscritura;
     |PUSHV 0501 2380;

     |DDEFECTO #5;

     |PARA nCampo = 57;  |SI nCampo [ 79;  |HACIENDO nCampo = nCampo + 1;
           nCampo1 = nCampo - 57;
           #5nCampo1 = #1nCampo;
     |SIGUE;

     |PINPA #0#5;
     |PINDA #0#5;

     |SI Modo ! 4;
         |ENDATOS #1#5;
         |SI FSalida = 0;
             |PARA nCampo = 57;  |SI nCampo [ 79;  |HACIENDO nCampo = nCampo + 1;
                   nCampo1 = nCampo - 57;
                   #1nCampo = #5nCampo1;
             |SIGUE;
         |FINSI;
     |SINO;
         |LEETECLA aTecla;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO MenuEscritura;
  |PUSHV 0501 2380;
  |PARA;  |SI;  |HACIENDO;
          |MENUG MenuEscr;
          MenuEscr2 = FSalida;
          |SI MenuEscr2 ] 1; |Y MenuEscr2 [ 2;
              |SI MenuEscr2 = 1; |HAZ DatosEscritura;      |FINSI;
              |SI MenuEscr2 = 2; |HAZ DatosCompEscritura;  |FINSI;
          |SINO;
              |SAL;
          |FINSI;
  |SIGUE;
  |POPV;
|FPRC;

|| ********************************
|| DATOS REGISTRO
|| ********************************

|PROCESO DatosObjetoSocial;
     |SUB_EJECUTA_NP "agim0049";

     |ABRE #49;
     |PARA nLinea = 1;  |SI nLinea [ 5;  |HACIENDO nLinea = nLinea + 1;
           #49#0 = #1#0;
           #49#1 = #1#1;
           #49#2 = nLinea;
           |LEE 040#49=;
           |SI FSalida = 0;
               |SI nLinea = 1;  #1#13 = #49#3;  |FINSI;
               |SI nLinea = 2;  #1#42 = #49#3;  |FINSI;
               |SI nLinea = 3;  #1#43 = #49#3;  |FINSI;
               |SI nLinea = 4;  #1#44 = #49#3;  |FINSI;
               |SI nLinea = 5;  #1#45 = #49#3;  |FINSI;
           |FINSI;
     |SIGUE;
     |CIERRA #49;
|FPRC;

|| ********************************
|| DATOS REGISTRO
|| ********************************

|PROCESO DatosRegistro;
  |PUSHV 0501 2380;

  |DDEFECTO #3;
  #3#0  = #1#25;  #3#1  = #1#26;  #3#2  = #1#27;  #3#3  = #1#28;
  #3#4  = #1#29;  #3#5  = #1#30;  #3#6  = #1#31;  #3#7  = #1#32;
  #3#8  = #1#33;  #3#9  = #1#34;  #3#10 = #1#35;  #3#11 = #1#36;
  #3#12 = #1#37;  #3#13 = #1#38;  #3#14 = #1#39;  #3#15 = #1#52;
  #3#16 = #1#53;  #3#17 = #1#91;

  |PINPA #0#3;
  |PINDA #0#3;
  |SI Modo ! 4;
       |ENDATOS #1#3;
       |SI FSalida = 0;
           #1#25 = #3#0;  #1#26 = #3#1;  #1#27 = #3#2;  #1#28 = #3#3;
           #1#29 = #3#4;  #1#30 = #3#5;  #1#31 = #3#6;  #1#32 = #3#7;
           #1#33 = #3#8;  #1#34 = #3#9;  #1#35 = #3#10; #1#36 = #3#11;
           #1#37 = #3#12; #1#38 = #3#13; #1#39 = #3#14; #1#52 = #3#15;
           #1#53 = #3#16; #1#91 = #3#17;
       |FINSI;
  |SINO;
       |LEETECLA aTecla;
  |FINSI;
  |POPV;
|FPRC;


|| ********************************
|| MENU GENERAL
|| ********************************

|PROCESO MenuG;
  |PUSHV 0501 2380;
  |PARA;  |SI;  |HACIENDO;
          Cliente   = #1#0;
          Registro  = #1#1;
          enVAccion = 0;
          |SI #1#16 ! 0;  enVAccion = #1#16;  |FINSI;
          |SI #1#20 ! 0;  enVAccion = #1#20;  |FINSI;
          |SI #1#24 ! 0;  enVAccion = #1#24;  |FINSI;

          nSuma = #1#16 + #1#20 + #1#24;
          |SI nSuma ! enVAccion;
              enVAccion = 0;
          |FINSI;

          |MENUG Menu;
          Menu2 = FSalida;
          nMenu = FSalida;
          |SI nMenu ] 1; |Y nMenu [ 10;
              |SI nMenu = 1;   |HAZ MenuDSoc;              |FINSI;
              |SI nMenu = 2;   |HAZ DatosNotaria;          |FINSI;
              |SI nMenu = 3;   |HAZ MenuEscritura;         |FINSI;
              |SI nMenu = 4;   |HAZ DatosObjetoSocial;     |FINSI;
              |SI nMenu = 5;   |HAZ DatosRegistro;         |FINSI;
              |SI nMenu = 6;   |SUB_EJECUTA_NP "agim0024"; |FINSI;
              |SI nMenu = 7;   |SUB_EJECUTA_NP "agim0025"; |FINSI;
              |SI nMenu = 8;   |SUB_EJECUTA_NP "agim0026"; |FINSI;
              |SI nMenu = 9;   |SUB_EJECUTA_NP "agim0027"; |FINSI;
              |SI nMenu = 10;  |HAZ MenuAcciones;          |FINSI;
          |SINO;
              |SAL;
          |FINSI;
  |SIGUE;
  |POPV;
|FPRC;

|PROCESO Tipo7F19; |TIPO 7;
   Modo = (FEntrada / 100) ! 0;
   |SI Modo ] 2;
       |MENSA "0000<F12> Consultar la Ficha. <F3> Actualizar con los datos de esta linea";
   |FINSI;
|FPRC;

|PROCESO PasarUno;
     |CONFI "0000NDesea Actualizar los Datos de esta Linea en el Maestro del Imp.Sociedades ";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     enEmpSoc = #0#0;
     |HAZ BFechaDisolucion;

     |PUSHV 0501 2380;
     |BLANCO 1517 2061
     |CUADRO 1517 2061
     |PINTA 1619, "Introduzca el ejercicio a Actualizar";
     |PINTA 1824, "Ejercicio :           ";

     fFecha1 = ~;
     aAlfa1 = fFecha1; aAlfa1 = aAlfa1 % -104;
     nNume1 = aAlfa1;
     |SI enEjerBaja > 0; |Y enEjerBaja < nNume1;
         nEjercicio1 = enEjerBaja;
     |SINO;
         nEjercicio1 = nNume1 - 1;
     |FINSI;

     |ET nEjercicio;
         E_inf = 2000;  E_sup = 2999;
         nEjercicio1 = 1836 ? 1;
         |SI FSalida = 2;  |VETE nEjercicio;  |FINSI;
         |SI FSalida = 7;  |POPV;    |ACABA;  |FINSI;
         |SI enEjerBaja > 0; |Y nEjercicio1 > enEjerBaja;
             |MENAV "    Atencion. Ejercicio Posterior a la fecha de baja de la Empresa.";
             |VETE nEjercicio;
         |FINSI;

      |PINTA 2307, "Actualizando datos en Maestro del Imp.Sociedades";

      enEmpresa = #0#0;
      enAnyo    = nEjercicio1;
      Registro  = #1#1;
      enModo1   = 98;
      |SUB_EJECUTA_NP ":contasoc/maacceco";

      |POPV;
      aAlfa = nEjercicio1;
      aAlfa = "0000Actualizado el Maestro del Imp.Sociedades ejercicio: " + aAlfa;
      |MENAV aAlfa;
|FPRC;

|PROCESO Tipo11;  |TIPO 11;
     nInkey = FSalida;
     |BLIN 4;
     |SI nInkey = 9;

         Modo = 4;
         |HAZ MenuG;

         |ERROR;
     |FINSI;
     |SI nInkey = 11;
         |HAZ PasarUno;

         |ERROR;
     |FINSI;
|FPRC;

|| ******************************
|| PROCESOS BAJA DE LA LINEA
|| ******************************

|PROCESO Borra21;
  |BORRA 140#21a;
  |LIBERA #21;
|FPRC;

|DEFBUCLE agim0021B;
  #21#1;
  ;
  #1#0, #1#1, 01;
  #1#0, #1#1, 99;
  be;
  NULL, Borra21;
|FIN;

|PROCESO Borra22;
  |BORRA 140#22a;
  |LIBERA #22;
|FPRC;

|DEFBUCLE agim0022B;
  #22#1;
  ;
  #1#0, #1#1, 01;
  #1#0, #1#1, 99;
  be;
  NULL, Borra22;
|FIN;

|PROCESO Borra23;
  |BORRA 140#23a;
  |LIBERA #23;
|FPRC;

|DEFBUCLE agim0023B;
  #23#1;
  ;
  #1#0, #1#1, 01, 01;
  #1#0, #1#1, 99, 99;
  be;
  NULL, Borra23;
|FIN;

|PROCESO Borra24;
  |BORRA 140#24a;
  |LIBERA #24;
|FPRC;

|DEFBUCLE agim0024B;
  #24#1;
  ;
  #1#0, #1#1, 01;
  #1#0, #1#1, 99;
  be;
  NULL, Borra24;
|FIN;

|PROCESO Borra58;
  |BORRA 140#58a;
  |LIBERA #58;
|FPRC;

|DEFBUCLE agim0058B;
  #58#1;
  ;
  #1#0, #1#1, 001, 01;
  #1#0, #1#1, 999, 99;
  be;
  NULL, Borra58;
|FIN;

|PROCESO Borra25;
  |BORRA 140#25a;
  |LIBERA #25;
|FPRC;

|DEFBUCLE agim0025B;
  #25#1;
  ;
  #1#0, #1#1, 001;
  #1#0, #1#1, 999;
  be;
  NULL, Borra25;
|FIN;

|PROCESO Borra26;
  |BORRA 140#26a;
  |LIBERA #26;
|FPRC;

|DEFBUCLE agim0026B;
  #26#1;
  ;
  #1#0, #1#1, 01;
  #1#0, #1#1, 99;
  be;
  NULL, Borra26;
|FIN;

|PROCESO Borra27;
  |BORRA 140#27a;
  |LIBERA #27;
|FPRC;

|DEFBUCLE agim0027B;
  #27#1;
  ;
  #1#0, #1#1, 01;
  #1#0, #1#1, 99;
  be;
  NULL, Borra27;
|FIN;

|PROCESO Borra37;
  |BORRA 140#37a;
  |LIBERA #37;
|FPRC;

|DEFBUCLE agim0037B;
  #37#1;
  ;
  "        ", #1#0, #1#1, 001, 00;
  "zzzzzzzz", #1#0, #1#1, 999, 99;
  be;
  NULL, Borra37;
|FIN;

|PROCESO Borra38;
  |BORRA 140#38a;
  |LIBERA #38;
|FPRC;

|DEFBUCLE agim0038B;
  #38#1;
  ;
  #1#0, #1#1;
  #1#0, #1#1;
  be;
  NULL, Borra38;
|FIN;

|PROCESO Borra39;
  |BORRA 140#39a;
  |LIBERA #39;
|FPRC;

|DEFBUCLE agim0039B;
  #39#1;
  ;
  #1#0, #1#1, 00;
  #1#0, #1#1, 99;
  be;
  NULL, Borra39;
|FIN;

|PROCESO Borra40;
  |BORRA 140#40a;
  |LIBERA #40;
|FPRC;

|DEFBUCLE agim0040B;
  #40#1;
  ;
  #1#0, #1#1, 00;
  #1#0, #1#1, 99;
  be;
  NULL, Borra40;
|FIN;

|PROCESO Borra41;
  |BORRA 140#41a;
  |LIBERA #41;
|FPRC;

|DEFBUCLE agim0041B;
  #41#1;
  ;
  #1#0, #1#1, 00;
  #1#0, #1#1, 99;
  be;
  NULL, Borra41;
|FIN;

|PROCESO Borra42;
  |BORRA 140#42a;
  |LIBERA #42;
|FPRC;

|DEFBUCLE agim0042B;
  #42#1;
  ;
  #1#0, #1#1, 00;
  #1#0, #1#1, 99;
  be;
  NULL, Borra42;
|FIN;

|PROCESO Borra43;
  |BORRA 140#43a;
  |LIBERA #43;
|FPRC;

|DEFBUCLE agim0043B;
  #43#1;
  ;
  #1#0, #1#1, 00;
  #1#0, #1#1, 99;
  be;
  NULL, Borra43;
|FIN;

|PROCESO Borra44;
  |BORRA 140#44a;
  |LIBERA #44;
|FPRC;

|DEFBUCLE agim0044B;
  #44#1;
  ;
  #1#0, #1#1, 00;
  #1#0, #1#1, 99;
  be;
  NULL, Borra44;
|FIN;

|PROCESO Borra45;
  |BORRA 140#45a;
  |LIBERA #45;
|FPRC;

|DEFBUCLE agim0045B;
  #45#1;
  ;
  #1#0, #1#1, 00;
  #1#0, #1#1, 99;
  be;
  NULL, Borra45;
|FIN;

|PROCESO Borra46;
  |BORRA 140#46a;
  |LIBERA #46;
|FPRC;

|DEFBUCLE agim0046B;
  #46#1;
  ;
  #1#0, #1#1, 000;
  #1#0, #1#1, 999;
  be;
  NULL, Borra46;
|FIN;

|PROCESO Borra49;
  |BORRA 140#49a;
  |LIBERA #49;
|FPRC;

|DEFBUCLE agim0049B;
  #49#1;
  ;
  #1#0, #1#1, 000;
  #1#0, #1#1, 999;
  be;
  NULL, Borra49;
|FIN;

|PROCESO Comprueba24;
  nSw = 1;
  |LIBERA #24;
|FPRC;

|DEFBUCLE agim0024C;
  #24#1;
  ;
  #1#0, 01, 01;
  #1#0, 99, 99;
  e;
  NULL, Comprueba24;
|FIN;

|PROCESO Borra04;
  |BORRA 140#104a;
  |LIBERA #104;
|FPRC;

|DEFBUCLE agim0004B;
  #104#1;
  ;
  #1#0, 01;
  #1#0, 99;
  be;
  NULL, Borra04;
|FIN;

|PROCESO Tipo2;  |TIPO 2;
  Modo = (FEntrada / 100) ! 0;
  |SI Modo ! 3;  |ACABA;  |FINSI;

  |BUCLE agim0021B;
  |BUCLE agim0022B;
  |BUCLE agim0023B;
  |BUCLE agim0024B;
  |BUCLE agim0025B;
  |BUCLE agim0026B;
  |BUCLE agim0027B;
  |BUCLE agim0037B;
  |BUCLE agim0038B;
  |BUCLE agim0039B;
  |BUCLE agim0040B;
  |BUCLE agim0041B;
  |BUCLE agim0042B;
  |BUCLE agim0043B;
  |BUCLE agim0044B;
  |BUCLE agim0045B;
  |BUCLE agim0046B;
  |BUCLE agim0049B;
  |BUCLE agim0058B;

  nSw = 0;
  |BUCLE agim0024C;
  |SI nSw = 0;
      |BUCLE agim0004B;
  |FINSI;

  |ABRE #100;
  #100#0 = #0#0;
  |LIBERA #100;
  |LEE 140#100=;
  |SI FSalida = 0;
      #100#21 = "S";
      |GRABA 120#100a;
  |FINSI;
  |CIERRA #100;
|FPRC;


|| ******************************
|| PROCESOS ALTA DE LA LINEA
|| ******************************

|PROCESO Alta21;
  #21#1 = Linea;
  |GRABA 140#21n;
  |LIBERA #21;
|FPRC;

|DEFBUCLE agim0021A;
  #21#1;
  ;
  #1#0, #1#1, 01;
  #1#0, #1#1, 99;
  be;
  NULL, Alta21;
|FIN;

|PROCESO Alta22;
  #22#1 = Linea;
  |GRABA 140#22n;
  |LIBERA #22;
|FPRC;

|DEFBUCLE agim0022A;
  #22#1;
  ;
  #1#0, #1#1, 01;
  #1#0, #1#1, 99;
  be;
  NULL, Alta22;
|FIN;

|PROCESO Alta23;
  #23#1 = Linea;
  |GRABA 140#23n;
  |LIBERA #23;
|FPRC;

|DEFBUCLE agim0023A;
  #23#1;
  ;
  #1#0, #1#1, 01, 01;
  #1#0, #1#1, 99, 99;
  be;
  NULL, Alta23;
|FIN;

|PROCESO Alta24;
  #24#1 = Linea;
  |GRABA 140#24n;
  |LIBERA #24;
|FPRC;

|DEFBUCLE agim0024A;
  #24#1;
  ;
  #1#0, #1#1, 01;
  #1#0, #1#1, 99;
  be;
  NULL, Alta24;
|FIN;

|PROCESO Alta25;
  #25#1 = Linea;
  |GRABA 140#25n;
  |LIBERA #25;
|FPRC;

|DEFBUCLE agim0025A;
  #25#1;
  ;
  #1#0, #1#1, 001;
  #1#0, #1#1, 999;
  be;
  NULL, Alta25;
|FIN;

|PROCESO Alta26;
  #26#1 = Linea;
  |GRABA 140#26n;
  |LIBERA #26;
|FPRC;

|DEFBUCLE agim0026A;
  #26#1;
  ;
  #1#0, #1#1, 01;
  #1#0, #1#1, 99;
  be;
  NULL, Alta26;
|FIN;

|PROCESO Alta27;
  #27#1 = Linea;
  |GRABA 140#27n;
  |LIBERA #27;
|FPRC;

|DEFBUCLE agim0027A;
  #27#1;
  ;
  #1#0, #1#1, 01;
  #1#0, #1#1, 99;
  be;
  NULL, Alta27;
|FIN;

|PROCESO Alta37;
  #37#2 = Linea;
  |GRABA 140#37n;
  |LIBERA #37;
|FPRC;

|DEFBUCLE agim0037A;
  #37#1;
  ;
  "        ", #1#0, #1#1, 001, 00;
  "zzzzzzzz", #1#0, #1#1, 999, 99;
  be;
  NULL, Alta37;
|FIN;

|PROCESO Alta38;
  #38#1 = Linea;
  |GRABA 140#38n;
  |LIBERA #38;
|FPRC;

|DEFBUCLE agim0038A;
  #38#1;
  ;
  #1#0, #1#1;
  #1#0, #1#1;
  be;
  NULL, Alta38;
|FIN;

|PROCESO Alta39;
  #39#1 = Linea;
  |GRABA 140#39n;
  |LIBERA #39;
|FPRC;

|DEFBUCLE agim0039A;
  #39#1;
  ;
  #1#0, #1#1, 00;
  #1#0, #1#1, 99;
  be;
  NULL, Alta39;
|FIN;

|PROCESO Alta40;
  #40#1 = Linea;
  |GRABA 140#40n;
  |LIBERA #40;
|FPRC;

|DEFBUCLE agim0040A;
  #40#1;
  ;
  #1#0, #1#1, 00;
  #1#0, #1#1, 99;
  be;
  NULL, Alta40;
|FIN;

|PROCESO Alta41;
  #41#1 = Linea;
  |GRABA 140#41n;
  |LIBERA #41;
|FPRC;

|DEFBUCLE agim0041A;
  #41#1;
  ;
  #1#0, #1#1, 00;
  #1#0, #1#1, 99;
  be;
  NULL, Alta41;
|FIN;

|PROCESO Alta42;
  #42#1 = Linea;
  |GRABA 140#42n;
  |LIBERA #42;
|FPRC;

|DEFBUCLE agim0042A;
  #42#1;
  ;
  #1#0, #1#1, 00;
  #1#0, #1#1, 99;
  be;
  NULL, Alta42;
|FIN;

|PROCESO Alta43;
  #43#1 = Linea;
  |GRABA 140#43n;
  |LIBERA #43;
|FPRC;

|DEFBUCLE agim0043A;
  #43#1;
  ;
  #1#0, #1#1, 00;
  #1#0, #1#1, 99;
  be;
  NULL, Alta43;
|FIN;

|PROCESO Alta44;
  #44#1 = Linea;
  |GRABA 140#44n;
  |LIBERA #44;
|FPRC;

|DEFBUCLE agim0044A;
  #44#1;
  ;
  #1#0, #1#1, 00;
  #1#0, #1#1, 99;
  be;
  NULL, Alta44;
|FIN;

|PROCESO Alta45;
  #45#1 = Linea;
  |GRABA 140#45n;
  |LIBERA #45;
|FPRC;

|DEFBUCLE agim0045A;
  #45#1;
  ;
  #1#0, #1#1, 00;
  #1#0, #1#1, 99;
  be;
  NULL, Alta45;
|FIN;

|PROCESO Alta46;
  #46#1 = Linea;
  |GRABA 140#46n;
  |LIBERA #46;
|FPRC;

|DEFBUCLE agim0046A;
  #46#1;
  ;
  #1#0, #1#1, 000;
  #1#0, #1#1, 999;
  be;
  NULL, Alta46;
|FIN;

|PROCESO Alta49;
  #49#1 = Linea;
  |GRABA 140#49n;
  |LIBERA #49;
|FPRC;

|DEFBUCLE agim0049A;
  #49#1;
  ;
  #1#0, #1#1, 000;
  #1#0, #1#1, 999;
  be;
  NULL, Alta49;
|FIN;

|PROCESO Alta58;
  #58#1 = Linea;
  |GRABA 140#58n;
  |LIBERA #58;
|FPRC;

|DEFBUCLE agim0058A;
  #58#1;
  ;
  #1#0, #1#1, 001, 01;
  #1#0, #1#1, 999, 99;
  be;
  NULL, Alta58;
|FIN;

|PROCESO Alta;  |TIPO 7;
  Modo = (FEntrada / 100) ! 0;
  |SI Modo ! 1; |ACABA;  |FINSI;

  |SI #1#1 = 1;  |Y enEmpresa ! 0;
      enCodCli = #1#0;
      |HAZ LeePersona;

      |SI enSwDeDonde = 1;
          |ABRE #106;
          #106#0 = #1#0;
          #106#1 = 1;
          |LEE 040#106=;
          |SI FSalida ! 0;  |DDEFECTO #106;  |FINSI;
          |CIERRA #106;

          #1#6  = #715#5;        |PINTA #1#6;
          #1#7  = #715#6;        |PINTA #1#7;
          #1#54 = #715#85;       |PINTA #1#54;
          #1#55 = #715#7;        |PINTA #1#55;
          #1#46 = #106#2;        |PINTA #1#46;
          #1#47 = #106#3;        |PINTA #1#47;
          #1#48 = #106#4;        |PINTA #1#48;
      |FINSI;
      |ACABA;
  |FINSI;

  |SI #1#1 = 1;  |ACABA;  |FINSI;

  Linea  = #1#1;

  |LEE 040#1=;
  |SI FSalida = 0;  |ACABA;  |FINSI;

  #1#1 = Linea;
  |LEE 040#1];
  |SI FSalida = 0;
      |LEE 040#1a;
  |SINO;
      |LEE 040#1u;
  |FINSI;

  |SI FSalida = 0; |Y #1#0 = #0#0;
      |BUCLE agim0021A;
      |BUCLE agim0022A;
      |BUCLE agim0023A;
      |BUCLE agim0024A;
      |BUCLE agim0025A;
      |BUCLE agim0026A;
      |BUCLE agim0027A;
      |BUCLE agim0037A;
      |BUCLE agim0038A;
      |BUCLE agim0039A;
      |BUCLE agim0040A;
      |BUCLE agim0041A;
      |BUCLE agim0042A;
      |BUCLE agim0043A;
      |BUCLE agim0044A;
      |BUCLE agim0045A;
      |BUCLE agim0046A;
      |BUCLE agim0049A;
      |BUCLE agim0058A;
      #1#1 = Linea;
      |LIBERA #1;

      |PINTA #1#1;   |PINTA #1#2;   |PINTA #1#3;   |PINTA #1#4;
      |PINTA #1#5;   |PINTA #1#6;   |PINTA #1#7;
  |FINSI;
|FPRC;

|PROGRAMA;
     |SUB_EJECUTA_NP "ver00001";
     |SI enErrorVer = 1;  |ACABA;  |FINSI;

     |HAZ eVerRegMer;

     |SI enEmpresa = 0;
         |MANTE #0;
     |SINO;
         |ABRET #0;
         #0#0 = enEmpresa;
         |LEE 101#0=;
         |SI FSalida ! 0;
             |DDEFECTO #0;
             #0#0 = enEmpresa;
             |GRABA 020#0b;
         |FINSI;

         |HAZ PintaCliente;

         |SI enModo ! 4;
             |ENDATOS #1#0;
         |SINO;
             |ENDATOS #4#0;
         |FINSI;

         |SI FSalida = 0;
             |GRABA 020#0a;
         |FINSI;
         |LIBERA #0;
         |CIERRAT #0;
     |FINSI;
|FPRO;
