|FICHEROS;
     dsborrm1,MANTE;
     dsborrma;

     dspase00;
     dspase15;
     dspase16;

     agifigen;

     :integral/dsam0000;      || Datos Generales
     :facturar/facemp1;       || Empresa facturar
     :facturar/asclient;      || Clientes facturar
|FIN;

|VARIABLES;
     nSwHay         = 0;
     nFact          = 0;
     nBueno         = 0;
     nCampo         = 0;

     aFichero       = "";
     aFact          = "";
     aAlfa          = "";
     aPassword      = "";
     aParametro     = "";
     aBase          = "";

     &enCambioCli    = 0;
     &enEmpresa      = 0;

     &eaPasaCact     = "";
     &eaPasaNuct     = "";
     &eaPasaCont     = "";
     &eaPasaFisc     = "";
     &eaPasaSoci     = "";
     &eaPasaRent     = "";
     &eaPasaLabo     = "";
     &eaPasaFact     = "";
     &eaPasaMaes     = "";
     &eaPasaArch     = "";
     &eaPasaR1994    = "";
     &eaPasaR1995    = "";
     &eaPasaR1996    = "";
     &eaPasaR1997    = "";
     &eaPasaR1998    = "";
     &eaPasaR1999    = "";
     &eaPasaR2000    = "";
     &eaPasaR2001    = "";
     &eaPasaR2002    = "";
     &eaPasaR2003    = "";
     &eaPasaR2004    = "";
     &eaPasaR2005    = "";
     &eaPasaR2006    = "";
     &eaPasaR2007    = "";
     &eaPasaR2008    = "";
     &eaPasaR2009    = "";
     &eaPasaR2010    = "";
     &eaPasaR2011    = "";
     &eaPasaR2012    = "";
     &eaPasaR2013    = "";
     &eaPasaR2014    = "";
     &eaPasaR2015    = "";
     &eaPasaR2016    = "";
     &eaPasaR2017    = "";
     &eaPasaR2018    = "";
     &eaPasaR2019    = "";
|FIN;

|PROCESO asclient;
     #dsam0000#0 = #asclient#0;
     |LEE 040#dsam0000.=;
     |SI FSalida = 0;   |ACABA;  |FINSI;

     |BORRA 020#asclient.a;
     |LIBERA #asclient;
|FPRC;

|DEFBUCLE asclient;
     #asclient#1;
     ;
     00001;
     99999;
     be;
     NULL, asclient;
|FIN;

|PROCESO facemp1;
     aBase = "";
     |DBASS aBase;  |QBT aBase;
     aBase = aBase + "facturar/fich/";
     aAlfa = aBase + (("00" + #facemp1#0) % -102) + "/";  |QBT aAlfa;

     |PATH_DAT #asclient#aAlfa#;

     |BUCLE asclient;
|FPRC;

|DEFBUCLE facemp1;
     #facemp1#2;
     ;
     "S", 00;
     "S", 99;
     ;
     NULL, facemp1;
|FIN;

|PROCESO agifigen;
     #dsam0000#0 = #agifigen#0;
     |LEE 040#dsam0000.=;
     |SI FSalida = 0;   |ACABA;  |FINSI;

     |BORRA 020#agifigen.a;
     |LIBERA #agifigen;
|FPRC;

|DEFBUCLE agifigen;
     #agifigen#1;
     ;
     00001;
     99999;
     be;
     NULL, agifigen;
|FIN;

|PROCESO IgualaClientes;
     |ABRE #dsam0000;
     |BUCLE facemp1;
     |BUCLE agifigen;
     |CIERRA #dsam0000;
|FPRC;

|PROCESO dsborrm1M;
     #dsborrm1#15 = aAlfa;
     |GRABA 020#dsborrm1.a;
     |LIBERA #dsborrm1;
|FPRC;

|DEFBUCLE dsborrm1M;
     #dsborrm1#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, dsborrm1M;
|FIN;

|PROCESO Tipo11;  |TIPO 11;
     |SI FSalida = 10;
         |LEE 101#dsborrm1.=;

         |SI #dsborrm1#15 = "SI";
             #dsborrm1#15 = "NO";
         |SINO;
             #dsborrm1#15 = "SI";
         |FINSI;
         |GRABA 020#dsborrm1.a;
         |LIBERA #dsborrm1;
         |PINTA #dsborrm1#15;
         |ERROR;
     |FINSI;

     |SI FSalida = 11;
         aAlfa = "SI";
         |BUCLE dsborrm1M;
         |PONCONTROL  23, "SI";
         |PTEC 812;
     |FINSI;

     |SI FSalida = 12;
         aAlfa = "NO";
         |BUCLE dsborrm1M;
         |PONCONTROL  23, "SI";
         |PTEC 812;
     |FINSI;
|FPRC;

|PROCESO dspase16;
     |SI #dspase16#3 ! 0;
         aFact = "S";
     |FINSI;

     |SI #dspase16#3 ! 0;  |Y #dsborrma#12 = "NO";
         nFact = 1;
         |ERROR10;
         |ACABA;
     |FINSI;
|FPRC;

|DEFBUCLE dspase16;
     #dspase16#1;
     ;
     #dspase15#0, #dspase15#1, 01;
     #dspase15#0, #dspase15#1, 99;
     ;
     NULL, dspase16;
|FIN;

|PROCESO dspase15;
     |SI #dspase15#22 = "S";                  |ACABA;  |FINSI;
     |SI #dspase15#17 ! 0;  |Y #dsborrma#0  = "NO";  |ACABA;  |FINSI;
     |SI #dspase15#5  ! 0;  |Y #dsborrma#1  = "NO";  |ACABA;  |FINSI;
     |SI #dspase15#6  ! 0;  |Y #dsborrma#2  = "NO";  |ACABA;  |FINSI;
     |SI #dspase15#7  ! 0;  |Y #dsborrma#3  = "NO";  |ACABA;  |FINSI;
     |SI #dspase15#14 ! 0;  |Y #dsborrma#4  = "NO";  |ACABA;  |FINSI;
     |SI #dspase15#13 ! 0;  |Y #dsborrma#5  = "NO";  |ACABA;  |FINSI;
     |SI #dspase15#12 ! 0;  |Y #dsborrma#6  = "NO";  |ACABA;  |FINSI;
     |SI #dspase15#11 ! 0;  |Y #dsborrma#7  = "NO";  |ACABA;  |FINSI;
     |SI #dspase15#10 ! 0;  |Y #dsborrma#8  = "NO";  |ACABA;  |FINSI;
     |SI #dspase15#9  ! 0;  |Y #dsborrma#9  = "NO";  |ACABA;  |FINSI;
     |SI #dspase15#8  ! 0;  |Y #dsborrma#10 = "NO";  |ACABA;  |FINSI;
     |SI #dspase15#23 ! 0;  |Y #dsborrma#11 = "NO";  |ACABA;  |FINSI;
     |SI #dspase15#24 ! 0;  |Y #dsborrma#13 = "NO";  |ACABA;  |FINSI;
     |SI #dspase15#25 ! 0;  |Y #dsborrma#14 = "NO";  |ACABA;  |FINSI;
     |SI #dspase15#26 ! 0;  |Y #dsborrma#15 = "NO";  |ACABA;  |FINSI;
     |SI #dspase15#27 ! 0;  |Y #dsborrma#16 = "NO";  |ACABA;  |FINSI;
     |SI #dspase15#28 ! 0;  |Y #dsborrma#17 = "NO";  |ACABA;  |FINSI;
     |SI #dspase15#29 ! 0;  |Y #dsborrma#18 = "NO";  |ACABA;  |FINSI;
     |SI #dspase15#30 ! 0;  |Y #dsborrma#19 = "NO";  |ACABA;  |FINSI;
     |SI #dspase15#31 ! 0;  |Y #dsborrma#20 = "NO";  |ACABA;  |FINSI;
     |SI #dspase15#32 ! 0;  |Y #dsborrma#21 = "NO";  |ACABA;  |FINSI;
     |SI #dspase15#33 ! 0;  |Y #dsborrma#22 = "NO";  |ACABA;  |FINSI;   || ren2011
     |SI #dspase15#34 ! 0;  |Y #dsborrma#23 = "NO";  |ACABA;  |FINSI;   || ren2012
     |SI #dspase15#35 ! 0;  |Y #dsborrma#24 = "NO";  |ACABA;  |FINSI;   || ren2013
     |SI #dspase15#36 ! 0;  |Y #dsborrma#25 = "NO";  |ACABA;  |FINSI;   || ren2014
     |SI #dspase15#37 ! 0;  |Y #dsborrma#26 = "NO";  |ACABA;  |FINSI;   || ren2015
     |SI #dspase15#38 ! 0;  |Y #dsborrma#27 = "NO";  |ACABA;  |FINSI;   || ren2016
     |SI #dspase15#39 ! 0;  |Y #dsborrma#28 = "NO";  |ACABA;  |FINSI;   || ren2017
     |SI #dspase15#40 ! 0;  |Y #dsborrma#29 = "NO";  |ACABA;  |FINSI;   || ren2018
     |SI #dspase15#41 ! 0;  |Y #dsborrma#30 = "NO";  |ACABA;  |FINSI;   || ren2019

     aFact = "N";
     nFact = 0;
     |BUCLE dspase16;

     |SI nFact = 1; |ACABA;  |FINSI;

     #dsborrm1#0 = #dspase15#3;
     |LEE 101#dsborrm1.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsborrm1;
         #dsborrm1#0 = #dspase15#3;
         #dsborrm1#1 = #dspase15#2;
         |GRABA 020#dsborrm1.b;
     |FINSI;

     |SI #dspase15#17 ! 0;  #dsborrm1#2  = "S";    |FINSI;
     |SI #dspase15#5  ! 0;  #dsborrm1#3  = "S";    |FINSI;
     |SI #dspase15#6  ! 0;  #dsborrm1#4  = "S";    |FINSI;
     |SI #dspase15#7  ! 0;  #dsborrm1#5  = "S";    |FINSI;
     |SI #dspase15#14 ! 0;  #dsborrm1#6  = "S";    |FINSI;
     |SI #dspase15#13 ! 0;  #dsborrm1#7  = "S";    |FINSI;
     |SI #dspase15#12 ! 0;  #dsborrm1#8  = "S";    |FINSI;
     |SI #dspase15#11 ! 0;  #dsborrm1#9  = "S";    |FINSI;
     |SI #dspase15#10 ! 0;  #dsborrm1#10 = "S";    |FINSI;
     |SI #dspase15#9  ! 0;  #dsborrm1#11 = "S";    |FINSI;
     |SI #dspase15#8  ! 0;  #dsborrm1#12 = "S";    |FINSI;
     |SI #dspase15#23 ! 0;  #dsborrm1#13 = "S";    |FINSI;
     |SI #dspase15#24 ! 0;  #dsborrm1#16 = "S";    |FINSI;
     |SI #dspase15#25 ! 0;  #dsborrm1#17 = "S";    |FINSI;
     |SI #dspase15#26 ! 0;  #dsborrm1#18 = "S";    |FINSI;
     |SI #dspase15#27 ! 0;  #dsborrm1#19 = "S";    |FINSI;
     |SI #dspase15#28 ! 0;  #dsborrm1#20 = "S";    |FINSI;
     |SI #dspase15#29 ! 0;  #dsborrm1#21 = "S";    |FINSI;
     |SI #dspase15#30 ! 0;  #dsborrm1#22 = "S";    |FINSI;
     |SI #dspase15#31 ! 0;  #dsborrm1#23 = "S";    |FINSI;
     |SI #dspase15#32 ! 0;  #dsborrm1#24 = "S";    |FINSI;
     |SI #dspase15#33 ! 0;  #dsborrm1#25 = "S";    |FINSI;
     |SI #dspase15#34 ! 0;  #dsborrm1#26 = "S";    |FINSI;
     |SI #dspase15#35 ! 0;  #dsborrm1#27 = "S";    |FINSI;   || 2013
     |SI #dspase15#36 ! 0;  #dsborrm1#28 = "S";    |FINSI;   || 2014
     |SI #dspase15#37 ! 0;  #dsborrm1#29 = "S";    |FINSI;   || 2015
     |SI #dspase15#38 ! 0;  #dsborrm1#30 = "S";    |FINSI;   || 2016
     |SI #dspase15#39 ! 0;  #dsborrm1#31 = "S";    |FINSI;   || 2017
     |SI #dspase15#40 ! 0;  #dsborrm1#32 = "S";    |FINSI;   || 2018
     |SI #dspase15#41 ! 0;  #dsborrm1#33 = "S";    |FINSI;   || 2019
                            #dsborrm1#14 = aFact;

     nBueno = 0;
     |PARA nCampo = 2;  |SI nCampo [ 44;  |HACIENDO nCampo = nCampo + 1;
           |SI #dsborrm1#Campo# = "S";  nBueno = 1;  |FINSI;
     |SIGUE;

     |PARA nCampo = 16;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
           |SI #dsborrm1#Campo# = "S";  nBueno = 1;  |FINSI;
     |SIGUE;

     |SI nBueno = 0;
         nBueno = 1;
         |PARA nCampo = 0;  |SI nCampo [ 22;  |HACIENDO nCampo = nCampo + 1;
               |SI #dsborrma#nCampo# = "SI";  nBueno = 0;  |FINSI;
         |SIGUE;
     |FINSI;

     |SI nBueno = 0;
         |BORRA 020#dsborrm1.a;
         |LIBERA #dsborrm1;
         |ACABA;
     |FINSI;

     |GRABA 020#dsborrm1.a;
     |LIBERA #dsborrm1;

     nSwHay = 1;
|FPRC;

|DEFBUCLE dspase15;
     #dspase15#3;
     ;
     00001, "            ", 000;
     99999, "zzzzzzzzzzzz", 999;
     ;
     NULL, dspase15;
|FIN;

|PROCESO dspase15B;
     #dspase15#22 = "S";
     |GRABA 020#dspase15.a;
     |LIBERA #dspase15;
|FPRC;

|DEFBUCLE dspase15B;
     #dspase15#3;
     ;
     #dsborrm1#0, "            ", 000;
     #dsborrm1#0, "zzzzzzzzzzzz", 999;
     be;
     NULL, dspase15B;
|FIN;

|PROCESO dsborrm1;
     enCambioCli = 4;
     enEmpresa   = #dsborrm1#0;

     eaPasaCont     = "NO";
     eaPasaFisc     = "NO";
     eaPasaSoci     = "NO";
     eaPasaLabo     = "NO";
     eaPasaFact     = "NO";
     eaPasaMaes     = "NO";
     eaPasaArch     = "NO";
     eaPasaR1994    = "NO";
     eaPasaR1995    = "NO";
     eaPasaR1996    = "NO";
     eaPasaR1997    = "NO";
     eaPasaR1998    = "NO";
     eaPasaR1999    = "NO";
     eaPasaR2000    = "NO";
     eaPasaR2001    = "NO";
     eaPasaR2002    = "NO";
     eaPasaR2003    = "NO";
     eaPasaR2004    = "NO";
     eaPasaR2005    = "NO";
     eaPasaR2006    = "NO";
     eaPasaR2007    = "NO";
     eaPasaR2008    = "NO";
     eaPasaR2009    = "NO";
     eaPasaR2010    = "NO";
     eaPasaR2011    = "NO";
     eaPasaR2012    = "NO";
     eaPasaR2013    = "NO";
     eaPasaR2014    = "NO";
     eaPasaR2015    = "NO";
     eaPasaR2016    = "NO";
     eaPasaR2017    = "NO";
     eaPasaR2018    = "NO";
     eaPasaR2019    = "NO";
     eaPasaCact     = "N";
     eaPasaNuct     = "";

                       eaPasaMaes     = "SI";           || Maestros
     |SI #dsborrm1#2  = "S";  eaPasaFisc     = "SI";  |FINSI;  || Fiscal
     |SI #dsborrm1#3  = "S";  eaPasaLabo     = "SI";  |FINSI;  || Laboral
     |SI #dsborrm1#4  = "S";  eaPasaCont     = "SI";  |FINSI;  || Contabilidad
     |SI #dsborrm1#5  = "S";  eaPasaSoci     = "SI";  |FINSI;  || Sociedades
     |SI #dsborrm1#6  = "S";  eaPasaR1994    = "SI";  |FINSI;  || Renta 1994
     |SI #dsborrm1#7  = "S";  eaPasaR1995    = "SI";  |FINSI;  || Renta 1995
     |SI #dsborrm1#8  = "S";  eaPasaR1996    = "SI";  |FINSI;  || Renta 1996
     |SI #dsborrm1#9  = "S";  eaPasaR1997    = "SI";  |FINSI;  || Renta 1997
     |SI #dsborrm1#10 = "S";  eaPasaR1998    = "SI";  |FINSI;  || Renta 1998
     |SI #dsborrm1#11 = "S";  eaPasaR1999    = "SI";  |FINSI;  || Renta 1999
     |SI #dsborrm1#12 = "S";  eaPasaR2000    = "SI";  |FINSI;  || Renta 2000
     |SI #dsborrm1#13 = "S";  eaPasaR2001    = "SI";  |FINSI;  || Renta 2001
     |SI #dsborrm1#16 = "S";  eaPasaR2002    = "SI";  |FINSI;  || Renta 2002
     |SI #dsborrm1#17 = "S";  eaPasaR2003    = "SI";  |FINSI;  || Renta 2003
     |SI #dsborrm1#18 = "S";  eaPasaR2004    = "SI";  |FINSI;  || Renta 2004
     |SI #dsborrm1#19 = "S";  eaPasaR2005    = "SI";  |FINSI;  || Renta 2005
     |SI #dsborrm1#20 = "S";  eaPasaR2006    = "SI";  |FINSI;  || Renta 2006
     |SI #dsborrm1#21 = "S";  eaPasaR2007    = "SI";  |FINSI;  || Renta 2007
     |SI #dsborrm1#22 = "S";  eaPasaR2008    = "SI";  |FINSI;  || Renta 2008
     |SI #dsborrm1#23 = "S";  eaPasaR2009    = "SI";  |FINSI;  || Renta 2009
     |SI #dsborrm1#24 = "S";  eaPasaR2010    = "SI";  |FINSI;  || Renta 2010
     |SI #dsborrm1#25 = "S";  eaPasaR2011    = "SI";  |FINSI;  || Renta 2011
     |SI #dsborrm1#26 = "S";  eaPasaR2012    = "SI";  |FINSI;  || Renta 2012
     |SI #dsborrm1#27 = "S";  eaPasaR2013    = "SI";  |FINSI;  || Renta 2013
     |SI #dsborrm1#28 = "S";  eaPasaR2014    = "SI";  |FINSI;  || Renta 2014
     |SI #dsborrm1#29 = "S";  eaPasaR2015    = "SI";  |FINSI;  || Renta 2015
     |SI #dsborrm1#30 = "S";  eaPasaR2016    = "SI";  |FINSI;  || Renta 2016
     |SI #dsborrm1#31 = "S";  eaPasaR2017    = "SI";  |FINSI;  || Renta 2017
     |SI #dsborrm1#32 = "S";  eaPasaR2018    = "SI";  |FINSI;  || Renta 2018
     |SI #dsborrm1#33 = "S";  eaPasaR2019    = "SI";  |FINSI;  || Renta 2019
     |SI #dsborrm1#14 = "S";  eaPasaFact     = "SI";  |FINSI;  || Facturacion

     |SUB_EJECUTA_NP "dsborrad";

     |BUCLE dspase15B;

     |SI aParametro ! "";
         |BORRA 020#dsborrm1.a;
     |FINSI;
     |LIBERA #dsborrm1;
|FPRC;

|DEFBUCLE dsborrm1;
     #dsborrm1#1;
     15;
     00001, "SI";
     99999, "SI";
     be;
     NULL, dsborrm1;
|FIN;

|RUTINA ClaveBaja2;
     #dsborrm1#0 = 1;
|FRUT;

|RUTINA ClaveAlta2;
     #dsborrm1#0 = 99999;
|FRUT;

|PROCESO Tipo3;  |TIPO 3;
     aFichero = ("m1" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #dsborrm1#aFichero#;
     |ABRE #dsborrm1;  |CIERRA #dsborrm1;  |DELINDEX #dsborrm1;
     nSwHay = 0;

     |ABRE #dsborrm1;
     |BUCLE dspase15;
     |CIERRA #dsborrm1;

     |SI nSwHay = 0;
         |MENAV "0000 Seleccion Vacia";
         |DELINDEX #dsborrm1;
         |ACABA;
     |FINSI;

     |ENTLINEAL #1#dsborrm1, -1, 4, 22, 1, ClaveBaja2, ClaveAlta2;

     |CONFI "0000NConforme con lo seleccionado ";
     |SI FSalida ! 0;
         |DELINDEX #dsborrm1;
         |ACABA;
     |FINSI;

     |BUCLE dsborrm1;

     |DELINDEX #dsborrm1;

     |HAZ IgualaClientes;
|FPRC;

|PROCESO dspase15M;
     |SI #dspase15#22 = "S";  |ACABA;  |FINSI;

     aFact = "N";
     nFact = 0;
     |BUCLE dspase16;

     |SI #dspase15#17 ! 0;  #dsborrm1#2  = "S";    |FINSI;
     |SI #dspase15#5  ! 0;  #dsborrm1#3  = "S";    |FINSI;
     |SI #dspase15#6  ! 0;  #dsborrm1#4  = "S";    |FINSI;
     |SI #dspase15#7  ! 0;  #dsborrm1#5  = "S";    |FINSI;
     |SI #dspase15#14 ! 0;  #dsborrm1#6  = "S";    |FINSI;
     |SI #dspase15#13 ! 0;  #dsborrm1#7  = "S";    |FINSI;
     |SI #dspase15#12 ! 0;  #dsborrm1#8  = "S";    |FINSI;
     |SI #dspase15#11 ! 0;  #dsborrm1#9  = "S";    |FINSI;
     |SI #dspase15#10 ! 0;  #dsborrm1#10 = "S";    |FINSI;
     |SI #dspase15#9  ! 0;  #dsborrm1#11 = "S";    |FINSI;
     |SI #dspase15#8  ! 0;  #dsborrm1#12 = "S";    |FINSI;
     |SI #dspase15#23 ! 0;  #dsborrm1#13 = "S";    |FINSI;
     |SI #dspase15#24 ! 0;  #dsborrm1#16 = "S";    |FINSI;
     |SI #dspase15#25 ! 0;  #dsborrm1#17 = "S";    |FINSI;
     |SI #dspase15#26 ! 0;  #dsborrm1#18 = "S";    |FINSI;
     |SI #dspase15#27 ! 0;  #dsborrm1#19 = "S";    |FINSI;
     |SI #dspase15#28 ! 0;  #dsborrm1#20 = "S";    |FINSI;
     |SI #dspase15#29 ! 0;  #dsborrm1#21 = "S";    |FINSI;
     |SI #dspase15#30 ! 0;  #dsborrm1#22 = "S";    |FINSI;
     |SI #dspase15#31 ! 0;  #dsborrm1#23 = "S";    |FINSI;
     |SI #dspase15#32 ! 0;  #dsborrm1#24 = "S";    |FINSI;
     |SI #dspase15#33 ! 0;  #dsborrm1#25 = "S";    |FINSI;
     |SI #dspase15#34 ! 0;  #dsborrm1#26 = "S";    |FINSI;
     |SI #dspase15#35 ! 0;  #dsborrm1#27 = "S";    |FINSI;   || 2013
     |SI #dspase15#36 ! 0;  #dsborrm1#28 = "S";    |FINSI;   || 2014
     |SI #dspase15#37 ! 0;  #dsborrm1#29 = "S";    |FINSI;   || 2015
     |SI #dspase15#38 ! 0;  #dsborrm1#30 = "S";    |FINSI;   || 2016
     |SI #dspase15#39 ! 0;  #dsborrm1#31 = "S";    |FINSI;   || 2017
     |SI #dspase15#40 ! 0;  #dsborrm1#32 = "S";    |FINSI;   || 2018
     |SI #dspase15#41 ! 0;  #dsborrm1#33 = "S";    |FINSI;   || 2019
                            #dsborrm1#14 = aFact;

     #dsborrm1#1  = #dspase15#2;
     #dsborrm1#15 = "SI";

     nSwHay = 1;
|FPRC;

|DEFBUCLE dspase15M;
     #dspase15#3;
     ;
     #dsborrm1#0, "            ", 000;
     #dsborrm1#0, "zzzzzzzzzzzz", 999;
     ;
     NULL, dspase15M;
|FIN;

|PROCESO CogeDatos;
     |SI aParametro = "";  |ACABA;  |FINSI;

     nSwHay = 0;
     |BUCLE dspase15M;
     |SI nSwHay = 0;
         |MENAV "     No existe Cliente";
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;

|PROGRAMA;
     aParametro = PARAMETRO;  |QBF aParametro;

     |ABRE #dspase00;
     |LEE 040#dspase00.p;
     |SI FSalida ! 0;
         |MENAV "     No se ha hecho el Pase de la Gestion Anterior";
         |CIERRA #dspase00;
         |ACABA;
     |FINSI;
     |CIERRA #dspase00;

     |ABRE #dspase15;
     |LEE 040#dspase15.p;
     |SI FSalida ! 0;
         |MENAV "      Unificacion de Codigos no Realizada.";
         |ACABA;
     |SINO;
         |SI #dspase15#15 ! "S";
             |MENAV "      Unificacion de Codigos no Realizada.";
             |CIERRA #dspase15;
             |ACABA;
         |FINSI;
     |FINSI;
     |CIERRA #dspase15;

     |CUADRO 0501 2380;
     |BLANCO 0602 2279;
     |PINTA 1320, "Introduzca Password : ";
     E_inf = "";
     E_sup = "21";
     aPassword = 1342 ? -1;
     |SI aPassword ! "<MYPASWD>";
         |MENAV "     Permiso denegado.";
         |ACABA;
     |FINSI;

     |SI aParametro = "";
         |MANTE #dsborrma;
     |SINO;
         |ENTLINEAL #1#dsborrm1, -1, 2, 22, 1, ClaveBaja2, ClaveAlta2;
         |CONFI "0000NDesea hacer el Borrado en estos Momentos";
         |SI FSalida = 0;
             |BUCLE dsborrm1;
             |HAZ IgualaClientes;
         |FINSI;
     |FINSI;
|FPRO;
