|FICHEROS;
     dsfinifc;
     dsfinifl,MANTE;

     referen@;
|FIN;

|VARIABLES;
     nSw        = 0;
     nCampo     = 0;
     nCampo1    = 0;
     nModo      = 0;
     nForma     = 0;
     nTCompo    = 0;
     nCompo     = 0;
     nPosi      = 0;

     aBase         = "";
     aDef          = "";
     aAlfa         = "";
     aAlfa1        = "";
     aQueQuiero    = "";
     aDescri       = "";
     aPassword     = "";
     aClave        = "";

     nCampoClave1  = 0;
     nCampoClave2  = 0;
     nCampoClave3  = 0;
     nCampoClave4  = 0;
     nCampoClave5  = 0;
     nCampoClave6  = 0;
     nCampoClave7  = 0;
     nCampoClave8  = 0;
     nCampoClave9  = 0;
     nCampoClave10 = 0;
     nCampoClave11 = 0;
     nCampoClave12 = 0;
     nCampoClave13 = 0;
     nCampoClave14 = 0;
     nCampoClave15 = 0;
     nCampoClave16 = 0;
|FIN;

|RUTINA ClaveBaja0;
     #dsfinifc#0 = "        ";
     #dsfinifc#1 = "            ";
|FRUT;

|RUTINA ClaveAlta0;
     #dsfinifc#0 = "zzzzzzzz";
     #dsfinifc#1 = "zzzzzzzzzzzz";
|FRUT;

|RUTINA ClaveBaja1;
     #dsfinifl#0 = #dsfinifc#0;
     #dsfinifl#1 = #dsfinifc#1;
     #dsfinifl#2 = 000;
|FRUT;

|RUTINA ClaveAlta1;
     #dsfinifl#0 = #dsfinifc#0;
     #dsfinifl#1 = #dsfinifc#1;
     #dsfinifl#2 = 999;
|FRUT;

|PROCESO Tipo7;  |TIPO 7;
     |ENTLINEAL #1#dsfinifl, -3, 7, 22, 0, ClaveBaja1, ClaveAlta1;
|FPRC;

|PROCESO PintaCampo;  |TIPO 7;
     aAlfa = "|C" + (("000" + #dsfinifl#2) % -103) + "NOMBRE";
     #dsfinifl#3  = (#referen@#aAlfa# + (" " * 20)) % 120;

                                #dsfinifl#4 = "N";
     |SI #dsfinifl#2 = nCampoClave1;   #dsfinifl#4 = "S";  |FINSI;
     |SI #dsfinifl#2 = nCampoClave2;   #dsfinifl#4 = "S";  |FINSI;
     |SI #dsfinifl#2 = nCampoClave3;   #dsfinifl#4 = "S";  |FINSI;
     |SI #dsfinifl#2 = nCampoClave4;   #dsfinifl#4 = "S";  |FINSI;
     |SI #dsfinifl#2 = nCampoClave5;   #dsfinifl#4 = "S";  |FINSI;
     |SI #dsfinifl#2 = nCampoClave6;   #dsfinifl#4 = "S";  |FINSI;
     |SI #dsfinifl#2 = nCampoClave7;   #dsfinifl#4 = "S";  |FINSI;
     |SI #dsfinifl#2 = nCampoClave8;   #dsfinifl#4 = "S";  |FINSI;
     |SI #dsfinifl#2 = nCampoClave9;   #dsfinifl#4 = "S";  |FINSI;
     |SI #dsfinifl#2 = nCampoClave10;  #dsfinifl#4 = "S";  |FINSI;
     |SI #dsfinifl#2 = nCampoClave11;  #dsfinifl#4 = "S";  |FINSI;
     |SI #dsfinifl#2 = nCampoClave12;  #dsfinifl#4 = "S";  |FINSI;
     |SI #dsfinifl#2 = nCampoClave13;  #dsfinifl#4 = "S";  |FINSI;
     |SI #dsfinifl#2 = nCampoClave14;  #dsfinifl#4 = "S";  |FINSI;
     |SI #dsfinifl#2 = nCampoClave15;  #dsfinifl#4 = "S";  |FINSI;
     |SI #dsfinifl#2 = nCampoClave16;  #dsfinifl#4 = "S";  |FINSI;

     |PINTA #dsfinifl#3;
     |PINTA #dsfinifl#4;
|FPRC;

|PROCESO Paquete;
     nSw = 1;
     |SI #dsfinifc#0 = "integral";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "modelos ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "laboral ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "contagen";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "contanex";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "contasoc";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "basica  ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "facturar";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren2019 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren2018 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren2017 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren2016 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren2015 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren2014 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren2013 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren2012 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren2011 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren2010 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren2009 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren2008 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren2007 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren2006 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren2005 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren2004 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren2003 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren2002 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren2001 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren2000 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren1999 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren1998 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren1997 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren1996 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren1995 ";  nSw = 0;  |FINSI;
     |SI #dsfinifc#0 = "ren1994 ";  nSw = 0;  |FINSI;

     |SI nSw = 1;
         |MENAV "0000 Paquete incorrecto.";
     |FINSI;
|FPRC;

|PROCESO Fichero;
     |DBASS aBase;   |QBT aBase;
     aDef = aBase + #dsfinifc#0 + "/def/" + #dsfinifc#1;  |QBT aDef;
     |CARGA_DEF aDef, referen@;
     |SI FSalida ! 0;
         aAlfa = "     No existe el Def " + aDef + " en este paquete";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aQueQuiero = "|TITULO";
     aDescri    = #referen@#aQueQuiero#;

     aAlfa         = "|K000";
     aClave        = #referen@#aAlfa#;
     aAlfa         = aClave % 103;
     nTCompo       = aAlfa;

     |SI nTCompo = 0;
         |MENAV "0000 El def no es un fichero.";
         |ERROR;
     |FINSI;

     |DESCARGA_DEF #referen@;
|FPRC;

|PROCESO Descri;  |TIPO 7;
     #dsfinifc#2 = aDescri;  |PINTA  #dsfinifc#2;
|FPRC;

|PROCESO dsfinifl;
     |BORRA 020#dsfinifl.a;
     |LIBERA #dsfinifl;
|FPRC;

|DEFBUCLE dsfinifl;
     #dsfinifl#1;
     ;
     #dsfinifc#0, #dsfinifc#1, 000;
     #dsfinifc#0, #dsfinifc#1, 999;
     be;
     NULL, dsfinifl;
|FIN;

|PROCESO Tipo2;  |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
         |BUCLE dsfinifl;
         |ACABA;
     |FINSI;

     nForma = 0 +. 1;
     |SI nForma ! 1;  |ACABA;  |FINSI;

     |DBASS aBase;   |QBT aBase;
     aDef = aBase + #dsfinifc#0 + "/def/" + #dsfinifc#1;  |QBT aDef;
     |CARGA_DEF aDef, referen@;
     |SI FSalida ! 0;
         aAlfa = "     No existe el Def " + aDef + " en este paquete";
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa         = "|K000";
     aClave        = #referen@#aAlfa#;
     aAlfa         = aClave % 103;
     nTCompo       = aAlfa;

     nCampoClave1  = -1;
     nCampoClave2  = -1;
     nCampoClave3  = -1;
     nCampoClave4  = -1;
     nCampoClave5  = -1;
     nCampoClave6  = -1;
     nCampoClave7  = -1;
     nCampoClave8  = -1;
     nCampoClave9  = -1;
     nCampoClave10 = -1;
     nCampoClave11 = -1;
     nCampoClave12 = -1;
     nCampoClave13 = -1;
     nCampoClave14 = -1;
     nCampoClave15 = -1;
     nCampoClave16 = -1;

     |PARA nCompo = 1;  |SI nCompo [ nTCompo;  |HACIENDO nCompo = nCompo + 1;
           nPosi    = (nCompo * 300) + 103;
           aAlfa1   = aClave % nPosi;  |QBF aAlfa1;
           |SI aAlfa1 = "";  |SAL;  |FINSI;

           |SI nCompo = 1;   nCampoClave1  = aAlfa1;  |FINSI;
           |SI nCompo = 2;   nCampoClave2  = aAlfa1;  |FINSI;
           |SI nCompo = 3;   nCampoClave3  = aAlfa1;  |FINSI;
           |SI nCompo = 4;   nCampoClave4  = aAlfa1;  |FINSI;
           |SI nCompo = 5;   nCampoClave5  = aAlfa1;  |FINSI;
           |SI nCompo = 6;   nCampoClave6  = aAlfa1;  |FINSI;
           |SI nCompo = 7;   nCampoClave7  = aAlfa1;  |FINSI;
           |SI nCompo = 8;   nCampoClave8  = aAlfa1;  |FINSI;
           |SI nCompo = 9;   nCampoClave9  = aAlfa1;  |FINSI;
           |SI nCompo = 10;  nCampoClave10 = aAlfa1;  |FINSI;
           |SI nCompo = 11;  nCampoClave11 = aAlfa1;  |FINSI;
           |SI nCompo = 12;  nCampoClave12 = aAlfa1;  |FINSI;
           |SI nCompo = 13;  nCampoClave13 = aAlfa1;  |FINSI;
           |SI nCompo = 14;  nCampoClave14 = aAlfa1;  |FINSI;
           |SI nCompo = 15;  nCampoClave15 = aAlfa1;  |FINSI;
           |SI nCompo = 16;  nCampoClave16 = aAlfa1;  |FINSI;
     |SIGUE;

     |ENTLINEAL #1#dsfinifl, -3, 2, 22, 0, ClaveBaja1, ClaveAlta1;

     |DESCARGA_DEF #referen@;
|FPRC;

|PROCESO DuplicaCampos;
     #dsfinifl#0 = "ren2019";
     |GRABA 020#dsfinifl.n;
     |LIBERA #dsfinifl;
|FPRC;

|DEFBUCLE DuplicaCampos;
     #dsfinifl#1;
     ;
     #dsfinifc#0, #dsfinifc#1, 000;
     #dsfinifc#0, #dsfinifc#1, 999;
     be;
     NULL, DuplicaCampos;
|FIN;

|PROCESO Graba2019;
     |BUCLE DuplicaCampos;

     #dsfinifc#0 = "ren2019";
     |GRABA 020#dsfinifc.n;
     |LIBERA #dsfinifc;
|FPRC;

|DEFBUCLE DuplicaRenta;
     #dsfinifc#1;
     ;
     "ren2018", "            ";
     "ren2018", "zzzzzzzzzzzz";
     be;
     NULL, Graba2019;
|FIN;

|PROGRAMA;
     |CUADRO 0501 2380;
     |BLANCO 0602 2279;
     |PINTA 1320, "Introduzca Password : ";
     E_inf = "";
     E_sup = "20";
     aPassword = 1342 ? -1;
     |SI aPassword ! "<MYPASWD>   ";
         |MENAV "     Permiso denegado.";
         |ACABA;
     |FINSI;

/*
     |ABRE #dsfinifl;
     |BUCLE DuplicaRenta;
     |CIERRA #dsfinifl;
*/

     |ENTLINEAL #1#dsfinifc, -1, 2, 22, 1, ClaveBaja0, ClaveAlta0;
|FPRO;
