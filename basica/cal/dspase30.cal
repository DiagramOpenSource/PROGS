|FICHEROS;
     dspase15 #15;
     dspase30 #30;

     :/integral/def/dsam0000 #100;

     reacceso@ #900;
     rem00100@ #901;
|FIN;

|VARIABLES;
     aPassword       = "";
     aNIF            = "";
     aNombre         = "";
     aRenta          = "";
     aDef            = "";
     aMas            = "";
     aFichero        = "";
     aFich           = "";
     aAlfa           = "";

     nHay            = 0;
     nGraba          = 0;
     nCodigo         = 0;
     nAnyo           = 0;

     &eaPathIntegral = "";
     &eaPathRen2018  = "";
     &eaPathRen2017  = "";
     &eaPathRen2016  = "";
     &eaPathRen2015  = "";
     &eaPathRen2014  = "";
     &eaPathRen2013  = "";
     &eaPathRen2012  = "";
     &eaPathRen2011  = "";
     &eaPathRen2010  = "";
     &eaPathRen2009  = "";
     &eaPathRen2008  = "";
     &eaPathRen2007  = "";
     &eaPathRen2006  = "";
     &eaPathRen2005  = "";
     &eaPathRen2004  = "";
     &eaPathRen2003  = "";
     &eaPathRen2002  = "";
     &eaPathRen2001  = "";
     &eaPathRen2000  = "";
     &eaPathRen1999  = "";
     &eaPathRen1998  = "";
     &eaPathRen1997  = "";
     &eaPathRen1996  = "";
     &eaPathRen1995  = "";
     &eaPathRen1994  = "";
     &eaVarDni       = "";
     &enCalcCif      = 0;
     &enCambioCli    = 0;

     &eaPasaRent     = "";
     &eaPasaR1994    = "";
     &eaPasaR1995    = "";
     &eaPasaR1996    = "";
     &eaPasaR1997    = "";
     &eaPasaR1998    = "";
     &eaPasaR1999    = "";
     &eaPasaR2000    = "";
     &eaPasaR2001    = "";
     &eaPasaR2002    = "";
     &eaPasaR2003    = "";
     &eaPasaR2004    = "";
     &eaPasaR2005    = "";
     &eaPasaR2006    = "";
     &eaPasaR2007    = "";
     &eaPasaR2008    = "";
     &eaPasaR2009    = "";
     &eaPasaR2010    = "";
     &eaPasaR2011    = "";
     &eaPasaR2012    = "";
     &eaPasaR2013    = "";
     &eaPasaR2014    = "";
     &eaPasaR2015    = "";
     &eaPasaR2016    = "";
     &eaPasaR2017    = "";
     &eaPasaR2018    = "";
     &eaPasaCact     = "";
     &eaPasaNuct     = "";

     &enEmpresaN     = 0;
     &enEmpresa      = 0;
|FIN;

|PROCESO Intro;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |LEE 101#30=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #30#7 = "*";
         #30#7 = "";
     |SINO;
         #30#7 = "";
         |ENCAMPO #4#30;
         |SI FSalida = 0;  |Y #30#4 ! 0;
             #30#7 = "*";
         |FINSI;
     |FINSI;
     |GRABA 020#30a;
     |LIBERA #30;

     |PINTA #30#7;
|FPRC;

|PROCESO Codigo;
     |SI #30#0 = "RENTA1994 ";  aDef  = eaPathRen1994 + "def/";  |FINSI;
     |SI #30#0 = "RENTA1995 ";  aDef  = eaPathRen1995 + "def/";  |FINSI;
     |SI #30#0 = "RENTA1996 ";  aDef  = eaPathRen1996 + "def/";  |FINSI;
     |SI #30#0 = "RENTA1997 ";  aDef  = eaPathRen1997 + "def/";  |FINSI;
     |SI #30#0 = "RENTA1998 ";  aDef  = eaPathRen1998 + "def/";  |FINSI;
     |SI #30#0 = "RENTA1999 ";  aDef  = eaPathRen1999 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2000 ";  aDef  = eaPathRen2000 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2001 ";  aDef  = eaPathRen2001 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2002 ";  aDef  = eaPathRen2002 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2003 ";  aDef  = eaPathRen2003 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2004 ";  aDef  = eaPathRen2004 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2005 ";  aDef  = eaPathRen2005 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2006 ";  aDef  = eaPathRen2006 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2007 ";  aDef  = eaPathRen2007 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2008 ";  aDef  = eaPathRen2008 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2009 ";  aDef  = eaPathRen2009 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2010 ";  aDef  = eaPathRen2010 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2011 ";  aDef  = eaPathRen2011 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2012 ";  aDef  = eaPathRen2012 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2013 ";  aDef  = eaPathRen2013 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2014 ";  aDef  = eaPathRen2014 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2015 ";  aDef  = eaPathRen2015 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2016 ";  aDef  = eaPathRen2016 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2017 ";  aDef  = eaPathRen2017 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2018 ";  aDef  = eaPathRen2018 + "def/";  |FINSI;

     aMas = aDef + "reacceso.mas";

     |CARGA_DEF aMas, reacceso@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #900;
     #900#0 = #30#4;
     |LEE 000#900=;
     |SI FSalida = 0;  |Y #900#0 ! #30#1;
         |MENAV "0000 Ya existe en la Renta un Contribuyente con este Codigo.";
         |CIERRA #900;
         |DESCARGA_DEF #reacceso@;
         |ERROR;
         |ACABA;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #reacceso@;

     |ABRE #100;
     #100#0 = #30#4;
     |LEE 000#100=;
     |SI FSalida ! 0;
         |MENAV "0000 Codigo Inexistente, Crearemos el Codigo como nuevo en PI";
         |CIERRA #100;
         |ACABA;
     |FINSI;
     |CIERRA #100;

     |SI #100#3 ! #30#2;
         eaVarDni  = #30#2;
         enCalcCif = 1;
         |HAZ CalculoDNI;

         #30#2 = eaVarDni;
         |SI #100#3 ! #30#2;
             |MENAV "0000 El Cliente Existe y con otro NIF";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Baja30;
     #30#0 = "";
     #30#1 = 1;
|FPRC;

|PROCESO Alta30;
     #30#0 = "zzzzzzzzzz";
     #30#1 = 99999;
|FPRC;

|PROCESO dsam0000;
     |SI #100#0 = #900#0;
         nHay = 0;
         |ERROR10;
         |ACABA;
     |FINSI;

     nCodigo = #100#0;
     aNIF    = #100#3;
     aNombre = #100#1;  |QBF aNombre;
     |SI aNombre = "";
         aNombre = #100#2;
     |FINSI;
|FPRC;

|DEFBUCLE dsam0000;
     #100#3;
     ;
     eaVarDni;
     eaVarDni;
     ;
     NULL, dsam0000;
|FIN;

|PROCESO reacceso;
     nHay    = 1;
     nCodigo = 0;
     aNombre = "";
     aNIF    = "";

     eaVarDni  = #900#2;
     |BUCLE dsam0000;

     |SI nHay = 0;  |ACABA;  |FINSI;

     |SI nCodigo = 0;
         eaVarDni  = #900#2;
         enCalcCif = 1;
         |HAZ CalculoDNI;

         |BUCLE dsam0000;
         |SI nHay = 0;  |ACABA;  |FINSI;
     |FINSI;

     |DDEFECTO #30;
     #30#0  = aRenta;
     #30#1  = #900#0;
     #30#2  = #900#2;
     #30#3  = #900#1;

     |SI nCodigo ! 0;
         #30#4 = nCodigo;
         #30#5 = aNIF;
         #30#6 = aNombre;
         #30#7 = "*";
     |FINSI;

     |GRABA 020#30n;
     |LIBERA #30;

     nGraba = 1;
|FPRC;

|DEFBUCLE reacceso;
     #900#1001;
     ;
     00001;
     99999;
     ;
     NULL, reacceso;
|FIN;

|PROCESO DatosRenta;
     |SI nAnyo = 1994;  aRenta = "RENTA1994";  aDef  = eaPathRen1994 + "def/";  |FINSI;
     |SI nAnyo = 1995;  aRenta = "RENTA1995";  aDef  = eaPathRen1995 + "def/";  |FINSI;
     |SI nAnyo = 1996;  aRenta = "RENTA1996";  aDef  = eaPathRen1996 + "def/";  |FINSI;
     |SI nAnyo = 1997;  aRenta = "RENTA1997";  aDef  = eaPathRen1997 + "def/";  |FINSI;
     |SI nAnyo = 1998;  aRenta = "RENTA1998";  aDef  = eaPathRen1998 + "def/";  |FINSI;
     |SI nAnyo = 1999;  aRenta = "RENTA1999";  aDef  = eaPathRen1999 + "def/";  |FINSI;
     |SI nAnyo = 2000;  aRenta = "RENTA2000";  aDef  = eaPathRen2000 + "def/";  |FINSI;
     |SI nAnyo = 2001;  aRenta = "RENTA2001";  aDef  = eaPathRen2001 + "def/";  |FINSI;
     |SI nAnyo = 2002;  aRenta = "RENTA2002";  aDef  = eaPathRen2002 + "def/";  |FINSI;
     |SI nAnyo = 2003;  aRenta = "RENTA2003";  aDef  = eaPathRen2003 + "def/";  |FINSI;
     |SI nAnyo = 2004;  aRenta = "RENTA2004";  aDef  = eaPathRen2004 + "def/";  |FINSI;
     |SI nAnyo = 2005;  aRenta = "RENTA2005";  aDef  = eaPathRen2005 + "def/";  |FINSI;
     |SI nAnyo = 2006;  aRenta = "RENTA2006";  aDef  = eaPathRen2006 + "def/";  |FINSI;
     |SI nAnyo = 2007;  aRenta = "RENTA2007";  aDef  = eaPathRen2007 + "def/";  |FINSI;
     |SI nAnyo = 2008;  aRenta = "RENTA2008";  aDef  = eaPathRen2008 + "def/";  |FINSI;
     |SI nAnyo = 2009;  aRenta = "RENTA2009";  aDef  = eaPathRen2009 + "def/";  |FINSI;
     |SI nAnyo = 2010;  aRenta = "RENTA2010";  aDef  = eaPathRen2010 + "def/";  |FINSI;
     |SI nAnyo = 2011;  aRenta = "RENTA2011";  aDef  = eaPathRen2011 + "def/";  |FINSI;
     |SI nAnyo = 2012;  aRenta = "RENTA2012";  aDef  = eaPathRen2012 + "def/";  |FINSI;
     |SI nAnyo = 2013;  aRenta = "RENTA2013";  aDef  = eaPathRen2013 + "def/";  |FINSI;
     |SI nAnyo = 2014;  aRenta = "RENTA2014";  aDef  = eaPathRen2014 + "def/";  |FINSI;
     |SI nAnyo = 2015;  aRenta = "RENTA2015";  aDef  = eaPathRen2015 + "def/";  |FINSI;
     |SI nAnyo = 2016;  aRenta = "RENTA2016";  aDef  = eaPathRen2016 + "def/";  |FINSI;
     |SI nAnyo = 2017;  aRenta = "RENTA2017";  aDef  = eaPathRen2017 + "def/";  |FINSI;
     |SI nAnyo = 2018;  aRenta = "RENTA2018";  aDef  = eaPathRen2018 + "def/";  |FINSI;

     aMas = aDef + "reacceso.mas";

     |CARGA_DEF aMas, reacceso@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BUCLE reacceso;

     |DESCARGA_DEF #reacceso@;
|FPRC;

|PROCESO Graba100;
     #901#0 = #100#0;
     |LEE 000#901=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |DDEFECTO #100;
     #100#0   = #901#0;
     #100#1   = #901#5;
     #100#2   = #901#5;
     #100#3   = #901#1;
     #100#54  = #901#12;
     #100#55  = #901#13;
     #100#19  = #901#14;
     #100#20  = #901#15;
     #100#21  = #901#16;
     #100#22  = #901#17;
     #100#23  = #901#18;
     #100#24  = #901#19;
     #100#25  = #901#20;
     #100#26  = #901#21;
     #100#27  = #901#22;
     #100#29  = #901#14;
     #100#30  = #901#15;
     #100#31  = #901#16;
     #100#32  = #901#17;
     #100#33  = #901#18;
     #100#34  = #901#19;
     #100#35  = #901#20;
     #100#36  = #901#21;
     #100#37  = #901#22;
     #100#39  = #901#24;
     #100#40  = #901#25;
     #100#41  = #901#26;
     #100#42  = #901#27;
     #100#43  = #901#28;
     #100#44  = #901#29;
     #100#45  = #901#30;
     #100#46  = #901#31;
     #100#47  = #901#32;
     #100#49  = #901#34;
     #100#15  = #901#69;
     #100#16  = #901#70;
     #100#17  = #901#71;
     #100#18  = #901#72;
     #100#53  = #100#1;
     #100#100 = #901#2;
     #100#101 = #901#3;
     #100#102 = #901#4;
     #100#86  = #901#11;
     |SI #100#90 = "    ";
         aAlfa = #901#53 % 104;   #100#90  = aAlfa;
         aAlfa = #901#53 % 504;   #100#91  = aAlfa;
         aAlfa = #901#53 % 902;   #100#92  = aAlfa;
         aAlfa = #901#53 % 1110;  #100#93  = aAlfa;
     |FINSI;
     #100#68  = "S";

     |GRABA 020#100n;
     |LIBERA #100;
|FPRC;

|PROCESO dspase30;
     |SI #30#4 = 0;  |ACABA;  |FINSI;

     |SI #30#0 = "RENTA1994 ";  aDef  = eaPathRen1994 + "def/";  |FINSI;
     |SI #30#0 = "RENTA1995 ";  aDef  = eaPathRen1995 + "def/";  |FINSI;
     |SI #30#0 = "RENTA1996 ";  aDef  = eaPathRen1996 + "def/";  |FINSI;
     |SI #30#0 = "RENTA1997 ";  aDef  = eaPathRen1997 + "def/";  |FINSI;
     |SI #30#0 = "RENTA1998 ";  aDef  = eaPathRen1998 + "def/";  |FINSI;
     |SI #30#0 = "RENTA1999 ";  aDef  = eaPathRen1999 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2000 ";  aDef  = eaPathRen2000 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2001 ";  aDef  = eaPathRen2001 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2002 ";  aDef  = eaPathRen2002 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2003 ";  aDef  = eaPathRen2003 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2004 ";  aDef  = eaPathRen2004 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2005 ";  aDef  = eaPathRen2005 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2006 ";  aDef  = eaPathRen2006 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2007 ";  aDef  = eaPathRen2007 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2008 ";  aDef  = eaPathRen2008 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2009 ";  aDef  = eaPathRen2009 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2010 ";  aDef  = eaPathRen2010 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2011 ";  aDef  = eaPathRen2011 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2012 ";  aDef  = eaPathRen2012 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2013 ";  aDef  = eaPathRen2013 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2014 ";  aDef  = eaPathRen2014 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2015 ";  aDef  = eaPathRen2015 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2016 ";  aDef  = eaPathRen2016 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2017 ";  aDef  = eaPathRen2017 + "def/";  |FINSI;
     |SI #30#0 = "RENTA2018 ";  aDef  = eaPathRen2018 + "def/";  |FINSI;

     |SI #30#0 = "RENTA1994 ";  aFich = eaPathRen1994 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA1995 ";  aFich = eaPathRen1995 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA1996 ";  aFich = eaPathRen1996 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA1997 ";  aFich = eaPathRen1997 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA1998 ";  aFich = eaPathRen1998 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA1999 ";  aFich = eaPathRen1999 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA2000 ";  aFich = eaPathRen2000 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA2001 ";  aFich = eaPathRen2001 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA2002 ";  aFich = eaPathRen2002 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA2003 ";  aFich = eaPathRen2003 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA2004 ";  aFich = eaPathRen2004 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA2005 ";  aFich = eaPathRen2005 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA2006 ";  aFich = eaPathRen2006 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA2007 ";  aFich = eaPathRen2007 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA2008 ";  aFich = eaPathRen2008 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA2009 ";  aFich = eaPathRen2009 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA2010 ";  aFich = eaPathRen2010 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA2011 ";  aFich = eaPathRen2011 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA2012 ";  aFich = eaPathRen2012 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA2013 ";  aFich = eaPathRen2013 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA2014 ";  aFich = eaPathRen2014 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA2015 ";  aFich = eaPathRen2015 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA2016 ";  aFich = eaPathRen2016 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA2017 ";  aFich = eaPathRen2017 + "fich/";  |FINSI;
     |SI #30#0 = "RENTA2018 ";  aFich = eaPathRen2018 + "fich/";  |FINSI;

     aMas = aDef + "reacceso.mas";
     |CARGA_DEF aMas, reacceso@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #900;
     #900#0 = #30#4;
     |LEE 000#900=;
     |SI FSalida = 0; |Y #900#0 ! #30#1;
         |CIERRA #900;
         |DESCARGA_DEF #reacceso@;
         |ACABA;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #reacceso@;

     enCambioCli = 1;
     eaPasaRent  = "SI";
     eaPasaR1994 = "NO";
     eaPasaR1995 = "NO";
     eaPasaR1996 = "NO";
     eaPasaR1997 = "NO";
     eaPasaR1998 = "NO";
     eaPasaR1999 = "NO";
     eaPasaR2000 = "NO";
     eaPasaR2001 = "NO";
     eaPasaR2002 = "NO";
     eaPasaR2003 = "NO";
     eaPasaR2004 = "NO";
     eaPasaR2005 = "NO";
     eaPasaR2006 = "NO";
     eaPasaR2007 = "NO";
     eaPasaR2008 = "NO";
     eaPasaR2009 = "NO";
     eaPasaR2010 = "NO";
     eaPasaR2011 = "NO";
     eaPasaR2012 = "NO";
     eaPasaR2013 = "NO";
     eaPasaR2014 = "NO";
     eaPasaR2015 = "NO";
     eaPasaR2016 = "NO";
     eaPasaR2017 = "NO";
     eaPasaR2018 = "NO";
     eaPasaCact  = "N";
     eaPasaNuct  = "";

     |SI #30#0 = "RENTA1994 ";   eaPasaR1994 = "SI";   |FINSI;
     |SI #30#0 = "RENTA1995 ";   eaPasaR1995 = "SI";   |FINSI;
     |SI #30#0 = "RENTA1996 ";   eaPasaR1996 = "SI";   |FINSI;
     |SI #30#0 = "RENTA1997 ";   eaPasaR1997 = "SI";   |FINSI;
     |SI #30#0 = "RENTA1998 ";   eaPasaR1998 = "SI";   |FINSI;
     |SI #30#0 = "RENTA1999 ";   eaPasaR1999 = "SI";   |FINSI;
     |SI #30#0 = "RENTA2000 ";   eaPasaR2000 = "SI";   |FINSI;
     |SI #30#0 = "RENTA2001 ";   eaPasaR2001 = "SI";   |FINSI;
     |SI #30#0 = "RENTA2002 ";   eaPasaR2002 = "SI";   |FINSI;
     |SI #30#0 = "RENTA2003 ";   eaPasaR2003 = "SI";   |FINSI;
     |SI #30#0 = "RENTA2004 ";   eaPasaR2004 = "SI";   |FINSI;
     |SI #30#0 = "RENTA2005 ";   eaPasaR2005 = "SI";   |FINSI;
     |SI #30#0 = "RENTA2006 ";   eaPasaR2006 = "SI";   |FINSI;
     |SI #30#0 = "RENTA2007 ";   eaPasaR2007 = "SI";   |FINSI;
     |SI #30#0 = "RENTA2008 ";   eaPasaR2008 = "SI";   |FINSI;
     |SI #30#0 = "RENTA2009 ";   eaPasaR2009 = "SI";   |FINSI;
     |SI #30#0 = "RENTA2010 ";   eaPasaR2010 = "SI";   |FINSI;
     |SI #30#0 = "RENTA2011 ";   eaPasaR2011 = "SI";   |FINSI;
     |SI #30#0 = "RENTA2012 ";   eaPasaR2012 = "SI";   |FINSI;
     |SI #30#0 = "RENTA2013 ";   eaPasaR2013 = "SI";   |FINSI;
     |SI #30#0 = "RENTA2014 ";   eaPasaR2014 = "SI";   |FINSI;
     |SI #30#0 = "RENTA2015 ";   eaPasaR2015 = "SI";   |FINSI;
     |SI #30#0 = "RENTA2016 ";   eaPasaR2016 = "SI";   |FINSI;
     |SI #30#0 = "RENTA2017 ";   eaPasaR2017 = "SI";   |FINSI;
     |SI #30#0 = "RENTA2018 ";   eaPasaR2018 = "SI";   |FINSI;

     |SI #30#1 ! #30#4;
         enEmpresaN = #30#4;
         enEmpresa  = #30#1;
         |SUB_EJECUTA_NP "dsborrad";
     |FINSI;

     |BORRA 020#30a;
     |LIBERA #30;

     |ABRE #100;
     #100#0 = #30#4;
     |LEE 000#100=;
     |SI FSalida ! 0;
         aMas = aDef + "rem00100.mas";
         |CARGA_DEF aMas, rem00100@;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |PATH_DAT #901 aFich;

         |ABRE #901;
         |HAZ Graba100;
         |CIERRA #901;

         |DESCARGA_DEF #reacceso@;
     |FINSI;
     |CIERRA #100;
|FPRC;

|DEFBUCLE dspase30;
     #30#1;
     7;
     "          ", 00001, "*";
     "zzzzzzzzzz", 99999, "*";
     be;
     NULL, dspase30;
|FIN;

|PROGRAMA;
     |CUADRO 0501 2380;
     |BLANCO 0602 2279;
     |PINTA 1320, "Introduzca Password : ";
     E_inf = "";
     E_sup = "20";
     aPassword = 1342 ? -1;
     |SI aPassword ! "<MYPASWD>     ";
         |MENAV "     Permiso denegado.";
         |ACABA;
     |FINSI;

     |ABRE #15;
     |LEE 040#15p;
     |SI FSalida ! 0;  |O #15#15 ! "S";
         |MENAV "      Unificacion de Codigos no Realizada.";
         |CIERRA #15;
         |ACABA;
     |FINSI;
     |CIERRA #15;

     |HAZ BusquedaApli;
     |SI eaPathIntegral = "";
         |MENAV "     No tiene instalada la Plataforma Integrada, Consulte con su Proveedor.";
         |ACABA;
     |FINSI;

     aFichero = ("30" + Usuario + "zzzzzzzz") % 108;

     |NOME_DAT #30 aFichero;
     |ABRE #30;  |CIERRA #30;  |DELINDEX #30;

     nGraba = 0;

     |ABRE #100;
     |ABRE #30;

/*
     nAnyo = 1994;  |HAZ DatosRenta;
     nAnyo = 1995;  |HAZ DatosRenta;
     nAnyo = 1996;  |HAZ DatosRenta;
     nAnyo = 1997;  |HAZ DatosRenta;
     nAnyo = 1998;  |HAZ DatosRenta;
*/
     nAnyo = 1999;  |HAZ DatosRenta;
     nAnyo = 2000;  |HAZ DatosRenta;
     nAnyo = 2001;  |HAZ DatosRenta;
     nAnyo = 2002;  |HAZ DatosRenta;
     nAnyo = 2003;  |HAZ DatosRenta;
     nAnyo = 2004;  |HAZ DatosRenta;
     nAnyo = 2005;  |HAZ DatosRenta;
     nAnyo = 2006;  |HAZ DatosRenta;
     nAnyo = 2007;  |HAZ DatosRenta;
     nAnyo = 2008;  |HAZ DatosRenta;
     nAnyo = 2009;  |HAZ DatosRenta;
     nAnyo = 2010;  |HAZ DatosRenta;
     nAnyo = 2011;  |HAZ DatosRenta;
     nAnyo = 2012;  |HAZ DatosRenta;
     nAnyo = 2013;  |HAZ DatosRenta;
     nAnyo = 2014;  |HAZ DatosRenta;
     nAnyo = 2015;  |HAZ DatosRenta;
     nAnyo = 2016;  |HAZ DatosRenta;
     nAnyo = 2017;  |HAZ DatosRenta;
     nAnyo = 2018;  |HAZ DatosRenta;

     |CIERRA #100;
     |CIERRA #30;

     |SI nGraba = 0;
         |MENAV "0000 Todas las Rentas estan en la Integrada.";
         |ACABA;
     |FINSI;

     |ENTLINEAL #1#30, -1, 4, 22, 1, Baja30, Alta30;

     |CONFI "0000NRealizamos el pase en estos momentos";

     |BLANCO 0501 2380;
     |SI FSalida = 0;
         |PARA nHay = 1;   |SI nHay [ 3;  |HACIENDO nHay = nHay + 1;
               |BUCLE dspase30;
         |SIGUE;
     |FINSI;

     |DELINDEX #30;
|FPRO;
