|FICHEROS;
     agicen14 #0;
     agicen01 #1;
     agim0002 #2;
     agitab12 #12;
     agitab05 #5;
     agifigen #6;
     agicen08 #8;
     agicen09 #9;
     agicen10 #10;
     agicen17 #17;
     agicen26 #26;
     agicen27 #27;
     agicen28 #28;
     agicen30 #30;
     agitab10;
     agitab11;
     agitab99;

     :/modelos/def/dsmom001 #101;
     :/modelos/def/dsmom002 #102;
     :/modelos/def/dsmom016 #16;

     :/integral/def/dsam0005 #205;

     ver00001 #1900;
|FIN;

|VARIABLES;
     nSalir       = 0;
     nFactor      = 0;
     nSw          = 0;
     nCodigoRenta = 0;
     nDAnyo       = 0;
     nHAnyo       = 0;
     nAnyo        = 0;
     nModelo      = 0;
     fFechaCon    = @;

     aAlfa    = "";

{-1} aMenu    = "";
     aMenu1   = "1427";
     aMenu2   = "1";
     aMenu3   = "9";
     aMenu4   = "Comuneros                               ";
     aMenu5   = "Historico por Ejercicios de la Actividad";
     aMenu6   = "Modelos y Libros Oficiales por Actividad";
     aMenu7   = "Referencias Catastrales                 ";
     aMenu8   = "Rendimientos                            ";
     aMenu9   = "Modelo 840                              ";
     aMenu10  = "Modelo 845 / 846                        ";
     aMenu11  = "Direccion Actividad                     ";
     aMenu12  = "Configuracion enlaces facturas por serie";

 {-1} aMenuCap   = "";
      aMenuCap1  = "1262";
      aMenuCap2  = "1";
      aMenuCap3  = "4";
      aMenuCap4  = "MANUAL    ";
      aMenuCap5  = "PLANILLAS ";
      aMenuCap6  = "REGISTROS ";
      aMenuCap7  = "MODULOS   ";

      nModo       = 0;
      nCambio     = 0;
      nBajaAmor   = 0;
      fFecha      = @;
      nSwOp       = 0;
      nSwNoCNAE   = 0;
      nUnosC      = 0;
      nPer        = 0;
      aCNAE       = "";
      aBase       = "";
      aMas        = "";

     &enEmpresa   = 0;
     &enActividad = 0;
     &eaNombreEmp = "";
     &eaNombreAct = "";
     &eaCodEpi1   = "";
     &eaCodEpi2   = "";
     &eaCaptura   = "";
     &enSectAct   = 0;
     &enModo      = 0;
     &enEmpresaA  = 0;
     &enCambio    = 0;
     &enAnyo      = 0;
     &eaPathIntegral = "";
     &eaPathContagen = "";
     &efFechaSit     = @;
     &enDeAct        = 0;
     &enOpAct        = 0;
     &efFechaAA      = @;
     &enErrorVer     = 0;
     fFechaP         = @;

     &eaPrograma     = "";
     &eaExtension    = "";
     &eaCliNif       = "";
|FIN;

|INCLUYE i_consul;

|PROCESO NombreRepre;
     |HAZ LeeNifs;     || Esto no haze n  pero quien lo toque
                       || los corto lo guevos  PARAQUITAR
|FPRC;

|PROCESO PonActi1;
     #1#2 = #0#2;
     #1#3 = #0#3;
     #1#4 = #0#4;
     |GRABA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE agicen01;
     #1#1;
     ;
     #0#0, #0#1, 00;
     #0#0, #0#1, 99;
     be;
     NULL, PonActi1;
|FIN;

|PROCESO PonActi2;
     #2#4 = #0#2;
     #2#5 = #0#3;
     #2#6 = #0#4;
     |GRABA 020#2a;
     |LIBERA #2;
|FPRC;

|DEFBUCLE agim0002;
     #2#1;
     ;
     #0#0, #0#1, 1900;
     #0#0, #0#1, 2999;
     be;
     NULL, PonActi2;
|FIN;

|PROCESO Borra01;
     |BORRA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE agicen01B;
     #1#1;
     ;
     #0#0, #0#1, 00;
     #0#0, #0#1, 99;
     be;
     NULL, Borra01;
|FIN;

|PROCESO Borra02;
     |BORRA 020#2a;
     |LIBERA #2;
|FPRC;

|DEFBUCLE agim0002B;
     #2#1;
     ;
     #0#0, #0#1, 1900;
     #0#0, #0#1, 2999;
     be;
     NULL, Borra02;
|FIN;

|PROCESO Borra17;
     |BORRA 020#17a;
     |LIBERA #17;
|FPRC;

|DEFBUCLE agicen17B;
     #17#1;
     ;
     #0#0, #0#1, 00;
     #0#0, #0#1, 99;
     be;
     NULL, Borra17;
|FIN;

|PROCESO Borra30;
     |BORRA 020#30a;
     |LIBERA #30;
|FPRC;

|DEFBUCLE agicen30B;
     #30#1;
     ;
     #0#0, #0#1, 0000;
     #0#0, #0#1, 9999;
     be;
     NULL, Borra30;
|FIN;

|PROCESO Borra8;
     |BORRA 020#8a;
     |LIBERA #8;
|FPRC;

|DEFBUCLE agicen08B;
     #8#1;
     ;
     #0#0, #0#1, 00;
     #0#0, #0#1, 99;
     be;
     NULL, Borra8;
|FIN;

|PROCESO Borra9;
     |BORRA 020#9a;
     |LIBERA #9;
|FPRC;

|DEFBUCLE agicen09B;
     #9#1;
     ;
     #0#0, #0#1, 00;
     #0#0, #0#1, 99;
     be;
     NULL, Borra9;
|FIN;

|PROCESO Borra10;
     |BORRA 020#10a;
     |LIBERA #10;
|FPRC;

|DEFBUCLE agicen10B;
     #10#1;
     ;
     #0#0, #0#1, 00, 00;
     #0#0, #0#1, 99, 99;
     be;
     NULL, Borra10;
|FIN;

|PROCESO Borra26;
     |BORRA 020#26a;
     |LIBERA #26;
|FPRC;

|DEFBUCLE agicen26B;
     #26#1;
     ;
     #0#0, #0#1, 00;
     #0#0, #0#1, 99;
     be;
     NULL, Borra26;
|FIN;

|PROCESO Borra27;
     |BORRA 020#27a;
     |LIBERA #27;
|FPRC;

|DEFBUCLE agicen27B;
     #27#1;
     ;
     #0#0, #0#1, 00;
     #0#0, #0#1, 99;
     be;
     NULL, Borra27;
|FIN;

|PROCESO Borra28;
     |BORRA 020#28a;
     |LIBERA #28;
|FPRC;

|DEFBUCLE agicen28B;
     #28#1;
     ;
     #0#0, #0#1, 00, 00;
     #0#0, #0#1, 99, 99;
     be;
     NULL, Borra28;
|FIN;

|PROCESO Borra101;
     |BORRA 020#101a;
     |LIBERA #101;
|FPRC;

|DEFBUCLE dsmom001B;
     #101#1;
     ;
     #0#0, #0#1, 0000;
     #0#0, #0#1, 9999;
     be;
     NULL, Borra101;
|FIN;

|PROCESO Borra102;
     |BORRA 020#102a;
     |LIBERA #102;
|FPRC;

|DEFBUCLE dsmom002B;
     #102#1;
     ;
     #0#0, #0#1, 000;
     #0#0, #0#1, 999;
     be;
     NULL, Borra102;
|FIN;

|PROCESO GrabaFecha102;
     |SI #102#9 [ "01.01.1900"; |O #102#9 = fFechaP;
         #102#9 = #0#6;
     |SINO;
         |SI #102#9 > #0#6;
             #102#9 = #0#6;
         |FINSI;
     |FINSI;
     |GRABA 020#102a;
     |LIBERA #102;
|FPRC;

|DEFBUCLE dsmom002;
     #102#1;
     ;
     #0#0, #0#1, 000;
     #0#0, #0#1, 999;
     be;
     NULL, GrabaFecha102;
|FIN;

|PROCESO Tipo0cen14;  |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
         fFechaP = "01.01.0000";
     |SINO;
         fFechaP = #0#6;
     |FINSI;
|FPRC;

|PROCESO Tipo2;  |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 3;  |ACABA;  |FINSI;

     |BUCLE agicen01B;
     |BUCLE agim0002B;
     |BUCLE agicen17B;
     |BUCLE agicen30B;
     |BUCLE dsmom001B;
     |BUCLE dsmom002B;

     |BUCLE agicen08B;
     |BUCLE agicen09B;
     |BUCLE agicen10B;
     |BUCLE agicen26B;
     |BUCLE agicen27B;
     |BUCLE agicen28B;

     |SI eaPathIntegral ! "";
         |ABRE #205;
         #205#0 = #0#0;
         #205#1 = #0#1;
         |LEE 101#205=;
         |SI FSalida = 0;
             |BORRA 020#205a;
             |LIBERA #205;
         |FINSI;
         |CIERRA #205;
    |FINSI;
    |SI eaPathContagen ! "";
        enDeAct = #0#1;
        enOpAct = 3; || Baja
        |SUB_EJECUTA_NP ":contagen/caz00006;Actividad";
    |FINSI;
|FPRC;

|PROCESO SeriesFac;
     E_inf = 0;
     E_sup = 9;
     |PUSHV 0501 2380;
     |BLANCO 1120 1558;
     |CUADRO 1120 1558;

     |PINTA 1220, "    Introduzca el PERIODO del CONTAGEN ";
     nPer = 1437 ? 1;
     |POPV;

     aAlfa = "|:contagen/gadm0005 canempr1 " + (("00000" + #agicen14#0) % -105) + nPer + ";" + #agicen14#1;
     |SUB_EJECUTA aAlfa;
|FPRC;

|PROCESO Tipo3cen14;  |TIPO 3;
     |GRABA 020#0a;

     |SI nCambio = 1;
         |SI #0#6 > "01.01.0000";
             |CONFI "0000SGrabamos la Fecha de Baja en los Registros de Modelos Oficiales.";
             |SI FSalida = 0;
                 |BUCLE dsmom002;
             |FINSI;

             |SI nBajaAmor = 1;
                 |CONFI "0000SDamos de Baja los Elementos del Inmovilizado de esta Actividad";
                 |SI FSalida = 0;
                     efFechaSit  = #0#6;
                     enActividad = #0#1;
                     |SUB_EJECUTA_NP ":modelos/dsmoz057";
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI #0#6 [ "01.01.0000";
             |SI nBajaAmor = 2;
                 |CONFI "0000SDamos de Alta los Elementos del Inmovilizado en baja de esta Actividad";
                 |SI FSalida = 0;
                     efFechaSit  = fFechaCon;
                     enActividad = #0#1;
                     |SUB_EJECUTA_NP ":modelos/dsmoz079";
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     fFechaP = "01.01.0000";

     enModo = (FEntrada / 100) ! 0;
     |SI enModo = 1; |Y eaPathContagen ! "";
        enDeAct = #0#1;
        enOpAct = 1; || Alta
        efFechaAA = #0#5;
        eaNombreAct = #0#4;
        |SUB_EJECUTA_NP ":contagen/caz00006;Actividad";
     |FINSI;

     fFecha  = ~;
     aAlfa   = fFecha % -104;
     nAnyo   = aAlfa;

     |ABRE #30;
     #30#0  = #0#0;
     #30#1  = #0#1;
     #30#2  = nAnyo;
     |LEE 101#30=;
     |SI FSalida ! 0;
         |DDEFECTO #30;
         #30#0  = #0#0;
         #30#1  = #0#1;
         #30#2  = nAnyo;
         |GRABA 020#30b;
     |FINSI;

     #30#3  = #0#2;
     #30#4  = #0#3;
     #30#5  = #0#4;
     #30#6  = #0#7;
     #30#7  = #0#8;
     #30#8  = #0#9;
     #30#9  = #0#10;
     #30#10 = #0#11;
     #30#11 = #0#12;
     #30#12 = #0#16;
     #30#13 = #0#17;
     #30#14 = #0#18;
     #30#15 = #0#19;
     #30#16 = #0#15;
     |GRABA 020#30a;
     |LIBERA #30;
     |CIERRA #30;

     enModo      = (FEntrada / 100) ! 0;
     enEmpresa   = #0#0;
     enActividad = #0#1;
     eaNombreAct = #0#4;
     eaCodEpi1   = #0#2;
     eaCodEpi2   = #0#3;
     eaCaptura   = #0#15;

     |BUCLE agim0002;
     |BUCLE agicen01;

     |PUSHV 0501 2380;
     aMenu2 = "1";
     |PARA; |SI;  |HACIENDO;
            enEmpresa   = #0#0;
            enActividad = #0#1;
            eaNombreAct = #0#4;
            eaCodEpi1   = #0#2;
            eaCodEpi2   = #0#3;
            eaCaptura   = #0#15;
            enModo      = (FEntrada / 100) ! 0;

            |SI eaPathIntegral = "";
                aMenu11  = "----------------------------------------";
            |FINSI;

            |DBASS aBase;
            aMas = aBase + "dscomer9/def/agifa024.mas";
            |XABRE "E", aMas, 0;
            |SI FSalida < 0;
                aMenu12  = "----------------------------------------";
            |FINSI;

            |MENUG aMenu;
            aMenu2 = FSalida;
            |SI aMenu2 < "1";  |O aMenu2 > "9";
                |SAL;
            |FINSI;

            |SI aMenu2 = "1"; |Y #0#13 = "S";
                |SUB_EJECUTA_NP ":modelos/dsmom001";
            |FINSI;

            |SI aMenu2 = "2";  |SUB_EJECUTA_NP ":basica/agicen30";    |FINSI;
            |SI aMenu2 = "3";  |SUB_EJECUTA_NP ":modelos/dsmom002";   |FINSI;
            |SI aMenu2 = "4";  |SUB_EJECUTA_NP ":basica/agicen17";    |FINSI;
            |SI aMenu2 = "5";  |SUB_EJECUTA_NP ":basica/agim0002";    |FINSI;
            |SI aMenu2 = "6";  |SUB_EJECUTA_NP ":basica/agicen26";    |FINSI;
            |SI aMenu2 = "7";  |SUB_EJECUTA_NP ":basica/agicen01";    |FINSI;

            |SI aMenu2 = "8";  |Y aMenu11 ! "----------------------------------------";
                |SUB_EJECUTA_NP ":integral/dsam0005";
            |FINSI;

            |SI aMenu2 = "9";  |Y aMenu12 ! "----------------------------------------";
                |HAZ SeriesFac;
            |FINSI;
     |SIGUE;
     |POPV;
|FPRC;

|PROCESO FechaBaja;
     fFechaCon = Contenido;

     nCambio   = 0;
     nBajaAmor = 0;

     |SI #0#6 ! fFechaCon;
         enCambio = 1;
         nCambio  = 1;
         nBajaAmor = 1;
         |SI fFechaCon > "01.01.0000";  ||antes tenia fecha
             nBajaAmor = 0;
             |SI #0#6 = "01.01.0000"; nBajaAmor = 2; |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO ModiTAct;
     |C_M #0#16, 1, "N";
     |C_M #0#11, 1, "N";
     |SI #0#2 = "O";  |Y #0#3 = "9999";
         |C_M #0#11, 1, "S";
         |C_M #0#16, 1, "S";

         |SI #0#11 < 900;  #0#11 = 999;  |FINSI;
     |SINO;
         |SI #0#2 = "E";
             aAlfa   = #0#3 % 101;
             nFactor = aAlfa;
             nFactor = 100 + (nFactor * 10);
         |FINSI;

         |SI #0#2 = "P";
             aAlfa   = #0#3 % 101;
             nFactor = aAlfa;
             nFactor = 200 + (nFactor * 10);
         |FINSI;

         |SI #0#2 = "A";
             aAlfa   = #0#3 % 102;
             nFactor = aAlfa;
             nFactor = 300 + nFactor;
         |FINSI;

         #0#11 = nFactor;
     |FINSI;

     |ABRE #5;
     #5#0 = #0#11;
     |LEE 040#5=;
     |SI FSalida ! 0;  |DDEFECTO #5;  |FINSI;
     |CIERRA #5;

     #0#12 = #5#1;

     |PINTA #0#11;
     |PINTA #0#12;
|FPRC;

|PROCESO CogeTributa;
     #0#13 = "N";
     #0#14 = "N";
     |SI #0#9 = 8;   #0#13 = "S";  |FINSI;
     |SI #0#9 = 9;   #0#13 = "S";  |FINSI;
     |SI #0#9 = 10;  #0#13 = "S";  |FINSI;
     |SI #0#9 = 11;  #0#13 = "S";  |FINSI;
     |SI #0#9 = 12;  #0#13 = "S";  |FINSI;
     |SI #0#9 = 18;  #0#13 = "S";  |FINSI;

     |SI #0#9 = 13;  #0#14 = "S";  |FINSI;
     |SI #0#9 = 14;  #0#14 = "S";  |FINSI;
     |SI #0#9 = 15;  #0#14 = "S";  |FINSI;
     |SI #0#9 = 16;  #0#14 = "S";  |FINSI;
     |SI #0#9 = 17;  #0#14 = "S";  |FINSI;
     |SI #0#9 = 19;  #0#14 = "S";  |FINSI;

     |PINTA #0#13;
     |PINTA #0#14;

     nCodigoRenta = 0;
     |SI #0#3 = "8612";  nCodigoRenta = 1;  |FINSI;

     |SI #0#9 ! 2;  |Y #0#9 ! 8;  |Y #0#9 ! 9;
      |Y #0#9 ! 10; |Y #0#9 ! 11; |Y #0#9 ! 12; |Y #0#9 ! 18;
         nCodigoRenta = 1;
     |FINSI;

     |C_M #0#18, 1, "S";
     |C_M #0#19, 1, "S";
     |SI nCodigoRenta = 0;
         |C_M #0#18, 1, "N";  #0#18 = 0;   |PINTA #0#18;
         |C_M #0#19, 1, "N";  #0#19 = "";  |PINTA #0#19;
     |SINO;
         |SI #0#18 = 0;
             #0#18 = #0#0;  |PINTA #0#18;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Sector; |TIPO 6;
     |SI #0#2 ! "O";  |ACABA;  |FINSI;

     aAlfa = ("000" + #0#11) % -301;
     |SI aAlfa ! "9";
         |MENAV "      Introduzca un Sector que comience por <9> para los Epigrafes sin IAE";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Capturas; |TIPO 0;
     |SI #0Campo ! aMenuCap4; |Y #0Campo ! aMenuCap5; |Y #0Campo ! aMenuCap6; |Y #0Campo ! aMenuCap7;
         #0Campo = "";
     |FINSI;

     |SI FSalida = 10;  |Y #0Campo ! "          ";
         |MENAV "      Si Cambia la Captura debera hacer un Calculo de Planing";
     |SINO;
         |SI #0Campo ! "          ";
             |ACABA;
         |FINSI;
     |FINSI;

     |PUSHV 0501 2380;
     |PARA; |SI; |HACIENDO;
          |SI #0#15 = aMenuCap4;  aMenuCap2 = "1";  |FINSI;
          |SI #0#15 = aMenuCap5;  aMenuCap2 = "2";  |FINSI;
          |SI #0#15 = aMenuCap6;  aMenuCap2 = "3";  |FINSI;
          |SI #0#15 = aMenuCap7;  aMenuCap2 = "4";  |FINSI;

          |MENUG aMenuCap;
          aMenuCap2 = FSalida;
          nSw = 0;

          |SI aMenuCap2 = "2";
              |SI #0#7 = 1;   nSw = 1;  |FINSI;
              |SI #0#7 = 3;   nSw = 1;  |FINSI;
              |SI #0#7 = 9;   nSw = 1;  |FINSI;
              |SI #0#7 = 10;  nSw = 1;  |FINSI;
              |SI #0#7 = 16;  nSw = 1;  |FINSI;

              |SI #0#9 = 1;   |Y nSw = 1;  nSw = 0;  |FINSI;
              |SI #0#9 = 3;   |Y nSw = 1;  nSw = 0;  |FINSI;
              |SI #0#9 = 4;   |Y nSw = 1;  nSw = 0;  |FINSI;
              |SI #0#9 = 8;   |Y nSw = 1;  nSw = 0;  |FINSI;
              |SI #0#9 = 9;   |Y nSw = 1;  nSw = 0;  |FINSI;
              |SI #0#9 = 18;  |Y nSw = 1;  nSw = 0;  |FINSI;

              |||SI #0#9 = 2;   |Y nSw = 0;  nSw = 1;  |FINSI;
              |SI #0#9 = 5;   |Y nSw = 0;  nSw = 1;  |FINSI;
              |SI #0#9 = 6;   |Y nSw = 0;  nSw = 1;  |FINSI;
              |SI #0#9 = 7;   |Y nSw = 0;  nSw = 1;  |FINSI;
              |SI #0#9 = 10;  |Y nSw = 0;  nSw = 1;  |FINSI;
              |SI #0#9 = 11;  |Y nSw = 0;  nSw = 1;  |FINSI;
              |SI #0#9 = 12;  |Y nSw = 0;  nSw = 1;  |FINSI;
              |SI #0#9 = 13;               nSw = 1;  |FINSI;
              |SI #0#9 = 14;               nSw = 1;  |FINSI;
              |SI #0#9 = 15;               nSw = 1;  |FINSI;
              |SI #0#9 = 16;               nSw = 1;  |FINSI;
              |SI #0#9 = 17;               nSw = 1;  |FINSI;
              |SI #0#9 = 19;               nSw = 1;  |FINSI;

              |SI nSw = 1;
                  |MENAV "     No procede las PLANILLAS";
                  aMenuCap2 = "0";
              |FINSI;
          |FINSI;

          |SI aMenuCap2 = "4";
              nSw = 1;

              |ABRE #16;
              #16#0  = #0#2;
              #16#1  = #0#3;
              #16#2  = 0000;
              #16#41 = 1;
              |LEE 040#16];
              |SI #16#0 = #0#2;  |Y #16#1 = #0#3;
                  nSw = 0;
              |FINSI;
              |CIERRA #16;

              |SI nSw = 0;
                  |SI #0#9 ! 5;  |Y #0#9 ! 10;
                      nSw = 1;
                  |FINSI;
              |FINSI;

              |SI nSw = 1;
                  |SI #0#9 = 15;
                      |MENAV "     Es comunero no procede MODULOS, asigneselo a la COMUNIDAD";
                  |SINO;
                      |MENAV "     No procede los MODULOS";
                  |FINSI;
                  aMenuCap2 = "0";
              |FINSI;
          |FINSI;

          |SI aMenuCap2 = "1";   #0#15 = aMenuCap4;  |SAL;  |FINSI;
          |SI aMenuCap2 = "2";   #0#15 = aMenuCap5;  |SAL;  |FINSI;
          |SI aMenuCap2 = "3";   #0#15 = aMenuCap6;  |SAL;  |FINSI;
          |SI aMenuCap2 = "4";   #0#15 = aMenuCap7;  |SAL;  |FINSI;
     |SIGUE;
     |POPV;

     |PINTA #0#15;
|FPRC;

|PROCESO CodigoRenta;
     |SI #0#18 = 0;  |ACABA;  |FINSI;

     |ABRE #6;
     #6#0 = #0#18;
     |LEE 040#6=;
     |SI FSalida ! 0;
         |MENAV "      No Existe Cliente.";
         |ERROR;
     |FINSI;
     |CIERRA #6;

     |ATRI S;
     |PINTA 1423, #6#1;
     |ATRI s;
|FPRC;

|PROCESO GrabaDatoRenta;
     nCodigoRenta = 0;
     |SI #0#3 = "8612";  nCodigoRenta = 1;  |FINSI;
     |SI #0#9 ! 1;  |Y #0#9 ! 2;  |Y #0#9 ! 8;  |Y #0#9 ! 9;
      |Y #0#9 ! 10; |Y #0#9 ! 11; |Y #0#9 ! 12; |Y #0#9 ! 18;
         nCodigoRenta = 1;
     |FINSI;

     |SI nCodigoRenta = 1;
         |SI #0#18 = 0;
             #0#18 = #0#0;

             |GRABA 020#0a;
         |FINSI;
     |FINSI;
     |LIBERA #0;
|FPRC;

|PROCESO PintaCod;  |TIPO 7;
     |ABRE #6;
     #6#0 = #0#18;
     |LEE 040#6=;
     |SI FSalida ! 0;  |DDEFECTO #6; |FINSI;
     |CIERRA #6;

     |ATRI S;
     |PINTA 1423, #6#1;
     |ATRI s;
|FPRC;

|DEFBUCLE agicen14;
     #0#1;
     ;
     00001, 00;
     99999, 99;
     be;
     NULL, GrabaDatoRenta;
|FIN;

|PROCESO Tipo11cen14;  |TIPO 11;
     |SI FSalida = 17;
         |BUCLE agicen14;
     |FINSI;
|FPRC;

|RUTINA ClaveBaja14;
     #0#0  = enEmpresa;
     #0#1  = 1;
|FRUT;

|RUTINA ClaveAlta14;
     #0#0  = enEmpresa;
     #0#1  = 9999;
|FRUT;

|PROCESO agicen14_30;
     |PARA nAnyo = nDAnyo;  |SI nAnyo [ nHAnyo;  |HACIENDO nAnyo = nAnyo + 1;
           #30#0  = #0#0;
           #30#1  = #0#1;
           #30#2  = nAnyo;
           #30#3  = #0#2;
           #30#4  = #0#3;
           #30#5  = #0#4;
           #30#6  = #0#7;
           #30#7  = #0#8;
           #30#8  = #0#9;
           #30#9  = #0#10;
           #30#10 = #0#11;
           #30#11 = #0#12;
           #30#12 = #0#16;
           #30#13 = #0#17;
           #30#14 = #0#18;
           #30#15 = #0#19;
           #30#16 = #0#15;
           |GRABA 020#30n;
           |LIBERA #30;
     |SIGUE;
|FPRC;

|DEFBUCLE agicen14_30;
     #0#1;
     ;
     00000, 01;
     99999, 99;
     ;
     NULL, agicen14_30;
|FIN;

|PROCESO GrabaTab11;
     #agitab11#0 = #agitab10#0;
     #agitab11#1 = nModelo;
     |LEE 000#agitab11.=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     #agitab99#0 = nModelo;
     |LEE 000#agitab99.=;

     |DDEFECTO #agitab11;
     #agitab11#0 = #agitab10#0;
     #agitab11#1 = nModelo;
     #agitab11#2 = #agitab99#1;
     #agitab11#3 = #agitab99#2;
     #agitab11#4 = #agitab99#3;
     #agitab11#5 = "N";

     |GRABA 020#agitab11.n;
     |LIBERA #agitab11;
|FPRC;

|PROCESO CreaRegNuevos;

     |ABRE #agitab99;
     #agitab99#0 = 322;
     |LEE 041#agitab99.=;
     |SI FSalida ! 0;
         |CIERRA #agitab99;

         eaExtension = "bas";
         eaPrograma  = "agitab99";
         |SUB_EJECUTA_NP ":basica/dspatron";
     |SINO;
         |CIERRA #agitab99;
     |FINSI;

     |ABRE #agitab10;

     #agitab10#0 = 17;
     |LEE 000#agitab10.=;
     |SI FSalida ! 0;
         |CIERRA #agitab10;

         eaExtension = "bas";
         eaPrograma  = "agitab10";
         |SUB_EJECUTA_NP ":basica/dspatron";

         eaExtension = "bas";
         eaPrograma  = "agitab11";
         |SUB_EJECUTA_NP ":basica/dspatron";
         |ACABA;
     |FINSI;

     #agitab10#0 = 17;
     |LEE 000#agitab10.=;
     |SI FSalida = 0;
         aAlfa = #agitab10#5; |QBF aAlfa;
         |SI aAlfa !  "ACOGIDO VOLUNTARIAMENTE AL SII";
             #agitab10#5 = "ACOGIDO VOLUNTARIAMENTE AL SII";
             #agitab10#1 = "ACOGIDO VOLUNTARIAMENTE EN EL SUMINISTRO";
             #agitab10#2 = "INMEDIATO DE INFORMACION - SII";
             |GRABA 020#agitab10.a;
         |FINSI;
     |FINSI;
     |LIBERA #agitab10;

     #agitab10#0 = 14;
     |LEE 000#agitab10.=;
     |SI FSalida ! 0;
         |DDEFECTO #agitab10;
         #agitab10#0 = 14;
         #agitab10#5 = "REGIMEN GENERAL Y ACOGIDO AL R.E.C.C.";
         #agitab10#1 = "REGIMEN GENERAL Y ACOGIDO AL R.E.C.C.";
         |GRABA 020#agitab10.n;
         |LIBERA #agitab10;

         |ABRE #agitab11;
         |ABRE #agitab99;

         nModelo = 303;  |HAZ GrabaTab11;
         nModelo = 347;  |HAZ GrabaTab11;
         nModelo = 349;  |HAZ GrabaTab11;
         nModelo = 390;  |HAZ GrabaTab11;
         nModelo = 901;  |HAZ GrabaTab11;
         nModelo = 902;  |HAZ GrabaTab11;
         nModelo = 903;  |HAZ GrabaTab11;
         nModelo = 904;  |HAZ GrabaTab11;
         nModelo = 906;  |HAZ GrabaTab11;
         nModelo = 907;  |HAZ GrabaTab11;

         |CIERRA #agitab11;
         |CIERRA #agitab99;
     |FINSI;

     #agitab10#0 = 15;
     |LEE 000#agitab10.=;
     |SI FSalida ! 0;
         |DDEFECTO #agitab10;
         #agitab10#0 = 15;
         #agitab10#5 = "INSCRITO EN EL REDEME Y ACOGIDO AL RECC";
         #agitab10#1 = "INSCRITO EN EL REDEME Y ACOGIDO AL";
         #agitab10#2 = "R.E.C.C.";
         |GRABA 020#agitab10.n;
         |LIBERA #agitab10;

         |ABRE #agitab11;
         |ABRE #agitab99;

         nModelo = 303;  |HAZ GrabaTab11;
         nModelo = 340;  |HAZ GrabaTab11;
         nModelo = 347;  |HAZ GrabaTab11;
         nModelo = 349;  |HAZ GrabaTab11;
         nModelo = 390;  |HAZ GrabaTab11;
         nModelo = 904;  |HAZ GrabaTab11;

         |CIERRA #agitab11;
         |CIERRA #agitab99;
     |FINSI;

     #agitab10#0 = 16;
     |LEE 000#agitab10.=;
     |SI FSalida ! 0;
         |DDEFECTO #agitab10;
         #agitab10#0 = 16;
         #agitab10#5 = "REGIMEN ESPECIAL DEL GRUPO DE ENTIDADES";
         #agitab10#1 = "REGIMEN ESPECIAL DEL GRUPO DE ENTIDADES";
         #agitab10#2 = "R.E.G.E.";
         |GRABA 020#agitab10.n;
         |LIBERA #agitab10;

         |ABRE #agitab11;
         |ABRE #agitab99;

         nModelo = 322;  |HAZ GrabaTab11;
         nModelo = 349;  |HAZ GrabaTab11;
         nModelo = 901;  |HAZ GrabaTab11;
         nModelo = 902;  |HAZ GrabaTab11;
         nModelo = 903;  |HAZ GrabaTab11;
         nModelo = 904;  |HAZ GrabaTab11;
         nModelo = 906;  |HAZ GrabaTab11;
         nModelo = 907;  |HAZ GrabaTab11;

         |CIERRA #agitab11;
         |CIERRA #agitab99;
     |SINO;
         |ABRE #agitab11;
         #agitab11#0 = 16;
         #agitab11#1 = 353;
         |LEE 141#agitab11.=;
         |SI FSalida = 0; |BORRA 020#agitab11.a; |FINSI;
         |LIBERA #agitab11;

         #agitab11#0 = 16;
         #agitab11#1 = 347;
         |LEE 141#agitab11.=;
         |SI FSalida = 0; |BORRA 020#agitab11.a; |FINSI;
         |LIBERA #agitab11;

         #agitab11#0 = 16;
         #agitab11#1 = 390;
         |LEE 141#agitab11.=;
         |SI FSalida = 0; |BORRA 020#agitab11.a; |FINSI;
         |LIBERA #agitab11;

         |CIERRA #agitab11;
     |FINSI;

     |CIERRA #agitab10;
|FPRC;

|PROGRAMA;
     |SUB_EJECUTA_NP "ver00001";
     |SI enErrorVer = 1;  |ACABA;  |FINSI;

     |HAZ CreaRegNuevos;

     |HAZ BusquedaApli;

     |ABRE #30;
     |LEE 000#30p;
     |SI FSalida ! 0;
         fFecha  = ~;
         aAlfa   = fFecha % -104;
         nDAnyo  = 2002;
         nHAnyo  = aAlfa;

         |BUCLE agicen14_30;
     |FINSI;
     |CIERRA #30;

     enCambio = 0;
     |ENTLINEAL #1#0, -2, enModo, 22, 1, ClaveBaja14, ClaveAlta14;

     |SI enCambio = 1;
         |CONFI "0000SHa habido cambios que repercuten al Planing, Desea Calcularlo ";
         |SI FSalida = 0;
             fFecha     = ~;
             aAlfa      = fFecha % -104;
             enAnyo     = aAlfa;
             E_inf      = 1900;
             E_sup      = 2999;
             |PUSHV 0501 2380;
             |BLANCO 1120 1558;
             |CUADRO 1120 1558;

             |PINTA 1220, "    Introduzca el A¤o a Calcular       ";
             enAnyo = 1437 ? 1;
             |POPV;

             enEmpresaA = enEmpresa;
             |SUB_EJECUTA_NP ":modelos/dsmoz001";
         |FINSI;
     |FINSI;
|FPRO;
