|FICHEROS;
     agicen30 #0;
     agitab05 #5;
     agifigen #6;

     :/modelos/def/dsmom016 #16;
|FIN;

|VARIABLES;
     nSalir       = 0;
     nFactor      = 0;
     nSw          = 0;
     nCodigoRenta = 0;

     aAlfa        = "";

     nModo        = 0;
     nCambio      = 0;
     fFecha       = @;

     &enEmpresa   = 0;
     &enActividad = 0;
     &eaNombreEmp = "";
     &eaNombreAct = "";
     &eaCodEpi1   = "";
     &eaCodEpi2   = "";
     &eaCaptura   = "";
     &enSectAct   = 0;
     &enModo      = 0;
     &enEmpresaA  = 0;
     &enCambio    = 0;
     &enAnyo      = 0;

      {-1} aMenuCap   = "";
           aMenuCap1  = "1262";
           aMenuCap2  = "1";
           aMenuCap3  = "4";
           aMenuCap4  = "MANUAL    ";
           aMenuCap5  = "PLANILLAS ";
           aMenuCap6  = "REGISTROS ";
           aMenuCap7  = "MODULOS   ";


|FIN;

|INCLUYE i_consul;

|PROCESO NombreRepre;
     |HAZ LeeNifs;     || Esto no haze n  pero quien lo toque
                       || los corto lo guevos  PARAQUITAR
|FPRC;

|PROCESO ModiTAct;
     |C_M #0#10, 1, "N";
     |C_M #0#12, 1, "N";
     |SI #0#3 = "O";  |Y #0#4 = "9999";
         |C_M #0#10, 1, "S";
         |C_M #0#12, 1, "S";

         |SI #0#10 < 900;  #0#10 = 999;  |FINSI;
     |SINO;
         |SI #0#3 = "E";
             aAlfa   = #0#4 % 101;
             nFactor = aAlfa;
             nFactor = 100 + (nFactor * 10);
         |FINSI;

         |SI #0#3 = "P";
             aAlfa   = #0#4 % 101;
             nFactor = aAlfa;
             nFactor = 200 + (nFactor * 10);
         |FINSI;

         |SI #0#3 = "A";
             aAlfa   = #0#4 % 102;
             nFactor = aAlfa;
             nFactor = 300 + nFactor;
         |FINSI;

         #0#10 = nFactor;
     |FINSI;

     |ABRE #5;
     #5#0 = #0#10;
     |LEE 040#5=;
     |SI FSalida ! 0;  |DDEFECTO #5;  |FINSI;
     |CIERRA #5;

     #0#11 = #5#1;

     |PINTA #0#10;
     |PINTA #0#11;
|FPRC;

|PROCESO CogeTributa;
     nCodigoRenta = 0;
     |SI #0#4 = "8612";  nCodigoRenta = 1;  |FINSI;

     |SI #0#8 ! 1;  |Y #0#8 ! 2;  |Y #0#8 ! 8;  |Y #0#8 ! 9;
      |Y #0#8 ! 10; |Y #0#8 ! 11; |Y #0#8 ! 12; |Y #0#8 ! 18;
         nCodigoRenta = 1;
     |FINSI;

     |C_M #0#14, 1, "S";
     |C_M #0#15, 1, "S";
     |SI nCodigoRenta = 0;
         |C_M #0#14, 1, "N";  #0#14 = 0;   |PINTA #0#14;
         |C_M #0#15, 1, "N";  #0#15 = "";  |PINTA #0#15;
     |SINO;
         |SI #0#14 = 0;
             #0#14 = #0#0;  |PINTA #0#14;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Sector; |TIPO 6;
     |SI #0#3 ! "O";  |ACABA;  |FINSI;

     aAlfa = ("000" + #0#10) % -301;
     |SI aAlfa ! "9";
         |MENAV "      Introduzca un Sector que comience por <9> para los Epigrafes sin IAE";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO CodigoRenta;
     |SI #0#14 = 0;  |ACABA;  |FINSI;

     |ABRE #6;
     #6#0 = #0#14;
     |LEE 040#6=;
     |SI FSalida ! 0;
         |MENAV "      No Existe Cliente.";
         |ERROR;
     |FINSI;
     |CIERRA #6;

     |ATRI S;
     |PINTA 1423, #6#1;
     |ATRI s;
|FPRC;

|PROCESO PintaCod;  |TIPO 7;
     |ABRE #6;
     #6#0 = #0#14;
     |LEE 040#6=;
     |SI FSalida ! 0;  |DDEFECTO #6; |FINSI;
     |CIERRA #6;

     |ATRI S;
     |PINTA 1423, #6#1;
     |ATRI s;
|FPRC;

|PROCESO Captura30; |TIPO 0;
     |SI #0Campo ! aMenuCap4; |Y #0Campo ! aMenuCap5; |Y #0Campo ! aMenuCap6; |Y #0Campo ! aMenuCap7;
         #0Campo = "";
     |FINSI;

     |SI FSalida = 10;  |Y #0Campo ! "          ";

     |SINO;
         |SI #0Campo ! "          ";
             |ACABA;
         |FINSI;
     |FINSI;

     |PUSHV 0501 2380;
     |PARA; |SI; |HACIENDO;
          |SI #0#16 = aMenuCap4;  aMenuCap2 = "1";  |FINSI;
          |SI #0#16 = aMenuCap5;  aMenuCap2 = "2";  |FINSI;
          |SI #0#16 = aMenuCap6;  aMenuCap2 = "3";  |FINSI;
          |SI #0#16 = aMenuCap7;  aMenuCap2 = "4";  |FINSI;

          |MENUG aMenuCap;
          aMenuCap2 = FSalida;
          nSw = 0;

          |SI aMenuCap2 = "2";
              |SI #0#6 = 1;   nSw = 1;  |FINSI;
              |SI #0#6 = 3;   nSw = 1;  |FINSI;
              |SI #0#6 = 9;   nSw = 1;  |FINSI;
              |SI #0#6 = 10;  nSw = 1;  |FINSI;

              |SI #0#8 = 1;   |Y nSw = 1;  nSw = 0;  |FINSI;
              |SI #0#8 = 3;   |Y nSw = 1;  nSw = 0;  |FINSI;
              |SI #0#8 = 4;   |Y nSw = 1;  nSw = 0;  |FINSI;
              |SI #0#8 = 8;   |Y nSw = 1;  nSw = 0;  |FINSI;
              |SI #0#8 = 9;   |Y nSw = 1;  nSw = 0;  |FINSI;
              |SI #0#8 = 18;  |Y nSw = 1;  nSw = 0;  |FINSI;

              |||SI #0#8 = 2;   |Y nSw = 0;  nSw = 1;  |FINSI;
              |SI #0#8 = 5;   |Y nSw = 0;  nSw = 1;  |FINSI;
              |SI #0#8 = 6;   |Y nSw = 0;  nSw = 1;  |FINSI;
              |SI #0#8 = 7;   |Y nSw = 0;  nSw = 1;  |FINSI;
              |SI #0#8 = 10;  |Y nSw = 0;  nSw = 1;  |FINSI;
              |SI #0#8 = 11;  |Y nSw = 0;  nSw = 1;  |FINSI;
              |SI #0#8 = 12;  |Y nSw = 0;  nSw = 1;  |FINSI;
              |SI #0#8 = 13;               nSw = 1;  |FINSI;
              |SI #0#8 = 14;               nSw = 1;  |FINSI;
              |SI #0#8 = 15;               nSw = 1;  |FINSI;
              |SI #0#8 = 16;               nSw = 1;  |FINSI;
              |SI #0#8 = 17;               nSw = 1;  |FINSI;
              |SI #0#9 = 19;               nSw = 1;  |FINSI;

              |SI nSw = 1;
                  |MENAV "     No procede las PLANILLAS";
                  aMenuCap2 = "0";
              |FINSI;
          |FINSI;

          |SI aMenuCap2 = "4";
              nSw = 1;

              |ABRE #16;
              #16#0  = #0#3;
              #16#1  = #0#4;
              #16#2  = #0#2;
              #16#41 = 1;
              |LEE 040#16];
              |SI #16#0 = #0#3;  |Y #16#1 = #0#4; |Y #16#2 = #0#2;
                  nSw = 0;
              |FINSI;
              |CIERRA #16;

              |SI nSw = 0;
                  |SI #0#8 ! 5;  |Y #0#8 ! 10;
                      nSw = 1;
                  |FINSI;
              |FINSI;

              |SI nSw = 1;
                  |SI #0#8 = 15;
                      |MENAV "     Es comunero no procede MODULOS, asigneselo a la COMUNIDAD";
                  |SINO;
                      |MENAV "     No procede los MODULOS";
                  |FINSI;
                  aMenuCap2 = "0";
              |FINSI;
          |FINSI;

          |SI aMenuCap2 = "1";   #0#16 = aMenuCap4;  |SAL;  |FINSI;
          |SI aMenuCap2 = "2";   #0#16 = aMenuCap5;  |SAL;  |FINSI;
          |SI aMenuCap2 = "3";   #0#16 = aMenuCap6;  |SAL;  |FINSI;
          |SI aMenuCap2 = "4";   #0#16 = aMenuCap7;  |SAL;  |FINSI;
     |SIGUE;
     |POPV;

     |PINTA #0#16;
|FPRC;

|RUTINA ClaveBaja30;
     #0#0  = enEmpresa;
     #0#1  = enActividad;
     #0#2  = 0000;
|FRUT;

|RUTINA ClaveAlta30;
     #0#0  = enEmpresa;
     #0#1  = enActividad;
     #0#2  = 2999;
|FRUT;

|PROCESO PonerCaptura;
   #0#16 = eaCaptura;
   |GRABA 020#0a;
   |LIBERA #0;
|FPRC;

|DEFBUCLE PonerCaptura;
   #0#1;
   16;
   enEmpresa, enActividad, 0001, "          ";
   enEmpresa, enActividad, 2099, "          ";
   be;
   NULL, PonerCaptura;
|FIN;

|PROGRAMA;
     nSw = 0;
     |ABRE #0;
     #0#0 = enEmpresa;
     #0#1 = enActividad;
     #0#2 = 0;
     |LEE 041#0];
     |SI FSalida = 0; |Y #0#0 = enEmpresa; |Y #0#1 = enActividad;
         nSw = 1;
         |SI #0#16 ! "          "; nSw = 0; |FINSI;
     |FINSI;
     |CIERRA #0;
     |SI nSw = 1;
         |BUCLE PonerCaptura;
     |FINSI;
     enCambio = 0;
     |ENTLINEAL #1#0, -3, enModo, 22, 1, ClaveBaja30, ClaveAlta30;
|FPRO;
