|FICHEROS;
     agiy0024 #0;             || Este def
     agifigen #1;             || Clientes
     agim0004 #2;             || Representantes Empresas

     &haciend@  #706;          || Hacienda
     &regisnif@ #709;          || Nifs
     &clientes@ #715;          || Nifs
|FIN;

|VARIABLES;
     XPara         = 0;

     &enCodProv   = 0;
     &enCodPobl   = 0;
     &eaCodNif    = "";
     &enCodCli    = 0;
     &enSwDeDonde = 0;
|FIN;

|PROCESO PintaCliente; |TIPO 0;
     enCodCli = #0#0;
     |HAZ LeePersona;
     |SI enSwDeDonde = 1;
         #0#1  = #715#1;
         #0#2  = #715#3;
     |SINO;
         #0#1  = #715#1;
         #0#2  = #715#13;
     |FINSI;
     |PINTA #0#1;
     |PINTA #0#2;
|FPRC;

|PROCESO NombreRepre;
      eaCodNif  = #0#3;
      |HAZ LeeNifs;

      #0#4 = #709#1;  |PINTA #0#4;
|FPRC;

|PROCESO Representante; |TIPO 0;
  |ABRE #2;
  #2#0 = #0#0;           || Codigo Empresa
  #2#1 = 1;
  |LEE 040#2];
  |SI FSalida = 0; |Y #2#0 = #0#0;
      #0#3 = #2#2;       || Nif del Representante
      #0#4 = #2#3;       || Nombre del Representante;
  |SINO;
      #0#3 = "";         || Nif del Representante
      #0#4 = "";         || Nombre del Representante;
  |FINSI;

  |PINTA #0#3;
  |PINTA #0#4;

  |CIERRA #2;
|FPRC;

|PROCESO Cuadro;  |TIPO 7;
  |PUSHV 0501 2380;
  |D_CUADRO 1508, 2375;

  |ATRI R;
  |PINTA 1609, " 1.- No declarar por ning£n concepto.                             ";
  |PINTA 1709, " 2.- No haber presentado declaraci¢n del I.R.P.F.                 ";
  |PINTA 1809, " 3.- Copia certificada de la declaraci¢n del I.R.P.F.             ";
  |PINTA 1909, " 4.- Estar dado de alta en el I.A.E.                              ";
  |PINTA 2009, " 5.- Presentaci¢n de declaraciones u otros documentos tributarios.";
  |PINTA 2109, " 6.- Base Imponible declarada en I.R.P.F.                         ";
  |PINTA 2209, " 7.- Otros.                                                       ";
  |ATRI 0;
|FPRC;

|PROCESO Seleccion;
  |POPV;

  |PDEFECTO #0, 8, 19;
  |PINDA #0#0;

  |PARA XPara = 8; |SI XPara [ 18;  |HACIENDO XPara = XPara + 1;
        |C_M #0XPara, 1, "N";
  |SIGUE;

  |SI #0#7 = 2; |O #0#7 = 3; |O #0#7 = 6;
      |C_M #0#8, 1, "S";
  |FINSI;

  |SI #0#7 = 4;
      |C_M #0#11, 1, "S";
      |C_M #0#12, 1, "S";
      |C_M #0#13, 1, "S";
      |C_M #0#14, 1, "S";
      |C_M #0#15, 1, "S";
      |C_M #0#16, 1, "S";
  |FINSI;

  |SI #0#7 = 5;
      |C_M #0#9,  1, "S";
      |C_M #0#10, 1, "S";
  |FINSI;

  |SI #0#7 = 7;
      |C_M #0#17, 1, "S";
      |C_M #0#18, 1, "S";
  |FINSI;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;
     |HAZ PreparaInformes;

  |ET Arriba;
      |IMPRE 0;
      |SI FSalida ! 0;  |ACABA;  |FINSI;

      |PUSHV 0501 2380;
      |D_CUADRO 1119, 1464;
      |ATRI R;
      |PINTA 1220, "INTRODUZCA MODELO OFICIAL 01 EN LA IMPRESORA";
      |PINTA 1320, "             (PULSE TECLA)                  ";
      |ATRI 0;
      |PAUSA;
      |POPV;

      |INFOR "agih9601";
      |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

      |ABRE #1;
      #1#0 = #0#0;
      |LEE 040#1=;
      |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
      |CIERRA #1;

      enCodProv = #1#63;
      enCodPobl = #1#64;
      |HAZ LeeHacienda;

      eaCodNif  = #0#3;
      |HAZ LeeNifs;

      |PRINT;
      |PIEINF;
      |FININF;
      |FINIMP;

      |CONFI "2400NDesea imprimirlo de nuevo : ";
      |SI FSalida = 0;  |VETE Arriba;  |FINSI;
|FPRC;
