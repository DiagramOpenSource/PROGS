|FICHEROS;
     agicen23 #23;
     agicen24 #24,MANTE;
     agiw0056 #956,MANTE;
|FIN;

|VARIABLES;
     nCampoD     = 0;
     nCampoH     = 0;
     nForma      = 0;
     nModo       = 0;

     &enEmpresa  = 0;
     &enRegistro = 0;
     &eaTipo     = "";
     &enOpcion   = 0;
|FIN;

|RUTINA ClaveBaja23;
     #23#0 = enEmpresa;
     #23#1 = enRegistro;
     #23#2 = 1;
|FRUT;

|RUTINA ClaveAlta23;
     #23#0 = enEmpresa;
     #23#1 = enRegistro;
     #23#2 = 99;
|FRUT;

|RUTINA ClaveBaja24;
     #24#0 = #23#0;
     #24#1 = #23#1;
     #24#2 = #23#2;
     #24#3 = 1;
|FRUT;

|RUTINA ClaveAlta24;
     #24#0 = #23#0;
     #24#1 = #23#1;
     #24#2 = #23#2;
     #24#3 = 99;
|FRUT;

|PROCESO CargaPantalla;
     |PUSHV 0501 2380;
     |DDEFECTO #956;

     |PARA nCampoD = 0;  |SI nCampoD [ 14;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 3;
           #956nCampoD = #23nCampoH;
           #956#12 = #23#15;
           #956#14 = #23#17;
           #956#15 = #23#19;
           #956#16 = #23#20;
     |SIGUE;

     |PINPA #0#956;
     |PINDA #0#956;
     |ENDATOS #1#956;
     |SI FSalida = 0;
         |PARA nCampoD = 0;  |SI nCampoD [ 14;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH = nCampoD + 3;
               #23nCampoH = #956nCampoD;
         |SIGUE;
          || #23#18 = #956#0 + #956#2;
          #23#15 = #956#12;
          #23#17 = #956#14;
          #23#19 = #956#15;
          #23#20 = #956#16;
     |FINSI;

     |ENTLINEAL #1#24, -4, 2, 22, 1, ClaveBaja24, ClaveAlta24;

     |POPV;
|FPRC;

|PROCESO agicen24B;
     |BORRA 020#24a;
     |LIBERA #24;
|FPRC;

|DEFBUCLE agicen24B;
     #24#1;
     ;
     #23#0, #23#1, #23#2, 01;
     #23#0, #23#1, #23#2, 99;
     be;
     NULL, agicen24B;
|FIN;

|PROCESO Tipo2Cen23;  |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
         |BUCLE agicen24B;
         |ACABA;
     |FINSI;

     nForma = 0 +. 1;
     |SI nForma ! 1;  |ACABA;  |FINSI;

     |HAZ CargaPantalla;
|FPRC;

|PROGRAMA;
     |ENTLINEAL #1#23, -3, 2, 22, 1, ClaveBaja23, ClaveAlta23;
|FPRO;
