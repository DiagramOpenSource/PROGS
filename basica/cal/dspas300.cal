|FICHEROS;
     dspase03;
     dspase15;
     dspase99;

     agitab99;
     agicen14;

     :/modelos/def/dsmom002;
     :/modelos/def/dsmom005;
     :/modelos/def/dsmom006;
     :/modelos/def/dsmom004;
     :/modelos/def/dsmom008;

     :/modelos/def/dsmociva;
     :/modelos/def/dsmoc349;
     :/modelos/def/dsmo3401;
     :/modelos/def/dsmo3402;
     :/modelos/def/dsmo3403;
     :/modelos/def/dsmo3404;
     :/modelos/def/dsmo3405;
     :/modelos/def/dsmom087;

     dspase25;

     refer00@;
     refer01@;
     refer02@;
     refer03@;
     refer04@;
     refer05@;
     refer06@;
     refer07@;
     refer08@;
     refer09@;

     &regisnif@;
|FIN;

|VARIABLES;
     aDef            = "";
     aFich           = "";
     aPeriodo        = "";
     aAlfa           = "";
     aQueQuiero      = "";
     aCampos         = "";
     nNumCampos      = 0;

     nTCampo         = 0;
     nCodigoNue      = 0;
     nCodigoReo      = 0;
     nCodigoCont     = 0;
     nAnyo           = 0;
     nPeriodo        = 0;
     nModelo         = 0;
     nEsta           = 0;
     nActiv          = 0;
     nCod340_1       = 0;
     nCod340_2       = 0;
     nCod340_3       = 0;
     nCampo          = 0;

     nEjer           = 0;
     nGrupo          = 0;
     nSubGrupo       = 0;
     nValor0         = 0;
     nValor1         = 0;
     nValor2         = 0;
     nValor3         = 0;
     nValor4         = 0;
     nValor5         = 0;
     nValor6         = 0;
     nValor7         = 0;
     nValor8         = 0;
     nValor9         = 0;
     nValor10        = 0;
     nValor11        = 0;
     nValor12        = 0;

     nValor13        = 0;
     nValor14        = 0;
     nValor15        = 0;
     nValor16        = 0;
     nValor17        = 0;
     nValor18        = 0;

     nValor19        = 0;
     nValor20        = 0;
     nValor21        = 0;

     nNumValor       = 0;
     nValor1_R       = 0;
     nValor2_R       = 0;
     nValor3_R       = 0;
     nValor4_R       = 0;
     nValor5_R       = 0;
     nValor6_R       = 0;
     nValor7_R       = 0;
     nValor8_R       = 0;
     nValor9_R       = 0;
     nValor10_R      = 0;
     nValor11_R      = 0;
     nValor12_R      = 0;
     nValor13_R      = 0;
     nValor14_R      = 0;
     nValor15_R      = 0;
     nValor16_R      = 0;
     nValor17_R      = 0;
     nValor18_R      = 0;
     nValor19_R      = 0;
     nValor20_R      = 0;
     nValor21_R      = 0;
     nNume           = 0;
     nNume1          = 0;
     nNume2          = 0;
     nNume3          = 0;
     nSuma           = 0;
     nPara1          = 0;
     nDPer           = 0;
     nHPer           = 0;
     nCampo1         = 0;
     nCampo2         = 0;
     aDef09          = "";

     &enModelo       = 0;
     &enEstaCambio   = 0;
     &enEmpresa      = 0;
     &enEmpresaA     = 0;
     &enEjercicioA   = 0;
     &enPeriodoA     = 0;
     &enAnyo         = 0;
     &enSwEstar      = 0;
     &enEjer         = 0;
     &enPeriodo      = 0;
     &enComplem      = 0;
     &enActividad    = 0;
     &enTipoEntrada  = 0;
     &enDevolver     = 0;
     &enPregunta     = 0;
     &eaArchiva      = "";
     &efFechaI       = @;
     &eaCodNif       = "";

     &eaPathAnterior = "";
     &eaPathBasica   = "";
     &eaPathContagen = "";
     &eaPathContanex = "";
     &eaPathContasoc = "";
     &eaPathRen2000  = "";
     &eaPathRen1999  = "";
     &eaPathRen1998  = "";
     &eaPathRen1997  = "";
     &eaPathRen1996  = "";
     &eaPathRen1995  = "";
     &eaPathRen1994  = "";
     &eaPathFacturar = "";
     &eaPathLaboral  = "";
     &eaPathIntegral = "";
     &eaPathDsmodelo = "";
     &eaPathFiscal   = "";

     &enSwCompensa = 0;
     &enDEmpresa   = 0;
     &enHEmpresa   = 0;
|FIN;

|PROCESO CogeCodigo300;
     |SI #dspase15#22 = "S";  |ACABA;  |FINSI;

     nCodigoNue = #dspase15#3;
     |ERROR10;
|FPRC;

|DEFBUCLE dspase15_300;
     #dspase15#4;
     ;
     nCodigoReo, "            ", 000;
     nCodigoReo, "zzzzzzzzzzzz", 999;
     ;
     NULL, CogeCodigo300;
|FIN;

|DEFBUCLE dspase15_Cont300;
     #dspase15#5;
     ;
     nCodigoCont, "            ", 000;
     nCodigoCont, "zzzzzzzzzzzz", 999;
     ;
     NULL, CogeCodigo300;
|FIN;

|| ///////////////// Procesos Totales del dsmociva \\\\\\\\\\\\\\\\\\\\

|PROCESO LeeCasilla;
     #dsmociva#0 = nCodigoNue;
     #dsmociva#1 = #dspase03#4;
     #dsmociva#2 = nPeriodo;
     #dsmociva#3 = nModelo;
     #dsmociva#4 = 0;
     #dsmociva#5 = #agicen14#1;
     #dsmociva#6  = nGrupo;
     #dsmociva#7  = nSubGrupo;
     |LEE 040#dsmociva.=;
     |SI FSalida ! 0;  |DDEFECTO #dsmociva;  |FINSI;
|FPRC;

|PROCESO Total1_9;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 1;  nSubGrupo = 1;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;
     nValor2   = nValor2 + #dsmociva#13;

     nGrupo    = 1;  nSubGrupo = 2;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;
     nValor2   = nValor2 + #dsmociva#13;

     nGrupo    = 1;  nSubGrupo = 3;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;
     nValor2   = nValor2 + #dsmociva#13;

     nGrupo    = 1;  nSubGrupo = 4;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;
     nValor2   = nValor2 + #dsmociva#13;

     nGrupo    = 1;  nSubGrupo = 5;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;
     nValor2   = nValor2 + #dsmociva#13;

     nGrupo    = 1;  nSubGrupo = 6;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;
     nValor2   = nValor2 + #dsmociva#13;

     nGrupo    = 1;  nSubGrupo = 7;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;
     nValor2   = nValor2 + #dsmociva#13;

     nGrupo    = 1;  nSubGrupo = 8;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;
     nValor2   = nValor2 + #dsmociva#13;

     #dsmociva#0 = nCodigoNue;
     #dsmociva#1 = #dspase03#4;
     #dsmociva#2 = nPeriodo;
     #dsmociva#3 = nModelo;
     #dsmociva#4 = 0;
     #dsmociva#5 = #agicen14#1;
     #dsmociva#6  = 1;
     #dsmociva#7  = 9;
     |LEE 101#dsmociva.=;
     |SI FSalida = 0;
         #dsmociva#12 = nValor1;
         #dsmociva#13 = nValor2;
         |GRABA 020#dsmociva.a;
         |LIBERA #dsmociva;
     |FINSI;
|FPRC;

|PROCESO Total1_13;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 1;  nSubGrupo = 9;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;
     nValor2   = nValor2 + #dsmociva#13;

     nGrupo    = 1;  nSubGrupo = 10;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;
     nValor2   = nValor2 + #dsmociva#13;

     nGrupo    = 1;  nSubGrupo = 11;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;
     nValor2   = nValor2 + #dsmociva#13;

     nGrupo    = 1;  nSubGrupo = 12;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;
     nValor2   = nValor2 + #dsmociva#13;

     #dsmociva#0 = nCodigoNue;
     #dsmociva#1 = #dspase03#4;
     #dsmociva#2 = nPeriodo;
     #dsmociva#3 = nModelo;
     #dsmociva#4 = 0;
     #dsmociva#5 = #agicen14#1;
     #dsmociva#6  = 1;
     #dsmociva#7  = 13;
     |LEE 101#dsmociva.=;
     |SI FSalida = 0;
         #dsmociva#12 = nValor1;
         #dsmociva#13 = nValor2;
         |GRABA 020#dsmociva.a;
         |LIBERA #dsmociva;
     |FINSI;
|FPRC;

|PROCESO Total3_1;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 1;  nSubGrupo = 1;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;

     nGrupo    = 1;  nSubGrupo = 2;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;

     nGrupo    = 1;  nSubGrupo = 3;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;

     nGrupo    = 1;  nSubGrupo = 4;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;

     #dsmociva#0 = nCodigoNue;
     #dsmociva#1 = #dspase03#4;
     #dsmociva#2 = nPeriodo;
     #dsmociva#3 = nModelo;
     #dsmociva#4 = 0;
     #dsmociva#5 = #agicen14#1;
     #dsmociva#6  = 3;
     #dsmociva#7  = 1;
     |LEE 101#dsmociva.=;
     |SI FSalida = 0;
         #dsmociva#12 = nValor1;
         |GRABA 020#dsmociva.a;
         |LIBERA #dsmociva;
     |FINSI;
|FPRC;

|PROCESO Total3_4;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 1;  nSubGrupo = 1;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;

     #dsmociva#0 = nCodigoNue;
     #dsmociva#1 = #dspase03#4;
     #dsmociva#2 = nPeriodo;
     #dsmociva#3 = nModelo;
     #dsmociva#4 = 0;
     #dsmociva#5 = #agicen14#1;
     #dsmociva#6  = 3;
     #dsmociva#7  = 4;
     |LEE 101#dsmociva.=;
     |SI FSalida = 0;
         #dsmociva#12 = nValor1;
         |GRABA 020#dsmociva.a;
         |LIBERA #dsmociva;
     |FINSI;
|FPRC;

|PROCESO Total3_5;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 1;  nSubGrupo = 2;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;

     #dsmociva#0 = nCodigoNue;
     #dsmociva#1 = #dspase03#4;
     #dsmociva#2 = nPeriodo;
     #dsmociva#3 = nModelo;
     #dsmociva#4 = 0;
     #dsmociva#5 = #agicen14#1;
     #dsmociva#6  = 3;
     #dsmociva#7  = 5;
     |LEE 101#dsmociva.=;
     |SI FSalida = 0;
         #dsmociva#12 = nValor1;
         |GRABA 020#dsmociva.a;
         |LIBERA #dsmociva;
     |FINSI;
|FPRC;

|PROCESO Total3_6;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 1;  nSubGrupo = 3;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;

     #dsmociva#0 = nCodigoNue;
     #dsmociva#1 = #dspase03#4;
     #dsmociva#2 = nPeriodo;
     #dsmociva#3 = nModelo;
     #dsmociva#4 = 0;
     #dsmociva#5 = #agicen14#1;
     #dsmociva#6  = 3;
     #dsmociva#7  = 6;
     |LEE 101#dsmociva.=;
     |SI FSalida = 0;
         #dsmociva#12 = nValor1;
         |GRABA 020#dsmociva.a;
         |LIBERA #dsmociva;
     |FINSI;
|FPRC;

|PROCESO Total3_7;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 1;  nSubGrupo = 4;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;

     #dsmociva#0 = nCodigoNue;
     #dsmociva#1 = #dspase03#4;
     #dsmociva#2 = nPeriodo;
     #dsmociva#3 = nModelo;
     #dsmociva#4 = 0;
     #dsmociva#5 = #agicen14#1;
     #dsmociva#6  = 3;
     #dsmociva#7  = 7;
     |LEE 101#dsmociva.=;
     |SI FSalida = 0;
         #dsmociva#12 = nValor1;
         |GRABA 020#dsmociva.a;
         |LIBERA #dsmociva;
     |FINSI;
|FPRC;

|PROCESO Total2_10;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 2;  nSubGrupo = 1;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;
     nValor2   = nValor2 + #dsmociva#13;

     nGrupo    = 2;  nSubGrupo = 2;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;
     nValor2   = nValor2 + #dsmociva#13;

     nGrupo    = 2;  nSubGrupo = 3;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;
     nValor2   = nValor2 + #dsmociva#13;

     nGrupo    = 2;  nSubGrupo = 4;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;
     nValor2   = nValor2 + #dsmociva#13;

     nGrupo    = 2;  nSubGrupo = 5;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;
     nValor2   = nValor2 + #dsmociva#13;

     nGrupo    = 2;  nSubGrupo = 6;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;
     nValor2   = nValor2 + #dsmociva#13;

     nGrupo    = 2;  nSubGrupo = 7;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;
     nValor2   = nValor2 + #dsmociva#13;

     nGrupo    = 2;  nSubGrupo = 8;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;
     nValor2   = nValor2 + #dsmociva#13;

     nGrupo    = 2;  nSubGrupo = 9;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;
     nValor2   = nValor2 + #dsmociva#13;

     |SI enEjer [ 2007;
         #dsmociva#0 = nCodigoNue;
         #dsmociva#1 = #dspase03#4;
         #dsmociva#2 = nPeriodo;
         #dsmociva#3 = nModelo;
         #dsmociva#4 = 0;
         #dsmociva#5 = #agicen14#1;
         #dsmociva#6 = 2;
         #dsmociva#7 = 10;
         |LEE 101#dsmociva.=;
         |SI FSalida = 0;
             #dsmociva#12 = nValor1;
             #dsmociva#13 = nValor2;
             |GRABA 020#dsmociva.a;
             |LIBERA #dsmociva;
         |FINSI;
     |FINSI;

     |SI enEjer ] 2008;
         nGrupo    = 2;  nSubGrupo = 10;   |HAZ LeeCasilla;
         nValor1   = nValor1 + #dsmociva#12;
         nValor2   = nValor2 + #dsmociva#13;
     |FINSI;

|| Importante los dos nuevos datos de Iva Soportado
     nGrupo    = 2;  nSubGrupo = 11;   |HAZ LeeCasilla;
     nValor1   = nValor1 - #dsmociva#12;
     nValor2   = nValor2 - #dsmociva#13;

     #dsmociva#0 = nCodigoNue;
     #dsmociva#1 = #dspase03#4;
     #dsmociva#2 = nPeriodo;
     #dsmociva#3 = nModelo;
     #dsmociva#4 = 0;
     #dsmociva#5 = #agicen14#1;
     #dsmociva#6 = 2;
     #dsmociva#7 = 12;
     |LEE 101#dsmociva.=;
     |SI FSalida = 0;
          #dsmociva#12 = nValor1;
          #dsmociva#13 = nValor2;
          |GRABA 020#dsmociva.a;
          |LIBERA #dsmociva;
     |FINSI;
|FPRC;

|PROCESO Total3_15;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 3;  nSubGrupo = 1;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;

     nGrupo    = 3;  nSubGrupo = 2;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;

     nGrupo    = 3;  nSubGrupo = 3;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;

     nGrupo    = 3;  nSubGrupo = 4;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;

     nGrupo    = 3;  nSubGrupo = 5;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;

     nGrupo    = 3;  nSubGrupo = 6;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;

     nGrupo    = 3;  nSubGrupo = 7;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;

     nGrupo    = 3;  nSubGrupo = 8;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;

     nGrupo    = 3;  nSubGrupo = 9;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;

     nGrupo    = 3;  nSubGrupo = 10;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;

     nGrupo    = 3;  nSubGrupo = 11;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;

     nGrupo    = 3;  nSubGrupo = 12;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsmociva#12;

     nGrupo    = 3;  nSubGrupo = 13;   |HAZ LeeCasilla;
     nValor1   = nValor1 - #dsmociva#12;

     nGrupo    = 3;  nSubGrupo = 14;   |HAZ LeeCasilla;
     nValor1   = nValor1 - #dsmociva#12;

     #dsmociva#0 = nCodigoNue;
     #dsmociva#1 = #dspase03#4;
     #dsmociva#2 = nPeriodo;
     #dsmociva#3 = nModelo;
     #dsmociva#4 = 0;
     #dsmociva#5 = #agicen14#1;
     #dsmociva#6  = 3;
     #dsmociva#7  = 15;
     |LEE 101#dsmociva.=;
     |SI FSalida = 0;
         #dsmociva#12 = nValor1;
         |GRABA 020#dsmociva.a;
         |LIBERA #dsmociva;
     |FINSI;
|FPRC;

|PROCESO Totales;
     |HAZ Total1_9;   || Total Bases y Cuotas I.V.A.
     |HAZ Total1_13;  || Total Bases y Cuotas I.V.A. y Recargo

     |SI enModelo = 300;  |O enModelo = 330;  |O enModelo = 370;
         |HAZ Total3_1;   || Operaciones en Regimen General
     |FINSI;

     |SI enModelo = 320;  |O enModelo = 332;
         |HAZ Total3_4;   || Operaciones en Regimen Ordinario
         |HAZ Total3_5;   || Operaciones en Regimen especial bienes usados etc.
         |HAZ Total3_6;   || Operaciones en Regimen especial Agencias Viajes
         |HAZ Total3_7;   || Operaciones en Determinacion Proporcional
     |FINSI;

     |SI enModelo = 303;
         |HAZ Total3_1;   || Operaciones en Regimen General
         |HAZ Total3_5;   || Operaciones en Regimen especial bienes usados etc.
         |HAZ Total3_6;   || Operaciones en Regimen especial Agencias Viajes
     |FINSI;

     |HAZ Total2_10;  || Suma de Deducciones
     |HAZ Total3_15;  || Total Volumnen de Operaciones
|FPRC;

|PROCESO GrabaApartado;
     #dsmociva#0 = nCodigoNue;
     #dsmociva#1 = #dspase03#4;
     #dsmociva#2 = nPeriodo;
     #dsmociva#3 = nModelo;
     #dsmociva#4 = 0;
     #dsmociva#5 = #agicen14#1;
     #dsmociva#6 = nGrupo;
     #dsmociva#7 = nSubGrupo;
     |LEE 101#dsmociva.=;
     |SI FSalida = 0;
         |SI #dsmociva#6 = 1;  |O #dsmociva#6 = 2;
             #dsmociva#14 = nValor1;   #dsmociva#15 = nValor2;   #dsmociva#16 = nValor3;
             #dsmociva#17 = nValor4;   #dsmociva#18 = nValor5;   #dsmociva#19 = nValor6;
             #dsmociva#20 = nValor7;   #dsmociva#21 = nValor8;   #dsmociva#22 = nValor9;
             #dsmociva#23 = nValor10;  #dsmociva#24 = nValor11;  #dsmociva#25 = nValor12;

             #dsmociva#26 = nValor13;  #dsmociva#27 = nValor14;  #dsmociva#28 = nValor15;
             #dsmociva#29 = nValor16;  #dsmociva#30 = nValor17;  #dsmociva#31 = nValor18;
             #dsmociva#32 = nValor19;  #dsmociva#33 = nValor20;  #dsmociva#34 = nValor21;

             #dsmociva#12 = #dsmociva#14 + #dsmociva#17 + #dsmociva#20 + #dsmociva#23 + #dsmociva#26 + #dsmociva#29 + #dsmociva#32;
             #dsmociva#13 = #dsmociva#16 + #dsmociva#19 + #dsmociva#22 + #dsmociva#25 + #dsmociva#28 + #dsmociva#31 + #dsmociva#34;
         |SINO;
             #dsmociva#12 = nValor0;
         |FINSI;

         |GRABA 020#dsmociva.a;
         |LIBERA #dsmociva;

         |SI #dspase03#4 > 2010;
             |SI #dsmociva#6 = 2; |Y #dsmociva#7 ] 1; |Y #dsmociva#7 [ 6;
                 |ABRE #dsmom087;
                 |DDEFECTO #dsmom087;
                 #dsmom087#0 = #dsmociva#0;
                 #dsmom087#1 = #dsmociva#1;
                 #dsmom087#2 = #dsmociva#2;
                 #dsmom087#3 = #dsmociva#3;
                 #dsmom087#4 = #dsmociva#4;
                 #dsmom087#5 = #dsmociva#5;
                 #dsmom087#6 = #dsmociva#6;
                 #dsmom087#7 = #dsmociva#7;
                 |LEE 141#dsmom087.=;
                 |SI FSalida ! 0;
                     |DDEFECTO #dsmom087;
                     #dsmom087#0 = #dsmociva#0;
                     #dsmom087#1 = #dsmociva#1;
                     #dsmom087#2 = #dsmociva#2;
                     #dsmom087#3 = #dsmociva#3;
                     #dsmom087#4 = #dsmociva#4;
                     #dsmom087#5 = #dsmociva#5;
                     #dsmom087#6 = #dsmociva#6;
                     #dsmom087#7 = #dsmociva#7;
                     |GRABA 020#dsmom087.b;
                 |FINSI;

                 #dsmom087#11 = 100; #dsmom087#36 = 100;

                 #dsmom087#15 = #dsmociva#15; #dsmom087#16 = #dsmociva#16; #dsmom087#17 = #dsmom087#16;
                 #dsmom087#18 = #dsmociva#18; #dsmom087#19 = #dsmociva#19; #dsmom087#20 = #dsmom087#19;
                 #dsmom087#21 = #dsmociva#21; #dsmom087#22 = #dsmociva#22; #dsmom087#23 = #dsmom087#22;
                 #dsmom087#24 = #dsmociva#24; #dsmom087#25 = #dsmociva#25; #dsmom087#26 = #dsmom087#25;
                 #dsmom087#27 = #dsmociva#27; #dsmom087#28 = #dsmociva#28; #dsmom087#29 = #dsmom087#28;
                 #dsmom087#30 = #dsmociva#30; #dsmom087#31 = #dsmociva#31; #dsmom087#32 = #dsmom087#31;
                 #dsmom087#33 = #dsmociva#33; #dsmom087#34 = #dsmociva#34; #dsmom087#35 = #dsmom087#34;

                 #dsmom087#12 = #dsmom087#16 + #dsmom087#19 + #dsmom087#22 + #dsmom087#25 + #dsmom087#28 + #dsmom087#31 + #dsmom087#34;
                 #dsmom087#13 = #dsmom087#17 + #dsmom087#20 + #dsmom087#23 + #dsmom087#26 + #dsmom087#29 + #dsmom087#32 + #dsmom087#35;
                 #dsmom087#14 = #dsmom087#12 - #dsmom087#13;

                 #dsmom087#8  = #dsmom087#12 + #dsmom087#37;
                 #dsmom087#9  = #dsmom087#13 + #dsmom087#38;
                 #dsmom087#10 = #dsmom087#8  - #dsmom087#9;
                 |GRABA 020#dsmom087.a;
                 |LIBERA #dsmom087;
                 |CIERRA #dsmom087;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|| *************************************************************************
|| *************************************************************************
|| *************************************************************************
||               M O D E L O   3 0 0
|| *************************************************************************
|| *************************************************************************
|| *************************************************************************

|PROCESO PasaModelo300;
     |SI enEstaCambio = 1;
         nCodigoNue = 0;
         nCodigoReo = #refer00@#0;
         |BUCLE dspase15_300;
         |SI nCodigoNue = 0;  |ACABA;  |FINSI;
     |SINO;
         nCodigoNue = #refer00@#0;
     |FINSI;
     |SI nCodigoNue < #dspase03#9; |O nCodigoNue > #dspase03#10; |ACABA; |FINSI;

     |SI #dspase03#8 ! 1;
         #dspase99#0 = nCodigoNue;
         #dspase99#1 = 300;
         |LEE 101#dspase99.=;
         |SI FSalida ! 0;
             enDEmpresa = nCodigoNue;
             enHEmpresa = nCodigoNue;
             enModelo   = 300;
             |SUB_EJECUTA "dspasuti;BorraModelos";

             #dspase99#0 = nCodigoNue;
             #dspase99#1 = 300;
             |GRABA 020#dspase99.n;
             |LIBERA #dspase99;
         |FINSI;
     |FINSI;

     #refer02@#0 = nCodigoReo;
     |LEE 040#refer02@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer02@;  |FINSI;

     #agicen14#0 = nCodigoNue;
     #agicen14#1 = #refer00@#45;
     |LEE 101#agicen14.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     #agicen14#6 = "01.01.0000";

     nModelo = 300;
     |SI #refer02@#60 = "S";
         nModelo = 370;
     |FINSI;

     #agitab99#0 = 300;
     |LEE 040#agitab99.=;
     |SI FSalida ! 0;  |DDEFECTO #agitab99;  |FINSI;

     #dsmom002#0 = nCodigoNue;
     #dsmom002#1 = #refer00@#45;
     #dsmom002#2 = 300;
     |LEE 101#dsmom002.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmom002;
         #dsmom002#0  = nCodigoNue;
         #dsmom002#1  = #refer00@#45;
         #dsmom002#2  = 300;
         |GRABA 020#dsmom002.b;
     |FINSI;

     #dsmom002#3  = #agitab99#1;
     #dsmom002#4  = #agitab99#2;
     #dsmom002#5  = #agitab99#3;
     #dsmom002#6  = #agicen14#4;
     #dsmom002#7  = "TRIMESTRAL";
     #dsmom002#8  = #agicen14#5;
     #dsmom002#9  = #agicen14#6;
     #dsmom002#10 = 1;

     |GRABA 020#dsmom002.a;
     |LIBERA #dsmom002;

     |SI #agicen14#15 = "          ";  |O #agicen14#15 = "MODULOS   ";
          #agicen14#15 = "MANUAL";
     |FINSI;
     |GRABA 020#agicen14.a;
     |LIBERA #agicen14;

                         enSwEstar = 0;
     |SI nModelo = 370;  enSwEstar = 1;  |FINSI;

     enEmpresaA = nCodigoNue;
     enAnyo     = #dspase03#4;
     |SUB_EJECUTA_NP ":modelos/dsmoz001";

     |SI #refer00@#1 = 1;  nPeriodo = 3;   |FINSI;
     |SI #refer00@#1 = 2;  nPeriodo = 6;   |FINSI;
     |SI #refer00@#1 = 3;  nPeriodo = 9;   |FINSI;
     |SI #refer00@#1 = 4;  nPeriodo = 12;  |FINSI;

     |ABRE #dsmom008;
     #dsmom008#0   = nCodigoNue;
     #dsmom008#1   = #dspase03#4;
     #dsmom008#2   = nPeriodo;
     #dsmom008#3   = nModelo;
     #dsmom008#4   = 0;
     #dsmom008#5   = #agicen14#1;
     |LEE 040#dsmom008.=;
     |SI FSalida ! 0;  |CIERRA #dsmom008;  |ACABA;  |FINSI;
     |CIERRA #dsmom008;

     #refer03@#0  = #refer00@#0;
     #refer03@#1  = #refer00@#45;
     #refer03@#2  = #refer00@#1;
     #refer03@#3  = #refer00@#2;
     |LEE 040#refer03@.=;

     #refer01@#0 = #refer00@#0;
     #refer01@#1 = #refer00@#45;
     #refer01@#2 = #refer00@#2;
     |LEE 040#refer01@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer01@;  |FINSI;

     |SI #refer01@#4 ! "E";  |Y #refer01@#4 ! "P";
      |Y #refer01@#4 ! "A";  |Y #refer01@#4 ! " ";
         #refer01@#4 = "O";
         #refer01@#5 = "9999";
     |FINSI;


     enEmpresa     = nCodigoNue;
     enEjer        = #dspase03#4;
     enPeriodo     = nPeriodo;
     enModelo      = nModelo;
     enComplem     = 0;
     enActividad   = #agicen14#1;
     enTipoEntrada = 90;
     |SUB_EJECUTA_NP ":modelos/dsmociva";

                       nGrupo = 1;  nSubGrupo = 1;
     |SI #refer01@#29 = 1;  nGrupo = 1;  nSubGrupo = 1;  |FINSI;
     |SI #refer01@#29 = 2;  nGrupo = 1;  nSubGrupo = 2;  |FINSI;
     |SI #refer01@#29 = 3;  nGrupo = 1;  nSubGrupo = 2;  |FINSI;
     |SI #refer01@#29 = 4;  nGrupo = 1;  nSubGrupo = 3;  |FINSI;
     |SI #refer01@#29 = 5;  nGrupo = 1;  nSubGrupo = 4;  |FINSI;

     |ABRE #dsmociva;

     nValor1  = #refer00@#5;   nValor2  = #refer00@#6;   nValor3  = #refer00@#7;
     nValor4  = #refer00@#8;   nValor5  = #refer00@#9;   nValor6  = #refer00@#10;
     nValor7  = #refer00@#11;  nValor8  = #refer00@#12;  nValor9  = #refer00@#13;
     nValor10 = 0;        nValor11 = 0;        nValor12 = 0;

     |HAZ GrabaApartado;         || Ventas

     nGrupo    = 1;
     nSubGrupo = 10;
     nValor1   = #refer00@#14;  nValor2  = #refer00@#15;  nValor3  = #refer00@#16;
     nValor4   = #refer00@#17;  nValor5  = #refer00@#18;  nValor6  = #refer00@#19;
     nValor7   = #refer00@#46;  nValor8  = #refer00@#47;  nValor9  = #refer00@#48;
     nValor10  = 0;        nValor11 = 0;        nValor12 = 0;

     |HAZ GrabaApartado;         || Recargo de Equivalencia

     nGrupo    = 1;
     nSubGrupo = 5;
     nValor1   = #refer00@#58;   nValor2  = #refer00@#59;   nValor3  = #refer00@#60;
     nValor4   = #refer00@#61;   nValor5  = #refer00@#62;   nValor6  = #refer00@#63;
     nValor7   = #refer00@#64;   nValor8  = #refer00@#65;   nValor9  = #refer00@#66;
     nValor10  = #refer00@#67;   nValor11 = #refer00@#68;   nValor12 = #refer00@#69;

     |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias

     |SI #refer00@#21 ! 0;
         nGrupo    = 2;
         nSubGrupo = 1;
         nValor1   = #refer00@#70;   nValor2  = 0;         nValor3  = #refer00@#21;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#22 ! 0;
         nGrupo    = 2;
         nSubGrupo = 3;
         nValor1   = #refer00@#71;   nValor2  = 0;         nValor3  = #refer00@#22;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#51 ! 0;
         nGrupo    = 2;
         nSubGrupo = 5;
         nValor1   = #refer00@#72;   nValor2  = 0;         nValor3  = #refer00@#51;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#23 ! 0;
         nGrupo    = 2;
         nSubGrupo = 7;
         nValor1   = #refer00@#73;   nValor2  = 0;         nValor3  = #refer00@#23;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#24 ! 0;
         nGrupo    = 2;
         nSubGrupo = 9;
         nValor1   = #refer00@#74;   nValor2  = 0;         nValor3  = #refer00@#24;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#43 ! 0;
         nGrupo    = 2;
         nSubGrupo = 2;
         nValor1   = #refer00@#75;   nValor2  = 0;         nValor3  = #refer00@#43;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#44 ! 0;
         nGrupo    = 2;
         nSubGrupo = 4;
         nValor1   = #refer00@#76;   nValor2  = 0;         nValor3  = #refer00@#44;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     nGrupo    = 5;
     nSubGrupo = 1;
     nValor0   = #refer00@#27;
     |HAZ GrabaApartado;         || Atribuible al Estado

     nGrupo    = 3;
     nSubGrupo = 9;
     nValor0   = #refer00@#54;
     |HAZ GrabaApartado;         || Entregas Intracomunitarias

     nGrupo    = 5;
     nSubGrupo = 6;
     nValor0   = #refer00@#29;
     |HAZ GrabaApartado;         || Compensacion

     nGrupo    = 3;
     nSubGrupo = 2;
     nValor0   = #refer03@#4;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 3;
     nValor0   = #refer03@#5;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 8;
     nValor0   = #refer03@#6;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 10;
     nValor0   = #refer03@#8;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 12;
     nValor0   = #refer03@#9;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 13;
     nValor0   = #refer03@#10;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 14;
     nValor0   = #refer03@#11;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 1;
     nValor0   = #refer03@#12;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 5;
     nValor0   = #refer03@#13;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 6;
     nValor0   = #refer03@#14;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 7;
     nValor0   = #refer03@#15;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 8;
     nValor0   = #refer03@#16;
     |HAZ GrabaApartado;

     |HAZ Totales;

     |CIERRA #dsmociva;

     |SI nPeriodo = 12;
         |ABRE #dsmom005;
         #dsmom005#0 = nModelo;
         |LEE 040#dsmom005.=;
         |SI FSalida ! 0;  |DDEFECTO #dsmom005;  |FINSI;
         |CIERRA #dsmom005;

         |SI #refer01@#27 = "D";  |Y #dsmom005#11 = "COMPENSAR";
             |ABRE #dsmom006;
             #dsmom006#0  = nCodigoNue;
             #dsmom006#1  = #dsmom005#0;
             |LEE 101#dsmom006.=;
             |SI FSalida ! 0;
                 |DDEFECTO #dsmom006;
                 #dsmom006#0  = nCodigoNue;
                 #dsmom006#1  = #dsmom005#0;
                 #dsmom006#2  = #dsmom005#1;
                 #dsmom006#3  = #dsmom005#2;
                 #dsmom006#4  = #dsmom005#3;
                 #dsmom006#5  = #dsmom005#4;
                 #dsmom006#6  = #dsmom005#5;
                 #dsmom006#7  = #dsmom005#6;
                 #dsmom006#8  = #dsmom005#7;
                 #dsmom006#9  = #dsmom005#8;
                 #dsmom006#10 = #dsmom005#9;
                 #dsmom006#11 = #dsmom005#10;
                 |GRABA 020#dsmom006.b;
             |FINSI;
             #dsmom006#12 = "DEVOLVER";
             |GRABA 020#dsmom006.a;
             |LIBERA #dsmom006;
             |CIERRA #dsmom006;
         |FINSI;

         |SI #refer01@#27 = "C";  |Y #dsmom005#11 = "DEVOLVER ";
             |ABRE #dsmom006;
             #dsmom006#0  = nCodigoNue;
             #dsmom006#1  = #dsmom005#0;
             |LEE 101#dsmom006.=;
             |SI FSalida ! 0;
                 |DDEFECTO #dsmom006;
                 #dsmom006#0  = nCodigoNue;
                 #dsmom006#1  = #dsmom005#0;
                 #dsmom006#2  = #dsmom005#1;
                 #dsmom006#3  = #dsmom005#2;
                 #dsmom006#4  = #dsmom005#3;
                 #dsmom006#5  = #dsmom005#4;
                 #dsmom006#6  = #dsmom005#5;
                 #dsmom006#7  = #dsmom005#6;
                 #dsmom006#8  = #dsmom005#7;
                 #dsmom006#9  = #dsmom005#8;
                 #dsmom006#10 = #dsmom005#9;
                 #dsmom006#11 = #dsmom005#10;
                 |GRABA 020#dsmom006.b;
             |FINSI;
             #dsmom006#12 = "COMPENSAR";
             |GRABA 020#dsmom006.a;
             |LIBERA #dsmom006;
             |CIERRA #dsmom006;
        |FINSI;
     |FINSI;

     enEmpresa     = nCodigoNue;
     enEjer        = #dspase03#4;
     enPeriodo     = nPeriodo;
     enModelo      = nModelo;
     enComplem     = 0;
     enActividad   = #agicen14#1;
     enTipoEntrada = 91;
     |SUB_EJECUTA_NP ":modelos/dsmociva";

     #dspase25#0 = nModelo;
     #dspase25#1 = nPeriodo;
     #dspase25#2 = 0;
     #dspase25#3 = nCodigoNue;
     |LEE 101#dspase25.=;
     |SI FSalida ! 0;
         |DDEFECTO #dspase25;
         #dspase25#0 = nModelo;
         #dspase25#1 = nPeriodo;
         #dspase25#2 = 0;
         #dspase25#3 = nCodigoNue;
         |GRABA 020#dspase25.b;
     |FINSI;
     #dspase25#4 = #dspase25#4 + #refer00@#55;
     |GRABA 020#dspase25.a;
     |LIBERA #dspase25;

     enEmpresa = nCodigoNue;
     enEjer    = #dspase03#4;
     enPeriodo = nPeriodo;
     enModelo  = nModelo;
     enComplem = 0;

     efFechaI  = #refer00@#3;
     |SI #refer00@#3 = "          ";  efFechaI  = "01.01.0000";  |FINSI;

     eaArchiva = "";
     |SI #refer00@#4 = "S";  eaArchiva = "X";  |FINSI;

     |SUB_EJECUTA "dspasuti;PonDatosPlaning";
|FPRC;

|DEFBUCLE eosm1300;
     #refer00@#1004;
     ;
     00001, 0,    1, nAnyo;
     99999, 9, #dspase03#5, nAnyo;
     ;
     NULL, PasaModelo300;
|FIN;

|PROCESO Pase300Reo;
     aDef = eaPathAnterior + "agieos/def/eosm1300.mas";
     |CARGA_DEF aDef, refer00@;
     |SI FSalida ! 0;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agieos/def/eosactiv.mas";
     |CARGA_DEF aDef, refer01@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agieos/def/eosclien.mas";
     |CARGA_DEF aDef, refer02@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agieos/def/eosopesp.mas";
     |CARGA_DEF aDef, refer03@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer02@;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aFich = eaPathAnterior + "agieos/fich/";
     |PATH_DAT #refer00@#aFich#;
     |PATH_DAT #refer01@#aFich#;
     |PATH_DAT #refer02@#aFich#;
     |PATH_DAT #refer03@#aFich#;

     aAlfa   = #dspase03#4;
     aAlfa   = #dspase03#4 % -102;
     nAnyo   = aAlfa;

     |ABRE #refer01@;
     |ABRE #refer02@;
     |ABRE #refer03@;
     |ABRE #agicen14;
     |ABRE #dsmom002;
     |ABRE #agitab99;
     |BUCLE eosm1300;
     |CIERRA #dsmom002;
     |CIERRA #agicen14;
     |CIERRA #refer01@;
     |CIERRA #refer02@;
     |CIERRA #refer03@;
     |CIERRA #refer03@;

     |DESCARGA_DEF #refer03@;
     |DESCARGA_DEF #refer02@;
     |DESCARGA_DEF #refer01@;
     |DESCARGA_DEF #refer00@;
|FPRC;

|PROCESO PasaModelo300Conta;
     nPeriodo = 0;
     |SI #refer00@#1   = 1;  nPeriodo = 3;   |FINSI;
     |SI #refer00@#1   = 2;  nPeriodo = 6;   |FINSI;
     |SI #refer00@#1   = 3;  nPeriodo = 9;   |FINSI;
     |SI #refer00@#1   = 4;  nPeriodo = 12;  |FINSI;
     |SI nPeriodo = 0;  |ACABA;         |FINSI;

     |SI enEstaCambio = 1;
         nCodigoNue  = 0;
         nCodigoCont = #refer01@#2;
         |BUCLE dspase15_Cont300;
         |SI nCodigoNue = 0;  |ACABA;  |FINSI;
     |SINO;
         nCodigoNue = #refer01@#2;
     |FINSI;
     |SI nCodigoNue < #dspase03#9; |O nCodigoNue > #dspase03#10; |ACABA; |FINSI;

     |SI #dspase03#8 ! 1;
         #dspase99#0 = nCodigoNue;
         #dspase99#1 = 300;
         |LEE 101#dspase99.=;
         |SI FSalida ! 0;
             enDEmpresa = nCodigoNue;
             enHEmpresa = nCodigoNue;
             enModelo   = 300;
             |SUB_EJECUTA "dspasuti;BorraModelos";

             #dspase99#0 = nCodigoNue;
             #dspase99#1 = 300;
             |GRABA 020#dspase99.n;
             |LIBERA #dspase99;
         |FINSI;
     |FINSI;

     #refer02@#0  = #refer01@#2;
     #refer02@#1  = #refer00@#2;
     |LEE 040#refer02@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer02@;  |FINSI;

     |ABRE #dsmom004;
     #dsmom004#0   = nCodigoNue;
     #dsmom004#1   = #dspase03#4;
     #dsmom004#2   = nPeriodo;
     #dsmom004#3   = 300;
     #dsmom004#4   = 0;
     |LEE 040#dsmom004.=;
     |SI FSalida  = 0;  |Y #dsmom004#7 = "X";
         |CIERRA #dsmom004;
         |ACABA;
     |FINSI;
     |CIERRA #dsmom004;

     #agicen14#0 = nCodigoNue;
     #agicen14#1 = 1;
     |LEE 101#agicen14.=;
     |SI FSalida ! 0;
         |DDEFECTO #agicen14;
         #agicen14#0  = nCodigoNue;
         #agicen14#1  = 1;
         #agicen14#3  = #refer02@#32;
         #agicen14#4  = #refer02@#20;
         #agicen14#7  = 2;
         #agicen14#8  = "REGIMEN GENERAL U ORDINARIO";
         #agicen14#9  = 2;
         #agicen14#10 = "IMPUESTO DE SOCIEDADES";
         |GRABA 020#agicen14.b;
     |FINSI;

     #agicen14#6 = "01.01.0000";

     nModelo = 300;
     #agitab99#0  = 300;
     |LEE 040#agitab99.=;
     |SI FSalida ! 0;  |DDEFECTO #agitab99;  |FINSI;

     #dsmom002#0 = nCodigoNue;
     #dsmom002#1 = 1;
     #dsmom002#2 = 300;
     |LEE 101#dsmom002.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmom002;
         #dsmom002#0  = nCodigoNue;
         #dsmom002#1  = 1;
         #dsmom002#2  = 300;
         |GRABA 020#dsmom002.b;
     |FINSI;

     #dsmom002#3  = #agitab99#1;
     #dsmom002#4  = #agitab99#2;
     #dsmom002#5  = #agitab99#3;
     #dsmom002#6  = #agicen14#4;
     #dsmom002#7  = "TRIMESTRAL";
     #dsmom002#8  = #agicen14#5;
     #dsmom002#9  = #agicen14#6;
     #dsmom002#10 = 1;

     |GRABA 020#dsmom002.a;
     |LIBERA #dsmom002;

     |SI #agicen14#15 = "          ";  |O #agicen14#15 = "MODULOS   ";
          #agicen14#15 = "REGISTROS";
     |FINSI;
     |GRABA 020#agicen14.a;
     |LIBERA #agicen14;

     enEmpresaA = nCodigoNue;
     enAnyo     = #dspase03#4;
     |SUB_EJECUTA_NP ":modelos/dsmoz001";

     |ABRE #dsmom008;
     #dsmom008#0   = nCodigoNue;
     #dsmom008#1   = #dspase03#4;
     #dsmom008#2   = nPeriodo;
     #dsmom008#3   = nModelo;
     #dsmom008#4   = 0;
     #dsmom008#5   = #agicen14#1;
     |LEE 040#dsmom008.=;
     |SI FSalida ! 0;  |CIERRA #dsmom008;  |ACABA;  |FINSI;
     |CIERRA #dsmom008;

     enEmpresa     = nCodigoNue;
     enEjer        = #dspase03#4;
     enPeriodo     = nPeriodo;
     enModelo      = nModelo;
     enComplem     = 0;
     enActividad   = #agicen14#1;
     enTipoEntrada = 90;
     |SUB_EJECUTA_NP ":modelos/dsmociva";

                       nGrupo = 1;  nSubGrupo = 1;
     |SI #refer02@#73 = 1;  nGrupo = 1;  nSubGrupo = 1;  |FINSI;
     |SI #refer02@#73 = 2;  nGrupo = 1;  nSubGrupo = 2;  |FINSI;
     |SI #refer02@#73 = 3;  nGrupo = 1;  nSubGrupo = 2;  |FINSI;
     |SI #refer02@#73 = 4;  nGrupo = 1;  nSubGrupo = 3;  |FINSI;
     |SI #refer02@#73 = 5;  nGrupo = 1;  nSubGrupo = 4;  |FINSI;

     |ABRE #dsmociva;

     nValor1  = #refer00@#5;   nValor2  = #refer00@#6;   nValor3  = #refer00@#7;
     nValor4  = #refer00@#8;   nValor5  = #refer00@#9;   nValor6  = #refer00@#10;
     nValor7  = #refer00@#11;  nValor8  = #refer00@#12;  nValor9  = #refer00@#13;
     nValor10 = 0;        nValor11 = 0;        nValor12 = 0;

     |HAZ GrabaApartado;         || Ventas

     nGrupo    = 1;
     nSubGrupo = 10;
     nValor1   = #refer00@#14;  nValor2  = #refer00@#15;  nValor3  = #refer00@#16;
     nValor4   = #refer00@#17;  nValor5  = #refer00@#18;  nValor6  = #refer00@#19;
     nValor7   = #refer00@#46;  nValor8  = #refer00@#47;  nValor9  = #refer00@#48;
     nValor10  = 0;        nValor11 = 0;        nValor12 = 0;

     |HAZ GrabaApartado;         || Recargo de Equivalencia

     nGrupo    = 1;
     nSubGrupo = 5;
     nValor1   = #refer00@#49;   nValor2  = 0;         nValor3  = #refer00@#50;
     nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
     nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
     nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

     |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias

     |SI #refer00@#21 ! 0;
         nGrupo    = 2;
         nSubGrupo = 1;
         nValor1   = 0;         nValor2  = 0;         nValor3  = #refer00@#21;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;
     |FINSI;

     |SI #refer00@#22 ! 0;
         nGrupo    = 2;
         nSubGrupo = 3;
         nValor1   = 0;         nValor2  = 0;         nValor3  = #refer00@#22;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;
     |FINSI;

     |SI #refer00@#51 ! 0;
         nGrupo    = 2;
         nSubGrupo = 5;
         nValor1   = 0;         nValor2  = 0;         nValor3  = #refer00@#51;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;
     |FINSI;

     |SI #refer00@#23 ! 0;
         nGrupo    = 2;
         nSubGrupo = 7;
         nValor1   = 0;         nValor2  = 0;         nValor3  = #refer00@#23;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;
     |FINSI;

     |SI #refer00@#24 ! 0;
         nGrupo    = 2;
         nSubGrupo = 9;
         nValor1   = 0;         nValor2  = 0;         nValor3  = #refer00@#24;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;
     |FINSI;

     |SI #refer00@#43 ! 0;
         nGrupo    = 2;
         nSubGrupo = 2;
         nValor1   = 0;         nValor2  = 0;         nValor3  = #refer00@#43;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;
     |FINSI;

     |SI #refer00@#44 ! 0;
         nGrupo    = 2;
         nSubGrupo = 4;
         nValor1   = 0;         nValor2  = 0;         nValor3  = #refer00@#44;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;
     |FINSI;

     |SI #refer00@#58 ! 0;
         nGrupo    = 2;
         nSubGrupo = 6;
         nValor1   = 0;         nValor2  = 0;         nValor3  = #refer00@#58;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;
     |FINSI;

     nGrupo    = 5;
     nSubGrupo = 1;
     nValor0   = #refer00@#27;
     |HAZ GrabaApartado;         || Atribuible al Estado

     nGrupo    = 3;
     nSubGrupo = 9;
     nValor0   = #refer00@#54;
     |HAZ GrabaApartado;         || Entregas Intracomunitarias

     nGrupo    = 5;
     nSubGrupo = 6;
     nValor0   = #refer00@#29;
     |HAZ GrabaApartado;         || Compensacion

     nGrupo    = 3;
     nSubGrupo = 2;
     nValor0   = #refer00@#34;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 3;
     nValor0   = #refer00@#38;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 8;
     nValor0   = #refer00@#39;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 10;
     nValor0   = #refer00@#36;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 12;
     nValor0   = #refer00@#37;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 13;
     nValor0   = #refer00@#40;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 14;
     nValor0   = #refer00@#41;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 1;
     nValor0   = #refer00@#52;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 5;
     nValor0   = #refer00@#53;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 6;
     nValor0   = #refer00@#59;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 7;
     nValor0   = #refer00@#56;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 8;
     nValor0   = #refer00@#57;
     |HAZ GrabaApartado;

     |HAZ Totales;

     |CIERRA #dsmociva;

     |SI nPeriodo = 12;
         |ABRE #dsmom005;
         #dsmom005#0 = nModelo;
         |LEE 040#dsmom005.=;
         |SI FSalida ! 0;  |DDEFECTO #dsmom005;  |FINSI;
         |CIERRA #dsmom005;

         |SI #refer02@#71 = "D";  |Y #dsmom005#11 = "COMPENSAR";
             |ABRE #dsmom006;
             #dsmom006#0  = nCodigoNue;
             #dsmom006#1  = #dsmom005#0;
             |LEE 101#dsmom006.=;
             |SI FSalida ! 0;
                 |DDEFECTO #dsmom006;
                 #dsmom006#0  = nCodigoNue;
                 #dsmom006#1  = #dsmom005#0;
                 #dsmom006#2  = #dsmom005#1;
                 #dsmom006#3  = #dsmom005#2;
                 #dsmom006#4  = #dsmom005#3;
                 #dsmom006#5  = #dsmom005#4;
                 #dsmom006#6  = #dsmom005#5;
                 #dsmom006#7  = #dsmom005#6;
                 #dsmom006#8  = #dsmom005#7;
                 #dsmom006#9  = #dsmom005#8;
                 #dsmom006#10 = #dsmom005#9;
                 #dsmom006#11 = #dsmom005#10;
                 |GRABA 020#dsmom006.b;
             |FINSI;
             #dsmom006#12 = "DEVOLVER";
             |GRABA 020#dsmom006.a;
             |LIBERA #dsmom006;
             |CIERRA #dsmom006;
         |FINSI;

         |SI #refer02@#71 = "C";  |Y #dsmom005#11 = "DEVOLVER ";
             |ABRE #dsmom006;
             #dsmom006#0  = nCodigoNue;
             #dsmom006#1  = #dsmom005#0;
             |LEE 101#dsmom006.=;
             |SI FSalida ! 0;
                 |DDEFECTO #dsmom006;
                 #dsmom006#0  = nCodigoNue;
                 #dsmom006#1  = #dsmom005#0;
                 #dsmom006#2  = #dsmom005#1;
                 #dsmom006#3  = #dsmom005#2;
                 #dsmom006#4  = #dsmom005#3;
                 #dsmom006#5  = #dsmom005#4;
                 #dsmom006#6  = #dsmom005#5;
                 #dsmom006#7  = #dsmom005#6;
                 #dsmom006#8  = #dsmom005#7;
                 #dsmom006#9  = #dsmom005#8;
                 #dsmom006#10 = #dsmom005#9;
                 #dsmom006#11 = #dsmom005#10;
                 |GRABA 020#dsmom006.b;
             |FINSI;
             #dsmom006#12 = "COMPENSAR";
             |GRABA 020#dsmom006.a;
             |LIBERA #dsmom006;
             |CIERRA #dsmom006;
        |FINSI;
     |FINSI;

     enEmpresa     = nCodigoNue;
     enEjer        = #dspase03#4;
     enPeriodo     = nPeriodo;
     enModelo      = nModelo;
     enComplem     = 0;
     enActividad   = #agicen14#1;
     enTipoEntrada = 91;
     |SUB_EJECUTA_NP ":modelos/dsmociva";

     #dspase25#0 = nModelo;
     #dspase25#1 = nPeriodo;
     #dspase25#2 = 0;
     #dspase25#3 = nCodigoNue;
     |LEE 101#dspase25.=;
     |SI FSalida ! 0;
         |DDEFECTO #dspase25;
         #dspase25#0 = nModelo;
         #dspase25#1 = nPeriodo;
         #dspase25#2 = 0;
         #dspase25#3 = nCodigoNue;
         |GRABA 020#dspase25.b;
     |FINSI;
     #dspase25#4 = #refer00@#28 - #refer00@#29 - #refer00@#30;
     |GRABA 020#dspase25.a;
     |LIBERA #dspase25;

     enEmpresa = nCodigoNue;
     enEjer    = #dspase03#4;
     enPeriodo = nPeriodo;
     enModelo  = nModelo;
     enComplem = 0;

     efFechaI  = #refer00@#3;
     |SI #refer00@#3 = "          ";  efFechaI  = "01.01.0000";  |FINSI;

     eaArchiva = "";

     |SUB_EJECUTA "dspasuti;PonDatosPlaning";
|FPRC;

|DEFBUCLE caman300;
     #refer00@#1003;
     ;
     "T", 01, nAnyo;
     "T", 12, nAnyo;
     ;
     NULL, PasaModelo300Conta;
|FIN;

|PROCESO MiraEmpresa300;
     aDef = eaPathAnterior + "agicont/def/caman300.mas";
     |CARGA_DEF aDef, refer00@;
     |SI FSalida ! 0;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agicont/def/caportad.mas";
     |CARGA_DEF aDef, refer02@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer02@;
         |ACABA;
     |FINSI;

     aFich = eaPathAnterior + "agicont/fich/" + (("00000" + #refer01@#2) % -105) + #refer01@#3 + "/";
     |PATH_DAT #refer00@#aFich#;
     |PATH_DAT #refer02@#aFich#;

     aAlfa   = #dspase03#4;
     aAlfa   = #dspase03#4 % -102;
     nAnyo   = aAlfa;

     |ABRE #agicen14;
     |ABRE #dsmom002;
     |ABRE #agitab99;
     |ABRE #refer02@;
     |BUCLE caman300;
     |CIERRA #dsmom002;
     |CIERRA #agicen14;
     |CIERRA #refer02@;

     |DESCARGA_DEF #refer02@;
     |DESCARGA_DEF #refer00@;
|FPRC;

|DEFBUCLE canempre_300;
     #refer01@#1002;
     26;
     00000, 0, nAnyo;
     99999, 9, nAnyo;
     ;
     NULL, MiraEmpresa300;
|FIN;

|PROCESO Pase300Conta;
     aDef = eaPathAnterior + "agicont/def/canempre.mas";
     |CARGA_DEF aDef, refer01@;
     |SI FSalida ! 0;
         |ACABA;
     |FINSI;

     aFich = eaPathAnterior + "agicont/fich/";
     |PATH_DAT #refer01@#aFich#;

     aAlfa   = #dspase03#4;
     aAlfa   = #dspase03#4 % -102;
     nAnyo   = aAlfa;

     |BUCLE canempre_300;

     |DESCARGA_DEF #refer01@;
|FPRC;

|PROCESO Pase300;
     enModelo   = 300;
     enDEmpresa = #dspase03#9;
     enHEmpresa = #dspase03#10;

     |SI #dspase03#8 = 1;
         |SUB_EJECUTA "dspasuti;BorraModelos";
     |FINSI;


     |SI #dspase03#8 = 1;  |O #dspase03#8 = 3;
         |HAZ Pase300Conta;
     |FINSI;

     |SI #dspase03#8 = 1;  |O #dspase03#8 = 2;
         |HAZ Pase300Reo;
     |FINSI;
|FPRC;

|| *************************************************************************
|| *************************************************************************
|| *************************************************************************
||               M O D E L O   3 4 0
|| *************************************************************************
|| *************************************************************************
|| *************************************************************************

|PROCESO dsmo3402;
     #dsmo3402#0 = #dsmo3401#0;
     #dsmo3402#1 = #dsmo3401#1;
     #dsmo3402#2 = #dsmo3401#2;
     #dsmo3402#3 = #dsmo3401#3;
     #dsmo3402#4 = #dsmo3401#4;
     #dsmo3402#5 = #dsmo3401#5;

     |PARA nCampo = 6;  |SI nCampo [ 29;  |HACIENDO nCampo = nCampo + 1;
           #dsmo3402#nCampo# = #refer05@#nCampo#;
     |SIGUE;

     |GRABA 020#dsmo3402.n;
     |LIBERA #dsmo3402;
|FPRC;

|DEFBUCLE dsmo3402;
     #refer05@#1007;
     ;
     nCod340_1, nCod340_2, nCod340_3, 340, 0, 1, 000000;
     nCod340_1, nCod340_2, nCod340_3, 340, 0, 1, 999999;
     ;
     NULL, dsmo3402;
|FIN;

|PROCESO dsmo3403;
     #dsmo3403#0 = #dsmo3401#0;
     #dsmo3403#1 = #dsmo3401#1;
     #dsmo3403#2 = #dsmo3401#2;
     #dsmo3403#3 = #dsmo3401#3;
     #dsmo3403#4 = #dsmo3401#4;
     #dsmo3403#5 = #dsmo3401#5;

     |PARA nCampo = 6;  |SI nCampo [ 27;  |HACIENDO nCampo = nCampo + 1;
           #dsmo3403#nCampo# = #refer06@#nCampo#;
     |SIGUE;

     |GRABA 020#dsmo3403.n;
     |LIBERA #dsmo3403;
|FPRC;

|DEFBUCLE dsmo3403;
     #refer06@#1007;
     ;
     nCod340_1, nCod340_2, nCod340_3, 340, 0, 1, 000000;
     nCod340_1, nCod340_2, nCod340_3, 340, 0, 1, 999999;
     ;
     NULL, dsmo3403;
|FIN;

|PROCESO dsmo3404;
     #dsmo3404#0 = #dsmo3401#0;
     #dsmo3404#1 = #dsmo3401#1;
     #dsmo3404#2 = #dsmo3401#2;
     #dsmo3404#3 = #dsmo3401#3;
     #dsmo3404#4 = #dsmo3401#4;
     #dsmo3404#5 = #dsmo3401#5;

     |PARA nCampo = 6;  |SI nCampo [ 28;  |HACIENDO nCampo = nCampo + 1;
           #dsmo3404#nCampo# = #refer07@#nCampo#;
     |SIGUE;

     |GRABA 020#dsmo3404.n;
     |LIBERA #dsmo3404;
|FPRC;

|DEFBUCLE dsmo3404;
     #refer07@#1007;
     ;
     nCod340_1, nCod340_2, nCod340_3, 340, 0, 1, 000000;
     nCod340_1, nCod340_2, nCod340_3, 340, 0, 1, 999999;
     ;
     NULL, dsmo3404;
|FIN;

|PROCESO dsmo3405;
     #dsmo3405#0 = #dsmo3401#0;
     #dsmo3405#1 = #dsmo3401#1;
     #dsmo3405#2 = #dsmo3401#2;
     #dsmo3405#3 = #dsmo3401#3;
     #dsmo3405#4 = #dsmo3401#4;
     #dsmo3405#5 = #dsmo3401#5;

     |PARA nCampo = 6;  |SI nCampo [ 29;  |HACIENDO nCampo = nCampo + 1;
           #dsmo3405#nCampo# = #refer08@#nCampo#;
     |SIGUE;

     |GRABA 020#dsmo3405.n;
     |LIBERA #dsmo3405;
|FPRC;

|DEFBUCLE dsmo3405;
     #refer08@#1007;
     ;
     nCod340_1, nCod340_2, nCod340_3, 340, 0, 1, 000000;
     nCod340_1, nCod340_2, nCod340_3, 340, 0, 1, 999999;
     ;
     NULL, dsmo3405;
|FIN;

|PROCESO Pasa340;
     aDef = eaPathAnterior + "agieos/def/dsmo3402.mas";
     |CARGA_DEF aDef, refer05@;

     aDef = eaPathAnterior + "agieos/def/dsmo3403.mas";
     |CARGA_DEF aDef, refer06@;

     aDef = eaPathAnterior + "agieos/def/dsmo3404.mas";
     |CARGA_DEF aDef, refer07@;

     aDef = eaPathAnterior + "agieos/def/dsmo3405.mas";
     |CARGA_DEF aDef, refer08@;

     |PATH_DAT #refer05@#aFich#;
     |PATH_DAT #refer06@#aFich#;
     |PATH_DAT #refer07@#aFich#;
     |PATH_DAT #refer08@#aFich#;

     #agitab99#0 = 340;
     |LEE 040#agitab99.=;
     |SI FSalida ! 0;  |DDEFECTO #agitab99;  |FINSI;

     #dsmom002#0 = nCodigoNue;
     #dsmom002#1 = #agicen14#1;
     #dsmom002#2 = 340;
     |LEE 101#dsmom002.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmom002;
         #dsmom002#0  = nCodigoNue;
         #dsmom002#1  = #agicen14#1;
         #dsmom002#2  = 340;
         |GRABA 020#dsmom002.b;
     |FINSI;

     #dsmom002#3  = #agitab99#1;
     #dsmom002#4  = #agitab99#2;
     #dsmom002#5  = #agitab99#3;
     #dsmom002#6  = #agicen14#4;
     #dsmom002#7  = aPeriodo;
     #dsmom002#8  = #agicen14#5;
     #dsmom002#9  = #agicen14#6;
     #dsmom002#10 = 1;

     |GRABA 020#dsmom002.a;
     |LIBERA #dsmom002;

     enEmpresaA = nCodigoNue;
     enAnyo     = #dspase03#4;
     |SUB_EJECUTA_NP ":modelos/dsmoz001";

     |ABRE #dsmom008;
     #dsmom008#0   = nCodigoNue;
     #dsmom008#1   = #dspase03#4;
     #dsmom008#2   = nPeriodo;
     #dsmom008#3   = 340;
     #dsmom008#4   = 0;
     #dsmom008#5   = #agicen14#1;
     |LEE 040#dsmom008.=;
     |SI FSalida ! 0;  |CIERRA #dsmom008;  |ACABA;  |FINSI;
     |CIERRA #dsmom008;

     enEmpresa     = nCodigoNue;
     enEjer        = #dspase03#4;
     enPeriodo     = nPeriodo;
     enModelo      = 340;
     enComplem     = 0;
     enActividad   = #agicen14#1;
     enTipoEntrada = 3;
     |SUB_EJECUTA_NP ":modelos/dsmo3401";

     |ABRE #dsmo3401;
     #dsmo3401#0 = nCodigoNue;
     #dsmo3401#1 = #dspase03#4;
     #dsmo3401#2 = nPeriodo;
     #dsmo3401#3 = 340;
     #dsmo3401#4 = 0;
     #dsmo3401#5 = #agicen14#1;
     #dsmo3401#6 = #refer04@#6;
     #dsmo3401#7 = #refer04@#7;
     #dsmo3401#8 = #refer04@#8;
     #dsmo3401#9 = #refer04@#9;
     |GRABA 020#dsmo3401.n;
     |LIBERA #dsmo3401;
     |CIERRA #dsmo3401;

     |ABRE #dsmo3402;  |BUCLE dsmo3402;  |CIERRA #dsmo3402;
     |ABRE #dsmo3403;  |BUCLE dsmo3403;  |CIERRA #dsmo3403;
     |ABRE #dsmo3404;  |BUCLE dsmo3404;  |CIERRA #dsmo3404;
     |ABRE #dsmo3405;  |BUCLE dsmo3405;  |CIERRA #dsmo3405;

     |DESCARGA_DEF #refer08@;
     |DESCARGA_DEF #refer07@;
     |DESCARGA_DEF #refer06@;
     |DESCARGA_DEF #refer05@;

     enEmpresa     = nCodigoNue;
     enEjer        = #dspase03#4;
     enPeriodo     = nPeriodo;
     enModelo      = 340;
     enComplem     = 0;
     enActividad   = #agicen14#1;
     enTipoEntrada = 98;
     |SUB_EJECUTA_NP ":modelos/dsmo3401";

     efFechaI  = #refer00@#3;
     |SI #refer00@#3 = "          ";  efFechaI  = "01.01.0000";  |FINSI;

     eaArchiva = "";
     |SI #refer00@#4 = "S";  eaArchiva = "X";  |FINSI;

     |SUB_EJECUTA "dspasuti;PonDatosPlaning";
|FPRC;

|| *************************************************************************
|| *************************************************************************
|| *************************************************************************
||               M O D E L O   3 0 3
|| *************************************************************************
|| *************************************************************************
|| *************************************************************************
|PROCESO DesgloseReo;
      |ABRE #refer09@;
      #refer09@#0 = "303";
      #refer09@#1 = #refer00@#0;
      #refer09@#2 = #refer00@#45;
      #refer09@#3 = #refer00@#1;
      #refer09@#4 = #refer00@#2;
      #refer09@#5 = nCampo1;
      |LEE 041#refer09@.=;
      |SI FSalida = 0;
          nValor1   = #refer09@#6;    nValor2  = #refer09@#7;    nValor3  = #refer09@#8;
          nValor4   = #refer09@#9;    nValor5  = #refer09@#10;   nValor6  = #refer09@#11;
          nValor7   = #refer09@#12;   nValor8  = #refer09@#13;   nValor9  = #refer09@#14;
          nValor10  = #refer09@#15;   nValor11 = #refer09@#16;   nValor12 = #refer09@#17;
          nValor13  = #refer09@#18;   nValor14 = #refer09@#19;   nValor15 = #refer09@#20;
          nValor16  = #refer09@#21;   nValor17 = #refer09@#22;   nValor18 = #refer09@#23;
      |FINSI;
      |CIERRA #refer09@;
|FPRC;

|PROCESO PasaModelo303;
     |SI enEstaCambio = 1;
         nCodigoNue = 0;
         nCodigoReo = #refer00@#0;
         |BUCLE dspase15_300;
         |SI nCodigoNue = 0;  |ACABA;  |FINSI;
     |SINO;
         nCodigoNue = #refer00@#0;
     |FINSI;
     |SI nCodigoNue < #dspase03#9; |O nCodigoNue > #dspase03#10; |ACABA; |FINSI;

     |SI #dspase03#8 ! 1;
         #dspase99#0 = nCodigoNue;
         #dspase99#1 = 303;
         |LEE 101#dspase99.=;
         |SI FSalida ! 0;
             enDEmpresa = nCodigoNue;
             enHEmpresa = nCodigoNue;
             enModelo   = 303;
             |SUB_EJECUTA "dspasuti;BorraModelos";

             #dspase99#0 = nCodigoNue;
             #dspase99#1 = 303;
             |GRABA 020#dspase99.n;
             |LIBERA #dspase99;
         |FINSI;
     |FINSI;

     #refer02@#0 = nCodigoReo;
     |LEE 040#refer02@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer02@;  |FINSI;

     #agicen14#0 = nCodigoNue;
     #agicen14#1 = #refer00@#45;
     |LEE 101#agicen14.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     #agicen14#6 = "01.01.0000";

     #refer01@#0 = #refer00@#0;
     #refer01@#1 = #refer00@#45;
     #refer01@#2 = #refer00@#2;
     |LEE 040#refer01@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer01@;  |FINSI;

     nModelo = 303;
     |SI #refer02@#60 = "S";
         nModelo = 370;
     |FINSI;

     #agitab99#0 = 303;
     |LEE 040#agitab99.=;
     |SI FSalida ! 0;  |DDEFECTO #agitab99;  |FINSI;

     #dsmom002#0 = nCodigoNue;
     #dsmom002#1 = #refer00@#45;
     #dsmom002#2 = 303;
     |LEE 101#dsmom002.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmom002;
         #dsmom002#0  = nCodigoNue;
         #dsmom002#1  = #refer00@#45;
         #dsmom002#2  = 303;
         |GRABA 020#dsmom002.b;
     |FINSI;

     aPeriodo = "TRIMESTRAL";
     |SI #refer00@#1 = 1;  nPeriodo = 3;   |FINSI;
     |SI #refer00@#1 = 2;  nPeriodo = 6;   |FINSI;
     |SI #refer00@#1 = 3;  nPeriodo = 9;   |FINSI;
     |SI #refer00@#1 = 4;  nPeriodo = 12;  |FINSI;

     |SI nModelo = 303;
         |SI #refer01@#26 = "D";  |O #refer01@#26 = "M";
             aPeriodo = "MENSUAL";
             nPeriodo = #refer00@#1;
         |FINSI;
     |FINSI;

     #dsmom002#3  = #agitab99#1;
     #dsmom002#4  = #agitab99#2;
     #dsmom002#5  = #agitab99#3;
     #dsmom002#6  = #agicen14#4;
     #dsmom002#7  = aPeriodo;
     #dsmom002#8  = #agicen14#5;
     #dsmom002#9  = #agicen14#6;
     #dsmom002#10 = 1;

     |GRABA 020#dsmom002.a;
     |LIBERA #dsmom002;

     |SI #agicen14#15 = "          ";  |O #agicen14#15 = "MODULOS   ";
          #agicen14#15 = "MANUAL";
     |FINSI;

     |SI #refer01@#26 = "D"; |O #refer01@#26 = "M";
         #agicen14#7 = 11;
         #agicen14#8 = "INSCRITO REGISTRO DEVOLUCION MENSUAL";
     |FINSI;

     |GRABA 020#agicen14.a;
     |LIBERA #agicen14;

                         enSwEstar = 0;
     |SI nModelo = 370;  enSwEstar = 1;  |FINSI;

     enEmpresaA = nCodigoNue;
     enAnyo     = #dspase03#4;
     |SUB_EJECUTA_NP ":modelos/dsmoz001";

     |ABRE #dsmom008;
     #dsmom008#0   = nCodigoNue;
     #dsmom008#1   = #dspase03#4;
     #dsmom008#2   = nPeriodo;
     #dsmom008#3   = nModelo;
     #dsmom008#4   = 0;
     #dsmom008#5   = #agicen14#1;
     |LEE 040#dsmom008.=;
     |SI FSalida ! 0;  |CIERRA #dsmom008;  |ACABA;  |FINSI;
     |CIERRA #dsmom008;

     #refer03@#0  = #refer00@#0;
     #refer03@#1  = #refer00@#45;
     #refer03@#2  = #refer00@#1;
     #refer03@#3  = #refer00@#2;
     |LEE 040#refer03@.=;

     |SI #refer01@#4 ! "E";  |Y #refer01@#4 ! "P";
      |Y #refer01@#4 ! "A";  |Y #refer01@#4 ! " ";
         #refer01@#4 = "O";
         #refer01@#5 = "9999";
     |FINSI;

     enEmpresa     = nCodigoNue;
     enEjer        = #dspase03#4;
     enPeriodo     = nPeriodo;
     enModelo      = nModelo;
     enComplem     = 0;
     enActividad   = #agicen14#1;
     enTipoEntrada = 90;
     |SUB_EJECUTA_NP ":modelos/dsmociva";

                       nGrupo = 1;  nSubGrupo = 1;
     |SI #refer01@#29 = 1;  nGrupo = 1;  nSubGrupo = 1;  |FINSI;
     |SI #refer01@#29 = 2;  nGrupo = 1;  nSubGrupo = 2;  |FINSI;
     |SI #refer01@#29 = 3;  nGrupo = 1;  nSubGrupo = 2;  |FINSI;
     |SI #refer01@#29 = 4;  nGrupo = 1;  nSubGrupo = 3;  |FINSI;
     |SI #refer01@#29 = 5;  nGrupo = 1;  nSubGrupo = 4;  |FINSI;

     |ABRE #dsmociva;

     nNumValor = 0;
     |SI aDef09 ! "";
         nValor1_R  = 0;   nValor2_R  = 0;   nValor3_R  = 0;
         nValor4_R  = 0;   nValor5_R  = 0;   nValor6_R  = 0;
         nValor7_R  = 0;   nValor8_R  = 0;   nValor9_R  = 0;
         nValor10_R = 0;   nValor11_R = 0;   nValor12_R = 0;
         nValor13_R = 0;   nValor14_R = 0;   nValor15_R = 0;
         nValor16_R = 0;   nValor17_R = 0;   nValor18_R = 0;
         nValor19_R = 0;   nValor20_R = 0;   nValor21_R = 0;

         |PARA nCampo1 = 5; |SI nCampo1 [ 11; |HACIENDO nCampo1 = nCampo1 + 3;
               nValor1  = 0;   nValor2  = 0;   nValor3  = 0;
               nValor4  = 0;   nValor5  = 0;   nValor6  = 0;
               nValor7  = 0;   nValor8  = 0;   nValor9  = 0;
               nValor10 = 0;   nValor11 = 0;   nValor12 = 0;
               nValor13 = 0;   nValor14 = 0;   nValor15 = 0;
               nValor16 = 0;   nValor17 = 0;   nValor18 = 0;
               nValor19 = 0;   nValor20 = 0;   nValor21 = 0;

               nCampo2 = nCampo1 + 2; |HAZ DesgloseReo;
               |SI nValor1 ! 0; |O nValor3 ! 0;
                   nNume1 = nValor1;  nNume2 = nValor2; nNume3 = nValor3;  |HAZ SumaValor;
               |FINSI;
               |SI nValor4 ! 0; |O nValor6 ! 0;
                   nNume1 = nValor4;  nNume2 = nValor5; nNume3 = nValor6;  |HAZ SumaValor;
               |FINSI;
               |SI nValor7 ! 0; |O nValor9 ! 0;
                   nNume1 = nValor7;  nNume2 = nValor8; nNume3 = nValor9;  |HAZ SumaValor;
               |FINSI;
               |SI nValor10 ! 0; |O nValor12 ! 0;
                   nNume1 = nValor10;  nNume2 = nValor11; nNume3 = nValor12;  |HAZ SumaValor;
               |FINSI;
               |SI nValor13 ! 0; |O nValor15 ! 0;
                   nNume1 = nValor13;  nNume2 = nValor14; nNume3 = nValor15;  |HAZ SumaValor;
               |FINSI;
               |SI nValor16 ! 0; |O nValor18 ! 0;
                   nNume1 = nValor16;  nNume2 = nValor17; nNume3 = nValor18;  |HAZ SumaValor;
               |FINSI;
         |SIGUE;
         |SI nNumValor ! 0; |Y nNumValor < 22;
             nValor1 = nValor1_R; nValor2 = nValor2_R;
             nValor3 = nValor3_R; nValor4 = nValor4_R;
             nValor5 = nValor5_R; nValor6 = nValor6_R;
             nValor7 = nValor7_R; nValor8 = nValor8_R;
             nValor9 = nValor9_R; nValor10 = nValor10_R;
             nValor11 = nValor11_R; nValor12 = nValor12_R;
             nValor13 = nValor13_R; nValor14 = nValor14_R;
             nValor15 = nValor15_R; nValor16 = nValor16_R;
             nValor17 = nValor17_R; nValor18 = nValor18_R;
             nValor19 = nValor19_R; nValor20 = nValor20_R;
             nValor21 = nValor21_R;
         |SINO;
             nNumValor = 0;
         |FINSI;
     |FINSI;

     |SI nNumValor = 0;
         nValor1  = #refer00@#5;   nValor2  = #refer00@#6;   nValor3  = #refer00@#7;
         nValor4  = #refer00@#8;   nValor5  = #refer00@#9;   nValor6  = #refer00@#10;
         nValor7  = #refer00@#11;  nValor8  = #refer00@#12;  nValor9  = #refer00@#13;
         nValor10 = 0;        nValor11 = 0;        nValor12 = 0;
         nValor13 = 0;        nValor14 = 0;        nValor15 = 0;
         nValor16 = 0;        nValor17 = 0;        nValor18 = 0;
         nValor19 = 0;        nValor20 = 0;        nValor21 = 0;
     |FINSI;

     |HAZ GrabaApartado;         || Ventas

     nGrupo    = 1;
     nSubGrupo = 10;
     nValor1   = #refer00@#14;  nValor2  = #refer00@#15;  nValor3  = #refer00@#16;
     nValor4   = #refer00@#17;  nValor5  = #refer00@#18;  nValor6  = #refer00@#19;
     nValor7   = #refer00@#46;  nValor8  = #refer00@#47;  nValor9  = #refer00@#48;
     nValor10  = 0;        nValor11 = 0;        nValor12 = 0;
     nValor13  = 0;        nValor14 = 0;        nValor15 = 0;
     nValor16  = 0;        nValor17 = 0;        nValor18 = 0;
     nValor19  = 0;        nValor20 = 0;        nValor21 = 0;

     |HAZ GrabaApartado;         || Recargo de Equivalencia

     nGrupo    = 1;
     nSubGrupo = 5;
     nValor1   = #refer00@#58;   nValor2  = #refer00@#59;   nValor3  = #refer00@#60;
     nValor4   = #refer00@#61;   nValor5  = #refer00@#62;   nValor6  = #refer00@#63;
     nValor7   = #refer00@#64;   nValor8  = #refer00@#65;   nValor9  = #refer00@#66;
     nValor10  = #refer00@#67;   nValor11 = #refer00@#68;   nValor12 = #refer00@#69;
     nValor13  = 0;         nValor14 = 0;         nValor15 = 0;
     nValor16  = 0;         nValor17 = 0;         nValor18 = 0;
     nValor19  = 0;         nValor20 = 0;         nValor21 = 0;

     |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias

     |SI #refer00@#21 ! 0;
         nGrupo    = 2;
         nSubGrupo = 1;
         nValor1   = #refer00@#70;   nValor2  = 0;         nValor3  = #refer00@#21;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;
         nValor13  = 0;         nValor14 = 0;         nValor15 = 0;
         nValor16  = 0;         nValor17 = 0;         nValor18 = 0;
         nValor19  = 0;         nValor20 = 0;         nValor21 = 0;

         |SI aDef09 ! ""; nCampo1 = 70; nCampo2 = 21; |HAZ DesgloseReo; |FINSI;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#22 ! 0;
         nGrupo    = 2;
         nSubGrupo = 3;
         nValor1   = #refer00@#71;   nValor2  = 0;         nValor3  = #refer00@#22;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;
         nValor13  = 0;         nValor14 = 0;         nValor15 = 0;
         nValor16  = 0;         nValor17 = 0;         nValor18 = 0;
         nValor19  = 0;         nValor20 = 0;         nValor21 = 0;

         |SI aDef09 ! ""; nCampo1 = 71; nCampo2 = 22; |HAZ DesgloseReo; |FINSI;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#51 ! 0;
         nGrupo    = 2;
         nSubGrupo = 5;
         nValor1   = #refer00@#72;   nValor2  = 0;         nValor3  = #refer00@#51;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;
         nValor13  = 0;         nValor14 = 0;         nValor15 = 0;
         nValor16  = 0;         nValor17 = 0;         nValor18 = 0;
         nValor19  = 0;         nValor20 = 0;         nValor21 = 0;

         |SI aDef09 ! ""; nCampo1 = 72; nCampo2 = 51; |HAZ DesgloseReo; |FINSI;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#23 ! 0;
         nGrupo    = 2;
         nSubGrupo = 7;
         nValor1   = #refer00@#73;   nValor2  = 0;         nValor3  = #refer00@#23;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;
         nValor13  = 0;         nValor14 = 0;         nValor15 = 0;
         nValor16  = 0;         nValor17 = 0;         nValor18 = 0;
         nValor19  = 0;         nValor20 = 0;         nValor21 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#24 ! 0;
         nGrupo    = 2;
         nSubGrupo = 9;
         nValor1   = #refer00@#74;   nValor2  = 0;         nValor3  = #refer00@#24;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;
         nValor13  = 0;         nValor14 = 0;         nValor15 = 0;
         nValor16  = 0;         nValor17 = 0;         nValor18 = 0;
         nValor19  = 0;         nValor20 = 0;         nValor21 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#43 ! 0;
         nGrupo    = 2;
         nSubGrupo = 2;
         nValor1   = #refer00@#75;   nValor2  = 0;         nValor3  = #refer00@#43;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;
         nValor13  = 0;         nValor14 = 0;         nValor15 = 0;
         nValor16  = 0;         nValor17 = 0;         nValor18 = 0;
         nValor19  = 0;         nValor20 = 0;         nValor21 = 0;

         |SI aDef09 ! ""; nCampo1 = 75; nCampo2 = 43; |HAZ DesgloseReo; |FINSI;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#44 ! 0;
         nGrupo    = 2;
         nSubGrupo = 4;
         nValor1   = #refer00@#76;   nValor2  = 0;         nValor3  = #refer00@#44;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;
         nValor13  = 0;         nValor14 = 0;         nValor15 = 0;
         nValor16  = 0;         nValor17 = 0;         nValor18 = 0;
         nValor19  = 0;         nValor20 = 0;         nValor21 = 0;

         |SI aDef09 ! ""; nCampo1 = 76; nCampo2 = 44; |HAZ DesgloseReo; |FINSI;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#78 ! 0;
         nGrupo    = 2;
         nSubGrupo = 6;
         nValor1   = #refer00@#77;   nValor2  = 0;         nValor3  = #refer00@#78;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;
         nValor13  = 0;         nValor14 = 0;         nValor15 = 0;
         nValor16  = 0;         nValor17 = 0;         nValor18 = 0;
         nValor19  = 0;         nValor20 = 0;         nValor21 = 0;

         |SI aDef09 ! ""; nCampo1 = 77; nCampo2 = 78; |HAZ DesgloseReo; |FINSI;

         |HAZ GrabaApartado;         || Adquisiciones Inversion
     |FINSI;

     |SI #refer00@#80 ! 0;
         nGrupo    = 2;
         nSubGrupo = 10;
         nValor1   = #refer00@#79;   nValor2  = 0;         nValor3  = #refer00@#80;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;
         nValor13  = 0;         nValor14 = 0;         nValor15 = 0;
         nValor16  = 0;         nValor17 = 0;         nValor18 = 0;
         nValor19  = 0;         nValor20 = 0;         nValor21 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     nGrupo    = 5;
     nSubGrupo = 1;
     nValor0   = #refer00@#27;
     |HAZ GrabaApartado;         || Atribuible al Estado

     nGrupo    = 3;
     nSubGrupo = 9;
     nValor0   = #refer00@#54;
     |HAZ GrabaApartado;         || Entregas Intracomunitarias

     nGrupo    = 5;
     nSubGrupo = 6;
     nValor0   = #refer00@#29;
     |HAZ GrabaApartado;         || Compensacion

     nGrupo    = 5;
     nSubGrupo = 2;
     nValor0   = #refer00@#30;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 10;
     nValor0   = #refer00@#81;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 11;
     nValor0   = #refer00@#82;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 2;
     nValor0   = #refer03@#4;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 3;
     nValor0   = #refer03@#5;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 8;
     nValor0   = #refer03@#6;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 12;
     nValor0   = #refer03@#11;    ||aqui  #refer03@#9
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 13;
     nValor0   = #refer03@#10;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 14;
     nValor0   = #refer03@#13;  ||aqui era el 903#11
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 1;
     nValor0   = #refer03@#12;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 5;
     nValor0   = #refer03@#13;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 6;
     nValor0   = #refer03@#14;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 7;
     nValor0   = #refer03@#15;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 8;
     nValor0   = #refer03@#16;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 16;
     nValor0   = #refer03@#20;
     |HAZ GrabaApartado;

     |HAZ Totales;

     |CIERRA #dsmociva;

     |SI nPeriodo = 12;  |O aPeriodo = "MENSUAL";
         |ABRE #dsmom005;
         #dsmom005#0 = nModelo;
         |LEE 040#dsmom005.=;
         |SI FSalida ! 0;  |DDEFECTO #dsmom005;  |FINSI;
         |CIERRA #dsmom005;

         |SI #refer00@#31 ! 0;  |Y #dsmom005#11 = "COMPENSAR";
             |ABRE #dsmom006;
             #dsmom006#0  = nCodigoNue;
             #dsmom006#1  = #dsmom005#0;
             |LEE 101#dsmom006.=;
             |SI FSalida ! 0;
                 |DDEFECTO #dsmom006;
                 #dsmom006#0  = nCodigoNue;
                 #dsmom006#1  = #dsmom005#0;
                 #dsmom006#2  = #dsmom005#1;
                 #dsmom006#3  = #dsmom005#2;
                 #dsmom006#4  = #dsmom005#3;
                 #dsmom006#5  = #dsmom005#4;
                 #dsmom006#6  = #dsmom005#5;
                 #dsmom006#7  = #dsmom005#6;
                 #dsmom006#8  = #dsmom005#7;
                 #dsmom006#9  = #dsmom005#8;
                 #dsmom006#10 = #dsmom005#9;
                 #dsmom006#11 = #dsmom005#10;
                 |GRABA 020#dsmom006.b;
             |FINSI;
             #dsmom006#12 = "DEVOLVER";
             |GRABA 020#dsmom006.a;
             |LIBERA #dsmom006;
             |CIERRA #dsmom006;
         |FINSI;

         |SI #refer00@#32 ! 0;  |Y #dsmom005#11 = "DEVOLVER ";
             |ABRE #dsmom006;
             #dsmom006#0  = nCodigoNue;
             #dsmom006#1  = #dsmom005#0;
             |LEE 101#dsmom006.=;
             |SI FSalida ! 0;
                 |DDEFECTO #dsmom006;
                 #dsmom006#0  = nCodigoNue;
                 #dsmom006#1  = #dsmom005#0;
                 #dsmom006#2  = #dsmom005#1;
                 #dsmom006#3  = #dsmom005#2;
                 #dsmom006#4  = #dsmom005#3;
                 #dsmom006#5  = #dsmom005#4;
                 #dsmom006#6  = #dsmom005#5;
                 #dsmom006#7  = #dsmom005#6;
                 #dsmom006#8  = #dsmom005#7;
                 #dsmom006#9  = #dsmom005#8;
                 #dsmom006#10 = #dsmom005#9;
                 #dsmom006#11 = #dsmom005#10;
                 |GRABA 020#dsmom006.b;
             |FINSI;
             #dsmom006#12 = "COMPENSAR";
             |GRABA 020#dsmom006.a;
             |LIBERA #dsmom006;
             |CIERRA #dsmom006;
        |FINSI;
     |FINSI;

     enEmpresa     = nCodigoNue;
     enEjer        = #dspase03#4;
     enPeriodo     = nPeriodo;
     enModelo      = nModelo;
     enComplem     = 0;
     enActividad   = #agicen14#1;
     enTipoEntrada = 91;
     |SUB_EJECUTA_NP ":modelos/dsmociva";

     #dspase25#0 = nModelo;
     #dspase25#1 = nPeriodo;
     #dspase25#2 = 0;
     #dspase25#3 = nCodigoNue;
     |LEE 101#dspase25.=;
     |SI FSalida ! 0;
         |DDEFECTO #dspase25;
         #dspase25#0 = nModelo;
         #dspase25#1 = nPeriodo;
         #dspase25#2 = 0;
         #dspase25#3 = nCodigoNue;
         |GRABA 020#dspase25.b;
     |FINSI;
     #dspase25#4 = #dspase25#4 + #refer00@#55;
     |GRABA 020#dspase25.a;
     |LIBERA #dspase25;

     enEmpresa = nCodigoNue;
     enEjer    = #dspase03#4;
     enPeriodo = nPeriodo;
     enModelo  = nModelo;
     enComplem = 0;

     efFechaI  = #refer00@#3;
     |SI #refer00@#3 = "          ";  efFechaI  = "01.01.0000";  |FINSI;

     eaArchiva = "";
     |SI #refer00@#4 = "S";  eaArchiva = "X";  |FINSI;

     |SUB_EJECUTA "dspasuti;PonDatosPlaning";

     #refer04@#0 = #refer00@#0;
     #refer04@#1 = #dspase03#4;
     #refer04@#2 = #refer00@#1;
     #refer04@#3 = 340;
     #refer04@#4 = 0;
     #refer04@#5 = 1;
     |LEE 000#refer04@.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nCod340_1 = #refer00@#0;
     nCod340_2 = #dspase03#4;
     nCod340_3 = #refer00@#1;

     |HAZ Pasa340;
|FPRC;

|DEFBUCLE eosm1303;
     #refer00@#1004;
     ;
     00001, 0,    1, nAnyo;
     99999, 9, #dspase03#5, nAnyo;
     ;
     NULL, PasaModelo303;
|FIN;

|PROCESO Pase303Reo;
     aDef = eaPathAnterior + "agieos/def/eosm1303.mas";
     |CARGA_DEF aDef, refer00@;
     |SI FSalida ! 0;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agieos/def/eosactiv.mas";
     |CARGA_DEF aDef, refer01@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agieos/def/eosclien.mas";
     |CARGA_DEF aDef, refer02@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agieos/def/eosopes2.mas";
     |CARGA_DEF aDef, refer03@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer02@;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agieos/def/dsmo3401.mas";
     |CARGA_DEF aDef, refer04@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer03@;
         |DESCARGA_DEF #refer02@;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef09 = eaPathAnterior + "agieos/def/eosma100.mas";
     |CARGA_DEF aDef09, refer09@;
     |SI FSalida ! 0;
         aDef09 = "";   || no existe este fichero
     |FINSI;

     aFich = eaPathAnterior + "agieos/fich/";
     |PATH_DAT #refer00@#aFich#;
     |PATH_DAT #refer01@#aFich#;
     |PATH_DAT #refer02@#aFich#;
     |PATH_DAT #refer03@#aFich#;
     |PATH_DAT #refer04@#aFich#;
     |SI aDef09 ! ""; |PATH_DAT #refer09@#aFich#; |FINSI;

     aAlfa   = #dspase03#4;
     aAlfa   = #dspase03#4 % -102;
     nAnyo   = aAlfa;

     |ABRE #refer01@;
     |ABRE #refer02@;
     |ABRE #refer03@;
     |ABRE #refer04@;
     |ABRE #agicen14;
     |ABRE #dsmom002;
     |ABRE #agitab99;
     |BUCLE eosm1303;
     |CIERRA #dsmom002;
     |CIERRA #agicen14;
     |CIERRA #refer01@;
     |CIERRA #refer02@;
     |CIERRA #refer03@;
     |CIERRA #refer03@;
     |CIERRA #refer04@;

     |SI aDef09 ! ""; |DESCARGA_DEF #refer09@; |FINSI;
     |DESCARGA_DEF #refer04@;
     |DESCARGA_DEF #refer03@;
     |DESCARGA_DEF #refer02@;
     |DESCARGA_DEF #refer01@;
     |DESCARGA_DEF #refer00@;
|FPRC;

|PROCESO DesgloseCon;
      |ABRE #refer09@;
      #refer09@#0 = "303";
      #refer09@#1 = #refer00@#0;
      #refer09@#2 = 1;
      #refer09@#3 = #refer00@#1;
      #refer09@#4 = #refer00@#2;
      #refer09@#5 = nCampo1;
      |LEE 041#refer09@.=;
      |SI FSalida = 0;
          nValor1   = #refer09@#6;    nValor2  = #refer09@#7;    nValor3  = #refer09@#8;
          nValor4   = #refer09@#9;    nValor5  = #refer09@#10;   nValor6  = #refer09@#11;
          nValor7   = #refer09@#12;   nValor8  = #refer09@#13;   nValor9  = #refer09@#14;
          nValor10  = #refer09@#15;   nValor11 = #refer09@#16;   nValor12 = #refer09@#17;
          nValor13  = #refer09@#18;   nValor14 = #refer09@#19;   nValor15 = #refer09@#20;
          nValor16  = #refer09@#21;   nValor17 = #refer09@#22;   nValor18 = #refer09@#23;
      |FINSI;
      |CIERRA #refer09@;
|FPRC;

|PROCESO PasaModelo303Conta;
     nPeriodo = 0;
     aPeriodo = "";

     |SI #refer00@#45 = "T";
         |SI #refer00@#1   = 1;  nPeriodo = 3;   |FINSI;
         |SI #refer00@#1   = 2;  nPeriodo = 6;   |FINSI;
         |SI #refer00@#1   = 3;  nPeriodo = 9;   |FINSI;
         |SI #refer00@#1   = 4;  nPeriodo = 12;  |FINSI;
         aPeriodo = "TRIMESTRAL";
     |FINSI;

     |SI #refer00@#45 = "M";  |O #refer00@#45 = "D";
         nPeriodo = #refer00@#1;
         aPeriodo = "MENSUAL";
     |FINSI;

     |SI nPeriodo = 0;  |ACABA;         |FINSI;

     |SI enEstaCambio = 1;
         nCodigoNue  = 0;
         nCodigoCont = #refer01@#2;
         |BUCLE dspase15_Cont300;
         |SI nCodigoNue = 0;  |ACABA;  |FINSI;
     |SINO;
         nCodigoNue = #refer01@#2;
     |FINSI;
     |SI nCodigoNue < #dspase03#9; |O nCodigoNue > #dspase03#10; |ACABA; |FINSI;

     |SI #dspase03#8 ! 1;
         #dspase99#0 = nCodigoNue;
         #dspase99#1 = 303;
         |LEE 101#dspase99.=;
         |SI FSalida ! 0;
             enDEmpresa = nCodigoNue;
             enHEmpresa = nCodigoNue;
             enModelo   = 303;
             |SUB_EJECUTA "dspasuti;BorraModelos";

             #dspase99#0 = nCodigoNue;
             #dspase99#1 = 303;
             |GRABA 020#dspase99.n;
             |LIBERA #dspase99;
         |FINSI;
     |FINSI;

     #refer02@#0  = #refer01@#2;
     #refer02@#1  = #refer00@#2;
     |LEE 040#refer02@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer02@;  |FINSI;

     |ABRE #dsmom004;
     #dsmom004#0   = nCodigoNue;
     #dsmom004#1   = #dspase03#4;
     #dsmom004#2   = nPeriodo;
     #dsmom004#3   = 303;
     #dsmom004#4   = 0;
     |LEE 040#dsmom004.=;
     |SI FSalida  = 0;  |Y #dsmom004#7 = "X";
         |CIERRA #dsmom004;
         |ACABA;
     |FINSI;
     |CIERRA #dsmom004;

     #agicen14#0 = nCodigoNue;
     #agicen14#1 = 1;
     |LEE 101#agicen14.=;
     |SI FSalida ! 0;
         |DDEFECTO #agicen14;
         #agicen14#0  = nCodigoNue;
         #agicen14#1  = 1;
         #agicen14#3  = #refer02@#32;
         #agicen14#4  = #refer02@#20;
         #agicen14#7  = 2;
         #agicen14#8  = "REGIMEN GENERAL U ORDINARIO";
         #agicen14#9  = 2;
         #agicen14#10 = "IMPUESTO DE SOCIEDADES";
         |GRABA 020#agicen14.b;
     |FINSI;

     #agicen14#6 = "01.01.0000";

     nModelo = 303;
     #agitab99#0  = 303;
     |LEE 040#agitab99.=;
     |SI FSalida ! 0;  |DDEFECTO #agitab99;  |FINSI;

     #dsmom002#0 = nCodigoNue;
     #dsmom002#1 = 1;
     #dsmom002#2 = 303;
     |LEE 101#dsmom002.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmom002;
         #dsmom002#0  = nCodigoNue;
         #dsmom002#1  = 1;
         #dsmom002#2  = 303;
         |GRABA 020#dsmom002.b;
     |FINSI;

     #dsmom002#3  = #agitab99#1;
     #dsmom002#4  = #agitab99#2;
     #dsmom002#5  = #agitab99#3;
     #dsmom002#6  = #agicen14#4;
     #dsmom002#7  = aPeriodo;
     #dsmom002#8  = #agicen14#5;
     #dsmom002#9  = #agicen14#6;
     #dsmom002#10 = 1;

     |GRABA 020#dsmom002.a;
     |LIBERA #dsmom002;

     |SI #agicen14#15 = "          ";  |O #agicen14#15 = "MODULOS   ";
          #agicen14#15 = "REGISTROS";
     |FINSI;

     |SI #refer00@#45 = "D";
         #agicen14#7 = 13;
         #agicen14#8 = "INS.REGISTRO DEVOLUCION MENSUAL G.EMPR.";
     |FINSI;

     |SI #refer00@#45 = "M";
         #agicen14#7 = 12;
         #agicen14#8 = "GENERAL U ORDINARIO GRANDES EMPRESAS";
     |FINSI;

     |GRABA 020#agicen14.a;
     |LIBERA #agicen14;

     enEmpresaA = nCodigoNue;
     enAnyo     = #dspase03#4;
     |SUB_EJECUTA_NP ":modelos/dsmoz001";

     |ABRE #dsmom008;
     #dsmom008#0   = nCodigoNue;
     #dsmom008#1   = #dspase03#4;
     #dsmom008#2   = nPeriodo;
     #dsmom008#3   = nModelo;
     #dsmom008#4   = 0;
     #dsmom008#5   = #agicen14#1;
     |LEE 040#dsmom008.=;
     |SI FSalida ! 0;  |CIERRA #dsmom008;  |ACABA;  |FINSI;
     |CIERRA #dsmom008;

     enEmpresa     = nCodigoNue;
     enEjer        = #dspase03#4;
     enPeriodo     = nPeriodo;
     enModelo      = nModelo;
     enComplem     = 0;
     enActividad   = #agicen14#1;
     enTipoEntrada = 90;
     |SUB_EJECUTA_NP ":modelos/dsmociva";

                       nGrupo = 1;  nSubGrupo = 1;
     |SI #refer02@#73 = 1;  nGrupo = 1;  nSubGrupo = 1;  |FINSI;
     |SI #refer02@#73 = 2;  nGrupo = 1;  nSubGrupo = 2;  |FINSI;
     |SI #refer02@#73 = 3;  nGrupo = 1;  nSubGrupo = 2;  |FINSI;
     |SI #refer02@#73 = 4;  nGrupo = 1;  nSubGrupo = 3;  |FINSI;
     |SI #refer02@#73 = 5;  nGrupo = 1;  nSubGrupo = 4;  |FINSI;

     |ABRE #dsmociva;

     nNumValor = 0;
     |SI aDef09 ! "";
         nValor1_R  = 0;   nValor2_R  = 0;   nValor3_R  = 0;
         nValor4_R  = 0;   nValor5_R  = 0;   nValor6_R  = 0;
         nValor7_R  = 0;   nValor8_R  = 0;   nValor9_R  = 0;
         nValor10_R = 0;   nValor11_R = 0;   nValor12_R = 0;
         nValor13_R = 0;   nValor14_R = 0;   nValor15_R = 0;
         nValor16_R = 0;   nValor17_R = 0;   nValor18_R = 0;
         nValor19_R = 0;   nValor20_R = 0;   nValor21_R = 0;

         |PARA nCampo1 = 5; |SI nCampo1 [ 11; |HACIENDO nCampo1 = nCampo1 + 3;
               nValor1  = 0;   nValor2  = 0;   nValor3  = 0;
               nValor4  = 0;   nValor5  = 0;   nValor6  = 0;
               nValor7  = 0;   nValor8  = 0;   nValor9  = 0;
               nValor10 = 0;   nValor11 = 0;   nValor12 = 0;
               nValor13 = 0;   nValor14 = 0;   nValor15 = 0;
               nValor16 = 0;   nValor17 = 0;   nValor18 = 0;
               nValor19 = 0;   nValor20 = 0;   nValor21 = 0;

               nCampo2 = nCampo1 + 2; |HAZ DesgloseCon;
               |SI nValor1 ! 0; |O nValor3 ! 0;
                   nNume1 = nValor1;  nNume2 = nValor2; nNume3 = nValor3;  |HAZ SumaValor;
               |FINSI;
               |SI nValor4 ! 0; |O nValor6 ! 0;
                   nNume1 = nValor4;  nNume2 = nValor5; nNume3 = nValor6;  |HAZ SumaValor;
               |FINSI;
               |SI nValor7 ! 0; |O nValor9 ! 0;
                   nNume1 = nValor7;  nNume2 = nValor8; nNume3 = nValor9;  |HAZ SumaValor;
               |FINSI;
               |SI nValor10 ! 0; |O nValor12 ! 0;
                   nNume1 = nValor10;  nNume2 = nValor11; nNume3 = nValor12;  |HAZ SumaValor;
               |FINSI;
               |SI nValor13 ! 0; |O nValor15 ! 0;
                   nNume1 = nValor13;  nNume2 = nValor14; nNume3 = nValor15;  |HAZ SumaValor;
               |FINSI;
               |SI nValor16 ! 0; |O nValor18 ! 0;
                   nNume1 = nValor16;  nNume2 = nValor17; nNume3 = nValor18;  |HAZ SumaValor;
               |FINSI;
         |SIGUE;
         |SI nNumValor ! 0; |Y nNumValor < 22;
             nValor1 = nValor1_R; nValor2 = nValor2_R;
             nValor3 = nValor3_R; nValor4 = nValor4_R;
             nValor5 = nValor5_R; nValor6 = nValor6_R;
             nValor7 = nValor7_R; nValor8 = nValor8_R;
             nValor9 = nValor9_R; nValor10 = nValor10_R;
             nValor11 = nValor11_R; nValor12 = nValor12_R;
             nValor13 = nValor13_R; nValor14 = nValor14_R;
             nValor15 = nValor15_R; nValor16 = nValor16_R;
             nValor17 = nValor17_R; nValor18 = nValor18_R;
             nValor19 = nValor19_R; nValor20 = nValor20_R;
             nValor21 = nValor21_R;
         |SINO;
             nNumValor = 0;
         |FINSI;
     |FINSI;

     |SI nNumValor = 0;
         nValor1  = #refer00@#5;   nValor2  = #refer00@#6;   nValor3  = #refer00@#7;
         nValor4  = #refer00@#8;   nValor5  = #refer00@#9;   nValor6  = #refer00@#10;
         nValor7  = #refer00@#11;  nValor8  = #refer00@#12;  nValor9  = #refer00@#13;
         nValor10 = 0;        nValor11 = 0;        nValor12 = 0;
         nValor13 = 0;        nValor14 = 0;        nValor15 = 0;
         nValor16 = 0;        nValor17 = 0;        nValor18 = 0;
         nValor19 = 0;        nValor20 = 0;        nValor21 = 0;
     |FINSI;

     |HAZ GrabaApartado;         || Ventas

     nGrupo    = 1;
     nSubGrupo = 10;
     nValor1   = #refer00@#14;  nValor2  = #refer00@#15;  nValor3  = #refer00@#16;
     nValor4   = #refer00@#17;  nValor5  = #refer00@#18;  nValor6  = #refer00@#19;
     nValor7   = #refer00@#46;  nValor8  = #refer00@#47;  nValor9  = #refer00@#48;
     nValor10  = 0;        nValor11 = 0;        nValor12 = 0;
     nValor13  = 0;        nValor14 = 0;        nValor15 = 0;
     nValor16  = 0;        nValor17 = 0;        nValor18 = 0;
     nValor19  = 0;        nValor20 = 0;        nValor21 = 0;

     |HAZ GrabaApartado;         || Recargo de Equivalencia

     nGrupo    = 1;
     nSubGrupo = 5;
     nValor1   = #refer00@#49;   nValor2  = 0;         nValor3  = #refer00@#50;
     nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
     nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
     nValor10  = 0;         nValor11 = 0;         nValor12 = 0;
     nValor13  = 0;         nValor14 = 0;         nValor15 = 0;
     nValor16  = 0;         nValor17 = 0;         nValor18 = 0;
     nValor19  = 0;         nValor20 = 0;         nValor21 = 0;

     aQueQuiero = "|NC";
     aCampos    = #refer00@#aQueQuiero#;
     nNumCampos = aCampos;
     nNumCampos = nNumCampos - 1;

     |SI nNumCampos ] 90;
         |SI #refer00@#78 ! 0; |O #refer00@#79 ! 0; |O #refer00@#80 ! 0;
             |O #refer00@#81 ! 0; |O #refer00@#82 ! 0; |O #refer00@#83 ! 0;
                |O #refer00@#84 ! 0; |O #refer00@#85 ! 0; |O #refer00@#86 ! 0;
                   |O #refer00@#87 ! 0; |O #refer00@#88 ! 0; |O #refer00@#89 ! 0;
              nValor1   = #refer00@#78;   nValor2  = #refer00@#79;   nValor3  = #refer00@#80;
              nValor4   = #refer00@#81;   nValor5  = #refer00@#82;   nValor6  = #refer00@#83;
              nValor7   = #refer00@#84;   nValor8  = #refer00@#85;   nValor9  = #refer00@#86;
              nValor10  = #refer00@#87;   nValor11 = #refer00@#88;   nValor12 = #refer00@#89;
              nValor13  = 0;         nValor14 = 0;         nValor15 = 0;
              nValor16  = 0;         nValor17 = 0;         nValor18 = 0;
              nValor19  = 0;         nValor20 = 0;         nValor21 = 0;
         |FINSI;
    |FINSI;

    |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias

     |SI #refer00@#21 ! 0;
         nGrupo    = 2;
         nSubGrupo = 1;
         nValor1   = #refer00@#62;   nValor2  = 0;         nValor3  = #refer00@#21;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;
         nValor13  = 0;         nValor14 = 0;         nValor15 = 0;
         nValor16  = 0;         nValor17 = 0;         nValor18 = 0;
         nValor19  = 0;         nValor20 = 0;         nValor21 = 0;

         |SI aDef09 ! ""; nCampo1 = 62; nCampo2 = 21; |HAZ DesgloseCon; |FINSI;

         |HAZ GrabaApartado;
     |FINSI;

     |SI #refer00@#22 ! 0;
         nGrupo    = 2;
         nSubGrupo = 3;
         nValor1   = #refer00@#64;   nValor2  = 0;         nValor3  = #refer00@#22;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;
         nValor13  = 0;         nValor14 = 0;         nValor15 = 0;
         nValor16  = 0;         nValor17 = 0;         nValor18 = 0;
         nValor19  = 0;         nValor20 = 0;         nValor21 = 0;

         |SI aDef09 ! ""; nCampo1 = 64; nCampo2 = 22; |HAZ DesgloseCon; |FINSI;

         |HAZ GrabaApartado;
     |FINSI;

     |SI #refer00@#51 ! 0;
         nGrupo    = 2;
         nSubGrupo = 5;
         nValor1   = #refer00@#66;   nValor2  = 0;         nValor3  = #refer00@#51;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;
         nValor13  = 0;         nValor14 = 0;         nValor15 = 0;
         nValor16  = 0;         nValor17 = 0;         nValor18 = 0;
         nValor19  = 0;         nValor20 = 0;         nValor21 = 0;

         |SI aDef09 ! ""; nCampo1 = 66; nCampo2 = 51; |HAZ DesgloseCon; |FINSI;

         |HAZ GrabaApartado;
     |FINSI;

     |SI #refer00@#23 ! 0;
         nGrupo    = 2;
         nSubGrupo = 7;
         nValor1   = 0;         nValor2  = 0;         nValor3  = #refer00@#23;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;
         nValor13  = 0;         nValor14 = 0;         nValor15 = 0;
         nValor16  = 0;         nValor17 = 0;         nValor18 = 0;
         nValor19  = 0;         nValor20 = 0;         nValor21 = 0;

         |SI nNumCampos ] 90; nValor1 = #refer00@#90; |FINSI;
         |HAZ GrabaApartado;
     |FINSI;

     |SI #refer00@#24 ! 0;
         nGrupo    = 2;
         nSubGrupo = 9;
         nValor1   = 0;         nValor2  = 0;         nValor3  = #refer00@#24;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;
         nValor13  = 0;         nValor14 = 0;         nValor15 = 0;
         nValor16  = 0;         nValor17 = 0;         nValor18 = 0;
         nValor19  = 0;         nValor20 = 0;         nValor21 = 0;

         |HAZ GrabaApartado;
     |FINSI;

     |SI #refer00@#43 ! 0;
         nGrupo    = 2;
         nSubGrupo = 2;
         nValor1   = #refer00@#63;   nValor2  = 0;         nValor3  = #refer00@#43;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;
         nValor13  = 0;         nValor14 = 0;         nValor15 = 0;
         nValor16  = 0;         nValor17 = 0;         nValor18 = 0;
         nValor19  = 0;         nValor20 = 0;         nValor21 = 0;

         |SI aDef09 ! ""; nCampo1 = 63; nCampo2 = 43; |HAZ DesgloseCon; |FINSI;

         |HAZ GrabaApartado;
     |FINSI;

     |SI #refer00@#44 ! 0;
         nGrupo    = 2;
         nSubGrupo = 4;
         nValor1   = #refer00@#65;   nValor2  = 0;         nValor3  = #refer00@#44;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;
         nValor13  = 0;         nValor14 = 0;         nValor15 = 0;
         nValor16  = 0;         nValor17 = 0;         nValor18 = 0;
         nValor19  = 0;         nValor20 = 0;         nValor21 = 0;

         |SI aDef09 ! ""; nCampo1 = 65; nCampo2 = 44; |HAZ DesgloseCon; |FINSI;

         |HAZ GrabaApartado;
     |FINSI;

     |SI #refer00@#58 ! 0;
         nGrupo    = 2;
         nSubGrupo = 6;
         nValor1   = #refer00@#67;   nValor2  = 0;         nValor3  = #refer00@#58;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;
         nValor13  = 0;         nValor14 = 0;         nValor15 = 0;
         nValor16  = 0;         nValor17 = 0;         nValor18 = 0;
         nValor19  = 0;         nValor20 = 0;         nValor21 = 0;

         |SI aDef09 ! ""; nCampo1 = 67; nCampo2 = 58; |HAZ DesgloseCon; |FINSI;

         |HAZ GrabaApartado;
     |FINSI;

     |SI #refer00@#61 ! 0;
         nGrupo    = 2;
         nSubGrupo = 10;
         nValor1   = 0;         nValor2  = 0;         nValor3  = #refer00@#58;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;
         nValor13  = 0;         nValor14 = 0;         nValor15 = 0;
         nValor16  = 0;         nValor17 = 0;         nValor18 = 0;
         nValor19  = 0;         nValor20 = 0;         nValor21 = 0;

         |HAZ GrabaApartado;
     |FINSI;

     nGrupo    = 5;
     nSubGrupo = 1;
     nValor0   = #refer00@#27;
     |HAZ GrabaApartado;         || Atribuible al Estado

     nGrupo    = 3;
     nSubGrupo = 9;
     nValor0   = #refer00@#54;
     |HAZ GrabaApartado;         || Entregas Intracomunitarias

     nGrupo    = 5;
     nSubGrupo = 6;
     nValor0   = #refer00@#29;
     |HAZ GrabaApartado;         || Compensacion

     nGrupo    = 5;
     nSubGrupo = 2;
     nValor0   = #refer00@#30;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 10;
     nValor0   = #refer00@#68;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 11;
     nValor0   = #refer00@#69;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 2;
     nValor0   = #refer00@#34;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 3;
     nValor0   = #refer00@#38;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 8;
     nValor0   = #refer00@#39;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 12;
     nValor0   = #refer00@#37;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 13;
     nValor0   = #refer00@#40;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 14;
     nValor0   = #refer00@#41;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 1;
     nValor0   = #refer00@#52;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 5;
     nValor0   = #refer00@#53;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 6;
     nValor0   = #refer00@#59;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 7;
     nValor0   = #refer00@#56;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 8;
     nValor0   = #refer00@#57;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 16;
     nValor0   = #refer00@#59;
     |HAZ GrabaApartado;

     |HAZ Totales;

     |CIERRA #dsmociva;

     |SI nPeriodo = 12;  |O aPeriodo = "MENSUAL";
         |ABRE #dsmom005;
         #dsmom005#0 = nModelo;
         |LEE 040#dsmom005.=;
         |SI FSalida ! 0;  |DDEFECTO #dsmom005;  |FINSI;
         |CIERRA #dsmom005;

         |SI #refer00@#31 ! 0;  |Y #dsmom005#11 = "COMPENSAR";
             |ABRE #dsmom006;
             #dsmom006#0  = nCodigoNue;
             #dsmom006#1  = #dsmom005#0;
             |LEE 101#dsmom006.=;
             |SI FSalida ! 0;
                 |DDEFECTO #dsmom006;
                 #dsmom006#0  = nCodigoNue;
                 #dsmom006#1  = #dsmom005#0;
                 #dsmom006#2  = #dsmom005#1;
                 #dsmom006#3  = #dsmom005#2;
                 #dsmom006#4  = #dsmom005#3;
                 #dsmom006#5  = #dsmom005#4;
                 #dsmom006#6  = #dsmom005#5;
                 #dsmom006#7  = #dsmom005#6;
                 #dsmom006#8  = #dsmom005#7;
                 #dsmom006#9  = #dsmom005#8;
                 #dsmom006#10 = #dsmom005#9;
                 #dsmom006#11 = #dsmom005#10;
                 |GRABA 020#dsmom006.b;
             |FINSI;
             #dsmom006#12 = "DEVOLVER";
             |GRABA 020#dsmom006.a;
             |LIBERA #dsmom006;
             |CIERRA #dsmom006;
         |FINSI;

         |SI #refer00@#32 ! 0;  |Y #dsmom005#11 = "DEVOLVER ";
             |ABRE #dsmom006;
             #dsmom006#0  = nCodigoNue;
             #dsmom006#1  = #dsmom005#0;
             |LEE 101#dsmom006.=;
             |SI FSalida ! 0;
                 |DDEFECTO #dsmom006;
                 #dsmom006#0  = nCodigoNue;
                 #dsmom006#1  = #dsmom005#0;
                 #dsmom006#2  = #dsmom005#1;
                 #dsmom006#3  = #dsmom005#2;
                 #dsmom006#4  = #dsmom005#3;
                 #dsmom006#5  = #dsmom005#4;
                 #dsmom006#6  = #dsmom005#5;
                 #dsmom006#7  = #dsmom005#6;
                 #dsmom006#8  = #dsmom005#7;
                 #dsmom006#9  = #dsmom005#8;
                 #dsmom006#10 = #dsmom005#9;
                 #dsmom006#11 = #dsmom005#10;
                 |GRABA 020#dsmom006.b;
             |FINSI;
             #dsmom006#12 = "COMPENSAR";
             |GRABA 020#dsmom006.a;
             |LIBERA #dsmom006;
             |CIERRA #dsmom006;
        |FINSI;
     |FINSI;

     enEmpresa     = nCodigoNue;
     enEjer        = #dspase03#4;
     enPeriodo     = nPeriodo;
     enModelo      = nModelo;
     enComplem     = 0;
     enActividad   = #agicen14#1;
     enTipoEntrada = 91;
     |SUB_EJECUTA_NP ":modelos/dsmociva";

     #dspase25#0 = nModelo;
     #dspase25#1 = nPeriodo;
     #dspase25#2 = 0;
     #dspase25#3 = nCodigoNue;
     |LEE 101#dspase25.=;
     |SI FSalida ! 0;
         |DDEFECTO #dspase25;
         #dspase25#0 = nModelo;
         #dspase25#1 = nPeriodo;
         #dspase25#2 = 0;
         #dspase25#3 = nCodigoNue;
         |GRABA 020#dspase25.b;
     |FINSI;
     #dspase25#4 = #refer00@#28 - #refer00@#29 - #refer00@#30;
     |GRABA 020#dspase25.a;
     |LIBERA #dspase25;

     enEmpresa = nCodigoNue;
     enEjer    = #dspase03#4;
     enPeriodo = nPeriodo;
     enModelo  = nModelo;
     enComplem = 0;

     efFechaI  = #refer00@#3;
     |SI #refer00@#3 = "          ";  efFechaI  = "01.01.0000";  |FINSI;

     eaArchiva = "";

     |SUB_EJECUTA "dspasuti;PonDatosPlaning";

     #refer04@#0 = #refer00@#0;
     #refer04@#1 = #dspase03#4;
     #refer04@#2 = #refer00@#1;
     #refer04@#3 = 340;
     #refer04@#4 = 0;
     #refer04@#5 = 1;
     |LEE 000#refer04@.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nCod340_1 = #refer00@#0;
     nCod340_2 = #dspase03#4;
     nCod340_3 = #refer00@#1;

     |HAZ Pasa340;
|FPRC;

|DEFBUCLE caman303;
     #refer00@#1003;
     ;
     " ", 01, nAnyo;
     "z", 12, nAnyo;
     ;
     NULL, PasaModelo303Conta;
|FIN;

|PROCESO MiraEmpresa303;
     aDef = eaPathAnterior + "agicont/def/caman303.mas";
     |CARGA_DEF aDef, refer00@;
     |SI FSalida ! 0;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agicont/def/caportad.mas";
     |CARGA_DEF aDef, refer02@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agicont/def/dsmo3401.mas";
     |CARGA_DEF aDef, refer04@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer02@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef09 = eaPathAnterior + "agicont/def/eosma100.mas";
     |CARGA_DEF aDef09, refer09@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer04@;
         |DESCARGA_DEF #refer02@;
         |DESCARGA_DEF #refer00@;
         aDef09 = "";
     |FINSI;

     aFich = eaPathAnterior + "agicont/fich/" + (("00000" + #refer01@#2) % -105) + #refer01@#3 + "/";
     |PATH_DAT #refer00@#aFich#;
     |PATH_DAT #refer02@#aFich#;
     |PATH_DAT #refer04@#aFich#;
     |SI aDef09 ! ""; |PATH_DAT #refer09@#aFich#; |FINSI;

     aAlfa   = #dspase03#4;
     aAlfa   = #dspase03#4 % -102;
     nAnyo   = aAlfa;

     |ABRE #agicen14;
     |ABRE #dsmom002;
     |ABRE #agitab99;
     |ABRE #refer02@;
     |ABRE #refer04@;
     |BUCLE caman303;
     |CIERRA #dsmom002;
     |CIERRA #agicen14;
     |CIERRA #refer02@;
     |CIERRA #refer04@;

     |SI aDef09 ! ""; |DESCARGA_DEF #refer09@; |FINSI;
     |DESCARGA_DEF #refer04@;
     |DESCARGA_DEF #refer02@;
     |DESCARGA_DEF #refer00@;
|FPRC;

|DEFBUCLE canempre_303;
     #refer01@#1002;
     26;
     00000, 0, nAnyo;
     99999, 9, nAnyo;
     ;
     NULL, MiraEmpresa303;
|FIN;

|PROCESO Pase303Conta;
     aDef = eaPathAnterior + "agicont/def/canempre.mas";
     |CARGA_DEF aDef, refer01@;
     |SI FSalida ! 0;
         |ACABA;
     |FINSI;

     aFich = eaPathAnterior + "agicont/fich/";
     |PATH_DAT #refer01@#aFich#;

     aAlfa   = #dspase03#4;
     aAlfa   = #dspase03#4 % -102;
     nAnyo   = aAlfa;

     |BUCLE canempre_303;

     |DESCARGA_DEF #refer01@;
|FPRC;

|PROCESO Pase303;
     enModelo   = 303;
     enDEmpresa = #dspase03#9;
     enHEmpresa = #dspase03#10;

     |SI #dspase03#8 = 1;
         |SUB_EJECUTA "dspasuti;BorraModelos";
     |FINSI;

     |SI #dspase03#8 = 1;  |O #dspase03#8 = 3;
         |HAZ Pase303Conta;
     |FINSI;

     |SI #dspase03#8 = 1;  |O #dspase03#8 = 2;
         |HAZ Pase303Reo;
     |FINSI;
|FPRC;

|| *************************************************************************
|| *************************************************************************
|| *************************************************************************
||               M O D E L O   3 2 0
|| *************************************************************************
|| *************************************************************************
|| *************************************************************************

|PROCESO PasaModelo320;
     |SI enEstaCambio = 1;
         nCodigoNue = 0;
         nCodigoReo = #refer00@#0;
         |BUCLE dspase15_300;
         |SI nCodigoNue = 0;  |ACABA;  |FINSI;
     |SINO;
         nCodigoNue = #refer00@#0;
     |FINSI;
     |SI nCodigoNue < #dspase03#9; |O nCodigoNue > #dspase03#10; |ACABA; |FINSI;

     #refer02@#0 = nCodigoReo;
     |LEE 040#refer02@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer02@;  |FINSI;

     #agicen14#0 = nCodigoNue;
     #agicen14#1 = #refer00@#1;
     |LEE 101#agicen14.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     #agicen14#6 = "01.01.0000";

     nModelo = 320;

     #agitab99#0 = nModelo;
     |LEE 040#agitab99.=;
     |SI FSalida ! 0;  |DDEFECTO #agitab99;  |FINSI;

     #dsmom002#0 = nCodigoNue;
     #dsmom002#1 = #refer00@#1;
     #dsmom002#2 = nModelo;
     |LEE 101#dsmom002.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmom002;
         #dsmom002#0  = nCodigoNue;
         #dsmom002#1  = #refer00@#1;
         #dsmom002#2  = nModelo;
         |GRABA 020#dsmom002.b;
     |FINSI;

     #dsmom002#3  = #agitab99#1;
     #dsmom002#4  = #agitab99#2;
     #dsmom002#5  = #agitab99#3;
     #dsmom002#6  = #agicen14#4;
     #dsmom002#7  = "MENSUAL";
     #dsmom002#8  = #agicen14#5;
     #dsmom002#9  = #agicen14#6;
     #dsmom002#10 = 1;

     |GRABA 020#dsmom002.a;
     |LIBERA #dsmom002;

     |SI #agicen14#15 = "          ";  |O #agicen14#15 = "MODULOS   ";
          #agicen14#15 = "MANUAL";
     |FINSI;
     |GRABA 020#agicen14.a;
     |LIBERA #agicen14;

     enSwEstar = 0;

     enEmpresaA = nCodigoNue;
     enAnyo     = #dspase03#4;
     |SUB_EJECUTA_NP ":modelos/dsmoz001";

     nPeriodo = #refer00@#2;

     |ABRE #dsmom008;
     #dsmom008#0   = nCodigoNue;
     #dsmom008#1   = #dspase03#4;
     #dsmom008#2   = nPeriodo;
     #dsmom008#3   = nModelo;
     #dsmom008#4   = 0;
     #dsmom008#5   = #agicen14#1;
     |LEE 040#dsmom008.=;
     |SI FSalida ! 0;  |CIERRA #dsmom008;  |ACABA;  |FINSI;
     |CIERRA #dsmom008;

     #refer03@#0  = #refer00@#0;
     #refer03@#1  = #refer00@#1;
     #refer03@#2  = #refer00@#2;
     #refer03@#3  = #refer00@#4;
     |LEE 040#refer03@.=;

     #refer01@#0 = #refer00@#0;
     #refer01@#1 = #refer00@#1;
     #refer01@#2 = #refer00@#4;
     |LEE 040#refer01@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer01@;  |FINSI;

     |SI #refer01@#4 ! "E";  |Y #refer01@#4 ! "P";
      |Y #refer01@#4 ! "A";  |Y #refer01@#4 ! " ";
         #refer01@#4 = "O";
         #refer01@#5 = "9999";
     |FINSI;

     enEmpresa     = nCodigoNue;
     enEjer        = #dspase03#4;
     enPeriodo     = nPeriodo;
     enModelo      = nModelo;
     enComplem     = 0;
     enActividad   = #agicen14#1;
     enTipoEntrada = 90;
     |SUB_EJECUTA_NP ":modelos/dsmociva";

                       nGrupo = 1;  nSubGrupo = 1;
     |SI #refer01@#29 = 1;  nGrupo = 1;  nSubGrupo = 1;  |FINSI;
     |SI #refer01@#29 = 2;  nGrupo = 1;  nSubGrupo = 2;  |FINSI;
     |SI #refer01@#29 = 3;  nGrupo = 1;  nSubGrupo = 2;  |FINSI;
     |SI #refer01@#29 = 4;  nGrupo = 1;  nSubGrupo = 3;  |FINSI;
     |SI #refer01@#29 = 5;  nGrupo = 1;  nSubGrupo = 4;  |FINSI;

     |ABRE #dsmociva;

     nValor1  = #refer00@#7;   nValor2  = #refer00@#8;   nValor3  = #refer00@#9;
     nValor4  = #refer00@#10;  nValor5  = #refer00@#11;  nValor6  = #refer00@#12;
     nValor7  = #refer00@#13;  nValor8  = #refer00@#14;  nValor9  = #refer00@#15;
     nValor10 = 0;        nValor11 = 0;        nValor12 = 0;

     |HAZ GrabaApartado;         || Ventas

     nGrupo    = 1;
     nSubGrupo = 10;
     nValor1   = #refer00@#16;  nValor2  = #refer00@#17;  nValor3  = #refer00@#18;
     nValor4   = #refer00@#19;  nValor5  = #refer00@#20;  nValor6  = #refer00@#21;
     nValor7   = #refer00@#22;  nValor8  = #refer00@#23;  nValor9  = #refer00@#24;
     nValor10  = 0;        nValor11 = 0;        nValor12 = 0;

     |HAZ GrabaApartado;         || Recargo de Equivalencia

     nGrupo    = 1;
     nSubGrupo = 5;
     nValor1   = #refer00@#69;   nValor2  = #refer00@#70;   nValor3  = #refer00@#71;
     nValor4   = #refer00@#72;   nValor5  = #refer00@#73;   nValor6  = #refer00@#74;
     nValor7   = #refer00@#75;   nValor8  = #refer00@#76;   nValor9  = #refer00@#77;
     nValor10  = #refer00@#78;   nValor11 = #refer00@#79;   nValor12 = #refer00@#80;

     |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias

     |SI #refer00@#29 ! 0;
         nGrupo    = 2;
         nSubGrupo = 1;
         nValor1   = #refer00@#28;   nValor2  = 0;         nValor3  = #refer00@#29;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;
     |FINSI;

     |SI #refer00@#31 ! 0;
         nGrupo    = 2;
         nSubGrupo = 3;
         nValor1   = #refer00@#30;   nValor2  = 0;         nValor3  = #refer00@#31;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#33 ! 0;
         nGrupo    = 2;
         nSubGrupo = 5;
         nValor1   = #refer00@#32;   nValor2  = 0;         nValor3  = #refer00@#33;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#34 ! 0;
         nGrupo    = 2;
         nSubGrupo = 7;
         nValor1   = #refer00@#81;   nValor2  = 0;         nValor3  = #refer00@#34;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#35 ! 0;
         nGrupo    = 2;
         nSubGrupo = 9;
         nValor1   = 0;         nValor2  = 0;         nValor3  = #refer00@#35;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#37 ! 0;
         nGrupo    = 2;
         nSubGrupo = 2;
         nValor1   = #refer00@#36;   nValor2  = 0;         nValor3  = #refer00@#37;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#39 ! 0;
         nGrupo    = 2;
         nSubGrupo = 4;
         nValor1   = #refer00@#38;   nValor2  = 0;         nValor3  = #refer00@#39;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     nGrupo    = 3;
     nSubGrupo = 4;
     nValor0   = #refer03@#4;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 5;
     nValor0   = #refer03@#5;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 6;
     nValor0   = #refer03@#6;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 7;
     nValor0   = #refer03@#7;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 8;
     nValor0   = #refer03@#8;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 9;
     nValor0   = #refer00@#45;
     |HAZ GrabaApartado;         || Entregas Intracomunitarias

     nGrupo    = 3;
     nSubGrupo = 10;
     nValor0   = #refer00@#46;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 11;
     nValor0   = #refer00@#47;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 13;
     nValor0   = #refer03@#12;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 14;
     nValor0   = #refer03@#13;
     |HAZ GrabaApartado;

     nGrupo    = 5;
     nSubGrupo = 1;
     nValor0   = #refer00@#42;
     |HAZ GrabaApartado;         || Atribuible al Estado

     nGrupo    = 5;
     nSubGrupo = 2;
     nValor0   = #refer00@#49;
     |HAZ GrabaApartado;         || Sujetos Pasivos

     nGrupo    = 5;
     nSubGrupo = 6;
     nValor0   = #refer00@#44;
     |HAZ GrabaApartado;         || Compensacion

     nGrupo    = 4;
     nSubGrupo = 1;
     nValor0   = #refer03@#15;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 2;
     nValor0   = #refer03@#16;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 3;
     nValor0   = #refer03@#17;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 4;
     nValor0   = #refer03@#18;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 5;
     nValor0   = #refer03@#19;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 6;
     nValor0   = #refer03@#20;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 7;
     nValor0   = #refer03@#21;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 8;
     nValor0   = #refer03@#22;
     |HAZ GrabaApartado;

     |HAZ Totales;

     |CIERRA #dsmociva;

     enEmpresa     = nCodigoNue;
     enEjer        = #dspase03#4;
     enPeriodo     = nPeriodo;
     enModelo      = nModelo;
     enComplem     = 0;
     enActividad   = #agicen14#1;
     enTipoEntrada = 91;
     |SUB_EJECUTA_NP ":modelos/dsmociva";

     enPregunta    = 0;

     #dspase25#0 = nModelo;
     #dspase25#1 = nPeriodo;
     #dspase25#2 = 0;
     #dspase25#3 = nCodigoNue;
     |LEE 101#dspase25.=;
     |SI FSalida ! 0;
         |DDEFECTO #dspase25;
         #dspase25#0 = nModelo;
         #dspase25#1 = nPeriodo;
         #dspase25#2 = 0;
         #dspase25#3 = nCodigoNue;
         |GRABA 020#dspase25.b;
     |FINSI;
     #dspase25#4 = #refer00@#50;
     |GRABA 020#dspase25.a;
     |LIBERA #dspase25;

     enEmpresa = nCodigoNue;
     enEjer    = #dspase03#4;
     enPeriodo = nPeriodo;
     enModelo  = nModelo;
     enComplem = 0;

     efFechaI  = #refer00@#5;
     |SI #refer00@#5 = "          ";  efFechaI  = "01.01.0000";  |FINSI;

     eaArchiva = "";
     |SI #refer00@#6 = "S";  eaArchiva = "X";  |FINSI;

     |SUB_EJECUTA "dspasuti;PonDatosPlaning";
|FPRC;

|DEFBUCLE eosma320;
     #refer00@#1005;
     ;
     00001, 0,    1, "M", nAnyo;
     99999, 9, #dspase03#5, "M", nAnyo;
     ;
     NULL, PasaModelo320;
|FIN;

|PROCESO Pase320;
     enModelo = 320;
     enDEmpresa = #dspase03#9;
     enHEmpresa = #dspase03#10;

     |SUB_EJECUTA "dspasuti;BorraModelos";

     aDef = eaPathAnterior + "agieos/def/eosma320.mas";
     |CARGA_DEF aDef, refer00@;
     |SI FSalida ! 0;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agieos/def/eosactiv.mas";
     |CARGA_DEF aDef, refer01@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agieos/def/eosclien.mas";
     |CARGA_DEF aDef, refer02@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agieos/def/eosopes1.mas";
     |CARGA_DEF aDef, refer03@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer02@;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aFich = eaPathAnterior + "agieos/fich/";
     |PATH_DAT #refer00@#aFich#;
     |PATH_DAT #refer01@#aFich#;
     |PATH_DAT #refer02@#aFich#;
     |PATH_DAT #refer03@#aFich#;

     aAlfa   = #dspase03#4;
     aAlfa   = #dspase03#4 % -102;
     nAnyo   = aAlfa;

     |ABRE #refer01@;
     |ABRE #refer02@;
     |ABRE #refer03@;
     |ABRE #agicen14;
     |ABRE #dsmom002;
     |ABRE #agitab99;
     |BUCLE eosma320;
     |CIERRA #dsmom002;
     |CIERRA #agicen14;
     |CIERRA #refer01@;
     |CIERRA #refer02@;
     |CIERRA #refer03@;
     |CIERRA #refer03@;

     |DESCARGA_DEF #refer03@;
     |DESCARGA_DEF #refer02@;
     |DESCARGA_DEF #refer01@;
     |DESCARGA_DEF #refer00@;
|FPRC;

|| *************************************************************************
|| *************************************************************************
|| *************************************************************************
||               M O D E L O   3 3 0
|| *************************************************************************
|| *************************************************************************
|| *************************************************************************

|PROCESO PasaModelo330;
     |SI enEstaCambio = 1;
         nCodigoNue = 0;
         nCodigoReo = #refer00@#0;
         |BUCLE dspase15_300;
         |SI nCodigoNue = 0;  |ACABA;  |FINSI;
     |SINO;
         nCodigoNue = #refer00@#0;
     |FINSI;
     |SI nCodigoNue < #dspase03#9; |O nCodigoNue > #dspase03#10; |ACABA; |FINSI;

     #refer02@#0 = nCodigoReo;
     |LEE 040#refer02@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer02@;  |FINSI;

     #agicen14#0 = nCodigoNue;
     #agicen14#1 = #refer00@#1;
     |LEE 101#agicen14.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     #agicen14#6 = "01.01.0000";

     nModelo = 330;

     #agitab99#0 = nModelo;
     |LEE 040#agitab99.=;
     |SI FSalida ! 0;  |DDEFECTO #agitab99;  |FINSI;

     #dsmom002#0 = nCodigoNue;
     #dsmom002#1 = #refer00@#1;
     #dsmom002#2 = nModelo;
     |LEE 101#dsmom002.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmom002;
         #dsmom002#0  = nCodigoNue;
         #dsmom002#1  = #refer00@#1;
         #dsmom002#2  = nModelo;
         |GRABA 020#dsmom002.b;
     |FINSI;

     #dsmom002#3  = #agitab99#1;
     #dsmom002#4  = #agitab99#2;
     #dsmom002#5  = #agitab99#3;
     #dsmom002#6  = #agicen14#4;
     #dsmom002#7  = "MENSUAL";
     #dsmom002#8  = #agicen14#5;
     #dsmom002#9  = #agicen14#6;
     #dsmom002#10 = 1;

     |GRABA 020#dsmom002.a;
     |LIBERA #dsmom002;

     |SI #agicen14#15 = "          ";  |O #agicen14#15 = "MODULOS   ";
          #agicen14#15 = "MANUAL";
     |FINSI;
     |GRABA 020#agicen14.a;
     |LIBERA #agicen14;

     enSwEstar = 0;

     enEmpresaA = nCodigoNue;
     enAnyo     = #dspase03#4;
     |SUB_EJECUTA_NP ":modelos/dsmoz001";

     nPeriodo = #refer00@#2;

     |ABRE #dsmom008;
     #dsmom008#0   = nCodigoNue;
     #dsmom008#1   = #dspase03#4;
     #dsmom008#2   = nPeriodo;
     #dsmom008#3   = nModelo;
     #dsmom008#4   = 0;
     #dsmom008#5   = #agicen14#1;
     |LEE 040#dsmom008.=;
     |SI FSalida ! 0;  |CIERRA #dsmom008;  |ACABA;  |FINSI;
     |CIERRA #dsmom008;

     #refer03@#0  = #refer00@#0;
     #refer03@#1  = #refer00@#1;
     #refer03@#2  = #refer00@#2;
     #refer03@#3  = #refer00@#4;
     |LEE 040#refer03@.=;

     #refer01@#0 = #refer00@#0;
     #refer01@#1 = #refer00@#1;
     #refer01@#2 = #refer00@#4;
     |LEE 040#refer01@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer01@;  |FINSI;

     |SI #refer01@#4 ! "E";  |Y #refer01@#4 ! "P";
      |Y #refer01@#4 ! "A";  |Y #refer01@#4 ! " ";
         #refer01@#4 = "O";
         #refer01@#5 = "9999";
     |FINSI;

     enEmpresa     = nCodigoNue;
     enEjer        = #dspase03#4;
     enPeriodo     = nPeriodo;
     enModelo      = nModelo;
     enComplem     = 0;
     enActividad   = #agicen14#1;
     enTipoEntrada = 90;
     |SUB_EJECUTA_NP ":modelos/dsmociva";

                       nGrupo = 1;  nSubGrupo = 1;
     |SI #refer01@#29 = 1;  nGrupo = 1;  nSubGrupo = 1;  |FINSI;
     |SI #refer01@#29 = 2;  nGrupo = 1;  nSubGrupo = 2;  |FINSI;
     |SI #refer01@#29 = 3;  nGrupo = 1;  nSubGrupo = 2;  |FINSI;
     |SI #refer01@#29 = 4;  nGrupo = 1;  nSubGrupo = 3;  |FINSI;
     |SI #refer01@#29 = 5;  nGrupo = 1;  nSubGrupo = 4;  |FINSI;

     |ABRE #dsmociva;

     nValor1  = #refer00@#7;   nValor2  = #refer00@#8;   nValor3  = #refer00@#9;
     nValor4  = #refer00@#10;  nValor5  = #refer00@#11;  nValor6  = #refer00@#12;
     nValor7  = #refer00@#13;  nValor8  = #refer00@#14;  nValor9  = #refer00@#15;
     nValor10 = 0;        nValor11 = 0;        nValor12 = 0;

     |HAZ GrabaApartado;         || Ventas

     nGrupo    = 1;
     nSubGrupo = 10;
     nValor1   = #refer00@#16;  nValor2  = #refer00@#17;  nValor3  = #refer00@#18;
     nValor4   = #refer00@#19;  nValor5  = #refer00@#20;  nValor6  = #refer00@#21;
     nValor7   = #refer00@#22;  nValor8  = #refer00@#23;  nValor9  = #refer00@#24;
     nValor10  = 0;        nValor11 = 0;        nValor12 = 0;

     |HAZ GrabaApartado;         || Recargo de Equivalencia

     nGrupo    = 1;
     nSubGrupo = 5;
     nValor1   = #refer00@#69;   nValor2  = #refer00@#70;   nValor3  = #refer00@#71;
     nValor4   = #refer00@#72;   nValor5  = #refer00@#73;   nValor6  = #refer00@#74;
     nValor7   = #refer00@#75;   nValor8  = #refer00@#76;   nValor9  = #refer00@#77;
     nValor10  = #refer00@#78;   nValor11 = #refer00@#79;   nValor12 = #refer00@#80;

     |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias

     |SI #refer00@#29 ! 0;
         nGrupo    = 2;
         nSubGrupo = 1;
         nValor1   = #refer00@#28;   nValor2  = 0;         nValor3  = #refer00@#29;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;
     |FINSI;

     |SI #refer00@#31 ! 0;
         nGrupo    = 2;
         nSubGrupo = 3;
         nValor1   = #refer00@#30;   nValor2  = 0;         nValor3  = #refer00@#31;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#33 ! 0;
         nGrupo    = 2;
         nSubGrupo = 5;
         nValor1   = #refer00@#32;   nValor2  = 0;         nValor3  = #refer00@#33;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#34 ! 0;
         nGrupo    = 2;
         nSubGrupo = 7;
         nValor1   = #refer00@#81;   nValor2  = 0;         nValor3  = #refer00@#34;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#35 ! 0;
         nGrupo    = 2;
         nSubGrupo = 9;
         nValor1   = 0;         nValor2  = 0;         nValor3  = #refer00@#35;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#37 ! 0;
         nGrupo    = 2;
         nSubGrupo = 2;
         nValor1   = #refer00@#36;   nValor2  = 0;         nValor3  = #refer00@#37;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#39 ! 0;
         nGrupo    = 2;
         nSubGrupo = 4;
         nValor1   = #refer00@#38;   nValor2  = 0;         nValor3  = #refer00@#39;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     nGrupo    = 5;
     nSubGrupo = 1;
     nValor0   = #refer00@#42;
     |HAZ GrabaApartado;         || Atribuible al Estado

     nGrupo    = 3;
     nSubGrupo = 9;
     nValor0   = #refer00@#45;
     |HAZ GrabaApartado;         || Entregas Intracomunitarias

     nGrupo    = 5;
     nSubGrupo = 6;
     nValor0   = #refer00@#44;
     |HAZ GrabaApartado;         || Compensacion

     nGrupo    = 3;
     nSubGrupo = 2;
     nValor0   = #refer03@#4;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 3;
     nValor0   = #refer03@#5;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 8;
     nValor0   = #refer03@#6;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 10;
     nValor0   = #refer00@#46;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 11;
     nValor0   = #refer00@#47;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 12;
     nValor0   = #refer03@#9;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 13;
     nValor0   = #refer03@#10;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 14;
     nValor0   = #refer03@#11;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 1;
     nValor0   = #refer03@#12;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 5;
     nValor0   = #refer00@#68;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 7;
     nValor0   = #refer03@#15;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 8;
     nValor0   = #refer03@#16;
     |HAZ GrabaApartado;

     |HAZ Totales;

     |CIERRA #dsmociva;

     enEmpresa     = nCodigoNue;
     enEjer        = #dspase03#4;
     enPeriodo     = nPeriodo;
     enModelo      = nModelo;
     enComplem     = 0;
     enActividad   = #agicen14#1;
     enTipoEntrada = 91;
     enDevolver    = #refer00@#51;
     enPregunta    = 1;

     |SUB_EJECUTA_NP ":modelos/dsmociva";
     enPregunta    = 0;

     #dspase25#0 = nModelo;
     #dspase25#1 = nPeriodo;
     #dspase25#2 = 0;
     #dspase25#3 = nCodigoNue;
     |LEE 101#dspase25.=;
     |SI FSalida ! 0;
         |DDEFECTO #dspase25;
         #dspase25#0 = nModelo;
         #dspase25#1 = nPeriodo;
         #dspase25#2 = 0;
         #dspase25#3 = nCodigoNue;
         |GRABA 020#dspase25.b;
     |FINSI;
     #dspase25#4 = #refer00@#50;
     |GRABA 020#dspase25.a;
     |LIBERA #dspase25;

     enEmpresa = nCodigoNue;
     enEjer    = #dspase03#4;
     enPeriodo = nPeriodo;
     enModelo  = nModelo;
     enComplem = 0;

     efFechaI  = #refer00@#5;
     |SI #refer00@#5 = "          ";  efFechaI  = "01.01.0000";  |FINSI;

     eaArchiva = "";
     |SI #refer00@#6 = "S";  eaArchiva = "X";  |FINSI;

     |SUB_EJECUTA "dspasuti;PonDatosPlaning";
|FPRC;

|DEFBUCLE eosma330;
     #refer00@#1005;
     ;
     00001, 0,    1, "M", nAnyo;
     99999, 9, #dspase03#5, "M", nAnyo;
     ;
     NULL, PasaModelo330;
|FIN;

|PROCESO Pase330;
     enModelo = 330;
     enDEmpresa = #dspase03#9;
     enHEmpresa = #dspase03#10;

     |SUB_EJECUTA "dspasuti;BorraModelos";

     aDef = eaPathAnterior + "agieos/def/eosma330.mas";
     |CARGA_DEF aDef, refer00@;
     |SI FSalida ! 0;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agieos/def/eosactiv.mas";
     |CARGA_DEF aDef, refer01@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agieos/def/eosclien.mas";
     |CARGA_DEF aDef, refer02@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agieos/def/eosopesp.mas";
     |CARGA_DEF aDef, refer03@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer02@;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aFich = eaPathAnterior + "agieos/fich/";
     |PATH_DAT #refer00@#aFich#;
     |PATH_DAT #refer01@#aFich#;
     |PATH_DAT #refer02@#aFich#;
     |PATH_DAT #refer03@#aFich#;

     aAlfa   = #dspase03#4;
     aAlfa   = #dspase03#4 % -102;
     nAnyo   = aAlfa;

     |ABRE #refer01@;
     |ABRE #refer02@;
     |ABRE #refer03@;
     |ABRE #agicen14;
     |ABRE #dsmom002;
     |ABRE #agitab99;
     |BUCLE eosma330;
     |CIERRA #dsmom002;
     |CIERRA #agicen14;
     |CIERRA #refer01@;
     |CIERRA #refer02@;
     |CIERRA #refer03@;
     |CIERRA #refer03@;

     |DESCARGA_DEF #refer03@;
     |DESCARGA_DEF #refer02@;
     |DESCARGA_DEF #refer01@;
     |DESCARGA_DEF #refer00@;
|FPRC;

|| *************************************************************************
|| *************************************************************************
|| *************************************************************************
||               M O D E L O   3 3 2
|| *************************************************************************
|| *************************************************************************
|| *************************************************************************

|PROCESO PasaModelo332;
     |SI enEstaCambio = 1;
         nCodigoNue = 0;
         nCodigoReo = #refer00@#0;
         |BUCLE dspase15_300;
         |SI nCodigoNue = 0;  |ACABA;  |FINSI;
     |SINO;
         nCodigoNue = #refer00@#0;
     |FINSI;
     |SI nCodigoNue < #dspase03#9; |O nCodigoNue > #dspase03#10; |ACABA; |FINSI;

     #refer02@#0 = nCodigoReo;
     |LEE 040#refer02@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer02@;  |FINSI;

     #agicen14#0 = nCodigoNue;
     #agicen14#1 = #refer00@#1;
     |LEE 101#agicen14.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     #agicen14#6 = "01.01.0000";

     nModelo = 332;

     #agitab99#0 = nModelo;
     |LEE 040#agitab99.=;
     |SI FSalida ! 0;  |DDEFECTO #agitab99;  |FINSI;

     #dsmom002#0 = nCodigoNue;
     #dsmom002#1 = #refer00@#1;
     #dsmom002#2 = nModelo;
     |LEE 101#dsmom002.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmom002;
         #dsmom002#0  = nCodigoNue;
         #dsmom002#1  = #refer00@#1;
         #dsmom002#2  = nModelo;
         |GRABA 020#dsmom002.b;
     |FINSI;

     #dsmom002#3  = #agitab99#1;
     #dsmom002#4  = #agitab99#2;
     #dsmom002#5  = #agitab99#3;
     #dsmom002#6  = #agicen14#4;
     #dsmom002#7  = "MENSUAL";
     #dsmom002#8  = #agicen14#5;
     #dsmom002#9  = #agicen14#6;
     #dsmom002#10 = 1;

     |GRABA 020#dsmom002.a;
     |LIBERA #dsmom002;

     |SI #agicen14#15 = "          ";  |O #agicen14#15 = "MODULOS   ";
          #agicen14#15 = "MANUAL";
     |FINSI;
     |GRABA 020#agicen14.a;
     |LIBERA #agicen14;

     enSwEstar = 0;

     enEmpresaA = nCodigoNue;
     enAnyo     = #dspase03#4;
     |SUB_EJECUTA_NP ":modelos/dsmoz001";

     nPeriodo = #refer00@#2;

     |ABRE #dsmom008;
     #dsmom008#0   = nCodigoNue;
     #dsmom008#1   = #dspase03#4;
     #dsmom008#2   = nPeriodo;
     #dsmom008#3   = nModelo;
     #dsmom008#4   = 0;
     #dsmom008#5   = #agicen14#1;
     |LEE 040#dsmom008.=;
     |SI FSalida ! 0;  |CIERRA #dsmom008;  |ACABA;  |FINSI;
     |CIERRA #dsmom008;

     #refer03@#0  = #refer00@#0;
     #refer03@#1  = #refer00@#1;
     #refer03@#2  = #refer00@#2;
     #refer03@#3  = #refer00@#4;
     |LEE 040#refer03@.=;

     #refer01@#0 = #refer00@#0;
     #refer01@#1 = #refer00@#1;
     #refer01@#2 = #refer00@#4;
     |LEE 040#refer01@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer01@;  |FINSI;

     |SI #refer01@#4 ! "E";  |Y #refer01@#4 ! "P";
      |Y #refer01@#4 ! "A";  |Y #refer01@#4 ! " ";
         #refer01@#4 = "O";
         #refer01@#5 = "9999";
     |FINSI;

     enEmpresa     = nCodigoNue;
     enEjer        = #dspase03#4;
     enPeriodo     = nPeriodo;
     enModelo      = nModelo;
     enComplem     = 0;
     enActividad   = #agicen14#1;
     enTipoEntrada = 90;
     |SUB_EJECUTA_NP ":modelos/dsmociva";

                       nGrupo = 1;  nSubGrupo = 1;
     |SI #refer01@#29 = 1;  nGrupo = 1;  nSubGrupo = 1;  |FINSI;
     |SI #refer01@#29 = 2;  nGrupo = 1;  nSubGrupo = 2;  |FINSI;
     |SI #refer01@#29 = 3;  nGrupo = 1;  nSubGrupo = 2;  |FINSI;
     |SI #refer01@#29 = 4;  nGrupo = 1;  nSubGrupo = 3;  |FINSI;
     |SI #refer01@#29 = 5;  nGrupo = 1;  nSubGrupo = 4;  |FINSI;

     |ABRE #dsmociva;

     nValor1  = #refer00@#7;   nValor2  = #refer00@#8;   nValor3  = #refer00@#9;
     nValor4  = #refer00@#10;  nValor5  = #refer00@#11;  nValor6  = #refer00@#12;
     nValor7  = #refer00@#13;  nValor8  = #refer00@#14;  nValor9  = #refer00@#15;
     nValor10 = 0;        nValor11 = 0;        nValor12 = 0;

     |HAZ GrabaApartado;         || Ventas

     nGrupo    = 1;
     nSubGrupo = 10;
     nValor1   = #refer00@#16;  nValor2  = #refer00@#17;  nValor3  = #refer00@#18;
     nValor4   = #refer00@#19;  nValor5  = #refer00@#20;  nValor6  = #refer00@#21;
     nValor7   = #refer00@#22;  nValor8  = #refer00@#23;  nValor9  = #refer00@#24;
     nValor10  = 0;        nValor11 = 0;        nValor12 = 0;

     |HAZ GrabaApartado;         || Recargo de Equivalencia

     nGrupo    = 1;
     nSubGrupo = 5;
     nValor1   = #refer00@#69;   nValor2  = #refer00@#70;   nValor3  = #refer00@#71;
     nValor4   = #refer00@#72;   nValor5  = #refer00@#73;   nValor6  = #refer00@#74;
     nValor7   = #refer00@#75;   nValor8  = #refer00@#76;   nValor9  = #refer00@#77;
     nValor10  = #refer00@#78;   nValor11 = #refer00@#79;   nValor12 = #refer00@#80;

     |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias

     |SI #refer00@#29 ! 0;
         nGrupo    = 2;
         nSubGrupo = 1;
         nValor1   = #refer00@#28;   nValor2  = 0;         nValor3  = #refer00@#29;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;
     |FINSI;

     |SI #refer00@#31 ! 0;
         nGrupo    = 2;
         nSubGrupo = 3;
         nValor1   = #refer00@#30;   nValor2  = 0;         nValor3  = #refer00@#31;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#33 ! 0;
         nGrupo    = 2;
         nSubGrupo = 5;
         nValor1   = #refer00@#32;   nValor2  = 0;         nValor3  = #refer00@#33;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#34 ! 0;
         nGrupo    = 2;
         nSubGrupo = 7;
         nValor1   = #refer00@#81;   nValor2  = 0;         nValor3  = #refer00@#34;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#35 ! 0;
         nGrupo    = 2;
         nSubGrupo = 9;
         nValor1   = 0;         nValor2  = 0;         nValor3  = #refer00@#35;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#37 ! 0;
         nGrupo    = 2;
         nSubGrupo = 2;
         nValor1   = #refer00@#36;   nValor2  = 0;         nValor3  = #refer00@#37;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     |SI #refer00@#39 ! 0;
         nGrupo    = 2;
         nSubGrupo = 4;
         nValor1   = #refer00@#38;   nValor2  = 0;         nValor3  = #refer00@#39;
         nValor4   = 0;         nValor5  = 0;         nValor6  = 0;
         nValor7   = 0;         nValor8  = 0;         nValor9  = 0;
         nValor10  = 0;         nValor11 = 0;         nValor12 = 0;

         |HAZ GrabaApartado;         || Adquisiciones Intracomunitarias
     |FINSI;

     nGrupo    = 5;
     nSubGrupo = 1;
     nValor0   = #refer00@#42;
     |HAZ GrabaApartado;         || Atribuible al Estado

     nGrupo    = 5;
     nSubGrupo = 2;
     nValor0   = #refer00@#49;
     |HAZ GrabaApartado;         || Sujetos Pasivos

     nGrupo    = 3;
     nSubGrupo = 9;
     nValor0   = #refer00@#45;
     |HAZ GrabaApartado;         || Entregas Intracomunitarias

     nGrupo    = 5;
     nSubGrupo = 6;
     nValor0   = #refer00@#44;
     |HAZ GrabaApartado;         || Compensacion

     nGrupo    = 3;
     nSubGrupo = 4;
     nValor0   = #refer03@#4;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 5;
     nValor0   = #refer03@#5;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 6;
     nValor0   = #refer03@#6;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 7;
     nValor0   = #refer03@#7;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 8;
     nValor0   = #refer03@#8;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 10;
     nValor0   = #refer00@#46;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 11;
     nValor0   = #refer00@#47;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 13;
     nValor0   = #refer03@#12;
     |HAZ GrabaApartado;

     nGrupo    = 3;
     nSubGrupo = 14;
     nValor0   = #refer03@#13;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 1;
     nValor0   = #refer03@#15;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 2;
     nValor0   = #refer03@#16;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 3;
     nValor0   = #refer03@#17;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 4;
     nValor0   = #refer03@#18;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 5;
     nValor0   = #refer00@#68;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 7;
     nValor0   = #refer03@#21;
     |HAZ GrabaApartado;

     nGrupo    = 4;
     nSubGrupo = 8;
     nValor0   = #refer03@#22;
     |HAZ GrabaApartado;

     |HAZ Totales;

     |CIERRA #dsmociva;

     enEmpresa     = nCodigoNue;
     enEjer        = #dspase03#4;
     enPeriodo     = nPeriodo;
     enModelo      = nModelo;
     enComplem     = 0;
     enActividad   = #agicen14#1;
     enTipoEntrada = 91;
     enDevolver    = #refer00@#51;
     enPregunta    = 1;

     |SUB_EJECUTA_NP ":modelos/dsmociva";
     enPregunta    = 0;

     #dspase25#0 = nModelo;
     #dspase25#1 = nPeriodo;
     #dspase25#2 = 0;
     #dspase25#3 = nCodigoNue;
     |LEE 101#dspase25.=;
     |SI FSalida ! 0;
         |DDEFECTO #dspase25;
         #dspase25#0 = nModelo;
         #dspase25#1 = nPeriodo;
         #dspase25#2 = 0;
         #dspase25#3 = nCodigoNue;
         |GRABA 020#dspase25.b;
     |FINSI;
     #dspase25#4 = #refer00@#50;
     |GRABA 020#dspase25.a;
     |LIBERA #dspase25;

     enEmpresa = nCodigoNue;
     enEjer    = #dspase03#4;
     enPeriodo = nPeriodo;
     enModelo  = nModelo;
     enComplem = 0;

     efFechaI  = #refer00@#5;
     |SI #refer00@#5 = "          ";  efFechaI  = "01.01.0000";  |FINSI;

     eaArchiva = "";
     |SI #refer00@#6 = "S";  eaArchiva = "X";  |FINSI;

     |SUB_EJECUTA "dspasuti;PonDatosPlaning";
|FPRC;

|DEFBUCLE eosma332;
     #refer00@#1005;
     ;
     00001, 0,    1, "M", nAnyo;
     99999, 9, #dspase03#5, "M", nAnyo;
     ;
     NULL, PasaModelo332;
|FIN;

|PROCESO Pase332;
     enModelo   = 332;
     enDEmpresa = #dspase03#9;
     enHEmpresa = #dspase03#10;

     |SUB_EJECUTA "dspasuti;BorraModelos";

     aDef = eaPathAnterior + "agieos/def/eosma332.mas";
     |CARGA_DEF aDef, refer00@;
     |SI FSalida ! 0;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agieos/def/eosactiv.mas";
     |CARGA_DEF aDef, refer01@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agieos/def/eosclien.mas";
     |CARGA_DEF aDef, refer02@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agieos/def/eosopes1.mas";
     |CARGA_DEF aDef, refer03@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer02@;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aFich = eaPathAnterior + "agieos/fich/";
     |PATH_DAT #refer00@#aFich#;
     |PATH_DAT #refer01@#aFich#;
     |PATH_DAT #refer02@#aFich#;
     |PATH_DAT #refer03@#aFich#;

     aAlfa   = #dspase03#4;
     aAlfa   = #dspase03#4 % -102;
     nAnyo   = aAlfa;

     |ABRE #refer01@;
     |ABRE #refer02@;
     |ABRE #refer03@;
     |ABRE #agicen14;
     |ABRE #dsmom002;
     |ABRE #agitab99;
     |BUCLE eosma332;
     |CIERRA #dsmom002;
     |CIERRA #agicen14;
     |CIERRA #refer01@;
     |CIERRA #refer02@;
     |CIERRA #refer03@;
     |CIERRA #refer03@;

     |DESCARGA_DEF #refer03@;
     |DESCARGA_DEF #refer02@;
     |DESCARGA_DEF #refer01@;
     |DESCARGA_DEF #refer00@;
|FPRC;

|| *************************************************************************
|| *************************************************************************
|| *************************************************************************
||               M O D E L O   3 4 9
|| *************************************************************************
|| *************************************************************************
|| *************************************************************************

|PROCESO CompruebaIva;
     nEsta = 0;
     |SI nPeriodo =  1; |O nPeriodo =  2; |O nPeriodo =  3; nDPer =  1; nHPer =  3; |FINSI;
     |SI nPeriodo =  4; |O nPeriodo =  5; |O nPeriodo =  6; nDPer =  4; nHPer =  6; |FINSI;
     |SI nPeriodo =  7; |O nPeriodo =  8; |O nPeriodo =  9; nDPer =  7; nHPer =  9; |FINSI;
     |SI nPeriodo = 10; |O nPeriodo = 11; |O nPeriodo = 12; nDPer = 10; nHPer = 12; |FINSI;

     |ABRE #dsmom008;
     |PARA nNume = nDPer; |SI nNume [ nHPer; |HACIENDO nNume = nNume + 1;
           #dsmom008#0   = nCodigoNue;
           #dsmom008#1   = #dspase03#4;
           #dsmom008#2   = nNume;
           #dsmom008#3   = nModelo;
           #dsmom008#4   = 0;
           #dsmom008#5   = #agicen14#1;
           |LEE 040#dsmom008.=;
           |SI FSalida = 0;  nEsta = 1; |SAL; |FINSI;
     |SIGUE;
     |CIERRA #dsmom008;

|FPRC;

|PROCESO SumaValor;
    nSuma = 0;
    |SI nNumValor = 0;
        nNumValor = 1; nSuma = 1;
    |SINO;
        |PARA nPara1 = 1; |SI nPara1 [ nNumValor; |HACIENDO nPara1 = nPara1 + 3;
              |SI nPara1 = 1;  |Y nNume2 = nValor2_R;  nSuma = 1;  |SAL; |FINSI;
              |SI nPara1 = 4;  |Y nNume2 = nValor5_R;  nSuma = 4;  |SAL; |FINSI;
              |SI nPara1 = 7;  |Y nNume2 = nValor8_R;  nSuma = 7;  |SAL; |FINSI;
              |SI nPara1 = 10; |Y nNume2 = nValor11_R; nSuma = 10; |SAL; |FINSI;
              |SI nPara1 = 13; |Y nNume2 = nValor14_R; nSuma = 13; |SAL; |FINSI;
              |SI nPara1 = 16; |Y nNume2 = nValor17_R; nSuma = 16; |SAL; |FINSI;
              |SI nPara1 = 19; |Y nNume2 = nValor20_R; nSuma = 19; |SAL; |FINSI;
        |SIGUE;
        |SI nSuma = 0;
            nNumValor = nNumValor + 3; nSuma = nNumValor;
            |SI nNumValor > 19; nSuma = 0; |FINSI;
        |FINSI;
   |FINSI;

   |SI nSuma = 1;
       nValor1_R = nValor1_R + nNume1;
       nValor2_R = nNume2;
       nValor3_R = nValor3_R + nNume3;
   |FINSI;
   |SI nSuma = 4;
       nValor4_R = nValor4_R + nNume1;
       nValor5_R = nNume2;
       nValor6_R = nValor6_R + nNume3;
   |FINSI;
   |SI nSuma = 7;
       nValor7_R = nValor7_R + nNume1;
       nValor8_R = nNume2;
       nValor9_R = nValor9_R + nNume3;
   |FINSI;
   |SI nSuma = 10;
       nValor10_R = nValor10_R + nNume1;
       nValor11_R = nNume2;
       nValor12_R = nValor12_R + nNume3;
   |FINSI;
   |SI nSuma = 13;
       nValor13_R = nValor13_R + nNume1;
       nValor14_R = nNume2;
       nValor15_R = nValor15_R + nNume3;
   |FINSI;
   |SI nSuma = 16;
       nValor16_R = nValor16_R + nNume1;
       nValor17_R = nNume2;
       nValor18_R = nValor18_R + nNume3;
   |FINSI;
   |SI nSuma = 19;
       nValor19_R = nValor19_R + nNume1;
       nValor20_R = nNume2;
       nValor21_R = nValor21_R + nNume3;
   |FINSI;

|FPRC;

|PROCESO Graba349;
     #dsmoc349#0 = #dsmom008#0;
     #dsmoc349#1 = #dsmom008#1;
     #dsmoc349#2 = #dsmom008#2;
     #dsmoc349#3 = #dsmom008#3;
     #dsmoc349#4 = #dsmom008#4;
     #dsmoc349#5 = #dsmom008#5;
     |SI #refer01@#4 = "E";  #dsmoc349#6 = "E";   |FINSI;
     |SI #refer01@#4 = "A";  #dsmoc349#6 = "A";   |FINSI;
     |SI #refer01@#4 = "R";  #dsmoc349#6 = "ER";  |FINSI;
     |SI #refer01@#4 = "X";  #dsmoc349#6 = "AR";  |FINSI;
     #dsmoc349#7  = #refer01@#6;
     #dsmoc349#25 = 0;
     #dsmoc349#26 = 0;

     |SI #refer01@#11 [ 80;
         |SI #dsmoc349#6 = "AR" |O  #dsmoc349#6 = "ER";
             #dsmoc349#25 = 2000 + #refer01@#11;
             #dsmoc349#26 = #refer01@#12;
         |FINSI;
     |FINSI;

     |SI #refer01@#11 > 80;
         |SI #dsmoc349#6 = "AR" |O  #dsmoc349#6 = "ER";
             #dsmoc349#25 = 1900 + #refer01@#11;
             #dsmoc349#26 = #refer01@#12;
         |FINSI;
     |FINSI;

     |LEE 101#dsmoc349.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmoc349;
         #dsmoc349#0 = #dsmom008#0;
         #dsmoc349#1 = #dsmom008#1;
         #dsmoc349#2 = #dsmom008#2;
         #dsmoc349#3 = #dsmom008#3;
         #dsmoc349#4 = #dsmom008#4;
         #dsmoc349#5 = #dsmom008#5;
         |SI #refer01@#4 = "E";  #dsmoc349#6 = "E";   |FINSI;
         |SI #refer01@#4 = "A";  #dsmoc349#6 = "A";   |FINSI;
         |SI #refer01@#4 = "R";  #dsmoc349#6 = "ER";  |FINSI;
         |SI #refer01@#4 = "X";  #dsmoc349#6 = "AR";  |FINSI;
         #dsmoc349#7 = #refer01@#6;
         #dsmoc349#25 = 0;
         #dsmoc349#26 = 0;

         |SI #refer01@#11 [ 80;
             |SI #dsmoc349#6 = "AR" |O  #dsmoc349#6 = "ER";
                 #dsmoc349#25 = 2000 + #refer01@#11;
                 #dsmoc349#26 = #refer01@#12;
             |FINSI;
         |FINSI;

         |SI #refer01@#11 > 80;
             |SI #dsmoc349#6 = "AR" |O  #dsmoc349#6 = "ER";
                 #dsmoc349#25 = 1900 + #refer01@#11;
                 #dsmoc349#26 = #refer01@#12;
             |FINSI;
         |FINSI;

         |GRABA 020#dsmoc349.b;
     |FINSI;

     #dsmoc349#8  = #refer01@#5;
     #dsmoc349#9  = #refer01@#7;
     #dsmoc349#10 = #refer01@#16;
     #dsmoc349#11 = #refer01@#17;
     #dsmoc349#12 = #refer01@#18;
     #dsmoc349#13 = #refer01@#19;
     #dsmoc349#14 = #refer01@#20;
     #dsmoc349#15 = #refer01@#21;
     #dsmoc349#16 = #refer01@#22;
     #dsmoc349#17 = #refer01@#23;
     #dsmoc349#18 = #refer01@#24;
     #dsmoc349#19 = #refer01@#25;
     #dsmoc349#20 = #refer01@#26;
     #dsmoc349#21 = #refer01@#27;
     #dsmoc349#22 = #refer01@#8;
     #dsmoc349#23 = #refer01@#13;
     #dsmoc349#24 = #refer01@#10;
     #dsmoc349#27 = #refer01@#28;

     |GRABA 020#dsmoc349.a;
     |LIBERA #dsmoc349;

     eaCodNif = #dsmoc349#7;
     |HAZ LeeNifs;

     |ABRE #regisnif@;
     #regisnif@#0 = #dsmoc349#7;
     |LEE 101#regisnif@.=;
     |SI FSalida ! 0;
         |DDEFECTO #regisnif@;
         #regisnif@#0 = #dsmoc349#7;
         #regisnif@#1 = #refer01@#7;
         #regisnif@#4 = #refer01@#5;
         |GRABA 020#regisnif@.n;
     |FINSI;
     |LIBERA #regisnif@;
     |CIERRA #regisnif@;
|FPRC;

|DEFBUCLE eos349li;
     #refer01@#1004;
     ;
     #refer00@#0, #refer00@#2, #refer00@#1, 001;
     #refer00@#0, #refer00@#2, #refer00@#1, 999;
     ;
     NULL, Graba349;
|FIN;

|PROCESO PasaModelo349Reo;
     |SI enEstaCambio = 1;
         nCodigoNue = 0;
         nCodigoReo = #refer00@#0;
         |BUCLE dspase15_300;
         |SI nCodigoNue = 0;  |ACABA;  |FINSI;
     |SINO;
         nCodigoNue = #refer00@#0;
     |FINSI;
     |SI nCodigoNue < #dspase03#9; |O nCodigoNue > #dspase03#10; |ACABA; |FINSI;

     |SI #dspase03#8 ! 1;
         #dspase99#0 = nCodigoNue;
         #dspase99#1 = 349;
         |LEE 101#dspase99.=;
         |SI FSalida ! 0;
             enDEmpresa = nCodigoNue;
             enHEmpresa = nCodigoNue;
             enModelo   = 349;
             |SUB_EJECUTA "dspasuti;BorraModelos";

             #dspase99#0 = nCodigoNue;
             #dspase99#1 = 349;
             |GRABA 020#dspase99.n;
             |LIBERA #dspase99;
         |FINSI;
     |FINSI;

     #refer02@#0 = nCodigoReo;
     |LEE 040#refer02@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer02@;  |FINSI;

     |SI #refer00@#18 ! "M";
         |SI #refer00@#1 = 0;  nPeriodo = 99;  |FINSI;
         |SI #refer00@#1 = 1;  nPeriodo = 3;   |FINSI;
         |SI #refer00@#1 = 2;  nPeriodo = 6;   |FINSI;
         |SI #refer00@#1 = 3;  nPeriodo = 9;   |FINSI;
         |SI #refer00@#1 = 4;  nPeriodo = 12;  |FINSI;
     |SINO;
         nPeriodo = #refer00@#1;
     |FINSI;

     nActiv = 0;
     |PARA;  |SI;  |HACIENDO;
          nActiv = nActiv + 1;
          #agicen14#0 = nCodigoNue;
          #agicen14#1 = nActiv;
          |LEE 101#agicen14.=;
          |SI FSalida = 0;
              nModelo = 300;  |HAZ CompruebaIva;  |SI nEsta = 1;  |SAL;  |FINSI;
              nModelo = 303;  |HAZ CompruebaIva;  |SI nEsta = 1;  |SAL;  |FINSI;
              nModelo = 370;  |HAZ CompruebaIva;  |SI nEsta = 1;  |SAL;  |FINSI;
              nModelo = 330;  |HAZ CompruebaIva;  |SI nEsta = 1;  |SAL;  |FINSI;
              nModelo = 320;  |HAZ CompruebaIva;  |SI nEsta = 1;  |SAL;  |FINSI;
              nModelo = 332;  |HAZ CompruebaIva;  |SI nEsta = 1;  |SAL;  |FINSI;
          |FINSI;

          |SI nActiv > 99;  nActiv = 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nActiv = 0;  |ACABA;  |FINSI;

     #agicen14#6 = "01.01.0000";

     nModelo = 349;

     #agitab99#0 = 349;
     |LEE 040#agitab99.=;
     |SI FSalida ! 0;  |DDEFECTO #agitab99;  |FINSI;

     #dsmom002#0 = nCodigoNue;
     #dsmom002#1 = 1;
     #dsmom002#2 = 349;
     |LEE 101#dsmom002.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmom002;
         #dsmom002#0  = nCodigoNue;
         #dsmom002#1  = 1;
         #dsmom002#2  = 349;
         |GRABA 020#dsmom002.b;
     |FINSI;

     #dsmom002#3  = #agitab99#1;
     #dsmom002#4  = #agitab99#2;
     #dsmom002#5  = #agitab99#3;
     #dsmom002#6  = #agicen14#4;
     #dsmom002#7  = "TRIMESTRAL";
     |SI #refer00@#18 = "M"; #dsmom002#7 = "MENSUAL"; |FINSI;
     #dsmom002#8  = #agicen14#5;
     #dsmom002#9  = #agicen14#6;
     #dsmom002#10 = 1;

     |GRABA 020#dsmom002.a;
     |LIBERA #dsmom002;

     |SI #agicen14#15 = "          ";  |O #agicen14#15 = "MODULOS   ";
          #agicen14#15 = "MANUAL";
     |FINSI;
     |GRABA 020#agicen14.a;
     |LIBERA #agicen14;

     enEmpresaA = nCodigoNue;
     enAnyo     = #dspase03#4;
     |SUB_EJECUTA_NP ":modelos/dsmoz001";

     |SI #refer00@#18 ! "M";
         |SI #refer00@#1 = 0;  nPeriodo = 99;  |FINSI;
         |SI #refer00@#1 = 1;  nPeriodo = 3;   |FINSI;
         |SI #refer00@#1 = 2;  nPeriodo = 6;   |FINSI;
         |SI #refer00@#1 = 3;  nPeriodo = 9;   |FINSI;
         |SI #refer00@#1 = 4;  nPeriodo = 12;  |FINSI;
     |SINO;
         nPeriodo = #refer00@#1;
     |FINSI;

     |ABRE #dsmom008;
     #dsmom008#0   = nCodigoNue;
     #dsmom008#1   = #dspase03#4;
     #dsmom008#2   = nPeriodo;
     #dsmom008#3   = nModelo;
     #dsmom008#4   = 0;
     #dsmom008#5   = #agicen14#1;
     |LEE 040#dsmom008.=;
     |SI FSalida ! 0;  |CIERRA #dsmom008;  |ACABA;  |FINSI;
     |CIERRA #dsmom008;

     #refer03@#0 = #refer00@#0;
     #refer03@#1 = 1;
     #refer03@#2 = #refer00@#2;
     |LEE 040#refer03@.=;
     |SI FSalida ! 0;  |DDEFECTO #refer03@;  |FINSI;

     |SI #refer03@#4 ! "E";  |Y #refer03@#4 ! "P";
      |Y #refer03@#4 ! "A";  |Y #refer03@#4 ! " ";
         #refer03@#4 = "O";
         #refer03@#5 = "9999";
     |FINSI;

     |ABRE #dsmoc349;
     |BUCLE eos349li;
     |CIERRA #dsmoc349;

     enEmpresa     = nCodigoNue;
     enEjer        = #dspase03#4;
     enPeriodo     = nPeriodo;
     enModelo      = nModelo;
     enComplem     = 0;
     enActividad   = #agicen14#1;
     enTipoEntrada = 96;

     |SUB_EJECUTA_NP ":modelos/dsmoc349";

     #dspase25#0 = enModelo;
     #dspase25#1 = enPeriodo;
     #dspase25#2 = enComplem;
     #dspase25#3 = enEmpresa;
     |LEE 101#dspase25.=;
     |SI FSalida ! 0;
         |DDEFECTO #dspase25;
         #dspase25#0 = enModelo;
         #dspase25#1 = enPeriodo;
         #dspase25#2 = enComplem;
         #dspase25#3 = enEmpresa;
         |GRABA 020#dspase25.b;
     |FINSI;
     #dspase25#4 = #refer00@#7 + #refer00@#9 + #refer00@#14 + #refer00@#15;
     |GRABA 020#dspase25.a;
     |LIBERA #dspase25;

     efFechaI  = #refer00@#4;
     |SI #refer00@#4 = "          ";  efFechaI  = "01.01.0000";  |FINSI;

     eaArchiva = "";
     |SI #refer00@#5 = "S";  eaArchiva = "X";  |FINSI;

     |SUB_EJECUTA "dspasuti;PonDatosPlaning";
|FPRC;

|DEFBUCLE eos349ca;
     #refer00@#1003;
     ;
     00001, nAnyo, 0;
     99999, nAnyo, #dspase03#5;
     ;
     NULL, PasaModelo349Reo;
|FIN;

|PROCESO Pase349Reo;
     aDef = eaPathAnterior + "agieos/def/eos349ca.mas";
     |CARGA_DEF aDef, refer00@;
     |SI FSalida ! 0;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agieos/def/eos349li.mas";
     |CARGA_DEF aDef, refer01@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agieos/def/eosclien.mas";
     |CARGA_DEF aDef, refer02@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agieos/def/eosactiv.mas";
     |CARGA_DEF aDef, refer03@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer02@;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aFich = eaPathAnterior + "agieos/fich/";
     |PATH_DAT #refer00@#aFich#;
     |PATH_DAT #refer01@#aFich#;
     |PATH_DAT #refer02@#aFich#;
     |PATH_DAT #refer03@#aFich#;

     aAlfa   = #dspase03#4;
     aAlfa   = #dspase03#4 % -102;
     nAnyo   = aAlfa;

     |ABRE #refer01@;
     |ABRE #refer02@;
     |ABRE #refer03@;
     |ABRE #agicen14;
     |ABRE #dsmom002;
     |ABRE #agitab99;
     |BUCLE eos349ca;
     |CIERRA #dsmom002;
     |CIERRA #agicen14;
     |CIERRA #refer01@;
     |CIERRA #refer02@;
     |CIERRA #refer03@;
     |CIERRA #refer03@;

     |DESCARGA_DEF #refer03@;
     |DESCARGA_DEF #refer02@;
     |DESCARGA_DEF #refer01@;
     |DESCARGA_DEF #refer00@;
|FPRC;

|PROCESO Graba349_Cont;
     #dsmoc349#0 = #dsmom008#0;
     #dsmoc349#1 = #dsmom008#1;
     #dsmoc349#2 = #dsmom008#2;
     #dsmoc349#3 = #dsmom008#3;
     #dsmoc349#4 = #dsmom008#4;
     #dsmoc349#5 = #dsmom008#5;
     |SI #refer02@#4 = "E";  #dsmoc349#6 = "E";   |FINSI;
     |SI #refer02@#4 = "A";  #dsmoc349#6 = "A";   |FINSI;
     |SI #refer02@#4 = "R";  #dsmoc349#6 = "ER";  |FINSI;
     |SI #refer02@#4 = "X";  #dsmoc349#6 = "AR";  |FINSI;
     #dsmoc349#7  = #refer02@#6;
     #dsmoc349#25 = 0;
     #dsmoc349#26 = 0;

     |SI #refer02@#11 [ 80;
         |SI #dsmoc349#6 = "AR" |O  #dsmoc349#6 = "ER";
             #dsmoc349#25 = 2000 + #refer02@#11;
             #dsmoc349#26 = #refer02@#12;
         |FINSI;
     |FINSI;

     |SI #refer02@#11 > 80;
         |SI #dsmoc349#6 = "AR" |O  #dsmoc349#6 = "ER";
             #dsmoc349#25 = 1900 + #refer02@#11;
             #dsmoc349#26 = #refer02@#12;
         |FINSI;
     |FINSI;

     |LEE 101#dsmoc349.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmoc349;
         #dsmoc349#0 = #dsmom008#0;
         #dsmoc349#1 = #dsmom008#1;
         #dsmoc349#2 = #dsmom008#2;
         #dsmoc349#3 = #dsmom008#3;
         #dsmoc349#4 = #dsmom008#4;
         #dsmoc349#5 = #dsmom008#5;
         |SI #refer02@#4 = "E";  #dsmoc349#6 = "E";   |FINSI;
         |SI #refer02@#4 = "A";  #dsmoc349#6 = "A";   |FINSI;
         |SI #refer02@#4 = "R";  #dsmoc349#6 = "ER";  |FINSI;
         |SI #refer02@#4 = "X";  #dsmoc349#6 = "AR";  |FINSI;
         #dsmoc349#7  = #refer02@#6;
         #dsmoc349#25 = 0;
         #dsmoc349#26 = 0;

         |SI #refer02@#11 [ 80;
             |SI #dsmoc349#6 = "AR" |O  #dsmoc349#6 = "ER";
                 #dsmoc349#25 = 2000 + #refer02@#11;
                 #dsmoc349#26 = #refer02@#12;
             |FINSI;
         |FINSI;

         |SI #refer02@#11 > 80;
             |SI #dsmoc349#6 = "AR" |O  #dsmoc349#6 = "ER";
                 #dsmoc349#25 = 1900 + #refer02@#11;
                 #dsmoc349#26 = #refer02@#12;
             |FINSI;
         |FINSI;

         |GRABA 020#dsmoc349.b;
     |FINSI;

     #dsmoc349#8  = #refer02@#5;
     #dsmoc349#9  = #refer02@#7;
     #dsmoc349#10 = #refer02@#8;
     #dsmoc349#22 = #refer02@#8;
     #dsmoc349#23 = #refer02@#13;
     #dsmoc349#24 = #refer02@#10;

     |SI nTCampo ] 16;  #dsmoc349#27 = #refer02@#16;  |FINSI;

     |GRABA 020#dsmoc349.a;
     |LIBERA #dsmoc349;

     eaCodNif = #dsmoc349#7;
     |HAZ LeeNifs;

     |ABRE #regisnif@;
     #regisnif@#0 = #dsmoc349#7;
     |LEE 101#regisnif@.=;
     |SI FSalida ! 0;
         |DDEFECTO #regisnif@;
         #regisnif@#0 = #dsmoc349#7;
         #regisnif@#1 = #refer02@#7;
         #regisnif@#4 = #refer02@#5;
         |GRABA 020#regisnif@.n;
     |FINSI;
     |LIBERA #regisnif@;
     |CIERRA #regisnif@;
|FPRC;

|DEFBUCLE camal349;
     #refer02@#1004;
     ;
     #refer00@#0, #refer00@#2, #refer00@#1, 001;
     #refer00@#0, #refer00@#2, #refer00@#1, 999;
     ;
     NULL, Graba349_Cont;
|FIN;

|PROCESO PasaModelo349Conta;
     |SI enEstaCambio = 1;
         nCodigoNue  = 0;
         nCodigoCont = #refer00@#0;
         |BUCLE dspase15_Cont300;
         |SI nCodigoNue = 0;  |ACABA;  |FINSI;
     |SINO;
         nCodigoNue = #refer00@#0;
     |FINSI;
     |SI nCodigoNue < #dspase03#9; |O nCodigoNue > #dspase03#10; |ACABA; |FINSI;

     |SI #dspase03#8 ! 1;
         #dspase99#0 = nCodigoNue;
         #dspase99#1 = 349;
         |LEE 101#dspase99.=;
         |SI FSalida ! 0;
             enDEmpresa = nCodigoNue;
             enHEmpresa = nCodigoNue;
             enModelo   = 349;
             |SUB_EJECUTA "dspasuti;BorraModelos";

             #dspase99#0 = nCodigoNue;
             #dspase99#1 = 349;
             |GRABA 020#dspase99.n;
             |LIBERA #dspase99;
         |FINSI;
     |FINSI;

     |SI #refer00@#16 ! "M";
         |SI #refer00@#1 = 0;  nPeriodo = 99;  |FINSI;
         |SI #refer00@#1 = 1;  nPeriodo = 3;   |FINSI;
         |SI #refer00@#1 = 2;  nPeriodo = 6;   |FINSI;
         |SI #refer00@#1 = 3;  nPeriodo = 9;   |FINSI;
         |SI #refer00@#1 = 4;  nPeriodo = 12;  |FINSI;
     |SINO;
         nPeriodo = #refer00@#1;
     |FINSI;

     |ABRE #dsmom004;
     #dsmom004#0   = nCodigoNue;
     #dsmom004#1   = #dspase03#4;
     #dsmom004#2   = nPeriodo;
     #dsmom004#3   = 349;
     #dsmom004#4   = 0;
     |LEE 040#dsmom004.=;
     |SI FSalida  = 0;  |Y #dsmom004#7 = "X";
         |CIERRA #dsmom004;
         |ACABA;
     |FINSI;
     |CIERRA #dsmom004;

     |ABRE #agicen14;
     #agicen14#0 = nCodigoNue;
     #agicen14#1 = 1;
     |LEE 101#agicen14.=;
     |SI FSalida ! 0;
         |CIERRA #agicen14;
         |ACABA;
     |FINSI;

     #agicen14#6 = "01.01.0000";

     nModelo = 349;

     #agitab99#0 = 349;
     |LEE 040#agitab99.=;
     |SI FSalida ! 0;  |DDEFECTO #agitab99;  |FINSI;

     #dsmom002#0 = nCodigoNue;
     #dsmom002#1 = 1;
     #dsmom002#2 = 349;
     |LEE 101#dsmom002.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmom002;
         #dsmom002#0  = nCodigoNue;
         #dsmom002#1  = 1;
         #dsmom002#2  = 349;
         |GRABA 020#dsmom002.b;
     |FINSI;

     #dsmom002#3  = #agitab99#1;
     #dsmom002#4  = #agitab99#2;
     #dsmom002#5  = #agitab99#3;
     #dsmom002#6  = #agicen14#4;
     #dsmom002#7  = "TRIMESTRAL";
     |SI #refer00@#16 = "M"; #dsmom002#7 = "MENSUAL"; |FINSI;
     #dsmom002#8  = #agicen14#5;
     #dsmom002#9  = #agicen14#6;
     #dsmom002#10 = 1;

     |GRABA 020#dsmom002.a;
     |LIBERA #dsmom002;

     |SI #agicen14#15 = "          ";  |O #agicen14#15 = "MODULOS   ";
          #agicen14#15 = "REGISTROS";
     |FINSI;
     |GRABA 020#agicen14.a;
     |LIBERA #agicen14;

     enEmpresaA = nCodigoNue;
     enAnyo     = #dspase03#4;
     |SUB_EJECUTA_NP ":modelos/dsmoz001";

     |SI #refer00@#16 ! "M";
         |SI #refer00@#1 = 0;  nPeriodo = 99;  |FINSI;
         |SI #refer00@#1 = 1;  nPeriodo = 3;   |FINSI;
         |SI #refer00@#1 = 2;  nPeriodo = 6;   |FINSI;
         |SI #refer00@#1 = 3;  nPeriodo = 9;   |FINSI;
         |SI #refer00@#1 = 4;  nPeriodo = 12;  |FINSI;
     |SINO;
         nPeriodo = #refer00@#1;
     |FINSI;

     |ABRE #dsmom008;
     #dsmom008#0   = nCodigoNue;
     #dsmom008#1   = #dspase03#4;
     #dsmom008#2   = nPeriodo;
     #dsmom008#3   = nModelo;
     #dsmom008#4   = 0;
     #dsmom008#5   = #agicen14#1;
     |LEE 040#dsmom008.=;
     |SI FSalida ! 0;  |CIERRA #dsmom008;  |ACABA;  |FINSI;
     |CIERRA #dsmom008;

     |ABRE #dsmoc349;
     |BUCLE camal349;
     |CIERRA #dsmoc349;

     enEmpresa     = nCodigoNue;
     enEjer        = #dspase03#4;
     enPeriodo     = nPeriodo;
     enModelo      = nModelo;
     enComplem     = 0;
     enActividad   = #agicen14#1;
     enTipoEntrada = 96;

     |SUB_EJECUTA_NP ":modelos/dsmoc349";

     #dspase25#0 = enModelo;
     #dspase25#1 = enPeriodo;
     #dspase25#2 = enComplem;
     #dspase25#3 = enEmpresa;
     |LEE 101#dspase25.=;
     |SI FSalida ! 0;
         |DDEFECTO #dspase25;
         #dspase25#0 = enModelo;
         #dspase25#1 = enPeriodo;
         #dspase25#2 = enComplem;
         #dspase25#3 = enEmpresa;
         |GRABA 020#dspase25.b;
     |FINSI;
     #dspase25#4 = #refer00@#7 + #refer00@#9 + #refer00@#14 + #refer00@#15;
     |GRABA 020#dspase25.a;
     |LIBERA #dspase25;

     efFechaI  = #refer00@#4;
     |SI #refer00@#4 = "          ";  efFechaI  = "01.01.0000";  |FINSI;

     eaArchiva = "";
     |SI #refer00@#5 = "S";  eaArchiva = "X";  |FINSI;

     |SUB_EJECUTA "dspasuti;PonDatosPlaning";
|FPRC;

|DEFBUCLE camac349;
     #refer00@#1003;
     ;
     00001, 00, 0;
     99999, 99, #dspase03#5;
     ;
     NULL, PasaModelo349Conta;
|FIN;

|PROCESO MiraEmpresa349;
     aDef = eaPathAnterior + "agicont/def/camac349.mas";
     |CARGA_DEF aDef, refer00@;
     |SI FSalida ! 0;
         |ACABA;
     |FINSI;

     aDef = eaPathAnterior + "agicont/def/camal349.mas";
     |CARGA_DEF aDef, refer02@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer02@;
         |ACABA;
     |FINSI;

     aQueQuiero = "|NC";
     aCampos    = #refer02@#aQueQuiero#;
     nTCampo    = aCampos;
     nTCampo    = nTCampo - 1;

     aFich = eaPathAnterior + "agicont/fich/" + (("00000" + #refer01@#2) % -105) + #refer01@#3 + "/";
     |PATH_DAT #refer00@#aFich#;
     |PATH_DAT #refer02@#aFich#;

     aAlfa   = #dspase03#4;
     aAlfa   = #dspase03#4 % -102;
     nAnyo   = aAlfa;

     |ABRE #agicen14;
     |ABRE #dsmom002;
     |ABRE #agitab99;
     |BUCLE camac349;
     |CIERRA #dsmom002;
     |CIERRA #agicen14;

     |DESCARGA_DEF #refer02@;
     |DESCARGA_DEF #refer00@;
|FPRC;

|DEFBUCLE canempre_349;
     #refer01@#1002;
     26;
     00000, 0, nAnyo;
     99999, 9, nAnyo;
     ;
     NULL, MiraEmpresa349;
|FIN;

|PROCESO Pase349Conta;
     aDef = eaPathAnterior + "agicont/def/canempre.mas";
     |CARGA_DEF aDef, refer01@;
     |SI FSalida ! 0;
         |ACABA;
     |FINSI;

     aFich = eaPathAnterior + "agicont/fich/";
     |PATH_DAT #refer01@#aFich#;

     aAlfa   = #dspase03#4;
     aAlfa   = #dspase03#4 % -102;
     nAnyo   = aAlfa;

     |BUCLE canempre_349;

     |DESCARGA_DEF #refer01@;
|FPRC;

|PROCESO Pase349;
     enModelo = 349;
     enDEmpresa = #dspase03#9;
     enHEmpresa = #dspase03#10;

     |SI #dspase03#8 = 1;
         |SUB_EJECUTA "dspasuti;BorraModelos";
     |FINSI;

     |SI #dspase03#8 = 1;  |O #dspase03#8 = 3;
         |HAZ Pase349Conta;
     |FINSI;

     |SI #dspase03#8 = 1;  |O #dspase03#8 = 2;
         |HAZ Pase349Reo;
     |FINSI;
|FPRC;

|PROCESO PaseIva;
     enSwCompensa = 1;
     |SI #dspase03#0 = 300;  |HAZ Pase300;  |FINSI;
     |SI #dspase03#0 = 303;  |HAZ Pase303;  |FINSI;
     |SI #dspase03#0 = 320;  |HAZ Pase320;  |FINSI;
     |SI #dspase03#0 = 330;  |HAZ Pase330;  |FINSI;
     |SI #dspase03#0 = 332;  |HAZ Pase332;  |FINSI;
     |SI #dspase03#0 = 349;  |HAZ Pase349;  |FINSI;
     enSwCompensa = 0;
|FPRC;
