|FICHEROS;
     socw0005;

     agim0025;
|FIN;

|VARIABLES;
     nHay           = 0;

     aAlfa          = "";

     &enReg         = 0;
     &eaVarDni      = "";
     &enCalcCif     = 0;
     &eaCta         = "";
|FIN;

|INCLUYE i_agicon;

|PROCESO Tipo12Fsocw5;  |TIPO 12;
     |SI #socw0005#12 = "M";
         |SI #socw0005#10 ! 0;
             |MENAV "0000El total de pagos debe ser cero.";
             |POSICIONATE #socw0005#10;
             |ERROR;
         |FINSI;
     |FINSI;

     |SI #socw0005#12 ! "M";
         |SI #socw0005#10 = 0;
             |MENAV "0000Introduzca el n£mero de pagos.";
             |POSICIONATE #socw0005#10;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO agim0025;
     #socw0005#4  = #agim0025#4;   |PINTA #socw0005#4;

     nHay = 1;
     |ERROR10;
|FPRC;

|DEFBUCLE agim0025;
     #agim0025#1;
     3;
     #socw0005#0, enReg, 001, #socw0005#3;
     #socw0005#0, enReg, 999, #socw0005#3;
     ;
     NULL, agim0025;
|FIN;

|PROCESO PtecFinal;
     |SI FSalida = 1;  |ACABA;  |FINSI;

     |POSICIONATE #socw0005#2;
|FPRC;

|PROCESO Tipo0CuentasFw5; |TIPO 6;
     eaCta = #socw0005#Campo#;
     |HAZ MFiltraPtos;
     #socw0005#Campo# = eaCta;
     |PINTA #socw0005#Campo#;
|FPRC;

|PROCESO Tipo0C14Fsocw5;  |TIPO 0;
     |C_M #socw0005#14, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |C_M #socw0005#19, 1, "S";

     |SI #socw0005#14 = 0;
         |C_M #socw0005#19, 1, "N";
         #socw0005#19 = "";
     |FINSI;

     |PINTA #socw0005#19;
|FPRC;

|PROCESO Tipo0C12Fsocw5;  |TIPO 0;
     |C_M #socw0005#12, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |C_M #socw0005#13, 1, "S";

     |SI #socw0005#12 = "M";
         |SI #socw0005#10 ! 0;
             |MENAV "0000El total de pagos debe ser cero.";
             |POSICIONATE #socw0005#10;
         |FINSI;

         |C_M #socw0005#13, 1, "N";
         #socw0005#13 = "N";
         |PINTA #socw0005#13;
     |FINSI;

     |SI #socw0005#12 ! "M";
         |SI #socw0005#10 = 0;
             |MENAV "0000Introduzca el n£mero de pagos.";
             |POSICIONATE #socw0005#10;
         |FINSI;

         |SI #socw0005#12 = "F";
             |SI #socw0005#11 = 0;
                 |MENAV "0000Con el tipo de c lculo Frances el tipo de inter‚s no puede ser cero.";
                 |POSICIONATE #socw0005#11;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0C3Fsocw5;  |TIPO 0;
     |C_M #socw0005#3, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     nHay = 0;
     |BUCLE agim0025;

     |SI nHay = 0;
         |MENAV "0000No existe el administrador en la ficha de sociedades, por favor informelo alli primero.";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tipo6C3Fsocw5;  |TIPO 6;
     |SI FSalida = 10;
         eaVarDni  = #socw0005#3;
         enCalcCif = 1;
         |HAZ CalculoDNI;
         #socw0005#3 = eaVarDni;
         |PINTA #socw0005#3;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #socw0005#3;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 112;
     |SI #socw0005#3 ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #socw0005#3 = eaVarDni;
             |PINTA #socw0005#3;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Bajam025;
     #agim0025#0 = #socw0005#0
     #agim0025#1 = enReg;
     #agim0025#2 = 01;
|FPRC;

|PROCESO Altam025;
     #agim0025#0 = #socw0005#0
     #agim0025#1 = enReg;
     #agim0025#2 = 999;
|FPRC;

|PROCESO Tipo66C3Fsocw5;  |TIPO 66;
     |ABRE #agim0025;
     |CONSULTA_F_CLAVE #1#agim0025, Bajam025, Altam025;
     |SI FSalida = 0;
         #socw0005#3 = #agim0025#3;
         |PINTA #socw0005#3;
     |FINSI;
     |CIERRA #agim0025;
|FPRC;

|PROCESO Tipo0C6Fsocw5; |TIPO 0;
     |SI #socw0005#6 [ "01.01.2000";
         |MENAV "0000Fecha incorrecta.";
         |ERROR;
     |FINSI;
|FPRC;
