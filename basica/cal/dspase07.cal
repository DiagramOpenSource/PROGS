|FICHEROS;
     dspase00 #0;
     dspase07 #7;
     dspase15 #15;
     dspase86 #86;
     dspase87 #87;
     dspase88 #88;
     dspase89 #89;
     dspase90 #90;
     dspase91 #91,MANTE;
     dspase92 #92,MANTE;

     :/contagen/def/canempre #200;
     :/contagen/def/camoneda #203;
     :/contagen/def/cam00014 #214;
     :/basica/def/agifigen   #201;
     :/integral/def/dsam0000 #202;
     :/basica/def/agicen14   #114;
     :/basica/def/zmonedas   #204;
     :/modelos/def/dsmom030  #30;
     :/modelos/def/dsmow123  #123;

     :/modelos/def/dsmom040  #40;
     :/modelos/def/dsmom041  #41;
     :/modelos/def/dsmom042  #42;

     refer00@ #900;
     refer01@ #901;
     refer02@ #902;
     refer03@ #903;
     refer04@ #904;
     refer05@ #905;
     refer06@ #906;
     refer07@ #907;
|FIN;

|VARIABLES;
     nCampo2         = 0;
     nTecla          = 0;
     nLinea          = 0;
     nLinea24        = 0;
     nLineaA         = 0;
     nDig1           = 0;
     nDig3           = 0;
     nDig4           = 0;
     nDig5           = 0;
     nDig6           = 0;
     nDig7           = 0;
     nDig8           = 0;
     nDig9           = 0;
     nDigito         = 0;
     nDigitoH        = 0;
     nSw             = 0;
     nSwCuenta       = 0;
     nLong           = 0;
     nPos            = 0;
     nRegistro       = 0;
     nCliente        = 0;
     nBase           = 0;
     nActividad      = 0;
     nNumFacturas    = 0;
     nTotalFact      = 0;
     nPorceIva       = 0;
     nTotalIva       = 0;
     nAcumulador     = 0;
     nLibro          = 0;
     nTrimestre      = 0;
     nSwChequeo      = 0;
     nSwChequeo1     = 0;
     nEmpresa        = 0;
     nNume           = 0;
     nConceptoC      = 0;
     nConceptoA      = 0;
     nConceptoV      = 0;
     nCodigoNue      = 0;
     nCodigoReo      = 0;
     nEstaCambio     = 0;
     nRedondeo       = 0;
     nConversor      = 0;
     nRedonMod       = 0;
     nConverMod      = 0;
     nAnyoCompra     = 0;

     aPathAgicont    = "";
     aPathAnterior   = "";
     aPathDefFiscal  = "";
     aPathFichFiscal = "";
     aPathDestino    = "";
     aDef            = "";
     aDirEmpresa     = "";
     aDirFichDestino = "";
     aDirFichOrigen  = "";
     aFichero        = "";
     aAlfa           = "";
     aAlfa1          = "";
     aAlfa2          = "";
     aAlfa3          = "";
     aCuenta         = "";
     aCuentaH        = "";
     aSerie          = "";
     aTipoIva        = "";
     aTipoLibro      = "";
     aConfi          = "";
     aNombre         = "";
     aNif            = "";
     aFactura        = "";
     aSubDepar       = "";
     aMonedaAgieos   = "";

     aCampo02        = "";
     aCampo03        = "";
     aCampo04        = "";
     aCampo05        = "";
     aCampo06        = "";
     aCampo07        = "";
     aCampo08        = "";
     aCampo09        = "";
     aCampo10        = "";
     aCampo11        = "";
     aCampo12        = "";
     aCampo13        = "";
     aCampo14        = "";
     aCampo15        = "";
     aCampo16        = "";
     aCampo17        = "";
     aCampo18        = "";
     aCampo19        = "";
     aCampo20        = "";
     aCampo21        = "";
     aCampo22        = "";
     aCampo23        = "";
     aCampo24        = "";
     aCampo25        = "";
     aCampo26        = "";
     aCampo27        = "";
     aPathPases      = "";
     aBase           = "";
     aOrigen         = "";
     aDestino        = "";

     fFecha          = "";

     &any_pos        = 0;
     &eaExterno      = "";
     &enEmpreOri     = 0;
     &enPerioOri     = 0;
     &eaCopiar       = "";
     &eaCeros        = "";

     &eaPathContagen = "";
     &eaPathBasica   = "";
     &eaPathDsmodelo = "";
     &eaPathIntegral = "";
     &eaPathAgitool  = "";
     &eaFAsiento     = "";
     &enEmpresa      = 0;
     &enPerConta     = 0;
     &eaNombreEmp    = "";
     &enTipoAct      = 0;
     &enDesdeOtra    = 0;
     &eaEmpresa      = "";
     &eaBase         = "";
     &eaAplica       = "";
     &enForzar       = 0;
     &eaMoneda       = "";

     &enEmprEos      = 0;
     &swSinCheq      = 0;
     &enTipoEos      = 0;
     &eaEmprEos      = "";
     nEjer           = 0;
|FIN;

|| ______________________ PROCESOS DE DATOS POR PANTALLA  ___________________

|PROCESO Empresa;
     |ABRE #200;
     #200#2 = #7#2;
     #200#3 = #7#3;
     |LEE 040#200=;
     |SI FSalida ! 0;
         |MENAV "     No existe la Empresa Patron de Copia.";
         |PTEC 808;
     |FINSI;
     |CIERRA #200;
|FPRC;

|PROCESO Diario;
     aDirEmpresa      = (("00000" + #7#2) % -105) + #7#3 + "/";
     aDirFichDestino = aPathDestino + "fich/" + aDirEmpresa;

     aDef            = aPathDestino + "def/camandia";
     |CARGA_DEF aDef, refer00@;
     |SI FSalida ! 0;
         |MENAV "     Error en Cargar el Def camandia.mas";
         |PTEC 807;
         |ACABA;
     |FINSI;

     |PATH_DAT #900 aDirFichDestino;

     |ABRE #900;
     #900#0 = #7#6;
     |LEE 040#900=;
     |SI FSalida ! 0;
         |MENAV "       No existe el Diario";
         |ERROR;
     |SINO;
         #7#7 = #900#1;
         |PINTA #7#7;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #refer00@;
|FPRC;

|| PROCESOS DEL DSPASE92 *************************************

|PROCESO Tipo11w92;  |TIPO 11;
     nTecla = FSalida;

     |SI nTecla = 10;
         |PUSHV 0501 2380;
         |CUADRO 0820 1870;
         |BLANCO 0921 1769;
         |ATRI S;
         |PINTA 0921, "             !!! ATENCION ннн                    ";
         |ATRI s;

         |ATRI I;
         |PINTA 1121, " Debes borrar antes la Empresa de Contabilidad o ";
         |PINTA 1221, "bien borrar todos los asientos  que  se  han     ";
         |PINTA 1321, "generado en el pase anterior, ya que si no lo    ";
         |PINTA 1421, "hacemos tendremos los datos duplicados.          ";
         |ATRI i;

         |PINTA 1740, "Conforme S/N : ";
         E_sup  = "1";
         E_inf  = "SN";
         aConfi = "N";
         aConfi = 1755 ? 1;
         |SI aConfi = "S";
             #91#0 = #92#0;
             #91#1 = #92#1;
             #91#2 = #92#2;
             #91#3 = "N";
             #91#4 = 0;
             #91#5 = #92#4;
             |GRABA 020#91n;
             |LIBERA #91;

             |LEE 101#92=;
             |BORRA 020#92a;
             |LIBERA #92;

             |PONCONTROL 23, "SI";
         |FINSI;

         |POPV;
     |FINSI;
|FPRC;

|| PROCESOS DEL DSPASE91 *************************************

|PROCESO ChequeaEmpresa;

     |SI aPathAgicont = "";  |ACABA;  |FINSI;

     aDirFichOrigen  = aPathAnterior + "agicont/fich/";
     aDef            = aPathAnterior + "agicont/def/canempre.mas";
     |CARGA_DEF aDef, refer06@;
     |SI FSalida ! 0;
         |MENAV "     Error en Cargar el Def canempre.mas";
         |ACABA;
     |FINSI;

     aDirFichDestino = aPathDestino + "fich/";
     aDef            = aPathDestino + "def/canempre";
     |CARGA_DEF aDef, refer07@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #refer06@;
         |MENAV "     Error en Cargar el Def canempre.mas";
         |ACABA;
     |FINSI;

     |PATH_DAT #906 aDirFichOrigen;
     |PATH_DAT #907 aDirFichDestino;

     |ABRE #906;
     #906#2 = #91#5;
     #906#3 = #7#0;
     |LEE 040#906=;
     |SI FSalida = 0;
         |ABRE #907;
         #907#2 = #91#1;
         #907#3 = #7#0;
         |LEE 040#907=;
         |SI FSalida ! 0;
             nSwChequeo  = 1;
             nSwChequeo1 = 1;
         |FINSI;
         |CIERRA #907;
     |FINSI;
     |CIERRA #906;

     |DESCARGA_DEF #refer07@;
     |DESCARGA_DEF #refer06@;
|FPRC;

|PROCESO PonAlfa;
     nSwChequeo  = 0;
     |SI aAlfa = "S";
         |HAZ ChequeaEmpresa;
     |FINSI;

     |SI nSwChequeo = 0;
         #91#3 = aAlfa;
         |GRABA 020#91a;
         |LIBERA #91;
     |FINSI;
|FPRC;

|DEFBUCLE dspase91E;
     #91#1;
     ;
     0, 00000, 0;
     0, 99999, 0;
     be;
     NULL, PonAlfa;
|FIN;

|PROCESO Tipo11w91;  |TIPO 11;
     nTecla = FSalida;

     |SI nTecla = 10;
         |LEE 101#91=;
         |SI #91#3 = "S";
             #91#3 = "N";
         |SINO;
             nSwChequeo  = 0;
             nSwChequeo1 = 0;
             |HAZ ChequeaEmpresa;
             |SI nSwChequeo = 0;
                 #91#3 = "S";
             |SINO;
                 |MENAV "    La Empresa existe en la Contabilidad Anterior y aun no se ha pasado a la Actual";
             |FINSI;
         |FINSI;
         |PINTA #91#3;

         |GRABA 020#91a;
         |LIBERA #91;
     |FINSI;

     |SI nTecla = 11;
         nSwChequeo1 = 0;
         aAlfa       = "S";
         |BUCLE dspase91E;
         |SI nSwChequeo1 = 1;
             |MENAV "    No se han marcado algunas empresas, porque no se ha hecho el pase de Contabilidad";
         |FINSI;
         |PONCONTROL 23, "SI";
         |PTEC 812;
     |FINSI;

     |SI nTecla = 12;
         nSwChequeo = 0;
         aAlfa      = "N";
         |BUCLE dspase91E;
         |PONCONTROL 23, "SI";
         |PTEC 812;
     |FINSI;

     |SI nTecla = 13;
         |ENTLINEAL #1#92, -2, 4, 22, 0, ClaveBaja92, ClaveAlta92;
     |FINSI;
|FPRC;

||________________ PROCESOS DE GRABACION DE AMORTIZACIONES _______________

|RUTINA ClaveBaja92;
     #92#0 = 0;
     #92#1 = 99999;
     #92#3 = 0;
|FRUT;

|RUTINA ClaveAlta92;
     #92#0 = 0;
     #92#1 = 00000;
     #92#3 = 0;
|FRUT;

|RUTINA ClaveBaja91;
     #91#0 = 0;
     #91#1 = 00000;
     #91#4 = 0;
|FRUT;

|RUTINA ClaveAlta91;
     #91#0 = 0;
     #91#1 = 99999;
     #91#4 = 0;
|FRUT;

|PROCESO CreaEmpresa;
     |ABRE #201;
     #201#0 = #91#1;
     |LEE 101#201=;
     |SI FSalida = 0;
         #201#23 = "S";
         |GRABA 020#201a;
     |SINO;
         |DDEFECTO #201;
     |FINSI;
     |LIBERA #201;
     |CIERRA #201;

     |SI eaPathIntegral ! "";
         |ABRE #202;
         #202#0 = #91#1;
         |LEE 101#202=;
         |SI FSalida = 0;
             #202#65 = "S";
             |GRABA 020#202a;
         |FINSI;
         |LIBERA #202;
         |CIERRA #202;
     |FINSI;

     #200#2 = #7#2;
     #200#3 = #7#3;
     |LEE 040#200=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #114;
     #114#0 = #91#1;
     #114#1 = 1;
     |LEE 040#114];
     |SI FSalida ! 0;  |O #114#0 ! #91#1;
         |DDEFECTO #114;
     |FINSI;
     |CIERRA #114;

     #200#2  = #91#1;
     #200#3  = #7#0;
     #200#0  = (#200#2 * 10) + #200#3;
     #200#1  = #201#1;
     #200#4  = #201#1;
     #200#5  = #201#4;
     aAlfa   = (("00" + #201#9) % -102) + (("000" + #201#10) % -103);
     #200#6  = aAlfa;
     #200#7  = #201#11;
     #200#8  = #201#13;
     #200#9  = #201#14;
     #200#10 = #201#15;
     #200#26 = #7#1;
     #200#21 = "A";
     #200#24 = "S";
     #200#27 = "S";
     #200#28 = aMonedaAgieos;

     |SI #200#26 ] 80;
         nNume = 1900 + #200#26;
     |SINO;
         nNume = 2000 + #200#26;
     |FINSI;

     aAlfa1 = #200#1;   |QBF aAlfa1;
     aAlfa2 = #114#8;   |QBF aAlfa2;
     aAlfa3 = #114#10;  |QBF aAlfa3;
     aAlfa =  "[" + (("00000" + #200#2) % -105) + "/" + nNume + "] " + aAlfa1 + " " + aAlfa2 + " " + aAlfa3;
     #200#29 = aAlfa;

     aAlfa   = " " * 10;
     #200#20 = aAlfa;
     |GRABA 020#200n;
     |LIBERA #200;

     aDirEmpresa      = (("00000" + #200#2) % -105) + #200#3;
     aDirFichDestino = aPathDestino + "fich/" + aDirEmpresa + "/";
     |MKDIR aDirFichDestino;

     enEmpreOri = #7#2;
     enPerioOri = #7#3;
     eaCopiar   = #7#4;
     eaCeros    = #7#5;
     eaExterno  = aDirFichDestino;
     any_pos    = #200#26;
     |SUB_EJECUTA_NP ":contagen/cacrebal";

     enForzar   = 1;
     eaAplica   = "contagen";
     eaEmpresa  = (("00000" + #200#2) % -105) + #200#3;
     eaMoneda   = #200#28;
     |DBASS eaBase;  |QBT eaBase;
     |SUB_EJECUTA_NP ":agitool/dsconver";
|FPRC;

|PROCESO MiraEmpContable;
     nLinea = 0;
     |ABRE #200;
     #200#2 = #91#1;
     #200#3 = #7#0;
     |LEE 040#200=;
     |SI FSalida ! 0;
         |HAZ CreaEmpresa;
     |FINSI;
     |CIERRA #200;

     nDig1 = #200#11;       || desde mes
     nDig3 = #200#13;       || nro. niveles
     nDig4 = #200#14;       || 1 nivel
     nDig5 = #200#15;       || 2 nivel
     nDig6 = #200#16;       || 3 nivel
     nDig7 = #200#17;       || 4 nivel
     nDig8 = #200#18;       || 5 nivel
     nDig9 = #200#19;       || 6 nivel

     |ABRE #203;
     #203#0 = #200#2;
     #203#1 = #200#3;
     |LEE 101#203=;
     |SI FSalida ! 0;
         |DDEFECTO #203;
         #203#0 = #200#2;
         #203#1 = #200#3;
         #203#2 = #200#28;
         |GRABA 020#203n;
     |FINSI;
     |LIBERA #203;
     |CIERRA #203;

     nConversor = 1;
     nRedondeo  = 2;
     |SI #203#2 = "P";  nRedondeo = 0;  |FINSI;

     |SI aMonedaAgieos = "E";
         |SI #203#2 = "P";
             nConversor = 0.00601012;
             nRedondeo  = 0;
         |FINSI;
     |SINO;
         |SI #203#2 = "E";
             nConversor = 166.386;
             nRedondeo  = 2;
         |FINSI;
     |FINSI;

     nConverMod = 1;
     nRedonMod  = 2;
     |ABRE #204;
     |LEE 040#204p;
     |SI FSalida ! 0;  |DDEFECTO #204;  |FINSI;
     |CIERRA #204;

     |SI #204#9 = "P";  nRedonMod = 0;  |FINSI;

     |SI aMonedaAgieos = "E";
         |SI #204#9 = "P";
             nConverMod = 0.00601012;
             nRedonMod  = 0;
         |FINSI;
     |SINO;
         |SI #204#9 = "E";
             nConverMod = 166.386;
             nRedonMod  = 2;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CogeCodigo;
     |SI #15#22 = "S";  |ACABA;  |FINSI;

     nCodigoNue = #15#3;
     |ERROR10;
|FPRC;

|DEFBUCLE dspase15;
     #15#4;
     ;
     nCodigoReo, "            ", 000;
     nCodigoReo, "zzzzzzzzzzzz", 999;
     ;
     NULL, CogeCodigo;
|FIN;

|PROCESO GrabaTempo;
     |SI nEstaCambio = 1;
         nCodigoNue = 0;
         nCodigoReo = #900#0;
         |BUCLE dspase15;
         |SI nCodigoNue = 0;  |ACABA;  |FINSI;
     |SINO;
         nCodigoNue = #900#0;
     |FINSI;

     #91#0 = 0;
     #91#1 = nCodigoNue;
     #91#4 = 0;
     |LEE 040#91=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     |ABRE #200;
     #200#2 = nCodigoNue;
     #200#3 = #7#0;
     |LEE 040#200=;
     |SI FSalida = 0;
         #92#0 = 0;
         #92#1 = nCodigoNue;
         #92#3 = 0;
         |LEE 040#92=;
         |SI FSalida = 0;  |ACABA;  |FINSI;
     |SINO;
         #92#0 = 0;
         #92#1 = nCodigoNue;
         #92#3 = 0;
         |LEE 101#92=;
         |SI FSalida = 0;
             |BORRA 020#92a;
         |FINSI;
         |LIBERA #92;
     |FINSI;
     |CIERRA #200;

     #91#0 = 0;
     #91#1 = nCodigoNue;
     #91#2 = #900#2;
     #91#3 = "N";
     #91#4 = 0;
     #91#5 = #900#0;
     |GRABA 020#91n;
     |LIBERA #91;
|FPRC;

|PROCESO CalculaCuenta;
     aAlfa1    = aCuenta;  |QBF aAlfa1;
     aAlfa1    = aAlfa1 % 0;
     nLong     = aAlfa1;
     nSwCuenta = 0;
     nDigito   = 0;
     |SI nLong = nDig4; |Y nDig4 ! 0; nSwCuenta = 1; nDigito = 1; |FINSI;
     |SI nLong = nDig5; |Y nDig5 ! 0; nSwCuenta = 1; nDigito = 2; |FINSI;
     |SI nLong = nDig6; |Y nDig6 ! 0; nSwCuenta = 1; nDigito = 3; |FINSI;
     |SI nLong = nDig7; |Y nDig7 ! 0; nSwCuenta = 1; nDigito = 4; |FINSI;
     |SI nLong = nDig8; |Y nDig8 ! 0; nSwCuenta = 1; nDigito = 5; |FINSI;
     |SI nLong = nDig9; |Y nDig9 ! 0; nSwCuenta = 1; nDigito = 6; |FINSI;
     |SI nSwCuenta = 0;  |Y nLong ! 0;
         |SI nDig4 ! 0; nDigito = 1; nLong = nDig4;  |FINSI;
         |SI nDig5 ! 0; nDigito = 2; nLong = nDig5;  |FINSI;
         |SI nDig6 ! 0; nDigito = 3; nLong = nDig6;  |FINSI;
         |SI nDig7 ! 0; nDigito = 4; nLong = nDig7;  |FINSI;
         |SI nDig8 ! 0; nDigito = 5; nLong = nDig8;  |FINSI;
         |SI nDig9 ! 0; nDigito = 6; nLong = nDig9;  |FINSI;

         aAlfa   = aCuenta;  |QBF aAlfa;
         nPos    = 100 + nLong;
         aCuenta = (aAlfa + "000000000000") % nPos;
     |FINSI;
|FPRC;

|PROCESO CuentaConAste;
     aAlfa1  = aCuenta;  |QBF aAlfa1;
     aAlfa2  = aAlfa1 % -101;
     aAlfa3  = aAlfa1 % -212;
     |SI aAlfa2 = "*";
         |SI nDig4 ! 0; nDigito = 1; nLong = nDig4;  |FINSI;
         |SI nDig5 ! 0; nDigito = 2; nLong = nDig5;  |FINSI;
         |SI nDig6 ! 0; nDigito = 3; nLong = nDig6;  |FINSI;
         |SI nDig7 ! 0; nDigito = 4; nLong = nDig7;  |FINSI;
         |SI nDig8 ! 0; nDigito = 5; nLong = nDig8;  |FINSI;
         |SI nDig9 ! 0; nDigito = 6; nLong = nDig9;  |FINSI;

         nPos    = 100 + (nLong - 5);
         aCuenta = ((aAlfa3 + "000000000000") % nPos) + (("00000" + #86#0) % -105);
     |SINO;
         |HAZ CalculaCuenta;
     |FINSI;
|FPRC;

|PROCESO eosamorl;
     #42#0  = #41#0;
     #42#1  = #41#1;
     #42#2  = #41#2;
     #42#3  = #41#3;
     #42#4  = #902#3;
     |SI #902#4 [ 80;
         #42#5 = 2000 + #902#4;
     |SINO;
         #42#5 = 1900 + #902#4;
     |FINSI;
     #42#6  = #902#6;
     |SI #42#6 = "C";
         #42#7  = (#902#8 / nConverMod) ! nRedonMod;
         #42#11 = (#902#8 / nConverMod) ! nRedonMod;
     |SINO;
         #42#7  = (#902#11 / nConverMod) ! nRedonMod;
         #42#11 = (#902#11 / nConverMod) ! nRedonMod;
     |FINSI;
     #42#8  = #902#12;
     #42#9  = #902#5;
     #42#10 = #902#7;
     |SI #42#6 = "C";
         #42#12 = nConceptoC;
     |SINO;
         #42#12 = nConceptoA;
     |FINSI;
     #42#13 = 0;
     |GRABA 020#42n;
|FPRC;

|DEFBUCLE eosamorl;
     #902#1004;
     ;
     #901#0, #901#1, #901#2, 001;
     #901#0, #901#1, #901#2, 999;
     ;
     NULL, eosamorl;
|FIN;

|PROCESO eosamorc;
     |SI nSw = 0;
         |HAZ GrabaTempo;
         |ACABA;
     |FINSI;

     |HAZ MiraEmpContable;

     nNume = #901#2;

     |PARA;  |SI;  |HACIENDO;
             aAlfa = ("00000000" + nNume) % -108;
             #41#0 = #91#1;
             #41#2 = aAlfa;
             #41#3 = 0;
             |LEE 040#41=;
             |SI FSalida = 0;
                 nNume = nNume + 1;
             |SINO;
                 |SAL;
             |FINSI;
     |SIGUE;

     |DDEFECTO #41;
     #41#0  = #91#1;
     #41#1  = #901#16;
     #41#2  = aAlfa;
     #41#3  = 0;
     #41#4  = #901#3;
     #41#8  = #901#14;
     #41#9  = #901#10;
     #41#10 = (#901#11 / nConverMod) ! nRedonMod;
     #41#13 = #901#4;
     |SI #901#4 = "N";
         #41#14 = #901#5;
         #41#20 = #901#5;
     |SINO;
         #41#14 = #901#6;
         #41#20 = #901#6;
     |FINSI;
     #41#15 = (#901#12 / nConverMod) ! nRedonMod;
     #41#16 = (#901#13 / nConverMod) ! nRedonMod;
     #41#19 = #901#4;
     #41#21 = (#901#12 / nConverMod) ! nRedonMod;
     #41#22 = (#901#13 / nConverMod) ! nRedonMod;
     #41#27 = #901#10;
     #41#32 = #91#2;

     |ABRE #114;
     #114#0 = #91#1;
     #114#1 = #901#16;
     |LEE 040#114=;
     |SI FSalida ! 0;  |DDEFECTO #114;  |FINSI;
     |CIERRA #114;

     #41#33 = #114#4;

     |SELECT #2#86;
     #86#1 = #41#8;
     |LEE 040#86=;
     |SI FSalida ! 0;
         |SELECT #1#86;
         |LEE 040#86u;
         |SI FSalida ! 0;  #86#0 = 0;  |FINSI;
         #86#0 = #86#0 + 1;
         #86#1 = #41#8;
         |GRABA 020#86n;
         |LIBERA #86;
     |FINSI;

     |SI #901#17 = "      ";
         #87#0 = #901#9;
         |LEE 040#87=;
         |SI FSalida ! 0;  |DDEFECTO #87;  |FINSI;

         nConceptoC = #87#8;
         nConceptoA = #87#9;
         aCuenta    = #87#2;   |HAZ CalculaCuenta;
         #41#5      = aCuenta;
         #41#6      = nDigito;
         #41#18     = #87#4;
         aCuenta    = #87#3;   |HAZ CuentaConAste;
         aCuentaH   = aCuenta;
         nDigitoH   = nDigito;

         #40#0      = #91#1;
         #40#2      = #87#4;
         |LEE 101#40=;
         |SI FSalida ! 0;
             |DDEFECTO #40;
             #40#0   = #91#1;
             #40#2   = #87#4;
             aCuenta = #87#6;   |HAZ CalculaCuenta;
             #40#3   = aCuenta;
             #40#4   = nDigito;
             aCuenta = #87#7;   |HAZ CalculaCuenta;
             #40#5   = aCuenta;
             #40#6   = nDigito;
             #40#7   = #87#5;
             #40#8   = #91#2;
             |GRABA 020#40n;
         |FINSI;
         |LIBERA #40;
     |SINO;
         #89#0 = #901#17;
         |LEE 040#89=;
         |SI FSalida ! 0;  |DDEFECTO #89;  |FINSI;

         nConceptoC = #89#8;
         nConceptoA = #89#9;
         aCuenta    = #89#2;   |HAZ CalculaCuenta;
         #41#5      = aCuenta;
         #41#6      = nDigito;
         #41#18     = #89#4;
         aCuenta    = #89#3;   |HAZ CuentaConAste;
         aCuentaH   = aCuenta;
         nDigitoH   = nDigito;

         #40#0 = #91#1;
         #40#2 = #89#4;
         |LEE 101#40=;
         |SI FSalida ! 0;
             |DDEFECTO #40;
             #40#0   = #91#1;
             #40#2   = #89#4;
             aCuenta = #89#6;   |HAZ CalculaCuenta;
             #40#3   = aCuenta;
             #40#4   = nDigito;
             aCuenta = #89#7;   |HAZ CalculaCuenta;
             #40#5   = aCuenta;
             #40#6   = nDigito;
             #40#7   = #89#5;
             #40#8   = #91#2;
             |GRABA 020#40n;
         |FINSI;
         |LIBERA #40;
     |FINSI;

     |GRABA 020#41n;
     |HAZ GrabaError1;
     |LIBERA #41;

     |BUCLE eosamorl;

     |ABRE #30;
     #30#0 = nConceptoC;
     |LEE 040#30=;
     |SI FSalida ! 0;  |DDEFECTO #30;  |FINSI;
     |CIERRA #30;

     nLineaA = nLineaA + 1;
     |DDEFECTO #123;
     #123#0  = #91#1;
     #123#1  = #7#0;
     #123#2  = nLineaA;
     #123#3  = #7#6;
     #123#4  = #7#8;
     #123#5  = 1;
     #123#6  = #41#5;
     #123#7  = #41#6;
     #123#8  = nConceptoC;
     #123#9  = #30#1;
     #123#10 = "D";
     #123#11 = (#901#11 / nConversor) ! nRedondeo;
     #123#12 = #41#1;
     #123#25 = #41#8;
     |GRABA 020#123n;
     |LIBERA #123;

     nLineaA = nLineaA + 1;
     |DDEFECTO #123;
     #123#0  = #91#1;
     #123#1  = #7#0;
     #123#2  = nLineaA;
     #123#3  = #7#6;
     #123#4  = #7#8;
     #123#5  = 1;
     #123#6  = aCuentaH;
     #123#7  = nDigitoH;
     #123#8  = nConceptoC;
     #123#9  = #30#1;
     #123#10 = "H";
     #123#11 = (#901#11 / nConversor) ! nRedondeo;
     #123#12 = #41#1;
     #123#25 = #41#8;
     |GRABA 020#123n;
     |LIBERA #123;
|FPRC;

|DEFBUCLE eosamorc;
     #901#1003;
     ;
     nEmpresa, 00, 00001;
     nEmpresa, 99, 99999;
     ;
     NULL, eosamorc;
|FIN;

|PROCESO eosm0024;
     nLinea24 = nLinea24 + 1;

     #42#0  = #41#0;
     #42#1  = #41#1;
     #42#2  = #41#2;
     #42#3  = #41#3;
     #42#4  = nLinea24;
     #42#5  = #904#3;
     #42#6  = "A";
     #42#7  = (#904#5 / nConverMod) ! nRedonMod;
     #42#8  = #904#6;
     aAlfa  = "31.12." + #904#3;
     #42#9  = aAlfa;
     #42#10 = #904#4;
     #42#11 = (#904#5 / nConverMod) ! nRedonMod;
     |SI #42#6 = "C";  #42#12 = nConceptoC;  |FINSI;
     |SI #42#6 = "A";  #42#12 = nConceptoA;  |FINSI;
     |SI #42#6 = "V";  #42#12 = nConceptoV;  |FINSI;
     #42#13 = 0;
     |GRABA 020#42n;
|FPRC;

|DEFBUCLE eosm0024;
     #904#1004;
     ;
     #903#0, #903#1, #903#2, 1900;
     #903#0, #903#1, #903#2, 2999;
     ;
     NULL, eosm0024;
|FIN;

|PROCESO eosm0023;
     |SI nSw = 0;
         |HAZ GrabaTempo;
         |ACABA;
     |FINSI;

     |HAZ MiraEmpContable;

     |ABRE #905;
     #905#0 = #91#1;
     #905#1 = #903#9;
     #905#2 = 2;
     |LEE 040#905=;
     |SI FSalida ! 0;  |DDEFECTO #905;  |FINSI;
     |CIERRA #905;

     nNume = #903#2;
     |PARA;  |SI;  |HACIENDO;
             aAlfa = ("00000000" + nNume) % -108;
             #41#0 = #91#1;
             #41#2 = aAlfa;
             #41#3 = 0;
             |LEE 040#41=;
             |SI FSalida = 0;
                 nNume = nNume + 1;
             |SINO;
                 |SAL;
             |FINSI;
     |SIGUE;

     |DDEFECTO #41;
     #41#0  = #91#1;
     #41#1  = #903#1;
     #41#2  = aAlfa;
     #41#3  = 0;
     #41#4  = #903#3;
     #41#8  = #905#4;
     #41#9  = #903#13;
     |SI #903#6 = "B";
         #41#10 = (#903#14 / nConverMod) ! nRedonMod;
     |SINO;
         #41#10 = (#903#16 / nConverMod) ! nRedonMod;
     |FINSI;
     #41#11 = #903#5;

     #41#13 = "N";
     #41#14 = #903#8;
     #41#15 = (#903#21 / nConverMod) ! nRedonMod;
     #41#16 = (#903#22 / nConverMod) ! nRedonMod;
     #41#19 = "N";
     #41#20 = #903#8;
     #41#21 = (#903#21 / nConverMod) ! nRedonMod;
     #41#22 = (#903#22 / nConverMod) ! nRedonMod;
     #41#26 = #903#17;
     #41#27 = #903#12;
     #41#28 = #903#4;
     #41#29 = #903#7;
     #41#30 = #903#8;
     #41#31 = #903#25;
     #41#32 = #91#2;

     |ABRE #114;
     #114#0 = #91#1;
     #114#1 = #901#16;
     |LEE 040#114=;
     |SI FSalida ! 0;  |DDEFECTO #114;  |FINSI;
     |CIERRA #114;

     #41#33 = #114#4;

     |SELECT #2#86;
     #86#1 = #41#8;
     |LEE 040#86=;
     |SI FSalida ! 0;
         |SELECT #1#86;
         |LEE 040#86u;
         |SI FSalida ! 0;  #86#0 = 0;  |FINSI;
         #86#0 = #86#0 + 1;
         #86#1 = #41#8;
         |GRABA 020#86n;
         |LIBERA #86;
     |FINSI;

     |SI #903#11 = "      ";
         #88#0 = #41#28;
         #88#1 = #903#10;
         |LEE 040#88=;
         |SI FSalida ! 0;  |DDEFECTO #88;  |FINSI;

         nConceptoC = #88#9;
         nConceptoA = #88#11;
         nConceptoV = #88#12;
         aCuenta    = #88#3;   |HAZ CalculaCuenta;
         #41#5      = aCuenta;
         #41#6      = nDigito;
         #41#18     = #88#5;
         aCuenta    = #88#4;   |HAZ CuentaConAste;
         aCuentaH   = aCuenta;
         nDigitoH   = nDigito;

         #40#0      = #91#1;
         #40#2      = #88#5;
         |LEE 101#40=;
         |SI FSalida ! 0;
             |DDEFECTO #40;
             #40#0   = #91#1;
             #40#2   = #88#5;
             aCuenta = #88#7;   |HAZ CalculaCuenta;
             #40#3   = aCuenta;
             #40#4   = nDigito;
             aCuenta = #88#8;   |HAZ CalculaCuenta;
             #40#5   = aCuenta;
             #40#6   = nDigito;
             #40#7   = #88#6;
             #40#8   = #91#2;
             |GRABA 020#40n;
         |FINSI;
         |LIBERA #40;
     |SINO;
         #90#0 = #41#28;
         #90#1 = #903#11;
         |LEE 040#90=;
         |SI FSalida ! 0;  |DDEFECTO #90;  |FINSI;

         nConceptoC = #90#9;
         nConceptoA = #90#11;
         nConceptoV = #90#12;
         aCuenta    = #90#3;   |HAZ CalculaCuenta;
         #41#5      = aCuenta;
         #41#6      = nDigito;
         #41#18     = #90#5;
         aCuenta    = #90#4;   |HAZ CuentaConAste;
         aCuentaH   = aCuenta;
         nDigitoH   = nDigito;

         #40#0      = #91#1;
         #40#2      = #90#5;
         |LEE 101#40=;
         |SI FSalida ! 0;
             |DDEFECTO #40;
             #40#0   = #91#1;
             #40#2   = #90#5;
             aCuenta = #90#7;   |HAZ CalculaCuenta;
             #40#3   = aCuenta;
             #40#4   = nDigito;
             aCuenta = #90#8;   |HAZ CalculaCuenta;
             #40#5   = aCuenta;
             #40#6   = nDigito;
             #40#7   = #90#6;
             #40#8   = #91#2;
             |GRABA 020#40n;
         |FINSI;
         |LIBERA #40;
     |FINSI;

     |GRABA 020#41n;
     |LIBERA #41;
     |HAZ GrabaError1;

     #42#0  = #41#0;
     #42#1  = #41#1;
     #42#2  = #41#2;
     #42#3  = #41#3;
     #42#4  = 1;
     aAlfa  = #41#27 % -104;
     #42#5  = aAlfa;
     #42#6  = "C";
     #42#7  = #41#10;
     #42#8  = "S";
     #42#9  = #41#27;
     #42#10 = "COMPRA";
     #42#11 = #41#10;
     #42#12 = nConceptoC;
     #42#13 = 0;
     |GRABA 020#42n;
     |LIBERA #42;

     nLinea24 = 1;
     |BUCLE eosm0024;

     |SI #903#17 ! "01.01.0000";
         nLinea24 = nLinea24 + 1;
         #42#0  = #41#0;
         #42#1  = #41#1;
         #42#2  = #41#2;
         #42#3  = #41#3;
         #42#4  = nLinea24;
         aAlfa  = #903#17 % -104;
         #42#5  = aAlfa;
         #42#6  = "V";
         |SI #903#6 = "B";
             #42#7 = (#903#18 / nConverMod) ! nRedonMod;
         |SINO;
             #42#7 = (#903#20 / nConverMod) ! nRedonMod;
         |FINSI;
         #42#8  = "S";
         #42#9  = #903#17;
         #42#10 = "VENTA";
         #42#11 = #42#7;
         #42#12 = nConceptoV;
         #42#13 = 0;
         |GRABA 020#42n;
         |LIBERA #42;
     |FINSI;

     |ABRE #30;
     #30#0 = nConceptoC;
     |LEE 040#30=;
     |SI FSalida ! 0;  |DDEFECTO #30;  |FINSI;
     |CIERRA #30;

     aAlfa        = #41#27 % -102;
     nAnyoCompra  = aAlfa;
     |SI #7#9        = "N";   |ACABA;  |FINSI;
     |SI nAnyoCompra ! #7#1;  |ACABA;  |FINSI;

     nLineaA = nLineaA + 1;
     |DDEFECTO #123;
     #123#0  = #91#1;
     #123#1  = #7#0;
     #123#2  = nLineaA;
     #123#3  = #7#6;
     #123#4  = #7#8;
     #123#5  = 1;
     #123#6  = #41#5;
     #123#7  = #41#6;
     #123#8  = nConceptoC;
     #123#9  = #30#1;
     #123#10 = "D";
     |SI #903#6 = "B";
         #123#11 = (#903#14 / nConversor) ! nRedondeo;
     |SINO;
         #123#11 = (#903#16 / nConversor) ! nRedondeo;
     |FINSI;
     #123#12 = #41#1;
     #123#25 = #41#8;
     |GRABA 020#123n;
     |LIBERA #123;

     nLineaA = nLineaA + 1;
     |DDEFECTO #123;
     #123#0  = #91#1;
     #123#1  = #7#0;
     #123#2  = nLineaA;
     #123#3  = #7#6;
     #123#4  = #7#8;
     #123#5  = 1;
     #123#6  = aCuentaH;
     #123#7  = nDigitoH;
     #123#8  = nConceptoC;
     #123#9  = #30#1;
     #123#10 = "H";
     |SI #903#6 = "B";
         #123#11 = (#903#14 / nConversor) ! nRedondeo;
     |SINO;
         #123#11 = (#903#16 / nConversor) ! nRedondeo;
     |FINSI;
     #123#12 = #41#1;
     #123#25 = #41#8;
     |GRABA 020#123n;
     |LIBERA #123;
|FPRC;

|DEFBUCLE eosm0023;
     #903#1003;
     ;
     nEmpresa, 1, 00001;
     nEmpresa, 9, 99999;
     ;
     NULL, eosm0023;
|FIN;

|PROCESO GrabaError1;
 |ABRE #214;
 #214#0  = #91#1;
 #214#1  = #7#0;
 #214#11 = 3;
 #214#13 = 0;
 |LEE 101#214=;
 |SI FSalida ! 0;
     |DDEFECTO #214;
     #214#0  = #91#1;
     #214#1  = #7#0;
     #214#2  = #91#2;
     #214#3  = nEjer;
     #214#4  = aMonedaAgieos;
     #214#5  = #91#5;
     #214#7  = #91#2;
     #214#8  = nEjer;
     #214#9  = aMonedaAgieos;
     #214#10 = aPathAnterior;
     #214#11 = 3;
     #214#12 = "Ficha Amort.";
     #214#13 = 0;
     |GRABA 020#214b;
 |FINSI;
 #214#20 = #214#20 + 1;
 #214#14 = #214#14 + #41#10;
 #214#15 = #214#15 + #41#21;
 #214#16 = #214#16 + #41#22;
 |GRABA 020#214a;
 |LIBERA #214;
 |CIERRA #214;
|FPRC;

|PROCESO Pasando;
     nEmpresa = #91#5;

     |ABRE #86;   |CIERRA #86;  |DELINDEX #86;

     |ABRE #86;
     |ABRE #87;
     |ABRE #88;
     |ABRE #89;
     |ABRE #90;
     |ABRE #40;
     |ABRE #41;
     |ABRE #42;

     enTipoAct  = 2;
     eaFAsiento = ("123" + Usuario) % 108;
     |NOME_DAT #123 eaFAsiento;
     |PATH_DAT #123 eaPathDsmodelo;
     |ABRE #123;  |CIERRA #123;  |DELINDEX #123;

     |SI #0#1 > 80;
         nEjer = #0#1 + 1900;
     |SINO;
         nEjer = #0#1 + 2000;
     |FINSI;

     |ABRE #214;
     #214#0  = #91#1;
     #214#1  = #7#0;
     #214#11 = 3;
     #214#13 = 0;
     |LEE 101#214=;
     |SI FSalida =  0;
         |BORRA 140#214a;
     |FINSI;
     |LIBERA #214;
     |CIERRA #214;

     |ABRE #123;
     nLineaA = 0;
     nSw     = 1;  |BUCLE eosamorc;
     nSw     = 1;  |BUCLE eosm0023;
     |CIERRA #123;

     enEmpresa   = #91#1;
     enPerConta  = #7#0;
     eaNombreEmp = #91#2;
     enDesdeOtra = 1;

     |SI #7#9 = "S";
         enTipoEos   = 2;  ||desde libros
         swSinCheq   = 2;
         enEmprEos   = #91#5;
         eaEmprEos   = #91#2;
         |SUB_EJECUTA ":modelos/dsmoz123";
     |FINSI;

     |CIERRA #86;
     |CIERRA #87;
     |CIERRA #88;
     |CIERRA #89;
     |CIERRA #90;
     |CIERRA #40;
     |CIERRA #41;
     |CIERRA #42;
     |DELINDEX #86;

     |ABRE #92;
     #92#0 = #91#0;
     #92#1 = #91#1;
     #92#2 = #91#2;
     #92#3 = 0;
     #92#4 = #91#5;
     |GRABA 020#92n;
     |LIBERA #92;
     |CIERRA #92;

     |BORRA 020#91a;
     |LIBERA #91;

     |ENTLINEAL #1#92, -2, 7, 22, 1, ClaveBaja92, ClaveAlta92;
     |ENTLINEAL #1#91, -2, 7, 22, 0, ClaveBaja91, ClaveAlta91;
|FPRC;

|DEFBUCLE dspase91;
     #91#1;
     3;
     0, 00000, 0, "S";
     0, 99999, 0, "S";
     be;
     NULL, Pasando;
|FIN;

|PROCESO LeeCliente;
     nEmpresa = #900#0;
     nSw      = 0;  |BUCLE eosamorc;
     nSw      = 0;  |BUCLE eosm0023;
|FPRC;

|DEFBUCLE eosclien;
     #900#1001;
     ;
     00000;
     99999;
     ;
     NULL, LeeCliente;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |NOME_DAT #91 "pase0791";
     |NOME_DAT #92 "pase0792";

     |ABRE #91;
     |ABRE #92;

     aDef = aPathDefFiscal + "eosclien.mas";
     |CARGA_DEF aDef, refer00@;
     |SI FSalida ! 0;
         |MENAV "     Error en Cargar el Def eosamorc.mas";
         |ACABA;
     |FINSI;

     aDef = aPathDefFiscal + "eosamorc.mas";
     |CARGA_DEF aDef, refer01@;
     |SI FSalida ! 0;
         |MENAV "     Error en Cargar el Def eosamorc.mas";
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = aPathDefFiscal + "eosamorl.mas";
     |CARGA_DEF aDef, refer02@;
     |SI FSalida ! 0;
         |MENAV "     Error en Cargar el Def eosamorl.mas";
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = aPathDefFiscal + "eosm0023.mas";
     |CARGA_DEF aDef, refer03@;
     |SI FSalida ! 0;
         |MENAV "     Error en Cargar el Def eosm0023.mas";
         |DESCARGA_DEF #refer02@;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = aPathDefFiscal + "eosm0024.mas";
     |CARGA_DEF aDef, refer04@;
     |SI FSalida ! 0;
         |MENAV "     Error en Cargar el Def eosm0024.mas";
         |DESCARGA_DEF #refer03@;
         |DESCARGA_DEF #refer02@;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     aDef = aPathDefFiscal + "eosclpre";
     |CARGA_DEF aDef, refer05@;
     |SI FSalida ! 0;
         |MENAV "     Error en Cargar el Def eosclpre.mas";
         |DESCARGA_DEF #refer04@;
         |DESCARGA_DEF #refer03@;
         |DESCARGA_DEF #refer02@;
         |DESCARGA_DEF #refer01@;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     |PATH_DAT #900 aPathFichFiscal;
     |PATH_DAT #901 aPathFichFiscal;
     |PATH_DAT #902 aPathFichFiscal;
     |PATH_DAT #903 aPathFichFiscal;
     |PATH_DAT #904 aPathFichFiscal;
     |PATH_DAT #905 aPathFichFiscal;

     |BUCLE eosclien;

     |CIERRA #91;
     |CIERRA #92;

     |ENTLINEAL #1#92, -2, 7, 22, 1, ClaveBaja92, ClaveAlta92;
     |ENTLINEAL #1#91, -2, 4, 22, 0, ClaveBaja91, ClaveAlta91;

     |CONFI "0000SRealizamos el pase en estos Momentos";
     |SI FSalida = 0;
         aDef = eaPathAgitool + "def/zmonedas.mas";
         |CARGA_DEF aDef, refer06@;
         |SI FSalida ! 0;
             aMonedaAgieos = "P";
         |SINO;
             |PATH_DAT #906 aPathFichFiscal;
             |ABRE #906;
             |LEE 040#906p;
             |SI FSalida ! 0;  |DDEFECTO #906;  |FINSI;
             |CIERRA #906;

             aMonedaAgieos = #906#1;

             |DESCARGA_DEF #refer06@;
         |FINSI;

         |BUCLE dspase91;
     |FINSI;

     |DESCARGA_DEF #refer05@;
     |DESCARGA_DEF #refer04@;
     |DESCARGA_DEF #refer03@;
     |DESCARGA_DEF #refer02@;
     |DESCARGA_DEF #refer01@;
     |DESCARGA_DEF #refer00@;
|FPRC;

|PROCESO BuscaAgicont;
   aPathAgicont = "";
   aAlfa = aPathAnterior + "agicont/def/canempre.mas";
   |XABRE "E", aAlfa, nNume;
   |SI FSalida ] 0;
        aPathAgicont = aPathAnterior + "agicont/";
   |FINSI;
|FPRC;

|PROGRAMA;
     |ABRE #0;
     |LEE 040#0p;
     |SI FSalida ! 0;
         |MENAV "     Pase de Ficheros Generales no Realizado";
         |CIERRA #0;
         |ACABA;
     |FINSI;
     |CIERRA #0;

     |ABRE #15;
     |LEE 040#15p;
     |SI FSalida ! 0;
         nEstaCambio = 0;
         |DDEFECTO #15;
     |SINO;
         nEstaCambio = 1;
         |SI #15#15 ! "S";
             |MENAV "      Unificacion de Codigos no Realizada.";
             |CIERRA #15;
             |ACABA;
         |FINSI;
     |FINSI;
     |CIERRA #15;

     |DBASE aBase;  |QBF aBase;
     aPathPases = aBase + "pases";  |MKDIR aPathPases;
     aPathPases = aPathPases + "/";

     |PATH_DAT #87 aPathPases;
     |PATH_DAT #88 aPathPases;
     |PATH_DAT #89 aPathPases;
     |PATH_DAT #90 aPathPases;

     |ABRE #87;
     |LEE 040#87p;
     |SI FSalida ! 0;
         |CIERRA #87;
         aOrigen  = aBase + "fich/dspase87.dat";
         aDestino = aPathPases + "dspase87.dat";
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;
     |CIERRA #87;

     |ABRE #88;
     |LEE 040#88p;
     |SI FSalida ! 0;
         |CIERRA #88;
         aOrigen  = aBase + "fich/dspase88.dat";
         aDestino = aPathPases + "dspase88.dat";
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;
     |CIERRA #88;

     |ABRE #89;
     |LEE 040#89p;
     |SI FSalida ! 0;
         |CIERRA #89;
         aOrigen  = aBase + "fich/dspase89.dat";
         aDestino = aPathPases + "dspase89.dat";
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;
     |CIERRA #89;

     |ABRE #90;
     |LEE 040#90p;
     |SI FSalida ! 0;
         |CIERRA #90;
         aOrigen  = aBase + "fich/dspase90.dat";
         aDestino = aPathPases + "dspase90.dat";
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;
     |CIERRA #90;

     nSw = 0;
     |ABRE #87;
     |LEE 040#87p;
     |SI FSalida = 0;  nSw = 1;  |FINSI;
     |CIERRA #87;

     |ABRE #89;
     |LEE 040#89p;
     |SI FSalida = 0;  nSw = 2;  |FINSI;
     |CIERRA #89;

     |SI nSw = 0;
         |MENAV "     No existe Planillas de Amortizacion con Datos.";
         |CIERRA #0;
         |ACABA;
     |FINSI;

     |HAZ BusquedaApli;
     eaPathDsmodelo = eaPathDsmodelo + "fich/";

     |SI eaPathContagen = "";
         |MENAV "     No tiene instalada la Contabilidad";
         |ACABA;
     |FINSI;

     |HAZ BuscaAgicont;
     aPathAnterior   = #0#0;  |QBT aPathAnterior;
     aPathDefFiscal  = aPathAnterior + "agieos/def/";
     aPathFichFiscal = aPathAnterior + "agieos/fich/";
     aPathDestino    = eaPathContagen - "fich/";

     |PINPA #0#7;
     |PINDA #0#7;
     |ENDATOS #1#7;
|FPRO;
