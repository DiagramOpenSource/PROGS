|FICHEROS;
    repatrim #0;
    retotpat #1;
    retabla3 #2;
    redatcon #3;
    retotren #4;
    reliquid #10;
|FIN;

|VARIABLES;
    tipo      = "";
    coefi     = 0;
    FEstado   = 0;
    FEstad1   = 0;
    x         = 0;
    sw        = 0;
    pepe      = 0;
    pepa      = 0;
    pepi      = 0;
    desde     = "  ";
    hasta     = "zz";
    resta     = 0;
    swrenta   = 0;

    &incisino = "";
    &modo     = 0;
    &empresa  = 0;
    &emprefi  = 0;
    &nombre   = "";
    &lininci  = 0;
    &swcalcu  = 0;
    &minusva1 = "";
    &minusva2 = "";
    &minusva3 = "";
    &minusva4 = "";
    &minusva5 = "";
    &minusva6 = "";
    &declara  = "";
    &individu = 0;
    &acceso   = 0;
    &recalcu  = 0;
|FIN;

|PROCESO calculo;
  tipo  = #0#3;
  coefi = 100;
  |SI #0#3 = "G";
      tipo = "T"; coefi = 50; |HAZ grabapat;
      tipo = "C"; coefi = 50; |HAZ grabapat;
  |SINO;
      |HAZ grabapat;
  |FINSI;
|FPRC;

|PROCESO liquidacion;
  #4#0   = #1#0;
  #4#141 = #1#28;
  |LEE 040#4=;
  |SI FSalida ! 0; |DDEFECTO #4; |FINSI;

  #3#0 = #1#0;
  |LEE 040#3=;
  |SI FSalida ! 0; |DDEFECTO #3; |FINSI;

  #1#18 = 0;
  |PARA x = 1; |SI x [ 17; |HACIENDO x = x + 1;
        #1#18 = #1#18 + #1x;
  |SIGUE;
  #1#18 = #1#18 + #1#44 + #1#45 - #1#46 - #1#47; || 10 + 12 - 3 - 11
  #1#20 = #1#18 - #1#19;
  |SI #3#4 = "S";
      |SI #4#39 = 0; #1#21 = 15000000; |FINSI;
      |SI #4#39 ! 0; #1#21 = 17000000; |FINSI;
  |SINO;
     #1#21 = 0;
  |FINSI;
  #1#22 = #1#20 - #1#21;
  |SI #1#22 < 0; #1#22 = 0; |FINSI;
  sw = 0;
  pepe = 0;
  pepa = 0;
  pepi = 0;
  |PARA pepe = 8;|SI pepe ] 1; |HACIENDO pepe = pepe - 1;
        |SI #1#22 ] #2pepe; |Y sw = 0;
            pepa  = pepe + 16;
            pepi  = pepe + 8;
            #1#24 = #2pepe;
            #1#26 = #2pepa;
            #1#29 = #2pepi;
            sw = 1;
            pepe = 0;
        |FINSI;
  |SIGUE;
  |SI sw = 0; #1#26 = #2#24; |FINSI;
  #1#25 = #1#22 - #1#24;
  #1#27 = #1#25 % #1#26;
  #1#23 = #1#29 + #1#27;

  |SI #3#4 ! "N";
      #1#31 = #1#23 - ((((#1#23 * 100) / #1#20) * #1#31) / 100);
      |SI swrenta = 0;
          #1#30 = #4#85;
          #1#33 = (#4#32 + #4#54) % 70;
      |FINSI;
      |SI #1#30 < 0; #1#30 = 0; |FINSI;
      #1#32 = #1#30 + #1#31;
      |SI #1#33 < 0; #1#33 = 0; |FINSI;
      |SI #1#33 ] #1#32;
          #1#36 = #1#23;
          #1#34 = 0;
          #1#35 = 0;
      |SINO;
          #1#34 = #1#32 - #1#33;
          #1#35 = #1#23 % 80;
          resta = #1#34;
          |SI resta > #1#35; resta = #1#35; |FINSI;
          #1#36 = #1#23 - resta;
      |FINSI;
  |SINO;
      #1#30 = 0; #1#31 = 0; #1#32 = 0;
      #1#33 = 0; #1#34 = 0; #1#35 = 0;
      #1#36 = #1#23;
  |FINSI;
  #1#43 = (#1#36 / #1#22) * #1#43;
  #1#37 = #1#42;
  |SI #1#37 > #1#43; #1#37 = #1#43; |FINSI;
  #1#39 = (#1#38 * #1#36) / #1#20;
  #1#40 = #1#39 % 50;
  #1#41 = #1#36 - #1#37 - #1#40;
  |GRABA 020#1a;

  #10#0 = #1#0;
  |LIBERA #10;
  |LEE 101#10=;
  FEstado = FSalida;
  |SI FSalida ! 0; |DDEFECTO #10; #10#0 = #1#0; |FINSI;
  |SI #1#22 > 0;
      |SI #1#28 = "T";
          #10#29 = "S"; #10#35 = #1#41;
      |FINSI;
      |SI #1#28 = "C";
          #10#30 = "S"; #10#36 = #1#41;
      |FINSI;
      |SI #1#28 = "1";
          #10#31 = "S"; #10#37 = #1#41;
      |FINSI;
      |SI #1#28 = "2";
           #10#32 = "S"; #10#38 = #1#41;
      |FINSI;
      |SI #1#28 = "3";
           #10#33 = "S"; #10#39 = #1#41;
      |FINSI;
      |SI #1#28 = "4";
           #10#34 = "S"; #10#40 = #1#41;
      |FINSI;
      |SI FEstado = 0; |GRABA 120#10a; |SINO; |GRABA 120#10n; |FINSI;
  |FINSI;
|FPRC;

|PROCESO grabapat;
#1#0  = #0#0;
#1#28 = tipo;
|LIBERA #1;
|LEE 110#1=;
FEstad1 = FSalida;
|SI FSalida ! 0; |DDEFECTO #1; #1#0 = #0#0; #1#28 = tipo; |FINSI;
|SI #0#1 = "A1"; #1#1  = #1#1  + (#0#9  % coefi); |FINSI;
|SI #0#1 = "B1"; #1#2  = #1#2  + (#0#9  % coefi); |FINSI;
|SI #0#1 = "C1"; #1#3  = #1#3  + (#0#9  % coefi); |FINSI;
|SI #0#1 = "C2"; #1#3  = #1#3  + (#0#9  % coefi); |FINSI;
|SI #0#1 = "C3"; #1#3  = #1#3  + (#0#9  % coefi); |FINSI;   || sobre total
|SI #0#1 = "C3"; #1#46 = #1#46 + (#0#9  % coefi); |FINSI;   || exentos
|SI #0#1 = "D1"; #1#4  = #1#4  + (#0#9  % coefi); |FINSI;
|SI #0#1 = "E1"; #1#5  = #1#5  + (#0#9  % coefi); |FINSI;
|SI #0#1 = "E2"; #1#6  = #1#6  + (#0#9  % coefi); |FINSI;
|SI #0#1 = "F1"; #1#7  = #1#7  + (#0#9  % coefi); |FINSI;
|SI #0#1 = "F2"; #1#8  = #1#8  + (#0#9  % coefi); |FINSI;
|SI #0#1 = "F3"; #1#44 = #1#44 + (#0#9  % coefi); |FINSI;
|SI #0#1 = "F4"; #1#45 = #1#45 + (#0#9  % coefi); |FINSI;
|SI #0#1 = "F5"; #1#47 = #1#47 + (#0#9  % coefi); |FINSI;   || exentos
|SI #0#1 = "F5"; #1#45 = #1#45 + (#0#9  % coefi); |FINSI;   || sobre total
|SI #0#1 = "G1"; #1#9  = #1#9  + (#0#9  % coefi); |FINSI;
|SI #0#1 = "H1"; #1#10 = #1#10 + (#0#9  % coefi); |FINSI;
|SI #0#1 = "I1"; #1#11 = #1#11 + (#0#9  % coefi); |FINSI;
|SI #0#1 = "J1"; #1#12 = #1#12 + (#0#9  % coefi); |FINSI;
|SI #0#1 = "K1"; #1#13 = #1#13 + (#0#9  % coefi); |FINSI;
|SI #0#1 = "L1"; #1#14 = #1#14 + (#0#9  % coefi); |FINSI;
|SI #0#1 = "M1"; #1#15 = #1#15 + (#0#9  % coefi); |FINSI;
|SI #0#1 = "N1"; #1#16 = #1#16 + (#0#9  % coefi); |FINSI;
|SI #0#1 = "O1"; #1#17 = #1#17 + (#0#9  % coefi); |FINSI;
|SI #0#1 = "U1"; #1#19 = #1#19 + (#0#9  % coefi); |FINSI;
|SI #0#1 = "V1"; #1#31 = #1#31 + (#0#9  % coefi); |FINSI;
|SI #0#1 = "V2"; #1#42 = #1#42 + (#0#9  % coefi); |FINSI;
|SI #0#1 = "V2"; #1#43 = #1#43 + (#0#13 % coefi); |FINSI;
|SI #0#1 = "V3"; #1#38 = #1#38 + (#0#9  % coefi); |FINSI;
|SI #0#1 = "V4";
    swrenta = 1;
    #1#30 = #1#30 + (#0#13  % coefi);
    #1#33 = #1#33 + (#0#9   % coefi);
|FINSI;

|SI FEstad1 = 0; |GRABA 020#1a; |SINO; |GRABA 020#1n; |FINSI;
|FPRC;

|DEFBUCLE repatrim;
#0#1;
;
empresa, desde, 001;
emprefi, hasta, 999;
e;
NULL, calculo;
|FIN;

|DEFBUCLE liquida;
#1#1;
;
empresa, " ";
emprefi, "z";
be;
NULL, liquidacion;
|FIN;

|PROGRAMA;
  swrenta = 0;
  |ABRE #1;
  |BUCLE repatrim;
  |CIERRA #1;

  |ABRE #2;
  |LEE 040#2p;
  |SI FSalida ! 0; |DDEFECTO #2; |FINSI;
  |CIERRA #2;


  |ABRE #3;
  |ABRE #4;
  |ABRE #10;
  |BUCLE liquida;
  |CIERRA #4;
  |CIERRA #3;
  |CIERRA #10;
  |SI recalcu = 0;
      |CORRE "reliquid.run";
  |SINO;
      |CORRE "rerecalf.run";
  |FINSI;
|FPRO;
