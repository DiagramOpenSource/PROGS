|FICHEROS;
    retotpat #0;

    recapinm #1;
    repatrim #2;
    refant10 #3;
    refant11 #4;

    repoblac #6;
    repant50 #7;
|FIN;

|VARIABLES;
   &empresa  = 0;
   &nombre   = "";
   &cif      = "";
   &impresor = "";
   &diainf   = "";
   &mesinf   = "";
   &anyoinf  = "";
   &tipo     = "";
   &cuenta   = "";
   &swdecl   = 0;
   &anyo1    = 0;
   &anyo2    = 0;
   &anyo3    = 0;
   &anyo4    = 0;
   &anyo5    = 0;
   &anyo6    = 0;
   &papel    = 0;
   &elnombre  = "";
   &apellidos = "";
   &vuelve    = 0;
   &seleccion = "";
   &campo     = 0;
   &chequeo   = 0;
   &fichero   = "";
   &p_cen     = 0;

   informe   = "";
   tipod     = "";
   clave     = "";
   tipoprop  = "";

   conta     = 0;
   var1      = 0;
   var2      = 0;
   var3      = 0;
   var4      = 0;
   var5      = 0;
   var6      = 0;
   var7      = 0;
   var       = 0;
   conta1    = 0;
   conta2    = 0;
   canti     = 0;
   porce     = 0;
   anyou     = 0;
   coefi     = 0;
   anyos     = 0;
|FIN;

|PROGRAMA;
vuelve = 1;
|SI papel = 2;
    |PINPA #0#7;
    #7#0 = empresa;  |PINTA #7#0;
    #7#1 = nombre;   |PINTA #7#1;
|FINSI;

Impresora = impresor;
|IMPRE -1;
|SI FSalida = 0;
    |HAZ hoja2;
    |FINIMP;
    |CORRE "reem7142.run";
|FINSI;
|FPRO;

|| *************************************************************************
||                         IMPRESION HOJA 2
|| *************************************************************************

|| *********************** Del Capital inmobiliario ************************

|PROCESO carga1;
conta1 = conta1 + 1;

var1 = conta1 - 1;  var2 = var1  + 23;  var3 = var2  + 23;
var4 = var3  + 23;  var5 = var4  + 23;  var6 = var5  + 23;
var7 = (var6+1) + 23;    || el +1 es por el total que esta en medio

clave = #1#15;
|SI clave = "U"; clave = "M"; |FINSI;

#6#0 = #1#6;
#6#1 = #1#7;
|LEE 040#6=;
|SI FSalida ! 0; |DDEFECTO #6; |FINSI;

|SI conta1 [ 23;
    #3var1 = clave;
    #3var2 = #1#5;
    #3var3 = "";
    #3var4 = #6#3;
    #3var5 = #6#2;
    #3var6 = canti % coefi;
    #3var7 = #1#72;
|SINO;
    #3#22  = "";
    #3#45  = "Seg£n relaci¢n adjunta";
    #3#68  = "";
    #3#91  = "";
    #3#114 = "";
    #3#137 = #3#137 + (canti % coefi);
|FINSI;
|FPRC;

|PROCESO carga2;
conta2 = conta2 + 1;

var1 = conta2 - 1;  var2 = var1  + 21;  var3 = var2  + 21;
var4 = var3  + 21;  var5 = var4  + 21;  var6 = var5  + 21;
var7 = (var6+1) + 21;    || el +1 es por el total que esta en medio

clave = #1#15;
|SI clave = "U"; clave = "M"; |FINSI;

#6#0 = #1#6;
#6#1 = #1#7;
|LEE 040#6=;
|SI FSalida ! 0; |DDEFECTO #6; |FINSI;

|SI conta2 [ 21;
    #4var1 = clave;
    #4var2 = #6#3;
    #4var3 = #6#2;
    #4var4 = #1#11;
    #4var5 = #1#12;
    #4var6 = canti % coefi;
    #4var7 = #1#72;
|SINO;
    #4#20  = "";
    #4#41  = "Seg£n relaci¢n adjunta";
    #4#62  = "";
    #4#83  = #4#83  + #1#11;
    #4#104 = #4#104 + #1#12;
    #4#125 = #4#125 + (canti % coefi);
|FINSI;
|FPRC;

|PROCESO inmuebles;
|SI #1#48 = "X"; |O #1#48 = "R"; |ACABA; |FINSI;

tipoprop = #1#15;
canti = 0;
|SI #1#31 = "N";
    canti = #1#8;
    |SI canti < #1#17; canti = #1#17; |FINSI;
    |SI canti < #1#19; canti = #1#19; |FINSI;
    tipod = #1#2;
    |SI #1#15 ! "P"; anyou = #1#16; |HAZ calcuprop; |FINSI;
|FINSI;

|SI canti = 0; |ACABA; |FINSI;

|SI tipo = "T";
   |SI #1#2 = "G"; coefi = 50;    |FINSI;
   |SI #1#2 = "T"; coefi = 100;   |FINSI;
   |SI #1#2 = "V"; coefi = #1#49; |FINSI;
   |SI coefi = 0; |ACABA; |FINSI;

   |SI #1#2 = "G"; |O #1#2 = "T"; |O #1#2 = "V";
       |SI #1#4 = "R"; |HAZ carga2;   |FINSI;
       |SI #1#4 = "U"; |HAZ carga1;   |FINSI;
   |FINSI;

   |ACABA;
|FINSI;

|SI tipo = "C";
   |SI #1#2 = "G"; coefi = 50;    |FINSI;
   |SI #1#2 = "C"; coefi = 100;   |FINSI;
   |SI #1#2 = "V"; coefi = #1#50; |FINSI;
   |SI coefi = 0; |ACABA; |FINSI;

   |SI #1#2 = "G"; |O #1#2 = "C"; |O #1#2 = "V";
       |SI #1#4 = "R"; |HAZ carga2;   |FINSI;
       |SI #1#4 = "U"; |HAZ carga1;   |FINSI;
   |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "1";
   |SI #1#2 = "1"; coefi = 100;   |FINSI;
   |SI #1#2 = "V"; coefi = #1#51; |FINSI;
   |SI coefi = 0; |ACABA; |FINSI;

   |SI #1#2 = "1"; |O #1#2 = "V";
       |SI #1#4 = "R"; |HAZ carga2;   |FINSI;
       |SI #1#4 = "U"; |HAZ carga1;   |FINSI;
   |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "2";
   |SI #1#2 = "2"; coefi = 100;   |FINSI;
   |SI #1#2 = "V"; coefi = #1#52; |FINSI;
   |SI coefi = 0; |ACABA; |FINSI;

   |SI #1#2 = "2"; |O #1#2 = "V";
       |SI #1#4 = "R"; |HAZ carga2;   |FINSI;
       |SI #1#4 = "U"; |HAZ carga1;   |FINSI;
   |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "3";
   |SI #1#2 = "3"; coefi = 100;   |FINSI;
   |SI #1#2 = "V"; coefi = #1#53; |FINSI;
   |SI coefi = 0; |ACABA; |FINSI;

   |SI #1#2 = "3"; |O #1#2 = "V";
       |SI #1#4 = "R"; |HAZ carga2;   |FINSI;
       |SI #1#4 = "U"; |HAZ carga1;   |FINSI;
   |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "4";
   |SI #1#2 = "4"; coefi = 100;   |FINSI;
   |SI #1#2 = "V"; coefi = #1#54; |FINSI;
   |SI coefi = 0; |ACABA; |FINSI;

   |SI #1#2 = "4"; |O #1#2 = "V";
       |SI #1#4 = "R"; |HAZ carga2;   |FINSI;
       |SI #1#4 = "U"; |HAZ carga1;   |FINSI;
   |FINSI;
   |ACABA;
|FINSI;
|FPRC;

|DEFBUCLE recapinm;
#1#1;
;
empresa, 01;
empresa, 99;
e;
NULL, inmuebles;
|FIN;

|| *********************** De afectos a patrimonio inmuebles urbana *******

|PROCESO carga3;
conta1 = conta1 + 1;

var1 = conta1 - 1;  var2 = var1  + 23;  var3 = var2  + 23;
var4 = var3  + 23;  var5 = var4  + 23;  var6 = var5  + 23;
var7 = (var6+1) + 23;    || el +1 es por el total que esta en medio

#6#0 = #2#7;
#6#1 = #2#8;
|LEE 040#6=;
|SI FSalida ! 0; |DDEFECTO #6; |FINSI;

|SI conta1 [ 23;
    #3var1 = #2#15;
    #3var2 = #2#5;
    #3var3 = #2#6;
    #3var4 = #6#3;
    #3var5 = #6#2;
    #3var6 = (#2#9 % coefi);
    #3var7 = #2#16;
|SINO;
    #3#22  = "";
    #3#45  = "Seg£n relaci¢n adjunta";
    #3#68  = "";
    #3#91  = "";
    #3#114 = "";
    #3#137 = #3#137 + (#2#9 % coefi);
    #3#161 = "";
|FINSI;
|FPRC;

|PROCESO inmueblea;
coefi = 100;
|SI #2#3 = "G";
    |SI tipo = "T"; coefi = 50; |HAZ carga3; |ACABA; |FINSI;
    |SI tipo = "C"; coefi = 50; |HAZ carga3; |ACABA; |FINSI;
|SINO;
    |SI tipo = #2#3; |HAZ carga3; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE repatria;
#2#1;
;
empresa, "A1", 001;
empresa, "A1", 999;
e;
NULL, inmueblea;
|FIN;

|| *********************** De afectos a patrimonio inmuebles rustico *******

|PROCESO carga4;
conta2 = conta2 + 1;

var1 = conta2 - 1;  var2 = var1  + 21;  var3 = var2  + 21;
var4 = var3  + 21;  var5 = var4  + 21;  var6 = var5  + 21;
var7 = (var6+1) + 21;    || el +1 es por el total que esta en medio

#6#0 = #2#7;
#6#1 = #2#8;
|LEE 040#6=;
|SI FSalida ! 0; |DDEFECTO #6; |FINSI;

|SI conta2 [ 21;
    #4var1 = #2#15;
    #4var2 = #6#3;
    #4var3 = #6#2;
    #4var4 = #2#11;
    #4var5 = #2#10;
    #4var6 = (#2#9 % coefi);
    #4var7 = #2#16;
|SINO;
    #4#20  = "";
    #4#41  = "Seg£n relaci¢n adjunta";
    #4#62  = "";
    #4#83  = #4#83 + #2#11;
    #4#104 = #4#104 + #2#10;
    #4#125 = #4#125 + (#2#9 % coefi);
    #4#147 = "";
|FINSI;
|FPRC;

|PROCESO inmuebleb;
coefi = 100;
|SI #2#3 = "G";
    |SI tipo = "T"; coefi = 50; |HAZ carga4; |ACABA; |FINSI;
    |SI tipo = "C"; coefi = 50; |HAZ carga4; |ACABA; |FINSI;
|SINO;
    |SI tipo = #2#3; |HAZ carga4; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE repatrib;
#2#1;
;
empresa, "B1", 001;
empresa, "B1", 999;
e;
NULL, inmuebleb;
|FIN;

|PROCESO hoja2;
|DDEFECTO #3;
|DDEFECTO #4;
|ABRE #6;
conta1 = 0; conta2 = 0; |BUCLE recapinm;
                        |BUCLE repatria;
                        |BUCLE repatrib;

|ABRE #0;
#0#0  = empresa;
#0#28 = tipo;
|LEE 040#0=;
|SI FSalida ! 0; |DDEFECTO #0; |FINSI;
|CIERRA #0;

#3#138 = #0#1;
#4#126 = #0#2;

|SI papel = 1;
    informe = "reho7142";  |HAZ continuo;
|SINO;
    informe = "rema7142";  |HAZ manual;
|FINSI;

|CIERRA #6;
|FPRC;

|PROCESO calcuprop;
|SI tipoprop = "U";
    |SI tipod = "T"; anyos = anyo1;  |FINSI;
    |SI tipod = "C"; anyos = anyo2;  |FINSI;
    |SI tipod = "1"; anyos = anyo3;  |FINSI;
    |SI tipod = "2"; anyos = anyo4;  |FINSI;
    |SI tipod = "3"; anyos = anyo5;  |FINSI;
    |SI tipod = "4"; anyos = anyo6;  |FINSI;
    |SI tipod = "G"; anyos = anyo1;  |FINSI;
    |SI tipod = "V"; anyos = anyo1;  |FINSI;
    anyos = 1994 - anyos;
|SINO;
    anyos = anyou;
|FINSI;

|SI anyos [ 20; porce = 70; |FINSI;

|SI anyos > 20;
    porce = 70 - (anyos - 20);
    |SI porce < 10; porce = 10; |FINSI;
|FINSI;

|SI tipoprop = "N"; porce = 100 - porce; |FINSI;

canti = canti % porce;
|FPRC;

|PROCESO continuo;
|INFOR informe;
|SI FSalida = 0;
    |PRINT; |PIEINF; |FININF;
|FINSI;
|FPRC;

|PROCESO manual;
|ET comienzo;
    |SI informe = "rema7142";
        #7#2 = "COLOQUE PAGINA 2 DEL PATRIMONIO, <INTRO PARA IMPRIMIR>";
    |FINSI;

    |ATRI P; |PINTA #7#2; |ATRI 0;
    |PAUSA;

    |INFOR informe;
    |SI FSalida = 0;
        |PRINT; |PIEINF; |FININF;
    |FINSI;

    |CONFI "2400NDesea repetir la hoja : ";
    |SI FSalida = 0; |VETE comienzo; |FINSI;
|FPRC;
