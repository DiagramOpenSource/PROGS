|FICHEROS;
    rez00006 #0;
    redatcon #1;    || datos contribuyentes
    reacceso #2;    || acceso datos
    repoblac #3;    || poblaciones
    rehacien #4;    || datos hacienda
    rerendtr #5;    || rend. del trabajo
    recapinm #6;    || rend. cap. inmobil.
    revalore #7;    || rend. cap. mobil. -valores bolsa
    revalono #8;    || rend. cap. mobil. -valores no bolsa
    rectacor #9;    || rend. cap. mobil. -cta.cte.
    retransp #10;   || rend. cap. mobil. -transp. fiscal
    reproedi #11;   || rend. activ.      -prof.directa
    reprofco #12;   || rend. activ.      -prof.coefi.
    reempedi #13;   || rend. activ.      -empr.directa
    reemprco #14;   || rend. activ.      -empr.coefi.
    reempmod #15;   || rend. activ.      -empr.modulos
    rededu07 #16;   || deducciones
    repatrim #17;   || patrimonio
    rededu06 #18;   || deducciones
    rededu01 #19;   || deducciones
    rededu05 #20;   || deducciones
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;

    fabre = "r   ";
    ffich = "";
    fcanl = "";
    field = "";

    cod_ant = 0;
    codigo = 0;
    sw_con = 0;
    sw_mob = 0;
    sw_act = 0;
    sw_ded = 0;
    ult_pat = 0;
    duplic = 90000;
|FIN;
____________________________________/ CALCULOS DESDE CAMPOS
|CALCULO mayus; |TIPO 0;
    #0Campo = #0Campo > #0Campo;
|PINTA #0Campo;
|FCAL;
____________________________________/ PATRIMONIO
|CALCULO patrim1;
    alfa1 = field % 101;
|SI alfa1 = " ";
        ult_pat = 0;
        alfa1 = field % 1301;
        alfa2 = field % 1401;
    |SI alfa1 = " ";     alfa1 = "A";   |FINSI;
    |SI alfa1 = "X";     alfa1 = "U";   |FINSI;
    |SI alfa2 = " ";     alfa2 = "1";   |FINSI;
        alfa1 = alfa1 + alfa2;

    |DDEFECTO #17;
    |ABRE #17;
        #17#0 = codigo;                                || contribuyente
        #17#1 = alfa1;                                 || codigo patrimonio
        alfa1 = field % 103; #17#2 = alfa1;            || linea
        #17#3 = "T";
        #17#4 = "TITULAR";
        #17#5 = field % 2324;                          || calle
        alfa1 = (field%10003)+(field%10403)+(field%10803)+(field%11203);
        #17#9 = field % 2324;                          || valor catastral
        #17#14= field % 2324;                          || descripcion

    |SI #17#2 > ult_pat;|Y #17#2 ! 0;
        |GRABA 020#17n;
    |FINSI;

    |CIERRA #17;

        ult_pat = #17#2;

|FINSI;
|FCAL;

|CALCULO patrim;
|PARA; |SI; |HACIENDO;
        field = fcanl + " 254";
    |FLEE field;
    |SI FSalida ] 0;
            alfa1 = field % 130;
        |SI alfa1 ! "LISTADO DATOS RENTA 1.993    C";
        |Y  alfa1 ! "DATOS EJERCICIOS ANTERIORES.  ";
            |HAZ patrim1;
        |SINO;
            |SI alfa1 = "LISTADO DATOS RENTA 1.993    C";
                    cod_ant = codigo;
                |HAZ codigo;
                |SI codigo ! cod_ant;
                    |SAL;
                |SINO;
                    |HAZ patrim1;
                |FINSI;
            |SINO;
                |SAL;
            |FINSI;
        |FINSI;
    |SINO;
        |SAL;
    |FINSI;
|SIGUE;
|FCAL;
____________________________________/ DEDUCCIONES DE LA CUOTA
|CALCULO dedu05;
|DDEFECTO #20;
|ABRE #20;
    #20#0 = codigo;                          || contribuyente
    alfa1 = field % 103; #20#1 = alfa1;      || linea
    #20#2 = "T";
    #20#3 = "TITULAR";
    #20#5 = field % 4130;                    || descripcion
    #20#9 = "X";                             || declaracion
|SI #20#1 ! 0;
    |GRABA 020#20n;
|FINSI;
|CIERRA #20;
|FCAL;

|CALCULO dedu01;
|DDEFECTO #19;
|ABRE #19;
    #19#0 = codigo;                          || contribuyente
    alfa1 = field % 103; #19#1 = alfa1;      || linea
    #19#2 = "T";
    #19#3 = "TITULAR";
    #19#5 = 25;                              || limite
    #19#6 = field % 4130;                    || descripcion
    #19#11= "X";                             || declaracion
|SI #19#1 ! 0;
    |GRABA 020#19n;
|FINSI;
|CIERRA #19;
|FCAL;

|CALCULO dedu06;
|DDEFECTO #18;
|ABRE #18;
    #18#0 = codigo;                          || contribuyente
    alfa1 = field % 103; #18#1 = alfa1;      || linea
    #18#2 = "T";
    #18#3 = "TITULAR";
    #18#4 = field % 4130;                    || descripcion
    #18#8 = "X";                             || declaracion
|SI #18#1 ! 0;
    |GRABA 020#18n;
|FINSI;
|CIERRA #18;
|FCAL;

|CALCULO dedu07;
    sw_ded = 0;
|DDEFECTO #16;
|ABRE #16;
    #16#0 = codigo;                                 || contribuyente
    alfa1 = field % 103; #16#1 = alfa1;             || linea
    #16#2 = "T";
    #16#3 = "TITULAR";

    alfa1 = field % 501;
|SI alfa1 = "A"; #16#4 = "E";   sw_ded = 0;    |FINSI;
|SI alfa1 = "B"; #16#4 = "S";   sw_ded = 0;    |FINSI;
|SI alfa1 = "C"; #16#4 = "E";   sw_ded = 1;    |FINSI;   || tipo
|SI alfa1 = "D"; #16#4 = "E";   sw_ded = 1;    |FINSI;
|SI alfa1 = "P"; #16#4 = "A";   sw_ded = 0;    |FINSI;

|SI sw_ded = 1;
        #16#5 = #16#4 + "/" + (field % 4128);       || descripcion
|SINO;
        #16#5 = field % 4130;                       || descripcion
|FINSI;

    #16#9 = "X";                                    || declaracion
|SI #16#1 ! 0;
    |GRABA 020#16n;
|FINSI;
|CIERRA #16;
|FCAL;

|CALCULO deducc1;
    alfa1 = field % 101;
|SI alfa1 = " ";
        sw_ded = 0;
        alfa1 = field % 501;  |QBT alfa1;
    |SI alfa1 = "A";     sw_ded=1; |FINSI;   || gtos. enfer.
    |SI alfa1 = "B";     sw_ded=1; |FINSI;   || seg. de vida
    |SI alfa1 = "C";     sw_ded=1; |FINSI;   || viv.habitual
    |SI alfa1 = "D";     sw_ded=1; |FINSI;   || adq.otras viv.
    |SI alfa1 = "P";     sw_ded=1; |FINSI;   || alquiler viv.
    |SI alfa1 = "G";     sw_ded=1; |FINSI;   || donaciones
    |SI alfa1 = "H";     sw_ded=1; |FINSI;   || ptes. ejer. anteriores
    |SI alfa1 = "O";     sw_ded=1; |FINSI;   || plusvalia (no se pasa)
    |SI alfa1 = "I";     sw_ded=1; |FINSI;   || creacion de empleo
    |SI sw_ded = 0;|Y alfa1 ! "";
            alfa1 = "    ATENCION!!! Que es <" + alfa1 + "> (DEDUCCIONES)";
        |MENAV alfa1;
    |SINO;
            alfa1 = field % 501;
        |SI alfa1 = "G";                               |HAZ dedu06;   |FINSI;
        |SI alfa1 = "H";                               |HAZ dedu01;   |FINSI;
        |SI alfa1 = "O";                                              |FINSI;
        |SI alfa1 = "I";                               |HAZ dedu05;   |FINSI;
        |SI alfa1 ! "G";|Y alfa1 ! "H";|Y alfa1 ! "O"; |HAZ dedu07;   |FINSI;
    |FINSI;
|FINSI;
|FCAL;

|CALCULO deducc;
|PARA; |SI; |HACIENDO;
        field = fcanl + " 254";
    |FLEE field;
    |SI FSalida ] 0;
            alfa1 = field % 130;
        |SI alfa1 ! "LISTADO DATOS RENTA 1.993    C";
        |Y  alfa1 ! "OTROS DATOS PATRIMONIO.       ";
            |HAZ deducc1;
        |SINO;
            |SI alfa1 = "LISTADO DATOS RENTA 1.993    C";
                    cod_ant = codigo;
                |HAZ codigo;
                |SI codigo ! cod_ant;
                    |SAL;
                |SINO;
                    |HAZ deducc1;
                |FINSI;
            |SINO;
                |SAL;
            |FINSI;
        |FINSI;
    |SINO;
        |SAL;
    |FINSI;
|SIGUE;
|FCAL;
____________________________________/ RENDIMIENTOS DE ACTIVIDADES
|CALCULO empmod;
|DDEFECTO #15;
|ABRE #15;
    #15#0 = codigo;      || contribuyente
    alfa1 = field % 103; #15#1 = alfa1;      || linea
    alfa1 = field % 13102;
|SI alfa1 = "D ";   #15#2 = "T";   #15#3 = "TITULAR";   |FINSI;
|SI alfa1 = "C ";   #15#2 = "C";   #15#3 = "CONYUGE";   |FINSI;
|SI alfa1 = "01";   #15#2 = "1";   #15#3 = "FAMILIARES";|FINSI;
|SI alfa1 = "02";   #15#2 = "2";   #15#3 = "FAMILIARES";|FINSI;
|SI alfa1 = "03";   #15#2 = "3";   #15#3 = "FAMILIARES";|FINSI;
|SI alfa1 = "04";   #15#2 = "4";   #15#3 = "FAMILIARES";|FINSI;   || tipo
    #15#4 = "X";         || declaracion
    #15#15= field % 740; || actividad
|SI #15#1 ! 0;
    |GRABA 020#15n;
|FINSI;
|CIERRA #15;
|FCAL;

|CALCULO emprco;
|DDEFECTO #14;
|ABRE #14;
    #14#0 = codigo;      || contribuyente
    alfa1 = field % 103; #14#1 = alfa1;      || linea
    alfa1 = field % 13102;
|SI alfa1 = "D ";   #14#2 = "T";   #14#3 = "TITULAR";   |FINSI;
|SI alfa1 = "C ";   #14#2 = "C";   #14#3 = "CONYUGE";   |FINSI;
|SI alfa1 = "01";   #14#2 = "1";   #14#3 = "FAMILIARES";|FINSI;
|SI alfa1 = "02";   #14#2 = "2";   #14#3 = "FAMILIARES";|FINSI;
|SI alfa1 = "03";   #14#2 = "3";   #14#3 = "FAMILIARES";|FINSI;
|SI alfa1 = "04";   #14#2 = "4";   #14#3 = "FAMILIARES";|FINSI;   || tipo
    #14#4 = "X";         || declaracion
    #14#15= field % 740; || actividad
|SI #14#1 ! 0;
    |GRABA 020#14n;
|FINSI;
|CIERRA #14;
|FCAL;

|CALCULO empedi;
|DDEFECTO #13;
|ABRE #13;
    #13#0 = codigo;      || contribuyente
    alfa1 = field % 103; #13#1 = alfa1;      || linea
    alfa1 = field % 13102;
|SI alfa1 = "D ";   #13#2 = "T";   #13#3 = "TITULAR";   |FINSI;
|SI alfa1 = "C ";   #13#2 = "C";   #13#3 = "CONYUGE";   |FINSI;
|SI alfa1 = "01";   #13#2 = "1";   #13#3 = "FAMILIARES";|FINSI;
|SI alfa1 = "02";   #13#2 = "2";   #13#3 = "FAMILIARES";|FINSI;
|SI alfa1 = "03";   #13#2 = "3";   #13#3 = "FAMILIARES";|FINSI;
|SI alfa1 = "04";   #13#2 = "4";   #13#3 = "FAMILIARES";|FINSI;   || tipo
    #13#4 = "X";         || declaracion
    #13#15= field % 740; || actividad
|SI #13#1 ! 0;
    |GRABA 020#13n;
|FINSI;
|CIERRA #13;
|FCAL;

|CALCULO profco;
|DDEFECTO #12;
|ABRE #12;
    #12#0 = codigo;      || contribuyente
    alfa1 = field % 103; #12#1 = alfa1;      || linea
    alfa1 = field % 13102;
|SI alfa1 = "D ";   #12#2 = "T";   #12#3 = "TITULAR";   |FINSI;
|SI alfa1 = "C ";   #12#2 = "C";   #12#3 = "CONYUGE";   |FINSI;
|SI alfa1 = "01";   #12#2 = "1";   #12#3 = "FAMILIARES";|FINSI;
|SI alfa1 = "02";   #12#2 = "2";   #12#3 = "FAMILIARES";|FINSI;
|SI alfa1 = "03";   #12#2 = "3";   #12#3 = "FAMILIARES";|FINSI;
|SI alfa1 = "04";   #12#2 = "4";   #12#3 = "FAMILIARES";|FINSI;   || tipo
    #12#4 = "X";         || declaracion
    #12#15= field % 740; || actividad
|SI #12#1 ! 0;
    |GRABA 020#12n;
|FINSI;
|CIERRA #12;
|FCAL;

|CALCULO proedi;
|DDEFECTO #11;
|ABRE #11;
    #11#0 = codigo;      || contribuyente
    alfa1 = field % 103; #11#1 = alfa1;      || linea
    alfa1 = field % 13102;
|SI alfa1 = "D ";   #11#2 = "T";   #11#3 = "TITULAR";   |FINSI;
|SI alfa1 = "C ";   #11#2 = "C";   #11#3 = "CONYUGE";   |FINSI;
|SI alfa1 = "01";   #11#2 = "1";   #11#3 = "FAMILIARES";|FINSI;
|SI alfa1 = "02";   #11#2 = "2";   #11#3 = "FAMILIARES";|FINSI;
|SI alfa1 = "03";   #11#2 = "3";   #11#3 = "FAMILIARES";|FINSI;
|SI alfa1 = "04";   #11#2 = "4";   #11#3 = "FAMILIARES";|FINSI;   || tipo
    #11#4 = "X";         || declaracion
    #11#15= field % 740; || actividad
|SI #11#1 ! 0;
    |GRABA 020#11n;
|FINSI;
|CIERRA #11;
|FCAL;

|CALCULO activi1;
    alfa1 = field % 101;
|SI alfa1 = " ";
        sw_act = 0;
        alfa1 = (field % 501) + (field % 5501);   |QBT alfa1;
    |SI alfa1 = "PD";|O alfa1 = "P";|O alfa1 = "AC";
                                        |HAZ proedi;   sw_act=1;
    |FINSI;
    |SI alfa1 = "PC";                   |HAZ profco;   sw_act=1; |FINSI;
    |SI alfa1 = "ED";|O alfa1 = "E";    |HAZ empedi;   sw_act=1; |FINSI;
    |SI alfa1 = "EC";                   |HAZ emprco;   sw_act=1; |FINSI;
    |SI alfa1 = "EM";                   |HAZ empmod;   sw_act=1; |FINSI;
    |SI sw_act = 0;|Y alfa1 ! "";
            alfa1 = "    ATENCION!!! Que es <" + alfa1 + "> (ACTIVIDADES)";
        |MENAV alfa1;
    |FINSI;
|FINSI;
|FCAL;

|CALCULO activi;
|PARA; |SI; |HACIENDO;
        field = fcanl + " 254";
    |FLEE field;
    |SI FSalida ] 0;
            alfa1 = field % 130;
        |SI alfa1 ! "LISTADO DATOS RENTA 1.993    C";
        |Y  alfa1 ! "INCREMENTOS Y DISMINUCIONES DE";
        |Y  alfa1 ! "DEDUCCIONES DE LA CUOTA.      ";
        |Y  alfa1 ! "OTROS DATOS PATRIMONIO.       ";
            |HAZ activi1;
        |SINO;
            |SI alfa1 = "LISTADO DATOS RENTA 1.993    C";
                    cod_ant = codigo;
                |HAZ codigo;
                |SI codigo ! cod_ant;
                    |SAL;
                |SINO;
                    |HAZ activi1;
                |FINSI;
            |SINO;
                |SAL;
            |FINSI;
        |FINSI;
    |SINO;
        |SAL;
    |FINSI;
|SIGUE;
|FCAL;
____________________________________/ RENDIMIENTOS DEL CAPITAL MOBILIARIO
|CALCULO transp;
|DDEFECTO #10;
|ABRE #10;
    #10#0 = codigo;      || contribuyente
    alfa1 = field % 103; #10#1 = alfa1;       || linea
    #10#2 = "T";
    #10#3 = "TITULAR";
    #10#4 = "X";         || declaracion
    #10#13= field % 2126;|| descripcion
|SI #10#1 ! 0;
    |GRABA 020#10n;
|FINSI;
|CIERRA #10;
|FCAL;

|CALCULO ctacor;
|DDEFECTO #9;
|ABRE #9;
    #9#0 = codigo;       || contribuyente
    alfa1 = field % 103; #9#1 = alfa1;       || linea
    #9#2 = "T";
    #9#3 = "TITULAR";
    #9#4 = "X";          || declaracion
    #9#13= field % 502;  || tipo rendimiento
    #9#14= field % 2126; || descripcion
|SI #9#1 ! 0;
    |GRABA 020#9n;
|FINSI;
|CIERRA #9;
|FCAL;

|CALCULO valono;
|DDEFECTO #8;
|ABRE #8;
    #8#0 = codigo;       || contribuyente
    alfa1 = field % 103; #8#1 = alfa1;       || linea
    #8#2 = "T";
    #8#3 = "TITULAR";
    #8#4 = "X";          || declaracion
    #8#14= field % 2126; || descripcion
    alfa1= field % 1010; #8#16 = alfa1;      || unidades
|SI #8#1 ! 0;
    |GRABA 020#8n;
|FINSI;
|CIERRA #8;
|FCAL;

|CALCULO valore;
|DDEFECTO #7;
|ABRE #7;
    #7#0 = codigo;       || contribuyente
    alfa1 = field % 103; #7#1 = alfa1;       || linea
    #7#2 = "T";
    #7#3 = "TITULAR";
    #7#4 = "X";          || declaracion
    #7#14= field % 2126; || descripcion
    alfa1= field % 1010; #7#16 = alfa1;      || unidades
|SI #7#1 ! 0;
    |GRABA 020#7n;
|FINSI;
|CIERRA #7;
|FCAL;

|CALCULO mobili1;
    alfa1 = field % 101;
|SI alfa1 = " ";
        sw_mob = 0;
        alfa1 = field % 502;  |QBT alfa1;
    |SI alfa1 = "CC";    |HAZ ctacor;   sw_mob=1; |FINSI;   || ctas. ctes.
    |SI alfa1 = "IP";    |HAZ ctacor;   sw_mob=1; |FINSI;   || imp. plazo fijo
    |SI alfa1 = "AC";    |HAZ valore;   sw_mob=1; |FINSI;   || acciones
    |SI alfa1 = "FI";    |HAZ valono;   sw_mob=1; |FINSI;   || fondos inversion
    |SI alfa1 = "BO";    |HAZ valore;   sw_mob=1; |FINSI;   || bonos
    |SI alfa1 = "LT";    |HAZ valore;   sw_mob=1; |FINSI;   || letras tesoro
    |SI alfa1 = "CH";    |HAZ valono;   sw_mob=1; |FINSI;   || cedulas hipotec.
    |SI alfa1 = "PT";    |HAZ valore;   sw_mob=1; |FINSI;   || pagares tesoro
    |SI alfa1 = "PF";    |HAZ ctacor;   sw_mob=1; |FINSI;   || plazo fijo
    |SI alfa1 = "PM";    |HAZ valore;   sw_mob=1; |FINSI;   || pagares
    |SI alfa1 = "OB";    |HAZ valore;   sw_mob=1; |FINSI;   || obligaciones
    |SI alfa1 = "PA";    |HAZ valore;   sw_mob=1; |FINSI;   || participaciones
    |SI alfa1 = "SV";    |HAZ valono;   sw_mob=1; |FINSI;   || seguros de vida
    |SI alfa1 = "LB";    |HAZ ctacor;   sw_mob=1; |FINSI;   || ¨...?
    |SI alfa1 = "OR";    |HAZ ctacor;   sw_mob=1; |FINSI;   || ¨...?
    |SI alfa1 = "AB";    |HAZ valono;   sw_mob=1; |FINSI;   || ¨...?
    |SI alfa1 = "DT";    |HAZ ctacor;   sw_mob=1; |FINSI;   || ¨...?
    |SI alfa1 = "DP";    |HAZ ctacor;   sw_mob=1; |FINSI;   || ¨...?
    |SI alfa1 = "CD";    |HAZ valono;   sw_mob=1; |FINSI;   || ¨...?
    |SI alfa1 = "AT";    |HAZ valono;   sw_mob=1; |FINSI;   || ¨...?
    |SI sw_mob = 0;|Y alfa1 ! "";
            alfa1 = "    ATENCION!!! Que es <" + alfa1 + "> (CAP.MOBILIARIO)";
        |MENAV alfa1;
    |FINSI;
|FINSI;
|FCAL;

|CALCULO mobili;
|PARA; |SI; |HACIENDO;
        field = fcanl + " 254";
    |FLEE field;
    |SI FSalida ] 0;
            alfa1 = field % 130;
        |SI alfa1 ! "LISTADO DATOS RENTA 1.993    C";
        |Y  alfa1 ! "RENDIMIENTOS DE ACTIVIDADES   ";
        |Y  alfa1 ! "INCREMENTOS Y DISMINUCIONES DE";
        |Y  alfa1 ! "DEDUCCIONES DE LA CUOTA.      ";
        |Y  alfa1 ! "OTROS DATOS PATRIMONIO.       ";
            |HAZ mobili1;
        |SINO;
            |SI alfa1 = "LISTADO DATOS RENTA 1.993    C";
                    cod_ant = codigo;
                |HAZ codigo;
                |SI codigo ! cod_ant;
                    |SAL;
                |SINO;
                    |HAZ mobili1;
                |FINSI;
            |SINO;
                |SAL;
            |FINSI;
        |FINSI;
    |SINO;
        |SAL;
    |FINSI;
|SIGUE;
|FCAL;
____________________________________/ RENDIMIENTOS DEL CAPITAL INMOBILIARIO
|CALCULO inmobi1;
    alfa1 = field % 101;
|SI alfa1 = " ";
    |DDEFECTO #6;
    |ABRE #6;
        #6#0 = codigo;                            || codigo
        alfa1 = field % 103; #6#1 = alfa1;        || linea
        #6#2 = "T";
        #6#3 = "TITULAR";
        #6#4 = field % 501;                       || rustico/urbano
        #6#5 = field % 1528;                      || entidad
        #6#13= field % 1201;                      || titularidad
        alfa1= (field%4402)+(field%4703)+(field%5103)+(field%5503);
        #6#8 = alfa1;           || valor catastral
        alfa1= (field%10102)+(field%10403)+(field%10803)+(field%11103);
        #6#27= alfa1;           || total gastos
        alfa1= (field%7102)+(field%7403)+(field%7803)+(field%8203);
        #6#47= alfa1;           || rto.
        #6#48 = "X";            || declaracion
    |SI #6#1 ! 0;
        |GRABA 020#6n;
    |FINSI;
    |CIERRA #6;
|FINSI;
|FCAL;

|CALCULO inmobi;
|PARA; |SI; |HACIENDO;
        field = fcanl + " 254";
    |FLEE field;
    |SI FSalida ] 0;
            alfa1 = field % 130;
        |SI alfa1 ! "LISTADO DATOS RENTA 1.993    C";
        |Y  alfa1 ! "RENDIMIENTOS DEL CAPITAL MOBIL";
        |Y  alfa1 ! "RENDIMIENTOS DE ACTIVIDADES   ";
        |Y  alfa1 ! "INCREMENTOS Y DISMINUCIONES DE";
        |Y  alfa1 ! "DEDUCCIONES DE LA CUOTA.      ";
        |Y  alfa1 ! "OTROS DATOS PATRIMONIO.       ";
            |HAZ inmobi1;
        |SINO;
            |SI alfa1 = "LISTADO DATOS RENTA 1.993    C";
                    cod_ant = codigo;
                |HAZ codigo;
                |SI codigo ! cod_ant;
                    |SAL;
                |SINO;
                    |HAZ inmobi1;
                |FINSI;
            |SINO;
                |SAL;
            |FINSI;
        |FINSI;
    |SINO;
        |SAL;
    |FINSI;
|SIGUE;
|FCAL;
____________________________________/ RENDIMIENTOS DEL TRABAJO
|CALCULO comple1;
    alfa1 = field % 101;
|SI alfa1 = " ";
    |DDEFECTO #5;
    |ABRE #5;
        #5#0 = codigo;                           || codigo
        alfa1 = field % 103; #5#1 = alfa1;       || linea

        alfa1 = field % 502;
    |SI alfa1 = "D ";   #5#2 = "T";    #5#3 = "TITULAR";   |FINSI;
    |SI alfa1 = "C ";   #5#2 = "C";    #5#3 = "CONYUGE";   |FINSI;
    |SI alfa1 = "01";   #5#2 = "1";    #5#3 = "FAMILIARES";|FINSI;
    |SI alfa1 = "02";   #5#2 = "2";    #5#3 = "FAMILIARES";|FINSI;
    |SI alfa1 = "03";   #5#2 = "3";    #5#3 = "FAMILIARES";|FINSI;
    |SI alfa1 = "04";   #5#2 = "4";    #5#3 = "FAMILIARES";|FINSI;   || tipo
        #5#4 = field % 2225;                     || entidad
        alfa1= (field%4803)+(field%5203)+(field%5603);  #5#7 = alfa1;|| rto.int.
        alfa1= (field%6001)+(field%6203)+(field%6603);  #5#19= alfa1;|| sindic.
        alfa1= (field%7001)+(field%7203)+(field%7603);  #5#9 = alfa1;|| retenc.
        alfa1= (field%8002)+(field%8303)+(field%8703);  #5#17= alfa1;|| s.s.

        #5#5  = #5#7 + #5#15 + #5#16 + #5#12 + #5#26;
        #5#5  = #5#5 - #5#17 - #5#18 - #5#19 - #5#20;

        #5#28 = "X";          || declaracion

    |SI #5#1 ! 0;
        |GRABA 020#5n;
    |FINSI;
    |CIERRA #5;
|FINSI;
|FCAL;

|CALCULO comple;
|PARA; |SI; |HACIENDO;
        field = fcanl + " 254";
    |FLEE field;
    |SI FSalida ] 0;
            alfa1 = field % 130;
        |SI alfa1 ! "LISTADO DATOS RENTA 1.993    C";
        |Y  alfa1 ! "RENDIMIENTOS DEL CAPITAL INMOB";
        |Y  alfa1 ! "RENDIMIENTOS DEL CAPITAL MOBIL";
        |Y  alfa1 ! "RENDIMIENTOS DE ACTIVIDADES   ";
        |Y  alfa1 ! "INCREMENTOS Y DISMINUCIONES DE";
        |Y  alfa1 ! "DEDUCCIONES DE LA CUOTA.      ";
        |Y  alfa1 ! "OTROS DATOS PATRIMONIO.       ";
            |HAZ comple1;
        |SINO;
            |SI alfa1 = "LISTADO DATOS RENTA 1.993    C";
                    cod_ant = codigo;
                |HAZ codigo;
                |SI codigo ! cod_ant;
                    |SAL;
                |SINO;
                    |HAZ comple1;
                |FINSI;
            |SINO;
                |SAL;
            |FINSI;
        |FINSI;
    |SINO;
        |SAL;
    |FINSI;
|SIGUE;
|FCAL;
____________________________________/ DATOS CONTRIBUYENTE
|CALCULO lee_hacienda;
|DDEFECTO #4;
|ABRE #4;
    #4#0 = #1#40;
    #4#1 = #1#41;
|LEE 000#4=;
|CIERRA #4;
|FCAL;

|CALCULO graba_con;
|ABRE #1;
    #1#18 = #1#7;
    #1#19 = #1#8;        || rellena la direccion de envio
    #1#20 = #1#9;
    #1#21 = #1#10;
    #1#22 = #1#11;
    #1#23 = #1#12;
    #1#24 = #1#13;
    #1#25 = #1#14;
    #1#26 = #1#15;
    #1#27 = #1#16;
|HAZ lee_hacienda;
    #1#42 = #4#2;
    #1#43 = #4#3;
|GRABA 020#1n;
|SI FSalida = 0;

    |ATRI I;
    |PINTA 2138, #1#0;
    |ATRI 0;

    |ABRE #2;
    |DDEFECTO #2;
        #2#0 = #1#0;
        #2#1 = #1#1;
        #2#2 = #1#2;     || graba el acceso
    |GRABA 020#2n;
    |CIERRA #2;

    |ABRE #3;
    |DDEFECTO #3;
        #3#0 = #1#12;
        #3#1 = #1#13;
        #3#3 = #1#14;    || graba la poblacion
    |GRABA 000#3n;
    |CIERRA #3;
|FINSI;
|CIERRA #1;
|FCAL;

|CALCULO declarante1;
    #1#0 = codigo;            || codigo
    #1#1 = field %  430;      || apellidos y nombre
    #1#2 = field % 3509;      || dni
    #1#3 = (field % 4501) + (field % 4703);  || a¤o nacimiento
    #1#7 = field % 5930;      || calle
    #1#8 = field % 9004;      || numero
    #1#9 = field % 10102;     || escalera
    #1#10= field % 9802;      || piso
    #1#11= field % 10402;     || puerta
    alfa1= field % 10702;     #1#12= alfa1;  || c.p. 1
    alfa1= field % 10903;     #1#13= alfa1;  || c.p. 2
    #1#14= field % 11320;     || localidad
    #1#16= field % 10705;     || c.p. alfa
|FCAL;

|CALCULO conyuge1;
    #1#28= field %  430;      || apellidos y nombre
    #1#29= field % 3509;      || dni
    #1#30= (field % 4501) + (field % 4703);  || a¤o nacimiento
|FCAL;

|CALCULO declarante2;
    #1#15 = field %  412;     || telefono
    #1#175= field % 1720;     || cta. bancaria titular
    alfa1 = field % 3802;     #1#40 = alfa1; || c.p. 1 admon.
    alfa1 = field % 4003;     #1#41 = alfa1; || c.p. 2 admon.
    #1#43 = field % 4425;     || nombre admon.
    alfa1 = field % 7401;     || regimen economico
|SI alfa1 = "G";    #1#37 = "X";   |SINO;  #1#37 = ""; |FINSI;
|SI alfa1 = "S";    #1#38 = "X";   |SINO;  #1#38 = ""; |FINSI;
|SI alfa1 = "O";    #1#39 = "X";   |SINO;  #1#39 = ""; |FINSI;
    alfa1 = field % 10401;    || tributacion
|SI alfa1 = "I";    #1#34 = "X";   |SINO;  #1#34 = ""; |FINSI;
|SI alfa1 = "C";    #1#35 = "X";   |SINO;  #1#35 = ""; |FINSI;
|SI alfa1 = "S";    #1#36 = "X";   |SINO;  #1#36 = ""; |FINSI;
    #1#104= field % 11001;    || tipo renta titular
|FCAL;

|CALCULO conyuge2;
    #1#176= field % 1720;     || cta. bancaria conyuge
    #1#105= field % 11001;    || tipo renta conyuge
|FCAL;

|CALCULO los_hijos;
    alfa1 = field %  202;     || nro. de hijo
    nume1 = alfa1;

    nume2 = nume1 + 163; #1nume2 = field % 801;   || parentesco familiar
    nume2 = nume1 +  57; #1nume2 = field % 1336;  || nombre otros
    nume2 = nume1 +  47; #1nume2 = field % 6309;  || nif otros
    nume2 = nume1 +  67; #1nume2 = (field % 7701) + (field % 7903);   || a¤o

    nume2 = nume1 +  77; #1nume2 = field % 8806;  || parentesco
    nume3 = nume1 + 163; alfa1 = #1nume2 % 101;
|SI alfa1 ! "H";    #1nume3 = "A"; |SINO;  #1nume3 = "H";  |FINSI;

    nume2 = nume1 +  87; #1nume2 = field % 12701; || minusvalido
|SI #1nume2 = "1";  #1nume2 = "S"; |SINO;  #1nume2 = "N";  |FINSI;
|FCAL;

|CALCULO contri1;
    alfa1 = field % 105;
|SI alfa1 = "DATOS";
        sw_con = 1;
        field = "";
    |SI alfa1 = "OTROS";
            sw_con = 2;
            field = "";
    |FINSI;
|FINSI;

    alfa1 = field % 101;
|SI alfa1 = "D";|Y sw_con = 0;  |HAZ declarante1;   |FINSI;
|SI alfa1 = "D";|Y sw_con = 1;  |HAZ declarante2;   |FINSI;
|SI alfa1 = "C";|Y sw_con = 0;  |HAZ conyuge1;      |FINSI;
|SI alfa1 = "C";|Y sw_con = 1;  |HAZ conyuge2;      |FINSI;
|SI alfa1 = " ";|Y sw_con = 2;  |HAZ los_hijos;     |FINSI;
|FCAL;

|CALCULO contri;
    sw_con = 0;
|DDEFECTO #1;
|PARA; |SI; |HACIENDO;
        field = fcanl + " 254";
    |FLEE field;
    |SI FSalida ] 0;
            alfa1 = field % 130;
        |SI alfa1 ! "LISTADO DATOS RENTA 1.993    C";
        |Y  alfa1 ! "RENDIMIENTOS DEL TRABAJO.     ";
        |Y  alfa1 ! "RENDIMIENTOS DEL CAPITAL INMOB";
        |Y  alfa1 ! "RENDIMIENTOS DEL CAPITAL MOBIL";
        |Y  alfa1 ! "RENDIMIENTOS DE ACTIVIDADES   ";
        |Y  alfa1 ! "INCREMENTOS Y DISMINUCIONES DE";
        |Y  alfa1 ! "DEDUCCIONES DE LA CUOTA.      ";
        |Y  alfa1 ! "OTROS DATOS PATRIMONIO.       ";
            |HAZ contri1;
        |SINO;
            |HAZ graba_con;
            |SAL;
        |FINSI;
    |SINO;
        |SAL;
    |FINSI;
|SIGUE;
|FCAL;

|CALCULO codigo;
    alfa1 = field % 3909;     nume1 = alfa1;
    alfa1 = nume1;  alfa1 = ("00000" + alfa1) % -105;
    codigo = alfa1;
|FCAL;

|CALCULO duplica;
|ABRE #1;
    #1#0 = codigo;
|LEE 000#1=;
|SI FSalida = 0;
        duplic = duplic + 1;
        codigo = duplic;
|FINSI;
|CIERRA #1;
|FCAL;
____________________________________/ CALCULO PRINCIPAL DE LECTURA
|CALCULO leyendo;
    alfa1 = field % 130;
|SI alfa1 = "LISTADO DATOS RENTA 1.993    C";
    |HAZ codigo;
    |HAZ duplica;
|SINO;
        alfa1 = field % 130;
    |SI alfa1 = "DECLARANTE, CONYUGE Y REPRESEN";   |HAZ contri;   |FINSI;
        alfa1 = field % 130;
    |SI alfa1 = "RENDIMIENTOS DEL TRABAJO.     ";   |HAZ comple;   |FINSI;
        alfa1 = field % 130;
    |SI alfa1 = "RENDIMIENTOS DEL CAPITAL INMOB";   |HAZ inmobi;   |FINSI;
        alfa1 = field % 130;
    |SI alfa1 = "RENDIMIENTOS DEL CAPITAL MOBIL";   |HAZ mobili;   |FINSI;
        alfa1 = field % 130;
    |SI alfa1 = "RENDIMIENTOS DE ACTIVIDADES   ";   |HAZ activi;   |FINSI;
        alfa1 = field % 130;
    |SI alfa1 = "DEDUCCIONES DE LA CUOTA.      ";   |HAZ deducc;   |FINSI;
        alfa1 = field % 130;
    |SI alfa1 = "OTROS DATOS PATRIMONIO.       ";   |HAZ patrim;   |FINSI;
        alfa1 = field % 130;
    |SI alfa1 = "LISTADO DATOS RENTA 1.993    C";
        |HAZ codigo;
        |HAZ duplica;
    |FINSI;
|FINSI;
|FCAL;

|CALCULO tipo3; |TIPO 3;
|SI #0#1 = "SI";
        ffich = #0#0;    |QBF ffich;
        ffich = fabre + ffich;
    |FABRE ffich;
    |SI FSalida ] 0;
            fcanl = FSalida;
        |PARA; |SI; |HACIENDO;
                field = fcanl + " 254";
            |FLEE field;
            |SI FSalida ] 0;
                |HAZ leyendo;
            |SINO;
                |SAL;
            |FINSI;
        |SIGUE;
        |FCIERRA fcanl;
    |FINSI;
|FINSI;
|FCAL;
