|FICHEROS
   rerendtr #2;
|FIN;

|VARIABLES;
   &empresa   = 0;
   &nombre    = "";
   &cif       = "";
   &anyos     = "";
   &impresor  = "";
   &tipo      = "";
   &swporta   = 0;
   &sw1       = 0;
   &sw21      = 0;
   &sw22      = 0;
   &sw3       = 0;
   &sw4       = 0;
   &sw5       = 0;
   &sw6       = 0;
   &sw7       = 0;
   &sw8       = 0;
   &sw9       = 0;
   &sw10      = 0;
   &swmod     = 0;
   &linea     = 0;
   &hoja      = 0;
   &vuelve    = 1;
   &seleccion = "";
   &tipore1   = 0;
   &tipore2   = 0;
   &tipore3   = 0;
   &tipore4   = 0;
   &tipore5   = 0;
   &tipore6   = 0;
   &tipore7   = 0;
   &chequeo   = 0;
   &campo     = 0;

   perce      = "";
   cabecera   = "";
   varalf     = "";
   x          = 0;
   fichero    = 0;
   conta      = 0;
   a          = 0;
   b          = 0;
   c          = 0;
|FIN;

|| **************************************************************************
||                           PROCESOS IMPRESION
|| **************************************************************************

|INCLUYE i_import;

|PROCESO cabecera;
cabecera = "************************************************************************";
|IMPRIME cabecera;
cabecera = "                        *  RELACION ADJUNTA *        ";
|IMPRIME cabecera;
cabecera = "************************************************************************";
|IMPRIME cabecera;
hoja     = hoja + 1;
importe  = hoja;
cabecera = "";                         |IMPRIME cabecera;
cabecera = "Hoja ......: " + importe;  |IMPRIME cabecera;
cabecera = "Declarante : " + nombre;   |IMPRIME cabecera;
cabecera = "NIF : " + cif;             |IMPRIME cabecera;
cabecera = "";                         |IMPRIME cabecera;
swporta  = 1;
linea    = 8;
|FPRC;

|PROCESO cabe1;
cabecera = "A) RENDIMIENTOS DEL TRABAJO (RETRIBUCIONES DINERARIAS)";
|IMPRIME cabecera;

cabecera = ""; |IMPRIME cabecera;

cabecera = "Perceptor    Persona o entidad pagadora     Retenciones  Importe integro";
|IMPRIME cabecera;
cabecera = "------------------------------------------------------------------------";
|IMPRIME cabecera;
sw21     = 1;
linea = linea + 4; |HAZ linea;
|FPRC;

|PROCESO cabe2;
|SI sw21 = 1;
    cabecera = "";
    |IMPRIME cabecera;
    |IMPRIME cabecera;
    linea = linea + 2; |HAZ linea;
|FINSI;

cabecera = "A) RENDIMIENTOS DEL TRABAJO (RETRIBUCIONES EN ESPECIE)";
|IMPRIME cabecera;
cabecera = ""; |IMPRIME cabecera;

cabecera = "Perceptor    Concepto              Valoracion   I. a cuenta Impor.integro";
|IMPRIME cabecera;
cabecera = "-------------------------------------------------------------------------";
|IMPRIME cabecera;

sw22     = 1;
linea = linea + 4; |HAZ linea;
|FPRC;

|PROCESO imprime;
|SI swporta = 0; |HAZ cabecera; |FINSI;

|SI fichero = 21; |Y sw21 = 0; |HAZ cabe1; |FINSI;
|SI fichero = 22; |Y sw22 = 0; |HAZ cabe2; |FINSI;

|IMPRIME varalf; linea = linea + 1; |HAZ linea;
|FPRC;

|PROCESO linea;
|SI linea < 58; |ACABA; |FINSI;

cabecera = ""; |IMPRIME cabecera;
cabecera = "                                                                     Sigue...";
|IMPRIME cabecera;
linea = linea + 2;
swporta = 0;
|PARA x = linea; |SI x [ 65; |HACIENDO x = x + 1;
      cabecera = ""; |IMPRIME cabecera;
|SIGUE;
|HAZ cabecera;
|FPRC;

|PROCESO pie;
|PARA x = linea; |SI x [ 65; |HACIENDO x = x + 1;
      cabecera = ""; |IMPRIME cabecera;
|SIGUE;
|FPRC;

|PROCESO carga1;
|SI #2#7 ! 0; |O #2#9 ! 0;
    conta = conta + 1;
    |SI conta < 6; |ACABA; |FINSI;

    |SI conta = 6;
       fichero = 21;
       varalf = perce;
       varalf = varalf + " " + #2#4;
       importe = #2#9;   |HAZ importe;
       varalf  = varalf + " " + importe;
       importe = #2#7;   |HAZ importe;
       varalf  = varalf + "    " + importe;
       |ACABA;
    |FINSI;
    fichero = 21;
    |SI conta = 7; |HAZ imprime; |FINSI;
    varalf = perce;
    varalf = varalf + " " + #2#4;
    importe = #2#9;   |HAZ importe;
    varalf  = varalf + " " + importe;
    importe = #2#7;   |HAZ importe;
    varalf  = varalf + "    " + importe; |HAZ imprime;
|FINSI;
|FPRC;

|PROCESO carga2;
|SI #2#15 ! 0; |O #2#16 ! 0;
    conta = conta + 1;
    |SI conta < 5; |ACABA; |FINSI;

    |SI conta = 5;
        fichero = 22;
        varalf = #2#14 % 120;
        varalf = perce + " " + varalf;
        importe = #2#15;                      |HAZ importe;
        varalf  = varalf + " " + importe;
        importe = #2#16;                      |HAZ importe;
        varalf  = varalf + " " + importe;
        a       = #2#15 + #2#16;
        importe = a;                          |HAZ importe;
        varalf  = varalf + " " + importe;
        |ACABA;
    |FINSI;

    fichero = 22;
    |SI conta = 6;  |HAZ imprime; |FINSI;
    varalf = #2#14 % 120;
    varalf = perce + " " + varalf;
    importe = #2#15;                     |HAZ importe;
    varalf  = varalf + " " + importe;
    importe = #2#16;                     |HAZ importe;
    varalf  = varalf + " " + importe;
    a       = #2#15 + #2#16;
    importe = a;                         |HAZ importe;
    varalf  = varalf + " " + importe;    |HAZ imprime;
|FINSI;
|FPRC;

|PROCESO rendtrab1;
|SI #2#28 = "X"; |ACABA; |FINSI;

|SI tipo = "A"; perce = #2#3; |SINO; perce = "TITULAR"; |FINSI;

|SI tipo = "A";     || Si es conjunta
    |HAZ carga1;
    |ACABA;
|FINSI;

|SI tipo = "T";     || Si es Titular
    |SI #2#2 = "T"; |HAZ carga1; |ACABA; |FINSI;
|FINSI;

|SI tipo = "C";     || Si es Conyuge
    |SI #2#2 = "C"; |HAZ carga1; |ACABA; |FINSI;
|FINSI;

|SI tipo = "1";     || Si es 1§ Familiar
    |SI #2#2 = "1"; |HAZ carga1; |ACABA; |FINSI;
|FINSI;

|SI tipo = "2";     || Si es 1§ Familiar
    |SI #2#2 = "2"; |HAZ carga1; |ACABA; |FINSI;
|FINSI;

|SI tipo = "3";     || Si es 3§ Familiar
    |SI #2#2 = "3"; |HAZ carga1; |ACABA; |FINSI;
|FINSI;

|SI tipo = "4";     || Si es 4§ Familiar
    |SI #2#2 = "4"; |HAZ carga1; |ACABA; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE rerendt1;
#2#1;
;
empresa, 01;
empresa, 99;
e;
NULL, rendtrab1;
|FIN;

|PROCESO rendtrab2;
|SI #2#28 = "X"; |ACABA; |FINSI;

|SI tipo = "A"; perce = #2#3; |SINO; perce = "TITULAR"; |FINSI;

|SI tipo = "A";     || Si es conjunta
    |HAZ carga2;
    |ACABA;
|FINSI;

|SI tipo = "T";     || Si es Titular
    |SI #2#2 = "T"; |HAZ carga2; |ACABA; |FINSI;
|FINSI;

|SI tipo = "C";     || Si es Conyuge
    |SI #2#2 = "C"; |HAZ carga2; |ACABA; |FINSI;
|FINSI;

|SI tipo = "1";     || Si es 1§ Familiar
    |SI #2#2 = "1"; |HAZ carga2; |ACABA; |FINSI;
|FINSI;

|SI tipo = "2";     || Si es 1§ Familiar
    |SI #2#2 = "2"; |HAZ carga2; |ACABA; |FINSI;
|FINSI;

|SI tipo = "3";     || Si es 3§ Familiar
    |SI #2#2 = "3"; |HAZ carga2; |ACABA; |FINSI;
|FINSI;

|SI tipo = "4";     || Si es 4§ Familiar
    |SI #2#2 = "4"; |HAZ carga2; |ACABA; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE rerendt2;
#2#1;
;
empresa, 01;
empresa, 99;
e;
NULL, rendtrab2;
|FIN;

|PROGRAMA;
vuelve  = 1;
Impresora = impresor;
|IMPRE -1;
|SI FSalida = 0;
   conta = 0; |BUCLE rerendt1;
   conta = 0; |BUCLE rerendt2;
   |FINIMP;
   |CORRE "readjor2.run";
|FINSI;
|FPRO;
