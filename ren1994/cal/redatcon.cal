|FICHEROS;
   redatcon #0;
   reparame #1;
   repoblac #2;
   rehacien #3;
|FIN;

|VARIABLES;
   &empresa = 0;
   &nombre  = "";
   &nif     = "";
   &modo    = 0;
   &indivi  = "";

   campi    = 0;
   x        = 0;
   esde     = 0;
   naci     = 0;
   tpar     = 0;
   minu     = 0;
   anyonum  = 0;
   anyofam  = 0;
   coefi1   = 0;
   coefi2   = 0;
   alfa1    = "";
   alfa2    = "";
   tecla    = "";
   ntecla   = 0;
   FEstado  = 0;
   avance   = "815";
   atras    = "814";
   vacio2   = "  ";
   vacio3   = "   ";
   vacio4   = "    ";
   vacio5   = "     ";
   vacio12  = "            ";
   vacio25  = "                         ";
   vacio30  = "                              ";
   rafa     = 0;
|FIN;

|INCLUYE i_letran;

|PROGRAMA;
|ABRE #0;
|PINPA #0#0;
|SI modo = 1; |O modo = 2; |HAZ pidedato; |FINSI;
|SI modo = 4; |HAZ consulta; |FINSI;
|FPRO;

|PROCESO hacienda;
|ABRE #3;
#3#0 = #0#40;
#3#1 = #0#41;
|LEE 040#3=;
|SI FSalida = 0;
   #0#42 = #3#2; |PINTA #0#42;
   #0#43 = #3#3; |PINTA #0#43;
|FINSI;
|PAUSA;
|CIERRA #3;
|FPRC;

|PROCESO pidedato;
#0#0 = empresa;
|LEE 110#0=;
FEstado = FSalida;
|SI FEstado ! 0; |DDEFECTO #0; #0#0 = empresa; |FINSI;
|PINDA #0#0;
|SI modo = 1; |HAZ parametro; |ENDATOS #1#0; |FINSI;
|SI modo = 2; |ENDATOS #2#0;  |FINSI;
|SI FSalida = 0;
    #0#0 = empresa;
    #0#1 = nombre;
    #0#2 = nif;
    indivi = "S";
    rafa = #0#30;
    |SI #0#30  ! "    "; |Y rafa ! 0; indivi = "N"; |FINSI;

    |SI #0#164 = "H"; |Y #0#68 ] "1977"; indivi = "N"; |FINSI;
    |SI #0#165 = "H"; |Y #0#69 ] "1977"; indivi = "N"; |FINSI;
    |SI #0#166 = "H"; |Y #0#70 ] "1977"; indivi = "N"; |FINSI;
    |SI #0#167 = "H"; |Y #0#71 ] "1977"; indivi = "N"; |FINSI;
    |SI #0#168 = "H"; |Y #0#72 ] "1977"; indivi = "N"; |FINSI;
    |SI #0#169 = "H"; |Y #0#73 ] "1977"; indivi = "N"; |FINSI;
    |SI #0#170 = "H"; |Y #0#74 ] "1977"; indivi = "N"; |FINSI;
    |SI #0#171 = "H"; |Y #0#75 ] "1977"; indivi = "N"; |FINSI;
    |SI #0#172 = "H"; |Y #0#76 ] "1977"; indivi = "N"; |FINSI;
    |SI #0#173 = "H"; |Y #0#77 ] "1977"; indivi = "N"; |FINSI;

    |SI indivi = "N";
        #0#34 = " ";
    |SINO;
        #0#34 = "X";
        #0#35 = " ";
        #0#36 = " ";
        #0#37 = " ";
        #0#38 = " ";
        #0#39 = " ";
    |FINSI;
    |SI #0#191 = "S"; |HAZ familiar; |FINSI;
    |SI FEstado = 0; |GRABA 020#0a; |SINO; |GRABA 020#0n; |FINSI;
    |LIBERA #0;
|FINSI;
|FPRC;

|PROCESO parametro;
|ABRE #1;
|LEE 040#1=;
|SI FSalida = 0;
    |SI #1#1 = "I";
        #0#32 = "X"; #0#33 = " ";
    |SINO;
        #0#32 = " "; #0#33 = "X";
    |FINSI;
    |SI #1#2 = "C"; #0#34 = " "; #0#35 = "X"; #0#36 = " "; |FINSI;
    |SI #1#2 = "S"; #0#34 = " "; #0#35 = " "; #0#36 = "X"; |FINSI;
    |SI #1#3 = "G"; #0#37 = "X"; #0#38 = " "; #0#39 = " "; |FINSI;
    |SI #1#3 = "S"; #0#37 = " "; #0#38 = "X"; #0#39 = " "; |FINSI;
    |SI #1#3 = "O"; #0#37 = " "; #0#38 = " "; #0#39 = "X"; |FINSI;
    |SI #1#2 = "I";
        #0#34 = "X"; #0#35 = " "; #0#36 = " ";
        #0#37 = " "; #0#38 = " "; #0#39 = " ";
    |FINSI;
    #0#40 = #1#4;
    #0#41 = #1#5;
|FINSI;
|CIERRA #1;
|FPRC;

|PROCESO consulta;
avance = &255 + avance;
atras = &255 + atras;
#0#0 = empresa;
|LEE 040#0=;
|SI FSalida = 0; |HAZ pantalla1; |FINSI;
|FPRC;

|PROCESO pantalla1;
|PINPA #0#0;
|PINDA #0#0;
|MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
|LEETECLA tecla;
|SI tecla = avance; |HAZ pantalla2; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla2;
|PINPA #1#0;
|PINDA #1#0;
|MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
|LEETECLA tecla;
|SI tecla = atras;  |HAZ pantalla1; |ACABA; |FINSI;
|SI tecla = avance; |HAZ pantalla3; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla3;
|PINPA #2#0;
|PINDA #2#0;
|MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
|LEETECLA tecla;
|SI tecla = atras;  |HAZ pantalla2; |ACABA; |FINSI;
|SI tecla = avance; |HAZ pantalla4; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla4;
|PINPA #3#0;
|PINDA #3#0;
|MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
|LEETECLA tecla;
|SI tecla = atras;  |HAZ pantalla3; |ACABA; |FINSI;
|SI tecla = avance; |HAZ pantalla5; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla5;
|PINPA #4#0;
|PINDA #4#0;
|MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
|LEETECLA tecla;
|SI tecla = atras;  |HAZ pantalla4; |ACABA; |FINSI;
|SI tecla = avance; |HAZ pantalla6; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla6;
|PINPA #5#0;
|PINDA #5#0;
|MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
|LEETECLA tecla;
|SI tecla = atras;  |HAZ pantalla5; |ACABA; |FINSI;
|SI tecla = avance; |HAZ pantalla7; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla7;
|PINPA #6#0;
|PINDA #6#0;
|MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
|LEETECLA tecla;
|SI tecla = atras; |HAZ pantalla6; |ACABA; |FINSI;
|FPRC;

||   CALCULOS DEL PROPIO PROGRAMA EN ALTA O MODIFICACION

|PROCESO envios;
|SI #0#17 = vacio2;  #0#17 = #0#6;  |PINTA #0#17; |FINSI;
|SI #0#18 = vacio30; #0#18 = #0#7;  |PINTA #0#18; |FINSI;
|SI #0#19 = vacio4;  #0#19 = #0#8;  |PINTA #0#19; |FINSI;
|SI #0#20 = vacio3;  #0#20 = #0#9;  |PINTA #0#20; |FINSI;
|SI #0#21 = vacio2;  #0#21 = #0#10; |PINTA #0#21; |FINSI;
|SI #0#22 = vacio2;  #0#22 = #0#11; |PINTA #0#22; |FINSI;
|SI #0#23 = 0;       #0#23 = #0#12; |PINTA #0#23; |FINSI;
|SI #0#24 = 0;       #0#24 = #0#13; |PINTA #0#24; |FINSI;
|SI #0#25 = vacio25; #0#25 = #0#14; |PINTA #0#25; |FINSI;
|SI #0#26 = vacio12; #0#26 = #0#15; |PINTA #0#26; |FINSI;
|SI #0#27 = vacio5;  #0#27 = #0#16; |PINTA #0#27; |FINSI;
|FPRC;

|PROCESO equis1;
  |SI Campo = 32;
      |SI #0#32 = "X"; #0#33 = " "; |PINTA #0#33; |FINSI;
  |SINO;
      |SI #0#33 = "X"; #0#32 = " "; |PINTA #0#32; |FINSI;
  |FINSI;
  |PINTA #0#32;
  |PINTA #0#33;
|FPRC;

|PROCESO equis2;
  |SI Campo = 34;
      |SI #0#34 = "X";
          #0#35 = " ";
          #0#36 = " ";
          #0#37 = " ";
          #0#38 = " ";
          #0#39 = " ",
          |PINTA #0#37;
          |PINTA #0#38;
          |PINTA #0#39;
      |FINSI;
  |FINSI;
  |SI Campo = 35;
      |SI #0#35 = "X"; #0#34 = " "; #0#36 = " "; |FINSI;
  |FINSI;
  |SI Campo = 36;
      |SI #0#36 = "X"; #0#34 = " "; #0#35 = " "; |FINSI;
  |FINSI;
  |PINTA #0#34;
  |PINTA #0#35;
  |PINTA #0#36;
|FPRC;

|PROCESO equis3;
  |SI Campo = 37;
      |SI #0#37 = "X"; #0#38 = " "; #0#39 = " "; |FINSI;
  |FINSI;
  |SI Campo = 38;
      |SI #0#38 = "X"; #0#37 = " "; #0#39 = " "; |FINSI;
  |FINSI;
  |SI Campo = 39;
      |SI #0#39 = "X"; #0#37 = " "; #0#38 = " "; |FINSI;
  |FINSI;
  |PINTA #0#37;
  |PINTA #0#38;
  |PINTA #0#39;
|FPRC;

|PROCESO codpost;
alfa1 = #0#12;
alfa1 = "00" + alfa1;
alfa1 = alfa1 % -102;
alfa2 = #0#13;
alfa2 = "000" + alfa2;
alfa2 = alfa2 % -103;
#0#16 = alfa1 + alfa2;

alfa1 = #0#23;
alfa1 = "00" + alfa1;
alfa1 = alfa1 % -102;
alfa2 = #0#24;
alfa2 = "000" + alfa2;
alfa2 = alfa2 % -103;
#0#27 = alfa1 + alfa2;
|FPRC;


|PROCESO quefami;
campi = Campo - 86;
|SI #0Campo = "P"; #0campi = "PADRES"; |FINSI;
|SI #0Campo = "H"; #0campi = "HIJO  "; |FINSI;
|SI #0Campo = "A"; #0campi = "ASCEN."; |FINSI;
|SI #0Campo = "D"; #0campi = "DESCE."; |FINSI;
|PINTA #0campi;
|FPRC;

|PROCESO sicalcul;
|POPV;
|SI #0#191 = "S";
    |HAZ familiar;
    |PINTA #0#181;
    |PINTA #0#182;
    |PINTA #0#183;
    |PINTA #0#184;
    |PINTA #0#185;
    |PINTA #0#186;
    |PINTA #0#187;
    |PINTA #0#188;
    |PINTA #0#189;
    |PINTA #0#190;
|FINSI;
|FPRC;

|PROCESO familiar;
  #0#181 = 0;
  #0#182 = 0;
  #0#183 = 0;
  #0#184 = 0;
  #0#185 = 0;
  #0#186 = 0;
  #0#187 = 0;
  #0#188 = 0;
  #0#189 = 0;
  #0#190 = 0;

|SI #0#3 ! "    ";
   anyonum = #0#3;
   anyofam = 1994 - anyonum;
   |SI anyofam ] 65; #0#187 = #0#187 + 1; |FINSI;  ||Si el Titular es mayor 65
|FINSI;

rafa = #0#30;
|SI #0#30 ! "    ";  |Y rafa ! 0;
   anyonum = #0#30;
   anyofam = 1994 - anyonum;
   |SI anyofam ] 65; #0#188 = #0#188 + 1; |FINSI; ||Si el Conyuge es mayor 65
|FINSI;

|SI #0#5  = "S"; #0#189 = #0#189 + 1; |FINSI;  ||Si el Titular es Minusvalido
|SI #0#31 = "S"; #0#190 = #0#190 + 1; |FINSI;  ||Si el Conyuge es Minusvalido

|PARA x = 1; |SI x [ 10; |HACIENDO x = x + 1;
      esde = 153 + x;
      naci = 67 + x;
      tpar = 163 + x;
      minu = 87 + x;
      |SI #0naci ! "    ";
         anyonum  = #0naci;
         anyofam  = 1994 - #0naci;

         |SI #0esde = "A"; coefi1 = 0.5; coefi2 = 0.5; |FINSI;
         |SI #0esde = "T"; coefi1 = 1;   coefi2 = 0;   |FINSI;
         |SI #0esde = "C"; coefi1 = 0;   coefi2 = 1;   |FINSI;

         |SI #0minu = "S";                       || Si son Minusvalidos
             #0#189 = #0#189 + (1 * coefi1);
             #0#190 = #0#190 + (1 * coefi2);
         |FINSI;

         |SI #0tpar = "A"; |O #0tpar = "P";      || Si son Ascendientes o Padres
             |SI anyofam ] 75;                   || Si son Mayores de 75 a¤os.
                 #0#185 = #0#185 + (1 * coefi1);
                 #0#186 = #0#186 + (1 * coefi2);
             |FINSI;
             |SI anyofam < 75;                   || Si son menores a 75 a¤os.
                 #0#183 = #0#183 + (1 * coefi1);
                 #0#184 = #0#184 + (1 * coefi2);
             |FINSI;
         |FINSI;

         |SI #0tpar = "H"; |O #0tpar = "D";      || Si son Descendiente o Hijos.
             |SI anyofam < 30;                   || Si son Menores de 30 a¤os.
                 #0#181 = #0#181 + (1 * coefi1);
                 #0#182 = #0#182 + (1 * coefi2);
             |FINSI;
             |SI anyofam > 30; |Y #0minu = "S";  || Si son Mayores a 30 y Minus.
                 #0#181 = #0#181 + (1 * coefi1);
                 #0#182 = #0#182 + (1 * coefi2);
             |FINSI;
         |FINSI;
      |FINSI;
|SIGUE;
|FPRC;

|PROCESO poblac;
  |SI #0#12 = #0#23;  |Y #0#13 = #0#24;
      #0#25 = #0#14;
      |PINTA #0#25;
  |SINO;
      |ABRE #2;
      #2#0 = #0#23;
      #2#1 = #0#24;
      |LEE 001#2=;
      |SI FSalida ! 0;
          #0#25 = #2#3;
          |PINTA #0#25;
      |FINSI;
      |CIERRA #2;
  |FINSI;
|FPRC;

|PROCESO cuadro; |TIPO 7;
|PUSHV 0501 2380;
|CUADRO 1543 2278;
|ATRI R;
|PINTA 1644, " Hay que tener en cuenta que los  ";
|PINTA 1744, " descendientes con ingresos supe- ";
|PINTA 1844, " riores al salario m¡nimo inter-  ";
|PINTA 1944, " profesional no se deducen, y el  ";
|PINTA 2044, " calculo no lo puede contemplar   ";
|PINTA 2144, " debido a ser campo modificable.  ";
|ATRI 0;
|FPRC;
