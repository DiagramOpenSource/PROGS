|FICHEROS;
    retotpat #0;

    rectacor #1;
    revalore #2;
    revalono #3;

    repatrim #4;
    refant22 #5;
    repant50 #6;
|FIN;

|VARIABLES;
   &empresa  = 0;
   &nombre   = "";
   &cif      = "";
   &impresor = "";
   &diainf   = "";
   &mesinf   = "";
   &anyoinf  = "";
   &tipo     = "";
   &cuenta   = "";
   &swdecl   = 0;
   &anyo1    = 0;
   &anyo2    = 0;
   &anyo3    = 0;
   &anyo4    = 0;
   &anyo5    = 0;
   &anyo6    = 0;
   &papel    = 0;
   &elnombre  = "";
   &apellidos = "";
   &vuelve    = 0;
   &seleccion = "";
   &campo     = 0;
   &chequeo   = 0;
   &fichero   = "";
   &p_cen     = 0;

   informe   = "";
   tipod     = "";
   clave     = "";
   tipoprop  = "";
   descr     = "";
   porce     = 0;
   anyou     = 0;
   anyos     = 0;

   var1      = 0;
   var2      = 0;
   var3      = 0;
   var4      = 0;
   var5      = 0;
   contaf1    = 0;
   contaf2    = 0;
   contaf3   = 0;
   contaf4   = 0;
   contaf5   = 0;
   canti     = 0;
   canti1    = 0;
   canti2    = 0;
   canti3    = 0;
   coefi     = 0;
|FIN;

|PROGRAMA;
vuelve = 1;
|SI papel = 2;
    |PINPA #0#6;
    #6#0 = empresa; |PINTA #6#0;
    #6#1 = nombre;  |PINTA #6#1;
|FINSI;

Impresora = impresor;
|IMPRE -1;
|SI FSalida = 0;
    |HAZ hoja5;
    |FINIMP;
    |CORRE "reem7145.run";
|FINSI;
|FPRO;

|| *************************************************************************
||                         IMPRESION HOJA 5
|| *************************************************************************

|| ***************** Cuentas corrientes  ***********************************

|PROCESO adonde1;
|SI coefi = 0; |ACABA; |FINSI;
|SI #1#29 = "F1"; |HAZ cargaf1; |FINSI;
|SI #1#29 = "F2"; |HAZ cargaf2; |FINSI;
|SI #1#29 = "F3"; |HAZ cargaf3; |FINSI;
|SI #1#29 = "F4"; |HAZ cargaf4; |FINSI;
|SI #1#29 = "F5"; |HAZ cargaf5; |FINSI;
|FPRC;

|PROCESO lee1;
|SI #1#4  = "X"; |O #1#4 = "R"; |ACABA; |FINSI;

tipoprop = #1#5;
tipod = #1#2;
descr = #1#14;

canti = #1#19;
|SI canti < #1#20; canti = #1#20; |FINSI;
|SI canti = 0; |ACABA; |FINSI;

|SI #1#5 ! "P"; anyou = #1#6; |HAZ calcuprop; |FINSI;

|SI tipo = "T";
   |SI #1#2 = "G"; coefi = 50;    |HAZ adonde1; |ACABA; |FINSI;
   |SI #1#2 = "T"; coefi = 100;   |HAZ adonde1; |ACABA; |FINSI;
   |SI #1#2 = "V"; coefi = #1#7;  |HAZ adonde1; |ACABA; |FINSI;
|FINSI;

|SI tipo = "C";
   |SI #1#2 = "G"; coefi = 50;    |HAZ adonde1; |ACABA; |FINSI;
   |SI #1#2 = "C"; coefi = 100;   |HAZ adonde1; |ACABA; |FINSI;
   |SI #1#2 = "V"; coefi = #1#8;  |HAZ adonde1; |ACABA; |FINSI;
|FINSI;

|SI tipo = "1";
   |SI #1#2 = "1"; coefi = 100;   |HAZ adonde1; |ACABA; |FINSI;
   |SI #1#2 = "V"; coefi = #1#9;  |HAZ adonde1; |ACABA; |FINSI;
|FINSI;

|SI tipo = "2";
   |SI #1#2 = "2"; coefi = 100;   |HAZ adonde1; |ACABA; |FINSI;
   |SI #1#2 = "V"; coefi = #1#10; |HAZ adonde1; |ACABA; |FINSI;
|FINSI;

|SI tipo = "3";
   |SI #1#2 = "3"; coefi = 100;   |HAZ adonde1; |ACABA; |FINSI;
   |SI #1#2 = "V"; coefi = #1#11; |HAZ adonde1; |ACABA; |FINSI;
|FINSI;

|SI tipo = "4";
   |SI #1#2 = "4"; coefi = 100;   |HAZ adonde1; |ACABA; |FINSI;
   |SI #1#2 = "V"; coefi = #1#12; |HAZ adonde1; |ACABA; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE rectacor;
 #1#1;
 ;
 empresa, 01;
 empresa, 99;
 e;
 NULL, lee1;
|FIN;
|| ***************** Valores bolsa  ***********************************

|PROCESO adonde2;
|SI coefi = 0; |ACABA; |FINSI;
|SI #2#43 = "F1"; |HAZ cargaf1; |FINSI;
|SI #2#43 = "F2"; |HAZ cargaf2; |FINSI;
|SI #2#43 = "F3"; |HAZ cargaf3; |FINSI;
|SI #2#43 = "F4"; |HAZ cargaf4; |FINSI;
|SI #2#43 = "F5"; |HAZ cargaf5; |FINSI;
|FPRC;

|PROCESO lee2;
|SI #2#4 = "X"; |O #2#4 = "R"; |ACABA; |FINSI;

tipoprop = #2#5;
tipod = #2#2;
descr = #2#14;

|SI #2#41 ! 0;
    canti = #2#41;
|SINO;
    canti = #2#19 * (#2#16 - #2#27 - #2#28 - #2#29);
|FINSI;
|SI canti = 0; |ACABA; |FINSI;

|SI #2#5 ! "P"; anyou = #2#6; |HAZ calcuprop; |FINSI;

|SI tipo = "T";
   |SI #2#2 = "G"; coefi = 50;    |HAZ adonde2; |ACABA; |FINSI;
   |SI #2#2 = "T"; coefi = 100;   |HAZ adonde2; |ACABA; |FINSI;
   |SI #2#2 = "V"; coefi = #2#7;  |HAZ adonde2; |ACABA; |FINSI;
|FINSI;

|SI tipo = "C";
   |SI #2#2 = "G"; coefi = 50;    |HAZ adonde2; |ACABA; |FINSI;
   |SI #2#2 = "C"; coefi = 100;   |HAZ adonde2; |ACABA; |FINSI;
   |SI #2#2 = "V"; coefi = #2#8;  |HAZ adonde2; |ACABA; |FINSI;
|FINSI;

|SI tipo = "1";
   |SI #2#2 = "1"; coefi = 100;   |HAZ adonde2; |ACABA; |FINSI;
   |SI #2#2 = "V"; coefi = #2#9;  |HAZ adonde2; |ACABA; |FINSI;
|FINSI;

|SI tipo = "2";
   |SI #2#2 = "2"; coefi = 100;   |HAZ adonde2; |ACABA; |FINSI;
   |SI #2#2 = "V"; coefi = #2#10; |HAZ adonde2; |ACABA; |FINSI;
|FINSI;

|SI tipo = "3";
   |SI #2#2 = "3"; coefi = 100;   |HAZ adonde2; |ACABA; |FINSI;
   |SI #2#2 = "V"; coefi = #2#11; |HAZ adonde2; |ACABA; |FINSI;
|FINSI;

|SI tipo = "4";
   |SI #2#2 = "4"; coefi = 100;   |HAZ adonde2; |ACABA; |FINSI;
   |SI #2#2 = "V"; coefi = #2#12; |HAZ adonde2; |ACABA; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE revalore;
 #2#1;
 ;
 empresa, 01;
 empresa, 99;
 e;
 NULL, lee2;
|FIN;

|| ***************** Valores no bolsa  ***********************************

|PROCESO adonde3;
|SI coefi = 0; |ACABA; |FINSI;
|SI #3#45 = "F1"; |HAZ cargaf1; |FINSI;
|SI #3#45 = "F2"; |HAZ cargaf2; |FINSI;
|SI #3#45 = "F3"; |HAZ cargaf3; |FINSI;
|SI #3#45 = "F4"; |HAZ cargaf4; |FINSI;
|SI #3#45 = "F5"; |HAZ cargaf5; |FINSI;
|FPRC;

|PROCESO lee3;
|SI #3#4 = "X"; |O #3#4 = "R"; |ACABA; |FINSI;

tipoprop = #3#5;
tipod = #3#2;
descr = #3#14;

|SI #3#43 ! 0;
    canti = #3#43;
|SINO;
   |SI #3#30 = "S";
       canti = #3#32 * (#3#16 - #3#25 - #3#26);
   |SINO;
      canti1 = #3#46 * (#3#16 - #3#25 - #3#26);
      canti2 = #3#31 * (#3#16 - #3#25 - #3#26);
      canti3 = #3#32 * (#3#16 - #3#25 - #3#26);
      canti  = canti1;
      |SI canti < canti2; canti = canti2; |FINSI;
      |SI canti < canti3; canti = canti3; |FINSI;
   |FINSI;

   |SI #3#29 = "F";
      canti1 = (#3#17 * #3#16) - #3#35 - #3#36;
   |FINSI;
|FINSI;

|SI canti = 0; |ACABA; |FINSI;

|SI #3#5 ! "P"; anyou = #3#6; |HAZ calcuprop; |FINSI;

|SI tipo = "T";
   |SI #3#2 = "G"; coefi = 50;    |HAZ adonde3; |ACABA; |FINSI;
   |SI #3#2 = "T"; coefi = 100;   |HAZ adonde3; |ACABA; |FINSI;
   |SI #3#2 = "V"; coefi = #3#7;  |HAZ adonde3; |ACABA; |FINSI;
|FINSI;

|SI tipo = "C";
   |SI #3#2 = "G"; coefi = 50;    |HAZ adonde3; |ACABA; |FINSI;
   |SI #3#2 = "C"; coefi = 100;   |HAZ adonde3; |ACABA; |FINSI;
   |SI #3#2 = "V"; coefi = #3#8;  |HAZ adonde3; |ACABA; |FINSI;
|FINSI;

|SI tipo = "1";
   |SI #3#2 = "1"; coefi = 100;   |HAZ adonde3; |ACABA; |FINSI;
   |SI #3#2 = "V"; coefi = #3#9;  |HAZ adonde3; |ACABA; |FINSI;
|FINSI;

|SI tipo = "2";
   |SI #3#2 = "2"; coefi = 100;   |HAZ adonde3; |ACABA; |FINSI;
   |SI #3#2 = "V"; coefi = #3#10; |HAZ adonde3; |ACABA; |FINSI;
|FINSI;

|SI tipo = "3";
   |SI #3#2 = "3"; coefi = 100;   |HAZ adonde3; |ACABA; |FINSI;
   |SI #3#2 = "V"; coefi = #3#11; |HAZ adonde3; |ACABA; |FINSI;
|FINSI;

|SI tipo = "4";
   |SI #3#2 = "4"; coefi = 100;   |HAZ adonde3; |ACABA; |FINSI;
   |SI #3#2 = "V"; coefi = #3#12; |HAZ adonde3; |ACABA; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE revalono;
 #3#1;
 ;
 empresa, 01;
 empresa, 99;
 e;
 NULL, lee3;
|FIN;

|| *********************** De afectos a patrimonio f1 **********************

|PROCESO cargaf1;
contaf1 = contaf1 + 1;
var1 = contaf1 - 1;  var2 = var1  + 6;

|SI contaf1 [ 6;
    #5var1 = descr;
    #5var2 = canti % coefi;
|SINO;
    #5#5   = "Seg£n relaci¢n adjunta";
    #5#11  = #5#11 + (canti  % coefi);
|FINSI;
|FPRC;

|PROCESO leef1;
|SI #4#9 = 0; |ACABA; |FINSI;
descr = #4#5;
canti = #4#9;
coefi = 100;

|SI #4#3 = "G";
    |SI tipo = "T"; coefi = 50; |HAZ cargaf1; |ACABA; |FINSI;
    |SI tipo = "C"; coefi = 50; |HAZ cargaf1; |ACABA; |FINSI;
|SINO;
    |SI tipo = #4#3; |HAZ cargaf1; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE repatrf1;
 #4#1;
 ;
 empresa, "F1", 001;
 empresa, "F1", 999;
 e;
 NULL, leef1;
|FIN;

|| *********************** De afectos a patrimonio f2 **********************

|PROCESO cargaf2;
contaf2 = contaf2 + 1;
var1 = contaf2 + 12;  var2 = var1 + 7;

|SI contaf2 [ 6;
    #5var1 = descr;
    #5var2 = canti % coefi;
|SINO;
    #5#18  = "Seg£n relaci¢n adjunta";
    #5#25  = #5#25 + (canti % coefi);
|FINSI;
|FPRC;

|PROCESO leef2;
|SI #4#9 = 0; |ACABA; |FINSI;
descr = #4#5;
canti = #4#9;
coefi = 100;

|SI #4#3 = "G";
    |SI tipo = "T"; coefi = 50; |HAZ cargaf2; |ACABA; |FINSI;
    |SI tipo = "C"; coefi = 50; |HAZ cargaf2; |ACABA; |FINSI;
|SINO;
    |SI tipo = #4#3; |HAZ cargaf2; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE repatrf2;
 #4#1;
 ;
 empresa, "F2", 001;
 empresa, "F2", 999;
 e;
 NULL, leef2;
|FIN;

|| *********************** De afectos a patrimonio f3 **********************

|PROCESO cargaf3;
contaf3 = contaf3 + 1;
var1 = contaf3 + 27;  var2 = var1 + 7;

|SI contaf3 [ 6;
    #5var1 = descr;
    #5var2 = canti % coefi;
|SINO;
    #5#33  = "Seg£n relaci¢n adjunta";
    #5#40  = #5#40 + (canti % coefi);
|FINSI;
|FPRC;

|PROCESO leef3;
|SI #4#9 = 0; |ACABA; |FINSI;
descr = #4#5;
canti = #4#9;
coefi = 100;

|SI #4#3 = "G";
    |SI tipo = "T"; coefi = 50; |HAZ cargaf3; |ACABA; |FINSI;
    |SI tipo = "C"; coefi = 50; |HAZ cargaf3; |ACABA; |FINSI;
|SINO;
    |SI tipo = #4#3; |HAZ cargaf3; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE repatrf3;
 #4#1;
 ;
 empresa, "F3", 001;
 empresa, "F3", 999;
 e;
 NULL, leef3;
|FIN;

|| *********************** De afectos a patrimonio f4 **********************

|PROCESO cargaf4;
contaf4 = contaf4 + 1;
var1 = contaf4 + 42;  var2 = var1 + 9;

|SI contaf4 [ 6;
    #5var1 = descr;
    #5var2 = canti % coefi;
|SINO;
    #5#48  = "Seg£n relaci¢n adjunta";
    #5#57  = #5#57 + (canti % coefi);
|FINSI;
|FPRC;

|PROCESO leef4;
|SI #4#9 = 0; |ACABA; |FINSI;
descr = #4#5;
canti = #4#9;
coefi = 100;

|SI #4#3 = "G";
    |SI tipo = "T"; coefi = 50; |HAZ cargaf4; |ACABA; |FINSI;
    |SI tipo = "C"; coefi = 50; |HAZ cargaf4; |ACABA; |FINSI;
|SINO;
    |SI tipo = #4#3; |HAZ cargaf4; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE repatrf4;
 #4#1;
 ;
 empresa, "F4", 001;
 empresa, "F4", 999;
 e;
 NULL, leef4;
|FIN;

|| *********************** De afectos a patrimonio f5 **********************

|PROCESO cargaf5;
contaf5 = contaf5 + 1;
var1 = contaf5 + 61;  var2 = var1 + 7;

|SI contaf5 [ 6;
    #5var1 = descr;
    #5var2 = canti % coefi;
|SINO;
    #5#67  = "Seg£n relaci¢n adjunta";
    #5#74  = #5#74 + (canti % coefi);
|FINSI;
|FPRC;

|PROCESO leef5;
|SI #4#9 = 0; |ACABA; |FINSI;
descr = #4#5;
canti = #4#9;
coefi = 100;

|SI #4#3 = "G";
    |SI tipo = "T"; coefi = 50; |HAZ cargaf5; |ACABA; |FINSI;
    |SI tipo = "C"; coefi = 50; |HAZ cargaf5; |ACABA; |FINSI;
|SINO;
    |SI tipo = #4#3; |HAZ cargaf5; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE repatrf5;
 #4#1;
 ;
 empresa, "F5", 001;
 empresa, "F5", 999;
 e;
 NULL, leef5;
|FIN;

|PROCESO hoja5;
|DDEFECTO #5;
    contaf1 = 0;
    contaf2 = 0;
    contaf3 = 0;
    contaf4 = 0;

|BUCLE rectacor;
|BUCLE revalore;
|BUCLE revalono;

|BUCLE repatrf1;
|BUCLE repatrf2;
|BUCLE repatrf3;
|BUCLE repatrf4;
|BUCLE repatrf5;

|ABRE #0;
    #0#0  = empresa;
    #0#28 = tipo;
|LEE 040#0=;
|SI FSalida ! 0; |DDEFECTO #0; |FINSI;
|CIERRA #0;

    #5#12 = #0#7;             || total f1
    #5#27 = #0#8;             || total f2
    #5#42 = #0#44;            || total f3
    #5#61 = #0#45 - #0#47;    || total f4
    #5#76 = #0#47;            || total f5
    #5#77 = #0#45;            || total f4+f5

|SI papel = 1;
    informe = "reho7145"; |HAZ continuo;
|SINO;
    informe = "rema7145"; |HAZ manual;
|FINSI;

|FPRC;

|PROCESO calcuprop;
|SI tipoprop = "U";
    |SI tipod = "T"; anyos = anyo1;  |FINSI;
    |SI tipod = "C"; anyos = anyo2;  |FINSI;
    |SI tipod = "1"; anyos = anyo3;  |FINSI;
    |SI tipod = "2"; anyos = anyo4;  |FINSI;
    |SI tipod = "3"; anyos = anyo5;  |FINSI;
    |SI tipod = "4"; anyos = anyo6;  |FINSI;
    |SI tipod = "G"; anyos = anyo1;  |FINSI;
    |SI tipod = "V"; anyos = anyo1;  |FINSI;
    anyos = 1994 - anyos;
|SINO;
    anyos = anyou;
|FINSI;

|SI anyos [ 20; porce = 70; |FINSI;

|SI anyos > 20;
    porce = 70 - (anyos - 20);
    |SI porce < 10; porce = 10; |FINSI;
|FINSI;

|SI tipoprop = "N"; porce = 100 - porce; |FINSI;

canti = canti % porce;
|FPRC;

|PROCESO continuo;
|INFOR informe;
|SI FSalida = 0;
    |PRINT; |PIEINF; |FININF;
|FINSI;
|FPRC;

|PROCESO manual;
|ET comienzo;
    |SI informe = "rema7145";
        #6#2 = "COLOQUE PAGINA 5 DEL PATRIMONIO, <INTRO PARA IMPRIMIR>";
    |FINSI;

    |ATRI P; |PINTA #6#2; |ATRI 0;
    |PAUSA;

    |INFOR informe;
    |SI FSalida = 0;
        |PRINT; |PIEINF; |FININF;
    |FINSI;

    |CONFI "2400NDesea repetir la hoja : ";
    |SI FSalida = 0; |VETE comienzo; |FINSI;
|FPRC;
