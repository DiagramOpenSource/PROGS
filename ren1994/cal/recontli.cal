|FICHEROS;
    recontli #0;
    eosconce #1;
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    agieos = "";
    sw_no = 0;
|FIN;

|CALCULO path;
|DBASS alfa1;
    agieos = alfa1 + "agieos/fich/";
|PATH_DAT #1 agieos;
    agieos = alfa1 + "agieos/pan/";
|PATH_PAN #1 agieos;
|FCAL;

|PROGRAMA;
|HAZ path;
|CLS;
|CABEZA "Control Libros";
|PINPA #0#0;
|ENTLINEAL #1#0, 1, 1, 20, 0, min, max;
|FPRO;

|CALCULO min;
    #0#0 = 1;
|FCAL;

|CALCULO max;
    #0#0 = 99;
|FCAL;

|CALCULO noentres; |TIPO 0;
|DDEFECTO #1;
|ABRE #1;
    #1#0 = #0#0;
|LEE 001#1=;
|SI FSalida = 0;
    |SI #0#2 ! "I";|Y #0#2 ! "G";
        |MENAV "    Concepto distinto de INGRESOS Y GASTOS ...";
        |ERROR;
        |PTEC 807;
    |FINSI;
|FINSI;
|CIERRA #1;
|FCAL;

|CALCULO ant_pb; |TIPO 7;
|ATRI R;
|SI #0#2 = "G";
    ||            123456789012345
    |PINTA 0666, "Compras        ";
    |PINTA 0766, "Coste Personal ";
    |PINTA 0866, "Energia,Agua,  ";
    |PINTA 0966, "Alqui.Locales  ";
    |PINTA 1066, "Gtos.Financ.   ";
    |PINTA 1166, "Tributos       ";
    |PINTA 1266, "Repa. y Cons.  ";
    |PINTA 1366, "Trab.otr.Empr. ";
    |PINTA 1466, "               ";
    |PINTA 1566, "               ";
    |PINTA 1666, "               ";
    |PINTA 1766, "               ";
    |PINTA 1866, "               ";
    |PINTA 1966, "               ";
    |PINTA 2066, "               ";
    |PINTA 2166, "               ";
    |PINTA 2266, "               ";
    |PINTA 2366, "               ";
|FINSI;
|SI #0#2 = "I";
    ||            123456789012345
    |PINTA 0666, "Ingres.Integros";
    |PINTA 0766, "               ";
    |PINTA 0866, "               ";
    |PINTA 0966, "               ";
    |PINTA 1066, "               ";
    |PINTA 1166, "               ";
    |PINTA 1266, "               ";
    |PINTA 1366, "               ";
    |PINTA 1466, "               ";
    |PINTA 1566, "               ";
    |PINTA 1666, "               ";
    |PINTA 1766, "               ";
    |PINTA 1866, "               ";
    |PINTA 1966, "               ";
    |PINTA 2066, "               ";
    |PINTA 2166, "               ";
    |PINTA 2266, "               ";
    |PINTA 2366, "               ";
|FINSI;
|ATRI 0;
|FCAL;

|CALCULO top_pb; |TIPO 0;
    sw_no = 0;
|SI #0#2 = "I";|Y #0#3 > 1;  sw_no = 1;  |FINSI;
|SI #0#2 = "G";|Y #0#3 > 8;  sw_no = 1;  |FINSI;
|SI sw_no = 1;
    |HAZ no_dejar;
    |ERROR;
|FINSI;
|FCAL;

|CALCULO ant_eb; |TIPO 7;
|ATRI R;
|SI #0#2 = "G";
    ||            123456789012345
    |PINTA 0666, "Compras        ";
    |PINTA 0766, "Coste Personal ";
    |PINTA 0866, "Energia,Agua,  ";
    |PINTA 0966, "Alqui.Locales  ";
    |PINTA 1066, "Gtos.Financ.   ";
    |PINTA 1166, "Tributos       ";
    |PINTA 1266, "Repa. y Cons.  ";
    |PINTA 1366, "Trab.otr.Empr. ";
    |PINTA 1466, "               ";
    |PINTA 1566, "               ";
    |PINTA 1666, "               ";
    |PINTA 1766, "               ";
    |PINTA 1866, "               ";
    |PINTA 1966, "               ";
    |PINTA 2066, "               ";
    |PINTA 2166, "               ";
    |PINTA 2266, "               ";
    |PINTA 2366, "               ";
|FINSI;
|SI #0#2 = "I";
    ||            123456789012345
    |PINTA 0666, "Ingres.Integros";
    |PINTA 0766, "               ";
    |PINTA 0866, "               ";
    |PINTA 0966, "               ";
    |PINTA 1066, "               ";
    |PINTA 1166, "               ";
    |PINTA 1266, "               ";
    |PINTA 1366, "               ";
    |PINTA 1466, "               ";
    |PINTA 1566, "               ";
    |PINTA 1666, "               ";
    |PINTA 1766, "               ";
    |PINTA 1866, "               ";
    |PINTA 1966, "               ";
    |PINTA 2066, "               ";
    |PINTA 2166, "               ";
    |PINTA 2266, "               ";
    |PINTA 2366, "               ";
|FINSI;
|ATRI 0;
|FCAL;

|CALCULO top_eb; |TIPO 0;
    sw_no = 0;
|SI #0#2 = "I";|Y #0#4 > 1;  sw_no = 1;  |FINSI;
|SI #0#2 = "G";|Y #0#4 > 8;  sw_no = 1;  |FINSI;
|SI sw_no = 1;
    |HAZ no_dejar;
    |ERROR;
|FINSI;
|FCAL;

|CALCULO ant_pc; |TIPO 7;
|ATRI R;
|SI #0#2 = "G";
    ||            123456789012345
    |PINTA 0666, "Mat.Consumidos ";
    |PINTA 0766, "Coste Personal ";
    |PINTA 0866, "Int.Prestamos  ";
    |PINTA 0966, "Alqui.Locales  ";
    |PINTA 1066, "Amortizacion   ";
    |PINTA 1166, "Energia, Agua, ";
    |PINTA 1266, "Otros Gastos   ";
    |PINTA 1366, "               ";
    |PINTA 1466, "               ";
    |PINTA 1566, "               ";
    |PINTA 1666, "               ";
    |PINTA 1766, "               ";
    |PINTA 1866, "               ";
    |PINTA 1966, "               ";
    |PINTA 2066, "               ";
    |PINTA 2166, "               ";
    |PINTA 2266, "               ";
    |PINTA 2366, "               ";
|FINSI;
|SI #0#2 = "I";
    ||            123456789012345
    |PINTA 0666, "Ingres.Integros";
    |PINTA 0766, "               ";
    |PINTA 0866, "               ";
    |PINTA 0966, "               ";
    |PINTA 1066, "               ";
    |PINTA 1166, "               ";
    |PINTA 1266, "               ";
    |PINTA 1366, "               ";
    |PINTA 1466, "               ";
    |PINTA 1566, "               ";
    |PINTA 1666, "               ";
    |PINTA 1766, "               ";
    |PINTA 1866, "               ";
    |PINTA 1966, "               ";
    |PINTA 2066, "               ";
    |PINTA 2166, "               ";
    |PINTA 2266, "               ";
    |PINTA 2366, "               ";
|FINSI;
|ATRI 0;
|FCAL;

|CALCULO top_pc; |TIPO 0;
    sw_no = 0;
|SI #0#2 = "I";|Y #0#5 > 1;  sw_no = 1;  |FINSI;
|SI #0#2 = "G";|Y #0#5 > 7;  sw_no = 1;  |FINSI;
|SI sw_no = 1;
    |HAZ no_dejar;
    |ERROR;
|FINSI;
|FCAL;

|CALCULO ant_ec; |TIPO 7;
|ATRI R;
|SI #0#2 = "G";
    ||            123456789012345
    |PINTA 0666, "Tributos       ";
    |PINTA 0766, "Mat.Primas     ";
    |PINTA 0866, "Coste Personal ";
    |PINTA 0966, "Seg. Social    ";
    |PINTA 1066, "Planes Pensio. ";
    |PINTA 1166, "Honor.Profes.  ";
    |PINTA 1266, "Alquileres     ";
    |PINTA 1366, "Int.Prestamos  ";
    |PINTA 1466, "Amortizacion   ";
    |PINTA 1566, "Rep. y Cons.   ";
    |PINTA 1666, "Energia, Agua, ";
    |PINTA 1766, "Primas Segur.  ";
    |PINTA 1866, "Dudoso Cobro   ";
    |PINTA 1966, "Reduc.Fond.Ed. ";
    |PINTA 2066, "Fondos Rever.  ";
    |PINTA 2166, "Gtos.Admon.    ";
    |PINTA 2266, "Cuotas Corp.   ";
    |PINTA 2366, "Otros Gastos   ";
|FINSI;
|SI #0#2 = "I";
    ||            123456789012345
    |PINTA 0666, "Ingres.Ordinar.";
    |PINTA 0766, "Autoconsumo    ";
    |PINTA 0866, "Subvenciones   ";
    |PINTA 0966, "Otras Transfer.";
    |PINTA 1066, "Ingres.Financ. ";
    |PINTA 1166, "Otros Ingres.  ";
    |PINTA 1266, "               ";
    |PINTA 1366, "               ";
    |PINTA 1466, "               ";
    |PINTA 1566, "               ";
    |PINTA 1666, "               ";
    |PINTA 1766, "               ";
    |PINTA 1866, "               ";
    |PINTA 1966, "               ";
    |PINTA 2066, "               ";
    |PINTA 2166, "               ";
    |PINTA 2266, "               ";
    |PINTA 2366, "               ";
|FINSI;
|ATRI 0;
|FCAL;

|CALCULO top_ec; |TIPO 0;
    sw_no = 0;
|SI #0#2 = "I";|Y #0#6 >  6;  sw_no = 1;  |FINSI;
|SI #0#2 = "G";|Y #0#6 > 18;  sw_no = 1;  |FINSI;
|SI sw_no = 1;
    |HAZ no_dejar;
    |ERROR;
|FINSI;
|FCAL;

|CALCULO no_dejar;
|MENAV "    ATENCION!!! Error de Entrada ...";
|FCAL;

|CALCULO limpia; |TIPO 7;
|ATRI R;
|PINTA 0666, "               ";
|PINTA 0766, "               ";
|PINTA 0866, "               ";
|PINTA 0966, "               ";
|PINTA 1066, "               ";
|PINTA 1166, "               ";
|PINTA 1266, "               ";
|PINTA 1366, "               ";
|PINTA 1466, "               ";
|PINTA 1566, "               ";
|PINTA 1666, "               ";
|PINTA 1766, "               ";
|PINTA 1866, "               ";
|PINTA 1966, "               ";
|PINTA 2066, "               ";
|PINTA 2166, "               ";
|PINTA 2266, "               ";
|PINTA 2366, "               ";
|ATRI 0;
|FCAL;
