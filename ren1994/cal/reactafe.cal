|FICHEROS;
   reactafe #0;
   reproedi #1;
   reprofco #2;
   reempedi #3;
   reemprco #4;
   reempmod #5;
|FIN;

|VARIABLES;
   FEstado      = 0;
   suma         = 0;
   valor        = 0;
   pantalla     = 0;
   pd           = "PD";
   pc           = "PC";
   ed           = "ED";
   ec           = "EC";
   em           = "EM";
   sw           = 0;
   incremento   = 0;
   disminucion  = 0;
   disminucioe  = 0;
   linea        = 0;
   pepe         = 0;

   &empresa     = 0;
   &modo        = 0;
   &modelito    = 0;
   &tipomod     = "";
   &errorlin    = 0;
   &indivi      = "";

   &numerica1   = 0;  &numerica2  = 0;   &numerica3  = 0;
   &numerica4   = 0;  &numerica5  = 0;   &numerica6  = 0;
   &numerica7   = 0;  &numerica8  = 8;   &numerica9  = 0;
   &numerica10  = 0;  &numerica11 = 8;   &numerica12 = 0;
   &numerica13  = 0;  &numerica14 = 8;   &numerica15 = 0;
   &numerica16  = 0;  &numerica17  = 0;  &numerica18  = 0;

   &alfanumer1  = ""; &alfanumer2 = "";  &alfanumer3 = "";
   &alfanumer4  = ""; &alfanumer5 = "";  &alfanumer6 = "";
   &alfanumer7  = ""; &alfanumer8 = "";  &alfanumer9 = "";
   &alfanumer10 = ""; &alfanumer11 = ""; &alfanumer12 = "";
   &alfanumer13 = ""; &alfanumer14 = ""; &alfanumer15 = "";

   &fechas1     = @; &fechas2     = @;   &fechas3    = @;
   &fechas4     = @; &fechas5     = @;   &fechas6    = @;
|FIN;

|INCLUYE i_activo;

|RUTINA inferior;
  #0#0 = empresa;
  #0#1 = 1;
|FRUT;

|RUTINA superior;
  #0#0 = empresa;
  #0#1 = 99;
|FRUT;

|PROGRAMA;
|ABRE #0;
|PINPA #0#0;
|SI modo = 1;
    |ENTLINEAL #1#0,2,1,15,0,inferior,superior;
|FINSI;
|SI modo = 2;
    |ENTLINEAL #1#0,2,2,15,0,inferior,superior;
|FINSI;
|SI modo = 4;
    |ENTLINEAL #1#0,2,4,15,0,inferior,superior;
|FINSI;
|HAZ actual;
|FPRO;

|PROCESO ayuda; |TIPO 2;
pantalla = 0 +. 1;
|SI pantalla = 1;
   |SI #0#2 = "PD"; |HAZ profdire; |FINSI;
   |SI #0#2 = "PC"; |HAZ profcoef; |FINSI;
   |SI #0#2 = "ED"; |HAZ emprdire; |FINSI;
   |SI #0#2 = "EC"; |HAZ emprcoef; |FINSI;
   |SI #0#2 = "EM"; |HAZ emprmodu; |FINSI;
   |SI FEstado = 0; |HAZ cargadat;  |FINSI;
|FINSI;
|FPRC;

|PROCESO consulta; |TIPO 0;
modelito = (FEntrada / 100) ! 0;
|SI modelito = 4; |HAZ cargadat; |FINSI;
|FPRC;

|PROCESO cargadat;
|HAZ carga;
|SUB_EJECUTA "repant13.run";
|SI errorlin = 0;
    |ERROR;
|SINO;
   |SI modelito ! 4; |HAZ descarga; |PINTA #0#26; |FINSI;
|FINSI;
|FPRC;

|PROCESO descarga;
#0#7  = alfanumer1;
#0#8  = alfanumer2;
#0#9  = numerica1;
#0#10 = numerica2;
#0#11 = numerica3;
#0#12 = fechas1;
#0#13 = numerica4;
#0#14 = numerica5;
#0#15 = fechas2;
#0#16 = fechas3;
#0#17 = fechas4;
#0#18 = numerica6;
#0#19 = numerica7;
#0#20 = numerica8;
#0#21 = alfanumer3;
#0#22 = alfanumer4;
#0#23 = alfanumer5;
#0#24 = numerica9;
#0#25 = fechas5;
#0#26 = numerica10;
#0#27 = alfanumer6;
#0#28 = alfanumer7;
#0#29 = numerica11;
#0#30 = fechas6;
#0#31 = numerica12;
#0#32 = numerica13;
#0#33 = numerica14;
#0#34 = numerica15;
#0#35 = alfanumer8;
#0#36 = alfanumer9;
#0#44 = alfanumer10;
#0#45 = numerica16;
#0#46 = numerica17;
#0#47 = numerica18;
#0#48 = alfanumer11;
#0#49 = alfanumer12;
#0#50 = alfanumer13;
#0#51 = alfanumer14;
#0#52 = alfanumer15;
npro  = 12; |HAZ sigrabo;
|FPRC;

|PROCESO carga;
alfanumer1 = #0#7;
alfanumer2 = #0#8;
numerica1  = #0#9;
numerica2  = #0#10;
numerica3  = #0#11;
fechas1    = #0#12;
numerica4  = #0#13;
numerica5  = #0#14;
fechas2    = #0#15;
fechas3    = #0#16;
fechas4    = #0#17;
numerica6  = #0#18;
numerica7  = #0#19;
numerica8  = #0#20;
alfanumer3 = #0#21;
alfanumer4 = #0#22;
alfanumer5 = #0#23;
numerica9  = #0#24;
fechas5    = #0#25;
numerica10 = #0#26;
alfanumer6 = #0#27;
alfanumer7 = #0#28;
numerica11 = #0#29;
fechas6    = #0#30;
numerica12 = #0#31;
numerica13 = #0#32;
numerica14 = #0#33;
numerica15 = #0#34;
alfanumer8 = #0#35;
alfanumer9 = #0#36;
alfanumer10 = #0#44;
numerica16 = #0#45;
numerica17 = #0#46;
numerica18 = #0#47;
alfanumer11 = #0#48;
alfanumer12 = #0#49;
alfanumer13 = #0#50;
alfanumer14 = #0#51;
alfanumer15 = #0#52;
|FPRC;

|PROCESO profdire;
|ABRE #1;
#1#0 = #0#0;
#1#1 = #0#3;
|LIBERA #1;
|LEE 110#1=;
FEstado = FSalida;
|SI FSalida = 0;
   #0#4  = #1#2;
   #0#5  = #1#3;
   #0#6  = #1#15;
   #0#37 = #1#4;
   #0#38 = #1#7;
   #0#39 = #1#8;
   #0#40 = #1#9;
   #0#41 = #1#10;
   #0#42 = #1#11;
   #0#43 = #1#12;
   #0#45 = #1#35;
   #0#50 = #1#13 + #1#14;
   |PINTA #0#4;
   |PINTA #0#5;
   |PINTA #0#6;
|SINO;
   |MENAV "     No existe registro en Actividad";
   |ERROR; |ACABA;
|FINSI;
|LIBERA #1;
|CIERRA #1;
|FPRC;

|PROCESO profcoef;
|ABRE #2;
#2#0 = #0#0;
#2#1 = #0#3;
|LEE 040#2=;
FEstado = FSalida;
|SI FSalida = 0;
   #0#4  = #2#2;
   #0#5  = #2#3;
   #0#6  = #2#15;
   #0#37 = #2#4;
   #0#38 = #2#7;
   #0#39 = #2#8;
   #0#40 = #2#9;
   #0#41 = #2#10;
   #0#42 = #2#11;
   #0#43 = #2#12;
   #0#45 = #2#42;
   #0#50 = #2#13 + #2#14;
   |PINTA #0#4;
   |PINTA #0#5;
   |PINTA #0#6;
|SINO;
   |MENAV "     No existe registro Rendimiento Irregulares";
   |ERROR; |ACABA;
|FINSI;
|CIERRA #2;
|FPRC;

|PROCESO emprdire;
|ABRE #3;
#3#0 = #0#0;
#3#1 = #0#3;
|LEE 040#3=;
FEstado = FSalida;
|SI FSalida = 0;
   #0#4  = #3#2;
   #0#5  = #3#3;
   #0#6  = #3#15;
   #0#37 = #3#4;
   #0#38 = #3#7;
   #0#39 = #3#8;
   #0#40 = #3#9;
   #0#41 = #3#10;
   #0#42 = #3#11;
   #0#43 = #3#12;
   #0#45 = #3#54;
   #0#50 = #3#13 + #3#14;
   |PINTA #0#4;
   |PINTA #0#5;
   |PINTA #0#6;
|SINO;
   |MENAV "     No existe registro Rendimiento Irregulares";
   |ERROR; |ACABA;
|FINSI;
|CIERRA #3;
|FPRC;

|PROCESO emprcoef;
|ABRE #4;
#4#0 = #0#0;
#4#1 = #0#3;
|LEE 040#4=;
FEstado = FSalida;
|SI FSalida = 0;
   #0#4  = #4#2;
   #0#5  = #4#3;
   #0#6  = #4#15;
   #0#37 = #4#4;
   #0#38 = #4#7;
   #0#39 = #4#8;
   #0#40 = #4#9;
   #0#41 = #4#10;
   #0#42 = #4#11;
   #0#43 = #4#12;
   #0#45 = #4#43;
   #0#50 = #4#13 + #4#14;
   |PINTA #0#4;
   |PINTA #0#5;
   |PINTA #0#6;
|SINO;
   |MENAV "     No existe registro Rendimiento Irregulares";
   |ERROR; |ACABA;
|FINSI;
|CIERRA #4;
|FPRC;

|PROCESO emprmodu;
|ABRE #5;
#5#0 = #0#0;
#5#1 = #0#3;
|LEE 040#5=;
FEstado = FSalida;
|SI FSalida = 0;
   #0#4  = #5#2;
   #0#5  = #5#3;
   #0#6  = #5#15;
   #0#37 = #5#4;
   #0#38 = #5#7;
   #0#39 = #5#8;
   #0#40 = #5#9;
   #0#41 = #5#10;
   #0#42 = #5#11;
   #0#43 = #5#12;
   #0#45 = #5#54;
   #0#50 = #5#13 + #5#14;
   |PINTA #0#4;
   |PINTA #0#5;
   |PINTA #0#6;
|SINO;
   |MENAV "     No existe registro Rendimiento Irregulares";
   |ERROR; |ACABA;
|FINSI;
|CIERRA #5;
|FPRC;

|| **************************************************************************
||                          PROCESO ACTUALIZACION
|| **************************************************************************

|PROCESO acumula1;  || Profesional Directa
|SI sw = 0; incremento = 0; disminucion = 0; linea = #0#3; sw = 1; |FINSI;
|SI linea ! #0#3;
   |HAZ grabafic1;
   linea = #0#3;
|SINO;
   |SI #0#26 > 0;
       incremento = incremento + (#0#26 - #0#34);
   |SINO;
       disminucion = disminucion + (#0#26 * -1);
   |FINSI;
|FINSI;
|FPRC;

|PROCESO grabafic1;
#1#0 = empresa;
#1#1 = linea;
|LIBERA #1;
|LEE 110#1=;
|SI FSalida = 0;
    #1#33 = incremento;
    #1#34 = disminucion;
    #1#27 = #1#33 - #1#34;
    |SI #1#27 < 0; #1#27 = 0; |FINSI;
    #1#28 = #1#16 - #1#26 + #1#27;
    |GRABA 020#1a;
|FINSI;
|FPRC;

|PROCESO acumula2;  || Profesional Coeficientes
|SI sw = 0;
   incremento = 0; disminucion = 0; disminucioe = 0;
   linea = #0#3; sw = 1;
|FINSI;

|SI linea ! #0#3;
   |HAZ grabafic2;
   linea = #0#3;
|SINO;
   |SI #0#26 > 0;
       incremento = incremento + (#0#26 - #0#34);
   |SINO;
       |SI #0#27 = "N";
           disminucion = disminucion + (#0#26 * -1);
       |SINO;
           disminucioe = disminucioe + (#0#26 * -1);
       |FINSI;
   |FINSI;
|FINSI;
|FPRC;

|PROCESO grabafic2;
#2#0 = empresa;
#2#1 = linea;
|LIBERA #2;
|LEE 110#2=;
|SI FSalida = 0;
    #2#26 = incremento;
    #2#27 = disminucion;
    #2#28 = disminucioe;
    #2#31 = #2#26 - #2#27 - #2#28 - #2#29;
    ||   |SI #2#31 < 0; #2#31 = 0; |FINSI;  ||Preguntar
    #2#32 = #2#41 + #2#31;
    |GRABA 020#2a;
|FINSI;
|FPRC;

|PROCESO acumula3;  || Empresarial Directa
|SI sw = 0; incremento = 0; disminucion = 0; linea = #0#3; sw = 1; |FINSI;
|SI linea ! #0#3;
   |HAZ grabafic3;
   linea = #0#3;
|SINO;
   |SI #0#26 > 0;
       incremento = incremento + (#0#26 - #0#34);
   |SINO;
       disminucion = disminucion + (#0#26 * -1);
   |FINSI;
|FINSI;
|FPRC;

|PROCESO grabafic3;
#3#0 = empresa;
#3#1 = linea;
|LIBERA #3;
|LEE 110#3=;
|SI FSalida = 0;
    #3#46 = incremento;
    #3#47 = disminucion;
    #3#48 = #3#46 - #3#47;
    |SI #3#48 < 0; #3#48 = 0; |FINSI;
    #3#49 = #3#45 + #3#48;
    |GRABA 020#3a;
|FINSI;
|FPRC;

|PROCESO acumula4;  || Empresarial Coeficiente
|SI sw = 0;
   incremento = 0; disminucion = 0; disminucioe = 0;
   linea = #0#3; sw = 1;
|FINSI;

|SI linea ! #0#3;
   |HAZ grabafic4;
   linea = #0#3;
|SINO;
   |SI #0#26 > 0;
       incremento = incremento + (#0#26 - #0#34);
   |SINO;
       |SI #0#27 = "N";
           disminucion = disminucion + (#0#26 * -1);
       |SINO;
           disminucioe = disminucioe + (#0#26 * -1);
       |FINSI;
   |FINSI;
|FINSI;
|FPRC;

|PROCESO grabafic4;
#4#0 = empresa;
#4#1 = linea;
|LIBERA #4;
|LEE 110#4=;
|SI FSalida = 0;
    #4#26 = incremento;
    #4#27 = disminucion;
    #4#28 = disminucioe;
    #4#31 = #4#26 - #4#27 - #4#28 - #4#29;
    || |SI #4#31 < 0; #4#31 = 0; |FINSI;  || preguntar si es asi o no
    #4#32 = #4#42 + #4#31;
    |GRABA 020#4a;
|FINSI;
|FPRC;

|PROCESO acumula5;  || Empresarial Modulos
|SI sw = 0;
   incremento = 0; disminucion = 0; disminucioe = 0;
   linea = #0#3; sw = 1;
|FINSI;

|SI linea ! #0#3;
   |HAZ grabafic5;
   linea = #0#3;
|SINO;
   |SI #0#26 > 0;
       incremento = incremento + (#0#26 - #0#34);
   |SINO;
       |SI #0#27 = "N";
           disminucion = disminucion + (#0#26 * -1);
       |SINO;
           disminucioe = disminucioe + (#0#26 * -1);
       |FINSI;
   |FINSI;
|FINSI;
|FPRC;

|PROCESO grabafic5;
#5#0 = empresa;
#5#1 = linea;
|LIBERA #5;
|LEE 110#5=;
|SI FSalida = 0;
     #5#45 = incremento;
     #5#46 = disminucion;
     #5#47 = disminucioe;

     pepe  = #5#44 - #5#47 - #5#48 - #5#60 + #5#45 - #5#46 + #5#61;
     |SI pepe < 0; pepe = 0; |FINSI;
     #5#49 = pepe;
     |GRABA 020#5a;
|FINSI;
|FPRC;

|DEFBUCLE leefic01;
#0#1;
2,3;
empresa, 01, pd, 01;
empresa, 99, pd, 99;
e;
NULL,acumula1;
|FIN;

|DEFBUCLE leefic02;
#0#1;
2,3;
empresa, 01, pc, 01;
empresa, 99, pc, 99;
e;
NULL,acumula2;
|FIN;

|DEFBUCLE leefic03;
#0#1;
2,3;
empresa, 01, ed, 01;
empresa, 99, ed, 99;
e;
NULL,acumula3;
|FIN;

|DEFBUCLE leefic04;
#0#1;
2,3;
empresa, 01, ec, 01;
empresa, 99, ec, 99;
e;
NULL,acumula4;
|FIN;

|DEFBUCLE leefic05;
#0#1;
2,3;
empresa, 01, em, 01;
empresa, 99, em, 99;
e;
NULL,acumula5;
|FIN;

|PROCESO actual;

|ABRE #1;
sw = 0; |BUCLE leefic01;
|SI sw = 1; |HAZ grabafic1; |FINSI;
|CIERRA #1;

|ABRE #2;
sw = 0; |BUCLE leefic02;
|SI sw = 1; |HAZ grabafic2; |FINSI;
|CIERRA #2;

|ABRE #3;
sw = 0; |BUCLE leefic03;
|SI sw = 1; |HAZ grabafic3; |FINSI;
|CIERRA #3;

|ABRE #4;
sw = 0; |BUCLE leefic04;
|SI sw = 1; |HAZ grabafic4; |FINSI;
|CIERRA #4;

|ABRE #5;
sw = 0; |BUCLE leefic05;
|SI sw = 1; |HAZ grabafic5; |FINSI;
|CIERRA #5;
|FPRC;
