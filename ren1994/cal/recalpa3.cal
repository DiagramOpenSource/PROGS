|FICHEROS;
    reempmod #0;
    reactafe #1;
    rerendir #2;
    reanuali #3;
    reincreg #4;
    reincide #5;
    retotren #6;
    redatcon #7;
    retotpat #8;
    retotrea #9;
    reprogra #10;
|FIN;

|VARIABLES;
    sw_fich   = 0;
    numero1   = 0;
    numero2   = 0;
    numero3   = 0;
    numero4   = 0;
    numero5   = 0;
    numero6   = 0;
    coefi1    = 0;
    coefi2    = 0;
    periodo   = 0;
    coefi11   = 0;
    funeral   = 0;
    zz        = 0;
    suma      = 0;
    mayor     = 0;
    tope      = 0;
    maximo    = 0;
    FEstado   = 0;
    FEstad1   = 0;
    FEstad2   = 0;
    sw        = 0;

    tipod     = "";
    perceptor = "";
    tipore    = "";
    minusva   = "";
    numero   = "";
    s        = "S";
    alfa1    = "";
    linea    = "";
    rendi    = "";
    descri   = "";
    contenido = "";
    blanco    = "                                        ";
    empreac   = 0;

    tipop      = "";
    tipoprop   = "";
    cantidad   = 0;
    cantidad1  = 0;
    anyos      = 0;
    anyou      = 0;
    porce      = 0;
    var        = 0;
    si_arte    = "";

    &incisino = "";
    &modo     = 0;
    &empresa  = 0;
    &emprefi  = 0;
    &nombre   = "";
    &lininci  = 0;
    &swcalcu  = 0;
    &minusva1 = "";
    &minusva2 = "";
    &minusva3 = "";
    &minusva4 = "";
    &minusva5 = "";
    &minusva6 = "";
    &declara  = "";
    &individu = 0;
    &acceso   = 0;
    &recalcu  = 0;
    &tippar   = 0;
    &parte1   = 0.0000;
    &parte2   = 0.0000;
    &muerto   = "";
    &fecpar   = @;
    &netot    = 0;
    &netoc    = 0;
    &netoa    = 0;
    &trabat   = 0;
    &trabac   = 0;
    &trabaa   = 0;
    &obitus   = 0;
|FIN;


|| **************************************************************************
||                   PROCESO DE LECTURA DE LOS DISTINTOS FICHEROS
|| **************************************************************************

|PROCESO fichero0;           || Actividades Empresariales Modulos
alfa1     = "ACTIVIDADES EMPRESARIALES MODULOS ------------------------------";
tipod     = #0#2;
tipore    = #0#4;
descri    = #0#15;
linea     = #0#1;
rendi     = #0#49;
perceptor = #0#3;
numero1   = #0#7;
numero2   = #0#8;
numero3   = #0#9;
numero4   = #0#10;
numero5   = #0#11;
numero6   = #0#12;
sw_fich   = 0;
empreac   = #0#0;
tipoprop  = #0#5;
periodo   = #0#54;

cantidad1 = 0;

|SI #0#4 = "X"; |O #0#4 = "P"; |O #0#4 = "R";
    |HAZ incidenci1;
|FINSI;

|SI #0#4 = "A"; |O #0#4 = "R";
    |SI #0#5 ! "N"; |HAZ tipodecl; |FINSI;
|FINSI;

  |SI #0#4 ! "P"; |Y #0#4 ! "A";
      |ACABA;
  |FINSI;
  tipop = "C1";
  cantidad1 = #0#55;
  tipod = #0#2;
  |SI #0#5 ! "P"; anyou = #0#6; |HAZ calcuprop; |FINSI;

  |SI cantidad1 [ 0; |ACABA; |FINSI;

  |SI periodo ! 1;
      |SI #0#2 ! "G"; |Y #0#2 ! "V";
          tipod = #0#2;; cantidad = cantidad1; |HAZ grabapat; |ACABA;
      |FINSI;

      |SI #0#2 = "V";
          |SI tippar = 2;
              |SI muerto = "T";
                  #0#7 = 0;
              |SINO;
                  #0#8 = 0;
              |FINSI;
          |FINSI;
          tipod = "T"; cantidad = cantidad1 % #0#7;  |HAZ grabapat;
          tipod = "C"; cantidad = cantidad1 % #0#8;  |HAZ grabapat;
          tipod = "1"; cantidad = cantidad1 % #0#9;  |HAZ grabapat;
          tipod = "2"; cantidad = cantidad1 % #0#10; |HAZ grabapat;
          tipod = "3"; cantidad = cantidad1 % #0#11; |HAZ grabapat;
          tipod = "4"; cantidad = cantidad1 % #0#12; |HAZ grabapat;
          |ACABA;
      |FINSI;

      |SI #0#2 = "G";
          |SI tippar = 2;
              |SI muerto = "T";
                  tipod = "C"; cantidad = cantidad1; |HAZ grabapat;
              |SINO;
                  tipod = "T"; cantidad = cantidad1; |HAZ grabapat;
              |FINSI;
          |SINO;
              tipod = "T"; cantidad = cantidad1 % 50; |HAZ grabapat;
              tipod = "C"; cantidad = cantidad1 % 50; |HAZ grabapat;
          |FINSI;
      |FINSI;
  |FINSI;
|FPRC;

|PROCESO fichero1;            || Trata Activos afectos
alfa1     = "ACTIVOS AFECTOS A LA ACTIVIDAD ---------------------------------";
tipod     = #1#4;
tipore    = #1#37;
descri    = #1#6;
linea     = #1#1;
rendi     = #1#26;
perceptor = #1#5;
numero1   = #1#38;
numero2   = #1#39;
numero3   = #1#40;
numero4   = #1#41;
numero5   = #1#42;
numero6   = #1#43;
sw_fich   = 1;
empreac   = #1#0;
periodo   = #1#45;

cantidad1 = 0;

|SI #1#37 = "X"; |O #1#37 = "P"; |O #1#37 = "R";
    |HAZ incidenci1;
|FINSI;

|SI #1#37 = "A"; |O #1#37 = "R"; |HAZ tipodecl; |FINSI;

  |SI #1#37 ! "P"; |Y #1#37 ! "A";
      |ACABA;
  |FINSI;
  |SI #1#51 = "N"; tipop = "C2"; |FINSI;
  |SI #1#51 = "S"; tipop = "C3"; |FINSI;
  |SI #1#44 = "N";
      cantidad1 = #1#9;
      |SI cantidad1 < #1#10; cantidad1 = #1#10; |FINSI;
      |SI cantidad1 < #1#11; cantidad1 = #1#11; |FINSI;
  |SINO;
      cantidad1 = 0;
      |SI #1#30 ! "01.01.1900";
          cantidad1 = #1#31;
          |SI cantidad1 < #1#32; cantidad1 = #1#32; |FINSI;
          |SI cantidad1 < #1#33; cantidad1 = #1#33; |FINSI;
      |FINSI;
  |FINSI;
  |SI cantidad1 [ 0; |ACABA; |FINSI;
  tipod = #1#4;

  |SI periodo ! 1;
      |SI #1#4 ! "G"; |Y #1#4 ! "V";
          tipod = #1#4; cantidad = cantidad1; |HAZ grabapat; |ACABA;
      |FINSI;

      |SI #1#4 = "V";
          |SI tippar = 2;
              |SI muerto = "T";
                  #1#38 = 0;
              |SINO;
                  #1#39 = 0;
              |FINSI;
          |FINSI;
          tipod = "T"; cantidad = cantidad1 % #1#38; |HAZ grabapat;
          tipod = "C"; cantidad = cantidad1 % #1#39; |HAZ grabapat;
          tipod = "1"; cantidad = cantidad1 % #1#40; |HAZ grabapat;
          tipod = "2"; cantidad = cantidad1 % #1#41; |HAZ grabapat;
          tipod = "3"; cantidad = cantidad1 % #1#42; |HAZ grabapat;
          tipod = "4"; cantidad = cantidad1 % #1#43; |HAZ grabapat;
          |ACABA;
      |FINSI;

      |SI #1#4 = "G";
          |SI tippar = 2;
              |SI muerto = "T";
                  tipod = "C"; cantidad = cantidad1; |HAZ grabapat;
                  |ACABA;
              |SINO;
                  tipod = "T"; cantidad = cantidad1; |HAZ grabapat;
                  |ACABA;
              |FINSI;
          |SINO;
              tipod = "T"; cantidad = cantidad1 % 50; |HAZ grabapat;
              tipod = "C"; cantidad = cantidad1 % 50; |HAZ grabapat;
              |ACABA;
          |FINSI;
      |FINSI;
  |FINSI;
|FPRC;

|PROCESO fichero2;       || Trata  Rendimiento Irregulares
alfa1     = "RENDIMIENTOS IRREGULARES ---------------------------------------";
tipod     = #2#4;
tipore    = #2#16;
descri    = #2#6;
linea     = #2#1;
rendi     = #2#7;
perceptor = #2#5;
numero1   = #2#17;
numero2   = #2#18;
numero3   = #2#19;
numero4   = #2#20;
numero5   = #2#21;
numero6   = #2#22;
sw_fich   = 2;
empreac   = #2#0;
periodo   = 0;
|SI tippar = 2;
    |SI muerto = "C";  |Y #2#4 = "C";
        periodo = 1;
    |FINSI;
    |SI muerto = "T";  |Y #2#4 = "T";
        periodo = 1;
    |FINSI;
|FINSI;

|SI #2#16 = "X"; |O #2#16 = "P"; |O #2#16 = "R";
    |HAZ incidenci1;
|FINSI;

|SI #2#16 = "A"; |O #2#16 = "R"; |HAZ tipodecl; |FINSI;
|FPRC;

|PROCESO fichero3;            || Trata Anualidades por Alimentos
alfa1     = "ANUALIDADES POR ALIMENTOS --------------------------------------";
tipod     = #3#2;
perceptor = #3#3;
sw_fich   = 3;
empreac   = #3#0;
periodo   = #3#6;
|SI tippar = 2;
    |SI muerto = "C";  |Y #3#2 = "C";
        periodo = 1;
    |FINSI;
    |SI muerto = "T";  |Y #3#2 = "T";
        periodo = 1;
    |FINSI;
|FINSI;

|HAZ tipodecl;
|FPRC;

|PROCESO fichero4; || Trata Incrementos/Disminuciones Patrimoniales Regulares
alfa1     = "INCREMENTOS/DISMINUCIONES PATRIMONIALES REGULARES ---------------";
tipod     = #4#2;
tipore    = #4#4;
descri    = #4#13;
|QBF descri;
|SI #4#21 ! 0; descri = descri + " I: "; rendi = #4#21; |FINSI;
|SI #4#17 ! 0; descri = descri + " D: "; rendi = #4#17; |FINSI;
linea     = #4#1;
perceptor = #4#3;
numero1   = #4#7;
numero2   = #4#8;
numero3   = #4#9;
numero4   = #4#10;
numero5   = #4#11;
numero6   = #4#12;
sw_fich   = 4;
empreac   = #4#0;
periodo   = #4#22;

|SI #4#4 = "X"; |O #4#4 = "P"; |O #4#4 = "R";
    |HAZ incidenci1;
|FINSI;
|SI #4#4 = "A"; |O #4#4 = "R"; |HAZ tipodecl; |FINSI;
|FPRC;
|| **************************************************************************
                        TRATAMIENTO DE LA LIQUIDACION
|| **************************************************************************

|PROCESO tipodecl;
  coefi11 = 1;
  funeral = 0;
  |SI tipod = "G";  |Y tippar = 1;   || Si es Ganancial  Y MATRIMONIO;
      |SI periodo = 0;
          coefi1= 50*parte1; coefi11 = .5; zz = 25; tipod="T"; |HAZ leeliqui;
          coefi1= 50*parte1; coefi11 = .5; zz = 25; tipod="C"; |HAZ leeliqui;
          coefi1=100*parte2; coefi11 =  1; zz=  50;  tipod="A"; |HAZ leeliqui;
      |SINO;
          |SI periodo = 1;
              coefi1 = 50; coefi11 = .5; zz = 50; tipod  = "T"; |HAZ leeliqui;
              coefi1 = 50; coefi11 = .5; zz = 50; tipod  = "C"; |HAZ leeliqui;
          |SINO;
              coefi1 = 100; coefi11 = 1; zz =100; tipod  = "A"; |HAZ leeliqui;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;

  |SI tipod = "G";  |Y tippar = 3;   || Si es Ganancial  Y SEPARACION;
      |SI periodo = 0;
          coefi1= 50*parte2; coefi11 = .5; zz = 25; tipod="T"; |HAZ leeliqui;
          coefi1= 50*parte2; coefi11 = .5; zz = 25; tipod="C"; |HAZ leeliqui;
          coefi1=100*parte1; coefi11 =  1; zz = 50; tipod="A"; |HAZ leeliqui;
      |SINO;
          |SI periodo = 1;
              zz = 100;
              coefi1 = 100; coefi11 = 1; tipod  = "A"; |HAZ leeliqui;
          |SINO;
              zz = 50;
              coefi1 =  50; coefi11 = .5;  tipod  = "T"; |HAZ leeliqui;
              coefi1 =  50; coefi11 = .5;  tipod  = "C"; |HAZ leeliqui;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;


  || Si es Ganancial, conjunta y SE MUERE EL;

  |SI tipod = "G";  |Y tippar = 2; |Y muerto = "T";  |Y obitus = 1;
      |SI periodo = 0;
          coefi1= 100*parte2; coefi11 = 1; zz = 50; tipod="C"; |HAZ leeliqui;
          coefi1= 100*parte1; coefi11 = 1; zz = 50; tipod="A"; |HAZ leeliqui;
      |SINO;
          |SI periodo = 1;
              zz = 100;
              coefi1 = 100; coefi11 = 1; tipod  = "A"; |HAZ leeliqui;
          |SINO;
              zz = 100;
              coefi1 = 100; coefi11 = 1; tipod  = "C"; |HAZ leeliqui;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;


  || Si es Ganancial, conjunta y SE MUERE ELLA;

  |SI tipod = "G";  |Y tippar = 2; |Y muerto = "C";  |Y obitus = 1;
      |SI periodo = 0;
          coefi1= 100*parte2; coefi11 = 1; zz = 50; tipod="T"; |HAZ leeliqui;
          coefi1= 100*parte1; coefi11 = 1; zz = 50; tipod="A"; |HAZ leeliqui;
      |SINO;
          |SI periodo = 1;
              zz = 100;
              coefi1 = 100; coefi11 = 1; tipod  = "A"; |HAZ leeliqui;
          |SINO;
              zz = 100;
              coefi1 = 100; coefi11 = 1; tipod  = "T"; |HAZ leeliqui;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;


  ||Si es Ganancial, individual Y SE MUERE EL;

  |SI tipod = "G";  |Y tippar = 2; |Y muerto = "T"; |Y obitus = 2;
      |SI periodo = 0;
          funeral = 1;
          coefi1=  50 * parte1; coefi11=.5; zz=  50; tipod = "T"; |HAZ leeliqui;
          coefi1= 100 - coefi1; coefi11= 1; zz=  50; tipod = "C"; |HAZ leeliqui;
      |SINO;
          |SI periodo = 1;
              coefi1  = 50;
              coefi11 = .5;
              zz = 50;
              tipod  = "T"; |HAZ leeliqui;
              tipod  = "C"; |HAZ leeliqui;
          |SINO;
              zz = 100; coefi11 = 1; coefi1 = 100; tipod  = "C"; |HAZ leeliqui;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;

  ||Si es Ganancial, individual Y SE MUERE ELLA;

 |SI tipod = "G"; |Y tippar = 2; |Y muerto = "C"; |Y obitus = 2;
      |SI periodo = 0;
          funeral = 1;
          coefi1=  50 * parte1;  coefi11=.5; zz= 50; tipod = "C"; |HAZ leeliqui;
          coefi1 = 100 - coefi1; coefi11= 1; zz= 50; tipod = "T"; |HAZ leeliqui;
      |SINO;
          |SI periodo = 1;
              coefi11 = .5;
              coefi1 = 50;
              zz = 50;
              tipod  = "T"; |HAZ leeliqui;
              tipod  = "C"; |HAZ leeliqui;
          |SINO;
              zz = 100; coefi11 = 1; coefi1 = 100;  tipod  = "T"; |HAZ leeliqui;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;

  |SI tipod ! "V";  |Y tippar = 1;      ||SI ES TITULAR O CONYUGE Y SE CASAN;
      |SI periodo = 0;
          coefi11 = 1;
          zz = 100;
          coefi1 =  100 * parte1;                |HAZ leeliqui;
          coefi1 =  100 * parte2;  tipod = "A";  |HAZ leeliqui;
      |SINO;
          |SI periodo = 1;
              coefi11 = 1;
              zz = 100;
              coefi1 = 100; |HAZ leeliqui;
          |SINO;
              coefi11 = 1;
              zz = 100;
              coefi1 = 100;  tipod = "A";  |HAZ leeliqui;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;

  |SI tipod ! "V";  |Y tippar = 3;      ||SI TITULAR O CONYUGE Y SE SEPARAN;
      |SI periodo = 0;
          coefi11 = 1;
          zz = 100;
          coefi1 =  100 * parte2;                |HAZ leeliqui;
          coefi1 =  100 * parte1;  tipod = "A";  |HAZ leeliqui;
      |SINO;
          |SI periodo = 1;
              coefi11 = 1;
              zz = 100;
              coefi1 = 100;  tipod = "A";  |HAZ leeliqui;
          |SINO;
              coefi11 = 1;
              zz = 100;
              coefi1 = 100;                |HAZ leeliqui;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;


  ||SI TITULAR O CONYUGE, conjunta Y SE MUERE UNO;
  |SI tipod ! "V";  |Y tippar = 2; |Y obitus = 1;
      |SI periodo = 0;
          coefi11 = 1;
          zz = 100;
          |SI muerto = "T";  |Y tipod = "T";
              coefi1 =  100;  tipod = "A";  |HAZ leeliqui;
          |SINO;
              |SI muerto = "C"; |Y tipod = "C";
                  coefi1 =  100;  tipod = "A";  |HAZ leeliqui;
              |SINO;
                  coefi1 =  100 * parte2;                |HAZ leeliqui;
                  coefi1 =  100 * parte1;  tipod = "A";  |HAZ leeliqui;
              |FINSI;
          |FINSI;
      |SINO;
          |SI periodo = 1;
              coefi11 = 1;
              zz = 100;
              coefi1 = 100;  tipod = "A";  |HAZ leeliqui;
          |SINO;
              coefi11 = 1;
              zz = 100;
              coefi1 = 100;                |HAZ leeliqui;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;

||SI TITULAR O CONYUGE, individual  Y SE MUERE UNO;

  |SI tipod ! "V"; |Y tippar = 2; |Y obitus = 2;
       coefi11 = 1;
       zz = 100;
       coefi1 = 100; |HAZ leeliqui;
      |ACABA;
  |FINSI;

  |SI tippar = 1;          ||VARIOS Y SE CASAN;
      |SI periodo = 0;
          |SI numero1 ! 0;
              zz = numero1;
              coefi11 = numero1 / 100;
              coefi1 =  numero1 * parte1;
              tipod = "T";
              |HAZ leeliqui;
          |FINSI;
          |SI numero2 ! 0;
              zz = numero2;
              coefi11 = numero2 / 100;
              coefi1 =  numero2 * parte1;
              tipod = "C";
              |HAZ leeliqui;
          |FINSI;
          zz = numero1 + numero2;
          coefi1 = ( numero1 + numero2 ) * parte2;
          coefi11 = ( numero1 + numero2 ) / 100;
          tipod = "A"; |HAZ leeliqui;
      |SINO;
          |SI periodo = 1;
             |SI numero1 ! 0;
                 zz = numero1;
                 coefi11 = numero1 / 100;
                 coefi1 = numero1;
                 tipod = "T";
                 |HAZ leeliqui;
             |FINSI;
             |SI numero2 ! 0;
                 zz = numero2;
                 coefi11 = numero2 / 100;
                 coefi1 = numero2;
                 tipod = "C";
                 |HAZ leeliqui;
             |FINSI;
          |SINO;
             zz = numero1 + numero2;
             coefi1 = numero1 + numero2;
             coefi11 = (numero1 + numero2) / 100;
             tipod = "A"; |HAZ leeliqui;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;

  |SI tippar = 3;          ||VARIOS Y SE SEPARAN;
      |SI periodo = 0;
          |SI numero1 ! 0;
              zz = numero1;
              coefi11 = numero1 / 100;
              coefi1 =  numero1 * parte2;
              tipod = "T";
              |HAZ leeliqui;
          |FINSI;
          |SI numero2 ! 0;
              zz = numero2;
              coefi11 = numero2 / 100;
              coefi1 =  numero2 * parte2;
              tipod = "C";
              |HAZ leeliqui;
          |FINSI;
          zz = numero1 + numero2;
          coefi1 = ( numero1 + numero2 ) * parte1;
          coefi11 = ( numero1 + numero2 ) / 100;
          tipod = "A"; |HAZ leeliqui;
      |SINO;
          |SI periodo = 1;
              zz = numero1 + numero2;
              coefi1 = numero1 + numero2;
              coefi11 = (numero1 + numero2) / 100;
              tipod = "A"; |HAZ leeliqui;
          |SINO;
              |SI numero1 ! 0;
                  zz = numero1;
                  coefi1 = numero1;
                  coefi11 = numero1 / 100;
                  tipod = "T";
                  |HAZ leeliqui;
              |FINSI;
              |SI numero2 ! 0;
                  zz = numero2;
                  coefi1 = numero2;
                  coefi11 = numero2 / 100;
                  tipod = "C";
                  |HAZ leeliqui;
              |FINSI;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;


  |SI tippar = 2;  |Y obitus = 1;     ||VARIOS, conjunta Y SE MUERE;
      |SI periodo = 0;
          |SI numero1 ! 0;
              zz = numero1;
              coefi11 = numero1 / 100;
              coefi1 =  numero1 * parte2;
              tipod = "T";
              |HAZ leeliqui;
          |FINSI;
          |SI numero2 ! 0;
              zz = numero2;
              coefi11 = numero2 / 100;
              coefi1 =  numero2 * parte2;
              tipod = "C";
              |HAZ leeliqui;
          |FINSI;
          zz = numero1 + numero2;
          coefi1 = ( numero1 + numero2 ) * parte1;
          coefi11 = ( numero1 + numero2 ) / 100;
          tipod = "A"; |HAZ leeliqui;
      |SINO;
          |SI periodo = 1;
              zz = numero1 + numero2;
              coefi1 = numero1 + numero2;
              coefi11 = (numero1 + numero2) / 100;
              tipod = "A"; |HAZ leeliqui;
          |SINO;
              |SI numero1 ! 0;
                  zz = numero1;
                  coefi1 = numero1;
                  coefi11 = numero1 / 100;
                  tipod = "T";
                  |HAZ leeliqui;
              |FINSI;
              |SI numero2 ! 0;
                  zz = numero2;
                  coefi1 = numero2;
                  coefi11 = numero2 / 100;
                  tipod = "C";
                  |HAZ leeliqui;
              |FINSI;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;

  |SI tippar = 2;  |Y obitus = 2;     ||VARIOS, individual Y SE MUERE ALGUIEN;
      |SI numero1 ! 0;
          zz = numero1;
          coefi1 =  numero1;
          coefi11 =  numero1 / 100;
          tipod = "T";
          |HAZ leeliqui;
      |FINSI;
      |SI numero2 ! 0;
          zz = numero2;
          coefi1 =  numero2;
          coefi11 =  numero2 / 100;
          tipod = "C";
          |HAZ leeliqui;
      |FINSI;
  |FINSI;
|FPRC;

|PROCESO leeliqui;                 || Lee la Liquidacion
  #6#0 = empreac;
  #6#141 = tipod;
  |LIBERA #6; |LEE 110#6=;
  FEstado = FSalida;
  |SI FSalida ! 0;
      |DDEFECTO #6;
      #6#000 = empreac;
      #6#141 = tipod;
  |FINSI;
  #9#0 = empreac;
  #9#1 = tipod;
  |LIBERA #9;
  |LEE 110#9=;
  FEstad1 = FSalida;
  |SI FSalida ! 0;
      |DDEFECTO #9;
      #9#0 = empreac;
      #9#1 = tipod;
  |FINSI;
  |SI tipod = "V"; coefi2 = 100; |SINO; coefi2 = coefi1; |FINSI;

  |SI sw_fich = 0; |HAZ grabafi0; |FINSI;
  |SI sw_fich = 1; |HAZ grabafi1; |FINSI;
  |SI sw_fich = 2; |HAZ grabafi2; |FINSI;
  |SI sw_fich = 3; |HAZ grabafi3; |FINSI;
  |SI sw_fich = 4; |HAZ grabafi4; |FINSI;

  #6#213 = obitus;
  |SI FEstado = 0; |GRABA 021#6a; |SINO; |GRABA 021#6n; |FINSI;
  |SI FEstad1 = 0; |GRABA 021#9a; |SINO; |GRABA 021#9n; |FINSI;
|FPRC;

|PROCESO grabafi0;
  #6#22 = #6#22 +  (#0#49 % coefi1);
  #6#137 = #6#137 + ((#0#50 + #0#51 + #0#52 + #0#53) % coefi2);
  |SI #6#141 = "T";
      #6#203 = #6#203 + (#0#49 % coefi1);
  |FINSI;
  |SI #6#141 = "C";
      #6#209 = #6#209 + (#0#49 % coefi1);
  |FINSI;
  |SI #6#141 = "A";  |Y #0#2 = "G";
      #6#203 = #6#203 + ((#0#49 % coefi1) / 2);
      #6#209 = #6#209 + ((#0#49 % coefi1) / 2);
  |FINSI;
  |SI #6#141 = "A";  |Y #0#2 = "T";
      #6#203 = #6#203 + (#0#49 % coefi1);
  |FINSI;
  |SI #6#141 = "A";  |Y #0#2 = "C";
      #6#209 = #6#209 + (#0#49 % coefi1);
  |FINSI;
  |SI #6#141 = "A";  |Y #0#2 = "V";
      #6#203 = #6#203 + (#0#49 % numero1);
      #6#209 = #6#209 + (#0#49 % numero2);
  |FINSI;
  #6#64 = #6#64 + ((#0#45 - #0#46 - #0#47) % coefi1);
  #9#154 = #9#154 + (#0#48 % coefi1);
|FPRC;

|PROCESO grabafi1;
  || nada por ahora
|FPRC;

|PROCESO grabafi2;
  #6#25 = #6#25 + (#2#11 % zz);
  |SI #6#141 = "T";
      #6#205 = #6#205 + (#2#11 % zz) + (#2#12 % zz);
  |FINSI;
  |SI #6#141 = "C";
      #6#211 = #6#211 + (#2#11 % zz) + (#2#12 % zz);
  |FINSI;
  |SI #6#141 = "A"; |Y #2#4 = "G";
      #6#205 = #6#205 + (#2#11 % zz) + (#2#12 % zz);
      #6#211 = #6#211 + (#2#11 % zz) + (#2#12 % zz);
  |FINSI;
  |SI #6#141 = "A"; |Y #2#4 = "T";
      #6#205 = #6#205 + (#2#11 % zz) + (#2#12 % zz);
  |FINSI;
  |SI #6#141 = "A"; |Y #2#4 = "C";
      #6#211 = #6#211 + (#2#11 % zz) + (#2#12 % zz);
  |FINSI;
  #6#135 = #6#135 + (#2#8 % zz);
  #9#152 = #9#152 + (#2#14 % zz);
  #9#153 = #9#153 + (#2#15 % zz);
|FPRC;

|PROCESO grabafi3;
 #6#29 = #6#29 + (#3#5 % coefi1);
 |SI #3#2 = "T";
     #9#20 = #9#20 + (#3#5 % coefi1);
     #9#18 = #3#4  + #3#7;
 |FINSI;
 |SI #3#2 = "C";
     #9#21 = #9#21 + (#3#5 % coefi1);
     #9#19 = #3#4  + #3#7;
 |FINSI;
|FPRC;

|PROCESO grabafi4;
  #6#216 = #6#216 + (#4#21 % zz);
  #6#217 = #6#217 + (#4#17 % zz);
  si_arte = #4#13 % 102;
  |SI si_arte = "**";
      #9#182 = #9#182 + 500001;
  |SINO;
      #9#182 = #9#182 + (#4#14 % zz);
  |FINSI;
|FPRC;

|PROCESO calcuprop;
|ABRE #7;
#7#0 = empreac;
|LEE 040#7=;
|SI FSalida = 0;
    |SI tipoprop = "U";
        |SI tipod = "T"; anyos = #7#3;  |FINSI;
        |SI tipod = "C"; anyos = #7#30; |FINSI;
        |SI tipod = "1";
            |SI #7#98 ! 0; var = 67 + #7#98; anyos = #7var; |FINSI;
        |FINSI;
        |SI tipod = "2";
            |SI #7#99 ! 0; var = 67 + #7#99; anyos = #7var; |FINSI;
        |FINSI;
        |SI tipod = "3";
            |SI #7#100 ! 0; var = 67 + #7#100; anyos = #7var; |FINSI;
        |FINSI;
        |SI tipod = "4";
            |SI #7#101 ! 0; var = 67 + #7#101; anyos = #7var; |FINSI;
        |FINSI;
        |SI tipod = "G"; anyos = #7#3;  |FINSI;
        |SI tipod = "V"; anyos = #7#3;  |FINSI;
        anyos = 1994 - anyos;
    |SINO;
        anyos = anyou;
    |FINSI;
    |SI anyos [ 20; porce = 70; |FINSI;
    |SI anyos > 20;
        porce = 70 - (anyos - 20);
        |SI porce < 10; porce = 10; |FINSI;
    |FINSI;
    |SI tipoprop = "N"; porce = 100 - porce; |FINSI;
    cantidad1 = cantidad1 % porce;
|FINSI;
|CIERRA #7;
|FPRC;

|PROCESO grabapat;
|SI cantidad = 0; |ACABA; |FINSI;
|ABRE #8;
#8#0  = empreac;
#8#28 = tipod;
|LIBERA #8;
|LEE 110#8=;
FEstad2 = FSalida;
|SI FSalida ! 0; |DDEFECTO #8; #8#0 = empreac; #8#28 = tipod; |FINSI;
|SI tipop = "A1"; #8#1  = #8#1  + cantidad; |FINSI;
|SI tipop = "B1"; #8#2  = #8#2  + cantidad; |FINSI;
|SI tipop = "C1"; #8#3  = #8#3  + cantidad; |FINSI;
|SI tipop = "C2"; #8#3  = #8#3  + cantidad; |FINSI;
|SI tipop = "C3"; #8#3  = #8#3  + cantidad; |FINSI;
|SI tipop = "C3"; #8#46 = #8#46 + cantidad; |FINSI;
|SI tipop = "E1"; #8#5  = #8#5  + cantidad; |FINSI;
|SI tipop = "E2"; #8#6  = #8#6  + cantidad; |FINSI;
|SI tipop = "D1"; #8#4  = #8#4  + cantidad; |FINSI;
|SI tipop = "H1"; #8#10 = #8#10 + cantidad; |FINSI;
|SI FEstad2 = 0; |GRABA 020#8a; |SINO; |GRABA 020#8n; |FINSI;
|CIERRA #8;

#10#0 = empreac;
|LIBERA #10;
|LEE 101#10=;
|SI FSalida = 0;
    #10#30 = 1;
    |GRABA 020#10a;
|FINSI;
|FPRC;

|| **************************************************************************
||                            DILIGENCIAS
|| **************************************************************************

|PROCESO incidenci1;
|SI incisino = "S";
   |SI sw = 0; |HAZ grabacion; sw = 1; |FINSI;

   linea = "00" + linea;
   linea = linea % -102;

   rendi = "          " + rendi;
   rendi = rendi % -110;

   |QBF descri;
   descri = descri + blanco;
   descri = descri % 130;

   alfa1 = "NO CALCULO ->  " + linea + " " + descri + "    " + rendi;

   |SI tipore = "R";
       alfa1 = "RENTA ------>  " + linea + " " + descri + "    " + rendi;
   |FINSI;
   |SI tipore = "P";
       alfa1 = "PATRIMONIO ->  " + linea + " " + descri + "    " + rendi;
   |FINSI;
   |HAZ grabacion;
|FINSI;
|FPRC;

|PROCESO grabacion;
swcalcu = 1;
lininci = lininci + 5;
#5#0 = empreac;
#5#1 = lininci;
#5#2 = alfa1;
#5#3 = "S";
|GRABA 020#5n;
|LIBERA #5;
|FPRC;


|| **************************************************************************
||                             PROCESO BUCLES
|| **************************************************************************

|DEFBUCLE leefic0;   || Bucle Transparencias Fiscal
#0#1;
;
empresa, 01;
emprefi, 99;
e;
NULL, fichero0;
|FIN;

|DEFBUCLE leefic1;   || Bucle Profesional Directa
#1#1;
;
empresa, 01;
emprefi, 99;
e;
NULL, fichero1;
|FIN;

|DEFBUCLE leefic2;    || Bucle Profesional Coeficiente
#2#1;
;
empresa, 01;
emprefi, 99;
e;
NULL, fichero2;
|FIN;

|DEFBUCLE leefic3;    || Bucle Empresarial Directa
#3#1;
;
empresa, 01;
emprefi, 99;
e;
NULL, fichero3;
|FIN;

|DEFBUCLE leefic4;    || Bucle Empresarial Coeficiente
#4#1;
;
empresa, 01;
emprefi, 99;
e;
NULL, fichero4;
|FIN;

|| **************************************************************************
                              INICIO
|| **************************************************************************

|PROGRAMA;
  |ABRE #10;
  |ABRE #5;
  |ABRE #6;
  |ABRE #9;
  |SI recalcu = 0;  |O recalcu = 2;
      #10#0 = empresa;
      |LEE 040#10=;
      |SI FSalida = 0;
          |SI #10#11 = 1; sw = 0; lininci = 3000; |BUCLE leefic0; |FINSI;
          |SI #10#12 = 1; sw = 0; lininci = 3300; |BUCLE leefic1; |FINSI;
          |SI #10#13 = 1; sw = 0; lininci = 3600; |BUCLE leefic2; |FINSI;
          |SI #10#14 = 1; sw = 0; lininci = 3900; |BUCLE leefic3; |FINSI;
          |SI #10#15 = 1; sw = 0; lininci = 4200; |BUCLE leefic4; |FINSI;
      |FINSI;
  |SINO;
      sw = 0; lininci = 3000; |BUCLE leefic0;
      sw = 0; lininci = 3300; |BUCLE leefic1;
      sw = 0; lininci = 3600; |BUCLE leefic2;
      sw = 0; lininci = 3900; |BUCLE leefic3;
      sw = 0; lininci = 4200; |BUCLE leefic4;
  |FINSI;
  |CIERRA #10;
  |CIERRA #5;
  |CIERRA #6;
  |CIERRA #9;

 |SI #10#16=1; |O #10#17=1; |O #10#18=1; |O #10#19=1; |O #10#20=1; |O recalcu=1;
     |CORRE "recalpa4.run";
     |ACABA;
 |FINSI;

 |SI #10#21=1; |O #10#22=1; |O #10#23=1; |O #10#24=1; |O #10#25=1; |O recalcu=1;
     |CORRE "recalpa5.run";
     |ACABA;
 |FINSI;

 |SI #10#26=1; |O #10#27=1; |O #10#28=1; |O #10#29=1;
     |CORRE "recalpa6.run";
     |ACABA;
 |FINSI;

|CORRE "recalpa8.run"
|FPRO;
