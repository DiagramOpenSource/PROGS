|FICHEROS;
   reemi714 #0;
   redatcon #1;
   rehacien #2;
   rerenpre #3;
   repoblac #4;

   retotpat #5;
   repant50 #6;
   reemisio #9;
|FIN;

|VARIABLES;
   &empresa  = 0;
   &nombre   = "";
   &cif      = "";
   &impresor = "";
   &diainf   = "";
   &mesinf   = "";
   &anyoinf  = "";
   &tipo     = "";
   &cuenta   = "";
   &swdecl   = 0;
   &anyo1    = 0;
   &anyo2    = 0;
   &anyo3    = 0;
   &anyo4    = 0;
   &anyo5    = 0;
   &anyo6    = 0;
   &papel    = 0;
   &elnombre  = "";
   &apellidos = "";
   &vuelve    = 0;
   &seleccion = "";
   &campo     = 0;
   &chequeo   = 0;

   informe   = "";
   x         = 0;
   n         = "N";
   sw_impre  = 0;
   var       = 0;
   pepe      = 0;

   {-1} hojas = "";
        hojas1 = "2400";
        hojas2 = "1";
        hojas3 = "Elija impresion : ";
        hojas4 = "CH";
        hojas5 = "  papel Continuo  ";
        hojas6 = "  papel Hoja a hoja  ";

    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
|FIN;

|INCLUYE i_ficher;

|| **************************************************************************
||                           PROCESOS DEL PROGRAMA
|| **************************************************************************

|PROCESO seleccion; |TIPO 0;
|SI #0#0 = "S";
    |CAMPO_MODIFICA #0#01, 1, "S";
    |CAMPO_MODIFICA #0#02, 1, "S";
    |PARA x = 3; |SI x [ 32; |HACIENDO x = x + 1;
          #0x = 0; |PINTA #0x;
    |SIGUE;
    |CAMPO_MODIFICA #0#03, 1, "N"; |CAMPO_MODIFICA #0#04, 1, "N";
    |CAMPO_MODIFICA #0#05, 1, "N"; |CAMPO_MODIFICA #0#06, 1, "N";
    |CAMPO_MODIFICA #0#07, 1, "N"; |CAMPO_MODIFICA #0#08, 1, "N";
    |CAMPO_MODIFICA #0#09, 1, "N"; |CAMPO_MODIFICA #0#10, 1, "N";
    |CAMPO_MODIFICA #0#11, 1, "N"; |CAMPO_MODIFICA #0#12, 1, "N";
    |CAMPO_MODIFICA #0#13, 1, "N"; |CAMPO_MODIFICA #0#14, 1, "N";
    |CAMPO_MODIFICA #0#15, 1, "N"; |CAMPO_MODIFICA #0#16, 1, "N";
    |CAMPO_MODIFICA #0#17, 1, "N"; |CAMPO_MODIFICA #0#18, 1, "N";
    |CAMPO_MODIFICA #0#19, 1, "N"; |CAMPO_MODIFICA #0#20, 1, "N";
    |CAMPO_MODIFICA #0#21, 1, "N"; |CAMPO_MODIFICA #0#22, 1, "N";
    |CAMPO_MODIFICA #0#23, 1, "N"; |CAMPO_MODIFICA #0#24, 1, "N";
    |CAMPO_MODIFICA #0#25, 1, "N"; |CAMPO_MODIFICA #0#26, 1, "N";
    |CAMPO_MODIFICA #0#27, 1, "N"; |CAMPO_MODIFICA #0#28, 1, "N";
    |CAMPO_MODIFICA #0#29, 1, "N"; |CAMPO_MODIFICA #0#30, 1, "N";
    |CAMPO_MODIFICA #0#31, 1, "N"; |CAMPO_MODIFICA #0#32, 1, "N";
|SINO;
    #0#1 = 00001; |PINTA #0#1;
    #0#2 = 99999; |PINTA #0#2;
    |CAMPO_MODIFICA #0#01, 1, "N";
    |CAMPO_MODIFICA #0#02, 1, "N";

    |CAMPO_MODIFICA #0#03, 1, "S"; |CAMPO_MODIFICA #0#04, 1, "S";
    |CAMPO_MODIFICA #0#05, 1, "S"; |CAMPO_MODIFICA #0#06, 1, "S";
    |CAMPO_MODIFICA #0#07, 1, "S"; |CAMPO_MODIFICA #0#08, 1, "S";
    |CAMPO_MODIFICA #0#09, 1, "S"; |CAMPO_MODIFICA #0#10, 1, "S";
    |CAMPO_MODIFICA #0#11, 1, "S"; |CAMPO_MODIFICA #0#12, 1, "S";
    |CAMPO_MODIFICA #0#13, 1, "S"; |CAMPO_MODIFICA #0#14, 1, "S";
    |CAMPO_MODIFICA #0#15, 1, "S"; |CAMPO_MODIFICA #0#16, 1, "S";
    |CAMPO_MODIFICA #0#17, 1, "S"; |CAMPO_MODIFICA #0#18, 1, "S";
    |CAMPO_MODIFICA #0#19, 1, "S"; |CAMPO_MODIFICA #0#20, 1, "S";
    |CAMPO_MODIFICA #0#21, 1, "S"; |CAMPO_MODIFICA #0#22, 1, "S";
    |CAMPO_MODIFICA #0#23, 1, "S"; |CAMPO_MODIFICA #0#24, 1, "S";
    |CAMPO_MODIFICA #0#25, 1, "S"; |CAMPO_MODIFICA #0#26, 1, "S";
    |CAMPO_MODIFICA #0#27, 1, "S"; |CAMPO_MODIFICA #0#28, 1, "S";
    |CAMPO_MODIFICA #0#29, 1, "S"; |CAMPO_MODIFICA #0#30, 1, "S";
    |CAMPO_MODIFICA #0#31, 1, "S"; |CAMPO_MODIFICA #0#32, 1, "S";
|FINSI;
|FPRC;

|| **************************************************************************
||                           PROCESOS DE LA IMPRESION
|| **************************************************************************

|PROGRAMA;
|SI vuelve = 0;
    comienza = "XX";
    |HAZ fichero;
    |NOME_DAT #9 fichero;
    |ABRE #9; |CIERRA #9; |DELINDEX #9;

    comienza = "PA";
    |HAZ fichero;
    |NOME_DAT #0 fichero;
    |ABRE #0; |CIERRA #0; |DELINDEX #0;

    |ABRE #0;
    |CLS;
    |CABEZA "Emision Simplificada";
    |PINPA #0#0;
    |PINDA #0#0;
    |ENDATOS #1#0;
    |SI FSalida = 0;
        |IMPRE 0;
        |SI FSalida = 0;
            impresor = Impresora;
            |FINIMP;

            |HAZ impre;

            #0#35 = 1; |GRABA 040#0n;
            seleccion = #0#0;

            |SI #0#0 = "N";
                campo = 2;
                |HAZ leempre;
            |SINO;
                empresa = #0#1;
                |HAZ leempre;
            |FINSI;
        |FINSI;
    |FINSI;
    |CIERRA #0;
|SINO;
    comienza = "XX";
    |HAZ fichero;
    |NOME_DAT #9 fichero;

    comienza = "PA";
    |HAZ fichero;
    |NOME_DAT #0 fichero;

    |ABRE #0;
    |LEE 040#0p;
    |PINPA #0#6;
    |CIERRA #0;

    #6#0 = empresa; |PINTA #6#0;
    #6#1 = nombre;  |PINTA #6#1;

    |ABRE #1;
    |LIBERA #1;
    #1#0 = empresa;
    |LEE 140#1=;
    |SI FSalida ! 0; |CIERRA #1; |ACABA; |FINSI;

    |HAZ hoja8;

    |SI tipo = "T"; #1#138 = "S"; |FINSI;
    |SI tipo = "C"; #1#139 = "S"; |FINSI;
    |SI tipo = "1"; #1#198 = "S"; |FINSI;
    |SI tipo = "2"; #1#199 = "S"; |FINSI;
    |SI tipo = "3"; #1#200 = "S"; |FINSI;
    |SI tipo = "4"; #1#201 = "S"; |FINSI;

    |GRABA 140#1a;
    |LIBERA #1;
    |CIERRA #1;

    |HAZ leempre;
|FINSI;
|SI chequeo = 0; |ABRE #0; |CIERRA #0; |DELINDEX #0; |FINSI;
|FPRO;

|PROCESO impre;
|HAZ fecha;
|MENU hojas;
papel = FSalida;
|SI papel ! 1; |Y papel ! 2; |ACABA; |FINSI;
|FPRC;

|PROCESO fecha;
diainf  = #0#33 % 102;
mesinf  = #0#33 % 402;
anyoinf = #0#33 % 704;

|SI mesinf = "01"; mesinf = "Enero     "; |FINSI;
|SI mesinf = "02"; mesinf = "Febrero   "; |FINSI;
|SI mesinf = "03"; mesinf = "Marzo     "; |FINSI;
|SI mesinf = "04"; mesinf = "Abril     "; |FINSI;
|SI mesinf = "05"; mesinf = "Mayo      "; |FINSI;
|SI mesinf = "06"; mesinf = "Junio     "; |FINSI;
|SI mesinf = "07"; mesinf = "Julio     "; |FINSI;
|SI mesinf = "08"; mesinf = "Agosto    "; |FINSI;
|SI mesinf = "09"; mesinf = "Septiembre"; |FINSI;
|SI mesinf = "10"; mesinf = "Octubre   "; |FINSI;
|SI mesinf = "11"; mesinf = "Noviembre "; |FINSI;
|SI mesinf = "12"; mesinf = "Diciembre "; |FINSI;
|FPRC;

|PROCESO leempre;
|SI seleccion = "S";
  |ABRE #1;
  |ET arriba;
      #1#0 = empresa;
      |LEE 040#1];
      |SI FSalida = 0;
          empresa = #1#0;
          |SI #1#0 [ #0#2;
              |CIERRA #1;
              |HAZ chequeo;
              |SI chequeo = 0;  |ABRE #1;  |VETE arriba;  |FINSI;
          |SINO;
              chequeo = 0;
              |CIERRA #1;
          |FINSI;
      |SINO;
          chequeo = 0;
          |CIERRA #1;
      |FINSI;
|SINO;
      |HAZ parrilla;
|FINSI;
|FPRC;

|PROCESO parrilla;
|ABRE #1;
|ET parriba;
    |SI chequeo = 0; campo = campo + 1; |FINSI;
    |SI campo [ 32;
        #1#0 = #0campo;
        |LEE 040#1=;
        |SI FSalida = 0;
            |CIERRA #1;
            empresa = #0campo;
            |HAZ chequeo;
            |SI chequeo = 0;  |ABRE #1;  |VETE parriba;  |FINSI;
        |SINO;
            |VETE parriba;
        |FINSI;
    |SINO;
        chequeo = 0;
    |FINSI;
|CIERRA #1;
|FPRC;

|PROCESO chequeo;
chequeo = 0;
|ABRE #1;
#1#0 = empresa;
|LEE 040#1=;
|SI FSalida ! 0; |ACABA; |FINSI;
|CIERRA #1;

|ABRE #9;
#9#0 = #1#0;
|LEE 040#9=;
|SI FSalida ! 0;
    #9#0  = #1#0;
    #9#1  = "";
    #9#2  = #1#138;
    #9#3  = #1#139;
    #9#4  = #1#198;
    #9#5  = #1#199;
    #9#6  = #1#200;
    #9#7  = #1#201;
    #9#8  = 0;
    #9#9  = #0#37;
    #9#10 = #0#37;
    #9#11 = #0#37;
    #9#12 = #0#37;
    #9#13 = #0#37;
    #9#14 = #0#37;
    |GRABA 040#9n;
|FINSI;
|CIERRA #9;

chequeo = 1;
|HAZ alataque;
|FPRC;

|PROCESO alataque;
empresa = #1#0;

|ABRE #9;
#9#0 = empresa;
|LEE 040#9=;
|SI FSalida ! 0; |DDEFECTO #9; |FINSI;
|CIERRA #9;

|SI #1#142 = "N"; chequeo = 0; empresa = empresa + 1; |ACABA; |FINSI;

|SI #1#140 = "S"; |Y #9#2 = #0#36; |Y #9#9 > 0;
    tipo = "T";
    |HAZ graba_9;
    |HAZ ejecuciones;
    |ACABA;
|FINSI;
|SI #1#141 = "S"; |Y #9#3 = #0#36; |Y #9#10 > 0;
    tipo = "C";
    |HAZ graba_9;
    |HAZ ejecuciones;
    |ACABA;
|FINSI;
|SI #1#194 = "S"; |Y #9#4 = #0#36; |Y #9#11 > 0;
    tipo = "1";
    |HAZ graba_9;
    |HAZ ejecuciones;
    |ACABA;
|FINSI;
|SI #1#195 = "S"; |Y #9#5 = #0#36; |Y #9#12 > 0;
    tipo = "2";
    |HAZ graba_9;
    |HAZ ejecuciones;
    |ACABA;
|FINSI;
|SI #1#196 = "S"; |Y #9#6 = #0#36; |Y #9#13 > 0;
    tipo = "3";
    |HAZ graba_9;
    |HAZ ejecuciones;
    |ACABA;
|FINSI;
|SI #1#197 = "S"; |Y #9#7 = #0#36; |Y #9#14 > 0;
    tipo = "4";
    |HAZ graba_9;
    |HAZ ejecuciones;
    |ACABA;
|FINSI;

chequeo = 0;
empresa = empresa + 1;
|FPRC;

|PROCESO ejecuciones;
    |HAZ hoja1;
    #6#2 = ""; |PINTA #6#2;
    |CORRE "reem7141.run";
|FPRC;

|PROCESO hoja1;
swdecl = 0;
|SI #1#34 = "X"; swdecl = 1; |FINSI;
|SI #1#35 = "X"; swdecl = 2; |FINSI;
|SI #1#36 = "X"; swdecl = 1; |FINSI;

|SI tipo = "T";
    nombre  = #1#1;
    cif     = #1#2;
    cuenta  = #1#175;
    anyo1   = #1#3;
|FINSI;
|SI tipo = "C";
    nombre  = #1#28;
    cif     = #1#29;
    cuenta  = #1#176;
    anyo2   = #1#30;
|FINSI;
|SI tipo = "1";
    nombre = "";  cif  = ""; anyo3 = 0;
    |SI #1#98 ! 0;
        var = 57 + #1#98; nombre  = #1var;
        var = 47 + #1#98; cif     = #1var;
        var = 67 + #1#98; anyo3   = #1var;
    |FINSI;
    cuenta  = #1#177;
|FINSI;
|SI tipo = "2";
    nombre = "";  cif  = ""; anyo4 = 0;
    |SI #1#99 ! 0;
        var = 57 + #1#99; nombre  = #1var;
        var = 47 + #1#99; cif     = #1var;
        var = 67 + #1#99; anyo4   = #1var;
    |FINSI;
    cuenta  = #1#178;
|FINSI;
|SI tipo = "3";
    nombre = "";  cif  = ""; anyo5 = 0;
    |SI #1#100 ! 0;
        var = 57 + #1#100; nombre  = #1var;
        var = 47 + #1#100; cif     = #1var;
        var = 67 + #1#100; anyo5   = #1var;
    |FINSI;
    cuenta  = #1#179;
|FINSI;
|SI tipo = "4";
    nombre = "";  cif  = ""; anyo6 = 0;
    |SI #1#101 ! 0;
        var = 57 + #1#101; nombre  = #1var;
        var = 47 + #1#101; cif     = #1var;
        var = 67 + #1#101; anyo6   = #1var;
    |FINSI;
    cuenta  = #1#180;
|FINSI;

|HAZ sep_nombre;

|PINPA  #0#6;
#6#0 = empresa;  |PINTA #6#0;
#6#1 = nombre;   |PINTA #6#1;

|ABRE #2;
#2#0 = #1#40;
#2#1 = #1#41;
|LEE 040#2=;
|SI FSalida ! 0; |DDEFECTO #2; |FINSI;
|CIERRA #2;

|ABRE #3;
#3#0 = #1#44;
|LEE 040#3=;
|SI FSalida ! 0; |DDEFECTO #3; |FINSI;
|CIERRA #3;

|ABRE #4;
#4#0 = #1#12;
#4#1 = #1#13;
|LEE 040#4=;
|SI FSalida ! 0; |DDEFECTO #4; |FINSI;
|CIERRA #4;

Impresora = impresor;
|IMPRE -1;
|SI FSalida = 0;
    |SI #0#34 = "S"; |Y papel = 1;
        informe = "rehoblan"; |HAZ continuo;
    |FINSI;

    |SI papel = 1;
        informe = "reho7141"; |HAZ continuo;
    |SINO;
        informe = "rema7141"; |HAZ manual;
    |FINSI;
    |FINIMP;
|FINSI;
|FPRC;

|PROCESO sep_nombre;
    elnombre = "";
    apellidos = "";
    alfa1 = nombre;
|QBF alfa1;
    alfa2 = alfa1 % 0;
    nume1 = alfa2;
    nume3 = 2;
|PARA para1 = 1; |SI para1 [ nume1; |HACIENDO para1 = para1 + 1;
        nume2 = (para1 * 100) + 1;
        alfa2 = alfa1 % nume2;
    |SI nume3 = 2;            || si aun no ha encontrado la coma
        |SI alfa2 = ",";      || la busca
                nume3 = 1;    || nombre
                alfa2 = "";
        |SINO;
                nume3 = 2;    || apellidos
        |FINSI;
    |FINSI;
    |SI nume3 = 1;  elnombre  = elnombre  + alfa2;  |FINSI;
    |SI nume3 = 2;  apellidos = apellidos + alfa2;  |FINSI;
|SIGUE;
|FPRC;

|PROCESO hoja8;
|ABRE #5;
#5#0  = empresa;
#5#28 = tipo;
|LEE 040#5=;
|SI FSalida ! 0; |DDEFECTO #5; |FINSI;
|CIERRA #5;

|ABRE #2;
#2#0 = #1#40;
#2#1 = #1#41;
|LEE 040#2=;
|SI FSalida ! 0; |DDEFECTO #2; |FINSI;
|CIERRA #2;

|ABRE #4;
#4#0 = #1#12;
#4#1 = #1#13;
|LEE 040#4=;
|SI FSalida ! 0; |DDEFECTO #4; |FINSI;
|CIERRA #4;

Impresora = impresor;
|IMPRE -1;
|SI FSalida = 0;
    |SI papel = 1;
        informe = "reho7148"; |HAZ continuo;
        informe = "reho714b"; |HAZ continuo;
    |SINO;
        informe = "rema7148"; |HAZ manual;
        informe = "rema714b"; |HAZ manual;
    |FINSI;

    |SI papel = 1;
        informe = "reho7149"; |HAZ continuo;
    |SINO;
        informe = "rema7149"; |HAZ manual;
    |FINSI;
    |FINIMP;
|FINSI;
|FPRC;

|PROCESO continuo;
|INFOR informe;
|SI FSalida = 0;
    |PRINT; |PIEINF; |FININF;
|FINSI;
|FPRC;

|PROCESO manual;
|ET comienzo;
    |SI informe = "rema7141";
        #6#2 = "COLOQUE PAGINA 1 DEL PATRIMONIO, <INTRO PARA IMPRIMIR>";
    |FINSI;
    |SI informe = "rema7148";
        #6#2 = "COLOQUE PAGINA 9 DEL PATRIMONIO, <INTRO PARA IMPRIMIR>";
    |FINSI;
    |SI informe = "rema714b";
        #6#2 = "COLOQUE PAGINA 10 DEL PATRIMONIO, <INTRO PARA IMPRIMIR>";
    |FINSI;
    |SI informe = "rema7149";
        #6#2 = "COLOQUE PAGINA DE INGRESOS, <INTRO PARA IMPRIMIR>";
    |FINSI;

    |ATRI P; |PINTA #6#2; |ATRI 0;
    |PAUSA;

    |INFOR informe;
    |SI FSalida = 0;
        |PRINT; |PIEINF; |FININF;
    |FINSI;

    |CONFI "2400NDesea repetir la hoja : ";
    |SI FSalida = 0; |VETE comienzo; |FINSI;
|FPRC;

|PROCESO graba_9;
|ABRE #9;
#9#0 = empresa;
|LIBERA #9;
|LEE 140#9=;
|SI FSalida = 0;
    |SI tipo = "T"; #9#9  = #9#9  - 1; |FINSI;
    |SI tipo = "C"; #9#10 = #9#10 - 1; |FINSI;
    |SI tipo = "1"; #9#11 = #9#11 - 1; |FINSI;
    |SI tipo = "2"; #9#12 = #9#12 - 1; |FINSI;
    |SI tipo = "3"; #9#13 = #9#13 - 1; |FINSI;
    |SI tipo = "4"; #9#14 = #9#14 - 1; |FINSI;
    |GRABA 140#9a;
|FINSI;
|CIERRA #9;
|FPRC;
