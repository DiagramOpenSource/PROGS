|FICHEROS;
   reinfban #0;
   redatcon #1;
   reliquid #2;
   recapinm #3;
   realc210 #4;
   reall210 #5;
   reven210 #6;
   retabla3 #7;
|FIN;

|VARIABLES;
   xxx        = 0;
   imp        = 0;
   sw         = 0;
   sw_pasa    = 0;
   sw_pie     = 0;

   para1      = 0;
   para2      = 0;
   para3      = 0;
   nume1      = 0;
   el_01      = 0;
   el_02      = 0;
   el_03      = 0;
   el_04      = 0;
   el_05      = 0;
   el_06      = 0;
   el_07      = 0;
   hasta      = 0;
   resto      = 0;
   cuota      = 0;
   cuot2      = 0;
   porce      = 0;
   conta      = 0;
   coefi      = 0;
   inicio     = @;
   base2      = 0;
   fecha      = "";
   pepe1      = 0;
   pepe2      = 0;

   &codigo    = 0;
   &nombre    = "";
   &imp_1     = 0;
   &imp_2     = 0;
   &imp_3     = 0;
   &imp_4     = 0;
   &imp_5     = 0;
   &imp_6     = 0;
   &imp_7     = 0;
   &que_es    = "";
   &r_1       = 0;
   &r_2       = 0;
   &r_3       = 0;
   &r_4       = 0;
   &r_5       = 0;
   &r_6       = 0;
   &r_7       = 0;
   &p_1       = 0;
   &p_2       = 0;
   &p_3       = 0;
   &p_4       = 0;
   &p_5       = 0;
   &p_6       = 0;
   &p_7       = 0;
|FIN;

|PROCESO si_reside;
imp_1 = 0; imp_2 = 0; imp_3 = 0; imp_4 = 0; imp_5 = 0; imp_6 = 0; imp_7 = 0;

|SI #1#124 = "S"; |Y #2#8  > 0; imp_1 = #2#8;  |FINSI;
|SI #1#125 = "S"; |Y #2#9  > 0; imp_2 = #2#9;  |FINSI;
|SI #1#126 = "S"; |Y #2#10 > 0; imp_3 = #2#10; |FINSI;
|SI #1#127 = "S"; |Y #2#11 > 0; imp_4 = #2#11; |FINSI;
|SI #1#128 = "S"; |Y #2#12 > 0; imp_5 = #2#12; |FINSI;
|SI #1#129 = "S"; |Y #2#13 > 0; imp_6 = #2#13; |FINSI;
|SI #1#130 = "S"; |Y #2#14 > 0; imp_7 = #2#14; |FINSI;
imp = imp_1 + imp_2 + imp_3 + imp_4 + imp_5 + imp_6 + imp_7;

|SI imp ! 0;
    sw     = 1;
    codigo = #1#0;
    nombre = #1#1;
    que_es = "RENTA";
    |PRINT;
    |HAZ total_pie;
|FINSI;

imp_1 = 0; imp_2 = 0; imp_3 = 0; imp_4 = 0; imp_5 = 0; imp_6 = 0; imp_7 = 0;

|SI #1#138 = "S"; |Y #2#35 > 0; imp_1 = #2#35; |FINSI;
|SI #1#139 = "S"; |Y #2#36 > 0; imp_2 = #2#36; |FINSI;
|SI #1#198 = "S"; |Y #2#37 > 0; imp_3 = #2#37; |FINSI;
|SI #1#199 = "S"; |Y #2#38 > 0; imp_4 = #2#38; |FINSI;
|SI #1#200 = "S"; |Y #2#39 > 0; imp_5 = #2#39; |FINSI;
|SI #1#201 = "S"; |Y #2#40 > 0; imp_6 = #2#40; |FINSI;
imp = imp_1 + imp_2 + imp_3 + imp_4 + imp_5 + imp_6;

|SI imp ! 0;
    |SI sw = 0; codigo = #1#0; nombre = #1#1; |FINSI;
    que_es = "PATRIMONIO";
    |PRINT;
    |HAZ total_pie;
|FINSI;
|FPRC;

|PROCESO ventas;
|ABRE #6;
#6#0 = #1#0;
|LEE 040#6=;
|SI FSalida ! 0; |CIERRA #6; |ACABA; |FINSI;

sw_pasa = 1;
|SI #6#56 = "S";
    |SI #6#54 > 0; imp_2 = #6#54; |FINSI;
|FINSI;
|CIERRA #6;
|FPRC;

|PROCESO mira_cab;
#4#0 = #5#0;
|LEE 040#4=;
|SI FSalida ! 0; |DDEFECTO #4; |FINSI;

sw_pasa = 1;
|SI #4#6 ! "S"; |ACABA; |FINSI;

|SI #5#20 > 0;
    imp_2 = imp_2 + #5#20;
|FINSI;
|FPRC;

|DEFBUCLE reall210;
#5#1;
2;
000, 000, #1#0;
999, 999, #1#0;
e;
NULL, mira_cab;
|FIN;

|PROCESO alquiler;
|ABRE #4;
|BUCLE reall210;
|CIERRA #4;
|FPRC;

|PROCESO el_210;
|SI #3#2 = "G";
    conta = conta + 1;
    |SI conta > 6; |ACABA; |FINSI;

    imp_2  = imp_2 + ((#3#47 % 50) % 25);

    conta = conta + 1;
    |SI conta > 6; |ACABA; |FINSI;

    imp_3  = imp_3 + ((#3#47 % 50) % 25);
|SINO;
    conta = conta + 1;
    |SI conta > 6; |ACABA; |FINSI;
    imp_2  = imp_2 + (#3#47 % 25);
|FINSI;
|FPRC;

|DEFBUCLE recapinm_1;
#3#1;
;
#1#0, 00;
#1#0, 99;
e;
NULL, el_210;
|FIN;

|PROCESO modelo_210;
conta = 0;
|BUCLE recapinm_1;
|FPRC;

|PROCESO el_214;
|SI #1#36 = "X"; |Y #3#2 = "G";
    coefi = 50;
|SINO;
    coefi = 100;
|FINSI;

#3#8  = #3#8  % coefi;
#3#9  = #3#9  % coefi;
#3#10 = #3#10 % coefi;
#3#14 = #3#14 % coefi;
#3#17 = #3#17 % coefi;
#3#18 = #3#18 % coefi;
#3#19 = #3#19 % coefi;
#3#20 = #3#20 % coefi;

|SI #3#8 > #3#17;
        el_01 = #3#8;         || valor catastral
|SINO;
        el_01 = #3#17;        || precio adquisicion
|FINSI;

|SI el_01 < #3#19;
        el_01 = #3#19;        || valor comprobado
|FINSI;

|ABRE #7;
|LEE 040#7p;
|SI FSalida ! 0; |DDEFECTO #7; |FINSI;
|CIERRA #7;

|SI el_01 ! 0;                                    || valor  [01]
        el_02 = #3#9 + #3#10 + #3#14 + #3#20;     || deudas [02]
        el_03 = el_01 - el_02;                    || base liquidable
    |PARA para1 = 8; |SI para1 ] 1; |HACIENDO para1 = para1 - 1;
            para2 = para1 + 8;
            para3 = para1 + 16;
        |SI el_03 > #7para1;
                hasta = #7para1;

                cuota = #7para2;
                porce = #7para3;
                resto = el_03 - hasta;
                cuot2 = (resto % porce) ! 0;
                el_04 = cuota + cuot2;       || cuota integra
            |SAL;
        |FINSI;
    |SIGUE;

    |SI inicio < #3#18;
            nume1 = 365 - (#3#18 - inicio);
            base2 = (nume1 * el_01) / 365;
    |SINO;
            base2 = el_01;
    |FINSI;

    el_05 = base2 % 2;
    el_06 = el_05 % 25;
    el_07 = el_04 + el_06;
    |SI coefi = 50;
        imp_2 = imp_2 + el_06;
        imp_3 = imp_3 + el_06;
        imp_4 = imp_4 + el_04;
        imp_5 = imp_5 + el_04;
    |SINO;
        imp_2 = imp_2 + el_06;
        imp_4 = imp_4 + el_04;
    |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE recapinm_2;
#3#1;
;
#1#0, 00;
#1#0, 99;
e;
NULL, el_214;
|FIN;

|PROCESO modelo_214;
conta = 0;
|BUCLE recapinm_2;
|FPRC;

|PROCESO no_reside;
imp_1 = 0; imp_2 = 0; imp_3 = 0; imp_4 = 0; imp_5 = 0; imp_6 = 0; imp_7 = 0;
sw_pasa = 0;

|SI #1#138 = "S";
    |HAZ ventas;
    |HAZ alquiler;
    |SI sw_pasa = 0;
        |HAZ modelo_210;
    |FINSI;

    imp = imp_2 + imp_3;
    |SI imp ! 0;
        sw = 1;
        codigo = #1#0;
        nombre = #1#1;
        que_es = "RENTA";
        |PRINT;
        |HAZ total_pie;
    |FINSI;

    codigo = 0;
    nombre = "";
    imp_2  = #2#35;
    imp_3  = #2#36;
    imp    = imp_2 + imp_3;
    |SI imp ! 0;
        |SI sw = 0; codigo = #1#0; nombre = #1#1; |FINSI;
        que_es = "PATRIMONIO";
        |PRINT;
        |HAZ total_pie;
    |FINSI;
|SINO;
    |HAZ ventas;
    |HAZ alquiler;
    |SI sw_pasa = 0;
        |HAZ modelo_214;
    |FINSI;
    pepe1  = imp_4;
    pepe2  = imp_5;
    imp_4  = 0;
    imp_5  = 0;

    imp = imp_2 + imp_3;
    |SI imp ! 0;
        sw = 1;
        codigo = #1#0;
        nombre = #1#1;
        que_es = "RENTA";
        |PRINT;
        |HAZ total_pie;
    |FINSI;

    imp = pepe1 + pepe2;
    |SI imp ! 0;
        codigo = 0;
        nombre = "";
        |SI sw = 0; codigo = #1#0; nombre = #1#1; |FINSI;
        imp_2 = pepe1;
        imp_3 = pepe2;
        que_es = "PATRIMONIO";
        |PRINT;
        |HAZ total_pie;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO total_pie;
sw_pie = 1;
|SI que_es = "RENTA";
    r_1 = r_1 + imp_1;
    r_2 = r_2 + imp_2;
    r_3 = r_3 + imp_3;
    r_4 = r_4 + imp_4;
    r_5 = r_5 + imp_5;
    r_6 = r_6 + imp_6;
    r_7 = r_7 + imp_7;
|FINSI;

|SI que_es = "PATRIMONIO";
    p_1 = p_1 + imp_1;
    p_2 = p_2 + imp_2;
    p_3 = p_3 + imp_3;
    p_4 = p_4 + imp_4;
    p_5 = p_5 + imp_5;
    p_6 = p_6 + imp_6;
    p_7 = p_7 + imp_7;
|FINSI;
|FPRC;

|PROCESO impre;
#2#0 = #1#0;
|LEE 040#2=;
|SI FSalida ! 0; |DDEFECTO #2; |FINSI;

codigo = 0;
nombre = "";
sw     = 0;

|SI #1#4 = "S"; |HAZ si_reside; |FINSI;
|SI #1#4 = "N"; |HAZ no_reside; |FINSI;
|FPRC;

|PROCESO tipo_3; |TIPO 3;
inicio  = ~;
fecha   = "01.01." + (inicio % -104);
inicio  = fecha;

|IMPRE 0;
|SI FSalida ! 0; |ACABA; |FINSI;

|INFOR "reinfban";
|SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;

|ABRE #1;
|ABRE #2;

|PARA xxx = 0; |SI xxx [ 29; |HACIENDO xxx = xxx + 1;
      |SI #0xxx ! 0;
          #1#0 = #0xxx;
          |LEE 040#1=;
          |SI FSalida = 0; |HAZ impre; |FINSI;
      |FINSI;
|SIGUE;
|CIERRA #1;
|CIERRA #2;
|SI sw_pie = 1; |PIEINF; |FINSI;
|FININF;
|FINIMP;
|FPRC;
