|FICHEROS;
    retransp #0;
    reproedi #1;
    reprofco #2;
    reempedi #3;
    reemprco #4;
    reincide #5;
    retotren #6;
    redatcon #7;
    retotpat #8;
    reprogra #10;
    retotrea #11;
|FIN;

|VARIABLES;
    agricola  = 0;
    pepe      = 0;
    sw_fich   = 0;
    numero1   = 0;
    numero2   = 0;
    numero3   = 0;
    numero4   = 0;
    numero5   = 0;
    numero6   = 0;
    coefi1    = 0;
    coefi2    = 0;
    periodo   = 0;
    coefi11   = 0.0000;
    funeral   = 0;
    zz        = 0;
    suma      = 0;
    mayor     = 0;
    tope      = 0;
    maximo    = 0;
    FEstado   = 0;
    FEstad1   = 0;
    sw        = 0;

    tipod     = "";
    perceptor = "";
    tipore    = "";
    minusva   = "";
    numero   = "";
    s        = "S";
    alfa1    = "";
    linea    = "";
    rendi    = "";
    descri   = "";
    contenido = "";
    blanco    = "                                        ";
    empreac   = 0;
    tipop      = "";
    tipoprop   = "";
    cantidad   = 0;
    cantidad1  = 0;
    anyos      = 0;
    anyou      = 0;
    porce      = 0;
    var        = 0;

    &incisino = "";
    &modo     = 0;
    &empresa  = 0;
    &emprefi  = 0;
    &nombre   = "";
    &lininci  = 0;
    &swcalcu  = 0;
    &minusva1 = "";
    &minusva2 = "";
    &minusva3 = "";
    &minusva4 = "";
    &minusva5 = "";
    &minusva6 = "";
    &declara  = "";
    &individu = 0;
    &acceso   = 0;
    &recalcu  = 0;
    &tippar   = 0;
    &parte1   = 0;
    &parte2   = 0;
    &muerto   = "";
    &fecpar   = @;
    &netot    = 0;
    &netoc    = 0;
    &netoa    = 0;
    &trabat   = 0;
    &trabac   = 0;
    &trabaa   = 0;
    &obitus   = 0;
|FIN;

|| **************************************************************************
||                   PROCESO DE LECTURA DE LOS DISTINTOS FICHEROS
|| **************************************************************************

|PROCESO fichero0;           || Trata Transparencia Fiscal
alfa1     = "TRANSPARENCIA FISCAL --------------------------------------------";
tipod     = #0#2;
tipore    = #0#4;
descri    = #0#13;
linea     = #0#1;
rendi     = #0#22;
perceptor = #0#3;
numero1   = #0#7;
numero2   = #0#8;
numero3   = #0#9;
numero4   = #0#10;
numero5   = #0#11;
numero6   = #0#12;
sw_fich   = 0;
empreac   = #0#0;
periodo   = #0#23;

|SI #0#4 = "X"; |O #0#4 = "P"; |O #0#4 = "R";
    |HAZ incidenci1;
|FINSI;

|SI #0#4 = "A"; |O #0#4 = "R";
    |SI #0#5 ! "N"; |HAZ tipodecl; |FINSI;
|FINSI;
|FPRC;

|PROCESO fichero1;            || Trata Profesional Directa
alfa1     = "ACTIVIDADES PROFESIONALES DIRECTAS ------------------------------";
tipod     = #1#2;
tipore    = #1#4;
descri    = #1#15;
linea     = #1#1;
rendi     = #1#28;
perceptor = #1#3;
numero1   = #1#7;
numero2   = #1#8;
numero3   = #1#9;
numero4   = #1#10;
numero5   = #1#11;
numero6   = #1#12;
sw_fich   = 1;
empreac   = #1#0;
tipoprop  = #1#5;
periodo   = #1#35;
cantidad1 = 0;

|SI #1#4 = "X"; |O #1#4 = "P"; |O #1#4 = "R";
    |HAZ incidenci1;
|FINSI;

|SI #1#4 = "A"; |O #1#4 = "R";
    |SI #1#5 ! "N"; |HAZ tipodecl; |FINSI;
|FINSI;

  |SI #1#4 ! "P"; |Y #1#4 ! "A";
      |ACABA;
  |FINSI;

  tipop = "C1";
  cantidad1 = #1#17;
  tipod = #1#2;
  |SI #1#5 ! "P"; anyou = #1#6; |HAZ calcuprop; |FINSI;

  |SI cantidad1 [ 0; |ACABA; |FINSI;

  |SI periodo ! 1;
      |SI #1#2 ! "G"; |Y #1#2 ! "V";
          tipod = #1#2; cantidad = cantidad1; |HAZ grabapat; |ACABA;
      |FINSI;

      |SI #1#2 = "V";
          |SI tippar = 2;
              |SI muerto = "T";
                  #1#7 = 0;
              |SINO;
                  #1#8 = 0;
              |FINSI;
          |FINSI;
          tipod = "T"; cantidad = cantidad1 % #1#7;  |HAZ grabapat;
          tipod = "C"; cantidad = cantidad1 % #1#8;  |HAZ grabapat;
          tipod = "1"; cantidad = cantidad1 % #1#9;  |HAZ grabapat;
          tipod = "2"; cantidad = cantidad1 % #1#10; |HAZ grabapat;
          tipod = "3"; cantidad = cantidad1 % #1#11; |HAZ grabapat;
          tipod = "4"; cantidad = cantidad1 % #1#12; |HAZ grabapat;
          |ACABA;
      |FINSI;

      |SI #1#2 = "G";
          |SI tippar = 2;
              |SI muerto = "T";
                 tipod = "C"; cantidad = cantidad1; |HAZ grabapat;
                 |ACABA;
              |SINO;
                 tipod = "T"; cantidad = cantidad1; |HAZ grabapat;
                 |ACABA;
              |FINSI;
          |SINO;
              tipod = "T"; cantidad = cantidad1 % 50; |HAZ grabapat;
              tipod = "C"; cantidad = cantidad1 % 50; |HAZ grabapat;
              |ACABA;
          |FINSI;
      |FINSI;
  |FINSI;
|FPRC;

|PROCESO fichero2;       || Trata  Profesional Coeficientes
alfa1     = "ACTIVIDADES PROFESIONALES COEFICIENTES --------------------------";
tipod     = #2#2;
tipore    = #2#4;
descri    = #2#15;
linea     = #2#1;
rendi     = #2#32;
perceptor = #2#3;
numero1   = #2#7;
numero2   = #2#8;
numero3   = #2#9;
numero4   = #2#10;
numero5   = #2#11;
numero6   = #2#12;
sw_fich   = 2;
empreac   = #2#0;
tipoprop  = #2#5;
periodo   = #2#42;

cantidad1 = 0;

|SI #2#4 = "X"; |O #2#4 = "P"; |O #2#4 = "R";
    |HAZ incidenci1;
|FINSI;

|SI #2#4 = "A"; |O #2#4 = "R";
    |SI #2#5 ! "N"; |HAZ tipodecl; |FINSI;
|FINSI;

  |SI #2#4 ! "P"; |Y #2#4 ! "A";
      |ACABA;
  |FINSI;
  tipop = "C1";
  cantidad1 = #2#16;
  tipod = #2#2;
  |SI #2#5 ! "P"; anyou = #2#6; |HAZ calcuprop; |FINSI;

  |SI cantidad1 [ 0; |ACABA; |FINSI;

  |SI periodo ! 1;
      |SI #2#2 ! "V"; |Y #2#2 ! "G";
          tipod = #2#2; cantidad = cantidad1; |HAZ grabapat; |ACABA;
      |FINSI;

      |SI #2#2 = "V";
          |SI tippar = 2;
              |SI muerto = "T";
                  #2#7 = 0;
              |SINO;
                  #2#8 = 0;
              |FINSI;
          |FINSI;
          tipod = "T"; cantidad = cantidad1 % #2#7;  |HAZ grabapat;
          tipod = "C"; cantidad = cantidad1 % #2#8;  |HAZ grabapat;
          tipod = "1"; cantidad = cantidad1 % #2#9;  |HAZ grabapat;
          tipod = "2"; cantidad = cantidad1 % #2#10; |HAZ grabapat;
          tipod = "3"; cantidad = cantidad1 % #2#11; |HAZ grabapat;
          tipod = "4"; cantidad = cantidad1 % #2#12; |HAZ grabapat;
          |ACABA;
      |FINSI;

      |SI #2#2 = "G";
          |SI tippar = 2;
              |SI muerto = "T";
                 tipod = "C"; cantidad = cantidad1; |HAZ grabapat;
                 |ACABA;
              |SINO;
                 tipod = "Y"; cantidad = cantidad1; |HAZ grabapat;
                 |ACABA;
              |FINSI;
          |SINO;
              tipod = "T"; cantidad = cantidad1 % 50; |HAZ grabapat;
              tipod = "C"; cantidad = cantidad1 % 50; |HAZ grabapat;
              |ACABA;
          |FINSI;
      |FINSI;
  |FINSI;
|FPRC;

|PROCESO fichero3;            || Trata Empresarial Directa
alfa1     = "ACTIVIDADES EMPRESARIALES DIRECTAS ------------------------------";
tipod     = #3#2;
tipore    = #3#4;
descri    = #3#15;
linea     = #3#1;
rendi     = #3#49;
perceptor = #3#3;
numero1   = #3#7;
numero2   = #3#8;
numero3   = #3#9;
numero4   = #3#10;
numero5   = #3#11;
numero6   = #3#12;
sw_fich   = 3;
empreac   = #3#0;
tipoprop  = #3#5;
periodo   = #3#54;

cantidad1 = 0;

|SI #3#4 = "X"; |O #3#4 = "P"; |O #3#4 = "R";
    |HAZ incidenci1;
|FINSI;

|SI #3#4 = "A"; |O #3#4 = "R";
    |SI #3#5 ! "N"; |HAZ tipodecl; |FINSI;
|FINSI;

  |SI #3#4 ! "P"; |Y #3#4 ! "A";
      |ACABA;
  |FINSI;
  tipop = "C1";
  cantidad1 = #3#16;
  tipod = #3#2;
  |SI #3#5 ! "P"; anyou = #3#6; |HAZ calcuprop; |FINSI;

  |SI cantidad1 [ 0; |ACABA; |FINSI;

  |SI periodo ! 1;
      |SI #3#2 ! "G"; |Y #3#2 ! "V";
          tipod = #3#2; cantidad = cantidad1; |HAZ grabapat; |ACABA;
      |FINSI;

      |SI #3#2 = "V";
          |SI tippar = 2;
              |SI muerto = "T";
                  #3#7 = 0;
              |SINO;
                  #3#8 = 0;
              |FINSI;
          |FINSI;
          tipod = "T"; cantidad = cantidad1 % #3#7;  |HAZ grabapat;
          tipod = "C"; cantidad = cantidad1 % #3#8;  |HAZ grabapat;
          tipod = "1"; cantidad = cantidad1 % #3#9;  |HAZ grabapat;
          tipod = "2"; cantidad = cantidad1 % #3#10; |HAZ grabapat;
          tipod = "3"; cantidad = cantidad1 % #3#11; |HAZ grabapat;
          tipod = "4"; cantidad = cantidad1 % #3#12; |HAZ grabapat;
          |ACABA;
      |FINSI;

      |SI #3#2 = "G";
          |SI tippar = 2;
              |SI muerto = "T";
                  tipod = "C"; cantidad = cantidad1; |HAZ grabapat;
                  |ACABA;
              |SINO;
                  tipod = "T"; cantidad = cantidad1; |HAZ grabapat;
                  |ACABA;
              |FINSI;
          |SINO;
              tipod = "T"; cantidad = cantidad1 % 50; |HAZ grabapat;
              tipod = "C"; cantidad = cantidad1 % 50; |HAZ grabapat;
              |ACABA;
          |FINSI;
      |FINSI;
  |FINSI;
|FPRC;

|PROCESO fichero4;         || Trata Empresarial Coeficientes
alfa1 = "ACTIVIDADES EMPRESARIALES COEFICIENTES ------------------------------";
tipod     = #4#2;
tipore    = #4#4;
descri    = #4#15;
linea     = #4#1;
rendi     = #4#32;
perceptor = #4#3;
numero1   = #4#7;
numero2   = #4#8;
numero3   = #4#9;
numero4   = #4#10;
numero5   = #4#11;
numero6   = #4#12;
sw_fich   = 4;
empreac   = #4#0;
tipoprop  = #4#5;
periodo   = #4#43;
cantidad1 = 0;
agricola  = 0;
|SI #4#47 = "N"; agricola = 1; |FINSI;

|SI #4#4 = "X"; |O #4#4 = "P"; |O #4#4 = "R";
    |HAZ incidenci1;
|FINSI;

|SI #4#4 = "A"; |O #4#4 = "R";
    |SI #4#5 ! "N"; |HAZ tipodecl; |FINSI;
|FINSI;

  |SI #4#4 ! "P"; |Y #4#4 ! "A";
      |ACABA;
  |FINSI;
  tipop = "C1";
  cantidad1 = #4#16;
  tipod = #4#2;
  |SI #4#5 ! "P"; anyou = #4#6; |HAZ calcuprop; |FINSI;

  |SI cantidad1 [ 0; |ACABA; |FINSI;

  |SI periodo ! 1;
      |SI #4#2 ! "V"; |Y #4#2 ! "G";
          tipod = #4#2; cantidad = cantidad1; |HAZ grabapat; |ACABA;
      |FINSI;

      |SI #4#2 = "V";
          |SI tippar = 2;
           |SI muerto = "T";
                  #4#7 = 0;
              |SINO;
                  #4#8 = 0;
              |FINSI;
          |FINSI;
          tipod = "T"; cantidad = cantidad1 % #4#7;  |HAZ grabapat;
          tipod = "C"; cantidad = cantidad1 % #4#8;  |HAZ grabapat;
          tipod = "1"; cantidad = cantidad1 % #4#9;  |HAZ grabapat;
          tipod = "2"; cantidad = cantidad1 % #4#10; |HAZ grabapat;
          tipod = "3"; cantidad = cantidad1 % #4#11; |HAZ grabapat;
          tipod = "4"; cantidad = cantidad1 % #4#12; |HAZ grabapat;
          |ACABA;
      |FINSI;

      |SI #4#2 = "G";
          |SI tippar = 2;
              |SI muerto = "T";
                  tipod = "C"; cantidad = cantidad1; |HAZ grabapat;
                  |ACABA;
              |SINO;
                  tipod = "T"; cantidad = cantidad1; |HAZ grabapat;
                  |ACABA;
              |FINSI;
          |SINO;
              tipod = "T"; cantidad = cantidad1 % 50; |HAZ grabapat;
              tipod = "C"; cantidad = cantidad1 % 50; |HAZ grabapat;
              |ACABA;
          |FINSI;
      |FINSI;
  |FINSI;
|FPRC;

|| **************************************************************************
                        TRATAMIENTO DE LA LIQUIDACION
|| **************************************************************************

|PROCESO tipodecl;
  coefi11 = 1;
  funeral = 0;
  |SI tipod = "G";  |Y tippar = 1;   || Si es Ganancial  Y MATRIMONIO;
      |SI periodo = 0;
          coefi1= 50*parte1; coefi11 = .5; zz = 25; tipod="T"; |HAZ leeliqui;
          coefi1= 50*parte1; coefi11 = .5; zz = 25; tipod="C"; |HAZ leeliqui;
          coefi1=100*parte2; coefi11 =  1; zz=  50;  tipod="A"; |HAZ leeliqui;
      |SINO;
          |SI periodo = 1;
              coefi1 = 50; coefi11 = .5; zz = 50; tipod  = "T"; |HAZ leeliqui;
              coefi1 = 50; coefi11 = .5; zz = 50; tipod  = "C"; |HAZ leeliqui;
          |SINO;
              coefi1 = 100; coefi11 = 1; zz =100; tipod  = "A"; |HAZ leeliqui;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;

  |SI tipod = "G";  |Y tippar = 3;   || Si es Ganancial  Y SEPARACION;
      |SI periodo = 0;
          coefi1= 50*parte2; coefi11 = .5; zz = 25; tipod="T"; |HAZ leeliqui;
          coefi1= 50*parte2; coefi11 = .5; zz = 25; tipod="C"; |HAZ leeliqui;
          coefi1=100*parte1; coefi11 =  1; zz = 50; tipod="A"; |HAZ leeliqui;
      |SINO;
          |SI periodo = 1;
              zz = 100;
              coefi1 = 100; coefi11 = 1; tipod  = "A"; |HAZ leeliqui;
          |SINO;
              zz = 50;
              coefi1 =  50; coefi11 = .5;  tipod  = "T"; |HAZ leeliqui;
              coefi1 =  50; coefi11 = .5;  tipod  = "C"; |HAZ leeliqui;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;


  || Si es Ganancial, conjunta y SE MUERE EL;

  |SI tipod = "G";  |Y tippar = 2; |Y muerto = "T";  |Y obitus = 1;
      |SI periodo = 0;
          coefi1= 100*parte2; coefi11 = 1; zz = 50; tipod="C"; |HAZ leeliqui;
          coefi1= 100*parte1; coefi11 = 1; zz = 50; tipod="A"; |HAZ leeliqui;
      |SINO;
          |SI periodo = 1;
              zz = 100;
              coefi1 = 100; coefi11 = 1; tipod  = "A"; |HAZ leeliqui;
          |SINO;
              zz = 100;
              coefi1 = 100; coefi11 = 1; tipod  = "C"; |HAZ leeliqui;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;


  || Si es Ganancial, conjunta y SE MUERE ELLA;

  |SI tipod = "G";  |Y tippar = 2; |Y muerto = "C";  |Y obitus = 1;
      |SI periodo = 0;
          coefi1= 100*parte2; coefi11 = 1; zz = 50; tipod="T"; |HAZ leeliqui;
          coefi1= 100*parte1; coefi11 = 1; zz = 50; tipod="A"; |HAZ leeliqui;
      |SINO;
          |SI periodo = 1;
              zz = 100;
              coefi1 = 100; coefi11 = 1; tipod  = "A"; |HAZ leeliqui;
          |SINO;
              zz = 100;
              coefi1 = 100; coefi11 = 1; tipod  = "T"; |HAZ leeliqui;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;


  ||Si es Ganancial, individual Y SE MUERE EL;

  |SI tipod = "G";  |Y tippar = 2; |Y muerto = "T"; |Y obitus = 2;
      |SI periodo = 0;
          funeral = 1;
          coefi1=  50 * parte1; coefi11=.5; zz=  50; tipod = "T"; |HAZ leeliqui;
          coefi1= 100 - coefi1; coefi11= 1; zz=  50; tipod = "C"; |HAZ leeliqui;
      |SINO;
          |SI periodo = 1;
              coefi1  = 50;
              coefi11 = .5;
              zz = 50;
              tipod  = "T"; |HAZ leeliqui;
              tipod  = "C"; |HAZ leeliqui;
          |SINO;
              zz = 100; coefi11 = 1; coefi1 = 100; tipod  = "C"; |HAZ leeliqui;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;

  ||Si es Ganancial, individual Y SE MUERE ELLA;

 |SI tipod = "G"; |Y tippar = 2; |Y muerto = "C"; |Y obitus = 2;
      |SI periodo = 0;
          funeral = 1;
          coefi1=  50 * parte1;  coefi11=.5; zz= 50; tipod = "C"; |HAZ leeliqui;
          coefi1 = 100 - coefi1; coefi11= 1; zz= 50; tipod = "T"; |HAZ leeliqui;
      |SINO;
          |SI periodo = 1;
              coefi11 = .5;
              coefi1 = 50;
              zz = 50;
              tipod  = "T"; |HAZ leeliqui;
              tipod  = "C"; |HAZ leeliqui;
          |SINO;
              zz = 100; coefi11 = 1; coefi1 = 100;  tipod  = "T"; |HAZ leeliqui;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;

  |SI tipod ! "V";  |Y tippar = 1;      ||SI ES TITULAR O CONYUGE Y SE CASAN;
      |SI periodo = 0;
          coefi11 = 1;
          zz = 100;
          coefi1 =  100 * parte1;                |HAZ leeliqui;
          coefi1 =  100 * parte2;  tipod = "A";  |HAZ leeliqui;
      |SINO;
          |SI periodo = 1;
              coefi11 = 1;
              zz = 100;
              coefi1 = 100; |HAZ leeliqui;
          |SINO;
              coefi11 = 1;
              zz = 100;
              coefi1 = 100;  tipod = "A";  |HAZ leeliqui;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;

  |SI tipod ! "V";  |Y tippar = 3;      ||SI TITULAR O CONYUGE Y SE SEPARAN;
      |SI periodo = 0;
          coefi11 = 1;
          zz = 100;
          coefi1 =  100 * parte2;                |HAZ leeliqui;
          coefi1 =  100 * parte1;  tipod = "A";  |HAZ leeliqui;
      |SINO;
          |SI periodo = 1;
              coefi11 = 1;
              zz = 100;
              coefi1 = 100;  tipod = "A";  |HAZ leeliqui;
          |SINO;
              coefi11 = 1;
              zz = 100;
              coefi1 = 100;                |HAZ leeliqui;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;


  ||SI TITULAR O CONYUGE, conjunta Y SE MUERE UNO;
  |SI tipod ! "V";  |Y tippar = 2; |Y obitus = 1;
      |SI periodo = 0;
          coefi11 = 1;
          zz = 100;
          |SI muerto = "T"; |Y tipod = "T";
              coefi1 = 100;  tipod = "A";  |HAZ leeliqui;
          |SINO;
              |SI muerto = "C";  |Y tipod = "C";
                  coefi1 = 100;  tipod = "A";  |HAZ leeliqui;
              |SINO;
                  coefi1 =  100 * parte2;                |HAZ leeliqui;
                  coefi1 =  100 * parte1;  tipod = "A";  |HAZ leeliqui;
              |FINSI;
          |FINSI;
      |SINO;
          |SI periodo = 1;
              coefi11 = 1;
              zz = 100;
              coefi1 = 100;  tipod = "A";  |HAZ leeliqui;
          |SINO;
              coefi11 = 1;
              zz = 100;
              coefi1 = 100;                |HAZ leeliqui;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;

||SI TITULAR O CONYUGE, individual  Y SE MUERE UNO;

  |SI tipod ! "V"; |Y tippar = 2; |Y obitus = 2;
       coefi11 = 1;
       zz = 100;
       coefi1 = 100; |HAZ leeliqui;
      |ACABA;
  |FINSI;

  |SI tippar = 1;          ||VARIOS Y SE CASAN;
      |SI periodo = 0;
          |SI numero1 ! 0;
              zz = numero1;
              coefi11 = numero1 / 100;
              coefi1 =  numero1 * parte1;
              tipod = "T";
              |HAZ leeliqui;
          |FINSI;
          |SI numero2 ! 0;
              zz = numero2;
              coefi11 = numero2 / 100;
              coefi1 =  numero2 * parte1;
              tipod = "C";
              |HAZ leeliqui;
          |FINSI;
          zz = numero1 + numero2;
          coefi1 = ( numero1 + numero2 ) * parte2;
          coefi11 = ( numero1 + numero2 ) / 100;
          tipod = "A"; |HAZ leeliqui;
      |SINO;
          |SI periodo = 1;
             |SI numero1 ! 0;
                 zz = numero1;
                 coefi11 = numero1 / 100;
                 coefi1 = numero1;
                 tipod = "T";
                 |HAZ leeliqui;
             |FINSI;
             |SI numero2 ! 0;
                 zz = numero2;
                 coefi11 = numero2 / 100;
                 coefi1 = numero2;
                 tipod = "C";
                 |HAZ leeliqui;
             |FINSI;
          |SINO;
             zz = numero1 + numero2;
             coefi1 = numero1 + numero2;
             coefi11 = (numero1 + numero2) / 100;
             tipod = "A"; |HAZ leeliqui;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;

  |SI tippar = 3;          ||VARIOS Y SE SEPARAN;
      |SI periodo = 0;
          |SI numero1 ! 0;
              zz = numero1;
              coefi11 = numero1 / 100;
              coefi1 =  numero1 * parte2;
              tipod = "T";
              |HAZ leeliqui;
          |FINSI;
          |SI numero2 ! 0;
              zz = numero2;
              coefi11 = numero2 / 100;
              coefi1 =  numero2 * parte2;
              tipod = "C";
              |HAZ leeliqui;
          |FINSI;
          zz = numero1 + numero2;
          coefi1 = ( numero1 + numero2 ) * parte1;
          coefi11 = ( numero1 + numero2 ) / 100;
          tipod = "A"; |HAZ leeliqui;
      |SINO;
          |SI periodo = 1;
              zz = numero1 + numero2;
              coefi1 = numero1 + numero2;
              coefi11 = (numero1 + numero2) / 100;
              tipod = "A"; |HAZ leeliqui;
          |SINO;
              |SI numero1 ! 0;
                  zz = numero1;
                  coefi1 = numero1;
                  coefi11 = numero1 / 100;
                  tipod = "T";
                  |HAZ leeliqui;
              |FINSI;
              |SI numero2 ! 0;
                  zz = numero2;
                  coefi1 = numero2;
                  coefi11 = numero2 / 100;
                  tipod = "C";
                  |HAZ leeliqui;
              |FINSI;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;


  |SI tippar = 2;  |Y obitus = 1;     ||VARIOS, conjunta Y SE MUERE;
      |SI periodo = 0;
          |SI numero1 ! 0;
              zz = numero1;
              coefi11 = numero1 / 100;
              coefi1 =  numero1 * parte2;
              tipod = "T";
              |HAZ leeliqui;
          |FINSI;
          |SI numero2 ! 0;
              zz = numero2;
              coefi11 = numero2 / 100;
              coefi1 =  numero2 * parte2;
              tipod = "C";
              |HAZ leeliqui;
          |FINSI;
          zz = numero1 + numero2;
          coefi1 = ( numero1 + numero2 ) * parte1;
          coefi11 = ( numero1 + numero2 ) / 100;
          tipod = "A"; |HAZ leeliqui;
      |SINO;
          |SI periodo = 1;
              zz = numero1 + numero2;
              coefi1 = numero1 + numero2;
              coefi11 = (numero1 + numero2) / 100;
              tipod = "A"; |HAZ leeliqui;
          |SINO;
              |SI numero1 ! 0;
                  zz = numero1;
                  coefi1 = numero1;
                  coefi11 = numero1 / 100;
                  tipod = "T";
                  |HAZ leeliqui;
              |FINSI;
              |SI numero2 ! 0;
                  zz = numero2;
                  coefi1 = numero2;
                  coefi11 = numero2 / 100;
                  tipod = "C";
                  |HAZ leeliqui;
              |FINSI;
          |FINSI;
      |FINSI;
      |ACABA;
  |FINSI;

  |SI tippar = 2;  |Y obitus = 2;     ||VARIOS, individual Y SE MUERE ALGUIEN;
      |SI numero1 ! 0;
          zz = numero1;
          coefi1 =  numero1;
          coefi11 =  numero1 / 100;
          tipod = "T";
          |HAZ leeliqui;
      |FINSI;
      |SI numero2 ! 0;
          zz = numero2;
          coefi1 =  numero2;
          coefi11 =  numero2 / 100;
          tipod = "C";
          |HAZ leeliqui;
      |FINSI;
  |FINSI;
|FPRC;

|PROCESO leeliqui;                 || Lee la Liquidacion
#6#0 = empreac;
#6#141 = tipod;
|LIBERA #6; |LEE 110#6=;
FEstado = FSalida;
|SI FSalida ! 0;
   |DDEFECTO #6;
   #6#000 = empreac;
   #6#141 = tipod;
|FINSI;

|SI tipod = "V"; coefi2 = 100; |SINO; coefi2 = coefi1; |FINSI;

|SI sw_fich = 0; |HAZ grabafi0; |FINSI;
|SI sw_fich = 1; |HAZ grabafi1; |FINSI;
|SI sw_fich = 2; |HAZ grabafi2; |FINSI;
|SI sw_fich = 3; |HAZ grabafi3; |FINSI;
|SI sw_fich = 4; |HAZ grabafi4; |FINSI;

#6#213 = obitus;
|SI FEstado = 0; |GRABA 021#6a; |SINO; |GRABA 021#6n; |FINSI;

|SI agricola = 1; |Y sw_fich = 4;
    |ABRE #11;
    #11#0 = empreac;
    #11#1 = tipod;
    |LIBERA #11; |LEE 110#11=;
    FEstado = FSalida;
    |SI FSalida ! 0;
        |DDEFECTO #11;
        #11#000 = empreac;
        #11#001 = tipod;
    |FINSI;
    #11#201 = 1;
    |SI FEstado = 0; |GRABA 021#11a; |SINO; |GRABA 021#11n; |FINSI;
    |CIERRA #11;
|FINSI;
|FPRC;

|PROCESO grabafi0;
  pepe   = #0#16 % coefi1;  || Cambiado por Manolo
  #6#23 = #6#23 + pepe;
  #6#134 = #6#134 +  (#0#21 % coefi1);
|FPRC;

|PROCESO grabafi1;
  #6#14 = #6#14 + (#1#16 % coefi1);
  #6#15 = #6#15 + (#1#28 % coefi1);
  #6#133 = #6#133 + (#1#36 % coefi2);
  #6#137 = #6#137 + ((#1#29 + #1#30 + #1#31 + #1#32) % coefi2);
  |SI #6#141 = "T";
      #6#204 = #6#204 + (#1#28 % coefi1);
  |FINSI;
  |SI #6#141 = "C";
      #6#210 = #6#210 + (#1#28 % coefi1);
  |FINSI;
  |SI #6#141 = "A"; |Y #1#2 = "G";
      #6#204 = #6#204 + ((#1#28 % coefi1) / 2);
      #6#210 = #6#210 + ((#1#28 % coefi1) / 2);
  |FINSI;
  |SI #6#141 = "A"; |Y #1#2 = "T";
      #6#204 = #6#204 + (#1#28 % coefi1);
  |FINSI;
  |SI #6#141 = "A"; |Y #1#2 = "C";
      #6#210 = #6#210 + (#1#28 % coefi1);
  |FINSI;
  |SI #6#141 = "A"; |Y #1#2 = "V";
      #6#204 = #6#204 + (#1#28 % numero1);
      #6#210 = #6#210 + (#1#28 % numero2);
  |FINSI;
  #6#64 = #6#64 + ( #1#27 % coefi1);
|FPRC;

|PROCESO grabafi2;
  #6#16 = #6#16 + (#2#17 % coefi1);
  #6#17 = #6#17 + (#2#32 % coefi1);
  #6#133 = #6#133 + (#2#43 % coefi2);
  #6#137 = #6#137 + ((#2#33 + #2#34 + #2#35 + #2#36) % coefi2);
  |SI #6#141 = "T";
      #6#204 = #6#204 + (#2#32 % coefi1);
  |FINSI;
  |SI #6#141 = "C";
      #6#210 = #6#210 + (#2#32 % coefi1);
  |FINSI;
  |SI #6#141 = "A"; |Y #2#2 = "G";
      #6#204 = #6#204 + ((#2#32 % coefi1) / 2);
      #6#210 = #6#210 + ((#2#32 % coefi1) / 2);
  |FINSI;
  |SI #6#141 = "A"; |Y #2#2 = "T";
      #6#204 = #6#204 + (#2#32 % coefi1);
  |FINSI;
  |SI #6#141 = "A"; |Y #2#2 = "C";
      #6#210 = #6#210 + (#2#32 % coefi1);
  |FINSI;
  |SI #6#141 = "A"; |Y #2#2 = "V";
      #6#204 = #6#204 + (#2#32 % numero1);
      #6#210 = #6#210 + (#2#32 % numero2);
  |FINSI;
  #6#64 = #6#64 + (( #2#26 - #2#27 - #2#28) % coefi1);
|FPRC;

|PROCESO grabafi3;
  #6#18 = #6#18 + (#3#23 % coefi1);
  #6#19 = #6#19 + (#3#49 % coefi1);
  #6#137 = #6#137 + ((#3#50 + #3#51 + #3#52 + #3#53) % coefi2);
  |SI #6#141 = "T";
      #6#203 = #6#203 + (#3#49 % coefi1);
  |FINSI;
  |SI #6#141 = "C";
      #6#209 = #6#209 + (#3#49 % coefi1);
  |FINSI;
  |SI #6#141 = "A"; |Y #3#2 = "G";
      #6#203 = #6#203 + ((#3#49 % coefi1) / 2);
      #6#209 = #6#209 + ((#3#49 % coefi1) / 2);
  |FINSI;
  |SI #6#141 = "A"; |Y #3#2 = "T";
      #6#203 = #6#203 + (#3#49 % coefi1);
  |FINSI;
  |SI #6#141 = "A"; |Y #3#2 = "C";
      #6#209 = #6#209 + (#3#49 % coefi1);
  |FINSI;
  |SI #6#141 = "A"; |Y #3#2 = "V";
      #6#203 = #6#203 + (#3#49 % numero1);
      #6#209 = #6#209 + (#3#49 % numero2);
  |FINSI;
  #6#64 = #6#64 + ( #3#48 % coefi1 );
|FPRC;

|PROCESO grabafi4;
  #6#20 = #6#20 + (#4#17 % coefi1);
  #6#21 = #6#21 + (#4#32 % coefi1);
  #6#137 = #6#137 + ((#4#34 + #4#35 + #4#36 + #4#37) % coefi2);
  |SI #6#141 = "T";
      #6#203 = #6#203 + (#4#32 % coefi1);
  |FINSI;
  |SI #6#141 = "C";
      #6#209 = #6#209 + (#4#32 % coefi1);
  |FINSI;
  |SI #6#141 = "A"; |Y #4#2 = "G";
      #6#203 = #6#203 + ((#4#32 % coefi1) / 2);
      #6#209 = #6#209 + ((#4#32 % coefi1) / 2);
  |FINSI;
  |SI #6#141 = "A"; |Y #4#2 = "T";
      #6#203 = #6#203 + (#4#32 % coefi1);
  |FINSI;
  |SI #6#141 = "A"; |Y #4#2 = "C";
      #6#209 = #6#209 + (#4#32 % coefi1);
  |FINSI;
  |SI #6#141 = "A"; |Y #4#2 = "V";
      #6#203 = #6#203 + (#4#32 % numero1);
      #6#209 = #6#209 + (#4#32 % numero2);
  |FINSI;
  #6#64 = #6#64 + ((#4#26 - #4#27 - #4#28) % coefi1);
|FPRC;

|PROCESO calcuprop;
|ABRE #7;
#7#0 = empreac;
|LEE 040#7=;
|SI FSalida = 0;
    |SI tipoprop = "U";
        |SI tipod = "T"; anyos = #7#3;  |FINSI;
        |SI tipod = "C"; anyos = #7#30; |FINSI;
        |SI tipod = "1";
            |SI #7#98 ! 0; var = 67 + #7#98; anyos = #7var; |FINSI;
        |FINSI;
        |SI tipod = "2";
            |SI #7#99 ! 0; var = 67 + #7#99; anyos = #7var; |FINSI;
        |FINSI;
        |SI tipod = "3";
            |SI #7#100 ! 0; var = 67 + #7#100; anyos = #7var; |FINSI;
        |FINSI;
        |SI tipod = "4";
            |SI #7#101 ! 0; var = 67 + #7#101; anyos = #7var; |FINSI;
        |FINSI;
        |SI tipod = "G"; anyos = #7#3;  |FINSI;
        |SI tipod = "V"; anyos = #7#3;  |FINSI;
        anyos = 1994 - anyos;
    |SINO;
        anyos = anyou;
    |FINSI;
    |SI anyos [ 20; porce = 70; |FINSI;
    |SI anyos > 20;
        porce = 70 - (anyos - 20);
        |SI porce < 10; porce = 10; |FINSI;
    |FINSI;
    |SI tipoprop = "N"; porce = 100 - porce; |FINSI;
    cantidad1 = cantidad1 % porce;
|FINSI;
|CIERRA #7;
|FPRC;

|PROCESO grabapat;
|SI cantidad = 0; |ACABA; |FINSI;
|ABRE #8;
#8#0  = empreac;
#8#28 = tipod;
|LIBERA #8;
|LEE 110#8=;
FEstad1 = FSalida;
|SI FSalida ! 0; |DDEFECTO #8; #8#0 = empreac; #8#28 = tipod; |FINSI;
|SI tipop = "A1"; #8#1  = #8#1  + cantidad; |FINSI;
|SI tipop = "B1"; #8#2  = #8#2  + cantidad; |FINSI;
|SI tipop = "C1"; #8#3  = #8#3  + cantidad; |FINSI;
|SI tipop = "C2"; #8#3  = #8#3  + cantidad; |FINSI;
|SI tipop = "E1"; #8#5  = #8#5  + cantidad; |FINSI;
|SI tipop = "E2"; #8#6  = #8#6  + cantidad; |FINSI;
|SI tipop = "D1"; #8#4  = #8#4  + cantidad; |FINSI;
|SI tipop = "H1"; #8#10 = #8#10 + cantidad; |FINSI;
|SI FEstad1 = 0; |GRABA 020#8a; |SINO; |GRABA 020#8n; |FINSI;
|CIERRA #8;

#10#0 = empreac;
|LIBERA #10;
|LEE 101#10=;
|SI FSalida = 0;
    #10#30 = 1;
    |GRABA 020#10a;
|FINSI;
|FPRC;

|| **************************************************************************
                           PROCESO DE INCIDENCIAS
|| **************************************************************************

|PROCESO incidenci1;
|SI incisino = "S";
   |SI sw = 0; |HAZ grabacion; sw = 1; |FINSI;

   linea = "00" + linea;
   linea = linea % -102;

   rendi = "          " + rendi;
   rendi = rendi % -110;

   |QBF descri;
   descri = descri + blanco;
   descri = descri % 130;

   alfa1 = "NO CALCULO ->  " + linea + " " + descri + "    " + rendi;

   |SI tipore = "R";
       alfa1 = "RENTA ------>  " + linea + " " + descri + "    " + rendi;
   |FINSI;
   |SI tipore = "P";
       alfa1 = "PATRIMONIO ->  " + linea + " " + descri + "    " + rendi;
   |FINSI;
   |HAZ grabacion;
|FINSI;
|FPRC;

|PROCESO grabacion;
swcalcu = 1;
lininci = lininci + 5;
#5#0 = empreac;
#5#1 = lininci;
#5#2 = alfa1;
#5#3 = "S";
|GRABA 020#5n;
|LIBERA #5;
|FPRC;

|| **************************************************************************
||                             PROCESO BUCLES
|| **************************************************************************

|DEFBUCLE leefic0;   || Bucle Transparencias Fiscal
#0#1;
;
empresa, 01;
emprefi, 99;
e;
NULL, fichero0;
|FIN;

|DEFBUCLE leefic1;   || Bucle Profesional Directa
#1#1;
;
empresa, 01;
emprefi, 99;
e;
NULL, fichero1;
|FIN;

|DEFBUCLE leefic2;    || Bucle Profesional Coeficiente
#2#1;
;
empresa, 01;
emprefi, 99;
e;
NULL, fichero2;
|FIN;

|DEFBUCLE leefic3;    || Bucle Empresarial Directa
#3#1;
;
empresa, 01;
emprefi, 99;
e;
NULL, fichero3;
|FIN;

|DEFBUCLE leefic4;    || Bucle Empresarial Coeficiente
#4#1;
;
empresa, 01;
emprefi, 99;
e;
NULL, fichero4;
|FIN;


|| **************************************************************************
                              INICIO
|| **************************************************************************

|PROGRAMA;
  agricola = 0;
  |ABRE #10;
  |ABRE #5;
  |ABRE #6;
  |SI recalcu = 0; |O recalcu = 2;
      #10#0 = empresa;
      |LEE 040#10=;
      |SI FSalida = 0;
          |SI #10#6  = 1; sw = 0; lininci = 1500; |BUCLE leefic0; |FINSI;
          |SI #10#7  = 1; sw = 0; lininci = 1800; |BUCLE leefic1; |FINSI;
          |SI #10#8  = 1; sw = 0; lininci = 2100; |BUCLE leefic2; |FINSI;
          |SI #10#9  = 1; sw = 0; lininci = 2400; |BUCLE leefic3; |FINSI;
          |SI #10#10 = 1; sw = 0; lininci = 2700; |BUCLE leefic4; |FINSI;
     |FINSI;
  |SINO;
     sw = 0; lininci = 1500; |BUCLE leefic0;
     sw = 0; lininci = 1800; |BUCLE leefic1;
     sw = 0; lininci = 2100; |BUCLE leefic2;
     sw = 0; lininci = 2400; |BUCLE leefic3;
     sw = 0; lininci = 2700; |BUCLE leefic4;
  |FINSI;
  |CIERRA #5;
  |CIERRA #6;
  |CIERRA #10;

 |SI #10#11=1; |O #10#12=1; |O #10#13=1; |O #10#14=1; |O #10#15=1; |O recalcu=1;
     |CORRE "recalpa3.run";
     |ACABA;
 |FINSI;

 |SI #10#16=1; |O #10#17=1; |O #10#18=1; |O #10#19=1; |O #10#20=1; |O recalcu=1;
     |CORRE "recalpa4.run";
     |ACABA;
 |FINSI;

 |SI #10#21=1; |O #10#22=1; |O #10#23=1; |O #10#24=1; |O #10#25=1; |O recalcu=1;
     |CORRE "recalpa5.run";
     |ACABA;
 |FINSI;

 |SI #10#26=1; |O #10#27=1; |O #10#28=1; |O #10#29=1; |O recalcu=1;
     |CORRE "recalpa6.run";
     |ACABA;
 |FINSI;

|CORRE "recalpa8.run";
|FPRO;
