|FICHEROS;
    retotpat #0;

    rectacor #1;
    repatrim #4;

    refant23 #5;
    refant24 #6;
    repant50 #7;
    refant25 #8;
|FIN;

|VARIABLES;
   &empresa  = 0;
   &nombre   = "";
   &cif      = "";
   &impresor = "";
   &diainf   = "";
   &mesinf   = "";
   &anyoinf  = "";
   &tipo     = "";
   &cuenta   = "";
   &swdecl   = 0;
   &anyo1    = 0;
   &anyo2    = 0;
   &anyo3    = 0;
   &anyo4    = 0;
   &anyo5    = 0;
   &anyo6    = 0;
   &papel    = 0;
   &elnombre  = "";
   &apellidos = "";
   &vuelve    = 0;
   &seleccion = "";
   &campo     = 0;
   &chequeo   = 0;
   &fichero   = "";
   &p_cen     = 0;

   tipod     = "";
   clave     = "";
   tipoprop  = "";
   descr     = "";
   porce     = 0;
   anyou     = 0;
   anyos     = 0;

   informe   = "";

   var1      = 0;
   var2      = 0;
   var3      = 0;
   var4      = 0;
   var5      = 0;
   contag    = 0;
   contah    = 0;
   contai    = 0;
   contaj    = 0;
   contak    = 0;
   contal    = 0;
   contam    = 0;
   contan    = 0;
   contao    = 0;
   contau    = 0;
   coefi     = 0;
   canti     = 0;
|FIN;

|PROGRAMA;
vuelve = 1;
|SI papel = 2;
    |PINPA #0#7;
    #7#0 = empresa; |PINTA #7#0;
    #7#1 = nombre;  |PINTA #7#1;
|FINSI;

Impresora = impresor;
|IMPRE -1;
|SI FSalida = 0;
    |HAZ hoja6;
    |HAZ hoja7;
    |HAZ hoja8;
    |FINIMP;
    |CORRE "reemi714.run";
|FINSI;
|FPRO;

|| *************************************************************************
||                         IMPRESION HOJA 6
|| *************************************************************************

|| *********************** De afectos a patrimonio g **********************

|PROCESO cargag;
contag = contag + 1;
var1 = contag - 1;  var2 = var1 + 15;

|SI contag [ 15;
    #5var1 = #4#5;
    #5var2 = #4#9  % coefi;
|SINO;
    #5#14  = "Seg£n relaci¢n adjunta";
    #5#29  = #5#29 + (#4#9  % coefi);
|FINSI;
|FPRC;

|PROCESO leeg;
coefi = 100;
|SI #4#9 = 0; |ACABA; |FINSI;

|SI #4#3 = "G";
    |SI tipo = "T"; coefi = 50; |HAZ cargag; |ACABA; |FINSI;
    |SI tipo = "C"; coefi = 50; |HAZ cargag; |ACABA; |FINSI;
|SINO;
    |SI tipo = #4#3; |HAZ cargag; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE repatrig;
 #4#1;
 ;
 empresa, "G1", 001;
 empresa, "G1", 999;
 e;
 NULL, leeg;
|FIN;

|| ***************** Cuentas corrientes (para el h) **********************

|PROCESO calcuprop;
|SI tipoprop = "U";
    |SI tipod = "T"; anyos = anyo1;  |FINSI;
    |SI tipod = "C"; anyos = anyo2;  |FINSI;
    |SI tipod = "1"; anyos = anyo3;  |FINSI;
    |SI tipod = "2"; anyos = anyo4;  |FINSI;
    |SI tipod = "3"; anyos = anyo5;  |FINSI;
    |SI tipod = "4"; anyos = anyo6;  |FINSI;
    |SI tipod = "G"; anyos = anyo1;  |FINSI;
    |SI tipod = "V"; anyos = anyo1;  |FINSI;
    anyos = 1994 - anyos;
|SINO;
    anyos = anyou;
|FINSI;

|SI anyos [ 20; porce = 70; |FINSI;

|SI anyos > 20;
    porce = 70 - (anyos - 20);
    |SI porce < 10; porce = 10; |FINSI;
|FINSI;

|SI tipoprop = "N"; porce = 100 - porce; |FINSI;

canti = canti % porce;
|FPRC;

|PROCESO cargacta;
contah = contah + 1;
var1 = contah + 30;  var2 = var1 + 11;  var3 = var2 + 11;  var4 = var3 + 11;

|SI #1#13 = "RV"; clave = "V"; |SINO; clave = "T"; |FINSI;

|SI contah [ 11;
    #5var1 = #1#14;
    #5var2 = clave;
    #5var3 = (#1#17 + #1#18) % coefi;
    #5var4 = canti % coefi;
|SINO;
    #5#41  = "Seg£n relaci¢n adjunta";
    #5#52  = "";
    #5#63  = #5#63 + ((#1#17 + #1#18) % coefi);
    #5#74  = #5#74 + (canti % coefi);
|FINSI;
|FPRC;

|PROCESO adonde1;
|SI coefi = 0; |ACABA; |FINSI;
|SI #1#29 = "H1";
    |SI #1#13 = "RV"; |O #1#13 = "RT";
        |HAZ cargacta;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO leecta;
|SI #1#4  = "X"; |O #1#4 = "R"; |ACABA; |FINSI;

tipoprop = #1#5;
tipod = #1#2;
descr = #1#14;

canti = #1#19;
|SI canti < #1#20; canti = #1#20; |FINSI;
|SI canti = 0; |ACABA; |FINSI;

|SI #1#5 ! "P"; anyou = #1#6; |HAZ calcuprop; |FINSI;

|SI tipo = "T";
   |SI #1#2 = "G"; coefi = 50;    |HAZ adonde1; |ACABA; |FINSI;
   |SI #1#2 = "T"; coefi = 100;   |HAZ adonde1; |ACABA; |FINSI;
   |SI #1#2 = "V"; coefi = #1#7;  |HAZ adonde1; |ACABA; |FINSI;
|FINSI;

|SI tipo = "C";
   |SI #1#2 = "G"; coefi = 50;    |HAZ adonde1; |ACABA; |FINSI;
   |SI #1#2 = "C"; coefi = 100;   |HAZ adonde1; |ACABA; |FINSI;
   |SI #1#2 = "V"; coefi = #1#8;  |HAZ adonde1; |ACABA; |FINSI;
|FINSI;

|SI tipo = "1";
   |SI #1#2 = "1"; coefi = 100;   |HAZ adonde1; |ACABA; |FINSI;
   |SI #1#2 = "V"; coefi = #1#9;  |HAZ adonde1; |ACABA; |FINSI;
|FINSI;

|SI tipo = "2";
   |SI #1#2 = "2"; coefi = 100;   |HAZ adonde1; |ACABA; |FINSI;
   |SI #1#2 = "V"; coefi = #1#10; |HAZ adonde1; |ACABA; |FINSI;
|FINSI;

|SI tipo = "3";
   |SI #1#2 = "3"; coefi = 100;   |HAZ adonde1; |ACABA; |FINSI;
   |SI #1#2 = "V"; coefi = #1#11; |HAZ adonde1; |ACABA; |FINSI;
|FINSI;

|SI tipo = "4";
   |SI #1#2 = "4"; coefi = 100;   |HAZ adonde1; |ACABA; |FINSI;
   |SI #1#2 = "V"; coefi = #1#12; |HAZ adonde1; |ACABA; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE rectacor;
 #1#1;
 ;
 empresa, 01;
 empresa, 99;
 e;
 NULL, leecta;
|FIN;

|| *********************** De afectos a patrimonio h **********************

|PROCESO cargah;
contah = contah + 1;
var1 = contah + 30;  var2 = var1 + 11;  var3 = var2 + 11;  var4 = var3 + 11;

|SI contah [ 11;
    #5var1 = #4#5;
    #5var2 = #4#15;
    #5var3 = #4#13 % coefi;
    #5var4 = #4#9 % coefi;
|SINO;
    #5#41  = "Seg£n relaci¢n adjunta";
    #5#52  = "";
    #5#63  = #5#63 + (#4#13 % coefi);
    #5#74  = #5#74 + (#4#9 % coefi);
|FINSI;
|FPRC;

|PROCESO leeh;
coefi = 100;
|SI #4#9 = 0; |ACABA; |FINSI;
|SI #4#3 = "G";
    |SI tipo = "T"; coefi = 50; |HAZ cargah; |ACABA; |FINSI;
    |SI tipo = "C"; coefi = 50; |HAZ cargah; |ACABA; |FINSI;
|SINO;
    |SI tipo = #4#3; |HAZ cargah; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE repatrih;
 #4#1;
 ;
 empresa, "H1", 001;
 empresa, "H1", 999;
 e;
 NULL, leeh;
|FIN;

|| *********************** De afectos a patrimonio i **********************

|PROCESO cargai;
contai = contai + 1;
var1 = contai + 75;  var2 = var1 + 11;

|SI contai [ 11;
    #5var1 = #4#5;
    #5var2 = #4#9  % coefi;
|SINO;
    #5#86  = "Seg£n relaci¢n adjunta";
    #5#97  = #5#97 + (#4#9  % coefi);
|FINSI;
|FPRC;

|PROCESO leei;
coefi = 100;
|SI #4#9 = 0; |ACABA; |FINSI;

|SI #4#3 = "G";
    |SI tipo = "T"; coefi = 50; |HAZ cargai; |ACABA; |FINSI;
    |SI tipo = "C"; coefi = 50; |HAZ cargai; |ACABA; |FINSI;
|SINO;
    |SI tipo = #4#3; |HAZ cargai; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE repatrii;
 #4#1;
 ;
 empresa, "I1", 001;
 empresa, "I1", 999;
 e;
 NULL, leei;
|FIN;

|PROCESO hoja6;
|DDEFECTO #5;
                 |BUCLE rectacor;
    contah = 0;  |BUCLE repatrih;
    contag = 0;  |BUCLE repatrig;
    contai = 0;  |BUCLE repatrii;

|ABRE #0;
    #0#0  = empresa;
    #0#28 = tipo;
|LEE 040#0=;
|SI FSalida ! 0; |DDEFECTO #0; |FINSI;
|CIERRA #0;

    #5#30 = #0#9;        || total g
    #5#75 = #0#10;       || total h
    #5#98 = #0#11;       || total i

|SI papel = 1;
    informe = "reho7146"; |HAZ continuo;
|SINO;
    informe = "rema7146"; |HAZ manual;
|FINSI;
|FPRC;

|| *************************************************************************
||                         IMPRESION HOJA 7
|| *************************************************************************

|| *********************** De afectos a patrimonio j **********************
|PROCESO cargaj;
contaj = contaj + 1;
var1 = contaj - 1;  var2 = var1 + 8;

|SI contaj [ 8;
    #6var1 = #4#5;
    #6var2 = #4#9  % coefi;
|SINO;
    #6#7  = "Seg£n relaci¢n adjunta";
    #6#15 = #6#15 + (#4#9  % coefi);
|FINSI;
|FPRC;

|PROCESO leej;
coefi = 100;
|SI #4#9 = 0; |ACABA; |FINSI;

|SI #4#3 = "G";
    |SI tipo = "T"; coefi = 50; |HAZ cargaj; |ACABA; |FINSI;
    |SI tipo = "C"; coefi = 50; |HAZ cargaj; |ACABA; |FINSI;
|SINO;
    |SI tipo = #4#3; |HAZ cargaj; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE repatrij;
 #4#1;
 ;
 empresa, "J1", 001;
 empresa, "J1", 999;
 e;
 NULL, leej;
|FIN;

|| *********************** De afectos a patrimonio K **********************

|PROCESO cargak;
contak = contak + 1;
var1 = contak + 16; var2 = var1  + 8; var3 = var2  + 8;
var4 = var3   + 8;  var5 = var4  + 8;

|SI contak [ 7;
    #6var1 = #4#15;
    #6var2 = #4#16;
    #6var3 = #4#14;
    #6var4 = #4#13 % coefi;
    #6var5 = #4#9  % coefi;
|SINO;
    #6#24  = "";
    #6#32  = "Seg£n relaci¢n adjunta";
    #6#40  = "";
    #6#48  = #6#48 + (#4#13 % coefi);
    #6#56  = #6#56 + (#4#9  % coefi);
|FINSI;
|FPRC;

|PROCESO leek;
|SI #4#9 = 0; |ACABA; |FINSI;
coefi = 100;

|SI #4#3 = "G";
    |SI tipo = "T"; coefi = 50; |HAZ cargak; |ACABA; |FINSI;
    |SI tipo = "C"; coefi = 50; |HAZ cargak; |ACABA; |FINSI;
|SINO;
    |SI tipo = #4#3; |HAZ cargak; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE repatrik;
 #4#1;
 ;
 empresa, "K1", 001;
 empresa, "K1", 999;
 e;
 NULL, leek;
|FIN;

|| *********************** De afectos a patrimonio L **********************

|PROCESO cargal;
contal = contal + 1;
var1 = contal + 57;  var2 = var1 + 8;

|SI contal [ 8;
    #6var1 = #4#5;
    #6var2 = #4#9  % coefi;
|SINO;
    #6#65  = "Seg£n relaci¢n adjunta";
    #6#73  = #6#73 + (#4#9  % coefi);
|FINSI;
|FPRC;

|PROCESO leel;
|SI #4#9 = 0; |ACABA; |FINSI;
coefi = 100;

|SI #4#3 = "G";
    |SI tipo = "T"; coefi = 50; |HAZ cargal; |ACABA; |FINSI;
    |SI tipo = "C"; coefi = 50; |HAZ cargal; |ACABA; |FINSI;
|SINO;
    |SI tipo = #4#3; |HAZ cargal; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE repatril;
 #4#1;
 ;
 empresa, "L1", 001;
 empresa, "L1", 999;
 e;
 NULL, leel;
|FIN;

|| *********************** De afectos a patrimonio m **********************

|PROCESO cargam;
contam = contam + 1;
var1 = contam + 74;  var2 = var1  + 8;

|SI contam [ 8;
    #6var1 = #4#5;
    #6var2 = #4#9  % coefi;
|SINO;
    #6#82  = "Seg£n relaci¢n adjunta";
    #6#90  = #6#90 + (#4#9  % coefi);
|FINSI;
|FPRC;

|PROCESO leem;
|SI #4#9 = 0; |ACABA; |FINSI;
coefi = 100;

|SI #4#3 = "G";
    |SI tipo = "T"; coefi = 50; |HAZ cargam; |ACABA; |FINSI;
    |SI tipo = "C"; coefi = 50; |HAZ cargam; |ACABA; |FINSI;
|SINO;
    |SI tipo = #4#3; |HAZ cargam; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE repatrim;
 #4#1;
 ;
 empresa, "M1", 001;
 empresa, "M1", 999;
 e;
 NULL, leem;
|FIN;

|PROCESO hoja7;
|DDEFECTO #6;

contaj = 0; |BUCLE repatrij;
contak = 0; |BUCLE repatrik;
contal = 0; |BUCLE repatril;
contam = 0; |BUCLE repatrim;

    #6#16 = #0#12;       || total j
    #6#57 = #0#13;       || total k
    #6#74 = #0#14;       || total l
    #6#91 = #0#15;       || total m

|SI papel = 1;
    informe = "reho7147"; |HAZ continuo;
|SINO;
    informe = "rema7147"; |HAZ manual;
|FINSI;
|FPRC;

|| *************************************************************************
||                         IMPRESION HOJA 8
|| *************************************************************************

|| *********************** De afectos a patrimonio n **********************
|PROCESO cargan;
contan = contan + 1;
var1 = contan - 1;  var2 = var1 + 8;

|SI contan [ 8;
    #8var1 = #4#5;
    #8var2 = #4#9  % coefi;
|SINO;
    #8#7  = "Seg£n relaci¢n adjunta";
    #8#15 = #8#15 + (#4#9  % coefi);
|FINSI;
|FPRC;

|PROCESO leen;
|SI #4#9 = 0; |ACABA; |FINSI;
coefi = 100;

|SI #4#3 = "G";
    |SI tipo = "T"; coefi = 50; |HAZ cargan; |ACABA; |FINSI;
    |SI tipo = "C"; coefi = 50; |HAZ cargan; |ACABA; |FINSI;
|SINO;
    |SI tipo = #4#3; |HAZ cargan; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE repatrin;
 #4#1;
 ;
 empresa, "N1", 001;
 empresa, "N1", 999;
 e;
 NULL, leen;
|FIN;

|| *********************** De afectos a patrimonio O **********************

|PROCESO cargao;
contao = contao + 1;
var1 = contao + 16; var2 = var1 + 9;

|SI contao [ 9;
    #8var1 = #4#5;
    #8var2 = #4#9  % coefi;
|SINO;
    #8#25  = "Seg£n relaci¢n adjunta";
    #8#34  = #8#34 + (#4#9  % coefi);
|FINSI;
|FPRC;

|PROCESO leeo;
|SI #4#9 = 0; |ACABA; |FINSI;
coefi = 100;

|SI #4#3 = "G";
    |SI tipo = "T"; coefi = 50; |HAZ cargao; |ACABA; |FINSI;
    |SI tipo = "C"; coefi = 50; |HAZ cargao; |ACABA; |FINSI;
|SINO;
    |SI tipo = #4#3; |HAZ cargao; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE repatrio;
 #4#1;
 ;
 empresa, "O1", 001;
 empresa, "O1", 999;
 e;
 NULL, leeo;
|FIN;

|| *********************** De afectos a patrimonio U **********************

|PROCESO cargau;
contau = contau + 1;
var1 = contau + 35;  var2 = var1 + 17;

|SI contau [ 12;
    #8var1 = #4#5;
    #8var2 = #4#9  % coefi;
|SINO;
    #8#47  = "Seg£n relaci¢n adjunta";
    #8#64  = #8#64 + (#4#9  % coefi);
|FINSI;
|FPRC;

|PROCESO leeu;
|SI #4#9 = 0; |ACABA; |FINSI;
coefi = 100;

|SI #4#3 = "G";
    |SI tipo = "T"; coefi = 50; |HAZ cargau; |ACABA; |FINSI;
    |SI tipo = "C"; coefi = 50; |HAZ cargau; |ACABA; |FINSI;
|SINO;
    |SI tipo = #4#3; |HAZ cargau; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE repatriu;
 #4#1;
 ;
 empresa, "U1", 001;
 empresa, "U1", 999;
 e;
 NULL, leeu;
|FIN;

|PROCESO hoja8;
|DDEFECTO #8;

contan = 0; |BUCLE repatrin;
contao = 0; |BUCLE repatrio;
contau = 0; |BUCLE repatriu;

    #8#16 = #0#16;       || total n
    #8#35 = #0#17;       || total o
    #8#70 = #0#19;       || total deudas
    #8#71 = #0#18;       || total bienes y derechos

|SI papel = 1;
    informe = "reho714a"; |HAZ continuo;
|SINO;
    informe = "rema714a"; |HAZ manual;
|FINSI;
|FPRC;
____________________________________/ RUTINAS DE IMPRESION
|PROCESO continuo;
|INFOR informe;
|SI FSalida = 0;
    |PRINT; |PIEINF; |FININF;
|FINSI;
|FPRC;

|PROCESO manual;
|ET comienzo;
    |SI informe = "rema7146";
        #7#2 = "COLOQUE PAGINA 6 DEL PATRIMONIO, <INTRO PARA IMPRIMIR>";
    |FINSI;
    |SI informe = "rema7147";
        #7#2 = "COLOQUE PAGINA 7 DEL PATRIMONIO, <INTRO PARA IMPRIMIR>";
    |FINSI;
    |SI informe = "rema714a";
        #7#2 = "COLOQUE PAGINA 8 DEL PATRIMONIO, <INTRO PARA IMPRIMIR>";
    |FINSI;

    |ATRI P; |PINTA #7#2; |ATRI 0;
    |PAUSA;

    |INFOR informe;
    |SI FSalida = 0;
        |PRINT; |PIEINF; |FININF;
    |FINSI;

    |CONFI "2400NDesea repetir la hoja : ";
    |SI FSalida = 0; |VETE comienzo; |FINSI;
|FPRC;
