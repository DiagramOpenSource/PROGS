|FICHEROS;
    reinfimp #0;
    redatcon #1;
    reconhis #2;
    refant19 #3;
    reliquid #4;
    reacceso #5;
|FIN;

|VARIABLES;
    swinf     = 0;
    swestar   = 0;
    facturada = "";
    x         = 0;
    FEstado = 0;
    porcen = 0;
    para1 = 0;
    xxx   = 0;
    d_clien = 0;
    h_clien = 0;
|FIN;

|PROCESO parrilla; |TIPO 0;
|SI #0#18 = "N";
    |PARA xxx = 19; |SI xxx [ 36; |HACIENDO xxx = xxx + 1;
          #0xxx = 0; |PINTA #0xxx;
    |SIGUE;
    |CAMPO_MODIFICA #0#19, 1, "N";  |CAMPO_MODIFICA #0#20, 1, "N";
    |CAMPO_MODIFICA #0#21, 1, "N";  |CAMPO_MODIFICA #0#22, 1, "N";
    |CAMPO_MODIFICA #0#23, 1, "N";  |CAMPO_MODIFICA #0#24, 1, "N";
    |CAMPO_MODIFICA #0#25, 1, "N";  |CAMPO_MODIFICA #0#26, 1, "N";
    |CAMPO_MODIFICA #0#27, 1, "N";  |CAMPO_MODIFICA #0#28, 1, "N";
    |CAMPO_MODIFICA #0#29, 1, "N";  |CAMPO_MODIFICA #0#30, 1, "N";
    |CAMPO_MODIFICA #0#31, 1, "N";  |CAMPO_MODIFICA #0#32, 1, "N";
    |CAMPO_MODIFICA #0#33, 1, "N";  |CAMPO_MODIFICA #0#34, 1, "N";
    |CAMPO_MODIFICA #0#35, 1, "N";  |CAMPO_MODIFICA #0#36, 1, "N";
    |CAMPO_MODIFICA #0#00, 1, "S";  |CAMPO_MODIFICA #0#01, 1, "S";
|SINO;
    #0#0 = 1;     |PINTA #0#0;
    #0#1 = 99999; |PINTA #0#1;
    |CAMPO_MODIFICA #0#19, 1, "S";  |CAMPO_MODIFICA #0#20, 1, "S";
    |CAMPO_MODIFICA #0#21, 1, "S";  |CAMPO_MODIFICA #0#22, 1, "S";
    |CAMPO_MODIFICA #0#23, 1, "S";  |CAMPO_MODIFICA #0#24, 1, "S";
    |CAMPO_MODIFICA #0#25, 1, "S";  |CAMPO_MODIFICA #0#26, 1, "S";
    |CAMPO_MODIFICA #0#27, 1, "S";  |CAMPO_MODIFICA #0#28, 1, "S";
    |CAMPO_MODIFICA #0#29, 1, "S";  |CAMPO_MODIFICA #0#30, 1, "S";
    |CAMPO_MODIFICA #0#31, 1, "S";  |CAMPO_MODIFICA #0#32, 1, "S";
    |CAMPO_MODIFICA #0#33, 1, "S";  |CAMPO_MODIFICA #0#34, 1, "S";
    |CAMPO_MODIFICA #0#35, 1, "S";  |CAMPO_MODIFICA #0#36, 1, "S";
    |CAMPO_MODIFICA #0#00, 1, "N";  |CAMPO_MODIFICA #0#01, 1, "N";
|FINSI;
|FPRC;

|PROCESO cargafan;
|DDEFECTO #4;
|ABRE #4;
    #4#0 = #1#0;
|LEE 001#4=;
|CIERRA #4;

|DDEFECTO #5;
|ABRE #5;
    #5#0 = #1#0;
|LEE 001#5=;
|CIERRA #5;
|FPRC;

|PROCESO impresio;
|HAZ cargafan;

|SI #0#2 ! "T";               || simplificadas
        swestar = 0;
    |PARA x = 103; |SI x [ 109; |HACIENDO x = x + 1;
        |SI #1x = "S"; |O #1x = "A";  swestar = 1;  |FINSI;
    |SIGUE;
    |SI #0#2 = "S"; |Y swestar = 0; |ACABA; |FINSI;
    |SI #0#2 = "N"; |Y swestar = 1; |ACABA; |FINSI;
|FINSI;

|SI #0#3 ! "T";               || ordinarias
        swestar = 0;
    |PARA x = 103; |SI x [ 109; |HACIENDO x = x + 1;
        |SI #1x = "O"; |O #1x = "o"; swestar = 1; |FINSI;
    |SIGUE;
    |SI #0#3 = "S"; |Y swestar = 0; |ACABA; |FINSI;
    |SI #0#3 = "N"; |Y swestar = 1; |ACABA; |FINSI;
|FINSI;

|SI #0#4 ! "T";               || patrimonio
        swestar = 0;
    |PARA x = 194; |SI x [ 197; |HACIENDO x = x + 1;
        |SI #1x = "S"; swestar = 1; |FINSI;
    |SIGUE;
    |SI #1#140 = "S"; swestar = 1; |FINSI;
    |SI #1#141 = "S"; swestar = 1; |FINSI;

    |SI #0#4 = "S"; |Y swestar = 0; |ACABA; |FINSI;
    |SI #0#4 = "N"; |Y swestar = 1; |ACABA; |FINSI;
|FINSI;

|SI #0#5 ! "T";               || calculadas
    |SI #1#191 = "N"; |Y #0#5 = "S"; |ACABA; |FINSI;
    |SI #1#191 = "S"; |Y #0#5 = "N"; |ACABA; |FINSI;
|FINSI;

|SI #0#6 ! "T";               || 2do.plazo
        swestar = 0;
    |PARA x = 110; |SI x [ 116; |HACIENDO x = x + 1;
        |SI #1x = "S"; swestar = 1; |FINSI;
    |SIGUE;
    |SI #0#6 = "S"; |Y swestar = 0; |ACABA; |FINSI;
    |SI #0#6 = "N"; |Y swestar = 1; |ACABA; |FINSI;
|FINSI;

|SI #0#7 ! "T";               || impresas renta
        swestar = 0;
    |PARA x = 124; |SI x [ 130; |HACIENDO x = x + 1;
        |SI #1x = "S"; swestar = 1; |FINSI;
    |SIGUE;
    |SI #0#7 = "S"; |Y swestar = 0; |ACABA; |FINSI;
    |SI #0#7 = "N"; |Y swestar = 1; |ACABA; |FINSI;
|FINSI;

|SI #0#8 ! "T";               || impresas 2do. plazo
        swestar = 0;
    |PARA x = 131; |SI x [ 137; |HACIENDO x = x + 1;
        |SI #1x = "S"; swestar = 1; |FINSI;
    |SIGUE;
    |SI #0#8 = "S"; |Y swestar = 0; |ACABA; |FINSI;
    |SI #0#8 = "N"; |Y swestar = 1; |ACABA; |FINSI;
|FINSI;

|SI #0#9 ! "T";               || impresas patrimonio
        swestar = 0;
    |PARA x = 198; |SI x [ 201; |HACIENDO x = x + 1;
        |SI #1x = "S"; swestar = 1; |FINSI;
    |SIGUE;
    |SI #1#138 = "S"; swestar = 1; |FINSI;
    |SI #1#139 = "S"; swestar = 1; |FINSI;

    |SI #0#9 = "S"; |Y swestar = 0; |ACABA; |FINSI;
    |SI #0#9 = "N"; |Y swestar = 1; |ACABA; |FINSI;
|FINSI;

    facturada = "";
    #2#0 = #1#0;
|LEE 000#2=;                  || facturadas
    swestar = FSalida;
|SI swestar = 0; |Y #0#10 = "N"; |ACABA; |FINSI;
|SI swestar ! 0; |Y #0#10 = "S"; |ACABA; |FINSI;
|SI swestar = 0; facturada = "S"; |FINSI;

|SI #0#16 ! "T";              || plazos
    |PARA para1 = 15; |SI para1 [ 21; |HACIENDO para1 = para1 + 1;
            x = para1 - 7;                   || campo importe
        |SI #4para1 ! "S";|Y #4para1 ! "s";|Y #0#16 = "2";
                #4x = 0;                     || elimina los no fraccionados
        |SINO;
            |SI #4para1 ! "N";
                |SI #0#16 = "1";  porcen = 60;   |FINSI;   || calcula importes
                |SI #0#16 = "2";  porcen = 40;   |FINSI;
                    #4x = #4x % porcen;
            |FINSI;
        |FINSI;
    |SIGUE;
|FINSI;

|SI #0#15 ! "T";              || resultado
    |PARA x = 8;  |SI x [ 14; |HACIENDO x = x + 1;          || rentas
        |SI #4x < 0;|Y #0#15 = "P";  #4x = 0;  |FINSI;
        |SI #4x > 0;|Y #0#15 = "D";  #4x = 0;  |FINSI;
    |SIGUE;
    |PARA x = 35; |SI x [ 40; |HACIENDO x = x + 1;          || patrimonio
        |SI #4x < 0;|Y #0#15 = "P";  #4x = 0;  |FINSI;
        |SI #4x > 0;|Y #0#15 = "D";  #4x = 0;  |FINSI;
    |SIGUE;
|FINSI;

|PARA para1 = 1; |SI para1 [ 7; |HACIENDO para1 = para1 + 1;
        x = para1 + 7;
    |SI #4para1 ! "S";|Y #4para1 ! "O";|Y #4para1 ! "o"; |Y #4para1 ! "A";
            #4x = 0;
    |FINSI;                             || las que no se confeccionan
|SIGUE;

    swestar = 0;
|PARA x =  8; |SI x [ 14; |HACIENDO x = x + 1;
    |SI #4x ! 0;  swestar = 1;  |FINSI;
|SIGUE;
|PARA x = 35; |SI x [ 40; |HACIENDO x = x + 1;
    |SI #4x ! 0;  swestar = 1;  |FINSI;
|SIGUE;

|SI swestar = 1;         || si alguna tiene valor se imprime, sino no
    |PRINT;
        swinf = 1;
|FINSI;
|FPRC;

|CALCULO ordena;
|DDEFECTO #5;
|ABRE #5;
    #5#0 = #1#0;
|LEE 000#5=;
|CIERRA #5;
|FCAL;

|DEFBUCLE redatcon2;
 #1#1;
 102;
 d_clien, #0#12;
 h_clien, #0#13;
 e;
 NULL, ordena, NULL, NULL, NULL, impresio;
 #5#1, #5#0;
|FIN;

|DEFBUCLE redatcon1;
 #1#1;
 102;
 d_clien, #0#12;
 h_clien, #0#13;
 e;
 NULL, impresio;
|FIN;

|PROCESO impre; |TIPO 3;
|IMPRE 0;
|SI FSalida ! 0; |ACABA; |FINSI;

|INFOR "reinfimp";
|SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;

|ABRE #2;

|SI #0#18 = "N";
    d_clien = #0#0;
    h_clien = #0#1;
    |SI #0#17 = 1;  |BUCLE redatcon1;  |FINSI;
    |SI #0#17 = 2;  |BUCLE redatcon2;  |FINSI;
|SINO;
    |PARA xxx = 19; |SI xxx [ 36; |HACIENDO xxx = xxx + 1;
          |SI #0xxx ! 0;
              d_clien = #0xxx;
              h_clien = #0xxx;
              |SI #0#17 = 1;  |BUCLE redatcon1;  |FINSI;
              |SI #0#17 = 2;  |BUCLE redatcon2;  |FINSI;
          |FINSI;
    |SIGUE;
|FINSI;

|SI swinf = 1; |PIEINF; |FINSI;
|CIERRA #2;

|FININF;
|FINIMP;
|FPRC;

|CALCULO noentres; |TIPO 7;
|SI #0#15 = "D";
    |CAMPO_MODIFICA #0#16, 1, "N";
|SINO;
    |CAMPO_MODIFICA #0#16, 1, "S";
|FINSI;
|FCAL;
