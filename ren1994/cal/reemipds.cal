|FICHEROS
   reemipds #0;
   redatcon #1;
   rehacien #2;
   rerenpre #3;
   repoblac #4;
   retotren #5;
   repant50 #6;
   refant18 #7;
   repartid #8;
   reemisio #9;
   recofisc #10;
|FIN;

|VARIABLES;
   &empresa  = 0;
   &nombre   = "";
   &nombrec  = "";
   &cif      = "";
   &cifc     = "";
   &anyos    = "";
   &anyosc   = "";
   &impresor = "";
   &diainf   = "";
   &mesinf   = "";
   &anyoinf  = "";
   &tipo     = "";
   &diad     = "   ";
   &mesd     = "   ";
   &diah     = "   ";
   &mesh     = "   ";
   &famili   = 0;
   &swdecl   = 0;
   &cuenta   = "";
   &fraccion = "";
   &ingreso  = 0;
   &renuncia = "";
   &papel    = 0;
   &sw_al60  = 0;
   &tippar   = 0;
   &parte1   = 0;
   &parte2   = 0;
   &muerto   = "";
   &fecpar   = @;
   &vuelve    = 0;
   &seleccion = "";
   &chequeo   = 0;
   &hoja1     = "";
   &hoja2     = "";
   &hoja3     = "";
   &hoja4     = "";
   &hoja5     = "";
   &hoja6     = "";

   informe   = "";
   x         = 0;
   n         = "N";
   sw_impre  = 0;
   var       = 0;
   pepe      = 0;
   juan      = 0;
   uno       = 0;
   dos       = 0;
   esnif     = 0;
   menif     = 0;
   esnombre  = 0;
   menombre  = 0;
   esparent  = 0;
   meparent  = 0;
   esnacimi  = 0;
   menacimi  = 0;
   nombrefa  = "";
   esanyo    = 0;
   feini     = @;
   fefin     = @;
   fechad    = @;
   fechah    = @;
   dias      = 0;
   esde      = 0;

   {-1} hojas = "";
        hojas1 = "2400";
        hojas2 = "1";
        hojas3 = "Elija impresion : ";
        hojas4 = "CH";
        hojas5 = "  papel Continuo  ";
        hojas6 = "  papel Hoja a hoja  ";

|FIN;

|INCLUYE i_ficher;


|| **************************************************************************
||                           PROCESOS DEL PROGRAMA
|| **************************************************************************

|PROCESO empresa; |TIPO 0;
|ABRE #1;
#1#0 = #0#0;
|LEE 040#1=;
|SI FSalida ! 0;  |MENAV "     No existe empresa";            |ERROR; |ACABA; |FINSI;
|SI #1#142 = "N"; |MENAV "     La empresa no esta calculada"; |ERROR; |ACABA; |FINSI;
|SI #1#143 = "N"; |MENAV "     La empresa no es partida";     |ERROR; |ACABA; |FINSI;
#0#1 = #1#1;
|PINTA #0#1;
|CIERRA #1;
|FPRC;

|| **************************************************************************
||                           PROCESOS DE LA IMPRESION
|| **************************************************************************

|PROGRAMA;
|SI vuelve = 0;
    comienza = "XX";
    |HAZ fichero;
    |NOME_DAT #9 fichero;
    |ABRE #9; |CIERRA #9; |DELINDEX #9;

    comienza = "SP";
    |HAZ fichero;
    |NOME_DAT #0 fichero;
    |ABRE #0; |CIERRA #0; |DELINDEX #0;

    |ABRE #0;
    |CLS;
    |CABEZA "Emision Simplificada Part.";
    |PINPA #0#0;
    |PINDA #0#0;
    |ENDATOS #1#0;
    |SI FSalida = 0; |Y #0#4 = "SI";
        |IMPRE 0;
        |SI FSalida = 0;
            impresor = Impresora;
            |FINIMP;

            |HAZ carga_hojas;
            |HAZ impre;

            #0#5 = 1; |GRABA 040#0n;

            empresa = #0#0;
            |HAZ leempre;
        |FINSI;
    |FINSI;
    |CIERRA #0;
|SINO;
    comienza = "XX";
    |HAZ fichero;
    |NOME_DAT #9 fichero;

    comienza = "SP";
    |HAZ fichero;
    |NOME_DAT #0 fichero;

    |ABRE #0;
    |LEE 040#0p;
    |PINPA #0#6;
    |CIERRA #0;

    #6#0 = empresa; |PINTA #6#0;
    #6#1 = nombre;  |PINTA #6#1;

    |ABRE #1;
    |LIBERA #1;
    #1#0 = empresa;
    |LEE 140#1=;
    |SI FSalida ! 0; |CIERRA #1; |ACABA; |FINSI;

    |HAZ hoja6;

    |SI tipo = "A";
        #1#124 = "S";
        |SI #0#3 = "S"; |Y #5#139 > 0;
            |SI fraccion = "X"; |O fraccion = "x"; #1#131 = "S"; |FINSI;
        |FINSI;
    |FINSI;

    |SI tipo = "T";
        #1#125 = "S";
        |SI #0#3 = "S"; |Y #5#139 > 0;
            |SI fraccion = "X"; |O fraccion = "x"; #1#132 = "S"; |FINSI;
        |FINSI;
    |FINSI;

    |SI tipo = "C";
        #1#126 = "S";
        |SI #0#3 = "S"; |Y #5#139 > 0;
            |SI fraccion = "X"; |O fraccion = "x"; #1#133 = "S"; |FINSI;
        |FINSI;
    |FINSI;

    |GRABA 140#1a;
    |LIBERA #1;
    |CIERRA #1;

    |HAZ leempre;
|FINSI;
|CIERRA #0;
|SI chequeo = 0; |DELINDEX #0; |FINSI;
|FPRO;

|PROCESO impre;
|HAZ fecha;
|MENU hojas;
papel = FSalida;
|SI papel ! 1; |Y papel ! 2; |ACABA; |FINSI;
|FPRC;

|PROCESO fecha;
diainf  = #0#2 % 102;
mesinf  = #0#2 % 402;
anyoinf = #0#2 % 704;

|SI mesinf = "01"; mesinf = "Enero     "; |FINSI;
|SI mesinf = "02"; mesinf = "Febrero   "; |FINSI;
|SI mesinf = "03"; mesinf = "Marzo     "; |FINSI;
|SI mesinf = "04"; mesinf = "Abril     "; |FINSI;
|SI mesinf = "05"; mesinf = "Mayo      "; |FINSI;
|SI mesinf = "06"; mesinf = "Junio     "; |FINSI;
|SI mesinf = "07"; mesinf = "Julio     "; |FINSI;
|SI mesinf = "08"; mesinf = "Agosto    "; |FINSI;
|SI mesinf = "09"; mesinf = "Septiembre"; |FINSI;
|SI mesinf = "10"; mesinf = "Octubre   "; |FINSI;
|SI mesinf = "11"; mesinf = "Noviembre "; |FINSI;
|SI mesinf = "12"; mesinf = "Diciembre "; |FINSI;
|FPRC;

|PROCESO leempre;
|ABRE #1;
  |ET arriba;
      #1#0 = empresa;
      |LEE 040#1];
      |SI FSalida = 0;
          empresa = #1#0;
          |CIERRA #1;
          |HAZ chequeo;
      |SINO;
          chequeo = 0;
          |CIERRA #1;
      |FINSI;
|FPRC;

|PROCESO chequeo;
chequeo = 0;
|ABRE #1;
#1#0 = empresa;
|LEE 040#1=;
|SI FSalida ! 0; |ACABA; |FINSI;
|CIERRA #1;

|ABRE #9;
#9#0 = #1#0;
|LEE 040#9=;
|SI FSalida ! 0;
    #9#0  = #1#0;
    #9#1  = #1#124;
    #9#2  = #1#125;
    #9#3  = #1#126;
    #9#8  = #0#7;
    #9#9  = #0#7;
    #9#10 = #0#7;
    |GRABA 040#9n;
|FINSI;
|CIERRA #9;

chequeo = 1;
|HAZ alataque;
|FPRC;

|PROCESO alataque;
|ABRE #8;
#8#0 = #1#0;
|LEE 040#8=;
|SI FSalida ! 0; |ACABA; |FINSI;
|CIERRA #8;

tippar = #8#3;
muerto = #8#5;
|SI #8#3 = 2; fecpar = #8#4; |SINO; fecpar = #8#6; |FINSI;
feini  = "01.01.1994";
fefin  = fecpar;
dias   = fefin - feini + 1;
parte1 = ((100 * dias) / 36500) ! 4;
parte2 = 1 - parte1;

empresa = #1#0;

|ABRE #9;
#9#0 = empresa;
|LEE 040#9=;
|SI FSalida ! 0; |DDEFECTO #9; |FINSI;
|CIERRA #9;

|SI #8#3 = 1; |O #8#3 = 2;
    |SI #1#104 = "S"; |Y #9#2 = #0#6; |Y #9#9 > 0;
        tipo = "T";
        |HAZ graba_9;
        |HAZ ejecuciones;
        |ACABA;
    |FINSI;

    |SI #1#105 = "S"; |Y #9#3 = #0#6; |Y #9#10 > 0;
        tipo = "C";
        |HAZ graba_9;
        |HAZ ejecuciones;
        |ACABA;
    |FINSI;

    |SI #1#103 = "S"; |Y #9#1 = #0#6; |Y #9#8 > 0;
        tipo = "A";
        |HAZ graba_9;
        |HAZ ejecuciones;
        |ACABA;
    |FINSI;
|FINSI;

|SI #8#3 = 3;
    |SI #1#103 = "S"; |Y #9#1 = #0#6; |Y #9#8 > 0;
        tipo = "A";
        |HAZ graba_9;
        |HAZ ejecuciones;
        |ACABA;
    |FINSI;

    |SI #1#104 = "S"; |Y #9#2 = #0#6; |Y #9#9 > 0;
        tipo = "T";
        |HAZ graba_9;
        |HAZ ejecuciones;
        |ACABA;
    |FINSI;

    |SI #1#105 = "S"; |Y #9#3 = #0#6; |Y #9#10 > 0;
        tipo = "C";
        |HAZ graba_9;
        |HAZ ejecuciones;
        |ACABA;
    |FINSI;
|FINSI;

chequeo = 0;
|FPRC;

|PROCESO ejecuciones;
    |HAZ hoja1;
    #6#2 = ""; |PINTA #6#2;
    |CORRE "reempds1.run";
|FPRC;

|PROCESO hoja1;
|ABRE #5;
#5#0 = empresa;
#5#141 = tipo;
|LEE 040#5=;
|SI FSalida ! 0; |DDEFECTO #5; |FINSI;
|CIERRA #5;

|DDEFECTO #7;

swdecl = 0;
nombre  = "";  cif  = "";  anyos  = "";
nombrec = "";  cifc = "";  anyosc = "";
famili  = 0;   cuenta = ""; fraccion = ""; renuncia = "";
fechad  = "";  fechah = "";

|SI tipo = "A";
    |SI #8#3 = 1; fechad = fecpar + 1;   fechah = "31.12.1994"; |FINSI;
    |SI #8#3 = 3; fechad = "01.01.1994"; fechah = fecpar;       |FINSI;
    |SI #8#3 = 2; fechad = "01.01.1994"; fechah = fecpar;       |FINSI;

    nombre  = #1#1;  cif  = #1#2;  anyos  = #1#3;
    nombrec = #1#28; cifc = #1#29; anyosc = #1#30;
    cuenta  = #1#174; |QBF cuenta;
    |SI #1#110 = "S"; |Y #5#139 > 0; fraccion = "X"; |FINSI;
    |SI #1#110 = "s"; |Y #5#139 > 0; fraccion = "x"; |FINSI;
    |SI #5#139 < 0; |Y #1#117 = "S"; renuncia = "X"; |FINSI;
    swdecl = 2;
    |HAZ familiara;
|FINSI;

|SI tipo = "T";
    |SI #8#3 = 1; fechad = "01.01.1994"; fechah = fecpar;       |FINSI;
    |SI #8#3 = 3; fechad = fecpar + 1;   fechah = "31.12.1994"; |FINSI;
    |SI #8#3 = 2;
        |SI #8#5 = "T";
            fechad = "01.01.1994"; fechah = fecpar;
        |SINO;
            |SI #1#103 ! " ";
                fechad = fecpar + 1;
                fechah = "31.12.1994";
            |FINSI;
        |FINSI;
    |FINSI;

    nombre  = #1#1;  cif  = #1#2;  anyos  = #1#3;
    |SI #8#3 = 2; |Y #8#5 = "T";
        nombrec = #1#28; cifc = #1#29; anyosc = #1#30;
    |FINSI;
    cuenta  = #1#175; |QBF cuenta;
    |SI #1#111 = "S"; |Y #5#139 > 0; fraccion = "X"; |FINSI;
    |SI #1#111 = "s"; |Y #5#139 > 0; fraccion = "x"; |FINSI;
    |SI #5#139 < 0; |Y #1#118 = "S"; renuncia = "X"; |FINSI;
    swdecl = 1;
    |HAZ familiart;
|FINSI;

|SI tipo = "C";
    |SI #8#3 = 1; fechad = "01.01.1994"; fechah = fecpar;       |FINSI;
    |SI #8#3 = 3; fechad = fecpar + 1;   fechah = "31.12.1994"; |FINSI;
    |SI #8#3 = 2;
        |SI #8#5 = "C";
            fechad = "01.01.1994"; fechah = fecpar;
        |SINO;
            |SI #1#103 ! " ";
                fechad = fecpar + 1;
                fechah = "31.12.1994";
            |FINSI;
        |FINSI;
    |FINSI;

    nombre  = #1#28; cif  = #1#29; anyos  = #1#30;
    |SI #8#3 = 2; |Y #8#5 = "C";
        nombrec = #1#1;  cifc = #1#2;  anyosc = #1#3;
    |FINSI;

    cuenta  = #1#176; |QBF cuenta;
    |SI #1#112 = "S"; |Y #5#139 > 0; fraccion = "X"; |FINSI;
    |SI #1#112 = "s"; |Y #5#139 > 0; fraccion = "x"; |FINSI;
    |SI #5#139 < 0; |Y #1#119 = "S"; renuncia = "X"; |FINSI;
    swdecl = 1;
    |HAZ familiarc;
|FINSI;

diad = fechad % 102;
mesd = fechad % 402;
diah = fechah % 102;
mesh = fechah % 402;

|SI #5#139 < 0; fraccion = "N"; |FINSI;

|PINPA #0#6;
#6#0 = empresa; |PINTA #6#0;
#6#1 = nombre;  |PINTA #6#1;

|ABRE #2;
#2#0 = #1#40;
#2#1 = #1#41;
|LEE 040#2=;
|SI FSalida ! 0; |DDEFECTO #2; |FINSI;
|CIERRA #2;

|ABRE #3;
#3#0 = #1#44;
|LEE 040#3=;
|SI FSalida ! 0; |DDEFECTO #3; |FINSI;
|CIERRA #3;

|ABRE #4;
#4#0 = #1#12;
#4#1 = #1#13;
|LEE 040#4=;
|SI FSalida ! 0; |DDEFECTO #4; |FINSI;
|CIERRA #4;

Impresora = impresor;
|IMPRE -1;
|SI FSalida = 0;
    |SI papel = 1;
        informe = "reho1011"; |HAZ continuo;
    |SINO;
        informe = "rema1011"; |HAZ manual;
    |FINSI;
    |FINIMP;
|FINSI;
|FPRC;

|PROCESO familiara;
uno = 0;
|PARA juan = 164; |SI juan [ 173; |HACIENDO juan = juan + 1;
      esnif    = juan - 116;
      esnombre = juan - 106;
      esparent = juan - 86;
      esnacimi = juan - 96;
      nombrefa = #1esnombre; |QBF nombrefa;
      esanyo   = #1esnacimi;
      esanyo   = 1994 - esanyo;

      |SI nombrefa ! ""; |Y #1juan = "H"; |Y esanyo [ 18;
          uno        = uno + 1;
          menombre   = uno + 10;
          meparent   = uno + 20;
          menacimi   = uno + 30;
          #7uno      = #1esnif;
          #7menombre = #1esnombre;
          #7meparent = #1esparent;
          #7menacimi = #1esnacimi;
      |FINSI;
|SIGUE;

dos = 7;
|PARA juan = 164; |SI juan [ 173; |HACIENDO juan = juan + 1;
      esnif    = juan - 116;
      esnombre = juan - 106;
      esparent = juan - 86;
      esnacimi = juan - 96;

      nombrefa = #1esnombre; |QBF nombrefa;
      esanyo   = #1esnacimi;
      esanyo   = 1994 - esanyo;

      |SI nombrefa ! ""; |Y #1juan ! "H";
          dos        = dos + 1;
          |SI dos > 10;  dos = uno + 1; |FINSI;
          menombre   = dos + 10;
          meparent   = dos + 20;
          menacimi   = dos + 30;
          #7dos      = #1esnif;
          #7menombre = #1esnombre;
          #7meparent = #1esparent;
          #7menacimi = #1esnacimi;
      |FINSI;

      |SI nombrefa ! ""; |Y #1juan = "H"; |Y esanyo > 18;
          dos        = dos + 1;
          |SI dos > 10;  dos = uno + 1; |FINSI;
          menombre   = dos + 10;
          meparent   = dos + 20;
          menacimi   = dos + 30;
          #7dos      = #1esnif;
          #7menombre = #1esnombre;
          #7meparent = #1esparent;
          #7menacimi = #1esnacimi;
      |FINSI;
|SIGUE;
|FPRC;

|PROCESO familiart;
uno = 0;
|PARA juan = 164; |SI juan [ 173; |HACIENDO juan = juan + 1;
      esde     = juan - 10;
      esnif    = juan - 116;
      esnombre = juan - 106;
      esparent = juan - 86;
      esnacimi = juan - 96;
      nombrefa = #1esnombre; |QBF nombrefa;
      esanyo   = #1esnacimi;
      esanyo   = 1994 - esanyo;

      |SI nombrefa ! ""; |Y #1juan = "H"; |Y esanyo [ 18; |Y #1esde = "T";
          uno        = uno + 1;
          menombre   = uno + 10;
          meparent   = uno + 20;
          menacimi   = uno + 30;
          #7uno      = #1esnif;
          #7menombre = #1esnombre;
          #7meparent = #1esparent;
          #7menacimi = #1esnacimi;
      |FINSI;
|SIGUE;

dos = 7;
|PARA juan = 164; |SI juan [ 173; |HACIENDO juan = juan + 1;
      esde     = juan - 10;
      esnif    = juan - 116;
      esnombre = juan - 106;
      esparent = juan - 86;
      esnacimi = juan - 96;

      nombrefa = #1esnombre; |QBF nombrefa;
      esanyo   = #1esnacimi;
      esanyo   = 1994 - esanyo;

      |SI nombrefa ! ""; |Y #1juan ! "H"; |Y #1esde = "T";
          dos        = dos + 1;
          |SI dos > 10;  dos = uno + 1; |FINSI;
          menombre   = dos + 10;
          meparent   = dos + 20;
          menacimi   = dos + 30;
          #7dos      = #1esnif;
          #7menombre = #1esnombre;
          #7meparent = #1esparent;
          #7menacimi = #1esnacimi;
      |FINSI;

      |SI nombrefa ! ""; |Y #1juan = "H"; |Y esanyo > 18; |Y #1esde = "T";
          dos        = dos + 1;
          |SI dos > 10;  dos = uno + 1; |FINSI;
          menombre   = dos + 10;
          meparent   = dos + 20;
          menacimi   = dos + 30;
          #7dos      = #1esnif;
          #7menombre = #1esnombre;
          #7meparent = #1esparent;
          #7menacimi = #1esnacimi;
      |FINSI;
|SIGUE;
|FPRC;

|PROCESO familiarc;
uno = 0;
|PARA juan = 164; |SI juan [ 173; |HACIENDO juan = juan + 1;
      esde     = juan - 10;
      esnif    = juan - 116;
      esnombre = juan - 106;
      esparent = juan - 86;
      esnacimi = juan - 96;
      nombrefa = #1esnombre; |QBF nombrefa;
      esanyo   = #1esnacimi;
      esanyo   = 1994 - esanyo;

      |SI nombrefa ! ""; |Y #1juan = "H"; |Y esanyo [ 18; |Y #1esde = "C";
          uno        = uno + 1;
          menombre   = uno + 10;
          meparent   = uno + 20;
          menacimi   = uno + 30;
          #7uno      = #1esnif;
          #7menombre = #1esnombre;
          #7meparent = #1esparent;
          #7menacimi = #1esnacimi;
      |FINSI;
|SIGUE;

dos = 7;
|PARA juan = 164; |SI juan [ 173; |HACIENDO juan = juan + 1;
      esde     = juan - 10;
      esnif    = juan - 116;
      esnombre = juan - 106;
      esparent = juan - 86;
      esnacimi = juan - 96;

      nombrefa = #1esnombre; |QBF nombrefa;
      esanyo   = #1esnacimi;
      esanyo   = 1994 - esanyo;

      |SI nombrefa ! ""; |Y #1juan ! "H"; |Y #1esde = "C";
          dos        = dos + 1;
          |SI dos > 10;  dos = uno + 1; |FINSI;
          menombre   = dos + 10;
          meparent   = dos + 20;
          menacimi   = dos + 30;
          #7dos      = #1esnif;
          #7menombre = #1esnombre;
          #7meparent = #1esparent;
          #7menacimi = #1esnacimi;
      |FINSI;

      |SI nombrefa ! ""; |Y #1juan = "H"; |Y esanyo > 18; |Y #1esde = "C";
          dos        = dos + 1;
          |SI dos > 10;  dos = uno + 1; |FINSI;
          menombre   = dos + 10;
          meparent   = dos + 20;
          menacimi   = dos + 30;
          #7dos      = #1esnif;
          #7menombre = #1esnombre;
          #7meparent = #1esparent;
          #7menacimi = #1esnacimi;
      |FINSI;
|SIGUE;
|FPRC;

|PROCESO hoja6;
|ABRE #5;
#5#0 = empresa;
#5#141 = tipo;
|LEE 040#5=;
|SI FSalida ! 0; |DDEFECTO #5; |FINSI;
|CIERRA #5;

|ABRE #2;
#2#0 = #1#40;
#2#1 = #1#41;
|LEE 040#2=;
|SI FSalida ! 0; |DDEFECTO #2; |FINSI;
|CIERRA #2;

|ABRE #4;
#4#0 = #1#12;
#4#1 = #1#13;
|LEE 040#4=;
|SI FSalida ! 0; |DDEFECTO #4; |FINSI;
|CIERRA #4;

|ABRE #10;
#10#0 = #1#12;
|LEE 040#10=;
|SI FSalida ! 0; |DDEFECTO #10; |FINSI;
|CIERRA #10;

sw_al60 = 0;
ingreso = #5#139;
|SI #5#139 > 0;
    |SI fraccion = "X"; |O fraccion = "x";
        ingreso = #5#139 % 60;
        |SI ingreso > 0; sw_al60 = 1; |FINSI;
    |FINSI;
|FINSI;

Impresora = impresor;
|IMPRE -1;
|SI FSalida = 0;
    |SI papel = 1;
        informe = "reho1016"; |HAZ  continuo;
    |SINO;
        informe = "rema1016"; |HAZ manual;
    |FINSI;
    |SI #0#3 = "S";
        |SI fraccion = "X"; |O fraccion = "x";
            |SI #5#139 > 0;
                |SI papel = 1;
                    informe = "rehoj102"; |HAZ continuo;
                |SINO;
                    informe = "remaj102"; |HAZ manual;
                |FINSI;
            |SINO;
                |SI papel = 1; |HAZ hojablan; |FINSI;
            |FINSI;
        |SINO;
            |SI papel = 1; |HAZ hojablan; |FINSI;
        |FINSI;
    |FINSI;
    |FINIMP;
|FINSI;
|FPRC;

|PROCESO continuo;
|SI informe = "reho1011"; |Y hoja1 = "N"; |ACABA; |FINSI;
|SI informe = "reho1016"; |Y hoja6 = "N"; |ACABA; |FINSI;

|INFOR informe;
|SI FSalida = 0;
    |PRINT; |PIEINF; |FININF;
|FINSI;
|FPRC;

|PROCESO manual;
|SI informe = "rema1011"; |Y hoja1 = "N"; |ACABA; |FINSI;
|SI informe = "rema1016"; |Y hoja6 = "N"; |ACABA; |FINSI;

|ET comienzo;
    |SI informe = "rema1011";
        #6#2 =  "COLOQUE PAGINA 1 DEL MODELO 101, <INTRO PARA IMPRIMIR>";
    |FINSI;

    |SI informe = "rema1016";
        #6#2 = "COLOQUE PAGINA DE INGRESO O DEVOLUCION, <INTRO PARA IMPRIMIR>";
    |FINSI;

    |SI informe = "remaj102";
        #6#2 = "COLOQUE PAGINA MODELO 102, <INTRO PARA IMPRIMIR>";
    |FINSI;

    |ATRI P; |PINTA #6#2; |ATRI 0;
    |PAUSA;

    |INFOR informe;
    |SI FSalida = 0;
        |PRINT; |PIEINF; |FININF;

        |CONFI "2400NDesea repetir la hoja : ";
        |SI FSalida = 0; |VETE comienzo; |FINSI;
    |FINSI;
|FPRC;

|PROCESO hojablan;
informe = "rehoblan";
|INFOR informe;
|SI FSalida = 0;
    |PRINT; |PIEINF; |FININF;
|FINSI;
|FPRC;

|PROCESO graba_9;
|ABRE #9;
#9#0 = empresa;
|LIBERA #9;
|LEE 140#9=;
|SI FSalida = 0;
    |SI tipo = "A"; #9#8  = #9#8  - 1; |FINSI;
    |SI tipo = "T"; #9#9  = #9#9  - 1; |FINSI;
    |SI tipo = "C"; #9#10 = #9#10 - 1; |FINSI;
    |GRABA 140#9a;
|FINSI;
|CIERRA #9;
|FPRC;

|PROCESO carga_hojas;
    hoja1  = #0#8;
    hoja2  = #0#9;
    hoja3  = #0#10;
    hoja4  = #0#11;
    hoja5  = #0#12;
    hoja6  = #0#13;
|FPRC;
