|FICHEROS;
    ver00002 #0;

    y2capinm #1;    || def nuevo Capital Inmobiliario
    x2capinm #2;    || def viejo Capital Inmobiliario

    y2actafe #3;    || def nuevo activos afectos
    x2actafe #4;    || def viejo activos afectos

    y2patrim #5;    || def nuevo patrimonio
    x2patrim #6;    || def viejo patrimonio

    y2totpat #7;    || def nuevo liquidacion patrimonio
    x2totpat #8;    || def viejo liquidacion patrimonio

    y2parame #9;    || def nuevo Parametros Renta
    x2parame #10;   || def viejo Parametros Renta
|FIN;

|VARIABLES;
    &enganche = 0;
    agidef0 = "agidef0";
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    campo = 0;
    campodi = 0;
    copi1 = "";
    copi2 = "";
    copy = "";
    def = "";
    desde = 0;
    fich = "";
    fijo1 = "";
    fijo2 = "";
    hasta = 0;
    mes = 0;
    numero = 0;
    otro1 = "";
    otro2 = "";
    puntero = 0;
    sis = "";
    topemes = 0;
    v_nombre = "";
    v_numero = 0;
    cuenta = "";
    digito = 0;
    el_signo = "";
    dire = "";
|FIN;

|INCLUYE i_camver;

****************************************************************************
      INICIO DE PROCESO
****************************************************************************

|PROCESO engan; |TIPO 7;
|SI enganche = 1;
        #0#1 = "SI";
    |PTEC 802;
    |PTEC 802;
|FINSI;
|FPRC;

|PROCESO base;
|QUE_SISTEMA sis;
|DFICE fich;
|DDEF def;
|SI sis = "ESUNIX";
        copy = "cp ";    || xenix
|SINO;
        copy = "copy ";  || d.o.s.
|FINSI;
|FPRC;

|PROCESO conver; |TIPO 3;
|SI #0#1 = "SI";     || confirmacion de seguridad!!!
    |HAZ base;

        v_nombre = "recapinm";
        v_numero =  70;
    |ATRI P; |PINTA 0918, "*";  |ATRI 0;
    |HAZ proceso1;
    |HAZ actualiza;
    |DELINDEX #1;

    |PINTA 0918, " ";
        v_nombre = "reactafe";
        v_numero =  48;
    |ATRI P; |PINTA 1018, "*";  |ATRI 0;
    |HAZ proceso2;
    |HAZ actualiza;
    |DELINDEX #3;

    |PINTA 1018, " ";
        v_nombre = "repatrim";
        v_numero =  15;
    |ATRI P; |PINTA 1118, "*";  |ATRI 0;
    |HAZ proceso3;
    |HAZ actualiza;
    |DELINDEX #5;

    |PINTA 1118, " ";
        v_nombre = "retotpat";
        v_numero =  45;
    |ATRI P; |PINTA 1218, "*";  |ATRI 0;
    |HAZ proceso4;
    |HAZ actualiza;
    |DELINDEX #7;

    |PINTA 1218, " ";
        v_nombre = "reparame";
        v_numero =  11;
    |ATRI P; |PINTA 1318, "*";  |ATRI 0;
    |HAZ proceso5;
    |HAZ actualiza;
    |DELINDEX #9;

    |HAZ gra_version;
|FINSI;
|FPRC;

****************************************************************************
      LECTURA Y GRABACION
****************************************************************************

|PROCESO proceso1;
numero = 0;
|NOME_DAT #1 agidef0;
|ABRE #1; |CIERRA #1; |DELINDEX #1;

|ABRE #1;
|ABRE #2;
|LEE 040#2p;
|PARA; |SI FSalida = 0; |HACIENDO;
    |DDEFECTO #1;
    |PARA campo = 0; |SI campo [ v_numero; |HACIENDO campo = campo + 1;
            #1campo = #2campo;
    |SIGUE;
    |GRABA 020#1n;
    |HAZ pinta;
    |LEE 040#2s;
|SIGUE;
|CIERRA #1;
|CIERRA #2;
|FPRC;

|PROCESO proceso2;
numero = 0;
|NOME_DAT #3 agidef0;
|ABRE #3; |CIERRA #3; |DELINDEX #3;

|ABRE #3;
|ABRE #4;
|LEE 040#4p;
|PARA; |SI FSalida = 0; |HACIENDO;
    |DDEFECTO #3;
    |PARA campo = 0; |SI campo [ v_numero; |HACIENDO campo = campo + 1;
            #3campo = #4campo;
    |SIGUE;
    |GRABA 020#3n;
    |HAZ pinta;
    |LEE 040#4s;
|SIGUE;
|CIERRA #3;
|CIERRA #4;
|FPRC;

|PROCESO proceso3;
numero = 0;
|NOME_DAT #5 agidef0;
|ABRE #5; |CIERRA #5; |DELINDEX #5;

|ABRE #5;
|ABRE #6;
|LEE 040#6p;
|PARA; |SI FSalida = 0; |HACIENDO;
    |DDEFECTO #5;
    |PARA campo = 0; |SI campo [ v_numero; |HACIENDO campo = campo + 1;
            #5campo = #6campo;
    |SIGUE;
    |GRABA 020#5n;
    |HAZ pinta;
    |LEE 040#6s;
|SIGUE;
|CIERRA #5;
|CIERRA #6;
|FPRC;

|PROCESO proceso4;
numero = 0;
|NOME_DAT #7 agidef0;
|ABRE #7; |CIERRA #7; |DELINDEX #7;

|ABRE #7;
|ABRE #8;
|LEE 040#8p;
|PARA; |SI FSalida = 0; |HACIENDO;
    |DDEFECTO #7;
    |PARA campo = 0; |SI campo [ v_numero; |HACIENDO campo = campo + 1;
            #7campo = #8campo;
    |SIGUE;
    |GRABA 020#7n;
    |HAZ pinta;
    |LEE 040#8s;
|SIGUE;
|CIERRA #7;
|CIERRA #8;
|FPRC;

|PROCESO proceso5;
numero = 0;
|NOME_DAT #9 agidef0;
|ABRE #9; |CIERRA #9; |DELINDEX #9;

|ABRE #9;
|ABRE #10;
|LEE 040#10p;
|PARA; |SI FSalida = 0; |HACIENDO;
    |DDEFECTO #9;
    |PARA campo = 0; |SI campo [ v_numero; |HACIENDO campo = campo + 1;
            #9campo = #10campo;
    |SIGUE;
    |GRABA 020#9n;
    |HAZ pinta;
    |LEE 040#10s;
|SIGUE;
|CIERRA #9;
|CIERRA #10;
|FPRC;

|PROCESO pinta;
    numero = numero + 1;
    alfa3 = numero;  alfa3 = "      " + numero;  alfa3 = alfa3 % -106;
|PINTA 2170, alfa3;
|FPRC;

****************************************************************************
      ACTUALIZACION FICHERO PUENTE SOBRE FICHERO ACTUAL
****************************************************************************

|PROCESO actualiza;
    dire = "";
|DIRECTORIO dire;
    otro1 = dire + "bin/agicopy " + fich + "agidef0 " + fich + v_nombre;
|SYSTEM otro1;
|FPRC;

****************************************************************************
      RUTINAS ESPECIFICAS DE LA CONVERSION VIGENTE
****************************************************************************
