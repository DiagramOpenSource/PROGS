|FICHEROS;
   reempmod #5;
   rerendtr #7;
   rectacor #8;
|FIN;

|VARIABLES;
   &empresa   = 0;
   &nombre    = "";
   &cif       = "";
   &anyos     = "";
   &impresor  = "";
   &tipo      = "";
   &swporta   = 0;
   &sw1       = 0;
   &sw21      = 0;
   &sw22      = 0;
   &sw3       = 0;
   &sw4       = 0;
   &sw5       = 0;
   &sw6       = 0;
   &sw7       = 0;
   &sw8       = 0;
   &sw9       = 0;
   &sw10      = 0;
   &swmod     = 0;
   &linea     = 0;
   &hoja      = 0;
   &vuelve    = 1;
   &seleccion = "";
   &tipore1   = 0;
   &tipore2   = 0;
   &tipore3   = 0;
   &tipore4   = 0;
   &tipore5   = 0;
   &tipore6   = 0;
   &tipore7   = 0;
   &chequeo   = 0;
   &campo     = 0;
   &caciclo   = 0;
   &conta_d   = 0;
   &conta_c   = 0;

   conta1     = 0;
   perce      = "";
   swrrr1     = 0;
   swprof     = 0;
   cabecera   = "";
   varalf     = "";
   x          = 0;
   fichero    = 0;
   conta      = 0;
   a          = 0;
   b          = 0;
   c          = 0;
   impor      = 0;
   var1       = "";
   var2       = "";
   var3       = 0;
   var4       = 0;
   var5       = 0;
   var6       = 0;
   var7       = 0;
   var8       = 0;
   var9       = 0;
   coefi      = 0;
|FIN;

|| **************************************************************************
||                           PROCESOS IMPRESION
|| **************************************************************************

|INCLUYE i_import;

|PROCESO cabecera;
cabecera = "************************************************************************";
|IMPRIME cabecera;
cabecera = "                        *  RELACION ADJUNTA *        ";
|IMPRIME cabecera;
cabecera = "************************************************************************";
|IMPRIME cabecera;
hoja     = hoja + 1;
importe  = hoja;
cabecera = "";                         |IMPRIME cabecera;
cabecera = "Hoja ......: " + importe;  |IMPRIME cabecera;
cabecera = "Declarante : " + nombre;   |IMPRIME cabecera;
cabecera = "NIF : " + cif;             |IMPRIME cabecera;
cabecera = "";                         |IMPRIME cabecera;
swporta  = 1;
linea    = 8;
|FPRC;

|PROCESO imprime;
|SI swporta = 0; |HAZ cabecera; |FINSI;
|IMPRIME varalf; linea = linea + 1; |HAZ linea;
|FPRC;

|PROCESO linea;
|SI linea < 58; |ACABA; |FINSI;

cabecera = "";  |IMPRIME cabecera;
cabecera = "                                                                     Sigue...";
|IMPRIME cabecera;
linea = linea + 2;
|PARA x = linea; |SI x [ 65; |HACIENDO x = x + 1;
      cabecera = ""; |IMPRIME cabecera;
|SIGUE;
|HAZ cabecera;
|FPRC;

|PROCESO pie;
|PARA x = linea; |SI x [ 65; |HACIENDO x = x + 1;
      cabecera = ""; |IMPRIME cabecera;
|SIGUE;
|FPRC;

|| ********************** Empresariales Modulos ****************************
|PROCESO carga5;
conta = conta + 1;
|SI conta > 3; swmod = 1; |FINSI;
|FPRC;

|PROCESO carga3;
conta1 = conta1 + 1;
conta  = conta + 1;

|SI conta < 4;
    |SI conta1 > 3;
        varalf = "";                                      |HAZ imprime;
        varalf = "";                                      |HAZ imprime;
        importe = conta;
        varalf = "Actividad ..: " + importe;              |HAZ imprime;
        varalf = "Titular ....: " + perce;                |HAZ imprime;
        varalf = "Descripcion : " + #5#15;                |HAZ imprime;
        varalf = "Modalidad ..: Empresarial modulos";     |HAZ imprime;
        varalf = "";                                      |HAZ imprime;
        |ACABA;
    |FINSI;
    |ACABA;
|FINSI;

fichero = 5;
varalf = "";                                    |HAZ imprime;
varalf = "";                                    |HAZ imprime;
varalf = "Epigrafe I.A.E. : "  + #5#13 + #5#14; |HAZ imprime;
varalf = "Titular ........: "  + perce;          |HAZ imprime;
varalf = "";                                    |HAZ imprime;

|PARA x = 16; |SI x [ 22; |HACIENDO x = x + 1;
    a      = x + 7;
    b      = a + 7;
    impor  = #5a % coefi;
    var1   = impor;
    var1   = ("          " + var1) % -110;
    impor  = (#5a % coefi) * (#5b % coefi);
    var2   = impor;
    var2   = ("           " + var2) % -111;
    varalf = #5x + " " + var1 + " " + var2;       |HAZ imprime;
|SIGUE;
varalf = "";                                        |HAZ imprime;

impor   = #5#37 % coefi;
importe = impor; |HAZ importe;
varalf = " Rendimiento neto previo ............: " + importe; |HAZ imprime;
varalf = "";                                        |HAZ imprime;

a      = #5#38 - 1;
varalf = a;
varalf = ("     " + varalf) % -105;
varalf = " Por caracteristicas de la actividad : " + varalf; |HAZ imprime;

varalf = #5#40;
varalf = ("     " + varalf) % -105;
varalf = " Actividades temporada ..............: " + varalf; |HAZ imprime;

varalf = #5#42;
varalf = ("     " + varalf) % -105;
varalf = " Por cuantia del rendimiento ........: " + varalf; |HAZ imprime;

impor   = #5#44 % coefi;
importe = impor; |HAZ importe;
varalf = " Rendimiento neto corregido .........: " + importe; |HAZ imprime;
varalf = "";                                        |HAZ imprime;

|FPRC;

|PROCESO modulos1;
|SI #5#4 = "X"; |O #5#4 = "P"; |ACABA; |FINSI;

|SI tipo = "A"; perce = #5#3; |SINO; perce = "TITULAR"; |FINSI;

|SI tipo = "A";
    |SI #5#2 = "V";
        coefi = #5#7 + #5#8 + #5#9 + #5#10 + #5#11 + #5#12;
        |HAZ carga5;
        |ACABA;
    |FINSI;
    coefi = 100; |HAZ carga5;
    |ACABA;
|FINSI;

|SI tipo = "T";
   |SI #5#2 = "G"; coefi = 50;   |HAZ carga5; |ACABA; |FINSI;
   |SI #5#2 = "T"; coefi = 100;  |HAZ carga5; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#7; |HAZ carga5; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "C";
   |SI #5#2 = "G"; coefi = 50;   |HAZ carga5; |ACABA; |FINSI;
   |SI #5#2 = "C"; coefi = 100;  |HAZ carga5; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#8; |HAZ carga5; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "1";
   |SI #5#2 = "1"; coefi = 100;  |HAZ carga5; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#9; |HAZ carga5; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "2";
   |SI #5#2 = "2"; coefi = 100;   |HAZ carga5; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#10; |HAZ carga5; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "3";
   |SI #5#2 = "3"; coefi = 100;   |HAZ carga5; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#11; |HAZ carga5; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "4";
   |SI #5#2 = "4"; coefi = 100;   |HAZ carga5; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#12; |HAZ carga5; |ACABA; |FINSI;
   |ACABA;
|FINSI;
|FPRC;

|PROCESO modulos2;
|SI #5#4 = "X"; |O #5#4 = "P"; |ACABA; |FINSI;

|SI tipo = "A"; perce = #5#3; |SINO; perce = "TITULAR"; |FINSI;

|SI tipo = "A";
    |SI #5#2 = "V";
        coefi = #5#7 + #5#8 + #5#9 + #5#10 + #5#11 + #5#12;
        |HAZ carga3;
        |ACABA;
    |FINSI;
    coefi = 100; |HAZ carga3;
    |ACABA;
|FINSI;

|SI tipo = "T";
   |SI #5#2 = "G"; coefi = 50;   |HAZ carga3; |ACABA; |FINSI;
   |SI #5#2 = "T"; coefi = 100;  |HAZ carga3; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#7; |HAZ carga3; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "C";
   |SI #5#2 = "G"; coefi = 50;   |HAZ carga3; |ACABA; |FINSI;
   |SI #5#2 = "C"; coefi = 100;  |HAZ carga3; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#8; |HAZ carga3; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "1";
   |SI #5#2 = "1"; coefi = 100;  |HAZ carga3; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#9; |HAZ carga3; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "2";
   |SI #5#2 = "2"; coefi = 100;   |HAZ carga3; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#10; |HAZ carga3; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "3";
   |SI #5#2 = "3"; coefi = 100;   |HAZ carga3; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#11; |HAZ carga3; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "4";
   |SI #5#2 = "4"; coefi = 100;   |HAZ carga3; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#12; |HAZ carga3; |ACABA; |FINSI;
   |ACABA;
|FINSI;
|FPRC;

|DEFBUCLE reempmo1;
#5#1;
;
empresa, 01;
empresa, 99;
e;
NULL, modulos1;
|FIN;

|DEFBUCLE reempmo2;
#5#1;
;
empresa, 01;
empresa, 99;
e;
NULL, modulos2;
|FIN;

|| ********************** Irregulares Trabajo ***********************************

|PROCESO carga20;
conta = conta + 1;
|SI conta > 3; swprof = 1; |FINSI;
|FPRC;

|PROCESO carga6;
conta = conta + 1;
|SI conta < 3; |ACABA; |FINSI;
varalf = "";                                                     |HAZ imprime;
varalf = "";                                                     |HAZ imprime;
|SI caciclo = 0;
    varalf = "F) RENDIMIENTOS IRREGULARES O DE CICLO SUPERIOR A UN A¥O"; |HAZ imprime;
    varalf = "";                                                 |HAZ imprime;
    |SI  fichero = 7;
         varalf = "Del Trabajo";                                 |HAZ imprime;
    |SINO;
         |SI swrrr1 = 0;
             varalf = "Del Capital";                             |HAZ imprime;
             swrrr1 = 1;
         |FINSI;
    |FINSI;
    varalf = "";                                                 |HAZ imprime;
    caciclo = 1;
|SINO;
     |SI fichero = 8; |Y swrrr1 = 0;
         varalf = "Del Capital";                                 |HAZ imprime;
         varalf = "";                                            |HAZ imprime;
         swrrr1 = 0;
     |FINSI;
|FINSI;

varalf = "Descripcion : " + var1;                                |HAZ imprime;
varalf = "Perceptor ..: " + var2;                                |HAZ imprime;
varalf = "";                                                     |HAZ imprime;
a = var3 % coefi; importe = a;                                  |HAZ importe;
varalf = "Retencion / Ingreso a cuenta ....................: " + importe;
                                                                 |HAZ imprime;
a = var4 % coefi; importe = a;                                  |HAZ importe;
varalf = "Ingresos integros ...............................: " + importe;
                                                                 |HAZ imprime;
a = var5 % coefi; importe = a;                                   |HAZ importe;
varalf = "Gastos deducibles / Reduccion Legal .............: " + importe;
                                                                 |HAZ imprime;
a = var6 % coefi; importe = a;                                   |HAZ importe;
varalf = "Rendimiento Neto ................................: " + importe;
                                                                 |HAZ imprime;
a = var7 % coefi; importe = a;                                   |HAZ importe;
varalf = "Periodo de generacion (A¥OS) ....................: " + importe;
                                                                 |HAZ imprime;
a = var8 % coefi; importe = a;                                   |HAZ importe;
varalf = "Cociente ........................................: " + importe;
                                                                 |HAZ imprime;
a = var9 % coefi; importe = a;                                   |HAZ importe;
varalf = "Resto del rendimiento neto ......................: " + importe;
                                                                 |HAZ imprime;
|FPRC;

|PROCESO trabajo1;
fichero = 7;

|SI tipo = "A"; perce = #7#3; |SINO; perce = "TITULAR"; |FINSI;

var1 = #7#4;
var2 = perce;
var3 = #7#23;
var4 = #7#22;
var5 = #7#24;
var6 = #7#26;
var7 = #7#25;
var8 = #7#27;
var9 = #7#26 - #7#27;

var6 = #7#26;
|SI #7#28 = "X"; |ACABA; |FINSI;
|SI #7#22 = 0;   |ACABA; |FINSI;

coefi = 100;

|SI tipo = "A"; |HAZ carga6; |ACABA; |FINSI;
|SI tipo = "T"; |Y #7#2 = "T"; |HAZ carga6; |ACABA; |FINSI;
|SI tipo = "C"; |Y #7#2 = "C"; |HAZ carga6; |ACABA; |FINSI;
|SI tipo = "1"; |Y #7#2 = "1"; |HAZ carga6; |ACABA; |FINSI;
|SI tipo = "2"; |Y #7#2 = "2"; |HAZ carga6; |ACABA; |FINSI;
|SI tipo = "3"; |Y #7#2 = "3"; |HAZ carga6; |ACABA; |FINSI;
|SI tipo = "4"; |Y #7#2 = "4"; |HAZ carga6; |ACABA; |FINSI;
|FPRC;

|PROCESO trabajo2;
|SI #7#28 = "X"; |ACABA; |FINSI;
|SI #7#22 = 0;   |ACABA; |FINSI;

coefi = 100;

|SI tipo = "A"; perce = #7#3; |SINO; perce = "TITULAR"; |FINSI;

|SI tipo = "A"; |HAZ carga20; |ACABA; |FINSI;
|SI tipo = "T"; |Y #7#2 = "T"; |HAZ carga20; |ACABA; |FINSI;
|SI tipo = "C"; |Y #7#2 = "C"; |HAZ carga20; |ACABA; |FINSI;
|SI tipo = "1"; |Y #7#2 = "1"; |HAZ carga20; |ACABA; |FINSI;
|SI tipo = "2"; |Y #7#2 = "2"; |HAZ carga20; |ACABA; |FINSI;
|SI tipo = "3"; |Y #7#2 = "3"; |HAZ carga20; |ACABA; |FINSI;
|SI tipo = "4"; |Y #7#2 = "4"; |HAZ carga20; |ACABA; |FINSI;
|FPRC;

|DEFBUCLE rerendt1;
#7#1;
;
empresa, 01;
empresa, 99;
e;
NULL, trabajo1;
|FIN;

|DEFBUCLE rerendt2;
#7#1;
;
empresa, 01;
empresa, 99;
e;
NULL, trabajo2;
|FIN;

|| ********************** Irregulares Capital ***********************************

|PROCESO capital1;
fichero = 8;

|SI #8#4 = "X"; |O #8#4 = "P"; |ACABA; |FINSI;
|SI #8#26 ! "I"; |ACABA; |FINSI;
|SI #8#5 = "N";  |ACABA; |FINSI;

|SI tipo = "A"; perce = #8#3; |SINO; perce = "TITULAR"; |FINSI;

var1 = #8#14;
var2 = perce;
var3 = #8#18;
var4 = #8#17;
var5 = #8#21 + #8#22;
var6 = var4 - var5;
var7 = #8#27;
var8 = var6 / var7;
var9 = var6 - var8;

|SI tipo = "A";
    |SI #8#2 = "V";
        coefi = #8#7 + #8#8 + #8#9 + #8#10 + #8#11 + #8#12;
        |HAZ carga6;
        |ACABA;
    |FINSI;
    coefi = 100; |HAZ carga6;
    |ACABA;
|FINSI;

|SI tipo = "T";
   |SI #8#2 = "G"; coefi = 50;   |HAZ carga6; |ACABA; |FINSI;
   |SI #8#2 = "T"; coefi = 100;  |HAZ carga6; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#7; |HAZ carga6; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "C";
   |SI #8#2 = "G"; coefi = 50;   |HAZ carga6; |ACABA; |FINSI;
   |SI #8#2 = "C"; coefi = 100;  |HAZ carga6; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#8; |HAZ carga6; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "1";
   |SI #8#2 = "1"; coefi = 100;  |HAZ carga6; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#9; |HAZ carga6; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "2";
   |SI #8#2 = "2"; coefi = 100;   |HAZ carga6; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#10; |HAZ carga6; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "3";
   |SI #8#2 = "3"; coefi = 100;   |HAZ carga6; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#11; |HAZ carga6; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "4";
   |SI #8#2 = "4"; coefi = 100;   |HAZ carga6; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#12; |HAZ carga6; |ACABA; |FINSI;
   |ACABA;
|FINSI;
|FPRC;

|PROCESO capital2;
|SI #8#4 = "X"; |O #8#4 = "P"; |ACABA; |FINSI;
|SI #8#26 ! "I"; |ACABA; |FINSI;
|SI #8#5 = "N";  |ACABA; |FINSI;

|SI tipo = "A"; perce = #8#3; |SINO; perce = "TITULAR"; |FINSI;

|SI tipo = "A";
    |SI #8#2 = "V";
        coefi = #8#7 + #8#8 + #8#9 + #8#10 + #8#11 + #8#12;
        |HAZ carga20;
        |ACABA;
    |FINSI;
    coefi = 100; |HAZ carga20;
    |ACABA;
|FINSI;

|SI tipo = "T";
   |SI #8#2 = "G"; coefi = 50;   |HAZ carga20; |ACABA; |FINSI;
   |SI #8#2 = "T"; coefi = 100;  |HAZ carga20; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#7; |HAZ carga20; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "C";
   |SI #8#2 = "G"; coefi = 50;   |HAZ carga20; |ACABA; |FINSI;
   |SI #8#2 = "C"; coefi = 100;  |HAZ carga20; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#8; |HAZ carga20; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "1";
   |SI #8#2 = "1"; coefi = 100;  |HAZ carga20; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#9; |HAZ carga20; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "2";
   |SI #8#2 = "2"; coefi = 100;   |HAZ carga20; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#10; |HAZ carga20; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "3";
   |SI #8#2 = "3"; coefi = 100;   |HAZ carga20; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#11; |HAZ carga20; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "4";
   |SI #8#2 = "4"; coefi = 100;   |HAZ carga20; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#12; |HAZ carga20; |ACABA; |FINSI;
   |ACABA;
|FINSI;
|FPRC;

|DEFBUCLE rectaco1;
#8#1;
;
empresa, 01;
empresa, 99;
e;
NULL, capital1;
|FIN;

|DEFBUCLE rectaco2;
#8#1;
;
empresa, 01;
empresa, 99;
e;
NULL, capital2;
|FIN;

|PROGRAMA;
vuelve  = 1;
swmod   = 0;
swprof  = 0;
swrrr1  = 0;
Impresora = impresor;
|IMPRE -1;
|SI FSalida = 0;
   conta = conta_d + conta_c;  |BUCLE reempmo1;

   |SI swmod = 1;
       conta1 = conta_d + conta_c;
       conta  = 0; |BUCLE reempmo2;
   |FINSI;

   swprof  = 0;
   conta = 0; |BUCLE rerendt2;
              |BUCLE rectaco2;
   |SI swprof = 1;
       conta = 0; |BUCLE rerendt1;
                  |BUCLE rectaco1;
   |FINSI;
   |FINIMP;
   |CORRE "readjor5.run";
|FINSI;
|FPRO;
