|FICHEROS;
   recapinm #1;
   repatrim #2;
   repoblac #6;
|FIN;

|VARIABLES;
   &empresa   = 0;
   &nombre    = "";
   &cif       = "";
   &impresor  = "";
   &tipo      = "";
   &swporta   = 0;
   &swmod     = 0;
   &linea     = 0;
   &hoja      = 0;
   &vuelve    = 1;
   &seleccion = "";
   &tipore1   = 0;
   &tipore2   = 0;
   &tipore3   = 0;
   &tipore4   = 0;
   &tipore5   = 0;
   &tipore6   = 0;
   &chequeo   = 0;
   &campo     = 0;
   &caciclo   = 0;
   &anyo1     = 0;
   &anyo2     = 0;
   &anyo3     = 0;
   &anyo4     = 0;
   &anyo5     = 0;
   &anyo6     = 0;

   total      = 0;
   clave      = "";
   tipoprop   = "";
   tipod      = "";
   swrrr      = 0;
   swprof     = 0;
   cabecera   = "";
   varalf     = "";
   alfa1      = "";
   alfa2      = "";
   alfa3      = "";
   alfa4      = "";
   alfa5      = "";
   x          = 0;
   fichero    = 0;
   conta      = 0;
   a          = 0;
   b          = 0;
   c          = 0;
   impor      = 0;
   var1       = 0;
   coefi      = 0;

   canti     = 0;
   canti1    = 0;
   canti2    = 0;
   porce     = 0;
   anyou     = 0;
   anyos     = 0;
|FIN;

|| **************************************************************************
||                           PROCESOS IMPRESION
|| **************************************************************************

|INCLUYE i_import;

|PROCESO cabecera;
cabecera = "************************************************************************";
|IMPRIME cabecera;
cabecera = "                        *  COMPROBACION PATRIMONIO * ";
|IMPRIME cabecera;
cabecera = "************************************************************************";
|IMPRIME cabecera;
hoja     = hoja + 1;
importe  = hoja;
cabecera = "";                         |IMPRIME cabecera;
cabecera = "Hoja ......: " + importe;  |IMPRIME cabecera;
cabecera = "Declarante : " + nombre;   |IMPRIME cabecera;
cabecera = "NIF : " + cif;             |IMPRIME cabecera;
cabecera = "";                         |IMPRIME cabecera;
swporta  = 1;
linea    = 8;
|FPRC;


|PROCESO imprime;
|SI swporta = 0; |HAZ cabecera; |FINSI;
|CIMPR 1;  |IMPRIME varalf;  |CIMPR 2;
linea = linea + 1; |HAZ linea;
|FPRC;

|PROCESO linea;
|SI linea < 58; |ACABA; |FINSI;

cabecera = "";  |IMPRIME cabecera;
cabecera = "                                                                     Sigue...";
|IMPRIME cabecera;
linea = linea + 2;
|PARA x = linea; |SI x [ 65; |HACIENDO x = x + 1;
      cabecera = ""; |IMPRIME cabecera;
|SIGUE;
|HAZ cabecera;
|FPRC;

|PROCESO pie;
|PARA x = linea; |SI x [ 65; |HACIENDO x = x + 1;
      cabecera = ""; |IMPRIME cabecera;
|SIGUE;
|FPRC;

|| *************************************************************************
|| *********************** Del Capital inmobiliario ************************
|| *************************************************************************

|PROCESO carga1;
conta = conta + 1;
|SI swrrr = 0;
    varalf = ""; |HAZ imprime;
    varalf = "A) BIENES INMUEBLES DE NATURALEZA URBANA"; |HAZ imprime;
    varalf = "=" * 122; |HAZ imprime;
    varalf = "Clave   Referencia catastral                       Situacion ";
    varalf = varalf + "del inmueble                                            ";
    varalf = varalf + "Valor";
    |HAZ imprime;
    varalf = "=" * 122; |HAZ imprime;
    swrrr = 1;
|FINSI;
varalf = alfa1;
varalf = varalf + "       " + alfa2;
varalf = varalf + "                  " + alfa3;
varalf = varalf + "                       ";
canti   = canti % coefi;
importe = canti; |HAZ importe;
varalf = varalf + "     " + importe;
|HAZ imprime;
total = total + canti;
|FPRC;


|PROCESO inmuebleu;
|SI #1#48 = "X"; |O #1#48 = "R"; |ACABA; |FINSI;

tipoprop = #1#15;
canti = 0;
alfa2 = #1#72;
alfa3 = #1#5;
|SI #1#31 = "N";
    canti = #1#8;
    |SI canti < #1#17; canti = #1#17; |FINSI;
    |SI canti < #1#19; canti = #1#19; |FINSI;
    tipod = #1#2;
    |SI #1#15 ! "P"; anyou = #1#16; |HAZ calcuprop; |FINSI;
|FINSI;

|SI canti [ 0; |ACABA; |FINSI;
|SI tipo = "T";
   |SI #1#2 = "G"; coefi = 50;    |VETE abajo; |FINSI;
   |SI #1#2 = "T"; coefi = 100;   |VETE abajo; |FINSI;
   |SI #1#2 = "V"; coefi = #1#49; |VETE abajo; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "C";
   |SI #1#2 = "G"; coefi = 50;    |VETE abajo; |FINSI;
   |SI #1#2 = "C"; coefi = 100;   |VETE abajo; |FINSI;
   |SI #1#2 = "V"; coefi = #1#50; |VETE abajo; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "1";
   |SI #1#2 = "1"; coefi = 100;   |VETE abajo; |FINSI;
   |SI #1#2 = "V"; coefi = #1#51; |VETE abajo; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "2";
   |SI #1#2 = "2"; coefi = 100;   |VETE abajo; |FINSI;
   |SI #1#2 = "V"; coefi = #1#52; |VETE abajo; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "3";
   |SI #1#2 = "3"; coefi = 100;   |VETE abajo; |FINSI;
   |SI #1#2 = "V"; coefi = #1#53; |VETE abajo; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "4";
   |SI #1#2 = "4"; coefi = 100;   |VETE abajo; |FINSI;
   |SI #1#2 = "V"; coefi = #1#54; |VETE abajo; |FINSI;
   |ACABA;
|FINSI;

|ET abajo;
|SI #1#4  ! "U"; |ACABA; |FINSI;

#6#0 = #1#6;
#6#1 = #1#7;
|LEE 040#6=;
|SI FSalida ! 0; |DDEFECTO #6; |FINSI;

alfa1 = #1#15;
|SI alfa1 = "U"; alfa1 = "M"; |FINSI;
alfa2 = #1#72;
alfa3 = #1#5;

|HAZ carga1;
|FPRC;

|DEFBUCLE recapin1;
#1#1;
;
empresa, 01;
empresa, 99;
e;
NULL, inmuebleu;
|FIN;

|PROCESO carga2;
conta = conta + 1;

|SI swrrr = 0;
    varalf = ""; |HAZ imprime;
    varalf = ""; |HAZ imprime;
    varalf = "B) BIENES INMUEBLES DE NATURALEZA RUSTICA"; |HAZ imprime;
    varalf = "=" * 122; |HAZ imprime;
    varalf = "Clave   Referencia catastral      Municipio              ";
    varalf = varalf + "        Provincia           H.Regadio      H.Secano";
    varalf = varalf + "         Valor";
    |HAZ imprime;
    varalf = "=" * 122; |HAZ imprime;
    swrrr = 1;
|FINSI;
varalf = alfa1;
varalf = varalf + "       " + alfa4;
varalf = varalf + " " + alfa2;
varalf = varalf + "      " + alfa3;
importe = canti1; |HAZ importe;
varalf = varalf + " " + importe;
importe = canti2; |HAZ importe;
varalf = varalf + " " + importe;
canti   = canti % coefi;
importe = canti;                     |HAZ importe;
varalf = varalf + " " + importe;
|HAZ imprime;
total = total + canti;
|FPRC;

|PROCESO inmuebler;
|SI #1#48 = "X"; |O #1#48 = "R"; |ACABA; |FINSI;

tipoprop = #1#15;
canti = 0;
|SI #1#31 = "N";
    canti = #1#8;
    |SI canti < #1#17; canti = #1#17; |FINSI;
    |SI canti < #1#19; canti = #1#19; |FINSI;
    tipod = #1#2;
    |SI #1#15 ! "P"; anyou = #1#16; |HAZ calcuprop; |FINSI;
|FINSI;

|SI canti [ 0; |ACABA; |FINSI;
|SI tipo = "T";
   |SI #1#2 = "G"; coefi = 50;    |VETE abajo1; |FINSI;
   |SI #1#2 = "T"; coefi = 100;   |VETE abajo1; |FINSI;
   |SI #1#2 = "V"; coefi = #1#49; |VETE abajo1; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "C";
   |SI #1#2 = "G"; coefi = 50;    |VETE abajo1; |FINSI;
   |SI #1#2 = "C"; coefi = 100;   |VETE abajo1; |FINSI;
   |SI #1#2 = "V"; coefi = #1#50; |VETE abajo1; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "1";
   |SI #1#2 = "1"; coefi = 100;   |VETE abajo1; |FINSI;
   |SI #1#2 = "V"; coefi = #1#51; |VETE abajo1; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "2";
   |SI #1#2 = "2"; coefi = 100;  |VETE abajo1; |FINSI;
   |SI #1#2 = "V"; coefi = #1#52;|VETE abajo1; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "3";
   |SI #1#2 = "3"; coefi = 100;   |VETE abajo1; |FINSI;
   |SI #1#2 = "V"; coefi = #1#53; |VETE abajo1;|FINSI;
   |ACABA;
|FINSI;

|SI tipo = "4";
   |SI #1#2 = "4"; coefi = 100;  |VETE abajo1; |FINSI;
   |SI #1#2 = "V"; coefi = #1#54;|VETE abajo1; |FINSI;
   |ACABA;
|FINSI;

|ET abajo1;
|SI #1#4  ! "R"; |ACABA; |FINSI;

#6#0 = #1#6;
#6#1 = #1#7;
|LEE 040#6=;
|SI FSalida ! 0; |DDEFECTO #6; |FINSI;

alfa1 = #1#15;
|SI alfa1 = "U"; alfa1 = "M"; |FINSI;
alfa2 = #6#3;
alfa3 = #6#2;
alfa4 = #1#72;
canti1 = #1#11;
canti2 = #1#12;
|HAZ carga2;
|FPRC;

|DEFBUCLE recapin2;
#1#1;
;
empresa, 01;
empresa, 99;
e;
NULL, inmuebler;
|FIN;
|| *********************** De afectos a patrimonio inmuebles urbana *******

|PROCESO inmueblea;
#6#0 = #2#7;
#6#1 = #2#8;
|LEE 040#6=;
|SI FSalida ! 0; |DDEFECTO #6; |FINSI;

coefi = 100;
alfa1 = #2#15;
alfa2 = #2#16;
alfa3 = #2#5 + "  ";
canti = #2#9;

|SI #2#3 = "G";
    |SI tipo = "T"; coefi = 50; |HAZ carga1; |ACABA; |FINSI;
    |SI tipo = "C"; coefi = 50; |HAZ carga1; |ACABA; |FINSI;
|SINO;
    |SI tipo = #2#3; |HAZ carga1; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE repatria;
#2#1;
;
empresa, "A1", 001;
empresa, "A1", 999;
e;
NULL, inmueblea;
|FIN;

|| *********************** De afectos a patrimonio inmuebles rustico *******

|PROCESO inmuebleb;
#6#0 = #2#7;
#6#1 = #2#8;
|LEE 040#6=;
|SI FSalida ! 0; |DDEFECTO #6; |FINSI;

alfa1  = #2#15;
alfa2  = #6#3;
alfa3  = #6#2;
alfa4  = #2#16;
canti1 = #2#11;
canti2 = #2#10;
canti  = #2#9;
coefi  = 100;

|SI #2#3 = "G";
    |SI tipo = "T"; coefi = 50; |HAZ carga2; |ACABA; |FINSI;
    |SI tipo = "C"; coefi = 50; |HAZ carga2; |ACABA; |FINSI;
|SINO;
    |SI tipo = #2#3; |HAZ carga2; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE repatrib;
#2#1;
;
empresa, "B1", 001;
empresa, "B1", 999;
e;
NULL, inmuebleb;
|FIN;

|PROCESO calcuprop;
|SI tipoprop = "U";
    |SI tipod = "T"; anyos = anyo1;  |FINSI;
    |SI tipod = "C"; anyos = anyo2;  |FINSI;
    |SI tipod = "1"; anyos = anyo3;  |FINSI;
    |SI tipod = "2"; anyos = anyo4;  |FINSI;
    |SI tipod = "3"; anyos = anyo5;  |FINSI;
    |SI tipod = "4"; anyos = anyo6;  |FINSI;
    |SI tipod = "G"; anyos = anyo1;  |FINSI;
    |SI tipod = "V"; anyos = anyo1;  |FINSI;
    anyos = 1994 - anyos;
|SINO;
    anyos = anyou;
|FINSI;

|SI anyos [ 20; porce = 70; |FINSI;

|SI anyos > 20;
    porce = 70 - (anyos - 20);
    |SI porce < 10; porce = 10; |FINSI;
|FINSI;

|SI tipoprop = "N"; porce = 100 - porce; |FINSI;

canti = canti % porce;
|FPRC;

|PROGRAMA;
vuelve  = 1;

Impresora = impresor;

|IMPRE -1;
|SI FSalida = 0;
   |ABRE #6;
   total = 0;
   swrrr = 0;
   conta = 0; |BUCLE recapin1;
              |BUCLE repatria;

   |SI swrrr = 1;
       varalf = " " * 108;
       varalf = varalf + "--------------"; |HAZ imprime;
       importe = total;                     |HAZ importe;
       varalf = " " * 108;
       varalf = varalf + " " + importe;    |HAZ imprime;
   |FINSI;

   total = 0;
   swrrr = 0;
   conta = 0; |BUCLE recapin2;
              |BUCLE repatrib;

   |SI swrrr = 1;
       varalf = " " * 108;
       varalf = varalf + "--------------"; |HAZ imprime;
       importe = total;                     |HAZ importe;
       varalf = " " * 108;
       varalf = varalf + " " + importe;    |HAZ imprime;
   |FINSI;

   |CIERRA #6;

   |FINIMP;
   |CORRE "recompa2.run";
|FINSI;
|FPRO;
