|FICHEROS;
   retotren #2;
   refant05 #4;

   reempedi #5;
   reemprco #6;
   reempmod #3;
   reactafe #7;
   refant06 #8;
   repant50 #9;
|FIN;

|VARIABLES;
   &empresa  = 0;
   &nombre   = "";
   &nombrec  = "";
   &cif      = "";
   &cifc     = "";
   &anyos    = "";
   &anyosc   = "";
   &impresor = "";
   &diainf   = "";
   &mesinf   = "";
   &anyoinf  = "";
   &tipo     = "";
   &diad     = "   ";
   &mesd     = "   ";
   &diah     = "   ";
   &mesh     = "   ";
   &famili   = 0;
   &swdecl    = 0;
   &cuenta    = "";
   &fraccion  = "";
   &ingreso   = 0;
   &renuncia  = "";
   &papel     = 0;
   &sw_al60   = 0;
   &vuelve    = 0;
   &seleccion = "";
   &campo     = 0;
   &chequeo   = 0;
   &p_cen     = 0;
   &fichero   = "";
   &hoja1     = "";
   &hoja2     = "";
   &hoja3     = "";
   &hoja4     = "";
   &hoja5     = "";
   &hoja6     = "";
   &hoja7     = "";
   &hoja8     = "";
   &hoja9     = "";
   &hoja10    = "";
   &hoja11    = "";
   &hoja12    = "";
   &hoja13    = "";

   informe   = "";
   tipoa     = "";
   epi       = "";
   perce     = "";

   conta     = 0;
   conta1    = 0;
   conta2    = 0;
   var1      = 0;
   var2      = 0;
   var3      = 0;
   var4      = 0;
   var5      = 0;
   var6      = 0;
   var7      = 0;
   var8      = 0;
   var9      = 0;
   var10     = 0;
   var11     = 0;
   var12     = 0;
   var13     = 0;
   var14     = 0;
   var15     = 0;
   var16     = 0;
   var17     = 0;
   var18     = 0;
   var19     = 0;
   var20     = 0;
   var21     = 0;
   var22     = 0;
   var23     = 0;
   var24     = 0;
   var25     = 0;
   var26     = 0;
   coefi     = 0;
   desde     = 0;
   hasta     = 0;
   campo_d   = 0;
   unid      = 0;
   x         = 0;
|FIN;

|PROGRAMA;
vuelve = 1;
|SI papel = 2;
    |PINPA #0#9;
    #9#0 = empresa; |PINTA #9#0;
    #9#1 = nombre;  |PINTA #9#1;
|FINSI;

Impresora = impresor;
|IMPRE -1;
|SI FSalida = 0;
    |HAZ hoja5;
    |FINIMP;
    |CORRE "reem1003.run";
|FINSI;
|FPRO;

|| *************************************************************************
||                         IMPRESION HOJA 5, 6
|| *************************************************************************

|| ********************** Empresarial estimacion directa *******************

|PROCESO carga2;
conta1 = conta1 + 1;
|SI conta1 [ 3;
    var1 = conta1 - 1;
    var2 = var1   + 3;
    var3 = var2   + 3;
    #4var2 = #5#15;
    #4var3 = "Empresarial Directa";
|SINO;
    #4#5 = "-----------------------------------------";
    #4#8 = "Segun relaci¢n adjunta";
|FINSI;
|FPRC;

|PROCESO carga3;
conta2 = conta2 + 1;
|SI conta2 [ 3;
    var1  = conta2 + 8;  var2  = var1   + 3; var3  = var2   + 3;
    var4  = var3   + 3;  var5  = var4   + 3; var6  = var5   + 3;
    var7  = var6   + 3;  var8  = var7   + 3; var9  = var8   + 3;
    var10 = var9   + 3;  var11 = var10  + 3; var12 = var11  + 3;
    var13 = var12  + 3;  var14 = var13  + 3; var15 = var14  + 3;
    var14 = var13  + 3;  var15 = var14  + 3; var16 = var15  + 3;
    var17 = var16  + 3;  var18 = var17  + 3; var19 = var18  + 3;
    var20 = var19  + 3;  var21 = var20  + 3; var22 = var21  + 3;
    var23 = var22  + 3;  var24 = var23  + 3; var25 = var24  + 3;
    var26 = var1   - 9;

    #4var1  = (#5#17 % coefi);
    #4var2  = (#5#18 % coefi);
    #4var3  = ((#5#19 + #5#20) % coefi);
    #4var4  = ((#5#21 + #5#22) % coefi);
    #4var5  = (#5#23 % coefi);

    #4var6  = (#5#25 % coefi);
    #4var7  = (#5#26 % coefi);
    #4var8  = (#5#27 % coefi);
    #4var9  = (#5#28 % coefi);
    #4var10 = (#5#29 % coefi);
    #4var11 = (#5#31 % coefi);
    #4var12 = (#5#35 % coefi);
    #4var13 = (#5#24 % coefi);
    #4var14 = (#5#30 % coefi);
    #4var15 = (#5#33 % coefi);
    #4var16 = (#5#32 % coefi);
    #4var17 = (#5#36 % coefi);
    #4var18 = (#5#40 % coefi);
    #4var19 = ((#5#34 + #5#37 + #5#38 + #5#39 + #5#41) % coefi);

    #4var20 = (#5#42 % coefi);
    #4var21 = (#5#45 % coefi);
    #4var22 = (#5#46 % coefi);
    #4var23 = (#5#47 % coefi);
    #4var24 = (#5#48 % coefi);
    #4var25 = (#5#49 % coefi);
    #4var26 = perce;
|SINO;
    #4#11  = #4#11 + (#5#17 % coefi);
    #4#14  = #4#14 + (#5#18 % coefi);
    #4#17  = #4#17 + ((#5#19 + #5#20) % coefi);
    #4#20  = #4#20 + ((#5#21 + #5#22) % coefi);
    #4#23  = #4#23 + (#5#23 % coefi);

    #4#26  = #4#26 + (#5#25 % coefi);
    #4#29  = #4#29 + (#5#26 % coefi);
    #4#32  = #4#32 + (#5#27 % coefi);
    #4#35  = #4#35 + (#5#28 % coefi);
    #4#38  = #4#38 + (#5#29 % coefi);
    #4#41  = #4#41 + (#5#31 % coefi);
    #4#44  = #4#44 + (#5#35 % coefi);
    #4#47  = #4#47 + (#5#24 % coefi);
    #4#50  = #4#50 + (#5#30 % coefi);
    #4#53  = #4#53 + (#5#33 % coefi);
    #4#56  = #4#56 + (#5#32 % coefi);
    #4#59  = #4#59 + (#5#36 % coefi);
    #4#62  = #4#62 + (#5#40 % coefi);
    #4#65  = #4#65 + ((#5#34 + #5#37 + #5#38 + #5#39 + #5#41) % coefi);

    #4#68  = #4#68 + (#5#42 % coefi);
    #4#71  = #4#71 + (#5#45 % coefi);
    #4#74  = #4#74 + (#5#46 % coefi);
    #4#77  = #4#77 + (#5#47 % coefi);
    #4#80  = #4#80 + (#5#48 % coefi);
    #4#83  = #4#83 + (#5#49 % coefi);
    #4#2   = "Restantes";
|FINSI;
|FPRC;

|PROCESO directa;
|SI #5#4 = "X"; |O #5#4 = "P"; |ACABA; |FINSI;
|SI #5#5 = "N"; |ACABA; |FINSI;

|SI tipo = "A"; perce = #5#3; |SINO; perce = "TITULAR"; |FINSI;

|SI tipo = "A";
    |SI #5#2 = "V";
        coefi = #5#7 + #5#8 + #5#9 + #5#10 + #5#11 + #5#12;
        |HAZ carga2;
        |HAZ carga3;
        |ACABA;
    |FINSI;
    coefi = 100; |HAZ carga2; |HAZ carga3;
    |ACABA;
|FINSI;

|SI tipo = "T";
   |SI #5#2 = "G"; coefi = 50;   |HAZ carga2; |HAZ carga3; |ACABA; |FINSI;
   |SI #5#2 = "T"; coefi = 100;  |HAZ carga2; |HAZ carga3; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#7; |HAZ carga2; |HAZ carga3; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "C";
   |SI #5#2 = "G"; coefi = 50;    |HAZ carga2; |HAZ carga3; |ACABA; |FINSI;
   |SI #5#2 = "C"; coefi = 100;   |HAZ carga2; |HAZ carga3; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#8;  |HAZ carga2; |HAZ carga3; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "1";
   |SI #5#2 = "1"; coefi = 100;   |HAZ carga2; |HAZ carga3; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#9;  |HAZ carga2; |HAZ carga3; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "2";
   |SI #5#2 = "2"; coefi = 100;   |HAZ carga2; |HAZ carga3; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#10; |HAZ carga2; |HAZ carga3; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "3";
   |SI #5#2 = "3"; coefi = 100;   |HAZ carga2; |HAZ carga3; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#11; |HAZ carga2; |HAZ carga3; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "4";
   |SI #5#2 = "4"; coefi = 100;   |HAZ carga3; |HAZ carga3; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#12; |HAZ carga3; |HAZ carga3; |ACABA; |FINSI;
   |ACABA;
|FINSI;
|FPRC;

|DEFBUCLE reempedi;
#5#1;
;
empresa, 01;
empresa, 99;
e;
NULL, directa;
|FIN;

|| ********************** Profesionales Coeficientes ***********************

|PROCESO carga4;
conta1 = conta1 + 1;
|SI conta1 [ 3;
    var1 = conta1 - 1;
    var2 = var1   + 3;
    var3 = var2   + 3;
    #4var2 = #6#15;
    #4var3 = "Empresarial coeficientes";
|SINO;
    #4#5 = "-----------------------------------------";
    #4#8 = "Segun relaci¢n adjunta";
|FINSI;
|FPRC;

|PROCESO carga5;
conta2 = conta2 + 1;
|SI conta2 [ 3;
    var1  = conta2 - 1;  var2  = var1   + 3; var3  = var2   + 3;
    var4  = var3   + 3;  var5  = var4   + 3; var6  = var5   + 3;
    var7  = var6   + 3;  var8  = var7   + 3; var9  = var8   + 3;
    var10 = var9   + 3;  var11 = var10  + 3; var12 = var11  + 3;
    var13 = var12  + 3;  var14 = var13  + 3; var15 = var14  + 3;
    var16 = var15  + 3;  var17 = var16  + 3; var18 = var17  + 3;
    var19 = var18  + 3;  var20 = var19  + 3; var21 = var1   + 179;

    #8var1  = (#6#17 % coefi);
    #8var2  = (#6#18 % coefi);
    #8var3  = ((#6#39 + #6#40 - #6#38) % coefi);
    #8var4  = (#6#19 % coefi);
    #8var5  = (#6#20 % coefi);
    #8var6  = (#6#48 % coefi);
    #8var7  = (#6#21 % coefi);
    #8var8  = (#6#22 % coefi);
    #8var9  = (#6#23 % coefi);
    #8var10 = (#6#24 % coefi);
    #8var11 = #8var2 + #8var3 + #8var4 + #8var5 + #8var6 + #8var7 + #8var8 + #8var9 + #8var10;
    #8var12 = #8var1 - #8var11;
    #8var13 = (#6#25 % coefi);
    #8var14 = (#6#42 % coefi);
    #8var15 = (#6#26 % coefi);
    #8var16 = (#6#27 % coefi);
    #8var17 = (#6#28 % coefi);
    #8var18 = #8var15 - #8var16 - #8var17;
    #8var19 = (#6#29 % coefi);
    #8var20 = (#6#32 % coefi);
    #8var21 = perce;
|SINO;
    #8#2  = #8#2  + (#6#17 % coefi);
    #8#5  = #8#5  + (#6#18 % coefi);
    #8#8  = #8#8  + ((#6#39 + #6#40 - #6#38) % coefi);
    #8#11 = #8#11 + (#6#19 % coefi);
    #8#14 = #8#14 + (#6#20 % coefi);
    #8#17 = #8#17 + (#6#48 % coefi);
    #8#20 = #8#20 + (#6#21 % coefi);
    #8#23 = #8#23 + (#6#22 % coefi);
    #8#26 = #8#26 + (#6#23 % coefi);
    #8#29 = #8#29 + (#6#24 % coefi);
    #8#32 = #8#3 + #8#8 + #8#11 + #8#14 + #8#17 + #8#20 + #8#23 + #8#26 + #8#29;
    #8#35 = #8#2 - #8#32;
    #8#38 = #8#38 + (#6#25 % coefi);
    #8#41 = #8#41 + (#6#42 % coefi);
    #8#44 = #8#44 + (#6#26 % coefi);
    #8#47 = #8#47 + (#6#27 % coefi);
    #8#50 = #8#50 + (#6#28 % coefi);
    #8#53 = #8#44 - #8#47 - #8#50;
    #8#56 = #8#56 + (#6#29 % coefi);
    #8#59 = #8#59 + (#6#32 % coefi);
    #8#181 = "Restantes";
|FINSI;
|FPRC;

|PROCESO coeficie;
|SI #6#4 = "X"; |O #6#4 = "P"; |ACABA; |FINSI;
|SI #6#5 = "N"; |ACABA; |FINSI;

|SI tipo = "A"; perce = #6#3; |SINO; perce = "TITULAR"; |FINSI;

|SI tipo = "A";
    |SI #6#2 = "V";
        coefi = #6#7 + #6#8 + #6#9 + #6#10 + #6#11 + #6#12;
        |HAZ carga4;
        |HAZ carga5;
        |ACABA;
    |FINSI;
    coefi = 100; |HAZ carga4; |HAZ carga5;
    |ACABA;
|FINSI;

|SI tipo = "T";
   |SI #6#2 = "G"; coefi = 50;   |HAZ carga4; |HAZ carga5; |ACABA; |FINSI;
   |SI #6#2 = "T"; coefi = 100;  |HAZ carga4; |HAZ carga5; |ACABA; |FINSI;
   |SI #6#2 = "V"; coefi = #6#7; |HAZ carga4; |HAZ carga5; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "C";
   |SI #6#2 = "G"; coefi = 50;    |HAZ carga4; |HAZ carga5; |ACABA; |FINSI;
   |SI #6#2 = "C"; coefi = 100;   |HAZ carga4; |HAZ carga5; |ACABA; |FINSI;
   |SI #6#2 = "V"; coefi = #6#8;  |HAZ carga4; |HAZ carga5; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "1";
   |SI #6#2 = "1"; coefi = 100;   |HAZ carga4; |HAZ carga5; |ACABA; |FINSI;
   |SI #6#2 = "V"; coefi = #6#9;  |HAZ carga4; |HAZ carga5; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "2";
   |SI #6#2 = "2"; coefi = 100;   |HAZ carga4; |HAZ carga5; |ACABA; |FINSI;
   |SI #6#2 = "V"; coefi = #6#10; |HAZ carga4; |HAZ carga5; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "3";
   |SI #6#2 = "3"; coefi = 100;   |HAZ carga4; |HAZ carga5; |ACABA; |FINSI;
   |SI #6#2 = "V"; coefi = #6#11; |HAZ carga4; |HAZ carga5; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "4";
   |SI #6#2 = "4"; coefi = 100;   |HAZ carga4; |HAZ carga5; |ACABA; |FINSI;
   |SI #6#2 = "V"; coefi = #6#12; |HAZ carga4; |HAZ carga5; |ACABA; |FINSI;
   |ACABA;
|FINSI;
|FPRC;

|DEFBUCLE reemprco;
#6#1;
;
empresa, 01;
empresa, 99;
e;
NULL, coeficie;
|FIN;

|| ********************** Empresariales Modulos ****************************

|PROCESO carga7;
conta1 = conta1 + 1;
|SI conta1 [ 3;
    var1 = conta1 - 1;
    var2 = var1   + 3;
    var3 = var2   + 3;
    #4var2 = #3#15;
    #4var3 = "Empresarial Modulos";
|SINO;
    #4#5 = "-----------------------------------------";
    #4#8 = "Segun relacion adjunta";
|FINSI;
|FPRC;

|PROCESO carga1;
conta2 = conta2 + 1;
|SI conta2 [ 3;
    var1 = conta2 + 66;
    var2 = var1  + 3;
    epi    = #3#13 + " " + #3#14;
    #8var1 = epi;
    #8var2 = perce;

    |SI conta2 = 1;
        desde  = 73;
        #8#122 = #3#37 % coefi;
        #8#139 = #3#38 - 1;
        #8#140 = #3#40;
        #8#141 = #3#42;
        #8#148 = #3#44 % coefi;

        #8#151 = #3#47 % coefi;
        #8#152 = #3#48 % coefi;
        #8#153 = #8#148 - #8#151 - #8#152;
        #8#154 = #3#60 % coefi;
        #8#182 = #3#64 % coefi;
        #8#155 = #8#153 - (#8#154 + #8#182);
        #8#156 = #3#45 % coefi;
        #8#157 = #3#46 % coefi;
        #8#158 = #3#61 % coefi;
        #8#159 = #3#49 % coefi;
    |FINSI;

    |SI conta2 = 2;
        desde  = 80;
        #8#130 = #3#37 % coefi;
        #8#142 = #3#38 - 1;
        #8#143 = #3#40;
        #8#144 = #3#42;
        #8#149 = #3#44 % coefi;

        #8#160 = #3#47 % coefi;
        #8#161 = #3#48 % coefi;
        #8#162 = #8#149 - #8#160 - #8#161;
        #8#163 = #3#60 % coefi;
        #8#183 = #3#64 % coefi;
        #8#164 = #8#162 - (#8#163 + #8#183);
        #8#165 = #3#45 % coefi;
        #8#166 = #3#46 % coefi;
        #8#167 = #3#61 % coefi;
        #8#168 = #3#49 % coefi;
    |FINSI;

    |SI conta2 = 3;
        desde  = 87;
        #8#138 = #3#37 % coefi;
        #8#145 = #3#38 - 1;
        #8#146 = #3#40;
        #8#147 = #3#42;
        #8#150 = #3#44 % coefi;

        #8#169 = #3#47 % coefi;
        #8#170 = #3#48 % coefi;
        #8#171 = #8#150 - #8#169 - #8#170;
        #8#172 = #3#60 % coefi;
        #8#184 = #3#64 % coefi;
        #8#173 = #8#171 - (#8#172 + #8#184);
        #8#174 = #3#45 % coefi;
        #8#175 = #3#46 % coefi;
        #8#176 = #3#61 % coefi;
        #8#177 = #3#49 % coefi;
    |FINSI;

    hasta = desde + 6; campo_d = 15;                       || DEFINICIONES
    |PARA x = desde; |SI x [ hasta; |HACIENDO x = x + 1;
        campo_d = campo_d + 1;
        #8x = #3campo_d;
    |SIGUE;

    |SI conta2 = 1; desde = 94;  |FINSI;
    |SI conta2 = 2; desde = 101; |FINSI;
    |SI conta2 = 3; desde = 108; |FINSI;

    hasta = desde + 6; campo_d = 22;                       || NUMEROS
    |PARA x = desde; |SI x [ hasta; |HACIENDO x = x + 1;
        campo_d = campo_d + 1;
        #8x = #3campo_d % coefi;
    |SIGUE;

    |SI conta2 = 1; desde = 115; |FINSI;
    |SI conta2 = 2; desde = 123; |FINSI;
    |SI conta2 = 3; desde = 131; |FINSI;

    hasta = desde + 6; campo_d = 29; unid = 22;             || RENDIMIENTOS
    |PARA x = desde; |SI x [ hasta; |HACIENDO x = x + 1;
        campo_d = campo_d + 1;
        unid  = unid  + 1;
        #8x = (#3unid * #3campo_d) % coefi;
    |SIGUE;
|SINO;
    #8#72 = "Segun relacion adjunta";
    #8#69 = "----------";

    |PARA x = 87; |SI x [ 93; |HACIENDO x = x + 1;
          #8x = "";
    |SIGUE;
    |PARA x = 108; |SI x [ 114; |HACIENDO x = x + 1;
          #8x = 0;
    |SIGUE;
    |PARA x = 131; |SI x [ 138; |HACIENDO x = x + 1;
          #8x = 0;
    |SIGUE;

    #8#145 = 0; #8#146 = 0; #8#147 = 0;

    #8#150 = #8#150 + (#3#44 % coefi);
    #8#169 = #8#169 + (#3#47 % coefi);
    #8#170 = #8#170 + (#3#48 % coefi);
    #8#171 = #8#150 - #8#169 - #8#170;
    #8#172 = #8#172 + (#3#60 % coefi);
    #8#184 = #8#184 + (#3#64 % coefi);
    #8#173 = #8#171 - (#8#172 + #8#184);
    #8#174 = #8#174 + (#3#45 % coefi);
    #8#175 = #8#175 + (#3#46 % coefi);
    #8#176 = #8#176 + (#3#61 % coefi);
    #8#177 = #8#177 + (#3#49 % coefi);
|FINSI;
|FPRC;

|PROCESO modulos;
|SI #3#4 = "X"; |O #3#4 = "P"; |ACABA; |FINSI;
|SI #3#5 = "N"; |ACABA; |FINSI;

|SI tipo = "A"; perce = #3#3; |SINO; perce = "TITULAR"; |FINSI;

|SI tipo = "A";
    |SI #3#2 = "V";
        coefi = #3#7 + #3#8 + #3#9 + #3#10 + #3#11 + #3#12;
        |HAZ carga7; |HAZ carga1;
        |ACABA;
    |FINSI;
    coefi = 100; |HAZ carga7; |HAZ carga1;
    |ACABA;
|FINSI;

|SI tipo = "T";
   |SI #3#2 = "G"; coefi = 50;   |HAZ carga7; |HAZ carga1; |ACABA; |FINSI;
   |SI #3#2 = "T"; coefi = 100;  |HAZ carga7; |HAZ carga1; |ACABA; |FINSI;
   |SI #3#2 = "V"; coefi = #3#7; |HAZ carga7; |HAZ carga1; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "C";
   |SI #3#2 = "G"; coefi = 50;   |HAZ carga7; |HAZ carga1; |ACABA; |FINSI;
   |SI #3#2 = "C"; coefi = 100;  |HAZ carga7; |HAZ carga1; |ACABA; |FINSI;
   |SI #3#2 = "V"; coefi = #3#8; |HAZ carga7; |HAZ carga1; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "1";
   |SI #3#2 = "1"; coefi = 100;  |HAZ carga7; |HAZ carga1; |ACABA; |FINSI;
   |SI #3#2 = "V"; coefi = #3#9; |HAZ carga7; |HAZ carga1; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "2";
   |SI #3#2 = "2"; coefi = 100;   |HAZ carga7; |HAZ carga1; |ACABA; |FINSI;
   |SI #3#2 = "V"; coefi = #3#10; |HAZ carga7; |HAZ carga1; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "3";
   |SI #3#2 = "3"; coefi = 100;   |HAZ carga7; |HAZ carga1; |ACABA; |FINSI;
   |SI #3#2 = "V"; coefi = #3#11; |HAZ carga7; |HAZ carga1; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "4";
   |SI #3#2 = "4"; coefi = 100;   |HAZ carga7; |HAZ carga1; |ACABA; |FINSI;
   |SI #3#2 = "V"; coefi = #3#12; |HAZ carga7; |HAZ carga1; |ACABA; |FINSI;
   |ACABA;
|FINSI;
|FPRC;

|DEFBUCLE reempmod;
#3#1;
;
empresa, 01;
empresa, 99;
e;
NULL, modulos;
|FIN;

|| ********************** Activos fijos directa ****************************

|PROCESO carga6;
conta2 = conta2 + 1;
|SI conta2 [ 9;
    var1 = conta2 + 88; var2 = var1  + 12;
    var3 = var2  + 12; var4 = var3  + 12; var5 = var4  + 12;
    #4var1 = #7#7;
    #4var2 = #7#24;
    #4var3 = #7#26;
    #4var4 = #7#29;
    #4var5 = #7#34;
|SINO;
    #4#100 = "Segun relacion adjunta";
    #4#112 = #4#112 + #7#24;
    #4#124 = #4#124 + #7#26;
    #4#136 = #4#136 + #7#29;
    #4#148 = #4#148 + #7#34;
|FINSI;
|FPRC;

|PROCESO activod;
|SI #7#29 = 0; |ACABA; |FINSI;
|SI #7#37 = "X"; |O #7#37 = "P"; |ACABA; |FINSI;

|SI tipo = "A";
    |SI #7#4 = "V";
        coefi = #7#38 + #7#39 + #7#40 + #7#41 + #7#42 + #7#43;
        |HAZ carga6;
        |ACABA;
    |FINSI;
    coefi = 100; |HAZ carga6;
    |ACABA;
|FINSI;

|SI tipo = "T";
   |SI #7#4 = "G"; coefi = 50;    |HAZ carga6; |ACABA; |FINSI;
   |SI #7#4 = "T"; coefi = 100;   |HAZ carga6; |ACABA; |FINSI;
   |SI #7#4 = "V"; coefi = #7#38; |HAZ carga6; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "C";
   |SI #7#4 = "G"; coefi = 50;    |HAZ carga6; |ACABA; |FINSI;
   |SI #7#4 = "C"; coefi = 100;   |HAZ carga6; |ACABA; |FINSI;
   |SI #7#4 = "V"; coefi = #7#39; |HAZ carga6; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "1";
   |SI #7#4 = "1"; coefi = 100;   |HAZ carga6; |ACABA; |FINSI;
   |SI #7#4 = "V"; coefi = #7#40; |HAZ carga6; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "2";
   |SI #7#4 = "2"; coefi = 100;   |HAZ carga6; |ACABA; |FINSI;
   |SI #7#4 = "V"; coefi = #7#41; |HAZ carga6; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "3";
   |SI #7#4 = "3"; coefi = 100;   |HAZ carga6; |ACABA; |FINSI;
   |SI #7#4 = "V"; coefi = #7#42; |HAZ carga6; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI tipo = "4";
   |SI #7#4 = "4"; coefi = 100;   |HAZ carga6; |ACABA; |FINSI;
   |SI #7#4 = "V"; coefi = #7#43; |HAZ carga6; |ACABA; |FINSI;
   |ACABA;
|FINSI;
|FPRC;

|DEFBUCLE reactaf1;
#7#1;
2;
empresa, 01, "ED";
empresa, 99, "ED";
e;
NULL, activod;
|FIN;

|PROCESO hoja5;
|DDEFECTO #4;
|DDEFECTO #8;

conta1 = 0;
conta2 = 0; |BUCLE reempedi;
conta2 = 0; |BUCLE reemprco;
conta2 = 0; |BUCLE reempmod;
conta2 = 0; |BUCLE reactaf1;

|ABRE #2;
#2#0 = empresa;
#2#141 = tipo;
|LEE 040#2=;
|SI FSalida ! 0; |DDEFECTO #2; |FINSI;
|CIERRA #2;

#4#84 = #2#18;
#4#85 = #4#66 + #4#67 + #4#68;
#4#86 = #4#69 + #4#70 + #4#71;
#4#87 = #4#78 + #4#79 + #4#80;
#4#88 = #2#19;

#8#60  = #2#20;
#8#61  = #8#30  + #8#31  + #8#32;
#8#62  = #8#36  + #8#37  + #8#38;
#8#63  = #8#39  + #8#40  + #8#41;
#8#64  = #8#51  + #8#52  + #8#53;
#8#65  = #8#54  + #8#55 +  #8#56;
#8#66  = #2#21;

#8#122 = #8#115 + #8#116 + #8#117 + #8#118 + #8#119 + #8#120 + #8#121;
#8#130 = #8#123 + #8#124 + #8#125 + #8#126 + #8#127 + #8#128 + #8#129;
#8#138 = #8#131 + #8#132 + #8#133 + #8#134 + #8#135 + #8#136 + #8#137;
#8#178 = #2#22;

|SI papel = 1;
    informe = "reho1005"; |HAZ continuo;
|SINO;
    informe = "rema1005"; |HAZ manual;
|FINSI;

|SI papel = 1;
    informe = "reho1006"; |HAZ continuo;
|SINO;
    informe = "rema1006"; |HAZ manual;
|FINSI;
|FPRC;

|PROCESO continuo;
|SI informe = "reho1005"; |Y hoja5 = "N"; |ACABA; |FINSI;
|SI informe = "reho1006"; |Y hoja6 = "N"; |ACABA; |FINSI;

|INFOR informe;
|SI FSalida = 0;
    |PRINT; |PIEINF; |FININF;
|FINSI;
|FPRC;

|PROCESO manual;
|SI informe = "rema1005"; |Y hoja5 = "N"; |ACABA; |FINSI;
|SI informe = "rema1006"; |Y hoja6 = "N"; |ACABA; |FINSI;

|ET comienzo;
    |SI informe = "rema1005";
        #9#2 = "COLOQUE PAGINA 5 DEL MODELO 100, <INTRO PARA IMPRIMIR>";
    |FINSI;
    |SI informe = "rema1006";
        #9#2 = "COLOQUE PAGINA 6 DEL MODELO 100, <INTRO PARA IMPRIMIR>";
    |FINSI;

    |ATRI P; |PINTA #9#2; |ATRI 0;
    |PAUSA;

    |INFOR informe;
    |SI FSalida = 0;
        |PRINT; |PIEINF; |FININF;
    |FINSI;

    |CONFI "2400NDesea repetir la hoja : ";
    |SI FSalida = 0; |VETE comienzo; |FINSI;
|FPRC;
