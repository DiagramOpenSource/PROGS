|FICHEROS
   retotren #0;
   repacalc #1;
   redatcon #3;
   reparame #4;
   retotpat #6;
   reincide #7;
   repartid #8;
   reliquid #10;
   retotrea #11;
|FIN;

|VARIABLES;
   FEstado   = 0;
   feini     = @;
   fefin     = @;
   dias      = 0;
   &incisino = "";
   &modo     = 0;
   &empresa  = 0;
   &emprefi  = 0;
   &nombre   = "";
   &lininci  = 0;
   &swcalcu  = 0;
   &minusva1 = "";
   &minusva2 = "";
   &minusva3 = "";
   &minusva4 = "";
   &minusva5 = "";
   &minusva6 = "";
   &declara  = "";
   &individu = 0;
   &acceso   = 0;
   &recalcu  = 0;
   &tippar   = 0;
   &parte1   = 0.0000;
   &parte2   = 0.0000;
   &muerto   = "";
   &fecpar   = @;
   &netot    = 0;
   &netoc    = 0;
   &netoa    = 0;
   &trabat   = 0;
   &trabac   = 0;
   &trabaa   = 0;
   &obitus   = 0;
|FIN;

|INCLUYE i_cambio;

|PROCESO liqborra;
 |BORRA 020#0a;
|FPRC;

|PROCESO patborra;
 |BORRA 020#6a;
 |LIBERA #6;
|FPRC;

|PROCESO adjborra;
  |BORRA 020#11a;
  |LIBERA #11;
|FPRC;

|PROCESO borrainci;
  |BORRA 020#7a;
  |LIBERA #7;
|FPRC;

|PROCESO borrapant;
  |BORRA 020#10a;
  |LIBERA #10;
|FPRC;

|DEFBUCLE borraliq;
#0#1;
;
empresa," ";
emprefi,"z";
be;
NULL,liqborra;
|FIN;

|DEFBUCLE borrapat;
#6#1;
;
empresa," ";
emprefi,"z";
be;
NULL,patborra;
|FIN;

|DEFBUCLE borraadj;
#11#1;
;
empresa," ";
emprefi,"z";
be;
NULL,adjborra;
|FIN;

|DEFBUCLE borrainc;
#7#1;
3;
empresa, 0001, "S";
emprefi, 9999, "S";
be;
NULL,borrainci;
|FIN;

|DEFBUCLE borrapan;
#10#1;
;
empresa;
emprefi;
be;
NULL,borrapant;
|FIN;

|PROCESO acalcula;  |TIPO 3;
  |SI FSalida ! 0;
      |ACABA;
  |FINSI;

  |ABRE #4;
  |LEE 040#4p;
  |SI FSalida = 0;
      incisino = #4#10;
  |FINSI;
  |CIERRA #4;

  |ATRI P;
  |CUADRO 1926 2150;
  |PINTA 2027, " ESTOY CALCULANDO .... ";
  |ATRI 0;

  empresa = #1#0;
  emprefi = #1#0;
  obitus = #1#9;

  feini = "01.01.1994";
  fefin = fecpar;
  dias = fefin - feini + 1;
  parte1 = (( 100 * dias ) / 36500) ! 4;
  parte2 = 1 - parte1;

  swcalcu = 0;
  lininci = 0;
  recalcu = 2;


  |BUCLE borraliq;  || Borra la liquidacion si ya la hubiera
  |BUCLE borrapat;  || Borra patrimonio
  |BUCLE borraadj;  || Borra liquidacion adjunta
  |BUCLE borrainc;  || Borra incidencias
  |BUCLE borrapan;  || Borra Pantalla Liquidacion;

||ATENCION !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
  |ABRE #3;
  #3#0 = empresa;
  |LEE 040#3=;
  |SI FSalida ! 0; |DDEFECTO #3; |FINSI;
  minusva1 = #3#5;
  minusva2 = #3#31;
  minusva3 = #3#88;
  minusva4 = #3#89;
  minusva5 = #3#90;
  minusva6 = #3#91;
  netot = #1#3;
  netoc = #1#4;
  netoa = #1#7;
  trabac = #1#6;
  trabat = #1#5;
  trabaa = #1#8;
  individu = 0;
  |SI #3#34 = "X";
      individu = 1;
  |FINSI;
  |CIERRA #3;
  |CIERRA #8;
  |CORRE "recalpa1.run";
|FPRC;

|PROCESO sacaimpo;
  |ABRE #8;
  #8#0 = #1#0;
  |LEE 010#8=;
  |SI FSalida ! 0;
      |MENAV "      Error no Existe el Codigo Especificado";
      |CIERRA #8;
      |ERROR;
      |ACABA;
  |FINSI;
  tippar  = #8#3;
  muerto  = #8#5;
  |SI #8#3 = 2;
      fecpar = #8#4;
  |SINO;
      fecpar = #8#6;
  |FINSI;
  |SI #8#3 ! 2;
      |CAMPO_MODIFICA #1#9, 1, "N"
  |FINSI;
  |CIERRA #8;

  |ABRE #0;
  #0#0 = #1#0;
  #0#141 = "T";
  |LEE 010#0=;
  |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
  #1#3 = #0#5;
  #1#5 = #0#32 + #0#54;
  |LIBERA #0;

  #0#0 = #1#0;
  #0#141 = "C";
  |LEE 010#0=;
  |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
  #1#4 = #0#5;
  #1#6 = #0#32 + #0#54;

  #0#0 = #1#0;
  #0#141 = "A";
  |LEE 010#0=;
  |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
  #1#7 = #0#5;
  #1#8 = #0#32 + #0#54;

  ||PINTA #1#3;
  ||PINTA #1#4;
  ||PINTA #1#5;
  ||PINTA #1#6;
  ||PINTA #1#7;
  ||PINTA #1#8;
  |LIBERA #0;
  |CIERRA #0;
|FPRC;
