|FICHEROS;
    rey00107 #0;
    rem00100 #1;    || datos contribuyentes
    rem00002 #2;    || inmuebles
    rem00010 #3;    || modelo 213
    rem00011 #4;    || modelo 213 Relacion inmuebles
    rem00012 #5;    || modelo 213 Relacion socios

    rew00009 #11;   || tmp.comprobacion
    rehacien #12;    || datos hacienda
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;

    &enJustif = 0;
    &Temporal = "";
    &Cliente01 = 0;
    &Cliente02 = 0;
    &Cliente03 = 0;
    &Cliente04 = 0;
    &Cliente05 = 0;
    &Cliente06 = 0;
    &Cliente07 = 0;
    &Cliente08 = 0;
    &Cliente09 = 0;
    &Cliente10 = 0;
    &Cliente11 = 0;
    &Cliente12 = 0;
    &Cliente13 = 0;
    &Cliente14 = 0;
    &Cliente15 = 0;
    &Cliente16 = 0;
    &Cliente17 = 0;
    &Cliente18 = 0;

    &Firma = "";
    &Mes = "";  MesNum = 0;

    &enNumInm  = 0;
    &enNumPag  = 0;
    &enContPag = 0;
    &eaDel1    = "";
    &eaDel2    = "";
    &eaDel3    = "";
    &eaDel4    = "";
    &eaDel5    = "";

    nSw     = 0;
    aDeleg  = "";
    aAdmin  = "";
    aAlfa   = "";
    aAlfa1  = "";
    nCalc   = 0;
    nCalc1  = 0;
    nDel    = 0;
    nAdm    = 0;
    nInm    = 0;
    nDeleg  = 0;
    nAdmin  = 0;
    nNumDel = 0;
    nNumSocs = 0;
    aDeleg1 = ""; aDeleg2 = ""; aDeleg3 = "";
    aDeleg4 = ""; aDeleg5 = ""; aDeleg6 = "";
    aAdmin1 = ""; aAdmin2 = ""; aAdmin3 = "";
    aAdmin4 = ""; aAdmin5 = ""; aAdmin6 = "";
    nNumIn1 = 0;  nNumIn2 = 0;  nNumIn3 = 0;
    nNumIn4 = 0;  nNumIn5 = 0;  nNumIn6 = 0;

    Empresa = 0;
|FIN;

|INCLUYE i_consul;
____________________________________/

|PROCESO Entero;
   aAlfa = nCalc;
   aAlfa = aAlfa - ".";
   |SI FSalida ! 0;
      nCalc = ((FSalida / 100) ! 0) + 99;
      aAlfa = aAlfa % nCalc;
   |FINSI;
   nCalc = aAlfa;
|FPRC;

|PROCESO ImprimeDatos;
   |PUSHV 1010 1570;
   |BLANCO 1010 1570;
   |CUADRO 1010 1570;
   |PINTA 1111, "Cliente : ";
   |PINTA 1121, #rem00010#0; |PINTA 1127, #rem00100#5;
   |SI nSw = 1;
      aAlfa = "Coloque el papel de la portada del modelo";
      aAlfa1 = "";
   |FINSI;
   |SI nSw = 2;
      aAlfa = "Coloque el papel de la relacion de inmuebles del modelo";
      aAlfa1 = "Pagina " + enNumPag + " de " + enContPag;
   |FINSI;
   |SI nSw = 3;
      aAlfa = "Coloque el papel de la relacion de socios del modelo";
      aAlfa1 = "Pagina " + enNumPag + " de " + enContPag;
   |FINSI;
   |PINTA 1311, aAlfa;
   |PINTA 1411, aAlfa1;
   |PAUSA; |POPV;
|FPRC;

|PROCESO RevisaInm;
   aAlfa  = #rem00011#14; |QBF aAlfa;  aAlfa  = ("00"  + aAlfa)  % -102;
   aAlfa1 = #rem00011#15; |QBF aAlfa1; aAlfa1 = ("000" + aAlfa1) % -103;
   |SI aDeleg1 = "";
      aDeleg1 = aAlfa; nNumIn1 = 1;
      aAdmin1 = aAlfa1;
   |SINO;
      |SI aAlfa ! aDeleg1;
         |SI aDeleg2 = "";
            aDeleg2 = aAlfa; nNumIn2 = 1;
            aAdmin2 = aAlfa1;
         |SINO;
            |SI aAlfa ! aDeleg2;
               |SI aDeleg3 = "";
                  aDeleg3 = aAlfa; nNumIn3 = 1;
                  aAdmin3 = aAlfa1;
               |SINO;
                  |SI aAlfa ! aDeleg3;
                     |SI aDeleg4 = "";
                        aDeleg4 = aAlfa; nNumIn4 = 1;
                        aAdmin4 = aAlfa1;
                     |SINO;
                        |SI aAlfa ! aDeleg4;
                           |SI aDeleg5 = "";
                              aDeleg5 = aAlfa; nNumIn5 = 1;
                              aAdmin5 = aAlfa1;
                           |SINO;
                              |SI aAlfa ! aDeleg5;
                                 |SI aDeleg6 = "";
                                    aDeleg6 = aAlfa; nNumIn6 = 1;
                                    aAdmin6 = aAlfa1;
                                 |SINO;
                                    |SI aAlfa = aDeleg6;
                                       nNumIn6 = nNumIn6 + 1;
                                    |FINSI;
                                 |FINSI;
                              |SINO;
                                 nNumIn5 = nNumIn5 + 1;
                              |FINSI;
                           |FINSI;
                        |SINO;
                           nNumIn4 = nNumIn4 + 1;
                        |FINSI;
                     |FINSI;
                  |SINO;
                     nNumIn3 = nNumIn3 + 1;
                  |FINSI;
               |FINSI;
            |SINO;
               nNumIn2 = nNumIn2 + 1;
            |FINSI;
         |FINSI;
      |SINO;
         nNumIn1 = nNumIn1 + 1;
      |FINSI;
   |FINSI;

|FPRC;

|DEFBUCLE RevisaInm;
#rem00011#1;
;
#rem00010#0, #rem00010#1, 01;
#rem00010#0, #rem00010#1, 99;
;
NULL,RevisaInm;
|FIN;

|PROCESO LeeHacienda;
   aDeleg = ""; aAdmin = "";
   #rehacien#0 = nDel;
   #rehacien#1 = nAdm;
   |SI nAdm = 0;
      |LEE 000#rehacien.];
   |SINO;
      |LEE 000#rehacien.=;
   |FINSI;
   |SI FSalida = 0; |Y #rehacien#0 = nDel;
      aDeleg = #rehacien#2;
      aAdmin = #rehacien#3;
   |FINSI;
|FPRC;

|PROCESO ModeloInm;
   enNumInm = enNumInm + 1; nCalc = enNumInm - 1;
   nCalc1 = nCalc / 7;   nCalc = nCalc / 7; |HAZ Entero;
   |SI nCalc = nCalc1;
      enNumPag = enNumPag + 1;
      nSw = 2; |HAZ ImprimeDatos;
   |FINSI;
   nAdm = 0;
   |SI nNumDel = 1;
      nDel = aDeleg2; |HAZ LeeHacienda; eaDel1 = aDeleg;
      nDel = aDeleg3; |HAZ LeeHacienda; eaDel2 = aDeleg;
      nDel = aDeleg4; |HAZ LeeHacienda; eaDel3 = aDeleg;
      nDel = aDeleg5; |HAZ LeeHacienda; eaDel4 = aDeleg;
      nDel = aDeleg6; |HAZ LeeHacienda; eaDel5 = aDeleg;
   |FINSI;
   |SI nNumDel = 2;
      nDel = aDeleg1; |HAZ LeeHacienda; eaDel1 = aDeleg;
      nDel = aDeleg3; |HAZ LeeHacienda; eaDel2 = aDeleg;
      nDel = aDeleg4; |HAZ LeeHacienda; eaDel3 = aDeleg;
      nDel = aDeleg5; |HAZ LeeHacienda; eaDel4 = aDeleg;
      nDel = aDeleg6; |HAZ LeeHacienda; eaDel5 = aDeleg;
   |FINSI;
   |SI nNumDel = 3;
      nDel = aDeleg1; |HAZ LeeHacienda; eaDel1 = aDeleg;
      nDel = aDeleg2; |HAZ LeeHacienda; eaDel2 = aDeleg;
      nDel = aDeleg4; |HAZ LeeHacienda; eaDel3 = aDeleg;
      nDel = aDeleg5; |HAZ LeeHacienda; eaDel4 = aDeleg;
      nDel = aDeleg6; |HAZ LeeHacienda; eaDel5 = aDeleg;
   |FINSI;
   |SI nNumDel = 4;
      nDel = aDeleg1; |HAZ LeeHacienda; eaDel1 = aDeleg;
      nDel = aDeleg2; |HAZ LeeHacienda; eaDel2 = aDeleg;
      nDel = aDeleg3; |HAZ LeeHacienda; eaDel3 = aDeleg;
      nDel = aDeleg5; |HAZ LeeHacienda; eaDel4 = aDeleg;
      nDel = aDeleg6; |HAZ LeeHacienda; eaDel5 = aDeleg;
   |FINSI;
   |SI nNumDel = 5;
      nDel = aDeleg1; |HAZ LeeHacienda; eaDel1 = aDeleg;
      nDel = aDeleg2; |HAZ LeeHacienda; eaDel2 = aDeleg;
      nDel = aDeleg3; |HAZ LeeHacienda; eaDel3 = aDeleg;
      nDel = aDeleg4; |HAZ LeeHacienda; eaDel4 = aDeleg;
      nDel = aDeleg6; |HAZ LeeHacienda; eaDel5 = aDeleg;
   |FINSI;
   |SI nNumDel = 6;
      nDel = aDeleg1; |HAZ LeeHacienda; eaDel1 = aDeleg;
      nDel = aDeleg2; |HAZ LeeHacienda; eaDel2 = aDeleg;
      nDel = aDeleg3; |HAZ LeeHacienda; eaDel3 = aDeleg;
      nDel = aDeleg4; |HAZ LeeHacienda; eaDel4 = aDeleg;
      nDel = aDeleg5; |HAZ LeeHacienda; eaDel5 = aDeleg;
   |FINSI;
   |PRINT;
|FPRC;

|DEFBUCLE ModeloInm;
#rem00011#1;
14;
#rem00010#0, #rem00010#1, 01, nDeleg;
#rem00010#0, #rem00010#1, 99, nDeleg;
;
NULL,ModeloInm;
|FIN;

|PROCESO RevisaSocios;
   nNumSocs = nNumSocs + 1;
|FPRC;

|DEFBUCLE RevisaSocios;
#rem00012#1;
;
#rem00010#0, #rem00010#1, 01;
#rem00010#0, #rem00010#1, 99;
;
NULL,RevisaSocios;
|FIN;

|PROCESO ModeloSoc;
   nNumSocs = nNumSocs + 1; nCalc = nNumSocs - 1;
   nCalc1 = nCalc / 7;   nCalc = nCalc / 7; |HAZ Entero;
   |SI nCalc = nCalc1;
      enNumPag = enNumPag + 1;
      nSw = 3; |HAZ ImprimeDatos;
   |FINSI;
   |PRINT;
|FPRC;

|DEFBUCLE ModeloSoc;
#rem00012#1;
;
#rem00010#0, #rem00010#1, 01;
#rem00010#0, #rem00010#1, 99;
;
NULL,ModeloSoc;
|FIN;

|PROCESO Modelo;

   nDeleg = 0; nAdmin = 0;
   |SI nNumDel = 1; |Y nNumIn1 ! 0; nDeleg = aDeleg1; nAdmin = aAdmin1; nInm = nNumIn1; |FINSI;
   |SI nNumDel = 2; |Y nNumIn2 ! 0; nDeleg = aDeleg2; nAdmin = aAdmin2; nInm = nNumIn2; |FINSI;
   |SI nNumDel = 3; |Y nNumIn3 ! 0; nDeleg = aDeleg3; nAdmin = aAdmin3; nInm = nNumIn3; |FINSI;
   |SI nNumDel = 4; |Y nNumIn4 ! 0; nDeleg = aDeleg4; nAdmin = aAdmin4; nInm = nNumIn4; |FINSI;
   |SI nNumDel = 5; |Y nNumIn5 ! 0; nDeleg = aDeleg5; nAdmin = aAdmin5; nInm = nNumIn5; |FINSI;
   |SI nNumDel = 6; |Y nNumIn6 ! 0; nDeleg = aDeleg6; nAdmin = aAdmin6; nInm = nNumIn6; |FINSI;
   nDel = nDeleg; nAdm = nAdmin;
   |DEBUG;
   enJustif = #rem00010#12; enJustif = enJustif + (nNumDel - 1);

   #rem00100#69 = nDel;
   #rem00100#70 = nAdm;
   |HAZ LeeHacienda;
   #rem00100#71 = aDeleg;
   #rem00100#72 = aAdmin;

   nSw = 1; |HAZ ImprimeDatos;
   |INFOR "m213h001";   |PRINT;   |PIEINF;  |FININF;

   |SI nDeleg ! 0;
      nCalc = nInm - 1; nCalc = nCalc / 7; |HAZ Entero; nCalc = nCalc + 1;
      enContPag = nCalc; enNumPag = 0; enNumInm = 0;
      |INFOR "m213h002";   |BUCLE ModeloInm;   |PIEINF;  |FININF;
   |FINSI;

   |SI #rem00010#2 = "1";
      nNumSocs = 0; |BUCLE RevisaSocios;
      nCalc = nNumSocs - 1; nCalc = nCalc / 6; |HAZ Entero; nCalc = nCalc + 1;
      enContPag = nCalc; enNumPag = 0; nNumSocs = 0;
      |INFOR "m213h003";   |BUCLE ModeloSoc;   |PIEINF;  |FININF;
   |FINSI;
|FPRC;

|PROCESO Impresora;
   aDeleg1 = ""; aDeleg2 = ""; aDeleg3 = ""; aDeleg4 = ""; aDeleg5 = ""; aDeleg6 = "";
   nNumIn1 = 0;  nNumIn2 = 0;  nNumIn3 = 0;  nNumIn4 = 0;  nNumIn5 = 0;  nNumIn6 = 0;
   |BUCLE RevisaInm;
   |SI aDeleg1 ! ""; nNumDel = 1; |HAZ Modelo; |FINSI;
   |SI aDeleg2 ! ""; nNumDel = 2; |HAZ Modelo; |FINSI;
   |SI aDeleg3 ! ""; nNumDel = 3; |HAZ Modelo; |FINSI;
   |SI aDeleg4 ! ""; nNumDel = 4; |HAZ Modelo; |FINSI;
   |SI aDeleg5 ! ""; nNumDel = 5; |HAZ Modelo; |FINSI;
   |SI aDeleg6 ! ""; nNumDel = 6; |HAZ Modelo; |FINSI;
|FPRC;

|PROCESO Emite;
    #3#0 = #2#0;
    #3#1 = #2#1;
    |LEE 101#3=;                        || lee modelo 213 (rem00010)
    |SI FSalida ! 0;
       |ACABA;
    |SINO;
       #3#11 = "S"; |GRABA 020#3a;     || impreso SI
    |FINSI;
    |LIBERA #3;

    seleccio = 1;

    |DDEFECTO #4;
    #4#0 = #1#69;
    #4#1 = #1#70;
    |LEE 000#4=;        || datos hacienda

    |HAZ Impresora;
|FPRC;

|DEFBUCLE Emite;
 #2#1;
 ;
 #1#0,  1;
 #1#0, 99;
 ;
 NULL, Emite;
|FIN;

|PROCESO Tipo3;
|ABRE #1;       || datos contribuyentes
|ABRE #3;       || modelo 213
|ABRE #12;       || datos hacienda
|PARA Empresa = 0; |SI Empresa [ 17; |HACIENDO Empresa = Empresa + 1;
    |SI #0Empresa ! 0;
            #1#0 = #0Empresa;
        |LEE 000#1=;
        |SI FSalida = 0;|Y #1#10 = "N";
            |BUCLE Emite;
        |FINSI;
    |FINSI;
|SIGUE;
|SI seleccio = 0;|Y Temporal = "";
    |MENAV "    Seleccion vacia ...";
|FINSI;
|CIERRA #1;
|CIERRA #3;
|CIERRA #12;
|FPRC;

|PROCESO MiraMes;
   Mes = #rey00107#18 % 0402; MesNum = Mes;
   |SI MesNum = 1;  Mes = " Enero ";      |FINSI;
   |SI MesNum = 2;  Mes = " Febrero ";    |FINSI;
   |SI MesNum = 3;  Mes = " Marzo ";      |FINSI;
   |SI MesNum = 4;  Mes = " Abril ";      |FINSI;
   |SI MesNum = 5;  Mes = " Mayo ";       |FINSI;
   |SI MesNum = 6;  Mes = " Junio ";      |FINSI;
   |SI MesNum = 7;  Mes = " Julio ";      |FINSI;
   |SI MesNum = 8;  Mes = " Agosto ";     |FINSI;
   |SI MesNum = 9;  Mes = " Septiembre "; |FINSI;
   |SI MesNum = 10; Mes = " Octubre ";    |FINSI;
   |SI MesNum = 11; Mes = " Noviembre ";  |FINSI;
   |SI MesNum = 12; Mes = " Diciembre ";  |FINSI;
|FPRC;

|PROGRAMA;
    |CLS;
    |CABEZA "Impresion 213";
    |PINPA #0#0;
    |DDEFECTO #0;
    |PINDA #0#0; ||HAZ PintaMoneda;
    |ENDATOS #1#0;
    |SI FSalida = 0;
        |ABRE #rehacien;
        |HAZ MiraMes;
        |IMPRE 0;
        |SI FSalida = 0;
            |HAZ Tipo3;
        |SINO;
            |MENAV "    Proceso abortado ...";
        |FINSI;
        |FINIMP;
        |CIERRA #rehacien;
    |FINSI;
|FPRO;

|PROCESO PintaMoneda;
|VARIABLES;
  {-1}aMoneda   = "";
      aMoneda1  = "LEER";
      aMoneda2  = "";
|FIN;
     aAlfa = " Moneda de emision : ";
     IaMoneda = aMoneda1<-;
     |ESPECIFICA "MODO_VER_EURO", aMoneda;
     |SI aMoneda2 = "0";
         aAlfa = aAlfa + "PESETAS";
     |SINO;
         aAlfa = aAlfa + "EUROS  ";
     |FINSI;
     |ATRI I; |PINTA 1622, aAlfa; |ATRI N;
|FPRC;
