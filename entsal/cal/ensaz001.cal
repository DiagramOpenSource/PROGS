|FICHEROS;
     ensaz001 #99;
     ensam001 #1;
     ensam002 #2;
     ensam003 #3;
     ensam004 #4;
     ensam502 #502;

     ensaw001 #901,MANTE;
     ensaw002 #902,MANTE;
     ensaw007 #907,MANTE;
     ensaw014 #914,MANTE;

     ensaw010 #910;
     ensaw011 #911;
     ensaw012 #912;

     clientes@ #999;

     :integral/dsam0000 #0;
|FIN;

|VARIABLES;
     nRango        = 0;
     nPos1         = 0;
     nPos2         = 0;
     nCampo        = 0;
     nCarpeta      = 0;
     nGrid         = 0;
     nVentana      = 0;
     nBoton1_0     = 0;
     nBoton2_0     = 0;
     nBoton3_0     = 0;
     nBoton4_0     = 0;
     nBoton5_0     = 0;
     nBoton6_0     = 0;
     nBoton7_0     = 0;
     nBoton1_2     = 0;
     nBoton2_2     = 0;
     nBoton3_2     = 0;
     nBoton1_4     = 0;
     nBoton2_4     = 0;
     nBoton3_4     = 0;
     nBoton1_5     = 0;
     nBoton2_5     = 0;
     nBoton3_5     = 0;
     nBoton1_6     = 0;
     nBoton2_6     = 0;
     nBoton3_6     = 0;

     aEsc1         = "";
     aEsc2         = "";
     aRetu         = "";
     aTecla        = "";
     aAlfa         = "";
     aTipo         = "";
     aBase         = "";
     aMas          = "";
     aDEstado2     = "          ";
     aHEstado2     = "zzzzzzzzzz";
     aDEstado4     = "          ";
     aHEstado4     = "zzzzzzzzzz";
     aDEstado5     = "          ";
     aHEstado5     = "zzzzzzzzzz";

     &enPanta0     = 0;
     &enPanta1     = 0;
     &enPanta2     = 0;
     &enPanta3     = 0;
     &enPanta4     = 0;
     &enPanta5     = 0;
     &enPanta6     = 0;

     &enGrid1      = 0;
     &enGrid2      = 0;
     &enGrid3      = 0;
     &enGrid4      = 0;
     &enGrid5      = 0;
     &enGrid6      = 0;
     &enGrid7      = 0;
     &enGrid8      = 0;
     &enGrid9      = 0;

     &enFoco1      = 0;
     &enFoco2      = 0;
     &enFoco3      = 0;
     &enFoco4      = 0;
     &enFoco5      = 0;
     &enFoco6      = 0;

     &enExpediente = 0;
     &enDExp       = 0;
     &enHExp       = 0;
|FIN;

|PROCESO Tipo12w14;  |TIPO 12;
|FPRC;

|PROCESO Tipo12w6;  |TIPO 12;
|FPRC;

|PROCESO Tipo12;  |TIPO 12;
|FPRC;

|PROCESO BajaPanta1;
     #0#85 = aTipo;
     #0#0  = 1;
|FPRC;

|PROCESO AltaPanta1;
     #0#85 = aTipo;
     #0#0  = 99999;
|FPRC;

|PROCESO BajaPanta2_1;
     #911#6 = aDEstado2;
     #911#0 = #0#0;
     #911#1 = 1;
     #911#2 = 1;
|FPRC;

|PROCESO AltaPanta2_1;
     #911#6 = aHEstado2;
     #911#0 = #0#0;
     #911#1 = 999;
     #911#2 = 9999;
|FPRC;

|PROCESO BajaPanta2_2;
     #3#0 = #911#0;
     #3#1 = #911#1;
     #3#2 = #911#2;
     #3#3 = 1;
|FPRC;

|PROCESO AltaPanta2_2;
     #3#0 = #911#0;
     #3#1 = #911#1;
     #3#2 = #911#2;
     #3#3 = 999999;
|FPRC;

|PROCESO BajaPanta3;
     #1#0 = #0#0;
     #1#1 = 1;
|FPRC;

|PROCESO AltaPanta3;
     #1#0 = #0#0;
     #1#1 = 999;
|FPRC;

|PROCESO BajaPanta4_1;
     #910#6 = aDEstado4;
     #910#0 = #1#0;
     #910#1 = #1#1;
     #910#2 = 1;
|FPRC;

|PROCESO AltaPanta4_1;
     #910#6 = aHEstado4;
     #910#0 = #1#0;
     #910#1 = #1#1;
     #910#2 = 9999;
|FPRC;

|PROCESO BajaPanta4_2;
     #3#0 = #910#0;
     #3#1 = #910#1;
     #3#2 = #910#2;
     #3#3 = 1;
|FPRC;

|PROCESO AltaPanta4_2;
     #3#0 = #910#0;
     #3#1 = #910#1;
     #3#2 = #910#2;
     #3#3 = 999999;
|FPRC;

|PROCESO BajaPanta5_1;
     #912#6 = aDEstado5;
     #912#0 = 00001;
     #912#1 = 001;
     #912#2 = 1;
|FPRC;

|PROCESO AltaPanta5_1;
     #912#6 = aHEstado5;
     #912#0 = 99999;
     #912#1 = 999;
     #912#2 = 9999;
|FPRC;

|PROCESO BajaPanta5_2;
     #3#0 = #912#0;
     #3#1 = #912#1;
     #3#2 = #912#2;
     #3#3 = 1;
|FPRC;

|PROCESO AltaPanta5_2;
     #3#0 = #912#0;
     #3#1 = #912#1;
     #3#2 = #912#2;
     #3#3 = 999999;
|FPRC;

|PROCESO BajaPanta6;
     #4#0 = 999999;
|FPRC;

|PROCESO AltaPanta6;
     #4#0 = 1;
|FPRC;

|PROCESO ensam502;
     #1#0 = #0#0;
     #1#1 = #502#0;
     |LEE 101#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         #1#0 = #0#0;
         #1#1 = #502#0;
         #1#3 = #502#2;
         #1#4 = #502#3;
         #1#5 = #502#4;
         #1#6 = #0#108;
         |GRABA 020#1b;
     |FINSI;

     aAlfa = #1#6;  |QBF aAlfa;
     |SI aAlfa = "";
         #1#6 = #0#108;
     |FINSI;

     #1#2 = #502#1;

     |GRABA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE ensam502;
     #502#1;
     ;
     001;
     999;
     ;
     NULL, ensam502;
|FIN;

|PROCESO EventoFocoGrid1;
     |PULSATECLA;

     |SI nGrid = 999;
         |PTEC 807;
     |FINSI;

     nGrid = 1;

     |REFRESCACONTROL enGrid1;
     |FOCOTECLADO enGrid1;
|FPRC;

|PROCESO EventoFocoGrid2;
     |PULSATECLA;

     |SI nGrid = 999;
         |PTEC 807;
     |FINSI;

     nGrid = 2;

     #911#6 = aDEstado2;
     #911#0 = #0#0;
     #911#1 = 1;
     #911#2 = 1;
     |LEE 000#911];
     |SI FSalida ! 0;  |O #911#0 ! #0#0;  |O #911#6 ! aDEstado2;
         |DDEFECTO #911;
     |FINSI;

     |REFRESCACONTROL enGrid3;
     |REFRESCACONTROL enGrid2;

     |FOCOTECLADO enGrid2;

     #99#0 = #0#0;  |PINTA #99#0;
     #99#1 = #0#1;  |PINTA #99#1;
|FPRC;

|PROCESO EventoFocoGrid3;
     |PULSATECLA;

     |LEE 000#0=;

     |SI nGrid = 999;
         |PTEC 807;
     |FINSI;

     nCarpeta = #1#1;

     |BUCLE ensam502;

     |SI nGrid = 1;
         |ABRE #502;
         |LEE 000#502p;
         |CIERRA #502;

         nCarpeta = #502#0;
     |FINSI;

     nGrid = 4;

     #1#0 = #0#0;
     #1#1 = nCarpeta;
     |LEE 000#1];

     |REFRESCACONTROL enGrid4;
     |FOCOTECLADO enGrid4;

     #99#4 = #0#0;  |PINTA #99#4;
     #99#5 = #0#1;  |PINTA #99#5;
|FPRC;

|PROCESO EventoFocoGrid4;
     |PULSATECLA;

     |SI nGrid = 999;
         |PTEC 807;
     |FINSI;

     nGrid = 5;

     #910#6 = aDEstado4;
     #910#0 = #1#0;
     #910#1 = #1#1;
     #910#2 = 1;
     |LEE 000#910];
     |SI FSalida ! 0;  |O #910#0 ! #1#0;  |O #910#1 ! #1#1;  |O #910#6 ! aDEstado4;
         |DDEFECTO #910;
     |FINSI;

     |REFRESCACONTROL enGrid6;
     |REFRESCACONTROL enGrid5;

     |FOCOTECLADO enGrid5;

     #99#6 = #0#0;  |PINTA #99#6;
     #99#7 = #0#1;  |PINTA #99#7;
     #99#8 = #1#1;  |PINTA #99#8;
     #99#9 = #1#2;  |PINTA #99#9;
|FPRC;

|PROCESO EventoFocoGrid5;
     |PULSATECLA;

     |SI nGrid = 999;
         |PTEC 807;
     |FINSI;

     nGrid = 7;

     #912#6 = aDEstado5;
     #912#0 = 1;
     #912#1 = 1;
     #912#2 = 1;
     |LEE 000#912];
     |SI FSalida ! 0;  |O #912#6 = aDEstado5;
         |DDEFECTO #912;
     |FINSI;

     |REFRESCACONTROL enGrid8;
     |REFRESCACONTROL enGrid7;

     |FOCOTECLADO enGrid7;
|FPRC;

|PROCESO EventoFocoGrid6;
     |PULSATECLA;

     |SI nGrid = 999;
         |PTEC 807;
     |FINSI;

     nGrid = 9;

     |LEE 000#4p;
     |SI FSalida ! 0;
         |DDEFECTO #4;
     |FINSI;

     |REFRESCACONTROL enGrid9;

     |FOCOTECLADO enGrid9;
|FPRC;

|PROCESO ensam001;
     #1#6 = #0#108;
     |GRABA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE ensam001;
     #1#1;
     ;
     #0#0, 001;
     #0#0, 999;
     be;
     NULL, ensam001;
|FIN;

|PROCESO EventoPanta1;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#0=;
         |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
     |FINSI;

     |SI FSalida = 4;
         nGrid = 999;

         |LEE 101#0=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |SI #0#85 = "I";
             |MENAV "0000 Empresa INACTIVA, opcion no permitida.";
             |ACABA;
         |FINSI;

         |BORRA_HIJOS_PAN #1#99;
         |SUB_PINPA #0#901, enPanta1;

         #901#0 = #0#106;
         #901#1 = #0#107;
         #901#2 = #0#108;
         #901#3 = #0#109;
         #901#4 = #0#0;
         #901#5 = #0#1;
         |PINDA #0#901;
         |ENDATOS #1#901;
         |SI FSalida = 0;
             #0#106 = #901#0;
             #0#107 = #901#1;
             #0#108 = #901#2;
             #0#109 = #901#3;
             |GRABA 020#0a;

             |BUCLE ensam001;
         |FINSI;
         |LIBERA #0;

         |BORRA_HIJOS_PAN #1#99;

         |REFRESCACONTROL enGrid1;
         FSalida = "SKIPDEFAULT";
         nGrid   = 1;
     |FINSI;
|FPRC;

|PROCESO EventoPanta2_1;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#0=;
         |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;

         |LEE 000#911=;
         |SI FSalida ! 0;  |DDEFECTO #911;  |FINSI;

         |ABRE #502;
         #502#0 = #911#1;
         |LEE 000#502=;
         |SI FSalida ! 0;  |DDEFECTO #502;  |FINSI;
         |CIERRA #502;

         #99#2 = #502#0;  |PINTA #99#2;
         #99#3 = #502#1;  |PINTA #99#3;

         |REFRESCACONTROL enGrid3;
     |FINSI;

     |SI FSalida = 4;
         |LEE 101#911=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |BORRA_HIJOS_PAN #2#99;
         |SUB_PINPA #0#907, enPanta2;

         #907#0  = #911#7;
         #907#1  = #911#8;
         #907#2  = #911#9;
         #907#3  = #911#10;
         #907#4  = #911#11;
         #907#5  = #911#12;
         #907#6  = #911#13;
         #907#7  = #911#14;
         #907#8  = #911#15;
         #907#9  = #911#16;

        |ENDATOS #1#907;
        |SI FSalida = 0;
            #911#7  = #907#0;
            #911#8  = #907#1;
            #911#9  = #907#2;
            #911#10 = #907#3;
            #911#11 = #907#4;
            #911#12 = #907#5;
            #911#13 = #907#6;
            #911#14 = #907#7;
            #911#15 = #907#8;
            #911#16 = #907#9;
        |FINSI;

        |BORRA_HIJOS_PAN #2#99;

        |GRABA 020#911a;
        |LIBERA #911;

        |REFRESCACONTROL enGrid2;
        FSalida = "SKIPDEFAULT";
     |FINSI;
|FPRC;

|PROCESO EventoPanta2_2;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#3=;
         |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;
     |FINSI;

     |SI FSalida = 4;
         |LEE 101#3=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |BORRA_HIJOS_PAN #2#99;
         |SUB_PINPA #0#907, enPanta2;

         #907#0  = #3#6;
         #907#1  = #3#7;
         #907#2  = #3#8;
         #907#3  = #3#9;
         #907#4  = #3#10;
         #907#5  = #3#11;
         #907#6  = #3#12;
         #907#7  = #3#13;
         #907#8  = #3#14;
         #907#9  = #3#15;

        |ENDATOS #1#907;
        |SI FSalida = 0;
            #3#6  = #907#0;
            #3#7  = #907#1;
            #3#8  = #907#2;
            #3#9  = #907#3;
            #3#10 = #907#4;
            #3#11 = #907#5;
            #3#12 = #907#6;
            #3#13 = #907#7;
            #3#14 = #907#8;
            #3#15 = #907#9;
        |FINSI;

        |BORRA_HIJOS_PAN #2#99;

        |GRABA 020#3a;
        |LIBERA #3;

        |REFRESCACONTROL enGrid3;
        FSalida = "SKIPDEFAULT";
     |FINSI;
|FPRC;

|PROCESO EventoPanta3;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#1=;
         |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |FINSI;

     |SI FSalida = 4;
         nGrid = 999;

         |LEE 101#1=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |BORRA_HIJOS_PAN #3#99;
         |SUB_PINPA #0#902, enPanta3;

         #902#0 = #1#3;
         #902#1 = #1#4;
         #902#2 = #1#5;
         #902#3 = #1#6;
         #902#4 = #0#0;
         #902#5 = #0#1;
         #902#6 = #1#1;
         #902#7 = #1#2;
         |PINDA #0#902;
         |ENDATOS #1#902;
         |SI FSalida = 0;
             #1#3  = #902#0;
             #1#4  = #902#1;
             #1#5  = #902#2;
             #1#6  = #902#3;
             |GRABA 020#1a;
         |FINSI;
         |LIBERA #1;

         |BORRA_HIJOS_PAN #3#99;

         |REFRESCACONTROL enGrid4;
         FSalida = "SKIPDEFAULT";
         nGrid   = 4;
     |FINSI;
|FPRC;

|PROCESO EventoPanta4_1;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#910=;
         |SI FSalida ! 0;  |DDEFECTO #910;  |FINSI;

         |REFRESCACONTROL enGrid6;
     |FINSI;

     |SI FSalida = 4;
         |LEE 101#910=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |BORRA_HIJOS_PAN #4#99;
         |SUB_PINPA #0#907, enPanta4;

         #907#0  = #910#7;
         #907#1  = #910#8;
         #907#2  = #910#9;
         #907#3  = #910#10;
         #907#4  = #910#11;
         #907#5  = #910#12;
         #907#6  = #910#13;
         #907#7  = #910#14;
         #907#8  = #910#15;
         #907#9  = #910#16;

        |ENDATOS #1#907;
        |SI FSalida = 0;
            #910#7  = #907#0;
            #910#8  = #907#1;
            #910#9  = #907#2;
            #910#10 = #907#3;
            #910#11 = #907#4;
            #910#12 = #907#5;
            #910#13 = #907#6;
            #910#14 = #907#7;
            #910#15 = #907#8;
            #910#16 = #907#9;
        |FINSI;

        |BORRA_HIJOS_PAN #4#99;

        |GRABA 020#910a;
        |LIBERA #910;

        |REFRESCACONTROL enGrid5;
        FSalida = "SKIPDEFAULT";
     |FINSI;
|FPRC;

|PROCESO EventoPanta4_2;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#3=;
         |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;
     |FINSI;

     |SI FSalida = 4;
         |LEE 101#3=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |BORRA_HIJOS_PAN #4#99;
         |SUB_PINPA #0#907, enPanta4;

         #907#0  = #3#6;
         #907#1  = #3#7;
         #907#2  = #3#8;
         #907#3  = #3#9;
         #907#4  = #3#10;
         #907#5  = #3#11;
         #907#6  = #3#12;
         #907#7  = #3#13;
         #907#8  = #3#14;
         #907#9  = #3#15;

        |ENDATOS #1#907;
        |SI FSalida = 0;
            #3#6  = #907#0;
            #3#7  = #907#1;
            #3#8  = #907#2;
            #3#9  = #907#3;
            #3#10 = #907#4;
            #3#11 = #907#5;
            #3#12 = #907#6;
            #3#13 = #907#7;
            #3#14 = #907#8;
            #3#15 = #907#9;
        |FINSI;

        |BORRA_HIJOS_PAN #4#99;

        |GRABA 020#3a;
        |LIBERA #3;

        |REFRESCACONTROL enGrid6;
        FSalida = "SKIPDEFAULT";
     |FINSI;
|FPRC;

|PROCESO EventoPanta5_1;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#912=;
         |SI FSalida ! 0;  |DDEFECTO #912;  |FINSI;

         #999#0 = #912#0;
         |LEE 000#999=;
         |SI FSalida ! 0;  |DDEFECTO #999;  |FINSI;

         |ABRE #502;
         #502#0 = #912#1;
         |LEE 000#502=;
         |SI FSalida ! 0;  |DDEFECTO #502;  |FINSI;
         |CIERRA #502;

         #99#10 = #999#0;    |PINTA #99#10;
         #99#11 = #999#1;    |PINTA #99#11;
         #99#12 = #502#0;    |PINTA #99#12;
         #99#13 = #502#1;    |PINTA #99#13;

         |REFRESCACONTROL enGrid8;
     |FINSI;

     |SI FSalida = 4;
         |LEE 101#912=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |BORRA_HIJOS_PAN #5#99;
         |SUB_PINPA #0#907, enPanta5;

         #907#0  = #912#7;
         #907#1  = #912#8;
         #907#2  = #912#9;
         #907#3  = #912#10;
         #907#4  = #912#11;
         #907#5  = #912#12;
         #907#6  = #912#13;
         #907#7  = #912#14;
         #907#8  = #912#15;
         #907#9  = #912#16;

        |ENDATOS #1#907;
        |SI FSalida = 0;
            #912#7  = #907#0;
            #912#8  = #907#1;
            #912#9  = #907#2;
            #912#10 = #907#3;
            #912#11 = #907#4;
            #912#12 = #907#5;
            #912#13 = #907#6;
            #912#14 = #907#7;
            #912#15 = #907#8;
            #912#16 = #907#9;
        |FINSI;

        |BORRA_HIJOS_PAN #5#99;

        |GRABA 020#912a;
        |LIBERA #912;

        |REFRESCACONTROL enGrid7;
        FSalida = "SKIPDEFAULT";
     |FINSI;
|FPRC;

|PROCESO EventoPanta5_2;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#3=;
         |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;
     |FINSI;

     |SI FSalida = 4;
         |LEE 101#3=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |BORRA_HIJOS_PAN #5#99;
         |SUB_PINPA #0#907, enPanta5;

         #907#0  = #3#6;
         #907#1  = #3#7;
         #907#2  = #3#8;
         #907#3  = #3#9;
         #907#4  = #3#10;
         #907#5  = #3#11;
         #907#6  = #3#12;
         #907#7  = #3#13;
         #907#8  = #3#14;
         #907#9  = #3#15;

        |ENDATOS #1#907;
        |SI FSalida = 0;
            #3#6  = #907#0;
            #3#7  = #907#1;
            #3#8  = #907#2;
            #3#9  = #907#3;
            #3#10 = #907#4;
            #3#11 = #907#5;
            #3#12 = #907#6;
            #3#13 = #907#7;
            #3#14 = #907#8;
            #3#15 = #907#9;
        |FINSI;

        |BORRA_HIJOS_PAN #5#99;

        |GRABA 020#3a;
        |LIBERA #3;

        |REFRESCACONTROL enGrid8;
        FSalida = "SKIPDEFAULT";
     |FINSI;
|FPRC;

|PROCESO EventoPanta6;
     |SI FSalida = 1;  |O FSalida = 2;

         |ESTADO_CONTROL nBoton1_6, "ENABLE";
         |ESTADO_CONTROL nBoton2_6, "ENABLE";
         |ESTADO_CONTROL nBoton3_6, "ENABLE";

         |LEE 000#4=;
         |SI FSalida ! 0;
             |DDEFECTO #4;

             |ESTADO_CONTROL nBoton1_6, "DISABLE";
             |ESTADO_CONTROL nBoton2_6, "DISABLE";
             |ESTADO_CONTROL nBoton3_6, "DISABLE";
         |FINSI;

         #999#0 = #4#1;
         |LEE 000#999=;
         |SI FSalida ! 0;  |DDEFECTO #999;  |FINSI;

         #99#14 = #999#0;    |PINTA #99#14;
         #99#15 = #999#1;    |PINTA #99#15;
     |FINSI;

     |SI FSalida = 4;
         |LEE 101#4=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |VENTANA 0501, 2799, -1, -1, "";
         nVentana = FSalida;

         enExpediente = #4#0;
         |SUB_EJECUTA "ensaz007";

         |FINVENTANA nVentana;

         |REFRESCACONTROL enGrid9;
         FSalida = "SKIPDEFAULT";
     |FINSI;
|FPRC;

|PROCESO Grid1;
     nRango = 4 + 8 + 16 + 32 + 128;
     nPos1  = 0601;
     nPos2  = 2380;
     nGrid  = 1;
     aTipo  = "A";

     |LINEAL_SIMPLE #5#0, nRango, nPos1, nPos2, BajaPanta1, AltaPanta1, EventoPanta1;
     enGrid1 = FSalida;

     |FOCOTECLADO enGrid1;

     FSalida = 1;
     #0#0    = 1;
     |HAZ EventoPanta1;

     |CONTROL_SIMPLE enPanta1, "EVENTOPAN", 0000, 0000, EventoFocoGrid1;
     enFoco1 = FSalida;
|FPRC;

|PROCESO Grid2;
     nRango = 4 + 8 + 16 + 32 + 128;

     nPos1     = 1001;
     nPos2     = 2368;
     aDEstado2 = "          ";
     aHEstado2 = "zzzzzzzzzz";

     |LINEAL_SIMPLE #4#911, nRango, nPos1, nPos2, BajaPanta2_1, AltaPanta2_1, EventoPanta2_1;
     enGrid2 = FSalida;

     nPos1  = 1070;
     nPos2  = 2398;

     |LINEAL_SIMPLE #1#3, nRango, nPos1, nPos2, BajaPanta2_2, AltaPanta2_2, EventoPanta2_2;
     enGrid3 = FSalida;

     |LEE 000#911p;

     FSalida = 1;
     |HAZ EventoPanta2_1;

     |CONTROL_SIMPLE enPanta2, "EVENTOPAN", 0000, 0000, EventoFocoGrid2;
     enFoco2 = FSalida;
|FPRC;

|PROCESO Grid3;
     nRango = 4 + 8 + 16 + 32 + 128;
     nPos1  = 0901;
     nPos2  = 2399;

     |LINEAL_SIMPLE #1#1, nRango, nPos1, nPos2, BajaPanta3, AltaPanta3, EventoPanta3;
     enGrid4 = FSalida;

     |LEE 000#1p;

     FSalida = 1;
     |HAZ EventoPanta3;

     |CONTROL_SIMPLE enPanta3, "EVENTOPAN", 0000, 0000, EventoFocoGrid3;
     enFoco3 = FSalida;
|FPRC;

|PROCESO Grid4;
     nRango = 4 + 8 + 16 + 32 + 128;

     nPos1  = 1001;
     nPos2  = 2368;

     aDEstado4 = "          ";
     aHEstado4 = "zzzzzzzzzz";

     |LINEAL_SIMPLE #4#910, nRango, nPos1, nPos2, BajaPanta4_1, AltaPanta4_1, EventoPanta4_1;
     enGrid5 = FSalida;

     nPos1  = 1070;
     nPos2  = 2398;

     |LINEAL_SIMPLE #1#3, nRango, nPos1, nPos2, BajaPanta4_2, AltaPanta4_2, EventoPanta4_2;
     enGrid6 = FSalida;

     |LEE 000#910p;

     FSalida = 1;
     |HAZ EventoPanta4_1;

     |CONTROL_SIMPLE enPanta4, "EVENTOPAN", 0000, 0000, EventoFocoGrid4;
     enFoco4 = FSalida;
|FPRC;

|PROCESO Grid5;
     nRango = 4 + 8 + 16 + 32 + 128;

     nPos1     = 1001;
     nPos2     = 2368;
     aDEstado5 = "          ";
     aHEstado5 = "zzzzzzzzzz";

     |LINEAL_SIMPLE #4#912, nRango, nPos1, nPos2, BajaPanta5_1, AltaPanta5_1, EventoPanta5_1;
     enGrid7 = FSalida;

     nPos1  = 1070;
     nPos2  = 2398;

     |LINEAL_SIMPLE #1#3, nRango, nPos1, nPos2, BajaPanta5_2, AltaPanta5_2, EventoPanta5_2;
     enGrid8 = FSalida;

     |LEE 000#912p;

     FSalida = 1;
     |HAZ EventoPanta5_1;

     |CONTROL_SIMPLE enPanta5, "EVENTOPAN", 0000, 0000, EventoFocoGrid5;
     enFoco5 = FSalida;
|FPRC;

|PROCESO Grid6;
     nRango = 4 + 8 + 16 + 32 + 128;

     nPos1     = 0901;
     nPos2     = 2398;

     |LINEAL_SIMPLE #1#4, nRango, nPos1, nPos2, BajaPanta6, AltaPanta6, EventoPanta6;
     enGrid9 = FSalida;

     |LEE 000#4p;

     FSalida = 1;
     |HAZ EventoPanta6;

     |CONTROL_SIMPLE enPanta6, "EVENTOPAN", 0000, 0000, EventoFocoGrid6;
     enFoco6 = FSalida;
|FPRC;

|PROCESO Boton1_0;
     |VENTANA 0501, 2799, -1, -1, "";
     nVentana = FSalida;

     |SUB_EJECUTA "ensaz002";

     |FINVENTANA nVentana;

     |REFRESCACONTROL enGrid9;
     |REFRESCACONTROL enGrid8;
     |REFRESCACONTROL enGrid7;
     |REFRESCACONTROL enGrid6;
     |REFRESCACONTROL enGrid5;
     |REFRESCACONTROL enGrid4;
     |REFRESCACONTROL enGrid3;
     |REFRESCACONTROL enGrid2;
     |REFRESCACONTROL enGrid1;
|FPRC;

|PROCESO Boton2_0;
     |VENTANA 0501, 2799, -1, -1, "";
     nVentana = FSalida;

     |SUB_EJECUTA "ensaz003";

     |FINVENTANA nVentana;

     |LEE 000#0p;
     |REFRESCACONTROL enGrid9;
     |REFRESCACONTROL enGrid8;
     |REFRESCACONTROL enGrid7;
     |REFRESCACONTROL enGrid6;
     |REFRESCACONTROL enGrid5;
     |REFRESCACONTROL enGrid4;
     |REFRESCACONTROL enGrid3;
     |REFRESCACONTROL enGrid2;
     |REFRESCACONTROL enGrid1;
|FPRC;

|PROCESO Boton3_0;
     |VENTANA 0501, 2799, -1, -1, "";
     nVentana = FSalida;

     |SUB_EJECUTA "ensaz005";

     |FINVENTANA nVentana;

     |LEE 000#0p;
     |REFRESCACONTROL enGrid9;
     |REFRESCACONTROL enGrid8;
     |REFRESCACONTROL enGrid7;
     |REFRESCACONTROL enGrid6;
     |REFRESCACONTROL enGrid5;
     |REFRESCACONTROL enGrid4;
     |REFRESCACONTROL enGrid3;
     |REFRESCACONTROL enGrid2;
     |REFRESCACONTROL enGrid1;
|FPRC;

|PROCESO Boton4_0;
     |VENTANA 0501, 2799, -1, -1, "";
     nVentana = FSalida;

     |SUB_EJECUTA "ensaz004";

     |FINVENTANA nVentana;

     |LEE 000#0p;
     |REFRESCACONTROL enGrid1;
|FPRC;

|PROCESO Boton5_0;
     |VENTANA 0501, 2799, -1, -1, "";
     nVentana = FSalida;

     |SUB_EJECUTA "ensaz006";

     |FINVENTANA nVentana;

     |LEE 000#0p;
     |REFRESCACONTROL enGrid1;
|FPRC;

|PROCESO Boton6_0;
     |ESTADO_CONTROL nBoton1_0, "ENABLE";
     |ESTADO_CONTROL nBoton2_0, "ENABLE";
     |ESTADO_CONTROL nBoton3_0, "ENABLE";
     |ESTADO_CONTROL nBoton4_0, "ENABLE";
     |ESTADO_CONTROL nBoton5_0, "ENABLE";
     |ESTADO_CONTROL nBoton6_0, "DISABLE";
     |ESTADO_CONTROL nBoton7_0, "ENABLE";

     aTipo = "A";
     |REFRESCACONTROL enGrid1;
     |FOCOTECLADO enGrid1;
|FPRC;

|PROCESO Boton7_0;
     |ESTADO_CONTROL nBoton1_0, "DISABLE";
     |ESTADO_CONTROL nBoton2_0, "DISABLE";
     |ESTADO_CONTROL nBoton3_0, "DISABLE";
     |ESTADO_CONTROL nBoton4_0, "DISABLE";
     |ESTADO_CONTROL nBoton5_0, "DISABLE";
     |ESTADO_CONTROL nBoton6_0, "ENABLE";
     |ESTADO_CONTROL nBoton7_0, "DISABLE";

     aTipo = "I";
     |REFRESCACONTROL enGrid1;
     |FOCOTECLADO enGrid1;
|FPRC;

|PROCESO BotonesPanta1;
     |CONTROL_SIMPLE enPanta1, "BOTON,{{217}} Crear internos", 0783, 0898, Boton1_0;
     nBoton1_0 = FSalida;

     |CONTROL_SIMPLE enPanta1, "BOTON,{{218}} Salida", 1083, 1198, Boton2_0;
     nBoton2_0 = FSalida;

     |CONTROL_SIMPLE enPanta1, "BOTON,{{219}} Devolucion", 1383, 1498, Boton3_0;
     nBoton3_0 = FSalida;

     |CONTROL_SIMPLE enPanta1, "BOTON,{{205}} Expediente", 1683, 1798, Boton4_0;
     nBoton4_0 = FSalida;

     |CONTROL_SIMPLE enPanta1, "BOTON,{{205}} Incidencias", 1983, 2098, Boton5_0;
     nBoton5_0 = FSalida;

     |CONTROL_SIMPLE enPanta1, "BOTON,A", 0502, 0505, Boton6_0;
     nBoton6_0 = FSalida;

     |CONTROL_SIMPLE enPanta1, "BOTON,I", 0508, 0511, Boton7_0;
     nBoton7_0 = FSalida;

     |ESTADO_CONTROL nBoton6 _0, "DISABLE";
|FPRC;

|PROCESO Boton1_2;
     |ESTADO_CONTROL nBoton1_2, "DISABLE";
     |ESTADO_CONTROL nBoton2_2, "ENABLE";
     |ESTADO_CONTROL nBoton3_2, "ENABLE";

     aDEstado2 = "PENDIENTE ";
     aHEstado2 = "PENDIENTE ";
     |HAZ EventoFocoGrid2;
|FPRC;

|PROCESO Boton2_2;
     |ESTADO_CONTROL nBoton1_2, "ENABLE";
     |ESTADO_CONTROL nBoton2_2, "DISABLE";
     |ESTADO_CONTROL nBoton3_2, "ENABLE";

     aDEstado2 = "ENTREGADO ";
     aHEstado2 = "ENTREGADO ";
     |HAZ EventoFocoGrid2;
|FPRC;

|PROCESO Boton3_2;
     |ESTADO_CONTROL nBoton1_2, "ENABLE";
     |ESTADO_CONTROL nBoton2_2, "ENABLE";
     |ESTADO_CONTROL nBoton3_2, "DISABLE";

     aDEstado2 = "          ";
     aHEstado2 = "zzzzzzzzzz";
     |HAZ EventoFocoGrid2;
|FPRC;

|PROCESO BotonesPanta2;
     |CONTROL_SIMPLE enPanta2, "BOTON,P", 0901, 0904, Boton1_2;
     nBoton1_2 = FSalida;

     |CONTROL_SIMPLE enPanta2, "BOTON,E", 0906, 0909, Boton2_2;
     nBoton2_2 = FSalida;

     |CONTROL_SIMPLE enPanta2, "BOTON,T", 0911, 0914, Boton3_2;
     nBoton3_2 = FSalida;

     |ESTADO_CONTROL nBoton3_2, "DISABLE";
|FPRC;

|PROCESO Boton1_4;
     |ESTADO_CONTROL nBoton1_4, "DISABLE";
     |ESTADO_CONTROL nBoton2_4, "ENABLE";
     |ESTADO_CONTROL nBoton3_4, "ENABLE";

     aDEstado4 = "PENDIENTE ";
     aHEstado4 = "PENDIENTE ";
     |HAZ EventoFocoGrid4;
|FPRC;

|PROCESO Boton2_4;
     |ESTADO_CONTROL nBoton1_4, "ENABLE";
     |ESTADO_CONTROL nBoton2_4, "DISABLE";
     |ESTADO_CONTROL nBoton3_4, "ENABLE";

     aDEstado4 = "ENTREGADO ";
     aHEstado4 = "ENTREGADO ";
     |HAZ EventoFocoGrid4;
|FPRC;

|PROCESO Boton3_4;
     |ESTADO_CONTROL nBoton1_4, "ENABLE";
     |ESTADO_CONTROL nBoton2_4, "ENABLE";
     |ESTADO_CONTROL nBoton3_4, "DISABLE";

     aDEstado4 = "          ";
     aHEstado4 = "zzzzzzzzzz";
     |HAZ EventoFocoGrid4;
|FPRC;

|PROCESO BotonesPanta4;
     |CONTROL_SIMPLE enPanta4, "BOTON,P", 0901, 0904, Boton1_4;
     nBoton1_4 = FSalida;

     |CONTROL_SIMPLE enPanta4, "BOTON,E", 0906, 0909, Boton2_4;
     nBoton2_4 = FSalida;

     |CONTROL_SIMPLE enPanta4, "BOTON,T", 0911, 0914, Boton3_4;
     nBoton3_4 = FSalida;

     |ESTADO_CONTROL nBoton3_4, "DISABLE";
|FPRC;

|PROCESO Boton1_5;
     |ESTADO_CONTROL nBoton1_5, "DISABLE";
     |ESTADO_CONTROL nBoton2_5, "ENABLE";
     |ESTADO_CONTROL nBoton3_5, "ENABLE";

     aDEstado5 = "PENDIENTE ";
     aHEstado5 = "PENDIENTE ";
     |HAZ EventoFocoGrid5;
|FPRC;

|PROCESO Boton2_5;
     |ESTADO_CONTROL nBoton1_5, "ENABLE";
     |ESTADO_CONTROL nBoton2_5, "DISABLE";
     |ESTADO_CONTROL nBoton3_5, "ENABLE";

     aDEstado5 = "ENTREGADO ";
     aHEstado5 = "ENTREGADO ";
     |HAZ EventoFocoGrid5;
|FPRC;

|PROCESO Boton3_5;
     |ESTADO_CONTROL nBoton1_5, "ENABLE";
     |ESTADO_CONTROL nBoton2_5, "ENABLE";
     |ESTADO_CONTROL nBoton3_5, "DISABLE";

     aDEstado5 = "          ";
     aHEstado5 = "zzzzzzzzzz";
     |HAZ EventoFocoGrid5;
|FPRC;

|PROCESO BotonesPanta5;
     |CONTROL_SIMPLE enPanta5, "BOTON,P", 0901, 0904, Boton1_5;
     nBoton1_5 = FSalida;

     |CONTROL_SIMPLE enPanta5, "BOTON,E", 0906, 0909, Boton2_5;
     nBoton2_5 = FSalida;

     |CONTROL_SIMPLE enPanta5, "BOTON,T", 0911, 0914, Boton3_5;
     nBoton3_5 = FSalida;

     |ESTADO_CONTROL nBoton3_5, "DISABLE";
|FPRC;

|PROCESO Boton1_6;
     enDExp = #4#0;
     enHExp = #4#0;

     |SUB_EJECUTA "ensaz004;AUTOMA";

     |FOCOTECLADO enGrid9;
|FPRC;

|PROCESO Boton2_6;
     |VENTANA 0501, 2799, -1, -1, "";
     nVentana = FSalida;

     enExpediente = #4#0;
     |SUB_EJECUTA "ensaz005;AUTOMA";

     |FINVENTANA nVentana;

     |FOCOTECLADO enGrid9;
|FPRC;

|PROCESO Boton3_6;
         |LEE 101#4=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |BORRA_HIJOS_PAN #6#99;
         |SUB_PINPA #0#914, enPanta6;

         #914#0  = #4#7;
         #914#1  = #4#8;
         #914#2  = #4#9;
         #914#3  = #4#10;
         #914#4  = #4#11;

        |ENDATOS #1#914;
        |SI FSalida = 0;
            #4#7  = #914#0;
            #4#8  = #914#1;
            #4#9  = #914#2;
            #4#10 = #914#3;
            #4#11 = #914#4;
            |GRABA 020#4a;
        |FINSI;

        |LIBERA #4;
        |BORRA_HIJOS_PAN #6#99;

        |REFRESCACONTROL enGrid6;
        FSalida = "SKIPDEFAULT";
|FPRC;

|PROCESO BotonesPanta6;
     |CONTROL_SIMPLE enPanta6, "BOTON,{{205}} Expediente", 0876, 0886, Boton1_6;
     nBoton1_6 = FSalida;

     |CONTROL_SIMPLE enPanta6, "BOTON,{{219}} Devolucion", 0888, 0898, Boton2_6;
     nBoton2_6 = FSalida;

     |CONTROL_SIMPLE enPanta6, "BOTON,{{137}} Observaciones", 0860, 0874, Boton3_6;
     nBoton3_6 = FSalida;
|FPRC;


|PROGRAMA;
     |CABEZA "Entrada-Salida de Documentos";

     |PINPA #0#99;  enPanta0 = FSalida;
     |PINPA #1#99;  enPanta1 = FSalida;  |HAZ Grid1;
     |PINPA #2#99;  enPanta2 = FSalida;  |HAZ Grid2;
     |PINPA #3#99;  enPanta3 = FSalida;  |HAZ Grid3;
     |PINPA #4#99;  enPanta4 = FSalida;  |HAZ Grid4;
     |PINPA #5#99;  enPanta5 = FSalida;  |HAZ Grid5;
     |PINPA #6#99;  enPanta6 = FSalida;  |HAZ Grid6;

     |FOCOTECLADO enGrid1;

     |HAZ BotonesPanta1;
     |HAZ BotonesPanta2;
     |HAZ BotonesPanta4;
     |HAZ BotonesPanta5;
     |HAZ BotonesPanta6;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";

     |PARA; |SI;  |HACIENDO;
         FSalida = "::Salir," + enGrid1;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1_0;
     |FIN_CONTROL_WINDOWS nBoton2_0;
     |FIN_CONTROL_WINDOWS nBoton3_0;
     |FIN_CONTROL_WINDOWS nBoton4_0;
     |FIN_CONTROL_WINDOWS nBoton5_0;
     |FIN_CONTROL_WINDOWS nBoton6_0;
     |FIN_CONTROL_WINDOWS nBoton7_0;
     |FIN_CONTROL_WINDOWS nBoton1_2;
     |FIN_CONTROL_WINDOWS nBoton2_2;
     |FIN_CONTROL_WINDOWS nBoton3_2;
     |FIN_CONTROL_WINDOWS nBoton1_4;
     |FIN_CONTROL_WINDOWS nBoton2_4;
     |FIN_CONTROL_WINDOWS nBoton3_4;
     |FIN_CONTROL_WINDOWS nBoton1_5;
     |FIN_CONTROL_WINDOWS nBoton2_5;
     |FIN_CONTROL_WINDOWS nBoton3_5;
     |FIN_CONTROL_WINDOWS nBoton1_6;
     |FIN_CONTROL_WINDOWS nBoton2_6;
     |FIN_CONTROL_WINDOWS nBoton3_6;

     |DESTRUYECONTROL enGrid1;
     |DESTRUYECONTROL enGrid2;
     |DESTRUYECONTROL enGrid3;
     |DESTRUYECONTROL enGrid4;
     |DESTRUYECONTROL enGrid5;
     |DESTRUYECONTROL enGrid6;
     |DESTRUYECONTROL enGrid7;
     |DESTRUYECONTROL enGrid8;
     |DESTRUYECONTROL enGrid9;

     |PULSATECLA;
|FPRO;

|PROCESO ensam003;
     #4#0 = #3#3;
     |LEE 000#4=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     #999#0 = #3#0;
     |LEE 000#999=;
     |SI FSalida ! 0;  |DDEFECTO #999;  |FINSI;

     #1#0 = #3#0;
     #1#1 = #3#1;
     |LEE 000#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;

     #2#0 = #3#0;
     #2#1 = #3#1;
     #2#2 = #3#2;
     |LEE 000#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

     |DDEFECTO #4;
     #4#0 = #3#3;
     #4#1 = #3#0;
     #4#2 = #999#1;
     #4#3 = #3#4;
     #4#4 = #3#5;
     #4#5 = #1#6;
     #4#6 = #2#3;
     |GRABA 020#4n;
     |LIBERA #4;
|FPRC;

|DEFBUCLE ensam003;
     #3#1;
     ;
     00000, 000, 0000, 000000;
     99999, 999, 9999, 999999;
     ;
     NULL, ensam003;
|FIN;

|PROCESO Tipo80;  |TIPO 80;
     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "integral/def/dsam0000.mas";
     |CARGA_DEF aMas, clientes@;

     |ABRET #0;
     |ABRET #1;
     |ABRET #2;
     |ABRET #3;
     |ABRET #4;
     |ABRET #910;
     |ABRET #911;
     |ABRET #912;
     |ABRET #999;

     |LEE 000#4p;
     |SI FSalida ! 0;
         |BUCLE ensam003;
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ 119;  |HACIENDO nCampo = nCampo + 1;
           |C_V #dsam0000#nCampo#, 1, "N";
     |SIGUE;

     |C_V #dsam0000#0,   1, "S";
     |C_V #dsam0000#1,   1, "S";
     |C_V #dsam0000#3,   1, "S";
     |C_V #dsam0000#109, 1, "S";
     |C_V #dsam0000#9,   1, "S";
     |C_V #dsam0000#10,  1, "S";
     |C_V #dsam0000#106, 1, "S";
     |C_V #dsam0000#107, 1, "S";
     |C_V #dsam0000#108, 1, "S";

     FSalida = 2799;
|FPRC;

|PROCESO Tipo90;  |TIPO 90;
     |CIERRAT #0;
     |CIERRAT #1;
     |CIERRAT #2;
     |CIERRAT #3;
     |CIERRAT #4;
     |CIERRAT #910;
     |CIERRAT #911;
     |CIERRAT #912;
     |CIERRAT #999;

     |DESCARGA_DEF #clientes@;
|FPRC;
