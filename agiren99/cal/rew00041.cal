|FICHEROS;
     rew00040 #940;
     rew00041 #941;
     rew00042 #942;
     rem00102 #102;
|FIN;

|VARIABLES;
      nCampo        = 0;
      nCampo1       = 0;

      &eaVarDni     = "";


 {-1} aMenuCalc     = "";
      aMenuCalc1    = "1663";
      aMenuCalc2    = "2";
      aMenuCalc3    = "3";
      aMenuCalc4    = "D.Familiar ";
      aMenuCalc5    = "Calculo    ";
      aMenuCalc6    = "Imprimir   ";

 {-1} aMenuFami     = "";
      aMenuFami1    = "1420";
      aMenuFami2    = "1";
      aMenuFami3    = "2";
      aMenuFami4    = "DESCENDIENTE";
      aMenuFami5    = "ASCENDIENTE ";
|FIN;

|PROCESO IngreTrabajo;  |TIPO 7;
     |SI FSalida = 2;  FSalida = 0;  |ACABA;  |FINSI;
     |SI #102#128 = 99;              |ACABA;  |FINSI;

     |PUSHV 0501 2380;

     #942#0 = #102#129;
     #942#1 = #102#130;
     #942#2 = #102#131;
     #942#3 = #102#132;
     #942#4 = #102#133;
     #942#5 = #102#134;

     |PINPA #0#942;
     |PINDA #0#942;
     |ENDATOS #1#942;
     |SI FSalida = 0;
         #102#129 = #942#0;
         #102#130 = #942#1;
         #102#131 = #942#2;
         #102#8   = #942#2;
         #102#132 = #942#3;
         #102#133 = #942#4;
         #102#134 = #942#5;
         #102#15  = #942#5;
     |FINSI;
     |POPV;

     #941#6 = #102#129 + #102#132;
     #941#7 = #102#130 + #102#133;
     #941#8 = #102#131 + #102#134;
     |PINTA #941#6;
     |PINTA #941#7;
     |PINTA #941#8;
|FPRC;

|PROCESO Pantalla2;
      |PARA nCampo = 57;  |SI nCampo [ 128;  |HACIENDO nCampo = nCampo + 1;
            nCampo1 = nCampo - 57;
            #940nCampo1 = #941nCampo;
      |SIGUE;

      |PUSHV 0501 2380;
      |HAZ Calculo;
      |PINPA #0#940;
      |PINDA #0#940;
      FSalida = 0;
      |ENDATOS #1#940;
      |SI FSalida = 0;
          |PARA nCampo = 57;  |SI nCampo [ 128;  |HACIENDO nCampo = nCampo + 1;
                nCampo1 = nCampo - 57;
                #941nCampo = #940nCampo1;
          |SIGUE;
      |FINSI;
      |POPV;
|FPRC;

|PROCESO Pantalla1;
     |PINPA #0#941;
     |PINDA #0#941;
     |ENDATOS #1#941;
|FPRC;

|PROCESO Imprimir;
     |PARA nCampo = 0;  |SI nCampo [ 128;  |HACIENDO nCampo = nCampo + 1;
           #102nCampo = #941nCampo;
     |SIGUE;

     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA; |FINSI;

     |INFOR "rem00102";
     |SI FSalida ! 0;  |FINIMP;  |ACABA; |FINSI;

     |PRINT;
     |PIEINF;
     |FININF;
     |FINIMP;
|FPRC;

|PROCESO Tipo12;  |TIPO 12;
     |SI aMenuCalc2 = "1";  |ACABA;  |FINSI;

     aMenuCalc2 = "2";
     |PUSHV 0501 2380;
     |PARA; |SI; |HACIENDO;
            |MENUG aMenuCalc;
            aMenuCalc2 = FSalida;

            |SI aMenuCalc2 < "1";  |O aMenuCalc2 > "3";  |SAL;  |FINSI;

            |SI aMenuCalc2 = "1";   |HAZ Pantalla1;  |FINSI;
            |SI aMenuCalc2 = "2";   |HAZ Pantalla2;  |FINSI;
            |SI aMenuCalc2 = "3";   |HAZ Imprimir;   |FINSI;
     |SIGUE;
     |POPV;
|FPRC;
