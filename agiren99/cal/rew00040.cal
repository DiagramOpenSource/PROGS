|FICHEROS;
     rew00041 #941,MANTE;
     rew00040 #940,MANTE;
     rew00043 #943,MANTE;
     rew00044 #944,MANTE;
     rem00102 #102;
|FIN;

|VARIABLES;
     nParte    = 0;
     nResta    = 0;
     nTipo     = 0;
     nCampo    = 0;
     nSuma     = 0;
     nDeducido = 0;
     nBaseG    = 0;
     nBaseB    = 0;
     nBaseC    = 0;
     nBase1    = 0;
     nBase2    = 0;
     nBase3    = 0;
     nBase4    = 0;
     nBase5    = 0;
     nDedu1    = 0;
     nDedu2    = 0;
     nDedu3    = 0;
     nDedu4    = 0;
     nDedu5    = 0;
     nTHijos    = 0;
     nHijos3    = 0;
     nHijos16   = 0;
     nHijosM33  = 0;
     nHijosM65  = 0;
     nTAscen    = 0;
     nAscenM33  = 0;
     nAscenM65  = 0;
     nTitular   = 0;
     nConyuge   = 0;
     nAl33      = 0;
     nAl65      = 0;
     nTotalH    = 0;
     nImput     = 0;
     nEdad      = 0;
     nCampo1    = 0;
     nCampo2    = 0;
     nCampo3    = 0;
     nImporte   = 0;
     nResto27   = 0;
     nSwTraba   = 0;
     nMenor     = 0;
     nAjuste    = 0;
     nBases     = 0;
     nDiferen   = 0;
     nFactor    = 0;

     &enSwPintas = 0;
|FIN;

|PROCESO Pintas;
     |SI enSwPintas = 1;  |ACABA;  |FINSI;

     |PINTA #940#2;
     |PINTA #940#5;
     |PINTA #940#8;
     |PINTA #940#11;
     |PINTA #940#14;
     |PINTA #940#20;
     |PINTA #940#21;
     |PINTA #940#22;
     |PINTA #940#23;
     |PINTA #940#25;
     |PINTA #940#26;
     |PINTA #940#27;
     |PINTA #940#30;
     |PINTA #940#31;
     |PINTA #940#32;
     |PINTA #940#33;
     |PINTA #940#35;
     |PINTA #940#36;
     |PINTA #940#37;
     |PINTA #940#39;
     |PINTA #940#41;
     |PINTA #940#43;
     |PINTA #940#45;
     |PINTA #940#47;
     |PINTA #940#49;
     |PINTA #940#51;
     |PINTA #940#53;
     |PINTA #940#55;
     |PINTA #940#56;
     |PINTA #940#57;
     |PINTA #940#58;
     |PINTA #940#61;
     |PINTA #940#65;
     |PINTA #940#69;
     |PINTA #940#70;
|FPRC;

|PROCESO DedTrabajo;
     |SI #102#128 = 99;  |ACABA;  |FINSI;

     #941#9  = 0;
     #941#16 = 0;

     |SI #941#6 ! 0;
         #941#9 = 500000;
         nDiferen = #941#6 - #941#7;
         |SI nDiferen > 2000000;
             #941#9 = 375000;
         |SINO;
             |SI nDiferen > 1350000;
                 #941#9 = 500000 - ((nDiferen - 1350000) * 0.1923);
             |FINSI;
         |FINSI;

         nFactor = 1;
         |SI #941#5 ] 33;
             nFactor = 1.75;
             |SI #941#4 = "S";  nFactor = 2.25;  |FINSI;
         |FINSI;

         |SI #941#5 ] 65;  nFactor = 2.75;  |FINSI;

         #941#9 = #941#9 * nFactor;

         |SI nDiferen < #941#9;  #941#9 = nDiferen;  |FINSI;
         |SI nDiferen [ 0;     #941#9 = 0;         |FINSI;
     |FINSI;

     |SI #941#13 ! 0;
         #941#16   = 500000;
         nDiferen = #941#13 - #941#14;
         |SI nDiferen > 2000000;
             #941#16 = 375000;
         |SINO;
             |SI nDiferen > 1350000;
                 #941#16 = 500000 - ((nDiferen - 1350000) * 0.1923);
             |FINSI;
         |FINSI;

         nFactor = 1;
         |SI #941#12 ] 33;
             nFactor = 1.75;
             |SI #941#11 = "S";  nFactor = 2.25;  |FINSI;
         |FINSI;

         |SI #941#12 ] 65;   nFactor = 2.75;  |FINSI;

         #941#16 = #941#16 * nFactor;

         |SI nDiferen < #941#16;  #941#16 = nDiferen;  |FINSI;
         |SI nDiferen [ 0;      #941#16 = 0;         |FINSI;
     |FINSI;

     |PINTA #941#9;
     |PINTA #941#16;
|FPRC;

|PROCESO Anualidades;
     #940#32 = 0;

     |SI #940#28 = 0;  |ACABA;  |FINSI;

     nParte  = 3326030 + 617970;
     nResta  = 11000000;
     nTipo   = 48;

     |SI #940#28 [ 11000000;  |Y #940#28 > 6600000;
         nParte  = 1650950 + 313050;
         nResta  = 6600000;
         nTipo   = 45;
     |FINSI;

     |SI #940#28 [ 6600000;  |Y #940#28 > 4100000;
         nParte  = 863950 + 170050;

         nResta  = 4100000;
         nTipo   = 37;
     |FINSI;

     |SI #940#28 [ 4100000;  |Y #940#28 > 2100000;
         nParte  = 392550 + 75450;
         nResta  = 2100000;
         nTipo   = 28.30;
     |FINSI;

     |SI #940#28 [ 2100000;  |Y #940#28 > 600000;
         nParte  = 90000 + 18000;
         nResta  = 600000;
         nTipo   = 24;
     |FINSI;

     |SI #940#28 [ 600000;
         nParte  = 0;
         nResta  = 0;
         nTipo   = 18;
     |FINSI;

     #940#32 = nParte + (((#940#28 - nResta) * nTipo) / 100);
|FPRC;

|PROCESO TipoMedio;
     nParte  = 3326030 + 617970;
     nResta  = 11000000;
     nTipo   = 48;

     |SI #940#30 [ 11000000;  |Y #940#30 > 6600000;
         nParte  = 1650950 + 313050;
         nResta  = 6600000;
         nTipo   = 45;
     |FINSI;

     |SI #940#30 [ 6600000;  |Y #940#30 > 4100000;
         nParte  = 863950 + 170050;

         nResta  = 4100000;
         nTipo   = 37;
     |FINSI;

     |SI #940#30 [ 4100000;  |Y #940#30 > 2100000;
         nParte  = 392550 + 75450;
         nResta  = 2100000;
         nTipo   = 28.30;
     |FINSI;

     |SI #940#30 [ 2100000;  |Y #940#30 > 600000;
         nParte  = 90000 + 18000;
         nResta  = 600000;
         nTipo   = 24;
     |FINSI;

     |SI #940#30 [ 600000;
         nParte  = 0;
         nResta  = 0;
         nTipo   = 18;
     |FINSI;

     #940#33 = nParte + (((#940#30 - nResta) * nTipo) / 100);

     #940#33 = #940#33 + #940#32;
     #940#31 = ((#940#33 / #940#30) * 100) ! 2;
|FPRC;

|PROCESO Aportaciones;
     nImporte = (#940#2 + #940#11 + #940#14 + #940#15) % 20;
     #940#25  = #940#24;
     |SI #940#25 > nImporte;  #940#25 = nImporte;  |FINSI;
|FPRC;

|PROCESO MinimosFam;
     nTitular = 0;
     nConyuge = 0;

     |SI #941#3 > 0;
         nEdad    = 1999 - #941#3;
         nTitular = 550000;
         |SI nEdad  ] 65;    nTitular = 650000;   |FINSI;
         |SI #941#5 ] 33;   nTitular = 850000;   |FINSI;
         |SI #941#5 ] 65;   nTitular = 1150000;  |FINSI;
     |FINSI;

     |SI #941#10 > 0;  |Y #102#128 = 99;
         nEdad    = 1999 - #941#10;
         nConyuge = 550000;
         |SI nEdad   ] 65;    nConyuge = 650000;   |FINSI;
         |SI #941#12 ] 33;  nConyuge = 850000;   |FINSI;
         |SI #941#12 ] 65;  nConyuge = 1150000;  |FINSI;
     |FINSI;

     #940#26 = nTitular + nConyuge;

     nTHijos    = 0;
     nHijos3    = 0;
     nHijos16   = 0;
     nHijosM33  = 0;
     nHijosM65  = 0;
     nTAscen    = 0;
     nAscenM33  = 0;
     nAscenM65  = 0;

     |PARA nCampo = 17;  |SI nCampo [ 53;  |HACIENDO nCampo = nCampo + 4;
           nCampo1 = nCampo + 1;
           nCampo2 = nCampo + 2;
           nCampo3 = nCampo + 3;
           |SI #941nCampo > 0;
               nEdad    = 1999 - #941nCampo;
               nImput   = #941nCampo2 / 100;

               |SI #941nCampo3 = "DESCENDIENTE";
                   nTHijos = nTHijos + nImput;
                   |SI #941nCampo1 ] 65;
                       nHijosM65 = nHijosM65 + nImput;
                   |SINO;
                       |SI #941nCampo1 ] 33;
                           nHijosM33 = nHijosM33 + nImput;
                       |FINSI;
                   |FINSI;

                   |SI nEdad < 3;
                       nHijos3 = nHijos3  + nImput;
                   |SINO;
                       |SI nEdad < 16;
                           nHijos16 = nHijos16 + nImput;
                       |FINSI;
                   |FINSI;
               |FINSI;

               |SI #941nCampo3 = "ASCENDIENTE ";
                   nTAscen = nTAscen + nImput;
                   |SI #941nCampo1 ] 65;
                       nAscenM65 = nAscenM65 + nImput;
                   |SINO;
                       |SI #941nCampo1 ] 33;
                           nAscenM33 = nAscenM33 + nImput;
                       |FINSI;
                   |FINSI;
               |FINSI;
           |FINSI;
     |SIGUE;

     nTotalH = nTHijos - 2;
     nAl33   = nHijosM33 + nAscenM33;
     nAl65   = nHijosM65 + nAscenM65;
     |SI nTotalH < 0;  nTotalH = 0;  |FINSI;

     #940#27 = (nTHijos * 200000) + (nTotalH * 100000) + (nHijos3 * 50000);
     #940#27 = #940#27 + (nHijos16 * 25000) + (nAl33 * 300000) + (nAl65 * 600000);
     #940#27 = #940#27 + (nTAscen * 100000);

     nResto27 = #940#27;

     nSwTraba = 0;
     |SI #941#3  ! 0;  nSwTraba = nSwTraba + 1;  |FINSI;
     |SI #941#10 ! 0;  nSwTraba = nSwTraba + 1;  |FINSI;

     |SI nSwTraba = 1;  |Y nTHijos ! 0;
         #940#26 = #940#26 + 350000;
     |FINSI;
|FPRC;

|PROCESO DedVivienda;
     nBaseG = #940#40;  |SI nBaseG > 1500000;  nBaseG = 1500000;  |FINSI;
     nBaseB = #940#42;  |SI nBaseB > 1500000;  nBaseB = 1500000;  |FINSI;
     nBaseC = #940#38;  |SI nBaseC > 1500000;  nBaseC = 1500000;  |FINSI;

     nDeducido = 0;

     nBase1    = 0;
     nBase2    = 0;
     nBase3    = 0;
     nBase4    = 0;
     nBase5    = 0;
     nDedu1    = 0;
     nDedu2    = 0;
     nDedu3    = 0;
     nDedu4    = 0;
     nDedu5    = 0;

     |SI nBaseG > 750000;
         nBase1 = 750000;
         nBase2 = nBaseG - nBase1;
     |SINO;
         nBase1 = nBaseG;
     |FINSI;

     |SI nBaseB > 750000;
         nBase3 = 750000;
         nBase4 = nBaseB - nBase3;
     |SINO;
         nBase3 = nBaseB;
     |FINSI;

     nBase5 = nBaseC;

     nDedu1    = nBase1 % 25;
     nDeducido = nDeducido + nBase1;

     nDedu3    = nBase3 % 20;
     nDeducido = nDeducido + nBase3;

     nSuma = nDeducido + nBase2;
     |SI nSuma ] 1500000;
         nBase2    = 1500000 - nDeducido;
         nDeducido = 1500000;
         nDedu2    = nBase2 % 15;
     |SINO;
         nDedu2    = nBase2 % 15;
         nDeducido = nDeducido + nBase2;
     |FINSI;

     nSuma = nDeducido + nBase4;
     |SI nSuma ] 1500000;
         nBase4    = 1500000 - nDeducido;
         nDeducido = 1500000;
         nDedu4    = nBase4 % 15;
     |SINO;
         nDedu4    = nBase4 % 15;
         nDeducido = nDeducido + nBase4;
     |FINSI;

     nSuma = nDeducido + nBase5;
     |SI nSuma ] 1500000;
         nBase5    = 1500000 - nDeducido;
         nDeducido = 1500000;
         nDedu5    = nBase5 % 15;
     |SINO;
         nDedu5    = nBase5 % 15;
         nDeducido = nDeducido + nBase5;
     |FINSI;

     #940#39 = nDedu5;
     #940#41 = nDedu1 + nDedu2;
     #940#43 = nDedu3 + nDedu4;
|FPRC;

|PROCESO AjustePersonal;
     nAjuste  = #940#26;
     nImporte = #940#26 + #940#27;
     |SI nResto27 > nImporte;
         nResto27 = nImporte;
     |FINSI;

     nImporte = nResto27;
     #940#26  = #940#26 - nImporte;
     |SI #940#26 < 0;
         nImporte = -#940#26;
         #940#26 = 0;

         #940#27  = #940#27 - nImporte;
     |FINSI;
     #940#26 = nAjuste;
|FPRC;

|PROCESO AjusteDonac;
     nAjuste = #940#30 % 10;
     nBases  = #940#44 + #940#50 + #940#52 + #940#54;
     nBase1  = #940#44;
     nBase2  = #940#50;
     nBase3  = #940#52;
     nBase4  = #940#54;

     nMenor  = nAjuste;
     |SI nBases [ nMenor;  nMenor = nBases;  |FINSI;

     |SI nBase4 > nMenor;
         nBase4 = nMenor;
     |FINSI;
     nMenor = nMenor - nBase4;

     |SI nMenor > 0;
         |SI nBase3 > nMenor;
             nBase3 = nMenor;
         |FINSI;
         nMenor = nMenor - nBase3;
     |SINO;
         nBase3 = 0;
     |FINSI;

     |SI nMenor > 0;
         |SI nBase2 > nMenor;
             nBase2 = nMenor;
         |FINSI;
         nMenor = nMenor - nBase2;
     |SINO;
         nBase2 = 0;
     |FINSI;

     |SI nMenor > 0;
         |SI nBase1 > nMenor;
             nBase1 = nMenor;
         |FINSI;
         nMenor = nMenor - nBase1;
     |SINO;
         nBase1 = 0;
     |FINSI;

     #940#45 = nBase1 % 10;
     #940#51 = nBase2 % 10;
     #940#53 = nBase3 % 20;
     #940#55 = nBase4 % 25;
|FPRC;

|PROCESO Calculo;
     #940#0  = #941#6 + #941#13;
     #940#1  = #941#7 + #941#9 + #941#14 + #941#16;
     #940#2  = #940#0  - #940#1;
     #940#5  = #940#3  - #940#4;
     #940#8  = #940#6  - #940#7;
     #940#11 = #940#9  - #940#10;
     #940#14 = #940#12 - #940#13;

     #940#20 = #940#18 - #940#19;
     #940#21 = 0;
     #940#22 = 0;
     #940#23 = 0;
     |SI #940#20 < 0;
         nSuma = #940#2 + #940#5  + #940#8  + #940#11 + #940#14;
         nSuma = nSuma  + #940#15 + #940#16 + #940#17;
         #940#21 = nSuma % 10;
         #940#23 = -#940#20;
         |SI #940#21 < #940#23;  #940#23 = #940#21;  |FINSI;
     |SINO;
         #940#22 = #940#20;
     |FINSI;

     |HAZ Aportaciones;
     |HAZ MinimosFam;

     #940#30 = #940#2  + #940#5  + #940#8  + #940#11 + #940#14;
     #940#30 = #940#30 + #940#15 + #940#16 + #940#17 + #940#22;
     #940#30 = #940#30 - #940#23 - #940#25 - #940#26 - #940#27;
     #940#30 = #940#30 - #940#29;
     nImporte = 0;
     nResto27 = 0;
     |SI #940#30 < 0;
         nResto27 = -#940#30;
         |HAZ AjustePersonal;
         #940#30  = 0;
     |FINSI;

     |HAZ Anualidades;
     |HAZ TipoMedio;

     #940#35  = nResto27;

     nImporte = #940#34 % 20;
     |SI nImporte [ 0;  #940#35 = 0;  |FINSI;
     |SI nImporte < #940#35;  |Y nImporte > 0;
         #940#35 = nImporte;
     |FINSI;
     #940#36  = nImporte - #940#35;

     |SI #940#36 [ 0;
         #940#36 = 0;
     |FINSI;

     #940#37 = #940#33 + #940#36;

     |HAZ DedVivienda;
     #940#47 = #940#46;
     #940#49 = #940#48;

     |HAZ AjusteDonac;

     #940#56 = 0;
     |PARA nCampo = 39;  |SI nCampo [ 55;  |HACIENDO nCampo = nCampo + 2;
           #940#56 = #940#56 + #940nCampo;
     |SIGUE;

     #940#57 = #940#37 - #940#56;
     #940#58 = #940#57 % 85;
     #940#59 = #940#57 - #940#58;
     #940#61 = #940#57 - #940#60;
     #940#65 = #940#61  + #940#62 - #940#63 - #940#64;  |PINTA #940#65;
     #940#66 = #941#8   + #941#15;
     #940#72 = #102#150;
     #940#69 = #940#66  + #940#67 + #940#68 + #940#72;
     #940#70 = #940#65 - #940#69;
     nImporte = -#940#70;

     |SI #940#70 < 0;  |Y nImporte > #940#69;
         #940#70 = -#940#69;
     |FINSI;

     |HAZ Pintas;
|FPRC;

|PROCESO IngreCapital;  |TIPO 7;
     |SI FSalida  = 2;
         FSalida = 0;
         |ACABA;
     |FINSI;
     |SI #102#128 = 99;  |ACABA;  |FINSI;

     |PUSHV 0501 2380;

     |PARA nCampo = 135;  |SI nCampo [ 147;  |HACIENDO nCampo = nCampo + 1;
           nCampo1 = nCampo - 135;
           #943nCampo1 = #102nCampo;
     |SIGUE;

     |PINPA #0#943;
     |PINDA #0#943;
     |ENDATOS #1#943;
     |SI FSalida = 0;
         |PARA nCampo = 135;  |SI nCampo [ 147;  |HACIENDO nCampo = nCampo + 1;
               nCampo1 = nCampo - 135;
               #102nCampo = #943nCampo1;
         |SIGUE;
     |FINSI;
     |POPV;

     #940#3 = #943#10 + #943#12;
     #940#4 = #943#11;
     |PINTA #940#3;
     |PINTA #940#4;
|FPRC;

|PROCESO IngreMobilia;  |TIPO 7;
     |SI FSalida = 2;
         |ACABA;
     |FINSI;

     |SI #102#128 = 99;  |ACABA;  |FINSI;

     |PUSHV 0501 2380;

     |PARA nCampo = 148;  |SI nCampo [ 152;  |HACIENDO nCampo = nCampo + 1;
           nCampo1 = nCampo - 148;
           #944nCampo1 = #102nCampo;
     |SIGUE;

     |PINPA #0#944;
     |PINDA #0#944;
     |ENDATOS #1#944;
     |SI FSalida = 0;
         |PARA nCampo = 148;  |SI nCampo [ 152;  |HACIENDO nCampo = nCampo + 1;
               nCampo1 = nCampo - 148;
               #102nCampo = #944nCampo1;
         |SIGUE;
     |FINSI;
     |POPV;

     #940#6  = #944#0 + #944#3;
     #940#7  = #944#1 + #944#4;
     #940#72 = #944#2;
     |PINTA #940#6;
     |PINTA #940#7;
|FPRC;

|PROCESO Tipo12w0001;  |TIPO 12;
|FPRC;
