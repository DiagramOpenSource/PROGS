|FICHEROS;
     reaccdev #0;
     reemi104 #904;
     repoblac #200;
     rem00100 #100;
     rem00101 #101;
     rem00104 #104,MANTE;
     rem00105 #105,MANTE;
|FIN;

|VARIABLES;
     aAlfa1  = "";
     aAlfa2  = "";
     aAlfa3  = "";
     aTecla  = "";
     aTecla1 = "";
     aNombre = "";
     nCampo  = 0;
     nConta1 = 0;
     nConta2 = 0;

     &enSwHojas = 0;
     &enSw      = 0;
|FIN;

|PROCESO Fecha;
     aAlfa1 = #904#0 % 102;
     aAlfa2 = #904#0 % 402;
     |SI aAlfa2 = "01";  aAlfa2 = "Enero     ";  |FINSI;
     |SI aAlfa2 = "02";  aAlfa2 = "Febrero   ";  |FINSI;
     |SI aAlfa2 = "03";  aAlfa2 = "Marzo     ";  |FINSI;
     |SI aAlfa2 = "04";  aAlfa2 = "Abril     ";  |FINSI;
     |SI aAlfa2 = "05";  aAlfa2 = "Mayo      ";  |FINSI;
     |SI aAlfa2 = "06";  aAlfa2 = "Junio     ";  |FINSI;
     |SI aAlfa2 = "07";  aAlfa2 = "Julio     ";  |FINSI;
     |SI aAlfa2 = "08";  aAlfa2 = "Agosto    ";  |FINSI;
     |SI aAlfa2 = "09";  aAlfa2 = "Septiembre";  |FINSI;
     |SI aAlfa2 = "10";  aAlfa2 = "Octubre   ";  |FINSI;
     |SI aAlfa2 = "11";  aAlfa2 = "Noviembre ";  |FINSI;
     |SI aAlfa2 = "12";  aAlfa2 = "Diciembre ";  |FINSI;
     aAlfa3 = #904#0 % -104;
     #904#91 = aAlfa1 + " de " + aAlfa2 + " de " + aAlfa3;
|FPRC;

|PROCESO LineasFam;
     |SI #101#4 = "DESCENDIENTE";
         |SI #104#1 = 1;
             nConta1 = nConta1 + 1;
             |SI nConta1 > 5;  |ACABA;  |FINSI;
             nCampo = 16 + nConta1;  #904nCampo = #101#2;
             nCampo = nCampo + 5;    #904nCampo = #101#3;
             nCampo = nCampo + 5;    #904nCampo = #101#5;
             nCampo = nCampo + 5;    |SI #101#6 ! 0; #904nCampo = #101#6; |FINSI;
             nCampo = nCampo + 5;    #904nCampo = #101#7;
             nCampo = nCampo + 5;    #904nCampo = #101#8;
             nCampo = 63 + nConta1;  #904nCampo = #101#12;
         |FINSI;

         |SI #104#1 = 2;
             |SI #101#7 = "2";  |ACABA;  |FINSI;

             nConta1 = nConta1 + 1;
             |SI nConta1 > 5;  |ACABA;  |FINSI;
             nCampo = 16 + nConta1;  #904nCampo = #101#2;
             nCampo = nCampo + 5;    #904nCampo = #101#3;
             nCampo = nCampo + 5;    #904nCampo = #101#5;
             nCampo = nCampo + 5;    |SI #101#6 ! 0; #904nCampo = #101#6; |FINSI;
             nCampo = nCampo + 5;    #904nCampo = "";
             nCampo = nCampo + 5;    #904nCampo = #101#8;
             nCampo = 63 + nConta1;  #904nCampo = #101#12;
         |FINSI;

         |SI #104#1 = 3;
             |SI #101#7 = "1";  |ACABA;  |FINSI;

             nConta1 = nConta1 + 1;
             |SI nConta1 > 5;  |ACABA;  |FINSI;
             nCampo = 16 + nConta1;  #904nCampo = #101#2;
             nCampo = nCampo + 5;    #904nCampo = #101#3;
             nCampo = nCampo + 5;    #904nCampo = #101#5;
             nCampo = nCampo + 5;    |SI #101#6 ! 0; #904nCampo = #101#6; |FINSI;
             nCampo = nCampo + 5;    #904nCampo = "";
             nCampo = nCampo + 5;    #904nCampo = #101#8;
             nCampo = 63 + nConta1;  #904nCampo = #101#12;
         |FINSI;
     |FINSI;

     |SI #101#4 = "ASCENDIENTE ";
         |SI #104#1 = 1;
             nConta2 = nConta2 + 1;
             |SI nConta2 > 2;  |ACABA;  |FINSI;
             nCampo = 46 + nConta2;  #904nCampo = #101#2;
             nCampo = nCampo + 2;    #904nCampo = #101#3;
             nCampo = nCampo + 2;    #904nCampo = #101#5;
             nCampo = nCampo + 2;    |SI #101#6 ! 0; #904nCampo = #101#6; |FINSI;
             nCampo = nCampo + 2;    #904nCampo = #101#7;
             nCampo = nCampo + 2;    #904nCampo = #101#9;
         |FINSI;

         |SI #104#1 = 2;
             |SI #101#7 = "2";  |ACABA;  |FINSI;

             nConta2 = nConta2 + 1;
             |SI nConta2 > 2;  |ACABA;  |FINSI;
             nCampo = 46 + nConta2;  #904nCampo = #101#2;
             nCampo = nCampo + 2;    #904nCampo = #101#3;
             nCampo = nCampo + 2;    #904nCampo = #101#5;
             nCampo = nCampo + 2;    |SI #101#6 ! 0; #904nCampo = #101#6; |FINSI;
             nCampo = nCampo + 2;    #904nCampo = "";
             nCampo = nCampo + 2;    #904nCampo = #101#9;
         |FINSI;

         |SI #104#1 = 3;
             |SI #101#7 = "1";  |ACABA;  |FINSI;

             nConta2 = nConta2 + 1;
             |SI nConta2 > 2;  |ACABA;  |FINSI;
             nCampo = 46 + nConta2;  #904nCampo = #101#2;
             nCampo = nCampo + 2;    #904nCampo = #101#3;
             nCampo = nCampo + 2;    #904nCampo = #101#5;
             nCampo = nCampo + 2;    |SI #101#6 ! 0; #904nCampo = #101#6; |FINSI;
             nCampo = nCampo + 2;    #904nCampo = "";
             nCampo = nCampo + 2;    #904nCampo = #101#9;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE rem00101;
     #101#1;
     ;
     #0#0, 01;
     #0#0, 99;
     ;
     NULL, LineasFam;
|FIN;

|PROCESO Familiares;
     nConta1 = 0;
     nConta2 = 0;
     |BUCLE rem00101;
|FPRC;

|PROCESO Tipo1;
     #200#0 = #100#50;
     #200#1 = #100#51;
     |LEE 040#200=;
     |SI FSalida ! 0; |DDEFECTO #200;  |FINSI;

     |SI #100#6 = "S";  #904#01 = "X";     |FINSI;
     |SI #100#6 = "C";  #904#02 = "X";     |FINSI;
     |SI #100#6 = "V";  #904#03 = "X";     |FINSI;
     |SI #100#6 = "L";  #904#04 = "X";     |FINSI;
                        #904#05 = #100#7;
     |SI #100#8 ! 0;    #904#06 = #100#8;  |FINSI;
                        #904#07 = #100#11;
                        #904#08 = #100#12;
                        #904#09 = #100#13;
                        #904#10 = #100#35;
                        #904#11 = #100#36;
                        #904#12 = #100#37;
                        #904#13 = #100#38;
                        #904#14 = #100#40;
     |SI #100#41 ! 0;   #904#15 = #100#41;  |FINSI;
                        #904#16 = #100#43;
                        #904#59 = #104#2;
                        #904#60 = #104#3;
                        #904#62 = #100#88;
                        #904#63 = #100#89;

     |SI #104#2 = "X";                                 || En Individual
         |SI #104#4 = "I";
                        #904#69  = "X";
         |FINSI;
         |SI #104#4 = "O";
                        #904#72  = "X";
         |FINSI;
         |SI #104#4 = "D";
                        #904#69  = "X";
                        #904#72  = "X";
         |FINSI;
         |SI #104#5 = "I";
                        #904#70  = "X";
         |FINSI;
         |SI #104#5 = "O";
                        #904#73  = "X";
         |FINSI;
         |SI #104#5 = "D";
                        #904#70  = "X";
                        #904#73  = "X";
         |FINSI;
     |FINSI;

     |SI #104#3 = "X";                               || En Conjunta
         |SI #104#4 = "I";
                        #904#71  = "X";
         |FINSI;
         |SI #104#4 = "O";
                        #904#74  = "X";
         |FINSI;
         |SI #104#4 = "D";
                        #904#71  = "X";
                        #904#74  = "X";
         |FINSI;
     |FINSI;

     |SI #104#2 = " "; |Y #104#3 = " ";          || Que decida Hacienda
          |SI #104#4 = "I";
                         #904#69  = "X";
                         #904#70  = "X";
                         #904#71  = "X";
          |FINSI;
          |SI #104#4 = "O";
                         #904#72  = "X";
                         #904#73  = "X";
                         #904#74  = "X";
          |FINSI;
          |SI #104#4 = "D";
                         #904#69  = "X";
                         #904#70  = "X";
                         #904#71  = "X";
                         #904#72  = "X";
                         #904#73  = "X";
                         #904#74  = "X";
          |FINSI;
     |FINSI;

                         #904#75 = #100#44 + " " + #100#45;
                         #904#76 = #100#46;
                         #904#77 = #100#47;
                         #904#78 = #100#48;
                         #904#79 = #100#49;
                         #904#80 = #100#52;
                         #904#81 = #200#2;
                         #904#82 = (("00" + #100#50) % -102) + (("000" + #100#51) % -103);
                         #904#83 = #100#53 % 104;
                         #904#84 = #100#53 % 504;
                         #904#85 = #100#53 % 902;
                         #904#86 = #100#53 % 1110;
                         #904#87 = #100#54 % 104;
                         #904#88 = #100#54 % 504;
                         #904#89 = #100#54 % 902;
                         #904#90 = #100#54 % 1110;
                         |HAZ Fecha;

     |HAZ Familiares;
|FPRC;

|PROCESO Tipo2;
     |SI #100#6 = "S";  #904#01 = "X";     |FINSI;
     |SI #100#6 = "C";  #904#02 = "X";     |FINSI;
     |SI #100#6 = "V";  #904#03 = "X";     |FINSI;
     |SI #100#6 = "L";  #904#04 = "X";     |FINSI;
                        #904#05 = #100#7;
     |SI #100#8 ! 0;    #904#06 = #100#8;  |FINSI;
                        #904#07 = #100#11;
                        #904#08 = #100#12;
                        #904#09 = #100#13;
                        #904#61 = "X";
                        #904#62 = #100#88;

     |SI #104#4 = "I";
                        #904#69  = "X";
     |FINSI;
     |SI #104#4 = "O";
                        #904#72  = "X";
     |FINSI;
     |SI #104#4 = "D";
                        #904#69  = "X";
                        #904#72  = "X";
     |FINSI;
                         #904#83 = #100#53 % 104;
                         #904#84 = #100#53 % 504;
                         #904#85 = #100#53 % 902;
                         #904#86 = #100#53 % 1110;
                         |HAZ Fecha;

     |HAZ Familiares;
|FPRC;

|PROCESO Tipo3;
     |SI #100#6 = "S";  #904#01 = "X";     |FINSI;
     |SI #100#6 = "C";  #904#02 = "X";     |FINSI;
     |SI #100#6 = "V";  #904#03 = "X";     |FINSI;
     |SI #100#6 = "L";  #904#04 = "X";     |FINSI;
                        #904#05 = #100#40;
     |SI #100#41 ! 0;   #904#06 = #100#41; |FINSI;
                        #904#43 = #100#11;
                        #904#08 = #100#12;
                        #904#09 = #100#13;
                        #904#61 = "X";
                        #904#62 = #100#88;

     |SI #104#5 = "I";
                        #904#69  = "X";
     |FINSI;
     |SI #104#5 = "O";
                        #904#72  = "X";
     |FINSI;
     |SI #104#5 = "D";
                        #904#69  = "X";
                        #904#72  = "X";
     |FINSI;
                        #904#83 = #100#54 % 104;
                        #904#84 = #100#54 % 504;
                        #904#85 = #100#54 % 902;
                        #904#86 = #100#54 % 1110;
                        |HAZ Fecha;

     |HAZ Familiares;
|FPRC;

|PROCESO Carga104;
     |SI enSwHojas = 0;
         |PARA;  |SI;  |HACIENDO;
             |CUADRO 1521 2155;
             |PINTA 1628, "INTRODUZCA HOJA MODELO";
             |ATRI P;  |PINTA 1836, "(104)";  |ATRI p;
             |PINTA 1922, "컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴";
             |PINTA 2023, "PULSE <F2> CUANDO ESTE PREPARADO";

             aTecla   = "";
             aTecla1  = &255 + "824";
             |PARA; |SI aTecla ! aTecla1; |HACIENDO;
                    |LEETECLA aTecla;
             |SIGUE;

             |PINPA #0#904;
             |PINDA #0#904;

             |INFOR "m104ch01";
             |SI FSalida ! 0;  |SAL;  |FINSI;

             |PDEFECTO #904, 1, 92;

             |SI #104#1 = 1;  |HAZ Tipo1;  |FINSI;
             |SI #104#1 = 2;  |HAZ Tipo2;  |FINSI;
             |SI #104#1 = 3;  |HAZ Tipo3;  |FINSI;

             |PRINT;
             |PIEINF;
             |FININF;

             |CONFI "2400NDesea repetir la Emision : ";
             |SI FSalida ! 0;  |SAL;  |FINSI;
         |SIGUE;
     |SINO;
         |INFOR "m104ch02";
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |PDEFECTO #904, 1, 92;

         |SI #104#1 = 1;  |HAZ Tipo1;  |FINSI;
         |SI #104#1 = 2;  |HAZ Tipo2;  |FINSI;
         |SI #104#1 = 3;  |HAZ Tipo3;  |FINSI;

         |PRINT;
         |PIEINF;
         |FININF;
     |FINSI;
|FPRC;

|PROCESO Carga105;
     |HAZ Fecha;
     |QBF aNombre;

     |PARA;  |SI;  |HACIENDO;
         |PINTA 1428, "INTRODUZCA HOJA MODELO";
         |ATRI P;  |PINTA 1535, "(105)";  |ATRI p;
         aAlfa1 = "[" + (("00000" + #105#0) % -105) + " " + aNombre + "]";
         |PINTA 1820, aAlfa1;
         aAlfa1 = "" * 78;
         |PINTA 1902, aAlfa1;
         |PINTA 2023, "PULSE <F2> CUANDO ESTE PREPARADO";

         aTecla   = "";
         aTecla1  = &255 + "824";
         |PARA; |SI aTecla ! aTecla1; |HACIENDO;
                |LEETECLA aTecla;
         |SIGUE;

         |PINPA #0#904;
         |PINDA #0#904;

         |INFOR "m105ch01";
         |SI FSalida = 0;
             |PRINT;
             |PIEINF;
             |FININF;
         |FINSI;

         |CONFI "2400NDesea repetir la Emision : ";
         |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;
|FPRC;

|PROCESO EmiteModelos;
     |ABRE #100;
     #100#0 = #0#0;
     |LEE 040#100=;
     |SI FSalida ! 0;
         |MENAV  "      No existe datos de los Contribuyentes";
         |CIERRA #100;
         |ACABA;
     |FINSI;
     |CIERRA #100;

     |ABRE #104;
     #104#0 = #0#0;
     |LEE 101#104=;
     |SI FSalida ! 0;
         |MENAV  "      No existe datos informados en el Modelo 104";
         |CIERRA #104;
         |ACABA;
     |FINSI;

     |SI #104#8 = "S";
         |CONFI "2400NModelo ya emitido, desea volverlo a Emitir : ";
         |SI FSalida ! 0;
             |LIBERA #104;
             |CIERRA #104;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #104#1 = 4;
         |MENAV "     El Contribuyente no hace el Modelo 104 y 105";
         |LIBERA #104;
         |CIERRA #104;
         |ACABA;
     |FINSI;

     |PUSHV 0501 2380;
     |PINPA #0#904;
     |PINDA #0#904;
     |ENDATOS #1#904;
     |SI FSalida ! 0;  |POPV;  |ACABA;  |FINSI;

     |IMPRE 0;
     |SI FSalida ! 0;  |POPV;  |ACABA;  |FINSI;

     |ABRE #200;
     |HAZ Carga104;
     |CIERRA #200;

     |SI #104#6 = "S";
         |ABRE #105;
         #105#0 = #0#0;
         #105#1 = #100#1;
         |LEE 040#105=;
         |SI FSalida ! 0;  |DDEFECTO #105;  |FINSI;
         |CIERRA #105;

         aNombre = #100#5;
         |SI enSwHojas = 0;
             |HAZ Carga105;
         |SINO;
             |INFOR "m105ch02";
             |SI FSalida = 0;
                 enSw = 1;
                 |PRINT;
                 |PIEINF;
                 |FININF;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #104#7 = "S";
         |ABRE #105;
         #105#0  = #0#0;
         #105#1  = #100#35;
         |LEE 040#105=;
         |SI FSalida ! 0;  |DDEFECTO #105;  |FINSI;
         |CIERRA #105;

         aNombre = #100#39;
         |SI enSwHojas = 0;
             |HAZ Carga105;
         |SINO;
             |SI #104#6 = "S";
                 |INFOR "m105ch02";
                 |SI FSalida = 0;
                     enSw = 0;
                     |PIEINF;
                     |FININF;
                 |FINSI;
             |FINSI;

             |INFOR "m105ch02";
             |SI FSalida = 0;
                  enSw = 1;
                 |PRINT;
                 |PIEINF;
                 |FININF;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #104#6 = "N"; |Y #104#7 = "N";
         |INFOR "m105ch02";
         |SI FSalida = 0;
             enSw = 0;
             |PIEINF;
             |FININF;
         |FINSI;
     |FINSI;

     |FINIMP;
     |POPV;

     #104#8 = "S";
     #104#9 = #904#0;
     |GRABA 020#104a;
     |LIBERA #104;
     |CIERRA #104;
|FPRC;
