|FICHEROS;
     rem00002 #0,MANTE;
     rem00021 #1;
     reparame #4;
     rem00100 #5;
     repoblac #6;
     rerenpre #7;
     reauxdiv #8;
     retabla3 #9;
     rem01002 #10;
     rem00101 #11;
     reauxpai #18;
     reauxrta #19;
     retabla7 #407;

     rem00003 #900,MANTE;     || Modelo 210
     rew00006 #901,MANTE;    || Utilidad Modelo 210

     rem00004 #902,MANTE;     || Modelo 212
     rew00007 #903,MANTE;     || Utilidad Modelo 212

     rem00005 #904,MANTE;     || Modelo 214
     rem00010 #1905,MANTE;    || Modelo 213
     rem00011 #1906,MANTE;    || Inmuebles modelo 213
     rem00012 #1907,MANTE;    || Socios modelo 213

     rem00016 #916;           || Modelo 211 Adquirentes y Transmitentes
     rem00017 #917;           || Modelo 211
     rem00099 #918;
|FIN;

|VARIABLES;
 {-1}aMenu  = "";
     aMenu1 = "2400";
     aMenu2 = "1";
     aMenu3 = "";
     aMenu4 = "EA";
     aMenu5 = "En efectivo";
     aMenu6 = "Adeudo en cuenta";

     nOpcion = 0;

     &eaTabla    = "";
     &eaDestino  = "";
     &eaAlfa     = "";
     &enError    = 0;
     &enPosicion = 0;
     &enComp     = 0;

     nCampo      = 0;
     nLCod       = 0;
     nLDes       = 0;
     nCalc       = 0;

     QueTipo       = 0;
     aTipo         = "";
     aClave        = "";
     aAlfa1        = "";
     aAlfa2        = "";
     nLinea        = 0;
     nCoefi        = 0;
     Comodin       = "";
     Coefic        = 0;
     Calc          = 0;
     Conjunta      = 0;
     aAlfa         = "";
     SwNuevo       = 0;
     nTDias        = 0;
     nCanti1       = 0;
     nCanti2       = 0;
     fFechaLim     = @;
     nTodosDias    = 0;
     nParciDias    = 0;

     XPara         = 0;
     Posi          = 0;
     Valfa0        = "";
     Valfa1        = "";
     Valfa2        = "";
     SwPunto       = 0;
     Vanyo         = 0;
     Vanyo1        = "";
     Vanyo2        = "";
     Vanyon1       = 0;
     Vanyon2       = 0;
     Coefi         = 0;
     Coef          = 0;
     Valor1        = 0;
     Fecha         = 0;
     VAmortiza1    = 0;
     VAmortiza     = 0;
     DesdeFec      = @;
     HastaFec      = @;
     VAdquisicio   = 0;
     FechaCal      = 0;
     VIncroDismi   = 0;
     VIncremento   = 0;
     Exento        = 0;
     Porce         = 0;
     FInicio       = @;
     NFami         = 0;
     Base          = 0;
     Tecla         = 0;
     SwError       = 0;
     CampoTrabajo  = 0;
     Campo1        = 0;
     Campo2        = 0;
     Campo3        = 0;
     Valfa         = "";
     VAntes        = "";
     ModoE         = 0;
     nSalir        = 0;
     nSalir1       = 0;
     FEstado       = 0;
     Modelo        = 214;
     Recoge = 0;
     ModoEntrada   = 0;
     nAutonomia    = 0;

     &aTipoGente = "";
     &indivi      = "";
     &errorlin    = 0;
     &empresa     = 0;
     &nombre      = "";
     &modo        = 0;
     &modelito    = 0;
     &numerica1   = 0;  &numerica2  = 0;   &numerica3  = 0;
     &numerica4   = 0;  &numerica5  = 0;   &numerica6  = 0;
     &numerica7   = 0;  &numerica8  = 0;   &numerica9  = 0;
     &numerica10  = 0;  &numerica11 = 0;   &numerica12 = 0;
     &numerica13  = 0;  &numerica14 = 0;   &numerica15 = 0;
     &numerica16  = 0;  &numerica17 = 0;   &numerica18 = 0;
     &numerica19  = 0;  &numerica20 = 0;   &numerica21 = 0;
     &numerica22  = 0;  &numerica23 = 0;   &numerica24 = 0;
     &numerica25  = 0;  &numerica26 = 0;   &numerica27 = 0;
     &numerica28  = 0;  &numerica29 = 0;   &numerica30 = 0;
     &numerica31  = 0;  &numerica32 = 0;   &numerica33 = 0;
     &numerica34  = 0;  &numerica35  = 0;  &numerica36 = 0;
     &numerica37  = 0;  &numerica38  = 0;  &numerica39 = 0;
     &numerica40  = 0;  &numerica41  = 0;  &numerica42 = 0;

     &alfanumer1  = ""; &alfanumer2  = ""; &alfanumer3  = "";
     &alfanumer4  = ""; &alfanumer5  = ""; &alfanumer6  = "";
     &alfanumer7  = ""; &alfanumer8  = ""; &alfanumer9  = "";
     &alfanumer10 = ""; &alfanumer11 = ""; &alfanumer12 = "";
     &alfanumer13 = ""; &alfanumer14 = ""; &alfanumer15 = "";
     &alfanumer16 = ""; &alfanumer17 = ""; &alfanumer18 = "";

     &fechas1     = @;  &fechas2     = @;  &fechas3     = @;
     &fechas4     = @;  &fechas5     = @;

     &enEmpresa = 0;
     &enLineal  = 0;
     &enModo    = 0;

{-1} MGeneral   = "";
     MGeneral1  = "1563";
     MGeneral2  = "1";
     MGeneral3  = "5";
     MGeneral4  = "Inmueble   ";
     MGeneral5  = "Modelo 210 ";
     MGeneral6  = "Modelo 211 ";
     MGeneral7  = "Modelo 212 ";
     MGeneral8  = "Modelo 213 ";
     ||MGeneral9  = "Modelo 214 ";

{-1} M211Mod   = "";
     M211Mod1  = "1862";
     M211Mod2  = "1";
     M211Mod3  = "3";
     M211Mod4  = "Adquirente  ";
     M211Mod5  = "Transmitente";
     M211Mod6  = "Liquidacion ";
|FIN;

|PROCESO ConsuGente;
     |SI FSalida ! 13;  |ACABA;  |FINSI;

     aTipoGente = #0Campo;
     |SUB_EJECUTA "rez00003";
     #0Campo = aTipoGente;
     |PINTA #0Campo;
|FPRC;

|PROCESO Mayus2;
     #0Campo = #0Campo > #1Campo;
     |PINTA #0Campo;
|FPRC;

|PROCESO Descend;
   |SI #rem00101#4 = "DESCENDIENTE"; |Y #rem00101#5 ] "1982";
      indivi = "N";
   |FINSI;
|FPRC;

|DEFBUCLE Descend;
#rem00101#1;
;
#rem00100#0,01;
#rem00100#0,99;
;
NULL,Descend;
|FIN;

|PROCESO Perceptor;
     |ABRE #5;
     #5#0 = #0#0;
     |LEE 040#5=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #5;

     indivi = "S";
     |SI #5#40 ! "    ";  |Y #5#40 ! "0000";  indivi = "N"; |FINSI;

     |BUCLE Descend;

     |C_M #0#8,  1, "N";  |C_M #0#9,  1, "N";  |C_M #0#10, 1, "N";
     |C_M #0#11, 1, "N";  |C_M #0#12, 1, "N";  |C_M #0#13, 1, "N";

                     #0#4 = "VARIOS   ";
     |SI #0#3 = "T"; #0#4 = "TITULAR   "; |FINSI;
     |SI #0#3 = "C"; #0#4 = "CONYUGE   "; |FINSI;
     |SI #0#3 = "G"; #0#4 = "CONJUNTA  "; |FINSI;
     |SI #0#3 = "1"; #0#4 = "1 FAMILIAR"; |FINSI;
     |SI #0#3 = "2"; #0#4 = "2 FAMILIAR"; |FINSI;
     |SI #0#3 = "3"; #0#4 = "3 FAMILIAR"; |FINSI;
     |SI #0#3 = "4"; #0#4 = "4 FAMILIAR"; |FINSI;
     |SI #0#3 = "V";
         |SI indivi = "N";
             |CAMPO_MODIFICA #0#8,  1, "S";
             |CAMPO_MODIFICA #0#9,  1, "S";
             |CAMPO_MODIFICA #0#10, 1, "S";
             |CAMPO_MODIFICA #0#11, 1, "S";
             |CAMPO_MODIFICA #0#12, 1, "S";
             |CAMPO_MODIFICA #0#13, 1, "S";
         |SINO;
             |CAMPO_MODIFICA #0#8, 1, "S";
             #0#9  = 0; |PINTA #0#9;
             #0#10 = 0; |PINTA #0#10;
             #0#11 = 0; |PINTA #0#11;
             #0#12 = 0; |PINTA #0#12;
             #0#13 = 0; |PINTA #0#13;
         |FINSI;
     |SINO;
         #0#8  = 0; |PINTA #0#8;
         #0#9  = 0; |PINTA #0#9;
         #0#10 = 0; |PINTA #0#10;
         #0#11 = 0; |PINTA #0#11;
         #0#12 = 0; |PINTA #0#12;
         #0#13 = 0; |PINTA #0#13;
     |FINSI;

     |PINTA #0#4;
|FPRC;

|PROCESO Tipo;
     |SI #0#6 = "S";  #0#7 = "VIVIENDA";  |FINSI;
     |SI #0#6 = "N";  #0#7 = "OTROS";     |FINSI;
     |PINTA #0#7;
|FPRC;

|PROCESO PonArte;
      MGeneral4    = "Inmueble   ";
      MGeneral5    = "Modelo 210 ";
      MGeneral6    = "Modelo 211 ";
      MGeneral7    = "Modelo 212 ";
      MGeneral8    = "Modelo 213 ";
      || MGeneral9    = "Modelo 214 ";

      |ABRE #1;
      #1#0 = #0#0;
      #1#1 = #0#1;
      |LEE 040#1=;
      |SI FSalida = 0;  MGeneral4    = "Inmueble  *";  |FINSI;
      |CIERRA #1;

      |ABRE #900;
      #900#0 = #0#0;
      #900#1 = #0#1;
      |LEE 040#900=;
      |SI FSalida = 0;  MGeneral5    = "Modelo 210*";  |FINSI;
      |CIERRA #900;

      |ABRE #917;
      #917#0 = #0#0;
      #917#1 = #0#1;
      |LEE 040#917=;
      |SI FSalida = 0;  MGeneral6    = "Modelo 211*";  |FINSI;
      |CIERRA #917;

      |ABRE #902;
      #902#0 = #0#0;
      #902#1 = #0#1;
      |LEE 040#902=;
      |SI FSalida = 0;  MGeneral7    = "Modelo 212*";  |FINSI;
      |CIERRA #902;

      |ABRE #1905;
      #1905#0 = #0#0;
      #1905#1 = #0#1;
      |LEE 040#1905=;
      |SI FSalida = 0;  MGeneral8    = "Modelo 213*";  |FINSI;
      |CIERRA #1905;
/*
      |ABRE #904;
      #904#0 = #0#0;
      #904#1 = #0#1;
      |LEE 040#904=;
      |SI FSalida = 0;  MGeneral9    = "Modelo 214*";  |FINSI;
      |CIERRA #904;
*/
|FPRC;

|PROCESO Borra916;
     |BORRA 020#916a;
     |LIBERA #916;
|FPRC;

|DEFBUCLE rem00016B;
     #916#1;
     ;
     #0#0, #0#1, " ", 00;
     #0#0, #0#1, "z", 99;
     be;
     NULL, Borra916;
|FIN;

|PROCESO Tipo2M02;  |TIPO 2;
     modelito = (FEntrada / 100) ! 0;
     ModoE    = 0 +. 1;

     |SI modelito = 3;
         |ABRE #1;    #001#0 = #0#0; #001#1 = #0#1; |BORRA 140#001c;  |LIBERA #001;  |CIERRA #001;
         |ABRE #918;  #918#0 = #0#0; #918#1 = "A1"; #918#2 = #0#1; |BORRA 140#918c;  |LIBERA #001;  |CIERRA #001;
         |ABRE #900;  #900#0 = #0#0; #900#1 = #0#1; |BORRA 140#900c;  |LIBERA #900;  |CIERRA #900;
         |ABRE #902;  #902#0 = #0#0; #902#1 = #0#1; |BORRA 140#902c;  |LIBERA #902;  |CIERRA #902;
         |ABRE #904;  #904#0 = #0#0; #904#1 = #0#1; |BORRA 140#904c;  |LIBERA #904;  |CIERRA #904;
         |ABRE #917;  #917#0 = #0#0; #917#1 = #0#1; |BORRA 140#917c;  |LIBERA #917;  |CIERRA #917;
         |BUCLE rem00016B;
         enEmpresa = #0#0; enLineal  = #0#1; enModo    = 3; |SUB_EJECUTA_NP "rem00021";
     |FINSI;

     |SI ModoE ! 1; |ACABA; |FINSI;

     |PUSHV 0501 2380;
     nSalir      = 0;
     |PARA;  |SI nSalir = 0;  |HACIENDO;
         nSalir = 1;
         |HAZ PonArte;
         |MENUG MGeneral;
         MGeneral2 = FSalida;
         |SI MGeneral2 ] 1; |Y MGeneral2 [ 6;
             |SI MGeneral2 = 1;
                nSalir    = 0;
                enEmpresa = #0#0;
                enLineal  = #0#1;
                enModo    = 2;
                |SUB_EJECUTA_NP "rem00021.tab;Extranjeros";
                |ABRE #1;
                #rem00021#0 = #0#0;
                #rem00021#1 = #0#1;
                |LEE 010#rem00021.=;
                |SI FSalida = 0;
                   #rem00002#5 = #rem00021#13;
                   |GRABA 020#rem00002.a;
                |FINSI;
                |CIERRA #1;
             |FINSI;
             Modelo = 0;
             |SI MGeneral2 = 2; nSalir = 0;  |HAZ Modelo210;    |FINSI;
             |SI MGeneral2 = 3; nSalir = 0;  |HAZ Modelo211;    |FINSI;
             |SI MGeneral2 = 4; nSalir = 0;  |HAZ Modelo212;    |FINSI;
             |SI MGeneral2 = 5; nSalir = 0;  |HAZ Modelo213;    |FINSI;
             |SI MGeneral2 = 6; nSalir = 0;  |HAZ Modelo214;    |FINSI;
         |FINSI;
     |SIGUE;
     |POPV;
|FPRC;

|PROCESO Tipo13Inm; |TIPO 13;
      MGeneral4    = "Inmueble   ";
      MGeneral5    = "Modelo 210 ";
      MGeneral6    = "Modelo 211 ";
      MGeneral7    = "Modelo 212 ";
      MGeneral8    = "Modelo 213 ";
      || MGeneral9    = "Modelo 214 ";

      |ABRE #1;
      #1#0 = #0#0;
      #1#1 = #0#1;
      |LEE 040#1=;
      |SI FSalida = 0;  MGeneral4    = "Inmueble  *";  |FINSI;
      |CIERRA #1;

      |ABRE #900;
      #900#0 = #0#0;
      #900#1 = #0#1;
      |LEE 040#900=;
      |SI FSalida = 0;  MGeneral5    = "Modelo 210*";  |FINSI;
      |CIERRA #900;

      |ABRE #917;
      #917#0 = #0#0;
      #917#1 = #0#1;
      |LEE 040#917=;
      |SI FSalida = 0;  MGeneral6    = "Modelo 211*";  |FINSI;
      |CIERRA #917;

      |ABRE #902;
      #902#0 = #0#0;
      #902#1 = #0#1;
      |LEE 040#902=;
      |SI FSalida = 0;  MGeneral7    = "Modelo 212*";  |FINSI;
      |CIERRA #902;

      |ABRE #1905;
      #1905#0 = #0#0;
      #1905#1 = #0#1;
      |LEE 040#1905=;
      |SI FSalida = 0;  MGeneral8    = "Modelo 213*";  |FINSI;
      |CIERRA #1905;
/*
      |ABRE #904;
      #904#0 = #0#0;
      #904#1 = #0#1;
      |LEE 040#904=;
      |SI FSalida = 0;  MGeneral9    = "Modelo 214*";  |FINSI;
      |CIERRA #904;
*/
     |PINTA 1564, MGeneral4;
     |PINTA 1664, MGeneral5;
     |PINTA 1764, MGeneral6;
     |PINTA 1864, MGeneral7;
     |PINTA 1964, MGeneral8;
     ||PINTA 2064, MGeneral9;
|FPRC;

|PROCESO Tipo11; |TIPO 11;
      |SI enModo = 4; ||PEPE
         |SI FSalida = 10;
            |PUSHV 0501 2380;
            |ABRE #900;
            #900#0 = #0#0;
            #900#1 = #0#1;
            |LEE 140#900=;
            |SI FSalida = 0;
               |PINPA #0#900;
               |PINDA #0#900;
               |PAUSA;
            |FINSI;
            |POPV;
            |ERROR;
         |FINSI;
         |SI FSalida = 11;
            |PUSHV 0501 2380;
            |ABRE #917;
            #917#0 = #0#0;
            #917#1 = #0#1;
            |LEE 140#917=;
            |SI FSalida = 0;
               |PINPA #0#917;
               |PINDA #0#917;
               |PAUSA;
            |FINSI;
            |POPV;
            |ERROR;
         |FINSI;
         |SI FSalida = 12;
            |PUSHV 0501 2380;
            |ABRE #902;
            #902#0 = #0#0;
            #902#1 = #0#1;
            |LEE 140#902=;
            |SI FSalida = 0;
               |PINPA #0#902;
               |PINDA #0#902;
               |PAUSA;
            |FINSI;
            |POPV;
            |ERROR;
         |FINSI;
         |SI FSalida = 13;
            |MENAV "    Este modelo se ha derogado para el ejercicio de 2008";
            |ERROR; |ACABA;

            |PUSHV 0501 2380;
            |ABRE #904;
            #904#0 = #0#0;
            #904#1 = #0#1;
            |LEE 140#904=;
            |SI FSalida = 0;
               |PINPA #0#904;
               |PINDA #0#904;
               |PAUSA;
            |FINSI;
            |POPV;
            |ERROR;
         |FINSI;
      |FINSI;

|FPRC;

 **********************************************************************
 PROCESOS DEL MANTENIMIENTO 210
 **********************************************************************

 PROCESOS PROPIOS DEL PROGRAMA rem00003

|PROCESO CargaDatos901;
     |PARA Campo1 = 1;  |SI Campo1 [ 17;  |HACIENDO Campo1 = Campo1 + 1;
           |C_M #901Campo1, 1, "S";
           |C_V #901Campo1, 1, "S";
     |SIGUE;

     |DDEFECTO #901;
     |SI CampoTrabajo = 2;
         #901#0  = "Sujeto pasivo, Representante o Responsable solidario (1)";
         |PARA Campo1 = 1;  |SI Campo1 [ 14;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 14;
               #901Campo1  = #900Campo2;
         |SIGUE;
         |C_M #901#15, 1, "N";  |C_V #901#15, 1, "N";  #901#15 = "";
         |C_M #901#16, 1, "N";  |C_V #901#16, 1, "N";  #901#16 = "";
         |C_M #901#17, 1, "N";  |C_V #901#17, 1, "N";  #901#17 = 0;
     |FINSI;

     |SI CampoTrabajo = 4;
         Valfa   = ("Sujeto pasivo " + (" " * 52)) % 152;
         #901#0  = Valfa;
         #901#1  = #900#29;
         #901#2  = #900#30;
         #901#3  = #900#31;
         #901#15 = #900#32;
         #901#16 = #900#33;
         #901#17 = #900#34;
         #901#5  = #900#35;
         #901#13 = #900#36;
         #901#6  = #900#139;
         #901#7  = #900#140;
         #901#8  = #900#141;
         #901#9  = #900#142;
         #901#13 = #900#36;

         |C_M #901#4,  1, "N";  |C_V #901#4,  1, "N";
         |C_M #901#6,  1, "N";  |C_V #901#6,  1, "N";
         |C_M #901#7,  1, "N";  |C_V #901#7,  1, "N";
         |C_M #901#8,  1, "N";  |C_V #901#8,  1, "N";
         |C_M #901#9,  1, "N";  |C_V #901#9,  1, "N";
         |C_M #901#10, 1, "N";  |C_V #901#10, 1, "N";
         |C_M #901#11, 1, "N";  |C_V #901#11, 1, "N";
         |C_M #901#12, 1, "N";  |C_V #901#12, 1, "N";
         |C_M #901#14, 1, "N";  |C_V #901#14, 1, "N";
     |FINSI;

     |SI CampoTrabajo = 5;
         Valfa   = ("Representante del Sujeto pasivo" + (" " * 52)) % 152;
         #901#0  = Valfa;
         |PARA Campo1 = 1;  |SI Campo1 [ 14;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 36;
               #901Campo1  = #900Campo2;
         |SIGUE;
         |C_M #901#15, 1, "N";  |C_V #901#15, 1, "N";  #901#15 = "";
         |C_M #901#16, 1, "N";  |C_V #901#16, 1, "N";  #901#16 = "";
         |C_M #901#17, 1, "N";  |C_V #901#17, 1, "N";  #901#17 = 0;
     |FINSI;

     |SI CampoTrabajo = 6; |O CampoTrabajo = 143;
         Valfa   = ("Responsable solidario (Pagador/Retenedor)"+ (" " * 52)) % 152;
         #901#0  = Valfa;

         |PARA Campo1 = 1;  |SI Campo1 [ 9;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 50;
               #901Campo1  = #900Campo2;
         |SIGUE;

         |PARA Campo1 = 11;  |SI Campo1 [ 14; |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 49;
               #901Campo1  = #900Campo2;
         |SIGUE;

         |C_M #901#10, 1, "N";  |C_V #901#10, 1, "N";  #901#10 = "";
         |C_M #901#15, 1, "N";  |C_V #901#15, 1, "N";  #901#15 = "";
         |C_M #901#16, 1, "N";  |C_V #901#16, 1, "N";  #901#16 = "";
         |C_M #901#17, 1, "N";  |C_V #901#17, 1, "N";  #901#17 = 0;
     |FINSI;

     |SI CampoTrabajo = 7;
         Valfa   = ("Responsable solidario (Depositario)"+ (" " * 52)) % 152;
         #901#0  = Valfa;

         |PARA Campo1 = 1;  |SI Campo1 [ 9;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 63;
               #901Campo1  = #900Campo2;
         |SIGUE;

         |PARA Campo1 = 11;  |SI Campo1 [ 14; |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 62;
               #901Campo1  = #900Campo2;
         |SIGUE;

         |C_M #901#10, 1, "N";  |C_V #901#10, 1, "N";  #901#10 = "";
         |C_M #901#15, 1, "N";  |C_V #901#15, 1, "N";  #901#15 = "";
         |C_M #901#16, 1, "N";  |C_V #901#16, 1, "N";  #901#16 = "";
         |C_M #901#17, 1, "N";  |C_V #901#17, 1, "N";  #901#17 = 0;
     |FINSI;

     |SI CampoTrabajo = 8;
         Valfa   = ("Responsable solidario (Gestor)"+ (" " * 52)) % 152;
         #901#0  = Valfa;

         |PARA Campo1 = 1;  |SI Campo1 [ 9;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 76;
               #901Campo1  = #900Campo2;
         |SIGUE;

         |PARA Campo1 = 11;  |SI Campo1 [ 14; |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 75;
               #901Campo1  = #900Campo2;
         |SIGUE;

         |C_M #901#10, 1, "N";  |C_V #901#10, 1, "N";  #901#10 = "";
         |C_M #901#15, 1, "N";  |C_V #901#15, 1, "N";  #901#15 = "";
         |C_M #901#16, 1, "N";  |C_V #901#16, 1, "N";  #901#16 = "";
         |C_M #901#17, 1, "N";  |C_V #901#17, 1, "N";  #901#17 = 0;
     |FINSI;
|FPRC;

|PROCESO EntraDatos901;
     Valfa = #901#0;  |QBT Valfa;
     |SI Valfa = "";  |ACABA;  |FINSI;

     |PUSHV 0501 2380;
     |PINPA #0#901;

     |SI CampoTrabajo = 4; |PINTA 1802, "Municipio "; |FINSI;

     |PINDA #0#901;
     |ENDATOS #1#901;
     |SI FSalida ! 0;  |POPV;  |ACABA;  |FINSI;

     |SI CampoTrabajo = 2;
         |PARA Campo1 = 1;  |SI Campo1 [ 14;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 14;
               #900Campo2 = #901Campo1;
         |SIGUE;
     |FINSI;

     |SI CampoTrabajo = 4;
         Valfa   = ("Sujeto pasivo " + (" " * 52)) % 152;
         #900#138 = #901#4;
         #900#139 = #901#6;
         #900#140 = #901#7;
         #900#141 = #901#8;
         #900#142 = #901#9;
         #900#29 = #901#1;
         #900#30 = #901#2;
         #900#31 = #901#3;
         #900#32 = #901#15;
         #900#33 = #901#16;
         #900#34 = #901#17;
         #900#35 = #901#5;
         #900#36 = #901#13;
     |FINSI;

     |SI CampoTrabajo = 5;
         |PARA Campo1 = 1;  |SI Campo1 [ 14;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 36;
               #900Campo2 = #901Campo1;
         |SIGUE;
     |FINSI;

     |SI CampoTrabajo = 6; |O CampoTrabajo = 143;
         |PARA Campo1 = 1;  |SI Campo1 [ 9;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 50;
               #900Campo2 = #901Campo1;
         |SIGUE;

         |PARA Campo1 = 11;  |SI Campo1 [ 14;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 49;
               #900Campo2 = #901Campo1;
         |SIGUE;
     |FINSI;

     |SI CampoTrabajo = 7;
         |PARA Campo1 = 1;  |SI Campo1 [ 9;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 63;
               #900Campo2 = #901Campo1;
         |SIGUE;

         |PARA Campo1 = 11;  |SI Campo1 [ 14;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 62;
               #900Campo2 = #901Campo1;
         |SIGUE;
     |FINSI;

     |SI CampoTrabajo = 8;
         |PARA Campo1 = 1;  |SI Campo1 [ 9;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 76;
               #900Campo2 = #901Campo1;
         |SIGUE;

         |PARA Campo1 = 11;  |SI Campo1 [ 14;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 75;
               #900Campo2 = #901Campo1;
         |SIGUE;
     |FINSI;

     |POPV;
|FPRC;

|PROCESO CDatos900C90;
     |PUSHV 0501 2380;
     |D_CUADRO 1717, 2380;
     |BLANCO 1818 2279;
     |ATRI R; |PINTA 1718, " TIPO RENTA, DIVISA Y SITUACION INMUEBLE (Rentas tipo 01 y 02)"; |ATRI N;
     |PINTA 1818, "Tipo Renta                                                    ";
     |PINTA 1918, "Direccion                                                     ";
     |PINTA 2018, "C.P.                                                          ";
     |PINTA 2118, "Pais                                                          ";
     |PINTA 2218, "Clave de Divisa :";
     |C_M #900#132, 1, "S"; |C_V #900#132, 1, "S";  |C_P #900#132, 1, 1830;
     |C_M #900#122, 1, "S"; |C_V #900#122, 1, "S";  |C_P #900#122, 1, 1928;
     |C_M #900#123, 1, "S"; |C_V #900#123, 1, "S";  |C_P #900#123, 1, 1931;
     |C_M #900#124, 1, "S"; |C_V #900#124, 1, "S";  |C_P #900#124, 1, 1958;
     |C_M #900#125, 1, "S"; |C_V #900#125, 1, "S";  |C_P #900#125, 1, 1964;
     |C_M #900#126, 1, "S"; |C_V #900#126, 1, "S";  |C_P #900#126, 1, 1967;
     |C_M #900#127, 1, "S"; |C_V #900#127, 1, "S";  |C_P #900#127, 1, 1970;
     |C_M #900#129, 1, "S"; |C_V #900#129, 1, "S";  |C_P #900#129, 1, 2023;
     |C_M #900#130, 1, "S"; |C_V #900#130, 1, "S";  |C_P #900#130, 1, 2025;
     |C_M #900#128, 1, "S"; |C_V #900#128, 1, "S";  |C_P #900#128, 1, 2029;
     |C_M #900#131, 1, "S"; |C_V #900#131, 1, "S";  |C_P #900#131, 1, 2123;
     |C_M #900#133, 1, "S"; |C_V #900#133, 1, "S";  |C_P #900#133, 1, 2236;

     |PINTA #900#122;  |PINTA #900#123;  |PINTA #900#124;
     |PINTA #900#125;  |PINTA #900#126;  |PINTA #900#127;
     |PINTA #900#128;  |PINTA #900#129;  |PINTA #900#130;
     |PINTA #900#131;  |PINTA #900#132;
     |PINTA #900#133;
     |ET Campo132;  |ENCAMPO #132#900;
                    |SI FSalida = 1;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo90;   |FINSI;

     |ET Campo122;  |ENCAMPO #122#900;
                    |SI FSalida = 1;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo132;  |FINSI;

     |ET Campo123;  |ENCAMPO #123#900;
                    |SI FSalida = 1;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo122;  |FINSI;

     |ET Campo124;  |ENCAMPO #124#900;
                    |SI FSalida = 1;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo123;  |FINSI;

     |ET Campo125;  |ENCAMPO #125#900;
                    |SI FSalida = 1;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo124;  |FINSI;

     |ET Campo126;  |ENCAMPO #126#900;
                    |SI FSalida = 1;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo125;  |FINSI;

     |ET Campo127;  |ENCAMPO #127#900;
                    |SI FSalida = 1;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo126;  |FINSI;

     |ET Campo129;  |ENCAMPO #129#900;
                    |SI FSalida = 1;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo127;  |FINSI;

     |ET Campo130;  |ENCAMPO #130#900;
                    |SI FSalida = 1;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo129;  |FINSI;

     |ET Campo128;  |ENCAMPO #128#900;
                    |SI FSalida = 1;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo130;  |FINSI;

     |ET Campo131;  |ENCAMPO #131#900;
                    |SI FSalida = 1;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo128;  |FINSI;

     |ET Campo133;  SwError = 0;
                    |ENCAMPO #133#900;
                    |SI FSalida = 1;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo131;  |FINSI;
                    |SI SwError = 1;  |VETE Campo133;  |FINSI;

     |ET Abajo90;

     |C_M #900#122, 1, "N"; |C_V #900#122, 1, "N";
     |C_M #900#123, 1, "N"; |C_V #900#123, 1, "N";
     |C_M #900#124, 1, "N"; |C_V #900#124, 1, "N";
     |C_M #900#125, 1, "N"; |C_V #900#125, 1, "N";
     |C_M #900#126, 1, "N"; |C_V #900#126, 1, "N";
     |C_M #900#127, 1, "N"; |C_V #900#127, 1, "N";
     |C_M #900#129, 1, "N"; |C_V #900#129, 1, "N";
     |C_M #900#130, 1, "N"; |C_V #900#130, 1, "N";
     |C_M #900#131, 1, "N"; |C_V #900#131, 1, "N";
     |C_M #900#128, 1, "N"; |C_V #900#128, 1, "N";
     |C_M #900#133, 1, "N"; |C_V #900#133, 1, "N";
     |C_M #900#132, 1, "N"; |C_V #900#132, 1, "N";

     |POPV;

     aAlfa =         #900#123; |QBF aAlfa;
     |SI aAlfa ! ""; aAlfa = aAlfa + ", "; |FINSI;
     aAlfa = aAlfa + #900#124; |QBF aAlfa;
     |SI aAlfa ! ""; aAlfa = aAlfa + ", "; |FINSI;
     aAlfa = aAlfa + #900#125; |QBF aAlfa;
     |SI aAlfa ! ""; aAlfa = aAlfa + ", "; |FINSI;
     aAlfa = aAlfa + #900#126; |QBF aAlfa;
     |SI aAlfa ! ""; aAlfa = aAlfa + ", "; |FINSI;
     aAlfa = aAlfa + #900#127; |QBF aAlfa;
     #900#91 = aAlfa;

/*
     |PUSHV 0501 2380;
     |D_CUADRO 1717, 2380;
     |BLANCO 1818 2279;
     |ATRI R;
     |PINTA 1818, "Descripcion                                                   ";
     |PINTA 2218, "Clave de Divisa :";

     |C_M #900#91, 1, "S";  |C_V #900#91, 1, "S";  |C_P #900#91, 1, 1918;
     |C_M #900#92, 1, "S";  |C_V #900#92, 1, "S";  |C_P #900#92, 1, 2018;
     |C_M #900#93, 1, "S";  |C_V #900#93, 1, "S";  |C_P #900#93, 1, 2118;
     |C_M #900#94, 1, "S";  |C_V #900#94, 1, "S";  |C_P #900#94, 1, 2236;

     |PINTA #900#91;  |PINTA #900#92;  |PINTA #900#93;  |PINTA #900#94;

     |ET Campo091;  |ENCAMPO #091#900;
                    |SI FSalida = 1;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo90;   |FINSI;

     |ET Campo092;  |ENCAMPO #092#900;
                    |SI FSalida = 1;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo091;  |FINSI;

     |ET Campo093;  |ENCAMPO #093#900;
                    |SI FSalida = 1;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo092;  |FINSI;

     |ET Campo094;  SwError = 0;
                    |ENCAMPO #094#900;
                    |SI FSalida = 1;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo093;  |FINSI;
                    |SI SwError = 1;  |VETE Campo094;  |FINSI;

     |ET Abajo90;

     |C_M #900#91, 1, "N";  |C_V #900#91, 1, "N";
     |C_M #900#92, 1, "N";  |C_V #900#92, 1, "N";
     |C_M #900#93, 1, "N";  |C_V #900#93, 1, "N";
     |C_M #900#94, 1, "N";  |C_V #900#93, 1, "N";

     |POPV;
*/
|FPRC;

|PROCESO Divisas;
     Tecla = FSalida;
     |ABRET #8;

     |SI Tecla = 9;
         |PUSHV 0501 2380;
         #8#0 = #900#94;
         |LEE 040#8];
         |PINPA #0#8;
         |PINDA #0#8;
         |CONSULTA #1#8;
         |POPV;

         #900#94 = #8#0;  |PINTA #900#94;
     |FINSI;
/*
     #8#0 = #900#94;
     |LEE 140#8=;
     |SI FSalida ! 0;
         |MENAV "     No existe el Codigo de Divisas";
         SwError = 1;
     |FINSI;
*/
     |CIERRAT #8;
|FPRC;

|PROCESO Paises;
     Tecla = FSalida;
     |ABRET #18;

     |SI Tecla = 9;
         |PUSHV 0501 2380;
         #18#0 = #900#131;
         |LEE 040#18];
         |PINPA #0#18;
         |PINDA #0#18;
         |CONSULTA #1#18;
         |POPV;

         #900#131 = #18#0;  |PINTA #900#131;
     |FINSI;

     #18#0 = #900#131;
     |LEE 140#18=;
     |SI FSalida ! 0;
         |MENAV "     No existe el Codigo de Divisas";
         SwError = 1;
     |FINSI;
     |CIERRAT #18;
|FPRC;

|PROCESO TRenta;
     Tecla = FSalida;

     |SI #rem00002#6 = "S";
        |SI #rem00003#132 ! 1; |Y #rem00003#132 ! 2;
            |MENAV "    Tipo de renta incorrecto "; |ERROR; |ACABA;
        |FINSI;
     |SINO;
        |SI #rem00003#132 = 1; |O #rem00003#132 = 2;
            |MENAV "    Tipo de renta incorrecto "; |ERROR; |ACABA;
        |FINSI;
     |FINSI;
     #rem00003#96 = ("00" + #rem00003#132) % -102;

     |ABRET #19;

     |SI Tecla = 9;
         |PUSHV 0501 2380;
         #19#0 = #900#132;
         |LEE 040#19];
         |PINPA #0#19;
         |PINDA #0#19;
         |CONSULTA #1#19;
         |POPV;

         #900#132 = #19#0;  |PINTA #900#132;
     |FINSI;
/*
     #19#0 = #900#132;
     |LEE 140#19=;
     |SI FSalida ! 0;
         |MENAV "     No existe el Codigo de Tipo de renta";
         SwError = 1;
     |FINSI;
*/
     |CIERRAT #19;
|FPRC;

|PROCESO CDatos900C95;
     |PUSHV 0501 2380;
     |D_CUADRO 1717, 2380;
     |BLANCO 1818 2279;
     |ATRI R;
     |PINTA 1818, "Tipo de renta: Clave  ";
     |PINTA 1918, "Referencia Catastral  ";
     |PINTA 2218, "Base Imponible ......:";

     ||C_M #900#96, 1, "S";
                            |C_V #900#96, 1, "S";  |C_P #900#96, 1, 1841;
     |C_M #900#97, 1, "S";  |C_V #900#97, 1, "S";  |C_P #900#97, 1, 2018;
     |C_M #900#98, 1, "S";  |C_V #900#98, 1, "S";  |C_P #900#98, 1, 2241;

||     nTDias = #1#30 + #1#31 + #1#32;
     nTDias = 365;

     |SI #900#98 = 0;
         #900#97 = #1#14;
         |SI #rem00021#30 ! 0;
             Calc = (#1#15 * #rem00021#30) / nTDias;
            |SI #rem00021#17 = "S";
               Calc = Calc % 1.1;
            |SINO;
               Calc = Calc % 2;
            |FINSI;
           #900#98 = Calc;
        |FINSI;
        |SI #rem00021#32 ! 0;
            Calc = (#1#15 * #rem00021#32) / nTDias;
            |SI #rem00021#17 = "S";
                Calc = Calc % 1.1;
            |SINO;
               Calc = Calc % 2;
            |FINSI;
            #900#98 = #900#98 + Calc;
        |FINSI;
        |SI #rem00021#31 ! 0;
            |SI #rem00021#37 = "A";
                #900#98 = #900#98 + ((#rem00021#38 * #rem00021#31) / nTDias);
            |SINO;
                #900#98 = #900#98 + #rem00021#38;
            |FINSI;
        |FINSI;
     |FINSI;

     |PINTA #900#96;  |PINTA #900#97;  |PINTA #900#98;

     |ET Campo096;  |ENCAMPO #096#900;
                    |SI FSalida = 1;  |VETE Abajo95;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo95;   |FINSI;

     |ET Campo097;  |ENCAMPO #097#900;
                    |SI FSalida = 1;  |VETE Abajo95;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo95;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo096;  |FINSI;

     |ET Campo098;  |ENCAMPO #098#900;
                    |SI FSalida = 1;  |VETE Abajo95;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo95;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo097;  |FINSI;

     |ET Abajo95;

     ||C_M #900#96, 1, "N";
                            |C_V #900#96, 1, "N";
     |C_M #900#97, 1, "N";  |C_V #900#97, 1, "N";
     |C_M #900#98, 1, "N";  |C_V #900#98, 1, "N";

     |POPV;

|FPRC;

|PROCESO CDatos900C99;
     |PUSHV 0501 2380;
     |D_CUADRO 1817, 2380;
     |BLANCO 1918 2279;
     |ATRI R;
     |PINTA 1918, "Ingresos integros ...:";
     |PINTA 2018, "Gastos de personal ..:";
     |PINTA 2118, "Gtos.aprov.y mat.imp.:";
     |PINTA 2218, "Base imponible ......:";

     |C_M #900#100, 1, "S";  |C_V #900#100, 1, "S";  |C_P #900#100, 1, 1941;
     |C_M #900#101, 1, "S";  |C_V #900#101, 1, "S";  |C_P #900#101, 1, 2041;
     |C_M #900#102, 1, "S";  |C_V #900#102, 1, "S";  |C_P #900#102, 1, 2141;
                             |C_V #900#103, 1, "S";  |C_P #900#103, 1, 2241;

     |PINTA #900#100;  |PINTA #900#101;  |PINTA #900#102;  |PINTA #900#103;

     |ET Campo100;  |ENCAMPO #100#900;
                    |SI FSalida = 1;  |VETE Abajo99;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo99;   |FINSI;

     |ET Campo101;  |ENCAMPO #101#900;
                    |SI FSalida = 1;  |VETE Abajo99;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo99;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo100;  |FINSI;

     |ET Campo102;  |ENCAMPO #102#900;
                    |SI FSalida = 1;  |VETE Abajo99;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo99;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo101;  |FINSI;

     |ET Abajo99;

     |C_M #900#100, 1, "N";  |C_V #900#100, 1, "N";
     |C_M #900#101, 1, "N";  |C_V #900#101, 1, "N";
     |C_M #900#102, 1, "N";  |C_V #900#102, 1, "N";
                             |C_V #900#103, 1, "N";

     |POPV;
|FPRC;

|PROCESO Total103;
     #900#103 = #900#100 - #900#101 - #900#102;  |PINTA #900#103;
|FPRC;

|PROCESO CDatos900C104;
     |PUSHV 0501 2380;
     |D_CUADRO 1317, 2380;
     |BLANCO 1418 2279;
     |ATRI R;
     |PINTA 1418, "Acciones admitidas...:";
     |PINTA 1518, "Otros elementos .....:";
     |PINTA 1618, "Fecha de adquisicion :";
     |PINTA 1718, "Valor de Transmision :";
     |PINTA 1818, "Valor de adquisicion :";
     |PINTA 1918, "Diferencia ..........:";
     |PINTA 2018, "A¤os permanencia ....:";
     |PINTA 2118, "Incremento ..........:";
     |PINTA 2218, "Base imponible ......:";

     |C_M #900#105, 1, "S";  |C_V #900#105, 1, "S";  |C_P #900#105, 1, 1441;
     |C_M #900#106, 1, "S";  |C_V #900#106, 1, "S";  |C_P #900#106, 1, 1541;
     |C_M #900#107, 1, "S";  |C_V #900#107, 1, "S";  |C_P #900#107, 1, 1641;
     |C_M #900#108, 1, "S";  |C_V #900#108, 1, "S";  |C_P #900#108, 1, 1741;
     |C_M #900#109, 1, "S";  |C_V #900#109, 1, "S";  |C_P #900#109, 1, 1841;
                             |C_V #900#110, 1, "S";  |C_P #900#110, 1, 1941;
     |C_M #900#120, 1, "S";  |C_V #900#120, 1, "S";  |C_P #900#120, 1, 2041;
     |C_M #900#111, 1, "S";  |C_V #900#111, 1, "S";  |C_P #900#111, 1, 2141;
                             |C_V #900#112, 1, "S";  |C_P #900#112, 1, 2241;

     |PINTA #900#105;  |PINTA #900#106;  |PINTA #900#107;  |PINTA #900#108;
     |PINTA #900#109;  |PINTA #900#110;  |PINTA #900#111;  |PINTA #900#112;
     |PINTA #900#120;

     |ET Campo105;  |ENCAMPO #105#900;
                    |SI FSalida = 1;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo104;   |FINSI;

     |ET Campo106;  |ENCAMPO #106#900;
                    |SI FSalida = 1;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo105;   |FINSI;

     |ET Campo107;  |ENCAMPO #107#900;
                    |SI FSalida = 1;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo106;   |FINSI;

     |ET Campo108;  |ENCAMPO #108#900;
                    |SI FSalida = 1;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo107;   |FINSI;

     |ET Campo109;  |ENCAMPO #109#900;
                    |SI FSalida = 1;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo108;   |FINSI;

     |ET Campo120;  |ENCAMPO #120#900;
                    |SI FSalida = 1;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo109;   |FINSI;

     |ET Campo111;  |ENCAMPO #111#900;
                    |SI FSalida = 1;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo120;   |FINSI;


     |ET Abajo104;

     |C_M #900#105, 1, "N";  |C_V #900#105, 1, "N";
     |C_M #900#106, 1, "N";  |C_V #900#106, 1, "N";
     |C_M #900#107, 1, "N";  |C_V #900#107, 1, "N";
     |C_M #900#108, 1, "N";  |C_V #900#108, 1, "N";
     |C_M #900#109, 1, "N";  |C_V #900#109, 1, "N";
     |C_M #900#111, 1, "N";  |C_V #900#111, 1, "N";
                             |C_V #900#110, 1, "N";
                             |C_V #900#112, 1, "N";
     |C_M #900#120, 1, "N";  |C_V #900#120, 1, "N";

     |POPV;
|FPRC;

|PROCESO Total112;
     #900#110 = #900#108 - #900#109;   |PINTA #900#110;

     Coef  = 0;
     Vanyo = #900#120;
     |SI Vanyo ] 2;
         |SI #900#105 = "X";
            |SI Vanyo = 3; Coef = 75; |FINSI;
            |SI Vanyo = 4; Coef = 50; |FINSI;
            |SI Vanyo = 5; Coef = 25; |FINSI;
         |FINSI;
         |SI #900#106 = "X";
            |SI Vanyo = 3; Coef = 85.72; |FINSI;
            |SI Vanyo = 4; Coef = 71.44; |FINSI;
            |SI Vanyo = 5; Coef = 57.16; |FINSI;
            |SI Vanyo = 6; Coef = 42.88; |FINSI;
            |SI Vanyo = 7; Coef = 28.60; |FINSI;
            |SI Vanyo = 8; Coef = 14.32; |FINSI;
         |FINSI;
     |FINSI;
     |SI Coef > 99; Coef = 100; |FINSI;
     |SI Coef [ 100;
         #900#111 = #900#110 % (100 - Coef);
     |SINO;
         #900#111 = 0;
     |FINSI;

     #900#112 = #900#111;              |PINTA #900#112;
|FPRC;

|PROCESO ModelosX;
     |C_M #900#95,  1, "S";
     |C_M #900#99,  1, "S";
     |C_M #900#104, 1, "S";

     |SI #0#6 = "S";
         #900#99  = " ";  |PINTA #900#99;   |C_M #900#99,   1, "N";
         #900#104 = " ";  |PINTA #900#104;  |C_M #900#104,  1, "N";
         |PDEFECTO #900, 100, 104;
         |PDEFECTO #900, 105, 112;
     |SINO;
         #900#95  = " ";  |PINTA #900#95;   |C_M #900#95,   1, "N";
         |PDEFECTO #900, 96,  99;
     |FINSI;

     |SI #900#95  = "X";
         #900#99  = " ";  |PINTA #900#99;   |C_M #900#99,   1, "N";
         #900#104 = " ";  |PINTA #900#104;  |C_M #900#104,  1, "N";
         |PDEFECTO #900, 100, 104;
         |PDEFECTO #900, 105, 112;
     |FINSI;

     |SI #900#99  = "X";
         #900#95  = " ";  |PINTA #900#95;   |C_M #900#95,   1, "N";
         #900#104 = " ";  |PINTA #900#104;  |C_M #900#104,  1, "N";
         |PDEFECTO #900, 96,  99;
         |PDEFECTO #900, 105, 112;
     |FINSI;

     |SI #900#104 = "X";
         #900#95  = " ";  |PINTA #900#95;   |C_M #900#95,   1, "N";
         #900#99  = " ";  |PINTA #900#99;   |C_M #900#99,   1, "N";
         |PDEFECTO #900, 96,  99;
         |PDEFECTO #900, 100, 104;
     |FINSI;
|FPRC;

|PROCESO Mayus3;
     CampoTrabajo = Campo;
     #900Campo = #900Campo > #900Campo;
     |PINTA #900Campo;

     |SI Campo ] 105; |Y Campo ! 143;  |ACABA;  |FINSI;

     |SI #900#95  = " "; #900#98  = 0; |FINSI;
     |SI #900#99  = " "; #900#103 = 0; |FINSI;
     |SI #900#104 = " "; #900#112 = 0; |FINSI;

     |SI Contenido = "X";  |Y #900Campo = " ";
         |CONFI "2400NEstas seguros de desactivar el apartado : ";
         |SI FSalida ! 0;
             #900Campo = "X";  |PINTA #900Campo;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #900Campo = " ";
         |SI Campo = 2;    |PDEFECTO #900, 15,  29;   |FINSI;
         |SI Campo = 4;    |PDEFECTO #900, 29,  37;   |FINSI;
         |SI Campo = 5;    |PDEFECTO #900, 37,  51;   |FINSI;
         |SI Campo = 6;    |PDEFECTO #900, 51,  64;   |FINSI;
         |SI Campo = 143;  |PDEFECTO #900, 51,  64;   |FINSI;
         |SI Campo = 7;    |PDEFECTO #900, 64,  77;   |FINSI;
         |SI Campo = 8;    |PDEFECTO #900, 77,  90;   |FINSI;
         |SI Campo = 90;   |PDEFECTO #900, 91,  95;   |FINSI;
         |SI Campo = 95;   |PDEFECTO #900, 96,  99;   |FINSI;
         |SI Campo = 99;   |PDEFECTO #900, 100, 104;  |FINSI;
         |SI Campo = 104;  |PDEFECTO #900, 105, 112;  |FINSI;
         |ACABA;
     |FINSI;

     |SI #900Campo ! "I";  |ACABA;  |FINSI;

     |SI Campo [ 8; |O Campo = 143;
         |HAZ CargaDatos901;
         |HAZ EntraDatos901;
     |FINSI;

     |SI Campo = 90; |HAZ CDatos900C90;   |FINSI;

     #900Campo = "X";  |PINTA #900Campo;

     |SI Campo = 95;
         |SI #0#6 = "S";
             |HAZ CDatos900C95;
              #900Campo = "X";  |PINTA #900Campo;
         |SINO;
              #900Campo = " ";  |PINTA #900Campo;
         |FINSI;
     |FINSI;

     |SI Campo = 99;
         |SI #0#6 = "N";
             |HAZ CDatos900C99;
              #900Campo = "X";  |PINTA #900Campo;
         |SINO;
              #900Campo = " ";  |PINTA #900Campo;
         |FINSI;
     |FINSI;

     |SI Campo = 104;
         |SI #0#6 = "N";
             |HAZ CDatos900C104;
              #900Campo = "X";  |PINTA #900Campo;
         |SINO;
              #900Campo = " ";  |PINTA #900Campo;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Total117;
     Base = #900#98 + #900#103 + #900#112;
     |SI #900#95  = "X";  #900#114 = (Base * #900#113) / 100;  |FINSI;
     |SI #900#99  = "X";  #900#114 = (Base * #900#113) / 100;  |FINSI;
     |SI #900#104 = "X";  #900#114 = (Base * #900#113) / 100;  |FINSI;

     |SI #900#114 < 0;  #900#114 = 0;  |FINSI;

     |PINTA #900#114;

     #900#117 = #900#114 - #900#115 - #900#116;  |PINTA #900#117;

     Valfa   = (#900#113 + "     ") % 105;
     Posi    = 0;
     Valfa0  = "";
     Valfa1  = "";
     Valfa2  = "";
     SwPunto = 0;
     |PARA XPara = 1;  |SI XPara [ 5;  |HACIENDO XPara = XPara + 1;
           Posi   = (100 * XPara) + 1;
           Valfa0 = Valfa % Posi;
           |SI Valfa0 = "."; SwPunto = 1;  |FINSI;
           |SI SwPunto = 0;
               |SI Valfa0 ! " "; |Y Valfa0 ! ".";
                   Valfa1 = Valfa1 + Valfa0;
               |FINSI;
           |FINSI;

           |SI SwPunto = 1;
               |SI Valfa0 ! " "; |Y Valfa0 ! ".";
                   Valfa2 = Valfa2 + Valfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     #900#118 = Valfa1;
     #900#119 = Valfa2;
|FPRC;

|PROCESO Modelo210;
     |PUSHV 0501 2380;
     |ABRE #900;
     #900#0 = #0#0;
     #900#1 = #0#1;
     |LIBERA #900;
     |LEE 140#900=;
     FEstado = FSalida;
     QueTipo = 2;
     |SI FSalida ! 0;
         |DDEFECTO #900;
          #900#0 = #0#0;
          #900#1 = #0#1;
          |GRABA 140#900b;
          QueTipo = 1;
     |FINSI;

     |PINPA #0#900;
     |PINDA #0#900;
     |ENDATOS #1#900;
     |SI FSalida = 0;
         |SI #900#117 ! 0; |O #900#98 ! 0;  |O #900#103 ! 0;  |O #900#112 ! 0;
          |O #900#2 ! " "; |O #900#4 ! " "; |O #900#5 ! " ";  |O #900#6 ! " ";
          |O #900#7 ! " "; |O #900#8 ! " "; |O #900#9 ! " ";
             aMenu4 = "EA";
             aMenu6 = "Adeudo Cta/Domiciliacion";
          |ET Otra4;
             |MENU aMenu;
             nOpcion = FSalida;
             |SI nOpcion < 1; |O nOpcion > 2; |VETE Otra4; |FINSI;

             |SI nOpcion = 1; #rem00003#137 = "E"; |FINSI;
             |SI nOpcion = 2; #rem00003#137 = "A"; |FINSI;

             |GRABA 140#900a;
         |SINO;
             |BORRA 140#900c;
         |FINSI;
     |SINO;
          |SI FEstado ! 0;  |BORRA 140#900c;  |FINSI;
     |FINSI;
     |CIERRA #900;
     |POPV;
|FPRC;

 **********************************************************************
 PROCESOS DEL MANTENIMIENTO 211
 **********************************************************************

|PROCESO CargaInmueble;
|FPRC;

|PROCESO Graba916;
     |DDEFECTO #916;
     #916#0 = #0#0;
     #916#1 = #0#1;
     #916#2 = "T";
     #916#3 = nLinea;
     #916#6 = "O";
     |SI nCoefi ! 100;  #916#6 = "C";  |FINSI;
     #916#7  = nCoefi;
     #916#9  = #5#14;
     #916#10 = #5#15;
     #916#11 = #5#16;
     #916#12 = #5#17;
     #916#13 = #5#18;
     #916#14 = #5#19;
     #916#15 = #5#20;
     #916#16 = #5#21;
     #916#17 = #5#22;

     |ABRE #6;
     #6#0 = #916#15;
     #6#1 = #916#16;
     |LEE 040#6=;
     |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;
     |CIERRA #6;

     #916#18 = #6#2;
     #916#19 = #5#77;

     |SI aTipo = "T";
         #916#4 = #5#1;
         #916#8 = #5#5;
     |FINSI;

     |SI aTipo = "C";
         #916#4  = #5#35;
         #916#8  = #5#39;
     |FINSI;

     |GRABA 020#916n;
     |LIBERA #916;

     |ABRE #917;
     #917#0 = #916#0;
     #917#1 = #916#1;
     |LEE 101#917=;
     |SI FSalida ! 0;
         |DDEFECTO #917;
         #917#0 = #916#0;
         #917#1 = #916#1;
         |GRABA 020#917b;
     |FINSI;
     |SI #916#2 = "A";  #917#33 = #917#33 + 1; |FINSI;
     |SI #916#2 = "T";  #917#34 = #917#34 + 1; |FINSI;
     |GRABA 020#917a;
     |LIBERA #917;
     |CIERRA #917;
|FPRC;

|PROCESO AltaT;
     |SI #0#3 ! "T";  |Y #0#3 ! "C";  |Y #0#3 ! "G";  |ACABA;  |FINSI;

     |ABRE #916;
     #916#0 = #0#0;
     #916#1 = #0#1;
     #916#2 = "T";
     #916#3 = 99;
     |LEE 040#916];
     |SI FSalida = 0;
         |LEE 040#916a;
     |SINO;
         |LEE 040#916u;
     |FINSI;

     |SI FSalida = 0; |Y #916#0 = #0#0;  |Y #916#1 = #0#1;  |Y #916#2 = "T";
         |CIERRA #916;
         |ACABA;
     |FINSI;

     |SI #0#3 = "G";
         nLinea = 1;
         aTipo  = "T";
         nCoefi = 50;
         |HAZ Graba916;

         nLinea = 2;
         aTipo  = "C";
         nCoefi = 50;
         |HAZ Graba916;
     |SINO;
         nLinea = 1;
         aTipo  = #0#3;
         nCoefi = 100;
         |HAZ Graba916;
     |FINSI;

     |CIERRA #916;
|FPRC;

|RUTINA ClaveBaja916;
     #916#0 = #0#0;
     #916#1 = #0#1;
     #916#2 = aClave;
     #916#3 = 01;
|FRUT;

|RUTINA ClaveAlta916;
     #916#0 = #0#0;
     #916#1 = #0#1;
     #916#2 = aClave;
     #916#3 = 99;
|FRUT;

|PROCESO El916;
     |PUSHV 0501 2380;
     |PINPA #0#916;
     |ATRI R;
     |SI aClave = "A";  |PINTA 1622, "Adquirentes  ";  |FINSI;
     |SI aClave = "T";  |PINTA 1622, "Transmitentes";  |HAZ AltaT;  |FINSI;
     |ATRI r;

     |ENTLINEAL #1#916, -4, 2, 21, 0, ClaveBaja916, ClaveAlta916;

     |POPV;
|FPRC;

|PROCESO CargaDatos211;
/*
     |ABRE #6;
     #6#0 = #1#6;
     #6#1 = #1#7;
     |LEE 040#6=;
     |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;
     |CIERRA #6;
*/
     |ABRE #7;
     #7#0 = #5#44;
     |LEE 040#7=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #7;
/*
     #917#3  = #1#13;
     #917#8  = #1#6;
     #917#9  = #1#7;
*/
     #917#10 = #6#3;
     #917#11 = #6#2;
     #917#16 = #1#14;
     #917#17 = #7#2;
     #917#18 = #7#1;
     #917#20 = #7#3;
     #917#21 = #7#4;
     #917#25 = #7#9;
     #917#26 = #7#5;
     #917#27 = #7#6;
     #917#28 = #7#7;
     #917#29 = #7#8;
     #917#30 = #1#68;
     #917#31 = #1#69;
     #917#32 = #917#31 % 5;
|FPRC;

|PROCESO El917;
     |PUSHV 0501 2380;
     |ABRE #917;
     #917#0 = #0#0;
     #917#1 = #0#1;
     |LIBERA #917;
     |LEE 140#917=;
     FEstado = FSalida;
     QueTipo = 2;
     |SI FSalida ! 0;
          |DDEFECTO #917;
          #917#0 = #0#0;
          #917#1 = #0#1;
          |HAZ CargaDatos211;
          |GRABA 140#917b;
          QueTipo = 1;
     |SINO;
          |SI #917#32 = 0;
              QueTipo = 1;
              |HAZ CargaDatos211;
          |FINSI;
     |FINSI;

     |PINPA #0#917;
     |PINDA #0#917;
     |SI QueTipo = 2;
         |CONFI "2400NDesea Actualizar Datos S/N : ";
         |SI FSalida = 0;
             |HAZ CargaDatos211;
             |PINDA #0#917;
         |FINSI;
     |FINSI;

     |ENDATOS #1#917;
     |SI FSalida = 0;
         |SI #917#32 ! 0;
/*
             HContribu  = #0#0;
             HNombre    = #5#0;
             HPrograma  = "(rem00017) MODELO 211";
             HLinea     = #0#1;
             HPerceptor = #0#3;
             HRdto      = #917#32;
             |SI QueTipo = 1; HTipo = "ALTA FICHA";         |FINSI;
             |SI QueTipo = 2; HTipo = "MODIFICACION FICHA"; |FINSI;
             |HAZ AltaHistorico;
*/
             aMenu4 = "EA";
             aMenu6 = "Adeudo en cuenta";
          |ET Otra1;
             |MENU aMenu;
             nOpcion = FSalida;
             |SI nOpcion < 1; |O nOpcion > 2; |VETE Otra1; |FINSI;

             |SI nOpcion = 1; #rem00017#36 = "E"; |FINSI;
             |SI nOpcion = 2; #rem00017#36 = "A"; |FINSI;
             |GRABA 020#917a;
         |SINO;
/*
             HContribu  = #0#0;
             HNombre    = #5#0;
             HPrograma  = "(rem00017) MODELO 211";
             HLinea     = #0#1;
             HPerceptor = #0#3;
             HRdto      = #917#32;
             HTipo      = "BAJA FICHA"
             |HAZ AltaHistorico;
*/
             |BORRA 140#917c;
         |FINSI;
     |SINO;
          |SI FEstado ! 0;  |BORRA 140#917c;  |FINSI;
     |FINSI;
     |CIERRA #917;
     |POPV;
|FPRC;

|PROCESO Modelo211;
     |SI #0#6  = "N";  |ACABA;  |FINSI;

     |ABRE #5;
     #5#0 = #0#0;
     |LEE 040#5=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #5;

     |ABRE #1;
     #1#0 = #0#0;
     #1#1 = #0#1;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |SI #1#24 ! "S";  |ACABA;  |FINSI;

     |PUSHV 0501 2380;
     |BLANCO 1454 2279;

     |ATRI R;
     |PINTA 1454, "        MODELO 211        ";
     |ATRI r;

     nSalir1 = 0;
     |PARA;  |SI nSalir1 = 0;  |HACIENDO;
         nSalir1 = 1;
         |HAZ PonArte;
         |MENUG M211Mod;
         M211Mod2 = FSalida;
         |SI M211Mod2 ] 1; |Y M211Mod2 [ 3;
             |SI M211Mod2 = 1;  aClave = "A";  |HAZ El916; nSalir1 = 0;  |FINSI;
             |SI M211Mod2 = 2;  aClave = "T";  |HAZ El916; nSalir1 = 0;  |FINSI;
             |SI M211Mod2 = 3;                 |HAZ El917; nSalir1 = 0;  |FINSI;
         |FINSI;
     |SIGUE;
     |POPV;
|FPRC;

 **********************************************************************
 PROCESOS DEL MANTENIMIENTO 212
 **********************************************************************

|PROCESO CDatos902C3;
     |PUSHV 0501 2380;

     |PARA Campo1 = 1;  |SI Campo1 [ 22;  |HACIENDO Campo1 = Campo1 + 1;
           |C_M #903Campo1, 1, "N";
           |C_V #903Campo1, 1, "N";
     |SIGUE;

     |DDEFECTO #903;

     #903#0  = "Sujeto Pasivo";
     #903#1  = #902#7;                          |C_V #903#1,  1, "S";
     #903#2  = #902#8;                          |C_V #903#2,  1, "S";
     #903#3  = #902#9;                          |C_V #903#3,  1, "S";
     #903#4  = #902#86;  |C_M #903#4,  1, "S";  |C_V #903#4,  1, "S";
     #903#5  = #902#12;  |C_M #903#5,  1, "S";  |C_V #903#5,  1, "S";
     #903#6  = #902#87;  |C_M #903#6,  1, "S";  |C_V #903#6,  1, "S";
     #903#7  = #902#88;  |C_M #903#7,  1, "S";  |C_V #903#7,  1, "S";
     #903#8  = #902#89;  |C_M #903#8,  1, "S";  |C_V #903#8,  1, "S";
     #903#9  = #902#90;  |C_M #903#9,  1, "S";  |C_V #903#9,  1, "S";
     #903#10 = #902#91;  |C_M #903#10, 1, "S";  |C_V #903#10, 1, "S";
     #903#11 = #902#13;  |C_M #903#11, 1, "S";  |C_V #903#11, 1, "S";
     #903#12 = #902#14;  |C_M #903#12, 1, "S";  |C_V #903#12, 1, "S";
     #903#13 = #902#15;  |C_M #903#13, 1, "S";  |C_V #903#13, 1, "S";
     #903#14 = #902#16;  |C_M #903#14, 1, "S";  |C_V #903#14, 1, "S";
     #903#15 = #902#10;  |C_M #903#15, 1, "S";  |C_V #903#15, 1, "S";
     #903#16 = #902#11;  |C_M #903#16, 1, "S";  |C_V #903#16, 1, "S";
     #903#17 = #902#17;  |C_M #903#17, 1, "S";  |C_V #903#17, 1, "S";

     |PINPA #0#903;
     |PINDA #0#903;
     |BLANCO 2011 2279;
     |ENDATOS #1#903;
     |SI FSalida = 0;
         #902#12 = #903#5;
         #902#16 = #903#14;
         #902#10 = #903#15;
         #902#11 = #903#16;
         #902#17 = #903#17;
         #902#86 = #903#4;
         #902#87 = #903#6;
         #902#88 = #903#7;
         #902#89 = #903#8;
         #902#90 = #903#9;
         #902#91 = #903#10;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO CDatos902C82;
     |PUSHV 0501 2380;

     |PARA Campo1 = 1;  |SI Campo1 [ 22;  |HACIENDO Campo1 = Campo1 + 1;
           |C_M #903Campo1, 1, "N";
           |C_V #903Campo1, 1, "N";
     |SIGUE;

     |DDEFECTO #903;

     #903#0  = "Conyuge      ";
     #903#1  = #902#18;                         |C_V #903#1,  1, "S";
     #903#2  = #902#8;                          |C_V #903#2,  1, "S";
     #903#3  = #902#19;                         |C_V #903#3,  1, "S";
     #903#5  = #902#12;                         |C_V #903#5,  1, "S";
     #903#11 = #902#13;                         |C_V #903#11, 1, "S";
     #903#12 = #902#14;                         |C_V #903#12, 1, "S";
     #903#13 = #902#15;                         |C_V #903#13, 1, "S";
     #903#14 = #902#16;                         |C_V #903#14, 1, "S";
     #903#15 = #902#20;  |C_M #903#15, 1, "S";  |C_V #903#15, 1, "S";
     #903#16 = #902#11;                         |C_V #903#16, 1, "S";
     #903#17 = #902#21;  |C_M #903#17, 1, "S";  |C_V #903#17, 1, "S";

     |PINPA #0#903;
     |PINDA #0#903;
     |ENDATOS #1#903;
     |BLANCO 2011 2279;
     |SI FSalida = 0;
         #902#20 = #903#15;
         #902#21 = #903#17;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO CDatos902C4;
     |PUSHV 0501 2380;
     |DDEFECTO #903;

     #903#0  = "Representante";
     |PARA Campo1 = 1;  |SI Campo1 [ 22;  |HACIENDO Campo1 = Campo1 + 1;
           |C_M #903Campo1, 1, "N";
           |C_V #903Campo1, 1, "N";
     |SIGUE;

     |PARA Campo1 = 1;  |SI Campo1 [ 9;  |HACIENDO Campo1 = Campo1 + 1;
           Campo2 = Campo1 + 21;
           #903Campo1  = #902Campo2;
           |C_M #903Campo1, 1, "S";  |C_V #903Campo1, 1, "S";
     |SIGUE;

     #903#10 = #902#83;  |C_M #903#10, 1, "S";  |C_V #903#10, 1, "S";
     #903#11 = #902#31;  |C_M #903#11, 1, "S";  |C_V #903#11, 1, "S";
     #903#12 = #902#32;  |C_M #903#12, 1, "S";  |C_V #903#12, 1, "S";
     #903#13 = #902#33;  |C_M #903#13, 1, "S";  |C_V #903#13, 1, "S";
     #903#14 = #902#34;  |C_M #903#14, 1, "S";  |C_V #903#14, 1, "S";

     |PINPA #0#903;
     |PINDA #0#903;
     |BLANCO 1811 1879;
     |BLANCO 2011 2279;
     |ENDATOS #1#903;
     |SI FSalida = 0;
         |PARA Campo1 = 1;  |SI Campo1 [ 9;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 21;
               #902Campo2  = #903Campo1;
         |SIGUE;

         #902#83 = #903#10;
         #902#31 = #903#11;
         #902#32 = #903#12;
         #902#33 = #903#13;
         #902#34 = #903#14;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO CDatos902C5;
     |PUSHV 0501 2380;
     |DDEFECTO #903;

     #903#0  = "Adquirente";
     |PARA Campo1 = 1;  |SI Campo1 [ 22;  |HACIENDO Campo1 = Campo1 + 1;
           |C_M #903Campo1, 1, "N";
           |C_V #903Campo1, 1, "N";
     |SIGUE;

     |PARA Campo1 = 1;  |SI Campo1 [ 9;  |HACIENDO Campo1 = Campo1 + 1;
           Campo2 = Campo1 + 34;
           #903Campo1  = #902Campo2;
           |C_M #903Campo1, 1, "S";  |C_V #903Campo1, 1, "S";
     |SIGUE;

     #903#11 = #902#44;  |C_M #903#11, 1, "S";  |C_V #903#11, 1, "S";
     #903#12 = #902#45;  |C_M #903#12, 1, "S";  |C_V #903#12, 1, "S";
     #903#13 = #902#46;  |C_M #903#13, 1, "S";  |C_V #903#13, 1, "S";
     #903#14 = #902#47;  |C_M #903#14, 1, "S";  |C_V #903#14, 1, "S";
     #903#17 = #902#48;  |C_M #903#17, 1, "S";  |C_V #903#17, 1, "S";

     |PINPA #0#903;
     |PINDA #0#903;
     |BLANCO 2011 2279;
     |ENDATOS #1#903;
     |SI FSalida = 0;
         |PARA Campo1 = 1;  |SI Campo1 [ 9;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 34;
               #902Campo2  = #903Campo1;
         |SIGUE;

         #902#44 = #903#11;
         #902#45 = #903#12;
         #902#46 = #903#13;
         #902#47 = #903#14;
         #902#48 = #903#17;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO CDatos902C6;
     |PUSHV 0501 2380;
     |DDEFECTO #903;

     #903#0  = "Descripcion del Inmueble";
     |PARA Campo1 = 1;  |SI Campo1 [ 22;  |HACIENDO Campo1 = Campo1 + 1;
           |C_M #903Campo1, 1, "N";
           |C_V #903Campo1, 1, "N";
     |SIGUE;

     #903#4  = #902#49;  |C_M #903#4 , 1, "S";  |C_V #903#4 , 1, "S";
     #903#5  = #902#50;  |C_M #903#5 , 1, "S";  |C_V #903#5 , 1, "S";
     #903#6  = #902#51;  |C_M #903#6 , 1, "S";  |C_V #903#6 , 1, "S";
     #903#7  = #902#52;  |C_M #903#7 , 1, "S";  |C_V #903#7 , 1, "S";
     #903#8  = #902#53;  |C_M #903#8 , 1, "S";  |C_V #903#8 , 1, "S";
     #903#9  = #902#54;  |C_M #903#9 , 1, "S";  |C_V #903#9 , 1, "S";
     #903#11 = #902#55;  |C_M #903#11, 1, "S";  |C_V #903#11, 1, "S";
     #903#12 = #902#56;  |C_M #903#12, 1, "S";  |C_V #903#12, 1, "S";
     #903#13 = #902#57;  |C_M #903#13, 1, "S";  |C_V #903#13, 1, "S";
     #903#14 = #902#58;  |C_M #903#14, 1, "S";  |C_V #903#14, 1, "S";
     #903#18 = #902#59;  |C_M #903#18, 1, "S";  |C_V #903#18, 1, "S";
     #903#19 = #902#60;  |C_M #903#19, 1, "S";  |C_V #903#19, 1, "S";
     #903#20 = #902#62;  |C_M #903#20, 1, "S";  |C_V #903#20, 1, "S";
     #903#21 = #902#61;  |C_M #903#21, 1, "S";  |C_V #903#21, 1, "S";
     #903#22 = #902#63;  |C_M #903#22, 1, "S";  |C_V #903#22, 1, "S";

     |PINPA #0#903;
     |PINDA #0#903;
     |BLANCO 1111 1379;
     |BLANCO 1811 1879;
     |ENDATOS #1#903;
     |SI FSalida = 0;
         #902#49 = #903#4;
         #902#50 = #903#5;
         #902#51 = #903#6;
         #902#52 = #903#7;
         #902#53 = #903#8;
         #902#54 = #903#9;
         #902#55 = #903#11;
         #902#56 = #903#12;
         #902#57 = #903#13;
         #902#58 = #903#14;
         #902#59 = #903#18;
         #902#60 = #903#19;
         #902#62 = #903#20;
         #902#61 = #903#21;
         #902#63 = #903#22;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO Mayus5;
     CampoTrabajo = Campo;
     #902Campo = #902Campo > #902Campo;
     |PINTA #902Campo;



     |SI Contenido = "X";  |Y #902Campo = " ";
         |CONFI "2400NEstas seguros de desactivar el apartado : ";
         |SI FSalida ! 0;
             #902Campo = "X";  |PINTA #902Campo;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #902Campo = " ";
         |SI Campo = 4;    |PDEFECTO #902, 22,  34;   |FINSI;
         |SI Campo = 5;    |PDEFECTO #902, 35,  48;   |FINSI;
         |SI Campo = 6;    |PDEFECTO #902, 49,  63;   |FINSI;
         |ACABA;
     |FINSI;

     |SI #902Campo ! "I";  |ACABA;  |FINSI;

     |SI Campo = 3;   |HAZ CDatos902C3;   |FINSI;
     |SI Campo = 82;  |HAZ CDatos902C82;  |FINSI;
     |SI Campo = 4;   |HAZ CDatos902C4;   |FINSI;
     |SI Campo = 5;   |HAZ CDatos902C5;   |FINSI;
     |SI Campo = 6;   |HAZ CDatos902C6;   |FINSI;

     #902Campo = "X";  |PINTA #902Campo;
|FPRC;

|PROCESO Amortizacion;
     ||nTDias      = #1#30 + #1#31 + #1#32;
     nTDias      = 365;
     HastaFec    = "31.12.1996";
     Valor1      = #1#26 + #1#29 - #1#28;
     Fecha       = HastaFec - #902#80;
     VAmortiza1  = (Fecha * #1#65) / nTDias;
     |SI VAmortiza1 > 100; VAmortiza1 = 100; |FINSI;
     VAmortiza1  = (VAmortiza1 * Valor1) / 100;

     VAmortiza = VAmortiza1;
|FPRC;

|PROCESO Tiempo;
     ||nTDias   = #1#30 + #1#31 + #1#32;
     nTDias   = 365;
     HastaFec = #902#2;
     Fecha    = (HastaFec - DesdeFec) / nTDias;

     Vanyo1   = HastaFec % -104;
     Vanyo2   = DesdeFec % -104;
     Vanyon1  = Vanyo1;
     Vanyon2  = Vanyo2;
     Fecha    = Vanyon1 - Vanyon2;

     |SI DesdeFec < "31.12.1994";  Vanyo2 = 1994;  |FINSI;
     |SI DesdeFec = "31.12.1994";  Vanyo2 = 1995;  |FINSI;

     |ABRE #407;
     #407#0   = Vanyon1;
     #407#1   = Vanyo2;
     |LEE 040#407=;
     |SI FSalida ! 0;  |DDEFECTO #407;  |FINSI;
     |CIERRA #407;

     Coefi = #407#2;

     |SI Fecha < 1;  Coefi = 1;  |FINSI;

     ||nTDias    = #1#30 + #1#31 + #1#32;
     nTDias    = 365;

     HastaFec  = "31.12.1996";
     Fecha     = (HastaFec - DesdeFec) / nTDias;
     Vanyo1    = HastaFec % -104;
     Vanyo2    = DesdeFec % -104;
     Vanyon1   = Vanyo1;
     Vanyon2   = Vanyo2;
     Fecha     = Vanyon1 - Vanyon2;

     Vanyo1    = HastaFec % 402;
     Vanyo2    = DesdeFec % 402;
     |SI Vanyo1 > Vanyo2;  Fecha = Fecha + 1;  |FINSI;

     |SI Vanyo1 = Vanyo2;
         Vanyo1 = HastaFec % 104;
         Vanyo2 = DesdeFec % 104;
         |SI Vanyo1 ] Vanyo2;  Fecha = Fecha + 1;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO IncroDismi;
     FechaCal = Fecha - 2;
     |SI FechaCal < 0; FechaCal = 0; |FINSI;

     Porce = 100.00 - (FechaCal * 11.11);
     |SI Porce > 99; Porce = 100; |FINSI;
     |SI FechaCal ] 9; Porce = 0; |FINSI;

     nCanti1    = VIncroDismi;
     nCanti2    = 0;
     fFechaLim  = "20.01.2006";
     |SI #902#2 > fFechaLim;
         nTodosDias = (#902#2    - #902#80);
         nParciDias = (fFechaLim - #902#80);

         nCanti1    = ((VIncroDismi / nTodosDias) * nParciDias) ! 2;
         nCanti2    = VIncroDismi - nCanti1;
     |FINSI;

     VIncremento = ((nCanti1 * Porce) / 100) + nCanti2;
|FPRC;

|PROCESO CalcuIrre;

   |SI FSalida = 9; Recoge = 1; |SINO; Recoge = 0; |FINSI;

||     |SI FSalida ! 9;  |ACABA;  |FINSI;

     #902#2  = #1#68;
     #902#80 = #1#25;
     #902#81 = #1#77;
     |SI #902#2  = "01.01.1900";  #902#2  = "01.01.0000";  |FINSI;
     |SI #902#80 = "01.01.1900";  #902#80 = "01.01.0000";  |FINSI;
     |SI #902#81 = "01.01.1900";  #902#81 = "01.01.0000";  |FINSI;

     |HAZ Amortizacion;

     VAdquisicio = #1#26 + #1#29 - VAmortiza1;
     DesdeFec    = #902#80;
     HastaFec    = "31.12.1996";
     |HAZ Tiempo;

     |SI Recoge = 1;
        ||#902#66 = #1#69 - #1#70;
        #902#66 = (#1#64 * (#1#69 - #1#70)) / (#1#64 + #1#82 + #1#88 + #1#94);
     |FINSI;
     ||#902#66     = #1#69 - #1#70;

     |ABRE #reparame;
     |LEE 000#reparame.p;
     |SI FSalida ! 0; |DDEFECTO #reparame; |FINSI;
     |CIERRA #reparame;

     |SI #reparame#16 = "S";
        #902#68     = (#1#26 - VAmortiza1) * Coefi;
     |SINO;
        #902#68     = (#1#26  + #1#29 - VAmortiza1) * Coefi;
     |FINSI;

     #902#70     = #902#66 - #902#68;
     VIncroDismi = #902#70;
     |HAZ IncroDismi;
     #902#72     = VIncremento - Exento;

     |SI #1#79 ! 0; |O #1#85 ! 0; |O #1#91 ! 0;
         Adquisicio = (#1#79 + #1#85 + #1#91)  - VAmortiza1;
         DesdeFec   = #902#81;
         HastaFec   = "31.12.1996";
         |HAZ Tiempo;

         |SI Recoge = 1;
            ||#902#67     =  #1#82;
            #902#67     =  (#1#69 - #1#70) - #902#66;
         |FINSI;
         #902#69     = ((#1#79+#1#85+#1#91) - VAmortiza1) * Coefi;
         #902#71     = #902#67 - #902#69;
         |PINTA #902#71;
         VIncroDismi = #902#71;
         |HAZ IncroDismi;
         #902#73     = VIncremento - Exento;
     |FINSI;

     |PINTA #902#66;  |PINTA #902#67;  |PINTA #902#68;  |PINTA #902#69;
     |PINTA #902#70;  |PINTA #902#71;  |PINTA #902#72;  |PINTA #902#73;
     |PINTA #902#74;  |PINTA #902#75;  |PINTA #902#76;  |PINTA #902#77;
     |PINTA #902#78;  |PINTA #902#79;  |PINTA #902#2;

     |HAZ Total79;
|FPRC;

|PROCESO CargaDatos212;
     |ABRE #5;
     #5#0 = #0#0;
     |LEE 040#5=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #5;

     |ABRE #7;
     #7#0 = #5#65;
     |LEE 040#7=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #7;

     #902#3  = "X";
     #902#7  = #5#1;
     #902#8  = #5#79;
     #902#9  = #5#5;
     #902#12 = #5#15;
     #902#13 = #5#20;
     #902#14 = #5#21;
     #902#15 = #5#22;
     #902#18 = #5#35;
     #902#19 = #5#39;
     #902#63 = #1#14;

     #902#82 = " ";
     Valfa = #902#18;  |QBT Valfa;  |SI Valfa ! "";  #902#82 = "X";  |FINSI;
     Valfa = #902#19;  |QBT Valfa;  |SI Valfa ! "";  #902#82 = "X";  |FINSI;

     #902#22 = #7#2;
     #902#24 = #7#1;
     #902#26 = #7#3;
     #902#27 = #7#4;
     #902#83 = #7#9;
     #902#31 = #7#5;
     #902#32 = #7#6;
     #902#33 = #7#7;
     #902#34 = #7#8;

     #902#4 = " ";
     Valfa = #902#22;  |QBT Valfa;  |SI Valfa ! "";  #902#4 = "X";  |FINSI;
     Valfa = #902#24;  |QBT Valfa;  |SI Valfa ! "";  #902#4 = "X";  |FINSI;
|FPRC;

|PROCESO Total79;
     #902#74 = #902#72 + #902#73;             |PINTA #902#74;
     #902#76 = #902#74 % #902#75;
     |SI #902#76 < 0; #902#76 = 0; |FINSI;
     |PINTA #902#76;
     #902#79 = #902#76 - #902#77 - #902#78;   |PINTA #902#79;
|FPRC;

|PROCESO Modelo212;
     |SI #0#6  = "N";  |ACABA;  |FINSI;

     |ABRE #1;
     #1#0 = #0#0;
     #1#1 = #0#1;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |SI #1#24 ! "S";
         |ABRE #902;
         #902#0 = #0#0;
         #902#1 = #0#1;
         |BORRA 140#902c;
         |LIBERA #902;
         |CIERRA #902;
         |ACABA;
     |FINSI;

     |PUSHV 0501 2380;
     |ABRE #902;
     #902#0 = #0#0;
     #902#1 = #0#1;
     |LIBERA #902;
     |LEE 140#902=;
      FEstado = FSalida;
     QueTipo = 2;
     |SI FSalida ! 0;
         |DDEFECTO #902;
          #902#0 = #0#0;
          #902#1 = #0#1;
          |HAZ CargaDatos212;
          FSalida = 9;  |HAZ CalcuIrre;  FSalida = 0;
          |GRABA 140#902b;
          QueTipo = 1;
     |SINO;
          |HAZ CalcuIrre;  FSalida = 0;
     |FINSI;

     |PINPA #0#902;
     |PINDA #0#902;
     |ENDATOS #1#902;
     |SI FSalida = 0;
         aMenu4 = "EC";
         aMenu6 = "Cheque nominativo";
      |ET Otra2;
         |MENU aMenu;
         nOpcion = FSalida;
         |SI nOpcion < 1; |O nOpcion > 2; |VETE Otra2; |FINSI;

         |SI nOpcion = 1; #rem00004#85 = "E"; |FINSI;
         |SI nOpcion = 2; #rem00004#85 = "C"; |FINSI;

         |GRABA 140#902a;
     |SINO;
          |SI FEstado ! 0;  |BORRA 140#902c;  |FINSI;
     |FINSI;
     |CIERRA #902;
     |POPV;
|FPRC;

 **********************************************************************
 PROCESOS DEL MANTENIMIENTO 214
 **********************************************************************

|PROCESO CDatos904C3;
     |PUSHV 0501 2380;

     |PARA Campo1 = 1;  |SI Campo1 [ 22;  |HACIENDO Campo1 = Campo1 + 1;
           |C_M #903Campo1, 1, "N";
           |C_V #903Campo1, 1, "N";
     |SIGUE;

     aAlfa1 = #904#6;  |QBT aAlfa1;
     aAlfa2 = #904#7;  |QBT aAlfa2;
     |SI aAlfa1 = "";  |Y  aAlfa2 = "";
         |HAZ CargaDatos214;
     |FINSI;

     |DDEFECTO #903;

     #903#0  = "Sujeto Pasivo";
     #903#1  = #904#6;                          |C_V #903#1,   1, "S";
     #903#3  = #904#7;                          |C_V #903#3,   1, "S";
     #903#4  = #904#9;   |C_M #903#4,  1, "S";  |C_V #903#4,   1, "S";
     #903#5  = #904#10;  |C_M #903#5,  1, "S";  |C_V #903#5,   1, "S";
     #903#6  = #904#11;  |C_M #903#6,  1, "S";  |C_V #903#6,   1, "S";
     #903#7  = #904#12;  |C_M #903#7,  1, "S";  |C_V #903#7,   1, "S";
     #903#8  = #904#13;  |C_M #903#8,  1, "S";  |C_V #903#8,   1, "S";
     #903#9  = #904#14;  |C_M #903#9,  1, "S";  |C_V #903#9,   1, "S";
     #903#10 = #904#15;  |C_M #903#10, 1, "S";  |C_V #903#10,  1, "S";
     #903#11 = #904#16;  |C_M #903#11, 1, "S";  |C_V #903#11,  1, "S";
     #903#12 = #904#17;  |C_M #903#12, 1, "S";  |C_V #903#12,  1, "S";
     #903#13 = #904#18;  |C_M #903#13, 1, "S";  |C_V #903#13,  1, "S";
     #903#14 = #904#19;  |C_M #903#14, 1, "S";  |C_V #903#14,  1, "S";
     #903#16 = #904#8;   |C_M #903#16, 1, "S";  |C_V #903#16,  1, "S";

     |PINPA #0#903;
     |BLANCO 1843 1879;
     |BLANCO 2011 2279;
     |PINDA #0#903;
     |ENDATOS #1#903;
     |SI FSalida = 0;
         #904#8  = #903#16;
         #904#9  = #903#4;
         #904#10 = #903#5;
         #904#11 = #903#6;
         #904#12 = #903#7;
         #904#13 = #903#8;
         #904#14 = #903#9;
         #904#15 = #903#10;
         #904#16 = #903#11;
         #904#17 = #903#12;
         #904#18 = #903#13;
         #904#19 = #903#14;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO CDatos904C4;
     |PUSHV 0501 2380;
     |DDEFECTO #903;

     #903#0  = "Representante";
     |PARA Campo1 = 1;  |SI Campo1 [ 22;  |HACIENDO Campo1 = Campo1 + 1;
           |C_M #903Campo1, 1, "N";
           |C_V #903Campo1, 1, "N";
     |SIGUE;

     #903#1  = #904#45;  |C_M #903#1, 1, "S";  |C_V #903#1, 1, "S";
     |PARA Campo1 = 3;  |SI Campo1 [ 14;  |HACIENDO Campo1 = Campo1 + 1;
           Campo2 = Campo1 + 43;
           #903Campo1  = #904Campo2;
           |C_M #903Campo1, 1, "S";  |C_V #903Campo1, 1, "S";
     |SIGUE;

     |PINPA #0#903;
     |BLANCO 1811 1879;
     |BLANCO 2011 2279;
     |PINDA #0#903;
     |ENDATOS #1#903;
     |SI FSalida = 0;
         #904#45 = #903#1;
         |PARA Campo1 = 3;  |SI Campo1 [ 14;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 43;
               #904Campo2  = #903Campo1;
         |SIGUE;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO CDatos904C5;
     |PUSHV 0501 2380;
     |DDEFECTO #903;

     #903#0  = "Vivienda";
     |PARA Campo1 = 1;  |SI Campo1 [ 22;  |HACIENDO Campo1 = Campo1 + 1;
           |C_M #903Campo1, 1, "N";
           |C_V #903Campo1, 1, "N";
     |SIGUE;

     #903#4  = #904#33;  |C_M #903#4 , 1, "S";  |C_V #903#4 , 1, "S";
     #903#5  = #904#34;  |C_M #903#5 , 1, "S";  |C_V #903#5 , 1, "S";
     #903#6  = #904#35;  |C_M #903#6 , 1, "S";  |C_V #903#6 , 1, "S";
     #903#7  = #904#36;  |C_M #903#7 , 1, "S";  |C_V #903#7 , 1, "S";
     #903#8  = #904#37;  |C_M #903#8 , 1, "S";  |C_V #903#8 , 1, "S";
     #903#9  = #904#38;  |C_M #903#9 , 1, "S";  |C_V #903#9 , 1, "S";
     #903#11 = #904#40;  |C_M #903#11, 1, "S";  |C_V #903#11, 1, "S";
     #903#12 = #904#41;  |C_M #903#12, 1, "S";  |C_V #903#12, 1, "S";
     #903#13 = #904#42;  |C_M #903#13, 1, "S";  |C_V #903#13, 1, "S";
     #903#14 = #904#43;  |C_M #903#14, 1, "S";  |C_V #903#14, 1, "S";
     #903#22 = #904#44;  |C_M #903#22, 1, "S";  |C_V #903#22, 1, "S";
     #903#10 = #904#39;  |C_M #903#10, 1, "S";  |C_V #903#10, 1, "S";

     aAlfa = #903#22; |QBF aAlfa;
     |SI aAlfa = ""; #903#22 = #1#14; |FINSI;

     |PINPA #0#903;
     |PINDA #0#903;
     |BLANCO 1111 1379;
     |BLANCO 1811 1879;
     |ENDATOS #1#903;
     |SI FSalida = 0;
         #904#33 = #903#4;
         #904#34 = #903#5;
         #904#35 = #903#6;
         #904#36 = #903#7;
         #904#37 = #903#8;
         #904#38 = #903#9;
         #904#40 = #903#11;
         #904#41 = #903#12;
         #904#42 = #903#13;
         #904#43 = #903#14;
         #904#44 = #903#22;
         #904#39 = #903#10;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO Mayus7;
     CampoTrabajo = Campo;
     #904Campo = #904Campo > #904Campo;
     |PINTA #904Campo;

     |SI Contenido = "X";  |Y #904Campo = " ";
         |CONFI "2400NEstas seguros de desactivar el apartado : ";
         |SI FSalida ! 0;
             #904Campo = "X";  |PINTA #904Campo;

             |ACABA;
         |FINSI;
     |FINSI;

     |SI #904Campo = " ";
         |SI Campo = 3;    |PDEFECTO #904,  6,  20;   |FINSI;
         |SI Campo = 4;    |PDEFECTO #904, 45,  58;   |FINSI;
         |SI Campo = 5;    |PDEFECTO #904, 33,  45;   |FINSI;
         |ACABA;
     |FINSI;

     |SI #904Campo ! "I";  |ACABA;  |FINSI;

     |SI Campo = 3;   |HAZ CDatos904C3;   |FINSI;
     |SI Campo = 4;   |HAZ CDatos904C4;   |FINSI;
     |SI Campo = 5;   |HAZ CDatos904C5;   |FINSI;

     #904Campo = "X";  |PINTA #904Campo;
|FPRC;

|PROCESO CargaDatos214;
     |ABRE #5;
     #5#0 = #0#0;
     |LEE 040#5=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #5;

     |ABRE #7;
     #7#0 = #5#65;
     |LEE 040#7=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #7;

     #904#3  = "X";

     |SI #0#3 = "T"; |O #0#3 = "G";  |O #0#3 = "V";
         #904#6  = #5#1;
         #904#7  = #5#5;
     |FINSI;

     |SI #0#3 = "C";
         #904#6  = #5#35;
         #904#7  = #5#39;
     |FINSI;

     NFami = 0;
     |SI #0#3 = "1"; NFami = 1; |FINSI;
     |SI #0#3 = "2"; NFami = 2; |FINSI;
     |SI #0#3 = "3"; NFami = 3; |FINSI;
     |SI #0#3 = "4"; NFami = 4; |FINSI;

     |ABRE #rem00101;
     #rem00101#0 = #rem00100#0;
     #rem00101#1 = NFami;
     |LEE 010#rem00101.=;
     |SI FSalida = 0;
        #904#6  = #rem00101#2;
        #904#7  = #rem00101#3;
     |FINSI;
     |CIERRA #rem00101;

     #904#9  = #5#14;
     #904#10 = #5#15;
     #904#11 = #5#16;
     #904#12 = #5#17;
     #904#13 = #5#18;
     #904#14 = #5#19;
     #904#15 = #5#12;
     #904#16 = #5#20;
     #904#17 = #5#21;
     #904#18 = #5#22;

     #904#45 = #7#2;
     #904#46 = #7#1;
     #904#48 = #7#3;
     #904#49 = #7#4;
     #904#53 = #7#9;
     #904#54 = #7#5;
     #904#55 = #7#6;
     #904#56 = #7#7;
     #904#57 = #7#8;

     #904#4 = " ";
     Valfa = #904#45;  |QBT Valfa;  |SI Valfa ! "";  #904#4 = "X";  |FINSI;
     Valfa = #904#46;  |QBT Valfa;  |SI Valfa ! "";  #904#4 = "X";  |FINSI;
|FPRC;

|PROCESO Patri214;
     |SI #4#15 = "S";
         Comodin = #rem00002#4; |QBF Comodin;
         |SI Comodin = "TITULAR"; Comodin = "ZPATRITIT"; |FINSI;
         |SI Comodin = "CONYUGE"; Comodin = "ZPATRICON"; |FINSI;
         |SI Comodin = "CONJUNTA"; |O Comodin = "GANANCIAL";
            |ABRE #rem01002;           || Busco las casillas de la liquidacion del patrimonio
            #rem01002#0 = #0#0;        || Codigo
            #rem01002#1 = 0;           || Complementaria
            #rem01002#2 = "ZPATRITIT"; || Tipo contribuyente
            #rem01002#3 = 1;           || Bloque
            #rem01002#4 = "023";       || Casilla
            |LEE 040#rem01002.=;
            |SI FSalida = 0;
               #904#20 = #rem01002#6;
            |SINO;
               |MENAV "    Debe hacer la liquidacion del modelo 714";
               |CIERRA #rem01002;
               |ACABA;
            |FINSI;

            #rem01002#3 = 1;        || Bloque
            #rem01002#4 = "024";        || Casilla
            |LEE 040#rem01002.=;
            |SI FSalida = 0;
               #904#21 = #rem01002#6;
            |SINO;
               |MENAV "    Debe hacer la liquidacion del modelo 714";
               |CIERRA #rem01002;
               |ACABA;
            |FINSI;

            #rem01002#0 = #0#0;        || Codigo
            #rem01002#1 = 0;           || Complementaria
            #rem01002#2 = "ZPATRICON"; || Tipo contribuyente
            #rem01002#3 = 1;          || Bloque
            #rem01002#4 = "023";       || Casilla
            |LEE 040#rem01002.=;
            |SI FSalida = 0;
               #904#20 = #904#20 + #rem01002#6;
            |SINO;
               |MENAV "    Debe hacer la liquidacion del modelo 714";
               |CIERRA #rem01002;
               |ACABA;
            |FINSI;

            #rem01002#3 = 1;        || Bloque
            #rem01002#4 = "024";        || Casilla
            |LEE 040#rem01002.=;
            |SI FSalida = 0;
               #904#21 = #904#21 + #rem01002#6;
            |SINO;
               |MENAV "    Debe hacer la liquidacion del modelo 714";
               |CIERRA #rem01002;
               |ACABA;
            |FINSI;
            #904#20 = #904#20 % 50;
            #904#21 = #904#21 % 50;
            |CIERRA #rem01002;
         |SINO;
            |ABRE #rem01002;           || Busco las casillas de la liquidacion del patrimonio
            #rem01002#0 = #0#0;        || Codigo
            #rem01002#1 = 0;           || Complementaria
            #rem01002#2 = Comodin;     || Tipo contribuyente
            #rem01002#3 = 1;          || Bloque
            #rem01002#4 = "023";       || Casilla
            |LEE 040#rem01002.=;
            |SI FSalida = 0;
               #904#20 = #rem01002#6;
            |SINO;
               |MENAV "    Debe hacer la liquidacion del modelo 714";
               |CIERRA #rem01002;
               |ACABA;
            |FINSI;

            #rem01002#3 = 1;        || Bloque
            #rem01002#4 = "024";        || Casilla
            |LEE 040#rem01002.=;
            |SI FSalida = 0;
               #904#21 = #rem01002#6;
            |SINO;
               |MENAV "    Debe hacer la liquidacion del modelo 714";
               |CIERRA #rem01002;
               |ACABA;
            |FINSI;
            |CIERRA #rem01002;
         |FINSI;
     |SINO;
         #904#20 = #1#15;
         |SI #904#20 < #1#26;  #904#20 = #1#26; |FINSI;
         |SI #904#20 < #1#27;  #904#20 = #1#27; |FINSI;
         |SI #rem00002#3 = "G"; #904#20 = #904#20 / 2; |FINSI;
         |SI #904#20 = 0; |ACABA; |FINSI;
         #904#21 = #1#129;
     |FINSI;

     #904#22 = #904#20 - #904#21;
     |PARA Campo1 = 8;  |SI Campo1 ] 1; |HACIENDO  Campo1 = Campo1 - 1;
           Campo2 = Campo1 + 8;
           Campo3 = Campo1 + 16;
           |SI #904#22 > #9Campo1;
               |SI #9Campo1 ! 0;  |O Campo1 = 1;
                   #904#23 = #9Campo1;
                   #904#25 = #9Campo2;
                   #904#27 = #9Campo3;
                   #904#24 = #904#22 - #904#23;
                   #904#26 = #904#24 % #904#27;
                   #904#28 = #904#25 + #904#26;
                   |SAL;
               |FINSI;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Renta214;
||     nTDias = #1#30 + #1#31 + #1#32;
     nTDias = 365;

     |SI #rem00021#30 ! 0;
         Calc = (#1#15 * #rem00021#30) / nTDias;
         |SI #rem00021#17 = "S";
             Calc = Calc % 1.1;
         |SINO;
             Calc = Calc % 2;
         |FINSI;
         #rem00005#29 = Calc;
     |FINSI;

     |SI #rem00021#32 ! 0;
         Calc = (#rem00021#15 * #rem00021#32) / nTDias;
         |SI #rem00021#17 = "S";
             Calc = Calc % 1.1;
         |SINO;
             Calc = Calc % 2;
         |FINSI;
         #rem00005#29 = #rem00005#29 + Calc;
     |FINSI;

     |SI #rem00002#3 = "G"; #904#29 = #904#29 / 2; |FINSI;

                            #rem00005#30 = 0;
     |SI #rem00005#29 ! 0;  #rem00005#30 = 24;  |FINSI;
     #rem00005#31 = #rem00005#29 % #rem00005#30;
|FPRC;

|PROCESO Calcu214;
     |PDEFECTO #904, 20, 30;
     |PDEFECTO #904, 31, 33;

     |SI #0#2 = "A";  |O #0#2 = "R";  |HAZ Renta214;  |FINSI;
     |SI #0#2 = "A";  |O #0#2 = "P";  |HAZ Patri214;  |FINSI;

     #904#32 = #904#28 + #904#31;

     |PINTA #904#20;  |PINTA #904#21;  |PINTA #904#22;
     |PINTA #904#23;  |PINTA #904#24;  |PINTA #904#25;
     |PINTA #904#26;  |PINTA #904#27;  |PINTA #904#28;
     |PINTA #904#29;  |PINTA #904#30;  |PINTA #904#31;
     |PINTA #904#32;
|FPRC;

|RUTINA inf1906;
   #rem00011#0 = #rem00010#0;
   #rem00011#1 = #rem00010#1;
   #rem00011#2 = 01;
|FRUT;

|RUTINA sup1906;
   #rem00011#0 = #rem00010#0;
   #rem00011#1 = #rem00010#1;
   #rem00011#2 = 99;
|FRUT;

|RUTINA inf1907;
   #rem00012#0 = #rem00010#0;
   #rem00012#1 = #rem00010#1;
   #rem00012#2 = 01;
|FRUT;

|RUTINA sup1907;
   #rem00012#0 = #rem00010#0;
   #rem00012#1 = #rem00010#1;
   #rem00012#2 = 99;
|FRUT;

|PROCESO ImpInmuebles;
   #rem00010#3 = #rem00010#3 + #rem00011#13;
|FPRC;

|DEFBUCLE ImpInmuebles;
#rem00011#1;
;
#rem00010#0, #rem00010#1,01;
#rem00010#0, #rem00010#1,99;
;
NULL,ImpInmuebles;
|FIN;

|PROCESO BorraInm213;
   |BORRA 020#rem00011.a;
|FPRC;

|DEFBUCLE BorraInm213;
#rem00011#1;
;
#rem00010#0, #rem00010#1,01;
#rem00010#0, #rem00010#1,99;
be;
NULL,BorraInm213;
|FIN;

|PROCESO ImportaInm;
   #rem00011#0 = #rem00010#0;
   #rem00011#1 = #rem00010#1;
   #rem00011#2 = #rem00021#1;
   |LEE 000#rem00011.=;
   |SI FSalida ! 0;
      |DDEFECTO #rem00011;
      #rem00011#0  = #rem00010#0;
      #rem00011#1  = #rem00010#1;
      #rem00011#2  = #rem00021#1;
      #rem00011#3  = #rem00021#13;
      #rem00011#8  = #rem00021#14;
      #rem00011#9  = #rem00021#105;
      #rem00011#10 = #rem00021#106;

      |ABRE #repoblac;
      #repoblac#0 = #rem00021#105;
      #repoblac#1 = #rem00021#106;
      |LEE 000#repoblac.=;
      |SI FSalida = 0;
         #rem00011#11 = #repoblac#3;
         #rem00011#12 = #repoblac#2;
      |FINSI;
      |CIERRA #repoblac;

      #rem00011#13 = #rem00021#15;
      |GRABA 020#rem00011.n;

      #rem00010#3 = #rem00010#3 + #rem00011#13;
   |FINSI;
|FPRC;

|DEFBUCLE ImportaInm;
#rem00021#1;
;
#rem00010#0,01;
#rem00010#0,99;
;
NULL,ImportaInm;
|FIN;

|PROCESO BorraInm;
   |BORRA 020#rem00011.a;
|FPRC;

|DEFBUCLE BorraInm;
#rem00011#1;
;
#rem00010#0,#rem00010#1,01;
#rem00010#0,#rem00010#1,99;
;
NULL,BorraInm;
|FIN;

|PROCESO DespuesBase;
   |SI FSalida = 10;
      |PUSHV 1501 2380;
      |ENTLINEAL #1#rem00011,-3,2,22,1,inf1906,sup1906;
      |POPV;
      #rem00010#3 = 0;
      |BUCLE ImpInmuebles;
      |PINTA #rem00010#3;
      #rem00010#5 = #rem00010#3 % #rem00010#4; |PINTA #rem00010#5;
      #rem00010#7 = #rem00010#5 % #rem00010#6; |PINTA #rem00010#7;
      #rem00010#8 = #rem00010#5 - #rem00010#7; |PINTA #rem00010#8;
   |FINSI;
   |SI FSalida = 11;
      |CONFI "    NEsta a punto de borrar la información actual e importar desde las lineas de inmuebles. Esta seguro ? ";
      |SI FSalida = 0;
         #rem00010#3 = 0;
         |BUCLE BorraInm; |BUCLE ImportaInm;
         |PINTA #rem00010#3;
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO TomaPorc;
   ModoEntrada = (FEntrada / 100) ! 0;
   |SI ModoEntrada = 1;
      #rem00012#9 = #rem00010#6; |PINTA #rem00012#9;
   |FINSI;
|FPRC;

|PROCESO BorraSoc;
   |BORRA 020#rem00012.a;
|FPRC;

|DEFBUCLE BorraSoc;
#rem00012#1;
;
#rem00010#0,#rem00010#1,01;
#rem00010#0,#rem00010#1,99;
;
NULL,BorraSoc;
|FIN;

|PROCESO Modelo213;
   |ABRE #rem00010;   |ABRE #rem00011;
   #rem00010#0 = #rem00002#0;
   #rem00010#1 = #rem00002#1;
   |LEE 101#rem00010.=;
   |SI FSalida ! 0;
      |DDEFECTO #rem00010;
      #rem00010#0 = #rem00002#0;
      #rem00010#1 = #rem00002#1;
      |GRABA 020#rem00010.b;
      SwNuevo = 1;
   |SINO;
      SwNuevo = 0;
   |FINSI;

   |PUSHV 0501 2380;

   |PINPA #0#rem00010; |PINDA #0#rem00010;
   |ENDATOS #1#rem00010;
   |SI FSalida = 0;
      |GRABA 020#rem00010.a;
      |SI #rem00010#2 = "1";
         |PUSHV 1501 2380;
         |ENTLINEAL #1#rem00012,-3,2,22,1,inf1907,sup1907;
         |POPV;
      |SINO;
         |BUCLE BorraSoc;
      |FINSI;
   |SINO;
      |SI SwNuevo = 1;
         |BUCLE BorraInm; |BUCLE BorraSoc;
         |BORRA 020#rem00010.a;
      |SINO;
         |ERROR;
      |FINSI;
   |FINSI;
   |LIBERA #rem00010;
   |CIERRA #rem00011; |CIERRA #rem00010;

   |POPV;
|FPRC;

|PROCESO Modelo214;
     |SI #0#6  = "N";  |ACABA;  |FINSI;

     |ABRE #4;
     |LEE 040#4p;
     |SI FSalida ! 0;  |DDEFECTO #4;  |FINSI;
     |CIERRA #4;

     |SI #4#15 = "S";
         |SI #0#3 ! "T"; |Y #0#3 ! "C"; |Y #0#3 ! "G";
             |MENAV "    Debe introducir como perceptor una <T> o una <C>";
             |ACABA;
         |FINSI;
         |SI #0#3 = "G"; Conjunta = 1; |SINO; Conjunta = 0; |FINSI;

         |ABRE #5;
         #5#0 = #0#0;
         |LEE 040#5=;
         |SI FSalida ! 0;  |DDEFECTO #5;  |FINSI;
         |CIERRA #5;
     |FINSI;

     |ABRE #1;
     #1#0 = #0#0;
     #1#1 = #0#1;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;
/*
     |SI #1#13 ! "H";  |O #1#31 = "S";
         |ABRE #904;
         #904#0 = #0#0;
         #904#1 = #0#1;
         |BORRA 140#904c;
         |LIBERA #904;
         |CIERRA #904;
         |ACABA;
     |FINSI;
*/

                                      nAutonomia = 0;
     |SI #0#3 = "T";  |O #0#3 = "G";  nAutonomia = #5#11;  |FINSI;
     |SI #0#3 = "C";                  nAutonomia = #5#43;  |FINSI;

     |ABRE #9;
     #9#0 = nAutonomia;
     |LEE 040#9=;
     |SI FSalida ! 0;
         #9#0 = 0;
         |LEE 040#9=;
         |SI FSalida ! 0;  |DDEFECTO #9;  |FINSI;
     |FINSI;
     |CIERRA #9;

     Modelo = 214;

     |PUSHV 0501 2380;
     |ABRE #904;
     #904#0 = #0#0;
     #904#1 = #0#1;
     |LIBERA #904;
     |LEE 140#904=;
     FEstado = FSalida;
     ||HTipo   = 2;
     |SI FSalida ! 0;
         |DDEFECTO #904;
          #904#0 = #0#0;
          #904#1 = #0#1;
          |HAZ CargaDatos214;
          |HAZ Calcu214;
          |GRABA 140#904b;
||          HTipo   = 1;
     |FINSI;

     |PINPA #0#904;
     |PINDA #0#904;
     |ENDATOS #1#904;
     |SI FSalida = 0;
         |SI #904#32 ! 0; |O #904#28 ! 0; |O #904#31 ! 0;
/*
             HContribu  = #0#0;
             HNombre    = #5#0;
             HPrograma  = "(rem00004) MODELO 214";
             HLinea     = #0#1;
             HPerceptor = #0#3;
             HRdto      = #904#32;
             |SI QueTipo = 1; HTipo = "ALTA FICHA";         |FINSI;
             |SI QueTipo = 2; HTipo = "MODIFICACION FICHA"; |FINSI;
             |HAZ AltaHistorico;
*/
             aMenu4 = "EA";
             aMenu6 = "Adeudo en cuenta";
          |ET Otra3;
             |MENU aMenu;
             nOpcion = FSalida;
             |SI nOpcion < 1; |O nOpcion > 2; |VETE Otra3; |FINSI;

             |SI nOpcion = 1; #rem00005#62 = "E"; |FINSI;
             |SI nOpcion = 2; #rem00005#62 = "A"; |FINSI;

             |SI Conjunta = 1;
                #904#61 = 1;
             |SINO;
                #904#61 = 0;
             |FINSI;
             |GRABA 140#904a;
         |SINO;
/*
             HContribu  = #0#0;
             HNombre    = #5#0;
             HPrograma  = "(rem00004) MODELO 214";
             HLinea     = #0#1;
             HPerceptor = #0#3;
             HRdto      = #904#32;
             HTipo      = "BAJA FICHA"
             |HAZ AltaHistorico;
*/
             |BORRA 140#904c;
         |FINSI;
     |SINO;
          |SI FEstado ! 0;  |BORRA 140#904c;  |FINSI;
     |FINSI;
     |CIERRA #904;
     |POPV;
|FPRC;

 **************************************
 PROCESOS PROPIOS DEL PROGRAMA rew00006
 **************************************

|PROCESO Mayus4;
     #901Campo = #901Campo > #901Campo;
     |PINTA #901Campo;
|FPRC;

|PROCESO TeclaF1;
     |ABRE #5;
     #5#0 = #0#0;
     |LEE 040#5=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #5;

     |PDEFECTO #901, 1, 18;

     |SI CampoTrabajo ! 4;
         #901#1  = #5#1;      |PINTA #901#1;
         #901#2  = #5#79;     |PINTA #901#2;
         #901#3  = #5#5;      |PINTA #901#3;
         #901#4  = #5#14;     |PINTA #901#4;
         #901#5  = #5#15;     |PINTA #901#5;
         #901#6  = #5#16;     |PINTA #901#6;
         #901#7  = #5#17;     |PINTA #901#7;
         #901#8  = #5#18;     |PINTA #901#8;
         #901#9  = #5#19;     |PINTA #901#9;
         #901#10 = #5#12;     |PINTA #901#10;
         #901#11 = #5#20;     |PINTA #901#11;
         #901#12 = #5#21;     |PINTA #901#12;
         #901#13 = #5#22;     |PINTA #901#13;
     |SINO;
         #901#1  = #5#1;      |PINTA #901#1;
         #901#2  = #5#79;     |PINTA #901#2;
         #901#3  = #5#5;      |PINTA #901#3;
         #901#5  = #5#73;     |PINTA #901#5;
         #901#13 = #5#76;     |PINTA #901#13;
         #901#16 = #5#78;     |PINTA #901#16;
         #901#17 = #5#77;     |PINTA #901#17;
     |FINSI;
|FPRC;

|PROCESO TeclaF2;
     |ABRE #5;
     #5#0 = #0#0;
     |LEE 040#5=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #5;

     |PDEFECTO #901, 1, 18;

     |SI CampoTrabajo ! 4;
         #901#1  = #5#35;     |PINTA #901#1;
         #901#2  = #5#79;     |PINTA #901#2;
         #901#3  = #5#39;     |PINTA #901#3;
         #901#4  = #5#14;     |PINTA #901#4;
         #901#5  = #5#15;     |PINTA #901#5;
         #901#6  = #5#16;     |PINTA #901#6;
         #901#7  = #5#17;     |PINTA #901#7;
         #901#8  = #5#18;     |PINTA #901#8;
         #901#9  = #5#19;     |PINTA #901#9;
         #901#10 = #5#12;     |PINTA #901#10;
         #901#11 = #5#20;     |PINTA #901#11;
         #901#12 = #5#21;     |PINTA #901#12;
         #901#13 = #5#22;     |PINTA #901#13;
     |SINO;
         #901#1  = #5#35;     |PINTA #901#1;
         #901#2  = #5#79;     |PINTA #901#2;
         #901#3  = #5#39;     |PINTA #901#3;
         #901#5  = #5#73;     |PINTA #901#5;
         #901#13 = #5#76;     |PINTA #901#13;
         #901#16 = #5#78;     |PINTA #901#16;
         #901#17 = #5#77;     |PINTA #901#17;
     |FINSI;
|FPRC;

|PROCESO TeclaF3;
     |ABRE #5;
     #5#0 = #0#0;
     |LEE 040#5=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #5;

     |ABRE #7;
     #7#0 = #5#65;
     |LEE 040#7=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #7;

     |PDEFECTO #901, 1, 18;

     |SI CampoTrabajo ! 4;
         #901#1  = #7#2;      |PINTA #901#1;
         #901#3  = #7#1;      |PINTA #901#3;
         #901#5  = #7#3;      |PINTA #901#5;
         #901#6  = #7#4;      |PINTA #901#6;
         #901#10 = #7#9;      |PINTA #901#10;
         #901#11 = #7#5;      |PINTA #901#11;
         #901#12 = #7#6;      |PINTA #901#12;
         #901#13 = #7#7;      |PINTA #901#13;
         #901#14 = #7#8;      |PINTA #901#14;
     |SINO;
         #901#1  = #7#2;      |PINTA #901#1;
         #901#3  = #7#1;      |PINTA #901#3;
         #901#5  = #7#3;      |PINTA #901#5;
         #901#13 = #7#7;      |PINTA #901#13;
     |FINSI;
|FPRC;

|PROCESO TeclaF4;
     |PDEFECTO #901, 1, 18;

     |SI CampoTrabajo = 2;  |ACABA;  |FINSI;

     |SI CampoTrabajo = 4;
         #901#1  = #900#15;      |PINTA #901#1;
         #901#2  = #900#16;      |PINTA #901#2;
         #901#3  = #900#17;      |PINTA #901#3;
         #901#5  = #900#19;      |PINTA #901#5;
         #901#13 = #900#27;      |PINTA #901#13;
         |ACABA;
     |FINSI;

     |PARA Campo1 = 15;  |SI Campo1 [ 28;  |HACIENDO Campo1 = Campo1 + 1;
           Campo2 = Campo1 - 14;
           #901Campo2 = #900Campo1;  |PINTA #901Campo2;
           |SI Campo2 = 10;  |Y CampoTrabajo ] 6;
               #901Campo2 = "";  |PINTA #901Campo2;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO TeclaF5;
     |PDEFECTO #901, 1, 18;

     |SI CampoTrabajo = 4;  |ACABA;  |FINSI;

     #901#1  = #900#29;           |PINTA #901#1;
     #901#2  = #900#30;           |PINTA #901#2;
     #901#3  = #900#31;           |PINTA #901#3;
     #901#5  = #900#35;           |PINTA #901#5;
     #901#13 = #900#36;           |PINTA #901#13;
|FPRC;

|PROCESO TeclaF6;
     |PDEFECTO #901, 1, 18;

     |SI CampoTrabajo = 6;  |ACABA;  |FINSI;

     |SI CampoTrabajo = 4;
         #901#1  = #900#51;      |PINTA #901#1;
         #901#2  = #900#52;      |PINTA #901#2;
         #901#3  = #900#53;      |PINTA #901#3;
         #901#5  = #900#55;      |PINTA #901#5;
         #901#13 = #900#62;      |PINTA #901#13;
         |ACABA;
     |FINSI;

     |PARA Campo1 = 51;  |SI Campo1 [ 63;  |HACIENDO Campo1 = Campo1 + 1;
           Campo2 = Campo1 - 50;
           |SI Campo2 ] 10;  Campo2 = Campo1 - 49;  |FINSI;
           #901Campo2 = #900Campo1;  |PINTA #901Campo2;
     |SIGUE;
|FPRC;

|PROCESO TeclaF7;
     |PDEFECTO #901, 1, 18;

     |SI CampoTrabajo = 7;  |ACABA;  |FINSI;

     |SI CampoTrabajo = 4;
         #901#1  = #900#64;      |PINTA #901#1;
         #901#2  = #900#65;      |PINTA #901#2;
         #901#3  = #900#66;      |PINTA #901#3;
         #901#5  = #900#68;      |PINTA #901#5;
         #901#13 = #900#75;      |PINTA #901#13;
         |ACABA;
     |FINSI;

     |PARA Campo1 = 64;  |SI Campo1 [ 76;  |HACIENDO Campo1 = Campo1 + 1;
           Campo2 = Campo1 - 63;
           |SI Campo2 ] 10;  Campo2 = Campo1 - 62;  |FINSI;
           #901Campo2 = #900Campo1;  |PINTA #901Campo2;
     |SIGUE;
|FPRC;

|PROCESO TeclaF8;
     |PDEFECTO #901, 1, 18;

     |SI CampoTrabajo = 8;  |ACABA;  |FINSI;

     |SI CampoTrabajo = 4;
         #901#1  = #900#77;      |PINTA #901#1;
         #901#2  = #900#78;      |PINTA #901#2;
         #901#3  = #900#79;      |PINTA #901#3;
         #901#5  = #900#81;      |PINTA #901#5;
         #901#13 = #900#88;      |PINTA #901#13;
         |ACABA;
     |FINSI;

     |PARA Campo1 = 77;  |SI Campo1 [ 89;  |HACIENDO Campo1 = Campo1 + 1;
           Campo2 = Campo1 - 76;
           |SI Campo2 ] 10;  Campo2 = Campo1 - 75;  |FINSI;
           #901Campo2 = #900Campo1;  |PINTA #901Campo2;
     |SIGUE;
|FPRC;

|PROCESO Tecla;  |TIPO 0;
     |SI FSalida < 9;  |O FSalida > 17;  |ACABA;  |FINSI;

     |SI FSalida = 9;   |HAZ TeclaF1;  |FINSI;
     |SI FSalida = 10;  |HAZ TeclaF2;  |FINSI;
     |SI FSalida = 11;  |HAZ TeclaF3;  |FINSI;
     |SI FSalida = 12;  |HAZ TeclaF4;  |FINSI;
     |SI FSalida = 13;  |HAZ TeclaF5;  |FINSI;
     |SI FSalida = 14;  |HAZ TeclaF6;  |FINSI;
     |SI FSalida = 15;  |HAZ TeclaF7;  |FINSI;
     |SI FSalida = 16;  |HAZ TeclaF8;  |FINSI;
     |ERROR;
|FPRC;

|PROCESO PintaNombre;
     |SI #901#11 = 0;  |Y #901#12 = 0;  |ACABA;  |FINSI;

     |ABRE #6;
     #6#0 = #901#11;
     #6#1 = #901#12;
     |LEE 040#6=;
     |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;
      |CIERRA #6;

     #901#13 = #6#3;  |PINTA #901#13;
|FPRC;

 **************************************
 PROCESOS PROPIOS DEL PROGRAMA rew00007
 **************************************

|PROCESO Mayus6;
     |SI CampoTrabajo = 6;  |ACABA;    |FINSI;
     |SI Modelo       = 214;  |ACABA;  |FINSI;

     #903Campo = #903Campo > #903Campo;
     |PINTA #903Campo;
|FPRC;

|PROCESO PintaDatos; |TIPO 7;
   Base = #900#98 + #900#103 + #900#112;
   #900#114 = (Base * #900#113) / 100;

   |SI #900#114 < 0;  #900#114 = 0;  |FINSI;

   |PINTA #900#114;
   #900#117 = #900#114 - #900#115 - #900#116;  |PINTA #900#117;
|FPRC;

|PROCESO Saca; |TIPO 7;
   |SI Campo = 131; eaTabla = "zpaises.txt";  nLCod = 3; nLDes = 30; |FINSI;
   |SI Campo = 132; eaTabla = "ztiporta.txt"; nLCod = 2; nLDes = 58; |FINSI;
   |SI Campo = 133; eaTabla = "zdivisas.txt"; nLCod = 3; nLDes = 30; |FINSI;
   |HAZ CargaTabla;
|FPRC;

|PROCESO Comp;
     nCampo   = Campo + 1;

     |SI FSalida = 10;
         enPosicion = 20;
         |HAZ SacaTabla;
         nCalc = 100 + nLCod;
         aAlfa1   = eaDestino % nCalc;
         #900Campo  = aAlfa1; |PINTA #900Campo;
     |FINSI;

     enComp = nLCod;
     aAlfa = "|C" + (("000" + Campo) % -103) + "TIPO"; aAlfa1 = #900#aAlfa#;
     aAlfa = #900Campo; |QBF aAlfa;
     |SI aAlfa1 = "N"; nCalc = - (100 + nLCod); aAlfa = (("0" * enComp) + aAlfa) % nCalc; |FINSI;
     |SI aAlfa1 ! "N"; nCalc = 100 + nLCod;     aAlfa = (aAlfa + (" " * enComp)) % nCalc; |FINSI;
     eaAlfa = aAlfa;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR; |ACABA;
     |FINSI;

     nCalc = 100 + nLCod;                 aAlfa1   = eaDestino % nCalc;
     nCalc = ((nLCod + 2) * 100) + nLDes; aAlfa2   = eaDestino % nCalc;
     #900Campo  = aAlfa1;
     |C_P #900Campo,0,nCalc; nCalc = nCalc + nLCod + 1;
     |PINTA #900Campo;
     aAlfa1 = " " * nLDes; |PINTA nCalc, aAlfa1;
     |ATRI I; |PINTA nCalc, aAlfa2; |ATRI N;

     |HAZ FinTabla;
|FPRC;
