|FICHEROS;
   rerendir #0;
   reproedi #1;
   reprofco #2;
   reempedi #3;
   reemprco #4;
   reempmod #5;
   reempagr #6;
|FIN;

|VARIABLES;
   FEstado      = 0;
   suma         = 0;
   valor        = 0;
   pantalla     = 0;

   &empresa     = 0;
   &nombre      = "";
   &modo        = 0;
   &modelito    = 0;
   &tipomod     = "";
   &errorlin    = 0;

   &numerica1   = 0;  &numerica2  = 0;   &numerica3  = 0;
   &numerica4   = 0;  &numerica5  = 0;   &numerica6  = 00.00;
   &numerica7   = 0;  &numerica8  = 8;
|FIN;

|INCLUYE i_husuar;
|INCLUYE i_activo;

|RUTINA inferior;
  #0#0 = empresa;
  #0#1 = 1;
|FRUT;

|RUTINA superior;
  #0#0 = empresa;
  #0#1 = 99;
|FRUT;

|PROGRAMA;
|PINPA #0#0;
|SI modo = 1;  |ENTLINEAL #1#0,2,1,15,0,inferior,superior;  |FINSI;
|SI modo = 2;  |ENTLINEAL #1#0,2,2,15,0,inferior,superior;  |FINSI;
|SI modo = 4;  |ENTLINEAL #1#0,2,4,15,0,inferior,superior;  |FINSI;
|FPRO;

|PROCESO ayuda; |TIPO 2;
pantalla = 0 +. 1;

QueTipo    = (FEntrada / 100) ! 0;

|SI pantalla = 1;
   |SI #0#2 = "PD"; |HAZ profdire; |FINSI;
   |SI #0#2 = "PC"; |HAZ profcoef; |FINSI;
   |SI #0#2 = "ED"; |HAZ emprdire; |FINSI;
   |SI #0#2 = "EC"; |HAZ emprcoef; |FINSI;
   |SI #0#2 = "EM"; |HAZ emprmodu; |FINSI;
   |SI #0#2 = "AG"; |HAZ agricola; |FINSI;
   |SI FEstado = 0;
       |HAZ cargadat;
   |SINO;
       |ERROR;  |ACABA;
   |FINSI;
|FINSI;

HContribu  = #0#0;
HNombre    = nombre;
HPrograma  = "(rerendir) RENDIMIENTOS IRREGULARES";
HLinea     = #0#1;
HPerceptor = #0#5;
HRdto      = #0#7;

|SI QueTipo = 1; HTipo = "ALTA FICHA";         |FINSI;
|SI QueTipo = 2; HTipo = "MODIFICACION FICHA"; |FINSI;
|SI QueTipo = 3; HTipo = "BAJA FICHA";         |FINSI;

|SI QueTipo = 3; |Y pantalla ! 1;  |HAZ AltaHistorico;  |FINSI;
|SI QueTipo < 3; |Y pantalla = 1;  |HAZ AltaHistorico;  |FINSI;
|FPRC;

|PROCESO consulta; |TIPO 0;
modelito = (FEntrada / 100) ! 0;
|SI modelito = 4; |HAZ cargadat; |FINSI;
|FPRC;

|PROCESO cargadat;
numerica1  = #0#8;
numerica2  = #0#9;
numerica3  = #0#10;
numerica4  = #0#11;
numerica5  = #0#12;
numerica6  = #0#13;
numerica7  = #0#14;
numerica8  = #0#15;

|SUB_EJECUTA "repant08.run";
|SI errorlin = 0; |ERROR; |SINO; |HAZ carga; |FINSI;
|FPRC;

|PROCESO carga;
|SI modelito ! 4;
   #0#8   = numerica1;
   #0#9   = numerica2;
   #0#10  = numerica3;
   #0#11  = numerica4;
   #0#12  = numerica5;
   #0#13  = numerica6;
   #0#14  = numerica7;
   #0#15  = numerica8;
   npro   = 13; |HAZ sigrabo;
   |PINTA #0#7;
|FINSI;
|FPRC;

|PROCESO profdire;
|ABRE #1;
#1#0 = #0#0;
#1#1 = #0#3;
|LEE 040#1=;
FEstado = FSalida;
|SI FSalida = 0;
   #0#4  = #1#2;
   #0#5  = #1#3;
   #0#6  = #1#15;
   #0#7  = #1#28;
   #0#16 = #1#4;
   #0#16 = #1#4;
   #0#17 = #1#7;
   #0#18 = #1#8;
   #0#19 = #1#9;
   #0#20 = #1#10;
   #0#21 = #1#11;
   #0#22 = #1#12;
   #0#23 = #1#35;
   |PINTA #0#4;
   |PINTA #0#5;
   |PINTA #0#6;
   |PINTA #0#7;
|SINO;
   |MENAV "     No existe registro Rendimiento Irregulares";
   |ERROR; |ACABA;
|FINSI;
|LIBERA #1;
|CIERRA #1;
|FPRC;

|PROCESO profcoef;
|ABRE #2;
#2#0 = #0#0;
#2#1 = #0#3;
|LEE 040#2=;
FEstado = FSalida;
|SI FSalida = 0;
   #0#4  = #2#2;
   #0#5  = #2#3;
   #0#6  = #2#15;
   #0#7  = #2#32;
   #0#16 = #2#4;
   #0#17 = #2#7;
   #0#18 = #2#8;
   #0#19 = #2#9;
   #0#20 = #2#10;
   #0#21 = #2#11;
   #0#22 = #2#12;
   #0#23 = #2#42;
   |PINTA #0#4;
   |PINTA #0#5;
   |PINTA #0#6;
   |PINTA #0#7;
|SINO;
   |MENAV "     No existe registro Rendimiento Irregulares";
   |ERROR; |ACABA;
|FINSI;
|CIERRA #2;
|FPRC;

|PROCESO emprdire;
|ABRE #3;
#3#0 = #0#0;
#3#1 = #0#3;
|LEE 040#3=;
FEstado = FSalida;
|SI FSalida = 0;
   #0#4  = #3#2;
   #0#5  = #3#3;
   #0#6  = #3#15;
   #0#7  = #3#49;
   #0#16 = #3#4;
   #0#17 = #3#7;
   #0#18 = #3#8;
   #0#19 = #3#9;
   #0#20 = #3#10;
   #0#21 = #3#11;
   #0#22 = #3#12;
   #0#23 = #3#54;
   |PINTA #0#4;
   |PINTA #0#5;
   |PINTA #0#6;
   |PINTA #0#7;
|SINO;
   |MENAV "     No existe registro Rendimiento Irregulares";
   |ERROR; |ACABA;
|FINSI;
|CIERRA #3;
|FPRC;

|PROCESO emprcoef;
|ABRE #4;
#4#0 = #0#0;
#4#1 = #0#3;
|LEE 040#4=;
FEstado = FSalida;
|SI FSalida = 0;
   #0#4  = #4#2;
   #0#5  = #4#3;
   #0#6  = #4#15;
   #0#7  = #4#32;
   #0#16 = #4#4;
   #0#17 = #4#7;
   #0#18 = #4#8;
   #0#19 = #4#9;
   #0#20 = #4#10;
   #0#21 = #4#11;
   #0#22 = #4#12;
   #0#23 = #4#43;
   |PINTA #0#4;
   |PINTA #0#5;
   |PINTA #0#6;
   |PINTA #0#7;
|SINO;
   |MENAV "     No existe registro Rendimiento Irregulares";
   |ERROR; |ACABA;
|FINSI;
|CIERRA #4;
|FPRC;

|PROCESO emprmodu;
|ABRE #5;
#5#0 = #0#0;
#5#1 = #0#3;
|LEE 040#5=;
FEstado = FSalida;
|SI FSalida = 0;
   #0#4  = #5#2;
   #0#5  = #5#3;
   #0#6  = #5#15;
   #0#7  = #5#49;
   #0#16 = #5#4;
   #0#17 = #5#7;
   #0#18 = #5#8;
   #0#19 = #5#9;
   #0#20 = #5#10;
   #0#21 = #5#11;
   #0#22 = #5#12;
   #0#23 = #5#54;
   |PINTA #0#4;
   |PINTA #0#5;
   |PINTA #0#6;
   |PINTA #0#7;
|SINO;
   |MENAV "     No existe registro Rendimiento Irregulares";
   |ERROR; |ACABA;
|FINSI;
|CIERRA #5;
|FPRC;

|PROCESO agricola;
|ABRE #6;
#6#0 = #0#0;
#6#1 = #0#3;
|LEE 040#6=;
FEstado = FSalida;
|SI FSalida = 0;
   #0#4  = #6#2;
   #0#5  = #6#3;
   #0#6  = #6#15;
   #0#7  = #6#34;
   #0#16 = #6#4;
   #0#17 = #6#7;
   #0#18 = #6#8;
   #0#19 = #6#9;
   #0#20 = #6#10;
   #0#21 = #6#11;
   #0#22 = #6#12;
   #0#23 = #6#6;
   |PINTA #0#4;
   |PINTA #0#5;
   |PINTA #0#6;
   |PINTA #0#7;
|SINO;
   |MENAV "     No existe registro Rendimiento Irregulares";
   |ERROR; |ACABA;
|FINSI;
|CIERRA #6;
|FPRC;
