|FICHEROS;
    reic210a #0;
    realc210 #1;
    reall210 #5;
    redatcon #2;
    repant50 #3;
    rerenpre #4;
|FIN;

|VARIABLES;
    sw_imp   = 0;
    x        = 0;
    n        = "N";
    informe  = "";
    desde    = 0;
    hasta    = 0;
    contador = 0;
    cliente  = 0;
    linea    = "";
    resto    = 0;

    &pp      = 0;
    &impor   = 0;
    &cuota   = 0;
    &pagos   = 0;
    &base    = 0;
    &donat   = 0;
    &hojas   = 0;
    &diap    = "";
    &diav    = "";
    &diaf    = "";
    &diaa    = "";
    &mesp    = "";
    &mesv    = "";
    &mesf    = "";
    &mesa    = "";
    &mespl   = "";
    &mesvl   = "";
    &anyop   = "";
    &anyov   = "";
    &anyof   = "";
    &anyoa   = "";
    fechavo = @;
|FIN;

|PROCESO seleccion;
|SI #0#0 = "S";
    |PARA x = 3; |SI x [ 20; |HACIENDO x = x + 1;
          #0x = 0;
          |PINTA #0x;
    |SIGUE;
    |CAMPO_MODIFICA #0#01, 1, "S";
    |CAMPO_MODIFICA #0#02, 1, "S";
    |CAMPO_MODIFICA #0#03, 1, "N";
    |CAMPO_MODIFICA #0#04, 1, "N";
    |CAMPO_MODIFICA #0#05, 1, "N";
    |CAMPO_MODIFICA #0#06, 1, "N";
    |CAMPO_MODIFICA #0#07, 1, "N";
    |CAMPO_MODIFICA #0#08, 1, "N";
    |CAMPO_MODIFICA #0#09, 1, "N";
    |CAMPO_MODIFICA #0#10, 1, "N";
    |CAMPO_MODIFICA #0#11, 1, "N";
    |CAMPO_MODIFICA #0#12, 1, "N";
    |CAMPO_MODIFICA #0#13, 1, "N";
    |CAMPO_MODIFICA #0#14, 1, "N";
    |CAMPO_MODIFICA #0#15, 1, "N";
    |CAMPO_MODIFICA #0#16, 1, "N";
    |CAMPO_MODIFICA #0#17, 1, "N";
    |CAMPO_MODIFICA #0#18, 1, "N";
    |CAMPO_MODIFICA #0#19, 1, "N";
    |CAMPO_MODIFICA #0#20, 1, "N";
|SINO;
    #0#1 = 001; |PINTA #0#1;
    #0#2 = 999; |PINTA #0#2;
    |CAMPO_MODIFICA #0#01, 1, "N";
    |CAMPO_MODIFICA #0#02, 1, "N";
    |CAMPO_MODIFICA #0#03, 1, "S";
    |CAMPO_MODIFICA #0#04, 1, "S";
    |CAMPO_MODIFICA #0#05, 1, "S";
    |CAMPO_MODIFICA #0#06, 1, "S";
    |CAMPO_MODIFICA #0#07, 1, "S";
    |CAMPO_MODIFICA #0#08, 1, "S";
    |CAMPO_MODIFICA #0#09, 1, "S";
    |CAMPO_MODIFICA #0#10, 1, "S";
    |CAMPO_MODIFICA #0#11, 1, "S";
    |CAMPO_MODIFICA #0#12, 1, "S";
    |CAMPO_MODIFICA #0#13, 1, "S";
    |CAMPO_MODIFICA #0#14, 1, "S";
    |CAMPO_MODIFICA #0#15, 1, "S";
    |CAMPO_MODIFICA #0#16, 1, "S";
    |CAMPO_MODIFICA #0#17, 1, "S";
    |CAMPO_MODIFICA #0#18, 1, "S";
    |CAMPO_MODIFICA #0#19, 1, "S";
    |CAMPO_MODIFICA #0#20, 1, "S";
|FINSI;
|FPRC;

|PROCESO borradim;
contador = 0;
|PARA x = 0; |SI x [ 999; |HACIENDO x = x + 1;
     linea = "";
     |AL_BUF cliente, x, linea;
|SIGUE;
base  = 0;
cuota = 0;
pagos = 0;
donat = 0;
|FPRC;

|PROCESO cuantia;
contador = contador + 1;
linea = #5#1;
|AL_BUF cliente, contador, linea;
base  = base  + #5#17;
cuota = cuota + #5#20;
pagos = pagos + #5#19;
donat = donat + #5#18;
impor = cuota  - pagos - donat;
|FPRC;

|PROCESO imprelin;
hasta = pp * 6;
desde = hasta - 5;
|PARA x = desde; |SI x [ hasta; |HACIENDO x = x + 1;
    |SI x [ 24;
      |DEL_BUF cliente, x, linea;
      #5#0 = #1#0;
      #5#1 = linea;
      |LEE 040#5=;
      |SI FSalida = 0; |PRINT; |FINSI;
    |FINSI;
|SIGUE;
|FPRC;

|PROCESO miratab;
informe = "rei210a6";
|INFOR informe;
|SI FSalida = 0;
    |HAZ imprelin;
    |PIEINF;
    |FININF;
|FINSI;
|FPRC;

|PROCESO impreh1;  || Hoja 210
informe = "rei210a4";
|INFOR informe;
|SI FSalida = 0;
    #2#0 = #5#2;
    |LEE 040#2=;
    |SI FSalida ! 0; |DDEFECTO #2; |FINSI;

    #4#0 = #2#44;
    |LEE 040#4=;
    |SI FSalida ! 0; |DDEFECTO #4; |FINSI;

    |PRINT;
    |PIEINF;
    |FININF;
|FINSI;
|FPRC;

|PROCESO impreh2;  || Ingreso o devolucion
informe = "rei210a5";
|INFOR informe;
|SI FSalida = 0;
    |PRINT;
    |PIEINF;
    |FININF;
|FINSI;
|FPRC;

|PROCESO hojablan;
|SI #0#22 = 1;
    informe = "rehoblan";
    |INFOR informe;
    |SI FSalida = 0;
        |PRINT;
        |PIEINF;
        |FININF;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO impreh3;
hojas = contador / 6;
resto = contador $ 6;
|SI resto ! 0; hojas = (hojas + 0.5) ! 0; |FINSI;
|PARA pp = 1; |SI pp [ hojas; |HACIENDO pp = pp + 1;
      |HAZ miratab;
|SIGUE;
|SI hojas = 1; |HAZ hojablan; |HAZ hojablan; |HAZ hojablan; |FINSI;
|SI hojas = 2; |HAZ hojablan; |HAZ hojablan; |FINSI;
|SI hojas = 3; |HAZ hojablan; |FINSI;
|SI hojas > 1; |Y #0#22 = 2;
    |MENAV "    ATENCION!!! Hojas pendientes de impresion ...";
|FINSI;
|FPRC;

|PROCESO hojas;
sw_imp = 0;
|SI #0#0 = "N";
   |PARA x = 3; |SI x [ 20; |HACIENDO x = x + 1;
         |SI #0x = #1#0; sw_imp = 1; |FINSI;
   |SIGUE;
|SINO;
   sw_imp = 1;
|FINSI;

|SI sw_imp = 1;
   |HAZ borradim;
   |BUCLELIN 0cuantia#1;

   |HAZ impreh1;

   |ABRE #5;
   |HAZ impreh3;
   |CIERRA #5;

   |HAZ hojablan;
   |HAZ hojablan;
   |HAZ impreh2;

   #1#5 = #0#21;
   #1#6 = "S";
   |GRABA 020#1a;
   |LIBERA #1;
|FINSI;
|FPRC;

|DEFBUCLE impresio;
#1#1;
6;
#0#1, n;
#0#2, n;
be;
NULL,hojas;
|FIN;

|PROCESO impre; |TIPO 3;
|DIMENSIONA 1000, cliente, 0;
|HAZ fechapre;

|IMPRE 0;
|SI FSalida = 0;
   |ABRE #2;
   |ABRE #4;
   |BUCLE impresio;
   |CIERRA #2;
   |CIERRA #4;
   |FINIMP;
|SINO;
   |MENAV "      Proceso Interrumpido";
|FINSI;
|FINDIM cliente;
|FPRC;

|PROCESO fechapre;
diap  = #0#21 % 102;
anyop = #0#21 % -102;
mesp  = #0#21 % 402;
|SI mesp = "01"; mespl = "Enero     "; |FINSI;
|SI mesp = "02"; mespl = "Febrero   "; |FINSI;
|SI mesp = "03"; mespl = "Marzo     "; |FINSI;
|SI mesp = "04"; mespl = "Abril     "; |FINSI;
|SI mesp = "05"; mespl = "Mayo      "; |FINSI;
|SI mesp = "06"; mespl = "Junio     "; |FINSI;
|SI mesp = "07"; mespl = "Julio     "; |FINSI;
|SI mesp = "08"; mespl = "Agosto    "; |FINSI;
|SI mesp = "09"; mespl = "Septiembre"; |FINSI;
|SI mesp = "10"; mespl = "Octubre   "; |FINSI;
|SI mesp = "11"; mespl = "Noviembre "; |FINSI;
|SI mesp = "12"; mespl = "Diciembre "; |FINSI;
|FPRC;
