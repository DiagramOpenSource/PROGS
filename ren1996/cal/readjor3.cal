|FICHEROS
     reempedi #7;
     reemprco #8;
     rew00001 #99;
|FIN;

  |INCLUYE i_varadj;

|| **************************************************************************
||                           PROCESOS IMPRESION
|| **************************************************************************

|PROCESO impre_03;
  |SI swporta = 0; |HAZ cabecera; |FINSI;

  |IMPRIME varalf; linea = linea + 1; |HAZ linea;
|FPRC;

|| ********************** Empresariales *************************************

|PROCESO carga_03_20;
  conta = conta + 1;
  |SI conta > 2; swprof = 1; |FINSI;
  |SI sw_fich = 7;
      |SI conta > 2; swrrr1 = 1; |FINSI;
  |SINO;
      conta1 = conta1 + 1;
      |SI conta1 > 2; swrrr2 = 1; |FINSI;
  |FINSI;
|FPRC;

|PROCESO carga_03_6;
  conta  = conta  + 1;
  |SI sw_fich = 8; conta1 = conta1 + 1; |FINSI;
  |SI conta  < 2; |ACABA; |FINSI;

  |SI sw_fich = 7; |HAZ carga_03_7; |FINSI;
  |SI sw_fich = 8; |HAZ carga_03_8; |FINSI;
|FPRC;

|| ********************** Empresariales estimacion directa *****************

|PROCESO carga_03_7;
  varalf = "";                                                     |HAZ impre_03;
  varalf = "";                                                     |HAZ impre_03;
  |SI cabprof = 0;
      varalf = "E) RENDIMIENTOS DE ACTIVIDADES EMPRESARIALES";     |HAZ impre_03;
      varalf = "";                                                 |HAZ impre_03;
      cabprof = 1;
  |FINSI;
  |SI swrrr1 = 0;
      importe = conta;
      varalf = "Actividad ..: " + importe;                             |HAZ impre_03;
      varalf = "Titular ....: " + perce;                                |HAZ impre_03;
      varalf = "Descripcion : " + #7#15;                               |HAZ impre_03;
      varalf = "Modalidad ..: Empresarial directa";                    |HAZ impre_03;
      varalf = "";                                                     |HAZ impre_03;
      |ACABA;
  |FINSI;

  importe = conta;
  varalf = "Actividad ..: " + importe;                             |HAZ impre_03;
  varalf = "Titular ....: " + perce;                                |HAZ impre_03;
  varalf = "Descripcion : " + #7#15;                               |HAZ impre_03;
  varalf = "Modalidad ..: Empresarial directa";                    |HAZ impre_03;
  varalf = "";                                                     |HAZ impre_03;
  a = #7#17 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Ingresos ordinarios por ventas y prestaciones ...: " + importe;
                                                                   |HAZ impre_03;
  a = #7#18 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Autoconsumo .....................................: " + importe;
                                                                   |HAZ impre_03;
  a = (#7#19 + #7#20) % coefi; importe = a;                        |HAZ importe;
  varalf = "Subvenciones y otras transferencias .............: " + importe;
                                                                   |HAZ impre_03;
  a = (#7#21 + #7#22) % coefi; importe = a;                        |HAZ importe;
  varalf = "Otros ingresos ..................................: " + importe;
  a = #7#23 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Total ingreso computables .......................: " + importe;
                                                                   |HAZ impre_03;

  varalf = "";                                                     |HAZ impre_03;
  varalf = "Gastos deducibles";                                    |HAZ impre_03;
  a = #7#24 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Tributos y recargos no estatales ................: " + importe;
                                                                   |HAZ impre_03;
  a = #7#25 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Mercaderias, materias primas y otros aprovecham. : " + importe;
                                                                   |HAZ impre_03;
  a = #7#26 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Sueldos y salarios del personal .................: " + importe;
                                                                   |HAZ impre_03;
  a = #7#27 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Seguridad Social ................................: " + importe;
                                                                   |HAZ impre_03;
  a = #7#28 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Otros gastos de personal ........................: " + importe;
                                                                   |HAZ impre_03;
  a = #7#29 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Trabajos realizados por otras empresas ..........: " + importe;
                                                                   |HAZ impre_03;
  a = #7#31 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Intereses de prestamos y otros gastos financieros: " + importe;
                                                                   |HAZ impre_03;
  a = #7#30 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Alquileres de locales ...........................: " + importe;
                                                                   |HAZ impre_03;
  a = #7#33 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Conservacion y reparacion del activo material ...: " + importe;
                                                                   |HAZ impre_03;
  a = #7#35 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Primas de seguros ...............................: " + importe;
                                                                   |HAZ impre_03;
  a = #7#32 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Amortizaciones de elementos afectos .............: " + importe;
                                                                   |HAZ impre_03;

  a = #7#38 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Dotaciones del ejercicio a provisiones ..........: " + importe;
                                                                   |HAZ impre_03;
  a = #7#40 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Cuotas a Corporaciones, Camaras, A.empresariales : " + importe;
                                                                   |HAZ impre_03;
  a = (#7#41 + #7#34 + #7#36 + #7#37 + #7#39) % coefi; importe = a;|HAZ importe;
  varalf = "Otros gastos deducibles .........................: " + importe;
                                                                   |HAZ impre_03;
  a = #7#42 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Total gastos deducibles .........................: " + importe;
                                                                   |HAZ impre_03;
  a = #7#45 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Rendimiento Neto previo .........................: " + importe;
                                                                   |HAZ impre_03;

  varalf = "";                                                     |HAZ impre_03;
  varalf = "Aumentos y minoraciones";                              |HAZ impre_03;
  a = #7#46 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Incrementos de patrimonio .......................: " + importe;
                                                                   |HAZ impre_03;
  a = #7#47 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Disminuciones de patrimonio .....................: " + importe;
                                                                   |HAZ impre_03;
  a = #7#48 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Saldo Neto ......................................: " + importe;
                                                                   |HAZ impre_03;

  varalf = "";                                                     |HAZ impre_03;
  a = #7#49 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Rendimiento Neto ................................: " + importe;
  |HAZ impre_03;
|FPRC;

|PROCESO directa_03_1;
  sw_fich = 7;
  |SI #7#4 = "X"; |O #7#4 = "P"; |ACABA; |FINSI;
  |SI #7#5 = "N"; |ACABA; |FINSI;

  |SI #99#1 = "A"; perce = #7#3; |SINO; perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";
      |SI #7#2 = "V";
          coefi = #7#7 + #7#8 + #7#9 + #7#10 + #7#11 + #7#12;
          |HAZ carga_03_6;
          |ACABA;
      |FINSI;
      coefi = 100; |HAZ carga_03_6;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #7#2 = "G"; coefi = 50;   |HAZ carga_03_6; |ACABA; |FINSI;
     |SI #7#2 = "T"; coefi = 100;  |HAZ carga_03_6; |ACABA; |FINSI;
     |SI #7#2 = "V"; coefi = #7#7; |HAZ carga_03_6; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #7#2 = "G"; coefi = 50;    |HAZ carga_03_6; |ACABA; |FINSI;
     |SI #7#2 = "C"; coefi = 100;   |HAZ carga_03_6; |ACABA; |FINSI;
     |SI #7#2 = "V"; coefi = #7#8;  |HAZ carga_03_6; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "1";
     |SI #7#2 = "1"; coefi = 100;   |HAZ carga_03_6; |ACABA; |FINSI;
     |SI #7#2 = "V"; coefi = #7#9;  |HAZ carga_03_6; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "2";
     |SI #7#2 = "2"; coefi = 100;   |HAZ carga_03_6; |ACABA; |FINSI;
     |SI #7#2 = "V"; coefi = #7#10; |HAZ carga_03_6; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "3";
     |SI #7#2 = "3"; coefi = 100;   |HAZ carga_03_6; |ACABA; |FINSI;
     |SI #7#2 = "V"; coefi = #7#11; |HAZ carga_03_6; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "4";
     |SI #7#2 = "4"; coefi = 100;   |HAZ carga_03_6; |ACABA; |FINSI;
     |SI #7#2 = "V"; coefi = #7#12; |HAZ carga_03_6; |ACABA; |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO directa_03_2;
  |SI #7#4 = "X"; |O #7#4 = "P"; |ACABA; |FINSI;
  |SI #7#5 = "N"; |ACABA; |FINSI;

  |SI #99#1 = "A"; perce = #7#3; |SINO; perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";
      |SI #7#2 = "V";
          coefi = #7#7 + #7#8 + #7#9 + #7#10 + #7#11 + #7#12;
          |HAZ carga_03_20;
          |ACABA;
      |FINSI;
      coefi = 100; |HAZ carga_03_20;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #7#2 = "G"; coefi = 50;   |HAZ carga_03_20; |ACABA; |FINSI;
     |SI #7#2 = "T"; coefi = 100;  |HAZ carga_03_20; |ACABA; |FINSI;
     |SI #7#2 = "V"; coefi = #7#7; |HAZ carga_03_20; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #7#2 = "G"; coefi = 50;    |HAZ carga_03_20; |ACABA; |FINSI;
     |SI #7#2 = "C"; coefi = 100;   |HAZ carga_03_20; |ACABA; |FINSI;
     |SI #7#2 = "V"; coefi = #7#8;  |HAZ carga_03_20; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "1";
     |SI #7#2 = "1"; coefi = 100;   |HAZ carga_03_20; |ACABA; |FINSI;
     |SI #7#2 = "V"; coefi = #7#9;  |HAZ carga_03_20; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "2";
     |SI #7#2 = "2"; coefi = 100;   |HAZ carga_03_20; |ACABA; |FINSI;
     |SI #7#2 = "V"; coefi = #7#10; |HAZ carga_03_20; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "3";
     |SI #7#2 = "3"; coefi = 100;   |HAZ carga_03_20; |ACABA; |FINSI;
     |SI #7#2 = "V"; coefi = #7#11; |HAZ carga_03_20; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "4";
     |SI #7#2 = "4"; coefi = 100;   |HAZ carga_03_20; |ACABA; |FINSI;
     |SI #7#2 = "V"; coefi = #7#12; |HAZ carga_03_20; |ACABA; |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|DEFBUCLE reemped1;
  #7#1;
  ;
  #99#0, 01;
  #99#0, 99;
  e;
  NULL, directa_03_1;
|FIN;

|DEFBUCLE reemped2;
  #7#1;
  ;
  #99#0, 01;
  #99#0, 99;
  e;
  NULL, directa_03_2;
|FIN;

|| ********************** Empresariales Coeficientes ***********************

|PROCESO carga_03_8;
  varalf = "";                                                     |HAZ impre_03;
  varalf = "";                                                     |HAZ impre_03;

  |SI cabprof = 0;
      varalf = "D) RENDIMIENTOS DE ACTIVIDADES EMPRESARIALES";     |HAZ impre_03;
      varalf = "";                                                 |HAZ impre_03;
      cabprof = 1;
  |FINSI;

  |SI conta1 < 2; |O swrrr2 = 0;
      importe = conta1;
      varalf = "Actividad ..: " + importe;                             |HAZ impre_03;
      varalf = "Titular ....: " + perce;                                |HAZ impre_03;
      varalf = "Descripcion : " + #8#15;                               |HAZ impre_03;
      varalf = "Modalidad ..: Empresarial coeficientes";               |HAZ impre_03;
      |ACABA;
  |FINSI;

  importe = conta1;
  varalf = "Actividad ..: " + importe;                             |HAZ impre_03;
  varalf = "Titular ....: " + perce;                                |HAZ impre_03;
  varalf = "Descripcion : " + #8#15;                               |HAZ impre_03;
  varalf = "Modalidad ..: Empresarial coeficientes";               |HAZ impre_03;
  varalf = "";                                                     |HAZ impre_03;
  a = #8#17 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Ingresos integros ..............................: " + importe;
                                                                   |HAZ impre_03;
  varalf = "";                                                     |HAZ impre_03;
  varalf = "Gastos deducibles";                                    |HAZ impre_03;
  a = #8#18 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Coste de personal ..............................: " + importe;
                                                                   |HAZ impre_03;
  a = (#8#38 + #8#40 - #8#38) % coefi; importe = a;                |HAZ importe;
  varalf = "Compras consumidas de mercaderias y demas bienes: " + importe;
                                                                   |HAZ impre_03;
  a = #8#19 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Consumo de energia y agua ......................: " + importe;
                                                                   |HAZ impre_03;
  a = #8#20 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Alquileres de locales de la actividad ..........: " + importe;
                                                                   |HAZ impre_03;
  a = #8#21 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Gastos financieros y prima de seguros ..........: " + importe;
                                                                   |HAZ impre_03;
  a = #8#22 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Tributos no estatales ..........................: " + importe;
                                                                   |HAZ impre_03;
  a = #8#23 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Reparaciones y conservacion ....................: " + importe;
                                                                   |HAZ impre_03;
  a = #8#24 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Trabajos realizados por otras empresas .........: " + importe;
                                                                   |HAZ impre_03;
  b = #8#18 + #8#19 + #8#20 + #8#21 + #8#22 + #8#23 + #8#24 + #8#39;
  b = (b + #8#40 - #8#38) % coefi; importe = b;                    |HAZ importe;
  varalf = "Total gastos deducibles ........................: " + importe;
                                                                   |HAZ impre_03;
  a = (#8#17 % coefi) - b; importe = a;                            |HAZ importe;
  varalf = "Diferencia .....................................: " + importe;
                                                                   |HAZ impre_03;
  a = #8#25 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Coeficiente de gastos ..........................: " + importe;
                                                                   |HAZ impre_03;
  c = #8#42; importe = c;                                          |HAZ importe;
  varalf = "Rendimientos Neto previo .......................: " + importe;
                                                                   |HAZ impre_03;
  varalf = "";                                                     |HAZ impre_03;
  varalf = "Aumentos y minoraciones";                              |HAZ impre_03;
  a = #8#26 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Incrementos de patrimonio ......................: " + importe;
                                                                   |HAZ impre_03;
  a = #8#27 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Disminuciones de patrimonio ....................: " + importe;
                                                                   |HAZ impre_03;
  a = #8#28 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Otras disminuciones ............................: " + importe;
                                                                   |HAZ impre_03;
  a = (#8#26 - #8#27 - #8#28) % coefi; importe = a;                |HAZ importe;
  varalf = "Saldo Neto .....................................: " + importe;
                                                                   |HAZ impre_03;
  a = #8#29 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Gastos extraordinarios por ciecuntancias excep. : " + importe;

  varalf = "";                                                     |HAZ impre_03;
  a = #8#32 % coefi; importe = a;                                  |HAZ importe;
  varalf = "Rendimiento Neto ...............................: " + importe;
  |HAZ impre_03;
|FPRC;

|PROCESO emprcof1;
  sw_fich = 8;
  |SI #8#4 = "X"; |O #8#4 = "P"; |ACABA; |FINSI;
  |SI #8#5 = "N"; |ACABA; |FINSI;

  |SI #99#1 = "A"; perce = #8#3; |SINO; perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";
      |SI #8#2 = "V";
          coefi = #8#7 + #8#8 + #8#9 + #8#10 + #8#11 + #8#12;
          |HAZ carga_03_6;
          |ACABA;
      |FINSI;
      coefi = 100; |HAZ carga_03_6;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #8#2 = "G"; coefi = 50;   |HAZ carga_03_6; |ACABA; |FINSI;
     |SI #8#2 = "T"; coefi = 100;  |HAZ carga_03_6; |ACABA; |FINSI;
     |SI #8#2 = "V"; coefi = #8#7; |HAZ carga_03_6; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #8#2 = "G"; coefi = 50;    |HAZ carga_03_6; |ACABA; |FINSI;
     |SI #8#2 = "C"; coefi = 100;   |HAZ carga_03_6; |ACABA; |FINSI;
     |SI #8#2 = "V"; coefi = #8#8;  |HAZ carga_03_6; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "1";
     |SI #8#2 = "1"; coefi = 100;   |HAZ carga_03_6; |ACABA; |FINSI;
     |SI #8#2 = "V"; coefi = #8#9;  |HAZ carga_03_6; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "2";
     |SI #8#2 = "2"; coefi = 100;   |HAZ carga_03_6; |ACABA; |FINSI;
     |SI #8#2 = "V"; coefi = #8#10; |HAZ carga_03_6; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "3";
     |SI #8#2 = "3"; coefi = 100;   |HAZ carga_03_6; |ACABA; |FINSI;
     |SI #8#2 = "V"; coefi = #8#11; |HAZ carga_03_6; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "4";
     |SI #8#2 = "4"; coefi = 100;   |HAZ carga_03_6; |ACABA; |FINSI;
     |SI #8#2 = "V"; coefi = #8#12; |HAZ carga_03_6; |ACABA; |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO emprcof2;
  |SI #8#4 = "X"; |O #8#4 = "P"; |ACABA; |FINSI;
  |SI #8#5 = "N"; |ACABA; |FINSI;

  |SI #99#1 = "A"; perce = #8#3; |SINO; perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";
      |SI #8#2 = "V";
          coefi = #8#7 + #8#8 + #8#9 + #8#10 + #8#11 + #8#12;
          |HAZ carga_03_20;
          |ACABA;
      |FINSI;
      coefi = 100; |HAZ carga_03_20;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #8#2 = "G"; coefi = 50;   |HAZ carga_03_20; |ACABA; |FINSI;
     |SI #8#2 = "T"; coefi = 100;  |HAZ carga_03_20; |ACABA; |FINSI;
     |SI #8#2 = "V"; coefi = #8#7; |HAZ carga_03_20; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #8#2 = "G"; coefi = 50;    |HAZ carga_03_20; |ACABA; |FINSI;
     |SI #8#2 = "C"; coefi = 100;   |HAZ carga_03_20; |ACABA; |FINSI;
     |SI #8#2 = "V"; coefi = #8#8;  |HAZ carga_03_20; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "1";
     |SI #8#2 = "1"; coefi = 100;   |HAZ carga_03_20; |ACABA; |FINSI;
     |SI #8#2 = "V"; coefi = #8#9;  |HAZ carga_03_20; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "2";
     |SI #8#2 = "2"; coefi = 100;   |HAZ carga_03_20; |ACABA; |FINSI;
     |SI #8#2 = "V"; coefi = #8#10; |HAZ carga_03_20; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "3";
     |SI #8#2 = "3"; coefi = 100;   |HAZ carga_03_20; |ACABA; |FINSI;
     |SI #8#2 = "V"; coefi = #8#11; |HAZ carga_03_20; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "4";
     |SI #8#2 = "4"; coefi = 100;   |HAZ carga_03_20; |ACABA; |FINSI;
     |SI #8#2 = "V"; coefi = #8#12; |HAZ carga_03_20; |ACABA; |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|DEFBUCLE reemprc1;
  #8#1;
  ;
  #99#0, 01;
  #99#0, 99;
  e;
  NULL, emprcof1;
|FIN;

|DEFBUCLE reemprc2;
  #8#1;
  ;
  #99#0, 01;
  #99#0, 99;
  e;
  NULL, emprcof2;
|FIN;

|PROCESO readjor3;
  swrrr1 = 0;
  swrrr2 = 0;
  conta1 = 0; conta = 0; sw_fich = 7; |BUCLE reemped2;
                         sw_fich = 8; |BUCLE reemprc2;
  |SI swprof = 1;
      conta  = 0; |BUCLE reemped1;
      conta1 = 0; |BUCLE reemprc1;
  |FINSI;
  conta_d = conta;
  conta_c = conta1;
|FPRC;
