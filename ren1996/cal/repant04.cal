|FICHEROS;
   repant04 #0;
   reauxval #1;
|FIN;

|VARIABLES;
   valor        = 0;
   rete         = 0;
   fechacampo   = "";
   sw_cuadro    = 0;
   Ptas         = 0;

   &empresa     = 0;
   &modelito    = 0;
   &errorlin    = 0;
   &indivi      = "";

   &numerica1   = 0;  &numerica2  = 0;   &numerica3  = 0;
   &numerica4   = 0;  &numerica5  = 0;   &numerica6  = 0;
   &numerica7   = 0;  &numerica8  = 0;   &numerica9  = 0;
   &numerica10  = 0;  &numerica11 = 0;   &numerica12 = 0;
   &numerica13  = 0;  &numerica14 = 0;   &numerica15 = 0;
   &numerica16  = 0;  &numerica17 = 0;   &numerica18 = 0;
   &numerica19  = 0;  &numerica20 = 0;   &numerica21 = 0;
   &numerica22  = 0;  &numerica23  = 0;  &numerica24 = 0;
   &numerica25  = 0;

   &alfanumer1  = ""; &alfanumer2  = ""; &alfanumer3  = "";
   &alfanumer4  = ""; &alfanumer5  = ""; &alfanumer6  = "";
   &alfanumer7  = ""; &alfanumer8  = ""; &alfanumer9  = "";
   &alfanume10  = ""; &alfanume11  = "";
   &fechas1     = @;  &fechas2     = @;  &fechas3     = @;
|FIN;

|INCLUYE i_letran;
|INCLUYE i_fechat;

|PROGRAMA;
errorlin = 0;
|PINPA #0#0;
|HAZ cargavar;
|PINDA #0#0;
|SI modelito ! 4;
   |SI modelito = 1; |ENDATOS #1#0; |FINSI;
   |SI modelito = 2; |ENDATOS #2#0; |FINSI;
   |SI FSalida = 0;
       errorlin = 1;
       |HAZ descarga;
   |FINSI;
|SINO;
   errorlin = 1;
   |PAUSA;
|FINSI;
|FPRO;

|PROCESO cargavar;
#0#0  = alfanumer1;
#0#1  = alfanumer2;
#0#2  = alfanumer3;
#0#3  = numerica1;
#0#4  = numerica2;
#0#5  = numerica3;
#0#6  = numerica4;
#0#7  = numerica5;
#0#8  = numerica6;
#0#9  = numerica7;
#0#10 = alfanumer4;
#0#11 = alfanumer5;
#0#12 = alfanumer6;
#0#13 = numerica8;
#0#14 = numerica9;
#0#15 = fechas1;
#0#16 = numerica10;
#0#17 = numerica11;
#0#18 = numerica12;
#0#19 = numerica13;
#0#20 = fechas2;
#0#21 = fechas3;
#0#22 = numerica14;
#0#23 = numerica15;
#0#24 = numerica16;
#0#25 = numerica17;
#0#26 = alfanumer7;
#0#27 = alfanumer8;
#0#28 = numerica18;
#0#29 = numerica19;
#0#30 = numerica20;
#0#31 = numerica21;
#0#32 = numerica22;
#0#33 = numerica23;
#0#34 = alfanume10;
#0#35 = alfanume11;
#0#36 = numerica24;
#0#37 = numerica25;
|FPRC;

|PROCESO descarga;
alfanumer1 = #0#0;
alfanumer2 = #0#1;
alfanumer3 = #0#2;
numerica1  = #0#3;
numerica2  = #0#4;
numerica3  = #0#5;
numerica4  = #0#6;
numerica5  = #0#7;
numerica6  = #0#8;
numerica7  = #0#9;
alfanumer4 = #0#10;
alfanumer5 = #0#11;
alfanumer6 = #0#12;
numerica8  = #0#13;
numerica9  = #0#14;
fechas1    = #0#15;
numerica10 = #0#16;
numerica11 = #0#17;
numerica12 = #0#18;
numerica13 = #0#19;
fechas2    = #0#20;
fechas3    = #0#21;
numerica14 = #0#22;
numerica15 = #0#23;
numerica16 = #0#24;
numerica17 = #0#25;
alfanumer7 = #0#26;
alfanumer8 = #0#27;
numerica18 = #0#28;
numerica19 = #0#29;
numerica20 = #0#30;
numerica21 = #0#31;
numerica22 = #0#32;
numerica23 = #0#33;
alfanume10 = #0#34;
alfanume11 = #0#35;
numerica24 = #0#36;
numerica25 = #0#37;
|FPRC;

|PROCESO TipoIndi; |TIPO 7;
|SI indivi = "S"; |Y #0Campo ! "V";
    #0Campo = "T"; |PINTA #0Campo;
|FINSI;
|FPRC;

|PROCESO tipo; |TIPO 0;
|SI indivi = "S";
    |SI #0#0 ! "T"; |Y #0#0 ! "V";
        |MENAV "      La renta es individual";
        |ERROR; |ACABA;
    |FINSI;
|FINSI;

|CAMPO_MODIFICA #0#4,1,"N";
|CAMPO_MODIFICA #0#5,1,"N";
|CAMPO_MODIFICA #0#6,1,"N";
|CAMPO_MODIFICA #0#7,1,"N";
|CAMPO_MODIFICA #0#8,1,"N";
|CAMPO_MODIFICA #0#9,1,"N";

alfanumer9 = "";
|SI #0#0 = "T"; alfanumer9 = "TITULAR   "; |FINSI;
|SI #0#0 = "C"; alfanumer9 = "CONYUGE   "; |FINSI;
|SI #0#0 = "G"; alfanumer9 = "GANANCIAL "; |FINSI;
|SI #0#0 = "1"; alfanumer9 = "FAMILIARES"; |FINSI;
|SI #0#0 = "2"; alfanumer9 = "FAMILIARES"; |FINSI;
|SI #0#0 = "3"; alfanumer9 = "FAMILIARES"; |FINSI;
|SI #0#0 = "4"; alfanumer9 = "FAMILIARES"; |FINSI;
|SI #0#0 = "V";
    alfanumer9 = "VARIOS   ";
    |SI indivi = "N";
        |CAMPO_MODIFICA #0#4,1,"S";
        |CAMPO_MODIFICA #0#5,1,"S";
        |CAMPO_MODIFICA #0#6,1,"S";
        |CAMPO_MODIFICA #0#7,1,"S";
        |CAMPO_MODIFICA #0#8,1,"S";
        |CAMPO_MODIFICA #0#9,1,"S";
    |SINO;
        |CAMPO_MODIFICA #0#4,1,"S";
        #0#5 = 0;  |PINTA #0#5;
        #0#6 = 0;  |PINTA #0#6;
        #0#7 = 0;  |PINTA #0#7;
        #0#8 = 0;  |PINTA #0#8;
        #0#9 = 0;  |PINTA #0#9;
    |FINSI;
|SINO;
    #0#4 = 0;  |PINTA #0#4;
    #0#5 = 0;  |PINTA #0#5;
    #0#6 = 0;  |PINTA #0#6;
    #0#7 = 0;  |PINTA #0#7;
    #0#8 = 0;  |PINTA #0#8;
    #0#9 = 0;  |PINTA #0#9;
|FINSI;
|FPRC;

|PROCESO usufruc; |TIPO 0;
|SI #0#2 = "N";
    |CAMPO_MODIFICA #0#3,1,"S";
|SINO;
    |CAMPO_MODIFICA #0#3,1,"N";
|FINSI;
|FPRC;

|PROCESO valores; |TIPO 0;
  |ABRE #1;
  |SI #0#10 = "    ";
      rete = 25;
      |CIERRA #1;
      |ACABA;
  |FINSI;
  #1#0 = #0#10;
  |LEE 040#1=;
  |SI FSalida ! 0;
      rete = 25;
  |SINO;

    #0#27 = #1#3;
    #0#28 = #1#16;
    #0#29 = #1#15;
    #0#36 = #1#6;
    #0#16 = 0;
    Ptas  = 0;
    |SI #0#15 [ #1#11; Ptas = #1#7;  |FINSI;
    |SI #0#15 [ #1#12; Ptas = Ptas + #1#8;  |FINSI;
    |SI #0#15 [ #1#13; Ptas = Ptas + #1#9;  |FINSI;
    |SI #0#15 [ #1#14; Ptas = Ptas + #1#10; |FINSI;

    #0#16 = Ptas * #0#13;
    |SI #1#4 = 0;
        rete = 25;
    |SINO;
        rete = #1#4;
    |FINSI;
    #0#17 = #0#16 % rete;
    |PINTA #0#27;
    |PINTA #0#28;
    |PINTA #0#29;
    |PINTA #0#16;
    |PINTA #0#17;
    |PINTA #0#36;
  |FINSI;
  |CIERRA #1;
|FPRC;

|PROCESO valores1;
  #0#17 = #0#16 % rete;
  |PINTA #0#17;
|FPRC;

|PROCESO valores2;
    valor = #0#28;
    |SI #0#29 > valor; valor = #0#29; |FINSI;
    |SI #0#36 > valor; valor = #0#36; |FINSI;

    |SI #0#27 = "N";
        #0#33 = valor * #0#13; |PINTA #0#33;
    |SINO;
        #0#33 = #0#29 * #0#13; |PINTA #0#33;
    |FINSI;
|FPRC;

|PROCESO nopide; |TIPO 0;
|SI #0#26 = "O";
    |CAMPO_MODIFICA #0#22, 1, "S";
    |CAMPO_MODIFICA #0#23, 1, "S";
    |CAMPO_MODIFICA #0#31, 1, "N";
    |CAMPO_MODIFICA #0#32, 1, "N";
    #0#31 = 0; |PINTA #0#31;
    #0#32 = 0; |PINTA #0#32;
|SINO;
    |CAMPO_MODIFICA #0#22, 1, "N";
    |CAMPO_MODIFICA #0#23, 1, "N";
    |CAMPO_MODIFICA #0#31, 1, "S";
    |CAMPO_MODIFICA #0#32, 1, "S";
    #0#22 = 0; |PINTA #0#22;
    #0#23 = 0; |PINTA #0#23;
|FINSI;
|FPRC;

|PROCESO fecha92; |TIPO 0;
|SI #0Campo ! "01.01.1900";
    fechacampo = #0Campo % -102;
    |SI fechacampo ! "96";
        |MENAV "      El a¤o de la fecha debe ser igual al a¤o del ejercicio";
        |ERROR;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO cuadro; |TIPO 7;
  sw_cuadro = 1;
  |PUSHV 0501 2380;

  |CUADRO 1625 2379;
  |ATRI R;
  |PINTA 1726, " Sin Deduccion  -N-                                  ";
  |PINTA 1826, " Tipo General 40%  -1- Inc. B.Imp.  -4- Sin Inc. B.I.";
  |PINTA 1926, " Mutuas etc,  25%  -2- Inc. B.Imp.  -5- Sin Inc. B.I.";
  |PINTA 2026, " Otras Entid. 25%  -3- Inc. B.Imp.  -6- Sin Inc. B.I.";
  |PINTA 2126, " Deduccion al  5%  -A- Inc. B.Imp.  -B- Sin Inc. B.I.";
  |PINTA 2226, " Deduccion al 10%  -C- Inc. B.Imp.  -D- Sin Inc. B.I.";
  |ATRI 0;
|FPRC;

|PROCESO reponer; |TIPO 0;
  |SI sw_cuadro ! 0;
      sw_cuadro = 0;
      |POPV;
      |PINTA #0Campo;
  |FINSI;
  |SI #0#34 = "N";  #0#37 = 0;  |FINSI;
  |SI #0#34 = "1";  #0#37 = (#0#16 * 0.4) ! 0;   |FINSI;
  |SI #0#34 = "2";  #0#37 = (#0#16 * 0.25) ! 0;  |FINSI;
  |SI #0#34 = "3";  #0#37 = (#0#16 * 0.25) ! 0;  |FINSI;
  |SI #0#34 = "A";  #0#37 = (#0#16 * 0.05)  ! 0; |FINSI;
  |SI #0#34 = "C";  #0#37 = (#0#16 * 0.10) ! 0;  |FINSI;


  |SI #0#34 = "4";  #0#37 = 0;  |FINSI;
  |SI #0#34 = "5";  #0#37 = 0;  |FINSI;
  |SI #0#34 = "6";  #0#37 = 0;  |FINSI;
  |SI #0#34 = "B";  #0#37 = 0;  |FINSI;
  |SI #0#34 = "D";  #0#37 = 0;  |FINSI;

  |PINTA #0#37;
|FPRC;
