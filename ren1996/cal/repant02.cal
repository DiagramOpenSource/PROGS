|FICHEROS;
   repant02 #0;
   reparame #1;
|FIN;

|VARIABLES;
   &indivi      = "";
   &errorlin    = 1;
   topefech     = @;
   rendi        = 0;
   sw_entra     = 0;
   fecha        = @;
   fechav       = @;
   filtro       = 0;
   tecla        = "";
   avance       = "815";
   atras        = "814";
   dias         = 0;
   campito      = 0;
   valor        = 0;
   valor1       = 0;
   suma         = 0;
   suma1        = 0;
   fechad       = @;
   fechah       = @;
   intereses    = 0;
   feini        = @;
   fefin        = @;
   aaa          = 0;
   bbb          = 0;
   ccc          = 0;
   ddd          = 0;
   rafa         = 0;
   EjerCompra   = 0;
   MesCompra    = 0;

   &empresa     = 0;
   &modelito    = 0;
   &numerica1   = 0;  &numerica2  = 0;   &numerica3  = 0;
   &numerica4   = 0;  &numerica5  = 0;   &numerica6  = 0;
   &numerica7   = 0;  &numerica8  = 0;   &numerica9  = 0;
   &numerica10  = 0;  &numerica11 = 0;   &numerica12 = 0;
   &numerica13  = 0;  &numerica14 = 0;   &numerica15 = 0;
   &numerica16  = 0;  &numerica17 = 0;   &numerica18 = 0;
   &numerica19  = 0;  &numerica20 = 0;   &numerica21 = 0;
   &numerica22  = 0;  &numerica23 = 0;   &numerica24 = 0;
   &numerica25  = 0;  &numerica26 = 0;   &numerica27 = 0;
   &numerica28  = 0;  &numerica29 = 0;   &numerica30 = 0;
   &numerica31  = 0;  &numerica32 = 0;   &numerica33 = 0;
   &numerica34  = 0;  &numerica35  = 0;  &numerica36 = 0;
   &numerica37  = 0;  &numerica38  = 0;  &numerica39  = 0;
   &numerica40  = 0;  &numerica41  = 0;  &numerica42  = 0;

   &alfanumer1  = ""; &alfanumer2  = ""; &alfanumer3  = "";
   &alfanumer4  = ""; &alfanumer5  = ""; &alfanumer6  = "";
   &alfanumer7  = ""; &alfanumer8  = ""; &alfanumer9  = "";
   &alfanumer10 = ""; &alfanumer11 = ""; &alfanumer12 = "";
   &alfanumer13 = ""; &alfanumer14 = ""; &alfanumer15 = "";
   &alfanumer16 = ""; &alfanumer17 = ""; &alfanumer18 = "";

   &fechas1     = @;  &fechas2     = @;  &fechas3     = @;
   &fechas4     = @;  &fechas5     = @;
|FIN;

|PROGRAMA;
|ABRE #1;
|LEE 040#1p;
|SI FSalida ! 0; |DDEFECTO #1; |FINSI;
|CIERRA #1;

errorlin = 0;
|PINPA #0#0;
|HAZ cargavar;
|SI modelito ! 4;
   |PINDA #0#0;
   |SI modelito = 1; |ENDATOS #1#0;  |FINSI;
   |SI modelito = 2; |ENDATOS #2#0;  |FINSI;
   |SI FSalida = 0;
       errorlin = 1;
       |HAZ descarga;
   |FINSI;
|SINO;
   errorlin = 1; |HAZ pantalla;
|FINSI;
|FPRO;

|PROCESO cargavar;
#0#0  = alfanumer1;
#0#1  = alfanumer2;
#0#2  = alfanumer3;
#0#3  = alfanumer4;
#0#4  = numerica1;
#0#5  = numerica2;
#0#6  = numerica3;
#0#7  = numerica4;
#0#8  = numerica5;
#0#9  = numerica6;
#0#10 = numerica7;
#0#11 = alfanumer5;
#0#12 = numerica8;
#0#13 = alfanumer6;
#0#14 = numerica9;
#0#15 = numerica10;
#0#16 = fechas1;
#0#17 = numerica11;
#0#18 = numerica12;
#0#19 = alfanumer7;
#0#20 = alfanumer8;
#0#21 = numerica13;
#0#22 = numerica14;
#0#23 = numerica15;
#0#24 = numerica16;
#0#25 = numerica17;
#0#26 = numerica18;
#0#27 = numerica19;
#0#28 = numerica20;
#0#29 = alfanumer9;
#0#30 = numerica21;
#0#31 = numerica22;
#0#32 = fechas2;
#0#33 = numerica23;
#0#34 = numerica24;
#0#35 = numerica25;
#0#36 = fechas3;
#0#37 = fechas4;
#0#38 = fechas5;
#0#39 = numerica26;
#0#40 = numerica27;
#0#41 = numerica28;
#0#42 = alfanumer10;
#0#43 = alfanumer11;
#0#44 = alfanumer12;
#0#45 = alfanumer13;
#0#46 = numerica29;
#0#47 = numerica30;
#0#48 = numerica31;
#0#49 = numerica32;
#0#50 = numerica33;
#0#51 = numerica34;
#0#52 = numerica35;
#0#53 = alfanumer14;
#0#54 = numerica36;
#0#55 = numerica37;
#0#56 = numerica38;
#0#57 = numerica39;
#0#58 = numerica40;
#0#59 = numerica41;
#0#60 = alfanumer15;
#0#61 = alfanumer16;
|FPRC;

|PROCESO descarga;
alfanumer1 = #0#0;
alfanumer2 = #0#1;
alfanumer3 = #0#2;
alfanumer4 = #0#3;
numerica1  = #0#4;
numerica2  = #0#5;
numerica3  = #0#6;
numerica4  = #0#7;
numerica5  = #0#8;
numerica6  = #0#9;
numerica7  = #0#10;
alfanumer5 = #0#11;
numerica8  = #0#12;
alfanumer6 = #0#13;
numerica9  = #0#14;
numerica10 = #0#15;
fechas1    = #0#16;
numerica11 = #0#17;
numerica12 = #0#18;
alfanumer7 = #0#19;
alfanumer8 = #0#20;
numerica13 = #0#21;
numerica14 = #0#22;
numerica15 = #0#23;
numerica16 = #0#24;
numerica17 = #0#25;
numerica18 = #0#26;
numerica19 = #0#27;
numerica20 = #0#28;
alfanumer9 = #0#29;
numerica21 = #0#30;
numerica22 = #0#31;
fechas2    = #0#32;
numerica23 = #0#33;
numerica24 = #0#34;
numerica25 = #0#35;
fechas3    = #0#36;
fechas4    = #0#37;
fechas5    = #0#38;
numerica26 = #0#39;
numerica27 = #0#40;
numerica28 = #0#41;
alfanumer10= #0#42;
alfanumer11= #0#43;
alfanumer12= #0#44;
alfanumer13= #0#45;
numerica29 = #0#46;
numerica30 = #0#47;
numerica31 = #0#48;
numerica32 = #0#49;
numerica33 = #0#50;
numerica34 = #0#51;
numerica35 = #0#52;
alfanumer14= #0#53;
numerica36 = #0#54;
numerica37 = #0#55;
numerica38 = #0#56;
numerica39 = #0#57;
numerica40 = #0#58;
numerica41 = #0#59;
alfanumer15= #0#60;
alfanumer16= #0#61;
|FPRC;

|PROCESO pantalla;
avance = &255 + avance;
atras = &255 + atras;
|HAZ pantalla1;
|FPRC;

|PROCESO pantalla1;
|PINPA #0#0;
|PINDA #0#0;
|MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
|LEETECLA tecla;
|SI tecla = avance; |HAZ pantalla2; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla2;
|PINPA #1#0;
|PINDA #1#0;
|MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
|LEETECLA tecla;
|SI tecla = atras;  |HAZ pantalla1; |ACABA; |FINSI;
|SI tecla = avance; |HAZ pantalla3; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla3;
|PINPA #2#0;
|PINDA #2#0;
|MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
|LEETECLA tecla;
|SI tecla = atras;  |HAZ pantalla2; |ACABA; |FINSI;
|FPRC;

|PROCESO alquileres; |TIPO 0;
|SI #0#11 = "H"; |Y #0#19 = "S";
    |MENAV "     No se puede alquilar una vivienda habitual";
    |ERROR;
    |ACABA;
|FINSI;

|SI #0#19 = "S";
    |CAMPO_MODIFICA #0#20,1,"S";
    |CAMPO_MODIFICA #0#21,1,"S";
    |CAMPO_MODIFICA #0#22,1,"S";
    |CAMPO_MODIFICA #0#23,1,"S";
    |CAMPO_MODIFICA #0#24,1,"S";
    |CAMPO_MODIFICA #0#25,1,"S";
    |CAMPO_MODIFICA #0#26,1,"S";
    |CAMPO_MODIFICA #0#27,1,"S";
    |CAMPO_MODIFICA #0#28,1,"S";
|SINO;
    |CAMPO_MODIFICA #0#20,1,"N";
    |CAMPO_MODIFICA #0#21,1,"N";
    |CAMPO_MODIFICA #0#22,1,"N";
    |CAMPO_MODIFICA #0#23,1,"N";
    |CAMPO_MODIFICA #0#24,1,"N";
    |CAMPO_MODIFICA #0#25,1,"N";
    |CAMPO_MODIFICA #0#26,1,"N";
    |CAMPO_MODIFICA #0#27,1,"N";
    |CAMPO_MODIFICA #0#28,1,"N";
|FINSI;
|FPRC;

|PROCESO ventas; |TIPO 0;
|SI #0#29 = "S";
    |CAMPO_MODIFICA #0#32,1,"S";
    |CAMPO_MODIFICA #0#33,1,"S";
    |CAMPO_MODIFICA #0#34,1,"S";
    |CAMPO_MODIFICA #0#35,1,"S";
    |CAMPO_MODIFICA #0#53,1,"S";
    |CAMPO_MODIFICA #0#54,1,"S";
    |CAMPO_MODIFICA #0#56,1,"S";
|SINO;
    |CAMPO_MODIFICA #0#32,1,"N";
    |CAMPO_MODIFICA #0#33,1,"N";
    |CAMPO_MODIFICA #0#34,1,"N";
    |CAMPO_MODIFICA #0#35,1,"N";
    |CAMPO_MODIFICA #0#53,1,"N";
    |CAMPO_MODIFICA #0#54,1,"N";
    |CAMPO_MODIFICA #0#56,1,"N";
|FINSI;
|FPRC;

|PROCESO rustico; |TIPO 0;
|SI #0#2 = "R";
    |CAMPO_MODIFICA #0#9,1,"S";
    |CAMPO_MODIFICA #0#10,1,"S";
|SINO;
    |CAMPO_MODIFICA #0#9,1,"N";
    |CAMPO_MODIFICA #0#10,1,"N";
|FINSI;
|FPRC;

|PROCESO TipoIndi; |TIPO 7;
|SI indivi = "S"; |Y #0Campo ! "V";
    #0Campo = "T"; |PINTA #0Campo;
|FINSI;
|FPRC;

|PROCESO tipo; |TIPO 0;
|SI indivi = "S";
    |SI #0#0 ! "T"; |Y #0#0 ! "V";
       |MENAV "      La renta es individual";
       |ERROR; |ACABA;
    |FINSI;
|FINSI;

|CAMPO_MODIFICA #0#46,1,"N";
|CAMPO_MODIFICA #0#47,1,"N";
|CAMPO_MODIFICA #0#48,1,"N";
|CAMPO_MODIFICA #0#49,1,"N";
|CAMPO_MODIFICA #0#50,1,"N";
|CAMPO_MODIFICA #0#51,1,"N";

|SI #0#0 = "T"; #0#1 = "TITULAR   "; |FINSI;
|SI #0#0 = "C"; #0#1 = "CONYUGE   "; |FINSI;
|SI #0#0 = "G"; #0#1 = "GANANCIAL "; |FINSI;
|SI #0#0 = "1"; #0#1 = "FAMILIARES"; |FINSI;
|SI #0#0 = "2"; #0#1 = "FAMILIARES"; |FINSI;
|SI #0#0 = "3"; #0#1 = "FAMILIARES"; |FINSI;
|SI #0#0 = "4"; #0#1 = "FAMILIARES"; |FINSI;
|SI #0#0 = "V";
    #0#1 = "VARIOS   ";
    |SI indivi = "N";
        |CAMPO_MODIFICA #0#46,1,"S";
        |CAMPO_MODIFICA #0#47,1,"S";
        |CAMPO_MODIFICA #0#48,1,"S";
        |CAMPO_MODIFICA #0#49,1,"S";
        |CAMPO_MODIFICA #0#50,1,"S";
        |CAMPO_MODIFICA #0#51,1,"S";
    |SINO;
        |CAMPO_MODIFICA #0#46,1,"S";
        #0#47 = 0; |PINTA #0#47;
        #0#48 = 0; |PINTA #0#48;
        #0#49 = 0; |PINTA #0#49;
        #0#50 = 0; |PINTA #0#50;
        #0#51 = 0; |PINTA #0#51;
    |FINSI;
|SINO;
    #0#46 = 0; |PINTA #0#46;
    #0#47 = 0; |PINTA #0#47;
    #0#48 = 0; |PINTA #0#48;
    #0#49 = 0; |PINTA #0#49;
    #0#50 = 0; |PINTA #0#50;
    #0#51 = 0; |PINTA #0#51;
|FINSI;
|FPRC;

|PROCESO filtro; |TIPO 0;
|| |SI #0#11 = "H"; |Y #0#0 = "V";
||     filtro = #0#46 + #0#47 + #0#48 + #0#49 + #0#50 + #0#51;
||     |SI filtro ! 100;
||         |MENAV "     La suma de todos los porcentajes distino al 100% ";
||         |ERROR;
||         |ACABA;
||     |FINSI;
|| |FINSI;
|FPRC;

|PROCESO fechacomp;
|SI #0#11 ! "H"; |Y #0#12 ! 0;
    fecha = "01.01.1990";
    |SI #0#16 ] fecha;
        |MENAV "    La fecha es incorrecta si hay inversion";
        |ERROR;
        |ACABA;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO fechavent;
|SI #0#29 = "S";
    fechad = "01.01.1996";
    fechah = "31.12.1996";

    |SI #0#32 < fechad; |O #0#32 > fechah;
        |MENAV "     La Venta debe ser del a¤o 1996";
        |ERROR; |ACABA;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO usufruc; |TIPO 0;
|SI #0#13 = "N";
    |CAMPO_MODIFICA #0#14,1,"S";
|SINO;
    |CAMPO_MODIFICA #0#14,1,"N";
|FINSI;
|FPRC;

|PROCESO rendto;
  campito = Campo;
  valor = #0#6;
  ||SI #0#17 > valor; valor = #0#17; |FINSI;
  ||SI #0#15 > valor; valor = #0#15; |FINSI;

  |SI #0#11 ! "H"; |Y #0#19 = "N";
      intereses = 0;
  |SINO;
      intereses = #0#8;
  |FINSI;

  |SI #0#19 = "S";
      suma = #0#21 + #0#22 + #0#23;
      |SI intereses > suma; intereses = suma; |FINSI;
  |FINSI;

  sw_entra = 0;
  |SI #0#2  ! "R"; |Y #0#11 ! "S"; sw_entra = 1; |FINSI;
  |SI #0#19 = "S"; |Y #0#20 = "S"; sw_entra = 1; |FINSI;
  |SI #0#19 = "S"; |Y #0#20 = "N"; sw_entra = 0; |FINSI;
  |SI #0#2  = "R"; sw_entra = 0; |FINSI;
  |SI #0#11 = "S"; sw_entra = 0; |FINSI;

  rendi = 0;
  |SI sw_entra = 1;
      feini = "01.01.1996";
      fefin = "31.12.1996";
      |SI #0#16 > "01.01.1996";  feini = #0#16;  |FINSI;
      |SI #0#29 = "S";           fefin = #0#32;  |FINSI;

      dias = fefin - feini + 1;
      valor1 = valor * dias / 366;

      |SI #0#60 = "S";
          rendi = valor1 % 1.1;
      |SINO;
          rendi = valor1 % 2;
      |FINSI;

      rendi = rendi - #0#7 - intereses;
  |FINSI;


  |SI #0#19 = "S"; |Y #0#20 = "S";
      |SI #0#28 ] 0;
          suma  = #0#21 - #0#7 - intereses - #0#24 - #0#25 - #0#26 - #0#27 - #0#28;
      |SINO;
          suma  = #0#21 - #0#7 - intereses - #0#24 - #0#25 - #0#26 - #0#27 + #0#28;
      |FINSI;

      |SI suma > rendi; rendi = suma; |FINSI;
  |FINSI;

  |SI #0#19 = "S"; |Y #0#20 = "N";
      rendi = #0#21 + #0#22 + #0#23;
      |SI #0#28 ] 0;
          rendi = rendi - #0#7 - intereses - #0#24 - #0#25 - #0#26 - #0#27 - #0#28;
      |SINO;
          rendi = rendi - #0#7 - intereses - #0#24 - #0#25 - #0#26 - #0#27 + #0#28;
      |FINSI;
      ||SI rendi < 0; rendi = 0; |FINSI;
  |FINSI;

  #0#52 = rendi;  |PINTA #0#52;

  |SI #0#19 = "S";
      aaa = (#0#6  * .8 * 1.5) / 100;
      bbb = (#0#15 * .8 * 1.5) / 100;
      ccc = (#0#17 * .8 * 1.5) / 100;
      ddd = aaa;
      |SI ddd < bbb; ddd = bbb; |FINSI;
      |SI ddd < ccc; ddd = ccc; |FINSI;

      rafa = #0#15;
      |SI rafa < #0#6;  rafa = #0#6; |FINSI;
      |SI rafa < #0#17; rafa = #0#17; |FINSI;

      |SI #0#28 ] 0;
          #0#28 = (rafa - #0#31) % #0#30;
          |SI #0#28 > ddd; #0#28 = ddd; |FINSI;

          EjerCompra = (A\(#0#16 % -104));
          |SI EjerCompra = 1996;
              MesCompra = (A\(#0#16 % 402));
          |SINO;
              MesCompra = 0;
          |FINSI;
          MesCompra = (12 - MesCompra) / 12;

          #0#28 = #0#28 * MesCompra;

          |SI #0#28 < 0;  #0#28 = 0;  |FINSI;
          |PINTA #0#28;
      |FINSI;
  |SINO;
      |SI #0#28 > 0;
          #0#28 = 0;
          |PINTA #0#28;
      |FINSI;
  |FINSI;
|FPRC;

|PROCESO pintaren; |TIPO 14;
|PINTA 1068, #0#52;
|FPRC;

|PROCESO fechatop; |TIPO 0;
Campo = campito;
topefech = "31.12.1996";
|SI #0campito > topefech;
    |MENAV "      La fecha sobrepasa a la fecha del Ejercicio";
    |ERROR;
    |ACABA;
|FINSI;
|FPRC;

|PROCESO solar;
  |SI #0#2 = "R";
      |SI modelito = 1;
          #0#31 = 0; |PINTA #0#31;
          #0#30 = 0; |PINTA #0#30;
     |FINSI;
     |ACABA;
  |FINSI;

  valor = #0#15;
  |SI valor < #0#6;   valor = #0#6;   |FINSI;
  |SI valor < #0#17;  valor = #0#17;  |FINSI;

  |SI #0#31 ! 0;
      #0#31 = valor % #1#14;
      |PINTA #0#31;
      |ENCAMPO #31#0;
  |SINO;
      #0#31 = valor % #1#14;
      |PINTA #0#31;
  |FINSI;
|FPRC;

|PROCESO suma;
suma1 = #0#57 + #0#58 + #0#59;
|SI suma1 > #0#33;
    |MENAV "      La suma de imputaciones no debe ser superior al valor venta";
    |ERROR;
    |ACABA;
|FINSI;
|FPRC;
