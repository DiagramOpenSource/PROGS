|FICHEROS;
   rez00050 #0;
   redatcon #1;
   recapinm #3;
   reliquid #4;
   reacceso #5;
   reven210 #6;
   realc210 #7;
   reall210 #8;
   retabla3 #9;
   reremesa #10;
   rew00004 #99,MANTE;
|FIN;

|VARIABLES;
   FSestado    = 0;
   VarCampo    = 0;
   VarTraba    = 0;
   VarImpor    = 0;
   VarRenum    = 0;
   VarFraci    = 0;
   VarImpre    = 0;
   VarCuent    = 0;
   VarImpor1   = 0;
   VarImpor2   = 0;
   VarImpor3   = 0;
   VarImpor4   = 0;
   VarAlfa1    = "";
   VarAlfa2    = "";
   VarAlfa3    = "";
   VarAlfa4    = "";
   VarTipo     = 0;
   Refer       = 0;
   Fecha       = "";
   FechaInicio = @;
   SwHacer     = 0;
   Conta       = 0;
   Coefi       = 0;
   Cuota       = 0;
   Cuot2       = 0;
   Resto       = 0;
   Nume1       = 0;
   Base        = 0;
   Hasta       = 0;
   Porce       = 0;
   Casilla     = 0;
   Casilla1    = 0;
   Casilla2    = 0;
   Casilla3    = 0;
   Recuadro01  = 0;
   Recuadro02  = 0;
   Recuadro03  = 0;
   Recuadro04  = 0;
   Recuadro05  = 0;
   Recuadro06  = 0;
   Recuadro07  = 0;
|FIN;

|INCLUYE i_ficher;

|PROGRAMA;
FechaInicio  = ~;
Fecha        = "01.01." + (FechaInicio % -104);
FechaInicio  = Fecha;

|CLS;
|CABEZA "Adjudicacion de Remesas";

|PARA; |SI FSestado = 0; |HACIENDO;
       |PINPA #0#0;
       |PINDA #0#0;
       |ENDATOS #1#0;

       |C_M #0#0, 1, "N"; |C_M #0#2, 1, "N";

       FSestado = FSalida;
       |SI FSalida = 0; |HAZ CargaIndex; |FINSI;
|SIGUE;
|FPRO;

|PROCESO LeeLiqui;
|ABRE #1;
#1#0 = #0#3;
|LEE 040#1=;
|SI FSalida ! 0; |DDEFECTO #1; |FINSI;
|CIERRA #1;

|ABRE #4;
#4#0 = #1#0;
|LEE 040#4=;
|SI FSalida ! 0; |DDEFECTO #4; |FINSI;
|CIERRA #4;

|DDEFECTO #5;
|ABRE #5;
#5#0 = #1#0;
|LEE 0401#5=;
|SI FSalida ! 0; |DDEFECTO #5; |FINSI;
|CIERRA #5;
|FPRC;

|PROCESO MiraOtro;
#99#7 = "N";
#99#8 = "APUNTE YA REMESADO : " + #10#0 + " " + #10#1;
#99#9 = 1;
|FPRC;

|DEFBUCLE reremesa;
#10#1;
;
"    ", "01.01.1900", #0#3, #99#1, #99#4;
"zzzz", "31.12.2999", #0#3, #99#1, #99#4;
;
NULL, MiraOtro;
|FIN;

|PROCESO ImporRenta;
Refer = Refer + 1;
|DDEFECTO #99;

#99#0  = Refer;
#99#7  = "S";
#99#10 = #1VarCuent;

|SI VarCampo = 103;
    #99#1 = "C";
    #99#2 = "CONJUNTA";
    #99#3 = #1#1;
|FINSI;

|SI VarCampo = 104;
    #99#1 = "T";
    #99#2 = "TITULAR ";
    #99#3 = #1#1;
|FINSI;

|SI VarCampo = 105;
    #99#1 = "C";
    #99#2 = "CONYUGE ";
    #99#3 = #1#28;
|FINSI;

|SI VarCampo = 106;
    #99#1 = "1";
    #99#2 = "1§.FAMI.";
    VarTraba = #1#98 + 57; #99#3 = #1VarTraba;
|FINSI;

|SI VarCampo = 107;
    #99#1 = "2";
    #99#2 = "2§.FAMI.";
    VarTraba = #1#99 + 57; #99#3 = #1VarTraba;
|FINSI;

|SI VarCampo = 108;
    #99#1 = "3";
    #99#2 = "3§.FAMI.";
    VarTraba = #1#100 + 57; #99#3 = #1VarTraba;
|FINSI;

|SI VarCampo = 109;
    #99#1 = "4";
    #99#2 = "4§.FAMI.";
    VarTraba = #1#101 + 57; #99#3 = #1VarTraba;
|FINSI;

|SI Coefi = 100;
    #99#4    = 1;
    |SI #4VarImpor > 0;
        #99#5   = "RENTA POSITIVA (NO FRACCIONA EL PAGO) ";
        #99#6   = #4VarImpor;
    |FINSI;

    |SI #4VarImpor < 0;
        #99#7 = "N";
        |SI #4VarRenum ! "S";
            #99#5 = "RENTA NEGATIVA : NO RENUNCIA ";
        |SINO;
            #99#5 = "RENTA NEGATIVA : SI RENUNCIA";
        |FINSI;
        #99#6   = #4VarImpor;
    |FINSI;
|FINSI;

|SI Coefi = 60;
    #99#4 = 1;
    |SI #4VarFraci = "S";
        #99#5 = "RENTA POSITIVA (1§ PAGO, SIN DOMICILIAR)";
    |SINO;
        #99#5 = "RENTA POSITIVA (1§ PAGO, DOMICILIADO)";
    |FINSI;

    #99#6 = #4VarImpor % Coefi;
|FINSI;

|SI Coefi = 40;
    #99#4 = 2;
    |SI #4VarFraci = "S";
        #99#5 = "RENTA POSITIVA (2§ PAGO, SIN DOMICILIAR)";
    |SINO;
        #99#5 = "RENTA POSITIVA (2§ PAGO, DOMICILIADO)";
    |FINSI;
    #99#6 = #4VarImpor % Coefi;
|FINSI;

|BUCLE reremesa;

|SI #1VarImpre ! "S"; |Y #99#9 = 0;
    #99#7 = "N";
    #99#8 = "RENTA NO IMPRESA";
    #99#9 = 1;
|FINSI;

|GRABA 040#99n;
|FPRC;

|PROCESO ImporPatri;
Refer = Refer + 1;
|DDEFECTO #99;

#99#0 = Refer;
#99#7 = "S";

|SI VarCampo = 140;
    #99#1 = "T";
    #99#2 = "TITULAR ";
    #99#3 = #1#1;
|FINSI;

|SI VarCampo = 141;
    #99#1 = "C";
    #99#2 = "CONYUGE ";
    #99#3 = #1#28;
|FINSI;

|SI VarCampo = 194;
    #99#1 = "1";
    #99#2 = "1§.FAMI.";
    VarTraba = #1#98 + 57; #99#3 = #1VarTraba;
|FINSI;

|SI VarCampo = 195;
    #99#1 = "2";
    #99#2 = "2§.FAMI.";
    VarTraba = #1#99 + 57; #99#3 = #1VarTraba;
|FINSI;

|SI VarCampo = 196;
    #99#1 = "3";
    #99#2 = "3§.FAMI.";
    VarTraba = #1#100 + 57; #99#3 = #1VarTraba;
|FINSI;

|SI VarCampo = 197;
    #99#1 = "4";
    #99#2 = "4§.FAMI.";
    VarTraba = #1#101 + 57; #99#3 = #1VarTraba;
|FINSI;

#99#4 = 3;
#99#5 = "PATRIMONIO ";
#99#6   = #4VarImpor;

|BUCLE reremesa;

|SI #1VarImpre ! "S"; |Y #99#9 = 0;
    #99#7 = "N";
    #99#8 = "PATRIMONIO NO IMPRESO ";
    #99#9 = 1;
|FINSI;

|GRABA 040#99n;
|FPRC;

|PROCESO CargaSpanis;
|SI #1#103 ! " ";
    VarCampo  = 103;
    VarImpor  = 8;
    VarImpre  = 124;
    VarFraci  = 15;
    VarRenum  = 22;
    VarCuent  = 174;
    |SI #4VarFraci ! "N"; |Y #4VarImpor > 0;
        Coefi = 60;  |HAZ ImporRenta;
        Coefi = 40;  |HAZ ImporRenta;
    |SINO;
        Coefi = 100; |HAZ ImporRenta;
    |FINSI;
|FINSI;

|SI #1#104 ! " ";
    VarCampo  = 104;
    VarImpor  = 9;
    VarImpre  = 125;
    VarFraci  = 16;
    VarRenum  = 23;
    VarCuent  = 175;
    |SI #4VarFraci ! "N"; |Y #4VarImpor > 0;
        Coefi = 60;  |HAZ ImporRenta;
        Coefi = 40;  |HAZ ImporRenta;
    |SINO;
        Coefi = 100; |HAZ ImporRenta;
    |FINSI;
|FINSI;

|SI #1#105 ! " ";
    VarCampo  = 105;
    VarImpor  = 10;
    VarImpre  = 126;
    VarFraci  = 17;
    VarRenum  = 24;
    VarCuent  = 176;
    |SI #4VarFraci ! "N"; |Y #4VarImpor > 0;
        Coefi = 60;  |HAZ ImporRenta;
        Coefi = 40;  |HAZ ImporRenta;
    |SINO;
        Coefi = 100; |HAZ ImporRenta;
    |FINSI;
|FINSI;

|SI #1#106 ! " ";
    VarCampo  = 106;
    VarImpor  = 11;
    VarImpre  = 127;
    VarFraci  = 18;
    VarRenum  = 25;
    VarCuent  = 177;
    |SI #4VarFraci ! "N"; |Y #4VarImpor > 0;
        Coefi = 60;  |HAZ ImporRenta;
        Coefi = 40;  |HAZ ImporRenta;
    |SINO;
        Coefi = 100; |HAZ ImporRenta;
    |FINSI;
|FINSI;

|SI #1#107 ! " ";
    VarCampo  = 107;
    VarImpor  = 12;
    VarImpre  = 128;
    VarFraci  = 19;
    VarRenum  = 26;
    VarCuent  = 178;
    |SI #4VarFraci ! "N"; |Y #4VarImpor > 0;
        Coefi = 60;  |HAZ ImporRenta;
        Coefi = 40;  |HAZ ImporRenta;
    |SINO;
        Coefi = 100; |HAZ ImporRenta;
    |FINSI;
|FINSI;

|SI #1#108 ! " ";
    VarCampo  = 108;
    VarImpor  = 13;
    VarImpre  = 129;
    VarFraci  = 20;
    VarRenum  = 27;
    VarCuent  = 179;
    |SI #4VarFraci ! "N"; |Y #4VarImpor > 0;
        Coefi = 60;  |HAZ ImporRenta;
        Coefi = 40;  |HAZ ImporRenta;
    |SINO;
        Coefi = 100; |HAZ ImporRenta;
    |FINSI;
|FINSI;

|SI #1#109 ! " ";
    VarCampo  = 109;
    VarImpor  = 14;
    VarImpre  = 130;
    VarFraci  = 21;
    VarRenum  = 28;
    VarCuent  = 180;
    |SI #4VarFraci ! "N"; |Y #4VarImpor > 0;
        Coefi = 60;  |HAZ ImporRenta;
        Coefi = 40;  |HAZ ImporRenta;
    |SINO;
        Coefi = 100; |HAZ ImporRenta;
    |FINSI;
|FINSI;

|SI #1#140 = "S";
    VarCampo  = 140;
    VarImpre  = 138;
    VarImpor  = 35;
    VarCuent  = 175;
    |HAZ ImporPatri;
|FINSI;

|SI #1#141 = "S";
    VarCampo  = 141;
    VarImpre  = 139;
    VarImpor  = 36;
    VarCuent  = 176;
    |HAZ ImporPatri;
|FINSI;

|SI #1#194 = "S";
    VarCampo  = 194;
    VarImpre  = 198;
    VarImpor  = 37;
    VarCuent  = 177;
    |HAZ ImporPatri;
|FINSI;

|SI #1#195 = "S";
    VarCampo  = 195;
    VarImpre  = 199;
    VarImpor  = 38;
    VarCuent  = 178;
    |HAZ ImporPatri;
|FINSI;

|SI #1#196 = "S";
    VarCampo  = 196;
    VarImpre  = 200;
    VarImpor  = 39;
    VarCuent  = 179;
    |HAZ ImporPatri;
|FINSI;

|SI #1#197 = "S";
    VarCampo  = 197;
    VarImpre  = 201;
    VarImpor  = 40;
    VarCuent  = 180;
    |HAZ ImporPatri;
|FINSI;
|FPRC;

|PROCESO ImporExtra;
Refer = Refer + 1;

#99#0 = Refer;
#99#1 = VarAlfa1;
#99#2 = VarAlfa2;
#99#3 = VarAlfa4;
#99#4 = VarTipo;
#99#5 = VarAlfa3;
#99#6 = VarImpor;
#99#7 = "S";

|BUCLE reremesa;

|SI VarImpre ! "S"; |Y #99#9 = 0;
    #99#7 = "N";
    #99#8 = "RENTA NO IMPRESA";
    #99#9 = 1;
|FINSI;

#99#10 = VarCuent;
|GRABA 040#99n;
|FPRC;

|PROCESO Ventas;
|ABRE #6;
#6#0 = #1#0;
|LEE 040#6=;
|SI FSalida ! 0; |CIERRA #6; |ACABA; |FINSI;
|CIERRA #6;

SwHacer = 1;

VarAlfa1 = "T";
VarAlfa2 = "TITULAR";
VarAlfa4 = #1#1;
VarTipo  = 1;
|SI #6#54 > 0;
    VarAlfa3 = "RENTA POSITIVA";
|SINO;
    VarAlfa3 = "RENTA NEGATIVA";
|FINSI;
VarImpor = #6#54;
VarImpre = #6#56;
VarCuent = #1#174;

|HAZ ImporExtra;
|FPRC;

|PROCESO MiraCab;
#7#0 = #8#0;
|LEE 040#7=;
|SI FSalida ! 0; |DDEFECTO #7; |FINSI;

SwHacer = 1;

VarAlfa1 = "T";
VarAlfa2 = "TITULAR";
VarTipo  = 1;
VarAlfa4 = #1#1;
|SI #8#20 > 0;
    VarAlfa3 = "RENTA POSITIVA";
|SINO;
    VarAlfa3 = "RENTA NEGATIVA";
|FINSI;
VarImpor = #8#20;
VarImpre = "S";
VarCuent = #1#174;

|HAZ ImporExtra;
|FPRC;

|DEFBUCLE reall210;
#8#1;
2;
000, 000, #1#0;
999, 999, #1#0;
e;
NULL, MiraCab;
|FIN;

|PROCESO Alquiler;
|ABRE #7;
|BUCLE reall210;
|CIERRA #7;
|FPRC;

|PROCESO El210;
|SI #3#2 = "G";
    Conta = Conta + 1;
    |SI Conta > 6; |ACABA; |FINSI;
    VarImpor1 = VarImpor1 + ((#3#47 % 50) % 25);

    Conta = Conta + 1;
    |SI Conta > 6; |ACABA; |FINSI;
    VarImpor2 = VarImpor2 + ((#3#47 % 50) % 25);
|SINO;
    Conta = Conta + 1;
    |SI Conta > 6; |ACABA; |FINSI;
    VarImpor1 = VarImpor1 + (#3#47 % 25);
|FINSI;
|FPRC;

|DEFBUCLE recapinm1;
#3#1;
13;
#1#0, 00, "H";
#1#0, 99, "H";
e;
NULL, El210;
|FIN;

|PROCESO Modelo210;
Conta     = 0;
VarImpor1 = 0;
VarImpor2 = 0;
|BUCLE recapinm1;

|SI VarImpor1 ! 0;
    VarAlfa1 = "T";
    VarAlfa2 = "TITULAR";
    VarTipo  = 1;
    VarImpor = VarImpor1;
    VarAlfa4 = #1#1;
    |SI VarImpor > 0;
        VarAlfa3 = "RENTA POSITIVA";
    |SINO;
        VarAlfa3 = "RENTA NEGATIVA";
    |FINSI;
    VarImpre = "S";
    VarCuent = #1#174;
    |HAZ ImporExtra;
|FINSI;

|SI VarImpor2 ! 0;
    VarAlfa1 = "C";
    VarAlfa2 = "CONYUGE";
    VarTipo  = 1;
    VarAlfa4 = #1#28;
    VarImpor = VarImpor2;
    |SI VarImpor > 0;
        VarAlfa3 = "RENTA POSITIVA";
    |SINO;
        VarAlfa3 = "RENTA NEGATIVA";
    |FINSI;
    VarImpre = "S";
    VarCuent = #1#175;
    |HAZ ImporExtra;
|FINSI;
|FPRC;

|PROCESO Limpia;
|LEE 040#3=;
|FPRC;

|PROCESO Calcula214;;
#3#8  = #3#8  % Coefi;
#3#9  = #3#9  % Coefi;
#3#10 = #3#10 % Coefi;
#3#14 = #3#14 % Coefi;
#3#17 = #3#17 % Coefi;
#3#18 = #3#18 % Coefi;
#3#19 = #3#19 % Coefi;
#3#20 = #3#20 % Coefi;

Recuadro01 = #3#8;
|SI Recuadro01 < #3#17; Recuadro01 = #3#17; |FINSI;
|SI Recuadro01 < #3#19; Recuadro01 = #3#19; |FINSI;

|SI Recuadro01 = 0; |ACABA; |FINSI;

|ABRE #9;
|LEE 040#9p;
|SI FSalida ! 0; |DDEFECTO #9; |FINSI;
|CIERRA #9;

Recuadro02 = #3#9 + #3#10 + #3#14 + #3#20;     || deudas [02]
Recuadro03 = Recuadro01 - Recuadro02;          || base liquidable

|PARA Casilla1 = 8; |SI Casilla1 ] 1; |HACIENDO Casilla1 = Casilla1 - 1;
      Casilla2 = Casilla1 + 8;
      Casilla3 = Casilla1 + 16;
      |SI Recuadro03 > #9Casilla1;
          Hasta = #9Casilla1;

          Cuota = #9Casilla2;
          Porce = #9Casilla3;
          Resto = Recuadro03 - Hasta;
          Cuot2 = (Resto % Porce) ! 0;
          Recuadro04 = Cuota + Cuot2;       || Cuota integra
          |SAL;
      |FINSI;
|SIGUE;

|SI FechaInicio < #3#18;
     Nume1 = 366 - (#3#18 - FechaInicio);
     Base = (Nume1 * #3#8) / 366;
|SINO;
     Base = #3#8;
|FINSI;

|SI #3#71 = "N";
    Recuadro05 = Base % 2;
|SINO;
    Recuadro05 = Base % 1.1;
|FINSI;

Recuadro06 = Recuadro05 % 25;
Recuadro07 = Recuadro04 + Recuadro06;
|FPRC;

|PROCESO GrabaLin214;
|SI Recuadro06 ! 0;
    VarTipo  = 1;
    VarImpor = Recuadro06;
    |SI VarImpor > 0;
        VarAlfa3 = "RENTA POSITIVA";
    |SINO;
        VarAlfa3 = "RENTA NEGATIVA";
    |FINSI;
    VarImpre = "S";
    |HAZ ImporExtra;
|FINSI;

|SI Recuadro04 > 0;
    VarTipo  = 3;
    VarImpor = Recuadro04;
    VarAlfa3 = "PATRIMONIO";
    VarImpre = "S";
    |HAZ ImporExtra;
|FINSI;
|FPRC;

|PROCESO Selec214;
|SI #3#2 = "T";
    |HAZ Limpia;
    Coefi    = 100;  |HAZ Calcula214;
    VarAlfa1 = "T";
    VarAlfa2 = "TITULAR";
    VarAlfa4 = #1#1;
    VarCuent = #1#174;
    |HAZ GrabaLin214;
    |ACABA;
|FINSI;

|SI #3#2 = "C";
    |HAZ Limpia;
    Coefi    = 100;  |HAZ Calcula214;
    VarAlfa1 = "C";
    VarAlfa2 = "CONYUGE";
    VarAlfa4 = #1#28;
    VarCuent = #1#174;
    |HAZ GrabaLin214;
    |ACABA;
|FINSI;

|SI #3#2 = "G";
    |HAZ Limpia;
    Coefi    = 50;  |HAZ Calcula214;
    VarAlfa1 = "T";
    VarAlfa2 = "TITULAR";
    VarAlfa4 = #1#1;
    VarCuent = #1#174;
    |HAZ GrabaLin214;

    |HAZ Limpia;
    Coefi    = 50;  |HAZ Calcula214;
    VarAlfa1 = "C";
    VarAlfa2 = "CONYUGE";
    VarAlfa4 = #1#28;
    VarCuent = #1#174;
    |HAZ GrabaLin214;
    |ACABA;
|FINSI;

|SI #3#2 = "1";
    |HAZ Limpia;
    Coefi    = 100;   |HAZ Calcula214;
    VarAlfa1 = "1";
    VarAlfa2 = "1§ FAMILIAR";
    Casilla  = 57 + #1#98; VarAlfa4 = #1Casilla;
    VarCuent = #1#176;
    |HAZ GrabaLin214;
    |ACABA;
|FINSI;

|SI #3#2 = "2";
    |HAZ Limpia;
    Coefi    = 100;  |HAZ Calcula214;
    VarAlfa1 = "2";
    VarAlfa2 = "2§ FAMILIAR";
    Casilla  = 57 + #1#99; VarAlfa4 = #1Casilla;
    VarCuent = #1#177;
    |HAZ GrabaLin214;
    |ACABA;
|FINSI;

|SI #3#2 = "3";
    |HAZ Limpia;
    Coefi    = 100;   |HAZ Calcula214;
    VarAlfa1 = "3";
    VarAlfa2 = "3§ FAMILIAR";
    Casilla  = 57 + #1#100; VarAlfa4 = #1Casilla;
    VarCuent = #1#178;
    |HAZ GrabaLin214;
    |ACABA;
|FINSI;

|SI #3#2 = "4";
    |HAZ Limpia;
    Coefi    = 100;  |HAZ Calcula214;
    VarAlfa1 = "4";
    VarAlfa2 = "4§ FAMILIAR";
    Casilla  = 57 + #1#101; VarAlfa4 = #1Casilla;
    VarCuent = #1#179;
    |HAZ GrabaLin214;
    |ACABA;
|FINSI;

|SI #3#2 = "V";
    |SI #3#49 ! 0;
        |HAZ Limpia;
        Coefi    = #3#49;  |HAZ Calcula214;
        VarAlfa1 = "T";
        VarAlfa2 = "TITULAR";
        VarAlfa4 = #1#1;
        VarCuent = #1#174;
        |HAZ GrabaLin214;
    |FINSI;

    |SI #3#50 ! 0;
        |HAZ Limpia;
        Coefi    = #3#50;  |HAZ Calcula214;
        VarAlfa1 = "C";
        VarAlfa2 = "CONYUGE";
        VarAlfa4 = #1#28;
        VarCuent = #1#174;
        |HAZ GrabaLin214;
    |FINSI;

    |SI #3#51 ! 0;
        |HAZ Limpia;
        Coefi    = #3#51;  |HAZ Calcula214;
        VarAlfa1 = "1";
        VarAlfa2 = "1§ FAMILIAR";
        Casilla  = 57 + #1#98; VarAlfa4 = #1Casilla;
        VarCuent = #1#176;
        |HAZ GrabaLin214;
    |FINSI;

    |SI #3#52 ! 0;
        |HAZ Limpia;
        Coefi    = #3#52;  |HAZ Calcula214;
        VarAlfa1 = "2";
        VarAlfa2 = "2§ FAMILIAR";
        Casilla  = 57 + #1#99; VarAlfa4 = #1Casilla;
        VarCuent = #1#177;
        |HAZ GrabaLin214;
    |FINSI;

    |SI #3#53 ! 0;
        |HAZ Limpia;
        Coefi    = #3#53;  |HAZ Calcula214;
        VarAlfa1 = "3";
        VarAlfa2 = "3§ FAMILIAR";
        Casilla  = 57 + #1#100; VarAlfa4 = #1Casilla;
        VarCuent = #1#178;
        |HAZ GrabaLin214;
    |FINSI;

    |SI #3#54 ! 0;
        |HAZ Limpia;
        Coefi    = #3#54;  |HAZ Calcula214;
        VarAlfa1 = "4";
        VarAlfa2 = "4§ FAMILIAR";
        Casilla  = 57 + #1#101; VarAlfa4 = #1Casilla;
        VarCuent = #1#179;
        |HAZ GrabaLin214;
    |FINSI;
|FINSI;

|ERROR10;
|FPRC;

|DEFBUCLE recapinm2;
#3#1;
13;
#1#0, 01, "H";
#1#0, 99, "H";
e;
NULL, Selec214;
|FIN;

|PROCESO Modelo214;
Conta = 0;
|BUCLE recapinm2;
|FPRC;

|PROCESO CargaGuiris;
Recuadro01 = 0;  Recuadro02 = 0;  Recuadro03 = 0;
Recuadro04 = 0;  Recuadro05 = 0;  Recuadro06 = 0;
Recuadro07 = 0;
SwHacer    = 0;

|SI #1#138 = "S";
    |HAZ Ventas;
    |HAZ Alquiler;
    |SI SwHacer = 0; |HAZ Modelo210; |FINSI;

    |SI #4#35 > 0;
        VarAlfa1 = "T";
        VarAlfa2 = "TITULAR";
        VarTipo  = 3;
        VarImpor = #4#35;
        VarAlfa4 = #1#1;
        VarAlfa3 = "PATRIMONIO";
        VarImpre = "S";
        VarCuent = #1#174;
        |HAZ ImporExtra;
    |FINSI;

    |SI #4#36 > 0;
        VarAlfa1 = "C";
        VarAlfa2 = "CONYUGE";
        VarTipo  = 3;
        VarImpor = #4#36;
        VarAlfa4 = #1#28;
        VarAlfa3 = "PATRIMONIO";
        VarImpre = "S";
        VarCuent = #1#175;
        |HAZ ImporExtra;
    |FINSI;
|SINO;
    |HAZ Ventas;
    |HAZ Alquiler;
    |SI SwHacer = 0; |HAZ Modelo214; |FINSI;
|FINSI;
|FPRC;

|RUTINA Inferior;
#99#0 = 1;
|FRUT;

|RUTINA Superior;
#99#0 = Refer;
|FRUT;

|PROCESO GrabaRemesa;
#10#0  = #0#0;
#10#1  = #0#2;
#10#2  = #0#3;
#10#3  = #99#1;
#10#4  = #99#4;
#10#5  = #99#2;
#10#6  = #99#3;
#10#7  = #99#10;
#10#8  = #0#1;
#10#9  = #99#6;
#10#10 = #99#5;
|GRABA 140#10n
|LIBERA #10;
|FPRC;

|DEFBUCLE rew00004;
#99#1;
7;
    1, "S";
Refer, "S";
;
NULL, GrabaRemesa;
|FIN;

|PROCESO CargaIndex;
comienza = "50";
|HAZ fichero;
|NOME_DAT #99 fichero;
|ABRE #99; |CIERRA #99; |DELINDEX #99;

|HAZ LeeLiqui;

|ABRE #99;
Refer = 0;
|SI #1#4 = "S"; |HAZ CargaSpanis; |FINSI;
|SI #1#4 = "N"; |HAZ CargaGuiris; |FINSI;
|CIERRA #99;

|SI Refer = 0; |DELINDEX #99; |ACABA; |FINSI;

|ENTLINEAL #1#99, 1, 4, 20, 0, Inferior, Superior;
|CONFI "2400SConforme con lo seleccionado : ";
|SI FSalida ! 0; |DELINDEX #99; |ACABA; |FINSI;

|ABRE #10;
|BUCLE rew00004;
|CIERRA #10;

|DELINDEX #99;
|FPRC;

|PROCESO Funcion1; |TIPO 11;
|SI FSalida ! 9; |ACABA; |FINSI;

|SI #99#9 = 1;
    |PUSHV 0501 2380;
    |AVISO; |AVISO; |AVISO;
    |D_CUADRO 1121,1462;
    |ATRI R;
    |PINTA 1222, "NO SE PUEDE ADJUDICAR EL APUNTE MOTIVO :";
    |PINTA 1322, #99#8;
    |ATRI r;
    |PAUSA;
    |POPV;
    |ACABA;
|FINSI;

|LIBERA #99;
|LEE 140#99=;

|SI #99#7 = "N"; #99#7 = "S"; |SINO; #99#7 = "N"; |FINSI;
|PINTA #99#7;

|GRABA 140#99a;
|FPRC;
