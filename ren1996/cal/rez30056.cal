|INCLUYE i_larpda;
|INCLUYE i_varlar;

|PROCESO LetraDni;
  |QBF CampoDni;
  Letra2 = CampoDni;
  |QBT Letra2;

      Caracter = Letra2 % 101;
  |SI Caracter!"A";|Y Caracter!"B";|Y Caracter!"C";|Y Caracter!"D";
       |Y Caracter!"E";|Y Caracter!"F";
       |Y Caracter!"G";|Y Caracter!"P";|Y Caracter!"Q";|Y Caracter!"S";|Y Caracter!"X";
          Letra4 = "";
          Letra3 = Letra2 % 0;
          Carac2 = Letra3;
      |PARA Carac5 = 1;  |SI Carac5 [ Carac2;  |HACIENDO Carac5 = Carac5 + 1;
              Carac3 = (Carac5 * 100) + 1;
              Letra3 = Letra2 % Carac3;
          |SI Letra3="0";|O Letra3="1";|O Letra3="2";|O Letra3="3";
                        |O Letra3="4";|O Letra3="5";|O Letra3="6";
                        |O Letra3="7";|O Letra3="8";|O Letra3="9";
                  Letra4 = Letra4 + Letra3;
          |FINSI;
      |SIGUE;
          Carac4 = Letra4;
      |SI Carac4 ! 0; |Y Letra4 ! "";
              Carac1 = Carac4 $ 23;
              Carac1 = Carac1 + 1;
              Carac3 = (Carac1 * 100) + 1;
              Letra1 = LetrasNif % Carac3;

              Letra4 = "000000000000" + Letra4;
              Letra7 = Letra4 % -103;
              Letra6 = Letra4 % -403;
              Letra5 = Letra4 % -703;

              Letra8 = Letra5  % 101;
              |SI Letra8 = "0"; Letra5 = Letra5 % 202; |FINSI;

              Letra8 = Letra5  % 101;
              |SI Letra8 = "0"; Letra5 = Letra5 % 201; |FINSI;

              Letra8 = Letra5  % 101;
              |SI Letra8 = "0"; Letra5 = ""; |FINSI;

              |SI Letra5 ! "";
                  Letra4 = Letra5 + Letra6 + Letra7 + Letra1;
              |SINO;
                  Letra4 = Letra6 + Letra7 + Letra1;
              |FINSI;

              CampoDni = Letra4;
              CampoDni = ("000000000" + CampoDni) % -109;
      |FINSI;
  |SINO;
      Caracter = "";
      Cadena   = "";
      |PARA XPara = 1; |SI XPara [ 12; |HACIENDO XPara = XPara + 1;
            Posi = (100 * XPara) + 1;
            Caracter = CampoDni % Posi;
            |SI Caracter ! "."; |Y Caracter ! "-"; |Y Caracter ! " ";
                Cadena = Cadena + Caracter;
            |FINSI;
      |SIGUE;
       CampoDni = Cadena % 109;
  |FINSI;
  CampoDni = (CampoDni + "         ") % 109;
|FPRC;

|PROCESO CambiCanti;
  CantiNum = CantiNum ! 0;
  |SI CantiNum ] 0;
      CantiAlfa = CantiNum;
      CantiAlfa = ("0000000000" + CantiAlfa) % -110;
  |SINO;
      CantiNum  = -CantiNum;
      CantiAlfa = CantiNum;
      CantiAlfa = "N" + (("000000000" + CantiAlfa) % -109);
  |FINSI;
|FPRC;

|PROCESO BorraCampos;
  ICampos = Campos1 <-;
  |PARA XPara = 1; |SI XPara [ 200; |HACIENDO XPara = XPara + 1;
        Campos   = "";
        ICampos  = ICampos + 1;
  |SIGUE;
|FPRC;

|PROCESO Secuencial1;
  |HAZ BorraCampos;
                        || -1-
  ICampos = Campos1 <-;
  Campos  = "103";

                        || -2-
  ICampos = ICampos + 1;
  Campos  = "01";

                        || -3-
  ICampos  = ICampos + 1;
  Variable = #70#2; Variable = ("00000" + Variable) % -105;
  |SI Variable = "00000"; Variable = "     "; |FINSI;
  Campos   = Variable;

                        || -4-
  ICampos  = ICampos + 1;
  CampoDni = #70#10;  |HAZ LetraDni;
  Campos   = CampoDni;

                        || -5-
  ICampos  = ICampos + 1;
  Campos   = #70#111 % 136;

                        || -6-
  ICampos  = ICampos + 1;
  Campos   = #70#14 % 126;

                        || -7-
  ICampos  = ICampos + 1;
  Campos   = #70#15;

                        || -8-
  ICampos  = ICampos + 1;
  Campos   = #70#16 % 115;

                        || -9-
  ICampos  = ICampos + 1;
  Campos   = #70#17 % 113;

                        || -10-
  ICampos  = ICampos + 1;
  Variable = #70#18; Variable = ("00000" + Variable) % -105;
  |SI Variable = "00000"; Variable = "     "; |FINSI;
  Campos   = Variable;

                        || -11-
  ICampos  = ICampos + 1;
  Campos   = #70#3 % 102;

                        || -12-
  ICampos  = ICampos + 1;
  Campos   = #70#4 % 102;

                        || -13-
  ICampos  = ICampos + 1;
  Campos   = #70#5 % 102;

                        || -14-
  ICampos  = ICampos + 1;
  Campos   = #70#6 % 102;

                        || -15-
  ICampos  = ICampos + 1;
  CampoDni = #70#19;  |HAZ LetraDni;
  Campos   = CampoDni;

                        || -16-
  ICampos  = ICampos + 1;
  Campos   = #70#112 % 136;

                        || -17-
  ICampos  = ICampos + 1;
                   Campos = " ";
  |SI #70#7 = "X"; Campos = "3"; |FINSI;
  |SI #70#8 = "X"; Campos = "4"; |FINSI;
  |SI #70#9 = "X"; Campos = "5"; |FINSI;

                        || -18-
  ICampos   = ICampos + 1;
                    Campos = " ";
  |SI #70#23 = "X"; Campos = "1"; |FINSI;
  |SI #70#24 = "X"; Campos = "2"; |FINSI;

                        || -19-
  ICampos  = ICampos + 1;
  CampoDni = #70#26;  |HAZ LetraDni;
  Campos   = CampoDni;

                        || -20-
  ICampos  = ICampos + 1;
  Campos   = #70#27 % 133;

                        || -21-
  ICampos  = ICampos + 1;
  Campos   = #70#28 + " ";

                        || -22-
  ICampos  = ICampos + 1;
  Campos   = #70#29;

                        || -23-
  ICampos  = ICampos + 1;
  CampoDni = #70#30;  |HAZ LetraDni;
  Campos   = CampoDni;

                        || -24-
  ICampos  = ICampos + 1;
  Campos   = #70#31 % 133;

                        || -25-
  ICampos  = ICampos + 1;
  Campos   = #70#32 + " ";

                        || -26-
  ICampos  = ICampos + 1;
  Campos   = #70#33;

                        || -27-
  ICampos  = ICampos + 1;
  CampoDni = #70#34;  |HAZ LetraDni;
  Campos   = CampoDni;

                        || -28-
  ICampos  = ICampos + 1;
  Campos   = #70#35 % 133;

                        || -29-
  ICampos  = ICampos + 1;
  Campos   = #70#36 + " ";

                        || -30-
  ICampos  = ICampos + 1;
  Campos   = #70#37;

                        || -31-
  ICampos  = ICampos + 1;
  CampoDni = #70#38;  |HAZ LetraDni;
  Campos   = CampoDni;

                        || -32-
  ICampos  = ICampos + 1;
  Campos   = #70#39 % 133;

                        || -33-
  ICampos  = ICampos + 1;
  Campos   = #70#40 + " ";

                        || -34-
  ICampos  = ICampos + 1;
  Campos   = #70#41;

                        || -35-
  ICampos  = ICampos + 1;
  CampoDni = #70#42;  |HAZ LetraDni;
  Campos   = CampoDni;

                        || -36-
  ICampos  = ICampos + 1;
  Campos   = #70#43 % 133;

                        || -37-
  ICampos  = ICampos + 1;
  Campos   = #70#44 + " ";

                        || -38-
  ICampos  = ICampos + 1;
  Campos   = #70#45;

                        || -39-
  ICampos  = ICampos + 1;
  CampoDni = #70#54;  |HAZ LetraDni;
  Campos   = CampoDni;

                        || -40-
  ICampos  = ICampos + 1;
  Campos   = #70#55 % 132;

                        || -41-
  ICampos  = ICampos + 1;
  Variable = #70#56; Variable = ("00000" + Variable) % -105;
  |SI Variable = "00000"; Variable = "     "; |FINSI;
  Campos   = Variable;

                        || -42-
  ICampos  = ICampos + 1;
  Campos   = #70#57 % 116;

                        || -43-
  ICampos  = ICampos + 1;
  Campos   = #70#58;

                        || -44-
  ICampos  = ICampos + 1;
  Campos   = #70#59 % 115;

                        || -45-
  ICampos  = ICampos + 1;
  Campos   = #70#60 % 113;

                        || -46-
  ICampos  = ICampos + 1;
  Campos   = #70#63 % 107;

                        || -47-
  ICampos  = ICampos + 1;
  Campos   = #70#64;

                        || -48-
  ICampos  = ICampos + 1;
  CantiNum = #70#65;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -49-
  ICampos  = ICampos + 1;
  CantiNum = #70#66;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -50-
  ICampos  = ICampos + 1;
  Campos   = #70#67 % 107;

                        || -51-
  ICampos  = ICampos + 1;
  Campos   = #70#68;

                        || -52-
  ICampos  = ICampos + 1;
  CantiNum = #70#69;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -53-
  ICampos  = ICampos + 1;
  CantiNum = #70#70;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -54-
  ICampos  = ICampos + 1;
  Campos   = #70#71 % 107;

                        || -55-
  ICampos  = ICampos + 1;
  Campos   = #70#72;

                        || -56-
  ICampos  = ICampos + 1;
  CantiNum = #70#73;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -57-
  ICampos  = ICampos + 1;
  CantiNum = #70#74;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -58-
  ICampos  = ICampos + 1;
  Campos   = #70#75 % 107;

                        || -59-
  ICampos  = ICampos + 1;
  Campos   = #70#76;

                        || -60-
  ICampos  = ICampos + 1;
  CantiNum = #70#77;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -61-
  ICampos  = ICampos + 1;
  CantiNum = #70#78;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -62-
  ICampos  = ICampos + 1;
  CantiNum = #70#79;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -63-
  ICampos  = ICampos + 1;
  CantiNum = #70#80;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -64-
  ICampos  = ICampos + 1;
  Campos   = #70#81 % 107;

                        || -65-
  ICampos  = ICampos + 1;
  Campos   = #70#82 % 118;

                        || -66-
  ICampos  = ICampos + 1;
  CantiNum = #70#83;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -67-
  ICampos  = ICampos + 1;
  CantiNum = #70#84;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -68-
  ICampos  = ICampos + 1;
  CantiNum = #70#85;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -69-
  ICampos  = ICampos + 1;
  Campos   = #70#86 % 107;

                        || -70-
  ICampos  = ICampos + 1;
  Campos   = #70#87 % 118;

                        || -71-
  ICampos  = ICampos + 1;
  CantiNum = #70#88;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -72-
  ICampos  = ICampos + 1;
  CantiNum = #70#89;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -73-
  ICampos  = ICampos + 1;
  CantiNum = #70#90;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -74-
  ICampos  = ICampos + 1;
  CantiNum = #70#101;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -75-
  ICampos  = ICampos + 1;
  CantiNum = #70#102;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -76-
  ICampos  = ICampos + 1;
  CantiNum = #70#103;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -77-
  ICampos  = ICampos + 1;
  CantiNum = #70#104;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -78-
  ICampos  = ICampos + 1;
  CantiNum = #70#105;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -79-
  ICampos  = ICampos + 1;
  CantiNum = #70#106;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -80-
  ICampos  = ICampos + 1;
  CantiNum = #70#107;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -81-
  ICampos  = ICampos + 1;
  CantiNum = #70#108;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -82-
  ICampos  = ICampos + 1;
  CantiNum = #70#109;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -83-
  ICampos  = ICampos + 1;
  CantiNum = #71#2;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -84-
  ICampos  = ICampos + 1;
  CantiNum = #71#3;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -85-
  ICampos  = ICampos + 1;
  CantiNum = #71#5;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -86-
  ICampos  = ICampos + 1;
  CantiNum = #71#6;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -87-
  ICampos  = ICampos + 1;
  CantiNum = #71#7;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -88-
  ICampos  = ICampos + 1;
  CantiNum = #71#8;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -89-
  ICampos  = ICampos + 1;
  CantiNum = #71#9;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -90-
  ICampos  = ICampos + 1;

  Variable = &#0#7 + &#0#8;
  Campos   = Variable;

  ICampos = Campos1 <-;
  |PARA XPara = 1; |SI XPara [ 90; |HACIENDO XPara = XPara + 1;
        Variable = Handle + " " + Campos;
        |FGRABA Variable;
        ICampos  = ICampos + 1;
  |SIGUE;
|FPRC;

|PROCESO Secuencial2;
  |HAZ BorraCampos;

                       || -1-
  ICampos = Campos1 <-;
  Campos  = "103";

                       || -2-
  ICampos = ICampos + 1;
  Campos  = "02";

                        || -3-
  ICampos  = ICampos + 1;
  CantiNum = #71#21;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -4-
  ICampos  = ICampos + 1;
  CantiNum = #71#22;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -5-
  ICampos  = ICampos + 1;
  CantiNum = #71#23;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -6-
  ICampos  = ICampos + 1;
  CantiNum = #71#24;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -7-
  ICampos  = ICampos + 1;
  CantiNum = #71#31;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -8-
  ICampos  = ICampos + 1;
  CantiNum = #71#32;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -9-
  ICampos  = ICampos + 1;
  CantiNum = #71#33;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -10-
  ICampos  = ICampos + 1;
  CantiNum = #71#34;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -11-
  ICampos  = ICampos + 1;
  CantiNum = #71#37;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -12-
  ICampos  = ICampos + 1;
  CantiNum = #71#38;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -13-
  ICampos  = ICampos + 1;
  CantiNum = #71#39;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -14-
  ICampos  = ICampos + 1;
  CantiNum = #79#21;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -15-
  ICampos  = ICampos + 1;
  Campos   = #79#22;

                        || -16-
  ICampos  = ICampos + 1;
  Campos   = #79#23;

                        || -17-
  ICampos  = ICampos + 1;
  CantiNum = #79#24;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -18-
  ICampos  = ICampos + 1;
  CantiNum = #79#25;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -19-
  ICampos  = ICampos + 1;
  CantiNum = #79#26;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -20-
  ICampos  = ICampos + 1;
  Campos   = #79#27;

                        || -21-
  ICampos  = ICampos + 1;
  Campos   = #79#28 % 120;

                        || -22-
  ICampos  = ICampos + 1;
  CampoDni = #79#29;  |HAZ LetraDni;
  Campos   = CampoDni;

                        || -23-
  ICampos  = ICampos + 1;
  CantiNum = #79#35;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -24-
  ICampos  = ICampos + 1;
  CantiNum = #81#40;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -25-
  ICampos  = ICampos + 1;
  CantiNum = #81#45;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -26-
  ICampos  = ICampos + 1;
  CantiNum = #81#48;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -27-
  ICampos  = ICampos + 1;
  CantiNum = #81#46;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -28-
  ICampos  = ICampos + 1;
  Variable = #81#47;
  |SI #81#47 = 0; Variable = ""; |FINSI;
  Variable = (Variable + "     ") % 105;
  Campos   = Variable;

                        || -29-
  ICampos  = ICampos + 1;
  CantiNum = #81#50;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -30-
  ICampos  = ICampos + 1;
  CantiNum = #82#15;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -31-
  ICampos   = ICampos + 1;
  CantiNum  = #82#21 ! 0;
  CantiAlfa = CantiNum;
  |SI CantiAlfa = "0"; CantiAlfa = ""; |FINSI;
  CantiAlfa = (CantiAlfa + "  ") % 102;
  Campos   = CantiAlfa;

                        || -32-
  ICampos  = ICampos + 1;
  CantiNum = #82#26;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -33-
  ICampos   = ICampos + 1;
  CantiNum  = #82#22 ! 0;
  CantiAlfa = CantiNum;
  |SI CantiAlfa = "0"; CantiAlfa = ""; |FINSI;
  CantiAlfa = (CantiAlfa + "  ") % 102;
  Campos   = CantiAlfa;

                        || -34-
  ICampos  = ICampos + 1;
  CantiNum = #82#27;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -35-
  ICampos   = ICampos + 1;
  CantiNum  = #82#23 ! 0;
  CantiAlfa = CantiNum;
  |SI CantiAlfa = "0"; CantiAlfa = ""; |FINSI;
  CantiAlfa = (CantiAlfa + "  ") % 102;
  Campos   = CantiAlfa;

                        || -36-
  ICampos  = ICampos + 1;
  CantiNum = #82#28;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -37-
  ICampos   = ICampos + 1;
  CantiNum  = #82#24 ! 0;
  CantiAlfa = CantiNum;
  |SI CantiAlfa = "0"; CantiAlfa = ""; |FINSI;
  CantiAlfa = (CantiAlfa + "  ") % 102;
  Campos   = CantiAlfa;

                        || -38-
  ICampos  = ICampos + 1;
  CantiNum = #82#29;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -39-
  ICampos   = ICampos + 1;
  CantiNum  = #82#25 ! 0;
  CantiAlfa = CantiNum;
  |SI CantiAlfa = "0"; CantiAlfa = ""; |FINSI;
  CantiAlfa = (CantiAlfa + "  ") % 102;
  Campos   = CantiAlfa;

                        || -40-
  ICampos  = ICampos + 1;
  CantiNum = #82#30;  |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -41-
  ICampos  = ICampos + 1;
  CantiNum = #80#2;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -42-
  ICampos  = ICampos + 1;
  CantiNum = #80#3;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -43-
  ICampos  = ICampos + 1;
  CampoDni = #80#10;  |HAZ LetraDni;
  Campos   = CampoDni;

                        || -44-
  ICampos  = ICampos + 1;
  CantiNum = #80#4;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -45-
  ICampos  = ICampos + 1;
  CantiNum = #80#5;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -46-
  ICampos  = ICampos + 1;
  CantiNum = #80#6;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -47-
  ICampos  = ICampos + 1;
  CantiNum = #80#7;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -48-
  ICampos  = ICampos + 1;
  CantiNum = #80#11;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -49-
  ICampos  = ICampos + 1;
  CantiNum = #80#12;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -50-
  ICampos  = ICampos + 1;
  CantiNum = #80#13;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -51-
  ICampos  = ICampos + 1;
  CantiNum = #80#14;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -52-
  ICampos  = ICampos + 1;
  CantiNum = #80#15;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -53-
  ICampos  = ICampos + 1;
  CantiNum = #80#16;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -54-
  ICampos  = ICampos + 1;
  CantiNum = #80#17;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -55-
  ICampos  = ICampos + 1;
  CantiNum = #80#18;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -56-
  ICampos  = ICampos + 1;
  CantiNum = #80#19;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -57-
  ICampos  = ICampos + 1;
  CantiNum = #80#20;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -58-
  ICampos  = ICampos + 1;
  CantiNum = #80#21;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -59-
  ICampos  = ICampos + 1;
  CantiNum = #80#22;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -60-
  ICampos  = ICampos + 1;
  CantiNum = #80#26;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -61-
  ICampos  = ICampos + 1;
  CantiNum = #80#27;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -62-
  ICampos  = ICampos + 1;
  CantiNum = #80#28;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -63-
  ICampos  = ICampos + 1;
  CantiNum = #80#29;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -64-
  ICampos  = ICampos + 1;
  CantiNum = #80#30;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -65-
  ICampos  = ICampos + 1;
  CantiNum = #80#8;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -66-
  ICampos  = ICampos + 1;
  CantiNum = #80#9;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -67-
  ICampos  = ICampos + 1;
  CantiNum = #82#47;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -68-
  ICampos  = ICampos + 1;
  CantiNum = #82#48;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -69-
  ICampos  = ICampos + 1;
  CantiNum = #82#50;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -70-
  ICampos  = ICampos + 1;
  CantiNum = #82#51;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -71-
  ICampos  = ICampos + 1;
  CantiNum = #82#56;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -72-
  ICampos  = ICampos + 1;
  CantiNum = #82#57;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -73-
  ICampos  = ICampos + 1;
  CantiNum = #82#58;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -74-
  ICampos  = ICampos + 1;
  CantiNum = #82#66;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -75-
  ICampos  = ICampos + 1;
  Campos   = #80#31 % 104;

                        || -76-
  ICampos  = ICampos + 1;
  Campos   = #80#31 % 504;

                        || -77-
  ICampos  = ICampos + 1;
  Campos   = #80#31 % 902;

                        || -78-
  ICampos  = ICampos + 1;
  Campos   = #80#31 % -110;

                        || -79-
  ICampos  = ICampos + 1;
  |SI #80#33 ! "          ";
      Variable = (#80#33 % 102) + "-" + (#80#33 % 402) + "-" + (#80#33 % -102);
  |SINO;
      Variable = "        ";
  |FINSI;
  Campos   = Variable;
                        || -80-
  ICampos  = ICampos + 1;
  CantiNum = #80#34;   |HAZ CambiCanti;
  Campos   = CantiAlfa;

                        || -81-
  ICampos  = ICampos + 1;
  Campos   = #80#37;

                        || -82-
  ICampos  = ICampos + 1;

  Variable = &#0#7 + &#0#8;
  Campos   = Variable;

  ICampos = Campos1 <-;
  |PARA XPara = 1; |SI XPara [ 82; |HACIENDO XPara = XPara + 1;
        Variable = Handle + " " + Campos;
        |FGRABA Variable;
        ICampos  = ICampos + 1;
  |SIGUE;
|FPRC;

|PROCESO CopiaFichero;
  |SI #500#3 = "D";
      Unidad  = #500#1 + ":";
  |SINO;
      Unidad  = DirectorioD;
  |FINSI;

  |QUE_SISTEMA Sistema;
  FSalida = 0;
  |SI Sistema ! "ESDOS"; |Y #500#3 = "D";
      VAlfa = Raiz + "bin/agcopiaa " + Directorio + Fichero + " " + Unidad;
      |PINTA 2018, "";
      |ATRI I; |SYSTEM VAlfa; |ATRI i;
  |SINO;
      VAlfa1 = Directorio + Fichero;
      VAlfa2 = Unidad + Fichero;
      |COPIA_FICHERO VAlfa1, VAlfa2;
      |SI FSalida ! 0;
          VAlfa3 = "Error [" + FSalida + "] en copia de ficheros ...";
          |PINTA 2018, VAlfa3;
          |PINTA 2380, ".";
          |PAUSA;
      |SINO;
          |SI Sistema ! "ESDOS";
              VAlfa = Raiz + "bin/agichmod 777 " + VAlfa2;
              |SYSTEM VAlfa;
          |FINSI;
      |FINSI;
  |FINSI;
|FPRC;

|PROCESO CopiaBasico;
  Fichero = "admon.tab";     |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_a01";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_a02";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_f00";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_o01";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_o02";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_o03";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_o04";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_o05";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_o06";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_o07";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_o08";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_o09";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_o10";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_o11";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_o12";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_o13";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_s01";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_s02";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_s03";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_s04";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_s05";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_p01";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_p02";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_p03";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_p04";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_p05";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_p06";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_p07";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_p08";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_p09";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "hoja_p10";      |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "irpf_pdf.imp";  |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
  Fichero = "r96pdf.exe";    |HAZ CopiaFichero; |SI FSalida ! 0; |ACABA; |FINSI;
|FPRC;

|PROCESO CopiaBueno;
  Pos = -1;
  INSecuen = NSecuen1 <-;
  |ATRI P;
  |PINTA 2018, "";
  |ATRI p;

  Path = "";
  |DBASE Path;
  Path  = "wb  " + Path + "hacienda/imprime.bat";

  Pos = -1;
  |FABRE Path;
  Handle = FSalida;
  |SI FSalida ] 0;
      |SI #500#3 = "D";
          Variable = Variable + " A:" + &#0#7 + &#0#8;
          |FGRABA Variable;
      |FINSI;

      |PARA XPara = 1; |SI XPara [ 200; |HACIENDO XPara = XPara + 1;
            |SI NSecuen = ""; |SAL; |FINSI;

             Fichero  = NSecuen % -108;  |HAZ CopiaFichero;

             Variable = Handle + " " + "r96pdf " + Fichero;
             |SI #500#3 = "D";
                 |SI #500#2 = "N"; Variable = Variable + "  s"; |FINSI;
             |SINO;
                 |SI #500#5 = "N"; Variable = Variable + "  s"; |FINSI;
             |FINSI;
             Variable = Variable + &#0#7 + &#0#8;
             |FGRABA Variable;

             INSecuen = INSecuen + 1;
      |SIGUE;

      |SI #500#3 = "D";
          Variable = Handle + " " + "C:" + &#0#7 + &#0#8;
          |FGRABA Variable;
      |FINSI;

      FSalida = Handle;
      |FCIERRA FSalida;

      Fichero = "imprime.bat"; |HAZ CopiaFichero;
  |FINSI;

  |SI #500#3 = "D";
      |ATRI I;
      |PINTA 2018, " FICHEROS COPIADO !!!!. Introduzca el diskette  ";
      |PINTA 2118, " en una maquina en D.O.S. e introducir A:IMPRIME";
      |ATRI 0;
      |PAUSA;
      |POPV;
  |SINO;
      |ATRI I;
      |PINTA 2018, " FICHEROS COPIADO !!!!. SESION COMPLETADA CON EXITO";
      |ATRI 0;
      |PAUSA;
      |POPV;
  |FINSI;
|FPRC;

|PROCESO CopiaDisco;
  |DDEFECTO #500;
  |PINPA #0#500;
  |PINDA #0#500;
  |ENDATOS #2#500;
  |SI FSalida = 0;
      Raiz       = "";
      |DIRECTORIO Raiz;
      Directorio = "";
      |DBASE Directorio;
      Directorio = Directorio + "hacienda/";
      |SI #500#3 = "S";
          Raiz       = "";
          |DIRECTORIO Raiz;
          DirectorioD = "";
          |DBASE DirectorioD;
          DirectorioD = DirectorioD + "laser";
          |MKDIR DirectorioD;
          Sesion = #500#4; |QBF Sesion;
          DirectorioD = DirectorioD + "/" + Sesion;
          |MKDIR DirectorioD;
          DirectorioD = DirectorioD + "/";
      |FINSI;

      |SI #500#0 = "S"; |HAZ CopiaBasico; |FINSI;
      |SI #500#3 = "S"; |HAZ CopiaBasico; |FINSI;
      |HAZ CopiaBueno;
  |FINSI;
|FPRC;

|PROCESO Diskette; |TIPO 0;
  #500#3 = #500#3 > #500#3;  |PINTA #500#3;

  |C_M #500#4, 1, "S";
  |C_M #500#5, 1, "S";
  |C_M #500#0, 1, "S";
  |C_M #500#1, 1, "S";
  |C_M #500#2, 1, "S";

  |SI #500#3 = "D";
      Atras = 1;
      |C_M #500#4, 1, "N";
      |C_M #500#5, 1, "N";
  |SINO;
      Atras = 0;
      |C_M #500#0, 1, "N";
      |C_M #500#1, 1, "N";
      |C_M #500#2, 1, "N";
  |FINSI;
|FPRC;

|PROCESO Atras;
  |SI Atras = 1; |ACABA; |FINSI;
  |PINPA #0#500;
  |PINDA #0#500;
|FPRC;

|PROCESO Sesion; |TIPO 0;
  |SI #500#3 = "D";                 |ACABA;  |FINSI;
  |SI #500#4 = "        "; |ERROR;  |ACABA;  |FINSI;

  Raiz       = "";
  |DIRECTORIO Raiz;
  Directorio = "";
  |DBASE Directorio;
  Directorio = "rb  " + Directorio + "laser/";
  Sesion = #500#4; |QBF Sesion;
  Directorio = Directorio + Sesion + "/" + "imprime.bat";

  Pos = -1;
  |FABRE Directorio;
  Handle = FSalida;
  |SI FSalida ] 0;
      |CONFI "2400SLa Sesion ya existe, desea otra sesion : "
      |SI FSalida = 0;
          |ERROR;
      |FINSI;
      |FCIERRA Handle;
  |SINO;
      |ACABA;
  |FINSI;
  Pos = -1;
|FPRC;
