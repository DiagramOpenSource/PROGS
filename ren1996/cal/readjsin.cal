|FICHEROS
     readjsin #0;
     redatcon #1;
     rerendtr #2;
     reempmod #5;
     rededu10 #6;
     reempagr #7;
     reempag1 #8;
     repant50 #90;
     rew00001 #99;
|FIN;

|VARIABLES;
     &cif      = "";

     SwE       = 0;
     perce     = "";
     informe   = "";
     x         = 0;
     n         = "N";
     sw_impre  = 0;
     var       = 0;
     varalf    = "";
     var1      = "";
     var2      = "";
     cabecera  = "";
     hoja      = 0;
     conta     = 0;
     Coefi     = 0;
     impor     = 0;
     sw_fich   = 0;
     swporta   = 0;
     sw21      = 0;
     sw22      = 0;
     sw5       = 0;
     sw6       = 0;
     swmod     = 0;
     linea     = 0;
     a         = 0;
     b         = 0;
     pepe      = 0;
     xxx       = 0;
     d_empre   = 0;
     h_empre   = 0;
     conta1    = 0;
     LineaInforme = 0;
     TopeLinea    = 0;

     Variable1  = 0;   Variable2  = 0;  Variable3  = 0;   Variable4  = 0;
     Variable5  = 0;   Variable6  = 0;  Variable7  = 0;   Variable8  = 0;
     Variable9  = 0;   Variable10 = 0;  Variable11 = 0;   Variable12 = 0;
     Variable13 = 0;   Variable14 = 0;  Variable15 = 0;   Variable16 = 0;
     Variable17 = 0;   Variable18 = 0;  Variable19 = 0;   Variable20 = 0;
     Variable21 = 0;   Variable22 = 0;  Variable23 = 0;   Variable24 = 0;
     Variable25 = 0;   Variable26 = 0;  Variable27 = 0;   Variable28 = 0;
|FIN;

|| **************************************************************************
||                           PROCESOS DEL PROGRAMA
|| **************************************************************************

  |INCLUYE i_ficher;
  |INCLUYE i_import;

|PROCESO seleccion; |TIPO 0;
  |SI #0#0 = "S";
      |CAMPO_MODIFICA #0#01, 1, "S";
      |CAMPO_MODIFICA #0#02, 1, "S";

      |PARA xxx = 3; |SI xxx [ 32; |HACIENDO xxx = xxx + 1;
            #0xxx = 0; |PINTA #0xxx;
            |CAMPO_MODIFICA #0xxx, 1, "N";
      |SIGUE;
  |SINO;
      #0#1 = 00001; |PINTA #0#1;    |CAMPO_MODIFICA #0#01, 1, "N";
      #0#2 = 99999; |PINTA #0#2;    |CAMPO_MODIFICA #0#02, 1, "N";

      |PARA xxx = 3; |SI xxx [ 32; |HACIENDO xxx = xxx + 1;
            |CAMPO_MODIFICA #0xxx, 1, "S";
      |SIGUE;
  |FINSI;
|FPRC;

|| **************************************************************************
||                           PROCESOS IMPRESION
|| **************************************************************************

|PROCESO cabecera;
  cabecera = "************************************************************************";
  |IMPRIME cabecera;
  cabecera = "                        *  RELACION ADJUNTA *        ";
  |IMPRIME cabecera;
  cabecera = "************************************************************************";
  |IMPRIME cabecera;
  hoja     = hoja + 1;
  importe  = hoja;
  cabecera = "";                         |IMPRIME cabecera;
  cabecera = "Hoja ......: " + importe;  |IMPRIME cabecera;
  cabecera = "Declarante : " + #99#3;    |IMPRIME cabecera;
  cabecera = "NIF : " + cif;             |IMPRIME cabecera;
  cabecera = "";                         |IMPRIME cabecera;
  swporta  = 1;
  linea    = 8;
|FPRC;

|PROCESO cabe1;
  cabecera = "A) Rendimientos del trabajo (Retribuciones dinerarias)";
  |IMPRIME cabecera; |HAZ linea;

  cabecera = ""; |IMPRIME cabecera; |HAZ linea;

  cabecera = "Perceptor    Persona o entidad pagadora     Retenciones  Importe integro";
  |IMPRIME cabecera; |HAZ linea;
  cabecera = "------------------------------------------------------------------------";
  |IMPRIME cabecera; |HAZ linea;
  sw21     = 1;
|FPRC;

|PROCESO cabe2;
  |SI sw21 = 1;
      cabecera = "";
      |IMPRIME cabecera; |HAZ linea;
      |IMPRIME cabecera; |HAZ linea;
  |FINSI;

  cabecera = "A) Rendimientos del trabajo (Retribuciones en especie)";
  |IMPRIME cabecera; |HAZ linea;
  cabecera = ""; |IMPRIME cabecera; |HAZ linea;

  cabecera = "Perceptor    Concepto              Valoracion   I. a cuenta Impor.integro";
  |IMPRIME cabecera; |HAZ linea;
  cabecera = "-------------------------------------------------------------------------";
  |IMPRIME cabecera; |HAZ linea;

  sw22     = 1;
|FPRC;

|PROCESO cabe3;
  |SI sw21 = 1; |O sw22 = 1;
      cabecera = "";
      |IMPRIME cabecera; |HAZ linea;
      |IMPRIME cabecera; |HAZ linea;
  |FINSI;

  |SI SwE = 1;
      cabecera = "E1) Actividades empresariales en estimacion objetiva (Modulos)";
  |SINO;
      cabecera = "E2) Actividades agricolas y ganaderas en estimaci¢n objetiva.";
  |FINSI;

  |IMPRIME cabecera; |HAZ linea;
  cabecera = ""; |IMPRIME cabecera; |HAZ linea;

  sw5      = 1;
|FPRC;

|PROCESO cabe4;
  |SI sw21 = 1; |O sw22 = 1; |O sw5 = 1;
      cabecera = "";
      |IMPRIME cabecera; |HAZ linea;
      |IMPRIME cabecera; |HAZ linea;
  |FINSI;
  cabecera = "M) Deducciones de la cuota  (Identificacion cuenta vivienda)";
  |IMPRIME cabecera; |HAZ linea;
  cabecera = ""; |IMPRIME cabecera; |HAZ linea;

  cabecera = "Perceptor    Cuenta                   Importe";
  |IMPRIME cabecera; |HAZ linea;
  cabecera = "---------------------------------------------";
  |IMPRIME cabecera; |HAZ linea;
  sw6      = 1;
|FPRC;

|PROCESO imprime;
  |SI swporta = 0; |HAZ cabecera; |FINSI;

  |SI sw_fich = 21; |Y sw21 = 0; |HAZ cabe1; |FINSI;
  |SI sw_fich = 22; |Y sw22 = 0; |HAZ cabe2; |FINSI;
  |SI sw_fich = 5;  |Y sw5  = 0; |HAZ cabe3; |FINSI;
  |SI sw_fich = 6;  |Y sw6  = 0; |HAZ cabe4; |FINSI;

  |IMPRIME varalf; |HAZ linea;
|FPRC;

|PROCESO linea;
  linea = linea + 1;
  |SI linea < TopeLinea; |ACABA; |FINSI;

  cabecera = "                                                       Sigue...";
  |IMPRIME cabecera;
  linea = linea + 1;
  swporta = 0;
  |PARA x = linea; |SI x [ LineaInforme; |HACIENDO x = x + 1;
        cabecera = ""; |IMPRIME cabecera;
  |SIGUE;
  |HAZ cabecera;
|FPRC;

|PROCESO pie;
  |PARA x = linea; |SI x [ LineaInforme; |HACIENDO x = x + 1;
        cabecera = ""; |IMPRIME cabecera;
  |SIGUE;
|FPRC;

|PROCESO carga1;
  |SI #2#7 ! 0; |O #2#9 ! 0;
      conta = conta + 1;
      |SI conta < 4; |ACABA; |FINSI;

      |SI conta = 4;
         sw_fich = 21;
         varalf = perce;
         varalf = varalf + " " + #2#4;
         importe = #2#9;   |HAZ importe;
         varalf  = varalf + " " + importe;
         importe = #2#7;   |HAZ importe;
         varalf  = varalf + "    " + importe;
         |ACABA;
      |FINSI;
      sw_fich = 21;
      |SI conta = 5; |HAZ imprime; |FINSI;
      varalf = perce;
      varalf = varalf + " " + #2#4;
      importe = #2#9;   |HAZ importe;
      varalf  = varalf + " " + importe;
      importe = #2#7;   |HAZ importe;
      varalf  = varalf + "    " + importe; |HAZ imprime;
  |FINSI;
|FPRC;

|PROCESO carga2;
  |SI #2#15 ! 0; |O #2#16 ! 0;
      conta = conta + 1;
      |SI conta < 4; |ACABA; |FINSI;

      |SI conta = 4;
          sw_fich = 22;
          varalf = #2#14 % 120;
          varalf = #2#3 + " " + varalf;
          importe = #2#15;                      |HAZ importe;
          varalf  = varalf + " " + importe;
          importe = #2#16;                      |HAZ importe;
          varalf  = varalf + " " + importe;
          a       = #2#15 + #2#16;
          importe = a;                          |HAZ importe;
          varalf  = varalf + " " + importe;
          |ACABA;
      |FINSI;

      sw_fich = 22;
      |SI conta = 5;  |HAZ imprime; |FINSI;
      varalf = #2#14 % 120;
      varalf = #2#3 + " " + varalf;
      importe = #2#15;                     |HAZ importe;
      varalf  = varalf + " " + importe;
      importe = #2#16;                     |HAZ importe;
      varalf  = varalf + " " + importe;
      a       = #2#15 + #2#16;
      importe = a;                         |HAZ importe;
      varalf  = varalf + " " + importe;    |HAZ imprime;
  |FINSI;
|FPRC;

|PROCESO rendtrab1;
  |SI #2#28 = "X"; |ACABA; |FINSI;

  |SI #99#1 = "A"; perce = #2#3; |SINO; perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";     || Si es conjunta
      |HAZ carga1;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";     || Si es Titular
      |SI #2#2 = "T"; |HAZ carga1; |ACABA; |FINSI;
  |FINSI;

  |SI #99#1 = "C";     || Si es Conyuge
      |SI #2#2 = "C"; |HAZ carga1; |ACABA; |FINSI;
  |FINSI;

  |SI #99#1 = "1";     || Si es 1§ Familiar
      |SI #2#2 = "1"; |HAZ carga1; |ACABA; |FINSI;
  |FINSI;

  |SI #99#1 = "2";     || Si es 1§ Familiar
      |SI #2#2 = "2"; |HAZ carga1; |ACABA; |FINSI;
  |FINSI;

  |SI #99#1 = "3";     || Si es 3§ Familiar
      |SI #2#2 = "3"; |HAZ carga1; |ACABA; |FINSI;
  |FINSI;

  |SI #99#1 = "4";     || Si es 4§ Familiar
      |SI #2#2 = "4"; |HAZ carga1; |ACABA; |FINSI;
  |FINSI;
|FPRC;

|DEFBUCLE rerendtr1;
  #2#1;
  ;
  #99#0, 01;
  #99#0, 99;
  e;
  NULL, rendtrab1;
|FIN;

|PROCESO rendtrab2;
  |SI #2#28 = "X"; |ACABA; |FINSI;

  |SI #99#1 = "A"; perce = #2#3; |SINO; perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";     || Si es conjunta
      |HAZ carga2;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";     || Si es Titular
      |SI #2#2 = "T"; |HAZ carga2; |ACABA; |FINSI;
  |FINSI;

  |SI #99#1 = "C";     || Si es Conyuge
      |SI #2#2 = "C"; |HAZ carga2; |ACABA; |FINSI;
  |FINSI;

  |SI #99#1 = "1";     || Si es 1§ Familiar
      |SI #2#2 = "1"; |HAZ carga2; |ACABA; |FINSI;
  |FINSI;

  |SI #99#1 = "2";     || Si es 1§ Familiar
      |SI #2#2 = "2"; |HAZ carga2; |ACABA; |FINSI;
  |FINSI;

  |SI #99#1 = "3";     || Si es 3§ Familiar
      |SI #2#2 = "3"; |HAZ carga2; |ACABA; |FINSI;
  |FINSI;

  |SI #99#1 = "4";     || Si es 4§ Familiar
      |SI #2#2 = "4"; |HAZ carga2; |ACABA; |FINSI;
  |FINSI;
|FPRC;

|DEFBUCLE rerendtr2;
  #2#1;
  ;
  #99#0, 01;
  #99#0, 99;
  e;
  NULL, rendtrab2;
|FIN;

|| ********************** Empresariales Modulos ****************************

|PROCESO carga3;
  |SI conta = 999;
      conta1 = conta1 + 1;
      |ACABA;
  |FINSI;

  conta = conta + 1;
  |SI conta < 2; |ACABA; |FINSI;

  sw_fich = 5;

  varalf = "Epigrafe I.A.E. : "  + #5#13 + #5#14; |HAZ imprime;
  varalf = "Titular ........: "  + perce;          |HAZ imprime;

  |PARA x = 16; |SI x [ 22; |HACIENDO x = x + 1;
        a      = x + 7;
        b      = a + 7;
        impor  = #5a % Coefi;
        var1   = impor;
        var1   = ("          " + var1) % -110;
        impor  = (#5a % Coefi) * (#5b % Coefi);
        var2   = impor;
        var2   = ("           " + var2) % -111;
        varalf = #5x + " " + var1 + " " + var2;       |HAZ imprime;
  |SIGUE;

  impor   = #5#37 % Coefi;
  importe = impor; |HAZ importe;
  varalf = " Rendimiento neto previo ............: " + importe; |HAZ imprime;

  varalf = "";                                        |HAZ imprime;
  a      = #5#38 - 1;
  varalf = a;
  varalf = ("     " + varalf) % -105;
  varalf = " Por caracteristicas de la actividad : " + varalf; |HAZ imprime;

  varalf = #5#40;
  varalf = ("     " + varalf) % -105;
  varalf = " Actividades temporada ..............: " + varalf; |HAZ imprime;

  varalf = #5#42;
  varalf = ("     " + varalf) % -105;
  varalf = " Por cuantia del rendimiento ........: " + varalf; |HAZ imprime;

  impor   = #5#44 % Coefi;
  importe = impor; |HAZ importe;
  varalf = " Rendimiento neto corregido .........: " + importe; |HAZ imprime;
  varalf = "";                                        |HAZ imprime;
|FPRC;

|PROCESO modulos;
  |SI #5#4 = "X"; |O #5#4 = "P"; |ACABA; |FINSI;

  |SI #99#1 = "A"; perce = #5#3; |SINO; perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";
      |SI #5#2 = "V";
          Coefi = #5#7 + #5#8 + #5#9 + #5#10 + #5#11 + #5#12;
          |HAZ carga3;
          |ACABA;
      |FINSI;
      Coefi = 100; |HAZ carga3;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #5#2 = "G"; Coefi = 50;   |HAZ carga3; |ACABA; |FINSI;
     |SI #5#2 = "T"; Coefi = 100;  |HAZ carga3; |ACABA; |FINSI;
     |SI #5#2 = "V"; Coefi = #5#7; |HAZ carga3; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #5#2 = "G"; Coefi = 50;   |HAZ carga3; |ACABA; |FINSI;
     |SI #5#2 = "C"; Coefi = 100;  |HAZ carga3; |ACABA; |FINSI;
     |SI #5#2 = "V"; Coefi = #5#8; |HAZ carga3; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "1";
     |SI #5#2 = "1"; Coefi = 100;  |HAZ carga3; |ACABA; |FINSI;
     |SI #5#2 = "V"; Coefi = #5#9; |HAZ carga3; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "2";
     |SI #5#2 = "2"; Coefi = 100;   |HAZ carga3; |ACABA; |FINSI;
     |SI #5#2 = "V"; Coefi = #5#10; |HAZ carga3; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "3";
     |SI #5#2 = "3"; Coefi = 100;   |HAZ carga3; |ACABA; |FINSI;
     |SI #5#2 = "V"; Coefi = #5#11; |HAZ carga3; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "4";
     |SI #5#2 = "4"; Coefi = 100;   |HAZ carga3; |ACABA; |FINSI;
     |SI #5#2 = "V"; Coefi = #5#12; |HAZ carga3; |ACABA; |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|DEFBUCLE reempmod;
  #5#1;
  ;
  #99#0, 01;
  #99#0, 99;
  e;
  NULL, modulos;
|FIN;

|PROCESO LineasAgri;
  |SI #8#3  = 1;
      Variable1  = Variable1 + (#8#7 % Coefi);
      Variable2  = Variable2 + (#8#8 % Coefi);
  |FINSI ;

  |SI #8#3  = 2; |Y #8#4 = "A"; |Y #8#5 = "P";
      Variable3  = Variable3  + (#8#7 % Coefi);
      Variable4  = Variable4  + (#8#8 % Coefi);
  |FINSI;

  |SI #8#3  = 2; |Y #8#4 = "A"; |Y #8#5 = "A";
      Variable5  = Variable5  + (#8#7 % Coefi);
      Variable6  = Variable6  + (#8#8 % Coefi);
  |FINSI;

  |SI #8#3  = 2; |Y #8#4 = "G";
      Variable7  = Variable7  + (#8#7 % Coefi);
      Variable8  = Variable8  + (#8#8 % Coefi);
  |FINSI;

  |SI #8#3  = 3; |Y #8#4 = "A"; |Y #8#5 = "P";
      Variable9  = Variable9  + (#8#7 % Coefi);
      Variable10 = Variable10 + (#8#8 % Coefi);
  |FINSI;

  |SI #8#3  = 3; |Y #8#4 = "A"; |Y #8#5 = "A";
      Variable11 = Variable11 + (#8#7 % Coefi);
      Variable12 = Variable12 + (#8#8 % Coefi);
  |FINSI;

  |SI #8#3  = 3; |Y #8#4 = "G";
      Variable13 = Variable13 + (#8#7 % Coefi);
      Variable14 = Variable14 + (#8#8 % Coefi);
  |FINSI;

  |SI #8#3 = 4; |Y #8#4 = "A"; |Y #8#5 = "P";
      Variable15 = Variable15 + (#8#7 % Coefi);
      Variable16 = Variable16 + (#8#8 % Coefi);
  |FINSI;

  |SI #8#3 = 4; |Y #8#4 = "A"; |Y #8#5 = "A";
      Variable17 = Variable17 + (#8#7 % Coefi);
      Variable18 = Variable18 + (#8#8 % Coefi);
  |FINSI;

  |SI #8#3 = 4; |Y #8#4 = "G";
      Variable19 = Variable19 + (#8#7 % Coefi);
      Variable20 = Variable20 + (#8#8 % Coefi);
  |FINSI;

  |SI #8#3 = 5; |Y #8#4 = "A"; |Y #8#5 = "P";
      Variable21 = Variable21 + (#8#7 % Coefi);
      Variable22 = Variable22 + (#8#8 % Coefi);
  |FINSI;

  |SI #8#3 = 5; |Y #8#4 = "A"; |Y #8#5 = "A";
      Variable23 = Variable23 + (#8#7 % Coefi);
      Variable24 = Variable24 + (#8#8 % Coefi);
  |FINSI;

  |SI #8#3 = 5; |Y #8#4 = "G";
      Variable25 = Variable25 + (#8#7 % Coefi);
      Variable26 = Variable26 + (#8#8 % Coefi);
  |FINSI;

  |SI #8#3 = 6;
      Variable27 = Variable27 + (#8#7 % Coefi);
      Variable28 = Variable28 + (#8#8 % Coefi);
  |FINSI;
|FPRC;

|PROCESO BorraVariable;
  Variable1  = 0;   Variable2  = 0;  Variable3  = 0;   Variable4  = 0;
  Variable5  = 0;   Variable6  = 0;  Variable7  = 0;   Variable8  = 0;
  Variable9  = 0;   Variable10 = 0;  Variable11 = 0;   Variable12 = 0;
  Variable13 = 0;   Variable14 = 0;  Variable15 = 0;   Variable16 = 0;
  Variable17 = 0;   Variable18 = 0;  Variable19 = 0;   Variable20 = 0;
  Variable21 = 0;   Variable22 = 0;  Variable23 = 0;   Variable24 = 0;
  Variable25 = 0;   Variable26 = 0;  Variable27 = 0;   Variable28 = 0;
|FPRC;

|DEFBUCLE reempag1;
  #8#1;
  ;
  #7#0, #7#1, 00;
  #7#0, #7#1, 99;
  ;
  NULL, LineasAgri;
|FIN;

|PROCESO carga_04_8;
  |SI conta = 999;
      conta1 = conta1 + 1;
      |ACABA;
  |FINSI;

  conta  = conta + 1;

  |SI conta < 2; |ACABA; |FINSI;

  sw_fich = 5;

  |HAZ imprime;
  varalf = "Declaracion : " + #7#4;                                |HAZ imprime;
  varalf = "Titular ....: " + #7#3;                                |HAZ imprime;
  varalf = "Descripcion : " + #7#15;                               |HAZ imprime;
  varalf = "";                                                     |HAZ imprime;

  |HAZ BorraVariable;
  |BUCLE reempag1;

  varalf = "";          |HAZ imprime;

  importe = Variable1; |HAZ importe;
  varalf = "1.-                        " + importe + "  0,12 ";
  importe = Variable2; |HAZ importe;
  varalf = varalf + "  " + importe;   |HAZ imprime;

  importe = Variable3; |HAZ importe;
  varalf = "2.- En tierras propias     " + importe + "  0,24 ";
  importe = Variable4; |HAZ importe;
  varalf = varalf + "  " + importe;   |HAZ imprime;

  importe = Variable5; |HAZ importe;
  varalf = "2.- En tierras arrendadas  " + importe + "  0,216";
  importe = Variable6; |HAZ importe;
  varalf = varalf + "  " + importe;   |HAZ imprime;

  importe = Variable7; |HAZ importe;
  varalf = "3.-                        " + importe + "  0,24 ";
  importe = Variable8; |HAZ importe;
  varalf = varalf + "  " + importe;   |HAZ imprime;

  importe = Variable9; |HAZ importe;
  varalf = "4.- En tierras propias     " + importe + "  0,30 ";
  importe = Variable10; |HAZ importe;
  varalf = varalf + "  " + importe;   |HAZ imprime;

  importe = Variable11; |HAZ importe;
  varalf = "4.- En tierras arrendadas  " + importe + "  0,27 ";
  importe = Variable12; |HAZ importe;
  varalf = varalf + "  " + importe;   |HAZ imprime;

  importe = Variable13; |HAZ importe;
  varalf = "5.-                        " + importe + "  0,30 ";
  importe = Variable14; |HAZ importe;
  varalf = varalf + "  " + importe;   |HAZ imprime;

  importe = Variable15; |HAZ importe;
  varalf = "6.- En tierras propias     " + importe + "  0,35 ";
  importe = Variable16; |HAZ importe;
  varalf = varalf + "  " + importe;   |HAZ imprime;

  importe = Variable17; |HAZ importe;
  varalf = "6.- En tierras arrendadas  " + importe + "  0,315";
  importe = Variable18; |HAZ importe;
  varalf = varalf + "  " + importe;   |HAZ imprime;

  importe = Variable19; |HAZ importe;
  varalf = "7.-                        " + importe + "  0,35 ";
  importe = Variable20; |HAZ importe;
  varalf = varalf + "  " + importe;   |HAZ imprime;

  importe = Variable21; |HAZ importe;
  varalf = "8.- En tierras propias     " + importe + "  0,40 ";
  importe = Variable22; |HAZ importe;
  varalf = varalf + "  " + importe;   |HAZ imprime;

  importe = Variable23; |HAZ importe;
  varalf = "8.- En tierras arrendadas  " + importe + "  0,36 ";
  importe = Variable24; |HAZ importe;
  varalf = varalf + "  " + importe;   |HAZ imprime;

  importe = Variable25; |HAZ importe;
  varalf = "9.-                        " + importe + "  0,40 ";
  importe = Variable26; |HAZ importe;
  varalf = varalf + "  " + importe;   |HAZ imprime;

  importe = Variable27; |HAZ importe;
  varalf = "10.-                       " + importe + "  0,55 ";
  importe = Variable28; |HAZ importe;
  varalf = varalf + "  " + importe;   |HAZ imprime;

  varalf = "";          |HAZ imprime;

  impor = #7#37 % Coefi; importe = impor;  |HAZ importe;
  varalf = "Suma de Ingresos ................................: " + importe;
                                                                   |HAZ imprime;

  impor = #7#19 % Coefi; importe = impor;  |HAZ importe;
  varalf = "Rendimiento base actividad ......................: " + importe;
                                                                   |HAZ imprime;

  varalf = "Medio produccion ajenos .........................: " + #7#21;
                                                                   |HAZ imprime;

  varalf = "Personal asalariados ............................: " + #7#22;
                                                                   |HAZ imprime;

  varalf = "Por piensos adquiridos a terceros ...............: " + #7#23;
                                                                   |HAZ imprime;

  impor = #7#27 % Coefi; importe = impor; |HAZ importe;
  varalf = "Rendimiento neto modulos ........................: " + importe;
                                                                   |HAZ imprime;

  varalf = "";                                                     |HAZ imprime;

  varalf = "Ley 7/96 ........................................: " + #7#28;
                                                                   |HAZ imprime;

  varalf = "Nueva creacion ..................................: " + #7#29;
                                                                   |HAZ imprime;

  varalf = "Ley 19/95 .......................................: " + #7#30;
                                                                   |HAZ imprime;

  varalf = "";                                                     |HAZ imprime;

  impor = #7#34 % Coefi; importe = impor;  |HAZ importe;
  varalf = "Rendimineto Neto ................................: " + importe;
                                                                   |HAZ imprime;

  varalf = "";                                                     |HAZ imprime;
  varalf = "";                                                     |HAZ imprime;
|FPRC;

|PROCESO agricolas;
  |SI #7#4 = "X"; |O #7#4 = "P"; |ACABA; |FINSI;

  |SI #99#1 = "A"; perce = #7#3; |SINO; perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";
      |SI #7#2 = "V";
          Coefi = #7#7 + #7#8 + #7#9 + #7#10 + #7#11 + #7#12;
          |HAZ carga_04_8;
          |ACABA;
      |FINSI;
      Coefi = 100; |HAZ carga_04_8;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #7#2 = "G"; Coefi = 50;   |HAZ carga_04_8; |ACABA; |FINSI;
     |SI #7#2 = "T"; Coefi = 100;  |HAZ carga_04_8; |ACABA; |FINSI;
     |SI #7#2 = "V"; Coefi = #7#7; |HAZ carga_04_8; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #7#2 = "G"; Coefi = 50;   |HAZ carga_04_8; |ACABA; |FINSI;
     |SI #7#2 = "C"; Coefi = 100;  |HAZ carga_04_8; |ACABA; |FINSI;
     |SI #7#2 = "V"; Coefi = #7#8; |HAZ carga_04_8; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "1";
     |SI #7#2 = "1"; Coefi = 100;  |HAZ carga_04_8; |ACABA; |FINSI;
     |SI #7#2 = "V"; Coefi = #7#9; |HAZ carga_04_8; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "2";
     |SI #7#2 = "2"; Coefi = 100;   |HAZ carga_04_8; |ACABA; |FINSI;
     |SI #7#2 = "V"; Coefi = #7#10; |HAZ carga_04_8; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "3";
     |SI #7#2 = "3"; Coefi = 100;   |HAZ carga_04_8; |ACABA; |FINSI;
     |SI #7#2 = "V"; Coefi = #7#11; |HAZ carga_04_8; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "4";
     |SI #7#2 = "4"; Coefi = 100;   |HAZ carga_04_8; |ACABA; |FINSI;
     |SI #7#2 = "V"; Coefi = #7#12; |HAZ carga_04_8; |ACABA; |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|DEFBUCLE reempagr;
  #7#1;
  ;
  #99#0, 01;
  #99#0, 99;
  e;
  NULL, agricolas;
|FIN;

|| ********************** Deducciones cuenta vivienda **********************

|PROCESO carga4;
  sw_fich = 6;
  conta = conta + 1;
  |SI conta < 2; |ACABA; |FINSI;

  |SI conta = 2;
      impor   = #6#6 % Coefi;
      importe = impor; |HAZ importe;
      varalf = #6#3 + " " + #6#5 + " " + importe;
      |ACABA;
  |FINSI;

  |SI conta = 3; |HAZ imprime; |FINSI;
  impor   = #6#6 % Coefi;
  importe = impor; |HAZ importe;
  varalf = #6#3 + " " + #6#5 + " " + importe;  |HAZ imprime;
|FPRC;

|PROCESO cuenta;
  |SI #6#8 = "X"; |O #6#8 = "P"; |ACABA; |FINSI;
  |SI #6#4 = "I"; |ACABA; |FINSI;

  |SI #99#1 = "A"; perce = #6#3; |SINO; perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";
      |SI #6#2 = "V";
          Coefi = #6#9 + #6#10 + #6#11 + #6#12 + #6#13 + #6#14;
          |HAZ carga4;
          |ACABA;
      |FINSI;
      Coefi = 100; |HAZ carga4;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #6#2 = "G"; Coefi = 50;   |HAZ carga4; |ACABA; |FINSI;
     |SI #6#2 = "T"; Coefi = 100;  |HAZ carga4; |ACABA; |FINSI;
     |SI #6#2 = "V"; Coefi = #6#9; |HAZ carga4; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #6#2 = "G"; Coefi = 50;    |HAZ carga4; |ACABA; |FINSI;
     |SI #6#2 = "C"; Coefi = 100;   |HAZ carga4; |ACABA; |FINSI;
     |SI #6#2 = "V"; Coefi = #6#10; |HAZ carga4; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "1";
     |SI #6#2 = "1"; Coefi = 100;   |HAZ carga4; |ACABA; |FINSI;
     |SI #6#2 = "V"; Coefi = #6#11; |HAZ carga4; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "2";
     |SI #6#2 = "2"; Coefi = 100;   |HAZ carga4; |ACABA; |FINSI;
     |SI #6#2 = "V"; Coefi = #6#12; |HAZ carga4; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "3";
     |SI #6#2 = "3"; Coefi = 100;   |HAZ carga4; |ACABA; |FINSI;
     |SI #6#2 = "V"; Coefi = #6#13; |HAZ carga4; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "4";
     |SI #6#2 = "4"; Coefi = 100;   |HAZ carga4; |ACABA; |FINSI;
     |SI #6#2 = "V"; Coefi = #6#14; |HAZ carga4; |ACABA; |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|DEFBUCLE rededu10;
  #6#1;
  ;
  #99#0, 01;
  #99#0, 99;
  e;
  NULL, cuenta;
|FIN;

|PROCESO imprime_lo;
  swporta   = 0;
  sw21      = 0;
  sw22      = 0;
  sw5       = 0;
  sw6       = 0;
  swmod     = 0;
  linea     = 0;
  hoja      = 0;

  |ABRE #1;
  #1#0 = #99#0;
  |LEE 040#1=;
  |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
  |CIERRA #1;

  |SI #99#1 = "T"; |O #99#1 = "A";      cif = #1#2;    |FINSI;
  |SI #99#1 = "C";                      cif = #1#29;   |FINSI;
  |SI #99#1 = "1"; conta = 47 + #1#98;  cif = #1conta; |FINSI;
  |SI #99#1 = "2"; conta = 47 + #1#99;  cif = #1conta; |FINSI;
  |SI #99#1 = "3"; conta = 47 + #1#100; cif = #1conta; |FINSI;
  |SI #99#1 = "4"; conta = 47 + #1#101; cif = #1conta; |FINSI;

  |PINPA #0#90;
  #90#0 = #99#0;  |PINTA #90#0;
  #90#1 = #99#3;  |PINTA #90#1;
  #90#3 = 1;      |PINTA #90#3;

  conta = 0; |BUCLE rerendtr1;
  conta = 0; |BUCLE rerendtr2;

  SwE = 1;
  conta = 999;    conta1 = 0; |BUCLE reempmod;
  |SI conta1 > 2; conta  = 0; |BUCLE reempmod; |FINSI;

  SwE = 2;
  conta = 999;    conta1 = 0; |BUCLE reempagr;
  |SI conta1 > 2; conta  = 0; |BUCLE reempagr; |FINSI;

  conta = 0; |BUCLE rededu10;
  |SI swporta = 1; |HAZ pie; |FINSI;
|FPRC;

|DEFBUCLE rew00001;
  #99#1;
  5;
  00000, " ", "S";
  99999, "z", "S";
  ;
  NULL, imprime_lo;
|FIN;

|PROCESO tipo_3; |TIPO 3;
  LineaInforme = #0#34 - 1;
  TopeLinea    = #0#34 - 8;

  |IMPRE 0;
  |SI FSalida ! 0; |ACABA; |FINSI;

  |HAZ carga_index;

  |SI x = 0; |ACABA; |FINSI;

  |BUCLE rew00001;
  |FINIMP;
  |ABRE #99; |CIERRA #99; |DELINDEX #99;
|FPRC;

|PROCESO graba_index;
  |SI #1#142 = "N"; |ACABA; |FINSI;
  |SI #1#143 = "S"; |ACABA; |FINSI;

  |SI #1#103 = "S"; |Y #1#124 = "S";
      #99#0 = #1#0;
      #99#1 = "A";
      #99#2 = "CONJUNTA";
      #99#3 = #1#1;
      #99#4 = 1;
      #99#5 = "S";
      #99#6 = 1;
      |GRABA 040#99n;
      x = 1;
  |FINSI;

  |SI #1#104 = "S"; |Y #1#125 = "S";
      #99#0 = #1#0;
      #99#1 = "T";
      #99#2 = "TITULAR";
      #99#3 = #1#1;
      #99#4 = 1;
      #99#5 = "S";
      #99#6 = 1;
      |GRABA 040#99n;
      x = 1;
  |FINSI;

  |SI #1#105 = "S"; |Y #1#126 = "S";
      #99#0 = #1#0;
      #99#1 = "C";
      #99#2 = "CONYUGE";
      #99#3 = #1#28;
      #99#4 = 1;
      #99#5 = "S";
      #99#6 = 1;
      |GRABA 040#99n;
      x = 1;
  |FINSI;

  |SI #1#106 = "S"; |Y #1#127 = "S";
      #99#0 = #1#0;
      #99#1 = "1";
      #99#2 = "1. FAMILIAR";
      conta  = 57 + #1#98; #99#3 = #1conta;
      #99#4 = 1;
      #99#5 = "S";
      #99#6 = 1;
      |GRABA 040#99n;
      x = 1;
  |FINSI;

  |SI #1#107 = "S"; |Y #1#128 = "S";
      #99#0 = #1#0;
      #99#1 = "2";
      #99#2 = "2. FAMILIAR";
      conta = 57 + #1#99; #99#3 = #1conta;
      #99#4 = 1;
      #99#5 = "S";
      #99#6 = 1;
      |GRABA 040#99n;
      x = 1;
  |FINSI;

  |SI #1#108 = "S"; |Y #1#129 = "S";
      #99#0 = #1#0;
      #99#1 = "3";
      #99#2 = "3. FAMILIAR";
      conta = 57 + #1#100;    #99#3 = #1conta;
      #99#4 = 1;
      #99#5 = "S";
      #99#6 = 1;
      |GRABA 040#99n;
       x = 1;
  |FINSI;

  |SI #1#109 = "S"; |Y #1#130 = "S";
      #99#0 = #1#0;
      #99#1 = "4";
      #99#2 = "4. FAMILIAR";
      conta = 57 + #1#101; #99#3 = #1conta;
      #99#4 = 1;
      #99#5 = "S";
      #99#6 = 1;
      |GRABA 040#99n;
      x = 1;
  |FINSI;
|FPRC;

|DEFBUCLE redatcon;
  #1#1;
  ;
  d_empre;
  h_empre;
  ;
  NULL, graba_index;
|FIN;

|RUTINA inferior;
  #99#0 = 1;
  #99#1 = " ";
|FRUT;

|RUTINA superior;
  #99#0 = 99999;
  #99#1 = "z";
|FRUT;

|PROCESO carga_index;
  comienza = "03";
  |HAZ fichero;
  |NOME_DAT #99 fichero;
  |ABRE #99; |CIERRA #99; |DELINDEX #99;

  |ABRE #99;
  x = 0;
  |SI #0#0 = "S";
      d_empre = #0#1;
      h_empre = #0#2;
      |BUCLE redatcon;
  |SINO;
      |PARA xxx = 3; |SI xxx [ 32; |HACIENDO xxx = xxx + 1;
            |SI #0xxx ! 0;
                d_empre = #0xxx;
                h_empre = #0xxx;
                |BUCLE redatcon;
            |FINSI;
      |SIGUE;
  |FINSI;
  |CIERRA #99;

  |SI x = 0; |ACABA; |FINSI;

  |SI #0#33 = "N"; |ACABA; |FINSI;

  |ENTLINEAL #1#99, 1, 4, 19, 1, inferior, superior;
|FPRC;

|PROCESO funcion1; |TIPO 11;
  |SI FSalida ! 9; |ACABA; |FINSI;

  |LIBERA #99;
  |LEE 140#99=;

  |SI #99#5 = "S"; #99#5 = "N"; |SINO; #99#5 = "S"; |FINSI;
  |PINTA #99#5;
  |GRABA 140#99a;
|FPRC;
