|FICHEROS;
    ver00001 #0;

    y51atcon #1;
    x51atcon #2;

    y51mpmod #3;
    x51mpmod #4;

    y51mpagr #5;
    x51mpagr #6;

    y51agret #7;
    x51agret #8;

    y51alore #9;
    x51alore #10;

    y51alono #11;
    x51alono #12;

    y51tacor #13;
    x51tacor #14;

    y51ctafe #15;
    x51ctafe #16;
|FIN;

|VARIABLES;
    temporal1 = "";
    temporal2 = "";
    agidef0   = "agidef0";
    v_fichero = "";
    v_path    = "";

    &Viene    = 0;
|FIN;

|INCLUYE i_camver;

****************************************************************************
      INICIO DE PROCESO
****************************************************************************
|PROCESO rectaco1;
  |SI #13#28 = "N";  #13#31 = 0;  |FINSI;
  |SI #13#28 = "1";  #13#31 = (#13#17 * 0.40) ! 0;  |FINSI;
  |SI #13#28 = "2";  #13#31 = (#13#17 * 0.26) ! 0;  |FINSI;
  |SI #13#28 = "3";  #13#31 = (#13#17 * 0.25) ! 0;  |FINSI;
  |SI #13#28 = "4";  #13#31 = 0;  |FINSI;
  |SI #13#28 = "5";  #13#31 = 0;  |FINSI;
  |SI #13#28 = "6";  #13#31 = 0;  |FINSI;
  #13#23 = #13#23 + #13#31;
  |GRABA 001#13a;
|FPRC;

|DEFBUCLE rectacon;
 #13#1;
 ;
 00000,00;
 99999,99;
 be;
 NULL,rectaco1;
|FIN;

|PROCESO revalon1;
  |SI #11#44 = "N";  #11#48 = 0;  |FINSI;
  |SI #11#44 = "1";  #11#48 = (#11#19 * 0.40) ! 0;  |FINSI;
  |SI #11#44 = "2";  #11#48 = (#11#19 * 0.26) ! 0;  |FINSI;
  |SI #11#44 = "3";  #11#48 = (#11#19 * 0.25) ! 0;  |FINSI;
  |SI #11#44 = "4";  #11#48 = 0;  |FINSI;
  |SI #11#44 = "5";  #11#48 = 0;  |FINSI;
  |SI #11#44 = "6";  #11#48 = 0;  |FINSI;
  #11#33 = #11#33 + #11#48;
  |GRABA 001#11a;
|FPRC;

|DEFBUCLE revalono;
#11#1;
;
00000,00;
99999,99;
be;
NULL,revalon1;
|FIN;

|PROCESO revalor1;
  |SI #9#42 = "N";  #9#45 = 0;  |FINSI;
  |SI #9#42 = "1";  #9#45 = (#9#20 * 0.40) ! 0;  |FINSI;
  |SI #9#42 = "2";  #9#45 = (#9#20 * 0.26) ! 0;  |FINSI;
  |SI #9#42 = "3";  #9#45 = (#9#20 * 0.25) ! 0;  |FINSI;
  |SI #9#42 = "4";  #9#45 = 0;  |FINSI;
  |SI #9#42 = "5";  #9#45 = 0;  |FINSI;
  |SI #9#42 = "6";  #9#45 = 0;  |FINSI;
  #9#33 = #9#33 + #9#45;
  |GRABA 001#9a;
|FPRC;

|DEFBUCLE revalore;
#9#1;
;
00000,00;
99999,99;
be;
NULL,revalor1;
|FIN;

|CALCULO conver; |TIPO 3;
|SI #0#1 ! "SI";  |ACABA; |FINSI;   || confirmacion de seguridad!!!

|DFICE v_path;

|SI #0#3 = "S";
    |ATRI P; |PINTA 0918, "*";  |ATRI 0;
    v_fichero = "redatcon";
    |HAZ proceso1;
    |PINTA 918, " ";
|FINSI;

|SI #0#4 = "S";
    |ATRI P; |PINTA 1018, "*";  |ATRI 0;
    v_fichero = "reempmod";
    |HAZ proceso2;
    |PINTA 1018, " ";
|FINSI;

|SI #0#5 = "S";
    |ATRI P; |PINTA 1118, "*";  |ATRI 0;
    v_fichero = "reempagr";
    |HAZ proceso3;
    |PINTA 1118, " ";
|FINSI;

|SI #0#6 = "S";
    |ATRI P; |PINTA 1218, "*";  |ATRI 0;
    v_fichero = "repagret";
    |HAZ proceso4;
    |PINTA 1218, " ";
|FINSI;

|SI #0#7 = "S";
    |ATRI P; |PINTA 1318, "*";  |ATRI 0;
    v_fichero = "revalore";
    |HAZ proceso5;
    |BUCLE revalore;
    |PINTA 1318, " ";
|FINSI;

|SI #0#8 = "S";
    |ATRI P; |PINTA 1418, "*";  |ATRI 0;
    v_fichero = "revalono";
    |HAZ proceso6;
    |BUCLE revalono;
    |PINTA 1418, " ";
|FINSI;

|SI #0#9 = "S";
    |ATRI P; |PINTA 1518, "*";  |ATRI 0;
    v_fichero = "rectacon";
    |HAZ proceso7;
    |BUCLE rectacon;
    |PINTA 1518, " ";
|FINSI;

|SI #0#10 = "S";
    |ATRI P; |PINTA 1618, "*";  |ATRI 0;
    v_fichero = "reactafe";
    |HAZ proceso8;
    |PINTA 1618, " ";
|FINSI;

|SI #0#3 = "S"; Viene = 1; |SUB_EJECUTA "rez00010"; |FINSI;

|HAZ gra_version;
|FCAL;

****************************************************************************
      LECTURA Y GRABACION
****************************************************************************

|PROCESO proceso1;
|NOME_DAT #2 agidef0;
|DELINDEX #2;

|ABRE #2; |CIERRA #2;

temporal1 = v_path + "agidef0.ddx";
temporal2 = v_path + v_fichero + ".ddx";
|FBORRA temporal2;
|RENOMBRA_FICHERO temporal1,temporal2;

temporal1 = v_path + "agidef0.ixx";
temporal2 = v_path + v_fichero + ".ixx";
|FBORRA temporal2;
|RENOMBRA_FICHERO temporal1,temporal2;

|DELINDEX #2;

|NOME_DAT #1 v_fichero;
|ABRE #1; |CIERRA #1;
|GRABAENDEF v_fichero,"";
|FPRC;

|PROCESO proceso2;
|NOME_DAT #4 agidef0;
|DELINDEX #4;

|ABRE #4; |CIERRA #4;

temporal1 = v_path + "agidef0.ddx";
temporal2 = v_path + v_fichero + ".ddx";
|FBORRA temporal2;
|RENOMBRA_FICHERO temporal1,temporal2;

temporal1 = v_path + "agidef0.ixx";
temporal2 = v_path + v_fichero + ".ixx";
|FBORRA temporal2;
|RENOMBRA_FICHERO temporal1,temporal2;

|DELINDEX #4;

|NOME_DAT #3 v_fichero;
|ABRE #3; |CIERRA #3;
|GRABAENDEF v_fichero,"";
|FPRC;

|PROCESO proceso3;
|NOME_DAT #6 agidef0;
|DELINDEX #6;

|ABRE #6; |CIERRA #6;

temporal1 = v_path + "agidef0.ddx";
temporal2 = v_path + v_fichero + ".ddx";
|FBORRA temporal2;
|RENOMBRA_FICHERO temporal1,temporal2;

temporal1 = v_path + "agidef0.ixx";
temporal2 = v_path + v_fichero + ".ixx";
|FBORRA temporal2;
|RENOMBRA_FICHERO temporal1,temporal2;

|DELINDEX #6;

|NOME_DAT #5 v_fichero;
|ABRE #5; |CIERRA #5;
|GRABAENDEF v_fichero,"";
|FPRC;

|PROCESO proceso4;
|NOME_DAT #8 agidef0;
|DELINDEX #8;

|ABRE #8; |CIERRA #8;

temporal1 = v_path + "agidef0.ddx";
temporal2 = v_path + v_fichero + ".ddx";
|FBORRA temporal2;
|RENOMBRA_FICHERO temporal1,temporal2;

temporal1 = v_path + "agidef0.ixx";
temporal2 = v_path + v_fichero + ".ixx";
|FBORRA temporal2;
|RENOMBRA_FICHERO temporal1,temporal2;

|DELINDEX #8;

|NOME_DAT #7 v_fichero;
|ABRE #7; |CIERRA #7;
|GRABAENDEF v_fichero,"";
|FPRC;


|PROCESO proceso5;
|NOME_DAT #10 agidef0;
|DELINDEX #10;

|ABRE #10; |CIERRA #10;

temporal1 = v_path + "agidef0.ddx";
temporal2 = v_path + v_fichero + ".ddx";
|FBORRA temporal2;
|RENOMBRA_FICHERO temporal1,temporal2;

temporal1 = v_path + "agidef0.ixx";
temporal2 = v_path + v_fichero + ".ixx";
|FBORRA temporal2;
|RENOMBRA_FICHERO temporal1,temporal2;

|DELINDEX #10;

|NOME_DAT #9 v_fichero;
|ABRE #9; |CIERRA #9;
|GRABAENDEF v_fichero,"";
|FPRC;


|PROCESO proceso6;
|NOME_DAT #12 agidef0;
|DELINDEX #12;

|ABRE #12; |CIERRA #12;

temporal1 = v_path + "agidef0.ddx";
temporal2 = v_path + v_fichero + ".ddx";
|FBORRA temporal2;
|RENOMBRA_FICHERO temporal1,temporal2;

temporal1 = v_path + "agidef0.ixx";
temporal2 = v_path + v_fichero + ".ixx";
|FBORRA temporal2;
|RENOMBRA_FICHERO temporal1,temporal2;

|DELINDEX #12;

|NOME_DAT #11 v_fichero;
|ABRE #11; |CIERRA #11;
|GRABAENDEF v_fichero,"";
|FPRC;


|PROCESO proceso7;
|NOME_DAT #14 agidef0;
|DELINDEX #14;

|ABRE #14; |CIERRA #14;

temporal1 = v_path + "agidef0.ddx";
temporal2 = v_path + v_fichero + ".ddx";
|FBORRA temporal2;
|RENOMBRA_FICHERO temporal1,temporal2;

temporal1 = v_path + "agidef0.ixx";
temporal2 = v_path + v_fichero + ".ixx";
|FBORRA temporal2;
|RENOMBRA_FICHERO temporal1,temporal2;

|DELINDEX #14;

|NOME_DAT #13 v_fichero;
|ABRE #13; |CIERRA #13;
|GRABAENDEF v_fichero,"";
|FPRC;

|PROCESO proceso8;
|NOME_DAT #16 agidef0;
|DELINDEX #16;

|ABRE #16; |CIERRA #16;

temporal1 = v_path + "agidef0.ddx";
temporal2 = v_path + v_fichero + ".ddx";
|FBORRA temporal2;
|RENOMBRA_FICHERO temporal1,temporal2;

temporal1 = v_path + "agidef0.ixx";
temporal2 = v_path + v_fichero + ".ixx";
|FBORRA temporal2;
|RENOMBRA_FICHERO temporal1,temporal2;

|DELINDEX #16;

|NOME_DAT #15 v_fichero;
|ABRE #15; |CIERRA #15;
|GRABAENDEF v_fichero,"";
|FPRC;

****************************************************************************
      RUTINAS ESPECIFICAS DE LA CONVERSION VIGENTE
****************************************************************************

|PROCESO mayor; |TIPO 0;
|SI lo_que_dices = 0; |ACABA; |FINSI;

#0Campo = #0Campo > #0Campo;
|PINTA #0Campo;
|FPRC;

|PROCESO lo_que_digo; |TIPO 0;
  |C_V #0#3, 1, "N"; |C_M #0#3, 1, "N";
  |C_V #0#4, 1, "N"; |C_M #0#4, 1, "N";
  |C_V #0#5, 1, "N"; |C_M #0#5, 1, "N";
  |C_V #0#6, 1, "N"; |C_M #0#6, 1, "N";
  |C_V #0#7, 1, "N"; |C_M #0#7, 1, "N";
  |C_V #0#8, 1, "N"; |C_M #0#8, 1, "N";
  |C_V #0#9, 1, "N"; |C_M #0#9, 1, "N";

  |HAZ que_me_dices;
  |SI lo_que_dices = 0; |ACABA; |FINSI;

  #0#1 = "SI"; |PINTA #0#1;

  |C_V #0#3, 1, "S";  |C_M #0#3, 1, "S";
  |C_V #0#4, 1, "S";  |C_M #0#4, 1, "S";
  |C_V #0#5, 1, "S";  |C_M #0#5, 1, "S";
  |C_V #0#6, 1, "S";  |C_M #0#6, 1, "S";
  |C_V #0#7, 1, "S";  |C_M #0#7, 1, "S";
  |C_V #0#8, 1, "S";  |C_M #0#8, 1, "S";
  |C_V #0#9, 1, "S";  |C_M #0#9, 1, "S";
|FPRC;
