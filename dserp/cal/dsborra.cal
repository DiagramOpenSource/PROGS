||PRUEBAS IDENTIFICACION LLAMADA


|FICHEROS;
     pbxpara3 #333;      ||PBX Para. Telefono (pbxpara3)

     referen@ #100;
     pbxpara5 #5;
     pbxpara6 #6;
|FIN;

|VARIABLES;
     nCliente = 0;
     aNomCli = "";
     aAux2 = "";

     aSwSuprimirCero = "";
     nYata = 0;
     aAuxNumero = "";


     nVoyPrimero = 0;
     nEstoy = 0;

     nLongTotal = 0;
     aNomTele = "";
     aNumTele = "";
     aDoblete = "";
     aRestoPara = "";
     aAuxPara = "";
     aNomCampo = "";
     nError = 0;
     nCorrecto = 0;
     aRespuesta = "";

     {1}aContiene = "";
     {1}aLocal = "";
     aBaseLocal = "";
     aVersion1 = "";
     aVersion2 = "";
     aIPRemoto = "";
     aOrigen = "";
     aDestino = "";
     aBase = "";

     comando = "";
     a = "";
     nn = 0;
     nExiste = 0;
     i = 0;

   {1000} aPopup = "";
     aContenido = "";

     nCampoVoy = 0;
     aAux = "";
     aFicheroDef = "";
     nHayMarcaPBX = 0;
     aLlamarTel = "";
     nHayNumTelefono = 0;
     aMas = "";
     aMensaje = "";
     aParametro = "";
     aAplica = "";
     aNumEmp = "";
     nEmpresa = 0;
     aNomDef = "";
     aParte1 = "";
     aParte2 = "";
     aClau = "";
     aLong = "";
     nLong = 0;
     nSwSegunda = 0;
     nPos = 0;
     aSaca = "";
     aLetra = "";
     aPathDef = "";
     aPathDat = "";

     nTamanyo = 0;
     aTamanyo = "";
     nSaca = 0;
     aAlfa5 = "";
     aClaves = "";
     aTCompo = "";
     nTCompo = 0;
     aTCompo2 = "";
     nTCompo2 = 0;
     {16}clave = 0;      ||Array de 16 elementos para la clave.
     nCompo = 0;
     nPosi = 0;
     aTCampos = "";
     nTCampos = 0;
     nCampo = 0;

     aAlfa1 = "";
     nVoy = 0;
     nNumCam = 0;
     Comodin = "";
     Comodin1 = "";

     aUsuario = "";
     aExtension = "";
     aHost = "";
     aUsuAM = "";
     aPassAM = "";
|FIN;

|PROCESO SuprimirCerosIzquierda;
     |SI aSwSuprimirCero = "S";
          ||aLlamarTel
          nYata = 0;
          aAuxNumero = "";

          |QBT aLlamarTel;
          aLong = aLlamarTel % A0;
          nLong = aLong;
          |PARA nVoy = 1; |SI nVoy [ nLong; |HACIENDO nVoy = nVoy + 1;
               nSaca = (100 * nVoy) + 1;
               aSaca = nSaca;
               aLetra = aLlamarTel % aSaca;
               |SI aLetra ! "0";
                    nYata = 1;
                    aAuxNumero = aAuxNumero + aLetra;
               |SINO;
                    |SI nYata = 1;
                         aAuxNumero = aAuxNumero + aLetra;
                    |FINSI;
               |FINSI;
          |SIGUE;
          aLlamarTel = aAuxNumero;
     |FINSI;
|FPRC;


|PROCESO CopiaDll;
     |ESPECIFICA "RBASS", aLocal;
     aBaseLocal = aLocal;

     aDestino = aBaseLocal + "bin/cecomsk.dll";
     aContiene1 = aDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aVersion1 = FSalida;  |QBF aVersion1;

     |DBASE aBase;  |QBF aBase;
     aOrigen = aBase + "plugins/cecomsk.dll";
     aContiene1 = aOrigen;
     |ESPECIFICA "MD5", aContiene;
     aVersion2 = FSalida;  |QBF aVersion2;

     |SI aVersion1 ! aVersion2;
         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO SacaDoblete;
     aLong = aDoblete % A0;
     nLong = aLong;
     nVoyPrimero = 1;

     |PARA nEstoy = 1; |SI nEstoy [ nLong; |HACIENDO nEstoy = nEstoy + 1;
          aSaca = nEstoy;
          aSaca = aSaca + "01";
          aLetra = aDoblete % aSaca;
          |SI aLetra = ":";
               nVoyPrimero = 0;
          |FINSI;

          |SI aLetra ! ":";
               |SI nVoyPrimero = 1;
                    aNomTele = aNomTele + aLetra;
               |SINO;
                    aNumTele = aNumTele + aLetra;
               |FINSI;
          |FINSI;
     |SIGUE;

     ||Devuelve
     ||aNomTele
     ||aNumTele
|FPRC;

|PROCESO pbxpara3_hay;
     |SI #pbxpara3#4 = "*";
          nHayMarcaPBX = 1;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE pbxpara3_hay;
 #pbxpara3#1;
 ;
 aAplica, aFicheroDef,   0;
 aAplica, aFicheroDef, 225;
 ;
 NULL, pbxpara3_hay;
|FIN;

|PROCESO LLamaMultiTel;
     aLlamarTel = "";
     nHayNumTelefono = 0;
     IaPopup = aPopup1  <-;
     IaPopup = IaPopup + 1;
     IaPopup = IaPopup + 1;
     aLong = aRestoPara % 0;
     nLongTotal = aLong;

     |PARA nVoy = 1; |SI nVoy [ nLongTotal; |HACIENDO nVoy = nVoy + 1;
          aSaca = nVoy;
          aSaca = aSaca + "01";
          aLetra = aRestoPara % aSaca;
          |SI aLetra = "@";
               aNomTele = "";
               aNumTele = "";
               |HAZ SacaDoblete;

               |SI aNumTele ! "";
                    aLlamarTel = aNumTele;
                    |HAZ SuprimirCerosIzquierda;
                    aNumTele = aLlamarTel;
                    aLlamarTel = "";

                    nHayNumTelefono = nHayNumTelefono + 1;
                    aContenido = aNomTele + ": " + aNumTele;
                    |QBF aContenido;
                    aPopup = aContenido;
                    IaPopup = IaPopup + 1;
               |FINSI;

               aDoblete = "";
          |SINO;
               aDoblete = aDoblete + aLetra;
          |FINSI;
     |SIGUE;

     |SI aDoblete ! "";
          aNomTele = "";
          aNumTele = "";
          |HAZ SacaDoblete;
          |SI aNumTele ! "";
               aLlamarTel = aNumTele;
               |HAZ SuprimirCerosIzquierda;
               aNumTele = aLlamarTel;
               aLlamarTel = "";

               nHayNumTelefono = nHayNumTelefono + 1;
               aContenido = aNomTele + ": " + aNumTele;
               |QBF aContenido;
               aPopup = aContenido;
               IaPopup = IaPopup + 1;
          |FINSI;

     |FINSI;

     ||TRACKPOPUP
     ||Hago el Trackpopup de Seleccion de Numeros
     aPopup1 = "0";
     aPopup2  = nHayNumTelefono;
     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
          aLlamarTel = "";
          IaPopup  = aPopup3  <-;
          IaPopup  = IaPopup + (FSalida - 1);
          aAux = aPopup;
          |QBF aAux;
          aLong = aAux % A0;
          nLong = aLong;
          |PARA nVoy = 1; |SI nVoy [ nLong; |HACIENDO nVoy = nVoy + 1;
               nSaca = 100 * nVoy;
               nSaca = nSaca + 1;
               nSaca = -nSaca;
               aLetra = aAux % nSaca;
               |SI aLetra ! ":";
                    aLlamarTel = aLetra + aLlamarTel;
               |SINO;
                    |SAL;
               |FINSI;
          |SIGUE;
          |QBT aLlamarTel;
     |FINSI;
     |HAZ LLamarNumero;
|FPRC;

|PROCESO LLamaUnTelefono;
     aLlamarTel = aRestoPara;
     |QBF aLlamarTel;
     |HAZ SuprimirCerosIzquierda;
     |SI aLlamarTel ! "";
          |HAZ LLamarNumero;
     |FINSI;
|FPRC;


|PROCESO Telefonos_dsam0107;
     aLlamarTel = #referen@#4;
     |QBF aLlamarTel;
     |SI aLlamarTel ! "";
          |HAZ SuprimirCerosIzquierda;
          nHayNumTelefono = nHayNumTelefono + 1;
          aNomCampo = #referen@#2;
          aNomCampo = aNomCampo % 120;
          |QBF aNomCampo;
          aNomCampo = aNomCampo - ":" - ":" - ":" - ":";
          aContenido = aNomCampo + ": " + aLlamarTel;
          |QBF aContenido;
          aPopup = aContenido;
          IaPopup = IaPopup + 1;
     |FINSI;
|FPRC;

|DEFBUCLE Telefonos_dsam0107;
 #referen@#1002;
 ;
 aNomCli, 01;
 aNomCli, 99;
 ;
 NULL, Telefonos_dsam0107;
|FIN;

|PROCESO ModuloERP_integral;
     aMensaje = "0000PBX especial para INTEGRAL";
     ||MENAV aMensaje;

     aNomCli = "";

     aMas = aPathDef + aNomDef;
     |CARGA_DEF aMas, referen@;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |PATH_DAT #100 aPathDat;
     |ABRE #100;

     |DDEFECTO #100;
     |QBF aClau;
     nCliente = aClau;
     #100#0 = nCliente;
     |LEE 000#100.=;
     |SI FSalida = 0;
          aNomCli = #100#1;
     |FINSI;

     |CIERRA #100;
     |DESCARGA_DEF #referen@;

     aAux2 = aNomCli;
     |QBF aAux2;
     |SI aAux2 = "";             ||No tengo Nombre de Cliente.
          |HAZ ModuloERP_PBX;
     |SINO;
          aMas = aPathDef + "dsam0107";
          |CARGA_DEF aMas, referen@;
          |SI FSalida ! 0; |ACABA; |FINSI;

          |PATH_DAT #100 aPathDat;
          |ABRE #100;

          aLlamarTel = "";
          nHayNumTelefono = 0;
          IaPopup = aPopup1  <-;
          IaPopup = IaPopup + 1;
          IaPopup = IaPopup + 1;

          ||TODO CCC
          |BUCLE Telefonos_dsam0107;

          |SI nHayNumTelefono = 0;
               aMensaje = "0000No hay datos telefonicos en esta ficha";
               |MENAV aMensaje;
               |ACABA;
          |FINSI;
          |SI nHayNumTelefono = 1;
               ||Nada, ya tengo el numero de Telefono. (aLlamarTel)
          |SINO;
               ||Hago el Trackpopup de Seleccion de Numeros
               aPopup1 = "0";
               aPopup2  = nHayNumTelefono;
               IaPopup  = aPopup1  <-;
               |ESPECIFICA "TRACKPOPUP", aPopup;
               |SI FSalida ! 0;
                    aLlamarTel = "";
                    IaPopup  = aPopup3  <-;
                    IaPopup  = IaPopup + (FSalida - 1);
                    aAux = aPopup;
                    |QBF aAux;
                    aLong = aAux % A0;
                    nLong = aLong;
                    |PARA nVoy = 1; |SI nVoy [ nLong; |HACIENDO nVoy = nVoy + 1;
                         nSaca = 100 * nVoy;
                         nSaca = nSaca + 1;
                         nSaca = -nSaca;
                         aLetra = aAux % nSaca;
                         |SI aLetra ! ":";
                              aLlamarTel = aLetra + aLlamarTel;
                         |SINO;
                              |SAL;
                         |FINSI;
                    |SIGUE;
                    |QBT aLlamarTel;
               |SINO;
                    |ACABA;
               |FINSI;
          |FINSI;
          |HAZ LLamarNumero;

          |CIERRA #100;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO ModuloERP_integral106;
     aMensaje = "0000PBX especial para INTEGRAL. (Listin Telefonico";
     ||MENAV aMensaje;

     aNomCli = aClau;
     aAux2 = aNomCli;
     |QBF aAux2;
     |SI aAux2 = "";             ||No tengo Nombre de Cliente.
          |HAZ ModuloERP_PBX;
     |SINO;
          aMas = aPathDef + "dsam0107";
          |CARGA_DEF aMas, referen@;
          |SI FSalida ! 0; |ACABA; |FINSI;

          |PATH_DAT #100 aPathDat;
          |ABRE #100;

          aLlamarTel = "";
          nHayNumTelefono = 0;
          IaPopup = aPopup1  <-;
          IaPopup = IaPopup + 1;
          IaPopup = IaPopup + 1;

          ||TODO CCC
          |BUCLE Telefonos_dsam0107;

          |SI nHayNumTelefono = 0;
               aMensaje = "0000No hay datos telefonicos en esta ficha";
               |MENAV aMensaje;
               |ACABA;
          |FINSI;
          |SI nHayNumTelefono = 1;
               ||Nada, ya tengo el numero de Telefono. (aLlamarTel)
          |SINO;
               ||Hago el Trackpopup de Seleccion de Numeros
               aPopup1 = "0";
               aPopup2  = nHayNumTelefono;
               IaPopup  = aPopup1  <-;
               |ESPECIFICA "TRACKPOPUP", aPopup;
               |SI FSalida ! 0;
                    aLlamarTel = "";
                    IaPopup  = aPopup3  <-;
                    IaPopup  = IaPopup + (FSalida - 1);
                    aAux = aPopup;
                    |QBF aAux;
                    aLong = aAux % A0;
                    nLong = aLong;
                    |PARA nVoy = 1; |SI nVoy [ nLong; |HACIENDO nVoy = nVoy + 1;
                         nSaca = 100 * nVoy;
                         nSaca = nSaca + 1;
                         nSaca = -nSaca;
                         aLetra = aAux % nSaca;
                         |SI aLetra ! ":";
                              aLlamarTel = aLetra + aLlamarTel;
                         |SINO;
                              |SAL;
                         |FINSI;
                    |SIGUE;
                    |QBT aLlamarTel;
               |SINO;
                    |ACABA;
               |FINSI;
          |FINSI;
          |HAZ LLamarNumero;

          |CIERRA #100;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;



|PROCESO ModuloERP_PBX;
     aMas = aPathDef + aNomDef;
     |CARGA_DEF aMas, referen@;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |PATH_DAT #100 aPathDat;
     |ABRE #100;

     |DDEFECTO #100;
     aAlfa5 = "|K000";
     aClaves = #referen@#aAlfa5#;
     aTCompo = aClaves % 103;
     nTCompo = aTCompo;
     Iclave = clave1<-;
     |PARA nCampo = 1;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
          clave = 0;
          Iclave = Iclave + 1;
     |SIGUE;

     Iclave = clave1<-;
     |PARA nCompo = 1;  |SI nCompo [ nTCompo;  |HACIENDO nCompo = nCompo + 1;
          nPosi = (nCompo * 300) + 103;
          aAlfa1 = aClaves % nPosi;
          clave = aAlfa1;
          Iclave = Iclave + 1;
     |SIGUE;

     nVoy = 1;
     Iclave = clave1<-;
     |PARA nCompo = 1;  |SI nCompo [ nTCompo;  |HACIENDO nCompo = nCompo + 1;
          nNumCam = clave;
          Iclave = Iclave + 1;

          Comodin = ("000" + nNumCam) % -103;
          Comodin = "|C" + Comodin;
          Comodin1 = Comodin + "ILON";
          Comodin1 = #referen@#Comodin1#;
          nTamanyo = Comodin1;
          aTamanyo = ("00" + nTamanyo) % -102;
          nSaca = (nVoy * 100) + aTamanyo;
          aSaca = aClau % nSaca;
          #referen@#nNumCam# = aSaca;
          nVoy = nVoy + nTamanyo;
     |SIGUE;
     |LEE 000#100.=;
     |SI FSalida = 0;
          |HAZ ControlPBX;
     |FINSI;

     |CIERRA #100;
     |DESCARGA_DEF #referen@;
|FPRC;


|PROCESO pbxpara3_tel;
     |SI #pbxpara3#4 = "*";
          nCampoVoy = #pbxpara3#2;
          aAux = #referen@#nCampoVoy#;
          |QBF aAux;
          |SI aAux ! "";
               aLlamarTel = aAux;
               |HAZ SuprimirCerosIzquierda;
               nHayNumTelefono = nHayNumTelefono + 1;
               aNomCampo = #pbxpara3#3;
               |QBF aNomCampo;
               aNomCampo = aNomCampo - ":" - ":" - ":" - ":";
               aContenido = aNomCampo + ": " + aLlamarTel;
               |QBF aContenido;
               aPopup = aContenido;
               IaPopup = IaPopup + 1;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE pbxpara3_tel;
 #pbxpara3#1;
 ;
 aAplica, aFicheroDef,   0;
 aAplica, aFicheroDef, 225;
 ;
 NULL, pbxpara3_tel;
|FIN;

|PROCESO ControlPBX
     nHayMarcaPBX = 0;
     |BUCLE pbxpara3_hay;
     |SI nHayMarcaPBX = 0;
          aMensaje = "0000Fichero " + aFicheroDef + " no parametrizado para Modulo Centralita";
          |MENAV aMensaje;
          |ACABA;
     |SINO;
          aLlamarTel = "";
          nHayNumTelefono = 0;
          IaPopup = aPopup1  <-;
          IaPopup = IaPopup + 1;
          IaPopup = IaPopup + 1;
          |BUCLE pbxpara3_tel;
          |SI nHayNumTelefono = 0;
               aMensaje = "0000No hay datos telefonicos en esta ficha";
               |MENAV aMensaje;
               |ACABA;
          |SINO;
               |SI nHayNumTelefono = 1;
                    ||Nada, ya tengo el numero de Telefono. (aLlamarTel)
               |SINO;
                    ||Hago el Trackpopup de Seleccion de Numeros
                    aPopup1 = "0";
                    aPopup2  = nHayNumTelefono;
                    IaPopup  = aPopup1  <-;
                    |ESPECIFICA "TRACKPOPUP", aPopup;
                    |SI FSalida ! 0;
                         aLlamarTel = "";
                         IaPopup  = aPopup3  <-;
                         IaPopup  = IaPopup + (FSalida - 1);
                         aAux = aPopup;
                         |QBF aAux;
                         aLong = aAux % A0;
                         nLong = aLong;
                         |PARA nVoy = 1; |SI nVoy [ nLong; |HACIENDO nVoy = nVoy + 1;
                              nSaca = 100 * nVoy;
                              nSaca = nSaca + 1;
                              nSaca = -nSaca;
                              aLetra = aAux % nSaca;
                              |SI aLetra ! ":";
                                   aLlamarTel = aLetra + aLlamarTel;
                              |SINO;
                                   |SAL;
                              |FINSI;
                         |SIGUE;
                         |QBT aLlamarTel;
                    |SINO;
                         |ACABA;
                    |FINSI;
               |FINSI;
               |HAZ LLamarNumero;
               |ACABA;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO LLamarNumero;
     aExtension = "";
     ||aLlamarTel
     |ABRE #pbxpara6;
     |DDEFECTO #pbxpara6;
     #pbxpara6#0 = aUsuario;
     |LEE 000#pbxpara6.=;
     |SI FSalida = 0;
          aExtension = #pbxpara6#1;
          |QBF aExtension;
     |FINSI;
     |CIERRA #pbxpara6;

     |SI aExtension = "";
          aMensaje = "0000Usuario SIN extension asociada";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;


     aMensaje = "0000LLamar al numero de Telefono " + aLlamarTel;
     ||MENAV aMensaje;

     comando = "TMAVISO:100";
     |ALFACALLDLL "cecomsk.dll","cecomsk",comando;

     comando = "CANAL:" + aExtension;   || lo primero ... quien somos
     |ALFACALLDLL "cecomsk.dll","cecomsk",comando;

     comando = "CONECTAR:" + aHost;
     |ALFACALLDLL "cecomsk.dll","cecomsk",comando;
     |HAZ ResultadoCecom;
     |SI nError = 1;
         aMensaje = "0000ERROR " + aRespuesta;
         |MENAV aMensaje;
     |SINO;
          comando = "LOGIN:" + aUsuAM + "," + aPassAM;
          |ALFACALLDLL "cecomsk.dll","cecomsk",comando;
          |HAZ ResultadoCecom;
          |SI nError = 1;
              aMensaje = "0000ERROR " + aRespuesta;
              |MENAV aMensaje;
          |SINO;
               comando = "TMAVISO:300";
               |ALFACALLDLL "cecomsk.dll","cecomsk",comando;
/*
||               comando = "DIRECTO:CallerId: " + &34 + "Llama " + aLlamarTel + " <" + aLlamarTel+ ">" + &34 + &13 + &10;
               comando = "CALLERID: " + &34 + "Llama " + aLlamarTel + " <" + aLlamarTel+ ">" + &34;
               aMensaje = "0000" + comando;
               |MENAV aMensaje;
               |ALFACALLDLL "cecomsk.dll","cecomsk",comando;
               aMensaje = "0000" + comando;
               |MENAV aMensaje;
*/

               comando = "LLAMA:" + aLlamarTel;
               |ALFACALLDLL "cecomsk.dll","cecomsk",comando;
               |HAZ ResultadoCecom;
               |SI nError = 1;
                   aMensaje = "0000ERROR " + aRespuesta;
                   |MENAV aMensaje;
               |FINSI;

               comando = "TMAVISO:100";
               |ALFACALLDLL "cecomsk.dll","cecomsk",comando;

               comando = "LOGOFF";
               |ALFACALLDLL "cecomsk.dll","cecomsk",comando;
          |FINSI;
     |FINSI;
     comando = "TMAVISO:20";
     |ALFACALLDLL "cecomsk.dll","cecomsk",comando;
|FPRC;

|PROCESO ResultadoCecom;
     nError = 0;
     nCorrecto = 0;
     aRespuesta = "";

     aAux = comando % 105;
     |SI aAux = "ERROR";
          nError = 1;
          aRespuesta = comando % 7;
     |SINO;
          aAux = comando % 102;
          |SI aAux = "OK";
               nCorrecto = 1;
               aRespuesta = comando % 4;
          |SINO;
               aRespuesta = comando;
          |FINSI;
     |FINSI;
|FPRC;


|PROGRAMA;
     |ABRE #pbxpara5;
     |DDEFECTO #pbxpara5;
     |LEE 000#pbxpara5.p;
     aHost = #pbxpara5#1;
     |QBF aHost;
     aUsuAM = #pbxpara5#2;
     |QBF aUsuAM;
     aPassAM = #pbxpara5#3;
     |QBF aPassAM;
     aSwSuprimirCero = #pbxpara5#6;
     |QBF aSwSuprimirCero;
     |CIERRA #pbxpara5;

     aUsuario = Usuario % 810;
     |QBF aUsuario;

     |HAZ CopiaDll;

     |CARGADLL "cecomsk.dll";
     |SI FSalida < 0;
          aMensaje = "0000Problemas al cargar [cecomsk.dll]";
          |MENAV aMensaje;
     |FINSI;

     aExtension = "";
     |ABRE #pbxpara6;
     |DDEFECTO #pbxpara6;
     #pbxpara6#0 = aUsuario;
     |LEE 000#pbxpara6.=;
     |SI FSalida = 0;
          aExtension = #pbxpara6#1;
          |QBF aExtension;
     |FINSI;
     |CIERRA #pbxpara6;

     |DEBUG;

||     comando = "CANAL:" + aExtension;   || lo primero ... quien somos
||     |ALFACALLDLL "cecomsk.dll","cecomsk",comando;

     comando = "CONECTAR:" + aHost;
     |ALFACALLDLL "cecomsk.dll","cecomsk",comando;
     |HAZ ResultadoCecom;
     |SI nError = 1;
         aMensaje = "0000ERROR " + aRespuesta;
         |MENAV aMensaje;
     |FINSI;

/*
     comando = "LOGIN:" + aUsuAM + "," + aPassAM;
     |ALFACALLDLL "cecomsk.dll","cecomsk",comando;
     |HAZ ResultadoCecom;
     |SI nError = 1;
          aMensaje = "0000ERROR " + aRespuesta;
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     comando = "TMAVISO:300";
     |ALFACALLDLL "cecomsk.dll","cecomsk",comando;
*/

     comando = "DIRECTO:" + "Action: login" + &13 + &10 + "Events: off" + &13 + &10;
     comando = comando + "Username: admin" + &13 + &10 + "Secret: elastix456";
     |ALFACALLDLL "cecomsk.dll","cecomsk",comando;

     comando = "DIRECTO:" + "Action: COMMAND" + &13 + &10;
     comando = comando + "command: Show Channels concise" + &13 + &10;
     |ALFACALLDLL "cecomsk.dll","cecomsk",comando;

     comando = "DIRECTO:" + "Action: logoff" + &13 + &10;
     |ALFACALLDLL "cecomsk.dll","cecomsk",comando;
|FPRO;
