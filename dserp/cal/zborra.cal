||Zborra
|FICHEROS;
     zborra  #1;       ||Este Def

     referen@ #999;      ||Filtro Localizacion
|FIN;

|VARIABLES;
     aCarga = "";
     nHandle = 0;
     aEmp = "";
     aBaseDef      = "";
     aDirFiltros   = "";
     aNombreFiltro = "";
     aFuncion      = "";

     &EURODB  = 0;

     nLectura = 0;
     nWid     = 0;
     nId      = 0;
     nSid     = 0;
     nWidGuarda = 0;
     nIdGuarda  = 0;
     nSidGuarda = 0;

     aSerAC = "";
     nNumAC = 0;

     &nDeci_PreDiv = 0;
     nPPort1   = 0;
     nPPort2   = 0;
     &eaDocu   = "";

     aDirEmp = "";
     aDatos = "";

     &enSwMenu = 0;
     nAlbCompra = 0;
     aSerCompra = "";
     &cCodMonTrab = "";

     &enSwCreado = 0;

     nLinea = 0;
     nImpDiv = 0;
     nMult = 0;

     &aDivisa = "";
     &aMoneda = "";
     &eaProgVta = "";

     &enForma = 0;
     nSwHayCompras = 0;
     aDesdeCli = "";
     aHastaCli = "zzzzzz";

     &reimp    = "";
     &ser_fac  = "";
     &num_fac  = 0;
     &eaOrdenado = "";


     &enDesdeX = 0;
     &ser_alb  = "";
     &num_alb  = 0;
     &abo_alb  = "";
     &abono    = "";   || Lo utilizo en agifa014
     &fec_alb = @;

     informe1 = "agis0002";
     informe = "";

     &doc = 0;
     &ser = "";

     ||Para entregas a Cuenta
     &TipoCta = "";
     &SPedido = "";
     &NPedido = 0;
     &Cliente = "";
     &FPedido = @;

     aNum = "";

     aMensaje = "";
     aEjecuta = "";
     &enModo = 0;
     &eaCliente = "";
     &eaNomCli = "";
     aDesdeFac = "";
     aHastaFac = "";
     &eaSerAlb = "";
     &enNumAlb = 0;
     aSerie = "";
     aNumero = "";

     aEsc1          = "";
     aEsc2          = "";
     aRetu          = "";
     aTecla         = "";
     aBase          = "";
     aAlfa          = "";
     aAlfa1         = "";

     nPanta0        = 0;
     nPanta1        = 0;
     nPanta2        = 0;
     nVentana       = 0;

     nBoton0_1      = 0;
     nBoton1_1      = 0;
     nBoton1_2      = 0;
     nBoton1_3      = 0;
     nBoton2_1      = 0;
     nBoton2_2      = 0;
     nBoton2_3      = 0;
     nBoton2_4      = 0;
     nBoton2_5      = 0;
     nBoton2_6      = 0;
     nBoton2_7      = 0;
     nBoton2_8      = 0;
     nBoton2_9      = 0;
     nBoton2_10     = 0;
     nBoton2_11     = 0;

     nGrid1         = -1;
     nGrid2         = -1;
     nGrid3         = -1;

     nRango         = 0;
     nPos1          = 0;
     nPos2          = 0;
|FIN;


|PROGRAMA;
     |DEBUG;
     |HAZ Filtro;
|FPRO;

|PROCESO Filtro;

     |DFICE aAlfa;
     |QBF aAlfa;
     aEmp = aAlfa % -106;
     aEmp = aEmp % 105;

     |DBASE aBase;     |QBF aBase;
     aDirFiltros   = aBase + "filtros";                              |MKDIR aDirFiltros;
     aDirFiltros   = aDirFiltros + "/" + (("00000" + aEmp) % -105);  |MKDIR aDirFiltros;
     aDirFiltros   = aDirFiltros + "/";

     aNombreFiltro = "localiza.flt";
     aFuncion      = "{F:?" + aDirFiltros + aNombreFiltro + "}";

     |DBASE aBase;     |QBF aBase;
     aBaseDef  = aBase + "def/";
     aCarga    = aBaseDef + "zborra.mas";  |QBF aCarga;
     |CARGA_DEF aCarga, referen@;
     |SI FSalida = 0;
         |PATH_DAT #999 aDirFiltros;

         |ABRE #999;
         FSalida = aFuncion;
         |CONSULTA_CLAVE #1#999;
         |CIERRA #999;
         |DELINDEX #999;
     |FINSI;

     aAlfa = aDirFiltros + aNombreFiltro;
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         |MENAV "0000 El filtro no se ha creado correctamente. Vuelva a intentarlo.";
     |FINSI;
|FPRC;
