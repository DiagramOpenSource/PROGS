|FICHEROS;
   reemi100 #0;
   rem01001 #1;
   rem01002 #2;

   reacceso #90;
   rem00100 #91;
   rem00101 #92;
   rem01002 #93;
   repoblac #94;
   rehacien #95;
   rerenpre #96;
   reauxpai #97;
   rem00102 #98;

   rew00001 #99,MANTE;

   rem01010 #100;
   rem01011 #101;
   rem01012 #102;
   rem01014 #103;
   rem01018 #107;
   rem01019 #108;
   rem01021 #110;
   rem01022 #111;
   rem01023 #112;
   rem01024 #113;
   rem01025 #114;
   rem01026 #115;
   rem01027 #116;
   rem01030 #119;
   rem01031 #120;
   rem01032 #121;
   rem01033 #122;
   rem01037 #124;
   rem01041 #125;
   rem01042 #126;
   rem01043 #127;
   rem01035 #128;
   rem01045 #129;
   rem01046 #130;
   rem01047 #131;

   rew00055 #500;
   rem00998 #501;

   Referen@ #1000;
   Refere2@ #1002;
|FIN;

|VARIABLES;

     &enEmpresa     = 0;
     &enTipoEntrada = 0;

     &eaTipoEmi = "";
     &enMinEmp  = 0;
     &enMaxEmp  = 0;

     {1}aContiene = "";
     aDocRemoto    = "";
     aDocServidor  = "";
     aBorrAnt      = "";

     aEstCiv = "";
     fFecRef = @;
     nAnyo1  = 0;
     nAnyo2  = 0;
     nOrdenFall1 = 0;
     aFechaFall1 = "";
     nOrdenFall2 = 0;
     aFechaFall2 = "";
     FEstado = 0;
     nCambia = 0;
     nTitul  = 0;

     nPagAct = 0;
     nNumPag = 0;
     nCopia  = 0;
     nHijosTit = 0;
     nHijosCon = 0;
     nBotonUnidad = 0;

     SwCopia = 0;
     nNume   = 0;
     nCampo  = 0;
     nSusp   = 0;
     SwCambio = 0;
     nTotal  = 0;
     nTotal1 = 0;
     nLong   = 0;
     nCanal  = 0;
     nCont   = 0;
     nConta  = 0;
     nCont1  = 0;
     nCont2  = 0;
     nCont3  = 0;
     nCont10 = 0;
     nCalc   = 0;
     nCalc1  = 0;
     nCalc2  = 0;
     nCalc3  = 0;
     nConCta = 0;
     Calc    = 0;
     Calc1   = 0;
     Calc2   = 0;
     Long    = 0;
     LongDec = 0;
     nConver = 0;
     SwDatos = 0;
     &nSwDatos = 0;
     XCampos = 0;

     nNumLin1 = 0;
     nNumLin2 = 0;
     nNumActiv = 0;
     nNumPags = 0;
     nPag     = 0;

     nNumFam  = 0;
     nSwExt   = 0;
     nHandle  = 0;

     Casilla  = "";
     Casilla1 = "";
     Bloque  = 0;

     aHojas = "";
     aCDoc = "";
     aPDec = "";
     Modifica = "";
     &DiaInf  = "";
     MesNum   = "";
     &MesInf  = "";
     &EjerInf = "";
     DReimp   = "";
     HReimp   = "";

     aFamil   = "";
     aNombre  = "";
     aNombre1 = "";
     aNombre2 = "";
     aTipo    = "";
     aTipo2   = "";
     &aIP     = "";

     nDat    = 0;
     {10}aTit = "";
     {10}aPc1 = "";
     {10}aPc2 = "";
     {10}aRfC = "";
     {10}aSit = "";
     {10}aPc1b = "";
     {10}aPc2b = "";

     DEmpre   = 0;
     HEmpre   = 0;
     SwEstar  = 0;
     SwError  = 0;
     SwSalir  = 0;

     aOrigen  = "";
     aDestino = "";
     aFichero = "";
     aLong    = "";
     TipoDato = "";
     aAlfa    = "";
     aAlfa1   = "";
     aAlfa2   = "";
     aAlfa3   = "";
     aUnidad  = "";
     Cadena   = "";
     Cadena1  = "";
     Cadena2  = "";
     Cadena3  = "";
     Comodin  = "";
     Comodin1 = "";
     Comodin2 = "";
     Vacio1   = "";
     Vacio2   = "";

     nLinG = 0;
     nLinP = 0;

     &Handle   = 0;
     &VEmpresa = 0;
     &VTipo    = "";
     nNoHay   = 0;
     nNoHay1  = 0;
     nNoHay2  = 0;
     nNoHay3  = 0;
     nNoHay4  = 0;
     Nombre   = "";
     aNif     = "";
     aNif1      = ""; aNif2      = "";
     aApell11   = ""; aApell12   = "";
     aApell21   = ""; aApell22   = "";
     aC1        = ""; aC2        = "";
     aSg1       = ""; aSg2       = "";
     aCalle1    = ""; aCalle2    = "";
     aNumero1   = ""; aNumero2   = "";
     aEscalera1 = ""; aEscalera2 = "";
     aPiso1     = ""; aPiso2     = "";
     aPuerta1   = ""; aPuerta2   = "";
     aLocali1   = ""; aLocali2   = "";
     aLocalB1   = ""; aLocalB2   = "";
     aCP1       = ""; aCP2       = "";
     aProvin1   = ""; aProvin2   = "";
     aEC1       = ""; aEC2       = "";
     aAnyoN1    = ""; aAnyoN2    = "";
     aSexo1     = ""; aSexo2     = "";
     aMovil1    = ""; aMovil2    = "";
     aNivRe     = "";
     aSMS1      = ""; aSMS2      = "";
     aFAdoH     = ""; aFNacH     = "";
     aFNac1     = ""; aFNac2     = "";
     aCodPais1  = ""; aCodPais2  = "";
     aMinusval1 = ""; aMinusval2 = "";
     aTelef1    = ""; aTelef2    = "";
     aIglesia1  = ""; aIglesia2  = "";
     aEntidad1  = ""; aEntidad2  = "";
     aSucursal1 = ""; aSucursal2 = "";
     aDC1       = ""; aDC2       = "";
     aCuenta1   = ""; aCuenta2   = "";
     aDom2P     = ""; aFra2P     = "";
     aRen2P     = ""; &aSeparada = "";

     aFax1      = ""; aFax2      = "";
     aTipNum1   = ""; aTipNum2   = "";
     aCalNum1   = ""; aCalNum2   = "";
     aDatComp1  = ""; aDatComp2  = "";
     aBloque1   = ""; aBloque2   = "";
     aPortal1   = ""; aPortal2   = "";
     aDomExtr1  = ""; aDomExtr2  = "";
     aDtCmpEx1  = ""; aDtCmpEx2  = "";
     aPoblExt1  = ""; aPoblExt2  = "";
     aEmailExt1 = ""; aEmailExt2 = "";
     aCPExt1    = ""; aCPExt2    = "";
     aEstExt1   = ""; aEstExt2   = "";
     aPaisExt1  = ""; aPaisExt2  = "";
     aCdPaisEx1 = ""; aCdPaisEx2 = "";
     aTlfExtr1  = ""; aTlfExtr2  = "";
     aFaxExtr1  = ""; aFaxExtr2  = "";
     aMovExtr1  = ""; aMovExtr2  = "";
     aNifDc1    = ""; aNifDc2    = "";

     aNifH  = ""; aNombH = "";
     aAnyoH = ""; aMinuH = "";
     aVincH = ""; aOtroH = "";

     aFichRef = "";

     aNom   = "";
     aApel1 = "";
     aApel2 = "";
     aTipoContr = "";
     nInd   = 0;
     nNegativo = 0;

     nSalir  = 0;
     nPasada = 0;
     nPos    = 0;
     nContb  = 0;
     nBloq   = 0;
     nCalc4  = 0;
     nCharGrabados = 0;
     aPag    = "";

     &eaTipoSec = "";

{12}nDescend = 0;
{4}nAscend   = 0;

{200}&NEmpresas = "";
|FIN;

|PROCESO CargaDatos;
   aAlfa = VTipo; |QBF aAlfa;

   aSMS1      = ""; aSMS2      = "";
   aNif1      = ""; aNif2      = "";
   aApell11   = ""; aApell12   = "";
   aApell21   = ""; aApell22   = "";
   aC1        = ""; aC2        = "";
   aSg1       = ""; aSg2       = "";
   aCalle1    = ""; aCalle2    = "";
   aNumero1   = ""; aNumero2   = "";
   aEscalera1 = ""; aEscalera2 = "";
   aPiso1     = ""; aPiso2     = "";
   aPuerta1   = ""; aPuerta2   = "";
   aLocali1   = ""; aLocali2   = "";
   aLocalB1   = ""; aLocalB2   = "";
   aCP1       = ""; aCP2       = "";
   aProvin1   = ""; aProvin2   = "";
   aEC1       = ""; aEC2       = "";
   aAnyoN1    = ""; aAnyoN2    = "";
   aFNac1     = ""; aFNac2     = "";
   aSexo1     = ""; aSexo2     = "";
   aCodPais1  = "";  aCodPais2  = "";
   aMinusval1 = "0"; aMinusval2 = "";
   aTelef1    = "";  aTelef2    = "";
   aIglesia1  = "";  aIglesia2  = "";
   aMovil1    = "";  aMovil2    = "";

   aFax1      = "";  aFax2      = "";
   aTipNum1   = "";  aTipNum2   = "";
   aCalNum1   = "";  aCalNum2   = "";
   aDatComp1  = "";  aDatComp2  = "";
   aBloque1   = "";  aBloque2   = "";
   aPortal1   = "";  aPortal2   = "";
   aDomExtr1  = "";  aDomExtr2  = "";
   aDtCmpEx1  = "";  aDtCmpEx2  = "";
   aPoblExt1  = "";  aPoblExt2  = "";
   aEmailExt1 = "";  aEmailExt2 = "";
   aCPExt1    = "";  aCPExt2    = "";
   aEstExt1   = "";  aEstExt2   = "";
   aPaisExt1  = "";  aPaisExt2  = "";
   aCdPaisEx1 = "";  aCdPaisEx2 = "";
   aTlfExtr1  = "";  aTlfExtr2  = "";
   aFaxExtr1  = "";  aFaxExtr2  = "";
   aMovExtr1  = "";  aMovExtr2  = "";

   aAlfa1 = aAlfa - " FAMILIAR";
   |SI FSalida ! 0;
      aFamil = "S";
      |QBF aAlfa1; nCalc = aAlfa1;
      #rem00101#0 = #rem00100#0;
      #rem00101#1 = 1;
      |LEE 000#rem00101.];
      |PARA; |SI FSalida = 0; |Y #rem00101#0 = #rem00100#0; |HACIENDO;
         |SI #rem00101#13 = "S";
            nCalc = nCalc - 1;
            |SI nCalc = 0;
               |SI #rem00101#6 < 33;                        aMinusval1 = 0; |FINSI;
               |SI #rem00101#6 ] 33; |Y #rem00101#6 < 65;
                  |SI #rem00101#14 = "N"; aMinusval1 = 1; |SINO; aMinusval1 = 2; |FINSI;
               |FINSI;
               |SI #rem00101#6 ] 65;                        aMinusval1 = 3; |FINSI;
               |ABRE #repoblac;
               #repoblac#0 = #rem00100#20; #repoblac#1 = #rem00100#21;
               |LEE 000#repoblac.=;
               |SI FSalida ! 0; |DDEFECTO #repoblac; |FINSI;
               |CIERRA #repoblac;
               aNif1 = #rem00101#2;
               aAlfa = #rem00101#3; |HAZ SeparaNombre;
               aApell11 = aApel1;   aApell12 = aApel2;   aNombre1  = aNom;
               aC1        = #rem00101#16;   aSg1     = #rem00100#14;
               aCalle1    = #rem00100#15;   aNumero1 = #rem00100#16;
               aEscalera1 = #rem00100#17;   aPiso1   = #rem00100#18;
               aPuerta1   = #rem00100#19;   aLocali1 = #rem00100#22;
               aLocalB1   = #rem00100#119;
               aCP1       = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103)
               aProvin1 = #repoblac#2 ;
               aEC1       = "S";            aAnyoN1    = #rem00101#5;
               aFNac1     = #rem00101#17;   aSexo1     = #rem00101#20;
               aCodPais1  = #rem00100#107;  aTelef1    = #rem00100#12;
               aIglesia1  = #rem00100#59;   aCuenta1   = #rem00101#10;
               aMovil1    = #rem00100#109;  aSMS1      = #rem00100#111;
               aFax1      = #rem00100#112;  aTipNum1   = #rem00100#114;
               aCalNum1   = #rem00100#115;  aDatComp1  = #rem00100#118;
               aBloque1   = #rem00100#116;  aPortal1   = #rem00100#117;
               aDomExtr1  = #rem00100#120;  aDtCmpEx1  = #rem00100#121;
               aPoblExt1  = #rem00100#122;  aEmailExt1 = #rem00100#123;
               aCPExt1    = #rem00100#124;  aEstExt1   = #rem00100#125;
               aPaisExt1  = #rem00100#127;
               |ABRE #reauxpai;
               #reauxpai#0 = #rem00100#126;
               |LEE 000#reauxpai.=;
               |SI FSalida = 0; aCdPaisEx1 = #reauxpai#2; |SINO; aCdPaisEx1 = ""; |FINSI;
               |CIERRA #reauxpai;
               aTlfExtr1  = #rem00100#12;   aFaxExtr1  = #rem00100#112;
               aMovExtr1  = #rem00100#109;
            |SINO;
               |LEE 000#rem00101.s;
            |FINSI;
         |SINO;
            |LEE 000#rem00101.s;
         |FINSI;
      |SIGUE;
      aNif2      = "";   aNombre2 = "";
      aApell21   = "";   aApell22 = "";
      aC2        = "";   aSg2     = "";
      aCalle2    = "";   aNumero2 = "";
      aEscalera2 = "";   aPiso2   = "";
      aPuerta2   = "";   aLocali2 = "";
      aCP2       = "";   aSexo2   = "";
      aProvin2   = "";   aAnyoN2   = "";
      aFNac2     = "";   aCodPais2 = "";
      aMinusval2 = "0";  aTelef2   = "";
      aMovil2    = "";   aFax2      = "";
      aTipNum2   = "";   aCalNum2   = "";
      aDatComp2  = "";   aBloque2   = "";
      aPortal2   = "";   aDomExtr2  = "";
      aDtCmpEx2  = "";   aPoblExt2  = "";
      aEmailExt2 = "";   aCPExt2    = "";
      aEstExt2   = "";   aPaisExt2  = "";
      aCdPaisEx2 = "";   aTlfExtr2  = "";
      aFaxExtr2  = "";   aMovExtr2  = "";
      aAlfa = aCuenta1; |QBF aAlfa; |SI aAlfa = ""; aCuenta1 = "0" * 20; |FINSI;
      aAlfa = aCodPais1; |HAZ BuscaPais; aCodPais1 = aAlfa;

      |SI aSexo1 = "V"; aSexo1 = "H"; |FINSI;
      |SI aSexo1 = "";  aSexo1 = " "; |FINSI;
      |SI aSexo2 = "V"; aSexo2 = "H"; |FINSI;
      |SI aSexo2 = "";  aSexo2 = " "; |FINSI;
      |ACABA;
   |SINO;
      aFamil = "N";
   |FINSI;

   |SI aAlfa = "TITULAR"; |O aAlfa = "CONJUNTA";
      |SI #rem00100#8 < 33; aMinusval1 = 0; |FINSI;
      |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "N"; aMinusval1 = 1; |FINSI;
      |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "S"; aMinusval1 = 2; |FINSI;
      |SI #rem00100#8 ] 65; aMinusval1 = 3; |FINSI;
      |ABRE #repoblac;
      #repoblac#0 = #rem00100#20; #repoblac#1 = #rem00100#21;
      |LEE 000#repoblac.=;
      |SI FSalida ! 0; |DDEFECTO #repoblac; |FINSI;
      |CIERRA #repoblac;
      aNif1      = #rem00100#1;    aNombre1 = #rem00100#4;
      aApell11   = #rem00100#2;    aApell12 = #rem00100#3;
      aC1        = #rem00100#100;  aSg1     = #rem00100#14;
      aCalle1    = #rem00100#15;   aNumero1 = #rem00100#16;
      aEscalera1 = #rem00100#17;   aPiso1   = #rem00100#18;
      aPuerta1   = #rem00100#19;   aLocali1 = #rem00100#22;
      aLocalB1   = #rem00100#119;
      aCP1       = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103)
      aProvin1 = #repoblac#2;
      aEC1       = #rem00100#6;    aAnyoN1  = #rem00100#7;
      aFNac1     = #rem00100#103;  aSexo1   = #rem00100#105;
      aCodPais1  = #rem00100#107;  aTelef1  = #rem00100#12;
      aIglesia1  = #rem00100#59;   aMovil1  = #rem00100#109;
      aSMS1      = #rem00100#111;
      aFax1      = #rem00100#112;  aTipNum1   = #rem00100#114;
      aCalNum1   = #rem00100#115;  aDatComp1  = #rem00100#118;
      aBloque1   = #rem00100#116;  aPortal1   = #rem00100#117;
      aDomExtr1  = #rem00100#120;  aDtCmpEx1  = #rem00100#121;
      aPoblExt1  = #rem00100#122;  aEmailExt1 = #rem00100#123;
      aCPExt1    = #rem00100#124;  aEstExt1   = #rem00100#125;
      aPaisExt1  = #rem00100#127;
      |ABRE #reauxpai;
      #reauxpai#0 = #rem00100#126;
      |LEE 000#reauxpai.=;
      |SI FSalida = 0; aCdPaisEx1 = #reauxpai#2; |SINO; aCdPaisEx1 = ""; |FINSI;
      |CIERRA #reauxpai;
      aTlfExtr1  = #rem00100#12;   aFaxExtr1  = #rem00100#112;
      aMovExtr1  = #rem00100#109;
      |SI aAlfa = "TITULAR";  aCuenta1  = #rem00100#53; |FINSI;
      |SI aAlfa = "CONJUNTA"; aCuenta1  = #rem00100#55; |FINSI;

      |SI #rem00100#41 < 33; aMinusval2 = 0; |FINSI;
      |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "N"; aMinusval2 = 1; |FINSI;
      |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "S"; aMinusval2 = 2; |FINSI;
      |SI #rem00100#41 ] 65; aMinusval2 = 3; |FINSI;
      |ABRE #repoblac;
      #repoblac#0 = #rem00100#50; #repoblac#1 = #rem00100#51;
      |LEE 000#repoblac.=;
      |SI FSalida ! 0; |DDEFECTO #repoblac; |FINSI;
      |CIERRA #repoblac;
      aNif2      = #rem00100#35;   aNombre2 = #rem00100#38;
      aApell21   = #rem00100#36;   aApell22 = #rem00100#37;
      aC2        = #rem00100#101;  aSg2     = #rem00100#44;
      aCalle2    = #rem00100#45;   aNumero2 = #rem00100#46;
      aEscalera2 = #rem00100#47;   aPiso2   = #rem00100#48;
      aPuerta2   = #rem00100#49;   aLocali2 = #rem00100#52;
      aLocalB2   = #rem00100#136;
      aCP2       = (("00" + #rem00100#50) % -102) + (("000" + #rem00100#51) % -103);
      aProvin2   = #repoblac#2;    aAnyoN2   = #rem00100#40;
      aFNac2     = #rem00100#104;  aCodPais2 = #rem00100#108;
      aTelef2   = #rem00100#13;    aSexo2    = #rem00100#106;
      aIglesia2  = #rem00100#60;   aMovil2   = #rem00100#110;
      aSMS2      = #rem00100#128;
      aFax2      = #rem00100#129;  aTipNum2   = #rem00100#131;
      aCalNum2   = #rem00100#132;  aDatComp2  = #rem00100#118;
      aBloque2   = #rem00100#133;  aPortal2   = #rem00100#117;
      aDomExtr2  = #rem00100#137;  aDtCmpEx2  = #rem00100#138;
      aPoblExt2  = #rem00100#139;  aEmailExt2 = #rem00100#123;
      aCPExt2    = #rem00100#141;  aEstExt2   = #rem00100#142;
      aPaisExt2  = #rem00100#144;
      |ABRE #reauxpai;
      #reauxpai#0 = #rem00100#143;
      |LEE 000#reauxpai.=;
      |SI FSalida = 0; aCdPaisEx2 = #reauxpai#2; |SINO; aCdPaisEx2 = ""; |FINSI;
      |CIERRA #reauxpai;
      aTlfExtr2  = #rem00100#13;   aFaxExtr2  = #rem00100#129;
      aMovExtr2  = #rem00100#110;
      |SI aAlfa = "TITULAR";  aCuenta2  = #rem00100#54; |FINSI;
      |SI aAlfa = "CONJUNTA"; aCuenta2  = #rem00100#55; |FINSI;
   |FINSI;

   |SI aAlfa = "CONYUGE";
      |SI #rem00100#41 < 33; aMinusval1 = 0; |FINSI;
      |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "N"; aMinusval1 = 1; |FINSI;
      |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "S"; aMinusval1 = 2; |FINSI;
      |SI #rem00100#41 ] 65; aMinusval1 = 3; |FINSI;
      |ABRE #repoblac;
      #repoblac#0 = #rem00100#50; #repoblac#1 = #rem00100#51;
      |LEE 000#repoblac.=;
      |SI FSalida ! 0; |DDEFECTO #repoblac; |FINSI;
      |CIERRA #repoblac;
      aNif1      = #rem00100#35;   aNombre1 = #rem00100#38;
      aApell11   = #rem00100#36;   aApell12 = #rem00100#37;
      aC1        = #rem00100#101;  aSg1     = #rem00100#44;
      aCalle1    = #rem00100#45;   aNumero1 = #rem00100#46;
      aEscalera1 = #rem00100#47;   aPiso1   = #rem00100#48;
      aPuerta1   = #rem00100#49;   aLocali1 = #rem00100#52;
      aLocalB1   = #rem00100#136;
      aCP1       = (("00" + #rem00100#50) % -102) + (("000" + #rem00100#51) % -103);
      aEC1       = #rem00100#6;
      aProvin1   = #repoblac#2;    aAnyoN1  = #rem00100#40;
      aFNac1     = #rem00100#104;  aSexo1   = #rem00100#106;
      aCodPais1  = #rem00100#108;  aTelef1  = #rem00100#13;
      aIglesia1  = #rem00100#60;   aCuenta1   = #rem00100#54;
      aMovil1    = #rem00100#110;  aSMS1      = #rem00100#128;
      aFax1      = #rem00100#129;  aTipNum1   = #rem00100#131;
      aCalNum1   = #rem00100#132;  aDatComp1  = #rem00100#118;
      aBloque1   = #rem00100#133;  aPortal1   = #rem00100#117;
      aDomExtr1  = #rem00100#137;  aDtCmpEx1  = #rem00100#138;
      aPoblExt1  = #rem00100#139;  aEmailExt1 = #rem00100#123;
      aCPExt1    = #rem00100#141;  aEstExt1   = #rem00100#142;
      aPaisExt1  = #rem00100#144;
      |ABRE #reauxpai;
      #reauxpai#0 = #rem00100#143;
      |LEE 000#reauxpai.=;
      |SI FSalida = 0; aCdPaisEx1 = #reauxpai#2; |SINO; aCdPaisEx1 = ""; |FINSI;
      |CIERRA #reauxpai;
      aTlfExtr1  = #rem00100#13;   aFaxExtr1  = #rem00100#129;
      aMovExtr1  = #rem00100#110;
      |SI #rem00100#8 < 33; aMinusval2 = 0; |FINSI;
      |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "N"; aMinusval2 = 1; |FINSI;
      |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "S"; aMinusval2 = 2; |FINSI;
      |SI #rem00100#8 ] 65; aMinusval2 = 3; |FINSI;
      #repoblac#0 = #rem00100#20; #repoblac#1 = #rem00100#21;
      |LEE 000#repoblac.=;
      aNif2      = #rem00100#1;    aNombre2 = #rem00100#4;
      aApell21   = #rem00100#2;    aApell22 = #rem00100#3;
      aC2        = #rem00100#100;  aSg2     = #rem00100#14;
      aCalle2    = #rem00100#15;   aNumero2 = #rem00100#16;
      aEscalera2 = #rem00100#17;   aPiso2   = #rem00100#18;
      aPuerta2   = #rem00100#19;   aLocali2 = #rem00100#22;
      aLocalB2   = #rem00100#119;
      aCP2       = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103);
      aProvin2 = #repoblac#2;      aAnyoN2    = #rem00100#7;
      aFNac2     = #rem00100#103;  aCodPais2 = #rem00100#107;
      aTelef2  = #rem00100#12;     aSexo2    = #rem00100#105;
      aIglesia2  = #rem00100#59;   aCuenta2 = #rem00100#53;
      aMovil2    = #rem00100#109;  aSMS2    = #rem00100#111;
      aFax2      = #rem00100#112;  aTipNum2   = #rem00100#114;
      aCalNum2   = #rem00100#115;  aDatComp2  = #rem00100#118;
      aBloque2   = #rem00100#116;  aPortal2   = #rem00100#117;
      aDomExtr2  = #rem00100#120;  aDtCmpEx2  = #rem00100#121;
      aPoblExt2  = #rem00100#122;  aEmailExt2 = #rem00100#123;
      aCPExt2    = #rem00100#124;  aEstExt2   = #rem00100#125;
      aPaisExt2  = #rem00100#127;
      |ABRE #reauxpai;
      #reauxpai#0 = #rem00100#126;
      |LEE 000#reauxpai.=;
      |SI FSalida = 0; aCdPaisEx2 = #reauxpai#2; |SINO; aCdPaisEx2 = ""; |FINSI;
      |CIERRA #reauxpai;
      aTlfExtr2  = #rem00100#12;   aFaxExtr2  = #rem00100#112;
      aMovExtr2  = #rem00100#109;
   |FINSI;

   |SI aAlfa = "CONJUNTAE";
      |SI #rem00100#91 = "T";
         |SI #rem00100#41 < 33; aMinusval1 = 0; |FINSI;
         |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "N"; aMinusval1 = 1; |FINSI;
         |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "S"; aMinusval1 = 2; |FINSI;
         |SI #rem00100#41 ] 65; aMinusval1 = 3; |FINSI;
         |ABRE #repoblac;
         #repoblac#0 = #rem00100#50; #repoblac#1 = #rem00100#51;
         |LEE 000#repoblac.=;
         |SI FSalida ! 0; |DDEFECTO #repoblac; |FINSI;
         |CIERRA #repoblac;
         aNif1      = #rem00100#35;   aNombre1 = #rem00100#38;
         aApell11   = #rem00100#36;   aApell12 = #rem00100#37;
         aC1        = #rem00100#101;  aSg1     = #rem00100#44;
         aCalle1    = #rem00100#45;   aNumero1 = #rem00100#46;
         aEscalera1 = #rem00100#47;   aPiso1   = #rem00100#48;
         aPuerta1   = #rem00100#49;   aLocali1 = #rem00100#52;
         aLocalB1   = #rem00100#136;
         aCP1       = (("00" + #rem00100#50) % -102) + (("000" + #rem00100#51) % -103);
         aEC1       = "V";            aSexo1   = #rem00100#106;
         aProvin1   = #repoblac#2;    aAnyoN1  = #rem00100#40;
         aFNac1     = #rem00100#104;  aCodPais1 = #rem00100#108;
         aTelef1    = #rem00100#13;   aMovil1   = #rem00100#110;
         aIglesia1  = #rem00100#60;   aCuenta1 = #rem00100#54;
         aSMS1      = #rem00100#128;
         aFax1      = #rem00100#129;  aTipNum1   = #rem00100#131;
         aCalNum1   = #rem00100#132;  aDatComp1  = #rem00100#118;
         aBloque1   = #rem00100#133;  aPortal1   = #rem00100#117;
         aDomExtr1  = #rem00100#137;  aDtCmpEx1  = #rem00100#138;
         aPoblExt1  = #rem00100#139;  aEmailExt1 = #rem00100#123;
         aCPExt1    = #rem00100#141;  aEstExt1   = #rem00100#142;
         aPaisExt1  = #rem00100#144;
         |ABRE #reauxpai;
         #reauxpai#0 = #rem00100#143;
         |LEE 000#reauxpai.=;
         |SI FSalida = 0; aCdPaisEx1 = #reauxpai#2; |SINO; aCdPaisEx1 = ""; |FINSI;
         |CIERRA #reauxpai;

         aTlfExtr1  = #rem00100#13;   aFaxExtr1  = #rem00100#129;
         aMovExtr1  = #rem00100#110;
      |SINO;
         |SI #rem00100#8 < 33; aMinusval1 = 0; |FINSI;
         |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "N"; aMinusval1 = 1; |FINSI;
         |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "S"; aMinusval1 = 2; |FINSI;
         |SI #rem00100#8 ] 65; aMinusval1 = 3; |FINSI;
         |ABRE #repoblac;
         #repoblac#0 = #rem00100#20; #repoblac#1 = #rem00100#21;
         |LEE 000#repoblac.=;
         |SI FSalida ! 0; |DDEFECTO #repoblac; |FINSI;
         |CIERRA #repoblac;
         aNif1      = #rem00100#1;    aNombre1 = #rem00100#4;
         aApell11   = #rem00100#2;    aApell12 = #rem00100#3;
         aC1        = #rem00100#100;  aSg1     = #rem00100#14;
         aCalle1    = #rem00100#15;   aNumero1 = #rem00100#16;
         aEscalera1 = #rem00100#17;   aPiso1   = #rem00100#18;
         aPuerta1   = #rem00100#19;   aLocali1 = #rem00100#22;
         aLocalB1   = #rem00100#119;
         aCP1       = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103);
         aProvin1   = #repoblac#2;
         aEC1       = "V";            aAnyoN1  = #rem00100#7;
         aFNac1     = #rem00100#103;  aSexo1   = #rem00100#105;
         aCodPais1  = #rem00100#107;  aTelef1  = #rem00100#12;
         aIglesia1  = #rem00100#60;   aCuenta1 = #rem00100#53;
         aMovil1    = #rem00100#109;  aSMS1    = #rem00100#111;
         aFax1      = #rem00100#112;  aTipNum1   = #rem00100#114;
         aCalNum1   = #rem00100#115;  aDatComp1  = #rem00100#118;
         aBloque1   = #rem00100#116;  aPortal1   = #rem00100#117;
         aDomExtr1  = #rem00100#120;  aDtCmpEx1  = #rem00100#121;
         aPoblExt1  = #rem00100#122;  aEmailExt1 = #rem00100#123;
         aCPExt1    = #rem00100#124;  aEstExt1   = #rem00100#125;
         aPaisExt1  = #rem00100#127;  aCdPaisEx1 = #rem00100#126;
         |ABRE #reauxpai;
         #reauxpai#0 = #rem00100#126;
         |LEE 000#reauxpai.=;
         |SI FSalida = 0; aCdPaisEx1 = #reauxpai#2; |SINO; aCdPaisEx1 = ""; |FINSI;
         |CIERRA #reauxpai;
         aTlfExtr1  = #rem00100#12;   aFaxExtr1  = #rem00100#112;
         aMovExtr1  = #rem00100#109;
      |FINSI;
      aNif2      = "";   aNombre2 = "";
      aApell21   = "";   aApell22 = "";
      aC2        = "";   aSg2     = "";
      aCalle2    = "";   aNumero2 = "";
      aEscalera2 = "";   aPiso2   = "";
      aPuerta2   = "";   aLocali2 = "";
      aLocalB2   = "";
      aCP2       = "";   aSMS2    = "";
      aProvin2   = "";   aAnyoN2  = "";
      aMinusval2 = "0";  aTelef2  = "";
      aIglesia2  = "";   aCuenta2 = "";
      aMovil2    = "";   aSexo2   = "";
      aFax2      = "";
      aTipNum2   = "";   aCalNum2   = "";
      aDatComp2  = "";   aBloque2   = "";
      aPortal2   = "";   aDomExtr2  = "";
      aDtCmpEx2  = "";   aPoblExt2  = "";
      aEmailExt2 = "";   aCPExt2    = "";
      aEstExt2   = "";   aPaisExt2  = "";
      aCdPaisEx2 = "";   aTlfExtr2  = "";
      aFaxExtr2  = "";   aMovExtr2  = "";
   |FINSI;

   aAlfa = aCuenta1; |QBF aAlfa; |SI aAlfa = ""; aCuenta1 = "0" * 20; |FINSI;
   aAlfa = aCuenta2; |QBF aAlfa; |SI aAlfa = ""; aCuenta2 = "0" * 20; |FINSI;

   |QBF aTelef1; |QBF aTelef2;

   |SI aC1 = "X"; |O aC1 = "Z";
      |SI aTelef1 = ""; aTelef1 = aTelef2; |FINSI;
   |FINSI;
   |SI aC2 = "X"; |O aC2 = "Z";
      |SI aTelef2 = ""; aTelef2 = aTelef1; |FINSI;
   |FINSI;

   |SI #0#34 = "F";
      |SI aC1 = "X";  |O aC1 = "Z";
         aSg1     = ""; aCalle1  = ""; aNumero1 = ""; aEscalera1 = "";
         aPiso1   = ""; aPuerta1 = ""; aLocali1 = ""; aCP1       = "";
         aProvin1 = "";                aFNac1   = ""; aSexo1     = "";
         aCodPais1  = ""; aMovil1 = "";
      |FINSI;
      |SI aC2 = "X"; |O aC2 = "Z";
         aSg2     = ""; aCalle2  = ""; aNumero2 = ""; aEscalera2 = "";
         aPiso2   = ""; aPuerta2 = ""; aLocali2 = ""; aCP2       = "";
         aProvin2 = ""; aSexo2   = ""; aFNac2   = ""; aCodPais2  = "";
         aMovil2  = "";
      |FINSI;
   |FINSI;

   aAlfa = aCodPais1; |HAZ BuscaPais; aCodPais1 = aAlfa;
   aAlfa = aCodPais2; |HAZ BuscaPais; aCodPais2 = aAlfa;

   TipoDato = "F"; aAlfa = aFNac1; |HAZ Formateo; aFNac1 = aAlfa;
   TipoDato = "F"; aAlfa = aFNac2; |HAZ Formateo; aFNac2 = aAlfa;
   TipoDato = "F"; aAlfa = aFNacH; |HAZ Formateo; aFNacH = aAlfa;
   TipoDato = "F"; aAlfa = aFAdoH; |HAZ Formateo; aFAdoH = aAlfa;
   |SI aFNac1 = "          "; aFNac1 = "00000000"; |FINSI;
   |SI aFNac2 = "          "; aFNac2 = "00000000"; |FINSI;
   |SI aFNacH = "          "; aFNacH = "00000000"; |FINSI;
   |SI aFAdoH = "          "; aFAdoH = "00000000"; |FINSI;

   |SI aSexo1 = "V"; aSexo1 = "H"; |FINSI;
   |SI aSexo1 = "";  aSexo1 = " "; |FINSI;
   |SI aSexo2 = "V"; aSexo2 = "H"; |FINSI;
   |SI aSexo2 = "";  aSexo2 = " "; |FINSI;

   nCambia = 0;
   |SI aSg1 ! aSg2; |O aCalle1 ! aCalle2; |O aNumero1 ! aNumero2;
    |O aEscalera1 ! aEscalera2; |O aPiso1 ! aPiso2; |O aPuerta1 ! aPuerta2;
    |O aLocali1 ! aLocali2;
      nCambia = 1;
   |FINSI;

   aAlfa = VTipo; |QBF aAlfa;
   |SI aAlfa = "CONJUNTA"; |O aAlfa = "CONJUNTAE";
      |SI nCambia = 0;
         aSg2       = ""; aCalle2    = "";
         aNumero2   = ""; aEscalera2 = "";
         aPiso2     = ""; aPuerta2   = ""; aLocali2   = "";
         aLocalB2   = ""; aCP2       = ""; aProvin2   = "";
         aCodPais2  = ""; aTipNum2   = ""; aCalNum2   = "";
         aDatComp2  = ""; aBloque2   = ""; aPortal2   = "";
         aDomExtr2  = ""; aDtCmpEx2  = ""; aPoblExt2  = "";
         aCPExt2    = ""; aEstExt2   = "";
         aPaisExt2  = ""; aCdPaisEx2 = "";
      |FINSI;
   |FINSI;
   |SI aAlfa ! "CONJUNTA"; |Y aAlfa ! "CONJUNTAE";
      aSg2       = ""; aCalle2    = "";
      aNumero2   = ""; aEscalera2 = "";
      aPiso2     = ""; aPuerta2   = ""; aLocali2   = "";
      aLocalB2   = ""; aCP2       = ""; aProvin2   = "";
      aCodPais2  = ""; aTipNum2   = ""; aCalNum2   = "";
      aDatComp2  = ""; aBloque2   = ""; aPortal2   = "";
      aDomExtr2  = ""; aDtCmpEx2  = ""; aPoblExt2  = "";
      aCPExt2    = ""; aEstExt2   = "";
      aPaisExt2  = ""; aCdPaisEx2 = "";
   |FINSI;
|FPRC;

|PROCESO RecogeFam;
   |SI #rem00101#4 = "DESCENDIENTE";
      nDescend = #rem00101#1; InDescend = InDescend + 1;
      |SI #rem00101#16 = "X"; |O #rem00101#16 = "Z";
         aCDoc = "1";
      |FINSI;
      |SI #rem00101#16 = "D"; |O #rem00101#16 = "Z";
         aPDec = "1";
      |FINSI;
   |SINO;
      nAscend = #rem00101#1;  InAscend = InAscend + 1;
   |FINSI;
|FPRC;

|DEFBUCLE RecogeFam;
#rem00101#1;
;
#rem00100#0,01;
#rem00100#0,99;
;
NULL,RecogeFam;
|FIN;

|PROCESO Hoja01;
   Cadena = "";
   |ABRE #rem00100;
   #rem00100#0 = VEmpresa;
   |LEE 000#rem00100.=;
   |SI FSalida = 0;
      |HAZ CargaDatos;
   |FINSI;
   |CIERRA #rem00100;

   LongDec = 0;
   Cadena = "<T10001> ";

   ||TITULAR
   || Nif del primer declarante
   TipoDato = "An"; Long = 9;  aAlfa = aNif1;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Apellido 1 del primer declarante
   TipoDato = "A";  Long = 15; aAlfa = aApell11;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Apellido 2 del primer declarante
   TipoDato = "A";  Long = 15; aAlfa = aApell12;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Nombre del primer declarante
   TipoDato = "A";  Long = 15; aAlfa = aNombre1;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Sexo
   Cadena = Cadena + aSexo1;
   || Estado civil del declarante
   aAlfa = " ";
   |SI aEC1 = "S"; aAlfa = "1"; aSexo2 = " "; |FINSI;
   |SI aEC1 = "C"; aAlfa = "2";               |FINSI;
   |SI aEC1 = "V"; aAlfa = "3"; aSexo2 = " "; |FINSI;
   |SI aEC1 = "L"; aAlfa = "4"; aSexo2 = " "; |FINSI;
   aEstCiv = aAlfa;

   aTipo = VTipo % 0110;
   |SI #rem00100#91 = "C"; |Y aAlfa = "2";
      |SI aTipo = "TITULAR   "; |O aTipo = "CONJUNTA  "; |O aTipo = "CONJUNTAE ";
         aAlfa = "3";
         aNif2      = ""; aApell21   = "";
         aApell22   = ""; aC2        = "";
         aSg2       = ""; aCalle2    = "";
         aNumero2   = ""; aEscalera2 = "";
         aPiso2     = ""; aPuerta2   = "";
         aLocali2   = ""; aCP2       = "";
         aProvin2   = ""; aEC2       = "";
         aAnyoN2    = ""; aFNac2     = "";
         aCodPais2  = ""; aMinusval2 = "";
         aTelef2    = ""; aIglesia2  = "";
         aNombre2   = ""; aSexo2     = " ";
         aMovil2    = ""; aFax2      = "";
         aTipNum2   = ""; aCalNum2   = "";
         aDatComp2  = ""; aBloque2   = "";
         aPortal2   = ""; aDomExtr2  = "";
         aDtCmpEx2  = ""; aPoblExt2  = "";
         aEmailExt2 = ""; aCPExt2    = "";
         aEstExt2   = ""; aPaisExt2  = "";
         aCdPaisEx2 = ""; aTlfExtr2  = "";
         aFaxExtr2  = ""; aMovExtr2  = "";
      |FINSI;
   |FINSI;
   |SI #rem00100#91 = "T"; |Y aAlfa = "2";
      |SI aTipo = "CONYUGE   "; |O aTipo = "CONJUNTAE ";
         aAlfa = "3";
         aNif2      = ""; aApell21   = "";
         aApell22   = ""; aC2        = "";
         aSg2       = ""; aCalle2    = "";
         aNumero2   = ""; aEscalera2 = "";
         aPiso2     = ""; aPuerta2   = "";
         aLocali2   = ""; aCP2       = "";
         aProvin2   = ""; aEC2       = "";
         aAnyoN2    = ""; aFNac2     = "";
         aCodPais2  = ""; aMinusval2 = "";
         aTelef2    = ""; aIglesia2  = "";
         aNombre2   = ""; aSexo2     = " ";
         aMovil2    = ""; aFax2      = "";
         aTipNum2   = ""; aCalNum2   = "";
         aDatComp2  = ""; aBloque2   = "";
         aPortal2   = ""; aDomExtr2  = "";
         aDtCmpEx2  = ""; aPoblExt2  = "";
         aEmailExt2 = ""; aCPExt2    = "";
         aEstExt2   = ""; aPaisExt2  = "";
         aCdPaisEx2 = ""; aTlfExtr2  = "";
         aFaxExtr2  = ""; aMovExtr2  = "";
      |FINSI;
   |FINSI;

   Cadena = Cadena + aAlfa;
   || Fecha nacimiento
   TipoDato = "F";  Long = 8;  aAlfa = aFNac1;    |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Grado de minusvalia del declarante
   TipoDato = "N";  Long = 1;  aAlfa = aMinusval1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Suscripcion servicio mensajes SMS
   |SI aSMS1 = "S";
      Cadena = Cadena + "1";
   |SINO;
      Cadena = Cadena + "0";
   |FINSI;
   || Tipo de la via del primer declarante
   TipoDato = "An";  Long = 5;  aAlfa = aSg1;       |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Codigo de la via del primer declarante INE
   Cadena = Cadena + "00000";
   || Nombre de la via del primer declarante
   TipoDato = "An";  Long = 50; aAlfa = aCalle1;    |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Tipo de numeracion del primer declarante
   TipoDato = "An"; Long = 3;  aAlfa = aTipNum1;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Numero del primer declarante
   TipoDato = "N"; Long = 5;  aAlfa = aNumero1;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Calificador de numeracion del primer declarante
   TipoDato = "An"; Long = 3;  aAlfa = aCalNum1;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Bloque del primer declarante
   TipoDato = "An"; Long = 3;  aAlfa = aBloque1;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Portal del primer declarante
   TipoDato = "An"; Long = 3;  aAlfa = aPortal1;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Escalera del primer declarante
   TipoDato = "An"; Long = 3;  aAlfa = aEscalera1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Piso del primer declarante
   TipoDato = "An"; Long = 3;  aAlfa = aPiso1;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Puerta del primer declarante
   TipoDato = "An"; Long = 3;  aAlfa = aPuerta1;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Datos complementarios del domicilio del primer declarante
   TipoDato = "An"; Long = 40; aAlfa = aDatComp1;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Municipio del primer declarante
   TipoDato = "An"; Long = 30; aAlfa = aLocalB1;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Codigo postal del primer declarante
   aAlfa = aCP1; |QBF aAlfa; |SI aAlfa = ""; aAlfa = "00000"; |FINSI; Cadena = Cadena + aAlfa;
   || Codigo municipio INE
   Cadena = Cadena + "00000";
   |HAZ GrabaCad;

   || Nombre del municipio
   TipoDato = "An"; Long = 30; aAlfa = aLocali1;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Codigo provincia del primer declarante
   aAlfa = aCP1; |QBF aAlfa; aAlfa = aAlfa % 0102;
   aAlfa = ("00" + aAlfa) % -102;                  Cadena = Cadena + aAlfa;
   || Nombre de la provincia del primer declarante
   TipoDato = "An"; Long = 20;  aAlfa = aProvin1;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Telefonos de contacto : Telefono fijo Titular
   TipoDato = "N";  Long = 9;   aAlfa = aTelef1;    |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Telefonos de contacto : Telefono movil Titular
   TipoDato = "N";  Long = 9;   aAlfa = aMovil1;    |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Telefonos de contacto : Fax Titular
   TipoDato = "N";  Long = 9;   aAlfa = aFax1;       |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Domicilio extranjero del primer declarante

   TipoDato = "An";  Long = 50;  aAlfa = aDomExtr1;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Datos complementarios del domicilio extranjero del primer declarante
                    Long = 40;  aAlfa = aDtCmpEx1;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Poblacion extranjera del primer declarante
                    Long = 30;  aAlfa = aPoblExt1;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || E-mail extranjero del primer declarante
                    Long = 99;  aAlfa = aEmailExt1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   Cadena = Cadena + " ";
   || Codigo postal extranjero del primer declarante
                    Long = 10;  aAlfa = aCPExt1;    |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Provincia/region/estado extranjero del primer declarante
                    Long = 30;  aAlfa = aEstExt1;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pais extranjero del primer declarante
                    Long = 30;  aAlfa = aPaisExt1;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Codigo Pais extranjero del primer declarante
   TipoDato = "An"; Long = 2;   aAlfa = aCdPaisEx1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |QBF aPoblExt1; |QBF aEstExt1;
   |SI aPoblExt1 ! ""; |O aEstExt1 ! "";
      || Telefono fijo extranjero del primer declarante
      TipoDato = "A";  Long = 15;  aAlfa = aTlfExtr1;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Telefono movil extranjero del primer declarante
                       Long = 15;  aAlfa = aMovExtr1;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Fax extranjero del primer declarante
                       Long = 15;  aAlfa = aFaxExtr1;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |SINO;
      Cadena = Cadena + (" " * 45);
   |FINSI;
   |HAZ GrabaCad;

   |PARA nConta = 0; |SI nConta < 10; |HACIENDO nConta = nConta + 1;
      IaTit = aTit1<-; IaPc1 = aPc11<-; IaPc2 = aPc21<-;
      IaPc1b = aPc1b1<-; IaPc2b = aPc2b1<-;
      IaRfC = aRfC1<-; IaSit = aSit1<-;
      IaTit = IaTit + nConta; IaPc1 = IaPc1 + nConta;
      IaPc2 = IaPc2 + nConta; IaRfC = IaRfC + nConta;
      IaSit = IaSit + nConta;
      IaPc1b = IaPc1b + nConta; IaPc2b = IaPc2b + nConta;

      aTit = ""; aPc1 = ""; aPc2 = ""; aRfC = ""; aSit = "";
      aPc1b = ""; aPc2b = "";
   |SIGUE;

   aTipo = VTipo % 0110; |QBF aTipo; nDat  = 0;
   |ABRE #rem00102;
   #rem00102#0 = VEmpresa;
   #rem00102#1 = 1;
   |LEE 000#rem00102.];
   |PARA; |SI FSalida = 0; |Y #rem00102#0 = VEmpresa; |HACIENDO;
      |SI nDat ] 9; |SAL; |FINSI;

      IaTit = aTit1<-; IaPc1 = aPc11<-; IaPc2 = aPc21<-;
      IaPc1b = aPc1b1<-; IaPc2b = aPc2b1<-;
      IaRfC = aRfC1<-; IaSit = aSit1<-;
      IaTit = IaTit + nDat; IaPc1 = IaPc1 + nDat;
      IaPc2 = IaPc2 + nDat; IaRfC = IaRfC + nDat;
      IaSit = IaSit + nDat;
      IaPc1b = IaPc1b + nDat; IaPc2b = IaPc2b + nDat;

      aAlfa = aTipo; |QBF aAlfa; aAlfa = aAlfa - "FAMILIAR";
      |SI FSalida ! 0;
         aAlfa = #rem00102#2; |QBF aAlfa; aAlfa = aAlfa - "FAMILIAR";
         |SI FSalida ! 0;
            aTit = #rem00102#9; aPc1 = 0; aPc2 = 0; aRfC = #rem00102#11;
            aSit = #rem00102#14;
            nDat = nDat + 1;
         |FINSI;
      |SINO;
         |SI aTipo = "TITULAR"; |O aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
            |SI #rem00100#91 = " ";
               aTit = #rem00102#9;
               |SI #rem00102#2 = "TITULAR   "; aPc1 = 100; aPc2 = 0;   |FINSI;
               |SI #rem00102#2 = "CONYUGE   "; aPc1 = 0;   aPc2 = 100; |FINSI;
               |SI #rem00102#2 = "GANANCIAL "; aPc1 = 50;  aPc2 = 50;  |FINSI;
               |SI #rem00102#2 = "VARIOS    "; aPc1 = #rem00102#3; aPc2 = #rem00102#4; |FINSI;
               aRfC = #rem00102#11;
               aSit = #rem00102#14;
               aAlfa = #rem00102#2; |QBF aAlfa; aAlfa = aAlfa - "FAMILIAR";
               |SI FSalida ! 0;
                  aRfC = ""; aTit = ""; aPc1 = ""; aPc2 = ""; aSit = "";
               |SINO;
                  nDat = nDat + 1;
               |FINSI;
            |SINO;
               |SI aTipo = "CONJUNTAE";
                  |SI #rem00102#13 = "F";
                     aTit = #rem00102#9;
                     |SI #rem00102#2 = "TITULAR   "; aPc1 = 100; aPc2 = 0;   |FINSI;
                     |SI #rem00102#2 = "CONYUGE   "; aPc1 = 0;   aPc2 = 100; |FINSI;
                     |SI #rem00102#2 = "GANANCIAL "; aPc1 = 50;  aPc2 = 50;  |FINSI;
                     |SI #rem00102#2 = "VARIOS    "; aPc1 = #rem00102#3; aPc2 = #rem00102#4;  |FINSI;
                     aRfC = #rem00102#11;
                     aSit = #rem00102#14;
                     aAlfa = #rem00102#2; |QBF aAlfa; aAlfa = aAlfa - "FAMILIAR";
                     |SI FSalida ! 0;
                        aRfC = ""; aTit = ""; aPc1 = ""; aPc2 = ""; aSit = "";
                     |SINO;
                        nDat = nDat + 1;
                     |FINSI;
                  |FINSI;
               |SINO;
                  |SI #rem00102#13 = " ";
                     aTit = #rem00102#9;
                     |SI #rem00102#2 = "TITULAR   "; aPc1 = 100; aPc2 = 0;   |FINSI;
                     |SI #rem00102#2 = "CONYUGE   "; aPc1 = 0;   aPc2 = 100; |FINSI;
                     |SI #rem00102#2 = "GANANCIAL "; aPc1 = 50;  aPc2 = 50;  |FINSI;
                     |SI #rem00102#2 = "VARIOS    "; aPc1 = #rem00102#3; aPc2 = #rem00102#4;  |FINSI;
                     aRfC = #rem00102#11;
                     aSit = #rem00102#14;
                     aAlfa = #rem00102#2; |QBF aAlfa; aAlfa = aAlfa - "FAMILIAR";
                     |SI FSalida ! 0;
                        aRfC = ""; aTit = ""; aPc1 = ""; aPc2 = ""; aSit = "";
                     |SINO;
                        nDat = nDat + 1;
                     |FINSI;
                  |FINSI;
               |FINSI;
            |FINSI;
         |FINSI;
         |SI aTipo = "CONYUGE";
            |SI #rem00100#91 = " ";
               aTit = #rem00102#9;
               |SI #rem00102#2 = "TITULAR   "; aPc1 = 0;   aPc2 = 100; |FINSI;
               |SI #rem00102#2 = "CONYUGE   "; aPc1 = 100; aPc2 = 0;   |FINSI;
               |SI #rem00102#2 = "GANANCIAL "; aPc1 = 50;  aPc2 = 50;  |FINSI;
               |SI #rem00102#2 = "VARIOS    "; aPc1 = #rem00102#4; aPc2 = #rem00102#3;  |FINSI;
               aRfC = #rem00102#11;
               aSit = #rem00102#14;
               aAlfa = #rem00102#2; |QBF aAlfa; aAlfa = aAlfa - "FAMILIAR";
               |SI FSalida ! 0;
                  aRfC = ""; aTit = ""; aPc1 = ""; aPc2 = ""; aSit = "";
               |SINO;
                  nDat = nDat + 1;
               |FINSI;
            |SINO;
               |SI #rem00102#13 = " ";
                  aTit = #rem00102#9;
                  |SI #rem00102#2 = "TITULAR   "; aPc1 = 100; aPc2 = 0;   |FINSI;
                  |SI #rem00102#2 = "CONYUGE   "; aPc1 = 0;   aPc2 = 100; |FINSI;
                  |SI #rem00102#2 = "GANANCIAL "; aPc1 = 50;  aPc2 = 50;  |FINSI;
                  |SI #rem00102#2 = "VARIOS    "; aPc1 = #rem00102#3; aPc2 = #rem00102#4;  |FINSI;
                  aRfC = #rem00102#11;
                  aSit = #rem00102#14;
                  aAlfa = #rem00102#2; |QBF aAlfa; aAlfa = aAlfa - "FAMILIAR";
                  |SI FSalida ! 0;
                     aRfC = ""; aTit = ""; aPc1 = ""; aPc2 = ""; aSit = "";
                  |SINO;
                     nDat = nDat + 1;
                  |FINSI;
               |FINSI;
            |FINSI;
         |FINSI;
         aPc1b = aPc1; aPc2b = aPc2;
         |SI aTit = "3"; |O aTit = "4";
            aPc1 = 0; aPc2 = 0;
         |FINSI;
      |FINSI;
      |LEE 000#rem00102.s;
   |SIGUE;
   |CIERRA #rem00102;

   nTitul = 0;
   IaTit = aTit1<-; IaPc1 = aPc11<-; IaPc2 = aPc21<-;
   IaRfC = aRfC1<-; IaSit = aSit1<-; IaPc1b = aPc1b1<-; IaPc2b = aPc2b1<-;
   |PARA nConta = 0; |SI nConta < 10; |HACIENDO nConta = nConta + 1;
      LongDec = 0;
      |SI aTipo = "TITULAR"; |O aTipo = "CONYUGE"; || nCalc = aPc1b; |FINSI;
      |O aTipo = "CONJUNTA"; |O aTipo = "VARIOS"; |O aTipo = "CONJUNTAE";
          nCalc = aPc1b + aPc2b;
      |FINSI;
      |SI nCalc ! 0;
         nTitul = nTitul + 1;
         || Titularidad X
         TipoDato = "N"; Long = 1;  aAlfa = aTit;     |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Porcentaje participacion 1 (X)
         LongDec = 2;
         TipoDato = "N"; Long = 3;  aAlfa = aPc1;     |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Porcentaje participacion 2 (X)
         TipoDato = "N"; Long = 3;  aAlfa = aPc2;     |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Situacion (clave)
         LongDec = 0;
         TipoDato = "N"; Long = 1;  aAlfa = aSit;     |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Referencia catastral 1
         TipoDato = "An"; Long = 20; aAlfa = aRfC;     |HAZ Formateo; Cadena = Cadena + aAlfa;
      |FINSI;
      |SI nTitul ] 4; |SAL; |FINSI;
      IaTit = IaTit + 1; IaPc1 = IaPc1 + 1; IaPc2  = IaPc2 + 1;
      IaRfC = IaRfC + 1; IaSit = IaSit + 1; IaPc1b = IaPc1b + 1;
      IaPc2b = IaPc2b + 1;
   |SIGUE;

   |PARA; |SI nTitul < 4; |HACIENDO nTitul = nTitul + 1;
      Cadena = Cadena + (("0" * 12) + (" " * 20));
   |SIGUE;

   LongDec = 0;
   |HAZ GrabaCad;

   ||CONYUGE
   || Nif del conyuge
   TipoDato = "An"; Long = 9;  aAlfa = aNif2;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Apellido 1 del conyuge
   TipoDato = "A";  Long = 15; aAlfa = aApell21;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Apellido 2 del conyuge
   TipoDato = "A";  Long = 15; aAlfa = aApell22;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Nombre del conyuge
   TipoDato = "A";  Long = 15; aAlfa = aNombre2;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Sexo conyuge
   Cadena = Cadena + aSexo2;
   || Fecha nacimiento conyuge
   TipoDato = "F";  Long = 8;  aAlfa = aFNac2;    |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Grado de minusvalia del conyuge
   TipoDato = "N";  Long = 1; aAlfa = aMinusval2; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Conyuge no residente y no contribuyente
   |SI #rem00100#102 = "X";
      Cadena = Cadena + "1";
   |SINO;
      Cadena = Cadena + "0";
   |FINSI;
   || Suscripcion servicio mensajes SMS
   |SI aSMS2 = "S";
      Cadena = Cadena + "1";
   |SINO;
      Cadena = Cadena + "0";
   |FINSI;

   || Tipo de la via del conyuge
   TipoDato = "An";  Long = 5;  aAlfa = aSg2;       |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Codigo de la via INE
   Cadena = Cadena + "00000";
   || Nombre de la via del conyuge
   TipoDato = "A";  Long = 50; aAlfa = aCalle2;    |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Tipo de numeracion del conyuge
   TipoDato = "An"; Long = 3;  aAlfa = aTipNum2;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Numero del conyuge
   TipoDato = "N"; Long = 5;  aAlfa = aNumero2;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Calificador del numero del conyuge
   TipoDato = "An"; Long = 3;  aAlfa = aCalNum2;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Bloque del conyuge
   TipoDato = "An"; Long = 3;  aAlfa = aBloque2;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Portal del conyuge
   TipoDato = "An"; Long = 3;  aAlfa = aPortal2;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Escalera del conyuge
   TipoDato = "An"; Long = 3;  aAlfa = aEscalera2; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Piso del conyuge
   TipoDato = "An"; Long = 3;  aAlfa = aPiso2;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Puerta del conyuge
   TipoDato = "An"; Long = 3;  aAlfa = aPuerta2;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Datos complementarios al domicilio habitual del conyuge
   TipoDato = "An"; Long = 40;  aAlfa = aDatComp2; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Municipio del conyuge
   TipoDato = "An"; Long = 30; aAlfa = aLocalB2;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Codigo postal del conyuge
   aAlfa = aCP2; |QBF aAlfa; |SI aAlfa = ""; aAlfa = "00000"; |FINSI; Cadena = Cadena + aAlfa;

   || Codigo municipio INE
   Cadena = Cadena + "00000";
   |HAZ GrabaCad;

   || Municipio del conyuge
   TipoDato = "An"; Long = 30; aAlfa = aLocali2;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Codigo provincial del conyuge
   aAlfa = aCP2; aAlfa = aAlfa % 0102; |QBF aAlfa;
   aAlfa = ("00" + aAlfa) % -102;                  Cadena = Cadena + aAlfa;
   || Provincia del conyuge
   TipoDato = "An"; Long = 20; aAlfa = aProvin2;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Telefonos de contacto : Telefono fijo conyuge
   TipoDato = "N";  Long = 9;  aAlfa = aTelef2;    |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Telefonos de contacto : Telefono movil conyuge
   TipoDato = "N";  Long = 9;  aAlfa = aMovil2;    |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Telefonos de contacto : Fax conyuge
   TipoDato = "N";  Long = 9;  aAlfa = aFax2;      |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Domicilio extranjero del conyuge
   TipoDato = "An"; Long = 50;  aAlfa = aDomExtr2;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Datos complementarios del domicilio extranjero del conyuge
                    Long = 40;  aAlfa = aDtCmpEx2;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Poblacion extranjera del conyuge
                    Long = 30;  aAlfa = aPoblExt2;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || E-mail extranjero del conyuge
                    Long = 99;  aAlfa = aEmailExt2; |HAZ Formateo; Cadena = Cadena + aAlfa;
   Cadena = Cadena + " ";
   || Codigo postal extranjero del conyuge
                    Long = 10;  aAlfa = aCPExt2;    |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Provincia/region/estado extranjero del conyuge
                    Long = 30;  aAlfa = aEstExt2;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pais extranjero del conyuge
                    Long = 30;  aAlfa = aPaisExt2;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Codigo Pais extranjero del conyuge
                    Long = 2;   aAlfa = aCdPaisEx2; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |QBF aPoblExt2; |QBF aEstExt2;
   |SI aPoblExt2 ! ""; |O aEstExt2 ! "";
      || Telefono fijo extranjero del conyuge
                    Long = 15;  aAlfa = aTlfExtr2;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Telefono movil extranjero del conyuge
                    Long = 15;  aAlfa = aMovExtr2;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Fax extranjero del conyuge
                    Long = 15;  aAlfa = aFaxExtr2;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |SINO;
      Cadena = Cadena + (" " * 45);
   |FINSI;
   || RESERVADO AEAT
   Cadena = Cadena + " ";
   |HAZ GrabaCad;

   |ABRE #rerenpre;
   #rerenpre#0 = #rem00100#65;
   |LEE 000#rerenpre.=;
   |SI FSalida = 0;
      || Representante : Nif
      TipoDato = "An"; Long = 9;  aAlfa = #rerenpre#2;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Representante : Apellidos y nombre o razon social
      TipoDato = "An"; Long = 32; aAlfa = #rerenpre#1;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |SINO;
      Cadena = Cadena + (" " * 41);
   |FINSI;
   |CIERRA #rerenpre;

   || Fecha y firma de la declaracion : Localidad
   TipoDato = "An"; Long = 20; aAlfa = aLocali1;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ CargaFecha;
   || Fecha y firma de la declaracion : Dia Fecha
   TipoDato = "N";  Long = 2;  aAlfa = DiaInf;       |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Fecha y firma de la declaracion : Mes Fecha
   TipoDato = "A";  Long = 10; aAlfa = MesInf;       |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Fecha y firma de la declaracion : Ao Fecha
   TipoDato = "N";  Long = 4;  aAlfa = EjerInf;      |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Cuenta bancaria
   |SI #rem01001#11 = "X";
      aAlfa = "0" * 20;
   |SINO;
      aAlfa = aCuenta1;
   |FINSI;
   TipoDato = "N";  Long = 20; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Numero justificante
   TipoDato = "N";  Long = 13;  aAlfa = "0";         |HAZ Formateo; Cadena = Cadena + aAlfa;
   ||Reservado para la AEAT : N Referencia PADRE
   aAlfa = " " * 21; Cadena = Cadena + aAlfa;
/*
   || Liquidacion : Resultado a ingresar o a devolver
   |SI #rem01001#14 = "N";  |O #rem01001#14 = "3";
      nTotal = 0;
      Bloque = 41;     Casilla = "768"; |HAZ BuscaCasilla; nCalc = Casilla;
      |SI SwError = 1; |O nCalc = 0;
         Bloque = 42;  Casilla = "769"; |HAZ BuscaCasilla; nCalc = Casilla;
      |FINSI;
      |SI SwError = 1; |O nCalc = 0;
         Bloque = 39; Casilla = "760"; |HAZ BuscaCasilla; nTotal = Casilla; SwError = 1;
      |SINO;
         nTotal = #rem01001#16;
      |FINSI;
   |SINO;
      Bloque = 40; Casilla = "765"; |HAZ BuscaCasilla; nTotal = Casilla; SwError = 1;
   |FINSI;
*/
   || Liquidacion : Resultado a ingresar o a devolver
   Bloque = 40; Casilla = "765"; |HAZ BuscaCasilla; nTotal = Casilla; SwError = 1;
   |SI nTotal = 0;
      Bloque = 41;     Casilla = "768"; |HAZ BuscaCasilla; nCalc = Casilla;
      |SI SwError = 1; |O nCalc = 0;
         Bloque = 42;  Casilla = "769"; |HAZ BuscaCasilla; nCalc = Casilla;
      |FINSI;
      |SI SwError = 1; |O nCalc = 0;
         Bloque = 39; Casilla = "760"; |HAZ BuscaCasilla; nTotal = Casilla; SwError = 1;
      |SINO;
         nTotal = #rem01001#16;
      |FINSI;
   |FINSI;
   TipoDato = "N"; Long = 11; LongDec = 2;
   aAlfa = nTotal;                                   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Fraccionamiento del pago
   |SI #rem01001#8 = "S"; aAlfa = "1"; |SINO; aAlfa = "0"; |FINSI;
   TipoDato = "N";  Long = 1; LongDec = 0;           |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Domiciliacion del 2 plazo
   |SI #rem01001#8 = "S"; |Y #rem01001#10 = "S"; aAlfa = "1"; |SINO; aAlfa = "0"; |FINSI;
   TipoDato = "N";  Long = 1;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Renuncia a la devolucion
   |SI #rem01001#11 = "X"; aAlfa = "1"; |SINO; aAlfa = "0"; |FINSI;
   TipoDato = "N";  Long = 1;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Compensacion entre conyuges
   nSusp = 0;
   Bloque = 41;     Casilla = "768"; |HAZ BuscaCasilla; nCalc = Casilla;
   |SI SwError = 0; |Y nCalc ! 0; nSusp = 1; |FINSI;
   Bloque = 42;     Casilla = "769"; |HAZ BuscaCasilla; nCalc = Casilla;
   |SI SwError = 0; |Y nCalc ! 0; |Y nSusp = 0; nSusp = 1; |FINSI;
   aAlfa = nSusp; TipoDato = "N";  Long = 1;                        |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Reservado para la AEAT : Identificacion cliente EEDD
   |SI #reemi100#59 = "S";
      aAlfa = VEmpresa + " " + VTipo;
      TipoDato = "A";  Long = 20;                   |HAZ Formateo; Cadena = Cadena + aAlfa;
   |SINO;
      Cadena = Cadena + (" " * 20);
   |FINSI;
   || Sello electronico reservado para la AEAT
   Cadena = Cadena + (" " * 13);
   Cadena = Cadena + "</T10001>";
   Cadena = Cadena + &13 + &10; |HAZ GrabaCad;
|FPRC;

|PROCESO Hoja02;
   Cadena = ""; LongDec = 0;

   Cadena = "<T10002> ";

   || Bucle para la declaracion de hijos y otros descendientes
   aNifDc1 = ""; aNifDc2 = "";

   InAscend = nAscend1<-; InDescend = nDescend1<-;
   |PARA nCont = 1; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
      nDescend = 0; InDescend = InDescend + 1;
      |SI nCont [ 4; nAscend = 0; InAscend = InAscend + 1; |FINSI;
   |SIGUE;
   InAscend = nAscend1<-; InDescend = nDescend1<-;
   aCDoc = "0"; aPDec = "0";
   |BUCLE RecogeFam;

   |DDEF aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "rem00101.mas";
   |CARGA_DEF aAlfa, Referen@;
   |SI FSalida = 0;
      nNumFam = 1;
      aAlfa = "tu" + Usuario; |NOME_DAT #Referen@#aAlfa#;
      |DELINDEX #Referen@; |ABRE #Referen@;
      |SELECT #3#rem00101;
      |DDEFECTO #rem00101;
      #rem00101#0 = #rem00100#0;
      #rem00101#17 = "31.12.9999";
      |LEE 000#rem00101.];
      |PARA; |SI FSalida = 0; |Y #rem00101#0 = #rem00100#0; |HACIENDO;
         |SI #rem00101#4 = "DESCENDIENTE";
            aAlfa = "|NC"; aAlfa = #rem00101#aAlfa#; nCalc = aAlfa;
            |PARA nCont = 0; |SI nCont < nCalc; |HACIENDO nCont = nCont + 1;
               #Referen@#nCont# = #rem00101#nCont#;
            |SIGUE;
            #Referen@#1 = nNumFam; nNumFam = nNumFam + 1;
            |GRABA 020#Referen@.n;
         |FINSI;

         |LEE 000#rem00101.s;
      |SIGUE;
      |SELECT #1#rem00101;
      |CIERRA #Referen@; |DESCARGA_DEF #Referen@;

      |CIERRA #rem00101;
      aAlfa = "tu" + Usuario; |NOME_DAT #rem00101#aAlfa#;
      |ABRE #rem00101;
   |FINSI;

   nOrdenFall1 = 0; aFechaFall1 = "00.00.0000";
   nOrdenFall2 = 0; aFechaFall2 = "00.00.0000";
   aTipo = VTipo; |QBF aTipo;
   |SI aTipo = "TITULAR"; |O aTipo = "CONYUGE";
      nCont10 = 1; nHijosTit = 0; nHijosCon = 0;
      |PARA nCont = 1; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
         InDescend = nDescend1<-; InDescend = InDescend + (nCont - 1);
         #rem00101#0 = #rem00100#0;
         || #rem00101#1 = nDescend;
         #rem00101#1 = nCont;
         |LEE 000#rem00101.=;
         |SI FSalida = 0;
            aAlfa = #rem00101#2; |QBF aAlfa;
            |SI aAlfa ! ""; |Y #rem00101#7 = " ";
               |SI aNifDc1 = ""; aNifDc1 = aAlfa; |SINO; aNifDc2 = aAlfa; |FINSI;
            |FINSI;
            |SI #rem00101#7 = " ";
               nHijosTit = nHijosTit + 1;
               nHijosCon = nHijosCon + 1;
            |FINSI;
            |SI #rem00101#7 = "1"; |O #rem00101#7 = "3";
               nHijosTit = nHijosTit + 1;
            |FINSI;
            |SI #rem00101#7 = "2"; |O #rem00101#7 = "4";
               nHijosCon = nHijosCon + 1;
            |FINSI;
            |SI #rem00101#21 ! "01.01.0000";
               |SI aTipo = "TITULAR";
                  |SI #rem00101#7 = "1"; |O #rem00101#7 = "3"; |O #rem00101#7 = " ";
                     |SI nOrdenFall1 = 0;
                        aFechaFall1 = #rem00101#21;
                        nOrdenFall1 = nHijosTit
                     |SINO;
                        |SI nOrdenFall2 = 0;
                           aFechaFall2 = #rem00101#21;
                           nOrdenFall2 = nHijosTit
                        |FINSI;
                     |FINSI;
                  |FINSI;
               |FINSI;
               |SI aTipo = "CONYUGE";
                  |SI #rem00101#7 = "2"; |O #rem00101#7 = "4"; |O #rem00101#7 = " ";
                     |SI nOrdenFall1 = 0;
                        aFechaFall1 = #rem00101#21;
                        nOrdenFall1 = nHijosCon;
                     |SINO;
                        |SI nOrdenFall2 = 0;
                           aFechaFall2 = #rem00101#21;
                           nOrdenFall2 = nHijosCon;
                        |FINSI;
                     |FINSI;
                  |FINSI;
               |FINSI;
            |FINSI;
            |SI #rem00101#11 ] 0;
               |SI aTipo = "TITULAR";
                  |SI #rem00101#7 = "1"; |O #rem00101#7 = "3"; |O #rem00101#7 = " ";
                     |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
                     |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
                     |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
                     |SI #rem00101#6 ] 65; aMinuH = 3; |FINSI;
                     aNifH  = #rem00101#2;  aNombH = #rem00101#3;
                     aAnyoH = #rem00101#5;
                     aVincH = #rem00101#7;  aOtroH = #rem00101#8;
                     aFNacH = #rem00101#17; aFAdoH = #rem00101#18;
                     TipoDato = "F";
                     aAlfa = aFNacH; |HAZ Formateo; |SI aAlfa = "        "; aFNacH = "00000000"; |SINO; aFNacH = aAlfa; |FINSI;
                     aAlfa = aFAdoH; |HAZ Formateo; |SI aAlfa = "        "; aFAdoH = "00000000"; |SINO; aFAdoH = aAlfa; |FINSI;

                     |SI aEstCiv = "3"; |Y aEC1 = "C"; aVincH = ""; |FINSI;
                     |SI #rem00100#91 ! " ";
                        |SI aVincH = " "; aVincH = "3"; |FINSI;
                     |FINSI;
                     |SI aVincH = "4"; aVincH = "3"; |FINSI;

                     TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "N";  Long = 8;  aAlfa = aFAdoH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     |HAZ GrabaCad;
                     nCont10 = nCont10 + 1;
                  |FINSI;
               |FINSI;
               |SI aTipo = "CONYUGE";
                  |SI #rem00101#7 = "2"; |O #rem00101#7 = "4"; |O #rem00101#7 = " ";
                     |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
                     |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
                     |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
                     |SI #rem00101#6 ] 65; aMinuH = 3; |FINSI;
                     aNifH  = #rem00101#2;  aNombH = #rem00101#3;
                     aAnyoH = #rem00101#5;
                     aVincH = #rem00101#7;
                     |SI #rem00101#7 = "2"; aVincH = "1"; |FINSI;
                     aOtroH = #rem00101#8;
                     aFNacH = #rem00101#17; aFAdoH = #rem00101#18;
                     TipoDato = "F";
                     aAlfa = aFNacH; |HAZ Formateo; |SI aAlfa = "        "; aFNacH = "00000000"; |SINO; aFNacH = aAlfa; |FINSI;
                     aAlfa = aFAdoH; |HAZ Formateo; |SI aAlfa = "        "; aFAdoH = "00000000"; |SINO; aFAdoH = aAlfa; |FINSI;

                     |SI aEstCiv = "3"; |Y aEC1 = "C"; aVincH = ""; |FINSI;
                     |SI #rem00100#91 ! " ";
                        |SI aVincH = " "; aVincH = "3"; |FINSI;
                     |FINSI;
                     |SI aVincH = "4"; aVincH = "3"; |FINSI;

                     TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "N";  Long = 8;  aAlfa = aFAdoH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     |HAZ GrabaCad;
                     nCont10 = nCont10 + 1;
                  |FINSI;
               |FINSI;
            |FINSI;
         |FINSI;
      |SIGUE;
      |PARA nCont = nCont10; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
         aNifH  = ""; aNombH = "";
         aAnyoH = ""; aMinuH = "0";
         aVincH = ""; aOtroH = "";
         aFNacH = "00000000"; aFAdoH = "00000000";
         TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 8;  aAlfa = aFAdoH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad;
      |SIGUE;
   |SINO;
      nCont10 = 1;
      |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
         |PARA nCont = 1; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
            InDescend = nDescend1<-; InDescend = InDescend + (nCont - 1);
            #rem00101#0 = #rem00100#0;
            #rem00101#1 = nCont;
            |LEE 000#rem00101.=;
            |SI FSalida = 0; |Y #rem00101#11 ] 0;
               |SI #rem00101#21 ! "01.01.0000";
                  |SI nOrdenFall1 = 0;
                     aFechaFall1 = #rem00101#21;
                     nOrdenFall1 = nCont;
                  |SINO;
                     |SI nOrdenFall2 = 0;
                        aFechaFall2 = #rem00101#21;
                        nOrdenFall2 = nCont;
                     |FINSI;
                  |FINSI;
               |FINSI;
               |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
               |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
               |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
               |SI #rem00101#6 ] 65; aMinuH = 3; |FINSI;
               aNifH  = #rem00101#2;  aNombH = #rem00101#3;
               aAnyoH = #rem00101#5;
               aVincH = #rem00101#7;  aOtroH = #rem00101#8;
               |SI #rem00100#91 ! " ";
                  |SI #rem00100#91 = "T"; |SI aVincH = "2"; aVincH = "1"; |FINSI; |FINSI;
                  |SI aVincH = " "; aVincH = "3"; |FINSI;
               |FINSI;
               aFNacH = #rem00101#17; aFAdoH = #rem00101#18;
               TipoDato = "F";
               aAlfa = aFNacH; |HAZ Formateo; |SI aAlfa = "        "; aFNacH = "00000000"; |SINO; aFNacH = aAlfa; |FINSI;
               aAlfa = aFAdoH; |HAZ Formateo; |SI aAlfa = "        "; aFAdoH = "00000000"; |SINO; aFAdoH = aAlfa; |FINSI;
               TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ Formateo; Cadena = Cadena + aAlfa;
               TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
               TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
               TipoDato = "N";  Long = 8;  aAlfa = aFAdoH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
               TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
               TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
               TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
               |HAZ GrabaCad;
               nCont10 = nCont10 + 1;
            |FINSI;
         |SIGUE;
      |FINSI;

      |PARA nCont = nCont10; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
         aNifH  = ""; aNombH = "";
         aAnyoH = ""; aMinuH = "0";
         aVincH = ""; aOtroH = "";
         aFNacH = "00000000"; aFAdoH = "00000000";
         TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 8;  aAlfa = aFAdoH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad;
      |SIGUE;
   |FINSI;

   |CIERRA #rem00101;
   aAlfa = "rem00101"; |NOME_DAT #rem00101#aAlfa#;
   |ABRE #rem00101;

   || Hijos y otros descendientes : Fallecido 2006 - N orden
   TipoDato = "N"; Long = 2;  aAlfa = nOrdenFall1;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Hijos y otros descendientes : Fecha fallecimiento
   TipoDato = "F"; Long = 8;  aAlfa = aFechaFall1;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Hijos y otros descendientes : Fallecido 2006 - N orden
   TipoDato = "N"; Long = 2;  aAlfa = nOrdenFall2;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Hijos y otros descendientes : Fecha fallecimiento
   TipoDato = "F"; Long = 8;  aAlfa = aFechaFall2;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   TipoDato = "A"; Long = 9;  aAlfa = aNifDc1;      |HAZ Formateo; Cadena = Cadena + aAlfa;
   TipoDato = "A"; Long = 9;  aAlfa = aNifDc2;      |HAZ Formateo; Cadena = Cadena + aAlfa;
   || RESERVADO AEAT
   Cadena = Cadena + "                        ";

   || Bucle para la declaracion de ascendientes

   |SI aTipo = "TITULAR"; |O aTipo = "CONYUGE";
      nCont10 = 1;
      |PARA nCont = 1; |SI nCont [ 4; |HACIENDO nCont = nCont + 1;
         InAscend = nAscend1<-; InAscend = InAscend + (nCont - 1);
         #rem00101#0 = #rem00100#0;
         #rem00101#1 = nAscend;
         |LEE 000#rem00101.=;
         |SI FSalida = 0;  |Y aFamil = "N";
            |SI aTipo = "TITULAR"; |Y #rem00101#13 = "N";
               |SI #rem00101#7 = "1"; |O #rem00101#7 = " ";
                  |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
                  |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
                  |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
                  |SI #rem00101#6 ] 65; aMinuH = 3; |FINSI;
                  aNifH  = #rem00101#2; aNombH = #rem00101#3;
                  aAnyoH = #rem00101#5;
                  aVincH = #rem00101#7; aOtroH = #rem00101#9;
                  aNivRe = #rem00101#19; aFNacH = #rem00101#17;
                  TipoDato = "F";
                  aAlfa = aFNacH; |HAZ Formateo; |SI aAlfa = "        "; aFNacH = "00000000"; |SINO; aFNacH = aAlfa; |FINSI;

                  |SI aEstCiv = "3"; |Y aEC1 = "C"; aVincH = ""; |FINSI;

                  TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ Formateo; Cadena = Cadena + aAlfa;
                  TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                  TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                  TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                  TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                  TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                  |HAZ GrabaCad;
                  nCont10 = nCont10 + 1;
               |FINSI;
            |FINSI;
            |SI aTipo = "CONYUGE"; |Y #rem00101#13 = "N";
               |SI #rem00101#7 = "2"; |O #rem00101#7 = " ";
                  |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
                  |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
                  |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
                  |SI #rem00101#6 ] 65;  aMinuH = 3; |FINSI;
                  aNifH  = #rem00101#2;  aNombH = #rem00101#3;
                  aAnyoH = #rem00101#5;
                  aVincH = #rem00101#7;
                  |SI #rem00101#7 = "2"; aVincH = "1"; |FINSI;
                  aOtroH = #rem00101#9;
                  aNivRe = #rem00101#19; aFNacH = #rem00101#17;
                  TipoDato = "F";
                  aAlfa = aFNacH; |HAZ Formateo; |SI aAlfa = "        "; aFNacH = "00000000"; |SINO; aFNacH = aAlfa; |FINSI;

                  |SI aEstCiv = "3"; |Y aEC1 = "C"; aVincH = ""; |FINSI;

                  TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ Formateo; Cadena = Cadena + aAlfa;
                  TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                  TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                  TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                  TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                  TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                  |HAZ GrabaCad;
                  nCont10 = nCont10 + 1;
               |FINSI;
            |FINSI;
         |FINSI;
      |SIGUE;
      |PARA nCont = nCont10; |SI nCont [ 4; |HACIENDO nCont = nCont + 1;
         aNifH  = ""; aNombH = "";
         aAnyoH = ""; aMinuH = "0";
         aVincH = ""; aOtroH = "";
         aNivRe = ""; aFNacH = "00000000";

         TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad;
      |SIGUE;
   |SINO;
      nCont10 = 1;
      |PARA nCont = 1; |SI nCont [ 4; |HACIENDO nCont = nCont + 1;
         InAscend = nAscend1<-; InAscend = InAscend + (nCont - 1);
         #rem00101#0 = #rem00100#0;
         #rem00101#1 = nAscend;
         |LEE 000#rem00101.=;
         |SI FSalida = 0;  |Y aFamil = "N";
            |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
            |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
            |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
            |SI #rem00101#6 ] 65; aMinuH = 3; |FINSI;
            aNifH  = #rem00101#2; aNombH = #rem00101#3;
            aAnyoH = #rem00101#5;
            aVincH = #rem00101#7; aOtroH = #rem00101#9;
            aNivRe = #rem00101#19; aFNacH = #rem00101#17;
            TipoDato = "F";
            aAlfa = aFNacH; |HAZ Formateo; |SI aAlfa = "        "; aFNacH = "00000000"; |SINO; aFNacH = aAlfa; |FINSI;

            TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ Formateo; Cadena = Cadena + aAlfa;
            TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
            nCont10 = nCont10 + 1;
         |FINSI;
         aTipo = VTipo; |QBF aTipo;
      |SIGUE;

      |PARA nCont = nCont10; |SI nCont [ 4; |HACIENDO nCont = nCont + 1;
         aNifH  = ""; aNombH = "";
         aAnyoH = ""; aMinuH = "0";
         aVincH = ""; aOtroH = "";
         aNivRe = ""; aFNacH = "00000000";

         TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad;
      |SIGUE;
   |FINSI;
   |CIERRA #rem00101;

   || Fecha Fallecimiento (en su caso)
   aTipo = VTipo; |QBF aTipo;
   aAlfa = "00000000";
   |SI #rem00100#91 = "T"; |Y aTipo = "TITULAR";
      aAlfa = #rem00100#92;
      |SI aAlfa = "01.01.0000"; aAlfa = "00.00.0000"; |FINSI;
      aAlfa = aAlfa - "."; aAlfa = aAlfa - ".";
   |FINSI;
   |SI #rem00100#91 = "C"; |Y aTipo = "CONYUGE";
      aAlfa = #rem00100#92;
      |SI aAlfa = "01.01.0000"; aAlfa = "00.00.0000"; |FINSI;
      aAlfa = aAlfa - "."; aAlfa = aAlfa - ".";
   |FINSI;
   Cadena = Cadena + aAlfa;

   || Tipo de tributacion
   aTipo = VTipo; |QBF aTipo;
   |SI #rem00100#57 = "X";
      aSeparada = "N";
      |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
         Cadena = Cadena + "2";
      |SINO;
         Cadena = Cadena + "1";
      |FINSI;
   |SINO;
      aSeparada = "S";
      Cadena = Cadena + "1";
   |FINSI;
   |HAZ GrabaCad;

   || Comunidad autonoma de residencia
   aAlfa = VTipo; |QBF aAlfa;
   |SI aAlfa = "CONYUGE";
      TipoDato = "N";  Long = 2;  aAlfa = #rem00100#43;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |SINO;
      TipoDato = "N";  Long = 2;  aAlfa = #rem00100#11;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |FINSI;
   || Sostenimiento de la iglesia catolica
   |SI aIglesia1 = "I"; |O aIglesia1 = "D";
      aAlfa = "X";
   |SINO;
      |SI aIglesia1 = "O"; |O aIglesia1 = " "; aAlfa = ""; |FINSI;
   |FINSI;
   TipoDato = "A";  Long = 1;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Colaboracion en fines sociales
   |SI aIglesia1 = "O"; |O aIglesia1 = "D";
      aAlfa = "X";
   |SINO;
      |SI aIglesia1 = "I"; |O aIglesia1 = " "; aAlfa = ""; |FINSI;
   |FINSI;
   TipoDato = "A";  Long = 1;                        |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Solicitudes : Borrador declaracion o datos fiscales
   |SI #rew00001#9 = "S"; aAlfa = "1"; |SINO; aAlfa = "0"; |FINSI;
   TipoDato = "A";  Long = 1;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Solicitudes : Envio individualizado borrador
   |SI #reemi100#63 = "S"; aAlfa = "1"; |SINO; aAlfa = "0"; |FINSI;
   Cadena = Cadena + aAlfa;

   #rem01001#0 = VEmpresa;
   #rem01001#1 = 0;
   #rem01001#2 = VTipo;
   |LEE 000#rem01001.=;
   |SI FSalida ! 0; |DDEFECTO #rem01001; |FINSI;

   || Decl.Complementaria a otra del mismo ejercicio o por atrasos de rend.trabajo o complementaria a devolver
   aAlfa = "0000";
   |SI #rem01001#14 = "1"; aAlfa = "1000"; |FINSI;
   |SI #rem01001#14 = "2"; aAlfa = "1100"; |FINSI;
   |SI #rem01001#14 = "3"; aAlfa = "1010"; |FINSI;
   |SI #rem01001#14 = "4"; aAlfa = "0001"; |FINSI;
   Cadena = Cadena + aAlfa;
   Cadena = Cadena + "</T10002>";
   Cadena = Cadena + &13 + &10; |HAZ GrabaCad;
|FPRC;

|PROCESO Hoja11;
   aTipo = VTipo % 0110;
   Cadena = "<T10011> ";

   |ABRE #rem01033; |ABRE #rem01037; |ABRE #rem01045; |ABRE #rem01035;
   |ABRE #rem01046; |ABRE #rem01047;

   |SI nCont < nCalc1; nCont = nCalc1; |FINSI;
   |SI nCont < nCalc2; nCont = nCalc2; |FINSI;

   |SI nSwDatos = 0; |ACABA; |FINSI;

   #rem01033#0 = VEmpresa;
   #rem01033#1 = 0;
   #rem01033#2 = aTipo;
   |LEE 000#rem01033.=;
   |SI FSalida ! 0; |DDEFECTO #rem01033; |FINSI;

   nPagAct = 0; nNumPag = 1;

   nPag = 1; nCont = 0;
   #rem01045#0 = VEmpresa;
   #rem01045#1 = 0;
   #rem01045#2 = aTipo; aTipo2 = #rem01045#2;
   #rem01045#3 = 1;
   |LEE 000#rem01045.];
   |PARA; |SI FSalida = 0; |Y #rem01045#0 = VEmpresa; |Y #rem01045#1 = 0; |Y #rem01045#2 = aTipo2; |HACIENDO nCont = nCont + 1;
      |SI nCont = 3;
         nPag = nPag + 1; nCont = 1;
      |FINSI;
      |LEE 000#rem01045.s;
   |SIGUE;
   |SI nPag > nNumPag; nNumPag = nPag; |FINSI;

   nPag = 1; nCont = 0;
   #rem01035#0 = VEmpresa;
   #rem01035#1 = 0;
   #rem01035#2 = aTipo; aTipo2 = #rem01035#2;
   #rem01035#3 = 1;
   |LEE 000#rem01035.];
   |PARA; |SI FSalida = 0; |Y #rem01035#0 = VEmpresa; |Y #rem01035#1 = 0; |Y #rem01035#2 = aTipo2; |HACIENDO nCont = nCont + 1;
      |SI nCont = 3;
         nPag = nPag + 1; nCont = 1;
      |FINSI;
      |LEE 000#rem01035.s;
   |SIGUE;
   |SI nPag > nNumPag; nNumPag = nPag; |FINSI;

   nPag = 1; nCont = 0;
   #rem01037#0 = VEmpresa;
   #rem01037#1 = 0;
   #rem01037#2 = aTipo; aTipo2 = #rem01037#2;
   #rem01037#3 = 1;
   |LEE 000#rem01037.];
   |PARA; |SI FSalida = 0; |Y #rem01037#0 = VEmpresa; |Y #rem01037#1 = 0; |Y #rem01037#2 = aTipo2; |HACIENDO nCont = nCont + 1;
      |SI nCont = 3;
         nPag = nPag + 1; nCont = 1;
      |FINSI;
      |LEE 000#rem01037.s;
   |SIGUE;
   |SI nPag > nNumPag; nNumPag = nPag; |FINSI;

   nPag = 1; nCont = 0;
   #rem01046#0 = VEmpresa;
   #rem01046#1 = 0;
   #rem01046#2 = aTipo; aTipo2 = #rem01046#2;
   #rem01046#3 = 1;
   |LEE 000#rem01046.];
   |PARA; |SI FSalida = 0; |Y #rem01046#0 = VEmpresa; |Y #rem01046#1 = 0; |Y #rem01046#2 = aTipo2; |HACIENDO nCont = nCont + 1;
      |SI nCont = 3;
         nPag = nPag + 1; nCont = 1;
      |FINSI;
      |LEE 000#rem01046.s;
   |SIGUE;
   |SI nPag > nNumPag; nNumPag = nPag; |FINSI;

   nPag = 1; nCont = 0;
   #rem01047#0 = VEmpresa;
   #rem01047#1 = 0;
   #rem01047#2 = aTipo; aTipo2 = #rem01047#2;
   #rem01047#3 = 1;
   |LEE 000#rem01047.];
   |PARA; |SI FSalida = 0; |Y #rem01047#0 = VEmpresa; |Y #rem01047#1 = 0; |Y #rem01047#2 = aTipo2; |HACIENDO nCont = nCont + 1;
      |SI nCont = 3;
         nPag = nPag + 1; nCont = 1;
      |FINSI;
      |LEE 000#rem01047.s;
   |SIGUE;
   |SI nPag > nNumPag; nNumPag = nPag; |FINSI;

   #rem01035#0 = VEmpresa;
   #rem01035#1 = 0;
   #rem01035#2 = aTipo; aTipo2 = #rem01035#2;
   #rem01035#3 = 1;
   |LEE 000#rem01035.];
   |SI FSalida ! 0; |O #rem01035#0 ! VEmpresa; |O #rem01035#1 ! 0; |O #rem01035#2 ! aTipo2;
      |DDEFECTO #rem01035;
   |FINSI;

   #rem01045#0 = VEmpresa;
   #rem01045#1 = 0;
   #rem01045#2 = aTipo; aTipo2 = #rem01045#2;
   #rem01045#3 = 1;
   |LEE 000#rem01045.];
   |SI FSalida ! 0; |O #rem01045#0 ! VEmpresa; |O #rem01045#1 ! 0; |O #rem01045#2 ! aTipo2;
      |DDEFECTO #rem01045;
   |FINSI;

   #rem01046#0 = VEmpresa;
   #rem01046#1 = 0;
   #rem01046#2 = aTipo; aTipo2 = #rem01046#2;
   #rem01046#3 = 1;
   |LEE 000#rem01046.];
   |SI FSalida ! 0; |O #rem01046#0 ! VEmpresa; |O #rem01046#1 ! 0; |O #rem01046#2 ! aTipo2;
      |DDEFECTO #rem01046;
   |FINSI;

   #rem01037#0 = VEmpresa;
   #rem01037#1 = 0;
   #rem01037#2 = aTipo; aTipo2 = #rem01037#2;
   #rem01037#3 = 1;
   |LEE 000#rem01037.];
   |SI FSalida ! 0; |O #rem01037#0 ! VEmpresa; |O #rem01037#1 ! 0; |O #rem01037#2 ! aTipo2;
      |DDEFECTO #rem01037;
   |FINSI;

   |PARA nPagAct = 1; |SI nPagAct [ nNumPag; |HACIENDO nPagAct = nPagAct + 1;
      || (I) Reducciones base imponible : Reduc.tribut.conjunta : Reduc.unidad familiar tribut.conjunta
      TipoDato = "N"; Long = 11;  LongDec = 2;
      |SI nPagAct ! 1;
         aAlfa = "0" * 13;
      |SINO;
         aAlfa = #rem01033#51; |HAZ Formateo;
      |FINSI;
      Cadena = Cadena + aAlfa;

      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         || Reducciones base imponible : Aportaciones sist.prev.social : Regimen general : Contribuyente
         aAlfa = #rem01037#4;   |HAZ TipoContr; Cadena = Cadena + aTipoContr;
         || Reducciones base imponible : Aportaciones sist.prev.social : Regimen general : Excesos pdtes.2002-2006
         aAlfa = #rem01037#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Reducciones base imponible : Aportaciones sist.prev.social : Regimen general : Aportaciones
         aAlfa = #rem01037#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Reducciones base imponible : Aportaciones sist.prev.social : Regimen general : Importes con derecho a deduccion
         aAlfa = #rem01037#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;

         |LEE 000#rem01037.s;
         |SI FSalida ! 0; |O #rem01037#0 ! VEmpresa; |O #rem01037#1 ! 0; |O #rem01037#2 ! aTipo2;
            |DDEFECTO #rem01037;
         |FINSI;
      |SIGUE;

      |SI nPagAct = 1;
         || Reducciones base imponible : Aportaciones sist.prev.social : Regimen general : Total con derecho a deduccion
         aAlfa = #rem01033#52;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Reducciones base imponible : Aportaciones sist.prev.social : Aportaciones conyuge : Total con derecho a deduccion
         aAlfa = #rem01033#55;  |HAZ Formateo; Cadena = Cadena + aAlfa;

         || Reducciones base imponible : N hojas adicionales que se adjuntan
         TipoDato = "N"; Long = 1;  LongDec = 0;
         nCalc = nNumPag - 1;
         aAlfa = nCalc;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      |SINO;
         Cadena = Cadena + ("0" * 27);
      |FINSI;
      |HAZ GrabaCad; Cadena = "";

      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         || Reducciones base imponible : Aportaciones a favor de personas con discapacidad : Contribuyente X
         aAlfa = #rem01045#4;   |HAZ TipoContr; Cadena = Cadena + aTipoContr;
         TipoDato = "An"; Long = 9;  LongDec = 0;
         || Reducciones base imponible : Aportaciones a favor de personas con discapacidad : NIF persona con discapacidad
         aAlfa = #rem01045#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;  LongDec = 2;
         || Reducciones base imponible : Aportaciones a favor de personas con discapacidad : Excesos pendientes reducir
         aAlfa = #rem01045#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Reducciones base imponible : Aportaciones a favor de personas con discapacidad : Aportaciones 2007 propia persona discapacitada
         aAlfa = #rem01045#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Reducciones base imponible : Aportaciones a favor de personas con discapacidad : Aportaciones 2007 parientes o tutores
         aAlfa = #rem01045#8;  |HAZ Formateo; Cadena = Cadena + aAlfa;

         |LEE 000#rem01045.s;
         |SI FSalida ! 0; |O #rem01045#0 ! VEmpresa; |O #rem01045#1 ! 0; |O #rem01045#2 = aTipo2;
            |DDEFECTO #rem01045;
         |FINSI;
      |SIGUE;

      || Reducciones base imponible : Aportaciones a favor de personas con discapacidad : Total con derecho a deduccion
      |SI nPagAct = 1;
         aAlfa = #rem01033#56;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      |SINO;
         Cadena = Cadena + ("0" * 13);
      |FINSI;
      |HAZ GrabaCad; Cadena = "";

      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         || Reducciones base imponible : Aportaciones patrimonios protegidos personas discapacidad : Contribuyente 1
         aAlfa = #rem01035#4;   |HAZ TipoContr; Cadena = Cadena + aTipoContr;
         || Reducciones base imponible : Aportaciones patrimonios protegidos personas discapacidad : NIF persona discapacitada
         TipoDato = "An"; Long = 9;  LongDec = 0;
         aAlfa = #rem01035#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Reducciones base imponible : Aportaciones patrimonios protegidos personas discapacidad : Excesos pdtes reducir 2004-2006
         TipoDato = "N"; Long = 11;  LongDec = 2;
         aAlfa = #rem01035#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Reducciones base imponible : Aportaciones patrimonios protegidos personas discapacidad : Aportaciones 2007
         aAlfa = #rem01035#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;

         |LEE 000#rem01035.s;
         |SI FSalida ! 0; |O #rem01035#0 ! VEmpresa; |O #rem01035#1 ! 0; |O #rem01035#2 ! aTipo2;
            |DDEFECTO #rem01035;
         |FINSI;
      |SIGUE;

      |SI nPagAct = 1;
         || Reducciones base imponible : Aportaciones patrimonios protegidos personas discapacidad : Total con derecho a deduccion
         aAlfa = #rem01033#59;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      |SINO;
         Cadena = Cadena + ("0" * 13);
      |FINSI;
      |HAZ GrabaCad; Cadena = "";

      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         || Reducciones base imponible : Pensiones compensatorias conyuge y anualidades excepto hijos : Contribuyente 1
         aAlfa = #rem01046#4;   |HAZ TipoContr; Cadena = Cadena + aTipoContr;
         || Reducciones base imponible : Pensiones compensatorias conyuge y anualidades excepto hijos : NIF persona receptora pension/anualidad
         TipoDato = "An"; Long = 9;  LongDec = 0;
         aAlfa = #rem01046#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Reducciones base imponible : Pensiones compensatorias conyuge y anualidades excepto hijos : Importe pension/anualidad 2007
         TipoDato = "N"; Long = 11;  LongDec = 2;
         aAlfa = #rem01046#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;

         |LEE 000#rem01046.s;
         |SI FSalida ! 0; |O #rem01046#0 ! VEmpresa; |O #rem01046#1 ! 0; |O #rem01046#2 ! aTipo2;
            |DDEFECTO #rem01046;
         |FINSI;
      |SIGUE;

      |SI nPagAct = 1;
         || Reducciones base imponible : Pensiones compensatorias conyuge y anualidades excepto hijos : Total derecho a deduccion
         aAlfa = #rem01033#62;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      |SINO;
         Cadena = Cadena + ("0" * 13);
      |FINSI;
      |HAZ GrabaCad; Cadena = "";

      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         || Reducciones base imponible : Aportaciones mutualidad prevision social deportistas profesionales : Contribuyente 1
         aAlfa = #rem01047#4;   |HAZ TipoContr; Cadena = Cadena + aTipoContr;
         || Reducciones base imponible : Aportaciones mutualidad prevision social deportistas profesionales : Aportaciones 2007
         aAlfa = #rem01047#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Reducciones base imponible : Aportaciones mutualidad prevision social deportistas profesionales : Aportaciones 2008
         aAlfa = #rem01047#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;

         |LEE 000#rem01047.s;
         |SI FSalida ! 0; |O #rem01047#0 ! VEmpresa; |O #rem01047#1 ! 0; |O #rem01047#2 ! aTipo2;
            |DDEFECTO #rem01047;
         |FINSI;
      |SIGUE;
      |HAZ GrabaCad; Cadena = "";

      |SI nPagAct = 1;
         || Reducciones base imponible : Aportaciones mutualidad prevision social deportistas profesionales : Total con derecho a deduccion
         aAlfa = #rem01033#63;  |HAZ Formateo; Cadena = Cadena + aAlfa;

         || (J) Base liquidable general/base liquidable ahorro : Determinacion base general : Base imponible general
         aAlfa = #rem01033#66;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base general : Reducciones Base imponible general : Tributacion conjunta
         aAlfa = #rem01033#67;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base general : Reducciones Base imponible general : Aport.Prev.Social (R.G.)
         aAlfa = #rem01033#68;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base general : Reducciones Base imponible general : Aport.Prev.Social conyuge
         aAlfa = #rem01033#69;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base general : Reducciones Base imponible general : Aport.Prev.Social Personas discap.
         aAlfa = #rem01033#70;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base general : Reducciones Base imponible general : Aport.Patr.Protegidos Personas discap.
         aAlfa = #rem01033#71;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base general : Reducciones Base imponible general : Pensiones comp./anual. alimentos
         aAlfa = #rem01033#72;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base general : Reducciones Base imponible general : Cuotas afiliacion y demas aportaciones
         aAlfa = #rem01033#74;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base general : Reducciones Base imponible general : Aportaciones mutualidad deportistas profesionales
         aAlfa = #rem01033#73;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base general : Base liquidable general
         aAlfa = #rem01033#75;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base general : Compensacion
         aAlfa = #rem01033#76;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base general : Base liquidable general sometida a gravamen
         aAlfa = #rem01033#77;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base ahorro : Base imponible ahorro
         aAlfa = #rem01033#78;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base ahorro : Remanente reduc.no aplicadas : Reduc.Trib.conjunta
         aAlfa = #rem01033#79;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base ahorro : Remanente reduc.no aplicadas : Reduc.pensiones comp./anual. alimentos
         aAlfa = #rem01033#80;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base ahorro : Cuotas de afiliacion y demas aportaciones
         aAlfa = #rem01033#110;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base ahorro : Base liquidable ahorro
         aAlfa = #rem01033#81;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      |SINO;
         Cadena = Cadena + ("0" * 234);
      |FINSI;
      |HAZ GrabaCad; Cadena = "";
      Cadena = Cadena + "</T10011>" + &13 + &10; |HAZ GrabaCad;
      |SI nPagAct < nNumPag;
         Cadena = Cadena + "<T10011>C"; |HAZ GrabaCad;
      |FINSI;
   |SIGUE;

   |CIERRA #rem01033; |CIERRA #rem01037; |CIERRA #rem01045; |CIERRA #rem01035;
   |CIERRA #rem01046; |CIERRA #rem01047;
|FPRC;

|PROCESO Hoja12;
   aTipo = VTipo % 0110;
   Cadena = "<T10012> ";

   |ABRE #rem01033;
   #rem01033#0 = VEmpresa;
   #rem01033#1 = 0;
   #rem01033#2 = aTipo;
   |LEE 000#rem01033.=;
   |SI FSalida ! 0; |DDEFECTO #rem01033; |FINSI;

   || (K) Reducciones base imponible no aplicadas a 2007 : Exceso aport.sist.prev.social (R.G) : Contribuyente 1
   TipoDato = "An"; Long = 9;  LongDec = 0;
   aAlfa = #rem01033#82;   |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Reducciones base imponible no aplicadas a 2007 : Exceso aport.sist.prev.social (R.G) : Aport./Contrib. 2007 no aplicadas
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01033#83;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Reducciones base imponible no aplicadas a 2007 : Exceso aport.sist.prev.social (R.G) : Contribuyente 2
   aAlfa = #rem01033#84;   |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Reducciones base imponible no aplicadas a 2007 : Exceso aport.sist.prev.social (R.G) : Aport./Contrib. 2007 no aplicadas
   aAlfa = #rem01033#85;  |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Reducciones base imponible no aplicadas a 2007 : Exceso aport.sist.prev.social (R.G) : Hojas que se adjuntan
   Cadena = Cadena + "0";

   || Reducciones base imponible no aplicadas a 2007 : Exceso aport.sist.prev.personas discapacitadas : Contribuyente 1
   aAlfa = #rem01033#86;   |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Reducciones base imponible no aplicadas a 2007 : Exceso aport.sist.prev.personas discapacitadas : Aportaciones 2007 no aplicadas
   aAlfa = #rem01033#87;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Reducciones base imponible no aplicadas a 2007 : Exceso aport.sist.prev.personas discapacitadas : Contribuyente 2
   aAlfa = #rem01033#88;   |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Reducciones base imponible no aplicadas a 2007 : Exceso aport.sist.prev.personas discapacitadas : Aportaciones 2007 no aplicadas
   aAlfa = #rem01033#89;  |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Reducciones base imponible no aplicadas a 2007 : Exceso aport.patrim.protegidos personas discapacitadas : Contribuyente 1
   aAlfa = #rem01033#90;   |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Reducciones base imponible no aplicadas a 2007 : Exceso aport.patrim.protegidos personas discapacitadas : Aportaciones 2007 no aplicadas
   aAlfa = #rem01033#91;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Reducciones base imponible no aplicadas a 2007 : Exceso aport.patrim.protegidos personas discapacitadas : Contribuyente 2
   aAlfa = #rem01033#92;   |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Reducciones base imponible no aplicadas a 2007 : Exceso aport.patrim.protegidos personas discapacitadas : Aportaciones 2007 no aplicadas
   aAlfa = #rem01033#93;  |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Reducciones base imponible no aplicadas a 2007 : Exceso aport.mut.prev.deportistas profesionales : Contribuyente 1
   aAlfa = #rem01033#94;   |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Reducciones base imponible no aplicadas a 2007 : Exceso aport.mut.prev.deportistas profesionales : Aport.2007 no aplicadas 1
   aAlfa = #rem01033#95;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Reducciones base imponible no aplicadas a 2007 : Exceso aport.mut.prev.deportistas profesionales : Contribuyente 2
   aAlfa = #rem01033#96;   |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Reducciones base imponible no aplicadas a 2007 : Exceso aport.mut.prev.deportistas profesionales : Aport.2007 no aplicadas 2
   aAlfa = #rem01033#97;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || (L) Casilla 675
   aAlfa = #rem01033#103;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 676
   aAlfa = #rem01033#104;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 677
   aAlfa = #rem01033#105;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 678
   aAlfa = #rem01033#106;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 679
   aAlfa = #rem01033#107;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 680
   aAlfa = #rem01033#108;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 681
   aAlfa = #rem01033#109;  |HAZ Formateo; Cadena = Cadena + aAlfa;

   || (M) Casilla 686
   Bloque = 34; Casilla = "686"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 687
   Bloque = 34; Casilla = "687"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 688
   Bloque = 34; Casilla = "688"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Determinacion de los gravamenes estatal y autonomico : Casilla 689
   Bloque = 35; Casilla = "689"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 690
   Bloque = 36; Casilla = "690"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 691
   Bloque = 35; Casilla = "691"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 692
   Bloque = 36; Casilla = "692"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 693
   Bloque = 35; Casilla = "693"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 694
   Bloque = 36; Casilla = "694"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla TME
   Long = 2;  LongDec = 2;
   Bloque = 35; Casilla = "694"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla TMA
   Bloque = 36; Casilla = "696"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Casilla 695
   TipoDato = "N"; Long = 11;  LongDec = 2;
   Bloque = 35; Casilla = "695"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 696
   Bloque = 35; Casilla = "696"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 697
   Bloque = 36; Casilla = "697"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 698
   Bloque = 35; Casilla = "698"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 699
   Bloque = 36; Casilla = "699"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 700
   Bloque = 35; Casilla = "700"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 701
   Bloque = 36; Casilla = "701"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 702
   Bloque = 35; Casilla = "702"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 703
   Bloque = 36; Casilla = "703"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 704
   Bloque = 35; Casilla = "704"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 705
   Bloque = 36; Casilla = "705"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 706
   Bloque = 35; Casilla = "706"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 707
   Bloque = 36; Casilla = "707"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 708
   Bloque = 35; Casilla = "708"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Casilla 709
   Bloque = 36; Casilla = "709"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 710
   Bloque = 35; Casilla = "710"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 711
   Bloque = 36; Casilla = "711"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 712
   Bloque = 35; Casilla = "712"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 713
   Bloque = 36; Casilla = "713"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 714
   Bloque = 35; Casilla = "714"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 715
   Bloque = 36; Casilla = "715"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 716
   Bloque = 35; Casilla = "716"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 717
   Bloque = 36; Casilla = "717"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 720
   Bloque = 35; Casilla = "720"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 721
   Bloque = 36; Casilla = "721"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   Cadena = "</T10012>" + &13 + &10; |HAZ GrabaCad;
   |CIERRA #rem01033;
|FPRC;

|PROCESO Hoja13;
   aTipo = VTipo % 0110;
   Cadena = "<T10013> ";

   TipoDato = "N"; Long = 11;  LongDec = 2;
   || Casilla 722
   Bloque = 35; Casilla = "722"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 723
   Bloque = 35; Casilla = "723"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 724
   Bloque = 35; Casilla = "724"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 725
   Bloque = 35; Casilla = "725"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 726
   Bloque = 36; Casilla = "726"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 727
   Bloque = 36; Casilla = "727"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 728
   Bloque = 36; Casilla = "728"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 729
   Bloque = 36; Casilla = "729"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 730
   Bloque = 35; Casilla = "730"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 731
   Bloque = 36; Casilla = "731"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Cuota resultante de la autoliquidacion : Casilla 732
   Bloque = 37; Casilla = "732"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 733
   Bloque = 37; Casilla = "733"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 734
   Bloque = 37; Casilla = "734"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 735
   Bloque = 37; Casilla = "735"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 736
   Bloque = 37; Casilla = "736"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 737
   Bloque = 37; Casilla = "737"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 738
   Bloque = 37; Casilla = "738"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 739
   Bloque = 37; Casilla = "739"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 740
   Bloque = 37; Casilla = "740"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 741
   Bloque = 37; Casilla = "741"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Retenciones y demas pagos a cuenta : Casilla 742
   Bloque = 38; Casilla = "742"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 743
   Bloque = 38; Casilla = "743"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 744
   Bloque = 38; Casilla = "744"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 745
   Bloque = 38; Casilla = "745"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 746
   Bloque = 38; Casilla = "746"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 747
   Bloque = 38; Casilla = "747"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 748
   Bloque = 38; Casilla = "748"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 749
   Bloque = 38; Casilla = "749"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 750
   Bloque = 38; Casilla = "750"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 751
   Bloque = 38; Casilla = "751"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 752
   Bloque = 38; Casilla = "752"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 754
   Bloque = 38; Casilla = "754"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Cuota diferencial y resultado de la liquidacion : Casilla 755
   Bloque = 39; Casilla = "755"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 756
   Bloque = 39; Casilla = "756"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 757
   Bloque = 39; Casilla = "757"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 758
   Bloque = 39; Casilla = "758"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 759
   Bloque = 39; Casilla = "759"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 760
   Bloque = 39; Casilla = "760"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || (N) Regularizacion mediante declaracion complementaria (solo caso Dec.Comp.2007) : Casilla 761
   Bloque = 40; Casilla = "761"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 762
   Bloque = 40; Casilla = "762"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 765
   Bloque = 40; Casilla = "765"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   nCalc = 0;
   || (O) Solicitud de suspension del ingreso de un conyuge / renuncia del otro conyuge al cobro de la devolucion : Casilla 768
   Bloque = 41; Casilla = "768"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |SI nCalc = 0; nCalc = Casilla; |FINSI;
   || Casilla 770
   Bloque = 41; Casilla = "770"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |SI nCalc = 0; nCalc = Casilla; |FINSI;
   || Casilla 769
   Bloque = 42; Casilla = "769"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |SI nCalc = 0; nCalc = Casilla; |FINSI;
   || Casilla 770
   Bloque = 42; Casilla = "770"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |SI nCalc = 0; nCalc = Casilla; |FINSI;
   || Casilla 771
   |SI nCalc ! 0;
      Cadena = Cadena + aCuenta1;
   |SINO;
      Cadena = Cadena + ("0" * 20);
   |FINSI;
   |HAZ GrabaCad; Cadena = "";

   Cadena = "</T10013>" + &13 + &10; |HAZ GrabaCad;
|FPRC;

|PROCESO Hoja14;
   nSwDatos = 14; nCalc1 = 0; |HAZ MiraSiDatos;
   |SI nSwDatos = 0; |ACABA; |FINSI;

   aTipo = VTipo % 0110;

   Cadena = "<T10014> ";

   |ABRE #rem01041;
   #rem01041#0 = VEmpresa;
   #rem01041#1 = 0;
   #rem01041#2 = aTipo;
   |LEE 000#rem01041.=;
   |SI FSalida ! 0; |DDEFECTO #rem01041; |FINSI;

   TipoDato = "N"; Long = 11;  LongDec = 2;
   || Deduccion por inversion en vivienda habitual : Casilla A
   aAlfa = #rem01041#3;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 780
   aAlfa = #rem01041#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 781
   aAlfa = #rem01041#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla B
   aAlfa = #rem01041#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 782
   aAlfa = #rem01041#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 783
   aAlfa = #rem01041#8;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla C
   aAlfa = #rem01041#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 784
   aAlfa = #rem01041#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 785
   aAlfa = #rem01041#11; |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Cuenta 1 : Titular
   aAlfa = #rem01041#12; |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Cuenta 1 : Fecha de apertura
   TipoDato = "F";
   aAlfa = #rem01041#13; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuenta 1 : Entidad
   TipoDato = "N"; Long = 4;  LongDec = 0;
   aAlfa = #rem01041#14; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuenta 1 : Sucursal
   aAlfa = #rem01041#15; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuenta 1 : DC
   Long = 2;
   aAlfa = #rem01041#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuenta 1 : Cuenta
   Long = 10;
   aAlfa = #rem01041#17; |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Cuenta 2 : Titular
   aAlfa = #rem01041#18; |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Cuenta 2 : Fecha de apertura
   TipoDato = "F";
   aAlfa = #rem01041#19; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuenta 2 : Entidad
   TipoDato = "N"; Long = 4;  LongDec = 0;
   aAlfa = #rem01041#20; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuenta 2 : Sucursal
   aAlfa = #rem01041#21; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuenta 2 : DC
   Long = 2;
   aAlfa = #rem01041#22; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuenta 2 : Cuenta
   Long = 10;
   aAlfa = #rem01041#23; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Casilla D
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01041#24; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 786
   aAlfa = #rem01041#25; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 787
   aAlfa = #rem01041#26; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 700
   aAlfa = #rem01041#27; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 701
   aAlfa = #rem01041#28; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Casilla 788
   aAlfa = #rem01041#29; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 789
   TipoDato = "An"; Long = 9;  LongDec = 0;
   aAlfa = #rem01041#81; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 790
   TipoDato = "F";
   aAlfa = #rem01041#31; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 791
   TipoDato = "An"; Long = 20;  LongDec = 0;
   aAlfa = #rem01041#32; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 792
   TipoDato = "N"; Long = 3;  LongDec = 2;
   aAlfa = #rem01041#33; |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Casilla 793
   TipoDato = "An"; Long = 9;  LongDec = 0;
   aAlfa = #rem01041#85; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla  Porcentaje arrendador
   TipoDato = "N"; Long = 2;  LongDec = 2;
   aAlfa = #rem01041#88; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla E
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01041#86; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 716
   aAlfa = #rem01041#87; |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Casilla F
   aAlfa = #rem01041#38; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 795
   aAlfa = #rem01041#39; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla G
   aAlfa = #rem01041#40; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 796
   aAlfa = #rem01041#41; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 704
   aAlfa = #rem01041#42; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 705
   aAlfa = #rem01041#43; |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Casilla H
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01041#34; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 797
   aAlfa = #rem01041#35; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 702
   aAlfa = #rem01041#36; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 703
   aAlfa = #rem01041#37; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Casilla 798
   aAlfa = #rem01041#44; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 712
   aAlfa = #rem01041#45; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 713
   aAlfa = #rem01041#46; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla H
   aAlfa = #rem01041#47; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 799
   aAlfa = #rem01041#48; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 714
   aAlfa = #rem01041#49; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 715
   aAlfa = #rem01041#50; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Cuenta 1 : Titular
   aAlfa = #rem01041#51; |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Cuenta 1 : Fecha de apertura
   TipoDato = "F";
   aAlfa = #rem01041#52; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuenta 1 : Entidad
   TipoDato = "N"; Long = 4;  LongDec = 0;
   aAlfa = #rem01041#53; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuenta 1 : Sucursal
   aAlfa = #rem01041#54; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuenta 1 : DC
   Long = 2;
   aAlfa = #rem01041#55; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuenta 1 : Cuenta
   Long = 10;
   aAlfa = #rem01041#56; |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Cuenta 2 : Titular
   aAlfa = #rem01041#57; |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Cuenta 2 : Fecha de apertura
   TipoDato = "F";
   aAlfa = #rem01041#58; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuenta 2 : Entidad
   TipoDato = "N"; Long = 4;  LongDec = 0;
   aAlfa = #rem01041#59; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuenta 2 : Sucursal
   aAlfa = #rem01041#60; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuenta 2 : DC
   Long = 2;
   aAlfa = #rem01041#61; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuenta 2 : Cuenta
   Long = 10;
   aAlfa = #rem01041#62; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   Cadena = "</T10014>" + &13 + &10; |HAZ GrabaCad;
   |CIERRA #rem01041;
|FPRC;

|PROCESO Hoja15;
   nSwDatos = 15; nCalc1 = 0; |HAZ MiraSiDatos;
   |SI nSwDatos = 0; |ACABA; |FINSI;

   aTipo = VTipo % 0110;
   Cadena = "<T10015> ";

   |ABRE #rem01043;
   #rem01043#0 = VEmpresa;
   #rem01043#1 = 0;
   #rem01043#2 = aTipo;
   |LEE 000#rem01043.=;
   |SI FSalida ! 0; |DDEFECTO #rem01043; |FINSI;

   || Deducciones autonomicas : Andalucia : Casilla 800
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01043#3; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 801
   aAlfa = #rem01043#4; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 802
   aAlfa = #rem01043#5; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 938 (NIF)
   |SI #rem01043#6 ! 0; aAlfa = #rem01043#144; |SINO; aAlfa = " " * 9; |FINSI;
   TipoDato = "An"; Long = 9;  LongDec = 0;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 803
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01043#6; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 804
   aAlfa = #rem01043#7; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 805
   aAlfa = #rem01043#8; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 806
   aAlfa = #rem01043#9; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 807
   aAlfa = #rem01043#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 808
   aAlfa = #rem01043#11; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 809
   aAlfa = #rem01043#12; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 935
   TipoDato = "A"; Long = 11;  LongDec = 0;
   aAlfa = #rem01043#179; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 926
   TipoDato = "N"; LongDec = 2;
   aAlfa = #rem01043#177; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 936
   TipoDato = "A"; Long = 11;  LongDec = 0;
   aAlfa = #rem01043#180; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 927
   TipoDato = "N"; LongDec = 2;
   aAlfa = #rem01043#178; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 717 Andalucia
   aAlfa = #rem01043#13; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Deducciones autonomicas : Aragon : Casilla 810
   aAlfa = #rem01043#14; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 811
   aAlfa = #rem01043#15; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 812
   aAlfa = #rem01043#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 813
   aAlfa = #rem01043#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 814
   aAlfa = #rem01043#18; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 717 Aragon
   aAlfa = #rem01043#19; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Deducciones autonomicas : Asturias : Casilla 815
   aAlfa = #rem01043#20; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 816
   aAlfa = #rem01043#21; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 817
   aAlfa = #rem01043#22; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 818
   aAlfa = #rem01043#23; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 938 (NIF)
   |SI #rem01043#24 ! 0; aAlfa = #rem01043#144; |SINO; aAlfa = " " * 9; |FINSI;
   TipoDato = "An"; Long = 9;  LongDec = 0;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 819
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01043#24; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 820
   aAlfa = #rem01043#25; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 821
   aAlfa = #rem01043#26; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 822
   aAlfa = #rem01043#27; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 717 Asturias
   aAlfa = #rem01043#28; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Deducciones autonomicas : Islas Baleares : Casilla 823
   aAlfa = #rem01043#29; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 824
   aAlfa = #rem01043#30; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 825
   aAlfa = #rem01043#31; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 938 (NIF)
   |SI #rem01043#32 ! 0; aAlfa = #rem01043#144; |SINO; aAlfa = " " * 9; |FINSI;
   TipoDato = "An"; Long = 9;  LongDec = 0;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 826
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01043#32; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 827
   aAlfa = #rem01043#33; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 828
   aAlfa = #rem01043#34; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 829
   aAlfa = #rem01043#35; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 923
   aAlfa = #rem01043#36; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 924
   aAlfa = #rem01043#37; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 717 Islas Baleares
   aAlfa = #rem01043#38; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Deducciones autonomicas : Islas Canarias : Casilla 830
   aAlfa = #rem01043#39; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 831
   aAlfa = #rem01043#40; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 832
   aAlfa = #rem01043#41; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 833
   aAlfa = #rem01043#42; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 834
   aAlfa = #rem01043#43; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 835
   aAlfa = #rem01043#44; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 836
   aAlfa = #rem01043#45; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 837
   aAlfa = #rem01043#46; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 838
   aAlfa = #rem01043#47; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 839
   aAlfa = #rem01043#48; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 840
   aAlfa = #rem01043#49; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 841
   aAlfa = #rem01043#50; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 938 (NIF)
   |SI #rem01043#51 ! 0; aAlfa = #rem01043#144; |SINO; aAlfa = " " * 9; |FINSI;
   TipoDato = "An"; Long = 9;  LongDec = 0;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 842
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01043#51; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 843
   aAlfa = #rem01043#52; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 717 Islas Canarias
   aAlfa = #rem01043#53; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   Cadena = "</T10015>" + &13 + &10; |HAZ GrabaCad;
   |CIERRA #rem01043;
|FPRC;

|PROCESO Hoja16;
   nSwDatos = 16; nCalc1 = 0; |HAZ MiraSiDatos;
   |SI nSwDatos = 0; |ACABA; |FINSI;

   aTipo = VTipo % 0110;
   Cadena = "<T10016> ";

   |ABRE #rem01043;
   #rem01043#0 = VEmpresa;
   #rem01043#1 = 0;
   #rem01043#2 = aTipo;
   |LEE 000#rem01043.=;
   |SI FSalida ! 0; |DDEFECTO #rem01043; |FINSI;

   || Deducciones autonomicas : Cantabria : Casilla 938 (NIF)
   |SI #rem01043#54 ! 0; aAlfa = #rem01043#144; |SINO; aAlfa = " " * 9; |FINSI;
   TipoDato = "An"; Long = 9;  LongDec = 0;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 844
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01043#54; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 845
   aAlfa = #rem01043#55; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 846
   aAlfa = #rem01043#56; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 847
   aAlfa = #rem01043#57; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 848
   aAlfa = #rem01043#58; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 717 Cantabria
   aAlfa = #rem01043#59; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Deducciones autonomicas : Castilla La Mancha : Casilla 849
   aAlfa = #rem01043#60; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 850
   aAlfa = #rem01043#61; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 851
   aAlfa = #rem01043#62; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 852
   aAlfa = #rem01043#63; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 853
   aAlfa = #rem01043#64; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 854
   aAlfa = #rem01043#65; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 855
   aAlfa = #rem01043#66; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 937 (Numero identificacion prestamo)
   |SI #rem01043#66 ! 0;
      aAlfa = #rem01043#146 + #rem01043#147 + #rem01043#148 + #rem01043#149;
   |SINO;
      aAlfa = " " * 20;
   |FINSI;
   TipoDato = "An"; Long = 20;  LongDec = 0;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 717 Castilla La Mancha
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01043#67; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Deducciones autonomicas : Castilla y Leon : Casilla 856
   aAlfa = #rem01043#68; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 857
   aAlfa = #rem01043#69; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 858
   aAlfa = #rem01043#70; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 859
   aAlfa = #rem01043#71; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 860
   aAlfa = #rem01043#72; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 861
   aAlfa = #rem01043#73; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 862
   aAlfa = #rem01043#74; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 863
   aAlfa = #rem01043#75; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 938 (NIF)
   |SI #rem01043#76 ! 0; aAlfa = #rem01043#144; |SINO; aAlfa = " " * 9; |FINSI;
   TipoDato = "An"; Long = 9;  LongDec = 0;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 864
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01043#76; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 865
   aAlfa = #rem01043#77; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 717 Castilla y Leon
   aAlfa = #rem01043#78; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Deducciones autonomicas : Catalua : Casilla 866
   aAlfa = #rem01043#79; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 867
   aAlfa = #rem01043#80; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 938 (NIF)
   |SI #rem01043#81 ! 0; aAlfa = #rem01043#144; |SINO; aAlfa = " " * 9; |FINSI;
   TipoDato = "An"; Long = 9;  LongDec = 0;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 868
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01043#81; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 869
   aAlfa = #rem01043#82; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 871
   aAlfa = #rem01043#84; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 925
   aAlfa = #rem01043#85; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 717 Catalua
   aAlfa = #rem01043#86; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Deducciones autonomicas : Extremadura : Casilla 872
   aAlfa = #rem01043#87; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 873
   aAlfa = #rem01043#88; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 874
   aAlfa = #rem01043#89; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 875
   aAlfa = #rem01043#90; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 938 (NIF)
   |SI #rem01043#91 ! 0; aAlfa = #rem01043#144; |SINO; aAlfa = " " * 9; |FINSI;
   TipoDato = "An"; Long = 9;  LongDec = 0;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 876
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01043#91; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 877
   aAlfa = #rem01043#92; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 878
   aAlfa = #rem01043#93; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 717 Extremadura
   aAlfa = #rem01043#94; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   Cadena = "</T10016>" + &13 + &10; |HAZ GrabaCad;
   |CIERRA #rem01043;
|FPRC;

|PROCESO Hoja17;
   nSwDatos = 17; nCalc1 = 0; |HAZ MiraSiDatos;
   |SI nSwDatos = 0; |ACABA; |FINSI;

   aTipo = VTipo % 0110;
   Cadena = "<T10017> ";

   |ABRE #rem01043;
   #rem01043#0 = VEmpresa;
   #rem01043#1 = 0;
   #rem01043#2 = aTipo;
   |LEE 000#rem01043.=;
   |SI FSalida ! 0; |DDEFECTO #rem01043; |FINSI;

   || Deducciones autonomicas : Galicia : Casilla 879
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01043#95; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 880
   aAlfa = #rem01043#96; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 881
   aAlfa = #rem01043#97; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 882
   aAlfa = #rem01043#98; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 883
   aAlfa = #rem01043#99; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 938 (NIF)
   |SI #rem01043#100 ! 0; aAlfa = #rem01043#144; |SINO; aAlfa = " " * 9; |FINSI;
   TipoDato = "An"; Long = 9;  LongDec = 0;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 884
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01043#100; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 885
   aAlfa = #rem01043#101; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 717 Galicia
   aAlfa = #rem01043#102; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Deducciones autonomicas : Madrid : Casilla 886
   aAlfa = #rem01043#103; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 887
   aAlfa = #rem01043#104; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 888
   aAlfa = #rem01043#105; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 889
   aAlfa = #rem01043#106; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 938 (NIF)
   |SI #rem01043#107 ! 0; aAlfa = #rem01043#144; |SINO; aAlfa = " " * 9; |FINSI;
   TipoDato = "An"; Long = 9;  LongDec = 0;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 890
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01043#107; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 891
   aAlfa = #rem01043#108; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 892
   aAlfa = #rem01043#109; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 717 Madrid
   aAlfa = #rem01043#110; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Deducciones autonomicas : Murcia : Casilla 893
   aAlfa = #rem01043#111; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 894
   aAlfa = #rem01043#112; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 895
   aAlfa = #rem01043#113; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 896
   aAlfa = #rem01043#114; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 897
   aAlfa = #rem01043#115; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 717 Murcia
   aAlfa = #rem01043#116; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Deducciones autonomicas : La Rioja : Casilla 898
   aAlfa = #rem01043#117; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 899
   aAlfa = #rem01043#118; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 900
   aAlfa = #rem01043#119; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 901
   aAlfa = #rem01043#120; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 717 La Rioja
   aAlfa = #rem01043#121; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Deducciones autonomicas : Comunidad Valenciana : Casilla 902
   aAlfa = #rem01043#122; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 903
   aAlfa = #rem01043#123; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 904
   aAlfa = #rem01043#124; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 905
   aAlfa = #rem01043#125; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 906
   aAlfa = #rem01043#126; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 907
   aAlfa = #rem01043#127; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 908
   aAlfa = #rem01043#128; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 909
   aAlfa = #rem01043#129; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 910
   aAlfa = #rem01043#130; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 911
   aAlfa = #rem01043#131; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 912
   aAlfa = #rem01043#132; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 913
   aAlfa = #rem01043#133; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 914
   aAlfa = #rem01043#134; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Casilla 938 (NIF)
   |SI #rem01043#135 ! 0; aAlfa = #rem01043#144; |SINO; aAlfa = " " * 9; |FINSI;
   TipoDato = "An"; Long = 9;  LongDec = 0;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 915
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01043#135; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 939 (NIF)
   |SI #rem01043#136 ! 0; aAlfa = #rem01043#145; |SINO; aAlfa = " " * 9; |FINSI;
   TipoDato = "An"; Long = 9;  LongDec = 0;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 916
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01043#136; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 917
   aAlfa = #rem01043#137; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 918
   aAlfa = #rem01043#138; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 919
   aAlfa = #rem01043#139; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 920
   aAlfa = #rem01043#140; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 921
   aAlfa = #rem01043#141; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 922
   aAlfa = #rem01043#142; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 717 Comunidad Valenciana
   aAlfa = #rem01043#143; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   Cadena = "</T10017>" + &13 + &10; |HAZ GrabaCad;
   |CIERRA #rem01043;
|FPRC;

|PROCESO Hoja18;
   nSwDatos = 18; nCalc1 = 0; |HAZ MiraSiDatos;
   |SI nSwDatos = 0; |ACABA; |FINSI;

   aTipo = VTipo % 0110;
   Cadena = "<T10018> ";

   |ABRE #rem01042;
   #rem01042#0 = VEmpresa;
   #rem01042#1 = 0;
   #rem01042#2 = aTipo;
   |LEE 000#rem01042.=;
   |SI FSalida ! 0; |DDEFECTO #rem01042; |FINSI;

   TipoDato = "N"; Long = 11;  LongDec = 2;
   || Deducciones por incentivos y estimulos a la inversion empresarial : Saldo anterior
   aAlfa = #rem01042#3; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 940
   aAlfa = #rem01042#4; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#5; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Regimenes especiales de apoyo acontecimientos especial interes publico : Saldo anterior
   aAlfa = #rem01042#6; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 941
   aAlfa = #rem01042#7; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#8; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones de 2008
   || Regimen general de la LISS: Saldo anterior
   aAlfa = #rem01042#9; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 942
   aAlfa = #rem01042#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Pendiente de aplicacion
   aAlfa = #rem01042#11; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Actividades de I+D+I: Saldo anterior
   aAlfa = #rem01042#12; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 943
   aAlfa = #rem01042#13; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#14; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Actividades de exportacion: Saldo anterior
   aAlfa = #rem01042#15; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 944
   aAlfa = #rem01042#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Inversiones o gastos art.38 de la LIS: Saldo anterior
   aAlfa = #rem01042#18; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 945
   aAlfa = #rem01042#19; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#20; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Inversiones medioambientales: Saldo anterior
   aAlfa = #rem01042#21; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 946
   aAlfa = #rem01042#22; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#23; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Gastos de formacion profesional: Saldo anterior
   aAlfa = #rem01042#24; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 947
   aAlfa = #rem01042#25; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#26; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Creacion de empleo para trabajadores minusvalidos: Saldo anterior
   aAlfa = #rem01042#27; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 948
   aAlfa = #rem01042#28; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#29; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Regimenes de apoyo a acontecimientos de especial interes publico: Saldo anterior
   aAlfa = #rem01042#30; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 949
   aAlfa = #rem01042#31; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#32; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Regimen especial 'Pekin 2008': Saldo anterior
   aAlfa = #rem01042#33; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 950
   aAlfa = #rem01042#34; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#35; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Regimen especial 'Expo Zaragoza 2008': Saldo anterior
   aAlfa = #rem01042#36; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 951
   aAlfa = #rem01042#37; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#38; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Regimen especial 'Alicante 2008. Vuelta al mundo a vela': Saldo anterior
   aAlfa = #rem01042#39; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Aplicado en esta declaracion Casilla 952
   aAlfa = #rem01042#40; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#41; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Regimen especial 'Barcelona World Race': Saldo anterior
   aAlfa = #rem01042#42; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 953
   aAlfa = #rem01042#43; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#44; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Regimen especial 'Ao jubilar Guadalupense 2007': Saldo anterior
   aAlfa = #rem01042#45; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 954
   aAlfa = #rem01042#46; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#47; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Saldo anterior
   aAlfa = #rem01042#48; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 955
   aAlfa = #rem01042#49; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Pendiente de aplicacion
   aAlfa = #rem01042#50; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Saldo anterior
   aAlfa = #rem01042#51; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 956
   aAlfa = #rem01042#52; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#53; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Saldo anterior
   aAlfa = #rem01042#54; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 957
   aAlfa = #rem01042#55; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#56; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Saldo anterior
   aAlfa = #rem01042#57; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 960
   aAlfa = #rem01042#58; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#59; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Saldo anterior
   aAlfa = #rem01042#60; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 961
   aAlfa = #rem01042#61; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#62; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Saldo anterior
   aAlfa = #rem01042#63; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 962
   aAlfa = #rem01042#64; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#65; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Saldo anterior
   aAlfa = #rem01042#66; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 963
   aAlfa = #rem01042#67; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#68; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Saldo anterior
   aAlfa = #rem01042#69; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 964
   aAlfa = #rem01042#70; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#71; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Saldo anterior
   aAlfa = #rem01042#72; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Aplicado en esta declaracion Casilla 965
   aAlfa = #rem01042#73; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#74; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Saldo anterior
   aAlfa = #rem01042#75; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 966
   aAlfa = #rem01042#76; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#77; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Saldo anterior
   aAlfa = #rem01042#78; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 967
   aAlfa = #rem01042#79; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#80; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Saldo anterior
   aAlfa = #rem01042#81; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 968
   aAlfa = #rem01042#82; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Pendiente de aplicacion
   aAlfa = #rem01042#83; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Saldo anterior
   aAlfa = #rem01042#84; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 969
   aAlfa = #rem01042#85; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#86; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Saldo anterior
   aAlfa = #rem01042#87; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Aplicado en esta declaracion Casilla 970
   aAlfa = #rem01042#88; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente de aplicacion
   aAlfa = #rem01042#89; |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Casilla 975
   aAlfa = #rem01042#90; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 706
   aAlfa = #rem01042#91; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 707
   aAlfa = #rem01042#92; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Reserva inversiones Canarias : Importe dotaciones 2004
   aAlfa = #rem01042#93; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Materializaciones 2007 : Casilla 980
   aAlfa = #rem01042#94; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Clave
   TipoDato = "N"; Long = 1;  LongDec = 0;
   aAlfa = #rem01042#95; |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Importe dotaciones 2005
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01042#96; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Materializaciones 2008 : Casilla 982
   aAlfa = #rem01042#97; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Clave
   TipoDato = "N"; Long = 1;  LongDec = 0;
   aAlfa = #rem01042#98; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente materializar
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01042#99; |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Importe dotaciones 2006
   aAlfa = #rem01042#100; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Materializaciones 2008 : Casilla 984
   aAlfa = #rem01042#101; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Clave
   TipoDato = "N"; Long = 1;  LongDec = 0;
   aAlfa = #rem01042#102; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Pendiente materializar
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01042#103; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   || Casilla 986
   aAlfa = #rem01042#104; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 987
   aAlfa = #rem01042#105; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 988
   aAlfa = #rem01042#106; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 989
   aAlfa = #rem01042#107; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 990
   aAlfa = #rem01042#108; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 991
   aAlfa = #rem01042#109; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 992
   aAlfa = #rem01042#110; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 993
   aAlfa = #rem01042#111; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Suma casillas 708 y 709
   Bloque = 35; Casilla = "708"; |HAZ BuscaCasilla; nCalc  = Casilla;
   Bloque = 36; Casilla = "709"; |HAZ BuscaCasilla; nCalc1 = Casilla;
   nCalc = nCalc + nCalc1
   aAlfa = nCalc; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 994
   aAlfa = #rem01042#112; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Casilla 995
   aAlfa = #rem01042#113; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad; Cadena = "";

   Cadena = "</T10018>" + &13 + &10; |HAZ GrabaCad;
   |CIERRA #rem01042;
|FPRC;

|PROCESO Hoja19;
   nSwDatos = 0; nCalc1 = 0; nConCta = 0;
   aTipo = VTipo % 0110;

   Cadena = "<T10019> ";

   TipoDato = "N"; Long = 11; LongDec = 2;
   #rem01001#0 = VEmpresa;
   #rem01001#1 = 0;
   #rem01001#2 = VTipo;
   |LEE 000#rem01001.=;
   |SI FSalida = 0;
      nTotal = 0; nSusp = 0;
      || Liquidacion : Resultado a ingresar o a devolver
      Bloque = 41;     Casilla = "768"; |HAZ BuscaCasilla; nTotal = Casilla;
      |SI SwError = 1; |O nTotal = 0;
         Bloque = 42;     Casilla = "769"; |HAZ BuscaCasilla; nTotal = Casilla;
      |FINSI;
      |SI SwError = 1; |O nTotal = 0;
         Bloque = 39;     Casilla = "760"; |HAZ BuscaCasilla; nTotal = Casilla;
         nSusp = 0;
      |SINO;
         nSusp = 1;
         nTotal = #rem01001#16;
      |FINSI;

      nConCta = 0;
      || Liquidacion : Resultado a ingresar o a devolver
      aAlfa = nTotal; |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Liquidacion : Solicitud de suspension del ingreso conyuge/renuncia a la devol.otro conyuge
      aAlfa = nSusp; Cadena = Cadena + aAlfa;
      || Declaracion complementaria : Resultado de la decl.complementaria
      Bloque = 40;     Casilla = "765"; |HAZ BuscaCasilla;

      |SI #rem01001#14 = "4"; Casilla = 0; |FINSI; || PEPE

      nCalc = Casilla;
      aAlfa = Casilla; |HAZ Formateo;  Cadena = Cadena + aAlfa;
      |SI nCalc ! 0; nTotal = nCalc; |FINSI;
      nConCta = 0;
      |SI nTotal > 0;
         || Ingreso : Fracciona o no el pago
         |SI #rem01001#8 = "S"; aAlfa = "01"; |SINO; aAlfa = "10"; |FINSI;
         Cadena = Cadena + aAlfa;
         || Ingreso : Importe del ingreso
         nCalc1 = #rem01001#16;
         |SI #rem01001#8 = "S"; nCalc1 = (nCalc1 % 60) ! 2; |FINSI;
         aAlfa = nCalc1; |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Ingreso : Forma de pago
         |SI #rem01001#9 = "E"; aAlfa = "1";              |FINSI;
         |SI #rem01001#9 = "A"; aAlfa = "2"; nConCta = 1; |FINSI;
         |SI #rem01001#9 = "D"; aAlfa = "3"; nConCta = 1; |FINSI;
         Cadena = Cadena + aAlfa;
         || Opciones de pago 2 plazo : Si domicilia o no el 2 pago
         |SI #rem01001#8 = "S";
            |SI #rem01001#10 = "S";
               aAlfa = "01"; nConCta = 1;
            |SINO;
               aAlfa = "10";
            |FINSI;
         |SINO;
            aAlfa = "00";
         |FINSI;
         Cadena = Cadena + aAlfa;
         || Opciones de pago 2 plazo : Importe 2 plazo
         nCalc1 = 0;
         |SI #rem01001#8 = "S"; |Y #rem01001#10 = "S"; nCalc1 = (#rem01001#16 % 40) ! 2; |FINSI;
         aAlfa = nCalc1; |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Opciones de pago 2 plazo : Codigo cuenta
      |SINO;
         || Ingreso : Fracciona o no el pago
         Cadena = Cadena + "00";
         || Ingreso : Importe del ingreso
         aAlfa = 0; |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Ingreso : Forma de pago
         Cadena = Cadena + "0";
         || Opciones de pago 2 plazo : Si domicilia o no el 2 pago
         Cadena = Cadena + "00";
         || Opciones de pago 2 plazo : Importe 2 plazo
         aAlfa = 0; |HAZ Formateo; Cadena = Cadena + aAlfa;
      |FINSI;
      |SI nTotal < 0;
         nTotal = 0 - nTotal; aAlfa = "";
         || Devolucion : Renuncia a la devolucion o Devolucion por transferencia
         |SI #rem01001#11 = "X";
            Cadena = Cadena + "2";
         |SINO;
            |SI #rem01001#12 = "X";
               Cadena = Cadena + "1";
               nConCta = 1;
            |SINO;
               Cadena = Cadena + "0";
            |FINSI;
         |FINSI;
         || Devolucion : Importe de la devolucion
         aAlfa = nTotal; |HAZ Formateo; Cadena = Cadena + aAlfa;
      |SINO;
         || Devolucion : Renuncia a la devolucion o Devolucion por transferencia
         Cadena = Cadena + "0";
         || Devolucion : Importe de la devolucion
         aAlfa = 0; |HAZ Formateo; Cadena = Cadena + aAlfa;
      |FINSI;
      || Codigo cuenta
      |SI nConCta = 1;
         Cadena = Cadena + aCuenta1;
      |SINO;
         Cadena = Cadena + ("0" * 20);
      |FINSI;
      Cadena = Cadena + "</T10019>" + &13 + &10; |HAZ GrabaCad;
   |FINSI;

|FPRC;

|PROCESO GrabaCad;
   |SI aIP ! "";
      |XGRABA Handle, Cadena; Cadena = "";
   |SINO;
      Cadena = Handle + " " + Cadena; |FGRABA Cadena; Cadena = "";
   |FINSI;
|FPRC;

***************************************************************************
**** PROCESOS DE IMPRESION ************************************************
***************************************************************************

|PROCESO CuentaPags;
   aAlfa = aFichRef; nContb = 0; nNumPag = 0;
   |CARGA_DEF aAlfa, Refere2@;
   |SI FSalida = 0;
      |ABRE #Refere2@;
      #Refere2@#0 = VEmpresa;
      #Refere2@#1 = 0;
      #Refere2@#2 = aTipo; aTipo = #Refere2@#2;
      #Refere2@#3 = 0;
      |LEE 000#Refere2@.];
      |PARA; |SI FSalida = 0; |Y #Refere2@#0 = VEmpresa; |Y #Refere2@#2 = aTipo; |Y #Refere2@#1 = 0; |HACIENDO;
         |SI nNumPag = 0; nNumPag = 1; |FINSI;
         nContb = nContb + 1;
         |SI nContb > nBloq; nNumPag = nNumPag + 1; nContb = nContb - nBloq; |FINSI;
         |LEE 000#Refere2@.s;
      |SIGUE;
      |CIERRA #Refere2@; |DESCARGA_DEF #Refere2@;
   |FINSI;
|FPRC;

|PROCESO GrabaEtiq;
   Cadena = "";
   |PARA; |SI nCalc > 0; |HACIENDO nCalc = nCalc - 1;
      Cadena = Cadena + aPag;
   |SIGUE;
   |SI Cadena ! "";
      aAlfa = Cadena % 0; nCalc = aAlfa;
      nCharGrabados = nCharGrabados + nCalc;
      |HAZ GrabaCad; Cadena = "";
   |FINSI;
|FPRC;

|PROCESO GrabaVector;
   nCharGrabados = 0;
   || Las paginas 1 y 2 son obligatorias
   Cadena = "001002"; |HAZ GrabaCad; Cadena = "";
   nCharGrabados = 6;

   aTipo = VTipo % 0110;
   || Pagina 3
   Cadena = "";
   |ABRE #rem01010;
   #rem01010#0 = VEmpresa;
   #rem01010#1 = 0;
   #rem01010#2 = aTipo;
   |LEE 000#rem01010.=;
   |SI FSalida = 0;
      |SI #rem01010#3 ! 0; |O #rem01010#4  ! 0; |O #rem01010#5 ! 0;
      |O #rem01010#6  ! 0; |O #rem01010#7  ! 0; |O #rem01010#8 ! 0;
      |O #rem01010#16 ! 0; |O #rem01010#9  ! 0; |O #rem01010#24 ! 0;
      |O #rem01010#10 ! 0; |O #rem01010#11 ! 0; |O #rem01010#12 ! 0;
      |O #rem01010#13 ! 0; |O #rem01010#14 ! 0; |O #rem01010#15 ! 0;
      |O #rem01010#17 ! 0; |O #rem01010#25 ! 0; |O #rem01010#26 ! 0;
      |O #rem01010#27 ! 0; |O #rem01010#28 ! 0; |O #rem01010#23 ! 0;
         Cadena = "003";
      |FINSI;
   |FINSI;
   |CIERRA #rem01010;

   |SI Cadena = "";
      |ABRE #rem01012;
      #rem01012#0 = VEmpresa;
      #rem01012#1 = 0;
      #rem01012#2 = aTipo;
      |LEE 000#rem01012.=;
      |SI FSalida = 0;
         |SI #rem01012#3  ! 0; |O #rem01012#19 ! 0; |O #rem01012#4  ! 0;
         |O  #rem01012#5  ! 0; |O #rem01012#6  ! 0; |O #rem01012#7  ! 0;
         |O  #rem01012#20 ! 0; |O #rem01012#9  ! 0; |O #rem01012#10 ! 0;
         |O  #rem01012#13 ! 0; |O #rem01012#15 ! 0; |O #rem01012#16 ! 0;
         |O  #rem01012#21 ! 0; |O #rem01012#22 ! 0; |O #rem01012#23 ! 0;
         |O  #rem01012#24 ! 0; |O #rem01012#8  ! 0; |O #rem01012#25 ! 0;
         |O  #rem01012#26 ! 0; |O #rem01012#27 ! 0; |O #rem01012#14 ! 0;
         |O  #rem01012#28 ! 0;
            Cadena = "003";
         |FINSI;
      |FINSI;
      |CIERRA #rem01012;
   |FINSI;
   |SI Cadena ! "";
      aAlfa = Cadena % 0; nCalc = aAlfa;
      nCharGrabados = nCharGrabados + nCalc;
      |HAZ GrabaCad; Cadena = "";
   |FINSI;

   || Pagina 4
   aFichRef = "rem01011"; nBloq = 3; |HAZ CuentaPags; nCalc1 = nNumPag;
   aFichRef = "rem01015"; nBloq = 3; |HAZ CuentaPags; nCalc2 = nNumPag;
   aFichRef = "rem01013"; nBloq = 3; |HAZ CuentaPags; nCalc3 = nNumPag;
   nCalc = nCalc1;
   |SI nCalc2 > nCalc; nCalc = nCalc2; |FINSI;
   |SI nCalc3 > nCalc; nCalc = nCalc3; |FINSI;
   aPag = "004"; |HAZ GrabaEtiq;

   || Pagina 5
   aFichRef = "rem01014"; nBloq = 3; |HAZ CuentaPags;   nCalc = nNumPag;
   |SI nNumPag = 0;
      Bloque = 5;     Casilla = "140"; |HAZ BuscaCasilla; nCalc = Casilla;
      |SI nCalc ! 0; nNumPag = 1; |FINSI;
   |FINSI;
   aPag = "005"; |HAZ GrabaEtiq;

   || Pagina 6
   aFichRef = "rem01019"; nBloq = 2; |HAZ CuentaPags;   nCalc = nNumPag;
   |SI nNumPag = 0;
      Bloque = 6;     Casilla = "170"; |HAZ BuscaCasilla; nCalc = Casilla;
      |SI nCalc ! 0; nNumPag = 1; |FINSI;
   |FINSI;
   aPag = "006"; |HAZ GrabaEtiq;

   || Pagina 7
   aFichRef = "rem01021"; nBloq = 2; |HAZ CuentaPags;   nCalc = nNumPag;
   |SI nNumPag = 0;
      Bloque = 7;     Casilla = "195"; |HAZ BuscaCasilla; nCalc = Casilla;
      |SI nCalc ! 0; nNumPag = 1; |FINSI;
   |FINSI;
   aPag = "007"; |HAZ GrabaEtiq;

   || Pagina 8
   aFichRef = "rem01022"; nBloq = 3; |HAZ CuentaPags;   nCalc1 = nNumPag;
   aFichRef = "rem01023"; nBloq = 3; |HAZ CuentaPags;   nCalc2 = nNumPag;
   aFichRef = "rem01024"; nBloq = 3; |HAZ CuentaPags;   nCalc3 = nNumPag;
   aFichRef = "rem01025"; nBloq = 3; |HAZ CuentaPags;   nCalc4 = nNumPag;
   nCalc = nCalc1;
   |SI nCalc < nCalc2; nCalc = nCalc2; |FINSI;
   |SI nCalc < nCalc3; nCalc = nCalc3; |FINSI;
   |SI nCalc < nCalc4; nCalc = nCalc4; |FINSI;

   |SI nCalc = 0;
      |ABRE #rem01026;
      #rem01026#0 = VEmpresa;
      #rem01026#1 = 0;
      #rem01026#2 = aTipo;
      |LEE 000#rem01026.=;
      |SI FSalida = 0;
         |SI #rem01026#13 ! 0; |O #rem01026#22 ! 0; |O #rem01026#14 ! 0;
          |O #rem01026#15 ! 0; |O #rem01026#16 ! 0; |O #rem01026#17 ! 0;
          |O #rem01026#18 ! 0; |O #rem01026#19 ! 0; |O #rem01026#20 ! 0;
          |O #rem01026#3  ! 0; |O #rem01026#4  ! 0; |O #rem01026#6  ! 0;
          |O #rem01026#7  ! 0; |O #rem01026#8  ! 0; |O #rem01026#9  ! 0;
          |O #rem01026#10 ! 0; |O #rem01026#11 ! 0;
             nCalc = 1;
         |FINSI;
      |SINO;
         nCalc = 0;
      |FINSI;
      |CIERRA #rem01026;
   |FINSI;
   aPag = "008"; |HAZ GrabaEtiq;

   || Pagina 9
   aFichRef = "rem01027"; nBloq = 3; |HAZ CuentaPags;   nCalc1 = nNumPag;
   aFichRef = "rem01039"; nBloq = 3; |HAZ CuentaPags;   nCalc2 = nNumPag;
   aFichRef = "rem01031"; nBloq = 2; |HAZ CuentaPags;   nCalc3 = nNumPag;
   nCalc = nCalc1;
   |SI nCalc < nCalc2; nCalc = nCalc2; |FINSI;
   |SI nCalc < nCalc3; nCalc = nCalc3; |FINSI;
   |SI nCalc = 0;
      |ABRE #rem01033;
      #rem01033#0 = VEmpresa;
      #rem01033#1 = 0;
      #rem01033#2 = aTipo;
      |LEE 000#rem01033.=;
      |SI FSalida = 0;
         |SI #rem01033#3 ! 0; |O #rem01033#4  ! 0; |O #rem01033#5  ! 0;
          |O #rem01033#6 ! 0; |O #rem01033#7  ! 0; |O #rem01033#8  ! 0;
          |O #rem01033#9 ! 0; |O #rem01033#10 ! 0; |O #rem01033#11 ! 0;
            nCalc = 1;
         |FINSI;
      |FINSI;
      |CIERRA #rem01033;
   |FINSI;
   aPag = "009"; |HAZ GrabaEtiq;

   || Pagina 10
   aFichRef = "rem01032"; nBloq = 3; |HAZ CuentaPags;   nCalc1 = nNumPag;
   aFichRef = "rem01030"; nBloq = 3; |HAZ CuentaPags;   nCalc2 = nNumPag;
   nCalc = 1; || Es obligatoria
   |SI nCalc < nCalc1; nCalc = nCalc1; |FINSI;
   |SI nCalc < nCalc2; nCalc = nCalc2; |FINSI;
   aPag = "010"; |HAZ GrabaEtiq;

   || Pagina 11
   nCalc = 1; aPag = "011"; |HAZ GrabaEtiq;

   || Pagina 12
   nCalc = 1; aPag = "012"; |HAZ GrabaEtiq;

   || Pagina 13
   nCalc = 1; aPag = "013"; |HAZ GrabaEtiq;

   || Pagina 14
   |ABRE #rem01041;
   #rem01041#0 = VEmpresa;
   #rem01041#1 = 0;
   #rem01041#2 = aTipo;
   |LEE 000#rem01041.=;
   |SI FSalida = 0;
      |SI #rem01041#4  ! 0; |O #rem01041#5  ! 0; |O #rem01041#7  ! 0;
       |O #rem01041#8  ! 0; |O #rem01041#10 ! 0; |O #rem01041#11 ! 0;
       |O #rem01041#24 ! 0; |O #rem01041#25 ! 0; |O #rem01041#26 ! 0;
       |O #rem01041#27 ! 0; |O #rem01041#28 ! 0; |O #rem01041#29 ! 0;
       |O #rem01041#30 ! 0; |O #rem01041#33 ! 0; |O #rem01041#85 ! 0;
       |O #rem01041#86 ! 0; |O #rem01041#87 ! 0; |O #rem01041#38 ! 0;
       |O #rem01041#39 ! 0; |O #rem01041#40 ! 0; |O #rem01041#41 ! 0;
       |O #rem01041#42 ! 0; |O #rem01041#43 ! 0; |O #rem01041#34 ! 0;
       |O #rem01041#35 ! 0; |O #rem01041#36 ! 0; |O #rem01041#37 ! 0;
       |O #rem01041#44 ! 0; |O #rem01041#45 ! 0; |O #rem01041#46 ! 0;
       |O #rem01041#47 ! 0; |O #rem01041#48 ! 0; |O #rem01041#49 ! 0;
       |O #rem01041#50 ! 0;
         nCalc = 1; aPag = "014"; |HAZ GrabaEtiq;
      |FINSI;
   |FINSI;

   || Pagina 15
   |ABRE #rem01043;
   #rem01043#0 = VEmpresa;
   #rem01043#1 = 0;
   #rem01043#2 = aTipo;
   |LEE 000#rem01043.=;
   |SI FSalida = 0;
      |SI #rem01043#13  ! 0; |O #rem01043#19  ! 0; |O #rem01043#28  ! 0;
       |O #rem01043#38  ! 0; |O #rem01043#53  ! 0;
         nCalc = 1; aPag = "015"; |HAZ GrabaEtiq;
      |FINSI;
   |FINSI;

   || Pagina 16
   |ABRE #rem01043;
   #rem01043#0 = VEmpresa;
   #rem01043#1 = 0;
   #rem01043#2 = aTipo;
   |LEE 000#rem01043.=;
   |SI FSalida = 0;
      |SI #rem01043#59  ! 0; |O #rem01043#67  ! 0; |O #rem01043#78  ! 0;
       |O #rem01043#86  ! 0; |O #rem01043#94  ! 0;
         nCalc = 1; aPag = "016"; |HAZ GrabaEtiq;
      |FINSI;
   |FINSI;

   || Pagina 17
   |ABRE #rem01043;
   #rem01043#0 = VEmpresa;
   #rem01043#1 = 0;
   #rem01043#2 = aTipo;
   |LEE 000#rem01043.=;
   |SI FSalida = 0;
      |SI #rem01043#102 ! 0; |O #rem01043#110 ! 0; |O #rem01043#116 ! 0;
       |O #rem01043#121 ! 0; |O #rem01043#143 ! 0;
         nCalc = 1; aPag = "017"; |HAZ GrabaEtiq;
      |FINSI;
   |FINSI;

   || Pagina 18
   |ABRE #rem01042;
   #rem01042#0 = VEmpresa;
   #rem01042#1 = 0;
   #rem01042#2 = aTipo;
   |LEE 000#rem01042.=;
   |SI FSalida = 0;
      nCalc = 0;
      |PARA nCont = 3; |SI nCont [ 94; |HACIENDO nCont = nCont + 1;
         |SI #rem01042#nCont# ! 0; nCalc = 1; |SAL; |FINSI;
      |SIGUE;
      |SI nCalc = 0;
         |SI #rem01042#96  ! 0; |O #rem01042#97  ! 0;
          |O #rem01042#99  ! 0; |O #rem01042#100 ! 0; |O #rem01042#101 ! 0;
          |O #rem01042#103 ! 0; |O #rem01042#104 ! 0; |O #rem01042#105 ! 0;
          |O #rem01042#106 ! 0; |O #rem01042#107 ! 0; |O #rem01042#108 ! 0;
          |O #rem01042#109 ! 0; |O #rem01042#110 ! 0; |O #rem01042#111 ! 0;
          |O #rem01042#112 ! 0; |O #rem01042#113 ! 0;
             nCalc = 1;
          |FINSI;
      |FINSI;
      aPag = "018"; |HAZ GrabaEtiq;
   |FINSI;

   || Las paginas 19 es obligatoria
   Cadena = "019FIN"; |HAZ GrabaCad; Cadena = "";
   nCharGrabados = nCharGrabados + 6;

   |PARA; |SI nCharGrabados < 290; |HACIENDO nCharGrabados = nCharGrabados + 10;
      Cadena = " " * 10; |HAZ GrabaCad;
   |SIGUE;

   nCalc = 300 - nCharGrabados;
   Cadena = " " * nCalc; |HAZ GrabaCad;
|FPRC;

|PROCESO ImprimeLos;
   aIP = ""; |IP_REMOTO aIP;

   VEmpresa = #99#0; VTipo    = #99#2;
   aNif = #99#7; |QBF aNif; aNif = aNif % 0108;

   |SI enMinEmp > VEmpresa; enMinEmp = VEmpresa; |FINSI;
   |SI enMaxEmp < VEmpresa; enMaxEmp = VEmpresa; |FINSI;

   Nombre = ("00000" + VEmpresa) % -105;
   Nombre = "or" + Nombre;
   |QBF Nombre;
   Comodin = VTipo; |QBF Comodin;
   |SI Comodin = "CONJUNTA";  Comodin = "A"; |FINSI;
   |SI Comodin = "CONJUNTAE"; Comodin = "A"; |FINSI;
   Nombre = Nombre + (Comodin % 0101);
   |QBF Nombre;

   NEmpresas  = Nombre;
   INEmpresas = INEmpresas + 1;

   Comodin = "\AEAT";          |SI aIP ! ""; |RMKDIR Comodin; |SINO; |MKDIR Comodin; |FINSI;
   Comodin = "\AEAT\100";      |SI aIP ! ""; |RMKDIR Comodin; |SINO; |MKDIR Comodin; |FINSI;
   Comodin = "\AEAT\100\2008"; |SI aIP ! ""; |RMKDIR Comodin; |SINO; |MKDIR Comodin; |FINSI;
   |SI #0#34 = "L";
      |SI SwCopia = 1;
         Comodin = #reemi100#64 + ":\AEAT";              |SI aIP ! ""; |RMKDIR Comodin; |SINO; |MKDIR Comodin; |FINSI;
         Comodin = #reemi100#64 + ":\AEAT\INTERNET";     |SI aIP ! ""; |RMKDIR Comodin; |SINO; |MKDIR Comodin; |FINSI;
         Comodin = #reemi100#64 + ":\AEAT\INTERNET\100"; |SI aIP ! ""; |RMKDIR Comodin; |SINO; |MKDIR Comodin; |FINSI;
         Comodin = #reemi100#64 + ":\AEAT\INTERNET\100\2008"; |SI aIP ! ""; |RMKDIR Comodin; |SINO; |MKDIR Comodin; |FINSI;
      |FINSI;
      Comodin = "\AEAT\100\2008\" + Nombre;
   |SINO;
      Comodin = #reemi100#64 + ":\AEAT";                   |SI aIP ! ""; |RMKDIR Comodin; |SINO; |MKDIR Comodin; |FINSI;
      Comodin = #reemi100#64 + ":\AEAT\INTERNET";          |SI aIP ! ""; |RMKDIR Comodin; |SINO; |MKDIR Comodin; |FINSI;
      Comodin = #reemi100#64 + ":\AEAT\INTERNET\100";      |SI aIP ! ""; |RMKDIR Comodin; |SINO; |MKDIR Comodin; |FINSI;
      Comodin = #reemi100#64 + ":\AEAT\INTERNET\100\2008"; |SI aIP ! ""; |RMKDIR Comodin; |SINO; |MKDIR Comodin; |FINSI;
      Comodin = "\AEAT\100\2008\" + Nombre;
   |FINSI;

   |SI aIP ! "";
      |XABRE "CWB", Comodin, Handle;
   |SINO;
      Comodin = "wb  " + Comodin; |FABRE Comodin;
   |FINSI;
   Handle = FSalida;
   |SI FSalida < 0; |MENAV "    Problemas al abrir el fichero ascii"; |ACABA; |FINSI;

   |ABRE #rem00101; |ABRE #rem01001; |ABRE #rem01002;
   #rem01001#0 = #99#0;
   #rem01001#1 = 0;
   VTipo = #99#2; |QBF VTipo;
   #rem01001#2 = VTipo;
   |LEE 000#rem01001.=;

   LongDec = 0;
   Cadena = "<T100020080A0000><AUX>";
   Cadena = Cadena + (" " * 100);
   |HAZ GrabaCad; Cadena = "";

   Cadena = Cadena + (" " * 100);
   Cadena = Cadena + (" " * 100);
   |HAZ GrabaCad; Cadena = "";

   Cadena = "</AUX><VECTOR>"
   |HAZ GrabaCad; Cadena = "";
   |HAZ GrabaVector;
   Cadena = "</VECTOR>";
   |HAZ GrabaCad; Cadena = "";

   |HAZ Hoja01;
   |HAZ Hoja02;
   |HAZ Hoja03;
   |HAZ Hoja04;
   |HAZ Hoja05;
   |HAZ Hoja06;
   |HAZ Hoja07;
   |HAZ Hoja08;
   |HAZ Hoja09;
   |HAZ Hoja10;
   |HAZ Hoja11;
   |HAZ Hoja12;
   |HAZ Hoja13;
   |HAZ Hoja14;
   |HAZ Hoja15;
   |HAZ Hoja16;
   |HAZ Hoja17;
   |HAZ Hoja18;
   |HAZ Hoja19;

   Cadena = "</T100020080A0000>" + &13 + &10;
   |HAZ GrabaCad; Cadena = "";

   #rem01001#0 = #99#0;
   #rem01001#1 = 0;
   VTipo = #99#2; |QBF VTipo;
   #rem01001#2 = VTipo;
   |LEE 101#rem01001.=;
   |SI FSalida = 0;
      #rem01001#6 = "S";
      |GRABA 020#rem01001.a; |LIBERA #rem01001;
   |FINSI;

   |ABRE #reacceso;
   #reacceso#0 = #99#0;
   |LEE 101#reacceso.=;
   |SI FSalida = 0;
      #reacceso#17 = #reemi100#33;
      |GRABA 020#reacceso.a; |LIBERA #reacceso;
   |FINSI;
   |CIERRA #reacceso;

   |CIERRA #rem01002; |CIERRA #rem00101; |CIERRA #rem01001;

   |SI aIP ! "";
      |XCIERRA Handle;
   |SINO;
      FSalida = Handle; |FCIERRA FSalida;
   |FINSI;

   SwDatos = 1;

|FPRC;

|PROCESO CopiaFich;
   aDestino = "/AEAT/100/2008/IR08LASE.EXE";
   |DBASE aAlfa; |QBF aAlfa; aAlfa = aAlfa + "hacienda/";
   aOrigen  = aAlfa + "ir08lase.exe";
   aContiene1 = aDestino;
   |ESPECIFICA "REMOTOMD5", aContiene;
   aDocRemoto = FSalida;  |QBF aDocRemoto;

   aContiene1 = aOrigen;
   |ESPECIFICA "MD5", aContiene;
   aDocServidor = FSalida;  |QBF aDocServidor;

   |SI aDocRemoto ! aDocServidor; nCopia = 1; |SINO; nCopia = 0; |FINSI;
   aIP = ""; |IP_REMOTO aIP;

   |DBASE aAlfa; |QBF aAlfa; aAlfa = aAlfa + "hacienda/";
   aOrigen  = aAlfa + "ir08lase.exe";
   aDestino = "/AEAT/100/2008/ir08lase.exe";
   |SI aIP ! "";
      |SI nCopia = 1; |ENVIA_FICHERO aOrigen, aDestino; |FINSI;
      aAlfa = "/AEAT/100/2008/imprime.bat";
      |XABRE "CW", aAlfa, Handle;
   |SINO;
      |SI nCopia = 1; |COPIA_FICHERO aOrigen, aDestino; |FINSI;
      aAlfa = "wt  /AEAT/100/2008/imprime.bat";
      |FABRE aAlfa; Handle = FSalida;
   |FINSI;

   |SI FSalida ] 0;
      Cadena = Cadena + "";
      aAlfa = "CD \AEAT\100\2008";
      |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

      |SI nCopia = 1
         aAlfa = "attrib -r *.*";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         aAlfa = "del *.WMF";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         aAlfa = "del *.TAB";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         aAlfa = "del *.DLL";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         aAlfa = "del VERSION.TXT";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         aAlfa = "del SIGLAS.TXT";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         aAlfa = "del ERR10002.TXT";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         aAlfa = "del PAISES.TXT";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         aAlfa = "del PROVINCI.TXT";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         aAlfa = "del R08PDF.EXE";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         aAlfa = "del WAIT.EXE";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         aAlfa = "ir08lase -y";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;
      |FINSI;

      INEmpresas = NEmpresas1<-;
      Nombre = NEmpresas;
      |PARA; |SI Nombre ! ""; |HACIENDO;
         aAlfa = "DEL " + (Nombre % 0107) + "*.TXT";
         |SI aAlfa ! aBorrAnt;
            aBorrAnt = aAlfa;
            |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;
         |FINSI;
         INEmpresas = INEmpresas + 1; Nombre = NEmpresas;
      |SIGUE;

      INEmpresas = NEmpresas1<-;
      Nombre = NEmpresas;
      |PARA; |SI Nombre ! ""; |HACIENDO;

         aAlfa = "DEL " + Nombre + ".TXT";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         |SI #0#34 = "L";
            aAlfa = "WAIT R08PDF /E:" + Nombre + " /R:" + Nombre + ".TXT /C:" + #reemi100#37;
         |FINSI;
         |SI #0#34 = "I";
            aAlfa = "WAIT R08PDF /E:" + Nombre + " /R:" + Nombre + ".TXT /C:" + #reemi100#37 + " /V:S";
         |FINSI;
         |SI #reemi100#62 ! "E"; aAlfa = aAlfa + " /L:" + #reemi100#62; |FINSI;
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;
         INEmpresas = INEmpresas + 1; Nombre = NEmpresas;
      |SIGUE;

      |SI #0#34 ! "I"; |Y SwCopia ! 1;
         aAlfa = "del or*.";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;
      |FINSI;

      |SI aIP ! "";
         |XCIERRA Handle;
      |SINO;
         FSalida = Handle; |FCIERRA FSalida;
      |FINSI;

      aAlfa = "/AEAT/100/2008/imprime.bat";
      |SI aIP ! ""; |RSYSTEM aAlfa; |SINO; |SYSTEM aAlfa; |FINSI;
   |SINO;
      |MENAV "    Problemas para crear el proceso por lotes que ejecuta el programa";
      |ERROR;
   |FINSI;
   VEmpresa = enEmpresa;
|FPRC;

|RUTINA inferior;
  #99#0 = 1;
  #99#1 = " ";
|FRUT;

|RUTINA superior;
  #99#0 = 99999;
  #99#1 = "z";
|FRUT;

|DEFBUCLE rew00001;
  #99#1;
  5;
  00000, " ", "S";
  99999, "z", "S";
  ;
  NULL, ImprimeLos;
|FIN;

******************** Tipo de Impresion

|PROCESO funcion1; |TIPO 11;
  |SI FSalida ! 9; |ACABA; |FINSI;

  |LIBERA #99;
  |LEE 140#99=;

  |SI #99#5 = "S"; #99#5 = "N"; |SINO; #99#5 = "S"; |FINSI;
  |PINTA #99#5;
  |GRABA 140#99a;
|FPRC;

|PROCESO MiraLiqui;
     |SI #1#5 ! "100";  |Y #1#5 ! "101";
         |ACABA;
     |FINSI;
/*
     |SI eaTipoEmi = "I"
         #1#6 = "S";
     |SINO;
         #1#6 = "N";
     |FINSI;
*/
     aAlfa = #99#2; |QBF aAlfa;
     |SI aAlfa = "CONJUNTA";  aAlfa = "A"; |FINSI;
     |SI aAlfa = "CONJUNTAE"; aAlfa = "A"; |FINSI;
     aAlfa     = aAlfa % 101;
     aFichero  = "or" + (("00000" + #1#0) % -105) + aAlfa + ".TXT";
     aFichero  = "C:/AEAT/100/2008/" + aFichero;
     |XABRE "EC", aFichero, nCanal;
     |SI FSalida < 0;
         || #1#6 = "S";
     |FINSI;
     |GRABA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE rem01001;
     #1#1;
     ;
     #99#0, 00, "          ";
     #99#0, 99, "zzzzzzzzzz";
     be;
     NULL, MiraLiqui;
|FIN;

|PROCESO GrabaTempo;
   #99#0 = #rem01001#0;
   #99#1 = "";
   #99#2 = #rem01001#2;
   Comodin = #99#2 % 0101;
   |SI #99#2 = "CONJUNTAE    ";
      Comodin = "J";
   |FINSI;
   |SI #99#2 = "CONJUNTA     ";
      Comodin = "N";
   |FINSI;
   #99#1 = Comodin;
   #99#3 = #rem01001#7;
   #99#4 = 1;
   #99#5 = "S";
   #99#6 = 1;
   #99#7 = "";
   #99#8 = #reemi100#60;
   #99#9 = #reemi100#61;
   |GRABA 000#99n;
   |SI FSalida = 0;
        SwEstar = 1;
   |FINSI;
|FPRC;

|DEFBUCLE DatosContrib;
  #rem01001#1;
  5,6;
  DEmpre,00,"          ","100",DReimp;
  HEmpre,99,"zzzzzzzzzz","101",HReimp;
  ;
  NULL, GrabaTempo;
|FIN;

|PROCESO CargaTempo;
  |DELINDEX #99;

  SwEstar = 0;

  |ABRE #99;

  |SI #0#36 = "S";
     DReimp = "N"; HReimp = "S";
  |SINO;
     DReimp = "N"; HReimp = "N";
  |FINSI;

  |SI #0#0 = "S";
      DEmpre = #0#1;
      HEmpre = #0#2;
      |BUCLE DatosContrib;
  |SINO;
      |PARA XCampos = 3; |SI XCampos [ 32; |HACIENDO XCampos = XCampos + 1;
            |SI #0XCampos ! 0;
                DEmpre = #0XCampos;
                HEmpre = #0XCampos;
                |BUCLE DatosContrib;
            |FINSI;
      |SIGUE;
  |FINSI;
  |CIERRA #99;

  |SI SwEstar = 0; |ACABA; |FINSI;

  |SI #0#35 = "N"; |ACABA; |FINSI;

  |ENTLINEAL #1#99, -1, 4, 19, 1, inferior, superior;
|FPRC;

|PROCESO Grabalos;
     |BUCLE rem01001;

     enEmpresa     = #99#0;
     enTipoEntrada = 99;
     |SUB_EJECUTA_NP "reacceso";
|FPRC;

|DEFBUCLE rew00001G;
     #99#1;
     5;
     00000, " ", "S";
     99999, "z", "S";
     ;
     NULL, Grabalos;
|FIN;

|PROCESO Emision;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
  |SI nBotonUnidad ! 0;
     |FIN_CONTROL_WINDOWS nBotonUnidad;
     nBotonUnidad = 0;
  |FINSI;

  Nombre = "or" + Usuario; |NOME_DAT #99 Nombre;

  |ABRE #rem01001;
  |HAZ CargaFecha;
  |HAZ CargaTempo;

  INEmpresas = NEmpresas1<-;
  SwDatos = 0;
  |SI #0#34 = "I";
     |CONFI "    NEmitir copia por impresora ? ";
     |SI FSalida = 0;
        SwCopia = 1; #0#34 = "L";
     |SINO;
        SwCopia = 0;
     |FINSI;
  |FINSI;

  enMinEmp = 999999; enMaxEmp = 000000;
  |BUCLE rew00001;

  |HAZ CopiaFich;

  nSwDatos = 0;
  |SI #0#34 = "I"; |O SwCopia = 1;
     || Lo que hago es copiar los ficheros OR?????? que no tengan su
     ||    correspondiente OR?????.TXT al directorio remoto
     aAlfa = "\AEAT\100\2008\or*";
     |SI aIP ! "";
        |R_PDIR aAlfa;
     |SINO;
        |_PDIR aAlfa;
     |FINSI;
     |PARA; |SI FSalida = 0; |HACIENDO;
        || Compruebo si hay extension
        nSwExt = 1;
        aAlfa1 = aAlfa; |QBT aAlfa1;
        aAlfa2 = aAlfa1 % -201;
        |SI aAlfa2 ! ".";
           aAlfa2 = aAlfa1 % -301;
           |SI aAlfa2 ! ".";
              aAlfa2 = aAlfa1 % -401;
              |SI aAlfa2 ! ".";
                 || No hay extension. Es un fichero de emision
                 nSwExt = 0;
              |FINSI;
           |FINSI;
        |FINSI;

        |SI nSwExt = 0;
           aAlfa1 = aAlfa; |QBF aAlfa1;
           aAlfa1 = aAlfa1 + ".txt";
           |XABRE "CE", aAlfa1, nHandle;
           |SI FSalida < 0;
              || Si no existe el .txt, lo copio ...
              aAlfa1 = aAlfa;
              aAlfa2 = aAlfa - "\AEAT\100\2008";
              aAlfa3 = aAlfa2 % 0101;
              |SI aAlfa3 = "\"; |O aAlfa3 = "/";
                 aAlfa2 = aAlfa2 % 0299;
              |FINSI;
              aAlfa2 = #reemi100#64 + ":\AEAT\INTERNET\100\2008\" + aAlfa2;
              |SI aIP ! "";
                 |RCOPIA_FICHERO aAlfa1, aAlfa2;
                 |RFBORRA aAlfa1;
              |SINO;
                 |COPIA_FICHERO aAlfa1, aAlfa2;
                 |FBORRA aAlfa1;
              |FINSI;
              nSwDatos = 1;
           |SINO;
              || ..... y si existe lo borro
              |SI aIP ! "";
                 |RFBORRA aAlfa;
              |SINO;
                 |FBORRA aAlfa;
              |FINSI;
           |FINSI;
        |FINSI;

        |SI aIP ! "";
           |R_SDIR aAlfa;
        |SINO;
           |_SDIR aAlfa;
        |FINSI;
     |SIGUE;
  |FINSI;

  eaTipoSec = "100/2008"; |HAZ Errores;

  |SI SwCopia = 1;
     INEmpresas = NEmpresas1<-;
     aAlfa = NEmpresas; |QBF aAlfa;
     |PARA; |SI aAlfa ! ""; |HACIENDO;
        aAlfa1  = "/AEAT/100/2008/" + aAlfa + ".TXT";
        |XABRE "EC", aAlfa1, nCanal;
        |SI FSalida ] 0;
           aAlfa1 = "/AEAT/INTERNET/100/2008/" + aAlfa;
           |RFBORRA aAlfa1;
        |FINSI;
        INEmpresas = INEmpresas + 1;
        aAlfa = NEmpresas; |QBF aAlfa;
     |SIGUE;
     #0#34 = "I";
  |FINSI;

  |SI #0#34 = "I"; |Y SwDatos = 1;
     |CONFI "    NDesea copiar los ficheros a diskette ?";
     |SI FSalida = 0;
        |MENAV "    Introduzca un diskette vacio en su PC";
        Comodin = "/AEAT/INTERNET/100/2008/";
        INEmpresas = NEmpresas1<-;
        Comodin2 = Comodin + NEmpresas;
        |SI NEmpresas ! "";
           |PARA; |SI NEmpresas ! ""; |HACIENDO;
              aDestino = "a:/" + NEmpresas;
              Comodin1 = "COPY " + Comodin2 + " " + aDestino;
              |RSYSTEM Comodin1;
              |RFBORRA Comodin2;
              INEmpresas = INEmpresas + 1;
              Comodin2 = Comodin + NEmpresas;
           |SIGUE;
        |FINSI;
     |FINSI;
     |HAZ PresentaAyuda;
  |FINSI;
  |CIERRA #rem01001;

  |BUCLE rew00001G;
|FPRC;

|PROCESO PresentaAyuda;
   |PUSHV 0501 2380;
   |BLANCO 0501 2380;
   |CUADRO 0701 2080;
   |ATRI R;
   aAlfa = " INFORMACION IMPORTANTE PARA LA PRESENTACION TELEMATICA DE DECLARACIONES      ";
   |PINTA 0702, aAlfa; |ATRI I;
   |PINTA 0804, " Los ficheros generados  para la presentacion telematica  de declaraciones";
   |PINTA 0904, " de renta podran recogerse  de la  carpeta 'AEAT/INTERNET/100/2008' de la ";
   |PINTA 1004, " maquina desde la que se han emitido, sabiendo que el formato del nombre  ";
   |PINTA 1104, " de los ficheros es el siguiente : ";
   |PINTA 1204, " * Los  dos primeros digitos coinciden para todas las declaraciones  de ";
   |PINTA 1304, "   renta ('or') ";
   |PINTA 1404, " * Los cinco siguientes digitos conforman el codigo de cliente ";
   |PINTA 1504, " * El ultimo  digito determinara el contribuyente  al que pertenece  la ";
   |PINTA 1604, "   declaracion, siendo las siguientes : ";
   |PINTA 1704, "       T - Titular           C - Conyuge        A - Conjunta";
   |PINTA 1804, "       1 - 1er.familiar      2 - 2. familiar ";
   |PINTA 1904, "       3 - 3er.familiar      4 - 4. familiar ";
   |ATRI N;
   |PAUSA; |POPV;
|FPRC;

|PROCESO SeparaNombre;
   aNom = ""; aApel1 = ""; aApel2 = "";
   nInd = 1;
   aLong = aAlfa % 0; nLong = aLong;
   aAlfa1 = "";
   |PARA nCalc = 1; |SI nCalc [ nLong; |HACIENDO nCalc = nCalc + 1;
      nPos = (nCalc * 100) + 1;
      aAlfa2 = aAlfa % nPos;
      |SI aAlfa2 = " "; |O aAlfa2 = ",";
         |SI aAlfa1 ! "DE";  |Y aAlfa1 ! "de";
          |Y aAlfa1 ! "LA";  |Y aAlfa1 ! "la";
          |Y aAlfa1 ! "LAS"; |Y aAlfa1 ! "las";
          |Y aAlfa1 ! "LOS"; |Y aAlfa1 ! "los";
          |Y aAlfa1 ! "DEL"; |Y aAlfa1 ! "del";
            |SI nInd = 1; |Y aAlfa1 ! ""; aApel1 = aApel1 + aAlfa1 + " "; |FINSI;
            |SI nInd = 2; |Y aAlfa1 ! ""; aApel2 = aApel2 + aAlfa1 + " "; |FINSI;
            |SI nInd ] 3; |Y aAlfa1 ! ""; aNom   = aNom   + aAlfa1 + " "; |FINSI;
             nInd = nInd + 1;
         |SINO;
            |SI nInd > 1; nInd = nInd - 1; |FINSI;
            |SI nInd = 1; |Y aAlfa1 ! ""; aApel1 = aApel1 + aAlfa1 + " "; |FINSI;
            |SI nInd = 2; |Y aAlfa1 ! ""; aApel2 = aApel2 + aAlfa1 + " "; |FINSI;
            |SI nInd ] 3; |Y aAlfa1 ! ""; aNom   = aNom   + aAlfa1 + " "; |FINSI;
         |FINSI;
         aAlfa1 = "";
      |SINO;
         aAlfa1 = aAlfa1 + aAlfa2;
      |FINSI;
   |SIGUE;

   |PARA; |SI SwSalir = 0; |HACIENDO;
      SwSalir = 1;
      aAlfa1 = aApel1 % 0101;
      |SI aAlfa1 = " "; aApel1 = aApel1 % 0299; SwSalir = 0; |FINSI;
      aAlfa1 = aApel2 % 0101;
      |SI aAlfa1 = " "; aApel2 = aApel2 % 0299; SwSalir = 0; |FINSI;
      aAlfa1 = aNom   % 0101;
      |SI aAlfa1 = " "; aNom   = aNom   % 0299; SwSalir = 0; |FINSI;
   |SIGUE;
|FPRC;

|PROCESO BuscaCasilla;
   #rem01002#0 = VEmpresa;
   #rem01002#1 = " ";
   #rem01002#2 = VTipo;
   #rem01002#3 = Bloque;
   #rem01002#4 = Casilla;
   |LEE 010#rem01002.=;
   |SI FSalida = 0;
       Casilla = #rem01002#6;
       SwError = 0;
   |SINO;
       Casilla = 0; SwError = 1;
   |FINSI;
|FPRC;

|PROCESO CargaFecha;
  DiaInf   = #0#33 % 102;
  MesNum   = #0#33 % 402;
  MesInf   = #0#33 % 402;
  EjerInf  = #0#33 % -104;

  |SI MesNum = "01"; MesInf = "Enero     "; |FINSI;
  |SI MesNum = "02"; MesInf = "Febrero   "; |FINSI;
  |SI MesNum = "03"; MesInf = "Marzo     "; |FINSI;
  |SI MesNum = "04"; MesInf = "Abril     "; |FINSI;
  |SI MesNum = "05"; MesInf = "Mayo      "; |FINSI;
  |SI MesNum = "06"; MesInf = "Junio     "; |FINSI;
  |SI MesNum = "07"; MesInf = "Julio     "; |FINSI;
  |SI MesNum = "08"; MesInf = "Agosto    "; |FINSI;
  |SI MesNum = "09"; MesInf = "Septiembre"; |FINSI;
  |SI MesNum = "10"; MesInf = "Octubre   "; |FINSI;
  |SI MesNum = "11"; MesInf = "Noviembre "; |FINSI;
  |SI MesNum = "12"; MesInf = "Diciembre "; |FINSI;

  MesInf = MesInf > MesInf;
|FPRC;

|PROCESO Formateo;
   |QBF aAlfa;
   |SI TipoDato = "F";
      aAlfa = aAlfa - "."; aAlfa = aAlfa - ".";
      |QBF aAlfa;
      |SI aAlfa = "";         aAlfa = "0" * 8; |FINSI;
      |SI aAlfa = "01010000"; aAlfa = "0" * 8; |FINSI;
      |ACABA;
   |FINSI;
   |SI TipoDato = "N";
      Vacio1 = "0" * Long;
      Vacio2 = "0" * LongDec;
      aAlfa = aAlfa - "-";
      |SI FSalida ! 0;
         nNegativo = 1;
      |SINO;
         nNegativo = 0;
      |FINSI;
   |SINO;
      Vacio1 = " " * Long;
   |FINSI;

   |SI TipoDato ! "N";
      Calc1 = 100 + Long; aAlfa = (aAlfa + Vacio1) % Calc1;
   |SINO;
      |SI LongDec = 0;
         Calc1 = 0 - (100 + Long);
         aAlfa = (Vacio1 + aAlfa) % Calc1;
      |SINO;
         aAlfa = aAlfa - ".";
         |SI FSalida = 0;
            Calc1 = 0 - (100 + Long);
            aAlfa = (Vacio1 + aAlfa) % Calc1;
            aAlfa1 = "0" * LongDec;
         |SINO;
            Calc1 = (((FSalida / 100) ! 0) - 1) + 100;
            Calc2 = (((FSalida / 100) ! 0) * 100) + 99;
            aAlfa1 = aAlfa % Calc2;
            aAlfa = aAlfa % Calc1;
            Calc1 = 0 - (100 + Long);
            aAlfa = (Vacio1 + aAlfa)  % Calc1;
            Calc1 = 100 + LongDec;
            aAlfa1 = (aAlfa1 + Vacio2) % Calc1;
         |FINSI;
         aAlfa = aAlfa + aAlfa1;
      |FINSI;
      |SI nNegativo = 1;
         Calc1 = 0 - (100 + (Long + LongDec)); Calc1 = Calc1 + 1;
         aAlfa = aAlfa % Calc1;
         aAlfa = "N" + aAlfa;
      |FINSI;
   |FINSI;

   aAlfa2 = "";

   |SI TipoDato = "A"; |O TipoDato = "An";
      aLong = aAlfa % 0; nLong = aLong;
      |PARA nCont1 = 1; |SI nCont1 [ nLong; |HACIENDO nCont1 = nCont1 + 1;
         Calc1 = (nCont1 * 100) + 1; aAlfa1  = aAlfa % Calc1;
         aAlfa1 = aAlfa1 > aAlfa1;
         |SI aAlfa1 = " ";                  |VETE Sigue1; |FINSI;
         |SI aAlfa1 ] "A"; |Y aAlfa1 [ "Z"; |VETE Sigue1; |FINSI;
         |SI aAlfa1 ] "0"; |Y aAlfa1 [ "9"; |VETE Sigue1; |FINSI;
         |SI aAlfa1 = ""; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = ""; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = ""; aAlfa1 = &199;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = ""; aAlfa1 = &199;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "-"; aAlfa1 = &45;    |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "'"; aAlfa1 = &49;    |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "/";                  |VETE Sigue1; |FINSI;
         |SI TipoDato = "An";
            |SI aAlfa1 = "&"; aAlfa1 = &38;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = ","; aAlfa1 = &44;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = "."; aAlfa1 = &46;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = ":"; aAlfa1 = &58;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = ";"; aAlfa1 = &59;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = "_"; aAlfa1 = &95;    |VETE Sigue1; |FINSI;
         |FINSI;
         aAlfa1 = " ";
|ET Sigue1;
         aAlfa2 = aAlfa2 + aAlfa1;
      |SIGUE;
      aAlfa = aAlfa2;
   |FINSI;
   Calc1 = aAlfa;
   |SI nSwDatos = 0; |Y Calc1 ! 0; nSwDatos = 1; |FINSI;
|FPRC;

|PROCESO TipoContr;
   |QBF aAlfa;
   |SI aAlfa = ""; aTipoContr = "0"; |ACABA; |FINSI;
   |SI aSeparada = "S";
     aTipoContr = "2";
   |SINO;
     aTipoContr = "0";
      |SI aAlfa = "TITULAR";   aTipoContr = "2"; |FINSI;
      |SI aAlfa = "CONYUGE";
         |SI VTipo = "CONYUGE      ";aTipoContr = "2"; |SINO;aTipoContr = "3"; |FINSI;
      |FINSI;
      |SI aAlfa = "COMUNES";   aTipoContr = "1"; |FINSI;
      |SI aAlfa = "CONJUNTA";  aTipoContr = "1"; |FINSI;
      |SI aAlfa = "CONJUNTAE"; aTipoContr = "1"; |FINSI;
      |SI aAlfa = "GANANCIAL"; aTipoContr = "1"; |FINSI;
      |SI aAlfa = "1 FAMILIAR";aTipoContr = "4"; |FINSI;
      |SI aAlfa = "2 FAMILIAR";aTipoContr = "5"; |FINSI;
      |SI aAlfa = "3 FAMILIAR";aTipoContr = "6"; |FINSI;
      |SI aAlfa = "4 FAMILIAR";aTipoContr = "7"; |FINSI;
      |SI aAlfa = "VARIOS";    aTipoContr = "2"; |FINSI;
   |FINSI;

|FPRC;

|PROCESO Seleccion; |TIPO 0;
  |SI enEmpresa ! 0;  |ACABA;  |FINSI;

  |SI #0#0 = "S";
      |CAMPO_MODIFICA #0#01, 1, "S";
      |CAMPO_MODIFICA #0#02, 1, "S";

      |PARA XCampos = 3; |SI XCampos [ 32; |HACIENDO XCampos = XCampos + 1;
            #0XCampos = 0; |PINTA #0XCampos;
            |CAMPO_MODIFICA #0XCampos, 1, "N";
      |SIGUE;
  |SINO;
      #0#1 = 00001; |PINTA #0#1;    |CAMPO_MODIFICA #0#01, 1, "N";
      #0#2 = 99999; |PINTA #0#2;    |CAMPO_MODIFICA #0#02, 1, "N";

      |PARA XCampos = 3; |SI XCampos [ 32; |HACIENDO XCampos = XCampos + 1;
            |CAMPO_MODIFICA #0XCampos, 1, "S";
      |SIGUE;
  |FINSI;
|FPRC;

|PROCESO SelecTipo;  |TIPO 0;

  Modifica = "S";
  |SI #0Campo = "L";
     Modifica = "N";
     #reemi100#54 = "S";
     #reemi100#55 = "N";
     |PINTA #reemi100#54;
     |PINTA #reemi100#55;
     |C_M #reemi100#54,1,"N";
     |C_M #reemi100#55,1,"N";
  |FINSI;
  eaTipoEmi = #0#34;

  #0#57 = "S";
  |C_M #0#57, 1, Modifica;

  |PINTA #0#37;
|FPRC;

|PROCESO Tipo8; |TIPO 8;
   ||MENAV "    En espera de los modulos de impresion"; |PTEC 807; |ACABA;
|FPRC;

|PROCESO MiraSiDatos;
   aTipo = VTipo % 0110;
   |SI nSwDatos = 9;
      nSwDatos = 0;
      |ABRE #rem01033;
      #rem01033#0 = VEmpresa;
      #rem01033#1 = 0;
      #rem01033#2 = aTipo;
      |LEE 000#rem01033.=;
      FEstado = FSalida;
      |CIERRA #rem01033;
      |SI FEstado = 0;
         |SI #rem01033#3  ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01033#7  ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01033#8  ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01033#9  ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01033#10 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01033#11 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01033#12 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01033#13 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01033#14 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01033#15 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01033#16 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01033#17 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01033#18 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      |FINSI;
   |FINSI;

   |SI nSwDatos = 14;
      nSwDatos = 0;
      |ABRE #rem01041;
      #rem01041#0 = VEmpresa;
      #rem01041#1 = 0;
      #rem01041#2 = aTipo;
      |LEE 000#rem01041.=;
      FEstado = FSalida;
      |CIERRA #rem01041;
      |SI FEstado = 0;
         |SI #rem01041#4  ! 0; |O #rem01041#5  ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#7  ! 0; |O #rem01041#8  ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#10 ! 0; |O #rem01041#11 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#24 ! 0; |O #rem01041#25 ! 0; |O #rem01041#26 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#27 ! 0; |O #rem01041#28 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#33 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#86 ! 0; |O #rem01041#87 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#38 ! 0; |O #rem01041#39 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#40 ! 0; |O #rem01041#41 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#42 ! 0; |O #rem01041#43 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#34 ! 0; |O #rem01041#35 ! 0;
          |O #rem01041#36 ! 0; |O #rem01041#37 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#44 ! 0; |O #rem01041#45 ! 0; |O #rem01041#46 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#47 ! 0; |O #rem01041#48 ! 0;
          |O #rem01041#49 ! 0; |O #rem01041#50 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      |FINSI;
   |FINSI;

   |SI nSwDatos = 15;
      nSwDatos = 0;
      |ABRE #rem01043;
      #rem01043#0 = VEmpresa;
      #rem01043#1 = 0;
      #rem01043#2 = aTipo;
      |LEE 000#rem01043.=;
      FEstado = FSalida;
      |CIERRA #rem01043;
      |SI FEstado = 0;
         |SI #rem01043#13 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01043#19 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01043#28 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01043#38 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01043#53 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      |FINSI;
   |FINSI;

   |SI nSwDatos = 16;
      nSwDatos = 0;
      |ABRE #rem01043;
      #rem01043#0 = VEmpresa;
      #rem01043#1 = 0;
      #rem01043#2 = aTipo;
      |LEE 000#rem01043.=;
      FEstado = FSalida;
      |CIERRA #rem01043;
      |SI FEstado = 0;
         |SI #rem01043#59 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01043#67 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01043#78 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01043#86 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01043#94 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      |FINSI;
   |FINSI;

   |SI nSwDatos = 17;
      nSwDatos = 0;
      |ABRE #rem01043;
      #rem01043#0 = VEmpresa;
      #rem01043#1 = 0;
      #rem01043#2 = aTipo;
      |LEE 000#rem01043.=;
      FEstado = FSalida;
      |CIERRA #rem01043;
      |SI FEstado = 0;
         |SI #rem01043#102 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01043#110 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01043#116 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01043#121 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01043#143 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      |FINSI;
   |FINSI;

   |SI nSwDatos = 18;
      nSwDatos = 0;
      |ABRE #rem01042;
      #rem01042#0 = VEmpresa;
      #rem01042#1 = 0;
      #rem01042#2 = aTipo;
      |LEE 000#rem01042.=;
      |SI FSalida = 0;
         |PARA nCont = 3; |SI nCont [ 94; |HACIENDO nCont = nCont + 1;
            |SI #rem01042#nCont# ! 0; nSwDatos = 1; |SAL; |FINSI;
         |SIGUE;
         |SI nSwDatos = 0;
            |SI #rem01042#96  ! 0; |O #rem01042#97  ! 0;                       nSwDatos = 1; |FINSI;
            |SI #rem01042#99  ! 0; |O #rem01042#100 ! 0; |O #rem01042#101 ! 0; nSwDatos = 1; |FINSI;
            |SI #rem01042#103 ! 0; |O #rem01042#104 ! 0; |O #rem01042#105 ! 0; nSwDatos = 1; |FINSI;
            |SI #rem01042#106 ! 0; |O #rem01042#107 ! 0; |O #rem01042#108 ! 0; nSwDatos = 1; |FINSI;
            |SI #rem01042#109 ! 0; |O #rem01042#110 ! 0; |O #rem01042#111 ! 0; nSwDatos = 1; |FINSI;
            |SI #rem01042#112 ! 0; |O #rem01042#113 ! 0;                       nSwDatos = 1; |FINSI;
         |FINSI;
      |FINSI;
      |CIERRA #rem01042;
   |FINSI;
|FPRC;

|PROCESO PonUnidad;
   |PUSHV 0501 2380;
   |BLANCO 1130 1750;
   |CUADRO 1231 1749;
   |PINTA 1333, "Unidad de disco";
   aUnidad = #reemi100#64;

|ET OtraUnidad
   E_sup = 1; E_inf = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
   aUnidad = 1540 ? 1;
   |SI FSalida = 0;
      |SI aUnidad < "A"; |O aUnidad > "Z"; aUnidad = #reemi100#64; |VETE OtraUnidad; |FINSI;
      #reemi100#64 = aUnidad;
      |ABRE #rem00998;
      #rem00998#0 = Usuario % 0810;
      |LEE 101#rem00998.=;
      |SI FSalida ! 0;
         |DDEFECTO #rem00998;
         #rem00998#0 = Usuario % 0810;
         |GRABA 020#rem00998.b;
      |FINSI;
      #rem00998#2 = aUnidad;
      |GRABA 020#rem00998.a; |LIBERA #rem00998;
      |CIERRA #rem00998;
   |FINSI;
   |POPV;
   aAlfa = #reemi100#64; |QBF aAlfa;
   aAlfa = aAlfa + ":\AEAT\INTERNET\100\2008\"; |PINTA 1845, aAlfa;
|FPRC;

|PROGRAMA;
     |SI enEmpresa ! 0;
         #0#0 = "S";
         |PARA nCampo = 0;  |SI nCampo [ 32;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
         |SIGUE;
         #0#1 = enEmpresa;  |PINTA #0#1;
         #0#2 = enEmpresa;  |PINTA #0#2;
         |ABRE #rem00998;
         #rem00998#0 = Usuario % 0810;
         |LEE 000#rem00998.=;
         |SI FSalida ! 0;
            |DDEFECTO #rem00998;
            #rem00998#0 = Usuario % 0810;
            #rem00998#2 = "C";
            |GRABA 020#rem00998.c;
         |FINSI;
         #reemi100#64 = #rem00998#2;
         |CIERRA #rem00998;

         |CONTROL_SIMPLE 0, "BOTON,...", 1840, 1843, PonUnidad;
         nBotonUnidad = FSalida;

         |PINPA #0#0;
         |PINDA #0#0;
         aAlfa = #rem00998#2; |QBF aAlfa;
         aAlfa = aAlfa + ":\AEAT\INTERNET\100\2008\"; |PINTA 1845, aAlfa;

         |ENDATOS #1#0;
         FEstado = FSalida;
         |FIN_CONTROL_WINDOWS nBotonUnidad; nBotonUnidad = 0;
         FSalida = FEstado;
     |SINO;
         |ABRE #rem00998;
         |CONTROL_SIMPLE 0, "BOTON,...", 1840, 1843, PonUnidad;
         nBotonUnidad = FSalida;

         #rem00998#0 = Usuario % 0810;
         |LEE 000#rem00998.=;
         |SI FSalida ! 0;
            |DDEFECTO #rem00998;
            #rem00998#0 = Usuario % 0810;
            #rem00998#2 = "C";
            |GRABA 020#rem00998.c;
         |FINSI;
         #reemi100#64 = #rem00998#2;
         |CIERRA #rem00998;

         |PINPA #0#0;
         |PINDA #0#0;
         aAlfa = #rem00998#2; |QBF aAlfa;
         aAlfa = aAlfa + ":\AEAT\INTERNET\100\2008\"; |PINTA 1845, aAlfa;

         |ENDATOS #1#0;
         FEstado = FSalida;
         |FIN_CONTROL_WINDOWS nBotonUnidad;
         FSalida = FEstado;
     |FINSI;
|FPRO;

|PROCESO MiraFecha;
   |SI #reemi100#33 < "01.05.2004";
      |MENAV "    Fecha presentacion incorrecta"; |ERROR;
   |FINSI;
|FPRC;

|PROCESO BuscaPais;
   |ABRE #reauxpai;
   #reauxpai#0 = aAlfa;
   |LEE 000#reauxpai.=;
   |SI FSalida = 0;
      aAlfa = #reauxpai#2;
   |SINO;
      aAlfa = "   ";
   |FINSI;
   |CIERRA #reauxpai;
|FPRC;
