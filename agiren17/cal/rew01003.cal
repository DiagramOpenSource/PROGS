|FICHEROS;
     rem01001;
     rem01002;

     rem00100;
     rem00101;
     rem01018;

     rew01003,MANTE;
|FIN;

|VARIABLES;
     nCampo       = 0;
     nCampo1      = 0;
     nCampo2      = 0;
     nCampo3      = 0;
     nCampo4      = 0;
     nCampo5      = 0;
     nCampo6      = 0;
     nCampo7      = 0;
     nCampo8      = 0;
     nDCampo      = 0;
     nHCampo      = 0;
     nComple      = 0;
     nError       = 0;
     nValor       = 0;
     nValor1      = 0;
     nValor2      = 0;

     aAlfa        = "";
     aBlq         = "";
     aCas         = "";

     &enEmpresa   = 0;
     &enImporte   = 0;
     &eaCasilla   = "";
|FIN;

|PROCESO Tipo12Fw1003;  |TIPO 12;
|FPRC;

|PROCESO FormaPago1003;
|FPRC;

|PROCESO Individual;  |TIPO 7;
     |C_M #rew01003#Campo#, 1, "S";
     |SI #rew01003#Campo# = "I";
||         |C_M #rew01003#Campo#, 1, "N";
     |FINSI;
|FPRC;

|PROCESO rem00101T3;
     |SI #rem00101#7 = "3";  |O #rem00101#7 = "4";
         aAlfa = "0000 Declaracion CONJUNTA, lo que obliga al ";
         aAlfa = aAlfa + "otro progenitor de los hijos tipo 3 y 4 a no incluirlos en su renta";
         |MENAV aAlfa;
         |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE rem00101T3;
     #rem00101#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     ;
     NULL, rem00101T3;
|FIN;

|PROCESO Lee1001;
     #rem01001#0 = enEmpresa;
     #rem01001#1 = 0;
     #rem01001#2 = aAlfa;
     |LEE 000#rem01001.=;

     aAlfa = "";
     |SI FSalida = 0;
         aAlfa = "100";
     |FINSI;
|FPRC;

|PROCESO LeeImporte;
     aBlq = eaCasilla % 102;
     aCas = eaCasilla % 404;
     enImporte  = 0;

     #rem01002#0 = #rem01001#0;
     #rem01002#1 = #rem01001#1;
     #rem01002#2 = #rem01001#2;
     #rem01002#3 = aBlq;
     #rem01002#5 = aCas;
     |LEE 040#rem01002.=;
     |SI FSalida = 0;
         enImporte  = #rem01002#7;
     |FINSI;
|FPRC;

|PROCESO LeeRdtos;
     |HAZ Lee1001;

     |ABRE #rem01002;   |SELECT #2#rem01002;
     |ABRE #rem01018;
     #rem01018#0 = #rem01001#0;
     #rem01018#1 = #rem01001#1;
     #rem01018#2 = #rem01001#2;
     |LEE 000#rem01018.=;
     |SI FSalida ! 0;  |DDEFECTO #rem01018;  |FINSI;
     |CIERRA #rem01018;

                                                            nValor = 0;
     eaCasilla = "02-0038"; |HAZ LeeImporte; nValor = nValor + enImporte;
     eaCasilla = "03-0051"; |HAZ LeeImporte; nValor = nValor + enImporte;
     eaCasilla = "04-0084"; |HAZ LeeImporte; nValor = nValor + enImporte;
     eaCasilla = "08-0233"; |HAZ LeeImporte; nValor = nValor + enImporte;
     eaCasilla = "09-0250"; |HAZ LeeImporte; nValor = nValor + enImporte;
     eaCasilla = "10-0255"; |HAZ LeeImporte; nValor = nValor + enImporte;
     eaCasilla = "11-0259"; |HAZ LeeImporte; nValor = nValor + enImporte;
     eaCasilla = "12-0264"; |HAZ LeeImporte; nValor = nValor + enImporte;
     eaCasilla = "24-0400"; |HAZ LeeImporte; nValor = nValor + enImporte;
     eaCasilla = "24-0401"; |HAZ LeeImporte; nValor = nValor - enImporte;
     eaCasilla = "25-0404"; |HAZ LeeImporte; nValor = nValor + enImporte;
     eaCasilla = "25-0405"; |HAZ LeeImporte; nValor = nValor - enImporte;

     nValor1   = #rem01018#19;
     nValor2   = #rem01018#28;
     |SI nValor1 ] nValor2;
         nValor    = nValor + nValor1;
     |SINO;
         nValor    = nValor + nValor2;
     |FINSI;

     nValor    = nValor + #rem01018#7;
     nValor    = nValor + #rem01018#11;
     nValor    = nValor + #rem01018#13;
     nValor    = nValor + #rem01018#8;

     |CIERRA #rem01002;

     nError = 0;
     |SI nValor > 1800;
         nError = 1;

         #rew01003#13 = "";
         #rew01003#22 = "";
         #rew01003#31 = "";
         #rew01003#40 = "";
         #rew01003#49 = "";
         #rew01003#58 = "";

         |C_M #rew01003#3, 1, "S";
         #rew01003#3 = "C";  |PINTA #rew01003#3;
     |FINSI;
|FPRC;

|PROCESO Modifica1003;
    |PARA nCampo = 4;  |SI nCampo [ 66;  |HACIENDO nCampo = nCampo + 1;
          |C_M #rew01003#nCampo#, 1, "N";
    |SIGUE;

    |SI #rew01003#3 = "C";
         #rew01003#4 = "100";

         |C_M #rew01003#4,  1, "S";
         |C_M #rew01003#6,  1, "S";
         |C_M #rew01003#7,  1, "S";
         |C_M #rew01003#10, 1, "S";
         |C_M #rew01003#11, 1, "S";
         |C_M #rew01003#12, 1, "S";

         |SI #rew01003#5 [ 0;
             |SI #rew01003#10 = "N";  #rew01003#11 = "S";  |FINSI;

             #rew01003#6  = "N";
             #rew01003#7  = "N";
         |SINO;
             #rew01003#6  = "S";
             #rew01003#7  = "S";
             #rew01003#11 = "N";
         |FINSI;

         #rew01003#13 = "";  #rew01003#15 = "N";   #rew01003#16 = "N";  #rew01003#19 = "N";  #rew01003#20 = "N";
         #rew01003#22 = "";  #rew01003#24 = "N";   #rew01003#25 = "N";  #rew01003#28 = "N";  #rew01003#29 = "N";
         #rew01003#31 = "";  #rew01003#33 = "N";   #rew01003#34 = "N";  #rew01003#37 = "N";  #rew01003#38 = "N";
         #rew01003#40 = "";  #rew01003#42 = "N";   #rew01003#43 = "N";  #rew01003#46 = "N";  #rew01003#47 = "N";
         #rew01003#49 = "";  #rew01003#51 = "N";   #rew01003#52 = "N";  #rew01003#55 = "N";  #rew01003#56 = "N";
         #rew01003#58 = "";  #rew01003#60 = "N";   #rew01003#61 = "N";  #rew01003#64 = "N";  #rew01003#65 = "N";

         |BUCLE rem00101T3;
     |SINO;
         #rew01003#13 = "";
         #rew01003#22 = "";
         #rew01003#31 = "";
         #rew01003#40 = "";
         #rew01003#49 = "";
         #rew01003#58 = "";

         aAlfa = "TITULAR";     |HAZ Lee1001;  #rew01003#13 = aAlfa;
         aAlfa = "CONYUGE";     |HAZ Lee1001;  #rew01003#22 = aAlfa;
         aAlfa = "1 FAMILIAR";  |HAZ Lee1001;  #rew01003#31 = aAlfa;
         aAlfa = "2 FAMILIAR";  |HAZ Lee1001;  #rew01003#40 = aAlfa;
         aAlfa = "3 FAMILIAR";  |HAZ Lee1001;  #rew01003#49 = aAlfa;
         aAlfa = "4 FAMILIAR";  |HAZ Lee1001;  #rew01003#58 = aAlfa;

         |SI #rew01003#31 ! "   ";
              aAlfa = "1 FAMILIAR";
              |HAZ LeeRdtos;
              |SI nError = 1;
                  |MENAV "00001 FAMILIAR con rentas superiores a 1.800 euros, solo es posible imprimir renta conjunta";

                  |ERROR;
                  |ACABA;
              |FINSI;
         |FINSI;

         |SI #rew01003#40 ! "   ";
              aAlfa = "2 FAMILIAR";
              |HAZ LeeRdtos;
              |SI nError = 1;
                  |MENAV "00002 FAMILIAR con rentas superiores a 1.800 euros, solo es posible imprimir renta conjunta";

                  |ERROR;
                  |ACABA;
              |FINSI;
         |FINSI;

         |SI #rew01003#49 ! "   ";
              aAlfa = "3 FAMILIAR";
              |HAZ LeeRdtos;
              |SI nError = 1;
                  |MENAV "00003 FAMILIAR con rentas superiores a 1.800 euros, solo es posible imprimir renta conjunta";

                  |ERROR;
                  |ACABA;
              |FINSI;
         |FINSI;

         |SI #rew01003#58 ! "   ";
              aAlfa = "4 FAMILIAR";
              |HAZ LeeRdtos;
              |SI nError = 1;
                  |MENAV "000034FAMILIAR con rentas superiores a 1.800 euros, solo es posible imprimir renta conjunta";

                  |ERROR;
                  |ACABA;
              |FINSI;
         |FINSI;

         |SI #rew01003#13 ! "   ";
             |C_M #rew01003#13, 1, "S";
             |C_M #rew01003#15, 1, "S";
             |C_M #rew01003#16, 1, "S";
             |C_M #rew01003#19, 1, "S";
             |C_M #rew01003#20, 1, "S";
             |C_M #rew01003#21, 1, "S";

             |SI #rew01003#14 [ 0;
                 |SI #rew01003#19 = "N";  #rew01003#20 = "S";  |FINSI;

                 #rew01003#15 = "N";
                 #rew01003#16 = "N";
             |SINO;
                 #rew01003#15 = "S";
                 #rew01003#16 = "S";
                 #rew01003#20 = "N";
             |FINSI;
         |FINSI;

         |SI #rew01003#22 ! "   ";
             |C_M #rew01003#22, 1, "S";
             |C_M #rew01003#24, 1, "S";
             |C_M #rew01003#25, 1, "S";
             |C_M #rew01003#28, 1, "S";
             |C_M #rew01003#29, 1, "S";
             |C_M #rew01003#30, 1, "S";

             |SI #rew01003#23 [ 0;
                 |SI #rew01003#28 = "N";  #rew01003#29 = "S";  |FINSI;
                 #rew01003#24 = "N";
                 #rew01003#25 = "N";
             |SINO;
                 #rew01003#24 = "S";
                 #rew01003#25 = "S";
                 #rew01003#29 = "N";
             |FINSI;
         |FINSI;

         |SI #rew01003#31 ! "   ";
             |C_M #rew01003#31, 1, "S";
             |C_M #rew01003#33, 1, "S";
             |C_M #rew01003#34, 1, "S";
             |C_M #rew01003#37, 1, "S";
             |C_M #rew01003#38, 1, "S";
             |C_M #rew01003#39, 1, "S";

             |SI #rew01003#32 [ 0;
                 |SI #rew01003#37 = "N";  #rew01003#38 = "S";  |FINSI;
                 #rew01003#33 = "N";
                 #rew01003#34 = "N";
             |SINO;
                 #rew01003#33 = "S";
                 #rew01003#34 = "S";
                 #rew01003#38 = "N";
             |FINSI;
         |FINSI;

         |SI #rew01003#40 ! "   ";
             |C_M #rew01003#40, 1, "S";
             |C_M #rew01003#42, 1, "S";
             |C_M #rew01003#43, 1, "S";
             |C_M #rew01003#46, 1, "S";
             |C_M #rew01003#47, 1, "S";
             |C_M #rew01003#48, 1, "S";

             |SI #rew01003#41 [ 0;
                 |SI #rew01003#46 = "N";  #rew01003#47 = "S";  |FINSI;
                 #rew01003#42 = "N";
                 #rew01003#43 = "N";
             |SINO;
                 #rew01003#42 = "S";
                 #rew01003#43 = "S";
                 #rew01003#47 = "N";
             |FINSI;
         |FINSI;


         |SI #rew01003#49 ! "   ";
             |C_M #rew01003#49, 1, "S";
             |C_M #rew01003#51, 1, "S";
             |C_M #rew01003#52, 1, "S";
             |C_M #rew01003#55, 1, "S";
             |C_M #rew01003#56, 1, "S";
             |C_M #rew01003#57, 1, "S";

             |SI #rew01003#50 [ 0;
                 |SI #rew01003#55 = "N";  #rew01003#56 = "S";  |FINSI;
                 #rew01003#51 = "N";
                 #rew01003#52 = "N";
             |SINO;
                 #rew01003#51 = "S";
                 #rew01003#52 = "S";
                 #rew01003#56 = "N";
             |FINSI;
         |FINSI;

         |SI #rew01003#58 ! "   ";
             |C_M #rew01003#58, 1, "S";
             |C_M #rew01003#60, 1, "S";
             |C_M #rew01003#61, 1, "S";
             |C_M #rew01003#64, 1, "S";
             |C_M #rew01003#65, 1, "S";
             |C_M #rew01003#66, 1, "S";

             |SI #rew01003#59 [ 0;
                 |SI #rew01003#64 = "N";  #rew01003#65 = "S";  |FINSI;
                 #rew01003#60 = "N";
                 #rew01003#61 = "N";
             |SINO;
                 #rew01003#60 = "S";
                 #rew01003#61 = "S";
                 #rew01003#65 = "N";
             |FINSI;
         |FINSI;

         |C_M #rew01003#4,  1, "N";
         |C_M #rew01003#6,  1, "N";
         |C_M #rew01003#7,  1, "N";
         |C_M #rew01003#10, 1, "N";
         |C_M #rew01003#11, 1, "N";
         |C_M #rew01003#12, 1, "N";

         #rew01003#4  = "";  #rew01003#6  = "N";   #rew01003#7  = "N";  #rew01003#10 = "N";  #rew01003#11 = "N";
     |FINSI;

     Campo = 6;   |HAZ Calcula102;  Campo = 3;
     Campo = 15;  |HAZ Calcula102;  Campo = 3;
     Campo = 24;  |HAZ Calcula102;  Campo = 3;
     Campo = 33;  |HAZ Calcula102;  Campo = 3;
     Campo = 42;  |HAZ Calcula102;  Campo = 3;
     Campo = 51;  |HAZ Calcula102;  Campo = 3;
     Campo = 60;  |HAZ Calcula102;  Campo = 3;

     |PINDA #0#rew01003;
|FPRC;

|PROCESO ControlaModelo;
     |SI #rew01003#Campo# = "   ";  |ACABA;  |FINSI;

     nComple = 0;
     |ABRE #rem00100;
     #rem00100#0 = enEmpresa;
     |LEE 040#rem00100.=;
     |SI FSalida = 0;  |Y #rem00100#97 ! "1";
         nComple = 1;
     |FINSI;
     |CIERRA #rem00100;

     nCampo1 = Campo + 1;
     nCampo2 = Campo + 2;
     nCampo3 = Campo + 3;
     nCampo4 = Campo + 4;
     nCampo5 = Campo + 5;
     nCampo6 = Campo + 6;
     nCampo7 = Campo + 7;
     nCampo8 = Campo + 8;

     |C_M #rew01003#nCampo2#, 1, "S";
     |C_M #rew01003#nCampo3#, 1, "S";
     |C_M #rew01003#nCampo6#, 1, "S";
     |C_M #rew01003#nCampo7#, 1, "S";
     |C_M #rew01003#nCampo8#, 1, "S";
     |SI #rew01003#nCampo1# [ 0;
         |C_M #rew01003#nCampo2#, 1, "N";  #rew01003#nCampo2# = "N";
         |C_M #rew01003#nCampo3#, 1, "N";  #rew01003#nCampo3# = "N";
                                           #rew01003#nCampo4# = 0;
                                           #rew01003#nCampo5# = 0;

         |SI nComple = 0;
             |C_M #rew01003#nCampo8#, 1, "N";  #rew01003#nCampo8# = "N";
         |FINSI;
     |SINO;
         |C_M #rew01003#nCampo6#, 1, "N";  #rew01003#nCampo6# = "N";
         |C_M #rew01003#nCampo7#, 1, "N";  #rew01003#nCampo7# = "N";
     |FINSI;
|FPRC;

|PROCESO Calcula102;
     nCampo1 = Campo - 1;
     nCampo2 = Campo + 2;
     nCampo3 = Campo + 3;
     nCampo4 = Campo + 1;
     |SI #rew01003#Campo# = "S";
         #rew01003#nCampo2# = #rew01003#nCampo1# % 60;  |PINTA #rew01003#nCampo2#;
         #rew01003#nCampo3# = #rew01003#nCampo1# % 40;  |PINTA #rew01003#nCampo3#;
         |C_M #rew01003#nCampo4#, 1, "S";
     |SINO;
         #rew01003#nCampo2# = 0;  |PINTA #rew01003#nCampo2#;
         #rew01003#nCampo3# = 0;  |PINTA #rew01003#nCampo3#;
         |C_M #rew01003#nCampo4#, 1, "N"; #rew01003#nCampo4# = "N";  |PINTA #rew01003#nCampo4#;
     |FINSI;
|FPRC;

|PROCESO Transferencia;  |TIPO 7;
     nCampo1 = Campo - 6;
     nCampo2 = Campo - 1;
     #rew01003#Campo# = "N";
     |SI #rew01003#nCampo2# = "N";  |Y #rew01003#nCampo1# < 0;
         #rew01003#Campo# = "S";
     |FINSI;
     |PINTA #rew01003#Campo#;
|FPRC;

|PROCESO Tipo12w6;  |TIPO 12;
|FPRC;
