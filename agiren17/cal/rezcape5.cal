|FICHEROS;
     rem00020;
     rem00030;
     rem00041;
     rem00042;
     rem00053;
     rem00056;
     rem00061;
     rem02002;

     rem00030@;
     rem00041@;
     rem00042@;
     rem00053@;
     rem00056@;
     rem00061@;
     rem01001@;
     rem01033@;
|FIN;

|INCLUYE capeac99;

|| REM00030

|PROCESO Pasa030;
     nPaso = 0;
     |SI #rem00030@#15 ] 2017;  |Y #rem00030@#16 ! 0;  nPaso = 1;  |FINSI;
     |SI #rem00030@#17 ] 2017;  |Y #rem00030@#18 ! 0;  nPaso = 1;  |FINSI;
     |SI #rem00030@#19 ] 2017;  |Y #rem00030@#20 ! 0;  nPaso = 1;  |FINSI;
     |SI #rem00030@#21 ] 2017;  |Y #rem00030@#22 ! 0;  nPaso = 1;  |FINSI;

     |SI nPaso = 0;  |ACABA;  |FINSI;

     #rem00030#0 = #rem00030@#0;
     #rem00030#1 = #rem00030@#1;
     |LEE 101#rem00030.=;
     |SI FSalida = 0;
         |BORRA 020#rem00030.a;
         |LIBERA #rem00030;
     |FINSI;

     |DDEFECTO #rem00030;
     #rem00030#0   = #rem00030@#0;
     #rem00030#1   = #rem00030@#1;
     #rem00030#2   = #rem00030@#2;
     #rem00030#3   = "X";
     #rem00030#4   = 0;
     #rem00030#5   = #rem00030@#5;
     #rem00030#6   = #rem00030@#6;
     #rem00030#7   = #rem00030@#7;
     #rem00030#8   = #rem00030@#8;
     #rem00030#9   = #rem00030@#9;
     #rem00030#10  = #rem00030@#10;

     |SI #rem00030@#15 ] 2017;
          #rem00030#15 = #rem00030@#15;
          #rem00030#16 = #rem00030@#16;
     |FINSI;

     |SI #rem00030@#17 ] 2017;
         |SI #rem00030#15 = 0;
             #rem00030#15 = #rem00030@#17;
             #rem00030#16 = #rem00030@#18;
         |SINO;
             #rem00030#17 = #rem00030@#17;
             #rem00030#18 = #rem00030@#18;
         |FINSI;
     |FINSI;

     |SI #rem00030@#19 ] 2017;
         |SI #rem00030#15 = 0;
             #rem00030#15 = #rem00030@#19;
             #rem00030#16 = #rem00030@#20;
         |SINO;
             |SI #rem00030#17 = 0;
                 #rem00030#17 = #rem00030@#19;
                 #rem00030#18 = #rem00030@#20;
             |SINO;
                 #rem00030#19 = #rem00030@#19;
                 #rem00030#20 = #rem00030@#20;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00030@#21 ] 2017;
         |SI #rem00030#15 = 0;
             #rem00030#15 = #rem00030@#21;
             #rem00030#16 = #rem00030@#22;
         |SINO;
             |SI #rem00030#17 = 0;
                 #rem00030#17 = #rem00030@#21;
                 #rem00030#18 = #rem00030@#22;
             |SINO;
                 |SI #rem00030#19 = 0;
                     #rem00030#19 = #rem00030@#21;
                     #rem00030#20 = #rem00030@#22;
                 |SINO;
                     #rem00030#21 = #rem00030@#21;
                     #rem00030#22 = #rem00030@#22;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00030#15 = 2017;  #rem00030#11 = #rem00030#16;  |FINSI;
     |SI #rem00030#17 = 2017;  #rem00030#11 = #rem00030#18;  |FINSI;
     |SI #rem00030#19 = 2017;  #rem00030#11 = #rem00030#20;  |FINSI;
     |SI #rem00030#21 = 2017;  #rem00030#11 = #rem00030#22;  |FINSI;

                              #rem00030#24 = "";
     |SI #rem00030#3  = "X";  #rem00030#24 = eaRojo;  |FINSI;

     |GRABA 020#rem00030.n;
     |LIBERA #rem00030;
|FPRC;

|DEFBUCLE rem00030_2016;
     #rem00030@#1002;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     ;
     NULL, Pasa030;
|FIN;

|PROCESO PasaM00030;
     aDef = eaCampo0 + "/def/rem00030.mas";  |QBT aDef;
     |CARGA_DEF aDef, rem00030@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00030 A¤o 2016 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #rem00030@#eaPathRen2016#;

     |ABRE #rem00030;
     |BUCLE rem00030_2016;
     |CIERRA #rem00030;

     |DESCARGA_DEF #rem00030@;

     eaPrograma = "rem00030";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|| REM00041

|PROCESO Pdtes42_41;
     #rem00042#0 = #rem00041@#0;
     #rem00042#1 = 99;
     |LEE 040#rem00042.];
     |SI FSalida = 0;
         |LEE 040#rem00042.a;
     |SINO;
         |LEE 040#rem00042.u;
     |FINSI;

     |SI FSalida = 0; |Y #rem00042#0 = #rem00041@#0;
         nLinea = #rem00042#1 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     #rem00042#0   = #rem00041@#0;
     #rem00042#1   = nLinea;
     #rem00042#2   = #rem00041@#2;
     #rem00042#3   = "X";

     |SI eaCampo37 = "N";
         #rem00042#3 = #rem00041@#3;
     |FINSI;

     |SI #rem00042#3  = "A";
         #rem00042#3 = "R";
     |FINSI;

     #rem00042#4   = 0;
     #rem00042#5   = #rem00041@#5;
     #rem00042#6   = #rem00041@#6;
     #rem00042#7   = #rem00041@#7;
     #rem00042#8   = #rem00041@#8;
     #rem00042#9   = #rem00041@#9;
     #rem00042#10  = #rem00041@#10;
     #rem00042#14  = "01.01.0000";
     #rem00042#15  = "PENDIENTE EJERCICIO 2016";
     #rem00042#16  = 0;
     #rem00042#17  = 0;
     #rem00042#18  = nPendiente;
     #rem00042#19  = 0;
     #rem00042#20  = 0;
     #rem00042#13  = 0;
     #rem00042#21  = 1;
     #rem00042#22  = "M";

                              #rem00042#23 = "";
     |SI #rem00042#3  = "X";  #rem00042#23 = eaRojo;  |FINSI;

     |GRABA 020#rem00042.n;
     |LIBERA #rem00042;

     eaPrograma = "rem00042";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO Pasa041;
     |SI #rem00041@#11 = "C1";  |O #rem00041@#11 = "B1";
         |ACABA;
     |FINSI;

     nPendiente = #rem00041@#39 - #rem00041@#40;
     |SI nPendiente ! 0;
         |HAZ Pdtes42_41;
         |ACABA;
     |FINSI;

     nPendiente = #rem00041@#43 - #rem00041@#44;
     |SI nPendiente ! 0;
         |HAZ Pdtes42_41;
     |FINSI;
|FPRC;

|DEFBUCLE rem00041_2016;
     #rem00041@#1002;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     ;
     NULL, Pasa041;
|FIN;

|PROCESO PasaM00041;
     aDef = eaCampo0 + "/def/rem00041.mas";  |QBT aDef;
     |CARGA_DEF aDef, rem00041@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00041 A¤o 2016 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #rem00041@#eaPathRen2016#;

     |ABRE #rem00042;  |SELECT #1#rem00042;
     |BUCLE rem00041_2016;
     |CIERRA #rem00042;

     |DESCARGA_DEF #rem00041@;
|FPRC;

|| REM00042

|PROCESO Pdtes42_42;
     #rem00042#0 = #rem00042@#0;
     #rem00042#1 = 99;
     |LEE 040#rem00042.];
     |SI FSalida = 0;
         |LEE 040#rem00042.a;
     |SINO;
         |LEE 040#rem00042.u;
     |FINSI;

     |SI FSalida = 0; |Y #rem00042#0 = #rem00042@#0;
         nLinea = #rem00042#1 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     #rem00042#0   = #rem00042@#0;
     #rem00042#1   = nLinea;
     #rem00042#2   = #rem00042@#2;
     #rem00042#3   = "X";

     |SI eaCampo37 = "N";
         #rem00042#3 = #rem00042@#3;
     |FINSI;

     |SI #rem00042#3  = "A";
         #rem00042#3 = "R";
     |FINSI;

     #rem00042#4   = 0;
     #rem00042#5   = #rem00042@#5;
     #rem00042#6   = #rem00042@#6;
     #rem00042#7   = #rem00042@#7;
     #rem00042#8   = #rem00042@#8;
     #rem00042#9   = #rem00042@#9;
     #rem00042#10  = #rem00042@#10;
     #rem00042#14  = "01.01.0000";
     #rem00042#15  = "PENDIENTE EJERCICIO 2016";
     #rem00042#16  = 0;
     #rem00042#17  = 0;
     #rem00042#18  = nPendiente;
     #rem00042#19  = 0;
     #rem00042#20  = 0;
     #rem00042#13  = 0;
     #rem00042#21  = 1;
     #rem00042#22  = "M";

                              #rem00042#23 = "";
     |SI #rem00042#3  = "X";  #rem00042#23 = eaRojo;        |FINSI;

     |GRABA 020#rem00042.n;
     |LIBERA #rem00042;

     eaPrograma = "rem00042";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO El42T;
     #rem00042#0 = #rem00042@#0;
     #rem00042#1 = 99;
     |LEE 040#rem00042.];
     |SI FSalida = 0;
         |LEE 040#rem00042.a;
     |SINO;
         |LEE 040#rem00042.u;
     |FINSI;

     |SI FSalida = 0; |Y #rem00042#0 = #rem00042@#0;
         nLinea = #rem00042#1 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     #rem00042#0   = #rem00042@#0;
     #rem00042#1   = nLinea;
     #rem00042#2   = #rem00042@#2;
     #rem00042#3   = "X";

     |SI eaCampo37 = "N";
         #rem00042#3 = #rem00042@#3;
     |FINSI;

     |SI #rem00042#3 = "A";
         #rem00042#3 = "R";
     |FINSI;

     #rem00042#4   = 0;
     #rem00042#5   = #rem00042@#5;
     #rem00042#6   = #rem00042@#6;
     #rem00042#7   = #rem00042@#7;
     #rem00042#8   = #rem00042@#8;
     #rem00042#9   = #rem00042@#9;
     #rem00042#10  = #rem00042@#10;
     #rem00042#11  = #rem00042@#11;
     #rem00042#12  = #rem00042@#12;
     #rem00042#14  = #rem00042@#14;
     #rem00042#15  = #rem00042@#15;
     #rem00042#16  = #rem00042@#16;
     #rem00042#17  = #rem00042@#17;
     #rem00042#18  = #rem00042@#18 - #rem00042@#13;
     #rem00042#19  = #rem00042@#19 + #rem00042@#20;
     #rem00042#20  = 0;
     #rem00042#13  = 0;
     #rem00042#21  = 1;
     #rem00042#22  = "T";

                              #rem00042#23 = "";
     |SI #rem00042#3  = "X";  #rem00042#23 = eaRojo;        |FINSI;

     |GRABA 020#rem00042.n;
     |LIBERA #rem00042;

     eaPrograma = "rem00042";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO Pasa042;
     |SI #rem00042@#22 = "T";
         nPendiente = #rem00042@#16 - (#rem00042@#19 + #rem00042@#20);
         |SI nPendiente > 0;  |HAZ El42T;  |FINSI;
     |SINO;
         nPendiente = #rem00042@#18 - #rem00042@#13;
         |SI nPendiente > 0;  |HAZ Pdtes42_42;  |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE rem00042_2016;
     #rem00042@#1002;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     ;
     NULL, Pasa042;
|FIN;

|PROCESO PasaM00042;
     aDef = eaCampo0 + "/def/rem00042.mas";  |QBT aDef;
     |CARGA_DEF aDef, rem00042@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00042 A¤o 2016 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #rem00042@#eaPathRen2016#;

     |ABRE #rem00042;  |SELECT #1#rem00042;
     |BUCLE rem00042_2016;
     |CIERRA #rem00042;

     |DESCARGA_DEF #rem00042@;
|FPRC;

|| REM00053 EXCESOS

|PROCESO BuscaPension;
     |SI #rem00053#2 ! aContri;  |ACABA;  |FINSI;

     |SI nTipoPen = 1;
         |SI #rem00053#12 = "S";  |ACABA;  |FINSI;
         |SI #rem00053#23 = "S";  |ACABA;  |FINSI;
         |SI #rem00053#29 = "S";  |ACABA;  |FINSI;
     |FINSI;

     |SI nTipoPen = 2;
         |SI #rem00053#12 ! "S";  |ACABA;  |FINSI;
     |FINSI;

     |SI nTipoPen = 3;
         |SI #rem00053#23 ! "S";  |ACABA;  |FINSI;
     |FINSI;

     |SI nTipoPen = 4;
         |SI #rem00053#12 = "S";  |ACABA;  |FINSI;
         |SI #rem00053#23 = "S";  |ACABA;  |FINSI;
         |SI #rem00053#29 ! "S";  |ACABA;  |FINSI;
     |FINSI;

     |SI nTipoPen ! 2;
         |SI #rem00053#29 = "S";
             #rem00053#14 = nImporte;
             #rem00053#34 = nImporte;
         |SINO;
             #rem00053#27 = nImporte;
             #rem00053#39 = nImporte;
         |FINSI;
     |SINO;
         #rem00053#26 = nImporte;
         #rem00053#44 = nImporte;
     |FINSI;

     |GRABA 020#rem00053.a;
     |LIBERA #rem00053;

     |ERROR10;
|FPRC;

|DEFBUCLE rem00053_2017;
     #rem00053#1002;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     be;
     NULL, BuscaPension;
|FIN;

|PROCESO GrabaPension;
     |BUCLE rem00053_2017;
|FPRC;

|PROCESO BuscaDiscapacidad;
     |SI #rem00061#2 ! aContri;  |ACABA;  |FINSI;

     #rem00061#13 = nImporte;
     #rem00061#18 = nImporte;

     |GRABA 020#rem00061.a;
     |LIBERA #rem00061;

     |ERROR10;
|FPRC;

|DEFBUCLE rem00061_2017;
     #rem00061#1002;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     be;
     NULL, BuscaDiscapacidad;
|FIN;

|PROCESO GrabaDiscapacidad;
     |BUCLE rem00061_2017;
|FPRC;

|PROCESO rem01001_M53;
     #rem01033@#0 = #rem01001@#0;
     #rem01033@#1 = #rem01001@#1;
     #rem01033@#2 = #rem01001@#2;
     |LEE 040#rem01033@.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #rem01001@#2 = "CONJUNTA  ";  |O #rem01001@#2 = "CONJUNTAE ";
         nImporte = #rem01033@#83;  || 457 1§ Titular
         |SI nImporte > 0;
              nTipoPen = 1;
              aContri  = #rem01033@#82;
              |HAZ GrabaPension;
         |FINSI;

         nImporte = #rem01033@#85; || 457 2§ Titular
         |SI nImporte > 0;
              nTipoPen = 1;
              aContri  = #rem01033@#84;
              |HAZ GrabaPension;
         |FINSI;

         nImporte = #rem01033@#133; || 458 1§ Titular
         |SI nImporte > 0;
              nTipoPen = 4;
              aContri  = #rem01033@#82;
              |HAZ GrabaPension;
         |FINSI;

         nImporte = #rem01033@#134; || 458 2§ Titular
         |SI nImporte > 0;
              nTipoPen  = 4;
              aContri   = #rem01033@#84;
              |HAZ GrabaPension;
         |FINSI;

         nImporte = #rem01033@#87;  || 460 1§ Titular
         |SI nImporte > 0;
             nTipoPen = 2;
             aContri  = #rem01033@#86;
             |HAZ GrabaPension;
         |FINSI;

         nImporte = #rem01033@#89;  || 460 2§ Titular
         |SI nImporte > 0;
             nTipoPen = 2;
             aContri  = #rem01033@#88;
             |HAZ GrabaPension;
         |FINSI;

         nImporte = #rem01033@#91;  || 462 1§ Titular
         |SI nImporte > 0;
             aContri = #rem01033@#90;
             |HAZ GrabaDiscapacidad;
         |FINSI;

         nImporte = #rem01033@#93;  || 457 2§ Titular
         |SI nImporte > 0;
             aContri = #rem01033@#92;
             |HAZ GrabaDiscapacidad;
         |FINSI;

         nImporte = #rem01033@#95;  || 464 1§ Titular
         |SI nImporte > 0;
             nTipoPen = 3;
             aContri  = #rem01033@#94;
             |HAZ GrabaPension;
         |FINSI;

         nImporte = #rem01033@#97;  || 464 2§ Titular
         |SI nImporte > 0;
             nTipoPen = 3;
             aContri  = #rem01033@#96;
             |HAZ GrabaPension;
         |FINSI;
     |SINO;
         nImporte = #rem01033@#83;  || 457 1§ Titular
         |SI nImporte > 0;
             nTipoPen = 1;
             aContri  = #rem01033@#2;
             |HAZ GrabaPension;
         |FINSI;

         nImporte = #rem01033@#133; || 458 1§ Titular
         |SI nImporte > 0;
              nTipoPen = 4;
              aContri  = #rem01033@#2;
              |HAZ GrabaPension;
         |FINSI;

         nImporte = #rem01033@#87;  || 460 1§ Titular
         |SI nImporte > 0;
             nTipoPen = 2;
             aContri  = #rem01033@#2;
             |HAZ GrabaPension;
         |FINSI;

         nImporte = #rem01033@#91;  || 462 1§ Titular
         |SI nImporte > 0;
              aContri = #rem01033@#2;
              |HAZ GrabaDiscapacidad;
         |FINSI;

         nImporte = #rem01033@#95;  || 464 1§ Titular
         |SI nImporte > 0;
             nTipoPen = 3;
             aContri  = #rem01033@#2;
             |HAZ GrabaPension;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE rem01001_M53;
     #rem01001@#1003;
     5;
     enEmpresa, 00, "          ", "100";
     enEmpresa, 99, "zzzzzzzzzz", "101";
     ;
     NULL, rem01001_M53;
|FIN;

|PROCESO PasaM00053Exc;
     aDef = eaCampo0 + "/def/rem01001.mas";  |QBT aDef;
     |CARGA_DEF aDef, rem01001@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01001 A¤o 2016 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = eaCampo0 + "/def/rem01033.mas";  |QBT aDef;
     |CARGA_DEF aDef, rem01033@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01033 A¤o 2016 ";
         |MENAV aAlfa;

         |DESCARGA_DEF #rem01001@;
         |ACABA;
     |FINSI;

     |PATH_DAT #rem01001@#eaPathRen2016#;
     |PATH_DAT #rem01033@#eaPathRen2016#;

     |ABRE #rem01033@;
     |BUCLE rem01001_M53;
     |CIERRA #rem01033@;

     |DESCARGA_DEF #rem01033@;
     |DESCARGA_DEF #rem01001@;
|FPRC;

|| REM00053

|PROCESO Pasa053;
     #rem00053#0 = #rem00053@#0;
     #rem00053#1 = #rem00053@#1;
     |LEE 101#rem00053.=;
     |SI FSalida = 0;
         |BORRA 020#rem00053.a;
         |LIBERA #rem00053;
     |FINSI;

     |DDEFECTO #rem00053;
     #rem00053#0   = #rem00053@#0;
     #rem00053#1   = #rem00053@#1;
     #rem00053#2   = #rem00053@#2;
     #rem00053#3   = "X";

     |SI eaCampo37 = "N";
         #rem00053#3 = #rem00053@#3;
     |FINSI;

     #rem00053#4   = 0;
     #rem00053#5   = #rem00053@#5;
     #rem00053#6   = #rem00053@#6;
     #rem00053#7   = #rem00053@#7;
     #rem00053#8   = #rem00053@#8;
     #rem00053#9   = #rem00053@#9;
     #rem00053#10  = #rem00053@#10;
     #rem00053#11  = #rem00053@#11;
     #rem00053#12  = #rem00053@#12;
     #rem00053#13  = #rem00053@#13;
     #rem00053#17  = #rem00053@#17;
     #rem00053#21  = #rem00053@#21;
     #rem00053#22  = #rem00053@#22;
     #rem00053#23  = #rem00053@#23;
     #rem00053#24  = #rem00053@#24;
     #rem00053#25  = #rem00053@#25;
     #rem00053#29  = #rem00053@#29;

                              #rem00053#28 = "";
     |SI #rem00053#21 = "S";  #rem00053#28 = eaAzul;  |FINSI;
     |SI #rem00053#3  = "X";  #rem00053#28 = eaRojo;  |FINSI;

     |GRABA 020#rem00053.n;
     |LIBERA #rem00053;

     eaPrograma = "rem00053";
     eaPunto    = "";
     |HAZ ProgramaActivo;

     |SI #rem00053#21 = "S";
         #rem00020#0 = #rem00053@#0;
         #rem00020#1 = #rem00053#22;
         |LEE 101#rem00020.=;
         |SI FSalida ! 0;
             |DDEFECTO #rem00020;
             #rem00020#0  = #rem00053@#0;
             #rem00020#1  = #rem00053#22;
             #rem00020#13 = #rem00053#11;
             |GRABA 020#rem00020.n;
             |LIBERA #rem00020;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE rem00053_2016;
     #rem00053@#1002;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     ;
     NULL, Pasa053;
|FIN;

|PROCESO PasaM00053;
     aDef = eaCampo0 + "/def/rem00053.mas";  |QBT aDef;
     |CARGA_DEF aDef, rem00053@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00053 A¤o 2016 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #rem00053@#eaPathRen2016#;

     |ABRE #rem00053;
     |ABRE #rem00020;
     |BUCLE rem00053_2016;
     |CIERRA #rem00053;
     |CIERRA #rem00020;

     |DESCARGA_DEF #rem00053@;
|FPRC;

|| REM00061

|PROCESO Pasa061;
     #rem00061#0 = #rem00061@#0;
     #rem00061#1 = #rem00061@#1;
     |LEE 101#rem00061.=;
     |SI FSalida = 0;
         |BORRA 020#rem00061.a;
         |LIBERA #rem00061;
     |FINSI;

     |DDEFECTO #rem00061;
     #rem00061#0   = #rem00061@#0;
     #rem00061#1   = #rem00061@#1;
     #rem00061#2   = #rem00061@#2;
     #rem00061#3   = "X";

     |SI eaCampo37 = "N";
         #rem00061#3 = #rem00061@#3;
     |FINSI;

     #rem00061#4   = 0;
     #rem00061#5   = #rem00061@#5;
     #rem00061#6   = #rem00061@#6;
     #rem00061#7   = #rem00061@#7;
     #rem00061#8   = #rem00061@#8;
     #rem00061#9   = #rem00061@#9;
     #rem00061#10  = #rem00061@#10;
     #rem00061#11  = #rem00061@#11;

                              #rem00061#14 = "";
     |SI #rem00061#3  = "X";  #rem00061#14 = eaRojo;        |FINSI;

     |GRABA 020#rem00061.n;
     |LIBERA #rem00061;

     eaPrograma = "rem00061";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00061_2016;
     #rem00061@#1002;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     ;
     NULL, Pasa061;
|FIN;

|PROCESO PasaM00061;
     aDef = eaCampo0 + "/def/rem00061.mas";  |QBT aDef;
     |CARGA_DEF aDef, rem00061@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00061 A¤o 2016 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #rem00061@#eaPathRen2016#;

     |ABRE #rem00061;
     |BUCLE rem00061_2016;
     |CIERRA #rem00061;

     |DESCARGA_DEF #rem00061@;
|FPRC;

|| REM00056

|PROCESO GrabaOtras;
     |SI #rem01001@#2 = "TITULAR   ";
         |SI #rem00056@#2 = "CONYUGE   ";  |ACABA;  |FINSI;
         |SI #rem00056@#2 = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #rem00056@#2 = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #rem00056@#2 = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #rem00056@#2 = "4 FAMILIAR";  |ACABA;  |FINSI;
     |FINSI;

     |SI #rem01001@#2 = "CONYUGE   ";
         |SI #rem00056@#2 = "TITULAR   ";  |ACABA;  |FINSI;
         |SI #rem00056@#2 = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #rem00056@#2 = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #rem00056@#2 = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #rem00056@#2 = "4 FAMILIAR";  |ACABA;  |FINSI;
         |SI #rem00056@#2 = "GANANCIAL ";  |ACABA;  |FINSI;
         |SI #rem00056@#2 = "VARIOS    ";  |ACABA;  |FINSI;
     |FINSI;

     |SI #rem01001@#2 = "1 FAMILIAR";
         |SI #rem00056@#2 ! #rem01001@#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #rem01001@#2 = "2 FAMILIAR";
         |SI #rem00056@#2 ! #rem01001@#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #rem01001@#2 = "3 FAMILIAR";
         |SI #rem00056@#2 ! #rem01001@#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #rem01001@#2 = "4 FAMILIAR";
         |SI #rem00056@#2 ! #rem01001@#2;        |ACABA;  |FINSI;
     |FINSI;

     #rem00056#0  = #rem00056@#0;
     #rem00056#1  = 99;
     |LEE 000#rem00056.];
     |SI FSalida = 0;
         |LEE 000#rem00056.a;
     |SINO;
         |LEE 000#rem00056.u;
     |FINSI;

     nLinea = 1;
     |SI FSalida = 0;  |Y #rem00056#0 = #rem00056@#0;
         nLinea = #rem00056#1 + 1;
     |FINSI;

     |DDEFECTO #rem00056;
     #rem00056#0  = #rem00056@#0;
     #rem00056#1  = nLinea;
     |PARA nCampoPase = 2;  |SI nCampoPase [ 15;  |HACIENDO nCampoPase = nCampoPase + 1;
           #rem00056#nCampoPase# = #rem00056@#nCampoPase#;
     |SIGUE;

     |SI #rem00056@#14 [ nImporte;
         nImporte = nImporte - #rem00056@#14;
         |ACABA;
     |SINO;
         #rem00056#14 = (N\ #rem00056@#14 - nImporte);
         nImporte = 0;
     |FINSI;

     |SELECT #2#rem02002;
     #rem02002#3 = #rem00056@#11;
     |LEE 000#rem02002.=;

     #rem00056#11 = #rem02002#0;

     |SI #rem02002#2 = "S";
         nAnyo = #rem00056@#13;
     |SINO;
         |SI nAnyo = 0;  nAnyo = #rem00056@#13;  |FINSI;
         |SI nAnyo = 0;  nAnyo = 2015;  |FINSI;

         |SI nAnyo = 0;  |ACABA;  |FINSI;
     |FINSI;

     #rem00056#13  = nAnyo;
     #rem00056#3   = "X";

     |SI eaCampo37 = "N";
         #rem00056#3 = #rem00056@#3;
     |FINSI;

                              #rem00056#16 = "";
     |SI #rem00056#3  = "X";  #rem00056#16 = eaRojo;        |FINSI;

     |GRABA 020#rem00056.n;
     |LIBERA #rem00056;

     eaPrograma = "rem00056";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00056_2016;
     #rem00056@#1002;
     11, 13;
     #rem01001@#0, 01, aTipoDed, nDEjer;
     #rem01001@#0, 99, aTipoDed, nHEjer;
     ;
     NULL, GrabaOtras;
|FIN;

|PROCESO PonOtras;
     |ABRE #rem02002;
     |BUCLE rem00056_2016;
     |CIERRA #rem02002;
|FPRC;

|PROCESO BuscaSiEsta;
     nGrabo   = 1;

     |PARA nLinea = 1;  |SI nLinea [ 99;  |HACIENDO nLinea = nLinea + 1;
           #rem00056#0  = #rem01033@#0;
           #rem00056#1  = nLinea;
           |LEE 000#rem00056.=;
           |SI FSalida = 0;
               |SI #rem00056#2  = aContri;  |Y #rem00056#14 = nImporte;  |Y #rem00056#11 = aTipoDed;
                   nGrabo = 0;
                   |SAL;
               |FINSI;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO CogeHasta2015;
     || Pasan al 0417
     nImporte = #rem01033@#47;
     nDEjer   = 2013;
     nHEjer   = 2014;
     nAnyo    = 0;
     aTipoDed = "394  ";
     |HAZ PonOtras;

     || Pasan al 0425
     nImporte = #rem01033@#111;
     nDEjer   = 2013;
     nHEjer   = 2014;
     nAnyo    = 0;
     aTipoDed = "400  ";
     |HAZ PonOtras;

     || Pasan al 0411
     nImporte = #rem01033@#40 + #rem01033@#42;
     nDEjer   = 2013;
     nHEjer   = 2015;
     nAnyo    = 0;
     aTipoDed = "388  ";
     |HAZ PonOtras;

     || Pasan al 0418
     nImporte = #rem01033@#156 + #rem01033@#160;
     nDEjer   = 2013;
     nHEjer   = 2014;
     nAnyo    = 0;
     aTipoDed = "395  ";
     |HAZ PonOtras;

     || Pasan al 0419
     nImporte = #rem01033@#142 + #rem01033@#145;
     nDEjer   = 2015;
     nHEjer   = 2015;
     nAnyo    = 0;
     aTipoDed = "396  ";
     |HAZ PonOtras;

     || Pasan al 0426
     nImporte = #rem01033@#159 + #rem01033@#157;
     nDEjer   = 2013;
     nHEjer   = 2014;
     nAnyo    = 0;
     aTipoDed = "401  ";
     |HAZ PonOtras;

     || Pasan al 0427
     nImporte = #rem01033@#143 + #rem01033@#144;
     nDEjer   = 0;
     nHEjer   = 0;
     nAnyo    = 0;
     aTipoDed = "402  ";
     |HAZ PonOtras;

     || Pasan al 0474
     nImporte = #rem01033@#76;
     nDEjer   = 2013;
     nHEjer   = 2015;
     nAnyo    = 0;
     aTipoDed = "446  ";
     |HAZ PonOtras;
|FPRC;

|PROCESO GrabaDedu2016;
     #rem00056#0  = #rem01001@#0;
     #rem00056#1  = 99;
     |LEE 000#rem00056.];
     |SI FSalida = 0;
         |LEE 000#rem00056.a;
     |SINO;
         |LEE 000#rem00056.u;
     |FINSI;

     nLinea = 1;
     |SI FSalida = 0;  |Y #rem00056#0 = #rem01001@#0;
         nLinea = #rem00056#1 + 1;
     |FINSI;

     |DDEFECTO #rem00056;
     #rem00056#0  = #rem01001@#0;
     #rem00056#1  = nLinea;
     #rem00056#2  = aContri;
     #rem00056#11 = aCasilla;
     #rem00056#12 = aDescri;
     #rem00056#13 = 2016;
     #rem00056#14 = nImporte;
     #rem00056#3  = "X";

     |SI eaCampo37 = "N";
         #rem00056#3 = "R";
     |FINSI;

                              #rem00056#16 = "";
     |SI #rem00056#3  = "X";  #rem00056#16 = eaRojo;        |FINSI;

     |GRABA 020#rem00056.n;
     |LIBERA #rem00056;

     eaPrograma = "rem00056";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO Coge2016;
     nImporte = #rem01033@#45;  || 406
     |SI nImporte > 0;
         aContri = #rem01001@#2;
         |SI #rem01001@#2 = "CONJUNTA  ";  aContri = "GANANCIAL ";   |FINSI;
         |SI #rem01001@#2 = "CONJUNTAE ";  aContri = "TITULAR   ";  |FINSI;

         aTipoDed = "     ";
         |HAZ BuscaSiEsta;

         |SI nGrabo = 1;
             aDescri = "EJERCICIO ANTERIOR CASILLA 406";
             |SI aContri = "GANANCIAL ";
                 aDescri = "EJERCICIO ANTERIOR CASILLA 406 CONJUNTA";
             |FINSI;
             aCasilla = "0411  ";
             |HAZ GrabaDedu2016;
         |FINSI;
     |FINSI;

     nImporte = #rem01033@#162;  || 407
     |SI nImporte > 0;
         aContri = #rem01001@#2;
         |SI #rem01001@#2 = "CONJUNTA  ";  aContri = "GANANCIAL ";   |FINSI;
         |SI #rem01001@#2 = "CONJUNTAE ";  aContri = "TITULAR   ";  |FINSI;

         aTipoDed = "     ";
         |HAZ BuscaSiEsta;

         |SI nGrabo = 1;
             aDescri = "EJERCICIO ANTERIOR CASILLA 407";
             |SI aContri = "GANANCIAL ";
                 aDescri = "EJERCICIO ANTERIOR CASILLA 407 CONJUNTA";
             |FINSI;
             aCasilla = "0420  ";
             |HAZ GrabaDedu2016;
         |FINSI;
     |FINSI;

     nImporte = #rem01033@#163;   || 408
     |SI nImporte > 0;
         aContri = #rem01001@#2;
         |SI #rem01001@#2 = "CONJUNTA  ";  aContri = "GANANCIAL ";   |FINSI;
         |SI #rem01001@#2 = "CONJUNTAE ";  aContri = "TITULAR   ";  |FINSI;

         aTipoDed = "     ";
         |HAZ BuscaSiEsta;

         |SI nGrabo = 1;
             aDescri = "EJERCICIO ANTERIOR CASILLA 408";
             |SI aContri = "GANANCIAL ";
                 aDescri = "EJERCICIO ANTERIOR CASILLA 408 CONJUNTA";
             |FINSI;
             aCasilla = "0428  ";
             |HAZ GrabaDedu2016;
         |FINSI;
     |FINSI;

     nImporte = -#rem01033@#75;  || 445
     |SI nImporte > 0;
         aContri = #rem01001@#2;
         |SI #rem01001@#2 = "CONJUNTA  ";  aContri = "GANANCIAL ";   |FINSI;
         |SI #rem01001@#2 = "CONJUNTAE ";  aContri = "TITULAR   ";  |FINSI;

         aTipoDed = "     ";
         |HAZ BuscaSiEsta;

         |SI nGrabo = 1;
             aDescri = "EJERCICIO ANTERIOR CASILLA 445";
             |SI aContri = "GANANCIAL ";
                 aDescri = "EJERCICIO ANTERIOR CASILLA 445 CONJUNTA";
             |FINSI;

             aCasilla = "0474  ";
             |HAZ GrabaDedu2016;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO rem01001_M56;
     #rem01033@#0 = #rem01001@#0;
     #rem01033@#1 = #rem01001@#1;
     #rem01033@#2 = #rem01001@#2;
     |LEE 040#rem01033@.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |HAZ CogeHasta2015;
     |HAZ Coge2016;
|FPRC;

|DEFBUCLE rem01001_M56;
     #rem01001@#1003;
     5;
     enEmpresa, 00, "          ", "100";
     enEmpresa, 99, "zzzzzzzzzz", "101";
     ;
     NULL, rem01001_M56;
|FIN;

|PROCESO PasaM00056;
     aDef = eaCampo0 + "/def/rem01001.mas";  |QBT aDef;
     |CARGA_DEF aDef, rem01001@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01001 A¤o 2016 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = eaCampo0 + "/def/rem00056.mas";  |QBT aDef;
     |CARGA_DEF aDef, rem00056@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00056 A¤o 2016 ";
         |MENAV aAlfa;

         |DESCARGA_DEF #rem01001@;

         |ACABA;
     |FINSI;

     aDef = eaCampo0 + "/def/rem01033.mas";  |QBT aDef;
     |CARGA_DEF aDef, rem01033@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01033 A¤o 2016 ";
         |MENAV aAlfa;

         |DESCARGA_DEF #rem00056@;
         |DESCARGA_DEF #rem01001@;

         |ACABA;
     |FINSI;

     |PATH_DAT #rem01001@#eaPathRen2016#;
     |PATH_DAT #rem00056@#eaPathRen2016#;
     |PATH_DAT #rem01033@#eaPathRen2016#;

     |ABRE #rem01033@;
     |ABRE #rem00056;
     |BUCLE rem01001_M56;
     |CIERRA #rem01033@;
     |CIERRA #rem00056;

     |DESCARGA_DEF #rem01033@;
     |DESCARGA_DEF #rem00056@;
     |DESCARGA_DEF #rem01001@;
|FPRC;

|PROGRAMA;
     |HAZ PasaM00056;
     |HAZ PasaM00053;
     |HAZ PasaM00061;
     |HAZ PasaM00053Exc;
     |HAZ PasaM00041;
     |HAZ PasaM00042;
     |HAZ PasaM00030;
|FPRO;
