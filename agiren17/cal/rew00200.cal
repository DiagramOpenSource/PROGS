|FICHEROS;
     rew00200;
     rew00201,MANTE;
     rew00202,MANTE;
     rew00204,MANTE;
     rem00100;
     repoblac;
     recofisc;
     reparame;
     rem00007;
|FIN;

|VARIABLES;
     aF2            = "";
     aF3            = "";
     aF4            = "";
     aF5            = "";
     aF6            = "";
     aF7            = "";
     aEsc           = "";
     aTecla         = "";
     aNombre        = "";
     aAlfa          = "";
     aAlfa1         = "";
     aAlfa2         = "";

     nBotonCopia1   = 0;
     nBotonCopia2   = 0;
     nError         = 0;
     nCampo         = 0;
     nCampo1        = 0;
     nCampo2        = 0;
     nContribuyente = 0;
     nSw            = 0;
     nCompara       = 0;
     nRegraba       = 0;
     nPanta         = 0;

     &enEmpresa     = 0;
     &eaPrograma    = "";
     &eaPunto       = "";
     &eaNombre      = "";
     &eaNif         = "";
     &enModo        = 0;
     &enCodCli      = 0;
     &enSwDeDonde   = 0;
     &eaConvive     = "";
     &eaEstado      = "";
     &eaLetra       = "";
     &enCodProv     = 0;
     &enCodPobl     = 0;
     &enVentGnrl    = 0;
     &enVentTrab    = 0;
|FIN;

|INCLUYE i_sepnom;

|PROCESO Validaciones;
     nError = 0;
     |SI #rem00100#100 = "D";
         |SI #rem00100#12 = "            ";
             |MENAV "      Obligado a introducir numero de Telefono al ser Primera Declaracion Titular";
             nError = 1;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #rem00100#113 = "N";
         |SI #rem00100#14 = "     ";
             |MENAV "      Sigla de la Calle del Titular sin Contenido.";
             nError = 1;
             |ACABA;
         |FINSI;

         aAlfa = #rem00100#15;  |QBF aAlfa;
         |SI aAlfa = "";
             |MENAV "      Calle del Titular sin Contenido.";
             nError = 1;
             |ACABA;
         |FINSI;

         |SI #rem00100#16 = "    ";
             |MENAV "      Numero de la Calle del Titular sin Contenido.";
             nError = 1;
             |ACABA;
         |FINSI;

         aAlfa = #rem00100#22;  |QBF aAlfa;
         |SI aAlfa = "";
             |MENAV "      Poblacion del Titular sin Contenido.";
             nError = 1;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #rem00100#103 < "31.12.1882";
         |MENAV "      Fecha de Nacimiento del Titular incorrecta.";
         nError = 1;
         |ACABA;
     |FINSI;

     |SI #rem00100#6 ! "C";  |ACABA;  |FINSI;

     |SI #rem00100#101 = "D";
         |SI #rem00100#13 = "            ";
             |MENAV "      Obligado a introducir numero de Telefono al ser Primera Declaracion Conyuge";
             nError = 1;
             |ACABA;
         |FINSI;
     |FINSI;

     aAlfa = #rem00100#35;  |QBF aAlfa;
     |SI aAlfa = "";   |Y #rem00100#102 ! "X";
         |MENAV "      No esta informado el NIF del Conyuge";
         nError = 1;
         |ACABA;
     |FINSI;

     aAlfa = #rem00100#39;  |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "      Nombre del Conyuge sin Contenido.";
         nError = 1;
         |ACABA;
     |FINSI;

     |SI #rem00100#130 = "N";
         |SI #rem00100#44 = "     ";
             |MENAV "      Sigla de la Calle del Conyuge sin Contenido.";
             nError = 1;
             |ACABA;
         |FINSI;

         aAlfa = #rem00100#45;  |QBF aAlfa;
         |SI aAlfa = "";
             |MENAV "      Calle del Conyuge sin Contenido.";
             nError = 1;
             |ACABA;
         |FINSI;

         |SI #rem00100#46 = "    ";
             |MENAV "      Numero de la Calle del Conyuge sin Contenido.";
             nError = 1;
             |ACABA;
         |FINSI;

         aAlfa = #rem00100#52;  |QBF aAlfa;
         |SI aAlfa = "";
             |MENAV "      Poblacion del Conyuge sin Contenido.";
             nError = 1;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #rem00100#104 < "31.12.1882";
         |MENAV "      Fecha de Nacimiento del Conyuge incorrecta.";
         nError = 1;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO CopiaConyuge;
     |SI #rem00100#6 ! "C";  |ACABA;  |FINSI;

     #rew00204#32 = #rew00204#28;   |PINTA #rew00204#32;
     #rew00204#33 = #rew00204#29;   |PINTA #rew00204#33;
     #rew00204#34 = #rew00204#30;   |PINTA #rew00204#34;
     #rew00204#35 = #rew00204#31;   |PINTA #rew00204#35;
     #rew00204#50 = #rew00204#49;   |PINTA #rew00204#50;
     #rew00204#53 = #rew00204#52;   |PINTA #rew00204#53;
|FPRC;

|PROCESO CopiaConjunta;
     #rew00204#36 = #rew00204#28;   |PINTA #rew00204#36;
     #rew00204#37 = #rew00204#29;   |PINTA #rew00204#37;
     #rew00204#38 = #rew00204#30;   |PINTA #rew00204#38;
     #rew00204#39 = #rew00204#31;   |PINTA #rew00204#39;
     #rew00204#51 = #rew00204#49;   |PINTA #rew00204#51;
     #rew00204#54 = #rew00204#52;   |PINTA #rew00204#54;
|FPRC;

|PROCESO ChequeoConyuge;
     nSw = 0;
     |SI #rem00100#113 ! #rem00100#130;   nSw = 1;  |FINSI;
     |SI #rem00100#14  ! #rem00100#44;    nSw = 1;  |FINSI;
     |SI #rem00100#15  ! #rem00100#45;    nSw = 1;  |FINSI;
     |SI #rem00100#114 ! #rem00100#131;   nSw = 1;  |FINSI;
     |SI #rem00100#16  ! #rem00100#46;    nSw = 1;  |FINSI;
     |SI #rem00100#115 ! #rem00100#132;   nSw = 1;  |FINSI;
     |SI #rem00100#116 ! #rem00100#133;   nSw = 1;  |FINSI;
     |SI #rem00100#117 ! #rem00100#134;   nSw = 1;  |FINSI;
     |SI #rem00100#17  ! #rem00100#47;    nSw = 1;  |FINSI;
     |SI #rem00100#18  ! #rem00100#48;    nSw = 1;  |FINSI;
     |SI #rem00100#19  ! #rem00100#49;    nSw = 1;  |FINSI;
     |SI #rem00100#118 ! #rem00100#135;   nSw = 1;  |FINSI;
     |SI #rem00100#119 ! #rem00100#136;   nSw = 1;  |FINSI;
     |SI #rem00100#20  ! #rem00100#50;    nSw = 1;  |FINSI;
     |SI #rem00100#21  ! #rem00100#51;    nSw = 1;  |FINSI;
     |SI #rem00100#22  ! #rem00100#52;    nSw = 1;  |FINSI;
     |SI #rem00100#120 ! #rem00100#137;   nSw = 1;  |FINSI;
     |SI #rem00100#121 ! #rem00100#138;   nSw = 1;  |FINSI;
     |SI #rem00100#122 ! #rem00100#139;   nSw = 1;  |FINSI;
     |SI #rem00100#123 ! #rem00100#140;   nSw = 1;  |FINSI;
     |SI #rem00100#124 ! #rem00100#141;   nSw = 1;  |FINSI;
     |SI #rem00100#125 ! #rem00100#142;   nSw = 1;  |FINSI;
     |SI #rem00100#126 ! #rem00100#143;   nSw = 1;  |FINSI;
     |SI #rem00100#127 ! #rem00100#144;   nSw = 1;  |FINSI;
     |SI #rem00100#11  ! #rem00100#43;    nSw = 1;  |FINSI;
     |SI #rem00100#145 ! #rem00100#146;    nSw = 1;  |FINSI;
     |SI #rem00100#150 ! #rem00100#152;   nSw = 1;  |FINSI;
     |SI #rem00100#151 ! #rem00100#153;   nSw = 1;  |FINSI;
     |SI #rem00100#157 ! #rem00100#158;   nSw = 1;  |FINSI;

     |SI nSw = 0;  |ACABA;  |FINSI;

     |SI #rem00100#130 = "N";
         aAlfa = #rem00100#45;
     |SINO;
         aAlfa = #rem00100#137;
     |FINSI;

     |QBF aAlfa;

     |SI aAlfa ! "";
         |CONFI "0000 Los datos del domicilio habitual difiere entre los declarantes, quiere igualarlos";
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     #rem00100#130 = #rem00100#113;
     #rem00100#44  = #rem00100#14;
     #rem00100#45  = #rem00100#15;
     #rem00100#131 = #rem00100#114;
     #rem00100#46  = #rem00100#16;
     #rem00100#132 = #rem00100#115;
     #rem00100#133 = #rem00100#116;
     #rem00100#134 = #rem00100#117;
     #rem00100#47  = #rem00100#17;
     #rem00100#48  = #rem00100#18;
     #rem00100#49  = #rem00100#19;
     #rem00100#135 = #rem00100#118;
     #rem00100#136 = #rem00100#119;
     #rem00100#50  = #rem00100#20;
     #rem00100#51  = #rem00100#21;
     #rem00100#52  = #rem00100#22;
     #rem00100#137 = #rem00100#120;
     #rem00100#138 = #rem00100#121;
     #rem00100#139 = #rem00100#122;
     #rem00100#140 = #rem00100#123;
     #rem00100#141 = #rem00100#124;
     #rem00100#142 = #rem00100#125;
     #rem00100#143 = #rem00100#126;
     #rem00100#144 = #rem00100#127;
     #rem00100#43  = #rem00100#11;
     #rem00100#146 = #rem00100#145;
     #rem00100#152 = #rem00100#150;
     #rem00100#153 = #rem00100#151;
     #rem00100#158 = #rem00100#157;
|FPRC;

|PROCESO ChequeoEnvio;
     nSw = 0;
     |SI #rem00100#14  ! #rem00100#24;    nSw = 1;  |FINSI;
     |SI #rem00100#15  ! #rem00100#25;    nSw = 1;  |FINSI;
     |SI #rem00100#16  ! #rem00100#26;    nSw = 1;  |FINSI;
     |SI #rem00100#17  ! #rem00100#27;    nSw = 1;  |FINSI;
     |SI #rem00100#18  ! #rem00100#28;    nSw = 1;  |FINSI;
     |SI #rem00100#19  ! #rem00100#29;    nSw = 1;  |FINSI;
     |SI #rem00100#20  ! #rem00100#30;    nSw = 1;  |FINSI;
     |SI #rem00100#21  ! #rem00100#31;    nSw = 1;  |FINSI;
     |SI #rem00100#22  ! #rem00100#32;    nSw = 1;  |FINSI;

     |SI nSw = 0;  |ACABA;  |FINSI;

     aAlfa = #rem00100#25;  |QBF aAlfa;

     |SI aAlfa ! "";
         |CONFI "0000 Los datos del domicilio de envio difiere a los del declarante, quiere igualarlos";
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     #rem00100#24  = #rem00100#14;
     #rem00100#25  = #rem00100#15;
     #rem00100#26  = #rem00100#16;
     #rem00100#27  = #rem00100#17;
     #rem00100#28  = #rem00100#18;
     #rem00100#29  = #rem00100#19;
     #rem00100#30  = #rem00100#20;
     #rem00100#31  = #rem00100#21;
     #rem00100#32  = #rem00100#22;
|FPRC;

|PROCESO ProcesoP1;
     nContribuyente = 1;

     |ABRE #repoblac;
     #repoblac#0    = #rem00100#20;
     #repoblac#1    = #rem00100#21;
     |LEE 000#repoblac.=;
     |SI FSalida ! 0;   |DDEFECTO #repoblac;  |FINSI;
     |CIERRA #repoblac;

     |ABRE #recofisc;
     #recofisc#0 = #rem00100#20;
     |LEE 040#recofisc.=;
     |SI FSalida ! 0;  |DDEFECTO #recofisc;  |FINSI;
     |CIERRA #recofisc;

     #rew00201#0  = #rem00100#1;
     #rew00201#1  = #rem00100#5;
     #rew00201#2  = #rem00100#2;
     #rew00201#3  = #rem00100#3;
     #rew00201#4  = #rem00100#4;
     #rew00201#5  = #rem00100#105;
     #rew00201#6  = #rem00100#6;
     #rew00201#7  = #rem00100#103;
     #rew00201#8  = #rem00100#8;
     #rew00201#9  = #rem00100#9;
     #rew00201#10 = #rem00100#95;
     #rew00201#11 = #rem00100#10;
     #rew00201#12 = #rem00100#94;
     #rew00201#13 = #rem00100#99;
     #rew00201#14 = #rem00100#12;
     #rew00201#15 = #rem00100#109;
     #rew00201#16 = #rem00100#112;
     #rew00201#17 = #rem00100#111;
     #rew00201#18 = #rem00100#113;
     #rew00201#19 = #rem00100#14;
     #rew00201#20 = #rem00100#15;
     #rew00201#21 = #rem00100#114;
     #rew00201#22 = #rem00100#16;
     #rew00201#23 = #rem00100#115;
     #rew00201#24 = #rem00100#116;
     #rew00201#25 = #rem00100#117;
     #rew00201#26 = #rem00100#17;
     #rew00201#27 = #rem00100#18;
     #rew00201#28 = #rem00100#19;
     #rew00201#29 = #rem00100#118;
     #rew00201#30 = #rem00100#119;
     #rew00201#31 = #rem00100#20;
     #rew00201#32 = #rem00100#21;
     #rew00201#33 = #rem00100#22;
     #rew00201#34 = #repoblac#2;
     #rew00201#35 = #rem00100#120;
     #rew00201#36 = #rem00100#121;
     #rew00201#37 = #rem00100#122;
     #rew00201#38 = #rem00100#123;
     #rew00201#39 = #rem00100#124;
     #rew00201#40 = #rem00100#125;
     #rew00201#41 = #rem00100#126;
     #rew00201#42 = #rem00100#127;
     #rew00201#43 = #rem00100#11;
     #rew00201#46 = #rem00100#145;
     #rew00201#47 = #rem00100#150;
     #rew00201#48 = #rem00100#151;
     #rew00201#49 = #rem00100#157;
     #rew00201#50 = #rem00100#159;

     |ABRE #rem00007;
     #rem00007#0 = #rew00201#43;
     |LEE 000#rem00007.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00007;  |FINSI;
     |CIERRA #rem00007;

     #rew00201#44 = #rem00007#1;

     |SI #rew00201#18 ! "S";
         |SI #rew00201#45 ! " ";
             #rew00201#43 = 20;
             #rew00201#44 = "";
         |FINSI;
     |FINSI;

     |PINPA #0#rew00201;
     |PINDA #0#rew00201;

     |SI enModo ! 4;
         |ENDATOS #1#rew00201;
         |SI FSalida = 0;
             #rem00100#1   = #rew00201#0;
             #rem00100#5   = #rew00201#1;
             #rem00100#2   = #rew00201#2;
             #rem00100#3   = #rew00201#3;
             #rem00100#4   = #rew00201#4;
             #rem00100#105 = #rew00201#5;
             #rem00100#6   = #rew00201#6;
             #rem00100#103 = #rew00201#7;
             #rem00100#8   = #rew00201#8;
             #rem00100#9   = #rew00201#9;
             #rem00100#95  = #rew00201#10;
             #rem00100#10  = #rew00201#11;
             #rem00100#94  = #rew00201#12;
             #rem00100#99  = #rew00201#13;
             #rem00100#12  = #rew00201#14;
             #rem00100#109 = #rew00201#15;
             #rem00100#112 = #rew00201#16;
             #rem00100#111 = #rew00201#17;
             #rem00100#113 = #rew00201#18;
             #rem00100#14  = #rew00201#19;
             #rem00100#15  = #rew00201#20;
             #rem00100#114 = #rew00201#21;
             #rem00100#16  = #rew00201#22;
             #rem00100#115 = #rew00201#23;
             #rem00100#116 = #rew00201#24;
             #rem00100#117 = #rew00201#25;
             #rem00100#17  = #rew00201#26;
             #rem00100#18  = #rew00201#27;
             #rem00100#19  = #rew00201#28;
             #rem00100#118 = #rew00201#29;
             #rem00100#119 = #rew00201#30;
             #rem00100#20  = #rew00201#31;
             #rem00100#21  = #rew00201#32;
             #rem00100#22  = #rew00201#33;
             #rem00100#23  = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103);
             #rem00100#120 = #rew00201#35;
             #rem00100#121 = #rew00201#36;
             #rem00100#122 = #rew00201#37;
             #rem00100#123 = #rew00201#38;
             #rem00100#124 = #rew00201#39;
             #rem00100#125 = #rew00201#40;
             #rem00100#126 = #rew00201#41;
             #rem00100#127 = #rew00201#42;
             #rem00100#11  = #rew00201#43;
             #rem00100#145 = #rew00201#46;
             #rem00100#150 = #rew00201#47;
             #rem00100#151 = #rew00201#48;
             #rem00100#157 = #rew00201#49;
             #rem00100#159 = #rew00201#50;
             #rem00100#7   = #rem00100#103 % -104;

             |SI #rem00100#6 ! "C";
                 #rem00100#35  = "";
                 #rem00100#39  = "";
                 #rem00100#36  = "";
                 #rem00100#37  = "";
                 #rem00100#38  = "";
                 #rem00100#106 = "";
                 #rem00100#104 = "01.01.0000";
                 #rem00100#41  = 0;
                 #rem00100#42  = "";
                 #rem00100#102 = "";
                 #rem00100#13  = "";
                 #rem00100#110 = "";
                 #rem00100#129 = "";
                 #rem00100#128 = "";
                 #rem00100#130 = "";
                 #rem00100#44  = "";
                 #rem00100#45  = "";
                 #rem00100#131 = "";
                 #rem00100#46  = "";
                 #rem00100#132 = "";
                 #rem00100#133 = "";
                 #rem00100#134 = "";
                 #rem00100#47  = "";
                 #rem00100#48  = "";
                 #rem00100#49  = "";
                 #rem00100#135 = "";
                 #rem00100#136 = "";
                 #rem00100#50  = 0;
                 #rem00100#51  = 0;
                 #rem00100#52  = "";
                 #rem00100#137 = "";
                 #rem00100#138 = "";
                 #rem00100#139 = "";
                 #rem00100#140 = "";
                 #rem00100#141 = "";
                 #rem00100#142 = "";
                 #rem00100#143 = 0;
                 #rem00100#144 = "";
                 #rem00100#43  = 0;
                 #rem00100#54  = "";
                 #rem00100#60  = "";
                 #rem00100#40  = "0000";
             |FINSI;
         |FINSI;

         |HAZ ChequeoEnvio;

         |SI #rem00100#6 = "C";
             |SI #rem00100#106 = " ";
                 |SI #rem00100#105 = "V";  #rem00100#106 = "M";  |FINSI;
                 |SI #rem00100#105 = "M";  #rem00100#106 = "V";  |FINSI;
             |FINSI;

             |HAZ ChequeoConyuge;
         |FINSI;
     |SINO;
         |PAUSA;
     |FINSI;

     #rew00200#0 = #rem00100#5;
     #rew00200#1 = #rem00100#39;
|FPRC;

|PROCESO ProcesoP2;
     |SI #rem00100#6 ! "C";
         |MENAV "0000No procede, el contribuyente no est  casado.";
         |ACABA;
     |FINSI;

     nContribuyente = 2;

     |ABRE #repoblac;
     #repoblac#0    = #rem00100#50;
     #repoblac#1    = #rem00100#51;
     |LEE 000#repoblac.=;
     |SI FSalida ! 0;   |DDEFECTO #repoblac;  |FINSI;
     |CIERRA #repoblac;

     |ABRE #recofisc;
     #recofisc#0 = #rem00100#50;
     |LEE 040#recofisc.=;
     |SI FSalida ! 0;  |DDEFECTO #recofisc;  |FINSI;
     |CIERRA #recofisc;

     #rew00202#0  = #rem00100#35;
     #rew00202#1  = #rem00100#39;
     #rew00202#2  = #rem00100#36;
     #rew00202#3  = #rem00100#37;
     #rew00202#4  = #rem00100#38;
     #rew00202#5  = #rem00100#106;
     #rew00202#6  = #rem00100#104;
     #rew00202#7  = #rem00100#41;
     #rew00202#8  = #rem00100#42;
     #rew00202#10 = #rem00100#13;
     #rew00202#11 = #rem00100#110;
     #rew00202#12 = #rem00100#129;
     #rew00202#13 = #rem00100#128;
     #rew00202#14 = #rem00100#130;
     #rew00202#15 = #rem00100#44;
     #rew00202#16 = #rem00100#45;
     #rew00202#17 = #rem00100#131;
     #rew00202#18 = #rem00100#46;
     #rew00202#19 = #rem00100#132;
     #rew00202#20 = #rem00100#133;
     #rew00202#21 = #rem00100#134;
     #rew00202#22 = #rem00100#47;
     #rew00202#23 = #rem00100#48;
     #rew00202#24 = #rem00100#49;
     #rew00202#25 = #rem00100#135;
     #rew00202#26 = #rem00100#136;
     #rew00202#27 = #rem00100#50;
     #rew00202#28 = #rem00100#51;
     #rew00202#29 = #rem00100#52;
     #rew00202#30 = #repoblac#2;
     #rew00202#31 = #rem00100#137;
     #rew00202#32 = #rem00100#138;
     #rew00202#33 = #rem00100#139;
     #rew00202#34 = #rem00100#140;
     #rew00202#35 = #rem00100#141;
     #rew00202#36 = #rem00100#142;
     #rew00202#37 = #rem00100#143;
     #rew00202#38 = #rem00100#144;
     #rew00202#39 = #rem00100#43;
     #rew00202#42 = #rem00100#146;
     #rew00202#43 = #rem00100#152;
     #rew00202#44 = #rem00100#153;
     #rew00202#45 = #rem00100#158;
     #rew00202#46 = #rem00100#160;

     #rew00202#9  = "N";
     |SI #rem00100#102 = "X";
         #rew00202#9  = "S";
     |FINSI;

     |ABRE #rem00007;
     #rem00007#0 = #rew00202#39;
     |LEE 000#rem00007.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00007;  |FINSI;
     |CIERRA #rem00007;

     #rew00202#40 = #rem00007#1;

     |SI #rew00202#14 ! "S";
         |SI #rew00202#41 ! " ";
             #rew00202#39 = 20;
             #rew00202#40 = "";
         |FINSI;
     |FINSI;

     |PINPA #0#rew00202;
     |PINDA #0#rew00202;

     |SI enModo ! 4;
         |ENDATOS #1#rew00202;
         |SI FSalida = 0;
             #rem00100#35  = #rew00202#0;
             #rem00100#39  = #rew00202#1;
             #rem00100#36  = #rew00202#2;
             #rem00100#37  = #rew00202#3;
             #rem00100#38  = #rew00202#4;
             #rem00100#106 = #rew00202#5;
             #rem00100#104 = #rew00202#6;
             #rem00100#41  = #rew00202#7;
             #rem00100#42  = #rew00202#8;
             #rem00100#13  = #rew00202#10;
             #rem00100#110 = #rew00202#11;
             #rem00100#129 = #rew00202#12;
             #rem00100#128 = #rew00202#13;
             #rem00100#130 = #rew00202#14;
             #rem00100#44  = #rew00202#15;
             #rem00100#45  = #rew00202#16;
             #rem00100#131 = #rew00202#17;
             #rem00100#46  = #rew00202#18;
             #rem00100#132 = #rew00202#19;
             #rem00100#133 = #rew00202#20;
             #rem00100#134 = #rew00202#21;
             #rem00100#47  = #rew00202#22;
             #rem00100#48  = #rew00202#23;
             #rem00100#49  = #rew00202#24;
             #rem00100#135 = #rew00202#25;
             #rem00100#136 = #rew00202#26;
             #rem00100#50  = #rew00202#27;
             #rem00100#51  = #rew00202#28;
             #rem00100#52  = #rew00202#29;
             #rem00100#137 = #rew00202#31;
             #rem00100#138 = #rew00202#32;
             #rem00100#139 = #rew00202#33;
             #rem00100#140 = #rew00202#34;
             #rem00100#141 = #rew00202#35;
             #rem00100#142 = #rew00202#36;
             #rem00100#143 = #rew00202#37;
             #rem00100#144 = #rew00202#38;
             #rem00100#43  = #rew00202#39;
             #rem00100#146 = #rew00202#42;
             #rem00100#152 = #rew00202#43;
             #rem00100#153 = #rew00202#44;
             #rem00100#40  = #rem00100#104 % -104;
             #rem00100#158 = #rew00202#45;
             #rem00100#160 = #rew00202#46;

             #rem00100#102 = "";
             |SI #rew00202#9 = "S";
                 #rem00100#102 = "X";
             |FINSI;
         |FINSI;
     |SINO;
         |PAUSA;
     |FINSI;

     #rew00200#0 = #rem00100#5;
     #rew00200#1 = #rem00100#39;
|FPRC;

|PROCESO ProcesoP3;
     enEmpresa = #rem00100#0;
     eaConvive = #rem00100#95;
     eaEstado  = #rem00100#6;
     |SUB_EJECUTA_NP "rem00101";
|FPRC;

|PROCESO ProcesoP4;
     #rew00204#0  = #rem00100#58;
     #rew00204#1  = #rem00100#57;
     #rew00204#2  = #rem00100#56;
     #rew00204#3  = #rem00100#59;
     #rew00204#4  = #rem00100#60;
     #rew00204#5  = #rem00100#93;
     #rew00204#6  = #rem00100#90;
     #rew00204#7  = #rem00100#91;
     #rew00204#8  = #rem00100#92;
     #rew00204#9  = #rem00100#98;
     #rew00204#10 = #rem00100#97;
     #rew00204#11 = #rem00100#53;
     #rew00204#12 = #rem00100#54;
     #rew00204#13 = #rem00100#55;
     #rew00204#14 = #rem00100#69;
     #rew00204#15 = #rem00100#70;
     #rew00204#16 = #rem00100#71;
     #rew00204#17 = #rem00100#72;
     #rew00204#18 = #rem00100#34;
     #rew00204#19 = #rem00100#24;
     #rew00204#20 = #rem00100#25;
     #rew00204#21 = #rem00100#26;
     #rew00204#22 = #rem00100#27;
     #rew00204#23 = #rem00100#28;
     #rew00204#24 = #rem00100#29;
     #rew00204#25 = #rem00100#30;
     #rew00204#26 = #rem00100#31;
     #rew00204#27 = #rem00100#32;

     #rew00204#40 = #rem00100#65;
     #rew00204#41 = #rem00100#66;
     #rew00204#42 = #rem00100#67;
     #rew00204#43 = #rem00100#68;
     #rew00204#44 = #rem00100#80;
     #rew00204#45 = #rem00100#81;
     #rew00204#46 = #rem00100#82;
     #rew00204#47 = #rem00100#83;
     #rew00204#48 = #rem00100#96;
     #rew00204#49 = #rem00100#147;
     #rew00204#50 = #rem00100#148;
     #rew00204#51 = #rem00100#149;
     #rew00204#52 = #rem00100#154;
     #rew00204#53 = #rem00100#155;
     #rew00204#54 = #rem00100#156;

     |SI #rew00204#0 = " ";  #rew00204#0 = "N";  |FINSI;
     |SI #rew00204#0 = "X";  #rew00204#0 = "S";  |FINSI;
     |SI #rew00204#1 = " ";  #rew00204#1 = "N";  |FINSI;
     |SI #rew00204#1 = "X";  #rew00204#1 = "S";  |FINSI;
     |SI #rew00204#2 = " ";  #rew00204#2 = "N";  |FINSI;
     |SI #rew00204#2 = "X";  #rew00204#2 = "S";  |FINSI;

     #rew00204#28 = #rew00204#11 % 104;
     #rew00204#29 = #rew00204#11 % 504;
     #rew00204#30 = #rew00204#11 % 902;
     #rew00204#31 = #rew00204#11 % 1110;

     #rew00204#32 = #rew00204#12 % 104;
     #rew00204#33 = #rew00204#12 % 504;
     #rew00204#34 = #rew00204#12 % 902;
     #rew00204#35 = #rew00204#12 % 1110;

     #rew00204#36 = #rew00204#13 % 104;
     #rew00204#37 = #rew00204#13 % 504;
     #rew00204#38 = #rew00204#13 % 902;
     #rew00204#39 = #rew00204#13 % 1110;

     |PINPA #0#rew00204;  nPanta = FSalida;

     |PTEC 802;  |PAUSA;  |PULSATECLA;

     |PARA nCampo = 0;  |SI nCampo [ 54;  |HACIENDO nCampo = nCampo + 1;
           |C_V #rew00204#nCampo#, 0, aAlfa;
           |SI aAlfa = "S";  |PINTA #rew00204#nCampo#;  |FINSI;
     |SIGUE;

     |SI enModo ! 4;
         |CONTROL_SIMPLE nPanta, "BOTON,Copy", 1594, 1599, CopiaConyuge;
         nBotonCopia1 = FSalida;

         |CONTROL_SIMPLE nPanta, "BOTON,Copy", 1694, 1699, CopiaConjunta;
         nBotonCopia2 = FSalida;

         |C_M #rew00204#32, 1, "S";
         |C_M #rew00204#33, 1, "S";
         |C_M #rew00204#34, 1, "S";
         |C_M #rew00204#35, 1, "S";

         |SI #rem00100#6 ! "C";
             |C_M #rew00204#32, 1, "N";
             |C_M #rew00204#33, 1, "N";
             |C_M #rew00204#34, 1, "N";
             |C_M #rew00204#35, 1, "N";

             |ESTADO_CONTROL nBotonCopia1, "DISABLE";
         |FINSI;

         |ENDATOS #1#rew00204;
         |SI FSalida = 0;
             #rem00100#56  = "";
             #rem00100#57  = "";
             #rem00100#58  = "";

             |SI #rew00204#0 = "S"; #rem00100#58  = "X";  |FINSI;
             |SI #rew00204#1 = "S"; #rem00100#57  = "X";  |FINSI;
             |SI #rew00204#2 = "S"; #rem00100#56  = "X";  |FINSI;

             #rem00100#59  = #rew00204#3;
             #rem00100#60  = #rew00204#4;
             #rem00100#93  = #rew00204#5;
             #rem00100#90  = #rew00204#6;
             #rem00100#91  = #rew00204#7;
             #rem00100#92  = #rew00204#8;
             #rem00100#98  = #rew00204#9;
             #rem00100#97  = #rew00204#10;
             #rem00100#53  = #rew00204#11;
             #rem00100#54  = #rew00204#12;
             #rem00100#55  = #rew00204#13;
             #rem00100#69  = #rew00204#14;
             #rem00100#70  = #rew00204#15;
             #rem00100#71  = #rew00204#16;
             #rem00100#72  = #rew00204#17;
             #rem00100#34  = #rew00204#18;
             #rem00100#24  = #rew00204#19;
             #rem00100#25  = #rew00204#20;
             #rem00100#26  = #rew00204#21;
             #rem00100#27  = #rew00204#22;
             #rem00100#28  = #rew00204#23;
             #rem00100#29  = #rew00204#24;
             #rem00100#30  = #rew00204#25;
             #rem00100#31  = #rew00204#26;
             #rem00100#32  = #rew00204#27;
             #rem00100#65  = #rew00204#40;
             #rem00100#66  = #rew00204#41;
             #rem00100#67  = #rew00204#42;
             #rem00100#68  = #rew00204#43;
             #rem00100#80  = #rew00204#44;
             #rem00100#81  = #rew00204#45;
             #rem00100#82  = #rew00204#46;
             #rem00100#83  = #rew00204#47;
             #rem00100#96  = #rew00204#48;
             #rem00100#147 = #rew00204#49;
             #rem00100#148 = #rew00204#50;
             #rem00100#149 = #rew00204#51;
             #rem00100#154 = #rew00204#52;
             #rem00100#155 = #rew00204#53;
             #rem00100#156 = #rew00204#54;
         |FINSI;
     |SINO;
         |PAUSA;
     |FINSI;
|FPRC;

|PROCESO ProcesoP5;
     |SI enModo ! 4;
         |GRABA 020#rem00100.a;
         |LIBERA #rem00100;
     |FINSI;

     enEmpresa = #rem00100#0;
     |SUB_EJECUTA_NP "rem00102";

     |SI enModo ! 4;
         #rem00100#0 = enEmpresa;
         |LEE 101#rem00100.=;
     |FINSI;
|FPRC;

|PROCESO ComparaSiglas;
    |QBF aAlfa;
    |SI aAlfa = "AL";  aAlfa = "ALAM ";  |FINSI;
    |SI aAlfa = "AD";  aAlfa = "ALDEA";  |FINSI;
    |SI aAlfa = "AP";  aAlfa = "APTOS";  |FINSI;
    |SI aAlfa = "AR";  aAlfa = "ARRAL";  |FINSI;
    |SI aAlfa = "AY";  aAlfa = "ARRY ";  |FINSI;
    |SI aAlfa = "AV";  aAlfa = "AVDA ";  |FINSI;
    |SI aAlfa = "BJ";  aAlfa = "BJADA";  |FINSI;
    |SI aAlfa = "BR";  aAlfa = "BRANC";  |FINSI;
    |SI aAlfa = "BO";  aAlfa = "BARRO";  |FINSI;
    |SI aAlfa = "BL";  aAlfa = "BLQUE";  |FINSI;
    |SI aAlfa = "CL";  aAlfa = "CALLE";  |FINSI;
    |SI aAlfa = "CJ";  aAlfa = "CLLJA";  |FINSI;
    |SI aAlfa = "CM";  aAlfa = "CMNO ";  |FINSI;
    |SI aAlfa = "CR";  aAlfa = "CTRA ";  |FINSI;
    |SI aAlfa = "CS";  aAlfa = "CSRIO";  |FINSI;
    |SI aAlfa = "CO";  aAlfa = "COL  ";  |FINSI;
    |SI aAlfa = "CN";  aAlfa = "CJTO ";  |FINSI;
    |SI aAlfa = "CT";  aAlfa = "CUSTA";  |FINSI;
    |SI aAlfa = "CH";  aAlfa = "CHLET";  |FINSI;
    |SI aAlfa = "ED";  aAlfa = "EDIFC";  |FINSI;
    |SI aAlfa = "EN";  aAlfa = "ENTD ";  |FINSI;
    |SI aAlfa = "ES";  aAlfa = "ESCAL";  |FINSI;
    |SI aAlfa = "EX";  aAlfa = "EXPLA";  |FINSI;
    |SI aAlfa = "EM";  aAlfa = "EXTRM";  |FINSI;
    |SI aAlfa = "ER";  aAlfa = "EXTRR";  |FINSI;
    |SI aAlfa = "GL";  aAlfa = "GTA  ";  |FINSI;
    |SI aAlfa = "GV";  aAlfa = "G.V. ";  |FINSI;
    |SI aAlfa = "GR";  aAlfa = "GRUPO";  |FINSI;
    |SI aAlfa = "JR";  aAlfa = "JDIN ";  |FINSI;
    |SI aAlfa = "LG";  aAlfa = "LUGAR";  |FINSI;
    |SI aAlfa = "MS";  aAlfa = "MASIA";  |FINSI;
    |SI aAlfa = "MC";  aAlfa = "MERC ";  |FINSI;
    |SI aAlfa = "MT";  aAlfa = "MONTE";  |FINSI;
    |SI aAlfa = "ML";  aAlfa = "MUELL";  |FINSI;
    |SI aAlfa = "PQ";  aAlfa = "PQUE ";  |FINSI;
    |SI aAlfa = "PQ";  aAlfa = "PQUE ";  |FINSI;
    |SI aAlfa = "PD";  aAlfa = "PTDA ";  |FINSI;
    |SI aAlfa = "PJ";  aAlfa = "PSAJE";  |FINSI;
    |SI aAlfa = "PS";  aAlfa = "PASEO";  |FINSI;
    |SI aAlfa = "PZ";  aAlfa = "PLAZA";  |FINSI;
    |SI aAlfa = "PB";  aAlfa = "PBDO ";  |FINSI;
    |SI aAlfa = "PG";  aAlfa = "POLIG";  |FINSI;
    |SI aAlfa = "PR";  aAlfa = "PROL ";  |FINSI;
    |SI aAlfa = "PT";  aAlfa = "PNTE ";  |FINSI;
    |SI aAlfa = "PU";  aAlfa = "PTA  ";  |FINSI;
    |SI aAlfa = "RM";  aAlfa = "RAMAL";  |FINSI;
    |SI aAlfa = "RB";  aAlfa = "RBLA ";  |FINSI;
    |SI aAlfa = "RP";  aAlfa = "RAMPA";  |FINSI;
    |SI aAlfa = "RR";  aAlfa = "RIERA";  |FINSI;
    |SI aAlfa = "RC";  aAlfa = "RCON ";  |FINSI;
    |SI aAlfa = "RD";  aAlfa = "RONDA";  |FINSI;
    |SI aAlfa = "RU";  aAlfa = "RUA  ";  |FINSI;
    |SI aAlfa = "SC";  aAlfa = "SECT ";  |FINSI;
    |SI aAlfa = "SD";  aAlfa = "SENDA";  |FINSI;
    |SI aAlfa = "SB";  aAlfa = "SBIDA";  |FINSI;
    |SI aAlfa = "TO";  aAlfa = "TRRNT";  |FINSI;
    |SI aAlfa = "TR";  aAlfa = "TRVA ";  |FINSI;
    |SI aAlfa = "UR";  aAlfa = "URB  ";  |FINSI;
    |SI aAlfa = "VI";  aAlfa = "VIA  ";  |FINSI;
    |SI aAlfa = "VP";  aAlfa = "VIA  ";  |FINSI;
|FPRC;

|PROCESO MiraSiglas;
     aAlfa = #rem00100#14;  |HAZ ComparaSiglas;  #rem00100#14 = aAlfa;
     aAlfa = #rem00100#24;  |HAZ ComparaSiglas;  #rem00100#24 = aAlfa;
     aAlfa = #rem00100#44;  |HAZ ComparaSiglas;  #rem00100#44 = aAlfa;
|FPRC;


|PROGRAMA;
     |HAZ CargaColores;

     |ABRE #rem00100;
     |SELECT #1#rem00100;

     |SI eaLetra = "CO";
         #rem00100#0 = enEmpresa;
         |LEE 000#rem00100.=;
         |SI FSalida ! 0;
             |CIERRA #rem00100;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI enModo ! 4;
         #rem00100#0 = enEmpresa;
         |LEE 101#rem00100.=;
         |SI FSalida ! 0;
             |DDEFECTO #rem00100;
             #rem00100#0 = enEmpresa;
             #rem00100#5 = eaNombre;

             Cadena = #rem00100#5;  |QBF Cadena;
             |SI Cadena ! "";
                 |HAZ SeparaNombre;
                 #rem00100#2 = Cadena1;
                 #rem00100#3 = Cadena2;
                 #rem00100#4 = Cadena3;
             |FINSI;

             |GRABA 020#rem00100.b;
         |FINSI;

         |HAZ MiraSiglas;

         |ABRE #reparame;
         |LEE 040#reparame.p;
         |SI FSalida ! 0;  |DDEFECTO #reparame;  |FINSI;
         |CIERRA #reparame;

         |SI #rem00100#69 = 0;    #rem00100#69 = #reparame#4;  |FINSI;
         |SI #rem00100#70 = 0;    #rem00100#70 = #reparame#5;  |FINSI;
         |SI #rem00100#59 = " ";  #rem00100#59 = #reparame#1;  |FINSI;

         aNombre = #rem00100#5; |QBF aNombre;
                           |QBF eaNombre;

         |SI aNombre ! eaNombre;
             #rem00100#5 = eaNombre;
             Cadena = #rem00100#5;
             |SI Cadena ! "";
                 |HAZ SeparaNombre;
                 #rem00100#2 = Cadena1;
                 #rem00100#3 = Cadena2;
                 #rem00100#4 = Cadena3;
             |FINSI;
         |FINSI;

         #rem00100#1 = eaNif;
     |SINO;
         #rem00100#0 = enEmpresa;
         |LEE 000#rem00100.=;
         |SI FSalida ! 0;  |DDEFECTO #rem00100;  |FINSI;
     |FINSI;

     #rew00200#0 = #rem00100#5;

     |SI eaLetra = "CO";
         aAlfa1 = #rem00100#39;  |QBF aAlfa1;
         aAlfa2 = #rem00100#36 + #rem00100#37 + #rem00100#38;  |QBF aAlfa2;
         |SI aAlfa1 ! "";  |Y aAlfa2 = "";
             Cadena = #rem00100#39;
             |HAZ SeparaNombre;
             #rem00100#36 = Cadena1;
             #rem00100#37 = Cadena2;
             #rem00100#38 = Cadena3;
         |FINSI;

         |HAZ ChequeoConyuge;
         |HAZ ChequeoEnvio;

         #rem00100#7   = #rem00100#103 % -104;
         #rem00100#40  = #rem00100#104 % -104;
     |FINSI;

     |SI eaLetra = "P1";  |HAZ ProcesoP1;  |FINSI;
     |SI eaLetra = "P2";  |HAZ ProcesoP2;  |FINSI;
     |SI eaLetra = "P3";  |HAZ ProcesoP3;  |FINSI;
     |SI eaLetra = "P4";  |HAZ ProcesoP4;  |FINSI;
     |SI eaLetra = "P5";  |HAZ ProcesoP5;  |FINSI;

     |SI enModo ! 4;
         |GRABA 020#rem00100.a;
         |LIBERA #rem00100;
     |FINSI;

     |CIERRA #rem00100;

     eaPrograma = "rem00100";
     eaPunto    = "";
     |HAZ ProgramaActivo;

     eaNombre = #rew00200#0;

     |PULSATECLA;
|FPRO;

|PROCESO Tipo80w200;  |TIPO 80;
     FSalida = 3699;
|FPRC;
