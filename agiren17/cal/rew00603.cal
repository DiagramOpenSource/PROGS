|FICHEROS;
     rem00021;
     rem00100;
     reparame;

     rew00005;
     rew00603,MANTE;
     rew00621;
     rew99999;
|FIN;

|VARIABLES;
     aAlfa         = "";
     aAlfa1        = "";
     aAlfa2        = "";
     aAlfa3        = "";
     aLong         = "";
     aQueQuiero    = "";
     aNumCampos    = "";
     aNumPanta     = "";
     aPathRenta    = "";
     aDef          = "";
     aDescri       = "";
     Comodin       = "";
     Comodin1      = "";

     aEsc1         = "";
     aEsc2         = "";
     aRetu         = "";
     aTecla        = "";
     aID           = "";

     nVentana603    = -1;
     nCampo         = 0;
     nRango         = 0;
     nGrid          = -1;
     nBotonAlta     = 0;
     nBotonModi     = 0;
     nBotonBaja     = 0;
     nBotonCntr     = 0;
     nBotonRdto     = 0;
     nBotonInve     = 0;
     nBotonVent     = 0;
     nBotonAlqu     = 0;
     nBotonCalc1    = 0;
     nBotonCalc2    = 0;
     nBotonCalc3    = 0;
     nBotonCalc602_1= 0;
     nBotonCalc603_1= 0;
     nBotonCalc603_2= 0;
     nBotonCalc603_3= 0;
     nBotonCalc603_4= 0;
     nBotonCalc603_5= 0;
     nBotonCalc603_6= 0;
     nBotonCalc603_7= 0;
     nBotonCalc603_8= 0;
     nPanta         = 0;
     nPanta602      = 0;
     nPanta603      = 0;
     nID            = 0;
     nFecha         = 0;
     nEntrar        = 0;

     nDiasHT        = 0;
     nDiasHC        = 0;
     nDiasH1        = 0;
     nDiasH2        = 0;
     nDiasH3        = 0;
     nDiasH4        = 0;
     nPorce        = 0;
     nError        = 0;
     nTotal        = 0;
     nMejoras      = 0;
     nEdad         = 0;
     nAnyos        = 0;
     nLineaViv     = 0;
     nHabitual     = 0;
     nValor2       = 0;
     nNume         = 0;
     nAct117       = 0;
     nLin117       = 0;
     nSuma         = 0;
     nDiasHab      = 0;
     nDiasAlq      = 0;
     nDiasUso      = 0;
     nLong         = 0;
     nCaracter     = 0;
     nPosi         = 0;
     nNumPanta     = 0;
     nModo         = 0;
     nEntrada      = 0;
     nPtas         = 0;
     nRetencion    = 0;
     nValor        = 0;
     nValor1       = 0;
     nValorPat     = 0;
     nDias         = 0;
     nAnyoVenta    = 0;
     nAnyoCompra   = 0;
     nDiferencia   = 0;
     nCoefi        = 0;
     nLinea        = 0;
     nContenido    = 0;
     nAnyo         = 0;
     nSwHay        = 0;
     nCampo1       = 0;
     nCampo2       = 0;
     nCampo3       = 0;
     nCampo4       = 0;
     nCampo5       = 0;
     nFallecido    = 0;
     nCanti1       = 0;
     nCanti2       = 0;
     nCanti3       = 0;
     nCanti4       = 0;
     nDia1         = 0;
     nDia2         = 0;
     nCoef         = 0;
     nCampo21      = 0;
     nCampo22      = 0;
     nCampo23      = 0;
     nCampo25      = 0;
     nCampo26      = 0;
     nCampo27      = 0;
     nCampo29      = 0;
     nCampo44      = 0;
     nCampo45      = 0;
     nCoefMej      = 0;

     nTodosDias    = 0;
     nParciDias    = 0;

     fFechaDT9     = @;
     fFechaTop     = @;

     fFechaAdq     = @;
     fFechaTra     = @;
     fFecha        = @;
     fFecha1       = @;
     fFecha2       = @;

     &enEmpresa    = 0;
     &enModo       = 0;
     &enModoReg    = 0;
     &eaDeclarante = "";
     &enComunes    = 0;
     &enChequeo    = 0;
     &enMinusvalia = 0;
     &eaMinuAyuda  = "";
     &eaFallece    = "";
     &eaSwVarios   = "";
     &eaVarDni     = "";
     &enCalcCif    = 0;
     &enSwLiquida  = 0;
     &enSwRetorno  = 0;
     &eaPrograma   = "";
     &eaPunto      = "";

     &eaLetra      = "";
     &eaDeDonde    = "";
     &eaLinDonde   = "";
     &eaAnyoUsu    = "";
     &eaPatr06     = "";
     &eaPatr07     = "";
     &eaPatr08     = "";
     &eaPatr09     = "";
     &eaPatr10     = "";
     &eaPatr11     = "";
     &eaPatr12     = "";
     &eaPatr13     = "";
     &eaPatr14     = "";
     &eaPatr15     = "";
     &eaPatr16     = "";
     &eaPatr17     = "";
     &eaPatr18     = "";
     &eaPatr19     = "";
     &eaPatr20     = "";
     &eaPatr21     = "";
     &eaPatr22     = "";
     &eaPatr23     = "";

     &eaExtr       = "";
     &enSwPresenta = 0
     &eaAzul       = "";
     &eaVerde      = "";
     &eaRojo       = "";
     &eaRosa       = "";
     &enBtnSalir   = 0;
     &enImporte    = 0;
     &enQuita      = 0;
     &enTotalDias  = 0;
     &enTotalDias1 = 0;
     &enTotalDias2 = 0;
     &enVtna621    = -1;
     &enNumCampos  = 0;
|FIN;

|| ---- PROCESOS DEL REW00603

|PROCESO FinVentana603;
     |SI nVentana603 ! -1;
         |FINVENTANA nVentana603;
         nVentana603 = -1;
     |FINSI;

     |PULSATECLA;
|FPRC;

|PROCESO Tipo12Fw603;  |TIPO 12;
     |HAZ FinVentana603;
|FPRC;

|PROCESO Tipo0Chequeo;  |TIPO 0;
     |SI #rew00603#Campo# = 0;  |ACABA;  |FINSI;

     fFecha = "31.12.2017";
     nFecha = (fFecha - #rew00603#25) / 365;

     |SI Campo = 95;  |O Campo = 99;
         |SI nFecha > 2;
             |MENAV "0000Esta vivienda tiene m s de 2 a¤os de antiguedad. Revisar importe.";
         |FINSI;
     |FINSI;

     |SI Campo = 96;  |O Campo = 100;
         |SI nFecha [ 2;
             |MENAV "0000Esta vivienda tiene menos de 2 a¤os de antiguedad. Revisar importe.";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo7Catalunya;  |TIPO 7;
     |VENTANA 2001, 3370, -1, 1, "";
     nVentana603 = FSalida;

     |CONTROL_SIMPLE 0, "LABEL,{{15}}INTRODUZCA 1 O 2 SEGUN PROCEDA", 2002, 2070, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}1.- R‚gimen general ", 2103, 2170, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}2.- R‚gimen especial", 2203, 2270, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{15}}Requisitos", 2402, 2470, NULL;

     aAlfa =  "LABEL,{{16}}- Tener 32 a¤os o menos en la fecha de devengo del ";
     aAlfa =  aAlfa + "impuesto, siempre y cuando su";
     |CONTROL_SIMPLE 0, aAlfa, 2503, 2570, NULL;

     aAlfa =  "LABEL,{{16}}   base imponible no sea superior a 30.000 Euros. ";
     |CONTROL_SIMPLE 0, aAlfa, 2603, 2670, NULL;

     aAlfa =  "LABEL,{{16}}- Haber estado en paro durante 183 dias o mas durante el ejercicio";
     |CONTROL_SIMPLE 0, aAlfa, 2703, 2770, NULL;

     aAlfa =  "LABEL,{{16}}- Tener un grado de discapacidad igual o superior 65%";
     |CONTROL_SIMPLE 0, aAlfa, 2803, 2870, NULL;

     aAlfa =  "LABEL,{{16}}- Formar parte de la unidad familiar con al menos un";
     aAlfa =  aAlfa + "hijo en la fecha de ";
     |CONTROL_SIMPLE 0, aAlfa, 2903, 2970, NULL;

     aAlfa =  "LABEL,{{16}}  devengo del impuesto.";
     |CONTROL_SIMPLE 0, aAlfa, 3003, 3070, NULL;

     |PTEC 802;  |PAUSA;
|FPRC;

|PROCESO Tipo0Catalunya;  |TIPO 0;
     |HAZ FinVentana603;
|FPRC;

|PROCESO BotonCalc603;
     |DDEFECTO #rew00005;

     |SI FSalida = nBotonCalc603_1; nCampo = 129;  |FINSI;
     |SI FSalida = nBotonCalc603_2; nCampo = 95;   |FINSI;
     |SI FSalida = nBotonCalc603_3; nCampo = 96;   |FINSI;
     |SI FSalida = nBotonCalc603_4; nCampo = 97;   |FINSI;
     |SI FSalida = nBotonCalc603_5; nCampo = 99;   |FINSI;
     |SI FSalida = nBotonCalc603_6; nCampo = 100;  |FINSI;
     |SI FSalida = nBotonCalc603_7; nCampo = 101;  |FINSI;
     |SI FSalida = nBotonCalc603_8; nCampo = 98;   |FINSI;

     #rew00005#1  = #rew00603#nCampo#;
     #rew00005#20 = #rew00603#nCampo#;

     |HAZ PantaREW00005;

     #rew00603#nCampo# = #rew00005#20;  |PINTA #rew00603#nCampo#;

     aAlfa = "|C" + (("000" + nCampo) % -103) + "WID";
     aID   = #rew00603#aAlfa#;
     nID   = aID;
     |FOCOTECLADO nID;
|FPRC;

|PROCESO EntraInversiones;
     |SI #rew00621#25 ] "01.01.2013";   || A partir de esta fecha ya no hay inversiones
         |MENAV "0000No procede inversi¢n. Solo para compras hasta el 2013";
         |ACABA;
     |FINSI;

     |SI #rew00621#30 = 0;  |Y #rew00621#33 = 0;  |Y eaExtr = "N";
         |MENAV "0000No procede inversi¢n, no hay d¡as en habitual";
         |ACABA;
     |FINSI;

     |ABRE #rew99999;
     |SELECT #2#rew99999;
     #rew99999#1 = #rew00621#2;
     |LEE 000#rew99999.=;
     |SI FSalida ! 0;  |DDEFECTO #rew99999;  |FINSI;
     |SELECT #1#rew99999;
     |CIERRA #rew99999;

     |C_M #rew00603#119, 1, "N";
     |C_M #rew00603#120, 1, "N";
     |C_M #rew00603#121, 1, "N";
     |C_M #rew00603#135, 1, "N";

     |SI #rew99999#7 = 13;
         |C_M #rew00603#119, 1, "S";
         |C_M #rew00603#135, 1, "S";
     |FINSI;

     |SI #rew99999#7 = 9;
         |SI #rew00621#2 ! "GANANCIAL ";
             |C_M #rew00603#120, 1, "S";
         |SINO;
             |C_M #rew00603#120, 1, "S";
             |C_M #rew00603#121, 1, "S";
         |FINSI;
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ enNumCampos;  |HACIENDO nCampo = nCampo + 1;
           #rew00603#nCampo# = #rew00621#nCampo#;
     |SIGUE;

     |SI #rew00621#25 = "01.01.0000";
         |MENAV "0000 No esta informada la fecha de adquisicion, no se calculara la deduccion adicional de la vivienda";
     |FINSI;

     |VENTANA 1701, 3599, -1, 1, "";
     enVtna621 = FSalida;

     |PINPA #0#rew00603;   nPanta603 = FSalida;

     |CONTROL_SIMPLE nPanta603, "BOTON,&1", 1958, 1959, BotonCalc603;
     nBotonCalc603_1 = FSalida;

     |CONTROL_SIMPLE nPanta603, "BOTON,&2", 2258, 2259, BotonCalc603;
     nBotonCalc603_2 = FSalida;

     |CONTROL_SIMPLE nPanta603, "BOTON,&3", 2358, 2359, BotonCalc603;
     nBotonCalc603_3 = FSalida;

     |CONTROL_SIMPLE nPanta603, "BOTON,&4", 2298, 2299, BotonCalc603;
     nBotonCalc603_4 = FSalida;

     |CONTROL_SIMPLE nPanta603, "BOTON,&5", 2658, 2659, BotonCalc603;
     nBotonCalc603_5 = FSalida;

     |CONTROL_SIMPLE nPanta603, "BOTON,&6", 2758, 2759, BotonCalc603;
     nBotonCalc603_6 = FSalida;

     |CONTROL_SIMPLE nPanta603, "BOTON,&7", 2698, 2699, BotonCalc603;
     nBotonCalc603_7 = FSalida;

     |CONTROL_SIMPLE nPanta603, "BOTON,&8", 3058, 3059, BotonCalc603;
     nBotonCalc603_8 = FSalida;

     |PINDA #0#rew00603;
     |ENDATOS #1#rew00603;
     |SI FSalida = 0;
         |PARA nCampo = 0;  |SI nCampo [ enNumCampos;  |HACIENDO nCampo = nCampo + 1;
               #rew00621#nCampo# = #rew00603#nCampo#;
         |SIGUE;
     |FINSI;

     |SI #rew99999#7 = 9;
         |SI #rew00621#2 ! "GANANCIAL ";
             |SI #rew00621#120 = " ";
                 |MENAV "0000 No ha informado del tipo de Regimen a Aplicar en las Deducciones de Vivienda.";
             |FINSI;
         |SINO;
             |SI #rew00621#120 = " ";  |O #rew00621#121 = " ";
                 |MENAV "0000 No ha informado del tipo de Regimen a Aplicar en las Deducciones de Vivienda.";
             |FINSI;
         |FINSI;
     |FINSI;

     |HAZ FinVentana621;

     |SI #rew00621#30 = 0;  |Y #rew00621#33 = 0;
         #rew00621#23 = 0;
     |SINO;
         #rew00621#23 = #rew00621#95 + #rew00621#96 + #rew00621#97 + #rew00621#98 + #rew00621#99 + #rew00621#100 + #rew00621#101;
     |FINSI;

     |PINTA #rew00621#23;
|FPRC;

|PROCESO PantaInversion;
     |SI #rem00021#23 = 0;  |ACABA;  |FINSI;

     |SI #rem00021#25 ] "01.01.2013";   || A partir de esta fecha ya no hay inversiones
         |MENAV "0000No procede inversi¢n. Solo para compras hasta el 2013";
         |ACABA;
     |FINSI;

     |SI #rem00021#30 = 0;  |Y #rem00021#33 = 0;  |Y eaExtr = "N";
         |MENAV "0000No procede inversi¢n, no hay d¡as en habitual";
         |ACABA;
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ enNumCampos;  |HACIENDO nCampo = nCampo + 1;
           #rew00603#nCampo# = #rem00021#nCampo#;
     |SIGUE;

     |VENTANA 1701, 3599, -1, 1, "";
     enVtna621 = FSalida;

     |PINPA #0#rew00603;   nPanta603 = FSalida;
     |PINDA #0#rew00603;

     |LEETECLA aTecla;

     |HAZ FinVentana621;
|FPRC;
