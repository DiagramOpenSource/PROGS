|FICHEROS;
    eosivacl #0;
    eosclien #1;
    eosconce #2;
    eoslinve #4;
    eosclpre #5;
    eosactiv #6;
    eoscolib #9;
    eosw0009 #10;
    eosw0010 #11;
|FIN;

|VARIABLES;
   anyo         = "";
   fichero1     = "";

   concepto     = 0;
   tipoiva     = "";
   recs         = 0;
   ivas         = 0;
   bases        = 0;
   tivas        = 0;
   trecs        = 0;
   trets        = 0;
   pp           = 0;

   activida     = 0;
   act          = 0;
   d_act        = 0;
   h_act        = 0;
   FEstado      = 0;
   varalf       = "";
   fec1         = @;
   fec2         = @;
   empresa      = "    NO EXISTE EMPRESA ";
   x            = 0;
   guion        = "-";
   espacio      = "                                                          ";
   espa         = " ";
   barra        = "\";
   linea1       = 0;
   linea2       = 0;
   cc           = 0;
   sw_rep       = 0;
   sw_inv       = 0;
   situa        = 0;
   c_para       = 0;
   c_parb       = 0;
   refer        = 0;
   c_inv        = 0;
   c_rep        = 0;
   r_rep1       = 0;
   r_rep2       = 0;
   r_inv1       = 0;
   r_inv2       = 0;
   pepe         = 0;
   sw_impre     = 0;
   longi        = 0;
   informe      = "";

   impre_valor  = "";
   asc1         = 0;
   asc2         = 0;
   asc3         = 0;
   asc4         = 0;
   asc5         = 0;
   asc6         = 0;
   asc7         = 0;
   asc8         = 0;
   asc9         = 0;
   asc10        = 0;
   asc11        = 0;
   asc12        = 0;
   asc13        = 0;
   asc14        = 0;
   asc15        = 0;
   asc16        = 0;
   asc17        = 0;
   asc18        = 0;
   asc19        = 0;
   asc20        = 0;
   co_asc       = 0;
   d_asc        = 0;
   h_asc        = 0;
   co_co        = 0;
   sw_result    = 0;

   &clopr       = "CLIENTE";
   &varilla     = "";
   &swtotal     = 0;
   &pepe1       = 0;
   &pepe2       = 0;
   &pepe3       = 0;
   &sw          = 0;
   &ray1        = "";
   &ray2        = "";
   &linea       = 0;
   &cabec1      = " ";
   &cabec2      = " ";
   &swlin       = 0;
   &varinf      = "";
   &tlinea      = 0;
   &vari        = "";
   &equival     = "";
   &equival1    = "";
   &ivainf      = 0;
   &equinf      = 0;
   &tbasivainf  = 0;
   &tbasequinf  = 0;
   &tivainf     = 0;
   &treqinf     = 0;
   &tbi         = 0;
   &tii         = 0;
   &tee         = 0;
   &totali      = 0;

   anyo1        = "";
   anyo2        = "";
   swimpre      = 0;
   xxxxfiac     = "  ";
   xxaponer     = "  ";
   xrelleno     = "                              ";

   {99}iva      = 0;
   {99}equi     = 0;
   {99}tbasiva  = 0;
   {99}tbasequi = 0;
   {99}timpiva  = 0;
   {99}timpreq  = 0;
|FIN;

|INCLUYE i_cambio;
|INCLUYE i_ficher;

|PROCESO clave;|TIPO 0;
|ABRE #1;
#1#0 = #0#0;
|LEE 040#1=;
|SI FSalida ! 0;
   |MENAV empresa;
   |ERROR;
|FINSI;
|CIERRA #1;
|FPRC;

|PROCESO activida; |TIPO 0;
|ABRE #6;
|SI #0#14 ! 0;
   activida = #0#14;
   #6#0 = #0#0;
   #6#1 = activida;
   #6#2 = #0#9;
   |LIBERA #6; |LEE 110#6=;
   |SI FSalida ! 0;
       |MENAV "     No existe Actividad.";
       |ERROR;
   |SINO;
       #0#6 = #6#21;
       |PINTA #0#6;
   |FINSI;
|SINO;
   activida = 0;
   act = 1;
   |ET leeotro;
      #6#0 = #0#0;
      #6#1 = act;
      #6#2 = #0#9;
      |LIBERA #6; |LEE 110#6=;
      |SI FSalida = 0;
          activida = #6#1;
          #0#6 = #6#21;
          |PINTA #0#6;
      |SINO;
         act = act + 1;
         |SI act [ 6; |VETE leeotro; |FINSI;
      |FINSI;
      |SI activida = 0;
          |MENAV "      No existe ninguna Actividad.";
          |ERROR;
      |FINSI;
|FINSI;
|CIERRA #6;
|FPRC;

|PROCESO anyo;|TIPO 0;
varalf = "01.01.19" + #0#9;
fec1 = varalf;
#0#1 = fec1;
varalf = "31.12.19" + #0#9;
fec2 = varalf;
#0#2 = fec2;
|PINTA #0#1;
|PINTA #0#2;
|FPRC;

|PROCESO fecha;|TIPO 0;
|SI #0#1 < fec1;|O #0#1 > fec2;
     |MENAV "     La fecha no coincide con el a¤o seleccionado.";
     |ERROR;
|FINSI;
|SI #0#2 < fec1;|O #0#2 > fec2;
     |MENAV "     La fecha no coincide con el a¤o seleccionado.";
     |ERROR;
|FINSI;
|SI #0#1 > #0#2;
     |MENAV "     La fecha desde es mayor que la fecha hasta.";
     |ERROR;
|FINSI;
|FPRC;

|PROCESO leeconce;
|ABRE #2;
#2#0 = concepto;
|LEE 040#2=;
|SI FSalida = 0;
    tipoiva = #2#2;
    |SI #2#2    ! "R"; |Y #2#2  ! "I"; tipoiva = ""; |FINSI;
    |SI tipoiva = "R"; |Y #0#13 = "I"; tipoiva = ""; |FINSI;
    |SI tipoiva = "I"; |Y #0#13 = "R"; tipoiva = ""; |FINSI;
|SINO;
    tipoiva = "";
|FINSI;
|CIERRA #2;
|FPRC;

|PROCESO lineasven;
sw_rep = 0;
sw_inv = 0;
concepto = #4#5; |HAZ leeconce;
|SI tipoiva = "I"; |O tipoiva = "R";
    situa = 1;
    bases = #4#7;
    ivas  = #4#8;
    tivas = #4#9;
    recs  = #4#10;
    trecs = #4#11;
    trets = #4#42;
    |HAZ filtro_fec;
|FINSI;

concepto = #4#33; |HAZ leeconce;
|SI tipoiva = "I"; |O tipoiva = "R";
    situa = 2;
    bases = #4#23;
    ivas  = #4#25;
    tivas = #4#27;
    recs  = #4#29;
    trecs = #4#31;
    trets = #4#43;
    |HAZ filtro_fec;
|FINSI;

concepto = #4#34; |HAZ leeconce;
|SI tipoiva = "I"; |O tipoiva = "R";
    situa = 3;
    bases = #4#24;
    ivas  = #4#26;
    tivas = #4#28;
    recs  = #4#30;
    trecs = #4#32;
    trets = #4#44;
    |HAZ filtro_fec;
|FINSI;
|FPRC;

|PROCESO filtro_fec;
|SI ivas = 0; |Y bases = 0; |ACABA; |FINSI;

|SI #0#10 = "T";
    |SI #4#17 < #0#11;
        |SI #9#8 = "P"; |ACABA; |FINSI;
        |SI tipoiva = "R";
            |SI sw_rep = 0;
                tipoiva = "A";
                c_para  = c_para + 1;
                refer   = c_para;
                sw_rep  = 1;
            |SINO;
                tipoiva = "A";
                refer  = c_para;
            |FINSI;
        |FINSI;

        |SI tipoiva = "I";
            |SI sw_inv = 0;
                tipoiva = "B";
                c_parb  = c_parb + 1;
                refer   = c_parb;
                sw_inv  = 1;
            |SINO;
                tipoiva = "B";
                refer  = c_parb;
            |FINSI;
        |FINSI;
        |HAZ graba_ind;
    |SINO;
        |SI tipoiva = "I";
            |SI sw_inv = 0;
                c_inv  = c_inv + 1;
                refer  = c_inv;
                sw_inv = 1;
            |SINO;
                refer  = c_inv;
            |FINSI;
        |FINSI;

        |SI tipoiva = "R";
            |SI sw_rep = 0;
                c_rep  = c_rep + 1;
                refer  = c_rep;
                sw_rep = 1;
            |SINO;
                refer  = c_rep;
            |FINSI;
        |FINSI;
        |HAZ graba_ind;
    |FINSI;
|SINO;
    |SI #4#13 < #0#1;
        |SI #9#8 = "P"; |ACABA; |FINSI;
        |SI tipoiva = "R";
            |SI sw_rep = 0;
                tipoiva = "A";
                c_para  = c_para + 1;
                refer  = c_para;
                sw_rep = 1;
            |SINO;
                tipoiva = "A";
                refer  = c_para;
            |FINSI;
        |FINSI;

        |SI tipoiva = "I";
            |SI sw_inv = 0;
                tipoiva = "B";
                c_parb  = c_parb + 1;
                refer   = c_parb;
                sw_inv  = 1;
            |SINO;
                tipoiva = "B";
                refer  = c_parb;
            |FINSI;
        |FINSI;
        |HAZ graba_ind;
    |SINO;
        |SI tipoiva = "I";
            |SI sw_inv = 0;
                c_inv  = c_inv + 1;
                refer  = c_inv;
                sw_inv = 1;
            |SINO;
                refer  = c_inv;
            |FINSI;
        |FINSI;

        |SI tipoiva = "R";
            |SI sw_rep = 0;
                c_rep  = c_rep + 1;
                refer  = c_rep;
                sw_rep = 1;
            |SINO;
                refer  = c_rep;
            |FINSI;
        |FINSI;
        |HAZ graba_ind;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO graba_ind;
#10#0 = refer;
#10#1 = tipoiva;
|LIBERA #10;
|LEE 140#10=;
|SI FSalida = 0;
    |SI situa = 1;
        #10#8  = concepto;
        #10#9  = #10#9 + bases;
        #10#10 = ivas;   #10#11 = #10#11 + tivas;
        #10#12 = recs;   #10#13 = #10#13 + trecs;
        #10#31 = rets;   #10#32 = #10#32 + trets;
        #10#14 = #10#9 + #10#11 + #10#13 - #10#32;
    |FINSI;

    |SI situa = 2;
        #10#15 = concepto;
        #10#16 = #10#16 + bases;
        #10#17 = ivas;
        #10#18 = #10#18 + tivas;
        #10#19 = recs;
        #10#20 = #10#20 + trecs;
        |SI #6#17 = "T";|O #6#17 = "t";
            #10#21 = #10#16 + #10#18 - #10#20;
        |SINO;
            #10#21 = #10#16 + #10#18 + #10#20;
        |FINSI;
    |FINSI;

    |SI situa  = 3;
        #10#22 = concepto;
        #10#23 = #10#23 + bases;
        #10#24 = ivas;
        #10#25 = #10#25 + tivas;
        #10#26 = recs;
        #10#27 = #10#27 + trecs;
        |SI #6#17 = "T";|O #6#17 = "t";
            #10#28 = #10#23 + #10#25 - #10#27;
        |SINO;
            #10#28 = #10#23 + #10#25 + #10#27;
        |FINSI;
    |FINSI;
    |GRABA 140#10a;
|SINO;
    |DDEFECTO #10;
    #10#0 = refer;
    #10#1 = tipoiva;

    r_rep2 = 0; r_inv2 = 0;
    |SI tipoiva = "R"; |O tipoiva = "A";
        |SI #9#10 = "A"; r_rep1 = r_rep1 + 1; |SINO; r_rep1 = #4#1; |FINSI;
        #10#2 = r_rep1;
        |SI #4#20 = "S";
            r_rep2 = (r_rep1 + #4#21) - 1;
            r_rep1 = r_rep2;
        |FINSI;
        #10#3 = r_rep2;
    |FINSI;

    |SI tipoiva = "I"; |O tipoiva = "B";
        |SI #9#10 = "A"; r_inv1 = r_inv1 + 1; |SINO; r_inv1 = #4#1; |FINSI;
        #10#2 = r_inv1;
        |SI #4#20 = "S";
            r_inv2 = (r_inv1 + #4#21) - 1;
            r_inv1 = r_inv2;
        |FINSI;
        #10#3 = r_inv2;
    |FINSI;

    #10#5 = #4#38;
    #10#6 = #4#12;
    |SI #4#3 = 0;
        |SI #4#38 = "                              ";
            #10#5 = "AL CONTADO";
            #10#6 = "";
        |FINSI;
    |FINSI;
    #10#4  = #4#13;
    #10#7  = #4#6;
    #10#29 = #4#15;
    #10#30 = #4#16;


    |SI situa = 1;
        #10#8  = concepto;
        #10#9  = bases;
        #10#10 = ivas;
        #10#11 = tivas;
        #10#12 = recs;
        #10#13 = trecs;
        |SI #6#17 = "T";|O #6#17 = "t";
            #10#14 = #10#9 + #10#11 - #10#13;
        |SINO;
            #10#14 = #10#9 + #10#11 + #10#13;
        |FINSI;
    |FINSI;

    |SI situa = 2;
        #10#15 = concepto;
        #10#16 = bases;
        #10#17 = ivas;
        #10#18 = tivas;
        #10#19 = recs;
        #10#20 = trecs;
        |SI #6#17 = "T";|O #6#17 = "t";
            #10#21 = #10#16 + #10#18 - #10#20;
        |SINO;
            #10#21 = #10#16 + #10#18 + #10#20;
        |FINSI;
    |FINSI;

    |SI situa  = 3;
        #10#22 = concepto;
        #10#23 = bases;
        #10#24 = ivas;
        #10#25 = tivas;
        #10#26 = recs;
        #10#27 = trecs;
        |SI #6#17 = "T";|O #6#17 = "t";
            #10#28 = #10#23 + #10#25 - #10#27;
        |SINO;
            #10#28 = #10#23 + #10#25 + #10#27;
        |FINSI;
    |FINSI;
    |GRABA 140#10n;
|FINSI;
|FPRC;

|DEFBUCLE eoslinve;
#4#1;
17, 13, 19;
#0#0, #0#9,  00001,     1, fec1, d_act;
#0#0, #0#9,  32000, #0#12, #0#2, h_act;
e;
NULL, lineasven;
|FIN;

|PROCESO parcial;
|SI #10#9 ! 0; |O #10#11 ! 0;
    bases = #10#9;
    ivas  = #10#10;
    tivas = #10#11;
    recs  = #10#12;
    trecs = #10#13;
    pepe  = 14;
    |HAZ importes;
|FINSI;

|SI #10#16 ! 0; |O #10#18 ! 0;
    bases = #10#16;
    ivas  = #10#17;
    tivas = #10#18;
    recs  = #10#19;
    trecs = #10#20;
    pepe  = 21;
    |HAZ importes;
|FINSI;

|SI #10#23 ! 0; |O #10#25 ! 0;
    bases = #10#23;
    ivas  = #10#24;
    tivas = #10#25;
    recs  = #10#26;
    trecs = #10#27;
    pepe  = 28;
    |HAZ importes;
|FINSI;
|FPRC;

|PROCESO imprime;
|DDEFECTO #11;
|SI sw_impre = 0; sw = 10; |PRINT; sw_impre = 1; |FINSI;

sw    = 0;
pepe1 = 0;
pepe2 = 0;
pepe3 = 0;

|SI #10#9 ! 0; |O #10#11 ! 0;
    bases = #10#9;
    ivas  = #10#10;
    tivas = #10#11;
    recs  = #10#12;
    trecs = #10#13;
    pepe  = 14;
    |HAZ importes;

    #11#0   = #10#2;
    #11#1   = #10#3;
    #11#2   = #10#4;
    #11#3   = #10#5;
    #11#4   = #10#6;
    #11#5   = #10#7;
    #11#6   = #10#8;
    #11#7   = #10#9;
    #11#8   = #10#10;
    #11#9   = #10#11;
    #11#10  = #10#12;
    #11#11  = #10#13;
    #11#12  = #10#14;
    #11#27  = #10#29;
    #11#28  = #10#30;
    pepe1 = 1;
|FINSI;

|SI #10#16 ! 0; |O #10#18 ! 0;
    bases = #10#16;
    ivas  = #10#17;
    tivas = #10#18;
    recs  = #10#19;
    trecs = #10#20;
    pepe  = 21;
    |HAZ importes;

    |SI pepe1 = 0;
        #11#0   = #10#2;
        #11#1   = #10#3;
        #11#2   = #10#4;
        #11#3   = #10#5;
        #11#4   = #10#6;
        #11#5   = #10#7;
        #11#6   = #10#15;
        #11#7   = #10#16;
        #11#8   = #10#17;
        #11#9   = #10#18;
        #11#10  = #10#19;
        #11#11  = #10#20;
        #11#12  = #10#21;
        #11#27  = #10#29;
        #11#28  = #10#30;
        pepe1 = 1;
    |SINO;
        #11#13  = #10#15;
        #11#14  = #10#16;
        #11#15  = #10#17;
        #11#16  = #10#18;
        #11#17  = #10#19;
        #11#18  = #10#20;
        #11#19  = #10#21;
        pepe2 = 1;
    |FINSI;
|FINSI;

|SI #10#23 ! 0; |O #10#25 ! 0;
    bases = #10#23;
    ivas  = #10#24;
    tivas = #10#25;
    recs  = #10#26;
    trecs = #10#27;
    pepe  = 28;
    |HAZ importes;

    |SI pepe1 = 0;
        #11#0   = #10#2;
        #11#1   = #10#3;
        #11#2   = #10#4;
        #11#3   = #10#5;
        #11#4   = #10#6;
        #11#5   = #10#7;
        #11#6   = #10#22;
        #11#7   = #10#23;
        #11#8   = #10#24;
        #11#9   = #10#25;
        #11#10  = #10#26;
        #11#11  = #10#27;
        #11#12  = #10#28;
        #11#27  = #10#29;
        #11#28  = #10#30;
        pepe1 = 1;
    |SINO;
        |SI pepe2 = 0;
            #11#13  = #10#22;
            #11#14  = #10#23;
            #11#15  = #10#24;
            #11#16  = #10#25;
            #11#17  = #10#26;
            #11#18  = #10#27;
            #11#19  = #10#28;
            pepe2 = 1;
        |SINO;
            #11#20  = #10#22;
            #11#21  = #10#23;
            #11#22  = #10#24;
            #11#23  = #10#25;
            #11#24  = #10#26;
            #11#25  = #10#27;
            #11#26  = #10#28;
            pepe3 = 1;
        |FINSI;
    |FINSI;
|FINSI;
|PRINT;

|SI pepe1 = 1; linea = linea + 1; |FINSI;
|SI pepe2 = 1; linea = linea + 1; |FINSI;
|SI pepe3 = 1; linea = linea + 1; |FINSI;
|SI swlin = 1; linea = linea + 1; |FINSI;

|SI #9#9 = "N";
    longi = #9#14 - 21;
    |SI linea ] longi;
        sw = 1;  vari = "SUMA Y SIGUE"; |PRINT;
        sw = 10; FSalida = "PAGINA";    |PRINT;
        sw = 0;
    |FINSI;
|SINO;
    longi = #9#14 - 21;
    |SI linea ] longi;
        sw = 1;  vari = "SUMA Y SIGUE"; |PRINT;
        sw = 10; FSalida = "PAGINA";    |PRINT;
        sw = 0;
    |FINSI;
|FINSI;
vari = "   TOTAL";
|FPRC;

|DEFBUCLE eosw0091;
#10#1;
;
00000, "A";
99999, "A";
e;
NULL, parcial;
|FIN;

|DEFBUCLE eosw00092;
#10#1;
;
00000, "R";
99999, "R";
e;
NULL, imprime;
|FIN;

|DEFBUCLE eosw00093;
#10#1;
;
00000, "B";
99999, "B";
e;
NULL, parcial;
|FIN;

|DEFBUCLE eosw00094;
#10#1;
;
00000, "I";
99999, "I";
e;
NULL, imprime;
|FIN;

||                        ******** COMIENZO ********

|PROCESO impre; |TIPO 3;
fichero  = #0#0;
fichero  = "00000" + fichero;
fichero  = fichero % -105;
anyo     = #0#9;
anyo     = "00" + anyo;
anyo     = anyo % -102;
fichero  = "v" + fichero + anyo;
fichero1 = fichero;
|NOME_DAT #4 fichero1;

comienza = "9";
|HAZ fichero;
fichero1 = fichero;
|NOME_DAT #10 fichero1;
|DELINDEX #10;

|IMPRE 0;
|SI FSalida ! 0; |ACABA; |FINSI;

|ABRE #9;
|LEE 040#9p;
|SI FSalida ! 0;
    |MENAV "     No existe control de libros.";
    |CIERRA #9;
    |ERROR;
    |ACABA;
|FINSI;
|CIERRA #9;

d_asc = 48; h_asc = 67; |HAZ carga_asc;

|SI #9#9 = "N"; swlin = 0; |SINO; swlin = 1; |FINSI;
informe = #9#12;

|SI #0#14 = 0;
    d_act = 1;
    h_act = 6;
|SINO;
    d_act = #0#14;
    h_act = #0#14;
|FINSI;

|ABRE #1;
#1#0 = #0#0;
|LEE 040#1=;
|SI FSalida ! 0; |DDEFECTO #1; |FINSI;
|CIERRA #1;

|ABRE #6;
#6#0 = #0#0;
#6#1 = activida;
#6#2 = #0#9;
|LIBERA #6; |LEE 110#6=;
FEstado = FSalida;

cabec1    = "";
equival   = "";
equival1  = "";

|SI #6#17 = "T";
    cabec1   = " RETENCION";
    equival  = "T. RETENCION";
    equival1 = "RETENCION";
|FINSI;

|SI #6#17 = "R";
    cabec1   = "   RECARGO";
    equival  = "T. RECARGO";
    equival1 = "RECARGO";
|FINSI;

|PUSHV  2023 2359;
|CUADRO 2023 2359;
|ATRI R;
|ATRI P;
|PINTA 2124, "PREPARANDO FICHERO ENLACE IMPRESION";
|PINTA 2224, "    Espere el tiempo necesario.    ";
|ATRI 0;

|ABRE #10;
|BUCLE eoslinve;
|CIERRA #10;

sw_impre = 0;
varilla  = #9#15;
|BUCLE eosw0091;
|INFOR informe;
|SI FSalida ! 0; |DELINDEX #10; |FINIMP; |ACABA; |FINSI;

|POPV;
|PUSHV  2123 2359;
|CUADRO 2123 2359;
|ATRI R;
|ATRI P;
|PINTA 2224, " IMPRIMIENDO LIBRO IVA REPERCUTIDO ";
|ATRI 0;

|BUCLE eosw00092;
|SI sw_impre = 1;
    sw_result = 1;
    varilla   = #9#19;
    |HAZ rayas;
|SINO;
    |SI #0#13 = "D"; |O #0#13 = "R";
        |SI #0#15 = "S";
            sw_result = 0;
            varilla   = #9#19;
            longi = #9#14 - 21;
            |HAZ rayas;
        |SINO;
            |FININF;
        |FINSI;
    |SINO;
        |FININF;
    |FINSI;
|FINSI;

|HAZ limpia;

sw_impre = 0;
varilla  = #9#17;

|BUCLE eosw00093;

|INFOR informe;
|SI FSalida ! 0; |DELINDEX #10; |FINIMP; |ACABA; |FINSI;

|POPV;
|PUSHV  2123 2359;
|CUADRO 2123 2359;
|ATRI R;
|ATRI P;
|PINTA 2224, " IMPRIMIENDO LIBRO IVA INVERSIONES ";
|ATRI 0;

|BUCLE eosw00094;
|SI sw_impre = 1;
    sw_result = 1;
    varilla   = #9#21;
    |HAZ rayas;
|SINO;
    |SI #0#13 = "D"; |O #0#13 = "I";
        |SI #0#15 = "S";
            sw_result = 0;
            varilla   = #9#21;
            longi = #9#14 - 21;
            |HAZ rayas;
        |SINO;
            |FININF;
        |FINSI;
    |SINO;
        |FININF;
    |FINSI;
|FINSI;
|HAZ limpia;

|POPV;

d_asc = 68; h_asc = 87; |HAZ carga_asc;
|FINIMP;
|DELINDEX #10;
|CIERRA #6;
|FPRC;

|PROCESO importes;         *********** ACUMULADOS *********
tbi       = tbi + bases;
tii       = tii + tivas;
tee       = tee + trecs;
trr       = trr + trets;
totali    = totali + #10pepe;

Iiva      = iva1 <-;
Iequi     = equi1 <-;
Itbasiva  = tbasiva1 <-;
Itbasequi = tbasequi1 <-;
Itimpiva  = timpiva1 <-;
Itimpreq  = timpreq1 <-;
Itimpret  = timpret1 <-;

Iiva      = Iiva     + ivas;
Itbasiva  = Itbasiva + ivas;
Itimpiva  = Itimpiva + ivas;

iva       = ivas;
tbasiva   = tbasiva + bases;
timpiva   = timpiva + tivas;

Iequi     = Iequi     + recs;
Itbasequi = Itbasequi + recs;
Itimpreq  = Itimpreq  + recs;
Itimpret  = Itimpret  + rets;

equi      = recs;
tbasequi  = tbasequi + bases;
timpreq   = timpreq  + trecs;
timpret   = timpret  + trets;
|FPRC;

|PROCESO result;        ******* CALCULO SEGUNDO INFORME DE ACUMULADOS IVA ****
|INFOR "eosivac2";
|SI FSalida ! 0; |ACABA; |FINSI;

Iiva      = iva1 <-;
Iequi     = equi1 <-;
Itbasiva  = tbasiva1 <-;
Itbasequi = tbasequi1 <-;
Itimpiva  = timpiva1 <-;
Itimpreq  = timpreq1 <-;

|PARA x = 0;|SI x < 99;|HACIENDO x = x + 1;
      sw = 0;
      |SI timpiva ! 0;
          ivainf     = iva;
          tbasivainf = tbasiva;
          tivainf    = timpiva;
          |PRINT;
      |FINSI;
      Iiva     = Iiva + 1;
      Itbasiva = Itbasiva + 1;
      Itimpiva = Itimpiva + 1;
|SIGUE;

sw = 2; |PRINT;

|PARA x = 0;|SI x < 99;|HACIENDO x = x + 1;
      sw = 1;
      |SI timpreq ! 0;
          equinf     = equi;
          tbasequinf = tbasequi;
          treqinf    = timpreq;
          |PRINT;
      |FINSI;
      Iequi     = Iequi + 1;
      Itbasequi = Itbasequi + 1;
      Itimpreq  = Itimpreq  + 1;
|SIGUE;

sw = 3; |PRINT;
|PIEINF;
|FININF;
|SI #9#26 = "S"; d_asc = 27; h_asc = 46; |HAZ carga_asc; |FINSI;
|FPRC;

|PROCESO limpia;           || ******* LIMPIA ACUMULADOS ************
tbi       = 0;
tii       = 0;
tee       = 0;
trr       = 0;
totali    = 0;

Iiva      = iva1 <-;
Iequi     = equi1 <-;
Itbasiva  = tbasiva1 <-;
Itimpiva  = timpiva1 <-;
Itbasequi = tbasequi1 <-;
Itimpreq  = timpreq1 <-;

|PARA x  = 0;|SI x < 99;|HACIENDO x = x + 1;
      iva      = 0;
      tbasiva  = 0;
      timpiva  = 0;
      Iiva     = Iiva + 1;
      Itbasiva = Itbasiva + 1;
      Itimpiva = Itimpiva + 1;
|SIGUE;

|PARA x = 0;|SI x < 99;|HACIENDO x = x + 1;
      equi      = 0;
      tbasequi  = 0;
      timpreq   = 0;
      Iequi     = Iequi + 1;
      Itbasequi = Itbasequi + 1;
      Itimpreq  = Itimpreq + 1;
|SIGUE;
|FPRC;

|PROCESO rayas;                      || ***** RAYAS FINALES ************
sw = 1; |PRINT;

cc      = longi - linea;
linea2  = linea;
linea   = 100 - cc;
ray1    = guion * linea;
sw      = 3; |PRINT;

sw = 2;
espacio = espa * linea;
linea1  = longi - linea2 - 4;
|PARA x = 0;|SI x < linea1;|HACIENDO x = x + 1;
      espacio = espacio + espa;
      ray2    = espacio + barra;
      |PRINT;
|SIGUE;
|PIEINF;
|FININF;

|SI #0#4 = "S";
    #6#21 = #0#5 - 1;
    |SI FEstado = 0; |GRABA 040#6a; |FINSI;
|FINSI;

|SI #9#26 = "S"; d_asc = 27; h_asc = 46; |HAZ carga_asc; |FINSI;

|SI sw_result = 1; |HAZ result; |FINSI;
|FPRC;

|PROCESO nomo1; |TIPO 7;
|SI #0#10 = "T";
     #0#1 = fec1;
     #0#2 = fec2;
     |PINTA #0#1;
     |PINTA #0#2;
     |HAZ nomodifi;
|FINSI;
|FPRC;

|PROCESO nomo2; |TIPO 7;
|SI #0#10 = "F";
    #0#11 = 1;
    #0#12 = 4;
    |PINTA #0#11;
    |PINTA #0#12;
    |HAZ nomodifi;
|FINSI;
|FPRC;

|PROCESO nomodifi;             || RUTINA DE CONVERSION A NO MODIFICABLES
                               || VARIABLES: A_
    xxaponer = Anono;
    xxxxfiac = Control % A1001;
    Control = Control + xxxxfiac;
    Control = Control + xrelleno;
    Control = Control % A120;
    Control = Control + xxaponer;
|FPRC;

|PROCESO &carga_asc;
asc1  = 0; asc2  = 0; asc3  = 0; asc4  = 0; asc5  = 0;
asc6  = 0; asc7  = 0; asc8  = 0; asc9  = 0; asc10 = 0;
asc11 = 0; asc12 = 0; asc13 = 0; asc14 = 0; asc15 = 0;
asc16 = 0; asc17 = 0; asc18 = 0; asc19 = 0; asc20 = 0;
co_co = 0;
|PARA co_asc = d_asc; |SI co_asc [ h_asc; |HACIENDO co_asc = co_asc + 1;
      co_co = co_co + 1;
      |SI #9co_asc ! 999;
          |SI co_co = 1;  asc1  = #9co_asc; |FINSI;
          |SI co_co = 2;  asc2  = #9co_asc; |FINSI;
          |SI co_co = 3;  asc3  = #9co_asc; |FINSI;
          |SI co_co = 4;  asc4  = #9co_asc; |FINSI;
          |SI co_co = 5;  asc5  = #9co_asc; |FINSI;
          |SI co_co = 6;  asc6  = #9co_asc; |FINSI;
          |SI co_co = 7;  asc7  = #9co_asc; |FINSI;
          |SI co_co = 8;  asc8  = #9co_asc; |FINSI;
          |SI co_co = 9;  asc9  = #9co_asc; |FINSI;
          |SI co_co = 10; asc10 = #9co_asc; |FINSI;
          |SI co_co = 11; asc11 = #9co_asc; |FINSI;
          |SI co_co = 12; asc12 = #9co_asc; |FINSI;
          |SI co_co = 13; asc13 = #9co_asc; |FINSI;
          |SI co_co = 14; asc14 = #9co_asc; |FINSI;
          |SI co_co = 15; asc15 = #9co_asc; |FINSI;
          |SI co_co = 16; asc16 = #9co_asc; |FINSI;
          |SI co_co = 17; asc17 = #9co_asc; |FINSI;
          |SI co_co = 18; asc18 = #9co_asc; |FINSI;
          |SI co_co = 19; asc19 = #9co_asc; |FINSI;
          |SI co_co = 20; asc20 = #9co_asc; |FINSI;
      |SINO;
          |SAL;
      |FINSI;
|SIGUE;

|SI asc1    = 0; |ACABA; |FINSI;

impre_valor =               &asc1  + &asc2  + &asc3  + &asc4  + &asc5;
impre_valor = impre_valor + &asc6  + &asc7  + &asc8  + &asc9  + &asc10;
impre_valor = impre_valor + &asc11 + &asc12 + &asc13 + &asc14 + &asc15;
impre_valor = impre_valor + &asc16 + &asc17 + &asc18 + &asc19 + &asc20;

|IMPRIME impre_valor;
|FPRC;
