|FICHEROS;
   eosem004 #0;
   eosma004 #1;
   eosclien #2;
   eoshacie #3;
   eoscomul #5;
   eosactiv #6;
|FIN;

|VARIABLES;
  Campos    = 0;
  Vacio20   = "                    ";
  LLeno40   = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
  Vacio40   = "                                        ";
  Empresa   = "";

  d         = "";
  h         = "";
  x         = 0;
  sw_sigue  = 0;
  sw_impre  = 0;
  d_cliente = 0;
  h_cliente = 0;

  &dia      = "";
  &mes      = "";
  &anyo     = "";

  &nifp     = "";
  &nombrep  = "";
  &nombrer  = "";
  &callep   = "";
  &nump     = "";
  &escp     = "";
  &pisop    = "";
  &puep     = "";
  &poblap   = "";
  &provip   = "";
  &codp     = "";
  &sgp      = "";
  &tlfnop   = "";
  &equi1    = "";
  &equi2    = "";
|FIN;

|INCLUYE i_consul;
|INCLUYE i_cuadre;
|INCLUYE i_anyode;

|PROCESO Mayus; |TIPO 0;
#0Campo = #0Campo > #0Campo;
|PINTA #0Campo;
|FPRC;

|PROCESO Parrilla; |TIPO 0;
|SI #0#7 = "S";
    |PARA Campos = 8; |SI Campos [ 31; |HACIENDO Campos = Campos + 1;
          |C_M #0Campos, 1, "N";  #0Campos = 0;  |PINTA #0Campos;
    |SIGUE;
    |C_M #0#0, 1, "S";   |C_M #0#1, 1, "S";  |C_M #0#34, 1, "S";
|SINO;
    |PARA Campos = 8; |SI Campos [ 31; |HACIENDO Campos = Campos + 1;
          |C_M #0Campos, 1, "S";
    |SIGUE;
    |C_M #0#0,  1, "N"; #0#0  = 1;     |PINTA #0#0;
    |C_M #0#1,  1, "N"; #0#1  = 99999; |PINTA #0#1;
    |C_M #0#34, 1, "N"; #0#34 = "C";  |PINTA #0#34;
|FINSI;
|FPRC;

|PROCESO pinta_anyo; |TIPO 7;
|HAZ i_anyodef;
#0#2 = i_anyodef;
|PINTA #0#2;
|FPRC;

|PROCESO impre_mod;
|SELECT #1#2;
#2#0 = #1#0;
|LEE 040#2=;
|SI FSalida ! 0; |DDEFECTO #2; |FINSI;

nifp = "";  nombrep = "";  callep = "";
nump = "";  escp    = "";  pisop  = "";
puep = "";  poblap  = "";  provip = "";
codp = "";  sgp     = "";  tlfnop = "";

#5#0 = #1#0;
#5#1 = #1#1;
#5#2 = 0;
#5#7 = #1#3;
|LEE 040#5];
|SI FSalida = 0; |Y #5#0 = #1#0; |Y #5#1 = #1#1; |Y #5#7 = #1#3;
    |SELECT #1#2;
    #2#0 = #5#3;
    |LEE 040#2=;
    |SI FSalida = 0;
        nifp = #2#1;  nombrep = #2#2;  callep = #2#5;
        nump = #2#6;  escp    = #2#7;  pisop  = #2#8;
        puep = #2#9;  poblap  = #2#13; provip = #2#12;
        codp = #2#21; sgp     = #2#4;  tlfnop = #2#14;
    |FINSI;
|FINSI;

|SELECT #1#2;
#2#0 = #1#0;
|LEE 040#2=;
|SI FSalida ! 0; |DDEFECTO #2; |FINSI;

nombrer = nombrep;
|SI nombrer = "";
    nombrer = #2#2;

    |SI #2#24 ! Vacio20; |O #2#25 ! Vacio20;
        nombrer = #2#24 + #2#25;
    |FINSI;

    |SI #2#29 ! Vacio20; |O #2#30 ! Vacio20;
        |SI nombrer = ""; nombrer = #2#29 + #2#30; |FINSI;
    |FINSI;

    |SI #2#34 ! Vacio20; |O #2#35 ! Vacio20;
        |SI nombrer = ""; nombrer = #2#34 + #2#35; |FINSI;
    |FINSI;
|FINSI;

#3#0 = #2#18;
#3#1 = #2#19;
|LEE 040#3=;
|SI FSalida ! 0; |DDEFECTO #3; |FINSI;

#6#0 = #1#0;
#6#1 = #1#1;
#6#2 = #1#3;
|LEE 040#6=;
|SI FSalida ! 0; |DDEFECTO #6; |FINSI;

equi1 = "";
equi2 = "";
|SI #6#22 = "C"; equi1 = "X"; |FINSI;
|SI #6#22 = "B"; equi2 = "X"; |FINSI;

|PRINT;
|PIEINF;

|SI #0#33 = "O";
    #1#4 = #0#6;
    #1#5 = "S";
    |GRABA 020#1a;
    |LIBERA #1;
|FINSI;
|FPRC;

|DEFBUCLE eosma004;
#1#1;
5;
d_cliente, #0#3, #0#32, #0#2, d;
h_cliente, #0#4, #0#32, #0#2, h;
be;
NULL, impre_mod;
|FIN;

|PROCESO AlModelo;
Empresa   = #2#2;
d_cliente = #2#0;
h_cliente = #2#0;

|BUCLE eosma004;

|SELECT #3#2;
#2#2 = Empresa;
|LEE 040#2=;
|FPRC;

|DEFBUCLE eosclienN;
#2#3;
0;
Vacio40, #0#0;
LLeno40, #0#1;
e;
NULL, AlModelo;
|FIN;

|PROCESO impre; |TIPO 3;
dia  = #0#6 % 102;
mes  = #0#6 % 402;
anyo = #0#6 % -102;
|HAZ mes;

|IMPRE 0;
|SI FSalida ! 0; |ACABA; |FINSI;

|SI #0#33 = "O";
    |HAZ i_cuadre;
    |INFOR "eosem004";
|SINO;
    |INFOR "eoseb004";
|FINSI;

|SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;

|ABRE #3;
|ABRE #5;
|ABRE #6;

|SI #0#5 = "N"; d = "N"; h = "N"; |FINSI;
|SI #0#5 = "S"; d = "N"; h = "S"; |FINSI;

|SI #0#34 = "N";
    |BUCLE eosclienN;
|SINO;
    |ABRE #2;
    |SI #0#7 = "S"
        d_cliente = #0#0;
        h_cliente = #0#1;
        |BUCLE eosma004
    |SINO;
        |PARA x = 8; |SI x [ 31; |HACIENDO x = x + 1;
              |SI #0x ! 0;
                  d_cliente = #0x;
                  h_cliente = #0x;
                  |BUCLE eosma004
              |FINSI;
        |SIGUE;
    |FINSI;
    |CIERRA #2;
|FINSI;

|FININF;
|FINIMP;
|CIERRA #3;
|CIERRA #5;
|CIERRA #6;
|FPRC;

|PROCESO mes;
|SI mes = "01"; mes = "Enero     "; |FINSI;
|SI mes = "02"; mes = "Febrero   "; |FINSI;
|SI mes = "03"; mes = "Marzo     "; |FINSI;
|SI mes = "04"; mes = "Abril     "; |FINSI;
|SI mes = "05"; mes = "Mayo      "; |FINSI;
|SI mes = "06"; mes = "Junio     "; |FINSI;
|SI mes = "07"; mes = "Julio     "; |FINSI;
|SI mes = "08"; mes = "Agosto    "; |FINSI;
|SI mes = "09"; mes = "Septiembre"; |FINSI;
|SI mes = "10"; mes = "Octubre   "; |FINSI;
|SI mes = "11"; mes = "Noviembre "; |FINSI;
|SI mes = "12"; mes = "Diciembre "; |FINSI;
|FPRC;
