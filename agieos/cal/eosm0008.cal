|FICHEROS;
     eosm0008 #0;
     eosconce #1;
     eosconc6 #2;
|FIN;

|VARIABLES;
     nPara1 = 0;
     nNume1 = 0;
     nNume2 = 0;
     aAlfa1 = "";
|FIN;

|PROGRAMA;
  |CLS;
  |CABEZA "Control Modelo 347";

  |PINPA #0#0;
  |ABRE #0;
  |DDEFECTO #0;
  |LEE 101#0p;
  |SI FSalida ! 0; |GRABA 020#0b; |FINSI;

  |PINDA #0#0;
  |ENDATOS #1#0;
  |SI FSalida = 0; |GRABA 020#0a; |FINSI;
  |LIBERA #0;
  |CIERRA #0;
|FPRO;


|PROCESO Concepto2; |TIPO 0;
    |SI FSalida = 2; |ACABA; |FINSI;

    aAlfa1 = "S";
    |SI #0Campo = 0; aAlfa1 = "N"; |FINSI;
    nNume1 = Campo + 1;
    |SI Campo ]   5; |Y Campo [  14; nNume2 =  14; |FINSI;
    |SI Campo ]  26; |Y Campo [  35; nNume2 =  35; |FINSI;
    |SI Campo ]  46; |Y Campo [  55; nNume2 =  55; |FINSI;
    |SI Campo ]  66; |Y Campo [  75; nNume2 =  75; |FINSI;
    |SI Campo ]  86; |Y Campo [  95; nNume2 =  95; |FINSI;
    |SI Campo ] 106; |Y Campo [ 115; nNume2 = 115; |FINSI;
    |SI Campo ] 126; |Y Campo [ 135; nNume2 = 135; |FINSI;
    |SI Campo ] 146; |Y Campo [ 149; nNume2 = 149; |FINSI;
    |SI Campo ] 154; |Y Campo [ 163; nNume2 = 163; |FINSI;
    |SI Campo ] 174; |Y Campo [ 183; nNume2 = 183; |FINSI;

    |PARA nPara1 = nNume1; |SI nPara1 [ nNume2; |HACIENDO nPara1 = nPara1 + 1;
          |C_M #0nPara1, 1, aAlfa1;
          |SI aAlfa1 = "N"; #0nPara1 = 0; |PINTA #0nPara1; |FINSI;
    |SIGUE;

    |SI #0Campo = 0; |ACABA; |FINSI;

     |ABRE #1;
     #1#0 = #0Campo;
     |LEE 040#1=;
     |SI FSalida ! 0;
         |MENAV "       No existe Concepto 2 Digitos.";
         |ERROR;
         |CIERRA #1;
         |ACABA;
     |FINSI;
     |CIERRA #1;


     |SI Campo ] 26; |Y Campo [ 35;
         |SI #1#3 = "G";
             |MENAV "       El Concepto no es de Venta.";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI Campo ] 46; |Y Campo [ 55;
          |SI #1#3 = "G";
              |MENAV "       El Concepto no es de Venta.";
              |ERROR;
              |ACABA;
          |FINSI;
     |FINSI;

     |SI Campo ] 86; |Y Campo [ 95;
         |SI #1#3 = "G";
             |MENAV "       El Concepto no es de Venta.";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI Campo ] 106; |Y Campo [ 115;
         |SI #1#3 = "G";
             |MENAV "       El Concepto no es de Venta.";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI Campo ] 5; |Y Campo [ 14;
         |SI #1#3 ! "G";
             |MENAV "       El Concepto no es de Gasto.";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI Campo ] 66; |Y Campo [ 75;
         |SI #1#3 ! "G";
             |MENAV "       El Concepto no es de Gasto.";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI Campo ] 126; |Y Campo [ 135;
         |SI #1#3 ! "G";
             |MENAV "       El Concepto no es de Gasto.";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Concepto6; |TIPO 0;
     |SI FSalida = 2; |ACABA; |FINSI;

     aAlfa1 = "S";
     |SI #0Campo = "      "; aAlfa1 = "N"; |FINSI;
     nNume1 = Campo + 1;
     |SI Campo ]  15; |Y Campo [  24; nNume2 =  24; |FINSI;
     |SI Campo ]  36; |Y Campo [  45; nNume2 =  45; |FINSI;
     |SI Campo ]  56; |Y Campo [  65; nNume2 =  65; |FINSI;
     |SI Campo ]  76; |Y Campo [  85; nNume2 =  85; |FINSI;
     |SI Campo ]  96; |Y Campo [ 105; nNume2 = 105; |FINSI;
     |SI Campo ] 116; |Y Campo [ 125; nNume2 = 125; |FINSI;
     |SI Campo ] 136; |Y Campo [ 145; nNume2 = 145; |FINSI;
     |SI Campo ] 150; |Y Campo [ 153; nNume2 = 153; |FINSI;
     |SI Campo ] 164; |Y Campo [ 173; nNume2 = 173; |FINSI;
     |SI Campo ] 184; |Y Campo [ 193; nNume2 = 193; |FINSI;

     |PARA nPara1 = nNume1; |SI nPara1 [ nNume2; |HACIENDO nPara1 = nPara1 + 1;
           |C_M #0nPara1, 1, aAlfa1;
           |SI aAlfa1 = "N"; #0nPara1 = ""; |PINTA #0nPara1; |FINSI;
     |SIGUE;

     |SI #0Campo = "      "; |ACABA; |FINSI;

     |ABRE #2;
     #2#0 = #0Campo;
     |LEE 040#2=;
     |SI FSalida ! 0;
         |MENAV "       No existe Concepto 6 Digitos.";
         |ERROR;
         |CIERRA #2;
         |ACABA;
     |FINSI;
     |CIERRA #2;

     |SI Campo ] 36; |Y Campo [ 45;
         |SI #2#3 = "G";
             |MENAV "       El Concepto no es de Venta.";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI Campo ] 56; |Y Campo [ 65;
         |SI #2#3 = "G";
             |MENAV "       El Concepto no es de Venta.";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI Campo ] 96; |Y Campo [ 105;
         |SI #2#3 = "G";
             |MENAV "       El Concepto no es de Venta.";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI Campo ] 116; |Y Campo [ 125;
         |SI #2#3 = "G";
             |MENAV "       El Concepto no es de Venta.";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI Campo ] 15; |Y Campo [ 24;
         |SI #2#3 ! "G";
             |MENAV "       El Concepto no es de Gasto.";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI Campo ] 76; |Y Campo [ 85;
         |SI #2#3 ! "G";
             |MENAV "       El Concepto no es de Gasto.";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI Campo ] 136; |Y Campo [ 145;
         |SI #2#3 ! "G";
             |MENAV "       El Concepto no es de Gasto.";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;
