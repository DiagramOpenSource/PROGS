|FICHEROS;
     eos349ca #0;
     eos349li #1;
     eosintra #2;
     eosw0052 #98,MANTE;
|FIN;

|VARIABLES;
    nOk    = 0;
    aAlfa1 = "";
|FIN;

|PROCESO Tipo0C12; |TIPO 0;
     |SI FSalida ! 10;
         |SI #1#12 ] 5;  |Y #1#12 [ 10;
             |MENAV "0000Periodo incorrecto.";
             |ERROR;
         |FINSI;

         |SI #1#12 ] 23;
             |MENAV "0000Periodo incorrecto.";
             |ERROR;
         |FINSI;

         |SI #1#12 = 0; |Y #1#11 ] 20;
             |MENAV "0000Periodo incorrecto.";
             |ERROR;
         |FINSI;
         |ACABA;
     |FINSI;

     |PUSHV 0501 2380;
     |BLANCO 0715 2147;
     |CUADRO 0715 2147;

     |PINTA 0816, "00.- Anual";
     |PINTA 0916, "                               ";
     |PINTA 1016, "01.- Primer  Trimestre         ";
     |PINTA 1116, "02.- Segundo Trimestre         ";
     |PINTA 1216, "03.- Tercero Trimestre         ";
     |PINTA 1316, "04.- Cuarto  Trimestre         ";
     |PINTA 1416, "                               ";
     |PINTA 1516, "11.- Enero      17.- Julio     ";
     |PINTA 1616, "12.- Febrero    18.- Agosto    ";
     |PINTA 1716, "13.- Marzo      19.- Septiembre";
     |PINTA 1816, "14.- Abril      20.- Octubre   ";
     |PINTA 1916, "15.- Mayo       21.- Noviembre ";
     |PINTA 2016, "16.- Junio      22.- Diciembre ";

     |PAUSA;
     |POPV;

     |ERROR;
|FPRC;

|PROCESO Tipo0C4; |TIPO 0;
     |SI FSalida = 10;
         |PUSHV 0501 2380;
         |SI #1#2 ] 20;
             |BLANCO 0808 1879;
             |CUADRO 0808 1879;

             |PINTA 0909, " A- Adquisiciones                              X- Rectificaciones (A) ";
             |PINTA 1009, " E- Entregas                                   U- Rectificaciones (E) ";
             |PINTA 1109, " S- Prestaciones                               Z- Rectificaciones (S) ";
             |PINTA 1209, " I- Adquisiciones en territorio impuesto       Y- Rectificaciones (I) ";
             |PINTA 1309, " M- Entregas post. importacion exenta          W- Rectificaciones (M) ";
             |PINTA 1409, " H- Entregas post.im.exenta con representante  V- Rectificaciones (H) ";
             |PINTA 1509, " R- Transferencias de bienes de consigna       T- Rectificaciones (R) ";
             |PINTA 1609, " D- Devoluciones de bienes de consigna         Q- Rectificaciones (D) ";
             |PINTA 1709, " C- Sustitucion destinatario bienes consigna   P- Rectificaciones (C) ";
             |ATRI I;
             |PINTA 0910, "A"; |PINTA 0956, "X";
             |PINTA 1010, "E"; |PINTA 1056, "U";
             |PINTA 1110, "S"; |PINTA 1156, "Z";
             |PINTA 1210, "I"; |PINTA 1256, "Y";
             |PINTA 1310, "M"; |PINTA 1356, "W";
             |PINTA 1410, "H"; |PINTA 1456, "V";
             |PINTA 1510, "R"; |PINTA 1556, "T";
             |PINTA 1610, "D"; |PINTA 1656, "Q";
             |PINTA 1710, "C"; |PINTA 1756, "P";
             |ATRI 0;
         |SINO;
             |BLANCO 0710 2075;
             |CUADRO 0710 2075;

             |PINTA 0811, "A.- Adquisiciones";
             |PINTA 0911, "X.- Rectificaciones adquisiciones";
             |PINTA 1011, "E.- Entregas";
             |PINTA 1111, "R.- Rectificaciones entregas";
             |PINTA 1211, "S.- Prestaciones";
             |PINTA 1311, "Z.- Rectificaciones Prestaciones";
             |PINTA 1411, "I.- Adquisiciones en el territorio del impuesto";
             |PINTA 1511, "Y.- Rectificaciones adquisiciones en el territorio del impuesto";
             |PINTA 1611, "M.- Entregas posteriores a importacion exenta";
             |PINTA 1711, "W.- Rectificaciones entregas posteriores a importacion exenta  ";
             |PINTA 1811, "H.- Entregas posteriores importacion exenta con representante  ";
             |PINTA 1911, "V.- Rectificaciones ent.posteriores importacion exenta con rep.";
         |FINSI;
         |PAUSA;
         |POPV;

         |ERROR;
         |ACABA;
     |FINSI;

     nOk = 0;
     |SI #1#2 ] 20;
         |SI #1#4 ! "A";  |Y #1#4 ! "X";
          |Y #1#4 ! "E";  |Y #1#4 ! "U";
          |Y #1#4 ! "S";  |Y #1#4 ! "Z";
          |Y #1#4 ! "I";  |Y #1#4 ! "Y";
          |Y #1#4 ! "M";  |Y #1#4 ! "W";
          |Y #1#4 ! "H";  |Y #1#4 ! "V";
          |Y #1#4 ! "R";  |Y #1#4 ! "T";
          |Y #1#4 ! "D";  |Y #1#4 ! "Q";
          |Y #1#4 ! "C";  |Y #1#4 ! "P";
             nOk = 1;
         |FINSI;
     |SINO;
         |SI #1#4 ! "A";  |Y #1#4 ! "X";
          |Y #1#4 ! "E";  |Y #1#4 ! "R";
          |Y #1#4 ! "S";  |Y #1#4 ! "Z";
          |Y #1#4 ! "I";  |Y #1#4 ! "Y";
          |Y #1#4 ! "M";  |Y #1#4 ! "W";
          |Y #1#4 ! "H";  |Y #1#4 ! "V";
             nOk = 1;
         |FINSI;
     |FINSI;

     |SI nOk = 1;
         |MENAV "0000Tipo erroneo. Pulse F2 para ver la ayuda.";
         |ERROR;
         |ACABA;
     |FINSI;

     |C_M #1#9,  1, "S";
     |C_M #1#10, 1, "S";
     |C_M #1#11, 1, "S";
     |C_M #1#12, 1, "S";
     |C_M #1#13, 1, "S";
     |C_M #1#28, 1, "S";

     nOk = 0;
     |SI #1#2 ] 20;
        |SI #1#4 = "E"; |O #1#4 = "M"; |O #1#4 = "H";
          |O #1#4 = "R"; |O #1#4 = "D"; |O #1#4 = "C";
             nOk = 1;
        |FINSI;
     |SINO;
        |SI #1#4 = "E"; |O #1#4 = "M"; |O #1#4 = "H";
            nOk = 1;
        |FINSI;
     |FINSI;
     |SI nOk = 1;
         |C_M #1#10, 1, "N";
         |C_M #1#11, 1, "N";
         |C_M #1#12, 1, "N";
         |C_M #1#28, 1, "N";

         #1#10 = "";
         #1#11 = 0;
         #1#12 = 0;
         #1#28 = 0;
     |FINSI;

     |SI #1#4 = "S";
         |C_M #1#10, 1, "N";
         |C_M #1#11, 1, "N";
         |C_M #1#12, 1, "N";
         |C_M #1#13, 1, "N";
         |C_M #1#28, 1, "N";

         #1#10 = "";
         #1#11 = 0;
         #1#12 = 0;
         #1#13 = "";
         #1#28 = 0;
     |FINSI;

     |SI #1#4 = "A";  |O #1#4 = "I";
         |C_M #1#10, 1, "N";
         |C_M #1#11, 1, "N";
         |C_M #1#12, 1, "N";
         |C_M #1#13, 1, "N";
         |C_M #1#28, 1, "N";

         #1#10 = "";
         #1#11 = 0;
         #1#12 = 0;
         #1#13 = "";
         #1#28 = 0;
     |FINSI;

     nOk = 0;
     |SI #1#2 ] 20;
         |SI #1#4 = "U";  |O #1#4 = "Y";  |O #1#4 = "Z";
             nOk = 1;
         |FINSI;
     |SINO;
         |SI #1#4 = "X";  |O #1#4 = "Y";  |O #1#4 = "Z";
             nOk = 1;
         |FINSI;
     |FINSI;
     |SI nOk = 1;
         |C_M #1#13, 1, "N";
         #1#13 = "";
     |FINSI;

     |PINTA #1#9;
     |PINTA #1#10;
     |PINTA #1#11;
     |PINTA #1#12;
     |PINTA #1#13;
     |PINTA #1#28;
|FPRC;

|PROCESO cabecera; |TIPO 2;
     nOk = 0;
     |SI #1#2 ] 20;
         |SI #1#4 = "E";  |O #1#4 = "S"; |O #1#4 = "M"; |O #1#4 = "H";
           |O #1#4 = "R";  |O #1#4 = "D"; |O #1#4 = "C";
             nOk = 1;
         |FINSI;
     |SINO;
         |SI #1#4 = "E";  |O #1#4 = "S"; |O #1#4 = "M"; |O #1#4 = "H";
             nOk = 1;
         |FINSI;
     |FINSI;
     |SI nOk = 1;
         #0#6 = #0#6 +. 1;
         #0#7 = #0#7 +. #1#8;
     |FINSI;

     |SI #1#4 = "A";  |O #1#4 = "I";
         #0#8 = #0#8 +. 1;
         #0#9 = #0#9 +. #1#8;
     |FINSI;

     nOk = 0;
     |SI #1#2 ] 20;
         |SI #1#4 = "U";  |O #1#4 = "Z"; |O #1#4 = "W";  |O #1#4 = "V";
            |O #1#4 = "T";  |O #1#4 = "Q"; |O #1#4 = "P";
             nOk = 1;
         |FINSI;
     |SINO;
         |SI #1#4 = "R";  |O #1#4 = "Z"; |O #1#4 = "W";  |O #1#4 = "V";
             nOk = 1;
         |FINSI;
     |FINSI;
     |SI nOk = 1;
         #0#10 = #0#10 +. 1;
         #0#14 = #0#14 +. #1#8;
     |FINSI;

     |SI #1#4 = "X";  |O #1#4 = "Y";
         #0#11 = #0#11 +. 1;
         #0#15 = #0#15 +. #1#8;
     |FINSI;

     |PINTA #0#6;
     |PINTA #0#7;
     |PINTA #0#8;
     |PINTA #0#9;
     |PINTA #0#10;
     |PINTA #0#11;
     |PINTA #0#14;
     |PINTA #0#15;
|FPRC;

|PROCESO intracom; |TIPO 3;
     |ABRE #2;
     |SELECT #1#2;
     #2#0 = #1#5;
     #2#1 = #1#6;
     |LEE 101#2=;
     |SI FSalida ! 0;
         #2#0 = #1#5;
         #2#1 = #1#6;
         #2#2 = #1#7;
         |GRABA 020#2n;
     |FINSI;
     |LIBERA #2;
     |SI #1#4 = "C"; |Y #1#2 ] 20;
         #2#0 = #1#29;
         #2#1 = #1#30;
         |LEE 101#2=;
         |SI FSalida ! 0;
             #2#0 = #1#29;
             #2#1 = #1#30;
             #2#2 = #1#31;
             |GRABA 020#2n;
         |FINSI;
         |LIBERA #2;
     |SINO;
         #1#29 = "";
         #1#30 = "";
         #1#31 = "";
     |FINSI;

     |CIERRA #2;
|FPRC;

|PROCESO filtro; |TIPO 0;
     |C_M #1Campo,0,aAlfa1;
     |SI aAlfa1 = "N"; |ACABA; |FINSI;

     |SI #1Campo = "DE";  |ACABA;  |FINSI;
     |SI #1Campo = "AT";  |ACABA;  |FINSI;
     |SI #1Campo = "BE";  |ACABA;  |FINSI;
     |SI #1Campo = "BG";  |ACABA;  |FINSI;
     |SI #1Campo = "CY";  |ACABA;  |FINSI;
     |SI #1Campo = "DK";  |ACABA;  |FINSI;
     |SI #1Campo = "SI";  |ACABA;  |FINSI;
     |SI #1Campo = "EE";  |ACABA;  |FINSI;
     |SI #1Campo = "FI";  |ACABA;  |FINSI;
     |SI #1Campo = "FR";  |ACABA;  |FINSI;
     |SI #1Campo = "EL";  |ACABA;  |FINSI;
     |SI #1Campo = "GB";  |ACABA;  |FINSI;
     |SI #1Campo = "NL";  |ACABA;  |FINSI;
     |SI #1Campo = "HU";  |ACABA;  |FINSI;
     |SI #1Campo = "IT";  |ACABA;  |FINSI;
     |SI #1Campo = "IE";  |ACABA;  |FINSI;
     |SI #1Campo = "LV";  |ACABA;  |FINSI;
     |SI #1Campo = "LT";  |ACABA;  |FINSI;
     |SI #1Campo = "LU";  |ACABA;  |FINSI;
     |SI #1Campo = "MT";  |ACABA;  |FINSI;
     |SI #1Campo = "PL";  |ACABA;  |FINSI;
     |SI #1Campo = "PT";  |ACABA;  |FINSI;
     |SI #1Campo = "CZ";  |ACABA;  |FINSI;
     |SI #1Campo = "SK";  |ACABA;  |FINSI;
     |SI #1Campo = "RO";  |ACABA;  |FINSI;
     |SI #1Campo = "SE";  |ACABA;  |FINSI;
     |SI #1Campo = "HR";  |ACABA;  |FINSI;

     |MENAV "     Codigo de Pais incorrecto. ";
     |ERROR;
|FPRC;

|PROCESO PideBase;  |TIPO 7;
     |SI #1#4 = "E";  |ACABA;  |FINSI;
     |SI #1#4 = "R";  |ACABA;  |FINSI;
     |SI #1#4 = "S";  |ACABA;  |FINSI;
     |SI #1#4 = "Z";  |ACABA;  |FINSI;
     |SI #1#4 = "M";  |ACABA;  |FINSI;
     |SI #1#4 = "W";  |ACABA;  |FINSI;
     |SI #1#4 = "H";  |ACABA;  |FINSI;
     |SI #1#4 = "V";  |ACABA;  |FINSI;
     |SI #1#4 = "U";  |ACABA;  |FINSI;
     |SI #1#4 = "T";  |ACABA;  |FINSI;
     |SI #1#4 = "D";  |ACABA;  |FINSI;
     |SI #1#4 = "Q";  |ACABA;  |FINSI;
     |SI #1#4 = "C";  |ACABA;  |FINSI;
     |SI #1#4 = "P";  |ACABA;  |FINSI;

     |PUSHV 0501 2380;

                      #98#0  = "ADQUISICIONES";
     |SI #1#4 = "X";  #98#0  = "RECTIFICACIONES";  |FINSI;
     |SI #1#4 = "Y";  #98#0  = "RECTIFICACIONES";  |FINSI;

     #98#1  = "";
     #98#2  = "";
     #98#3  = "";
     #98#4  = #1#16;
     #98#5  = #1#17;
     #98#6  = #1#18;
     #98#7  = #1#19;
     #98#8  = #1#20;
     #98#9  = #1#21;
     #98#10 = #1#22;
     #98#11 = #1#23;
     #98#12 = #1#24;
     #98#13 = #1#25;
     #98#14 = #1#26;
     #98#15 = #1#27;

     |PINPA #0#98;
     |PINDA #0#98;
     |ENDATOS #1#98;
     |SI FSalida = 0;
         #1#16 = #98#4;
         #1#17 = #98#5;
         #1#18 = #98#6;
         #1#19 = #98#7;
         #1#20 = #98#8;
         #1#21 = #98#9;
         #1#22 = #98#10;
         #1#23 = #98#11;
         #1#24 = #98#12;
         #1#25 = #98#13;
         #1#26 = #98#14;
         #1#27 = #98#15;
     |FINSI;
     |POPV;

     #1#8 = #1#16 + #1#19 + #1#22 + #1#25;  |PINTA #1#8;
|FPRC;

|PROCESO OtrosDatos;

     |SI #1#4 ! "C"; |Y #1#4 ! "P";
         |ACABA;
     |FINSI;

     |PUSHV 0919 1275;
     |BLANCO 0919 1275;
     |CUADRO 0919 1275;

     |ATRI R;
     |PINTA 1020, "NIF         Pais Nombre Destinatario sustituto         ";
     |ATRI 0;

     |C_V #1#29, 1, "S"; |C_M #1#29, 1, "S";
     |C_V #1#30, 1, "S"; |C_M #1#30, 1, "S";
     |C_V #1#31, 1, "S"; |C_M #1#31, 1, "S";
     |PINTA #1#29;
     |PINTA #1#30;
     |PINTA #1#31;

|ET Campo29;
     |ENCAMPO #29#1;
     |SI FSalida = 7; |VETE FinTC; |FINSI;

|ET Campo30;
     |ENCAMPO #30#1;
     |SI FSalida = 2; |VETE Campo29; |FINSI;
     |SI FSalida = 7; |VETE FinTC; |FINSI;

     |ENCAMPO #31#1;
     |SI FSalida = 2; |VETE Campo30; |FINSI;

|ET FinTC;
     |C_V #1#29, 1, "N"; |C_M #1#29, 1, "N";
     |C_V #1#30, 1, "N"; |C_M #1#30, 1, "N";
     |C_V #1#31, 1, "N"; |C_M #1#31, 1, "N";
     |POPV;
|FPRC;


|PROCESO Tipo5; |TIPO 5;
     FSalida = "SINBARRA";
     |C_V #1#29,1, "N";
     |C_V #1#30,1, "N";
|FPRC;
