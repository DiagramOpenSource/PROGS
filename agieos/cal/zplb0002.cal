|FICHEROS;
     eosaplic #96;
     eosm0016 #44;
|FIN;

|VARIABLES;
  nCanal       = 0;
  aPath        = "";
  aAlfa1       = "";
  aAlfa2       = "";
  aAlfa3       = "";
  aFichero     = "";
  aLeeTodo     = "";
  nLeeSalida   = 0;
  nLeeUno      = 0;
  nLeeCuantos  = 0;
  nLeeNume     = 0;
  aLeeAlfa     = "";
  nNume1       = 0;
  nNume2       = 0;
  sw           = 0;
  atemporal1   = "";
  atemporal2   = "";
|FIN;

|PROCESO MiroEosm0016;

    |ABRE #96;
    |LEE 141#96p;
    |SI FSalida ! 0;
        |DDEFECTO #96;
        |GRABA 020#96b;
    |FINSI;
    |SI #96#17 = "S";
        |LIBERA #96;
        |CIERRA #96;
        |ACABA;
    |FINSI;
    #96#17 = "S";
    |GRABA 020#96a;
    |LIBERA #96;
    |CIERRA #96;

    |DFICB aPath;

    aFichero = aPath + "eosm0016.ddx";
    |XABRE "UB", aFichero, nCanal;
    |SI FSalida < 0;
        |XABRE "CUB", aFichero, nCanal;
    |FINSI;
    |SI FSalida ] 0;
        nLeeCuantos = 255;  |HAZ LeeUnoaUno
        |XCIERRA nCanal;
    |FINSI;
    Pos = -1;

    |QBT aLeeTodo;

    aAlfa1 = aLeeTodo % 0;
    nNume1 = aAlfa1;
    nNume2 = 0;
    aAlfa1 = "";
    sw     = 0;
    |PARA nLeeUno = 1; |SI nLeeUno [ nNume1; |HACIENDO nLeeUno = nLeeUno + 1;
          aAlfa2 = nLeeUno;
          aAlfa2 = aAlfa2 + "01";
          aAlfa3 = aLeeTodo % aAlfa2;
          |SI sw = 1; |Y aAlfa3 = "[";
              sw = 0;
          |FINSI;
          |SI sw = 1;
              nNume2 = nNume2 + 1;
              aAlfa1 = aAlfa1 + aAlfa3;
          |SINO;
              |SI aAlfa3 = "]"; sw = 1; |FINSI;
          |FINSI;
    |SIGUE;
    |SI nNume2 > 120;
        atemporal1 = aPath + "eosm0016.dat";
        atemporal2 = aPath + "eosmxx16.seg";
        |COPIA_FICHERO atemporal1,atemporal2;
        |DELINDEX #44;
    |FINSI;
|FPRC;

|PROCESO LeeUnoaUno;
     aLeeTodo = "";
     nLeeSalida = 0;
     |PARA nLeeUno = 1; |SI nLeeUno [ nLeeCuantos; |HACIENDO nLeeUno = nLeeUno + 1;
          |XLEE nCanal, 1, aLeeAlfa;
          |SI FSalida = 1;
               nLeeNume = &aLeeAlfa;
               |SI nLeeNume < 32;
                    aLeeTodo = aLeeTodo + " ";
               |SINO;
                    aLeeTodo = aLeeTodo + aLeeAlfa;
               |FINSI;
               nLeeSalida = nLeeSalida + 1;
          |SINO;
               |SAL;
          |FINSI;
     |SIGUE;
|FPRC;
