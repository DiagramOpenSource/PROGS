|FICHEROS;
     agrm0007  #7;                 || Este Def
     agrm0008  #8;                 || Explotaciones
     agrm0009  #9;                 || Terrenos
     agrm0010  #10;                || Ganados
     agrm0011  #11;                || Maquinarias
     agrm0012  #12;                || Instalaciones
     agrm0013  #13;                || Libro de Ingresos
     agrm0014  #14;                || Libro de Gastos
|FIN;

|VARIABLES;
     &Modo      = 0;
     &VEmpresa  = 0;
     &VAnyo     = 0;
     &VPEstima  = "";
     &VVTerreno = 0;
     &VVInstala = 0;
     &VVMaquina = 0;
     &VVGanados = 0;
     &VBas      = 0;
     &VIva      = 0;
     &VRec      = 0;
     &VRet      = 0;
     &VFac      = 0;
     &CBas      = 0;
     &CIva      = 0;
     &CRec      = 0;
     &CRet      = 0;
     &CFac      = 0;

     Opcion     = 0;
     Salir      = 0;
     Opcion1    = 0;
     Salir1     = 0;
     VAlfa      = "";
     Fichero    = "";

{-1} MGeneral   = "";
     MGeneral1  = "1448";
     MGeneral2  = "1";
     MGeneral3  = "7";
     MGeneral4  = "Datos Estimaci¢n Directa ";
     MGeneral5  = "Terrenos                 ";
     MGeneral6  = "Ganados                  ";
     MGeneral7  = "Maquinaria               ";
     MGeneral8  = "Instalaciones            ";
     MGeneral9  = "Libro de Ingresos        ";
     MGeneral10 = "Libro de Gastos          ";

{-1} MEstDire   = "";
     MEstDire1  = "1251";
     MEstDire2  = "1";
     MEstDire3  = "20";
     MEstDire4  = "Explotaciones           ";
     MEstDire5  = "Deudores                ";
     MEstDire6  = "Proveedores             ";
     MEstDire7  = "Otros Acreedores        ";
     MEstDire8  = "Cosechas Pendientes     ";
     MEstDire9  = "Almacen de Productos    ";
     MEstDire10 = "Almacen Materias Primas ";
     MEstDire11 = "Prestamos y Deudas      ";
     MEstDire12 = "Cajas y Bancos          ";
     MEstDire13 = "Capital                 ";
     MEstDire14 = "Reservas                ";
     MEstDire15 = "Diario                  ";
     MEstDire16 = "Anotaciones Campa¤a     ";
     MEstDire17 = "                        ";
     MEstDire18 = "                        ";
     MEstDire19 = "                        ";
     MEstDire20 = "                        ";
     MEstDire21 = "                        ";
     MEstDire22 = "                        ";
     MEstDire23 = "                        ";
|FIN;

|PROCESO Borra08;
|BORRA 140#8a;
|LIBERA #8;
|FPRC;

|DEFBUCLE agrm0008B;
#8#1;
;
#7#0, #7#1, "            ";
#7#0, #7#1, "zzzzzzzzzzzz";
be;
NULL, Borra08;
|FIN;

|PROCESO Borra09;
|BORRA 140#9a;
|LIBERA #9;
|FPRC;

|DEFBUCLE agrm0009B;
#9#1;
;
#7#0, #7#1, 001;
#7#0, #7#1, 999;
be;
NULL, Borra09;
|FIN;

|PROCESO Borra10;
|BORRA 140#10a;
|LIBERA #10;
|FPRC;

|DEFBUCLE agrm0010B;
#10#1;
;
#7#0, #7#1, 001;
#7#0, #7#1, 999;
be;
NULL, Borra10;
|FIN;

|PROCESO Borra11;
|BORRA 140#11a;
|LIBERA #11;
|FPRC;

|DEFBUCLE agrm0011B;
#11#1;
;
#7#0, #7#1, 001;
#7#0, #7#1, 999;
be;
NULL, Borra11;
|FIN;

|PROCESO Borra12;
|BORRA 140#12a;
|LIBERA #12;
|FPRC;

|DEFBUCLE agrm0012B;
#12#1;
;
#7#0, #7#1, 001;
#7#0, #7#1, 999;
be;
NULL, Borra12;
|FIN;

|PROCESO Tipo2; |TIPO 2;
Modo = (FEntrada / 100) ! 0;
|SI Modo ! 3; |ACABA; |FINSI;

|MENSA "0401 Borrando Ficheros Relacionados";

|BUCLE agrm0008B;
|BUCLE agrm0009B;
|BUCLE agrm0010B;
|BUCLE agrm0011B;
|BUCLE agrm0012B;

VAlfa   = #7#0;
VAlfa   = ("00000" + VAlfa) % -105;
Fichero = VAlfa;
VAlfa   = #7#1;
VAlfa   = ("00" + VAlfa) % -102;
Fichero = "z" + Fichero + VAlfa;
|NOME_DAT #13 Fichero;
|ABRE #13; |CIERRA #13; |DELINDEX #13;

VAlfa   = #7#0;
VAlfa   = ("00000" + VAlfa) % -105;
Fichero = VAlfa;
VAlfa   = #7#1;
VAlfa   = ("00" + VAlfa) % -102;
Fichero = "y" + Fichero + VAlfa;
|NOME_DAT #14 Fichero;
|ABRE #14; |CIERRA #14; |DELINDEX #14;

|BLIN 04;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
Modo = (FEntrada / 100) ! 0;
|SI Modo ! 1; |Y Modo ! 2; |ACABA; |FINSI;

|HAZ MGeneral;
|FPRC;

|PROCESO Tipo13; |TIPO 13;
Modo = (FEntrada / 100) ! 0;
|SI Modo ! 4; |ACABA; |FINSI;

|HAZ MGeneral;
|FPRC;

|PROCESO MGeneral;
VEmpresa  = #7#0;
VAnyo     = #7#1;
Salir     = 0;
|PARA; |SI Salir = 0; |HACIENDO;
       |MENUG MGeneral;
       MGeneral2 = FSalida;
       Opcion    = FSalida;
       Salir     = 1;
       |SI Opcion ] 1; |Y Opcion [ 7;
           Salir = 0;
           |HAZ CogeVar;
           |SI Opcion = 1;  |HAZ MEstDire;           |FINSI;
           |SI Opcion = 2;  |SUB_EJECUTA "agrm0009"; |FINSI;
           |SI Opcion = 3;  |SUB_EJECUTA "agrm0010"; |FINSI;
           |SI Opcion = 4;  |SUB_EJECUTA "agrm0011"; |FINSI;
           |SI Opcion = 5;  |SUB_EJECUTA "agrm0012"; |FINSI;
           |SI Opcion = 6;  |SUB_EJECUTA "agrz0001"; |FINSI;
           |SI Opcion = 7;  |SUB_EJECUTA "agrz0002"; |FINSI;
           |HAZ PintaVar;
       |FINSI;
|SIGUE;

|PINPA #0#7;
|FPRC;

|PROCESO CogeVar;
VVTerreno = #7#3;
VVInstala = #7#4;
VVMaquina = #7#5;
VVGanados = #7#6;
VBas      = #7#7;
VIva      = #7#8;
VRec      = #7#9;
VRet      = #7#10;
VFac      = #7#11;
CBas      = #7#12;
CIva      = #7#13;
CRec      = #7#14;
CRet      = #7#15;
CFac      = #7#16;
|FPRC;

|PROCESO PintaVar;
#7#3  = VVTerreno;   |PINTA #7#3;
#7#4  = VVInstala;   |PINTA #7#4;
#7#5  = VVMaquina;   |PINTA #7#5;
#7#6  = VVGanados;   |PINTA #7#6;

#7#7  = VBas;
#7#8  = VIva;
#7#9  = VRec;
#7#10 = VRet;
#7#11 = VFac;

#7#12 = CBas;
#7#13 = CIva;
#7#14 = CRec;
#7#15 = CRet;
#7#16 = CFac;
|FPRC;

|PROCESO MEstDire;
|PUSHV 0501 2380;
Salir1 = 0;
|PARA; |SI Salir1 = 0; |HACIENDO;
       |MENUG MEstDire;
       MEstDire2 = FSalida;
       Opcion1   = FSalida;
       Salir1    = 1;
       |SI Opcion1 ] 1; |Y Opcion1 [ 20;
           Salir1 = 0;
           |SI Opcion1 = 1;                   |SUB_EJECUTA "agrm0008"; |FINSI;
           |SI Opcion1 = 2;  VPEstima = "A01"; |SUB_EJECUTA "agrw0004"; |FINSI;
           |SI Opcion1 = 3;  VPEstima = "A02"; |SUB_EJECUTA "agrw0004"; |FINSI;
           |SI Opcion1 = 4;  VPEstima = "A03"; |SUB_EJECUTA "agrw0004"; |FINSI;
           |SI Opcion1 = 5;  VPEstima = "A04"; |SUB_EJECUTA "agrw0005"; |FINSI;
           |SI Opcion1 = 6;  VPEstima = "A05"; |SUB_EJECUTA "agrw0006"; |FINSI;
           |SI Opcion1 = 7;  VPEstima = "A06"; |SUB_EJECUTA "agrw0007"; |FINSI;
           |SI Opcion1 = 8;  VPEstima = "A07"; |SUB_EJECUTA "agrw0008"; |FINSI;
           |SI Opcion1 = 9;  VPEstima = "A08"; |SUB_EJECUTA "agrw0009"; |FINSI;
           |SI Opcion1 = 10; VPEstima = "A09"; |SUB_EJECUTA "agrw0009"; |FINSI;
           |SI Opcion1 = 11; VPEstima = "A10"; |SUB_EJECUTA "agrw0009"; |FINSI;
           |SI Opcion1 = 12;  |FINSI;
           |SI Opcion1 = 13;  |FINSI;
           |SI Opcion1 > 13; MEstDire2 = "13"; |FINSI;
       |FINSI;
|SIGUE;

|POPV;
|PINTA #7#0;   |PINTA #7#1;   |PINTA #7#2;
|PINTA #7#3;   |PINTA #7#4;   |PINTA #7#5;   |PINTA #7#6;
|FPRC;
