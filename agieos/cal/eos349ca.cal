|FICHEROS;
   eos349ca;
   eos349li;
|FIN;

|VARIABLES;
     nEjer  = 0;
     aAlfa1 = "";
|FIN;

|PROCESO Tipo0C2; |TIPO 0;
    |SI #eos349ca#2 ] 20;
        |ATRI I; |PINTA 1002, "Claves E/S/M/H/R/D/C"; |ATRI 0;
        |PINTA 1147, "E/S/M/H/R/D/C ";
    |SINO;
        |PINTA 1002, "ÄÄÄClaves E/S/M/HÄÄÄÄ";
        |ATRI I; |PINTA 1005, "Claves E/S/M/H"; |ATRI 0;
        |PINTA 1147, "Claves E/S/M/H";
    |FINSI;
|FPRC;

|PROCESO i_archiv; |TIPO 7;
    |SI #eos349ca#5 = "S";
        |MENAV "     Registro archivado, DESARCHIVELO";
        |PTEC 807;
    |FINSI;
|FPRC;

|PROCESO Comple; |TIPO 0;
    aAlfa1 = "N";
    |SI #eos349ca#16 ! "N"; aAlfa1 = "S"; |FINSI;
    |C_M #eos349ca#17,1,aAlfa1;

    |SI #eos349ca#16 = "N";
        #eos349ca#17 = "0000000000000";
        |PINTA #eos349ca#17;
    |FINSI;
|FPRC;

|PROCESO Tipo0C1;  |TIPO 0;

     nEjer = 2000 + #eos349ca#2;
     |SI #eos349ca#2 ] 80;
         nEjer = 1900 + #eos349ca#2;
     |FINSI;

     |SI #eos349ca#1 = 0;
         |SI nEjer ] 2020; |O nEjer [ 2009;
             |MENAV "0000Periodo no válido a partir del ejercicio 2020";
             |ERROR;
             |ACABA;
         |FINSI;

         |C_M #eos349ca#18, 1, "N";
         #eos349ca#18 = "A";
         |PINTA #eos349ca#18;
         |ACABA;
     |FINSI;

     |SI nEjer [ 2009;
         |C_M #eos349ca#18, 1, "N";
         #eos349ca#18 = "T";
         |PINTA #eos349ca#18;
         |ACABA;
     |FINSI;

     |SI #eos349ca#1 [ 4;
         |C_M #eos349ca#18, 1, "S";
         |ACABA;
     |FINSI;

     |C_M #eos349ca#18, 1, "N";
     #eos349ca#18 = "M";
     |PINTA #eos349ca#18;
|FPRC;

|PROCESO Tipo7C18;  |TIPO 7;
    aAlfa1 = "0000<A> Anual; <T> Trimestral;  <M> Mensual";
    |SI nEjer ] 2020;
        aAlfa1 = "0000<T> Trimestral;  <M> Mensual";
    |FINSI;
    |MENSA aAlfa1;
|FPRC;

|PROCESO Tipo0C18;  |TIPO 0;
     |BLIN 4;

     |C_M #eos349ca#19, 1, "S";

     |SI nEjer ] 2020; |Y #eos349ca#18 = "A";
         |ERROR;
         |ACABA;
     |FINSI;

     |SI #eos349ca#18 ! "M";
         |C_M #eos349ca#19, 1, "N";
         #eos349ca#19 = "N";  |PINTA #eos349ca#19;
         |ACABA;
     |FINSI;

     |SI #eos349ca#1 ! 2;  |Y #eos349ca#1 ! 5;  |Y #eos349ca#1 ! 8;  |Y #eos349ca#1 ! 11;
         |C_M #eos349ca#19, 1, "N";
         #eos349ca#19 = "N";  |PINTA #eos349ca#19;
     |FINSI;
|FPRC;


|PROGRAMA;
     |C_V #eos349li#29,1, "N";
     |C_V #eos349li#30,1, "N";

     |CLS;
     |CABEZA "Modelo 349";

     |MANTE #eos349ca;
|FPRO;
