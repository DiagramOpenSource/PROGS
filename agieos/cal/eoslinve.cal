|FICHEROS;
    eoscabve #0;
    eoslinve #2;
    eosclpre #3;
    eosclipr #4;
    eosactiv #5;
    eosutili #7;
    eosconce #8;
    eosconc6 #88;

    eosm0008 #10;                  || Control 347 para arrendadores
    eosm0012 #11;
    eosm0011 #12,MANTE;

    eosaplic #96;
    eosw0041 #98,MANTE;
    eosw0036 #99,MANTE;
    :/agicli/def/agicontr #97;

    eosw0082 #82;

    eoscolib #200;
    &eosesp@ #102;
|FIN;

|VARIABLES;
     nSwDesplegar = 0;
     nLineaAct    = 0;
     nLineaNue    = 0;
     nCampo       = 0;
     nCampo1      = 0;
     nEl07        = 0;
     nEl09        = 0;
     nEl11        = 0;
     nEl22        = 0;
     nEl23        = 0;
     nEl24        = 0;
     nEl27        = 0;
     nEl28        = 0;
     nEl31        = 0;
     nEl32        = 0;
     nEl42        = 0;
     nEl43        = 0;
     nEl44        = 0;
     nEl45        = 0;
     nEl46        = 0;
     nEl47        = 0;
     nEl51        = 0;
     nEl52        = 0;
     nEl53        = 0;
     nEl57        = 0;
     nEl58        = 0;
     nEl59        = 0;
     nEl69        = 0;
     nEl70        = 0;
     nEl71        = 0;

     Refer1      = "";
     Refer2      = "";
     Refer3      = "";
     Refer4      = "";
     Refer5      = "";
     Refer6      = "";
     Forma       = 0;
     XPara       = 0;
     LineaBase   = 0;
     Mensa       = "";
     nPaso       = 0;
     nConcepto   = 0;
     aConcepto   = "";
     aAlfa       = "";

     cliente     = 0;
     sw_cif      = 0;
     FSfuncion   = 0;
     tecla       = "";
     f1          = "823";
     f2          = "824";
     f3          = "825";
     f4          = "826";

     &modelito   = 0;

     cli = 0;
     fec = "";
     con = 0;
     des = "";
     ser = "";
     fac = 0;
     tri = 0;
     act = 0;
     dec = "";
     aCon = "";
     cont        = 0;
     vardia      = 0;
     varmes      = 0;
     tot_imp     = 0;
     swmodi      = 0;
     varalfa     = "";
     varalfa1    = "";
     varalfa2    = "";
     fecha       = "";
     sw_nif      = 0;
     d_agicli    = "";
     p_agicli    = "";

     {-1}valfec  = 0;
         valfec1 = 31;
         valfec2 = 29;
         valfec3 = 31;
         valfec4 = 30;
         valfec5 = 31;
         valfec6 = 30;
         valfec7 = 31;
         valfec8 = 31;
         valfec9 = 30;
         valfec10 = 31;
         valfec11 = 30;
         valfec12 = 31;

     aBase   = "";
     aDef    = "";
     nInkey  = 0;
     nNume1  = 0;
     &enEosEmp = 0;
     &enEosCPr = 0;
     &eaEosNIF = "";
     &enEosTip = 0;
     aNifQbf1   = "";
     aNifQbf2   = "";

     &eaVarDni  = "";
     &enCalcCif = 0;
     &nSwDeDonde = 1;
     &enEjer     = 0;
|FIN;

|INCLUYE i_consul;
|INCLUYE i_varcaj;

|PROCESO de_donde1; |TIPO 8;
 |DBASE aBase;
 aDef = aBase + "def/eoslinve.mas";
 |CARGA_DEF aDef, eosesp@;
 |SI FSalida ! 0;
     aDef = "";
     |MENAV "    Error Cargando Def ... ";
     |PTEC 807;
     |ACABA;
 |FINSI;

|ABRE #200;
|LEE 040#200p;
|SI FSalida ! 0; |DDEFECTO #200; |FINSI;
|CIERRA #200;
|ABRE #96;
|LEE 040#96p;
|SI FSalida ! 0; |DDEFECTO #96; |FINSI;
|CIERRA #96;

|DBASS d_agicli;
|PATH_DAT #97 d_agicli;

|SI #96#11 = 1; |ACABA; |FINSI;

|ABRE #97;
|LEE 040#97p;
|SI FSalida ! 0; |CIERRA #97; |ACABA; |FINSI;
|CIERRA #97;

d_agicli = #97#8; |QBF d_agicli;
|SI d_agicli = "*"; |ACABA; |FINSI;
p_agicli = (d_agicli - "fich/") + "pan/";

|PATH_DAT #4 d_agicli;
|PATH_PAN #4 p_agicli;

|C_V #4#14, 1, "S";
|C_M #4#14, 1, "S";
|FPRC;

|PROCESO LaDescarga; |TIPO 9;
 |SI aDef ! ""; |DESCARGA_DEF #eosesp@; aDef = ""; |FINSI;
|FPRC;

|PROCESO altamod; |TIPO 0;
|BLIN 4;
cont  = (FEntrada / 100) ! 0;
|SI cont ! 1; |ACABA; |FINSI;

#2#3  = cli;
#2#4  = fec;
#2#5  = con;
#2#6  = des;
#2#15 = ser;
#2#16 = fac;
#2#17 = tri;
#2#19 = act;
#2#35 = dec;
#2#72 = aCon;
|FPRC;

|PROCESO cliente; |TIPO 0;
  |ABRE #3;
  |SELECT #1#3;

  #3#0 = #0#0;
  #3#1 = 0;
  #3#2 = 1;
  |LEE 001#3=;
  |SI FSalida ! 0;
      |DDEFECTO #3;
       #3#0 = #0#0;
       #3#1 = 0;
       #3#2 = 1;
       |GRABA 020#3n;
  |FINSI;

  |DDEFECTO #3;
  #2#0 = #0#0;

  #3#0 = #2#0;
  #3#1 = #2#3;
  #3#2 = 1;
  |LEE 040#3=;
  |SI FSalida = 0; |Y #3#0 = #0#0; |Y #3#2 = 1;
      |SI #2#3 = 0;
          sw_nif = 1;
          |C_M #2#12, 1, "S"; |ENCAMPO #12#2;
          |C_M #2#12, 1, "N";
          sw_nif = 0;
          |C_M #2#38, 1, "S";
          |SI cont = 1;  #2#38 = #3#4;  |PINTA #2#38;  |FINSI;
      |SINO;
        |C_M #2#12, 1, "N";  #2#12 = #3#3;  |PINTA #2#12;
        |C_M #2#38, 1, "N";  #2#38 = #3#4;  |PINTA #2#38;
    |FINSI;

    |SI #5#17 ! "N";
       |SI cont = 1;
           #2#8  = #3#14;
           #2#25 = #3#14;
           #2#26 = #3#14;
           #2#10 = #3#15;
           #2#29 = #3#15;
           #2#30 = #3#15;
           #2#39 = #3#22;
           #2#40 = #3#22;
           #2#41 = #3#22;
       |FINSI;
    |SINO;
       |SI cont = 1;
           #2#8  = 0; #2#25 = 0; #2#26 = 0; #2#48 = 0; #2#49 = 0; #2#50 = 0;
           #2#10 = 0; #2#29 = 0; #2#30 = 0; #2#54 = 0; #2#55 = 0; #2#56 = 0;
           #2#39 = 0; #2#40 = 0; #2#41 = 0; #2#66 = 0; #2#67 = 0; #2#68 = 0;
       |FINSI;
    |FINSI;
|SINO;
    |MENAV "    No existe Cliente con ese codigo";
    |ERROR;
|FINSI;
|CIERRA #3;
|FPRC;

|PROCESO LeeVarios;
 || ...  comprobar que no es el mismo registro
 |SI #102#1 ! #2#1;
     nNume1 = nNume1 + 1;
 |FINSI;
|FPRC;

|DEFBUCLE LeeVarios;
 #102#3004;
 ;
 #2#0, #2#14, #2#15, #2#16;
 #2#0, #2#14, #2#15, #2#16;
 ;
 NULL, LeeVarios;
|FIN;

|PROCESO MiroDocumento;
  nInkey = FSalida;

  |SI nInkey  = 2; |ACABA; |FINSI;

  |SI #200#94 = "N"; |ACABA; |FINSI;

  |SI nInkey = 10;
     |ABRE #102;
     |SELECT #3#102;
     #102#0  = #2#0;
     #102#14 = #2#14;
     #102#15 = #2#15;
     #102#16 = 999999;
     |LEE 001#102];
     |SI FSalida = 0;
         |LEE 040#102a;
     |SINO;
         |LEE 040#102u;
     |FINSI;
     |SI FSalida = 0; |Y #102#0 = #2#0; |Y #102#14 = #2#14; |Y #102#15 = #2#15;
         |SI #102#1 ! #2#1;
             #2#16 = #102#16 + 1;
         |FINSI;
     |SINO;
         #2#16 = 1;
     |FINSI;
     |PINTA #2#16;
     |SELECT #1#102;
     |CIERRA #102;
     |ACABA;
  |FINSI;

  nNume1 = 0;
  |BUCLE LeeVarios;
  |SI nNume1 ! 0;
      |CONFI "    NYa Existe Documento, ¨Desea continuar?";
      |SI FSalida ! 0;
          |ERROR;
      |FINSI;
  |FINSI;
|FPRC;

|PROCESO fechclav; |TIPO 0;
   nInkey = FSalida;
   |SI nInkey = 10; |O #2#79 ! "01.01.0000";
       |C_M #2#79, 1, "S";
       |SI nInkey = 10;
           |SI #2Campo = "    ";
               |ERROR;
               |ACABA;
           |FINSI;
       |FINSI;
   |FINSI;

valfec1  = 31; valfec2  = 29; valfec3  = 31;
valfec4  = 30; valfec5  = 31; valfec6  = 30;
valfec7  = 31; valfec8  = 31; valfec9  = 30;
valfec10 = 31; valfec11 = 30; valfec12 = 31;

varalfa = #2Campo;
|SI varalfa = "    ";
    |MENAV "    Introduzca una fecha.";
    |ERROR;
|SINO;
    varalfa1 = varalfa % 102;
    |QBT varalfa1;
    varalfa1 = "00" + varalfa1;
    varalfa1 = varalfa1 % -102;

    varalfa2 = varalfa % 302;
    |QBT varalfa2;
    varalfa2 = "00" + varalfa2;
    varalfa2 = varalfa2 % -102;

    #2Campo = varalfa1 + varalfa2;
    |PINTA #2Campo;

    vardia = varalfa1;
    varmes = varalfa2;

   |SI varmes [ 0;|O varmes > 12;
        |MENAV "     Fecha erronea DD/MM";
        |ERROR;
   |SINO;
        Ivalfec = valfec1 <-;
        Ivalfec = Ivalfec + varmes;
        Ivalfec = Ivalfec - 1;
        |SI vardia > valfec;|O vardia [ 0;
           |MENAV "     Fecha erronea DD/MM";
           |ERROR;
        |FINSI;
   |FINSI;

   |SI cont = 1;
      |SI varmes = 1;|O varmes = 2;|O varmes = 3;
          #2#17 = 01; |PINTA #2#17;
      |FINSI;
      |SI varmes = 4;|O varmes = 5;|O varmes = 6;
         #2#17 = 02;  |PINTA #2#17;
      |FINSI;
      |SI varmes = 7;|O varmes = 8;|O varmes = 9;
         #2#17 = 03;  |PINTA #2#17;
      |FINSI;
      |SI varmes = 10;|O varmes = 11;|O varmes = 12;
         #2#17 = 04;  |PINTA #2#17;
      |FINSI;
   |FINSI;
   |SI #0#4 > 80;
       fecha = varalfa1 + "." + varalfa2 + "." + "19" + (("00" + #0#4) % -102);
   |SINO;
       fecha = varalfa1 + "." + varalfa2 + "." + "20" + (("00" + #0#4) % -102);
   |FINSI;
    #2#13 = fecha;
    |SI #2#13 < #7#0; |O #2#13 > #7#1;
        |MENAV "     La fecha introducida no coincide a la seleccionada.";
        |ERROR;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO TrasTrim; |TIPO 0;
   nInkey = FSalida;
   |SI nInkey = 10;
       |C_M #2#79, 1, "S";
       |ERROR;
       |PTEC 808;
   |FINSI;
|FPRC;

|CALCULO FechaOp; |TIPO 7;
 |C_M #2#79, 0, varalfa1;
 |SI varalfa1 = "N"; |ACABA; |FINSI;

 |SI #2#79 = "01.01.0000";
     |SI #0#4 > 80;
         nNume1 = 1900 + #0#4;
     |SINO;
         nNume1 = 2000 + #0#4;
     |FINSI;
     varalfa1 = nNume1;
     varalfa2 = #2#4;
     varalfa1 = (varalfa2 % 102) + "." + (varalfa2 % 302) + "." + varalfa1;
     #2#79  = varalfa1; |PINTA #2#79;
 |FINSI;
|FCAL;

|PROCESO LeeActividad;
|ABRE #5;
#5#0 = #2#0;
#5#1 = #2#19;
#5#2 = #2#14;
|LEE 040#5=;
|SI FSalida ! 0; |DDEFECTO #5; |FINSI;
|CIERRA #5;
|FPRC;

|PROCESO PintaActividad; |TIPO 7;
    |HAZ LeeActividad;
    |ATRI I; |PINTA 1416, #5#6; |ATRI 0;

    modelito = (FEntrada / 100) ! 0;
    varalfa = "0000<F1> ULTIMO REGISTRO; <F2> PRIMER REGISTRO; <F3> CONSULTAR DESGLOSE. ";

    enSwCaja = 0;
    |SI enEjer ] 2014; |Y modelito > 1;
        eEmpreCaja = #2#0;
        eRegisCaja = #2#1;
        enEjerCaja = #2#14;
        aTipoIVA   = "R";
        enDigCaja  = #5#50;
        |HAZ EsCajaIva;
        |SI enSwCaja = 1;
            varalfa = "0000<F1> ULTIMO REG.; <F2> PRIMER REG.; <F3> CONSULTA DESGLOSE; <F9> CONSULTA PAGOS";
        |FINSI;
    |FINSI;
    |MENSA varalfa;
|FPRC;

|PROCESO consuven; |TIPO 11;
|SI FSalida = 9; |O FSalida = 10;
    FSfuncion   = FSalida;
    |SI FSfuncion = 9;  #2#1 = 32000; |PTEC 809; |FINSI;
    |SI FSfuncion = 10; #2#1 = 1;     |PTEC 808; |FINSI;
    |ERROR;
|FINSI;

|SI FSalida = 11;
    modelito = (FEntrada / 100) ! 0;
    |SI modelito = 1; |ACABA; |FINSI;
    modelito = 4;

    |HAZ LeeActividad;

    |SI #5#50 = 1; |HAZ PantallaDesglose2; |FINSI;
    |SI #5#50 = 2; |HAZ PantallaDesglose6; |FINSI;
    |ERROR;
|FINSI;

|SI FSalida = 17; |Y enSwCaja = 1;
    modelito = (FEntrada / 100) ! 0;
    |SI modelito = 1; |ACABA; |FINSI;
    eEmpreCaja = #2#0;
    eRegisCaja = #2#1;
    enEjerCaja = #2#14;
    aTipoIVA   = "R";
    enDigCaja  = #5#50;
    eModoCaja  = 4;
    |HAZ eTrataClaveZ;
    |ERROR;
|FINSI;
|FPRC;

|PROCESO Actua2;
|ABRE #8;
#8#0 = #2#5;
|LEE 040#8=;
|SI FSalida = 0; |Y #8#3 = "I";
    #0#5 = #0#5 +. #2#7;
    #0#6 = #0#6 +. #2#9;
    #0#7 = #0#7 +. #2#11;
    #0#9 = #0#9 +. #2#42;
    #0#8 = #0#5 + #0#6 + #0#7 - #0#9;

    |SI #2#9 ! 0; #3#17 = #3#17 +. (#2#7 + #2#9 + #2#11 + #2#42); |FINSI;
    |SI #2#9 = 0; #3#16 = #3#17 +. #2#7;                          |FINSI;
|FINSI;

#8#0 = #2#33;
|LEE 040#8=;
|SI FSalida = 0; |Y #8#3 = "I";
    #0#5 = #0#5 +. #2#23;
    #0#6 = #0#6 +. #2#27;
    #0#7 = #0#7 +. #2#31;
    #0#9 = #0#9 +. #2#43;
    #0#8 = #0#5 + #0#6 + #0#7 - #0#9;

    |SI #2#9 ! 0; #3#17 = #3#17 +. (#2#23 + #2#27 + #2#31 - #2#43); |FINSI;
    |SI #2#9 = 0; #3#16 = #3#16 +. #2#23;                           |FINSI;
|FINSI;

#8#0 = #2#34;
|LEE 040#8=;
|SI FSalida = 0; |Y #8#3 = "I";
    #0#5 = #0#5 +. #2#24;
    #0#6 = #0#6 +. #2#28;
    #0#7 = #0#7 +. #2#32;
    #0#9 = #0#9 +. #2#44;
    #0#8 = #0#5 + #0#6 + #0#7 - #0#9;

    |SI #2#9 ! 0; #3#17 = #3#17 +. (#2#24 + #2#28 + #2#32 #2#44); |FINSI;
    |SI #2#9 = 0; #3#16 = #3#16 +. #2#24;                         |FINSI;
|FINSI;

#8#0 = #2#60;
|LEE 040#8=;
|SI FSalida = 0; |Y #8#3 = "I";
    #0#5 = #0#5 +. #2#45;
    #0#6 = #0#6 +. #2#51;
    #0#7 = #0#7 +. #2#57;
    #0#9 = #0#9 +. #2#69;
    #0#8 = #0#5 + #0#6 + #0#7 - #0#9;

    |SI #2#9 ! 0; #3#17 = #3#17 +. (#2#24 + #2#28 + #2#32 - #2#44); |FINSI;
    |SI #2#9 = 0; #3#16 = #3#16 +. #2#24;                         |FINSI;
|FINSI;

#8#0 = #2#61;
|LEE 040#8=;
|SI FSalida = 0; |Y #8#3 = "I";
    #0#5 = #0#5 +. #2#46;
    #0#6 = #0#6 +. #2#52;
    #0#7 = #0#7 +. #2#58;
    #0#9 = #0#9 +. #2#70;
    #0#8 = #0#5 + #0#6 + #0#7 - #0#9;

    |SI #2#9 ! 0; #3#17 = #3#17 +. (#2#24 + #2#28 + #2#32 - #2#44); |FINSI;
    |SI #2#9 = 0; #3#16 = #3#16 +. #2#24;                         |FINSI;
|FINSI;

#8#0 = #2#62;
|LEE 040#8=;
|SI FSalida = 0; |Y #8#3 = "I";
    #0#5 = #0#5 +. #2#47;
    #0#6 = #0#6 +. #2#53;
    #0#7 = #0#7 +. #2#59;
    #0#9 = #0#9 +. #2#71;
    #0#8 = #0#5 + #0#6 + #0#7 - #0#9;

    |SI #2#9 ! 0; #3#17 = #3#17 +. (#2#24 + #2#28 + #2#32 - #2#44); |FINSI;
    |SI #2#9 = 0; #3#16 = #3#16 +. #2#24;                         |FINSI;
|FINSI;
|CIERRA #8;

|LEE 040#10p;
|SI FSalida ! 0; |ACABA; |FINSI;

Forma = 0 +. 1;

|SI Forma = 1;
    LineaBase = 0;
    |PARA XPara = 86; |SI XPara [ 95; |HACIENDO XPara = XPara + 1;
          |SI #10XPara ! 0;
              |SI #10XPara = #2#5;  LineaBase = 1; |HAZ Arrendamiento; |FINSI;
              |SI #10XPara = #2#33; LineaBase = 2; |HAZ Arrendamiento; |FINSI;
              |SI #10XPara = #2#34; LineaBase = 3; |HAZ Arrendamiento; |FINSI;
              |SI #10XPara = #2#60; LineaBase = 4; |HAZ Arrendamiento; |FINSI;
              |SI #10XPara = #2#61; LineaBase = 5; |HAZ Arrendamiento; |FINSI;
              |SI #10XPara = #2#62; LineaBase = 6; |HAZ Arrendamiento; |FINSI;
          |FINSI;
    |SIGUE;
    Refer1 = "";  Refer2 = "";  Refer3 = "";
    Refer4 = "";  Refer5 = "";  Refer6 = "";
|SINO;
    Refer1 = "";  Refer2 = "";  Refer3 = "";
    Refer4 = "";  Refer5 = "";  Refer6 = "";
    |ABRE #11;
    #11#0 = #2#0;
    #11#1 = #2#14;
    #11#3 = #2#1;
    |PARA XPara = 1; |SI XPara [ 6; |HACIENDO XPara = XPara + 1;
          #11#2 = XPara;
          |LEE 140#11=;
          |SI FSalida = 0;
              |SI XPara = 1; Refer1 = #11#4; |FINSI;
              |SI XPara = 2; Refer2 = #11#4; |FINSI;
              |SI XPara = 3; Refer3 = #11#4; |FINSI;
              |SI XPara = 4; Refer4 = #11#4; |FINSI;
              |SI XPara = 5; Refer5 = #11#4; |FINSI;
              |SI XPara = 6; Refer6 = #11#4; |FINSI;
              |LIBERA #11;
              |BORRA 140#11a;
          |FINSI;
    |SIGUE;
    |CIERRA #11;
|FINSI;
|FPRC;

|PROCESO Actua6;
|ABRE #88;
#88#0 = #2#72;
|LEE 040#88=;
|SI FSalida = 0; |Y #88#3 = "I";
    #0#5 = #0#5 +. #2#7;
    #0#6 = #0#6 +. #2#9;
    #0#7 = #0#7 +. #2#11;
    #0#9 = #0#9 +. #2#42;
    #0#8 = #0#5 + #0#6 + #0#7 - #0#9;

    |SI #2#9 ! 0; #3#17 = #3#17 +. (#2#7 + #2#9 + #2#11 + #2#42); |FINSI;
    |SI #2#9 = 0; #3#16 = #3#17 +. #2#7;                          |FINSI;
|FINSI;

#88#0 = #2#73;
|LEE 040#88=;
|SI FSalida = 0; |Y #88#3 = "I";
    #0#5 = #0#5 +. #2#23;
    #0#6 = #0#6 +. #2#27;
    #0#7 = #0#7 +. #2#31;
    #0#9 = #0#9 +. #2#43;
    #0#8 = #0#5 + #0#6 + #0#7 - #0#9;

    |SI #2#9 ! 0; #3#17 = #3#17 +. (#2#23 + #2#27 + #2#31 - #2#43); |FINSI;
    |SI #2#9 = 0; #3#16 = #3#16 +. #2#23;                           |FINSI;
|FINSI;

#88#0 = #2#74;
|LEE 040#88=;
|SI FSalida = 0; |Y #88#3 = "I";
    #0#5 = #0#5 +. #2#24;
    #0#6 = #0#6 +. #2#28;
    #0#7 = #0#7 +. #2#32;
    #0#9 = #0#9 +. #2#44;
    #0#8 = #0#5 + #0#6 + #0#7 - #0#9;

    |SI #2#9 ! 0; #3#17 = #3#17 +. (#2#24 + #2#28 + #2#32 #2#44); |FINSI;
    |SI #2#9 = 0; #3#16 = #3#16 +. #2#24;                         |FINSI;
|FINSI;

#88#0 = #2#75;
|LEE 040#88=;
|SI FSalida = 0; |Y #88#3 = "I";
    #0#5 = #0#5 +. #2#45;
    #0#6 = #0#6 +. #2#51;
    #0#7 = #0#7 +. #2#57;
    #0#9 = #0#9 +. #2#69;
    #0#8 = #0#5 + #0#6 + #0#7 - #0#9;

    |SI #2#9 ! 0; #3#17 = #3#17 +. (#2#24 + #2#28 + #2#32 - #2#44); |FINSI;
    |SI #2#9 = 0; #3#16 = #3#16 +. #2#24;                         |FINSI;
|FINSI;

#88#0 = #2#76;
|LEE 040#88=;
|SI FSalida = 0; |Y #88#3 = "I";
    #0#5 = #0#5 +. #2#46;
    #0#6 = #0#6 +. #2#52;
    #0#7 = #0#7 +. #2#58;
    #0#9 = #0#9 +. #2#70;
    #0#8 = #0#5 + #0#6 + #0#7 - #0#9;

    |SI #2#9 ! 0; #3#17 = #3#17 +. (#2#24 + #2#28 + #2#32 - #2#44); |FINSI;
    |SI #2#9 = 0; #3#16 = #3#16 +. #2#24;                         |FINSI;
|FINSI;

#88#0 = #2#77;
|LEE 040#88=;
|SI FSalida = 0; |Y #88#3 = "I";
    #0#5 = #0#5 +. #2#47;
    #0#6 = #0#6 +. #2#53;
    #0#7 = #0#7 +. #2#59;
    #0#9 = #0#9 +. #2#71;
    #0#8 = #0#5 + #0#6 + #0#7 - #0#9;

    |SI #2#9 ! 0; #3#17 = #3#17 +. (#2#24 + #2#28 + #2#32 - #2#44); |FINSI;
    |SI #2#9 = 0; #3#16 = #3#16 +. #2#24;                         |FINSI;
|FINSI;

|CIERRA #88;

|LEE 040#10p;
|SI FSalida ! 0; |ACABA; |FINSI;

Forma = 0 +. 1;

|SI Forma = 1;
    LineaBase = 0;
    |PARA XPara = 96; |SI XPara [ 105; |HACIENDO XPara = XPara + 1;
          |SI #10XPara ! "      ";
              |SI #10XPara = #2#72; LineaBase = 1; |HAZ Arrendamiento; |FINSI;
              |SI #10XPara = #2#73; LineaBase = 2; |HAZ Arrendamiento; |FINSI;
              |SI #10XPara = #2#74; LineaBase = 3; |HAZ Arrendamiento; |FINSI;
              |SI #10XPara = #2#75; LineaBase = 4; |HAZ Arrendamiento; |FINSI;
              |SI #10XPara = #2#76; LineaBase = 5; |HAZ Arrendamiento; |FINSI;
              |SI #10XPara = #2#77; LineaBase = 6; |HAZ Arrendamiento; |FINSI;
          |FINSI;
    |SIGUE;
    Refer1 = "";  Refer2 = "";  Refer3 = "";
    Refer4 = "";  Refer5 = "";  Refer6 = "";
|SINO;
    Refer1 = "";  Refer2 = "";  Refer3 = "";
    Refer4 = "";  Refer5 = "";  Refer6 = "";
    |ABRE #11;
    #11#0 = #2#0;
    #11#1 = #2#14;
    #11#3 = #2#1;
    |PARA XPara = 1; |SI XPara [ 6; |HACIENDO XPara = XPara + 1;
          #11#2 = XPara;
          |LEE 140#11=;
          |SI FSalida = 0;
              |SI XPara = 1; Refer1 = #11#4; |FINSI;
              |SI XPara = 2; Refer2 = #11#4; |FINSI;
              |SI XPara = 3; Refer3 = #11#4; |FINSI;
              |SI XPara = 4; Refer4 = #11#4; |FINSI;
              |SI XPara = 5; Refer5 = #11#4; |FINSI;
              |SI XPara = 6; Refer6 = #11#4; |FINSI;
              |LIBERA #11;
              |BORRA 140#11a;
          |FINSI;
    |SIGUE;
    |CIERRA #11;
|FINSI;
|FPRC;

|PROCESO Arrendamiento;
|ET Arrenda;
  |AVISO;
  Mensa = "        Detectado Arrendamiento en linea Base : " + LineaBase;
  |MENSA Mensa;
  |PUSHV 0501 2380;
  |PINPA #0#98;
  #98#0 = #2#0;
  #98#1 = #2#14;
  #98#2 = #2#1;
  |SI LineaBase = 1; #98#3 = Refer1; |FINSI;
  |SI LineaBase = 2; #98#3 = Refer2; |FINSI;
  |SI LineaBase = 3; #98#3 = Refer3; |FINSI;
  |SI LineaBase = 4; #98#3 = Refer4; |FINSI;
  |SI LineaBase = 5; #98#3 = Refer5; |FINSI;
  |SI LineaBase = 6; #98#3 = Refer6; |FINSI;
  |PINDA #0#98;
  |ENDATOS #1#98;
  |SI FSalida = 0;
      |ABRE #11;
      #11#0 = #98#0;
      #11#1 = #98#1;
      #11#2 = LineaBase;
      #11#3 = #98#2;
      #11#4 = #98#3;
      |GRABA 040#11n;
      |CIERRA #11;
  |SINO;
     |VETE Arrenda;
  |FINSI;
  |POPV;
|FPRC;

|PROCESO ChequeaRefer;
  |ABRE #12;
  #12#0 = #98#0;
  #12#1 = #98#3;
  |LEE 040#12=;
  |SI #12#3 ! #2#12;
      |MENAV "    DNI Apunte Venta distinto al registro de Referencias.";
      |ERROR;
  |FINSI;
  |CIERRA #12;
|FPRC;

|PROCESO actualiz; |TIPO 2;
     |HAZ LeeActividad;

     |ABRE #3;
     #3#0 = #2#0;
     #3#2 = 1;
     #3#1 = #2#3;
     |LIBERA #3;
     |LEE 110#3=;

     |ABRE #10;
     |SI #5#50 = 1; |HAZ Actua2; |FINSI;
     |SI #5#50 = 2; |HAZ Actua6; |FINSI;
     |CIERRA #10;

     |PINTA #0#5;
     |PINTA #0#6;
     |PINTA #0#7;
     |PINTA #0#8;
     |PINTA #0#9;

     |GRABA 121#3a;
     |CIERRA #3;

     #2#0 = #0#0;
|FPRC;


|PROCESO activida; |TIPO 0;
|ABRE #5;
|SELECT #1#5;
#5#0 = #2#0;
#5#1 = #2#19;
#5#2 = #2#14;
|LEE 040#5=;
|SI FSalida = 0;
    |SI #5#15 = "N";
        |MENAV "     La Actividad no esta preparada para hacer libros";
        |ERROR;
    |FINSI;
    |SI #5#14 = "S";
        |MENAV "     La Actividad es un Comunero";
        |ERROR;
    |FINSI;
    |ATRI I; |PINTA 1416, #5#6; |ATRI 0;
|SINO;
    |MENAV "    Error no existe Actividad";
    |ERROR;
|FINSI;
|CIERRA #5;
|FPRC;

|PROCESO PideRectif;
     |PUSHV 0501 2380;
     |BLANCO 1202 2379;
     |CUADRO 1202 2379;
     |PINTA 1318, "HAY UN CONCEPTO DE FACTURA RECTIFICATIVA";
     |PINTA 1514, "Introduzca el numero de la factura rectificada";

     aAlfa = #2#78;
     E_inf = "";
     E_sup = "40";
     aAlfa = 1716 ? 1;
     #2#78 = aAlfa;

     |POPV;
|FPRC;

|PROCESO Rectific02;
     |SI nPaso = 1;  |ACABA;  |FINSI;

     #8#0 = nConcepto;
     |LEE 000#8=;
     |SI FSalida ! 0;  |DDEFECTO #8;  |FINSI;

     |SI #8#16 = "D";
         nPaso = 1;
         |HAZ PideRectif;
     |FINSI;
|FPRC;

|PROCESO Rectific06;
     |SI nPaso = 1;  |ACABA;  |FINSI;

     #88#0 = aConcepto;
     |LEE 000#88=;
     |SI FSalida ! 0;  |DDEFECTO #88;  |FINSI;

     |SI #88#22 = "D";
         nPaso = 1;
         |HAZ PideRectif;
     |FINSI;
|FPRC;


|PROCESO Consultas; |TIPO 6;
     nSwDesplegar = 0;
     nSwDeDonde   = 1;

     |SI #2#19 = 0;  |Y cont = 1;
         |PUSHV 0501 2380;
         |PINPA #0#82;
         |PINDA #0#82;
         |ENDATOS #1#82;
         |SI FSalida = 0;  |Y #82#0 ! 0;
             |POPV;
             #2#19 = #82#0;   |PINTA #2#19;
             nSwDesplegar = 1;
         |SINO;
             |ERROR;
             |POPV;
             |ACABA;
         |FINSI;
     |FINSI;

|ET OtraVez;

|C_M #2#3,  1, "S";
|C_M #2#12, 1, "N";
sw_cif = 0;

|PUSHV 0501 2380;
|D_CUADRO 0926, 1467;
|ATRI R;
|PINTA 1027, "<F12> Introduccion de Clientes por DNI. ";
|PINTA 1127, "<F2> Consultas de Clientes por C¢digo.  ";
|PINTA 1227, "<F3> Consultas de Clientes por Nombre   ";
|PINTA 1327, "<F4> Consultas de Actividades           ";
|ATRI 0;

f1 = &255 + "823";
f2 = &255 + "824";
f3 = &255 + "825";
f4 = &255 + "826";
|LEETECLA tecla;
|POPV;

|SI tecla = f2;
    FSalida = 9;
    Campo10020 = #2#0;
    Campo10022 = 1;
    |HAZ ConsuCliProv;
    #2#3 = Campo10021; |PINTA #2#3;
    |ACABA;
|FINSI;

|SI tecla = f3;
    FSalida = 10;
    Campo10020 = #2#0;
    Campo10022 = 1;
    |HAZ ConsuCliProv;
    #2#3 = Campo10021; |PINTA #2#3;
    |ACABA;
|FINSI;

|SI tecla = f4;
    Campo10010 = #2#0;
    Campo10011 = #2#19;
    Campo10012 = #2#14;
    |HAZ ConsuActiv;
    #2#19 = Campo10011; |PINTA #2#19;
    |VETE OtraVez;
|FINSI;

|SI tecla ! f1; |ACABA; |FINSI;

|C_M #2#3,  1, "N";
|C_M #2#12, 1, "S";
sw_cif = 1;
|FPRC;


|PROCESO consulcl; |TIPO 6;
     |SI FSalida = 9;
         eaVarDni   = #2Campo;
         enCalcCif  = 1;
         |HAZ CalculoDNI;
         #2Campo = eaVarDni;
         |PINTA #2Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #2Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     aNifQbf1 = #2Campo;   |QBF aNifQbf1;
     aNifQbf2 = eaVarDni;  |QBF aNifQbf2;

     |SI aNifQbf1 ! aNifQbf2; |Y aNifQbf1 ! "";
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #2Campo = eaVarDni;  |PINTA #2Campo;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

    |SI sw_cif = 1;
        |ABRE #3;
        |SELECT #3#3;
        #3#0 = #2#0;
        #3#2 = 1;
        #3#3 = #2#12;
        |LEE 040#3=;
        |SI FSalida = 0; |Y #3#0 = #2#0; |Y #3#2 = 1; #3#3 = #2#12;

            #2#3  = #3#1;
            #2#38 = #3#4;
            #2#12 = #3#3;
            |PINTA #2#3;
            |PINTA #2#38;
            |PINTA #2#12;

        |SINO;

            |SELECT #1#3;
            #3#0 = #2#0;
            #3#2 = 1;
            #3#1 = 99999;
            |LEE 010#3];
            |SI FSalida = 0;
                |LEE 040#3a;
            |SINO;
                |LEE 040#3u;
            |FINSI;
            cliente = 0;
            |SI FSalida = 0; |Y #3#0 = #2#0; |Y #3#2 = 1;
                cliente = #3#1;
            |FINSI;

            |SI cliente ! 99999;
                cliente = cliente + 1;
                #3#1 = cliente;
                |ABRE #4;
                #4#0 = #2#12;
                |LEE 040#4=;
                |SI FSalida = 0;
                    |ABRE #3;
                    |SELECT #1#3;
                    |DDEFECTO #3;
                    #3#0  = #2#0;
                    #3#1  = cliente;
                    #3#2  = 1;
                    #3#3  = #2#12;
                    #3#4  = #4#1;
                    #3#5  = #4#2;
                    #3#6  = #4#3;
                    #3#7  = #4#4;
                    #3#8  = #4#5;
                    #3#9  = #4#6;
                    #3#10 = #4#7;
                    #3#11 = #4#8;
                    #3#12 = #4#9;
                    #3#13 = #4#10;
                    #3#14 = #4#11;
                    #3#15 = #4#12;
                    #3#18 = #4#13;
                    |GRABA 041#3n;

                    #2#3  = #3#1;
                    #2#38 = #3#4;
                    #2#12 = #3#3;
                    |PINTA #2#3;
                    |PINTA #2#38;
                    |PINTA #2#12;
                |SINO;
                    #2#3 = #3#1;
                    |HAZ AltaPrCl;
                    |PINTA #2#3;
                    |PINTA #2#38;
                    |PINTA #2#12;
                    #2#4 = fec; |PINTA #2#4;
                |FINSI;
            |FINSI;

        |FINSI;
        |CIERRA #3;

    |FINSI;

    |C_M #2#12, 1, "N";
    sw_cif = 0;
|FPRC;


|| *************************************************************************
||                         CALCULOS  DE LA PANTALLA DE DESGLOSES
|| *************************************************************************

|PROCESO EntraPantalla; |TIPO 0;
modelito = (FEntrada / 100) ! 0;
|SI #5#50 = 1; |HAZ PantallaDesglose2; |FINSI;
|SI #5#50 = 2; |HAZ PantallaDesglose6; |FINSI;
|FPRC;

|PROCESO ParaRECC;
     |SI enEjer ] 2014;
         eEmpreCaja = #2#0;
         eRegisCaja = #2#1;
         enEjerCaja = #2#14;
         aTipoIVA   = "R";
         enDigCaja  = #5#50;
         |HAZ EsCajaIva;
         eModoCaja = modelito;
         |SI modelito = 1; |O modelito = 2;  eSwCambio = 1; |FINSI;
         |HAZ eTrataClaveZ;
     |FINSI;
     enSwCaja  = 0;
     eSwCambio = 0;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;
     nPaso = 0;

     |SI #5#50 = 1;
         |ABRE #8;
         nConcepto = #2#5;   |HAZ Rectific02;
         nConcepto = #2#33;  |HAZ Rectific02;
         nConcepto = #2#34;  |HAZ Rectific02;
         nConcepto = #2#60;  |HAZ Rectific02;
         nConcepto = #2#61;  |HAZ Rectific02;
         nConcepto = #2#62;  |HAZ Rectific02;
         |CIERRA #8;
     |FINSI;

     |SI #5#50 = 2;
         |ABRE #88;
         aConcepto = #2#72;   |HAZ Rectific06;
         aConcepto = #2#73;   |HAZ Rectific06;
         aConcepto = #2#74;   |HAZ Rectific06;
         aConcepto = #2#75;   |HAZ Rectific06;
         aConcepto = #2#76;   |HAZ Rectific06;
         |CIERRA #88;
     |FINSI;

     modelito = (FEntrada / 100) ! 0;

     cli = #2#3;
     fec = #2#4;
     con = #2#5;
     des = #2#6;
     ser = #2#15;
     fac = #2#16;
     tri = #2#17;
     act = #2#19;
     dec = #2#35;
     aCon= #2#72;

     |SI nSwDesplegar = 0; |O #82#0 = 0;
         |HAZ ParaRECC;
         |ACABA;
     |FINSI;

     |GRABA 020#2c;
     |LIBERA #2;

     nLineaAct = #2#1;

     |LEE 040#2u;
     nLineaNue = #2#1;

     nEl07 = 0;
     nEl09 = 0;
     nEl11 = 0;
     nEl22 = 0;
     nEl23 = 0;
     nEl24 = 0;
     nEl27 = 0;
     nEl28 = 0;
     nEl31 = 0;
     nEl32 = 0;
     nEl42 = 0;
     nEl43 = 0;
     nEl44 = 0;
     nEl45 = 0;
     nEl46 = 0;
     nEl47 = 0;
     nEl51 = 0;
     nEl52 = 0;
     nEl53 = 0;
     nEl57 = 0;
     nEl58 = 0;
     nEl59 = 0;
     nEl69 = 0;
     nEl70 = 0;
     nEl71 = 0;

     |PARA nCampo = 2;  |SI nCampo [ 10;  |HACIENDO nCampo = nCampo + 2;
           nCampo1 = nCampo + 1;
           |SI  #82nCampo ! 0;  |Y #82nCampo1 ! 0;
                nLineaNue = nLineaNue + 1;

                #2#1 = nLineaAct;
                |LEE 040#2=;
                |SI FSalida = 0;
                    #2#19 = #82nCampo;
                    #2#1  = nLineaNue;
                    #2#7  = #2#7  % #82nCampo1;  nEl07 = nEl07 + #2#07;
                    #2#9  = #2#9  % #82nCampo1;  nEl09 = nEl09 + #2#09;
                    #2#11 = #2#11 % #82nCampo1;  nEl11 = nEl11 + #2#11;
                    #2#22 = #2#22 % #82nCampo1;  nEl22 = nEl22 + #2#22;
                    #2#23 = #2#23 % #82nCampo1;  nEl23 = nEl23 + #2#23;
                    #2#24 = #2#24 % #82nCampo1;  nEl24 = nEl24 + #2#24;
                    #2#27 = #2#27 % #82nCampo1;  nEl27 = nEl27 + #2#27;
                    #2#28 = #2#28 % #82nCampo1;  nEl28 = nEl28 + #2#28;
                    #2#31 = #2#31 % #82nCampo1;  nEl31 = nEl31 + #2#31;
                    #2#32 = #2#32 % #82nCampo1;  nEl32 = nEl32 + #2#32;
                    #2#42 = #2#42 % #82nCampo1;  nEl42 = nEl42 + #2#42;
                    #2#43 = #2#43 % #82nCampo1;  nEl43 = nEl43 + #2#43;
                    #2#44 = #2#44 % #82nCampo1;  nEl44 = nEl44 + #2#44;
                    #2#45 = #2#45 % #82nCampo1;  nEl45 = nEl45 + #2#45;
                    #2#46 = #2#46 % #82nCampo1;  nEl46 = nEl46 + #2#46;
                    #2#47 = #2#47 % #82nCampo1;  nEl47 = nEl47 + #2#47;
                    #2#51 = #2#51 % #82nCampo1;  nEl51 = nEl51 + #2#51;
                    #2#52 = #2#52 % #82nCampo1;  nEl52 = nEl52 + #2#52;
                    #2#53 = #2#53 % #82nCampo1;  nEl53 = nEl53 + #2#53;
                    #2#57 = #2#57 % #82nCampo1;  nEl57 = nEl57 + #2#57;
                    #2#58 = #2#58 % #82nCampo1;  nEl58 = nEl58 + #2#58;
                    #2#59 = #2#59 % #82nCampo1;  nEl59 = nEl59 + #2#59;
                    #2#69 = #2#69 % #82nCampo1;  nEl69 = nEl69 + #2#69;
                    #2#70 = #2#70 % #82nCampo1;  nEl70 = nEl70 + #2#70;
                    #2#71 = #2#71 % #82nCampo1;  nEl71 = nEl71 + #2#71;
                    |GRABA 020#2n;
                    |LIBERA #2;
                    |HAZ ParaRECC;
                |FINSI;
           |FINSI;
     |SIGUE;

     #2#1 = nLineaAct;
     |LEE 101#2=;
     |SI FSalida = 0;
         #2#7  = #2#7  - nEl07;
         #2#9  = #2#9  - nEl09;
         #2#11 = #2#11 - nEl11;
         #2#22 = #2#22 - nEl22;
         #2#23 = #2#23 - nEl23;
         #2#24 = #2#24 - nEl24;
         #2#27 = #2#27 - nEl27;
         #2#28 = #2#28 - nEl28;
         #2#31 = #2#31 - nEl31;
         #2#32 = #2#32 - nEl32;
         #2#42 = #2#42 - nEl42;
         #2#43 = #2#43 - nEl43;
         #2#44 = #2#44 - nEl44;
         #2#45 = #2#45 - nEl45;
         #2#46 = #2#46 - nEl46;
         #2#47 = #2#47 - nEl47;
         #2#51 = #2#51 - nEl51;
         #2#52 = #2#52 - nEl52;
         #2#53 = #2#53 - nEl53;
         #2#57 = #2#57 - nEl57;
         #2#58 = #2#58 - nEl58;
         #2#59 = #2#59 - nEl59;
         #2#69 = #2#69 - nEl69;
         #2#70 = #2#70 - nEl70;
         #2#71 = #2#71 - nEl71;
         |GRABA 020#2a;
         |HAZ ParaRECC;
     |FINSI;
     |LIBERA #2;

     |PTEC 815;
     |PTEC 815;
     |PTEC 814;
|FPRC;

|PROCESO Tipo5;  |TIPO 5;
     FSalida = "SINBARRA";
|FPRC;

|PROCESO AltaPrCl;
 |CIERRA #3;
 enEosEmp = #2#0;
 enEosCPr = #3#1;
 eaEosNIF = #2#12;
 enEosTip = 1;
 |SUB_EJECUTA_NP "eosaltcp";
|FPRC;
