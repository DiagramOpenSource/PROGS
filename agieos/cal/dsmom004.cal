|FICHEROS;
     dsmom004;
     dsmom008;
     dsmow001,MANTE;
     dsmow115,MANTE;
     dsmow116,MANTE;

     eosclien;
     eosactiv;
     eoscabve;
     eoscabco;
     eosdaban,MANTE;

     dsm30301;
|FIN;

|VARIABLES;
     aAlfa          = "";
     aPer           = "";
     aParametro     = "";
     aCampo         = "";

     nTecla         = 0;
     nHay           = 0;
     nBorra         = 0;
     nPasLib        = 0;
     nAnyoDos       = 0;
     nDEmpresa      = 0;
     nHEmpresa      = 0;

     nBtnF2         = 0;
     nBtnF3         = 0;
     nBtnF4         = 0;
     nBtnF5         = 0;
     nBtnF6         = 0;
     nBtnF7         = 0;
     nBtnF8         = 0;
     nBtnF9         = 0;
     nBtnF10        = 0;
     nBtnF12        = 0;
     nBtnF17        = 0;
     nBtnF22        = 0;

     nSwBtnF4       = 0;
     nSwBtnF5       = 0;
     nSwBtnF6       = 0;
     nSwBtnF7       = 0;
     nSwBtnF8       = 0;
     nSwBtnF9       = 0;
     nSwBtnF12      = 0;
     nSwBtnF17      = 0;
     nSwBtnF22      = 0;

    {10}aPopup      = "";

     &eaCamp4_9     = "";
     &efCamp4_10    = @;
     &eaCamp4_19    = "";
     &eaCamp4_25    = "";
     &enInfComp     = 0;

     fFechaIni      = @;
     fFechaFin      = @;
     aEjer          = "";
     nMesI          = 0;
     nMesF          = 0;
     aAlfa1         = "";
     aAlfa2         = "";
     nPara1         = 0;

     fFecha     = @;
     nDSEmpresa = 0;
     nHSEmpresa = 0;
     nDPeriodo  = 0;
     nHPeriodo  = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO CalFechas;
     aEjer = #dsmow001#0;  || Ejercicio
     nMesF = #dsmow001#1;
     nMesI = #dsmow001#1;
     |SI aPer = "T"; nMesI = #dsmow001#1 - 2; |FINSI;

     aAlfa1 = ("00" + nMesI) % -102;
     aAlfa1 = "01." + aAlfa1 + "." + aEjer;
     fFechaIni = aAlfa1;

     aAlfa1 = ("00" + nMesF) % -102;
     aAlfa2 = "31";
     |SI nMesF = 4; |O nMesF = 6; |O nMesF = 9; |O nMesF = 11;
         aAlfa2 = "30";
     |FINSI;
     |SI nMesF = 2;
         aAlfa2 = "28";
         |SI #dsmow001#0 = 2012; |O #dsmow001#0 = 2016; |O #dsmow001#0 = 2020;
             |O #dsmow001#0 = 2024; |O #dsmow001#0 = 2028; |O #dsmow001#0 = 2032;
             aAlfa2 = "29";
         |FINSI;
     |FINSI;
     aAlfa1 = aAlfa2 + "." + aAlfa1 + "." + aEjer;
     fFechaFin = aAlfa1;
|FPRC;

|PROCESO dsmom008Pas;
     enEmpresa     = #dsmom008#0;
     enEjer        = #dsmom008#1;
     enPeriodo     = #dsmom008#2;
     enModelo      = #dsmom008#3;
     enComplem     = #dsmom008#4;
     enActividad   = #dsmom008#5;

     |SI #dsmom008#12 = "303";
         |SUB_EJECUTA "eospa303;AUTO";
     |FINSI;

     |SI #dsmom008#12 = "310";
         |SUB_EJECUTA "reoz0004;AUTO";
     |FINSI;

|FPRC;

|DEFBUCLE dsmom008Pas;
     #dsmom008#1;
     ;
     #dsmom004#0, #dsmom004#1, #dsmom004#2, #dsmom004#3, #dsmom004#4, 01;
     #dsmom004#0, #dsmom004#1, #dsmom004#2, #dsmom004#3, #dsmom004#4, 99;
     ;
     NULL, dsmom008Pas;
|FIN;

|PROCESO dsmom004Pas;
     |SI #dsmom004#7 = "X";  |ACABA;  |FINSI;

     |SI #dsmom004#3 = "390";
         enEmpresa     = #dsmom004#0;
         enEjer        = #dsmom004#1;
         enPeriodo     = #dsmom004#2;
         enModelo      = #dsmom004#3;
         enComplem     = #dsmom004#4;
         enMasivo      = 1;

         |SUB_EJECUTA "dsmozpas;AUTO";

         |ACABA;
     |FINSI;

     nPasLib = 0;

     |ABRE #eoscabve;
     #eoscabve#0 = #dsmom004#0;
     #eoscabve#4 = #dsmom004#1 - 2000;
     |LEE 000#eoscabve.=;
     |SI FSalida = 0;
         nPasLib = 1;
     |FINSI;
     |CIERRA #eoscabve;

     |ABRE #eoscabco;
     #eoscabco#0 = #dsmom004#0;
     #eoscabco#4 = #dsmom004#1 - 2000;
     |LEE 000#eoscabve.=;
     |SI FSalida = 0;
         nPasLib = 1;
     |FINSI;
     |CIERRA #eoscabco;

     |SI nPasLib = 0;  |ACABA; |FINSI;

     |BUCLE dsmom008Pas;
|FPRC;

|DEFBUCLE dsmom004Pas;
     #dsmom004#1;
     ;
     1,     #dsmow001#0, #dsmow001#1, enModelo, 00;
     99999, #dsmow001#0, #dsmow001#1, enModelo, 00;
     ;
     NULL, dsmom004Pas;
|FIN;

|PROCESO Pase390;
     aPopup1  = -1;
     aPopup2  = 2;
     aPopup3  = "1 El registro seleccionado";
     aPopup4  = "2 Todos los registros sin datos";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     IaPopup  = aPopup3  <-;
     IaPopup  = IaPopup + (FSalida - 1);

     aAlfa = aPopup % 101;

     |SI aAlfa ! "1";  |Y aAlfa ! "2";
         |ACABA;
     |FINSI;

     |SI aAlfa = "1";  enMasivo = 0;  |FINSI;
     |SI aAlfa = "2";  enMasivo = 1;  |FINSI;

     |CONFI "0000NEsta seguro de realizar el pase";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |CONFI "0000SChequear Emision de los Modelos Periodicos.";
     enSwCheq390 = FSalida;

     enModelo      = #dsmom004#3;
     |SI enMasivo = 0;
         enEmpresa     = #dsmom004#0;
         enEjer        = #dsmom004#1;
         enPeriodo     = #dsmom004#2;
         enModelo      = #dsmom004#3;
         enComplem     = #dsmom004#4;
         enMasivo      = 0;

         |SUB_EJECUTA "dsmozpas;AUTO";
     |SINO;
         |BUCLE dsmom004Pas;
     |FINSI;

     |PONCONTROL  23, "SI";
     |PTEC 812;
|FPRC;

|PROCESO dsmom004Arc;
     |SI #dsmom004#9 = " ";  |ACABA;  |FINSI;

     |SI aCampo = " ";
         #dsmom004#13 = "X";
     |SINO;
         #dsmom004#13 = " ";
     |FINSI;

     |GRABA 020#dsmom004.a;
     |LIBERA #dsmom004;
|FPRC;

|DEFBUCLE dsmom004Arc;
     #dsmom004#1;
     ;
     nDEmpresa, #dsmow001#0, #dsmow001#1, enModelo, 00;
     nHEmpresa, #dsmow001#0, #dsmow001#1, enModelo, 00;
     ;
     NULL, dsmom004Arc;
|FIN;

|PROCESO Bajamod01;
     #dsmom008#0  = #dsmom004#0;
     #dsmom008#1  = #dsmom004#1;
     #dsmom008#2  = #dsmom004#2;
     #dsmom008#3  = #dsmom004#3;
     #dsmom008#4  = #dsmom004#4;
     #dsmom008#5  = 00;
|FPRC;

|PROCESO Altamod01;
     #dsmom008#0  = #dsmom004#0;
     #dsmom008#1  = #dsmom004#1;
     #dsmom008#2  = #dsmom004#2;
     #dsmom008#3  = #dsmom004#3;
     #dsmom008#4  = #dsmom004#4;
     #dsmom008#5  = 99;
|FPRC;

|PROCESO QuitaActividad;
     #dsmom008#0  = #dsmom004#0;
     #dsmom008#1  = #dsmom004#1;
     #dsmom008#2  = #dsmom004#2;
     #dsmom008#3  = #dsmom004#3;
     #dsmom008#4  = #dsmom004#4;
     #dsmom008#5  = #eosactiv#1;
     |LEE 101#dsmom008.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #dsmom008#11 ! "SIN DATOS   ";
         |LIBERA #dsmom008;
         |ACABA;
     |FINSI;

     |BORRA 020#dsmom008.a;
     |LIBERA #dsmom008;
|FPRC;

|PROCESO dsmom008Chequeo;
    nBorra = 0;
    #eosactiv#0 = #dsmom008#0;
    #eosactiv#1 = #dsmom008#5;
    #eosactiv#2 = #dsmom004#1 - 2000;
    |LEE 041#eosactiv.=;
    |SI FSalida ! 0;
        nBorra = 1;
    |FINSI;

    |SI #dsmom008#11 = "SIN DATOS   "; |Y nBorra = 1;
         |BORRA 020#dsmom008.a;
    |FINSI;

    |LIBERA #dsmom008;
|FPRC;

|DEFBUCLE dsmom008Chequeo;
     #dsmom008#1;
     ;
     #dsmom004#0, #dsmom004#1, #dsmom004#2, #dsmom004#3, #dsmom004#4, 01;
     #dsmom004#0, #dsmom004#1, #dsmom004#2, #dsmom004#3, #dsmom004#4, 98;
     ;
     NULL, dsmom008Chequeo;
|FIN;

|PROCESO eosactivCheq;
     |SI enModelo = 303;
         |SI #eosactiv#26 = "N";  |O #eosactiv#14 = "S";
             |HAZ QuitaActividad;
             |ACABA;
         |FINSI;

         aPer = #eosactiv#26;
         |SI aPer         = "F";  aPer = "T";  |FINSI;
         |SI aPer         = "D";  aPer = "M";  |FINSI;
         |SI #eosactiv#22 = "A";  aPer = "T";  |FINSI;

         |SI aPer = "T";
             nBorra = 0;
             |SI #dsmow001#1 = 1;  nBorra = 1; |FINSI;
             |SI #dsmow001#1 = 2;  nBorra = 1; |FINSI;
             |SI #dsmow001#1 = 4;  nBorra = 1; |FINSI;
             |SI #dsmow001#1 = 5;  nBorra = 1; |FINSI;
             |SI #dsmow001#1 = 7;  nBorra = 1; |FINSI;
             |SI #dsmow001#1 = 8;  nBorra = 1; |FINSI;
             |SI #dsmow001#1 = 10; nBorra = 1; |FINSI;
             |SI #dsmow001#1 = 11; nBorra = 1; |FINSI;
             |SI nBorra = 1;
                 |HAZ QuitaActividad;
                 |ACABA;
             |FINSI;
         |FINSI;

         |HAZ CalFechas;
         |SI #eosactiv#48 > "01.01.1900"; |Y #eosactiv#48 > fFechaFin;
             |HAZ QuitaActividad;
             |ACABA;
         |FINSI;

         |SI #eosactiv#49 > "01.01.1900"; |Y #eosactiv#49 < fFechaIni;
             |HAZ QuitaActividad;
             |ACABA;
         |FINSI;

         |SI #eosactiv#26 = "D";
             #dsmom004#23 = "S";
         |FINSI;
     |FINSI;

     |SI enModelo = 340;
         |SI #eosactiv#51 = "N";  |O #eosactiv#14 = "S";
             |HAZ QuitaActividad;
             |ACABA;
         |FINSI;

         aPer = #eosactiv#26;
         |SI aPer         = "F";  aPer = "T";  |FINSI;
         |SI aPer         = "D";  aPer = "M";  |FINSI;
         |SI #eosactiv#22 = "A";  aPer = "T";  |FINSI;

         |SI aPer = "T";
             nBorra = 0;
             |SI #dsmow001#1 = 1;  nBorra = 1; |FINSI;
             |SI #dsmow001#1 = 2;  nBorra = 1; |FINSI;
             |SI #dsmow001#1 = 4;  nBorra = 1; |FINSI;
             |SI #dsmow001#1 = 5;  nBorra = 1; |FINSI;
             |SI #dsmow001#1 = 7;  nBorra = 1; |FINSI;
             |SI #dsmow001#1 = 8;  nBorra = 1; |FINSI;
             |SI #dsmow001#1 = 10; nBorra = 1; |FINSI;
             |SI #dsmow001#1 = 11; nBorra = 1; |FINSI;
             |SI nBorra = 1;
                 |HAZ QuitaActividad;
                 |ACABA;
             |FINSI;
         |FINSI;

         |HAZ CalFechas;
         |SI #eosactiv#48 > "01.01.1900"; |Y #eosactiv#48 > fFechaFin;
             |HAZ QuitaActividad;
             |ACABA;
         |FINSI;

         |SI #eosactiv#49 > "01.01.1900"; |Y #eosactiv#49 < fFechaIni;
             |HAZ QuitaActividad;
             |ACABA;
         |FINSI;

     |FINSI;

     #dsmom008#0  = #dsmom004#0;
     #dsmom008#1  = #dsmom004#1;
     #dsmom008#2  = #dsmom004#2;
     #dsmom008#3  = #dsmom004#3;
     #dsmom008#4  = #dsmom004#4;
     #dsmom008#5  = #eosactiv#1;
     |LEE 000#dsmom008.=;
     |SI FSalida ! 0;  |DDEFECTO #dsmom008;  |FINSI;

     |SI #dsmom008#11 ! "SIN DATOS   ";  |ACABA;  |FINSI;

     #dsmom008#0  = #dsmom004#0;
     #dsmom008#1  = #dsmom004#1;
     #dsmom008#2  = #dsmom004#2;
     #dsmom008#3  = #dsmom004#3;
     #dsmom008#4  = #dsmom004#4;
     #dsmom008#5  = #eosactiv#1;
     |LEE 101#dsmom008.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmom008;
         #dsmom008#0  = #dsmom004#0;
         #dsmom008#1  = #dsmom004#1;
         #dsmom008#2  = #dsmom004#2;
         #dsmom008#3  = #dsmom004#3;
         #dsmom008#4  = #dsmom004#4;
         #dsmom008#5  = #eosactiv#1;
         |GRABA 020#dsmom008.b;
     |FINSI;

     |SI enModelo = 303;
         #dsmom008#6  = #eosactiv#6;
         aAlfa        = "REGISTRO DEL MODELO 303 EJERCICIO " + #dsmom008#1;
         aAlfa        = aAlfa + " PERIODO " + (("00" + #dsmom008#2) % -102);
         #dsmom008#8  = aAlfa;
         #dsmom008#11 = "SIN DATOS";

         #dsmom008#12 = 303;
         #dsmom008#7  = "dsmociva";
         |SI #eosactiv#22 = "A";
             #dsmom008#7  = "modulos";
             |SI #eosactiv#41 = "S";
                 #dsmom008#7  = "dsmoc310";
             |FINSI;

             #dsmom008#12 = 310;
         |FINSI;
         #dsmom008#13 = "N";
     |FINSI;

     |SI enModelo = 340;
         #dsmom008#6  = #eosactiv#6;
         aAlfa        = "REGISTRO DEL MODELO 340 EJERCICIO " + #dsmom008#1;
         aAlfa        = aAlfa + " PERIODO " + (("00" + #dsmom008#2) % -102);
         #dsmom008#8  = aAlfa;
         #dsmom008#11 = "SIN DATOS";

         #dsmom008#12 = 340;
         #dsmom008#7  = "dsmo3401";
         #dsmom008#12 = 340;
         #dsmom008#13 = "N";
     |FINSI;

     |GRABA 020#dsmom008.a;
     |LIBERA #dsmom008;
|FPRC;

|DEFBUCLE eosactivCheq;
     #eosactiv#1;
     ;
     #dsmom004#0, 1, nAnyoDos;
     #dsmom004#0, 6, nAnyoDos;
     ;
     NULL, eosactivCheq;
|FIN;

|PROCESO EntraTrabajo;
     |SI #dsmom004#3 = 390;
         #dsmom008#0 = #dsmom004#0;
         #dsmom008#1 = #dsmom004#1;
         #dsmom008#2 = #dsmom004#2;
         #dsmom008#3 = #dsmom004#3;
         #dsmom008#4 = #dsmom004#4;
         #dsmom008#5 = 0;
         #dsmom008#12 = #dsmom004#3;

         enEmpresa     = #dsmom008#0;
         enEjer        = #dsmom008#1;
         enPeriodo     = #dsmom008#2;
         enModelo      = #dsmom008#3;
         enComplem     = #dsmom008#4;
         enActividad   = #dsmom008#5;
         eaComunidad   = #dsmom008#9;
         eaComunero    = #dsmom008#10;
         eaCaptura     = #dsmom008#7;
         eaNombreAct   = #dsmom008#6;
         enModeloEntra = #dsmom008#12;
         eaModeloProg  = #dsmom008#7;   |QBF eaModeloProg;
         enTipoEntrada = 1;

         |HAZ EntraModelo;

         |LEE 101#dsmom004.=;
         |SI FSalida = 0;
             |HAZ ChequeaSituacion;

             |GRABA 020#dsmom004.a;
             |LIBERA #dsmom004;
         |FINSI;
         |ACABA;
     |FINSI;

     |LEE 101#dsmom004.=;
     |SI FSalida = 0;
         |ABRE #eosclien;
         #eosclien#0 = #dsmom004#0;
         |LEE 000#eosclien.=;
         |SI FSalida ! 0;  |DDEFECTO #eosclien;  |FINSI;
         |CIERRA #eosclien;

         #dsmom004#23 = "N";
         #dsmom004#26 = #eosclien#2;

         |BUCLE eosactivCheq;

         |SI #dsmom004#2 = 1;   aPer = "M";  |FINSI;
         |SI #dsmom004#2 = 2;   aPer = "M";  |FINSI;
         |SI #dsmom004#2 = 4;   aPer = "M";  |FINSI;
         |SI #dsmom004#2 = 5;   aPer = "M";  |FINSI;
         |SI #dsmom004#2 = 7;   aPer = "M";  |FINSI;
         |SI #dsmom004#2 = 8;   aPer = "M";  |FINSI;
         |SI #dsmom004#2 = 10;  aPer = "M";  |FINSI;
         |SI #dsmom004#2 = 11;  aPer = "M";  |FINSI;

         #dsmom004#22 = aPer;

         |GRABA 020#dsmom004.a;
         |LIBERA #dsmom004;
     |FINSI;

     |PUSHV 0501 2380;
     |ENTLINEAL #1#dsmom008, -6, 4, 22, 1, Bajamod01, Altamod01;
     |POPV;

     |LEE 101#dsmom004.=;
     |SI FSalida = 0;
         |HAZ ChequeaSituacion;

         |SI enHayTrabajo = 0;
             |BORRA 020#dsmom004.a;
         |SINO;
             |GRABA 020#dsmom004.a;
         |FINSI;
         |LIBERA #dsmom004;
     |FINSI;
|FPRC;

|PROCESO eosactiv;
     |SI enModelo = 303;
         |SI #eosactiv#26 = "N";  |O #eosactiv#14 = "S";
             |HAZ QuitaActividad;
             |ACABA;
         |FINSI;

         aPer = #eosactiv#26;
         |SI aPer        = "F";   aPer = "T";  |FINSI;
         |SI aPer        = "D";   aPer = "M";  |FINSI;
         |SI #eosactiv#22 = "A";  aPer = "T";  |FINSI;

         |SI aPer = "T";
             |SI #dsmow001#1 = 1;  |ACABA;  |FINSI;
             |SI #dsmow001#1 = 2;  |ACABA;  |FINSI;
             |SI #dsmow001#1 = 4;  |ACABA;  |FINSI;
             |SI #dsmow001#1 = 5;  |ACABA;  |FINSI;
             |SI #dsmow001#1 = 7;  |ACABA;  |FINSI;
             |SI #dsmow001#1 = 8;  |ACABA;  |FINSI;
             |SI #dsmow001#1 = 10; |ACABA;  |FINSI;
             |SI #dsmow001#1 = 11; |ACABA;  |FINSI;
         |FINSI;

|| ...tique 2329 1083
         |HAZ CalFechas;
         |SI #eosactiv#48 > "01.01.1900"; |Y #eosactiv#48 > fFechaFin;
             |HAZ QuitaActividad;
             |ACABA;
         |FINSI;

         |SI #eosactiv#49 > "01.01.1900"; |Y #eosactiv#49 < fFechaIni;
             |HAZ QuitaActividad;
             |ACABA;
         |FINSI;

         #dsmom008#0  = #dsmom004#0;
         #dsmom008#1  = #dsmom004#1;
         #dsmom008#2  = #dsmom004#2;
         #dsmom008#3  = #dsmom004#3;
         #dsmom008#4  = #dsmom004#4;
         #dsmom008#5  = #eosactiv#1;
         #dsmom008#6  = #eosactiv#6;
         aAlfa        = "REGISTRO DEL MODELO 303 EJERCICIO " + #dsmom008#1;
         aAlfa        = aAlfa + " PERIODO " + (("00" + #dsmom008#2) % -102);
         #dsmom008#8  = aAlfa;
         #dsmom008#11 = "SIN DATOS";

         #dsmom008#12 = 303;
         #dsmom008#7  = "dsmociva";
         |SI #eosactiv#22 = "A";
             #dsmom008#7  = "modulos";
             |SI #eosactiv#41 = "S";
                 #dsmom008#7  = "dsmoc310";
             |FINSI;

             #dsmom008#12 = 310;
         |FINSI;
         #dsmom008#13 = "N";

         |GRABA 020#dsmom008.n;
         |LIBERA #dsmom008;

         |SI #eosactiv#26 = "D";
             #dsmom004#23 = "S";
         |FINSI;

         nHay = 1;
     |FINSI;

     |SI enModelo = 340;
         |SI #eosactiv#51 = "N";  |O #eosactiv#14 = "S";
             |HAZ QuitaActividad;
             |ACABA;
         |FINSI;

         aPer = #eosactiv#26;
         |SI aPer        = "F";  aPer = "T";  |FINSI;
         |SI aPer        = "D";  aPer = "M";  |FINSI;
         |SI #eosactiv#22 = "A";  aPer = "T";  |FINSI;

         |SI aPer = "T";
             |SI #dsmow001#1 = 1;  |ACABA;  |FINSI;
             |SI #dsmow001#1 = 2;  |ACABA;  |FINSI;
             |SI #dsmow001#1 = 4;  |ACABA;  |FINSI;
             |SI #dsmow001#1 = 5;  |ACABA;  |FINSI;
             |SI #dsmow001#1 = 7;  |ACABA;  |FINSI;
             |SI #dsmow001#1 = 8;  |ACABA;  |FINSI;
             |SI #dsmow001#1 = 10; |ACABA;  |FINSI;
             |SI #dsmow001#1 = 11; |ACABA;  |FINSI;
         |FINSI;

|| ...tique 2329 1083
         |HAZ CalFechas;
         |SI #eosactiv#48 > "01.01.1900"; |Y #eosactiv#48 > fFechaFin;
             |HAZ QuitaActividad;
             |ACABA;
         |FINSI;

         |SI #eosactiv#49 > "01.01.1900"; |Y #eosactiv#49 < fFechaIni;
             |HAZ QuitaActividad;
             |ACABA;
         |FINSI;

         #dsmom008#0  = #dsmom004#0;
         #dsmom008#1  = #dsmom004#1;
         #dsmom008#2  = #dsmom004#2;
         #dsmom008#3  = #dsmom004#3;
         #dsmom008#4  = #dsmom004#4;
         #dsmom008#5  = #eosactiv#1;
         #dsmom008#6  = #eosactiv#6;
         aAlfa        = "REGISTRO DEL MODELO 340 EJERCICIO " + #dsmom008#1;
         aAlfa        = aAlfa + " PERIODO " + (("00" + #dsmom008#2) % -102);
         #dsmom008#8  = aAlfa;
         #dsmom008#11 = "SIN DATOS";

         #dsmom008#12 = 340;
         #dsmom008#7  = "dsmo3401";
         #dsmom008#12 = 340;
         #dsmom008#13 = "N";

         |GRABA 020#dsmom008.n;
         |LIBERA #dsmom008;

         nHay = 1;
     |FINSI;
|FPRC;

|DEFBUCLE eosactiv;
     #eosactiv#1;
     ;
     #eosclien#0, 1, nAnyoDos;
     #eosclien#0, 6, nAnyoDos;
     ;
     NULL, eosactiv;
|FIN;

|PROCESO eosclien;
     |SI enModelo = 390;
         #dsmom004#0  = #eosclien#0;
         #dsmom004#1  = #dsmow001#0;
         #dsmom004#2  = 1;
         #dsmom004#3  = 303;
         #dsmom004#4  = 00;
         |LEE 000#dsmom004.];
         |SI FSalida = 0;  |Y #dsmom004#0  = #eosclien#0;
                           |Y #dsmom004#1  = #dsmow001#0;
                           |Y #dsmom004#3  = 303;
             #dsmom004#0  = #eosclien#0;
             #dsmom004#1  = #dsmow001#0;
             #dsmom004#2  = 99;
             #dsmom004#3  = 390;
             #dsmom004#4  = 00;
             |LEE 000#dsmom004.=;
             |SI FSalida = 0;  |ACABA;  |FINSI;

             |DDEFECTO #dsmom004;
             #dsmom004#0  = #eosclien#0;
             #dsmom004#1  = #dsmow001#0;
             #dsmom004#2  = 99;
             #dsmom004#3  = 390;
             #dsmom004#4  = 00;
             #dsmom004#26 = #eosclien#2;
             #dsmom004#17 = "SIN DATOS";
             #dsmom004#22 = "ANUAL";

             |GRABA 020#dsmom004.n;
             |LIBERA #dsmom004;
         |FINSI;

         |ACABA;
     |FINSI;

     #dsmom004#0  = #eosclien#0;
     #dsmom004#1  = #dsmow001#0;
     #dsmom004#2  = #dsmow001#1;
     #dsmom004#3  = enModelo;
     #dsmom004#4  = 00;
     |LEE 101#dsmom004.=;
     |SI FSalida = 0;
         |SI #dsmom004#13 = "X";  |ACABA;  |FINSI;

         |ABRE #dsmom008;
         |BUCLE eosactivCheq;
         |CIERRA #dsmom008;

         |ABRE #eosactiv;
         |BUCLE dsmom008Chequeo;
         |CIERRA #eosactiv;

         #dsmom004#26 = #eosclien#2;

         |HAZ ChequeaSituacion;

         |SI enHayTrabajo = 0;
             |BORRA 020#dsmom004.a;
         |SINO;
             |GRABA 020#dsmom004.a;
         |FINSI;
         |LIBERA #dsmom004;

         |ACABA;
     |FINSI;

     |DDEFECTO #dsmom004;
     #dsmom004#0  = #eosclien#0;
     #dsmom004#1  = #dsmow001#0;
     #dsmom004#2  = #dsmow001#1;
     #dsmom004#3  = enModelo;
     #dsmom004#4  = 00;
     #dsmom004#26 = #eosclien#2;

     nHay = 0;
     aPer = "T";
     |BUCLE eosactiv;
     |SI nHay = 0;
         |ACABA;
     |FINSI;

     #dsmom004#17 = "SIN DATOS";
     #dsmom004#22 = aPer;

     |GRABA 020#dsmom004.n;
     |LIBERA #dsmom004;

     #dsmom008#0  = #dsmom004#0;
     #dsmom008#1  = #dsmom004#1;
     #dsmom008#2  = #dsmom004#2;
     #dsmom008#3  = #dsmom004#3;
     #dsmom008#4  = #dsmom004#4;
     #dsmom008#5  = 0;
     #dsmom008#6  = "REGISTRO DE IMPRESION";

     |SI enModelo = 303;
         #dsmom008#7  = "dsm30301";
         aAlfa        = "REGISTRO DEL MODELO 303 EJERCICIO " + #dsmom008#1;
         aAlfa        = aAlfa + " PERIODO " + (("00" + #dsmom008#2) % -102);
         #dsmom008#8  = aAlfa;
         #dsmom008#12 = 303;
     |FINSI;

     |SI enModelo = 340;
         #dsmom008#7  = "dsmo3401";
         aAlfa        = "REGISTRO DEL MODELO 340 EJERCICIO " + #dsmom008#1;
         aAlfa        = aAlfa + " PERIODO " + (("00" + #dsmom008#2) % -102);
         #dsmom008#8  = aAlfa;
         #dsmom008#12 = 340;
     |FINSI;

     #dsmom008#11 = "SIN DATOS";
     #dsmom008#13 = "N";

     |GRABA 040#dsmom008.n;
     |LIBERA #dsmom008;
|FPRC;

|DEFBUCLE eosclien;
     #eosclien#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, eosclien;
|FIN;

||///////////////

|PROCESO FormaPago;
     |PUSHV 0501 2380;

     |ABRE #eosdaban;
     #eosdaban#0 = #dsmom004#0;
     |LEE 101#eosdaban.=;
     |SI FSalida ! 0;
         |DDEFECTO #eosdaban;
         #eosdaban#0 = #dsmom004#0;
         |GRABA 020#eosdaban.b;
     |FINSI;

     |PINPA #0#eosdaban;

     |C_V #eosdaban#14, 1, "S";
     |C_M #eosdaban#14, 1, "S";
     |PINTA 2017, "Forma de pago .:";

     |PINDA #0#eosdaban;
     |ENDATOS #2#eosdaban;
     |SI FSalida = 0;
         |GRABA 020#eosdaban.a;
     |FINSI;
     |LIBERA #eosdaban;
     |CIERRA #eosdaban;

     |POPV;
|FPRC;

|PROCESO Complementaria;
     |PUSHV 0501 2380;
     #dsmow116#0 = #dsmom004#21;
     #dsmow116#1 = #dsmom004#20;
     #dsmow116#2 = #dsmom004#27;
     #dsmow116#3 = #dsmom004#24;
     #dsmow116#4 = #dsmom004#24;
     #dsmow116#5 = #dsmom004#9;
     #dsmow116#6 = #dsmom004#13;
     |SI #dsmow116#3 = " "; #dsmow116#3 = "N"; |FINSI;

     |C_M #dsmow116#2, 1, "S";
     |SI #dsmom004#3 = 390;
         |C_M #dsmow116#2, 1, "N";
     |FINSI;

     |PINPA #0#dsmow116;
     |PINDA #0#dsmow116;
     |ENDATOS #1#dsmow116;
     |SI FSalida = 0;
         |LEE 101#dsmom004.=;
         |SI FSalida = 0;
             #dsmom004#20 = #dsmow116#1;
             #dsmom004#21 = #dsmow116#0;
             #dsmom004#27 = #dsmow116#2;
             #dsmom004#24 = #dsmow116#4;
             #dsmom004#9  = #dsmow116#5;
             #dsmom004#13 = #dsmow116#6;
             |SI #dsmom004#9  ! "S"; #dsmom004#10 = "01.01.0000"; |FINSI;
             |SI #dsmom004#13 ! "S"; #dsmom004#14 = "01.01.0000"; |FINSI;
             |GRABA 020#dsmom004.a;
             |LIBERA #dsmom004;
         |FINSI;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO Tipo11mom004;  |TIPO 11;
     nTecla = FSalida;

     enEmpresa     = #dsmom004#0;
     enEjer        = #dsmom004#1;
     enPeriodo     = #dsmom004#2;
     enModelo      = #dsmom004#3;
     enComplem     = #dsmom004#4;

     |SI nTecla = 18;
         |CONFI "0000NEsta seguro que quiere realizar el proceso";
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |PUSHV 0501 2380;

         |BLANCO 1420 1660;
         |CUADRO 1420 1660;
         |PINTA 1522, "Procesando datos ...";

         |BUCLE eosclien;

         |POPV;

         |PTEC 812;
         |PONCONTROL  23, "SI";
     |FINSI;

     |SI nTecla = 10;
         |ABRE #dsmom008;
         #dsmom008#0 = #dsmom004#0;
         #dsmom008#1 = #dsmom004#1;
         #dsmom008#2 = #dsmom004#2;
         #dsmom008#3 = #dsmom004#3;
         #dsmom008#4 = #dsmom004#4;
         #dsmom008#5 = 0;
         |LEE 040#dsmom008.=;
         |SI FSalida ! 0;
             |DDEFECTO #dsmom008;
             #dsmom008#0  = #dsmom004#0;
             #dsmom008#1  = #dsmom004#1;
             #dsmom008#2  = #dsmom004#2;
             #dsmom008#3  = #dsmom004#3;
             #dsmom008#4  = #dsmom004#4;
             #dsmom008#5  = 0;
             #dsmom008#12 = #dsmom004#3;
         |FINSI;
         |CIERRA #dsmom008;

         enEmpresa     = #dsmom008#0;
         enEjer        = #dsmom008#1;
         enPeriodo     = #dsmom008#2;
         enModelo      = #dsmom008#3;
         enComplem     = #dsmom008#4;
         enActividad   = #dsmom008#5;
         eaComunidad   = #dsmom008#9;
         eaComunero    = #dsmom008#10;
         eaCaptura     = #dsmom008#7;
         eaNombreAct   = #dsmom008#6;
         enModeloEntra = #dsmom008#12;
         eaModeloProg  = #dsmom008#7;   |QBF eaModeloProg;
         enTipoEntrada = 4;

         |HAZ EntraModelo;

         |ERROR;
     |FINSI;

     |SI nTecla = 11;
         |SI #dsmom004#13 = "X";
             |MENAV "0000Registro archivado.";
             |ACABA;
         |FINSI;

         |SI #dsmom004#9 = "X";
             |CONFI "0000NRegistro impreso, se dejara no impreso, quiere continuar.";
             |SI FSalida ! 0;   |ACABA;  |FINSI;

             |LEE 101#dsmom004.=;
             |SI FSalida = 0;
                 #dsmom004#9  = "";
                 #dsmom004#10 = "01.01.0000";
                 #dsmom004#19 = "";
                 #dsmom004#25 = "";
                 |GRABA 020#dsmom004.a;
                 |LIBERA #dsmom004;
             |FINSI;
         |FINSI;

         |HAZ EntraTrabajo;
     |FINSI;

     |SI nTecla = 12;  |Y nSwBtnF4 = 1;
         |SI #dsmom004#3 = 390;
             |HAZ Pase390;
             |ACABA;
         |FINSI;

         |SI #dsmom004#3 ! 390;
             |MENAV "0000Se realizara el pase desde libro de aquellas empresas con libros y sin datos";
             |CONFI "0000NEsta seguro";
         |FINSI;

         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |BUCLE dsmom004Pas;

         |PONCONTROL  23, "SI";
         |PTEC 812;
     |FINSI;

     |SI nTecla = 13;  |Y nSwBtnF5 = 1;
         |CONFI "0000NSeguro que quiere cambiar la forma de devolucion";
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         aAlfa1 = "";
         |ABRE #eosactiv;
         |PARA nPara1 = 1; |SI nPara1 [ 6; |HACIENDO nPara1 = nPara1 + 1;
               #eosactiv#0 = #dsmom004#0;
               #eosactiv#1 = nPara1;
               #eosactiv#2 = #dsmom004#1 - 2000;
               |LEE 101#eosactiv.=;
               |SI FSalida = 0;

                   |SI aAlfa1 = "";
                       |SI #eosactiv#27 = "C";
                           #eosactiv#27 = "D";
                       |SINO;
                           #eosactiv#27 = "C";
                       |FINSI;
                       aAlfa1 = #eosactiv#27;
                   |FINSI;
                   #eosactiv#27 = aAlfa1;
                   |GRABA 020#eosactiv.a;
                   |LIBERA #eosactiv;
               |FINSI;
          |SIGUE;
         |CIERRA #eosactiv;

         enEmpresa     = #dsmom004#0;
         enEjer        = #dsmom004#1;
         enPeriodo     = #dsmom004#2;
         enModelo      = #dsmom004#3;
         enComplem     = #dsmom004#4;
         enActividad   = 0;
         enExistencia  = 0;
         enTipoEntrada = 98;

         aParametro = ("00000" + enEmpresa) % -105;
         aParametro = aParametro + ("0000" + enEjer) % -104;
         aParametro = aParametro + ("00" + enPeriodo) % -102;
         aParametro = aParametro + ("000" + enModelo) % -103;
         aParametro = aParametro + ("00" + enComplem) % -102;
         aParametro = aParametro + ("00" + enActividad) % -102;
         aParametro = aParametro + ("00" + enTipoEntrada) % -102;
         aParametro = aParametro + ("0" + enExistencia) % -101;

         aAlfa = "dsm30301;" + aParametro;
         |SUB_EJECUTA_NP aAlfa;

         |ERROR;
     |FINSI;

     |SI nTecla = 15;  |Y nSwBtnF7 = 1;
         |PUSHV 0501 2380;

         #dsmow115#0 = #dsmom004#25;
         #dsmow115#1 = #dsmom004#19;

         |PINPA #0#dsmow115;
         |PINDA #0#dsmow115;
         |ENDATOS #1#dsmow115;
         |SI FSalida = 0;
             |LEE 101#dsmom004.=;
             |SI FSalida = 0;
                 #dsmom004#19 = #dsmow115#1;
                 #dsmom004#25 = #dsmow115#0;
                 |GRABA 020#dsmom004.a;
                 |LIBERA #dsmom004;
             |FINSI;
         |FINSI;
         |POPV;
         |ERROR;
     |FINSI;

     |SI nTecla = 25;  |Y nSwBtnF17 = 1;
         |HAZ Complementaria;
         |ERROR;
     |FINSI;

     |SI nTecla = 16;  |Y nSwBtnF8 = 1;
         |MENAV "0000Se dejara como archivado el/los registros impresos";

         aPopup1  = -1;
         aPopup2  = 2;
         aPopup3  = "1 Archivar el registro";
         aPopup4  = "2 Archivar todos los registros";

         IaPopup  = aPopup1  <-;
         |ESPECIFICA "TRACKPOPUP", aPopup;
         |SI FSalida ! 0;
             IaPopup  = aPopup3  <-;
             IaPopup  = IaPopup + (FSalida - 1);

             aAlfa = aPopup % 101;

             |SI aAlfa ! "1";  |Y aAlfa ! "2";
                 |ACABA;
             |FINSI;

             |SI aAlfa = "1";
                 aCampo    = " ";
                 nDEmpresa = #dsmom004#0;
                 nHEmpresa = #dsmom004#0;
             |FINSI;

             |SI aAlfa = "2";
                 aCampo    = " ";
                 nDEmpresa = 00001;
                 nHEmpresa = 99999;
             |FINSI;

             |CONFI "0000NEsta seguro";
             |SI FSalida ! 0;  |ACABA;  |FINSI;

             |BUCLE dsmom004Arc;

             |PONCONTROL  23, "SI";
             |PTEC 812;
         |FINSI;
     |FINSI;

     |SI nTecla = 14;  |Y nSwBtnF6 = 1;
         |SI #dsmom004#7 = "X";
             |SI #dsmom004#13 = "X";
                 |CONFI "0000NModelo Archivado. Desea continuar";
                 |SI FSalida ! 0;  |ACABA;  |FINSI;
             |SINO;
                 aAlfa = #dsmom004#19 + #dsmom004#25;  |QBF aAlfa;
                 |SI aAlfa ! "";
                     |CONFI "0000NEl modelo tiene codigo de justificante o codigo electronico. Continuamos";
                     |SI FSalida ! 0;  |ACABA;  |FINSI;
                 |FINSI;
             |FINSI;

             |LEE 101#dsmom004.=;
             eaCamp4_9    = #dsmom004#9;
             efCamp4_10   = #dsmom004#10;
             eaCamp4_19   = #dsmom004#19;
             eaCamp4_25   = #dsmom004#25;
             #dsmom004#9  = "";
             #dsmom004#10 = "01.01.0000";
             #dsmom004#19 = "";
             #dsmom004#25 = "";
             |GRABA 020#dsmom004.a;
             |LIBERA #dsmom004;

             enInfComp = 0;
             |SUB_EJECUTA_NP "dsmoy000;PLANING";
             |SI enInfComp = 1;
                 |LEE 101#dsmom004.=;
                 #dsmom004#9  = eaCamp4_9;
                 #dsmom004#10 = efCamp4_10;
                 #dsmom004#19 = eaCamp4_19;
                 #dsmom004#25 = eaCamp4_25;
                 |GRABA 020#dsmom004.a;
                 |LIBERA #dsmom004;
             |FINSI;
             |HAZ Refresco;
         |FINSI;
     |FINSI;

     |SI nTecla = 30;  |Y nSwBtnF22 = 1;
         |SI #dsmom004#7 = "X";
             |SUB_EJECUTA_NP "dsmoy000;INFC";
             |HAZ Refresco;
         |FINSI;
     |FINSI;

     |SI nTecla = 17;  |Y nSwBtnF9 = 1;
         |MENAV "0000Se dejara como desarchivado el/los registros archivados";

         aPopup1  = -1;
         aPopup2  = 2;
         aPopup3  = "1 Desarchivar el registro";
         aPopup4  = "2 Desarchivar todos los registros";

         IaPopup  = aPopup1  <-;
         |ESPECIFICA "TRACKPOPUP", aPopup;
         |SI FSalida ! 0;
             IaPopup  = aPopup3  <-;
             IaPopup  = IaPopup + (FSalida - 1);

             aAlfa = aPopup % 101;

             |SI aAlfa ! "1";  |Y aAlfa ! "2";
                 |ACABA;
             |FINSI;

             |SI aAlfa = "1";
                 aCampo    = "X";
                 nDEmpresa = #dsmom004#0;
                 nHEmpresa = #dsmom004#0;
             |FINSI;

             |SI aAlfa = "2";
                 aCampo    = "X";
                 nDEmpresa = 00001;
                 nHEmpresa = 99999;
             |FINSI;

             |CONFI "0000NEsta seguro";
             |SI FSalida ! 0;  |ACABA;  |FINSI;

             |BUCLE dsmom004Arc;

             |PONCONTROL  23, "SI";
             |PTEC 812;
         |FINSI;
     |FINSI;

     |SI nSwBtnF12 = 1;
         |SI nTecla = 9;  |O nTecla = 20;
             |HAZ FormaPago;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo7mom004;  |TIPO 7;
     nSwBtnF5  = 0;  |ESTADO_CONTROL nBtnF5,  "DISABLE";
     nSwBtnF6  = 0;  |ESTADO_CONTROL nBtnF6,  "DISABLE";
     nSwBtnF22 = 0;  |ESTADO_CONTROL nBtnF22, "DISABLE";
     nSwBtnF7  = 0;  |ESTADO_CONTROL nBtnF7,  "DISABLE";
     nSwBtnF17 = 0;  |ESTADO_CONTROL nBtnF17, "DISABLE";

     |SI #dsmom004#3 = 303;
         |SI #dsmom004#15 < 0;
             |SI #dsmom004#23 = "N";
                 |SI #dsmom004#2 = 12;
                     nSwBtnF5 = 1;  |ESTADO_CONTROL nBtnF5, "ENABLE";
                 |FINSI;
             |SINO;
                 nSwBtnF5 = 1;  |ESTADO_CONTROL nBtnF5, "ENABLE";
             |FINSI;
         |FINSI;
     |FINSI;

     |PINTA 0751, "컫컴컴컴컴컴컴";
     |SI #dsmom004#7 = "X";
         nSwBtnF6 = 1;  |ESTADO_CONTROL nBtnF6, "ENABLE";
         |SI #dsmom004#3 = 303;
             nSwBtnF22 = 1;  |ESTADO_CONTROL nBtnF22, "ENABLE";
         |FINSI;
         nSwBtnF17 = 1;  |ESTADO_CONTROL nBtnF17, "ENABLE";
         |SI #dsmom004#24 = "S";
             |ATRI P; |PINTA 0751, "Complementaria"; |ATRI 0;
         |FINSI;
     |FINSI;

     |SI #dsmom004#9 = "X";
         nSwBtnF7 = 1;  |ESTADO_CONTROL nBtnF7, "ENABLE";
     |FINSI;
|FPRC;

|PROCESO BtnF10;
     |PTEC 832;
|FPRC;

|PROCESO BtnF2;
     |PTEC 824;
|FPRC;

|PROCESO BtnF3;
     |PTEC 825;
|FPRC;

|PROCESO BtnF4;
     |PTEC 826;
|FPRC;

|PROCESO BtnF5;
     |PTEC 827;
|FPRC;

|PROCESO BtnF6;
     |PTEC 828;
|FPRC;

|PROCESO BtnF7;
     |PTEC 829;
|FPRC;

|PROCESO BtnF8;
     |PTEC 830;
|FPRC;

|PROCESO BtnF9;
     |PTEC 831;
|FPRC;

|PROCESO BtnF12;
     |PTEC 834;
|FPRC;

|PROCESO BtnF17;
     |PTEC 839;
|FPRC;

|PROCESO BtnF22;
     |PTEC 844;
|FPRC;

|PROCESO Bajamod00;
     #dsmom004#0  = nDSEmpresa;
     #dsmom004#1  = #dsmow001#0;
     #dsmom004#2  = nDPeriodo;
     #dsmom004#3  = enModelo;
     #dsmom004#4  = 00;
|FPRC;

|PROCESO Altamod00;
     #dsmom004#0  = nHSEmpresa;
     #dsmom004#1  = #dsmow001#0;
     #dsmom004#2  = nHPeriodo;
     #dsmom004#3  = enModelo;
     #dsmom004#4  = 99;
|FPRC;

|PROGRAMA;

     |SI PARAMETRO = "303PLANING";
         #dsmow001#0 = enEjer;
         #dsmow001#1 = enPeriodo;
         enModelo = 303;
         nAnyoDos = #dsmow001#0 - 2000;

         |PUSHV 0501 2380;

         |BLANCO 1420 1660;
         |CUADRO 1420 1660;
         |PINTA 1522, "Procesando datos ...";

         |BUCLE eosclien;

         |POPV;
         |ACABA;
     |FINSI;

     |PINPA #0#dsmow001;

     aAlfa = "ENTRADA MODELO " + PARAMETRO;
     |ATRI R;
     |PINTA 0602, aAlfa;
     |ATRI r;

     enModelo = PARAMETRO;

     fFecha = ~;
     aAlfa  = fFecha;
     aAlfa1 = aAlfa % 402;
     aAlfa2 = aAlfa % -104;
     #dsmow001#0 = aAlfa2;
     #dsmow001#1 = aAlfa1;
     #dsmow001#1 = #dsmow001#1 - 1;
     |SI #dsmow001#1 = 0;
         #dsmow001#1 = 12;
         #dsmow001#0 = #dsmow001#0 - 1;
     |FINSI;

     |C_M #dsmow001#1, 1, "S";
     |SI enModelo = 390;
         #dsmow001#1 = 99;
         |C_M #dsmow001#1, 1, "N";
     |FINSI;

     |PINDA #0#dsmow001;
     |ENDATOS #1#dsmow001;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nAnyoDos = #dsmow001#0 - 2000;

     |SELECT #3#dsmom004;
     #dsmom004#1  = #dsmow001#0;
     #dsmom004#2  = #dsmow001#1;
     #dsmom004#3  = enModelo;
     |LEE 000#dsmom004.];
     |SI FSalida ! 0;  |O  #dsmom004#1 ! #dsmow001#0;
                       |O  #dsmom004#2 ! #dsmow001#1;
                       |O  #dsmom004#3 ! enModelo;
         |MENAV "0000Bandeja vacia, se va a procesar los datos";

         |PUSHV 0501 2380;

         |SELECT #1#dsmom004;

         |BLANCO 1420 1660;
         |CUADRO 1420 1660;
         |PINTA 1522, "Procesando datos ...";

         |BUCLE eosclien;

         |POPV;
     |FINSI;

     |SELECT #1#dsmom004;

     |CONTROL_SIMPLE 0, "BOTON,F10 Cargar bandeja", 0567, 0580, BtnF10;
     nBtnF10 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,F2 Consulta modelo", 0667, 0680, BtnF2;
     nBtnF2 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,F3 Entrada de datos", 0767, 0880, BtnF3;
     nBtnF3 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,F4 Pase de datos ", 0967, 1080, BtnF4;
     nBtnF4 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,F5 Compensar/Devolver", 1167, 1280, BtnF5;
     nBtnF5 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,F6 Emision registro", 1367, 1480, BtnF6;
     nBtnF6 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,F7 Justif./Cod.Electronico", 1567, 1680, BtnF7;
     nBtnF7 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,Ctrl + F7 Complementaria", 1767, 1880, BtnF17;
     nBtnF17 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,F8 Archivar", 1967, 1980, BtnF8;
     nBtnF8 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,F9 Desarchivar", 2067, 2080, BtnF9;
     nBtnF9 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,F12 Forma de pago", 2167, 2180, BtnF12;
     nBtnF12 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON, Inf.Comprobacion", 2267, 2280, BtnF22;
     nBtnF22 = FSalida;

     nSwBtnF4  = 1;
     nSwBtnF8  = 1;
     nSwBtnF9  = 1;
     nSwBtnF12 = 1;

     |SI enModelo = 340;
         nSwBtnF4 = 0;

         |ESTADO_CONTROL nBtnF4, "DISABLE";
     |FINSI;

     nDSEmpresa = 00001;       nHSEmpresa = 99999;
     nDPeriodo  = #dsmow001#1; nHPeriodo = #dsmow001#1;

     |ENTLINEAL #1#dsmom004, -1, 4, 22, 1, Bajamod00, Altamod00;

     |FIN_CONTROL_WINDOWS nBtnF10;
     |FIN_CONTROL_WINDOWS nBtnF2;
     |FIN_CONTROL_WINDOWS nBtnF3;
     |FIN_CONTROL_WINDOWS nBtnF4;
     |FIN_CONTROL_WINDOWS nBtnF5;
     |FIN_CONTROL_WINDOWS nBtnF6;
     |FIN_CONTROL_WINDOWS nBtnF7;
     |FIN_CONTROL_WINDOWS nBtnF17;
     |FIN_CONTROL_WINDOWS nBtnF8;
     |FIN_CONTROL_WINDOWS nBtnF9;
     |FIN_CONTROL_WINDOWS nBtnF12;
     |FIN_CONTROL_WINDOWS nBtnF22;
|FPRO;

|PROCESO dsmom004Cheq303;
     #dsm30301#0 = #dsmom004#0;
     #dsm30301#1 = #dsmom004#1;
     #dsm30301#2 = #dsmom004#2;
     #dsm30301#3 = #dsmom004#3;
     #dsm30301#4 = #dsmom004#4;
     #dsm30301#5 = 0;
     |LEE 000#dsm30301.=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     enEmpresa     = #dsmom004#0;
     enEjer        = #dsmom004#1;
     enPeriodo     = #dsmom004#2;
     enModelo      = #dsmom004#3;
     enComplem     = #dsmom004#4;
     enActividad   = 0;
     enExistencia  = 0;
     enTipoEntrada = 98;

     aParametro = ("00000" + enEmpresa) % -105;
     aParametro = aParametro + ("0000" + enEjer) % -104;
     aParametro = aParametro + ("00" + enPeriodo) % -102;
     aParametro = aParametro + ("000" + enModelo) % -103;
     aParametro = aParametro + ("00" + enComplem) % -102;
     aParametro = aParametro + ("00" + enActividad) % -102;
     aParametro = aParametro + ("00" + enTipoEntrada) % -102;
     aParametro = aParametro + ("0" + enExistencia) % -101;

     aAlfa = "dsm30301;" + aParametro;
     |SUB_EJECUTA_NP aAlfa;
|FPRC;

|DEFBUCLE dsmom004Cheq303;
     #dsmom004#4;
     ;
     "X", 00001, 0000, 00, 303, 00;
     "X", 99999, 9999, 99, 303, 99;
     ;
     NULL, dsmom004Cheq303;
|FIN;

|PROCESO Tipo80mom004;  |TIPO 80;
     |ABRET #dsmom004;
     |ABRET #dsmom008;

     enModelo = PARAMETRO;
     |SI enModelo = 303;
         |ABRE #dsm30301;
         |BUCLE dsmom004Cheq303;
         |CIERRA #dsm30301;
     |FINSI;
|FPRC;

|PROCESO Tipo90mom004;  |TIPO 90;
     |CIERRAT #dsmom004;
     |CIERRAT #dsmom008;
|FPRC;
