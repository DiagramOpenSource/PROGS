|FICHEROS;
     eosy0008 #0;
     dsmoy000;
     eosclien #1;
     eosdaban #2;
     eoshacie #3;
     eosm0028 #28;
     eosm0030 #30;
     eosm0033 #33;
     eosm0133 #133;

     dsmow652 #652;
|FIN;

|VARIABLES;
     nPeriodo     = 0;
     nCampoD      = 0;
     aLLeno40     = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     aVacio40     = "                                        ";
     aAlfa        = "";
     aCadena      = "";
     aLong        = "";
     aCaracter    = "";
     nLong        = 0;
     nPos         = 0;
     nCont        = 0;
     nConver      = 0;
     nHandlePortal= 0;
     nCampo       = 0;

     aDirOri  = "";
     aDirDes  = "";
     aOrigen  = "";
     aDestino = "";

     &enEmpresa   = 0;
     &enEjercic   = 0;
     &dia         = "";
     &mes         = "";
     &anyo        = "";

     nNeg = 0;
     Calc         = 0;
     Calc1        = 0;
     Calc2        = 0;
     TipoDato     = "";
     Long         = 0;
     LongDec      = 0;
     Comodin      = "";
     Comodin1     = "";
     Comodin2     = "";
     Vacio1       = "";
     Vacio2       = "";
     nTecla              = 0;

     &EURODB    = 0;

     {-1}aMoneda   = "";
         aMoneda1  = "LEER";
         aMoneda2  = "";

     aJusti = "";

     aAbre        = "";
     aModelos     = "";

     nHandle1     = 0;
     nHandle2     = 0;
     nSwHay       = 0;
     nTCampo      = 0;

     aAlfa1       = "";
     aUnidad      = "";
     aIPRemoto    = "";
     aPathInter   = "";
     aTipo        = "";
     aAbrePortal  = "";

  {1}aContiene    = "";

     &eaFOrigen   = "";
     &eaFDestino  = "";
     &eaInternet  = "";
     &eaImpresora = "";
     &enNume      = 0;
     &eaAlfa      = "";
     &eaDiaB      = "";
     &eaMesB      = "";
     &eaAnyoB     = "";
     &se_empre    = 0;
     &se_ejerc    = 0;
     &se_perio    = 0;
     &se_tipos    = 0;
     &se_activ    = 0;
     &se_impor    = 0;
     &se_fecha    = "";
     &se_factu    = "";

     nBoton1           = 0;
     nBoton2           = 0;
     nBoton3           = 0;
     nBoton4           = 0;
     nBoton5           = 0;
     aFichero          = "";
     aBue              = "";
     aF2               = "";
     aF3               = "";
     aF4               = "";
     aF5               = "";
     aF6               = "";
     aTecla            = "";
     &eaPathEmision    = "";
     &eaPathModelo     = "";
     &eaFichError      = "";
     &eaFichDatos      = "";
     &eaFichAuxil      = "";
     &eaForzExplorador = "";
     &enValidacion     = 0;
     &enBuenos         = 0;
     &eaPeriodo        = "";
     &eaPer            = "";
     &enMod            = 0;

     &eaPathLanza        = "";
     &eaPathExplorador   = "";
     &eaPathInternet     = "";
     &eaPathAEAT         = "";
     &eaFicheroPlano     = "";
     &eaFicheroSalid     = "";
     &eaFicheroImpre     = "";
     &eaFicheroError     = "";
     &eaOpcion           = "";
     &eaNomEmpresa       = "";
     &eaUnidad           = "";
     &enAnyos            = 0;
     &enPresentar        = 0;
     &enErrorPortal      = 0;
     &enTecla            = 0;
     &enPeriodo          = 0;
     &eaEjer             = "";
     &eaModelos          = "";
     &enHandlePortal     = 0;
|FIN;

|PROCESO VarVacia;
     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + aTipo + &34 + " value=" + &34 + &34 + " />";
     |HAZ GrabaPortal;
|FPRC;

|PROCESO Portal110_02;
     |PUSHV 0501 2380;
     |BLANCO 0501 2380;
     |CUADRO 0501 2380;

     aAlfa = "Conectandose a la pagina  de la aeat.";
     |PINTA 1210, aAlfa;

     aAbrePortal = eaPathEmision + "portal111.html";
     |XABRE "WB", aAbrePortal, nHandlePortal;

     eaAlfa = "<!DOCTYPE HTML PUBLIC " + &34 + "-//W3C//DTD HTML 4.01 Transitional//EN" + &34;
     |HAZ GrabaPortal;

     eaAlfa = &34 + "http://www.w3.org/TR/html4/loose.dtd" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "<html>";
     |HAZ GrabaPortal;

     eaAlfa = "<head>";
     |HAZ GrabaPortal;

     eaAlfa = "<title>Documento sin t&iacute;tulo</title>";
     |HAZ GrabaPortal;

     eaAlfa = "<meta http-equiv=" + &34 + "Content-Type" + &34 + " content=" + &34 + "text/html; charset=iso-8859-1" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "</head>";
     |HAZ GrabaPortal;

     eaAlfa = "";  |HAZ GrabaPortal;

     eaAlfa = "<script language=" + &34 + "javascript" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "     function carga()";
     |HAZ GrabaPortal;

     eaAlfa = "     {";
     |HAZ GrabaPortal;

     eaAlfa = "          document.form1.submit();";
     |HAZ GrabaPortal;

     eaAlfa = "     }";
     |HAZ GrabaPortal;

     eaAlfa = "</script>";
     |HAZ GrabaPortal;

     eaAlfa = "";  |HAZ GrabaPortal;

     eaAlfa = "<body onload=" + &34 + "javascript:carga();" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "<form method=" + &34 + "POST" + &34 + " action=" + &34 + "https://www2.agenciatributaria.gob.es/es13/l/zi21zilk0021" + &34 + " name=" + &34 + "form1" + &34 + " id=" + &34 + "form1" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "HID" + &34 + " value=" + &34 + "IE11110B" + &34 + " />";
     |HAZ GrabaPortal;

     aTipo = "N";
     |SI #eosm0133#28 > 0;
         aTipo = "I";
     |FINSI;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "TIA" + &34 + " value=" + &34 + aTipo + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "NDC" + &34 + " value=" + &34 + #dsmow652#7 + &34 + " />";
     |HAZ GrabaPortal;

     aTipo = "NRC";  |HAZ VarVacia;

     |SI #eosm0133#28 > 0;
         eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "ING" + &34 + " value=" + &34 + #eosm0133#28 + &34 + " />";
         |HAZ GrabaPortal;
     |SINO;
         aTipo = "ING";  |HAZ VarVacia;
     |FINSI;

     aTipo = "NRR";  |HAZ VarVacia;
     aTipo = "ICO";  |HAZ VarVacia;
     aTipo = "NR1";  |HAZ VarVacia;
     aTipo = "IN1";  |HAZ VarVacia;
     aTipo = "NR2";  |HAZ VarVacia;
     aTipo = "IN2";  |HAZ VarVacia;
     aTipo = "NR3";  |HAZ VarVacia;
     aTipo = "IN3";  |HAZ VarVacia;
     aTipo = "NR4";  |HAZ VarVacia;
     aTipo = "IN4";  |HAZ VarVacia;
     aTipo = "NR5";  |HAZ VarVacia;
     aTipo = "IN5";  |HAZ VarVacia;
     aTipo = "NR6";  |HAZ VarVacia;
     aTipo = "IN6";  |HAZ VarVacia;
     aTipo = "NR7";  |HAZ VarVacia;
     aTipo = "IN7";  |HAZ VarVacia;
     aTipo = "CMN";  |HAZ VarVacia;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "LOT" + &34 + " value=" + &34 + "0" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "IDI" + &34 + " value=" + &34 + "ES" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "LEV" + &34 + " value=" + &34 + "000000000000" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "F01" + &34 + " value=" + &34 + "<T1110" + #dsmow652#9 + "0A0000><AUX>";
     |HAZ GrabaPortalSin;

     eaAlfa = " " * 150;
     |HAZ GrabaPortalSin;
     |HAZ GrabaPortalSin;

     eaAlfa = "</AUX><VECTOR>001FIN";
     |HAZ GrabaPortalSin;

     eaAlfa = " " * 200;
     |HAZ GrabaPortalSin;

     eaAlfa = " " * 94;
     |HAZ GrabaPortalSin;

     eaAlfa = "</VECTOR>";
     |HAZ GrabaPortalSin;

     |PARA nCampo = 1;  |SI nCampo [ 56;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #dsmow652#nCampo#;
           |XGRABA nHandlePortal, eaAlfa;
     |SIGUE;

     eaAlfa = "</T1110" + #dsmow652#9 + "0A0000>" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "PUN" + &34 + " value=" + &34 + "00000000" + &34 + " />";
     |HAZ GrabaPortal;

     aTipo = "TXT";  |HAZ VarVacia;
     aTipo = "FIR";  |HAZ VarVacia;

     aTipo = "F";
     |SI #dsmow652#41 ! "    ";
         aTipo = #dsmow652#41;
     |FINSI;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "FIN" + &34 + " value=" + &34 + aTipo + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "EJF" + &34 + " value=" + &34 + #dsmow652#9 + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "MOD" + &34 + " value=" + &34 + "111" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "PRG" + &34 + " value=" + &34 + "EWLINKQM" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "";  |HAZ GrabaPortal;
     eaAlfa = "";  |HAZ GrabaPortal;

     eaAlfa = "</form>";   |HAZ GrabaPortal;
     eaAlfa = "</body>";   |HAZ GrabaPortal;
     eaAlfa = "</html>";   |HAZ GrabaPortal;

     |XCIERRA nHandlePortal;

     eaFOrigen  = aAbrePortal;
     eaFDestino = eaPathModelo + "portal111.html";
     |HAZ CopiaFicheroPtl;

     eaForzExplorador = "N";
     |HAZ Explorador;

     aContiene = "";
     |ESPECIFICA "RBASS", aContiene;
     aUnidad = aContiene1 % 102;

     |SI eaPathExplorador ! "";
         eaAlfa = eaPathExplorador + " " + aUnidad + eaFDestino;
     |SINO;
         eaAlfa = aUnidad + eaFDestino;
     |FINSI;

     |HAZ ConvierteBarra;

     eaAlfa  = "cmd " + &34 + "/c START /WAIT " + eaAlfa + &34;

     |RSYSTEM eaAlfa;

     |FBORRA eaFOrigen;
     |RFBORRA eaFDestino;

     |POPV;
|FPRC;

|PROCESO AbrePagina;
     eaPathAEAT = eaUnidad   + "\AEAT";        |RMKDIR eaPathAEAT;
     eaPathAEAT = eaPathAEAT + "\" + #dsmoy000#0;  |RMKDIR eaPathAEAT;
     eaPathAEAT = eaPathAEAT + "\" + #dsmoy000#6;  |RMKDIR eaPathAEAT;
     |SI #dsmoy000#4 ! 99;
         eaPathAEAT = eaPathAEAT + "\" + (("00" + #dsmoy000#4) % -102);  |RMKDIR eaPathAEAT;
     |FINSI;
     eaPathAEAT = eaPathAEAT + "\";

     eaFOrigen  = eaPathEmision  + eaFicheroPlano;
     eaFDestino = eaPathAEAT + eaFicheroPlano;
     |HAZ CopiaFicheroPtl;

     |DBASE aAlfa;  |QBT aAlfa;
     eaFOrigen  = aAlfa + "hacienda/wait.exe";
     eaFDestino = eaPathAEAT + "wait.exe";
     |HAZ CopiaFicheroPtl;

     eaForzExplorador = "N";
     |HAZ Explorador;

     aAbre = eaPathAEAT + "imp" + Usuario + ".bat";
     |XABRE "WBC", aAbre, enHandlePortal;

     eaAlfa = eaPathAEAT + "wait ";
     |HAZ GrabaPortalSin;

     eaAlfa = eaPathExplorador + " " + &34;
     |HAZ GrabaPortalSin;

     eaAlfa = "https://www1.agenciatributaria.gob.es/static_files/common/internet/dep/aplicaciones/ov/servurls.html";
     |HAZ GrabaPortalSin;

     eaAlfa = "?WEB=INTERNET&PRG=111";
     |HAZ GrabaPortalSin;

     eaAlfa = "&EJE=0001";
     |HAZ GrabaPortalSin;

     eaAlfa = "&URL=PIR&EXT=?FIC=";
     |HAZ GrabaPortalSin;

     eaAlfa = eaPathAEAT + eaFicheroPlano + &34 + &13 + &10;
     |HAZ GrabaPortalSin;

     eaAlfa = "";
     |HAZ GrabaPortal;

     |XCIERRA enHandlePortal;

     |RSYSTEM aAbre;

     aAlfa = eaPathExplorador > "";
     aAlfa = aAlfa - "CHROME.EXE";
     |SI FSalida ! 0;  |SLEEP 30;  |FINSI;

     aAlfa = eaPathAEAT + aFichero;
     |RFBORRA aAlfa;
     |RFBORRA aAbre;
|FPRC;

|PROCESO PresentaModelo_02;
     |SI #eosy0008#40 [ 2014;
         enErrorPortal = 0;
         |HAZ ValidaMPF;
         |SI enErrorPortal = 1;  |ACABA;  |FINSI;
     |FINSI;

     |SI eaOpcion = "1";
         |HAZ Portal110_02;
     |FINSI;

     |SI eaOpcion = "3";
         eaFOrigen  = eaPathEmision  + eaFicheroPlano;
         eaFDestino = eaPathInternet + eaFicheroPlano;
         |HAZ CopiaFicheroPtl;

         |SI enPresentar = 1;
             |HAZ AbrePagina;
         |FINSI;
     |FINSI;
|FPRC;


|PROCESO TDeclaracion111_02;
     #652#6 = "N";
     |SI #133#28 > 0;
         #652#6 = "I";

         |SI #2#14 ! "1";
             #652#41 = #2#2;            || entidad
             #652#42 = #2#3;            || oficina
             #652#43 = #2#4;            || DC
             #652#44 = #2#5;            || cuenta
         |FINSI;

                                                  #652#6 = "I";
         |SI  #652#41 ! "    ";  |Y #2#14 = "3";  #652#6 = "U";  |FINSI;
     |FINSI;
|FPRC;

|PROCESO Carga111_02;
     nSwHay = 1;

     |DDEFECTO #652;

     #652#0   = #30#0;
     aAlfa    = #1#1;  |QBF aAlfa;
     #652#7   = ("000000000" + aAlfa) % -109;
     eaAlfa   = #1#2;    |HAZ QuitaRaros;     #652#8 = eaAlfa;

     #652#9   = #eosy0008#40;
     #652#10  = nPeriodo + "T";
     |SI #eosy0008#44 = "M";
         #652#10  = ("00" + nPeriodo) % -102;
     |FINSI;

     #652#11 = ("00000000" + #133#5) % -108;
     enNume  = #133#6;  |HAZ Conver17;  #652#12 = eaAlfa;
     enNume  = #133#7;  |HAZ Conver17;  #652#13 = eaAlfa;

     #652#14 = ("00000000" + #133#8) % -108;
     enNume  = #133#9;   |HAZ Conver17;  #652#15 = eaAlfa;
     enNume  = #133#10;  |HAZ Conver17;  #652#16 = eaAlfa;

     #652#17 = ("00000000" + #133#11) % -108;
     enNume  = #133#12;  |HAZ Conver17;  #652#18 = eaAlfa;
     enNume  = #133#13;  |HAZ Conver17;  #652#19 = eaAlfa;

     #652#20 = ("00000000" + #133#14) % -108;
     enNume  = #133#15;  |HAZ Conver17;  #652#21 = eaAlfa;
     enNume  = #133#16;  |HAZ Conver17;  #652#22 = eaAlfa;

     #652#23 = ("00000000" + #133#17) % -108;
     enNume  = #133#18;  |HAZ Conver17;  #652#24 = eaAlfa;
     enNume  = #133#19;  |HAZ Conver17;  #652#25 = eaAlfa;

     #652#26 = ("00000000" + #133#20) % -108;
     enNume  = #133#21;  |HAZ Conver17;  #652#27 = eaAlfa;
     enNume  = #133#22;  |HAZ Conver17;  #652#28 = eaAlfa;

     #652#29 = ("00000000" + #133#31) % -108;
     enNume  = #133#32;  |HAZ Conver17;  #652#30 = eaAlfa;
     enNume  = #133#33;  |HAZ Conver17;  #652#31 = eaAlfa;

     #652#32 = ("00000000" + #133#34) % -108;
     enNume  = #133#35;  |HAZ Conver17;  #652#33 = eaAlfa;
     enNume  = #133#36;  |HAZ Conver17;  #652#34 = eaAlfa;

     #652#35 = ("00000000" + #133#23) % -108;
     enNume  = #133#24;  |HAZ Conver17;  #652#36 = eaAlfa;
     enNume  = #133#25;  |HAZ Conver17;  #652#37 = eaAlfa;

     enNume  = #133#26;  |HAZ Conver17;  #652#38 = eaAlfa;
     enNume  = #133#27;  |HAZ Conver17;  #652#39 = eaAlfa;

     enNume  = #133#28;
     |SI enNume < 0; enNume = 0;  |FINSI;
                         |HAZ Conver17;  #652#40 = eaAlfa;

     |HAZ TDeclaracion111_02;

     #652#45 = "0";
     |SI #30#3 = "C";
         #652#45 = "1";
         aAlfa = #30#20; |QBF aAlfa;
         |SI aAlfa = "";
             aJusti  = "111";
         |SINO;
             aJusti  = #30#20;
         |FINSI;
         aJusti  = aJusti + #30#4 + #30#5  + #30#6  + #30#7  + #30#8;
         aJusti  = aJusti + #30#9 + #30#10 + #30#11 + #30#12 + #30#13;
         #652#46 = aJusti;
     |FINSI;

     eaAlfa  = #30#15;   |HAZ QuitaRaros;      #652#48 = eaAlfa;
     eaAlfa  = #30#16;   |HAZ QuitaRarosTfno;  #652#49 = eaAlfa;

     |GRABA 020#652n;
     |LIBERA #652;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ 56;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #652nCampo;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;

     |SI #eosy0008#40 [ 2014;
         aAlfa = &13 + &10;   |XGRABA nHandle2, aAlfa; || tique 300285 _ 761
     |FINSI;

     |XCIERRA nHandle2;

|FPRC;

|PROCESO Imprime110_02;
     #1#0 = #30#0;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;

     #3#0 = #1#18; #3#1 = #1#19;
     |LEE 040#3=;
     |SI FSalida ! 0; |DDEFECTO #3; |FINSI;

     #2#0 = #1#0;
     |LEE 040#2=;
     |SI FSalida ! 0; |DDEFECTO #2; |FINSI;

     #28#0 = #30#0;
     #28#1 = #30#1;
     |LEE 000#28=;
     |SI FSalida ! 0;  |DDEFECTO #28;  |FINSI;

     nPeriodo = #eosy0008#39;
     enPeriodo = nPeriodo;

     #133#0 = #30#0;
     #133#1 = #30#1;
     #133#2 = "110";
     #133#3 = nPeriodo;
     #133#4 = 0;
     |LEE 000#133=;
     |SI FSalida = 0;
         eaFicheroPlano = "111" + (("00000" + #1#0) % -105) + ".txt";
         eaFicheroImpre = "111" + (("00000" + #1#0) % -105) + ".pdf";
         eaFicheroError = "err" + (("00000" + #1#0) % -105) + ".txt";

        aAlfa = eaPathLanza + eaFicheroPlano;  |RFBORRA aAlfa;
        aAlfa = eaPathLanza + eaFicheroImpre;  |RFBORRA aAlfa;
        aAlfa = eaPathLanza + eaFicheroError;  |RFBORRA aAlfa;

        aAbre = eaPathEmision + eaFicheroPlano;
        |XABRE "BW", aAbre, nHandle2;

        |HAZ Carga111_02;

        |XCIERRA nHandle2;

        aAlfa    = #eosy0008#40 % -102;
        se_empre = #30#0;
        se_ejerc = aAlfa;
        se_perio = nPeriodo;
        se_tipos = 110;
        se_activ = 10;
        se_impor = #133#28;
        se_fecha = #eosy0008#43;
        se_factu = "N";
        |HAZ seguimie;
        |HAZ AlAgicli;

        enEmpresa    = #1#0;
        eaNomEmpresa = #1#1;

       |HAZ PresentaModelo_02;
    |FINSI;
|FPRC;

|DEFBUCLE eosm0030C_02;
     #30#1;
     ;
     #eosy0008#0, #eosy0008#40;
     #eosy0008#1, #eosy0008#40;
     ;
     NULL, Imprime110_02;
|FIN;

|DEFBUCLE eosm0030N_02;
     #30#2;
     ;
     aVacio40, #eosy0008#40;
     aLLeno40, #eosy0008#40;
     ;
     NULL, Imprime110_02;
|FIN;

|PROCESO moy11002;
     |HAZ LeeUnidad;

     #dsmoy000#0 = 110;
     #dsmoy000#6 = #eosy0008#40;
     enAnyos    = #eosy0008#40;
     |SI #eosy0008#44 = "M";
         eaPeriodo   = ("00" + #eosy0008#39) % -102;
     |SINO;
         eaPeriodo   = #eosy0008#39 + "T";
     |FINSI;
     eaPer = #eosy0008#44;

     eaEjer    = #dsmoy000#6;
     eaModelos = #dsmoy000#0;

     eaPathLanza = eaUnidad + "\MODELOS";              |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\" + #dsmoy000#0;    |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\" + #dsmoy000#6;         |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\" + eaPeriodo;      |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\";

     eaPathModelo = "\MODELOS";
     eaPathModelo = eaPathModelo + "\" + #dsmoy000#0;
     eaPathModelo = eaPathModelo + "\" + #dsmoy000#6;
     eaPathModelo = eaPathModelo + "\" + eaPeriodo;
     eaPathModelo = eaPathModelo + "\";

     |DBASE eaPathEmision;
     eaPathEmision = eaPathEmision + "emisiones";       |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + #dsmoy000#0;   |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + #dsmoy000#6;      |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + eaPeriodo;   |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/";

     eaPathInternet = eaUnidad + "/AEAT";                |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/INTERNET";      |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + #dsmoy000#0;  |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + #dsmoy000#6;     |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + eaPeriodo;  |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/";

     |HAZ BotonesMPFPortal;
     nTecla = enTecla;
     |SI nTecla = 0;  |ACABA;  |FINSI;

     |SI #dsmoy000#6 ] 2015;
         enPresentar = 0;
         |SI eaOpcion = "3";
             |CONFI "0000SPresentamos la declaracion en el momento de crearlas";
             |SI FSalida = 0;
                 enPresentar = 1;
             |FINSI;
         |FINSI;
     |FINSI;

     aFichero  = ("iw" + Usuario) % 108;
     |NOME_DAT #652 aFichero;
     |ABRE #652;  |CIERRA #652;  |DELINDEX #652;

     |ABRE #652;

     nSwHay = 0;
     |ABRE #1;
     |ABRE #2;
     |ABRE #3;
     |ABRE #28;
     |ABRE #33;
     |ABRE #133;
     |SI #eosy0008#0 = 0;
         |ABRE #30;
         |PARA nCampoD = Campo + 1;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
               |SI #0nCampoD ! 0;
                   #30#0 = #0nCampoD;
                   #30#1 = #eosy0008#40;
                   |LEE 040#30=;
                   |SI FSalida = 0;
                       |HAZ Imprime110_02;
                   |FINSI;
               |FINSI;
         |SIGUE;
         |CIERRA #30;
     |SINO;
         |SI #eosy0008#42 = "C";
             |BUCLE eosm0030C_02;
         |SINO;
             |BUCLE eosm0030N_02;
         |FINSI;
     |FINSI;
     |CIERRA #1;
     |CIERRA #2;
     |CIERRA #3;
     |CIERRA #28;
     |CIERRA #33;
     |CIERRA #133;

     |CIERRA #652;
     |DELINDEX #652;

     |HAZ SacaErrorPtl;

     |SI eaOpcion = "3"; |Y nSwHay ! 0;
         |SI enPresentar = 0;
             aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
             |MENAV aAlfa;
         |FINSI;
     |FINSI;
|FPRC;
