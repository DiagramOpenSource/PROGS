|FICHEROS;
     eosem131 #0;                  || Este Def
     eosclien #2;                  || Clientes
     eoshacie #3;                  || Hacienda
     eoscomul #4;                  || Comuneros
     eosdaban #5;                  || Bancos
     eosactiv #7;                  || Actividades
     eoscomun #8;                  || Comuneros Cabeceras
     eosm0020 #10;                 || Mantenimiento 131 1998
     eosm0050 #50;                 || Letras Identificativas
     eosw0063 #98;                 || Fantasma de Impresion 98
     eosw0073 #99;                 || Fantasma de Impresion 99
     eosw0543 #543;                || Fantasma de Impresion 2002
     dsmow571 #571;                || Fantasma de Impresion 2007 - 2008 1tr.
     dsmow577 #577;                || Fantasma de Impresion 2008 2tr.
     dsmow594 #594;                || Fantasma de Impresion 2009
     eosw0601 #601,MANTE;          || Pedir Datos Laser 2002

     eosm20e@ #110;
|FIN;

|VARIABLES;
     aMas       = "";
     aDef       = "";
     Campos     = 0;
     LLeno40    = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     Vacio40    = "                                        ";
     DEmpre     = 0;
     HEmpre     = 0;

     aDirOri  = "";
     aDirDes  = "";
     aOrigen  = "";
     aDestino = "";

     nNeg = 0;
     aAlfa        = "";
     aCadena      = "";
     aLong        = "";
     aCaracter    = "";
     nLong        = 0;
     nPos         = 0;
     nCont        = 0;
     nCalc        = 0;

     pepe       = 0;
     Contador   = 0;
     sw_sigue   = 0;
     x          = 0;
     el5        = "";
     el6        = "";
     el8        = "";
     el9        = "";
     el11       = "";
     el12       = "";
     el14       = "";
     el15       = "";
     el17       = "";
     el18       = "";
     l_epi      = "";
     n_epi      = "";
     nSeImprime = 0;
     manolo     = 0;
     SiHay     = 0;
     mes_campo  = 0;

     nPosiU       = 0;
     Valfa0       = "";
     SwPunto      = 0;
     ParteEntera  = "";
     ParteDecimal = "";

     &comunero  = "";
     &dia       = "";
     &mes       = "";
     &anyo      = "";
     &peri      = "";
     &imp1      = 0;    &imp2  = 0;  &imp3  = 0;  &imp4  = 0;  &imp5  = 0;
     &imp6      = 0;    &imp7  = 0;  &imp8  = 0;  &imp9  = 0;  &imp10 = 0;
     &imp11     = 0;    &imp12 = 0;  &imp13 = 0;  &imp14 = 0;

     &jose1     = "";   &jose2 = ""; &jose3 = ""; &jose4 = ""; &jose5 = "";
     &juan1     = "";   &juan2 = ""; &juan3 = ""; &juan4 = ""; &juan5 = "";

     &EURODB    = 0;

     Posi      = 0;
     PosC      = 0;
     Campo1    = 0;
     Campo2    = 0;
     Campo3    = 0;
     Campo4    = 0;
     Campo5    = 0;
     Campo6    = 0;
     Campo7    = 0;
     CantiNum  = 0;
     CantiAlfa = "";
     SwGraba   = 0;

     Calc = 0;   Calc1 = 0;  Calc2 = 0;
     TipoDato = "";  Long  = 0;  LongDec = 0;
     Comodin = "";  Comodin1 = "";  Comodin2 = "";
     Vacio1 = "";  Vacio2 = "";

     aAbre        = "";
     aModelos     = "";

     nHandle1     = 0;
     nHandle2     = 0;
     nAnyo2D      = 0;
     nSwHay       = 0;
     nTCampo      = 0;

     fFecha       = @;

     aAlfa1       = "";
     aUnidad      = "";
     aFichero     = "";

  {1}aContiene    = "";

     &eaFOrigen   = "";
     &eaFDestino  = "";
     &eaInternet  = "";
     &eaImpresora = "";
     &enNume      = 0;
     &eaAlfa      = "";
     &eaDiaB      = "";
     &eaMesB      = "";
     &eaAnyoB     = "";
     &eaModelos   = "";
     nNume1       = 0;

     &eaPathEmision      = "";
     &eaPathLanza        = "";
     &eaPathExplorador   = "";
     &eaPathInternet     = "";
     &eaFicheroPlano     = "";
     &eaFicheroSalid     = "";
     &eaFicheroImpre     = "";
     &eaFicheroError     = "";
     &eaOpcion           = "";
     &enEmpresa          = 0;
     &eaNomEmpresa       = "";
     &enPresentar        = 0;
     &enErrorPortal      = 0;
     &enTecla            = 0;
     &enPeriodo          = 0;
     &eaPeriodo          = "";
     &eaEjer             = "";
     nTecla              = 0;
     perialf             = "";

     &eaAdmin = "";
     &eaDeleg = "";

     &enModelo  = 0;
     &enError15 = 0;
|FIN;

|INCLUYE i_seguim;
|INCLUYE i_cuadre;
|INCLUYE i_anyode;
|INCLUYE i_consul;
|INCLUYE i_laserc;

|PROCESO MiraVarMoneda;  |TIPO 0;
     |HAZ PintaMoneda;
     #0#34 = eaMoneda;

     |SI #0#2 [ 2000;
         |SI #0#32 = "L";  |O #0#32 = "F";
             #0#34 = "PESETAS";
         |FINSI;
     |FINSI;

     |SI #0#2 ] 2002;
         |SI #0#34 = "PESETAS";
             |MENAV "     Moneda Erronea.";
             |ERROR;
         |FINSI;
     |FINSI;

     |PINTA #0#34;
|FPRC;

|PROCESO Mayus; |TIPO 0;
  #0Campo = #0Campo > #0Campo;
  |PINTA #0Campo;

   |SI #0#32 = "L"; |Y #0#2 [ 1997;
       #0#32 = "O";  |PINTA #0#32;
  |FINSI;
|FPRC;

|PROCESO FPago; |TIPO 0;
 |SI FSalida = 2; |ACABA; |FINSI;

 |SI #0#32 ! "O";
     |SI #0#35 = "A";
         |MENAV "    Opcion valida solo para Fichero / Internet. ";
         |ERROR;
     |FINSI;
 |FINSI;
|FPRC;

|PROCESO Parrilla; |TIPO 0;
  |SI #0#7 = "S";
      |PARA Campos = 8; |SI Campos [ 31; |HACIENDO Campos = Campos + 1;
            |C_M #0Campos, 1, "N";  #0Campos = 0;  |PINTA #0Campos;
      |SIGUE;
      |C_M #0#0, 1, "S";   |C_M #0#1, 1, "S";  |C_M #0#33, 1, "S";
  |SINO;
      |PARA Campos = 8; |SI Campos [ 31; |HACIENDO Campos = Campos + 1;
            |C_M #0Campos, 1, "S";
      |SIGUE;
      |C_M #0#0,  1, "N"; #0#0 = 1;     |PINTA #0#0;
      |C_M #0#1,  1, "N"; #0#1 = 99999; |PINTA #0#1;
      |C_M #0#33, 1, "N"; #0#33 = "C";  |PINTA #0#33;
  |FINSI;
|FPRC;

|PROCESO PintaAnyo; |TIPO 7;
     fFecha = ~;
     aAlfa  = fFecha % -104;
     #0#2   = aAlfa;
     |PINTA #0#2;
|FPRC;

|| ****************************************
|| PROCESO DE IMPRESION MODELO 131 A¤O 1998
|| ****************************************

|PROCESO Valor;
     eaMoneda = #0#34;
     enCanti  = CantiNum;
     |HAZ ConverMoneda;
     CantiNum = enCanti;

     |SI CantiNum ] 0;
         CantiAlfa = CantiNum;
         CantiAlfa = ("000000000000" + CantiAlfa) % -112;
     |SINO;
         CantiNum  = -CantiNum;
         CantiAlfa = CantiNum;
         CantiAlfa = "N" + (("00000000000" + CantiAlfa) % -111);
     |FINSI;
|FPRC;

|PROCESO CogeDeci;
  Valfa   = (CantiNum + "     ") % 105;
  nPosiU  = 0;
  Valfa0  = "";
  Valfa1  = "";
  Valfa2  = "";
  SwPunto = 0;
  |PARA XPara = 1;  |SI XPara [ 5;  |HACIENDO XPara = XPara + 1;
        nPosiU  = (100 * XPara) + 1;
        Valfa0  = Valfa % nPosiU;
        |SI Valfa0 = "."; SwPunto = 1;  |FINSI;
        |SI SwPunto = 0;
            |SI Valfa0 ! " "; |Y Valfa0 ! ".";
                Valfa1 = Valfa1 + Valfa0;
            |FINSI;
        |FINSI;

        |SI SwPunto = 1;
            |SI Valfa0 ! " "; |Y Valfa0 ! ".";
                Valfa2 = Valfa2 + Valfa0;
            |FINSI;
        |FINSI;
  |SIGUE;

  ParteEntera   = ("00" + Valfa1) % -102;
  ParteDecimal  = (Valfa2 + "00") % 102;

  Posi = Posi + 1;  #99Posi = ParteEntera;
  Posi = Posi + 1;  #99Posi = ParteDecimal;
|FPRC;

|PROCESO CargaEpi98;
  Campo3 = Campo2 + 1;
  Campo4 = Campo2 + 2;
  Campo5 = Campo2 + 3;
  Campo6 = Campo2 + 4;
  Campo7 = Campo2 + 5;

  Posi = 0;
  PosC = 0;
  |SI #98#49 = "000000000000";  Posi = 44;  PosC = 84;  |FINSI;
  |SI #98#43 = "000000000000";  Posi = 38;  PosC = 82;  |FINSI;
  |SI #98#37 = "000000000000";  Posi = 32;  PosC = 80;  |FINSI;
  |SI #98#31 = "000000000000";  Posi = 26;  PosC = 78;  |FINSI;
  |SI #98#25 = "000000000000";  Posi = 20;  PosC = 76;  |FINSI;

                    #98Posi  = #10Campo4;
  Posi = Posi + 1;  CantiNum = #10Campo5;   |HAZ Valor;  #98Posi = CantiAlfa;
  Posi = Posi + 1;  |SI #10Campo6 = 2.5;  #98Posi = "X";  |FINSI;
  Posi = Posi + 1;  |SI #10Campo6 = 4;    #98Posi = "X";  |FINSI;
  Posi = Posi + 1;  |SI #10Campo6 = 5;    #98Posi = "X";  |FINSI;
  Posi = Posi + 1;  CantiNum = #10Campo7;   |HAZ Valor;  #98Posi = CantiAlfa;

                    #98PosC = #10Campo5;
  PosC = PosC + 1;  #98PosC = #10Campo7;
|FPRC;

|PROCESO CargaTrabajo98;
  |DDEFECTO #98;

  comunero   = "";
  Contador   = 0;
  nSeImprime = 0;
  |PARA Campo2 = 6; |SI Campo2 [ 34; |HACIENDO Campo2 = Campo2 + 7;
        Campo7 = Campo2 + 5;
        |SI #10Campo2  = "C";
            Contador   = Contador + 1;
            nSeImprime = 1;
        |FINSI;

        |SI #10Campo2 = "N";
            |SI #10Campo7 ! 0; nSeImprime = 1; |FINSI;
        |FINSI;
  |SIGUE;

  |SI #10#43 ! 0; |O #10#44 ! 0; |O #10#45 ! 0; |O #10#46 ! 0; |O #10#47 ! 0;
      nSeImprime = 1;
  |FINSI;

  |SI #10#11 = 0; |Y #10#18 = 0; |Y #10#25 = 0; |Y #10#32 = 0; |Y #10#39 = 0;
   |Y #10#40 = 0; |Y #10#41 = 0; |Y #10#43 = 0; |Y #10#45 = 0; |Y #10#47 = 0;
       nSeImprime = 1;
  |FINSI;

  |SI nSeImprime = 0; |Y #0#32 ! "B";
      #10#3 = #0#6;
      |GRABA 020#10a;
      |LIBERA #10;
      |ACABA;
  |FINSI;
                                                               ||  -01-
  #98#1 = "131";
                                                               ||  -02-
  #98#2 = "01";
                                                               || -03-
  #98#3  = " ";
                                                               || -04-
  #98#4  = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);
                                                               || -05-
  Valfa  = #2#1; |QBF Valfa;
  #98#5  = ("000000000" + Valfa) % -109;
                                                               || -06-
  #98#6  = #2#2;
                                                               || -08-
  #98#8  = #2#4;
                                                               || -09-
  #98#9  = #2#5;
                                                               || -10-
  #98#10 = #2#6;
                                                               || -11-
  #98#11 = #2#7;
                                                               || -12-
  #98#12 = #2#8;
                                                               || -13-
  #98#13 = #2#9;
                                                               || -14-
  #98#14 = (("00" + #2#10) % -102) + (("000" + #2#11) % -103);
                                                               || -15-
  #98#15 = #2#13;
                                                               || -16-
  #98#16 = #2#12;
                                                               || -17-
  #98#17 = #2#14;
                                                               || -18-
  aAlfa  = #0#2 % -102;
  #98#18 = aAlfa;
                                                               || -19-
  #98#19 = #0#4;
                                                               || -20- al -49-
  |PARA Campo2 = 6;  |SI Campo2 [ 34;  |HACIENDO Campo2 = Campo2 + 7;
        |SI #10Campo2 ! "S";  |HAZ CargaEpi98;  |FINSI;
  |SIGUE;
                                                               || -50-
  CantiNum = #10#40;  |HAZ Valor;  #98#50 = CantiAlfa;
  #98#86   = #10#40;

                                                               || -51-
  CantiNum = #10#41;  |HAZ Valor;  #98#51 = CantiAlfa;
  #98#87   = #10#41;
                                                               || -52-
  CantiNum = #10#42;  |HAZ Valor;  #98#52 = CantiAlfa;
  #98#88   = #10#42;
                                                               || -53-
  CantiNum = #10#43;  |HAZ Valor;  #98#53 = CantiAlfa;
  #98#89   = #10#43;
                                                               || -54-
  CantiNum = #10#44;  |HAZ Valor;  #98#54 = CantiAlfa;
  #98#90   = #10#44;
                                                               || -55-
  CantiNum = #10#45;  |HAZ Valor;  #98#55 = CantiAlfa;
  #98#91   = #10#45;
                                                               || -56-
  CantiNum = #10#46;  |HAZ Valor;  #98#56 = CantiAlfa;
  #98#92   = #10#46;
                                                               || -57-
  CantiNum = #10#47;  |HAZ Valor;  #98#57 = CantiAlfa;
  #98#93   = #10#47;
                                                               || -58-
  |SI #10#47 = 0;  #98#58 = "X";  |FINSI;

                                                               || -59-
  CantiNum = #10#47;  |HAZ Valor;  #98#59 = CantiAlfa;
  #98#94   = #10#47;
                                                               || -62-
  #98#62 = #5#2;
                                                               || -63-
  #98#63 = #5#3;
                                                               || -64-
  #98#64 = #5#4;
                                                               || -65-
  #98#65 = #5#5;
                                                               || -71-
  #98#71 = #2#13;
                                                               || -72-
  #98#72 = dia;
                                                               || -73-
  #98#73 = mes;
                                                               || -74-
  #98#74 = anyo % -101;
                                                               || -75-
  #98#75 = &13 + &10;

  |SI #0#32 ! "B";
      #10#3 = #0#6;
      |GRABA 020#10a;
      |LIBERA #10;
  |FINSI;
|FPRC;

|PROCESO CargaEpi99;
  Campo3 = Campo2 + 1;
  Campo4 = Campo2 + 2;
  Campo5 = Campo2 + 3;
  Campo6 = Campo2 + 4;
  Campo7 = Campo2 + 5;

  Posi = 0;
  PosC = 0;
  |SI #99#44 = "000000000000";  Posi = 40;  PosC = 79;  |FINSI;
  |SI #99#39 = "000000000000";  Posi = 35;  PosC = 77;  |FINSI;
  |SI #99#34 = "000000000000";  Posi = 30;  PosC = 75;  |FINSI;
  |SI #99#29 = "000000000000";  Posi = 25;  PosC = 73;  |FINSI;
  |SI #99#24 = "000000000000";  Posi = 20;  PosC = 71;  |FINSI;

                    #99Posi  = #10Campo4;
  Posi = Posi + 1;  CantiNum = #10Campo5;   |HAZ Valor;  #99Posi = CantiAlfa;
                    CantiNum = #10Campo6;   |HAZ CogeDeci;
  Posi = Posi + 1;  CantiNum = #10Campo7;   |HAZ Valor;  #99Posi = CantiAlfa;

                    #99PosC = #10Campo5;
  PosC = PosC + 1;  #99PosC = #10Campo7;
|FPRC;

|PROCESO CargaTrabajo99;
  |DDEFECTO #99;

  comunero   = "";
  Contador   = 0;
  nSeImprime = 0;
  |PARA Campo2 = 6; |SI Campo2 [ 34; |HACIENDO Campo2 = Campo2 + 7;
        Campo7 = Campo2 + 5;
        |SI #10Campo2 = "C";
            Contador = Contador + 1;
            nSeImprime = 1;
        |FINSI;

        |SI #10Campo2 = "N";
            |SI #10Campo7 ! 0; nSeImprime = 1; |FINSI;
        |FINSI;
  |SIGUE;

  |SI #10#43 ! 0; |O #10#44 ! 0; |O #10#45 ! 0; |O #10#46 ! 0; |O #10#47 ! 0;
      nSeImprime = 1;
  |FINSI;

  |SI #10#11 = 0; |Y #10#18 = 0; |Y #10#25 = 0; |Y #10#32 = 0; |Y #10#39 = 0;
   |Y #10#40 = 0; |Y #10#41 = 0; |Y #10#43 = 0; |Y #10#45 = 0; |Y #10#47 = 0;
       nSeImprime = 1;
  |FINSI;

  |SI nSeImprime = 0; |Y #0#32 ! "B";
      #10#3 = #0#6;
      |GRABA 020#10a;
      |LIBERA #10;
      |ACABA;
  |FINSI;

                                                               ||  -01-
  #99#1 = "131";
                                                               ||  -02-
  #99#2 = "01";
                                                               || -03-
  #99#3  = " ";
                                                               || -04-
  #99#4  = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);
                                                               || -05-
  Valfa  = #2#1; |QBF Valfa;
  #99#5  = ("000000000" + Valfa) % -109;
                                                               || -06-
  #99#6  = #2#2;
                                                               || -08-
  #99#8  = #2#4;
                                                               || -09-
  #99#9  = #2#5;
                                                               || -10-
  #99#10 = #2#6;
                                                               || -11-
  #99#11 = #2#7;
                                                               || -12-
  #99#12 = #2#8;
                                                               || -13-
  #99#13 = #2#9;
                                                               || -14-
  #99#14 = (("00" + #2#10) % -102) + (("000" + #2#11) % -103);
                                                               || -15-
  #99#15 = #2#13;
                                                               || -16-
  #99#16 = #2#12;
                                                               || -17-
  #99#17 = #2#14;
                                                               || -18-
  #99#18 = #0#2;
                                                               || -19-
  #99#19 = #0#4;
                                                               || -20- al -49-
  |PARA Campo2 = 6;  |SI Campo2 [ 34;  |HACIENDO Campo2 = Campo2 + 7;
        |SI #10Campo2 ! "S";  |HAZ CargaEpi99;  |FINSI;
  |SIGUE;
                                                               || -50-
  CantiNum = #10#40;  |HAZ Valor;  #99#45 = CantiAlfa;
  #99#81   = #10#40;

                                                               || -51-
  CantiNum = #10#41;  |HAZ Valor;  #99#46 = CantiAlfa;
  #99#82   = #10#41;
                                                               || -52-
  CantiNum = #10#42;  |HAZ Valor;  #99#47 = CantiAlfa;
  #99#83   = #10#42;
                                                               || -53-
  CantiNum = #10#43;  |HAZ Valor;  #99#48 = CantiAlfa;
  #99#84   = #10#43;
                                                               || -54-
  CantiNum = #10#44;  |HAZ Valor;  #99#49 = CantiAlfa;
  #99#85   = #10#44;
                                                               || -55-
  CantiNum = #10#45;  |HAZ Valor;  #99#50 = CantiAlfa;
  #99#86   = #10#45;
                                                               || -56-
  CantiNum = #10#46;  |HAZ Valor;  #99#51 = CantiAlfa;
  #99#87   = #10#46;
                                                               || -57-
  CantiNum = #10#47;  |HAZ Valor;  #99#52 = CantiAlfa;
  #99#88   = #10#47;

  |SI #10#47 = 0;  #99#53 = "X";  |FINSI;

  CantiNum = #10#47;  |HAZ Valor;  #99#54 = CantiAlfa;
  #99#89   = #10#47;
                                                               || -62-
  #99#57 = #5#2;
                                                               || -63-
  #99#58 = #5#3;
                                                               || -64-
  #99#59 = #5#4;
                                                               || -65-
  #99#60 = #5#5;
                                                               || -71-
  #99#66 = #2#13;
                                                               || -72-
  #99#67 = dia;
                                                               || -73-
  #99#68 = mes;
                                                               || -74-
  #99#69 = anyo;
                                                               || -75-
  #99#70 = &13 + &10;

  |SI #0#32 ! "B";
      #10#3 = #0#6;
      |GRABA 020#10a;
      |LIBERA #10;
  |FINSI;
|FPRC;

|PROCESO MiraSiHay98;
  |SI #7#22 = "B";          |ACABA; |FINSI;
  |SI #7#22 = "C";          |ACABA; |FINSI;
  |SI #7#22 = "N";          |ACABA; |FINSI;
  |SI #7#46 = "S";          |ACABA; |FINSI;
  |SI #7#41 = "S";          |ACABA; |FINSI;
  |SI #7#49 ! "01.01.1900"; |ACABA; |FINSI;

  SiHay = 0;
  |SI #10#5  = #7#1; SiHay = 1;  |FINSI;
  |SI #10#12 = #7#1; SiHay = 1;  |FINSI;
  |SI #10#19 = #7#1; SiHay = 1;  |FINSI;
  |SI #10#26 = #7#1; SiHay = 1;  |FINSI;
  |SI #10#33 = #7#1; SiHay = 1;  |FINSI;

  |SI #10#8  = "    "; |Y #10#15 = "    "; |Y #10#21 = "    ";
   |Y #10#29 = "    "; |Y #10#36 = "    ";
      SiHay = 1;
  |FINSI;

  |SI SiHay = 0;
      |PUSHV 0501 2380;
      |CUADRO 810  2067;
      |PINTA  911, "                                                        ";
      |PINTA 1011, "                                                        ";
      |PINTA 1111, "                                                        ";
      |PINTA 1211, "                                                        ";
      |PINTA 1311, "                                                        ";
      |PINTA 1411, "                                                        ";
      |PINTA 1511, "                                                        ";
      |PINTA 1611, "                                                        ";
      |PINTA 1711, "                                                        ";
      |PINTA 1811, "                                                        ";
      |PINTA 1911, "                                                        ";

      |PINTA 1011, "Empresa : ";
      |PINTA 1021, #7#0;
      |PINTA 1027, #7#3;

      |PINTA 1211, "Actividad : ";
      |PINTA 1223, #7#1;
      |PINTA 1225, "A¤o : ";
      |PINTA 1231, #7#2;

      |ATRI P;
      |PINTA 1520, "    NO EXISTE LA ACTIVIDAD EN EL      ";
      |PINTA 1620, "    MANTENIMIENTO DE TRABAJO DEL 131  ";
      |ATRI p;

      |CONFI "2400NDesea imprimirlo : ";
      |SI FSalida = 0;  SiHay = 1;  |FINSI;

      |POPV;
      |ERROR10;
  |FINSI;
|FPRC;

|DEFBUCLE eosactiv98;
  #7#1;
  ;
  #10#0, 1, #10#1;
  #10#0, 6, #10#1;
  ;
  NULL, MiraSiHay98;
|FIN;

|| *****************************************************
|| PROCESO DE IMPRESION MODELO 131 A¤O 1998 EN IMPRESORA
|| *****************************************************

|PROCESO MiraAct98;
  Campo3 = Campo2 + 1;
  Campo4 = Campo2 + 2;
  #7#0 = #10#0;
  #7#4 = #10Campo3;
  #7#5 = #10Campo4;
  #7#2 = nAnyo2D;
  |LEE 040#7=;
  |SI FSalida ! 0; |ACABA; |FINSI;

  #4#3 = #7#0;
  #4#5 = #7#1;
  #4#7 = #7#2;
  |LEE 040#4=;
  |SI FSalida ! 0; |ACABA; |FINSI;

  #8#0 = #4#0;
  #8#1 = #4#1;
  #8#3 = #4#7;
  |LEE 040#8=;
  |SI FSalida ! 0; |DDEFECTO #8; |FINSI;

  comunero = "COMUNIDAD DE BIENES " + #8#2 + "AL " + #4#6 + " %";
|FPRC;

|PROCESO Frase98;
  comunero = "";
  |ABRE #7;
  |ABRE #4;
  |ABRE #8;
  |SELECT #2#7;
  |SELECT #2#4;
  |SI Contador = 1;
      |PARA Campo2 = 6; |SI Campo2 [ 34; |HACIENDO Campo2 = Campo2 + 7;
            |SI #10Campo2 = "C"; |HAZ MiraAct98; |FINSI;
      |SIGUE;
  |SINO;
      comunero = "COMUNIDADES DE BIENES ";
  |FINSI;
  |CIERRA #7;
  |CIERRA #4;
  |CIERRA #8;
|FPRC;

|PROCESO Chequeo98;
  |SI #0#33 ! "N";
      #2#0 = #10#0;
      |LEE 040#2=;
      |SI FSalida ! 0; |DDEFECTO #2; |FINSI;
  |FINSI;

  #5#0 = #2#0;
  |LEE 040#5=;                             || Lee Bancos
  |SI FSalida ! 0; |DDEFECTO #5; |FINSI;

  |SI #0#2 = 1998;              |HAZ CargaTrabajo98;  |FINSI;
  |SI #0#2 ] 1999;              |HAZ CargaTrabajo99;  |FINSI;

  |SI nSeImprime = 0; |ACABA; |FINSI;

  SiHay = 1;
  |BUCLE eosactiv98;
  |SI SiHay = 0; |ACABA; |FINSI;

  #3#0 = #2#18; #3#1 = #2#19;
  |LEE 040#3=;                             || Lee Hacienda
  |SI FSalida ! 0; |DDEFECTO #3; |FINSI;

  |SI Contador > 0; |HAZ Frase98; |FINSI;

  |PRINT;
  |PIEINF;

  |SI #0#32 ! "F";  |ACABA; |FINSI;

  aAlfa    = #0#2 % -102;
  se_empre = #2#0;
  se_ejerc = aAlfa;
  se_perio = #0#4;
  se_tipos = 131;
  se_activ = 10;
  se_impor = #10#47;
  |SI #0#2 = 2008; |Y #0#4 ] 2;
      se_impor = #10#57;
  |FINSI;
  se_fecha = #0#6;
  se_factu = "N";
  |HAZ seguimie;
  |HAZ AlAgicli;
  |HAZ VerComunidad;
|FPRC;

|DEFBUCLE eosm0020;
  #10#1;
  4;
  DEmpre, nAnyo2D, #0#4, "N";
  HEmpre, nAnyo2D, #0#4, "N";
  be;
  NULL, Chequeo98;
|FIN;

|PROCESO AlModelo98;
  DEmpre = #2#0;
  HEmpre = #2#0;
  |BUCLE eosm0020;
|FPRC;

|DEFBUCLE eosclien98;
  #2#3;
  0;
  Vacio40, #0#0;
  LLeno40, #0#1;
  ;
  NULL, AlModelo98;
|FIN;

|PROCESO Papel;
  |IMPRE 0;
  |SI FSalida ! 0; |ACABA; |FINSI;

  |SI #0#32 = "O";
      |INFOR "m131h011";
      |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;
      |HAZ i_cuadre;
  |SINO;
      |SI #0#2 [ 2006;  |INFOR "m131h012"; |FINSI;
      |SI #0#2 = 2007;  |INFOR "m131h013"; |FINSI;
      |SI #0#2 = 2008;
          |SI #0#4 ] 2;
              |INFOR "m131h014";   ||ESTAN ESTOS INFORMES PARA MODIFICAR
          |SINO;
              |INFOR "m131h013";
          |FINSI;
      |FINSI;

      |SI #0#2 ] 2009;
          |INFOR "m131h009";
      |FINSI;

      |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;
  |FINSI;

  |ABRE #3;
  |ABRE #5;

  |SI #0#33 = "N";
      |BUCLE eosclien98;
  |SINO;
      |ABRE #2;
      |SI #0#7 = "S";
          DEmpre = #0#0;
          HEmpre = #0#1;
          |BUCLE eosm0020;
      |SINO;
          |PARA x = 8; |SI x [ 31; |HACIENDO x = x + 1;
                |SI #0x ! 0;
                    DEmpre = #0x;
                    HEmpre = #0x;
                    |BUCLE eosm0020;
                |FINSI;
          |SIGUE;
      |FINSI;
      |CIERRA #2;
  |FINSI;

  |CIERRA #3;
  |CIERRA #5;

  |FININF;
  |FINIMP;
|FPRC;

|PROCESO Formateo;
   nNeg = 0;
   |SI TipoDato = "N";
      Vacio1 = "0" * Long;
      Vacio2 = "0" * LongDec;
      Comodin = Comodin - "-";
      |SI FSalida ! 0; nNeg = 1; |FINSI;
   |SINO;
      Vacio1 = " " * Long;
   |FINSI;

   |SI LongDec = 0;
      Calc = 0 - (100 + Long);
      Comodin = (Vacio1 + Comodin) % Calc;
   |SINO;
      Comodin = Comodin - ".";
      |SI FSalida = 0;
         Calc = 0 - (100 + Long);
         Comodin = (Vacio1 + Comodin) % Calc;
         Comodin1 = "0" * LongDec;
      |SINO;
         Calc1 = (((FSalida / 100) ! 0) - 1) + 100;
         Calc2 = (((FSalida / 100) ! 0) * 100) + 99;
         Comodin1 = Comodin % Calc2;
         Comodin  = Comodin % Calc1;
         Calc = 0 - (100 + Long);
         Comodin  = (Vacio1 + Comodin)  % Calc;
         Calc = 100 + LongDec;
         Comodin1 = (Comodin1 + Vacio2) % Calc;
      |FINSI;
      Comodin = Comodin + Comodin1;
   |FINSI;
   |SI TipoDato = "N"; |Y nNeg = 1;
      Calc = 0 - (100 + (Long - 1));
      Comodin = "N" + (Comodin % Calc)
   |FINSI;
|FPRC;

|PROCESO Internet;
   Cadena = "131E";
   Cadena = Cadena + (("         " + #eosclien#1) % -109);   || Nif
   Cadena = Cadena + "    ";                                 || Letras de etiqueta
   Cadena = Cadena + #0#2;                                  || Ejercicio
   ||Cadena = Cadena + (("00" + #0#4) % -102);                 || Periodo
   Cadena = Cadena + (#0#4 + "T");                           || Periodo

   |SI #eosm0020#7 = "E"; Cadena = Cadena + "1"; |SINO; Cadena = Cadena + "2"; |FINSI;
   Cadena = Cadena + #eosm0020#8;                            || Epigrafe 1
   Long = 15; LongDec = 2; TipoDato = "N";
   Comodin = #eosm0020#9;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Rendimiento Neto 1
   Long = 3;  Comodin = #eosm0020#10;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Porcentaje 1
   Long = 15; Comodin = #eosm0020#11;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Resultado 1

   |SI #eosm0020#14 = "E"; Cadena = Cadena + "1"; |SINO; Cadena = Cadena + "2"; |FINSI;
   Cadena = Cadena + #eosm0020#15;                           || Epigrafe 2
   Comodin = #eosm0020#16;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Rendimiento Neto 2
   Long = 3;  Comodin = #eosm0020#17;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Porcentaje 2
   Long = 15; Comodin = #eosm0020#18;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Resultado 2

   |SI #eosm0020#21 = "E"; Cadena = Cadena + "1"; |SINO; Cadena = Cadena + "2"; |FINSI;
   Cadena = Cadena + #eosm0020#22;                           || Epigrafe 3
   Comodin = #eosm0020#23;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Rendimiento Neto 3
   Long = 3;  Comodin = #eosm0020#24;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Porcentaje 3
   Long = 15; Comodin = #eosm0020#25;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Resultado 3

   |SI #eosm0020#28 = "E"; Cadena = Cadena + "1"; |SINO; Cadena = Cadena + "2"; |FINSI;
   Cadena = Cadena + #eosm0020#29;                           || Epigrafe 4
   Comodin = #eosm0020#30;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Rendimiento Neto 4
   Long = 3;  Comodin = #eosm0020#31;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Porcentaje 4
   Long = 15; Comodin = #eosm0020#32;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Resultado 4

   |SI #eosm0020#35 = "E"; Cadena = Cadena + "1"; |SINO; Cadena = Cadena + "2"; |FINSI;
   Cadena = Cadena + #eosm0020#36;                           || Epigrafe 5
   Comodin = #eosm0020#37;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Rendimiento Neto 5
   Long = 3;  Comodin = #eosm0020#38;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Porcentaje 5
   Long = 15; Comodin = #eosm0020#39;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Resultado 5
   Cadena = Handle + " " + Cadena; |FGRABA Cadena; Cadena = "";

   Comodin = #eosm0020#40;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Suma de resultados
   Comodin = #eosm0020#41;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Retenciones
   Comodin = #eosm0020#42;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Pago fraccionado
   Comodin = #eosm0020#43;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Volumen de ventas A.y G.
   Comodin = #eosm0020#44;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || 2 % del volumen de ventas
   Comodin = #eosm0020#45;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Retenciones e ing.a Cta.del trimestre
   Comodin = #eosm0020#46;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Pago fraccionado
   nCalc = #eosm0020#42 + #eosm0020#46;
   Comodin = nCalc;         |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Suma de los pagos fraccionados
   Comodin = 0;             |HAZ Formateo
   Cadena = Cadena + Comodin;                                || A deducir en caso de complementaria
   Comodin = #eosm0020#47;  |HAZ Formateo;
   Cadena = Cadena + Comodin;                                || Cuota a ingresar
   Cadena = Cadena + (" " * 29);                             || Codigo electronico + N§ justificante
   Cadena = Handle + " " + Cadena; |FGRABA Cadena; Cadena = "";

   Cadena = Cadena + #2#2 + (" " * 60);                      || Persona de contacto
   Cadena = Cadena + #2#14;                                  || Telefono de contacto
   Cadena = Cadena + (" " * 100);                            || Parte Observaciones
   Cadena = Handle + " " + Cadena; |FGRABA Cadena; Cadena = "";

   Cadena = Cadena + (" " * 250);                            || Parte Observaciones
   Cadena = Handle + " " + Cadena; |FGRABA Cadena; Cadena = "";
|FPRC;

|PROCESO QuitaComas;
     aCadena = "";
     aLong   = aAlfa % 0;
     nLong   = aLong;
     |PARA nCont = 1;  |SI nCont [ aLong;  |HACIENDO nCont = nCont + 1;
           nPos = (100 * nCont) + 1;
           aCaracter = aAlfa % nPos;
           |SI aCaracter = ",";  aCaracter = " ";  |FINSI;
           |SI aCaracter = "¥";  aCaracter = &209; |FINSI;
           |SI aCaracter = "¤";  aCaracter = &209; |FINSI;
           |SI aCaracter = "§";  aCaracter = &176; |FINSI;
           |SI aCaracter = "¦";  aCaracter = &170; |FINSI;
           aCadena = aCadena + aCaracter;
     |SIGUE;
     aAlfa = aCadena;

     aAlfa = aAlfa > aAlfa;
|FPRC;

|PROCESO CargaFichero2001;
     Raiz       = "";  |DIRECTORIO Raiz;
     Directorio = "";
     |DBASE Directorio;
     Directorio = Directorio + "hacienda/" + aTipoSec;
     |MKDIR Directorio;
     Directorio = Directorio + "/";
     Valfa = Raiz + "bin/agichmod 777 " + Directorio;

     Empresa  = #10#0;  Empresa  = ("00000" + Empresa) % -105;

     Fichero    = aTipoSec + Empresa; aNombre = Fichero;
     INEmpresas = NEmpresas1 <-;
     INEmpresas = INEmpresas + NACopiar;
     NFichero   = Directorio + Fichero;          |QBF NFichero;
     NEmpresas  = NFichero;
     NACopiar   = NACopiar + 1;

     Fichero  = "wb  "+ NFichero;

     Pos = -1;
     |FABRE Fichero;
     Handle = FSalida;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |SI #0#32 = "L";
         |SI #0#2 = 1998;
             |PARA XPara = 1;  |SI XPara [ 75;  |HACIENDO XPara = XPara + 1;
                   Cadena = Handle + " " + #98XPara;
                   |FGRABA Cadena;
             |SIGUE;
         |SINO;
             |SI #eosem131#34 = "PESETAS";
                 |PARA XPara = 1;  |SI XPara [ 70;  |HACIENDO XPara = XPara + 1;
                   |SI XPara = 6;  |O XPara = 7;  |O XPara = 8; |O XPara = 9;
                   |O  XPara = 15; |O XPara = 16; |O XPara = 66;
                       aAlfa = #99XPara; |HAZ QuitaComas; #99XPara = aAlfa;
                   |FINSI;
                   Cadena = Handle + " " + #99XPara;
                   |FGRABA Cadena;
                 |SIGUE;
             |SINO;
                 #99#1 = "133";
                 |PARA XPara = 1;  |SI XPara [ 51;  |HACIENDO XPara = XPara + 1;
                    |SI XPara = 6;  |O XPara = 7;  |O XPara = 8; |O XPara = 9;
                     |O XPara = 15; |O XPara = 16; |O XPara = 70;
                        aAlfa = #99XPara; |HAZ QuitaComas; #99XPara = aAlfa;
                    |FINSI;
                    Cadena = Handle + " " + #99XPara; |FGRABA Cadena;
                 |SIGUE;

                 CantiNum = #10#42 + #10#46;  |HAZ Valor;  Cadena = Handle + " " + CantiAlfa; |FGRABA Cadena;
                 Cadena = Handle + " 000000000000"; |FGRABA Cadena;
                 Cadena = Handle + " " + #99#52;    |FGRABA Cadena;
                 |PARA XPara = 54; |SI XPara [ 60;  |HACIENDO XPara = XPara + 1;
                      Cadena = Handle + " " + #99XPara; |FGRABA Cadena;
                 |SIGUE;
                 |SI #eosm0020#47 < 0;
                     Cadena = Handle + " X";
                 |SINO;
                     Cadena = Handle + "  ";
                 |FINSI;
                 Cadena = Cadena + "              "; |FGRABA Cadena;
                 |PARA XPara = 61; |SI XPara [ 70;  |HACIENDO XPara = XPara + 1;
                       Cadena = Handle + " " + #99XPara; |FGRABA Cadena;
                 |SIGUE;
             |FINSI;
         |FINSI;
         SwGraba = 1;
     |SINO;
         nCalc = #0#2;
         |HAZ Internet;
         SwGraba = 2;
     |FINSI;
     FSalida = Handle;
     |FCIERRA FSalida;

     |SI #0#32 = "F";
         aAlfa = ""; |IP_REMOTO aAlfa;
         |DBASE aDirOri; |QBF aDirOri;
         aDirOri = aDirOri + "hacienda/" + aTipoSec + "/";
         aDirDes = "/MODELOS";
         |SI aAlfa ! ""; |RMKDIR aDirDes; |SINO; |MKDIR aDirDes; |FINSI;
         aDirDes = "/MODELOS/INTERNET";
         |SI aAlfa ! ""; |RMKDIR aDirDes; |SINO; |MKDIR aDirDes; |FINSI;
         aDirDes = "/MODELOS/INTERNET/" + aTipoSec;
         |SI aAlfa ! ""; |RMKDIR aDirDes; |SINO; |MKDIR aDirDes; |FINSI;
         aDirDes = aDirDes + "/";
         aOrigen = aDirOri + aNombre; aDestino = aDirDes + aNombre;
         |SI aAlfa ! ""; |ENVIA_FICHERO aOrigen, aDestino; |SINO; |COPIA_FICHERO aOrigen, aDestino; |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaImprime;
     aAlfa = "del err" + (("00000" + #10#0) % -105) + ".TXT" + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "wait mipf32 ";
     aAlfa = aAlfa + "/E:131" + (("00000" + #10#0) % -105) + ".TXT ";
     aAlfa = aAlfa + "/R:err" + (("00000" + #10#0) % -105) + ".TXT ";
     |SI eaImpresora ! "";
         aAlfa = aAlfa + "/I:" + &34 + eaImpresora + &34;
     |FINSI;
     aAlfa = aAlfa + " /C:" + #601#0;
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "DEL " + "131" + (("00000" + #10#0) % -105) + ".TXT ";
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle1, aAlfa;
|FPRC;


|PROCESO LeeModelo;
     comunero   = "";
     Contador   = 0;
     nSeImprime = 0;
     |PARA Campo2 = 6; |SI Campo2 [ 34; |HACIENDO Campo2 = Campo2 + 7;
           Campo7 = Campo2 + 5;
           |SI #10Campo2 = "C";
               Contador = Contador + 1;
               nSeImprime = 1;
           |FINSI;

           |SI #10Campo2 = "N";
               |SI #10Campo7 ! 0; nSeImprime = 1; |FINSI;
           |FINSI;
     |SIGUE;

     |SI #10#43 ! 0; |O #10#44 ! 0; |O #10#45 ! 0; |O #10#46 ! 0; |O #10#47 ! 0;
         nSeImprime = 1;
     |FINSI;

     |SI #10#11 = 0; |Y #10#18 = 0; |Y #10#25 = 0; |Y #10#32 = 0; |Y #10#39 = 0;
      |Y #10#40 = 0; |Y #10#41 = 0; |Y #10#43 = 0; |Y #10#45 = 0; |Y #10#47 = 0;
         nSeImprime = 1;
     |FINSI;

     |SI nSeImprime ! 0; |Y #0#32 ! "B";
         #10#3 = #0#6;
         |GRABA 020#10a;
         |LIBERA #10;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO CargaEpi2002;
     Campo3 = Campo2 + 1;
     Campo4 = Campo2 + 2;
     Campo5 = Campo2 + 3;
     Campo6 = Campo2 + 4;
     Campo7 = Campo2 + 5;

     Posi   = 0;
     |SI #543#41 = "0000000000000";  Posi = 38;  |FINSI;
     |SI #543#37 = "0000000000000";  Posi = 34;  |FINSI;
     |SI #543#33 = "0000000000000";  Posi = 30;  |FINSI;
     |SI #543#29 = "0000000000000";  Posi = 26;  |FINSI;
     |SI #543#25 = "0000000000000";  Posi = 22;  |FINSI;

                       #543Posi = #10Campo4;
     Posi = Posi + 1;  enNume   = #10Campo5;  |HAZ Conver13;  #543Posi = eaAlfa;
     Posi = Posi + 1;  enNume    = #10Campo6 * 100;
                       aAlfa = ("00000" + enNume) % -105;     #543Posi = aAlfa;
     Posi = Posi + 1;  enNume   = #10Campo7;  |HAZ Conver13;  #543Posi = eaAlfa;
|FPRC;

|PROCESO TDeclaracion;
     |SI #10#47 > 0;
         enNume = #10#47;  |HAZ Conver13;  #543#52 = eaAlfa;

         |SI #0#35 = "S";  |O #0#35 = "D";
             |SI #5#5 = "          ";
                  #543#53 = "X";
             |SINO;
                  #543#54 = "X";
                  #543#55 = #5#2;            || entidad
                  #543#56 = #5#3;            || oficina
                  #543#57 = #5#4;            || DC
                  #543#58 = #5#5;           || cuenta
             |FINSI;
         |SINO;
             #543#53 = "X";
         |FINSI;
      |SINO;
         enNume  = 0;  |HAZ Conver13;  #543#52 = eaAlfa;
      |FINSI;

      #543#4 = "";
      |SI #0#32 = "L";
          |SI #10#47 [ 0;  #543#4 = "N";  |FINSI;
      |SINO;
          #543#4 = "N";
          |SI #10#47 > 0;  #543#4 = "I";  |FINSI;
      |FINSI;
|FPRC;

|PROCESO Carga131_2002;
     |ABRE #50;
     #50#0 = #2#0;
     |LEE 000#50=;
     |SI FSalida ! 0;  |DDEFECTO #50;  |FINSI;
     |CIERRA #50;

     |DDEFECTO #543;

     #543#1   = "131";
     #543#2   = "01";
     #543#3   = "";

     #543#5   = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);
     aAlfa    = #2#1;  |QBF aAlfa;
     #543#6   = ("000000000" + aAlfa) % -109;
     #543#7   = #50#2;
     eaAlfa   = #2#2;    |HAZ QuitaRaros;     #543#8   = eaAlfa;
     #543#9   = ".";
     eaAlfa   = #2#4;    |HAZ QuitaRaros;     #543#10  = eaAlfa;
     eaAlfa   = #2#5;    |HAZ QuitaRaros;     #543#11  = eaAlfa;
     #543#12  = #2#6;
     #543#13  = #2#7;
     #543#14  = #2#8;
     #543#15  = #2#9;
     #543#16  = (("00" + #2#10) % -102) + (("000" + #2#11) % -103);
     eaAlfa   = #2#13;   |HAZ QuitaRaros;     #543#17  = eaAlfa;
     eaAlfa   = #2#12;   |HAZ QuitaRaros;     #543#18  = eaAlfa;
     eaAlfa   = #2#14;   |HAZ QuitaRarosTfno; #543#19 = eaAlfa;

     #543#20  = #0#2;
     #543#21  = #0#4 + "T";

     |PARA Campo2 = 6;  |SI Campo2 [ 34;  |HACIENDO Campo2 = Campo2 + 7;
           |SI #10Campo2 ! "S";  |HAZ CargaEpi2002;  |FINSI;
     |SIGUE;

     enNume  = #10#40;  |HAZ Conver13;  #543#42 = eaAlfa;
     enNume  = #10#41;  |HAZ Conver13;  #543#43 = eaAlfa;
     enNume  = #10#42;  |HAZ Conver13;  #543#44 = eaAlfa;
     enNume  = #10#43;  |HAZ Conver13;  #543#45 = eaAlfa;
     enNume  = #10#44;  |HAZ Conver13;  #543#46 = eaAlfa;
     enNume  = #10#45;  |HAZ Conver13;  #543#47 = eaAlfa;
     enNume  = #10#46;  |HAZ Conver13;  #543#48 = eaAlfa;
     enNume  = #10#47;  |HAZ Conver13;  #543#49 = eaAlfa;
     enNume  = #10#47;  |HAZ Conver13;  #543#51 = eaAlfa;

     |HAZ TDeclaracion;

     |SI #10#48 = "S";
         #543#59 = #10#50;
         #543#60 = #10#49;
     |FINSI;

     eaAlfa  = #2#2;     |HAZ QuitaRaros;     #543#61  = eaAlfa;
     eaAlfa  = #2#14;    |HAZ QuitaRarosTfno; #543#62  = eaAlfa;

     eaAlfa  = #0#6;     |HAZ FechaBonito;
     eaAlfa  = #2#13;    |HAZ QuitaRaros;     #543#72 = eaAlfa;
     #543#73 = eaDiaB;
     #543#74 = eaMesB;
     #543#75 = eaAnyoB;
     #543#76 = &13 + &10;

     |SI #0#32 = "L";
         #543#7  = "";
         #543#59 = "";
         #543#62 = "";
         #543#63 = "";
         #543#64 = "";
         nTCampo = 76;
     |FINSI;

     |SI #0#32 = "F";
         #543#2  = "";
         #543#3  = "";
         #543#5  = "";
         #543#8  = "";
         #543#9  = "";
         #543#10 = "";
         #543#11 = "";
         #543#12 = "";
         #543#13 = "";
         #543#14 = "";
         #543#15 = "";
         #543#16 = "";
         #543#17 = "";
         #543#18 = "";
         #543#19 = "";
         #543#53 = "";
         #543#54 = "";
         #543#55 = "";
         #543#56 = "";
         #543#57 = "";
         #543#58 = "";
         #543#67 = "";
         #543#68 = "";
         #543#69 = "";
         #543#70 = "";
         #543#71 = "";
         #543#72 = "";
         #543#73 = "";
         #543#74 = "";
         #543#75 = "";
         #543#76 = "";
         nTCampo = 75;
     |FINSI;
|FPRC;

|PROCESO CargaEpi2007;
     Campo3 = Campo2 + 1;
     Campo4 = Campo2 + 2;
     Campo5 = Campo2 + 3;
     Campo6 = Campo2 + 4;
     Campo7 = Campo2 + 5;

     Posi   = 0;
     |SI #571#31 = "0000000000000";  Posi = 28;  |FINSI;
     |SI #571#27 = "0000000000000";  Posi = 24;  |FINSI;
     |SI #571#23 = "0000000000000";  Posi = 20;  |FINSI;
     |SI #571#19 = "0000000000000";  Posi = 16;  |FINSI;
     |SI #571#15 = "0000000000000";  Posi = 12;  |FINSI;

                       #571Posi = #10Campo4;
     Posi = Posi + 1;  enNume   = #10Campo5;  |HAZ Conver13;  #571Posi = eaAlfa;
     Posi = Posi + 1;  enNume   = #10Campo6 * 100;
                       aAlfa = ("00000" + enNume) % -105;     #571Posi = aAlfa;
     Posi = Posi + 1;  enNume   = #10Campo7;  |HAZ Conver13;  #571Posi = eaAlfa;
|FPRC;

|PROCESO TDeclaracion_2007;
     |SI #10#47 > 0;
         enNume = #10#47;  |HAZ Conver13;  #571#44 = eaAlfa;

         |SI #0#35 = "S";  |O #0#35 = "D";
             |SI #5#5 = "          ";
                  #571#45 = "1";
             |SINO;
                  #571#45 = "2";
                  |SI #0#32 = "F"; |Y #0#35 = "D";
                      #571#45 = "3";
                  |FINSI;
                  #571#46 = #5#2;            || entidad
                  #571#47 = #5#3;            || oficina
                  #571#48 = #5#4;            || DC
                  #571#49 = #5#5;            || cuenta
             |FINSI;
         |SINO;
             #571#45 = "1";
         |FINSI;
      |SINO;
         enNume  = 0;  |HAZ Conver13;    #571#44 = eaAlfa;
                                         #571#45 = "0";
         |SI #10#47 < 0;                 #571#50 = "X";  |FINSI;
         || ..  |SI #10#47 < 0;  |Y #10#2 ! 4;  #571#50 = "X";  |FINSI; tique 1225 - 117 (11.01.2008)
      |FINSI;

      #571#4 = "";
      |SI #0#32 = "L";
          |SI #10#47 [ 0;  |Y #571#50 = " ";  #571#4 = "N";  |FINSI;
      |SINO;
          #571#4 = "B";
          |SI #10#47 = 0;
              #571#4 = "N";
          |FINSI;
          |SI #10#47 > 0;
                                                    #571#4 = "I";
              |SI  #0#35 = "A";   |Y #0#2 < 2013;   #571#4 = "A";  |FINSI;
              |SI  #571#45 = "3";                   #571#4 = "U";  |FINSI;
          |FINSI;
      |FINSI;
|FPRC;

|PROCESO Carga131_2007;
     |ABRE #50;
     #50#0 = #2#0;
     |LEE 000#50=;
     |SI FSalida ! 0;  |DDEFECTO #50;  |FINSI;
     |CIERRA #50;

     |DDEFECTO #571;

     #571#1   = "131";
     #571#2   = "01";
     #571#3   = "";

     #571#5   = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);
     aAlfa    = #2#1;  |QBF aAlfa;
     #571#6   = ("000000000" + aAlfa) % -109;
     #571#7   = #50#2;
     eaAlfa   = #2#2;    |HAZ QuitaRaros;     #571#8   = eaAlfa;
     #571#9   = ".";
     #571#10  = #0#2;
     #571#11  = #0#4 + "T";

     |PARA Campo2 = 6;  |SI Campo2 [ 34;  |HACIENDO Campo2 = Campo2 + 7;
           |SI #10Campo2 ! "S";  |HAZ CargaEpi2007;  |FINSI;
     |SIGUE;

     enNume  = #10#40;  |HAZ Conver13;  #571#32 = eaAlfa;
     enNume  = #10#51;  |HAZ Conver13;  #571#33 = eaAlfa;
     enNume  = #10#52;  |HAZ Conver13;  #571#34 = eaAlfa;
     enNume  = #10#43;  |HAZ Conver13;  #571#35 = eaAlfa;
     enNume  = #10#44;  |HAZ Conver13;  #571#36 = eaAlfa;
     enNume  = #10#53;  |HAZ Conver13;  #571#37 = eaAlfa;
     enNume  = #10#54;  |HAZ Conver13;  #571#38 = eaAlfa;
     enNume  = #10#55;  |HAZ Conver13;  #571#39 = eaAlfa;
     enNume  = #10#56;  |HAZ Conver13;  #571#40 = eaAlfa;
     enNume  = #10#57;  |HAZ Conver13;  #571#41 = eaAlfa;
     enNume  = #10#58;  |HAZ Conver13;  #571#42 = eaAlfa;
     enNume  = #10#47;  |HAZ Conver13;  #571#43 = eaAlfa;

     |HAZ TDeclaracion_2007;

     |SI #10#48 = "S";
         #571#51 = #10#50;
         #571#52 = #10#49;
     |FINSI;

     eaAlfa  = #2#2;     |HAZ QuitaRaros;     #571#53  = eaAlfa;
     eaAlfa  = #2#14;    |HAZ QuitaRarosTfno; #571#54  = eaAlfa;

     eaAlfa  = #0#6;     |HAZ FechaBonito;
     eaAlfa  = #2#13;    |HAZ QuitaRaros;     #571#59 = eaAlfa;
     #571#60 = eaDiaB;
     #571#61 = eaMesB;
     #571#62 = eaAnyoB;
     #571#63 = &13 + &10;

     |SI #0#32 = "L";
         #571#7  = "";
         #571#51 = "";
         #571#53 = "";
         #571#54 = "";
         #571#55 = "";
         nTCampo = 63;
     |FINSI;

     |SI #0#32 = "F";
         #571#2  = "";
         #571#3  = "";
         #571#5  = "";
         #571#8  = "";
         #571#9  = "";
         #571#59 = "";
         #571#60 = "";
         #571#61 = "";
         #571#62 = "";
         #571#63 = "";
         nTCampo = 62;
     |FINSI;
|FPRC;

|PROCESO CargaEpi2008;
     Campo3 = Campo2 + 1;
     Campo4 = Campo2 + 2;
     Campo5 = Campo2 + 3;
     Campo6 = Campo2 + 4;
     Campo7 = Campo2 + 5;

     Posi   = 0;
     |SI #577#31 = "0000000000000";  Posi = 28;  |FINSI;
     |SI #577#27 = "0000000000000";  Posi = 24;  |FINSI;
     |SI #577#23 = "0000000000000";  Posi = 20;  |FINSI;
     |SI #577#19 = "0000000000000";  Posi = 16;  |FINSI;
     |SI #577#15 = "0000000000000";  Posi = 12;  |FINSI;

                       #577Posi = #10Campo4;
     Posi = Posi + 1;  enNume   = #10Campo5;  |HAZ Conver13;  #577Posi = eaAlfa;
     Posi = Posi + 1;  enNume   = #10Campo6 * 100;
                       aAlfa = ("00000" + enNume) % -105;     #577Posi = aAlfa;
     Posi = Posi + 1;  enNume   = #10Campo7;  |HAZ Conver13;  #577Posi = eaAlfa;
|FPRC;

|PROCESO TDeclaracion_2008_04;
     |SI #10#47 > 0;
         enNume = #10#47;  |HAZ Conver13;  #577#45 = eaAlfa;

         |SI #0#35 = "S";  |O #0#35 = "D";
             |SI #5#5 = "          ";
                  #577#46 = "1";
             |SINO;
                  #577#46 = "2";
                  |SI #0#32 = "F"; |Y #0#35 = "D";
                      #577#46 = "3";
                  |FINSI;
                  #577#47 = #5#2;            || entidad
                  #577#48 = #5#3;            || oficina
                  #577#49 = #5#4;            || DC
                  #577#50 = #5#5;            || cuenta
             |FINSI;
         |SINO;
             #577#46 = "1";
         |FINSI;
      |SINO;
         enNume  = 0;  |HAZ Conver13;    #577#45 = eaAlfa;
                                         #577#46 = "0";
         |SI #10#47 < 0; |Y #10#2 ! 4;   #577#51 = "X";  |FINSI;
         || ..  |SI #10#47 < 0;  |Y #10#2 ! 4;  #577#51 = "X";  |FINSI; tique 1225 - 117 (11.01.2008)
      |FINSI;

      #577#4 = "";
      |SI #0#32 = "L";
          |SI #10#47 [ 0;  |Y #577#51 = " ";  #577#4 = "N";  |FINSI;
      |SINO;

          #577#4 = "N";
          |SI #10#47 < 0; |Y #10#2 ! 4; #577#4 = "B"; |FINSI;

          |SI #10#47 > 0;
                                                    #577#4 = "I";
              |SI  #0#35 = "A";  |Y #0#2 < 2013;    #577#4 = "A";  |FINSI;
              |SI  #577#46 = "3";                   #577#4 = "U";  |FINSI;
          |FINSI;
      |FINSI;
|FPRC;

|PROCESO Carga131_2008_04;
     |ABRE #50;
     #50#0 = #2#0;
     |LEE 000#50=;
     |SI FSalida ! 0;  |DDEFECTO #50;  |FINSI;
     |CIERRA #50;

     |DDEFECTO #577;

     #577#1   = "131";
     #577#2   = "01";
     #577#3   = "";

     #577#5   = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);
     aAlfa    = #2#1;  |QBF aAlfa;
     #577#6   = ("000000000" + aAlfa) % -109;
     #577#7   = #50#2;
     eaAlfa   = #2#2;    |HAZ QuitaRaros;     #577#8   = eaAlfa;
     #577#9   = ".";
     #577#10  = #0#2;
     #577#11  = #0#4 + "T";

     |PARA Campo2 = 6;  |SI Campo2 [ 34;  |HACIENDO Campo2 = Campo2 + 7;
           |SI #10Campo2 ! "S";  |HAZ CargaEpi2008;  |FINSI;
     |SIGUE;

     enNume  = #10#40;  |HAZ Conver13;  #577#32 = eaAlfa;
     enNume  = #10#51;  |HAZ Conver13;  #577#33 = eaAlfa;
     enNume  = #10#52;  |HAZ Conver13;  #577#34 = eaAlfa;
     enNume  = #10#43;  |HAZ Conver13;  #577#35 = eaAlfa;
     enNume  = #10#44;  |HAZ Conver13;  #577#36 = eaAlfa;
     enNume  = #10#53;  |HAZ Conver13;  #577#37 = eaAlfa;
     enNume  = #10#54;  |HAZ Conver13;  #577#38 = eaAlfa;
     enNume  = #10#59;  |HAZ Conver13;  #577#39 = eaAlfa;  ||campo minoracion

     enNume  = #10#55;  |HAZ Conver13;  #577#40 = eaAlfa;
     enNume  = #10#56;  |HAZ Conver13;  #577#41 = eaAlfa;
     enNume  = #10#57;  |HAZ Conver13;  #577#42 = eaAlfa;
     enNume  = #10#58;  |HAZ Conver13;  #577#43 = eaAlfa;
     enNume  = #10#47;  |HAZ Conver13;  #577#44 = eaAlfa;

     |HAZ TDeclaracion_2008_04;

     |SI #10#48 = "S";
         #577#52 = #10#50;
         #577#53 = #10#49;
     |FINSI;

     eaAlfa  = #2#2;     |HAZ QuitaRaros;     #577#54  = eaAlfa;
     eaAlfa  = #2#14;    |HAZ QuitaRarosTfno; #577#55  = eaAlfa;

     eaAlfa  = #0#6;     |HAZ FechaBonito;
     eaAlfa  = #2#13;    |HAZ QuitaRaros;     #577#60 = eaAlfa;
     #577#61 = eaDiaB;
     #577#62 = eaMesB;
     #577#63 = eaAnyoB;
     #577#64 = &13 + &10;

     |SI #0#32 = "L";
         #577#7  = "";
         #577#52 = "";
         #577#54 = "";
         #577#55 = "";
         #577#56 = "";
         nTCampo = 64;
     |FINSI;

     |SI #0#32 = "F";
         #577#2  = "";
         #577#3  = "";
         #577#5  = "";
         #577#8  = "";
         #577#9  = "";
         #577#60 = "";
         #577#61 = "";
         #577#62 = "";
         #577#63 = "";
         #577#64 = "";
         nTCampo = 63;
     |FINSI;
|FPRC;

|PROCESO CargaEpi2009;
     Campo3 = Campo2 + 1;
     Campo4 = Campo2 + 2;
     Campo5 = Campo2 + 3;
     Campo6 = Campo2 + 4;
     Campo7 = Campo2 + 5;

     Posi   = 0;
     |SI #594#31 = "0000000000000";  Posi = 28;  |FINSI;
     |SI #594#27 = "0000000000000";  Posi = 24;  |FINSI;
     |SI #594#23 = "0000000000000";  Posi = 20;  |FINSI;
     |SI #594#19 = "0000000000000";  Posi = 16;  |FINSI;
     |SI #594#15 = "0000000000000";  Posi = 12;  |FINSI;

                       #594Posi = #10Campo4;
     Posi = Posi + 1;  enNume   = #10Campo5;  |HAZ Conver13;  #594Posi = eaAlfa;
     Posi = Posi + 1;  enNume   = #10Campo6 * 100;
                       aAlfa = ("00000" + enNume) % -105;     #594Posi = aAlfa;
     Posi = Posi + 1;  enNume   = #10Campo7;  |HAZ Conver13;  #594Posi = eaAlfa;
|FPRC;

|PROCESO TDeclaracion_2009;
     |SI #10#47 > 0;
         enNume = #10#47;  |HAZ Conver13;  #594#47 = eaAlfa;

         |SI #0#35 = "S";  |O #0#35 = "D";
             |SI #5#5 = "          ";
                  #594#48 = "1";
             |SINO;
                  #594#48 = "2";
                  |SI #0#32 = "F"; |Y #0#35 = "D";
                      #594#48 = "3";
                  |FINSI;
                  #594#49 = #5#2;            || entidad
                  #594#50 = #5#3;            || oficina
                  #594#51 = #5#4;            || DC
                  #594#52 = #5#5;            || cuenta
             |FINSI;
         |SINO;
             #594#48 = "1";
         |FINSI;
      |SINO;
         enNume  = 0;  |HAZ Conver13;    #594#47 = eaAlfa;
                                         #594#48 = "0";
         |SI #10#47 < 0; |Y #10#2 ! 4;   #594#53 = "X";  |FINSI;
         || ..  |SI #10#47 < 0;  |Y #10#2 ! 4;  #594#53 = "X";  |FINSI; tique 1225 - 117 (11.01.2008)
      |FINSI;

      #594#4 = "";
      |SI #0#32 = "L";
          |SI #10#47 [ 0;  |Y #594#53 = " ";  #594#4 = "N";  |FINSI;
      |SINO;

          #594#4 = "N";
          |SI #10#47 < 0; |Y #10#2 ! 4; #594#4 = "B"; |FINSI;

          |SI #10#47 > 0;
                                                    #594#4 = "I";
              |SI  #0#35   = "A";  |Y #0#2 < 2013;  #594#4 = "A";  |FINSI;
              |SI  #594#48 = "3";                   #594#4 = "U";  |FINSI;
          |FINSI;
      |FINSI;
|FPRC;

|PROCESO Carga131_2009;
     |ABRE #50;
     #50#0 = #2#0;
     |LEE 000#50=;
     |SI FSalida ! 0;  |DDEFECTO #50;  |FINSI;
     |CIERRA #50;

     |DDEFECTO #594;

     #594#1   = "131";
     #594#2   = "01";
     #594#3   = "";

     #594#5   = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);
     aAlfa    = #2#1;  |QBF aAlfa;
     #594#6   = ("000000000" + aAlfa) % -109;
     #594#7   = #50#2;
     eaAlfa   = #2#2;    |HAZ QuitaRaros;     #594#8   = eaAlfa;
     #594#9   = ".";
     #594#10  = #0#2;
     #594#11  = #0#4 + "T";

     |PARA Campo2 = 6;  |SI Campo2 [ 34;  |HACIENDO Campo2 = Campo2 + 7;
           |SI #10Campo2 ! "S";  |HAZ CargaEpi2009;  |FINSI;
     |SIGUE;

     enNume  = #10#60;  |HAZ Conver13;  #594#32 = eaAlfa;
     enNume  = #10#40;  |HAZ Conver13;  #594#33 = eaAlfa;
     enNume  = #10#51;  |HAZ Conver13;  #594#34 = eaAlfa;
     enNume  = #10#52;  |HAZ Conver13;  #594#35 = eaAlfa;
     enNume  = #10#43;  |HAZ Conver13;  #594#36 = eaAlfa;
     enNume  = #10#44;  |HAZ Conver13;  #594#37 = eaAlfa;
     enNume  = #10#53;  |HAZ Conver13;  #594#38 = eaAlfa;
     enNume  = #10#54;  |HAZ Conver13;  #594#39 = eaAlfa;
     enNume  = #10#59;  |HAZ Conver13;  #594#40 = eaAlfa;  ||campo minoracion

     enNume  = #10#55;  |HAZ Conver13;  #594#41 = eaAlfa;
     enNume  = #10#56;  |HAZ Conver13;  #594#42 = eaAlfa;
     enNume  = #10#61;  |HAZ Conver13;  #594#43 = eaAlfa;
     enNume  = #10#57;  |HAZ Conver13;  #594#44 = eaAlfa;
     enNume  = #10#58;  |HAZ Conver13;  #594#45 = eaAlfa;
     enNume  = #10#47;  |HAZ Conver13;  #594#46 = eaAlfa;

     |HAZ TDeclaracion_2009;

     |SI #10#48 = "S";
         #594#54 = #10#50;
         #594#55 = #10#49;
     |FINSI;

     eaAlfa  = #2#2;     |HAZ QuitaRaros;     #594#56  = eaAlfa;
     eaAlfa  = #2#14;    |HAZ QuitaRarosTfno; #594#57  = eaAlfa;

     eaAlfa  = #0#6;     |HAZ FechaBonito;
     eaAlfa  = #2#13;    |HAZ QuitaRaros;     #594#62 = eaAlfa;
     #594#63 = eaDiaB;
     #594#64 = eaMesB;
     #594#65 = eaAnyoB;
     #594#66 = &13 + &10;

     |SI #0#32 = "L";
         #594#7  = "";
         #594#54 = "";
         #594#56 = "";
         #594#57 = "";
         #594#58 = "";
         nTCampo = 66;
     |FINSI;

     |SI #0#32 = "F";
         #594#2  = "";
         #594#3  = "";
         #594#5  = "";
         #594#8  = "";
         #594#9  = "";
         #594#62 = "";
         #594#63 = "";
         #594#64 = "";
         #594#65 = "";
         #594#66 = "";
         nTCampo = 65;
     |FINSI;
|FPRC;

|PROCESO CargaFichero2002;
     |SI #0#32 = "L";
         aAbre = "\MODELOS\131\" + "131" + (("00000" + #2#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |SI #0#32 = "F";
         aAbre = eaInternet + "131" + (("00000" + #2#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |SI #0#2 ] 2002;  |Y #0#2 [ 2006;
         aAlfa = "";
         |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #543nCampo;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
     |FINSI;

     |SI #0#2 = 2007;
         aAlfa = "";
         |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #571nCampo;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
     |FINSI;

     |SI #0#2 = 2008;
         |SI #0#4 ] 2;
              aAlfa = "";
              |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
                    aAlfa = #577nCampo;
                    |XGRABA nHandle2, aAlfa;
              |SIGUE;
         |SINO;
              aAlfa = "";
              |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
                    aAlfa = #571nCampo;
                    |XGRABA nHandle2, aAlfa;
              |SIGUE;
         |FINSI;
     |FINSI;

     |SI #0#2 ] 2009;
         aAlfa = "";
         |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #594nCampo;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
     |FINSI;

     |XCIERRA nHandle2;

     |SI #0#32 = "L";
         |HAZ CargaImprime;
     |FINSI;

     #10#3 = #0#6;
     |GRABA 020#10a;
     |LIBERA #10;

     nSwHay = 1;
|FPRC;

|PROCESO MiroComunidad;
 |ABRE #110;
 #110#0 = #4#0;
 #110#1 = #10#1;
 #110#2 = #10#2;
 |LEE 001#110=;
 |SI FSalida = 0;
     #110#3 = #0#6;
     |GRABA 020#110a;
 |FINSI;
 |LIBERA #110;
 |CIERRA #110;
|FPRC;

|DEFBUCLE MiroComunidad;
 #4#2;
 ;
 #10#0, nNume1, #10#1;
 #10#0, nNume1, #10#1;
 ;
 NULL, MiroComunidad;
|FIN;

|PROCESO VerComunidad;
  |PARA Campo2 = 6; |SI Campo2 [ 34; |HACIENDO Campo2 = Campo2 + 7;
        Campo7 = Campo2 - 1;
        |SI #10Campo2  = "C";
            nNume1 = #10Campo7;
            |BUCLE MiroComunidad;
        |FINSI;
  |SIGUE;

|FPRC;

|PROCESO Chequeo98L;
     |SI #0#33 ! "N";
         #2#0 = #10#0;
         |LEE 040#2=;
         |SI FSalida ! 0; |DDEFECTO #2; |FINSI;
     |FINSI;

     #5#0 = #2#0;
     |LEE 040#5=;                             || Lee Bancos
     |SI FSalida ! 0; |DDEFECTO #5; |FINSI;

     #3#0 = #2#18; #3#1 = #2#19;
     |LEE 040#3=;                             || Lee Hacienda
     |SI FSalida ! 0; |DDEFECTO #3; |FINSI;

     |SI #0#2 [ 2001;
         |SI #0#2 = 1998;  |HAZ CargaTrabajo98;  |FINSI;
         |SI #0#2 ] 1999;  |HAZ CargaTrabajo99;  |FINSI;

         |SI nSeImprime = 0; |ACABA; |FINSI;

         SiHay = 1;
         |BUCLE eosactiv98;
         |SI SiHay = 0; |ACABA; |FINSI;

         |HAZ CargaFichero2001;
     |FINSI;

     |SI #0#2 ] 2002;
         |HAZ LeeModelo;
         |SI nSeImprime = 0; |ACABA; |FINSI;

         |SI #0#2 [ 2006;
             |HAZ Carga131_2002;
         |FINSI;

         |SI #0#2 = 2007;
             |HAZ Carga131_2007;
         |FINSI;

         |SI #0#2 = 2008;
             |SI #0#4 ] 2;
                 |HAZ Carga131_2008_04;
             |SINO;
                 |HAZ Carga131_2007;
             |FINSI;
         |FINSI;

         |SI #0#2 ] 2009;
             |HAZ Carga131_2009;
         |FINSI;

         SiHay = 1;
         |BUCLE eosactiv98;
         |SI SiHay = 0; |ACABA; |FINSI;

         |HAZ CargaFichero2002;
     |FINSI;

     aAlfa    = #0#2 % -102;
     se_empre = #2#0;
     se_ejerc = aAlfa;
     se_perio = #0#4;
     se_tipos = 131;
     se_activ = 10;
     se_impor = #10#47;
     se_fecha = #0#6;
     se_factu = "N";
     |HAZ seguimie;
     |HAZ AlAgicli;
     |HAZ VerComunidad;
|FPRC;

|DEFBUCLE eosm0020L;
     #10#1;
     4;
     DEmpre, nAnyo2D, #0#4, "N";
     HEmpre, nAnyo2D, #0#4, "N";
     be;
     NULL, Chequeo98L;
|FIN;

|PROCESO AlModelo98L;
     DEmpre  = #2#0;
     HEmpre  = #2#0;
     |BUCLE eosm0020L;
|FPRC;

|DEFBUCLE eosclien98L;
  #2#3;
  0;
  Vacio40, #0#0;
  LLeno40, #0#1;
  ;
  NULL, AlModelo98L;
|FIN;


|PROCESO AbreImprime;
     aAbre = "\MODELOS\131\imprime.bat";
     |XABRE "CBW", aAbre, nHandle1;

     aAlfa = "CD \" + &13 + &10;                 |XGRABA nHandle1, aAlfa;
     aAlfa = "CD MODELOS" + &13 + &10;           |XGRABA nHandle1, aAlfa;
     aAlfa = "CD 131" + &13 + &10;               |XGRABA nHandle1, aAlfa;

     aAlfa = #0#2;
     aAlfa = aAlfa % -102;
     aVersion = "";

     |SI #0#2 ] 2008;
         aVersion = "01";
         |SI #0#2 = 2008;
             |SI #0#4 ] 2;
                 aVersion = "02";
             |FINSI;
         |FINSI;
     |FINSI;

     aAlfa1 = "DEL ERRORES.RST" + &13 + &10;      |XGRABA nHandle1, aAlfa1;

     aContiene = "";
     |ESPECIFICA "RBASS", aContiene;
     aUnidad = (aContiene1 % 102) > "";

     |SI aVersion = "";
         aAlfa = "ZLS" + aAlfa + "MPF.EXE /T:" + aUnidad + "\MODELOS\131\"+ &13 + &10;
     |SINO;
         aAlfa = "Z" + aAlfa + aVersion + "MPF.EXE /T:" + aUnidad + "\MODELOS\131\"+ &13 + &10;
     |FINSI;

     |XGRABA nHandle1, aAlfa;

     |SI #0#2 ] 2002;
         aAlfa = "MOVE ERRORM~1.TXT ERRORMIPF.TXT" + &13 + &10;      |XGRABA nHandle1, aAlfa;
         aAlfa = "MOVE EAN128~1.DLL EAN128_32.DLL" + &13 + &10;      |XGRABA nHandle1, aAlfa;
     |FINSI;
|FPRC;

|PROCESO EmiteEsto;
     aAlfa = "DEL *.wmf" + &13 + &10;             |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.tab"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.dll"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errorm~1.txt" + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errormipf.txt"  + &13 + &10;    |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errmipf.txt"  + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.exe"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     |XCIERRA nHandle1;

     eaModelos = "131";   |HAZ Copiampf;

     aAlfa = "\MODELOS\131\IMPRIME";
     |RSYSTEM aAlfa;
|FPRC;

|PROCESO Laser;
     |SI #0#2 [ 2001;
         NACopiar   = 0;
         SwGraba    = 0;
         INEmpresas = NEmpresas1 <-;
         |PARA XPara = 1; |SI XPara [ 700;  |HACIENDO XPara = XPara + 1;
               NEmpresas = "";
              INEmpresas = INEmpresas + 1;
         |SIGUE;
     |SINO;
         |SI #0#32 = "L";
             |PARA;  |SI;  |HACIENDO;
                  |DDEFECTO #601;
                  |PINPA #0#601;
                  |PINDA #0#601;
                  |ENDATOS #1#601;
                  |SI FSalida = 0;
                      aAlfa = "/MODELOS";          |RMKDIR aAlfa;
                      aAlfa = "/MODELOS/131";      |RMKDIR aAlfa;
                      |HAZ AbreImprime;
                      |SAL;
                  |FINSI;
             |SIGUE;
         |FINSI;

         |SI #0#32 = "F";
             aAlfa      = "/AEAT";                       |RMKDIR aAlfa;
             aAlfa      = "/AEAT/INTERNET";              |RMKDIR aAlfa;
             aAlfa      = "/AEAT/INTERNET/131";          |RMKDIR aAlfa;
             aAlfa      = "/AEAT/INTERNET/131/" + #0#2;  |RMKDIR aAlfa;
             eaInternet = aAlfa + "/";
         |FINSI;
     |FINSI;

     |ABRE #3;
     |ABRE #5;

     |SI #0#33 = "N";
         |BUCLE eosclien98L;
     |SINO;
         |ABRE #2;
         |SI #0#7 = "S";
             DEmpre = #0#0;
             HEmpre = #0#1;
             |BUCLE eosm0020L;
         |SINO;
             |PARA x = 8; |SI x [ 31; |HACIENDO x = x + 1;
                   |SI #0x ! 0;
                       DEmpre = #0x;
                       HEmpre = #0x;
                       |BUCLE eosm0020L;
                   |FINSI;
             |SIGUE;
        |FINSI;
        |CIERRA #2;
     |FINSI;

     |CIERRA #3;
     |CIERRA #5;

     |SI #0#2 [ 2001;
         |SI SwGraba = 1; |HAZ GrabaDisketteL;                         |FINSI;
         |SI SwGraba = 2; |MENAV "    Ficheros creados correctamente"; |FINSI;
         |SI SwGraba = 0; |MENAV "      Seleccion Vacia no hay nada para imprimir"; |FINSI;
     |FINSI;

     |SI #0#2 ] 2002;
         |SI #0#32 = "L";
             |SI nSwHay = 1;
                 |HAZ EmiteEsto;
                 eaTipoSec = "131";
                 eaTipoEmi = "ERRORES";
                 enAnyo    = #0#2;
                 |SUB_EJECUTA "eosz9999";
              |SINO;
                 |MENAV "     Seleccion Vacia";
                 |XCIERRA nHandle1;
             |FINSI;
             aAlfa = "\MODELOS\131\imprime.bat";
             |RFBORRA aAlfa;
          |FINSI;

          |SI #0#32 = "F";
              |SI nSwHay = 1;
                  aAlfa =  "      Ficheros Generados. Situados en " + eaInternet + " de su PC";
                  |MENAV aAlfa;
              |SINO;
                 |MENAV "     Seleccion Vacia";
              |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Seleccion;
     |SI #0#32 = "L"; |O #0#32 = "F"; |HAZ Laser;  |FINSI;
     |SI #0#32 ! "L"; |Y #0#32 ! "F"; |HAZ Papel;  |FINSI;
|FPRC;

|| --------------------------------------------------------------------------
|PROCESO Carga131_2013;
     |ABRE #50;
     #50#0 = #2#0;
     |LEE 000#50=;
     |SI FSalida ! 0;  |DDEFECTO #50;  |FINSI;
     |CIERRA #50;

     |DDEFECTO #594;

     #594#1   = "131";
     #594#2   = "01";
     #594#3   = "";

     #594#5   = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);
     aAlfa    = #2#1;  |QBF aAlfa;
     #594#6   = ("000000000" + aAlfa) % -109;
     #594#7   = #50#2;
     eaAlfa   = #2#2;    |HAZ QuitaRaros;     #594#8   = eaAlfa;
     #594#9   = ".";
     #594#10  = #0#2;
     #594#11  = #0#4 + "T";

     |PARA Campo2 = 6;  |SI Campo2 [ 34;  |HACIENDO Campo2 = Campo2 + 7;
           |SI #10Campo2 ! "S";  |HAZ CargaEpi2009;  |FINSI;
     |SIGUE;

     enNume  = #10#60;  |HAZ Conver13;  #594#32 = eaAlfa;
     enNume  = #10#40;  |HAZ Conver13;  #594#33 = eaAlfa;
     enNume  = #10#51;  |HAZ Conver13;  #594#34 = eaAlfa;
     enNume  = #10#52;  |HAZ Conver13;  #594#35 = eaAlfa;
     enNume  = #10#43;  |HAZ Conver13;  #594#36 = eaAlfa;
     enNume  = #10#44;  |HAZ Conver13;  #594#37 = eaAlfa;
     enNume  = #10#53;  |HAZ Conver13;  #594#38 = eaAlfa;
     enNume  = #10#54;  |HAZ Conver13;  #594#39 = eaAlfa;
     enNume  = #10#59;  |HAZ Conver13;  #594#40 = eaAlfa;  ||campo minoracion

     enNume  = #10#55;  |HAZ Conver13;  #594#41 = eaAlfa;
     enNume  = #10#56;  |HAZ Conver13;  #594#42 = eaAlfa;
     enNume  = #10#61;  |HAZ Conver13;  #594#43 = eaAlfa;
     enNume  = #10#57;  |HAZ Conver13;  #594#44 = eaAlfa;
     enNume  = #10#58;  |HAZ Conver13;  #594#45 = eaAlfa;
     enNume  = #10#47;  |HAZ Conver13;  #594#46 = eaAlfa;

     |HAZ TDeclaracion_2009;

     |SI #10#48 = "S";
         #594#54 = #10#50;
         #594#55 = #10#49;
     |FINSI;

     eaAlfa  = #2#2;     |HAZ QuitaRaros;     #594#56  = eaAlfa;
     eaAlfa  = #2#14;    |HAZ QuitaRarosTfno; #594#57  = eaAlfa;

     eaAlfa  = #0#6;     |HAZ FechaBonito;
     eaAlfa  = #2#13;    |HAZ QuitaRaros;     #594#62 = eaAlfa;
     #594#63 = eaDiaB;
     #594#64 = eaMesB;
     #594#65 = eaAnyoB;
     #594#66 = &13 + &10;

     |SI nTecla = 1;
         #594#7  = "";
         #594#54 = "";
         #594#56 = "";
         #594#57 = "";
         #594#58 = "";
         nTCampo = 66;
     |FINSI;

     |SI nTecla = 3;
         #594#2  = "";
         #594#3  = "";
         #594#5  = "";
         #594#8  = "";
         #594#9  = "";
         #594#62 = "";
         #594#63 = "";
         #594#64 = "";
         #594#65 = "";
         #594#66 = "";
         nTCampo = 65;
     |FINSI;

     SiHay = 1;
     |BUCLE eosactiv98;
     |SI SiHay = 0; |ACABA; |FINSI;

     |SI nTecla ! 4;
         aAlfa = "";
         |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #594nCampo;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
     |SINO;
         |PRINT;
         |PIEINF;
     |FINSI;
     nSwHay = 1;
|FPRC;

|PROCESO Chequeo98L_2013;

     |SI #0#33 ! "N";
         #2#0 = #10#0;
         |LEE 040#2=;
         |SI FSalida ! 0; |DDEFECTO #2; |FINSI;
     |FINSI;

     #5#0 = #2#0;
     |LEE 040#5=;                             || Lee Bancos
     |SI FSalida ! 0; |DDEFECTO #5; |FINSI;

     #3#0 = #2#18; #3#1 = #2#19;
     |LEE 040#3=;                             || Lee Hacienda
     |SI FSalida ! 0; |DDEFECTO #3; |FINSI;
     eaAdmin = #3#2;
     eaDeleg = #3#3;

     |HAZ LeeModelo;
     |SI nSeImprime = 0; |ACABA; |FINSI;

     eaFicheroPlano = "131" + (("00000" + #2#0) % -105) + ".txt";
     eaFicheroImpre = "131" + (("00000" + #2#0) % -105) + ".pdf";
     eaFicheroError = "err" + (("00000" + #2#0) % -105) + ".txt";

     aAlfa = eaPathLanza + eaFicheroPlano;  |RFBORRA aAlfa;
     aAlfa = eaPathLanza + eaFicheroImpre;  |RFBORRA aAlfa;
     aAlfa = eaPathLanza + eaFicheroError;  |RFBORRA aAlfa;

     aAbre = eaPathEmision + eaFicheroPlano;
     |XABRE "BW", aAbre, nHandle2;

     |HAZ Carga131_2013;

     |XCIERRA nHandle2;

     |SI SiHay ! 0; |Y nTecla ! 4;

         aAlfa    = #0#2 % -102;
         se_empre = #2#0;
         se_ejerc = aAlfa;
         se_perio = #0#4;
         se_tipos = 131;
         se_activ = 10;
         se_impor = #10#47;
         se_fecha = #0#6;
         se_factu = "N";
         |HAZ seguimie;
         |HAZ AlAgicli;
         |HAZ VerComunidad;

         enEmpresa    = #2#0;
         eaNomEmpresa = #2#1;

         |SI enTecla = 3;
             eaFOrigen  = eaPathEmision  + eaFicheroPlano;
             eaFDestino = eaPathInternet + eaFicheroPlano;
             |HAZ CopiaFicheroIP;

             |ACABA;
        |FINSI;

        |HAZ PresentaMPF;
  |FINSI;
|FPRC;

|DEFBUCLE eosm0020L_2013;
     #10#1;
     4;
     DEmpre, nAnyo2D, #0#4, "N";
     HEmpre, nAnyo2D, #0#4, "N";
     be;
     NULL, Chequeo98L_2013;
|FIN;

|PROCESO AlModelo_2013L;
     DEmpre  = #2#0;
     HEmpre  = #2#0;
     |BUCLE eosm0020L_2013;
|FPRC;

|DEFBUCLE eosclien_2013;
      #2#3;
      0;
      Vacio40, #0#0;
      LLeno40, #0#1;
      ;
      NULL, AlModelo_2013L;
|FIN;

|PROCESO Bloque2013;
     |HAZ LeeUnidad;
     eaModelos  = "131";
     eaPeriodo  = ("00" + enPeriodo) % -102;

    |SI #0#4 = 1; perialf = "1T"; |FINSI;
    |SI #0#4 = 2; perialf = "2T"; |FINSI;
    |SI #0#4 = 3; perialf = "3T"; |FINSI;
    |SI #0#4 = 4; perialf = "4T"; |FINSI;

     eaPathLanza = eaUnidad + "\MODELOS";            |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\" + eaModelos;    |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\" + eaEjer;       |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\" + perialf;      |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\";

     |DBASE eaPathEmision;
     eaPathEmision = eaPathEmision + "emisiones";       |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + eaModelos;   |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + eaEjer;      |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + perialf;     |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/";

     eaPathInternet = eaUnidad + "/AEAT";                |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/INTERNET";      |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + eaModelos;  |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + eaEjer;     |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + perialf;    |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/";

     |SI #0#32 ! "B";
         |HAZ BotonesMPF;
     |SINO;
         enTecla = 4;
     |FINSI;
     nTecla = enTecla;
     |SI nTecla = 0;  |ACABA;  |FINSI;

     |SI nTecla = 4;
         |IMPRE 0;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |INFOR "m131co05";

         |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;
     |FINSI;

     |ABRE #3;
     |ABRE #5;
     |SI #0#33 = "N";
         |BUCLE eosclien_2013;
     |SINO;
         |ABRE #2;
         |SI #0#7 = "S";
             DEmpre = #0#0;
             HEmpre = #0#1;
             |BUCLE eosm0020L_2013;
         |SINO;
             |PARA x = 8; |SI x [ 31; |HACIENDO x = x + 1;
                   |SI #0x ! 0;
                       DEmpre = #0x;
                       HEmpre = #0x;
                       |BUCLE eosm0020L_2013;
                   |FINSI;
             |SIGUE;
        |FINSI;
        |CIERRA #2;
     |FINSI;

     |CIERRA #3;
     |CIERRA #5;

     |SI nTecla ! 4;
         |HAZ SacaErrorPtl;

         |SI eaOpcion = "3"; |Y nSwHay ! 0;
             |SI enPresentar = 0;
                 aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
                 |MENAV aAlfa;
             |FINSI;
         |FINSI;
     |SINO;
         |FININF;
         |FINIMP;
     |FINSI;
|FPRC;

|| **************************************
|| PROCESOS DISTRIBUIDOR DE LAS EMISIONES
|| **************************************
|PROCESO mes;
  |SI mes = "01"; mes = "ENERO     "; |FINSI;
  |SI mes = "02"; mes = "FEBRERO   "; |FINSI;
  |SI mes = "03"; mes = "MARZO     "; |FINSI;
  |SI mes = "04"; mes = "ABRIL     "; |FINSI;
  |SI mes = "05"; mes = "MAYO      "; |FINSI;
  |SI mes = "06"; mes = "JUNIO     "; |FINSI;
  |SI mes = "07"; mes = "JULIO     "; |FINSI;
  |SI mes = "08"; mes = "AGOSTO    "; |FINSI;
  |SI mes = "09"; mes = "SEPTIEMBRE"; |FINSI;
  |SI mes = "10"; mes = "OCTUBRE   "; |FINSI;
  |SI mes = "11"; mes = "NOVIEMBRE "; |FINSI;
  |SI mes = "12"; mes = "DICIEMBRE "; |FINSI;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;

     |SI #0#32 = "O";  #0#32 = "F"; |FINSI;

|| \\\\\ Especial Modelo 131 . Reduc. creacion empleo 2015 ////////
     |SI #0#2 = 2015;
         enModelo = 131;
         aAlfa = "eosy0092;MASIVO";
         |SUB_EJECUTA aAlfa;
         |SI enError15 = 1;
             |CONFI "0000NDesea Continuar";
             |SI FSalida ! 0;
                 |ACABA;
             |FINSI;
         |FINSI;
     |FINSI;

     aAlfa     = #0#2 % -102;
     nAnyo2D   = aAlfa;
     enAnyo    = #0#2;
     eaEjer    = #0#2;
     enPer     = #0#4;
     enPeriodo = #0#4;

     eaTipoSec = "131";
     dia      = #0#6 % 102;
     mes      = #0#6 % 402;
     |HAZ mes;
     anyo     = #0#6 % 704;
     aTipoSec = "131";

     |DBASE aMas;
     aDef = aMas + "def/eosm0020";
     |CARGA_DEF aDef, eosm20e@;
     |SI FSalida ! 0;
         |ACABA;
      |FINSI;

     |SI #0#2 [ 2012;
         |HAZ Seleccion;
         |DESCARGA_DEF #110;
         |ACABA;
     |FINSI;

     |SI #0#2 [ 2014; |O #0#32 = "B";
         |HAZ Bloque2013;
         |DESCARGA_DEF #110;
         |ACABA;
     |FINSI;

     |DESCARGA_DEF #110;

     |GRABA 020#eosem131.n;
     |LIBERA #eosem131;

     |SUB_EJECUTA "dsmoy131";
|FPRC;

|PROGRAMA;
     aFichero = "eosem131" + Usuario;
     |NOME_DAT #eosem131#aFichero#;
     |ABRE #eosem131;  |CIERRA #eosem131;  |DELINDEX #eosem131;

     |ABRE #eosem131;

     eaTipoSec = "131";

     |CLS;
     |CABEZA "      Emision Modelo 131";
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;

     |CIERRA #eosem131;
     |DELINDEX #eosem131;
|FPRO;
