|FICHEROS;
     eosy0009;
     eosclien;
     eosdaban;
     eoshacie;
     eosm0014;
     eosm0030;
     eosm0034;
     eosm0028;

     eosw0043;
     eosw0074;
     eosw0075;
     eosw0076;
     eosw0077,MANTE;
     eosw0096;
     dsmow596;
     dsmow597;

     eosaplic;
     eosclipr;
     :/agicli/def/agicontr;
|FIN;

|VARIABLES;
     nPeriodo     = 0;
     nCampoD      = 0;
     Sw           = 0;
     aLLeno40     = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     aVacio40     = "                                        ";
     aAlfa        = "";
     aAlfa1       = "";
     aAlfa2       = "";
     aAlfa3       = "";
     aAlfa4       = "";
     aAlfa5       = "";
     nSwLectura   = 0;
     aCadena      = "";
     aCaracter    = "";
     aLong        = "";
     nLong        = 0;
     nPos         = 0;
     aDComple     = " ";
     aHComple     = "z";
     aFichero     = "";
     SwError      = 0;
     nCanal       = 0;
     nTotalP      = 0;
     nContador    = 0;
     nSwError     = 0;
     aTipoP       = "";
     nNume        = 0;
     nDRegis      = 0;
     nHRegis      = 0;
     nSwDeDonde   = 0;
     nSwSecuen    = 0;
     nTecla       = 0;
     nBoton       = 0;
     nBoton1      = 0;
     nBoton2      = 0;
     nBoton3      = 0;
     nBoton4      = 0;
     nBoton5      = 0;
     nBoton6      = 0;
     nHandle1     = 0;
     nHandle2     = 0;
     nHandle3     = 0;
     nHCampo      = 0;

     aAbre        = "";
     aTercera     = "";
     aModelos     = "";
     aDig1        = "";
     aDig2        = "";
     aDig3        = "";
     aDig4        = "";
     aDig5        = "";
     aDig6        = "";
     aDig7        = "";
     aDig8        = "";
     aDig9        = "";
     aDig0        = "";
     aPathFich    = "";
     aPathPan     = "";
     aF2          = "";
     aF3          = "";
     aF4          = "";
     aF5          = "";
     aF6          = "";
     aF7          = "";
     aTecla       = "";
     aPathAfegir  = "";
     aOrigen      = "";
     aDestino     = "";
     aIPRemoto    = "";
     aPathInter   = "";
     aBue         = "";
     aJusti       = "";
     aSesion      = "";

 {-1} aMenu     = "";
      aMenu1    = "1120";
      aMenu2    = "1";
      aMenu3    = "5";
      aMenu4    = "Soporte Magnetico Colectivo              ";
      aMenu5    = "Soporte Magnetico Individual             ";
      aMenu6    = "Laser (No mas de 25 Perceptores)         ";
      aMenu7    = "Papel Continuo (No mas de 25 Perceptores)";
      aMenu8    = "                                         ";

 {-1} aMenuPap  = "";
      aMenuPap1 = "1450";
      aMenuPap2 = "1";
      aMenuPap3 = "2";
      aMenuPap4 = "Portada ";
      aMenuPap5 = "Hojas   ";

 {-1} aMenuCol   = "";
      aMenuCol1  = "1550";
      aMenuCol2  = "1";
      aMenuCol3  = "7";
      aMenuCol4  = "Datos del Presentador                     ";
      aMenuCol5  = "Creacion del Diskette                     ";
      aMenuCol6  = "Verificacion e Impresion Portada en Laser ";
      aMenuCol7  = "Etiqueta del Diskette                     ";
      aMenuCol8  = "Grabacion del Diskette                    ";
      aMenuCol9  = "Emision Hojas Interiores en Borrador      ";
      aMenuCol10 = "Impresion Portada Papel Continuo          ";

 {-1} aMenuInd  = "";
      aMenuInd1 = "1650";
      aMenuInd2 = "1";
      aMenuInd3 = "6";
      aMenuInd4 = "Creacion del Diskette ";
      aMenuInd5 = "Verificacion e Impresion Portada en Laser ";
      aMenuInd6 = "Etiqueta del Diskette ";
      aMenuInd7 = "Grabacion del Diskette";
      aMenuInd8 = "Emision Hojas Interiores en Borrador      ";
      aMenuInd9 = "Impresion Portada Papel Continuo          ";

     &enEjercic   = 0;
     &dia         = "";
     &mes         = "";
     &anyo        = "";
     &enTHojas    = 0;
     &eaMod       = "";
     &eaFOrigen   = "";
     &eaFDestino  = "";
     &eaFichDatos   = "";
     &eaFichAuxil   = "";
     &eaFichError   = "";
     &enBuenos      = 0;
     &enMalos       = 0;
     &enValidacion  = 0;
     &eaInternet    = "";

     &eaTipoE            = "";
     &eaTipoR            = "";
     &eaTipoP            = "";
     &eaTipoC            = "";
     &eaTipoA            = "";
     &eaTipoV            = "";
     &eaModoImpre        = "";
     &eaModelos          = "";
     &eaEjer             = "";
     &eaPeriodo          = "";
     &eaPathEmision      = "";
     &eaPathLanza        = "";
     &eaPathExplorador   = "";
     &eaPathInternet     = "";
     &eaFicheroPlano     = "";
     &eaOpcion           = "";
     &eaFicheroImpre     = "";
     &eaFicheroSalid     = "";
     &eaFicheroError     = "";
     &enEmpresa          = 0;
     &eaNomEmpresa       = "";
     &enPresentar        = 0;
     &enSinActividad     = 0;
     &enNume             = 0;
     &eaSigno            = "";
     &eaAlfa             = "";
|FIN;

|INCLUYE i_seguim;
|INCLUYE i_consul;
|INCLUYE i_laserc;

||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| CALCULOS DE LAS PANTALLAS
||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO QuitaComasy0009;
     eaAlfa = aAlfa;
     |HAZ QuitaRaritos;
     aAlfa  = eaAlfa;
|FPRC;

|PROCESO Parrilla;
     |SI #eosy0009#0 = 0;
         #eosy0009#0 = 0;  |PINTA #eosy0009#0;
         #eosy0009#1 = 0;  |PINTA #eosy0009#1;  |C_M #eosy0009#1, 1, "N";
         |PARA nCampoD = 2;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
               |C_M #eosy0009#nCampoD#, 1, "S";
         |SIGUE;
         |C_M #eosy0009#38, 1, "S";
     |SINO;
         |C_M #eosy0009#0,  1, "S";
         |C_M #eosy0009#1,  1, "S";
         |PARA nCampoD = 2;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
               |C_M #eosy0009#nCampoD#, 1, "N";
               #eosy0009#nCampoD# = 0;  |PINTA #eosy0009#nCampoD#;
         |SIGUE;
         |C_M #eosy0009#38, 1, "N";  #eosy0009#38 = 0;  |PINTA #eosy0009#38;
     |FINSI;
|FPRC;

|PROCESO Planilla;
     |SI #eosy0009#38 = 0;  |Y #eosy0009#0 = 0;
         |C_M #eosy0009#38, 1, "N";  #eosy0009#38 = 0;  |PINTA #eosy0009#38;
         |PARA nCampoD = 2;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
               |C_M #eosy0009#nCampoD#, 1, "S";
         |SIGUE;
     |SINO;
         |SI #eosy0009#0 = 0;
             |C_M #eosy0009#38, 1, "S";
             |PARA nCampoD = 2;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
                   |C_M #eosy0009#nCampoD#, 1, "N";
                   #eosy0009#nCampoD# = 0;  |PINTA #eosy0009#nCampoD#;
             |SIGUE;
        |FINSI;
     |FINSI;
|FPRC;

|PROCESO NoMasEmpresas;
     |SI #eosy0009#Campo# = 0;
         |PARA nCampoD = Campo + 1;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
               #eosy0009#Campo# = 0;  |C_M #eosy0009#nCampoD#, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampoD = Campo + 1;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
               |C_M #eosy0009#nCampoD#, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO CogeVarMoneda;  |TIPO 0;
     |HAZ PintaMoneda;
     #eosy0009#41 = eaMoneda;

     |SI #eosy0009#39 [ 2000;
         |SI #eosy0009#41 ! "PESETAS";
             |MENAV "0000 La Moneda debe ser PESETAS";
             |ERROR;
         |FINSI;
     |FINSI;

     |PINTA #eosy0009#41;
|FPRC;

||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| CALCULOS DE LA EMISION
||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴


|PROCESO GrabaDisketteC;
     |SI nSwDeDonde = 1;
         #eosw0077#48 = 0;
         |LEE 040#eosw0077.=;
         |SI FSalida ! 0;  |DDEFECTO #eosw0077;  |FINSI;
         |SI #eosw0077#34 = 0;
             |MENAV "     Por favor haga la creacion de Diskette.";
             |ACABA;
         |FINSI;
     |SINO;
         #eosw0077#48 = 1;
         |LEE 040#eosw0077.=;
         |SI FSalida ! 0;  |DDEFECTO #eosw0077;  |FINSI;
         |SI #eosw0077#31 = 0;
             |MENAV "     Por favor haga la creacion de Diskette.";
             |ACABA;
         |FINSI;
     |FINSI;

     Raiz       = "";  |DIRECTORIO Raiz;
     Directorio = "";  |DBASE Directorio;
     Directorio = Directorio + "hacienda/" + aTipoSec;  |MKDIR Directorio;
     Directorio = Directorio + "/";
     Valfa = Raiz + "bin/agichmod 777 " + Directorio;
     |SYSTEM Valfa;

     ||SI #eosy0009#39 < 2000;
         Fichero    = "RT" + #eosy0009#39;
     ||SINO;
         ||Fichero    = "RC" + #eosy0009#39;
     ||FINSI;
     NFichero   = Directorio + Fichero;          |QBF NFichero;

     aFichero  = "rt  "+ NFichero;
     |FABRE aFichero;
     |SI FSalida < 0;
         Valfa = "      [" + NFichero + "] inaccesible.";
         |MENAV  Valfa;
         |ACABA;
     |FINSI;
     |FCIERRA FSalida;

     Pos = -1;
     |PUSHV 0501 2380;
     |PINPA #1#eosw0043;

     E_sup  = 1;
     E_inf  = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";

     Unidad = "A";
     Unidad = 0851 ? 0;
     |ATRI I;
     |PINTA 1616, "Introduzca un diskette formateado en D.O.S. ...";
     |ATRI i;
     |PINTA 2380, ".";
     |PAUSA;

     |ATRI P;
     |PINTA 1616, "                  Copiando ...                 ";
     |ATRI p;
     |PINTA 2380, ".";

     |SI enSwDirecta = 1;
         |POPV;
         eaTipoSec    = aTipoSec;
         eaTipoEmi    = "COPIA";
         eaUnidad     = Unidad;
         eaFichCol    = "RT" + #eosy0009#39;
         |SUB_EJECUTA "eosz9999";
         |ACABA;
     |FINSI;

     |QUE_SISTEMA Sistema;
     |SI Sistema ! "ESDOS";
         Valfa = Raiz + "bin/agcopiaa " + NFichero + " " + Unidad + ":";
         |SYSTEM Valfa;

         |ATRI P;
         |PINTA 1616, "           FICHERO COPIADO !!!!                 ";
         |ATRI p;
         |PINTA 2380, ".";
         |PAUSA;
     |SINO;
         Valfa1 = NFichero;
         Valfa2 = Unidad + ":" + Fichero;

         |COPIA_FICHERO Valfa1, Valfa2;
         |SI FSalida ! 0;
             Valfa3 = "Error [" + FSalida + "] en copia de ficheros ...";
             |PINTA 1616, Valfa3;
             |PINTA 2380, ".";
             |PAUSA;
         |SINO;
             |ATRI P;
             |PINTA 1616, "           FICHERO COPIADO !!!!                 ";
             |ATRI p;
             |PINTA 2380, ".";
             |PAUSA;
         |FINSI;
     |FINSI;
     |POPV;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| Emision de Portadas
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO ImprimePortada;
     |SI nSwDeDonde = 3;
         |SI #eosw0077#31 > 25;  |ACABA;  |FINSI;

         |ABRE #eosm0028;
         #eosm0028#0 = #eosw0077#49;
         |LEE 040#eosm0028.=;
         |SI FSalida ! 0;  |DDEFECTO #eosm0028;  |FINSI;
         |CIERRA #eosm0028;

         |SI #eosm0028#2 = "M";  |ACABA;  |FINSI;
     |FINSI;

     |SI #eosw0077#48 = 0;
         aDig1 = #eosw0077#36;  #eosw0077#36 = "";
         aDig2 = #eosw0077#37;  #eosw0077#37 = "";
         aDig3 = #eosw0077#38;  #eosw0077#38 = "";
         aDig4 = #eosw0077#39;  #eosw0077#39 = "";
         aDig5 = #eosw0077#40;  #eosw0077#40 = "";
         aDig6 = #eosw0077#41;  #eosw0077#41 = "";
         aDig7 = #eosw0077#42;  #eosw0077#42 = "";
         aDig8 = #eosw0077#43;  #eosw0077#43 = "";
         aDig9 = #eosw0077#44;  #eosw0077#44 = "";
         aDig0 = #eosw0077#45;  #eosw0077#45 = "";
         eaMod = "";
     |SINO;
         #eosw0077#36 = aDig1;
         #eosw0077#37 = aDig2;
         #eosw0077#38 = aDig3;
         #eosw0077#39 = aDig4;
         #eosw0077#40 = aDig5;
         #eosw0077#41 = aDig6;
         #eosw0077#42 = aDig7;
         #eosw0077#43 = aDig8;
         #eosw0077#44 = aDig9;
         #eosw0077#45 = aDig0;
         eaMod  = "";
         |SI aDig1 ! " ";  |Y nSwDeDonde [ 1;
             eaMod = "190";
         |FINSI;
     |FINSI;

     |PRINT;
     |PIEINF;
|FPRC;

|DEFBUCLE eosw0077P;
     #eosw0077#1;
     ;
     nDRegis;
     nHRegis;
     be;
     NULL, ImprimePortada;
|FIN;

|PROCESO Portadas;
     |SI #eosy0009#39 ] 2003;  |ACABA;  |FINSI;

     |SI nSwDeDonde = 1;
         #eosw0077#48 = 0;
         |LEE 040#eosw0077.=;
         |SI FSalida ! 0;  |DDEFECTO #eosw0077;  |FINSI;
         |SI #eosw0077#34 = 0;
             |MENAV "     Por favor haga la creacion de Diskette.";
             |ACABA;
         |FINSI;
     |FINSI;

     |SI nSwDeDonde = 2;
         #eosw0077#48 = 1;
         |LEE 040#eosw0077.=;
         |SI FSalida ! 0;  |DDEFECTO #eosw0077;  |FINSI;
         |SI #eosw0077#31 = 0;
             |MENAV "     Por favor haga la creacion de Diskette.";
             |ACABA;
         |FINSI;
     |FINSI;

     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #eosy0009#39 [ 1999;
         |INFOR "eosy1009";
     |SINO;
         |INFOR "eosy4009";
     |FINSI;

     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     |SI nSwDeDonde = 1;
         nDRegis = 0;
         nHRegis = 999;
     |SINO;
         nDRegis = 1;
         nHRegis = 999;
     |FINSI;

     |CIERRAT #eosw0077;
     |BUCLE eosw0077P;
     |ABRET #eosw0077;

     |FININF;
     |FINIMP;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| Emision de Etiquetas
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO Etiquetas;
     |SI nSwDeDonde = 1;
         #eosw0077#48 = 0;
         |LEE 040#eosw0077.=;
         |SI FSalida ! 0;  |DDEFECTO #eosw0077;  |FINSI;
         |SI #eosw0077#34 = 0;
             |MENAV "     Por favor haga la creacion de Diskette.";
             |ACABA;
         |FINSI;
     |SINO;
         #eosw0077#48 = 1;
         |LEE 040#eosw0077.=;
         |SI FSalida ! 0;  |DDEFECTO #eosw0077;  |FINSI;
         |SI #eosw0077#31 = 0;
             |MENAV "     Por favor haga la creacion de Diskette.";
             |ACABA;
         |FINSI;
     |FINSI;

     |PUSHV 0501 2380;

     #eosw0043#16 = "Delegacion .........: " + #eosw0077#0;
     #eosw0043#17 = "Ejercicio ..........: " + #eosy0009#39;
     #eosw0043#18 = "Modelo .............: 190";
     aAlfa   = "Numero Justificante : 190" + #eosw0077#36 + #eosw0077#37 + #eosw0077#38 + #eosw0077#39;
     aAlfa   = aAlfa + #eosw0077#40 + #eosw0077#41 + #eosw0077#42 + #eosw0077#43 + #eosw0077#44 + #eosw0077#45;
     #eosw0043#19 = aAlfa;
     #eosw0043#20 = "N.I.F. .............: " + #eosw0077#9;
     #eosw0043#21 = "Nombre : " + #eosw0077#11;
     #eosw0043#22 = #eosw0077#12 + " " + #eosw0077#13 + " " + #eosw0077#15 + " " + (("00" + #eosw0077#17) % -102) + (("000" + #eosw0077#18) % -103);
     #eosw0043#23 = "P.Cont.: " + #eosw0077#46;
     #eosw0043#24 = "Telefono ...........: " + #eosw0077#10;
     |SI nSwDeDonde = 1;
         nNume   = #eosw0077#34 + #eosw0077#35 + 1;
     |SINO;
         nNume   = #eosw0077#34 + #eosw0077#35;
     |FINSI;
     #eosw0043#25 = "Numero total Registros ..: " + nNume;
     #eosw0043#26 = "Densidad soporte : 1,44 MB en Diskettes de 3 1/2";
     #eosw0043#27 = "";
     #eosw0043#28 = "";
     |C_M #eosw0043#27, 1, "N";
     |C_M #eosw0043#28, 1, "N";
     |SI nSwDeDonde = 1;
         #eosw0043#27 = "Numero total Declarantes : " + #eosw0077#34;
         #eosw0043#28 = "Numero total Declarados .: " + #eosw0077#35;
         |C_M #eosw0043#27, 1, "S";
         |C_M #eosw0043#28, 1, "S";
     |FINSI;

     Pos = -1;
     |PINPA #2#eosw0043;
     |PINDA #2#eosw0043;
     |ENDATOS #1#eosw0043;
     |SI FSalida = 0;
         |PINPA #2#eosw0043;
         |PINDA #2#eosw0043;
         |CONFI "2400SRealizar Impresion de la Etiqueta : ";
         |SI FSalida ! 0; |POPV; |ACABA; |FINSI;

         |IMPRE 0;
         |SI FSalida ! 0;  |POPV;  |ACABA;  |FINSI;

         |INFOR "eoszp015";
         |SI FSalida ! 0;  |POPV;  |FINIMP;  |ACABA;  |FINSI;

         |PRINT; |PIEINF; |FININF; |FINIMP;
     |FINSI;
     |POPV;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| Grabacion del Registro 0
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO Tipo0;
     |DDEFECTO #eosw0074;
     #eosw0074#1  = "0";
     #eosw0074#2  = "190";
     #eosw0074#3  = #eosw0077#4;
     #eosw0074#4  = #eosw0077#9;

     aAlfa  = #eosw0077#11;  |HAZ QuitaComasy0009;
     #eosw0074#5  = aAlfa;

     #eosw0074#6  = #eosw0077#12;

     aAlfa  = #eosw0077#13;  |HAZ QuitaComasy0009;
     #eosw0074#7  = aAlfa;

     nNume  = #eosw0077#14;
     #eosw0074#8  = ("00000" + nNume) % -105;
     #eosw0074#9  = "  ";
     #eosw0074#10 = "  ";
     #eosw0074#11 = "  ";
     #eosw0074#12 = (("00" + #eosw0077#17) % -102) + (("000" + #eosw0077#18) % -103);

     aAlfa  = #eosw0077#15;  |HAZ QuitaComasy0009;
     #eosw0074#13 = aAlfa;

     #eosw0074#14 = ("00" + #eosw0077#17) % -102;
     enNume = #eosw0077#34;  |HAZ Conver5;    #eosw0074#15 = eaAlfa;
     enNume = #eosw0077#35;  |HAZ Conver9;    #eosw0074#16 = eaAlfa;
     #eosw0074#17 = "D";
     #eosw0074#18 = #eosw0077#10;

     aAlfa  = #eosw0077#46;  |HAZ QuitaComasy0009;
     #eosw0074#19 = aAlfa;

     #eosw0074#22 = &13 + &10;

     |PARA nCampo = 1;  |SI nCampo [ 22;  |HACIENDO nCampo = nCampo + 1;
           Cadena = Handle + " " + #eosw0074#nCampo#;
           |FGRABA Cadena;
     |SIGUE;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| Grabacion del Registro 1
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO Tipo1;
     |DDEFECTO #eosw0075;
     #eosw0075#1  = "1";
     #eosw0075#2  = "190";
     #eosw0075#3  = #eosw0077#4;
     #eosw0075#4  = #eosw0077#9;

     aAlfa  = #eosw0077#11;  |HAZ QuitaComasy0009;
     #eosw0075#5  = aAlfa;

     #eosw0075#6  = aTipoP;

     aAlfa  = #eosm0030#16;  |QBT aAlfa;
     aAlfa  = ("000000000" + aAlfa) % -109;
     #eosw0075#7  = aAlfa;

     aAlfa  = #eosm0030#15;  |HAZ QuitaComasy0009;
     #eosw0075#8  = aAlfa;

     |SI #eosy0009#39 ] 2000;
        |SI #eosy0009#39 ] 2001;
           #eosw0075#9  = "1700000000000";
        |SINO;
           #eosw0075#9  = "1900000000000";
        |FINSI;
     |SINO;
         #eosw0075#9  = "0000000000000";
     |FINSI;

     |SI #eosy0009#39 ] 2007;
         #eosw0075#9  = "1900000000000";
     |FINSI;

     #eosw0075#10 = #eosw0077#19;
     #eosw0075#11 = #eosw0077#20;

     aAlfa  = "0000000000000";
     |SI #eosw0077#20 = "S";  |O  #eosw0077#19 = "C";
        |SI #eosy0009#39 ] 2001;
           aAlfa  = "170";
        |SINO;
           aAlfa  = "190";
        |FINSI;

        |SI #eosy0009#39 ] 2007;
           aAlfa  = "190";
        |FINSI;

        aAlfa  = aAlfa + #eosw0077#21 + #eosw0077#22 + #eosw0077#23 + #eosw0077#24 + #eosw0077#25 + #eosw0077#26;
        aAlfa  = aAlfa  + #eosw0077#27 + #eosw0077#28 + #eosw0077#29 + #eosw0077#30;
        |QBT aAlfa;
        aAlfa  = (aAlfa + "0000000000") % 113;
     |FINSI;
     #eosw0075#12 = aAlfa;

     enNume = #eosw0077#31;  |HAZ Conver9;        #eosw0075#13 = eaAlfa;
     enNume = #eosw0077#32;  |HAZ Conver15Signo;  #eosw0075#14 = eaSigno; #eosw0075#15 = eaAlfa;
     enNume = #eosw0077#33;  |HAZ Conver15;       #eosw0075#16 = eaAlfa;
     #eosw0075#19 = &13 + &10;

     |PARA nCampo = 1;  |SI nCampo [ 19;  |HACIENDO nCampo = nCampo + 1;
           |SI #eosy0009#39 [ 2003;
               Cadena = Handle + " " + #eosw0075#nCampo#;
               |FGRABA Cadena;
           |SINO;
               aAlfa = #eosw0075#nCampo#;
               |XGRABA nHandle2, aAlfa;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO CogeJusti2015;
     |SI #eosm0030#19 = "N";
         aJusti = "1900000000000";
         |ACABA;
     |FINSI;

     aCadena = "";
     aAlfa   = #dsmow596#3;
     aLong   = aAlfa % 0;
     nLong   = aLong;
     |PARA nCampo = 1;  |SI nCampo [ aLong;  |HACIENDO nCampo = nCampo + 1;
           nPos      = (100 * nCampo) + 1;
           aCaracter = aAlfa % nPos;

           |SI aCaracter = "0";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "1";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "2";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "3";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "4";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "5";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "6";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "7";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "8";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "9";  aCadena = aCadena + aCaracter;  |FINSI;
     |SIGUE;

     aAlfa1  = #eosw0077#4;
     aAlfa2  = "0";
     |SI #eosw0077#19 ! " ";  aAlfa2  = "1";  |FINSI;

     aCadena = ((aCadena + "0000000") % 107) + (aAlfa1 % -102) + (("00" + aAlfa2) % -101);

     aJusti  = "190" + aCadena;
|FPRC;

|PROCESO Tipo1_2009;
     |DDEFECTO #dsmow596;
     #dsmow596#0  = "1";
     #dsmow596#1  = "190";
     #dsmow596#2  = #eosw0077#4;
     #dsmow596#3  = #eosw0077#9;

     aAlfa  = #eosw0077#11;  |HAZ QuitaComasy0009;
     #dsmow596#4  = aAlfa;

     #dsmow596#5  = aTipoP;

     aAlfa   = #eosm0030#16;  |QBT aAlfa;
     aAlfa   = ("000000000" + aAlfa) % -109;
     #dsmow596#6  = aAlfa;

     aAlfa   = #eosm0030#15;  |HAZ QuitaComasy0009;
     #dsmow596#7  = aAlfa;

     |HAZ CogeJusti2015;
     #dsmow596#8  = aJusti;

     #dsmow596#9  = #eosw0077#19;
     #dsmow596#10 = #eosw0077#20;

     aAlfa  = "0000000000000";
     |SI #eosw0077#20 = "S";  |O  #eosw0077#19 = "C";
         aAlfa  = "190";
         aAlfa  = aAlfa  + #eosw0077#21 + #eosw0077#22 + #eosw0077#23 + #eosw0077#24 + #eosw0077#25 + #eosw0077#26;
         aAlfa  = aAlfa  + #eosw0077#27 + #eosw0077#28 + #eosw0077#29 + #eosw0077#30;
         |QBT aAlfa;
         aAlfa  = (aAlfa + "0000000000") % 113;
     |FINSI;
     #dsmow596#11 = aAlfa;

     enNume = #eosw0077#31;  |HAZ Conver9;        #dsmow596#12 = eaAlfa;
     enNume = #eosw0077#32;  |HAZ Conver15Signo;  #dsmow596#13 = eaSigno; #dsmow596#14 = eaAlfa;
     enNume = #eosw0077#33;  |HAZ Conver15;       #dsmow596#15 = eaAlfa;
     #dsmow596#18 = &13 + &10;

     nHCampo = 18;
     |SI #eosy0009#39 ] 2012;  |Y eaOpcion ! "3";
         nHCampo = 17;
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ nHCampo;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #dsmow596#nCampo#;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| Grabacion del Registro 2
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO Tipo2_2002;
     #eosw0076#1  = "2";
     #eosw0076#2  = "190";
     #eosw0076#3  = #eosm0030#1;
     #eosw0076#4  = #eosw0077#9;
     |SI #eosm0034#16 = "S";
         #eosw0076#6  = #eosm0034#2;
         #eosw0076#5  = "";
     |SINO;
         #eosw0076#6  = "";
         #eosw0076#5  = #eosm0034#2;
     |FINSI;

     aAlfa  = #eosm0034#17;  |HAZ QuitaComasy0009;
     #eosw0076#7  = aAlfa;

     #eosw0076#8  = ("00" + #eosm0034#21) % -102;
     #eosw0076#9  = #eosm0034#4;
     #eosw0076#10 = "00";
     |SI #eosm0034#5 ! "  ";  #eosw0076#10 = #eosm0034#5;  |FINSI;
     enNume = #eosm0034#7;  |HAZ Conver13Signo;  #eosw0076#11 = eaSigno; #eosw0076#12 = eaAlfa;
     enNume = #eosm0034#8;  |HAZ Conver13Signo;  #eosw0076#13 = eaAlfa;
     enNume = #eosm0034#9;  |HAZ Conver13Signo;  #eosw0076#14 = eaSigno; #eosw0076#15 = eaAlfa;
     enNume = #eosm0034#10; |HAZ Conver13Signo;  #eosw0076#16 = eaAlfa;
     enNume = #eosm0034#11; |HAZ Conver13Signo;  #eosw0076#17 = eaAlfa;
     #eosw0076#18 = ("0000" + #eosm0034#3) % -104;
     #eosw0076#19 = #eosm0034#23;
     #eosw0076#20 = #eosm0034#6;
     #eosw0076#21 = ("0000" + #eosm0034#18) % -104;
     #eosw0076#22 = #eosm0034#19;
     #eosw0076#23 = #eosm0034#20;
     #eosw0076#24 = #eosm0034#22;
     #eosw0076#25 = ("00" + #eosm0034#24) % -102;
     #eosw0076#26 = ("00" + #eosm0034#25) % -102;
     #eosw0076#27 = ("00" + #eosm0034#26) % -102;
     #eosw0076#28 = ("00" + #eosm0034#27) % -102;
     #eosw0076#29 = ("00" + #eosm0034#28) % -102;
     #eosw0076#30 = ("00" + #eosm0034#29) % -102;
     enNume = #eosm0034#12; |HAZ Conver13Signo;  #eosw0076#31 = eaAlfa;
     enNume = #eosm0034#13; |HAZ Conver13Signo;  #eosw0076#32 = eaAlfa;
     enNume = #eosm0034#14; |HAZ Conver13Signo;  #eosw0076#33 = eaAlfa;
     enNume = #eosm0034#15; |HAZ Conver13Signo;  #eosw0076#34 = eaAlfa;

     |SI #eosw0076#9 ! "A";
         #eosw0076#20 = "0";
     |FINSI;

     |SI #eosw0076#9 ! "A";  |Y #eosw0076#9 ! "B";  |Y #eosw0076#9 ! "C"; |Y #eosw0076#9 ! "D";
         #eosw0076#21 = "0000";
         #eosw0076#22 = "0";
         #eosw0076#23 = "0";
         #eosw0076#24 = "         ";
         #eosw0076#25 = "00";
         #eosw0076#26 = "00";
         #eosw0076#27 = "00";
         #eosw0076#28 = "00";
         #eosw0076#29 = "00";
         #eosw0076#30 = "00";
         |SI #eosm0030#1 ] 2000;
             #eosw0076#35 = "000000";
         |SINO;
             #eosw0076#35 = "";
         |FINSI;
     |SINO;
         |SI #eosm0030#1 ] 2000;
             aAlfa1 = ("00" + #eosm0034#31) % -102;
             |SI #eosm0034#35 > 6;  #eosm0034#35 = 6;  |FINSI;
             aAlfa2 = ("00" + #eosm0034#35) % -101;
             aAlfa3 = ("00" + #eosm0034#32) % -101;
             aAlfa4 = ("00" + #eosm0034#33) % -101;
             aAlfa5 = ("00" + #eosm0034#34) % -101;
             #eosw0076#35 = aAlfa1 + aAlfa2 + aAlfa3 + aAlfa4 + aAlfa5;
         |SINO;
             #eosw0076#35 = "";
         |FINSI;
     |FINSI;

     #eosw0076#36 = &13 + &10;

     |PARA nCampo = 1;  |SI nCampo [ 36;  |HACIENDO nCampo = nCampo + 1;
           Cadena = Handle + " " + #eosw0076#nCampo#;
           |FGRABA Cadena;
     |SIGUE;
|FPRC;

|PROCESO Tipo2_2003;
     #eosw0096#0  = "2";
     #eosw0096#1  = "190";
     #eosw0096#2  = #eosm0030#1;
     #eosw0096#3  = #eosw0077#9;
     |SI #eosm0034#16 = "S";
         #eosw0096#5  = #eosm0034#2;
         #eosw0096#4  = "";
     |SINO;
         #eosw0096#5  = "";
         #eosw0096#4  = #eosm0034#2;
     |FINSI;

     aAlfa  = #eosm0034#17;  |HAZ QuitaComasy0009;
     #eosw0096#6  = aAlfa;

     #eosw0096#7  = ("00" + #eosm0034#21) % -102;
     #eosw0096#8  = #eosm0034#4;

     |SI #eosm0034#4 = "K";
         |SI #eosy0009#39 ] 2007;  |Y #eosm0034#5 = "  ";
             #eosm0034#5 = "01";
         |FINSI;
     |FINSI;

     |SI #eosm0034#4 = "N";
         #eosm0034#4 = "K";
         #eosm0034#5 = "02";
     |FINSI;

     |SI #eosm0034#4 = "I";
         |SI #eosy0009#39 ] 2004; |Y #eosm0034#5 = "  ";
             #eosm0034#5 = "02";
         |FINSI;
     |FINSI;

     #eosw0096#9  = "00";
     |SI #eosm0034#5 ! "  ";  #eosw0096#9 = #eosm0034#5;  |FINSI;

     enNume = #eosm0034#7;  |HAZ Conver13Signo;  #eosw0096#10 = eaSigno; #eosw0096#11 = eaAlfa;
     enNume = #eosm0034#8;  |HAZ Conver13Signo;  #eosw0096#12 = eaAlfa;
     enNume = #eosm0034#9;  |HAZ Conver13Signo;  #eosw0096#13 = eaSigno; #eosw0096#14 = eaAlfa;
     enNume = #eosm0034#10; |HAZ Conver13Signo;  #eosw0096#15 = eaAlfa;
     enNume = #eosm0034#11; |HAZ Conver13Signo;  #eosw0096#16 = eaAlfa;
     #eosw0096#17 = ("0000" + #eosm0034#3) % -104;
     #eosw0096#18 = #eosm0034#23;
     #eosw0096#19 = ("0000" + #eosm0034#18) % -104;
     #eosw0096#20 = #eosm0034#20;
     #eosw0096#21 = #eosm0034#22;
     #eosw0096#22 = #eosm0034#19;
     #eosw0096#23 = #eosm0034#6;
     #eosw0096#24 = "0";
     #eosw0096#25 = "0";
     |SI #eosm0034#36 = "S";  #eosw0096#24 = "1";  |FINSI;
     |SI #eosm0034#37 = "S";  #eosw0096#25 = "1";  |FINSI;
     enNume = #eosm0034#12; |HAZ Conver13Signo;  #eosw0096#26 = eaAlfa;
     enNume = #eosm0034#13; |HAZ Conver13Signo;  #eosw0096#27 = eaAlfa;
     enNume = #eosm0034#14; |HAZ Conver13Signo;  #eosw0096#28 = eaAlfa;
     enNume = #eosm0034#15; |HAZ Conver13Signo;  #eosw0096#29 = eaAlfa;

     #eosw0096#30 = ("0"  + #eosm0034#38) % -101;
     #eosw0096#31 = ("0"  + #eosm0034#39) % -101;
     #eosw0096#32 = ("00" + #eosm0034#40) % -102;
     #eosw0096#33 = ("00" + #eosm0034#41) % -102;
     #eosw0096#34 = ("00" + #eosm0034#42) % -102;
     #eosw0096#35 = ("00" + #eosm0034#43) % -102;
     #eosw0096#36 = ("00" + #eosm0034#44) % -102;
     #eosw0096#37 = ("00" + #eosm0034#45) % -102;
     #eosw0096#38 = ("00" + #eosm0034#46) % -102;
     #eosw0096#39 = ("00" + #eosm0034#47) % -102;

     #eosw0096#40 = ("0"  + #eosm0034#48) % -101;
     #eosw0096#41 = ("0"  + #eosm0034#49) % -101;
     #eosw0096#42 = ("0"  + #eosm0034#50) % -101;
     #eosw0096#43 = ("0"  + #eosm0034#51) % -101;
     #eosw0096#44 = ("0"  + #eosm0034#52) % -101;
     #eosw0096#45 = ("0"  + #eosm0034#53) % -101;
     #eosw0096#46 = ("0"  + #eosm0034#54) % -101;
     #eosw0096#47 = ("0"  + #eosm0034#55) % -101;
     #eosw0096#48 = ("0"  + #eosm0034#56) % -101;
     #eosw0096#49 = ("0"  + #eosm0034#57) % -101;

     #eosw0096#50 = &13 + &10;

     |SI #eosw0096#8 ! "A";  |Y #eosw0096#8 ! "B";  |Y #eosw0096#8 ! "C"; |Y #eosw0096#8 ! "D";
         #eosw0096#19 = "0000";
         #eosw0096#20 = "0";
         #eosw0096#21 = "         ";
         #eosw0096#22 = "0";
         #eosw0096#23 = "0";
         #eosw0096#24 = "0";
         #eosw0096#25 = "0";
         #eosw0096#26 = "0000000000000";
         #eosw0096#27 = "0000000000000";
         #eosw0096#28 = "0000000000000";
         #eosw0096#29 = "0000000000000";
         #eosw0096#30 = "0";
         #eosw0096#31 = "0";
         #eosw0096#32 = "00";
         #eosw0096#33 = "00";
         #eosw0096#34 = "00";
         #eosw0096#35 = "00";
         #eosw0096#36 = "00";
         #eosw0096#37 = "00";
         #eosw0096#38 = "00";
         #eosw0096#39 = "00";
         #eosw0096#40 = "0";
         #eosw0096#41 = "0";
         #eosw0096#42 = "0";
         #eosw0096#43 = "0";
         #eosw0096#44 = "0";
         #eosw0096#45 = "0";
         #eosw0096#46 = "0";
         #eosw0096#47 = "0";
         #eosw0096#48 = "0";
         #eosw0096#49 = "0";
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ 50;  |HACIENDO nCampo = nCampo + 1;
           |SI #eosy0009#39 [ 2003;
               Cadena = Handle + " " + #eosw0096#nCampo#;
               |FGRABA Cadena;
           |SINO;
               aAlfa = #eosw0096#nCampo#;
               |XGRABA nHandle2, aAlfa;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Tipo2_2009;
     #dsmow597#0  = "2";
     #dsmow597#1  = "190";
     #dsmow597#2  = #eosm0030#1;
     #dsmow597#3  = #eosw0077#9;
     |SI #eosm0034#16 = "S";
         #dsmow597#5  = #eosm0034#2;
         #dsmow597#4  = "";
     |SINO;
         #dsmow597#5  = "";
         #dsmow597#4  = #eosm0034#2;
     |FINSI;

     aAlfa  = #eosm0034#17;  |HAZ QuitaComasy0009;
     #dsmow597#6  = aAlfa;

     #dsmow597#7  = ("00" + #eosm0034#21) % -102;
     #dsmow597#8  = #eosm0034#4;

     |SI #eosm0034#4 = "K";
         |SI #eosm0034#5 = "  ";
             #eosm0034#5 = "01";
         |FINSI;
     |FINSI;

     |SI #eosm0034#4 = "N";
         #eosm0034#4 = "K";
         #eosm0034#5 = "02";
     |FINSI;

     |SI #eosm0034#4 = "I";
         |SI #eosm0034#5 = "  ";
             #eosm0034#5 = "02";
         |FINSI;
     |FINSI;

     #dsmow597#9  = "00";
     |SI #eosm0034#5 ! "  ";  #dsmow597#9 = #eosm0034#5;  |FINSI;

     enNume = #eosm0034#7;  |HAZ Conver13Signo;  #dsmow597#10 = eaSigno; #dsmow597#11 = eaAlfa;
     enNume = #eosm0034#8;  |HAZ Conver13Signo;  #dsmow597#12 = eaAlfa;
     enNume = #eosm0034#9;  |HAZ Conver13Signo;  #dsmow597#13 = eaSigno; #dsmow597#14 = eaAlfa;
     enNume = #eosm0034#10; |HAZ Conver13Signo;  #dsmow597#15 = eaAlfa;
     enNume = #eosm0034#11; |HAZ Conver13Signo;  #dsmow597#16 = eaAlfa;
     #dsmow597#17 = ("0000" + #eosm0034#3) % -104;
     #dsmow597#18 = #eosm0034#23;
     #dsmow597#19 = ("0000" + #eosm0034#18) % -104;
     #dsmow597#20 = #eosm0034#20;
     #dsmow597#21 = #eosm0034#22;
     #dsmow597#22 = #eosm0034#19;
     #dsmow597#23 = #eosm0034#6;

     |SI #eosy0009#39 < 2015;
         #dsmow597#24 = "0";
         #dsmow597#25 = "0";

         |SI #eosm0034#36 = "S";  #dsmow597#24 = "1";  |FINSI;
         |SI #eosm0034#37 = "S";  #dsmow597#25 = "1";  |FINSI;
     |FINSI;

     |SI #eosy0009#39 = 2015;
         #dsmow597#24 = " ";
         #dsmow597#25 = "0";

         |SI #eosm0034#62 = "S";  #dsmow597#24 = "X";  |FINSI;
         |SI #eosm0034#37 = "S";  #dsmow597#25 = "1";  |FINSI;
     |FINSI;

     enNume = #eosm0034#12; |HAZ Conver13Signo;  #dsmow597#26 = eaAlfa;
     enNume = #eosm0034#13; |HAZ Conver13Signo;  #dsmow597#27 = eaAlfa;
     enNume = #eosm0034#14; |HAZ Conver13Signo;  #dsmow597#28 = eaAlfa;
     enNume = #eosm0034#15; |HAZ Conver13Signo;  #dsmow597#29 = eaAlfa;

     #dsmow597#30 = ("0"  + #eosm0034#38) % -101;
     #dsmow597#31 = ("0"  + #eosm0034#39) % -101;
     #dsmow597#32 = ("00" + #eosm0034#40) % -102;
     #dsmow597#33 = ("00" + #eosm0034#41) % -102;
     #dsmow597#34 = ("00" + #eosm0034#42) % -102;
     #dsmow597#35 = ("00" + #eosm0034#43) % -102;
     #dsmow597#36 = ("00" + #eosm0034#44) % -102;
     #dsmow597#37 = ("00" + #eosm0034#45) % -102;
     #dsmow597#38 = ("00" + #eosm0034#46) % -102;
     #dsmow597#39 = ("00" + #eosm0034#47) % -102;

     #dsmow597#40 = ("0"  + #eosm0034#48) % -101;
     #dsmow597#41 = ("0"  + #eosm0034#49) % -101;
     #dsmow597#42 = ("0"  + #eosm0034#50) % -101;
     #dsmow597#43 = ("0"  + #eosm0034#51) % -101;
     #dsmow597#44 = ("0"  + #eosm0034#52) % -101;
     #dsmow597#45 = ("0"  + #eosm0034#53) % -101;
     #dsmow597#46 = ("0"  + #eosm0034#54) % -101;
     #dsmow597#47 = ("0"  + #eosm0034#55) % -101;
     #dsmow597#48 = ("0"  + #eosm0034#56) % -101;
     #dsmow597#49 = ("0"  + #eosm0034#57) % -101;
     #dsmow597#50 = #eosm0034#58;
     #dsmow597#51 = #eosm0034#59;
     #dsmow597#52 = #eosm0034#60;
     #dsmow597#53 = #eosm0034#61;

     #dsmow597#55 = &13 + &10;

     |SI #dsmow597#8 ! "A";  |Y #dsmow597#8 ! "B";  |Y #dsmow597#8 ! "C"; |Y #dsmow597#8 ! "D";
         #dsmow597#19 = "0000";
         #dsmow597#20 = "0";
         #dsmow597#21 = "         ";
         #dsmow597#22 = "0";
         #dsmow597#23 = "0";
         #dsmow597#24 = "0";
         |SI #eosy0009#39 = 2015;  #dsmow597#24 = " ";  |FINSI;
         #dsmow597#25 = "0";
         #dsmow597#26 = "0000000000000";
         #dsmow597#27 = "0000000000000";
         #dsmow597#28 = "0000000000000";
         #dsmow597#29 = "0000000000000";
         #dsmow597#30 = "0";
         #dsmow597#31 = "0";
         #dsmow597#32 = "00";
         #dsmow597#33 = "00";
         #dsmow597#34 = "00";
         #dsmow597#35 = "00";
         #dsmow597#36 = "00";
         #dsmow597#37 = "00";
         #dsmow597#38 = "00";
         #dsmow597#39 = "00";
         #dsmow597#40 = "0";
         #dsmow597#41 = "0";
         #dsmow597#42 = "0";
         #dsmow597#43 = "0";
         #dsmow597#44 = "0";
         #dsmow597#45 = "0";
         #dsmow597#46 = "0";
         #dsmow597#47 = "0";
         #dsmow597#48 = "0";
         #dsmow597#49 = "0";
         #dsmow597#50 = "0";
         #dsmow597#51 = "0";
         #dsmow597#52 = "0";
         #dsmow597#53 = "0";
     |FINSI;

     nHCampo = 55;
     |SI #eosy0009#39 ] 2012;  |Y eaOpcion ! "3";
         nHCampo = 54;
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ nHCampo;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #dsmow597#nCampo#;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;
|FPRC;

|PROCESO Tipo2;
     |SI #eosy0009#39 [ 2002;                    |HAZ Tipo2_2002;  |FINSI;
     |SI #eosy0009#39 ] 2003;  |Y #eosy0009#39 [ 2008;  |HAZ Tipo2_2003;  |FINSI;
     |SI #eosy0009#39 ] 2009;                    |HAZ Tipo2_2009;  |FINSI;

     enSinActividad = 0;
|FPRC;

|PROCESO Trata190;
     |SI nSwLectura = 1;
        #eosw0077#31 = #eosw0077#31 + 1;

        enNume = #eosm0034#7;  |HAZ Conver13Signo;
        |SI #eosm0034#7 > 0;
            #eosw0077#32 = #eosw0077#32 + enNume;
        |SINO;
            #eosw0077#32 = #eosw0077#32 - enNume;
        |FINSI;

        enNume = #eosm0034#9;  |HAZ Conver13Signo;
        |SI #eosm0034#9 > 0;
            #eosw0077#32 = #eosw0077#32 + enNume;
        |SINO;
            #eosw0077#32 = #eosw0077#32 - enNume;
        |FINSI;

        enNume = #eosm0034#8;  |HAZ Conver13Signo;
        |SI #eosm0034#8 > 0;
            #eosw0077#33 = #eosw0077#33 + enNume;
        |SINO;
            #eosw0077#33 = #eosw0077#33 - enNume;
        |FINSI;

        enNume = #eosm0034#10; |HAZ Conver13Signo;
        |SI #eosm0034#10 > 0;
             #eosw0077#33 = #eosw0077#33 + enNume;
        |SINO;
             #eosw0077#33 = #eosw0077#33 - enNume;
        |FINSI;
     |FINSI;

     |SI nSwLectura = 2;  |HAZ Tipo2;  |FINSI;

     |SI nSwLectura = 3;  |O nSwLectura = 6;
         |SI #eosm0034#5 = "  ";  #eosm0034#5 = "00";  |FINSI;
         |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE eosm0034;
     #eosm0034#1;
     30;
     #eosm0030#0, #eosm0030#1, "            ", 0000, " ", "  ", 0, aDComple;
     #eosm0030#0, #eosm0030#1, "zzzzzzzzzzzz", 9999, "z", "zz", 9, aHComple;
     ;
     NULL, Trata190;
|FIN;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| TRATAMIENTO FICHERO DE PORTADAS
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO AbreFichero;
     nSwError   = 0;
     Raiz       = "";  |DIRECTORIO Raiz;
     Directorio = "";  |DBASE Directorio;
     Directorio = Directorio + "hacienda/" + aTipoSec;  |MKDIR Directorio;
     Directorio = Directorio + "/";
     Valfa = Raiz + "bin/agichmod 777 " + Directorio;
     |SYSTEM Valfa;

     Fichero    = "RT" + #eosy0009#39;
     NFichero   = Directorio + Fichero;          |QBF NFichero;

     Fichero  = "wb  "+ NFichero;

     Pos = -1;
     |FABRE Fichero;
     Handle = FSalida;
     |SI FSalida < 0;
         Valfa = "      [" + Fichero + "] inaccesible.";
         |MENAV Valfa;
         nSwError = 1;
     |FINSI;
|FPRC;

|PROCESO GrabaDiskette;
     #eosclien#0 = #eosm0030#0;
     |LEE 040#eosclien.=;
     |SI FSalida ! 0;  |DDEFECTO #eosclien;  |FINSI;

     #eoshacie#0 = #eosclien#18; #eoshacie#1 = #eosclien#19;
     |LEE 040#eoshacie.=;
     |SI FSalida ! 0; |DDEFECTO #eoshacie; |FINSI;

     #eosdaban#0 = #eosclien#0;
     |LEE 040#eosdaban.=;
     |SI FSalida ! 0; |DDEFECTO #eosdaban; |FINSI;

     aDComple = " ";
     aHComple = "z";
     |SI #eosm0030#3 = "C";
         aDComple = "S";
         aHComple = "S";
     |FINSI;

     nSwLectura = 2;  |BUCLE eosm0034;
|FPRC;

|PROCESO TrataTemporal;
     |SI nSwLectura = 6;       || Impresion Hojas Interiores Borrador
         |SI #eosw0077#31 ! 0;
             nNume = #eosw0077#31 $ 4;
             |SI nNume ! 0;
                 enTHojas = (#eosw0077#31 + (4 - nNume)) / 4;
             |SINO;
                 enTHojas = #eosw0077#31 / 4;
             |FINSI;
         |FINSI;

         #eosm0030#0 = #eosw0077#49;
         #eosm0030#1 = #eosy0009#39;
         |LEE 040#eosm0030.=;
         |SI FSalida = 0;
             |BUCLE eosm0034;
             |PIEINF;
         |FINSI;
         |ACABA;
     |FINSI;

     |SI nSwLectura = 4;
         |SI nSwDeDonde = 2;  |Y #eosw0077#48 = 0;  |ACABA;  |FINSI;

         |SI #eosw0077#48 = 0;
             Cadena = Handle + " " + "0";     |FGRABA Cadena;
         |SINO;
             Cadena = Handle + " " + "1";     |FGRABA Cadena;
         |FINSI;

         Cadena = Handle + " " + "190";   |FGRABA Cadena;
         Cadena = Handle + " " + #eosm0030#1;   |FGRABA Cadena;
         Cadena = Handle + " " + #eosw0077#9;   |FGRABA Cadena;
         aAlfa  = (("00" + #eosw0077#2) % -102) + (("000" + #eosw0077#3) % -103);
         Cadena = Handle + " " + aAlfa;   |FGRABA Cadena;
         Cadena = Handle + " " + #eosw0077#12;  |FGRABA Cadena;
         Cadena = Handle + " " + #eosw0077#13;  |FGRABA Cadena;
         |SI enAnyo ] 2001;
            Cadena = Handle + "    ";  |FGRABA Cadena;
         |FINSI;

         nNume  = #eosw0077#14;
         Cadena = Handle + " " + (("00000" + nNume) % -105);  |FGRABA Cadena;
         aAlfa = #eosw0077#15 % 0112;
         |SI enAnyo ] 2001;
            Cadena = Handle + " " + aAlfa;  |FGRABA Cadena;
         |SINO;
            Cadena = Handle + " " + #eosw0077#15;  |FGRABA Cadena;
         |FINSI;
         aAlfa  = (("00" + #eosw0077#17) % -102);
         Cadena = Handle + " " + aAlfa;   |FGRABA Cadena;
         aAlfa  = (("00" + #eosw0077#17) % -102) + (("000" + #eosw0077#18) % -103);
         Cadena = Handle + " " + aAlfa;   |FGRABA Cadena;
         |SI enAnyo ] 2001;
            aAlfa  = (#eosy0009#40 % 704) + (#eosy0009#40 % 402) + (#eosy0009#40 % 102);
         |SINO;
            aAlfa  = (#eosy0009#40 % 102) + "/" + (#eosy0009#40 % 402) + "/" + (#eosy0009#40 % 704);
         |FINSI;
         Cadena = Handle + " " + aAlfa;  |FGRABA Cadena;

         aAlfa = #eosw0077#46; |HAZ QuitaComasy0009; aAlfa  = (aAlfa + (" " * 30)) % 0130;
         Cadena = Handle + " " + aAlfa;  |FGRABA Cadena;

         aAlfa = #eosw0077#47; |HAZ QuitaComasy0009; aAlfa  = (aAlfa + (" " * 25)) % 125;
         Cadena = Handle + " " + aAlfa;  |FGRABA Cadena;

         |SI #eosy0009#39 ] 2002;
             Cadena = Handle + " " + (" " * 20);
             |FGRABA Cadena;
         |FINSI;

         Cadena = Handle + " " + &13 + &10;   |FGRABA Cadena;
         |ACABA;
     |FINSI;

     |SI nSwLectura = 1;
         |SI #eosw0077#48 ! 0;
             |BORRA 020#eosw0077.a;
             |LIBERA #eosw0077;
         |FINSI;
         |ACABA;
     |FINSI;

     |SI nSwDeDonde = 3;       || Impresion Hojas Interiores
         |SI #eosw0077#31 > 25;  |ACABA;  |FINSI;

         |ABRE #eosm0028;
         #eosm0028#0 = #eosw0077#49;
         |LEE 040#eosm0028.=;
         |SI FSalida ! 0;  |DDEFECTO #eosm0028;  |FINSI;
         |CIERRA #eosm0028;

         |SI #eosm0028#2 = "M";  |ACABA;  |FINSI;

         |SI #eosw0077#31 ! 0;
             nNume = #eosw0077#31 $ 4;
             |SI nNume ! 0;
                 enTHojas = (#eosw0077#31 + (4 - nNume)) / 4;
             |SINO;
                 enTHojas = #eosw0077#31 / 4;
             |FINSI;
         |FINSI;

         #eosm0030#0 = #eosw0077#49;
         #eosm0030#1 = #eosy0009#39;
         |LEE 040#eosm0030.=;
         |SI FSalida = 0;
             nSwLectura = 3;  |BUCLE eosm0034;
             |PIEINF;
         |FINSI;
         |ACABA;
     |FINSI;

     |SI #eosw0077#48 = 0;
         |SI nSwDeDonde = 1;
             |HAZ Tipo0;
         |FINSI;
     |SINO;
         #eosm0030#0 = #eosw0077#49;
         #eosm0030#1 = #eosy0009#39;
         |LEE 040#eosm0030.=;
         |SI FSalida = 0;
             aTipoP = "D";
             |HAZ Tipo1;
             |HAZ GrabaDiskette;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE eosw0077C;
     #eosw0077#1;
     ;
     000;
     999;
     be;
     NULL, TrataTemporal;
|FIN;

|PROCESO GrabaPortadas1;
     nContador = nContador + 1;

     #eosclien#0 = #eosm0030#0;
     |LEE 040#eosclien.=;
     |SI FSalida ! 0;  |DDEFECTO #eosclien;  |FINSI;

     #eoshacie#0 = #eosclien#18; #eoshacie#1 = #eosclien#19;
     |LEE 040#eoshacie.=;
     |SI FSalida ! 0; |DDEFECTO #eoshacie; |FINSI;

     #eosdaban#0 = #eosclien#0;
     |LEE 040#eosdaban.=;
     |SI FSalida ! 0; |DDEFECTO #eosdaban; |FINSI;

     |DDEFECTO #eosw0077;
     #eosw0077#48 = nContador;
     #eosw0077#0  = #eoshacie#2;
     #eosw0077#1  = #eoshacie#3;
     #eosw0077#2  = #eoshacie#0;
     #eosw0077#3  = #eoshacie#1;
     #eosw0077#4  = #eosm0030#1;

     |SI nSwDeDonde = 1;
         #eosw0077#5  = " ";
         #eosw0077#6  = " ";
         #eosw0077#7  = " ";
         #eosw0077#8  = "X";
     |FINSI;

     |SI nSwDeDonde = 2;
         #eosw0077#5  = " ";
         #eosw0077#6  = "X";
         #eosw0077#7  = " ";
         #eosw0077#8  = " ";
     |FINSI;

     |SI nSwDeDonde = 3;
         #eosw0077#5  = "X";
         #eosw0077#6  = " ";
         #eosw0077#7  = " ";
         #eosw0077#8  = " ";
     |FINSI;

     #eosw0077#9  = #eosclien#1;
     #eosw0077#10 = #eosclien#14;
     #eosw0077#11 = #eosclien#2;
     #eosw0077#12 = #eosclien#4;
     aAlfa  = #eosclien#5;  |HAZ QuitaComasy0009;
     #eosw0077#13 = aAlfa;
     nNume  = #eosclien#6;
     #eosw0077#14 = ("00000" + nNume) % -105;
     #eosw0077#50 = #eosclien#7;
     #eosw0077#51 = #eosclien#8;
     #eosw0077#52 = #eosclien#9;
     aAlfa  = #eosclien#13;  |HAZ QuitaComasy0009;
     #eosw0077#15 = aAlfa;
     #eosw0077#16 = #eosclien#12;
     #eosw0077#17 = #eosclien#10;
     #eosw0077#18 = #eosclien#11;

     |SI #eosm0030#3 = "C";  #eosw0077#19 = "C";  |FINSI;
     |SI #eosm0030#3 = "S";  #eosw0077#20 = "S";  |FINSI;

     #eosw0077#21 = #eosm0030#4;
     #eosw0077#22 = #eosm0030#5;
     #eosw0077#23 = #eosm0030#6;
     #eosw0077#24 = #eosm0030#7;
     #eosw0077#25 = #eosm0030#8;
     #eosw0077#26 = #eosm0030#9;
     #eosw0077#27 = #eosm0030#10;
     #eosw0077#28 = #eosm0030#11;
     #eosw0077#29 = #eosm0030#12;
     #eosw0077#30 = #eosm0030#13;
     #eosw0077#46 = #eosm0030#17;
     #eosw0077#47 = #eosm0030#18;
     #eosw0077#49 = #eosm0030#0;

     aDComple = " ";
     aHComple = "z";
     |SI #eosm0030#3 = "C";
         aDComple = "S";
         aHComple = "S";
     |FINSI;

     nSwLectura = 1;  |BUCLE eosm0034;      ||Carga Portada

     |GRABA 020#eosw0077.n;
     |LIBERA #eosw0077;

     nTotalP = #eosw0077#31;
     #eosw0077#48 = 0;
     |LEE 101#eosw0077.=;
     |SI FSalida = 0;
         #eosw0077#34 = #eosw0077#34 + 1;
         #eosw0077#35 = #eosw0077#35 + nTotalP;
         |GRABA 020#eosw0077.a;
     |FINSI;
     |LIBERA #eosw0077;
|FPRC;

|DEFBUCLE eosm0030C;
     #eosm0030#1;
     ;
     #eosy0009#0, #eosy0009#39;
     #eosy0009#1, #eosy0009#39;
     ;
     NULL, GrabaPortadas1;
|FIN;

|PROCESO PlanillaImp;
     #eosm0030#0 = #eosm0014#1;
     #eosm0030#1 = #eosy0009#39;
     |LEE 040#eosm0030.=;
     |SI FSalida = 0;  |HAZ GrabaPortadas1;  |FINSI;
|FPRC;

|DEFBUCLE eosm0014C;
     #eosm0014#1;
     ;
     #eosy0009#38, 00001;
     #eosy0009#38, 99999;
     ;
     NULL, PlanillaImp;
|FIN;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| POR COLECTIVO
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO Colectivo;
     nSwDeDonde = 1;
     nSwLectura = 1;  |CIERRAT #eosw0077;  |BUCLE eosw0077C;  |ABRET #eosw0077;

     |SI #eosy0009#0 = 0;
         |SI #eosy0009#38 = 0;
             |PARA nCampoD = Campo + 1;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
                   |SI #eosy0009#nCampoD# ! 0;
                       #eosm0030#0 = #eosy0009#nCampoD#;
                       #eosm0030#1 = #eosy0009#39;
                       |LEE 040#eosm0030.=;
                       |SI FSalida = 0;  |HAZ GrabaPortadas1;  |FINSI;
                   |FINSI;
             |SIGUE;
         |SINO;
             |BUCLE eosm0014C;
         |FINSI;
     |SINO;
         |CIERRAT #eosm0030;
         |BUCLE eosm0030C;
         |ABRET #eosm0030;
     |FINSI;
|FPRC;

|PROCESO DatosPresen;
     #eosw0077#48 = 0;
     |LEE 101#eosw0077.=;
     |SI FSalida ! 0;
         |DDEFECTO #eosw0077;
         #eosw0077#48 = 0;
         nSwLectura = 1;
         |GRABA 020#eosw0077.b;
     |FINSI;

     #eosw0077#4  = #eosy0009#39;
     #eosw0077#5  = " ";
     #eosw0077#6  = " ";
     #eosw0077#7  = "X";
     #eosw0077#8  = " ";

     nContador = 0;
     #eosw0077#31    = 0;
     #eosw0077#32    = 0;
     #eosw0077#33    = 0;
     #eosw0077#34    = 0;
     #eosw0077#35    = 0;
     |GRABA 020#eosw0077.a;
     |LIBERA #eosw0077;

     |HAZ Colectivo;

     #eosw0077#48 = 0;
     |LEE 101#eosw0077.=;
     |SI FSalida = 0;
         |PUSHV 0501 2380;
         |PINPA #0#eosw0077;
         |PINDA #0#eosw0077;
         |ENDATOS #1#eosw0077;
         |SI FSalida = 0;
             nNume  = #eosw0077#14;
             #eosw0077#14 = ("00000" + nNume) % -105;

             |GRABA 020#eosw0077.a;
         |FINSI;
         |LIBERA #eosw0077;
         |POPV;
     |FINSI;
|FPRC;

|PROCESO CreacionDisk;
     |SI nSwDeDonde = 1;
         #eosw0077#48 = 0;
         |LEE 040#eosw0077.=;
         |SI FSalida ! 0;  |DDEFECTO #eosw0077;  |FINSI;
         |SI #eosw0077#34 = 0;
             |MENAV "     Por favor haga la creacion de Diskette.";
             |ACABA;
         |FINSI;
     |SINO;
         #eosw0077#48 = 1;
         |LEE 040#eosw0077.=;
         |SI FSalida ! 0;  |DDEFECTO #eosw0077;  |FINSI;
         |SI #eosw0077#31 = 0;
             |MENAV "     Por favor haga la creacion de Diskette.";
             |ACABA;
         |FINSI;
     |FINSI;

     |HAZ AbreFichero;
     |SI nSwError = 0;
         nSwLectura = 2;  |CIERRAT #eosw0077;  |BUCLE eosw0077C;  |ABRET #eosw0077;
     |FINSI;

     FSalida = Handle;
     |FCIERRA FSalida;

     |MENAV "     Fichero Creado con Exito.";
|FPRC;

|PROCESO Borrador;
     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #eosy0009#39 [ 1999;  |INFOR "eosy3009";  |FINSI;
     |SI #eosy0009#39 = 2000;  |INFOR "eosy6009";  |FINSI;
     |SI #eosy0009#39 = 2001;  |INFOR "eosy6009";  |FINSI;
     |SI #eosy0009#39 = 2002;  |INFOR "eosy6009";  |FINSI;
     |SI #eosy0009#39 ] 2003;  |INFOR "eosy7009";  |FINSI;

     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     nSwLectura = 6;  |CIERRAT #eosw0077;  |BUCLE eosw0077C;  |ABRET #eosw0077;

     |FININF;
     |FINIMP;
|FPRC;

|PROCESO Verificacion;
/*
     |SI #eosy0009#39 ] 2000;
         |MENAV "     Hacienda aun no ha proporcionado el programa de Validacion";
         |ACABA;
     |FINSI;
*/

     |SI nSwDeDonde = 1;
         #eosw0077#48 = 0;
         |LEE 040#eosw0077.=;
         |SI FSalida ! 0;  |DDEFECTO #eosw0077;  |FINSI;
         |SI #eosw0077#34 = 0;
             |MENAV "     Por favor haga la creacion de Diskette.";
             |ACABA;
         |FINSI;
     |SINO;
         #eosw0077#48 = 1;
         |LEE 040#eosw0077.=;
         |SI FSalida ! 0;  |DDEFECTO #eosw0077;  |FINSI;
         |SI #eosw0077#31 = 0;
             |MENAV "     Por favor haga la creacion de Diskette.";
             |ACABA;
         |FINSI;
     |FINSI;

     Raiz       = "";  |DIRECTORIO Raiz;
     Directorio = "";
     |DBASE Directorio;
     Directorio = Directorio + "hacienda/" + aTipoSec;
     |MKDIR Directorio;
     Directorio = Directorio + "/";
     Valfa = Raiz + "bin/agichmod 777 " + Directorio;
     |SYSTEM Valfa;

     Fichero    = "RT" + #eosy0009#39 + ".car";
     NFichero   = Directorio + Fichero;          |QBF NFichero;

     Fichero  = "wb  "+ NFichero;
     Pos = -1;
     |FABRE Fichero;
     Handle = FSalida;
     |SI FSalida ] 0;
         nSwLectura = 4;  |CIERRAT #eosw0077;   |BUCLE eosw0077C;  |ABRET #eosw0077;
     |FINSI;
     FSalida = Handle;
     |FCIERRA FSalida;

     |HAZ GrabaDisketteV;

     Fichero    = "RT" + #eosy0009#39 + ".txt";
     Fichero     = "/MODELOS/" + eaTipoSec + "/" + Fichero;
     |XABRE "EC", Fichero, nCanal;
     |SI FSalida < 0;
        SwError = 0;
        ||PEPE
     |SINO;
        SwError = 1;
     |FINSI;
|FPRC;

|PROCESO MenuCol;
     |SI #eosy0009#39 ] 2003;  aMenuCol10 = "";  |FINSI;

     |PUSHV 0501 2380;
     |PARA; |SI; |HACIENDO;
            |MENUG aMenuCol;
            aMenuCol2 = FSalida; SwError = 0;

            |SI aMenuCol2 < "1";  |O aMenuCol2 > "7";  |SAL;  |FINSI;

            |SI aMenuCol2 = "1"; |HAZ DatosPresen;     |FINSI;
            |SI aMenuCol2 = "2"; |HAZ CreacionDisk;    |FINSI;
            |SI aMenuCol2 = "3";
               |HAZ Verificacion;
               |SI SwError = 1; |HAZ Errores190; |FINSI;
            |FINSI;
            |SI aMenuCol2 = "4"; |HAZ Etiquetas;       |FINSI;
            |SI aMenuCol2 = "5"; |HAZ GrabaDisketteC;  |FINSI;
            |SI aMenuCol2 = "6"; |HAZ Borrador;        |FINSI;
            |SI aMenuCol2 = "7"; |HAZ Portadas;        |FINSI;
     |SIGUE;
     |POPV;

     nSwLectura = 1;  |CIERRAT #eosw0077;  |BUCLE eosw0077C;  |ABRET #eosw0077;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| POR INDIVIDUAL
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO Individual;
     nSwLectura = 1;  |CIERRAT #eosw0077;  |BUCLE eosw0077C;  |ABRET #eosw0077;

     |SI #eosy0009#0 = 0;
         |SI #eosy0009#38 = 0;
             |PARA nCampoD = Campo + 1;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
                   |SI #eosy0009#nCampoD# ! 0;
                       #eosm0030#0 = #eosy0009#nCampoD#;
                       #eosm0030#1 = #eosy0009#39;
                       |LEE 040#eosm0030.=;
                       |SI FSalida = 0;  |HAZ GrabaPortadas1;  |FINSI;
                   |FINSI;
             |SIGUE;
         |SINO;
             |BUCLE eosm0014C;
         |FINSI;
     |SINO;
         |CIERRAT #eosm0030;
         |BUCLE eosm0030C;
         |ABRET #eosm0030;
     |FINSI;
|FPRC;

|PROCESO MenuInd;
     nContador = 0;
     |SI #eosy0009#0 = 0;
         |CUADRO 0501 2380;
         |BLANCO 0602 2279;
         |PINTA 0702, "PARA EMITIR LA INDIVIDUAL PONER EN EL DESDE/HASTA DE";
         |PINTA 0802, "LA SELECCION DE EMPRESAS EL MISMO CODIGO DE CLIENTE,";
         |PINTA 0902, "YA QUE CREAMOS UN DISKETTE POR EMPRESA.             ";
         |PAUSA;
         |ACABA;
     |FINSI;

     |SI #eosy0009#0 ! 0;
         |SI #eosy0009#1 ! #eosy0009#0;
             |CUADRO 0501 2380;
             |BLANCO 0602 2279;
             |PINTA 0702, "PARA EMITIR LA INDIVIDUAL PONER EN EL DESDE/HASTA DE";
             |PINTA 0802, "LA SELECCION DE EMPRESAS EL MISMO CODIGO DE CLIENTE,";
             |PINTA 0902, "YA QUE CREAMOS UN DISKETTE POR EMPRESA.             ";
             |PAUSA;
             |ACABA;
        |FINSI;
     |FINSI;

     |PUSHV 0501 2380;
     nSwDeDonde = 2;
     |HAZ Individual;

     |SI #eosy0009#39 ] 2003;  aMenuInd9 = "";  |FINSI;

     |PARA; |SI; |HACIENDO;
            |MENUG aMenuInd;
            aMenuInd2 = FSalida;

            |SI aMenuInd2 < "1";  |O aMenuInd2 > "6";  |SAL;  |FINSI;

            |SI aMenuInd2 = "1"; |HAZ CreacionDisk;    |FINSI;
            |SI aMenuInd2 = "2";
               |HAZ Verificacion;
               |SI SwError = 1; |HAZ Errores190; |FINSI;
            |FINSI;
            |SI aMenuInd2 = "3"; |HAZ Etiquetas;       |FINSI;
            |SI aMenuInd2 = "4"; |HAZ GrabaDisketteC;  |FINSI;
            |SI aMenuInd2 = "5"; |HAZ Borrador;        |FINSI;
            |SI aMenuInd2 = "6"; |HAZ Portadas;        |FINSI;
     |SIGUE;
     |POPV;

     nSwLectura = 1;  |CIERRAT #eosw0077;  |BUCLE eosw0077C;  |ABRET #eosw0077;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| POR LASER
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO Caratula1999;
     Cadena = Handle + " " + "1";     |FGRABA Cadena;
     Cadena = Handle + " " + "190";   |FGRABA Cadena;
     Cadena = Handle + " " + #eosm0030#1;   |FGRABA Cadena;
     Cadena = Handle + " " + #eosw0077#9;   |FGRABA Cadena;
     aAlfa  = (("00" + #eosw0077#2) % -102) + (("000" + #eosw0077#3) % -103);
     Cadena = Handle + " " + aAlfa;   |FGRABA Cadena;
     Cadena = Handle + " " + #eosw0077#12;  |FGRABA Cadena;
     Cadena = Handle + " " + #eosw0077#13;  |FGRABA Cadena;
     Cadena = Handle + " " + #eosw0077#14;  |FGRABA Cadena;
     Cadena = Handle + " " + #eosw0077#15;  |FGRABA Cadena;
     aAlfa  = (("00" + #eosw0077#17) % -102);
     Cadena = Handle + " " + aAlfa;   |FGRABA Cadena;
     aAlfa  = (("00" + #eosw0077#17) % -102) + (("000" + #eosw0077#18) % -103);
     Cadena = Handle + " " + aAlfa;   |FGRABA Cadena;
     aAlfa  = (#eosy0009#40 % 102) + "/" + (#eosy0009#40 % 402) + "/" + (#eosy0009#40 % 704);
     Cadena = Handle + " " + aAlfa;  |FGRABA Cadena;
     Cadena = Handle + " " + #eosw0077#46;  |FGRABA Cadena;
     Cadena = Handle + " " + #eosw0077#47;  |FGRABA Cadena;
     Cadena = Handle + " " + &13 + &10;   |FGRABA Cadena;
|FPRC;

|PROCESO Caratula2000;
     Cadena = Handle + " " + "1";     |FGRABA Cadena;
     Cadena = Handle + " " + "190";   |FGRABA Cadena;
     Cadena = Handle + " " + #eosm0030#1;   |FGRABA Cadena;
     Cadena = Handle + " " + #eosw0077#9;   |FGRABA Cadena;
     aAlfa  = (("00" + #eosw0077#2) % -102) + (("000" + #eosw0077#3) % -103);
     Cadena = Handle + " " + aAlfa;   |FGRABA Cadena;
     Cadena = Handle + " " + #eosw0077#12;  |FGRABA Cadena;
     Cadena = Handle + " " + #eosw0077#13 + "   ";  |FGRABA Cadena;
     nNume  = #eosw0077#14;
     Cadena = Handle + " " + (("00000" + nNume) % -105);  |FGRABA Cadena;
     aAlfa  = #eosw0077#15;  |HAZ QuitaComasy0009;
     aAlfa  = (aAlfa + (" " * 12)) % 112;
     Cadena = Handle + " " + aAlfa;  |FGRABA Cadena;
     aAlfa  = (("00" + #eosw0077#17) % -102);
     Cadena = Handle + " " + aAlfa;   |FGRABA Cadena;
     aAlfa  = (("00" + #eosw0077#17) % -102) + (("000" + #eosw0077#18) % -103);
     Cadena = Handle + " " + aAlfa;   |FGRABA Cadena;
     aAlfa  = (#eosy0009#40 % 704) + (#eosy0009#40 % 402) + (#eosy0009#40 % 102);
     Cadena = Handle + " " + aAlfa;  |FGRABA Cadena;
     Cadena = Handle + " " + #eosw0077#46;  |FGRABA Cadena;
     Cadena = Handle + " " + #eosw0077#47;  |FGRABA Cadena;
     Cadena = Handle + " " + &13 + &10;   |FGRABA Cadena;
|FPRC;

|PROCESO Caratula2002;
     Cadena = Handle + " " + "1";     |FGRABA Cadena;
     Cadena = Handle + " " + "190";   |FGRABA Cadena;
     Cadena = Handle + " " + #eosm0030#1;   |FGRABA Cadena;
     Cadena = Handle + " " + #eosw0077#9;   |FGRABA Cadena;
     aAlfa  = (("00" + #eosw0077#2) % -102) + (("000" + #eosw0077#3) % -103);
     Cadena = Handle + " " + aAlfa;   |FGRABA Cadena;
     Cadena = Handle + " " + #eosw0077#12;  |FGRABA Cadena;
     Cadena = Handle + " " + #eosw0077#13 + "   ";  |FGRABA Cadena;
     nNume  = #eosw0077#14;
     Cadena = Handle + " " + (("00000" + nNume) % -105);  |FGRABA Cadena;
     aAlfa  = #eosw0077#15;  |HAZ QuitaComasy0009;
     aAlfa  = (aAlfa + (" " * 12)) % 112;
     Cadena = Handle + " " + aAlfa;  |FGRABA Cadena;
     aAlfa  = (("00" + #eosw0077#17) % -102);
     Cadena = Handle + " " + aAlfa;   |FGRABA Cadena;
     aAlfa  = (("00" + #eosw0077#17) % -102) + (("000" + #eosw0077#18) % -103);
     Cadena = Handle + " " + aAlfa;   |FGRABA Cadena;
     aAlfa  = (#eosy0009#40 % 704) + (#eosy0009#40 % 402) + (#eosy0009#40 % 102);
     Cadena = Handle + " " + aAlfa;  |FGRABA Cadena;
     Cadena = Handle + " " + #eosw0077#46;  |FGRABA Cadena;
     Cadena = Handle + " " + #eosw0077#47;  |FGRABA Cadena;
     Cadena = Handle + " " + ((("00000" + #eosm0030#0) % -105) + (" " * 15));  |FGRABA Cadena;
     Cadena = Handle + " " + &13 + &10;   |FGRABA Cadena;
|FPRC;

|PROCESO Caratula2004;
     aAlfa = "1";                          |XGRABA nHandle3, aAlfa;
     aAlfa = "190";                        |XGRABA nHandle3, aAlfa;
     aAlfa = #eosm0030#1;                        |XGRABA nHandle3, aAlfa;
     aAlfa = #eosw0077#9;                        |XGRABA nHandle3, aAlfa;
     aAlfa = (("00" + #eosw0077#2) % -102) + (("000" + #eosw0077#3) % -103); |XGRABA nHandle3, aAlfa;
     aAlfa = #eosw0077#12;                       |XGRABA nHandle3, aAlfa;
     aAlfa = #eosw0077#13 + "   ";               |XGRABA nHandle3, aAlfa;
     aAlfa = (("00000" + #eosw0077#14) % -105);  |XGRABA nHandle3, aAlfa;
     aAlfa = #eosw0077#15;  |HAZ QuitaComasy0009;
     aAlfa = (aAlfa + (" " * 12)) % 112;   |XGRABA nHandle3, aAlfa;
     aAlfa = (("00" + #eosw0077#17) % -102);     |XGRABA nHandle3, aAlfa;
     aAlfa = (("00" + #eosw0077#17) % -102) + (("000" + #eosw0077#18) % -103);
                                           |XGRABA nHandle3, aAlfa;
     aAlfa = (#eosy0009#40 % 704) + (#eosy0009#40 % 402) + (#eosy0009#40 % 102); |XGRABA nHandle3, aAlfa;
     aAlfa = #eosw0077#46;  |HAZ QuitaComasy0009;  #eosw0077#46 = aAlfa;
     aAlfa = #eosw0077#46;                       |XGRABA nHandle3, aAlfa;
     aAlfa = #eosw0077#47;                       |XGRABA nHandle3, aAlfa;
     aAlfa = ((("00000" + #eosm0030#0) % -105) + (" " * 15)); |XGRABA nHandle3, aAlfa;
     aAlfa = &13 + &10;                     |XGRABA nHandle3, aAlfa;
|FPRC;

|PROCESO Caratula2007;
     aAlfa = "1";                          |XGRABA nHandle3, aAlfa;
     aAlfa = "190";                        |XGRABA nHandle3, aAlfa;
     aAlfa = #eosm0030#1;                        |XGRABA nHandle3, aAlfa;
     aAlfa = #eosw0077#9;                        |XGRABA nHandle3, aAlfa;
     aAlfa = (#eosy0009#40 % 704) + (#eosy0009#40 % 402) + (#eosy0009#40 % 102); |XGRABA nHandle3, aAlfa;
     aAlfa = #eosw0077#46;  |HAZ QuitaComasy0009;  #eosw0077#46 = aAlfa;
     aAlfa = #eosw0077#46;                       |XGRABA nHandle3, aAlfa;
     aAlfa = #eosw0077#47;                       |XGRABA nHandle3, aAlfa;
     aAlfa = ((("00000" + #eosm0030#0) % -105) + (" " * 15)); |XGRABA nHandle3, aAlfa;
     aAlfa = &13 + &10;                     |XGRABA nHandle3, aAlfa;
|FPRC;

|PROCESO Desarrollo2003;
     nSwLectura = 1;
     |BUCLE eosm0034;      ||Carga Portada
     |SI #eosw0077#31 > 25;
         aAlfa1 = "      Empresas " + #eosm0030#0 + " " + #eosm0030#2;  |QBF aAlfa1;
         aAlfa1 = aAlfa1 + " con mas de 25 Perceptores";
         |MENAV aAlfa1;
         |ACABA;
     |FINSI;

     |ABRE #eosm0028;
     #eosm0028#0 = #eosm0030#0;
     |LEE 040#eosm0028.=;
     |SI FSalida ! 0;  |DDEFECTO #eosm0028;  |FINSI;
     |CIERRA #eosm0028;

     |SI #eosm0028#2 = "M";
         aAlfa1 = "      Empresas " + #eosm0030#0 + " " + #eosm0030#2;  |QBF aAlfa1;
         aAlfa1 = aAlfa1 + " Modelo 110 mensual, Emitir por Soporte.";
         |MENAV aAlfa1;
         |ACABA;
     |FINSI;

     nSwSecuen  = 1;
     Raiz       = "";  |DIRECTORIO Raiz;
     Directorio = "";
     |DBASE Directorio;
     Directorio = Directorio + "hacienda/" + aTipoSec;
     |MKDIR Directorio;
     Directorio = Directorio + "/";
     Valfa = Raiz + "bin/agichmod 777 " + Directorio;
     |SYSTEM Valfa;

     Empresa  = #eosm0030#0;  Empresa  = ("00000" + Empresa) % -105;

     Fichero    = aTipoSec + Empresa;
     INEmpresas = NEmpresas1 <-;
     INEmpresas = INEmpresas + NACopiar;
     NFichero   = Directorio + Fichero;          |QBF NFichero;
     NEmpresas  = NFichero;

     Fichero  = "wb  "+ NFichero;

     Pos = -1;
     |FABRE Fichero;
     Handle = FSalida;
     |SI FSalida ] 0;
         aTipoP = "D";
         |HAZ Tipo1;

         nSwLectura = 2;  |BUCLE eosm0034;
     |FINSI;
     FSalida = Handle;
     |FCIERRA FSalida;

     Fichero   = aTipoSec + Empresa + ".car";
     INEmpresas = NEmpresas1 <-;
     INEmpresas = INEmpresas + NACopiar;
     NFichero   = Directorio + Fichero;          |QBF NFichero;

     Fichero  = "wb  "+ NFichero;
     Pos = -1;
     |FABRE Fichero;
     Handle = FSalida;
     |SI FSalida ] 0;
         |SI #eosm0030#1 [ 1999;  |HAZ Caratula1999;  |FINSI;
         |SI #eosm0030#1 = 2000;  |HAZ Caratula2000;  |FINSI;
         |SI #eosm0030#1 = 2001;  |HAZ Caratula2000;  |FINSI;
         |SI #eosm0030#1 = 2002;  |HAZ Caratula2002;  |FINSI;
         |SI #eosm0030#1 = 2003;  |HAZ Caratula2002;  |FINSI;
     |FINSI;
     FSalida = Handle;
     |FCIERRA FSalida;

     NACopiar   = NACopiar + 1;
|FPRC;

|PROCESO AbreImprime190;
     aAbre = eaUnidad + "\MODELOS\" + aTipoSec + "\" + #eosy0009#39 + "\imprime.bat";
     |XABRE "CBW", aAbre, nHandle1;

     aAlfa = "CD \" + &13 + &10;                 |XGRABA nHandle1, aAlfa;
     aAlfa = "CD MODELOS" + &13 + &10;           |XGRABA nHandle1, aAlfa;
     aAlfa = "CD 190" + &13 + &10;               |XGRABA nHandle1, aAlfa;
     aAlfa = "CD " + #eosy0009#39 + &13 + &10;          |XGRABA nHandle1, aAlfa;

     |SI #eosy0009#39 = 2004;
         |SI nTecla = 1;
             aAlfa = "ZLS04190.EXE -y" + &13 + &10;  |XGRABA nHandle1, aAlfa;
         |SINO;
             aAlfa = "ZPR04190.EXE -Y" + &13 + &10;  |XGRABA nHandle1, aAlfa;
         |FINSI;
     |FINSI;

     |SI #eosy0009#39 = 2005;
         |SI nTecla = 1;
             aAlfa = "ZLS05190.EXE -y" + &13 + &10;  |XGRABA nHandle1, aAlfa;
         |SINO;
             aAlfa = "ZPR05190.EXE -Y" + &13 + &10;  |XGRABA nHandle1, aAlfa;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Desarrollo2004;
     nSwLectura = 1;
     |BUCLE eosm0034;      ||Carga Portada

     |SI nTecla = 1;
         |SI #eosy0009#39 [ 2005;
             |SI #eosw0077#31 > 25;
                 aAlfa1 = "      Empresas " + #eosm0030#0 + " " + #eosm0030#2;  |QBF aAlfa1;
                 aAlfa1 = aAlfa1 + " con mas de 25 Perceptores";
                 |MENAV aAlfa1;
                 |ACABA;
             |FINSI;
         |FINSI;

         |SI #eosy0009#39 ] 2006;
             |SI #eosw0077#31 > 15;
                 aAlfa1 = "      Empresas " + #eosm0030#0 + " " + #eosm0030#2;  |QBF aAlfa1;
                 aAlfa1 = aAlfa1 + " con mas de 15 Perceptores";
                 |MENAV aAlfa1;
                 |ACABA;
             |FINSI;
         |FINSI;

         |ABRE #eosm0028;
         #eosm0028#0 = #eosm0030#0;
         |LEE 040#eosm0028.=;
         |SI FSalida ! 0;  |DDEFECTO #eosm0028;  |FINSI;
         |CIERRA #eosm0028;

         |SI #eosm0028#2 = "M";
             aAlfa1 = "      Empresas " + #eosm0030#0 + " " + #eosm0030#2;  |QBF aAlfa1;
             aAlfa1 = aAlfa1 + " Modelo 110 mensual, Emitir por Internet.";
             |MENAV aAlfa1;
             |ACABA;
         |FINSI;
     |FINSI;

     aAbre = eaUnidad + "\MODELOS\" + aTipoSec + "\" + #eosy0009#39 + "\" + "RCA" + (("00000" + #eosm0030#0) % -105) + ".TXT";
     |XABRE "CBW", aAbre, nHandle2;

     aAbre = eaUnidad + "\MODELOS\" + aTipoSec + "\" + #eosy0009#39 + "\" + "RCB" + (("00000" + #eosm0030#0) % -105) + ".TXT";
     |XABRE "CBW", aAbre, nHandle3;

     aTipoP = "T";
     |SI #eosm0030#1 [ 2008;  |HAZ Tipo1;       |FINSI;
     |SI #eosm0030#1 ] 2009;  |HAZ Tipo1_2009;  |FINSI;

     nSwLectura = 2;  |BUCLE eosm0034;

     |SI #eosm0030#1 [ 2006;
         |HAZ Caratula2004;
     |SINO;
         |HAZ Caratula2007;
     |FINSI;

     |XCIERRA nHandle2;
     |XCIERRA nHandle3;

     |SI #eosy0009#39 [ 2005;
         |SI nTecla = 1;
             aAlfa = "wait 190pdf /E:RCA" + (("00000" + #eosm0030#0) % -105) + ".TXT ";
             aAlfa = aAlfa + "/R:RCC" + (("00000" + #eosm0030#0) % -105) + ".TXT ";
             aAlfa = aAlfa + "/I: ";
             aAlfa = aAlfa + "/C:" + aTercera + " ";
             aAlfa = aAlfa + "/F:FLAG.TXT ";
             aAlfa = aAlfa + "/A:RCB" + (("00000" + #eosm0030#0) % -105) + ".TXT ";
             aAlfa = aAlfa + &13 + &10;
             |XGRABA nHandle1, aAlfa;
         |SINO;
             aAlfa = "wait VI190 /E:RCA" + (("00000" + #eosm0030#0) % -105) + ".TXT ";
             aAlfa = aAlfa + "/R:RCC" + (("00000" + #eosm0030#0) % -105) + ".TXT ";
             aAlfa = aAlfa + &13 + &10;
             |XGRABA nHandle1, aAlfa;
         |FINSI;
     |SINO;
         eaTipoE =  "RCA" + (("00000" + #eosm0030#0) % -105) + ".TXT";
         eaTipoR =  "RCC" + (("00000" + #eosm0030#0) % -105) + ".TXT";
         eaTipoP =  "PDF" + (("00000" + #eosm0030#0) % -105) + ".PDF";

         |SI nTecla = 1;
             eaTipoC =  aTercera;
             eaTipoA =  "RCB" + (("00000" + #eosm0030#0) % -105) + ".TXT";
             eaTipoV =  "N";
         |SINO;
             eaTipoV =  "S";
         |FINSI;

         |HAZ LineaShellJava;
     |FINSI;
|FPRC;

|PROCESO DesarrollaLaser;
     #eosclien#0 = #eosm0030#0;
     |LEE 040#eosclien.=;
     |SI FSalida ! 0;  |DDEFECTO #eosclien;  |FINSI;

     #eoshacie#0 = #eosclien#18; #eoshacie#1 = #eosclien#19;
     |LEE 040#eoshacie.=;
     |SI FSalida ! 0; |DDEFECTO #eoshacie; |FINSI;

     #eosdaban#0 = #eosclien#0;
     |LEE 040#eosdaban.=;
     |SI FSalida ! 0; |DDEFECTO #eosdaban; |FINSI;

     |DDEFECTO #eosw0077;
     #eosw0077#0  = #eoshacie#2;
     #eosw0077#1  = #eoshacie#3;
     #eosw0077#2  = #eoshacie#0;
     #eosw0077#3  = #eoshacie#1;
     #eosw0077#4  = #eosm0030#1;
     #eosw0077#5  = "X";
     #eosw0077#6  = " ";
     #eosw0077#7  = " ";
     #eosw0077#8  = " ";
     #eosw0077#9  = #eosclien#1;
     #eosw0077#10 = #eosclien#14;
     #eosw0077#11 = #eosclien#2;
     #eosw0077#12 = #eosclien#4;
     aAlfa  = #eosclien#5;  |HAZ QuitaComasy0009;
     #eosw0077#13 = aAlfa;
     nNume  = #eosclien#6;
     #eosw0077#14 = ("00000" + nNume) % -105;
     #eosw0077#50 = #eosclien#7;
     #eosw0077#51 = #eosclien#8;
     #eosw0077#52 = #eosclien#9;
     aAlfa  = #eosclien#13;  |HAZ QuitaComasy0009;
     #eosw0077#15 = aAlfa;
     #eosw0077#16 = #eosclien#12;
     #eosw0077#17 = #eosclien#10;
     #eosw0077#18 = #eosclien#11;

     |SI #eosm0030#3 = "C";  #eosw0077#19 = "C";  |FINSI;
     |SI #eosm0030#3 = "S";  #eosw0077#20 = "S";  |FINSI;

     #eosw0077#21 = #eosm0030#4;
     #eosw0077#22 = #eosm0030#5;
     #eosw0077#23 = #eosm0030#6;
     #eosw0077#24 = #eosm0030#7;
     #eosw0077#25 = #eosm0030#8;
     #eosw0077#26 = #eosm0030#9;
     #eosw0077#27 = #eosm0030#10;
     #eosw0077#28 = #eosm0030#11;
     #eosw0077#29 = #eosm0030#12;
     #eosw0077#30 = #eosm0030#13;
     #eosw0077#46 = #eosm0030#17;
     #eosw0077#47 = #eosm0030#18;

     aDComple = " ";
     aHComple = "z";
     |SI #eosm0030#3 = "C";
         aDComple = "S";
         aHComple = "S";
     |FINSI;

     |SI #eosy0009#39 ] 2004;
         |HAZ Desarrollo2004;
     |SINO;
         |HAZ Desarrollo2003;
     |FINSI;
|FPRC;

|DEFBUCLE eosm0030L;
     #eosm0030#1;
     ;
     #eosy0009#0, #eosy0009#39;
     #eosy0009#1, #eosy0009#39;
     ;
     NULL, DesarrollaLaser;
|FIN;

|PROCESO PlanillaLaser;
     #eosm0030#0 = #eosm0014#1;
     #eosm0030#1 = #eosy0009#39;
     |LEE 040#eosm0030.=;
     |SI FSalida = 0;  |HAZ DesarrollaLaser;  |FINSI;
|FPRC;

|DEFBUCLE eosm0014L;
     #eosm0014#1;
     ;
     #eosy0009#38, 00000;
     #eosy0009#38, 99999;
     ;
     NULL, PlanillaLaser;
|FIN;

|PROCESO Laser;
     nSwSecuen = 0;
     |SI #eosy0009#0 = 0;
         |SI #eosy0009#38 = 0;
             |PARA nCampoD = Campo + 1;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
                   |SI #eosy0009#nCampoD# ! 0;
                       #eosm0030#0 = #eosy0009#nCampoD#;
                       #eosm0030#1 = #eosy0009#39;
                       |LEE 040#eosm0030.=;
                       |SI FSalida = 0;  |HAZ DesarrollaLaser;  |FINSI;
                   |FINSI;
             |SIGUE;
         |SINO;
             |BUCLE eosm0014L;
         |FINSI;
     |SINO;
         |CIERRAT #eosm0030;
         |BUCLE eosm0030L;
         |ABRET #eosm0030;
     |FINSI;

     |SI #eosy0009#39 [ 2003;
         |SI nSwSecuen = 1;
             |HAZ GrabaDisketteL;
         |FINSI;
     |FINSI;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| POR PAPEL OFICIAL
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO Interiores;
     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #eosy0009#39 [ 1999;
         |INFOR "eosy2009";
     |SINO;
         |INFOR "eosy5009";
     |FINSI;
     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     nSwLectura = 3;  |CIERRAT #eosw0077;  |BUCLE eosw0077C;  |ABRET #eosw0077;

     |FININF;
     |FINIMP;
|FPRC;

|PROCESO MenuPap;
     |SI #eosy0009#39 ] 2003;  |ACABA;  |FINSI;

     nSwDeDonde = 3;
     |HAZ Individual;
     |PUSHV 0501 2380;
     |PARA; |SI; |HACIENDO;
            |MENUG aMenuPap;
            aMenuPap2 = FSalida;

            |SI aMenuPap2 < "1";  |O aMenuPap2 > "2";  |SAL;  |FINSI;

            |SI aMenuPap2 = "1";  |HAZ Portadas;    |FINSI;
            |SI aMenuPap2 = "2";  |HAZ Interiores;  |FINSI;
     |SIGUE;
     |POPV;
     nSwLectura = 1;  |CIERRAT #eosw0077;  |BUCLE eosw0077C;  |ABRET #eosw0077;
|FPRC;

|PROCESO Boton1901;
     |PTEC 824;
|FPRC;

|PROCESO Boton1902;
     |PTEC 825;
|FPRC;

|PROCESO Boton1903;
     |PTEC 826;
|FPRC;

|PROCESO Boton1904;
     |PTEC 827;
|FPRC;

|PROCESO Boton1905;
     |PTEC 828;
|FPRC;

|PROCESO Boton1906;
     |PTEC 806;
|FPRC;

|PROCESO Botones2004;
     |BLANCO 0501 2380;

     |CONTROL_SIMPLE 0, "LBOTON, <F2> Emision Papel Oficial Laser          ", 0513, 0754, Boton1901;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F3> Internet ", 0913, 1154, Boton1902;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,ESC Cancelar", 2365, 2378, Boton1906;
     nBoton3 = FSalida;

     aF2 = &255 + "824";
     aF3 = &255 + "825";
     aF4 = &255 + "826";
     aF5 = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF2;  nTecla = 1;   |SAL;  |FINSI;
         |SI aTecla = aF3;  nTecla = 3;   |SAL;  |FINSI;
         |SI aTecla = aF5;  nTecla = 0;   |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;

     |PULSATECLA;
|FPRC;

|PROCESO Botones2006;
     |BLANCO 0501 2380;

     |CONTROL_SIMPLE 0, "LBOTON, <F2> Emision Papel Oficial Laser (Directo por impresora) ", 0513, 0754, Boton1901;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F3> Emision Papel Oficial Laser (Vista previa por el Acrobat) ", 0913, 1154, Boton1902;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F4> Presentacion Telematica ", 1313, 1554, Boton1903;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F6> Directorio Acrobat  ", 1713, 1954, Boton1905;
     nBoton5 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,ESC Cancelar", 2365, 2378, Boton1906;
     nBoton6 = FSalida;

     aF2 = &255 + "824";
     aF3 = &255 + "825";
     aF4 = &255 + "826";
     aF5 = &255 + "827";
     aF6 = &255 + "828";
     aF7 = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF2;  nTecla = 1; eaModoImpre = "I";    |SAL;  |FINSI;
         |SI aTecla = aF3;  nTecla = 1; eaModoImpre = "P";    |SAL;  |FINSI;
         |SI aTecla = aF4;  nTecla = 3;                       |SAL;  |FINSI;
         |SI aTecla = aF6;  |HAZ Acrobat;                            |FINSI;
         |SI aTecla = aF7;  nTecla = 0;   |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton5;
     |FIN_CONTROL_WINDOWS nBoton6;

     |PULSATECLA;
|FPRC;

|PROCESO CreaUnico;
     aAlfa      = "/AEAT";                       |RMKDIR aAlfa;
     aAlfa      = "/AEAT/INTERNET";              |RMKDIR aAlfa;
     aAlfa      = "/AEAT/INTERNET/190";          |RMKDIR aAlfa;
     aAlfa      = "/AEAT/INTERNET/190/" + #eosy0009#39; |RMKDIR aAlfa;
     eaInternet = aAlfa + "/";

     |DBASE aPathAfegir;  |QBF aPathAfegir;
     aPathAfegir = aPathAfegir + "basura";      |MKDIR aPathAfegir;
     aPathAfegir = aPathAfegir + "/tmp";        |MKDIR aPathAfegir;
     aPathAfegir = aPathAfegir + "/";

     aNombre = "19000000.txt";
     |PINTA 1320, "Nombre Fichero: ";
     |PINTA 1346, ".TXT";

     E_inf   = "";
     E_sup   = "8";
     |PARA;  |SI;  |HACIENDO;
             aNombre = 1336 ? 1;

             aAbre = eaInternet + aNombre + ".txt";
             |XABRE "EC", aAbre, nHandle1;
             |SI FSalida ] 0;
                 |CONFI "0000NEl Fichero ya existe, desea reemplazarlo.";
                 |SI FSalida = 0;  |SAL;  |FINSI;
             |SINO;
                 |SAL;
             |FINSI;
     |SIGUE;

     aDestino = eaInternet + aNombre + ".txt";
     |RFBORRA aDestino;

     aFichero    = aPathAfegir + "*.*";
     |_PDIR aFichero;
     |PARA; |SI; |HACIENDO;
            |SI FSalida ! 0; |SAL; |FINSI;
            |FBORRA aFichero;
            |_SDIR aFichero;
     |SIGUE;

     aIPRemoto   = "";
     |IP_REMOTO aIPRemoto;

     aPathInter  = "/MODELOS/190/" + #eosy0009#39 + "/AInternet";
     aPathInter  = aPathInter + "/";
     aFichero    = aPathInter + "*.bue";
     |R_PDIR aFichero;
     |PARA; |SI; |HACIENDO;
            |SI FSalida ! 0; |SAL; |FINSI;

            aBue     = aFichero - aPathInter;
            aDestino = aPathAfegir + aBue;

            |SI aIPRemoto = "";
                |COPIA_FICHERO aFichero, aDestino;
            |SINO;
                |RECIBE_FICHERO aFichero, aDestino;
            |FINSI;

            |RFBORRA aFichero

            aOrigen  = aDestino;
            aDestino = aPathAfegir + aNombre + ".txt";
            |AFEGIR_FICHERO aOrigen, aDestino;

            |FBORRA aOrigen

            |R_SDIR aFichero;
     |SIGUE;

     aOrigen  = aDestino;
     aDestino = eaInternet  + aNombre + ".txt";
     |SI aIPRemoto = "";
         |COPIA_FICHERO aOrigen, aDestino;
     |SINO;
         |ENVIA_FICHERO aOrigen, aDestino;
     |FINSI;

     |FBORRA aOrigen;

     aAlfa = "0000 El fichero generado esta en: \AEAT\INTERNET\190\" + #eosy0009#39 + " de su PC";
     |MENAV aAlfa;
|FPRC;

|PROCESO CreaVarios;
     aAlfa      = "/AEAT";                       |RMKDIR aAlfa;
     aAlfa      = "/AEAT/INTERNET";              |RMKDIR aAlfa;
     aAlfa      = "/AEAT/INTERNET/190";          |RMKDIR aAlfa;
     aAlfa      = "/AEAT/INTERNET/190/" + #eosy0009#39; |RMKDIR aAlfa;
     eaInternet = aAlfa + "/";

     aIPRemoto   = "";
     |IP_REMOTO aIPRemoto;

     aPathInter  = "/MODELOS/190/" + #eosy0009#39 + "/AInternet";
     aPathInter  = aPathInter + "/";
     aFichero    = aPathInter + "*.bue";
     |R_PDIR aFichero;
     |PARA; |SI; |HACIENDO;
            |SI FSalida ! 0; |SAL; |FINSI;

            aBue     = aFichero - aPathInter;
            aDestino = eaInternet + "190" + (aBue % 405) + ".txt";

            |RCOPIA_FICHERO aFichero, aDestino;

            |RFBORRA aFichero;

            |R_SDIR aFichero;
     |SIGUE;

     aAlfa = "     Los ficheros generados estan en: \AEAT\INTERNET\190\" + #eosy0009#39 + " de su PC";
     |MENAV aAlfa;
|FPRC;

|PROCESO Internet2004;
     eaFichError  = "rcc";
     eaFichDatos  = "rca";
     eaFichAuxil  = "rcb";
     enValidacion = 1;

     |HAZ BuscaErroresL;

     |SI enBuenos = 0;
         |MENAV "      Ha habido Errores, arreglelos y vuelva a emitir.";
         |ACABA;
     |FINSI;

     aAlfa = "EMPRESAS VALIDADAS  ...: " + enBuenos;
     |PINTA 0630, aAlfa;

     aAlfa = "EMPRESAS NO VALIDADAS .: " + enMalos;
     |PINTA 0730, aAlfa;

     |CONTROL_SIMPLE 0, " BOTON, CREAR UN UNICO FICHERO CON LAS EMPRESAS VALIDADAS ", 1120, 1265, Boton1901;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, " BOTON, FICHERO POR CADA UNA DE LAS EMPRESAS VALIDADAS", 1320, 1465, Boton1902;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, " BOTON,   CANCELAR    ", 1520, 1665, Boton1903;
     nBoton3 = FSalida;

     |PARA; |SI;  |HACIENDO;
            |LEETECLA aTecla;
            |SI aTecla = aF2;  nBoton = 1;  |SAL;  |FINSI;
            |SI aTecla = aF3;  nBoton = 2;  |SAL;  |FINSI;
            |SI aTecla = aF4;  |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;

     |PULSATECLA;

     |SI aTecla = aF4;  |ACABA;  |FINSI;

     |SI nBoton = 1;  |HAZ CreaUnico;   |FINSI;
     |SI nBoton = 2;  |HAZ CreaVarios;  |FINSI;
|FPRC;

|PROCESO EmiteEsto190;
     aAlfa = "DEL *.DLL" + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "DEL *.TAB" + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "DEL *.WMF" + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "DEL ERROR190.TXT"     + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "DEL *.EXE"         + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     |XCIERRA nHandle1;

     |DBASE aModelos;  |QBT aModelos;
     aModelos = aModelos + "hacienda/";

     |SI #eosy0009#39 = 2004;
         |SI nTecla = 1;
             eaFOrigen  = aModelos + "zls04190.exe";
             eaFDestino = "/MODELOS/190/" + #eosy0009#39 + "/" + "zls04190.exe";
             |HAZ CopiaFicheroIP;
         |SINO;
             eaFOrigen  = aModelos + "zpr04190.exe";
             eaFDestino = "/MODELOS/190/" + #eosy0009#39 + "/" + "zpr04190.exe";
             |HAZ CopiaFicheroIP;
         |FINSI;
     |FINSI;

     |SI #eosy0009#39 = 2005;
         |SI nTecla = 1;
             eaFOrigen  = aModelos + "zls05190.exe";
             eaFDestino = "/MODELOS/190/" + #eosy0009#39 + "/" + "zls05190.exe";
             |HAZ CopiaFicheroIP;
         |SINO;
             eaFOrigen  = aModelos + "zpr05190.exe";
             eaFDestino = "/MODELOS/190/" + #eosy0009#39 + "/" + "zpr05190.exe";
             |HAZ CopiaFicheroIP;
         |FINSI;
     |FINSI;

     aAlfa = eaUnidad + "\MODELOS\190\" + #eosy0009#39 + "\IMPRIME";

     |RSYSTEM aAlfa;

     |SI nTecla = 1;
         eaFichError  = "rcc";
         eaFichDatos  = "rca";
         eaFichAuxil  = "rcb";
         enValidacion = 0;

         |HAZ BuscaErroresL;
     |SINO;
         |HAZ Internet2004;
     |FINSI;
|FPRC;

|PROCESO Bloque2011;
     enAnyo     = #eosy0009#39;
     eaModelos  = "190";
     eaEjer     = #eosy0009#39;

     |SI #eosy0009#39 ] 2004;
         |SI #eosy0009#39 = 2004;  |HAZ Botones2004;  |FINSI;
         |SI #eosy0009#39 = 2005;  |HAZ Botones2004;  |FINSI;
         |SI #eosy0009#39 ] 2006;  |HAZ Botones2006;  |FINSI;
         |SI nTecla = 0;  |ACABA;  |FINSI;

         |SI nTecla = 1;
             aTercera = "N";
             aAlfa    = "0000NDesea la impresion de la tercera copia  ";
             |CONFI aAlfa;
             |SI FSalida = 0;  aTercera = "S";  |FINSI;
         |FINSI;

         |SI #eosy0009#39 ] 2004;
             aAlfa = "/MODELOS";                            |RMKDIR aAlfa;
             aAlfa = "/MODELOS/" + aTipoSec;                |RMKDIR aAlfa;
             aAlfa = "/MODELOS/" + aTipoSec + "/" + #eosy0009#39;  |RMKDIR aAlfa;

             |SI #eosy0009#39 [ 2005;
                 |HAZ AbreImprime190;
             |FINSI;
         |FINSI;

         |HAZ Laser;

         |SI #eosy0009#39 [ 2005;
             |HAZ EmiteEsto190;
         |SINO;
             |SI eaTipoV ! "S";
                 eaFichError  = "rcc";
                 eaFichDatos  = "rca";
                 eaFichAuxil  = "rcb";
                 enValidacion = 0;

                 |HAZ BuscaErroresL;
             |SINO;
                 |HAZ Internet2004;
             |FINSI;
         |FINSI;

         |ACABA;
     |FINSI;

     Sw = 0;
     |SI enAnyo ] 2001; |Y #eosy0009#41 = "PESETAS";
        aAlfa = "2,8,0"; |MENUITEM 0,aAlfa;
        Sw = 1;
     |FINSI;

     |CUADRO 0501 2380;
     |BLANCO 0602 2279;
     |PARA; |SI; |HACIENDO;
            INEmpresas = NEmpresas1 <-;
            |PARA XPara = 1; |SI XPara [ 700; |HACIENDO XPara = XPara + 1;
                  NEmpresas = "";
                  INEmpresas = INEmpresas + 1;
            |SIGUE;
            NACopiar   = 0;

            |HAZ QueVersion;
            |SI enSwDirecta = 1;
                aMenu8 = "Ver Errores";
            |FINSI;

            |SI #eosy0009#39 ] 2003;  aMenu7 = "";  |FINSI;

            |MENUG aMenu;
            aMenu2 = FSalida;

            |SI enSwDirecta = 1;
                |SI aMenu2 < "1";  |O aMenu2 > "5";  |SAL;  |FINSI;
            |SINO;
                |SI aMenu2 < "1";  |O aMenu2 > "4";  |SAL;  |FINSI;
            |FINSI;

            |SI aMenu2 = "1";  |HAZ MenuCol; |FINSI;
            |SI aMenu2 = "2";  |HAZ MenuInd; |FINSI;
            |SI aMenu2 = "3";  |HAZ Laser;   aMenu2 = "5"; |FINSI;
            |SI aMenu2 = "4";  |HAZ MenuPap;     |FINSI;
            |SI aMenu2 = "5";  |HAZ Errores190;  |FINSI;
     |SIGUE;
     |SI Sw = 1; aAlfa = "2,8,0"; |MENUITEM 0,aAlfa; |FINSI;
|FPRC;

|PROCESO GeneraFicheros2012;
     #eosclien#0 = #eosm0030#0;
     |LEE 040#eosclien.=;
     |SI FSalida ! 0;  |DDEFECTO #eosclien;  |FINSI;

     #eoshacie#0 = #eosclien#18; #eoshacie#1 = #eosclien#19;
     |LEE 040#eoshacie.=;
     |SI FSalida ! 0; |DDEFECTO #eoshacie; |FINSI;

     #eosdaban#0 = #eosclien#0;
     |LEE 040#eosdaban.=;
     |SI FSalida ! 0; |DDEFECTO #eosdaban; |FINSI;

     |DDEFECTO #eosw0077;
     #eosw0077#0  = #eoshacie#2;
     #eosw0077#1  = #eoshacie#3;
     #eosw0077#2  = #eoshacie#0;
     #eosw0077#3  = #eoshacie#1;
     #eosw0077#4  = #eosm0030#1;
     #eosw0077#5  = "X";
     #eosw0077#6  = " ";
     #eosw0077#7  = " ";
     #eosw0077#8  = " ";
     #eosw0077#9  = #eosclien#1;
     #eosw0077#10 = #eosclien#14;
     #eosw0077#11 = #eosclien#2;
     #eosw0077#12 = #eosclien#4;
     aAlfa  = #eosclien#5;  |HAZ QuitaComasy0009;
     #eosw0077#13 = aAlfa;
     nNume  = #eosclien#6;
     #eosw0077#14 = ("00000" + nNume) % -105;
     #eosw0077#50 = #eosclien#7;
     #eosw0077#51 = #eosclien#8;
     #eosw0077#52 = #eosclien#9;
     aAlfa  = #eosclien#13;  |HAZ QuitaComasy0009;
     #eosw0077#15 = aAlfa;
     #eosw0077#16 = #eosclien#12;
     #eosw0077#17 = #eosclien#10;
     #eosw0077#18 = #eosclien#11;

     |SI #eosm0030#3 = "C";  #eosw0077#19 = "C";  |FINSI;
     |SI #eosm0030#3 = "S";  #eosw0077#20 = "S";  |FINSI;

     #eosw0077#21 = #eosm0030#4;
     #eosw0077#22 = #eosm0030#5;
     #eosw0077#23 = #eosm0030#6;
     #eosw0077#24 = #eosm0030#7;
     #eosw0077#25 = #eosm0030#8;
     #eosw0077#26 = #eosm0030#9;
     #eosw0077#27 = #eosm0030#10;
     #eosw0077#28 = #eosm0030#11;
     #eosw0077#29 = #eosm0030#12;
     #eosw0077#30 = #eosm0030#13;
     #eosw0077#46 = #eosm0030#17;
     #eosw0077#47 = #eosm0030#18;

     aDComple = " ";
     aHComple = "z";
     |SI #eosm0030#3 = "C";
         aDComple = "S";
         aHComple = "S";
     |FINSI;

     nSwLectura = 1;
     |BUCLE eosm0034;

     eaFicheroPlano = eaModelos + (("00000" + #eosm0030#0) % -105) + ".txt";
     eaFicheroImpre = eaModelos + (("00000" + #eosm0030#0) % -105) + ".imp";
     eaFicheroSalid = eaModelos + (("00000" + #eosm0030#0) % -105) + ".sal";
     eaFicheroError = "err" + (("00000" + #eosm0030#0) % -105) + ".txt";

     aAbre = eaPathEmision + eaFicheroPlano;
     |XABRE "BW", aAbre, nHandle2;

     aTipoP = "T";
     |HAZ Tipo1_2009;

     enSinActividad = 1;
     nSwLectura = 2;  |BUCLE eosm0034;

     |XCIERRA nHandle2;

     enEmpresa    = #eosm0030#0;
     eaNomEmpresa = #eosclien#2;

     |HAZ PresentaPortal;
|FPRC;

|PROCESO eosm0014_2012;
     #eosm0030#0 = #eosm0014#1;
     #eosm0030#1 = #eosy0009#39;
     |LEE 040#eosm0030.=;
     |SI FSalida = 0;
         |HAZ GeneraFicheros2012;
     |FINSI;
|FPRC;

|DEFBUCLE eosm0014_2012;
     #eosm0014#1;
     ;
     #eosy0009#38, 00000;
     #eosy0009#38, 99999;
     ;
     NULL, eosm0014_2012;
|FIN;

|DEFBUCLE eosm0030_2012;
     #eosm0030#1;
     ;
     #eosy0009#0, #eosy0009#39;
     #eosy0009#1, #eosy0009#39;
     ;
     NULL, GeneraFicheros2012;
|FIN;

|PROCESO Bloque2012;
     enAnyo     = #eosy0009#39;
     eaModelos  = "190";
     eaEjer     = #eosy0009#39;

     eaPathLanza = eaUnidad + "\MODELOS";            |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\" + eaModelos;    |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\" + eaEjer;       |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\";

     |DBASE eaPathEmision;
     eaPathEmision = eaPathEmision + "emisiones";       |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + eaModelos;   |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + eaEjer;      |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/";

     eaPathInternet = eaUnidad + "/AEAT";                |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/INTERNET";      |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + eaModelos;  |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + eaEjer;     |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/";

     |HAZ Botones_2012;

     |SI eaOpcion = "0";  |ACABA;  |FINSI;

     nTecla = 1;

     nSwSecuen = 0;
     |SI #eosy0009#0 = 0;
         |SI #eosy0009#38 = 0;
             |PARA nCampoD = Campo + 1;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
                   |SI #eosy0009#nCampoD# ! 0;
                       #eosm0030#0 = #eosy0009#nCampoD#;
                       #eosm0030#1 = #eosy0009#39;
                       |LEE 040#eosm0030.=;
                       |SI FSalida = 0;  |HAZ GeneraFicheros2012;  |FINSI;
                   |FINSI;
             |SIGUE;
         |SINO;
             |BUCLE eosm0014_2012;
         |FINSI;
     |SINO;
         |CIERRAT #eosm0030;
         |BUCLE eosm0030_2012;
         |ABRET #eosm0030;
     |FINSI;

     |SI eaOpcion = "3";
         |HAZ SacaErrorPtl;

         |SI enPresentar = 0;
             aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
             |MENAV aAlfa;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Bloque2015;
     enAnyo     = #eosy0009#39;
     eaModelos  = "190";
     eaEjer     = #eosy0009#39;

     eaPathLanza = eaUnidad + "\MODELOS";            |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\" + eaModelos;    |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\" + eaEjer;       |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\";

     |DBASE eaPathEmision;
     eaPathEmision = eaPathEmision + "emisiones";       |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + eaModelos;   |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + eaEjer;      |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/";

     eaPathInternet = eaUnidad + "/AEAT";                |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/INTERNET";      |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + eaModelos;  |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + eaEjer;     |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/";

     |HAZ Botones_2015;

     |SI eaOpcion = "0";  |ACABA;  |FINSI;

     nTecla = 1;

     nSwSecuen = 0;
     |SI #eosy0009#0 = 0;
         |SI #eosy0009#38 = 0;
             |PARA nCampoD = Campo + 1;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
                   |SI #eosy0009#nCampoD# ! 0;
                       #eosm0030#0 = #eosy0009#nCampoD#;
                       #eosm0030#1 = #eosy0009#39;
                       |LEE 040#eosm0030.=;
                       |SI FSalida = 0;  |HAZ GeneraFicheros2012;  |FINSI;
                   |FINSI;
             |SIGUE;
         |SINO;
             |BUCLE eosm0014_2012;
         |FINSI;
     |SINO;
         |CIERRAT #eosm0030;
         |BUCLE eosm0030_2012;
         |ABRET #eosm0030;
     |FINSI;

     |SI eaOpcion = "3";
         |SI enPresentar = 0;
             aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
             |MENAV aAlfa;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Procede;
     |SI #eosy0009#39 [ 2011;  |HAZ Bloque2011;  |ACABA;  |FINSI;
     |SI #eosy0009#39 [ 2014;  |HAZ Bloque2012;  |ACABA;  |FINSI;
     |SI #eosy0009#39 = 2015;  |HAZ Bloque2015;  |ACABA;  |FINSI;
     |SI #eosy0009#39 = 2016;  |HAZ Bloque2016;  |ACABA;  |FINSI;
     |SI #eosy0009#39 = 2017;  |HAZ Bloque2017;  |ACABA;  |FINSI;
     |SI #eosy0009#39 ] 2018;  |HAZ Bloque2017;  |ACABA;  |FINSI;
|FPRC;

|PROGRAMA;
     |HAZ LeeUnidad;

     aFichero = ("77" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #eosw0077#aFichero#;
     |ABRET #eosw0077;
     #eosw0077#48 = 0;
     |LEE 101#eosw0077.=;
     |SI FSalida = 0;
         #eosw0077#31 = 0;
         #eosw0077#32 = 0;
         #eosw0077#33 = 0;
         #eosw0077#34 = 0;
         #eosw0077#35 = 0;
         |GRABA 020#eosw0077.a;
     |FINSI;
     |LIBERA #eosw0077;

     |ABRET #eosclien;
     |ABRET #eosdaban;
     |ABRET #eoshacie;
     |ABRET #eosm0030;

     aTipoSec = "190";
     |SI enEmpresa = 0;
         |CLS;
         |CABEZA "      Emision Modelo 190";
         |PINPA #0#eosy0009;
         |PINDA #0#eosy0009;
         |ENDATOS #1#eosy0009;
         |SI FSalida = 0;  |HAZ Procede;  |FINSI;
     |SINO;
         |PINPA #0#eosy0009;
         #eosy0009#0  = enEmpresa;
         #eosy0009#1  = enEmpresa;
         #eosy0009#38 = 0;           |C_M #eosy0009#38, 1, "N";
         #eosy0009#39 = enEjercic;   |C_M #eosy0009#39, 1, "N";

         |PINDA #0#eosy0009;

         |PTEC 802;
         |PTEC 802;
         |ENDATOS #1#eosy0009;
         |SI FSalida = 0;  |HAZ Procede;  |FINSI;
     |FINSI;

     |CIERRAT #eosclien;
     |CIERRAT #eosdaban;
     |CIERRAT #eoshacie;
     |CIERRAT #eosm0030;
     |CIERRAT #eosw0077;
|FPRO;

|PROCESO T80Fy9;  |TIPO 80;
     |ABRE #eosaplic;
     |LEE 040#eosaplic.p;
     |SI FSalida ! 0; |DDEFECTO #eosaplic; |FINSI;
     |CIERRA #eosaplic;

     |SI #eosaplic#11 = 1; |ACABA; |FINSI;

     |ABRE #agicontr;
     |LEE 040#agicontr.p;
     |SI FSalida ! 0; |CIERRA #agicontr; |ACABA; |FINSI;
     |CIERRA #agicontr;

     aPathFich = #agicontr#8; |QBF aPathFich;
     |SI aPathFich = "*";  |ACABA;  |FINSI;
     aPathPan = (aPathFich - "fich/") + "pan/";

     |PATH_DAT #eosclipr#aPathFich#;
     |PATH_PAN #eosclipr#aPathPan#;
|FPRC;
