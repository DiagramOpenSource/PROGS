|FICHEROS;
     eosem310 #0;
     eosclien #2;
     eoshacie #3;
     eosdaban #4;
     eosm0019 #5;
     eosm0050 #50;
     iaepigra #6;

     eosw0062 #99;
     eosw0071 #100;
     eosw0545 #545;
     eosw0546 #546;
     dsmow569 #569;

     eosw0601 #601,MANTE;
|FIN;

|VARIABLES;
     Campos      = 0;
     LLeno40     = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     Vacio40     = "                                        ";
     DEmpre      = 0;
     HEmpre      = 0;

     nNeg = 0;
     nCalc       = 0;
     nEpig1      = 0;
     nEpig2      = 0;
     nCuota      = 0;

     aDirOri    = "";
     aDirDes    = "";
     aOrigen    = "";
     aDestino   = "";

     aAlfa        = "";
     aCadena      = "";
     aLong        = "";
     aCaracter    = "";
     nLong        = 0;
     nPos         = 0;
     nCont        = 0;

     sw_sigue    = 0;
     x           = 0;

     CantiNum    = 0;
     CantiAlfa   = "";
     Campo1      = 0;
     Campo2      = 0;
     Campo3      = 0;
     Campo4      = 0;
     Posi        = 0;
     PosiN       = 0;
     nCanti1     = 0;
     nCanti2     = 0;
     nCanti3     = 0;
     nCanti4     = 0;

     &EURODB    = 0;

     {-1}aMoneda   = "";
         aMoneda1  = "LEER";
         aMoneda2  = "";

     &dia        = "";
     &mes        = "";
     &anyo       = "";

     Calc     = 0;
     Calc1    = 0;
     Calc2    = 0;
     TipoDato = "";
     Long     = 0;
     LongDec  = 0;
     Comodin  = "";
     Comodin1 = "";
     Comodin2 = "";
     Vacio1   = "";
     Vacio2   = "";

{5}nAgricola = 0;
{5}nNormal   = 0;

     aAbre        = "";
     aModelos     = "";

     nHandle1     = 0;
     nHandle2     = 0;
     nAnyo2D      = 0;
     nSwHay       = 0;
     nTCampo      = 0;
     nGraba       = 0;

     fFecha       = @;

     aAlfa1       = "";
     aUnidad      = "";

  {1}aContiene    = "";

     &eaFOrigen   = "";
     &eaFDestino  = "";
     &eaInternet  = "";
     &eaImpresora = "";
     &enNume      = 0;
     &eaAlfa      = "";
     &eaDiaB      = "";
     &eaMesB      = "";
     &eaAnyoB     = "";
     &eaModelos   = "";

     &eaEjer             = "";
     &eaPathEmision      = "";
     &eaPathLanza        = "";
     &eaPathExplorador   = "";
     &eaPathInternet     = "";
     &eaFicheroPlano     = "";
     &eaFicheroSalid     = "";
     &eaFicheroImpre     = "";
     &eaFicheroError     = "";
     &eaOpcion           = "";
     &enEmpresa          = 0;
     &eaNomEmpresa       = "";
     &enPresentar        = 0;
     &enErrorPortal      = 0;
     &enTecla            = 0;
     &enPeriodo          = 0;
     &eaPeriodo          = "";
     nTecla              = 0;
     perialf             = "";
|FIN;

|INCLUYE i_seguim;
|INCLUYE i_cuadre;
|INCLUYE i_anyode;
|INCLUYE i_consul;
|INCLUYE i_laserc;

|PROCESO Mayus; |TIPO 0;
  #0Campo = #0Campo > #0Campo;
  |PINTA #0Campo;

  |SI #0#32 = "L"; |Y #0#2 [ 1997;
      #0#32 = "O";  |PINTA #0#32;
  |FINSI;
|FPRC;

|PROCESO FPago; |TIPO 0;
 |SI FSalida = 2; |ACABA; |FINSI;

 |SI #0#32 ! "F";
     |SI #0#35 = "A";
         |MENAV "    Opcion valida solo para Fichero / Internet. ";
         |ERROR;
     |FINSI;
 |FINSI;
|FPRC;

|PROCESO Parrilla; |TIPO 0;
  |SI #0#7 = "S";
      |PARA Campos = 8; |SI Campos [ 31; |HACIENDO Campos = Campos + 1;
            |C_M #0Campos, 1, "N";  #0Campos = 0;  |PINTA #0Campos;
      |SIGUE;
      |C_M #0#0, 1, "S";   |C_M #0#1, 1, "S";  |C_M #0#33, 1, "S";
  |SINO;
      |PARA Campos = 8; |SI Campos [ 31; |HACIENDO Campos = Campos + 1;
            |C_M #0Campos, 1, "S";
      |SIGUE;
      |C_M #0#0,  1, "N"; #0#0 = 1;     |PINTA #0#0;
      |C_M #0#1,  1, "N"; #0#1 = 99999; |PINTA #0#1;
      |C_M #0#33, 1, "N"; #0#33 = "C";  |PINTA #0#33;
  |FINSI;
|FPRC;

|PROCESO pinta_anyo; |TIPO 7;
     fFecha = ~;
     aAlfa  = fFecha % -104;
     #0#2   = aAlfa;
     |PINTA #0#2;
|FPRC;

|| ************************************************
|| PROCESOS IMPRESION MODELO A¤O 1998 Y POSTERIORES
|| ************************************************

|PROCESO Valor;
     eaMoneda = #0#34;
     enCanti  = CantiNum;
     |HAZ ConverMoneda;
     CantiNum = enCanti;

     |SI CantiNum ] 0;
         CantiAlfa = CantiNum;
         CantiAlfa = ("000000000000" + CantiAlfa) % -112;
     |SINO;
         CantiNum  = -CantiNum;
         CantiAlfa = CantiNum;
         CantiAlfa = "N" + (("00000000000" + CantiAlfa) % -111);
     |FINSI;
|FPRC;

|PROCESO ValorSin;
     |SI CantiNum ] 0;
         CantiAlfa = CantiNum;
         CantiAlfa = ("000000000000" + CantiAlfa) % -112;
     |SINO;
         CantiNum  = -CantiNum;
         CantiAlfa = CantiNum;
         CantiAlfa = "N" + (("00000000000" + CantiAlfa) % -111);
     |FINSI;
|FPRC;

|PROCESO NoAgri99;
  Campo2 = Campo1 + 1;
  Campo3 = Campo1 + 2;
  Campo4 = Campo1 + 3;

  #6#0 = #5Campo1;
  #6#1 = #5Campo2;
  |LEE 040#6=;
  |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;

  |SI #99#29 = "000000000000";  Posi = 28;  PosiN = 71;  |FINSI;
  |SI #99#27 = "000000000000";  Posi = 26;  PosiN = 70;  |FINSI;
  |SI #99#25 = "000000000000";  Posi = 24;  PosiN = 69;  |FINSI;
  |SI #99#23 = "000000000000";  Posi = 22;  PosiN = 68;  |FINSI;
  |SI #99#21 = "000000000000";  Posi = 20;  PosiN = 67;  |FINSI;

  CantiNum = #5Campo4;   |HAZ Valor;

                     #99Posi  = #5Campo2;
  Posi = Posi + 1;   #99Posi  = CantiAlfa;
                     #99PosiN = #5Campo4;
|FPRC;

|PROCESO SiAgri99;
  Campo2 = Campo1 + 1;
  Campo3 = Campo1 + 2;
  Campo4 = Campo1 + 3;

  #6#0 = #5Campo1;
  #6#1 = #5Campo2;
  |LEE 040#6=;
  |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;

  |SI #99#37 = "000000000000";  Posi = 36;  PosiN = 75;  |FINSI;
  |SI #99#35 = "000000000000";  Posi = 34;  PosiN = 74;  |FINSI;
  |SI #99#33 = "000000000000";  Posi = 32;  PosiN = 73;  |FINSI;
  |SI #99#31 = "000000000000";  Posi = 30;  PosiN = 72;  |FINSI;

  CantiNum = #5Campo4;   |HAZ Valor;

                     #99Posi  = #6#2;
  Posi = Posi + 1 ;  #99Posi  = CantiAlfa;
                     #99PosiN = #5Campo4;
|FPRC;

|PROCESO CargaTrab99;
  |DDEFECTO #99;

                                                               || -01-
  #99#1  = "310";
                                                               || -02-
  #99#2  = "01";
                                                               || -03-
  #99#3  = " ";
                                                               || -04-
  #99#4  = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);
                                                               || -05-
  Valfa  = #2#1; |QBF Valfa;
  #99#5  = ("000000000" + Valfa) % -109;
                                                               || -06-
  #99#6  = #2#2;
                                                               || -08-
  #99#8  = #2#4;
                                                               || -09-
  #99#9  = #2#5;
                                                               || -10-
  #99#10 = #2#6;
                                                               || -11-
  #99#11 = #2#7;
                                                               || -12-
  #99#12 = #2#8;
                                                               || -13-
  #99#13 = #2#9;
                                                               || -14-
  #99#14 = (("00" + #2#10) % -102) + (("000" + #2#11) % -103);
                                                               || -15-
  #99#15 = #2#13;
                                                               || -16-
  #99#16 = #2#12;
                                                               || -17-
  #99#17 = #2#14;
                                                               || -18-
  #99#18 = #0#2;

  |SI #0#2 [ 1998;
       #99#18 = #0#2 % -102;
  |FINSI;
                                                               || -19-
  #99#19 = #0#4;
                                                               || -20- al -37-
  |SI #5#8  = "N";  |Y #5#9  ! 0;  Campo1 = 6;   |HAZ NoAgri99;  |FINSI;
  |SI #5#8  = "S";  |Y #5#9  ! 0;  Campo1 = 6;   |HAZ SiAgri99;  |FINSI;
  |SI #5#13 = "N";  |Y #5#14 ! 0;  Campo1 = 11;  |HAZ NoAgri99;  |FINSI;
  |SI #5#13 = "S";  |Y #5#14 ! 0;  Campo1 = 11;  |HAZ SiAgri99;  |FINSI;
  |SI #5#18 = "N";  |Y #5#19 ! 0;  Campo1 = 16;  |HAZ NoAgri99;  |FINSI;
  |SI #5#18 = "S";  |Y #5#19 ! 0;  Campo1 = 16;  |HAZ SiAgri99;  |FINSI;
  |SI #5#23 = "N";  |Y #5#24 ! 0;  Campo1 = 21;  |HAZ NoAgri99;  |FINSI;
  |SI #5#23 = "S";  |Y #5#24 ! 0;  Campo1 = 21;  |HAZ SiAgri99;  |FINSI;
  |SI #5#28 = "N";  |Y #5#29 ! 0;  Campo1 = 26;  |HAZ NoAgri99;  |FINSI;
  |SI #5#28 = "S";  |Y #5#29 ! 0;  Campo1 = 26;  |HAZ SiAgri99;  |FINSI;

                                                               || -38-
  CantiNum = #5#30;   |HAZ Valor;
  #99#38 = CantiAlfa;
  #99#76 = #5#30;
                                                               || -39-
  CantiNum = #5#31;   |HAZ Valor;
  #99#39 = CantiAlfa;
  #99#77 = #5#31;
                                                               || -40-
  CantiNum = #5#32;   |HAZ Valor;
  #99#40 = CantiAlfa;
  #99#78 = #5#32;
                                                               || -41-
  CantiNum = #5#33;   |HAZ Valor;
  #99#41 = CantiAlfa;
  #99#79 = #5#33;
                                                               || -42-
  CantiNum = #5#34;   |HAZ Valor;
  #99#42 = CantiAlfa;
  #99#80 = #5#34;
                                                               || -43-
  CantiNum = #5#35;   |HAZ Valor;
  #99#43 = CantiAlfa;
  #99#81 = #5#35;
                                                               || -44-
  CantiNum = #5#36;   |HAZ Valor;
  #99#44 = CantiAlfa;
  #99#82 = #5#36;
                                                               || -45-
  CantiNum = #5#37;   |HAZ Valor;
  #99#45 = CantiAlfa;
  #99#83 = #5#37;
                                                               || -46-
  CantiNum = #5#38;   |HAZ Valor;
  #99#46 = CantiAlfa;
  #99#84 = #5#38;
                                                               || -47-
  CantiNum = #5#39;   |HAZ Valor;
  #99#47 = CantiAlfa;
  #99#85 = #5#39;
                                                               || -48-
  CantiNum = #5#41;   |HAZ Valor;
  #99#48 = CantiAlfa;
  #99#86 = #5#41;
                                                               || -49-
  |SI #5#30 = 0;  |Y #5#44 = 0; |Y #5#46 = 0;
      #99#49 = "X";
  |FINSI;
                                                               || -50-
  CantiNum = #5#40;   |HAZ Valor;
  #99#50 = CantiAlfa;
  #99#87 = #5#40;
                                                               || -53-
  #99#53 = #4#2;
                                                               || -54-
  #99#54 = #4#3;
                                                               || -55-
  #99#55 = #4#4;
                                                               || -56-
  #99#56 = #4#5;
                                                               || -62-
  #99#62 = #2#13;
                                                               || -63-
  #99#63 = dia;
                                                               || -64-
  #99#64 = mes;
                                                               || -65-
  |SI #0#32 = "L";
     |SI #0#2 [ 1998;
        anyo = anyo % -101;
     |FINSI;
  |FINSI;

  #99#65 = anyo;
                                                               || -66-
  #99#66 = &13 + &10;
|FPRC;

|PROCESO NoAgri100;
  Campo2 = Campo1 + 1;
  Campo3 = Campo1 + 2;
  Campo4 = Campo1 + 3;

  #6#0 = #5Campo1;
  #6#1 = #5Campo2;
  |LEE 040#6=;
  |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;

  |SI #100#28 = "000000000000";  Posi = 27;  PosiN = 74;  |FINSI;
  |SI #100#26 = "000000000000";  Posi = 25;  PosiN = 73;  |FINSI;
  |SI #100#24 = "000000000000";  Posi = 23;  PosiN = 72;  |FINSI;
  |SI #100#22 = "000000000000";  Posi = 21;  PosiN = 71;  |FINSI;
  |SI #100#20 = "000000000000";  Posi = 19;  PosiN = 70;  |FINSI;

  CantiNum = #5Campo4;   |HAZ Valor;

                     #100Posi  = #5Campo2;
  Posi = Posi + 1;   #100Posi  = CantiAlfa;
                     #100PosiN = #5Campo4;
|FPRC;

|PROCESO SiAgri100;
  Campo2 = Campo1 + 1;
  Campo3 = Campo1 + 2;
  Campo4 = Campo1 + 3;

  #6#0 = #5Campo1;
  #6#1 = #5Campo2;
  |LEE 040#6=;
  |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;

  |SI #100#36 = "000000000000";  Posi = 35;  PosiN = 78;  |FINSI;
  |SI #100#34 = "000000000000";  Posi = 33;  PosiN = 77;  |FINSI;
  |SI #100#32 = "000000000000";  Posi = 31;  PosiN = 76;  |FINSI;
  |SI #100#30 = "000000000000";  Posi = 29;  PosiN = 75;  |FINSI;

  CantiNum = #5Campo4;   |HAZ Valor;

                     #100Posi  = #6#2;
  Posi = Posi + 1 ;  #100Posi  = CantiAlfa;
                     #100PosiN = #5Campo4;
|FPRC;

|PROCESO CargaTrab100;
  |DDEFECTO #100;

  |SI #0#34 = "EUROS  ";                                                             || -01-
     #100#1  = "374";
  |SINO;
     #100#1  = "311";
  |FINSI;
                                                               || -02-
  #100#2  = "01";
                                                               || -03-
  #100#3  = " ";
                                                               || -04-
  #100#4  = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);
                                                               || -05-
  Valfa  = #2#1; |QBF Valfa;
  #100#5  = ("000000000" + Valfa) % -109;
                                                               || -06-
  #100#6  = #2#2;
                                                               || -08-
  #100#8  = #2#4;
                                                               || -09-
  #100#9  = #2#5;
                                                               || -10-
  #100#10 = #2#6;
                                                               || -11-
  #100#11 = #2#7;
                                                               || -12-
  #100#12 = #2#8;
                                                               || -13-
  #100#13 = #2#9;
                                                               || -14-
  #100#14 = (("00" + #2#10) % -102) + (("000" + #2#11) % -103);
                                                               || -15-
  #100#15 = #2#13;
                                                               || -16-
  #100#16 = #2#12;
                                                               || -17-
  #100#17 = #2#14;
                                                               || -18-
  #100#18 = #0#2;
                                                               || -19- al -36-
  |SI #5#8  = "N";  |Y #5#9  ! 0;  Campo1 = 6;   |HAZ NoAgri100;  |FINSI;
  |SI #5#8  = "S";  |Y #5#9  ! 0;  Campo1 = 6;   |HAZ SiAgri100;  |FINSI;
  |SI #5#13 = "N";  |Y #5#14 ! 0;  Campo1 = 11;  |HAZ NoAgri100;  |FINSI;
  |SI #5#13 = "S";  |Y #5#14 ! 0;  Campo1 = 11;  |HAZ SiAgri100;  |FINSI;
  |SI #5#18 = "N";  |Y #5#19 ! 0;  Campo1 = 16;  |HAZ NoAgri100;  |FINSI;
  |SI #5#18 = "S";  |Y #5#19 ! 0;  Campo1 = 16;  |HAZ SiAgri100;  |FINSI;
  |SI #5#23 = "N";  |Y #5#24 ! 0;  Campo1 = 21;  |HAZ NoAgri100;  |FINSI;
  |SI #5#23 = "S";  |Y #5#24 ! 0;  Campo1 = 21;  |HAZ SiAgri100;  |FINSI;
  |SI #5#28 = "N";  |Y #5#29 ! 0;  Campo1 = 26;  |HAZ NoAgri100;  |FINSI;
  |SI #5#28 = "S";  |Y #5#29 ! 0;  Campo1 = 26;  |HAZ SiAgri100;  |FINSI;

                                                               || -37-
  CantiNum = #5#30;   |HAZ Valor;
  #100#37  = CantiAlfa;
  #100#79  = #5#30;
                                                               || -38-
  CantiNum = #5#43;   |HAZ Valor;
  #100#38  = CantiAlfa;
  #100#80  = #5#43;
                                                               || -39-
  CantiNum = #5#44;   |HAZ Valor;
  #100#39  = CantiAlfa;
  #100#81  = #5#44;
                                                               || -40-
  CantiNum = #5#31;   |HAZ Valor;
  #100#40  = CantiAlfa;
  #100#82  = #5#31;
                                                               || -41-
  CantiNum = #5#32;   |HAZ Valor;
  #100#41  = CantiAlfa;
  #100#83  = #5#32;
                                                               || -42-
  CantiNum = #5#33;   |HAZ Valor;
  #100#42  = CantiAlfa;
  #100#84  = #5#33;
                                                               || -43-
  CantiNum = #5#34;   |HAZ Valor;
  #100#43  = CantiAlfa;
  #100#85  = #5#34;
                                                               || -44-
  CantiNum = #5#35;   |HAZ Valor;
  #100#44  = CantiAlfa;
  #100#86  = #5#35;
                                                               || -45-
  CantiNum = #5#45;   |HAZ Valor;
  #100#45  = CantiAlfa;
  #100#87  = #5#45;
                                                               || -46-
  CantiNum = #5#46;   |HAZ Valor;
  #100#46  = CantiAlfa;
  #100#88  = #5#46;
                                                               || -47-
  CantiNum = #5#36;   |HAZ Valor;
  #100#47  = CantiAlfa;
  #100#89  = #5#36;
                                                               || -48-
  CantiNum = #5#37;   |HAZ Valor;
  #100#48  = CantiAlfa;
  #100#90  = #5#37;
                                                               || -49-
  CantiNum = #5#38;   |HAZ Valor;
  #100#49  = CantiAlfa;
  #100#91  = #5#38;
                                                               || -50-
  CantiNum = #5#39;   |HAZ Valor;
  #100#50  = CantiAlfa;
  #100#92  = #5#39;
                                                               || -51-
  CantiNum = #5#41;   |HAZ Valor;
  #100#51  = CantiAlfa;
  #100#93  = #5#41;
                                                               || -52-
  |SI #5#30 = 0;  |Y #5#44 = 0; |Y #5#46 = 0;
      #100#52 = "X";
  |FINSI;
                                                               || -53-
  CantiNum = #5#42;   |HAZ Valor;
  #100#53 = CantiAlfa;
  #100#94 = #5#42;

  |SI #5#42 ! 0;
                                                               || -54-
      #100#54 = #4#2;
                                                               || -55-
      #100#55 = #4#3;
                                                               || -56-
      #100#56 = #4#4;
                                                               || -57-
      #100#57 = #4#5;
  |FINSI;
                                                               || -60-
  CantiNum = #5#40;   |HAZ Valor;
  #100#60 = CantiAlfa;
  #100#95 = #5#40;

  |SI #5#40 ! 0;
                                                               || -61-
      #100#61 = #4#2;
                                                               || -62-
      #100#62 = #4#3;
                                                               || -63-
      #100#63 = #4#4;
                                                               || -64-
      #100#64 = #4#5;
  |FINSI;

  #100#65 = #2#13;
                                                               || -63-
  #100#66 = dia;
                                                               || -64-
  #100#67 = mes;
                                                               || -65-
  #100#68 = anyo;
                                                               || -66-
  #100#69 = &13 + &10;
|FPRC;

|| ************************************************************************
||                  IMPRESION EN PAPEL
|| ************************************************************************

|PROCESO Imprime98;
  |SI #0#33 ! "N";
      #2#0 = #5#0;
      |LEE 040#2=;
      |SI FSalida ! 0;    |ACABA; |FINSI;
      |SI #2#60   ! "N";  |ACABA; |FINSI;
  |FINSI;

  #3#0 = #2#18; #3#1 = #2#19;
  |LEE 040#3=;
  |SI FSalida ! 0; |DDEFECTO #3; |FINSI;

  #4#0 = #2#0;
  |LEE 040#4=;
  |SI FSalida ! 0; |DDEFECTO #4; |FINSI;

  |ABRE #6;
  |SI #0#4 ! 4;  |HAZ CargaTrab99;   |FINSI;
  |SI #0#4 = 4;  |HAZ CargaTrab100;  |FINSI;
  |CIERRA #6;

  |PRINT; |PIEINF;

  se_empre = #5#0;
  se_ejerc = #5#1;
  se_perio = #5#2;
  se_tipos = 310;
  se_activ = 10;
  se_impor = 0;
  |SI #5#40 > 0; se_impor =  #5#40 + #5#65; |FINSI;
  |SI #5#41 > 0; se_impor = -#5#41; |FINSI;
  |SI #5#42 > 0; se_impor = -#5#42; |FINSI;
  se_fecha = #0#6;
  se_factu = "N";

  |SI #0#32 ! "B";
      |HAZ seguimie;
      |HAZ AlAgicli;
      #5#3 = #0#6;
      |GRABA 020#5a;
      |LIBERA #5;
  |FINSI;
|FPRC;

|DEFBUCLE eosm0019;
  #5#1;
  4;
  DEmpre, nAnyo2D, #0#4, "N";
  HEmpre, nAnyo2D, #0#4, "N";
  be;
  NULL, Imprime98;
|FIN;

|PROCESO AlModelo98;
  DEmpre = #2#0;
  HEmpre = #2#0;
  |BUCLE eosm0019;
|FPRC;

|DEFBUCLE eosclien98;
  #2#3;
  0, 60;
  Vacio40, #0#0, "N";
  LLeno40, #0#1, "N";
  ;
  NULL, AlModelo98;
|FIN;

|PROCESO Papel;
  |IMPRE 0;
  |SI FSalida ! 0; |ACABA; |FINSI;

  |SI #0#32 = "O";
      |HAZ i_cuadre;
      |SI #0#4 ! 4;  |INFOR "m310h011";  |FINSI;
      |SI #0#4 = 4;  |INFOR "m311h011";  |FINSI;
  |SINO;
      |SI #0#4 ! 4;  |INFOR "m310h012";  |FINSI;
      |SI #0#4 = 4;  |INFOR "m311h012";  |FINSI;
  |FINSI;

  |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;

  |ABRE #3;
  |ABRE #4;

  |SI #0#33 = "N";
      |BUCLE eosclien98;
  |SINO;
      |ABRE #2;
      |SI #0#7 = "S";
          DEmpre = #0#0;
          HEmpre = #0#1;
          |BUCLE eosm0019;
      |SINO;
          |PARA x = 8; |SI x [ 31; |HACIENDO x = x + 1;
                |SI #0x ! 0;
                    DEmpre = #0x;
                    HEmpre = #0x;
                    |BUCLE eosm0019;
                |FINSI;
          |SIGUE;
      |FINSI;
      |CIERRA #2;
  |FINSI;
  |CIERRA #3;
  |CIERRA #4;

  |FININF;
  |FINIMP;
|FPRC;

|PROCESO QuitaComas;
     aCadena = "";
     aLong   = aAlfa % 0;
     nLong   = aLong;
     |PARA nCont = 1;  |SI nCont [ aLong;  |HACIENDO nCont = nCont + 1;
           nPos = (100 * nCont) + 1;
           aCaracter = aAlfa % nPos;
           |SI aCaracter = ",";  aCaracter = " ";  |FINSI;
           |SI aCaracter = "¥";  aCaracter = &209; |FINSI;
           |SI aCaracter = "¤";  aCaracter = &209; |FINSI;
           |SI aCaracter = "§";  aCaracter = &176; |FINSI;
           |SI aCaracter = "¦";  aCaracter = &170; |FINSI;
           aCadena = aCadena + aCaracter;
     |SIGUE;
     aAlfa = aCadena;

     aAlfa = aAlfa > aAlfa;
|FPRC;

|PROCESO Formateo;
   nNeg = 0;
   |SI TipoDato = "N";
      Vacio1 = "0" * Long;
      Vacio2 = "0" * LongDec;
      Comodin = Comodin - "-";
      |SI FSalida ! 0; nNeg = 1; |FINSI;
   |SINO;
      Vacio1 = " " * Long;
   |FINSI;

   |SI LongDec = 0;
      Calc = 0 - (100 + Long);
      Comodin = (Vacio1 + Comodin) % Calc;
   |SINO;
      Comodin = Comodin - ".";
      |SI FSalida = 0;
         Calc = 0 - (100 + Long);
         Comodin = (Vacio1 + Comodin) % Calc;
         Comodin1 = "0" * LongDec;
         Comodin = Comodin + Comodin1;
      |SINO;
         Calc1 = (((FSalida / 100) ! 0) - 1) + 100;
         Calc2 = (((FSalida / 100) ! 0) * 100) + 99;
         Comodin1 = Comodin % Calc2;
         Comodin  = Comodin % Calc1;
         Calc = 0 - (100 + Long);
         Comodin  = (Vacio1 + Comodin)  % Calc;
         Calc = 100 + LongDec;
         Comodin1 = (Comodin1 + Vacio2) % Calc;
         Comodin = Comodin + Comodin1;
      |FINSI;
   |FINSI;
   |SI TipoDato = "N"; |Y nNeg = 1;
      Calc = 0 - (100 + (Long - 1));
      Comodin = "N" + (Comodin % Calc)
   |FINSI;
|FPRC;

|PROCESO Internet2001;
   Cadena = "310E";
   Cadena = Cadena + (#eosclien#1 % 0109);
   Cadena = Cadena + "    ";
   aAlfa  = #0#2;
   Cadena = Cadena + aAlfa;
   Cadena = Cadena + (("00" + #eosem310#4) % -102);

   InAgricola = nAgricola1<-; InNormal = nNormal1<-;
   |PARA nCont = 1; |SI nCont [ 5; |HACIENDO nCont = nCont + 1;
      InAgricola = InAgricola + nCont; nAgricola = 0;
      InNormal   = InNormal   + nCont; nNormal   = 0;
   |SIGUE;
   InAgricola = nAgricola1<-; InNormal = nNormal1<-;
   |PARA nCont = 1; |SI nCont [ 5; |HACIENDO nCont = nCont + 1;
      nCalc = (nCont * 5) + 3; nEpig2 = nCalc - 1;
      |SI #eosm0019#nEpig2# ! "    ";
         |SI #eosm0019#nCalc# = "S";
            nAgricola = nCont; InAgricola = InAgricola + 1;
         |SINO;
            nNormal = nCont; InNormal = InNormal + 1;
         |FINSI;
      |FINSI;
   |SIGUE;
   Long = 15; LongDec = 2; TipoDato = "N";
   |PARA nCont = 1; |SI nCont [ 4; |HACIENDO nCont = nCont + 1;
      InNormal = nNormal1<-; InNormal = InNormal + (nCont - 1);
      |SI nNormal ! 0;
         nEpig1 = (nNormal * 5) + 1; nEpig2 = nEpig1 + 1; nCuota = nEpig1 + 3;
         |SI #eosm0019#nEpig1# = "E";
            Cadena = Cadena + "1";
         |SINO;
            Cadena = Cadena + "2";
         |FINSI;
         Cadena = Cadena + #eosm0019#nEpig2#;
         Comodin = #eosm0019#nCuota#; |HAZ Formateo; Cadena = Cadena + Comodin;
      |SINO;
         Cadena = Cadena + (" " * 5);
         Comodin = 0; |HAZ Formateo; Cadena = Cadena + Comodin;
      |FINSI;
   |SIGUE;
   Cadena = Handle + " " + Cadena; |FGRABA Cadena; Cadena = "";

   |ABRE #iaepigra;
   |PARA nCont = 1; |SI nCont [ 4; |HACIENDO nCont = nCont + 1;
      InAgricola = nAgricola1<-; InAgricola = InAgricola + (nCont - 1);
      |SI nAgricola ! 0;
         nEpig1 = (nAgricola * 5) + 1; nEpig2 = nEpig1 + 1; nCuota = nEpig1 + 3;
         #iaepigra#0 = #eosm0019#nEpig1#;
         #iaepigra#1 = #eosm0019#nEpig2#;
         |LEE 000#iaepigra.=;
         |SI FSalida = 0;
            Cadena = Cadena + #iaepigra#2;
         |SINO;
            Cadena = Cadena + (" " * 40);
         |FINSI;
         Comodin = #eosm0019#nCuota#; |HAZ Formateo; Cadena = Cadena + Comodin;
      |SINO;
         Cadena = Cadena + (" " * 40);
         Comodin = 0; |HAZ Formateo; Cadena = Cadena + Comodin;
      |FINSI;
   |SIGUE;
   |CIERRA #iaepigra;
   Cadena = Handle + " " + Cadena; |FGRABA Cadena; Cadena = "";

   Comodin = #eosm0019#30; |HAZ Formateo; Cadena = Cadena + Comodin; || Suma de ingresos a cuenta
   Comodin = #eosm0019#31; |HAZ Formateo; Cadena = Cadena + Comodin; || Adquisiciones intracomunitarias
   Comodin = #eosm0019#32; |HAZ Formateo; Cadena = Cadena + Comodin; || Entrega de activos fijos
   Comodin = #eosm0019#33; |HAZ Formateo; Cadena = Cadena + Comodin; || IVA devengado por inversion del sujeto pasivo
   Comodin = #eosm0019#34; |HAZ Formateo; Cadena = Cadena + Comodin; || Total cuota resultante
   Comodin = #eosm0019#35; |HAZ Formateo; Cadena = Cadena + Comodin; || Adquisicion de activos fijos
   Comodin = #eosm0019#36; |HAZ Formateo; Cadena = Cadena + Comodin; || Diferencia
   Comodin = #eosm0019#37; |HAZ Formateo; Cadena = Cadena + Comodin; || Cuotas a compensar de periodos anteriores
   Comodin = #eosm0019#38; |HAZ Formateo; Cadena = Cadena + Comodin; || Resultado
   Comodin = #eosm0019#39; |HAZ Formateo; Cadena = Cadena + Comodin; || Entregas intracomunitarias
   Comodin = 0;            |HAZ Formateo; Cadena = Cadena + Comodin; || A deducir (solo complementarias)
   Comodin = #eosm0019#38; |HAZ Formateo; Cadena = Cadena + Comodin; || Resultado de la liquidacion
   Cadena = Handle + " " + Cadena; |FGRABA Cadena; Cadena = "";

   Cadena = " " * 129; Cadena = Handle + " " + Cadena; |FGRABA Cadena; || Codigo electronico + N§ justificante + Persona contacto
   Cadena = " " * 160; Cadena = Handle + " " + Cadena; |FGRABA Cadena; || Telefono de contacto + parte de las observaciones
   Cadena = " " * 200; Cadena = Handle + " " + Cadena; |FGRABA Cadena; || La otra parte de las observaciones
|FPRC;

|PROCESO CargaFichero2001;
  Raiz       = "";  |DIRECTORIO Raiz;
  Directorio = "";
  |DBASE Directorio;
  |SI #0#32 = "F";
     Directorio = Directorio + "hacienda/" + aTipoSec; |MKDIR Directorio;
     |DBASE Directorio; Directorio = Directorio + "hacienda/internet/" + aTipoSec;
  |SINO;
     Directorio = Directorio + "hacienda/" + aTipoSec;
  |FINSI;
  |MKDIR Directorio;
  Directorio = Directorio + "/";
  Valfa = Raiz + "bin/agichmod 777 " + Directorio;

  Empresa  = #5#0;  Empresa  = ("00000" + Empresa) % -105;

  Fichero    = aTipoSec + Empresa; aNombre = Fichero;
  INEmpresas = NEmpresas1 <-;
  INEmpresas = INEmpresas + NACopiar;
  NFichero   = Directorio + Fichero;          |QBF NFichero;
  NEmpresas  = NFichero;
  NACopiar   = NACopiar + 1;

  Fichero  = "wb  "+ NFichero;

  Pos = -1;
  |FABRE Fichero;
  Handle = FSalida;
  |SI FSalida ] 0;
      |SI #0#32 = "L";
         |SI #0#34 = "PESETAS";
            |SI #0#4 ! 4;
                |PARA XPara = 1;  |SI XPara [ 66;  |HACIENDO XPara = XPara + 1;
                   |SI XPara = 6;  |O XPara = 7;  |O XPara = 8; |O XPara = 9;
                   |O XPara = 15; |O XPara = 16; |O XPara = 30; |O XPara = 32;
                   |O XPara = 34; |O XPara = 36; |O XPara = 62;
                       aAlfa = #99XPara; |HAZ QuitaComas; #99XPara = aAlfa;
                   |FINSI;
                   |SI XPara = 18; |O XPara = 65;
                      |SI #0#2 < 1999;
                         aAlfa = #99XPara;
                         |QBF aAlfa;
                         Cadena = Handle + " " + aAlfa;
                      |SINO;
                         Cadena = Handle + " " + #99XPara;
                      |FINSI;
                   |SINO;
                      Cadena = Handle + " " + #99XPara;
                   |FINSI;
                   |FGRABA Cadena;
                |SIGUE;
            |SINO;
                |PARA XPara = 1;  |SI XPara [ 69;  |HACIENDO XPara = XPara + 1;
                   |SI XPara = 6;  |O XPara = 7;  |O XPara = 8; |O XPara = 9;
                   |O XPara = 15; |O XPara = 16; |O XPara = 29; |O XPara = 32;
                   |O XPara = 33; |O XPara = 35; |O XPara = 65;
                       aAlfa = #100XPara; |HAZ QuitaComas; #100XPara = aAlfa;
                   |FINSI;
                   |SI #0#2 = 1998;
                       |SI XPara = 18;
                           Cadena = Handle + " " + (#100XPara % -102);
                       |SINO;
                           |SI XPara = 68;
                               Cadena = Handle + " " + (#100XPara % -101);
                           |SINO;
                               Cadena = Handle + " " + #100XPara;
                           |FINSI;
                       |FINSI;
                   |SINO;
                       Cadena = Handle + " " + #100XPara;
                   |FINSI;
                   |FGRABA Cadena;
                |SIGUE;
            |FINSI;
         |SINO;
            |SI #0#4 ! 4; ||     Modelo 313
                nCanti1 = #99#38;
                aAlfa   = #99#38 % 101;
                |SI aAlfa = "N";  aAlfa = #99#38 % 212;  nCanti1 = -(aAlfa);  |FINSI;

                nCanti2 = #99#39;
                aAlfa   = #99#39 % 101;
                |SI aAlfa = "N";  aAlfa = #99#39 % 212;  nCanti2 = -(aAlfa);  |FINSI;

                nCanti3 = #99#40;
                aAlfa   = #99#40 % 101;
                |SI aAlfa = "N";  aAlfa = #99#40 % 212;  nCanti3 = -(aAlfa);  |FINSI;

                nCanti4 = #99#41;
                aAlfa   = #99#41 % 101;
                |SI aAlfa = "N";  aAlfa = #99#41 % 212;  nCanti4 = -(aAlfa);  |FINSI;

                CantiNum = nCanti1 + nCanti2 + nCanti3 + nCanti4; |HAZ ValorSin;
                #99#42 = CantiAlfa;

                nCanti1 = #99#42;
                aAlfa   = #99#42 % 101;
                |SI aAlfa = "N";  aAlfa = #99#42 % 212;  nCanti1 = -(aAlfa);  |FINSI;

                nCanti2 = #99#43;
                aAlfa   = #99#43 % 101;
                |SI aAlfa = "N";  aAlfa = #99#43 % 212;  nCanti2 = -(aAlfa);  |FINSI;

                CantiNum = nCanti1 - nCanti2; |HAZ ValorSin;
                #99#44 = CantiAlfa;

                nCanti1 = #99#44;
                aAlfa   = #99#44 % 101;
                |SI aAlfa = "N";  aAlfa = #99#44 % 212;  nCanti1 = -(aAlfa);  |FINSI;

                nCanti2 = #99#45;
                aAlfa   = #99#45 % 101;
                |SI aAlfa = "N";  aAlfa = #99#45 % 212;  nCanti2 = -(aAlfa);  |FINSI;

                CantiNum = nCanti1 - nCanti2; |HAZ ValorSin;
                #99#46 = CantiAlfa;

                #99#1 = "313";
                |PARA XPara = 1;  |SI XPara [ 27;  |HACIENDO XPara = XPara + 1;
                   |SI XPara = 6;  |O XPara = 7;  |O XPara = 8; |O XPara = 9;
                    |O XPara = 15; |O XPara = 16;
                       aAlfa = #99XPara; |HAZ QuitaComas; #99XPara = aAlfa;
                   |FINSI;
                   Cadena = Handle + " " + #99XPara; |FGRABA Cadena;
                |SIGUE;
                |PARA XPara = 30;  |SI XPara [ 47;  |HACIENDO XPara = XPara + 1;
                   |SI XPara = 30;  |O XPara = 32; |O XPara = 34; |O XPara = 36;
                       aAlfa = #99XPara; |HAZ QuitaComas; #99XPara = aAlfa;
                   |FINSI;
                   Cadena = Handle + " " + #99XPara; |FGRABA Cadena;
                |SIGUE;
                Cadena = Handle + " " + ("0" * 12); |FGRABA Cadena;
                Cadena = Handle + " " + #99#46;     |FGRABA Cadena;
                Cadena = Handle + " " + #99#48;     |FGRABA Cadena;
                Cadena = Handle + " " + #99#49;     |FGRABA Cadena;
                Cadena = Handle + " " + (" " * 14); |FGRABA Cadena;
                |PARA XPara = 50;  |SI XPara [ 66;  |HACIENDO XPara = XPara + 1;
                   |SI XPara = 62; aAlfa = #99XPara; |HAZ QuitaComas; #99XPara = aAlfa; |FINSI;
                   Cadena = Handle + " " + #99XPara; |FGRABA Cadena;
                |SIGUE;
            |SINO;               || Modelo 374
                |PARA XPara = 1;  |SI XPara [ 69;  |HACIENDO XPara = XPara + 1;
                   |SI XPara = 6;  |O XPara = 7;  |O XPara = 8; |O XPara = 9;
                   |O XPara = 15; |O XPara = 16; |O XPara = 29; |O XPara = 32;
                   |O XPara = 33; |O XPara = 35; |O XPara = 65;
                       aAlfa = #100XPara; |HAZ QuitaComas; #100XPara = aAlfa;
                   |FINSI;
                   |SI #0#2 = 1998;
                       |SI XPara = 18;
                           Cadena = Handle + " " + (#100XPara % -102);
                       |SINO;
                           |SI XPara = 68;
                               Cadena = Handle + " " + (#100XPara % -101);
                           |SINO;
                               Cadena = Handle + " " + #100XPara;
                           |FINSI;
                       |FINSI;
                   |SINO;
                       |SI #0#2 = 2001;
                          |SI XPara = 51;
                             Cadena = Handle + " 000000000000";   |FGRABA Cadena;
                             Cadena = Handle + " " + #100#49;     |FGRABA Cadena;
                          |FINSI;
                          |SI XPara = 65;
                             Cadena = Handle + "               "; |FGRABA Cadena;
                          |FINSI;
                       |FINSI;
                       Cadena = Handle + " " + #100XPara;
                   |FINSI;
                   |FGRABA Cadena;
                |SIGUE;
            |FINSI;
         |FINSI;
      |SINO;
         |HAZ Internet2001;
      |FINSI;
  |FINSI;
  FSalida = Handle; |FCIERRA FSalida;

  |SI #0#32 = "F";
     aAlfa = ""; |IP_REMOTO aAlfa;
     |DBASE aDirOri; |QBF aDirOri;
     aDirOri = aDirOri + "hacienda/internet/" + aTipoSec + "/";
     aDirDes = "/MODELOS";
     |SI aAlfa ! ""; |RMKDIR aDirDes; |SINO; |MKDIR aDirDes; |FINSI;
     aDirDes = "/MODELOS/INTERNET";
     |SI aAlfa ! ""; |RMKDIR aDirDes; |SINO; |MKDIR aDirDes; |FINSI;
     aDirDes = "/MODELOS/INTERNET/" + aTipoSec;
     |SI aAlfa ! ""; |RMKDIR aDirDes; |SINO; |MKDIR aDirDes; |FINSI;
     aDirDes = aDirDes + "/";
     aOrigen = aDirOri + aNombre; aDestino = aDirDes + aNombre;
     |SI aAlfa ! ""; |ENVIA_FICHERO aOrigen, aDestino; |SINO; |COPIA_FICHERO aOrigen, aDestino; |FINSI;
     |MENAV "    Ficheros creados correctamente";
  |FINSI;
|FPRC;

|PROCESO CargaImprime;
     aAlfa = "del err" + (("00000" + #2#0) % -105) + ".TXT" + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "wait mipf32 ";
     aAlfa = aAlfa + "/E:310" + (("00000" + #2#0) % -105) + ".TXT ";
     aAlfa = aAlfa + "/R:err" + (("00000" + #2#0) % -105) + ".TXT ";
     |SI eaImpresora ! "";
         aAlfa = aAlfa + "/I:" + &34 + eaImpresora + &34;
     |FINSI;
     aAlfa = aAlfa + " /C:" + #601#0;
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "DEL " + "310" + (("00000" + #2#0) % -105) + ".TXT ";
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle1, aAlfa;
|FPRC;

|PROCESO TDeclaracion310;
     |SI #5#40 ! 0;
         enNume = #5#40;  |HAZ Conver13;  #545#61 = eaAlfa;

         |SI #0#35 = "S";  |O #0#35 = "D";
             |SI #4#5 = "          ";
                  #545#62 = "X";
             |SINO;
                  #545#63 = "X";
                  #545#64 = #4#2;
                  #545#65 = #4#3;
                  #545#66 = #4#4;
                  #545#67 = #4#5;
             |FINSI;
         |SINO;
             #545#62 = "X";
         |FINSI;
      |SINO;
         enNume  = 0;  |HAZ Conver13;  #545#61 = eaAlfa;
      |FINSI;

      #545#4 = "";
      |SI #0#32 = "L";
          |SI #5#40 = 0;  |Y #5#41 = 0;  |Y #5#42 = 0;  |Y #5#30 = 0;
              #545#4 = "N";
          |FINSI;
      |SINO;
          #545#4 = "";
          |SI #5#40 ! 0;  #545#4 = "I";  |FINSI;
          |SI #5#41 ! 0;  #545#4 = "C";  |FINSI;
          |SI #5#42 ! 0;  #545#4 = "D";  |FINSI;

          |SI #5#40 = 0;  |Y #5#41 = 0;  |Y #5#42 = 0;  |Y #5#30 = 0;
              #545#4 = "N";
          |FINSI;
      |FINSI;
|FPRC;

|PROCESO NoAgri310_2002;
     Campo2 = Campo1 + 1;
     Campo3 = Campo1 + 2;
     Campo4 = Campo1 + 3;

     #6#0 = #5Campo1;
     #6#1 = #5Campo2;
     |LEE 040#6=;
     |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;

     |SI #545#31 = "0000000000000";  Posi = 30;  |FINSI;
     |SI #545#29 = "0000000000000";  Posi = 28;  |FINSI;
     |SI #545#27 = "0000000000000";  Posi = 26;  |FINSI;
     |SI #545#25 = "0000000000000";  Posi = 24;  |FINSI;
     |SI #545#23 = "0000000000000";  Posi = 22;  |FINSI;

     enNume  = #5Campo4;  |HAZ Conver13;

                        #545Posi  = #5Campo2;
     Posi = Posi + 1;   #545Posi  = eaAlfa;
|FPRC;

|PROCESO SiAgri310_2002;
     Campo2 = Campo1 + 1;
     Campo3 = Campo1 + 2;
     Campo4 = Campo1 + 3;

     #6#0 = #5Campo1;
     #6#1 = #5Campo2;
     |LEE 040#6=;
     |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;

     |SI #545#39 = "0000000000000";  Posi = 38;  |FINSI;
     |SI #545#37 = "0000000000000";  Posi = 36;  |FINSI;
     |SI #545#35 = "0000000000000";  Posi = 34;  |FINSI;
     |SI #545#33 = "0000000000000";  Posi = 32;  |FINSI;

     eaAlfa   = #6#2;   |HAZ QuitaRaros;     #545Posi = eaAlfa;

     enNume  = #5Campo4;  |HAZ Conver13;
     Posi = Posi + 1 ;  #545Posi  = eaAlfa;
|FPRC;

|PROCESO Carga310_2002;
     |SI #0#32 = "L";
         aAbre = "\MODELOS\310\" + "310" + (("00000" + #2#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |SI #0#32 = "F";
         aAbre = eaInternet + "310" + (("00000" + #2#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |ABRE #50;
     #50#0 = #2#0;
     |LEE 000#50=;
     |SI FSalida ! 0;  |DDEFECTO #50;  |FINSI;
     |CIERRA #50;

     |DDEFECTO #545;

     #545#1   = "310";
     #545#2   = "01";
     #545#3   = "";

     #545#5   = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);
     aAlfa    = #2#1;  |QBF aAlfa;
     #545#6   = ("000000000" + aAlfa) % -109;
     #545#7   = #50#2;
     eaAlfa   = #2#2;    |HAZ QuitaRaros;     #545#8   = eaAlfa;
     #545#9   = ".";
     eaAlfa   = #2#4;    |HAZ QuitaRaros;     #545#10  = eaAlfa;
     eaAlfa   = #2#5;    |HAZ QuitaRaros;     #545#11  = eaAlfa;
     #545#12  = #2#6;
     #545#13  = #2#7;
     #545#14  = #2#8;
     #545#15  = #2#9;
     #545#16  = (("00" + #2#10) % -102) + (("000" + #2#11) % -103);
     eaAlfa   = #2#13;   |HAZ QuitaRaros;     #545#17  = eaAlfa;
     eaAlfa   = #2#12;   |HAZ QuitaRaros;     #545#18  = eaAlfa;
     eaAlfa   = #2#14;   |HAZ QuitaRarosTfno; #545#19 = eaAlfa;

     #545#20  = #0#2;
     #545#21  = #0#4 + "T";

     |SI #5#8  = "N";  |Y #5#9  ! 0;  Campo1 = 6;   |HAZ NoAgri310_2002;  |FINSI;
     |SI #5#8  = "S";  |Y #5#9  ! 0;  Campo1 = 6;   |HAZ SiAgri310_2002;  |FINSI;
     |SI #5#13 = "N";  |Y #5#14 ! 0;  Campo1 = 11;  |HAZ NoAgri310_2002;  |FINSI;
     |SI #5#13 = "S";  |Y #5#14 ! 0;  Campo1 = 11;  |HAZ SiAgri310_2002;  |FINSI;
     |SI #5#18 = "N";  |Y #5#19 ! 0;  Campo1 = 16;  |HAZ NoAgri310_2002;  |FINSI;
     |SI #5#18 = "S";  |Y #5#19 ! 0;  Campo1 = 16;  |HAZ SiAgri310_2002;  |FINSI;
     |SI #5#23 = "N";  |Y #5#24 ! 0;  Campo1 = 21;  |HAZ NoAgri310_2002;  |FINSI;
     |SI #5#23 = "S";  |Y #5#24 ! 0;  Campo1 = 21;  |HAZ SiAgri310_2002;  |FINSI;
     |SI #5#28 = "N";  |Y #5#29 ! 0;  Campo1 = 26;  |HAZ NoAgri310_2002;  |FINSI;
     |SI #5#28 = "S";  |Y #5#29 ! 0;  Campo1 = 26;  |HAZ SiAgri310_2002;  |FINSI;

     enNume  = #5#30;   |HAZ Conver13;  #545#40 = eaAlfa;
     enNume  = #5#31;   |HAZ Conver13;  #545#41 = eaAlfa;
     enNume  = #5#32;   |HAZ Conver13;  #545#42 = eaAlfa;
     enNume  = #5#33;   |HAZ Conver13;  #545#43 = eaAlfa;
     enNume  = #5#34;   |HAZ Conver13;  #545#44 = eaAlfa;
     enNume  = #5#35;   |HAZ Conver13;  #545#45 = eaAlfa;
     enNume  = #5#36;   |HAZ Conver13;  #545#46 = eaAlfa;
     enNume  = #5#37;   |HAZ Conver13;  #545#47 = eaAlfa;
     |SI #5#62 ! "S";
         enNume  = #5#38;   |HAZ Conver13;  #545#48 = eaAlfa;
     |SINO;
         enNume  = #5#38 + #5#65;   |HAZ Conver13;  #545#48 = eaAlfa;
     |FINSI;
     enNume  = #5#39;   |HAZ Conver13;  #545#49 = eaAlfa;
     enNume  = #5#65;   |HAZ Conver13;  #545#50 = eaAlfa;
     enNume  = #5#38;   |HAZ Conver13;  #545#51 = eaAlfa;
     enNume  = #5#41;   |HAZ Conver13;  #545#52 = eaAlfa;

     |HAZ TDeclaracion310;

     |SI #5#62 = "S";
         #545#53 = #5#64;
         #545#54 = #5#63;
     |FINSI;

     eaAlfa  = #2#2;     |HAZ QuitaRaros;     #545#55  = eaAlfa;
     eaAlfa  = #2#14;    |HAZ QuitaRarosTfno; #545#56  = eaAlfa;

     eaAlfa  = #0#6;     |HAZ FechaBonito;
     eaAlfa  = #2#13;    |HAZ QuitaRaros;     #545#73 = eaAlfa;
     #545#74 = eaDiaB;
     #545#75 = eaMesB;
     #545#76 = eaAnyoB;
     #545#77 = &13 + &10;

     |SI #0#32 = "L";
         #545#7  = "";
         #545#53 = "";
         #545#55 = "";
         #545#56 = "";
         #545#57 = "";
         nTCampo = 77;
     |FINSI;

     |SI #0#32 = "F";
         #545#2  = "";
         #545#3  = "";
         #545#5  = "";
         #545#8  = "";
         #545#9  = "";
         #545#10 = "";
         #545#11 = "";
         #545#12 = "";
         #545#13 = "";
         #545#14 = "";
         #545#15 = "";
         #545#16 = "";
         #545#17 = "";
         #545#18 = "";
         #545#19 = "";
         #545#30 = "";
         #545#31 = "0000000000000";
         #545#61 = "0000000000000";
         #545#62 = "";
         #545#63 = "";
         #545#64 = "";
         #545#65 = "";
         #545#66 = "";
         #545#67 = "";
         #545#68 = "";
         #545#69 = "";
         #545#70 = "";
         #545#71 = "";
         #545#72 = "";
         #545#73 = "";
         #545#74 = "";
         #545#75 = "";
         #545#76 = "";
         #545#77 = "";
         nTCampo = 76;
     |FINSI;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #545nCampo;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;
     |XCIERRA nHandle2;

     |SI #0#32 = "L";
         |HAZ CargaImprime;
     |FINSI;

     nSwHay = 1;
|FPRC;

|PROCESO TDeclaracion310_2007;
     |SI #5#40 ! 0;
         enNume = #5#40;  |HAZ Conver13;  #569#51 = eaAlfa;

         |SI #0#35 = "S";  |O #0#35 = "D";
             |SI #4#5 = "          ";
                  #569#52 = "1";
             |SINO;
                  #569#52 = "2";
                  |SI #0#32 = "F"; |Y #0#35 = "D";
                      #569#52 = "3";
                  |FINSI;
                  #569#53 = #4#2;
                  #569#54 = #4#3;
                  #569#55 = #4#4;
                  #569#56 = #4#5;
             |FINSI;
         |SINO;
             #569#52 = "1";
         |FINSI;
      |SINO;
         #569#52 = "0";
         enNume  = 0;  |HAZ Conver13;  #569#61 = eaAlfa;
      |FINSI;

      #569#4 = "";
      |SI #0#32 = "L";
          |SI #5#40 = 0;  |Y #5#41 = 0;  |Y #5#42 = 0;  |Y #5#30 = 0;
              #569#4 = "N";
          |FINSI;
      |SINO;
          #569#4 = "";
          |SI #5#40 ! 0;
                                                  #569#4 = "I";
              |SI #0#35   = "A"; |Y #0#2 < 2013;  #569#4 = "A";  |FINSI;
              |SI #569#52 = "3";                  #569#4 = "U";  |FINSI;
          |FINSI;
          |SI #5#41 ! 0;  #569#4 = "C";  |FINSI;

          |SI #5#40 = 0;  |Y #5#41 = 0;  |Y #5#42 = 0;  |Y #5#30 = 0;
              #569#4 = "N";
          |FINSI;
      |FINSI;
|FPRC;

|PROCESO NoAgri310_2007;
     Campo2 = Campo1 + 1;
     Campo3 = Campo1 + 2;
     Campo4 = Campo1 + 3;

     #6#0 = #5Campo1;
     #6#1 = #5Campo2;
     |LEE 040#6=;
     |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;

     |SI #569#21 = "0000000000000";  Posi = 20;  |FINSI;
     |SI #569#19 = "0000000000000";  Posi = 18;  |FINSI;
     |SI #569#17 = "0000000000000";  Posi = 16;  |FINSI;
     |SI #569#15 = "0000000000000";  Posi = 14;  |FINSI;
     |SI #569#13 = "0000000000000";  Posi = 12;  |FINSI;

     enNume  = #5Campo4;  |HAZ Conver13;

                        #569Posi  = #5Campo2;
     Posi = Posi + 1;   #569Posi  = eaAlfa;
|FPRC;

|PROCESO SiAgri310_2007;
     Campo2 = Campo1 + 1;
     Campo3 = Campo1 + 2;
     Campo4 = Campo1 + 3;

     #6#0 = #5Campo1;
     #6#1 = #5Campo2;
     |LEE 040#6=;
     |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;

     |SI #569#29 = "0000000000000";  Posi = 28;  |FINSI;
     |SI #569#27 = "0000000000000";  Posi = 26;  |FINSI;
     |SI #569#25 = "0000000000000";  Posi = 24;  |FINSI;
     |SI #569#23 = "0000000000000";  Posi = 22;  |FINSI;

     eaAlfa   = #6#2;   |HAZ QuitaRaros;     #569Posi = eaAlfa;

     enNume  = #5Campo4;  |HAZ Conver13;
     Posi = Posi + 1 ;  #569Posi  = eaAlfa;
|FPRC;

|PROCESO Carga310_2007;
     |SI #0#32 = "L";
         aAbre = "\MODELOS\310\" + "310" + (("00000" + #2#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |SI #0#32 = "F";
         aAbre = eaInternet + "310" + (("00000" + #2#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |ABRE #50;
     #50#0 = #2#0;
     |LEE 000#50=;
     |SI FSalida ! 0;  |DDEFECTO #50;  |FINSI;
     |CIERRA #50;

     |DDEFECTO #569;

     #569#1   = "310";
     #569#2   = "01";
     #569#3   = "";

     #569#5   = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);
     aAlfa    = #2#1;  |QBF aAlfa;
     #569#6   = ("000000000" + aAlfa) % -109;
     #569#7   = #50#2;
     eaAlfa   = #2#2;    |HAZ QuitaRaros;     #569#8   = eaAlfa;
     #569#9   = ".";

     #569#10  = #0#2;
     #569#11  = #0#4 + "T";

     |SI #5#8  = "N";  |Y #5#9  ! 0;  Campo1 = 6;   |HAZ NoAgri310_2007;  |FINSI;
     |SI #5#8  = "S";  |Y #5#9  ! 0;  Campo1 = 6;   |HAZ SiAgri310_2007;  |FINSI;
     |SI #5#13 = "N";  |Y #5#14 ! 0;  Campo1 = 11;  |HAZ NoAgri310_2007;  |FINSI;
     |SI #5#13 = "S";  |Y #5#14 ! 0;  Campo1 = 11;  |HAZ SiAgri310_2007;  |FINSI;
     |SI #5#18 = "N";  |Y #5#19 ! 0;  Campo1 = 16;  |HAZ NoAgri310_2007;  |FINSI;
     |SI #5#18 = "S";  |Y #5#19 ! 0;  Campo1 = 16;  |HAZ SiAgri310_2007;  |FINSI;
     |SI #5#23 = "N";  |Y #5#24 ! 0;  Campo1 = 21;  |HAZ NoAgri310_2007;  |FINSI;
     |SI #5#23 = "S";  |Y #5#24 ! 0;  Campo1 = 21;  |HAZ SiAgri310_2007;  |FINSI;
     |SI #5#28 = "N";  |Y #5#29 ! 0;  Campo1 = 26;  |HAZ NoAgri310_2007;  |FINSI;
     |SI #5#28 = "S";  |Y #5#29 ! 0;  Campo1 = 26;  |HAZ SiAgri310_2007;  |FINSI;

     enNume  = #5#30;   |HAZ Conver13;  #569#30 = eaAlfa;
     enNume  = #5#31;   |HAZ Conver13;  #569#31 = eaAlfa;
     enNume  = #5#32;   |HAZ Conver13;  #569#32 = eaAlfa;
     enNume  = #5#33;   |HAZ Conver13;  #569#33 = eaAlfa;
     enNume  = #5#34;   |HAZ Conver13;  #569#34 = eaAlfa;
     enNume  = #5#35;   |HAZ Conver13;  #569#35 = eaAlfa;
     enNume  = #5#36;   |HAZ Conver13;  #569#36 = eaAlfa;
     enNume  = #5#37;   |HAZ Conver13;  #569#37 = eaAlfa;
     |SI #5#62 ! "S";
         enNume  = #5#38;   |HAZ Conver13;  #569#38 = eaAlfa;
     |SINO;
         enNume  = #5#38 + #5#65;   |HAZ Conver13;  #569#38 = eaAlfa;
     |FINSI;
     enNume  = #5#39;   |HAZ Conver13;  #569#39 = eaAlfa;
     enNume  = #5#65;   |HAZ Conver13;  #569#40 = eaAlfa;
     enNume  = #5#38;   |HAZ Conver13;  #569#41 = eaAlfa;
     enNume  = #5#41;   |HAZ Conver13;  #569#42 = eaAlfa;

     |HAZ TDeclaracion310_2007;

     |SI #5#62 = "S";
         #569#43 = #5#64;
         #569#44 = #5#63;
     |FINSI;

     eaAlfa  = #2#2;     |HAZ QuitaRaros;     #569#45  = eaAlfa;
     eaAlfa  = #2#14;    |HAZ QuitaRarosTfno; #569#46  = eaAlfa;

     eaAlfa  = #0#6;     |HAZ FechaBonito;
     eaAlfa  = #2#13;    |HAZ QuitaRaros;     #569#57 = eaAlfa;
     #569#58 = eaDiaB;
     #569#59 = eaMesB;
     #569#60 = eaAnyoB;
     #569#61 = &13 + &10;

     |SI #0#32 = "L";
         #569#7  = "";
         #569#43 = "";
         #569#45 = "";
         #569#46 = "";
         #569#47 = "";
         #569#48 = "";
         #569#49 = "";
         #569#50 = "";
         nTCampo = 61;
     |FINSI;

     |SI #0#32 = "F";
         #569#2  = "";
         #569#3  = "";
         #569#5  = "";
         #569#8  = "";
         #569#9  = "";
         #569#20 = "";
         #569#21 = "0000000000000";
         #569#42 = "0000000000000";
         #569#48 = "0000000000000";
         #569#57 = "";
         #569#58 = "";
         #569#59 = "";
         #569#60 = "";
         #569#61 = "";
         nTCampo = 60;
     |FINSI;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #569nCampo;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;
     |XCIERRA nHandle2;

     |SI #0#32 = "L";
         |HAZ CargaImprime;
     |FINSI;

     nSwHay = 1;
|FPRC;

|PROCESO TDeclaracion311;
     |SI #5#42 ! 0;
         enNume = #5#42;  |HAZ Conver13;  #546#50 = eaAlfa;
         |SI #4#5 ! "          ";
             #546#51 = #4#2;
             #546#52 = #4#3;
             #546#53 = #4#4;
             #546#54 = #4#5;
         |FINSI;
     |SINO;
         enNume  = 0;  |HAZ Conver13;  #546#50 = eaAlfa;
     |FINSI;

     |SI #5#40 ! 0;
         enNume = #5#40;  |HAZ Conver13;  #546#57 = eaAlfa;

         |SI #0#35 = "S";  |O #0#35 = "D";
             |SI #4#5 = "          ";
                 #546#55 = "X";
             |SINO;
                 #546#56 = "X";
                 #546#58 = #4#2;
                 #546#59 = #4#3;
                 #546#60 = #4#4;
                 #546#61 = #4#5;
             |FINSI;
         |SINO;
             #546#55 = "X";
         |FINSI;
     |SINO;
         enNume  = 0;  |HAZ Conver13;  #546#57 = eaAlfa;
     |FINSI;

     #546#4 = "";
     |SI #0#32 = "L";
         |SI #5#40 = 0;  |Y #5#41 = 0;  |Y #5#42 = 0;  |Y #5#30 = 0;
             #546#4 = "N";
         |FINSI;
     |SINO;
         |SI #5#40 ! 0;  #546#4 = "I";  |FINSI;
         |SI #5#41 ! 0;  #546#4 = "C";  |FINSI;
         |SI #5#42 ! 0;  #546#4 = "D";  |FINSI;

         |SI #5#40 = 0;  |Y #5#41 = 0;  |Y #5#42 = 0;  |Y #5#30 = 0;
             #546#4 = "N";
         |FINSI;

         |SI #0#4 = 4;  |Y #0#2 = 2007;  |Y #5#40 ! 0;
                                      aAlfa  = "0";
                 |SI #546#55  = "X";  aAlfa  = "1";  |FINSI;
                 |SI #546#56  = "X";  aAlfa  = "2";  |FINSI;
                 |SI #0#35    = "D";  aAlfa  = "3";  |FINSI;

                 #546#55 = aAlfa;
                 #546#56 = "";

                                                     #546#4 = "I";
                 |SI #0#35   = "A";  |Y #0#2 < 2013; #546#4 = "A";   |FINSI;
                 |SI #546#55 = "3";                  #546#4 = "U";   |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO TDeclaracion311_2008;
     #546#55 = "0";
     #546#56 = "";

     |SI #5#42 ! 0;
         enNume = #5#42;  |HAZ Conver13;  #546#50 = eaAlfa;
         |SI #4#5 ! "          ";
             #546#51 = #4#2;
             #546#52 = #4#3;
             #546#53 = #4#4;
             #546#54 = #4#5;
         |FINSI;
     |SINO;
         enNume  = 0;  |HAZ Conver13;  #546#50 = eaAlfa;
     |FINSI;

     |SI #5#40 ! 0;
         enNume = #5#40;  |HAZ Conver13;  #546#57 = eaAlfa;

         |SI #0#35 = "S";  |O #0#35 = "D";
             |SI #4#5 = "          ";
                 #546#55 = "1";
             |SINO;
                 |SI #0#35    = "S";  #546#55  = "2";  |FINSI;
                 |SI #0#35    = "D";  #546#55  = "3";  |FINSI;

                 #546#58 = #4#2;
                 #546#59 = #4#3;
                 #546#60 = #4#4;
                 #546#61 = #4#5;
             |FINSI;
         |SINO;
             #546#55 = "1";
         |FINSI;
     |SINO;
         enNume  = 0;  |HAZ Conver13;  #546#57 = eaAlfa;
     |FINSI;

     #546#4 = "";
     |SI #0#32 = "L";
         |SI #5#40 = 0;  |Y #5#41 = 0;  |Y #5#42 = 0;  |Y #5#30 = 0;
             #546#4 = "N";
         |FINSI;
     |SINO;
         |SI #5#41 ! 0;  #546#4 = "C";  |FINSI;
         |SI #5#42 ! 0;  #546#4 = "D";  |FINSI;

         |SI #5#40 = 0;  |Y #5#41 = 0;  |Y #5#42 = 0;  |Y #5#30 = 0;
             #546#4 = "N";
         |FINSI;

         |SI #5#40 ! 0;
                                                 #546#4 = "I";
             |SI #0#35   = "A"; |Y #0#2 < 2013;  #546#4 = "A";   |FINSI;
             |SI #546#55 = "3";                  #546#4 = "U";   |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO NoAgri311_2002;
     Campo2 = Campo1 + 1;
     Campo3 = Campo1 + 2;
     Campo4 = Campo1 + 3;

     #6#0 = #5Campo1;
     #6#1 = #5Campo2;
     |LEE 040#6=;
     |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;

     Posi = 0;

     |SI #546#26 = "0000000000000";  Posi = 25;  |FINSI;
     |SI #546#24 = "0000000000000";  Posi = 23;  |FINSI;
     |SI #546#22 = "0000000000000";  Posi = 21;  |FINSI;

     |SI Posi = 0;  |ACABA;  |FINSI;

     enNume  = #5Campo4;  |HAZ Conver13;

                        #546Posi  = #5Campo2;
     Posi = Posi + 1;   #546Posi  = eaAlfa;
|FPRC;

|PROCESO SiAgri311_2002;
     Campo2 = Campo1 + 1;
     Campo3 = Campo1 + 2;
     Campo4 = Campo1 + 3;

     #6#0 = #5Campo1;
     #6#1 = #5Campo2;
     |LEE 040#6=;
     |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;

     Posi = 0;

     |SI #546#32 = "0000000000000";  Posi = 31;  |FINSI;
     |SI #546#30 = "0000000000000";  Posi = 29;  |FINSI;
     |SI #546#28 = "0000000000000";  Posi = 27;  |FINSI;

     |SI Posi = 0;  |ACABA;  |FINSI;

     eaAlfa   = #6#2;   |HAZ QuitaRaros;     #546Posi = eaAlfa;

     enNume  = #5Campo4;  |HAZ Conver13;
     Posi = Posi + 1 ;  #546Posi  = eaAlfa;
|FPRC;

|PROCESO Carga311_2002;
     |SI #0#32 = "L";
         aAbre = "\MODELOS\310\" + "310" + (("00000" + #2#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |SI #0#32 = "F";
         aAbre = eaInternet + "310" + (("00000" + #2#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |ABRE #50;
     #50#0 = #2#0;
     |LEE 000#50=;
     |SI FSalida ! 0;  |DDEFECTO #50;  |FINSI;
     |CIERRA #50;

     |DDEFECTO #546;

     #546#1   = "311";
     #546#2   = "01";
     #546#3   = "";

     #546#5   = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);
     aAlfa    = #2#1;  |QBF aAlfa;
     #546#6   = ("000000000" + aAlfa) % -109;
     #546#7   = #50#2;
     eaAlfa   = #2#2;    |HAZ QuitaRaros;     #546#8   = eaAlfa;
     #546#9   = ".";
     eaAlfa   = #2#4;    |HAZ QuitaRaros;     #546#10  = eaAlfa;
     eaAlfa   = #2#5;    |HAZ QuitaRaros;     #546#11  = eaAlfa;
     #546#12  = #2#6;
     #546#13  = #2#7;
     #546#14  = #2#8;
     #546#15  = #2#9;
     #546#16  = (("00" + #2#10) % -102) + (("000" + #2#11) % -103);
     eaAlfa   = #2#13;   |HAZ QuitaRaros;     #546#17  = eaAlfa;
     eaAlfa   = #2#12;   |HAZ QuitaRaros;     #546#18  = eaAlfa;
     eaAlfa   = #2#14;   |HAZ QuitaRarosTfno; #546#19 = eaAlfa;

     #546#20  = #0#2;

     |SI #5#8  = "N";  |Y #5#9  ! 0;  Campo1 = 6;   |HAZ NoAgri311_2002;  |FINSI;
     |SI #5#8  = "S";  |Y #5#9  ! 0;  Campo1 = 6;   |HAZ SiAgri311_2002;  |FINSI;
     |SI #5#13 = "N";  |Y #5#14 ! 0;  Campo1 = 11;  |HAZ NoAgri311_2002;  |FINSI;
     |SI #5#13 = "S";  |Y #5#14 ! 0;  Campo1 = 11;  |HAZ SiAgri311_2002;  |FINSI;
     |SI #5#18 = "N";  |Y #5#19 ! 0;  Campo1 = 16;  |HAZ NoAgri311_2002;  |FINSI;
     |SI #5#18 = "S";  |Y #5#19 ! 0;  Campo1 = 16;  |HAZ SiAgri311_2002;  |FINSI;
     |SI #5#23 = "N";  |Y #5#24 ! 0;  Campo1 = 21;  |HAZ NoAgri311_2002;  |FINSI;
     |SI #5#23 = "S";  |Y #5#24 ! 0;  Campo1 = 21;  |HAZ SiAgri311_2002;  |FINSI;
     |SI #5#28 = "N";  |Y #5#29 ! 0;  Campo1 = 26;  |HAZ NoAgri311_2002;  |FINSI;
     |SI #5#28 = "S";  |Y #5#29 ! 0;  Campo1 = 26;  |HAZ SiAgri311_2002;  |FINSI;

     enNume  = #5#30;   |HAZ Conver13;  #546#33 = eaAlfa;
     enNume  = #5#43;   |HAZ Conver13;  #546#34 = eaAlfa;
     enNume  = #5#44;   |HAZ Conver13;  #546#35 = eaAlfa;
     enNume  = #5#31;   |HAZ Conver13;  #546#36 = eaAlfa;
     enNume  = #5#32;   |HAZ Conver13;  #546#37 = eaAlfa;
     enNume  = #5#33;   |HAZ Conver13;  #546#38 = eaAlfa;
     enNume  = #5#34;   |HAZ Conver13;  #546#39 = eaAlfa;
     enNume  = #5#35;   |HAZ Conver13;  #546#40 = eaAlfa;
     enNume  = #5#45;   |HAZ Conver13;  #546#41 = eaAlfa;
     enNume  = #5#46;   |HAZ Conver13;  #546#42 = eaAlfa;
     enNume  = #5#36;   |HAZ Conver13;  #546#43 = eaAlfa;
     enNume  = #5#37;   |HAZ Conver13;  #546#44 = eaAlfa;

     |SI #5#62 ! "S";
         enNume  = #5#38;   |HAZ Conver13;  #546#45 = eaAlfa;
     |SINO;
         enNume  = #5#38 + #5#65;   |HAZ Conver13;  #546#45 = eaAlfa;
     |FINSI;
     enNume  = #5#39;   |HAZ Conver13;  #546#46 = eaAlfa;

     enNume  = #5#65;   |HAZ Conver13;  #546#47 = eaAlfa;
     enNume  = #5#38;   |HAZ Conver13;  #546#48 = eaAlfa;
     enNume  = #5#41;   |HAZ Conver13;  #546#49 = eaAlfa;

     |SI #0#2 [ 2007;
         |HAZ TDeclaracion311;
     |SINO;
         |HAZ TDeclaracion311_2008;
     |FINSI;

     eaAlfa  = #2#2;     |HAZ QuitaRaros;     #546#64  = eaAlfa;
     eaAlfa  = #2#14;    |HAZ QuitaRarosTfno; #546#65  = eaAlfa;

     eaAlfa  = #0#6;     |HAZ FechaBonito;
     eaAlfa  = #2#13;    |HAZ QuitaRaros;     #546#70 = eaAlfa;
     #546#71 = eaDiaB;
     #546#72 = eaMesB;
     #546#73 = eaAnyoB;
     #546#74 = &13 + &10;

     |SI #5#62 = "S";
         #546#62 = #5#64;
         #546#63 = #5#63;
     |FINSI;

     |SI #0#32 = "L";
         #546#7  = "";
         #546#62 = "";
         #546#64 = "";
         #546#65 = "";
         #546#66 = "";
         nTCampo = 74;
     |FINSI;

     |SI #0#32 = "F";
         |SI #0#2 < 2007;
             #546#2  = "";
             #546#3  = "";
             #546#5  = "";
             #546#8  = "";
             #546#9  = "";
             #546#10 = "";
             #546#11 = "";
             #546#12 = "";
             #546#13 = "";
             #546#14 = "";
             #546#15 = "";
             #546#16 = "";
             #546#17 = "";
             #546#18 = "";
             #546#19 = "";
             #546#49 = "0000000000000";
             #546#50 = "0000000000000";
             #546#55 = "";
             #546#56 = "";
             #546#57 = "";
             #546#58 = "";
             #546#59 = "";
             #546#60 = "";
             #546#61 = "";
             #546#70 = "";
             #546#71 = "";
             #546#72 = "";
             #546#73 = "";
             #546#74 = "";
         |SINO;
             #546#2  = "";
             #546#3  = "";
             #546#5  = "";
             #546#8  = "";
             #546#9  = "";
             #546#10 = "";
             #546#11 = "";
             #546#12 = "";
             #546#13 = "";
             #546#14 = "";
             #546#15 = "";
             #546#16 = "";
             #546#17 = "";
             #546#18 = "";
             #546#19 = "";
             #546#49 = "0000000000000";
             #546#50 = "0000000000000";
             #546#70 = "";
             #546#71 = "";
             #546#72 = "";
             #546#73 = "";
             #546#74 = "";
         |FINSI;
         nTCampo = 73;
     |FINSI;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
           nGraba = 0;
           |SI nCampo = 56;
               |SI #0#2 = 2007; |Y #0#32 = "F";
                   nGraba = 1;
               |FINSI;

               |SI #0#2 ] 2008;
                   nGraba = 1;
               |FINSI;
           |FINSI;

           |SI nGraba = 0;
               aAlfa = #546nCampo;
               |XGRABA nHandle2, aAlfa;
           |FINSI;
     |SIGUE;
     |XCIERRA nHandle2;

     |SI #0#32 = "L";
         |HAZ CargaImprime;
     |FINSI;

     nSwHay = 1;
|FPRC;

|PROCESO Crea98L;
     |SI #0#33 ! "N";
         #2#0 = #5#0;
         |LEE 040#2=;
         |SI FSalida ! 0;    |ACABA; |FINSI;
         |SI #2#60   ! "N";  |ACABA; |FINSI;
     |FINSI;

     #3#0 = #2#18; #3#1 = #2#19;
     |LEE 040#3=;
     |SI FSalida ! 0; |DDEFECTO #3; |FINSI;

     #4#0 = #2#0;
     |LEE 040#4=;
     |SI FSalida ! 0; |DDEFECTO #4; |FINSI;

     |ABRE #6;
     |SI #0#2 [ 2001;
         |SI #0#4 ! 4;  |HAZ CargaTrab99;   |FINSI;
         |SI #0#4 = 4;  |HAZ CargaTrab100;  |FINSI;

         |HAZ CargaFichero2001;
     |FINSI;

     |SI #0#2 ] 2002;  |Y #0#2 [ 2006;
         |SI #0#4 ! 4;  |HAZ Carga310_2002;  |FINSI;
         |SI #0#4 = 4;  |HAZ Carga311_2002;  |FINSI;
     |FINSI;

     |SI #0#2 ] 2007;
         |SI #0#4 ! 4;  |HAZ Carga310_2007;  |FINSI;
         |SI #0#4 = 4;  |HAZ Carga311_2002;  |FINSI;
     |FINSI;

     |CIERRA #6;

     se_empre = #5#0;
     se_ejerc = #5#1;
     se_perio = #5#2;
     se_tipos = 310;
     se_activ = 10;
     se_impor = 0;
     |SI #5#40 > 0; se_impor =  #5#40 + #5#65; |FINSI;
     |SI #5#41 > 0; se_impor = -#5#41; |FINSI;
     |SI #5#42 > 0; se_impor = -#5#42; |FINSI;
     se_fecha = #0#6;
     se_factu = "N";

     |HAZ seguimie;
     |HAZ AlAgicli;
     #5#3 = #0#6;
     |GRABA 020#5a;
     |LIBERA #5;
|FPRC;

|DEFBUCLE eosm0019L;
  #5#1;
  4;
  DEmpre, nAnyo2D, #0#4, "N";
  HEmpre, nAnyo2D, #0#4, "N";
  be;
  NULL, Crea98L;
|FIN;

|PROCESO AlModelo98L;
  DEmpre = #2#0;
  HEmpre = #2#0;
  |BUCLE eosm0019L;
|FPRC;

|DEFBUCLE eosclien98L;
  #2#3;
  0, 60;
  Vacio40, #0#0, "N";
  LLeno40, #0#1, "N";
  ;
  NULL, AlModelo98L;
|FIN;

|PROCESO AbreImprime;
     aAbre = "\MODELOS\310\imprime.bat";
     |XABRE "CBW", aAbre, nHandle1;

     aAlfa = "CD \" + &13 + &10;                 |XGRABA nHandle1, aAlfa;
     aAlfa = "CD MODELOS" + &13 + &10;           |XGRABA nHandle1, aAlfa;
     aAlfa = "CD 310" + &13 + &10;               |XGRABA nHandle1, aAlfa;

     aAlfa = #0#2;
     aAlfa = aAlfa % -102;
     aVersion = "";

     |SI #0#2 ] 2008;
         aVersion = "01";
         |SI #0#2 = 2008;
             |SI #0#4 ] 2;
                 aVersion = "02";
             |FINSI;
         |FINSI;
     |FINSI;

     aAlfa1 = "DEL ERRORES.RST" + &13 + &10;      |XGRABA nHandle1, aAlfa1;

     aContiene = "";
     |ESPECIFICA "RBASS", aContiene;
     aUnidad = (aContiene1 % 102) > "";

     |SI aVersion = "";
         aAlfa = "ZLS" + aAlfa + "MPF.EXE /T:" + aUnidad + "\MODELOS\310\"+ &13 + &10;
     |SINO;
         aAlfa = "Z" + aAlfa + aVersion + "MPF.EXE /T:" + aUnidad + "\MODELOS\310\"+ &13 + &10;
     |FINSI;

     |XGRABA nHandle1, aAlfa;

     |SI #0#2 ] 2002;
         aAlfa = "MOVE ERRORM~1.TXT ERRORMIPF.TXT" + &13 + &10;      |XGRABA nHandle1, aAlfa;
         aAlfa = "MOVE EAN128~1.DLL EAN128_32.DLL" + &13 + &10;      |XGRABA nHandle1, aAlfa;
     |FINSI;
|FPRC;

|PROCESO EmiteEsto;
     aAlfa = "DEL *.wmf" + &13 + &10;             |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.tab"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.dll"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errorm~1.txt" + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errormipf.txt"  + &13 + &10;    |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errmipf.txt"  + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.exe"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     |XCIERRA nHandle1;

     eaModelos = "310";   |HAZ Copiampf;

     aAlfa = "\MODELOS\310\IMPRIME";
     |RSYSTEM aAlfa;
|FPRC;

|PROCESO Laser;
     |SI #0#2 [ 2001;
         NACopiar   = 0;
         INEmpresas = NEmpresas1 <-;
         |PARA XPara = 1; |SI XPara [ 700;  |HACIENDO XPara = XPara + 1;
               NEmpresas = "";
               INEmpresas = INEmpresas + 1;
         |SIGUE;
     |SINO;
         |SI #0#32 = "L";
             |PARA;  |SI;  |HACIENDO;
                  |DDEFECTO #601;
                  |PINPA #0#601;
                  |PINDA #0#601;
                  |ENDATOS #1#601;
                  |SI FSalida = 0;
                      aAlfa = "/MODELOS";          |RMKDIR aAlfa;
                      aAlfa = "/MODELOS/310";      |RMKDIR aAlfa;
                      |HAZ AbreImprime;
                      |SAL;
                  |FINSI;
             |SIGUE;
         |FINSI;

         |SI #0#32 = "F";
             aAlfa      = "/AEAT";                       |RMKDIR aAlfa;
             aAlfa      = "/AEAT/INTERNET";              |RMKDIR aAlfa;
             aAlfa      = "/AEAT/INTERNET/310";          |RMKDIR aAlfa;
             aAlfa      = "/AEAT/INTERNET/310/" + #0#2;  |RMKDIR aAlfa;
             eaInternet = aAlfa + "/";
         |FINSI;
     |FINSI;

     |ABRE #3;
     |ABRE #4;
     |SI #0#33 = "N";
         |BUCLE eosclien98L;
     |SINO;
         |ABRE #2;
         |SI #0#7 = "S";
             DEmpre = #0#0;
             HEmpre = #0#1;
             |BUCLE eosm0019L;
         |SINO;
             |PARA x = 8; |SI x [ 31; |HACIENDO x = x + 1;
                   |SI #0x ! 0;
                       DEmpre = #0x;
                       HEmpre = #0x;
                       |BUCLE eosm0019L;
                   |FINSI;
             |SIGUE;
         |FINSI;
         |CIERRA #2;
     |FINSI;
     |CIERRA #3;
     |CIERRA #4;

     |SI #0#2 [ 2001;
         |HAZ GrabaDisketteL;
     |FINSI;

     |SI #0#2 ] 2002;
         |SI #0#32 = "L";
             |SI nSwHay = 1;
                 |HAZ EmiteEsto;
                 eaTipoSec = "310";
                 eaTipoEmi = "ERRORES";
                 enAnyo    = #0#2;
                 |SUB_EJECUTA "eosz9999";
              |SINO;
                 |MENAV "     Seleccion Vacia";
                 |XCIERRA nHandle1;
             |FINSI;
             aAlfa = "\MODELOS\310\imprime.bat";
             |RFBORRA aAlfa;
          |FINSI;

          |SI #0#32 = "F";
              |SI nSwHay = 1;
                  aAlfa =  "      Ficheros Generados. Situados en " + eaInternet + " de su PC";
                  |MENAV aAlfa;
              |SINO;
                 |MENAV "     Seleccion Vacia";
              |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Seleccion;
     |SI #0#32 = "L";  |O #0#32 = "F";  |HAZ Laser;  |FINSI;
     |SI #0#32 ! "L";  |Y #0#32 ! "F";  |HAZ Papel;  |FINSI;
|FPRC;

|| --------------------------------------------------------------------------
|PROCESO Carga311_2013;

     |ABRE #50;
     #50#0 = #2#0;
     |LEE 000#50=;
     |SI FSalida ! 0;  |DDEFECTO #50;  |FINSI;
     |CIERRA #50;

     |DDEFECTO #546;

     #546#1   = "311";
     #546#2   = "01";
     #546#3   = "";

     #546#5   = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);
     aAlfa    = #2#1;  |QBF aAlfa;
     #546#6   = ("000000000" + aAlfa) % -109;
     #546#7   = #50#2;
     eaAlfa   = #2#2;    |HAZ QuitaRaros;     #546#8   = eaAlfa;
     #546#9   = ".";
     eaAlfa   = #2#4;    |HAZ QuitaRaros;     #546#10  = eaAlfa;
     eaAlfa   = #2#5;    |HAZ QuitaRaros;     #546#11  = eaAlfa;
     #546#12  = #2#6;
     #546#13  = #2#7;
     #546#14  = #2#8;
     #546#15  = #2#9;
     #546#16  = (("00" + #2#10) % -102) + (("000" + #2#11) % -103);
     eaAlfa   = #2#13;   |HAZ QuitaRaros;     #546#17  = eaAlfa;
     eaAlfa   = #2#12;   |HAZ QuitaRaros;     #546#18  = eaAlfa;
     eaAlfa   = #2#14;   |HAZ QuitaRarosTfno; #546#19 = eaAlfa;

     #546#20  = #0#2;

     |SI #5#8  = "N";  |Y #5#9  ! 0;  Campo1 = 6;   |HAZ NoAgri311_2002;  |FINSI;
     |SI #5#8  = "S";  |Y #5#9  ! 0;  Campo1 = 6;   |HAZ SiAgri311_2002;  |FINSI;
     |SI #5#13 = "N";  |Y #5#14 ! 0;  Campo1 = 11;  |HAZ NoAgri311_2002;  |FINSI;
     |SI #5#13 = "S";  |Y #5#14 ! 0;  Campo1 = 11;  |HAZ SiAgri311_2002;  |FINSI;
     |SI #5#18 = "N";  |Y #5#19 ! 0;  Campo1 = 16;  |HAZ NoAgri311_2002;  |FINSI;
     |SI #5#18 = "S";  |Y #5#19 ! 0;  Campo1 = 16;  |HAZ SiAgri311_2002;  |FINSI;
     |SI #5#23 = "N";  |Y #5#24 ! 0;  Campo1 = 21;  |HAZ NoAgri311_2002;  |FINSI;
     |SI #5#23 = "S";  |Y #5#24 ! 0;  Campo1 = 21;  |HAZ SiAgri311_2002;  |FINSI;
     |SI #5#28 = "N";  |Y #5#29 ! 0;  Campo1 = 26;  |HAZ NoAgri311_2002;  |FINSI;
     |SI #5#28 = "S";  |Y #5#29 ! 0;  Campo1 = 26;  |HAZ SiAgri311_2002;  |FINSI;

     enNume  = #5#30;   |HAZ Conver13;  #546#33 = eaAlfa;
     enNume  = #5#43;   |HAZ Conver13;  #546#34 = eaAlfa;
     enNume  = #5#44;   |HAZ Conver13;  #546#35 = eaAlfa;
     enNume  = #5#31;   |HAZ Conver13;  #546#36 = eaAlfa;
     enNume  = #5#32;   |HAZ Conver13;  #546#37 = eaAlfa;
     enNume  = #5#33;   |HAZ Conver13;  #546#38 = eaAlfa;
     enNume  = #5#34;   |HAZ Conver13;  #546#39 = eaAlfa;
     enNume  = #5#35;   |HAZ Conver13;  #546#40 = eaAlfa;
     enNume  = #5#45;   |HAZ Conver13;  #546#41 = eaAlfa;
     enNume  = #5#46;   |HAZ Conver13;  #546#42 = eaAlfa;
     enNume  = #5#36;   |HAZ Conver13;  #546#43 = eaAlfa;
     enNume  = #5#37;   |HAZ Conver13;  #546#44 = eaAlfa;

     |SI #5#62 ! "S";
         enNume  = #5#38;   |HAZ Conver13;  #546#45 = eaAlfa;
     |SINO;
         enNume  = #5#38 + #5#65;   |HAZ Conver13;  #546#45 = eaAlfa;
     |FINSI;
     enNume  = #5#39;   |HAZ Conver13;  #546#46 = eaAlfa;

     enNume  = #5#65;   |HAZ Conver13;  #546#47 = eaAlfa;
     enNume  = #5#38;   |HAZ Conver13;  #546#48 = eaAlfa;
     enNume  = #5#41;   |HAZ Conver13;  #546#49 = eaAlfa;

     |HAZ TDeclaracion311_2008;

     eaAlfa  = #2#2;     |HAZ QuitaRaros;     #546#64  = eaAlfa;
     eaAlfa  = #2#14;    |HAZ QuitaRarosTfno; #546#65  = eaAlfa;

     eaAlfa  = #0#6;     |HAZ FechaBonito;
     eaAlfa  = #2#13;    |HAZ QuitaRaros;     #546#70 = eaAlfa;
     #546#71 = eaDiaB;
     #546#72 = eaMesB;
     #546#73 = eaAnyoB;
     #546#74 = &13 + &10;

     |SI #5#62 = "S";
         #546#62 = #5#64;
         #546#63 = #5#63;
     |FINSI;

     |SI nTecla = 1;
         #546#7  = "";
         #546#62 = "";
         #546#64 = "";
         #546#65 = "";
         #546#66 = "";
         nTCampo = 74;
     |FINSI;

     |SI nTecla = 3;
         #546#2  = "";
         #546#3  = "";
         #546#5  = "";
         #546#8  = "";
         #546#9  = "";
         #546#10 = "";
         #546#11 = "";
         #546#12 = "";
         #546#13 = "";
         #546#14 = "";
         #546#15 = "";
         #546#16 = "";
         #546#17 = "";
         #546#18 = "";
         #546#19 = "";
         #546#49 = "0000000000000";
         #546#50 = "0000000000000";
         #546#70 = "";
         #546#71 = "";
         #546#72 = "";
         #546#73 = "";
         #546#74 = "";

         nTCampo = 73;
     |FINSI;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
           nGraba = 0;
           |SI nCampo = 56;
                nGraba = 1;
           |FINSI;

           |SI nGraba = 0;
               aAlfa = #546nCampo;
               |XGRABA nHandle2, aAlfa;
           |FINSI;
     |SIGUE;
     nSwHay = 1;
|FPRC;

|PROCESO Carga310_2013;

     |ABRE #50;
     #50#0 = #2#0;
     |LEE 000#50=;
     |SI FSalida ! 0;  |DDEFECTO #50;  |FINSI;
     |CIERRA #50;

     |DDEFECTO #569;

     #569#1   = "310";
     #569#2   = "01";
     #569#3   = "";

     #569#5   = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);
     aAlfa    = #2#1;  |QBF aAlfa;
     #569#6   = ("000000000" + aAlfa) % -109;
     #569#7   = #50#2;
     eaAlfa   = #2#2;    |HAZ QuitaRaros;     #569#8   = eaAlfa;
     #569#9   = ".";

     #569#10  = #0#2;
     #569#11  = #0#4 + "T";

     |SI #5#8  = "N";  |Y #5#9  ! 0;  Campo1 = 6;   |HAZ NoAgri310_2007;  |FINSI;
     |SI #5#8  = "S";  |Y #5#9  ! 0;  Campo1 = 6;   |HAZ SiAgri310_2007;  |FINSI;
     |SI #5#13 = "N";  |Y #5#14 ! 0;  Campo1 = 11;  |HAZ NoAgri310_2007;  |FINSI;
     |SI #5#13 = "S";  |Y #5#14 ! 0;  Campo1 = 11;  |HAZ SiAgri310_2007;  |FINSI;
     |SI #5#18 = "N";  |Y #5#19 ! 0;  Campo1 = 16;  |HAZ NoAgri310_2007;  |FINSI;
     |SI #5#18 = "S";  |Y #5#19 ! 0;  Campo1 = 16;  |HAZ SiAgri310_2007;  |FINSI;
     |SI #5#23 = "N";  |Y #5#24 ! 0;  Campo1 = 21;  |HAZ NoAgri310_2007;  |FINSI;
     |SI #5#23 = "S";  |Y #5#24 ! 0;  Campo1 = 21;  |HAZ SiAgri310_2007;  |FINSI;
     |SI #5#28 = "N";  |Y #5#29 ! 0;  Campo1 = 26;  |HAZ NoAgri310_2007;  |FINSI;
     |SI #5#28 = "S";  |Y #5#29 ! 0;  Campo1 = 26;  |HAZ SiAgri310_2007;  |FINSI;

     enNume  = #5#30;   |HAZ Conver13;  #569#30 = eaAlfa;
     enNume  = #5#31;   |HAZ Conver13;  #569#31 = eaAlfa;
     enNume  = #5#32;   |HAZ Conver13;  #569#32 = eaAlfa;
     enNume  = #5#33;   |HAZ Conver13;  #569#33 = eaAlfa;
     enNume  = #5#34;   |HAZ Conver13;  #569#34 = eaAlfa;
     enNume  = #5#35;   |HAZ Conver13;  #569#35 = eaAlfa;
     enNume  = #5#36;   |HAZ Conver13;  #569#36 = eaAlfa;
     enNume  = #5#37;   |HAZ Conver13;  #569#37 = eaAlfa;
     |SI #5#62 ! "S";
         enNume  = #5#38;   |HAZ Conver13;  #569#38 = eaAlfa;
     |SINO;
         enNume  = #5#38 + #5#65;   |HAZ Conver13;  #569#38 = eaAlfa;
     |FINSI;
     enNume  = #5#39;   |HAZ Conver13;  #569#39 = eaAlfa;
     enNume  = #5#65;   |HAZ Conver13;  #569#40 = eaAlfa;
     enNume  = #5#38;   |HAZ Conver13;  #569#41 = eaAlfa;
     enNume  = #5#41;   |HAZ Conver13;  #569#42 = eaAlfa;

     |HAZ TDeclaracion310_2007;

     |SI #5#62 = "S";
         #569#43 = #5#64;
         #569#44 = #5#63;
     |FINSI;

     eaAlfa  = #2#2;     |HAZ QuitaRaros;     #569#45  = eaAlfa;
     eaAlfa  = #2#14;    |HAZ QuitaRarosTfno; #569#46  = eaAlfa;

     eaAlfa  = #0#6;     |HAZ FechaBonito;
     eaAlfa  = #2#13;    |HAZ QuitaRaros;     #569#57 = eaAlfa;
     #569#58 = eaDiaB;
     #569#59 = eaMesB;
     #569#60 = eaAnyoB;
     #569#61 = &13 + &10;

     |SI nTecla = 1;
         #569#7  = "";
         #569#43 = "";
         #569#45 = "";
         #569#46 = "";
         #569#47 = "";
         #569#48 = "";
         #569#49 = "";
         #569#50 = "";
         nTCampo = 61;
     |FINSI;

     |SI nTecla = 3;
         #569#2  = "";
         #569#3  = "";
         #569#5  = "";
         #569#8  = "";
         #569#9  = "";
         #569#20 = "";
         #569#21 = "0000000000000";
         #569#42 = "0000000000000";
         #569#48 = "0000000000000";
         #569#57 = "";
         #569#58 = "";
         #569#59 = "";
         #569#60 = "";
         #569#61 = "";
         nTCampo = 60;
     |FINSI;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #569nCampo;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;

     nSwHay = 1;
|FPRC;

|PROCESO Crea98L_2013;
     |SI #0#33 ! "N";
         #2#0 = #5#0;
         |LEE 040#2=;
         |SI FSalida ! 0;    |ACABA; |FINSI;
         |SI #2#60   ! "N";  |ACABA; |FINSI;
     |FINSI;

     #3#0 = #2#18; #3#1 = #2#19;
     |LEE 040#3=;
     |SI FSalida ! 0; |DDEFECTO #3; |FINSI;

     #4#0 = #2#0;
     |LEE 040#4=;
     |SI FSalida ! 0; |DDEFECTO #4; |FINSI;

     eaFicheroPlano = "310" + (("00000" + #2#0) % -105) + ".txt";
     eaFicheroImpre = "310" + (("00000" + #2#0) % -105) + ".pdf";
     eaFicheroError = "err" + (("00000" + #2#0) % -105) + ".txt";

     aAlfa = eaPathLanza + eaFicheroPlano;  |RFBORRA aAlfa;
     aAlfa = eaPathLanza + eaFicheroImpre;  |RFBORRA aAlfa;
     aAlfa = eaPathLanza + eaFicheroError;  |RFBORRA aAlfa;

     aAbre = eaPathEmision + eaFicheroPlano;
     |XABRE "BW", aAbre, nHandle2;

     |ABRE #6;
     |SI #0#4 ! 4;
         |HAZ Carga310_2013;
     |SINO;
         |HAZ Carga311_2013;
     |FINSI;
     |CIERRA #6;
     |XCIERRA nHandle2;

     se_empre = #5#0;
     se_ejerc = #5#1;
     se_perio = #5#2;
     se_tipos = 310;
     se_activ = 10;
     se_impor = 0;
     |SI #5#40 > 0; se_impor =  #5#40 + #5#65; |FINSI;
     |SI #5#41 > 0; se_impor = -#5#41; |FINSI;
     |SI #5#42 > 0; se_impor = -#5#42; |FINSI;
     se_fecha = #0#6;
     se_factu = "N";

     |HAZ seguimie;
     |HAZ AlAgicli;
     #5#3 = #0#6;
     |GRABA 020#5a;
     |LIBERA #5;

     enEmpresa    = #2#0;
     eaNomEmpresa = #2#1;

     |SI enTecla = 3;
         eaFOrigen  = eaPathEmision  + eaFicheroPlano;
         eaFDestino = eaPathInternet + eaFicheroPlano;
         |HAZ CopiaFicheroIP;

         |ACABA;
     |FINSI;

     |HAZ PresentaMPF;
|FPRC;

|DEFBUCLE eosm0019L_2013;
  #5#1;
  4;
  DEmpre, nAnyo2D, #0#4, "N";
  HEmpre, nAnyo2D, #0#4, "N";
  be;
  NULL, Crea98L_2013;
|FIN;

|PROCESO AlModelo98L_2013;
  DEmpre = #2#0;
  HEmpre = #2#0;
  |BUCLE eosm0019L_2013;
|FPRC;

|DEFBUCLE eosclien98L_2013;
  #2#3;
  0, 60;
  Vacio40, #0#0, "N";
  LLeno40, #0#1, "N";
  ;
  NULL, AlModelo98L_2013;
|FIN;

|PROCESO Bloque2013;
     |HAZ LeeUnidad;
     eaModelos  = "310";
     eaPeriodo  = ("00" + enPeriodo) % -102;
     |SI #0#4 = 1; perialf = "1T"; |FINSI;
     |SI #0#4 = 2; perialf = "2T"; |FINSI;
     |SI #0#4 = 3; perialf = "3T"; |FINSI;
     |SI #0#4 = 4; perialf = "4T"; |FINSI;

     eaPathLanza = eaUnidad + "\MODELOS";            |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\" + eaModelos;    |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\" + eaEjer;       |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\" + perialf;      |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\";

     |DBASE eaPathEmision;
     eaPathEmision = eaPathEmision + "emisiones";       |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + eaModelos;   |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + eaEjer;      |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + perialf;     |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/";

     eaPathInternet = eaUnidad + "/AEAT";                |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/INTERNET";      |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + eaModelos;  |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + eaEjer;     |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + perialf;     |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/";

     |HAZ BotonesMPF;
     nTecla = enTecla;
     |SI nTecla = 0;  |ACABA;  |FINSI;

     |ABRE #3;
     |ABRE #4;
     |SI #0#33 = "N";
         |BUCLE eosclien98L_2013;
     |SINO;
         |ABRE #2;
         |SI #0#7 = "S";
             DEmpre = #0#0;
             HEmpre = #0#1;
             |BUCLE eosm0019L_2013;
         |SINO;
             |PARA x = 8; |SI x [ 31; |HACIENDO x = x + 1;
                   |SI #0x ! 0;
                       DEmpre = #0x;
                       HEmpre = #0x;
                       |BUCLE eosm0019L_2013;
                   |FINSI;
             |SIGUE;
         |FINSI;
         |CIERRA #2;
     |FINSI;
     |CIERRA #3;
     |CIERRA #4;

     |HAZ SacaErrorPtl;

     |SI eaOpcion = "3"; |Y nSwHay ! 0;
         |SI enPresentar = 0;
             aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
             |MENAV aAlfa;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO mes;
  |SI mes = "01"; mes = "ENERO     "; |FINSI;
  |SI mes = "02"; mes = "FEBRERO   "; |FINSI;
  |SI mes = "03"; mes = "MARZO     "; |FINSI;
  |SI mes = "04"; mes = "ABRIL     "; |FINSI;
  |SI mes = "05"; mes = "MAYO      "; |FINSI;
  |SI mes = "06"; mes = "JUNIO     "; |FINSI;
  |SI mes = "07"; mes = "JULIO     "; |FINSI;
  |SI mes = "08"; mes = "AGOSTO    "; |FINSI;
  |SI mes = "09"; mes = "SEPTIEMBRE"; |FINSI;
  |SI mes = "10"; mes = "OCTUBRE   "; |FINSI;
  |SI mes = "11"; mes = "NOVIEMBRE "; |FINSI;
  |SI mes = "12"; mes = "DICIEMBRE "; |FINSI;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     aAlfa     = #0#2 % -102;
     nAnyo2D   = aAlfa;
     enAnyo    = #0#2;
     eaEjer    = #0#2;
     enPer     = #0#4;
     enPeriodo = #0#4;

     eaTipoSec = "310";

     dia    = #0#6 % 102;
     mes    = #0#6 % 402;
     |HAZ mes;
     anyo   = #0#6 % 704;
     |SI #0#4 ! 4;  aTipoSec = "310";  |FINSI;
     |SI #0#4 = 4;  aTipoSec = "311";  |FINSI;

     |SI #0#2 [ 2012; |O #0#32 = "B"; |O #0#32 = "O";
         |HAZ Seleccion;
         |ACABA;
     |FINSI;

     |HAZ Bloque2013;
|FPRC;

|PROCESO MiraVarMoneda;  |TIPO 0;
     |HAZ PintaMoneda;
     #0#34 = eaMoneda;

     |SI #0#2 = 2000;
         |SI #0#32 = "L";  |O #0#32 = "F";
             #0#34 = "PESETAS";
         |FINSI;
     |FINSI;

     |SI #0#2 ] 2002;
         |SI #0#34 = "PESETAS";
             |MENAV "     Moneda Erronea.";
             |ERROR;
         |FINSI;
     |FINSI;

     |PINTA #0#34;
|FPRC;
