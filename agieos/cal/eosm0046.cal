|FICHEROS;
     eosm0046 #28;
     eosm0045 #29;

     eosaplic #100;
     eosclipr #103;
     :/agicli/def/agicontr #101;

     &espejo@ #900;
|FIN;

|VARIABLES;
     nModo        = 0;

     aPathFich    = "";
     aPathPan     = "";
     aMas         = "";
     aBase        = "";

     &enEmpresa   = 0;
     &eaNif       = "";
     &enReferen   = 0;
     aParam       = "";
     nOk          = 0;
|FIN;

|RUTINA ClaveBaja45;
     #29#0 = #28#0;
     #29#1 = "           ";
     #29#4 = 01;
|FRUT;

|RUTINA ClaveAlta45;
     #29#0 = #28#0;
     #29#1 = "zzzzzzzzzzzz";
     #29#4 = 99;
|FRUT;

|RUTINA ClaveBaja45U;
     #29#0 = enEmpresa;
     #29#1 = eaNif;
     #29#4 = enReferen;
|FRUT;

|RUTINA ClaveAlta45U;
     #29#0 = enEmpresa;
     #29#1 = eaNif;
     #29#4 = enReferen;
|FRUT;

|PROCESO Tipo14;  |TIPO 14;
     |PTEC 807;
     |ENTLINEAL #1#29, 2, 4, 21, 0, ClaveBaja45, ClaveAlta45;
|FPRC;

|PROCESO Tipo12;  |TIPO 12;

    |DBASE aBase;  |QBF aBase;
    aMas = aBase + "def/eosm0045.mas";
    |CARGA_DEF aMas, espejo@;
    |SI FSalida ! 0;  |ACABA;  |FINSI;

    |SI aParam = "";
        |ENTLINEAL #1#29, 2, 1, 21, 0, ClaveBaja45, ClaveAlta45;
    |SINO;
        |PTEC 802;
        |ENTLINEAL #1#29, 2, 1, 21, 0, ClaveBaja45U, ClaveAlta45U;
    |FINSI;

    |DESCARGA_DEF #espejo@;
|FPRC;

|PROCESO Tipo8;  |TIPO 8;
     |ABRE #100;
     |LEE 040#100p;
     |SI FSalida ! 0; |DDEFECTO #100; |FINSI;
     |CIERRA #100;

     |SI #100#11 = 1; |ACABA; |FINSI;

     |ABRE #101;
     |LEE 040#101p;
     |SI FSalida ! 0; |CIERRA #101; |ACABA; |FINSI;
     |CIERRA #101;

     aPathFich = #101#8; |QBF aPathFich;
     |SI aPathFich = "*";  |ACABA;  |FINSI;
     aPathPan = (aPathFich - "fich/") + "pan/";

     |PATH_DAT #103 aPathFich;
     |PATH_PAN #103 aPathPan;
|FPRC;

|PROCESO Borra29;
     |BORRA 020#29a;
     |LIBERA #29;
|FPRC;

|DEFBUCLE eosm0045Baja;
     #29#1;
     ;
     #28#0, "            ", 01;
     #28#0, "zzzzzzzzzzzz", 99;
     ;
     NULL, Borra29;
|FIN;

|PROCESO Tipo2m0046;  |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 3;  |ACABA;  |FINSI;

     |BUCLE eosm0045Baja;
|FPRC;

|PROCESO ActuMuni;
     |HAZ CodMuni;
     |GRABA 020#29a;
     |LIBERA #29;
|FPRC;

|DEFBUCLE ActuMuni;
    #29#1;
    18;
    00001, "            ", 01, "     ";
    99999, "zzzzzzzzzzzz", 99, "zzzzz";
    be;
    NULL, ActuMuni;
|FIN;

|PROCESO MiroMuni;
     nOk = 0;
     |ABRE #29;
     |SELECT #3#29;
     |LEE 041#29.p;
     |SI FSalida = 0;
         |SI #29#18 = "     ";
             nOk = 1;
         |FINSI;
     |FINSI;
     |SELECT #1#29;
     |CIERRA #29;
     |SI nOk = 1;
         |BUCLE ActuMuni;
     |FINSI;
|FPRC;

|PROGRAMA;
     aParam = PARAMETRO; |QBF aParam;

     |HAZ MiroMuni;

     |SI aParam = "MODELO";
         |CLS;
         |CABEZA "Empresa-Arrendadores";

         |HAZ Tipo8;
         |ABRE #28;
         #28#0 = enEmpresa;
         |LEE 000#28=;
         |PINPA #0#28;
         |PINDA #0#28;
         |HAZ Tipo12;
         |CIERRA #28;
     |SINO;
         |MANTE #28;
     |FINSI;
|FPRO;
