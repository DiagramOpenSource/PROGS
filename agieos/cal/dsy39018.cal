|FICHEROS;
     dsmoy000;

     dsmom004;
     dsm39001;
     dsm39002;
     dsm39003;
     dsm39004;
     dsm39005;

     eosclien;
     eoscomul;

     t1839001;
     t1539002;
     t1839003;
     t1839004;
     t1539005;
     t1839006;
     t1539007;
     t1539008;

     dsmow014;
|FIN;

|VARIABLES;
     aLetrasCif      = "ABCDEFGHNPQSKLMJUVWR";
     aIPRemoto       = "";
     aFicTmp         = "";

     nNueEjer        = 0;
     nGrupo          = 0;
     nSubGrupo       = 0;
     nCampo1         = 0;
     nCampo2         = 0;
     nCampo3         = 0;
     nCampo4         = 0;
     nCampo5         = 0;
     nCampo6         = 0;
     nCas            = 0;
     nCas1           = 0;
     nCas2           = 0;
     nCas3           = 0;
     nCas4           = 0;
     nCas5           = 0;
     nCas6           = 0;
     nCas7           = 0;
     nCas8           = 0;
     nCas9           = 0;
     nCas10          = 0;
     nCas11          = 0;
     nCas12          = 0;
     nCas13          = 0;
     nCas14          = 0;
     nCas15          = 0;
     nCas16          = 0;
     nConta          = 0;
     nFila           = 0;
     nPag            = 0;
     nAnyoDos        = 0;
     nSigo           = 0;
     nHayGrupo       = 0;

     nNume1          = 0;
     nNume2          = 0;

     aNifp           = "";
     aNombrep        = "";
     aCallep         = "";
     aNump           = "";
     aEscp           = "";
     aPisop          = "";
     aPuep           = "";
     aPoblap         = "";
     aProvip         = "";
     aCodp           = "";
     aSgp            = "";
     aTlfnop         = "";
     aVacio_20       = "                    ";
     aVacio_16       = "                ";
     aVacio_12       = "            ";
     aVacio_10       = "          ";

     &enEjer         = 0;
     &enComplem      = 0;
     &enTipoEntrada  = 0;
     &nSwMod         = 0;
|FIN;

|INCLUYE i_varemi;

|PROCESO LeeDSM39002;
     #dsm39002#0  = #dsm39001#0;
     #dsm39002#1  = #dsm39001#1;
     #dsm39002#2  = #dsm39001#2;
     #dsm39002#3  = #dsm39001#3;
     #dsm39002#4  = nGrupo;
     #dsm39002#5  = nSubGrupo;
     |SELECT #1#dsm39002;
     |LEE 040#dsm39002.=;
     |SI FSalida ! 0;  |DDEFECTO #dsm39002;  |FINSI;
|FPRC;

|PROCESO CargaGrupo;
     #dsm39005#0 = #dsm39001#0;
     #dsm39005#1 = #dsm39001#1;
     #dsm39005#2 = #dsm39001#2;
     #dsm39005#3 = #dsm39001#3;
     #dsm39005#4 = nGrupo;
     |LEE 000#dsm39005.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nSigo = 0;
     |PARA nCampo = 5;  |SI nCampo [ 21;  |HACIENDO nCampo = nCampo + 1;
           |SI #dsm39005#nCampo# ! 0;
               nSigo = 1;
               |SAL;
           |FINSI;
     |SIGUE;

     |SI nSigo = 0;  |ACABA;  |FINSI;

     nHayGrupo = 1;

     |SI nGrupo = 1;  nCas = 6;  |FINSI;
     |SI nGrupo = 2;  nCas = 24; |FINSI;
     |SI nGrupo = 3;  nCas = 42; |FINSI;

                       enNume  = #dsm39005#5;   |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#6;   |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#7;   |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#8;   |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#9;   |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#10;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#11;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#12;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#13;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#14;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#15;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#16;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#17;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#18;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#22;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#19;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#20;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#21;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
|FPRC;

|PROCESO Registro8;
     nHayGrupo = 0;

     |DDEFECTO #t1539008;

     |ABRE #dsm39005;

     nGrupo = 1;  |HAZ CargaGrupo;
     nGrupo = 2;  |HAZ CargaGrupo;
     nGrupo = 3;  |HAZ CargaGrupo;

     |CIERRA #dsm39005;
|FPRC;

|PROCESO dsm39004;
     nConta = nConta + 1;

     #t1539007#0 = ((nConta / 5) + .49) ! 0;
     |LEE 101#t1539007.=;
     |SI FSalida ! 0;
         |DDEFECTO #t1539007;
         #t1539007#0 = ((nConta / 5) + .49) ! 0;
         |GRABA 020#t1539007.b;

         |SI #t1539007#0 > 1;  #t1539007#5 = "C";  |FINSI;

         nFila = 0;
     |FINSI;

     nFila = nFila + 1;

                     nCas = 17;
     |SI nFila = 2;  nCas = 23;  |FINSI;
     |SI nFila = 3;  nCas = 29;  |FINSI;
     |SI nFila = 4;  nCas = 35;  |FINSI;
     |SI nFila = 5;  nCas = 41;  |FINSI;

                       eaAlfa = #dsm39004#5; |HAZ QuitaRaros;  #t1539007#nCas# = eaAlfa;
     nCas = nCas + 1;                                          #t1539007#nCas# = #dsm39004#6 % 103;
     nCas = nCas + 1;  enNume  = #dsm39004#7;  |HAZ Conver17;  #t1539007#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39004#8;  |HAZ Conver17;  #t1539007#nCas# = eaAlfa;
     nCas = nCas + 1;                                          #t1539007#nCas# = #dsm39004#9;
     nCas = nCas + 1;  enNume  = #dsm39004#10 * 100;           aAlfa           = ("00000" + enNume) % -105;
                                                               #t1539007#nCas# = aAlfa;

     |GRABA 020#t1539007.a;
     |LIBERA #t1539007;
|FPRC;

|DEFBUCLE dsm39004;
     #dsm39004#1;
     ;
     #dsm39001#0, #dsm39001#1, #dsm39001#2, #dsm39001#3, 01;
     #dsm39001#0, #dsm39001#1, #dsm39001#2, #dsm39001#3, 99;
     ;
     NULL, dsm39004;
|FIN;

|PROCESO Registro7;
     nConta = 0;
     |BUCLE dsm39004;

     |SI nConta = 0;
         enNume  = 0;
         nGrupo  = 4;  nSubGrupo = 1;   |HAZ LeeDSM39002;
         enNume  = enNume + #dsm39002#10;

         nGrupo  = 4;  nSubGrupo = 2;   |HAZ LeeDSM39002;
         enNume  = enNume + #dsm39002#10;

         nGrupo  = 4;  nSubGrupo = 3;   |HAZ LeeDSM39002;
         enNume  = enNume + #dsm39002#10;

         nGrupo  = 4;  nSubGrupo = 4;   |HAZ LeeDSM39002;
         enNume  = enNume + #dsm39002#10;

         nGrupo  = 4;  nSubGrupo = 6;   |HAZ LeeDSM39002;
         enNume  = enNume + #dsm39002#10;

         nGrupo  = 4;  nSubGrupo = 8;   |HAZ LeeDSM39002;
         enNume  = enNume + #dsm39002#10;

         nGrupo  = 4;  nSubGrupo = 16;   |HAZ LeeDSM39002;
         enNume  = enNume + #dsm39002#10;

         nGrupo  = 4;  nSubGrupo = 17;   |HAZ LeeDSM39002;
         enNume  = enNume + #dsm39002#10 + #dsm39002#11;

         nGrupo  = 4;  nSubGrupo = 18;   |HAZ LeeDSM39002;
         enNume  = enNume + #dsm39002#10 + #dsm39002#11;

         |SI enNume = 0;  |ACABA;  |FINSI;
     |FINSI;

     #t1539007#0 = 1;
     |LEE 101#t1539007.=;
     |SI FSalida ! 0;
         |DDEFECTO #t1539007;
         #t1539007#0 = 1;
         |GRABA 020#t1539007.b;
     |FINSI;

     nGrupo  = 4;  nSubGrupo = 1;   |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539007#6  = eaAlfa;

     nGrupo  = 4;  nSubGrupo = 2;   |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539007#7  = eaAlfa;

     nGrupo  = 4;  nSubGrupo = 3;   |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539007#8  = eaAlfa;

     nGrupo  = 4;  nSubGrupo = 4;   |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539007#9  = eaAlfa;

     nGrupo  = 4;  nSubGrupo = 6;   |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539007#10 = eaAlfa;

     nGrupo  = 4;  nSubGrupo = 8;   |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539007#11 = eaAlfa;

     nGrupo  = 4;  nSubGrupo = 16;   |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539007#12 = eaAlfa;

     nGrupo  = 4;  nSubGrupo = 17;   |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539007#13 = eaAlfa;
     enNume  = #dsm39002#11;  |HAZ Conver17;  #t1539007#14 = eaAlfa;

     nGrupo  = 4;  nSubGrupo = 18;   |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539007#15 = eaAlfa;
     enNume  = #dsm39002#11;  |HAZ Conver17;  #t1539007#16 = eaAlfa;

     |GRABA 020#t1539007.a;
     |LIBERA #t1539007;
|FPRC;

|PROCESO Registro6_18;
     |DDEFECTO #t1839006;

     |SI #dsm39001#55 = 0;  |Y #dsm39001#56 = 0;
      |Y #dsm39001#57 = 0;  |Y #dsm39001#58 = 0;
      |Y #dsm39001#59 = 0;
         enNume  = #dsm39001#109; |HAZ Conver17;  #t1839006#6  = eaAlfa;
         enNume  = #dsm39001#53;  |HAZ Conver17;  #t1839006#7  = eaAlfa;
         enNume  = #dsm39001#110; |HAZ Conver17;  #t1839006#8  = eaAlfa;
         enNume  = #dsm39001#54;  |HAZ Conver17;  #t1839006#9  = eaAlfa;
         enNume  = #dsm39001#6;   |HAZ Conver17;  #t1839006#10 = eaAlfa;
     |SINO;
         enNume  = #dsm39001#55 * 100;            #t1839006#11 = ("00000" + enNume) % -105;
         enNume  = #dsm39001#56 * 100;            #t1839006#12 = ("00000" + enNume) % -105;
         enNume  = #dsm39001#57 * 100;            #t1839006#13 = ("00000" + enNume) % -105;
         enNume  = #dsm39001#58 * 100;            #t1839006#14 = ("00000" + enNume) % -105;
         enNume  = #dsm39001#59 * 100;            #t1839006#15 = ("00000" + enNume) % -105;

         enNume  = #dsm39001#111; |HAZ Conver17;  #t1839006#16 = eaAlfa;
         enNume  = #dsm39001#60;  |HAZ Conver17;  #t1839006#17 = eaAlfa;
         enNume  = #dsm39001#61;  |HAZ Conver17;  #t1839006#18 = eaAlfa;
         enNume  = #dsm39001#112; |HAZ Conver17;  #t1839006#19 = eaAlfa;
         enNume  = #dsm39001#62;  |HAZ Conver17;  #t1839006#20 = eaAlfa;
         enNume  = #dsm39001#7;   |HAZ Conver17;  #t1839006#21 = eaAlfa;
     |FINSI;

     enNume  = #dsm39001#8;   |HAZ Conver17;  #t1839006#22 = eaAlfa;
     enNume  = #dsm39001#9;   |HAZ Conver17;  #t1839006#23 = eaAlfa;
     enNume  = #dsm39001#100; |HAZ Conver17;  #t1839006#24 = eaAlfa;
     enNume  = #dsm39001#10;  |HAZ Conver17;  #t1839006#25 = eaAlfa;
     enNume  = #dsm39001#11;  |HAZ Conver17;  #t1839006#26 = eaAlfa;
     enNume  = #dsm39001#114; |HAZ Conver17;  #t1839006#27 = eaAlfa;

     enNume  = #dsm39001#101; |HAZ Conver17;  #t1839006#28 = eaAlfa;
     enNume  = #dsm39001#102; |HAZ Conver17;  #t1839006#29 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 1;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1839006#30 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 17;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1839006#31 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 9;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;
     nGrupo  = 3;  nSubGrupo = 16;  |HAZ LeeDSM39002;
     enNume  = enNume + #dsm39002#10;  |HAZ Conver17;  #t1839006#32 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 10;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;
     nGrupo  = 3;  nSubGrupo = 11;  |HAZ LeeDSM39002;
     enNume  = enNume + #dsm39002#10;  |HAZ Conver17;  #t1839006#33 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 12;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1839006#34 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 4;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1839006#35 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 7;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1839006#36 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 2;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1839006#37 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 3;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1839006#38 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 8;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1839006#39 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 5;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1839006#40 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 6;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1839006#41 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 13;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1839006#42 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 14;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1839006#43 = eaAlfa;

     enNume  = #dsm39001#12;  |HAZ Conver17;  #t1839006#44 = eaAlfa;
|FPRC;

|PROCESO dsm39003;
     nConta = nConta + 1;

     #t1539005#0 = (nConta / 2) ! 0;
     |LEE 101#t1539005.=;
     |SI FSalida ! 0;
         |DDEFECTO #t1539005;
         #t1539005#0 = (nConta / 2) ! 0;

         |SI #t1539005#0 > 1;  #t1539005#5 = "C";  |FINSI;

         |GRABA 020#t1539005.b;
     |FINSI;

     nFila = nConta $ 2;

                     nCas = 6;
     |SI nFila = 0;  nCas = 30;  |FINSI;

                                                               #t1539005#nCas# = #dsm39003#5;
     nCas = nCas + 1;  enNume  = #dsm39003#6;  |HAZ Conver10;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#7;  |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#8;  |HAZ Conver10;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#9;  |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#10; |HAZ Conver10;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#11; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#12; |HAZ Conver10;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#13; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#14; |HAZ Conver10;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#15; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#16; |HAZ Conver10;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#17; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#18; |HAZ Conver10;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#19; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;

     nCas = nCas + 1;  enNume  = #dsm39003#20; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#33; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#21; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#22 * 100;           aAlfa           = ("000" + enNume) % -103;
                                                               #t1539005#nCas# = aAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#23; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#24 * 100;           aAlfa           = ("00000" + enNume) % -105;
                                                               #t1539005#nCas# = aAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#25; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#26; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#27; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;

     |GRABA 020#t1539005.a;
     |LIBERA #t1539005;
|FPRC;

|DEFBUCLE dsm39003;
     #dsm39003#1;
     ;
     #dsm39001#0, #dsm39001#1, #dsm39001#2, #dsm39001#3, 01;
     #dsm39001#0, #dsm39001#1, #dsm39001#2, #dsm39001#3, 99;
     ;
     NULL, dsm39003;
|FIN;

|PROCESO Registro5;
     nConta = 0;
     |BUCLE dsm39003;

     |SI #dsm39001#44 = 0;  |Y #dsm39001#45 = 0;  |Y #dsm39001#49 = 0;
      |Y #dsm39001#52 = 0;  |Y #dsm39001#5  = 0;
         |ACABA;
     |FINSI;

     #t1539005#0 = 1;
     |LEE 101#t1539005.=;
     |SI FSalida ! 0;
         |DDEFECTO #t1539005;
         #t1539005#0 = 1;
         |GRABA 020#t1539005.b;
     |FINSI;

                                              #t1539005#54 = ("00" + #dsm39001#14) % -102;
     enNume  = #dsm39001#15;  |HAZ Conver17;  #t1539005#55 = eaAlfa;
     enNume  = #dsm39001#16 * 100000;         #t1539005#56 = ("000000" + enNume) % -106;
     enNume  = #dsm39001#17;  |HAZ Conver17;  #t1539005#57 = eaAlfa;
     enNume  = #dsm39001#18;  |HAZ Conver17;  #t1539005#58 = eaAlfa;
     enNume  = #dsm39001#19;  |HAZ Conver17;  #t1539005#59 = eaAlfa;

                                              #t1539005#60 = ("00" + #dsm39001#20) % -102;
     enNume  = #dsm39001#21;  |HAZ Conver17;  #t1539005#61 = eaAlfa;
     enNume  = #dsm39001#22 * 100000;         #t1539005#62 = ("000000" + enNume) % -106;
     enNume  = #dsm39001#23;  |HAZ Conver17;  #t1539005#63 = eaAlfa;
     enNume  = #dsm39001#24;  |HAZ Conver17;  #t1539005#64 = eaAlfa;
     enNume  = #dsm39001#25;  |HAZ Conver17;  #t1539005#65 = eaAlfa;

                                              #t1539005#66 = ("00" + #dsm39001#26) % -102;
     enNume  = #dsm39001#27;  |HAZ Conver17;  #t1539005#67 = eaAlfa;
     enNume  = #dsm39001#28 * 100000;         #t1539005#68 = ("000000" + enNume) % -106;
     enNume  = #dsm39001#29;  |HAZ Conver17;  #t1539005#69 = eaAlfa;
     enNume  = #dsm39001#30;  |HAZ Conver17;  #t1539005#70 = eaAlfa;
     enNume  = #dsm39001#31;  |HAZ Conver17;  #t1539005#71 = eaAlfa;

                                              #t1539005#72 = ("00" + #dsm39001#32) % -102;
     enNume  = #dsm39001#33;  |HAZ Conver17;  #t1539005#73 = eaAlfa;
     enNume  = #dsm39001#34 * 100000;         #t1539005#74 = ("000000" + enNume) % -106;
     enNume  = #dsm39001#35;  |HAZ Conver17;  #t1539005#75 = eaAlfa;
     enNume  = #dsm39001#36;  |HAZ Conver17;  #t1539005#76 = eaAlfa;
     enNume  = #dsm39001#37;  |HAZ Conver17;  #t1539005#77 = eaAlfa;

                                              #t1539005#78 = ("00" + #dsm39001#38) % -102;
     enNume  = #dsm39001#39;  |HAZ Conver17;  #t1539005#79 = eaAlfa;
     enNume  = #dsm39001#40 * 100000;         #t1539005#80 = ("000000" + enNume) % -106;
     enNume  = #dsm39001#41;  |HAZ Conver17;  #t1539005#81 = eaAlfa;
     enNume  = #dsm39001#42;  |HAZ Conver17;  #t1539005#82 = eaAlfa;
     enNume  = #dsm39001#43;  |HAZ Conver17;  #t1539005#83 = eaAlfa;

     enNume  = #dsm39001#44;  |HAZ Conver17;  #t1539005#84 = eaAlfa;
     enNume  = #dsm39001#45;  |HAZ Conver17;  #t1539005#85 = eaAlfa;
     enNume  = #dsm39001#46;  |HAZ Conver17;  #t1539005#86 = eaAlfa;
     enNume  = #dsm39001#47;  |HAZ Conver17;  #t1539005#87 = eaAlfa;
     enNume  = #dsm39001#48;  |HAZ Conver17;  #t1539005#88 = eaAlfa;
     enNume  = #dsm39001#49;  |HAZ Conver17;  #t1539005#89 = eaAlfa;
     enNume  = #dsm39001#50;  |HAZ Conver17;  #t1539005#90 = eaAlfa;
     enNume  = #dsm39001#51;  |HAZ Conver17;  #t1539005#91 = eaAlfa;
     enNume  = #dsm39001#52;  |HAZ Conver17;  #t1539005#92 = eaAlfa;
     enNume  = #dsm39001#5;   |HAZ Conver17;  #t1539005#93 = eaAlfa;

     |GRABA 020#t1539005.a;
     |LIBERA #t1539005;
|FPRC;

|PROCESO MeteIVASop;
     |HAZ LeeDSM39002;

     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #dsm39002#nCampo2# = 4;
               |SI nPag = 3;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1839003#nCas1# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1839003#nCas2# = eaAlfa;
               |FINSI;

               |SI nPag = 4;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1839004#nCas1# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1839004#nCas2# = eaAlfa;
               |FINSI;
           |FINSI;

           |SI #dsm39002#nCampo2# = 10;
               |SI nPag = 3;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1839003#nCas3# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1839003#nCas4# = eaAlfa;
               |FINSI;

               |SI nPag = 4;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1839004#nCas3# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1839004#nCas4# = eaAlfa;
               |FINSI;
           |FINSI;

           |SI #dsm39002#nCampo2# = 21;
               |SI nPag = 3;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1839003#nCas5# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1839003#nCas6# = eaAlfa;
               |FINSI;

               |SI nPag = 4;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1839004#nCas5# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1839004#nCas6# = eaAlfa;
               |FINSI;
           |FINSI;
     |SIGUE;

     |PARA nCampo2 = 27;  |SI nCampo2 [ 33;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #dsm39002#nCampo2# = 4;
               |SI nPag = 3;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1839003#nCas1# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1839003#nCas2# = eaAlfa;
               |FINSI;

               |SI nPag = 4;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1839004#nCas1# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1839004#nCas2# = eaAlfa;
               |FINSI;
           |FINSI;

           |SI #dsm39002#nCampo2# = 10;
               |SI nPag = 3;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1839003#nCas3# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1839003#nCas4# = eaAlfa;
               |FINSI;

               |SI nPag = 4;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1839004#nCas3# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1839004#nCas4# = eaAlfa;
               |FINSI;
           |FINSI;

           |SI #dsm39002#nCampo2# = 21;
               |SI nPag = 3;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1839003#nCas5# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1839003#nCas6# = eaAlfa;
               |FINSI;

               |SI nPag = 4;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1839004#nCas5# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1839004#nCas6# = eaAlfa;
               |FINSI;
           |FINSI;
     |SIGUE;

     |SI nPag = 3;
         enNume  = #dsm39002#10;  |HAZ Conver17;  #t1839003#nCas7# = eaAlfa;
         enNume  = #dsm39002#11;  |HAZ Conver17;  #t1839003#nCas8# = eaAlfa;
     |FINSI;

     |SI nPag = 4;
         enNume  = #dsm39002#10;  |HAZ Conver17;  #t1839004#nCas7# = eaAlfa;
         enNume  = #dsm39002#11;  |HAZ Conver17;  #t1839004#nCas8# = eaAlfa;
     |FINSI;
|FPRC;

|PROCESO MeteBaseCuota;
     |HAZ LeeDSM39002;

     |SI nGrupo = 1;  |Y nSubGrupo = 7;
         nNume1 = #dsm39002#10;  nNume2 = #dsm39002#11;

         nGrupo = 1;  nSubGrupo = 18;
         |HAZ LeeDSM39002;  nNume1 = nNume1 + #dsm39002#10;  nNume2 = nNume2 + #dsm39002#11;

         nGrupo = 1;  nSubGrupo = 19;
         |HAZ LeeDSM39002;  nNume1 = nNume1 + #dsm39002#10;  nNume2 = nNume2 + #dsm39002#11;

         #dsm39002#10 = nNume1;
         #dsm39002#11 = nNume2;
     |FINSI;

     |SI nGrupo = 1;  |Y nSubGrupo = 11;
         nNume1 = #dsm39002#10;  nNume2 = #dsm39002#11;

         nGrupo = 1;  nSubGrupo = 20;
         |HAZ LeeDSM39002;  nNume1 = nNume1 + #dsm39002#10;  nNume2 = nNume2 + #dsm39002#11;

         #dsm39002#10 = nNume1;
         #dsm39002#11 = nNume2;
     |FINSI;

     |SI nGrupo = 2;  |Y nSubGrupo = 8;
         nNume1 = #dsm39002#10;  nNume2 = #dsm39002#11;

         nGrupo = 2;  nSubGrupo = 17;
         |HAZ LeeDSM39002;  nNume1 = nNume1 + #dsm39002#10;  nNume2 = nNume2 + #dsm39002#11;

         #dsm39002#10 = nNume1;
         #dsm39002#11 = nNume2;
     |FINSI;

     |SI nPag = 2;
         enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539002#nCas1# = eaAlfa;
         enNume  = #dsm39002#11;  |HAZ Conver17;  #t1539002#nCas2# = eaAlfa;
     |FINSI;

     |SI nPag = 3;
         enNume  = #dsm39002#10;  |HAZ Conver17;  #t1839003#nCas1# = eaAlfa;
         enNume  = #dsm39002#11;  |HAZ Conver17;  #t1839003#nCas2# = eaAlfa;
     |FINSI;

     |SI nPag = 4;
         enNume  = #dsm39002#10;  |HAZ Conver17;  #t1839004#nCas1# = eaAlfa;
         enNume  = #dsm39002#11;  |HAZ Conver17;  #t1839004#nCas2# = eaAlfa;
     |FINSI;
|FPRC;

|PROCESO MeteCuota;
     |HAZ LeeDSM39002;

     |SI nPag = 2;
         enNume  = #dsm39002#11;  |HAZ Conver17;  #t1539002#nCas1# = eaAlfa;
     |FINSI;

     |SI nPag = 3;
         enNume  = #dsm39002#11;  |HAZ Conver17;  #t1839003#nCas1# = eaAlfa;
     |FINSI;

     |SI nPag = 4;
         enNume  = #dsm39002#11;  |HAZ Conver17;  #t1839004#nCas1# = eaAlfa;
     |FINSI;
|FPRC;

|PROCESO Registro4_18;
     |DDEFECTO #t1839004;

     nPag = 4;

     nGrupo = 2;   nSubGrupo = 7;
     nCas1  = 6;   nCas2     = 7;   |HAZ MeteBaseCuota;

     nGrupo = 2;   nSubGrupo = 18;
     nCas1  = 8;   nCas2     = 9;   |HAZ MeteBaseCuota;

     nGrupo = 2;   nSubGrupo = 8;
     nCas1  = 10;  nCas2     = 11;  |HAZ MeteBaseCuota;

     nGrupo = 2;   nSubGrupo = 16;
     nCas1  = 12;  nCas2     = 13;  |HAZ MeteBaseCuota;

     nGrupo = 2;   nSubGrupo = 9;
     nCas1  = 14;                   |HAZ MeteCuota;

     nGrupo = 2;   nSubGrupo = 10;
     nCas1  = 15;                   |HAZ MeteCuota;

     nGrupo = 2;   nSubGrupo = 12;
     nCas1  = 16;                   |HAZ MeteCuota;

     enNume  = #dsm39001#4;  |HAZ Conver17;  #t1839004#17 = eaAlfa;
|FPRC;

|PROCESO Registro3_18;
     |DDEFECTO #t1839003;

     nPag = 3;

     nGrupo = 2;   nSubGrupo = 1;
     nCas1  = 6;   nCas2     = 7;
     nCas3  = 8;   nCas4     = 9;
     nCas5  = 10;  nCas6     = 11;
     nCas7  = 12;  nCas8     = 13;  |HAZ MeteIVASop;

     nGrupo = 2;   nSubGrupo = 14;
     nCas1  = 14;  nCas2     = 15;
     nCas3  = 16;  nCas4     = 17;
     nCas5  = 18;  nCas6     = 19;
     nCas7  = 20;  nCas8     = 21;  |HAZ MeteIVASop;

     nGrupo = 2;   nSubGrupo = 2;
     nCas1  = 22;  nCas2     = 23;
     nCas3  = 24;  nCas4     = 25;
     nCas5  = 26;  nCas6     = 27;
     nCas7  = 28;  nCas8     = 29;  |HAZ MeteIVASop;

     nGrupo = 2;   nSubGrupo = 15;
     nCas1  = 30;  nCas2     = 31;
     nCas3  = 32;  nCas4     = 33;
     nCas5  = 34;  nCas6     = 35;
     nCas7  = 36;  nCas8     = 37;  |HAZ MeteIVASop;

     nGrupo = 2;   nSubGrupo = 3;
     nCas1  = 38;  nCas2     = 39;
     nCas3  = 40;  nCas4     = 41;
     nCas5  = 42;  nCas6     = 43;
     nCas7  = 44;  nCas8     = 45;  |HAZ MeteIVASop;

     nGrupo = 2;   nSubGrupo = 4;
     nCas1  = 46;  nCas2     = 47;
     nCas3  = 48;  nCas4     = 49;
     nCas5  = 50;  nCas6     = 51;
     nCas7  = 52;  nCas8     = 53;  |HAZ MeteIVASop;

     nGrupo = 2;   nSubGrupo = 5;
     nCas1  = 54;  nCas2     = 55;
     nCas3  = 56;  nCas4     = 57;
     nCas5  = 58;  nCas6     = 59;
     nCas7  = 60;  nCas8     = 61;  |HAZ MeteIVASop;

     nGrupo = 2;   nSubGrupo = 6;
     nCas1  = 62;  nCas2     = 63;
     nCas3  = 64;  nCas4     = 65;
     nCas5  = 66;  nCas6     = 67;
     nCas7  = 68;  nCas8     = 69;  |HAZ MeteIVASop;

     nGrupo = 2;   nSubGrupo = 13;
     nCas1  = 70;  nCas2     = 71;
     nCas3  = 72;  nCas4     = 73;
     nCas5  = 74;  nCas6     = 75;
     nCas7  = 76;  nCas8     = 77;  |HAZ MeteIVASop;
|FPRC;

|PROCESO MeteAcumDev;
     |HAZ LeeDSM39002;

     nNume1 = 0;
     nNume1 = 0;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #dsm39002#nCampo1# ! 0; |O #dsm39002#nCampo3# ! 0;
               nNume1  = nNume1 + #dsm39002#nCampo1#;
               nNume2  = nNume2 + #dsm39002#nCampo3#;
           |FINSI;
     |SIGUE;

     |PARA nCampo2 = 27;  |SI nCampo2 [ 33;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #dsm39002#nCampo1# ! 0; |O #dsm39002#nCampo3# ! 0;
               nNume1  = nNume1 + #dsm39002#nCampo1#;
               nNume2  = nNume2 + #dsm39002#nCampo3#;
           |FINSI;
     |SIGUE;

     enNume  = nNume1;  |HAZ Conver17;  #t1539002#nCas1# = eaAlfa;
     enNume  = nNume2;  |HAZ Conver17;  #t1539002#nCas2# = eaAlfa;
|FPRC;

|PROCESO MeteIVADev;
     |HAZ LeeDSM39002;

     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #dsm39002#nCampo2# = 4;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas1# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas2# = eaAlfa;
           |FINSI;

           |SI #dsm39002#nCampo2# = 10;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas3# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas4# = eaAlfa;
           |FINSI;

           |SI #dsm39002#nCampo2# = 21;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas5# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas6# = eaAlfa;
           |FINSI;
     |SIGUE;

     |PARA nCampo2 = 27;  |SI nCampo2 [ 33;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #dsm39002#nCampo2# = 4;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas1# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas2# = eaAlfa;
           |FINSI;

           |SI #dsm39002#nCampo2# = 10;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas3# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas4# = eaAlfa;
           |FINSI;

           |SI #dsm39002#nCampo2# = 21;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas5# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas6# = eaAlfa;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO MeteRECDev;
     |HAZ LeeDSM39002;

     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #dsm39002#nCampo2# = .5;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas1# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas2# = eaAlfa;
           |FINSI;

           |SI #dsm39002#nCampo2# = 1.4;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas3# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas4# = eaAlfa;
           |FINSI;

           |SI #dsm39002#nCampo2# = 5.2;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas5# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas6# = eaAlfa;
           |FINSI;

           |SI #dsm39002#nCampo2# = 1.75;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas7# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas8# = eaAlfa;
           |FINSI;
     |SIGUE;

     |PARA nCampo2 = 27;  |SI nCampo2 [ 33;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #dsm39002#nCampo2# = .5;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas1# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas2# = eaAlfa;
           |FINSI;

           |SI #dsm39002#nCampo2# = 1.4;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas3# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas4# = eaAlfa;
           |FINSI;

           |SI #dsm39002#nCampo2# = 5.2;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas5# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas6# = eaAlfa;
           |FINSI;

           |SI #dsm39002#nCampo2# = 1.75;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas7# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas8# = eaAlfa;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Registro2;
     |DDEFECTO #t1539002;

     nPag = 2;

     nGrupo = 1;   nSubGrupo = 1;
     nCas1  = 6;   nCas2     = 7;
     nCas3  = 8;   nCas4     = 9;
     nCas5  = 10;  nCas6     = 11;  |HAZ MeteIVADev;

     nGrupo = 1;   nSubGrupo = 14;
     nCas1  = 12;  nCas2     = 13;
     nCas3  = 14;  nCas4     = 15;
     nCas5  = 16;  nCas6     = 17;  |HAZ MeteIVADev;

     nGrupo = 1;   nSubGrupo = 16;
     nCas1  = 18;  nCas2     = 19;
     nCas3  = 20;  nCas4     = 21;
     nCas5  = 22;  nCas6     = 23;  |HAZ MeteIVADev;

     nGrupo = 1;   nSubGrupo = 2;
     nCas1  = 24;  nCas2     = 25;
     nCas3  = 26;  nCas4     = 27;
     nCas5  = 28;  nCas6     = 29;  |HAZ MeteIVADev;

     nGrupo = 1;   nSubGrupo = 3;
     nCas1  = 30;  nCas2     = 31;  |HAZ MeteBaseCuota;

     nGrupo = 1;   nSubGrupo = 5;
     nCas1  = 32;  nCas2     = 33;
     nCas3  = 34;  nCas4     = 35;
     nCas5  = 36;  nCas6     = 37;  |HAZ MeteIVADev;

     nGrupo = 1;   nSubGrupo = 15;
     nCas1  = 38;  nCas2     = 39;
     nCas3  = 40;  nCas4     = 41;
     nCas5  = 42;  nCas6     = 43;  |HAZ MeteIVADev;

     nGrupo = 1;   nSubGrupo = 6;
     nCas1  = 44;  nCas2     = 45;  |HAZ MeteAcumDev;

     nGrupo = 1;   nSubGrupo = 7;
     nCas1  = 46;  nCas2     = 47;  |HAZ MeteBaseCuota;

     nGrupo = 1;   nSubGrupo = 17;
     nCas1  = 48;  nCas2     = 49;  |HAZ MeteBaseCuota;

     nGrupo = 1;   nSubGrupo = 8;
     nCas1  = 50;  nCas2     = 51;  |HAZ MeteBaseCuota;

     nGrupo = 1;   nSubGrupo = 9;
     nCas1  = 52;  nCas2     = 53;  |HAZ MeteBaseCuota;

     nGrupo = 1;   nSubGrupo = 10;
     nCas1  = 54;  nCas2     = 55;
     nCas3  = 56;  nCas4     = 57;
     nCas5  = 58;  nCas6     = 59;
     nCas7  = 60;  nCas8     = 61;  |HAZ MeteRECDev;

     nGrupo = 1;   nSubGrupo = 11;
     nCas1  = 62;  nCas2     = 63;  |HAZ MeteBaseCuota;

     nGrupo = 1;   nSubGrupo = 12;
     nCas1  = 64;  nCas2     = 65;  |HAZ MeteBaseCuota;

     nGrupo = 1;   nSubGrupo = 13;
     nCas1  = 66;                   |HAZ MeteCuota;
|FPRC;

|PROCESO BuscaFirmantes;
     #eosclien#0 = #dsm39001#0;
     |LEE 040#eosclien.=;
     |SI FSalida ! 0; |DDEFECTO #eosclien; |FINSI;

     aNifp           = "";
     aNombrep        = "";
     aCallep         = "";
     aNump           = "";
     aEscp           = "";
     aPisop          = "";
     aPuep           = "";
     aPoblap         = "";
     aProvip         = "";
     aCodp           = "";
     aSgp            = "";
     aTlfnop         = "";
     aVacio_20       = "                    ";
     aVacio_16       = "                ";
     aVacio_12       = "            ";
     aVacio_10       = "          ";
     enComuneros     = 0;

     |SELECT #3#eoscomul;
     #eoscomul#0 = #eosclien#0;
     #eoscomul#7 = nAnyoDos;
     #eoscomul#1 = 1;
     #eoscomul#2 = 1;
     |LEE 000#eoscomul.];
     |SI FSalida = 0;  |Y #eoscomul#0 = #eosclien#0;  |Y #eoscomul#7 = nAnyoDos;
         #eosclien#0 = #eoscomul#3;
         |LEE 000#eosclien.=;
         |SI FSalida = 0;
             enComuneros = 1;
             aNifp        = #eosclien#1;
             aNombrep     = #eosclien#2;
             aCallep      = #eosclien#5;
             aNump        = #eosclien#6;
             aEscp        = #eosclien#7;
             aPisop       = #eosclien#8;
             aPuep        = #eosclien#9;
             aPoblap      = #eosclien#13;
             aProvip      = #eosclien#12;
             aCodp        = #eosclien#21;
         |FINSI;
     |FINSI;

     #eosclien#0 = #dsm39001#0;
     |LEE 000#eosclien.=;
     |SI FSalida ! 0; |DDEFECTO #eosclien; |FINSI;

     |SI enComuneros = 0;
         aNifp    = #eosclien#1;
         aNombrep = #eosclien#2;
         aCallep  = #eosclien#5;
         aNump    = #eosclien#6;
         aEscp    = #eosclien#7;
         aPisop   = #eosclien#8;
         aPuep    = #eosclien#9;
         aPoblap  = #eosclien#13;
         aProvip  = #eosclien#12;
         aCodp    = #eosclien#21;
         aSgp     = #eosclien#4;
         aTlfnop  = #eosclien#14;

         |SI #eosclien#24 ! aVacio_20; |O #eosclien#25 ! aVacio_20;
          |O #eosclien#26 ! aVacio_12; |O #eosclien#27 ! aVacio_10; |O #eosclien#28 ! aVacio_16;
             aNifp    = "";
             aNombrep = "";
             aCallep  = "";
             aNump    = "";
             aEscp    = "";
             aPisop   = "";
             aPuep    = "";
             aPoblap  = "";
             aProvip  = "";
             aCodp    = "";
             aSgp     = "";
             aTlfnop  = "";
         |FINSI;

         |SI #eosclien#29 ! aVacio_20; |O #eosclien#30 ! aVacio_20;
          |O #eosclien#31 ! aVacio_12; |O #eosclien#32 ! aVacio_10; |O #eosclien#33 ! aVacio_16;
             aNifp    = "";
             aNombrep = "";
             aCallep  = "";
             aNump    = "";
             aEscp    = "";
             aPisop   = "";
             aPuep    = "";
             aPoblap  = "";
             aProvip  = "";
             aCodp    = "";
             aSgp     = "";
             aTlfnop  = "";
         |FINSI;

         |SI #eosclien#34 ! aVacio_20; |O #eosclien#35 ! aVacio_20;
          |O #eosclien#36 ! aVacio_12; |O #eosclien#37 ! aVacio_10; |O #eosclien#38 ! aVacio_16;
             aNifp    = "";
             aNombrep = "";
             aCallep  = "";
             aNump    = "";
             aEscp    = "";
             aPisop   = "";
             aPuep    = "";
             aPoblap  = "";
             aProvip  = "";
             aCodp    = "";
             aSgp     = "";
             aTlfnop  = "";
        |FINSI;
     |FINSI;
|FPRC;

|PROCESO Registro1_18;
     |DDEFECTO #t1839001;

     |HAZ BuscaFirmantes;

     eaVarDni = #eosclien#1;        |HAZ CalculoDNI;  #t1839001#7  = eaVarDni;
     eaAlfa   = #eosclien#2 % 130;  |HAZ QuitaRaros;  #t1839001#8  = eaAlfa;

     aCaracter  = eaVarDni % 101;
     aAlfa      = aLetrasCif - aCaracter;
     |SI aAlfa  = aLetrasCif;
         #t1839001#9 = ".";
         eaCadena = #eosclien#2;  |HAZ SeparaNombre;

         eaAlfa = eaCadena1;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa % 130;  |QBF aAlfa1;
         eaAlfa = eaCadena2;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa % 130;  |QBF aAlfa2;
         eaAlfa = eaCadena3;  |HAZ QuitaRaros;  aAlfa3 = eaAlfa % 130;  |QBF aAlfa3;

         #t1839001#8 = aAlfa1 + " " + aAlfa2;
         #t1839001#9 = aAlfa3;

    |FINSI;


     #t1839001#10  = #dsm39001#1;

     #t1839001#12 = "0";
     #t1839001#13 = "0";
     #t1839001#14 = "";
     #t1839001#15 = "0";
     #t1839001#16 = "0";
     #t1839001#17 = "0";
     #t1839001#19 = "0";
     #t1839001#20 = "0";
     #t1839001#21 = "0";
     #t1839001#22 = "0";
     #t1839001#23 = "0";
     #t1839001#43 = "0";

     #t1839001#24 = #dsm39001#13;
     eaVarDni     = #dsm39001#97;  |HAZ CalculoDNI;  #t1839001#18 = eaVarDni;

     |SI #dsm39001#98  = "S";  #t1839001#12  = "1";           |FINSI;
     |SI #dsm39001#92  = "S";  #t1839001#13  = "1";           |FINSI;

     #t1839001#14  = #dsm39001#113;

     |SI #dsm39001#94  = "S";  #t1839001#15  = "1";           |FINSI;
     |SI #dsm39001#95  = "S";  #t1839001#16  = "1";           |FINSI;
     |SI #dsm39001#92  = "S";
         |SI #dsm39001#96  = "S";  #t1839001#17  = "1";       |FINSI;
         |SI #dsm39001#96  = "N";  #t1839001#17  = "2";       |FINSI;
     |FINSI;
     |SI #dsm39001#105 = "S";  #t1839001#19  = "1";           |FINSI;
     |SI #dsm39001#105 = "N";  #t1839001#19  = "2";           |FINSI;
     |SI #dsm39001#106 = "S";  #t1839001#20  = "1";           |FINSI;
     |SI #dsm39001#106 = "N";  #t1839001#20  = "2";           |FINSI;
     |SI #dsm39001#107 = "S";  #t1839001#21  = "1";           |FINSI;
     |SI #dsm39001#107 = "N";  #t1839001#21  = "2";           |FINSI;
     |SI #t1839001#24 ! "             ";  #t1839001#22 = "1"; |FINSI;
     |SI #dsm39001#108 = "S";
         #t1839001#22  = "0";
         #t1839001#23  = "1";
     |FINSI;


     |SI #dsm39001#64 = "9999";  #dsm39001#64 = "";  |FINSI;
     |SI #dsm39001#68 = "9999";  #dsm39001#68 = "";  |FINSI;
     |SI #dsm39001#72 = "9999";  #dsm39001#72 = "";  |FINSI;
     |SI #dsm39001#76 = "9999";  #dsm39001#76 = "";  |FINSI;
     |SI #dsm39001#80 = "9999";  #dsm39001#80 = "";  |FINSI;
     |SI #dsm39001#84 = "9999";  #dsm39001#84 = "";  |FINSI;

     eaAlfa   = #dsm39001#65;  |HAZ QuitaRaros; #t1839001#25 = eaAlfa;
                                                #t1839001#26 = #dsm39001#66;
                                                #t1839001#27 = #dsm39001#64;

     eaAlfa   = #dsm39001#69;  |HAZ QuitaRaros; #t1839001#28 = eaAlfa;
                                                #t1839001#29 = #dsm39001#70;
                                                #t1839001#30 = #dsm39001#68;

     eaAlfa   = #dsm39001#73;  |HAZ QuitaRaros; #t1839001#31 = eaAlfa;
                                                #t1839001#32 = #dsm39001#74;
                                                #t1839001#33 = #dsm39001#72;

     eaAlfa   = #dsm39001#77;  |HAZ QuitaRaros; #t1839001#34 = eaAlfa;
                                                #t1839001#35 = #dsm39001#78;
                                                #t1839001#36 = #dsm39001#76;

     eaAlfa   = #dsm39001#81;  |HAZ QuitaRaros; #t1839001#37 = eaAlfa;
                                                #t1839001#38 = #dsm39001#82;
                                                #t1839001#39 = #dsm39001#80;

     eaAlfa   = #dsm39001#85;  |HAZ QuitaRaros; #t1839001#40 = eaAlfa;
                                                #t1839001#41 = #dsm39001#86;
                                                #t1839001#42 = #dsm39001#84;

     |SI #dsm39001#87 = "X";  #t1839001#43  = "1";  |FINSI;

     eaVarDni = #dsm39001#89;  |HAZ CalculoDNI;    #t1839001#44 = eaVarDni;
     eaAlfa   = #dsm39001#90;  |HAZ QuitaRaros;    #t1839001#45 = eaAlfa;

                                                   #t1839001#46 = aNifp;
     eaAlfa  = aNombrep;  |HAZ QuitaRaros;         #t1839001#47 = eaAlfa;
                                                   #t1839001#48 = aSgp;
     eaAlfa  = aCallep;  |HAZ QuitaRaros;          #t1839001#49 = eaAlfa;
                                                   #t1839001#50 = aNump;
                                                   #t1839001#51 = aEscp;
                                                   #t1839001#52 = aPisop;
                                                   #t1839001#53 = aPuep;
                                                   #t1839001#54 = aTlfnop;
     eaAlfa  = aPoblap;  |HAZ QuitaRaros;          #t1839001#55 = eaAlfa;
     eaAlfa  = aProvip;  |HAZ QuitaRaros;          #t1839001#56 = eaAlfa;
                                                   #t1839001#57 = aCodp;

     aAlfa   = #eosclien#24; |QBF aAlfa;
     |SI aAlfa ! ""; aAlfa = aAlfa + " "; |FINSI;
     aAlfa   = aAlfa + #eosclien#25;  eaAlfa  = aAlfa;  |HAZ QuitaRaros;
                                                   #t1839001#58 = eaAlfa;
                                                   #t1839001#59 = #eosclien#26 % 109;
                                                   aAlfa = #eosclien#27; |QBF aAlfa;
                                                   |SI aAlfa ! "";
                                                       #t1839001#60 = (#eosclien#27 % 102) + (#eosclien#27 % 402) + (#eosclien#27 % 704);
                                                   |FINSI;
     eaAlfa  = #eosclien#28 % 112;    |HAZ QuitaRaros;
                                                   #t1839001#61 = eaAlfa;

     aAlfa   = #eosclien#29; |QBF aAlfa;
     |SI aAlfa ! ""; aAlfa = aAlfa + " "; |FINSI;
     aAlfa   = aAlfa + #eosclien#30;  eaAlfa  = aAlfa;  |HAZ QuitaRaros;
                                                   #t1839001#62 = eaAlfa;
                                                   #t1839001#63 = #eosclien#31 % 109;
                                                   aAlfa = #eosclien#32; |QBF aAlfa;
                                                   |SI aAlfa ! "";
                                                        #t1839001#64 = (#eosclien#32 % 102) + (#eosclien#32 % 402) + (#eosclien#32 % 704);
                                                   |FINSI;
     eaAlfa  = #eosclien#33 % 112;    |HAZ QuitaRaros;
                                                   #t1839001#65 = eaAlfa;

     aAlfa   = #eosclien#34; |QBF aAlfa;
     |SI aAlfa ! ""; aAlfa = aAlfa + " "; |FINSI;
     aAlfa   = aAlfa + #eosclien#35;  eaAlfa  = aAlfa;  |HAZ QuitaRaros;
                                                   #t1839001#66 = eaAlfa;
                                                   #t1839001#67 = #eosclien#36 % 109;
                                                   aAlfa = #eosclien#37; |QBF aAlfa;
                                                   |SI aAlfa ! "";
                                                       #t1839001#68 = (#eosclien#37 % 102) + (#eosclien#37 % 402) + (#eosclien#37 % 704);
                                                   |FINSI;
     eaAlfa  = #eosclien#38 % 112;  |HAZ QuitaRaros;
                                                   #t1839001#69 = eaAlfa;
|FPRC;

|PROCESO CreaFicPlano;
     aAbre = eaPathEmision + eaFicheroPlano;
     |XABRE "BW", aAbre, nHandle2;

     aAlfa = "<T";                   |XGRABA nHandle2, aAlfa;
     aAlfa = "390";                  |XGRABA nHandle2, aAlfa;
     aAlfa = "0";                    |XGRABA nHandle2, aAlfa;
     aAlfa = #dsmoy000#6;            |XGRABA nHandle2, aAlfa;
     aAlfa = "0A";                   |XGRABA nHandle2, aAlfa;
     aAlfa = "0000>";                |XGRABA nHandle2, aAlfa;
     aAlfa = "<AUX>";                |XGRABA nHandle2, aAlfa;
     aAlfa = " " * 70;               |XGRABA nHandle2, aAlfa;
     aAlfa = eaVersMod;              |XGRABA nHandle2, aAlfa;
     aAlfa = " " * 4;                |XGRABA nHandle2, aAlfa;
     aAlfa = eaNIFDs;                |XGRABA nHandle2, aAlfa;
     aAlfa = " " * 213;              |XGRABA nHandle2, aAlfa;
     aAlfa = "</AUX>";               |XGRABA nHandle2, aAlfa;

     |PARA nCas = 1;  |SI nCas [ 74;  |HACIENDO nCas = nCas + 1;
           aAlfa = #t1839001#nCas#;  |XGRABA nHandle2, aAlfa;
     |SIGUE;

     |PARA nCas = 1;  |SI nCas [ 68;  |HACIENDO nCas = nCas + 1;
           aAlfa = #t1539002#nCas#;  |XGRABA nHandle2, aAlfa;
     |SIGUE;

     |PARA nCas = 1;  |SI nCas [ 79;  |HACIENDO nCas = nCas + 1;
           aAlfa = #t1839003#nCas#;  |XGRABA nHandle2, aAlfa;
     |SIGUE;

     |PARA nCas = 1;  |SI nCas [ 19;  |HACIENDO nCas = nCas + 1;
           aAlfa = #t1839004#nCas#;  |XGRABA nHandle2, aAlfa;
     |SIGUE;

     |LEE 000#t1539005.p;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
          |PARA nCas = 1;  |SI nCas [ 95;  |HACIENDO nCas = nCas + 1;
                aAlfa = #t1539005#nCas#;  |XGRABA nHandle2, aAlfa;
          |SIGUE;

          |LEE 000#t1539005.s;
     |SIGUE;

     |PARA nCas = 1;  |SI nCas [ 46;  |HACIENDO nCas = nCas + 1;
           aAlfa = #t1839006#nCas#;  |XGRABA nHandle2, aAlfa;
     |SIGUE;

     |LEE 000#t1539007.p;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
          |PARA nCas = 1;  |SI nCas [ 48;  |HACIENDO nCas = nCas + 1;
                aAlfa = #t1539007#nCas#;  |XGRABA nHandle2, aAlfa;
          |SIGUE;

          |LEE 000#t1539007.s;
     |SIGUE;

     |SI nHayGrupo = 1;
         |PARA nCas = 1;  |SI nCas [ 61;  |HACIENDO nCas = nCas + 1;
               aAlfa = #t1539008#nCas#;  |XGRABA nHandle2, aAlfa;
         |SIGUE;
     |FINSI;

     aAlfa = "</T";                  |XGRABA nHandle2, aAlfa;
     aAlfa = "390";                  |XGRABA nHandle2, aAlfa;
     aAlfa = "0";                    |XGRABA nHandle2, aAlfa;
     aAlfa = #dsmoy000#6;            |XGRABA nHandle2, aAlfa;
     aAlfa = "0A";                   |XGRABA nHandle2, aAlfa;
     aAlfa = "0000>";                |XGRABA nHandle2, aAlfa;
     |XCIERRA enHandle2;
|FPRC;


|PROCESO  Portal390;
     |ABRE #dsmom004;
     #dsmom004#0  = #dsmow014#0;
     #dsmom004#1  = #dsmow014#1;
     #dsmom004#2  = #dsmow014#2;
     #dsmom004#3  = #dsmow014#5;
     #dsmom004#4  = #dsmow014#7;
     |LEE 040#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #dsmom004;

     |ABRE #dsm39001;
     #dsm39001#0 = #dsmom004#0;
     #dsm39001#1 = #dsmom004#1;
     #dsm39001#2 = #dsmom004#3;
     #dsm39001#3 = #dsmom004#4;
     |LEE 040#dsm39001.=;
     |SI FSalida ! 0;  |CIERRA #dsm39001;  |ACABA;  |FINSI;
     |CIERRA #dsm39001;

     aFicTmp = "t1539005";
     |NOME_DAT #t1539005#aFicTmp#;
     |ABRE #t1539005;  |CIERRA #t1539005;  |DELINDEX #t1539005;

     aFicTmp = "t1539007";
     |NOME_DAT #t1539007#aFicTmp#;
     |ABRE #t1539007;  |CIERRA #t1539007;  |DELINDEX #t1539007;

     |ABRET #t1539005;
     |ABRET #t1539007;

     eaFicheroPlano = "390" + (("00000" + #dsmow014#0) % -105) + ".txt";

     |ABRE #dsm39002;

     |HAZ Registro1_18;
     |HAZ Registro2;
     |HAZ Registro3_18;
     |HAZ Registro4_18;
     |HAZ Registro5;
     |HAZ Registro6_18;
     |HAZ Registro7;
     |HAZ Registro8;

     |CIERRA #dsm39002;

     |HAZ CreaFicPlano;

     |CIERRAT #t1539005;  |DELINDEX #t1539005;
     |CIERRAT #t1539007;  |DELINDEX #t1539007;

     enEmpresa    = #dsmow014#0;
     eaNomEmpresa = #dsmow014#3;

     |HAZ PresentaPortal;
|FPRC;

|DEFBUCLE dsmow014C390;
     #dsmow014#1;
     6;
     00000, 0000, 00, "S";
     99999, 9999, 99, "S";
     ;
     NULL, Portal390;
|FIN;

|DEFBUCLE dsmow014N390;
     #dsmow014#2;
     6;
     "                                        ", "S";
     "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz", "S";
     ;
     NULL, Portal390;
|FIN;

|PROCESO Bloque2015;
     |SI #dsmoy000#6 [ 2016;
         |HAZ Botones2015;
     |FINSI;

     |SI #dsmoy000#6 ] 2017;
         |HAZ Botones2017;
     |FINSI;

     |SI eaOpcion = "0";  enInfComp = 1;  |ACABA;  |FINSI;

     nTecla = 1;

     nSwLee  = 0;
     enTecla = nTecla;

     |ABRET #eosclien;
     |ABRET #eoscomul;

     |SI #dsmoy000#8 = "C";
         |BUCLE dsmow014C390;
     |SINO;
         |BUCLE dsmow014N390;
     |FINSI;

     |CIERRAT #eosclien;
     |CIERRAT #eoscomul;

     |SI eaOpcion = "3";  |Y enPresentar = 0;
         aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
         |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROGRAMA;
     aFichero = ("000" + Usuario) % 108;
     |NOME_DAT #dsmoy000#aFichero#;

     |ABRE #dsmoy000;
     |LEE 000#dsmoy000.p;
     |CIERRA #dsmoy000;

     nAnyoDos = #dsmoy000#6 - 2000;

     aFichero = ("imp" + Usuario) % 108;
     |NOME_DAT #dsmow014#aFichero#;

     |ABRE #dsmoy000;
     |LEE 000#dsmoy000.p;
     |CIERRA #dsmoy000;

     enSwTrata      = 0;
     enCambiaMoneda = 1;

     |HAZ eVersionMod;
     |HAZ Bloque2015;
|FPRO;
