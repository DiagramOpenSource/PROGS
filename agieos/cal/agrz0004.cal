|FICHEROS;
   agrz0004 #0;      || Este Def.
   eoscabve #1;
   eoscabco #2;
|FIN;

|VARIABLES;
   Fichero  = "";
   Fichero1 = "";
   Fichero2 = "";
   VAnyo    = "";
   Fich     = "";
   Pasar    = 0;
|FIN;

|PROGRAMA;
|CLS;
|CABEZA "Preparar Compras-Ventas";
|PINPA #0#0;
|ABRE #0;
|DDEFECTO #0;
|LEE 101#0p;
|SI FSalida ! 0;
    |GRABA 020#0b;
|FINSI;
|PINDA #0#0;
|ENDATOS #1#0;
|SI FSalida = 0;
    |HAZ pasamelo;
    |SI Pasar = 0; |GRABA 020#0a; |SINO; |BORRA 020#0a; |FINSI;
|FINSI;
|LIBERA #0;
|CIERRA #0;
|FPRO;

|PROCESO pasamelo;
Fichero  = #0#0;
Fichero  = "00000" + Fichero;
Fichero  = Fichero % -105;
VAnyo    = #0#1;
VAnyo    = "00" + VAnyo;
VAnyo    = VAnyo % -102;
|DFICE Fich;

|SI #0#2 = "C"; |HAZ CopiaCompra; |FINSI;
|SI #0#2 = "V"; |HAZ CopiaVenta;  |FINSI;
|FPRC;

|PROCESO CopiaCompra;
Fichero = "y" + Fichero + VAnyo;

Fichero2 = Fich + "agrm0014.ixx"
Fichero1 = Fich + Fichero + ".ixx";
|COPIA_FICHERO Fichero1, Fichero2;

Fichero2 = Fich + "agrm0014.dat"
Fichero1 = Fich + Fichero + ".dat";
|COPIA_FICHERO Fichero1, Fichero2;

Fichero2 = Fich + "agrm0014.ddx"
Fichero1 = Fich + Fichero + ".ddx";
|COPIA_FICHERO Fichero1, Fichero2;

Pasar = FSalida;
|SI FSalida ! 0;
    |D_CUADRO 2026, 2257;
    |ATRI R;
    |PINTA 2127, "  EL FICHERO NO EXISTE.       ";
    |ATRI 0;
    |PAUSA;
    |ACABA;
|FINSI;

|AVISO;  |AVISO;  |AVISO;
|FPRC;

|PROCESO CopiaVenta;
Fichero = "z" + Fichero + VAnyo;

Fichero2 = Fich + "agrm0013.ixx"
Fichero1 = Fich + Fichero + ".ixx";
|COPIA_FICHERO Fichero1, Fichero2;

Fichero2 = Fich + "agrm0013.dat"
Fichero1 = Fich + Fichero + ".dat";
|COPIA_FICHERO Fichero1, Fichero2;

Fichero2 = Fich + "agrm0013.ddx"
Fichero1 = Fich + Fichero + ".ddx";
|COPIA_FICHERO Fichero1, Fichero2;

Pasar = FSalida;
|SI FSalida ! 0;
    |D_CUADRO 2026, 2257;
    |ATRI R;
    |PINTA 2127, "  EL FICHERO NO EXISTE.       ";
    |ATRI 0;
    |PAUSA;
    |ACABA;
|FINSI;

|AVISO;  |AVISO;  |AVISO;
|D_CUADRO 2026, 2257;
|ATRI R;
|PINTA 2127, "  EL FICHERO YA ESTA COPIADO  ";
|ATRI 0;
|PAUSA;
|FPRC;
