|FICHEROS;
     agrz0001 #0;            || Este Def
     eosclien #1;            || Fichero de Clientes
     agrm0013 #13,MANTE;     || Libro de Ingresos
     eosclpre #3;            || Clientes Proveedores Empresas
     eosclipr #4;            || Clientes Proveedores General
     eosactiv #5;            || Fichero de Actividades
     eosutili #7;            || Pantalla de Fechas
     agrm0002 #8,MANTE;      || Fichero de Conceptos

     eosaplic #96;           || Control de la Aplicacion
     :/agicli/def/agicontr #97;           || Control Agicli

     agrw0003 #100,MANTE;    || Fichero de Trabajo
     agrw0002 #98,MANTE;     || Fichero de Trabajo
     agrw0001 #99,MANTE;     || Fichero de Trabajo

     eosw0093 #1000,MANTE;
|FIN;

|VARIABLES;
     &VEmpresa     = 0;
     &VAnyo        = 0;
     &VVInstala    = 0;
     &Modo         = 0;
     &EsteModo     = 0;
     &VBas         = 0;
     &VIva         = 0;
     &VRec         = 0;
     &VRet         = 0;
     &VFac         = 0;

     Fichero       = "";
     VAlfa         = "";
     Cliente       = 0;
     SwCif         = 0;
     FSfuncion     = 0;
     Tecla         = "";
     Funcion1      = "823";
     Funcion2      = "824";
     Funcion3      = "825";
     Funcion4      = "826";

     Cli           = 0;
     Fec           = "";
     Con           = 0;
     Des           = "";
     Serie         = "";
     Factura       = 0;
     Trimestre     = 0;
     VActivi       = 0;
     Descrip       = "";
     Forma         = 0;
     VarDia        = 0;
     VarMes        = 0;
     Varalfa       = "";
     Varalfa1      = "";
     Varalfa2      = "";
     Fecha         = "";
     SwNif         = 0;
     DAgicli       = "";
     PAgicli       = "";
     VIvaSiNo1     = "";
     VIvaSiNo2     = "";
     VIvaSiNo3     = "";
     VIvaSiNo4     = "";
     VIvaSiNo5     = "";
     VIvaSiNo6     = "";

     Campo1        = 0;
     Campo2        = 0;
     Campo3        = 0;
     Campo4        = 0;
     Campo5        = 0;
     Campo6        = 0;
     Campo7        = 0;
     Campo8        = 0;
     Campo9        = 0;
     CampoC        = 0;

     CampoBase     = 0;
     CampoIva1     = 0;
     CampoIva2     = 0;
     CampoRec1     = 0;
     CampoRec2     = 0;
     CampoRet1     = 0;
     CampoRet2     = 0;
     CampoConc     = 0;
     CampoNConc    = 0;
     CampoLine     = 0;
     LaBase        = 0;
     ElIva         = 0;
     ElRec         = 0;
     ElRet         = 0;
     CampoModi     = 0;
     UnidAnt       = 0;
     PrecAnt       = 0;

     letra1        = "";
     letra2        = "";
     letra3        = "";
     letra4        = "";
     letra5        = "";
     letra6        = "";
     letra7        = "";
     letra8        = "";
     xx            = "";
     manolo1       = 0;
     manolo2       = 0;
     manolo3       = 0;
     manolo4       = 0;
     manolo5       = 0;

     aNifQbf1   = "";
     aNifQbf2   = "";

     &eaVarDni  = "";
     &enCalcCif = 0;

 {-1}ValFec        = 0;
     ValFec1       = 31;
     ValFec2       = 29;
     ValFec3       = 31;
     ValFec4       = 30;
     ValFec5       = 31;
     ValFec6       = 30;
     ValFec7       = 31;
     ValFec8       = 31;
     ValFec9       = 30;
     ValFec10      = 31;
     ValFec11      = 30;
     ValFec12      = 31;
|FIN;

|INCLUYE i_consul;

|RUTINA ClaveBaja13;
#13#0  = VEmpresa;
#13#14 = VAnyo;
#13#1  = 1;
|FRUT;

|RUTINA ClaveAlta13;
#13#0  = VEmpresa;
#13#14 = VAnyo;
#13#1  = 32000;
|FRUT;

|PROGRAMA;
VAlfa   = VEmpresa;
VAlfa   = ("00000" + VAlfa) % -105;
Fichero = VAlfa;
VAlfa   = VAnyo;
VAlfa   = ("00" + VAlfa) % -102;
Fichero = "z" + Fichero + VAlfa;
|NOME_DAT #13 Fichero;

|HAZ DeDonde;
|SI Modo < 3; |HAZ PideFech; |FINSI;

#0#0 = VBas;
#0#1 = VIva;
#0#2 = VRec;
#0#3 = VRet;
#0#4 = VFac;

|PINPA #0#0;
|PINDA #0#0;

|SI Modo = 1; |ENTLINEAL #1#13, 3, 1, 22, 0, ClaveBaja13, ClaveAlta13; |FINSI;
|SI Modo = 2; |ENTLINEAL #1#13, 3, 2, 22, 0, ClaveBaja13, ClaveAlta13; |FINSI;
|SI Modo = 4; |ENTLINEAL #1#13, 3, 4, 22, 0, ClaveBaja13, ClaveAlta13; |FINSI;

VBas = #0#0;
VIva = #0#1;
VRec = #0#2;
VRet = #0#3;
VFac = #0#4;
|FPRO;

|PROCESO DeDonde; |TIPO 8;
|ABRE #96;
|LEE 040#96p;
|SI FSalida ! 0; |DDEFECTO #96; |FINSI;
|CIERRA #96;

|DBASS DAgicli;
|PATH_DAT #97 DAgicli;

|SI #96#11 = 1; |ACABA; |FINSI;

|ABRE #97;
|LEE 040#97p;
|SI FSalida ! 0; |CIERRA #97; |ACABA; |FINSI;
|CIERRA #97;

DAgicli = #97#8; |QBF DAgicli;
|SI DAgicli = "*"; |ACABA; |FINSI;
PAgicli = (DAgicli - "fich/") + "pan/";

|PATH_DAT #4 DAgicli;
|PATH_PAN #4 PAgicli;
|FPRC;

|PROCESO AltaMod; |TIPO 0;
Forma  = (FEntrada / 100) ! 0;
|SI Forma ! 1; |ACABA; |FINSI;

#13#3  = Cli;
#13#4  = Fec;
#13#5  = Con;
#13#6  = Des;
#13#15 = Serie;
#13#16 = Factura;
#13#17 = Trimestre;
#13#19 = VActivi;
#13#35 = Descrip;
|FPRC;

|PROCESO Cliente; |TIPO 0;
|ABRE #3;
|SELECT #1#3;
#13#0 = VEmpresa;

#3#0 = #13#0;
#3#1 = #13#3;
#3#2 = 1;
|LEE 040#3=;
|SI FSalida = 0; |Y #3#0 = VEmpresa; |Y #3#2 = 1;
    |SI #13#3 = 0;
        SwNif = 1;
        |C_M #13#12, 1, "S"; |ENCAMPO #12#13;
        |C_M #13#12, 1, "N";
        SwNif = 0;
        |C_M #13#38, 1, "S";
        |SI Forma = 1;  #13#38 = #3#4;  |PINTA #13#38;  |FINSI;
    |SINO;
        |C_M #13#12, 1, "N";  #13#12 = #3#3;  |PINTA #13#12;
        |C_M #13#38, 1, "N";  #13#38 = #3#4;  |PINTA #13#38;
    |FINSI;

    |SI #5#17 ! "N";
       |SI Forma = 1;
           #13#8  = #3#14;
           #13#25 = #3#14;
           #13#26 = #3#14;
           #13#10 = #3#15;
           #13#29 = #3#15;
           #13#30 = #3#15;
           #13#39 = #3#22;
           #13#40 = #3#22;
           #13#41 = #3#22;
       |FINSI;
    |SINO;
       |SI Forma = 1;
           #13#8  = 0; #13#25 = 0; #13#26 = 0; #13#48 = 0; #13#49 = 0; #13#50 = 0;
           #13#10 = 0; #13#29 = 0; #13#30 = 0; #13#54 = 0; #13#55 = 0; #13#56 = 0;
           #13#39 = 0; #13#40 = 0; #13#41 = 0; #13#66 = 0; #13#67 = 0; #13#68 = 0;
       |FINSI;
    |FINSI;
|SINO;
    |MENAV "    No existe Cliente con ese codigo";
    |ERROR;
|FINSI;
|CIERRA #3;
|FPRC;

|PROCESO FechClav; |TIPO 0;
ValFec1  = 31; ValFec2  = 29; ValFec3  = 31;
ValFec4  = 30; ValFec5  = 31; ValFec6  = 30;
ValFec7  = 31; ValFec8  = 31; ValFec9  = 30;
ValFec10 = 31; ValFec11 = 30; ValFec12 = 31;

Varalfa = #13Campo;
|SI Varalfa = "    ";
    |MENAV "    Introduzca una Fecha.";
    |ERROR;
|SINO;
    Varalfa1 = Varalfa % 102;
    |QBT Varalfa1;
    Varalfa1 = "00" + Varalfa1;
    Varalfa1 = Varalfa1 % -102;

    Varalfa2 = Varalfa % 302;
    |QBT Varalfa2;
    Varalfa2 = "00" + Varalfa2;
    Varalfa2 = Varalfa2 % -102;

    #13Campo = Varalfa1 + Varalfa2;
    |PINTA #13Campo;

    VarDia = Varalfa1;
    VarMes = Varalfa2;

   |SI VarMes [ 0;|O VarMes > 12;
        |MENAV "     Fecha erronea DD/MM";
        |ERROR;
   |SINO;
        IValFec = ValFec1 <-;
        IValFec = IValFec + VarMes;
        IValFec = IValFec - 1;
        |SI VarDia > ValFec;|O VarDia [ 0;
           |MENAV "     Fecha erronea DD/MM";
           |ERROR;
        |FINSI;
   |FINSI;

   |SI Forma = 1;
      |SI VarMes = 1;|O VarMes = 2;|O VarMes = 3;
          #13#17 = 01; |PINTA #13#17;
      |FINSI;
      |SI VarMes = 4;|O VarMes = 5;|O VarMes = 6;
         #13#17 = 02;  |PINTA #13#17;
      |FINSI;
      |SI VarMes = 7;|O VarMes = 8;|O VarMes = 9;
         #13#17 = 03;  |PINTA #13#17;
      |FINSI;
      |SI VarMes = 10;|O VarMes = 11;|O VarMes = 12;
         #13#17 = 04;  |PINTA #13#17;
      |FINSI;
   |FINSI;
   |SI #0#4 > 80;
       Fecha = Varalfa1 + "." + Varalfa2 + "." + "19" + (("00" + VAnyo) % -102);
   |SINO;
       Fecha = Varalfa1 + "." + Varalfa2 + "." + "20" + (("00" + VAnyo) % -102);
   |FINSI;
    #13#13 = Fecha;
    |SI #13#13 < #7#0; |O #13#13 > #7#1;
        |MENAV "     La fecha introducida no coincide a la seleccionada.";
        |ERROR;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO PintaActividad; |TIPO 7;
|ABRE #5;
#5#0 = #13#0;
#5#1 = #13#19;
#5#2 = #13#14;
|LEE 040#5=;
|SI FSalida ! 0; |DDEFECTO #5; |FINSI;

|ATRI I; |PINTA 1420, #5#6; |ATRI 0;

|CIERRA #5;
|FPRC;

|PROCESO Consuven; |TIPO 11;
|SI FSalida = 9; |O FSalida = 10;
    FSfuncion   = FSalida;
    |SI FSfuncion = 9;  #13#1 = 32000; |PTEC 809; |FINSI;
    |SI FSfuncion = 10; #13#1 = 1;     |PTEC 808; |FINSI;
    |ERROR;
|FINSI;

|SI FSalida = 11;
    EsteModo = (FEntrada / 100) ! 0;
    |SI EsteModo = 1; |ACABA; |FINSI;
    EsteModo = 4;
    |HAZ PantallaDesglose;
    |ERROR;
|FINSI;
|FPRC;

|PROCESO Actualiz; |TIPO 2;
|ABRE #3;
#3#0 = #13#0;
#3#2 = 1;
#3#1 = #13#3;
|LIBERA #3;
|LEE 110#3=;

|ABRE #8;
#8#0 = #13#5;
|LEE 040#8=;
|SI FSalida ! 0; |DDEFECTO #8; |FINSI;
|SI #8#3 = "I"; |O #8#3 = "V";
    #0#0 = #0#0 +. #13#7;
    #0#1 = #0#1 +. #13#9;
    #0#2 = #0#2 +. #13#11;
    #0#3 = #0#3 +. #13#42;
    #0#4 = #0#0 + #0#1 + #0#2 - #0#3;

    |SI #13#9 ! 0; #3#17 = #3#17 +. (#13#7 + #13#9 + #13#11 + #13#42); |FINSI;
    |SI #13#9 = 0; #3#16 = #3#17 +. #13#7;                          |FINSI;
|FINSI;

#8#0 = #13#33;
|LEE 040#8=;
|SI FSalida ! 0; |DDEFECTO #8; |FINSI;
|SI #8#3 = "I"; |O #8#3 = "V";
    #0#0 = #0#0 +. #13#23;
    #0#1 = #0#1 +. #13#27;
    #0#2 = #0#2 +. #13#31;
    #0#3 = #0#3 +. #13#43;
    #0#4 = #0#0 + #0#1 + #0#2 - #0#3;

    |SI #13#9 ! 0; #3#17 = #3#17 +. (#13#23 + #13#27 + #13#31 - #13#43); |FINSI;
    |SI #13#9 = 0; #3#16 = #3#16 +. #13#23;                           |FINSI;
|FINSI;

#8#0 = #13#34;
|LEE 040#8=;
|SI FSalida ! 0; |DDEFECTO #8; |FINSI;
|SI #8#3 = "I"; |O #8#3 = "V";
    #0#0 = #0#0 +. #13#24;
    #0#1 = #0#1 +. #13#28;
    #0#2 = #0#2 +. #13#32;
    #0#3 = #0#3 +. #13#44;
    #0#4 = #0#0 + #0#1 + #0#2 - #0#3;

    |SI #13#9 ! 0; #3#17 = #3#17 +. (#13#24 + #13#28 + #13#32 #13#44); |FINSI;
    |SI #13#9 = 0; #3#16 = #3#16 +. #13#24;                         |FINSI;
|FINSI;

#8#0 = #13#60;
|LEE 040#8=;
|SI FSalida ! 0; |DDEFECTO #8; |FINSI;
|SI #8#3 = "I"; |O #8#3 = "V";
    #0#0 = #0#0 +. #13#45;
    #0#1 = #0#1 +. #13#51;
    #0#2 = #0#2 +. #13#57;
    #0#3 = #0#3 +. #13#69;
    #0#4 = #0#0 + #0#1 + #0#2 - #0#3;

    |SI #13#9 ! 0; #3#17 = #3#17 +. (#13#24 + #13#28 + #13#32 - #13#44); |FINSI;
    |SI #13#9 = 0; #3#16 = #3#16 +. #13#24;                         |FINSI;
|FINSI;

#8#0 = #13#61;
|LEE 040#8=;
|SI FSalida ! 0; |DDEFECTO #8; |FINSI;
|SI #8#3 = "I"; |O #8#3 = "V";
    #0#0 = #0#0 +. #13#46;
    #0#1 = #0#1 +. #13#52;
    #0#2 = #0#2 +. #13#58;
    #0#3 = #0#3 +. #13#70;
    #0#4 = #0#0 + #0#1 + #0#2 - #0#3;

    |SI #13#9 ! 0; #3#17 = #3#17 +. (#13#24 + #13#28 + #13#32 - #13#44); |FINSI;
    |SI #13#9 = 0; #3#16 = #3#16 +. #13#24;                         |FINSI;
|FINSI;

#8#0 = #13#62;
|LEE 040#8=;
|SI FSalida ! 0; |DDEFECTO #8; |FINSI;
|SI #8#3 = "I"; |O #8#3 = "V";
    #0#0 = #0#0 +. #13#47;
    #0#1 = #0#1 +. #13#53;
    #0#2 = #0#2 +. #13#59;
    #0#3 = #0#3 +. #13#71;
    #0#4 = #0#0 + #0#1 + #0#2 - #0#3;

    |SI #13#9 ! 0; #3#17 = #3#17 +. (#13#24 + #13#28 + #13#32 - #13#44); |FINSI;
    |SI #13#9 = 0; #3#16 = #3#16 +. #13#24;                         |FINSI;
|FINSI;

|PINTA #0#0;
|PINTA #0#1;
|PINTA #0#2;
|PINTA #0#4;
|PINTA #0#3;

|GRABA 121#3a;
|CIERRA #3;
|CIERRA #8;

#13#0 = VEmpresa;
|FPRC;

|PROCESO Activida; |TIPO 0;
|ABRE #5;
|SELECT #1#5;
#5#0 = #13#0;
#5#1 = #13#19;
#5#2 = #13#14;
|LEE 040#5=;
|SI FSalida = 0;
    |SI #5#15 = "N";
        |MENAV "     La Actividad no esta preparada para hacer libros";
        |ERROR;
    |FINSI;
    |SI #5#14 = "S";
        |MENAV "     La Actividad es un Comunero";
        |ERROR;
    |FINSI;
    |ATRI I; |PINTA 1420, #5#6; |ATRI 0;
|SINO;
    |MENAV "    Error no existe Actividad";
    |ERROR;
|FINSI;
|CIERRA #5;
|FPRC;

|PROCESO Repetici; |TIPO 3;
Cli       = #13#3;
Fec       = #13#4;
Con       = #13#5;
Des       = #13#6;
Serie     = #13#15;
Factura   = #13#16;
Trimestre = #13#17;
VActivi   = #13#19;
Descrip   = #13#35;
|FPRC;

|PROCESO Consultas; |TIPO 0;
|ET OtraVez;

|C_M #13#3,  1, "S";
|C_M #13#12, 1, "N";
SwCif = 0;

|PUSHV 0501 2380;
|D_CUADRO 0926, 1467;
|ATRI R;
|PINTA 1027, "<F12> Introduccion de Clientes por DNI. ";
|PINTA 1127, "<F2> Consultas de Clientes por C¢digo.  ";
|PINTA 1227, "<F3> Consultas de Clientes por Nombre   ";
|PINTA 1327, "<F4> Consultas de Actividades           ";
|ATRI 0;

Funcion1 = &255 + "823";
Funcion2 = &255 + "824";
Funcion3 = &255 + "825";
Funcion4 = &255 + "826";
|LEETECLA Tecla;
|POPV;

|SI Tecla = Funcion2;
    FSalida = 9;
    Campo10020 = #13#0;
    Campo10022 = 1;
    |HAZ ConsuCliProv;
    #13#3 = Campo10021; |PINTA #13#3;
    |ACABA;
|FINSI;

|SI Tecla = Funcion3;
    FSalida = 10;
    Campo10020 = #13#0;
    Campo10022 = 1;
    |HAZ ConsuCliProv;
    #13#3 = Campo10021; |PINTA #13#3;
    |ACABA;
|FINSI;

|SI Tecla = Funcion4;
    Campo10010 = #13#0;
    Campo10011 = #13#19;
    Campo10012 = #13#14;
    |HAZ ConsuActiv;
    #13#19 = Campo10011; |PINTA #13#19;
    |VETE OtraVez;
|FINSI;

|SI Tecla ! Funcion1; |ACABA; |FINSI;

|C_M #13#3,  1, "N";
|C_M #13#12, 1, "S";
SwCif = 1;
|FPRC;

|PROCESO busca;
Cliente = #3#1;
|FPRC;

|DEFBUCLE Cliente;
#3#1;
;
#13#0, 1, 00001;
#13#0, 1, 99999;
be;
NULL, busca;
|FIN;

|PROCESO ConsulCl; |TIPO 0;
|SI SwCif = 1;
    |ABRE #3;
    |SELECT #3#3;
    #3#0 = #13#0;
    #3#2 = 1;
    #3#3 = #13#12;
    |LEE 040#3=;
    |SI FSalida = 0; |Y #3#0 = #13#0; |Y #3#2 = 1; #3#3 = #13#12;
        #13#3  = #3#1;
        #13#38 = #3#4;
        #13#12 = #3#3;
        |PINTA #13#3;
        |PINTA #13#38;
        |PINTA #13#12;
    |SINO;
        |CIERRA #3;
        |BUCLE Cliente;
        |SI Cliente ! 99999;
            Cliente = Cliente + 1;
            |ABRE #4;
            #4#0 = #13#12;
            |LEE 040#4=;
            |SI FSalida = 0;
                |ABRE #3;
                |SELECT #1#3;
                #3#0  = #13#0;
                #3#1  = Cliente;
                #3#2  = 1;
                #3#3  = #13#12;
                #3#4  = #4#1;
                #3#5  = #4#2;
                #3#6  = #4#3;
                #3#7  = #4#4;
                #3#8  = #4#5;
                #3#9  = #4#6;
                #3#10 = #4#7;
                #3#11 = #4#8;
                #3#12 = #4#9;
                #3#13 = #4#10;
                #3#14 = #4#11;
                #3#15 = #4#12;
                #3#18 = #4#13;
                |GRABA 041#3n;

                #13#3  = #3#1;
                #13#38 = #3#4;
                #13#12 = #3#3;
                |PINTA #13#3;
                |PINTA #13#38;
                |PINTA #13#12;
            |SINO;
                #13#4 = "0101";
                |PTEC 808;
            |FINSI;
        |FINSI;
    |FINSI;
    |CIERRA #3;
|FINSI;
|C_M #13#12, 1, "N";
SwCif = 0;
|FPRC;


|| *************************************************************************
||                         CALCULOS  DE LA PANTALLA DE DESGLOSES
|| *************************************************************************

|PROCESO EntraPantalla; |TIPO 0;
EsteModo = (FEntrada / 100) ! 0;
|HAZ PantallaDesglose;
|FPRC;

|PROCESO PantallaDesglose;
|PUSHV 0501 2380;

|ABRET #8;

|PINPA #0#99;
|PINTA 1003, "Cliente ...:";

|HAZ cargavar;
|HAZ Factura;

VIvaSiNo1 = "";
VIvaSiNo2 = "";
VIvaSiNo3 = "";
VIvaSiNo4 = "";
VIvaSiNo5 = "";
VIvaSiNo6 = "";

|PINDA #0#99;
|SI EsteModo ! 4;
   |SI EsteModo = 1; |ENDATOS #1#99; |FINSI;
   |SI EsteModo = 2; |ENDATOS #2#99; |FINSI;
   |SI FSalida = 0;  |HAZ descarga; |FINSI;
|SINO;
   |PAUSA;
|FINSI;
|PINTA #13#22;
|CIERRAT #8;
|POPV;
|FPRC;

|PROCESO cargavar;
#99#0  = #13#20;
#99#1  = #13#21;
#99#2  = #13#22;
#99#3  = #13#7;   #99#4  = #13#23;  #99#5  = #13#24;
#99#6  = #13#8;   #99#7  = #13#25;  #99#8  = #13#26;
#99#9  = #13#9;   #99#10 = #13#27;  #99#11 = #13#28;
#99#12 = #13#10;  #99#13 = #13#29;  #99#14 = #13#30;
#99#15 = #13#11;  #99#16 = #13#31;  #99#17 = #13#32;
#99#18 = #13#5;   #99#19 = #13#33;  #99#20 = #13#34;
#99#21 = #13#35;  #99#22 = #13#36;  #99#23 = #13#37;
#99#24 = #13#39;  #99#25 = #13#40;  #99#26 = #13#41;
#99#27 = #13#42;  #99#28 = #13#43;  #99#29 = #13#44;
#99#33 = #13#3;   #99#34 = #13#38;
#99#39 = #13#45;  #99#40 = #13#46;  #99#41 = #13#47;
#99#42 = #13#48;  #99#43 = #13#49;  #99#44 = #13#50;
#99#45 = #13#51;  #99#46 = #13#52;  #99#47 = #13#53;
#99#48 = #13#54;  #99#49 = #13#55;  #99#50 = #13#56;
#99#51 = #13#57;  #99#52 = #13#58;  #99#53 = #13#59;
#99#54 = #13#60;  #99#55 = #13#61;  #99#56 = #13#62;
#99#57 = #13#63;  #99#58 = #13#64;  #99#59 = #13#65;
#99#60 = #13#66;  #99#61 = #13#67;  #99#62 = #13#68;
#99#63 = #13#69;  #99#64 = #13#70;  #99#65 = #13#71;
#99#69 = #13#72;  #99#70 = #13#73;  #99#71 = #13#74;  #99#72 = #13#75;
#99#73 = #13#76;  #99#74 = #13#77;  #99#75 = #13#78;  #99#76 = #13#79;
#99#77 = #13#80;  #99#78 = #13#81;  #99#79 = #13#82;  #99#80 = #13#83;
#99#81 = #13#84;  #99#82 = #13#85;  #99#83 = #13#86;  #99#84 = #13#87;
#99#85 = #13#88;  #99#86 = #13#89;  #99#87 = #13#90;  #99#88 = #13#91;
#99#89 = #13#92;  #99#90 = #13#93;  #99#91 = #13#94;  #99#92 = #13#95;
|FPRC;

|PROCESO descarga;
|SI #99#19 = 0;
    #99#4  = 0;
    #99#7  = 0;  #99#10 = 0;
    #99#13 = 0;  #99#16 = 0;
    #99#25 = 0;  #99#28 = 0;
|FINSI;

|SI #99#20 = 0;
    #99#5  = 0;
    #99#8  = 0;  #99#11 = 0;
    #99#14 = 0;  #99#17 = 0;
    #99#26 = 0;  #99#29 = 0;
|FINSI;

|SI #99#54 = 0;
    #99#39 = 0;
    #99#42 = 0;  #99#45 = 0;
    #99#48 = 0;  #99#51 = 0;
    #99#60 = 0;  #99#63 = 0;
|FINSI;

|SI #99#55 = 0;
    #99#40 = 0;
    #99#43 = 0;  #99#46 = 0;
    #99#49 = 0;  #99#52 = 0;
    #99#61 = 0;  #99#64 = 0;
|FINSI;

|SI #99#56 = 0;
    #99#41 = 0;
    #99#44 = 0;  #99#47 = 0;
    #99#50 = 0;  #99#53 = 0;
    #99#62 = 0;  #99#65 = 0;
|FINSI;

#13#20 = #99#0;
#13#21 = #99#1;
#13#22 = #99#2;

#13#7  = #99#3;   #13#23 = #99#4;   #13#24 = #99#5;   || Bases del 1 al 3
#13#45 = #99#39;  #13#46 = #99#40;  #13#47 = #99#41;  || Bases del 4 al 6

#13#8  = #99#6;   #13#25 = #99#7;   #13#26 = #99#8;   || % IVA del 1 al 3
#13#48 = #99#42;  #13#49 = #99#43;  #13#50 = #99#44;  || % IVA del 4 al 6

#13#9  = #99#9;   #13#27 = #99#10;  #13#28 = #99#11;  || T.IVA del 1 al 3
#13#51 = #99#45;  #13#52 = #99#46;  #13#53 = #99#47;  || T.IVA del 4 al 6

#13#10 = #99#12;  #13#29 = #99#13;  #13#30 = #99#14;  || % Rec del 1 al 3
#13#54 = #99#48;  #13#55 = #99#49;  #13#56 = #99#50;  || % Rec del 4 al 6

#13#11 = #99#15;  #13#31 = #99#16;  #13#32 = #99#17;  || T.Rec del 1 al 3
#13#57 = #99#51;  #13#58 = #99#52;  #13#59 = #99#53;  || T.Rec del 4 al 6

#13#5  = #99#18;  #13#33 = #99#19;  #13#34 = #99#20;  || C.Con del 1 al 3
#13#60 = #99#54;  #13#61 = #99#55;  #13#62 = #99#56;  || C.Con del 4 al 6

#13#35 = #99#21;  #13#36 = #99#22;  #13#37 = #99#23;  || D.Con del 1 al 3
#13#63 = #99#57;  #13#64 = #99#58;  #13#65 = #99#59;  || D.Con del 4 al 6

#13#39 = #99#24;  #13#40 = #99#25;  #13#41 = #99#26;  || % Ret del 1 al 3
#13#66 = #99#60;  #13#67 = #99#61;  #13#68 = #99#62;  || % Ret del 4 al 6

#13#42 = #99#27;  #13#43 = #99#28;  #13#44 = #99#29;  || T.Ret del 1 al 3
#13#69 = #99#63;  #13#70 = #99#64;  #13#71 = #99#65;  || T.Ret del 4 al 6

#13#72 = #99#69;  #13#73 = #99#70;  #13#74 = #99#71;  #13#75 = #99#72; || D.Agricolas
#13#76 = #99#73;  #13#77 = #99#74;  #13#78 = #99#75;  #13#79 = #99#76; || D.Agricolas
#13#80 = #99#77;  #13#81 = #99#78;  #13#82 = #99#79;  #13#83 = #99#80; || D.Agricolas
#13#84 = #99#81;  #13#85 = #99#82;  #13#86 = #99#83;  #13#87 = #99#84; || D.Agricolas
#13#88 = #99#85;  #13#89 = #99#86;  #13#90 = #99#87;  #13#91 = #99#88; || D.Agricolas
#13#92 = #99#89;  #13#93 = #99#90;  #13#94 = #99#91;  #13#95 = #99#92; || D.Agricolas
|FPRC;

|PROCESO Englobe; |TIPO 0;
|C_M #99#1, 1, "S";

|SI #99#0 = "N";
    |C_M #99#1, 1, "N";  #99#1 = 1; |PINTA #99#1;
|FINSI;
|FPRC;

|PROCESO Concepto; |TIPO 0;
FSfuncion = FSalida;

#8#0 = #99#18;
|LEE 040#8=;
|SI #8#3 = "V"; |Y Campo ! 18;
    FSfuncion = 2;
    |HAZ Nomodi; |ACABA;
|FINSI;

|SI #99Campo = 0;
    |SI Campo = 18; #99#21 = ""; VIvaSiNo1 = "N"; |HAZ Nomodi; |FINSI;
    |SI Campo = 19; #99#22 = ""; VIvaSiNo2 = "N"; |HAZ Nomodi; |FINSI;
    |SI Campo = 20; #99#23 = ""; VIvaSiNo3 = "N"; |HAZ Nomodi; |FINSI;
    |SI Campo = 54; #99#57 = ""; VIvaSiNo4 = "N"; |HAZ Nomodi; |FINSI;
    |SI Campo = 55; #99#58 = ""; VIvaSiNo5 = "N"; |HAZ Nomodi; |FINSI;
    |SI Campo = 56; #99#59 = ""; VIvaSiNo6 = "N"; |HAZ Nomodi; |FINSI;

    |ACABA;
|FINSI;

#8#0 = #99Campo;
|LEE 040#8=;
|SI FSalida ! 0;
    FSfuncion = 2;
    |MENAV "      El concepto no existe.";
    |ERROR;
    |ACABA;
|FINSI;

|SI Campo = 18;
    #99#21    = #8#1;
    VIvaSiNo1  = #8#2;

    |SI #8#3 = "G";
        FSfuncion = 2;
        |MENAV "      El concepto es de Gasto.";
        |ERROR;
        |ACABA;
    |FINSI;
|FINSI;

|SI Campo     = 19;
    #99#22    = #8#1;
    VIvaSiNo2  = #8#2;

    |SI #8#3 = "G";
        FSfuncion = 2;
        |MENAV "      El concepto es de Gasto.";
        |ERROR;
        |ACABA;
    |FINSI;
|FINSI;

|SI Campo = 20;
    #99#23     = #8#1;
    VIvaSiNo3  = #8#2;

    |SI #8#3 = "G";
        FSfuncion = 2;
        |MENAV "      El concepto es de Gasto.";
        |ERROR;
        |ACABA;
    |FINSI;
|FINSI;

|SI Campo = 54;
    #99#57    = #8#1;
    VIvaSiNo4  = #8#2;

    |SI #8#3 = "G";
        FSfuncion = 2;
        |MENAV "      El concepto es de Gasto.";
        |ERROR;
        |ACABA;
    |FINSI;
|FINSI;

|SI Campo = 55;
    #99#58     = #8#1;
    VIvaSiNo5  = #8#2;

    |SI #8#3 = "G";
        FSfuncion = 2;
        |MENAV "      El concepto es de Gasto.";
        |ERROR;
        |ACABA;
    |FINSI;
|FINSI;

|SI Campo = 56;
    #99#59    = #8#1;
    VIvaSiNo6  = #8#2;

    |SI #8#3 = "G";
        FSfuncion = 2;
        |MENAV "      El concepto es de Gasto.";
        |ERROR;
        |ACABA;
    |FINSI;
|FINSI;

|ATRI I; |PINTA 1319, #8#1; |ATRI i;
|HAZ Nomodi;
|FPRC;

|PROCESO CDAgricola;
|SI Campo2 = 18;
    Campo1 = 1;
    Campo3 = 21;
    Campo4 = 69;
    Campo5 = 70;
    Campo6 = 71;
    Campo7 = 72;
    Campo8 = 3;
|FINSI;

|SI Campo2 = 19;
    Campo1 = 2;
    Campo3 = 22;
    Campo4 = 73;
    Campo5 = 74;
    Campo6 = 75;
    Campo7 = 76;
    Campo8 = 4;
|FINSI;

|SI Campo2 = 20;
    Campo1 = 3;
    Campo3 = 23;
    Campo4 = 77;
    Campo5 = 78;
    Campo6 = 79;
    Campo7 = 80;
    Campo8 = 5;
|FINSI;

|SI Campo2 = 54;
    Campo1 = 4;
    Campo3 = 57;
    Campo4 = 81;
    Campo5 = 82;
    Campo6 = 83;
    Campo7 = 84;
    Campo8 = 39;
|FINSI;

|SI Campo2 = 55;
    Campo1 = 5;
    Campo3 = 58;
    Campo4 = 85;
    Campo5 = 86;
    Campo6 = 87;
    Campo7 = 88;
    Campo8 = 40;
|FINSI;

|SI Campo2 = 56;
    Campo1 = 6;
    Campo3 = 59;
    Campo4 = 89;
    Campo5 = 90;
    Campo6 = 91;
    Campo7 = 92;
    Campo8 = 41;
|FINSI;
|FPRC;

|PROCESO RDAgricola;
|SI Campo2 = 18;
    #99#69 = #98#3;
    #99#70 = #98#4;
    #99#71 = #98#5;
    #99#72 = #98#6;
    #99#3  = #98#7;
|FINSI;

|SI Campo2 = 19;
    #99#73 = #98#3;
    #99#74 = #98#4;
    #99#75 = #98#5;
    #99#76 = #98#6;
    #99#4  = #98#7;
|FINSI;

|SI Campo2 = 20;
    #99#77 = #98#3;
    #99#78 = #98#4;
    #99#79 = #98#5;
    #99#80 = #98#6;
    #99#5  = #98#7;
|FINSI;

|SI Campo2 = 54;
    #99#81 = #98#3;
    #99#82 = #98#4;
    #99#83 = #98#5;
    #99#84 = #98#6;
    #99#39 = #98#7;
|FINSI;

|SI Campo2 = 55;
    #99#85 = #98#3;
    #99#86 = #98#4;
    #99#87 = #98#5;
    #99#88 = #98#6;
    #99#40 = #98#7;
|FINSI;

|SI Campo2 = 56;
    #99#89 = #98#3;
    #99#90 = #98#4;
    #99#91 = #98#5;
    #99#92 = #98#6;
    #99#41 = #98#7;
|FINSI;
|FPRC;

|PROCESO Subvencion; |TIPO 0;
|ET Pide100;
    |PINPA #0#100;
    |PINDA #0#100;
    |ENDATOS #1#100;
    |SI FSalida = 0;
        #99#3  = #100#12;
        #99#69 = #100#0;
        #99#70 = #100#1;
        #99#73 = #100#2;
        #99#74 = #100#3;
        #99#77 = #100#4;
        #99#78 = #100#5;
        #99#81 = #100#6;
        #99#82 = #100#7;
        #99#85 = #100#8;
        #99#86 = #100#9;
        #99#89 = #100#10;
        #99#90 = #100#11;
    |SINO;
        |VETE Pide100;
    |FINSI;
|FPRC;

|PROCESO DAgricola; |TIPO 0;
|SI FSfuncion = 2;  |O FSfuncion = 3; |ACABA; |FINSI;
|SI FSfuncion = 1;  |O FSfuncion = 7; |ACABA; |FINSI;
|SI #99Campo  = 0;                    |ACABA; |FINSI;


Campo2 = Campo;

|SI #8#3 = "V"; |Y Campo2 ! 18;
    |MENAV "     Concepto de Subvenciones. Las subvenciones se introducen en la linea 1.";
    |ERROR;
    |ACABA;
|FINSI;

|SI #8#3 = "V";
    |SI #99#19 ! 0; |O #99#20 ! 0; |O #99#54 ! 0; |O #99#55 ! 0; |O #99#56 ! 0;
        |MENAV "      El Concepto es de Subvenciones, y hay datos en lineas Reservadas";
        |ERROR;
        |ACABA;
    |FINSI;
|FINSI;

|PUSHV 0501 2380;

|SI #8#3 = "V";
    #100#0  = #99#69;
    #100#1  = #99#70;
    #100#2  = #99#73;
    #100#3  = #99#74;
    #100#4  = #99#77;
    #100#5  = #99#78;
    #100#6  = #99#81;
    #100#7  = #99#82;
    #100#8  = #99#85;
    #100#9  = #99#86;
    #100#10 = #99#89;
    #100#11 = #99#90;
    #100#12 = #99#3;

    |HAZ Subvencion;
|SINO;
    |HAZ CDAgricola;
    #98#0 = Campo1;
    #98#1 = #99Campo2;
    #98#2 = #99Campo3;
    #98#3 = #99Campo4;
    #98#4 = #99Campo5;
    #98#5 = #99Campo6;
    #98#6 = #99Campo7;
    #98#7 = #99Campo8;

    |PINPA #0#98;
    |PINDA #0#98;
    |ENDATOS #1#98;
    |SI FSalida = 0;
        |HAZ RDAgricola;
    |FINSI;
|FINSI;
|POPV;
|PINDA #0#99;
|HAZ PintaCon;
|FPRC;

|PROCESO Calculo;
#8#0 = #99CampoConc;
|LEE 040#8=;
|SI FSalida ! 0; |DDEFECTO #8; |FINSI;

#99CampoIva2 = #99CampoBase % #99CampoIva1;
#99CampoRec2 = #99CampoBase % #99CampoRec1;

|SI #8#9 = 1;
    #99CampoRet2 = #99CampoBase % #99CampoRet1;
|SINO;
    #99CampoRet2 = (#99CampoBase + #99CampoIva2 + #99CampoRec2) % #99CampoRet1;
|FINSI;
#99CampoLine = #99CampoBase + #99CampoIva2 + #99CampoRec2 - #99CampoRet2;
|FPRC;

|PROCESO NoModiSub; |TIPO 7;
#8#0 = #99#18;
|LEE 040#8=;
|SI #8#3 = "V";
    |PARA CampoModi = 6; |SI CampoModi [ 32; |HACIENDO CampoModi = CampoModi + 1;
          |C_M #99CampoModi, 1, "N";
    |SIGUE;

    |PARA CampoModi = 42; |SI CampoModi [ 68; |HACIENDO CampoModi = CampoModi + 1;
          |C_M #99CampoModi, 1, "N";
    |SIGUE;
    |C_M #99#18, 1, "S";
|FINSI;
|FPRC;

|PROCESO Nomodi; |TIPO 0;
|SI #8#3 = "V"; |Y Campo ! 18;
    |PARA CampoModi = 6; |SI CampoModi [ 32; |HACIENDO CampoModi = CampoModi + 1;
          |C_M #99CampoModi, 1, "N";
    |SIGUE;

    |PARA CampoModi = 42; |SI CampoModi [ 68; |HACIENDO CampoModi = CampoModi + 1;
          |C_M #99CampoModi, 1, "N";
    |SIGUE;
    |C_M #99#18, 1, "S";
    |ACABA;
|FINSI;

|PARA CampoModi = 6; |SI CampoModi [ 32; |HACIENDO CampoModi = CampoModi + 1;
    |C_M #99CampoModi, 1, "S";
|SIGUE;

|PARA CampoModi = 42; |SI CampoModi [ 68; |HACIENDO CampoModi = CampoModi + 1;
      |C_M #99CampoModi, 1, "S";
|SIGUE;


|SI #99#18 = 0;
    #99#3  = 0;
    #99#71 = 0;
    #99#72 = 0;
|FINSI;

|SI #99#19 = 0;
    #99#4  = 0;
    #99#75 = 0;
    #99#76 = 0;
|FINSI;

|SI #99#20 = 0;
    #99#5  = 0;
    #99#79 = 0;
    #99#80 = 0;
|FINSI;

|SI #99#54 = 0;
    #99#39 = 0;
    #99#83 = 0;
    #99#84 = 0;
|FINSI;

|SI #99#55 = 0;
    #99#40 = 0;
    #99#87 = 0;
    #99#88 = 0;
|FINSI;

|SI #99#56 = 0;
    #99#41 = 0;
    #99#91 = 0;
    #99#92 = 0;
|FINSI;

|SI VIvaSiNo1 = "N";
    |C_M #99#06, 1, "N"; #99#6  = 0;
    |C_M #99#09, 1, "N"; #99#9  = 0;
    |C_M #99#12, 1, "N"; #99#12 = 0;
    |C_M #99#15, 1, "N"; #99#15 = 0;
    |C_M #99#24, 1, "N"; #99#24 = 0;
    |C_M #99#27, 1, "N"; #99#27 = 0;
|FINSI;

|SI VIvaSiNo2 = "N";
    |C_M #99#07, 1, "N"; #99#7  = 0;
    |C_M #99#10, 1, "N"; #99#10 = 0;
    |C_M #99#13, 1, "N"; #99#13 = 0;
    |C_M #99#16, 1, "N"; #99#16 = 0;
    |C_M #99#25, 1, "N"; #99#25 = 0;
    |C_M #99#28, 1, "N"; #99#28 = 0;
|FINSI;

|SI VIvaSiNo3 = "N";
    |C_M #99#08, 1, "N"; #99#8  = 0;
    |C_M #99#11, 1, "N"; #99#11 = 0;
    |C_M #99#14, 1, "N"; #99#14 = 0;
    |C_M #99#17, 1, "N"; #99#17 = 0;
    |C_M #99#26, 1, "N"; #99#26 = 0;
    |C_M #99#29, 1, "N"; #99#29 = 0;
|FINSI;

|SI VIvaSiNo4 = "N";
    |C_M #99#42, 1, "N"; #99#42  = 0;
    |C_M #99#45, 1, "N"; #99#45 = 0;
    |C_M #99#48, 1, "N"; #99#48 = 0;
    |C_M #99#51, 1, "N"; #99#51 = 0;
    |C_M #99#60, 1, "N"; #99#60 = 0;
    |C_M #99#63, 1, "N"; #99#63 = 0;
|FINSI;

|SI VIvaSiNo5 = "N";
    |C_M #99#43, 1, "N"; #99#43 = 0;
    |C_M #99#46, 1, "N"; #99#46 = 0;
    |C_M #99#49, 1, "N"; #99#49 = 0;
    |C_M #99#52, 1, "N"; #99#52 = 0;
    |C_M #99#61, 1, "N"; #99#61 = 0;
    |C_M #99#64, 1, "N"; #99#64 = 0;
|FINSI;

|SI VIvaSiNo6 = "N";
    |C_M #99#44, 1, "N"; #99#44 = 0;
    |C_M #99#47, 1, "N"; #99#47 = 0;
    |C_M #99#50, 1, "N"; #99#50 = 0;
    |C_M #99#53, 1, "N"; #99#53 = 0;
    |C_M #99#62, 1, "N"; #99#62 = 0;
    |C_M #99#65, 1, "N"; #99#65 = 0;
|FINSI;

|SI #5#17 = "N";
   |PARA CampoModi = 6; |SI CampoModi [ 17; |HACIENDO CampoModi = CampoModi + 1;
         |C_M #99CampoModi, 1, "N"; #99CampoModi = 0;
   |SIGUE;

   |PARA CampoModi = 24; |SI CampoModi [ 29; |HACIENDO CampoModi = CampoModi + 1;
         |C_M #99CampoModi, 1, "N"; #99CampoModi = 0;
   |SIGUE;

   |PARA CampoModi = 39; |SI CampoModi [ 53; |HACIENDO CampoModi = CampoModi + 1;
         |C_M #99CampoModi, 1, "N"; #99CampoModi = 0;
   |SIGUE;

   |PARA CampoModi = 60; |SI CampoModi [ 68; |HACIENDO CampoModi = CampoModi + 1;
         |C_M #99CampoModi, 1, "N"; #99CampoModi = 0;
   |SIGUE;
|FINSI;

|SI #5#17 = "I";
   |PARA CampoModi = 6; |SI CampoModi [ 17; |HACIENDO CampoModi = CampoModi + 1;
         |C_M #99CampoModi, 1, "N";
   |SIGUE;

   |PARA CampoModi = 24; |SI CampoModi [ 29; |HACIENDO CampoModi = CampoModi + 1;
         |C_M #99CampoModi, 1, "N";
   |SIGUE;

   |PARA CampoModi = 39; |SI CampoModi [ 53; |HACIENDO CampoModi = CampoModi + 1;
         |C_M #99CampoModi, 1, "N";
   |SIGUE;

   |PARA CampoModi = 60; |SI CampoModi [ 68; |HACIENDO CampoModi = CampoModi + 1;
         |C_M #99CampoModi, 1, "N";
   |SIGUE;
|FINSI;

|SI #5#17 = "R";
    |PARA CampoModi = 24; |SI CampoModi [ 29; |HACIENDO CampoModi = CampoModi + 1;
          |C_M #99CampoModi, 1, "N"; #99CampoModi = 0;
    |SIGUE;

    |PARA CampoModi = 60; |SI CampoModi [ 68; |HACIENDO CampoModi = CampoModi + 1;
          |C_M #99CampoModi, 1, "N"; #99CampoModi = 0;
    |SIGUE;
|FINSI;

|SI #5#17 = "T";
    |PARA CampoModi = 12; |SI CampoModi [ 17; |HACIENDO CampoModi = CampoModi + 1;
          |C_M #99CampoModi, 1, "N"; #99CampoModi = 0;
    |SIGUE;

    |PARA CampoModi = 48; |SI CampoModi [ 53; |HACIENDO CampoModi = CampoModi + 1;
          |C_M #99CampoModi, 1, "N"; #99CampoModi = 0;
    |SIGUE;
|FINSI;

|SI #99#19 = 0; |Y Campo = 19;
    |C_M #99#04, 1, "N"; #99#4  = 0;
    |C_M #99#07, 1, "N"; #99#7  = 0;
    |C_M #99#10, 1, "N"; #99#10 = 0;
    |C_M #99#13, 1, "N"; #99#13 = 0;
    |C_M #99#16, 1, "N"; #99#16 = 0;
    |C_M #99#25, 1, "N"; #99#25 = 0;
    |C_M #99#28, 1, "N"; #99#28 = 0;
|FINSI;

|SI #99#20 = 0; |Y Campo = 20;
    |C_M #99#05, 1, "N"; #99#5  = 0;
    |C_M #99#08, 1, "N"; #99#8  = 0;
    |C_M #99#11, 1, "N"; #99#11 = 0;
    |C_M #99#14, 1, "N"; #99#14 = 0;
    |C_M #99#17, 1, "N"; #99#17 = 0;
    |C_M #99#26, 1, "N"; #99#26 = 0;
    |C_M #99#29, 1, "N"; #99#29 = 0;
|FINSI;

|SI #99#54 = 0; |Y Campo = 54;
    |C_M #99#39, 1, "N"; #99#39 = 0;
    |C_M #99#42, 1, "N"; #99#42  = 0;
    |C_M #99#45, 1, "N"; #99#45 = 0;
    |C_M #99#48, 1, "N"; #99#48 = 0;
    |C_M #99#51, 1, "N"; #99#51 = 0;
    |C_M #99#60, 1, "N"; #99#60 = 0;
    |C_M #99#63, 1, "N"; #99#63 = 0;
|FINSI;

|SI #99#55 = 0; |Y Campo = 55;
    |C_M #99#40, 1, "N"; #99#40 = 0;
    |C_M #99#43, 1, "N"; #99#43 = 0;
    |C_M #99#46, 1, "N"; #99#46 = 0;
    |C_M #99#49, 1, "N"; #99#49 = 0;
    |C_M #99#52, 1, "N"; #99#52 = 0;
    |C_M #99#61, 1, "N"; #99#61 = 0;
    |C_M #99#64, 1, "N"; #99#64 = 0;
|FINSI;

|SI #99#56 = 0; |Y Campo = 56;
    |C_M #99#41, 1, "N"; #99#41 = 0;
    |C_M #99#44, 1, "N"; #99#44 = 0;
    |C_M #99#47, 1, "N"; #99#47 = 0;
    |C_M #99#50, 1, "N"; #99#50 = 0;
    |C_M #99#53, 1, "N"; #99#53 = 0;
    |C_M #99#62, 1, "N"; #99#62 = 0;
    |C_M #99#65, 1, "N"; #99#65 = 0;
|FINSI;

|C_M #99#21, 1, "N";
|C_M #99#22, 1, "N";
|C_M #99#23, 1, "N";
|C_M #99#57, 1, "N";
|C_M #99#58, 1, "N";
|C_M #99#59, 1, "N";

|C_M #99#30, 1, "N";
|C_M #99#31, 1, "N";
|C_M #99#32, 1, "N";
|C_M #99#66, 1, "N";
|C_M #99#67, 1, "N";
|C_M #99#68, 1, "N";

|PINDA #0#99;
|FPRC;

|PROCESO Civas; |TIPO 0;
|SI #5#17 = "I"; |ACABA; |FINSI;

CampoIva1    = Campo - 3;
CampoIva2    = Campo + 3;
#99CampoIva2 = #99CampoIva1 % #99Campo;
|PINTA #99CampoIva2;
|FPRC;

|PROCESO Recargo; |TIPO 0;
|SI #5#17 = "I"; |ACABA; |FINSI;

CampoConc = Campo + 6;
CampoBase = Campo - 9;
CampoRec2 = Campo + 3;

#8#0 = #99CampoConc;
|LEE 040#8=;
|SI FSalida ! 0; |DDEFECTO #8; |FINSI;

#99CampoRec2 = #99CampoBase % #99Campo;
|PINTA #99CampoRec2;
|FPRC;

|PROCESO Retencion; |TIPO 0;
|SI #5#17 = "I"; |ACABA; |FINSI;

CampoConc = Campo - 6;
CampoBase = Campo - 21;
CampoRet2 = Campo + 3;
CampoIva2 = Campo - 15;
CampoRec2 = Campo - 9;

#8#0 = #99CampoConc;
|LEE 040#8=;
|SI FSalida ! 0; |DDEFECTO #8; |FINSI;

|SI #8#9 = 1;
    #99CampoRet2 = #99CampoBase % #99Campo;
|SINO;
    #99CampoRet2 = (#99CampoBase + #99CampoIva2 + #99CampoRec2) % #99Campo;
|FINSI;

|PINTA #99CampoRet2;
|FPRC;

|PROCESO Descompon; |TIPO 0;
|SI FSfuncion = 2;  |O FSfuncion = 3; |ACABA; |FINSI;
|SI #5#17 ! "I";  |ACABA; |FINSI;
|SI #99Campo = 0; |ACABA; |FINSI;

CampoConc = Campo;
CampoBase = Campo - 15;
CampoIva1 = CampoBase + 3;
CampoIva2 = CampoBase + 6;
CampoRec1 = CampoBase + 9;
CampoRec2 = CampoBase + 12;
CampoRet1 = CampoBase + 21;
CampoRet2 = CampoBase + 24;
CampoLine = CampoBase + 27;

|PARA CampoModi = 3; |SI CampoModi [ 32; |HACIENDO CampoModi = CampoModi + 1;
      |C_M #99CampoModi, 1, "N";
|SIGUE;

|C_M #99#18, 1, "S";
|C_M #99#19, 1, "S";
|C_M #99#20, 1, "S";

|PUSHV 0501 2380;
|D_CUADRO 1026, 1554;

#8#0 = #99CampoConc;
|LEE 040#8=;
|SI FSalida ! 0; |DDEFECTO #8; |FINSI;

|SI #8#9 = 1;
    LaBase = #99CampoLine;
|SINO;
    LaBase = #99CampoLine + #99CampoRet2;
|FINSI;

ElIva  = #99CampoIva1;
ElRec  = #99CampoRec1;
ElRet  = #99CampoRet1;

|DDEFECTO #eosw0093;
#eosw0093#0 = LaBase;
#eosw0093#1 = ElIva;
#eosw0093#2 = ElRec;
#eosw0093#3 = ElRet;
|PUSHV 0501 2380;
|PINPA #0#eosw0093;
|PINDA #0#eosw0093;
|ENDATOS #1#eosw0093;
|SI FSalida = 0;
     LaBase = #eosw0093#0;
     ElIva = #eosw0093#1;
     ElRec = #eosw0093#2;
     ElRet = #eosw0093#3;
|FINSI;
|POPV;

/*
|PINTA 1127, "Total Factura :            ";
|PINTA 1227, "% I.V.A. .....:            ";
|PINTA 1327, "% Recargo ....:            ";
|PINTA 1427, "% Retencion  .:            ";


|ATRI I;
|PINTA 1143, LaBase;
|PINTA 1243, ElIva;
|PINTA 1343, ElRec;
|PINTA 1443, ElRet;
|ATRI 0;

|ET Campo1;
    E_inf  = "-99999999";
    E_sup  = "99999999";
    LaBase = 1143 ? 1;
    |SI FSalida = 2; |VETE Campo1; |FINSI;
    |SI FSalida = 1; |O FSalida = 7; |VETE Campo1; |FINSI;

|ET Campo2;
    E_inf = "0";
    E_sup = "99.99";
    ElIva = 1243 ? 1;
    |SI FSalida = 2; |VETE Campo1; |FINSI;
    |SI FSalida = 1; |O FSalida = 7; |VETE Campo2; |FINSI;

|ET Campo3;
    E_inf = "0";
    E_sup = "99.99";
    ElRec = 1343 ? 1;
    |SI FSalida = 2; |VETE Campo2; |FINSI;
    |SI FSalida = 1; |O FSalida = 7; |VETE Campo3; |FINSI;

|ET Campo4;
    E_inf = "0";
    E_sup = "99.99";
    ElRet = 1443 ? 1;
    |SI FSalida = 2; |VETE Campo3; |FINSI;
    |SI FSalida = 1; |O FSalida = 7; |VETE Campo4; |FINSI;
*/

#99CampoBase = LaBase;
#99CampoIva1 = ElIva;
#99CampoRec1 = ElRec;
#99CampoRet1 = ElRet;

|SI #8#9 = 1;
    #99CampoBase = (#99CampoBase * 100) / (#99CampoIva1 + #99CampoRec1 - #99CampoRet1 + 100);
    #99CampoIva2 = (#99CampoBase * #99CampoIva1) / 100;
    #99CampoRec2 = (#99CampoBase * #99CampoRec1) / 100;
    #99CampoRet2 = (#99CampoBase * #99CampoRet1) / 100;
    #99CampoBase = LaBase - (#99CampoIva2 + #99CampoRec2 - #99CampoRet2);
|SINO;
    #99CampoRet2 = (#99CampoBase * #99CampoRet1) / 100;
    #99CampoBase = (#99CampoBase * 100) / (#99CampoIva1 + #99CampoRec1 + 100);
    #99CampoIva2 = (#99CampoBase * #99CampoIva1) / 100;
    #99CampoRec2 = (#99CampoBase * #99CampoRec1) / 100;
    #99CampoBase = LaBase - (#99CampoIva2 + #99CampoRec2);
|FINSI;

|POPV;
|PINDA #0#99;
|FPRC;

|PROCESO Factura; |TIPO 0;
|HAZ PintaCon;

#99#35 =  #99#3  + #99#4  + #99#5  + #99#39 + #99#40 + #99#41;
#99#36 =  #99#9  + #99#10 + #99#11 + #99#45 + #99#46 + #99#47;
#99#37 =  #99#15 + #99#16 + #99#17 + #99#51 + #99#52 + #99#53;
#99#38 =  #99#27 + #99#28 + #99#29 + #99#63 + #99#64 + #99#65;
#99#30 =  #99#3  + #99#9  + #99#15 - #99#27;
#99#31 =  #99#4  + #99#10 + #99#16 - #99#28;
#99#32 =  #99#5  + #99#11 + #99#17 - #99#29;
#99#66 =  #99#39 + #99#45 + #99#51 - #99#63;
#99#67 =  #99#40 + #99#46 + #99#52 - #99#64;
#99#68 =  #99#41 + #99#47 + #99#53 - #99#65;
#99#2  =  #99#35 + #99#36 + #99#37 - #99#38;

|PINTA #99#30;
|PINTA #99#31;
|PINTA #99#32;
|PINTA #99#66;
|PINTA #99#67;
|PINTA #99#68;
|PINTA #99#35;
|PINTA #99#36;
|PINTA #99#37;
|PINTA #99#38;
|PINTA #99#2;
|FPRC;

|PROCESO PintaCon; |TIPO 7;
CampoC = Campo;
|SI Campo = 03; |O Campo = 09; |O Campo = 15; |O Campo = 27; CampoC = 18; |FINSI;
|SI Campo = 04; |O Campo = 10; |O Campo = 16; |O Campo = 28; CampoC = 19; |FINSI;
|SI Campo = 05; |O Campo = 11; |O Campo = 17; |O Campo = 29; CampoC = 20; |FINSI;
|SI Campo = 39; |O Campo = 45; |O Campo = 51; |O Campo = 63; CampoC = 54; |FINSI;
|SI Campo = 40; |O Campo = 46; |O Campo = 52; |O Campo = 64; CampoC = 55; |FINSI;
|SI Campo = 41; |O Campo = 47; |O Campo = 53; |O Campo = 65; CampoC = 56; |FINSI;

#8#0 = #99CampoC;
|LEE 040#8=;
|SI FSalida ! 0; |DDEFECTO #8; |FINSI;

|ATRI I;
|PINTA 1319, #8#1;

|SI CampoC = 18;
    |PINTA 1067, #99#71;
    |PINTA 1167, #99#72;
    |PINTA 1352, #99#69;
    |PINTA 1358, #99#70;
|FINSI;

|SI CampoC = 19;
    |PINTA 1067, #99#75;
    |PINTA 1167, #99#76;
    |PINTA 1352, #99#73;
    |PINTA 1358, #99#74;
|FINSI;

|SI CampoC = 20;
    |PINTA 1067, #99#79;
    |PINTA 1167, #99#80;
    |PINTA 1352, #99#77;
    |PINTA 1358, #99#78;
|FINSI;

|SI CampoC = 54;
    |PINTA 1067, #99#83;
    |PINTA 1167, #99#84;
    |PINTA 1352, #99#81;
    |PINTA 1358, #99#82;
|FINSI;

|SI CampoC = 55;
    |PINTA 1067, #99#87;
    |PINTA 1167, #99#88;
    |PINTA 1352, #99#85;
    |PINTA 1358, #99#86;
|FINSI;

|SI CampoC = 56;
    |PINTA 1067, #99#91;
    |PINTA 1167, #99#92;
    |PINTA 1352, #99#89;
    |PINTA 1358, #99#90;
|FINSI;

|ATRI i;
|FPRC;

|| *************************************
|| PROCESO DEL FICHERO TEMPORAL agrw0002
|| *************************************

|PROCESO NoCultivo;
||  PROCESO DE LAS COMPRAS
||  NO BORRAR PROQUE DARIA ERROR AL COMPILAR
|FPRC;

|PROCESO Cultivo;
|SI #98#3 = 0;
    |MENAV "      Introduzca Cultivo";
    |ERROR;
    |ACABA;
|FINSI;
|FPRC;

|PROCESO Importe;
|SI #98#6 = 0;
    |C_M #98#7, 1, "S";
|SINO;
    |C_M #98#7, 1, "N";
|FINSI;

|SI #98#5 ! 0; |Y #98#6 ! 0;
    #98#7 = #98#5 * #98#6;
|FINSI;
|PINTA #98#7;
|FPRC;

|PROCESO CalculaPrecio;
|SI #98#7 ! 0; |Y #98#6 = 0;
    #98#6 = #98#7 / #98#5;
    |PINTA #98#6;
|FINSI;
|FPRC;

|| *************************
|| PROCESO CALCULO LETRA DNI
|| *************************

|PROCESO LetraApu; |TIPO 6;
  |SI SwCif = 0; |Y SwNif = 0; |ACABA; |FINSI;

     |SI FSalida = 9;
         eaVarDni   = #13Campo;
         enCalcCif  = 1;
         |HAZ CalculoDNI;
         #13Campo = eaVarDni;
         |PINTA #13Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #13Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     aNifQbf1 = #13Campo;   |QBF aNifQbf1;
     aNifQbf2 = eaVarDni;  |QBF aNifQbf2;

     |SI aNifQbf1 ! aNifQbf2; |Y aNifQbf1 ! "";
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #13Campo = eaVarDni;  |PINTA #13Campo;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|| ******************************************************
|| PROCESO DE PEDIR FECHA A FECHA AL EMPEZAR A INTRODUCIR
|| ******************************************************

|PROCESO PideFech; |TIPO 0;
|SI Modo = 1; |O Modo = 2;
   |PUSHV 0501 2380;
   |ABRE #7;
   |PINPA #0#7;

   #7#4 = VAnyo;   |PINTA #7#4;

   |ET pedir;
      VAlfa = #7#0;
      VAlfa = VAlfa % 108;
      VAlfa = VAlfa + VAnyo;
      #7#0 = VAlfa;
      |ENCAMPO #0#7;

      VAlfa = #7#0 % -102;
      |SI VAlfa ! VAnyo;
         |MENAV "    El a¤o no corresponde al seleccionado.";
         |VETE pedir;
      |FINSI;

      VAlfa = #7#1;
      VAlfa = VAlfa % 108;
      VAlfa = VAlfa + VAnyo;
      #7#1 = VAlfa;

   |ET pedir1;
      |ENCAMPO #1#7;

      VAlfa = #7#1 % -102;
      |SI VAlfa ! VAnyo;
         |MENAV "    El a¤o no corresponde al seleccionado.";
         |VETE pedir1;
      |FINSI;

      |SI #7#1 < #7#0;
          |MENAV "    La fecha hasta es menor a la fecha desde";
          |VETE pedir1;
      |FINSI;
   |POPV;
|FINSI;
|FPRC;
