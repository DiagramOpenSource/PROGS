|FICHEROS;
    eoszp021 #0;
    eosirpf1 #1;
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;

    cuantos = 0;
|FIN;
____________________________________/
|PROCESO mayus; |TIPO 0;
    #0Campo = #0Campo > #0Campo;
|PINTA #0Campo;
|FPRC;

|PROCESO defecto; |TIPO 7;
    fech1 = ~;
    alfa1 = fech1;
    alfa1 = alfa1 % -102;
    #0#5 = alfa1;
    #0#5 = #0#5 - 2;
|SI #0#5 < 0;  #0#5 = 100 + #0#5;  |FINSI;
    #0#6 = #0#5 + 1;
|PINTA #0#5;
|PINTA #0#6;
|FPRC;

|PROCESO mismo; |TIPO 0;
|SI FSalida ! 2;
    |SI #0#5 = #0#6;
        |MENAV "    Error de entrada ...";
        |ERROR;
    |FINSI;
|FINSI;
|FPRC;
____________________________________/
|PROCESO duplicando1;
    #1#134 = #0#6;
|LEE 000#1=;
|SI FSalida ! 0;

    |SI #0#8 = "S";  |PDEFECTO #1, 23, 127;  |FINSI;
    |GRABA 020#1n;
    |SI FSalida = 0;
            cuantos = cuantos + 1;
    |FINSI;
|FINSI;

    #1#134 = #0#5;
|LEE 020#1=;        || vuelve a colocar el puntero
|FPRC;

|DEFBUCLE duplicando;
 #1#1;
 ;
 #0#1, #0#3, #0#5;
 #0#2, #0#4, #0#5;
 ;
 NULL, duplicando1;
|FIN;

|PROCESO borra_antes1;
    #1#134 = #0#5;
|LEE 000#1=;
    FEstado = FSalida;

    #1#134 = #0#6;
|LEE 121#1=;

|SI FEstado = 0;         || solo lo borra si existe el origen!!!
    |BORRA 020#1a;
|FINSI;
|LIBERA #1;
|FPRC;

|DEFBUCLE borra_antes;
 #1#1;
 ;
 #0#1, #0#3, #0#6;
 #0#2, #0#4, #0#6;
 ;
 NULL, borra_antes1;
|FIN;

|PROCESO tipo3; |TIPO 3;
|SI #0#0 = "SI";
    |SI #0#7 = "S";
        |BUCLE borra_antes;
    |FINSI;
    |BUCLE duplicando;
        alfa1 = "    Grabados [" + cuantos + "] trabajadores ...";
    |MENAV alfa1;
|FINSI;
|FPRC;
