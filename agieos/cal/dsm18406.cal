|FICHEROS;
     dsm18406;
     dsm18401;
     dsm18431,MANTE;
|FIN;

|VARIABLES;
   &enEmpresa  = 0;
   &enEjer     = 0;
   &eaFichero  = "";
   &enCampo    = 0;
   &eaTabla    = "";
   &enPosicion = 0;
   &eaDestino  = "";
   &enComp     = 0;
   &eaAlfa     = "";
   &enError    = 0;
   &enTotalCas = 0;
   &eaTitulo   = "";
   &enRegimen  = 0;

   nLCod  = 0;
   nLDes  = 0;
   nCalc  = 0;
   nInkey = 0;
   nModo  = 0;
   aAlfa  = "";
   aAlfa1 = "";
   aAlfa2 = "";
|FIN;

|PROCESO SacaActiv; |TIPO 7;
     eaTabla = "ztabla01.txt";
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompActiv;
     |SI FSalida = 10;
         enPosicion = 10;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 101;
         #dsm18406#Campo#  = aAlfa1;
         |PINTA #dsm18406#Campo#;
     |FINSI;

     enComp = 1;
     eaAlfa = #dsm18406#5;

     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |PULSATECLA;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 101;
     aAlfa2   = eaDestino % 360;
     #dsm18406#5     = aAlfa1;
     #dsm18406#15    = aAlfa2;

     |PINTA #dsm18406#5;
     |PINTA #dsm18406#15;

     |HAZ FinTabla;
|FPRC;

|PROCESO SacaEpis; |TIPO 7;
                           eaTabla = "ztabla02.txt";
      |SI #dsm18406#5 = 4; eaTabla = "ztabla04.txt"; |FINSI;
      |SI #dsm18406#5 = 5; eaTabla = "ztabla03.txt"; |FINSI;

      |HAZ CargaTabla;
|FPRC;

|PROCESO CompEpis;  |TIPO 0;
     |SI FSalida = 10;
         enPosicion = 10;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 104;
         #dsm18406#Campo#  = aAlfa1;
         |PINTA #dsm18406#Campo#;
     |FINSI;

     enComp = 4;
     eaAlfa = ("0000" + #dsm18406#6) % -104;

     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |PULSATECLA;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 104;
     aAlfa2   = eaDestino % 660;
     #dsm18406#6     = aAlfa1;
     #dsm18406#16    = aAlfa2;

     |PINTA #dsm18406#6;
     |PINTA #dsm18406#16;

     |HAZ FinTabla;
|FPRC;

|PROCESO PintaTipo;
   |SI #dsm18406#4 = 1; #dsm18406#14 = "Regimen de estimacion directa normal"; |FINSI;
   |SI #dsm18406#4 = 2; #dsm18406#14 = "Regimen de estimacion directa simplificada"; |FINSI;
   |SI #dsm18406#4 = 3; #dsm18406#14 = "Regimen de estimacion objetiva"; |FINSI;
   |PINTA #dsm18406#14;
|FPRC;

|RUTINA inf31;
   #dsm18431#0 = #dsm18406#0;
   #dsm18431#1 = #dsm18406#1;
   #dsm18431#2 = #dsm18406#2;
   #dsm18431#3 = #dsm18406#3;
   #dsm18431#4 = "  ";
   #dsm18431#9 = "N";
|FRUT;

|RUTINA sup31;
   #dsm18431#0 = #dsm18406#0;
   #dsm18431#1 = #dsm18406#1;
   #dsm18431#2 = #dsm18406#2;
   #dsm18431#3 = #dsm18406#3;
   #dsm18431#4 = "zz";
   #dsm18431#9 = "S";
|FRUT;

|PROCESO Recalcula;
     |SI #dsm18431#4 = "ES";
         #dsm18406#7 = #dsm18406#7 + #dsm18431#6;
         #dsm18406#8 = #dsm18406#8 + #dsm18431#7;
         #dsm18406#9 = #dsm18406#9 + #dsm18431#8;

         #dsm18406#17 = #dsm18406#17 + #dsm18431#11;
         #dsm18406#18 = #dsm18406#18 + #dsm18431#12;
         #dsm18406#19 = #dsm18406#19 + #dsm18431#13;
         #dsm18406#20 = #dsm18406#20 + #dsm18431#14;

         #dsm18406#27 = #dsm18406#27 + #dsm18431#16;
         #dsm18406#28 = #dsm18406#28 + #dsm18431#17;
         #dsm18406#29 = #dsm18406#29 + #dsm18431#18;
         #dsm18406#30 = #dsm18406#30 + #dsm18431#19;
         #dsm18406#31 = #dsm18406#31 + #dsm18431#20;
         #dsm18406#32 = #dsm18406#32 + #dsm18431#21;
         #dsm18406#33 = #dsm18406#33 + #dsm18431#22;
     |SINO;
         #dsm18406#10 = #dsm18406#10 + #dsm18431#6;
         #dsm18406#11 = #dsm18406#11 + #dsm18431#7;
         #dsm18406#12 = #dsm18406#12 + #dsm18431#8;

         #dsm18406#21 = #dsm18406#21 + #dsm18431#11;
         #dsm18406#22 = #dsm18406#22 + #dsm18431#12;
         #dsm18406#23 = #dsm18406#23 + #dsm18431#13;
         #dsm18406#24 = #dsm18406#24 + #dsm18431#14;

         #dsm18406#34 = #dsm18406#34 + #dsm18431#16;
         #dsm18406#35 = #dsm18406#35 + #dsm18431#17;
         #dsm18406#36 = #dsm18406#36 + #dsm18431#18;
         #dsm18406#37 = #dsm18406#37 + #dsm18431#19;
         #dsm18406#38 = #dsm18406#38 + #dsm18431#20;
         #dsm18406#39 = #dsm18406#39 + #dsm18431#21;
         #dsm18406#40 = #dsm18406#40 + #dsm18431#22;
     |FINSI;
|FPRC;

|DEFBUCLE Recalcula;
   #dsm18431#1;
   ;
   #dsm18406#0, #dsm18406#1, #dsm18406#2, #dsm18406#3, "  ", " ";
   #dsm18406#0, #dsm18406#1, #dsm18406#2, #dsm18406#3, "zz", "z";
   ;
   NULL,Recalcula;
|FIN;

|PROCESO Tipo1106; |TIPO 11;
      nInkey = FSalida;
      nModo  = (FEntrada / 100) ! 0;
      |SI nInkey = 10;
          |SI nModo > 1;
              enRegimen = #dsm18406#4;
              |PUSHV 0501 2380;
              |ENTLINEAL #1#dsm18431, -5, 4, 20, 1, inf31, sup31;
              |POPV;
          |FINSI;
          |ERROR;
      |FINSI;
|FPRC;

|PROCESO Tipo306; |TIPO 3;
      enRegimen = #dsm18406#4;
      |PUSHV 0501 2380;
      aAlfa1 = "N"; aAlfa2 = "S";
      |SI #dsm18406#1 < 2015;  aAlfa1 = "S"; aAlfa2 = "N"; |FINSI;
      |C_M #dsm18431#7,  1, aAlfa1;
      |C_M #dsm18431#11, 1, aAlfa2;
      |C_M #dsm18431#12, 1, aAlfa2;
      |C_M #dsm18431#13, 1, aAlfa2;
      |C_M #dsm18431#14, 1, aAlfa2;
      |C_M #dsm18431#16, 1, aAlfa2;
      |C_M #dsm18431#17, 1, aAlfa2;
      |C_M #dsm18431#17, 1, aAlfa2;
      |C_M #dsm18431#18, 1, aAlfa2;
      |C_M #dsm18431#19, 1, aAlfa2;
      |C_M #dsm18431#20, 1, aAlfa2;
      |C_M #dsm18431#21, 1, aAlfa2;
      |C_M #dsm18431#22, 1, aAlfa2;
      |SI #dsm18406#4 ! 1; |C_M #dsm18431#22, 1, "N"; |FINSI;

      |ENTLINEAL #1#dsm18431, -5, 2, 20, 1, inf31, sup31;

      #dsm18406#7  = 0; #dsm18406#8  = 0; #dsm18406#9  = 0;
      #dsm18406#10 = 0; #dsm18406#11 = 0; #dsm18406#12 = 0;
      |PDEFECTO #dsm18406, 17, 25;
      |PDEFECTO #dsm18406, 27, 41;

      |BUCLE Recalcula;
      |POPV;
      |PINTA #dsm18406#7;  |PINTA #dsm18406#8;  |PINTA #dsm18406#9;
      |PINTA #dsm18406#10; |PINTA #dsm18406#11; |PINTA #dsm18406#12;
|FPRC;
