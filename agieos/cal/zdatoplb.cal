|FICHEROS;
     refer00@ #0;
|FIN;

|VARIABLES;
     aPrograma    = "";
     aDef         = "";
     aQueQuiero   = "";
     aNombreCampo = "";
     aFichero     = "";

     nCampo       = 0;
     nTCampo      = 0;
     nSwHay       = 0;

     letra      = "";
     alfa       = "";
     alfa1      = "";
     alfa2      = "";
     final      = "";
     x          = "";
     pos1       = "";
     pos2       = "";
     pos3       = "";
     pos4       = "";
     nume1      = 0;
     nume2      = 0;
     lugar      = 0;
     nifnum     = 0;
     resto      = 0;

     &eaCamino       = "";
     aAlfa        = "";
     &enCmpPagina = 0;

     &eaMoneda    = "";
     &enCanti     = 0;
     &enSwTrata   = 0;

     &EURODB      = 0;

     {-1}aMoneda   = "";
         aMoneda1  = "LEER";
         aMoneda2  = "";
|FIN;

|PROCESO PintaMoneda;  |TIPO 7;
     aPrograma = Control;  |QBF aPrograma;

     |DBASE aDef;  |QBF aDef;
     aDef   = aDef + "def/" + aPrograma + ".mas";
     |CARGA_DEF aDef, refer00@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aQueQuiero = "|NC";
     aFichero   = #0#aQueQuiero#;
     nTCampo    = aFichero;
     nTCampo    = nTCampo - 1;
     nSwHay     = 0;
     |PARA nCampo = 0;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero   = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           aNombreCampo = (#0#aQueQuiero# + (" " * 20)) % 120;
           |QBF aNombreCampo;
           |SI aNombreCampo = "***MONEDA***";
               nSwHay = 1;
               |SAL;
           |FINSI;
     |SIGUE;

     |SI nSwHay = 0;
         |DESCARGA_DEF #refer00@;
         |ACABA;
     |FINSI;

     IaMoneda = aMoneda1<-;
     |ESPECIFICA "MODO_VER_EURO", aMoneda;

     |SI EURODB ! 0;
         |SI aMoneda2 = "0";
             #0nCampo = "EUROS";
         |SINO;
             #0nCampo = "PESETAS";
         |FINSI;
     |SINO;
         |SI aMoneda2 = "0";
             #0nCampo = "PESETAS";
         |SINO;
             #0nCampo = "EUROS";
         |FINSI;
     |FINSI;

     |PINTA #0nCampo;
     eaMoneda = #0nCampo;

     |DESCARGA_DEF #refer00@;
|FPRC;

|PROCESO ConverMoneda;
     enCanti = enCanti ! EURODB;
     |SI EURODB ! 0;
         |SI eaMoneda = "PESETAS";
             enCanti = ((enCanti * 166.386) ! 0);
         |SINO;
             |SI enSwTrata = 0;  enCanti = enCanti * 100;  |FINSI;
         |FINSI;
     |SINO;
         |SI eaMoneda = "EUROS  ";
             enCanti = ((enCanti / 166.386) ! 2) * 100;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO PideExplorer;
   |PUSHV 1903 2277;
   |BLANCO 1903 2277;
   |CUADRO 1905 2275;
   |ATRI R; |PINTA 1906 , " Seleccione ubicacion del explorador y pagina "; |ATRI N;
   E_sup  = 50;
   E_inf  = "";
   |PINTA 2006, " Camino explorer : ";
   |PINTA 2106, " Pagina declarac.: "; |PINTA 2125, #Fichero@#enCmpPagina#;
   eaCamino = "c:/Archiv~1/Intern~1/iexplore.exe";
   eaCamino = 2025 ? 0;
   |QBF eaCamino;

   aAlfa = ("000" + enCmpPagina) % -103;
   aAlfa = "|C" + aAlfa + "LONGITUD";
   E_sup = #Fichero@#aAlfa#;
   E_inf  = "";
   aAlfa = #Fichero@#enCmpPagina#;
   aAlfa = 2125 ? 0;
   ||C_P #Fichero@#enCmpPagina#,1,2125; |ENCAMPO #enCmpPagina#Fichero@;
   |QBF aAlfa;
   #Fichero@#enCmpPagina# = aAlfa;
   |POPV;
|FPRC;

|| ************************************************************************
|| ************** RUTINAS PARA LA EDICION DE TABLAS EN TXT ****************
|| ************************************************************************

|VARIABLES;
     nBaffer     = 0;
     nOpcion     = 0;
     nTotalLinea = 0;
     nConta      = 0;
     nCogeOpcion = 0;
     nPos1       = 0;
     nDesde      = 0;
     nHasta      = 0;

     aTabla      = "";
     aAlf        = "";

     &eaDestino  = "";
     &eaTabla    = "";
     &eaAlfa     = "";
     &enError    = 0;
     &enComp     = 0;
     &enPosicion = 0;
|FIN;

|PROCESO CargaTabla;
     |DFICE aTabla;  |QBF aTabla;

     aTabla      = aTabla + eaTabla;
     nOpcion     = 1;
     nTotalLinea = 0;
     nConta      = -1;
     nBaffer     = 0;

     |LEESECUENCIAL aTabla, nBaffer, nTotalLinea, 0, 0;
|FPRC;

|PROCESO SacaTabla;
     |PUSHV 0501 2380;

     |SI nTotalLinea [ 400;
         |PARA; |SI;  |HACIENDO;
              nOpcion = 1;
              |BMENUG nBaffer, 0, 1, nTotalLinea, enPosicion, nOpcion;
              nOpcion     = FSalida;
              nCogeOpcion = nOpcion - 1;
              |SI FSalida [ nTotalLinea; |Y FSalida ] 1;
                  |DEL_BUF nBaffer, nCogeOpcion, eaDestino;

                  |SAL;
             |FINSI;
         |SIGUE;
     |SINO;
         nDesde  = 0;
         nHasta  = 400;
         nOpcion = 1;
         |PARA; |SI;  |HACIENDO;
              |BMENUG nBaffer, nDesde, 1, nHasta, enPosicion, nOpcion;
              nOpcion     = FSalida;

              nCogeOpcion = (nOpcion - 1) + nDesde;
              |SI FSalida [ nTotalLinea; |Y FSalida ] 1;
                  |DEL_BUF nBaffer, nCogeOpcion, eaDestino;

                  aAlf = eaDestino;  |QBT aAlf;
                  |SI aAlf = "Mas...";
                      nDesde  = nDesde + 400;
                      nHasta  = nHasta + 400;
                      nOpcion = 1;
                  |FINSI;

                  |SI aAlf = "Menos...";
                      nDesde  = nDesde - 400;
                      nHasta  = nHasta - 400;
                      nOpcion = 1;
                  |FINSI;

                  |SI aAlf ! "Mas...";  |Y  aAlf ! "Menos...";
                      |SAL;
                  |FINSI;
              |FINSI;
         |SIGUE;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO CompruebaTabla;
     enError = 1;
     nPos1   = 100 + enComp;

     |LEESECUENCIAL aTabla, nBaffer, nTotalLinea, 0, 0;
     |PARA nConta = 0;  |SI nConta [ nTotalLinea;  |HACIENDO nConta = nConta + 1;
         |DEL_BUF nBaffer, nConta, eaDestino;
         aAlf = eaDestino % nPos1;

         |QBF aAlf;
         |QBF eaAlfa;

         |SI aAlf = eaAlfa;  enError = 0;  |SAL;  |FINSI;
     |SIGUE;

     |FINDIM nBaffer;
|FPRC;

|PROCESO FinTabla;
     |FINDIM nBaffer;
|FPRC;
