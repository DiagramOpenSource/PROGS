|FICHEROS;
   eosborr1 #0;
|FIN;

|VARIABLES;
    aRuta        = "";
    aAlfa        = "";
    aAlfa1       = "";
    aFichero     = "";
    nHandle      = 0;

   &empresa     = 0;
   &d_anyo      = 0;
   &h_anyo      = 0;
   &sw_anyo     = 0;

   &QuePrograma = 0;
   &Empresa     = 0;
|FIN;

|PROCESO modifica; |TIPO 0;
|CAMPO_MODIFICA #0#4, 1, "S";

|SI #0#3 = "T";
    |CAMPO_MODIFICA #0#4, 1, "N";
    #0#4 = 0;
    |PINTA #0#4;
|FINSI;
|FPRC;

|PROCESO Tipo3;
    |PINTA 0813, #0#0;
    |PINTA 0821, #0#1;

    |SI #0#3 = "A";
        d_anyo  = #0#4;
        h_anyo  = #0#4;
        sw_anyo = 1;
    |SINO;
        d_anyo = 00;
        h_anyo = 99;
        sw_anyo = 0;
    |FINSI;

    |ATRI P;
    |MENSA "2300 Borrando, esperese por Favor";
    |ATRI 0;

    empresa = #0#0;
    |SUB_EJECUTA "eosborr2";
    |SUB_EJECUTA "eosborr3";
    |SUB_EJECUTA "eosborr4";
    |SUB_EJECUTA "eosborr5";
    |SUB_EJECUTA "eosborr6";
    |SUB_EJECUTA "eosborr7";
    |SUB_EJECUTA "eosborr8";
|FPRC;

|DEFBUCLE eosborr1;
     #0#1;
     ;
     00001;
     99999;
     ;
     NULL, Tipo3;
|FIN;

|RUTINA ClaveBaja0;
     #0#0 = 1;
|FRUT;

|RUTINA ClaveAlta0;
     #0#0 = 99999;
|FRUT;

|PROCESO Tipo11;  |TIPO 11;
     |SI FSalida ! 13;  |ACABA;  |FINSI;

     aRuta = "F";
     |BROWSE aRuta;
     aRuta = aRuta % 299;

     |QBF aRuta;
     |SI aRuta = "";  |ACABA;  |FINSI;

     |XABRE "C", aRuta, nHandle;
     |SI FSalida ] 0;
         |PARA;  |SI;  |HACIENDO;
              |XLEE nHandle, 254, aAlfa;
              |SI FSalida < 0;  |SAL;  |FINSI;
              aAlfa1 = aAlfa % 106;  #0#0 = aAlfa;
              |LEE 101#0=;
              |SI FSalida ! 0;
                  aAlfa1 = aAlfa % 106;  #0#0 = aAlfa1;
                  aAlfa1 = aAlfa % 740;  #0#1 = aAlfa1;
                                         #0#3 = "T";
                  |GRABA 020#0n;
              |FINSI;
              |LIBERA #0;
          |SIGUE;
     |FINSI;
     |XCIERRA nHandle;

     |PTEC 812;
     |PONCONTROL 23, "SI";
|FPRC;

|PROGRAMA;
     aFichero = (Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #0 aFichero;
     |ABRE #0;  |CIERRA #0;  |DELINDEX #0;

     |SI QuePrograma = 0;
         |CLS;
         |CABEZA "Borrado General";
         |ENTLINEAL #1#0, -1, 2, 22, 1, ClaveBaja0, ClaveAlta0;
         |CONFI "    SRealizamos el Borrado ";
         |SI FSalida = 0;
             |BUCLE eosborr1;
         |FINSI;
     |SINO;
         |SI QuePrograma ! 2;
             |CONFI "2400SDesea dar de baja todas las fichas de la Empresa : ";
             |SI FSalida ! 0; |ACABA; |FINSI;
         |FINSI;

         #0#0 = Empresa;
         #0#3 = "T";
         |HAZ Tipo3;
     |FINSI;
|FPRO;
