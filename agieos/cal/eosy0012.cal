|FICHEROS;
     eosy0012 #0;
     eosclien #1;
     eosdaban #2;
     eoshacie #3;
     eosm0014 #14;
     eosm0028 #28;
     eosm0040 #30;
     eosm0044 #34;
     eosw0078 #78;
     eosw0079 #79;
     eosw0080 #80;
     eosw0081 #81,MANTE;
     eosw0043 #104;
     eosm0045 #35;
|FIN;

|VARIABLES;
     nPeriodo     = 0;
     nCampoD      = 0;
     aLLeno40     = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     aVacio40     = "                                        ";
     aAlfa        = "";
     nSwLectura   = 0;
     aCadena      = "";
     ||aCaracter    = "";
     ||aLong        = "";
     ||nLong        = 0;
     nPos         = 0;
     aDComple     = " ";
     aHComple     = "z";
     aFichero     = "";
     nTotalP      = 0;
     nContador    = 0;
     nSwError     = 0;
     aTipoP       = "";
     nNume        = 0;
     nDRegis      = 0;
     nHRegis      = 0;
     nSwDeDonde   = 0;

     &enEmpresa   = 0;
     &enEjercic   = 0;
     &dia         = "";
     &mes         = "";
     &anyo        = "";
     &enTHojas    = 0;
     &ejerc       = 0;

     TotalArrend  = 0;
     TotalRendDin = 0;
     TotalReteDin = 0;
     TotalRendEsp = 0;
     TotalIngACta = 0;

     ConClaveA = 0;
     ConClaveB = 0;
     ComodNum = 0;

     Devengo = 0;
     Nif = 0;

     &ClaveRet = "";
     &NPag = 1;

     &justi1 = 0;
     &justi2 = 0;
     &nomrep = "";

     Comodin = "";
|FIN;

|INCLUYE i_seguim;
|INCLUYE i_consul;

||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| CALCULOS DE LAS PANTALLAS
||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO Parrilla;
     |SI #0#0 = 0;
         #0#0 = 0;  |PINTA #0#0;
         #0#1 = 0;  |PINTA #0#1;  |C_M #0#1, 1, "N";
         |PARA nCampoD = 2;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
               |C_M #0nCampoD, 1, "S";
         |SIGUE;
         |C_M #0#38, 1, "S";
     |SINO;
         |C_M #0#0,  1, "S";
         |C_M #0#1,  1, "S";
         |PARA nCampoD = 2;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
               |C_M #0nCampoD, 1, "N";
               #0nCampoD = 0;  |PINTA #0nCampoD;
         |SIGUE;
         |C_M #0#38, 1, "N";  #0#38 = 0;  |PINTA #0#38;
     |FINSI;
|FPRC;

|PROCESO Planilla;
     |SI #0#38 = 0;  |Y #0#0 = 0;
         |C_M #0#38, 1, "N";  #0#38 = 0;  |PINTA #0#38;
         |PARA nCampoD = 2;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
               |C_M #0nCampoD, 1, "S";
         |SIGUE;
     |SINO;
         |SI #0#0 = 0;
             |C_M #0#38, 1, "S";
             |PARA nCampoD = 2;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
                   |C_M #0nCampoD, 1, "N";
                   #0nCampoD = 0;  |PINTA #0nCampoD;
             |SIGUE;
        |FINSI;
     |FINSI;
|FPRC;

|PROCESO NoMasEmpresas;
     |SI #0Campo = 0;
         |PARA nCampoD = Campo + 1;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
               #0Campo = 0;  |C_M #0nCampoD, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampoD = Campo + 1;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
               |C_M #0nCampoD, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| CALCULOS DE LA EMISION
||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO PrintCertif;
   |ABRE #eosclien;
   #eosclien#0 = #30#0;
   |LEE 010#eosclien.=;
   |CIERRA #eosclien;

   |ABRE #eoshacie;
   #eoshacie#0 = #eosclien#18;
   #eoshacie#1 = #eosclien#19;
   |LEE 010#eoshacie.=;
   |CIERRA #eoshacie;

   |ABRE #eosm0045;
   #eosm0045#0 = #eosm0044#0;
   #eosm0045#1 = #eosm0044#2;
   #eosm0045#4 = #eosm0044#16;
   |LEE 010#eosm0045.=;
   |SI FSalida ! 0;  |DDEFECTO #eosm0045;  |FINSI;
   |CIERRA #eosm0045;

   nomrep = "";
   Comodin = #1#24;
   |QBF Comodin;
   Comodin = Comodin + #1#25;
   |QBF Comodin;
   |SI Comodin ! ""
      nomrep = #1#25;
      |QBF nomrep;
      nomrep = nomrep + " " + #1#24;
   |SINO;
      Comodin = #1#29;
      |QBF Comodin;
      Comodin = Comodin + #1#30;
      |QBF Comodin;
      |SI Comodin ! ""
         nomrep = #1#30;
         |QBF nomrep;
         nomrep = nomrep + " " + #1#29;
      |SINO;
         Comodin = #1#34;
         |QBF Comodin;
         Comodin = Comodin + #1#35;
         |QBF Comodin;
         |SI Comodin ! ""
            nomrep = #1#35;
            |QBF nomrep;
            nomrep = nomrep + " " + #1#34;
         |FINSI;
      |FINSI;
   |FINSI;

   |QBF nomrep;
   |SI nomrep = "";
      nomrep = #1#2;
   |FINSI;

   |PRINT;

   |PIEINF;
|FPRC;

|DEFBUCLE BucleCertif;
     #eosm0044#1;
     ;
     #30#0,#30#1,#eosy0012#43,0000,01;
     #30#0,#30#1,#eosy0012#44,9999,99;
     ;
     NULL,PrintCertif;
|FINSI;

|PROCESO PrintTotal;
   |BUCLE BucleCertif;
   justi1 = justi1 + 1;
   justi2 = justi2 - 1;
   |SI justi2 = -1; justi2 = 6; |FINSI;
|FPRC;

|DEFBUCLE BucleTotal;
     #30#1;
     ;
     #0#0, #0#39;
     #0#1, #0#39;
     ;
     NULL, PrintTotal;
|FIN;

|PROCESO PlanillaImp;
     #30#0 = #14#1;
     #30#1 = #0#39;
     |LEE 040#30=;
     |SI FSalida = 0;
         |BUCLE BucleCertif;

         justi1 = justi1 + 1;
         justi2 = justi2 - 1;
         |SI justi2 = -1; justi2 = 6; |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE BuclePlanilla;
     #14#1;
     ;
     #0#38, 00001;
     #0#38, 99999;
     ;
     NULL, PlanillaImp;
|FIN;

|PROCESO Certif;

     |SI #0#0 = 0;
         |SI #0#38 = 0;
             |PARA nCampoD = Campo + 1;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
                   |SI #0nCampoD ! 0;
                       #30#0 = #0nCampoD;
                       #30#1 = #0#39;
                       |LEE 040#30=;
                       |SI FSalida = 0;
                          |BUCLE BucleCertif;
                          justi1 = justi1 + 1;
                          justi2 = justi2 - 1;
                          |SI justi2 = -1; justi2 = 6; |FINSI;
                       |FINSI;
                   |FINSI;
             |SIGUE;
         |SINO;
             |BUCLE BuclePlanilla;
         |FINSI;
     |SINO;
         |CIERRAT #30;  |BUCLE BucleTotal;  |ABRET #30;
     |FINSI;
|FPRC;

|PROCESO mes;
   |SI ComodNum = 1;  mes = "Enero     "; |FINSI;
   |SI ComodNum = 2;  mes = "Febrero   "; |FINSI;
   |SI ComodNum = 3;  mes = "Marzo     "; |FINSI;
   |SI ComodNum = 4;  mes = "Abril     "; |FINSI;
   |SI ComodNum = 5;  mes = "Mayo      "; |FINSI;
   |SI ComodNum = 6;  mes = "Junio     "; |FINSI;
   |SI ComodNum = 7;  mes = "Julio     "; |FINSI;
   |SI ComodNum = 8;  mes = "Agosto    "; |FINSI;
   |SI ComodNum = 9;  mes = "Septiembre"; |FINSI;
   |SI ComodNum = 10; mes = "Octubre   "; |FINSI;
   |SI ComodNum = 11; mes = "Noviembre "; |FINSI;
   |SI ComodNum = 12; mes = "Diciembre "; |FINSI;
|FPRC;

|PROGRAMA;
     |ABRET #1;
     |ABRET #2;
     |ABRET #3;
     |ABRET #30;

     |SI enEmpresa = 0;
         |CLS;
         |CABEZA "      Emision Certificados Arrendamientos";
         |PINPA #0#0;
         |PINDA #0#0;
         |ENDATOS #1#0;
         |SI FSalida = 0;
            |IMPRE 0;
            |SI #0#45 = "B"; |INFOR "eosycer1"; |FINSI;
            |SI #0#45 = "O"; |INFOR "eosycer2"; |FINSI;
            ejerc = #0#39;
            dia = #0#40 % 0102;
            mes = #0#40 % 0402;
            anyo = #0#40 % 0704;
            justi1 = #0#41;
            justi2 = #0#42;
            ComodNum = mes;
            |HAZ mes;
            |HAZ Certif;
            |FININF;
            |FINIMP;
         |FINSI;
     |SINO;
         |ABRE #28;
         #28#0 = enEmpresa;
         #28#1 = enEjercic;
         |LEE 000#28=;
         |SI FSalida ! 0;  |DDEFECTO #28;  |FINSI;
         |CIERRA #28;

         |PINPA #0#0;
         #0#0  = enEmpresa;
         #0#1  = enEmpresa;
         #0#38 = 0;           |C_M #0#38, 1, "N";
         #0#39 = enEjercic;   |C_M #0#39, 1, "N";

         |PINDA #0#0;

         |PTEC 802;
         |PTEC 802;
         |ENDATOS #1#0;
         |SI FSalida = 0;
            |IMPRE 0;
            |SI #0#45 = "B";
               |INFOR "eosycer1";
               ejerc = #0#39;
            |FINSI;
            |SI #0#45 = "O";
               |INFOR "eosycer2";
               Comodin = #0#39;
               |QBF Comodin;
               Comodin = Comodin % -102;
               ejerc = Comodin;
            |FINSI;
            dia = #0#40 % 0102;
            mes = #0#40 % 0402;
            ComodNum = mes;
            |HAZ mes;
            anyo = #0#40 % 0704;
            justi1 = #0#41;
            justi2 = #0#42;
            |HAZ Certif;
            |FININF;
            |FINIMP;
         |FINSI;
     |FINSI;

     |CIERRAT #1;
     |CIERRAT #2;
     |CIERRAT #3;
     |CIERRAT #30;
|FPRO;
