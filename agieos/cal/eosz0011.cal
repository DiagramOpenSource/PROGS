|FICHEROS;
     eosaplic;
     eosclipr;

     eosm0029;
     eosm0030;
     eosm0032;
     eosm0034;
     eosm0035;
     eosm0036;

     eosw0003;

     :/agicli/def/agicontr;

     tabla190@;
     tabla110@;
|FIN;

|VARIABLES;
     aPathFich    = "";
     aPathPan     = "";
     aFichero     = "";

     nCampoD      = 0;
     nCampo       = 0;
     nCampo1      = 0;
     nCampo2      = 0;
     nCampo3      = 0;
     nEdad        = 0;
     nConta       = 0;

     &enEmpres190 = 0;
     &enEjerci190 = 0;

     nSw         = 0;
     aPath       = "";
     aDef110     = "";
     aDef190     = "";
     nSiEsta     = 0;
|FIN;

|PROCESO eosm0034B;
     |BORRA 020#eosm0034.a;
     |LIBERA #eosm0034;
|FPRC;

|DEFBUCLE eosm0034B;
     #eosm0034#1;
     ;
     #eosm0030#0, #eosm0030#1, "            ", 0000, " ", "  ", 0;
     #eosm0030#0, #eosm0030#1, "zzzzzzzzzzzz", 9999, "z", "zz", 9;
     be;
     NULL, eosm0034B;
|FIN;

|PROCESO eosm0036B;
     |BORRA 020#eosm0036.a;
     |LIBERA #eosm0036;
|FPRC;

|DEFBUCLE eosm0036B;
     #eosm0036#1;
     ;
     #eosm0030#0, #eosm0030#1, "            ", 0000, " ", "  ", 0;
     #eosm0030#0, #eosm0030#1, "zzzzzzzzzzzz", 9999, "z", "zz", 9;
     be;
     NULL, eosm0036B;
|FIN;

|PROCESO Coge2002;
     |PARA nCampo = 8;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 2;
           nCampo1 = nCampo + 1;
           |SI #eosm0029#nCampo# > 0;
               nEdad    = #eosm0030#1 - #eosm0029#nCampo#;
               |SI #eosm0029#nCampo1# ] 65;
                   #eosm0034#28 = #eosm0034#28 + 1;
               |SINO;
                   |SI #eosm0029#nCampo1# ] 33;
                       #eosm0034#27 = #eosm0034#27 + 1;
                   |SINO;
                       |SI nEdad < 3;                 #eosm0034#24 = #eosm0034#24 + 1;  |FINSI;
                       |SI nEdad ] 3;  |Y nEdad < 16; #eosm0034#25 = #eosm0034#25 + 1;  |FINSI;
                       |SI nEdad ] 16; |Y nEdad < 25; #eosm0034#26 = #eosm0034#26 + 1;  |FINSI;
                   |FINSI;
               |FINSI;
           |FINSI;
     |SIGUE;

     |PARA nCampo = 31;  |SI nCampo [ 40;  |HACIENDO nCampo = nCampo + 1;
           |SI #eosm0029#nCampo# =  "S";
               #eosm0034#31   = #eosm0034#31 + 1;
           |FINSI;
     |SIGUE;

     |PARA nCampo = 41;  |SI nCampo [ 50;  |HACIENDO nCampo = nCampo + 1;
           nCampo1 = nCampo + 10;
           |SI #eosm0029#nCampo# !  0;
               |SI #eosm0029#nCampo# =  1;
                   #eosm0034#32   = #eosm0034#32 + 1;
               |FINSI;
               #eosm0034#35   = #eosm0034#35 + 1;
           |FINSI;

           |SI #eosm0029#nCampo1# =  "1";
               #eosm0034#33   = #eosm0034#33 + 1;
           |FINSI;

           |SI #eosm0029#nCampo1# =  "2";
               #eosm0034#34   = #eosm0034#34 + 1;
           |FINSI;
     |SIGUE;

     #eosm0034#29 = #eosm0034#24 + #eosm0034#25 + #eosm0034#26 + #eosm0034#27 + #eosm0034#28;
|FPRC;

|PROCESO eosw0003;
     nConta = nConta + 1;

     |SI #eosm0030#1 [ 2015;
         |SI nConta = 1;  #eosm0034#58 = #eosw0003#2;  |FINSI;
         |SI nConta = 2;  #eosm0034#59 = #eosw0003#2;  |FINSI;
         |SI nConta = 3;  #eosm0034#60 = #eosw0003#2;  |FINSI;
     |FINSI;

     |SI #eosm0030#1 ] 2016;
         |SI nConta = 1;  #eosm0036#58 = #eosw0003#2;  |FINSI;
         |SI nConta = 2;  #eosm0036#59 = #eosw0003#2;  |FINSI;
         |SI nConta = 3;  #eosm0036#60 = #eosw0003#2;  |FINSI;
     |FINSI;

     |SI nConta ] 3;  |ERROR10;  |FINSI;
|FPRC;

|DEFBUCLE eosw0003;
     #eosw0003#1;
     ;
     0000, 00;
     9999, 99;
     ;
     NULL, eosw0003;
|FIN;

|PROCESO Graba903;
     #eosw0003#0 = #eosm0029#nCampo#;
     #eosw0003#1 = nCampo;
     |SI #eosm0029#nCampo3# = "S";
         #eosw0003#2 = "1";
     |SINO;
         #eosw0003#2 = "2";
     |FINSI;
     |GRABA 020#eosw0003.n;
     |LIBERA #eosw0003;
|FPRC;

|PROCESO Coge2003;
     aFichero = ("03" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #eosw0003#aFichero#;
     |ABRE #eosw0003;  |CIERRA #eosw0003;  |DELINDEX #eosw0003;

     |ABRE #eosw0003;
     |PARA nCampo = 8;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 2;
           |SI nCampo = 8;   nCampo1 = 9;   nCampo2 = 63;  nCampo3 = 31;  |FINSI;
           |SI nCampo = 10;  nCampo1 = 11;  nCampo2 = 64;  nCampo3 = 32;  |FINSI;
           |SI nCampo = 12;  nCampo1 = 13;  nCampo2 = 65;  nCampo3 = 33;  |FINSI;
           |SI nCampo = 14;  nCampo1 = 15;  nCampo2 = 66;  nCampo3 = 34;  |FINSI;
           |SI nCampo = 16;  nCampo1 = 17;  nCampo2 = 67;  nCampo3 = 35;  |FINSI;
           |SI nCampo = 18;  nCampo1 = 19;  nCampo2 = 68;  nCampo3 = 36;  |FINSI;
           |SI nCampo = 20;  nCampo1 = 21;  nCampo2 = 69;  nCampo3 = 37;  |FINSI;
           |SI nCampo = 22;  nCampo1 = 23;  nCampo2 = 70;  nCampo3 = 38;  |FINSI;
           |SI nCampo = 24;  nCampo1 = 25;  nCampo2 = 71;  nCampo3 = 39;  |FINSI;
           |SI nCampo = 26;  nCampo1 = 27;  nCampo2 = 72;  nCampo3 = 40;  |FINSI;

           |SI #eosm0029#nCampo# ! 0;
               nEdad = #eosm0034#1 - #eosm0029#nCampo#;
               |SI nEdad ] 0;
                   |SI #eosm0029#nCampo1# ] 65;
                                             #eosm0034#46 = #eosm0034#46 + 1;
                      |SI #eosm0029#nCampo3# = "S";  #eosm0034#47 = #eosm0034#47 + 1;  |FINSI;

                      |SI nEdad < 3;
                                                 #eosm0034#38 = #eosm0034#38 + 1;
                          |SI #eosm0029#nCampo3# = "S";  #eosm0034#39 = #eosm0034#39 + 1;  |FINSI;
                      |SINO;
                                                 #eosm0034#40 = #eosm0034#40 + 1;
                          |SI #eosm0029#nCampo3# = "S";  #eosm0034#41 = #eosm0034#41 + 1;  |FINSI;
                      |FINSI;

                      |HAZ Graba903;
                   |SINO;
                      |SI #eosm0029#nCampo1# ] 33;
                                                 #eosm0034#42 = #eosm0034#42 + 1;
                          |SI #eosm0029#nCampo3# = "S";  #eosm0034#43 = #eosm0034#43 + 1;  |FINSI;

                          |SI #eosm0029#nCampo2# = "S";
                                                     #eosm0034#44 = #eosm0034#44 + 1;
                              |SI #eosm0029#nCampo3# = "S";  #eosm0034#45 = #eosm0034#45 + 1;  |FINSI;
                          |FINSI;

                          |SI nEdad < 3;
                                                     #eosm0034#38 = #eosm0034#38 + 1;
                              |SI #eosm0029#nCampo3# = "S";  #eosm0034#39 = #eosm0034#39 + 1;  |FINSI;
                          |SINO;
                                                     #eosm0034#40 = #eosm0034#40 + 1;
                              |SI #eosm0029#nCampo3# = "S";  #eosm0034#41 = #eosm0034#41 + 1;  |FINSI;
                          |FINSI;

                          |HAZ Graba903;
                      |SINO;
                          |SI nEdad < 3;
                                                     #eosm0034#38 = #eosm0034#38 + 1;
                              |SI #eosm0029#nCampo3# = "S";  #eosm0034#39 = #eosm0034#39 + 1;  |FINSI;

                              |HAZ Graba903;
                          |SINO;
                              |SI nEdad < 25;
                                                        #eosm0034#40 = #eosm0034#40 + 1;
                                 |SI #eosm0029#nCampo3# = "S";  #eosm0034#41 = #eosm0034#41 + 1;  |FINSI;

                                 |HAZ Graba903;
                             |FINSI;
                          |FINSI;
                      |FINSI;
                  |FINSI;
               |FINSI;
           |FINSI;
     |SIGUE;
     |CIERRA #eosw0003;

     #eosm0034#58 = "0";
     #eosm0034#59 = "0";
     #eosm0034#60 = "0";
     nConta = 0;
     |BUCLE eosw0003;

     |DELINDEX #eosw0003;

     |PARA nCampo = 73;  |SI nCampo [ 82;  |HACIENDO nCampo = nCampo + 1;
           |SI nCampo = 73;  nCampo1 = 51;  nCampo2 = 83;  nCampo3 = 41;  |FINSI;
           |SI nCampo = 74;  nCampo1 = 52;  nCampo2 = 84;  nCampo3 = 42;  |FINSI;
           |SI nCampo = 75;  nCampo1 = 53;  nCampo2 = 85;  nCampo3 = 43;  |FINSI;
           |SI nCampo = 76;  nCampo1 = 54;  nCampo2 = 86;  nCampo3 = 44;  |FINSI;
           |SI nCampo = 77;  nCampo1 = 55;  nCampo2 = 87;  nCampo3 = 45;  |FINSI;
           |SI nCampo = 78;  nCampo1 = 56;  nCampo2 = 88;  nCampo3 = 46;  |FINSI;
           |SI nCampo = 79;  nCampo1 = 57;  nCampo2 = 89;  nCampo3 = 47;  |FINSI;
           |SI nCampo = 80;  nCampo1 = 58;  nCampo2 = 90;  nCampo3 = 48;  |FINSI;
           |SI nCampo = 81;  nCampo1 = 59;  nCampo2 = 91;  nCampo3 = 49;  |FINSI;
           |SI nCampo = 82;  nCampo1 = 60;  nCampo2 = 92;  nCampo3 = 50;  |FINSI;

           |SI #eosm0029#nCampo# ! 0;
               nEdad = #eosm0034#1 - #eosm0029#nCampo#;
               |SI nEdad ] 0;
                   |SI #eosm0029#nCampo1# = "2";
                                             #eosm0034#56 = #eosm0034#56 + 1;
                      |SI #eosm0029#nCampo3# = 1;    #eosm0034#57 = #eosm0034#57 + 1;  |FINSI;

                      |SI nEdad < 75;
                                                 #eosm0034#48 = #eosm0034#48 + 1;
                          |SI #eosm0029#nCampo3# = 1;    #eosm0034#49 = #eosm0034#49 + 1;  |FINSI;
                      |SINO;
                                                 #eosm0034#50 = #eosm0034#50 + 1;
                          |SI #eosm0029#nCampo3# = 1;    #eosm0034#51 = #eosm0034#51 + 1;  |FINSI;
                      |FINSI;
                   |SINO;
                      |SI #eosm0029#nCampo1# = "1";
                                                 #eosm0034#52 = #eosm0034#52 + 1;
                          |SI #eosm0029#nCampo3# = 1;    #eosm0034#53 = #eosm0034#53 + 1;  |FINSI;

                          |SI #eosm0029#nCampo2# = "S";
                                                     #eosm0034#54 = #eosm0034#54 + 1;
                              |SI #eosm0029#nCampo3# = 1;    #eosm0034#55 = #eosm0034#55 + 1;  |FINSI;
                          |FINSI;

                          |SI nEdad < 75;
                                                     #eosm0034#48 = #eosm0034#48 + 1;
                              |SI #eosm0029#nCampo3# = 1;    #eosm0034#49 = #eosm0034#49 + 1;  |FINSI;
                          |SINO;
                                                     #eosm0034#50 = #eosm0034#50 + 1;
                              |SI #eosm0029#nCampo3# = 1;    #eosm0034#51 = #eosm0034#51 + 1;  |FINSI;
                          |FINSI;
                      |SINO;
                          |SI nEdad < 75;
                                                     #eosm0034#48 = #eosm0034#48 + 1;
                              |SI #eosm0029#nCampo3# = 1;    #eosm0034#49 = #eosm0034#49 + 1;  |FINSI;
                          |SINO;
                                                     #eosm0034#50 = #eosm0034#50 + 1;
                              |SI #eosm0029#nCampo3# = 1;    #eosm0034#51 = #eosm0034#51 + 1;  |FINSI;
                          |FINSI;
                      |FINSI;
                  |FINSI;
               |FINSI;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO DatosPer34;
     #eosm0029#0 = #eosm0034#0;
     #eosm0029#1 = #eosm0034#2;
     |LEE 040#eosm0029.=;
     |SI FSalida ! 0;  |DDEFECTO #eosm0029;  |FINSI;

     #eosclipr#0 = #eosm0034#2;
     |LEE 040#eosclipr.=;
     |SI FSalida ! 0;  |DDEFECTO #eosclipr;  |FINSI;

     #eosm0034#16 = #eosm0029#28;
     #eosm0034#17 = #eosm0029#2;
     #eosm0034#18 = #eosm0029#3;

     #eosm0034#19 = 0;
     |SI #eosm0029#4 ] 33;  |Y #eosm0029#4 < 65;
         #eosm0034#19 = 1;
         |SI #eosm0029#30 = "S";
             #eosm0034#19 = 2;
         |FINSI;
     |FINSI;
     |SI #eosm0029#4 ] 65;
         #eosm0034#19 = 3;
     |FINSI;

     #eosm0034#20 = #eosm0029#5;
     #eosm0034#21 = #eosclipr#7;
     #eosm0034#22 = #eosm0029#7;
     #eosm0034#23 = #eosm0029#29;
     #eosm0034#61 = #eosm0029#93;

     #eosm0034#24 = 0;
     #eosm0034#25 = 0;
     #eosm0034#26 = 0;
     #eosm0034#27 = 0;
     #eosm0034#28 = 0;
     #eosm0034#31 = 0;
     #eosm0034#32 = 0;
     #eosm0034#33 = 0;
     #eosm0034#34 = 0;
     #eosm0034#35 = 0;

     |PARA nCampoD = 38;  |SI nCampoD [ 57;  |HACIENDO nCampoD = nCampoD + 1;
           #eosm0034#nCampoD# = 0;
     |SIGUE;

     nSw = 0;
     |SI #eosm0034#4 ! "A"; |Y #eosm0034#4 ! "B";  |Y #eosm0034#4 ! "C";
          nSw = 1;
     |FINSI;
     |SI #eosm0034#4 = "B"; |Y #eosm0034#5 = "02";
         nSw = 1;
     |FINSI;
     |SI nSw = 1; |ACABA; |FINSI;

     |SI #eosm0034#1 [ 2002;  |HAZ Coge2002;  |FINSI;
     |SI #eosm0034#1 ] 2003;  |HAZ Coge2003;  |FINSI;
|FPRC;

|PROCESO GastosEsp;
     nSiEsta = 0;
     |SI #eosm0034#4 = "A"; |Y #eosm0034#5 = "02"; |Y #eosm0034#1 = 2015;
         |ABRE #tabla110@;
         |DDEFECTO #tabla110@;
         #tabla110@#0 = #eosm0032#0;
         #tabla110@#1 = #eosm0032#1;
         #tabla110@#2 = #eosm0032#2;
         #tabla110@#3 = #eosm0032#3;
         #tabla110@#4 = "01";
         #tabla110@#5 = #eosm0032#5;
         #tabla110@#6 = #eosm0032#6;
         |LEE 041#tabla110@.=;
         |SI FSalida = 0;
             nSiEsta = 1;
             |SI #tabla110@#15 ] 0; |Y #tabla110@#14 ] 0; |Y #tabla110@#16 ] 0; |Y #tabla110@#17 ] 0;
                 |CIERRA #tabla110@;
                 |ACABA;
             |FINSI;
         |FINSI;
         |CIERRA #tabla110@;
     |FINSI;

     #tabla190@#0 = #eosm0034#0;
     #tabla190@#1 = #eosm0034#1;
     #tabla190@#2 = #eosm0034#2;
     #tabla190@#3 = #eosm0034#3;
     #tabla190@#4 = #eosm0034#4;
     #tabla190@#5 = "  ";
     #tabla190@#6 = #eosm0034#6;
     |LEE 041#tabla190@.=;
     |SI FSalida ! 0;
         |DDEFECTO #tabla190@;
         #tabla190@#0 = #eosm0034#0;
         #tabla190@#1 = #eosm0034#1;
         #tabla190@#2 = #eosm0034#2;
         #tabla190@#3 = #eosm0034#3;
         #tabla190@#4 = #eosm0034#4;
         #tabla190@#5 = "  ";
         #tabla190@#6 = #eosm0034#6;
         |GRABA 020#tabla190@.b;
    |FINSI;

    |SI nSiEsta = 0;
        #tabla190@#12 = #tabla190@#12 + #eosm0032#14;
        #tabla190@#13 = #tabla190@#13 + #eosm0032#15;     || gastos seg.social
        #tabla190@#14 = #tabla190@#14 + #eosm0032#16;
        #tabla190@#15 = #tabla190@#15 + #eosm0032#17;
    |SINO;
        |SI #tabla110@#14 < 0; #tabla190@#12 = #tabla190@#12 + #eosm0032#14;|FINSI;
        |SI #tabla110@#15 < 0; #tabla190@#13 = #tabla190@#13 + #eosm0032#15;|FINSI;
        |SI #tabla110@#16 < 0; #tabla190@#14 = #tabla190@#14 + #eosm0032#16;|FINSI;
        |SI #tabla110@#17 < 0; #tabla190@#15 = #tabla190@#15 + #eosm0032#17;|FINSI;
    |FINSI;
    |GRABA 020#tabla190@.a;
    |LIBERA #tabla190@;
|FPRC;

|PROCESO eosm0032;
     #eosm0034#0 = #eosm0032#0;
     #eosm0034#1 = #eosm0032#1;
     #eosm0034#2 = #eosm0032#2;
     #eosm0034#3 = 0;
     |SI #eosm0032#6 > 12;
         #eosm0034#3 = #eosm0032#6;
     |FINSI;
     #eosm0034#4 = #eosm0032#3;
     #eosm0034#5 = #eosm0032#4;
     #eosm0034#6 = 0;
     |SI #eosm0034#4 = "A";  #eosm0034#6 = #eosm0032#5;  |FINSI;
     |LEE 101#eosm0034.=;
     |SI FSalida ! 0;
         |DDEFECTO #eosm0034;
         #eosm0034#0 = #eosm0032#0;
         #eosm0034#1 = #eosm0032#1;
         #eosm0034#2 = #eosm0032#2;
         #eosm0034#3 = 0;
         |SI #eosm0032#6 > 12;
             #eosm0034#3 = #eosm0032#6;
         |FINSI;
         #eosm0034#4 = #eosm0032#3;
         #eosm0034#5 = #eosm0032#4;
         #eosm0034#6 = 0;
         |SI #eosm0034#4 = "A";  #eosm0034#6 = #eosm0032#5;  |FINSI;
         |GRABA 020#eosm0034.b;
     |FINSI;

     #eosm0034#7  = #eosm0034#7  + #eosm0032#7;
     #eosm0034#8  = #eosm0034#8  + #eosm0032#9;
     #eosm0034#9  = #eosm0034#9  + #eosm0032#10;
     #eosm0034#10 = #eosm0034#10 + #eosm0032#12;
     |SI #eosm0032#13 = "S";  #eosm0034#11 = #eosm0034#11 + #eosm0032#12;  |FINSI;

     #eosm0034#12 = #eosm0034#12 + #eosm0032#14;
     #eosm0034#13 = #eosm0034#13 + #eosm0032#15;
     #eosm0034#14 = #eosm0034#14 + #eosm0032#16;
     #eosm0034#15 = #eosm0034#15 + #eosm0032#17;

     |HAZ DatosPer34;

     |GRABA 020#eosm0034.a;
     |LIBERA #eosm0034;

     |SI #eosm0034#4 = "A"; |Y #eosm0034#1 = 2015;
         |HAZ GastosEsp;
     |FINSI;
|FPRC;

|DEFBUCLE eosm0032;
     #eosm0032#1;
     ;
     #eosm0030#0, #eosm0030#1, "            ", " ", "  ", 0, 1;
     #eosm0030#0, #eosm0030#1, "zzzzzzzzzzzz", "z", "zz", 9, 9999;
     ;
     NULL, eosm0032;
|FIN;

|PROCESO eosm0034A;
     #tabla190@#0 = #eosm0034#0;
     #tabla190@#1 = #eosm0034#1;
     #tabla190@#2 = #eosm0034#2;
     #tabla190@#3 = #eosm0034#3;
     #tabla190@#4 = "A";
     #tabla190@#5 = "  ";
     #tabla190@#6 = #eosm0034#6;
     |LEE 041#tabla190@.=;
     |SI FSalida = 0;
         #eosm0034#12 = #tabla190@#12;
         #eosm0034#13 = #tabla190@#13;
         #eosm0034#14 = #tabla190@#14;
         #eosm0034#15 = #tabla190@#15;
         |GRABA 020#eosm0034.a;
     |FINSI;
     |LIBERA #eosm0034;
|FPRC;

|DEFBUCLE eosm0034A;
     #eosm0034#1;
     ;
     #eosm0030#0, #eosm0030#1, "            ", 0000, "A", "01", 0;
     #eosm0030#0, #eosm0030#1, "zzzzzzzzzzzz", 9999, "A", "02", 9;
     be;
     NULL, eosm0034A;
|FIN;

|PROCESO GrabaDes2016;
     |SI #eosm0029#nCampo# = 0;
         |ACABA;
     |FINSI;

     nEdad = #eosm0036#1 - #eosm0029#nCampo#;
     |SI nEdad < 0;
         |ACABA;
     |FINSI;

     |SI #eosm0029#nCampo1# ] 65;
         #eosm0036#46 = #eosm0036#46 + 1;
         |SI #eosm0029#nCampo3# = "S";
             #eosm0036#47 = #eosm0036#47 + 1;
         |FINSI;

         |SI nEdad < 3;
             #eosm0036#38 = #eosm0036#38 + 1;
             |SI #eosm0029#nCampo3# = "S";
                 #eosm0036#39 = #eosm0036#39 + 1;
             |FINSI;
         |SINO;
             #eosm0036#40 = #eosm0036#40 + 1;
             |SI #eosm0029#nCampo3# = "S";
                 #eosm0036#41 = #eosm0036#41 + 1;
             |FINSI;
         |FINSI;

         |HAZ Graba903;
     |SINO;
         |SI #eosm0029#nCampo1# ] 33;
             #eosm0036#42 = #eosm0036#42 + 1;
             |SI #eosm0029#nCampo3# = "S";
                 #eosm0036#43 = #eosm0036#43 + 1;
             |FINSI;

             |SI #eosm0029#nCampo2# = "S";
                 #eosm0036#44 = #eosm0036#44 + 1;
                 |SI #eosm0029#nCampo3# = "S";
                     #eosm0036#45 = #eosm0036#45 + 1;
                 |FINSI;
             |FINSI;

             |SI nEdad < 3;
                 #eosm0036#38 = #eosm0036#38 + 1;
                 |SI #eosm0029#nCampo3# = "S";
                     #eosm0036#39 = #eosm0036#39 + 1;
                 |FINSI;
             |SINO;
                 #eosm0036#40 = #eosm0036#40 + 1;
                 |SI #eosm0029#nCampo3# = "S";
                     #eosm0036#41 = #eosm0036#41 + 1;
                 |FINSI;
             |FINSI;

             |HAZ Graba903;
         |SINO;
             |SI nEdad < 3;
                 #eosm0036#38 = #eosm0036#38 + 1;
                 |SI #eosm0029#nCampo3# = "S";
                     #eosm0036#39 = #eosm0036#39 + 1;
                 |FINSI;

                 |HAZ Graba903;
             |SINO;
                 |SI nEdad < 25;
                     #eosm0036#40 = #eosm0036#40 + 1;
                     |SI #eosm0029#nCampo3# = "S";
                         #eosm0036#41 = #eosm0036#41 + 1;
                     |FINSI;

                     |HAZ Graba903;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO GrabaAsc2016;
     |SI #eosm0029#nCampo# = 0;
         |ACABA;
     |FINSI;

     nEdad = #eosm0036#1 - #eosm0029#nCampo#;
     |SI nEdad < 0;
         |ACABA;
     |FINSI;

     |SI #eosm0029#nCampo1# = "2";
         #eosm0036#56 = #eosm0036#56 + 1;
         |SI #eosm0029#nCampo3# = 1;
             #eosm0036#57 = #eosm0036#57 + 1;
         |FINSI;

         |SI nEdad < 75;
             #eosm0036#48 = #eosm0036#48 + 1;
             |SI #eosm0029#nCampo3# = 1;
                 #eosm0036#49 = #eosm0036#49 + 1;
             |FINSI;
         |SINO;
             #eosm0036#50 = #eosm0036#50 + 1;
             |SI #eosm0029#nCampo3# = 1;
                 #eosm0036#51 = #eosm0036#51 + 1;
             |FINSI;
         |FINSI;
     |SINO;
         |SI #eosm0029#nCampo1# = "1";
             #eosm0036#52 = #eosm0036#52 + 1;
             |SI #eosm0029#nCampo3# = 1;
                 #eosm0036#53 = #eosm0036#53 + 1;
             |FINSI;

             |SI #eosm0029#nCampo2# = "S";
                 #eosm0036#54 = #eosm0036#54 + 1;
                 |SI #eosm0029#nCampo3# = 1;
                     #eosm0036#55 = #eosm0036#55 + 1;
                 |FINSI;
             |FINSI;

             |SI nEdad < 75;
                 #eosm0036#48 = #eosm0036#48 + 1;
                 |SI #eosm0029#nCampo3# = 1;
                     #eosm0036#49 = #eosm0036#49 + 1;
                 |FINSI;
             |SINO;
                 #eosm0036#50 = #eosm0036#50 + 1;
                 |SI #eosm0029#nCampo3# = 1;
                     #eosm0036#51 = #eosm0036#51 + 1;
                 |FINSI;
             |FINSI;
         |SINO;
             |SI nEdad < 75;
                 #eosm0036#48 = #eosm0036#48 + 1;
                 |SI #eosm0029#nCampo3# = 1;
                     #eosm0036#49 = #eosm0036#49 + 1;
                 |FINSI;
             |SINO;
                 #eosm0036#50 = #eosm0036#50 + 1;
                 |SI #eosm0029#nCampo3# = 1;
                     #eosm0036#51 = #eosm0036#51 + 1;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Coge2016;
     aFichero = ("03" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #eosw0003#aFichero#;
     |ABRE #eosw0003;  |CIERRA #eosw0003;  |DELINDEX #eosw0003;

     |ABRE #eosw0003;
     |PARA nCampo = 8;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 2;
           |SI nCampo = 8;   nCampo1 = 9;   nCampo2 = 63;  nCampo3 = 31;  |FINSI;
           |SI nCampo = 10;  nCampo1 = 11;  nCampo2 = 64;  nCampo3 = 32;  |FINSI;
           |SI nCampo = 12;  nCampo1 = 13;  nCampo2 = 65;  nCampo3 = 33;  |FINSI;
           |SI nCampo = 14;  nCampo1 = 15;  nCampo2 = 66;  nCampo3 = 34;  |FINSI;
           |SI nCampo = 16;  nCampo1 = 17;  nCampo2 = 67;  nCampo3 = 35;  |FINSI;
           |SI nCampo = 18;  nCampo1 = 19;  nCampo2 = 68;  nCampo3 = 36;  |FINSI;
           |SI nCampo = 20;  nCampo1 = 21;  nCampo2 = 69;  nCampo3 = 37;  |FINSI;
           |SI nCampo = 22;  nCampo1 = 23;  nCampo2 = 70;  nCampo3 = 38;  |FINSI;
           |SI nCampo = 24;  nCampo1 = 25;  nCampo2 = 71;  nCampo3 = 39;  |FINSI;
           |SI nCampo = 26;  nCampo1 = 27;  nCampo2 = 72;  nCampo3 = 40;  |FINSI;

           |HAZ GrabaDes2016;
     |SIGUE;
     |CIERRA #eosw0003;

     #eosm0036#58 = "0";
     #eosm0036#59 = "0";
     #eosm0036#60 = "0";
     nConta = 0;
     |BUCLE eosw0003;

     |DELINDEX #eosw0003;

     |PARA nCampo = 73;  |SI nCampo [ 82;  |HACIENDO nCampo = nCampo + 1;
           |SI nCampo = 73;  nCampo1 = 51;  nCampo2 = 83;  nCampo3 = 41;  |FINSI;
           |SI nCampo = 74;  nCampo1 = 52;  nCampo2 = 84;  nCampo3 = 42;  |FINSI;
           |SI nCampo = 75;  nCampo1 = 53;  nCampo2 = 85;  nCampo3 = 43;  |FINSI;
           |SI nCampo = 76;  nCampo1 = 54;  nCampo2 = 86;  nCampo3 = 44;  |FINSI;
           |SI nCampo = 77;  nCampo1 = 55;  nCampo2 = 87;  nCampo3 = 45;  |FINSI;
           |SI nCampo = 78;  nCampo1 = 56;  nCampo2 = 88;  nCampo3 = 46;  |FINSI;
           |SI nCampo = 79;  nCampo1 = 57;  nCampo2 = 89;  nCampo3 = 47;  |FINSI;
           |SI nCampo = 80;  nCampo1 = 58;  nCampo2 = 90;  nCampo3 = 48;  |FINSI;
           |SI nCampo = 81;  nCampo1 = 59;  nCampo2 = 91;  nCampo3 = 49;  |FINSI;
           |SI nCampo = 82;  nCampo1 = 60;  nCampo2 = 92;  nCampo3 = 50;  |FINSI;

           |HAZ GrabaAsc2016;
     |SIGUE;
|FPRC;

|PROCESO DatosPer36;
     #eosm0029#0 = #eosm0036#0;
     #eosm0029#1 = #eosm0036#2;
     |LEE 040#eosm0029.=;
     |SI FSalida ! 0;  |DDEFECTO #eosm0029;  |FINSI;

     #eosclipr#0 = #eosm0036#2;
     |LEE 040#eosclipr.=;
     |SI FSalida ! 0;  |DDEFECTO #eosclipr;  |FINSI;

     #eosm0036#16 = #eosm0029#28;
     #eosm0036#17 = #eosm0029#2;
     #eosm0036#18 = #eosm0029#3;

     #eosm0036#19 = 0;
     |SI #eosm0029#4 ] 33;  |Y #eosm0029#4 < 65;
         #eosm0036#19 = 1;
         |SI #eosm0029#30 = "S";
             #eosm0036#19 = 2;
         |FINSI;
     |FINSI;
     |SI #eosm0029#4 ] 65;
         #eosm0036#19 = 3;
     |FINSI;

     #eosm0036#20 = #eosm0029#5;
     #eosm0036#21 = #eosclipr#7;
     #eosm0036#22 = #eosm0029#7;
     #eosm0036#23 = #eosm0029#29;
     #eosm0036#61 = #eosm0029#93;

     #eosm0036#24 = 0;
     #eosm0036#25 = 0;
     #eosm0036#26 = 0;
     #eosm0036#27 = 0;
     #eosm0036#28 = 0;
     #eosm0036#31 = 0;
     #eosm0036#32 = 0;
     #eosm0036#33 = 0;
     #eosm0036#34 = 0;
     #eosm0036#35 = 0;

     |PARA nCampoD = 38;  |SI nCampoD [ 57;  |HACIENDO nCampoD = nCampoD + 1;
           #eosm0036#nCampoD# = 0;
     |SIGUE;

     nSw = 0;
     |SI #eosm0036#4 ! "A"; |Y #eosm0036#4 ! "B";  |Y #eosm0036#4 ! "C";
          nSw = 1;
     |FINSI;
     |SI #eosm0036#4 = "B"; |Y #eosm0036#5 = "02";
         nSw = 1;
     |FINSI;
     |SI nSw = 1; |ACABA; |FINSI;

     |HAZ Coge2016;
|FPRC;

|PROCESO eosm0035;
     #eosm0036#0 = #eosm0035#0;
     #eosm0036#1 = #eosm0035#1;
     #eosm0036#2 = #eosm0035#2;
     #eosm0036#3 = 0;
     |SI #eosm0035#6 > 12;
         #eosm0036#3 = #eosm0035#6;
     |FINSI;
     #eosm0036#4 = #eosm0035#3;
     #eosm0036#5 = #eosm0035#4;
     #eosm0036#6 = 0;
     |SI #eosm0036#4 = "A";  #eosm0036#6 = #eosm0035#5;  |FINSI;
     |LEE 101#eosm0036.=;
     |SI FSalida ! 0;
         |DDEFECTO #eosm0036;
         #eosm0036#0 = #eosm0035#0;
         #eosm0036#1 = #eosm0035#1;
         #eosm0036#2 = #eosm0035#2;
         #eosm0036#3 = 0;
         |SI #eosm0035#6 > 12;
             #eosm0036#3 = #eosm0035#6;
         |FINSI;
         #eosm0036#4 = #eosm0035#3;
         #eosm0036#5 = #eosm0035#4;
         #eosm0036#6 = 0;
         |SI #eosm0036#4 = "A";  #eosm0036#6 = #eosm0035#5;  |FINSI;
         |GRABA 020#eosm0036.b;
     |FINSI;

     #eosm0036#7  = #eosm0036#7  + #eosm0035#7;
     #eosm0036#8  = #eosm0036#8  + #eosm0035#9;
     #eosm0036#9  = #eosm0036#9  + #eosm0035#10;
     #eosm0036#10 = #eosm0036#10 + #eosm0035#12;

     #eosm0036#63 = #eosm0036#63 + #eosm0035#18;
     #eosm0036#64 = #eosm0036#64 + #eosm0035#20;
     #eosm0036#65 = #eosm0036#65 + #eosm0035#21;
     #eosm0036#66 = #eosm0036#66 + #eosm0035#23;

     |SI #eosm0035#13 = "S";
         #eosm0036#11 = #eosm0036#11 + #eosm0035#12;
     |FINSI;

     |SI #eosm0035#24 = "S";
         #eosm0036#67 = #eosm0036#67 + #eosm0035#23;
     |FINSI;

     #eosm0036#12 = #eosm0036#12 + #eosm0035#14;
     #eosm0036#13 = #eosm0036#13 + #eosm0035#15;
     #eosm0036#14 = #eosm0036#14 + #eosm0035#16;
     #eosm0036#15 = #eosm0036#15 + #eosm0035#17;

     |HAZ DatosPer36;

     |GRABA 020#eosm0036.a;
     |LIBERA #eosm0036;
|FPRC;

|DEFBUCLE eosm0035;
     #eosm0035#1;
     ;
     #eosm0030#0, #eosm0030#1, "            ", " ", "  ", 0, 1;
     #eosm0030#0, #eosm0030#1, "zzzzzzzzzzzz", "z", "zz", 9, 9999;
     ;
     NULL, eosm0035;
|FIN;

|PROCESO DatosEmpresas;
     |DBASE aPath;  |QBT aPath;

     |SI #eosm0030#1 [ 2015;
         |BUCLE eosm0034B;

         aDef110 = aPath + "def/eosm0032.mas";
         aDef190 = aPath + "def/eosm0034.mas";

         |CARGA_DEF aDef110, tabla110@;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |CARGA_DEF aDef190, tabla190@;
         |SI FSalida ! 0;
             |DESCARGA_DEF #tabla110@;
             |ACABA;
         |FINSI;

         aFichero = "9y" + Usuario;
         |NOME_DAT #tabla190@#aFichero#;
         |DELINDEX #tabla190@;

         |ABRE #tabla190@;
         |ABRE #eosm0034;
         |BUCLE eosm0032;
         |CIERRA #eosm0034;

         |BUCLE eosm0034A;

         |CIERRA #tabla190@;

         |DESCARGA_DEF #tabla190@;
         |DESCARGA_DEF #tabla110@;
     |FINSI;

     |SI #eosm0030#1 ] 2016;
         |BUCLE eosm0036B;

         |ABRE #eosm0036;
         |BUCLE eosm0035;
         |CIERRA #eosm0036;
     |FINSI;
|FPRC;

|PROGRAMA;
     |ATRI P;
     |PINTA 2320, "CALCULANDO 190";
     |ATRI 0;

     |ABRE #eosm0029;
     |ABRE #eosm0030;
     |ABRE #eosclipr;
     #eosm0030#0 = enEmpres190;
     #eosm0030#1 = enEjerci190;
     |LEE 040#eosm0030.=;
     |SI FSalida = 0;
         |HAZ DatosEmpresas;
     |FINSI;
     |CIERRA #eosm0029;
     |CIERRA #eosm0030;
     |CIERRA #eosclipr;
|FPRO;

|PROCESO Tipo80;  |TIPO 80;
     |ABRE #eosaplic;
     |LEE 040#eosaplic.p;
     |SI FSalida ! 0; |DDEFECTO #eosaplic; |FINSI;
     |CIERRA #eosaplic;

     |SI #eosaplic#11 = 1; |ACABA; |FINSI;

     |ABRE #agicontr;
     |LEE 040#agicontr.p;
     |SI FSalida ! 0; |CIERRA #agicontr; |ACABA; |FINSI;
     |CIERRA #agicontr;

     aPathFich = #agicontr#8; |QBF aPathFich;
     |SI aPathFich = "*";  |ACABA;  |FINSI;
     aPathPan = (aPathFich - "fich/") + "pan/";

     |PATH_DAT #eosclipr#aPathFich#;
     |PATH_PAN #eosclipr#aPathPan#;
|FPRC;
