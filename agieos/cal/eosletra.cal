|FICHEROS;
    eosclien #1;

    eosli347 #2;
    eosclipr #3;
    eosclpre #4;
    eosirpf1 #5;
    eoslinco #6;
    eoslinve #7;
    eosw0020 #8;
    eoscabco #9;
    eoscabve #10;
    eosm0010 #11;
|FIN;

|VARIABLES;
 Nume  = 0;
 swnif = 0;
 nume1 = 0;
  nume2 = 0;
 lugar = 0;
 nifnum = 0;
 resto = 0;
 xxx   = 0;
    x = "";
    letra = "";
    alfa1 = "";
    alfa2 = "";
    final = "";
    trabajo = "";
    pos1 = "";
    pos2 = "";
    pos3 = "";
    pos4 = "";
    conta = 0;
    anyo = "";
    c    = 0;
    TrabajoAnt = "";
    Cadena   = "";
    Caracter = "";
    Posi     = 0;
    XPara    = 0;

    &eaVarDni  = "";
    &enCalcCif = 0;
|FIN;

|INCLUYE i_ficher;

|PROCESO letranif;
     eaVarDni   = trabajo;
     enCalcCif  = 3;
     |HAZ CalculoDNI;
     trabajo = eaVarDni;
|FPRC;

|PROCESO empresas;   || viene del bucle de empresas y va a calcular
trabajo = #1#1;
|HAZ letranif;
|SI swnif = 0;  #1#1 = trabajo;  |FINSI;

trabajo = #1#26;
|HAZ letranif;
|SI swnif = 0;  #1#26 = trabajo;  |FINSI;

trabajo = #1#31;
|HAZ letranif;
|SI swnif = 0;  #1#31 = trabajo;  |FINSI;

trabajo = #1#36;
|HAZ letranif;
|SI swnif = 0;  #1#36 = trabajo;  |FINSI;

|GRABA 020#1a;
|LIBERA #1;

|HAZ pinta;
|FPRC;

|DEFBUCLE eosclien;
#1#1;
;
0;
99999;
be;
NULL, empresas;
|FIN;

|PROCESO fichero_2;
trabajo = #2#3;
|HAZ letranif;
|SI swnif ! 0; |ACABA; |FINSI;

#2#3 = trabajo;
|GRABA 140#2a;

|HAZ pinta;
|FPRC;

|DEFBUCLE eosli347;
#2#1;
;
00000, 0000;
99999, 9999;
be;
NULL, fichero_2;
|FIN;

|PROCESO fichero_11;
TrabajoAnt = #11#3;  |QBF TrabajoAnt;
trabajo = #11#3;
|HAZ letranif;
|SI swnif ! 0; |ACABA; |FINSI;

|SI trabajo ! TrabajoAnt;
    #11#3 = trabajo;
    |GRABA 140#11n;
    |SI FSalida ! 0;  |ACABA;  |FINSI;

    #11#3 = TrabajoAnt;
    |LIBERA #11;
    |LEE 140#3=;
    |BORRA 140#11a;
|FINSI;
|HAZ pinta;
|FPRC;

|DEFBUCLE eosm0010;
#11#1;
;
00000, 00, " ", "            ", " ", " ", "  ", " ", " ";
99999, 99, "z", "zzzzzzzzzzzz", "z", "z", "zz", "z", "z";
be;
NULL, fichero_11;
|FIN;

|PROCESO pasa_ind;
|PARA xxx = 0; |SI xxx [ 14; |HACIENDO xxx = xxx + 1;
      #8xxx = #3xxx;
|SIGUE;

trabajo = #8#0;
|HAZ letranif;
|SI swnif = 0; #8#0 = trabajo; |FINSI;

|GRABA 040#8n;
|HAZ pinta;
|FPRC;

|DEFBUCLE eosclipr;
#3#1;
;
"            ";
"zzzzzzzzzzzz"
;
NULL, pasa_ind;
|FIN;

|PROCESO pasa_bue;
|PARA xxx = 0; |SI xxx [ 14; |HACIENDO xxx = xxx + 1;
      #3xxx = #8xxx;
|SIGUE;

|GRABA 040#3n;

|HAZ pinta;
|FPRC;

|DEFBUCLE eosw0020;
#8#1;
;
"            ";
"zzzzzzzzzzzz"
;
NULL, pasa_bue;
|FIN;

|PROCESO cli_pro;
comienza = "dn";
|HAZ fichero;
|NOME_DAT #8 fichero;
|ABRE #8; |CIERRA #8; |DELINDEX #8;

|ABRE #8;
|BUCLE eosclipr;
|CIERRA #8;

|ABRE #3; |CIERRA #3; |DELINDEX #3;

|ABRE #3;
|BUCLE eosw0020;
|CIERRA #3;

|ABRE #8; |CIERRA #8; |DELINDEX #8;
|FPRC;

|PROCESO fichero_4;
trabajo = #4#3;
|HAZ letranif;
|SI swnif ! 0; |ACABA; |FINSI;

#4#3 = trabajo;
|GRABA 140#4a;

|HAZ pinta;
|FPRC;

|DEFBUCLE eosclpre;
#4#1;
;
00000, 0, 00000;
99999, 9, 99999;
be;
NULL, fichero_4;
|FIN;

|PROCESO fichero_5;
trabajo = #5#7;
|HAZ letranif;
|SI swnif ! 0; |ACABA; |FINSI;

#5#7 = trabajo;
|GRABA 140#5a;

|HAZ pinta;
|FPRC;

|DEFBUCLE eosirpf1;
#5#1;
;
00000, 00000, 00;
99999, 99999, 99;
be;
NULL, fichero_5;
|FIN;

|PROCESO fichero_6;
|LIBERA #6;
|LEE 140#6=;
trabajo = #6#12;
|HAZ letranif;
|SI swnif ! 0; |ACABA; |FINSI;

#6#12 = trabajo;
|GRABA 140#6a;

|HAZ pinta;
|FPRC;

|PROCESO fichero_9;
fichero = #9#0;
fichero = "00000" + fichero;
fichero = fichero % -105;

anyo    = #9#4;
anyo    = "00" + anyo;
anyo    = anyo % -102;
fichero = "c" + fichero + anyo;

|NOME_DAT #6 fichero;
|BUCLELIN 0fichero_6#9;

trabajo = #9#2;
|HAZ letranif;
|SI swnif ! 0; |ACABA; |FINSI;

#9#2 = trabajo;
|GRABA 140#9a;
|FPRC;

|DEFBUCLE eoscabco;
#9#1;
;
00000, 00;
99999, 99;
be;
NULL, fichero_9;
|FIN;

|PROCESO fichero_7;
|LIBERA #7;
|LEE 140#7=;
trabajo = #7#12;
|HAZ letranif;
|SI swnif ! 0; |ACABA; |FINSI;

#7#12 = trabajo;
|GRABA 140#7a;

|HAZ pinta;
|FPRC;

|PROCESO fichero_10;
fichero = #10#0;
fichero = "00000" + fichero;
fichero = fichero % -105;

anyo    = #10#4;
anyo    = "00" + anyo;
anyo    = anyo % -102;
fichero = "v" + fichero + anyo;

|NOME_DAT #7 fichero;
|BUCLELIN 0fichero_7#10;

trabajo = #10#2;
|HAZ letranif;
|SI swnif ! 0; |ACABA; |FINSI;

#10#2 = trabajo;
|GRABA 140#10a;
|FPRC;

|DEFBUCLE eoscabve;
#10#1;
;
00000, 00;
99999, 99;
be;
NULL, fichero_10;
|FIN;

|PROCESO pinta;
c = c + 1;

|PINTA 2029, c;
|FPRC;

|PROCESO tipo_3; |TIPO 3;
|NOPARA;

|PINTA 1929, "Clientes                           ";  c = 0; |BUCLE eosclien;

|PINTA 2029, "         ";
|PINTA 1929, "Lineas 347                         ";  c = 0; |BUCLE eosli347;
|PINTA 1929, "Lineas 347                         ";  c = 0; |BUCLE eosm0010;

|PINTA 2029, "         ";
|PINTA 1929, "Clientes - Proveedores General     ";  c = 0; |HAZ cli_pro;

|PINTA 2029, "         ";
|PINTA 1929, "Clientes - Proveedores Empresas    ";  c = 0; |BUCLE eosclpre;

|PINTA 2029, "         ";
|PINTA 1929, "Trabajores IRPF                    ";  c = 0; |BUCLE eosirpf1;

|PINTA 2029, "         ";
|PINTA 1929, "Libro de Compras                   ";  c = 0; |BUCLE eoscabco;

|PINTA 2029, "         ";
|PINTA 1929, "Libro de Ventas                    ";  c = 0; |BUCLE eoscabve;
|FPRC;
