|FICHEROS;
     :/agicli/def/agicontr #97;                || Control Modulo integrador

     eosm0009 #0;                 || Este Def
     eosm0010 #1,MANTE;           || Lineas 347
     eosm0016 #44,MANTE;          || Lineas 347 Metalico Ej. Anteriores
     eosclipr #2;                 || Clientes Proveedores General
     eosm0008 #3;                 || Control 347
     eosclien #4;                 || Clientes
     eosaplic #96;                || Control Aplicacion

     eosw0143 #943,MANTE;
     eosw0159 #959;
     reflejo@ #900;

     dsm210mu;
|FIN;

|VARIABLES;
     nEmpresa   = 0;
     nAnyo      = 0;
     PathFich   = "";
     PathPan    = "";
     Modo       = 0;
     ModoL      = 0;
     Opcion     = 0;
     Salir      = 0;
     Clave      = "";
     Dni        = "";
     Mensa      = "";
     CantiTope  = 0;
     nModo      = 0;
     nSwManual  = 0;
     nCampo     = 0;
     nNume      = 0;
     aAlfa      = "";
     aAlfa1     = "";
     aAlfa2     = "";
     DLocal     = "";
     HLocal     = "";
     nCampo1    = 0;
     nCampo2    = 0;
     nCampo3    = 0;

     aPathModelo = "";
     aDef        = "";

{-1} MGeneral   = "";
     MGeneral1  = "1259";
     MGeneral2  = "1";
     MGeneral3  = "10";
     MGeneral4  = "Clave A            ";
     MGeneral5  = "Clave B            ";
     MGeneral6  = "Clave C            ";
     MGeneral7  = "Clave D            ";
     MGeneral8  = "Clave E            ";
     MGeneral9  = "Clave F            ";
     MGeneral10 = "Clave G            ";
     MGeneral11 = "Arrendamientos     ";
     MGeneral12 = "Recalcular Cabecera";
     MGeneral13 = "Cabecera Manual    ";

     &enMensaje = 0;
     &eaNif     = "";
     aNifQbf1   = "";
     aNifQbf2   = "";

     &eaVarDni  = "";
     &enCalcCif = 0;

     nNegativo   = 0;
     nEjerCobro  = 0;
     nEjer       = 0;
     nSwSolo     = 0;
     nOpera      = 0;
     nMaxCobro   = 0;
     aMenav      = "";
     nEjercicio  = 0;
     nNume1      = 0;
     nPara1      = 0;
     nPara2      = 0;
|FIN;

|PROCESO Cambio01;

  aAlfa1 = #1#4;

  aAlfa = #1#4 % -101;
  |SI aAlfa ! " ";
      |ERROR10;
      |ACABA;
  |FINSI;

  aAlfa = #1#4 % 101;
  |SI aAlfa = "N"; aAlfa = "1"; |FINSI;
  aAlfa = "0" + aAlfa;

  #1#4 = aAlfa;
  |GRABA 140#1n;
  |SI FSalida ! 0; |ACABA; |FINSI;

  #1#4 = aAlfa1;
  |LIBERA #1;
  |LEE 140#1=;
  |SI FSalida = 0;
      |BORRA 040#1a;
  |FINSI;
|FPRC;

|DEFBUCLE eosm0010;
  #1#1;
  ;
  00000, 00, "Z", "            ", " ", " ", "  ", " ", " ";
  99999, 99, "Z", "zzzzzzzzzzzz", "z", "z", "zz", "z", "z";
  be;
  NULL, Cambio01;
|FIN;

|PROCESO Cambio02;
     aAlfa = #0#18;  |QBT aAlfa;
     |SI aAlfa ! "";  |ERROR10;  |ACABA;  |FINSI;

     #4#0 = #0#0;
     |LEE 040#4=;
     |SI FSalida ! 0;  |DDEFECTO #4;  |FINSI;

     #0#18 = #4#2;
     #0#19 = #4#14;
     |GRABA 020#0a;
     |LIBERA #0;
|FPRC;

|DEFBUCLE eosm0009;
  #0#1;
  ;
  00000, 00;
  99999, 99;
  be;
  NULL, Cambio02;
|FIN;

|PROCESO Tipo8; |TIPO 8;
  |HAZ MiroEosm0016;

  |ABRE #4;
  |BUCLE eosm0009;       || Pone la Persona de Contacto
  |CIERRA #4;

  |BUCLE eosm0010;

  |ABRE #96;
  |LEE 040#96p;
  |SI FSalida ! 0; |DDEFECTO #96; |FINSI;
  |CIERRA #96;

  |DBASS PathFich;
  |PATH_DAT #97 PathFich;

  |SI #96#11 = 1; |ACABA; |FINSI;

  |ABRE #97;
  |LEE 040#97p;
  |SI FSalida ! 0; |CIERRA #97; |ACABA; |FINSI;
  |CIERRA #97;

  PathFich = #97#8; |QBF PathFich;
  |SI PathFich = "*"; |ACABA; |FINSI;

  PathPan = (PathFich - "fich/") + "pan/";

  |PATH_DAT #2 PathFich;
  |PATH_PAN #2 PathPan;

|FPRC;

|PROCESO Complementaria; |TIPO 0;
  |SI #0Campo ! "N";
      |C_M #0#5, 1, "S";
  |SINO;
      |C_M #0#5, 1, "N";
      #0#5 = ""; |PINTA #0#5;
  |FINSI;
|FPRC;

|PROCESO Registro4_2010;
    |SI #44#7 ] nMaxCobro;
         nNume1 = nNume1 + 1;
    |FINSI;
|FPRC;

|DEFBUCLE Registro4_2010;
    #44#1;
    ;
    #1#0, #1#1, #1#2, #1#3, #1#35, #1#36, #1#4, #1#5, #1#37, 2999;
    #1#0, #1#1, #1#2, #1#3, #1#35, #1#36, #1#4, #1#5, #1#37, 2000;
    e;
    NULL, Registro4_2010;
|FIN;

|PROCESO Recalculo;

      |SI #1#2 = "A"; |O #1#2 = "B";
          |SI nEjercicio < 2010;
               nNume1 = 1;
          |SINO;
              nNume1 = 0;
              |SI #1#19 ! 0;  nNume1 = 1; |FINSI;
              |BUCLE Registro4_2010;
          |FINSI;
          |SI #1#2 = "A";  #0#12 = #0#12 + nNume1;  |FINSI;
          |SI #1#2 = "B";  #0#13 = #0#13 + nNume1;  |FINSI;
     |FINSI;

     |SI #1#2 = "C";  #0#14 = #0#14 + 1;  |FINSI;
     |SI #1#2 = "D";  #0#15 = #0#15 + 1;  |FINSI;
     |SI #1#2 = "E";  #0#16 = #0#16 + 1;  |FINSI;
     |SI #1#2 = "F";  #0#23 = #0#23 + 1;  |FINSI;
     |SI #1#2 = "G";  #0#24 = #0#24 + 1;  |FINSI;
     |SI #1#2 = "Z";  #0#17 = #0#17 + 1;  |FINSI;

     |SI #1#2 = "A";  #0#6  = #0#6  + #1#19;  |FINSI;
     |SI #1#2 = "B";  #0#7  = #0#7  + #1#19;  |FINSI;
     |SI #1#2 = "C";  #0#8  = #0#8  + #1#19;  |FINSI;
     |SI #1#2 = "D";  #0#9  = #0#9  + #1#19;  |FINSI;
     |SI #1#2 = "E";  #0#10 = #0#10 + #1#19;  |FINSI;
     |SI #1#2 = "F";  #0#21 = #0#21 + #1#19;  |FINSI;
     |SI #1#2 = "G";  #0#22 = #0#22 + #1#19;  |FINSI;
     |SI #1#2 = "Z";  #0#11 = #0#11 + #1#19;  |FINSI;
|FPRC;

|DEFBUCLE eosm0010R;
  #1#1;
  ;
  #0#0, #0#1, " ", "            ", " ", " ", "  ", " ", " ";
  #0#0, #0#1, "z", "zzzzzzzzzzzz", "z", "z", "zz", "z", "z";
  be;
  NULL, Recalculo;
|FIN;

|PROCESO Recalc;
     #0#6  = 0;    #0#12 = 0;
     #0#7  = 0;    #0#13 = 0;
     #0#8  = 0;    #0#14 = 0;
     #0#9  = 0;    #0#15 = 0;
     #0#10 = 0;    #0#16 = 0;
     #0#11 = 0;    #0#17 = 0;
     #0#23 = 0;    #0#21 = 0;
     #0#24 = 0;    #0#22 = 0;
     |BUCLE eosm0010R;
|FPRC;

|PROCESO Manual;
     nSwManual = 1;
     |C_M #0#6,  1, "S";
     |C_M #0#7,  1, "S";
     |C_M #0#8,  1, "S";
     |C_M #0#9,  1, "S";
     |C_M #0#10, 1, "S";
     |C_M #0#11, 1, "S";
     |C_M #0#12, 1, "S";
     |C_M #0#13, 1, "S";
     |C_M #0#14, 1, "S";
     |C_M #0#15, 1, "S";
     |C_M #0#16, 1, "S";
     |C_M #0#17, 1, "S";
     |C_M #0#21, 1, "S";
     |C_M #0#22, 1, "S";
     |C_M #0#23, 1, "S";
     |C_M #0#24, 1, "S";

     nEmpresa = #0#0;
     nAnyo    = #0#1;

     |ENDATOS #1#0;

     #0#0 = nEmpresa;
     #0#1 = nAnyo;
     |C_M #0#6,  1, "N";
     |C_M #0#7,  1, "N";
     |C_M #0#8,  1, "N";
     |C_M #0#9,  1, "N";
     |C_M #0#10, 1, "N";
     |C_M #0#11, 1, "N";
     |C_M #0#12, 1, "N";
     |C_M #0#13, 1, "N";
     |C_M #0#14, 1, "N";
     |C_M #0#15, 1, "N";
     |C_M #0#16, 1, "N";
     |C_M #0#17, 1, "N";
     |C_M #0#21, 1, "N";
     |C_M #0#22, 1, "N";
     |C_M #0#23, 1, "N";
     |C_M #0#24, 1, "N";
     nSwManual = 0;
|FPRC;

|PROCESO SumayBorra;
   |SI nOpera = 1;
       |BORRA 140#44a;
       |SI #1#2 = "A"; #0#12 = #0#12 - 1; |FINSI;
       |SI #1#2 = "B"; #0#13 = #0#13 - 1; |FINSI;
   |FINSI;
   |SI nOpera = 0;
       #1#26 = #1#26 + #44#7;
   |FINSI;
   |LIBERA #44;
|FPRC;

|DEFBUCLE SumayBorra;
  #44#1;
  ;
  #1#0, #1#1, #1#2, #1#3, #1#35, #1#36, #1#4, #1#5, #1#37, nEjerCobro;
  #1#0, #1#1, #1#2, #1#3, #1#35, #1#36, #1#4, #1#5, #1#37, 2000;
  be;
  NULL, SumayBorra;
|FIN;

|PROCESO Borra01;
  |SI #1#2 = "A"; |O #1#2 = "B";
      nOpera = 1; |BUCLE SumayBorra;
  |FINSI;

  |BORRA 140#1a;
  |LIBERA #1;
|FPRC;

|DEFBUCLE eosm0010B;
  #1#1;
  ;
  #0#0, #0#1, " ", "            ", " ", " ", "  ", " ", " ";
  #0#0, #0#1, "z", "zzzzzzzzzzzz", "z", "z", "zz", "z", "z";
  be;
  NULL, Borra01;
|FIN;

|PROCESO Tipo2; |TIPO 2;
  Modo = (FEntrada / 100) ! 0;
  |SI Modo ! 3; |ACABA; |FINSI;

  |MENSA "0401 Borrando Ficheros Relacionados";

  |SI #0#1 < 80;
      nEjercicio = 2000 + #0#1;
  |SINO;
      nEjercicio = 1900 + #0#1;
  |FINSI;
  nEjerCobro = nEjercicio - 1;

  |BUCLE eosm0010B;

  |BLIN 04;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
  |SI nSwManual = 1;  |ACABA;  |FINSI;

  Modo = (FEntrada / 100) ! 0;
  |SI Modo ! 1; |Y Modo ! 2; |ACABA; |FINSI;

  |HAZ MGeneral;
|FPRC;

|PROCESO Tipo13; |TIPO 13;
  Modo = (FEntrada / 100) ! 0;
  |SI Modo ! 4; |ACABA; |FINSI;
  |HAZ MGeneral;
|FPRC;

|PROCESO MGeneral;
  |SI #0#1 < 80;
      nEjercicio = 2000 + #0#1;
  |SINO;
      nEjercicio = 1900 + #0#1;
  |FINSI;
  nEjerCobro = nEjercicio - 1;

  Salir = 0;
  |PARA; |SI Salir = 0; |HACIENDO;
         |ABRE #4;
         #4#0 = #0#0;
         |LEE 040#4=;
         |SI FSalida ! 0;  |DDEFECTO #4;  |FINSI;
         |CIERRA #4;

         |ATRI I; |PINTA 0709, #4#2;
         |PINTA #0#0;    |PINTA #0#1;    |PINTA #0#2;    |PINTA #0#3;
         |PINTA #0#4;    |PINTA #0#5;    |PINTA #0#6;    |PINTA #0#7;
         |PINTA #0#8;    |PINTA #0#9;    |PINTA #0#10;   |PINTA #0#11;
         |PINTA #0#12;   |PINTA #0#13;   |PINTA #0#14;   |PINTA #0#15;
         |PINTA #0#16;   |PINTA #0#17;   |PINTA #0#21;   |PINTA #0#22;
         |PINTA #0#23;   |PINTA #0#24;

         |MENUG MGeneral;
         MGeneral2 = FSalida;
         Opcion    = FSalida;
         Salir     = 1;
         |SI Opcion ] 1; |Y Opcion [ 10;
             Salir = 0;
             |SI Opcion = 1; Clave = "A"; |HAZ Clave;  |FINSI;
             |SI Opcion = 2; Clave = "B"; |HAZ Clave;  |FINSI;
             |SI Opcion = 3; Clave = "C"; |HAZ Clave;  |FINSI;
             |SI Opcion = 4; Clave = "D"; |HAZ Clave;  |FINSI;
             |SI Opcion = 5; Clave = "E"; |HAZ Clave;  |FINSI;
             |SI Opcion = 6; Clave = "F"; |HAZ Clave;  |FINSI;
             |SI Opcion = 7; Clave = "G"; |HAZ Clave;  |FINSI;
             |SI Opcion = 8; Clave = "Z"; |HAZ Clave;  |FINSI;
             |SI Opcion = 9;  |Y Modo ! 4; |HAZ Recalc; |FINSI;
             |SI Opcion = 10; |Y Modo ! 4; |HAZ Manual; |FINSI;

             |PINTA #0#6;   |PINTA #0#7;   |PINTA #0#8;
             |PINTA #0#9;   |PINTA #0#10;  |PINTA #0#11;
             |PINTA #0#12;  |PINTA #0#13;  |PINTA #0#14;
             |PINTA #0#15;  |PINTA #0#16;  |PINTA #0#17;
             |PINTA #0#21;  |PINTA #0#22;  |PINTA #0#23;  |PINTA #0#24;
         |FINSI;
  |SIGUE;

  |PINPA #0#0;
|FPRC;

|RUTINA ClaveBaja;
  #1#0  = #0#0;
  #1#1  = #0#1;
  #1#2  = Clave;
  #1#3  = "            ";
  #1#35 = "N";
  #1#36 = "N";
  #1#4  = DLocal;
  #1#5  = "N";
  #1#37 = "N";
|FRUT;

|RUTINA ClaveAlta;
  #1#0  = #0#0;
  #1#1  = #0#1;
  #1#2  = Clave;
  #1#3  = "zzzzzzzzzzzz";
  #1#35 = "S";
  #1#36 = "S";
  #1#4  = HLocal;
  #1#5  = "S";
  #1#37 = "S";
|FRUT;

|RUTINA ClaveBajaN;
  #900#0 = #0#0;
  #900#1 = #0#1;
  #900#2 = Clave;
  #900#3 = "          ";
  #900#35 = "N";
  #900#36 = "N";
  #900#4 = DLocal;
  #900#5 = "N";
  #900#6 = "                                          ";
  #900#37 = "N";
|FRUT;

|RUTINA ClaveAltaN;
  #900#0 = #0#0;
  #900#1 = #0#1;
  #900#2 = Clave;
  #900#3 = "zzzzzzzzzz";
  #900#35 = "S";
  #900#36 = "S";
  #900#4 = HLocal;
  #900#5 = "S";
  #900#6 = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
  #900#37 = "S";
|FRUT;

|PROCESO Clave;
  |PUSHV 0501 2380;
  |PINPA #0#1;

  |SI Clave ! "Z";
      DLocal = "N ";
      HLocal = "S ";
      |ATRI R; |PINTA 1414, Clave; |ATRI r;
  |SINO;
      DLocal = "00";
      HLocal = "99";
      |ATRI R;
      |PINTA 1408, "Arrendamientos ";
      |PINTA 1619, "N.L";
      |ATRI r;
  |FINSI;

  |ATRI I;
  |SI Clave = "A";  |PINTA 1424, #0#12;  |PINTA 1430, #0#6;   |FINSI;
  |SI Clave = "B";  |PINTA 1424, #0#13;  |PINTA 1430, #0#7;   |FINSI;
  |SI Clave = "C";  |PINTA 1424, #0#14;  |PINTA 1430, #0#8;   |FINSI;
  |SI Clave = "D";  |PINTA 1424, #0#15;  |PINTA 1430, #0#9;   |FINSI;
  |SI Clave = "E";  |PINTA 1424, #0#16;  |PINTA 1430, #0#10;  |FINSI;
  |SI Clave = "F";  |PINTA 1424, #0#23;  |PINTA 1430, #0#21;  |FINSI;
  |SI Clave = "G";  |PINTA 1424, #0#24;  |PINTA 1430, #0#22;  |FINSI;
  |SI Clave = "Z";  |PINTA 1424, #0#17;  |PINTA 1430, #0#11;  |FINSI;
  |ATRI i;

  |SI Clave ! "Z";
      |PINTA 1326, "                                                     ";
      |ATRI P; |PINTA 1020, Clave;  |ATRI 0;
      |C_M #1#18, 1, "N";  |C_V #1#18, 1, "N";
      |C_M #1#24, 1, "N";  |C_V #1#24, 1, "N";
      |C_M #1#25, 1, "N";  |C_V #1#25, 1, "N";

      |C_M #1#4,  1, "S";  |C_V #1#4,  1, "S";
      |C_M #1#5,  1, "S";  |C_V #1#5,  1, "S";
      |C_M #1#17, 1, "S";  |C_V #1#17, 1, "S";
      |C_A #1#4,  1, 01;
      |C_M #1#35, 1, "S";  |C_V #1#35, 1, "S";
      |C_M #1#36, 1, "S";  |C_V #1#36, 1, "S";
      |C_M #1#37, 1, "S";  |C_V #1#37, 1, "S";
      |SI Clave ! "A";
          |C_M #1#35, 1, "N";  #1#35 = "N";
      |FINSI;
      |SI Clave ! "A"; |Y Clave ! "B";
          |C_M #1#4, 1, "N";   #1#4 = "N ";
          |C_M #1#5, 1, "N";   #1#5 = "N";
          |C_M #1#36, 1, "N";  #1#36 = "N";
          |C_M #1#37, 1, "N";  #1#37 = "N";
      |FINSI;
      |SI nEjercicio < 2014;
          |C_M #1#35, 1, "N";  #1#35 = "N";
          |C_M #1#36, 1, "N";  #1#36 = "N";
          |C_M #1#37, 1, "N";  #1#37 = "N";
      |FINSI;
  |SINO;
      |ATRI R; |PINTA 1038, "Hoja Anexo. Arrendamientos Locales";  |ATRI r;
      |PINTA 1302, "                       ";
      |C_M #1#18, 1, "S";  |C_V #1#18, 1, "S";
      |C_M #1#24, 1, "S";  |C_V #1#24, 1, "S";
      |C_M #1#25, 1, "S";  |C_V #1#25, 1, "S";

      |C_M #1#4,  1, "S";  |C_V #1#4,  1, "S";
      |C_M #1#5 , 1, "N";  |C_V #1#5,  1, "N";
      |C_M #1#35, 1, "N";  |C_V #1#35, 1, "N";
      |C_M #1#36, 1, "N";  |C_V #1#36, 1, "N";
      |C_M #1#17, 1, "N";  |C_V #1#17, 1, "N";
      |C_A #1#4, 1, 80;
  |FINSI;

  |C_M #1#19,1,"S";
  |SI nEjercicio > 2010; |Y Clave ! "Z";
      |C_M #1#19,1,"N";
  |FINSI;
  ModoL = 0;
  |SI Modo = 1; |ENTLINEAL #1#1, -4, 2, 22, 0, ClaveBaja, ClaveAlta; |FINSI;
  |SI Modo = 2; |ENTLINEAL #1#1, -4, 2, 22, 0, ClaveBaja, ClaveAlta; |FINSI;
  |SI Modo = 4; |ENTLINEAL #1#1, -4, 4, 22, 0, ClaveBaja, ClaveAlta; |FINSI;

  |POPV;
|FPRC;

|PROCESO TipoOpe;
     |C_M #1Campo, 0, aAlfa1;
     |SI aAlfa1 = "N"; |ACABA; |FINSI;
     |SI FSalida = 2; |ACABA; |FINSI;

     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 1; |ACABA; |FINSI;

     aAlfa = #1Campo; |QBF aAlfa;
     |SI aAlfa = "S";
         |SI Campo = 35;
             #1#36 = "N";  |PINTA #1#36;
             #1#4  = "N "; |PINTA #1#4;
             #1#5  = "N";  |PINTA #1#5;
         |FINSI;
         |SI Campo = 36;
             #1#35 = "N";  |PINTA #1#35;
             #1#4  = "N "; |PINTA #1#4;
             #1#5  = "N";  |PINTA #1#5;
         |FINSI;
         |SI Campo = 4;
             #1#35 = "N"; |PINTA #1#35;
             #1#36 = "N"; |PINTA #1#36;
             #1#5  = "N"; |PINTA #1#5;
         |FINSI;
         |SI Campo = 5;
             #1#35 = "N";  |PINTA #1#35;
             #1#36 = "N";  |PINTA #1#36;
             #1#4  = "N "; |PINTA #1#4;
         |FINSI;
     |FINSI;

     |C_M #1#37, 1, "S";
     |SI #1#35 = "S"; |O #1#36 = "S";
        |C_M #1#37, 1, "N";
        #1#37 = "N"; |PINTA #1#37;
     |FINSI;
|FPRC;

|PROCESO MensaCampo4; |TIPO 7;
  |ATRI R;
  |SI #1#2 ! "Z";
      |MENSA "0400 Es Operacion de Seguros.";
  |SINO;
      |MENSA "0400 Numero de Local";
  |FINSI;
|FPRC;

|PROCESO MayorL; |TIPO 0;
  |BLIN 04;
  |ATRI r;

  |SI Campo ! 4;
      |SI Clave = "Z"; |ACABA; |FINSI;

      #1Campo = #1Campo > #1Campo;
  |FINSI;

  |SI Campo = 4;
      |SI Clave ! "Z";
          #1Campo = #1Campo > #1Campo;
          aAlfa = #1#4 % 101;
          |SI aAlfa ! "S"; |Y aAlfa ! "N";
              |ERROR;
          |SINO;
              #1#4 = aAlfa;
          |FINSI;
      |SINO;
          nNume = #1#4; aAlfa = nNume; |QBF aAlfa;
          aAlfa = ("00" + aAlfa) % -102;
          #1#4 = aAlfa;
      |FINSI;
  |FINSI;

  |PINTA #1Campo;
|FPRC;

|PROCESO DniBlanco; |TIPO 7;
  |SI #1#6 = "                                        "; |Y #1#19 = 0;
      #1#3 = "zzzzzzzzzzzz"; |PINTA #1#3;
      |SI Clave ! "Z"; #1#4 = "N";  |PINTA #1#4;  |FINSI;
      |SI Clave ! "Z"; #1#5 = "N";  |PINTA #1#5;  |FINSI;
      |ACABA;
  |FINSI;

  |SI ModoL = 1;
      #1#3 = "zzzzzzzzzzzz";
      #1#4 = "N";
      |SI Clave = "Z"; #1#4 = "01"; |FINSI;
      #1#5 = "N";
      #1#35 = "N";
      #1#36 = "N";
      #1#37 = "N";
      |PTEC 809;
      |PTEC 809;
      ModoL = 0;
  |FINSI;
|FPRC;

|PROCESO CodPostal; |TIPO 0;
     aAlfa1 = ("00"  + #1#13) % -102;
     aAlfa2 = ("000" + #1#14) % -103;
     aAlfa1 = aAlfa1 + aAlfa2;
     #1#39 = aAlfa1;
|FPRC;

|PROCESO CodMuni; |TIPO 7;

     aAlfa1 = #1#39; |QBF aAlfa1;
     |SI aAlfa1 = ""; |O aAlfa1 = "00000";
         |HAZ CodPostal;
     |FINSI;

     |SI #1#2 ! "Z"; |ACABA; |FINSI;

     aAlfa2 = #1#25; |QBF aAlfa2;
     |SI aAlfa2 = ""; |O #1#25 = "00000";
         |ABRE #dsm210mu;
         #dsm210mu#0 = #1#39;
         #dsm210mu#1 = #1#25;
         |LEE 041#dsm210mu.];
         |SI FSalida = 0; |Y #dsm210mu#0 = #1#39;
             #1#25 = #dsm210mu#1;
             |PINTA #1#25;
         |FINSI;
         |CIERRA #dsm210mu;
     |FINSI;
|FPRC;

|PROCESO LeeGeneral; |TIPO 7;
  ModoL = (FEntrada / 100) ! 0;
  |SI ModoL ! 1; |ACABA; |FINSI;

  |ABRE #2;
  #2#0 = #1#3;
  |LEE 040#2=;
  |SI FSalida ! 0; |CIERRA #2; |ACABA; |FINSI;
  |CIERRA #2;

  #1#6  = #2#1;    |PINTA #1#6;   || Apellidos y Nombre
  #1#7  = #2#2;    |PINTA #1#7;   || SG
  #1#8  = #2#3;    |PINTA #1#8;   || Calle
  #1#9  = #2#4;    |PINTA #1#9;   || Numero
  #1#11 = #2#5;    |PINTA #1#11;  || Piso
  #1#12 = #2#6;    |PINTA #1#12;  || Puerta
  #1#13 = #2#7;    |PINTA #1#13;  || Codigo Provincia
  #1#14 = #2#8;    |PINTA #1#14;  || Codigo Poblacion
  #1#15 = #2#10;   |PINTA #1#15;  || Poblacion
  #1#16 = #2#9;    |PINTA #1#16;  || Provincia
  #1#29 = "";
  |HAZ CodMuni;

  |SI #1#13 = 99;
      #1#21 = #2#14;
  |FINSI;
|FPRC;

|PROCESO Paises;
  |C_M #1#21, 1, "S";
  |SI #1#13 ! 99;
      #1#21 = "";  |PINTA #1#21;  |C_M #1#21, 1, "N";
  |FINSI;
|FPRC;

|PROCESO Importe;
  |ABRE #3;
  |LEE 040#3p;
  |SI FSalida ! 0; |DDEFECTO #3; |FINSI;
  |CIERRA #3;

  |SI Clave = "A"; CantiTope = #3#1;  |FINSI;
  |SI Clave = "B"; CantiTope = #3#2;  |FINSI;
  |SI Clave = "B"; |Y #1#5 = "S";  CantiTope = 0;  |FINSI;
  |SI Clave = "C"; CantiTope = #3#3;  |FINSI;
  |SI Clave = "D"; CantiTope = #3#4;  |FINSI;
  |SI Clave = "E"; CantiTope = #3#25; |FINSI;
  |SI Clave = "F"; CantiTope = 0;     |FINSI;
  |SI Clave = "G"; CantiTope = 0;     |FINSI;
  |SI Clave = "Z"; CantiTope = 0;     |FINSI;

  nMaxCobro = 6000.01;
|FPRC;

|RUTINA ClaveBaja44;
     #44#0  = #1#0;
     #44#1  = #1#1;
     #44#2  = #1#2;
     #44#3  = #1#3;
     #44#4  = #1#4;
     #44#5  = #1#5;
     #44#8  = #1#35;
     #44#9  = #1#36;
     #44#10 = #1#37;
     #44#6  = nEjerCobro;
|FRUT;

|RUTINA ClaveAlta44;
     #44#0  = #1#0;
     #44#1  = #1#1;
     #44#2  = #1#2;
     #44#3  = #1#3;
     #44#4  = #1#4;
     #44#5  = #1#5;
     #44#8  = #1#35;
     #44#9  = #1#36;
     #44#10 = #1#37;
     #44#6  = 2008;
|FRUT;

|PROCESO Metalico;
    |ENTLINEAL #1#44, -7, 2, 21,0, ClaveBaja44,ClaveAlta44;

    #1#26 = 0; nOpera = 0; |BUCLE SumayBorra;
|FPRC;

|PROCESO Tipo7C410; |TIPO 7;
   nModo = (FEntrada / 100) ! 0;
   |SI nModo = 1;
       |SI #44#6 > 2999;
           #44#6 = nEjer - 1; |PINTA #44#6;
       |FINSI;
   |FINSI;
|FPRC;

|PROCESO Tipo2C410; |TIPO 2;
  |SI Clave = "A";
      #0#12 = #0#12 +. 1;
  |FINSI;
  |SI Clave = "B";
      #0#13 = #0#13 +. 1;
  |FINSI;
|FPRC;

|PROCESO ImporteCobro; |TIPO 0;
     |SI #44#7 < nMaxCobro;
         aMenav = "     Introduzca Importe igual o superior a " + nMaxCobro;
         |MENAV aMenav;
         |ERROR;
     |FINSI;
     nEjer = #44#6;
|FPRC;

|PROCESO Modi2011;

     aAlfa = "S"; aAlfa1 = "N";
     |SI #1#2  ! "A"; |Y #1#2 ! "B"; aAlfa = "N"; |FINSI;
     |SI #1#2  = "B"; |O #1#2 = "A";
         |SI #1#4 = "N "; |Y #1#5 = "N"; aAlfa1 = "S"; |FINSI;
     |FINSI;
     aAlfa2 = aAlfa;
     |SI nEjercicio ] 2012; |Y #1#2 ! "B"; aAlfa2 = "N"; |FINSI;

     |C_V #943#1,  1, aAlfa2; |C_M #943#1,  1, aAlfa2;
     |C_V #943#3,  1, aAlfa2; |C_M #943#3,  1, aAlfa2;
     |C_V #943#2,  1, aAlfa;
     |C_V #943#8,  1, aAlfa; |C_M #943#8,  1, aAlfa1;
     |C_V #943#9,  1, aAlfa; |C_M #943#9,  1, aAlfa1;
     |C_V #943#10, 1, aAlfa; |C_M #943#10, 1, aAlfa1;
     |C_V #943#11, 1, aAlfa; |C_M #943#11, 1, aAlfa1;

     |C_M #943#0,  1, "N";
     |C_M #943#4,  1, "S";
     |C_M #943#5,  1, "S";
     |C_M #943#6,  1, "S";
     |C_M #943#7,  1, "S";
     |C_M #943#12, 1, "N";  |C_V #943#12, 1,"N";
     |SI nSwSolo = 1;
         |C_M #943#1, 1, "N";
         |C_M #943#4, 1, "N";
         |C_M #943#5, 1, "N";
         |C_M #943#6, 1, "N";
         |C_M #943#7, 1, "N";
     |SINO;
         |SI #1#37 = "S";
             |C_M #943#0, 1, "S";
             |C_M #943#4, 1, "N";
             |C_M #943#5, 1, "N";
             |C_M #943#6, 1, "N";
             |C_M #943#7, 1, "N";
             |C_M #943#12, 1, "S";  |C_V #943#12, 1, "S";
        |FINSI;
     |FINSI;
|FPRC;

|PROCESO Sacar2011;
     |DDEFECTO #943;

     nNegativo = #1#19;
     |SI nNegativo < 0; nNegativo = - #1#19; |FINSI;
     |SI nNegativo < CantiTope; #1#22 = 0; |FINSI;
     #943#0 = #1#19;
     #943#1 = #1#22
     #943#2 = #1#23;
     |PARA nPara1 = 26; |SI nPara1 [ 34; |HACIENDO nPara1 = nPara1 + 1;
           nPara2 = nPara1 - 23;
           #943nPara2 = #1nPara1;
     |SIGUE;
     #943#12 = #1#38;

     |PINPA #0#943;
     |SI #1#2 ! "A"; |Y #1#2 ! "B";
         |BLANCO 1325 2280;
         |CUADRO 0925 1380;
     |FINSI;
     |SI nEjercicio ] 2012;
         |SI #1#2 = "A";
             |BLANCO 1625 2280;
             |CUADRO 0925 1680;
         |FINSI;
     |FINSI;

     |HAZ Modi2011;
     |PINDA #0#943;
     |SI #1#37 = "N";
         |PINTA 1058, "                     ";
     |FINSI;

     |SI nEjercicio ] 2012;
         |SI #1#2 = "B";
             |PINPA #0#44;
             |ENTLINEAL #1#44, -7, 7, 21,1, ClaveBaja44,ClaveAlta44;
         |FINSI;
     |SINO;
         |SI #1#2 = "A"; |O #1#2 = "B";
             |PINPA #0#44;
             |ENTLINEAL #1#44, -7, 7, 21,1, ClaveBaja44,ClaveAlta44;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO ImporteW143; |TIPO 0;
      |SI #1#37 = "N";
          #943#0 = #943#4 + #943#5 + #943#6  + #943#7;  |PINTA #943#0;
      |FINSI;
      #943#2 = #943#8 + #943#9 + #943#10 + #943#11; |PINTA #943#2;

      |SI FSalida = 2; |ACABA; |FINSI;

      |SI Campo = 7;
          |HAZ Modi2011;
          nNegativo = #943#0;
          |SI nNegativo < 0; nNegativo = - #943#0; |FINSI;

          aMenav = "";
          |SI nNegativo < CantiTope;
              aMenav = "     Introduzca Importe igual o superior a " + CantiTope + ". (sin signo)";
          |FINSI;
          |SI nEjercicio ] 2012;
              |SI #1#2 = "B";
                  |SI #943#0 = 0;
                      aMenav=  "    Introducir solo Importes en Metalico Ejercicios Anteriores";
                  |FINSI;
              |FINSI;
          |SINO;
              |SI #1#2 = "A"; |O #1#2 = "B";
                  |SI #943#0 = 0;
                      aMenav=  "    Introducir solo Importes en Metalico Ejercicios Anteriores";
                  |FINSI;
              |FINSI;
          |FINSI;
          |SI aMenav ! "";
              |MENAV aMenav;
              |SI #943#0 ! 0;
                  |SI #1#2 ! "A"; |Y #1#2 ! "B";
                      |ERROR;
                  |SINO;
                      |CONFI "   Es Correcto";
                      |SI FSalida ! 0;
                          |ERROR;
                      |FINSI;
                  |FINSI;
                  |ACABA;
              |SINO;
                  |C_M #943#1,  1, "N";
                  |C_M #943#8,  1, "N";
                  |C_M #943#9,  1, "N";
                  |C_M #943#10, 1, "N";
                  |C_M #943#11, 1, "N";
                  |SI nEjercicio ] 2012;
                      |SI #1#2 ! "B";
                          |ERROR;
                      |FINSI;
                  |SINO;
                      |SI #1#2 ! "A"; |Y #1#2 ! "B";
                          |ERROR;
                      |FINSI;
                  |FINSI;
              |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0C12w143; |TIPO 0;
     |C_M #943#12, 0, aAlfa1;
     |SI aAlfa1 = "N"; |ACABA; |FINSI;
     |SI FSalida = 10;
         #943#12 = #943#0; |PINTA #943#12;
     |FINSI;
|FPRC;

|PROCESO Tipo12w143; |TIPO 12;
|FPRC;

|PROCESO Tipo7C1w143; |TIPO 7;
    |SI #943#0 = 0;
        #943#1 = 0;
       |C_V #943#1,0,aAlfa1;
       |SI aAlfa1 = "S";
           |PINTA #943#1;
       |FINSI;
   |FINSI;
|FPRC;

|PROCESO Tipo0C1w143; |TIPO 0;
   |C_M #943Campo, 0, aAlfa1;
   |SI aAlfa1 = "N"; |ACABA; |FINSI;

   |SI #943#1 < nMaxCobro; |Y #943#1 ! 0;
       aMenav = "   SEl Importe es inferior a " + nMaxCobro + ". Continuar";
       |MENAV aMenav;
       #943#1 = 0; |PINTA #943#1;
       |ERROR;
       |ACABA;
   |FINSI;
|FPRC;

|PROCESO Tipo7C3w143; |TIPO 7;
   |C_M #943Campo, 0, aAlfa1;
   |SI aAlfa1 = "N"; |ACABA; |FINSI;

   |HAZ Metalico;
   #943#3 = #1#26;  |PINTA #943#3;
|FPRC;

|PROCESO Tipo0C3w143; |TIPO 0;
   #943#3 = #1#26;
   |C_V #943#3,0,aAlfa1;
   |SI aAlfa1 = "S"; |PINTA #943#3; |FINSI;
|FPRC;

|PROCESO Pedir2011;

     nSwSolo = 0;
     |||SI #1#2 = "B"; |Y #1#5 = "S";
     ||      nSwSolo = 1;  esto es de modelos, aqui son manuales
     || |FINSI;
     |HAZ Sacar2011;

     |SI nSwSolo = 1;
         |ATRI I; |PINTA 0926, "Introduzca Importes en Metalico Ejercicios Anteriores"; |ATRI 0;
     |FINSI;

     |ENDATOS #2#943;
     |SI FSalida = 0;
         |SI #1#37 = "N";
             #943#0 = #943#4 + #943#5 + #943#6  + #943#7;
         |FINSI;
         #943#2 = #943#8 + #943#9 + #943#10 + #943#11;

         #1#19 = #943#0;
         #1#22 = #943#1;
         #1#23 = #943#2;
         |PARA nPara1 = 26; |SI nPara1 [ 34; |HACIENDO nPara1 = nPara1 + 1;
               nPara2 = nPara1 - 23;
               #1nPara1 = #943nPara2;
         |SIGUE;
         #1#38 = #943#12;
     |FINSI;
|FPRC;

|PROCESO Error;

     |C_M #1#19, 0, aAlfa;

     |SI aAlfa = "S";
         aMenav = "";
         nNegativo = #1#19;
         |SI nNegativo < 0; |Y nEjercicio > 2010; nNegativo = - #1#19; |FINSI;

         |SI nNegativo < CantiTope;
             aMenav = "     Introduzca Importe igual o superior a " + CantiTope;
         |FINSI;
         |SI nEjercicio ] 2012;
             |SI #1#2 = "B";
                 |SI #1#19 = 0;
                     aMenav=  "    Introducir solo Importes en Metalico Ejercicios Anteriores";
                 |FINSI;
             |FINSI;
         |SINO;
             |SI #1#2 = "A"; |O #1#2 = "B";
                 |SI #1#19 = 0; |Y nEjercicio ] 2010;
                    aMenav=  "    Introducir solo Importes en Metalico Ejercicios Anteriores";
                 |FINSI;
             |FINSI;
         |FINSI;
         |SI aMenav ! "";
             |MENAV aMenav;
             |SI #1#19 ! 0; |O nEjercicio < 2010;
                 |ERROR;
                 |ACABA;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nEjercicio < 2008; |ACABA; |FINSI;

     |SI #1#2 ! "A";  |Y #1#2 ! "B"; |Y nEjercicio < 2011;
         |ACABA;
     |FINSI;
     |SI #1#2 = "Z";  |Y nEjercicio ] 2011;
          #1#27 = #1#14;
          #1#28 = 0; #1#29 = 0; #1#30 = 0;
          |ACABA;
     |FINSI;

|SI nEjercicio ] 2010;
     nEjer      = nEjercicio;
     nEjerCobro = nEjercicio - 1;

     |PUSHV 0925 2380;
     |SI nEjercicio = 2010;
         |BLANCO 1025 2280;
         |CUADRO 1025 1480;

         nSwSolo = 0;
         |SI #1#19 = 0; nSwSolo = 1;  |FINSI;

         |SI nSwSolo = 1;
             |ATRI I; |PINTA 1026, "Introduzca Importes en Metalico Ejercicios Anteriores"; |ATRI 0;
         |FINSI;

         |PINTA 1126, "Percibido en metalico Ejercicio Actual...:            ";
         |PINTA 1226, "Percibido en metalico Ejer.Anteriores....:            ";
         |PINTA 1326, "Percibido por transmisiones sujetas a IVA:            ";

         |PINPA #0#44;

         E_inf = "-999999999.?EURO";
         E_sup = "9999999999";

         |SI #1#19 < CantiTope; #1#22 = 0; |FINSI;
         nCampo1  = #1#22;   |PINTA 1169, #1#22;
         nCampo3  = #1#26;   |PINTA 1269, #1#26;
         nCampo2  = #1#23;   |PINTA 1369, #1#23;
         |ENTLINEAL #1#44, -7, 7, 21,1, ClaveBaja44,ClaveAlta44;

         |ET nCampo1;

             E_inf = "-999999999.?EURO";
             E_sup = "9999999999";
             #1#26 = nCampo3;  |PINTA 1269, #1#26;
             |SI #1#19 ] CantiTope; |Y nSwSolo = 0;
                 nCampo1 = 1169 ? 1;
                 |SI FSalida = 1;  |VETE Abajo;    |FINSI;
                 |SI FSalida = 7;  |VETE Abajo;    |FINSI;
                 #1#22 = nCampo1;  |PINTA 1169, #1#22;
                 |SI #1#22 < nMaxCobro; |Y #1#22 ! 0;
                     aMenav = "     Introduzca Importe igual o superior a " + nMaxCobro;
                     |MENAV aMenav;
                     #1#22 = 0; |PINTA 1169,#1#22;
                     |VETE nCampo1;
                 |FINSI;
             |FINSI;

         |ET nCampo3;
              #1#23 = nCampo2;  |PINTA 1369, #1#23;
              nCampo3 = 1269 ? 1;
              |SI FSalida = 1;  |VETE Abajo;    |FINSI;
              |SI FSalida = 2;  |VETE nCampo1;  |FINSI;
              |SI FSalida = 7;  |VETE Abajo;    |FINSI;
              nCampo3  = #1#26;   |PINTA 1269, #1#26;
              |SI FSalida = 3;  |VETE nCampo2;    |FINSI;
              |HAZ Metalico;
              nCampo3  = #1#26;   |PINTA 1269, #1#26;

         |ET nCampo2;
             E_inf = "-999999999.?EURO";
             E_sup = "9999999999";
             |SI #1#19 ] CantiTope; |Y nSwSolo = 0;
                 nCampo2 = 1369 ? 1;
                 |SI FSalida = 2;  |VETE nCampo3;  |FINSI;
                 #1#23 = nCampo2;  |PINTA 1369, #1#23;
             |FINSI;

         |ET Abajo;
             #1#22 = nCampo1;  |PINTA 1169, #1#22;
             #1#26 = nCampo3;  |PINTA 1269, #1#26;
             #1#23 = nCampo2;  |PINTA 1369, #1#23;

     |SINO;

           |HAZ Pedir2011;

     |FINSI;
     |POPV;
     |BLIN 4;
     |SI nEjercicio > 2010; |PINTA #1#19; |FINSI;
|SINO;

     |PUSHV 1325 1680;
     |BLANCO 1325 1680;
     |CUADRO 1325 1680;

     |PINTA 1426, "Percibido en metalico ...................:            ";
     |PINTA 1526, "Percibido por transmisiones sujetas a IVA:            ";

     E_inf = "-999999999.?EURO";
     E_sup = "9999999999";

     nCampo1  = #1#22;   |PINTA 1469, #1#22;
     nCampo2  = #1#23;   |PINTA 1569, #1#23;

     |ET nCampo1_2008;
         nCampo1 = 1469 ? 1;
         |SI FSalida = 1;  |VETE Abajo_2008;    |FINSI;
         |SI FSalida = 7;  |VETE Abajo_2008;    |FINSI;

     |ET nCampo2_2008;
         nCampo2 = 1569 ? 1;
         |SI FSalida = 2;  |VETE nCampo1_2008;  |FINSI;

     |ET Abajo_2008;
         #1#22 = nCampo1;
         #1#23 = nCampo2;

     |POPV;
|FINSI;

|FPRC;

|PROCESO Tipo11; |TIPO 11;

     |SI #0#1 < 80;
         nEjercicio = 2000 + #0#1;
     |SINO;
         nEjercicio = 1900 + #0#1;
     |FINSI;
     nEjerCobro = nEjercicio - 1;

     |SI FSalida =  10;
          eaVarDni = #1Campo;
          enCalcCif = 1;
          |HAZ CalculoDNI;
          #1Campo = eaVarDni;
          |PINTA #1Campo;
          |ERROR;
     |FINSI;

     |SI FSalida = 11;
         |DBASE aPathModelo;  |QBT aPathModelo;
         aDef = aPathModelo + "def/eosm0010.mas";
         |CARGA_DEF aDef, reflejo@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def eosm0010.mas";
             |MENAV aAlfa;
             |ERROR;
         |FINSI;

         |C_V #900#22, 1, "S";
         |C_V #900#23, 1, "S";
         |C_V #900#26, 1, "S";

         |ABRE #900;
         |CONSULTA_F_CLAVE #2#900, ClaveBajaN, ClaveAltaN;
         |SI FSalida = 0;
             #1#0 = #900#0;
             #1#1 = #900#1;
             #1#2 = #900#2;
             #1#3 = #900#3;
             #1#4 = #900#4;
             #1#5 = #900#5;
             #1#6 = #900#6;
             #1#35 = #900#35;
             #1#36 = #900#36;
             #1#37 = #900#37;
             |LEE 000#1=;
         |FINSI;
         |CIERRA #900;

         |DESCARGA_DEF #reflejo@;

         |PTEC 809;
         |PTEC 808;
         |PONCONTROL  23, "SI";
     |FINSI;

     |SI FSalida = 12;
         |SI #1#2 ! "A";  |Y #1#2 ! "B"; |Y nEjercicio < 2011;
             |ACABA;
         |FINSI;
         |SI #1#2 = "Z"; |Y nEjercicio > 2010; |ACABA; |FINSI;

         |SI nEjercicio < 2008; |ACABA; |FINSI;

         |SI nEjercicio ] 2010;
             |PUSHV 0925 2480;
             |SI nEjercicio > 2010;
                 |HAZ Sacar2011;
             |SINO;
                 |BLANCO 1025 2280;
                 |CUADRO 1025 1480;

                 |PINTA 1126, "Percibido en metalico Ejercicio Actual...:            ";
                 |PINTA 1226, "Percibido en metalico Ejer. Anteriores ..:            ";
                 |PINTA 1326, "Percibido por transmisiones sujetas a IVA:            ";

                 |PINTA 1169, #1#22;
                 |PINTA 1269, #1#26;
                 |PINTA 1369, #1#23;

                 |ENTLINEAL #1#44, -7, 7, 21,1, ClaveBaja44,ClaveAlta44;
             |FINSI;
         |SINO;
             |PUSHV 1325 1680;
             |BLANCO 1325 1680;
             |CUADRO 1325 1680;

             |PINTA 1426, "Percibido en metalico ...................:            ";
             |PINTA 1526, "Percibido por transmisiones sujetas a IVA:            ";

             |PINTA 1469, #1#22;
             |PINTA 1569, #1#23;

         |FINSI;
         |PAUSA;

         |POPV;

         |ERROR;

     |FINSI;
|FPRC;

|PROCESO Tipo2L; |TIPO 2;
  nModo = (FEntrada / 100) ! 0;
  |HAZ Importe;
||  |SI #1#19 [ CantiTope; |Y nModo ! 3;
||      Mensa = "     Introduzca cantidad superior a : " + CantiTope;
||      |MENAV Mensa;
||      |ERROR;
||      |ACABA;
||  |FINSI;

  |ATRI I;
  |SI Clave = "A";
      |SI #1#19 ! 0;
          #0#12 = #0#12 +. 1;      |PINTA 1424, #0#12;
      |FINSI;
  |FINSI;
  |SI Clave = "B";
      |SI #1#19 ! 0;
          #0#13 = #0#13 +. 1;      |PINTA 1424, #0#13;
      |FINSI;
  |FINSI;
  |SI Clave = "C";  #0#14 = #0#14 +. 1;      |PINTA 1424, #0#14; |FINSI;
  |SI Clave = "D";  #0#15 = #0#15 +. 1;      |PINTA 1424, #0#15; |FINSI;
  |SI Clave = "E";  #0#16 = #0#16 +. 1;      |PINTA 1424, #0#16; |FINSI;
  |SI Clave = "F";  #0#23 = #0#23 +. 1;      |PINTA 1424, #0#23; |FINSI;
  |SI Clave = "G";  #0#24 = #0#24 +. 1;      |PINTA 1424, #0#24; |FINSI;
  |SI Clave = "Z";  #0#17 = #0#17 +. 1;      |PINTA 1424, #0#17; |FINSI;

  |SI Clave = "A";  #0#6  = #0#6  +. #1#19;  |PINTA 1430, #0#6;  |FINSI;
  |SI Clave = "B";  #0#7  = #0#7  +. #1#19;  |PINTA 1430, #0#7;  |FINSI;
  |SI Clave = "C";  #0#8  = #0#8  +. #1#19;  |PINTA 1430, #0#8;  |FINSI;
  |SI Clave = "D";  #0#9  = #0#9  +. #1#19;  |PINTA 1430, #0#9;  |FINSI;
  |SI Clave = "E";  #0#10 = #0#10 +. #1#19;  |PINTA 1430, #0#10; |FINSI;
  |SI Clave = "F";  #0#21 = #0#21 +. #1#19;  |PINTA 1430, #0#21; |FINSI;
  |SI Clave = "G";  #0#22 = #0#22 +. #1#19;  |PINTA 1430, #0#22; |FINSI;
  |SI Clave = "Z";  #0#11 = #0#11 +. #1#19;  |PINTA 1430, #0#11; |FINSI;
  |ATRI i;

  |SI nModo = 3;
      nOpera = 1; |BUCLE SumayBorra;
  |FINSI;
|FPRC;

|PROCESO MiraDnimo347;  |TIPO 6;
     |SI #1Campo = "zzzzzzzzzzzz"; |ACABA; |FINSI;

     eaVarDni  = #1Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;

     aNifQbf1 = #1Campo;   |QBF aNifQbf1;
     aNifQbf2 = eaVarDni;  |QBF aNifQbf2;

     |SI aNifQbf1 ! aNifQbf2; |Y aNifQbf1 ! "";
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #1Campo = eaVarDni;  |PINTA #1Campo;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;
