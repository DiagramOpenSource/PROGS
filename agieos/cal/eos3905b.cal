|FICHEROS;
     eos3905b #0;
     eosactiv #1;
|FIN;

|VARIABLES;
     nCampo1 = 0;
     nCampo2 = 0;

     aAlfa   = "";
     nNume1  = 0;
     &enEjer = 0;
|FIN;

|PROCESO Activi5b;  |TIPO 0;
     nCampo2 = Campo;
     nCampo1 = nCampo2 - 1;

     |SI #0nCampo1 = " "; |Y #0nCampo2 = "    "; |ACABA; |FINSI;

     |ABRE #1;
     |SELECT #2#1;
     #1#0 = #0#69;
     #1#4 = #0nCampo1;
     #1#5 = #0nCampo2;
     #1#2 = #0#70;
     |LEE 040#1=;
     |SI FSalida ! 0;
         |MENAV "      No existe esta actividad en la empresa";
     |FINSI;
     |CIERRA #1;
|FPRC;

|PROCESO Tipo0C33_03;
     |C_M #0Campo, 0, aAlfa;
     |SI aAlfa = "N"; |ACABA; |FINSI;

     |SI Campo = 86; nCampo1 = 16; nCampo2 = 80; |FINSI;
     |SI Campo = 87; nCampo1 = 39; nCampo2 = 81; |FINSI;
     |SI Campo = 88; nCampo1 = 62; nCampo2 = 82; |FINSI;

     nNume1 = (#0nCampo1 % 35) ! 2;
     |SI #0nCampo2 = " ";
         #0Campo = 0;
     |SINO;
         |SI #0nCampo2 ! "1";
             |SI #0Campo > nNume1;
                 #0Campo = nNume1;
             |FINSI;
         |FINSI;
         |SI #0Campo [ 0; |ERROR; |FINSI;
     |FINSI;
     |PINTA #0Campo;
|FPRC;

|PROCESO Tipo0C34_03;
     |C_M #0Campo, 0, aAlfa;
     |SI aAlfa = "N"; |ACABA; |FINSI;

     |SI Campo = 89; nCampo1 = 16; nCampo2 = 83; |FINSI;
     |SI Campo = 90; nCampo1 = 39; nCampo2 = 84; |FINSI;
     |SI Campo = 91; nCampo1 = 62; nCampo2 = 85; |FINSI;

     nNume1 = (#0nCampo1 % 65) ! 2;
     |SI #0nCampo2 = " ";
         #0Campo = 0;
     |SINO;
         |SI #0nCampo2 ! "1";
             |SI #0Campo > nNume1;
                 #0Campo = nNume1;
             |FINSI;
         |FINSI;
         |SI #0Campo [ 0; |ERROR; |FINSI;
     |FINSI;
     |PINTA #0Campo;
|FPRC;

|PROCESO TotalModulo;

|| ... Primer Modulo
     #0#16 = #0#09 + #0#10 + #0#11 + #0#12 + #0#13 + #0#14 + #0#15;

     |SI #0#80 = " "; #0#86 = 0; |FINSI;
     |SI #0#83 = " "; #0#89 = 0; |FINSI;

     |SI enEjer = 2012;
         |SI #0#80 = "1"; #0#86 = (#0#16 % 35) ! 2; |FINSI;
         |SI #0#83 = "1"; #0#89 = (#0#16 % 65) ! 2; |FINSI;

         nNume1 = (#0#16 - (#0#86 + #0#89)) ! 2;
         |SI nNume1 < 0;
             |SI #0#89 ! 0;
                 #0#89 = (#0#89 + nNume1) ! 2;
             |SINO;
                 #0#86 = (#0#86 + nNume1) ! 2;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI enEjer ] 2013;
         #0#89 = 0;

         |SI #0#80 = "2"; #0#80 = ""; |FINSI;
         |SI #0#80 = " "; #0#86 = 0;  |FINSI;

         |C_M #0#86, 1, "N";
         |SI #0#80 = "1";
             #0#86 = (#0#16 % 20) ! 2;
             |C_M #0#86, 1, "S";
         |FINSI;
     |FINSI;

     #0#19 = ((#0#16 - #0#86 - #0#89 - #0#17) * #0#18) ! 2; || Resultado
     #0#21 = ((#0#16 - #0#86 - #0#89) % #0#20) ! 2;      || Total Cuota Minima
     |SI #0#18 ! 0;
         #0#21 = (#0#21 * #0#18) ! 2;         || Total Cuota Minima
     |FINSI;
     #0#21 = #0#21 + #0#71;                   || Devolucion otros paises
     #0#22 = #0#19;                           || Cuota derivada regiman general
     |SI #0#22 < #0#21;  #0#22 = #0#21;  |FINSI;


|| ... Segundo Modulo
     #0#39 = #0#32 + #0#33 + #0#34 + #0#35 + #0#36 + #0#37 + #0#38;

     |SI #0#81 = " "; #0#87 = 0; |FINSI;
     |SI #0#84 = " "; #0#90 = 0; |FINSI;

     |SI enEjer = 2012;
         |SI #0#81 = "1"; #0#87 = (#0#39 % 35) ! 2; |FINSI;
         |SI #0#84 = "1"; #0#90 = (#0#39 % 65) ! 2; |FINSI;

         nNume1 = (#0#39 - (#0#87 + #0#90)) ! 2;
         |SI nNume1 < 0;
             |SI #0#90 ! 0;
                 #0#90 = (#0#90 + nNume1) ! 2;
             |SINO;
                 #0#87 = (#0#87 + nNume1) ! 2;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI enEjer ] 2013;
         #0#90 = 0;

         |SI #0#81 = "2"; #0#81 = ""; |FINSI;
         |SI #0#81 = " "; #0#87 = 0;  |FINSI;

         |C_M #0#87, 1, "N";
         |SI #0#81 = "1";
             #0#87 = (#0#39 % 20) ! 2;
             |C_M #0#87, 1, "S";
         |FINSI;
     |FINSI;

     #0#42 = ((#0#39 - #0#87 - #0#90 - #0#40) * #0#41) ! 2; || Resultado
     #0#44 = ((#0#39 - #0#87 - #0#90) % #0#43) ! 2;    || Total Cuota Minima
     |SI #0#41 ! 0;
         #0#44 = (#0#44 * #0#41) ! 2;                  || Total Cuota Minima
     |FINSI;
     #0#44 = #0#44 + #0#72;                   || Devolucion otros paises
     #0#45 = #0#42;                           || Cuota derivada regiman general
     |SI #0#45 < #0#44;  #0#45 = #0#44;  |FINSI;


|| ... Tercer Modulo
     #0#62 = #0#55 + #0#56 + #0#57 + #0#58 + #0#59 + #0#60 + #0#61;

     |SI #0#82 = " "; #0#88 = 0; |FINSI;
     |SI #0#85 = " "; #0#91 = 0; |FINSI;

     |SI enEjer = 2012;
         |SI #0#82 = "1"; #0#88 = (#0#62 % 35) ! 2; |FINSI;
         |SI #0#85 = "1"; #0#91 = (#0#62 % 65) ! 2; |FINSI;

         nNume1 = (#0#62 - (#0#88 + #0#91)) ! 2;
         |SI nNume1 < 0;
             |SI #0#91 ! 0;
                 #0#91 = (#0#91 + nNume1) ! 2;
             |SINO;
                 #0#88 = (#0#88 + nNume1) ! 2;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI enEjer ] 2013;
         #0#91 = 0;

         |SI #0#82 = "2"; #0#82 = ""; |FINSI;
         |SI #0#82 = " "; #0#88 = 0;  |FINSI;

         |C_M #0#88, 1, "N";
         |SI #0#82 = "1";
             #0#88 = (#0#62 % 20) ! 2;
             |C_M #0#88, 1, "S";
         |FINSI;
     |FINSI;

     #0#65 = ((#0#62 - #0#88 - #0#91 - #0#63) * #0#64) ! 2; || Resultado
     #0#67 = ((#0#62 - #0#88 - #0#91) % #0#66) ! 2;   || Total Cuota Minima
     |SI #0#64 ! 0;
         #0#67 = (#0#67 * #0#64) ! 2;                 || Total Cuota Minima
     |FINSI;
     #0#67 = #0#67 + #0#73;                   || Devolucion otros paises
     #0#68 = #0#65;                           || Cuota derivada regiman general
     |SI #0#68 < #0#67;  #0#68 = #0#67;  |FINSI;


     |PINTA #0#16;  |PINTA #0#19;  |PINTA #0#21;  |PINTA #0#22;
     |PINTA #0#39;  |PINTA #0#42;  |PINTA #0#44;  |PINTA #0#45;
     |PINTA #0#62;  |PINTA #0#65;  |PINTA #0#67;  |PINTA #0#68;

     |PINTA #0#86;  |PINTA #0#87;  |PINTA #0#88;
     |PINTA #0#89;  |PINTA #0#90;  |PINTA #0#91;
|FPRC;

|PROCESO SiRenuncia;
     |C_M #0Campo,0, aAlfa;
     |SI aAlfa = "N"; |ACABA; |FINSI;

     nCampo1 = Campo - 3;
     |SI #0Campo = "S";
         #0nCampo1 = "N"; |PINTA #0nCampo1;
     |FINSI;
|FPRC;

|PROCESO SiCesa;
     |C_M #0Campo,0, aAlfa;
     |SI aAlfa = "N"; |ACABA; |FINSI;

     nCampo1 = Campo + 3;
     |SI #0Campo = "S";
         #0nCampo1 = "N"; |PINTA #0nCampo1;
     |FINSI;
|FPRC;

/*
|PROCESO TotalModulo;
     |C_M #0#16, 1, "S";
     |C_M #0#39, 1, "S";
     |C_M #0#62, 1, "S";
     |SI #0#80 = " "; |Y #0#83 = " ";
         #0#16 = #0#09 + #0#10 + #0#11 + #0#12 + #0#13 + #0#14 + #0#15;
         |C_M #0#16, 1, "N";
     |FINSI;
     |SI #0#81 = " "; |Y #0#84 = " ";
         #0#39 = #0#32 + #0#33 + #0#34 + #0#35 + #0#36 + #0#37 + #0#38;
         |C_M #0#39, 1, "N";
     |FINSI;
     |SI #0#82 = " "; |Y #0#85 = " ";
         #0#62 = #0#55 + #0#56 + #0#57 + #0#58 + #0#59 + #0#60 + #0#61;
         |C_M #0#62, 1, "N";
     |FINSI;

     #0#19 = (#0#16 - #0#17) * #0#18;         || Resultado
     #0#21 = #0#16 % #0#20;                   || Total Cuota Minima
     |SI #0#18 ! 0;
         #0#21 = #0#21 * #0#18;               || Total Cuota Minima
     |FINSI;
     #0#21 = #0#21 + #0#71;                   || Devolucion otros paises
     #0#22 = #0#19;                           || Cuota derivada regiman general
     |SI #0#22 < #0#21;  #0#22 = #0#21;  |FINSI;

     #0#42 = (#0#39 - #0#40) * #0#41;         || Resultado
     #0#44 = #0#39 % #0#43;                   || Total Cuota Minima
     |SI #0#41 ! 0;
         #0#44 = #0#44 * #0#41;               || Total Cuota Minima
     |FINSI;
     #0#44 = #0#44 + #0#72;                   || Devolucion otros paises
     #0#45 = #0#42;                           || Cuota derivada regiman general
     |SI #0#45 < #0#44;  #0#45 = #0#44;  |FINSI;

     #0#65 = (#0#62 - #0#63) * #0#64;         || Resultado
     #0#67 = #0#62 % #0#66;                   || Total Cuota Minima
     |SI #0#64 ! 0;
         #0#67 = #0#67 * #0#64;               || Total Cuota Minima
     |FINSI;
     #0#67 = #0#67 + #0#73;                   || Devolucion otros paises
     #0#68 = #0#65;                           || Cuota derivada regiman general
     |SI #0#68 < #0#67;  #0#68 = #0#67;  |FINSI;

     |PINTA #0#16;  |PINTA #0#19;  |PINTA #0#21;  |PINTA #0#22;
     |PINTA #0#39;  |PINTA #0#42;  |PINTA #0#44;  |PINTA #0#45;
     |PINTA #0#62;  |PINTA #0#65;  |PINTA #0#67;  |PINTA #0#68;
|FPRC;
*/
