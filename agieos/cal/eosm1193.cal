|FICHEROS;
     eosm1193;
     eosclien;
     eosp1193,MANTE; || Fichero Perceptores (hojas interiores)
     eosg1193,MANTE; || Fichero Gastos (hojas interiores)
|FIN;

|VARIABLES;
   Comodin = "";
   ModoEntrada = 0;
   FEstado = 0;

   Cont = 0;

   nEmpresa   = 0;
   nEjercicio = 0;

   aPersoCto  = "";
   aTelefCto  = "";
   fFecha     = @;
|FIN;

|PROCESO AntesEjer; |TIPO 7;
   fFecha = ~;
   Comodin = fFecha;
   Comodin = Comodin % -104;
   #eosm1193#Campo# = Comodin;
   |PINTA #eosm1193#Campo#;
|FPRC;

|PROCESO NombreAnt; |TIPO 7;
   nEmpresa   = #eosm1193#0;
   nEjercicio = #eosm1193#1;

   aPersoCto  = "";
   aTelefCto  = "";

   |SALVA_FICHA #eosm1193;
   |LEE 000#eosm1193.a;
   |SI FSalida = 0; |Y nEmpresa = #eosm1193#0;
      aPersoCto  = #eosm1193#22; |QBF aPersoCto;
      aTelefCto  = #eosm1193#23; |QBF aTelefCto;
   |FINSI;
   |REPON_FICHA #eosm1193;

   Comodin = #eosm1193#22; |QBF Comodin;
   |SI Comodin = "";
      |SI aPersoCto = "";
         |ABRE #eosclien;
         #eosclien#0 = #eosm1193#0;
         |LEE 010#eosclien.=;
         |SI FSalida = 0;
            #eosm1193#22 = #eosclien#2;  |PINTA #eosm1193#22;
            #eosm1193#23 = #eosclien#14; |PINTA #eosm1193#23;
         |FINSI;
         |CIERRA #eosclien;
      |SINO;
         #eosm1193#22 = aPersoCto; |PINTA #eosm1193#22;
         #eosm1193#23 = aTelefCto; |PINTA #eosm1193#23;
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO MiraEmpresa;
   |ABRE #eosclien;
   #eosclien#0 = #eosm1193#0;
   |LEE 010#eosclien.=;
   |SI FSalida = 0;
      Comodin = #eosclien#2 % 0130;
      |QBF Comodin;
      |ATRI I;
      |PINTA 0721 , Comodin;
      |ATRI N;
   |FINSI;
   |CIERRA #eosclien;
|FPRC;

|RUTINA inf;
   #eosp1193#0  = #eosm1193#0;
   #eosp1193#1  = #eosm1193#1;
   #eosp1193#2  = "            ";
   #eosp1193#9  = " ";
   #eosp1193#18 = 0000;
|FRUT;

|RUTINA sup;
   #eosp1193#0  = #eosm1193#0;
   #eosp1193#1  = #eosm1193#1;
   #eosp1193#2  = "zzzzzzzzzzzz";
   #eosp1193#9  = "z";
   #eosp1193#18 = 9999;
|FRUT;

|RUTINA inf1;
   #eosg1193#0 = #eosm1193#0;
   #eosg1193#1 = #eosm1193#1;
   #eosg1193#2 = "            ";
   #eosp1193#9  = " ";
   #eosp1193#18 = 0000;
|FRUT;

|RUTINA sup1;
   #eosg1193#0 = #eosm1193#0;
   #eosg1193#1 = #eosm1193#1;
   #eosg1193#2 = "zzzzzzzzzzzz";
|FRUT;

|PROCESO DatosPercep; |TIPO 2;
   |SI #eosp1193#9 = "C";
      #eosp1193#5  = " "; |PINTA #eosp1193#5;
      #eosp1193#7  = " "; |PINTA #eosp1193#7;
      #eosp1193#8  = " "; |PINTA #eosp1193#8;
      #eosp1193#11 = "0"; |PINTA #eosp1193#11;
      #eosp1193#12 = " "; |PINTA #eosp1193#12;
      #eosp1193#13 = " "; |PINTA #eosp1193#13;
      #eosp1193#14 = " "; |PINTA #eosp1193#14;
      #eosp1193#15 = " "; |PINTA #eosp1193#15;
      #eosp1193#16 = " "; |PINTA #eosp1193#16;
      #eosp1193#17 = " "; |PINTA #eosp1193#17;
      #eosp1193#18 = 0;   |PINTA #eosp1193#18;
   |FINSI;
   #eosm1193#3 = #eosm1193#3 +. 1;
   #eosm1193#4 = #eosm1193#4 +. #eosp1193#23;
   #eosm1193#5 = #eosm1193#5 +. #eosp1193#25;
   #eosm1193#7 = #eosm1193#7 +. #eosp1193#26;
   #eosm1193#6 = #eosm1193#6 +. #eosp1193#31;
|FPRC;

|PROCESO DatosGastos; |TIPO 2;
   #eosm1193#3 = #eosm1193#3 +. 1;
   #eosm1193#9 = #eosm1193#9 +. #eosg1193#5;
|FPRC;

|DEFBUCLE eosg1193;
#eosg1193#1;
;
#eosm1193#0,#eosm1193#1,"            ";
#eosm1193#0,#eosm1193#1,"zzzzzzzzzzzz";
;
NULL,DatosGastos;
|FIN;

|DEFBUCLE eosp1193;
#eosp1193#1;
;
#eosm1193#0,#eosm1193#1,"            "," ",0;
#eosm1193#0,#eosm1193#1,"zzzzzzzzzzzz","z",9999;
;
NULL,DatosPercep;
|FIN;

|PROCESO Version2015;
     |ATRI R;
     |PINTA 1941, "% multip.";
     |PINTA 1964, "Ing.Ejerc.Ant ";
     |ATRI 0;

     |C_M #eosp1193#32, 1, "N";
     |C_V #eosp1193#32, 1, "N";

     |C_M #eosp1193#21, 1, "S";
     |C_V #eosp1193#21, 1, "S";
     |C_P #eosp1193#21, 1, 2042;

     |C_M #eosp1193#26, 1, "S";
     |C_V #eosp1193#26, 1, "S";
     |C_P #eosp1193#26, 1, 2066;
|FPRC;

|PROCESO Version2016;
     |C_M #eosp1193#21, 1, "N";
     |C_V #eosp1193#21, 1, "N";

     |C_M #eosp1193#26, 1, "N";
     |C_V #eosp1193#26, 1, "N";
|FPRC;

|PROCESO Versiones;
     |SI #eosm1193#1 [ 2015;
         |HAZ Version2015;
     |FINSI;

     |SI #eosm1193#1 ] 2016;
         |HAZ Version2016;
     |FINSI;
|FPRC;

|PROCESO MantenLin;
   |PUSHV 0901 2380;
   |PINPA #0#eosp1193;
   |HAZ Versiones;

   |ENTLINEAL #1#eosp1193, 3, 1, 20, 0, inf, sup;
   FEstado = FSalida;
   |POPV;
   |SI FEstado ! 0 ; |ACABA; |FINSI;

   |PUSHV 0901 2380;
   |ENTLINEAL #1#eosg1193,3,1,20,1,inf1,sup1;
   |POPV;

   #eosm1193#3 = 0;
   #eosm1193#4 = 0;
   #eosm1193#5 = 0;
   #eosm1193#6 = 0;
   #eosm1193#7 = 0;
   #eosm1193#9 = 0;

   |BUCLE eosp1193;
   |BUCLE eosg1193;

   |PINTA #eosm1193#3;
   |PINTA #eosm1193#4;
   |PINTA #eosm1193#5;
   |PINTA #eosm1193#6;
   |PINTA #eosm1193#7;
   |PINTA #eosm1193#8;
   |PINTA #eosm1193#9;
|FPRC;


|PROCESO BajaGastos;
  |BORRA 020#eosg1193.a;
|FPRC;

|DEFBUCLE BajaGastos;
#eosg1193#1;
;
#eosm1193#0,#eosm1193#1,"            ";
#eosm1193#0,#eosm1193#1,"zzzzzzzzzzzz";
;
NULL,BajaGastos;
|FIN;

|PROCESO BajaPercep;
  |BORRA 020#eosp1193.a;
|FPRC;

|DEFBUCLE BajaPercep;
#eosp1193#1;
;
#eosm1193#0,#eosm1193#1,"            "," ",0;
#eosm1193#0,#eosm1193#1,"zzzzzzzzzzzz","z",9999;
;
NULL,BajaPercep;
|FIN;

|PROCESO BajaLin; |TIPO 1;
   ModoEntrada = (FEntrada / 100) ! 0;

   |SI ModoEntrada = 3; |BUCLE BajaPercep; |BUCLE BajaGastos; |FINSI;
|FPRC;

|PROCESO MiraSiSust;
   |SI #eosm1193#2 ! " ";
      |PARA Cont = 10; |SI Cont [ 19; |HACIENDO Cont = Cont + 1;
         |C_M #eosm1193#Cont#,1,"S";
      |SIGUE;
      |SI #eosm1193#2 = "C";
         |C_M #eosm1193#20,1,"S";
         #eosm1193#20 = 01;
      |FINSI;
   |SINO;
      |PARA Cont = 10; |SI Cont [ 19; |HACIENDO Cont = Cont + 1;
         |C_M #eosm1193#Cont#,1,"N";
      |SIGUE;
      |C_M #eosm1193#20,1,"N";
      #eosm1193#20 = 00;
   |FINSI;
|FPRC;

|PROCESO SinBarra; |TIPO 5;
   FSalida = "SINBARRA";
|FPRC;

|PROCESO Calculo;
   #eosp1193#25 = #eosp1193#23 % #eosp1193#24; |PINTA #eosp1193#25;
|FPRC;

|PROCESO FiltraClave;
   |SI #eosp1193#9 = "C";
      |C_M #eosp1193#5,1,"N";  |C_M #eosp1193#7,1,"N";
      |C_M #eosp1193#8,1,"N";  |C_M #eosp1193#11,1,"N";
      |C_M #eosp1193#12,1,"N"; |C_M #eosp1193#13,1,"N";
      |C_M #eosp1193#14,1,"N"; |C_M #eosp1193#15,1,"N";
      |C_M #eosp1193#16,1,"N"; |C_M #eosp1193#17,1,"N";
      |C_M #eosp1193#18,1,"N"; |C_M #eosp1193#21,1,"N";
      |C_M #eosp1193#26,1,"N";
   |SINO;
      |C_M #eosp1193#5,1,"S";  |C_M #eosp1193#7,1,"S";
      |C_M #eosp1193#8,1,"S";  |C_M #eosp1193#11,1,"S";
      |C_M #eosp1193#12,1,"S"; |C_M #eosp1193#13,1,"S";
      |C_M #eosp1193#14,1,"S"; |C_M #eosp1193#15,1,"S";
      |C_M #eosp1193#16,1,"S"; |C_M #eosp1193#17,1,"S";
      |C_M #eosp1193#18,1,"S"; |C_M #eosp1193#21,1,"S";
      |C_M #eosp1193#26,1,"S";
   |FINSI;
|FPRC;

|PROCESO PonDatosNif;  |TIPO 7;
     |SI #eosp1193#2 ! "999999999999";
         |C_M #eosp1193#3, 1, "S";
         |C_M #eosp1193#4, 1, "S";
         |C_M #eosp1193#6, 1, "S";
     |SINO;
         |C_M #eosp1193#3, 1, "N";
         |C_M #eosp1193#4, 1, "N";
         |C_M #eosp1193#6, 1, "N";

         #eosp1193#3 = "VALORES PENDIENTES DE ABONO";   |PINTA #eosp1193#3;
         #eosp1193#4 = "999999999999";                  |PINTA #eosp1193#4;
         #eosp1193#6 = 0;                               |PINTA #eosp1193#6;
     |FINSI;

     |C_M #eosp1193#5,  1, "S";
     |C_M #eosp1193#7,  1, "S";
     |C_M #eosp1193#8,  1, "S";
     |C_M #eosp1193#11, 1, "S";
     |C_M #eosp1193#12, 1, "S";
     |C_M #eosp1193#13, 1, "S";
     |C_M #eosp1193#14, 1, "S";
     |C_M #eosp1193#15, 1, "S";
     |C_M #eosp1193#16, 1, "S";
     |SI #eosp1193#9 ! "A"; |Y #eosp1193#9 ! "B"; |Y #eosp1193#9 ! "D";
         |C_M #eosp1193#5,  1, "N";  #eosp1193#5  = "N";  |PINTA #eosp1193#5;
         |C_M #eosp1193#7,  1, "N";  #eosp1193#7  = 0;    |PINTA #eosp1193#7;
         |C_M #eosp1193#8,  1, "N";  #eosp1193#8  = "";   |PINTA #eosp1193#8;
         |C_M #eosp1193#11, 1, "N";  #eosp1193#11 = 0;    |PINTA #eosp1193#11;
         |C_M #eosp1193#12, 1, "N";  #eosp1193#12 = "";   |PINTA #eosp1193#12;
         |C_M #eosp1193#13, 1, "N";  #eosp1193#13 = "";   |PINTA #eosp1193#13;
         |C_M #eosp1193#14, 1, "N";  #eosp1193#14 = "";   |PINTA #eosp1193#14;
         |C_M #eosp1193#15, 1, "N";  #eosp1193#15 = "";   |PINTA #eosp1193#15;
         |C_M #eosp1193#16, 1, "N";  #eosp1193#16 = "";   |PINTA #eosp1193#16;
     |FINSI;

     |C_M #eosp1193#21, 1, "S";
     |SI #eosp1193#9 ! "A";
         |C_M #eosp1193#21, 1, "N";  #eosp1193#21 = 0;    |PINTA #eosp1193#21;
     |FINSI;

     |C_M #eosp1193#26, 1, "S";
     |SI #eosp1193#9 ! "B"; |Y #eosp1193#9 ! "D";
         |C_M #eosp1193#26, 1, "N";  #eosp1193#26 = 0;    |PINTA #eosp1193#26;
     |FINSI;
|FPRC;

|PROCESO TipoCod;  |TIPO 0;
     |C_M #eosp1193#27, 1, "S";
     |C_M #eosp1193#28, 1, "S";
     |C_M #eosp1193#29, 1, "S";
     |C_M #eosp1193#30, 1, "S";

     |SI #eosp1193#12 ! "P";
         |C_M #eosp1193#27, 1, "N";   #eosp1193#27 = "00.00.0000";  |PINTA #eosp1193#27;
         |C_M #eosp1193#28, 1, "N";   #eosp1193#28 = "00.00.0000";  |PINTA #eosp1193#28;
         |C_M #eosp1193#29, 1, "N";   #eosp1193#29 = 0;             |PINTA #eosp1193#29;
         |C_M #eosp1193#30, 1, "N";   #eosp1193#30 = 0;             |PINTA #eosp1193#30;

         |ACABA;
     |FINSI;

     |SI #eosp1193#11 ! 2;
         |MENAV "0000 El Tipo P no procede.";
         |ERROR;
         |ACABA;
     |FINSI;

     |SI #eosp1193#9 ! "A"; |Y #eosp1193#9 ! "B"; |Y #eosp1193#9 ! "D";
         |MENAV "0000 El Tipo P no procede.";
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;
