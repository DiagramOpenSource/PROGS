|FICHEROS;
     eosm0029,MANTE;
|FIN;

|VARIABLES;
      aAlfa     = "";
      nCampo1   = 0;
      nCampo2   = 0;
      nCampo3   = 0;

     &enMensaje = 0;
     &eaNif     = "";
     aNifQbf1   = "";
     aNifQbf2   = "";

     &eaVarDni  = "";
     &enCalcCif = 0;
|FIN;

|PROCESO LetraDnim29;  |TIPO 11;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     enCalcCif = 0;
     eaVarDni  = #eosm0029#Campo#;
     |HAZ CalculoDNI;
     #eosm0029#Campo# = eaVarDni;
     |PINTA #eosm0029#Campo#;
     |ERROR;
|FPRC;

|PROCESO LetraDnim29C;  |TIPO 6;
     eaVarDni = #eosm0029#Campo#;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     aNifQbf1 = #eosm0029#Campo#;   |QBF aNifQbf1;
     aNifQbf2 = eaVarDni;  |QBF aNifQbf2;

     |SI aNifQbf1 ! aNifQbf2; |Y aNifQbf1 ! "";
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #eosm0029#Campo# = eaVarDni; |PINTA #eosm0029#Campo#;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Mensaje;  |TIPO 7;
     |SI enMensaje = 0;
         |MENSA "      Pulse <F2> para Calcular el NIF";
     |SINO;
         |MENSA "      Pulse Intro para seleccionar";
     |FINSI;
|FPRC;

|PROCESO Intro;  |TIPO 0;
     |SI enMensaje = 0;  |ACABA;  |FINSI;

     |PTEC 807;
     eaNif = #eosm0029#1;
|FPRC;

|PROCESO SinAnyoD;  |TIPO 0;
     nCampo1 = Campo + 1;
     |SI Campo = 8;   nCampo2 = 31;  nCampo3 = 63;  |FINSI;
     |SI Campo = 10;  nCampo2 = 32;  nCampo3 = 64;  |FINSI;
     |SI Campo = 12;  nCampo2 = 33;  nCampo3 = 65;  |FINSI;
     |SI Campo = 14;  nCampo2 = 34;  nCampo3 = 66;  |FINSI;
     |SI Campo = 16;  nCampo2 = 35;  nCampo3 = 67;  |FINSI;
     |SI Campo = 18;  nCampo2 = 36;  nCampo3 = 68;  |FINSI;
     |SI Campo = 20;  nCampo2 = 37;  nCampo3 = 69;  |FINSI;
     |SI Campo = 22;  nCampo2 = 38;  nCampo3 = 70;  |FINSI;
     |SI Campo = 24;  nCampo2 = 39;  nCampo3 = 71;  |FINSI;
     |SI Campo = 26;  nCampo2 = 40;  nCampo3 = 72;  |FINSI;

     |C_M #eosm0029#nCampo1#, 1, "S";
     |C_M #eosm0029#nCampo2#, 1, "S";
     |C_M #eosm0029#nCampo3#, 1, "S";

     |SI #eosm0029#Campo# = 0;
         |C_M #eosm0029#nCampo1#, 1, "N";
         |C_M #eosm0029#nCampo2#, 1, "N";
         |C_M #eosm0029#nCampo3#, 1, "N";

         #eosm0029#nCampo1# = 0;      |PINTA #eosm0029#nCampo1#;
         #eosm0029#nCampo2# = "N";    |PINTA #eosm0029#nCampo2#;
         #eosm0029#nCampo3# = "N";    |PINTA #eosm0029#nCampo3#;
     |FINSI;
|FPRC;

|PROCESO SinAnyoA;  |TIPO 0;
     |SI Campo = 73;  nCampo1 = 51;  nCampo2 = 83;  nCampo3 = 41;  |FINSI;
     |SI Campo = 74;  nCampo1 = 52;  nCampo2 = 84;  nCampo3 = 42;  |FINSI;
     |SI Campo = 75;  nCampo1 = 53;  nCampo2 = 85;  nCampo3 = 43;  |FINSI;
     |SI Campo = 76;  nCampo1 = 54;  nCampo2 = 86;  nCampo3 = 44;  |FINSI;
     |SI Campo = 77;  nCampo1 = 55;  nCampo2 = 87;  nCampo3 = 45;  |FINSI;
     |SI Campo = 78;  nCampo1 = 56;  nCampo2 = 88;  nCampo3 = 46;  |FINSI;
     |SI Campo = 79;  nCampo1 = 57;  nCampo2 = 89;  nCampo3 = 47;  |FINSI;
     |SI Campo = 80;  nCampo1 = 58;  nCampo2 = 90;  nCampo3 = 48;  |FINSI;
     |SI Campo = 81;  nCampo1 = 59;  nCampo2 = 91;  nCampo3 = 49;  |FINSI;
     |SI Campo = 82;  nCampo1 = 60;  nCampo2 = 92;  nCampo3 = 50;  |FINSI;

     |C_M #eosm0029#nCampo1#, 1, "S";
     |C_M #eosm0029#nCampo2#, 1, "S";
     |C_M #eosm0029#nCampo3#, 1, "S";

     |SI #eosm0029#Campo# = 0;
         |C_M #eosm0029#nCampo1#, 1, "N";
         |C_M #eosm0029#nCampo2#, 1, "N";
         |C_M #eosm0029#nCampo3#, 1, "N";

         #eosm0029#nCampo1# = "";     |PINTA #eosm0029#nCampo1#;
         #eosm0029#nCampo2# = "N";    |PINTA #eosm0029#nCampo2#;
         #eosm0029#nCampo3# = "0";    |PINTA #eosm0029#nCampo3#;
     |FINSI;
|FPRC;

|PROCESO Movilidad;  |TIPO 7;
     |SI Campo = 63;  nCampo1 = 9;  |FINSI;
     |SI Campo = 64;  nCampo1 = 11; |FINSI;
     |SI Campo = 65;  nCampo1 = 13; |FINSI;
     |SI Campo = 66;  nCampo1 = 15; |FINSI;
     |SI Campo = 67;  nCampo1 = 17; |FINSI;
     |SI Campo = 68;  nCampo1 = 19; |FINSI;
     |SI Campo = 69;  nCampo1 = 21; |FINSI;
     |SI Campo = 70;  nCampo1 = 23; |FINSI;
     |SI Campo = 71;  nCampo1 = 25; |FINSI;
     |SI Campo = 72;  nCampo1 = 27; |FINSI;
     |SI Campo = 83;  nCampo1 = 51; |FINSI;
     |SI Campo = 84;  nCampo1 = 52; |FINSI;
     |SI Campo = 85;  nCampo1 = 53; |FINSI;
     |SI Campo = 86;  nCampo1 = 54; |FINSI;
     |SI Campo = 87;  nCampo1 = 55; |FINSI;
     |SI Campo = 88;  nCampo1 = 56; |FINSI;
     |SI Campo = 89;  nCampo1 = 57; |FINSI;
     |SI Campo = 90;  nCampo1 = 58; |FINSI;
     |SI Campo = 91;  nCampo1 = 59; |FINSI;
     |SI Campo = 92;  nCampo1 = 60; |FINSI;

    |C_M #eosm0029#Campo#, 1, "S";
     |SI Campo [ 72;
         |SI #eosm0029#nCampo1# < 33;  |O #eosm0029#nCampo1# > 64;
             |C_M #eosm0029#Campo#, 1, "N";  #eosm0029#Campo# = "N";  |PINTA #eosm0029#Campo#;
         |FINSI;
     |SINO;
         |SI #eosm0029#nCampo1# ! "1";
             |C_M #eosm0029#Campo#, 1, "N";  #eosm0029#Campo# = "N";  |PINTA #eosm0029#Campo#;
         |FINSI;
     |FINSI;
|FPRC;
