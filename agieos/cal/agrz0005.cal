|FICHEROS;
   agrz0004 #0;
|FIN;

|VARIABLES;
     Fichero  = "";
     Fichero1 = "";
     Fichero2 = "";
     Fich     = "";
     VAnyo    = "";
|FIN;

|PROGRAMA;
|CLS;
|CABEZA "Recuperar Lineas Compras-Ventas";
|PINPA #0#0;
|ABRE #0;
|DDEFECTO #0;
|LEE 101#0p;
|SI FSalida ! 0; |CIERRA #0; |ACABA; |FINSI;
|PINDA #0#0;
|ENDATOS #1#0;
|SI FSalida = 0;
    |GRABA 020#0a;
    |HAZ pasamelo;
|FINSI;
|LIBERA #0;
|CIERRA #0;
|FPRO;

|PROCESO pasamelo;
|SI #0#4 ! "<MYPASWD> ";
    |AVISO;  |AVISO;  |AVISO;

    |D_CUADRO 1926, 2357;
    |ATRI R;
    |PINTA 2027, "     CLAVE INCORRECTA         ";
    |PINTA 2127, "------------------------------";
    |PINTA 2227, "  EL FICHERO NO SE HA COPIADO ";
    |ATRI 0;
    |PAUSA;

    |ACABA;
|FINSI;

Fichero = #0#0;
Fichero = "00000" + Fichero;
Fichero = Fichero % -105;
VAnyo   = #0#1;
VAnyo   = "00" + VAnyo;
VAnyo   = VAnyo % -102;

|DFICE Fich;
|SI #0#2 = "C"; |HAZ CopiaCompra; |FINSI;
|SI #0#2 = "V"; |HAZ CopiaVenta;  |FINSI;
|FPRC;

|PROCESO CopiaCompra;
Fichero = "y" + Fichero + VAnyo;
Fichero1 = Fich + "agrm0014.ixx"
Fichero2 = Fich + Fichero + ".ixx";
|COPIA_FICHERO Fichero1, Fichero2;

Fichero1 = Fich + "agrm0014.dat"
Fichero2 = Fich + Fichero + ".dat";
|COPIA_FICHERO Fichero1, Fichero2;

Fichero1 = Fich + "agrm0014.ddx"
Fichero2 = Fich + Fichero + ".ddx";
|COPIA_FICHERO Fichero1, Fichero2;

|SI FSalida ! 0; |ACABA; |FINSI;

|AVISO;  |AVISO;  |AVISO;
|D_CUADRO 2026, 2257;
|ATRI R;
|PINTA 2127, "  EL FICHERO YA ESTA COPIADO  ";
|ATRI 0;
|PAUSA;
|FPRC;

|PROCESO CopiaVenta;
Fichero = "z" + Fichero + VAnyo;
Fichero1 = Fich + "agrm0013.ixx"
Fichero2 = Fich + Fichero + ".ixx";
|COPIA_FICHERO Fichero1, Fichero2;

Fichero1 = Fich + "agrm0013.dat"
Fichero2 = Fich + Fichero + ".dat";
|COPIA_FICHERO Fichero1, Fichero2;

Fichero1 = Fich + "agrm0013.ddx"
Fichero2 = Fich + Fichero + ".ddx";
|COPIA_FICHERO Fichero1, Fichero2;

|SI FSalida ! 0; |ACABA; |FINSI;

|AVISO;  |AVISO;  |AVISO;
|D_CUADRO 2026, 2257;
|ATRI R;
|PINTA 2127, "  EL FICHERO YA ESTA COPIADO  ";
|ATRI 0;
|PAUSA;
|FPRC;
