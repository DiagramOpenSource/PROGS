|FICHEROS;
    eosm1130 #0;
    eosclien #1;
    eosactiv #2;
    eos130co #3;
|FIN;

|VARIABLES;
 grafic    = "лллллллллллллллллллллллллллллллллллллллл";
 nombre    = "";
 cont      = 0;
 empre_ant = 0;
 perio_ant = 0;
 anyo_ant  = 0;
 activi    = 0;
 rendi1    = 0;
 rendi2    = 0;
 penult    = 0;
 camp      = 0;
 ventas    = 0;
 xxxxfiac  = "  ";
 xxaponer  = "  ";
 xrelleno  = "                              ";
|FIN;

|INCLUYE i_seguim;

|PROCESO i_archiv; |TIPO 7;
|SI #0#4 = "S";
    |MENAV "     Registro archivado, DESARCHIVELO";
    |PTEC 807;
|FINSI;
|FPRC;

|PROCESO pintanom; |TIPO 14;
|ABRE #1;
#1#0 = #0#0;
|LEE 040#1=;
|SI FSalida ! 0; |DDEFECTO #1; |FINSI;
nombre = #1#2; |QBF nombre;
nombre = nombre + grafic;
nombre = nombre % 140;
|PINTA 535, nombre;
|CIERRA #1;
|FPRC;

|PROCESO rendi;
cont = (FEntrada / 100) ! 0;
|SI cont = 1;
   |SI #0#1 > 1;
       empre_ant = #0#0;
       perio_ant = #0#1;
       anyo_ant  = #0#2;
       activi    = #0#19;
       #0#1 = #0#1 - 1;
       |LEE 040#0=;
       |SI FSalida = 0;
          rendi1 = #0#5;
          rendi2 = #0#12;
       |FINSI;
       |DDEFECTO #0;
       #0#0  = empre_ant;
       #0#1  = perio_ant;
       #0#2  = anyo_ant;
       #0#19 = activi;
       |LEE 040#0=;
       |SI FSalida ! 0;
           |DDEFECTO #0;
           #0#0 = empre_ant;
           #0#1 = perio_ant;
           #0#2 = anyo_ant;
           #0#19 = activi;
       |FINSI;
       #0#5 = rendi1;
       #0#12 = rendi2;
       |PINTA #0#0;
       |PINTA #0#1;
       |PINTA #0#2;
       |PINTA #0#5;
       |PINTA #0#12;
       |PINTA #0#19;
   |SINO;
       #0#5 = 0;  |PINTA #0#5;
       #0#12 = 0; |PINTA #0#12;
       |SI #2#41 = "N";
           |HAZ penultimo;
       |SINO;
           penult = 0;
       |FINSI;
       |SI #2#23 = "E"; #0#5 = penult;  |PINTA #0#5;  |FINSI;
       |SI #2#23 = "P"; #0#12 = penult; |PINTA #0#12; |FINSI;
   |FINSI;
|FINSI;
|FPRC;

|PROCESO empresa; |TIPO 0;
|ABRE #1;
#1#0 = #0#0;
|LEE 040#1=;
|SI FSalida ! 0;
  |MENAV "     No existe Empresa.";
  |ERROR;
|FINSI;
|CIERRA #1;
|FPRC;

|PROCESO activida; |TIPO 0;
|ABRE #2;
#2#0 = #0#0;
#2#1 = #0#19;
#2#2 = #0#2;
|LEE 040#2=;
|SI FSalida = 0;
  |SI #2#23 ! "P";|Y #2#23 ! "E"; |Y #2#23 ! "V";
     |MENAV "     La Actividad NO esta marcada como empresarios o profesionales";
     |ERROR;
  |FINSI;
  |SI #2#14 = "S";
     |MENAV "     La Actividad es un Comunero";
     |ERROR;
  |FINSI;

|SINO;
  |MENAV "     No existe Actividad";
  |ERROR;
|FINSI;
|CIERRA #2;
|FPRC;

|PROCESO activid1; |TIPO 7;
|ABRE #2;
#2#0 = #0#0;
#2#1 = #0#19;
#2#2 = #0#2;
|LEE 040#2=;
|SI FSalida = 0;
  |SI #2#23 ! "P";|Y #2#23 ! "E"; |Y #2#23 ! "V";
     |MENAV "     La empresa NO esta marcada como empresarios o profesionales";
     |ERROR;
  |FINSI;
|SINO;
  |MENAV "     No existe Actividad";
  |ERROR;
|FINSI;
|CIERRA #2;
|FPRC;

|PROCESO rend1; |TIPO 0;
     camp   = Campo + 1;
     #0camp = #0Campo % 1;
     |PINTA #0camp;
|FPRC;

|PROCESO rend2; |TIPO 0;
     camp   = Campo + 1;
     #0camp = #0Campo % 2;
     |PINTA #0camp;
|FPRC;

|PROCESO rend6;|TIPO 0;
     |ABRE #3;
     |LIBERA #3;
     |LEE 140#3p;
     |SI FSalida ! 0;
         #3#0 = 1;
         #3#1 = "S";
         |GRABA 140#3n;
     |FINSI;
     |CIERRA #3;

     camp   = Campo + 1;
     |SI #3#1 = "S"; #0camp = #0Campo % 6; |SINO; #0camp = 0; |FINSI;
     |PINTA #0camp;
|FPRC;

|PROCESO cuota;|TIPO 0;
     |SI #0#6 ] #0#8;|Y #0#6 ] #0#10;
           #0#11 = #0#6;
           |PINTA #0#11;
     |FINSI;
     |SI #0#8 ] #0#6;|Y #0#8 ] #0#10;
           #0#11 = #0#8;
           |PINTA #0#11;
     |FINSI;
     |SI #0#10 ] #0#6;|Y #0#10 ] #0#8;
           #0#11 = #0#10;
           |PINTA #0#11;
     |FINSI;
     |SI #0#13 ] #0#15;
           #0#17 = #0#13 - #0#16;
           |PINTA #0#17;
     |FINSI;
     |SI #0#15 ] #0#13;
           #0#17 = #0#15 - #0#16;
           |PINTA #0#17;
     |FINSI;
     #0#18 = #0#11 + #0#17;
     |PINTA #0#18;
|FPRC;

|PROCESO grabaact;|TIPO 30;
|ABRE #2;
#2#0 = #0#0;
#2#1 = #0#19;
#2#2 = #0#2;
|LIBERA #2;
|LEE 140#2=;
|SI FSalida ! 0; |CIERRA #2; |ACABA; |FINSI;

ventas = #0#7 + #0#9 + #0#14;
|SI #0#1 = 1; #2#30 = ventas; |FINSI;
|SI #0#1 = 2; #2#31 = ventas; |FINSI;
|SI #0#1 = 3; #2#32 = ventas; |FINSI;
|SI #0#1 = 4; #2#33 = ventas; |FINSI;
|GRABA 140#2a;
|LIBERA #2;
|CIERRA #2;

se_empre = #0#0;
se_ejerc = #0#2;
se_perio = #0#1;
se_tipos = 130;
se_activ = #0#19;
se_impor = #0#18;
se_fecha = #0#3;
se_factu = "";
|HAZ seguimie;
|FPRC;

|PROCESO penultimo;
|ABRE #2;
#2#0 = #0#0;
#2#1 = #0#19;
#2#2 = #0#2 - 2;
|SI #2#2 = -2;  #2#2 = 98;  |FINSI;
|SI #2#2 = -1;  #2#2 = 99;  |FINSI;
|LEE 040#2=;
|SI FSalida ! 0; |DDEFECTO #2; |FINSI;
penult = #2#39;

#2#0 = #0#0;
#2#1 = #0#19;
#2#2 = #0#2;
|LEE 040#2=;
|SI FSalida ! 0; |DDEFECTO #2; |FINSI;
|CIERRA #2;
|FPRC;

|PROCESO punto1;|TIPO 7;
|SI #2#23 = "E"; |HAZ nomodifi; |FINSI;
|FPRC;

|PROCESO punto2;|TIPO 7;
|SI #2#23 = "P"; |HAZ nomodifi; |FINSI;
|SI Campo = 7; |Y #2#24 = 1; |HAZ nomodifi; |FINSI;
|SI Campo = 9; |Y #2#24 = 2; |HAZ nomodifi; |FINSI;
|FPRC;

|PROCESO nomodifi;             || RUTINA DE CONVERSION A NO MODIFICABLES
                               || VARIABLES: A_
    xxaponer = Anono;
    xxxxfiac = Control % A1001;
    Control = Control + xxxxfiac;
    Control = Control + xrelleno;
    Control = Control % A120;
    Control = Control + xxaponer;
|FPRC;
