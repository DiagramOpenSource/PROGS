|FICHEROS;
    eosemcab #0;
    eosclien #1;
    eoshacie #2;
    eosdaban #3;
    eoscomul #5;
    eosactiv #6;
    eosm3390 #7;
|FIN;

|INCLUYE i_anyode;
|INCLUYE i_consul;

|VARIABLES;
    &dia       = "";
    &mes       = "";
    &anyo      = "";

    &nif       = "";
    &nombre    = "";
    &sg        = "";
    &calle     = "";
    &numero    = "";
    &escalera  = "";
    &piso      = "";
    &puerta    = "";
    &telefono  = "";
    &municipio = "";
    &provincia = "";
    &postal1   = "";
    &nombr_a1  = "";
    &clave_a1  = "";
    &epigr_a1  = "";
    &nombr_a2  = "";
    &clave_a2  = "";
    &epigr_a2  = "";
    &d_empre   = 0;
    &h_empre   = 0;

    &nifp      = "";
    &sgp       = "";
    &nombrep   = "";
    &callep    = "";
    &nump      = "";
    &escp      = "";
    &pisop     = "";
    &puep      = "";
    &poblap    = "";
    &provip    = "";
    &codp      = "";
    &tlfnop    = "";
    &el_anyo   = 0;
    &sw_sit    = 0;

    xxx        = 0;
    empresa    = 0;
    vacio_20   = "                    ";
    vacio_16   = "                ";
    vacio_12   = "            ";
    vacio_10   = "          ";
    pasada     = 0;
    sw_fisica  = 0;
    iva_si     = 0;
    fra_si     = 0;
    sw_borr    = 0;
    sw_paso    = 0;
|FIN;

|PROCESO seleccion; |TIPO 0;
|SI #0#7 = "S";
    |C_M #0#0, 1, "S";
    |C_M #0#1, 1, "S";

    |PARA xxx = 8; |SI xxx [ 31; |HACIENDO xxx = xxx + 1;
          |C_M #0xxx, 1, "N";
          #0xxx = 0;
          |PINTA #0xxx;
    |SIGUE;
|SINO;
    |C_M #0#0, 1, "N";   #0#0 = 1;      |PINTA #0#0;
    |C_M #0#1, 1, "N";   #0#1 = 99999;  |PINTA #0#1;

    |PARA xxx = 8; |SI xxx [ 31; |HACIENDO xxx = xxx + 1;
          |C_M #0xxx, 1, "S";
    |SIGUE;
|FINSI;
|FPRC;

|PROCESO pinta_anyo; |TIPO 7;
|HAZ i_anyodef;
#0#2 = i_anyodef;
|PINTA #0#2;
|FPRC;

|PROCESO modelo_110;
|INFOR "eosyc110";
|SI FSalida ! 0; |ACABA; |FINSI;

|PRINT;  |PIEINF;  |FININF;
|FPRC;

|PROCESO modelo_130;
|HAZ Acti_Sino; |SI fra_si = 0; |ACABA; |FINSI;

|INFOR "eosyc130";
|SI FSalida ! 0; |ACABA; |FINSI;

|PRINT;  |PIEINF;  |FININF;
|FPRC;

|PROCESO modelo_190;
|INFOR "eosyc190";
|SI FSalida ! 0; |ACABA; |FINSI;

|PRINT;  |PIEINF;  |FININF;
|FPRC;

|PROCESO modelo_300;
|HAZ Acti_Sino; |SI iva_si = 0; |ACABA; |FINSI;

|INFOR "eosyc300";
|SI FSalida ! 0; |ACABA; |FINSI;

|PRINT;  |PIEINF;  |FININF;
|FPRC;

|PROCESO modelo_330;
|HAZ Acti_Sino; |SI iva_si = 0; |ACABA; |FINSI;

|INFOR "eosyc330";
|SI FSalida ! 0; |ACABA; |FINSI;

|PRINT;  |PIEINF;  |FININF;
|FPRC;

|PROCESO modelo_309;
|HAZ Acti_Sino; |SI iva_si = 0; |ACABA; |FINSI;

|INFOR "eosyc309";
|SI FSalida ! 0; |ACABA; |FINSI;

|PRINT;  |PIEINF;  |FININF;
|FPRC;

|PROCESO modelo_370;
|SI #1#60 ! "S"; |ACABA; |FINSI;

|HAZ Acti_Sino; |SI iva_si = 0; |ACABA; |FINSI;

|INFOR "eosyc370";
|SI FSalida ! 0; |ACABA; |FINSI;

|PRINT;  |PIEINF;  |FININF;
|FPRC;

|PROCESO modelo_349;
|HAZ Acti_Sino; |SI iva_si = 0; |ACABA; |FINSI;

|INFOR "eosyc349";
|SI FSalida ! 0; |ACABA; |FINSI;

|PRINT;  |PIEINF;  |FININF;
|FPRC;

|PROCESO impre_390;
  |SI sw_paso = 0; sw_paso = 1; |ERROR10;  |ACABA;  |FINSI;

  nifp = "";  nombrep = "";  callep = "";
  nump = "";  escp    = "";  pisop  = "";
  puep = "";  poblap  = "";  provip = "";
  codp = "";
  sw_fisica = 0;

  #5#0 = #1#0;
  #5#1 = 1;
  #5#2 = 1;
  #5#7 = #0#2;
  |LEE 040#5];
  |SI FSalida = 0; |Y #5#0 = #1#0; |Y #5#7 = #0#2;
      #1#0 = #5#3;
      |LEE 040#1=;
      |SI FSalida = 0;
          sw_fisica = 1;
          nifp = #1#1;  nombrep = #1#2;  callep = #1#5;
          nump = #1#6;  escp    = #1#7;  pisop  = #1#8;
          puep = #1#9;  poblap  = #1#13; provip = #1#12;
          codp = #1#21;
      |FINSI;
  |FINSI;

  #1#0 = #7#0;
  |LEE 040#1=;
  |SI FSalida ! 0; |DDEFECTO #1; |FINSI;

  |SI sw_fisica = 0;
      nifp = #1#1;  nombrep = #1#2;  callep = #1#5;
      nump = #1#6;  escp    = #1#7;  pisop  = #1#8;
      puep = #1#9;  poblap  = #1#13; provip = #1#12;
      codp = #1#21; sgp     = #1#4;  tlfnop = #1#14;

      |SI #1#24 ! vacio_20; |O #1#25 ! vacio_20;
          |O #1#26 ! vacio_12; |O #1#27 ! vacio_10; |O #1#28 ! vacio_16;
             nifp = "";  nombrep = "";  callep = "";
             nump = "";  escp    = "";  pisop  = "";
             puep = "";  poblap  = "";  provip = "";
             codp = "";  sgp     = "";  tlfnop = "";
      |FINSI;

      |SI #1#29 ! vacio_20; |O #1#30 ! vacio_20;
          |O #1#31 ! vacio_12; |O #1#32 ! vacio_10; |O #1#33 ! vacio_16;
             nifp = "";  nombrep = "";  callep = "";
             nump = "";  escp    = "";  pisop  = "";
             puep = "";  poblap  = "";  provip = "";
             codp = "";  sgp     = "";  tlfnop = "";
      |FINSI;

      |SI #1#34 ! vacio_20; |O #1#35 ! vacio_20;
          |O #1#36 ! vacio_12; |O #1#37 ! vacio_10; |O #1#38 ! vacio_16;
             nifp = "";  nombrep = "";  callep = "";
             nump = "";  escp    = "";  pisop  = "";
             puep = "";  poblap  = "";  provip = "";
             codp = "";  sgp     = "";  tlfnop = "";
      |FINSI;
  |FINSI;

  |INFOR "eos11390";
  |SI FSalida ! 0; |ACABA; |FINSI;
  |PRINT;  |PIEINF;  |FININF;

  |INFOR "eos17390";
  |SI FSalida ! 0; |ACABA; |FINSI;
  |PRINT;  |PIEINF;  |FININF;

  |INFOR "eos18390";
  |SI FSalida ! 0; |ACABA; |FINSI;
  |PRINT;  |PIEINF;  |FININF;

  |INFOR "eos18390";
  |SI FSalida ! 0; |ACABA; |FINSI;
  |PRINT;  |PIEINF;  |FININF;

  |INFOR "eos18390";
  |SI FSalida ! 0; |ACABA; |FINSI;
  |PRINT;  |PIEINF;  |FININF;
|FPRC;

|DEFBUCLE eosm3390;
#7#1;
;
#1#0, #0#2;
#1#0, #0#2;
;
NULL, impre_390;
|FIN;

|PROCESO modelo_390;
|HAZ Acti_Sino; |SI iva_si = 0; |ACABA; |FINSI;

sw_paso = 0;
sw_borr = 0;
|BUCLE eosm3390;
|SI sw_paso = 0;
    el_anyo = #0#2;
    sw_sit  = 1;
    sw_borr = 1;
    |SUB_EJECUTA "eosp2390";
|FINSI;

sw_paso = 1;
|BUCLE eosm3390;

|SI sw_borr = 1;
    |ABRE #7; #7#0 = #1#0; #7#1 = #0#2; |BORRA 140#7c; |LIBERA #7; |CIERRA #7;
|FINSI;
|FPRC;

|PROCESO modelo_347;
|INFOR "eosyc347";
|SI FSalida ! 0; |ACABA; |FINSI;

nombr_a1 = "";
clave_a1 = "";
epigr_a1 = "";
nombr_a2 = "";
clave_a2 = "";
epigr_a2 = "";

#6#0 = #1#0;
#6#2 = #0#2;
|PARA pasada = 1; |SI pasada [ 2; |HACIENDO pasada = pasada + 1;
    #6#1 = pasada;
    |LEE 040#6];

    |SI #6#0 ! #3#0;  pasada = 3; |SAL; |FINSI;
    |SI #6#2 ! #0#28; pasada = 3; |SAL; |FINSI;
    |SI FSalida ! 0;  pasada = 3; |SAL; |FINSI;

    |SI pasada = 1;
        nombr_a1 = #6#6;
        clave_a1 = #6#43;
        epigr_a1 = #6#4 + " " + #6#5;
    |FINSI;

    |SI pasada = 2;
        nombr_a2 = #6#6;
        clave_a2 = #6#43;
        epigr_a2 = #6#4 + " " + #6#5;
    |FINSI;
|SIGUE;

|SI #1#51 = "S"; |HAZ comunero; |FINSI;

|SI sw_fisica = 0;
    sg        = #1#4;
    nif       = #1#1;  nombre   = #1#2;  calle     = #1#5;
    numero    = #1#6;  escalera = #1#7;  piso      = #1#8;
    puerta    = #1#9;  telefono = #1#14; municipio = #1#13;
    provincia = #1#12; postal1  = #1#21;

    |SI #1#24 ! vacio_20; |O #1#25 ! vacio_20;
        |O #1#26 ! vacio_12; |O #1#27 ! vacio_10; |O #1#28 ! vacio_16;
        sg        = "";
        nif       = "";  nombre   = "";  calle     = "";
        numero    = "";  escalera = "";  piso      = "";
        puerta    = "";  telefono = "";  municipio = "";
        provincia = "";  postal1  = "";
    |FINSI;

    |SI #1#29 ! vacio_20; |O #1#30 ! vacio_20;
        |O #1#31 ! vacio_12; |O #1#32 ! vacio_10; |O #1#33 ! vacio_16;
        sg        = "";
        nif       = "";  nombre   = "";  calle     = "";
        numero    = "";  escalera = "";  piso      = "";
        puerta    = "";  telefono = "";  municipio = "";
        provincia = "";  postal1  = "";
    |FINSI;

    |SI #1#34 ! vacio_20; |O #1#35 ! vacio_20;
        |O #1#36 ! vacio_12; |O #1#37 ! vacio_10; |O #1#38 ! vacio_16;
        sg        = "";
        nif       = "";  nombre   = "";  calle     = "";
        numero    = "";  escalera = "";  piso      = "";
        puerta    = "";  telefono = "";  municipio = "";
        provincia = "";  postal1  = "";
    |FINSI;
|FINSI;

|PRINT; |PIEINF; |FININF;
|FPRC;

|PROCESO comunero;
|ABRE #5;
empresa = #1#0;
#5#0    = #1#0;
#5#1    = 1;
#5#7    = #0#2;
|LEE 040#5];
|SI FSalida = 0; |Y #5#0 = empresa; |Y #5#7 = #0#2;
    #1#0 = #5#3;
    |LEE 040#1=;
    |SI FSalida ! 0; |DDEFECTO #1; |FINSI;

    sw_fisica = 1;
    sg        = #1#4;
    nif       = #1#1;  nombre   = #1#2;  calle     = #1#5;
    numero    = #1#6;  escalera = #1#7;  piso      = #1#8;
    puerta    = #1#9;  telefono = #1#14; municipio = #1#13;
    provincia = #1#12; postal1  = #1#21;

    #1#0 = empresa;
    |LEE 040#1=;
    |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
|FINSI;
|FPRC;

|PROCESO limpia;
      nif       = "";  nombre   = ""; calle     = ""; sg = "";
      numero    = "";  escalera = ""; piso      = "";
      puerta    = "";  telefono = ""; municipio = "";
      provincia = "";  postal1  = ""; sw_fisica = 0;
|FPRC;

|PROCESO imprime;
#2#0 = #1#18;
#2#1 = #1#19;
|LEE 040#2=;
|SI FSalida ! 0; |DDEFECTO #2; |FINSI;

#3#0 = #1#0;
|LEE 040#3=;
|SI FSalida ! 0; |DDEFECTO #3; |FINSI;

|SI #0#3 = 01; |HAZ modelo_110; |FINSI;   || Modelo eosyc110
|SI #0#3 = 02; |HAZ modelo_130; |FINSI;   || Modelo eosyc130
|SI #0#3 = 03; |HAZ modelo_130; |FINSI;   || Modelo eosyc130
|SI #0#3 = 04; |HAZ modelo_190; |FINSI;   || Modelo eosyc190
|SI #0#3 = 05; |HAZ modelo_300; |FINSI;   || Modelo eosyc300
|SI #0#3 = 06; |HAZ modelo_300; |FINSI;   || Modelo eosyc300
|SI #0#3 = 07; |HAZ modelo_300; |FINSI;   || Modelo eosyc300
|SI #0#3 = 08; |HAZ modelo_330; |FINSI;   || Modelo eosyc330
|SI #0#3 = 09; |HAZ modelo_309; |FINSI;   || Modelo eosyc309
|SI #0#3 = 10; |HAZ modelo_370; |FINSI;   || Modelo eosyc370
|SI #0#3 = 11; |HAZ modelo_349; |FINSI;
|SI #0#3 = 12; |HAZ modelo_390; |FINSI;
|SI #0#3 = 13; |HAZ modelo_347; |FINSI;
|FPRC;

|DEFBUCLE eosclien;
#1#1;
;
d_empre;
h_empre;
;
NULL, imprime;
|FIN;

|PROCESO tipo_3; |TIPO 3;
|HAZ Fecha_Separada;
|IMPRE 0;
|SI FSalida ! 0; |ACABA; |FINSI;

|ABRE #2;
|ABRE #3;
|ABRET #6;
|SI #0#7 = "S";
    d_empre = #0#0;
    h_empre = #0#1;
    |BUCLE eosclien;
|SINO;
    |PARA xxx = 8; |SI xxx [ 31; |HACIENDO xxx = xxx + 1;
          |SI #0xxx ! 0;
              d_empre = #0xxx;
              h_empre = #0xxx;
              |BUCLE eosclien;
          |FINSI;
    |SIGUE;
|FINSI;
|CIERRA #2;
|CIERRA #3;
|CIERRAT #6;

|FINIMP;
|FPRC;

|PROCESO Fecha_Separada;
dia  = #0#6 % 102;
mes  = #0#6 % 402;
anyo = #0#6 % 704;

|SI mes = "01"; mes = "Enero     "; |FINSI;
|SI mes = "02"; mes = "Febrero   "; |FINSI;
|SI mes = "03"; mes = "Marzo     "; |FINSI;
|SI mes = "04"; mes = "Abril     "; |FINSI;
|SI mes = "05"; mes = "Mayo      "; |FINSI;
|SI mes = "06"; mes = "Junio     "; |FINSI;
|SI mes = "07"; mes = "Julio     "; |FINSI;
|SI mes = "08"; mes = "Agosto    "; |FINSI;
|SI mes = "09"; mes = "Septiembre"; |FINSI;
|SI mes = "10"; mes = "Octubre   "; |FINSI;
|SI mes = "11"; mes = "Noviembre "; |FINSI;
|SI mes = "12"; mes = "Diciembre "; |FINSI;
|FPRC;

|PROCESO Mira_Acti;
|SI #6#26 ! "N"; iva_si = 1; |FINSI;
|SI #6#22 ! "N"; fra_si = 1; |FINSI;
|FPRC;

|DEFBUCLE eosactiv_1;
#6#1;
;
#1#0, 1, #0#2;
#1#0, 9, #0#2;
;
NULL, Mira_Acti;
|FIN;

|PROCESO Acti_Sino;
iva_si = 0;
|CIERRAT #6;  |BUCLE eosactiv_1;  |ABRET #6;
|FPRC;
