|FICHEROS;
     dsm39001;
     dsmow169,MANTE;
     eosactiv;
|FIN;

|VARIABLES;
     nCampo1 = 0;
     nCampo2 = 0;
     nCampo3 = 0;

     aAlfa   = "";
|FIN;

|INCLUYE i_variar;

|PROCESO Tipo0C28Fw169;  |TIPO 0;
     |C_M #dsmow169#30, 1, "S";
     |C_M #dsmow169#31, 1, "S";
     |C_M #dsmow169#32, 1, "S";

     |C_M #dsmow169#42, 1, "S";

     |SI #dsmow169#28 = "N";
         #dsmow169#42 = "";  |C_M #dsmow169#42, 1, "N";  |PINTA #dsmow169#42;

         #dsmow169#30 = "N";   |C_M #dsmow169#30, 1, "N";  |PINTA #dsmow169#30;
         #dsmow169#31 = "N";   |C_M #dsmow169#31, 1, "N";  |PINTA #dsmow169#31;
         #dsmow169#32 = "N";   |C_M #dsmow169#32, 1, "N";  |PINTA #dsmow169#32;
     |FINSI;
|FPRC;

|PROCESO Tipo0C31Fw169;  |TIPO 0;
     |C_M #dsmow169#32, 1, "S";
     |C_M #dsmow169#33, 1, "S";

     |SI #dsmow169#31 = "N";
         #dsmow169#32 = "N";   |C_M #dsmow169#32, 1, "N";  |PINTA #dsmow169#32;
         #dsmow169#33 = "";    |C_M #dsmow169#33, 1, "N";  |PINTA #dsmow169#33;
     |FINSI;
|FPRC;

|PROCESO Actividadw169;
     nCampo1 = Campo + 1;
     nCampo2 = Campo + 2;
     nCampo3 = Campo + 3;

     |C_M #dsmow169#nCampo3#, 1, "S";
     |SI #dsmow169#Campo# = 0;
         #dsmow169#nCampo1# = "";  |PINTA #dsmow169#nCampo1#;
         #dsmow169#nCampo2# = "";  |PINTA #dsmow169#nCampo2#;
         #dsmow169#nCampo3# = 0;   |PINTA #dsmow169#nCampo3#;
         |C_M #dsmow169#nCampo3#, 1, "N";

         |ACABA;
     |FINSI;

     |ABRE #eosactiv;
     #eosactiv#0 = #dsm39001#0;
     #eosactiv#1 = #dsmow169#Campo#;
     #eosactiv#2 = #dsm39001#1 - 2000;
     |LEE 000#eosactiv.=;
     |SI FSalida ! 0;
         |MENAV "     No existe Actividad";
         |ERROR;
     |FINSI;
     |CIERRA #eosactiv;

     #dsmow169#nCampo1# = #eosactiv#5;
     #dsmow169#nCampo2# = #eosactiv#6;
     #dsmow169#nCampo3# = #eosactiv#43;

     |SI #dsmow169#nCampo3# = 0;  |O #dsmow169#nCampo3# = 4;
      |O #dsmow169#nCampo3# = 5;  |O #dsmow169#nCampo3# = 6;
         #dsmow169#nCampo1# = "";
     |FINSI;

     |SI #dsmow169#nCampo1# = "9999";
         #dsmow169#nCampo1# = "";
     |FINSI;

     |PINTA #dsmow169#nCampo1#;
     |PINTA #dsmow169#nCampo2#;
     |PINTA #dsmow169#nCampo3#;

|FPRC;

|PROCESO LetraNifw169;  |TIPO 6;
     |SI FSalida = 10;
         eaVarDni  = #dsmow169#Campo#;
         enCalcCif = 1;
         |HAZ CalculoDNI;
         #dsmow169#Campo# = eaVarDni;
         |PINTA #dsmow169#Campo#;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #dsmow169#Campo#;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "             ") % 112;
     |SI #dsmow169#Campo# ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #dsmow169#Campo# = eaVarDni;  |PINTA #dsmow169#Campo#;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo12w169;  |TIPO 12;
|FPRC;
