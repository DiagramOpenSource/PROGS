|FICHEROS;
     eosyycer;

     eosaplic;
     eosclipr;
     eosclien;

     eosm0029;
     eosm0034;
     eosm0036;

     :/agicli/def/agicontr;

     eosw0090;

     espejo1@;
|FIN;

|VARIABLES;
     aPathFich    = "";
     aPathPan     = "";
     mensaje = "Imprimiendo ...";
     campo1 = 0;
     campo2 = 0;
     campo3 = 0;
     campo4 = 0;
     fecsys = @;
     nContador = 0;
     &domemp = "";
     &domtra = "";
     &fletra = "";
     &fprese = "";
     &tbases1 = 0;
     &tbases2 = 0;
     &tbases3 = 0;
     &tbases4 = 0;
     &treten1 = 0;
     &treten2 = 0;
     &treten3 = 0;
     &treten4 = 0;
     &tdescue = 0;
     &texenta = 0;
     &letrai = 0;
     &clave1  = "";
     &clave2  = "";
     &clave3  = "";
     &clave4  = "";
     &nomrep  = "";
     &dnirep  = "";
     &observa = "";
     informe = "";
     &dia = 0;
     &mes = "";
     &anyo = 0;
     &ejerc = 0;
     sw_acumula = 0;
     nume1 = 0;
     nume2 = 0;
     nume3 = 0;
     nume4 = 0;
     alfa1 = "";
     alfa2 = "";
     alfa3 = "";
     alfa4 = "";
     para1 = 0;
     para2 = 0;
     para3 = 0;
     para4 = 0;
     FEstado = 0;
     &periodo = 0;
     &justi1 = 0;
     &justi2 = 0;
     justi1_ant = 0;
     justi2_ant = 0;
     ant_emp = -1;
     gexenta = 0;
     sw_valido = 0;
     nSwAlgo = 0;
     nBase   = 0;
     nCuot   = 0;

     &enEmpresa   = 0;
     &enAnyo      = 0;
     aClave       = "";
     aClave1      = "";
     aClave2      = "";
     aClave3      = "";
     &especie1    = "";
     &especie2    = "";
     &especie3    = "";

     &eaMoneda    = "";
     nSSocial     = 0;
     aPathNomina  = "";
     aDef         = "";

     nBasDin      = 0;
     nRetDin      = 0;
     nBasEsp      = 0;
     nRetEsp      = 0;
|FIN;
____________________________________/ CALCULOS DE PANTALLA

|PROCESO defecto; |TIPO 7;   || calcula el a¤o por defecto segun fecha sistema
     fecsys = ~;
     alfa1 = fecsys;
     alfa1 = alfa1 % -104;
     #eosyycer#Campo# = alfa1;
     #eosyycer#Campo# = #eosyycer#Campo# - 1;
     |SI #eosyycer#Campo# < 0;  #eosyycer#Campo# = 99;  |FINSI;
     |PINTA #eosyycer#Campo#;
|FPRC;

|PROCESO fecha; |TIPO 7;
     nume1 = #eosyycer#5 + 1;
     alfa1 = nume1;
     alfa1 = "20.01." + alfa1;
     #eosyycer#Campo# = alfa1;
     |PINTA #eosyycer#Campo#;
|FPRC;

|PROCESO ayuda1; |TIPO 7;
     |PUSHV 08472279;
     |CUADRO 08 47 22 79;
     |ATRI R;
     ||            12345678901234567890123456789
     |PINTA 0948, "  [POSIBLES MODELOS A EMITIR]  ";
     |PINTA 1048, " ----------------------------- ";
     |PINTA 1148, "  (1) 66 lineas (blanco)       ";
     |PINTA 1248, "  (2) 48 lineas (preimpreso)   ";
     |PINTA 1348, "                               ";
     |PINTA 1448, "  (4) 72 lineas (blanco)       ";
     |PINTA 1548, "  (5) Oficial Rendimientos     ";
     |PINTA 1648, "  (6) Oficial Actividades      ";
     |PINTA 1748, "                               ";
     |PINTA 1848, "                               ";
     |PINTA 1948, "                               ";
     |PINTA 2048, "                               ";
     |PINTA 2148, "           ---------           ";
     |ATRI 0;
|FPRC;

|PROCESO ayuda2; |TIPO 0;
     |POPV;
|FPRC;

|PROCESO noentres; |TIPO 0;
     |SI #eosyycer#6 = 3;|O #eosyycer#6 = 7;|O #eosyycer#6 = 8;
          |AVISO;
          |ERROR;
     |FINSI;

     |SI #eosyycer#6 = 4;
          |CAMPO_MODIFICA #eosyycer#8, 1, "S";
          |CAMPO_MODIFICA #eosyycer#9, 1, "S";
     |SINO;
          |CAMPO_MODIFICA #eosyycer#8, 1, "N";
          |CAMPO_MODIFICA #eosyycer#9, 1, "N";
     |FINSI;
|FPRC;

|PROCESO mayus; |TIPO 0;
     #eosyycer#Campo# = #eosyycer#Campo# > #eosyycer#Campo#;
     |PINTA #eosyycer#Campo#;
|FPRC;

|PROCESO MiraVarMoneda;  |TIPO 7;
     |HAZ PintaMoneda;
     #eosyycer#19 = eaMoneda;

     |PINTA #eosyycer#19;
|FPRC;

____________________________________/ CALCULOS DE LECTURA E IMPRESION
|PROCESO Imprime;
     |SI #eosyycer#6 = 4;
          |SI letrai = 0;
               justi1_ant = justi1;
               justi2_ant = justi2;
               |SI ant_emp = -1;  ant_emp = #eosm0029#0;  |FINSI;
               |SI ant_emp ! #eosm0029#0;
                    justi1 = justi1 + 1;
                    justi2 = justi2 - 1;
                    |SI justi2 = -1;  justi2 = 6;  |FINSI;
                    ant_emp = #eosm0029#0;
               |FINSI;
          |FINSI;
     |FINSI;

     sw_valido = 1;
     |SI texenta = 0;|Y #eosyycer#16 = "S"; sw_valido = 0; |FINSI; || exentas S/N

     |SI sw_valido = 1;
              observa = "";
          |INFOR informe;
          |PRINT;
          |PIEINF;
          |FININF;
     |SINO;
          |SI #eosyycer#6 = 4;
               |SI letrai = 0;
                    justi1 = justi1_ant;
                    justi2 = justi2_ant;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Normal4;
     |SI tbases1!0;|O treten1!0;
          tbases4=tbases1;   treten4=treten1;
          clave4 = clave1;
          |HAZ Imprime;
     |FINSI;
     |SI tbases2!0;|O treten2!0;
          tbases4=tbases2;   treten4=treten2;
          clave4 = clave2;
          |HAZ Imprime;
     |FINSI;
     |SI tbases3!0;|O treten3!0;
          tbases4=tbases3;   treten4=treten3;
          clave4 = clave3;
          |HAZ Imprime;
     |FINSI;
|FPRC;

|PROCESO eosm0034I;
     #eosw0090#36 = #eosw0090#36 + #eosm0034#8;   || retencion dineraria
     #eosw0090#37 = #eosw0090#37 + #eosm0034#7;   || base dineraria

     #eosw0090#38 = #eosw0090#38 + #eosm0034#9;    || base en especie
     #eosw0090#39 = #eosw0090#39 + #eosm0034#10;    || retencion en especie
     #eosw0090#40 = #eosw0090#40 + #eosm0034#11;  || ret.en especie rep.

     |SI #eosm0034#8 ! 0; |O #eosm0034#7 ! 0;
      |O #eosm0034#9 ! 0; |O #eosm0034#10 ! 0;
          nSwAlgo = 1;
     |FINSI;
|FPRC;

|DEFBUCLE eosm0034I;
     #eosm0034#1;
     ;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 0000, "I", "  ", 0;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 9999, "I", "zz", 9;
     ;
     NULL, eosm0034I;
|FIN;

|PROCESO eosm0034H;
     #eosw0090#31 = #eosw0090#31 + #eosm0034#8;   || retencion dineraria
     #eosw0090#32 = #eosw0090#32 + #eosm0034#7;   || base dineraria

     #eosw0090#33 = #eosw0090#33 + #eosm0034#9;    || base en especie
     #eosw0090#34 = #eosw0090#34 + #eosm0034#10;   || retencion en especie
     #eosw0090#35 = #eosw0090#35 + #eosm0034#11;  || ret.en especie rep.

     |SI #eosm0034#8 ! 0; |O #eosm0034#7 ! 0;
      |O #eosm0034#9 ! 0; |O #eosm0034#10 ! 0;
          nSwAlgo = 1;
     |FINSI;
|FPRC;

|DEFBUCLE eosm0034H;
     #eosm0034#1;
     ;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 0000, "H", "  ", 0;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 9999, "H", "zz", 9;
     ;
     NULL, eosm0034H;
|FIN;

|PROCESO eosm0034G;
     #eosw0090#26 = #eosw0090#26 + #eosm0034#9;   || retencion dineraria
     #eosw0090#27 = #eosw0090#27 + #eosm0034#7;   || base dineraria

     #eosw0090#28 = #eosw0090#28 + #eosm0034#9;    || base en especie
     #eosw0090#29 = #eosw0090#29 + #eosm0034#10;    || retencion en especie
     #eosw0090#30 = #eosw0090#30 + #eosm0034#11;  || ret.en especie rep.

     |SI #eosm0034#8 ! 0; |O #eosm0034#7 ! 0;
      |O #eosm0034#9 ! 0; |O #eosm0034#10 ! 0;
          nSwAlgo = 1;
     |FINSI;
|FPRC;

|DEFBUCLE eosm0034G;
     #eosm0034#1;
     ;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 0000, "G", "  ", 0;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 9999, "G", "zz", 9;
     ;
     NULL, eosm0034G;
|FIN;

|PROCESO eosm0036I;
     #eosw0090#36 = #eosw0090#36 + #eosm0036#8 + #eosm0036#64;   || retencion dineraria
     #eosw0090#37 = #eosw0090#37 + #eosm0036#7 + #eosm0036#63;   || base dineraria

     #eosw0090#38 = #eosw0090#38 + #eosm0036#9  + #eosm0036#65;  || base en especie
     #eosw0090#39 = #eosw0090#39 + #eosm0036#10 + #eosm0036#66;  || retencion en especie
     #eosw0090#40 = #eosw0090#40 + #eosm0036#11 + #eosm0036#67;  || ret.en especie rep.

     |SI #eosm0036#8  ! 0; |O #eosm0036#7 ! 0;
      |O #eosm0036#9  ! 0; |O #eosm0036#10 ! 0;
      |O #eosm0036#63 ! 0; |O #eosm0036#64 ! 0;
      |O #eosm0036#65 ! 0; |O #eosm0036#66 ! 0;
          nSwAlgo = 1;
     |FINSI;
|FPRC;

|DEFBUCLE eosm0036I;
     #eosm0036#1;
     ;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 0000, "I", "  ", 0;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 9999, "I", "zz", 9;
     ;
     NULL, eosm0036I;
|FIN;

|PROCESO eosm0036H;
     #eosw0090#31 = #eosw0090#31 + #eosm0036#8 + #eosm0036#64;   || retencion dineraria
     #eosw0090#32 = #eosw0090#32 + #eosm0036#7 + #eosm0036#63;   || base dineraria

     #eosw0090#33 = #eosw0090#33 + #eosm0036#9  + #eosm0036#65;  || base en especie
     #eosw0090#34 = #eosw0090#34 + #eosm0036#10 + #eosm0036#66;  || retencion en especie
     #eosw0090#35 = #eosw0090#35 + #eosm0036#11 + #eosm0036#67;  || ret.en especie rep.

     |SI #eosm0036#8  ! 0; |O #eosm0036#7 ! 0;
      |O #eosm0036#9  ! 0; |O #eosm0036#10 ! 0;
      |O #eosm0036#63 ! 0; |O #eosm0036#64 ! 0;
      |O #eosm0036#65 ! 0; |O #eosm0036#66 ! 0;
         nSwAlgo = 1;
     |FINSI;
|FPRC;

|DEFBUCLE eosm0036H;
     #eosm0036#1;
     ;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 0000, "H", "  ", 0;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 9999, "H", "zz", 9;
     ;
     NULL, eosm0036H;
|FIN;

|PROCESO eosm0036G;
     #eosw0090#26 = #eosw0090#26 + #eosm0036#8 + #eosm0036#64;   || retencion dineraria
     #eosw0090#27 = #eosw0090#27 + #eosm0036#7 + #eosm0036#63;   || base dineraria

     #eosw0090#28 = #eosw0090#28 + #eosm0036#9  + #eosm0036#65;  || base en especie
     #eosw0090#29 = #eosw0090#29 + #eosm0036#10 + #eosm0036#66;  || retencion en especie
     #eosw0090#30 = #eosw0090#30 + #eosm0036#11 + #eosm0036#67;  || ret.en especie rep.

     |SI #eosm0036#8  ! 0; |O #eosm0036#7 ! 0;
      |O #eosm0036#9  ! 0; |O #eosm0036#10 ! 0;
      |O #eosm0036#63 ! 0; |O #eosm0036#64 ! 0;
      |O #eosm0036#65 ! 0; |O #eosm0036#66 ! 0;
          nSwAlgo = 1;
     |FINSI;
|FPRC;

|DEFBUCLE eosm0036G;
     #eosm0036#1;
     ;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 0000, "G", "  ", 0;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 9999, "G", "zz", 9;
     ;
     NULL, eosm0036G;
|FIN;

|PROCESO Normal6;
     |DDEFECTO #eosw0090;
     nSwAlgo = 0;

     |SI #eosyycer#5 [ 2015;
         |BUCLE eosm0034G;
         |BUCLE eosm0034H;
         |BUCLE eosm0034I;
     |FINSI;

     |SI #eosyycer#5 ] 2016;
         |BUCLE eosm0036G;
         |BUCLE eosm0036H;
         |BUCLE eosm0036I;
     |FINSI;

     |SI nSwAlgo ! 0;
          |HAZ Imprime;
     |FINSI;
|FPRC;

|PROCESO eosm0034A;
     #eosw0090#0 = #eosw0090#0 + #eosm0034#8;     || retencion dineraria
     #eosw0090#1 = #eosw0090#1 + #eosm0034#7;     || base dineraria

     #eosw0090#2 = #eosw0090#2 + #eosm0034#9;    || base en especie
     #eosw0090#3 = #eosw0090#3 + #eosm0034#10;   || retencion en especie
     #eosw0090#4 = #eosw0090#4 + #eosm0034#11;   || ret.en especie rep.

     |SI #eosm0034#8 ! 0; |O #eosm0034#7 ! 0;
      |O #eosm0034#9 ! 0; |O #eosm0034#10 ! 0;
          nSwAlgo = 1;
     |FINSI;
|FPRC;

|DEFBUCLE eosm0034A;
     #eosm0034#1;
     ;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 0000, "A", "  ", 0;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 9999, "A", "zz", 9;
     ;
     NULL, eosm0034A;
|FIN;

|PROCESO eosm0034K;
     #eosw0090#21 = #eosw0090#21 + #eosm0034#8;   || retencion dineraria
     #eosw0090#22 = #eosw0090#22 + #eosm0034#7;   || base dineraria

     #eosw0090#23 = #eosw0090#23 + #eosm0034#9;    || base en especie
     #eosw0090#24 = #eosw0090#24 + #eosm0034#10;    || retencion en especie
     #eosw0090#25 = #eosw0090#25 + #eosm0034#11;  || ret.en especie rep.

     |SI #eosm0034#8 ! 0; |O #eosm0034#7 ! 0;
      |O #eosm0034#9 ! 0; |O #eosm0034#10 ! 0;
          nSwAlgo = 1;
     |FINSI;
|FPRC;

|DEFBUCLE eosm0034K;
     #eosm0034#1;
     ;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 0000, "K", "  ", 0;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 9999, "K", "zz", 9;
     ;
     NULL, eosm0034K;
|FIN;

|PROCESO eosm0034L;
     |SI #eosm0034#5 = "01";
          #eosw0090#19 = #eosw0090#19 + #eosm0034#7;
     |SINO;
          #eosw0090#20 = #eosw0090#20 + #eosm0034#7 + #eosm0034#9;
     |FINSI;

     |SI #eosm0034#7 ! 0; |O #eosm0034#9 ! 0;
          nSwAlgo = 1;
     |FINSI;
|FPRC;

|DEFBUCLE eosm0034L;
     #eosm0034#1;
     ;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 0000, "L", "  ", 0;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 9999, "L", "zz", 9;
     ;
     NULL, eosm0034L;
|FIN;

|PROCESO eosm0034EjAnter;
     nBase = #eosm0034#7 + #eosm0034#9;
     nCuot = #eosm0034#8 + #eosm0034#10;

     |SI #eosw0090#7 = 0; |O #eosm0034#3 = #eosw0090#7;
          #eosw0090#7 = #eosm0034#3;
          #eosw0090#11 = #eosw0090#11 + nBase;
          #eosw0090#15 = #eosw0090#15 + nCuot;
     |SINO;
          |SI #eosw0090#8 = 0;|O #eosm0034#3 = #eosw0090#8;
               #eosw0090#8 = #eosm0034#3;
               #eosw0090#12 = #eosw0090#12 + nBase;
               #eosw0090#16 = #eosw0090#16 + nCuot;
          |SINO;
               |SI #eosw0090#9 = 0;|O #eosm0034#3 = #eosw0090#9;
                    #eosw0090#9 = #eosm0034#3;
                    #eosw0090#13 = #eosw0090#13 + nBase;
                    #eosw0090#17 = #eosw0090#17 + nCuot;
               |SINO;
                    |SI #eosw0090#10 = 0;|O #eosm0034#3 = #eosw0090#10;
                         #eosw0090#10 = #eosm0034#3;
                         #eosw0090#14 = #eosw0090#14 + nBase;
                         #eosw0090#18 = #eosw0090#18 + nCuot;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;

     |SI #eosm0034#8 ! 0; |O #eosm0034#7 ! 0;
      |O #eosm0034#9 ! 0; |O #eosm0034#10 ! 0;
          nSwAlgo = 1;
     |FINSI;
|FPRC;

|DEFBUCLE eosm0034EjAnter;
     #eosm0034#1;
     ;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 0001, " ", "  ", 0;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 9999, "z", "zz", 9;
     ;
     NULL, eosm0034EjAnter;
|FIN;

|PROCESO eosm0036A;
     #eosw0090#0 = #eosw0090#0 + #eosm0036#8 + #eosm0036#64;  || retencion dineraria
     #eosw0090#1 = #eosw0090#1 + #eosm0036#7 + #eosm0036#63;  || base dineraria

     #eosw0090#2 = #eosw0090#2 + #eosm0036#9  + #eosm0036#65;    || base en especie
     #eosw0090#3 = #eosw0090#3 + #eosm0036#10 + #eosm0036#66;   || retencion en especie
     #eosw0090#4 = #eosw0090#4 + #eosm0036#11 + #eosm0036#67;   || ret.en especie rep.

     |SI #eosm0036#8  ! 0; |O #eosm0036#7 ! 0;
      |O #eosm0036#9  ! 0; |O #eosm0036#10 ! 0;
      |O #eosm0036#63 ! 0; |O #eosm0036#64 ! 0;
      |O #eosm0036#65 ! 0; |O #eosm0036#66 ! 0;
          nSwAlgo = 1;
     |FINSI;
|FPRC;

|DEFBUCLE eosm0036A;
     #eosm0036#1;
     ;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 0000, "A", "  ", 0;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 9999, "A", "zz", 9;
     ;
     NULL, eosm0036A;
|FIN;

|PROCESO eosm0036K;
     #eosw0090#21 = #eosw0090#21 + #eosm0036#8 + #eosm0036#64;   || retencion dineraria
     #eosw0090#22 = #eosw0090#22 + #eosm0036#7 + #eosm0036#63;   || base dineraria

     #eosw0090#23 = #eosw0090#23 + #eosm0036#9  + #eosm0036#65;    || base en especie
     #eosw0090#24 = #eosw0090#24 + #eosm0036#10 + #eosm0036#66;    || retencion en especie
     #eosw0090#25 = #eosw0090#25 + #eosm0036#11 + #eosm0036#67;  || ret.en especie rep.

     |SI #eosm0036#8  ! 0; |O #eosm0036#7 ! 0;
      |O #eosm0036#9  ! 0; |O #eosm0036#10 ! 0;
      |O #eosm0036#63 ! 0; |O #eosm0036#64 ! 0;
      |O #eosm0036#65 ! 0; |O #eosm0036#66 ! 0;
          nSwAlgo = 1;
     |FINSI;
|FPRC;

|DEFBUCLE eosm0036K;
     #eosm0036#1;
     ;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 0000, "K", "  ", 0;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 9999, "K", "zz", 9;
     ;
     NULL, eosm0036K;
|FIN;

|PROCESO eosm0036L;
     |SI #eosm0036#5 = "01";
          #eosw0090#19 = #eosw0090#19 + #eosm0036#7 + #eosm0036#63;
     |SINO;
          #eosw0090#20 = #eosw0090#20 + #eosm0036#7  + #eosm0036#9;
          #eosw0090#20 = #eosw0090#20 + #eosm0036#63 + #eosm0036#65;
     |FINSI;

     |SI #eosm0036#7 ! 0; |O #eosm0036#9 ! 0;
      |O #eosm0036#63 ! 0; |O #eosm0036#65 ! 0;
          nSwAlgo = 1;
     |FINSI;
|FPRC;

|DEFBUCLE eosm0036L;
     #eosm0036#1;
     ;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 0000, "L", "  ", 0;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 9999, "L", "zz", 9;
     ;
     NULL, eosm0036L;
|FIN;

|PROCESO eosm0036EjAnter;
     nBase = #eosm0036#7 + #eosm0036#9;
     nBase = nBase + #eosm0036#63 + #eosm0036#65;
     nCuot = #eosm0036#8 + #eosm0036#10;
     nCuot = nCuot + #eosm0036#64 + #eosm0036#66;

     |SI #eosw0090#7 = 0; |O #eosm0036#3 = #eosw0090#7;
          #eosw0090#7 = #eosm0036#3;
          #eosw0090#11 = #eosw0090#11 + nBase;
          #eosw0090#15 = #eosw0090#15 + nCuot;
     |SINO;
          |SI #eosw0090#8 = 0;|O #eosm0036#3 = #eosw0090#8;
               #eosw0090#8 = #eosm0036#3;
               #eosw0090#12 = #eosw0090#12 + nBase;
               #eosw0090#16 = #eosw0090#16 + nCuot;
          |SINO;
               |SI #eosw0090#9 = 0;|O #eosm0036#3 = #eosw0090#9;
                    #eosw0090#9 = #eosm0036#3;
                    #eosw0090#13 = #eosw0090#13 + nBase;
                    #eosw0090#17 = #eosw0090#17 + nCuot;
               |SINO;
                    |SI #eosw0090#10 = 0;|O #eosm0036#3 = #eosw0090#10;
                         #eosw0090#10 = #eosm0036#3;
                         #eosw0090#14 = #eosw0090#14 + nBase;
                         #eosw0090#18 = #eosw0090#18 + nCuot;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;

     |SI #eosm0036#8  ! 0; |O #eosm0036#7  ! 0;
      |O #eosm0036#64 ! 0; |O #eosm0036#63 ! 0;
      |O #eosm0036#9  ! 0; |O #eosm0036#10 ! 0;
      |O #eosm0036#65 ! 0; |O #eosm0036#66 ! 0;
          nSwAlgo = 1;
     |FINSI;
|FPRC;

|DEFBUCLE eosm0036EjAnter;
     #eosm0036#1;
     ;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 0001, " ", "  ", 0;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, 9999, "z", "zz", 9;
     ;
     NULL, eosm0036EjAnter;
|FIN;

|PROCESO Normal5;
     |DDEFECTO #eosw0090;
     nSwAlgo = 0;

     |SI #eosyycer#5 [ 2015;
         |BUCLE eosm0034A;
         |BUCLE eosm0034K;
         |BUCLE eosm0034L;
         |BUCLE eosm0034EjAnter;
     |FINSI;

     |SI #eosyycer#5 ] 2016;
         |BUCLE eosm0036A;
         |BUCLE eosm0036K;
         |BUCLE eosm0036L;
         |BUCLE eosm0036EjAnter;
     |FINSI;

     #eosw0090#6 = tdescue;
     |SI tdescue ! 0;
          nSwAlgo = 1;
     |FINSI;

     |SI nSwAlgo ! 0;
          |HAZ Imprime;
     |FINSI;
|FPRC;

|PROCESO Normal;
     |SI tbases1!0;|O tbases2!0;|O tbases3!0;|O treten1!0;
                   |O treten2!0;|O treten3!0;|O tdescue!0;
          letrai = 0;
          clave1 = aClave1;
          clave2 = aClave2;
          clave3 = aClave3;

          |SI #eosyycer#6 = 4;  |HAZ Normal4;  |FINSI;
          |SI #eosyycer#6 = 5;  |HAZ Normal5;  |ACABA;  |FINSI;
          |SI #eosyycer#6 = 6;  |HAZ Normal6;  |ACABA;  |FINSI;

          |SI #eosyycer#6 ! 4; |Y  #eosyycer#6 ! 5;  |Y #eosyycer#6 ! 6;
               |HAZ Imprime;
          |FINSI;
     |FINSI;

     |SI texenta ! 0;
          letrai = 1;
          clave1 = "L";
          clave2 = "";
          clave3 = "";
          |SI #eosyycer#6 = 4;
               clave4 = clave1;
          |FINSI;
          |HAZ Imprime;
     |FINSI;
|FPRC;

|PROCESO GastosEsp;
     |SI #eosm0034#4 = "A"; |Y #eosm0034#5 = "02";
         |DDEFECTO #espejo1@;
         #espejo1@#0 = #eosm0034#0;
         #espejo1@#1 = #eosm0034#1;
         #espejo1@#2 = #eosm0034#2;
         #espejo1@#3 = #eosm0034#3;
         #espejo1@#4 = "A";
         #espejo1@#5 = "01";
         #espejo1@#6 = #eosm0034#6;
         |LEE 041#espejo1@.=;
         |SI FSalida = 0;
             nSSocial = 0;
         |FINSI;
         |CIERRA #espejo1@;
     |FINSI;
|FPRC;

|PROCESO eosm0034;
     |SI #eosm0034#4 = "L";
         texenta = texenta + (#eosm0034#7 + #eosm0034#9);     || bases
         |ACABA;
     |FINSI;

     |SI aClave ! #eosm0034#4;
         aClave = #eosm0034#4;
         nContador = nContador + 1;
     |FINSI;

     |SI nContador > 3;  |ERROR10;  |ACABA;  |FINSI;

     nSSocial = #eosm0034#13;
     |SI #eosm0034#4 = "A"; |Y #eosm0034#1 = 2015;
         |HAZ GastosEsp;
     |FINSI;
     tdescue = tdescue + nSSocial;                 || seg.social

     |SI nContador = 1;
         |SI #eosm0034#7 ! 0;  |Y #eosm0034#9 = 0;
             |SI aClave1 = "";
                 tbases1   = tbases1   + #eosm0034#7;     || bases
                 treten1   = treten1   + #eosm0034#8;     || cuota
                 aClave1   = #eosm0034#4;
                 especie1  = "N";
             |SINO;
                 |SI especie1 = "N";
                     tbases1   = tbases1   + #eosm0034#7;     || bases
                     treten1   = treten1   + #eosm0034#8;     || cuota
                     aClave1   = #eosm0034#4;
                     especie1  = "N";
                 |SINO;
                     tbases2   = tbases2   + #eosm0034#7;     || bases
                     treten2   = treten2   + #eosm0034#8;     || cuota
                     aClave2   = #eosm0034#4;
                     especie2  = "S";
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI #eosm0034#7 = 0;  |Y #eosm0034#9 ! 0;
             |SI aClave1 = "";
                 tbases1   = tbases1   + #eosm0034#9;     || bases
                 treten1   = treten1   + #eosm0034#10;     || cuota
                 aClave1   = #eosm0034#4;
                 especie1  = "S";
             |SINO;
                 |SI especie1 = "S";
                     tbases1   = tbases1   + #eosm0034#9;    || bases
                     treten1   = treten1   + #eosm0034#10;    || cuota
                     aClave1   = #eosm0034#4;
                     especie1  = "S";
                 |SINO;
                     tbases2   = tbases2   + #eosm0034#9;    || bases
                     treten2   = treten2   + #eosm0034#10;    || cuota
                     aClave2   = #eosm0034#4;
                     especie2  = "S";
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI #eosm0034#7 ! 0;  |Y #eosm0034#9 ! 0;
             |SI aClave1 = "";
                 tbases1   = tbases1   + #eosm0034#7;     || bases
                 treten1   = treten1   + #eosm0034#8;     || cuota
                 aClave1   = #eosm0034#4;
                 especie1  = "N";

                 tbases2   = tbases2   + #eosm0034#9;     || bases
                 treten2   = treten2   + #eosm0034#10;     || cuota
                 aClave2   = #eosm0034#4;
                 especie2  = "S";
             |SINO;
                 |SI especie1 = "N";
                     tbases1   = tbases1   + #eosm0034#7;     || bases
                     treten1   = treten1   + #eosm0034#8;     || cuota
                     aClave1   = #eosm0034#4;
                     especie1  = "N";

                     tbases2   = tbases2   + #eosm0034#9;     || bases
                     treten2   = treten2   + #eosm0034#10;     || cuota
                     aClave2   = #eosm0034#4;
                     especie2  = "S";
                 |SINO;
                     tbases2   = tbases2   + #eosm0034#7;     || bases
                     treten2   = treten2   + #eosm0034#8;     || cuota
                     aClave2   = #eosm0034#4;
                     especie2  = "N";

                     tbases1   = tbases1   + #eosm0034#9;     || bases
                     treten1   = treten1   + #eosm0034#10;     || cuota
                     aClave1   = #eosm0034#4;
                     especie1  = "S";
                 |FINSI;
             |FINSI;
          |FINSI;
          |ACABA;
     |FINSI;

     |SI nContador = 2;
         |SI #eosm0034#7 ! 0;  |Y #eosm0034#9 = 0;
             |SI aClave2 = "";
                 tbases2   = tbases2   + #eosm0034#7;     || bases
                 treten2   = treten2   + #eosm0034#8;     || cuota
                 aClave2   = #eosm0034#4;
                 especie2  = "N";
             |SINO;
                 |SI aClave2 = aClave;
                     |SI especie2 = "N";
                         tbases2   = tbases2   + #eosm0034#7;     || bases
                         treten2   = treten2   + #eosm0034#8;     || cuota
                         aClave2   = #eosm0034#4;
                         especie2  = "N";
                     |SINO;
                         tbases3   = tbases3   + #eosm0034#7;     || bases
                         treten3   = treten3   + #eosm0034#8;     || cuota
                         aClave3   = #eosm0034#4;
                         especie3  = "S";
                     |FINSI;
                 |SINO;
                     tbases3   = tbases3   + #eosm0034#7 + #eosm0034#9;     || bases
                     treten3   = treten3   + #eosm0034#8 + #eosm0034#10;     || cuota
                     aClave3   = #eosm0034#4;
                     especie3  = "N";
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI #eosm0034#7 = 0;  |Y #eosm0034#9 ! 0;
             |SI aClave2 = "";
                 tbases2   = tbases2   + #eosm0034#9;     || bases
                 treten2   = treten2   + #eosm0034#10;     || cuota
                 aClave2   = #eosm0034#4;
                 especie2  = "S";
             |SINO;
                 |SI aClave2 = aClave;
                     |SI especie2 = "S";
                         tbases2   = tbases1   + #eosm0034#9;    || bases
                         treten2   = treten1   + #eosm0034#10;    || cuota
                         aClave2   = #eosm0034#4;
                         especie2  = "S";
                     |SINO;
                         tbases3   = tbases3   + #eosm0034#9;    || bases
                         treten3   = treten3   + #eosm0034#10;    || cuota
                         aClave3   = #eosm0034#4;
                         especie3  = "S";
                     |FINSI;
                  |SINO;
                      tbases3   = tbases3   + #eosm0034#7 + #eosm0034#9;     || bases
                      treten3   = treten3   + #eosm0034#8 + #eosm0034#10;     || cuota
                      aClave3   = #eosm0034#4;
                      especie3  = "N";
                  |FINSI;
             |FINSI;
         |FINSI;

         |SI #eosm0034#7 ! 0;  |Y #eosm0034#9 ! 0;
             |SI aClave2 = "";
                 tbases2   = tbases2   + #eosm0034#7;     || bases
                 treten2   = treten2   + #eosm0034#8;     || cuota
                 aClave2   = #eosm0034#4;
                 especie2  = "N";

                 tbases3   = tbases3   + #eosm0034#9;     || bases
                 treten3   = treten3   + #eosm0034#10;     || cuota
                 aClave3   = #eosm0034#4;
                 especie3  = "S";
             |SINO;
                 |SI aClave2 = aClave;
                     |SI especie2 = "N";
                         tbases2   = tbases2   + #eosm0034#7;     || bases
                         treten2   = treten2   + #eosm0034#8;     || cuota
                         aClave2   = #eosm0034#4;
                         especie2  = "N";

                         tbases3   = tbases3   + #eosm0034#9;     || bases
                         treten3   = treten3   + #eosm0034#10;     || cuota
                         aClave3   = #eosm0034#4;
                         especie3  = "S";
                     |SINO;
                         tbases3   = tbases3   + #eosm0034#7;     || bases
                         treten3   = treten3   + #eosm0034#8;     || cuota
                         aClave3   = #eosm0034#4;
                         especie3  = "N";

                         tbases2   = tbases2   + #eosm0034#9;     || bases
                         treten2   = treten2   + #eosm0034#10;     || cuota
                         aClave2   = #eosm0034#4;
                         especie2  = "S";
                    |FINSI;
                  |SINO;
                      tbases3   = tbases3   + #eosm0034#7 + #eosm0034#9;     || bases
                      treten3   = treten3   + #eosm0034#8 + #eosm0034#10;     || cuota
                      aClave3   = #eosm0034#4;
                      especie3  = "N";
                  |FINSI;
             |FINSI;
          |FINSI;
          |ACABA;
     |FINSI;

     |SI nContador = 3;
         |SI aClave3 = "";
             tbases3   = tbases3   + #eosm0034#7 + #eosm0034#9;     || bases
             treten3   = treten3   + #eosm0034#8 + #eosm0034#10;     || cuota
             aClave3   = #eosm0034#4;
             especie3  = "N";
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE eosm0034;
     #eosm0034#2;
     ;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, " ", "  ", 0000, 0;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, "z", "zz", 9999, 9;
     ;
     NULL, eosm0034;
|FIN;

|PROCESO eosm0036;
     nBasDin = #eosm0036#7  + #eosm0036#63;
     nRetDin = #eosm0036#8  + #eosm0036#64;
     nBasEsp = #eosm0036#9  + #eosm0036#65;
     nRetEsp = #eosm0036#10 + #eosm0036#66;

     |SI #eosm0036#4 = "L";
         texenta = texenta + (nBasDin + nBasEsp);     || bases
         |ACABA;
     |FINSI;

     |SI aClave ! #eosm0036#4;
         aClave = #eosm0036#4;
         nContador = nContador + 1;
     |FINSI;

     |SI nContador > 3;  |ERROR10;  |ACABA;  |FINSI;

     nSSocial = #eosm0036#13;
     tdescue  = tdescue + nSSocial;                 || seg.social

     |SI nContador = 1;
         |SI nBasDin ! 0;  |Y nBasEsp = 0;
             |SI aClave1 = "";
                 tbases1   = tbases1   + nBasDin;     || bases
                 treten1   = treten1   + nRetDin;     || cuota
                 aClave1   = #eosm0036#4;
                 especie1  = "N";
             |SINO;
                 |SI especie1 = "N";
                     tbases1   = tbases1   + nBasDin;     || bases
                     treten1   = treten1   + nRetDin;     || cuota
                     aClave1   = #eosm0036#4;
                     especie1  = "N";
                 |SINO;
                     tbases2   = tbases2   + nBasDin;     || bases
                     treten2   = treten2   + nRetDin;     || cuota
                     aClave2   = #eosm0036#4;
                     especie2  = "S";
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI nBasDin = 0;  |Y nBasEsp ! 0;
             |SI aClave1 = "";
                 tbases1   = tbases1   + nBasEsp;     || bases
                 treten1   = treten1   + nRetEsp;     || cuota
                 aClave1   = #eosm0036#4;
                 especie1  = "S";
             |SINO;
                 |SI especie1 = "S";
                     tbases1   = tbases1   + nBasEsp;    || bases
                     treten1   = treten1   + nRetEsp;    || cuota
                     aClave1   = #eosm0036#4;
                     especie1  = "S";
                 |SINO;
                     tbases2   = tbases2   + nBasEsp;    || bases
                     treten2   = treten2   + nRetEsp;    || cuota
                     aClave2   = #eosm0036#4;
                     especie2  = "S";
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI nBasDin ! 0;  |Y nBasEsp ! 0;
             |SI aClave1 = "";
                 tbases1   = tbases1   + nBasDin;     || bases
                 treten1   = treten1   + nRetDin;     || cuota
                 aClave1   = #eosm0036#4;
                 especie1  = "N";

                 tbases2   = tbases2   + nBasEsp;     || bases
                 treten2   = treten2   + nRetEsp;     || cuota
                 aClave2   = #eosm0036#4;
                 especie2  = "S";
             |SINO;
                 |SI especie1 = "N";
                     tbases1   = tbases1   + nBasDin;     || bases
                     treten1   = treten1   + nRetDin;     || cuota
                     aClave1   = #eosm0036#4;
                     especie1  = "N";

                     tbases2   = tbases2   + nBasEsp;     || bases
                     treten2   = treten2   + nRetEsp;     || cuota
                     aClave2   = #eosm0036#4;
                     especie2  = "S";
                 |SINO;
                     tbases2   = tbases2   + nBasDin;     || bases
                     treten2   = treten2   + nRetDin;     || cuota
                     aClave2   = #eosm0036#4;
                     especie2  = "N";

                     tbases1   = tbases1   + nBasEsp;     || bases
                     treten1   = treten1   + nRetEsp;     || cuota
                     aClave1   = #eosm0036#4;
                     especie1  = "S";
                 |FINSI;
             |FINSI;
          |FINSI;
          |ACABA;
     |FINSI;

     |SI nContador = 2;
         |SI nBasDin ! 0;  |Y nBasEsp = 0;
             |SI aClave2 = "";
                 tbases2   = tbases2   + nBasDin;     || bases
                 treten2   = treten2   + nRetDin;     || cuota
                 aClave2   = #eosm0036#4;
                 especie2  = "N";
             |SINO;
                 |SI aClave2 = aClave;
                     |SI especie2 = "N";
                         tbases2   = tbases2   + nBasDin;     || bases
                         treten2   = treten2   + nRetDin;     || cuota
                         aClave2   = #eosm0036#4;
                         especie2  = "N";
                     |SINO;
                         tbases3   = tbases3   + nBasDin;     || bases
                         treten3   = treten3   + nRetDin;     || cuota
                         aClave3   = #eosm0036#4;
                         especie3  = "S";
                     |FINSI;
                 |SINO;
                     tbases3   = tbases3   + nBasDin + nBasEsp;     || bases
                     treten3   = treten3   + nRetDin + nRetEsp;     || cuota
                     aClave3   = #eosm0036#4;
                     especie3  = "N";
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI nBasDin = 0;  |Y nBasEsp ! 0;
             |SI aClave2 = "";
                 tbases2   = tbases2   + nBasEsp;     || bases
                 treten2   = treten2   + nRetEsp;     || cuota
                 aClave2   = #eosm0036#4;
                 especie2  = "S";
             |SINO;
                 |SI aClave2 = aClave;
                     |SI especie2 = "S";
                         tbases2   = tbases1   + nBasEsp;    || bases
                         treten2   = treten1   + nRetEsp;    || cuota
                         aClave2   = #eosm0036#4;
                         especie2  = "S";
                     |SINO;
                         tbases3   = tbases3   + nBasEsp;    || bases
                         treten3   = treten3   + nRetEsp;    || cuota
                         aClave3   = #eosm0036#4;
                         especie3  = "S";
                     |FINSI;
                  |SINO;
                      tbases3   = tbases3   + nBasDin + nBasEsp;     || bases
                      treten3   = treten3   + nRetDin + nRetEsp;     || cuota
                      aClave3   = #eosm0036#4;
                      especie3  = "N";
                  |FINSI;
             |FINSI;
         |FINSI;

         |SI nBasDin ! 0;  |Y nBasEsp ! 0;
             |SI aClave2 = "";
                 tbases2   = tbases2   + nBasDin;     || bases
                 treten2   = treten2   + nRetDin;     || cuota
                 aClave2   = #eosm0036#4;
                 especie2  = "N";

                 tbases3   = tbases3   + nBasEsp;     || bases
                 treten3   = treten3   + nRetEsp;     || cuota
                 aClave3   = #eosm0036#4;
                 especie3  = "S";
             |SINO;
                 |SI aClave2 = aClave;
                     |SI especie2 = "N";
                         tbases2   = tbases2   + nBasDin;     || bases
                         treten2   = treten2   + nRetDin;     || cuota
                         aClave2   = #eosm0036#4;
                         especie2  = "N";

                         tbases3   = tbases3   + nBasEsp;     || bases
                         treten3   = treten3   + nRetEsp;     || cuota
                         aClave3   = #eosm0036#4;
                         especie3  = "S";
                     |SINO;
                         tbases3   = tbases3   + nBasDin;     || bases
                         treten3   = treten3   + nRetDin;     || cuota
                         aClave3   = #eosm0036#4;
                         especie3  = "N";

                         tbases2   = tbases2   + nBasEsp;     || bases
                         treten2   = treten2   + nRetEsp;     || cuota
                         aClave2   = #eosm0036#4;
                         especie2  = "S";
                    |FINSI;
                  |SINO;
                      tbases3   = tbases3   + nBasDin + nBasEsp;     || bases
                      treten3   = treten3   + nRetDin + nRetEsp;     || cuota
                      aClave3   = #eosm0036#4;
                      especie3  = "N";
                  |FINSI;
             |FINSI;
          |FINSI;
          |ACABA;
     |FINSI;

     |SI nContador = 3;
         |SI aClave3 = "";
             tbases3   = tbases3   + nBasDin + nBasEsp;     || bases
             treten3   = treten3   + nRetDin + nRetEsp;     || cuota
             aClave3   = #eosm0036#4;
             especie3  = "N";
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE eosm0036;
     #eosm0036#2;
     ;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, " ", "  ", 0000, 0;
     #eosm0029#0, #eosyycer#5, #eosm0029#1, "z", "zz", 9999, 9;
     ;
     NULL, eosm0036;
|FIN;

|PROCESO CargaDomici;
     domemp = #eosclien#4 + " " + #eosclien#5;
     |QBF domemp;                        || construye domicilio empresa
     domemp = domemp + " " + #eosclien#6 + " " + #eosclien#7;

     nomrep = #eosclien#24 + #eosclien#25;  |QBF nomrep;
     |SI nomrep = "";
         nomrep = #eosclien#2;
         dnirep = #eosclien#1;
     |SINO;
         dnirep = #eosclien#26;
     |FINSI;

     #eosclipr#0 = #eosm0029#1;
     |LEE 040#eosclipr.=;
     |SI FSalida ! 0;  |DDEFECTO #eosclipr;  |FINSI;

     domtra = #eosclipr#2 + " " + #eosclipr#3;
     |QBF domtra;                        || construye domicilio trabajador
     domtra = domtra + " " + #eosclipr#4 + " " + #eosclipr#5;
|FPRC;

|PROCESO LeeEmp;
     |DDEFECTO #eosclien;
     #eosclien#0 = #eosm0029#0;
     |LEE 000#eosclien.=;
|FPRC;

|PROCESO Fecha1;
     alfa1 = #eosyycer#4;
     fecsys = alfa1 % 2;      || pasa la fecha a letras
     fletra = fecsys % 11;    || coge la parte literal de la fecha
     alfa1 = #eosclien#13;
     |QBF alfa1;
     fletra = alfa1 + ", a " + fletra;  || une la localidad a la fecha literal

     fprese = #eosyycer#4;
|FPRC;

|PROCESO Fecha2;
     alfa1 = #eosyycer#4;
     alfa2 = alfa1 %  102;   dia  = alfa2;         || dia
     alfa2 = alfa1 % -102;   anyo = alfa2;         || a¤o
     alfa2 = alfa1 %  402;                        || mes
     |SI alfa2 = "01";  mes = "ENERO     ";  |FINSI;
     |SI alfa2 = "02";  mes = "FEBRERO   ";  |FINSI;
     |SI alfa2 = "03";  mes = "MARZO     ";  |FINSI;
     |SI alfa2 = "04";  mes = "ABRIL     ";  |FINSI;
     |SI alfa2 = "05";  mes = "MAYO      ";  |FINSI;
     |SI alfa2 = "06";  mes = "JUNIO     ";  |FINSI;
     |SI alfa2 = "07";  mes = "JULIO     ";  |FINSI;
     |SI alfa2 = "08";  mes = "AGOSTO    ";  |FINSI;
     |SI alfa2 = "09";  mes = "SEPTIEMBRE";  |FINSI;
     |SI alfa2 = "10";  mes = "OCTUBRE   ";  |FINSI;
     |SI alfa2 = "11";  mes = "NOVIEMBRE ";  |FINSI;
     |SI alfa2 = "12";  mes = "DICIEMBRE ";  |FINSI;

     ejerc = #eosyycer#5 - 1990;
|FPRC;

|PROCESO Fecha3;
     alfa1 = #eosyycer#4;
     alfa2 = alfa1 %  102;   dia = alfa2;         || dia
     alfa2 = alfa1 % -104;  anyo = alfa2;         || a¤o
     alfa2 = alfa1 %  402;                        || mes
     |SI alfa2 = "01";  mes = "ENERO     ";  |FINSI;
     |SI alfa2 = "02";  mes = "FEBRERO   ";  |FINSI;
     |SI alfa2 = "03";  mes = "MARZO     ";  |FINSI;
     |SI alfa2 = "04";  mes = "ABRIL     ";  |FINSI;
     |SI alfa2 = "05";  mes = "MAYO      ";  |FINSI;
     |SI alfa2 = "06";  mes = "JUNIO     ";  |FINSI;
     |SI alfa2 = "07";  mes = "JULIO     ";  |FINSI;
     |SI alfa2 = "08";  mes = "AGOSTO    ";  |FINSI;
     |SI alfa2 = "09";  mes = "SEPTIEMBRE";  |FINSI;
     |SI alfa2 = "10";  mes = "OCTUBRE   ";  |FINSI;
     |SI alfa2 = "11";  mes = "NOVIEMBRE ";  |FINSI;
     |SI alfa2 = "12";  mes = "DICIEMBRE ";  |FINSI;

     ejerc = #eosyycer#5;
|FPRC;

|PROCESO Detalles;
     |HAZ LeeEmp;

     |SI #eosyycer#6 = 1;  informe = "eosyyce1";  |HAZ Fecha1;  |FINSI;
     |SI #eosyycer#6 = 2;  informe = "eosyyce2";  |HAZ Fecha2;  |FINSI;
     |SI #eosyycer#6 = 4;  informe = "eosyyce4";  |HAZ Fecha1;  |FINSI;
     |SI #eosyycer#6 = 5;  informe = "eosyyce5";  |HAZ Fecha3;  |FINSI;
     |SI #eosyycer#6 = 6;  informe = "eosyyce6";  |HAZ Fecha3;  |FINSI;

     |HAZ CargaDomici;
     periodo = #eosyycer#5;
|FPRC;

|PROCESO Acumulados;
     especie1 = "";
     especie2 = "";
     especie3 = "";
     tbases1  = 0;
     tbases2  = 0;
     tbases3  = 0;
     treten1  = 0;
     treten2  = 0;
     treten3  = 0;
     tdescue  = 0;
     texenta  = 0;
     aClave1  = "";
     aClave2  = "";
     aClave3  = "";
     aClave   = "";

     nContador = 0;

     |SI #eosyycer#5 [ 2015;
         |BUCLE eosm0034;
     |FINSI;

     |SI #eosyycer#5 ] 2016;
         |BUCLE eosm0036;
     |FINSI;

     |SI tbases1 ! 0;|O tbases2 ! 0;|O tbases3 ! 0; |O treten1 !0;
                     |O treten2 ! 0;|O treten3 ! 0; |O texenta !0;
                     |O tdescue ! 0;
          |HAZ Detalles;
     |FINSI;
|FPRC;

|PROCESO eosm0029;
     |HAZ Acumulados;
     |HAZ Normal;
|FPRC;

|DEFBUCLE eosm0029;
     #eosm0029#1;
     ;
     #eosyycer#0, #eosyycer#17;
     #eosyycer#1, #eosyycer#18;
     ;
     NULL, eosm0029;
|FIN;

|PROCESO Tipo3;
     |SI #eosyycer#19 = "PESETAS";
         eaMoneda = "Ptas.";
     |SINO;
         eaMoneda = "Euros";
     |FINSI;

     |IMPRE 0;
     |SI FSalida ! 0;
          |MENAV "0000Proceso Abortado ...";
          |ACABA;
     |FINSI;

     |DBASE aPathNomina;  |QBT aPathNomina;
     aDef = aPathNomina + "def/eosm0034.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     justi1 = #eosyycer#8;
     justi2 = #eosyycer#9;

     |ABRE #espejo1@;
     |ABRE #eosclipr;
     |ABRE #eosclien;

     |BUCLE eosm0029;

     |CIERRA #eosclipr;
     |CIERRA #espejo1@;

     |FINIMP;

     |DESCARGA_DEF #espejo1@;
|FPRC;

|PROGRAMA;
     |SI enEmpresa = 0;
         |CLS;
         |CABEZA "Certificado Renta";
         |PINPA #0#eosyycer;
         |PINDA #0#eosyycer;
         |ENDATOS #1#eosyycer;
         |SI FSalida = 0;  |HAZ Tipo3;  |FINSI;
     |SINO;
         |PINPA #0#eosyycer;
         #eosyycer#0 = enEmpresa;
         #eosyycer#1 = enEmpresa;
         #eosyycer#5 = enAnyo;

         |PINDA #0#eosyycer;

         |PTEC 802;
         |PTEC 802;
         |ENDATOS #1#eosyycer;
         |SI FSalida = 0;  |HAZ Tipo3;  |FINSI;
     |FINSI;
|FPRO;

|PROCESO Tipo80;  |TIPO 80;
     |ABRE #eosaplic;
     |LEE 040#eosaplic.p;
     |SI FSalida ! 0; |DDEFECTO #eosaplic; |FINSI;
     |CIERRA #eosaplic;

     |SI #eosaplic#11 = 1; |ACABA; |FINSI;

     |ABRE #agicontr;
     |LEE 040#agicontr.p;
     |SI FSalida ! 0; |CIERRA #agicontr; |ACABA; |FINSI;
     |CIERRA #agicontr;

     aPathFich = #agicontr#8; |QBF aPathFich;
     |SI aPathFich = "*";  |ACABA;  |FINSI;
     aPathPan = (aPathFich - "fich/") + "pan/";

     |PATH_DAT #eosclipr#aPathFich#;
     |PATH_PAN #eosclipr#aPathPan#;
|FPRC;
