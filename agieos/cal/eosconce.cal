|FICHEROS;
     eosconce #0;
     eosconcd #1;
     dsmom073;
|FIN;

|VARIABLES;
      FEstado = 0;

      aTipoIVA      = "";
      aAlfa         = "";
      aID           = "";

      nID           = 0;

  {40}aPopup        = "";

      &enEjerIRPF   = 0;
|FIN;

|PROCESO T0ClavesFConce;  |TIPO 0;
     |SI #eosconce#12 = " ";  |Y #eosconce#13 = "  ";
         |ACABA;
     |FINSI;

     enEjerIRPF = 9999;
     |HAZ BuscaEjerIRPF;

     |ABRE #dsmom073;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = #eosconce#12;
     #dsmom073#2 = #eosconce#13;
     |LEE 000#dsmom073.=;
     |SI FSalida ! 0;
         aAlfa = "0000Clave no correcta en el ejercicio " + enEjerIRPF;
         |MENAV aAlfa;
         |ERROR;
     |FINSI;
     |CIERRA #dsmom073;
|FPRC;

|PROCESO Baja73;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = "";
     #dsmom073#2 = "";
|FPRC;

|PROCESO Alta73;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = "z";
     #dsmom073#2 = "zz";
|FPRC;

|PROCESO T66ClavesFConce;  |TIPO 66;
     enEjerIRPF = 9999;
     |HAZ BuscaEjerIRPF;

     |ABRE #dsmom073;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = #eosconce#12;
     #dsmom073#2 = #eosconce#13;
     |LEE 000#dsmom073.];

     |CONSULTA_F_CLAVE #1#dsmom073, Baja73, Alta73;
     |SI FSalida = 0;
          #eosconce#12 = #dsmom073#1;    |PINTA #eosconce#12;
          #eosconce#13 = #dsmom073#2;    |PINTA #eosconce#13;
     |FINSI;
     |CIERRA #dsmom073;

     |ERROR;
|FPRC;

|PROCESO cuadro1; |TIPO 7;
     |PUSHV 0501 2380;
     |CUADRO 1056 1578;
     |ATRI R;
     |PINTA 1157, " N = Sin IVA,Rec,Ret.";
     |PINTA 1257, " R = Repercutido     ";
     |PINTA 1357, " S = Soportado       ";
     |PINTA 1457, " I = Inversiones     ";
|FPRC;

|PROCESO cuadro2; |TIPO 7;
     |PUSHV 0501 2380;
     |CUADRO 1056 1572;
     |ATRI R;
     |PINTA 1157, " I = Ingresos  ";
     |PINTA 1257, " G = Gastos    ";
     |PINTA 1357, " S = Suplidos  ";
     |PINTA 1457, " N = Ninguno   ";
|FPRC;

|PROCESO cuadro3; |TIPO 7;
     |PUSHV 0501 2380;
     |CUADRO 856 1976;
     |ATRI R;
     |PINTA 0957, " 1 = Columna N§ 1  ";
     |PINTA 1057, " 2 = Columna N§ 2  ";
     |PINTA 1157, " 3 = Columna N§ 3  ";
     |PINTA 1257, " 4 = Columna N§ 4  ";
     |PINTA 1357, " 5 = Columna N§ 5  ";
     |PINTA 1457, " 6 = Columna N§ 6  ";
     |PINTA 1557, " 7 = Columna N§ 7  ";
     |PINTA 1657, " 8 = Columna N§ 8  ";
     |PINTA 1757, " 9 = Columna N§ 9  ";
     |PINTA 1857, " 0 = No hace libro ";
|FPRC;

|PROCESO cuadro6; |TIPO 7;
     |PUSHV 0501 2380;
     |CUADRO 0538 2379;
     |ATRI R;
     |PINTA 0539, " COMPRAS                                ";
     |PINTA 0639, " 1 = Operaciones Interiores Corrientes  ";
     |PINTA 0739, " 2 = Importaciones                      ";
     |PINTA 0839, " 3 = Regimen A, G y P                   ";
     |PINTA 0939, " 4 = Operaciones Interiores Inversiones ";
     |PINTA 1039, " 5 = Importaciones Inversiones          ";
     |PINTA 1139, " 6 = Adq.Intracomunitarias Corrientes   ";
     |PINTA 1239, " 7 = Regularizacion Inversiones         ";
     |PINTA 1339, " 8 = Adq.Intracomunitarias Inversion    ";
     |PINTA 1439, " 0 = Ninguno                            ";
     |PINTA 1539, " VENTAS (V.Operaciones Casillas del 390)";
     |PINTA 1639, " 00 = Casilla 100      07 = Casilla 107 ";
     |PINTA 1739, " 01 = Casilla 103      08 = Casilla 109 ";
     |PINTA 1839, " 02 = Casilla 104      09 = Casilla 111 ";
     |PINTA 1939, " 03 = Casilla 105      10 = Casilla 112 ";
     |PINTA 2039, " 04 = Casilla 101      11 = Casilla 113 ";
     |PINTA 2139, " 05 = Casilla 102      12 = Casilla  99 ";
     |PINTA 2239, " 06 = Casilla 106      13 = Casilla 110 ";
     |PINTA 2339, "                       14 = Casilla 523 ";
     |ATRI 0;
     ||PINTA 1438, "ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´";
|FPRC;

|PROCESO cuadro7; |TIPO 7;
     |PUSHV 0501 2380;

     |CUADRO 1542 2177;
     |ATRI R;
     |PINTA 1643, "   Calculo de las retenciones en  ";
     |PINTA 1743, " los libros de COMPRAS Y VENTAS   ";
     |PINTA 1843, "----------------------------------";
     |PINTA 1943, "   1 = Sobre Base Imponible       ";
     |PINTA 2043, "   2 = Sobre B.Imponible+IVA+Rec. ";
     |CAMPO_MODIFICA #0#10,  1, "S";

     |SI #0#3 ! "G";
         |CAMPO_MODIFICA #0#10, 1, "N";
         #0#10 = "N";  |PINTA #0#10;
     |FINSI;
|FPRC;

|PROCESO NoRetencion;
     |C_M #0#12, 1, "S";
     |C_M #0#13, 1, "S";
     |C_M #0#14, 1, "S";
     |SI #0#10 = "N";
         |C_M #0#12, 1, "N";  #0#12 = " ";   |PINTA #0#12;
         |C_M #0#13, 1, "N";  #0#13 = "  ";  |PINTA #0#13;
         |C_M #0#14, 1, "N";  #0#14 = " ";   |PINTA #0#14;
     |FINSI;
|FPRC;

|PROCESO cuadro8; |TIPO 7;
     |PUSHV 0501 2380;
     |CUADRO 1542 2377;
     |ATRI R;
     |PINTA 1643, "   Pase del libro de compras a    ";
     |PINTA 1743, " los modelos :                    ";
     |PINTA 1843, "    -Trabajadores IRPF    (REO)   ";
     |PINTA 1943, "    -Trabajadores Nominas (aginom)";
     |PINTA 2043, "----------------------------------";
     |PINTA 2143, "  <S> Traspasara el apunte del    ";
     |PINTA 2243, "      libro si tuviera retencion. ";
|FPRC;

|PROCESO cuadro9; |TIPO 7;
     |PUSHV 0501 2380;
     |CUADRO 0538 1579;
     |ATRI R;
     |PINTA 0639, " CUOTAS DEVENGADAS                      ";
     |PINTA 0739, " 01 = Adquisiciones intracomunitarias   ";
     |PINTA 0839, " 02 = Entregas de activos fijos         ";
     |PINTA 0939, " 03 = IVA devengado inv.sujeto pasivo   ";
     |PINTA 1039, " 00 = Ninguno                           ";
     |PINTA 1139, " -------------------------------------- ";
     |PINTA 1239, " CUOTAS DEDUCIBLES                      ";
     |PINTA 1339, " 00 = Cuotas soportadas oper.corrientes ";
     |PINTA 1439, " 01 = Adquisicion Activos Fijos         ";
     |ATRI 0;
|FPRC;

|PROCESO recupera9; |TIPO 0;
     |HAZ recupera;
     |SI #0#3 = "I"; |Y #0Campo > 3; |ERROR; |FINSI;
     |SI #0#3 = "G"; |Y #0Campo > 1; |ERROR; |FINSI;
|FPRC;

|PROCESO recupera; |TIPO 0;
     |ATRI 0;
     |POPV;
     |PINTA #0Campo;
|FPRC;

|PROCESO agricola; |TIPO 0;
     |SI FSalida ! 9; |ACABA; |FINSI;

     |PUSHV 0501 2380;
     |PINPA #0#1;

     |ABRE #1;
     #1#0 = #0#0;
     |LIBERA #1;
     |LEE 140#1=;
     |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
     FEstado = FSalida;

     #1#0 = #0#0;
     |PINDA #0#1;
     |ENDATOS #1#1;
     |SI FSalida = 0;
         |SI FEstado = 0; |GRABA 140#1a; |SINO; |GRABA 140#1n; |FINSI;
     |FINSI;

     |CIERRA #1;

     |POPV;
     |ERROR;
|FPRC;

|PROCESO Tipo66C16Fconce;  |TIPO 66;
     aAlfa = "|C016WID";
     aID   = #0#aAlfa#;
     nID   = aID;

     aTipoIVA = "R";
     |SI #0#2 = "S"; aTipoIVA = "S"; |FINSI;
     |SI #0#2 = "I"; |Y #0#3 = "G"; aTipoIVA = "S"; |FINSI;
     |SI #0#2 = "N"; |Y #0#3 = "G"; aTipoIVA = "S"; |FINSI;

     aPopup1  = nID;  || Si fuera -1 en la posicion
     |SI aTipoIVA = "R";
         aPopup2  = 30;
     |SINO;
         aPopup2  = 27;
     |FINSI;
     aPopup3  = "  Operación habitual";
     aPopup4  = "A Asiento resumen de facturas";
     aPopup5  = "B Asiento resumen de tiques";
     aPopup6  = "C Factura con varios asientos (varios tipo impositivos)";
     aPopup7  = "D Factura rectificativa";
     |SI aTipoIVA = "R";
         aPopup8  = "E IVA devengado pendiente de emitir factura";
         aPopup9  = "G Régimen especial de grupo de entidades en IVA o IGIC";
         aPopup10 = "H Régimen especial de oro de inversión";
         aPopup11 = "I Inversión del Sujeto pasivo (ISP)";
         aPopup12 = "J Tiques";
         aPopup13 = "K Rectificación anotaciones registrales";
         aPopup14 = "M IVA facturado pendiente de devengar (emitida factura)";
         aPopup15 = "N Facturación de las prestaciones de servicios de agencias de viaje que actúan como mediadoras en nombre y por cuenta ajena";
         aPopup16 = "O Factura emitida en sustitución de tiques facturados y declarados.";
         aPopup17 = "Q Operaciones a las que se aplique el régimen especial de bienes usados, ...";
         aPopup18 = "R Operación de arrendamiento de local de negocio.";
         aPopup19 = "S Subvenciones, auxilios o ayudas satisfechas o recibidas, tanto por parte de Administraciones públicas o entidades privadas.";
         aPopup20 = "T Cobros por cuenta de terceros de honorarios profesionales o de derechos derivados ...";
         aPopup21 = "U Operación de seguros.";
         aPopup22 = "V Compras de Agencias viajes: operaciones de prestación de servicios de mediación en nombre y por cuenta ajena relativos ...";
         aPopup23 = "W Operaciones sujetas al Impuesto sobre la Producción, los Servicios y la Importación en las Ciudades de Ceuta y Melilla.";
         aPopup24 = "Z Operaciones en Régimen especial de criterio de caja";
         aPopup25 = "1 IVA criterio de caja. Asiento resumen de facturas";
         aPopup26 = "2 IVA criterio de caja. Factura con varios asientos";
         aPopup27 = "3 IVA criterio de caja. Factura rectificativa";
         aPopup28 = "4 IVA criterio de caja. Adqusiciones realizadas por las agencias de viajes en interés del viajero";
         aPopup29 = "5 IVA criterio de caja. Factura simplificada";
         aPopup30 = "6 IVA criterio de caja. Rectificación de errores registrales";
         aPopup31 = "7 IVA criterio de caja. Facturación de las prestaciones de servicios de agencias de viajes";
         aPopup32 = "8 IVA criterio de caja. Operación de arrendamiento de local de negocio";
     |FINSI;
     |SI aTipoIVA = "S";
         aPopup8  = "F Adquisiciones realizadas por las agencias de viajes directamente en interés del viajero ";
         aPopup9  = "G Régimen especial de grupo de entidades en IVA o IGIC";
         aPopup10 = "H Régimen especial de oro de inversión";
         aPopup11 = "I Inversión del Sujeto pasivo (ISP)";
         aPopup12 = "J Tiques";
         aPopup13 = "K Rectificación anotaciones registrales";
         aPopup14 = "L Adquisiciones a comerciantes minoristas del IGIC";
         aPopup15 = "P Adquisiciones intracomunitarias de bienes.";
         aPopup16 = "Q Operaciones a las que se aplique el régimen especial de bienes usados, ...";
         aPopup17 = "R Operación de arrendamiento de local de negocio.";
         aPopup18 = "S Subvenciones, auxilios o ayudas satisfechas o recibidas, tanto por parte de Administraciones públicas o entidades privadas.";
         aPopup19 = "W Operaciones sujetas al Impuesto sobre la Producción, los Servicios y la Importación en las Ciudades de Ceuta y Melilla.";
         aPopup20 = "X Operaciones por las que los empresarios o profesionales que satisfagan compensaciones agrícolas hayan expedido el recibo";
         aPopup21 = "Z Operaciones en Régimen especial de criterio de caja";
         aPopup22 = "1 IVA criterio de caja. Asiento resumen de facturas";
         aPopup23 = "2 IVA criterio de caja. Factura con varios asientos";
         aPopup24 = "3 IVA criterio de caja. Factura rectificativa";
         aPopup25 = "4 IVA criterio de caja. Adqusiciones realizadas por las agencias de viajes en interés del viajero";
         aPopup26 = "5 IVA criterio de caja. Factura simplificada";
         aPopup27 = "6 IVA criterio de caja. Rectificación de errores registrales";
         aPopup28 = "7 IVA criterio de caja. Facturación de las prestaciones de servicios de agencias de viajes";
         aPopup29 = "8 IVA criterio de caja. Operación de arrendamiento de local de negocio";
     |FINSI;

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 101;  #0#16 = aAlfa;
     |FINSI;

     |PINTA #0#16;
|FPRC;

|PROCESO Tipo0C16Fconce;  |TIPO 0;

     |SI #0#16 = "*";
         |ACABA;
     |FINSI;

     aTipoIVA = "R";
     |SI #0#2 = "S"; aTipoIVA = "S"; |FINSI;
     |SI #0#2 = "I"; |Y #0#3 = "G"; aTipoIVA = "S"; |FINSI;
     |SI #0#2 = "N"; |Y #0#3 = "G"; aTipoIVA = "S"; |FINSI;

     aAlfa = "";
     |SI #0#16 = " "; aAlfa = "Operaci¢n habitual"; |FINSI;
     |SI #0#16 = "A"; aAlfa = "Asiento resumen de facturas"; |FINSI;
     |SI #0#16 = "B"; aAlfa = "Asiento resumen de tiques"; |FINSI;
     |SI #0#16 = "C"; aAlfa = "Factura con varios asientos (varios tipo impositivos)"; |FINSI;
     |SI #0#16 = "D"; aAlfa = "Factura rectificativa"; |FINSI;

     |SI aTipoIVA = "R";
         |SI #0#16 = "E"; aAlfa = "IVA devengado pendiente de emitir factura"; |FINSI;
         |SI #0#16 = "G"; aAlfa = "R‚gimen especial de grupo de entidades en IVA o IGIC"; |FINSI;
         |SI #0#16 = "H"; aAlfa = "R‚gimen especial de oro de inversi¢n"; |FINSI;
         |SI #0#16 = "I"; aAlfa = "Inversi¢n del Sujeto pasivo (ISP)"; |FINSI;
         |SI #0#16 = "J"; aAlfa = "Tiques"; |FINSI;
         |SI #0#16 = "K"; aAlfa = "Rectificación anotaciones registrales"; |FINSI;
         |SI #0#16 = "M"; aAlfa = "IVA facturado pendiente de devengar (emitida factura)"; |FINSI;
         |SI #0#16 = "N"; aAlfa = "Facturaci¢n de las prestaciones de servicios de agencias de viaje que actúan como mediadoras en nombre y por cuenta ajena"; |FINSI;
         |SI #0#16 = "O"; aAlfa = "Factura emitida en sustituci¢n de tiques facturados y declarados."; |FINSI;
         |SI #0#16 = "Q"; aAlfa = "Operaciones a las que se aplique el r‚gimen especial de bienes usados, ..."; |FINSI;
         |SI #0#16 = "R"; aAlfa = "Operaci¢n de arrendamiento de local de negocio."; |FINSI;
         |SI #0#16 = "S"; aAlfa = "Subvenciones, auxilios o ayudas satisfechas o recibidas, tanto por parte de Administraciones públicas o entidades privadas."; |FINSI;
         |SI #0#16 = "T"; aAlfa = "Cobros por cuenta de terceros de honorarios profesionales o de derechos derivados ..."; |FINSI;
         |SI #0#16 = "U"; aAlfa = "Operación de seguros."; |FINSI;
         |SI #0#16 = "V"; aAlfa = "Compras de Agencias viajes: operaciones de prestación de servicios de mediación en nombre y por cuenta ajena relativos ..."; |FINSI;
         |SI #0#16 = "W"; aAlfa = "Operaciones sujetas al Impuesto sobre la Producción, los Servicios y la Importación en las Ciudades de Ceuta y Melilla."; |FINSI;
         |SI #0#16 = "Z"; aAlfa = "Operaciones en Régimen especial de criterio de caja"; |FINSI;
         |SI #0#16 = "1"; aAlfa = "IVA criterio de caja. Asiento resumen de facturas"; |FINSI;
         |SI #0#16 = "2"; aAlfa = "IVA criterio de caja. Factura con varios asientos"; |FINSI;
         |SI #0#16 = "3"; aAlfa = "IVA criterio de caja. Factura rectificativa"; |FINSI;
         |SI #0#16 = "4"; aAlfa = "IVA criterio de caja. Adqusiciones realizadas por las agencias de viajes"; |FINSI;
         |SI #0#16 = "5"; aAlfa = "IVA criterio de caja. Factura simplificada"; |FINSI;
         |SI #0#16 = "6"; aAlfa = "IVA criterio de caja. Rectificaci¢n de errores registrales"; |FINSI;
         |SI #0#16 = "7"; aAlfa = "IVA criterio de caja. Facturaci¢n de las prestaciones servicios agencias viajes"; |FINSI;
         |SI #0#16 = "8"; aAlfa = "IVA criterio de caja. Operaci¢n de arrendamiento de local de negocio"; |FINSI;
     |FINSI;

     |SI aTipoIVA = "S";
         |SI #0#16 = "F"; aAlfa = "Adquisiciones realizadas por las agencias de viajes directamente en inter‚s del viajero"; |FINSI;
         |SI #0#16 = "G"; aAlfa = "R‚gimen especial de grupo de entidades en IVA o IGIC"; |FINSI;
         |SI #0#16 = "H"; aAlfa = "R‚gimen especial de oro de inversi¢n"; |FINSI;
         |SI #0#16 = "I"; aAlfa = "Inversi¢n del Sujeto pasivo (ISP)"; |FINSI;
         |SI #0#16 = "J"; aAlfa = "Tiques"; |FINSI;
         |SI #0#16 = "K"; aAlfa = "Rectificación anotaciones registrales"; |FINSI;
         |SI #0#16 = "L"; aAlfa = "Adquisiciones a comerciantes minoristas del IGIC"; |FINSI;
         |SI #0#16 = "P"; aAlfa = "Adquisiciones intracomunitarias de bienes."; |FINSI;
         |SI #0#16 = "Q"; aAlfa = "Operaciones a las que se aplique el r‚gimen especial de bienes usados, ..."; |FINSI;
         |SI #0#16 = "R"; aAlfa = "Operaci¢n de arrendamiento de local de negocio."; |FINSI;
         |SI #0#16 = "S"; aAlfa = "Subvenciones, auxilios o ayudas satisfechas o recibidas, tanto por parte de Administraciones públicas o entidades privadas."; |FINSI;
         |SI #0#16 = "W"; aAlfa = "Operaciones sujetas al Impuesto sobre la Producción, los Servicios y la Importación en las Ciudades de Ceuta y Melilla."; |FINSI;
         |SI #0#16 = "X"; aAlfa = "Operaciones por las que los empresarios o profesionales que satisfagan compensaciones agrícolas hayan expedido el recibo"; |FINSI;
         |SI #0#16 = "Z"; aAlfa = "Operaciones en Régimen especial de criterio de caja"; |FINSI;
         |SI #0#16 = "1"; aAlfa = "IVA criterio de caja. Asiento resumen de facturas"; |FINSI;
         |SI #0#16 = "2"; aAlfa = "IVA criterio de caja. Factura con varios asientos"; |FINSI;
         |SI #0#16 = "3"; aAlfa = "IVA criterio de caja. Factura rectificativa";|FINSI;
         |SI #0#16 = "4"; aAlfa = "IVA criterio de caja. Adqusiciones realizadas por las agencias de viajes"; |FINSI;
         |SI #0#16 = "5"; aAlfa = "IVA criterio de caja. Factura simplificada"; |FINSI;
         |SI #0#16 = "6"; aAlfa = "IVA criterio de caja. Rectificaci¢n de errores registrales"; |FINSI;
         |SI #0#16 = "7"; aAlfa = "IVA criterio de caja. Facturaci¢n de las prestaciones servicios agencias viajes"; |FINSI;
         |SI #0#16 = "8"; aAlfa = "IVA criterio de caja. Operaci¢n de arrendamiento de local de negocio"; |FINSI;
    |FINSI;

    |SI aAlfa = "";
        |MENAV "0000 Clave de operacion 340 incorrecta";
        |ERROR;
    |FINSI;
|FPRC;
