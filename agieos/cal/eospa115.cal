|FICHEROS;
   eospa115 #0;
   eosm0043 #1;
   eosm0042 #2;
   eosm0041 #3;
   eosm0040 #8;

   eosw0091 #4; || Mantenimiento 115
   eosw0092 #5; || Lineas mantenimiento 115

   eosclien #6;
   eosclpre #7;
|FIN;

|VARIABLES;
   Comodin = "";

   SwPase = 0;
   nNume  = 0;
|FIN;

|PROCESO PasandoLin;

   #eosclpre#0 = #eosw0092#0;
   #eosclpre#1 = #eosw0092#4;
   #eosclpre#2 = "2";
   |LEE 010#eosclpre.=;
   |SI FSalida = 0;
      #eosm0041#0 = #eosw0092#0;
      |SI #eosw0092#1 ] 80;
         nNume = 1900 + #eosw0092#1;
      |SINO;
         nNume = 2000 + #eosw0092#1;
      |FINSI;
      #eosm0041#1 = nNume;
      #eosm0041#2 = #eosclpre#3;
      |LEE 010#eosm0041.=;
      |SI FSalida ! 0;
         |DDEFECTO #eosm0041;
         #eosm0041#0 = #eosw0092#0;
         #eosm0041#1 = nNume;
         #eosm0041#2 = #eosclpre#3;
         #eosm0041#3 = #eosclpre#4;
         |GRABA 020#eosm0041.n;
         |LEE 010#eosm0041.=;
      |FINSI;
   |FINSI;

   #eosm0042#0 = #eosm0041#0;
   #eosm0042#1 = #eosm0041#1;
   #eosm0042#2 = #eosm0041#2;
   #eosm0042#9 = #eosw0092#2;
   |LEE 010#eosm0042.=;
   |SI FSalida ! 0;
      |DDEFECTO #eosm0042;
      #eosm0042#0 = #eosm0041#0;
      #eosm0042#1 = #eosm0041#1;
      #eosm0042#2 = #eosm0041#2;
      #eosm0042#9 = #eosw0092#2;
      |GRABA 020#eosm0042.b;
   |FINSI;

   |SI #eosw0092#8 = "D";
      #eosm0042#3 = #eosm0042#3 + #eosw0092#6;
      #eosm0042#5 = #eosm0042#5 + #eosw0092#7;
      #eosm0042#4 = (#eosm0042#5 * 100) / #eosm0042#3;
   |FINSI;

   |SI #eosw0092#8 = "E";
      #eosm0042#6 = #eosm0042#6 + #eosw0092#6;
      #eosm0042#8 = #eosm0042#8 + #eosw0092#7;
      #eosm0042#7 = (#eosm0042#8 * 100) / #eosm0042#6;
   |FINSI;

   |GRABA 020#eosm0042.a;
   |LIBERA #eosm0042;

|FPRC;

|DEFBUCLE PasandoLin;
#eosw0092#1;
;
#eosw0091#0,#eosw0091#1,#eosw0091#2,001;
#eosw0091#0,#eosw0091#1,#eosw0091#2,999;
;
NULL,PasandoLin;
|FIN;

|PROCESO Pasando;
   #eosm0040#0 = #eosw0091#0;
   #eosm0040#1 = #eosw0091#1;
   |SI #eosw0091#1 ] 80;
       nNume = 1900 +  #eosw0091#1;
   |SINO;
       nNume = 2000 +  #eosw0091#1;
   |FINSI;
   #eosm0040#1 = nNume;
   |LEE 010#eosm0040.=;
   |SI FSalida ! 0;
      |DDEFECTO #eosm0040;
      #eosm0040#0 = #eosw0091#0;
      #eosm0040#1 = nNume;
      |GRABA 020#eosm0040.b;
   |FINSI;

   #eosm0040#2  = #eosw0091#12;
   #eosm0040#14 = #eosw0091#17;
   |GRABA 020#eosm0040.a;
   |LIBERA #eosm0040;

   #eosm0043#0 = #eosw0091#0;
   #eosm0043#1 = #eosw0091#1;
   #eosm0043#2 = #eosw0091#3;
   |LEE 010#eosm0043.=;
   |SI FSalida ! 0;
      |DDEFECTO #eosm0043;
      #eosm0043#0 = #eosw0091#0;
      #eosm0043#1 = #eosw0091#1;
      #eosm0043#2 = #eosw0091#3;
      |GRABA 020#eosm0043.b;
   |FINSI;
   #eosm0043#6 = #eosw0091#3;
   #eosm0043#7 = #eosw0091#4;
   #eosm0043#8 = #eosw0091#5;
   #eosm0043#9 = #eosw0091#6;
   #eosm0043#10 = #eosw0091#7;
   #eosm0043#11 = #eosw0091#8;
   #eosm0043#12 = #eosw0091#9;
   |GRABA 020#eosm0043.a;

   |LIBERA #eosm0043;

   SwPase = 1;

   |BUCLE PasandoLin;
|FPRC;

|DEFBUCLE Pasando;
#eosw0091#1;
;
00001,00,01;
99999,99,12;
;
NULL,Pasando;
|FIN;

|PROGRAMA;
   |CLS;

   |CABEZA " Pase modelo 115 externo ";

   |PINPA #0#0;
   |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida ! 0; |ACABA; |FINSI;

   |SI #0#1 = "N"; |ACABA; |FINSI;

   SwPase = 0;
   |ABRE #eosm0043;
   |ABRE #eosm0042;
   |ABRE #eosm0041;
   |ABRE #eosm0040;
   |ABRE #eosclpre;
   Comodin = #0#0;
   |PATH_DAT #4 Comodin;
   |PATH_DAT #5 Comodin;
   Comodin = "eosma115";
   |NOME_DAT #4 Comodin;
   Comodin = "eosml115";
   |NOME_DAT #5 Comodin;
   |ABRE #eosw0091;
   |ABRE #eosw0092;
   |SI FSalida ! 0;
      |MENAV "    Problemas al abrir el fichero externo";
      |ACABA;
   |FINSI;
   |ABRE #eosclien;
   |BUCLE Pasando;
   |CIERRA #eosclien;
   |SI SwPase = 0;
      |MENAV "    No se han pasado datos";
   |FINSI;
   |CIERRA #eosclpre;
   |CIERRA #eosm0040;
   |CIERRA #eosm0041;
   |CIERRA #eosm0042;
   |CIERRA #eosm0043;
   |CIERRA #eosw0091;
   |CIERRA #eosw0092;
|FPRO;
