|FICHEROS;
     dsmow222;
     dsm30304;

     :/agicli/def/agim0135;
     eosactiv;
|FIN;

|VARIABLES;
     aAlfa               = "";
     nAgicli             = 0;
     aBase               = "";
     nCanal              = 0;

     &enEjer             = 0;
     &enEmpresa          = 0;
     &enModelo           = 0;
     &enComplem          = 0;
|FIN;

|PROCESO T12w222;  |TIPO 12;
     |SI FSalida = 7;
         |ACABA;
     |FINSI;

     |SI FSalida = 1;
         |SI  #dsmow222#2 = "    "; |Y #dsmow222#6 ! 100; |Y #dsmow222#6 ! 0;
              |MENAV "    Error. Informe CNAE de la Actividad";

              |POSICIONATE #dsmow222#2;
              |ERROR;
         |FINSI;

         |ACABA;
     |FINSI;

     |POSICIONATE #dsmow222#1;
     |ERROR;
|FPRC;

|PROCESO T0C6w222;
      |PTEC 808;
      |PTEC 808;
      |PTEC 808;
      |PTEC 808;
|FPRC;

|PROCESO T66C2w222;  |TIPO 66;
      |SI nAgicli = 0; |ACABA; |FINSI;

      |ABRE #agim0135;
      |DDEFECTO #agim0135;
      #agim0135#0 = #dsmow222#2;
      |LEE 000#agim0135.=;

      |CONSULTA_CLAVE #1#agim0135;
      |SI FSalida = 0;
          #dsmow222#2 = #agim0135#0;
      |FINSI;

      |CIERRA #agim0135;

      |PINTA #dsmow222#2;
|FPRC;

|PROCESO T0C0w222; |TIPO 0;
     |C_M #dsmow222#0, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     #dsm30304#0  = enEmpresa;
     #dsm30304#1  = enEjer;
     #dsm30304#2  = enModelo;
     #dsm30304#3  = enComplem;
     #dsm30304#4  = #dsmow222#0;
     |LEE 000#dsm30304.=;
     |SI FSalida = 0;
         |MENAV "0000La actividad ya est  introducida.";
         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #eosactiv;
     #eosactiv#0 = enEmpresa;
     #eosactiv#1 = #dsmow222#0;
     #eosactiv#2 = enEjer - 2000;
     |LEE 000#eosactiv.=;
     |SI FSalida ! 0;
         |CIERRA #eosactiv;
         |MENAV "0000No existe la actividad";
         |ERROR;
         |ACABA;
     |FINSI;
     |CIERRA #eosactiv;

     #dsmow222#1 = #eosactiv#6;  |PINTA #dsmow222#1;
     #dsmow222#2 = #eosactiv#8;  |PINTA #dsmow222#2;
|FPRC;

|PROCESO infAct;
      #eosactiv#0 = enEmpresa;
      #eosactiv#1 = 01;
      #eosactiv#2 = enEjer - 2000;
|FPRC;

|PROCESO supAct;
      #eosactiv#0 = enEmpresa;
      #eosactiv#1 = 99;
      #eosactiv#2 = enEjer - 2000;
|FPRC;

|PROCESO T66C0w222;  |TIPO 66;
      |ABRE #eosactiv;
      #eosactiv#0 = enEmpresa;
      #eosactiv#1 = #dsmow222#0;
      #eosactiv#2 = enEjer - 2000;
      |LEE 000#eosactiv.=;

      |CONSULTA_F_CLAVE #4#eosactiv,infAct, supAct;
      |SI FSalida = 0;
          #dsmow222#0 = #eosactiv#1;
      |FINSI;

      |CIERRA #eosactiv;
      |PINTA #dsmow222#0;
|FPRC;

|PROCESO T80w222;  |TIPO 80;
     nAgicli = 0;
     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "agicli/def/agim0135.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
         nAgicli = 1;
         || Activado
         |MODO_RELACION #dsmow222, 0, "agim0135", "X", "X";
         |MODO_RELACION #dsmow222, 1, "agim0135", "N", "N";
     |SINO;
         ||Desactivado
         |MODO_RELACION #dsmow222, 1, "agim0135", "N", "N";
         |MODO_RELACION #dsmow222, 1, "agim0135", "X", "X";
     |FINSI;
|FPRC;
