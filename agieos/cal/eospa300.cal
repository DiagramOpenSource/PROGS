|FICHEROS;
   eospa300 #0;
   eosclien #1;
   eosactiv #4;
   eoslinco #5;
   eoslinve #7;
   eosconce #8;
   eosaplic #9;
   eosopesp #10;
   eoscabco #11;
   eoscabve #12;
   eoscapro #17;
   eosaggan #18;
   eosagga1 #19;
   eosm1300 #25;
   eosconc6 #28;
|FIN;

|VARIABLES;
   d_empre  = 0;
   d_activ  = 0;
   FEstado  = 0;
   fichero  = "";
   anyocab  = "";
   Concep2  = 0;
   Concep6  = "";
   iva      = 0;
   tiva     = 0;
   rec      = 0;
   trec     = 0;
   base     = 0;
   FEact    = 0;
   rendi1   = 0;
   rendi2   = 0;
   penult   = 0;
   estado   = 0;
   ventas   = 0;
   x        = 0;
   camp     = 0;
   total    = 0;
   activida = 0;
   varalf   = "";
   fec1     = @;
   fec2     = @;
   tri1     = 0;
   tri2     = 0;
   anio     = "";
   perante  = 0;
   anoante  = 0;
   empresa  = 0;
   anyo     = 0;
   periodo  = 0;
   n        = "N";
   b_anter  = 0;
   p_anter  = 0;
   r_anter  = 0;
   ventas_con = 0;
   ventas_sin = 0;
   t_compra1  = 0;
   t_compra2  = 0;
   t_compra3  = 0;
   t_compra8  = 0;
   t_compra4  = 0;
   t_compra5  = 0;
   t_compra6  = 0;
   t_compra7  = 0;
   p_compra1  = 0;
   p_compra2  = 0;
   p_compra3  = 0;
   p_compra4  = 0;
   p_compra5  = 0;
   p_compra6  = 0;
   p_compra7  = 0;
   p_compra8  = 0;
   prorrata   = 0;

   epig1_1    = "";
   epig2_1    = "";
   epig3_1    = 0;
   epig1_2    = "";
   epig2_2    = "";
   epig3_2    = 0;
   epig1_3    = "";
   epig2_3    = "";
   epig3_3    = 0;
   epig1_4    = "";
   epig2_4    = "";
   epig3_4    = 0;
   epig1_5    = "";
   epig2_5    = "";
   epig3_5    = 0;
   rdtos_1    = 0;
   rdtos_2    = 0;
   rdtos_3    = 0;
   rdtos_4    = 0;
   rdtos_5    = 0;
   sw_330     = 0;
   xxx        = 0;
   yyy        = 0;
   zzz        = 0;
   epig1      = "";
   epig2      = "";
   compensar  = 0;
   FEstado_Op = 0;

   Campo1     = 0;
   Campo2     = 0;
   Campo3     = 0;
   Campo4     = 0;
   Campo5     = 0;
   Campo6     = 0;
   Campo7     = 0;
   Campo8     = 0;
   VCampo1    = 0;
   VCampo2    = "";
   VCampo3    = "";
   VCampo5    = 0;
   VCampo6    = 0;
   VCampo7    = 0;
   VCampo8    = 0;
   SwEstar    = 0;
   Total      = 0;
   LaEmpresa  = 0;
   ElPeriodo  = 0;
   ElAnyo     = 0;
   Compensar  = 0;
   nSuma      = 0;
   nPeriodo   = 0;
|FIN;


|INCLUYE i_seguim;
|INCLUYE i_anyode;
|INCLUYE i_devolv;
|INCLUYE i_consul;

|PROCESO pinta_anyo; |TIPO 7;
|HAZ i_anyodef;
#0#2 = i_anyodef;
|PINTA #0#2;
|FPRC;

|| **************************************************************************
||                         Borramos el 300 Seleccionado
|| **************************************************************************

|PROCESO borrar;
|BORRA 020#25c;
|LIBERA #25;

#10#0 = #25#0;
#10#1 = #25#45;
#10#2 = #25#1;
#10#3 = #25#2;
|BORRA 140#10c;
|LIBERA #10;
|FPRC;

|DEFBUCLE baja300;
#25#1;
;
#0#0, 1, #0#3, #0#2;
#0#1, 6, #0#3, #0#2;
be;
NULL,borrar;
|FIN;

|PROCESO BorraVariables;
     ventas_con = 0;
     ventas_sin = 0;
     epig1_1    = "";
     epig2_1    = "";
     epig1_2    = "";
     epig2_2    = "";
     epig1_3    = "";
     epig2_3    = "";
     epig1_4    = "";
     epig2_4    = "";
     epig1_5    = "";
     epig2_5    = "";
     rdtos_1    = 0;
     rdtos_2    = 0;
     rdtos_3    = 0;
     rdtos_4    = 0;
     rdtos_5    = 0;
|FPRC;

|| **************************************************************************
||                              Pasamos las Compras
|| **************************************************************************
|PROCESO ConcepCompra;
|SI #4#50 = 1;
    #8#0 = Concep2;
    |LEE 040#8=;
    |SI FSalida ! 0; |ACABA; |FINSI;

    |SI #8#2 = "I";|O #8#2 = "i";|O #8#2 = "S";|O #8#2 = "s";
        |SI #8#6 = "S";  |Y #0#6 = 2;
            #25#59 = #9#13;
            #25#62 = #9#14;
            #25#65 = #9#15;

            |SI tiva = #9#13; #25#58 = #25#58 + base; #25#60 = #25#60 + iva; |FINSI;
            |SI tiva = #9#14; #25#61 = #25#61 + base; #25#63 = #25#63 + iva; |FINSI;
            |SI tiva = #9#15; #25#64 = #25#64 + base; #25#66 = #25#66 + iva; |FINSI;

            #25#49 = #25#58 + #25#61 + #25#64;
            #25#50 = #25#60 + #25#63 + #25#66;
            #25#51 = #25#50;
        |SINO;
            |SI #4#28 ! 0;
                |SI #8#8 = 1;
                    #25#70 = #25#70 + (base % #4#28);
                    #25#21 = #25#21 + ((iva + rec) % #4#28);
                |FINSI;
                |SI #8#8 = 2;
                    #25#71 = #25#71 + (base % #4#28);
                    #25#22 = #25#22 + ((iva + rec) % #4#28);
                |FINSI;
                |SI #8#8 = 3;
                    #25#73 = #25#73 + (base % #4#28);
                    #25#23 = #25#23 + ((iva + rec) % #4#28);
                |FINSI;
                |SI #8#8 = 4;
                    #25#75 = #25#75 + (base % #4#28);
                    #25#43 = #25#43 + ((iva + rec) % #4#28);
                |FINSI;
                |SI #8#8 = 5;
                    #25#76 = #25#76 + (base % #4#28);
                    #25#44 = #25#44 + ((iva + rec) % #4#28);
                |FINSI;
                |SI #8#8 = 6;
                    #25#72 = #25#72 + base;
                    #25#51 = #25#51 + ((iva + rec) % #4#28);
                |FINSI;
                |SI #8#8 = 8;
                    #25#77 = #25#77 + base;
                    #25#78 = #25#78 + ((iva + rec) % #4#28);
                |FINSI;
                |SI #8#8 = 7;
                    #25#74 = #25#74 + base;
                    #25#24 = #25#24 + iva + rec;
                |FINSI;
            |SINO;
                |SI #8#8 = 1; #25#70 = #25#70 + base; |FINSI;
                |SI #8#8 = 2; #25#71 = #25#71 + base; |FINSI;
                |SI #8#8 = 3; #25#73 = #25#73 + base; |FINSI;
                |SI #8#8 = 4; #25#75 = #25#75 + base; |FINSI;
                |SI #8#8 = 5; #25#76 = #25#76 + base; |FINSI;
                |SI #8#8 = 6; #25#72 = #25#72 + base; |FINSI;
                |SI #8#8 = 8; #25#77 = #25#77 + base; |FINSI;
                |SI #8#8 = 7; #25#74 = #25#74 + base; |FINSI;

                |SI #8#8 = 1; #25#21 = #25#21 + (iva + rec); |FINSI;
                |SI #8#8 = 2; #25#22 = #25#22 + (iva + rec); |FINSI;
                |SI #8#8 = 3; #25#23 = #25#23 + (iva + rec); |FINSI;
                |SI #8#8 = 4; #25#43 = #25#43 + (iva + rec); |FINSI;
                |SI #8#8 = 5; #25#44 = #25#44 + (iva + rec); |FINSI;
                |SI #8#8 = 6; #25#51 = #25#51 + (iva + rec); |FINSI;
                |SI #8#8 = 8; #25#78 = #25#78 + (iva + rec); |FINSI;
                |SI #8#8 = 7; #25#24 = #25#24 + (iva + rec); |FINSI;
            |FINSI;
        |FINSI;
   |FINSI;
|SINO;
    #28#0 = Concep6;
    |LEE 040#28=;
    |SI FSalida ! 0; |ACABA; |FINSI;

    |SI #28#2 = "I";|O #28#2 = "i";|O #28#2 = "S";|O #28#2 = "s";
        |SI #28#6 = "S";  |Y #0#6 = 2;
            #25#59 = #9#13;
            #25#62 = #9#14;
            #25#65 = #9#15;

            |SI tiva = #9#13; #25#58 = #25#58 + base; #25#60 = #25#60 + iva; |FINSI;
            |SI tiva = #9#14; #25#61 = #25#61 + base; #25#63 = #25#63 + iva; |FINSI;
            |SI tiva = #9#15; #25#64 = #25#64 + base; #25#66 = #25#66 + iva; |FINSI;

            #25#49 = #25#58 + #25#61 + #25#64;
            #25#50 = #25#60 + #25#63 + #25#66;
            #25#51 = #25#50;
        |SINO;
            |SI #4#28 ! 0;
                |SI #28#8 = 1;
                    #25#70 = #25#70 + (base % #4#28);
                    #25#21 = #25#21 + ((iva + rec) % #4#28);
                |FINSI;
                |SI #28#8 = 2;
                    #25#71 = #25#71 + (base % #4#28);
                    #25#22 = #25#22 + ((iva + rec) % #4#28);
                |FINSI;
                |SI #28#8 = 3;
                    #25#73 = #25#73 + (base % #4#28);
                    #25#23 = #25#23 + ((iva + rec) % #4#28);
                |FINSI;
                |SI #28#8 = 4;
                    #25#75 = #25#75 + (base % #4#28);
                    #25#43 = #25#43 + ((iva + rec) % #4#28);
                |FINSI;
                |SI #28#8 = 5;
                    #25#76 = #25#76 + (base % #4#28);
                    #25#44 = #25#44 + ((iva + rec) % #4#28);
                |FINSI;
                |SI #28#8 = 6;
                    #25#72 = #25#72 + base;
                    #25#51 = #25#51 + ((iva + rec) % #4#28);
               |FINSI;
                |SI #28#8 = 8;
                    #25#77 = #25#77 + base;
                    #25#78 = #25#78 + ((iva + rec) % #4#28);
               |FINSI;
                |SI #28#8 = 7;
                    #25#74 = #25#74 + base;
                    #25#24 = #25#24 + iva + rec;
               |FINSI;
            |SINO;
                |SI #28#8 = 1; #25#70 = #25#70 + base; |FINSI;
                |SI #28#8 = 2; #25#71 = #25#71 + base; |FINSI;
                |SI #28#8 = 3; #25#73 = #25#73 + base; |FINSI;
                |SI #28#8 = 4; #25#75 = #25#75 + base; |FINSI;
                |SI #28#8 = 5; #25#76 = #25#76 + base; |FINSI;
                |SI #28#8 = 6; #25#72 = #25#72 + base; |FINSI;
                |SI #28#8 = 8; #25#77 = #25#77 + base; |FINSI;
                |SI #28#8 = 7; #25#74 = #25#74 + base; |FINSI;

                |SI #28#8 = 1; #25#21 = #25#21 + (iva + rec); |FINSI;
                |SI #28#8 = 2; #25#22 = #25#22 + (iva + rec); |FINSI;
                |SI #28#8 = 3; #25#23 = #25#23 + (iva + rec); |FINSI;
                |SI #28#8 = 4; #25#43 = #25#43 + (iva + rec); |FINSI;
                |SI #28#8 = 5; #25#44 = #25#44 + (iva + rec); |FINSI;
                |SI #28#8 = 6; #25#51 = #25#51 + (iva + rec); |FINSI;
                |SI #28#8 = 8; #25#78 = #25#78 + (iva + rec); |FINSI;
                |SI #28#8 = 7; #25#24 = #25#24 + (iva + rec); |FINSI;
           |FINSI;
        |FINSI;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO Compras;
|ABRE #4;
#4#0 = #5#0;
#4#1 = #5#19;
#4#2 = #0#2;
|LIBERA #4;
|LEE 040#4=;
|SI FSalida ! 0; |DDEFECTO #4; |FINSI;
|CIERRA #4;

|SI #4#26 ! "F";
    |ABRE #19;
    #19#0 = #4#4;
    #19#1 = #4#5;
    |LEE 040#19=;
    |SI FSalida = 0;  |ACABA;  |FINSI;
    |CIERRA #19;
|FINSI;

|SI #4#22 = "A"; |ACABA; |FINSI;
|SI #4#26 = "N"; |ACABA; |FINSI;

d_empre = #5#0;
d_activ = #5#19;

#25#0 = #5#0; #25#1 = #0#3; #25#2 = #0#2; #25#45 = #5#19;
|HAZ compensar;

#25#0 = #5#0; #25#1 = #0#3; #25#2 = #0#2; #25#45 = #5#19;
|LIBERA #25; |LEE 110#25=;
estado = FSalida;
|SI estado ! 0; |DDEFECTO #25; |FINSI;

|SI #25#4 = "S"; |ACABA; |FINSI;

#25#0 = #5#0; #25#1 = #0#3; #25#2 = #0#2; #25#45 = #5#19;
Concep2 = #5#5;  Concep6 = #5#72; base = #5#7;  iva = #5#9;  rec = #5#11; tiva = #5#8;  |HAZ ConcepCompra;
Concep2 = #5#33; Concep6 = #5#73; base = #5#23; iva = #5#27; rec = #5#31; tiva = #5#25; |HAZ ConcepCompra;
Concep2 = #5#34; Concep6 = #5#74; base = #5#24; iva = #5#28; rec = #5#32; tiva = #5#26; |HAZ ConcepCompra;

#25#20 = #25#7 + #25#10 + #25#13 + #25#16 + #25#19 + #25#48 + #25#50;
#25#25 = #25#21 + #25#22 + #25#23 + #25#43 + #25#44 + #25#51 + #25#78 + #25#80;
#25#26 = #25#20 - #25#25;
#25#27 = 100;
#25#28 = #25#26 % #25#27;
#25#29 = perante;
total = #25#28 - #25#29;
|SI total = 0; #25#33 = 0; #25#32 = 0; #25#31 = 0; |FINSI;

|SI total > 0; #25#33 = total; #25#32 = 0; #25#31 = 0; |FINSI;

|SI total < 0;|Y #0#3 ! 4;
    #25#32 = total * (-1);
    #25#31 = 0;
    #25#33 = 0;
|FINSI;

|SI total < 0; |Y #0#3 = 4;
    |SI #4#27 = "D";
        #25#31 = total * (-1);
        #25#32 = 0;
        #25#33 = 0;
    |SINO;
        #25#32 = total * (-1);
        #25#31 = 0;
        #25#33 = 0;
    |FINSI;
|FINSI;
|SI estado ! 0; |GRABA 020#25n; |SINO; |GRABA 020#25a; |FINSI;
#5#18 = "S";
|GRABA 020#5a;
|LIBERA #5;

|SI #25#1 = 4; |HAZ grabacomp; |FINSI;
|FPRC;

|DEFBUCLE lineacomp;
#5#2;
;
#11#0, #11#4, tri1, 1, fec1, 00001;
#11#0, #11#4, tri2, 6, fec2, 32000;
be;
NULL, Compras;
|FIN;


|PROCESO cabecomp;
     fichero = #11#0;
     fichero = "00000" + fichero;
     fichero = fichero % -105;
     anyocab = #11#4;
     anyocab = "00" + anyocab;
     anyocab = anyocab % -102;
     fichero = "c" + fichero + anyocab;
     |NOME_DAT #5fichero;

     |BUCLE lineacomp;
|FPRC;

|DEFBUCLE pasacomp;
#11#1;
;
#0#0, #0#2;
#0#1, #0#2;
e;
NULL,cabecomp;
|FIN;


|| **************************************************************************
||                               Pasamos las Ventas
|| **************************************************************************

|PROCESO ConcepVenta;
|SI #4#50 = 1;
    #8#0 = Concep2;
    |LEE 040#8=;
    |SI FSalida = 0;
        |SI #8#2 = "R";|O #8#2 = "r";|O #8#2 = "I";|O #8#2 = "i";
            |SI #8#6 = "E";
                #25#54 = #25#54 + base;
            |SINO;
                |SI #8#6 = "S";
                    |SI #0#6 = 1;
                        #25#59 = #9#13;
                        #25#62 = #9#14;
                        #25#65 = #9#15;

                        |SI tiva = #9#13; #25#58 = #25#58 + base; #25#60 = #25#60 + iva; |FINSI;
                        |SI tiva = #9#14; #25#61 = #25#61 + base; #25#63 = #25#63 + iva; |FINSI;
                        |SI tiva = #9#15; #25#64 = #25#64 + base; #25#66 = #25#66 + iva; |FINSI;

                        #25#49 = #25#58 + #25#61 + #25#64;
                        #25#50 = #25#60 + #25#63 + #25#66;
                        #25#51 = #25#50;
                     |FINSI;
                |SINO;
                    #25#6  = #9#1;
                    #25#9  = #9#2;
                    #25#12 = #9#3;

                    #25#15 = #9#4;
                    #25#18 = #9#5;
                    #25#47 = #9#6;

                    |SI tiva = #9#1; #25#5  = #25#5  + base; #25#7  = #25#7  + iva; |FINSI;
                    |SI tiva = #9#2; #25#8  = #25#8  + base; #25#10 = #25#10 + iva; |FINSI;
                    |SI tiva = #9#3; #25#11 = #25#11 + base; #25#13 = #25#13 + iva; |FINSI;

                    |SI trec = #9#4; #25#14 = #25#14 + base; #25#16 = #25#16 + rec; |FINSI;
                    |SI trec = #9#5; #25#17 = #25#17 + base; #25#19 = #25#19 + rec; |FINSI;
                    |SI trec = #9#6; #25#46 = #25#46 + base; #25#48 = #25#48 + rec; |FINSI;
                |FINSI;
            |FINSI;
            |HAZ OperEspe2;
        |FINSI;
    |FINSI;
|SINO;
    #28#0 = Concep6;
    |LEE 040#28=;
    |SI FSalida = 0;
        |SI #28#2 = "R";|O #28#2 = "r";|O #28#2 = "I";|O #28#2 = "i";
            |SI #28#6 = "E";
                #25#54 = #25#54 + base;
            |SINO;
                |SI #28#6 = "S";
                    |SI #0#6 = 1;
                        #25#59 = #9#13;
                        #25#62 = #9#14;
                        #25#65 = #9#15;

                        |SI tiva = #9#13; #25#58 = #25#58 + base; #25#60 = #25#60 + iva; |FINSI;
                        |SI tiva = #9#14; #25#61 = #25#61 + base; #25#63 = #25#63 + iva; |FINSI;
                        |SI tiva = #9#15; #25#64 = #25#64 + base; #25#66 = #25#66 + iva; |FINSI;

                        #25#49 = #25#58 + #25#61 + #25#64;
                        #25#50 = #25#60 + #25#63 + #25#66;
                        #25#51 = #25#50;
                     |FINSI;
                |SINO;
                    #25#6  = #9#1;
                    #25#9  = #9#2;
                    #25#12 = #9#3;
                    #25#15 = #9#4;
                    #25#18 = #9#5;
                    #25#47 = #9#6;

                    |SI tiva = #9#1; #25#5  = #25#5  + base; #25#7  = #25#7  + iva; |FINSI;
                    |SI tiva = #9#2; #25#8  = #25#8  + base; #25#10 = #25#10 + iva; |FINSI;
                    |SI tiva = #9#3; #25#11 = #25#11 + base; #25#13 = #25#13 + iva; |FINSI;

                    |SI trec = #9#4; #25#14 = #25#14 + base; #25#16 = #25#16 + rec; |FINSI;
                    |SI trec = #9#5; #25#17 = #25#17 + base; #25#19 = #25#19 + rec; |FINSI;
                    |SI trec = #9#6; #25#46 = #25#46 + base; #25#48 = #25#48 + rec; |FINSI;
                |FINSI;
            |FINSI;
            |HAZ OperEspe6;
        |FINSI;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO OperEspe2;
|ABRE #10;
#10#0 = #25#0;
#10#1 = #25#45;
#10#2 = #25#1;
#10#3 = #25#2;
|LIBERA #10;
|LEE 140#10=;
FEstado_Op = FSalida;
|SI FSalida ! 0; |CDEFECTO #10, 1; |FINSI;

|SI #8#8 = 0;  #10#04 = #10#04 + base; |FINSI;
|SI #8#8 = 1;  #10#07 = #10#07 + base; |FINSI;
|SI #8#8 = 2;  #10#08 = #10#08 + base; |FINSI;
|SI #8#8 = 3;  #10#09 = #10#09 + base; |FINSI;
|SI #8#8 = 4;  #10#05 = #10#05 + base; |FINSI;
|SI #8#8 = 5;  #10#06 = #10#06 + base; |FINSI;
|SI #8#8 = 6;  #10#10 = #10#10 + base; |FINSI;
|SI #8#8 = 7;  #10#11 = #10#11 + base; |FINSI;
|SI #8#8 = 8;  #10#12 = #10#12 + base; |FINSI;
|SI #8#8 = 9;  #10#13 = #10#13 + base; |FINSI;
|SI #8#8 = 10; #10#15 = #10#15 + base; |FINSI;
|SI #8#8 = 11; #10#16 = #10#16 + base; |FINSI;

#10#07 = #25#54;
#10#12 = #25#49;

|SI FEstado_Op = 0; |GRABA 140#10a; |SINO; |GRABA 140#10n; |FINSI;
|CIERRA #10;
|FPRC;

|PROCESO OperEspe6;
|ABRE #10;
#10#0 = #25#0;
#10#1 = #25#45;
#10#2 = #25#1;
#10#3 = #25#2;
|LIBERA #10;
|LEE 140#10=;
FEstado_Op = FSalida;
|SI FSalida ! 0; |CDEFECTO #10, 1; |FINSI;

|SI #28#8 = 0;  #10#04 = #10#04 + base; |FINSI;
|SI #28#8 = 1;  #10#07 = #10#07 + base; |FINSI;
|SI #28#8 = 2;  #10#08 = #10#08 + base; |FINSI;
|SI #28#8 = 3;  #10#09 = #10#09 + base; |FINSI;
|SI #28#8 = 4;  #10#05 = #10#05 + base; |FINSI;
|SI #28#8 = 5;  #10#06 = #10#06 + base; |FINSI;
|SI #28#8 = 6;  #10#10 = #10#10 + base; |FINSI;
|SI #28#8 = 7;  #10#11 = #10#11 + base; |FINSI;
|SI #28#8 = 8;  #10#12 = #10#12 + base; |FINSI;
|SI #28#8 = 9;  #10#13 = #10#13 + base; |FINSI;
|SI #28#8 = 10; #10#15 = #10#15 + base; |FINSI;
|SI #28#8 = 11; #10#16 = #10#16 + base; |FINSI;

#10#07 = #25#54;
#10#12 = #25#49;

|SI FEstado_Op = 0; |GRABA 140#10a; |SINO; |GRABA 140#10n; |FINSI;
|CIERRA #10;
|FPRC;

|PROCESO ConcepVenta_2;
|SI #4#50 = 1;
    #8#0 = Concep2;
    |LEE 040#8=;
    |SI FSalida = 0;
        |SI #8#2 = "R";|O #8#2 = "r";|O #8#2 = "I";|O #8#2 = "i";
            |SI iva  ! 0; ventas_con = ventas_con + base; |FINSI;
            |SI iva  = 0; ventas_sin = ventas_sin + base; |FINSI;
        |FINSI;
    |FINSI;
|SINO;
    #28#0 = Concep6;
    |LEE 040#28=;
    |SI FSalida = 0;
        |SI #28#2 = "R";|O #28#2 = "r";|O #28#2 = "I";|O #28#2 = "i";
            |SI iva  ! 0; ventas_con = ventas_con + base; |FINSI;
            |SI iva  = 0; ventas_sin = ventas_sin + base; |FINSI;
        |FINSI;
    |FINSI;
|FINSI;

|SI #4#28 = 0;                             ||modificado por R.Aura
    ventas_con = ventas_con + ventas_sin;  ||si no hay % no calcula
    ventas_sin = 0;                        || prorrata
|FINSI;
|FPRC;

|PROCESO Ventas;
|ABRE #4;
#4#0 = #7#0;
#4#1 = #7#19;
#4#2 = #0#2;
|LEE 040#4=;
|SI FSalida ! 0; |DDEFECTO #4; |FINSI;
|CIERRA #4;

|SI #4#22 = "A"; |ACABA; |FINSI;
|SI #4#26 = "N"; |ACABA; |FINSI;

d_empre = #7#0;
d_activ = #7#19;

|SI #0#2 ] 0;  |Y #0#2 [ 80;
    |SI #4#26 ! "F";
        #19#0 = #4#4;
        #19#1 = #4#5;
        |LEE 040#19=;
        |SI FSalida ! 0;
            |HAZ Ventas_300;
        |FINSI;
    |SINO;
        |HAZ Ventas_300;
    |FINSI;
|SINO;
    |SI #0#2 [ 97;
        #18#0 = #4#4;
        #18#1 = #4#5;
        |LEE 040#18=;
        |SI FSalida = 0;
            |HAZ Ventas_310;
        |SINO;
            |HAZ Ventas_300;
        |FINSI;
    |SINO;
        |SI #4#26 ! "F";
            #19#0 = #4#4;
            #19#1 = #4#5;
            |LEE 040#19=;
            |SI FSalida ! 0;
                |HAZ Ventas_300;
            |FINSI;
        |SINO;
            |HAZ Ventas_300;
        |FINSI;
    |FINSI;
|FINSI;

#7#18 = "S";
|GRABA 020#7a;
|LIBERA #7;

|SI #25#1 = 4; |HAZ grabacomp; |FINSI;
|FPRC;

|PROCESO Ventas_310;
base = 0;

|SI #4#50 = 1;
    #8#0 = #7#5;
    |LEE 040#8=;
    |SI FSalida = 0; |Y #8#3 = "I";
       base = base + #7#7;
    |FINSI;

    #8#0 = #7#33;
    |LEE 040#8=;
    |SI FSalida = 0; |Y #8#3 = "I";
       base = base + #7#23;
    |FINSI;

    #8#0 = #7#34;
    |LEE 040#8=;
    |SI FSalida = 0; |Y #8#3 = "I";
        base = base + #7#24;
    |FINSI;

    #8#0 = #7#60;
    |LEE 040#8=;
    |SI FSalida = 0; |Y #8#3 = "I";
        base = base + #7#45;
    |FINSI;

    #8#0 = #7#61;
    |LEE 040#8=;
    |SI FSalida = 0; |Y #8#3 = "I";
        base = base + #7#46;
    |FINSI;

    #8#0 = #7#62;
    |LEE 040#8=;
    |SI FSalida = 0; |Y #8#3 = "I";
        base = base + #7#47;
    |FINSI;
|SINO;
    #28#0 = #7#72;
    |LEE 040#28=;
    |SI FSalida = 0; |Y #28#3 = "I";
        base = base +  #7#7;
    |FINSI;

    #28#0 = #7#73;
    |LEE 040#28=;
    |SI FSalida = 0; |Y #28#3 = "I";
        base = base + #7#23;
    |FINSI;

    #28#0 = #7#74;
    |LEE 040#28=;
    |SI FSalida = 0; |Y #28#3 = "I";
        base = base + #7#24;
    |FINSI;

    #28#0 = #7#75;
    |LEE 040#28=;
    |SI FSalida = 0; |Y #28#3 = "I";
        base = base + #7#45;
    |FINSI;

    #28#0 = #7#76;
    |LEE 040#28=;
    |SI FSalida = 0; |Y #28#3 = "I";
        base = base + #7#46;
    |FINSI;

    #28#0 = #7#77;
    |LEE 040#28=;
    |SI FSalida = 0; |Y #8#3 = "I";
        base = base + #7#47;
    |FINSI;
|FINSI;

|SI epig1_1 = ""; |Y epig2_1 = "";
    epig1_1 = #4#4;
    epig2_1 = #4#5;
    epig3_1 = #4#1;
    rdtos_1 = rdtos_1 + base;
    |ACABA;
|FINSI;

|SI epig1_1 = #4#4; |Y epig2_1 = #4#5;
    rdtos_1 = rdtos_1 + base;
    |ACABA;
|FINSI;

|SI epig1_2 = ""; |Y epig2_2 = "";
    epig1_2 = #4#4;
    epig2_2 = #4#5;
    epig3_2 = #4#1;
    rdtos_2 = rdtos_2 + base;
    |ACABA;
|FINSI;

|SI epig1_2 = #4#4; |Y epig2_2 = #4#5;
    rdtos_2 = rdtos_2 + base;
    |ACABA;
|FINSI;

|SI epig1_3 = ""; |Y epig2_3 = "";
    epig1_3 = #4#4;
    epig2_3 = #4#5;
    epig3_3 = #4#1;
    rdtos_3 = rdtos_3 + base;
    |ACABA;
|FINSI;

|SI epig1_3 = #4#4; |Y epig2_3 = #4#5;
    rdtos_3 = rdtos_3 + base;
    |ACABA;
|FINSI;

|SI epig1_4 = ""; |Y epig2_4 = "";
    epig1_4 = #4#4;
    epig2_4 = #4#5;
    epig3_4 = #4#1;
    rdtos_4 = rdtos_4 + base;
    |ACABA;
|FINSI;

|SI epig1_4 = #4#4; |Y epig2_4 = #4#5;
    rdtos_4 = rdtos_4 + base;
    |ACABA;
|FINSI;

|SI epig1_5 = ""; |Y epig2_5 = "";
    epig1_5 = #4#4;
    epig2_5 = #4#5;
    epig3_5 = #4#1;
    rdtos_5 = rdtos_5 + base;
    |ACABA;
|FINSI;

|SI epig1_5 = #4#4; |Y epig2_5 = #4#5;
    rdtos_5 = rdtos_5 + base;
|FINSI;
|FPRC;

|PROCESO Ventas_300;
#25#0 = #7#0; #25#1 = #0#3; #25#2 = #0#2; #25#45 = #7#19;
|HAZ compensar;

#25#0 = #7#0; #25#1 = #0#3; #25#2 = #0#2; #25#45 = #7#19;
|LIBERA #25; |LEE 110#25=;
estado = FSalida;
|SI estado ! 0; |DDEFECTO #25; |FINSI;

|SI #25#4 = "S"; |ACABA; |FINSI;

#25#0 = #7#0; #25#1 = #0#3; #25#2 = #0#2; #25#45 = #7#19;

Concep2 = #7#5;
Concep6 = #7#72;
base    = #7#7; tiva = #7#8;  iva = #7#9; trec = #7#10; rec = #7#11;
|HAZ ConcepVenta;

Concep2 = #7#33;
Concep6 = #7#73;
base    = #7#23; tiva = #7#25; iva = #7#27; trec = #7#29; rec = #7#31;
|HAZ ConcepVenta;

Concep2 = #7#34;
Concep6 = #7#74;
base    = #7#24; tiva = #7#26; iva = #7#28; trec = #7#30; rec = #7#32;
|HAZ ConcepVenta;

Concep2 = #7#60;
Concep6 = #7#75;
base    = #7#45; tiva = #7#48; iva = #7#51; trec = #7#54; rec = #7#57;
|HAZ ConcepVenta;

Concep2 = #7#61;
Concep6 = #7#76;
base    = #7#46; tiva = #7#49; iva = #7#52; trec = #7#55; rec = #7#58;
|HAZ ConcepVenta;

Concep2 = #7#62;
Concep6 = #7#77;
base    = #7#47; tiva = #7#50; iva = #7#53; trec = #7#56; rec = #7#59;
|HAZ ConcepVenta;

#25#20 = #25#7 + #25#10 + #25#13 + #25#16 + #25#19 + #25#48 + #25#50;
#25#25 = #25#21 + #25#22 + #25#23 + #25#43 + #25#44 + #25#51 + #25#78 + #25#80;
#25#26 = #25#20 - #25#25;
#25#27 = 100;
#25#28 = #25#26 % #25#27;
#25#29 = perante;
total = #25#28 - #25#29;
|SI total = 0; #25#33 = 0; #25#32 = 0; #25#31 = 0; |FINSI;
|SI total > 0; #25#33 = total; #25#32 = 0; #25#31 = 0; |FINSI;
|SI total < 0;|Y #0#3 ! 4;
    #25#32 = total * (-1);
    #25#31 = 0;
    #25#33 = 0;
|FINSI;
|SI total < 0; |Y #0#3 = 4;
    |SI #4#27 = "D";
        #25#31 = total * (-1);
        #25#32 = 0;
        #25#33 = 0;
    |SINO;
        #25#32 = total * (-1);
        #25#31 = 0;
        #25#33 = 0;
    |FINSI;
|FINSI;

|SI estado ! 0; |GRABA 020#25n; |SINO; |GRABA 020#25a; |FINSI;
|FPRC;

|DEFBUCLE lineavent_2;
#7#2;
;
#12#0, #12#4, tri1, 1, fec1, 00001;
#12#0, #12#4, tri2, 6, fec2, 32000;
be;
NULL, Ventas;
|FIN;

|PROCESO Ventas_acu;
|ABRE #4;
#4#0 = #7#0;
#4#1 = #7#19;
#4#2 = #0#2;
|LEE 040#4=;
|SI FSalida ! 0; |DDEFECTO #4; |FINSI;
|CIERRA #4;

#25#0 = #7#0; #25#1 = #0#3; #25#2 = #0#2; #25#45 = #7#19;

Concep2 = #7#5;
Concep6 = #7#72;
base    = #7#7; tiva = #7#8; iva = #7#9; trec = #7#10; rec = #7#11;
|HAZ ConcepVenta_2;

Concep2 = #7#33;
Concep6 = #7#73;
base    = #7#23; tiva = #7#25; iva = #7#27; trec = #7#29; rec = #7#31;
|HAZ ConcepVenta_2;

Concep2 = #7#34;
Concep6 = #7#74;
base    = #7#24; tiva = #7#26; iva = #7#28; trec = #7#30; rec = #7#32;
|HAZ ConcepVenta_2;

Concep2 = #7#60;
Concep6 = #7#75;
base    = #7#45; tiva = #7#48; iva = #7#51; trec = #7#54; rec = #7#57;
|HAZ ConcepVenta_2;

Concep2 = #7#61;
Concep6 = #7#76;
base    = #7#46; tiva = #7#49; iva = #7#52; trec = #7#55; rec = #7#58;
|HAZ ConcepVenta_2;

Concep2 = #7#62;
Concep6 = #7#77;
base    = #7#47; tiva = #7#50; iva = #7#53; trec = #7#56; rec = #7#59;
|HAZ ConcepVenta_2;
|FPRC;

|DEFBUCLE lineavent_1;
#7#1;
;
#12#0, #12#4, 00001;
#12#0, #12#4, 32000;
be;
NULL, Ventas_acu;
|FIN;

|PROCESO cabevent;
     fichero = #12#0;
     fichero = "00000" + fichero;
     fichero = fichero % -105;
     anyocab = #12#4;
     anyocab = "00" + anyocab;
     anyocab = anyocab % -102;
     fichero = "v" + fichero + anyocab;
     |NOME_DAT #7fichero;

     |HAZ BorraVariables;

     |SI #0#3  = 4; |BUCLE lineavent_1; |FINSI;
     |BUCLE lineavent_2;
     |SI #0#3  = 4; |HAZ prorrata; |FINSI;
|FPRC;

|| ******************
|| PASAMOS LAS VENTAS
|| ******************

|DEFBUCLE pasavent;
#12#1;
;
#0#0, #0#2;
#0#1, #0#2;
e;
NULL, cabevent;
|FIN;

|| **************************************************************************
||                             Grabamos el 130
|| **************************************************************************

|PROCESO graba130;
se_empre = #25#0;
se_ejerc = #25#2;
se_perio = #25#1;
se_tipos = 300;
se_activ = #25#45;
se_impor = 0;
|SI #25#33 > 0; se_impor =  #25#33; |FINSI;
|SI #25#32 > 0; se_impor = -#25#32; |FINSI;
|SI #25#31 > 0; se_impor = -#25#31; |FINSI;
se_fecha = #25#3;
se_factu = "";
|HAZ seguimie;

|ABRE #4;
#4#0 = #25#0;
#4#1 = #25#45;
#4#2 = #0#2;
|LEE 040#4=;
|SI FSalida ! 0; |DDEFECTO #4; |FINSI;
|CIERRA #4;
ventas = #25#5 + #25#8 + #25#11;
|HAZ grabaact;
|FPRC;

|DEFBUCLE eosm1300;
#25#1;
;
#0#0, 1, #0#3, #0#2;
#0#1, 6, #0#3, #0#2;
e;
NULL, graba130;
|FIN;

|| **************************************************************************
||                            Utilidades
|| **************************************************************************

|PROCESO penultimo;
penult = 0;
|ABRE #4;
#4#0 = #25#0;
#4#1 = #25#45;
#4#2 = #0#2 - 2;
|SI #4#2 = -2;  #4#2 = 98;  |FINSI;
|SI #4#2 = -1;  #4#2 = 99;  |FINSI;
|LEE 040#4=;
|SI FSalida ! 0; |DDEFECTO #4; |FINSI;
penult = #4#39;

#4#0 = #25#0;
#4#1 = #25#45;
#4#2 = #0#2;
|LEE 040#4=;
|SI FSalida ! 0; |DDEFECTO #4; |FINSI;
|CIERRA #4;
|FPRC;

|PROCESO periodo;
anio = ("00" + #0#2) % -102;
|SI #0#2 < 80; anio = "20" + anio; |SINO; anio = "19" + anio; |FINSI;

|SI #0#4 = "T";
    varalf = "01.01." + anio; fec1   = varalf;
    varalf = "31.12." + anio; fec2   = varalf;
    tri1   = #0#3;
    tri2   = #0#3;
|SINO;
    |SI #0#3 = 1;
        varalf = "01.01." + anio; fec1   = varalf;
        varalf = "31.03." + anio; fec2   = varalf;
        tri1   = 1;
        tri2   = 4;
    |FINSI;

    |SI #0#3 = 2;
        varalf = "01.04." + anio; fec1   = varalf;
        varalf = "30.06." + anio; fec2   = varalf;
        tri1   = 1;
        tri2   = 4;
    |FINSI;

    |SI #0#3 = 3;
        varalf = "01.07." + anio; fec1   = varalf;
        varalf = "30.09." + anio; fec2   = varalf;
        tri1   = 1;
        tri2   = 4;
    |FINSI;

    |SI #0#3 = 4;
        varalf = "01.10." + anio; fec1   = varalf;
        varalf = "31.12." + anio; fec2   = varalf;
        tri1   = 1;
        tri2   = 4;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO compensar;|TIPO 0;
perante = 0;
|SI #25#1 = 1;
    |ABRE #4;
    #4#0 = d_empre;
    #4#1 = d_activ;
    #4#2 = #0#2 - 1;
    |SI #4#2 < 0;  #4#2 = 99;  |FINSI;
    |LEE 040#4=;
    |SI FSalida = 0; perante = #4#34; |FINSI;
    |DDEFECTO #4;

    #4#0 = d_empre;
    #4#1 = d_activ;
    #4#2 = #0#2;
    |LEE 040#4=;
    |SI FSalida ! 0; |DDEFECTO #4; |FINSI;
    |CIERRA #4;
|SINO;
    empresa = #25#0;
    periodo = #25#1;
    anyo = #25#2;
    activida = #25#45;
    #25#1 = #25#1 - 1;
    |LEE 040#25=;
    |SI FSalida = 0;
        |SI #25#55 < 0; perante = -#25#55; |FINSI;
    |FINSI;
    |DDEFECTO #25;
    #25#0 = empresa;
    #25#1 = periodo;
    #25#2 = anyo;
    #25#45 = activida;
    |LEE 040#25=;
|FINSI;
|FPRC;

|PROCESO grabacomp;
|ABRE #4;
#4#0 = d_empre;
#4#1 = d_activ;
#4#2 = #0#2;
|LIBERA #4;
|LEE 140#4=;
|SI FSalida = 0;
    #4#34 = 0;
    |SI #25#55 < 0;
        |SI #4#27 = "C"; #4#34 = -#25#55; |FINSI;
    |FINSI;
    |GRABA 140#4a;
|FINSI;
|CIERRA #4;
|FPRC;

|PROCESO grabaact;
|ABRE #4;
#4#0 = #25#0;
#4#1 = #25#45;
#4#2 = #0#2;
|LIBERA #4;
|LEE 140#4=;
|SI FSalida = 0;
    |SI #0#3 = 1; #4#30 = ventas; |FINSI;
    |SI #0#3 = 2; #4#31 = ventas; |FINSI;
    |SI #0#3 = 3; #4#32 = ventas; |FINSI;
    |SI #0#3 = 4; #4#33 = ventas; |FINSI;
    |GRABA 140#4a;
|FINSI;
|CIERRA #4;
|FPRC;

|PROCESO pase; |TIPO 3;
|SI #0#5 = "SI";
   |ABRE #9;
   |LEE 040#9p;
   |SI FSalida ! 0; |DDEFECTO #9; |FINSI;
   |CIERRA #9;

   |SI #9#13 = #9#14;  |Y #9#13 = #9#15;  |Y #9#13 ! 0;
       |MENAV "0000 Los Tipos de IVA de Adquisiones en el Control son iguales. Cambielos";
       |ACABA;
   |FINSI;

   |ABRE #1;
   |ABRE #8;
   |ABRE #4;
   |ABRE #10;
   |ABRE #28;
   |BUCLE baja300;                 || Baja del 300
   |CIERRA #10;

   |ABRET #25;
   |ABRE #19;

   |HAZ periodo;
   |ATRI I;
   |PINTA 2330,"PASANDO LAS COMPRAS";
   |ATRI 0;
   |BUCLE pasacomp;                 || Pasamos compras

   |BLIN 23;
   |ATRI I;
   |PINTA 2330,"PASANDO LAS VENTAS";
   |ATRI 0;
   |ABRE #18;

   |BUCLE pasavent;                 || Pasamos  ventas

   |CIERRA #18;
   |CIERRA #19;
   |CIERRAT #25;
   |CIERRA #8;
   |CIERRA #28;

   |BLIN 23;

   |BUCLE eosm1300;

   |CIERRA #1;
   |CIERRA #4;
|FINSI;
|FPRC;

|PROCESO acumula;
|ABRE #4;
#4#0 = #25#0;
#4#1 = #25#45;
#4#2 = #25#2;
|LEE 040#4=;
|SI FSalida ! 0; |DDEFECTO #4; |FINSI;
|CIERRA #4;

prorrata = #4#28;
|SI prorrata = 0; prorrata = 100; |FINSI;

t_compra1 = t_compra1 + ((#25#21 / prorrata) * 100);
t_compra2 = t_compra2 + ((#25#22 / prorrata) * 100);
t_compra3 = t_compra3 + ((#25#51 / prorrata) * 100);
t_compra4 = t_compra4 + ((#25#23 / prorrata) * 100);
t_compra5 = t_compra5 + ((#25#24 / prorrata) * 100);
t_compra6 = t_compra6 + ((#25#43 / prorrata) * 100);
t_compra7 = t_compra7 + ((#25#44 / prorrata) * 100);
t_compra8 = t_compra8 + ((#25#78 / prorrata) * 100);

p_compra1 = p_compra1 + #25#21;
p_compra2 = p_compra2 + #25#22;
p_compra3 = p_compra3 + #25#51;
p_compra4 = p_compra4 + #25#23;
p_compra5 = p_compra5 + #25#24;
p_compra6 = p_compra6 + #25#43;
p_compra7 = p_compra7 + #25#44;
p_compra8 = p_compra8 + #25#78;
|FPRC;

|DEFBUCLE eosm1300_1;
#25#1;
;
#0#0, 1, 1, #0#2;
#0#1, 6, 3, #0#2;
e;
NULL, acumula;
|FIN;

|PROCESO graba_pro;
#1#0 = #25#0;
|LEE 040#1=;
|SI FSalida ! 0; |DDEFECTO #1; |FINSI;

|ABRE #17;
#17#0 = #25#0;
#17#1 = #25#2;
#17#2 = #25#45;
|BORRA 140#17c;
|LIBERA #17;

|DDEFECTO #17;
#17#0  = #25#0;
#17#1  = #25#2;
#17#2  = #25#45;
#17#3  = #1#3;
#17#4  = "L";
#17#5  = ventas_con;
#17#6  = ventas_sin;
#17#7  = ventas_con + ventas_sin;
#17#8  = (((#17#5 / #17#7) * 100) + 0.49) ! 0;

|ABRE #4;
#4#0 = #25#0;
#4#1 = #25#45;
#4#2 = #25#2;
|LEE 040#4=;
|SI FSalida ! 0; |DDEFECTO #4; |FINSI;
|CIERRA #4;

prorrata = #4#28;
|SI prorrata = 0; prorrata = 100; |FINSI;

#17#9  = t_compra1 + ((#25#21 / prorrata) * 100);
#17#10 = t_compra2 + ((#25#22 / prorrata) * 100);
#17#11 = t_compra3 + ((#25#51 / prorrata) * 100);
#17#12 = t_compra4 + ((#25#23 / prorrata) * 100);
#17#13 = t_compra5 + ((#25#24 / prorrata) * 100);
#17#14 = t_compra6 + ((#25#43 / prorrata) * 100);
#17#15 = t_compra7 + ((#25#44 / prorrata) * 100);
#17#41 = t_compra8 + ((#25#78 / prorrata) * 100);

#17#16 = #17#09 % #17#8;
#17#17 = #17#10 % #17#8;
#17#18 = #17#11 % #17#8;
#17#19 = #17#12 % #17#8;
#17#20 = #17#13 % #17#8;
#17#21 = #17#14 % #17#8;
#17#22 = #17#15 % #17#8;
#17#42 = #17#41 % #17#8;

#17#23 = p_compra1;
#17#24 = p_compra2;
#17#25 = p_compra3;
#17#26 = p_compra4;
#17#27 = p_compra5;
#17#28 = p_compra6;
#17#29 = p_compra7;
#17#43 = p_compra8;

#17#30 = #17#16 - #17#23;
#17#31 = #17#17 - #17#24;
#17#32 = #17#18 - #17#25;
#17#33 = #17#19 - #17#26;
#17#34 = #17#20 - #17#27;
#17#35 = #17#21 - #17#28;
#17#36 = #17#22 - #17#29;
#17#44 = #17#42 - #17#43;

#17#37 = #17#09 + #17#10 + #17#11 + #17#12 + #17#13 + #17#14 + #17#15 + #17#41;
#17#38 = #17#16 + #17#17 + #17#18 + #17#19 + #17#20 + #17#21 + #17#22 + #17#42;
#17#39 = #17#23 + #17#24 + #17#25 + #17#26 + #17#27 + #17#28 + #17#29 + #17#43;
#17#40 = #17#30 + #17#31 + #17#32 + #17#33 + #17#34 + #17#35 + #17#36 + #17#44;
|GRABA 040#17n;
|CIERRA #17;

#25#21 = #17#30;
#25#22 = #17#31;
#25#51 = #17#32;
#25#23 = #17#33;
#25#24 = #17#34;
#25#43 = #17#35;
#25#44 = #17#36;
#25#78 = #17#44;

|ABRE #4;
#4#0 = #25#0;
#4#1 = #25#45;
#4#2 = #25#2;
|LIBERA #4;
|LEE 040#4=;
|SI FSalida ! 0; |DDEFECTO #4; |FINSI;
|CIERRA #4;

#25#20 = #25#7 + #25#10 + #25#13 + #25#16 + #25#19 + #25#48 + #25#50;
#25#25 = #25#21 + #25#22 + #25#23 + #25#43 + #25#44 + #25#51 + #25#78 + #25#80;
#25#26 = #25#20 - #25#25;
#25#27 = 100;
#25#28 = #25#26 % #25#27;
total = #25#28 - #25#29;
|SI total = 0; #25#33 = 0; #25#32 = 0; #25#31 = 0; |FINSI;

|SI total > 0; #25#33 = total; #25#32 = 0; #25#31 = 0; |FINSI;

|SI total < 0;|Y #0#3 ! 4;
    #25#32 = -total;
    #25#31 = 0;
    #25#33 = 0;
|FINSI;

|SI total < 0; |Y #0#3 = 4;
    empresa_d = #25#0;
    activid_d = #25#45;
    anyo_d    = #25#2;
    |HAZ Preg_Devol;

    |SI #4#27 = "D";
        #25#31 = total * (-1);
        #25#32 = 0;
        #25#33 = 0;
    |SINO;
        #25#32 = total * (-1);
        #25#31 = 0;
        #25#33 = 0;
    |FINSI;
|FINSI;
|GRABA 140#25a;
|LIBERA #25;

|ABRE #4;
#4#0 = #25#0;
#4#1 = #25#45;
#4#2 = #25#2 + 1;
|LIBERA #4;
|LEE 140#4=;
|SI FSalida = 0;
    #4#28 = #17#8;
    |GRABA 140#4a;
|SINO;
    #4#0 = #25#0;
    #4#1 = #25#45;
    #4#2 = #25#2;
    |LIBERA #4;
    |LEE 140#4=;
    |SI FSalida = 0;
       #4#2 = #25#2 + 1;
       #4#28 = #17#8;
       |GRABA 140#4n;
    |FINSI;
|FINSI;
|CIERRA #4;
|FPRC;

|DEFBUCLE eosm1300_2;
#25#1;
;
#12#0, 1, 4, #12#4;
#12#0, 6, 4, #12#4;
be;
NULL, graba_pro;
|FIN;

|PROCESO prorrata;
t_compra1 = 0;
t_compra2 = 0;
t_compra3 = 0;
t_compra4 = 0;
t_compra5 = 0;
t_compra6 = 0;
t_compra7 = 0;
t_compra8 = 0;

p_compra1 = 0;
p_compra2 = 0;
p_compra3 = 0;
p_compra4 = 0;
p_compra5 = 0;
p_compra6 = 0;
p_compra7 = 0;
p_compra8 = 0;
|CIERRAT #25;  |BUCLE eosm1300_1;  |ABRET #25;
|CIERRAT #25;  |BUCLE eosm1300_2;  |ABRET #25;
|FPRC;
