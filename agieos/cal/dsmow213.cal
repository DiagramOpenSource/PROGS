|FICHEROS;
     dsmow213;
     dsm30301;

     eosactiv;
|FIN;

|VARIABLES;
     nCampo1 = 0;
     nCampo2 = 0;
     nCampo3 = 0;

     aAlfa   = "";
|FIN;

|PROCESO Tipo12Fw213;  |TIPO 12;
|FPRC;

|PROCESO TotalFw213;  |TIPO 0;
     #dsmow213#33 = #dsmow213#25 + #dsmow213#26 + #dsmow213#27;
     #dsmow213#33 = #dsmow213#33 + #dsmow213#28 + #dsmow213#29;
     #dsmow213#33 = #dsmow213#33 + #dsmow213#30 + #dsmow213#31;
     #dsmow213#33 = #dsmow213#33 + #dsmow213#32;

     |PINTA #dsmow213#33;
|FPRC;

|PROCESO Baja14;
     #eosactiv#0 = #dsm30301#0;
     #eosactiv#1 = 1;
|FPRC;

|PROCESO Alta14;
     #eosactiv#0 = #dsm30301#0;
     #eosactiv#1 = 99;
|FPRC;

|PROCESO Tipo66Act;  |TIPO 66;
     |ABRE #eosactiv;
     |CONSULTA_F_CLAVE #1#eosactiv, Baja14, Alta14;
     |SI FSalida = 0;
         #dsmow213#Campo# = #eosactiv#1;  |PINTA #dsmow213#Campo#
     |FINSI;
     |CIERRA #eosactiv;
|FPRC;

|PROCESO Tipo0Act;  |TIPO 0;
     nCampo1 = Campo + 1;
     nCampo2 = Campo + 2;
     nCampo3 = Campo + 3;

     |C_M #dsmow213#nCampo3#, 1, "S";

     |SI #dsmow213#Campo# = 0;
         #dsmow213#nCampo1# = "";  |PINTA #dsmow213#nCampo1#;
         #dsmow213#nCampo2# = "";  |PINTA #dsmow213#nCampo2#;
         #dsmow213#nCampo3# = 0;   |PINTA #dsmow213#nCampo3#;

         |C_M #dsmow213#nCampo3#, 1, "N";

         |ACABA;
     |FINSI;

     |ABRE #eosactiv;
     #eosactiv#0 = #dsm30301#0;
     #eosactiv#1 = #dsmow213#Campo#;
     |LEE 000#eosactiv.=;
     |SI FSalida ! 0;
         |MENAV "     No existe Actividad";
         |ERROR;
     |FINSI;
     |CIERRA #eosactiv;

     #dsmow213#nCampo1# = #eosactiv#5;   |PINTA #dsmow213#nCampo1#;
     #dsmow213#nCampo2# = #eosactiv#6;   |PINTA #dsmow213#nCampo2#;
     #dsmow213#nCampo3# = #eosactiv#43;  |PINTA #dsmow213#nCampo3#;
|FPRC;
