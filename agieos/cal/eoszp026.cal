|FICHEROS;
     eoszp026 #0;
     eosactiv #1;
     eoslinco #2;
     eoslinve #3;
     eosclpre #4;
     eosclien #5;
     eosconce #6;
     eoscabco #7;
     eoscabve #8;
     eosm0041 #9;
     eosm0042 #10;
     eosm0046 #11;
     eosm0040 #12;
     eosm0045 #13;
     eosconc6 #16;
|FIN;

|INCLUYE i_consul;
||IN-CLUYE i_ficher;

|VARIABLES;
   Empresa = 0;
   activ   = 0;
   fecha   = @;

   Cont   = 0;
   Cont1  = 0;
   Cont2  = 0;
   campo1 = 0;

   SwError = 0;
   alfa1 = "";
   alfa2 = "";
   anyo = 0;
   anyo1 = 0;

   Comodin = "";
   ComodNum = 0;
   FEstado = 0;

   TipoCmp = "";
   TipoVnt = "";
   TipoPer = "";

   nCampo = 0;
   nNume1 = 0;
|FIN;

|PROCESO NoMasEmpresas;
     |SI #0Campo = 0;
         nNume1 = Campo + 20;
         #0nNume1 = 0;  |C_M #0nNume1, 1, "N";  |PINTA #0nNume1;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 19;  |HACIENDO nCampo = nCampo + 1;
               nNume1 = nCampo + 20;
               #0nCampo = 0;  |C_M #0nCampo, 1, "N";  |PINTA #0nCampo;
               #0nNume1 = 0;  |C_M #0nNume1, 1, "N";  |PINTA #0nNume1;
         |SIGUE;
     |SINO;
         nNume1 = Campo + 20;
         |C_M #0nNume1, 1, "S";
         |PARA nCampo = Campo + 1;  |SI nCampo [ 19;  |HACIENDO nCampo = nCampo + 1;
               nNume1 = nCampo + 20;
               |C_M #0nCampo, 1, "S";
               |C_M #0nNume1, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Concepto2; |TIPO 0;
     |SI #0Campo = 0; |ACABA; |FINSI;

     |ABRE #6;
     #6#0 = #0Campo;
     |LEE 040#6=;
     |SI FSalida ! 0;
         |MENAV "       No existe Concepto 2 Digitos.";
         |ERROR;
         |CIERRA #6;
         |ACABA;
     |FINSI;
     |CIERRA #6;

     |SI #6#10 ! "S";
          |MENAV "       El Concepto no tiene permiso de pasar el IRPF.";
          |ERROR;
          |ACABA;
     |FINSI;
|FPRC;

|PROCESO Concepto6; |TIPO 0;
     |SI #0Campo = "      "; |ACABA; |FINSI;

     |ABRE #16;
     #16#0 = #0Campo;
     |LEE 040#16=;
     |SI FSalida ! 0;
         |MENAV "       No existe Concepto 6 Digitos.";
         |ERROR;
         |CIERRA #16;
         |ACABA;
     |FINSI;
     |CIERRA #16;

     |SI #16#10 ! "S";
          |MENAV "       El Concepto no tiene permiso de pasar el IRPF.";
          |ERROR;
          |ACABA;
      |FINSI;
|FPRC;

|PROCESO ejercicio; |TIPO 7;
     fecha = ~;
     alfa1 = fecha % -102;         #0#40 = alfa1;   |PINTA #0#40;
     alfa1 = fecha % -104;
     alfa2 = "01.01." + alfa1;     #0#41 = alfa2;   |PINTA #0#41;
     alfa2 = "31.12." + alfa1;     #0#42 = alfa2;   |PINTA #0#42;
|FPRC;

|PROCESO activi; |TIPO 0;
     campo1 = Campo - 20;

     |SI #0campo1 = 0; |Y #0Campo = 0; |ACABA; |FINSI;

     |ABRE #1;
     #1#0 = #0campo1;
     #1#1 = #0Campo;
     #1#2 = #0#40;
     |LEE 040#1=;
     FEstado = FSalida;
     |CIERRA #1;

     |SI FEstado ! 0;
         |MENAV "     No existe la Actividad.";
         #0campo1 = 0; |PINTA #0campo1;
         #0Campo  = 0; |PINTA #0Campo;
         |PTEC 808;
         |PTEC 808;
         |ACABA;
     |FINSI;

     |SI #1#17 = "R";
         |MENAV "     La Actividad no tiene Retenciones.";
         #0campo1 = 0; |PINTA #0campo1;
         #0Campo  = 0; |PINTA #0Campo;
         |PTEC 808;
         |PTEC 808;
     |FINSI;
|FPRC;

|PROCESO PonMarca;
   #eosm0042#10 = "*";
   |GRABA 020#eosm0042.a;
|FPRC;

|DEFBUCLE PonMarca;
   #eosm0042#1;
   ;
   00000,0000,"            ", 01, 0000;
   99999,9999,"zzzzzzzzzzzz", 99, 9999;
   ;
   NULL,PonMarca;
|FIN;

|| **************************************************************************
|| **************************** PASE DE COMPRAS *****************************
|| **************************************************************************

|PROCESO GrabaCompra;
   |ABRE #eosclien;
   |ABRE #eosm0046;
   #eosm0046#0 = #2#0;
   |LEE 010#eosm0046.=;
   |SI FSalida = 0;
      TipoPer = #eosm0046#2;
   |SINO;
      |DDEFECTO #eosm0046;
      #eosm0046#0 = #2#0;
      #eosclien#0 = #2#0;
      |LEE 010#eosclien.=;
      #eosm0046#1 = #eosclien#2;
      |GRABA 020#eosm0046.n;
   |FINSI;
   |CIERRA #eosm0046;

   |ABRE #eosm0040;
   #eosm0040#0 = #2#0;
   #eosm0040#1 = #2#14;
   |SI #2#14 ] 80;
      #eosm0040#1 = #eosm0040#1 + 1900;
   |SINO;
      #eosm0040#1 = #eosm0040#1 + 2000;
   |FINSI;
   |LEE 010#eosm0040.=;
   |SI FSalida ! 0;
      |DDEFECTO #eosm0040;
      #eosm0040#0 = #2#0;
      #eosclien#0 = #2#0;
      |LEE 010#eosclien.=;
      #eosm0040#2 = #eosclien#2;
      #eosm0040#1 = #2#14;
      |SI #2#14 ] 80;
         #eosm0040#1 = #eosm0040#1 + 1900;
      |SINO;
         #eosm0040#1 = #eosm0040#1 + 2000;
      |FINSI;
      |GRABA 020#eosm0040.n;
   |FINSI;
   |CIERRA #eosm0040;
   |CIERRA #eosclien;

   |ABRE #4;
   #4#0 = #eoslinco#0;
   #4#1 = #eoslinco#3;
   #4#2 = 2;
   |LEE 010#4=;
   |CIERRA #4;

   |ABRE #eosm0045;
   #eosm0045#0 = #4#0;
   #eosm0045#1 = #4#3;
   #eosm0045#4 = 01;
   |LEE 010#eosm0045.=;
   |SI FSalida ! 0;
      #eosm0045#0 = #4#0;
      #eosm0045#1 = #4#3;
      #eosm0045#2 = #4#4;
      #eosm0045#3 = "N";
      #eosm0045#4 = 01;
      |GRABA 020#eosm0045.n;
   |FINSI;
   |CIERRA #eosm0045;

   |ABRE #eosm0041;
   #eosm0041#0 = #2#0;
   anyo = #2#14;
   Comodin = ("00" + #2#14) % -102;
   |SI Comodin ] "80";
      anyo = anyo + 1900;
   |SINO;
      anyo = anyo + 2000;
   |FINSI;
   Comodin = anyo;
   #eosm0041#1 = anyo;
   #eosm0041#2 = #2#12;
   #eosm0041#4 = 01;
   |LEE 010#eosm0041.=;
   |SI FSalida ! 0;
      |DDEFECTO #eosm0041;
      #eosm0041#0 = #2#0;
      #eosm0041#1 = anyo;
      #eosm0041#2 = #2#12;
      #eosm0041#4 = 01;
      |GRABA 020#eosm0041.b;
   |FINSI;
   #eosm0041#3 = #2#38;
   |GRABA 020#eosm0041.a;
   |CIERRA #eosm0041;

  |ABRE #eosm0042;
   #eosm0042#0 = #2#0;
   anyo = #2#14;
   Comodin = ("00" + #2#14) % -102;
   |SI Comodin ] "80";
      anyo = anyo + 1900;
   |SINO;
      anyo = anyo + 2000;
   |FINSI;
   Comodin = anyo;
   Comodin = #2#4 % 0302;
   #eosm0042#9 = Comodin;

   #eosm0042#1  = anyo;
   #eosm0042#2  = #2#12;
   #eosm0042#11 = #eosm0041#4;
   |LEE 010#eosm0042.=;
   |SI FSalida ! 0;
      |DDEFECTO #eosm0042;
      #eosm0042#0 = #2#0;
      #eosm0042#1 = anyo;
      #eosm0042#2 = #2#12;
      #eosm0042#11 = #eosm0041#4;
      Comodin = #2#4 % 0302;
      #eosm0042#9 = Comodin;
      |GRABA 020#eosm0042.b;
   |FINSI;
   |SI #eoszp026#67 = "N"; |Y #eosm0042#10 = "*";
      #eosm0042#3 = 0;
      #eosm0042#4 = 0;
      #eosm0042#5 = 0;
      #eosm0042#6 = 0;
      #eosm0042#7 = 0;
      #eosm0042#8 = 0;
      #eosm0042#10 = " ";
   |FINSI;

   || Si la retencion es dineraria , la creo como dineraria
   |SI TipoCmp = "D";
      |SI #2#42 ! 0;
         #eosm0042#3 = #eosm0042#3 + #2#7;
         |SI #eosm0042#4 = 0; #eosm0042#4 = #2#39; |FINSI;
         #eosm0042#5 = #eosm0042#5 + #2#42;
      |FINSI;
      |SI #2#43 ! 0;
         #eosm0042#3 = #eosm0042#3 + #2#23;
         |SI #eosm0042#4 = 0; #eosm0042#4 = #2#40; |FINSI;
         #eosm0042#5 = #eosm0042#5 + #2#43;
      |FINSI;
      |SI #2#44 ! 0;
         #eosm0042#3 = #eosm0042#3 + #2#24;
         |SI #eosm0042#4 = 0; #eosm0042#4 = #2#41; |FINSI;
         #eosm0042#5 = #eosm0042#5 + #2#44;
      |FINSI;
   |FINSI;

   |SI TipoCmp = "E";
      |SI #2#42 ! 0;
         #eosm0042#6 = #eosm0042#6 + #2#7;
         |SI #eosm0042#7 = 0; #eosm0042#7 = #2#39; |FINSI;
         #eosm0042#8 = #eosm0042#8 + #2#42;
      |FINSI;
      |SI #2#43 ! 0;
         #eosm0042#6 = #eosm0042#6 + #2#23;
         |SI #eosm0042#7 = 0; #eosm0042#7 = #2#40; |FINSI;
         #eosm0042#8 = #eosm0042#8 + #2#43;
      |FINSI;
      |SI #2#44 ! 0;
         #eosm0042#6 = #eosm0042#6 + #2#24;
         |SI #eosm0042#7 = 0; #eosm0042#7 = #2#41; |FINSI;
         #eosm0042#8 = #eosm0042#8 + #2#44;
      |FINSI;
   |FINSI;

   |GRABA 020#eosm0042.a;
   |CIERRA #eosm0042;

|FPRC;

|PROCESO LineaCompra;
   |SI #2#19 ! activ; |ACABA; |FINSI;

   || Comparo la acotacion de conceptos de 2 digitos
   |PARA Cont2 = 43; |SI Cont2 [ 48; |HACIENDO Cont2 = Cont2 + 1;
      |SI #2#5  = #eoszp026#Cont2#; |Y #2#5 ! 0;
         TipoCmp = "D";
         |HAZ GrabaCompra;
         |SAL;
      |SINO;
         |SI #2#33 = #eoszp026#Cont2#; |Y #2#33 ! 0;
            TipoCmp = "D";
            |HAZ GrabaCompra;
            |SAL;
         |SINO;
            |SI #2#34 = #eoszp026#Cont2#; |Y #2#34 ! 0;
               TipoCmp = "D";
               |HAZ GrabaCompra;
               |SAL;
            |SINO;
               TipoCmp = " ";
            |FINSI;
         |FINSI;
      |FINSI;
   |SIGUE;

   |SI TipoCmp ! " "; |ACABA; |FINSI;

   |PARA Cont2 = 49; |SI Cont2 [ 54; |HACIENDO Cont2 = Cont2 + 1;
      |SI #2#5  = #eoszp026#Cont2#; |Y #2#5 ! 0;
         TipoCmp = "E";
         |HAZ GrabaCompra;
         |SAL;
      |SINO;
         |SI #2#33 = #eoszp026#Cont2#; |Y #2#33 ! 0;
            TipoCmp = "E";
            |HAZ GrabaCompra;
            |SAL;
         |SINO;
            |SI #2#34 = #eoszp026#Cont2#; |Y #2#34 ! 0;
               TipoCmp = "E";
               |HAZ GrabaCompra;
               |SAL;
            |FINSI;
         |FINSI;
      |FINSI;
   |SIGUE;

   || Comparo la acotacion de conceptos de 6 digitos
   |PARA Cont2 = 55; |SI Cont2 [ 60; |HACIENDO Cont2 = Cont2 + 1;
      |SI #2#72 = #eoszp026#Cont2#; |Y #2#72 ! "      ";
         TipoCmp = "D";
         |HAZ GrabaCompra;
         |SAL;
      |SINO;
         |SI #2#73 = #eoszp026#Cont2#; |Y #2#73 ! "      ";
            TipoCmp = "D";
            |HAZ GrabaCompra;
            |SAL;
         |SINO;
            |SI #2#74 = #eoszp026#Cont2#; |Y #2#74 ! "      ";
               TipoCmp = "D";
               |HAZ GrabaCompra;
               |SAL;
            |FINSI;
         |FINSI;
      |FINSI;
   |SIGUE;

   |PARA Cont2 = 61; |SI Cont2 [ 66; |HACIENDO Cont2 = Cont2 + 1;
      |SI #2#72 = #eoszp026#Cont2#; |Y #2#72 ! "      ";
         TipoCmp = "E";
         |HAZ GrabaCompra;
         |SAL;
      |SINO;
         |SI #2#73 = #eoszp026#Cont2#; |Y #2#73 ! "      ";
            TipoCmp = "E";
            |HAZ GrabaCompra;
            |SAL;
         |SINO;
            |SI #2#74 = #eoszp026#Cont2#; |Y #2#74 ! "      ";
               TipoCmp = "E";
               |HAZ GrabaCompra;
               |SAL;
            |FINSI;
         |FINSI;
      |FINSI;
   |SIGUE;
|FPRC;

|DEFBUCLE LineasCompras;
#2#1;
13;
#eoscabco#0,#eoscabco#4,00001,#0#41;
#eoscabco#0,#eoscabco#4,32000,#0#42;
be;
NULL,LineaCompra;
|FIN;

|PROCESO AbreCompras;
   Comodin = "00000" + #eoscabco#0;
   |QBF Comodin;
   Comodin = Comodin % -105;
   Comodin = "c" + Comodin + (("00" +#eoscabco#4) % -102);
   |NOME_DAT #2 Comodin;
   |ABRE #2;
   |BUCLE LineasCompras;
   |CIERRA #2;
|FPRC;

|PROCESO PasaCompras;

   |PARA Cont = 0; |SI Cont [ 19; |HACIENDO Cont = Cont + 1;
      Cont1 = Cont + 20;
      |SI #eoszp026#Cont# ! 0; |O #eoszp026#Cont1# ! 0;
         #eoscabco#0 = #eoszp026#Cont#;
         #eoscabco#4 = #eoszp026#40;
         |LEE 010#eoscabco.=;
         |SI FSalida = 0;
            activ = #eoszp026#Cont1#;
            |ABRE #eosm0042;
            |ABRE #eosm0041;
            |SI #eoscabco#4 ] 80;
               anyo1 = #eoscabco#4 + 1900;
            |SINO;
               anyo1 = #eoscabco#4 + 2000;
            |FINSI;
            |CIERRA #eosm0041;
            |CIERRA #eosm0042;
            |HAZ AbreCompras;
         |FINSI;
      |FINSI;
   |SIGUE;

|FPRC;

|| **************************************************************************
|| **************************** PASE DE VENTAS ******************************
|| **************************************************************************

|PROCESO GrabaVenta;
   |ABRE #eosclien;
   |ABRE #eosm0046;
   #eosm0046#0 = #3#0;
   |LEE 010#eosm0046.=;
   |SI FSalida = 0;
      TipoPer = #eosm0046#2;
   |SINO;
      |DDEFECTO #eosm0046;
      #eosm0046#0 = #3#0;
      #eosclien#0 = #3#0;
      |LEE 010#eosclien.=;
      #eosm0046#1 = #eosclien#2;
      |GRABA 020#eosm0046.n;
   |FINSI;
   |CIERRA #eosm0046;

   |ABRE #eosm0040;
   #eosm0040#0 = #3#0;
   #eosm0040#1 = #3#14;
   |SI #3#14 ] 80;
      #eosm0040#1 = #eosm0040#1 + 1900;
   |SINO;
      #eosm0040#1 = #eosm0040#1 + 2000;
   |FINSI;
   |LEE 010#eosm0040.=;
   |SI FSalida ! 0;
      |DDEFECTO #eosm0040;
      #eosm0040#0 = #3#0;
      #eosclien#0 = #3#0;
      |LEE 010#eosclien.=;
      #eosm0040#2 = #eosclien#2;
      #eosm0040#1 = #3#14;
      |SI #3#14 ] 80;
         #eosm0040#1 = #eosm0040#1 + 1900;
      |SINO;
         #eosm0040#1 = #eosm0040#1 + 2000;
      |FINSI;
      |GRABA 020#eosm0040.n;
   |FINSI;
   |CIERRA #eosm0040;
   |CIERRA #eosclien;

   |ABRE #eosm0041;
   #eosm0041#0 = #3#0;
   anyo = #3#14;
   |SI anyo ] 80; Comodin = "19"; |SINO; Comodin = "20"; |FINSI;
   Comodin = Comodin + anyo;
   anyo = Comodin;
   #eosm0041#1 = anyo;
   #eosm0041#2 = #3#12;
   |LEE 010#eosm0041.=;
   |SI FSalida ! 0;
      |DDEFECTO #eosm0041;
      #eosm0041#0 = #3#0;
      #eosm0041#1 = anyo;
      #eosm0041#2 = #3#12;
      |GRABA 020#eosm0041.b;
   |FINSI;
   #eosm0041#3 = #3#38;
   |GRABA 020#eosm0041.a;
   |CIERRA #eosm0041;

   |ABRE #eosm0042;
   #eosm0042#0 = #3#0;
   anyo = #3#14;
   |SI anyo ] 80; Comodin = "19"; |SINO; Comodin = "20"; |FINSI;
   Comodin = Comodin + anyo;
   anyo = Comodin;
   #eosm0042#1 = anyo;
   #eosm0042#2 = #3#12;
   #eosm0042#11 = 01;
   |LEE 010#eosm0042.=;
   |SI FSalida ! 0;
      |DDEFECTO #eosm0042;
      #eosm0042#0 = #3#0;
      #eosm0042#1 = anyo;
      #eosm0042#2 = #3#12;
      #eosm0042#11 = 01;
      |GRABA 020#eosm0042.b;
   |FINSI;

   || Si la retencion es dineraria , la creo como dineraria
   |SI TipoVnt = "D";
      |SI #3#42 ! 0;
         #eosm0042#3 = #eosm0042#3 + #3#7;
         |SI #eosm0042#4 = 0; #eosm0042#4 = #3#39; |FINSI;
         #eosm0042#5 = #eosm0042#5 + #3#42;
      |FINSI;
      |SI #3#43 ! 0;
         #eosm0042#3 = #eosm0042#3 + #3#23;
         |SI #eosm0042#4 = 0; #eosm0042#4 = #3#40; |FINSI;
         #eosm0042#5 = #eosm0042#5 + #3#43;
      |FINSI;
      |SI #3#44 ! 0;
         #eosm0042#3 = #eosm0042#3 + #3#24;
         |SI #eosm0042#4 = 0; #eosm0042#4 = #3#41; |FINSI;
         #eosm0042#5 = #eosm0042#5 + #3#44;
      |FINSI;
      |SI #3#69 ! 0;
         #eosm0042#3 = #eosm0042#3 + #3#45;
         |SI #eosm0042#4 = 0; #eosm0042#4 = #3#66; |FINSI;
         #eosm0042#5 = #eosm0042#5 + #3#69;
      |FINSI;
      |SI #3#70 ! 0;
         #eosm0042#3 = #eosm0042#3 + #3#46;
         |SI #eosm0042#4 = 0; #eosm0042#4 = #3#67; |FINSI;
         #eosm0042#5 = #eosm0042#5 + #3#70;
      |FINSI;
      |SI #3#71 ! 0;
         #eosm0042#3 = #eosm0042#3 + #3#47;
         |SI #eosm0042#4 = 0; #eosm0042#4 = #3#68; |FINSI;
         #eosm0042#5 = #eosm0042#5 + #3#71;
      |FINSI;
   |FINSI;

   |SI TipoVnt = "E";
      |SI #3#42 ! 0;
         #eosm0042#6 = #eosm0042#6 + #3#7;
         |SI #eosm0042#7 = 0; #eosm0042#7 = #3#39; |FINSI;
         #eosm0042#8 = #eosm0042#8 + #3#42;
      |FINSI;
      |SI #3#43 ! 0;
         #eosm0042#6 = #eosm0042#6 + #3#23;
         |SI #eosm0042#7 = 0; #eosm0042#7 = #3#40; |FINSI;
         #eosm0042#8 = #eosm0042#8 + #3#43;
      |FINSI;
      |SI #3#44 ! 0;
         #eosm0042#6 = #eosm0042#6 + #3#24;
         |SI #eosm0042#7 = 0; #eosm0042#7 = #3#41; |FINSI;
         #eosm0042#8 = #eosm0042#8 + #3#44;
      |FINSI;
      |SI #3#69 ! 0;
         #eosm0042#6 = #eosm0042#6 + #3#45;
         |SI #eosm0042#7 = 0; #eosm0042#7 = #3#66; |FINSI;
         #eosm0042#8 = #eosm0042#8 + #3#69;
      |FINSI;
      |SI #3#70 ! 0;
         #eosm0042#6 = #eosm0042#6 + #3#46;
         |SI #eosm0042#7 = 0; #eosm0042#7 = #3#67; |FINSI;
         #eosm0042#8 = #eosm0042#8 + #3#70;
      |FINSI;
      |SI #3#71 ! 0;
         #eosm0042#6 = #eosm0042#6 + #3#47;
         |SI #eosm0042#7 = 0; #eosm0042#7 = #3#68; |FINSI;
         #eosm0042#8 = #eosm0042#8 + #3#71;
      |FINSI;
   |FINSI;

||   |SI TipoPer = "T";
||      #eosm0042#9 = #3#17;
||   |SINO;
      Comodin = #3#4 % 0302;
      #eosm0042#9 = Comodin;
||   |FINSI;

   |GRABA 020#eosm0042.a;
   |CIERRA #eosm0042;

|FPRC;

|PROCESO LineaVenta;
   |SI #3#19 ! activ; |ACABA; |FINSI;

   || Comparo la acotacion de conceptos de 2 digitos
   |PARA Cont2 = 43; |SI Cont2 [ 48; |HACIENDO Cont2 = Cont2 + 1;
      |SI #3#5  = #eoszp026#Cont2#; |Y #3#5 ! 0;
         TipoVnt = "D";
         |HAZ GrabaVenta;
         |SAL;
      |SINO;
         |SI #3#33 = #eoszp026#Cont2#; |Y #3#33 ! 0;
            TipoVnt = "D";
            |HAZ GrabaVenta;
            |SAL;
         |SINO;
            |SI #3#34 = #eoszp026#Cont2#; |Y #3#34 ! 0;
               TipoVnt = "D";
               |HAZ GrabaVenta;
               |SAL;
            |SINO;
               |SI #3#57 = #eoszp026#Cont2#; |Y #3#57 ! 0;
                  TipoVnt = "D";
                  |HAZ GrabaVenta;
                  |SAL;
               |SINO;
                  |SI #3#58 = #eoszp026#Cont2#; |Y #3#58 ! 0;
                     TipoVnt = "D";
                     |HAZ GrabaVenta;
                     |SAL;
                  |SINO;
                     |SI #3#59 = #eoszp026#Cont2#; |Y #3#59 ! 0;
                        TipoVnt = "D";
                        |HAZ GrabaVenta;
                        |SAL;
                     |FINSI;
                  |FINSI;
               |FINSI;
            |FINSI;
         |FINSI;
      |FINSI;
   |SIGUE;

   |PARA Cont2 = 49; |SI Cont2 [ 54; |HACIENDO Cont2 = Cont2 + 1;
      |SI #3#5  = #eoszp026#Cont2#; |Y #3#5 ! 0;
         TipoVnt = "E";
         |HAZ GrabaVenta;
         |SAL;
      |SINO;
         |SI #3#33 = #eoszp026#Cont2#; |Y #3#33 ! 0;
            TipoVnt = "E";
            |HAZ GrabaVenta;
            |SAL;
         |SINO;
            |SI #3#34 = #eoszp026#Cont2#; |Y #3#34 ! 0;
               TipoVnt = "E";
               |HAZ GrabaVenta;
               |SAL;
            |SINO;
               |SI #3#57 = #eoszp026#Cont2#; |Y #3#57 ! 0;
                  TipoVnt = "E";
                  |HAZ GrabaVenta;
                  |SAL;
               |SINO;
                  |SI #3#58 = #eoszp026#Cont2#; |Y #3#58 ! 0;
                     TipoVnt = "E";
                     |HAZ GrabaVenta;
                     |SAL;
                  |SINO;
                     |SI #3#59 = #eoszp026#Cont2#; |Y #3#59 ! 0;
                        TipoVnt = "E";
                        |HAZ GrabaVenta;
                        |SAL;
                     |FINSI;
                  |FINSI;
               |FINSI;
            |FINSI;
         |FINSI;
      |FINSI;
   |SIGUE;

   || Comparo la acotacion de conceptos de 6 digitos
   |PARA Cont2 = 55; |SI Cont2 [ 60; |HACIENDO Cont2 = Cont2 + 1;
      |SI #3#72  = #eoszp026#Cont2#; |Y #3#72 ! "      ";
         TipoVnt = "D";
         |HAZ GrabaVenta;
         |SAL;
      |SINO;
         |SI #3#73 = #eoszp026#Cont2#; |Y #3#73 ! "      ";
            TipoVnt = "D";
            |HAZ GrabaVenta;
            |SAL;
         |SINO;
            |SI #3#74 = #eoszp026#Cont2#; |Y #3#74 ! "      ";
               TipoVnt = "D";
               |HAZ GrabaVenta;
               |SAL;
            |SINO;
               |SI #3#75 = #eoszp026#Cont2#; |Y #3#75 ! "      ";
                  TipoVnt = "D";
                  |HAZ GrabaVenta;
                  |SAL;
               |SINO;
                  |SI #3#76 = #eoszp026#Cont2#; |Y #3#76 ! "      ";
                     TipoVnt = "D";
                     |HAZ GrabaVenta;
                     |SAL;
                  |SINO;
                     |SI #3#77 = #eoszp026#Cont2#; |Y #3#77 ! "      ";
                        TipoVnt = "D";
                        |HAZ GrabaVenta;
                        |SAL;
                     |FINSI;
                  |FINSI;
               |FINSI;
            |FINSI;
         |FINSI;
      |FINSI;
   |SIGUE;

   |PARA Cont2 = 61; |SI Cont2 [ 66; |HACIENDO Cont2 = Cont2 + 1;
      |SI #3#72  = #eoszp026#Cont2#; |Y #3#72 ! "      ";
         TipoVnt = "E";
         |HAZ GrabaVenta;
         |SAL;
      |SINO;
         |SI #3#73 = #eoszp026#Cont2#; |Y #3#73 ! "      ";
            TipoVnt = "E";
            |HAZ GrabaVenta;
            |SAL;
         |SINO;
            |SI #3#74 = #eoszp026#Cont2#; |Y #3#74 ! "      ";
               TipoVnt = "E";
               |HAZ GrabaVenta;
               |SAL;
            |SINO;
               |SI #3#75 = #eoszp026#Cont2#; |Y #3#75 ! "      ";
                  TipoVnt = "E";
                  |HAZ GrabaVenta;
                  |SAL;
               |SINO;
                  |SI #3#76 = #eoszp026#Cont2#; |Y #3#76 ! "      ";
                     TipoVnt = "E";
                     |HAZ GrabaVenta;
                     |SAL;
                  |SINO;
                     |SI #3#77 = #eoszp026#Cont2#; |Y #3#77 ! "      ";
                        TipoVnt = "E";
                        |HAZ GrabaVenta;
                        |SAL;
                     |FINSI;
                  |FINSI;
               |FINSI;
            |FINSI;
         |FINSI;
      |FINSI;
   |SIGUE;
|FPRC;

|DEFBUCLE LineasVentas;
#3#1;
;
#eoscabve#0,#eoscabve#4,00001;
#eoscabve#0,#eoscabve#4,32000;
be;
NULL,LineaVenta;
|FIN;

|PROCESO AbreVentas;
   Comodin = "00000" + #eoscabve#0;
   |QBF Comodin;
   Comodin = Comodin % -105;
   Comodin = "v" + Comodin + #eoscabve#4;
   |NOME_DAT #3 Comodin;
   |ABRE #3;
   |BUCLE LineasVentas;
   |CIERRA #3;
|FPRC;

|PROCESO PasaVentas;

   |PARA Cont = 0; |SI Cont [ 19; |HACIENDO Cont = Cont + 1;
      Cont1 = Cont + 20;
      |SI #eoszp026#Cont# ! 0; |O #eoszp026#Cont1# ! 0;
         #eoscabve#0 = #eoszp026#Cont#;
         #eoscabve#4 = #eoszp026#40;
         |LEE 010#eoscabve.=;
         |SI FSalida = 0;
            activ = #eoszp026#Cont1#;
            |HAZ AbreVentas;
         |FINSI;
      |FINSI;
   |SIGUE;

|FPRC;

|PROGRAMA;
   Comodin = PARAMETRO % 0101;
   |CLS;
   |CABEZA "Pase desde libros a modelo 115";
   |PINPA #0#eoszp026;
   |PINDA #0#eoszp026;

   |ENDATOS #1#eoszp026;
   |SI FSalida ! 0; |ACABA; |FINSI;

   |SI #eoszp026#67 = "S";
      |BUCLE PonMarca;
   |FINSI;

   |ABRE #eoscabco;
   |HAZ PasaCompras;
   |CIERRA #eoscabco;

   |ABRE #eoscabve;
   |HAZ PasaVentas;
   |CIERRA #eoscabve;
|FPRO;
