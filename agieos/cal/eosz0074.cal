|FICHEROS;
     eosm0032;
     eosm0035;

     eosm0034;
     eosm0036;
     eosclien;
|FIN;

|VARIABLES;
     nCampo   = 0;
     nCamb    = 0;
     nEmpresa = 0;

     aAlfa    = "";
     a1Clave  = "";
     a2Clave  = "";
|FIN;

|PROCESO Acum111Normal;
     #eosm0035#07 = #eosm0035#07 + #eosm0032#07;
     #eosm0035#09 = #eosm0035#09 + #eosm0032#09;
     #eosm0035#10 = #eosm0035#10 + #eosm0032#10;
     #eosm0035#11 = #eosm0035#11 + #eosm0032#11;
     #eosm0035#12 = #eosm0035#12 + #eosm0032#12;
     #eosm0035#13 = #eosm0032#13;
|FPRC;

|PROCESO Acum111IT;
     #eosm0035#18 = #eosm0035#18 + #eosm0032#07;
     #eosm0035#20 = #eosm0035#20 + #eosm0032#09;
     #eosm0035#19 = (#eosm0035#20 / #eosm0035#18) * 100
     #eosm0035#21 = #eosm0035#21 + #eosm0032#10;
     #eosm0035#22 = #eosm0035#22 + #eosm0032#11;
     #eosm0035#23 = #eosm0035#23 + #eosm0032#12;
     #eosm0035#24 = #eosm0032#13;
|FPRC;

|PROCESO eosm0032;
     |SI nEmpresa ! #eosm0032#0;
         #eosclien#0 = #eosm0032#0;
         |LEE 000#eosclien.=;
         |SI FSalida ! 0;  |DDEFECTO #eosclien;  |FINSI;

         |SI nEmpresa = 0;
             aAlfa = "Empresa Nombre";
             |IMPRIME aAlfa;

             aAlfa = "-----------------------------------------------";
             |IMPRIME aAlfa;
         |FINSI;

         aAlfa = ("00000" + #eosm0032#0) % -105 + "   " + #eosclien#2;  |QBF aAlfa;
         |IMPRIME aAlfa;
     |FINSI;

     a1Clave = #eosm0032#3;
     a2Clave = #eosm0032#4;

     |SI #eosm0032#3 = "A";
         a2Clave = "";
     |FINSI;

     |SI #eosm0032#3 = "B";
         |SI #eosm0032#4 = "02";  a2Clave = "01";  |FINSI;
         |SI #eosm0032#4 = "03";  a2Clave = "02";  |FINSI;
         |SI #eosm0032#4 = "04";  a2Clave = "03";  |FINSI;
     |FINSI;

     #eosm0035#0  = #eosm0032#0;
     #eosm0035#1  = #eosm0032#1;
     #eosm0035#2  = #eosm0032#2;
     #eosm0035#3  = a1Clave;
     #eosm0035#4  = a2Clave;
     #eosm0035#5  = #eosm0032#5;
     #eosm0035#6  = #eosm0032#6;
     |LEE 101#eosm0035.=;
     |SI FSalida ! 0;
         |DDEFECTO #eosm0035;

         #eosm0035#0  = #eosm0032#0;
         #eosm0035#1  = #eosm0032#1;
         #eosm0035#2  = #eosm0032#2;
         #eosm0035#3  = a1Clave;
         #eosm0035#4  = a2Clave;
         #eosm0035#5  = #eosm0032#5;
         #eosm0035#6  = #eosm0032#6;

         |GRABA 020#eosm0035.b;
     |FINSI;

     |SI #eosm0032#3 = "A";
         |SI #eosm0032#4 = "01";  |HAZ Acum111Normal;  |FINSI;
         |SI #eosm0032#4 = "02";  |HAZ Acum111IT;      |FINSI;
     |SINO;
         |HAZ Acum111Normal;
     |FINSI;

     #eosm0035#14 = #eosm0035#14 + #eosm0032#14;
     #eosm0035#15 = #eosm0035#15 + #eosm0032#15;
     #eosm0035#16 = #eosm0035#16 + #eosm0032#16;
     #eosm0035#17 = #eosm0035#17 + #eosm0032#17;

     |GRABA 020#eosm0035.a;
     |LIBERA #eosm0035;

     |BORRA 020#eosm0032.a;
     |LIBERA #eosm0032;
|FPRC;

|DEFBUCLE eosm0032;
     #eosm0032#1;
     ;
     00000, 2016, "            ", " ", "  ", 0,    0;
     99999, 2016, "zzzzzzzzzzzz", "z", "zz", 9, 9999;
     be;
     NULL, eosm0032;
|FIN;

|PROCESO Pasa111;
     |PUSHV 0501 2380;
     |BLANCO 1320 1666;
     |CUADRO 1320 1666;
     |PINTA 1421, "GENERANDO DATOS MODELO 111 EJERCICIO 2016";

     |BUCLE eosm0032;

     |POPV;
|FPRC;

|PROCESO Acum190Normal;
     #eosm0036#07 = #eosm0036#07 + #eosm0034#07;
     #eosm0036#08 = #eosm0036#08 + #eosm0034#08;
     #eosm0036#09 = #eosm0036#09 + #eosm0034#09;
     #eosm0036#10 = #eosm0036#10 + #eosm0034#10;
     #eosm0036#11 = #eosm0036#11 + #eosm0034#11;
|FPRC;

|PROCESO Acum190IT;
     #eosm0036#63 = #eosm0036#63 + #eosm0034#07;
     #eosm0036#64 = #eosm0036#64 + #eosm0034#08;
     #eosm0036#65 = #eosm0036#65 + #eosm0034#09;
     #eosm0036#66 = #eosm0036#66 + #eosm0034#10;
     #eosm0036#67 = #eosm0036#67 + #eosm0034#11;
|FPRC;

|PROCESO eosm0034;
     a1Clave = #eosm0034#4;
     a2Clave = #eosm0034#5;

     |SI #eosm0034#4 = "A";
         a2Clave = "";
     |FINSI;

     |SI #eosm0034#4 = "B";
         |SI #eosm0034#5 = "02";  a2Clave = "01";  |FINSI;
         |SI #eosm0034#5 = "03";  a2Clave = "02";  |FINSI;
         |SI #eosm0034#5 = "04";  a2Clave = "03";  |FINSI;
     |FINSI;

     #eosm0036#0  = #eosm0034#0;
     #eosm0036#1  = #eosm0034#1;
     #eosm0036#2  = #eosm0034#2;
     #eosm0036#3  = #eosm0034#3;
     #eosm0036#4  = a1Clave;
     #eosm0036#5  = a2Clave;
     #eosm0036#6  = #eosm0034#6;
     |LEE 101#eosm0036.=;
     |SI FSalida ! 0;
         |DDEFECTO #eosm0036;

         #eosm0036#0  = #eosm0034#0;
         #eosm0036#1  = #eosm0034#1;
         #eosm0036#2  = #eosm0034#2;
         #eosm0036#3  = #eosm0034#3;
         #eosm0036#4  = a1Clave;
         #eosm0036#5  = a2Clave;
         #eosm0036#6  = #eosm0034#6;

         |PARA nCampo = 16;  |SI nCampo [ 62;  |HACIENDO nCampo = nCampo + 1;
               #eosm0036#nCampo# = #eosm0034#nCampo#;
         |SIGUE;

         |GRABA 020#eosm0036.b;
     |FINSI;

     |SI #eosm0034#4 = "A";
         |SI #eosm0034#5 = "01";  |HAZ Acum190Normal;  |FINSI;
         |SI #eosm0034#5 = "02";  |HAZ Acum190IT;      |FINSI;
     |SINO;
         |HAZ Acum190Normal;
     |FINSI;

     #eosm0036#12 = #eosm0036#12 + #eosm0034#12;
     #eosm0036#13 = #eosm0036#13 + #eosm0034#13;
     #eosm0036#14 = #eosm0036#14 + #eosm0034#14;
     #eosm0036#15 = #eosm0036#15 + #eosm0034#15;

     |GRABA 020#eosm0036.a;
     |LIBERA #eosm0036;

     |BORRA 020#eosm0034.a;
     |LIBERA #eosm0034;
|FPRC;

|DEFBUCLE eosm0034;
     #eosm0034#1;
     ;
     00000, 2016, "            ", 0000, " ", "  ", 0;
     99999, 2016, "zzzzzzzzzzzz", 9999, "z", "zz", 9;
     be;
     NULL, eosm0034;
|FIN;

|PROCESO Pasa190;
     |PUSHV 0501 2380;
     |BLANCO 1320 1666;
     |CUADRO 1320 1666;
     |PINTA 1421, "GENERANDO DATOS MODELO 190 EJERCICIO 2016";

     |BUCLE eosm0034;

     |POPV;
|FPRC;

|PROGRAMA;
     |MENAV "0000Seleccionamos una impresora para emitir las empresas afectadas";
     |IMPRE 0;
     nEmpresa = 0;

     |ABRE #eosclien;
     |ABRE #eosm0035;
     |ABRE #eosm0032;
     |SELECT #2#eosm0032;
     #eosm0032#1 = 2016;
     #eosm0032#0 = 1;
     |LEE 000#eosm0032.];
     |SI FSalida = 0;  |Y #eosm0032#1 = 2016;
         |HAZ Pasa111;
     |FINSI;
     |CIERRA #eosm0032;
     |CIERRA #eosm0035;

     |ABRE #eosm0036;
     |ABRE #eosm0034;
     |SELECT #3#eosm0034;
     #eosm0034#1 = 2016;
     #eosm0034#0 = 1;
     |LEE 000#eosm0034.];
     |SI FSalida = 0;  |Y #eosm0034#1 = 2016;
         |HAZ Pasa190;
     |FINSI;
     |CIERRA #eosm0034;
     |CIERRA #eosm0036;
     |CIERRA #eosclien;

     |FINIMP;
|FPRO;
