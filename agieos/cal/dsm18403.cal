|FICHEROS;
     dsm18403;
     dsm18401;
|FIN;

|VARIABLES;
   &enEmpresa = 0; &enEjer     = 0; &eaFichero = ""; &enCampo = 0;
   &eaTabla = "";  &enPosicion = 0; &eaDestino = ""; &enComp = 0;
   &eaAlfa  = "";  &enError    = 0; &enTotalCas = 0; &eaTitulo = "";

   nTipo  = 0;
   nLCod  = 0;
   nLDes  = 0;
   nCampo = 0;
   nCalc  = 0;

   aAlfa  = "";
   aAlfa1 = "";
   aAlfa2 = "";

   nFlag  = 0;

   {10} aPopup = "";
   nID         = 0;
   aID         = "";
|FIN;

|PROCESO T0C14F03;  |TIPO 0;
     |C_M #dsm18403#9,  1, "S";
     |C_M #dsm18403#10, 1, "S";

     |SI #dsm18403#14 ! 2;
         |C_M #dsm18403#9,  1, "N";  #dsm18403#9  = 0;
         |C_M #dsm18403#10, 1, "N";  #dsm18403#10 = 0;
     |FINSI;

     |PINTA #dsm18403#9;
     |PINTA #dsm18403#10;
|FPRC;

|PROCESO SacaPais03; |TIPO 7;
     eaTabla = "ztabla05.txt";
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompPais03;  |TIPO 0;
     |SI FSalida = 2; |ACABA; |FINSI;

     |SI FSalida = 10;
         enPosicion = 20;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 102;
         #dsm18403#Campo#  = aAlfa1;
         |PINTA #dsm18403#Campo#;
     |FINSI;

     enComp = 2;
     eaAlfa = #dsm18403#5;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |PULSATECLA;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 102;
     aAlfa2   = eaDestino % 330;
     #dsm18403#5     = aAlfa1;
     #dsm18403#11    = aAlfa2;

     |PINTA #dsm18403#5;
     |PINTA #dsm18403#11;

     |HAZ FinTabla;
|FPRC;

|PROCESO Calcula03;
   #dsm18403#8 = #dsm18403#6 - #dsm18403#7; |PINTA #dsm18403#8;
|FPRC;

|VARIABLES;
   aPais  = "";
   nLinea = 0;
   nSwError = 0;
|FIN;

|PROCESO Pais03;
   |SI FSalida = 2; |ACABA; |FINSI;

   |SI #dsm18403#5 = "  ";
      #dsm18403#5 = "ES"; |PINTA #dsm18403#5;
      #dsm18403#11 = "ESPA¥A"; |PINTA #dsm18403#11;
   |FINSI;
   aPais  = #dsm18403#5;
   nLinea = #dsm18403#3;
   nTipo  = #dsm18403#14;

   |SI #dsm18403#5 = "ES";
      #dsm18403#12 = "S"; |PINTA #dsm18403#12;
      |C_M #dsm18403#12,1,"N";
   |SINO;
      |C_M #dsm18403#12,1,"S";
   |FINSI;

   nSwError = 0;
   |SALVA_FICHA #dsm18403;
   #dsm18403#0 = #dsm18401#0;
   #dsm18403#1 = #dsm18401#1;
   #dsm18403#2 = #dsm18401#3;
   #dsm18403#3 = 1;
   |LEE 000#dsm18403.];
   |PARA; |SI FSalida = 0; |Y #dsm18403#0 = #dsm18401#0; |Y #dsm18403#1 = #dsm18401#1;
           |Y #dsm18403#2 = #dsm18401#3; |HACIENDO;
      aAlfa = #dsm18403#5;
      |SI aAlfa = aPais; |Y nTipo = #dsm18403#14; |Y #dsm18403#3 ! nLinea; |Y aPais ! "  "; nSwError = 1; |SAL; |FINSI;
      |LEE 000#dsm18403.s;
   |SIGUE;
   |REPON_FICHA #dsm18403;

   |SI nSwError ! 0;
      |MENAV "    Ya existe una linea de rdtos del capital mobiliario con ese Pais y Tipo";
      |ERROR;
      |HAZ SacaPais03;
   |FINSI;
|FPRC;

|PROCESO Tipo66C14;  |TIPO 66;
     aAlfa = "|C014WID";
     aID   = #dsm18403#aAlfa#;
     nID   = aID;

     aPopup1  = nID;  || Si fuera -1 en la posicion
     aPopup2  = 2;
     aPopup3  = "1- a la Base Imponible General (Art. 25.1, 2 y 3)";
     aPopup4  = "2- a la Base del Ahorro (Art. 25.4)";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 101;  #dsm18403#Campo# = aAlfa;
     |FINSI;
     |PINTA #dsm18403#Campo#;
|FPRC;
