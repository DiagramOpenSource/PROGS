|FICHEROS;
     dsm39001;
     dsm39002,MANTE;
     dsmow002;

     dsm39002@;
|FIN;

|VARIABLES;
     nCampo68    = 0;
     nCampo1     = 0;
     nCampo2     = 0;
     nCampo3     = 0;
     nCampo11    = 0;
     nCampo22    = 0;
     nCampo33    = 0;
     nValor1     = 0;
     nValor2     = 0;
     nGrupo      = 0;
     nSubGrupo   = 0;
     nPeriodoMin = 0;
     nEjerAnt    = 0;
     nSwAcum     = 0;
     nDesde      = 0;
     nHasta      = 0;
     nContador   = 0;
     nResult     = 0;
     nSwGraba    = 0;
     nAnyo       = 0;
     nPer        = 0;
     nTipo       = 0;
     nPeriodo    = 0;
     nDepar      = 0;
     nEjer       = 0;

     aAlfa       = "";
     aTecla      = "";
     nInkey      = 0;
     &nSwChequeo = 0;

     aBase       = "";
     aMas        = "";
     nCas1       = 0;
     nCas2       = 0;
|FIN;

|INCLUYE i_variar;

|| ///////////////// Procesos del Entlineal \\\\\\\\\\\\\\\\\\\\


|PROCESO LeeCasilla;
     #dsm39002#0   = #dsm39001#0;
     #dsm39002#1   = #dsm39001#1;
     #dsm39002#2   = #dsm39001#2;
     #dsm39002#3   = #dsm39001#3;
     #dsm39002#4  = nGrupo;
     #dsm39002#5  = nSubGrupo;
     |LEE 040#dsm39002.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsm39002;
     |SINO;
         |SI nGrupo = 3; |Y nSubGrupo ] 1; |Y nSubGrupo [ 14;
 ||            |SI #dsm39002#10 < 0;
 ||                |PDEFECTO #dsm39002, 10, 24;
 ||                |PDEFECTO #dsm39002, 26, 56;
 ||                |GRABA 020#dsm39002.a;
 ||            |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Chequeo_AIS;
     |ABRE #dsm39002;
     nGrupo    = 1;
     nSubGrupo = 6;
     |SI #dsm39001#1 ] 2014; nSubGrupo = 15; |FINSI;
     |HAZ LeeCasilla;

     nValor1   = 0;
     |SI #dsm39001#1 ] 2014;
         |SI #dsm39002#14 ! 0; |O #dsm39002#17 ! 0; |O #dsm39002#20 ! 0;
           |O #dsm39002#23 ! 0; |O #dsm39002#28 ! 0; |O #dsm39002#31 ! 0;
            |O #dsm39002#34 ! 0;
               nValor1 = 1;
         |FINSI;
     |SINO;
         |SI #dsm39002#37 ! 0; |O #dsm39002#40 ! 0; |O #dsm39002#43 ! 0;
           |O #dsm39002#46 ! 0; |O #dsm39002#49 ! 0; |O #dsm39002#52 ! 0;
             |O #dsm39002#55 ! 0;
                nValor1 = 1;
         |FINSI;
     |FINSI;

     nGrupo    = 2;
     nSubGrupo = 13;
     |HAZ LeeCasilla;
     nValor2   = 0;
     |SI #dsm39002#14 ! 0; |O #dsm39002#17 ! 0; |O #dsm39002#20 ! 0;
      |O #dsm39002#23 ! 0; |O #dsm39002#28 ! 0; |O #dsm39002#31 ! 0;
      |O #dsm39002#34 ! 0;
         nValor2 = 1;
     |FINSI;
     |CIERRA #dsm39002;

     |SI nValor1 = nValor2;  || Si en los dos hay importes
         |ACABA;             || o son los dos 0.
     |FINSI;

     |SI nValor1 = 1;
         aAlfa = "Hay IVA DEVENGADO por Adq.Intr.Serv. y no hay IVA Deducible por dichas operaciones.";
     |FINSI;

     |SI nValor2 = 1;
         aAlfa = "Hay IVA DEDUCIBLE por Adq.Intr.Serv. y no hay IVA Devengado por dichas operaciones.";
     |FINSI;

     aAlfa = "    " + aAlfa + ". Revisar.";
     |MENAV aAlfa;
|FPRC;

|PROCESO Total1_9;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 1;  nSubGrupo = 1;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 2;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 3;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 5;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 6;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 7;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 8;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 14;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 15;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     #dsm39002#0   = #dsm39001#0;
     #dsm39002#1   = #dsm39001#1;
     #dsm39002#2   = #dsm39001#2;
     #dsm39002#3   = #dsm39001#3;
     #dsm39002#4   = 1;
     #dsm39002#5   = 9;
     |LEE 101#dsm39002.=;
     |SI FSalida = 0;
         #dsm39002#10 = nValor1;
         #dsm39002#11 = nValor2;
         |GRABA 020#dsm39002.a;
         |LIBERA #dsm39002;
     |FINSI;
|FPRC;

|PROCESO Total1_13;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 1;  nSubGrupo = 9;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 10;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 11;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 12;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     #dsm39002#0  = #dsm39001#0;
     #dsm39002#1  = #dsm39001#1;
     #dsm39002#2  = #dsm39001#2;
     #dsm39002#3  = #dsm39001#3;
     #dsm39002#4  = 1;
     #dsm39002#5  = 13;
     |LEE 101#dsm39002.=;
     |SI FSalida = 0;
         #dsm39002#10 = nValor1;
         #dsm39002#11 = nValor2;
         |GRABA 020#dsm39002.a;
         |LIBERA #dsm39002;
     |FINSI;
|FPRC;

|PROCESO Total3_1;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 1;  nSubGrupo = 1;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 1;  nSubGrupo = 4;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     #dsm39002#0  = #dsm39001#0;
     #dsm39002#1  = #dsm39001#1;
     #dsm39002#2  = #dsm39001#2;
     #dsm39002#3  = #dsm39001#3;
     #dsm39002#4  = 3;
     #dsm39002#5  = 1;
     |LEE 101#dsm39002.=;
     |SI FSalida = 0;
         #dsm39002#10 = nValor1 + #dsm39002#11;
         |GRABA 020#dsm39002.a;
         |LIBERA #dsm39002;
     |FINSI;
|FPRC;

|PROCESO Total2_10;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 2;  nSubGrupo = 1;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 2;  nSubGrupo = 2;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 2;  nSubGrupo = 3;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 2;  nSubGrupo = 4;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 2;  nSubGrupo = 5;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 2;  nSubGrupo = 6;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 2;  nSubGrupo = 7;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 2;  nSubGrupo = 8;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 2;  nSubGrupo = 9;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     |SI #dsm39001#1 ] 2008;
         nGrupo    = 2;  nSubGrupo = 10;   |HAZ LeeCasilla;
         nValor1   = nValor1 + #dsm39002#10;
         nValor2   = nValor2 + #dsm39002#11;

         nGrupo    = 2;  nSubGrupo = 11;   |HAZ LeeCasilla;
         nValor1   = nValor1 + #dsm39002#10;
         nValor2   = nValor2 + #dsm39002#11;

         nGrupo    = 2;  nSubGrupo = 12;   |HAZ LeeCasilla;
         nValor1   = nValor1 + #dsm39002#10;
         nValor2   = nValor2 + #dsm39002#11;

         |SI #dsm39001#1 ] 2010;
             nGrupo    = 2;  nSubGrupo = 13;   |HAZ LeeCasilla;
             nValor1   = nValor1 + #dsm39002#10;
             nValor2   = nValor2 + #dsm39002#11;
         |FINSI;
    |SINO;
         #dsm39002#0  = #dsm39001#0;
         #dsm39002#1  = #dsm39001#1;
         #dsm39002#2  = #dsm39001#2;
         #dsm39002#3  = #dsm39001#3;
         #dsm39002#4  = 2;
         #dsm39002#5  = 10;
         |LEE 101#dsm39002.=;
         |SI FSalida = 0;
             #dsm39002#10 = nValor1;
             #dsm39002#11 = nValor2;
             |GRABA 020#dsm39002.a;
             |LIBERA #dsm39002;
         |FINSI;

         nGrupo    = 2;  nSubGrupo = 11;   |HAZ LeeCasilla;
         nValor1   = nValor1 - #dsm39002#10;
         nValor2   = nValor2 - #dsm39002#11;
    |FINSI;

     #dsm39002#0  = #dsm39001#0;
     #dsm39002#1  = #dsm39001#1;
     #dsm39002#2  = #dsm39001#2;
     #dsm39002#3  = #dsm39001#3;
     #dsm39002#4  = 2;
     |SI #dsm39001#1 [ 2007;  #dsm39002#5 = 12;  |FINSI;
     |SI #dsm39001#1 ] 2008;  #dsm39002#5 = 13;  |FINSI;
     |SI #dsm39001#1 ] 2010;  #dsm39002#5 = 14;  |FINSI;
     |LEE 101#dsm39002.=;
     |SI FSalida = 0;
         #dsm39002#10 = nValor1;
         #dsm39002#11 = nValor2;
         |GRABA 020#dsm39002.a;
         |LIBERA #dsm39002;
     |FINSI;
|FPRC;

|PROCESO Total3_15;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 3;  nSubGrupo = 1;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 2;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 3;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 4;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 5;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 6;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 7;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 8;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 9;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 10;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 11;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 12;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 13;   |HAZ LeeCasilla;
     nValor1   = nValor1 - #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 14;   |HAZ LeeCasilla;
     nValor1   = nValor1 - #dsm39002#10;

     #dsm39002#0  = #dsm39001#0;
     #dsm39002#1  = #dsm39001#1;
     #dsm39002#2  = #dsm39001#2;
     #dsm39002#3  = #dsm39001#3;
     #dsm39002#4  = 3;
     #dsm39002#5  = 15;
     |LEE 101#dsm39002.=;
     |SI FSalida = 0;
         #dsm39002#10 = nValor1;
         |GRABA 020#dsm39002.a;
         |LIBERA #dsm39002;
     |FINSI;
|FPRC;

|PROCESO Total1_9_2014;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 1;  nSubGrupo = 1;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 14;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 16;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 2;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 3;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 5;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 15;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 6;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 7;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 8;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 17;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     |SI #dsm39001#1 ] 2015;
         nGrupo    = 1;  nSubGrupo = 18;  |HAZ LeeCasilla;
         nValor1   = nValor1 + #dsm39002#10;
         nValor2   = nValor2 + #dsm39002#11;

         nGrupo    = 1;  nSubGrupo = 19;  |HAZ LeeCasilla;
         nValor1   = nValor1 + #dsm39002#10;
         nValor2   = nValor2 + #dsm39002#11;
     |FINSI;

     #dsm39002#0   = #dsm39001#0;
     #dsm39002#1   = #dsm39001#1;
     #dsm39002#2   = #dsm39001#2;
     #dsm39002#3   = #dsm39001#3;
     #dsm39002#4   = 1;
     #dsm39002#5   = 9;
     |LEE 101#dsm39002.=;
     |SI FSalida = 0;
         #dsm39002#10 = nValor1;
         #dsm39002#11 = nValor2;
         |GRABA 020#dsm39002.a;
         |LIBERA #dsm39002;
     |FINSI;
|FPRC;

|PROCESO Total1_13_2014;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 1;  nSubGrupo = 9;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 10;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 11;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 1;  nSubGrupo = 12;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     |SI #dsm39001#1 ] 2015;
         nGrupo    = 1;  nSubGrupo = 20;  |HAZ LeeCasilla;
         nValor1   = nValor1 + #dsm39002#10;
         nValor2   = nValor2 + #dsm39002#11;
     |FINSI;

     #dsm39002#0  = #dsm39001#0;
     #dsm39002#1  = #dsm39001#1;
     #dsm39002#2  = #dsm39001#2;
     #dsm39002#3  = #dsm39001#3;
     #dsm39002#4  = 1;
     #dsm39002#5  = 13;
     |LEE 101#dsm39002.=;
     |SI FSalida = 0;
         #dsm39002#10 = nValor1;
         #dsm39002#11 = nValor2;
         |GRABA 020#dsm39002.a;
         |LIBERA #dsm39002;
     |FINSI;
|FPRC;

|PROCESO Total3_1_2014;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 1;  nSubGrupo = 1;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 1;  nSubGrupo = 4;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     |SI #dsm39001#1 ] 2015;
         nGrupo    = 1;  nSubGrupo = 18;   |HAZ LeeCasilla;
         nValor1   = nValor1 + #dsm39002#10;
     |FINSI;

     #dsm39002#0  = #dsm39001#0;
     #dsm39002#1  = #dsm39001#1;
     #dsm39002#2  = #dsm39001#2;
     #dsm39002#3  = #dsm39001#3;
     #dsm39002#4  = 3;
     #dsm39002#5  = 1;
     |LEE 101#dsm39002.=;
     |SI FSalida = 0;
         #dsm39002#10 = nValor1 + #dsm39002#11;
         |GRABA 020#dsm39002.a;
         |LIBERA #dsm39002;
     |FINSI;
|FPRC;

|PROCESO Total2_10_2014;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 2;  nSubGrupo = 1;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 2;  nSubGrupo = 2;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 2;  nSubGrupo = 14;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 2;  nSubGrupo = 15;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 2;  nSubGrupo = 3;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 2;  nSubGrupo = 4;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 2;  nSubGrupo = 5;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 2;  nSubGrupo = 6;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 2;  nSubGrupo = 13;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 2;  nSubGrupo = 7;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 2;  nSubGrupo = 8;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 2;  nSubGrupo = 16;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 2;  nSubGrupo = 9;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     nGrupo    = 2;  nSubGrupo = 10;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;
     nValor2   = nValor2 + #dsm39002#11;

     |SI #dsm39001#1 ] 2015;
         nGrupo    = 2;  nSubGrupo = 17;  |HAZ LeeCasilla;
         nValor1   = nValor1 + #dsm39002#10;
         nValor2   = nValor2 + #dsm39002#11;
     |FINSI;

     |SI #dsm39001#1 ] 2018;
         nGrupo    = 2;  nSubGrupo = 18;  |HAZ LeeCasilla;
         nValor1   = nValor1 + #dsm39002#10;
         nValor2   = nValor2 + #dsm39002#11;
     |FINSI;

     #dsm39002#0  = #dsm39001#0;
     #dsm39002#1  = #dsm39001#1;
     #dsm39002#2  = #dsm39001#2;
     #dsm39002#3  = #dsm39001#3;
     #dsm39002#4  = 2;
     #dsm39002#5  = 12;
     |LEE 101#dsm39002.=;
     |SI FSalida = 0;
         #dsm39002#10 = nValor1;
         #dsm39002#11 = nValor2;
         |GRABA 020#dsm39002.a;
         |LIBERA #dsm39002;
     |FINSI;
|FPRC;

|PROCESO Total3_15_2014;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 3;  nSubGrupo = 1;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 17;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 09;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 16;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 10;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 11;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 12;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 4;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 7;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 2;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 3;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 8;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 5;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 6;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 13;   |HAZ LeeCasilla;
     nValor1   = nValor1 - #dsm39002#10;

     nGrupo    = 3;  nSubGrupo = 14;   |HAZ LeeCasilla;
     nValor1   = nValor1 - #dsm39002#10;

     #dsm39002#0  = #dsm39001#0;
     #dsm39002#1  = #dsm39001#1;
     #dsm39002#2  = #dsm39001#2;
     #dsm39002#3  = #dsm39001#3;
     #dsm39002#4  = 3;
     #dsm39002#5  = 15;
     |LEE 101#dsm39002.=;
     |SI FSalida = 0;
         #dsm39002#10 = nValor1;
         |GRABA 020#dsm39002.a;
         |LIBERA #dsm39002;
     |FINSI;
|FPRC;

|PROCESO Totales;
     |SELECT #1#dsm39002;
     |SI #dsm39001#1 [ 2013;
         |HAZ Total1_9;   || Total Bases y Cuotas I.V.A.
         |HAZ Total1_13;  || Total Bases y Cuotas I.V.A. y Recargo

         |HAZ Total3_1;   || Operaciones en Regimen General
         |HAZ Total2_10;  || Suma de Deducciones
         |HAZ Total3_15;  || Total Volumnen de Operaciones
     |FINSI;

     |SI #dsm39001#1 ] 2014;
         |HAZ Total1_9_2014;
         |HAZ Total1_13_2014;
         |HAZ Total3_1_2014;
         |HAZ Total2_10_2014;
         |HAZ Total3_15_2014;
     |FINSI;

     |SELECT #2#dsm39002;
     |SI enTipoEntrada ! 95;
           |PONCONTROL 23, "SI";
     |FINSI;
|FPRC;

|PROCESO Tipo7;  |TIPO 7;
     |PINTA #dsm39002#10;
     |PINTA #dsm39002#11;

     |SI #dsm39002#4 = 1; |Y #dsm39002#5 = 6; |Y #dsm39002#1 ] 2010;
         |MENSA "0000Introd. Bases y Cuotas: <F2> IVA devengado ISP, <F3> Adq.Intr.Servicios";
         |ACABA;
     |FINSI;

     |SI #dsm39002#9 = 2;
         |MENSA "     ";
     |FINSI;

     |SI #dsm39002#9 = 0;
         |MENSA "     Pulse <F2> para Introduccion de Bases y Cuotas";
     |FINSI;

     |SI #dsm39002#9 = 1;
         |MENSA "     Pulse <F2> para Introduccion del Importe";
     |FINSI;
|FPRC;

|PROCESO AlCaja;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/dsm39002";
     |CARGA_DEF aMas, dsm39002@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #dsm39002@;
     #dsm39002@#0 = #dsm39002#0;
     #dsm39002@#1 = #dsm39002#1;
     #dsm39002@#2 = #dsm39002#2;
     #dsm39002@#3 = #dsm39002#3;
     #dsm39002@#4 = nCas1;
     #dsm39002@#5 = nCas2;
     |LEE 101#dsm39002@.=;
     |SI FSalida = 0;
         |SI nCas1 = 3;
             #dsm39002@#10 = #dsm39002#10;
             |GRABA 020#dsm39002@.a;
         |FINSI;
         |SI nCas1 = 4;
             #dsm39002#10 = #dsm39002@#10;
         |FINSI;
         |LIBERA #dsm39002@;
     |FINSI;
     |CIERRA #dsm39002@;
     |DESCARGA_DEF #dsm39002@;
|FPRC;

|PROCESO Introduccion;  |TIPO 11;
     nInkey = FSalida;

     |SI nInkey ! 10; |Y  nInkey ! 11; |ACABA;  |FINSI;

     |SI nInkey = 11;
         |SI #dsm39002#4 ! 1; |O #dsm39002#5 ! 6;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI enTipoEntrada = 4;
         |SI #dsm39002#9 ! 0;
             |ACABA;
         |SINO;

              #dsmow002#0 = #dsm39002#6;
              |SI #dsm39002#4 = 1; |Y #dsm39002#5 = 6;
                  |SI nInkey = 10;
                      #dsmow002#0 = "IVA Devengado de Inversion del Sujeto Pasivo";
                  |SINO;
                      #dsmow002#0 = "Adquisiones Intracomunitarias de Servicios";
                  |FINSI;
              |FINSI;
              |SI nInkey = 10;
                  |PARA nCampo1 = 12;  |SI nCampo1 [ 23;  |HACIENDO nCampo1 = nCampo1 + 1;
                        nCampo2 = nCampo1 - 8;
                         #dsmow002#nCampo2# = #dsm39002#nCampo1#;
                   |SIGUE;
                   |PARA nCampo1 = 26;  |SI nCampo1 [ 34;  |HACIENDO nCampo1 = nCampo1 + 1;
                         nCampo2 = nCampo1 - 10;
                         #dsmow002#nCampo2# = #dsm39002#nCampo1#;
                   |SIGUE;
              |FINSI;

              |SI nInkey = 11;
                  |PARA nCampo1 = 35;  |SI nCampo1 [ 55;  |HACIENDO nCampo1 = nCampo1 + 1;
                        nCampo2 = nCampo1 - 31;
                         #dsmow002#nCampo2# = #dsm39002#nCampo1#;
                   |SIGUE;
              |FINSI;

              |PUSHV 0501 2380;
              |PINPA #0#dsmow002;
              |PINDA #0#dsmow002;
              |LEETECLA aTecla;

              |POPV;
          |FINSI;

          |ACABA;
     |FINSI;

     |LEE 101#dsm39002.=;

     |SI #dsm39002#9 = 0;
          #dsmow002#0 = #dsm39002#6;
          |SI #dsm39002#4 = 1; |Y #dsm39002#5 = 6;
              |SI nInkey = 10;
                  #dsmow002#0 = "IVA Devengado de Inversion del Sujeto Pasivo";
              |SINO;
                  #dsmow002#0 = "Adquisiones Intracomunitarias de Servicios";
               |FINSI;
          |FINSI;

          |SI nInkey = 10;
              |PARA nCampo1 = 12;  |SI nCampo1 [ 23;  |HACIENDO nCampo1 = nCampo1 + 1;
                    nCampo2 = nCampo1 - 8;
                    #dsmow002#nCampo2# = #dsm39002#nCampo1#;
              |SIGUE;
              |PARA nCampo1 = 26;  |SI nCampo1 [ 34;  |HACIENDO nCampo1 = nCampo1 + 1;
                    nCampo2 = nCampo1 - 10;
                    #dsmow002#nCampo2# = #dsm39002#nCampo1#;
              |SIGUE;
          |FINSI;
          |SI nInkey = 11;
              |PARA nCampo1 = 35;  |SI nCampo1 [ 55;  |HACIENDO nCampo1 = nCampo1 + 1;
                    nCampo2 = nCampo1 - 31;
                    #dsmow002#nCampo2# = #dsm39002#nCampo1#;
              |SIGUE;
          |FINSI;
          nSwChequeo = 1;
          |PUSHV 0501 2380;
          |PINPA #0#dsmow002;
          |PINDA #0#dsmow002;
          |ENDATOS #1#dsmow002;
          |SI FSalida = 0;

              |SI nInkey = 10;
                  |PARA nCampo1 = 12;  |SI nCampo1 [ 23;  |HACIENDO nCampo1 = nCampo1 + 1;
                        nCampo2 = nCampo1 - 8;
                        #dsm39002#nCampo1# = #dsmow002#nCampo2#;
                  |SIGUE;
                  |PARA nCampo1 = 26;  |SI nCampo1 [ 34;  |HACIENDO nCampo1 = nCampo1 + 1;
                        nCampo2 = nCampo1 - 10;
                        #dsm39002#nCampo1# = #dsmow002#nCampo2#;
                  |SIGUE;
              |FINSI;
              |SI nInkey = 11;
                  |PARA nCampo1 = 35;  |SI nCampo1 [ 55;  |HACIENDO nCampo1 = nCampo1 + 1;
                        nCampo2 = nCampo1 - 31;
                        #dsm39002#nCampo1# = #dsmow002#nCampo2#;
                  |SIGUE;
              |FINSI;
          |FINSI;

          |POPV;

          #dsm39002#10 = #dsm39002#12 + #dsm39002#15 + #dsm39002#18 + #dsm39002#21 + #dsm39002#26 + #dsm39002#29 + #dsm39002#32;
          #dsm39002#10 = #dsm39002#10 + #dsm39002#35 + #dsm39002#38 + #dsm39002#41 + #dsm39002#44 + #dsm39002#47 + #dsm39002#50 + #dsm39002#53;
          #dsm39002#11 = #dsm39002#14 + #dsm39002#17 + #dsm39002#20 + #dsm39002#23 + #dsm39002#28 + #dsm39002#31 + #dsm39002#34;
          #dsm39002#11 = #dsm39002#11 + #dsm39002#37 + #dsm39002#40 + #dsm39002#43 + #dsm39002#46 + #dsm39002#49 + #dsm39002#52 + #dsm39002#55;
     |FINSI;

     |SI #dsm39002#9 = 1;
          |SI #dsm39002#4 = 3;  |Y #dsm39002#5 = 1;
              |CONFI "0000NDesea introducir mas o menos importe a las Operaciones en Regimen General";
              |SI FSalida = 0;
                  |ENCAMPO #11#dsm39002;
              |FINSI;
          |SINO;
              |ENCAMPO #10#dsm39002;
          |FINSI;
     |FINSI;

     |SI #dsm39002#5 = 17; |Y #dsm39002#4 = 3;
         nCas1 = 4;
         nCas2 = 17;
         |HAZ AlCaja;
     |FINSI;

     |PINTA #dsm39002#10;
     |PINTA #dsm39002#11;

     |GRABA 020#dsm39002.a;
     |LIBERA #dsm39002;

     |SI #dsm39002#5 = 17; |Y #dsm39002#4 = 4;
         nCas1 = 3;
         nCas2 = 17;
         |HAZ AlCaja;
     |FINSI;

     |SALVA_DATOS #dsm39002;

     |HAZ Totales;

     |REPON_DATOS #dsm39002;

||     |LEE 040#dsm39002.=;
|FPRC;

|PROCESO Tipo5;  |TIPO 5;
     #dsm39002#0  = #dsm39001#0;
     #dsm39002#1  = #dsm39001#1;
     #dsm39002#2  = #dsm39001#2;
     #dsm39002#3  = #dsm39001#3;
     #dsm39002#24 = 1;
     #dsm39002#25 = 1;
     |LEE 040#dsm39002.];

     |LINEAS_BI_ATRI #dsm39002#7, N, I, -1;
|FPRC;
