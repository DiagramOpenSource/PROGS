|FICHEROS;
  eosfica1 #0,MANTE;
  eoscale1 #1;
  eosfical #2;
  eoscalen #3;
  eosveaut #4;
  eosconve #5;
|FIN;

|VARIABLES;
    nNume       = 0;
    FEstado     = 0;
    camp        = 0;
    conta       = 0;
    i           = 0;
    repa1       = 0;
    procesa     = "     Estoy procesando espere un poco Por Favor ";
    modifi      = "2330S Los Datos son correctos  S/N : ";
    errorfec1   = "     Fecha erronea DD/MM";
    errorfec2   = "     Fecha Hasta menor que la Fecha Desde";
    errorfec3   = "     No existe ese dia el a¤o no es bisiesto";
    anyomal     = "     A¤o erroneo";
    grabador    = " Estoy grabando ";
    reparto     = " Estoy repartiendo ";
    repart1     = " Estoy repartiendo el resto ";
    repart2     = "";
    swclave1    = 0;
    varalfa     = "";
    varalfa1    = "";
    varalfa2    = "";
    vardia      = 0;
    varmes      = 0;
    fechadesde  = "";
    fechadesde1 = "";
    fechadesde2 = "";
    fechahasta  = "";
    fechahasta1 = "";
    fechahasta2 = "";
    anu1        = "8512";
    anu2        = "8613";
    anu3        = "8714";
    anu4        = "8805";
    anu5        = "8917";
    anu6        = "9011";
    anu7        = "9112";
    anu8        = "9203";
    anu9        = "9315";
    anu10       = "9416";
    anu11       = "9517";
    anu12       = "9601";
    anu13       = "9713";
    anu14       = "9814";
    anu15       = "9915";
    anu16       = "0006";
    anu17       = "0111";
    anu18       = "0212";
    anu19       = "0313";
    anu20       = "0404";
    anu21       = "0516";
    anu22       = "0617";
    anu23       = "0711";
    anu24       = "0802";
    anu25       = "0914";
    anu26       = "1015";
    anu27       = "1116";
    anu28       = "1207";
    anu29       = "1312";
    anu30       = "1413";
    anu31       = "1514";
    anu32       = "1605";
    anu33       = "1717";
    anu34       = "1811";
    anu35       = "1912";
    anu36       = "2003";

    dia1        = 0;
    dia2        = 31;
    dia3        = 60;
    dia4        = 91;
    dia5        = 121;
    dia6        = 152;
    dia7        = 182;
    dia8        = 213;
    dia9        = 244;
    dia10       = 274;
    dia11       = 305;
    dia12       = 335;
    diapri      = "":
    Guardar     = 0;
    diapri1 = 0;
    mesdes = 0;
    meshast = 0;
    mesdes1 = "";
    meshast1 = "";
    diades = 0;
    diahast = 0;
    diades1 = "";
    diahast1 = "";
    varcamfecha = 0;
    bisiesto = "";
    swbis = 1;
    anyo = "";
    grabanyo = "";
    dd = 0;
    bucle  = 0;
    x = 0;
    y = 0;
    cero = 0;
    enero = "";
    febrero = "";
    marzo = "";
    abril = "";
    mayo = "";
    junio = "";
    julio = "";
    agosto = "";
    septiembre = "";
    octubre = "";
    noviembre = "";
    diciembre = "";
    suma = 0;
    swclave = 1;
    var = 0;
    indice = 0;
    swbis1 = 0;
    men1 = "2230N Modificar el Calendario S/N : "
    men2 = "    No existe Calendario";
    vacio = "                        ";
    p1 = "";
    cantidad = 0;
    canti  = 0;
    reparto1 = 0;
    dos = 2;
    rdon = 0;
    veces = 0;
    desv = 0;
    peso = 0;
    sumar = 0;
    total = 0;
    sumar1 = 0;
    sumar2 = 0;
    sumar3 = 0;
    sumar5 = 0;
    suma4 = 0;
    resto = 0;
    repa2 = 0;
    tpor = 0;
    rnd = 0.000000;
    alfapeso = "";
    pesoalfa = "";
    did = 0;
    num = 0;
    producto = 0.000000;
    producto1 = 0.000000;
    variable = 0;
    variable1 = 0;
    mod = "";
    mod1 = "";
    numero = 0;
    longi     = "";
    longi1    = "";
    modnum    = 0;
    alfapunto = "";
    nAsegura  = 0;
    &EURODB   = 0;

    {60}desde = "";
    {60}hasta = "";
    {61}pesofec = "";
    {366}cant = 0;
    {367}pesodia = 0;
    {-1}valfec = 0;
        valfec1 = 31;
        valfec2 = 29;
        valfec3 = 31;
        valfec4 = 30;
        valfec5 = 31;
        valfec6 = 30;
        valfec7 = 31;
        valfec8 = 31;
        valfec9 = 30;
        valfec10 = 31;
        valfec11 = 30;
        valfec12 = 31;

|FIN;

|PROCESO Decimales;  |TIPO 7;
     #5#7 = EURODB;
     |PINTA #5#7;
|FPRC;

|CALCULO ehnocero; |TIPO 0;
  |SI #5Campo = 0;
      |SI Campo = 4; |Y #5#7 = 2;
          #5Campo = 1 / 100;
      |SINO;
          #5Campo = 1;
      |FINSI;
      |PINTA #5Campo;
  |FINSI;
|FCAL;

|PROCESO  fechbien;|TIPO 0;        ||Calcula si la fecha es correcta;
valfec1 = 31; valfec2  = 29; valfec3  = 31; valfec4  = 30;
valfec5 = 31; valfec6  = 30; valfec7  = 31; valfec8  = 31;
valfec9 = 30; valfec10 = 31; valfec11 = 30; valfec12 = 31;

varalfa = #0Campo;
|SI varalfa = "    "; |ACABA; |FINSI;

|SI varalfa = "2902";|Y swbis = 1;
       |MENAV errorfec3;
       |ERROR;
       |ACABA;
|FINSI;

varalfa1 = varalfa / 2;
varalfa2 = varalfa % A302;
vardia = varalfa1;
varmes = varalfa2;
|SI varmes [ 0;|O varmes > 12;
    |MENAV errorfec1;
    |ERROR;
    |ACABA;
|FINSI;

Ivalfec = valfec1 <-;
Ivalfec = Ivalfec + varmes;
Ivalfec = Ivalfec - 1;
|SI vardia > valfec;|O vardia [ 0;
    |MENAV errorfec1;
    |ERROR;
|FINSI;
|FPRC;
                    ||Calcula si la fecha desde es mayor a la fecha desde;
|PROCESO desdefec;|TIPO 0;
camp        = Campo - 1;
fechadesde  = #0camp;
fechadesde1 = fechadesde % A302;
fechadesde2 = fechadesde % A102;
fechadesde  = fechadesde1 + fechadesde2;
fechahasta  = #0Campo;
fechahasta1 = fechahasta % A302;
fechahasta2 = fechahasta % A102;
fechahasta  = fechahasta1 + fechahasta2
|SI fechadesde > fechahasta;
       |MENAV errorfec2;
       |ERROR;
|FINSI;
|FPRC;

|PROCESO anyo;|TIPO 0;
     nNume = #0#1;
     |SI nNume < 1985;  |O nNume > 2020;
         |MENAV anyomal;
         |ERROR;
     |FINSI;

|SI #0#1 = "1985"; anyo = anu1;  |FINSI;
|SI #0#1 = "1986"; anyo = anu2;  |FINSI;
|SI #0#1 = "1987"; anyo = anu3;  |FINSI;
|SI #0#1 = "1988"; anyo = anu4;  |FINSI;
|SI #0#1 = "1989"; anyo = anu5;  |FINSI;
|SI #0#1 = "1990"; anyo = anu6;  |FINSI;
|SI #0#1 = "1991"; anyo = anu7;  |FINSI;
|SI #0#1 = "1992"; anyo = anu8;  |FINSI;
|SI #0#1 = "1993"; anyo = anu9;  |FINSI;
|SI #0#1 = "1994"; anyo = anu10; |FINSI;
|SI #0#1 = "1995"; anyo = anu11; |FINSI;
|SI #0#1 = "1996"; anyo = anu12; |FINSI;
|SI #0#1 = "1997"; anyo = anu13; |FINSI;
|SI #0#1 = "1998"; anyo = anu14; |FINSI;
|SI #0#1 = "1999"; anyo = anu15; |FINSI;
|SI #0#1 = "2000"; anyo = anu16; |FINSI;
|SI #0#1 = "2001"; anyo = anu17; |FINSI;
|SI #0#1 = "2002"; anyo = anu18; |FINSI;
|SI #0#1 = "2003"; anyo = anu19; |FINSI;
|SI #0#1 = "2004"; anyo = anu20; |FINSI;
|SI #0#1 = "2005"; anyo = anu21; |FINSI;
|SI #0#1 = "2006"; anyo = anu22; |FINSI;
|SI #0#1 = "2007"; anyo = anu23; |FINSI;
|SI #0#1 = "2008"; anyo = anu24; |FINSI;
|SI #0#1 = "2009"; anyo = anu25; |FINSI;
|SI #0#1 = "2010"; anyo = anu26; |FINSI;
|SI #0#1 = "2011"; anyo = anu27; |FINSI;
|SI #0#1 = "2012"; anyo = anu28; |FINSI;
|SI #0#1 = "2013"; anyo = anu29; |FINSI;
|SI #0#1 = "2014"; anyo = anu30; |FINSI;
|SI #0#1 = "2015"; anyo = anu31; |FINSI;
|SI #0#1 = "2016"; anyo = anu32; |FINSI;
|SI #0#1 = "2017"; anyo = anu33; |FINSI;
|SI #0#1 = "2018"; anyo = anu34; |FINSI;
|SI #0#1 = "2019"; anyo = anu35; |FINSI;
|SI #0#1 = "2020"; anyo = anu36; |FINSI;

grabanyo = #0#1;
                          ||Calcular si es o no anyo bisiesto;
swbis    = 0;
bisiesto = anyo % 301;
|SI bisiesto = "1"; swbis = 1; |FINSI;
|FPRC;

|PROCESO peso;
|HAZ peso1;
|BLIN 23;
|HAZ limpia;
|FPRC;

|PROCESO peso1;
|PINTA 2330,procesa;
swclave = 0;

                          ||Calcular primer dia del anyo;
diapri = anyo % A401;
diapri1 = diapri;         ||Pone a numerica diapri;

|SI diapri = 1;           ||Si el primer dia es lunes;
    dd = 0;      indice = dd;  |HAZ lunes;
    dd = dd + 1; indice = dd;  |HAZ martes;
    dd = dd + 1; indice = dd;  |HAZ miercoles;
    dd = dd + 1; indice = dd;  |HAZ jueves;
    dd = dd + 1; indice = dd;  |HAZ viernes;
    dd = dd + 1; indice = dd;  |HAZ sabado;
    dd = dd + 1; indice = dd;  |HAZ domingo;
|FINSI;

|SI diapri = 2;     ||Si el primer dia es martes;
    dd = 0;
    indice = 1;  indice = dd; |HAZ martes;
    dd = dd + 1; indice = dd; |HAZ miercoles;
    dd = dd + 1; indice = dd; |HAZ jueves;
    dd = dd + 1; indice = dd; |HAZ viernes;
    dd = dd + 1; indice = dd; |HAZ sabado;
    dd = dd + 1; indice = dd; |HAZ domingo;
    dd = dd + 1; indice = dd; |HAZ lunes;
|FINSI;

|SI diapri = 3;      ||Si el primer dia es el miercoles;
    dd = 0;
    indice = 1;  indice = dd; |HAZ miercoles;
    dd = dd + 1; indice = dd; |HAZ jueves;
    dd = dd + 1; indice = dd; |HAZ viernes;
    dd = dd + 1; indice = dd; |HAZ sabado;
    dd = dd + 1; indice = dd; |HAZ domingo;
    dd = dd + 1; indice = dd; |HAZ lunes;
    dd = dd + 1; indice = dd; |HAZ martes;
|FINSI;

|SI diapri = 4;      ||Si el primer dia es el jueves;
    dd = 0;
    indice = 1;  indice = dd; |HAZ jueves;
    dd = dd + 1; indice = dd; |HAZ viernes;
    dd = dd + 1; indice = dd; |HAZ sabado;
    dd = dd + 1; indice = dd; |HAZ domingo;
    dd = dd + 1; indice = dd; |HAZ lunes;
    dd = dd + 1; indice = dd; |HAZ martes;
    dd = dd + 1; indice = dd; |HAZ miercoles;
|FINSI;

|SI diapri = 5;       ||Si el primer dia es el viernes;
    dd = 0;
    indice = 1;  indice = dd; |HAZ viernes;
    dd = dd + 1; indice = dd; |HAZ sabado;
    dd = dd + 1; indice = dd; |HAZ domingo;
    dd = dd + 1; indice = dd; |HAZ lunes;
    dd = dd + 1; indice = dd; |HAZ martes;
    dd = dd + 1; indice = dd; |HAZ miercoles;
    dd = dd + 1; indice = dd; |HAZ jueves;
|FINSI;

|SI diapri = 6;         ||Si el primer dia es sabado;
    dd = 0;
    indice = 1;  indice = dd; |HAZ sabado;
    dd = dd + 1; indice = dd; |HAZ domingo;
    dd = dd + 1; indice = dd; |HAZ lunes;
    dd = dd + 1; indice = dd; |HAZ martes;
    dd = dd + 1; indice = dd; |HAZ miercoles;
    dd = dd + 1; indice = dd; |HAZ jueves;
    dd = dd + 1; indice = dd; |HAZ viernes;
|FINSI;

|SI diapri = 7;        ||Si el primer dia es domingo;
    dd = 0;
    indice = 1;  indice = dd;  |HAZ domingo;
    dd = dd + 1; indice = dd;  |HAZ lunes;
    dd = dd + 1; indice = dd;  |HAZ martes;
    dd = dd + 1; indice = dd;  |HAZ miercoles;
    dd = dd + 1; indice = dd;  |HAZ jueves;
    dd = dd + 1; indice = dd;  |HAZ viernes;
    dd = dd + 1; indice = dd;  |HAZ sabado;
|FINSI;
Ipesodia = Ipesodia + 1;
pesodia  = 0;
|HAZ fechas;              ||PROCESO para cargar pesos de fecha a fecha;

                          ||Carga los pesos de enero;
Ipesodia = pesodia1 <-;
|PARA bucle = 0;|SI bucle < 31;|HACIENDO bucle = bucle + 1;
     alfapeso =  pesodia;
     enero    = enero + alfapeso;
     Ipesodia = Ipesodia + 1;
|SIGUE;

                 ||Carga los peso de febrero ;
|PARA bucle = 0;|SI bucle < 29;|HACIENDO bucle = bucle + 1;
     alfapeso =  pesodia;
     febrero  = febrero + alfapeso;
     Ipesodia = Ipesodia + 1;
|SIGUE;

|| Carga los pesos de marzo;
|PARA bucle = 0;|SI bucle < 31;|HACIENDO bucle = bucle + 1;
     alfapeso =  pesodia;
     marzo    = marzo + alfapeso;
     Ipesodia = Ipesodia + 1;
|SIGUE;

|| Carga los pesos de abril;
|PARA bucle = 0;|SI bucle < 30;|HACIENDO bucle = bucle + 1;
     alfapeso =  pesodia;
     abril    = abril + alfapeso;
     Ipesodia = Ipesodia + 1;
|SIGUE;

|| Carga los pesos de mayo;
|PARA bucle = 0;|SI bucle < 31;|HACIENDO bucle = bucle + 1;
     alfapeso =  pesodia;
     mayo     = mayo + alfapeso;
     Ipesodia = Ipesodia + 1;
|SIGUE;

|| Carga los pesos de junio;
|PARA bucle = 0;|SI bucle < 30;|HACIENDO bucle = bucle + 1;
     alfapeso =  pesodia;
     junio    = junio + alfapeso;
     Ipesodia = Ipesodia + 1;
|SIGUE;

|| Carga los pesos de julio;
|PARA bucle = 0;|SI bucle < 31;|HACIENDO bucle = bucle + 1;
     alfapeso =  pesodia;
     julio    = julio + alfapeso;
     Ipesodia = Ipesodia + 1;
|SIGUE;

|| Carga los pesos de agosto;
|PARA bucle = 0;|SI bucle < 31;|HACIENDO bucle = bucle + 1;
     alfapeso =  pesodia;
     agosto   = agosto + alfapeso;
     Ipesodia = Ipesodia + 1;
|SIGUE;

|| Carga los pesos de septiembre;
|PARA bucle = 0;|SI bucle < 30;|HACIENDO bucle = bucle + 1;
     alfapeso   =  pesodia;
     septiembre = septiembre + alfapeso;
     Ipesodia   = Ipesodia + 1;
|SIGUE;

|| Carga los pesos de octubre;
|PARA bucle = 0;|SI bucle < 31;|HACIENDO bucle = bucle + 1;
     alfapeso =  pesodia;
     octubre  = octubre + alfapeso;
     Ipesodia = Ipesodia + 1;
|SIGUE;

|| Carga los pesos de noviembre;
|PARA bucle = 0;|SI bucle < 30;|HACIENDO bucle = bucle + 1;
     alfapeso  =  pesodia;
     noviembre = noviembre + alfapeso;
     Ipesodia  = Ipesodia + 1;
|SIGUE;

|| Carga los pesos de diciembre;
|PARA bucle = 0;|SI bucle < 31;|HACIENDO bucle = bucle + 1;
     alfapeso  =  pesodia;
     diciembre = diciembre + alfapeso;
     Ipesodia  = Ipesodia + 1;
|SIGUE;

#1#0  = #0#0;
|LIBERA #1;
|LEE 140#1=;
FEstado = FSalida;

#1#0  = #0#0;
#1#1  = enero;                 ||Introduce en los campos los resultados;
#1#2  = febrero;
#1#3  = marzo;
#1#4  = abril;
#1#5  = mayo;
#1#6  = junio;
#1#7  = julio;
#1#8  = agosto;
#1#9  = septiembre;
#1#10 = octubre;
#1#11 = noviembre;
#1#12 = diciembre;
#1#13 = #0#1;
|SI FEstado = 0; |GRABA 140#1a; |SINO; |GRABA 140#1n; |FINSI;
|LIBERA #1;
|FPRC;

|PROCESO lunes;           ||Introducir los pesos del lunes;
swbis1   = 0;
conta    = 0;
Ipesodia = pesodia1 <-;
Ipesodia = Ipesodia + dd ;

|ET proceso1;
    |SI indice = 59;|Y swbis = 1;
        pesodia  = 0;
        Ipesodia = Ipesodia + 1;
        indice   = indice + 1;
        swbis1   = 1;
    |FINSI;

    |SI indice > 59;|Y swbis = 1;|Y swbis1 = 0;
        Ipesodia = Ipesodia + 1;
        indice   = indice + 1;
        swbis1   = 1;
    |FINSI;

    pesodia  = #0#2;
    conta    = conta + 7;
    Ipesodia = Ipesodia + 7;
    indice   = indice + 7;

    |SI conta [ 366; |VETE proceso1; |FINSI;
|FPRC;

|PROCESO martes;          ||Introducir los pesos del martes;
swbis1   = 0;
conta    = 0;
Ipesodia = pesodia1 <-;
Ipesodia = Ipesodia + dd;

|ET proceso2;
    |SI indice = 59;|Y swbis = 1;
        pesodia  = 0;
        Ipesodia = Ipesodia + 1;
        indice   = indice + 1;
        swbis1   = 1;
    |FINSI;

    |SI indice > 59;|Y swbis = 1;|Y swbis1 = 0;
        Ipesodia = Ipesodia + 1;
        indice   = indice + 1;
        swbis1   = 1;
    |FINSI;

    pesodia  = #0#3;
    conta    = conta + 7;
    Ipesodia = Ipesodia + 7;
    indice   = indice + 7;

    |SI conta [ 366;  |VETE proceso2;  |FINSI;
|FPRC;

|PROCESO miercoles;       ||Introducir los pesos del miercoles;
swbis1   = 0;
conta    = 0;
Ipesodia = pesodia1 <-;
Ipesodia = Ipesodia + dd;

|ET proceso3;
    |SI indice = 59;|Y swbis = 1;
        pesodia  = 0;
        Ipesodia = Ipesodia + 1;
        indice   = indice + 1;
        swbis1   = 1;
     |FINSI;

     |SI indice > 59;|Y swbis = 1;|Y swbis1 = 0;
         Ipesodia = Ipesodia + 1;
         indice   = indice + 1;
         swbis1   = 1;
     |FINSI;

     pesodia  = #0#4;
     conta    = conta + 7;
     Ipesodia = Ipesodia + 7;
     indice   = indice + 7;

     |SI conta [ 366;  |VETE proceso3;  |FINSI;
|FPRC;

|PROCESO jueves;          ||Introducir los pesos del jueves;
swbis1   = 0;
conta    = 0;
Ipesodia = pesodia1 <-;
Ipesodia = Ipesodia + dd;

|ET proceso4;
    |SI indice = 59;|Y swbis = 1;
        pesodia  = 0;
        Ipesodia = Ipesodia + 1;
        indice   = indice + 1;
        swbis1   = 1;
    |FINSI;

    |SI indice > 59;|Y swbis = 1;|Y swbis1 = 0;
        Ipesodia = Ipesodia + 1;
        indice   = indice + 1;
        swbis1   = 1;
    |FINSI;

    pesodia  = #0#5;
    conta    = conta + 7;
    Ipesodia = Ipesodia + 7;
    indice   = indice + 7;

    |SI conta [ 366; |VETE proceso4; |FINSI;
|FPRC;

|PROCESO viernes;             ||Introducir los pesos del viernes;
swbis1   = 0;
conta    = 0;
Ipesodia = pesodia1 <-;
Ipesodia = Ipesodia + dd;

|ET proceso5;
    |SI indice = 59;|Y swbis = 1;
        pesodia  = 0;
        Ipesodia = Ipesodia + 1;
        indice   = indice + 1;
        swbis1   = 1;
     |FINSI;

     |SI indice > 59;|Y swbis = 1;|Y swbis1 = 0;
         Ipesodia = Ipesodia + 1;
         indice   = indice + 1;
         swbis1   = 1;
     |FINSI;

     pesodia  = #0#6;
     conta    = conta + 7;
     Ipesodia = Ipesodia + 7;
     indice   = indice + 7;

     |SI conta [ 366;  |VETE proceso5;  |FINSI;
|FPRC;

|PROCESO sabado;            ||Introducir los pesos del sabado;
swbis1   = 0;
conta    = 0;
Ipesodia = pesodia1 <-;
Ipesodia = Ipesodia + dd;

|ET proceso6;
    |SI indice = 59;|Y swbis = 1;
        pesodia  = 0;
        Ipesodia = Ipesodia + 1;
        indice   = indice + 1;
        swbis1   = 1;
    |FINSI;

    |SI indice > 59;|Y swbis = 1;|Y swbis1 = 0;
        Ipesodia = Ipesodia + 1;
        indice   = indice + 1;
        swbis1   = 1;
    |FINSI;

    pesodia  = #0#7;
    conta    = conta + 7;
    Ipesodia = Ipesodia + 7;
    indice   = indice + 7;

    |SI conta [ 366;  |VETE proceso6;  |FINSI;
|FPRC;

|PROCESO domingo;            ||Introducir los pesos del domingo;
swbis1   = 0;
conta    = 0;
Ipesodia = pesodia1 <-;
Ipesodia = Ipesodia + dd;

|ET proceso7;
    |SI indice = 59;|Y swbis = 1;
        pesodia  = 0;
        Ipesodia = Ipesodia + 1;
        indice   = indice + 1;
        swbis1   = 1;
    |FINSI;

    |SI indice > 59;|Y swbis = 1;|Y swbis1 = 0;
        Ipesodia = Ipesodia + 1;
        indice   = indice + 1;
        swbis1   = 1;
    |FINSI;

   pesodia  = #0#8;
   conta    = conta + 7;
   Ipesodia = Ipesodia + 7;
   indice   = indice + 7;

   |SI conta [ 366;  |VETE proceso7;  |FINSI;
|FPRC;

|PROCESO fechas;         ||Carga desde fecha a fecha y de dia a dia;
varcamfecha = 9;
Idesde      = desde1 <-;
                                            ||Carga en puteros los desde;
|PARA y = 0; |SI y < 30; |HACIENDO y = y + 1;
      desde       = #0varcamfecha;
      varcamfecha = varcamfecha + 3;
      Idesde      = Idesde + 1;
|SIGUE;
varcamfecha = 99;
                                            ||Carga en puteros los dias;
|PARA x = 30;|SI x < 60;|HACIENDO x = x + 1;
     desde       = #0varcamfecha;
     varcamfecha = varcamfecha + 2;
     Idesde      = Idesde + 1;
|SIGUE;

varcamfecha = 10;
Ihasta = hasta1 <-;
|PARA x = 0;|SI x < 30;|HACIENDO x = x + 1;
      hasta       = #0varcamfecha;
      varcamfecha = varcamfecha + 3;
      Ihasta      = Ihasta + 1;
|SIGUE;

varcamfecha = 99;
|PARA x = 30;|SI x < 60;|HACIENDO x = x + 1;
      hasta       = #0varcamfecha;
      varcamfecha = varcamfecha + 2;
      Ihasta      = Ihasta + 1;
|SIGUE;

varcamfecha = 11;
Ipesofec = pesofec1 <-;   ||Carga en puntero los pesos de las fechas;
|PARA x = cero;|SI x < 30;|HACIENDO x = x + 1;
      pesofec     = #0varcamfecha;
      varcamfecha = varcamfecha + 3;
      Ipesofec    = Ipesofec + 1;
|SIGUE;

varcamfecha = 100;         ||Carga en puteros los pesos de los dias;
|PARA x = 30;|SI x < 60;|HACIENDO x = x + 1;
      pesofec     = #0varcamfecha;
      varcamfecha = varcamfecha + 2;
      Ipesofec    = Ipesofec + 1;
|SIGUE;

Ipesofec = Ipesofec + 1;
pesofec  = 0;
Ipesodia = pesodia1 <-;
Idesde   = desde1 <-;
Ihasta   = hasta1 <-;
Ipesofec = pesofec1 <-;     ||   Introduce pesos de fechas y dias;
|PARA x = cero;|SI x < 60;|HACIENDO x = x + 1;
     |SI desde = "    ";  |VETE seguir; |FINSI;
     diades1  = desde % A102;
     diahast1 = hasta % A102;
     diades   = diades1;          ||Controla el dia del desde;
     diahast  = diahast1;         ||Controla el dia del hasta;
     mesdes1  = desde % A302;
     meshast1 = hasta % A302;
                                  ||Controla el mes del desde;
     |SI mesdes1 = "01"; mesdes = dia1;  |FINSI;
     |SI mesdes1 = "02"; mesdes = dia2;  |FINSI;
     |SI mesdes1 = "03"; mesdes = dia3;  |FINSI;
     |SI mesdes1 = "04"; mesdes = dia4;  |FINSI;
     |SI mesdes1 = "05"; mesdes = dia5;  |FINSI;
     |SI mesdes1 = "06"; mesdes = dia6;  |FINSI;
     |SI mesdes1 = "07"; mesdes = dia7;  |FINSI;
     |SI mesdes1 = "08"; mesdes = dia8;  |FINSI;
     |SI mesdes1 = "09"; mesdes = dia9;  |FINSI;
     |SI mesdes1 = "10"; mesdes = dia10; |FINSI;
     |SI mesdes1 = "11"; mesdes = dia11; |FINSI;
     |SI mesdes1 = "12"; mesdes = dia12; |FINSI;

                                   ||controla el mes del hasta;
     |SI meshast1 = "01"; meshast = dia1;  |FINSI;
     |SI meshast1 = "02"; meshast = dia2;  |FINSI;
     |SI meshast1 = "03"; meshast = dia3;  |FINSI;
     |SI meshast1 = "04"; meshast = dia4;  |FINSI;
     |SI meshast1 = "05"; meshast = dia5;  |FINSI;
     |SI meshast1 = "06"; meshast = dia6;  |FINSI;
     |SI meshast1 = "07"; meshast = dia7;  |FINSI;
     |SI meshast1 = "08"; meshast = dia8;  |FINSI;
     |SI meshast1 = "09"; meshast = dia9;  |FINSI;
     |SI meshast1 = "10"; meshast = dia10; |FINSI;
     |SI meshast1 = "11"; meshast = dia11; |FINSI;
     |SI meshast1 = "12"; meshast = dia12; |FINSI;

                         || Introduce los pesos de las fechas y dias;
     suma     = (meshast + diahast) - (mesdes + diades);
     conta    = 0;
     Ipesodia = pesodia1 <-;
     indice   = 1;
     indice   = indice + mesdes + diades;
     Ipesodia = Ipesodia + mesdes + diades;
     Ipesodia = Ipesodia - 1;
     indice   = indice - 1;

     |ET proceso 8;
         |SI pesofec = "+"; |O pesofec = "-";
             |HAZ signo; |VETE conta1;
         |FINSI;

         |SI indice = 60;|Y swbis = 1;
             Ipesodia = Ipesodia + 1;
             indice   = indice + 1;
             conta    = conta + 1;
         |FINSI;
         pesodia = pesofec;

     |ET conta1;
         conta = conta + 1;
         |SI conta [ suma;
             Ipesodia = Ipesodia + 1;
             indice   = indice + 1;
             |VETE proceso8;
         |FINSI;
|ET seguir;
    Idesde   = Idesde + 1;
    Ihasta   = Ihasta + 1;
    Ipesofec = Ipesofec + 1;
|SIGUE;
|FPRC;

|PROCESO signo;
|SI pesofec = "+";     ||PROCESO signo controla si es <+> o <->;
   |SI pesodia = 0; |ACABA; |FINSI;
   pesodia= pesodia + 1;
   |SI pesodia > 9; pesodia = 9; |FINSI;
|FINSI;

|SI pesofec = "-";
    |SI pesodia = 1; |ACABA; |FINSI;
    pesodia= pesodia - 1;
    |SI pesodia < 0; pesodia = 0; |FINSI;
|FINSI;
|FPRC;

|PROCESO limpia;
Ipesodia = pesodia1 <-;    ||Limpia los pesos de los dias semanas;
|PARA i = 0;|SI i < 367;|HACIENDO i = i + 1;
      pesodia  = 0;
      Ipesodia = Ipesodia + 1;
|SIGUE;

Idesde = desde1 <-;     ||Limpia las fechas desde;
|PARA i = 0;|SI i < 60;|HACIENDO i = i + 1;
     desde  = "";
     Idesde = Idesde + 1;
|SIGUE;

Ihasta = hasta1 <-;   ||Limpia las fechas hastas;
|PARA i = 0;|SI i < 60;|HACIENDO i = i + 1;
      hasta = "";
     Ihasta = Ihasta + 1;
|SIGUE;

Ipesofec = pesofec1 <-;    ||Limpia los pesos de fechas;
|PARA i = 0;|SI i < 61;|HACIENDO i = i + 1;
     pesofec  = 0;
     Ipesofec = Ipesofec + 1;
|SIGUE;

enero      = "";
febrero    = "";
marzo      = "";
abril      = "";
mayo       = "";
junio      = "";
julio      = "";
agosto     = "";
septiembre = "";
octubre    = "";
noviembre  = "";
diciembre  = "";
|FPRC;

                            || Empieza el calculo para compras automaticas;
|PROCESO calen;|TIPO 6;
swclave = 0;
|ABRE #2;
|ABRE #0;
|ABRE #1;
|ABRE #3;
#3#0 = #5#1;
|LEE 040#3=;
|SI FSalida = 0;
    #1#0 = #3#0;
    |LIBERA #1;
    |LEE 140#1=;
    |SI FSalida = 0; swclave = 1; |FINSI;
    #1#0 = #3#0;
    #1#1 = #3#1;
    #1#2 = #3#2;
    #1#3 = #3#3;
    #1#4 = #3#4;
    #1#5 = #3#5;
    #1#6 = #3#6;
    #1#7 = #3#7;
    #1#8 = #3#8;
    #1#9 = #3#9;
    #1#10 = #3#10;
    #1#11 = #3#11;
    #1#12 = #3#12;
    #1#13 = #3#13;
    grabanyo = #1#13;
    |SI swclave = 1; |GRABA 140#1a; |SINO; |GRABA 140#1n; |FINSI;
    |LIBERA #1;
    swclave = 0;
|FINSI;

#2#0 = #5#1;
|LEE 040#2=;
|SI FSalida = 0;
    #0#0 = #5#1;
    |LEE 110#0=;
    |SI FSalida = 0; swclave = 1; |FINSI;
    |PARA x = cero; |SI x [ 159; |HACIENDO x = x + 1;
         #0x = #2x;
    |SIGUE;
    |SI swclave = 1; |GRABA 020#0a; |SINO; |GRABA 020#0n; |FINSI;
    |LIBERA #0;
    |PUSHV 2001 2380;
    |CONFI men1;
    |POPV;
    |SI FSalida = 0;
        |PUSHV 0501 2279;
        |PINPA #0#0;
        |PINDA #0#0;
        |ENDATOS #1#0;
        |SI FSalida = 0; |HAZ peso; |FINSI;
        |POPV;
    |FINSI;
|SINO;
   |PINTA 1031,men2;
   |PAUSA;
   |PINTA 1031,vacio;
   |ERROR;
|FINSI;
|LIBERA #0;
|CIERRA #0;
|CIERRA #2;
|CIERRA #3;
|LIBERA #1;
|CIERRA #1;
|FPRC;

|PROCESO ptec;|TIPO 0;
|PTEC 13;
|FPRC;

|PROCESO Tipo3;|TIPO 3;
  |PUSHV 2001 2380;
  |CONFI modifi;
  |POPV;
  |SI FSalida ! 0; |ACABA; |FINSI;

  |CONFI "2400NDesea guardar los datos Ventas anteriores : ";
  Guardar = FSalida;

  |ABRE #1;
  |ATRI P;
  |PINTA 2125,procesa;
  |ATRI 0;
  #1#0 = #5#1;
  |LEE 110#1=;
  |SI FSalida ! 0; |LIBERA #1; |CIERRA #1; |ACABA; |FINSI;

  |HAZ random1;
  num      = 0;
  peso     = 0;
  Ipesodia = pesodia1 <-;                             ||PROCESO

  |PARA x = cero;|SI x < 31;|HACIENDO x = x + 1;
        num      = num + 1;                   ||Carga los pesos de Enero
        pesoalfa = num + "01";
        p1       = #1#1 % pesoalfa;
        peso     = peso + p1;
        pesodia  = p1;
        Ipesodia = Ipesodia + 1;
  |SIGUE;

  num = 0;
  |PARA x = cero;|SI x < 29;|HACIENDO x = x + 1;
        num      = num + 1;                         ||Carga los pesos de Febrero
        pesoalfa = num + "01";
        p1       = #1#2 % pesoalfa;
        peso     = peso + p1;
        pesodia  = p1;
        Ipesodia = Ipesodia + 1;
  |SIGUE;

  num = 0;
  |PARA x = cero;|SI x < 31;|HACIENDO x = x + 1;
        num      = num + 1;                     ||Carga los pesos de Marzo
        pesoalfa = num + "01";
        p1       = #1#3 % pesoalfa;
        peso     = peso + p1;
        pesodia  = p1;
        Ipesodia = Ipesodia + 1;
  |SIGUE;

  num = 0;
  |PARA x = cero;|SI x < 30;|HACIENDO x = x + 1;
        num = num + 1;                     ||Carga los pesos de Abril
        pesoalfa = num + "01";
        p1 = #1#4 % pesoalfa;
        peso = peso + p1;
        pesodia = p1;
        Ipesodia = Ipesodia + 1;
  |SIGUE;

  num = 0;
  |PARA x = cero;|SI x < 31;|HACIENDO x = x + 1;
        num      = num + 1;                     ||Carga los pesos de Mayo
        pesoalfa = num + "01";
        p1       = #1#5 % pesoalfa;
        peso     = peso + p1;
        pesodia  = p1;
        Ipesodia = Ipesodia + 1;
  |SIGUE;

  num = 0;
  |PARA x = cero;|SI x < 30;|HACIENDO x = x + 1;
        num      = num + 1;                       ||Carga los pesos de Junio
        pesoalfa = num + "01";
        p1       = #1#6 % pesoalfa;
        peso     = peso + p1;
        pesodia  = p1;
        Ipesodia = Ipesodia + 1;
  |SIGUE;

  num = 0;
  |PARA x = cero;|SI x < 31;|HACIENDO x = x + 1;
       num      = num + 1;                      ||Carga los pesos de Julio
       pesoalfa = num + "01";
       p1       = #1#7 % pesoalfa;
       peso     = peso + p1;
       pesodia  = p1;
       Ipesodia = Ipesodia + 1;
  |SIGUE;

  num = 0;
  |PARA x = cero;|SI x < 31;|HACIENDO x = x + 1;
        num      = num + 1;                   ||Carga los pesos de Agosto
        pesoalfa = num + "01";
        p1       = #1#8 % pesoalfa;
        peso     = peso + p1;
        pesodia  = p1;
        Ipesodia = Ipesodia + 1;
  |SIGUE;

  num = 0;
  |PARA x = cero;|SI x < 30;|HACIENDO x = x + 1;
        num      = num + 1;                ||Carga los pesos de Septiembre
        pesoalfa = num + "01";
        p1       = #1#9 % pesoalfa;
        peso     = peso + p1;
        pesodia  = p1;
        Ipesodia = Ipesodia + 1;
  |SIGUE;

  num = 0;
  |PARA x = cero;|SI x < 31;|HACIENDO x = x + 1;
        num      = num + 1;                   ||Carga los pesos de Octubre
        pesoalfa = num + "01";
        p1       = #1#10 % pesoalfa;
        peso     = peso + p1;
        pesodia  = p1;
        Ipesodia = Ipesodia + 1;
  |SIGUE;

  num = 0;
  |PARA x = cero;|SI x < 30;|HACIENDO x = x + 1;
       num      = num + 1;                    ||Carga los pesos de Noviembre
       pesoalfa = num + "01";
       p1       = #1#11 % pesoalfa;
       peso     = peso + p1;
       pesodia  = p1;
       Ipesodia = Ipesodia + 1;
  |SIGUE;

  num = 0;
  |PARA x = cero;|SI x < 31;|HACIENDO x = x + 1;
        num      = num + 1;                ||Carga los pesos de Diciembre
        pesoalfa = num + "01";
        p1       = #1#12 % pesoalfa;
        peso     = peso + p1;
        pesodia  = p1;
        Ipesodia = Ipesodia + 1;
  |SIGUE;

  num      = 0;
  cantidad = #5#2;
  reparto1 = #5#3;
  rdon     = #5#4;
  veces    = #5#5;
  desv     = #5#6;
  |SI peso = 0; |LIBERA #1; |CIERRA #1; |ACABA; |FINSI;

  canti    = cantidad / rdon;
                                 || repa1    = (reparto1 / rdon) ! #5#7;
  repa1    = (reparto1 / rdon);
                                 ||  sumar    = (repa1 / peso) ! #5#7;
  sumar    = (repa1 / peso);
  sumar    = sumar ! 0;

  Ipesodia = pesodia1 <-;
  Icant    = cant1 <-;
  |PARA x  = cero; |SI x < 366;|HACIENDO x = x + 1;
        cant     = sumar * pesodia;
        total    = total + cant;
        Icant    = Icant + 1;
        Ipesodia = Ipesodia + 1;
  |SIGUE;

dd = 1;
|ET veces;
|SI dd > veces;  |VETE reparto;  |FINSI;

resto = canti - total;
did   = veces + 1 - dd;
|SI resto = 0;  |VETE termino; |FINSI;

repa2  = ((resto / did) - 0.5) ! #5#7;
sumar1 = ((repa2 / peso) - 0.5) ! #5#7;

                             ||Distribucion aleatoria;
Ipesodia = pesodia1 <-;
Icant    = cant1 <-;
|BLIN 23;
|ATRI R;
repart2 = reparto + dd + "a vez. ";
|PINTA 2350,repart2;
|ATRI 0;

|PARA x = cero;|SI x < 366;|HACIENDO x = x + 1;
      |PULSATECLA;

      |HAZ randon;
      tpor     = (rnd * (desv * 2) - desv) ! #5#7;
      sumar5   = ((sumar1 * tpor) / 100) ! #5#7;
      sumar2   = sumar1 + sumar5;
      sumar3   = sumar2 * pesodia;
      cant     = cant + sumar3;
      total    = total + sumar3;
      Ipesodia = Ipesodia + 1;
      Icant    = Icant + 1;
|SIGUE;

dd = dd + 1;
|VETE veces;

|ET reparto;         ||Reparto del resto;
    resto = canti - total;
    |BLIN  23;
    |ATRI R;
    |PINTA 2350, repart1;
    |ATRI 0;
    |SI resto = 0;  |VETE termino;  |FINSI;

    sumar = ((resto / peso) - 0.5) ! #5#7;
    |SI sumar = 0;  |VETE ptas; |FINSI;

    Ipesodia = pesodia1 <-;
    Icant = cant1 <-;
    |PARA x = cero;|SI x < 366;|HACIENDO x = x + 1;
          sumar3   = sumar * pesodia;
          cant     = cant + sumar3;
          total    = total + sumar3;
          Ipesodia = Ipesodia + 1;
          Icant    = Icant + 1;
    |SIGUE;

    |VETE reparto;

|ET ptas;        ||Reparto en ptas;
    |SI resto < 0;  |VETE ptas1;  |FINSI;

    Ipesodia = pesodia1 <-;
    Icant = cant1 <-;
    |PARA x = cero;|SI x < 366;|HACIENDO x = x + 1;
          |SI resto = 0;  x = 366;  |VETE sigue1;  |FINSI;
          |SI resto < pesodia;
              sumar = resto;
          |SINO;
              sumar = pesodia;
          |FINSI;

          cant = cant + sumar;
          resto = resto - sumar;
          Ipesodia = Ipesodia + 1;
          Icant = Icant + 1;
|ET sigue1;
    |SIGUE;

    total = total + resto;
    |VETE termino;

|ET ptas1;        ||Reparto en ptas;
    Ipesodia = pesodia1 <-;
    Icant = cant1 <-;
    |PARA x = cero;|SI x < 366;|HACIENDO x = x + 1;
          |SI resto = 0;  x = 366;  |VETE sigue2;  |FINSI;

          resto = - resto
          |SI resto < pesodia;
              sumar = resto;
          |SINO;
              sumar = pesodia;
          |FINSI;

          cant     = cant - sumar;
          resto    = resto - sumar;
          Ipesodia = Ipesodia + 1;
          Icant    = Icant + 1;
|ET sigue2;
    |SIGUE;

total = total - resto;

|ET termino;     ||Terminado;
    |BLIN 23;
    |ATRI R;
    |PINTA 2350,grabador;
    |ATRI 0;
    Icant = cant1 <-;
    |PARA x = cero;|SI x < 366;|HACIENDO x = x + 1;
          cant = cant * rdon;
          Icant = Icant + 1;
    |SIGUE;
                            ||Graba fichero de ventas automaticas;
    |ABRE #4;
    swclave = 0;                ||Graba primer trimestre;
    #4#0 = #5#0;
    #4#1 = 1;
    |LEE 110#4=;
    |SI FSalida = 0;  swclave = 1;  |FINSI;
    num = 1;
    #4#94 = grabanyo;

    Icant = cant1 <-;
    |PARA x = 1;|SI x [ 91;|HACIENDO x = x + 1;
          num = num + 1;
          |SI Guardar = 0;
              |SI #4num ! 0; |Y cant ! 0; #4num = cant; |FINSI;
              |SI #4num = 0;              #4num = cant; |FINSI;
          |SINO;
              #4num = cant;
          |FINSI;
          Icant = Icant + 1;
    |SIGUE;
    |SI swclave = 1; |GRABA 020#4a; |SINO; |GRABA 020#4n; |FINSI;
    |LIBERA #4;

    swclave = 0;
    #4#0 = #5#0;                           ||Graba segundo trimestre
    #4#1 = dos;
    |PINTA #4#1;
    |LEE 110#4=;
    |SI FSalida = 0;  swclave = 1;  |FINSI;
    #4#94 = grabanyo;

    num = 1;
    |PARA x = 1;|SI x [ 91;|HACIENDO x = x + 1;
          num   = num + 1;
          |SI Guardar = 0;
              |SI #4num ! 0; |Y cant ! 0; #4num = cant; |FINSI;
              |SI #4num = 0;              #4num = cant; |FINSI;
          |SINO;
              #4num = cant;
          |FINSI;
          Icant = Icant + 1;
    |SIGUE;
    |SI swclave = 1; |GRABA 020#4a; |SINO; |GRABA 020#4n; |FINSI;
    |LIBERA #4;

    swclave = 0;
    #4#0 = #5#0;                           ||Graba tercer trimestre
    #4#1 = 3;
    |LEE 110#4=;
    |SI FSalida = 0;  swclave = 1;  |FINSI;
    #4#94 = grabanyo;

    num = 1;
    |PARA x = 1;|SI x [ 92;|HACIENDO x = x + 1;
          num   = num + 1;
          |SI Guardar = 0;
              |SI #4num ! 0; |Y cant ! 0; #4num = cant; |FINSI;
              |SI #4num = 0;              #4num = cant; |FINSI;
          |SINO;
              #4num = cant;
          |FINSI;
          Icant = Icant + 1;
    |SIGUE;
    |SI swclave = 1; |GRABA 020#4a; |SINO; |GRABA 020#4n; |FINSI;
    |LIBERA #4;

    swclave = 0;
    #4#0 = #5#0;                           ||Graba cuarto trimestre
    #4#1 = 4;
    |LEE 110#4=;
    |SI FSalida = 0;  swclave = 1;  |FINSI;
    #4#94 = grabanyo;

    num = 1;
    |PARA x = 1;|SI x [ 92;|HACIENDO x = x + 1;
          num   = num + 1;
          |SI Guardar = 0;
              |SI #4num ! 0; |Y cant ! 0; #4num = cant; |FINSI;
              |SI #4num = 0;              #4num = cant; |FINSI;
          |SINO;
              #4num = cant;
          |FINSI;
          Icant = Icant + 1;
     |SIGUE;
     |SI swclave = 1; |GRABA 020#4a; |SINO; |GRABA 020#4n; |FINSI;
     |LIBERA #4;

|LIBERA #1;
|CIERRA #1;
|CIERRA #4;
|FPRC;

|PROCESO randon;
nAsegura = producto ! 6;
|SI nAsegura = 3.141592;  producto = producto1;  |FINSI;

producto = producto / 3.141592;
mod      = producto;
numero   = 0;

|ET punto;
    numero    = numero + 1;
    alfapunto = numero + "01";
    mod1      = mod % alfapunto;
    |SI mod1 ! ".";  |VETE punto;  |FINSI;

    longi = mod % A0;
    alfapunto = numero;
    longi1 = longi % A0;

    |SI longi1 = "1";  longi = "0" + longi;  |FINSI;

    mod1   = alfapunto + longi;
    mod    = mod % mod1;
    mod    = "0" + mod;
    modnum = mod;
    rnd    = modnum / 3.141592;

    |SI producto < 1;         producto = producto * 1000000; |FINSI;
    |SI producto < 1;         producto = producto1;          |FINSI;
|FPRC;

|PROCESO random1;
suma4 = 0;
Ipesodia = pesodia1 <-;
|PARA x = cero;|SI x < 183;|HACIENDO x = x + 2;
       |SI pesodia = 0;
          variable = 1;
       |SINO;
           variable = pesodia;
       |FINSI;

       Ipesodia = Ipesodia + 1;
       |SI pesodia = 0;
           variable1 = 1;
       |SINO;
           variable1 = pesodia;
       |FINSI;

       suma4 = suma4 + variable + variable1;
       Ipesodia = Ipesodia + 1;
|SIGUE;

producto1 = suma4 * #5#1 * #5#0;
producto  = producto1;
|FPRC;
