|FICHEROS;
  eosfical #0;
  eoscalen #1;
|FIN;

|VARIABLES;
 nNume = 0;
 pepe = 0;
 camp = 0;
 conta = 0;
 i = 0;
    procesa = "     Estoy procesando espere un poco Por Favor";
    modifi = "2330S  Modificar el Calendario S/N : ";
    alta = "2330S     Dar el alta al Calendario S/N : ";
    errorfec1 = "     Fecha erronea DD/MM";
    errorfec2 = "     Fecha Hasta menor que la Fecha Desde";
    errorfec3 = "     No existe ese dia el a¤o no es bisiesto";
    anyomal = "     A¤o erroneo";
    varalfa = "";
    varalfa1 = "";
    varalfa2  = "";
    vardia = 0;
    varmes = 0;
    fechadesde = "";
    fechadesde1 = "";
    fechadesde2 = "";
    fechahasta = "";
    fechahasta1 = "";
    fechahasta2 = "";

    anu1  = "8512";
    anu2  = "8613";
    anu3  = "8714";
    anu4  = "8805";
    anu5  = "8917";
    anu6  = "9011";
    anu7  = "9112";
    anu8  = "9203";
    anu9  = "9315";
    anu10 = "9416";
    anu11 = "9517";
    anu12 = "9601";
    anu13 = "9713";
    anu14 = "9814";
    anu15 = "9915";
    anu16 = "0006";
    anu17 = "0111";
    anu18 = "0212";
    anu19 = "0313";
    anu20 = "0404";
    anu21 = "0516";
    anu22 = "0617";
    anu23 = "0711";
    anu24 = "0802";
    anu25 = "0914";
    anu26 = "1015";
    anu27 = "1116";
    anu28 = "1207";
    anu29 = "1312";
    anu30 = "1413";
    anu31 = "1514";
    anu32 = "1605";
    anu33 = "1717";
    anu34 = "1811";
    anu35 = "1912";
    anu36 = "2003";

    dia1 = 0;
    dia2 = 31;
    dia3 = 60;
    dia4 = 91;
    dia5 = 121;
    dia6 = 152;
    dia7 = 182;
    dia8 = 213;
    dia9 = 244;
    dia10 = 274;
    dia11 = 305;
    dia12 = 335;
    diapri = "";
    diapri1 = 0;
    mesdes = 0;
    meshast = 0;
    mesdes1 = "";
    meshast1 = "";
    diades = 0;
    diahast = 0;
    diades1 = "";
    diahast1 = "";
    varcamfecha = 0;

    bisiesto = "";
    swbis = 1;
    anyo = "";
    dd = 0;
    bucle  = 0;
    x = 0;
    alfapeso = "";
    enero = "";
    febrero = "";
    marzo = "";
    abril = "";
    mayo = "";
    junio = "";
    julio = "";
    agosto = "";
    septiembre = "";
    octubre = "";
    noviembre = "";
    diciembre = "";
    suma = 0;
    swclave = 1;
    var = 0;
    indice = 0;
    swbis1 = 0;
    {367}peso=0;
    {-1}valfec = 0;
        valfec1 = 31;
        valfec2 = 29;
        valfec3 = 31;
        valfec4 = 30;
        valfec5 = 31;
        valfec6 = 30;
        valfec7 = 31;
        valfec8 = 31;
        valfec9 = 30;
        valfec10 = 31;
        valfec11 = 30;
        valfec12 = 31;
    {60}desde = "";
    {60}hasta = "";
    {61}pesofec = "";
|FIN;

|CALCULO  fechbien;|TIPO 0;        ||Calcula si la fecha es correcta
valfec1  = 31; valfec2  = 29; valfec3  = 31;
valfec4  = 30; valfec5  = 31; valfec6  = 30;
valfec7  = 31; valfec8  = 31; valfec9  = 30;
valfec10 = 31; valfec11 = 30; valfec12 = 31;

varalfa = #0Campo;
|SI varalfa ! "    ";
   |SI varalfa = "2902";|Y swbis = 1;
       |MENAV errorfec3;
       |ERROR;
       |VETE fini;
   |FINSI;
   varalfa1 = varalfa / 2;
   varalfa2 = varalfa % A302;
   vardia = varalfa1;
   varmes = varalfa2;
   |SI varmes [ 0;|O varmes > 12;
        |MENAV errorfec1;
        |ERROR;
        |VETE fini;
    |FINSI;
    Ivalfec = valfec1 <-;
    Ivalfec = Ivalfec + varmes;
    Ivalfec = Ivalfec - 1;
    |SI vardia > valfec;|O vardia [ 0;
        |MENAV errorfec1;
        |ERROR;
    |FINSI;
|FINSI;
 |ET fini;
|FCAL;

                    ||Calcula si la fecha desde es mayor a la fecha desde
|CALCULO desdefec;|TIPO 0;
camp = Campo - 1;
fechadesde = #0camp;
fechadesde1 = fechadesde % A302;
fechadesde2 = fechadesde % A102;
fechadesde = fechadesde1 + fechadesde2;
fechahasta = #0Campo;
fechahasta1 = fechahasta % A302;
fechahasta2 = fechahasta % A102;
fechahasta = fechahasta1 + fechahasta2
|SI fechadesde > fechahasta;
       |MENAV errorfec2;
       |ERROR;
|FINSI;
|FCAL;


|CALCULO anyo;|TIPO 0;
     nNume = #0#1;
     |SI nNume < 1985;  |O nNume > 2020;
         |MENAV anyomal;
         |ERROR;
     |FINSI;

|SI #0#1 = "1985";  anyo = anu1;   |FINSI;
|SI #0#1 = "1986";  anyo = anu2;   |FINSI;
|SI #0#1 = "1987";  anyo = anu3;   |FINSI;
|SI #0#1 = "1988";  anyo = anu4;   |FINSI;
|SI #0#1 = "1989";  anyo = anu5;   |FINSI;
|SI #0#1 = "1990";  anyo = anu6;   |FINSI;
|SI #0#1 = "1991";  anyo = anu7;   |FINSI;
|SI #0#1 = "1992";  anyo = anu8;   |FINSI;
|SI #0#1 = "1993";  anyo = anu9;   |FINSI;
|SI #0#1 = "1994";  anyo = anu10;  |FINSI;
|SI #0#1 = "1995";  anyo = anu11;  |FINSI;
|SI #0#1 = "1996";  anyo = anu12;  |FINSI;
|SI #0#1 = "1997";  anyo = anu13;  |FINSI;
|SI #0#1 = "1998";  anyo = anu14;  |FINSI;
|SI #0#1 = "1999";  anyo = anu15;  |FINSI;
|SI #0#1 = "2000";  anyo = anu16;  |FINSI;
|SI #0#1 = "2001";  anyo = anu17;  |FINSI;
|SI #0#1 = "2002";  anyo = anu18;  |FINSI;
|SI #0#1 = "2003";  anyo = anu19;  |FINSI;
|SI #0#1 = "2004";  anyo = anu20;  |FINSI;
|SI #0#1 = "2005";  anyo = anu21;  |FINSI;
|SI #0#1 = "2006";  anyo = anu22;  |FINSI;
|SI #0#1 = "2007";  anyo = anu23;  |FINSI;
|SI #0#1 = "2008";  anyo = anu24;  |FINSI;
|SI #0#1 = "2009";  anyo = anu25;  |FINSI;
|SI #0#1 = "2010";  anyo = anu26;  |FINSI;
|SI #0#1 = "2011";  anyo = anu27;  |FINSI;
|SI #0#1 = "2012";  anyo = anu28;  |FINSI;
|SI #0#1 = "2013";  anyo = anu29;  |FINSI;
|SI #0#1 = "2014";  anyo = anu30;  |FINSI;
|SI #0#1 = "2015";  anyo = anu31;  |FINSI;
|SI #0#1 = "2016";  anyo = anu32;  |FINSI;
|SI #0#1 = "2017";  anyo = anu33;  |FINSI;
|SI #0#1 = "2018";  anyo = anu34;  |FINSI;
|SI #0#1 = "2019";  anyo = anu35;  |FINSI;
|SI #0#1 = "2020";  anyo = anu36;  |FINSI;

                          ||Calcular si es o no anyo bisiesto;
swbis = 0;
bisiesto = anyo % A301;
|SI bisiesto = "1";
    swbis = 1;
|FINSI;
|FCAL;

|CALCULO peso;|TIPO 3;
|ABRE #1;
pepe = (FEntrada / 100) ! 0;
|SI pepe = 1; |O pepe = 2;
   |SI pepe = 1;
      |CONFI alta;
      |SI FSalida ! 0;
         |BLIN 23;
         |VETE termino;
      |FINSI;
      |BLIN 23;
   |FINSI;
   |SI pepe = 2;
      |CONFI modifi;
      |SI FSalida ! 0;
          |BLIN 23;
          |VETE termino;
      |FINSI;
      |BLIN 23;
   |FINSI;
   |HAZ peso1;
   |BLIN 23;
   |SI swclave = 1;
      |GRABA 020#1n;
   |SINO;
      |GRABA 020#1a;
   |FINSI;
   |LIBERA #1;
   |HAZ limpia;
|FINSI;
|ET termino;
|CIERRA #1;
|FCAL;



|CALCULO peso1;
|PINTA 2330,procesa;
swclave = 0;
#1#0 = #0#0;
|LEE 110#1=;
    |SI FSalida ! 0;
         swclave = 1;
    |FINSI;
                          ||Calcular primer dia del anyo;
diapri = anyo % A401;
diapri1 = diapri;         ||Pone a numerica diapri;
|SI diapri = 1;           ||Si el primer dia es lunes;
    dd = 0;
indice = dd;
|HAZ lunes;
dd = dd + 1;
indice =  dd;
|HAZ martes;
dd = dd + 1;
indice =  dd;
|HAZ miercoles;
dd = dd + 1;
indice =  dd;
|HAZ jueves;
dd = dd + 1;
indice = dd;
|HAZ viernes;
dd = dd + 1;
indice = dd;
|HAZ sabado;
dd = dd + 1;
indice = dd;
|HAZ domingo;
|FINSI;

|SI diapri = 2;     ||Si el primer dia es martes
    dd = 0;
indice = 1;
indice = dd;
|HAZ martes;
dd = dd + 1;
indice = dd;
|HAZ miercoles;
dd = dd + 1;
indice = dd;
|HAZ jueves;
dd = dd + 1;
indice = dd;
|HAZ viernes;
dd = dd + 1;
indice = dd;
|HAZ sabado;
dd = dd + 1;
indice = dd;
|HAZ domingo;
dd = dd + 1;
indice = dd;
|HAZ lunes;
|FINSI;

|SI diapri = 3;      ||Si el primer dia es el miercoles
    dd = 0;
indice = 1;
indice = dd;
|HAZ miercoles;
dd = dd + 1;
indice = dd;
|HAZ jueves;
dd = dd + 1;
indice = dd;
|HAZ viernes;
dd = dd + 1;
indice = dd;
|HAZ sabado;
dd = dd + 1;
indice = dd;
|HAZ domingo;
dd = dd + 1;
indice = dd;
|HAZ lunes;
dd = dd + 1;
indice = dd;
|HAZ martes;
|FINSI;

|SI diapri = 4;      ||Si el primer dia es el jueves;
    dd = 0;
indice = 1;
indice = dd;
|HAZ jueves;
dd = dd + 1;
indice = dd;
|HAZ viernes;
dd = dd + 1;
indice = dd;
|HAZ sabado;
dd = dd + 1;
indice = dd;
|HAZ domingo;
dd = dd + 1;
indice = dd;
|HAZ lunes;
dd = dd + 1;
indice = dd;
|HAZ martes;
dd = dd + 1;
indice = dd;
|HAZ miercoles;
|FINSI;

|SI diapri = 5;       ||Si el primer dia es el viernes;
    dd = 0;
indice = 1;
indice = dd;
|HAZ viernes;
dd = dd + 1;
indice = dd;
|HAZ sabado;
dd = dd + 1;
indice = dd;
|HAZ domingo;
dd = dd + 1;
indice = dd;
|HAZ lunes;
dd = dd + 1;
indice = dd;
|HAZ martes;
dd = dd + 1;
indice = dd;
|HAZ miercoles;
dd = dd + 1;
indice = dd;
|HAZ jueves;
|FINSI;

|SI diapri = 6;         ||Si el primer dia es sabado
    dd = 0;
indice = 1;
indice = dd;
|HAZ sabado;
dd = dd + 1;
indice = dd;
|HAZ domingo;
dd = dd + 1;
indice = dd;
|HAZ lunes;
dd = dd + 1;
indice = dd;
|HAZ martes;
dd = dd + 1;
indice = dd;
|HAZ miercoles;
dd = dd + 1;
indice = dd;
|HAZ jueves;
dd = dd + 1;
indice = dd;
|HAZ viernes;
|FINSI;

|SI diapri = 7;        ||Si el primer dia es domingo;
    dd = 0;
indice = 1;
indice = dd;
|HAZ domingo;
dd = dd + 1;
indice = dd;
|HAZ lunes;
dd = dd + 1;
indice = dd;
|HAZ martes;
dd = dd + 1;
indice = dd;
|HAZ miercoles;
dd = dd + 1;
indice = dd;
|HAZ jueves;
dd = dd + 1;
indice = dd;
|HAZ viernes;
dd = dd + 1;
indice = dd;
|HAZ sabado;
|FINSI;
Ipeso = Ipeso + 1;
peso = 0;
|HAZ fechas;              ||Calculo para cargar pesos de fecha a fecha

                          ||Carga los pesos de enero
Ipeso = peso1 <-;
|PARA bucle = 0;|SI bucle < 31;|HACIENDO bucle = bucle + 1;
     alfapeso =  peso;
     enero = enero + alfapeso;
  Ipeso = Ipeso + 1;
|SIGUE;

                 ||Carga los peso de febrero
|PARA bucle = 0;|SI bucle < 29;|HACIENDO bucle = bucle + 1;
     alfapeso =  peso;
     febrero = febrero + alfapeso;
  Ipeso = Ipeso + 1;
|SIGUE;

|| Carga los pesos de marzo;
|PARA bucle = 0;|SI bucle < 31;|HACIENDO bucle = bucle + 1;
     alfapeso =  peso;
     marzo = marzo + alfapeso;
  Ipeso = Ipeso + 1;
|SIGUE;

|| Carga los pesos de abril;
|PARA bucle = 0;|SI bucle < 30;|HACIENDO bucle = bucle + 1;
     alfapeso =  peso;
     abril = abril + alfapeso;
  Ipeso = Ipeso + 1;
|SIGUE;

|| Carga los pesos de mayo;
|PARA bucle = 0;|SI bucle < 31;|HACIENDO bucle = bucle + 1;
     alfapeso =  peso;
     mayo = mayo + alfapeso;
  Ipeso = Ipeso + 1;
|SIGUE;

|| Carga los pesos de junio;
|PARA bucle = 0;|SI bucle < 30;|HACIENDO bucle = bucle + 1;
     alfapeso =  peso;
     junio = junio + alfapeso;
  Ipeso = Ipeso + 1;
|SIGUE;

|| Carga los pesos de julio;
|PARA bucle = 0;|SI bucle < 31;|HACIENDO bucle = bucle + 1;
     alfapeso =  peso;
     julio = julio + alfapeso;
  Ipeso = Ipeso + 1;
|SIGUE;


|| Carga los pesos de agosto;
|PARA bucle = 0;|SI bucle < 31;|HACIENDO bucle = bucle + 1;
     alfapeso =  peso;
     agosto = agosto + alfapeso;
  Ipeso = Ipeso + 1;
|SIGUE;

|| Carga los pesos de septiembre;
|PARA bucle = 0;|SI bucle < 30;|HACIENDO bucle = bucle + 1;
     alfapeso =  peso;
     septiembre = septiembre + alfapeso;
  Ipeso = Ipeso + 1;
|SIGUE;

|| Carga los pesos de octubre;
|PARA bucle = 0;|SI bucle < 31;|HACIENDO bucle = bucle + 1;
     alfapeso =  peso;
     octubre = octubre + alfapeso;
  Ipeso = Ipeso + 1;
|SIGUE;

|| Carga los pesos de noviembre;
|PARA bucle = 0;|SI bucle < 30;|HACIENDO bucle = bucle + 1;
     alfapeso =  peso;
     noviembre = noviembre + alfapeso;
  Ipeso = Ipeso + 1;
|SIGUE;

|| Carga los pesos de diciembre;
|PARA bucle = 0;|SI bucle < 31;|HACIENDO bucle = bucle + 1;
     alfapeso =  peso;
     diciembre = diciembre + alfapeso;
  Ipeso = Ipeso + 1;
|SIGUE;

       #1#1 = enero;                 ||Introduce en los campos los resultados
       #1#2 = febrero;
       #1#3 = marzo;
       #1#4 = abril;
       #1#5 = mayo;
       #1#6 = junio;
       #1#7 = julio;
       #1#8 = agosto;
       #1#9 = septiembre;
       #1#10 = octubre;
       #1#11 = noviembre;
       #1#12 = diciembre;
       #1#0 = #0#0;
       #1#13 = #0#1;
|FCAL;


|CALCULO lunes;           ||Introducir los pesos del lunes;
swbis1 = 0;
conta = 0;
Ipeso = peso1 <-;
Ipeso = Ipeso + dd ;
|ET proceso1;
    |SI indice = 59;|Y swbis = 1;
        peso = 0;
        Ipeso = Ipeso + 1;
        indice = indice + 1;
        swbis1 = 1;
    |FINSI;
    |SI indice > 59;|Y swbis = 1;|Y swbis1 = 0;
        Ipeso = Ipeso + 1;
        indice = indice + 1;
        swbis1 = 1;
    |FINSI;
   peso = #0#2;
    conta = conta + 7;
   Ipeso = Ipeso + 7;
   indice = indice + 7;
 |SI conta [ 366;
   |VETE proceso1;
 |FINSI;
|FCAL;



|CALCULO martes;          ||Introducir los pesos del martes;
swbis1 = 0;
conta = 0;
Ipeso = peso1 <-;
Ipeso = Ipeso + dd;
|ET proceso2;
    |SI indice = 59;|Y swbis = 1;
       peso = 0;
        Ipeso = Ipeso + 1;
        indice = indice + 1;
        swbis1 = 1;
     |FINSI;
    |SI indice > 59;|Y swbis = 1;|Y swbis1 = 0;
        Ipeso = Ipeso + 1;
        indice = indice + 1;
        swbis1 = 1;
    |FINSI;
   peso = #0#3;
    conta = conta + 7;
   Ipeso = Ipeso + 7;
   indice = indice + 7;
 |SI conta [ 366;
   |VETE proceso2;
 |FINSI;
|FCAL;


|CALCULO miercoles;       ||Introducir los pesos del miercoles;
swbis1 = 0;
conta = 0;
Ipeso = peso1 <-;
Ipeso = Ipeso + dd;
|ET proceso3;
    |SI indice = 59;|Y swbis = 1;
        peso = 0;
        Ipeso = Ipeso + 1;
        indice = indice + 1;
        swbis1 = 1;
     |FINSI;
    |SI indice > 59;|Y swbis = 1;|Y swbis1 = 0;
        Ipeso = Ipeso + 1;
        indice = indice + 1;
        swbis1 = 1;
    |FINSI;
   peso = #0#4;
    conta = conta + 7;
   Ipeso = Ipeso + 7;
   indice = indice + 7;
 |SI conta [ 366;
   |VETE proceso3;
 |FINSI;
|FCAL;



|CALCULO jueves;          ||Introducir los pesos del jueves;
swbis1 = 0;
conta = 0;
Ipeso = peso1 <-;
Ipeso = Ipeso + dd;
|ET proceso4;
    |SI indice = 59;|Y swbis = 1;
     peso = 0;
        Ipeso = Ipeso + 1;
        indice = indice + 1;
        swbis1 = 1;
    |FINSI;
    |SI indice > 59;|Y swbis = 1;|Y swbis1 = 0;
        Ipeso = Ipeso + 1;
        indice = indice + 1;
        swbis1 = 1;
    |FINSI;
   peso = #0#5;
   conta = conta + 7;
   Ipeso = Ipeso + 7;
   indice = indice + 7;
 |SI conta [ 366;
   |VETE proceso4;
 |FINSI;
|FCAL;



|CALCULO viernes;             ||Introducir los pesos del viernes;
swbis1 = 0;
conta = 0;
Ipeso = peso1 <-;
Ipeso = Ipeso + dd;
|ET proceso5;
    |SI indice = 59;|Y swbis = 1;
         peso = 0;
        Ipeso = Ipeso + 1;
        indice = indice + 1;
        swbis1 = 1;
     |FINSI;
    |SI indice > 59;|Y swbis = 1;|Y swbis1 = 0;
        Ipeso = Ipeso + 1;
        indice = indice + 1;
        swbis1 = 1;
    |FINSI;
   peso = #0#6;
    conta = conta + 7;
   Ipeso = Ipeso + 7;
   indice = indice + 7;
 |SI conta [ 366;
   |VETE proceso5;
 |FINSI;
|FCAL;



|CALCULO sabado;            ||Introducir los pesos del sabado;
swbis1 = 0;
conta = 0;
Ipeso = peso1 <-;
Ipeso = Ipeso + dd;
|ET proceso6;
    |SI indice = 59;|Y swbis = 1;
         peso = 0;
        Ipeso = Ipeso + 1;
        indice = indice + 1;
        swbis1 = 1;
    |FINSI;
    |SI indice > 59;|Y swbis = 1;|Y swbis1 = 0;
        Ipeso = Ipeso + 1;
        indice = indice + 1;
        swbis1 = 1;
    |FINSI;
   peso = #0#7;
   conta = conta + 7;
   Ipeso = Ipeso + 7;
   indice = indice + 7;
 |SI conta [ 366;
   |VETE proceso6;
 |FINSI;
|FCAL;




|CALCULO domingo;            ||Introducir los pesos del domingo;
swbis1 = 0;
conta = 0;
Ipeso = peso1 <-;
Ipeso = Ipeso + dd;
|ET proceso7;
    |SI indice = 59;|Y swbis = 1;
        peso = 0;
       Ipeso = Ipeso + 1;
        indice = indice + 1;
        swbis1 = 1;
    |FINSI;
    |SI indice > 59;|Y swbis = 1;|Y swbis1 = 0;
        Ipeso = Ipeso + 1;
        indice = indice + 1;
        swbis1 = 1;
    |FINSI;
   peso = #0#8;
   conta = conta + 7;
   Ipeso = Ipeso + 7;
   indice = indice + 7;
 |SI conta [ 366;
   |VETE proceso7;
 |FINSI;
|FCAL;


|CALCULO fechas;         ||Carga desde fecha a fecha y de dia a dia
varcamfecha = 9;
Idesde = desde1 <-;
                                             ||Carga en puteros los desde
   |PARA x = 0;|SI x < 30;|HACIENDO x = x + 1;
        desde = #0varcamfecha;
        varcamfecha = varcamfecha + 3;
        Idesde = Idesde + 1;
    |SIGUE;
varcamfecha = 99;
                                            ||Carga en puteros los dias
   |PARA x = 30;|SI x < 60;|HACIENDO x = x + 1;
        desde = #0varcamfecha;
        varcamfecha = varcamfecha + 2;
        Idesde = Idesde + 1;
    |SIGUE;

varcamfecha = 10;
Ihasta = hasta1 <-;
                                          ||Carga en puntero los hastas
   |PARA x = 0;|SI x < 30;|HACIENDO x = x + 1;
        hasta = #0varcamfecha;
        varcamfecha = varcamfecha + 3;
        Ihasta = Ihasta + 1;
    |SIGUE;
varcamfecha = 99;
                                       ||Carga en puteros los dias
   |PARA x = 30;|SI x < 60;|HACIENDO x = x + 1;
        hasta = #0varcamfecha;
        varcamfecha = varcamfecha + 2;
        Ihasta = Ihasta + 1;
    |SIGUE;
varcamfecha = 11;
Ipesofec = pesofec1 <-;
                                    ||Carga en puntero los pesos de las fechas
   |PARA x = 0;|SI x < 30;|HACIENDO x = x + 1;
        pesofec = #0varcamfecha;
        varcamfecha = varcamfecha + 3;
        Ipesofec = Ipesofec + 1;
    |SIGUE;
varcamfecha = 100;
                                      ||Carga en puteros los pesos de los dias
   |PARA x = 30;|SI x < 60;|HACIENDO x = x + 1;
        pesofec = #0varcamfecha;
        varcamfecha = varcamfecha + 2;
        Ipesofec = Ipesofec + 1;
    |SIGUE;
Ipesofec = Ipesofec + 1;
pesofec = 0;

Ipeso = peso1 <-;
Idesde = desde1 <-;
Ihasta = hasta1 <-;
Ipesofec = pesofec1 <-;
                            ||   Introduce pesos de fechas y dias
|PARA x = 0;|SI x < 60;|HACIENDO x = x + 1;
|SI desde = "    ";
    |VETE seguir;
|FINSI;
diades1 = desde % A102;
diahast1 = hasta % A102;
diades = diades1;           ||Controla el dia del desde
diahast = diahast1;         ||Controla el dia del hasta
mesdes1 = desde % A302;
meshast1 = hasta % A302;
|SI mesdes1 = 1;            ||Controla el mes del desde
   mesdes = dia1;
|FINSI;
|SI mesdes1 = 2;
   mesdes = dia2;
|FINSI;
|SI mesdes1 = 3;
   mesdes = dia3;
|FINSI;
|SI mesdes1 = 4;
   mesdes = dia4;
|FINSI;
|SI mesdes1 = 5;
   mesdes = dia5;
|FINSI;
|SI mesdes1 = 6;
   mesdes = dia6;
|FINSI;
|SI mesdes1 = 7;
   mesdes = dia7;
|FINSI;
|SI mesdes1 = 8;
   mesdes = dia8;
|FINSI;
|SI mesdes1 = 9;
   mesdes = dia9;
|FINSI;
|SI mesdes1 = 10;
   mesdes = dia10;
|FINSI;
|SI mesdes1 = 11;
   mesdes = dia11;
|FINSI;
|SI mesdes1 = 12;
   mesdes = dia12;
|FINSI;
|SI meshast1 = 1;      ||controla el mes del hasta
   meshast = dia1;
|FINSI;
|SI meshast1 = 2;
   meshast = dia2;
|FINSI;
|SI meshast1 = 3;
   meshast = dia3;
|FINSI;
|SI meshast1 = 4;
   meshast = dia4;
|FINSI;
|SI meshast1 = 5;
   meshast = dia5;
|FINSI;
|SI meshast1 = 6;
   meshast = dia6;
|FINSI;
|SI meshast1 = 7;
   meshast = dia7;
|FINSI;
|SI meshast1 = 8;
   meshast = dia8;
|FINSI;
|SI meshast1 = 9;
   meshast = dia9;
|FINSI;
|SI meshast1 = 10;
   meshast = dia10;
|FINSI;
|SI meshast1 = 11;
   meshast = dia11;
|FINSI;
|SI meshast1 = 12;
   meshast = dia12;
|FINSI;
                         || Introduce los pesos de las fechas y dias
   suma = (meshast + diahast) - (mesdes + diades);
   conta = 0;
   Ipeso = peso1 <-;
   indice = 1;
   indice = indice + mesdes + diades;
   Ipeso = Ipeso + mesdes + diades;
   Ipeso = Ipeso - 1;
   indice = indice - 1;
     |ET proceso 8;
        |SI pesofec = "+";|O pesofec = "-";
            |HAZ signo;
            |VETE conta1;
        |FINSI;
         |SI indice = 60;|Y swbis = 1;
             Ipeso = Ipeso + 1;
             indice = indice + 1;
             conta = conta + 1;
         |FINSI;
         peso = pesofec;
      |ET conta1;
       conta = conta + 1;
       |SI conta [ suma;
          Ipeso = Ipeso + 1;
          indice = indice + 1;
          |VETE proceso8;
       |FINSI;
|ET seguir;
    Idesde = Idesde + 1;
    Ihasta = Ihasta + 1;
    Ipesofec = Ipesofec + 1;
|SIGUE;
|FCAL;

|CALCULO signo;
   |SI pesofec = "+";     ||Calculo signo controla si es <+> o <->
       |SI peso = 0;
            |VETE nopeso;
       |FINSI;
         peso = peso + 1;
            |SI peso > 9;
                peso = 9;
            |FINSI;
   |FINSI;

   |SI pesofec = "-";
       |SI peso = 1;
           |VETE nopeso;
       |FINSI;
         peso = peso - 1;
            |SI peso < 0;
               peso = 0;
            |FINSI;
   |FINSI;
|ET nopeso;
|FCAL;





|CALCULO limpia;
Ipeso = peso1 <-;    ||Limpia los pesos de los dias semanas
|PARA i = 0;|SI i < 367;|HACIENDO i = i + 1;
     peso = 0;
  Ipeso = Ipeso + 1;
|SIGUE;

Idesde = desde1 <-;     ||Limpia las fechas desde
|PARA i = 0;|SI i < 60;|HACIENDO i = i + 1;
     desde = "";
  Idesde = Idesde + 1;
|SIGUE;

Ihasta = hasta1 <-;   ||Limpia las fechas hastas
|PARA i = 0;|SI i < 60;|HACIENDO i = i + 1;
     hasta = "";
  Ihasta = Ihasta + 1;
|SIGUE;

Ipesofec = pesofec1 <-;    ||Limpia los pesos de fechas
|PARA i = 0;|SI i < 61;|HACIENDO i = i + 1;
     pesofec = 0;
  Ipesofec = Ipesofec + 1;
|SIGUE;
    enero = "";
    febrero = "";
    marzo = "";
    abril = "";
    mayo = "";
    junio = "";
    julio = "";
    agosto = "";
    septiembre = "";
    octubre = "";
    noviembre = "";
    diciembre = "";
|FCAL;
