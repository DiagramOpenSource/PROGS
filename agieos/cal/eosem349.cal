|FICHEROS;
    eosem349 #0;
    eos349ca #1;
    eosclien #2;
    eospant2 #3;
    eoshacie #4;
    eos349li #5;
    eoscomul #6;
|FIN;

|VARIABLES;
    LLeno40  = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
    Vacio40  = "                                        ";
    sw_imp   = 0;
    x        = 0;
    n        = "N";
    informe  = "";
    desde    = 0;
    hasta    = 0;
    contador1= 0;
    contador2= 0;
    contador3= 0;
    contador4= 0;
    entrega  = 0;
    adquisi  = 0;
    rectent  = 0;
    rectadq  = 0;
    linea1   = "";
    linea2   = "";
    linea3   = "";
    linea4   = "";
    resto    = 0;
    pp       = 0;
    tipo     = "";
    hojas    = 0;
    periodo  = 0;
    sw_fisica = 0;
    vacio_20  = "                    ";
    aTecla    = "";

    &numhoja = 0;
    &hoja    = 0;
    &dia     = "";
    &mes     = "";
    &anyo    = "";
    &tipo_p  = "";
    &nombrep = "";
    &enEjercicio = 0;
|FIN;

|INCLUYE i_cuadre;
|INCLUYE i_anyode;
|INCLUYE i_consul;

|PROCESO pinta_anyo; |TIPO 7;
|HAZ i_anyodef;
#0#25 = i_anyodef;
|PINTA #0#25;
|FPRC;

|PROCESO Mayus; |TIPO 0;
#0Campo = #0Campo > #0Campo;
|PINTA #0Campo;
|FPRC;

|PROCESO seleccion;
|SI #0#3 = "S";
    |PARA x = 4; |SI x [ 24; |HACIENDO x = x + 1;
          |C_M #0x, 1, "N";
          #0x = 0;
          |PINTA #0x;
    |SIGUE;
    |C_M #0#00, 1, "S";
    |C_M #0#01, 1, "S";
    |C_M #0#28, 1, "S";
|SINO;
    #0#0  = 00001; |PINTA #0#0;  |C_M #0#00, 1, "N";
    #0#1  = 99999; |PINTA #0#1;  |C_M #0#01, 1, "N";
    #0#28 = "C";   |PINTA #0#28; |C_M #0#28, 1, "N";

    |PARA x = 4; |SI x [ 24; |HACIENDO x = x + 1;
          |C_M #0x, 1, "S";
    |SIGUE;
|FINSI;
|FPRC;

|PROCESO borradim;
contador1 = 0;
contador2 = 0;
contador3 = 0;
contador4 = 0;
|PARA x = 0; |SI x [ 999; |HACIENDO x = x + 1;
     linea1 = "";
     linea2 = "";
     linea3 = "";
     linea4 = "";

     |AL_BUF entrega, x, linea1;
     |AL_BUF entrega, x, linea2;
     |AL_BUF entrega, x, linea3;
     |AL_BUF entrega, x, linea4;
|SIGUE;
|FPRC;

|PROCESO cuantia;
|SI #5#4 = "E";
    linea1 = #5#3;
    contador1 = contador1 + 1;
    |AL_BUF entrega, contador1, linea1;
|FINSI;
|SI #5#4 = "A";
    linea2 = #5#3;
    contador2 = contador2 + 1;
    |AL_BUF adquisi, contador2, linea2;
|FINSI;
|SI #5#4 = "R";
    linea3 = #5#3;
    contador3 = contador3 + 1;
    |AL_BUF rectent, contador3, linea3;
|FINSI;
|SI #5#4 = "X";
    linea4 = #5#3;
    contador4 = contador4 + 1;
    |AL_BUF rectadq, contador4, linea4;
|FINSI;
|FPRC;

|PROCESO imprelin;
hasta = pp * 20;
desde = hasta - 19;
|SI tipo = "E";
    |PARA x = desde; |SI x [ hasta; |HACIENDO x = x + 1;
          |DEL_BUF entrega, x, linea1;
          #5#0 = #1#0;
          #5#1 = #1#1;
          #5#2 = #1#2;
          #5#3 = linea1;
          |LEE 040#5=;
          |SI FSalida = 0; |PRINT; |FINSI;
    |SIGUE;
|FINSI;
|SI tipo = "A";
    |PARA x = desde; |SI x [ hasta; |HACIENDO x = x + 1;
          |DEL_BUF adquisi, x, linea2;
          #5#0 = #1#0;
          #5#1 = #1#1;
          #5#2 = #1#2;
          #5#3 = linea2;
          |LEE 040#5=;
          |SI FSalida = 0; |PRINT; |FINSI;
    |SIGUE;
|FINSI;
|SI tipo = "R";
    |PARA x = desde; |SI x [ hasta; |HACIENDO x = x + 1;
          |DEL_BUF rectent, x, linea3;
          #5#0 = #1#0;
          #5#1 = #1#1;
          #5#2 = #1#2;
          #5#3 = linea3;
          |LEE 040#5=;
          |SI FSalida = 0; |PRINT; |FINSI;
    |SIGUE;
|FINSI;
|SI tipo = "X";
    |PARA x = desde; |SI x [ hasta; |HACIENDO x = x + 1;
          |DEL_BUF rectadq, x, linea4;
          #5#0 = #1#0;
          #5#1 = #1#1;
          #5#2 = #1#2;
          #5#3 = linea4;
          |LEE 040#5=;
          |SI FSalida = 0; |PRINT; |FINSI;
    |SIGUE;
|FINSI;
|FPRC;

|PROCESO miratab;
|ET arriba3;
|PINPA #0#3;
#3#0 = #1#0;
#3#1 = #1#3;
|SI tipo = "E";
    #3#2 = "Coloque Hoja Entregas.            Pulse Tecla para Impresion";
    informe = "eosm1349";
|FINSI;
|SI tipo = "A";
    #3#2 = "Coloque Hoja Adquisiciones.       Pulse Tecla para Impresion";
    informe = "eosm2349";
|FINSI;
|SI tipo = "R";
    #3#2 = "Coloque Hoja Rectific.entregas.   Pulse Tecla para Impresion";
    informe = "eosm3349";
|FINSI;
|SI tipo = "X";
    #3#2 = "Coloque Hoja Rectific.Aquisicion. Pulse Tecla para Impresion";
    informe = "eosm4349";
|FINSI;

|PINTA #3#0;
|PINTA #3#1;
|ATRI P; |PINTA #3#2; |ATRI 0;
|LEETECLA aTecla;

|HAZ i_cuadre;

|IMPRE 0;
|SI FSalida ! 0;  |ACABA;  |FINSI;

|INFOR informe;
|SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

|HAZ imprelin;
|PIEINF;
|FININF;
|FINIMP;
|CONFI "2400NDesea imprimirlo de nuevo : ";
|SI FSalida = 0; |VETE arriba3; |FINSI;
|FPRC;

|PROCESO impreh1;
|ET arriba1;
     |PINPA #0#3;
     #3#0 = #1#0;
     #3#1 = #1#3;
     #3#2 = "Coloque Portada 349.              Pulse Tecla para Impresion";
     |PINTA #3#0;
     |PINTA #3#1;
     |ATRI P; |PINTA #3#2; |ATRI 0;
     |LEETECLA aTecla;

     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |HAZ i_cuadre;

     informe = "eosmp349";
     |INFOR informe;
     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     |HAZ Representante;
     #2#0 = #1#0;
     |LEE 040#2=;
     |SI FSalida ! 0; |DDEFECTO #2; |FINSI;

     #4#0 = #2#18;
     #4#1 = #2#19;
     |LEE 040#4=;
     |SI FSalida ! 0; |DDEFECTO #4; |FINSI;

     #0#30 = #1#6;
     #0#31 = #1#8;
     #0#32 = #1#10 + #1#11;
     #0#33 = #1#7;
     #0#34 = #1#9;
     #0#35 = 0;
     #0#36 = 0;
     #0#37 = #1#0;
     #0#38 = "X";
     #0#39 = "";
     #0#40 = "";
     #0#41 = "";
     #0#42 = "";

     |PRINT;
     |PIEINF;
     |FININF;
     |FINIMP;

     |CONFI "2400NDesea imprimirlo de nuevo : ";
     |SI FSalida = 0; |VETE arriba1; |FINSI;
|FPRC;

|PROCESO impreh2;
hojas = contador1 / 20;
resto = contador1 $ 20;
|SI resto ! 0; hojas = (hojas + 0.5) ! 0; |FINSI;
tipo = "E";
|PARA pp = 1; |SI pp [ hojas; |HACIENDO pp = pp + 1;
       numhoja = hojas;
       hoja    = pp;
      |HAZ miratab;
|SIGUE;
|FPRC;

|PROCESO impreh3;
hojas = contador2 / 20;
resto = contador2 $ 20;
|SI resto ! 0; hojas = (hojas + 0.5) ! 0; |FINSI;
tipo = "A";
|PARA pp = 1; |SI pp [ hojas; |HACIENDO pp = pp + 1;
       numhoja = hojas;
       hoja    = pp;
      |HAZ miratab;
|SIGUE;
|FPRC;

|PROCESO impreh4;
hojas = contador3 / 20;
resto = contador3 $ 20;
|SI resto ! 0; hojas = (hojas + 0.5) ! 0; |FINSI;
tipo = "R";
|PARA pp = 1; |SI pp [ hojas; |HACIENDO pp = pp + 1;
       numhoja = hojas;
       hoja    = pp;
      |HAZ miratab;
|SIGUE;
|FPRC;

|PROCESO impreh5;
hojas = contador4 / 20;
resto = contador4 $ 20;
|SI resto ! 0; hojas = (hojas + 0.5) ! 0; |FINSI;
tipo = "X";
|PARA pp = 1; |SI pp [ hojas; |HACIENDO pp = pp + 1;
       numhoja = hojas;
       hoja    = pp;
      |HAZ miratab;
|SIGUE;
|FPRC;

|PROCESO hojas;
tipo_p = "T";
|SI periodo = 0; tipo_p = "A"; |FINSI;

sw_imp = 0;
|SI #0#3 = "N";
   |PARA x = 4; |SI x [ 24; |HACIENDO x = x + 1;
         |SI #0x = #1#0; sw_imp = 1; |FINSI;
   |SIGUE;
|SINO;
   sw_imp = 1;
|FINSI;

|SI sw_imp = 1;
   |HAZ borradim;
   |BUCLELIN 0cuantia#1;

   |HAZ impreh1;

   |ABRE #5;
   |HAZ impreh2;
   |HAZ impreh3;
   |HAZ impreh4;
   |HAZ impreh5;
   |CIERRA #5;

   #1#4 = #0#2;
   #1#5 = "N";
   |GRABA 020#1a;
   |LIBERA #1;
|FINSI;
|FPRC;

|PROCESO Representante;
#2#0 = #1#0;
|LEE 040#2=;
|SI FSalida ! 0; |DDEFECTO #2; |FINSI;

nombrep   = "";
sw_fisica = 0;

#6#0 = #2#0;
#6#1 = 1;
#6#2 = 1;
#6#7 = #0#25;
|LEE 040#6];
|SI FSalida = 0; |Y #6#0 = #2#0; |Y #6#7 = #0#25;
    #2#0 = #6#3;
    |LEE 040#2=;
    |SI FSalida = 0; sw_fisica = 1; nombrep = #2#2; |FINSI;
|FINSI;

|SI sw_fisica = 1; |ACABA; |FINSI;

#2#0 = #1#0;
|LEE 040#2=;
|SI FSalida ! 0; |DDEFECTO #2; |FINSI;

nombrep = #2#2;

|SI #2#24 ! vacio_20; |O #2#25 ! vacio_20;
     nombrep = #2#25;
     |QBF nombrep;
     nombrep = nombrep + " " + #2#24;
     |ACABA;
|FINSI;
|SI #2#29 ! vacio_20; |O #2#30 ! vacio_20;
     nombrep = #2#30;
     |QBF nombrep;
     nombrep = nombrep + " " + #2#29;
     |ACABA;
|FINSI;
|SI #2#34 ! vacio_20; |O #2#35 ! vacio_20;
     nombrep = #2#35;
     |QBF nombrep;
     nombrep = nombrep + " " + #2#34;
     |ACABA;
|FINSI;
|FPRC;

|DEFBUCLE eos349caC;
#1#1;
5;
#0#0, #0#25, periodo, n;
#0#1, #0#25, periodo, n;
be;
NULL,hojas;
|FIN;

|DEFBUCLE eos349caN;
#1#2;
5;
Vacio40, #0#0, #0#25, periodo, n;
LLeno40, #0#1, #0#25, periodo, n;
be;
NULL,hojas;
|FIN;

|PROCESO impre; |TIPO 3;
|DIMENSIONA 1000, entrega, 0;
|DIMENSIONA 1000, adquisi, 0;
|DIMENSIONA 1000, rectent, 0;
|DIMENSIONA 1000, rectadq, 0;

enEjercicio = 2000 + #0#25;
|SI #0#25 ] 80;
    enEjercicio = 1900 + #0#25;
|FINSI;

|HAZ fechapre;

|ABRE #2;
|ABRE #4;
|ABRE #6;

|SI #0#28 = "C";
    periodo = #0#26; |BUCLE eos349caC;
    |SI #0#26 = 4;
        periodo = 0; |BUCLE eos349caC;
    |FINSI;
|SINO;
    periodo = #0#26; |BUCLE eos349caN;
    |SI #0#26 = 4;
        periodo = 0; |BUCLE eos349caN;
    |FINSI;
|FINSI;

|CIERRA #2;
|CIERRA #4;
|CIERRA #6;

|FINDIM entrega;
|FINDIM adquisi;
|FINDIM rectent;
|FINDIM rectadq;
|FPRC;

|PROCESO fechapre;
dia  = #0#2 % 102;
anyo = #0#2 % -104;
mes  = #0#2 % 402;
|SI mes = "01"; mes = "Enero     "; |FINSI;
|SI mes = "02"; mes = "Febrero   "; |FINSI;
|SI mes = "03"; mes = "Marzo     "; |FINSI;
|SI mes = "04"; mes = "Abril     "; |FINSI;
|SI mes = "05"; mes = "Mayo      "; |FINSI;
|SI mes = "06"; mes = "Junio     "; |FINSI;
|SI mes = "07"; mes = "Julio     "; |FINSI;
|SI mes = "08"; mes = "Agosto    "; |FINSI;
|SI mes = "09"; mes = "Septiembre"; |FINSI;
|SI mes = "10"; mes = "Octubre   "; |FINSI;
|SI mes = "11"; mes = "Noviembre "; |FINSI;
|SI mes = "12"; mes = "Diciembre "; |FINSI;
|FPRC;
