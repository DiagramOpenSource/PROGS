|FICHEROS;
     dsmoy000;
     dsmoy349;
     eosclien;

     eos349ca;
     eos349li;

     dsmow538;
     dsmow539;
|FIN;

|VARIABLES;
     nCampo       = 0;
     nHandle1     = 0;
     nHandle2     = 0;
     nAnyo        = 0;
     nDEmpresa    = 0;
     nHEmpresa    = 0;
     nEjer        = 0;
     nBoton       = 0;
     nBoton1      = 0;
     nBoton2      = 0;
     nBoton3      = 0;

     aAlfa         = "";
     aAbre         = "";
     aPathLanza    = "";
     aPathEmision  = "";
     aPathInternet = "";
     aF2           = "";
     aF3           = "";
     aF4           = "";
     aTecla        = "";
     aPathAfegir   = "";
     aPathInter    = "";
     aBue          = "";
     aNombre       = "";
     aOrigen       = "";
     aDestino      = "";
     aFichero      = "";
     aIPRemoto     = "";
     perialf       = "";

     fFecha        = @;

     &eaFOrigen    = "";
     &eaFDestino   = "";
     &eaTipoE      = "";
     &eaTipoR      = "";
     &eaTipoV      = "";
     &enCalcCif    = 0;
     &eaVarDni     = "";
     &eaAlfa       = "";
     &enNume       = 0;
     &eaFichError  = "";
     &eaFichDatos  = "";
     &eaFichAuxil  = "";
     &enValidacion = 0;
     &enBuenos     = 0;
     &enMalos      = 0;

     &eaUnidad           = "";
     &eaModelos          = "";
     &enAnyo             = 0;
     &eaEjer             = "";
     &eaPeriodo          = "";
     &eaFicheroPlano     = "";
     &eaOpcion           = "";
     &enErrorPortal      = 0;
     &eaFicheroImpre     = "";
     &eaFicheroSalid     = "";
     &eaFicheroError     = "";
     &enEmpresa          = 0;
     &eaNomEmpresa       = "";
     &eaPathLanza        = "";
     &eaPathEjecu        = "";
     &eaPathEmision      = "";
     &eaPathInternet     = "";
     &enPresentar        = 0;
     &nSw  = 0;
|FIN;

|INCLUYE i_consul;

|PROCESO Tipo0C39;   |TIPO 0;
     |C_M #dsmoy349#40, 1, "S";

     |SI #dsmoy349#39 = 0;
         |C_M #dsmoy349#40, 1, "N";
         #dsmoy349#40 = "A";  |PINTA #dsmoy349#40;
     |FINSI;

     |SI #dsmoy349#39 ] 5;
         |C_M #dsmoy349#40, 1, "N";
         #dsmoy349#40 = "M";  |PINTA #dsmoy349#40;
     |FINSI;
|FPRC;

|PROCESO Tipo0C0Emi;   |TIPO 0;
   |SI #dsmoy349#0 = "S";
      |C_M #dsmoy349#1,1,"S";
      |C_M #dsmoy349#2,1,"S";
      |PARA nCampo = 3; |SI nCampo [ 38; |HACIENDO nCampo = nCampo + 1;
         |C_M #dsmoy349#nCampo#, 1, "N";
      |SIGUE;
   |SINO;
      |C_M #dsmoy349#1, 1, "N";
      |C_M #dsmoy349#2, 1, "N";
      |PARA nCampo = 3; |SI nCampo [ 38; |HACIENDO nCampo = nCampo + 1;
         |C_M #dsmoy349#nCampo#, 1, "S";
      |SIGUE;
   |FINSI;
|FPRC;

|PROCESO Tipo7C0Emi; |TIPO 7;
       fFecha = ~;
       aAlfa  = fFecha % -104;
       #dsmoy349#41   = aAlfa;
       |PINTA #dsmoy349#41;
|FPRC;
|| -------------------------------------------------------------------------

|PROCESO Registro1;
     #eosclien#0 = #eos349ca#0;
     |LEE 000#eosclien.=;
     |SI FSalida ! 0;  |DDEFECTO #eosclien;  |FINSI;

     |DDEFECTO #dsmow538;

     #dsmow538#0   = "1";

     #dsmow538#1   = "349";

     #dsmow538#2   = #dsmoy349#41;

     enCalcCif = 3;
     eaVarDni  = #eosclien#1;  |HAZ CalculoDNI;
     #dsmow538#3    = eaVarDni;

     eaAlfa   = #eosclien#2;   |HAZ QuitaRaros;
     #dsmow538#4   = eaAlfa;

     #dsmow538#5   = "T";

     eaAlfa   = #eosclien#14;  |HAZ QuitaRarosTfno;
     #dsmow538#6   = eaAlfa;

     eaAlfa   = #eosclien#2;   |HAZ QuitaRaros;
     #dsmow538#7   = eaAlfa;

     #dsmow538#8   = "3490000000000";

     |SI #eos349ca#16 = "C";
         #dsmow538#9 = "C";
         #dsmow538#11 = #eos349ca#17;
     |FINSI;

     |SI #eos349ca#16 = "S";
         #dsmow538#10 = "S";
         #dsmow538#11 = #eos349ca#17;
     |FINSI;

     |SI #eos349ca#18 = "M";
         #dsmow538#12 = (("00" + #eos349ca#1) % -102);

         |SI #eos349ca#19 = "S";   #dsmow538#17 = "X";  |FINSI;
     |FINSI;

     |SI #eos349ca#18 = "T";
         |SI #eos349ca#1 = 1;   #dsmow538#12 = "1T";  |FINSI;
         |SI #eos349ca#1 = 2;   #dsmow538#12 = "2T";  |FINSI;
         |SI #eos349ca#1 = 3;   #dsmow538#12 = "3T";  |FINSI;
         |SI #eos349ca#1 = 4;   #dsmow538#12 = "4T";  |FINSI;
     |FINSI;

     |SI #eos349ca#18 = "A";
         #dsmow538#12 = "0A";
     |FINSI;

     enNume   = #eos349ca#6 + #eos349ca#8;
     #dsmow538#13  = ("000000000" + enNume) % -109;

     enNume   = #eos349ca#7 + #eos349ca#9;  |HAZ Conver15;
     #dsmow538#14  = eaAlfa;

     enNume   = #eos349ca#10 + #eos349ca#11;
     #dsmow538#15  = ("000000000" + enNume) % -109;

     enNume   = #eos349ca#14 + #eos349ca#15;  |HAZ Conver15;
     #dsmow538#16  = eaAlfa;

     #dsmow538#21  = &13 + &10;

     aAlfa = "";
     |PARA nCampo = 0;  |SI nCampo [ 21;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #dsmow538#nCampo#;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;
|FPRC;

|PROCESO eos349li;  || Registro 2
     |DDEFECTO #dsmow539;

     #dsmow539#0  = "2";

     #dsmow539#1  = "349";

     #dsmow539#2  = #dsmow538#2;
     #dsmow539#3  = #dsmow538#3;
     #dsmow539#4  = "";

     #dsmow539#5  = #eos349li#5;
     |SI #eos349li#5 = "GR ";  #dsmow539#5 = "EL";  |FINSI;

     #dsmow539#6  = #eos349li#6;

     #dsmow539#7  = #eos349li#7;

     |SI #eos349li#4  = "A";  #dsmow539#8 = "A";  |FINSI;
     |SI #eos349li#4  = "E";  #dsmow539#8 = "E";  |FINSI;
     |SI #eos349li#4  = "I";  #dsmow539#8 = "I";  |FINSI;
     |SI #eos349li#4  = "S";  #dsmow539#8 = "S";  |FINSI;
     |SI #eos349li#4  = "M";  #dsmow539#8 = "M";  |FINSI;
     |SI #eos349li#4  = "H";  #dsmow539#8 = "H";  |FINSI;

     |SI #eos349li#4  = "X";  #dsmow539#8 = "A";  |FINSI;
     |SI #eos349li#4  = "R";  #dsmow539#8 = "E";  |FINSI;
     |SI #eos349li#4  = "Y";  #dsmow539#8 = "I";  |FINSI;
     |SI #eos349li#4  = "Z";  #dsmow539#8 = "S";  |FINSI;
     |SI #eos349li#4  = "W";  #dsmow539#8 = "M";  |FINSI;
     |SI #eos349li#4  = "V";  #dsmow539#8 = "H";  |FINSI;

     |SI #eos349li#13 = "X";  #dsmow539#8 = "T";  |FINSI;

     |SI #eos349li#4 = "A";  |O #eos349li#4 = "E";  |O #eos349li#4 = "S";  |O #eos349li#4 = "I"; |O #eos349li#4 = "M"; |O #eos349li#4 = "H";
         enNume = #eos349li#8;   |HAZ Conver13;
         #dsmow539#9 = eaAlfa;

         #dsmow539#10 = "";

         #dsmow539#11 = "";

         #dsmow539#12 = "";

         #dsmow539#13 = "";
     |SINO;
         #dsmow539#9  = "";

         nEjer   = 2000  + #eos349li#11;
         #dsmow539#10 = nEjer;

         |SI #eos349li#12 = 0;   #dsmow539#11 = "0A";   |FINSI;
         |SI #eos349li#12 = 1;   #dsmow539#11 = "1T";   |FINSI;
         |SI #eos349li#12 = 2;   #dsmow539#11 = "2T";   |FINSI;
         |SI #eos349li#12 = 3;   #dsmow539#11 = "3T";   |FINSI;
         |SI #eos349li#12 = 4;   #dsmow539#11 = "4T";   |FINSI;
         |SI #eos349li#12 = 11;  #dsmow539#11 = "01";   |FINSI;
         |SI #eos349li#12 = 12;  #dsmow539#11 = "02";   |FINSI;
         |SI #eos349li#12 = 13;  #dsmow539#11 = "03";   |FINSI;
         |SI #eos349li#12 = 14;  #dsmow539#11 = "04";   |FINSI;
         |SI #eos349li#12 = 15;  #dsmow539#11 = "05";   |FINSI;
         |SI #eos349li#12 = 16;  #dsmow539#11 = "06";   |FINSI;
         |SI #eos349li#12 = 17;  #dsmow539#11 = "07";   |FINSI;
         |SI #eos349li#12 = 18;  #dsmow539#11 = "08";   |FINSI;
         |SI #eos349li#12 = 19;  #dsmow539#11 = "09";   |FINSI;
         |SI #eos349li#12 = 20;  #dsmow539#11 = "10";   |FINSI;
         |SI #eos349li#12 = 21;  #dsmow539#11 = "11";   |FINSI;
         |SI #eos349li#12 = 22;  #dsmow539#11 = "12";   |FINSI;

         enNume = #eos349li#8;   |HAZ Conver13;
         #dsmow539#12  = eaAlfa;

         enNume = #eos349li#28;  |HAZ Conver13;
         #dsmow539#13  = eaAlfa;
     |FINSI;

     #dsmow539#16 = &13 + &10;

     aAlfa = "";
     |PARA nCampo = 0;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #dsmow539#nCampo#;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;
|FPRC;

|DEFBUCLE eos349li;
     #eos349li#1;
     ;
     #eos349ca#0, #eos349ca#2, #eos349ca#1, 001;
     #eos349ca#0, #eos349ca#2, #eos349ca#1, 999;
     ;
     NULL, eos349li;
|FIN;

|PROCESO eos349ca;
     nSw = 1;
     aAbre = aPathEmision + "349" + (("00000" + #eos349ca#0) % -105) + ".TXT";
     |XABRE "BW", aAbre, nHandle2;

     |HAZ Registro1;

     |BUCLE eos349li;

     |XCIERRA nHandle2;

     eaFOrigen  = aPathEmision + "349" + (("00000" + #eos349ca#0) % -105) + ".TXT";
     eaFDestino = aPathLanza   + "349" + (("00000" + #eos349ca#0) % -105) + ".TXT";
     |HAZ CopiaFicheroIP;

     |FBORRA eaFOrigen;

     eaModelos = "349";
     eaTipoE   =  "349" + (("00000" + #eos349ca#0) % -105) + ".TXT";
     eaTipoR   =  "CCC" + (("00000" + #eos349ca#0) % -105) + ".TXT";
     eaTipoV   =  "S";
     |HAZ LineaShellJava;
|FPRC;

|DEFBUCLE eos349ca;
     #eos349ca#1;
     18, 5;
     nDEmpresa, nAnyo, #dsmoy349#39, #dsmoy349#40, "N";
     nHEmpresa, nAnyo, #dsmoy349#39, #dsmoy349#40, "N";
     be;
     NULL, eos349ca;
|FIN;

|PROCESO CreaUnico;
     |DBASE aPathAfegir;  |QBF aPathAfegir;
     aPathAfegir = aPathAfegir + "basura";      |MKDIR aPathAfegir;
     aPathAfegir = aPathAfegir + "/tmp";        |MKDIR aPathAfegir;
     aPathAfegir = aPathAfegir + "/";

     aNombre = "34900000.txt";
     |PINTA 1320, "Nombre Fichero: ";
     |PINTA 1346, ".TXT";

     E_inf   = "";
     E_sup   = "8";
     |PARA;  |SI;  |HACIENDO;
             aNombre = 1336 ? 1;  |QBF aNombre;

             aAbre = aPathInternet + aNombre + ".txt";
             |XABRE "EC", aAbre, nHandle1;
             |SI FSalida ] 0;
                 |CONFI "0000NEl Fichero ya existe, desea reemplazarlo.";
                 |SI FSalida = 0;  |SAL;  |FINSI;
             |SINO;
                 |SAL;
             |FINSI;
     |SIGUE;

     aDestino = aPathInternet + aNombre + ".txt";
     |RFBORRA aDestino;

     aFichero    = aPathAfegir + "*.*";
     |_PDIR aFichero;
     |PARA; |SI; |HACIENDO;
            |SI FSalida ! 0; |SAL; |FINSI;
            |FBORRA aFichero;
            |_SDIR aFichero;
     |SIGUE;

     aIPRemoto   = "";
     |IP_REMOTO aIPRemoto;

     aPathInter  = aPathLanza + "AInternet";
     aPathInter  = aPathInter + "/";
     aFichero    = aPathInter + "*.bue";
     |R_PDIR aFichero;
     |PARA; |SI; |HACIENDO;
            |SI FSalida ! 0; |SAL; |FINSI;

            aBue     = aFichero - aPathInter;
            aDestino = aPathAfegir + aBue;

            |SI aIPRemoto = "";
                |COPIA_FICHERO aFichero, aDestino;
            |SINO;
                |RECIBE_FICHERO aFichero, aDestino;
            |FINSI;

            |RFBORRA aFichero

            aOrigen  = aDestino;
            aDestino = aPathAfegir + aNombre + ".txt";
            |AFEGIR_FICHERO aOrigen, aDestino;

            |FBORRA aOrigen

            |ABRE #eos349ca;
            aAlfa  = aBue % 405;
            #eos349ca#0 = aAlfa;
            #eos349ca#1 = #dsmoy349#39;
            #eos349ca#2 = nAnyo;
            |LEE 101#eos349ca.=;
            |SI FSalida = 0;
                #eos349ca#4 = #dsmoy349#42;
                |GRABA 020#eos349ca.a;
                |LIBERA #eos349ca;
            |FINSI;
            |CIERRA #eos349ca;

            |R_SDIR aFichero;
     |SIGUE;

     aOrigen  = aDestino;
     aDestino = aPathInternet  + aNombre + ".txt";
     |SI aIPRemoto = "";
         |COPIA_FICHERO aOrigen, aDestino;
     |SINO;
         |ENVIA_FICHERO aOrigen, aDestino;
     |FINSI;

     |FBORRA aOrigen;

     aAlfa =  "      Los ficheros generados estan: " + aPathInternet + " de su PC";
     |MENAV aAlfa;
|FPRC;

|PROCESO CreaVarios;
     aIPRemoto   = "";
     |IP_REMOTO aIPRemoto;

     aPathInter  = aPathLanza +  "AInternet/";
     aFichero    = aPathInter + "*.bue";
     |R_PDIR aFichero;
     |PARA; |SI; |HACIENDO;
            |SI FSalida ! 0; |SAL; |FINSI;

            aBue     = aFichero - aPathInter;
            aDestino = aPathInternet + "349" + (aBue % 405) + ".txt";

            |RCOPIA_FICHERO aFichero, aDestino;

            |RFBORRA aFichero;

            |ABRE #eos349ca;
            aAlfa  = aBue % 405;
            #eos349ca#0 = aAlfa;
            #eos349ca#1 = #dsmoy349#39;
            #eos349ca#2 = nAnyo;
            |LEE 101#eos349ca.=;
            |SI FSalida = 0;
                #eos349ca#4 = #dsmoy349#42;
                |GRABA 020#eos349ca.a;
                |LIBERA #eos349ca;
            |FINSI;
            |CIERRA #eos349ca;

            |R_SDIR aFichero;
     |SIGUE;

     aAlfa =  "      Los ficheros generados estan: " + aPathInternet + " de su PC";
     |MENAV aAlfa;
|FPRC;

|PROCESO Boton3491;
     |PTEC 824;
|FPRC;

|PROCESO Boton3492;
     |PTEC 825;
|FPRC;

|PROCESO Boton3496;
     |PTEC 806;
|FPRC;

|PROCESO Internet2010;
     |SI nSw = 0; |ACABA; |FINSI;
     |BLANCO 0501 2380;

     eaFichError  = "ccc";
     eaFichDatos  = "349";
     eaFichAuxil  = "";
     enValidacion = 1;

     |HAZ BuscaErroresL;

     |SI enBuenos = 0;
         |MENAV "      Ha habido Errores, arreglelos y vuelva a emitir.";
         |ACABA;
     |FINSI;

     aAlfa = "EMPRESAS VALIDADAS  ...: " + enBuenos;
     |PINTA 0630, aAlfa;

     aAlfa = "EMPRESAS NO VALIDADAS .: " + enMalos;
     |PINTA 0730, aAlfa;

     |CONTROL_SIMPLE 0, " BOTON, <F2> CREAR UN UNICO FICHERO CON LAS EMPRESAS VALIDADAS ", 1120, 1265, Boton3491;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, " BOTON, <F3> FICHERO POR CADA UNA DE LAS EMPRESAS VALIDADAS", 1320, 1465, Boton3492;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, " BOTON,   CANCELAR    ", 1520, 1665, Boton3496;
     nBoton3 = FSalida;

     aF2 = &255 + "824";
     aF3 = &255 + "825";
     aF4 = &255 + "806";
     |PARA; |SI;  |HACIENDO;
            |LEETECLA aTecla;
            |SI aTecla = aF2;  nBoton = 1;  |SAL;  |FINSI;
            |SI aTecla = aF3;  nBoton = 2;  |SAL;  |FINSI;
            |SI aTecla = aF4;  |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;

     |PULSATECLA;

     |SI aTecla = aF4;  |ACABA;  |FINSI;

     |SI nBoton = 1;  |HAZ CreaUnico;   |FINSI;
     |SI nBoton = 2;  |HAZ CreaVarios;  |FINSI;
|FPRC;

|PROCESO Bloque2012;
     aPathLanza    = eaPathLanza;
     aPathEmision  = eaPathEmision;
     aPathInternet = eaPathInternet;
     |ABRE #eosclien;
     |SI #dsmoy349#33 = "N";
         nDEmpresa = #dsmoy349#1;
         nHEmpresa = #dsmoy349#2;
         |BUCLE eos349ca;
     |SINO;
         |PARA nCampo = 3; |SI nCampo [ 38; |HACIENDO nCampo = nCampo + 1;
               |SI #dsmoy349#nCampo# ! 0;
                   nDEmpresa = #dsmoy349#nCampo#;
                   nHEmpresa = #dsmoy349#nCampo#;
                   |BUCLE eos349ca;
               |FINSI;
         |SIGUE;
     |FINSI;
     |CIERRA #eosclien;

     |HAZ Internet2010;
|FPRC;

|PROCESO eos349ca_2013;
     nSw = 1;
     eaFicheroPlano = "349" + (("00000" + #eos349ca#0) % -105) + ".txt";
     eaFicheroImpre = "349" + (("00000" + #eos349ca#0) % -105) + ".imp";
     eaFicheroSalid = "349" + (("00000" + #eos349ca#0) % -105) + ".sal";
     eaFicheroError = "err" + (("00000" + #eos349ca#0) % -105) + ".txt";

     aAbre = eaPathEmision + eaFicheroPlano;
     |XABRE "BW", aAbre, nHandle2;

     |HAZ Registro1;

     |BUCLE eos349li;

     |XCIERRA nHandle2;

     enEmpresa    = #eosclien#0;
     eaNomEmpresa = #eosclien#2;

     |HAZ PresentaPortal;
|FPRC;

|DEFBUCLE eos349ca_2013;
     #eos349ca#1;
     18, 5;
     nDEmpresa, nAnyo, #dsmoy349#39, #dsmoy349#40, "N";
     nHEmpresa, nAnyo, #dsmoy349#39, #dsmoy349#40, "N";
     be;
     NULL, eos349ca_2013;
|FIN;

|PROCESO Bloque2013;
     |HAZ PreguntaPresentacion;
     |HAZ TraeTgzCobol;

     |ABRE #eosclien;
     |SI #dsmoy349#33 = "N";
         nDEmpresa = #dsmoy349#1;
         nHEmpresa = #dsmoy349#2;
         |BUCLE eos349ca_2013;
     |SINO;
         |PARA nCampo = 3; |SI nCampo [ 38; |HACIENDO nCampo = nCampo + 1;
               |SI #dsmoy349#nCampo# ! 0;
                   nDEmpresa = #dsmoy349#nCampo#;
                   nHEmpresa = #dsmoy349#nCampo#;
                   |BUCLE eos349ca_2013;
               |FINSI;
         |SIGUE;
     |FINSI;
     |CIERRA #eosclien;

     |HAZ SacaErrorPtl;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;
     |HAZ LeeUnidad;

     #dsmoy000#0  = 349;
     #dsmoy000#4  = #dsmoy349#39;
     #dsmoy000#6  = #dsmoy349#41;

     enAnyo     = #dsmoy349#41;
     eaEjer     = #dsmoy349#41;
     eaModelos  = "349";
     eaOpcion   = "3";

     perialf = ("00" + #dsmoy349#39) % -102;
     |SI #dsmoy349#40 = "T";
         |SI #dsmoy349#39 = 1; perialf = "1T"; |FINSI;
         |SI #dsmoy349#39 = 2; perialf = "2T"; |FINSI;
         |SI #dsmoy349#39 = 3; perialf = "3T"; |FINSI;
         |SI #dsmoy349#39 = 4; perialf = "4T"; |FINSI;
    |FINSI;

     eaPeriodo   = perialf;
     eaPathLanza = eaUnidad + "\MODELOS";            |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\" + eaModelos;    |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\" + eaEjer;       |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\" + perialf;      |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\";

     |DBASE eaPathEmision;
     eaPathEmision = eaPathEmision + "emisiones";       |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + eaModelos;   |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + eaEjer;      |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + perialf;     |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/";

     eaPathInternet = eaUnidad + "/AEAT";                |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/INTERNET";      |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + eaModelos;  |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + eaEjer;     |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + perialf;    |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/";

     aAlfa = #dsmoy349#41;
     aAlfa = aAlfa % -102;
     nAnyo = aAlfa;
     nSw   = 0;
     |SI #dsmoy349#41 [ 2012;  |HAZ Bloque2012;  |FINSI;
     |SI #dsmoy349#41 = 2013;  |HAZ Bloque2013;  |FINSI;
     |SI #dsmoy349#41 = 2014;  |HAZ Bloque2013;  |FINSI;
     |SI #dsmoy349#41 = 2015;  |HAZ Bloque2013;  |FINSI;
     |SI #dsmoy349#41 = 2016;  |HAZ Bloque2013;  |FINSI;
     |SI #dsmoy349#41 = 2017;  |HAZ Bloque2013;  |FINSI;

     |SI #dsmoy349#41 ] 2018;
         |HAZ Bloque2018;
         |ACABA;
     |FINSI;

     |SI enPresentar = 0;
         |SI nSw ! 0;
             aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
         |SINO;
             aAlfa =  "      Seleccion Vacia";
         |FINSI;
         |MENAV aAlfa;
     |FINSI;
|FPRC;
