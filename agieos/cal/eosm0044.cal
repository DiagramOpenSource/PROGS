|FICHEROS;
     eosclipr #103;
     eosm0040 #30;
     eosm0042 #32,MANTE;
     eosm0045 #29;
     eosm0046 #46;
     eosm0044 #34,MANTE;
|FIN;

|VARIABLES;
      aAlfa        = "";
      aTecla       = "";
      aTecla1      = "";
      aTecla2      = "";

      nTecla    = 0;
      nCampo    = 0;
      nCampo1   = 0;
      nEdad     = 0;

     &eaVarDni  = "";
     &enCalcCif = 1;
     &enMensaje = 1;
     &eaNif     = "";

      &PerDin = 0;
      &RetDin = 0;
      &PerEsp = 0;
      &RetEsp = 0;
      &NumPer = 0;
|FIN;

|PROCESO Borra42;
     |BORRA 020#32a;
     |LIBERA #32;
|FPRC;

|DEFBUCLE eosm0042;
     #32#1;
     ;
     #30#0, #30#1, "            ", 01,    0;
     #30#0, #30#1, "zzzzzzzzzzzz", 99, 9999;
     be;
     NULL, Borra42;
|FIN;

|PROCESO Graba42;
     #32#0  = #34#0;
     #32#1  = #34#1;
     #32#2  = #34#2;
     #32#9  = 12;
     |SI #34#3 ! 0;  #32#9 = #34#3;  |FINSI;
     #32#3  = #34#4;
     #32#5  = #34#5;
     #32#4  = (#32#5 / #32#3) * 100;
     #32#6  = #34#6;
     #32#8  = #34#7;
     #32#7  = (#32#8 / #32#6) * 100;
     #32#4  = #34#16;
     |GRABA 020#32n;
     |LIBERA #32;

     #46#0 = #34#0;
     |LEE 101#46=;
     |SI FSalida ! 0;
         #46#0 = #34#0;
         #46#1 = #30#2;
         #46#2 = "T";
         |GRABA 020#46n;
     |FINSI;
     |LIBERA #46;

     #29#0 = #34#0;
     #29#1 = #34#2;
     #29#4 = #34#16;
     |LEE 101#29=;
     |SI FSalida ! 0;
         |DDEFECTO #29;
         #29#0  = #34#0;
         #29#1  = #34#2;
         #29#2  = #34#12;
         #29#3  = #34#9;
         #29#4  = #34#16;
         |GRABA 020#29n;
     |FINSI;
     |LIBERA #29;

     #103#0 = #34#2;
     |LEE 101#103=;
     |SI FSalida ! 0;
         |DDEFECTO #103;
         #103#0  = #34#2;
         #103#1  = #34#12;
         aAlfa   = #34#10 % 102;  #103#7 = aAlfa;
         aAlfa   = #34#10 % 303;  #103#8 = aAlfa;
         #103#10 = #34#11;
         |GRABA 020#103n;
     |FINSI;
     |LIBERA #103;
|FPRC;

|DEFBUCLE eosm0044;
     #34#1;
     ;
     #30#0, #30#1, "            ",  0000, 01;
     #30#0, #30#1, "zzzzzzzzzzzz",  9999, 99;
     be;
     NULL, Graba42;
|FIN;

|RUTINA ClaveBaja29;
     #29#0 = #34#0;
     #29#1 = "           ";
     #29#4 = 01;
|FRUT;

|RUTINA ClaveAlta29;
     #29#0 = #34#0;
     #29#1 = "zzzzzzzzzzzz";
     #29#4 = 99;
|FRUT;

|PROCESO LetraDnim34;  |TIPO 11;
     nTecla = FSalida;

     |SI nTecla = 10;
         eaVarDni  = #34Campo;
         enCalcCif = 1;
         |HAZ CalculoDNI;
         #34Campo = eaVarDni;
         |PINTA #34Campo;
         |ERROR;
     |FINSI;

     |SI nTecla = 11;
         enMensaje = 1;
         eaNif     = "";

         |PUSHV 0501 2380;
         |ENTLINEAL #1#29, -3, 4, 22, 1, ClaveBaja29, ClaveAlta29;
         |POPV;
         |SI eaNif ! "";
             #34#2 = eaNif;
             |PINTA #34#2;
         |FINSI;
     |FINSI;

     |SI nTecla = 12;
         |PUSHV 0501 2380;
         |CUADRO 0709 2365;
         |BLANCO 0810 2264;
         |PINTA 0810, "ESTE PROCESO ES SOLO PARA AQUELLOS QUE HAN INTRODUCIDO ";
         |PINTA 0910, "MANUALMENTE POR EL MANTENIMIENTO DEL 115 Y 180 TODAS   ";
         |PINTA 1010, "LAS RETENCIONES. EL PROCESO BORRA LA ENTRADA POR ARREN-";
         |PINTA 1110, "DADORES Y CREA UN APUNTE POR CADA PERCEPTOR QUE HAY EN ";
         |PINTA 1210, "EL 180, PARA PODER CALCULAR EL MODELO DEL 115 DEL ULTI-";
         |PINTA 1310, "MO PERIODO Y PODER EMITIR LOS CERTIFICADOS.            ";
         |PINTA 1410, "컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴";
         |PINTA 1610, "PULSE ESCAPE PARA ABORTAR                              ";
         |PINTA 1710, "PULSE [F10]  PARA CONTINUAR.                           ";

         aTecla   = "";
         aTecla1  = &255 + "806";
         aTecla2  = &255 + "832";
         |PARA; |SI aTecla ! aTecla1; |Y aTecla ! aTecla2;  |HACIENDO;
                |LEETECLA aTecla;
         |SIGUE;

         |SI aTecla = aTecla1;  |ERROR;  |POPV;  |ACABA;  |FINSI;

         |CONFI "2400NEsta seguro de Continuar : ";
         |SI FSalida ! 0;  |ERROR;  |POPV;  |ACABA;  |FINSI;
         |POPV;

         |BUCLE eosm0042;

         |ABRE #29;
         |ABRE #46;
         |ABRE #32;
         |ABRE #103;
         |BUCLE eosm0044;
         |CIERRA #29;
         |CIERRA #46;
         |CIERRA #32;
         |CIERRA #103;

         #34#0 = #30#0;
         #34#1 = #30#1;
         #34#2 = "            ";
         #34#3 = 0;
         |LEE 040#34];

         |PTEC 807;
         |PTEC 807;
     |FINSI;
|FPRC;

|PROCESO LetraDnim34C;  |TIPO 6;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     eaVarDni  = #34Campo;
     enCalcCif = 1;
     |HAZ CalculoDNI;
     #34Campo = eaVarDni;
     |PINTA #34Campo;
|FPRC;

|PROCESO RecogeTRelacion;  |TIPO 7;
     |ABRE #29;
     #29#0 = #34#0;
     #29#1 = #34#2;
     #29#4 = #34#16;
     |LEE 040#29=;
     |SI FSalida ! 0;  |CIERRA #29;  |ACABA;  |FINSI;
     |CIERRA #29;
|FPRC;

|PROCESO RecogeArrendador;  |TIPO 7;
     |ABRE #29;
     #29#0 = #34#0;
     #29#1 = #34#2;
     #29#4 = #34#16;
     |LEE 040#29=;
     |SI FSalida ! 0;  |DDEFECTO #29;  |FINSI;
     |CIERRA #29;
     #eosm0044#12 = #29#2;

     |ABRE #103;
     #103#0 = #34#2;
     |LEE 040#103=;
     |SI FSalida ! 0;
        |DDEFECTO #103;
     |SINO;
        #eosm0044#12 = #eosclipr#1;
     |FINSI;
     |CIERRA #103;
|FPRC;

|PROCESO RetocaCab; |TIPO 2;
   NumPer = NumPer +. 1;
   PerDin = PerDin +. #eosm0044#4;
   RetDin = RetDin +. #eosm0044#5;
   PerEsp = PerEsp +. #eosm0044#6;
   RetEsp = RetEsp +. #eosm0044#7;
   |PINTA 1325 , NumPer;
   |PINTA 1425 , PerDin;
   |PINTA 1525 , RetDin;
   |PINTA 1461 , PerEsp;
   |PINTA 1561 , RetEsp;
|FPRC;
