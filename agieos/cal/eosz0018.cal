|FICHEROS;
     eosz0018 #0;
     eosm0021 #1;
     eosm0022 #2;
|FIN;

|VARIABLES;
     aAlfa    = "";
     nEmpresa = 0;
     nAnyo    = 0;
     nActiv   = 0;
     nRefer   = 0;
     nAnyoC   = 0;
|FIN;

|PROCESO Mayus;
     #0Campo = #0Campo > #0Campo;
     |PINTA #0Campo;
|FPRC;

|PROCESO Trabajadores;
     aAlfa    = "      Pasando Empresa [" + #1#0 + "]";
     |MENSA aAlfa;

     nEmpresa = #1#0;
     nAnyo    = #1#1;
     nActiv   = #1#2;
     nRefer   = #1#3;

     #1#0     = nEmpresa;
     #1#1     = #0#3;
     #1#2     = nActiv;
     #1#3     = nRefer;
     |LEE 101#1=;
     |SI FSalida = 0;
         |SI #0#4 = "N";  |LIBERA #1;  |ACABA;  |FINSI;
         |BORRA 020#1a;
     |FINSI;
     |LIBERA #1;

     #1#0     = nEmpresa;
     #1#1     = #0#2;
     #1#2     = nActiv;
     #1#3     = nRefer;
     |LEE 000#1=;

     #1#1 = #0#3;

     |GRABA 020#1n;
     |LIBERA #1;

     #1#0     = nEmpresa;
     #1#1     = #0#2;
     #1#2     = nActiv;
     #1#3     = nRefer;
     |LEE 101#1=;
|FPRC;

|DEFBUCLE eosm0021;
     #1#1;
     ;
     #0#0, #0#2, 0, 000;
     #0#1, #0#2, 9, 999;
     be;
     NULL, Trabajadores;
|FIN;

|PROCESO Elementos;
     aAlfa    = "      Pasando Empresa [" + #2#0 + "]";
     |MENSA aAlfa;

     nEmpresa = #2#0;
     nAnyo    = #2#1;
     nActiv   = #2#2;
     nRefer   = #2#3;

     #2#0     = nEmpresa;
     #2#1     = #0#3;
     #2#2     = nActiv;
     #2#3     = nRefer;
     |LEE 101#2=;
     |SI FSalida = 0;
         |SI #0#4 = "N";  |LIBERA #2;  |ACABA;  |FINSI;
         |BORRA 020#2a;
     |FINSI;
     |LIBERA #2;

     #2#0     = nEmpresa;
     #2#1     = #0#2;
     #2#2     = nActiv;
     #2#3     = nRefer;
     |LEE 000#2=;

     #2#1 = #0#3;

     nAnyoC = 365;
     |SI #0#3 = 4;  |O #0#3 = 8;  |O #0#3 = 12;
       |O #0#3 = 16;  |O #0#3 = 20;  |O #0#3 = 24;
         |O #0#3 = 28;  |O #0#3 = 32;

         |SI #2#8  = 365;  #2#8  = 366;  |FINSI;
         |SI #2#11 = 365;  #2#11 = 366;  |FINSI;
         nAnyoC = 366;
     |FINSI;

     #2#9  = (#2#07 * #2#08) / nAnyoC;
     #2#12 = (#2#10 * #2#11) / nAnyoC;

     |GRABA 020#2n;
     |LIBERA #2;

     #2#0     = nEmpresa;
     #2#1     = #0#2;
     #2#2     = nActiv;
     #2#3     = nRefer;
     |LEE 101#2=;
|FPRC;

|DEFBUCLE eosm0022;
     #2#1;
     ;
     #0#0, #0#2, 0, 000;
     #0#1, #0#2, 9, 999;
     be;
     NULL, Elementos;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |BUCLE eosm0021;
     |BUCLE eosm0022;
|FPRC;
