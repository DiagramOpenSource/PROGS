|FICHEROS;
   eosm2390 #0;
   eosactiv #1;
|FIN;

|VARIABLES;
   &empresa = 0;
   &anyo    = 0;
   &modo    = 0;
   &nombre  = "";
   &fecha   = "";
   &archi   = "";

   tecla    = "";
   ntecla   = 0;
   FEstado  = 0;
   avance   = "815";
   atras    = "814";
   campo1   = 0;
   campo2   = 0;
   campo3   = 0;
   campo4   = 0;
   campo5   = 0;
   campo6   = 0;
   campo7   = 0;
|FIN;

|PROGRAMA;
|ABRE #0;
|PINPA #0#0;
|SI modo = 1; |O modo = 2; |HAZ pidedato; |FINSI;
|SI modo = 4; |HAZ consulta; |FINSI;
|CIERRA #0;
|FPRO;

|PROCESO pidedato;
#0#0 = empresa;
#0#1 = anyo;
|LIBERA #0;
|LEE 140#0=;
FEstado = FSalida;
|SI FEstado ! 0; |DDEFECTO #0; #0#0 = empresa; #0#1 = anyo; |FINSI;
|PINDA #0#0;
|SI modo = 1; |ENDATOS #1#0;  |FINSI;
|SI modo = 2; |ENDATOS #2#0;  |FINSI;
|SI FSalida = 0;
    |SI FEstado = 0; |GRABA 140#0a; |SINO; |GRABA 140#0n; |FINSI;
    |LIBERA #0;
|FINSI;
|FPRC;

|PROCESO consulta;
avance = &255 + avance;
atras = &255 + atras;
#0#0 = empresa;
#0#1 = anyo;
|LEE 040#0=;
|SI FSalida = 0;
   |PINDA #0#0;
   |PAUSA;
|FINSI;
|FPRC;

|PROCESO actividad; |TIPO 0;
campo2 = Campo;
campo1 = campo2 - 6;
campo3 = campo1 - 12;
campo4 = campo1 - 6;
campo5 = campo1 + 12;
campo6 = campo1 + 18;
campo7 = campo1 + 24;

|SI #0campo1 = " "; |Y #0campo2 = "    "; |ACABA; |FINSI;

|ABRE #1;
|SELECT #2#1;
#1#0 = #0#0;
#1#4 = #0campo1;
#1#5 = #0campo2;
#1#2 = #0#1;
|LEE 040#1=;
|SI FSalida = 0;
    #0campo3 = #1#7;
    #0campo4 = #1#43;
    #0campo5 = #1#44;
    #0campo6 = #1#28;
    #0campo7 = #1#45;
    |PINTA #0campo3;
    |PINTA #0campo4;
    |PINTA #0campo5;
    |PINTA #0campo6;
    |PINTA #0campo7;
|SINO;
    |MENAV "      No existe esta actividad en la empresa";
|FINSI;
|CIERRA #1;
Campo = campo2;
|FPRC;
