|FICHEROS;
    eosmodia #0;
    eosveaut #1;
    eosw0033 #2,MANTE;
|FIN;

|VARIABLES;
    ClaveAlta  = @;
    ClaveBaja  = @;
    VarFecha   = @;

    SwGraba    = 0;
    Campos     = 0;
    DiaNum     = 0;
    MesNum     = 0;
    Dias       = 0;
    Camb       = 0;
    Modo       = 0;
    Pasada     = 0;
    ContaDias  = 0;
    Trimestre  = 0;
    TrimeCampo = 0;

    Tabla     = "";
    Bisiesto  = "";
    DiaAlfa   = "";
    MesAlfa   = "";
    Varalfa   = "";

    Tabla1    = "9416653";
    Tabla2    = "9517753";
    Tabla3    = "9601253";
    Tabla4    = "9713353";
    Tabla5    = "9814453";
    Tabla6    = "9915553";
    Tabla7    = "0006754";
    Tabla8    = "0111153";
    Tabla9    = "0212253";
    Tabla10   = "0313353";
    Tabla11   = "0404553";
    Tabla12   = "0516653";
    Tabla13   = "0617753";
    Tabla14   = "0711153";
    Tabla15   = "0812253";
    Tabla16   = "0914453";
    Tabla17   = "1015553";
    Tabla18   = "1116653";
    Tabla19   = "1207154";
    Tabla20   = "1312253";
    Tabla21   = "1413353";
    Tabla22   = "1514453";
|FIN;

|INCLUYE i_ficher;

|PROCESO CargaTabla;
#1#0 = #0#0;
#1#1 = 1;
|LEE 040#1=;
|SI FSalida ! 0; |DDEFECTO #1; |FINSI;

|SI #1#94 = 1994; Tabla = Tabla1;  |FINSI;
|SI #1#94 = 1995; Tabla = Tabla2;  |FINSI;
|SI #1#94 = 1996; Tabla = Tabla3;  |FINSI;
|SI #1#94 = 1997; Tabla = Tabla4;  |FINSI;
|SI #1#94 = 1998; Tabla = Tabla5;  |FINSI;
|SI #1#94 = 1999; Tabla = Tabla6;  |FINSI;
|SI #1#94 = 2000; Tabla = Tabla7;  |FINSI;
|SI #1#94 = 2001; Tabla = Tabla8;  |FINSI;
|SI #1#94 = 2002; Tabla = Tabla9;  |FINSI;
|SI #1#94 = 2003; Tabla = Tabla10; |FINSI;
|SI #1#94 = 2004; Tabla = Tabla11; |FINSI;
|SI #1#94 = 2005; Tabla = Tabla12; |FINSI;
|SI #1#94 = 2006; Tabla = Tabla13; |FINSI;
|SI #1#94 = 2007; Tabla = Tabla14; |FINSI;
|SI #1#94 = 2008; Tabla = Tabla15; |FINSI;
|SI #1#94 = 2009; Tabla = Tabla16; |FINSI;
|SI #1#94 = 2010; Tabla = Tabla17; |FINSI;
|SI #1#94 = 2011; Tabla = Tabla18; |FINSI;
|SI #1#94 = 2012; Tabla = Tabla19; |FINSI;
|SI #1#94 = 2013; Tabla = Tabla20; |FINSI;
|SI #1#94 = 2014; Tabla = Tabla21; |FINSI;
|SI #1#94 = 2015; Tabla = Tabla22; |FINSI;

Bisiesto = Tabla % 301;

Varalfa = "01.01." + #1#94;  ClaveBaja = Varalfa;
Varalfa = "31.12." + #1#94;  ClaveAlta = Varalfa;
|FPRC;

|PROCESO CargaVentas;
#1#0 = #0#0;
#1#1 = 1;
|LEE 040#1=;
|SI FSalida ! 0; |ACABA; |FINSI;

DiaNum      = 1;
MesNum      = 1;
|PARA Dias  = 1; |SI Dias [ 91; |HACIENDO Dias = Dias + 1;
      |HAZ ConstruyeFecha;
      Camb = 0;
      |SI MesNum = 1; |Y DiaNum = 31; MesNum = 2; DiaNum = 1; Camb = 1; |FINSI;
      |SI MesNum = 2; |Y DiaNum = 29; MesNum = 3; DiaNum = 1; Camb = 1; |FINSI;
      |SI Camb = 0; DiaNum = DiaNum + 1; |FINSI;
|SIGUE;

#1#0 = #0#0;
#1#1 = 2;
|LEE 040#1=;
|SI FSalida ! 0; |DDEFECTO #1; |FINSI;

DiaNum      = 1;
MesNum      = 4;
|PARA Dias  = 1; |SI Dias [ 91; |HACIENDO Dias = Dias + 1;
      |HAZ ConstruyeFecha;
      Camb = 0;
      |SI MesNum = 4; |Y DiaNum = 30; MesNum = 5; DiaNum = 1; Camb = 1; |FINSI;
      |SI MesNum = 5; |Y DiaNum = 31; MesNum = 6; DiaNum = 1; Camb = 1; |FINSI;
      |SI Camb = 0; DiaNum = DiaNum + 1; |FINSI;
|SIGUE;

#1#0 = #0#0;
#1#1 = 3;
|LEE 040#1=;
|SI FSalida ! 0; |DDEFECTO #1; |FINSI;

DiaNum      = 1;
MesNum      = 7;
|PARA Dias  = 1; |SI Dias [ 92; |HACIENDO Dias = Dias + 1;
      |HAZ ConstruyeFecha;
      Camb = 0;
      |SI MesNum = 7; |Y DiaNum = 31; MesNum = 8; DiaNum = 1; Camb = 1; |FINSI;
      |SI MesNum = 8; |Y DiaNum = 31; MesNum = 9; DiaNum = 1; Camb = 1; |FINSI;
      |SI Camb = 0; DiaNum = DiaNum + 1; |FINSI;
|SIGUE;

#1#0 = #0#0;
#1#1 = 4;
|LEE 040#1=;
|SI FSalida ! 0; |DDEFECTO #1; |FINSI;

DiaNum      = 1;
MesNum      = 10;
|PARA Dias  = 1; |SI Dias [ 92; |HACIENDO Dias = Dias + 1;
      |HAZ ConstruyeFecha;
      Camb = 0;
      |SI MesNum = 10; |Y DiaNum = 31; MesNum = 11; DiaNum = 1; Camb = 1; |FINSI;
      |SI MesNum = 11; |Y DiaNum = 30; MesNum = 12; DiaNum = 1; Camb = 1; |FINSI;
      |SI Camb = 0; DiaNum = DiaNum + 1; |FINSI;
|SIGUE;
|FPRC;

|PROCESO ConstruyeFecha;
DiaAlfa = DiaNum;
DiaAlfa = ("00" + DiaAlfa) % -102;

MesAlfa = MesNum;
MesAlfa = ("00" + MesAlfa) % -102;

Campos = Dias + 1;

Varalfa = DiaAlfa + "." + MesAlfa + "." + #1#94;

|SI Bisiesto = "1"; |Y DiaAlfa = 29; |Y MesAlfa = "02"; |ACABA; |FINSI;

#2#0     = Varalfa;
#2#1     = #1Campos;
VarFecha = #2#0 % 1;
#2#2     = (VarFecha % 1109) > #2#2;
|GRABA 140#2n;

#0#2 = #0#2 + #1Campos;

SwGraba = 1;
|FPRC;

|PROCESO GrabaFichero;
ContaDias = ContaDias + 1;

|SI ContaDias [ 91;                       Trimestre = 1; |FINSI;
|SI ContaDias ] 92;  |Y ContaDias [ 182;  Trimestre = 2; |FINSI;
|SI ContaDias ] 183; |Y ContaDias [ 274;  Trimestre = 3; |FINSI;
|SI ContaDias ] 275; |Y ContaDias [ 366;  Trimestre = 4; |FINSI;

#1#0 = #0#0;
#1#1 = Trimestre;
|LIBERA #1;
|LEE 140#1=
|SI FSalida = 0;
    Campos = Campos + 1;
    |SI TrimeCampo ! Trimestre;
        Campos     = 2;
        TrimeCampo = Trimestre;
    |FINSI;

    |SI Trimestre = 1; |Y Bisiesto = "1"; |Y ContaDias = 60;
        Campos    = Campos    + 1;
        ContaDias = ContaDias + 1;
    |FINSI;

    #1Campos = #2#1;
    |GRABA 140#1a;
|FINSI;
|FPRC;

|DEFBUCLE eosw0033;
#2#1;
;
ClaveBaja;
ClaveAlta;
;
NULL, GrabaFichero;
|FIN;

|RUTINA ClaveBaja;
#2#0 = ClaveBaja;
|FRUT;

|RUTINA ClaveAlta;
#2#0 = ClaveAlta;
|FRUT;

|PROCESO Tipo3; |TIPO 3;
|NOPARA;

comienza = "33"; |HAZ fichero;
|NOME_DAT #2 fichero;
|ABRE #2; |CIERRA #2; |DELINDEX #2;

|ABRE #1;
|ABRE #2;
|HAZ CargaTabla;
|HAZ CargaVentas;
|CIERRA #1;
|CIERRA #2;

|SI SwGraba = 0; |ACABA; |FINSI;

|PINTA #0#2;
|ENTLINEAL #1#2, 1, 2, 20, 0, ClaveBaja, ClaveAlta;

Campos = 1;
|ABRE #1; |BUCLE eosw0033; |CIERRA #1;

|DELINDEX #2;
|FPRC;

|PROCESO Tipo2; |TIPO 2;
Modo   = (FEntrada / 100) ! 0;
Pasada = 0 +. 1;

|SI Modo = 3; |Y Pasada ! 1;
    |MENAV "    El Registro no se puede borrar. Ponga la Cantidad a cero.";
    |ERROR;
    |ACABA;
|FINSI;

#0#2 = #0#2 +. #2#1;
|PINTA #0#2;
|FPRC;
