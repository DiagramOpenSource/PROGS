|FICHEROS;
     eosclpre #0;
     eosclipr #1;
     eosaplic #99;
     :/agicli/def/agim0016 #2;
|FIN;

|VARIABLES;
     cont = 0;
     nume1 = 0;
     nume2 = 0;
     lugar = 0;
     nifnum = 0;
     resto = 0;
     men2 = "2325S Dar de Alta en Clientes-Proveedores General (S/N) : ";
     sw = 0;
     aponer = "";
     fiac = "";
     relleno = "                                                 ";
     dni = "";
     cif = "";
     empresa = 0;
     cliente = 0;
     clave = "";

     letra = "";
     alfa1 = "";
     alfa2 = "";
     final = "";
     x = "";
     pos1 = "";
     pos2 = "";
     pos3 = "";
     pos4 = "";

     aNifQbf1   = "";
     aNifQbf2   = "";

     &eaVarDni  = "";
     &enCalcCif = 0;
|FIN;

|PROCESO Mayus;
  #2Campo = #2Campo > #2Campo;  |PINTA #2Campo;
|FPRC;

|PROCESO Filtra;
  |ABRE #2;
  #2#0 = #1#14;
  |LEE 040#2=;
  |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
  |CIERRA #2;

  |C_M #1#7,  1, "S";
  |C_M #1#9,  1, "N";
  |C_M #1#10, 1, "N";
  |SI #2#5 = "S";
      #1#7 = 99;    |PINTA #1#7;
      #1#8 = #2#4;  |PINTA #1#8;
      |C_M #1#7,  1, "N";
      |C_M #1#9,  1, "S";
      |C_M #1#10, 1, "S";
  |FINSI;
|FPRC;

|PROCESO grabalo;
#0#3  = #1#0;
#0#4  = #1#1;
#0#5  = #1#2;
#0#6  = #1#3;
#0#7  = #1#4;
#0#8  = #1#5;
#0#9  = #1#6;
#0#10 = #1#7;
#0#11 = #1#8;
#0#12 = #1#9;
#0#13 = #1#10;
#0#14 = #1#11;
#0#15 = #1#12;
#0#18 = #1#13;
|GRABA 140#0a;
|LIBERA #0;
|FPRC;

|DEFBUCLE eosclpre;
#0#1;
3;
00000, 0, 00000, #1#0;
99999, 9, 99999, #1#0;
be;
NULL, grabalo;
|FIN;

|PROCESO modifig; |TIPO 3;
cont = (FEntrada / 100) ! 0;
|SI cont ! 2; |ACABA; |FINSI;

|ABRE #99;
|LEE 040#99p;
|SI FSalida ! 0; |DDEFECTO #99; |FINSI;
|CIERRA #99;

|SI #99#11 = 2; |ACABA; |FINSI;

|CONFI "2325S Modificar en Clientes-Proveedores Empresa (S/N) : ";
|SI FSalida ! 0; |ACABA; |FINSI;

|BUCLE eosclpre;
|FPRC;

|PROCESO letranif;
     |SI FSalida = 9;
         eaVarDni   = #1Campo;
         enCalcCif  = 1;
         |HAZ CalculoDNI;
         #1Campo = eaVarDni;
         |PINTA #1Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #1Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     aNifQbf1 = #1Campo;   |QBF aNifQbf1;
     aNifQbf2 = eaVarDni;  |QBF aNifQbf2;

     |SI aNifQbf1 ! aNifQbf2; |Y aNifQbf1 ! "";
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #1Campo = eaVarDni;  |PINTA #1Campo;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;
