|FICHEROS;
     eosz0013 #0;
     eoslinco #1;
     eosactiv #2;
     eosconce #3;
     eosconc6 #4;
     eosw0083 #83;
|FIN;

|VARIABLES;
     nSubLinea    = 0;
     nConcepto    = 0;
     nBase        = 0;
     nRete        = 0;
     nCuota       = 0;
     nGrabar      = 0;
     nHLinea      = 0;
     nHSLinea     = 0;

     aFichero     = "";
     aClave       = "";
     aSubClave    = "";
     aDinEsp      = "";
     aNConcepto   = "";
     aConcepto    = "";
     aAlfa        = "";

     &enEmpresa   = 0;
     &enEjercic   = 0;
|FIN;

|PROCESO Grabalo;
     |SI #2#50 = 1;
         #3#0 = nConcepto;
         |LEE 040#3=;
         |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;
         aNConcepto = #3#1;
         aDinEsp    = #3#14;
         aClave     = #3#12;
         aSubClave  = #3#13;
         aConcepto  = "";
         |C_V #83#3, 1, "N";
         |C_M #83#3, 1, "N";
     |SINO;
         #4#0 = aConcepto;
         |LEE 040#4=;
         |SI FSalida ! 0;  |DDEFECTO #4;  |FINSI;
         aNConcepto = #4#1;
         aDinEsp    = #4#21;
         aClave     = #4#19;
         aSubClave  = #4#20;
         nConcepto  = 0;
         |C_V #83#2, 1, "N";
         |C_M #83#2, 1, "N";
     |FINSI;

     #83#0  = #1#1;
     #83#1  = nSubLinea;
     #83#2  = nConcepto;
     #83#3  = aConcepto;
     #83#4  = aNConcepto;
     #83#5  = aDinEsp;
     #83#6  = #1#13;
     #83#7  = nBase;
     #83#8  = nRete;
     #83#9  = nCuota;
     #83#10 = aClave;
     #83#11 = aSubClave;
     |GRABA 020#83n;
     |LIBERA #83;

     nHLinea  = #83#0;
     nHSLinea = #83#1;
|FPRC;

|PROCESO GrabaTempo;
     #2#0 = #0#0;
     #2#1 = #1#19;
     #2#2 = #0#1;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

     |SI #1#42 ! 0;
         nSubLinea = 1;
         nConcepto = #1#5;
         aConcepto = #1#72;
         nBase     = #1#7;
         nRete     = #1#39;
         nCuota    = #1#42;
         |HAZ Grabalo;
     |FINSI;

     |SI #1#43 ! 0;
         nSubLinea = 2;
         nConcepto = #1#33;
         aConcepto = #1#73;
         nBase     = #1#23;
         nRete     = #1#40;
         nCuota    = #1#43;
         |HAZ Grabalo;
     |FINSI;

     |SI #1#44 ! 0;
         nSubLinea = 3;
         nConcepto = #1#34;
         aConcepto = #1#74;
         nBase     = #1#24;
         nRete     = #1#41;
         nCuota    = #1#44;
         |HAZ Grabalo;
     |FINSI;

     nGrabar = 1;
|FPRC;

|DEFBUCLE eoslinco;
     #1#1;
     ;
     #0#0, #0#1, 1;
     #0#0, #0#1, 32000;
     ;
     NULL, GrabaTempo;
|FIN;

|RUTINA ClaveBaja83;
     #83#0 = 1;
     #83#1 = 1;
|FRUT;

|RUTINA ClaveAlta83;
     #83#0 = nHLinea;
     #83#1 = nHSLinea;
|FRUT;

|PROCESO PasaACompras;
     #1#0  = #0#0;
     #1#14 = #0#1;
     #1#1  = #83#0;
     |LEE 101#1=;
     |SI FSalida = 0;
         |SI #83#1 = 1;
             #1#5  = #83#2;
             #1#72 = #83#3;
             #1#35 = #83#4;
             |GRABA 020#1a;
         |FINSI;
         |SI #83#1 = 2;
             #1#33 = #83#2;
             #1#73 = #83#3;
             #1#36 = #83#4;
             |GRABA 020#1a;
         |FINSI;
         |SI #83#1 = 3;
             #1#34 = #83#2;
             #1#74 = #83#3;
             #1#37 = #83#4;
             |GRABA 020#1a;
         |FINSI;
         |LIBERA #1;
     |FINSI;
|FPRC;

|DEFBUCLE eosw0083;
    #83#1;
    ;
        1, 1;
    32000, 6;
    ;
    NULL, PasaACompras;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     aFichero = ("83" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #83 aFichero;
     |ABRE #83;  |CIERRA #83;  |DELINDEX #83;

     aFichero = "c" + (("00000" + #0#0) % -105) + (("00" + #0#1) % -102);
     |NOME_DAT #1 aFichero;

     |ABRE #2;
     |ABRE #3;
     |ABRE #4;
     |ABRE #83;
     |BUCLE eoslinco;
     |CIERRA #2;
     |CIERRA #3;
     |CIERRA #4;
     |CIERRA #83;

     |SI nGrabar = 1;
         |ENTLINEAL #1#83, 1, 2, 22, 0, ClaveBaja83, ClaveAlta83;
         |ABRE #1;
         |BUCLE eosw0083;
         |CIERRA #1;
     |SINO;
         |MENAV "      Seleccion Vacia.";
     |FINSI;

     |DELINDEX #83;
|FPRC;

|PROGRAMA;
     |SI enEmpresa = 0;
         |CLS;
         |CABEZA "      Revisar Retenciones Empresas Libros";
         |PINPA #0#0;
         |PINDA #0#0;
         |ENDATOS #1#0;
         |SI FSalida = 0;  |HAZ Tipo3;  |FINSI;
     |SINO;
         |PINPA #0#0;
         aAlfa = enEjercic % -102;
         #0#0  = enEmpresa;
         #0#1  = aAlfa;

         |C_M #0#0, 1, "N";
         |C_M #0#1, 1, "N";

         |PINDA #0#0;
         |PTEC 802;
         |ENDATOS #1#0;
         |SI FSalida = 0;  |HAZ Tipo3;  |FINSI;
     |FINSI;
|FPRO;
