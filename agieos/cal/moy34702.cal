|FICHEROS;
     eoszp015;
     eosm0009;
     eosm0010;
     eosm0016;
     eosclien;
     eosm0014;

     t1434701;
     t1434702;
     t1434703;

     dsmoy000;
|FIN;

|VARIABLES;
     Vacio20    = "                    ";
     Vacio40    = "                                        ";

     aDirOri    = "";
     aDirDes    = "";
     aOrigen    = "";
     aDestino   = "";
     aDClave    = "";
     aHClave    = "";
     Clave      = "";
     Contador   = 0;
     ModoModi   = "";
     SwLee      = 0;
     Fichero1   = "";
     FicheroD   = "";
     Path       = "";

     CampoDni   = "";
     Letra1     = "";
     Letra2     = "";
     Letra3     = "";
     Letra4     = "";
     Letra5     = "";
     Letra6     = "";
     Letra7     = "";
     Letra8     = "";
     Caracter   = "";
     Carac1     = 0;
     Carac2     = 0;
     Carac3     = 0;
     Carac4     = 0;
     Carac5     = 0;

     aCadena    = "";
     aCaracter  = "";
     aLong      = "";
     nLong      = 0;
     nPos       = 0;
     nNume      = 0;
     nNume1     = 0;
     nNume2     = 0;
     nEspa      = 0;
     nTOperacion = 0;
     nTInmuebles = 0;
     nSwLee      = 0;
     aTecla      = "";
     aAlfa       = "";
     aAlfa1      = "";
     aAlfa2      = "";
     aAbre       = "";

     nSwError    = 0;
     nCanal      = 0;
     nHandle     = 0;
     nCampo      = 0;
     nHCampo     = 0;

     nBoton1     = 0;
     nBoton2     = 0;
     nBoton3     = 0;
     nBoton4     = 0;
     nTecla      = 0;

     aF2         = "";
     aF3         = "";
     aF4         = "";
     aF8         = "";

     &THojas    = 0;
     &NHojas    = 0;

     &EURODB    = 0;
     &enSwTrata = 0;
     aAlfaFich  = "";

      aFicheroTxt  = "";
      aFicheroCar  = "";
      aPathLocal   = "";
      aIPRemoto    = "";
      aTercera     = "";
      nEmpresa     = 0;

     &eaFichDatos    = "";
     &eaFichAuxil    = "";
     &eaFichError    = "";
     &enValidacion   = 0;
     &enError        = 0;
     &eaTipoE        = "";
     &eaTipoR        = "";
     &eaTipoP        = "";
     &eaTipoC        = "";
     &eaTipoA        = "";
     &eaTipoV        = "";
     &eaModoImpre    = "";
     &eaModelos      = "";
     &eaEjer         = "";
     &eaPeriodo      = "";
     &eaVarDni       = "";
     &enCalcCif      = 0;
     &enNume         = 0;
     &eaAlfa         = "";

     {-1}aMoneda   = "";
         aMoneda1  = "LEER";
         aMoneda2  = "";

     nSwLinea   = 0;
     nCobro     = 0;
     aEjerCobro = "0000";
     nTopeCobro = 0;

     &eaPathEmision      = "";
     &eaPathLanza        = "";
     &eaPathExplorador   = "";
     &eaPathInternet     = "";
     &eaFicheroPlano     = "";
     &eaOpcion           = "";
     &enErrorPortal      = 0;
     &eaFicheroImpre     = "";
     &eaFicheroSalid     = "";
     &eaFicheroError     = "";
     &enEmpresa          = 0;
     &eaNomEmpresa       = "";
     &eaTipoSec          = "";
     &enPresentar        = 0;
     &enAnyo             = 0;
     &eaUnidad           = "";
     &eaCampo0           = "";
     &eaCampo1           = "";
     &eaCampo2           = "";
     &eaCampo3           = "";
     &eaCampo4           = "";
     &eaCampo5           = "";
     aOp1 = "";
     aOp2 = "";
     aOp3 = "";
     aOp4 = "";
     aOp5 = "";

     &eaPaisCCE  = "";
     &eSwPaisCCE = 0;
     &enDirecta  = 0;
     &eaJusti    = "";
|FIN;

|PROCESO CargaT1434702;
     |DDEFECTO #t1434702;

     #t1434702#0 = "2";
     #t1434702#1 = "347";
     #t1434702#2 = eaEjer;
     eaAlfa  = #eosclien#1;   |QBF eaAlfa;         #t1434702#3  = ("000000000" + eaAlfa) % -109;

     |SI #eosm0010#20 = "N";
         eaAlfa   = #eosm0010#3;   |QBF eaAlfa;    #t1434702#4  = ("000000000" + eaAlfa) % -109;
     |FINSI;

     |SI #eosm0010#13 = 99;       || es extranjero, tique 4655_87
         #t1434702#4  = "";
         eaPaisCCE    = #eosm0010#21; |HAZ PaisCCE;
         |SI eSwPaisCCE = 1;
             aAlfa        = (#eosm0010#21 % 102) + #eosm0010#3;  |QBT aAlfa;
             #t1434702#26 = aAlfa;
         |FINSI;
     |FINSI;

     |SI #eosm0010#17 = "S";
         #t1434702#5  = #t1434702#4;
         #t1434702#4  = "";
     |FINSI;

     eaAlfa       = #eosm0010#6;   |HAZ QuitaRaros;
     #t1434702#6  = eaAlfa;
     #t1434702#7  = "D";

     eaAlfa       = ("00" + #eosm0010#13) % -102;
     #t1434702#8  = eaAlfa;

     eaAlfa = "  ";
     |SI #eosm0010#13 = 99;
          eaAlfa = #eosm0010#21 % 102;
     |FINSI;

     #t1434702#9  = eaAlfa;
     #t1434702#10 = "";
     #t1434702#11 = #eosm0010#2;

     enNume       = #eosm0010#19;  |HAZ Conver16Signo;
     #t1434702#12 = eaAlfa;

     eaAlfa = #eosm0010#4; |QBF eaAlfa;
     |SI eaAlfa = "S";
         #t1434702#13 = "X";
     |FINSI;

     |SI #eosm0010#5 = "S";
         #t1434702#14 = "X";
     |FINSI;


||      nCobro = #eosm0010#22;
     |SI nCobro ! 0;
        enNume = nCobro;  |HAZ Conver15;
        #t1434702#15 = eaAlfa;
        #t1434702#17 = aEjerCobro;
     |FINSI;


     enNume   = #eosm0010#23;  |HAZ Conver16Signo;  #t1434702#16 = eaAlfa;
     enNume   = #eosm0010#27;  |HAZ Conver16Signo;  #t1434702#18 = eaAlfa;
     enNume   = #eosm0010#31;  |HAZ Conver16Signo;  #t1434702#19 = eaAlfa;
     enNume   = #eosm0010#28;  |HAZ Conver16Signo;  #t1434702#20 = eaAlfa;
     enNume   = #eosm0010#32;  |HAZ Conver16Signo;  #t1434702#21 = eaAlfa;
     enNume   = #eosm0010#29;  |HAZ Conver16Signo;  #t1434702#22 = eaAlfa;
     enNume   = #eosm0010#33;  |HAZ Conver16Signo;  #t1434702#23 = eaAlfa;
     enNume   = #eosm0010#30;  |HAZ Conver16Signo;  #t1434702#24 = eaAlfa;
     enNume   = #eosm0010#34;  |HAZ Conver16Signo;  #t1434702#25 = eaAlfa;

     |SI #eosm0010#37 = "S";  #t1434702#27 = "X";  |FINSI;
     |SI #eosm0010#35 = "S";  #t1434702#28 = "X";  |FINSI;
     |SI #eosm0010#36 = "S";  #t1434702#29 = "X";  |FINSI;

     enNume = #eosm0010#38;  |HAZ Conver16Signo;  #t1434702#30 = eaAlfa;

     #t1434702#32 = &13 + &10;

                          nHCampo = 32;
     |SI eaOpcion ! "3";  nHCampo = 31;  |FINSI;

     aAlfa = "";
     |PARA nCampo = 0;  |SI nCampo [ nHCampo;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #t1434702#nCampo#;
           |XGRABA nHandle, aAlfa;
     |SIGUE;

     nSwLinea   = 1;
|FPRC;

|PROCESO Registro4_02;
     |SI nSwLee = 1;
         |SI #eosm0016#7 > nTopeCobro;
             nNume1 = nNume1 + 1;
         |FINSI;
         |ACABA;
     |FINSI;

     |SI #eosm0016#7 > nTopeCobro;
         nCobro     = #eosm0016#7;
         aEjerCobro = ("0000" + #eosm0016#6) % -104;  || ejercicio del cobro
         |SI nSwLinea ! 0;
             #eosm0010#19 = 0;
             #eosm0010#23 = 0;
             #eosm0010#27 = 0;
             #eosm0010#28 = 0;
             #eosm0010#29 = 0;
             #eosm0010#30 = 0;
             #eosm0010#31 = 0;
             #eosm0010#32 = 0;
             #eosm0010#33 = 0;
             #eosm0010#34 = 0;
         |FINSI;

         |HAZ CargaT1434702;
     |FINSI;
|FPRC;

|DEFBUCLE Registro4_02;
    #eosm0016#1;
    ;
    #eosm0010#0, #eosm0010#1, #eosm0010#2, #eosm0010#3, aOp1, aOp2, aOp4, aOp5, aOp3, 2999;
    #eosm0010#0, #eosm0010#1, #eosm0010#2, #eosm0010#3, aOp1, aOp2, aOp4, aOp5, aOp3, 2008;
    e;
    NULL, Registro4_02;
|FIN;

|PROCESO ComparaSiglas_02;
    |QBF aAlfa; aAlfa = aAlfa > " ";
    |SI aAlfa = "AL";  aAlfa = "ALAM ";  |FINSI;
    |SI aAlfa = "AD";  aAlfa = "ALDEA";  |FINSI;
    |SI aAlfa = "AP";  aAlfa = "APTOS";  |FINSI;
    |SI aAlfa = "AR";  aAlfa = "ARRAL";  |FINSI;
    |SI aAlfa = "AY";  aAlfa = "ARRY ";  |FINSI;
    |SI aAlfa = "AV";  aAlfa = "AVDA ";  |FINSI;
    |SI aAlfa = "BJ";  aAlfa = "BJADA";  |FINSI;
    |SI aAlfa = "BR";  aAlfa = "BRANC";  |FINSI;
    |SI aAlfa = "BO";  aAlfa = "BARRO";  |FINSI;
    |SI aAlfa = "BL";  aAlfa = "BLQUE";  |FINSI;
    |SI aAlfa = "CL";  aAlfa = "CALLE";  |FINSI;
    |SI aAlfa = "CJ";  aAlfa = "CLLJA";  |FINSI;
    |SI aAlfa = "CM";  aAlfa = "CMNO ";  |FINSI;
    |SI aAlfa = "CR";  aAlfa = "CTRA ";  |FINSI;
    |SI aAlfa = "CS";  aAlfa = "CSRIO";  |FINSI;
    |SI aAlfa = "CO";  aAlfa = "COL  ";  |FINSI;
    |SI aAlfa = "CN";  aAlfa = "CJTO ";  |FINSI;
    |SI aAlfa = "CT";  aAlfa = "CUSTA";  |FINSI;
    |SI aAlfa = "CH";  aAlfa = "CHLET";  |FINSI;
    |SI aAlfa = "ED";  aAlfa = "EDIFC";  |FINSI;
    |SI aAlfa = "EN";  aAlfa = "ENTD ";  |FINSI;
    |SI aAlfa = "ES";  aAlfa = "ESCAL";  |FINSI;
    |SI aAlfa = "EX";  aAlfa = "EXPLA";  |FINSI;
    |SI aAlfa = "EM";  aAlfa = "EXTRM";  |FINSI;
    |SI aAlfa = "ER";  aAlfa = "EXTRR";  |FINSI;
    |SI aAlfa = "GL";  aAlfa = "GTA  ";  |FINSI;
    |SI aAlfa = "GV";  aAlfa = "G.V. ";  |FINSI;
    |SI aAlfa = "GR";  aAlfa = "GRUPO";  |FINSI;
    |SI aAlfa = "JR";  aAlfa = "JDIN ";  |FINSI;
    |SI aAlfa = "LG";  aAlfa = "LUGAR";  |FINSI;
    |SI aAlfa = "MS";  aAlfa = "MASIA";  |FINSI;
    |SI aAlfa = "MC";  aAlfa = "MERC ";  |FINSI;
    |SI aAlfa = "MT";  aAlfa = "MONTE";  |FINSI;
    |SI aAlfa = "ML";  aAlfa = "MUELL";  |FINSI;
    |SI aAlfa = "PQ";  aAlfa = "PQUE ";  |FINSI;
    |SI aAlfa = "PQ";  aAlfa = "PQUE ";  |FINSI;
    |SI aAlfa = "PD";  aAlfa = "PTDA ";  |FINSI;
    |SI aAlfa = "PJ";  aAlfa = "PSAJE";  |FINSI;
    |SI aAlfa = "PS";  aAlfa = "PASEO";  |FINSI;
    |SI aAlfa = "PZ";  aAlfa = "PLAZA";  |FINSI;
    |SI aAlfa = "PB";  aAlfa = "PBDO ";  |FINSI;
    |SI aAlfa = "PG";  aAlfa = "POLIG";  |FINSI;
    |SI aAlfa = "PR";  aAlfa = "PROL ";  |FINSI;
    |SI aAlfa = "PT";  aAlfa = "PNTE ";  |FINSI;
    |SI aAlfa = "PU";  aAlfa = "PTA  ";  |FINSI;
    |SI aAlfa = "RM";  aAlfa = "RAMAL";  |FINSI;
    |SI aAlfa = "RB";  aAlfa = "RBLA ";  |FINSI;
    |SI aAlfa = "RP";  aAlfa = "RAMPA";  |FINSI;
    |SI aAlfa = "RR";  aAlfa = "RIERA";  |FINSI;
    |SI aAlfa = "RC";  aAlfa = "RCON ";  |FINSI;
    |SI aAlfa = "RD";  aAlfa = "RONDA";  |FINSI;
    |SI aAlfa = "RU";  aAlfa = "RUA  ";  |FINSI;
    |SI aAlfa = "SC";  aAlfa = "SECT ";  |FINSI;
    |SI aAlfa = "SD";  aAlfa = "SENDA";  |FINSI;
    |SI aAlfa = "SB";  aAlfa = "SBIDA";  |FINSI;
    |SI aAlfa = "TO";  aAlfa = "TRRNT";  |FINSI;
    |SI aAlfa = "TR";  aAlfa = "TRVA ";  |FINSI;
    |SI aAlfa = "UR";  aAlfa = "URB  ";  |FINSI;
    |SI aAlfa = "VI";  aAlfa = "VIA  ";  |FINSI;
    |SI aAlfa = "VP";  aAlfa = "VIA  ";  |FINSI;

    |SI aAlfa = "";  aAlfa = "CALLE";  |FINSI;
    aAlfa = (aAlfa + "     ") % 105;
|FPRC;

|PROCESO CargaT1434703;          Registro 02 I
     |DDEFECTO #t1434703;

     #t1434703#0  = "2";
     #t1434703#1  = "347";
     #t1434703#2  = eaEjer;
     eaAlfa  = #eosclien#1;   |QBF eaAlfa;         #t1434703#3  = ("000000000" + eaAlfa) % -109;

     |SI #eosm0010#20 = "N";
         eaAlfa   = #eosm0010#3;   |QBF eaAlfa;    #t1434703#4  = ("000000000" + eaAlfa) % -109;
     |FINSI;

     |SI #eosm0010#13 = 99;       || es extranjero, tique 4655_87
         #t1434703#4  = "";
     |FINSI;

     |SI #eosm0010#17 = "S";
         #t1434703#5  = #t1434702#4;
         #t1434703#4  = "";
     |FINSI;

     eaAlfa       = #eosm0010#6;   |HAZ QuitaRaros;
     #t1434703#6  = eaAlfa;
     #t1434703#7  = "I";

     enNume       = #eosm0010#19;  |HAZ Conver15;
     #t1434703#9  = eaAlfa;

     #t1434703#10  = #eosm0010#24;
     #t1434703#11  = #eosm0010#18;

     aAlfa = #eosm0010#7;  |HAZ ComparaSiglas_02;
     #t1434703#12  = aAlfa;

     eaAlfa    = #eosm0010#8;     |HAZ QuitaRaros;
     #t1434703#13  = eaAlfa;

     #t1434703#14  = "NUM";

     eaAlfa        = #eosm0010#9;  |QBT eaAlfa;
     eaAlfa        = ("00000" + eaAlfa) % -105;
     #t1434703#15  = eaAlfa;

     #t1434703#19  = #eosm0010#10;
     #t1434703#20  = #eosm0010#11;
     #t1434703#21  = #eosm0010#12;
     eaAlfa    = #eosm0010#15;  |HAZ QuitaRaros;
     #t1434703#24  = eaAlfa;
     #t1434703#25  = #eosm0010#25;

     #t1434703#26 = ("00" + #eosm0010#13) % -102;
     #t1434703#27 = (("00" + #eosm0010#13) % -102) + (("000" + #eosm0010#14) % -103);
     #t1434703#29 = &13 + &10;

                          nHCampo = 29;
     |SI eaOpcion ! "3";  nHCampo = 28;  |FINSI;

     aAlfa = "";
     |PARA nCampo = 0;  |SI nCampo [ nHCampo;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #t1434703#nCampo#;
          |XGRABA nHandle, aAlfa;
     |SIGUE;
|FPRC;

|PROCESO Tipo2_02;
     aEjerCobro = "0000"; || eaEjer;
     nCobro     = 0;
     aOp1 = #eosm0010#35;
     aOp2 = #eosm0010#36;
     aOp3 = #eosm0010#37;
     aOp4 = #eosm0010#4;
     aOp5 = #eosm0010#5;

     |SI #eosm0010#2 = "A"; |O #eosm0010#2 = "B";
         |SI #eosm0010#22 > nTopeCobro;
             nCobro     = #eosm0010#22;
             aEjerCobro = ("0000" + enAnyo) % -104;
         |FINSI;
     |FINSI;

     nSwLinea = 0;
     |SI #eosm0010#2 = "A"; |O #eosm0010#2 = "B";
         |SI #eosm0010#19 ! 0; |HAZ CargaT1434702; |FINSI;
         |BUCLE Registro4_02;
     |SINO;
         |HAZ CargaT1434702;
     |FINSI;
|FPRC;

|PROCESO eosm0010_02;

     aOp1 = #eosm0010#35;
     aOp2 = #eosm0010#36;
     aOp3 = #eosm0010#37;
     aOp4 = #eosm0010#4;
     aOp5 = #eosm0010#5;
     |SI nSwLee = 1;
         |SI #eosm0010#2 ! "Z";
             nTOperacion = nTOperacion + #eosm0010#19;
         |SINO;
             nTInmuebles = nTInmuebles + #eosm0010#19;
         |FINSI;

         |SI #eosm0010#2 = "A"; |O #eosm0010#2 = "B";
             nNume1 = 0;

             |SI #eosm0010#19 ! 0; nNume1 = 1; |FINSI;

             |BUCLE Registro4_02;

             |SI #eosm0010#2 = "A"; #eosm0009#12 = #eosm0009#12 + nNume1; |FINSI;
             |SI #eosm0010#2 = "B"; #eosm0009#13 = #eosm0009#13 + nNume1; |FINSI;
         |FINSI;

         |ACABA;
      |FINSI;

      |SI #eosm0010#2 ! "Z";
          |HAZ Tipo2_02;

||          |HAZ CargaT1434702;
      |FINSI;

      |SI #eosm0010#2 = "Z"; |HAZ CargaT1434703;  |FINSI;
|FPRC;

|DEFBUCLE eosm0010_02;
     #eosm0010#1;
     ;
     #eosm0009#0, #eoszp015#2, aDClave, "            ", " ", " ", "  ", " ", " ";
     #eosm0009#0, #eoszp015#2, aHClave, "zzzzzzzzzzzz", "z", "z", "zz", "z", "z";
     ;
     NULL, eosm0010_02;
|FIN;

|PROCESO CargaT1434701;
     |DDEFECTO #t1434701;

                                                   #t1434701#0  = "1";
                                                   #t1434701#1  = "347";
                                                   #t1434701#2  = eaEjer;
     eaAlfa  = #eosclien#1;   |QBF eaAlfa;         #t1434701#3  = ("000000000" + eaAlfa) % -109;
     eaAlfa  = #eosclien#2;   |HAZ QuitaRaros;     #t1434701#4  = eaAlfa;
                                                   #t1434701#5  = "T";
     eaAlfa  = #eosm0009#19;  |HAZ QuitaRarosTfno; #t1434701#6  = eaAlfa;
     eaAlfa  = #eosm0009#18;  |HAZ QuitaRaros;     #t1434701#7  = eaAlfa;

     #t1434701#8  = "3470000000000";
     || |SI enDirecta = 1;
         |HAZ CalcJustificante;
         #t1434701#8 = eaJusti;
     || |FINSI;

     |SI #eosm0009#4 = "C";
         #t1434701#9  = "C";
         #t1434701#11 = "347" + (#eosm0009#5 % 410);
     |FINSI;

     |SI #eosm0009#4 = "S";
         #t1434701#10 = "S";
         #t1434701#11 = "347" + (#eosm0009#5 % 410);
     |FINSI;

     nNume   = #eosm0009#12 + #eosm0009#13 + #eosm0009#14 + #eosm0009#15 + #eosm0009#16 + #eosm0009#23 + #eosm0009#24;
     #t1434701#12 = ("000000000" + nNume) % -109;

     enNume    = nTOperacion ! 2;
     |HAZ Conver16Signo;
     #t1434701#13 = eaAlfa;

     #t1434701#14 = ("000000000" + #eosm0009#17) % -109;

     enNume  = nTInmuebles;
     |HAZ Conver16Signo;
     #t1434701#15 = eaAlfa;

     #t1434701#19 = &13 + &10;

                          nHCampo = 19;
     |SI eaOpcion ! "3";  nHCampo = 18;  |FINSI;

     aAlfa = "";
     |PARA nCampo = 0;  |SI nCampo [ nHCampo;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #t1434701#nCampo#;
           |XGRABA nHandle, aAlfa;
     |SIGUE;
|FPRC;

|PROCESO eosm0009_02;
     |SI #eoszp015#4 ! 0;
         #eosm0014#0 = #eoszp015#4;
         #eosm0014#1 = #eosm0009#0;
         |LEE 040#eosm0014.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     #eosclien#0  = #eosm0009#0;
     |LEE 040#eosclien.=;
     |SI FSalida ! 0; |DDEFECTO #eosclien; |FINSI;

     eaFicheroPlano = eaModelos + (("00000" + #eosm0009#0) % -105) + ".txt";
     eaFicheroImpre = eaModelos + (("00000" + #eosm0009#0) % -105) + ".imp";
     eaFicheroSalid = eaModelos + (("00000" + #eosm0009#0) % -105) + ".sal";
     eaFicheroError = "err" + (("00000" + #eosm0009#0) % -105) + ".txt";

     aAbre = eaPathEmision + eaFicheroPlano;
     |XABRE "BW", aAbre, nHandle;

     nTOperacion = 0;
     nTInmuebles = 0;
     #eosm0009#12       = 0;
     #eosm0009#13       = 0;

     nSwLee      = 1;
     aDClave = "A";  aHClave = "G"; |BUCLE eosm0010_02;
     aDClave = "Z";  aHClave = "Z"; |BUCLE eosm0010_02;

     |HAZ CargaT1434701;

     nSwLee = 0;
     aDClave = "A";  aHClave = "G"; |BUCLE eosm0010_02;
     aDClave = "Z";  aHClave = "Z"; |BUCLE eosm0010_02;

     |XCIERRA nHandle;

     enEmpresa    = #eosm0009#0;
     eaNomEmpresa = #eosclien#2;

     #dsmoy000#0  = eaModelos;
     #dsmoy000#6  = eaEjer;

     |HAZ PresentaPortal;

     |SI eaOpcion ! "1";  |Y enErrorPortal = 0;
         #eosm0009#2 = #eoszp015#3;
         |GRABA 020#eosm0009.a;
     |FINSI;
     |LIBERA #eosm0009;
|FPRC;

|DEFBUCLE eosm0009_02;
     #eosm0009#1;
     ;
     #eoszp015#0, #eoszp015#2;
     #eoszp015#1, #eoszp015#2;
     be;
     NULL, eosm0009_02;
|FIN;

|PROCESO Bloque2014;
     |HAZ Botones_2012;
     |SI eaOpcion = "0";  |ACABA;  |FINSI;

     nTecla = 1;

     |ABRE #eosm0009;
     |ABRE #eosclien;
     |ABRE #eosm0014;
     |BUCLE eosm0009_02;
     |CIERRA #eosm0009;
     |CIERRA #eosclien;
     |CIERRA #eosm0014;

     |HAZ SacaErrorPtl;

     |SI eaOpcion = "3";
         |SI enPresentar = 0;
             aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
             |MENAV aAlfa;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Bloque2015;
     |HAZ Botones_2015;
     |SI eaOpcion = "0";  |ACABA;  |FINSI;

     nTecla = 1;

     |ABRE #eosm0009;
     |ABRE #eosclien;
     |ABRE #eosm0014;
     |BUCLE eosm0009_02;
     |CIERRA #eosm0009;
     |CIERRA #eosclien;
     |CIERRA #eosm0014;

     |SI eaOpcion = "3";
         |SI enPresentar = 0;
             aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
             |MENAV aAlfa;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO moy34702;
     nTopeCobro  = 6000;
     eaTipoSec   = "347";
     enAnyo      = 2000 + #eoszp015#2;
     eaModelos   = "347";
     eaEjer      = enAnyo;

     eaPathLanza = eaUnidad + "\MODELOS";            |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\" + eaModelos;    |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\" + eaEjer;       |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\";

     |DBASE eaPathEmision;
     eaPathEmision = eaPathEmision + "emisiones";       |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + eaModelos;   |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + eaEjer;      |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/";

     eaPathInternet = eaUnidad + "/AEAT";                |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/INTERNET";      |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + eaModelos;  |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + eaEjer;     |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/";

     #dsmoy000#0  = eaModelos;
     #dsmoy000#6  = eaEjer;

     |SI enAnyo [ 2014;  |HAZ Bloque2014;  |FINSI;
     |SI enAnyo ] 2015;  |HAZ Bloque2015;  |FINSI;
|FPRC;
