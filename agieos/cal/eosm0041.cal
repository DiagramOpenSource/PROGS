|FICHEROS;
     eosm0042 #32;
     eosm0041 #31,MANTE;
     eosm0046 #36;

     eosm0045 #29;
|FIN;

|VARIABLES;
    FEstado = 0;
    ModoEntrada = 0;
    Periodif = "";

    nInkey     = 0;
    &enEmpresa = 0;
    &eaNif     = "";
    &enReferen = 0;
|FIN;

|RUTINA inf44;
    #32#0  = #31#0;
    #32#1  = #31#1;
    #32#2  = #31#2;
    #32#11 = #31#4;
    #32#9  = 01;
|FRUT;

|RUTINA sup44;
   #32#0  = #31#0;
   #32#1  = #31#1;
   #32#2  = #31#2;
   #32#11 = #31#4;
   #32#9  = 9999;
|FRUT;

|PROCESO Tipo7m0031;  |TIPO 7;
     |PTEC 807;
     |ENTLINEAL #1#32, -5, 4, 16, 0, inf44, sup44;
|FPRC;

|PROCESO ClaveInf29;
     #29#0 = #31#0;
     #29#1 = "            ";
     #29#4 = 01;
|FPRC;

|PROCESO ClaveSup29;
     #29#0 = #31#0;
     #29#1 = "zzzzzzzzzzzz";
     #29#4 = 99;
|FPRC;

|PROCESO ConsultaRef;
         |ABRE #29;
         #29#0 = #31#0;
         #29#1 = #31#2;
         #29#4 = #31#4;
         |CONSULTA_F_CLAVE #1#29, ClaveInf29, ClaveSup29;
         |CIERRA #29;
         #31#0 = #29#0; |PINTA #31#0;
         #31#2 = #29#1; |PINTA #31#2;
         #31#3 = #29#2; |PINTA #31#3;
         #31#4 = #29#4; |PINTA #31#4;
         #31#5 = #29#5; |PINTA #31#5;
|FPRC;

|PROCESO Tipo11m0031;  |TIPO 11;
     nInkey = FSalida;

     |SI nInkey = 10;
         |ABRE #eosm0046;
         #eosm0046#0 = #31#0;
         |LEE 010#eosm0046.=;
         |SI FSalida = 0;
             Periodif = #eosm0046#2;
         |FINSI;
         |CIERRA #eosm0046;

         |ENTLINEAL #1#eosm0042, -5, 2, 16, 0, inf44, sup44;
     |FINSI;

     |SI nInkey = 11;
         |HAZ ConsultaRef;
     |FINSI;
|FPRC;

|PROCESO Borra;
   |BORRA 020#eosm0042.a;
|FPRC;

|DEFBUCLE Borra;
   #eosm0042#1;
   ;
   #eosm0041#0,#eosm0041#1,#eosm0041#2, #eosm0041#4, 0001;
   #eosm0041#0,#eosm0041#1,#eosm0041#2, #eosm0041#4, 9999;
   ;
   NULL,Borra;
|FIN;

|PROCESO BorraLin; |TIPO 1;
   ModoEntrada = (FEntrada / 100) ! 0;

   |SI ModoEntrada = 3;
       |ABRE #eosm0042;
       |BUCLE Borra;
       |CIERRA #eosm0042;
   |FINSI;

   |SI ModoEntrada = 2;
       |ENTLINEAL #1#eosm0042, -5, 2, 16, 0, inf44, sup44;
   |FINSI;
|FPRC;

|PROCESO Tipo0; |TIPO 0;
   ModoEntrada = (FEntrada / 100) ! 0;

   |ABRE #29;
   #29#0 = #31#0;
   #29#1 = #31#2;
   #29#4 = #31#4;
   |LEE 041#29=;
   |SI FSalida ! 0;
       |CIERRA #29;
       |CONFI "0000SNo exise Arrendador y Ref. Catastral. Crear ";
       |SI FSalida = 0;
           enEmpresa = #31#0;
           eaNif     = #31#2;
           enReferen = #31#4;
           |SUB_EJECUTA "eosm0046;MODELO";
       |FINSI;
       |ERROR;
       |ACABA;
   |FINSI;
   |CIERRA #29;

   #31#3 = #29#2; |PINTA #31#3;
   #31#5 = #29#5; |PINTA #31#5;
|FPRC;
