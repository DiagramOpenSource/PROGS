|FICHEROS;
     reoz0013 #0;

     dsm18401 #1;
     dsm18403 #3;
     dsm18405 #5;
     dsm18406 #6;
     dsm18407 #7;
     dsm18408 #8;
     dsm18409 #9;
     dsm18414 #14;
     dsm18415;
     dsm18430 #30;
     dsm18431 #31;
     reoz0010 #10;
     reow0003 #50;

     eosclien #999;
|FIN;

|VARIABLES;
     nCampo         = 0;
     nSwGraba       = 0;
     nDEmpresa      = 0;
     nHEmpresa      = 0;
     nDComple       = 0;
     nHComple       = 0;
     nLectura       = 0;
     nWord1         = -1;
     nHandle        = 0;
     nLen           = 0;
     nPos           = 0;
     nPrimero       = 0;
     nCampos        = 0;
     nRdtos1        = 0;
     nRdtos2        = 0;
     nRdtos3        = 0;
     nRdtos4        = 0;
     nRdtos5        = 0;
     nRdtos6        = 0;
     nRdtos7        = 0;
     nRdtos8        = 0;
     nRdtos2A       = 0;
     nRdtos2B       = 0;
     nRdtos2C       = 0;
     nRdtos2D       = 0;
     nRdtos6A       = 0;
     nRdtos6B       = 0;
     nRdtos6C       = 0;
     nRdtos6D       = 0;
     nNume          = 0;
     nLong          = 0;
     nDecimal       = 0;
     nCaracter      = 0;
     nBytes         = 0;

     nSwImprime     = 0;
     nEmpresa       = 0;
     nEjercicio     = 0;
     nConta         = 0;

     aFichero       = "";
     aAlfa          = "";
     aAlfa1         = "";
     aAlfa2         = "";
     aAlfa3         = "";
     aBase          = "";
     aOrigen        = "";
     aDestino       = "";
     aIPRemoto      = "";
     aAbre1         = "";
     aAbre2         = "";
     aPath          = "";
     aPathDoc       = "";
     aCadena        = "";
     aLen           = "";
     aAsigna        = "";
     aCaracter      = "";
     aIdenti        = "";
     aDocumento1    = "";
     aDocumento2    = "";
     aQueQuiero     = "";
     aImporte       = "";
     aImpor1        = "";
     aImpor2        = "";
     aImpor3        = "";
     aImpor4        = "";
     aDecima        = "";
     aEntero        = "";
     aLong          = "";
     nSwBorra       = 0;

     fFecha         = @;

    &enEmpresa      = 0;

    aCarta          = "";
    nNumCampos      = 0;
|FIN;

|INCLUYE i_consul;

|| Procesos de la Pantalla __________________________________________________

|PROCESO ElAny; |TIPO 7;
     fFecha = ~;
     aAlfa1 = fFecha;
     aAlfa1 = aAlfa1 % -104;
     #0#14 = aAlfa1;
     #0#14 = #0#14 - 1;
     |PINTA #0#14;
|FPRC;

|PROCESO Tipo7;  |TIPO 7;
     |SI enEmpresa ! 0;
         #0#0 = enEmpresa;  |PINTA #0#0;
         #0#1 = enEmpresa;  |PINTA #0#1;

         |C_M #0#0, 1, "N";
         |C_M #0#1, 1, "N";
     |FINSI;
|FPRC;

|PROCESO Parrilla;
     |SI #0#0 = 0;
         #0#0 = 0;  |PINTA #0#0;
         #0#1 = 0;  |PINTA #0#1;  |C_M #0#1, 1, "N";
         |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |SINO;
         |SI enEmpresa = 0;
             |C_M #0#0, 1, "S";
             |C_M #0#1, 1, "S";
         |FINSI;

         |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
               #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasEmpresas;
     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               #0nCampo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|| _________________________________________________________________________

|PROCESO SeparaImporte;
     aImporte  = nNume;

     aDecima   = "";
     aEntero   = "";
     aLong     = aImporte % 0;
     nLong     = aLong;
     nDecimal  = 0;
     |PARA nCaracter = 1;  |SI nCaracter [ nLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPos      = (100 * nCaracter) + 1;
           aCaracter = aImporte % nPos;
           |SI aCaracter = ".";
               nDecimal = 1;
           |SINO;
               |SI nDecimal = 0;
                   aEntero = aEntero + aCaracter;
               |SINO;
                   aDecima = aDecima + aCaracter;
               |FINSI;
           |FINSI;
     |SIGUE;

     aDecima = (aDecima + "00") % 102;
     aImporte = aEntero;

     aLong = aImporte % 0;
     nLong = aLong;
     aImporte = "             " + aImporte;
     aImporte = aImporte % -113;
     aImpor1   = aImporte % -103;
     aImpor2   = aImporte % -403;
     aImpor3   = aImporte % -703;
     aImpor4   = aImporte % -1004;
     |SI nLong ] 10;
         |SI aImpor4 ! "  -";
             aImporte = aImpor4 + "." + aImpor3  + "." + aImpor2 + "." + aImpor1;
         |SINO;
             aImporte = aImpor4 + aImpor3  + "." + aImpor2 + "." + aImpor1;
      |FINSI;
    |SINO;
        |SI nLong ] 7;
            |SI aImpor3 ! "  -";
                aImporte = aImpor3  + "." + aImpor2 + "." + aImpor1;
            |SINO;
                aImporte = aImpor3 + aImpor2 + "." + aImpor1;
            |FINSI;
        |SINO;
            |SI nLong ] 4;
                |SI aImpor2 ! "  -";
                    aImporte = aImpor2 + "." + aImpor1;
                |SINO;
                    aImporte = aImpor2 + aImpor1;
                |FINSI;
            |SINO;
                aImporte = aImpor1;
            |FINSI;
        |FINSI;
     |FINSI;

     aImporte = ("             " + aImporte + "," + aDecima) % -113;

     |SI aImporte = "            0";  aImporte = "             ";  |FINSI;
     |SI aImporte = "         0,00";  aImporte = "             ";  |FINSI;
|FPRC;

|PROCESO AbreWord;
     aAlfa = "/MODELOS";                   |RMKDIR aAlfa;
     aAlfa = "/MODELOS/DOCUMENTOS";        |RMKDIR aAlfa;

     |DBASE aBase;
     aOrigen   = aBase + "cartas/" + aCarta;
     aDestino  = "/MODELOS/DOCUMENTOS/" + aCarta;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     nWord1      = 1;
     aAbre1      = aDestino;
     aDocumento1 = aAbre1;

     |MENSA "      Abriendo Documento";

     |WORD_ABRE nWord1, aAbre1;
     |WORD_PROPIEDADES nWord1, "Visible", "NO";

     |MENSA "      Cargando Variables al Documento";
|FPRC;

|PROCESO Asigna;
     aCadena = "";
     aLen    = aAsigna % 0;
     nLen    = aLen;
     |PARA nCampo = 1;  |SI nCampo [ nLen;  |HACIENDO nCampo = nCampo + 1;
           nPos = (100 * nCampo) + 1;
           aCaracter = aAsigna % nPos;
           |SI aCaracter = "¥";  aCaracter = &209; |FINSI;
           |SI aCaracter = "¤";  aCaracter = &241; |FINSI;
           |SI aCaracter = " ";  aCaracter = &225; |FINSI;
           |SI aCaracter = "‚";  aCaracter = &233; |FINSI;
           |SI aCaracter = "¡";  aCaracter = &237; |FINSI;
           |SI aCaracter = "¢";  aCaracter = &243; |FINSI;
           |SI aCaracter = "£";  aCaracter = &250; |FINSI;
           |SI aCaracter = "§";  aCaracter = &176; |FINSI;
           |SI aCaracter = "¦";  aCaracter = &170; |FINSI;
           aCadena = aCadena + aCaracter;
     |SIGUE;
     aAsigna = aCadena;

     |WORD_ASIGNA_TEXTO nWord1,  aIdenti, aAsigna;

     |SI aIdenti = "!#131#";
         aIdenti = "!!@#131#";
         |WORD_ASIGNA_TEXTO nWord1,  aIdenti, aAsigna;
     |FINSI;
|FPRC;

|PROCESO PonVariables;
     |PARA nCampos = 16;  |SI nCampos [ nNumCampos;  |HACIENDO nCampos = nCampos + 1;
           aQueQuiero = "|C" + (("000" + nCampos) % -103) + "NOMBRE";
           aIdenti    = "!" + #0#aQueQuiero#;
           aAsigna    = #0nCampos;  |QBF aAsigna;

           aQueQuiero = "|C" + (("000" + nCampos) % -103) + "TIPO";
           aAlfa      =  #0#aQueQuiero#;
           |SI aAlfa  = "N";
               nNume    = #0nCampos;
               |HAZ SeparaImporte;
               aAsigna   = aImporte;
           |FINSI;

           |HAZ Asigna;
     |SIGUE;
|FPRC;

|PROCESO CierraWord;
     |MENSA "      Imprimiendo";

     |PULSATECLA;
     |WORD_IMPRIME nWord1, "";
     |WORD_PROPIEDADES nWord1, "Visible", "NO";

     |SLEEP 10;

     |MENSA "      Cerrando Documento";

     |WORD_SALVA nWord1, "";

     |RFBORRA aDocumento1;
|FPRC;

|PROCESO dsm18403;
     |SI #3#4 = "N";
         |SI #3#5 = "ES";
             #0#23 = #0#23 + #3#6;
             #0#24 = #0#24 + #3#7;
             #0#25 = #0#25 + #3#8;
         |SINO;
             #0#26 = #0#26 + #3#6;
             #0#27 = #0#27 + #3#7;
             #0#28 = #0#28 + #3#8;
         |FINSI;
     |SINO;
         |SI #0#29 = 0;  |O #0#29 = #3#9;
             #0#29 = #3#9;
             #0#30 = #0#30 + #3#10;
             |ACABA;
         |FINSI;

         #0#31 = #3#9;
         #0#32 = #0#32 + #3#10;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18403;
     #3#1;
     ;
     #1#0, #1#1, #1#3, 001;
     #1#0, #1#1, #1#3, 999;
     ;
     NULL, dsm18403;
|FIN;

|PROCESO dsm18405;
     |SI #5#4 = "N";
         |SI #5#5 = "ES";
             #0#33 = #0#33 + #5#6;
             #0#34 = #0#34 + #5#7;
             #0#35 = #0#35 + #5#8;
         |SINO;
             #0#36 = #0#36 + #5#6;
             #0#37 = #0#37 + #5#7;
             #0#38 = #0#38 + #5#8;
         |FINSI;
     |SINO;
         |SI #0#39 = 0;  |O #0#39 = #5#9;
             #0#39 = #5#9;
             #0#40 = #0#40 + #5#10;
             |ACABA;
         |FINSI;

         #0#41 = #5#9;
         #0#42 = #0#42 + #5#10;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18405;
     #5#1;
     ;
     #1#0, #1#1, #1#3, 001;
     #1#0, #1#1, #1#3, 999;
     ;
     NULL, dsm18405;
|FIN;

|PROCESO dsm18431;
     |SI #31#4 = "ES";
         |SI #31#9 = "N";
             nRdtos1 = nRdtos1 + #31#6;
             nRdtos2 = nRdtos2 + #31#7;
             nRdtos3 = nRdtos3 + #31#8;
             nRdtos2A = nRdtos2A + #31#11;
             nRdtos2B = nRdtos2B + #31#12;
             nRdtos2C = nRdtos2C + #31#13;
             nRdtos2D = nRdtos2D + #31#14;
         |SINO;
             nRdtos4 = nRdtos4 + #31#8;
         |FINSI;
     |SINO;
         |SI #31#9 = "N";
             nRdtos5 = nRdtos5 + #31#6;
             nRdtos6 = nRdtos6 + #31#7;
             nRdtos7 = nRdtos7 + #31#8;
             nRdtos6A = nRdtos6A + #31#11;
             nRdtos6B = nRdtos6B + #31#12;
             nRdtos6C = nRdtos6C + #31#13;
             nRdtos6D = nRdtos6D + #31#14;
         |SINO;
             nRdtos8 = nRdtos8 + #31#8;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18431;
     #31#1;
     ;
     #6#0, #6#1, #6#2, #6#3, "  ", " ";
     #6#0, #6#1, #6#2, #6#3, "zz", "z";
     ;
     NULL, dsm18431;
|FIN;

|PROCESO dsm18406;
     nRdtos1 = 0;
     nRdtos2 = 0;
     nRdtos3 = 0;
     nRdtos4 = 0;
     nRdtos5 = 0;
     nRdtos6 = 0;
     nRdtos7 = 0;
     nRdtos8 = 0;
     nRdtos2A = 0;
     nRdtos2B = 0;
     nRdtos2C = 0;
     nRdtos2D = 0;
     nRdtos6A = 0;
     nRdtos6B = 0;
     nRdtos6C = 0;
     nRdtos6D = 0;
     |BUCLE dsm18431;

     |SI #6#7 ! 0;  |O #6#8 ! 0;  |O #6#9 ! 0;
         |SI #0#45 = "    ";
             #0#43 = #6#4;
             #0#44 = #6#5;
             #0#45 = #6#6;
             #0#46 = nRdtos1;
             #0#47 = nRdtos2;
             #0#48 = nRdtos3;
             #0#49 = nRdtos4;
             #0#156 = nRdtos2A;
             #0#157 = nRdtos2B;
             #0#158 = nRdtos2C;
             #0#159 = nRdtos2D;
         |SINO;
             #0#50 = #6#4;
             #0#51 = #6#5;
             #0#52 = #6#6;
             #0#53 = #0#53 + nRdtos1;
             #0#54 = #0#54 + nRdtos2;
             #0#55 = #0#55 + nRdtos3;
             #0#56 = #0#56 + nRdtos4;
             #0#160 = #0#160 + nRdtos2A;
             #0#161 = #0#161 + nRdtos2B;
             #0#162 = #0#162 + nRdtos2C;
             #0#163 = #0#163 + nRdtos2D;
         |FINSI;
     |FINSI;

     |SI #6#10 ! 0;  |O #6#11 ! 0;  |O #6#12 ! 0;
         #0#57 = #6#4;
         #0#58 = #6#5;
         #0#59 = #6#6;
         #0#60 = #0#60 + nRdtos5;
         #0#61 = #0#61 + nRdtos6;
         #0#62 = #0#62 + nRdtos7;
         #0#63 = #0#63 + nRdtos8;
         #0#164 = #0#164 + nRdtos6A;
         #0#165 = #0#165 + nRdtos6B;
         #0#166 = #0#166 + nRdtos6C;
         #0#167 = #0#167 + nRdtos6D;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18406;
     #6#1;
     ;
     #1#0, #1#1, #1#3, 001;
     #1#0, #1#1, #1#3, 999;
     ;
     NULL, dsm18406;
|FIN;

|PROCESO dsm18408;
     |SI #8#4 = "ES";
         #0#64 = "ES";
         |SI #8#5 = "G";
             #0#65 = #0#65 + #8#6;
         |SINO;
             #0#66 = #0#66 + #8#6;
         |FINSI;
     |SINO;
         |SI #0#67 = "  ";
             #0#67 = #8#4;
         |FINSI;
         |SI #8#5 = "G";
             #0#68 = #0#68 + #8#6;
         |SINO;
             #0#69 = #0#69 + #8#6;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18408;
     #8#1;
     ;
     #1#0, #1#1, #1#3, 001;
     #1#0, #1#1, #1#3, 999;
     ;
     NULL, dsm18408;
|FIN;

|PROCESO dsm18409;
     |SI #9#5 = "ES";
         |SI #9#9 = "N";
             |SI #9#6 = "G";
                 #0#70 = #0#70 + #9#7;
             |SINO;
                 #0#71 = #0#71 + #9#7;
             |FINSI;
         |SINO;
             |SI #9#4 = "N";
                 |SI #9#6 = "G";
                     #0#75 = #0#75 + #9#7;
                 |SINO;
                     #0#76 = #0#76 + #9#7;
                 |FINSI;
             |SINO;
                 |SI #9#6 = "G";
                     #0#80 = #0#80 + #9#7;
                 |SINO;
                     #0#80 = #0#81 + #9#7;
                 |FINSI;
             |FINSI;
         |FINSI;
     |SINO;
         |SI #9#9 = "N";
             |SI #0#72 = "  ";  #0#72 = #9#5;  |FINSI;
             |SI #9#6 = "G";
                 #0#73 = #0#73 + #9#7;
             |SINO;
                 #0#74 = #0#74 + #9#7;
             |FINSI;
         |SINO;
             |SI #9#4 = "N";
                 |SI #0#77 = "  ";  #0#77 = #9#5;  |FINSI;

                 |SI #9#6 = "G";
                     #0#78 = #0#78 + #9#7;
                 |SINO;
                     #0#79 = #0#79 + #9#7;
                 |FINSI;
             |SINO;
                 |SI #0#82 = "  ";  #0#82 = #9#5;  |FINSI;

                 |SI #9#6 = "G";
                     #0#83 = #0#83 + #9#7;
                 |SINO;
                     #0#84 = #0#84 + #9#7;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18409;
     #9#1;
     ;
     #1#0, #1#1, #1#3, 001;
     #1#0, #1#1, #1#3, 999;
     ;
     NULL, dsm18409;
|FIN;

|PROCESO dsm18415;
     |SI #dsm18415#4 = "ES";
         #0#142 = "ES";
         |SI #dsm18415#5 = "G";
             #0#143 = #0#143 + #dsm18415#6;
         |SINO;
             #0#144 = #0#144 + #dsm18415#6;
         |FINSI;
     |SINO;
         |SI #0#145 = "  ";
             #0#145 = #dsm18415#4;
         |FINSI;

         |SI #dsm18415#5 = "G";
             #0#146 = #0#146 + #dsm18415#6;
         |SINO;
             #0#147 = #0#147 + #dsm18415#6;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18415;
     #dsm18415#1;
     ;
     #1#0, #1#1, #1#3, 001;
     #1#0, #1#1, #1#3, 999;
     ;
     NULL, dsm18415;
|FIN;

|PROCESO dsm18407;
     |SI nConta > 2;
         aAlfa1    = "}5}3}1}+F";
         aAlfa2    = "1";
         |WORD_ASIGNA_TEXTO nWord1, aAlfa1, aAlfa2;
     |FINSI;

     nConta = nConta + 1;

     aAlfa1 = "}5}" + nConta + "}1}";
     aAlfa2 = #7#4;
     |WORD_ASIGNA_TEXTO nWord1, aAlfa1, aAlfa2;

     aAlfa1 = "}5}" + nConta + "}2}";
     aAlfa2 = #7#5;
     |WORD_ASIGNA_TEXTO nWord1, aAlfa1, aAlfa2;

     aAlfa1 = "}5}" + nConta + "}3}";
     aAlfa2 = #7#6;
     |WORD_ASIGNA_TEXTO nWord1, aAlfa1, aAlfa2;

     nNume = #7#8;   |HAZ SeparaImporte;
     aAlfa1 = "}5}" + nConta + "}4}";
     aAlfa2 = aImporte;
     |WORD_ASIGNA_TEXTO nWord1, aAlfa1, aAlfa2;

     nNume = #7#7;   |HAZ SeparaImporte;
     aAlfa1 = "}5}" + nConta + "}5}";
     aAlfa2 = aImporte;
     |WORD_ASIGNA_TEXTO nWord1, aAlfa1, aAlfa2;

     nNume = #7#9;   |HAZ SeparaImporte;
     aAlfa1 = "}5}" + nConta + "}6}";
     aAlfa2 = aImporte;
     |WORD_ASIGNA_TEXTO nWord1, aAlfa1, aAlfa2;
|FPRC;

|DEFBUCLE dsm18407;
     #7#1;
     ;
     #1#0, #1#1, #1#3, 001;
     #1#0, #1#1, #1#3, 999;
     ;
     NULL, dsm18407;
|FIN;

|PROCESO dsm18430;
     #reow0003#0 = #dsm18430#0;
     #reow0003#1 = #dsm18430#1;
     #reow0003#2 = #dsm18430#2;
     |LEE 101#reow0003.=;

     |SI nSwImprime = 1;
        |SI FSalida ! 0;
           nSwBorra = 0;
           |DDEFECTO #reow0003;
        |SINO;
           nSwBorra = 1;
        |FINSI;

        |PDEFECTO #0, 102, 129;
        |PDEFECTO #0, 134, 139;
        |PDEFECTO #0, 154, 155;
        #0#175 = 0;
        #0#102 = #dsm18430#4;
        #0#103 = #dsm18430#2;
        #0#104 = #dsm18430#5;
        #0#107 = #dsm18430#11;

        #0#108 = #reow0003#3 + #dsm18430#12;
        #0#109 = #reow0003#4 + #dsm18430#13;
        #0#152 = #reow0003#5 + #dsm18430#43;
        #0#153 = #reow0003#6 + #dsm18430#44;
        #0#110 = #reow0003#7 + #dsm18430#14;
        #0#111 = #reow0003#8 + #dsm18430#15;
        #0#112 = #reow0003#9 + #dsm18430#16;
        #0#113 = #reow0003#10 + #dsm18430#17;
        #0#139 = #reow0003#11 + #dsm18430#18;
        #0#114 = #reow0003#12 + #dsm18430#19;
        #0#115 = #reow0003#13 + #dsm18430#20;
        #0#116 = #reow0003#14 + #dsm18430#21;
        #0#117 = #reow0003#15 + #dsm18430#22;
        #0#154 = #reow0003#33 + #dsm18430#49;
        #0#155 = #reow0003#34 + #dsm18430#50;

        |SI #dsm18430#23 = "X";
           #reow0003#16 = #reow0003#16 + #dsm18430#25;
           #reow0003#17 = #reow0003#17 + #dsm18430#26;
           #reow0003#18 = #reow0003#18 + #dsm18430#27;
           #reow0003#19 = #reow0003#19 + #dsm18430#28;
           #reow0003#20 = #reow0003#20 + #dsm18430#29;
           #reow0003#21 = #reow0003#21 + #dsm18430#30;
        |FINSI;
        |SI #dsm18430#24 = "X";
           #reow0003#22 = #reow0003#22 + #dsm18430#25;
           #reow0003#23 = #reow0003#23 + #dsm18430#26;
           #reow0003#24 = #reow0003#24 + #dsm18430#27;
           #reow0003#25 = #reow0003#25 + #dsm18430#28;
           #reow0003#26 = #reow0003#26 + #dsm18430#29;
           #reow0003#27 = #reow0003#27 + #dsm18430#30;
        |FINSI;

        #0#118 = #reow0003#16;
        #0#119 = #reow0003#17;
        #0#120 = #reow0003#18;
        #0#121 = #reow0003#19;
        #0#122 = #reow0003#20;
        #0#123 = #reow0003#21;
        #0#175 = #0#123;

        |SI #0#14 < 2015;
            #0#124 = #reow0003#22;
            #0#125 = #reow0003#23;
            #0#126 = #reow0003#24;
            #0#127 = #reow0003#25;
            #0#128 = #reow0003#26;
            #0#129 = #reow0003#27;
        |SINO;
            #0#125 = #reow0003#22;
            #0#126 = #reow0003#23;
            #0#128 = #reow0003#24;
            #0#129 = #reow0003#25;
        |FINSI;
        #reow0003#28 = #reow0003#28 + #dsm18430#31;
        #reow0003#29 = #reow0003#29 + #dsm18430#45;
        #reow0003#30 = #reow0003#30 + #dsm18430#46;
        #reow0003#31 = #reow0003#31 + #dsm18430#47;
        #reow0003#32 = #reow0003#32 + #dsm18430#48;
        #reow0003#33 = #reow0003#33 + #dsm18430#49;
        #reow0003#34 = #reow0003#34 + #dsm18430#50;

        #0#138 = #reow0003#28;
        #0#134 = #reow0003#29;
        #0#135 = #reow0003#30;
        #0#136 = #reow0003#31;
        #0#137 = #reow0003#32;

        #0#130 = #reow0003#28 + #reow0003#29 + #reow0003#30 + #reow0003#31 + #reow0003#32;
        #0#130 = #0#130 + #reow0003#33 + #reow0003#34;
        #0#130 = #0#130 + #dsm18430#31 + #dsm18430#45 + #dsm18430#46 + #dsm18430#47 + #dsm18430#48;
        #0#130 = #0#130 + #dsm18430#49 + #dsm18430#50;

        |HAZ AbreWord;
        |HAZ PonVariables;
        nConta = 2;  |BUCLE dsm18407;
        |HAZ CierraWord;

        |SI nSwBorra = 1;
           |BORRA 020#reow0003.a;
        |FINSI;
        |LIBERA #reow0003;
     |SINO;
        |SI FSalida ! 0;
           |DDEFECTO #reow0003;
           #reow0003#0 = #dsm18430#0;
           #reow0003#1 = #dsm18430#1;
           #reow0003#2 = #dsm18430#2;
           |GRABA 020#reow0003.b;
        |FINSI;
        #reow0003#3  = #reow0003#3  + #dsm18430#12;
        #reow0003#4  = #reow0003#4  + #dsm18430#13;
        #reow0003#5  = #reow0003#5  + #dsm18430#43;
        #reow0003#6  = #reow0003#6  + #dsm18430#44;
        #reow0003#7  = #reow0003#7  + #dsm18430#14;
        #reow0003#8  = #reow0003#8  + #dsm18430#15;
        #reow0003#9  = #reow0003#9  + #dsm18430#16;
        #reow0003#10 = #reow0003#10 + #dsm18430#17;
        #reow0003#11 = #reow0003#11 + #dsm18430#18;
        #reow0003#12 = #reow0003#12 + #dsm18430#19;
        #reow0003#13 = #reow0003#13 + #dsm18430#20;
        #reow0003#14 = #reow0003#14 + #dsm18430#21;
        #reow0003#15 = #reow0003#15 + #dsm18430#22;
        #reow0003#33 = #reow0003#33 + #dsm18430#49;
        #reow0003#34 = #reow0003#34 + #dsm18430#50;
        |SI #dsm18430#23 = "X";
           #reow0003#16 = #reow0003#16 + #dsm18430#25;
           #reow0003#17 = #reow0003#17 + #dsm18430#26;
           #reow0003#18 = #reow0003#18 + #dsm18430#27;
           #reow0003#19 = #reow0003#19 + #dsm18430#28;
           #reow0003#20 = #reow0003#20 + #dsm18430#29;
           #reow0003#21 = #reow0003#21 + #dsm18430#30;
        |FINSI;
        |SI #dsm18430#24 = "X";
           #reow0003#22 = #reow0003#22 + #dsm18430#25;
           #reow0003#23 = #reow0003#23 + #dsm18430#26;
           #reow0003#24 = #reow0003#24 + #dsm18430#27;
           #reow0003#25 = #reow0003#25 + #dsm18430#28;
           #reow0003#26 = #reow0003#26 + #dsm18430#29;
           #reow0003#27 = #reow0003#27 + #dsm18430#30;
        |FINSI;
        #reow0003#28 = #reow0003#28 + #dsm18430#31;
        #reow0003#29 = #reow0003#29 + #dsm18430#45;
        #reow0003#30 = #reow0003#30 + #dsm18430#46;
        #reow0003#31 = #reow0003#31 + #dsm18430#47;
        #reow0003#32 = #reow0003#32 + #dsm18430#48;
        #reow0003#33 = #reow0003#33 + #dsm18430#49;
        #reow0003#34 = #reow0003#34 + #dsm18430#50;
        |GRABA 020#reow0003.a; |LIBERA #reow0003;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18430;
     #dsm18430#1;
     ;
     #1#0, #1#1, #1#3, 001;
     #1#0, #1#1, #1#3, 999;
     ;
     NULL, dsm18430;
|FIN;

|PROCESO dsm18401;
     |SI nLectura = 0;
         |SI #1#3 ! 0;
             |SI #1#5 = "S";
                 nDComple = #1#3;
                 nHComple = #1#3;
             |SINO;
                 nHComple = #1#3;
             |FINSI;
             |SI #1#7 ! 0; || ABDON Tiquet 003283/00401
                nDComple = #1#3;
                nHComple = #1#3;
             |FINSI;       || FIN Tiquet 003283/00401
         |SINO;
             nDComple = #1#3;
             nHComple = #1#3;
         |FINSI;
         |ACABA;
     |FINSI;

     #0#16  = #1#26;
     #0#17  = #1#25;
     #0#18  = #1#9;
     #0#19  = #1#14;
     #0#20  = #1#10;
     #0#21  = #1#11;
     #0#22  = #1#8;
     #0#85  = #1#38;
     #0#86  = #1#39;
     #0#87  = #1#40;
     #0#88  = #1#41;
     #0#89  = #1#42;
     #0#90  = #1#43; #0#174 = #0#89;
     #0#91  = #1#44;
     #0#92  = #1#45;
     #0#93  = #1#46;
     #0#94  = #1#47;
     #0#95  = #1#48;
     #0#96  = #1#49;
     #0#97  = #1#50;
     #0#98  = #1#51;
     #0#99  = #1#52;
     #0#100 = #1#53;
     #0#101 = #1#54;
     #0#148 = #1#34;
     #0#149 = #1#35;
     #0#150 = #1#36;
     #0#151 = #1#37;

     aAlfa1 = #0#15 % 102;
     aAlfa2 = #0#15 % 402;
     aAlfa3 = #0#15 % -104;

     |SI aAlfa2 = "01";  aAlfa2 = "Enero";      |FINSI;
     |SI aAlfa2 = "02";  aAlfa2 = "Febrero";    |FINSI;
     |SI aAlfa2 = "03";  aAlfa2 = "Marzo";      |FINSI;
     |SI aAlfa2 = "04";  aAlfa2 = "Abril";      |FINSI;
     |SI aAlfa2 = "05";  aAlfa2 = "Mayo";       |FINSI;
     |SI aAlfa2 = "06";  aAlfa2 = "Junio";      |FINSI;
     |SI aAlfa2 = "07";  aAlfa2 = "Julio";      |FINSI;
     |SI aAlfa2 = "08";  aAlfa2 = "Agosto";     |FINSI;
     |SI aAlfa2 = "09";  aAlfa2 = "Septiembre"; |FINSI;
     |SI aAlfa2 = "10";  aAlfa2 = "Octubre";    |FINSI;
     |SI aAlfa2 = "11";  aAlfa2 = "Noviembre";  |FINSI;
     |SI aAlfa2 = "12";  aAlfa2 = "Diciembre";  |FINSI;

     #0#132 = aAlfa1 + " de " + aAlfa2 + " de " + aAlfa3;
     #0#133 = #0#14;

     |BUCLE dsm18403;
     |BUCLE dsm18405;
     |BUCLE dsm18406;
     |BUCLE dsm18408;
     |BUCLE dsm18409;
     |BUCLE dsm18415;

     |SALVA_FICHA #dsm18401;
     nEmpresa   = #dsm18401#0;
     nEjercicio = #dsm18401#1;
     |LEE 000#dsm18401.s;
     |SI FSalida = 0; |Y #dsm18401#7 = 0; |Y #dsm18401#0 = nEmpresa; |Y #dsm18401#1 = nEjercicio;
        nSwImprime = 0;
     |SINO;
        nSwImprime = 1;
     |FINSI;
     |REPON_FICHA #dsm18401;

     |BUCLE dsm18430;
|FPRC;

|DEFBUCLE dsm18401;
     #1#1;
     ;
     #999#0, #0#14, 184, nDComple;
     #999#0, #0#14, 184, nHComple;
     ;
     NULL, dsm18401;
|FIN;

|PROCESO eosclien;
    aAlfa = "tm" + Usuario; |NOME_DAT #reow0003#aAlfa#;
    |DELINDEX #reow0003; |ABRE #reow0003;

    |PDEFECTO #0, 16, 176;

    nDComple  = 0;
    nHComple  = 99;

    nLectura  = 0;  |BUCLE dsm18401;
    nLectura  = 1;  |BUCLE dsm18401;

    |CIERRA #reow0003; |DELINDEX #reow0003;
|FPRC;

|DEFBUCLE eosclien;
     #999#1;
     ;
     nDEmpresa;
     nHEmpresa;
     ;
     NULL, eosclien;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |DBASE aPath; |QBF aPath;
     aPathDoc = aPath + "cartas/";

     aCarta = "cartas03.doc";
     nNumCampos = 155;
     |SI #0#14 = 2015; aCarta = "cartas15.doc"; nNumCampos = 175; |FINSI;
     |SI #0#14 ] 2016; aCarta = "cartas16.doc"; nNumCampos = 175; |FINSI;

     nBytes = 0;
     aAbre1 = aPathDoc + "cartas03.doc";
     |XABRE "B", aAbre1, nHandle;
     |SI FSalida < 0;
         nBytes = 1;
     |SINO;
         nBytes = 0;
         |XPOSICION nHandle, nBytes, 2;
     |FINSI;
     |XCIERRA nHandle;

     |SI nBytes = 1;  |O nBytes ! 115200;
         |ABRE #10;
         #10#0 = 3;
         |LEE 101#10=;
         |SI FSalida = 0;
             |BORRA 020#10a;
             |LIBERA #10;
             |FBORRA aAbre1;
         |FINSI;
         |CIERRA #10;

         |SUB_EJECUTA_NP "reoz0010;INSTALA";
     |FINSI;

     nBytes = 0;
     aAbre1 = aPathDoc + "cartas15.doc";
     |XABRE "B", aAbre1, nHandle;
     |SI FSalida < 0;
         nBytes = 1;
     |SINO;
         nBytes = 0;
         |XPOSICION nHandle, nBytes, 2;
     |FINSI;
     |XCIERRA nHandle;

     |SI nBytes = 1; |O nBytes = 119808;
         |ABRE #10;
         #10#0 = 15;
         |LEE 101#10=;
         |SI FSalida = 0;
             |BORRA 020#10a;
             |LIBERA #10;
             |FBORRA aAbre1;
         |FINSI;
         |CIERRA #10;

         |SUB_EJECUTA_NP "reoz0010;INSTALA";
     |FINSI;

     nBytes = 0;
     aAbre1 = aPathDoc + "cartas16.doc";
     |XABRE "B", aAbre1, nHandle;
     |SI FSalida < 0;
         nBytes = 1;
     |SINO;
         nBytes = 0;
         |XPOSICION nHandle, nBytes, 2;
     |FINSI;
     |XCIERRA nHandle;

     |SI nBytes = 1; |O nBytes = 119808;
         |ABRE #10;
         #10#0 = 16;
         |LEE 101#10=;
         |SI FSalida = 0;
             |BORRA 020#10a;
             |LIBERA #10;
             |FBORRA aAbre1;
         |FINSI;
         |CIERRA #10;

         |SUB_EJECUTA_NP "reoz0010;INSTALA";
     |FINSI;

     aAbre1 = aPathDoc + aCarta;
     |XABRE "E", aAbre1, nHandle;
     |SI FSalida < 0;
         aAlfa = "     Instale la Carta 03";
         |SI #0#14 = 2015;
             aAlfa = "     Instale la Carta 15, Modelo 184 Ejer ] 2015";
         |FINSI;
         |SI #0#14 ] 2016;
             aAlfa = "     Instale la Carta 16, Modelo 184 Ejer ] 2016";
         |FINSI;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     nPrimero = 0;
     nWord1   = -1;

     |SI #0#0 ! 0;
         nDEmpresa = #0#0;
         nHEmpresa = #0#1;
         |BUCLE eosclien;
     |SINO;
         |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               nDEmpresa = #0nCampo;
               nHEmpresa = #0nCampo;
               |BUCLE eosclien;
         |SIGUE;
     |FINSI;
|FPRC;
