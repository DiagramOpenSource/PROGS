|FICHEROS;
     dsmow052,MANTE;
     eosclien;

     dsmoy000;
     dsmom004;
     dsmom108;

     dsmow014;
|FIN;

|VARIABLES;
     aAlfa        = "";
     aAlfa1       = "";
     aAlfa2       = "";
     aAlfa3       = "";
     aCadena      = "";
     aLong        = "";
     aCaracter    = "";
     aModelos     = "";
     aDocRemoto   = "";
     aDocServidor = "";
     aIPRemoto    = "";
     aPathMod     = "";
     aPathModelo  = "";
     aPathSesion  = "";
     aPathInter   = "";
     aAbre        = "";
     aBarra       = "";
     aLongAlfa    = "";
     aParaQuitar  = "";
     aLongitud    = "";
     aFich        = "";
     aFich1       = "";
     aFich2       = "";
     aFichero     = "";
     aDirSesion   = "";
     aError       = "";
     aOrigen      = "";
     aDestino     = "";
     aExt         = "";
     aBase        = "";
     aArchivo     = "";

     aVersionBasico= "";
     aVersionJava  = "";
     aEjecutaJava  = "";
     aUnidad       = "";
     aJusti        = "";
     aLen          = "";
     aHora         = "";
     aSeg          = "";
     aDia          = "";
     nHora         = 0;
     nMinu         = 0;
     nSegu         = 0;
     nSeg          = 0;
     nDias         = 0;

     fFecha1       = @;
     fFecha2       = @;

     aVersion     = "";
     nEspa        = 0;
     nLong        = 0;
     nCampo       = 0;
     nPos         = 0;
     nPor         = 0;
     nCopia       = 0;
     nHandleEjec  = 0;
     nHandle1     = 0;
     nBlanco1     = 0;
     nBlanco2     = 0;
     nComa        = 0;
     nPara        = 0;
     nPosi        = 0;
     nLongNume    = 0;
     nLongitud    = 0;
     nCaracter    = 0;
     nCanal       = 0;
     nHePasado    = 0;
     nHandError   = 0;
     nNume        = 0;
     nEjercicio   = 0;
     nHay          = 0;
     nLen          = 0;
     nLenMax       = 0;
     nPaso         = 0;
     nAscci        = 0;

     aPathPdf       = "";
     aPathLocal     = "";
     aPathServidor  = "";
     aProgFiles     = "";

     aIP            = "";

     &enBasico       = 0;
     &enHandle       = 0;
     &eaTipoE        = "";
     &eaTipoR        = "";
     &eaTipoP        = "";
     &eaTipoC        = "";
     &eaTipoA        = "";
     &eaTipoV        = "";
     &eaModoImpre    = "";
     &eaModelos      = "";
     &eaEjer         = "";

     &eaJusti       = "";
     &eaFOrigen     = "";
     &eaFDestino    = "";
     &eaInternet    = "";
     &enNume        = 0;
     &eaAlfa        = "";
     &eaDiaB        = "";
     &eaMesB        = "";
     &eaAnyoB       = "";
     &eaFechaB      = "";
     &enPor100      = 0;
     &enAnyo        = 0;
     &enPer         = 0;
     &eaTipoSec     = "";
     &enError       = 0;
     &eaDirJava     = "";
     &eaCadena      = "";
     &eaCadena1     = "";
     &eaCadena2     = "";
     &eaCadena3     = "";
     &eaPathAcrobat = "";
     &eaPathExplorador = "";
     &eaForzExplorador = "";
     &eaFichDatos   = "";
     &eaFichAuxil   = "";
     &eaFichError   = "";
     &eaPathModelo  = "";
     &enBuenos      = 0;
     &enMalos       = 0;
     &enValidacion  = 0;
     &enInternet    = 0;
     &eaSigno       = "";
     &eaPeriodo     = "";
     &eaAlfa1       = "";
     &eaAlfa2       = "";

     {1}aContiene    = "";
     {1}version      = "";
     {51}aCarac      = "";

     &eaPaisCCE      = "";
     &eSwPaisCCE     = 0;
     &eaVersMod      = "    ";
     &eaNIFDs        = "         ";
|FIN;

|PROCESO eVersionMod;
     eaNIFDs = "B53179768";

     |DBASE aBase;  |QBF aBase;
     aArchivo = aBase + "agieos.men";
     |XABRE "U", aArchivo, nCanal;
     |SI FSalida ] 0;
          |XLEE nCanal, 100, eaVersMod;
     |FINSI;
     |XCIERRA nCanal;
     |QBF eaVersMod;
     eaVersMod = eaVersMod % -105;
     eaVersMod = eaVersMod - ".";
     eaVersMod = (eaVersMod + "    ") % 104;
|FPRC;

|PROCESO PaisCCE;
     eSwPaisCCE = 0;
     eaPaisCCE  = eaPaisCCE > " ";
     eaPaisCCE  = (eaPaisCCE + "   ") % 103;

     |SI eaPaisCCE = "DE ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "AT ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "BE ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "BG ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "CY ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "DK ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "SI ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "EE ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "FI ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "FR ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "EL ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "GB ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "NL ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "HU ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "IT ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "IE ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "LV ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "LT ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "LU ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "MT ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "PL ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "PT ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "CZ ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "SK ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "RO ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "SE ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "GR ";  eSwPaisCCE = 1;  |FINSI;
     |SI eaPaisCCE = "HR ";  eSwPaisCCE = 1;  |FINSI;
|FPRC;

|PROCESO CopiaFicheroIP;
     aAlfa = "";
     |IP_REMOTO aAlfa;  |QBT aAlfa;
     |SI aAlfa ! "";
         |ENVIA_FICHERO eaFOrigen, eaFDestino;
     |SINO;
         |COPIA_FICHERO eaFOrigen, eaFDestino;
     |FINSI;
|FPRC;

|PROCESO Conver5;
     enNume = enNume ! 0;
     |SI enNume ] 0;
         eaSigno = " ";
         eaAlfa  = enNume;
         eaAlfa  = ("00000" + eaAlfa) % -105;
     |SINO;
         eaSigno = "N";
         enNume  = -enNume;
         eaAlfa  = enNume;
         eaAlfa  =  (("00000" + eaAlfa) % -105);
     |FINSI;
|FPRC;

|PROCESO Conver9;
     |SI enPor100 = 0;
         enNume = enNume * 100;
     |FINSI;

     |SI enNume ] 0;
         eaAlfa = ("0000000000" + enNume) % -109;
     |SINO;
         enNume  = -enNume;
         eaAlfa = ("0000000000" + enNume) % -108;
         eaAlfa = "N" + eaAlfa;
     |FINSI;
|FPRC;

|PROCESO Conver10;
     |SI enPor100 = 0;
         enNume = enNume * 100;
     |FINSI;

     |SI enNume ] 0;
         eaAlfa = ("0000000000" + enNume) % -110;
     |SINO;
         enNume  = -enNume;
         eaAlfa = ("0000000000" + enNume) % -109;
         eaAlfa = "N" + eaAlfa;
     |FINSI;
|FPRC;

|PROCESO Conver13;
     |SI #dsmoy000#0 = 390;
         |SI enNume = 0;
             eaAlfa = ("0000000000000" + enNume) % -113;
         |SINO;
             eaAlfa = enNume;
         |FINSI;

         |ACABA;
     |FINSI;

     |SI enPor100 = 0;
         enNume = enNume * 100;
     |FINSI;

     |SI enNume ] 0;
         eaAlfa = ("0000000000000" + enNume) % -113;
     |SINO;
         enNume  = -enNume;
         eaAlfa = ("000000000000" + enNume) % -112;
         eaAlfa = "N" + eaAlfa;
     |FINSI;
|FPRC;

|PROCESO Conver15;
     |SI enPor100 = 0;
         enNume = enNume * 100;
     |FINSI;

     |SI enNume ] 0;
         eaAlfa = ("000000000000000" + enNume) % -115;
     |SINO;
         enNume  = -enNume;
         eaAlfa = ("00000000000000" + enNume) % -114;
         eaAlfa = "N" + eaAlfa;
     |FINSI;
|FPRC;

|PROCESO Conver17;
     |SI enPor100 = 0;
         enNume = enNume * 100;
     |FINSI;

     |SI enNume ] 0;
         eaAlfa = ("00000000000000000" + enNume) % -117;
     |SINO;
         enNume  = -enNume;
         eaAlfa = ("0000000000000000" + enNume) % -116;
         eaAlfa = "N" + eaAlfa;
     |FINSI;
|FPRC;

|PROCESO Conver13Signo;
     enNume = enNume * 100

     |SI enNume ] 0;
         eaSigno = " ";
         eaAlfa  = ("00000000000000000" + enNume) % -113;
     |SINO;
         eaSigno = "N";
         enNume  = -enNume;
         eaAlfa = ("00000000000000000" + enNume) % -113;
     |FINSI;
|FPRC;

|PROCESO Conver15Signo;
     enNume = enNume * 100

     |SI enNume ] 0;
         eaSigno = " ";
         eaAlfa  = ("00000000000000000" + enNume) % -115;
     |SINO;
         eaSigno = "N";
         enNume  = -enNume;
         eaAlfa = ("00000000000000000" + enNume) % -115;
     |FINSI;
|FPRC;

|PROCESO Conver16Signo;
     enNume = enNume * 100

     |SI enNume ] 0;
         eaSigno = " ";
         eaAlfa  = " " + ("00000000000000000" + enNume) % -115;
     |SINO;
         eaSigno = "N";
         enNume  = -enNume;
         eaAlfa = "N" + ("00000000000000000" + enNume) % -115;
     |FINSI;
|FPRC;

|PROCESO Conver17Signo;
     enNume = enNume * 100

     |SI enNume ] 0;
         eaSigno = " ";
         eaAlfa  = ("00000000000000000" + enNume) % -117;
     |SINO;
         eaSigno = "N";
         enNume  = -enNume;
         eaAlfa = ("00000000000000000" + enNume) % -117;
     |FINSI;
|FPRC;

|PROCESO MiraAscii;
     nHay = 0;

     |SI nAscci < 32;  nHay = 1;  |ACABA;  |FINSI;
     |SI nAscci = 33;  nHay = 1;  |ACABA;  |FINSI;
     |SI nAscci = 34;  nHay = 1;  |ACABA;  |FINSI;
     |SI nAscci = 35;  nHay = 1;  |ACABA;  |FINSI;
     |SI nAscci = 36;  nHay = 1;  |ACABA;  |FINSI;
     |SI nAscci = 37;  nHay = 1;  |ACABA;  |FINSI;
     |SI nAscci = 42;  nHay = 1;  |ACABA;  |FINSI;
     |SI nAscci = 43;  nHay = 1;  |ACABA;  |FINSI;
     |SI nAscci = 60;  nHay = 1;  |ACABA;  |FINSI;
     |SI nAscci = 61;  nHay = 1;  |ACABA;  |FINSI;
     |SI nAscci = 62;  nHay = 1;  |ACABA;  |FINSI;
     |SI nAscci = 63;  nHay = 1;  |ACABA;  |FINSI;
     |SI nAscci = 64;  nHay = 1;  |ACABA;  |FINSI;
     |SI nAscci = 91;  nHay = 1;  |ACABA;  |FINSI;
     |SI nAscci = 92;  nHay = 1;  |ACABA;  |FINSI;
     |SI nAscci = 93;  nHay = 1;  |ACABA;  |FINSI;
     |SI nAscci = 94;  nHay = 1;  |ACABA;  |FINSI;

     |SI nAscci ] 96;  |Y nAscci [ 198;
         nHay = 1;  |ACABA;
     |FINSI;

     |SI nAscci ] 200;  |Y nAscci [ 208;
         nHay = 1;  |ACABA;
     |FINSI;

     |SI nAscci ] 210;
         nHay = 1;  |ACABA;
     |FINSI;
|FPRC;

|PROCESO RarosModelos;
     nEspa   = 0;
     aCadena = "";
     aLong   = eaAlfa % 0;
     nLong   = aLong;
     |PARA nCampo = 1;  |SI nCampo [ aLong;  |HACIENDO nCampo = nCampo + 1;
           nPos = (100 * nCampo) + 1;
           aCaracter = eaAlfa % nPos;

           nAscci    = &aCaracter;
           |HAZ MiraAscii;
           |SI nHay = 1;
               aCaracter = " ";
           |FINSI;

           |SI aCaracter = ",";
               |SI eaModelos ! "184";
                   aCaracter = "";
               |SINO;
                   aCaracter = " ";
               |FINSI;
           |FINSI;

           |SI aCaracter = "/";  aCaracter = " ";  |FINSI;
           |SI aCaracter = "•";  aCaracter = &209; |FINSI;
           |SI aCaracter = "§";  aCaracter = &209; |FINSI;
           |SI aCaracter = "ß";  aCaracter = &176; |FINSI;
           |SI aCaracter = "¶";  aCaracter = &170; |FINSI;

           aCadena = aCadena + aCaracter;
     |SIGUE;

     eaAlfa = aCadena + (" " * nEspa);
     eaAlfa = eaAlfa > "";
|FPRC;

|PROCESO QuitaRaros;
     aAlfa = eaAlfa;  |QBF aAlfa;
     |SI aAlfa = "";  |ACABA;  |FINSI;

     eaAlfa = eaAlfa > "";

     aCarac1   = "•";
     aCarac2   = "§";
     aCarac3   = "·";
     aCarac4   = "†";
     aCarac5   = "Ç";
     aCarac6   = "°";
     aCarac7   = "¢";
     aCarac8   = "£";
     aCarac9   = "ß";
     aCarac10  = "¶";
     aCarac11  = "®";
     aCarac12  = "Ä";
     aCarac13  = "á";
     aCarac14  = "Ö";
     aCarac15  = "ä";
     aCarac16  = "ç";
     aCarac17  = "ï";
     aCarac18  = "ó";
     aCarac19  = &001;
     aCarac20  = &002;
     aCarac21  = &003;
     aCarac22  = &004;
     aCarac23  = &005;
     aCarac24  = &006;
     aCarac25  = &007;
     aCarac26  = &015;
     aCarac27  = &016;
     aCarac28  = &017;
     aCarac29  = &018;
     aCarac30  = &019;
     aCarac31  = &020;
     aCarac32  = &021;
     aCarac33  = &022;
     aCarac34  = &023;
     aCarac35  = &024;
     aCarac36  = &025;
     aCarac37  = &026;
     aCarac38  = &028;
     aCarac39  = &029;
     aCarac40  = "Å";
     aCarac41  = &008;
     aCarac42  = "Ô";
     aCarac43  = "µ";
     aCarac44  = "ê";
     aCarac45  = "÷";
     aCarac46  = "‡";
     aCarac47  = "È";
     aCarac48  = &009;
     aCarac49  = &010;
     aCarac50  = &013;
     aCarac51  = "∫";

     IaCarac = aCarac1 <-;
     nHay    = 0;
     |PARA nCampo = 1;  |SI nCampo [ 51;  |HACIENDO nCampo = nCampo + 1;
           aCaracter = eaAlfa - aCarac;
           |SI FSalida ! 0;
               nHay = 1;
               |SAL;
           |FINSI;

           IaCarac = IaCarac + 1;
     |SIGUE;

     |SI nHay = 0;
         |HAZ RarosModelos;
         |ACABA;
     |FINSI;

     aCadena = "";
     aLen    = eaAlfa % 0;
     nLen    = aLen;
     nLenMax = nLen - 1;

     |PARA nCampo = 1;  |SI nCampo [ nLen;  |HACIENDO nCampo = nCampo + 1;
           nPos = (100 * nCampo) + 1;
           aCaracter = eaAlfa % nPos;
           nPaso     = 0;
           nAscci    = &aCaracter;

           |SI aCaracter = aCarac1;  |Y nPaso = 0;  aCaracter = &0209;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac2;  |Y nPaso = 0;  aCaracter = &0241;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac3;  |Y nPaso = 0;  aCaracter = &0225;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac4;  |Y nPaso = 0;  aCaracter = &0225;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac5;  |Y nPaso = 0;  aCaracter = &0233;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac6;  |Y nPaso = 0;  aCaracter = &0237;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac7;  |Y nPaso = 0;  aCaracter = &0243;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac8;  |Y nPaso = 0;  aCaracter = &0250;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac9;  |Y nPaso = 0;  aCaracter = &0176;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac10; |Y nPaso = 0;  aCaracter = &0170;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac11; |Y nPaso = 0;  aCaracter = &0191;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac12; |Y nPaso = 0;  aCaracter = "«";     nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac13; |Y nPaso = 0;  aCaracter = &0231;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac14; |Y nPaso = 0;  aCaracter = &0224;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac15; |Y nPaso = 0;  aCaracter = &0232;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac16; |Y nPaso = 0;  aCaracter = &0236;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac17; |Y nPaso = 0;  aCaracter = &0242;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac18; |Y nPaso = 0;  aCaracter = &0249;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac19; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac20; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac21; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac22; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac23; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac24; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac25; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac26; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac27; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac28; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac29; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac30; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac31; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac32; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac33; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac34; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac35; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac36; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac37; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac38; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac39; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac40; |Y nPaso = 0;  aCaracter = &252;    nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac41; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac42; |Y nPaso = 0;  aCaracter = "¥";     nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac43; |Y nPaso = 0;  aCaracter = "A";     nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac44; |Y nPaso = 0;  aCaracter = "E";     nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac45; |Y nPaso = 0;  aCaracter = "I";     nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac46; |Y nPaso = 0;  aCaracter = "O";     nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac47; |Y nPaso = 0;  aCaracter = "U";     nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac48; |Y nPaso = 0;  aCaracter = " ";     nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac51; |Y nPaso = 0;  aCaracter = &0176;   nPaso = 1;  |FINSI;

           |SI aCaracter = aCarac49;   || Un retorno de carro
               |SI nCampo < nLenMax;
                   aCaracter = "";
               |SINO;
                   nLenMax = nLen;
               |FINSI;
           |FINSI;

           |SI aCaracter = aCarac50;
               |SI nCampo < nLenMax;
                   aCaracter = "";
               |SINO;
                   nLenMax = nLen;
               |FINSI;
           |FINSI;

           aCadena = aCadena + aCaracter;
     |SIGUE;

     eaAlfa = aCadena;

     |HAZ RarosModelos;
|FPRC;

|PROCESO QuitaRarosTfno;
     aCadena = "";
     aLong   = eaAlfa % 0;
     nLong   = aLong;
     |PARA nCampo = 1;  |SI nCampo [ aLong;  |HACIENDO nCampo = nCampo + 1;
           nPos = (100 * nCampo) + 1;
           aCaracter = eaAlfa % nPos;
           |SI aCaracter = "0";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "1";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "2";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "3";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "4";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "5";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "6";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "7";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "8";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "9";  aCadena = aCadena + aCaracter;  |FINSI;
     |SIGUE;
     eaAlfa = aCadena;  |QBT eaAlfa;
     eaAlfa = eaAlfa > eaAlfa;
|FPRC;

|PROCESO FechaBonito;
     aAlfa1 = eaAlfa % 102;
     aAlfa2 = eaAlfa % 402;
     aAlfa3 = eaAlfa % 704;

     |SI aAlfa2 = "01";  aAlfa2 = "ENERO     ";  |FINSI;
     |SI aAlfa2 = "02";  aAlfa2 = "FEBRERO   ";  |FINSI;
     |SI aAlfa2 = "03";  aAlfa2 = "MARZO     ";  |FINSI;
     |SI aAlfa2 = "04";  aAlfa2 = "ABRIL     ";  |FINSI;
     |SI aAlfa2 = "05";  aAlfa2 = "MAYO      ";  |FINSI;
     |SI aAlfa2 = "06";  aAlfa2 = "JUNIO     ";  |FINSI;
     |SI aAlfa2 = "07";  aAlfa2 = "JULIO     ";  |FINSI;
     |SI aAlfa2 = "08";  aAlfa2 = "AGOSTO    ";  |FINSI;
     |SI aAlfa2 = "09";  aAlfa2 = "SEPTIEMBRE";  |FINSI;
     |SI aAlfa2 = "10";  aAlfa2 = "OCTUBRE   ";  |FINSI;
     |SI aAlfa2 = "11";  aAlfa2 = "NOVIEMBRE ";  |FINSI;
     |SI aAlfa2 = "12";  aAlfa2 = "DICIEMBRE ";  |FINSI;

     |QBF aAlfa2;
     eaFechaB = aAlfa1 + " de " + aAlfa2 + " de " + aAlfa3;
     eaDiaB   = aAlfa1;
     eaMesB   = aAlfa2;
     eaAnyoB  = aAlfa3;

|FPRC;

|PROCESO Copiampf;
     |DBASE aModelos;  |QBT aModelos;
     aModelos   = aModelos + "hacienda/";

     aAlfa = enAnyo;
     aAlfa = aAlfa % -102;
     aVersion = "";

     |SI enAnyo ] 2008;
         aVersion = "01";
         |SI enAnyo = 2008;
             |SI enPer ] 2;
                 aVersion = "02";
             |FINSI;
         |FINSI;
     |FINSI;

     |SI aVersion = "";
         aAlfa = "zls" + aAlfa;
     |SINO;
         aAlfa = "z" + aAlfa + aVersion;
     |FINSI;

     eaFOrigen  = aModelos + aAlfa + "mpf.exe";
     |SI eaModelos ! 303;  |Y eaModelos ! 110;
         eaFDestino = "/MODELOS/" + eaModelos + "/" + aAlfa + "mpf.exe";
     |SINO;
         eaFDestino = eaPathModelo + aAlfa + "mpf.exe";
     |FINSI;

     |HAZ CopiaFicheroIP;
|FPRC;

|PROCESO CreaDirectorioAnyo;
     aAlfa = "/MODELOS";                              |RMKDIR aAlfa;
     aAlfa = "/MODELOS/" + eaModelos;                 |RMKDIR aAlfa;
     aAlfa = "/MODELOS/" + eaModelos + "/" + enAnyo;  |RMKDIR aAlfa;
|FPRC;

|PROCESO CopiaFicheroXml;
     aContiene1 = eaFDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = eaFOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     nCopia    = 0;
     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;
     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         |SI aIPRemoto ! "";
             |ENVIA_FICHERO eaFOrigen, eaFDestino;
         |SINO;
             |COPIA_FICHERO eaFOrigen, eaFDestino;
         |FINSI;
         nCopia = 1;
     |FINSI;

     |XABRE "EC", eaFDestino, nHandleEjec;
     |SI FSalida < 0;
         |SI aIPRemoto ! "";
             |ENVIA_FICHERO eaFOrigen, eaFDestino;
         |SINO;
             |COPIA_FICHERO eaFOrigen, eaFDestino;
         |FINSI;
     |FINSI;

     |XABRE "EC", eaFDestino, nHandleEjec;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |SI nCopia = 1;
         |RDESCOMPRIME eaFDestino;

         eaFDestino = (eaFDestino - ".tgz") + ".tar";
         aPathMod   = "/MODELOS/" + eaModelos + "/" + enAnyo + "/";
         |RDETAR eaFDestino, aPathMod;

         |RFBORRA eaFDestino;
     |FINSI;
|FPRC;

|PROCESO TraeWait;
     aPathLocal  = "\MODELOS\" + eaModelos + "\" + enAnyo + "\";

     |DBASE aPathPdf;  |QBT aPathPdf;
     aPathPdf = aPathPdf + "hacienda";                    |MKDIR aPathPdf;
     aOrigen  = aPathPdf   + "/wait.exe";
     aDestino = aPathLocal + "wait.exe";

     aContiene1 = aDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = aOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;
     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;
     |FINSI;

     aOrigen  = aPathPdf   + "/dsprint.exe";
     aDestino = aPathLocal + "dsprint.exe";

     aContiene1 = aDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = aOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;
     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO LeeJava;
     enError = 1;
     |PARA nCaracter = 67;  |SI nCaracter [ 90;  |HACIENDO nCaracter = nCaracter + 1;
           aUnidad = &nCaracter + ":";
           aAbre   = aUnidad + "\Archivos de programa\Java\" + aVersionJava + "\bin\java.exe";
           |XABRE "EC", aAbre, nHandleEjec;
           |SI FSalida ] 0;
               aProgFiles = "Archivos de programa";
               enError = 0;
               |SAL;
           |FINSI;

           aAbre   = aUnidad + "\Program Files\Java\" + aVersionJava + "\bin\java.exe";
           |XABRE "EC", aAbre, nHandleEjec;
           |SI FSalida ] 0;
               aProgFiles = "Program Files";
               enError    = 0;
               |SAL;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO BuscaJava;
     nEjercicio = eaEjer;

     |SI nEjercicio [ 2006;
         aVersionBasico = "111";
         aVersionJava   = "j2re1.4.2_04";
         aEjecutaJava   = "zjava_1_4_2_04.exe";
     |FINSI;

     |SI nEjercicio = 2007;
         aVersionBasico = "221";
         aVersionJava   = "jre1.6.0_03";
         aEjecutaJava   = "zjava_1_6_0_03.exe";
     |FINSI;

     |SI nEjercicio = 2008;
         aVersionBasico = "230";
         aVersionJava   = "jre1.6.0_03";
         aEjecutaJava   = "zjava_1_6_0_03.exe";
     |FINSI;

     |SI nEjercicio = 2009;
         aVersionBasico = "300";
         aVersionJava   = "jre1.6.0_03";
         aEjecutaJava   = "zjava_1_6_0_03.exe";
     |FINSI;

     |SI nEjercicio = 2010;
         aVersionBasico = "310";
         aVersionJava   = "jre1.6.0_03";
         aEjecutaJava   = "zjava_1_6_0_03.exe";
     |FINSI;

     |SI nEjercicio ] 2011;
         aVersionBasico = "320";
         aVersionJava   = "jre1.6.0_03";
         aEjecutaJava   = "zjava_1_6_0_03.exe";
     |FINSI;

     |HAZ LeeJava;
     |SI enError = 1;
         aAlfa = "0000 No tiene instalada la Maquina Virtual para Java Version " + aVersionJava + ". Se va a proceder a instalar";
         |MENAV aAlfa;

         aPathModelo = "\MODELOS\" + eaModelos + "\" + enAnyo + "\";
         aPathLocal  = "\MODELOS\" + eaModelos + "\" + enAnyo + "\";
         |HAZ TraeWait;

         |DBASS aModelos;  |QBT aModelos;
         aModelos = aModelos + "agieos/hacienda";
         eaFOrigen  = aModelos + "/" + aEjecutaJava;
         eaFDestino = aPathModelo +  aEjecutaJava;
         |HAZ CopiaFicheroIP;

         aAbre = aPathModelo + "Ejecuta.bat";
         |XABRE "CBW", aAbre, nHandle1;

         aAlfa = "CD " + aPathModelo + &13 + &10;
         |XGRABA nHandle1, aAlfa;

         aAlfa = "wait " + aEjecutaJava + &13 + &10;
         |XGRABA nHandle1, aAlfa;

         |XCIERRA nHandle1;

         |RSYSTEM aAbre;

         |RFBORRA aAbre;
         |RFBORRA eaFDestino;

         |HAZ LeeJava;
         |SI enError = 1;
              aAlfa = "0000 No tiene instalada la Maquina Virtual para Java Version " + aVersionJava + ". Proceso Interrumpido";
              |MENAV aAlfa;
              |ACABA;
         |FINSI;
     |FINSI;

     aAlfa  = aUnidad + "\" + aProgFiles + "\Java\" + aVersionJava;
     eaDirJava = "SET JAVA_HOME=" + aAlfa;  |QBF eaDirJava;
|FPRC;

|PROCESO QuitaBlanco;
     |ET aCadena;
         |QBF aParaQuitar;
         |SI aParaQuitar ! "";
             aCaracter = aParaQuitar % 101;
             |SI aCaracter = " ";
                 aParaQuitar = aParaQuitar % 240;
                 |VETE aCadena;
             |FINSI;
         |FINSI;
|FPRC;

|PROCESO SeparaNombre;
     || Busca una coma en la aCadena

     eaCadena1 = "";
     eaCadena2 = "";
     eaCadena3 = "";

     nBlanco1 = 0;
     nBlanco2 = 0;
     nComa    = 0;

     |PARA nPara = 1; |SI nPara [ 40; |HACIENDO nPara = nPara + 1;
           nPosi = nPara * 100 + 1;
           aCaracter = eaCadena % nPosi;

           |SI aCaracter = ","; nComa = nPara; |SAL; |FINSI;
     |SIGUE;

     |SI nComa = 0;
         || Si no hay coma busca el primer blanco empezando por detras

         aLongAlfa = eaCadena % 0;
         nLongNume = aLongAlfa;

         |PARA nPara = nLongNume; |SI nPara ] 1; |HACIENDO nPara = nPara - 1;
               nPosi = nPara * 100 + 1;
               aCaracter = eaCadena % nPosi;
               |SI aCaracter = " "; nComa = nPara; |SAL; |FINSI;
         |SIGUE;
     |FINSI;

     || Coge los dos primeros aCaracteres del segundo apellido

     nBlanco1  = nComa - 1;
     nPosi     = nBlanco1 + 100;
     eaCadena2  = eaCadena % nPosi;
     aLongAlfa = eaCadena2 % 0;
     nLongNume = aLongAlfa;

     |PARA nPara = nLongNume; |SI nPara ] 1; |HACIENDO nPara = nPara - 1;
           nPosi = nPara * 100 + 1;
           aCaracter = eaCadena2 % nPosi;
           |SI aCaracter = " "; nBlanco1 = nPara; |SAL; |FINSI;
     |SIGUE;

     nBlanco1 = nBlanco1 + 1;
     nPosi    = nBlanco1 * 100 + nLongNume;
     eaCadena2 = eaCadena2 % nPosi;

     || Coge las dos primeros caracteres del primer apellido

     nBlanco1 = nBlanco1 - 1;
     nPosi    = 100 + nBlanco1;
     eaCadena1 = eaCadena % nPosi;

     || Recoge los dos primero aCaracteres de Nombre

     nPosi    = ((nComa + 1) * 100) + 40;
     eaCadena3 = eaCadena % nPosi;

     aParaQuitar = eaCadena1; |HAZ QuitaBlanco; eaCadena1 = aParaQuitar;
     aParaQuitar = eaCadena2; |HAZ QuitaBlanco; eaCadena2 = aParaQuitar;
     aParaQuitar = eaCadena3; |HAZ QuitaBlanco; eaCadena3 = aParaQuitar;

     |QBF eaCadena1;
     |QBF eaCadena2;
     |QBF eaCadena3;
|FPRC;

|PROCESO ExtraePath;
     eaPathAcrobat = version1;
     aLongitud     = eaPathAcrobat % 0;
     nLongitud     = aLongitud;
     |PARA nPos = 1; |SI nPos [ nLongitud; |HACIENDO nPos = nPos + 1;
          nCaracter = (nPos * 100) + 1;
          aCaracter = eaPathAcrobat % nCaracter;
          |SI aCaracter = ",";
               nPos          = nLongitud - nPos;
               nPos          = nPos + 100;
               nPos          = (-1) * nPos;
               eaPathAcrobat = eaPathAcrobat % nPos;
               |SAL;
          |FINSI;
     |SIGUE;

     eaPathAcrobat = eaPathAcrobat - "[";
     eaPathAcrobat = eaPathAcrobat - "]";
|FPRC;

|PROCESO CompruebaRuta;
     enError = 0;
     |QBF eaPathAcrobat;
     |XABRE "CE", eaPathAcrobat, nCanal;
     |SI eaPathAcrobat = ""; |O FSalida < 0;
          |XCIERRA nCanal;
          aAlfa = "    No se ha encontrado el directorio donde esta instalado ";
          aAlfa = aAlfa + "Adobe Acrobat Reader. ";
          |MENAV aAlfa;
          aAlfa = "    Debera instalarselo.";
          |MENAV aAlfa;

          enError = 1;
     |FINSI;
|FPRC;

|PROCESO LocalizaAcrobat;
     |IP_REMOTO aIPRemoto; |QBF aIPRemoto;

     |ABRE #dsmom108;
     #dsmom108#0 = aIPRemoto;
     |LEE 000#dsmom108.=;
     |SI FSalida ! 0;  |DDEFECTO #dsmom108;  |FINSI;
     |CIERRA #dsmom108;

     eaPathAcrobat = #dsmom108#1;  |QBF eaPathAcrobat;

     enError  = 0;

     |SI eaPathAcrobat ! "";  |ACABA;  |FINSI;

     version1 = "AcroExch.Document";
     |ESPECIFICA "VERSION_PROGRAMA",version;
     |HAZ ExtraePath;
     |SI eaPathAcrobat = "NO LOCALIZADO";
          version1 = "AcroExch.App";
          |ESPECIFICA "VERSION_PROGRAMA",version;
          |HAZ ExtraePath;
     |FINSI;

     |SI eaPathAcrobat ! "NO LOCALIZADO";
          |HAZ CompruebaRuta;
          |SI enError = 1;          || todo ok
               |ACABA;              || hay Acrobat pero no lo encuentra
          |FINSI;
     |SINO;
          enError = 1;
     |FINSI;

     |SI enError = 0;
         |ABRE #dsmom108;
         #dsmom108#0 = aIPRemoto;
         |LEE 101#dsmom108.=;
         |SI FSalida ! 0;
             |DDEFECTO #dsmom108;
             #dsmom108#0 = aIPRemoto;
             |GRABA 020#dsmom108.b;
         |FINSI;
         #dsmom108#1 = eaPathAcrobat;
         |GRABA 020#dsmom108.a;
         |LIBERA #dsmom108;
         |CIERRA #dsmom108;
    |FINSI;
|FPRC;

|RUTINA ClaveBaja952;
     #dsmow052#0 = "            ";
|FRUT;

|RUTINA ClaveAlta952;
     #dsmow052#0 = "zzzzzzzzzzzz";
|FRUT;

|PROCESO Tipo11w052;  |TIPO 11;
     |SI FSalida = 10;
         |SI eaPeriodo = "";
             aAlfa = "START \MODELOS\" + eaModelos + "\" + enAnyo + "\" + #dsmow052#0;
         |SINO;
             aAlfa = "START \MODELOS\" + eaModelos + "\" + enAnyo + "\" + eaPeriodo + "\" + #dsmow052#0;
         |FINSI;

         |RSYSTEM aAlfa;
     |FINSI;

     |SI FSalida = 11;
          aAlfa = eaFichDatos % 0;
          nNume = aAlfa;
          |SI nNume > 3;
              aFichero = eaFichDatos;
          |SINO;
              aFichero = eaFichDatos + (#dsmow052#0 % 0412);
          |FINSI;

         |SI eaPeriodo = "";
             aAlfa = "START \MODELOS\" + eaModelos + "\" + enAnyo + "\" + aFichero;
         |SINO;
             aAlfa = "START \MODELOS\" + eaModelos + "\" + enAnyo + "\" + eaPeriodo + "\" + aFichero;
         |FINSI;

         |RSYSTEM aAlfa;
     |FINSI;
|FPRC;

|PROCESO dsmow052;
     aFichero = eaFichDatos + (#dsmow052#0 % 0412);
     aAlfa    = "\MODELOS\" + eaModelos + "\" + enAnyo + "\" + aFichero;
     |RFBORRA aAlfa;
|FPRC;

|DEFBUCLE dsmow052;
     #dsmow052#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dsmow052;
|FIN;

|PROCESO BuscaErroresXml;
     aFichero = ("52" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #dsmow052#aFichero#;
     |ABRE #dsmow052;  |CIERRA #dsmow052;  |DELINDEX #dsmow052;

     |ABRE #dsmow052;
     |ABRE #eosclien;

     enError     = 0;
     nHePasado   = 0;
     aDirSesion  = "/MODELOS/" + eaModelos + "/" + enAnyo + "/";
     aFichero    = aDirSesion + eaFichError + "*.xml";  |QBT aFichero;

     |R_PDIR aFichero;
     |PARA; |SI; |HACIENDO;
            |SI FSalida ! 0; |SAL; |FINSI;

            aError = aFichero - aDirSesion;
            aAlfa  = aError % 405;
            #eosclien#0 = aAlfa;
            |LEE 040#eosclien.=;
            |SI FSalida = 0;
                nHePasado  = 1;
                #dsmow052#0     = aError;
                #dsmow052#1     = #eosclien#0;
                #dsmow052#2     = #eosclien#2;
                |GRABA 040#dsmow052.n;
                |LIBERA #dsmow052;
            |FINSI;
            |R_SDIR aFichero;
     |SIGUE;
     |CIERRA #dsmow052;
     |CIERRA #eosclien;

     |SI nHePasado = 0;  |ACABA;  |FINSI;

     |PUSHV 0501 2380;
     enError = 1;
     |ENTLINEAL #1#dsmow052, -1, 4, 22, 1, ClaveBaja952, ClaveAlta952;
     |POPV;

     |BUCLE dsmow052;

     |DELINDEX #dsmow052;
|FPRC;

|PROCESO ErroresValidacion;
     |ABRE #eosclien;

     enError     = 0;
     |SI eaPeriodo = "";
         aDirSesion  = "/MODELOS/" + eaModelos + "/" + enAnyo + "/";
         aPathSesion = "\MODELOS\" + eaModelos + "\" + enAnyo + "\";
     |FINSI;

     |SI eaPeriodo ! "";
         aDirSesion  = "/MODELOS/" + eaModelos + "/" + enAnyo + "/" + eaPeriodo + "/";
         aPathSesion = "\MODELOS\" + eaModelos + "\" + enAnyo + "\" + eaPeriodo + "\";
         aFichero    = aDirSesion + eaFichError + "*.txt";  |QBT aFichero;
     |FINSI;

     aPathInter  = aPathSesion + "AInternet"; |RMKDIR aPathInter;
     aPathInter  = aPathInter + "\";

     aAlfa = aDirSesion + "imprime.bat";
     |RFBORRA aAlfa;

     aFichero    = aPathInter + eaFichDatos + "*.bue";  |QBT aFichero;
     |R_PDIR aFichero;
     |PARA; |SI; |HACIENDO;
            |SI FSalida ! 0; |SAL; |FINSI;

            |RFBORRA aFichero;

            |R_SDIR aFichero;
     |SIGUE;

     aFichero    = aDirSesion + eaFichDatos + "*.txt";  |QBT aFichero;
     enBuenos    = 0;
     enMalos     = 0;

     |R_PDIR aFichero;
     |PARA; |SI; |HACIENDO;
            |SI FSalida ! 0; |SAL; |FINSI;

            aError = aFichero - aDirSesion;
            aAlfa  = aError % 405;
            #eosclien#0 = aAlfa;
            |LEE 040#eosclien.=;
            |SI FSalida = 0;
                aAlfa = aDirSesion + eaFichError + ((aFichero - aDirSesion) % 0405) + ".txt";
                |XABRE "EC", aAlfa, nHandError;
                |SI FSalida < 0;
                    enBuenos = enBuenos + 1;
                    aOrigen  = aFichero;
                    aDestino = aPathInter + eaFichDatos + ((aFichero - aDirSesion) % 0405) + ".bue";
                    |RCOPIA_FICHERO aOrigen, aDestino;

                    |RFBORRA aOrigen;

                    aAlfa = aDirSesion + eaFichError + ((aFichero - aDirSesion) % 0405) + ".RST";
                    |RFBORRA aAlfa;

                    |SI eaFichAuxil ! "";
                        aAlfa = aDirSesion + eaFichAuxil + ((aFichero - aDirSesion) % 0405) + ".txt";
                        |RFBORRA aAlfa;
                    |FINSI;
                |SINO;
                    enMalos = enMalos + 1;
                |FINSI;
            |FINSI;
            |R_SDIR aFichero;
     |SIGUE;
     |CIERRA #eosclien;

     |SI enMalos = 0;  |ACABA;  |FINSI;

     aFichero = ("52" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #dsmow052#aFichero#;
     |ABRE #dsmow052;  |CIERRA #dsmow052;  |DELINDEX #dsmow052;

     |ABRE #dsmow052;
     |ABRE #eosclien;

     aFichero    = aDirSesion + eaFichError + "*.txt";  |QBT aFichero;
     nHePasado   = 0;

     |R_PDIR aFichero;
     |PARA; |SI; |HACIENDO;
            |SI FSalida ! 0; |SAL; |FINSI;

            aError = aFichero - aDirSesion;
            aAlfa  = aError % 405;
            #eosclien#0   = aAlfa;
            |LEE 040#eosclien.=;
            |SI FSalida = 0;
                nHePasado  = 1;
                #dsmow052#0     = aError;
                #dsmow052#1     = #eosclien#0;
                #dsmow052#2     = #eosclien#2;
                |GRABA 040#dsmow052.n;
                |LIBERA #dsmow052;
            |FINSI;
            |R_SDIR aFichero;
     |SIGUE;
     |CIERRA #dsmow052;
     |CIERRA #eosclien;

     |SI nHePasado = 0;
         |DELINDEX #dsmow052;
         |ACABA;
     |FINSI;

     |PUSHV 0501 2380;
     enError = 1;
     |ENTLINEAL #1#dsmow052, -1, 4, 22, 1, ClaveBaja952, ClaveAlta952;
     |POPV;

     |ABRE #dsmow052;
     |ABRE #eosclien;

     aFichero    = aDirSesion + eaFichDatos + "*.txt";  |QBT aFichero;
     |R_PDIR aFichero;
     |PARA; |SI; |HACIENDO;
            |SI FSalida ! 0; |SAL; |FINSI;

            aError = eaFichError + ((aFichero - aDirSesion) % 0412);
            aAlfa  = aError;
            #dsmow052#0 = aAlfa;
            |LEE 040#dsmow052.=;
            |SI FSalida ! 0;
                aAlfa = aDirSesion + eaFichDatos + ((aFichero - aDirSesion) % 0412);
                |RFBORRA aAlfa;

                aAlfa = aDirSesion + eaFichError + ((aFichero - aDirSesion) % 0405) + ".RST";
                |RFBORRA aAlfa;

                |SI eaFichAuxil ! "";
                    aAlfa = aDirSesion + eaFichAuxil + ((aFichero - aDirSesion) % 0412);
                    |RFBORRA aAlfa;
                |FINSI;
            |SINO;
                aAlfa = ((aFichero - aDirSesion) % 0405);
                #eosclien#0 = aAlfa;
                |LEE 040#eosclien.=;
                |SI FSalida = 0;
                    aAlfa = aDirSesion + eaFichDatos + ((aFichero - aDirSesion) % 0412);
                    |RFBORRA aAlfa;

                    aAlfa = aDirSesion + eaFichError + ((aFichero - aDirSesion) % 0405) + ".TXT";
                    |RFBORRA aAlfa;

                    |SI eaFichAuxil ! "";
                        aAlfa = aDirSesion + eaFichAuxil + ((aFichero - aDirSesion) % 0412);
                        |RFBORRA aAlfa;
                    |FINSI;
                |FINSI;
            |FINSI;
            |R_SDIR aFichero;
     |SIGUE;
     |CIERRA #dsmow052;
     |CIERRA #eosclien;

     |DELINDEX #dsmow052;

     aAlfa = aDirSesion + "imprime.bat";
     |RFBORRA aAlfa;
|FPRC;

|PROCESO BuscaErroresL;
     |SI enValidacion = 1;
         |HAZ ErroresValidacion;
         |ACABA;
     |FINSI;

     aFichero = ("52" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #dsmow052#aFichero#;
     |ABRE #dsmow052;  |CIERRA #dsmow052;  |DELINDEX #dsmow052;

     |ABRE #dsmow052;
     |ABRE #eosclien;

     enError     = 0;
     nHePasado   = 0;

     |SI eaPeriodo = "";
         aDirSesion  = "/MODELOS/" + eaModelos + "/" + enAnyo + "/";
         aPathSesion = "\MODELOS\" + eaModelos + "\" + enAnyo + "\";
     |FINSI;

     |SI eaPeriodo ! "";
         aDirSesion  = "/MODELOS/" + eaModelos + "/" + enAnyo + "/" + eaPeriodo + "/";
         aPathSesion = "\MODELOS\" + eaModelos + "\" + enAnyo + "\" + eaPeriodo + "\";
     |FINSI;

     aFichero = aDirSesion + eaFichError + "*.txt";  |QBT aFichero;
     aAlfa = aDirSesion + "imprime.bat";
     |RFBORRA aAlfa;

     |R_PDIR aFichero;
     |PARA; |SI; |HACIENDO;
            |SI FSalida ! 0; |SAL; |FINSI;

            aError = aFichero - aDirSesion;
            aAlfa  = aError % 405;
            #eosclien#0 = aAlfa;
            |LEE 040#eosclien.=;
            |SI FSalida = 0;
                nHePasado  = 1;
                #dsmow052#0     = aError;
                #dsmow052#1     = #eosclien#0;
                #dsmow052#2     = #eosclien#2;
                |GRABA 040#dsmow052.n;
                |LIBERA #dsmow052;
            |FINSI;
            |R_SDIR aFichero;
     |SIGUE;
     |CIERRA #dsmow052;
     |CIERRA #eosclien;

     |SI nHePasado = 0;
         aFichero    = aDirSesion + "*.*";  |QBT aFichero;
         |R_PDIR aFichero;
         |PARA; |SI; |HACIENDO;
                |SI FSalida ! 0; |SAL; |FINSI;

                 aExt = (aFichero % -103) < "";
                 aFich = aFichero % -1003;
                 aFich1 = aFichero % -904;
                 aFich2 = aFichero % -704;
                 |SI aExt ! "rst";  |Y aExt ! "exe";
                     |SI enInternet = 0;
                         |RFBORRA aFichero;
                     |SINO;
                         |SI aFich ! "opa"; |Y aFich1 ! "rtpa";
                          |Y aFich2 ! "ce20";
                             |RFBORRA aFichero;
                         |FINSI;
                     |FINSI;
                 |FINSI;
                 |R_SDIR aFichero;
         |SIGUE;

         |DELINDEX #dsmow052;

         |ACABA;
     |FINSI;

     |PUSHV 0501 2380;
     enError = 1;
     |ENTLINEAL #1#dsmow052, -1, 4, 22, 1, ClaveBaja952, ClaveAlta952;
     |POPV;

     |ABRE #dsmow052;
     |ABRE #eosclien;
     aFichero    = aDirSesion + eaFichDatos + "*.txt";  |QBT aFichero;

     |R_PDIR aFichero;
     |PARA; |SI; |HACIENDO;
            |SI FSalida ! 0; |SAL; |FINSI;

            aError = eaFichError + ((aFichero - aDirSesion) % 0412);
            aAlfa  = aError;
            #dsmow052#0 = aAlfa;
            |LEE 040#dsmow052.=;
            |SI FSalida ! 0;
                aAlfa = aDirSesion + eaFichDatos + ((aFichero - aDirSesion) % 0412);
                |RFBORRA aAlfa;

                aAlfa = aDirSesion + eaFichError + ((aFichero - aDirSesion) % 0405) + ".RST";
                |RFBORRA aAlfa;

                |SI eaFichAuxil ! "";
                    aAlfa = aDirSesion + eaFichAuxil + ((aFichero - aDirSesion) % 0412);
                    |RFBORRA aAlfa;
                |FINSI;
            |SINO;
                aAlfa  = ((aFichero - aDirSesion) % 0405);
                #eosclien#0 = aAlfa;
                |LEE 040#eosclien.=;
                |SI FSalida = 0;
                    aAlfa = aDirSesion + eaFichDatos + ((aFichero - aDirSesion) % 0412);
                    |RFBORRA aAlfa;

                    aAlfa = aDirSesion + eaFichError + ((aFichero - aDirSesion) % 0405) + ".TXT";
                    |RFBORRA aAlfa;

                    |SI eaFichAuxil ! "";
                        aAlfa = aDirSesion + eaFichAuxil + ((aFichero - aDirSesion) % 0412);
                        |RFBORRA aAlfa;
                    |FINSI;
                |FINSI;
            |FINSI;
            |R_SDIR aFichero;
     |SIGUE;
     |CIERRA #dsmow052;
     |CIERRA #eosclien;

     aAlfa = aDirSesion + "imprime.bat";
     |RFBORRA aAlfa;
|FPRC;

|PROCESO TraeBasico;
||     aPathLocal = "C:\MODELOS";                                |RMKDIR aPathLocal;
||     aPathLocal = "C:\MODELOS\JAVA";                           |RMKDIR aPathLocal;
||     aPathLocal = "C:\MODELOS\JAVA\VERSION" + aVersionBasico;  |RMKDIR aPathLocal;
||     aPathLocal = "C:\MODELOS\JAVA\VERSION" + aVersionBasico + "\";

     aPathLocal = "\MODELOS";                                |RMKDIR aPathLocal;
     aPathLocal = "\MODELOS\JAVA";                           |RMKDIR aPathLocal;
     aPathLocal = "\MODELOS\JAVA\VERSION" + aVersionBasico;  |RMKDIR aPathLocal;
     aPathLocal = "\MODELOS\JAVA\VERSION" + aVersionBasico + "\";

     |DBASE aPathServidor;   |QBF aPathServidor;
     aPathServidor = aPathServidor + "hacienda/";

     aOrigen    = aPathServidor + "mivinf" + aVersionBasico + ".tgz";
     aDestino   = aPathLocal + "mivinf" + aVersionBasico + ".tgz";

     aContiene1 = aDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = aOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     nCopia    = 0;
     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;
     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;
         nCopia = 1;
     |FINSI;

     enBasico = 0;
     |XABRE "EC", aDestino, nHandleEjec;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |SI nCopia = 1;
         |RDESCOMPRIME aDestino;

         aDestino = (aDestino - ".tgz") + ".tar";
         |RDETAR aDestino, aPathLocal;

         |RFBORRA aDestino;
     |FINSI;

     enBasico = 1;
|FPRC;

|PROCESO TraeModelo;
     |SI enBasico = 0;  |ACABA;  |FINSI;

     aAlfa   = eaEjer;
     aAlfa   = aAlfa % -102;

     aOrigen    = aPathServidor + "zls" + aAlfa + eaModelos + ".tgz";
     aDestino   = aPathLocal    + "zls" + aAlfa + eaModelos + ".tgz";

     aContiene1 = aDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = aOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     nCopia    = 0;
     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;
     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;
         nCopia = 1;
     |FINSI;

     |XABRE "EC", aDestino, nHandleEjec;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |SI nCopia = 1;
         |RDESCOMPRIME aDestino;

         aDestino = (aDestino - ".tgz") + ".tar";
         |RDETAR aDestino, aPathLocal;

         |RFBORRA aDestino;
     |FINSI;
|FPRC;

|PROCESO PresentaJava;
     aPathLocal = "\MODELOS\" + eaModelos + "\" + eaEjer + "\";

     aAbre = aPathLocal + eaTipoP;
     |XABRE "EC", aAbre, nHandle1;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |HAZ LocalizaAcrobat;
     |SI enError ! 0;  |ACABA;  |FINSI;

     |HAZ TraeWait;

     aAbre = aPathLocal + "imprime.bat";
     |XABRE "CBW", aAbre, nHandle1;

     aAlfa = "CD \" + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "CD " + aPathLocal + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     |SI eaModoImpre = "I";
         aAlfa = "wait dsprint " + eaTipoP + &13 + &10;
         |XGRABA nHandle1, aAlfa;
     |FINSI;

     |SI eaModoImpre = "P";
         aAlfa = "wait " + eaPathAcrobat + " " + eaTipoP + &13 + &10;
         |XGRABA nHandle1, aAlfa;
     |FINSI;

     |XCIERRA nHandle1;

     |RSYSTEM aAbre;

     |RFBORRA aAbre;
|FPRC;

|PROCESO LineaShellJava;
     enBasico   = 0;

     |HAZ BuscaJava;
     |SI enError = 1;  |ACABA;  |FINSI;

     aAbre = "\MODELOS\" + eaModelos + "\" + eaEjer + "\imprime.bat";
     |XABRE "CBW", aAbre, enHandle;

     aAlfa = "CD \" + &13 + &10;                 |XGRABA enHandle, aAlfa;
     aAlfa = "CD MODELOS" + &13 + &10;           |XGRABA enHandle, aAlfa;
     aAlfa = "CD JAVA" + &13 + &10;              |XGRABA enHandle, aAlfa;
     aAlfa = "CD VERSION" + aVersionBasico + &13 + &10;        |XGRABA enHandle, aAlfa;

     |SI eaTipoR ! "";
         aAlfa = "DEL \MODELOS\" + eaModelos + "\" + eaEjer + "\" + eaTipoR + &13 + &10;
         |XGRABA enHandle, aAlfa;
     |FINSI;

     |SI eaTipoP ! "";
         aAlfa = "DEL \MODELOS\" + eaModelos + "\" + eaEjer + "\" + eaTipoP + &13 + &10;
         |XGRABA enHandle, aAlfa;
     |FINSI;

     aAlfa = eaDirJava + &13 + &10;
     |XGRABA enHandle, aAlfa;

||     aAlfa = &34 + "%JAVA_HOME%\bin\java" + &34 + " -jar C:\MODELOS\JAVA\VERSION" + aVersionBasico + "\plataformamodulosinformativas.jar ";
     aAlfa = &34 + "%JAVA_HOME%\bin\java" + &34 + " -jar \MODELOS\JAVA\VERSION" + aVersionBasico + "\plataformamodulosinformativas.jar ";

     |SI eaTipoV ! "S";
         aAlfa = aAlfa + "/E:\MODELOS\" + eaModelos + "\" + eaEjer + "\" + eaTipoE + " ";
         aAlfa = aAlfa + "/R:\MODELOS\" + eaModelos + "\" + eaEjer + "\" + eaTipoR + " ";
         aAlfa = aAlfa + "/P:\MODELOS\" + eaModelos + "\" + eaEjer + "\" + eaTipoP + " ";
         aAlfa = aAlfa + "/C:" + eaTipoC + " ";
         aAlfa = aAlfa + "/A:\MODELOS\" + eaModelos + "\" + eaEjer + "\" + eaTipoA + " ";
     |SINO;
         aAlfa = aAlfa + "/E:\MODELOS\" + eaModelos + "\" + eaEjer + "\" + eaTipoE + " ";
         aAlfa = aAlfa + "/V:S ";
         aAlfa = aAlfa + "/R:\MODELOS\" + eaModelos + "\" + eaEjer + "\" + eaTipoR + " ";
     |FINSI;
     aAlfa = aAlfa + &13 + &10;
     |XGRABA enHandle, aAlfa;

     |XCIERRA enHandle;

     |HAZ TraeBasico;
     |HAZ TraeModelo;

     |SI enBasico = 0;  |ACABA;  |FINSI;

     aAlfa = "\MODELOS\" + eaModelos + "\" + eaEjer + "\imprime.bat";
     |RSYSTEM aAlfa;

     |SI eaTipoV ! "S";
         |HAZ PresentaJava;
     |FINSI;
|FPRC;

|PROCESO Acrobat;
     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |ABRE #dsmom108;
     #dsmom108#0 = aIPRemoto;
     |LEE 101#dsmom108.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmom108;
         #dsmom108#0 = aIPRemoto;
         |GRABA 020#dsmom108.b;
     |FINSI;

     eaPathAcrobat = #dsmom108#1;  |QBF eaPathAcrobat;
     |SI eaPathAcrobat = "";
         eaPathAcrobat = "AcroRd32.exe";
     |FINSI;

     eaPathAcrobat = "F" + eaPathAcrobat;
     |BROWSE eaPathAcrobat;
     eaPathAcrobat = eaPathAcrobat % 290;  |QBF eaPathAcrobat;

     |SI eaPathAcrobat ! "";
         #dsmom108#1 = eaPathAcrobat;
     |FINSI;

     |GRABA 020#dsmom108.a;
     |LIBERA #dsmom108;
     |CIERRA #dsmom108;
|FPRC;

|PROCESO Explorador;
     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |ABRE #dsmom108;
     #dsmom108#0 = aIPRemoto;
     |LEE 101#dsmom108.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmom108;
         #dsmom108#0 = aIPRemoto;
         |GRABA 020#dsmom108.b;
     |FINSI;

     eaPathExplorador = #dsmom108#2;  |QBF eaPathExplorador;

     |SI eaPathExplorador = "";  |O eaForzExplorador = "S";
         |MENAV "0000Busque y pinche en el explorador con el que quiera trabajar";

         eaPathExplorador = "F" + eaPathExplorador;
         |BROWSE eaPathExplorador;
         eaPathExplorador = eaPathExplorador % 290;  |QBF eaPathExplorador;
     |FINSI;

     |SI eaPathExplorador ! "";
         #dsmom108#2 = eaPathExplorador;
     |FINSI;

     |GRABA 020#dsmom108.a;
     |LIBERA #dsmom108;
     |CIERRA #dsmom108;
|FPRC;

|PROCESO ConvierteBarra;
     |QBF eaAlfa;
     aLong  = eaAlfa % 0;
     nLong  = aLong;
     aCadena = "";

     |PARA nCaracter = 1;  |SI nCaracter [ nLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPos      = (nCaracter * 100) + 1;
           aCaracter = eaAlfa % nPos;

           |SI aCaracter = "/";
               aCaracter = "\";
           |FINSI;

           aCadena = aCadena + aCaracter;
      |SIGUE;

      eaAlfa = aCadena;
|FPRC;

|PROCESO EnviaFicheroMD5;
   aIPRemoto = ""; |IP_REMOTO aIPRemoto;

   aContiene1 = eaFOrigen;
   |ESPECIFICA "MD5", aContiene;
   aDocServidor = FSalida;  |QBF aDocServidor;

   aContiene1 = eaFDestino;
   |SI aIPRemoto ! "";
      |ESPECIFICA "REMOTOMD5", aContiene;
   |SINO;
      |ESPECIFICA "MD5", aContiene;
   |FINSI;
   aDocRemoto = FSalida;  |QBF aDocRemoto;

   |SI aDocRemoto ! aDocServidor;
      |SI aIPRemoto ! "";
         |ENVIA_FICHERO eaFOrigen, eaFDestino;
      |SINO;
         |COPIA_FICHERO eaFOrigen, eaFDestino;
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO GrabaImpreso;
     |SI enInternet ! 0;
         aAlfa = aDirSesion + "AUXILIAR.TXT";
         |RFBORRA aAlfa;

         aAlfa = aDirSesion + "jus" + (("00000" + #dsmow014#0) % -105) + ".xml";
         |RFBORRA aAlfa;

         aAlfa = aDirSesion + eaFichError + #dsmoy000#6 + ".RST";
         |RFBORRA aAlfa;

         aAlfa = aDirSesion + eaFichError + (("00000" + #dsmow014#0) % -105) + ".RST";
         |RFBORRA aAlfa;
     |FINSI;

     aJusti  = "";

     |SI enInternet = 0;
         aAbre   = aDirSesion + "jus" + (("00000" + #dsmow014#0) % -105) + ".xml";
         |XABRE "C", aAbre, nHandleEjec;
         |SI FSalida ] 0;
             |PARA;  |SI FSalida ] 0;  |HACIENDO;
                  |XLEE nHandleEjec, 250, aAlfa;

                  aAlfa = aAlfa - "<Justif>";
                  |SI FSalida ! 0;
                      aAlfa  = aAlfa - "</Justif>";  |QBT aAlfa;
                      aAlfa  = aAlfa - "<RST>";      |QBT aAlfa;
                      aAlfa  = aAlfa - "</RST>";     |QBT aAlfa;
                      aJusti = aAlfa % -113;
                      |SAL;
                  |FINSI;
              |SIGUE;
         |FINSI;
         |XCIERRA nHandleEjec;

         |RFBORRA aAbre;

         |SI aJusti = "";
             aAbre   = aDirSesion + eaFichError + (("00000" + #dsmow014#0) % -105) + ".RST";
             |XABRE "C", aAbre, nHandleEjec;
             |SI FSalida ] 0;
                 |XLEE nHandleEjec, 250, aJusti;
             |FINSI;
             |XCIERRA nHandleEjec;

             |RFBORRA aAbre;
         |FINSI;
     |FINSI;

     |ABRE #dsmom004;
     #dsmom004#0  = #dsmow014#0;
     #dsmom004#1  = #dsmow014#1;
     #dsmom004#2  = #dsmow014#2;
     #dsmom004#3  = #dsmow014#5;
     #dsmom004#4  = #dsmow014#7;
     |LEE 101#dsmom004.=;
     |SI FSalida = 0;
         #dsmom004#9  = "X";
         #dsmom004#10 = #dsmoy000#7;

         |QBF aJusti;
         aAlfa = aJusti % 0;
         nNume = aAlfa;

         |SI nNume [ 13;
             #dsmom004#25 = aJusti;
         |SINO;
             #dsmom004#19 = aJusti;
         |FINSI;

         |GRABA 020#dsmom004.a;
         |LIBERA #dsmom004;
     |FINSI;
     |CIERRA #dsmom004;
|FPRC;

|PROCESO QuitaRaritos;
     |QBF eaAlfa;
     aCadena = "";
     aLong   = eaAlfa % 0;
     nLong   = aLong;
     |PARA nCampo = 1;  |SI nCampo [ aLong;  |HACIENDO nCampo = nCampo + 1;
           nPos = (100 * nCampo) + 1;
           aCaracter = eaAlfa % nPos;
           |SI aCaracter = ".";  aCaracter = "";   |FINSI;
           |SI aCaracter = ",";  aCaracter = "";   |FINSI;
           |SI aCaracter = "•";  aCaracter = &209; |FINSI;
           |SI aCaracter = "§";  aCaracter = &209; |FINSI;
           |SI aCaracter = "ß";  aCaracter = &176; |FINSI;
           |SI aCaracter = "¶";  aCaracter = &170; |FINSI;
           aCadena = aCadena + aCaracter;
     |SIGUE;
     eaAlfa = aCadena;

     eaAlfa = eaAlfa > eaAlfa;
|FPRC;

|PROCESO PintaUbicacion;
     |PUSHV 0501 2380;
     |BLANCO 0501 2380;
     |PINTA 1002, eaAlfa1;
     |ATRI P;
     |PINTA 1102, eaAlfa2;
     |ATRI p;
     |PAUSA;
     |POPV;
|FPRC;

|PROCESO CalcJustificante;
     fFecha1 = ~;
     fFecha2 = "01.01.2000";

     |HORA aHora;

     aAlfa = aHora % 102;  nHora = aAlfa;
     aAlfa = aHora % 402;  nMinu = aAlfa;
     aAlfa = aHora % 702;  nSegu = aAlfa;

     nSeg  = (nHora * 3600) + (nMinu * 60) + nSegu;
     nDias = fFecha1 - fFecha2;

     aSeg  = ("00000" + nSeg) % -105;
     aDia  = ("00000" + nDias) % -105;

     eaJusti = #dsmoy000#0;
     eaJusti = eaJusti + (aSeg % 101);
     eaJusti = eaJusti + (aDia % 101);
     eaJusti = eaJusti + (aSeg % 201);
     eaJusti = eaJusti + (aDia % 201);
     eaJusti = eaJusti + (aSeg % 301);
     eaJusti = eaJusti + (aDia % 301);
     eaJusti = eaJusti + (aSeg % 401);
     eaJusti = eaJusti + (aDia % 401);
     eaJusti = eaJusti + (aSeg % 501);
     eaJusti = eaJusti + (aDia % 501);
|FPRC;
