|FICHEROS;
     eosec349 #0;
     eos349ca #1;
     eos349li #5;
     eosclien #2;
     eospant2 #3;
     eoshacie #4;
     eoscomul #6;
|FIN;

|VARIABLES;
     nSwEjer  = 0;
     tipo1    = "";
     LLeno40  = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     Vacio40  = "                                        ";
     y        = 0;
     x        = 0;
     informe  = "";
     d_empre  = 0;
     h_empre  = 0;
     contador = 0;
     resto    = 0;
     pp       = 0;
     tipo     = "";
     hojas    = 0;
     periodo  = 0;
     sw_fisica = 0;
     vacio_20  = "                    ";
     Salir     = 0;
     Opcion    = 0;

     &numhoja = 0;
     &dia     = "";
     &mes     = "";
     &anyo    = "";
     &tipo_p  = "";
     &nombrep = "";
     &enEjercicio = 0;
     &eaLaClau  = "";
     &enEjR     = 0;
     &eaPeR     = "";

 {-1} MGeneral   = "";
      MGeneral1  = "1435";
      MGeneral2  = "1";
      MGeneral3  = "7";
      MGeneral4  = "Emision Portada                       ";
      MGeneral5  = "Emision Entregas                      ";
      MGeneral6  = "Emision Adquisiciones                 ";
      MGeneral7  = "Emision Rectificaciones Entregas      ";
      MGeneral8  = "Emision Rectificaciones Adquisiciones ";
      MGeneral9  = "--------------------------------------";
      MGeneral10 = "Emision Papel en Blanco               ";

 {-1} MG02eral   = "";
      MG02eral1  = "1435";
      MG02eral2  = "1";
      MG02eral3  = "3";  || .. 5
      MG02eral4  = "Emision Portada                       ";
      MG02eral5  = "Emision Entregas y Adquisiciones      ";
      MG02eral6  = "Emision Rectificaciones               ";
/*
     MG02eral7  = "--------------------------------------";
      MG02eral8  = "Emision Papel en Blanco               ";
*/
|FIN;

|INCLUYE i_cuadre;
|INCLUYE i_anyode;
|INCLUYE i_consul;

|PROCESO Mayus; |TIPO 0;
  #0Campo = #0Campo > #0Campo;
  |PINTA #0Campo;
|FPRC;

|PROCESO pinta_anyo; |TIPO 7;
  |HAZ i_anyodef;
  #0#25 = i_anyodef;
  |PINTA #0#25;
|FPRC;

|PROCESO seleccion;
  |SI #0#3 = "S";
      |PARA x = 4; |SI x [ 24; |HACIENDO x = x + 1;
            |C_M #0x, 1, "N";
            #0x = 0;
            |PINTA #0x;
      |SIGUE;
      |C_M #0#00, 1, "S";
      |C_M #0#01, 1, "S";
      |C_M #0#29, 1, "S";
  |SINO;
      #0#0  = 00001; |PINTA #0#0;  |C_M #0#00, 1, "N";
      #0#1  = 99999; |PINTA #0#1;  |C_M #0#01, 1, "N";
      #0#29 = "C";   |PINTA #0#29; |C_M #0#29, 1, "N";

      |PARA x = 4; |SI x [ 24; |HACIENDO x = x + 1;
            |C_M #0x, 1, "S";
      |SIGUE;
  |FINSI;
|FPRC;
||*******************************************************************
|PROCESO cuantia;
  contador = contador + 1;
|FPRC;

|PROCESO impre_lin;
  hojas = contador / 20;
  resto = contador $ 20;
  |SI resto ! 0; hojas = (hojas + 0.5) ! 0; |FINSI;

  numhoja = hojas;
  |PRINT;
|FPRC;

|PROCESO impre_port;
  tipo_p = "T";
  |SI periodo = 0; tipo_p = "A"; |FINSI;

  |HAZ Representante;

  #2#0 = #1#0;
  |LEE 040#2=;
  |SI FSalida ! 0; |DDEFECTO #2; |FINSI;

  #4#0 = #2#18;
  #4#1 = #2#19;
  |LEE 040#4=;
  |SI FSalida ! 0; |DDEFECTO #4; |FINSI;

  #0#30 = #1#6;
  #0#31 = #1#8;
  #0#32 = #1#10 + #1#11;
  #0#33 = #1#7;
  #0#34 = #1#9;
  #0#35 = 0;
  #0#36 = 0;
  #0#37 = #1#0;
  #0#38 = "X";
  #0#39 = "";
  #0#40 = "";
  #0#41 = "";
  #0#42 = "";
  #0#44 = #1#14 + #1#15;

  |PRINT;
  |PIEINF;

  |SI Opcion ! 7;
      #1#4 = #0#2;
      |GRABA 140#1a;
      |LIBERA #1;
  |FINSI;
|FPRC;

|DEFBUCLE eos349li_1;
  #5#1;
  4;
  #1#0, #1#2, #1#1, 000, tipo;
  #1#0, #1#2, #1#1, 999, tipo;
  ;
  NULL, cuantia;
|FIN;

|DEFBUCLE eos349li_2;
  #5#1;
  4;
  #1#0, #1#2, #1#1, 000, tipo;
  #1#0, #1#2, #1#1, 999, tipo;
  e;
  NULL, impre_lin;
|FIN;

|PROCESO mira_lin;
  tipo_p = "T";
  |SI periodo = 0; tipo_p = "A"; |FINSI;

  #2#0 = #1#0;
  |LEE 040#2=;
  |SI FSalida ! 0; |DDEFECTO #2; |FINSI;

  contador = 0;

  |BUCLE eos349li_1;
  |SI contador ! 0; |BUCLE eos349li_2; |PIEINF; |FINSI;
|FPRC;

|DEFBUCLE eos349caPC;
  #1#1;
  5;
  d_empre, #0#25, periodo, "N";
  h_empre, #0#25, periodo, "N";
  be;
  NULL, impre_port;
|FIN;

|DEFBUCLE eos349caPN;
  #1#2;
  5;
  Vacio40, d_empre, #0#25, periodo, "N";
  LLeno40, h_empre, #0#25, periodo, "N";
  be;
  NULL, impre_port;
|FIN;

|DEFBUCLE eos349caLC;
  #1#1;
  5;
  d_empre, #0#25, periodo, "N";
  h_empre, #0#25, periodo, "N";
  e;
  NULL, mira_lin;
|FIN;

|DEFBUCLE eos349caLN;
  #1#2;
  5;
  Vacio40, d_empre, #0#25, periodo, "N";
  LLeno40, h_empre, #0#25, periodo, "N";
  e;
  NULL, mira_lin;
|FIN;

|PROCESO Portada;
  |SI nSwEjer = 0;
    |SI Opcion = 1;
        |INFOR "eospo349";
        |SI FSalida ! 0; |ACABA; |FINSI;
        |HAZ i_cuadre;
    |SINO;
        |INFOR "eospb349";
        |SI FSalida ! 0; |ACABA; |FINSI;
    |FINSI;
  |SINO;
      |SI Opcion = 1;
          |INFOR "eo2po349";
          |SI FSalida ! 0; |ACABA; |FINSI;
          |HAZ i_cuadre;
      |SINO;
          |INFOR "eo2pb349";
          |SI FSalida ! 0; |ACABA; |FINSI;
      |FINSI;
  |FINSI;

  |SI #0#29 = "C";
      periodo = #0#26; |BUCLE eos349caPC;
      |SI #0#26 = 4;
          periodo = 0; |BUCLE eos349caPC;
      |FINSI;
  |SINO;
      periodo = #0#26; |BUCLE eos349caPN;
      |SI #0#26 = 4;
          periodo = 0; |BUCLE eos349caPN;
      |FINSI;
  |FINSI;
  |FININF;
|FPRC;

|PROCESO Representante;
  #2#0 = #1#0;
  |LEE 040#2=;
  |SI FSalida ! 0; |DDEFECTO #2; |FINSI;

  nombrep   = "";
  sw_fisica = 0;

  #6#0 = #2#0;
  #6#1 = 1;
  #6#2 = 1;
  #6#7 = #0#25;
  |LEE 040#6];
  |SI FSalida = 0; |Y #6#0 = #2#0; |Y #6#7 = #0#25;
      #2#0 = #6#3;
      |LEE 040#2=;
      |SI FSalida = 0; sw_fisica = 1; nombrep = #2#2; |FINSI;
  |FINSI;

  |SI sw_fisica = 1; |ACABA; |FINSI;

  #2#0 = #1#0;
  |LEE 040#2=;
  |SI FSalida ! 0; |DDEFECTO #2; |FINSI;

  nombrep = #2#2;

  |SI #2#24 ! vacio_20; |O #2#25 ! vacio_20;
       nombrep = #2#24 + #2#25;
       |ACABA;
  |FINSI;
  |SI #2#29 ! vacio_20; |O #2#30 ! vacio_20;
       nombrep = #2#29 + #2#30;
       |ACABA;
  |FINSI;
  |SI #2#34 ! vacio_20; |O #2#35 ! vacio_20;
       nombrep = #2#34 + #2#35;
       |ACABA;
  |FINSI;
|FPRC;

|PROCESO lineas;
  |SI Opcion ! 7;
      |SI tipo = "E"; informe = "eosh1349"; |FINSI;
      |SI tipo = "A"; informe = "eosh2349"; |FINSI;
      |SI tipo = "R"; informe = "eosh3349"; |FINSI;
      |SI tipo = "X"; informe = "eosh4349"; |FINSI;

      |INFOR informe;
      |SI FSalida ! 0; |ACABA; |FINSI;
      |HAZ i_cuadre;
  |SINO;
      |SI tipo = "E"; informe = "eosb1349"; |FINSI;
      |SI tipo = "A"; informe = "eosb2349"; |FINSI;
      |SI tipo = "R"; informe = "eosb3349"; |FINSI;
      |SI tipo = "X"; informe = "eosb4349"; |FINSI;

      |INFOR informe;
      |SI FSalida ! 0; |ACABA; |FINSI;
  |FINSI;

  |SI #0#29 = "C";
      periodo = #0#26; |BUCLE eos349caLC;
      |SI #0#26 = 4;
          periodo = 0; |BUCLE eos349caLC;
      |FINSI;
  |SINO;
      periodo = #0#26; |BUCLE eos349caLN;
      |SI #0#26 = 4;
          periodo = 0; |BUCLE eos349caLN;
      |FINSI;
  |FINSI;
  |FININF;
|FPRC;

|PROCESO Distribuye;
  |SI #0#3 = "N";
      |PARA x = 4; |SI x [ 24; |HACIENDO x = x + 1;
            |SI #0x ! 0;
                d_empre  = #0x;
                h_empre  = #0x;
                |SI Opcion = 1;             |HAZ Portada; |FINSI;
                |SI Opcion = 2; tipo = "E"; |HAZ lineas;  |FINSI;
                |SI Opcion = 3; tipo = "A"; |HAZ lineas;  |FINSI;
                |SI Opcion = 4; tipo = "R"; |HAZ lineas;  |FINSI;
                |SI Opcion = 5; tipo = "X"; |HAZ lineas;  |FINSI;
                |SI Opcion = 7;
                    |HAZ Portada;
                    tipo = "E"; |HAZ lineas;
                    tipo = "A"; |HAZ lineas;
                    tipo = "R"; |HAZ lineas;
                    tipo = "X"; |HAZ lineas;
                |FINSI;
            |FINSI;
     |SIGUE;
  |SINO;
      d_empre = #0#0;
      h_empre = #0#1;

      |SI Opcion = 1;               |HAZ Portada;  |FINSI;
      |SI Opcion = 2;  tipo = "E";  |HAZ lineas;   |FINSI;
      |SI Opcion = 3;  tipo = "A";  |HAZ lineas;   |FINSI;
      |SI Opcion = 4;  tipo = "R";  |HAZ lineas;   |FINSI;
      |SI Opcion = 5;  tipo = "X";  |HAZ lineas;   |FINSI;
      |SI Opcion = 7;
          |HAZ Portada;
          tipo = "E"; |HAZ lineas;
          tipo = "A"; |HAZ lineas;
          tipo = "R"; |HAZ lineas;
          tipo = "X"; |HAZ lineas;
      |FINSI;
  |FINSI;
|FPRC;

|PROCESO impre; |TIPO 3;
  |HAZ fechapre;

  enEjercicio = 2000 + #0#25;
  |SI #0#25 ] 80;
      enEjercicio = 1900 + #0#25;
  |FINSI;
  |SI #0#25 [ 1; |O #0#25 ] 90; nSwEjer = 0; |FINSI;
  |SI #0#25 > 1; |Y #0#25 < 90; nSwEjer = 1; |FINSI;

  |SI nSwEjer = 0;
        |ABRE #2;
        |ABRE #4;
        |ABRE #6;
        |PARA; |SI Salir = 0; |HACIENDO;
               |MENUG MGeneral;
               MGeneral2 = FSalida;
               Opcion    = MGeneral2;
               Salir     = 1;
               |SI Opcion ] 1; |Y Opcion [ 7;
                   Salir = 0;
                   |SI Opcion ! 6;
                       |IMPRE 0;
                       |SI FSalida = 0;
                           |HAZ Distribuye;
                           |FINIMP;
                       |FINSI;
                   |FINSI;
               |FINSI;
        |SIGUE;
        |CIERRA #2;
        |CIERRA #4;
        |CIERRA #6;
        |FINIMP;
  |SINO;
        |ABRE #2;
        |ABRE #4;
        |ABRE #6;
        |PARA; |SI Salir = 0; |HACIENDO;
               |MENUG MG02eral;
               MG02eral2 = FSalida;
               Opcion    = MG02eral2;
               Salir     = 1;
               |SI Opcion ] 1; |Y Opcion [ 5;
                   Salir = 0;
                   |SI Opcion ! 4;
                       |IMPRE 0;
                       |SI FSalida = 0;
                           |HAZ Distribuye_02;
                           |FINIMP;
                       |FINSI;
                   |FINSI;
               |FINSI;
        |SIGUE;
        |CIERRA #2;
        |CIERRA #4;
        |CIERRA #6;
        |FINIMP;
  |FINSI;
|FPRC;

|PROCESO fechapre;
  dia  = #0#2 % 102;
  anyo = #0#2 % -102;
  mes  = #0#2 % 402;
  |SI mes = "01"; mes = "Enero     "; |FINSI;
  |SI mes = "02"; mes = "Febrero   "; |FINSI;
  |SI mes = "03"; mes = "Marzo     "; |FINSI;
  |SI mes = "04"; mes = "Abril     "; |FINSI;
  |SI mes = "05"; mes = "Mayo      "; |FINSI;
  |SI mes = "06"; mes = "Junio     "; |FINSI;
  |SI mes = "07"; mes = "Julio     "; |FINSI;
  |SI mes = "08"; mes = "Agosto    "; |FINSI;
  |SI mes = "09"; mes = "Septiembre"; |FINSI;
  |SI mes = "10"; mes = "Octubre   "; |FINSI;
  |SI mes = "11"; mes = "Noviembre "; |FINSI;
  |SI mes = "12"; mes = "Diciembre "; |FINSI;
  mes = mes > mes;
|FPRC;

|| Procesos para el 2002
|PROCESO cuantia_02;
  contador = contador + 1;
|FPRC;

|PROCESO impre_lin_02;
  |SI tipo = "A";
      hojas = contador / 15;
      resto = contador $ 15;
      |SI resto ! 0; hojas = (hojas + 0.5) ! 0; |FINSI;
      eaLaClau  = "A";
      |SI #5#4  = "E";  eaLaClau = "E";  |FINSI;
      |SI #5#13 = "X";  eaLaClau = "T";  |FINSI;
  |SINO;
      hojas = contador / 10;
      resto = contador $ 10;
      |SI resto ! 0; hojas = (hojas + 0.5) ! 0; |FINSI;
      eaLaClau   = "A";
      enEjR = #5#11;
      |SI enEjR < 80;
          enEjR = 2000 + enEjR;
      |SINO;
          enEjR = 1900 + enEjR;
      |FINSI;
      |SI #5#12 = 0; eaPeR = "0 A";|FINSI;
      |SI #5#12 = 1; eaPeR = "1 T";|FINSI;
      |SI #5#12 = 2; eaPeR = "2 T";|FINSI;
      |SI #5#12 = 3; eaPeR = "3 T";|FINSI;
      |SI #5#12 = 4; eaPeR = "4 T";|FINSI;
      |SI #5#4  = "R";  eaLaClau = "E";  |FINSI;
      |SI #5#13 = "X";  eaLaClau = "T";  |FINSI;
  |FINSI;
  numhoja = hojas;
  |PRINT;
|FPRC;

|DEFBUCLE eos349li_1_02;
  #5#1;
  4;
  #1#0, #1#2, #1#1, 000, tipo;
  #1#0, #1#2, #1#1, 999, tipo1;
  ;
  NULL, cuantia_02;
|FIN;

|DEFBUCLE eos349li_2_02;
  #5#1;
  4;
  #1#0, #1#2, #1#1, 000, tipo;
  #1#0, #1#2, #1#1, 999, tipo1;
  e;
  NULL, impre_lin_02;
|FIN;

|PROCESO mira_lin_02;
  tipo_p = "T";
  |SI periodo = 0; tipo_p = "A"; |FINSI;

  #2#0 = #1#0;
  |LEE 040#2=;
  |SI FSalida ! 0; |DDEFECTO #2; |FINSI;

  contador = 0;

  |BUCLE eos349li_1_02;
  |SI contador ! 0; |BUCLE eos349li_2_02; |PIEINF; |FINSI;
|FPRC;

|DEFBUCLE eos349caLC_02;
  #1#1;
  5;
  d_empre, #0#25, periodo, "N";
  h_empre, #0#25, periodo, "N";
  e;
  NULL, mira_lin_02;
|FIN;

|DEFBUCLE eos349caLN_02;
  #1#2;
  5;
  Vacio40, d_empre, #0#25, periodo, "N";
  LLeno40, h_empre, #0#25, periodo, "N";
  e;
  NULL, mira_lin_02;
|FIN;


|PROCESO lineas_02;
  |SI Opcion ! 5;
      |SI tipo = "A"; informe = "eo2h1349"; |FINSI;
      |SI tipo = "R"; informe = "eo2h2349"; |FINSI;

      |INFOR informe;
      |SI FSalida ! 0; |ACABA; |FINSI;
      |HAZ i_cuadre;
  |SINO;
      |SI tipo = "A"; informe = "eo2b1349"; |FINSI;
      |SI tipo = "R"; informe = "eo2b2349"; |FINSI;

      |INFOR informe;
      |SI FSalida ! 0; |ACABA; |FINSI;
  |FINSI;

  |SI #0#29 = "C";
      periodo = #0#26; |BUCLE eos349caLC_02;
      |SI #0#26 = 4;
          periodo = 0; |BUCLE eos349caLC_02;
      |FINSI;
  |SINO;
      periodo = #0#26; |BUCLE eos349caLN_02;
      |SI #0#26 = 4;
          periodo = 0; |BUCLE eos349caLN_02;
      |FINSI;
  |FINSI;
  |FININF;
|FPRC;

|PROCESO Distribuye_02;
  |SI #0#3 = "N";
      |PARA x = 4; |SI x [ 24; |HACIENDO x = x + 1;
            |SI #0x ! 0;
                d_empre  = #0x;
                h_empre  = #0x;
                |SI Opcion = 1;             |HAZ Portada; |FINSI;
                |SI Opcion = 2; tipo = "A"; tipo1 = "E"; |HAZ lineas_02;  |FINSI;
                |SI Opcion = 3; tipo = "R"; tipo1 = "X"; |HAZ lineas_02;  |FINSI;
                |SI Opcion = 5;
                    |HAZ Portada;
                    tipo = "A"; tipo1 = "E"; |HAZ lineas_02;
                    tipo = "R"; tipo1 = "X"; |HAZ lineas_02;
                |FINSI;
            |FINSI;
     |SIGUE;
  |SINO;
      d_empre = #0#0;
      h_empre = #0#1;

      |SI Opcion = 1;               |HAZ Portada;  |FINSI;
      |SI Opcion = 2;  tipo = "A";  tipo1 = "E"; |HAZ lineas_02;   |FINSI;
      |SI Opcion = 3;  tipo = "R";  tipo1 = "X"; |HAZ lineas_02;   |FINSI;
      |SI Opcion = 5;
          |HAZ Portada;
          tipo = "A"; tipo1 = "E"; |HAZ lineas_02;
          tipo = "R"; tipo1 = "X"; |HAZ lineas_02;
      |FINSI;
  |FINSI;
|FPRC;
