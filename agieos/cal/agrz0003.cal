|FICHEROS;
   agrz0003 #10;
   agrm0007 #7;
|FIN;

|VARIABLES;
   CodEmp    = "";
   CodAny    = "";
   Datos      = "";
   Contiene  = "";
   Handle     = "";
   Directorio = "";
   Fichero    = "";
   Final      = "";
|FIN;

|PROCESO GrabaVentas;
CodEmp = #7#0;
CodEmp = ("00000" + CodEmp) % -105;

CodAny = #7#1;
CodAny = ("00" + CodAny) % -102;

Datos   = "z" + CodEmp + CodAny;

Contiene = Handle + " " + Datos + Final;
|FGRABA Contiene;

Contiene = Handle + " Ventas  : " + CodEmp + "  " + CodAny + Final;
|FGRABA Contiene;

Contiene = Handle + "  " + Final;
|FGRABA Contiene;

Contiene = Handle + " 20" + Final;
|FGRABA Contiene;

Contiene = Handle + " 1" + Final;
|FGRABA Contiene;
|FPRC;

|PROCESO GrabaCompras;
CodEmp = #7#0;
CodEmp = ("00000" + CodEmp) % -105;

CodAny = #7#1;
CodAny = ("00" + CodAny) % -102;

Datos   = "y" + CodEmp + CodAny;

Contiene = Handle + " " + Datos + Final;
|FGRABA Contiene;

Contiene = Handle + " Compras : " + CodEmp + "  " + CodAny + Final;
|FGRABA Contiene;

Contiene = Handle + "  " + Final;
|FGRABA Contiene;

Contiene = Handle + " 20" + Final;
|FGRABA Contiene;

Contiene = Handle + " 1" + Final;
|FGRABA Contiene;
|FPRC;

|DEFBUCLE agrm0007V;
#7#1;
;
#10#0, #10#2;
#10#1, #10#3;
e;
NULL, GrabaVentas;
|FIN;

|DEFBUCLE agrm0007C;
#7#1;
;
#10#0, #10#2;
#10#1, #10#3;
e;
NULL, GrabaCompras;
|FIN;

|PROCESO Tipo3; |TIPO 3;
Final = "";
|DFICE Directorio;
Fichero = "wt  " + Directorio + "agisubl.dir";
|QBF Fichero;

|FABRE Fichero;
Handle = FSalida;

Contiene = Handle + " agrm0013" + Final;
|FGRABA Contiene;

Contiene = Handle + " Lineas Libros" + Final;
|FGRABA Contiene;

Contiene = Handle + " " + Final;
|FGRABA Contiene;

Contiene = Handle + " 20" + Final;
|FGRABA Contiene;

Contiene = Handle + " 1" + Final;
|FGRABA Contiene;

|SI FSalida ] 0;
    |SI #10#4 = "V"; |BUCLE agrm0007V; |FINSI;
    |SI #10#4 = "C"; |BUCLE agrm0007C; |FINSI;
    |SI #10#4 = "D"; |BUCLE agrm0007V; |FINSI;
    |SI #10#4 = "D"; |BUCLE agrm0007C; |FINSI;
|FINSI;

Contiene = Handle + " agrm0013" + Final;
|FGRABA Contiene;

Contiene = Handle + " Lineas Libros" + Final;
|FGRABA Contiene;

Contiene = Handle + " " + Final;
|FGRABA Contiene;

Contiene = Handle + " 20" + Final;
|FGRABA Contiene;

Contiene = Handle + " 1" + Final;
|FGRABA Contiene;

FSalida = Handle;
|FCIERRA FSalida;
|FPRC;
