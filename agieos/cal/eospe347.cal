|FICHEROS;
     eospe347 #0;
     eosm0009 #1;
     eospanta #2;
     eosclien #3;
|FIN;

|VARIABLES;
     fLaFecha  = @;
     aAlfa1    = "";
     nNume1    = 0;
     Linea     = 0;
     Sw        = 0;
     Opcion    = 0;

     {-1}Menu  = "";
         Menu1 = "2425";
         Menu2 = "1";
         Menu3 = "Opciones : ";
         Menu4 = "PI";
         Menu5 = " Pantalla  ";
         Menu6 = " Impresora ";
|FIN;

|INCLUYE i_consul;

|CALCULO Eano; |TIPO 7;
 fLaFecha = ~;
 aAlfa1   = fLaFecha;
 aAlfa1 = aAlfa1 % -102;
 nNume1 = aAlfa1;
 nNume1 = nNume1 - 1;
 #0#2 = nNume1; |PINTA #0#2;
|FCAL;

|PROCESO Pantalla;
  #2#0 = #1#0;
  #2#1 = #3#2;
  #2#3 = #1#1;
  Pos  = Linea;
  |PINDA #0#2;
  Linea  = Linea + 100;
  Pos  = -1;
  |SI Linea > 1300;
      Linea = 100;
      |PAUSA;
      |PINDA #0#2;
  |FINSI;
|FPRC;

|PROCESO Impresora;
  |PRINT;
|FPRC;

|PROCESO Eleccion;
  |SI #1#2 = "01.01.0000"; |Y #1#3 ! "S";
      #3#0 = #1#0;
      |LEE 040#3=;
      |SI FSalida ! 0; |DDEFECTO #3; |FINSI;

      Sw = 1;
      |SI Opcion = 1; |HAZ Pantalla;   |FINSI;
      |SI Opcion = 2; |HAZ Impresora;  |FINSI;
  |FINSI;
|FPRC;

|DEFBUCLE eosm0009;
  #1#1;
  ;
  #0#0, #0#2;
  #0#1, #0#2;
  ;
  NULL, Eleccion;
|FIN;

|PROCESO impre;|TIPO 3;
  |C_V #2#2, 1, "N";
  |C_V #2#4, 1, "N";

  Sw = 0;
  |MENU Menu;
  Opcion = FSalida;
  |SI Opcion < 1; |ACABA; |FINSI;

  |ABRE #3;
  |SI Opcion = 1;
      |PINPA #0#2;
      Linea = 100;
      |BUCLE eosm0009;
      |SI Sw = 1;  |PAUSA;  |FINSI;
      |CIERRA #2;
  |SINO;
      |IMPRE 0;
      |SI FSalida ! 0;  |ACABA;  |FINSI;

      |INFOR "eospe347";
      |SI FSalida ! 0;  |ACABA;  |FINSI;

      |BUCLE eosm0009;
      |SI Sw = 1;  |PIEINF;  |FINSI;

      |FININF;
      |FINIMP;
  |FINSI;
  |ABRE #3;
|FPRC;
