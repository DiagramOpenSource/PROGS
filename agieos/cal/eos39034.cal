|FICHEROS;
   eosm2390 #0;
   eosactiv #1;
|FIN;

|VARIABLES;
   &empresa = 0;
   &anyo    = 0;
   &modo    = 0;
   &nombre  = "";
   &fecha   = "";
   &archi   = "";

   tecla    = "";
   ntecla   = 0;
   FEstado  = 0;
   avance   = "815";
   atras    = "814";
   campo1   = 0;
   campo2   = 0;
|FIN;

|PROGRAMA;
|ABRE #0;
|PINPA #0#0;
|SI modo = 1; |O modo = 2; |HAZ pidedato; |FINSI;
|SI modo = 4; |HAZ consulta; |FINSI;
|CIERRA #0;
|FPRO;

|PROCESO pidedato;
#0#0 = empresa;
#0#1 = anyo;
|LIBERA #0;
|LEE 140#0=;
FEstado = FSalida;
|SI FEstado ! 0; |DDEFECTO #0; #0#0 = empresa; #0#1 = anyo; |FINSI;
|PINDA #0#0;
|SI modo = 1; |ENDATOS #1#0;  |FINSI;
|SI modo = 2; |ENDATOS #2#0;  |FINSI;
|SI FSalida = 0;
    |SI FEstado = 0; |GRABA 140#0a; |SINO; |GRABA 140#0n; |FINSI;
    |LIBERA #0;
|FINSI;
|FPRC;

|PROCESO consulta;
avance = &255 + avance;
atras = &255 + atras;
#0#0 = empresa;
#0#1 = anyo;
|LEE 040#0=;
|SI FSalida = 0;
   |HAZ pantalla1;
|FINSI;
|FPRC;

|PROCESO pantalla1;
|PINPA #0#0;
|PINDA #0#0;
|MENSA "0411  Av.Pag. = Siguiente Pantalla   Re.Pag. = Pantalla anterior";
|LEETECLA tecla;
|SI tecla = avance; |HAZ pantalla2; |FINSI;
|FPRC;

|PROCESO pantalla2;
|PINPA #1#0;
|PINDA #1#0;
|MENSA "0411  Av.Pag. = Siguiente Pantalla   Re.Pag. = Pantalla anterior";
|LEETECLA tecla;
|SI tecla = atras; |HAZ pantalla1; |FINSI;
|FPRC;

|PROCESO actividad; |TIPO 0;
campo2 = Campo;
campo1 = campo2 - 1;

|SI #0campo1 = " "; |Y #0campo2 = "    "; |ACABA; |FINSI;

|ABRE #1;
|SELECT #2#1;
#1#0 = #0#0;
#1#4 = #0campo1;
#1#5 = #0campo2;
#1#2 = #0#1;
|LEE 040#1=;
|SI FSalida ! 0;
    |MENAV "      No existe esta actividad en la empresa";
|FINSI;
|CIERRA #1;
|FPRC;

|PROCESO totales; |TIPO 0;
campo1 = Campo;
#0#165 = #0#109 + #0#120 + #0#131 + #0#142 + #0#153 + #0#164;
#0#167 = #0#165 - #0#166;
#0#169 = #0#165 + #0#98 + #0#168 + #0#77;
#0#173 = #0#169 - #0#172;
|PINTA #0#165;
|PINTA #0#167;
|PINTA #0#169;
Campo = campo1;
|FPRC;
