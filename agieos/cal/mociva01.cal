|FICHEROS;
     dsmociva;
     dsmom008;
|FIN;

|VARIABLES;
     nPer1   = 0;
     nPer2   = 0;
     swerror = 0;
     fDFecha = @;
     fHFecha = @;
     nCampo68      = 0;
     nCampo        = 0;
     nCampo1       = 0;
     nCampo2       = 0;
     nCampo3       = 0;
     nCampo11      = 0;
     nCampo22      = 0;
     nCampo33      = 0;
     nValor1       = 0;
     nValor2       = 0;
     nGrupo        = 0;
     nSubGrupo     = 0;
     nPeriodoMin   = 0;
     nEjerAnt      = 0;
     nSwAcum       = 0;
     nDesde        = 0;
     nHasta        = 0;
     nContador     = 0;
     nResult       = 0;
     nSwGraba      = 0;
     nAnyo         = 0;
     nPer          = 0;
     nTipo         = 0;
     nPeriodo      = 0;
     nDepar        = 0;
     nEjer         = 0;
     nModBucle     = 0;
     nPorCalculado = 0;
     nPon          = 0;
     nEl62         = 0;
     nHComple      = 0;
     nModAnter     = 0;
     nTotal303     = 0;
     nDPer349      = 0;
     nHPer349      = 0;
     nNegativo     = 0;
     nNegativoC    = 0;
     nNegativoD    = 0;
     nIVA          = 0;
     nCuotasAnterior = 0;
     nIVA7           = 0;
     nIVA10          = 0;
     nIVA13          = 0;
     nIVA16          = 0;
     nIVA19          = 0;
     nIVA22          = 0;
     nIVA25          = 0;
     nIVA28          = 0;
     nIVA31          = 0;
     nSubeIVA        = 0;

     aAlfa           = "";
     aAlfa1          = "";
     aTecla          = "";
     aBase           = "";
     aMas            = "";
     aDesConexion349 = "";
     aParametro      = "";

     &EURODB     = 0;
     &enPregunta = 0;

    nSwOpe29     = 0;
    aPerNom      = "";
    nCuotaMas    = 0;
    nBaseMas     = 0;
    nDPer        = 0;
    nHPer        = 0;

    nNume1 = 0;
    nNume2 = 0;
    swpase = 0;
    nPro   = 0;
    nAlgun = 0;
    nInkey = 0;
    nEntro = 0;

    &enEmpAmor  = 0;
    &enEjeAmor  = 0;
    &enDActAmor = 0;
    &enHActAmor = 0;
    &enImpRegul = 0;
    &enModoAmor = 0;

    aModo       = "";
    &enProAct   = 0;
    &enProCom   = 0;
    nComun      = 0;
    nSwHay      = 0;
    nEjerCarga  = 0;
    &eMensa     = 0;
    nSuma       = 0;
    nDImporte   = 0;
    nHImporte   = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO GrabaMayor2014;
     |ABRE #dsmom008;
     #dsmom008#0 = enEmpresa;
     #dsmom008#1 = enEjer;
     #dsmom008#2 = enPeriodo;
     #dsmom008#3 = enModelo;
     #dsmom008#4 = enComplem;
     #dsmom008#5 = 0;
     |LEE 101#dsmom008.=;
     |SI FSalida = 0;
         #dsmom008#11 = "SIN DATOS ";
         |GRABA 020#dsmom008.a;
     |FINSI;
     |LIBERA #dsmom008;
     |CIERRA #dsmom008;

     nSwGraba = 0;

     enImpIvaSop   = 0;
     enIvaSopDed   = 0;
     enImpIvaSub   = 0;
     nTipo         = enTipoEntrada;
     enTipoEntrada = 98;

     aParametro = ("00000" + enEmpresa) % -105;
     aParametro = aParametro + ("0000" + enEjer) % -104;
     aParametro = aParametro + ("00" + enPeriodo) % -102;
     aParametro = aParametro + ("000" + enModelo) % -103;
     aParametro = aParametro + ("00" + enComplem) % -102;
     aParametro = aParametro + ("00" + enActividad) % -102;
     aParametro = aParametro + ("00" + enTipoEntrada) % -102;
     aParametro = aParametro + ("0" + enExistencia) % -101;

     aAlfa = "dsm30301;" + aParametro;
     |SUB_EJECUTA_NP aAlfa;
     enTipoEntrada = nTipo;
     nSwGraba      = enExistencia;

     |SI nSwGraba = 1;
         |ABRE #dsmom008;
         #dsmom008#0 = enEmpresa;
         #dsmom008#1 = enEjer;
         #dsmom008#2 = enPeriodo;
         #dsmom008#3 = enModelo;
         #dsmom008#4 = enComplem;
         #dsmom008#5 = 0;
         |LEE 101#dsmom008.=;
         |SI FSalida = 0;
             #dsmom008#11 = "EXISTENTE";
             |GRABA 020#dsmom008.a;
         |FINSI;
         |LIBERA #dsmom008;
         |CIERRA #dsmom008;
     |FINSI;
|FPRC;

|PROCESO Registro0;
     |HAZ GrabaMayor2014;
|FPRC;
