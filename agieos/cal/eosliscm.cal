|FICHEROS;
   eosliscm #0;
   eoscomun #1;
   eoscomul #2;
   eosactiv #3;
|FIN;

|VARIABLES;
 sw      = 0;
 empresa = 0;
 informe = "eosliscm";
 &swlin  = 0;
|FIN;

|INCLUYE i_consul;
|INCLUYE i_anyode;

|PROCESO pinta_anyo; |TIPO 7;
|HAZ i_anyodef;
#0#2 = i_anyodef;
|PINTA #0#2;
|FPRC;

|CALCULO chequeo;
|SI sw = 0; empresa = #2#3; |FINSI;

#3#0 = #2#3;
#3#1 = #2#5;
#3#2 = #2#7;
|LEE 040#3=;
|SI FSalida ! 0; |DDEFECTO #3; |FINSI;

#1#0 = #2#0;
#1#1 = #2#1;
#1#3 = #2#7;
|LEE 040#1=;
|SI FSalida ! 0; |DDEFECTO #1; |FINSI;

|SI empresa ! #2#3;
   swlin = 2; |PRINT;
   swlin = 0; |PRINT;
   empresa = #2#3;
|FINSI;

|SI sw = 0;
   sw = 1;
   swlin = 0; |PRINT;
|FINSI;

swlin = 1; |PRINT;
|FCAL;

|DEFBUCLE eosliscm0;
#2#2;
;
#0#0, 1, #0#2;
#0#1, 6, #0#2;
e;
NULL,chequeo;
|FIN;

|CALCULO impre; |TIPO 3;
sw = 0;
|IMPRE 0;
|SI FSalida = 0;
    |INFOR informe;
    |SI FSalida = 0;
       |ABRE #1;
       |ABRE #3;
       |BUCLE eosliscm0;
       |SI sw = 1;
           swlin = 2; |PRINT;
           |PIEINF;
       |FINSI;
       |FININF;
       |CIERRA #1;
       |CIERRA #3;
    |SINO;
       |MENAV "     No existe Informe";
    |FINSI;
    |FINIMP;
|SINO;
   |MENAV "      Impresion Cancelada";
|FINSI;
|FCAL;
