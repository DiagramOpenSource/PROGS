|FICHEROS;
   eosducom #0;
   eoscomun #1;
   eoscomul #2;
   eoszcomu #3;
   eosclien #4;

   eosactiv #10;
|FIN;

|VARIABLES;
   x       = 0;
   y       = 0;
   d_empre = 0;
   h_empre = 0;

   aAlfa1  = "";
   nNume1  = 0;
   fFecha1 = @;
   nCampo  = 0;
|FIN;

|INCLUYE i_consul;
|INCLUYE i_anyode;

|PROCESO pinta_anyo; |TIPO 7;
 |HAZ i_anyodef;
 #0#29 = i_anyodef - 1;
 |SI #0#29 < 0;  #0#29 = 99;  |FINSI;
 #0#30 = i_anyodef;
 |PINTA #0#29;
 |PINTA #0#30;
|FPRC;

|PROCESO modifica; |TIPO 0;
 |CAMPO_MODIFICA #0#01, 1, "S";  |CAMPO_MODIFICA #0#02, 1, "S";
 |CAMPO_MODIFICA #0#03, 1, "S";  |CAMPO_MODIFICA #0#04, 1, "S";
 |CAMPO_MODIFICA #0#05, 1, "S";  |CAMPO_MODIFICA #0#06, 1, "S";
 |CAMPO_MODIFICA #0#07, 1, "S";  |CAMPO_MODIFICA #0#08, 1, "S";
 |CAMPO_MODIFICA #0#09, 1, "S";  |CAMPO_MODIFICA #0#10, 1, "S";
 |CAMPO_MODIFICA #0#11, 1, "S";  |CAMPO_MODIFICA #0#12, 1, "S";
 |CAMPO_MODIFICA #0#13, 1, "S";  |CAMPO_MODIFICA #0#14, 1, "S";
 |CAMPO_MODIFICA #0#15, 1, "S";  |CAMPO_MODIFICA #0#16, 1, "S";
 |CAMPO_MODIFICA #0#17, 1, "S";  |CAMPO_MODIFICA #0#18, 1, "S";
 |CAMPO_MODIFICA #0#19, 1, "S";  |CAMPO_MODIFICA #0#20, 1, "S";
 |CAMPO_MODIFICA #0#21, 1, "S";  |CAMPO_MODIFICA #0#22, 1, "S";
 |CAMPO_MODIFICA #0#23, 1, "S";  |CAMPO_MODIFICA #0#24, 1, "S";
 |CAMPO_MODIFICA #0#25, 1, "S";  |CAMPO_MODIFICA #0#26, 1, "S";
|SI #0#0 = "S";
    |CAMPO_MODIFICA #0#1, 1, "N";
    |CAMPO_MODIFICA #0#2, 1, "N";
    #0#1 = 1;       |PINTA #0#1;
    #0#2 = 99999;   |PINTA #0#2;
|SINO;
    |CAMPO_MODIFICA #0#03, 1, "N";  |CAMPO_MODIFICA #0#04, 1, "N";
    |CAMPO_MODIFICA #0#05, 1, "N";  |CAMPO_MODIFICA #0#06, 1, "N";
    |CAMPO_MODIFICA #0#07, 1, "N";  |CAMPO_MODIFICA #0#08, 1, "N";
    |CAMPO_MODIFICA #0#09, 1, "N";  |CAMPO_MODIFICA #0#10, 1, "N";
    |CAMPO_MODIFICA #0#11, 1, "N";  |CAMPO_MODIFICA #0#12, 1, "N";
    |CAMPO_MODIFICA #0#13, 1, "N";  |CAMPO_MODIFICA #0#14, 1, "N";
    |CAMPO_MODIFICA #0#15, 1, "N";  |CAMPO_MODIFICA #0#16, 1, "N";
    |CAMPO_MODIFICA #0#17, 1, "N";  |CAMPO_MODIFICA #0#18, 1, "N";
    |CAMPO_MODIFICA #0#19, 1, "N";  |CAMPO_MODIFICA #0#20, 1, "N";
    |CAMPO_MODIFICA #0#21, 1, "N";  |CAMPO_MODIFICA #0#22, 1, "N";
    |CAMPO_MODIFICA #0#23, 1, "N";  |CAMPO_MODIFICA #0#24, 1, "N";
    |CAMPO_MODIFICA #0#25, 1, "N";  |CAMPO_MODIFICA #0#26, 1, "N";

    |PARA x = 3; |SI x [ 26; |HACIENDO x = x + 1;
          #0x = 0;  |PINTA #0x;
    |SIGUE;
|FINSI;
|FPRC;

|CALCULO NoMasEmpresas; |TIPO 0;
     |C_M #0Campo,0,aAlfa1;
     |SI aAlfa1 = "N"; |ACABA; |FINSI;

     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
               #0nCampo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
    |FINSI;
|FCAL;

|PROCESO grabaind;
 #4#0 = #2#0;
 |LEE 040#4=;
 |SI FSalida ! 0; |DDEFECTO #4; |FINSI;

 #10#0 = #2#0;
 #10#1 = #2#1;
 #10#2 = #0#29;
 |LEE 001#10=;
 |SI FSalida = 0;
     |SI #10#49 > "01.01.1900";
         |SI #10#49 < fFecha1; |ACABA; |FINSI;
     |FINSI;
 |FINSI;

 #3#0 = #2#0;
 #3#1 = #2#1;
 #3#2 = #2#2;
 #3#3 = #2#3;
 #3#4 = #2#4;
 #3#5 = #2#5;
 #3#6 = #2#6;
 #3#7 = #0#30;
 #3#8 = #4#3;
 |GRABA 040#3n;
|FPRC;

|DEFBUCLE eoscomul;
 #2#1;
 ;
 d_empre, #0#27, #0#29, 000;
 h_empre, #0#28, #0#29, 999;
 e;
 NULL, grabaind;
|FIN;

|PROCESO grabacom;
 #1#0 = #3#0;
 #1#1 = #3#1;
 #1#3 = #3#7;
 |LIBERA #1;
 |LEE 140#1=;
 |SI FSalida ! 0;
    |DDEFECTO #1;
    #1#0 = #3#0;
    #1#1 = #3#1;
    #1#2 = #3#8;
    #1#3 = #3#7;
    |GRABA 140#1n;
|FINSI;

#2#0 = #3#0;
#2#1 = #3#1;
#2#7 = #3#7;
#2#2 = #3#2;
|LIBERA #2;
|LEE 140#2=;
|SI FSalida ! 0;
    |DDEFECTO #2;
    #2#0 = #3#0;
    #2#1 = #3#1;
    #2#2 = #3#2;
    #2#3 = #3#3;
    #2#4 = #3#4;
    #2#5 = #3#5;
    #2#6 = #3#6;
    #2#7 = #3#7;
    |GRABA 140#2n;
|FINSI;
|FPRC;

|DEFBUCLE eoszcomu;
#3#1;
;
00000, 0, 00, 000;
99999, 9, 99, 999;
e;
NULL, grabacom;
|FIN;

|PROCESO duplica; |TIPO 3;

 |SI #0#30 < 80;
     nNume1 = 2000 + #0#30;
 |SINO;
     nNume1 = 1900 + #0#30;
 |FINSI;
 aAlfa1  = nNume1;
 aAlfa1  = "01.01." + aAlfa1;
 fFecha1 = aAlfa1;

 |DELINDEX #3;
 |ABRE #3;
 |ABRE #4;
 |ABRE #10;
 |SI #0#0 = "N";
     d_empre = #0#1;
     h_empre = #0#2;
     |BUCLE eoscomul;
 |SINO;
     |PARA x = 3; |SI x [ 26; |HACIENDO x = x + 1;
           |SI #0x ! 0;
               d_empre = #0x;
               h_empre = #0x;
               |BUCLE eoscomul;
           |FINSI;
     |SIGUE;
 |FINSI;
 |CIERRA #10;
 |CIERRA #4;
 |CIERRA #3;

|ABRE #1;
|ABRE #2;
|BUCLE eoszcomu;
|CIERRA #1;
|CIERRA #2;

|DELINDEX #3;
|FPRC;
