|FICHEROS;
   eoszp027 #0;
   eosm0041 #1;
   eosm0042 #2;
   eosm0044 #3;
|FIN;

|VARIABLES;
   &eaVarDni  = "";
   &enCalcCif = 0;

   DNIAnt = "";
   Comodin = "";
|FIN;

|PROCESO CambiaLineas2;
   #eosm0044#2 = #eosm0041#2;
   |GRABA 020#eosm0044.n;
   #eosm0044#2 = DNIAnt;
   |LEE 010#eosm0044.=;
   |SI FSalida = 0;
      |BORRA 020#eosm0044.a;
   |FINSI;
|FPRC;

|DEFBUCLE CambiaLineas2;
   #eosm0044#1;
   ;
   #eosm0041#0,#eosm0041#1,DNIAnt,   0, 01;
   #eosm0041#0,#eosm0041#1,DNIAnt,9999, 99;
   ;
   NULL,CambiaLineas2;
|FIN;

|PROCESO CambiaLineas1;
   #eosm0042#2 = #eosm0041#2;
   |GRABA 020#eosm0042.n;
   #eosm0042#2 = DNIAnt;
   |LEE 010#eosm0042.=;
   |SI FSalida = 0;
      |BORRA 020#eosm0042.a;
   |FINSI;
|FPRC;

|DEFBUCLE CambiaLineas1;
   #eosm0042#1;
   ;
   #eosm0041#0,#eosm0041#1,DNIAnt, 01, 0001;
   #eosm0041#0,#eosm0041#1,DNIAnt, 99, 9999;
   ;
   NULL,CambiaLineas1;
|FIN;

|PROCESO CambioClave;
   eaVarDni  = #eosm0041#2;
   enCalcCif = 0;
   DNIAnt =#eosm0041#2;
   |HAZ CalculoDNI;
   #eosm0041#2 = eaVarDni;
   |GRABA 020#eosm0041.n;
   |BUCLE CambiaLineas1;
   |BUCLE CambiaLineas2;
   #eosm0041#2 = DNIAnt;
   |LEE 010#eosm0041.=;
   |SI FSalida = 0;
      |BORRA 020#eosm0041.a;
   |FINSI;
|FPRC;

|PROCESO Relacion;
   Comodin = #eosm0041#2;
   |QBF Comodin;
   Comodin = Comodin % -101
   |SI Comodin ] "0"; |Y Comodin [ "9";
      |HAZ CambioClave;
   |SINO;
      |ACABA;
   |FINSI;
|FPRC;

|DEFBUCLE Relacion;
  #eosm0041#1;
  ;
  #0#0,#0#1,"            ", 01;
  #0#0,#0#1,"zzzzzzzzzzzz", 99;
  ;
  NULL,Relacion;
|FIN;

|PROGRAMA;
   |CLS;
   |CABEZA "Recalculo letra NIF en modelo 180";
   |PINPA #0#0;
   |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida ! 0; |ACABA; |FINSI;

   |ABRE #eosm0041;
   |BUCLE Relacion;
   |CIERRA #eosm0041;
|FPRO;
