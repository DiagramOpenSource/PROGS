|FICHEROS;
   eoscabco #0;
   eoslinco #1;
   eoscabve #2;
   eoslinve #3;
   eosamorc #4;
   eosamorl #5;
   eosm0023 #6;
   eosm0024 #7;
|FIN;

|VARIABLES;
   &emp_act   = 0;
   &emp_nue   = 0;
   fichero    = "";
   fichero_1  = "";
   fichero_2  = "";
   anyo       = "";
   fich       = "";
   borra      = "";
   systema    = "",
   borrar     = "";
   mover      = "";
   muevelo    = "";
   dire       = "";
   fich1      = "";
   fich2      = "";
|FIN;

|PROGRAMA;
   |HAZ fichero0;
   |HAZ fichero2;
   |HAZ fichero4;
   |HAZ fichero6;
|FPRO;

|| **************************************************************************
||                          Apuntes Compras
|| **************************************************************************

|PROCESO graba1;
#1#0 = emp_nue;
|GRABA 140#1a;
|LIBERA #1;

#1#0 = emp_act;
|LIBERA #1;
|LEE 140#1=;
|FPRC;

|PROCESO prepara1;
fichero = #0#0;
fichero = "00000" + fichero;
fichero = fichero % -105;
anyo    = #0#4;
anyo    = "00" + anyo;
anyo    = anyo % -102;
fichero_1 = "c" + fichero + anyo;

fichero = emp_nue;
fichero = "00000" + fichero;
fichero = fichero % -105;
anyo    = #0#4;
anyo    = "00" + anyo;
anyo    = anyo % -102;
fichero_2 = "c" + fichero + anyo;

|DFICE fich;

fich1 = fich + fichero_1 + ".dat"
fich2 = fich + fichero_2 + ".dat";
|COPIA_FICHERO fich1, fich2;

fich1 = fich + fichero_1 + ".ddx"
fich2 = fich + fichero_2 + ".ddx";
|COPIA_FICHERO fich1, fich2;

fich1 = fich + fichero_1 + ".ixx"
fich2 = fich + fichero_2 + ".ixx";
|COPIA_FICHERO fich1, fich2;

|NOME_DAT #1 fichero_2;
|BUCLELIN 0graba1#0;

#0#0 = emp_nue;
|GRABA 140#0n;
|LIBERA #0;

#0#0 = emp_act;
|LIBERA #0;
|LEE 140#0=;
|FPRC;

|DEFBUCLE cabcom_1;
#0#1;
;
emp_act, 00;
emp_act, 99;
be;
NULL, prepara1;
|FIN;

|PROCESO prepara0;
fichero = #0#0;
fichero = "00000" + fichero;
fichero = fichero % -105;
anyo    = #0#4;
anyo    = "00" + anyo;
anyo    = anyo % -102;
fichero = "c" + fichero + anyo;

|DFICE fich;
borrar = fich + fichero + ".dat";  |FBORRA   borrar;
borrar = fich + fichero + ".ddx";  |FBORRA   borrar;
borrar = fich + fichero + ".ixx";  |FBORRA   borrar;

|NOME_DAT #1 fichero;
|ABRE #1; |CIERRA #1; |DELINDEX #1;

|BORRA 020#0a;
|LIBERA #0;
|FPRC;

|DEFBUCLE cabcom_2;
#0#1;
;
emp_act, 00;
emp_act, 99;
be;
NULL, prepara0;
|FIN;

|PROCESO fichero0;
|BUCLE cabcom_1;
|BUCLE cabcom_2;
|FPRC;

|| **************************************************************************
||                          Apuntes Ventas
|| **************************************************************************

|PROCESO graba3;
#3#0 = emp_nue;
|GRABA 140#3a;
|LIBERA #3;

#3#0 = emp_act;
|LIBERA #3;
|LEE 140#3=;
|FPRC;

|PROCESO prepara4;
fichero = #2#0;
fichero = "00000" + fichero;
fichero = fichero % -105;
anyo    = #2#4;
anyo    = "00" + anyo;
anyo    = anyo % -102;
fichero_1 = "v" + fichero + anyo;

fichero = emp_nue;
fichero = "00000" + fichero;
fichero = fichero % -105;
anyo    = #2#4;
anyo    = "00" + anyo;
anyo    = anyo % -102;
fichero_2 = "v" + fichero + anyo;

|DFICE fich;

fich1 = fich + fichero_1 + ".dat"
fich2 = fich + fichero_2 + ".dat";
|COPIA_FICHERO fich1, fich2;

fich1 = fich + fichero_1 + ".ddx"
fich2 = fich + fichero_2 + ".ddx";
|COPIA_FICHERO fich1, fich2;

fich1 = fich + fichero_1 + ".ixx"
fich2 = fich + fichero_2 + ".ixx";
|COPIA_FICHERO fich1, fich2;

|NOME_DAT #3 fichero_2;
|BUCLELIN 0graba3#2;

#2#0 = emp_nue;
|GRABA 140#2n;
|LIBERA #2;

#2#0 = emp_act;
|LIBERA #2;
|LEE 140#2=;
|FPRC;

|DEFBUCLE cabven_1;
#2#1;
;
emp_act, 00;
emp_act, 99;
be;
NULL, prepara4;
|FIN;

|PROCESO prepara3;
fichero = #2#0;
fichero = "00000" + fichero;
fichero = fichero % -105;
anyo    = #2#4;
anyo    = "00" + anyo;
anyo    = anyo % -102;
fichero = "v" + fichero + anyo;

|DFICE fich;
borrar = fich + fichero + ".dat";  |FBORRA   borrar;
borrar = fich + fichero + ".ddx";  |FBORRA   borrar;
borrar = fich + fichero + ".ixx";  |FBORRA   borrar;

|NOME_DAT #3 fichero;
|ABRE #3; |CIERRA #3; |DELINDEX #3;

|BORRA 020#2a;
|LIBERA #2;
|FPRC;

|DEFBUCLE cabven_2;
#2#1;
;
emp_act, 00;
emp_act, 99;
be;
NULL, prepara3;
|FIN;

|PROCESO fichero2;
|BUCLE cabven_1;
|BUCLE cabven_2;
|FPRC;

|| **************************************************************************
||                          Amortizaciones
|| **************************************************************************

|PROCESO graba5;
#5#0 = emp_nue;
|GRABA 140#5n;
|LIBERA #5;

#5#0 = emp_act;
|LIBERA #5;
|LEE 140#5=;
|FPRC;

|PROCESO graba4;
|BUCLELIN 0graba5#4;

#4#0 = emp_nue;
|GRABA 140#4n;
|LIBERA #4;

#4#0 = emp_act;
|LIBERA #4;
|LEE 140#4=;
|FPRC;

|DEFBUCLE amortiza_1;
#4#1;
;
emp_act, 00, 00001;
emp_act, 99, 99999;
be;
NULL, graba4;
|FIN;

|PROCESO borra4;
|BUCLELIN 1NULL#4;
|BORRA 020#4a;
|LIBERA #4;
|FPRC;

|DEFBUCLE amortiza_2;
#4#1;
;
emp_act, 00, 00001;
emp_act, 99, 99999;
be;
NULL, borra4;
|FIN;

|PROCESO fichero4;
|BUCLE amortiza_1;
|BUCLE amortiza_2;
|FPRC;

|PROCESO Graba06;
     #6#0 = emp_nue;
     |GRABA 140#6n;
     |LIBERA #6;

     #6#0 = emp_act;
     |LIBERA #6;
     |LEE 140#6=;
|FPRC;

|DEFBUCLE eosm0023_1;
     #6#1;
     ;
     emp_act, 1, 00001;
     emp_act, 6, 99999;
     be;
     NULL, Graba06;
|FIN;

|PROCESO Borra06;
     |BORRA 120#6a;
     |LIBERA #6;
|FPRC;

|DEFBUCLE eosm0023_2;
     #6#1;
     ;
     emp_act, 1, 00001;
     emp_act, 6, 99999;
     be;
     NULL, Borra06;
|FIN;

|PROCESO Graba07;
     #7#0 = emp_nue;
     |GRABA 140#7n;
     |LIBERA #7;

     #7#0 = emp_act;
     |LIBERA #7;
     |LEE 140#7=;
|FPRC;

|DEFBUCLE eosm0024_1;
     #7#1;
     ;
     emp_act, 1, 00001, 0000;
     emp_act, 6, 99999, 9999;
     be;
     NULL, Graba07;
|FIN;

|PROCESO Borra07;
     |BORRA 120#7a;
     |LIBERA #7;
|FPRC;

|DEFBUCLE eosm0024_2;
     #7#1;
     ;
     emp_act, 1, 00001, 0000;
     emp_act, 6, 99999, 9999;
     be;
     NULL, Borra07;
|FIN;

|PROCESO fichero6;
     |BUCLE eosm0023_1;
     |BUCLE eosm0023_2;
     |BUCLE eosm0024_1;
     |BUCLE eosm0024_2;
|FPRC;
