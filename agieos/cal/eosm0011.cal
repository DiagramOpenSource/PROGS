|FICHEROS;
     :/agicli/def/agicontr #97;   || Control Modulo integrador

     eosm0011 #0;
     eosclipr #2;
     eosaplic #96;                || Control Aplicacion
|FIN;

|VARIABLES;
     PathFich = "";
     PathPan  = "";

     Letra1     = "";
     Letra2     = "";
     Letra3     = "";
     Letra4     = "";
     Letra5     = "";
     Letra6     = "";
     Letra7     = "";
     Letra8     = "";
     Caracter   = "";
     Carac1     = 0;
     Carac2     = 0;
     Carac3     = 0;
     Carac4     = 0;
     Carac5     = 0;

     aNifQbf1   = "";
     aNifQbf2   = "";

     &eaVarDni  = "";
     &enCalcCif = 0;
|FIN;

|PROCESO Tipo8; |TIPO 8;
  |ABRE #96;
  |LEE 040#96p;
  |SI FSalida ! 0; |DDEFECTO #96; |FINSI;
  |CIERRA #96;

  |DBASS PathFich;
  |PATH_DAT #97 PathFich;

  |SI #96#11 = 1; |ACABA; |FINSI;

  |ABRE #97;
  |LEE 040#97p;
  |SI FSalida ! 0; |CIERRA #97; |ACABA; |FINSI;
  |CIERRA #97;

  PathFich = #97#8; |QBF PathFich;
  |SI PathFich = "*"; |ACABA; |FINSI;

  PathPan = (PathFich - "fich/") + "pan/";

  |PATH_DAT #2 PathFich;
  |PATH_PAN #2 PathPan;
|FPRC;

|PROCESO LetraDni; |TIPO 6;
     |SI FSalida = 9;
         eaVarDni   = #0Campo;
         enCalcCif  = 1;
         |HAZ CalculoDNI;
         #0Campo = eaVarDni;
         |PINTA #0Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #0Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;

     aNifQbf1 = #0Campo;   |QBF aNifQbf1;
     aNifQbf2 = eaVarDni;  |QBF aNifQbf2;

     |SI aNifQbf1 ! aNifQbf2; |Y aNifQbf1 ! "";
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #0Campo = eaVarDni;  |PINTA #0Campo;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;
