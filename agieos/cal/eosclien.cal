|FICHEROS;
   eosclien #0;
   eosprovi #5;
   eospobla #6;
   eosaplic #8;
   eosactiv #12;
   eoscomun #11;
   eoscomul #13;
   eosw0017 #14;
   eosw0018 #15;

   :/agicli/def/agicontr #3;
   :/agicli/def/agifigen #4;
   :/agicli/def/agim0004 #20;
   :/agicli/def/agicen01 #21;

   asclient #9;
   facemp   #10;
|FIN;

|VARIABLES;
 FechaAnyo  = @;
 Varalfa    = "";
 sw_carga   = 0;
 FEstado    = 0;
 empresa    = 0;
 nombre_e   = "";
 campo      = 0;
 con        = 0;
 swmod      = 0;
 mod        = 0;
 nomo       = 0;
 nume1      = 0;
 nume2      = 0;
 lugar      = 0;
 nifnum     = 0;
 resto      = 0;
 campito    = 0;
 campita    = 0;
 cont       = 0;
 men3       = "0000S Modificar Facturacion  S/N : ";
 men4       = "0000S Confirmar el Alta S/N : ";
 men5       = "     NO EXISTE EMPRESA FACTURACION";
 men6       = "0000S Confirma el alta en Clientes General : ";
 men7       = "      D.N.I. del Cliente es distinto al D.N.I. del Cliente General";
 men8       = "      No existe Cliente General";
 verrfec    = "0000ATENCION !! Fecha erronea o formato incorrecto ";
 aste       = "";
 agi        = "";
 agi1       = "";
 agi2       = "";
 sw_fac     = 0;
 sw_fac1    = 0;
 pathfic    = "";
 pathpan    = "";
 FGraba     = 0;
 Conta_Repre = 0;

 aponer     = "";
 fiac       = "";
 relleno    = "                                                 ";
 vdia1      = "";
 vme1       = "";
 vany1      = "";
 vdia       = 0;
 vme        = 0;
 vany       = 0;
 vtope      = 0;
 vsw        = 0;
 vfec       = "";
 vblanco    = "          ";
 vpuntos    = "......... .";
 v          = 0;
 vacio      = "                                        ";
 particion  = "facges/fich/";
 particionp = "facges/pan/";
 client     = "";
 parfacges  = "";
 d1         = "";
 d2         = "";
 d3         = "";
 filtro     = "";
 direcc     = "";
 trabacod1  = "";
 trabacod2  = "";

 letra      = "";
 alfa       = "";
 alfa1      = "";
 alfa2      = "";
 final      = "";
 x          = "";
 pos1       = "";
 pos2       = "";
 pos3       = "";
 pos4       = "";

 sw         = 0;
 fondo      = "°";
 yy         = 0;
 posici     = 0;
 horizo     = "";
 modo       = 0;
 opcion     = 0;
 linea      = 0;
 longi      = "";
 num        = 0;

     aNifQbf1   = "";
     aNifQbf2   = "";

     &eaVarDni  = "";
     &enCalcCif = 0;

 &Empresa     = 0;
 &QuePrograma = 1;

 &emp_acti = 0;
 &act_acti = 0;
 &any_acti = 0;
 &mod_acti = 0;
 &nom_acti = "";
 &ep1_acti = "";
 &ep2_acti = "";
 &nep_acti = "";
 &com_acti = "";

 {-1} menu      = "";
    menu1       = "1956";
    menu2       = "1";
    menu3       = "2";
    menu4       = "Actividades       ";
    menu5       = "Comunidades Bienes";

     &EURO = 0;
     &EURODB = 0;
     &EURODV = 0;
|FIN;

|INCLUYE i_ficher;

|PROCESO bajacli; |TIPO 1;
con = (FEntrada / 100) ! 0;

|SI con ! 3; |ACABA; |FINSI;

|SI aste  = "";  |HAZ tipo_8; |FINSI;
|SI aste  = "*"; |ACABA;      |FINSI;

|ABRE #4;
#4#0 = #0#0;
|LEE 110#4=;
|SI FSalida = 0;
    #4#19 = "N";
    |GRABA 020#4a;
    |LIBERA #4;
|FINSI;
|CIERRA #4;

Empresa = #0#0;
|SUB_EJECUTA "eosborr1";
|FPRC;

|PROCESO codipost; |TIPO 3;
#0#21 = "";
trabacod1 = #0#10;
trabacod1 = "00" + trabacod1;
trabacod1 = trabacod1 % -102;
trabacod2 = #0#11;
trabacod2 = "000" + trabacod2;
trabacod2 = trabacod2 % -103;
#0#21 = trabacod1 + trabacod2;

#0#59 = "";
trabacod1 = #0#55;
trabacod1 = "00" + trabacod1;
trabacod1 = trabacod1 % -102;
trabacod2 = #0#56;
trabacod2 = "000" + trabacod2;
trabacod2 = trabacod2 % -103;
#0#59 = trabacod1 + trabacod2;

|SI con ! 2;   |ACABA; |FINSI;
|SI swmod ! 1; |ACABA; |FINSI;

|ABRE #4;
#4#0 = #0#0;
|LEE 110#4=;
|SI FSalida = 0;                || Recoge variables del agicli
    |SI #0#1 ! #4#13; |MENAV men7; |FINSI;
|SINO;
    |MENAV men8;
|FINSI;
|CIERRA #4;
|FPRC;

|PROCESO fechacon; |TIPO 0;
vfec = #0Campo; vsw = 0;
|SI vfec ! vblanco; |Y vfec ! vpuntos;
  vdia1 = vfec % A102;
  vme1 = vfec % A402;
  vany1 = vfec % A704;
  vdia = vdia1; vme = vme1; vany = vany1;
  |SI vdia ! 0; |Y vme ! 0; |Y vany > 1900;
     |SI vme [ 12; |Y vme ] 1;
       |SI vme = 1; |O vme = 3; |O vme = 5; |O vme = 7; |O vme = 8; |O vme = 10; |O vme = 12;
           vtope = 31;
       |SINO;
           |SI vme = 2;
               mod = vany $ 4;
               |SI mod = 0;
                   vtope = 29;
               |SINO;
                   vtope = 28;
               |FINSI;
            |SINO;
               vtope = 30;
            |FINSI;
        |FINSI;
        |SI vdia [ vtope;
            vsw = 1;
        |FINSI;
     |FINSI;
  |FINSI;
|SINO;
  vsw = 1;
|FINSI;
|SI vsw = 0;
    |MENAV verrfec;
    |ERROR;
|FINSI;
|FPRC;

|PROCESO igual;|TIPO 0;
|SI #0#3 = vacio;
    #0#3 = #0#2;
    |PINTA #0#3;
|FINSI;
|FPRC;

|PROCESO altacli; |TIPO 0;
con   = (FEntrada / 100) ! 0;
swmod = 0;

|SI aste  = "";  |HAZ tipo_8; |FINSI;
|SI aste  = "*"; |ACABA;      |FINSI;

swmod = 1;

|SI con ! 1; |ACABA; |FINSI;                       || Modo alta

|ABRE #4;
#4#0 = #0#0;
|LEE 110#4=;
|SI FSalida = 0;                || Recoge variables del agicli
    #4#19 = "S";
    |GRABA 020#4a;                 || Graba el agicli
    |LIBERA #4;
    |HAZ carga_var4;
|SINO;
    |CONFI men6;
    |SI FSalida = 0;
        |PATH_PAN #4agi2;
        |PUSHV 0501 2380;
        |PINPA #0#4;
        |DDEFECTO #4;
        |PINDA #0#4;
        #4#0 = #0#0;
        |PINTA #4#0;
        |ENDATOS #1#4;
        |SI FSalida = 0;
            |POPV;
            |HAZ postal_c4;
            #4#19 = "S";
            |GRABA 020#4n;                 || Graba el agicli
            |LIBERA #4;
            |HAZ carga_var4;
        |SINO;
            |POPV;
            |ERROR;
        |FINSI;
    |FINSI;
|FINSI;
|CIERRA #4;
|FPRC;

|PROCESO Represent;
Conta_Repre = Conta_Repre + 1;
|SI Conta_Repre > 3; |ERROR10; |ACABA; |FINSI;

|SI Conta_Repre = 1;
    #0#24 = #20#3 % 120;
    #0#25 = #20#3 % 2120;
    #0#26 = #20#2;
    #0#27 = #20#4;
    #0#28 = #20#5;
|FINSI;

|SI Conta_Repre = 2;
    #0#29 = #20#3 % 120;
    #0#30 = #20#3 % 2120;
    #0#31 = #20#2;
    #0#32 = #20#4;
    #0#33 = #20#5;
|FINSI;

|SI Conta_Repre = 3;
    #0#34 = #20#3 % 120;
    #0#35 = #20#3 % 2120;
    #0#36 = #20#2;
    #0#37 = #20#4;
    #0#38 = #20#5;
|FINSI;
|FPRC;

|DEFBUCLE agim0004;
#20#1;
;
#0#0, 00;
#0#0, 99;
;
NULL, Represent;
|FIN;

|PROCESO CogeActiv;
FechaAnyo = ~;
Varalfa   = FechaAnyo % -102;

#12#0  = #21#0;
#12#1  = #21#1;
#12#2  = Varalfa;
|LIBERA #12;
|LEE 140#12=;
|SI FSalida ! 0;
    #12#0  = #21#0;
    #12#1  = #21#1;
    #12#2  = Varalfa;
    #12#3  = #0#2;
    #12#4  = #21#2;
    #12#5  = #21#3;
    #12#6  = #21#4;
    #12#7  = #21#13;
    #12#9  = #0#5;
    #12#10 = #0#13;
    #12#11 = #0#10;
    #12#12 = #0#11;
    #12#13 = #0#12;
    #12#48 = #21#5;
    #12#49 = #21#14;
    |GRABA 140#12n;
|FINSI;
|FPRC;

|DEFBUCLE agicen01;
#21#1;
;
#0#0, 01;
#0#0, 06;
;
NULL, CogeActiv;
|FIN;

|PROCESO carga_var4;
sw_carga = 0;
#0#1  = #4#13; |PINTA #0#1;
#0#2  = #4#2;  |PINTA #0#2;
#0#3  = #4#1;  |PINTA #0#3;
#0#4  = #4#3;  |PINTA #0#4;
#0#5  = #4#4;  |PINTA #0#5;
#0#6  = #4#5;  |PINTA #0#6;
#0#7  = #4#6;  |PINTA #0#7;
#0#8  = #4#7;  |PINTA #0#8;
#0#9  = #4#8;  |PINTA #0#9;
#0#10 = #4#9;  |PINTA #0#10;
#0#11 = #4#10; |PINTA #0#11;
#0#12 = #4#12; |PINTA #0#12;
#0#13 = #4#11; |PINTA #0#13;
#0#14 = #4#14; |PINTA #0#14;
#0#15 = #4#15; |PINTA #0#15;
#0#16 = #4#88; |PINTA #0#16;
#0#18 = #4#63; |PINTA #0#18;
#0#19 = #4#64; |PINTA #0#19;
#0#21 = #4#16;
#0#63 = #0#2;  |PINTA #0#63;
#0#52 = #4#52; |PINTA #0#52;
#0#53 = #4#53; |PINTA #0#53;
#0#54 = #4#55; |PINTA #0#54;
#0#55 = #4#57; |PINTA #0#55;
#0#56 = #4#58; |PINTA #0#56;
#0#57 = #4#60; |PINTA #0#57;
#0#58 = #4#59; |PINTA #0#58;
#0#64 = #4#65; |PINTA #0#64;

Conta_Repre = 0;
|BUCLE agim0004;

|ABRE #12; |BUCLE agicen01; |CIERRA #12;
|FPRC;

|PROCESO nopasa;                   || RUTINA PARA HACER <no modificable>
    aponer = Anono;
    fiac = Control % A1001;
    Control = Control + fiac;
    Control = Control + relleno;
    Control = Control % A120;
    Control = Control + aponer;
|FPRC;

|PROCESO postal_c4;
    #4#16 = "";
    trabacod1 = #4#9;
    trabacod1 = "00" + trabacod1;
    trabacod1 = trabacod1 % -102;
    trabacod2 = #4#10;
    trabacod2 = "000" + trabacod2;
    trabacod2 = trabacod2 % -103;
    #4#16 = trabacod1 + trabacod2;
|FPRC;

|PROCESO letranif;
     |SI FSalida = 9;
         eaVarDni   = #0Campo;
         enCalcCif  = 1;
         |HAZ CalculoDNI;
         #0Campo = eaVarDni;
         |PINTA #0Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #0Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     aNifQbf1 = #0Campo;   |QBF aNifQbf1;
     aNifQbf2 = eaVarDni;  |QBF aNifQbf2;

     |SI aNifQbf1 ! aNifQbf2; |Y aNifQbf1 ! "";
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #0Campo = eaVarDni;  |PINTA #0Campo;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO pintapro; |TIPO 0;
|ABRE #5;
#5#0 = #0Campo;
|LEE 040#5=;
|SI FSalida = 0;
    campito = Campo + 2
    #0campito = #5#1;
    |PINTA #0campito;
|SINO;
    |MENAV "    No existe Provinciero.";
    |ERROR;
|FINSI;
|CIERRA #5;
|FPRC;

|PROCESO pintapob; |TIPO 0;
cont = (FEntrada / 100) ! 0;
|SI cont = 1;
    |ABRE #6;
    campito = Campo - 1;
    campita = Campo + 2;
    #6#0 = #0campito;
    #6#1 = #0Campo;
    |LEE 040#6=;
    |SI FSalida = 0;
        #0campita = #6#2;
        |PINTA #0campita;
    |SINO;
        |MENAV "    No existe Poblacion.";
        |ERROR;
    |FINSI;
    |CIERRA #6;
|FINSI;
|FPRC;

|PROCESO nombre; |TIPO 0;
cont = (FEntrada / 100) ! 0;
|SI cont = 1;
    #0#63 = #0#2;
    |PINTA #0#63;
|FINSI;
|FPRC;

|PROCESO calle; |TIPO 0;
cont = (FEntrada / 100) ! 0;
|SI cont = 1; |Y sw_carga = 0;
    #0#52 = #0#5;
    |PINTA #0#52;
|FINSI;
|FPRC;

|PROCESO numero; |TIPO 0;
cont = (FEntrada / 100) ! 0;
|SI cont = 1; |Y sw_carga = 0;
    #0#53 = #0#6;
    |PINTA #0#53;
|FINSI;
|FPRC;

|PROCESO piso; |TIPO 0;
cont = (FEntrada / 100) ! 0;
|SI cont = 1; |Y sw_carga = 0;
    #0#54 = #0#8;
    |PINTA #0#54;
|FINSI;
|FPRC;

|PROCESO provinci_c; |TIPO 0;
cont = (FEntrada / 100) ! 0;
|SI cont = 1; |Y sw_carga = 0;
    #0#55 = #0#10;
    #0#57 = #0#12;
    |PINTA #0#55;
    |PINTA #0#57;
|FINSI;
|FPRC;

|PROCESO poblacio_c; |TIPO 0;
cont = (FEntrada / 100) ! 0;
|SI cont = 1; |Y sw_carga = 0;
    #0#56 = #0#11;
    #0#58 = #0#13;
    |PINTA #0#56;
    |PINTA #0#58;
|FINSI;
|FPRC;

|PROCESO sifactu; |TIPO 7;
sw_fac = 0;
|CAMPO_MODIFICA #0#22, 1, "N";
|CAMPO_MODIFICA #0#23, 1, "N";

|ABRE #8;
|LEE 040#8p;
|SI FSalida = 0; |Y #8#7 = "S";
    sw_fac = 1;
    |CAMPO_MODIFICA #0#22, 1, "S";
    |CAMPO_MODIFICA #0#23, 1, "S";
    |SI cont = 1; #0#23 = #0#0; |PINTA #0#23; |FINSI;
|FINSI;
|CIERRA #8;
|FPRC;

|PROCESO cua370; |TIPO 7;
|PUSHV 0501 2380
|CUADRO 1034 2074;
|ATRI R;
|PINTA 1135, "Si en el trimestre anterior hicimos el ";
|PINTA 1235, "modelo 370 teniendo cuotas a compensar ";
|PINTA 1335, "en cualquiera de las actividades, para ";
|PINTA 1435, "poder emitir el 300 o 310 por separado ";
|PINTA 1535, "en el trimestre actual debemos revisar ";
|PINTA 1635, "las cuotas a compensar.                ";
|PINTA 1735, "Las cuotas a compensar que tenemos en  ";
|PINTA 1835, "esta pantalla es la cuota que imprimira";
|PINTA 1935, "el 370. La calcula al imprimir el 370. ";
|ATRI 0;
|FPRC;

|PROCESO mod370; |TIPO 0;
|POPV;
|PINTA #0#60;
|CAMPO_MODIFICA #0#65, 1, "N";
|CAMPO_MODIFICA #0#66, 1, "N";
|CAMPO_MODIFICA #0#67, 1, "N";
|CAMPO_MODIFICA #0#68, 1, "N";
|SI #0#60 = "S";
    |CAMPO_MODIFICA #0#65, 1, "S";
    |CAMPO_MODIFICA #0#66, 1, "S";
    |CAMPO_MODIFICA #0#67, 1, "S";
    |CAMPO_MODIFICA #0#68, 1, "S";
|FINSI;
|FPRC;

|PROCESO mirafac; |TIPO 0;
|SI sw_fac = 0; |ACABA; |FINSI;
|SI #0#22  = 0; |ACABA; |FINSI;
|SI #0#23  = 0; |ACABA; |FINSI;
sw_fac1 = 0;
|ABRE #8;
|LEE 040#8p;
|SI FSalida = 0; |Y #8#7 = "S";
    pathfic = #8#8; |QBF pathfic;
    |PATH_DAT #10pathfic;
    |ABRE #10;
    #10#0 = #0#22;
    |LEE 040#10=;
    |SI FSalida ! 0;
        |MENAV "       No existe empresa de facturacion ";
        |ERROR;
    |SINO;
        sw_fac1 = 1;
    |FINSI;
    |CIERRA #10;
|FINSI;
|CIERRA #8;
|FPRC;

|PROCESO grabafac; |TIPO 0;
    |SI sw_fac1 = 0; |ACABA; |FINSI;
    alfa    = #0#22;
    alfa    = ("00" + alfa) % -102;
    pathfic = #8#8; |QBF pathfic;
    pathfic = pathfic + alfa + "/";
    pathpan = #8#9; |QBF pathpan;
    |PATH_DAT #9pathfic;
    |PATH_PAN #9pathpan;
    |ABRE #9;
    #9#0 = #0#23;
    |LIBERA #9;
    |LEE 110#9=;
    |SI FSalida ! 0;
        |HAZ cargafac1;
        |SI FGraba = 0; |GRABA 020#9n; |FINSI;
    |SINO;
        |CONFI "2400NDesea modificar el cliente en facturacion : ";
        |SI FSalida = 0;
            |HAZ cargafac2;
            |SI FGraba = 0; |GRABA 020#9a; |FINSI;
        |FINSI;
    |FINSI;
    |CIERRA #9;
    |POPV;
|FPRC;

|PROCESO cargafac1;
|PUSHV 0501 2380;
|PINPA #0#9;
#9#0  = #0#23;
#9#1  = #0#3;
#9#2  = #0#2;
#9#3  = #0#5;
#9#4  = #0#10;
#9#5  = #0#11;
#9#6  = #0#13;
#9#7  = #0#12;
#9#8  = #0#1;
#9#9  = #0#14;
#9#10 = #0#15;
|PINDA #0#9;
|ENDATOS #1#9;
FGraba = FSalida;
|FPRC;

|PROCESO cargafac2;
|PUSHV 0501 2380;
|PINPA #0#9;
|PINDA #0#9;
|ENDATOS #1#9;
FGraba = FSalida;
|FPRC;

|PROCESO graba_inde14;
linea = linea + 1;
#14#0 = linea;
#14#1 = #12#1;
#14#2 = #12#2;
#14#3 = #12#4;
#14#4 = #12#5;
#14#5 = #12#6;
|GRABA 040#14n;
|FPRC;

|DEFBUCLE eosactiv;
#12#1;
;
empresa, 0, 00;
empresa, 9, 99;
e;
NULL, graba_inde14;
|FIN;

|PROCESO graba_inde15;
linea = linea + 1;
#15#0 = linea;
#15#1 = #13#1;   ||Actividad
#15#2 = #13#7;   ||A¤o
#15#3 = #13#2;   ||Linea
#15#4 = #13#3;   ||Empresa Comunero
#15#5 = #13#5;   ||Actividad comunero
#15#6 = #13#6;   ||%
#15#7 = #13#4;   ||Nombre
|GRABA 040#15n;
|FPRC;

|DEFBUCLE eoscomul;
#13#1;
;
empresa, 0, 00, 000;
empresa, 9, 99, 999;
e;
NULL, graba_inde15;
|FIN;

|PROCESO tipo_30; |TIPO 30;
|SI cont ! 1; |Y cont ! 2; |ACABA; |FINSI;
empresa = #0#0;

|PINPA #0#0;
|PINDA #0#0;
|PUSHV 0501 2380;
sw = 0;

comienza = "17";
|HAZ fichero;
|NOME_DAT #14 fichero;
|ABRE #14; |CIERRA #14; |DELINDEX #14;

linea = 0;
|ABRE #14;
|BUCLE eosactiv;
|CIERRA #14;

comienza = "18";
|HAZ fichero;
|NOME_DAT #15 fichero;
|ABRE #15; |CIERRA #15; |DELINDEX #15;

linea = 0;
|ABRE #15;
|BUCLE eoscomul;
|CIERRA #15;

|PARA; |SI sw = 0; |HACIENDO;
   |PARA yy = 18; |SI yy [ 22; |HACIENDO yy = yy + 1;
       posici = (yy * 100) + 80;
       |PINTA posici,fondo;
   |SIGUE;
   horizo = "";
   |PARA yy = 1; |SI yy [ 31; |HACIENDO yy = yy + 1;
       horizo = horizo + fondo;
   |SIGUE;
   |PINTA 2350,horizo;
   menu2  = opcion;

   |MENUG menu;
   opcion = FSalida;
   |SI opcion ] 1; |Y opcion [ 5;
       |SI opcion = 1; |HAZ carga_acti; |FINSI;
       |SI opcion = 2; |HAZ carga_comu; |FINSI;
       |HAZ pinta_pan;
   |SINO;
       sw = 1;
   |FINSI;
|SIGUE;
|HAZ pinta_pan;
|POPV;
|DELINDEX #14;
|DELINDEX #15;

#0#0 = empresa;
|LIBERA #0;
|LEE 140#0=;
|FPRC;

|PROCESO pinta_pan;
|PINPA #0#0;
|PINDA #0#0;
|FPRC;

|RUTINA super_14;
#14#0 = 999;
|FRUT;

|RUTINA infer_14;
#14#0 = 1;
|FRUT;

|PROCESO carga_acti;
|PUSHV 0501 2380;
|PINPA #0#14;

|ENTLINEAL #1#14, -1, 1, 21, 0, infer_14, super_14;
|POPV;
|FPRC;

|RUTINA super_15;
#15#0 = 999;
|FRUT;

|RUTINA infer_15;
#15#0 = 1;
|FRUT;

|PROCESO eoscomul;
 linea = #13#2;
|FPRC;

|PROCESO graba_comu;
    |SI #15#3 = 0;
         |ABRE #11;
         #11#0 = empresa;
         #11#1 = #15#1;
         #11#3 = #15#2;
         |LEE 040#11=;
         |SI FSalida ! 0;
             #11#0 = empresa;
             #11#1 = #15#1;
             #11#3 = #15#2;
             #11#2 = #0#2;
             |GRABA 040#11n;
             linea = 1;
         |SINO;
             linea = 0;
             |BUCLELIN 0eoscomul#11;
             linea = linea + 1;
        |FINSI;
        |CIERRA #11;

        |ABRE #13;
        #13#0 = empresa;
        #13#1 = #15#1;
        #13#2 = linea;
        #13#3 = #15#4;
        #13#4 = #15#7;
        #13#5 = #15#5;
        #13#6 = #15#6;
        #13#7 = #15#2;
        |GRABA 040#13n;
        |CIERRA #13;

        #15#3 = linea;
        |GRABA 140#15a;
        |LIBERA #15;
   |SINO;
        |ABRE #13;
        #13#0 = empresa;
        #13#1 = #15#1;
        #13#7 = #15#2;
        #13#2 = #15#3;
        |LIBERA #13;
        |LEE 140#13=;
        |SI FSalida = 0;
            #13#3 = #15#4;
            #13#4 = #15#7;
            #13#5 = #15#5;
            #13#6 = #15#6;
            |GRABA 040#13a;
        |FINSI;
        |CIERRA #13;
   |FINSI;

   |LIBERA #15;
|FPRC;

|DEFBUCLE eosw0018;
  #15#1;
  ;
  000;
  999;
  be;
  NULL, graba_comu;
|FIN;

|PROCESO carga_comu;
  |SI #0#51 ! "S"; |ACABA; |FINSI;

  |PUSHV 0501 2380;
  |PINPA #0#15;
  |ENTLINEAL #1#15, 1, 1, 21, 0, infer_15, super_15;
  |BUCLE eosw0018;
  |POPV;
|FPRC;

|PROCESO baja_activ; |TIPO 1;

 mod_acti = (FEntrada / 100) ! 0;
 |SI mod_acti ! 3; |ACABA; |FINSI;
 |CONFI "    NConfirmacion baja S/N";
 |SI FSalida = 0;
    mod_acti = (FEntrada / 100) ! 0;
    emp_acti = empresa;
    act_acti = #14#1;
    any_acti = #14#2;
    nom_acti = #0#2;
    com_acti = #0#51;

    |SUB_EJECUTA "eosacti1.run";
    |SI mod_acti = 99; |ERROR; |FINSI;
 |SINO;
     |ERROR;
 |FINSI;
|FPRC;

|PROCESO alta_activi;
mod_acti = (FEntrada / 100) ! 0;
emp_acti = empresa;
act_acti = #14#1;
any_acti = #14#2;
nom_acti = #0#2;
com_acti = #0#51;

|SUB_EJECUTA "eosacti1.run";

#14#3 = ep1_acti; |PINTA #14#3;
#14#4 = ep2_acti; |PINTA #14#4;
#14#5 = nep_acti; |PINTA #14#5;

|SI mod_acti = 99; |ERROR; |FINSI;
|FPRC;

|PROCESO esta_acti; |TIPO 0;
|ABRE #12;
#12#0 = empresa;
#12#1 = #15#1;
#12#2 = #15#2;
|LEE 040#12=;
|SI FSalida ! 0;
    |MENAV "      No existe Actividad";
    |ERROR;
    |CIERRA #12;
    |ACABA;
|FINSI;

|SI #12#46 ! "S";
    |MENAV "      La actividad no es comunidad de bienes";
    |ERROR;
|FINSI;
|CIERRA #12;
|FPRC;

|PROCESO es_comu; |TIPO 0;
||    |SI #15#3 = 0;
||        #0#0 = #15#4;
||        |LEE 040#0=;
||        |SI FSalida = 0; |DDEFECTO #0; |FINSI;
||        #15#7 = #0#2;
||    |FINSI;

    |ABRE #12;
    #12#0 = #15#4;
    #12#1 = #15#5;
    #12#2 = #15#2;
    |LEE 040#12=;
    |SI FSalida = 0;
        |SI #12#14 ! "S";
            |MENAV "       La Actividad no es comunero";
            |ERROR;
        |SINO;
             |SI #15#3 = 0; #15#7 = #12#3; |FINSI;
        |FINSI;
    |SINO;
        |MENAV "       No existe Actividad.";
        |ERROR;
    |FINSI;
    |CIERRA #12;
|FPRC;

|PROCESO tipo_8; |TIPO 88;
|DBASS agi;
|PATH_DAT #3 agi;

|ABRE #3;
|LEE 040#3p;
|SI FSalida ! 0; aste = "*"; |CIERRA #3; |ACABA; |FINSI;
|CIERRA #3;

aste = #3#3;
|QBF aste;
|SI aste  = "*"; |ACABA; |FINSI;

agi1 = #3#8; |QBF agi1;

longi = agi1 % A0;
num   = longi;
num   = 100 + (num - 5);
longi = num;

agi2  = (agi1 % longi) + "pan/";

|PATH_DAT #4 agi1;
|PATH_PAN #4 agi2;

|PATH_DAT #20 agi1;
|PATH_DAT #21 agi1;
|FPRC;
