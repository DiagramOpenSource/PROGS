|FICHEROS;
     eosem300 #0;
     eosclien #2;
     eoshacie #3;
     eosdaban #4;
     eosm1300 #5;
     eosm0050 #50;
     eosactiv #6;
     eosw0068 #99;
     eosw0544 #544;
     eosw0552 #552;

     eosw0601 #601,MANTE;
|FIN;

|VARIABLES;
     Campos      = 0;
     LLeno40     = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     Vacio40     = "                                        ";

     pp          = 0;
     sw_sigue    = 0;
     x           = 0;
     sw          = 0;
     inf         = 0;
     inf1        = 0;
     inf2        = 0;
     pepe        = 0;
     informe     = "";
     error1      = "     Impreso Detenido";
     error2      = "     No existe informe";
     sw_hay      = 0;
     varii       = 0;
     varic       = 0;
     varib       = 0;
     aa          = 0;
     nCanti1     = 0;
     nActiv      = 0;

     aDirOri    = "";
     aDirDes    = "";
     aOrigen    = "";
     aDestino   = "";
     aAlfa      = "";

     nNeg = 0;
     aValfa0     = "";
     aValfa1     = "";
     aValfa2     = "";
     aValfa      = "";
     nPosi       = 0;
     nSwPunto    = 0;
     nTEuro1     = 0;
     nTEuro2     = 0;
     nTEuro3     = 0;
     nGraba      = 0;

     &SwViene    = 0;
     &VEmpresa   = 0;
     &VPeriodo   = 0;
     &VAnyo      = 0;

     &empresa    = 0;
     &sin        = "";
     &dia        = "";
     &mes        = "";
     &anyo       = "";
     &cont       = 0;
     &atri       = 0;
     &compe      = 0;
     &sujet      = 0;
     &t_venta    = 0;
     &t_compr    = 0;
     &dife       = 0;
     &atribu     = 0;
     &total      = 0;
     &t_ing      = 0;
     &t_com      = 0;
     &t_dev      = 0;
     &entrega    = 0;

 {-1}&base   = 0;
     &base1  = 0;
     &base2  = 0;
     &base3  = 0;
     &base4  = 0;
     &base5  = 0;
     &base6  = 0;
     &base7  = 0;

 {-1}&tipo   = 0.00;
     &tipo1  = 0.00;
     &tipo2  = 0.00;
     &tipo3  = 0.00;
     &tipo4  = 0.00;
     &tipo5  = 0.00;
     &tipo6  = 0.00;

 {-1}&cuota  = 0;
     &cuota1 = 0;
     &cuota2 = 0;
     &cuota3 = 0;
     &cuota4 = 0;
     &cuota5 = 0;
     &cuota6 = 0;
     &cuota7 = 0;

 {-1}&ivade  = 0;
     &ivade1 = 0;
     &ivade2 = 0;
     &ivade3 = 0;
     &ivade4 = 0;
     &ivade5 = 0;
     &ivade6 = 0;

     Calc     = 0;
     Calc1    = 0;
     Calc2    = 0;
     TipoDato = "";
     Long     = 0;
     LongDec  = 0;
     Comodin  = "";
     Comodin1 = "";
     Comodin2 = "";
     Vacio1   = "";
     Vacio2   = "";

     aAlfa1       = "";
     aUnidad      = "";

  {1}aContiene    = "";

     &EURODB    = 0;

     {-1}aMoneda   = "";
         aMoneda1  = "LEER";
         aMoneda2  = "";


     aAbre        = "";
     aModelos     = "";
     aTipo        = "";

     nHandle1     = 0;
     nHandle2     = 0;
     nAnyo2D      = 0;
     nSwHay       = 0;
     nTCampo      = 0;

     fFecha       = @;

     &eaFOrigen   = "";
     &eaFDestino  = "";
     &eaInternet  = "";
     &eaImpresora = "";
     &enNume      = 0;
     &eaAlfa      = "";
     &eaDiaB      = "";
     &eaMesB      = "";
     &eaAnyoB     = "";
     &enPor100    = 1;
     &eaModelos   = "";

     &enSwTrata   = 0;
|FIN;

|INCLUYE i_seguim;
|INCLUYE i_cuadre;
|INCLUYE i_anyode;
|INCLUYE i_consul;
|INCLUYE i_laserc;

|PROCESO Mayus; |TIPO 0;
     #0Campo = #0Campo > #0Campo;
     |PINTA #0Campo;
|FPRC;

|PROCESO FPago; |TIPO 0;
 |SI FSalida = 2; |ACABA; |FINSI;

 |SI #0#32 ! "F";
     |SI #0#35 = "A";  |O #0#35 = "E";
         |MENAV "    Opcion valida solo para Fichero / Internet. ";
         |ERROR;
     |FINSI;
 |FINSI;
|FPRC;

|PROCESO Parrilla; |TIPO 0;
     |SI VEmpresa ! 0;  |ACABA;  |FINSI;

     |SI #0#7 = "S";
         |PARA Campos = 8; |SI Campos [ 31; |HACIENDO Campos = Campos + 1;
               |C_M #0Campos, 1, "N";  #0Campos = 0;  |PINTA #0Campos;
         |SIGUE;
         |C_M #0#0, 1, "S";   |C_M #0#1, 1, "S";  |C_M #0#33, 1, "S";
     |SINO;
         |PARA Campos = 8; |SI Campos [ 31; |HACIENDO Campos = Campos + 1;
               |C_M #0Campos, 1, "S";
         |SIGUE;
         |C_M #0#0,  1, "N"; #0#0 = 1;     |PINTA #0#0;
         |C_M #0#1,  1, "N"; #0#1 = 99999; |PINTA #0#1;
         |C_M #0#33, 1, "N"; #0#33 = "C";  |PINTA #0#33;
     |FINSI;
|FPRC;

|PROCESO fecha; |TIPO 0;
     |SI #0Campo > "30.04.1994"; |ERROR; |FINSI;
|FPRC;

|PROCESO pinta_anyo; |TIPO 7;
     |SI VEmpresa ! 0;  |ACABA;  |FINSI;

     fFecha = ~;
     aAlfa  = fFecha % -104;
     #0#2   = aAlfa;
     |PINTA #0#2;
|FPRC;

|PROCESO calcula;
     sw_hay = 1;
     varii = varii + #5#33;
     varic = varic + #5#32 + #5#31;
|FPRC;

|PROCESO impre92;
     #5#55 = 0;
     |SI #5#33 ! 0; |Y varib > 0;
         |SI #5#33 ] varib;
             #5#55 = varib;
             varib = 0;
         |SINO;
             #5#55 = #5#33;
             varib = varib - #5#55;
         |FINSI;
     |FINSI;
     |SI #5#32 ! 0; |Y varib < 0;
         |SI #5#32 ] varib;
             #5#55 = varib;
             varib = 0;
         |SINO;
             #5#55 = #5#32;
             varib = varib - #5#55;
         |FINSI;
     |FINSI;
     |SI #5#31 ! 0; |Y varib < 0;
         |SI #5#31 ] varib;
             #5#55 = varib;
             varib = 0;
         |SINO;
             #5#55 = #5#31;
             varib = varib - #5#55;
         |FINSI;
     |FINSI;

     |SI #0#32 ! "B";
         #5#3 = #0#6;
         |GRABA 020#5a;
     |FINSI;

     sw = 1;
     |HAZ importes;

     |SI #5#55 > 0; |ACABA; |FINSI;

     nActiv = #5#45;
     |SI #5#1 = 4; |O #5#1 = 12;
         |SI #0#32 ! "B";
             |ABRE #6;
             #6#0 = #5#0;
             #6#1 = #5#45;
             #6#2 = nAnyo2D;
             |LIBERA #6;
             |LEE 110#6=;
             |SI FSalida = 0;
                 #6#34 = 0;
                 |SI #6#27 = "C"; #6#34 = -#5#55; |FINSI;
                 |GRABA 020#6a;
             |FINSI;
             |CIERRA #6;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO importes;
     sin = "X";
     |PARA inf = 5; |SI inf [ 11; |HACIENDO inf = inf + 3;
         Ibase = base1 <-;
         Itipo = tipo1 <-;
         Icuota = cuota1 <-;
         inf1 = inf + 2;
         inf2 = inf + 1;
         |SI #5inf ! 0;|Y #5inf1 ! 0;
            pepe = 0;
            |ET arriba;
                |SI tipo ! 0;
                    |SI #5inf2 = tipo;
                        base = base + #5inf;
                        tipo = #5inf2;
                        cuota = cuota + #5inf1;
                    |SINO;
                        pepe = pepe + 1;
                        Ibase = Ibase + 1;
                        Itipo = Itipo + 1;
                        Icuota = Icuota + 1;
                        |SI pepe [ 3; |VETE arriba; |FINSI;
                     |FINSI;
                 |SINO;
                     base = #5inf;
                     tipo = #5inf2;
                     cuota = #5inf1;
                 |FINSI;
                 sin = "";
         |FINSI;
     |SIGUE;

     |PARA pp = 1; |SI pp [ 3; |HACIENDO pp = pp + 1;
         Ibase = base4 <-;
         Itipo = tipo4 <-;
         Icuota = cuota4 <-;

         |SI pp = 1; inf = 14; |FINSI;
         |SI pp = 2; inf = 17; |FINSI;
         |SI pp = 3; inf = 46; |FINSI;
         inf1 = inf + 2;
         inf2 = inf + 1;

         |SI #5inf ! 0;|Y #5inf1 ! 0;
           pepe = 0;
           |ET arriba1;
                |SI tipo ! 0;
                    |SI #5inf2 = tipo;
                        base = base + #5inf;
                        tipo = #5inf2;
                        cuota = cuota + #5inf1;
                    |SINO;
                        pepe = pepe + 1;
                        Ibase = Ibase + 1;
                        Itipo = Itipo + 1;
                        Icuota = Icuota + 1;
                        |SI pepe [ 3; |VETE arriba1; |FINSI;
                    |FINSI;
                |SINO;
                    base = #5inf;
                    tipo = #5inf2;
                    cuota = #5inf1;
                |FINSI;
                sin = "";
         |FINSI;
     |SIGUE;

     Ibase  = base7 <-;
     Icuota = cuota7 <-;
     base   = base  + #5#49;
     cuota  = cuota + #5#50;

     Iivade = ivade1 <-;
     |PARA x = 21; |SI x [ 24; |HACIENDO x = x + 1;
         |SI #5x ! 0; ivade = ivade + #5x; sin = ""; |FINSI;
         Iivade = Iivade + 1;
     |SIGUE;

     Iivade = ivade1 <-;
     |PARA x = 43; |SI x [ 44; |HACIENDO x = x + 1;
         |SI #5x ! 0; ivade = ivade + #5x; sin = ""; |FINSI;
         Iivade = Iivade + 1;
     |SIGUE;

     Iivade = ivade5 <-;
     |SI #5#51 ! 0;  ivade = ivade + #5#51;  |FINSI;
     |SI #5#78 ! 0;  ivade = ivade + #5#78;  |FINSI;

     Iivade = ivade6 <-;
     |SI #5#80 ! 0;  ivade = ivade + #5#80;  |FINSI;

     cont    = cont + 1;
     atri    = atri + #5#27;
     compe   = compe + #5#29;
     sujet   = sujet + #5#30;
     t_venta = t_venta + #5#20;
     t_compr = t_compr + #5#25;
     entrega = entrega + #5#54;
|FPRC;

|PROCESO totalimp;
     |ABRE #6;
     #6#0 = #2#0;
     #6#1 = nActiv;
     #6#2 = nAnyo2D;
     |LEE 040#6];
     |SI FSalida ! 0; |DDEFECTO #6; |FINSI;
     |SI #6#0 ! #2#0; |DDEFECTO #6; |FINSI;

     nCanti = base1;   |HAZ ConverCanti;  base1  = nCanti;
     nCanti = base2;   |HAZ ConverCanti;  base2  = nCanti;
     nCanti = base3;   |HAZ ConverCanti;  base3  = nCanti;
     nCanti = base4;   |HAZ ConverCanti;  base4  = nCanti;
     nCanti = base5;   |HAZ ConverCanti;  base5  = nCanti;
     nCanti = base6;   |HAZ ConverCanti;  base6  = nCanti;
     nCanti = base7;   |HAZ ConverCanti;  base7  = nCanti;

     nCanti = cuota1;  |HAZ ConverCanti;  cuota1 = nCanti;
     nCanti = cuota2;  |HAZ ConverCanti;  cuota2 = nCanti;
     nCanti = cuota3;  |HAZ ConverCanti;  cuota3 = nCanti;
     nCanti = cuota4;  |HAZ ConverCanti;  cuota4 = nCanti;
     nCanti = cuota5;  |HAZ ConverCanti;  cuota5 = nCanti;
     nCanti = cuota6;  |HAZ ConverCanti;  cuota6 = nCanti;
     nCanti = cuota7;  |HAZ ConverCanti;  cuota7 = nCanti;

     nCanti = ivade1;  |HAZ ConverCanti;  ivade1 = nCanti;
     nCanti = ivade2;  |HAZ ConverCanti;  ivade2 = nCanti;
     nCanti = ivade3;  |HAZ ConverCanti;  ivade3 = nCanti;
     nCanti = ivade4;  |HAZ ConverCanti;  ivade4 = nCanti;
     nCanti = ivade5;  |HAZ ConverCanti;  ivade5 = nCanti;
     nCanti = ivade6;  |HAZ ConverCanti;  ivade6 = nCanti;

     nCanti = compe;   |HAZ ConverCanti;  compe   = nCanti;
     nCanti = entrega; |HAZ ConverCanti;  entrega = nCanti;
     nCanti = sujet;   |HAZ ConverCanti;  sujet   = nCanti;

     t_venta = cuota1 + cuota2 + cuota3 + cuota4 + cuota5 + cuota6 + cuota7;
     t_compr = ivade1 + ivade2 + ivade3 + ivade4 + ivade5 + ivade6;
     dife    = t_venta - t_compr;
     atri    = atri / cont;
     atribu  = dife % atri;
     total  = atribu - compe + sujet;

     |SI total ] 0;
         t_ing = total;
         t_dev = 0;
         t_com = 0;
     |SINO;
         t_com = -total;
         t_ing = 0;
         t_dev = 0;

         aTipo = #6#26;
         |SI aTipo = "F";  aTipo = "T";  |FINSI;

         |SI #0#4 = 4; |Y aTipo = "T";
             |SI #6#27 = "D"; t_dev = t_com; t_com = 0; |FINSI;
         |FINSI;
         |SI #0#4 = 12; |Y aTipo = "M";
             |SI #6#27 = "D"; t_dev = t_com; t_com = 0; |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO ConverCanti;
     |SI #0#32 = "O";  |O #0#32 = "B";  |ACABA;  |FINSI;

     eaMoneda = #0#34;
     enCanti  = nCanti;
     |HAZ ConverMoneda;
     nCanti   = enCanti;
|FPRC;

|PROCESO Valor12;
     |SI nCanti ] 0;
         aCanti = nCanti;
         aCanti = ("000000000000" + aCanti) % -112;
     |SINO;
         nCanti = -nCanti;
         aCanti = nCanti;
         aCanti = "N" + (("00000000000" + aCanti) % -111);
     |FINSI;
|FPRC;

|PROCESO Ent1Dec2;
     aValfa   = (nCanti + "          ") % 110;
     nPosi    = 0;
     aValfa0  = "";
     aValfa1  = "";
     aValfa2  = "";
     nSwPunto = 0;
     |PARA nCampo = 1;  |SI nCampo [ 10;  |HACIENDO nCampo = nCampo + 1;
           nPosi  =  (100 * nCampo) + 1;
           aValfa0 = aValfa % nPosi;
           |SI aValfa0 = ".";  nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aValfa0 ! " "; |Y  aValfa0 ! ".";
                   aValfa1 = aValfa1 + aValfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aValfa0 ! " "; |Y aValfa0 ! ".";
                   aValfa2 = aValfa2 + aValfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     aCanti         = (("0" + aValfa1) % -101) + ((aValfa2 + "00") % 102);
|FPRC;

|PROCESO Ent2Dec2;
     aValfa   = (nCanti + "          ") % 110;
     nPosi    = 0;
     aValfa0  = "";
     aValfa1  = "";
     aValfa2  = "";
     nSwPunto = 0;
     |PARA nCampo = 1;  |SI nCampo [ 10;  |HACIENDO nCampo = nCampo + 1;
           nPosi  =  (100 * nCampo) + 1;
           aValfa0 = aValfa % nPosi;
           |SI aValfa0 = ".";  nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aValfa0 ! " "; |Y  aValfa0 ! ".";
                   aValfa1 = aValfa1 + aValfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aValfa0 ! " "; |Y aValfa0 ! ".";
                   aValfa2 = aValfa2 + aValfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     aCanti = (("00" + aValfa1) % -102) + ((aValfa2 + "00") % 102);
|FPRC;

|PROCESO Ent3Dec2;
     aValfa   = (nCanti + "          ") % 110;
     nPosi    = 0;
     aValfa0  = "";
     aValfa1  = "";
     aValfa2  = "";
     nSwPunto = 0;
     |PARA nCampo = 1;  |SI nCampo [ 10;  |HACIENDO nCampo = nCampo + 1;
           nPosi  =  (100 * nCampo) + 1;
           aValfa0 = aValfa % nPosi;
           |SI aValfa0 = ".";  nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aValfa0 ! " "; |Y  aValfa0 ! ".";
                   aValfa1 = aValfa1 + aValfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aValfa0 ! " "; |Y aValfa0 ! ".";
                   aValfa2 = aValfa2 + aValfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     aCanti         = (("000" + aValfa1) % -103) + ((aValfa2 + "00") % 102);
|FPRC;

|PROCESO Carga3002001;
     |DDEFECTO #99;

     |SI #0#34 = "EUROS  ";  #99#1 = "303";  |FINSI;

     #99#4  = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);

     Valfa  = #2#1; |QBF Valfa;
     #99#5  = ("000000000" + Valfa) % -109;
     #99#6  = #2#2;
     #99#8  = #2#4;
     #99#9  = #2#5;
     #99#10 = #2#6;
     #99#11 = #2#7;
     #99#12 = #2#8;
     #99#13 = #2#9;
     #99#14 = (("00" + #2#10) % -102) + (("000" + #2#11) % -103);
     #99#15 = #2#13;
     #99#16 = #2#12;
     #99#17 = #2#14;
     #99#18 = #0#2;
     #99#19 = #0#4;

     nCanti = base1;   |HAZ Valor12;  #99#20 = aCanti;
     nCanti = tipo1;   |HAZ Ent2Dec2; #99#21 = aCanti;
     nCanti = cuota1;  |HAZ Valor12;  #99#22 = aCanti;

     nCanti = base2;   |HAZ Valor12;  #99#23 = aCanti;
     nCanti = tipo2;   |HAZ Ent2Dec2; #99#24 = aCanti;
     nCanti = cuota2;  |HAZ Valor12;  #99#25 = aCanti;

     nCanti = base3;   |HAZ Valor12;  #99#26 = aCanti;
     nCanti = tipo3;   |HAZ Ent2Dec2; #99#27 = aCanti;
     nCanti = cuota3;  |HAZ Valor12;  #99#28 = aCanti;

     nCanti = base4;   |HAZ Valor12;   #99#29 = aCanti;
     nCanti = tipo4;   |HAZ Ent1Dec2;  #99#30 = aCanti;
     nCanti = cuota4;  |HAZ Valor12;   #99#31 = aCanti;

     nCanti = base5;   |HAZ Valor12;   #99#32 = aCanti;
     nCanti = tipo5;   |HAZ Ent1Dec2;  #99#33 = aCanti;
     nCanti = cuota5;  |HAZ Valor12;   #99#34 = aCanti;

     nCanti = base6;   |HAZ Valor12;   #99#35 = aCanti;
     nCanti = tipo6;   |HAZ Ent1Dec2;  #99#36 = aCanti;
     nCanti = cuota6;  |HAZ Valor12;   #99#37 = aCanti;

     nCanti = base7;   |HAZ Valor12;   #99#38 = aCanti;
     nCanti = cuota7;  |HAZ Valor12;   #99#39 = aCanti;

     nCanti = ivade1;  |HAZ Valor12;  #99#41 = aCanti;
     nCanti = ivade2;  |HAZ Valor12;  #99#42 = aCanti;
     nCanti = ivade5;  |HAZ Valor12;  #99#43 = aCanti;
     nCanti = ivade3;  |HAZ Valor12;  #99#44 = aCanti;
     nCanti = ivade4;  |HAZ Valor12;  #99#45 = aCanti;

     nCanti = t_compr; |HAZ Valor12;  #99#46 = aCanti;
     nCanti = t_venta; |HAZ Valor12;  #99#40 = aCanti;
     nCanti = dife;    |HAZ Valor12;  #99#47 = aCanti;
     nCanti = atri;    |HAZ Ent3Dec2;    #99#48 = aCanti;
     nCanti = atribu;  |HAZ Valor12;  #99#49 = aCanti;
     nCanti = compe;   |HAZ Valor12;  #99#50 = aCanti;
     nCanti = entrega; |HAZ Valor12;  #99#51 = aCanti;
     nCanti = sujet;   |HAZ Valor12;  #99#52 = aCanti;
     nCanti = total;   |HAZ Valor12;  #99#53 = aCanti;
     nCanti = t_com;   |HAZ Valor12;  #99#54 = aCanti;
     nCanti = t_dev;   |HAZ Valor12;  #99#56 = aCanti;
     nCanti = t_ing;   |HAZ Valor12;  #99#63 = aCanti;

     #99#55 = sin;
     |SI t_dev ! 0;
         #99#57 = #4#2;
         #99#58 = #4#3;
         #99#59 = #4#4;
         #99#60 = #4#5;
     |FINSI;

     |SI t_ing ! 0;
         #99#64 = #4#2;
         #99#65 = #4#3;
         #99#66 = #4#4;
         #99#67 = #4#5;
     |FINSI;

     #99#68 = dia;
     #99#69 = mes;
     #99#70 = #0#6 % -104;
     #99#71 = &13 + &10;
|FPRC;

|PROCESO Formateo;
   nNeg = 0;
   |SI TipoDato = "N";
      Vacio1 = "0" * Long;
      Vacio2 = "0" * LongDec;
      Comodin = Comodin - "-";
      |SI FSalida ! 0; nNeg = 1; |FINSI;
   |SINO;
      Vacio1 = " " * Long;
   |FINSI;

   |SI LongDec = 0;
      Calc = 0 - (100 + Long);
      Comodin = (Vacio1 + Comodin) % Calc;
   |SINO;
      Comodin = Comodin - ".";
      |SI FSalida = 0;
         Calc = 0 - (100 + Long);
         Comodin = (Vacio1 + Comodin) % Calc;
         Comodin1 = "0" * LongDec;
      |SINO;
         Calc1 = (((FSalida / 100) ! 0) - 1) + 100;
         Calc2 = (((FSalida / 100) ! 0) * 100) + 99;
         Comodin1 = Comodin % Calc2;
         Comodin  = Comodin % Calc1;
         Calc = 0 - (100 + Long);
         Comodin  = (Vacio1 + Comodin)  % Calc;
         Calc = 100 + LongDec;
         Comodin1 = (Comodin1 + Vacio2) % Calc;
      |FINSI;
   |FINSI;
   |SI TipoDato = "N"; |Y nNeg = 1;
      Calc = 0 - (100 + (Long - 1));
      Comodin = "N" + (Comodin % Calc)
   |FINSI;
|FPRC;

|PROCESO Secuencial00;
         Cadena = "300";
         |SI #0#34 = "PESETAS";  Cadena = Cadena + "P";  |FINSI;
         |SI #0#34 = "EUROS  ";  Cadena = Cadena + "E";  |FINSI;
         Cadena  = Cadena + (#eosclien#1 % 0109);    ||NIF
         Cadena  = Cadena + "    ";                  || Letras de etiqueta
         Comodin = #0#2;
         Cadena  = Cadena + Comodin;                 || Ejercicio
         Comodin = #eosem300#4; |QBF Comodin; Comodin = Comodin + "T";
         Cadena  = Cadena + Comodin;                 || Periodo

         Long = 17; LongDec = 0; TipoDato = "N";
         Comodin = base1; |HAZ Formateo;
         Cadena = Cadena + Comodin; || Base Imponible 1
         Long = 2; LongDec = 2;
         Comodin = tipo1; |HAZ Formateo;
         Cadena = Cadena + Comodin;  || Tipo 1
         Cadena = Cadena + Comodin1; || Tipo 1
         Long = 17; LongDec = 0;
         Comodin = cuota1; |HAZ Formateo;
         Cadena = Cadena + Comodin; || Cuota 1

         Comodin = base2; |HAZ Formateo;
         Cadena = Cadena + Comodin; || Base Imponible 2
         Long = 2; LongDec = 2;
         Comodin = tipo2; |HAZ Formateo;
         Cadena = Cadena + Comodin;  || Tipo 2
         Cadena = Cadena + Comodin1; || Tipo 2
         Long = 17; LongDec = 0;
         Comodin = cuota2; |HAZ Formateo;
         Cadena = Cadena + Comodin; || Cuota 2

         Comodin = base3; |HAZ Formateo;
         Cadena = Cadena + Comodin; || Base Imponible 3
         Long = 2; LongDec = 2;
         Comodin = tipo3; |HAZ Formateo;
         Cadena = Cadena + Comodin;  || Tipo 3
         Cadena = Cadena + Comodin1; || Tipo 3
         Long = 17; LongDec = 0;
         Comodin = cuota3; |HAZ Formateo;
         Cadena = Cadena + Comodin; || Cuota 3

         Comodin = base4; |HAZ Formateo;
         Cadena = Cadena + Comodin; || Base Imponible 4
         Long = 2; LongDec = 2;
         Comodin = tipo4; |HAZ Formateo;
         Cadena = Cadena + Comodin;  || Tipo 4
         Cadena = Cadena + Comodin1; || Tipo 4
         Long = 17; LongDec = 0;
         Comodin = cuota4; |HAZ Formateo;
         Cadena = Cadena + Comodin; || Cuota 4

         Comodin = base5; |HAZ Formateo;
         Cadena = Cadena + Comodin; || Base Imponible 5
         Long = 2; LongDec = 2;
         Comodin = tipo5; |HAZ Formateo;
         Cadena = Cadena + Comodin;  || Tipo 5
         Cadena = Cadena + Comodin1; || Tipo 5
         Long = 17; LongDec = 0;
         Comodin = cuota5; |HAZ Formateo;
         Cadena = Cadena + Comodin; || Cuota 5
         Cadena = Handle + " " + Cadena;
         |FGRABA Cadena;

         Comodin = base6; |HAZ Formateo;
         Cadena = Comodin;           || Base Imponible 6
         Long = 2; LongDec = 2;
         Comodin = tipo6; |HAZ Formateo;
         Cadena = Cadena + Comodin;  || Tipo 6
         Cadena = Cadena + Comodin1; || Tipo 6
         Long = 17; LongDec = 0;
         Comodin = cuota6; |HAZ Formateo;
         Cadena = Cadena + Comodin; || Cuota 6

         Comodin = base7; |HAZ Formateo;
         Cadena = Cadena + Comodin; || Base Imponible 7
         Comodin = cuota7; |HAZ Formateo;
         Cadena = Cadena + Comodin; || Cuota 7

         Comodin = t_venta; |HAZ Formateo; Cadena = Cadena + Comodin; || Total Cuota devengada
         Comodin = ivade1;  |HAZ Formateo; Cadena = Cadena + Comodin; || Cuota Oper.Interiores
         Comodin = ivade2;  |HAZ Formateo; Cadena = Cadena + Comodin; || Cuota Importaciones
         Comodin = ivade5;  |HAZ Formateo; Cadena = Cadena + Comodin; || Cuota Adqu.intracomun.
         Comodin = ivade3;  |HAZ Formateo; Cadena = Cadena + Comodin; || Cuota Compens.A.G.y P.
         Comodin = ivade4;  |HAZ Formateo; Cadena = Cadena + Comodin; || Cuota Regul.Inversiones
         Cadena = Handle + " " + Cadena;
         |FGRABA Cadena;

         Comodin = t_compr; |HAZ Formateo; Cadena = Comodin;          || Total a deducir
         Comodin = dife;    |HAZ Formateo; Cadena = Cadena + Comodin; || Diferencia Total
         Long = 3; LongDec = 2;
         Comodin = atri;    |HAZ Formateo;
         Cadena = Cadena + Comodin;                                   || % atribuible al estado
         Cadena = Cadena + Comodin1;
         Long = 17; LongDec = 0;
         Comodin = atribu;  |HAZ Formateo; Cadena = Cadena + Comodin; || Cuota atrib.admon.estado
         Comodin = compe;   |HAZ Formateo; Cadena = Cadena + Comodin; || Cuotas a compensar per.ant.
         Comodin = entrega; |HAZ Formateo; Cadena = Cadena + Comodin; || Entregas intracomunitarias
         Comodin = sujet;   |HAZ Formateo; Cadena = Cadena + Comodin; || Result.regular.anual
         Comodin = total;   |HAZ Formateo; Cadena = Cadena + Comodin; || Resultado

         |ABRE #eosdaban;
         #eosdaban#0 = #eosclien#0;
         |LEE 000#eosdaban.=;
         |SI FSalida = 0; |Y t_dev ! 0;
            Cadena = Cadena + #eosdaban#2;
            Cadena = Cadena + #eosdaban#3;
            Cadena = Cadena + #eosdaban#4;
            Cadena = Cadena + #eosdaban#5;
         |SINO;
            Cadena = Cadena + (" " * 20);
         |FINSI;
         |CIERRA #eosdaban;

         Comodin = " " * 100; Cadena = Cadena + Comodin;              || Persona de contacto
         Cadena = Handle + " " + Cadena;
         |FGRABA Cadena;

         Cadena = " " * 210;                                           || Telefono de contacto y parte de observaciones
         Cadena = Handle + " " + Cadena;
         |FGRABA Cadena;

         Cadena = " " * 150;                                           || La otra parte de observaciones
         Cadena = Handle + " " + Cadena;
         |FGRABA Cadena;
|FPRC;

|PROCESO Internet300;
     Raiz       = "";  |DIRECTORIO Raiz;
     Directorio = "";
     |DBASE Directorio;
     Directorio = Directorio + "hacienda/internet/" + eaTipoSec;
     |MKDIR Directorio;
     Directorio = Directorio + "/";
     Valfa = Raiz + "bin/agichmod 777 " + Directorio;

     Empresa  = ("00000" + #2#0) % -105;

     Fichero    = eaTipoSec + Empresa;     aNombre = Fichero;
     INEmpresas = NEmpresas1 <-;
     INEmpresas = INEmpresas + NACopiar;
     NFichero   = Directorio + Fichero;          |QBF NFichero;
     NEmpresas  = NFichero;
     NACopiar   = NACopiar + 1;

     Fichero  = "wb  "+ NFichero;

     Pos = -1;
     |FABRE Fichero;
     Handle = FSalida;
     |SI FSalida ] 0;
         |HAZ Secuencial00;
     |FINSI;
     FSalida = Handle;
     |FCIERRA FSalida;

     aAlfa = ""; |IP_REMOTO aAlfa;
     |DBASE aDirOri; |QBF aDirOri;
     aDirOri = aDirOri + "hacienda/internet/" + eaTipoSec + "/";
     aDirDes = "/MODELOS";
     |SI aAlfa ! ""; |RMKDIR aDirDes; |SINO; |MKDIR aDirDes; |FINSI;
     aDirDes = "/MODELOS/INTERNET";
     |SI aAlfa ! ""; |RMKDIR aDirDes; |SINO; |MKDIR aDirDes; |FINSI;
     aDirDes = "/MODELOS/INTERNET/" + eaTipoSec;
     |SI aAlfa ! ""; |RMKDIR aDirDes; |SINO; |MKDIR aDirDes; |FINSI;
     aDirDes = aDirDes + "/";
     aOrigen = aDirOri + aNombre; aDestino = aDirDes + aNombre;
     |SI aAlfa ! ""; |ENVIA_FICHERO aOrigen, aDestino; |SINO; |COPIA_FICHERO aOrigen, aDestino; |FINSI;
     |MENAV "    Ficheros creados correctamente";
|FPRC;

|PROCESO Secuencial300;
     Raiz       = "";  |DIRECTORIO Raiz;
     Directorio = "";
     |DBASE Directorio;
     Directorio = Directorio + "hacienda/" + eaTipoSec;
     |MKDIR Directorio;
     Directorio = Directorio + "/";
     Valfa = Raiz + "bin/agichmod 777 " + Directorio;

     Empresa  = ("00000" + #2#0) % -105;

     Fichero    = eaTipoSec + Empresa;   aNombre = Fichero;
     INEmpresas = NEmpresas1 <-;
     INEmpresas = INEmpresas + NACopiar;
     NFichero   = Directorio + Fichero;          |QBF NFichero;
     NEmpresas  = NFichero;
     NACopiar   = NACopiar + 1;

     Fichero  = "wb  "+ NFichero;

     Pos = -1;
     |FABRE Fichero;
     Handle = FSalida;
     |SI FSalida ] 0;
         |HAZ Carga3002001;
         |PARA nCampo = 1;  |SI nCampo [ 71;  |HACIENDO nCampo = nCampo + 1;
               |SI #0#2 [ 1999;
                   |SI nCampo = 18;  |O nCampo = 70;
                       |SI nCampo = 18;
                           Cadena = Handle + " " + (#99nCampo % -102);
                       |FINSI;
                       |SI nCampo = 70;
                           Cadena = Handle + " " + (#99nCampo % -101);
                       |FINSI;
                   |SINO;
                       Cadena = Handle + " " + #99nCampo;
                   |FINSI;
               |SINO;
                   Cadena = Handle + " " + #99nCampo;
               |FINSI;

               |FGRABA Cadena;
         |SIGUE;
     |FINSI;
     FSalida = Handle;
     |FCIERRA FSalida;
|FPRC;

|PROCESO CargaImprime;
     aAlfa = "del err" + (("00000" + #2#0) % -105) + ".TXT" + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "wait mipf32 ";
     aAlfa = aAlfa + "/E:300" + (("00000" + #2#0) % -105) + ".TXT ";
     aAlfa = aAlfa + "/R:err" + (("00000" + #2#0) % -105) + ".TXT ";
     |SI eaImpresora ! "";
         aAlfa = aAlfa + "/I:" + &34 + eaImpresora + &34;
     |FINSI;
     aAlfa = aAlfa + " /C:" + #601#0;
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "DEL " + "300" + (("00000" + #2#0) % -105) + ".TXT ";
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle1, aAlfa;
|FPRC;

|PROCESO TDeclaracion;
     |SI t_dev ! 0;
         |SI #4#5 ! "          ";
             #544#58 = #4#2;
             #544#59 = #4#3;
             #544#60 = #4#4;
             #544#61 = #4#5;
         |FINSI;
     |FINSI;

     |SI t_ing ! 0;
         |SI #0#35 = "S";  |O #0#35 = "D";
             |SI #4#5 = "          ";
                 #544#62 = "X";
             |SINO;
                 #544#63 = "X";
                 #544#65 = #4#2;
                 #544#66 = #4#3;
                 #544#67 = #4#4;
                 #544#68 = #4#5;
             |FINSI;
         |SINO;
             #544#62 = "X";
         |FINSI;
     |FINSI;

     #544#4 = "";
     |SI #0#32 ! "F";
         |SI t_venta = 0;  |Y t_compr = 0;
             #544#4 = "N";
         |FINSI;
     |SINO;
         |SI t_com ! 0;  #544#4 = "C";  |FINSI;
         |SI t_dev ! 0;  #544#4 = "D";  |FINSI;
         |SI t_ing ! 0;
                                                   #544#4 = "I";

             |SI  #0#35 = "A";                     #544#4 = "A";  |FINSI;
             |SI  #0#35 = "E";                     #544#4 = "E";  |FINSI;
             |SI  #544#63 = "X";  |Y #0#35 = "D";  #544#4 = "U";  |FINSI;

             |SI #0#4 = 4;  |Y #0#2 = 2007;
                                     aAlfa  = "0";
                 |SI #544#4  = "I";  aAlfa  = "1";  |FINSI;
                 |SI #544#4  = "A";  aAlfa  = "2";  |FINSI;
                 |SI #544#4  = "U";  aAlfa  = "3";  |FINSI;

                 #544#62 = aAlfa;
                 #544#63 = "";
             |FINSI;
         |FINSI;

         |SI t_venta = 0;  |Y t_compr = 0; |Y compe = 0;
             #544#4 = "N";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Carga300_2002;
     |SI #0#32 = "L";
         aAbre = "\MODELOS\300\" + "300" + (("00000" + #2#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |SI #0#32 = "F";
         aAbre = eaInternet + "300" + (("00000" + #2#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |ABRE #50;
     #50#0 = #2#0;
     |LEE 000#50=;
     |SI FSalida ! 0;  |DDEFECTO #50;  |FINSI;
     |CIERRA #50;

     |DDEFECTO #544;

     #544#1   = "300";
     #544#2   = "01";
     #544#3   = "";

     #544#5   = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);
     aAlfa    = #2#1;  |QBF aAlfa;
     #544#6   = ("000000000" + aAlfa) % -109;
     #544#7   = #50#2;
     eaAlfa   = #2#2;    |HAZ QuitaRaros;     #544#8   = eaAlfa;
     #544#9   = ".";
     eaAlfa   = #2#4;    |HAZ QuitaRaros;     #544#10  = eaAlfa;
     eaAlfa   = #2#5;    |HAZ QuitaRaros;     #544#11  = eaAlfa;
     #544#12  = #2#6;
     #544#13  = #2#7;
     #544#14  = #2#8;
     #544#15  = #2#9;
     #544#16  = (("00" + #2#10) % -102) + (("000" + #2#11) % -103);
     eaAlfa   = #2#13;   |HAZ QuitaRaros;     #544#17  = eaAlfa;
     eaAlfa   = #2#12;   |HAZ QuitaRaros;     #544#18  = eaAlfa;
     eaAlfa   = #2#14;   |HAZ QuitaRarosTfno; #544#19 = eaAlfa;

     #544#20  = #0#2;
     #544#21  = #0#4 + "T";

     enNume  = base1;       |HAZ Conver13;   #544#22 = eaAlfa;
     enNume  = tipo1 * 100; #544#23 = ("0000" + enNume) % -104;
     enNume  = cuota1;      |HAZ Conver13;   #544#24 = eaAlfa;

     enNume  = base2;       |HAZ Conver13;   #544#25 = eaAlfa;
     enNume  = tipo2 * 100; #544#26 = ("0000" + enNume) % -104;
     enNume  = cuota2;      |HAZ Conver13;   #544#27 = eaAlfa;

     enNume  = base3;       |HAZ Conver13;   #544#28 = eaAlfa;
     enNume  = tipo3 * 100; #544#29 = ("0000" + enNume) % -104;
     enNume  = cuota3;      |HAZ Conver13;   #544#30 = eaAlfa;

     enNume  = base4;       |HAZ Conver13;   #544#31 = eaAlfa;
     enNume  = tipo4 * 100; #544#32 = ("0000" + enNume) % -103;
     enNume  = cuota4;      |HAZ Conver13;   #544#33 = eaAlfa;

     enNume  = base5;       |HAZ Conver13;   #544#34 = eaAlfa;
     enNume  = tipo5 * 100; #544#35 = ("0000" + enNume) % -103;
     enNume  = cuota5;      |HAZ Conver13;   #544#36 = eaAlfa;

     enNume  = base6;       |HAZ Conver13;   #544#37 = eaAlfa;
     enNume  = tipo6 * 100; #544#38 = ("0000" + enNume) % -103;
     enNume  = cuota6;      |HAZ Conver13;   #544#39 = eaAlfa;

     enNume  = base7;       |HAZ Conver13;  #544#40 = eaAlfa;
     enNume  = cuota7;      |HAZ Conver13;  #544#41 = eaAlfa;
     enNume  = t_venta;     |HAZ Conver13;  #544#42 = eaAlfa;

     enNume  = ivade1;      |HAZ Conver13;  #544#43 = eaAlfa;
     enNume  = ivade2;      |HAZ Conver13;  #544#44 = eaAlfa;
     enNume  = ivade5;      |HAZ Conver13;  #544#45 = eaAlfa;
     enNume  = ivade3;      |HAZ Conver13;  #544#46 = eaAlfa;
     enNume  = ivade4;      |HAZ Conver13;  #544#47 = eaAlfa;
     enNume  = t_compr;     |HAZ Conver13;  #544#48 = eaAlfa;

     enNume  = dife;        |HAZ Conver13;  #544#49 = eaAlfa;
     enNume  = atri * 100;                  #544#50 = ("00000" + enNume) % -105;
     enNume  = atribu;      |HAZ Conver13;  #544#51 = eaAlfa;
     enNume  = compe;       |HAZ Conver13;  #544#52 = eaAlfa;
     enNume  = entrega;     |HAZ Conver13;  #544#53 = eaAlfa;
     enNume  = sujet;       |HAZ Conver13;  #544#54 = eaAlfa;
     enNume  = total;       |HAZ Conver13;  #544#55 = eaAlfa;
     enNume  = t_com;       |HAZ Conver13;  #544#56 = eaAlfa;
     enNume  = t_dev;       |HAZ Conver13;  #544#57 = eaAlfa;
     enNume  = t_ing;       |HAZ Conver13;  #544#64 = eaAlfa;

     |HAZ TDeclaracion;

     eaAlfa  = #2#2;     |HAZ QuitaRaros;     #544#69  = eaAlfa;
     eaAlfa  = #2#14;    |HAZ QuitaRarosTfno; #544#70  = eaAlfa;

     eaAlfa  = #0#6;     |HAZ FechaBonito;
     #544#75 = eaDiaB;
     #544#76 = eaMesB;
     #544#77 = eaAnyoB;
     #544#78 = &13 + &10;

     |SI #0#32 = "L";
         #544#7  = "";
         #544#69 = "";
         #544#70 = "";
         #544#71 = "";
         #544#72 = "";
         #544#73 = "";
         #544#74 = "";
         nTCampo = 78;
     |FINSI;

     |SI #0#32 = "F";
         || Esto es porque dicen que en internet no lo quiere a
         || cero.

         |SI #544#23 = "0000";  #544#23 = "    ";  |FINSI;
         |SI #544#26 = "0000";  #544#26 = "    ";  |FINSI;
         |SI #544#29 = "0000";  #544#29 = "    ";  |FINSI;
         |SI #544#32 = "000";   #544#32 = "   ";   |FINSI;
         |SI #544#35 = "000";   #544#35 = "   ";   |FINSI;
         |SI #544#38 = "000";   #544#38 = "   ";   |FINSI;

         #544#2  = "";
         #544#3  = "";
         #544#5  = "";
         #544#8  = "";
         #544#9  = "";
         #544#10 = "";
         #544#11 = "";
         #544#12 = "";
         #544#13 = "";
         #544#14 = "";
         #544#15 = "";
         #544#16 = "";
         #544#17 = "";
         #544#18 = "";
         #544#19 = "";
         #544#75 = "";
         #544#76 = "";
         #544#77 = "";
         #544#78 = "";
         nTCampo = 77;
     |FINSI;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
           nGraba = 0;
           |SI #0#4 = 4;  |Y #0#2 = 2007;  |Y nCampo = 63;  |Y #0#32 = "F";
               nGraba = 1;
           |FINSI;

           |SI nGraba = 0;
               aAlfa = #544nCampo;
               |XGRABA nHandle2, aAlfa;
           |FINSI;
     |SIGUE;
     |XCIERRA nHandle2;

     |SI #0#32 = "L";
         |HAZ CargaImprime;
     |FINSI;

     nSwHay = 1;
|FPRC;

|PROCESO TDeclaracion_2008;
     |SI t_dev ! 0;
         |SI #4#5 ! "          ";
             #552#51 = #4#2;
             #552#52 = #4#3;
             #552#53 = #4#4;
             #552#54 = #4#5;
         |FINSI;
     |FINSI;

     #552#55 = "0";
     |SI t_ing ! 0;
         #552#55 = "1";
         |SI #0#35 = "S";  |O #0#35 = "D";
             |SI #4#5 ! "          ";
                 |SI #0#35 = "S";  #552#55 = "2";  |FINSI;
                 |SI #0#35 = "D";  #552#55 = "3";  |FINSI;

                 #552#57 = #4#2;
                 #552#58 = #4#3;
                 #552#59 = #4#4;
                 #552#60 = #4#5;
             |FINSI;
         |FINSI;
     |FINSI;

     #552#4 = "";
     |SI #0#32 ! "F";
         |SI t_venta = 0;  |Y t_compr = 0;
             #552#4 = "N";
         |FINSI;
     |SINO;
         |SI t_com ! 0;  #552#4 = "C";  |FINSI;
         |SI t_dev ! 0;  #552#4 = "D";  |FINSI;
         |SI t_ing ! 0;
                                                   #552#4 = "I";

             |SI  #0#35 = "A";                     #552#4 = "A";  |FINSI;
             |SI  #0#35 = "E";                     #552#4 = "E";  |FINSI;
             |SI  #552#55 = "3";  |Y #0#35 = "D";  #552#4 = "U";  |FINSI;
         |FINSI;

         |SI t_venta = 0;  |Y t_compr = 0; |Y compe = 0;
             #552#4 = "N";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Carga300_2008;
     |SI #0#32 = "L";
         aAbre = "\MODELOS\300\" + "300" + (("00000" + #2#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |SI #0#32 = "F";
         aAbre = eaInternet + "300" + (("00000" + #2#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |ABRE #50;
     #50#0 = #2#0;
     |LEE 000#50=;
     |SI FSalida ! 0;  |DDEFECTO #50;  |FINSI;
     |CIERRA #50;

     |DDEFECTO #552;

     #552#1   = "300";
     #552#2   = "01";
     #552#3   = "";

     #552#5   = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);
     aAlfa    = #2#1;  |QBF aAlfa;
     #552#6   = ("000000000" + aAlfa) % -109;
     #552#7   = #50#2;
     eaAlfa   = #2#2;    |HAZ QuitaRaros;     #552#8   = eaAlfa;
     #552#9   = ".";
     #552#10  = #0#2;
     #552#11  = #0#4 + "T";

     enNume  = base1;       |HAZ Conver13;   #552#12 = eaAlfa;
     enNume  = tipo1 * 100; #552#13 = ("0000" + enNume) % -104;
     enNume  = cuota1;      |HAZ Conver13;   #552#14 = eaAlfa;

     enNume  = base2;       |HAZ Conver13;   #552#15 = eaAlfa;
     enNume  = tipo2 * 100; #552#16 = ("0000" + enNume) % -104;
     enNume  = cuota2;      |HAZ Conver13;   #552#17 = eaAlfa;

     enNume  = base3;       |HAZ Conver13;   #552#18 = eaAlfa;
     enNume  = tipo3 * 100; #552#19 = ("0000" + enNume) % -104;
     enNume  = cuota3;      |HAZ Conver13;   #552#20 = eaAlfa;

     enNume  = base4;       |HAZ Conver13;   #552#21 = eaAlfa;
     enNume  = tipo4 * 100; #552#22 = ("0000" + enNume) % -103;
     enNume  = cuota4;      |HAZ Conver13;   #552#23 = eaAlfa;

     enNume  = base5;       |HAZ Conver13;   #552#24 = eaAlfa;
     enNume  = tipo5 * 100; #552#25 = ("0000" + enNume) % -103;
     enNume  = cuota5;      |HAZ Conver13;   #552#26 = eaAlfa;

     enNume  = base6;       |HAZ Conver13;   #552#27 = eaAlfa;
     enNume  = tipo6 * 100; #552#28 = ("0000" + enNume) % -103;
     enNume  = cuota6;      |HAZ Conver13;   #552#29 = eaAlfa;

     enNume  = base7;       |HAZ Conver13;  #552#30 = eaAlfa;
     enNume  = cuota7;      |HAZ Conver13;  #552#31 = eaAlfa;
     enNume  = t_venta;     |HAZ Conver13;  #552#32 = eaAlfa;

     enNume  = ivade1;      |HAZ Conver13;  #552#33 = eaAlfa;
     enNume  = ivade2;      |HAZ Conver13;  #552#34 = eaAlfa;
     enNume  = ivade5;      |HAZ Conver13;  #552#35 = eaAlfa;
     enNume  = ivade3;      |HAZ Conver13;  #552#36 = eaAlfa;
     enNume  = ivade4;      |HAZ Conver13;  #552#37 = eaAlfa;
     enNume  = ivade6;      |HAZ Conver13;  #552#38 = eaAlfa;
     enNume  = t_compr;     |HAZ Conver13;  #552#39 = eaAlfa;

     enNume  = dife;        |HAZ Conver13;  #552#40 = eaAlfa;
     enNume  = atri * 100;                  #552#41 = ("00000" + enNume) % -105;
     enNume  = atribu;      |HAZ Conver13;  #552#42 = eaAlfa;
     enNume  = compe;       |HAZ Conver13;  #552#43 = eaAlfa;
     enNume  = entrega;     |HAZ Conver13;  #552#44 = eaAlfa;
     enNume  = sujet;       |HAZ Conver13;  #552#45 = eaAlfa;
     enNume  = total;       |HAZ Conver13;  #552#46 = eaAlfa;
     enNume  = 0;           |HAZ Conver13;  #552#47 = eaAlfa;
     enNume  = total;       |HAZ Conver13;  #552#48 = eaAlfa;
     enNume  = t_com;       |HAZ Conver13;  #552#49 = eaAlfa;
     enNume  = t_dev;       |HAZ Conver13;  #552#50 = eaAlfa;
     enNume  = t_ing;       |HAZ Conver13;  #552#56 = eaAlfa;

     |HAZ TDeclaracion_2008;

     eaAlfa  = #2#2;     |HAZ QuitaRaros;     #552#63  = eaAlfa;
     eaAlfa  = #2#14;    |HAZ QuitaRarosTfno; #552#64  = eaAlfa;

     eaAlfa  = #0#6;     |HAZ FechaBonito;
     #552#70 = eaDiaB;
     #552#71 = eaMesB;
     #552#72 = eaAnyoB;
     #552#73 = &13 + &10;

     |SI #0#32 = "L";
         #552#7  = "";
         #552#61 = "";
         #552#63 = "";
         #552#64 = "";
         #552#65 = "";
         #552#66 = "";
         #552#67 = "";
         #552#68 = "";
         nTCampo = 73;
     |FINSI;

     |SI #0#32 = "F";
         |SI #552#13 = "0000";  #552#13 = "    ";  |FINSI;
         |SI #552#16 = "0000";  #552#16 = "    ";  |FINSI;
         |SI #552#19 = "0000";  #552#19 = "    ";  |FINSI;
         |SI #552#22 = "000";   #552#22 = "   ";   |FINSI;
         |SI #552#25 = "000";   #552#25 = "   ";   |FINSI;
         |SI #552#28 = "000";   #552#28 = "   ";   |FINSI;

         #552#2  = "";
         #552#3  = "";
         #552#5  = "";
         #552#8  = "";
         #552#9  = "";
         #552#69 = "";
         #552#70 = "";
         #552#71 = "";
         #552#72 = "";
         #552#73 = "";
         nTCampo = 72;
     |FINSI;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #552nCampo;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;
     |XCIERRA nHandle2;

     |SI #0#32 = "L";
         |HAZ CargaImprime;
     |FINSI;

     nSwHay = 1;
|FPRC;

|PROCESO impresio;
     #3#0 = #2#18; #3#1 = #2#19;
     |LEE 040#3=;
     |SI FSalida ! 0; |DDEFECTO #3; |FINSI;

     #4#0 = #2#0;
     |LEE 040#4=;
     |SI FSalida ! 0; |DDEFECTO #4; |FINSI;

     |SI #6#26 ! "T"; |Y #6#26 ! "M"; #6#26 = "T"; |FINSI;

     |SI #0#32 ! "L"; |Y #0#32 ! "F";
         |PRINT; |PIEINF;
     |SINO;
         |SI #0#2 [ 2001;
             |SI #0#32 = "L";
                 |HAZ Secuencial300;
             |FINSI;

             |SI #0#32 = "F";
                 |HAZ Internet300;
             |FINSI;
         |FINSI;

         |SI #0#2 ] 2002;  |Y #0#2 [ 2007;
             |HAZ Carga300_2002;
         |FINSI;

         |SI #0#2 ] 2008;
             |HAZ Carga300_2008;
         |FINSI;
     |FINSI;

     |SI #0#32 = "B"; |ACABA; |FINSI;

     |SI #0#32 ! "O";  |Y #0#32 ! "B";
         |SI EURODB = 0;  |Y #0#34 = "EUROS  ";
             total = ((total / 100) * 166.386) ! 0;
         |FINSI;

         |SI EURODB ! 0;  |Y #0#34 = "PESETAS";
             total = (total / 166.386) ! 2;
         |FINSI;
     |FINSI;

     aAlfa    = #0#2 % -102;
     se_empre = #2#0;
     se_ejerc = aAlfa;
     se_perio = #0#4;
     se_tipos = 300;
     se_activ = 10;
     se_impor = total;
     |SI #0#32 ! "O";  |Y #0#32 ! "B";
         |SI enSwTrata = 0;  se_impor = se_impor /  100;  |FINSI;
     |FINSI;
     se_fecha = #0#6;
     se_factu = "N";
     |HAZ seguimie;
     |HAZ AlAgicli;
|FPRC;

|PROCESO limpia;
     Ibase = base1 <-;
     Itipo = tipo1 <-;
     Icuota = cuota1 <-;
     |PARA inf = 1;|SI inf [ 6; |HACIENDO inf = inf + 1;
           base = 0;
           tipo = 0;
           cuota = 0;
           Ibase = Ibase + 1;
           Itipo = Itipo + 1;
           Icuota = Icuota + 1;
     |SIGUE;
     Ibase = base7 <-;
     Icuota = cuota7 <-;
     base = 0;
     cuota = 0;

     Iivade = ivade1 <-;
     |PARA inf = 1;|SI inf [ 6; |HACIENDO inf = inf + 1;
           ivade = 0;
           Iivade = Iivade + 1;
     |SIGUE;
     cont = 0;
     atri = 0;
     compe = 0;
     sujet = 0;
     t_venta = 0;
     t_compr = 0;
     dife = 0;
     atribu = 0;
     total = 0;
     t_ing = 0;
     t_com = 0;
     t_dev = 0;
     entrega = 0;
|FPRC;

|DEFBUCLE eosem301;
     #5#1;
     4;
     #2#0, 1, #0#4, nAnyo2D, "N";
     #2#0, 6, #0#4, nAnyo2D, "N";
     be;
     NULL, calcula;
|FIN;

|DEFBUCLE eosem302;
     #5#1;
     4;
     #2#0, 1, #0#4, nAnyo2D, "N";
     #2#0, 6, #0#4, nAnyo2D, "N";
     be;
     NULL, impre92;
|FIN;

|PROCESO miraempr;
     sw     = 0;
     sw_hay = 0;
     varii  = 0;
     varic  = 0;
     |BUCLE eosem301;
     varib = varii - varic;

     |SI sw_hay = 0; |ACABA; |FINSI;

     nActiv = 1;
     |BUCLE eosem302;
     |SI sw = 1;
         |HAZ totalimp;
         |HAZ impresio;
         |HAZ limpia;
     |FINSI;
|FPRC;

|DEFBUCLE eosclienC;
     #2#1;
     60;
     #0#0, "N";
     #0#1, "N";
     e;
     NULL, miraempr;
|FIN;

|DEFBUCLE eosclienN;
     #2#3;
     0, 60;
     Vacio40, #0#0, "N";
     LLeno40, #0#1, "N";
     e;
     NULL, miraempr;
|FIN;

|PROCESO mes;
     |SI mes = "01"; mes = "Enero     "; |FINSI;
     |SI mes = "02"; mes = "Febrero   "; |FINSI;
     |SI mes = "03"; mes = "Marzo     "; |FINSI;
     |SI mes = "04"; mes = "Abril     "; |FINSI;
     |SI mes = "05"; mes = "Mayo      "; |FINSI;
     |SI mes = "06"; mes = "Junio     "; |FINSI;
     |SI mes = "07"; mes = "Julio     "; |FINSI;
     |SI mes = "08"; mes = "Agosto    "; |FINSI;
     |SI mes = "09"; mes = "Septiembre"; |FINSI;
     |SI mes = "10"; mes = "Octubre   "; |FINSI;
     |SI mes = "11"; mes = "Noviembre "; |FINSI;
     |SI mes = "12"; mes = "Diciembre "; |FINSI;
     mes = mes > mes;
|FPRC;

|PROCESO Impresora;
     |IMPRE 0;
     |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;

     |SI #0#32 = "O";
         |INFOR "eosem300";
         |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;
         |HAZ i_cuadre;
     |SINO;
         |INFOR "eoseb300";
         |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;
     |FINSI;

     dia = #0#6 % 102;
     mes = #0#6 % 402;
     |HAZ mes;
     anyo = #0#6 % 704;

     |ABRE #3;
     |ABRE #4;
     |SI #0#7 = "S";
         |SI #0#33 = "C"; |BUCLE eosclienC; |FINSI;
         |SI #0#33 = "N"; |BUCLE eosclienN; |FINSI;
     |SINO;
         |ABRE #2;
         |PARA aa = 8; |SI aa [ 31; |HACIENDO aa = aa + 1;
               |SI #0aa ! 0;
                    #2#0 = #0aa;
                    |LEE 040#2=;
                    |SI FSalida = 0; |Y #2#60 = "N";
                        |HAZ miraempr;
                    |FINSI;
               |FINSI;
         |SIGUE;
         |CIERRA #2;
     |FINSI;

     |FININF;
     |FINIMP;

     |CIERRA #3;
     |CIERRA #4;
|FPRC;

|PROCESO AbreImprime;
     aAbre = "\MODELOS\300\imprime.bat";
     |XABRE "CBW", aAbre, nHandle1;

     aAlfa = "CD \" + &13 + &10;                 |XGRABA nHandle1, aAlfa;
     aAlfa = "CD MODELOS" + &13 + &10;           |XGRABA nHandle1, aAlfa;
     aAlfa = "CD 300" + &13 + &10;               |XGRABA nHandle1, aAlfa;

     aAlfa = #0#2;
     aAlfa = aAlfa % -102;
     aVersion = "";

     |SI #0#2 ] 2008;
         aVersion = "01";
         |SI #0#2 = 2008;
             |SI #0#4 ] 2;
                 aVersion = "02";
             |FINSI;
         |FINSI;
     |FINSI;

     aAlfa1 = "DEL ERRORES.RST" + &13 + &10;      |XGRABA nHandle1, aAlfa1;

     aContiene = "";
     |ESPECIFICA "RBASS", aContiene;
     aUnidad = (aContiene1 % 102) > "";

     |SI aVersion = "";
         aAlfa = "ZLS" + aAlfa + "MPF.EXE /T:" + aUnidad + "\MODELOS\300\"+ &13 + &10;
     |SINO;
         aAlfa = "Z" + aAlfa + aVersion + "MPF.EXE /T:" + aUnidad + "\MODELOS\300\"+ &13 + &10;
     |FINSI;

     |XGRABA nHandle1, aAlfa;

     |SI #0#2 ] 2002;
         aAlfa = "MOVE ERRORM~1.TXT ERRORMIPF.TXT" + &13 + &10;      |XGRABA nHandle1, aAlfa;
         aAlfa = "MOVE EAN128~1.DLL EAN128_32.DLL" + &13 + &10;      |XGRABA nHandle1, aAlfa;
     |FINSI;
|FPRC;

|PROCESO EmiteEsto;
     aAlfa = "DEL *.wmf" + &13 + &10;             |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.tab"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.dll"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errorm~1.txt" + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errormipf.txt"  + &13 + &10;    |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errmipf.txt"  + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.exe"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     |XCIERRA nHandle1;

     eaModelos = "300";    |HAZ Copiampf;

     aAlfa = "\MODELOS\300\IMPRIME";
     |RSYSTEM aAlfa;
|FPRC;

|PROCESO Laser;
     |SI #0#2 ] 2002;
         |SI #0#32 = "L";
             |PARA;  |SI;  |HACIENDO;
                  |DDEFECTO #601;
                  |PINPA #0#601;
                  |PINDA #0#601;
                  |ENDATOS #1#601;
                  |SI FSalida = 0;
                      aAlfa = "/MODELOS";          |RMKDIR aAlfa;
                      aAlfa = "/MODELOS/300";      |RMKDIR aAlfa;
                      |HAZ AbreImprime;
                      |SAL;
                  |FINSI;
             |SIGUE;
         |FINSI;

         |SI #0#32 = "F";
             aAlfa      = "/AEAT";                       |RMKDIR aAlfa;
             aAlfa      = "/AEAT/INTERNET";              |RMKDIR aAlfa;
             aAlfa      = "/AEAT/INTERNET/300";          |RMKDIR aAlfa;
             aAlfa      = "/AEAT/INTERNET/300/" + #0#2;  |RMKDIR aAlfa;
             eaInternet = aAlfa + "/";
         |FINSI;
     |FINSI;

     nSwHay = 0;

     dia = #0#6 % 102;
     mes = #0#6 % 402;
     |HAZ mes;
     anyo = #0#6 % 704;

     |ABRE #3;
     |ABRE #4;
     |SI #0#7 = "S";
         |SI #0#33 = "C"; |BUCLE eosclienC; |FINSI;
         |SI #0#33 = "N"; |BUCLE eosclienN; |FINSI;
     |SINO;
         |ABRE #2;
         |PARA aa = 8; |SI aa [ 31; |HACIENDO aa = aa + 1;
               |SI #0aa ! 0;
                    #2#0 = #0aa;
                    |LEE 040#2=;
                    |SI FSalida = 0; |Y #2#60 = "N";
                        |HAZ miraempr;
                    |FINSI;
               |FINSI;
         |SIGUE;
         |CIERRA #2;
     |FINSI;

     |CIERRA #3;
     |CIERRA #4;

     |SI #0#32 = "L";
         |SI #0#2 [ 2001;
             |HAZ GrabaDisketteL;
         |FINSI;

         |SI #0#2 ] 2002;
             |SI nSwHay = 1;
                 |HAZ EmiteEsto;
                 eaTipoSec = "300";
                 eaTipoEmi = "ERRORES";
                 enAnyo    = #0#2;
                 |SUB_EJECUTA "eosz9999";
             |SINO;
                 |MENAV "     Seleccion Vacia";
                 |XCIERRA nHandle1;
             |FINSI;

             aAlfa = "\MODELOS\300\imprime.bat";
             |RFBORRA aAlfa;
        |FINSI;
     |FINSI;

     |SI #0#32 = "F";  |Y #0#2 ] 2002;
         |SI nSwHay = 1;
             aAlfa =  "      Ficheros Generados. Situados en " + eaInternet + " de su PC";
             |MENAV aAlfa;
         |SINO;
             |MENAV "     Seleccion Vacia";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO impre;|TIPO 3;
     aAlfa     = #0#2 % -102;
     nAnyo2D   = aAlfa;
     enAnyo    = #0#2;
     enPer     = #0#4;
     enPor100  = 1;
     aTipoSec  = "300";
     eaTipoSec = "300";

     |SI #0#32 = "L"; |O #0#32 = "F"; |HAZ Laser;      |FINSI;
     |SI #0#32 ! "L"; |Y #0#32 ! "F"; |HAZ Impresora;  |FINSI;
|FPRC;

|PROCESO MiraVarMoneda;  |TIPO 0;
     |HAZ PintaMoneda;
     #0#34 = eaMoneda;

     |SI #0#2 [ 2000;
         |SI #0#32 = "L";  |O #0#32 = "F";
             #0#34 = "PESETAS";
         |FINSI;
     |FINSI;

     |SI #0#2 ] 2002;
         |SI #0#34 = "PESETAS";
             |MENAV "     Moneda Erronea.";
             |ERROR;
         |FINSI;
     |FINSI;

     |PINTA #0#34;
|FPRC;

|PROGRAMA;
     |SI SwViene = 1;
         #0#7  = "S";
         #0#0  = VEmpresa;
         #0#1  = VEmpresa;
         |SI VAnyo > 80;
             #0#2  = 1900 + VAnyo;
         |SINO;
             #0#2  = 2000 + VAnyo;
         |FINSI;
         #0#4  = VPeriodo;

         |PARA nCampo = 0;  |SI nCampo [ 34;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
         |SIGUE;
         |C_M #0#6,  1, "S";
         |C_M #0#32, 1, "S";

         |PINPA #0#0;
         |PINDA #0#0;
         |ENDATOS #1#0;
     |SINO;
         |CLS;
         |CABEZA "Emision del 300";
         |PINPA #0#0;
         |PINDA #0#0;
         |ENDATOS #1#0;
     |FINSI;
|FPRO;
