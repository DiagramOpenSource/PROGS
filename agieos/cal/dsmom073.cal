|FICHEROS;
     dsmom073;

     dsmow164,MANTE;
|FIN;

|VARIABLES;
     nAnyo          = 0;
     nDAnyo         = 0;
     nHAnyo         = 0;
     nTecla         = 0;
     nSalir         = 0;
     nPanta         = 0;
     nBtn1          = 0;

     aFicTmp        = "";
     aAlfa          = "";
|FIN;

|PROCESO Btn1;
     |PTEC 824;
|FPRC;

|PROCESO Baja73;
     #dsmom073#0 = #dsmow164#0;
     #dsmom073#1 = "";
     #dsmom073#2 = "";
|FPRC;

|PROCESO Alta73;
     #dsmom073#0 = #dsmow164#0;
     #dsmom073#1 = "z";
     #dsmom073#2 = "zz";
|FPRC;

|PROCESO Tipo7C0Fw164;  |TIPO 7;
     |ENTLINEAL #1#dsmom073, -2, 7, 22, 0, Baja73, Alta73;
|FPRC;

|PROCESO Tipo0C0Fw164;  |TIPO 0;
     nTecla = FSalida;
     |SI nTecla ! 0;  |ACABA;  |FINSI;

     |LEE 000#dsmow164.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ENTLINEAL #1#dsmom073, -2, 2, 22, 0, Baja73, Alta73;
|FPRC;

|PROCESO dsmom073C;
     #dsmom073#0 = nAnyo;
     |GRABA 000#dsmom073.n;

|FPRC;

|DEFBUCLE dsmom073C;
     #dsmom073#1;
     ;
     nHAnyo, " ", "  ";
     nHAnyo, "z", "zz";
     ;
     NULL, dsmom073C;
|FIN;

|PROCESO Tipo11C0Fw164;  |TIPO 11;
     |SI FSalida ! 10;  |ACABA; |FINSI;

     |CONFI "0000NSeguro que quiere crear un nuevo ejercicio";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PUSHV 1424 1742;
     |BLANCO 1424 1742;
     |CUADRO 1424 1742;

     |ATRI R;
     |PINTA 1525, "    Ejercicio    ";
     |ATRI 0;

     nAnyo = nHAnyo + 1;
     E_inf = nAnyo;
     E_sup = 2999;

     nAnyo  = 1632 ? 1;

     |POPV;

     aAlfa = "0000NSeguro que quiere crear el ejercicio " + nAnyo;
     |CONFI aAlfa;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BUCLE dsmom073C;

     nHAnyo = nAnyo;

     #dsmow164#0  = nAnyo;
     |GRABA 000#dsmow164.n;

     |ERROR;

     nSalir = 1;
     |PTEC 807;
|FPRC;

|PROCESO Baja164;
     #dsmow164#0 = nDAnyo;
|FPRC;

|PROCESO Alta164;
     #dsmow164#0 = nHAnyo;
|FPRC;

|PROGRAMA;
     |CLS;
     |CABEZA "Claves perceptoras 190";

     |PINPA #0#dsmom073; nPanta = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,F2 Nuevo Ejercicio", 0570, 0579, Btn1;
     nBtn1 = FSalida;

     |PARA;  |SI;  |HACIENDO;
          nSalir = 0;
          |ENTLINEAL #1#dsmow164, -1, 4, 22, 0, Baja164, Alta164;
          |SI nSalir = 0;  |SAL;  |FINSI;
     |SIGUE;
|FPRO;

|PROCESO Tipo80;  |TIPO 80;
     aFicTmp = "dsmow164" + Usuario;
     |NOME_DAT #dsmow164#aFicTmp#;
     |ABRE #dsmow164;  |CIERRA #dsmow164;  |DELINDEX #dsmow164;

     |ABRET #dsmow164;
     |ABRET #dsmom073;

     |LEE 000#dsmom073.u;
     |SI FSalida ! 0;  |DDEFECTO #dsmom073;  |FINSI;

     nDAnyo = 0;
     nHAnyo = #dsmom073#0;
     |PARA nAnyo = 2001;  |SI nAnyo [ nHAnyo;  |HACIENDO nAnyo = nAnyo + 1;
           #dsmom073#0 = nAnyo;
           #dsmom073#1 = "";
           #dsmom073#2 = "";
           |LEE 000#dsmom073.];
           |SI FSalida = 0;  |Y  #dsmom073#0 = nAnyo;
               |SI nDAnyo = 0;
                   nDAnyo = #dsmom073#0;
               |FINSI;

               #dsmow164#0  = #dsmom073#0;
               |GRABA 000#dsmow164.n;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Tipo90;  |TIPO 90;
     |CIERRAT #dsmom073;
     |CIERRAT #dsmow164;
     |DELINDEX #dsmow164;

     |FIN_CONTROL_WINDOWS nBtn1;
|FPRC;
