|FICHEROS;
     eosm1300 #0;
     eosclien #2;
     eosaplic #4;
     eosactiv #5;
     eosopesp #7;
     eosw0052 #98,MANTE;
|FIN;

|VARIABLES;
   &sw_sit     = 1;
   &d_empre    = 0;
   &h_empre    = 0;
   &el_anyo    = 0;
   &SwViene    = 1;
   &VEmpresa   = 0;
   &VPeriodo   = 0;
   &VAnyo      = 0;

   i_campo  = 0;
   cont     = 0;
   empresa  = 0;
   trime    = 0;
   anyo     = 0;
   activi   = 0;
   compen   = 0;
   base     = 0;
   tipo     = 0;
   total    = 0;
   rendi1   = 0;
   rendi2   = 0;
   penult   = 0;
   estado   = 0;
   ventas   = 0;
   x        = 0;
   camp     = 0;
   xxxxfiac = "  ";
   xxaponer = "  ";
   xrelleno = "                              ";
   modifica = 0;
   FEstado  = 0;
   modo     = 0;
   nError   = 0;
   aTipo    = "";
|FIN;

|INCLUYE i_seguim;
|INCLUYE i_devolv;
|INCLUYE i_period;

|PROCESO borrado; |TIPO 2;
modo = (FEntrada / 100) ! 0;
|SI modo ! 3; |ACABA; |FINSI;

|ABRE #7;
#7#0 = #0#0;
#7#1 = #0#45;
#7#2 = #0#1;
#7#3 = #0#2;
|BORRA 140#7c;
|LIBERA #7;
|CIERRA #7;
|FPRC;

|PROCESO i_archiv; |TIPO 7;
|SI #0#4 = "S";
    |MENAV "     Registro archivado, DESARCHIVELO";
    |PTEC 807;
|FINSI;
|FPRC;

|PROCESO antes; |TIPO 7;
i_campo = 1;
|FPRC;

|PROCESO empresa; |TIPO 0;
i_campo = 0;
|ABRE #2;
#2#0 = #0#0;
|LEE 040#2=;
|SI FSalida ! 0;
  |MENAV "     No existe Empresa.";
  |ERROR;
|SINO;
   #0#2  = #2#20;|PINTA #0#2;
   cont = (FEntrada / 100) ! 0;
   |SI cont = 1;
       |ABRE #4;
       |LEE 040#4p;
       |SI FSalida = 0;
           #0#6  = #4#1; |PINTA #0#6;
           #0#9  = #4#2; |PINTA #0#9;
           #0#12 = #4#3; |PINTA #0#12;
           #0#15 = #4#4; |PINTA #0#15;
           #0#18 = #4#5; |PINTA #0#18;
           #0#47 = #4#6; |PINTA #0#47;
           #0#59 = #4#13;
           #0#62 = #4#14;
           #0#65 = #4#15;
       |FINSI;
       |CIERRA #4;
   |FINSI;
|FINSI;
|CIERRA #2;
|FPRC;

|PROCESO pinta_porr; |TIPO 13;
|ABRE #5;
#5#0 = #0#0;
#5#1 = #0#45;
#5#2 = #0#2;
|LEE 040#5=;
|SI FSalida ! 0; |DDEFECTO #5; |FINSI;
|CIERRA #5;
|PINTA 670, #5#28;
|FPRC;

|PROCESO activida; |TIPO 0;
|SI i_campo = 1; |ACABA; |FINSI;
|ABRE #5;
#5#0 = #0#0;
#5#1 = #0#45;
#5#2 = #0#2;
|LEE 040#5=;
|SI FSalida ! 0;
    |MENAV "    No existe Actividad.";
    |ERROR;
|SINO;
    |SI #5#14 = "S";
       |MENAV "    La Actividad es un Comunero";
       |ERROR;
    |FINSI;

    |SI #5#22 = "A";
       |MENAV "    La Actividad es de Modulos";
       |ERROR;
    |FINSI;
|FINSI;
|CIERRA #5;
|FPRC;

|PROCESO DfectoPeriodo; |TIPO 7;
#0#1 = Periodo;
|PINTA #0#1;
|FPRC;

|PROCESO periodo; |TIPO 0;
aTipo = #5#26;
|SI aTipo = "F";  aTipo = "T";  |FINSI;

|SI aTipo = "T"; |Y #0#1 > 4;
    |MENAV "     El 300 esta preparado como Trimestral";
    |ERROR;
|FINSI;
|FPRC;

|PROCESO anyopas; |TIPO 7;
cont = (FEntrada / 100) ! 0;
|SI cont = 1;
    |SI #0#1 = 1;
        |ABRE #5;
        #5#0 = #0#0;
        #5#1 = #0#45;
        #5#2 = #0#2 - 1;
        |SI #5#2 < 0;  #5#2 = 99;  |FINSI;
        |LEE 040#5=;
        |SI FSalida ! 0; |DDEFECTO #5; |FINSI;
        #0#29 = #5#34;

        #5#0 = #0#0;
        #5#1 = #0#45;
        #5#2 = #0#2;
        |LEE 040#5=;
        |SI FSalida ! 0; |DDEFECTO #5; |FINSI;

        |CIERRA #5;
    |SINO;
        empresa = #0#0;
        trime   = #0#1;
        anyo    = #0#2;
        activi  = #0#45;

        |DDEFECTO #0;
        #0#0    = empresa;
        #0#1    = trime - 1;
        #0#2    = anyo;
        #0#45   = activi;
        compen  = 0;
        |LEE 040#0=;
        |SI FSalida = 0;
            |SI #0#55 < 0; compen = -#0#55; |FINSI;
        |FINSI;
        |DDEFECTO #0;
        #0#0    = empresa;
        #0#1    = trime;
        #0#2    = anyo;
        #0#45   = activi;
        |LEE 040#0=;
        |SI FSalida ! 0;
            |DDEFECTO #0;
            #0#0 = empresa;
            #0#1 = trime;
            #0#2 = anyo;
            #0#45 = activi;
        |FINSI;
        #0#29   = compen;
        |PINTA #0#0;
        |PINTA #0#1;
        |PINTA #0#45;
        |PINTA #0#2;
   |FINSI;
|FINSI;
|FPRC;

|PROCESO modifica; |TIPO 0;
modifica = 0;
|SI #0Campo ! Contenido; modifica = 1; |FINSI;
|FPRC;

|PROCESO cuota1; |TIPO 7;
|SI modifica = 0; |ACABA; |FINSI;
     base = Campo - 2;
     tipo = Campo - 1;
     #0Campo = #0base % #0tipo;
     |PINTA #0Campo;
|FPRC;

|PROCESO sumacuot; |TIPO 0;
     #0#20 = #0#7 + #0#10 + #0#13 + #0#16 + #0#19 + #0#48 + #0#50;
     |PINTA #0#20;
     |HAZ especifi;
     |HAZ atribuir;
     |HAZ total;
|FPRC;

|PROCESO cuota2; |TIPO 0;
     #0#25 = #0#21 + #0#22 + #0#23 + #0#24 + #0#43 + #0#44 + #0#51+ #0#78 + #0#80;
     |PINTA #0#25;
     |HAZ atribuir;
     |HAZ total;
|FPRC;

|PROCESO atribuir; |TIPO 0;
    #0#26 = #0#20 - #0#25;
    |PINTA #0#26;
    #0#28 = #0#26 % #0#27;
    |PINTA #0#28;
|FPRC;

|PROCESO total; |TIPO 0;
total = #0#28 - #0#29 + #0#30;

|SI total = 0; #0#33 = 0; #0#32 = 0; #0#31 = 0; |FINSI;
|SI total > 0;
    #0#33 = total;
    #0#31 = 0;
    #0#32 = 0;
    |PINTA #0#31;
    |PINTA #0#32;
    |PINTA #0#33;
|SINO;
    total = total * (-1);
    |SI #0#1 ! 4;
       #0#32 = total;
       #0#31 = 0;
       #0#33 = 0;
       |PINTA #0#31;
       |PINTA #0#32;
       |PINTA #0#33;
    |SINO;
       |SI #5#27 = "C";
           #0#32 = total;
           #0#31 = 0;
           #0#33 = 0;
           |PINTA #0#31;
           |PINTA #0#32;
           |PINTA #0#33;
       |FINSI;
       |SI #5#27 = "D";
          #0#32 = 0;
          #0#33 = 0;
          #0#31 = total;
          |PINTA #0#31;
          |PINTA #0#32;
          |PINTA #0#33;
       |FINSI;
    |FINSI;
|FINSI;
|HAZ especifi;
|FPRC;

|PROCESO especifi; |TIPO 0;
|ABRE #7;
#7#0 = #0#0;
#7#1 = #0#45;
#7#2 = #0#1;
#7#3 = #0#2;
|LIBERA #7;
|LEE 140#7=;
FEstado = FSalida;
|SI FSalida ! 0; |CDEFECTO #7, 1; |FINSI;

#7#7  = #0#54;
||#7#12 = #0#49;

|SI FEstado = 0; |GRABA 140#7a; |SINO; |GRABA 140#7n; |FINSI;
|CIERRA #7;
|FPRC;

|PROCESO totales; |TIPO 3;
#0#20 = #0#7 + #0#10 + #0#13 + #0#16 + #0#19 + #0#48 + #0#50;
#0#25 = #0#21 + #0#22 + #0#23 + #0#24 + #0#43 + #0#44 + #0#51 + #0#78 + #0#80;
#0#26 = #0#20 - #0#25;

total = #0#28 - #0#29 + #0#30;
|SI total = 0;
    #0#33 = 0;
    #0#31 = 0;
    #0#32 = 0;
|FINSI;
|SI total > 0;
    #0#33 = total;
    #0#31 = 0;
    #0#32 = 0;
|SINO;
    total = total * (-1);
    |SI #0#1 ! 4;
       #0#32 = total;
       #0#31 = 0;
       #0#33 = 0;
    |SINO;
       |SI #5#27 = "C"; #0#32 = total; #0#31 = 0; #0#33 = 0; |FINSI;
       |SI #5#27 = "D"; #0#31 = total; #0#32 = 0; #0#33 = 0; |FINSI;
    |FINSI;
|FINSI;

|ABRE #5;
#5#0 = #0#0;
#5#1 = #0#45;
#5#2 = #0#2;
|LIBERA #5;
|LEE 140#5=;
|SI FSalida = 0;
    |SI #0#1 = 1; #5#30 = #0#5 + #0#8 + #0#11; |FINSI;
    |SI #0#1 = 2; #5#31 = #0#5 + #0#8 + #0#11; |FINSI;
    |SI #0#1 = 3; #5#32 = #0#5 + #0#8 + #0#11; |FINSI;
    |SI #0#1 = 4; #5#33 = #0#5 + #0#8 + #0#11; |FINSI;

    #5#34 = 0;
    |SI #0#1 = 4; |O #0#1 = 12;
       |SI #0#55 < 0;
           |SI #5#27 = "C"; #5#34 = -#0#55; |FINSI;
       |FINSI;
    |FINSI;
    |GRABA 140#5a;
|FINSI;
|CIERRA #5;
|FPRC;

|PROCESO graba130; |TIPO 30;
se_empre = #0#0;
se_ejerc = #0#2;
se_perio = #0#1;
se_tipos = 300;
se_activ = #0#45;
se_impor = 0;
|SI #0#33 > 0; se_impor =  #0#33; |FINSI;
|SI #0#32 > 0; se_impor = -#0#32; |FINSI;
|SI #0#31 > 0; se_impor = -#0#31; |FINSI;
se_fecha = #0#3;
se_factu = "";
|HAZ seguimie;

|SI #0#1 = 4;
    |SI #0#2 [ 80; |O #0#2 ] 96;
        |CONFI "2400NDesea hacer el pase del Resumen Anual y Consultarlo : ";
        |SI FSalida ! 0; |ACABA; |FINSI;

        |LIBERA #0;
        |CIERRAT #0;
        |SALVA_DATOS #0;
        d_empre  = #0#0;
        h_empre  = #0#0;
        el_anyo  = #0#2;
        VEmpresa = #0#0;
        VPeriodo = #0#1;
        VAnyo    = #0#2;

        |SUB_EJECUTA "eosem300";
        |SUB_EJECUTA "eosp2390";
        |SUB_EJECUTA "eosm3390";

        |ABRET #0;
        |REPON_DATOS #0;
        |LIBERA #0;
        |LEE 140#0=;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO funcion_9; |TIPO 0;
|SI FSalida = 10;
    |PUSHV 0501 2380;
    |ABRE #7;
    #7#0 = #0#0;
    #7#1 = #0#45;
    #7#2 = #0#1;
    #7#3 = #0#2;
    |LIBERA #7;
    |LEE 140#7=;
    FEstado = FSalida;
    |SI FSalida ! 0; |CDEFECTO #7, 1; |FINSI;
    |PINPA #0#7;
    |PINDA #0#7;
    |ENDATOS #1#7;
    |SI FSalida = 0;
        |SI FEstado = 0; |GRABA 140#7a; |SINO; |GRABA 140#7n; |FINSI;
    |FINSI;
    |CIERRA #7;
    |POPV;
|FINSI;

|SI FSalida ! 9;             |ACABA; |FINSI;
|SI #0#1  ! 4;               |ACABA; |FINSI;
|SI #0#31 = 0; |Y #0#32 = 0; |ACABA; |FINSI;

empresa_d = #0#0;
activid_d = #0#45;
anyo_d    = #0#2;
|HAZ Preg_Devol;
|FPRC;

|PROCESO nomodi; |TIPO 7;
|SI cont = 1; |HAZ nomodifi; |FINSI;
|FPRC;

|PROCESO nomodifi;             || RUTINA DE CONVERSION A NO MODIFICABLES
                               || VARIABLES: A_
    xxaponer = Anono;
    xxxxfiac = Control % A1001;
    Control = Control + xxxxfiac;
    Control = Control + xrelleno;
    Control = Control % A120;
    Control = Control + xxaponer;
|FPRC;

|PROCESO PideBase;  |TIPO 0;
  |SI FSalida = 9;
      |PUSHV 0501 2380;

      #98#0  = "ADQUISICIONES 1 ";
      #98#1  = "ADQUISICIONES 2 ";
      #98#2  = "ADQUISICIONES 3 ";
      #98#3  = "";
      #98#4  = #0#58;   #98#5  = #0#59;   #98#6  = #0#60;
      #98#7  = #0#61;   #98#8  = #0#62;   #98#9  = #0#63;
      #98#10 = #0#64;   #98#11 = #0#65;   #98#12 = #0#66;
      #98#13 = #0#67;   #98#14 = #0#68;   #98#15 = #0#69;

      |PINPA #0#98;
      |PINDA #0#98;
      |ENDATOS #1#98;
      |SI FSalida = 0;
          #0#58 = #98#4;   #0#59 = #98#5;   #0#60 = #98#6;
          #0#61 = #98#7;   #0#62 = #98#8;   #0#63 = #98#9;
          #0#64 = #98#10;  #0#65 = #98#11;  #0#66 = #98#12;
          #0#67 = #98#13;  #0#68 = #98#14;  #0#69 = #98#15;

          |CONFI "2400SLo Computamos al IVA Soportado : ";
          |SI FSalida = 0;
               #0#72 = #0#58 + #0#61 + #0#64 + #0#67;
               #0#51 = #0#60 + #0#63 + #0#66 + #0#69;
          |FINSI;
      |FINSI;
      |POPV;
  |FINSI;

  #0#49 = #0#58 + #0#61 + #0#64 + #0#67;  |PINTA #0#49;
  #0#50 = #0#60 + #0#63 + #0#66 + #0#69;  |PINTA #0#50;
|FPRC;

|PROCESO PideBaseSopor;  |TIPO 0;
     |SI FSalida ! 9;  |ACABA;  |FINSI;

     |PUSHV 0501 2380;

     |DDEFECTO #98;
     #98#0  = "LINEA 1 ........";
     #98#1  = "LINEA 2 ........";
     #98#2  = "LINEA 3 ........";
     #98#3  = "LINEA 4 ........";

     |PINPA #0#98;
     |PINDA #0#98;
     |ENDATOS #1#98;
     nError = FSalida;
     |POPV;

     |SI nError = 0;
         |SI Campo = 70;
             #0#70 = #98#4 + #98#7 + #98#10 + #98#13;   |PINTA #0#70;
             #0#21 = #98#6 + #98#9 + #98#12 + #98#15;   |PINTA #0#21;
         |FINSI;

         |SI Campo = 71;
             #0#71 = #98#4 + #98#7 + #98#10 + #98#13;   |PINTA #0#71;
             #0#22 = #98#6 + #98#9 + #98#12 + #98#15;   |PINTA #0#22;
         |FINSI;

         |SI Campo = 72;
             #0#72 = #98#4 + #98#7 + #98#10 + #98#13;   |PINTA #0#72;
             #0#51 = #98#6 + #98#9 + #98#12 + #98#15;   |PINTA #0#51;
         |FINSI;

         |SI Campo = 73;
             #0#73 = #98#4 + #98#7 + #98#10 + #98#13;   |PINTA #0#73;
             #0#23 = #98#6 + #98#9 + #98#12 + #98#15;   |PINTA #0#23;
         |FINSI;

         |SI Campo = 74;
             #0#74 = #98#4 + #98#7 + #98#10 + #98#13;   |PINTA #0#74;
             #0#24 = #98#6 + #98#9 + #98#12 + #98#15;   |PINTA #0#24;
         |FINSI;

         |SI Campo = 75;
             #0#75 = #98#4 + #98#7 + #98#10 + #98#13;   |PINTA #0#75;
             #0#43 = #98#6 + #98#9 + #98#12 + #98#15;   |PINTA #0#43;
         |FINSI;

         |SI Campo = 76;
             #0#76 = #98#4 + #98#7 + #98#10 + #98#13;   |PINTA #0#76;
             #0#44 = #98#6 + #98#9 + #98#12 + #98#15;   |PINTA #0#44;
         |FINSI;

         |SI Campo = 77;
             #0#77 = #98#4 + #98#7 + #98#10 + #98#13;   |PINTA #0#77;
             #0#78 = #98#6 + #98#9 + #98#12 + #98#15;   |PINTA #0#78;
         |FINSI;

         |SI Campo = 79;
             #0#79 = #98#4 + #98#7 + #98#10 + #98#13;   |PINTA #0#79;
             #0#80 = #98#6 + #98#9 + #98#12 + #98#15;   |PINTA #0#80;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Imprimir; |TIPO 4;
   SwViene  = 1;
   VEmpresa = #0#0;
   VAnyo    = #0#2;
   VPeriodo = #0#1;
   |SUB_EJECUTA "eosem300";
|FPRC;
