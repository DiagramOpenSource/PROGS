|FICHEROS;
     eosy0008 #0;
     eosclien #1;
     eosdaban #2;
     eoshacie #3;
     eosm0028 #28;
     eosm0030 #30;
     eosm0033 #33;
     eosm0050 #50;
     eosw0066 #98;
     eosm0133 #133;
     eosw0166 #166;
     eosw0540 #540;
     eosw0548 #548;
     eosw0549 #549;
     eosw0550 #550;

     dsmow650 #650;
     dsmow652 #652;

     eosw0601 #601,MANTE;
|FIN;

|VARIABLES;
     nPeriodo     = 0;
     nCampoD      = 0;
     aLLeno40     = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     aVacio40     = "                                        ";
     aAlfa        = "";
     aCadena      = "";
     aLong        = "";
     aCaracter    = "";
     nLong        = 0;
     nPos         = 0;
     nCont        = 0;
     nConver      = 0;

     aDirOri  = "";
     aDirDes  = "";
     aOrigen  = "";
     aDestino = "";

     &enEmpresa   = 0;
     &enEjercic   = 0;
     &dia         = "";
     &mes         = "";
     &anyo        = "";

     nNeg = 0;
     Calc         = 0;
     Calc1        = 0;
     Calc2        = 0;
     TipoDato     = "";
     Long         = 0;
     LongDec      = 0;
     Comodin      = "";
     Comodin1     = "";
     Comodin2     = "";
     Vacio1       = "";
     Vacio2       = "";

     &EURODB    = 0;

     {-1}aMoneda   = "";
         aMoneda1  = "LEER";
         aMoneda2  = "";

     aJusti = "";

     aAbre        = "";
     aModelos     = "";

     nHandle1     = 0;
     nHandle2     = 0;
     nSwHay       = 0;
     nTCampo      = 0;

     aAlfa1       = "";
     aUnidad      = "";
     aIPRemoto    = "";
     aPathInter   = "";

  {1}aContiene    = "";

     &eaFOrigen   = "";
     &eaFDestino  = "";
     &eaInternet  = "";
     &eaImpresora = "";
     &enNume      = 0;
     &eaAlfa      = "";
     &eaDiaB      = "";
     &eaMesB      = "";
     &eaAnyoB     = "";
     &eaModelos   = "";

     nBoton1           = 0;
     nBoton2           = 0;
     nBoton3           = 0;
     nBoton4           = 0;
     nBoton5           = 0;
     aFichero          = "";
     aBue              = "";
     aF2               = "";
     aF3               = "";
     aF4               = "";
     aF5               = "";
     aF6               = "";
     aTecla            = "";
     &eaPathEmision    = "";
     &eaPathModelo     = "";
     &eaFichError      = "";
     &eaFichDatos      = "";
     &eaFichAuxil      = "";
     &eaForzExplorador = "";
     &enValidacion     = 0;
     &enBuenos         = 0;
     &eaPeriodo        = "";
     &eaPer            = "";
     &enMod            = 0;

     &eaEjer             = 0;
     &eaPathLanza        = "";
     &eaPathExplorador   = "";
     &eaPathInternet     = "";
     &eaFicheroPlano     = "";
     &eaFicheroSalid     = "";
     &eaFicheroImpre     = "";
     &eaFicheroError     = "";
     &eaOpcion           = "";
     &eaNomEmpresa       = "";
     &enPresentar        = 0;
     &enErrorPortal      = 0;
     &enTecla            = 0;
     &enPeriodo          = 0;
     nTecla              = 0;
|FIN;

|INCLUYE i_seguim;
|INCLUYE i_consul;
|INCLUYE i_laserc;

||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| CALCULOS DE LAS PANTALLAS
||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO FPago; |TIPO 0;
 |SI FSalida = 2; |ACABA; |FINSI;

 |SI #0#40 ] 2011;  |ACABA;  |FINSI;

 |SI #0#41 ! "F";
     |SI #0#46 = "A"; |O #0#46 = "E";
         |MENAV "    Opcion valida solo para Fichero / Internet. ";
         |ERROR;
     |FINSI;
 |FINSI;
|FPRC;

|PROCESO ElAny;
   aAlfa1 = "S";
   |SI #0#40 > 2013;  aAlfa1 = "N"; |FINSI;
   |C_M #0#46, 1, aAlfa1;
|FPRC;

|PROCESO TipoPeriodo;
     |SI #0#44 = "T";
         |SI #0#39 > 4;
             |MENAV "0000Periodo no trimestral ...";
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo7C41;  |TIPO 7;
     |C_M #0#41, 1, "S";
     aAlfa = "    O-Papel Oficial; B-Papel en Blanco; L-Laser; F-Fichero pres.telematica";
     |SI #0#40 ] 2013;
          aAlfa = "    (O-L-F) Botones Emision, B-Informe Comprobacion ";
     |FINSI;
     |MENSA aAlfa;
     |SI #0#40 [ 2010; |O #0#40 ] 2013; |ACABA;  |FINSI;

     |C_M #0#41, 1, "N";
|FPRC;

|PROCESO TipoImpreso;

     |BLIN 4;

     |SI #0#40 [ 2000;  |Y #0#41 = "F";
         |MENAV "     Fichero a partir del a쨚 2001";
         |ERROR;
         |ACABA;
     |FINSI;

     |SI #0#44 = "M"; |Y #0#40 < 2012;
         |SI #0#41 = "L"; |ERROR; |ACABA; |FINSI;
     |FINSI;

|FPRC;

|PROCESO Parrilla;
     |SI #0#0 = 0;
         #0#0 = 0;  |PINTA #0#0;
         #0#1 = 0;  |PINTA #0#1;  |C_M #0#1, 1, "N";
         |PARA nCampoD = 2;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
               |C_M #0nCampoD, 1, "S";
         |SIGUE;
     |SINO;
         |C_M #0#0, 1, "S";
         |C_M #0#1, 1, "S";
         |PARA nCampoD = 2;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
               |C_M #0nCampoD, 1, "N";
               #0nCampoD = 0;  |PINTA #0nCampoD;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasEmpresas;
     |SI #0Campo = 0;
         |PARA nCampoD = Campo + 1;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
               #0Campo = 0;  |C_M #0nCampoD, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampoD = Campo + 1;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
               |C_M #0nCampoD, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Ordenacion;  |TIPO 7;
     |C_M #0#42, 1, "S";
     |SI #0#0 = 0;
         |C_M #0#42, 1, "N";
         #0#42 = "C";
         |PINTA #0#42;
     |FINSI;
|FPRC;

|PROCESO MiraVarMoneda;  |TIPO 0;
     |HAZ PintaMoneda;
     #0#45 = eaMoneda;

     |SI #0#40 [ 2000;
         |SI #0#41 = "L";  |O #0#41 = "F";
             #0#45 = "PESETAS";
         |FINSI;
     |FINSI;

     |SI #0#40 ] 2002;
         |SI #0#45 = "PESETAS";
             |MENAV "     Moneda Erronea.";
             |ERROR;
         |FINSI;
     |FINSI;

     |PINTA #0#45;
|FPRC;

||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| CALCULOS DE IMPRESION
||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO Valor6;
     nCanti = nCanti ! 0;
     |SI nCanti ] 0;
         aCanti = nCanti;
         aCanti = ("000000" + aCanti) % -106;
     |SINO;
         nCanti = -nCanti;
         aCanti = nCanti;
         aCanti = "N" + (("00000" + aCanti) % -105);
     |FINSI;
|FPRC;

|PROCESO Valor12;
     eaMoneda = #0#45;
     enCanti  = nCanti;
     |HAZ ConverMoneda;
     nCanti   = enCanti;

     |SI nCanti ] 0;
         aCanti = nCanti;
         aCanti = ("000000000000" + aCanti) % -112;
     |SINO;
         nCanti = -nCanti;
         aCanti = nCanti;
         aCanti = "N" + (("00000000000" + aCanti) % -111);
     |FINSI;
|FPRC;

|PROCESO QuitaComas;
     aCadena = "";
     aLong   = aAlfa % 0;
     nLong   = aLong;
     |PARA nCont = 1;  |SI nCont [ aLong;  |HACIENDO nCont = nCont + 1;
           nPos = (100 * nCont) + 1;
           aCaracter = aAlfa % nPos;
           |SI aCaracter = ",";  aCaracter = " ";  |FINSI;
           |SI aCaracter = "";  aCaracter = &209; |FINSI;
           |SI aCaracter = "";  aCaracter = &209; |FINSI;
           |SI aCaracter = "";  aCaracter = &176; |FINSI;
           |SI aCaracter = "";  aCaracter = &170; |FINSI;
           aCadena = aCadena + aCaracter;
     |SIGUE;
     aAlfa = aCadena;

     aAlfa = aAlfa > aAlfa;
|FPRC;

|PROCESO Carga110_2001;
  |SI #0#40 < 2001;
     |DDEFECTO #98;

     #98#4  = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);

     Valfa  = #1#1; |QBF Valfa;
     #98#5  = ("000000000" + Valfa) % -109;
     #98#6  = #1#2;
     #98#8  = #1#4;
     #98#9  = #1#5;
     #98#10 = #1#6;
     #98#11 = #1#7;
     #98#12 = #1#8;
     #98#13 = #1#9;
     #98#14 = (("00" + #1#10) % -102) + (("000" + #1#11) % -103);
     #98#15 = #1#13;
     #98#16 = #1#12;
     #98#17 = #1#14;
     #98#18 = #0#40;
     #98#19 = nPeriodo;

     nCanti = #33#5;   |HAZ Valor6;   #98#20 = aCanti;
     nCanti = #33#6;   |HAZ Valor12;  #98#21 = aCanti;
     nCanti = #33#7;   |HAZ Valor12;  #98#22 = aCanti;
     nCanti = #33#8;   |HAZ Valor6;   #98#23 = aCanti;
     nCanti = #33#9;   |HAZ Valor12;  #98#24 = aCanti;
     nCanti = #33#10;  |HAZ Valor12;  #98#25 = aCanti;
     nCanti = #33#11;  |HAZ Valor6;   #98#26 = aCanti;
     nCanti = #33#12;  |HAZ Valor12;  #98#27 = aCanti;
     nCanti = #33#13;  |HAZ Valor12;  #98#28 = aCanti;
     nCanti = #33#14;  |HAZ Valor6;   #98#29 = aCanti;
     nCanti = #33#15;  |HAZ Valor12;  #98#30 = aCanti;
     nCanti = #33#16;  |HAZ Valor12;  #98#31 = aCanti;
     nCanti = #33#17;  |HAZ Valor6;   #98#32 = aCanti;
     nCanti = #33#18;  |HAZ Valor12;  #98#33 = aCanti;
     nCanti = #33#19;  |HAZ Valor12;  #98#34 = aCanti;
     nCanti = #33#20;  |HAZ Valor6;   #98#35 = aCanti;
     nCanti = #33#21;  |HAZ Valor12;  #98#36 = aCanti;
     nCanti = #33#22;  |HAZ Valor12;  #98#37 = aCanti;
     nCanti = #33#23;  |HAZ Valor6;   #98#38 = aCanti;
     nCanti = #33#24;  |HAZ Valor12;  #98#39 = aCanti;
     nCanti = #33#25;  |HAZ Valor12;  #98#40 = aCanti;
     nCanti = #33#26;  |HAZ Valor6;   #98#41 = aCanti;
     nCanti = #33#27;  |HAZ Valor12;  #98#42 = aCanti;
     nCanti = #33#28;  |HAZ Valor12;  #98#43 = aCanti;
     nCanti = #33#29;  |HAZ Valor12;  #98#44 = aCanti;
     nCanti = #33#29;  |HAZ Valor12;  #98#48 = aCanti;

     #98#49 = #2#2;
     #98#50 = #2#3;
     #98#51 = #2#4;
     #98#52 = #2#5;
     #98#53 = #1#13;
     #98#54 = dia;
     #98#55 = mes;
     #98#56 = #0#43 % -104;
     #98#57 = &13 + &10;
  |SINO;
     |DDEFECTO #166;
     |SI #0#45 = "PESETAS";
        #166#1 = "110";
     |SINO;
        #166#1 = "112";
     |FINSI;

     #166#4  = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);

     Valfa  = #1#1; |QBF Valfa;
     #166#5  = ("000000000" + Valfa) % -109;
     #166#6  = #1#2;
     #166#8  = #1#4;
     #166#9  = #1#5;
     #166#10 = #1#6;
     #166#11 = #1#7;
     #166#12 = #1#8;
     #166#13 = #1#9;
     #166#14 = (("00" + #1#10) % -102) + (("000" + #1#11) % -103);
     #166#15 = #1#13;
     #166#16 = #1#12;
     #166#17 = #1#14;
     #166#18 = #0#40;
     #166#19 = nPeriodo;

     nCanti = #133#5;   |HAZ Valor6;   #166#20 = aCanti;
     nCanti = #133#6;   |HAZ Valor12;  #166#21 = aCanti;
     nCanti = #133#7;   |HAZ Valor12;  #166#22 = aCanti;
     nCanti = #133#8;   |HAZ Valor6;   #166#23 = aCanti;
     nCanti = #133#9;   |HAZ Valor12;  #166#24 = aCanti;
     nCanti = #133#10;  |HAZ Valor12;  #166#25 = aCanti;
     nCanti = #133#11;  |HAZ Valor6;   #166#26 = aCanti;
     nCanti = #133#12;  |HAZ Valor12;  #166#27 = aCanti;
     nCanti = #133#13;  |HAZ Valor12;  #166#28 = aCanti;
     nCanti = #133#14;  |HAZ Valor6;   #166#29 = aCanti;
     nCanti = #133#15;  |HAZ Valor12;  #166#30 = aCanti;
     nCanti = #133#16;  |HAZ Valor12;  #166#31 = aCanti;
     nCanti = #133#17;  |HAZ Valor6;   #166#32 = aCanti;
     nCanti = #133#18;  |HAZ Valor12;  #166#33 = aCanti;
     nCanti = #133#19;  |HAZ Valor12;  #166#34 = aCanti;
     nCanti = #133#20;  |HAZ Valor6;   #166#35 = aCanti;
     nCanti = #133#21;  |HAZ Valor12;  #166#36 = aCanti;
     nCanti = #133#22;  |HAZ Valor12;  #166#37 = aCanti;
     nCanti = #133#23;  |HAZ Valor6;   #166#38 = aCanti;
     nCanti = #133#24;  |HAZ Valor12;  #166#39 = aCanti;
     nCanti = #133#25;  |HAZ Valor12;  #166#40 = aCanti;
     nCanti = #133#26;  |HAZ Valor12;  #166#41 = aCanti;
     nCanti = #133#27;  |HAZ Valor12;  #166#42 = aCanti;
     nCanti = #133#28;  |HAZ Valor12;  #166#43 = aCanti;  #166#44 = aCanti;

     #166#47 = #2#2;
     #166#48 = #2#3;
     #166#49 = #2#4;
     #166#50 = #2#5;
     aAlfa1 = #166#44; aAlfa1 = aAlfa1 % 0101;
     |SI #166#44 = 0; |O aAlfa1 = "N";
        #166#51 = "X";
     |FINSI;
     |SI #30#3 = "C";
        #166#52 = "X";
        |SI #0#45 = "PESETAS";
           aJusti = "110";
        |SINO;
           aJusti = "112";
        |FINSI;
        aJusti = aJusti + #30#4 + #30#5  + #30#6  + #30#7  + #30#8;
        aJusti = aJusti + #30#9 + #30#10 + #30#11 + #30#12 + #30#13;
        #166#53 = aJusti;
     |FINSI;
     #166#54 = #1#13;
     #166#55 = dia;
     #166#56 = mes;
     #166#57 = #0#43 % -104;
     #166#58 = &13 + &10;
  |FINSI;
|FPRC;

|PROCESO Formateo;
   nNeg = 0;
   |SI TipoDato = "N";
      |SI nConver = 1;
          eaMoneda = #0#45;
          enCanti  = Comodin;
          |HAZ ConverMoneda;
          Comodin  = enCanti;
      |FINSI;
      Vacio1 = "0" * Long;
      Vacio2 = "0" * LongDec;
      Comodin = Comodin - "-";
      |SI FSalida ! 0; nNeg = 1; |FINSI;
   |SINO;
      Vacio1 = " " * Long;
   |FINSI;

   |SI LongDec = 0;
      Calc = 0 - (100 + Long);
      Comodin = (Vacio1 + Comodin) % Calc;
   |SINO;
      Comodin = Comodin - ".";
      |SI FSalida = 0;
         Calc = 0 - (100 + Long);
         Comodin = (Vacio1 + Comodin) % Calc;
         Comodin1 = "0" * LongDec;
      |SINO;
         Calc1 = (((FSalida / 100) ! 0) - 1) + 100;
         Calc2 = (((FSalida / 100) ! 0) * 100) + 99;
         Comodin1 = Comodin % Calc2;
         Comodin  = Comodin % Calc1;
         Calc = 0 - (100 + Long);
         Comodin  = (Vacio1 + Comodin)  % Calc;
         Calc = 100 + LongDec;
         Comodin1 = (Comodin1 + Vacio2) % Calc;
      |FINSI;
      Comodin = Comodin + Comodin1;
   |FINSI;
   |SI TipoDato = "N"; |Y nNeg = 1;
      Calc = 0 - (100 + (Long - 1));
      Comodin = "N" + (Comodin % Calc)
   |FINSI;
|FPRC;

|PROCESO Secuencial00;
         Cadena = "110";
         |SI #0#44 = "M";  Cadena = "111";  |FINSI;

         |SI #0#45 = "PESETAS"; Cadena = Cadena + "P";  |FINSI;
         |SI #0#45 = "EUROS  "; Cadena = Cadena + "E";  |FINSI;
         Cadena = Cadena + (#eosclien#1 % 0109);    ||NIF
         |SI #0#44 ! "M";
             Cadena = Cadena + "    ";                  || Letras de etiqueta
             Cadena = Cadena + #eosm0133#1;             || Ejercicio
             Comodin = (#eosm0133#3 + "T") % -102;
             Cadena = Cadena + Comodin;                 || Periodo
         |SINO;
             Comodin = #eosm0133#1 % -102;
             Cadena  = Cadena + Comodin;                || Ejercicio
             Comodin = ("00" + #eosm0133#3) % -102;
             Cadena = Cadena + Comodin;                 || Periodo
         |FINSI;

         Long = 17; LongDec = 0; TipoDato = "N";
         nConver = 0;
         Comodin = #eosm0133#5;  |HAZ Formateo; Cadena = Cadena + Comodin;
         nConver = 1;
         Comodin = #eosm0133#6;  |HAZ Formateo; Cadena = Cadena + Comodin;
         Comodin = #eosm0133#7;  |HAZ Formateo; Cadena = Cadena + Comodin;
         nConver = 0;
         Comodin = #eosm0133#8;  |HAZ Formateo; Cadena = Cadena + Comodin;
         nConver = 1;
         Comodin = #eosm0133#9;  |HAZ Formateo; Cadena = Cadena + Comodin;
         Comodin = #eosm0133#10; |HAZ Formateo; Cadena = Cadena + Comodin;
         nConver = 0;
         Comodin = #eosm0133#11; |HAZ Formateo; Cadena = Cadena + Comodin;
         nConver = 1;
         Comodin = #eosm0133#12; |HAZ Formateo; Cadena = Cadena + Comodin;
         Comodin = #eosm0133#13; |HAZ Formateo; Cadena = Cadena + Comodin;
         nConver = 0;
         Comodin = #eosm0133#14; |HAZ Formateo; Cadena = Cadena + Comodin;
         nConver = 1;
         Comodin = #eosm0133#15; |HAZ Formateo; Cadena = Cadena + Comodin;
         Comodin = #eosm0133#16; |HAZ Formateo; Cadena = Cadena + Comodin;
         Cadena = Handle + " " + Cadena;
         |FGRABA Cadena;

         nConver = 0;
         Comodin = #eosm0133#17; |HAZ Formateo; Cadena = Comodin;
         nConver = 1;
         Comodin = #eosm0133#18; |HAZ Formateo; Cadena = Cadena + Comodin;
         Comodin = #eosm0133#19; |HAZ Formateo; Cadena = Cadena + Comodin;
         nConver = 0;
         Comodin = #eosm0133#20; |HAZ Formateo; Cadena = Cadena + Comodin;
         nConver = 1;
         Comodin = #eosm0133#21; |HAZ Formateo; Cadena = Cadena + Comodin;
         Comodin = #eosm0133#22; |HAZ Formateo; Cadena = Cadena + Comodin;
         nConver = 0;
         Comodin = #eosm0133#23; |HAZ Formateo; Cadena = Cadena + Comodin;
         nConver = 1;
         Comodin = #eosm0133#24; |HAZ Formateo; Cadena = Cadena + Comodin;
         Cadena = Handle + " " + Cadena;
         |FGRABA Cadena;

         Comodin = #eosm0133#25; |HAZ Formateo; Cadena = Comodin;
         Comodin = #eosm0133#26; |HAZ Formateo; Cadena = Cadena + Comodin;
         Comodin = #eosm0133#27; |HAZ Formateo; Cadena = Cadena + Comodin;
         Comodin = #eosm0133#28; |HAZ Formateo; Cadena = Cadena + Comodin;
         Cadena = Handle + " " + Cadena;
         |FGRABA Cadena;

         nConver = 0;
         Comodin = " " * 16; Cadena = Comodin;                       || Codigo electronico declaracion anterior
         |SI #0#44 ! "M";
             Comodin = "110"   + #eosm0030#4  + #eosm0030#5  + #eosm0030#6;
             Comodin = Comodin + #eosm0030#7  + #eosm0030#8  + #eosm0030#9;
             Comodin = Comodin + #eosm0030#10 + #eosm0030#11 + #eosm0030#12 + #eosm0030#13;
             Cadena = Cadena + Comodin;  Cadena = Handle + " " + Cadena; || Numero justificante declaracion anterior
         |SINO;
             Cadena = Handle + " " + Cadena; || Numero justificante declaracion anterior
         |FINSI;
         |FGRABA Cadena;

         Comodin = #eosm0030#15 + (" " * 60); Cadena = Comodin;        || Persona de contacto
         Cadena = Handle + " " + Cadena;
         |FGRABA Cadena;

         Comodin = #eosm0030#16 + " "; Cadena = Comodin;               || Telefono de contacto
         Cadena = Handle + " " + Cadena;
         |FGRABA Cadena;

         Cadena = " " * 200;                                           || Parte de observaciones
         Cadena = Handle + " " + Cadena;
         |FGRABA Cadena;

         Cadena = " " * 150;                                           || La otra parte de observaciones
         Cadena = Handle + " " + Cadena;
         |FGRABA Cadena;
|FPRC;

|PROCESO Internet2001;
     Raiz       = "";  |DIRECTORIO Raiz;
     Directorio = "";
     |DBASE Directorio;
     Directorio = Directorio + "hacienda/internet/" + aTipoSec;
     |MKDIR Directorio;
     Directorio = Directorio + "/";
     Valfa = Raiz + "bin/agichmod 777 " + Directorio;
     |SYSTEM Valfa;

     Empresa  = ("00000" + #1#0) % -105;

     Fichero    = aTipoSec + Empresa; aNombre = Fichero;
     INEmpresas = NEmpresas1 <-;
     INEmpresas = INEmpresas + NACopiar;
     NFichero   = Directorio + Fichero;          |QBF NFichero;
     NEmpresas  = NFichero;
     NACopiar   = NACopiar + 1;

     Fichero  = "wb  "+ NFichero;

     Pos = -1;
     |FABRE Fichero;
     Handle = FSalida;
     |SI FSalida ] 0;
         |HAZ Secuencial00;
     |FINSI;
     FSalida = Handle;
     |FCIERRA FSalida;

     aAlfa = ""; |IP_REMOTO aAlfa;
     |DBASE aDirOri; |QBF aDirOri;
     aDirOri = aDirOri + "hacienda/internet/" + aTipoSec + "/";
     aDirDes = "/MODELOS";
     |SI aAlfa ! ""; |RMKDIR aDirDes; |SINO; |MKDIR aDirDes; |FINSI;
     aDirDes = "/MODELOS/INTERNET";
     |SI aAlfa ! ""; |RMKDIR aDirDes; |SINO; |MKDIR aDirDes; |FINSI;
     aDirDes = "/MODELOS/INTERNET/" + aTipoSec;
     |SI aAlfa ! ""; |RMKDIR aDirDes; |SINO; |MKDIR aDirDes; |FINSI;
     aDirDes = aDirDes + "/";
     aOrigen = aDirOri + aNombre; aDestino = aDirDes + aNombre;
     |SI aAlfa ! ""; |ENVIA_FICHERO aOrigen, aDestino; |SINO; |COPIA_FICHERO aOrigen, aDestino; |FINSI;
|FPRC;

|PROCESO Laser2001;
     Raiz       = "";  |DIRECTORIO Raiz;
     Directorio = "";
     |DBASE Directorio;
     Directorio = Directorio + "hacienda/" + aTipoSec;
     |MKDIR Directorio;
     Directorio = Directorio + "/";
     Valfa = Raiz + "bin/agichmod 777 " + Directorio;
     |SYSTEM Valfa;

     Empresa  = #30#0;  Empresa  = ("00000" + Empresa) % -105;

     Fichero    = aTipoSec + Empresa;
     INEmpresas = NEmpresas1 <-;
     INEmpresas = INEmpresas + NACopiar;
     NFichero   = Directorio + Fichero;          |QBF NFichero;
     NEmpresas  = NFichero;
     NACopiar   = NACopiar + 1;

     Fichero  = "wb  "+ NFichero;

     Pos = -1;
     |FABRE Fichero;
     Handle = FSalida;
     |SI FSalida ] 0;
         |HAZ Carga110_2001;
         |SI #0#40 < 2001;
            |PARA nCampo = 1;  |SI nCampo [ 57;  |HACIENDO nCampo = nCampo + 1;
               Cadena = Handle + " " + #98nCampo;
               |FGRABA Cadena;
            |SIGUE;
         |SINO;
            |PARA nCampo = 1;  |SI nCampo [ 58;  |HACIENDO nCampo = nCampo + 1;
               |SI nCampo = 6;  |O nCampo = 7;  |O nCampo = 8; |O nCampo = 9;
                |O nCampo = 15; |O nCampo = 16; |O nCampo = 54;
                  aAlfa = #166nCampo; |HAZ QuitaComas; #166nCampo = aAlfa;
               |FINSI;
               Cadena = Handle + " " + #166nCampo;
               |FGRABA Cadena;
            |SIGUE;
         |FINSI;
     |FINSI;
     FSalida = Handle;
     |FCIERRA FSalida;
|FPRC;

|PROCESO CargaImprime;
     aAlfa = "del err" + (("00000" + #1#0) % -105) + ".TXT" + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "wait mipf32 ";
     aAlfa = aAlfa + "/E:110" + (("00000" + #1#0) % -105) + ".TXT ";
     aAlfa = aAlfa + "/R:err" + (("00000" + #1#0) % -105) + ".TXT ";
     |SI eaImpresora ! "";
         aAlfa = aAlfa + "/I:" + &34 + eaImpresora + &34;
     |FINSI;
     aAlfa = aAlfa + " /C:" + #601#0;
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "DEL " + "110" + (("00000" + #1#0) % -105) + ".TXT ";
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle1, aAlfa;
|FPRC;


|PROCESO TDeclaracion;
     |SI #0#40 [ 2006;
         |SI #133#28 > 0;
             enNume = #133#28;  |HAZ Conver13;  #540#46 = eaAlfa;

             |SI #0#46 = "S";  |O #0#46 = "D";
                 |SI #2#5 = "          ";
                      #540#47  = "X";
                 |SINO;
                      #540#48 = "X";
                      #540#49 = #2#2;            || entidad
                      #540#50 = #2#3;            || oficina
                      #540#51 = #2#4;            || DC
                      #540#52 = #2#5;           || cuenta
                 |FINSI;
             |SINO;
                 #540#47  = "X";
             |FINSI;
          |SINO;
             enNume  = 0;  |HAZ Conver13;  #540#46 = eaAlfa;
          |FINSI;

          #540#4 = "";
          |SI #0#41 = "L";
              |SI #133#28 [ 0;  #540#4 = "N";  |FINSI;
          |SINO;
              #540#4 = "N";
              |SI #133#28 > 0;  #540#4 = "I";  |FINSI;
          |FINSI;
     |FINSI;

     |SI #0#40 ] 2007;
         |SI #133#28 > 0;
             enNume = #133#28;  |HAZ Conver13;  #549#52 = eaAlfa;

             |SI #0#46 = "S";  |O #0#46 = "D";
                 |SI #2#5 = "          ";
                      #549#53  = "X";
                 |SINO;
                      #549#54 = "X";
                      #549#55 = #2#2;            || entidad
                      #549#56 = #2#3;            || oficina
                      #549#57 = #2#4;            || DC
                      #549#58 = #2#5;           || cuenta
                 |FINSI;
             |SINO;
                 #549#53  = "X";
             |FINSI;
          |SINO;
             enNume  = 0;  |HAZ Conver13;  #549#52 = eaAlfa;
          |FINSI;

          #549#4 = "";
          |SI #0#41 = "L";
              |SI #133#28 [ 0;  #549#4 = "N";  |FINSI;
          |SINO;
              #549#4 = "N";
              |SI #133#28 > 0;
                                                        #549#4 = "I";
                  |SI  #0#46   = "A";  |Y #0#40 < 2013; #549#4 = "A";  |FINSI;
                  |SI  #0#46   = "E";  |Y #0#40 < 2013; #549#4 = "E";  |FINSI;
                  |SI  #549#54 = "X";  |Y #0#46 = "D";  #549#4 = "U";  |FINSI;
              |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Carga110_2002;
     |SI #0#41 = "L";
         aAbre = "\MODELOS\110\" + "110" + (("00000" + #1#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |SI #0#41 = "F";
         aAbre = eaInternet + "110" + (("00000" + #1#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |ABRE #50;
     #50#0 = #1#0;
     |LEE 000#50=;
     |SI FSalida ! 0;  |DDEFECTO #50;  |FINSI;
     |CIERRA #50;

     |DDEFECTO #540;

     #540#1   = "110";
     #540#2   = "01";
     #540#3   = "";
     #540#5   = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);
     aAlfa    = #1#1;  |QBF aAlfa;
     #540#6   = ("000000000" + aAlfa) % -109;
     #540#7   = #50#2;
     eaAlfa   = #1#2;    |HAZ QuitaRaros;     #540#8   = eaAlfa;
     #540#9   = ".";
     eaAlfa   = #1#4;    |HAZ QuitaRaros;     #540#10  = eaAlfa;
     eaAlfa   = #1#5;    |HAZ QuitaRaros;     #540#11  = eaAlfa;
     #540#12  = #1#6;
     #540#13  = #1#7;
     #540#14  = #1#8;
     #540#15  = #1#9;
     #540#16  = (("00" + #1#10) % -102) + (("000" + #1#11) % -103);
     eaAlfa   = #1#13;   |HAZ QuitaRaros;     #540#17  = eaAlfa;
     eaAlfa   = #1#12;   |HAZ QuitaRaros;     #540#18  = eaAlfa;
     eaAlfa   = #1#14;   |HAZ QuitaRarosTfno; #540#19 = eaAlfa;

     #540#20  = #0#40;
     #540#21  = nPeriodo + "T";
     |SI #0#44 = "M";
         #540#21 = ("00" + nPeriodo) % -102;
     |FINSI;

     #540#22 = ("000000" + #133#5) % -106;
     enNume  = #133#6;  |HAZ Conver13;  #540#23 = eaAlfa;
     enNume  = #133#7;  |HAZ Conver13;  #540#24 = eaAlfa;

     #540#25 = ("000000" + #133#8) % -106;
     enNume  = #133#9;   |HAZ Conver13;  #540#26 = eaAlfa;
     enNume  = #133#10;  |HAZ Conver13;  #540#27 = eaAlfa;

     #540#28 = ("000000" + #133#11) % -106;
     enNume  = #133#12;  |HAZ Conver13;  #540#29 = eaAlfa;
     enNume  = #133#13;  |HAZ Conver13;  #540#30 = eaAlfa;

     #540#31 = ("000000" + #133#14) % -106;
     enNume  = #133#15;  |HAZ Conver13;  #540#32 = eaAlfa;
     enNume  = #133#16;  |HAZ Conver13;  #540#33 = eaAlfa;

     #540#34 = ("000000" + #133#17) % -106;
     enNume  = #133#18;  |HAZ Conver13;  #540#35 = eaAlfa;
     enNume  = #133#19;  |HAZ Conver13;  #540#36 = eaAlfa;

     #540#37 = ("000000" + #133#20) % -106;
     enNume  = #133#21;  |HAZ Conver13;  #540#38 = eaAlfa;
     enNume  = #133#22;  |HAZ Conver13;  #540#39 = eaAlfa;

     #540#40 = ("000000" + #133#23) % -106;
     enNume  = #133#24;  |HAZ Conver13;  #540#41 = eaAlfa;
     enNume  = #133#25;  |HAZ Conver13;  #540#42 = eaAlfa;

     enNume  = #133#26;  |HAZ Conver13;  #540#43 = eaAlfa;
     enNume  = #133#27;  |HAZ Conver13;  #540#44 = eaAlfa;
     enNume  = #133#28;
     |SI enNume < 0;  enNume = 0;  |FINSI;
                         |HAZ Conver13;  #540#45 = eaAlfa;

     |HAZ TDeclaracion;

     |SI #30#3 = "C";
         aJusti  = "112";
         aJusti  = aJusti + #30#4 + #30#5  + #30#6  + #30#7  + #30#8;
         aJusti  = aJusti + #30#9 + #30#10 + #30#11 + #30#12 + #30#13;
         #540#54 = aJusti;
     |FINSI;

     eaAlfa  = #30#15;   |HAZ QuitaRaros;     #540#55  = eaAlfa;
     eaAlfa  = #30#16;   |HAZ QuitaRarosTfno; #540#56  = eaAlfa;

     eaAlfa  = #0#43;    |HAZ FechaBonito;
     eaAlfa  = #1#13;    |HAZ QuitaRaros;     #540#61 = eaAlfa;
     #540#62 = eaDiaB;
     #540#63 = eaMesB;
     #540#64 = eaAnyoB;
     #540#65 = &13 + &10;

     |SI #0#41 = "L";
         #540#7  = "";
         #540#53 = "";
         #540#55 = "";
         #540#56 = "";
         #540#57 = "";
         #540#58 = "";
         #540#59 = "";
         #540#60 = "";
         nTCampo = 65;
     |FINSI;

     |SI #0#41 = "F";
         #540#2  = "";
         #540#3  = "";
         #540#5  = "";
         #540#8  = "";
         #540#9  = "";
         #540#10 = "";
         #540#11 = "";
         #540#12 = "";
         #540#13 = "";
         #540#14 = "";
         #540#15 = "";
         #540#16 = "";
         #540#17 = "";
         #540#18 = "";
         #540#19 = "";
         #540#47 = "";
         #540#48 = "";
         #540#49 = "";
         #540#50 = "";
         #540#51 = "";
         #540#52 = "";
         #540#61 = "";
         #540#62 = "";
         #540#63 = "";
         #540#64 = "";
         #540#65 = "";
         nTCampo = 64;
     |FINSI;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #540nCampo;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;
     |XCIERRA nHandle2;

     |SI #0#41 = "L";
         |HAZ CargaImprime;
     |FINSI;

     nSwHay = 1;
|FPRC;

|PROCESO Carga110_2007;
     |SI #0#41 = "L";
         aAbre = "\MODELOS\110\" + "110" + (("00000" + #1#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |SI #0#41 = "F";
         aAbre = eaInternet + "110" + (("00000" + #1#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |ABRE #50;
     #50#0 = #1#0;
     |LEE 000#50=;
     |SI FSalida ! 0;  |DDEFECTO #50;  |FINSI;
     |CIERRA #50;

     |DDEFECTO #549;

     #549#1   = "110";
     #549#2   = "01";
     #549#3   = "";
     #549#5   = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);
     aAlfa    = #1#1;  |QBF aAlfa;
     #549#6   = ("000000000" + aAlfa) % -109;
     #549#7   = #50#2;
     eaAlfa   = #1#2;    |HAZ QuitaRaros;     #549#8   = eaAlfa;
     #549#9   = ".";
     eaAlfa   = #1#4;    |HAZ QuitaRaros;     #549#10  = eaAlfa;
     eaAlfa   = #1#5;    |HAZ QuitaRaros;     #549#11  = eaAlfa;
     #549#12  = #1#6;
     #549#13  = #1#7;
     #549#14  = #1#8;
     #549#15  = #1#9;
     #549#16  = (("00" + #1#10) % -102) + (("000" + #1#11) % -103);
     eaAlfa   = #1#13;   |HAZ QuitaRaros;     #549#17  = eaAlfa;
     eaAlfa   = #1#12;   |HAZ QuitaRaros;     #549#18  = eaAlfa;
     eaAlfa   = #1#14;   |HAZ QuitaRarosTfno; #549#19 = eaAlfa;

     #549#20  = #0#40;
     #549#21  = nPeriodo + "T";
     |SI #0#44 = "M";
         #549#21 = ("00" + nPeriodo) % -102;
     |FINSI;

     #549#22 = ("000000" + #133#5) % -106;
     enNume  = #133#6;  |HAZ Conver13;  #549#23 = eaAlfa;
     enNume  = #133#7;  |HAZ Conver13;  #549#24 = eaAlfa;

     #549#25 = ("000000" + #133#8) % -106;
     enNume  = #133#9;   |HAZ Conver13;  #549#26 = eaAlfa;
     enNume  = #133#10;  |HAZ Conver13;  #549#27 = eaAlfa;

     #549#28 = ("000000" + #133#11) % -106;
     enNume  = #133#12;  |HAZ Conver13;  #549#29 = eaAlfa;
     enNume  = #133#13;  |HAZ Conver13;  #549#30 = eaAlfa;

     #549#31 = ("000000" + #133#14) % -106;
     enNume  = #133#15;  |HAZ Conver13;  #549#32 = eaAlfa;
     enNume  = #133#16;  |HAZ Conver13;  #549#33 = eaAlfa;

     #549#34 = ("000000" + #133#17) % -106;
     enNume  = #133#18;  |HAZ Conver13;  #549#35 = eaAlfa;
     enNume  = #133#19;  |HAZ Conver13;  #549#36 = eaAlfa;

     #549#37 = ("000000" + #133#20) % -106;
     enNume  = #133#21;  |HAZ Conver13;  #549#38 = eaAlfa;
     enNume  = #133#22;  |HAZ Conver13;  #549#39 = eaAlfa;

     #549#40 = ("000000" + #133#31) % -106;
     enNume  = #133#32;  |HAZ Conver13;  #549#41 = eaAlfa;
     enNume  = #133#33;  |HAZ Conver13;  #549#42 = eaAlfa;

     #549#43 = ("000000" + #133#34) % -106;
     enNume  = #133#35;  |HAZ Conver13;  #549#44 = eaAlfa;
     enNume  = #133#36;  |HAZ Conver13;  #549#45 = eaAlfa;

     #549#46 = ("000000" + #133#23) % -106;
     enNume  = #133#24;  |HAZ Conver13;  #549#47 = eaAlfa;
     enNume  = #133#25;  |HAZ Conver13;  #549#48 = eaAlfa;

     enNume  = #133#26;  |HAZ Conver13;  #549#49 = eaAlfa;
     enNume  = #133#27;  |HAZ Conver13;  #549#50 = eaAlfa;
     enNume  = #133#28;
     |SI enNume < 0;  enNume = 0;  |FINSI;
                         |HAZ Conver13;  #549#51 = eaAlfa;

     |HAZ TDeclaracion;

     |SI #30#3 = "C";
         aJusti  = "112";
         aJusti  = aJusti + #30#4 + #30#5  + #30#6  + #30#7  + #30#8;
         aJusti  = aJusti + #30#9 + #30#10 + #30#11 + #30#12 + #30#13;
         #549#60 = aJusti;
     |FINSI;

     eaAlfa  = #30#15;   |HAZ QuitaRaros;     #549#61  = eaAlfa;
     eaAlfa  = #30#16;   |HAZ QuitaRarosTfno; #549#62  = eaAlfa;

     eaAlfa  = #0#43;    |HAZ FechaBonito;
     eaAlfa  = #1#13;    |HAZ QuitaRaros;     #549#66 = eaAlfa;
     #549#68 = eaDiaB;
     #549#69 = eaMesB;
     #549#70 = eaAnyoB;
     #549#71 = &13 + &10;

     |SI #0#41 = "L";
         #549#7  = "";
         #549#59 = "";
         #549#61 = "";
         #549#62 = "";
         #549#63 = "";
         #549#64 = "";
         #549#65 = "";
         #549#66 = "";
         nTCampo = 71;
     |FINSI;

     |SI #0#41 = "F";
         #549#2  = "";
         #549#3  = "";
         #549#5  = "";
         #549#8  = "";
         #549#9  = "";
         #549#10 = "";
         #549#11 = "";
         #549#12 = "";
         #549#13 = "";
         #549#14 = "";
         #549#15 = "";
         #549#16 = "";
         #549#17 = "";
         #549#18 = "";
         #549#19 = "";
         #549#67 = "";
         #549#68 = "";
         #549#69 = "";
         #549#70 = "";
         #549#71 = "";
         nTCampo = 70;
     |FINSI;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ 9;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #549nCampo;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;

     |PARA nCampo = 20;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #549nCampo;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;
     |XCIERRA nHandle2;

     |SI #0#41 = "L";
         |HAZ CargaImprime;
     |FINSI;

     nSwHay = 1;
|FPRC;

|PROCESO Carga111_2002;
     |SI #0#41 = "L";  |ACABA;  |FINSI;

     nSwHay = 1;

     |SI #0#41 = "F";
         aAbre = eaInternet + "111" + (("00000" + #30#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |DDEFECTO #548;

     #548#1   = "111";
     #548#2   = "E";
     aAlfa    = #1#1;  |QBF aAlfa;
     #548#3   = ("000000000" + aAlfa) % -109;
     #548#4   = #0#40 % -102;
     #548#5   = ("00" + nPeriodo) % -102;

     #548#6  = ("00000000000000000" + #133#5) % -117;
     enNume  = #133#6;  |HAZ Conver17;  #548#7  = eaAlfa;
     enNume  = #133#7;  |HAZ Conver17;  #548#8  = eaAlfa;

     #548#9  = ("00000000000000000" + #133#8) % -117;
     enNume  = #133#9;   |HAZ Conver17;  #548#10 = eaAlfa;
     enNume  = #133#10;  |HAZ Conver17;  #548#11 = eaAlfa;

     #548#12 = ("00000000000000000" + #133#11) % -117;
     enNume  = #133#12;  |HAZ Conver17;  #548#13 = eaAlfa;
     enNume  = #133#13;  |HAZ Conver17;  #548#14 = eaAlfa;

     #548#15 = ("00000000000000000" + #133#14) % -117;
     enNume  = #133#15;  |HAZ Conver17;  #548#16 = eaAlfa;
     enNume  = #133#16;  |HAZ Conver17;  #548#17 = eaAlfa;

     #548#18 = ("00000000000000000" + #133#17) % -117;
     enNume  = #133#18;  |HAZ Conver17;  #548#19 = eaAlfa;
     enNume  = #133#19;  |HAZ Conver17;  #548#20 = eaAlfa;

     #548#21 = ("00000000000000000" + #133#20) % -117;
     enNume  = #133#21;  |HAZ Conver17;  #548#22 = eaAlfa;
     enNume  = #133#22;  |HAZ Conver17;  #548#23 = eaAlfa;

     #548#24 = ("00000000000000000" + #133#23) % -117;
     enNume  = #133#24;  |HAZ Conver17;  #548#25 = eaAlfa;
     enNume  = #133#25;  |HAZ Conver17;  #548#26 = eaAlfa;

     enNume  = #133#26;  |HAZ Conver17;  #548#27 = eaAlfa;
     enNume  = #133#27;  |HAZ Conver17;  #548#28 = eaAlfa;
     enNume  = #133#28;
     |SI enNume < 0;  enNume = 0;  |FINSI;
                         |HAZ Conver17;  #548#29 = eaAlfa;

     eaAlfa  = #30#15;   |HAZ QuitaRaros;      #548#31 = eaAlfa;
     eaAlfa  = #30#16;   |HAZ QuitaRarosTfno;  #548#32 = eaAlfa;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ 36;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #548nCampo;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;
     |XCIERRA nHandle2;
|FPRC;

|PROCESO Carga111_2007;
     |SI #0#41 = "L";  |ACABA;  |FINSI;

     nSwHay = 1;

     |SI #0#41 = "F";
         aAbre = eaInternet + "111" + (("00000" + #30#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |DDEFECTO #550;

     #550#1   = "111";
     aAlfa    = #1#1;  |QBF aAlfa;
     #550#2   = ("000000000" + aAlfa) % -109;
     #550#3   = #0#40 % -102;
     #550#4   = ("00" + nPeriodo) % -102;

     #550#5  = ("000000000000000" + #133#5) % -115;
     enNume  = #133#6;  |HAZ Conver17;  #550#6  = eaAlfa;
     enNume  = #133#7;  |HAZ Conver17;  #550#7  = eaAlfa;

     #550#8  = ("000000000000000" + #133#8) % -115;
     enNume  = #133#9;   |HAZ Conver17;  #550#9  = eaAlfa;
     enNume  = #133#10;  |HAZ Conver17;  #550#10 = eaAlfa;

     #550#11 = ("000000000000000" + #133#11) % -115;
     enNume  = #133#12;  |HAZ Conver17;  #550#12 = eaAlfa;
     enNume  = #133#13;  |HAZ Conver17;  #550#13 = eaAlfa;

     #550#14 = ("000000000000000" + #133#14) % -115;
     enNume  = #133#15;  |HAZ Conver17;  #550#15 = eaAlfa;
     enNume  = #133#16;  |HAZ Conver17;  #550#16 = eaAlfa;

     #550#17 = ("000000000000000" + #133#17) % -115;
     enNume  = #133#18;  |HAZ Conver17;  #550#18 = eaAlfa;
     enNume  = #133#19;  |HAZ Conver17;  #550#19 = eaAlfa;

     #550#20 = ("000000000000000" + #133#20) % -115;
     enNume  = #133#21;  |HAZ Conver17;  #550#21 = eaAlfa;
     enNume  = #133#22;  |HAZ Conver17;  #550#22 = eaAlfa;

     #550#23 = ("000000000000000" + #133#31) % -115;
     enNume  = #133#32;  |HAZ Conver17;  #550#24 = eaAlfa;
     enNume  = #133#33;  |HAZ Conver17;  #550#25 = eaAlfa;

     #550#26 = ("000000000000000" + #133#34) % -115;
     enNume  = #133#35;  |HAZ Conver17;  #550#27 = eaAlfa;
     enNume  = #133#36;  |HAZ Conver17;  #550#28 = eaAlfa;


     #550#29 = ("000000000000000" + #133#23) % -115;
     enNume  = #133#24;  |HAZ Conver17;  #550#30 = eaAlfa;
     enNume  = #133#25;  |HAZ Conver17;  #550#31 = eaAlfa;

     enNume  = #133#26;  |HAZ Conver17;  #550#32 = eaAlfa;
     enNume  = #133#27;  |HAZ Conver17;  #550#33 = eaAlfa;
     enNume  = #133#28;
     |SI enNume < 0;  enNume = 0;  |FINSI;
                         |HAZ Conver17;  #550#34 = eaAlfa;

     eaAlfa  = #30#15;   |HAZ QuitaRaros;      #550#36 = eaAlfa;
     eaAlfa  = #30#16;   |HAZ QuitaRarosTfno;  #550#37 = eaAlfa;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ 41;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #550nCampo;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;
     |XCIERRA nHandle2;
|FPRC;

|PROCESO TDeclaracion111;
     #650#6 = "N";
     |SI #133#28 > 0;
         #650#6 = "I";
         #650#41 = #2#2;            || entidad
         #650#42 = #2#3;            || oficina
         #650#43 = #2#4;            || DC
         #650#44 = #2#5;           || cuenta
     |FINSI;
|FPRC;

|PROCESO Carga111_2010;
     |SI #0#41 = "L";  |ACABA;  |FINSI;

     nSwHay = 1;

     |SI #0#41 = "F";
         aAbre = eaInternet + "111" + (("00000" + #30#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |DDEFECTO #650;

     aAlfa    = #1#1;  |QBF aAlfa;
     #650#7   = ("000000000" + aAlfa) % -109;
     eaAlfa   = #1#2;    |HAZ QuitaRaros;     #650#8 = eaAlfa;

     #650#9   = #0#40;
     #650#10  = ("00" + nPeriodo) % -102;

     #650#11 = ("000000" + #133#5) % -106;
     enNume  = #133#6;  |HAZ Conver17;  #650#12 = eaAlfa;
     enNume  = #133#7;  |HAZ Conver17;  #650#13 = eaAlfa;

     #650#14 = ("000000" + #133#8) % -106;
     enNume  = #133#9;   |HAZ Conver17;  #650#15 = eaAlfa;
     enNume  = #133#10;  |HAZ Conver17;  #650#16 = eaAlfa;

     #650#17 = ("000000" + #133#11) % -106;
     enNume  = #133#12;  |HAZ Conver17;  #650#18 = eaAlfa;
     enNume  = #133#13;  |HAZ Conver17;  #650#19 = eaAlfa;

     #650#20 = ("000000" + #133#14) % -106;
     enNume  = #133#15;  |HAZ Conver17;  #650#21 = eaAlfa;
     enNume  = #133#16;  |HAZ Conver17;  #650#22 = eaAlfa;

     #650#23 = ("000000" + #133#17) % -106;
     enNume  = #133#18;  |HAZ Conver17;  #650#24 = eaAlfa;
     enNume  = #133#19;  |HAZ Conver17;  #650#25 = eaAlfa;

     #650#26 = ("000000" + #133#20) % -106;
     enNume  = #133#21;  |HAZ Conver17;  #650#27 = eaAlfa;
     enNume  = #133#22;  |HAZ Conver17;  #650#28 = eaAlfa;

     #650#29 = ("000000" + #133#31) % -106;
     enNume  = #133#32;  |HAZ Conver17;  #650#30 = eaAlfa;
     enNume  = #133#33;  |HAZ Conver17;  #650#31 = eaAlfa;

     #650#32 = ("000000" + #133#34) % -106;
     enNume  = #133#35;  |HAZ Conver17;  #650#33 = eaAlfa;
     enNume  = #133#36;  |HAZ Conver17;  #650#34 = eaAlfa;

     #650#35 = ("000000" + #133#23) % -106;
     enNume  = #133#24;  |HAZ Conver17;  #650#36 = eaAlfa;
     enNume  = #133#25;  |HAZ Conver17;  #650#37 = eaAlfa;

     enNume  = #133#26;  |HAZ Conver17;  #650#38 = eaAlfa;
     enNume  = #133#27;  |HAZ Conver17;  #650#39 = eaAlfa;

     enNume  = #133#28;
     |SI enNume < 0; enNume = 0;  |FINSI;
                         |HAZ Conver17;  #650#40 = eaAlfa;

     |HAZ TDeclaracion111;

     #650#45 = "0";
     |SI #30#3 = "C";
         #650#45 = "1";
         aJusti  = "112";
         aJusti  = aJusti + #30#4 + #30#5  + #30#6  + #30#7  + #30#8;
         aJusti  = aJusti + #30#9 + #30#10 + #30#11 + #30#12 + #30#13;
         #650#46 = aJusti;
     |FINSI;

     eaAlfa  = #30#15;   |HAZ QuitaRaros;      #650#48 = eaAlfa;
     eaAlfa  = #30#16;   |HAZ QuitaRarosTfno;  #650#49 = eaAlfa;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ 56;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #650nCampo;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;
     |XCIERRA nHandle2;
|FPRC;


|PROCESO TDeclaracion111_2011;
     #652#6 = "N";
     |SI #133#28 > 0;
         #652#6 = "I";

         |SI #0#46 ! "N";
             #652#41 = #2#2;            || entidad
             #652#42 = #2#3;            || oficina
             #652#43 = #2#4;            || DC
             #652#44 = #2#5;            || cuenta
         |FINSI;

                                                  #652#6 = "I";
         |SI  #0#46 = "A";       |Y #0#40 < 2013; #652#6 = "A";  |FINSI;
         |SI  #0#46 = "E";       |Y #0#40 < 2013; #652#6 = "E";  |FINSI;
         |SI  #652#41 ! "    ";  |Y #0#46 = "D";  #652#6 = "U";  |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaImprime111;
     aAlfa = "del err" + (("00000" + #1#0) % -105) + ".TXT" + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "wait mipf32 ";
     aAlfa = aAlfa + "/E:111" + (("00000" + #1#0) % -105) + ".TXT ";
     aAlfa = aAlfa + "/R:err" + (("00000" + #1#0) % -105) + ".TXT ";
     |SI eaImpresora ! "";
         aAlfa = aAlfa + "/I:" + &34 + eaImpresora + &34;
     |FINSI;
     aAlfa = aAlfa + " /C:" + #601#0;
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle1, aAlfa;
|FPRC;

|PROCESO Carga111_2011;
     aAbre = eaPathEmision + "111" + (("00000" + #30#0) % -105) + ".TXT";
     |XABRE "BW", aAbre, nHandle2;

     nSwHay = 1;

     |DDEFECTO #652;

     #652#0   = #30#0;
     aAlfa    = #1#1;  |QBF aAlfa;
     #652#7   = ("000000000" + aAlfa) % -109;
     eaAlfa   = #1#2;    |HAZ QuitaRaros;     #652#8 = eaAlfa;

     #652#9   = #0#40;
     #652#10  = nPeriodo + "T";
     |SI #0#44 = "M";
         #652#10  = ("00" + nPeriodo) % -102;
     |FINSI;

     #652#11 = ("00000000" + #133#5) % -108;
     enNume  = #133#6;  |HAZ Conver17;  #652#12 = eaAlfa;
     enNume  = #133#7;  |HAZ Conver17;  #652#13 = eaAlfa;

     #652#14 = ("00000000" + #133#8) % -108;
     enNume  = #133#9;   |HAZ Conver17;  #652#15 = eaAlfa;
     enNume  = #133#10;  |HAZ Conver17;  #652#16 = eaAlfa;

     #652#17 = ("00000000" + #133#11) % -108;
     enNume  = #133#12;  |HAZ Conver17;  #652#18 = eaAlfa;
     enNume  = #133#13;  |HAZ Conver17;  #652#19 = eaAlfa;

     #652#20 = ("00000000" + #133#14) % -108;
     enNume  = #133#15;  |HAZ Conver17;  #652#21 = eaAlfa;
     enNume  = #133#16;  |HAZ Conver17;  #652#22 = eaAlfa;

     #652#23 = ("00000000" + #133#17) % -108;
     enNume  = #133#18;  |HAZ Conver17;  #652#24 = eaAlfa;
     enNume  = #133#19;  |HAZ Conver17;  #652#25 = eaAlfa;

     #652#26 = ("00000000" + #133#20) % -108;
     enNume  = #133#21;  |HAZ Conver17;  #652#27 = eaAlfa;
     enNume  = #133#22;  |HAZ Conver17;  #652#28 = eaAlfa;

     #652#29 = ("00000000" + #133#31) % -108;
     enNume  = #133#32;  |HAZ Conver17;  #652#30 = eaAlfa;
     enNume  = #133#33;  |HAZ Conver17;  #652#31 = eaAlfa;

     #652#32 = ("00000000" + #133#34) % -108;
     enNume  = #133#35;  |HAZ Conver17;  #652#33 = eaAlfa;
     enNume  = #133#36;  |HAZ Conver17;  #652#34 = eaAlfa;

     #652#35 = ("00000000" + #133#23) % -108;
     enNume  = #133#24;  |HAZ Conver17;  #652#36 = eaAlfa;
     enNume  = #133#25;  |HAZ Conver17;  #652#37 = eaAlfa;

     enNume  = #133#26;  |HAZ Conver17;  #652#38 = eaAlfa;
     enNume  = #133#27;  |HAZ Conver17;  #652#39 = eaAlfa;

     enNume  = #133#28;
     |SI enNume < 0; enNume = 0;  |FINSI;
                         |HAZ Conver17;  #652#40 = eaAlfa;

     |HAZ TDeclaracion111_2011;

     #652#45 = "0";
     |SI #30#3 = "C";
         #652#45 = "1";
         aJusti  = "112";
         aJusti  = aJusti + #30#4 + #30#5  + #30#6  + #30#7  + #30#8;
         aJusti  = aJusti + #30#9 + #30#10 + #30#11 + #30#12 + #30#13;
         #652#46 = aJusti;
     |FINSI;

     eaAlfa  = #30#15;   |HAZ QuitaRaros;      #652#48 = eaAlfa;
     eaAlfa  = #30#16;   |HAZ QuitaRarosTfno;  #652#49 = eaAlfa;

     |GRABA 020#652n;
     |LIBERA #652;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ 56;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #652nCampo;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;

     aAlfa = &13 + &10;
     |XGRABA nHandle2, aAlfa;

     |XCIERRA nHandle2;

     |HAZ CargaImprime111;

     eaFOrigen  = eaPathEmision + "111" + (("00000" + #30#0) % -105) + ".TXT";
     eaFDestino = eaPathModelo  + "111" + (("00000" + #30#0) % -105) + ".TXT";
     |HAZ CopiaFicheroIP;
|FPRC;

|PROCESO Carga2002;
     |SI #0#44 = "T";  |HAZ Carga110_2002;  |FINSI;
     |SI #0#44 = "M";  |HAZ Carga111_2002;  |FINSI;
|FPRC;

|PROCESO Carga2007;
     |SI #0#44 = "T";  |HAZ Carga110_2007;  |FINSI;

     |SI #0#44 = "M";
         |SI #0#40 [ 2009;  |HAZ Carga111_2007;  |FINSI;
         |SI #0#40 = 2010;  |HAZ Carga111_2010;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO Imprime110;
     #1#0 = #30#0;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;

     #3#0 = #1#18; #3#1 = #1#19;
     |LEE 040#3=;
     |SI FSalida ! 0; |DDEFECTO #3; |FINSI;

     #2#0 = #1#0;
     |LEE 040#2=;
     |SI FSalida ! 0; |DDEFECTO #2; |FINSI;

     #28#0 = #30#0;
     #28#1 = #30#1;
     |LEE 000#28=;
     |SI FSalida ! 0;  |DDEFECTO #28;  |FINSI;

     nPeriodo = #0#39;

     |SI #0#40 < 2001;
        #33#0 = #30#0;
        #33#1 = #30#1;
        #33#2 = "110";
        #33#3 = nPeriodo;
        #33#4 = 0;
        |LEE 000#33=;
     |SINO;
        #133#0 = #30#0;
        #133#1 = #30#1;
        #133#2 = "110";
        #133#3 = nPeriodo;
        #133#4 = 0;
        |LEE 000#133=;
     |FINSI;

     |SI FSalida = 0;
         |SI #0#41 ! "L"; |Y #0#41 ! "F";
             |PRINT;
             |PIEINF;
         |SINO;
             |SI #0#40 [ 2001;
                 |SI #0#41 = "L";
                     |HAZ Laser2001;
                 |SINO;
                     |HAZ Internet2001;
                 |FINSI;
             |FINSI;

             |SI #0#40 ] 2002;  |Y #0#40 [ 2006;
                 |HAZ Carga2002;
             |FINSI;

             |SI #0#40 ] 2007;  |Y #0#40 [ 2010;
                 |HAZ Carga2007;
             |FINSI;

             |SI #0#40 ] 2011;
                 |HAZ Carga111_2011;
             |FINSI;
         |FINSI;

         |SI #0#41 ! "B";
             aAlfa    = #0#40 % -102;
             se_empre = #30#0;
             se_ejerc = aAlfa;
             se_perio = nPeriodo;
             se_tipos = 110;
             se_activ = 10;
             |SI #0#40 < 2001;
                se_impor = #33#29;
             |SINO;
                se_impor = #133#28;
             |FINSI;
             se_fecha = #0#43;
             se_factu = "N";
             |HAZ seguimie;
             |HAZ AlAgicli;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE eosm0030C;
     #30#1;
     ;
     #0#0, #0#40;
     #0#1, #0#40;
     ;
     NULL, Imprime110;
|FIN;

|DEFBUCLE eosm0030N;
     #30#2;
     ;
     aVacio40, #0#40;
     aLLeno40, #0#40;
     ;
     NULL, Imprime110;
|FIN;

|PROCESO Periodo;
     dia  = #0#43 % 102;
     mes  = #0#43 % 402;
     anyo = #0#43 % -104;

     |SI mes = "01"; mes = "Enero     "; |FINSI;
     |SI mes = "02"; mes = "Febrero   "; |FINSI;
     |SI mes = "03"; mes = "Marzo     "; |FINSI;
     |SI mes = "04"; mes = "Abril     "; |FINSI;
     |SI mes = "05"; mes = "Mayo      "; |FINSI;
     |SI mes = "06"; mes = "Junio     "; |FINSI;
     |SI mes = "07"; mes = "Julio     "; |FINSI;
     |SI mes = "08"; mes = "Agosto    "; |FINSI;
     |SI mes = "09"; mes = "Septiembre"; |FINSI;
     |SI mes = "10"; mes = "Octubre   "; |FINSI;
     |SI mes = "11"; mes = "Noviembre "; |FINSI;
     |SI mes = "12"; mes = "Diciembre "; |FINSI;

     mes    = mes > mes;
     enAnyo = #0#40;

     enMod = 110;
     |SI #0#40 ] 2011; enMod = 111; |FINSI;

|FPRC;

|PROCESO AbreImprime;
     eaPathModelo = "\MODELOS\110\";

     aAbre = "\MODELOS\110\imprime.bat";
     |XABRE "CBW", aAbre, nHandle1;

     aAlfa = "CD \" + &13 + &10;                 |XGRABA nHandle1, aAlfa;
     aAlfa = "CD MODELOS" + &13 + &10;           |XGRABA nHandle1, aAlfa;
     aAlfa = "CD 110" + &13 + &10;               |XGRABA nHandle1, aAlfa;

     aAlfa = #0#40;
     aAlfa = aAlfa % -102;
     aVersion = "";

     |SI #0#40 ] 2008;
         aVersion = "01";
         |SI #0#40 = 2008;
             enPer = 1;
             |SI #0#44 = "T"; |Y #0#39 ] 2;
                 aVersion = "02";
                 enPer    = 2;
             |FINSI;
             |SI #0#44 = "M"; |Y #0#39 ] 4;
                 aVersion = "02";
                 enPer    = 2;
             |FINSI;
         |FINSI;
     |FINSI;

     aAlfa1 = "DEL ERRORES.RST" + &13 + &10;      |XGRABA nHandle1, aAlfa1;

     aContiene = "";
     |ESPECIFICA "RBASS", aContiene;
     aUnidad = (aContiene1 % 102) > "";

     |SI aVersion = "";
         aAlfa = "ZLS" + aAlfa + "MPF.EXE /T:" + aUnidad + "\MODELOS\110\"+ &13 + &10;
     |SINO;
         aAlfa = "Z" + aAlfa + aVersion + "MPF.EXE /T:" + aUnidad + "\MODELOS\110\"+ &13 + &10;
     |FINSI;

     |XGRABA nHandle1, aAlfa;

     |SI #0#40 ] 2002;
         aAlfa = "MOVE ERRORM~1.TXT ERRORMIPF.TXT" + &13 + &10;      |XGRABA nHandle1, aAlfa;
         aAlfa = "MOVE EAN128~1.DLL EAN128_32.DLL" + &13 + &10;      |XGRABA nHandle1, aAlfa;
     |FINSI;
|FPRC;

|PROCESO EmiteEsto;
     aAlfa = "DEL *.wmf" + &13 + &10;             |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.tab"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.dll"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errorm~1.txt" + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errormipf.txt"  + &13 + &10;    |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errmipf.txt"  + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.exe"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     |XCIERRA nHandle1;

     eaModelos = "110";   |HAZ Copiampf;

     aAlfa = "\MODELOS\110\IMPRIME";
     |RSYSTEM aAlfa;
|FPRC;

|PROCESO Forma2010;
     |SI #0#41 ! "L"; |Y #0#41 ! "F";
         |IMPRE 0;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |SI #0#40 < 2001;
            |SI #0#41 = "O";  |INFOR "eosy1008";  |FINSI;
            |SI #0#41 = "B";  |INFOR "eosy2008";  |FINSI;
         |SINO;
            |SI #0#41 = "O";  |INFOR "eosy1108";  |FINSI;
            |SI #0#41 = "B";  |INFOR "eosy2108";  |FINSI;
         |FINSI;
         |SI FSalida ! 0;  |FINIMP;  |ACABA;   |FINSI;
     |SINO;
         |SI #0#40 [ 2001;
             NACopiar   = 0;
             INEmpresas = NEmpresas1 <-;
             |PARA XPara = 1; |SI XPara [ 700;  |HACIENDO XPara = XPara + 1;
                   NEmpresas = "";
                   INEmpresas = INEmpresas + 1;
             |SIGUE;
         |FINSI;

         |SI #0#40 ] 2002;
             |SI #0#41 = "L";
                 |PARA;  |SI;  |HACIENDO;
                      |DDEFECTO #601;
                      |PINPA #0#601;
                      |PINDA #0#601;
                      |ENDATOS #1#601;
                      |SI FSalida = 0;
                          aAlfa = "/MODELOS";          |RMKDIR aAlfa;
                          aAlfa = "/MODELOS/110";      |RMKDIR aAlfa;
                          |HAZ AbreImprime;
                          |SAL;
                      |FINSI;
                 |SIGUE;
             |FINSI;

             |SI #0#41 = "F";
                 aAlfa      = "/AEAT";                       |RMKDIR aAlfa;
                 aAlfa      = "/AEAT/INTERNET";              |RMKDIR aAlfa;
                 aAlfa      = "/AEAT/INTERNET/110";          |RMKDIR aAlfa;
                 aAlfa      = "/AEAT/INTERNET/110/" + #0#40; |RMKDIR aAlfa;
                 eaInternet = aAlfa + "/";
             |FINSI;
         |FINSI;
     |FINSI;

     nSwHay = 0;

     |ABRE #1;
     |ABRE #2;
     |ABRE #3;
     |ABRE #28;
     |ABRE #33;
     |ABRE #133;
     |SI #0#0 = 0;
         |ABRE #30;
         |PARA nCampoD = Campo + 1;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
               |SI #0nCampoD ! 0;
                   #30#0 = #0nCampoD;
                   #30#1 = #0#40;
                   |LEE 040#30=;
                   |SI FSalida = 0;
                       |HAZ Imprime110;
                   |FINSI;
               |FINSI;
         |SIGUE;
         |CIERRA #30;
     |SINO;
         |SI #0#42 = "C";
             |BUCLE eosm0030C;
         |SINO;
             |BUCLE eosm0030N;
         |FINSI;
     |FINSI;
     |CIERRA #1;
     |CIERRA #2;
     |CIERRA #3;
     |CIERRA #28;
     |CIERRA #33;
     |CIERRA #133;

     |SI #0#41 ! "L";  |Y #0#41 ! "F";
         |FININF;  |FINIMP;
     |SINO;
         |SI #0#41 = "L";
             |SI #0#40 [ 2001;
                 |HAZ GrabaDisketteL;
             |FINSI;

             |SI #0#40 ] 2002;
                 |SI nSwHay = 1;
                     |HAZ EmiteEsto;
                     eaTipoSec = "110";
                     eaTipoEmi = "ERRORES";
                     enAnyo    = #0#40;
                     |SUB_EJECUTA "eosz9999";
                 |SINO;
                     |MENAV "     Seleccion Vacia";
                     |XCIERRA nHandle1;
                 |FINSI;

                 aAlfa = "\MODELOS\110\imprime.bat";
                 |RFBORRA aAlfa;
             |FINSI;
         |FINSI;

         |SI #0#41 = "F";  |Y #0#40 ] 2002;
             |SI nSwHay = 1;
                 aAlfa =  "      Ficheros Generados. Situados en " + eaInternet + " de su PC";
                 |MENAV aAlfa;
             |SINO;
                 |MENAV "     Seleccion Vacia";
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CreaVarios;
     aIPRemoto   = "";
     |IP_REMOTO aIPRemoto;

     aPathInter  = eaPathModelo + "AInternet";
     aPathInter  = aPathInter + "/";
     aFichero    = aPathInter + "*.bue";
     |R_PDIR aFichero;
     |PARA; |SI; |HACIENDO;
          |SI FSalida ! 0; |SAL; |FINSI;

           aBue     = aFichero - aPathInter;
          |SI #0#41 = "F";
               aDestino = eaInternet + "111" + (aBue % 405) + ".txt";
               |RCOPIA_FICHERO aFichero, aDestino;
          |FINSI;

          |RFBORRA aFichero;

          |R_SDIR aFichero;
     |SIGUE;

     |SI #0#41 = "F";
         aAlfa =  "      Los ficheros generados estan: " + eaInternet + " de su PC";
         |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO EmiteEsto111;
     aAlfa = "DEL *.wmf" + &13 + &10;             |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.tab"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.dll"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errorm~1.txt" + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errormipf.txt"  + &13 + &10;    |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errmipf.txt"  + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.exe"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     |XCIERRA nHandle1;

     eaModelos = "110";   |HAZ Copiampf;

     aAlfa = eaPathModelo + "IMPRIME";
     |RSYSTEM aAlfa;

     eaFichError = "err";
     eaFichDatos = 111;
     eaFichAuxil = "";
     enAnyo      = #0#40;
     eaPeriodo   = ("00" + #0#39) % -102;
     eaPer       = #0#44;

     enValidacion = 1;
     |HAZ BuscaErroresL;

     |SI enBuenos = 0;
         |MENAV "      Ha habido Errores, arreglelos y vuelva a emitir.";
         |ACABA;
     |FINSI;

     |HAZ CreaVarios;
|FPRC;

|PROCESO AbreImprime111;
     aAbre = eaPathModelo + "imprime.bat";
     |XABRE "CBW", aAbre, nHandle1;

     aAlfa = "CD \" + &13 + &10;                 |XGRABA nHandle1, aAlfa;
     aAlfa = "CD MODELOS" + &13 + &10;           |XGRABA nHandle1, aAlfa;
     aAlfa = "CD 110" + &13 + &10;               |XGRABA nHandle1, aAlfa;
     aAlfa = "CD " + #0#40 + &13 + &10;          |XGRABA nHandle1, aAlfa;
     aAlfa = "CD " + (("00" + #0#39) % -102) + &13 + &10;  |XGRABA nHandle1, aAlfa;

     aAlfa = #0#40;
     aAlfa = aAlfa % -102;
     aVersion = "01";

     aAlfa1 = "DEL ERRORES.RST" + &13 + &10;      |XGRABA nHandle1, aAlfa1;

     aContiene = "";
     |ESPECIFICA "RBASS", aContiene;
     aUnidad = (aContiene1 % 102) > "";

     aAlfa = "Z" + aAlfa + aVersion + "MPF.EXE /T:" + aUnidad;
     aAlfa = aAlfa +  eaPathModelo;
     aAlfa = aAlfa + &13 + &10;

     |XGRABA nHandle1, aAlfa;

     aAlfa = "MOVE ERRORM~1.TXT ERRORMIPF.TXT" + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "MOVE EAN128~1.DLL EAN128_32.DLL" + &13 + &10;      |XGRABA nHandle1, aAlfa;
|FPRC;

|PROCESO Fichero;
     |DBASE eaPathEmision;
     eaPathEmision = eaPathEmision + "emisiones";                     |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/110";                          |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + #0#40;                     |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + (("00" + #0#39) % -102);   |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/";

     aAlfa        = "\AEAT";                       |RMKDIR aAlfa;
     aAlfa        = "\AEAT\INTERNET";              |RMKDIR aAlfa;
     aAlfa        = "\AEAT\INTERNET\110";          |RMKDIR aAlfa;
     aAlfa        = "\AEAT\INTERNET\110\" + #0#40;  |RMKDIR aAlfa;
     aAlfa        = "\AEAT\INTERNET\110\" + #0#40 + "\" + (("00" + #0#39) % -102);   |RMKDIR aAlfa;
     eaInternet   = aAlfa + "\";

     aAlfa        = "\MODELOS";                |RMKDIR aAlfa;
     aAlfa        = "\MODELOS\110";            |RMKDIR aAlfa;
     aAlfa        = "\MODELOS\110\" + #0#40;   |RMKDIR aAlfa;
     aAlfa        = "\MODELOS\110\" + #0#40 + "\" + (("00" + #0#39) % -102);   |RMKDIR aAlfa;
     eaPathModelo = aAlfa + "\";

     |HAZ AbreImprime111;

     nSwHay = 0;

     |ABRE #1;
     |ABRE #2;
     |ABRE #3;
     |ABRE #28;
     |ABRE #33;
     |ABRE #133;
     |SI #0#0 = 0;
         |ABRE #30;
         |PARA nCampoD = Campo + 1;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
               |SI #0nCampoD ! 0;
                   #30#0 = #0nCampoD;
                   #30#1 = #0#40;
                   |LEE 040#30=;
                   |SI FSalida = 0;
                       |HAZ Imprime110;
                   |FINSI;
               |FINSI;
         |SIGUE;
         |CIERRA #30;
     |SINO;
         |SI #0#42 = "C";
             |BUCLE eosm0030C;
         |SINO;
             |BUCLE eosm0030N;
         |FINSI;
     |FINSI;
     |CIERRA #1;
     |CIERRA #2;
     |CIERRA #3;
     |CIERRA #28;
     |CIERRA #33;
     |CIERRA #133;

     |SI nSwHay = 0;
         |MENAV "0000Seleccion vacia";
         |ACABA;
     |FINSI;

     |HAZ EmiteEsto111;
|FPRC;

|PROCESO Impresora;
     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #0#41 = "O";  |INFOR "eosy1108";  |FINSI;
     |SI #0#41 = "B";  |INFOR "eosy2108";  |FINSI;
     |SI FSalida ! 0;  |FINIMP;  |ACABA;   |FINSI;

     |ABRE #1;
     |ABRE #2;
     |ABRE #3;
     |ABRE #28;
     |ABRE #33;
     |ABRE #133;
     |SI #0#0 = 0;
         |ABRE #30;
         |PARA nCampoD = Campo + 1;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
               |SI #0nCampoD ! 0;
                   #30#0 = #0nCampoD;
                   #30#1 = #0#40;
                   |LEE 040#30=;
                   |SI FSalida = 0;
                       |HAZ Imprime110;
                   |FINSI;
               |FINSI;
         |SIGUE;
         |CIERRA #30;
     |SINO;
         |SI #0#42 = "C";
             |BUCLE eosm0030C;
         |SINO;
             |BUCLE eosm0030N;
         |FINSI;
     |FINSI;
     |CIERRA #1;
     |CIERRA #2;
     |CIERRA #3;
     |CIERRA #28;
     |CIERRA #33;
     |CIERRA #133;

     |FININF;
     |FINIMP;
|FPRC;

|PROCESO Boton1101;
     |PTEC 824;
|FPRC;

|PROCESO Boton1102;
     |PTEC 825;
|FPRC;

|PROCESO Boton1103;
     |PTEC 826;
|FPRC;

|PROCESO Boton1104;
     |PTEC 806;
|FPRC;

|PROCESO Boton1105;
     |PTEC 827;
|FPRC;

|PROCESO Botones110;
     |BLANCO 0501 2380;

     |CONTROL_SIMPLE 0, "LBOTON, <F2> Emision PDF pagina hacienda          ", 0513, 0754, Boton1101;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F3> Presentacion Telematica              ", 0913, 1154, Boton1102;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F4> Informe de Comprobacion              ", 1313, 1554, Boton1103;
     nBoton4 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,ESC Cancelar", 2365, 2378, Boton1104;
     nBoton5 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F5> Predeterminar Explorador de internet ", 1713, 1954, Boton1105;
     nBoton2 = FSalida;

     eaForzExplorador = "S";

     #0#41 = "";
     aF2   = &255 + "824";
     aF3   = &255 + "825";
     aF4   = &255 + "826";
     aF5   = &255 + "827";
     aF6   = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF2;
             |SI #0#44 = "M";
                 |MENAV "0000Modelo mensual. solo presentacion telematica";
             |SINO;
                 #0#41 = "L";
                 |SAL;
             |FINSI;
         |FINSI;
         |SI aTecla = aF3;  #0#41 = "F";   |SAL;  |FINSI;
         |SI aTecla = aF4;  #0#41 = "B";   |SAL;  |FINSI;
         |SI aTecla = aF5;  |HAZ Explorador;      |FINSI;
         |SI aTecla = aF6;                 |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton5;

     |PULSATECLA;
|FPRC;

|PROCESO Forma2011;
     |SI #0#40 ] 2013; |Y #0#41 = "B";
     |SINO;
         |HAZ Botones110;
     |FINSI;
     |SI #0#41 = " ";  |ACABA;  |FINSI;

     aFichero  = ("iw" + Usuario) % 108;
     |NOME_DAT #652 aFichero;
     |ABRE #652;  |CIERRA #652;  |DELINDEX #652;

     |ABRE #652;

     |SI #0#41 = "L"; |O #0#41 = "F"; |HAZ Fichero;    |FINSI;
     |SI #0#41 ! "L"; |Y #0#41 ! "F"; |HAZ Impresora;  |FINSI;

     |CIERRA #652;  |DELINDEX #652;
|FPRC;

|| ---------------------------------------------------------------

|PROCESO LeeEmpresas;
     |HAZ Periodo;
     enPeriodo = #0#39;
     eaEjer    = #0#40;

     |SI #0#40 [ 2012; |O #0#41 = "B";
         |SI #0#40 [ 2010;  |HAZ Forma2010;  |FINSI;
         |SI #0#40 ] 2011;  |HAZ Forma2011;  |FINSI;
         |ACABA;
     |FINSI;

     |GRABA 020#eosy0008.n;
     |LIBERA #eosy0008;

     |SUB_EJECUTA "dsmoy110";
|FPRC;

|PROGRAMA;
     aFichero = "eosy0008" + Usuario;
     |NOME_DAT #eosy0008#aFichero#;
     |ABRE #eosy0008;  |CIERRA #eosy0008;  |DELINDEX #eosy0008;

     |ABRE #eosy0008;

     aTipoSec = "110";

     |SI enEmpresa = 0;
         |CLS;
         |CABEZA "      Emision Modelo 110";
         |PINPA #0#0;
         |PINDA #0#0;
         |ENDATOS #1#0;
         |SI FSalida = 0;  |HAZ LeeEmpresas;  |FINSI;
     |SINO;
         |ABRE #28;
         #28#0 = enEmpresa;
         #28#1 = enEjercic;
         |LEE 000#28=;
         |SI FSalida ! 0;  |DDEFECTO #28;  |FINSI;
         |CIERRA #28;

         |PINPA #0#0;
         #0#0  = enEmpresa;
         #0#1  = enEmpresa;
         #0#40 = enEjercic;   |C_M #0#40, 1, "N";
         #0#42 = "C";         |C_M #0#42, 1, "N";
         #0#44 = #28#2;       |C_M #0#44, 1, "N";
         |SI enEjercic > 2014; |C_M #0#46, 1, "N"; |FINSI;
         |PINDA #0#0;

         |PTEC 802;
         |PTEC 802;
         |ENDATOS #1#0;
         |SI FSalida = 0;  |HAZ LeeEmpresas;  |FINSI;
     |FINSI;

     |CIERRA #eosy0008;  |DELINDEX #eosy0008;
|FPRO;
