|FICHEROS;
     reoz0010 #0;
|FIN;

|VARIABLES;
     aBase        = "";
     aDirPatron   = "";
     aFichero     = "";
     aFicheroD    = "";
     aFicheroH    = "";
     aNombreFich  = "";
     aNombreTexto = "";
     aCadena1     = "";
     aCadena2     = "";
     aQueEs       = "";
     aOrig        = "";
     aDest        = "";
     aOrigen      = "";
     aDestino     = "";
     aDirTexto    = "";
     aExtension   = "";
     aAlfa        = "";
     aIPRemoto    = "";
     aCarta       = "";
     aDescri      = "";

     nWord        = 0;
     nLinea       = 0;
     nLineaNueva  = 0;

     &eaPrograma  = "";
     &enCodCarta  = 0;
     aParam       = "";
|FIN;

|RUTINA ClaveBaja0;
     #0#0 = 01;
|FRUT;

|RUTINA ClaveAlta0;
     #0#0 = 99;
|FRUT;

|PROCESO Edicion;
     |DBASE aBase;   |QBF aBase;

||     aAlfa = "C:/MODELOS";                   |RMKDIR aAlfa;
||     aAlfa = "C:/MODELOS/DOCUMENTOS";        |RMKDIR aAlfa;
     aAlfa = "/MODELOS";                   |RMKDIR aAlfa;
     aAlfa = "/MODELOS/DOCUMENTOS";        |RMKDIR aAlfa;
     nWord = 1;

     aCarta    = "cartas" + (("00" + #0#0) % -102) + ".doc";
     aOrigen   = aBase + "cartas/" + aCarta;
||     aDestino  = "C:/MODELOS/DOCUMENTOS/" + aCarta;
     aDestino  = "/MODELOS/DOCUMENTOS/" + aCarta;

     aOrig     = aOrigen;
     aDest     = aDestino;
     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;
     |SI aIPRemoto ! "";
         |ENVIA_FICHERO aOrig, aDest;
     |SINO;
         |COPIA_FICHERO aOrig, aDest;
     |FINSI;

     |MENSA "     Abriendo el Documento, Espere un momento ";

     |WORD_ABRE nWord, aDestino;

     |MENSA "     Documento Abierto              ";

     |WORD_PROPIEDADES nWord, "Visible", "SI";

     FSalida = "NO";
     |PARA;  |SI FSalida = "NO";  |HACIENDO;
             |PULSATECLA;
             |WORD_PROPIEDADES nWord, "Quit", "";
     |SIGUE;

     |MENSA "     Cerrando el Documento, Espere un momento ";

     aOrig = aDestino;
     aDest = aOrigen;

     |SI aIPRemoto ! "";
         |RECIBE_FICHERO aOrig, aDest;
     |SINO;
         |COPIA_FICHERO aOrig, aDest;
     |FINSI;

     |RFBORRA aDestino;
|FPRC;

|PROCESO Alta;
     nLinea = 1;
     |PUSHV 0501 2380;
     |BLANCO 1115 1546;
     |CUADRO 1115 1546;
     |ATRI S;  |PINTA 1216, "Introduzca Codigo Carta Modelo";
     E_inf  = "1";
     E_sup  = "99";

     |ET PideMas;
         nLinea = 1427 ? 1;
         #0#0 = nLinea;
         |LEE 040#0=;
         |SI FSalida ! 0;
             |MENAV "     El Codigo de Carta no existe.";
             |VETE PideMas;
         |FINSI;

     |POPV;

     #0#0 = nLinea;
     |LEE 040#0=;

     nLineaNueva = 50;
     |PARA;  |SI;  |HACIENDO;
          #0#0 = nLineaNueva;
          |LEE 040#0=;
          |SI FSalida ! 0;  |SAL;  |FINSI;
          nLineaNueva = nLineaNueva + 1;
     |SIGUE;

     #0#0 = nLinea;
     |LEE 040#0=;

     #0#0 = nLineaNueva;
     |GRABA 020#0n;
     |LIBERA #0;

     aOrigen   = aBase + "cartas/cartas" + (("00" + nLinea) % -102) + ".doc";
     aDestino  = aBase + "cartas/cartas" + (("00" + nLineaNueva) % -102) + ".doc";
     |COPIA_FICHERO aOrigen, aDestino;

     |PONCONTROL 23, "SI";
     |PTEC 816;
|FPRC;

|PROCESO Baja;
     |CONFI "0000NEsta seguro de la Baja ";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |LEE 101#0=;

     |BORRA 020#0a;
     |LIBERA #0;

     aCarta    = "cartas" + (("00" + #0#0) % -102) + ".doc";
     aOrigen   = aBase + "cartas/" + aCarta;
     |FBORRA aOrigen;

     |PONCONTROL 23, "SI";
|FPRC;

|PROCESO Descripcion;
     aDescri = #0#1;
     |PUSHV 0501 2380;
     |BLANCO 1108 1479;
     |CUADRO 1108 1479;
     |ATRI S;  |PINTA 1216, "Introduzca la Descripcion ";
     E_inf  = "";
     E_sup  = "70";

     aDescri = 1309 ? 1;
     |POPV;

     |LEE 101#0=;
     #0#1 = aDescri;
     |GRABA 020#0a;
     |LIBERA #0;

     |PONCONTROL 23, "SI";
|FPRC;

|PROCESO Tipo11;  |TIPO 11;
     |SI FSalida = 10;  |HAZ Edicion;      |FINSI;
     |SI FSalida = 11;  |HAZ Alta;         |FINSI;
     |SI FSalida = 12;  |HAZ Baja;         |FINSI;
     |SI FSalida = 13;  |HAZ Descripcion;  |FINSI;
|FPRC;

|PROCESO Fuera;
     |SI eaPrograma = "";  |ACABA;  |FINSI;

     enCodCarta = #0#0;
     |PTEC 807;
|FPRC;

|PROGRAMA;
     |DBASE aBase;

     aDirPatron = aBase + "cartas/";

     |ABRE #0;
     #0#0 = 1;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = 1;
         #0#1 = "CARTA REGULARIZACION DEL IVA MODULOS FINAL DEL EJERCICIO";
         |GRABA 020#0n;

         aOrigen   = aBase + "cartas/cartas01.pat";
         aDestino  = aBase + "cartas/cartas01.doc";
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;
     |LIBERA #0;

     #0#0 = 2;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = 2;
         #0#1 = "CARTA HACIENDA DE CAMBIO DE LOS MINIMOS DE IVA MODULOS EJERCICIO 2002";
         |GRABA 020#0n;

         aOrigen   = aBase + "cartas/cartas02.pat";
         aDestino  = aBase + "cartas/cartas02.doc";
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;
     |LIBERA #0;

     #0#0 = 3;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = 3;
         #0#1 = "CERTIFICADO MODELO 184 HASTA 2014";
         |GRABA 020#0n;

         aOrigen   = aBase + "cartas/cartas03.pat";
         aDestino  = aBase + "cartas/cartas03.doc";
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;
     |LIBERA #0;

     #0#0 = 15;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = 15;
         #0#1 = "CERTIFICADO MODELO 184 DEL 2015";
         |GRABA 020#0n;

         aOrigen   = aBase + "cartas/cartas15.pat";
         aDestino  = aBase + "cartas/cartas15.doc";
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;
     #0#0 = 16;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = 16;
         #0#1 = "CERTIFICADO MODELO 184 A PARTIR DEL 2016";
         |GRABA 020#0n;

         aOrigen   = aBase + "cartas/cartas16.pat";
         aDestino  = aBase + "cartas/cartas16.doc";
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;
     |LIBERA #0;
     |CIERRA #0;

     |SI PARAMETRO ! "";  |ACABA;  |FINSI;

     |CABEZA "Editor Cartas";
     |ENTLINEAL #1#0, -1, 4, 21, 1, ClaveBaja0, ClaveAlta0;
|FPRO;
