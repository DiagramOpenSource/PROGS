|FICHEROS;
    eosy0002 #0;
    eossegui #1;
    eosdaban #2;
    eosclien #3;
    eosw0031 #99;
|FIN;

|VARIABLES;
    Refer       = 0;
    Entidad     = "";
    Oficina     = "";
    SwImpresion = 0;
|FIN;

|INCLUYE i_ficher;
|INCLUYE i_anyode;
|INCLUYE i_consul;

|PROCESO graba_ind;
|SI #0#9 = "N";
    |SI #1#5 [ 0; |ACABA; |FINSI;
|FINSI;

#2#0 = #1#0;
|LEE 040#2=;
|SI FSalida ! 0; |DDEFECTO #2; |FINSI;

#3#0 = #1#0;
|LEE 040#3=;
|SI FSalida ! 0; |DDEFECTO #3; |FINSI;

Refer  = Refer + 1;
#99#0  = Refer;
#99#1  = #2#2;
#99#2  = #2#3;
#99#3  = #2#1;
#99#4  = #1#0;
#99#5  = #3#2;
#99#6  = #2#5;
#99#7  = #1#3;
|SI #99#7 = 114;  #99#7 = 115;  |FINSI;
#99#8  = #1#1;
#99#9  = #1#2;
#99#10 = #1#5;
|GRABA 040#99n;

|SI #0#8 ! "S"; |ACABA; |FINSI;

#1#7 = "P";
|GRABA 140#1a;
|LIBERA #1;
|FPRC;

|DEFBUCLE eossegui;
#1#1;
7;
#0#4, #0#7, #0#6, 000, 10, "N";
#0#5, #0#7, #0#6, 999, 99, "N";
be;
NULL, graba_ind;
|FIN;

|PROCESO imprime;
|SI SwImpresion = 0;
    SwImpresion = 1;
    Entidad     = #99#1;
    Oficina     = #99#2;
|FINSI;

|SI Entidad ! #99#1; |O Oficina ! #99#2;
    |PIEINF;
    Entidad     = #99#1;
    Oficina     = #99#2;
|FINSI;

|SI #99#7 = 300;
    ||    #99#10 = #99#10 / 100;
|FINSI;

|PRINT;
|FPRC;

|DEFBUCLE eosw0031;
#99#2;
;
#0#0, #0#2, #0#4, 00000;
#0#1, #0#3, #0#5, 99999;
;
NULL, imprime;
|FIN;

|PROCESO tipo_3; |TIPO 3;
|IMPRE 0;
|SI FSalida ! 0; |ACABA; |FINSI;

comienza = "31";
|HAZ fichero;
|NOME_DAT #99 fichero;
|ABRE #99; |CIERRA #99; |DELINDEX #99;

|ABRE #2;
|ABRE #3;
|ABRE #99;
|BUCLE eossegui;
|CIERRA #2;
|CIERRA #3;
|CIERRA #99;

|SI Refer = 0;
    |ABRE #99; |CIERRA #99; |DELINDEX #99;
    |ACABA;
|FINSI;

SwImpresion = 0;
|INFOR "eosy0002";
|SI FSalida ! 0;
    |ABRE #99; |CIERRA #99; |DELINDEX #99;
    |FINIMP;
    |ACABA;
|FINSI;
|BUCLE eosw0031;
|SI SwImpresion = 1; |PIEINF; |FINSI;
|FININF;
|FINIMP;
|ABRE #99; |CIERRA #99; |DELINDEX #99;
|FPRC;

|PROCESO mayor; |TIPO 0;
#0Campo = #0Campo > #0Campo;
|PINTA #0Campo;
|FPRC;

|PROCESO pinta_anyo; |TIPO 7;
|HAZ i_anyodef;
#0#7 = i_anyodef;
|PINTA #0#7;
|FPRC;
