|FICHEROS;
    eosw0001 #0;
|FIN;

|VARIABLES;
   &tip_ele     = "";
   &fecha_dper  = @;
   &fecha_hper  = @;
   &fecha_ini   = @;
   &fecha_fin   = @;
   &fecha_ant   = "";
   &fecha_des   = "";
   &ejer_com    = "";
   &dias_ejer   = 0;
   &es_porrat   = "";

   &errorlin    = 0;
   &modelito    = 0;
   &numerica1   = 0;  &numerica2  = 0;   &numerica3  = 0;
   &numerica4   = 0;  &numerica5  = 0;   &numerica6  = 0;
   &numerica7   = 0;  &numerica8  = 0;   &numerica9  = 0;
   &numerica10  = 0;  &numerica11 = 0;   &numerica12 = 0;
   &numerica13  = 0;  &numerica14 = 0;

   &alfanumer1  = ""; &alfanumer2  = ""; &alfanumer3  = "";
   &alfanumer4  = ""; &alfanumer5  = ""; &alfanumer6  = "";
   &alfanumer7  = ""; &alfanumer8  = ""; &alfanumer9  = "";

   anyos_fech   = @;
   anyos_18     = @;
   anyos_19     = @;
   anyos_20     = @;
   anyos_alfa   = "";
   anyos_nume   = 0;
   anyos_naci   = 0;
   anyos        = 0;
   semanas      = 0;
   campo        = 0;
   alfa         = "";
|FIN;

|PROGRAMA;
errorlin = 0;
|PINPA #0#0;
|HAZ cargavar;
|PINDA #0#0;
|SI modelito ! 4;
   |SI modelito = 1; |ENDATOS #1#0; |FINSI;
   |SI modelito = 2; |ENDATOS #2#0; |FINSI;
   errorlin = FSalida;
   |SI FSalida = 0;  |HAZ descarga; |FINSI;
|SINO;
   |PAUSA;
|FINSI;
|FPRO;

|PROCESO cargavar;
#0#0  = numerica1;
#0#1  = numerica2;
#0#2  = alfanumer1;
#0#3  = alfanumer2;
#0#4  = numerica3;
#0#5  = alfanumer3;
#0#6  = numerica4;
#0#7  = numerica5;
#0#8  = numerica6;
#0#9  = numerica7;
#0#10 = alfanumer4;
#0#11 = alfanumer5;
#0#12 = alfanumer6;
#0#13 = numerica8;
#0#14 = alfanumer7;
#0#15 = numerica9;
#0#16 = numerica10;
#0#17 = numerica11;
#0#18 = numerica12;
#0#19 = alfanumer8;
#0#20 = numerica13;
#0#21 = numerica14;
|FPRC;

|PROCESO descarga;
numerica1  = #0#0;
numerica2  = #0#1;
alfanumer1 = #0#2;
alfanumer2 = #0#3;
numerica3  = #0#4;
alfanumer3 = #0#5;
numerica4  = #0#6;
numerica5  = #0#7;
numerica6  = #0#8;
numerica7  = #0#9;
alfanumer4 = #0#10;
alfanumer5 = #0#11;
alfanumer6 = #0#12;
numerica8  = #0#13;
alfanumer7 = #0#14;
numerica9  = #0#15;
numerica10 = #0#16;
numerica11 = #0#17;
numerica12 = #0#18;
alfanumer8 = #0#19;
numerica13 = #0#20;
numerica14 = #0#21;
|FPRC;

|PROCESO fecha_nac; |TIPO 7;
|SI tip_ele = "V";
    |CAMPO_MODIFICA #0#20, 1, "S";
    |CAMPO_MODIFICA #0#21, 1, "S";
    |CAMPO_MODIFICA #0#19, 1, "N";
    |CAMPO_MODIFICA #0#5,  1, "N";
    |CAMPO_MODIFICA #0#14, 1, "N";
    #0#19 = "01.01.1900";
    #0#5  = "S";
    #0#14 = "S";

    |SI es_porrat = "N"; |O ejer_com = "S";
        |CAMPO_MODIFICA #0#02, 1, "N"; |CAMPO_MODIFICA #0#03, 1, "N";
        |CAMPO_MODIFICA #0#04, 1, "N"; |CAMPO_MODIFICA #0#05, 1, "N";
        |CAMPO_MODIFICA #0#06, 1, "N"; |CAMPO_MODIFICA #0#07, 1, "N";
        |CAMPO_MODIFICA #0#08, 1, "N"; |CAMPO_MODIFICA #0#09, 1, "N";
        |CAMPO_MODIFICA #0#11, 1, "N"; |CAMPO_MODIFICA #0#12, 1, "N";
        |CAMPO_MODIFICA #0#14, 1, "N"; |CAMPO_MODIFICA #0#15, 1, "N";
        |CAMPO_MODIFICA #0#16, 1, "N"; |CAMPO_MODIFICA #0#17, 1, "N";
        |CAMPO_MODIFICA #0#18, 1, "N";
    |FINSI;

    |PINTA #0#19;
    |PINTA #0#5;
    |PINTA #0#14;
    |ACABA;
|FINSI;

|CAMPO_MODIFICA #0#20, 1, "N";
|CAMPO_MODIFICA #0#21, 1, "N";
|CAMPO_MODIFICA #0#19, 1, "S";
|CAMPO_MODIFICA #0#2,  1, "S";
|CAMPO_MODIFICA #0#3,  1, "S";

|SI ejer_com = "S";
    |CAMPO_MODIFICA #0#2,  1, "N";
    |CAMPO_MODIFICA #0#3,  1, "N";
    |CAMPO_MODIFICA #0#11, 1, "N";
    |CAMPO_MODIFICA #0#12, 1, "N";
    |ACABA;
|FINSI;
|FPRC;

|PROCESO filtro_nac; |TIPO 0;
|SI tip_ele = "V"; |ACABA; |FINSI;

campo = Campo;
anyos_fech = fecha_hper - #0#19;
anyos_alfa = anyos_fech % -102;
anyos_naci = anyos_alfa;

anyos_fech = #0Campo - #0#19;
anyos_alfa = anyos_fech % -102;
anyos_nume = anyos_alfa;

anyos_fech = #0#19    + 0.000018;
anyos      = anyos_fech - 1.000000;
anyos_18   = anyos;

anyos_fech = #0#19    + 0.000019;
anyos      = anyos_fech - 1.000000;
anyos_19   = anyos;

anyos_fech = #0#19    + 0.000020;
anyos      = anyos_fech - 1.000000;
anyos_20   = anyos;

|SI Campo = 19; |HAZ desde_fnac; |SINO; |HAZ desde_fecha; |FINSI;
Campo = campo;
|FPRC;

|PROCESO desde_fnac;
|SI tip_ele = "H";
    |SI anyos_naci ] 18;
        |MENAV "      El hijo ya tiene 18 a¤os, introduzcalo como Asalariado.";
        |ERROR;
        |ACABA;
    |FINSI;
|FINSI;

|SI anyos_naci < 16;
    |MENAV "      Todavia no ha cumplido 16 a¤os.";
    |ERROR;
    |ACABA;
|FINSI;

|SI anyos_naci ] 75;
    |MENAV "      El trabajador ya tiene 75 a¤os.";
    |ERROR;
    |ACABA;
|FINSI;
|FPRC;

|PROCESO desde_fecha;
|SI tip_ele = "H";
    |SI anyos_nume ] 18;
        |MENAV "      El hijo ya tiene 18 a¤os, introduzcalo como Asalariado.";
        |ERROR;
        |ACABA;
    |FINSI;
    |ACABA;
|FINSI;

|SI anyos_naci < 16;
    |MENAV "      Todavia no ha cumplido 16 a¤os.";
    |ERROR;
    |ACABA;
|FINSI;

|SI anyos_nume ] 75;
    |MENAV "      El trabajador ya tiene 75 a¤os.";
    |ERROR;
    |ACABA;
|FINSI;

|SI #0Campo [ fecha_ant;
    |MENAV "      La fecha no coincide con el a¤o seleccionado";
    |ERROR; |ACABA;
|FINSI;

|SI Campo ! 2;
    |SI #0Campo < fecha_dper;
        |MENAV "      La fecha no coincide con el periodo seleccionado";
        |ERROR; |ACABA;
    |FINSI;
|FINSI;

|SI Campo ! 3;
    |SI #0Campo > fecha_hper;
        |MENAV "      La fecha no coincide con el periodo seleccionado";
        |ERROR; |ACABA;
    |FINSI;
|FINSI;

|SI #0#2 > #0#3;
    |MENAV "      La fecha alta es mayor a la fecha baja.";
    |ERROR;
    |ACABA;
|FINSI;

|SI #0#11 > #0#12;
    |MENAV "      La fecha alta es mayor a la fecha baja.";
    |ERROR;
|FINSI;
|FPRC;

|PROCESO anyos_19; |TIPO 0;
|SI tip_ele ! "A"; |ACABA; |FINSI;
campo = Campo - 1;
|SI #0campo [ anyos_19; |Y #0Campo > anyos_19;
    |MENAV "     El asalariado cumple 19 A¤os, separe en dos periodos.";
    |ERROR;
|FINSI;
|FPRC;

|PROCESO pinta_fec; |TIPO 7;
|SI modelito ! 1; |ACABA; |FINSI;

campo = Campo;

alfa = "01.01." + (fecha_dper % -104);
#0#2 = alfa; |PINTA #0#2;
alfa = "31.12." + (fecha_hper % -104);
#0#3 = alfa;

#0#12 = fecha_hper;

|SI ejer_com = "N"; |Y fecha_hper > anyos_18; |Y fecha_dper [ anyos_18;
    #0#3  = anyos_18; |PINTA #0#3;
    #0#12 = anyos_18; |PINTA #0#12;
|FINSI;

|SI tip_ele = "A";
    |SI fecha_hper > anyos_19; |Y fecha_hper < anyos_20; |Y fecha_dper [ anyos_19;
        #0#3  = anyos_19;
        #0#12 = anyos_19;
    |FINSI;
|FINSI;

|SI tip_ele = "H";
    |SI fecha_hper > anyos_18;
        |SI ejer_com = "S"; #0#3  = anyos_18; |FINSI;
        |SI ejer_com = "S"; #0#12 = anyos_18; |FINSI;
    |FINSI;
|FINSI;

|PINTA #0#3;
|PINTA #0#12;
#0#11 = fecha_dper;  |PINTA #0#11;
Campo = campo;
|FPRC;

|PROCESO calcu_dia; |TIPO 7;
#0#4  = (#0#3  - #0#2)  + 1;   |PINTA #0#4;
#0#13 = (#0#12 - #0#11) + 1;   |PINTA #0#13;
|FPRC;

|PROCESO jor_comp1; |TIPO 0;
|SI #0#5 = "S";
    |CAMPO_MODIFICA #0#6, 1, "N";
    |CAMPO_MODIFICA #0#7, 1, "N";
    |CAMPO_MODIFICA #0#8, 1, "N";
    |CAMPO_MODIFICA #0#9, 1, "N";
    #0#6 = 0; |PINTA #0#6;
    #0#7 = 0; |PINTA #0#7;
    #0#8 = 0; |PINTA #0#8;
    #0#9 = 0; |PINTA #0#9;

    |SI es_porrat = "N";
         #0#0 = #0#20;
    |SINO;
         #0#0 = (#0#4 / dias_ejer) * #0#20;
    |FINSI;
    |PINTA #0#0;
    |ACABA;
|FINSI;

|CAMPO_MODIFICA #0#6, 1, "S";
|CAMPO_MODIFICA #0#7, 1, "S";
|CAMPO_MODIFICA #0#8, 1, "S";
|CAMPO_MODIFICA #0#9, 1, "S";
|FPRC;

|PROCESO jor_comp2; |TIPO 0;
|SI #0#14 = "S";
    |CAMPO_MODIFICA #0#15, 1, "N";
    |CAMPO_MODIFICA #0#16, 1, "N";
    |CAMPO_MODIFICA #0#17, 1, "N";
    |CAMPO_MODIFICA #0#18, 1, "N";

    #0#15 = 0;  |PINTA #0#15;
    #0#16 = 0;  |PINTA #0#16;
    #0#17 = 0;  |PINTA #0#17;
    #0#18 = 0;  |PINTA #0#18;

    |SI es_porrat = "N";
        #0#1 = #0#21;
    |SINO;
        #0#1 = (#0#13 / dias_ejer) * #0#21;
    |FINSI;
    |PINTA #0#1;
    |ACABA;
|FINSI;

|SI #0#10 = "N"; |ACABA; |FINSI;

|CAMPO_MODIFICA #0#15, 1, "S";
|CAMPO_MODIFICA #0#16, 1, "S";
|CAMPO_MODIFICA #0#17, 1, "S";
|CAMPO_MODIFICA #0#18, 1, "S";
|FPRC;

|PROCESO jor_nocomp; |TIPO 0;
|SI #0Campo = Contenido; |ACABA; |FINSI;
|SI #0#5    ! "N";       |ACABA; |FINSI;

semanas = #0#4 / 7;
#0#8    = #0#6 * #0#7 * semanas;
|PINTA #0#8;
|FPRC;

|PROCESO jor_nocomd; |TIPO 0;
|SI #0Campo = Contenido; |ACABA; |FINSI;
|SI #0#14   ! "N";       |ACABA; |FINSI;

semanas = #0#13 / 7;
#0#17    = #0#15 * #0#16 * semanas;
|PINTA #0#17;
|FPRC;

|PROCESO resultado; |TIPO 7;
|SI es_porrat = "N";
    #0#0 = #0#20;
|SINO;
    #0#0 = (#0#4 / dias_ejer) * #0#20;
|FINSI;

|SI es_porrat = "N";
    #0#1 = #0#21;
|SINO;
    #0#1 = (#0#13 / dias_ejer) * #0#21;
|FINSI;

|SI #0#5 = "N";
    #0#0 = (#0#8 / #0#9) * #0#20;
|FINSI;

|SI #0#14 = "N";
    #0#1 = (#0#17 / #0#18) * #0#21;
|FINSI;

|SI tip_ele = "A";
    |SI #0#3 [ anyos_19; |O alfanumer9 = "S";
        #0#0 = #0#0 * 0.60;
    |FINSI;

    |SI #0#12 [ anyos_19; |O alfanumer9 = "S";
        #0#1 = #0#1 * 0.60;
    |FINSI;
|FINSI;

|PINTA #0#0;
|PINTA #0#1;
|FPRC;

|PROCESO activado; |TIPO 0;
|CAMPO_MODIFICA #0#11, 1, "N";
|CAMPO_MODIFICA #0#12, 1, "N";
|CAMPO_MODIFICA #0#14, 1, "N";
|CAMPO_MODIFICA #0#15, 1, "N";
|CAMPO_MODIFICA #0#16, 1, "N";
|CAMPO_MODIFICA #0#17, 1, "N";
|CAMPO_MODIFICA #0#18, 1, "N";

|SI #0#10 = "N"; |ACABA; |FINSI;

|CAMPO_MODIFICA #0#11, 1, "S";
|CAMPO_MODIFICA #0#12, 1, "S";
|CAMPO_MODIFICA #0#14, 1, "S";

|SI #0#14 = "S";
    |CAMPO_MODIFICA #0#15, 1, "S";
    |CAMPO_MODIFICA #0#16, 1, "S";
    |CAMPO_MODIFICA #0#17, 1, "S";
    |CAMPO_MODIFICA #0#18, 1, "S";
|FINSI;

|SI ejer_com = "S";
    |CAMPO_MODIFICA #0#11, 1, "N";
    |CAMPO_MODIFICA #0#12, 1, "N";
|FINSI;

|SI tip_ele = "V";
    |CAMPO_MODIFICA #0#14, 1, "N";
    #0#14 = "S";
    |PINTA #0#14;
|FINSI;
|FPRC;

|PROCESO copia; |TIPO 0;
campo = Campo;
|SI #0#10 = "S"; |ACABA; |FINSI;

#0#01 = #0#00;  |PINTA #0#01;
#0#11 = #0#02;  |PINTA #0#11;
#0#12 = #0#03;  |PINTA #0#12;
#0#13 = #0#04;  |PINTA #0#13;
#0#14 = #0#05;  |PINTA #0#14;
#0#15 = #0#06;  |PINTA #0#15;
#0#16 = #0#07;  |PINTA #0#16;
#0#17 = #0#08;  |PINTA #0#17;
#0#18 = #0#09;  |PINTA #0#18;
#0#21 = #0#20;  |PINTA #0#21;

|SI #0#11 < fecha_dper; #0#11 = fecha_dper; |PINTA #0#11; |FINSI;
|SI #0#12 > fecha_hper; #0#12 = fecha_hper; |PINTA #0#12; |FINSI;

Campo = campo;
|FPRC;
