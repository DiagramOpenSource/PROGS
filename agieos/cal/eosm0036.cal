|FICHEROS;
     eosm0028;
     eosm0029;
     eosm0030;
     eosm0032,MANTE;
     eosm0034,MANTE;
     eosm0035,MANTE;
     eosm0036,MANTE;

     eosclipr;
     dsmom073;

     eosw0003;
     eosw0094,MANTE;
     eosw0095,MANTE;
|FIN;

|VARIABLES;
      nTecla      = 0;
      nPtec       = 0;
      nCampo      = 0;
      nCampo1     = 0;
      nCampo2     = 0;
      nCampo3     = 0;
      nEdad       = 0;
      nMes        = 0;
      nPercDin    = 0;
      nReteDin    = 0;
      nPercEsp    = 0;
      nAcumEsp    = 0;
      nPercDinIT  = 0;
      nReteDinIT  = 0;
      nPercEspIT  = 0;
      nAcumEspIT  = 0;
      aRepe       = "";
      nCuot1      = 0;
      nCuot2      = 0;
      nCuot3      = 0;
      nCuot4      = 0;
      nNume1      = 0;
      nNume2      = 0;
      nCampoD     = 0;
      nCampoO     = 0;
      nForma      = 0;
      nConta      = 0;
      nModo       = 0;
      nSw         = 0;

      aTecla      = "";
      aTecla1     = "";
      aTecla2     = "";
      aFichero    = "";
      aAlfa       = "";

      &enMensaje = 1;
      &eaNif     = "";
      &enBoton1  = -1;

     &eaVarDni   = "";
     &enCalcCif  = 0;
     &enEjerIRPF = 0;
|FIN;

|PROCESO Tipo12w94;  |TIPO 12;
|FPRC;

|PROCESO Borra35;
     |BORRA 020#eosm0035.a;
     |LIBERA #eosm0035;
|FPRC;

|DEFBUCLE eosm0035;
     #eosm0035#1;
     ;
     #eosm0030#0, #eosm0030#1, "            ", " ", "  ", 0,    0;
     #eosm0030#0, #eosm0030#1, "zzzzzzzzzzzz", "z", "zz", 3, 9999;
     be;
     NULL, Borra35;
|FIN;

|PROCESO Graba35;
     #eosm0035#0  = #eosm0036#0;
     #eosm0035#1  = #eosm0036#1;
     #eosm0035#2  = #eosm0036#2;
     #eosm0035#3  = #eosm0036#4;
     #eosm0035#4  = #eosm0036#5;
     #eosm0035#5  = #eosm0036#6;
     #eosm0035#6  = nMes;
     #eosm0035#7  = nPercDin;
     #eosm0035#9  = nReteDin;
     #eosm0035#8  = (#eosm0035#9 / #eosm0035#7) * 100;
     #eosm0035#10 = nPercEsp;
     #eosm0035#12 = nAcumEsp;
     #eosm0035#11 = (#eosm0035#12 / #eosm0035#10) * 100;
     #eosm0035#13 = aRepe;
     #eosm0035#14 = nCuot1;
     #eosm0035#15 = nCuot2;
     #eosm0035#16 = nCuot3;
     #eosm0035#17 = nCuot4;
     #eosm0035#18 = nPercDinIT;
     #eosm0035#20 = nReteDinIT;
     #eosm0035#19 = (#eosm0035#20 / #eosm0035#18) * 100;
     #eosm0035#21 = nPercEspIT;
     #eosm0035#23 = nAcumEspIT;
     #eosm0035#22 = (#eosm0035#23 / #eosm0035#21) * 100;
     #eosm0035#24 = aRepe;
     |GRABA 020#eosm0035.n;
     |LIBERA #eosm0035;
|FPRC;

|PROCESO eosm0036;
     |SI #eosm0036#10 = 0;  |Y #eosm0036#11  = 0;
      |Y #eosm0036#66 = 0;  |Y #eosm0036#67  = 0;
         nMes = 12;
         |SI #eosm0036#3 ! 0;
             nMes = #eosm0036#3;
         |FINSI;

         nPercDin   = #eosm0036#7;
         nReteDin   = #eosm0036#8;
         nPercDinIT = #eosm0036#63;
         nReteDinIT = #eosm0036#64;

         nCuot1   = #eosm0036#12;
         nCuot2   = #eosm0036#13;
         nCuot3   = #eosm0036#14;
         nCuot4   = #eosm0036#15;

         nPercEsp   = 0;
         nAcumEsp   = 0;
         nPercEspIT = 0;
         nAcumEspIT = 0;
         aRepe      = "N";
         |HAZ Graba35;
     |SINO;
         nNume1 = #eosm0036#10 + #eosm0036#66;
         nNume2 = #eosm0036#11 + #eosm0036#67;
         |SI nNume1 = nNume2;
             nMes = 12;
             |SI #eosm0036#3 ! 0;
                 nMes = #eosm0036#3;
             |FINSI;

             nPercDin   = #eosm0036#7;
             nReteDin   = #eosm0036#8;
             nPercDinIT = #eosm0036#63;
             nReteDinIT = #eosm0036#64;
             nPercEsp   = #eosm0036#9;
             nAcumEsp   = #eosm0036#10;
             nPercEspIT = #eosm0036#65;
             nAcumEspIT = #eosm0036#66;
             aRepe      = "S";
             nCuot1     = #eosm0036#12;
             nCuot2     = #eosm0036#13;
             nCuot3     = #eosm0036#14;
             nCuot4     = #eosm0036#15;
             |HAZ Graba35;
         |SINO;
             nMes = 11;
             |SI #eosm0036#3 ! 0;
                 nMes = #eosm0036#3;
             |FINSI;

             nPercDin   = #eosm0036#7;
             nReteDin   = #eosm0036#8;
             nPercDinIT = #eosm0036#63;
             nReteDinIT = #eosm0036#64;
             nPercEsp   = #eosm0036#9;
             nAcumEsp   = #eosm0036#10 - #eosm0036#11;
             nPercEspIT = #eosm0036#65;
             nAcumEspIT = #eosm0036#66 - #eosm0036#67;

             aRepe    = "N";
             nCuot1   = #eosm0036#12;
             nCuot2   = #eosm0036#13;
             nCuot3   = #eosm0036#14;
             nCuot4   = #eosm0036#15;
             |HAZ Graba35;

             nMes = 12;
             |SI #eosm0036#3 ! 0;
                 nMes = #eosm0036#3;
             |FINSI;

             nPercDin   = 0;
             nReteDin   = 0;
             nPercDinIT = 0
             nReteDinIT = 0;
             nPercEsp   = 0;
             nPercEspIT = 0;
             nAcumEsp   = #eosm0036#11;
             nAcumEspIT = #eosm0036#67;
             aRepe      = "S";
             nCuot1     = 0;
             nCuot2     = 0;
             nCuot3     = 0;
             nCuot4     = 0;
             |HAZ Graba35;
         |FINSI;
     |FINSI;

     #eosm0028#0 = #eosm0036#0;
     |LEE 101#eosm0028.=;
     |SI FSalida ! 0;
         #eosm0028#0 = #eosm0036#0;
         #eosm0028#1 = #eosm0030#2;
         #eosm0028#2 = "T";
         |GRABA 020#eosm0028.n;
     |FINSI;
     |LIBERA #eosm0028;

     #eosm0029#0 = #eosm0036#0;
     #eosm0029#1 = #eosm0036#2;
     |LEE 101#eosm0029.=;
     |SI FSalida ! 0;
         |DDEFECTO #eosm0029;
         #eosm0029#0  = #eosm0036#0;
         #eosm0029#1  = #eosm0036#2;
         #eosm0029#2  = #eosm0036#17;
         #eosm0029#28 = #eosm0036#16;
         |GRABA 020#eosm0029.b;
     |FINSI;

     |SI #eosm0036#4 = "A";  #eosm0029#6  = #eosm0036#6;  |FINSI;

     |SI #eosm0036#4 = "A";  |O #eosm0036#4 = "B";  |O #eosm0036#4 = "C";  |O #eosm0036#4 = "D";
         #eosm0029#3  = #eosm0036#18;
         #eosm0029#5  = #eosm0036#20;
         #eosm0029#7  = #eosm0036#22;
         #eosm0029#29 = #eosm0036#23;
         #eosm0029#93 = #eosm0036#61;
         #eosm0029#94 = #eosm0036#62;
         |GRABA 020#eosm0029.a;
         |LIBERA #eosm0029;
     |FINSI;
     |LIBERA #eosm0029;

     #eosclipr#0 = #eosm0036#2;
     |LEE 101#eosclipr.=;
     |SI FSalida ! 0;
         |DDEFECTO #eosclipr;
         #eosclipr#0  = #eosm0036#2;
         #eosclipr#1  = #eosm0036#17;
         #eosclipr#7  = #eosm0036#21;
         |GRABA 020#eosclipr.n;
     |FINSI;
     |LIBERA #eosclipr;
|FPRC;

|DEFBUCLE eosm0036;
     #eosm0036#1;
     ;
     #eosm0030#0, #eosm0030#1, "            ", 0000, " ", "  ", 0;
     #eosm0030#0, #eosm0030#1, "zzzzzzzzzzzz", 9999, "z", "zz", 9;
     be;
     NULL, eosm0036;
|FIN;

|PROCESO PorEntero;
     nCampoD = Campo - 1;

     |SI #eosw0095#Campo# > #eosw0095#nCampoD#;
         |MENAV "     No puede ser superior al Campo Anterior.";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO TotalPersonas;
     #eosw0094#6 = #eosw0094#1 + #eosw0094#2 + #eosw0094#3 + #eosw0094#4 + #eosw0094#5;
     |PINTA #eosw0094#6;
|FPRC;

|PROCESO Boton1;
     nPtec = 828;
     |PTEC nPtec;
|FPRC;

|PROCESO Baja29F36;
     #eosm0029#0 = #eosm0036#0;
     #eosm0029#1 = "           ";
|FPRC;

|PROCESO Alta29F36;
     #eosm0029#0 = #eosm0036#0;
     #eosm0029#1 = "zzzzzzzzzzzz";
|FPRC;

|PROCESO T7C2F36;  |TIPO 7;
     |SI #eosm0036#4 ! "A"; |Y #eosm0036#4 ! "B";  |Y #eosm0036#4 ! "C";  |Y #eosm0036#4 ! "D";
         |ESTADO_CONTROL enBoton1, "DISABLE";
     |SINO;
         |ESTADO_CONTROL enBoton1, "ENABLE";
     |FINSI;
|FPRC;

|PROCESO T2F36;  |TIPO 2;
     nForma = 0 +. 1;
     |SI nForma = 1;
         |SI #eosm0036#4 ! "A"; |Y #eosm0036#4 ! "B";  |Y #eosm0036#4 ! "C";  |Y #eosm0036#4 ! "D";
             |ACABA;
         |FINSI;

         |ESTADO_CONTROL enBoton1, "HIDE";

         |PUSHV 0501 2380;

         |PARA nCampoD = 38;  |SI nCampoD [ 60;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoO = nCampoD - 38;
               #eosw0095#nCampoO# = #eosm0036#nCampoD#;
         |SIGUE;

         |PINPA #0#eosw0095;

         |C_V #eosw0095#20, 1, "S";  |C_M #eosw0095#20, 1, "S";
         |C_V #eosw0095#21, 1, "S";  |C_M #eosw0095#21, 1, "S";
         |C_V #eosw0095#22, 1, "S";  |C_M #eosw0095#22, 1, "S";

         |PINDA #0#eosw0095;
         |ENDATOS #1#eosw0095;
         |SI FSalida = 0;
             |PARA nCampoD = 38;  |SI nCampoD [ 60;  |HACIENDO nCampoD = nCampoD + 1;
                   nCampoO = nCampoD - 38;
                   #eosm0036#nCampoD# = #eosw0095#nCampoO#;
             |SIGUE;
         |FINSI;
         |POPV;

         |ESTADO_CONTROL enBoton1, "SHOW";
     |FINSI;
|FPRC;

|PROCESO LetraDniF36;  |TIPO 11;
     nTecla = FSalida;

     |SI nTecla = 10;
         eaVarDni =  #eosm0036#Campo#;
         enCalcCif = 1;
         |HAZ CalculoDNI;
         #eosm0036#Campo# = eaVarDni;
         |PINTA #eosm0036#Campo#;
         |ERROR;
     |FINSI;

     |SI nTecla = 11;
         |ESTADO_CONTROL enBoton1, "HIDE";

         enMensaje = 1;
         eaNif     = "";

         |PUSHV 0501 2380;
         |ENTLINEAL #1#eosm0029, -2, 4, 22, 1, Baja29F36, Alta29F36;
         |POPV;
         |SI eaNif ! "";
             #eosm0036#2 = eaNif;
             |PINTA #eosm0036#2;
         |FINSI;

         |ESTADO_CONTROL enBoton1, "SHOW";
         |ERROR;
     |FINSI;

     |SI nTecla = 12;
         |ESTADO_CONTROL enBoton1, "HIDE";

         |PUSHV 0501 2380;
         |CUADRO 0709 2365;
         |BLANCO 0810 2264;
         |PINTA 0810, "ESTE PROCESO ES SOLO PARA AQUELLOS QUE HAN INTRODUCIDO ";
         |PINTA 0910, "MANUALMENTE POR EL MANTENIMIENTO DEL 110 Y 190 TODAS   ";
         |PINTA 1010, "LAS RETENCIONES. EL PROCESO BORRA LA ENTRADA POR TRABA-";
         |PINTA 1110, "DORES Y CREA UN APUNTE POR CADA PERCEPTOR QUE HAY EN EL";
         |PINTA 1210, "190, PARA PODER CALCULAR EL MODELO DEL 110 DEL ULTIMO  ";
         |PINTA 1310, "PERIODO Y PODER EMITIR LOS CERTIFICADOS.               ";
         |PINTA 1510, "NOTA --> EL PROCESO SI EL PERCEPTOR NO EXISTIERA EN EL ";
         |PINTA 1610, "MANTENIMIENTO DE RELACION DE TRABAJADORES LOS CREARA   ";
         |PINTA 1710, "PERO DEBERAN DE REVISARSE YA QUE LOS DATOS DE HIJOS Y  ";
         |PINTA 1810, "PORCENTAJE DE DISCAPACIDAD NO LOS TENEMOS INFORMADOS   ";
         |PINTA 1910, "EN SU TOTALIDAD EN EL MANTENIMIENTO DEL 190.           ";
         |PINTA 2010, "컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴";
         |PINTA 2110, "PULSE ESCAPE PARA ABORTAR                              ";
         |PINTA 2210, "PULSE [F10]  PARA CONTINUAR.                           ";

         aTecla   = "";
         aTecla1  = &255 + "806";
         aTecla2  = &255 + "832";
         |PARA; |SI aTecla ! aTecla1; |Y aTecla ! aTecla2;  |HACIENDO;
                |LEETECLA aTecla;
         |SIGUE;

         |SI aTecla = aTecla1;  |ERROR;  |POPV;  |ACABA;  |FINSI;

         |CONFI "2400NEsta seguro de Continuar : ";
         |SI FSalida ! 0;  |ERROR;  |POPV;  |ACABA;  |FINSI;
         |POPV;

         |BUCLE eosm0035;

         |ABRE #eosm0028;
         |ABRE #eosm0029;
         |ABRE #eosm0035;
         |ABRE #eosclipr;

         |BUCLE eosm0036;

         |CIERRA #eosm0028;
         |CIERRA #eosm0029;
         |CIERRA #eosm0035;
         |CIERRA #eosclipr;

         #eosm0036#0 = #eosm0030#0;
         #eosm0036#1 = #eosm0030#1;
         #eosm0036#2 = "            ";
         #eosm0036#3 = 0;
         #eosm0036#4 = " ";
         #eosm0036#5 = "  ";
         #eosm0036#6 = 0;
         |LEE 040#eosm0036.];

         |PTEC 807;
         |PTEC 807;

         |ESTADO_CONTROL enBoton1, "SHOW";
     |FINSI;

     |SI nTecla = 14;
         |SI #eosm0036#4 ! "A"; |Y #eosm0036#4 ! "B";  |Y #eosm0036#4 ! "C";  |Y #eosm0036#4 ! "D";
             |ERROR;
             |ACABA;
         |FINSI;

         |ESTADO_CONTROL enBoton1, "HIDE";

         |PUSHV 0501 2380;
         |PARA nCampoD = 38;  |SI nCampoD [ 60;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoO = nCampoD - 38;
               #eosw0095#nCampoO# = #eosm0036#nCampoD#;
         |SIGUE;

         |PINPA #0#eosw0095;

         |C_V #eosw0095#20, 1, "S";
         |C_V #eosw0095#21, 1, "S";
         |C_V #eosw0095#22, 1, "S";

         |PINDA #0#eosw0095;
         |LEETECLA aTecla;
         |POPV;

         |ESTADO_CONTROL enBoton1, "SHOW";

         |ERROR;
     |FINSI;
|FPRC;

|PROCESO LetraDniF36C;  |TIPO 6;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     eaVarDni  = #eosm0036#Campo#;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     #eosm0036#Campo# = eaVarDni;
     |PINTA #eosm0036#Campo#;
|FPRC;

|PROCESO T7C30F36;  |TIPO 7;
     |C_M #eosm0036#30, 1, "S";
     |SI #eosm0030#3 ! "C";
         |C_M #eosm0036#30, 1, "N";
         #eosm0036#30 = "N";
         |PINTA #eosm0036#30;
     |FINSI;
|FPRC;

|PROCESO CalnSw;
    nSw = 0;
    |SI #eosm0036#4 ! "A";  |Y #eosm0036#4 ! "B";
        |Y #eosm0036#4 ! "C"; |Y #eosm0036#4 ! "E";
           |Y #eosm0036#4 ! "M";
            nSw = 1;
    |FINSI;

    |SI #eosm0036#4 = "L";
        |SI #eosm0036#5 = "05"; |O #eosm0036#5 = "10"; |O #eosm0036#5 = "27";
            nSw = 2;
        |FINSI;
    |FINSI;

    |SI #eosm0036#4 = "E";
        nSw = 2;
        |SI #eosm0036#5 ! "01"; |Y #eosm0036#5 ! "02";
             nSw = 1;
        |FINSI;
    |FINSI;
    |SI #eosm0036#4 = "B"; |Y #eosm0036#5 = "02";
        nSw = 1;
    |FINSI;
|FPRC;

|PROCESO T7C6F36;  |TIPO 7;
     |C_M #eosm0036#6,  1, "S";
     |C_M #eosm0036#12, 1, "S";
     |C_M #eosm0036#13, 1, "S";
     |C_M #eosm0036#14, 1, "S";
     |C_M #eosm0036#15, 1, "S";
     |C_M #eosm0036#18, 1, "S";
     |C_M #eosm0036#19, 1, "S";
     |C_M #eosm0036#20, 1, "S";
     |C_M #eosm0036#22, 1, "S";

     |HAZ CalnSw;
     |SI nSw ! 0;
         |C_M #eosm0036#12, 1, "N";   #eosm0036#12 = 0;   |PINTA #eosm0036#12;
         |SI nSw = 1;
             |C_M #eosm0036#13, 1, "N";   #eosm0036#13 = 0;   |PINTA #eosm0036#13;
         |FINSI;
         |C_M #eosm0036#14, 1, "N";   #eosm0036#14 = 0;   |PINTA #eosm0036#14;
         |C_M #eosm0036#15, 1, "N";   #eosm0036#15 = 0;   |PINTA #eosm0036#15;
         |C_M #eosm0036#18, 1, "N";   #eosm0036#18 = 0;   |PINTA #eosm0036#18;
         |C_M #eosm0036#19, 1, "N";   #eosm0036#19 = 0;   |PINTA #eosm0036#19;
         |C_M #eosm0036#20, 1, "N";   #eosm0036#20 = 0;   |PINTA #eosm0036#20;
         |C_M #eosm0036#22, 1, "N";   #eosm0036#22 = "";  |PINTA #eosm0036#22;

         #eosm0036#24 = 0;
         #eosm0036#25 = 0;
         #eosm0036#26 = 0;
         #eosm0036#27 = 0;
         #eosm0036#28 = 0;
         #eosm0036#29 = 0;
         #eosm0036#31 = 0;
         #eosm0036#32 = 0;
         #eosm0036#33 = 0;
         #eosm0036#34 = 0;
         #eosm0036#35 = 0;
         |PARA nCampoD = 38;  |SI nCampoD [ 61;  |HACIENDO nCampoD = nCampoD + 1;
               #eosm0036#nCampoD# = 0;
         |SIGUE;
     |FINSI;

     |SI #eosm0036#4 ! "A";
         |C_M #eosm0036#6, 1, "N";
         #eosm0036#6 = 0;  |PINTA #eosm0036#6;
         |ACABA;
     |FINSI;

     |ABRE #eosm0029;
     #eosm0029#0 = #eosm0036#0;
     #eosm0029#1 = #eosm0036#2;
     |LEE 040#eosm0029.=;
     |SI FSalida ! 0;  |CIERRA #eosm0029;  |ACABA;  |FINSI;
     |CIERRA #eosm0029;

     #eosm0036#6  = #eosm0029#6;  |PINTA #eosm0036#6;
|FPRC;

|PROCESO eosw0003_F36;
     nConta = nConta + 1;

     |SI nConta = 1;  #eosm0036#58 = #eosw0003#2;  |FINSI;
     |SI nConta = 2;  #eosm0036#59 = #eosw0003#2;  |FINSI;
     |SI nConta = 3;  #eosm0036#60 = #eosw0003#2;  |FINSI;

     |SI nConta ] 3;  |ERROR10;  |FINSI;
|FPRC;

|DEFBUCLE eosw0003_F36;
     #eosw0003#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, eosw0003_F36;
|FIN;

|PROCESO Graba903_F36;
     #eosw0003#0 = #eosm0029#nCampo#;
     #eosw0003#1 = nCampo;
     |SI #eosm0029#nCampo3# = "S";
         #eosw0003#2 = "1";
     |SINO;
         #eosw0003#2 = "2";
     |FINSI;
     |GRABA 020#eosw0003.n;
     |LIBERA #eosw0003;
|FPRC;

|PROCESO GrabaDes2016;
     |SI #eosm0029#nCampo# = 0;
         |ACABA;
     |FINSI;

     nEdad = #eosm0036#1 - #eosm0029#nCampo#;
     |SI nEdad < 0;
         |ACABA;
     |FINSI;

     |SI #eosm0029#nCampo1# ] 65;
         #eosm0036#46 = #eosm0036#46 + 1;
         |SI #eosm0029#nCampo3# = "S";
             #eosm0036#47 = #eosm0036#47 + 1;
         |FINSI;

         |SI nEdad < 3;
             #eosm0036#38 = #eosm0036#38 + 1;
             |SI #eosm0029#nCampo3# = "S";
                 #eosm0036#39 = #eosm0036#39 + 1;
             |FINSI;
         |SINO;
             #eosm0036#40 = #eosm0036#40 + 1;
             |SI #eosm0029#nCampo3# = "S";
                 #eosm0036#41 = #eosm0036#41 + 1;
             |FINSI;
         |FINSI;

         |HAZ Graba903_F36;
     |SINO;
         |SI #eosm0029#nCampo1# ] 33;
             #eosm0036#42 = #eosm0036#42 + 1;
             |SI #eosm0029#nCampo3# = "S";
                 #eosm0036#43 = #eosm0036#43 + 1;
             |FINSI;

             |SI #eosm0029#nCampo2# = "S";
                 #eosm0036#44 = #eosm0036#44 + 1;
                 |SI #eosm0029#nCampo3# = "S";
                     #eosm0036#45 = #eosm0036#45 + 1;
                 |FINSI;
             |FINSI;

             |SI nEdad < 3;
                 #eosm0036#38 = #eosm0036#38 + 1;
                 |SI #eosm0029#nCampo3# = "S";
                     #eosm0036#39 = #eosm0036#39 + 1;
                 |FINSI;
             |SINO;
                 #eosm0036#40 = #eosm0036#40 + 1;
                 |SI #eosm0029#nCampo3# = "S";
                     #eosm0036#41 = #eosm0036#41 + 1;
                 |FINSI;
             |FINSI;

             |HAZ Graba903_F36;
         |SINO;
             |SI nEdad < 3;
                 #eosm0036#38 = #eosm0036#38 + 1;
                 |SI #eosm0029#nCampo3# = "S";
                     #eosm0036#39 = #eosm0036#39 + 1;
                 |FINSI;

                 |HAZ Graba903_F36;
             |SINO;
                 |SI nEdad < 25;
                     #eosm0036#40 = #eosm0036#40 + 1;
                     |SI #eosm0029#nCampo3# = "S";
                         #eosm0036#41 = #eosm0036#41 + 1;
                     |FINSI;

                     |HAZ Graba903_F36;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO GrabaAsc2016;
     |SI #eosm0029#nCampo# = 0;
         |ACABA;
     |FINSI;

     nEdad = #eosm0036#1 - #eosm0029#nCampo#;
     |SI nEdad < 0;
         |ACABA;
     |FINSI;

     |SI #eosm0029#nCampo1# = "2";
         #eosm0036#56 = #eosm0036#56 + 1;
         |SI #eosm0029#nCampo3# = 1;
             #eosm0036#57 = #eosm0036#57 + 1;
         |FINSI;

         |SI nEdad < 75;
             #eosm0036#48 = #eosm0036#48 + 1;
             |SI #eosm0029#nCampo3# = 1;
                 #eosm0036#49 = #eosm0036#49 + 1;
             |FINSI;
         |SINO;
             #eosm0036#50 = #eosm0036#50 + 1;
             |SI #eosm0029#nCampo3# = 1;
                 #eosm0036#51 = #eosm0036#51 + 1;
             |FINSI;
         |FINSI;
     |SINO;
         |SI #eosm0029#nCampo1# = "1";
             #eosm0036#52 = #eosm0036#52 + 1;
             |SI #eosm0029#nCampo3# = 1;
                 #eosm0036#53 = #eosm0036#53 + 1;
             |FINSI;

             |SI #eosm0029#nCampo2# = "S";
                 #eosm0036#54 = #eosm0036#54 + 1;
                 |SI #eosm0029#nCampo3# = 1;
                     #eosm0036#55 = #eosm0036#55 + 1;
                 |FINSI;
             |FINSI;

             |SI nEdad < 75;
                 #eosm0036#48 = #eosm0036#48 + 1;
                 |SI #eosm0029#nCampo3# = 1;
                     #eosm0036#49 = #eosm0036#49 + 1;
                 |FINSI;
             |SINO;
                 #eosm0036#50 = #eosm0036#50 + 1;
                 |SI #eosm0029#nCampo3# = 1;
                     #eosm0036#51 = #eosm0036#51 + 1;
                 |FINSI;
             |FINSI;
         |SINO;
             |SI nEdad < 75;
                 #eosm0036#48 = #eosm0036#48 + 1;
                 |SI #eosm0029#nCampo3# = 1;
                     #eosm0036#49 = #eosm0036#49 + 1;
                 |FINSI;
             |SINO;
                 #eosm0036#50 = #eosm0036#50 + 1;
                 |SI #eosm0029#nCampo3# = 1;
                     #eosm0036#51 = #eosm0036#51 + 1;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Coge2016;
     aFichero = ("03" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #eosw0003#aFichero#;
     |ABRE #eosw0003;  |CIERRA #eosw0003;  |DELINDEX #eosw0003;

     |ABRE #eosw0003;
     |PARA nCampo = 8;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 2;
           |SI nCampo = 8;   nCampo1 = 9;   nCampo2 = 63;  nCampo3 = 31;  |FINSI;
           |SI nCampo = 10;  nCampo1 = 11;  nCampo2 = 64;  nCampo3 = 32;  |FINSI;
           |SI nCampo = 12;  nCampo1 = 13;  nCampo2 = 65;  nCampo3 = 33;  |FINSI;
           |SI nCampo = 14;  nCampo1 = 15;  nCampo2 = 66;  nCampo3 = 34;  |FINSI;
           |SI nCampo = 16;  nCampo1 = 17;  nCampo2 = 67;  nCampo3 = 35;  |FINSI;
           |SI nCampo = 18;  nCampo1 = 19;  nCampo2 = 68;  nCampo3 = 36;  |FINSI;
           |SI nCampo = 20;  nCampo1 = 21;  nCampo2 = 69;  nCampo3 = 37;  |FINSI;
           |SI nCampo = 22;  nCampo1 = 23;  nCampo2 = 70;  nCampo3 = 38;  |FINSI;
           |SI nCampo = 24;  nCampo1 = 25;  nCampo2 = 71;  nCampo3 = 39;  |FINSI;
           |SI nCampo = 26;  nCampo1 = 27;  nCampo2 = 72;  nCampo3 = 40;  |FINSI;

           |HAZ GrabaDes2016;
     |SIGUE;
     |CIERRA #eosw0003;

     #eosm0036#58 = "0";
     #eosm0036#59 = "0";
     #eosm0036#60 = "0";
     nConta = 0;
     |BUCLE eosw0003_F36;

     |DELINDEX #eosw0003;

     |PARA nCampo = 73;  |SI nCampo [ 82;  |HACIENDO nCampo = nCampo + 1;
           |SI nCampo = 73;  nCampo1 = 51;  nCampo2 = 83;  nCampo3 = 41;  |FINSI;
           |SI nCampo = 74;  nCampo1 = 52;  nCampo2 = 84;  nCampo3 = 42;  |FINSI;
           |SI nCampo = 75;  nCampo1 = 53;  nCampo2 = 85;  nCampo3 = 43;  |FINSI;
           |SI nCampo = 76;  nCampo1 = 54;  nCampo2 = 86;  nCampo3 = 44;  |FINSI;
           |SI nCampo = 77;  nCampo1 = 55;  nCampo2 = 87;  nCampo3 = 45;  |FINSI;
           |SI nCampo = 78;  nCampo1 = 56;  nCampo2 = 88;  nCampo3 = 46;  |FINSI;
           |SI nCampo = 79;  nCampo1 = 57;  nCampo2 = 89;  nCampo3 = 47;  |FINSI;
           |SI nCampo = 80;  nCampo1 = 58;  nCampo2 = 90;  nCampo3 = 48;  |FINSI;
           |SI nCampo = 81;  nCampo1 = 59;  nCampo2 = 91;  nCampo3 = 49;  |FINSI;
           |SI nCampo = 82;  nCampo1 = 60;  nCampo2 = 92;  nCampo3 = 50;  |FINSI;

           |HAZ GrabaAsc2016;
     |SIGUE;
|FPRC;

|PROCESO T7C7F36;  |TIPO 7;
     |SI #eosm0036#4 ! "A"; |Y #eosm0036#4 ! "B";  |Y #eosm0036#4 ! "C";  |Y #eosm0036#4 ! "D";
         |ACABA;
     |FINSI;

     |ABRE #eosm0029;
     #eosm0029#0 = #eosm0036#0;
     #eosm0029#1 = #eosm0036#2;
     |LEE 040#eosm0029.=;
     |SI FSalida ! 0;  |CIERRA #eosm0029;  |ACABA;  |FINSI;
     |CIERRA #eosm0029;

     |ABRE #eosclipr;
     #eosclipr#0 = #eosm0036#2;
     |LEE 040#eosclipr.=;
     |SI FSalida ! 0;  |DDEFECTO #eosclipr;  |FINSI;
     |CIERRA #eosclipr;

     #eosm0036#16 = #eosm0029#28;   |PINTA #eosm0036#16;
     #eosm0036#17 = #eosm0029#2;    |PINTA #eosm0036#17;
     #eosm0036#18 = #eosm0029#3;    |PINTA #eosm0036#18;

     #eosm0036#19 = 0;
     |SI #eosm0029#4 ] 33;  |Y #eosm0029#4 < 65;
         #eosm0036#19 = 1;
         |SI #eosm0029#30 = "S";
             #eosm0036#19 = 2;
         |FINSI;
     |FINSI;
     |SI #eosm0029#4 ] 65;
         #eosm0036#19 = 3;
     |FINSI;
     |PINTA #eosm0036#19;

     #eosm0036#20 = #eosm0029#5;    |PINTA #eosm0036#20;
     #eosm0036#21 = #eosclipr#7;    |PINTA #eosm0036#21;
     #eosm0036#22 = #eosm0029#7;    |PINTA #eosm0036#22;
     #eosm0036#23 = #eosm0029#29;   |PINTA #eosm0036#23;
     #eosm0036#61 = #eosm0029#93;   |PINTA #eosm0036#61;
     #eosm0036#62 = #eosm0029#94;   |PINTA #eosm0036#62;

     #eosm0036#24 = 0;
     #eosm0036#25 = 0;
     #eosm0036#26 = 0;
     #eosm0036#27 = 0;
     #eosm0036#28 = 0;
     #eosm0036#31 = 0;
     #eosm0036#32 = 0;
     #eosm0036#33 = 0;
     #eosm0036#34 = 0;
     #eosm0036#35 = 0;

     |PARA nCampoD = 38;  |SI nCampoD [ 57;  |HACIENDO nCampoD = nCampoD + 1;
           #eosm0036#nCampoD# = 0;
     |SIGUE;

||..     |PARA nCampoD = 63;  |SI nCampoD [ 67;  |HACIENDO nCampoD = nCampoD + 1;
||..           #eosm0036#nCampoD# = 0;
||..     |SIGUE;

     |HAZ Coge2016;
|FPRC;

|PROCESO T0C5F36; |TIPO 6;
     nModo = (FEntrada / 100) ! 0;

     enEjerIRPF = #eosm0036#1;
     |HAZ BuscaEjerIRPF;

     |ABRE #dsmom073;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = #eosm0036#4;
     #dsmom073#2 = #eosm0036#5;
     |LEE 000#dsmom073.=;
     |SI FSalida ! 0;
         aAlfa = "0000Clave no correcta en el ejercicio " + enEjerIRPF;
         |MENAV aAlfa;
         |SI nModo = 1;  |ERROR;  |FINSI;
     |FINSI;
     |CIERRA #dsmom073;
|FPRC;

|PROCESO Baja73F36;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = "";
     #dsmom073#2 = "";
|FPRC;

|PROCESO Alta73F36;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = "z";
     #dsmom073#2 = "zz";
|FPRC;

|PROCESO T66ClaveF36; |TIPO 66;
     enEjerIRPF = #eosm0036#1;
     |HAZ BuscaEjerIRPF;

     |ABRE #dsmom073;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = #eosm0036#4;
     #dsmom073#2 = #eosm0036#5;
     |LEE 000#dsmom073.];

     |CONSULTA_F_CLAVE #1#dsmom073, Baja73F36, Alta73F36;
     |SI FSalida = 0;
          #eosm0036#4 = #dsmom073#1;    |PINTA #eosm0036#4;
          #eosm0036#5 = #dsmom073#2;    |PINTA #eosm0036#5;
     |FINSI;
     |CIERRA #dsmom073;

     |ERROR;
|FPRC;
