|FICHEROS;
     reoz0011 #0;
     reoz0010 #10;
     eosm0017 #17;
|FIN;

|VARIABLES;
     &enCodCarta = 0;
     &enCanti    = 0;
     &enSwTrata  = 0;
     &eaPrograma = "";
     &eaMoneda   = "";
     &EURODB     = 0;

     aAlfa       = "";
     aBase       = "";
     aCarta      = "";
     aOrigen     = "";
     aDestino    = "";
     aIPRemoto   = "";
     aAbre       = "";
     aAsigna     = "";
     aIdenti     = "";
     aDecima     = "";
     aEntero     = "";
     aLong       = "";
     aCaracter   = "";
     aImpor1     = "";
     aImpor2     = "";
     aImpor3     = "";
     aImpor4     = "";

     nWord       = 0;
     nNume       = 0;
     nLong       = 0;
     nDecimal    = 0;
     nCaracter   = 0;
     nPos        = 0;
     nConver     = 0;
|FIN;

|PROCESO MiraVarMoneda;  |TIPO 7;
     |HAZ PintaMoneda;
     #0#11 = eaMoneda;
     |PINTA #0#11;
|FPRC;

|PROCESO Carta;
     |SI FSalida = 10;
         eaPrograma = "reoz0010";
         |SUB_EJECUTA_NP "reoz0010";
         #0#6 = enCodCarta;  |PINTA #0#6;
     |FINSI;

     |ABRE #10;
     #10#0 = #0#6;
     |LEE 040#10=;
     |SI FSalida ! 0;
         |MENAV "     No existe la Carta.";
         |ERROR;
     |FINSI;
     |CIERRA #10;

     #0#7 = #10#1;  |PINTA #0#7;
|FPRC;

|PROCESO AbreWord;
||     aAlfa = "C:/MODELOS";                   |RMKDIR aAlfa;
||     aAlfa = "C:/MODELOS/DOCUMENTOS";        |RMKDIR aAlfa;
     aAlfa = "/MODELOS";                   |RMKDIR aAlfa;
     aAlfa = "/MODELOS/DOCUMENTOS";        |RMKDIR aAlfa;

     |DBASE aBase;
     aCarta    = "cartas" + (("00" + #0#6) % -102) + ".doc";
     aOrigen   = aBase + "cartas/" + aCarta;
||     aDestino  = "C:/MODELOS/DOCUMENTOS/" + aCarta;
     aDestino  = "/MODELOS/DOCUMENTOS/" + aCarta;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     nWord  = 1;
     aAbre  = aDestino;

     |MENSA "      Abriendo el Documento, espere un Momento.";

     |WORD_ABRE nWord, aAbre;
     |WORD_PROPIEDADES nWord, "Visible", "NO";
|FPRC;

|PROCESO Asigna;
     FSalida = 0;
     |PARA; |SI FSalida = 0; |HACIENDO;
            |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;
     |SIGUE;
|FPRC;

|PROCESO NumeroDecimal;
     |SI nConver = 1;
         eaMoneda  = #0#11;
         enCanti   = nNume;
         enSwTrata = 1;
         |HAZ ConverMoneda;
         nNume = enCanti;
     |FINSI;

     aAsigna   = nNume;
     aDecima   = "";
     aEntero   = "";
     aLong     = aAsigna % 0;
     nLong     = aLong;
     nDecimal = 0;
     |PARA nCaracter = 1;  |SI nCaracter [ nLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPos      = (100 * nCaracter) + 1;
           aCaracter = aAsigna % nPos;
           |SI aCaracter = ".";
               nDecimal = 1;
           |SINO;
               |SI nDecimal = 0;
                   aEntero = aEntero + aCaracter;
               |SINO;
                   aDecima = aDecima + aCaracter;
               |FINSI;
           |FINSI;
     |SIGUE;
     aDecima   = (aDecima + "00") % 102;
     aAsigna   = aEntero;

     aLong     = aAsigna % 0;
     nLong     = aLong;
     aAsigna   = "             " + aAsigna;
     aAsigna   = aAsigna % -113;
     aImpor1   = aAsigna % -103;
     aImpor2   = aAsigna % -403;
     aImpor3   = aAsigna % -703;
     aImpor4   = aAsigna % -1004;
     |SI nLong ] 10;
         |SI aImpor4 ! "  -";
             aAsigna = aImpor4 + "." + aImpor3  + "." + aImpor2 + "." + aImpor1;
         |SINO;
             aAsigna = aImpor4 + aImpor3  + "." + aImpor2 + "." + aImpor1;
      |FINSI;
    |SINO;
        |SI nLong ] 7;
            |SI aImpor3 ! "  -";
                aAsigna = aImpor3  + "." + aImpor2 + "." + aImpor1;
            |SINO;
                aAsigna = aImpor3 + aImpor2 + "." + aImpor1;
            |FINSI;
        |SINO;
            |SI nLong ] 4;
                |SI aImpor2 ! "  -";
                    aAsigna = aImpor2 + "." + aImpor1;
                |SINO;
                    aAsigna = aImpor2 + aImpor1;
                |FINSI;
            |SINO;
                aAsigna = aImpor1;
            |FINSI;
        |FINSI;
     |FINSI;

     |QBT aAsigna;

     |SI aDecima ! "00";
         aAsigna = ("                " + aAsigna + "," + aDecima) % -116;
     |SINO;
         aAsigna = ("             " + aAsigna) % -113;
     |FINSI;

     |SI aAsigna = "            0";     aAsigna = "";  |FINSI;
     |SI aAsigna = "            0,00";  aAsigna = "";  |FINSI;

     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;
|FPRC;

|PROCESO Asignacion;
     |ABRE #17;
     #17#0 = #0#0;
     #17#5 = #0#1;
     #17#1 = #0#2;
     |LEE 040#17=;
     |SI FSalida ! 0;  |DDEFECTO #17;  |FINSI;
     |CIERRA #17;

     |MENSA "      Asignando Campos, espere un Momento.";

     nNume = 2000 + #0#1;
     |SI #0#1 ] 80;  nNume = 1900 + #0#1;  |FINSI;

     aAsigna = #0#8;  |QBF aAsigna;
     |SI aAsigna ! "";  aAsigna = aAsigna + ", ";  |FINSI;
     aAsigna = aAsigna + #0#9;
     aIdenti = "!#FECHA#";
     |HAZ Asigna;

     aAsigna = nNume;
     aIdenti = "!#ANO#";
     |HAZ Asigna;

     aAsigna = ("00000" + #0#0) % -105;
     aIdenti = "!#COD#";
     |HAZ Asigna;

     aAsigna = #0#3;
     aIdenti = "!#NOM#";
     |HAZ Asigna;

     aAsigna = #0#4;
     aIdenti = "!#EPI#";
     |HAZ Asigna;

     aAsigna = #17#11;  aIdenti = "!#A1#";  |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;
     aAsigna = #17#22;  aIdenti = "!#A2#";  |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;
     aAsigna = #17#33;  aIdenti = "!#A3#";  |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;
     aAsigna = #17#44;  aIdenti = "!#A4#";  |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;
     aAsigna = #17#55;  aIdenti = "!#A5#";  |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;
     aAsigna = #17#66;  aIdenti = "!#A6#";  |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;
     aAsigna = #17#77;  aIdenti = "!#A7#";  |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;
     aAsigna = #17#88;  aIdenti = "!#A8#";  |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;
     aAsigna = #17#99;  aIdenti = "!#A9#";  |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     |SI #0#10 = "P";
         nConver = 0;
         nNume = #17#18;   aIdenti = "!#B1#";  |HAZ NumeroDecimal;
         nNume = #17#29;   aIdenti = "!#B2#";  |HAZ NumeroDecimal;
         nNume = #17#40;   aIdenti = "!#B3#";  |HAZ NumeroDecimal;
         nNume = #17#51;   aIdenti = "!#B4#";  |HAZ NumeroDecimal;
         nNume = #17#62;   aIdenti = "!#B5#";  |HAZ NumeroDecimal;
         nNume = #17#73;   aIdenti = "!#B6#";  |HAZ NumeroDecimal;
         nNume = #17#84;   aIdenti = "!#B7#";  |HAZ NumeroDecimal;
         nNume = #17#95;   aIdenti = "!#B8#";  |HAZ NumeroDecimal;
         nNume = #17#106;  aIdenti = "!#B9#";  |HAZ NumeroDecimal;

         nConver = 1;
         nNume = #17#17;   aIdenti = "!#C1#";  |HAZ NumeroDecimal;
         nNume = #17#28;   aIdenti = "!#C2#";  |HAZ NumeroDecimal;
         nNume = #17#39;   aIdenti = "!#C3#";  |HAZ NumeroDecimal;
         nNume = #17#50;   aIdenti = "!#C4#";  |HAZ NumeroDecimal;
         nNume = #17#61;   aIdenti = "!#C5#";  |HAZ NumeroDecimal;
         nNume = #17#72;   aIdenti = "!#C6#";  |HAZ NumeroDecimal;
         nNume = #17#83;   aIdenti = "!#C7#";  |HAZ NumeroDecimal;
         nNume = #17#94;   aIdenti = "!#C8#";  |HAZ NumeroDecimal;
         nNume = #17#105;  aIdenti = "!#C9#";  |HAZ NumeroDecimal;

         nNume = #17#19;   aIdenti = "!#D1#";  |HAZ NumeroDecimal;
         nNume = #17#30;   aIdenti = "!#D2#";  |HAZ NumeroDecimal;
         nNume = #17#41;   aIdenti = "!#D3#";  |HAZ NumeroDecimal;
         nNume = #17#52;   aIdenti = "!#D4#";  |HAZ NumeroDecimal;
         nNume = #17#63;   aIdenti = "!#D5#";  |HAZ NumeroDecimal;
         nNume = #17#74;   aIdenti = "!#D6#";  |HAZ NumeroDecimal;
         nNume = #17#85;   aIdenti = "!#D7#";  |HAZ NumeroDecimal;
         nNume = #17#96;   aIdenti = "!#D8#";  |HAZ NumeroDecimal;
         nNume = #17#107;  aIdenti = "!#D9#";  |HAZ NumeroDecimal;

         nNume = #17#112 - ((#17#112 % 1) ! EURODB); aIdenti = "!#TT#";  |HAZ NumeroDecimal;
     |SINO;
         nConver = 0;
         nNume = #17#20;   aIdenti = "!#B1#";  |HAZ NumeroDecimal;
         nNume = #17#31;   aIdenti = "!#B2#";  |HAZ NumeroDecimal;
         nNume = #17#42;   aIdenti = "!#B3#";  |HAZ NumeroDecimal;
         nNume = #17#53;   aIdenti = "!#B4#";  |HAZ NumeroDecimal;
         nNume = #17#64;   aIdenti = "!#B5#";  |HAZ NumeroDecimal;
         nNume = #17#75;   aIdenti = "!#B6#";  |HAZ NumeroDecimal;
         nNume = #17#86;   aIdenti = "!#B7#";  |HAZ NumeroDecimal;
         nNume = #17#97;   aIdenti = "!#B8#";  |HAZ NumeroDecimal;
         nNume = #17#108;  aIdenti = "!#B9#";  |HAZ NumeroDecimal;

         nConver = 1;
         nNume = #17#17;   aIdenti = "!#C1#";  |HAZ NumeroDecimal;
         nNume = #17#28;   aIdenti = "!#C2#";  |HAZ NumeroDecimal;
         nNume = #17#39;   aIdenti = "!#C3#";  |HAZ NumeroDecimal;
         nNume = #17#50;   aIdenti = "!#C4#";  |HAZ NumeroDecimal;
         nNume = #17#61;   aIdenti = "!#C5#";  |HAZ NumeroDecimal;
         nNume = #17#72;   aIdenti = "!#C6#";  |HAZ NumeroDecimal;
         nNume = #17#83;   aIdenti = "!#C7#";  |HAZ NumeroDecimal;
         nNume = #17#94;   aIdenti = "!#C8#";  |HAZ NumeroDecimal;
         nNume = #17#105;  aIdenti = "!#C9#";  |HAZ NumeroDecimal;

         nNume = #17#21;   aIdenti = "!#D1#";  |HAZ NumeroDecimal;
         nNume = #17#32;   aIdenti = "!#D2#";  |HAZ NumeroDecimal;
         nNume = #17#43;   aIdenti = "!#D3#";  |HAZ NumeroDecimal;
         nNume = #17#54;   aIdenti = "!#D4#";  |HAZ NumeroDecimal;
         nNume = #17#65;   aIdenti = "!#D5#";  |HAZ NumeroDecimal;
         nNume = #17#76;   aIdenti = "!#D6#";  |HAZ NumeroDecimal;
         nNume = #17#87;   aIdenti = "!#D7#";  |HAZ NumeroDecimal;
         nNume = #17#98;   aIdenti = "!#D8#";  |HAZ NumeroDecimal;
         nNume = #17#109;  aIdenti = "!#D9#";  |HAZ NumeroDecimal;

         nNume = #17#113 - ((#17#113 % 1) ! EURODB); aIdenti = "!#TT#";  |HAZ NumeroDecimal;
     |FINSI;
|FPRC;

|PROCESO Cierre;
     |PTEC 808;
     |WORD_PROPIEDADES nWord, "Visible", "SI";
     FSalida = "NO";
     |PARA;  |SI FSalida = "NO";  |HACIENDO;
             |PULSATECLA;
             |WORD_PROPIEDADES nWord, "Quit", "";
     |SIGUE;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;
     |HAZ AbreWord;
     |HAZ Asignacion;
     |HAZ Cierre;
     |RFBORRA aAbre;
|FPRC;
