|FICHEROS;
     eosclie1 #1000,MANTE;
     eosacti2 #1001,MANTE;
     eosclpr1 #1002,MANTE;
|FIN;

|VARIABLES;
     CampoCliente  = 0;

     Campo10010    = 0;
     Campo10011    = 0;
     Campo10012    = 0;

     Campo10020    = 0;
     Campo10021    = 0;
     Campo10022    = 0;

     nNume1_c = 0;
     aAlfa1_c = "";
     aQueVull = "";
     aIDCampo   = "";
|FIN;

|RUTINA ClaveBaja11000;
|SI FSalida = "POSICION"; #1000#0 = #Fichero@#CampoCliente#; |ACABA; |FINSI;

#1000#0 = 1;
|FRUT;

|RUTINA ClaveAlta11000;
#1000#0 = 99999;
|FRUT;

|RUTINA ClaveBaja21000;
#1000#2 = "!                                       ";
|FRUT;

|RUTINA ClaveAlta21000;
#1000#2 = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
|FRUT;

|PROCESO MensaCliente; |TIPO 7;
   nNume1_c = Campo;
   aAlfa1_c = ("000" + nNume1_c) % -103;
   aQueVull = "|C" + aAlfa1_c + "IDCAMPO";
   aIDCampo = #Fichero@#aQueVull#;
   |QBF aIDCampo;

   |SI aIDCampo = "Pase";
       aAlfa1_c = "    Codigo Cliente, <F12> Consulta por Codigo; <F2> Consulta por Nombre";
   |SINO;
       aAlfa1_c = "    <F12> Consulta Clientes por Codigo; <F2> Consulta Clientes por Nombre";
   |FINSI;
   |MENSA aAlfa1_c;
|FPRC;

|PROCESO ConsuCliente; |TIPO 0;
|ATRI R; |BLIN 04; |ATRI 0;

|SI FSalida ! 9; |Y FSalida ! 10; |ACABA; |FINSI;

|PUSHV 0501 2380;
CampoCliente  = Campo;

|SI FSalida = 9;
    |C_M #1000#0, 1, "S";  |C_M #1000#2, 1, "N";
    |ENTLINEAL #1#1000, 1, 4, 22, 1, ClaveBaja11000, ClaveAlta11000;
|FINSI;

|SI FSalida = 10;
    |C_M #1000#0, 1, "N";  |C_M #1000#2, 1, "S";
    |ENTLINEAL #3#1000, 1, 4, 22, 1, ClaveBaja21000, ClaveAlta21000;
|FINSI;

|POPV;
|PINTA #Fichero@#CampoCliente#;
|FPRC;

|PROCESO RecogeCod; |TIPO 11;
|SI FSalida ! 9; |ACABA; |FINSI;

#Fichero@#CampoCliente# = #1000#0;
|PTEC 807;
|FPRC;

|RUTINA ClaveB11001;
#1001#0 = Campo10010;
#1001#1 = 0;
#1001#2 = Campo10012;
|FRUT;

|RUTINA ClaveA11001;
#1001#0 = Campo10010;
#1001#1 = 9;
#1001#2 = Campo10012;
|FRUT;

|PROCESO MensaActiv; |TIPO 7;
|MENSA "    <F12> Seleccionar Actividades de la Empresa";
|FPRC;

|PROCESO ConsuActiv; |TIPO 0;
|ATRI R; |BLIN 04; |ATRI 0;
|PUSHV 0501 2380;
|ENTLINEAL #4#1001, 3, 4, 22, 1, ClaveB11001, ClaveA11001;
|POPV;
|FPRC;

|PROCESO RecogeAct; |TIPO 11;
|SI FSalida ! 9; |ACABA; |FINSI;

Campo10010 = #1001#0;
Campo10011 = #1001#1;
Campo10012 = #1001#2;
|PTEC 807;
|FPRC;

|RUTINA ClaveBaja11002;
|SI FSalida = "POSICION";  #1002#1 = Campo10021;  |ACABA;  |FINSI;

#1002#0 = Campo10020;
#1002#1 = 00000;
#1002#2 = Campo10022;
|FRUT;

|RUTINA ClaveAlta11002;
#1002#0 = Campo10020;
#1002#1 = 99999;
#1002#2 = Campo10022;
|FRUT;

|RUTINA ClaveBaja21002;
|SI FSalida = "POSICION";  #1002#1 = Campo10021;  |ACABA;  |FINSI;
#1002#0 = Campo10020;
#1002#1 = 00000;
#1002#2 = Campo10022;
#1002#4 = "!                                       ";
|FRUT;

|RUTINA ClaveAlta21002;
#1002#0 = Campo10020;
#1002#1 = 99999;
#1002#2 = Campo10022;
#1002#4 = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
|FRUT;

|PROCESO ConsuCliProv; |TIPO 0;
|PUSHV 0501 2380;

|SI FSalida = 9;
    |C_M #1002#1, 1, "S";  |C_M #1002#4, 1, "N";
    |ENTLINEAL #1#1002, 3, 4, 22, 1, ClaveBaja11002, ClaveAlta11002;
|FINSI;

|SI FSalida = 10;
    |C_M #1002#1, 1, "N";  |C_M #1002#4, 1, "S";
    |ENTLINEAL #4#1002, 1, 4, 22, 1, ClaveBaja21002, ClaveAlta21002;
|FINSI;

|POPV;
|FPRC;

|PROCESO RecogePro; |TIPO 11;
|SI FSalida ! 9; |ACABA; |FINSI;

Campo10021 = #1002#1;
|PTEC 807;
|FPRC;
