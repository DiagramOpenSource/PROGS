|FICHEROS;
     reemipat,MANTE;
     reemi100;

     rem00100;
     rem00101;
     rem01001;
     rem01002;
     rem01044;
     rerenpre;
     reauxpai;

     rem00099;

     &poblaci@;
|FIN;

|VARIABLES;
     &DiaInf    = "";
     MesNum     = "";
     &MesInf    = "";
     &EjerInf   = "";
     &enCodProv  = 0;
     &enCodPobl  = 0;
     &eaModelo   = "";
     &eaIP       = "";
     &eaCRLF     = "";
     &enHandle   = 0;
     &enEmpresa  = 0;
     &enEmpr     = 0;
     &eaTipo     = "";
     &eaNif      = "";
     &enConDatos = 0;
     &enPagina   = "";
     &enNumPags  = "";

     Vacio1    = "";
     Vacio2    = "";
     nNegativo = 0;
     Long      = 0;
     LongDec   = 0;

     aLong      = "";
     nLong      = 0;

     SwDatos   = 0;
     nCharGrabados = 0;

     Bloque    = 0;
     Casilla   = "";
     VEmpresa  = 0;
     VTipo     = "";

     aNif      = "";
     aAlfa     = "";
     aAlfa1    = "";
     aAlfa2    = "";
     aAlfa3    = "";
     aAlfa4    = "";

     TipoDato  = "";

     Nombre    = "";
     Comodin   = "";
     Cadena    = "";

     nCont     = 0;
     nCont1    = 0;

     nFactor   = 0;

     nCalc     = 0;
     Calc1     = 0;
     Calc2     = 0;

     nSwFiltraBarra = 0;
     nSwDatos = 0;
     SwError  = 0;

     aCodigo   = "";
     nCantPP   = 0;
     aDatosRep = "";
     nPagina   = 0;
     aTipo     = "";
     nRegistro = 0;
     nNumRegs  = 0;
     aCadena   = "";
     aCapit    = "";
     nCmp      = 0;
     nConCta   = 0;

     nTotal1   = 0;
     nTotal2   = 0;

     nCasilla   = 0;
     nCasilla60 = 0;
     nCasilla61 = 0;
     nCasilla62 = 0;
     nCasilla63 = 0;
     nCasilla01 = 0;
     nCasillaA  = 0;
     nCasillaB  = 0;
|FIN;

|PROCESO BuscaCasilla714;
     |SELECT #2#rem01002;
     #rem01002#0 = VEmpresa;
     #rem01002#1 = " ";
     #rem01002#2 = VTipo;
     #rem01002#3 = Bloque;
     #rem01002#5 = Casilla;
     |LEE 010#rem01002.=;
     |SI FSalida = 0;
         Casilla = #rem01002#7;
         SwError = 0;
     |SINO;
         Casilla = 0; SwError = 1;
     |FINSI;
|FPRC;

|PROCESO CargaFecha714;
     DiaInf   = #reemipat#33 % 102;
     MesNum   = #reemipat#33 % 402;
     MesInf   = #reemipat#33 % 402;
     EjerInf  = #reemipat#33 % -104;

     |SI MesNum = "01"; MesInf = "Enero     "; |FINSI;
     |SI MesNum = "02"; MesInf = "Febrero   "; |FINSI;
     |SI MesNum = "03"; MesInf = "Marzo     "; |FINSI;
     |SI MesNum = "04"; MesInf = "Abril     "; |FINSI;
     |SI MesNum = "05"; MesInf = "Mayo      "; |FINSI;
     |SI MesNum = "06"; MesInf = "Junio     "; |FINSI;
     |SI MesNum = "07"; MesInf = "Julio     "; |FINSI;
     |SI MesNum = "08"; MesInf = "Agosto    "; |FINSI;
     |SI MesNum = "09"; MesInf = "Septiembre"; |FINSI;
     |SI MesNum = "10"; MesInf = "Octubre   "; |FINSI;
     |SI MesNum = "11"; MesInf = "Noviembre "; |FINSI;
     |SI MesNum = "12"; MesInf = "Diciembre "; |FINSI;

     MesInf = MesInf > MesInf;
|FPRC;

|PROCESO Formateo714;
     |QBF aAlfa;
     |SI TipoDato = "F";
        aAlfa = aAlfa - "."; aAlfa = aAlfa - ".";
        |QBF aAlfa;
        |SI aAlfa = "";         aAlfa = "0" * 8; |FINSI;
        |SI aAlfa = "01010000"; aAlfa = "0" * 8; |FINSI;
        |ACABA;
     |FINSI;
     |SI TipoDato = "N";
        Vacio1 = "0" * Long;
        Vacio2 = "0" * LongDec;
        aAlfa = aAlfa - "-";
        |SI FSalida ! 0;
           nNegativo = 1;
        |SINO;
           nNegativo = 0;
        |FINSI;
     |SINO;
        Vacio1 = " " * Long;
     |FINSI;

     |SI TipoDato ! "N";
        Calc1 = 100 + Long; aAlfa = (aAlfa + Vacio1) % Calc1;
     |SINO;
        |SI LongDec = 0;
           Calc1 = 0 - (100 + Long);
           aAlfa = (Vacio1 + aAlfa) % Calc1;
        |SINO;
           aAlfa = aAlfa - ".";
           |SI FSalida = 0;
              Calc1 = 0 - (100 + Long);
              aAlfa = (Vacio1 + aAlfa) % Calc1;
              aAlfa1 = "0" * LongDec;
           |SINO;
              Calc1 = (((FSalida / 100) ! 0) - 1) + 100;
              Calc2 = (((FSalida / 100) ! 0) * 100) + 99;
              aAlfa1 = aAlfa % Calc2;
              aAlfa = aAlfa % Calc1;
              Calc1 = 0 - (100 + Long);
              aAlfa = (Vacio1 + aAlfa)  % Calc1;
              Calc1 = 100 + LongDec;
              aAlfa1 = (aAlfa1 + Vacio2) % Calc1;
           |FINSI;
           aAlfa = aAlfa + aAlfa1;
        |FINSI;
        |SI nNegativo = 1;
           Calc1 = 0 - (100 + (Long + LongDec)); Calc1 = Calc1 + 1;
           aAlfa = aAlfa % Calc1;
           aAlfa = "N" + aAlfa;
        |FINSI;
     |FINSI;

     aAlfa2 = "";

     |SI TipoDato = "A"; |O TipoDato = "An";
        aLong = aAlfa % 0; nLong = aLong;
        |PARA nCont1 = 1; |SI nCont1 [ nLong; |HACIENDO nCont1 = nCont1 + 1;
           Calc1 = (nCont1 * 100) + 1; aAlfa1  = aAlfa % Calc1;
           aAlfa1 = aAlfa1 > aAlfa1;
           |SI aAlfa1 = " ";                  |VETE Sigue1; |FINSI;
           |SI aAlfa1 ] "A"; |Y aAlfa1 [ "Z"; |VETE Sigue1; |FINSI;
           |SI aAlfa1 ] "0"; |Y aAlfa1 [ "9"; |VETE Sigue1; |FINSI;
           |SI aAlfa1 = "¥"; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
           |SI aAlfa1 = "¤"; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
           ||SI aAlfa1 = "ç"; aAlfa1 = &199;   |VETE Sigue1; |FINSI;
           ||SI aAlfa1 = "Ç"; aAlfa1 = &199;   |VETE Sigue1; |FINSI;
           |SI nSwFiltraBarra = 1;
              |SI aAlfa1 = "/"; aAlfa1 = ".";    |VETE Sigue1; |FINSI;
           |FINSI;
           aAlfa4 = &128;
           |SI aAlfa1 = aAlfa4; aAlfa1 = "Ç";   |VETE Sigue1; |FINSI;
           aAlfa4 = &135;
           |SI aAlfa1 = aAlfa4; aAlfa1 = "ç";   |VETE Sigue1; |FINSI;
           |SI aAlfa1 = "-"; aAlfa1 = &45;    |VETE Sigue1; |FINSI;
           |SI aAlfa1 = "'"; aAlfa1 = &49;    |VETE Sigue1; |FINSI;
           |SI aAlfa1 = "/";                  |VETE Sigue1; |FINSI;
           |SI TipoDato = "An";
              |SI aAlfa1 = "&"; aAlfa1 = &38;    |VETE Sigue1; |FINSI;
              |SI aAlfa1 = ","; aAlfa1 = &44;    |VETE Sigue1; |FINSI;
              |SI aAlfa1 = "."; aAlfa1 = &46;    |VETE Sigue1; |FINSI;
              |SI aAlfa1 = ":"; aAlfa1 = &58;    |VETE Sigue1; |FINSI;
              |SI aAlfa1 = ";"; aAlfa1 = &59;    |VETE Sigue1; |FINSI;
              |SI aAlfa1 = "_"; aAlfa1 = &95;    |VETE Sigue1; |FINSI;
           |FINSI;
           aAlfa1 = " ";
  |ET Sigue1;
           aAlfa2 = aAlfa2 + aAlfa1;
        |SIGUE;
        aAlfa = aAlfa2;
     |FINSI;
     Calc1 = aAlfa;
     |SI nSwDatos = 0; |Y Calc1 ! 0; nSwDatos = 1; |FINSI;
|FPRC;

|PROCESO GrabaVector714;
     nCharGrabados = 0;
     enEmpr = VEmpresa; eaTipo = VTipo;
     |PARA nCont = 1; |SI nCont [ 11; |HACIENDO nCont = nCont + 1;
        enPagina = nCont; |HAZ MiraObligatoria;
        |SI enConDatos = 1;
           |PARA; |SI enNumPags > 0; |HACIENDO enNumPags = enNumPags - 1;
              Cadena = ("000" + nCont) % -103; nCharGrabados = nCharGrabados + 3;
              |HAZ GrabaCadena714; Cadena = "";
           |SIGUE;
        |FINSI;
     |SIGUE;

     Cadena = "FIN"; |HAZ GrabaCadena714; Cadena = "";
     nCharGrabados = nCharGrabados + 3;

     |PARA; |SI nCharGrabados < 290; |HACIENDO nCharGrabados = nCharGrabados + 10;
        Cadena = " " * 10; |HAZ GrabaCadena714;
     |SIGUE;

     nCalc = 300 - nCharGrabados;
     Cadena = " " * nCalc; |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCadena714;
     |XGRABA enHandle, Cadena; Cadena = "";
|FPRC;

|PROCESO Hoja01714;
     |ABRE #rem00100;
     #rem00100#0 = VEmpresa;
     |LEE 000#rem00100.=;
     |SI FSalida ! 0; |DDEFECTO #rem00100; |FINSI;
     |CIERRA #rem00100;

     LongDec = 0;
     Cadena = "<T71401> "; |HAZ GrabaCadena714; Cadena = "";

     aAlfa = VTipo; |QBF aAlfa;
     |SI aAlfa = "ZPATRITIT";
        || Sujeto pasivo : NIF
        TipoDato = "An";  Long = 9;   LongDec = 0;
        aAlfa = #rem00100#1; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Primer apellido
        TipoDato = "A";  Long = 15;
        aAlfa = #rem00100#2; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Segundo apellido
        aAlfa = #rem00100#3; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Nombre
        aAlfa = #rem00100#4; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Discapacidad - % minusvalia
        TipoDato = "N";  Long = 2;
        aAlfa = #rem00100#8; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Tipo de via
        TipoDato = "A";  Long = 5;
        aAlfa = #rem00100#14; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Codigo Via INE (RESERVADO AEAT)
        Cadena = Cadena + "00000";
        || Sujeto pasivo : Domicilio habitual : Nombre de la via publica
        TipoDato = "A";  Long = 50;
        aAlfa = #rem00100#15; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Tipo de numeracion
        TipoDato = "A";  Long = 3;
        aAlfa = #rem00100#114; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Numero de casa
        TipoDato = "N";  Long = 5;
        aAlfa = #rem00100#16; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Calificador del numero
        TipoDato = "A";  Long = 3;
        aAlfa = #rem00100#115; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Bloque
        aAlfa = #rem00100#116; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Portal
        aAlfa = #rem00100#117; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Escalera
        aAlfa = #rem00100#17; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Planta
        aAlfa = #rem00100#18; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Puerta
        aAlfa = #rem00100#19; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        |HAZ GrabaCadena714; Cadena = "";

        || Sujeto pasivo : Domicilio habitual : Datos complementarios del domicilio
        TipoDato = "A";  Long = 40;
        aAlfa = #rem00100#118; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Localidad/Poblacion
        TipoDato = "A";  Long = 30;
        aAlfa = #rem00100#119; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Codigo postal
        TipoDato = "N";  Long = 5;
        aAlfa = #rem00100#23; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Codigo Municipio INE (RESERVADO)
        Cadena = Cadena + "00000";
        || Sujeto pasivo : Domicilio habitual : Nombre del municipio
        TipoDato = "A";  Long = 30;
        aAlfa = #rem00100#22; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Codigo Provincia
        aAlfa = ("00" + #rem00100#20) % -102; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Provincia
        enCodProv = #rem00100#20; enCodPobl = #rem00100#21; |HAZ LeePoblacion;
        TipoDato = "A";  Long = 20;
        aAlfa = #poblaci@#2;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Telefono fijo
        TipoDato = "N";  Long = 9;
        aAlfa = #rem00100#12; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Telefono movil
        aAlfa = #rem00100#109; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Numero de Fax
        aAlfa = #rem00100#112; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        |HAZ GrabaCadena714; Cadena = "";

        || Sujeto pasivo : Domicilio extranjero : Domicilio / Address
        TipoDato = "A";  Long = 50;
        aAlfa = #rem00100#120; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio extranjero : Datos complementarios del domicilio
        TipoDato = "A";  Long = 40;
        aAlfa = #rem00100#121; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio extranjero : Poblacion / Ciudad
        TipoDato = "A";  Long = 30;
        aAlfa = #rem00100#122; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        |HAZ GrabaCadena714; Cadena = "";

        || Sujeto pasivo : Domicilio extranjero : E-Mail
        TipoDato = "A";  Long = 90;
        aAlfa = #rem00100#123; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        Cadena = Cadena + "          ";
        || Sujeto pasivo : Domicilio extranjero : Codigo Postal
        TipoDato = "A";  Long = 10;
        aAlfa = #rem00100#124; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio extranjero : Provincia / Region / Estado
        TipoDato = "A";  Long = 30;
        aAlfa = #rem00100#125; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio extranjero : Pais
        aAlfa = #rem00100#127; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        |HAZ GrabaCadena714; Cadena = "";

        aAlfa = #rem00100#120; |QBF aAlfa;
        |SI aAlfa ! "";
           |ABRE #reauxpai;
           #reauxpai#0 = #rem00100#126;
           |LEE 000#reauxpai.=;
           |SI FSalida ! 0; |DDEFECTO #reauxpai; |FINSI;
           |CIERRA #reauxpai;

           || Sujeto pasivo : Domicilio extranjero : Codigo pais
           TipoDato = "An";  Long = 2;
           aAlfa = #reauxpai#2; |HAZ Formateo714; Cadena = Cadena + aAlfa;
           || Sujeto pasivo : Domicilio extranjero : Telefono fijo
           TipoDato = "A";  Long = 15;
           aAlfa = #rem00100#12; |HAZ Formateo714; Cadena = Cadena + aAlfa;
           || Sujeto pasivo : Domicilio extranjero : Telefono movil
           aAlfa = #rem00100#109; |HAZ Formateo714; Cadena = Cadena + aAlfa;
           || Sujeto pasivo : Domicilio extranjero : N§ de fax
           aAlfa = #rem00100#112; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        |SINO;
           Cadena = Cadena + (" " * 47);
        |FINSI;
        |HAZ GrabaCadena714; Cadena = "";
     |FINSI;

     |SI aAlfa = "ZPATRICON";
        || Sujeto pasivo : NIF
        TipoDato = "An";  Long = 9;   LongDec = 0;
        aAlfa = #rem00100#35; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Primer apellido
        TipoDato = "A";  Long = 15;
        aAlfa = #rem00100#36; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Segundo apellido
        aAlfa = #rem00100#37; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Nombre
        aAlfa = #rem00100#38; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Discapacidad - % minusvalia
        TipoDato = "N";  Long = 2;
        aAlfa = #rem00100#41; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Tipo de via
        TipoDato = "A";  Long = 5;
        aAlfa = #rem00100#44; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Codigo Via INE (RESERVADO AEAT)
        Cadena = Cadena + "00000";
        || Sujeto pasivo : Domicilio habitual : Nombre de la via publica
        TipoDato = "A";  Long = 50;
        aAlfa = #rem00100#45; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Tipo de numeracion
        TipoDato = "A";  Long = 3;
        aAlfa = #rem00100#131; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Numero de casa
        TipoDato = "N";  Long = 5;
        aAlfa = #rem00100#46; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Calificador del numero
        TipoDato = "A";  Long = 3;
        aAlfa = #rem00100#132; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Bloque
        aAlfa = #rem00100#133; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Portal
        aAlfa = #rem00100#134; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Escalera
        aAlfa = #rem00100#47; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Planta
        aAlfa = #rem00100#48; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Puerta
        aAlfa = #rem00100#49; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        |HAZ GrabaCadena714; Cadena = "";

        || Sujeto pasivo : Domicilio habitual : Datos complementarios del domicilio
        TipoDato = "A";  Long = 40;
        aAlfa = #rem00100#135; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Localidad/Poblacion
        TipoDato = "A";  Long = 30;
        aAlfa = #rem00100#136; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Codigo postal
        TipoDato = "N";  Long = 5;
        aAlfa = (("00" + #rem00100#50) % -102) + (("000" + #rem00100#51) % -103);
        |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Codigo Municipio INE (RESERVADO)
        Cadena = Cadena + "00000";
        || Sujeto pasivo : Domicilio habitual : Nombre del municipio
        TipoDato = "A";  Long = 30;
        aAlfa = #rem00100#52; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Codigo Provincia
        aAlfa = ("00" + #rem00100#50) % -102; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Provincia
        enCodProv = #rem00100#50; enCodPobl = #rem00100#51; |HAZ LeePoblacion;
        TipoDato = "A";  Long = 20;
        aAlfa = #poblaci@#2;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Telefono fijo
        TipoDato = "N";  Long = 9;
        aAlfa = #rem00100#13; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Telefono movil
        aAlfa = #rem00100#110; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio habitual : Numero de Fax
        aAlfa = #rem00100#129; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        |HAZ GrabaCadena714; Cadena = "";

        || Sujeto pasivo : Domicilio extranjero : Domicilio / Address
        TipoDato = "A";  Long = 50;
        aAlfa = #rem00100#137; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio extranjero : Datos complementarios del domicilio
        TipoDato = "A";  Long = 40;
        aAlfa = #rem00100#138; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio extranjero : Poblacion / Ciudad
        TipoDato = "A";  Long = 30;
        aAlfa = #rem00100#139; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        |HAZ GrabaCadena714; Cadena = "";

        || Sujeto pasivo : Domicilio extranjero : E-Mail
        TipoDato = "A";  Long = 90;
        aAlfa = #rem00100#140; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        Cadena = Cadena + "          ";
        || Sujeto pasivo : Domicilio extranjero : Codigo Postal
        TipoDato = "A";  Long = 10;
        aAlfa = #rem00100#141; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio extranjero : Provincia / Region / Estado
        TipoDato = "A";  Long = 30;
        aAlfa = #rem00100#142; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Sujeto pasivo : Domicilio extranjero : Pais
        aAlfa = #rem00100#144; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        |HAZ GrabaCadena714; Cadena = "";

        aAlfa = #rem00100#137; |QBF aAlfa;
        |SI aAlfa ! "";
           |ABRE #reauxpai;
           #reauxpai#0 = #rem00100#143;
           |LEE 000#reauxpai.=;
           |SI FSalida ! 0; |DDEFECTO #reauxpai; |FINSI;
           |CIERRA #reauxpai;

           || Sujeto pasivo : Domicilio extranjero : Codigo pais
           TipoDato = "A";  Long = 2;
           aAlfa = #reauxpai#2; |HAZ Formateo714; Cadena = Cadena + aAlfa;
           || Sujeto pasivo : Domicilio extranjero : Telefono fijo
           TipoDato = "A";  Long = 15;
           aAlfa = #rem00100#13; |HAZ Formateo714; Cadena = Cadena + aAlfa;
           || Sujeto pasivo : Domicilio extranjero : Telefono movil
           aAlfa = #rem00100#110; |HAZ Formateo714; Cadena = Cadena + aAlfa;
           || Sujeto pasivo : Domicilio extranjero : N§ de fax
           aAlfa = #rem00100#129; |HAZ Formateo714; Cadena = Cadena + aAlfa;
        |SINO;
           Cadena = Cadena + (" " * 47);
        |FINSI;
        |HAZ GrabaCadena714; Cadena = "";
     |FINSI;

     || Sujeto pasivo : Modalidades especiales de tributacion : Tributa obligacion real
     |SI #rem00100#94 = "S";
        |SI #rem00100#99 = "1";
           aAlfa = "1";
        |SINO;
           aAlfa = "0";
        |FINSI;
     |SINO;
        aAlfa = "0";
     |FINSI;
     Cadena = Cadena + aAlfa;
     || Sujeto pasivo : Modalidades especiales de tributacion : Tributa obligacion personal
     |SI #rem00100#94 = "S";
        |SI #rem00100#99 = "2";
           aAlfa = "1";
        |SINO;
           aAlfa = "0";
        |FINSI;
     |SINO;
        aAlfa = "0";
     |FINSI;
     Cadena = Cadena + aAlfa;
     || Sujeto pasivo : Modalidades especiales de tributacion : Tributa obligacion real regimen especial
     |SI #rem00100#94 = "N";
        |SI #rem00100#99 = "1";
           aAlfa = "1";
        |SINO;
           aAlfa = "0";
        |FINSI;
     |SINO;
        aAlfa = "0";
     |FINSI;
     Cadena = Cadena + aAlfa;
     || Sujeto pasivo : Identificador cliente EEDD (RESERVADO)
     Cadena = Cadena + (" " * 20);
     || Sujeto pasivo : N§ justificante (RESERVADO)
     Cadena = Cadena + ("0" * 13);
     || Sujeto pasivo : Regimen economico del matrimonio
     aAlfa = " ";
     |SI #rem00100#93 = "G"; aAlfa = "5"; |FINSI;
     |SI #rem00100#93 = "S"; aAlfa = "6"; |FINSI;
     |SI #rem00100#93 = "O"; aAlfa = "7"; |FINSI;
     Cadena = Cadena + aAlfa;
     || Sujeto pasivo : Comunidad autonoma
     TipoDato = "N";  Long = 2;
     aAlfa = VTipo; |QBF aAlfa;
     |SI aAlfa = "ZPATRITIT"; aAlfa = #rem00100#11; |FINSI;
     |SI aAlfa = "ZPATRICON"; aAlfa = #rem00100#43; |FINSI;
     |SI #rem00100#94 = "S";
        |SI #rem00100#99 = "1"; aAlfa = "00"; |FINSI;
        |SI #rem00100#99 = "2"; aAlfa = "20"; |FINSI;
     |FINSI;

     |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714; Cadena = "";

     || Sujeto pasivo : Declaracion complementaria
     Bloque = 12; Casilla = "057"; |HAZ BuscaCasilla714; nCalc = Casilla;
     |SI nCalc > 0; Cadena = "1"; |SINO; Cadena = "0"; |FINSI;

     |ABRE #rerenpre;
     #rerenpre#0 = #rem00100#65;
     |LEE 000#rerenpre.=;
     |SI FSalida = 0;
        || Representante : Nif
        TipoDato = "An"; Long = 9;  aAlfa = #rerenpre#2;  |HAZ Formateo714; Cadena = Cadena + aAlfa;
        || Representante : Apellidos y nombre o razon social
        TipoDato = "An"; Long = 32; aAlfa = #rerenpre#1;  |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |SINO;
        Cadena = Cadena + (" " * 41);
     |FINSI;
     |CIERRA #rerenpre;

     |HAZ CargaFecha714;
     || Sujeto pasivo : Fecha de la declaracion : Localidad
     TipoDato = "A";  Long = 20;
     aAlfa = #reemipat#34; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     || Sujeto pasivo : Fecha de la declaracion : Dia
     TipoDato = "N";  Long = 2;  aAlfa = DiaInf;       |HAZ Formateo714; Cadena = Cadena + aAlfa;
     || Sujeto pasivo : Fecha de la declaracion : Mes
     TipoDato = "A";  Long = 10; aAlfa = MesInf;       |HAZ Formateo714; Cadena = Cadena + aAlfa;
     || Sujeto pasivo : Fecha de la declaracion : A¤o
     TipoDato = "N";  Long = 4;  aAlfa = EjerInf;      |HAZ Formateo714; Cadena = Cadena + aAlfa;
     || Sujeto pasivo : RESERVADO
     Cadena = Cadena + (" " * 21);
     || Sujeto pasivo : SELLO ELECTRONICO (RESERVADO)
     Cadena = Cadena + (" " * 13);
     |HAZ GrabaCadena714; Cadena = "";

     Cadena = "</T71401>" + eaCRLF; |HAZ GrabaCadena714;
|FPRC;

|PROCESO TotalizaLineas;
     |SI aCapit = "A1"; |O aCapit = "A2";
        |SI aCapit = "A1"; |Y #rem00099#22 = "N"; |ACABA; |FINSI;
        |SI aCapit = "A2"; |Y #rem00099#22 = "S"; |ACABA; |FINSI;
     |FINSI;

     nFactor = 1;
     |SI VTipo = "ZPATRITIT";
        |SI #rem00099#3 = "CONYUGE   "; |ACABA;        |FINSI;
        |SI #rem00099#3 = "GANANCIAL "; nFactor = 0.5; |FINSI;
        |SI #rem00099#3 = "VARIOS    "; nFactor = #rem00099#20 / 100; |FINSI;
     |FINSI;
     |SI VTipo = "ZPATRICON";
        |SI #rem00099#3 = "TITULAR   "; |ACABA;        |FINSI;
        |SI #rem00099#3 = "GANANCIAL "; nFactor = 0.5; |FINSI;
        |SI #rem00099#3 = "VARIOS    "; nFactor = #rem00099#21 / 100; |FINSI;
     |FINSI;

     nTotal1 = nTotal1 + ((#rem00099#nCmp# * nFactor) ! 2);
     nTotal2 = nTotal2 + ((#rem00099#23 * nFactor) ! 2);
|FPRC;

|DEFBUCLE TotalizaLineas;
     #rem00099#1;
     ;
     VEmpresa, aCodigo, 001;
     VEmpresa, aCodigo, 999;
     ;
     NULL, TotalizaLineas;
|FIN;

|PROCESO GrabaDatos;
     |SI aCapit = "A1"; |O aCapit = "A2";
        |SI aCapit = "A1"; |Y #rem00099#22 = "N"; |ACABA; |FINSI;
        |SI aCapit = "A2"; |Y #rem00099#22 = "S"; |ACABA; |FINSI;
     |FINSI;

     nFactor = 1;
     |SI VTipo = "ZPATRITIT";
        |SI #rem00099#3 = "CONYUGE   "; |ACABA;        |FINSI;
        |SI #rem00099#3 = "GANANCIAL "; nFactor = 0.5; |FINSI;
        |SI #rem00099#3 = "VARIOS    "; nFactor = #rem00099#20 / 100; |FINSI;
     |FINSI;
     |SI VTipo = "ZPATRICON";
        |SI #rem00099#3 = "TITULAR   "; |ACABA;        |FINSI;
        |SI #rem00099#3 = "GANANCIAL "; nFactor = 0.5; |FINSI;
        |SI #rem00099#3 = "VARIOS    "; nFactor = #rem00099#21 / 100; |FINSI;
     |FINSI;

     |SI nFactor = 0; |ACABA; |FINSI;

     nCalc = ((nCont-1) * nCantPP);
     nRegistro = nRegistro + 1;
     |SI nRegistro > nCalc; || Corresponde a esta pagina
        nNumRegs = nNumRegs + 1;
        |SI nNumRegs [ nCantPP;
           Cadena = ""; aAlfa3 = aDatosRep;
           |PARA; |SI aAlfa3 ! ""; |HACIENDO;
              aAlfa3 = aAlfa3 - ",";
              |SI FSalida ! 0;
                 nCalc = FSalida; nCalc = ((nCalc / 100) ! 0) + 99;
                 aAlfa1 = aAlfa3 % nCalc; aAlfa3 = aAlfa3 - aAlfa1;
              |SINO;
                 aAlfa1 = aAlfa3; aAlfa3 = "";
              |FINSI;
              |SI aAlfa1 ! "";
                 aAlfa2 = aAlfa1 % -103; aAlfa1 = aAlfa1 % -499; nCmp = aAlfa2;
                 aAlfa2 = aAlfa1 % -103; aAlfa1 = aAlfa1 % -499; LongDec = aAlfa2;
                 aAlfa2 = aAlfa1 % -103; aAlfa1 = aAlfa1 % -499; Long = aAlfa2;
                 TipoDato = aAlfa1;

                 aAlfa = #rem00099#nCmp#;
                 |SI nCmp = 10;
                    nCalc = (#rem00099#nCmp# * nFactor) ! 2;
                    aAlfa = nCalc;
                 |FINSI;

                 |SI nCmp = 6;
                    || SI pasamos el campo 6 (Situacion) lo montamos con la
                    ||    direccion, municipio y provincia
                    |SI aCodigo = "A1"; |O aCodigo = "A2"; |O aCodigo = "C2";
                       aAlfa = #rem00099#6; |QBF aAlfa;
                       aAlfa1 = #rem00099#7; |QBF aAlfa1;
                       |SI aAlfa1 ! ""; aAlfa = aAlfa + "," + aAlfa1; |FINSI;

                       |SI #rem00099#8 ! 0; |O #rem00099#9 ! 0;
                          enCodProv = #rem00099#8; enCodPobl = #rem00099#9; |HAZ LeePoblacion;
                          aAlfa1 = #poblaci@#3; |QBF aAlfa1;
                          aAlfa1 = aAlfa1 + "-" + #poblaci@#2; |QBF aAlfa1;
                          aAlfa = aAlfa + "," + aAlfa1;
                       |FINSI;
                    |FINSI;
                    |SI aCodigo = "M1";
                       aAlfa = #rem00099#6; |QBF aAlfa;
                       |SI aAlfa = "";
                          aAlfa = #rem00099#15; |QBF aAlfa;
                       |SINO;
                          aAlfa = aAlfa + "/" + #rem00099#15; |QBF aAlfa;
                       |FINSI;
                    |FINSI;
                 |FINSI;

                 |HAZ Formateo714; Cadena = Cadena + aAlfa;
  /*
                 |SI nCmp = 10;
                    nTotal1 = nTotal1 + (#rem00099#nCmp# * nFactor);
                    nTotal2 = nTotal2 + (#rem00099#23 * nFactor);
                 |FINSI;
  */
              |FINSI;
           |SIGUE;
           |HAZ GrabaCadena714;
        |SINO;
           |ERROR10;
        |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE GrabaDatos;
     #rem00099#1;
     ;
     VEmpresa, aCodigo, 001;
     VEmpresa, aCodigo, 999;
     ;
     NULL, GrabaDatos;
|FIN;

|PROCESO RellenaVacios;
     Cadena = ""; aAlfa3 = aDatosRep;
     |PARA; |SI aAlfa3 ! ""; |HACIENDO;
        aAlfa3 = aAlfa3 - ",";
        |SI FSalida ! 0;
           nCalc = FSalida; nCalc = ((nCalc / 100) ! 0) + 99;
           aAlfa1 = aAlfa3 % nCalc; aAlfa3 = aAlfa3 - aAlfa1;
        |SINO;
           aAlfa1 = aAlfa3; aAlfa3 = "";
        |FINSI;
        |SI aAlfa1 ! "";
           aAlfa2 = aAlfa1 % -103; aAlfa1 = aAlfa1 % -499; nCmp = aAlfa2;
           aAlfa2 = aAlfa1 % -103; aAlfa1 = aAlfa1 % -499; LongDec = aAlfa2;
           aAlfa2 = aAlfa1 % -103; aAlfa1 = aAlfa1 % -499; Long = aAlfa2;
           TipoDato = aAlfa1; nCalc = Long + LongDec;

           |SI TipoDato = "N";
              Cadena = Cadena + ("0" * nCalc);
           |SINO;
              Cadena = Cadena + (" " * nCalc);
           |FINSI;
        |FINSI;
     |SIGUE;

     aAlfa = Cadena;
     |SI nNumRegs < nCantPP;
        |PARA; |SI nNumRegs < nCantPP; |HACIENDO nNumRegs = nNumRegs + 1;
           Cadena = aAlfa; |HAZ GrabaCadena714;
        |SIGUE;
     |FINSI;
|FPRC;

|PROCESO GrabaCapituloA1;
     || En aCodigo esta el capitulo, en nCantPP esta el n§ de lineas por pagina,
     ||    en aDatosRep es de forma TXXXYYY repetidos y T = Alfa/Num/Fecha, XXX es
     ||    la longitud del dato y YYY es el n§ de campo del fichero de afecto a
     ||    patrimonio.

     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "A1"; nCantPP = 2; nRegistro = 0; nNumRegs = 0; aCapit = "A1";
     |BUCLE TotalizaLineas;

     aDatosRep = "A001000016,An020000017,An033000006,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 2; Casilla = "060"; |HAZ BuscaCasilla714; nCasilla60 = Casilla;
        Bloque = 2; Casilla = "061"; |HAZ BuscaCasilla714; nCasilla61 = Casilla;
        nCasilla62 = nCasilla60 - nCasilla61;
     |SINO;
        nCasilla60 = 0; nCasilla61 = 0; nCasilla62 = 0;
     |FINSI;

     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla60; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     aAlfa = nCasilla61; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     aAlfa = nCasilla62; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714; Cadena = "";
|FPRC;

|PROCESO GrabaCapituloA2;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "A1"; nCantPP = 8; nRegistro = 0; nNumRegs = 0; aCapit = "A2";
     |BUCLE TotalizaLineas;

     aDatosRep = "A001000016,A001000019,An020000017,An033000006,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;
     aCapit = "";

     Cadena = "";
     |SI nCont = 1;
        Bloque = 1; Casilla = "001"; |HAZ BuscaCasilla714; nCasilla01 = Casilla;
        nCasilla63 = nCasilla01 - nCasilla62;
     |SINO;
        nCasilla63 = 0; nCasilla01 = 0;
     |FINSI;

     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla63; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     aAlfa = nCasilla01; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapituloB1;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "B1"; nCantPP = 10; nRegistro = 0; nNumRegs = 0;
     |BUCLE TotalizaLineas;

     aDatosRep = "A001000016,An020000017,An037000006,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     |SI nNumRegs < nCantPP;
        |PARA; |SI nNumRegs < nCantPP; |HACIENDO nNumRegs = nNumRegs + 1;
           Cadena = (" " * 58) + ("0" * 13); |HAZ GrabaCadena714;
        |SIGUE;
     |FINSI;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 1; Casilla = "002"; |HAZ BuscaCasilla714; nCasilla = Casilla;
     |SINO;
        nCasilla = 0;
     |FINSI;
     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapituloC1;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "C1"; nCantPP = 7; nRegistro = 0; nNumRegs = 0;
     |BUCLE TotalizaLineas;

     aDatosRep = "An005000018,An028000006,An026000015,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        nCasillaA = nTotal1;
     |SINO;
        nCasillaA = 0;
     |FINSI;

     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasillaA;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapituloC2;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "C2"; nCantPP = 5; nRegistro = 0; nNumRegs = 0;
     |BUCLE TotalizaLineas;

     aDatosRep = "An005000018,An001000019,An020000017,An029000006,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 1; Casilla = "003"; |HAZ BuscaCasilla714; nCasilla = Casilla;
        nCasillaB = nCasilla - nCasillaA;
     |SINO;
        nCasillaB = 0; nCasilla = 0;
     |FINSI;
     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasillaB;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     aAlfa = nCasilla;    |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapituloD1;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "D1"; nCantPP = 12; nRegistro = 0; nNumRegs = 0;
     |BUCLE TotalizaLineas;

     aDatosRep = "An005000018,An001000019,An020000017,An029000006,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 2; Casilla = "004"; |HAZ BuscaCasilla714; nCasilla = Casilla;
     |SINO;
        nCasilla = 0;
     |FINSI;
     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapituloE1;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "E1"; nCantPP = 12; nRegistro = 0; nNumRegs = 0;
     aDatosRep = "An041000006,An020000013,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 1; Casilla = "005"; |HAZ BuscaCasilla714; nCasilla = Casilla;
     |SINO;
        nCasilla = 0;
     |FINSI;
     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapituloF1;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "F1"; nCantPP = 10; nRegistro = 0; nNumRegs = 0;
     aDatosRep = "An062000006,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 1; Casilla = "006"; |HAZ BuscaCasilla714; nCasilla = Casilla;
     |SINO;
        nCasilla = 0;
     |FINSI;
     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapituloF2;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "F2"; nCantPP = 6; nRegistro = 0; nNumRegs = 0;
     aDatosRep = "An062000006,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 1; Casilla = "007"; |HAZ BuscaCasilla714; nCasilla = Casilla;
     |SINO;
        nCasilla = 0;
     |FINSI;
     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapituloG1;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "G1"; nCantPP = 10; nRegistro = 0; nNumRegs = 0;
     aDatosRep = "An062000006,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 1; Casilla = "008"; |HAZ BuscaCasilla714; nCasilla = Casilla;
     |SINO;
        nCasilla = 0;
     |FINSI;
     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapituloG2;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "G2"; nCantPP = 13; nRegistro = 0; nNumRegs = 0;
     aDatosRep = "An062000006,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 1; Casilla = "009"; |HAZ BuscaCasilla714; nCasilla = Casilla;
     |SINO;
        nCasilla = 0;
     |FINSI;
     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapituloG3;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "G3"; nCantPP = 4; nRegistro = 0; nNumRegs = 0;
     aDatosRep = "An062000006,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 1; Casilla = "010"; |HAZ BuscaCasilla714; nCasilla = Casilla;
     |SINO;
        nCasilla = 0;
     |FINSI;
     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapituloG4;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "G4"; nCantPP = 4; nRegistro = 0; nNumRegs = 0;
     aDatosRep = "An062000006,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 1; Casilla = "011"; |HAZ BuscaCasilla714; nCasilla = Casilla;
     |SINO;
        nCasilla = 0;
     |FINSI;
     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapituloH1;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "H1"; nCantPP = 3; nRegistro = 0; nNumRegs = 0;
     aDatosRep = "An062000006,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 2; Casilla = "012"; |HAZ BuscaCasilla714; nCasilla = Casilla;
     |SINO;
        nCasilla = 0;
     |FINSI;
     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapituloH2;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "H2"; nCantPP = 3; nRegistro = 0; nNumRegs = 0;
     aDatosRep = "An062000006,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 2; Casilla = "013"; |HAZ BuscaCasilla714; nCasilla = Casilla;
     |SINO;
        nCasilla = 0;
     |FINSI;
     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapituloI1;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "I1"; nCantPP = 3; nRegistro = 0; nNumRegs = 0;
     aDatosRep = "An062000006,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 1; Casilla = "014"; |HAZ BuscaCasilla714; nCasilla = Casilla;
     |SINO;
        nCasilla = 0;
     |FINSI;
     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapituloJ1;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "J1"; nCantPP = 3; nRegistro = 0; nNumRegs = 0;
     aDatosRep = "An041000006,A001000016,N011002014,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 1; Casilla = "015"; |HAZ BuscaCasilla714; nCasilla = Casilla;
     |SINO;
        nCasilla = 0;
     |FINSI;
     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapituloK1;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "K1"; nCantPP = 8; nRegistro = 0; nNumRegs = 0;
     aDatosRep = "An062000006,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 1; Casilla = "016"; |HAZ BuscaCasilla714; nCasilla = Casilla;
     |SINO;
        nCasilla = 0;
     |FINSI;
     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapituloL1;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "L1"; nCantPP = 6; nRegistro = 0; nNumRegs = 0;
     aDatosRep = "An062000006,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 1; Casilla = "017"; |HAZ BuscaCasilla714; nCasilla = Casilla;
     |SINO;
        nCasilla = 0;
     |FINSI;
     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapituloM1;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "M1"; nCantPP = 6; nRegistro = 0; nNumRegs = 0;
     aDatosRep = "A001000016,An020000017,An021000006,N011002014,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 1; Casilla = "018"; |HAZ BuscaCasilla714; nCasilla = Casilla;
     |SINO;
        nCasilla = 0;
     |FINSI;
     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapituloN1;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "N1"; nCantPP = 3; nRegistro = 0; nNumRegs = 0;
     aDatosRep = "An062000006,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 1; Casilla = "019"; |HAZ BuscaCasilla714; nCasilla = Casilla;
     |SINO;
        nCasilla = 0;
     |FINSI;
     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapituloO1;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "O1"; nCantPP = 3; nRegistro = 0; nNumRegs = 0;
     aDatosRep = "An062000006,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 1; Casilla = "020"; |HAZ BuscaCasilla714; nCasilla = Casilla;
     |SINO;
        nCasilla = 0;
     |FINSI;
     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapituloP1;
|FPRC;

|PROCESO GrabaCapituloQ1;
     nTotal1 = 0; nTotal2 = 0;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "P1"; nCantPP = 3; nRegistro = 0; nNumRegs = 0;
     aDatosRep = "An062000006,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 1; Casilla = "021"; |HAZ BuscaCasilla714; nCasilla = Casilla;
     |SINO;
        nCasilla = 0;
     |FINSI;
     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
     aCodigo = "Q1"; nCantPP = 6; nRegistro = 0; nNumRegs = 0;
     aDatosRep = "An062000006,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 1; Casilla = "022"; |HAZ BuscaCasilla714; nCasilla = Casilla;
     |SINO;
        nCasilla = 0;
     |FINSI;
     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapituloU1;
     nTotal1 = 0; nTotal2 = 0;
     aCodigo = "U1"; nCantPP = 11; nRegistro = 0; nNumRegs = 0;
     aDatosRep = "An062000006,N011002010"; |BUCLE GrabaDatos;
     |HAZ RellenaVacios;

     Cadena = "";
     |SI nCont = 1;
        Bloque = 1; Casilla = "024"; |HAZ BuscaCasilla714; nCasilla = Casilla;
     |SINO;
        nCasilla = 0;
     |FINSI;
     TipoDato = "N"; Long = 11; LongDec = 2;
     aAlfa = nCasilla;   |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaCapitulos;
     |SI nPagina = 2;
        |HAZ GrabaCapituloA1; |HAZ GrabaCapituloA2; |HAZ GrabaCapituloB1;
     |FINSI;
     |SI nPagina = 3;
        |HAZ GrabaCapituloC1; |HAZ GrabaCapituloC2; |HAZ GrabaCapituloD1;
     |FINSI;
     |SI nPagina = 4;
        |HAZ GrabaCapituloE1; |HAZ GrabaCapituloF1; |HAZ GrabaCapituloF2;
     |FINSI;
     |SI nPagina = 5;
        |HAZ GrabaCapituloG1; |HAZ GrabaCapituloG2; |HAZ GrabaCapituloG3;
     |FINSI;
     |SI nPagina = 6;
        |HAZ GrabaCapituloG4; |HAZ GrabaCapituloH1; |HAZ GrabaCapituloH2;
        |HAZ GrabaCapituloI1; |HAZ GrabaCapituloJ1;
     |FINSI;
     |SI nPagina = 7;
        |HAZ GrabaCapituloK1; |HAZ GrabaCapituloL1; |HAZ GrabaCapituloM1;
        |HAZ GrabaCapituloN1;
     |FINSI;
     |SI nPagina = 8;
        |HAZ GrabaCapituloO1; |HAZ GrabaCapituloP1; |HAZ GrabaCapituloQ1;
        |HAZ GrabaCapituloU1;
     |FINSI;
|FPRC;

|PROCESO Hojas02a08;
     #rem01044#0 = VEmpresa;
     #rem01044#1 = 0;
     #rem01044#2 = aTipo;
     |LEE 000#rem01044.=;
     |SI FSalida ! 0; |DDEFECTO #rem01044; |FINSI;

     |PARA nPagina = 2; |SI nPagina [ 8; |HACIENDO nPagina = nPagina + 1;
        enPagina = nPagina; |HAZ MiraObligatoria;
        |SI enConDatos = 1;
           |PARA nCont = 1; |SI nCont [ enNumPags; |HACIENDO nCont = nCont + 1;
              Cadena = "<T7140" + nPagina + ">";          |HAZ GrabaCadena714; Cadena = "";
              |SI nCont = 1;
                 nCalc = enNumPags - 1;
                 Cadena = " " + nCalc;
              |SINO;
                 Cadena = "C0";
              |FINSI;
              |HAZ GrabaCadena714; Cadena = "";

              |HAZ GrabaCapitulos;
              Cadena = "</T7140" + nPagina + ">" + eaCRLF; |HAZ GrabaCadena714;
           |SIGUE;
        |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Hoja09714;
     Cadena = "<T71409> "; |HAZ GrabaCadena714; Cadena = "";

     TipoDato = "N"; Long = 11; LongDec = 2;
     Bloque = 1; Casilla = "001"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1; Casilla = "002"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1; Casilla = "003"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1; Casilla = "005"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1; Casilla = "006"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1; Casilla = "007"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1; Casilla = "008"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1; Casilla = "009"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1; Casilla = "010"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714; Cadena = "";

     Bloque = 1; Casilla = "011"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1; Casilla = "014"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1; Casilla = "015"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1; Casilla = "016"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1; Casilla = "017"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1; Casilla = "018"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1; Casilla = "019"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1; Casilla = "020"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714; Cadena = "";

     Bloque = 1; Casilla = "021"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1; Casilla = "022"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1; Casilla = "023"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1; Casilla = "024"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1; Casilla = "025"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1; Casilla = "026"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1; Casilla = "027"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714; Cadena = "";

     Bloque = 2; Casilla = "060"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 2; Casilla = "061"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 2; Casilla = "004"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 2; Casilla = "012"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 2; Casilla = "013"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 3; Casilla = "028"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;

     Cadena = "</T71409>"; |HAZ GrabaCadena714;
|FPRC;

|PROCESO Hoja10714;
     Cadena = "<T71410> "; |HAZ GrabaCadena714; Cadena = "";

     TipoDato = "N"; Long = 11; LongDec = 2;

     Bloque = 4; Casilla = "029"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;

     Bloque = 5; Casilla = "030"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;

     Bloque = 5; Casilla = "031"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;

     Bloque = 5; Casilla = "032"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;

     Bloque = 5; Casilla = "033"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;

     Bloque = 5; Casilla = "034"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;

     Bloque = 5; Casilla = "035"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;

     Bloque = 5; Casilla = "036"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;

     Bloque = 5; Casilla = "037"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714; Cadena = "";

     Bloque = 5; Casilla = "038"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;

     Bloque = 5; Casilla = "039"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;

     Bloque = 6; Casilla = "040"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;

     TipoDato = "N"; Long = 2; LongDec = 2;
     Bloque = 7; Casilla = "TME"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;

     TipoDato = "N"; Long = 11; LongDec = 2;
     Bloque = 7; Casilla = "a  "; |HAZ BuscaCasilla714;

     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 7; Casilla = "b  "; |HAZ BuscaCasilla714;

     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 7; Casilla = "041"; |HAZ BuscaCasilla714;

     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 8; Casilla = "042"; |HAZ BuscaCasilla714;

     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 8; Casilla = "043"; |HAZ BuscaCasilla714;

     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714; Cadena = "";

     Bloque = 8;  Casilla = "044"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;

     Bloque = 9;  Casilla = "045"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;

     Bloque = 10; Casilla = "050"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;

     Bloque = 11; Casilla = "055"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;

     Bloque = 12; Casilla = "056"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;

     Bloque = 12; Casilla = "057"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714;

     Cadena = "</T71410>"; |HAZ GrabaCadena714;
|FPRC;

|PROCESO Hoja11714;
     Cadena = "<T71411> "; |HAZ GrabaCadena714; Cadena = "";

     TipoDato = "N"; Long = 11; LongDec = 2;
     Bloque = 1;  Casilla = "023"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1;  Casilla = "025"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 1;  Casilla = "027"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 4;  Casilla = "029"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 11; Casilla = "055"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     Bloque = 12; Casilla = "057"; |HAZ BuscaCasilla714;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;

     nCalc = Casilla;
     |SI nCalc > 0;
        Bloque = 12; Casilla = "057"; |HAZ BuscaCasilla714;
     |SINO;
        Bloque = 11; Casilla = "055"; |HAZ BuscaCasilla714;
     |FINSI;
     aAlfa = Casilla; |HAZ Formateo714; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadena714; Cadena = "";

     Bloque = 11; Casilla = "055"; |HAZ BuscaCasilla714;
     nCalc = Casilla;
     aAlfa = "0"; nConCta = 0;
     |SI nCalc ! 0;
        |SI #rem01001#9 = "A"; aAlfa = "2"; nConCta = 1; |FINSI;
        |SI #rem01001#9 = "D"; aAlfa = "3"; nConCta = 1; |FINSI;
     |FINSI;
     Cadena = Cadena + aAlfa;

     |SI nConCta = 1;
        aAlfa = VTipo; |QBF aAlfa;
        |SI aAlfa = "ZPATRITIT"; aAlfa = #rem00100#147; |FINSI;
        |SI aAlfa = "ZPATRICON"; aAlfa = #rem00100#148; |FINSI;
     |SINO;
        aAlfa = " " * 34;
     |FINSI;
     Cadena = Cadena + aAlfa;

     Bloque = 11; Casilla = "055"; |HAZ BuscaCasilla714;
     nCalc = Casilla;
     |SI nCalc [ 0;
        Cadena = Cadena + "1";
     |SINO;
        Cadena = Cadena + "0";
     |FINSI;
     |HAZ GrabaCadena714;

     Cadena = "</T71411>"; |HAZ GrabaCadena714;
|FPRC;

|PROCESO GrabaSecuencial714;
   eaIP = ""; |IP_REMOTO eaIP;

   VEmpresa = enEmpresa; VTipo    = eaTipo;
   aNif = eaNif; |QBF aNif; aNif = aNif % 0108;

   Nombre = ("00000" + VEmpresa) % -105;
   Nombre = "pa" + Nombre;
   |QBF Nombre;
   Comodin = VTipo; |QBF Comodin;
   Nombre = Nombre + (Comodin % -301) + ".txt";
   |QBF Nombre;

   |DBASE Comodin; |QBF Comodin;
   Comodin = Comodin + "tmp/"; |MKDIR Comodin;
   Comodin = Comodin + Nombre;
   |XABRE "WB", Comodin, enHandle;
   enHandle = FSalida;
   |SI FSalida < 0; |MENAV "    Problemas al abrir el fichero ascii"; |ACABA; |FINSI;

   |ABRE #rem00101; |ABRE #rem01001; |ABRE #rem01002;
   |ABRE #rem01044;

   |SELECT #2#rem01002;

   #rem01001#0 = VEmpresa;
   #rem01001#1 = 0;
   #rem01001#2 = VTipo;
   |LEE 000#rem01001.=;

   eaCRLF = "";
||   eaCRLF = &13 + &10;

   LongDec = 0;
   Cadena = "<T714020130A0000><AUX>";
   Cadena = Cadena + (" " * 30);
   Cadena = Cadena + #reemi100#35;
   Cadena = Cadena + (" " * 39);
   Cadena = Cadena + "0100    ";
   |HAZ GrabaCadena714; Cadena = "";

   Cadena = "B53179768"; |HAZ GrabaCadena714; Cadena = "";

   Cadena = Cadena + (" " * 100);
   Cadena = Cadena + (" " * 113);
   |HAZ GrabaCadena714; Cadena = "";

   Cadena = "</AUX><VECTOR>"
   |HAZ GrabaCadena714; Cadena = "";
   |HAZ GrabaVector714;
   Cadena = "</VECTOR>" + eaCRLF;
   |HAZ GrabaCadena714; Cadena = "";

   |HAZ Hoja01714;

   |HAZ Hojas02a08;

   |HAZ Hoja09714;
   |HAZ Hoja10714;
   |HAZ Hoja11714;

   Cadena = "</T714020130A0000>" + eaCRLF;
   |HAZ GrabaCadena714; Cadena = "";

   |CIERRA #rem01044;
   |CIERRA #rem01002; |CIERRA #rem00101; |CIERRA #rem01001;

   |XCIERRA enHandle; SwDatos = 1;
|FPRC;
