|FICHEROS;
     rem00019 #19;
     rem00020 #20;

     rew00619,MANTE;

     rew99999 #999;
|FIN;

|VARIABLES;
     aFichero      = "";
     nAnyos        = 0;
     nRango        = 0;
     nGrid         = 0;
     nVentana      = 0;

     aEsc1         = "";
     aEsc2         = "";
     aRetu         = "";
     aTecla        = "";

     &enSwPresenta = 0;
     &enEmpresa    = 0;
     &enModo       = 0;
|FIN;

|PROCESO Tipo7C0Fw610;  |TIPO 7;
     enSwPresenta = 1;
     |HAZ SacaDeclarantes;

     aFichero = (Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #999 aFichero;
     |ABRE #999;
     |SELECT #2#999;
     #999#1 = #19#1;
     |LEE 040#999=;
     |SI FSalida ! 0;  |DDEFECTO #999;  |FINSI;
     |CIERRA #999;

     |C_M #rew00619#0, 1, "S";
     nAnyos = 2013 - #999#6;
     |SI nAnyos < 65;
         |C_M #rew00619#2, 1, "N";  #rew00619#0 = "N";  |PINTA #rew00619#0;
     |FINSI;

     enSwPresenta = 0;
|FPRC;

|PROCESO Tipo0C1Fw610;  |TIPO 0;
     |C_M #rew00619#2, 1, "S";
     |SI #rew00619#1 = "N";
         |C_M #rew00619#2, 1, "N";  #rew00619#2 = "0";  |PINTA #rew00619#2;
     |FINSI;
|FPRC;

|PROCESO Tipo12Fw610;  |TIPO 12;
|FPRC;

|PROCESO Evento19;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#19=;
     |FINSI;

     |SI FSalida = 4;
         |SI enModo = 4;  |ACABA;  |FINSI;

         |LEE 101#19=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |VENTANA 0501, 1140, -1, 0, "";
         nVentana = FSalida;

         |PTEC 802;  |PAUSA;

         #rew00619#0 = #19#2;
         #rew00619#1 = #19#3;
         #rew00619#2 = #19#4;

         |PINPA #0#rew00619;
         |PINDA #0#rew00619;

         |ENDATOS #1#rew00619;
         |SI FSalida = 0;
             #19#2 = #rew00619#0;
             #19#3 = #rew00619#1;
             #19#4 = #rew00619#2;

             |GRABA 020#19a;
         |FINSI;
         |LIBERA #19;

         |FINVENTANA nVentana;

         |REFRESCACONTROL nGrid;
     |FINSI;

     |PULSATECLA;
|FPRC;

|PROCESO rem00020;
     #20#0  = #19#0;
     #20#2  = #19#1;
     |LEE 101#20=;
     |SI FSalida ! 0;
         |BORRA 020#19a;
     |FINSI;
     |LIBERA #19;
|FPRC;

|DEFBUCLE rem00019;
     #19#1;
     ;
     enEmpresa, "          ";
     enEmpresa, "zzzzzzzzzz";
     ;
     NULL, rem00020;
|FIN;

|PROCESO Baja19;
     #19#0 = enEmpresa;
     #19#1 = "          ";
|FPRC;

|PROCESO Alta19;
     #19#0 = enEmpresa;
     #19#1 = "zzzzzzzzzz";
|FPRC;

|PROGRAMA;
     |HAZ CargaColores;

     |ABRE #20;
     |SELECT #3#20;
     |BUCLE rem00019;
     |CIERRA #20;

     |PINPA #0#19;

     |ABRE #19;
     nRango = 4 + 8 + 16 + 32 + 128;

     |LINEAL_SIMPLE #1#19, nRango, 0802, 3398, Baja19, Alta19, Evento19;
     nGrid = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::{{001}}Salir," + nGrid;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;
          |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |CIERRA #19;
|FPRO;
