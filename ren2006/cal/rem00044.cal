|FICHEROS;
     rem00044 #20;
     rem00021 #6;
     rem00007 #7,MANTE;
     rem00008 #8;
     rem00100 #100;
     rem00101 #101;
     reparame #1;
     rew99999 #999;
     rew99998 #900,MANTE;
     espejo@ #99;
|FIN;

|VARIABLES;
     aAlfa         = "";
     aAlfa1        = "";
     aLong         = "";
     aQueQuiero    = "";
     aNumCampos    = "";
     aNumPanta     = "";
     aPathRenta    = "";
     aDef          = "";
     aPerceptor    = "";
     aEdad         = "";
     aEdadPer      = "";
     aAnyoAdop     = "";
     aTecla        = "";
     aEdadTit      = "";
     aEdadCon      = "";

     nLong         = 0;
     nCaracter     = 0;
     nPosi         = 0;
     nPanta        = 0;
     nNumCampos    = 0;
     nNumPanta     = 0;
     nCampo        = 0;
     nModo         = 0;
     nEntrada      = 0;
     nComunidad    = 0;
     nTipo         = 0;
     nLinea        = 0;
     nNumero       = 0;
     nInversion    = 0;
     nDeduccion    = 0;
     nDeduccionC   = 0;
     nHijosAnt     = 0;
     nHijosEje     = 0;
     nHijosDed     = 0;
     nHijosDed1    = 0;
     nHijosDed2    = 0;
     nHijosDed3    = 0;
     nHijosDedM    = 0;
     nHijosDedM1   = 0;
     nHijosDedM2   = 0;
     nHijosDedM3   = 0;

     nHijosAdop    = 0;
     nHijosAdop3   = 0;
     nAscend       = 0;
     nAscendN      = 0;
     nAscend70     = 0;
     nAscend65     = 0;
     nAscend65Prop = 0;
     nMinusv       = 0;
     nMinusTodos   = 0;
     nMinusv65     = 0;
     nMinusD       = 0;
     nMinusD65     = 0;
     nEdadMayor    = 0;
     nTotalHijos   = 0;
     nHijos        = 0;
     nHijosTres    = 0;
     nHijosTres1   = 0;
     nHijosTres2   = 0;
     nHijosTresA   = 0;
     nHijosTresA1  = 0;
     nHijosTresA2  = 0;
     nHijosTresA3  = 0;
     nHijosDosA    = 0;
     nHijos2004    = 0;
     nHijos2005    = 0;
     nHijosMult    = 0;
     nHijosMult3   = 0;
     nHijos65      = 0;
     nHijos65Prop  = 0;
     nCantidad     = 0;
     nPorce        = 0;
     nGradoMinus   = 0;
     nSwMensa      = 0;
     nTope         = 0;
     nAndalucia    = 0;
     nPuesto       = 0;
     nDesde        = 0;

     aAyuda        = "";

     fFecha        = @;

     &enEmpresa    = 0;
     &enModo       = 0;
     &eaDeclarante = "";
     &enComunes    = 0;
     &enMinusvalia = 0;
     &eaMinuAyuda  = "";
     &eaFallece    = "";
     &eaSwVarios   = "";
     &eaVarDni     = "";
     &enSwLiquida  = 0;
     &enSwRetorno  = 0;
     &eaPrograma   = "";
     &eaPunto      = "";
     &enAutonomia  = 0;
     &enSwPresenta = 0;
|FIN;

|PROCESO Tipo12w98;  |TIPO 12;
|FPRC;

|| ************************************************************************
|| PROCESOS DE CONSULTA DE PANTALLAS NORMALES
|| ************************************************************************

|PROCESO IncrementoConjunta;
       |C_M #20#22, 1, "S";

       |SI #20#13 ! 800;  |Y #20#13 ! 806;  |Y #20#13 ! 808;  |Y #20#13 ! 809;
        |Y #20#13 ! 832;  |Y #20#13 ! 836;  |Y #20#13 ! 840;  |Y #20#13 ! 847;
        |Y #20#13 ! 848;  |Y #20#13 ! 856;  |Y #20#13 ! 869;  |Y #20#13 ! 875;
        |Y #20#13 ! 876;  |Y #20#13 ! 886;  |Y #20#13 ! 890;  |Y #20#13 ! 892;
        |Y #20#13 ! 909;
           |C_M #20#22, 1, "N";  #20#22 = 0;  |PINTA #20#22;
       |FINSI;
|FPRC;

|PROCESO LeeCasillaComunidad;
     #8#0 = nComunidad;
     #8#1 = nTipo;
     |LEE 040#8=;
     |SI FSalida ! 0;  |DDEFECTO #8;  |FINSI;
|FPRC;

|PROCESO GrabaLinea;
     |ABRE #7;
     #7#0 = nComunidad;
     |LEE 040#7=;
     |SI FSalida ! 0;  |CIERRA #7;  |ACABA;  |FINSI;
     |CIERRA #7;

     |HAZ LeeCasillaComunidad;

     |DDEFECTO #20;
     nLinea = nLinea + 1;
     #20#0   = enEmpresa;
     #20#1   = nLinea;
     #20#2   = aPerceptor;
     #20#3   = "A";
     #20#11  = #7#0;
     #20#12  = #7#1;
     #20#13  = #8#1;
     #20#14  = #8#2;
     #20#15  = #8#3;
     #20#16  = #8#4;
     #20#17  = nNumero;
     #20#18  = nInversion;
     #20#19  = nDeduccion;
     #20#22  = nDeduccionC;

     |GRABA 020#20n;
     |LIBERA #20;
|FPRC;

|PROCESO Descendientes;
     |SI #101#7 = " ";
         nTotalHijos = nTotalHijos + 1;
     |FINSI;

     |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
         nTotalHijos = nTotalHijos + 1;
     |FINSI;

     |SI #101#7 = "3";  |Y aPerceptor = "TITULAR";
         nTotalHijos = nTotalHijos + 1;
     |FINSI;

     |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
         nTotalHijos = nTotalHijos + 1;
     |FINSI;

     |SI #101#7 = "4";  |Y aPerceptor = "CONYUGE";
         nTotalHijos = nTotalHijos + 1;
     |FINSI;

     |SI #101#5 < "2006"; |Y #101#4 ! "    ";  |Y #101#4 ! "0000";
         |SI #101#7 = " ";
             nHijosAnt = nHijosAnt + 1;
         |FINSI;

         |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
             nHijosAnt = nHijosAnt + 1;
         |FINSI;

         |SI #101#7 = "3";  |Y aPerceptor = "TITULAR";
             nHijosAnt = nHijosAnt + 1;
         |FINSI;

         |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
             nHijosAnt = nHijosAnt + 1;
         |FINSI;

         |SI #101#7 = "4";  |Y aPerceptor = "CONYUGE";
             nHijosAnt = nHijosAnt + 1;
         |FINSI;
     |FINSI;

     |SI #101#6 ] 65;
         |SI #101#7 = " ";
             nHijos65Prop  = nHijos65Prop + .5;
             nHijosDedM1   = nHijosDedM1 + 1;
         |FINSI;

         |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
             nHijos65Prop = nHijos65Prop + 1;
             nHijosDedM1  = nHijosDedM1 + 1;
         |FINSI;

         |SI #101#7 = "3";  |Y aPerceptor = "TITULAR";
             nHijos65Prop = nHijos65Prop + .5;
             nHijosDedM1  = nHijosDedM1  + 1;
             nHijosDedM3  = nHijosDedM3  + 1;
         |FINSI;

         |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
             nHijos65Prop = nHijos65Prop + 1;
             nHijosDedM1  = nHijosDedM1 + 1;
         |FINSI;

         |SI #101#7 = "4";  |Y aPerceptor = "CONYUGE";
             nHijos65Prop = nHijos65Prop + .5;
             nHijosDedM1  = nHijosDedM1 + 1;
             nHijosDedM3  = nHijosDedM3 + 1;
         |FINSI;
     |FINSI;

     aAnyoAdop = #101#18 % -104;
     |SI #101#5 = "2006";  |O aAnyoAdop = "2006";
         |SI #101#7 = " ";
             nHijosEje  = nHijosEje  + 0.5;
             nHijosDed  = nHijosDed  + 1;
             nHijosDed1 = nHijosDed1 + 1;

             |SI #101#22 = "S";  nHijosAdop = nHijosAdop + 0.5;  |FINSI;

             |SI #101#6 ] 65;
                 nHijosDedM  = nHijosDedM  + 1;
             |FINSI;
         |FINSI;

         |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
             nHijosEje  = nHijosEje  + 1;
             nHijosDed  = nHijosDed  + 1;
             nHijosDed2 = nHijosDed2 + 1;

             |SI #101#22 = "S";  nHijosAdop = nHijosAdop + 1;  |FINSI;

             |SI #101#6 ] 65;
                 nHijosDedM  = nHijosDedM  + 1;
             |FINSI;
         |FINSI;

         |SI #101#7 = "3";  |Y aPerceptor = "TITULAR";
             nHijosEje  = nHijosEje  + 0.5;
             nHijosDed  = nHijosDed  + 1;
             nHijosDed2 = nHijosDed2 + 1;
             nHijosDed3 = nHijosDed3 + 1;

             |SI #101#22 = "S";
                 nHijosAdop  = nHijosAdop  + 0.5;
                 nHijosAdop3 = nHijosAdop3 + 1;
             |FINSI;

             |SI #101#6 ] 65;
                 nHijosDedM  = nHijosDedM  + 1;
                 nHijosDedM2 = nHijosDedM2 + 1;
             |FINSI;
         |FINSI;

         |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
             nHijosEje  = nHijosEje  + 1;
             nHijosDed  = nHijosDed  + 1;
             nHijosDed2 = nHijosDed2 + 1;

             |SI #101#22 = "S";  nHijosAdop = nHijosAdop + 1;  |FINSI;

             |SI #101#6 ] 65;
                 nHijosDedM  = nHijosDedM  + 1;
             |FINSI;
         |FINSI;

         |SI #101#7 = "4";  |Y aPerceptor = "CONYUGE";
             nHijosEje  = nHijosEje  + 0.5;
             nHijosDed  = nHijosDed  + 1;
             nHijosDed2 = nHijosDed2 + 1;
             nHijosDed3 = nHijosDed3 + 1;

             |SI #101#22 = "S";
                 nHijosAdop  = nHijosAdop  + 0.5;
                 nHijosAdop3 = nHijosAdop3 + 1;
             |FINSI;

             |SI #101#6 ] 65;
                 nHijosDedM  = nHijosDedM  + 1;
                 nHijosDedM2 = nHijosDedM2 + 1;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #101#5 ] "2004";
         |SI #101#7 = " ";
             |SI #101#6 < 65;
                 nHijosTres  = nHijosTres  + 1;
                 nHijosTres1 = nHijosTres1 + 1;
             |FINSI;
         |FINSI;

         |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
             |SI #101#6 < 65;
                 nHijosTres  = nHijosTres  + 1;
                 nHijosTres2 = nHijosTres2 + 1;
             |FINSI;
         |FINSI;

         |SI #101#7 = "3";  |Y aPerceptor = "TITULAR";
             |SI #101#6 < 65;
                 nHijosTres  = nHijosTres  + 1;
                 nHijosTres2 = nHijosTres2 + 1;
             |FINSI;
         |FINSI;

         |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
             |SI #101#6 < 65;
                 nHijosTres  = nHijosTres  + 1;
                 nHijosTres2 = nHijosTres2 + 1;
             |FINSI;
         |FINSI;

         |SI #101#7 = "4";  |Y aPerceptor = "CONYUGE";
             |SI #101#6 < 65;
                 nHijosTres  = nHijosTres  + 1;
                 nHijosTres2 = nHijosTres2 + 1;
             |FINSI;
         |FINSI;
     |SINO;
         |SI #101#6 ] 65;
             |SI #101#7 = " ";
                 nHijos65  = nHijos65 + 1;
             |FINSI;

             |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
                 nHijos65  = nHijos65 + 1;
             |FINSI;

             |SI #101#7 = "3";  |Y aPerceptor = "TITULAR";
                 nHijos65  = nHijos65 + 1;
             |FINSI;

             |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
                 nHijos65  = nHijos65 + 1;
             |FINSI;

             |SI #101#7 = "4";  |Y aPerceptor = "CONYUGE";
                 nHijos65  = nHijos65 + 1;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #101#5 ] "2004";
         |SI #101#5 = "2006";
             |SI fFecha = "01.01.0000";
                 fFecha = #101#17;
             |SINO;
                 |SI fFecha = #101#17;
                     nHijosMult = nHijosMult + 1;

                     |SI #101#7 = "3";  |Y aPerceptor = "TITULAR";
                         nHijosMult3 = nHijosMult3 + 1;
                     |FINSI;

                     |SI #101#7 = "4";  |Y aPerceptor = "CONYUGE";
                         nHijosMult3 = nHijosMult3 + 1;
                     |FINSI;
                 |FINSI;
                 fFecha = #101#17;
             |FINSI;
         |FINSI;

         |SI #101#5 ! "2006";
             |SI #101#7 = " ";
                 nHijosTresA  = nHijosTresA  + 1;
                 nHijosTresA1 = nHijosTresA1 + 1;
             |FINSI;

             |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
                 nHijosTresA  = nHijosTresA  + 1;
                 nHijosTresA2 = nHijosTresA2 + 1;
             |FINSI;

             |SI #101#7 = "3";  |Y aPerceptor = "TITULAR";
                 nHijosTresA  = nHijosTresA  + 1;
                 nHijosTresA3 = nHijosTresA3 + 1;
             |FINSI;

             |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
                  nHijosTresA  = nHijosTresA  + 1;
                  nHijosTresA2 = nHijosTresA2 + 1;
             |FINSI;

             |SI #101#7 = "4";  |Y aPerceptor = "CONYUGE";
                  nHijosTresA  = nHijosTresA  + 1;
                  nHijosTresA3 = nHijosTresA3 + 1;
             |FINSI;

             |SI #101#7 = " ";
                 nHijosDosA  = nHijosDosA  + 0.5;
                 |SI #101#5 = "2004";  nHijos2004  = nHijos2004  + 0.5;  |FINSI;
                 |SI #101#5 = "2005";  nHijos2005  = nHijos2005  + 0.5;  |FINSI;
             |FINSI;

             |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
                 nHijosDosA  = nHijosDosA  + 1;
                 |SI #101#5 = "2004";  nHijos2004  = nHijos2004  + 1;  |FINSI;
                 |SI #101#5 = "2005";  nHijos2005  = nHijos2005  + 1;  |FINSI;
             |FINSI;

             |SI #101#7 = "3";  |Y aPerceptor = "TITULAR";
                 nHijosDosA  = nHijosDosA  + .5;
                 |SI #101#5 = "2004";  nHijos2004  = nHijos2004  + 0.5;  |FINSI;
                 |SI #101#5 = "2005";  nHijos2005  = nHijos2005  + 0.5;  |FINSI;
             |FINSI;

             |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
                 nHijosDosA  = nHijosDosA  + 1;
                 |SI #101#5 = "2004";  nHijos2004  = nHijos2004  + 1;  |FINSI;
                 |SI #101#5 = "2005";  nHijos2005  = nHijos2005  + 1;  |FINSI;
             |FINSI;

             |SI #101#7 = "4";  |Y aPerceptor = "CONYUGE";
                 nHijosDosA  = nHijosDosA  + .5;
                 |SI #101#5 = "2004";  nHijos2004  = nHijos2004  + 0.5;  |FINSI;
                 |SI #101#5 = "2005";  nHijos2005  = nHijos2005  + 0.5;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Ascendientes;
     |SI #101#5 [ aEdad;  |Y #101#5 ! "    ";  |Y #101#5 ! "0000";
         |SI #101#7 = " ";
             nAscend = nAscend + 1;
             |SI #101#6 < 65;
                 nAscend70  = nAscend70  + .5;
             |FINSI;
         |FINSI;

         |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
             nAscend = nAscend + 1;
             |SI #101#6 < 65;
                 nAscend70  = nAscend70  + 1;
             |FINSI;
         |FINSI;

         |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
             nAscend = nAscend + 1;
             |SI #101#6 < 65;
                 nAscend70  = nAscend70  + 1;
             |FINSI;
         |FINSI;

         |SI #101#7 = " ";  |Y #101#11 ] 50;
             nAscendN = nAscendN + .5;
         |FINSI;

         |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";  |Y #101#11 ] 50;
             nAscendN = nAscendN + 1;
         |FINSI;

         |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";  |Y #101#11 ] 50;
             nAscendN = nAscendN + 1;
         |FINSI;
     |SINO;
         |SI #101#6 ] 65;
             |SI #101#7 = " ";
                 nAscend65 = nAscend65  + .5;
             |FINSI;

             |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
                 nAscend65  = nAscend65 + 1;
             |FINSI;

             |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
                 nAscend65  = nAscend65 + 1;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #101#6 ] 65;
         |SI #101#7 = " ";
             nAscend65Prop = nAscend65  + .5;
         |FINSI;

         |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
             nAscend65Prop  = nAscend65 + 1;
         |FINSI;

         |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
             nAscend65Prop  = nAscend65 + 1;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CalcuHijos;
     |SI #101#4 = "DESCENDIENTE";  |HAZ Descendientes;  |FINSI;
     |SI #101#4 = "ASCENDIENTE ";  |HAZ Ascendientes;   |FINSI;

     |SI #101#6 ] 33;
         nMinusTodos = nMinusTodos + 1;

         |SI #101#7 = " ";
             nMinusv  = nMinusv  + 1;
         |FINSI;

         |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
             nMinusv  = nMinusv  + 1;
         |FINSI;

         |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
             nMinusv  = nMinusv  + 1;
         |FINSI;
     |FINSI;

     |SI #101#6 ] 65;
         |SI #101#7 = " ";
             nMinusv65 = nMinusv65  + .5;
         |FINSI;

         |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
             nMinusv65  = nMinusv65  + 1;
         |FINSI;

         |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
             nMinusv65  = nMinusv65 + 1;
         |FINSI;

         |SI #101#7 = "3";  |Y aPerceptor = "TITULAR";
             nMinusv65  = nMinusv65  + .5;
         |FINSI;

         |SI #101#7 = "4";  |Y aPerceptor = "CONYUGE";
             nMinusv65  = nMinusv65  + .5;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE rem00101;
     #101#1;
     ;
     #20#0, 01;
     #20#0, 99;
     ;
     NULL, CalcuHijos;
|FIN;

|PROCESO LeeFamiliar;
     nTotalHijos = 0;
     nHijosAnt   = 0;   || Numero de Hijos nacidos antes de este ejercicio
     nHijosEje   = 0;   || Numero de Hijos nacidos en este ejercicio proporcinando
     nHijosDed   = 0;   || Numero de Hijos nacidos en este ejercicio
     nHijosDed1  = 0;   || Numero de Hijos nacidos en este ejercicio
     nHijosDed2  = 0;   || Numero de Hijos nacidos en este ejercicio
     nHijosDed3  = 0;   || Numero de Hijos nacidos en este ejercicio V.3 y 4
     nHijosDedM  = 0;   || Numero de Hijos nacidos en este ejercicio Minusv.
     nHijosDedM1 = 0;   || Numero de Hijos Minusvalidos > 65.
     nHijosDedM2 = 0;   || Numero de Hijos Minusvalidos > 65. V.3 y 4
     nHijosDedM3 = 0;   || Numero de Hijos Minusvalidos > 65. V.3 y 4
     nHijos65Prop = 0;  || Hijos Minusvalidos proporcional
     nHijosTres  = 0;   || Numero de Hijos menores de Tres a¤os Minusvalia < 65
     nHijosTres1 = 0;   || Numero de Hijos menores de Tres a¤os Minusvalia < 65
     nHijosTres2 = 0;   || Numero de Hijos menores de Tres a¤os Minusvalia < 65
     nHijosTresA = 0;   || Numero de Hijos menores de Tres a¤os
     nHijosTresA1= 0;   || Numero de Hijos menores de Tres a¤os
     nHijosTresA2= 0;   || Numero de Hijos menores de Tres a¤os
     nHijosTresA3= 0;   || Numero de Hijos menores de Tres a¤os Vinculacion 3 Y 4
     nHijosDosA  = 0;   || Numero de Hijos menores de Tres a¤os
     nHijosMult  = 0;   || Hijos Multiples
     nHijosMult3 = 0;   || Hijos Multiples Vinculacion 3 y 4
     nHijosAdop  = 0;   || Numero de Hijos Adoptados internacional
     nHijosAdop3 = 0;   || Numero de Hijos Adoptados internacional Vinculacion 3 y 4
     nHijos65    = 0;   || Numero de Hijos Adoptados internacional Vinculacion 3 y 4
     nHijos2004  = 0;   || Numero de Hijos nacidos en el 2004
     nHijos2005  = 0;   || Numero de Hijos nacidos en el 2005
     nEdadMayor  = 0;   || Sujetos Pasivos de ....A¤os o mas
     nAscend     = 0;   || Ascendientes de ... A¤os  o mas
     nAscendN    = 0;   || Ascendientes de ... A¤os  o mas sin vinculacion
     nAscend70   = 0;   || Ascendientes de ... A¤os  o mas
     nAscend65   = 0;   || Ascendientes de ... A¤os  o mas
     nAscend65Prop = 0;   || Ascendientes Minusvalido proporcional
     nMinusv     = 0;   || Minusvalidos
     nMinusv65   = 0;   || Minusvalidos
     nMinusD     = 0;   || Minusvalidos
     nMinusD65   = 0;   || Minusvalidos
     nMinusTodos = 0;   || Suma de Todos los Minusvalidos
     fFecha      = "01.01.0000";

     |BUCLE rem00101;

     |SI #100#8  ] 33;  nMinusTodos = nMinusTodos + 1;  |FINSI;
     |SI #100#41 ] 33;  nMinusTodos = nMinusTodos + 1;  |FINSI;

     |SI aPerceptor = "TITULAR";
         |SI #100#8 ] 33;                           nMinusv    = nMinusv + 1; |FINSI;
         |SI #100#8 ] 33;                           nMinusD    = 1;           |FINSI;
         |SI #100#8 ] 65;                           nMinusD65  = 1;           |FINSI;
         |SI #100#7 [ aEdad;  |Y #100#7  ! "    ";  |Y #100#7 ! "0000";
             nEdadMayor = 1;
         |FINSI;
         aAyuda = #100#9;
     |FINSI;

     |SI aPerceptor = "CONYUGE";
         |SI #100#41 ] 33;                           nMinusv = nMinusv + 1; |FINSI;
         |SI #100#41 ] 33;                           nMinusD    = 1;        |FINSI;
         |SI #100#41 ] 65;                           nMinusD65  = 1;        |FINSI;
         |SI #100#40 [ aEdad;  |Y #100#40 ! "    ";  |Y #100#40 ! "0000";
             nEdadMayor = 1;
         |FINSI;
         aAyuda = #100#42;
     |FINSI;
|FPRC;

|PROCESO MiraVivienda;
     |SI #6#2 = "TITULAR   ";  |Y aPerceptor = "CONYUGE";  |ACABA;  |FINSI;
     |SI #6#2 = "CONYUGE   ";  |Y aPerceptor = "TITULAR";  |ACABA;  |FINSI;

     |SI nAndalucia = 1;
         |SI #6#30 = 0;             |ACABA;  |FINSI;
         |SI #6#25 < "01.01.2006";  |ACABA;  |FINSI;
     |FINSI;

     |SI #6#30 = 0;  |Y #6#33 = 0;
         |ACABA;
     |FINSI;

     |SI #100#11 = 1;   nCantidad    = #6#23;          |FINSI;
     |SI #100#11 = 3;   nCantidad    = #6#23 - #6#22;  |FINSI;
     |SI #100#11 = 10;  nCantidad    = #6#23 + #6#29;  |FINSI;
     |SI #100#11 = 13;  nCantidad    = #6#23 + #6#29;  |FINSI;
     |SI #100#11 = 17;  nCantidad    = #6#23 - #6#22;  |FINSI;

     |SI #6#2 = "TITULAR   ";  nPorce = 100;  |FINSI;
     |SI #6#2 = "CONYUGE   ";  nPorce = 100;  |FINSI;
     |SI #6#2 = "GANANCIAL ";  nPorce = 50;   |FINSI;
     |SI #6#2 = "VARIOS    ";
         |SI aPerceptor = "TITULAR";  nPorce = #6#5;  |FINSI;
         |SI aPerceptor = "CONYUGE";  nPorce = #6#6;  |FINSI;
     |FINSI;
     |ERROR10;
|FPRC;

|DEFBUCLE rem00021;
     #6#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     ;
     NULL, MiraVivienda;
|FIN;

|PROCESO Andalucia;
     |HAZ LeeFamiliar;

     |SI nHijosTresA ! 0;  |Y nHijosDed ! 0;
         nTipo       = 800;  |HAZ LeeCasillaComunidad;

         nNumero     = nHijosTresA;
         nInversion  = 0;
         nDeduccion  = (nHijosTresA1 * #8#9) + (nHijosTresA2 * (#8#9 * 2)) + (nHijosTresA3 * #8#9);
         |SI nHijosMult ! 0;
             nDeduccion  = nDeduccion + (#8#9 * (nHijosMult + 1));
         |FINSI;

         nDeduccionC = (nHijosTresA3 * #8#9);
         |SI nHijosMult3 ! 0;
             nDeduccionC  = nDeduccionC + (#8#9 * (nHijosMult3 + 1));
         |FINSI;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nHijosAdop ! 0;
         nTipo       = 806;   |HAZ LeeCasillaComunidad;
         nNumero     = nHijosAdop;
         nInversion  = 0;
         nDeduccion  = (nHijosAdop  * (#8#9 * 2));
         nDeduccionC = (nHijosAdop3 * #8#9);

         |HAZ GrabaLinea;
     |FINSI;

     |SI nMinusD ! 0;
         nTipo       = 807;  |HAZ LeeCasillaComunidad;
         nNumero     = 1;
         nInversion  = 0;
         nDeduccion  = #8#9;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     nCantidad  = 0;
     nPorce     = 100;
     nAndalucia = 1;
     |BUCLE rem00021;
     |SI nCantidad ! 0;
         nTipo       = 802;  |HAZ LeeCasillaComunidad;
         nNumero     = 0;
         nInversion  = nCantidad % nPorce;
         |SI nInversion > #8#13;
             nInversion = #8#13;
         |FINSI;
         nDeduccion  = nInversion % 2;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO Aragon;
     aEdad = "1931";
     |HAZ LeeFamiliar;

     |SI nHijosDed ! 0;  |Y nTotalHijos > 2;
         nHijos      = nTotalHijos - 2;
         |SI nHijosDed  > nHijos;  nHijosDed  = nHijos;    |FINSI;
         |SI nHijosDed3 > nHijos;  nHijosDed3 = nHijos;    |FINSI;

         nNumero     = nHijosDed;

         nTipo       = 808;  |HAZ LeeCasillaComunidad;
         nDeduccion  = nNumero * #8#9;
         nInversion  = 0;
         nDeduccionC = nHijosDed3 * #8#9;

         |HAZ GrabaLinea;

         |SI nHijosDed2 ! 0;  nSwMensa = 1;  |FINSI;
     |FINSI;

     |SI nHijosAdop ! 0;
         nTipo       = 809;  |HAZ LeeCasillaComunidad;
         nNumero     = nHijosAdop;
         nInversion  = 0;
         nDeduccion  = (nHijosAdop  * #8#9);
         nDeduccionC = (nHijosAdop3 * #8#9);

         |HAZ GrabaLinea;
     |FINSI;

     |SI nAscendN > 0;
         nTipo       = 810;  |HAZ LeeCasillaComunidad;
         nNumero     = nAscendN;
         nInversion  = 0;
         nDeduccion  = nNumero * (#8#9 * 2);
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nMinusv65 > 0;
         nTipo       = 810;  |HAZ LeeCasillaComunidad;
         nNumero     = nMinusv65;
         nDeduccion  = nNumero * (#8#9 * 2);
         nInversion  = 0;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO Asturias;
     aEdad = "1941";
     |HAZ LeeFamiliar;

     |SI nAscendN ! 0;
         nTipo       = 812;  |HAZ LeeCasillaComunidad;
         nNumero     = nAscendN;
         nInversion  = 0;
         nDeduccion  = nAscendN * #8#9;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nGradoMinus ] 65;
         nCantidad = 0;
         nPorce    = 100;
         |BUCLE rem00021;
         |SI nCantidad ! 0;
             nTipo       = 813;  |HAZ LeeCasillaComunidad;
             nNumero     = 0;
             nInversion  = nCantidad % nPorce;
             |SI nInversion > #8#9;
                 nInversion = #8#9;
             |FINSI;
             nDeduccion  = nInversion % 3;
             nDeduccionC = 0;

             |HAZ GrabaLinea;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Baleares;
     aEdad = "1941";
     |HAZ LeeFamiliar;

     |SI nEdadMayor > 0;
         nTipo       = 821;  |HAZ LeeCasillaComunidad;
         nNumero     = nEdadMayor;
         nInversion  = 0;
         nDeduccion  = nNumero * #8#9;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nMinusv > 0;
         nTipo       = 824;  |HAZ LeeCasillaComunidad;
         nNumero     = nMinusv;
         nDeduccion  = nNumero * #8#9;
         nInversion  = 0;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO Canarias;
     aEdad = "1941";
     |HAZ LeeFamiliar;

     |SI nHijosDed > 0;
         nPuesto = (nTotalHijos - nHijosDed) + 1;

         nTipo       = 832;  |HAZ LeeCasillaComunidad;
         nNumero     = nHijosDed;
         nInversion  = 0;
         nDeduccion  = 0;
         |PARA nDesde = nPuesto;  |SI nDesde [ nTotalHijos;  |HACIENDO nDesde = nDesde + 1;
               |SI nDesde = 1;  nDeduccion = nDeduccion + #8#9;  |FINSI;
               |SI nDesde = 2;  nDeduccion = nDeduccion + #8#9;  |FINSI;
               |SI nDesde = 3;  nDeduccion = nDeduccion + #8#11; |FINSI;
               |SI nDesde = 4;  nDeduccion = nDeduccion + #8#13; |FINSI;
               |SI nDesde ] 5;  nDeduccion = nDeduccion + #8#15; |FINSI;
         |SIGUE;

         nDeduccionC = 0;
         |SI nHijosDed3 > 0;
             nPuesto = (nTotalHijos - nHijosDed3) + 1;
             nDeduccionC = 0;
             |PARA nDesde = nPuesto;  |SI nDesde [ nTotalHijos;  |HACIENDO nDesde = nDesde + 1;
                   |SI nDesde = 1;  nDeduccionC = nDeduccionC + #8#9;   |FINSI;
                   |SI nDesde = 2;  nDeduccionC = nDeduccionC + #8#9;   |FINSI;
                   |SI nDesde = 3;  nDeduccionC = nDeduccionC + #8#11;  |FINSI;
                   |SI nDesde = 4;  nDeduccionC = nDeduccionC + #8#13;  |FINSI;
                   |SI nDesde ] 5;  nDeduccionC = nDeduccionC + #8#15;  |FINSI;
             |SIGUE;
         |FINSI;

         |HAZ GrabaLinea;

         |SI nHijosDed2 ! 0;  nSwMensa = 1;  |FINSI;
     |FINSI;

     |SI nEdadMayor > 0;
         nTipo       = 833;  |HAZ LeeCasillaComunidad;
         nNumero     = nEdadMayor;
         nInversion  = 0;
         nDeduccion  = nNumero * #8#11;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nMinusD > 0;
         nTipo       = 833;  |HAZ LeeCasillaComunidad;
         nNumero     = nMinusD;
         nDeduccion  = nNumero * #8#9;
         nInversion  = 0;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO Cantabria;
     aEdad = "1936";
     |HAZ LeeFamiliar;

     nNumero = nAscendN + nAscend65 + nHijosTres + nHijos65;

     |SI nNumero ! 0;
         nTipo       = 836;  |HAZ LeeCasillaComunidad;
         nInversion  = 0;
         nDeduccion  = nNumero * #8#9;
         nDeduccionC = 0;
         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO CastillaMancha;
     aEdad = "1931";
     |HAZ LeeFamiliar;

     |SI nHijosEje ! 0;
         nNumero     = nHijosEje;
         nTipo       = 840;  |HAZ LeeCasillaComunidad;
         nDeduccion  = nNumero * (#8#9 * 2);
         nInversion  = 0;
         nDeduccionC = nHijosDed3 * #8#9;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nMinusD65 ! 0;
         nTipo       = 841;  |HAZ LeeCasillaComunidad;
         nNumero     = 1;
         nInversion  = 0;
         nDeduccion  = #8#9;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     nNumero = nAscend65Prop + nHijos65Prop;
     |SI nNumero ! 0;
         nTipo       = 842;  |HAZ LeeCasillaComunidad;
         nInversion  = 0;
         nDeduccion  = nNumero * (#8#9 * 2);
         nDeduccionC = 0;
         |HAZ GrabaLinea;
     |FINSI;

     nEdadMayor = nEdadMayor - nMinusD65;
     |SI nEdadMayor > 0;
         nTipo       = 843;  |HAZ LeeCasillaComunidad;
         nNumero     = nEdadMayor;
         nInversion  = 0;
         nDeduccion  = nNumero * #8#9;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nAscend70 > 0;
         nTipo       = 844;  |HAZ LeeCasillaComunidad;
         nNumero     = nAscend70;
         nInversion  = 0;
         nDeduccion  = nNumero * #8#9;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO CastillaLeon;
     aEdad = "1941";
     |HAZ LeeFamiliar;

     |SI nTotalHijos ] 3;
         nTipo       = 846;  |HAZ LeeCasillaComunidad;
         nNumero     = 0;
         |SI nTotalHijos ] 4;
             nNumero     = nTotalHijos - 3;
         |FINSI;

         nInversion  = 0;
         |SI nMinusTodos = 0;
             nDeduccion  = #8#9  + (nNumero * #8#13);
         |SINO;
             nDeduccion  = #8#11 + (nNumero * #8#13);
         |FINSI;

         nDeduccionC = 0;

         |HAZ GrabaLinea;

         |SI nHijosDed2 ! 0;  nSwMensa = 1;  |FINSI;
     |FINSI;

     |SI nHijosDed > 0;
         nPuesto = (nTotalHijos - nHijosDed) + 1;

         nTipo       = 847;  |HAZ LeeCasillaComunidad;
         nNumero     = nHijosDed;
         nInversion  = 0;
         nDeduccion  = 0;
         |PARA nDesde = nPuesto;  |SI nDesde [ nTotalHijos;  |HACIENDO nDesde = nDesde + 1;
               |SI nDesde = 1;  nDeduccion = nDeduccion + #8#9;   |FINSI;
               |SI nDesde = 2;  nDeduccion = nDeduccion + #8#11;  |FINSI;
               |SI nDesde ] 3;  nDeduccion = nDeduccion + #8#13;  |FINSI;
         |SIGUE;
         nDeduccionC = 0;

         |SI nHijosDed3 > 0;
             nPuesto     = (nTotalHijos - nHijosDed3) + 1;
             nDeduccionC = 0;
             |PARA nDesde = nPuesto;  |SI nDesde [ nTotalHijos;  |HACIENDO nDesde = nDesde + 1;
                   |SI nDesde = 1;  nDeduccionC = nDeduccionC + #8#9;   |FINSI;
                   |SI nDesde = 2;  nDeduccionC = nDeduccionC + #8#11;  |FINSI;
                   |SI nDesde ] 3;  nDeduccionC = nDeduccionC + #8#13;  |FINSI;
             |SIGUE;
         |FINSI;

         |HAZ GrabaLinea;

         |SI nHijosDed2 ! 0;  nSwMensa = 1;  |FINSI;
     |FINSI;

     |SI nHijosAdop > 0;
         nNumero     = nHijosAdop;
         nTipo       = 848;  |HAZ LeeCasillaComunidad;
         nDeduccion  = nNumero * #8#9;
         nDeduccionC = 0;
         nInversion  = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nEdadMayor > 0; |Y nMinusD65 > 0;  |Y aAyuda = "S";
         nTipo       = 850;  |HAZ LeeCasillaComunidad;
         nNumero     = 1;
         nInversion  = 0;
         nDeduccion  = #8#9;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO Catalunya;
     |HAZ LeeFamiliar;

     |SI nHijosDed ! 0;
         nNumero     = nHijosDed;
         nTipo       = 856;  |HAZ LeeCasillaComunidad;
         nDeduccion  = nNumero * #8#9;
         nInversion  = 0;
         ||nDeduccionC = nHijosDed3 * #8#9;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO Extremadura;
     nCantidad = 0;
     nPorce    = 100;
     |BUCLE rem00021;
     |SI nCantidad ! 0;  |Y aEdadPer ] "1971";
         nTipo       = 862;  |HAZ LeeCasillaComunidad;
         nNumero     = 0;
         nInversion  = nCantidad % nPorce;
         |SI nInversion > #8#9;
             nInversion = #8#9;
         |FINSI;

         nDeduccion  = nInversion % 3;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     nNumero = nAscend65 + nHijos65;

     |SI nNumero ! 0;
         nTipo       = 867;  |HAZ LeeCasillaComunidad;
         nInversion  = 0;
         nDeduccion  = nNumero * #8#9;
         nDeduccionC = 0;
         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO Galicia;
     |HAZ LeeFamiliar;

     |SI nHijosEje > 0;
         nTipo       = 869;  |HAZ LeeCasillaComunidad;
         nNumero     = nHijosEje;
         nInversion  = 0;
         |SI nHijosMult = 0;
             nDeduccion  = nHijosEje * 300;
         |SINO;
             nDeduccion  = nHijosEje * 360;
         |FINSI;

/*
         |SI nHijosMult3 = 0;
             nDeduccionC = nHijosDed3 * (300 / 2);
         |SINO;
             nDeduccionC = nHijosDed3 * (360 / 2);
         |FINSI;
*/

         |HAZ GrabaLinea;

         |SI nHijosDed2 ! 0;  nSwMensa = 1;  |FINSI;
     |FINSI;

     |SI nHijos2004 > 0;
         nTipo       = 669;  |HAZ LeeCasillaComunidad;
         nNumero     = nHijos2004;
         nInversion  = 0;
         nDeduccion  = nHijos2004 * #8#13;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nHijos2005 > 0;
         nTipo       = 769;  |HAZ LeeCasillaComunidad;
         nNumero     = nHijos2005;
         nInversion  = 0;
         nDeduccion  = nHijos2005 * #8#13;

         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO Madrid;
     |HAZ LeeFamiliar;

     |SI nHijosDed > 0;
         nTipo       = 875;  |HAZ LeeCasillaComunidad;
         nNumero     = nHijosDed;
         nInversion  = 0;
         nDeduccion  = 0;

         |SI nNumero = 1;  nDeduccion = #8#9;             |FINSI;
         |SI nNumero = 2;  nDeduccion = #8#9 + #8#11;     |FINSI;
         |SI nNumero ] 3;
             nDeduccion = (#8#9 + #8#11) + ((nNumero - 2) * #8#13);
         |FINSI;

         nDeduccionC = 0;
         |SI nHijosDed3 = 1;  nDeduccionC = #8#9;         |FINSI;
         |SI nHijosDed3 = 2;  nDeduccionC = #8#9 + #8#11; |FINSI;
         |SI nHijosDed3 ] 3;
             nDeduccionC = (#8#9 + #8#11) + ((nHijosDed3 - 2) * #8#13);
         |FINSI;

         |HAZ GrabaLinea;

         |SI nHijosDed2 ! 0;  nSwMensa = 1;  |FINSI;
     |FINSI;

     |SI nHijosAdop ! 0;
         nTipo       = 876;  |HAZ LeeCasillaComunidad;
         nNumero     = nHijosAdop;
         nInversion  = 0;
         nDeduccion  = (nHijosAdop  * #8#9);
         nDeduccionC = (nHijosAdop3 * #8#9);

         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO Murcia;
     |HAZ LeeFamiliar;

     nCantidad = 0;
     nPorce    = 100;
     |BUCLE rem00021;
     |SI nCantidad ! 0;  |Y aEdadPer ] "1971";
         nTipo       = 882;  |HAZ LeeCasillaComunidad;

         nNumero     = 0;
         nInversion  = nCantidad % nPorce;
         nDeduccion  = nInversion % 3;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO LaRioja;
     |HAZ LeeFamiliar;

     |SI nTotalHijos [ 1;  |ACABA;  |FINSI;

     |SI nHijosDed = nTotalHijos;
         nHijosDed = nHijosDed - 1;
     |FINSI;

     |SI nHijosDed [ 0;  |ACABA;  |FINSI;

     nTipo       = 886;  |HAZ LeeCasillaComunidad;
     nNumero     = nHijosDed;
     nInversion  = 0;
     nDeduccion  = 0;
     |SI nNumero = 1;  nDeduccion = #8#9;   |FINSI;
     |SI nNumero ] 2;
         nDeduccion = #8#9 + ((nNumero - 1) * #8#11);
     |FINSI;

     nDeduccionC = 0;
     |SI nHijosDed3 = 1;  nDeduccionC = #8#9;   |FINSI;
     |SI nHijosDed3 ] 2;
         nDeduccionC = #8#9 + ((nHijosDed3 - 1) * #8#11);
     |FINSI;

     |HAZ GrabaLinea;

     |SI nHijosDed2 ! 0;  nSwMensa = 1;  |FINSI;
|FPRC;

|PROCESO Valencia;
     aEdad = "1941";
     |HAZ LeeFamiliar;

     |SI nHijosEje ! 0;
         nNumero     = nHijosEje;
         nTipo       = 890;  |HAZ LeeCasillaComunidad;
         nDeduccion  = nNumero * (#8#9 * 2);
         nInversion  = 0;
         nDeduccionC = nHijosDed3 * #8#9;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nHijos2004 ! 0;  |O nHijos2005 ! 0;
         nNumero     = nHijos2004 + nHijos2005;
         nTipo       = 909;  |HAZ LeeCasillaComunidad;
         nDeduccion  = nNumero * (#8#9 * 2);
         nInversion  = 0;
         nDeduccionC = nHijosTresA3 * #8#9;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nHijosMult ! 0;
         nNumero     = 1;
         nTipo       = 891;   |HAZ LeeCasillaComunidad;
         nDeduccion  = #8#9;
         nInversion  = 0;
         nDeduccionC = 0;
         |HAZ GrabaLinea;
     |FINSI;

     |SI nHijosDedM ! 0;
         nNumero     = nHijosDedM;
         nTipo       = 892;  |HAZ LeeCasillaComunidad;
         nDeduccion  = #8#9;
         |SI nHijosDedM1 > 1;
             nDeduccion  = nDeduccion + ((nNumero - 1) * #8#11);
         |FINSI;
         nInversion  = 0;
         nDeduccionC = 0;

         |SI nHijosDedM2 ! 0;
             nDeduccionC = #8#9;
             |SI nHijosDedM3 ! 0;
                 nDeduccionC = nDeduccionC + ((nHijosDedM2 - 1) * #8#11);
             |FINSI;
         |FINSI;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nEdadMayor > 0; |Y nMinusD > 0;
         nTipo       = 894;  |HAZ LeeCasillaComunidad;
         nNumero     = nEdadMayor;
         nInversion  = 0;
         nDeduccion  = nNumero * #8#9;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     nCantidad = 0;
     nPorce    = 100;
     |BUCLE rem00021;
     |SI nCantidad ! 0;  |Y aEdadPer ] "1971";
         nTipo       = 897;  |HAZ LeeCasillaComunidad;
         nNumero     = 0;
         nInversion  = nCantidad % nPorce;
         nDeduccion  = nInversion % 3;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nCantidad ! 0;  |Y nGradoMinus ] 65;
         nTipo       = 898;  |HAZ LeeCasillaComunidad;
         nNumero     = 0;
         nInversion  = nCantidad % nPorce;
         nDeduccion  = nInversion % 3;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO Automatico;
     #20#0 = enEmpresa;
     #20#1 = 1;
     |LEE 040#20];
     |SI FSalida = 0;  |Y #20#0 = enEmpresa;
         |MENAV "      Ya existen deducciones en esta empresa, debe estar sin deducciones.";
         |ERROR;
         |ACABA;
     |FINSI;

     nLinea = 0;

     #20#0 = enEmpresa;

     |ABRE #1;
     |LEE 040#1p;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |ABRE #100;
     #100#0 = enEmpresa;
     |LEE 040#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;
     |CIERRA #100;

     |ABRE #8;

     aPerceptor  = "TITULAR";
     nComunidad  = #100#11;
     aEdadPer    = #100#7;
     nGradoMinus = #100#8;
     nSwMensa    = 0;
     nAndalucia  = 0;

     |SI #100#11 = 1;   |HAZ Andalucia;         |FINSI;
     |SI #100#11 = 2;   |HAZ Aragon;            |FINSI;
     |SI #100#11 = 3;   |HAZ Asturias;          |FINSI;
     |SI #100#11 = 4;   |HAZ Baleares;          |FINSI;
     |SI #100#11 = 5;   |HAZ Canarias;          |FINSI;
     |SI #100#11 = 6;   |HAZ Cantabria;         |FINSI;
     |SI #100#11 = 7;   |HAZ CastillaMancha;    |FINSI;
     |SI #100#11 = 8;   |HAZ CastillaLeon;      |FINSI;
     |SI #100#11 = 9;   |HAZ Catalunya;         |FINSI;
     |SI #100#11 = 10;  |HAZ Extremadura;       |FINSI;
     |SI #100#11 = 11;  |HAZ Galicia;           |FINSI;
     |SI #100#11 = 12;  |HAZ Madrid;            |FINSI;
     |SI #100#11 = 13;  |HAZ Murcia;            |FINSI;
     |SI #100#11 = 16;  |HAZ LaRioja;           |FINSI;
     |SI #100#11 = 17;  |HAZ Valencia;          |FINSI;

     aPerceptor  = "CONYUGE";
     nComunidad  = #100#43;
     aEdadPer    = #100#40;
     nGradoMinus = #100#41;
     aAlfa       = #100#35;  |QBF aAlfa;
     nAndalucia  = 0;

     |SI aAlfa ! "";
         |SI #100#43 = 1;   |HAZ Andalucia;         |FINSI;
         |SI #100#43 = 2;   |HAZ Aragon;            |FINSI;
         |SI #100#43 = 3;   |HAZ Asturias;          |FINSI;
         |SI #100#43 = 4;   |HAZ Baleares;          |FINSI;
         |SI #100#11 = 5;   |HAZ Canarias;          |FINSI;
         |SI #100#11 = 6;   |HAZ Cantabria;         |FINSI;
         |SI #100#11 = 7;   |HAZ CastillaMancha;    |FINSI;
         |SI #100#43 = 8;   |HAZ CastillaLeon;      |FINSI;
         |SI #100#43 = 9;   |HAZ Catalunya;         |FINSI;
         |SI #100#43 = 10;  |HAZ Extremadura;       |FINSI;
         |SI #100#43 = 11;  |HAZ Galicia;           |FINSI;
         |SI #100#43 = 12;  |HAZ Madrid;            |FINSI;
         |SI #100#43 = 13;  |HAZ Murcia;            |FINSI;
         |SI #100#43 = 16;  |HAZ LaRioja;           |FINSI;
         |SI #100#43 = 17;  |HAZ Valencia;          |FINSI;
     |FINSI;

     |CIERRA #8;

     |SI nSwMensa = 1;
         |MENAV "     Revise Deduccion de Hijos ya que tiene vinculaciones al Declarante o al Conyuge";
     |FINSI;

     |ERROR;
     |PTEC 802;
     |PTEC 807;
|FPRC;

|RUTINA ClaveBaja8_2;
     #8#0  = #20#11;
     #8#1  = 600;
     #8#22 = "S";
|FRUT;

|RUTINA ClaveAlta8_2;
     #8#0  = #20#11;
     #8#1  = 909;
     #8#22 = "S";
|FRUT;

|PROCESO Tipo11m20;  |TIPO 11;
     |SI FSalida = 10;
         |HAZ Automatico;
     |FINSI;

     |SI FSalida = 11;
         |SI #20#2 ! "VARIOS    ";  |ACABA;  |FINSI;

         #900#0 = #20#5;
         #900#1 = #20#6;
         #900#2 = #20#7;
         #900#3 = #20#8;
         #900#4 = #20#9;
         #900#5 = #20#10;

         |PUSHV 0501 2380;
         |PINPA #0#900;
         |PINDA #0#900;
         |LEETECLA aTecla;
         |POPV;
         |ERROR;
     |FINSI;

     |SI FSalida = 12;
         eaDeclarante = "TITULAR";
         enComunes    = 1;
         enSwPresenta = 1;
         |HAZ SacaDeclarantes;
         enSwPresenta = 0;

         #20#11 = enAutonomia;

         |ABRE #8;
         |SELECT #2#8;
         #8#0  = #20#11;
         #8#22 = "S";
         #8#1  = 1;
         |LEE 000#8];
         |SI #8#0 ! #20#11;  |O  #8#22 ! "S";  |O FSalida ! 0;
             |MENAV "0000 No hay deducciones automaticas en esta Comunidad";
             |CIERRA #8;
             |ERROR;
             |ACABA;
         |FINSI;
         |CIERRA #8;

         |ABRE #7;
         #7#0 = #20#11;
         |LEE 000#7=;
         |SI FSalida ! 0;  |DDEFECTO #7;  |FINSI;
         |CIERRA #7;

         |PUSHV 0501 2380;
         |PINPA #0#7;
         |PINTA #7#0;
         |PINTA #7#1;
         |ENTLINEAL #2#8, 3, 4, 22, 0, ClaveBaja8_2, ClaveAlta8_2;
         |POPV;

         |ERROR;
     |FINSI;
|FPRC;

|RUTINA ClaveBaja8;
     |SI FSalida = "POSICION";  |Y #20#13 ! 999;
         #8#1 = #20#13;
         |ACABA;
     |FINSI;
     #8#0 = #20#11;
     #8#1 = 600;
|FRUT;

|RUTINA ClaveAlta8;
     #8#0 = #20#11;
     #8#1 = 909;
|FRUT;

|PROCESO LetraNif;  |TIPO 6;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     eaVarDni = #20Campo;
     |HAZ CalculoDNI;
     #20Campo = eaVarDni;
     |PINTA #20Campo;
     |ERROR;
|FPRC;

|PROCESO Consulta;
     |SI FSalida = 10;
         |PUSHV 0501 2380;
         |PINPA #0#7;
         |PINDA #0#7;
         |ENTLINEAL #1#8, 2, 4, 22, 0, ClaveBaja8, ClaveAlta8;
         #20#13 = #8#1;
         |POPV;
     |FINSI;

     |ABRE #8;
     #8#0 = #20#11;
     #8#1 = #20#13;
     |LEE 040#8=;
     |SI FSalida ! 0;
         |MENAV "    No existe Deduccion.";
         |CIERRA #8;
         |ERROR;
         |ACABA;
     |FINSI;
     |CIERRA #8;

     |SI #20#13 = 804;  |O #20#13 = 805;
         |SI #20#2 = "GANANCIAL ";  |O #20#2 = "VARIOS    ";
             |MENAV "0000 Solo Rentas Individuales.";
             |ERROR;
             |ACABA;
         |FINSI;

         |SI #20#13 = 805;
             |ABRE #999;
             |SELECT #2#999;
             #999#1 = #20#2;
             |LEE 000#999=;
             |SI FSalida ! 0;  |DDEFECTO #999;  |FINSI;
             |CIERRA #999;

             |SI #999#9 = "V";
                 |MENAV "0000 Solo sexo Mujer.";
                 |ERROR;
                 |ACABA;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #20#13 = 804;  |O #20#13 = 897;
         |SI #20#2 = "TITULAR   ";
             |SI aEdadTit < "1971";
                 |MENAV "0000 El Titular tiene mas de 35 a¤os";
                 |ERROR;
             |FINSI;
         |FINSI;

         |SI #20#2 = "CONYUGE   ";
             |SI aEdadCon < "1971";
                 |MENAV "0000 El Conyuge tiene mas de 35 a¤os";
                 |ERROR;
             |FINSI;
         |FINSI;

         |SI #20#2 = "GANANCIAL ";
             |SI aEdadTit < "1971";  |O aEdadCon < "1971";
                 |MENAV "0000 Uno de los contribuyentes tienen mas de 35 a¤os, introduzcalas individuales";
                 |ERROR;
             |FINSI;
         |FINSI;
     |FINSI;

     |C_M #20#17, 1, "S";
     |C_M #20#18, 1, "S";
     |C_M #20#19, 1, "S";
     |C_M #20#20, 1, "S";
     |C_M #20#21, 1, "S";

     |SI #8#5 = "S";
         |C_M #20#18, 1, "N";   #20#18 = 0;
         |C_M #20#20, 1, "N";   #20#20 = 0;
     |FINSI;

     |SI #8#5 = "N";
         |C_M #20#17, 1, "N";   #20#17 = 0;
         |C_M #20#18, 1, "N";   #20#17 = 0;
         |C_M #20#20, 1, "N";   #20#20 = 0;
     |FINSI;

     |SI #8#5 = "I";
         |C_M #20#17, 1, "N";   #20#17 = 0;
         #20#20 = #8#6;
         |SI #20#20 = 0;
             |C_M #20#20, 1, "N";  #20#20 = 0;
             |C_M #20#19, 1, "N";  #20#19 = 0;
         |FINSI;
     |FINSI;

     |SI #20#13 ! 803;  |Y #20#13 ! 816;  |Y #20#13 ! 823;  |Y #20#13 ! 835;
      |Y #20#13 ! 854;  |Y #20#13 ! 858;  |Y #20#13 ! 866;  |Y #20#13 ! 874;
      |Y #20#13 ! 879;  |Y #20#13 ! 900;  |Y #20#13 ! 901;
         |C_M #20#21, 1, "N";  #20#21 = "";
     |FINSI;

     #20#14 = #8#2;
     #20#15 = #8#3;
     #20#16 = #8#4;

     |PINTA #20#13;
     |PINTA #20#14;
     |PINTA #20#15;
     |PINTA #20#16;
     |PINTA #20#17;
     |PINTA #20#18;
     |PINTA #20#19;
     |PINTA #20#20;
     |PINTA #20#21;
|FPRC;

|PROCESO Tipo0C19;
     |SI #20#13 = 871;  |O #20#13 = 839;
         |SI #8#7 ! 0;
             |SI #20#19 > nTope;
                 #20#19 = nTope;   |PINTA #20#19;
             |FINSI;
        |FINSI;
     |FINSI;
|FPRC;

|PROCESO Totalm020;
     nTope = #8#7;

     |SI #20#2 = "GANANCIAL ";
         |SI #20#13 = 803;  nTope = nTope * 2;  |FINSI;
         |SI #20#13 = 816;  nTope = nTope * 2;  |FINSI;
         |SI #20#13 = 823;  nTope = nTope * 2;  |FINSI;
         |SI #20#13 = 834;  nTope = nTope * 2;  |FINSI;
         |SI #20#13 = 835;  nTope = nTope * 2;  |FINSI;
         |SI #20#13 = 849;  nTope = nTope * 2;  |FINSI;
         |SI #20#13 = 858;  nTope = nTope * 2;  |FINSI;
         |SI #20#13 = 866;  nTope = nTope * 2;  |FINSI;
         |SI #20#13 = 878;  nTope = nTope * 2;  |FINSI;
         |SI #20#13 = 882;  nTope = nTope * 2;  |FINSI;
         |SI #20#13 = 884;  nTope = nTope * 2;  |FINSI;
         |SI #20#13 = 885;  nTope = nTope * 2;  |FINSI;
         |SI #20#13 = 888;  nTope = nTope * 2;  |FINSI;
         |SI #20#13 = 900;  nTope = nTope * 2;  |FINSI;
         |SI #20#13 = 901;  nTope = nTope * 2;  |FINSI;
         |SI #20#13 = 908;  nTope = nTope * 2;  |FINSI;
     |FINSI;

     |SI #20#20 ! 0;
         #20#19 = #20#18 % #20#20;
         |SI #8#7 ! 0;
             |SI #20#19 > nTope;
                 #20#19 = nTope;
             |FINSI;
        |FINSI;
     |FINSI;
     |PINTA #20#19;
|FPRC;

|PROCESO Varios;  |TIPO 0;
     |SI #20#2 ! "VARIOS    ";
         #20#5  = 0;
         #20#6  = 0;
         #20#7  = 0;
         #20#8  = 0;
         #20#9  = 0;
         #20#10 = 0;
         |ACABA;
     |FINSI;

     |C_M #900#0,  1, "N";
     |C_M #900#1,  1, "N";
     |C_M #900#2,  1, "N";
     |C_M #900#3,  1, "N";
     |C_M #900#4,  1, "N";
     |C_M #900#5,  1, "N";

     aAlfa = eaSwVarios;
     aLong = aAlfa % 0;
     nLong = aLong;
     |PARA nCaracter = 1;  |SI nCaracter [ nLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPosi = (100 * nCaracter) + 1;
           aAlfa1 = aAlfa % nPosi;
           |SI aAlfa1 = "T";  |C_M #900#0,  1, "S";  |FINSI;
           |SI aAlfa1 = "C";  |C_M #900#1,  1, "S";  |FINSI;
           |SI aAlfa1 = "1";  |C_M #900#2,  1, "S";  |FINSI;
           |SI aAlfa1 = "2";  |C_M #900#3,  1, "S";  |FINSI;
           |SI aAlfa1 = "3";  |C_M #900#4,  1, "S";  |FINSI;
           |SI aAlfa1 = "4";  |C_M #900#5,  1, "S";  |FINSI;
     |SIGUE;

     #900#0 = #20#5;
     #900#1 = #20#6;
     #900#2 = #20#7;
     #900#3 = #20#8;
     #900#4 = #20#9;
     #900#5 = #20#10;

     |PUSHV 0501 2380;

     |PINPA #0#900;
     |PINDA #0#900;
     |ENDATOS #1#900;
     |SI FSalida = 0;
         #20#5  = #900#0;
         #20#6  = #900#1;
         #20#7  = #900#2;
         #20#8  = #900#3;
         #20#9  = #900#4;
         #20#10 = #900#5;
     |FINSI;

     |POPV;
|FPRC;

|RUTINA ClaveBaja20;
     #20#0 = enEmpresa;
     #20#1 = 1;
|FRUT;

|RUTINA ClaveAlta20;
     #20#0 = enEmpresa;
     #20#1 = 99;
|FRUT;

|PROCESO PonDeclarante;  |TIPO 7;
     eaDeclarante = #20#2;
     enComunes    = 1;
     |HAZ SacaDeclarantes;
     #20#2  = eaDeclarante;
     #20#11 = enAutonomia;
     |PINTA #20#2;

     |ABRE #8;
     #8#0 = #20#11;
     #8#1 = 1;
     |LEE 040#8];
     |SI FSalida ! 0;
         |CIERRA #8;
         |MENAV "     No existe Autonomia en el Declarante.";
         |PTEC 807;
         |ACABA;
     |FINSI;
     |SI #8#1 = 99;
         |CIERRA #8;
         |MENAV "     No hay deducciones Autonomicas en la Comunidad";
         |PTEC 807;
         |ACABA;
     |FINSI;
     |CIERRA #8;

     |ABRE #7;
     #7#0 = #20#11;
     |LEE 040#7=;
     |SI FSalida ! 0;  |DDEFECTO #7;  |FINSI;
     |CIERRA #7;

     #20#12 = #7#1;

     |PINTA #20#11;
     |PINTA #20#12;
|FPRC;

|PROCESO Fallece;  |TIPO 7;
     |SI eaFallece = "S";
         |C_M #20#4, 1, "S";
     |SINO;
         |C_M #20#4, 1, "N";  #20#4 = 0;  |PINTA #20#4;
     |FINSI;
|FPRC;

|PROCESO Tipo2m20;  |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;  |O nModo = 3;
         enSwRetorno  = 1;
         |ACABA;
     |FINSI;

     nEntrada = 0 +. 1;
     |SI nEntrada ! 1;
         |PARA nCampo = 0;  |SI nCampo [ nNumCampos;  |HACIENDO nCampo = nCampo + 1;
               #99nCampo = #20nCampo;
         |SIGUE;
     |SINO;
         |PARA nCampo = 0;  |SI nCampo [ nNumCampos;  |HACIENDO nCampo = nCampo + 1;
               |SI #99nCampo ! #20nCampo;
                   enSwRetorno  = 1;
               |FINSI;
         |SIGUE;
     |FINSI;
|FPRC;

|PROGRAMA;
     |ABRE #100;
     #100#0 = enEmpresa;
     |LEE 040#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;
     |CIERRA #100;

     aEdadTit = #100#7;
     aEdadCon = #100#40;

     aQueQuiero = "|NP";
     aNumPanta  = #20#aQueQuiero#;
     nNumPanta  = aNumPanta;
     nNumPanta  = nNumPanta - 1;

     aQueQuiero = "|NC";
     aNumCampos = #20#aQueQuiero#;
     nNumCampos = aNumCampos;
     nNumCampos = nNumCampos - 1;

     |DBASE aPathRenta;  |QBT aPathRenta;
     aDef = aPathRenta + "def/rem00044.mas";
     |CARGA_DEF aDef, espejo@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00044.mas";
         |MENAV aAlfa;
         |ERROR;
     |FINSI;

     |ENTLINEAL #1#20, -2, enModo, 22, 1, ClaveBaja20, ClaveAlta20;

     |DESCARGA_DEF #espejo@;

     eaPrograma   = "rem00044";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRO;
