|FICHEROS;
     rezcap99 #0;
     repobibi #1;
     rem02000 #2;
     retabla1 #401;
     aficahor1@ #1001;
     aficahor2@ #1002;
     aficante1@ #991;
     aficante2@ #992;
     aficante3@ #993;
     aficante4@ #994;
     aficante5@ #995;
     rem00039 #39;
     rem00042 #42;
     rem00060 #60;
|FIN;

|VARIABLES;
     aAlfa          = "";
     aAlfa1         = "";
     aAlfa2         = "";
     aDef           = "";
     aFichero       = "";
     aBaseRenta2006 = "";
     aFich          = "";
     aContri        = "";

     nCampo         = 0;
     nCampoPase     = 0;
     nSuma          = 0;
     nSuma1         = 0;
     nAcciones      = 0;
     nAgru          = 0;
     nCasi          = 0;
     nImporte       = 0;
     nImpo          = 0;
     nCompara       = 0;
     nPatrones      = 0;
     nDEjer         = 0;
     nHEjer         = 0;
     nTipo          = 0;
     nQueHago       = 0;
     nAnyo          = 0;
     nLinea         = 0;
     nDobleImpo     = 0;
     nDias          = 0;
     nEmpresa       = 0;
     nPendiente     = 0;

     &enCodCli      = 0;
     &enEmpresa     = 0;
     &eaPrograma    = "";
     &eaPunto       = "";
     &eaLetra       = "";
|FIN;

|PROCESO Directorios; |TIPO 7;
     |DBASS aAlfa;
     #0#0 = aAlfa + "ren2005";
     #0#1 = "fich";
     |PINTA #0#0;
     |PINTA #0#1;
|FPRC;

|PROCESO Parrilla;
     |SI enCodCli ! 0;  |ACABA;  |FINSI;

     |SI #0#2 = 0;
         #0#2 = 0;  |PINTA #0#2;
         #0#3 = 0;  |PINTA #0#3;  |C_M #0#3, 1, "N";
         |PARA nCampo = 4;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |SINO;
         |C_M #0#2, 1, "S";
         |C_M #0#3, 1, "S";
         |PARA nCampo = 4;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
               #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasContri;
     |SI enCodCli ! 0;  |ACABA;  |FINSI;

     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               #0Campo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO ModInmuebles;
     |C_M #0#29, 1, "S";
     |C_M #0#30, 1, "S";
     |C_M #0#32, 1, "S";
     |SI #0#25 = "N";  |O #0#32 = "N";
         |C_M #0#29, 1, "N";  #0#29 = "N";  |PINTA #0#29;
         |C_M #0#30, 1, "N";  #0#30 = "N";  |PINTA #0#30;
         |SI #0#25 = "N";
             |C_M #0#32, 1, "N";  #0#32 = "N";  |PINTA #0#32;
         |FINSI;
     |FINSI;

     |C_M #0#31, 1, "S";
     |SI #0#30 = "N";
         |C_M #0#31, 1, "N";  #0#31 = 0;    |PINTA #0#31;
     |FINSI;
|FPRC;

|PROCESO ModMobiliario;
     |C_M #0#33, 1, "S";
     |SI #0#26 = "N";
         |C_M #0#33, 1, "N";  #0#33 = "N";  |PINTA #0#33;
     |FINSI;
|FPRC;

|PROCESO ModPatrimonio;
     |C_M #0#34, 1, "S";
     |SI #0#28 = "N";
         |C_M #0#34, 1, "N";  #0#34 = "N";  |PINTA #0#34;
     |FINSI;
|FPRC;

||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| COPIA FICHEROS
||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO CopiaFichero;
     aAlfa1 = #0#0 + "/" + #0#1 + "/"  + aFichero + ".dat";  |QBT aAlfa1;
     aAlfa2 = aBaseRenta2006 + "fich/" + aFichero + ".dat";
     |COPIA_FICHERO aAlfa1, aAlfa2;

     aAlfa1 = #0#0 + "/" + #0#1 + "/"  + aFichero + ".ddx";  |QBT aAlfa1;
     aAlfa2 = aBaseRenta2006 + "fich/" + aFichero + ".ddx";
     |COPIA_FICHERO aAlfa1, aAlfa2;

     aAlfa1 = #0#0 + "/" + #0#1 + "/"  + aFichero + ".ixx";  |QBT aAlfa1;
     aAlfa2 = aBaseRenta2006 + "fich/" + aFichero + ".ixx";
     |COPIA_FICHERO aAlfa1, aAlfa2;
|FPRC;

|PROCESO Auxiliares;
     aDef = aBaseRenta2006 + "def/" + aFichero + ".mas";
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aFichero + " A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |ABRE #1001;
     |LEE 040#1001p;
     |SI FSalida ! 0;
         |CIERRA #1001;
         |HAZ CopiaFichero;
     |FINSI;
     |CIERRA #1001;
     |DESCARGA_DEF #aficahor1@;
|FPRC;

||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| TRAERSE RENTA
||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO Pasa101;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida ! 0;
         |DDEFECTO #1001;
         #1001#0 = #992#0;
         #1001#1 = #992#1;
         |GRABA 020#1001b;
     |FINSI;

     |PARA nCampoPase = 0;  |SI nCampoPase [ 22;  |HACIENDO nCampoPase = nCampoPase + 1;
           #1001nCampoPase = #992nCampoPase;
     |SIGUE;

     |GRABA 020#1001a;
     |LIBERA #1001;
|FPRC;

|DEFBUCLE rem00101_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa101;
|FIN;

|PROCESO Pasa102;
     #993#0  = #992#0;
     #993#1  = #992#12;
     |LEE 000#993=;
     |SI FSalida = 0;
         |SI #993#24 = "S";  |ACABA;  |FINSI;
     |FINSI;

     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida ! 0;
         |DDEFECTO #1001;
         #1001#0 = #992#0;
         #1001#1 = #992#1;
         |GRABA 020#1001b;
     |FINSI;

     |PARA nCampoPase = 0;  |SI nCampoPase [ 14;  |HACIENDO nCampoPase = nCampoPase + 1;
           #1001nCampoPase = #992nCampoPase;
     |SIGUE;

     |GRABA 020#1001a;
     |LIBERA #1001;
|FPRC;

|DEFBUCLE rem00102_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa102;
|FIN;

|PROCESO DatosPersonales;
     aDef = #0#0 + "/def/rem00100.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00100 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #992;
     #992#0 = #991#0;
     |LEE 040#992=;
     |SI FSalida = 0;
         aDef = aBaseRenta2006 + "/def/rem00100.mas";  |QBT aDef;
         |CARGA_DEF aDef, aficahor1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def rem00100 A쨚 2006 ";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |ABRE #1001;
         #1001#0 = #992#0;
         |LEE 101#1001=;
         |SI FSalida ! 0;
             |DDEFECTO #1001;
             |PARA nCampoPase = 0;  |SI nCampoPase [ 111;  |HACIENDO nCampoPase = nCampoPase + 1;
                   #1001nCampoPase = #992nCampoPase;
             |SIGUE;
             |GRABA 020#1001b;
         |FINSI;

         |SI #1001#6 = "C";
             #1001#128 = #1001#111;
         |FINSI;
         |GRABA 020#1001a;
         |LIBERA #1001;
         |CIERRA #1001;

         |DESCARGA_DEF #aficahor1@;
     |FINSI;
     |CIERRA #992;

     |DESCARGA_DEF #aficante2@;

     aDef = #0#0 + "/def/rem00101.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00101 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00101.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00101 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00101_2005;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;

     eaPrograma = "rem00100";
     eaPunto    = "";
     |HAZ ProgramaActivo;

     aDef = #0#0 + "/def/rem00102.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00102 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem00021.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00021 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00102.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00101 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;
     |PATH_DAT #993 aFich;

     |ABRE #1001;
     |ABRE #993;
     |BUCLE rem00102_2005;
     |CIERRA #1001;
     |CIERRA #993;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante3@;
     |DESCARGA_DEF #aficante2@;

     eaPrograma = "rem00102";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO Pasa020;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida ! 0;
         |DDEFECTO #1001;
         #1001#0 = #992#0;
         #1001#1 = #992#1;
         |GRABA 020#1001b;
     |FINSI;

     #1001#2  = #992#2;
     #1001#3  = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4  = 0;
     #1001#5  = #992#5;
     #1001#8  = #992#8;
     #1001#13 = #992#13;
     #1001#17 = #992#17;
     #1001#27 = #992#27;
     #1001#29 = #992#29;
     #1001#30 = #992#30;

     |GRABA 020#1001a;
     |LIBERA #1001;
|FPRC;

|DEFBUCLE rem00020_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa020;
|FIN;

|PROCESO Pasa019;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida ! 0;
         |DDEFECTO #1001;
         #1001#0 = #992#0;
         #1001#1 = #992#1;
         |GRABA 020#1001b;
     |FINSI;

     #1001#2  = #992#2;
     #1001#3  = #992#3;
     #1001#4  = #992#4;
     |GRABA 020#1001a;
     |LIBERA #1001;
|FPRC;

|DEFBUCLE rem00019_2005;
     #992#1002;
     ;
     #991#0, "          ";
     #991#0, "zzzzzzzzzz";
     ;
     NULL, Pasa019;
|FIN;

|PROCESO Trabajo;
     aDef = #0#0 + "/def/rem00020.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00020 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00020.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00020 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00020_2005;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;

     eaPrograma = "rem00020";
     eaPunto    = "";
     |HAZ ProgramaActivo;

     aDef = #0#0 + "/def/rem00019.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00019 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00019.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00019 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00019_2005;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO El39;
     |ABRE #39;
     |SELECT #1#39;
     #39#0 = #992#0;
     #39#1 = 99;
     |LEE 040#39];
     |SI FSalida = 0;
         |LEE 040#39a;
     |SINO;
         |LEE 040#39u;
     |FINSI;

     |SI FSalida = 0; |Y #39#0 = #992#0;
         nLinea = #39#1 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     #39#0   = #992#0;
     #39#1   = nLinea;
     #39#2   = #992#2;
                       #39#3   = "X";
     |SI #0#37 = "N";  #39#3 = #992#3;  |FINSI;

     #39#4   = 0;
     #39#5   = #992#5;
     #39#6   = #992#6;
     #39#7   = #992#7;
     #39#8   = #992#8;
     #39#9   = #992#9;
     #39#10  = #992#10;
     #39#14  = #992#68;
     #39#15  = #992#13;
     #39#16  = #992#69;
     #39#17  = #992#75;
     #39#18  = #992#75 - #992#76;
     #39#19  = #992#108;
     #39#20  = 0;
     #39#13  = 0;
     #39#21  = 1;
     #39#22  = "T";
     |GRABA 020#39n;
     |LIBERA #39;
|FPRC;

|PROCESO El42;
     |ABRE #42;
     |SELECT #1#42;
     #42#0 = #992#0;
     #42#1 = 99;
     |LEE 040#42];
     |SI FSalida = 0;
         |LEE 040#42a;
     |SINO;
         |LEE 040#42u;
     |FINSI;

     |SI FSalida = 0; |Y #42#0 = #992#0;
         nLinea = #42#1 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     #42#0   = #992#0;
     #42#1   = nLinea;
     #42#2   = #992#2;
                       #42#3   = "X";
     |SI #0#37 = "N";  #42#3 = #992#3;  |FINSI;

     #42#4   = 0;
     #42#5   = #992#5;
     #42#6   = #992#6;
     #42#7   = #992#7;
     #42#8   = #992#8;
     #42#9   = #992#9;
     #42#10  = #992#10;
     #42#14  = #992#68;
     #42#15  = #992#13;
     #42#16  = #992#69;
     #42#17  = #992#75;
     #42#18  = #992#75 - #992#76;
     #42#19  = #992#108;
     #42#20  = 0;
     #42#13  = 0;
     #42#21  = 1;
     #42#22  = "T";
     |GRABA 020#42n;
     |LIBERA #42;
|FPRC;

|PROCESO Pasa021;
     |SI #992#24 = "S";  |Y #0#39 = "S";

         || -----------------------------------------------
         || Esto debe ser remodelado para la renta del 2007
         || -----------------------------------------------

         |SI #992#75 = 0;        |ACABA;  |FINSI;
         |SI #992#76 ] #992#75;  |ACABA;  |FINSI;

         nDias    = #992#68 - #992#25;
         |SI nDias [ 365;
             |HAZ El39;
         |SINO;
             |HAZ El42;
         |FINSI;

         |ACABA;
     |FINSI;

     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1;
     |FINSI;

     |DDEFECTO #1001;
     |SI #0#32 = "N";
         #1001#0   = #992#0;
         #1001#1   = #992#1;
         #1001#2   = #992#2;
         #1001#3   = "X";
         |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
         #1001#4   = 0;
         #1001#5   = #992#5;
         #1001#6   = #992#6;
         #1001#7   = #992#7;
         #1001#8   = #992#8;
         #1001#9   = #992#9;
         #1001#10  = #992#10;
         #1001#13  = #992#13;
         #1001#14  = #992#14;
         #1001#16  = #992#16;
         #1001#17  = #992#17;
         #1001#18  = #992#18;
         #1001#19  = #992#19;
         #1001#20  = #992#20;
         #1001#25  = #992#25;
         #1001#26  = #992#26;
         #1001#29  = #992#29;
         #1001#30  = #992#30;
         #1001#31  = #992#31;
         #1001#32  = #992#32;
         #1001#33  = #992#33;
         #1001#34  = #992#34;
         #1001#35  = #992#35;
         #1001#36  = #992#36;
         #1001#104 = #992#104;
         #1001#105 = #992#105;
         #1001#106 = #992#106;
         #1001#117 = #992#117;
         #1001#118 = #992#118;
         #1001#119 = #992#119;
         #1001#120 = #992#120;
         #1001#121 = #992#121;
         #1001#122 = #992#122;
         #1001#123 = #992#123;
         #1001#124 = #992#124;
     |SINO;
         #1001#0   = #992#0;
         #1001#1   = #992#1;
         #1001#2   = #992#2;
         #1001#3   = "X";
         |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
         #1001#4   = 0;
         #1001#5   = #992#5;
         #1001#6   = #992#6;
         #1001#7   = #992#7;
         #1001#8   = #992#8;
         #1001#9   = #992#9;
         #1001#10  = #992#10;
         #1001#13  = #992#13;
         #1001#14  = #992#14;
         #1001#15  = #992#15;
         #1001#16  = #992#16;
         #1001#17  = #992#17;
         #1001#18  = #992#18;
         #1001#19  = #992#19;
         #1001#20  = #992#20;
         #1001#21  = #992#21;
         #1001#22  = #992#22;
         #1001#23  = #992#23;
         #1001#25  = #992#25;
         #1001#26  = #992#26;
         #1001#27  = #992#27;
         #1001#28  = #992#28;
         #1001#29  = #992#29;
         #1001#95  = #992#95;
         #1001#96  = #992#96;
         #1001#97  = #992#97;
         #1001#98  = #992#98;
         #1001#99  = #992#99;
         #1001#100 = #992#100;
         #1001#101 = #992#101;
         #1001#102 = #992#102;
         #1001#103 = #992#103;

         #1001#104 = #992#104;
         #1001#105 = #992#105;
         #1001#106 = #992#106;
         #1001#117 = #992#117;
         #1001#118 = #992#118;
         #1001#119 = #992#119;
         #1001#120 = #992#120;
         #1001#121 = #992#121;
         #1001#122 = #992#122;
         #1001#123 = #992#123;
         #1001#124 = #992#124;

         |PARA nCampoPase = 30;  |SI nCampoPase [ 61;  |HACIENDO nCampoPase = nCampoPase + 1;
               #1001nCampoPase = #992nCampoPase;
         |SIGUE;

         #1001#38  = #992#38;
         #1001#40  = #992#40;
         #1001#42  = #992#42;
         #1001#44  = #992#44;
         #1001#45  = #992#45;
         #1001#45  = #992#45;
         #1001#47  = #992#47;
         #1001#45  = #992#45;
         #1001#51  = #992#51;
         #1001#51  = #992#51;
         #1001#53  = #992#53;
         #1001#55  = #992#55;
         #1001#57  = #992#57;
         #1001#60  = #992#60;
         #1001#61  = #992#61;
         #1001#116 = #992#116;


         |SI #1001#30 ! 0;  |Y  #1001#33 ! 0;
             nSuma = #1001#30 + #1001#33;
             #1001#30 = nSuma;
             #1001#33 = 0;
         |FINSI;

         |SI #1001#31 ! 0;  |Y  #1001#34 ! 0;
             nSuma = #1001#31 + #1001#34;
             #1001#31 = nSuma;
             #1001#34 = 0;
         |FINSI;

         |SI #1001#32 ! 0;  |Y  #1001#35 ! 0;
             nSuma = #1001#32 + #1001#35;
             #1001#32 = nSuma;
             #1001#35 = 0;
         |FINSI;

         |SI #0#30 = "S";
             #1001#15 = (N\ #1001#15 + (#1001#15 % #0#31));
         |FINSI;

         |SI #0#29 = "S";
             |ABRE #1;
             #1#0 = #1001#105;
             #1#1 = #1001#106;
             |LEE 040#1=;
             |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
             |CIERRA #1;

             nSuma  = ((#1001#21 / #1#2) * #1#3);
             nSuma1 = ((#1001#21 / #1#2) * #1#3) % #0#31;

             |SI #1#3 ] #1#2;
                 #1001#21 = (N\ nSuma + nSuma1);
             |SINO;
                 #1001#21 = (N\ nSuma - nSuma1);
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1001#30 > 365;  #1001#30 = 365;  |FINSI;
     |SI #1001#31 > 365;  #1001#31 = 365;  |FINSI;
     |SI #1001#32 > 365;  #1001#32 = 365;  |FINSI;
     |SI #1001#33 > 365;  #1001#33 = 365;  |FINSI;
     |SI #1001#34 > 365;  #1001#34 = 365;  |FINSI;
     |SI #1001#35 > 365;  #1001#35 = 365;  |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00021";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00021_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa021;
|FIN;

|PROCESO Pasa049;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00049";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00049_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa049;
|FIN;

|PROCESO Inmuebles;
     aDef = #0#0 + "/def/rem00021.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00021 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00021.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00021 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00021_2005;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;

     aDef = #0#0 + "/def/rem00049.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00049 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00049.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00049 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00049_2005;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa022;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#13  = #992#13;
     #1001#14  = #992#14;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;
     #1001#28  = #992#28;
     #1001#25  = 0;
     #1001#26  = 0;
     #1001#28  = "S";

     |SI #0#33 = "S";
         #1001#15  = #992#15;
     |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00022";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00022_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa022;
|FIN;

|PROCESO Pasa043C;
     |SI #992#4 = "V";  |ACABA;  |FINSI;

     #1001#0 = #992#0;
     #1001#1 = #992#1;
     #1001#2 = #992#2;
     #1001#3 = #992#3;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = #992#3;
     #1001#4   = #992#4;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#13  = #992#13;
     #1001#14  = #992#14;
     |GRABA 020#1001n;
     |LIBERA #1001;
|FPRC;

|DEFBUCLE rem00043C_2005;
     #992#1004;
     ;
     #991#0, 01, "01.01.0000", 01;
     #991#0, 99, "31.12.2999", 99;
     ;
     NULL, Pasa043C;
|FIN;

|PROCESO RegrabaCompra;
     |SI nAcciones = 0;  |ACABA;  |FINSI;

     |SI #992#6 = #1001#6;  |Y #992#7 = #1001#7;
         |SI nAcciones = #1001#5;
             |BORRA 020#1001a;
             nAcciones = 0;
             |ACABA;
         |FINSI;
         |SI nAcciones < #1001#5;
             #1001#5 = (N\ #1001#5 - nAcciones);
             #1001#8 = (N\ #1001#5 * #1001#7);
             |GRABA 020#1001a;
             nAcciones = 0;
             |ACABA;
         |FINSI;
         |SI nAcciones > #1001#5;
             nAcciones = nAcciones - #1001#5;
             |BORRA 020#1001a;
             |ACABA;
         |FINSI;
     |FINSI;

     |LIBERA #1001;
|FPRC;

|DEFBUCLE rem00043_2005;
     #1001#1004;
     ;
     #992#0, #992#1, "01.01.0000", 01;
     #992#0, #992#1, "31.12.2999", 99;
     be;
     NULL, RegrabaCompra;
|FIN;

|PROCESO Pasa043V;
     |SI #992#4 = "C";  |ACABA;  |FINSI;

     nAcciones = #992#5;
     |BUCLE rem00043_2005;
|FPRC;

|DEFBUCLE rem00043V_2005;
     #992#1004;
     ;
     #991#0, 01, "01.01.0000", 01;
     #991#0, 99, "31.12.2999", 99;
     ;
     NULL, Pasa043V;
|FIN;


|PROCESO Pasa023;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#13  = #992#13;
     #1001#14  = #992#14;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#24  = #992#24;
     #1001#33  = #992#33;

     |SI #0#33 = "S";
         #1001#15  = #992#15;
     |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00023";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00023_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa023;
|FIN;

|PROCESO Mobiliario2;
     aDef = #0#0 + "/def/rem00023.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00023 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00023.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00023 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00023_2005;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa050;
     #1002#0 = #993#0;
     #1002#1 = #993#1;
     #1002#2 = #993#2;
     |LEE 101#1002=;
     |SI FSalida = 0;
         |BORRA 020#1002a;
         |LIBERA #1002;
     |FINSI;

     |DDEFECTO #1002;
     #1002#0   = #993#0;
     #1002#1   = #993#1;
     #1002#2   = #993#2;
     #1002#3   = #993#3;
     #1002#4   = #993#4;
     #1002#5   = #993#5;
     #1002#6   = #993#6;
     #1002#7   = #993#7;
     #1002#8   = #993#8;
     #1002#9   = #993#9;

     |GRABA 020#1002n;
     |LIBERA #1002;
|FPRC;

|DEFBUCLE rem00050_2005;
     #993#1003;
     ;
     #992#0, #992#1, 1900;
     #992#0, #992#1, 2999;
     ;
     NULL, Pasa050;
|FIN;

|PROCESO Pasa024;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#13  = #992#13;
     #1001#14  = #992#14;
     #1001#15  = #992#15;
     |SI #1001#12 ! 0;
         #1001#12 = (N\ #1001#12 + 1);
     |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00024";
     eaPunto    = "";
     |HAZ ProgramaActivo;

     |SI #1001#12 ] 1;  |Y #1001#12 [ 12;
         |BUCLE rem00050_2005;
     |FINSI;
|FPRC;

|DEFBUCLE rem00024_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa024;
|FIN;

|PROCESO Mobiliario3;
     aDef = #0#0 + "/def/rem00024.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00024 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem00050.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00050 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00024.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00024 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00050.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00050 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;
     |PATH_DAT #993 aFich;

     |ABRE #1001;
     |ABRE #1002;
     |BUCLE rem00024_2005;
     |CIERRA #1001;
     |CIERRA #1002;

     |DESCARGA_DEF #aficahor2@;
     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante3@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa051;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#13  = #992#13;
     #1001#14  = #992#14;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#20  = #992#20;
     |SI #1001#20 > 0;  #1001#20 = (N\ #1001#20 + 1);  |FINSI;

     |SI #0#33 = "S";
         #1001#15  = #992#15;
     |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00051";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00051_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa051;
|FIN;

|PROCESO Mobiliario4;
     aDef = #0#0 + "/def/rem00051.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00051 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00051.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00051 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00051_2005;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO rem00060;
     |BORRA 020#60a;
     |LIBERA #60;
|FPRC;

|DEFBUCLE rem00060;
     #60#1;
     ;
     nEmpresa, nLinea, 01;
     nEmpresa, nLinea, 99;
     be;
     NULL, rem00060;
|FIN;

|PROCESO Pasa055;
     nEmpresa = #992#0;
     nLinea   = #992#1;
     |BUCLE rem00060;

     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#13  = #992#13;
     #1001#14  = #992#14;
     #1001#16  = #992#16;
     #1001#17  = #992#17;

     |SI #0#33 = "S";
         #1001#15  = #992#15;
     |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00055";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00055_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa055;
|FIN;

|PROCESO Mobiliario6;
     aDef = #0#0 + "/def/rem00055.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00055 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00055.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00055 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00055_2005;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa025;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#14  = #992#14;
     #1001#15  = #992#15;
     #1001#16  = #992#16;

     |SI #992#18 = "P"; #1001#17 = "5";  |FINSI;
     |SI #992#18 = "A"; #1001#17 = "4";  |FINSI;
     |SI #992#18 = "E";
         #992#17 = "1";
         |SI #992#17  = "N";  #1001#17 = "3";  |FINSI;
         |SI #992#20  = "S";  #1001#17 = "2";  |FINSI;
     |FINSI;

     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#21  = #992#21;
     #1001#22  = #992#22;
     #1001#23  = #992#23;
     #1001#24  = #992#24;
     #1001#25  = #992#25;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00025";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00025_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa025;
|FIN;

|PROCESO Actividad1;
     aDef = #0#0 + "/def/rem00025.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00025 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00025.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00025 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00025_2005;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa026;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#14  = #992#14;
     #1001#15  = #992#15;
     #1001#16  = #992#16;

     |SI #992#18 = "P"; #1001#17 = "5";  |FINSI;
     |SI #992#18 = "A"; #1001#17 = "4";  |FINSI;
     |SI #992#18 = "E";
         #992#17 = "1";
         |SI #992#17  = "N";  #1001#17 = "3";  |FINSI;
         |SI #992#20  = "S";  #1001#17 = "2";  |FINSI;
     |FINSI;

     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#21  = #992#21;
     #1001#22  = #992#22;
     #1001#23  = #992#23;
     #1001#24  = #992#24;
     #1001#25  = #992#25;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00026";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00026_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa026;
|FIN;

|PROCESO Actividad2;
     aDef = #0#0 + "/def/rem00026.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00026 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00026.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00026 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00026_2005;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa027;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#14  = #992#14;
     #1001#15  = #992#15;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#20  = #992#20;
     #1001#21  = #992#21;
     #1001#22  = #992#22;
     #1001#23  = #992#23;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00027";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00027_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa027;
|FIN;

|PROCESO Actividad3;
     aDef = #0#0 + "/def/rem00027.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00027 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00027.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00027 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00027_2005;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa028;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#14  = #992#14;
     #1001#15  = #992#15;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#20  = #992#20;
     #1001#21  = #992#21;
     #1001#22  = #992#22;
     #1001#23  = #992#23;
     #1001#24  = #992#24;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00028";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00028_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa028;
|FIN;

|PROCESO Actividad4;
     aDef = #0#0 + "/def/rem00028.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00028 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00028.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00028 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00028_2005;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa053;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#13  = #992#13;
     #1001#17  = #992#17;
     #1001#21  = #992#21;
     #1001#22  = #992#22;
     #1001#23  = #992#23;
     #1001#24  = #992#24;
     #1001#25  = #992#25;
     #1001#26  = #992#26;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00053";
     eaPunto    = "";
     |HAZ ProgramaActivo;

     |SI #1001#21 = "S";
         #1002#0 = #992#0;
         #1002#1 = #1001#22;
         |LEE 101#1002=;
         |SI FSalida ! 0;
             |DDEFECTO #1002;
             #1002#0  = #992#0;
             #1002#1  = #1001#22;
             #1002#13 = #1001#11;
             |GRABA 020#1002n;
             |LIBERA #1002;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE rem00053_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa053;
|FIN;

|PROCESO Pasa061;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00061";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00061_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa061;
|FIN;

|PROCESO Pensiones;
     aDef = #0#0 + "/def/rem00053.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00053 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00053.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00053 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00020.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00020 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |ABRE #1002;
     |BUCLE rem00053_2005;
     |CIERRA #1001;
     |CIERRA #1002;

     |DESCARGA_DEF #aficahor2@;
     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;

     aDef = #0#0 + "/def/rem00061.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00061 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00061.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00061 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00061_2005;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa054;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#14  = #992#14;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00054";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00054_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa054;
|FIN;

|PROCESO Anualidades;
     aDef = #0#0 + "/def/rem00054.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00054 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00054.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00054 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00054_2005;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa032;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#13  = #992#13;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00032";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00032_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa032;
|FIN;

|PROCESO TFiscal;
     aDef = #0#0 + "/def/rem00032.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00032 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00032.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00032 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00032_2005;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa046;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#14  = #992#14;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00046";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00046_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa046;
|FIN;

|PROCESO Donativos;
     aDef = #0#0 + "/def/rem00046.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00046 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00046.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00046 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00046_2005;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO GrabaDedu;
     |SI nImporte = 0;  |ACABA;  |FINSI;

     |SELECT #3#2;
     #2#7 = #994#11;
     #2#8 = #994#13;
     |LEE 040#2=;
     |SI FSalida ! 0;
         #2#9  = 0;
         #2#10 = 0;
         |SI #994#11 = 2;
             |SI #994#13 = 18;  #2#9  = 1;  #2#10 = 9;  |FINSI;
             |SI #994#13 = 19;  #2#9  = 1;  #2#10 = 9;  |FINSI;
             |SI #994#13 = 20;  #2#9  = 1;  #2#10 = 10; |FINSI;
         |FINSI;

         |SI #2#9 = 0;  |Y #2#10 = 0;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #992#2 = "TITULAR   ";
         |SI #994#2 = "CONYUGE   ";  |ACABA;  |FINSI;
         |SI #994#2 = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "4 FAMILIAR";  |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "CONYUGE   ";
         |SI #994#2 = "TITULAR   ";  |ACABA;  |FINSI;
         |SI #994#2 = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "4 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "GANANCIAL ";  |ACABA;  |FINSI;
         |SI #994#2 = "VARIOS    ";  |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "1 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "2 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "3 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "4 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #994#17 = 0;
         nCompara = #994#18;
     |SINO;
         nCompara = #994#19;
     |FINSI;

     |SELECT #1#2;
     #2#0 = #2#9;
     #2#1 = #2#10;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

     |SI nImporte = nCompara;
         #1001#0 = #994#0;
         #1001#1 = #994#1;
         |LEE 101#1001=;
         |SI FSalida = 0;
             |BORRA 020#1001a;
             |LIBERA #1001;
         |FINSI;

         |PARA nCampoPase = 0;  |SI nCampoPase [ 21;  |HACIENDO nCampoPase = nCampoPase + 1;
               #1001nCampoPase = #994nCampoPase;
         |SIGUE;
         #1001#3  = "X";
         |SI #0#37 = "N";  #1001#3 = #994#3;  |FINSI;

         #1001#11 = #2#0;
         #1001#12 = #2#2;
         #1001#13 = #2#1;
         #1001#14 = #2#3;
         #1001#15 = #2#4;
         #1001#16 = #2#5;
         #1001#17 = #2#6;

         nImpo    = nImporte;

         |SI #1001#17 ! 0;
             #1001#18 = (N\ ((nImpo * 100) / #1001#17) ! 2);
             #1001#19 = nImpo;
         |SINO;
             #1001#18 = nImpo;
             #1001#19 = nImpo;
         |FINSI;

         |GRABA 020#1001n;
         |LIBERA #1001;

         eaPrograma = "rem00045";
         eaPunto    = "";
         |HAZ ProgramaActivo;

         nImporte = 0;

         |ACABA;
     |FINSI;

     |SI nImporte < nCompara;
         #1001#0 = #994#0;
         #1001#1 = #994#1;
         |LEE 101#1001=;
         |SI FSalida = 0;
             |BORRA 020#1001a;
             |LIBERA #1001;
         |FINSI;

         |PARA nCampoPase = 0;  |SI nCampoPase [ 21;  |HACIENDO nCampoPase = nCampoPase + 1;
               #1001nCampoPase = #994nCampoPase;
         |SIGUE;
         #1001#3  = "X";
         |SI #0#37 = "N";  #1001#3 = #994#3;  |FINSI;
         #1001#11 = #2#0;
         #1001#12 = #2#2;
         #1001#13 = #2#1;
         #1001#14 = #2#3;
         #1001#15 = #2#4;
         #1001#16 = #2#5;
         #1001#17 = #2#6;

         nImpo    = nImporte;

         |SI #1001#17 ! 0;
             #1001#18 = (N\ ((nImpo * 100) / #1001#17) ! 2);
             #1001#19 = nImpo;
         |SINO;
             #1001#18 = nImpo;
             #1001#19 = nImpo;
         |FINSI;
         |GRABA 020#1001n;

         eaPrograma = "rem00045";
         eaPunto    = "";
         |HAZ ProgramaActivo;

         nImporte = 0;

         |ACABA;
     |FINSI;

     |SI nImporte > nCompara;
         #1001#0 = #994#0;
         #1001#1 = #994#1;
         |LEE 101#1001=;
         |SI FSalida = 0;
             |BORRA 020#1001a;
             |LIBERA #1001;
         |FINSI;

         |PARA nCampoPase = 0;  |SI nCampoPase [ 21;  |HACIENDO nCampoPase = nCampoPase + 1;
               #1001nCampoPase = #994nCampoPase;
         |SIGUE;
         #1001#3  = "X";
         |SI #0#37 = "N";  #1001#3 = #994#3;  |FINSI;
         #1001#11 = #2#0;
         #1001#12 = #2#2;
         #1001#13 = #2#1;
         #1001#14 = #2#3;
         #1001#15 = #2#4;
         #1001#16 = #2#5;
         #1001#17 = #2#6;

         nImpo    = nCompara;

         |SI #1001#17 ! 0;
             #1001#18 = (N\ ((nImpo * 100) / #1001#17) ! 2);
             #1001#19 = nImpo;
         |SINO;
             #1001#18 = nImpo;
             #1001#19 = nImpo;
         |FINSI;
         |GRABA 020#1001n;

         eaPrograma = "rem00045";
         eaPunto    = "";
         |HAZ ProgramaActivo;

         nImporte = nImporte - nCompara;
         |ACABA;
     |FINSI;
|FPRC;

|DEFBUCLE rem00045_2005;
     #994#1002;
     11, 13;
     #993#0, 01, nAgru, nCasi;
     #993#0, 99, nAgru, nCasi;
     ;
     NULL, GrabaDedu;
|FIN;

|PROCESO PonDedu;
     |ABRE #2;
     |BUCLE rem00045_2005;
     |CIERRA #2;
|FPRC;

|PROCESO InvEmpresariales;
     #993#0 = #992#0;
     #993#1 = #992#1;
     #993#2 = #992#2;
     |LEE 040#993=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nImporte = 0;
     |SI #993#5   ! 0;  nImporte = #993#5;   nAgru = 1;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 1;  nCasi = 3;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 1;  nCasi = 4;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 1;  nCasi = 5;  |HAZ PonDedu;  |FINSI;

     nImporte = 0;
     |SI #993#8   ! 0;  nImporte = #993#8;   nAgru = 1;  nCasi = 6;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 1;  nCasi = 7;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 1;  nCasi = 8;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 1;  nCasi = 9;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 1;  nCasi = 10; |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 1;  nCasi = 11; |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 1;  nCasi = 12; |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 1;  nCasi = 13; |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 1;  nCasi = 14; |HAZ PonDedu;  |FINSI;

     nImporte = 0;
     |SI #993#11  ! 0;  nImporte = #993#11;  nAgru = 2;  nCasi = 1;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 2;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 2;  nCasi = 3;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 2;  nCasi = 4;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 2;  nCasi = 5;  |HAZ PonDedu;  |FINSI;

     |SI #993#14  ! 0;  nImporte = #993#14;  nAgru = 2;  nCasi = 6;  |HAZ PonDedu;  |FINSI;

     |SI #993#17  ! 0;  nImporte = #993#32;  nAgru = 2;  nCasi = 7;  |HAZ PonDedu;  |FINSI;

     nImporte = 0;
     |SI #993#20  ! 0;  nImporte = #993#20;  nAgru = 2;  nCasi = 8;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 2;  nCasi = 9;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 2;  nCasi = 10; |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 2;  nCasi = 11; |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 2;  nCasi = 12; |HAZ PonDedu;  |FINSI;

     |SI #993#23  ! 0;  nImporte = #993#23;  nAgru = 2;  nCasi = 13; |HAZ PonDedu;  |FINSI;

     nImporte = 0;
     |SI #993#26  ! 0;  nImporte = #993#26;  nAgru = 2;  nCasi = 14; |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 2;  nCasi = 15; |HAZ PonDedu;  |FINSI;

     |SI #993#29  ! 0;  nImporte = #993#29;  nAgru = 2;  nCasi = 16; |HAZ PonDedu;  |FINSI;

     |SI #993#32  ! 0;  nImporte = #993#32;  nAgru = 2;  nCasi = 17; |HAZ PonDedu;  |FINSI;

     |SI #993#35  ! 0;  nImporte = #993#35;  nAgru = 2;  nCasi = 18; |HAZ PonDedu;  |FINSI;

     |SI #993#38  ! 0;  nImporte = #993#38;  nAgru = 2;  nCasi = 19; |HAZ PonDedu;  |FINSI;

     |SI #993#41  ! 0;  nImporte = #993#41;  nAgru = 2;  nCasi = 20; |HAZ PonDedu;  |FINSI;

     |SI #993#44  ! 0;  nImporte = #993#44;  nAgru = 2;  nCasi = 21; |HAZ PonDedu;  |FINSI;

     |SI #993#47  ! 0;  nImporte = #993#47;  nAgru = 2;  nCasi = 22; |HAZ PonDedu;  |FINSI;

     |SI #993#50  ! 0;  nImporte = #993#50;  nAgru = 2;  nCasi = 23; |HAZ PonDedu;  |FINSI;

     nImporte = 0;
     |SI #993#53  ! 0;  nImporte = #993#53;  nAgru = 3;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 3;  nCasi = 3;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 3;  nCasi = 4;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 3;  nCasi = 5;  |HAZ PonDedu;  |FINSI;

     nImporte = 0;
     |SI #993#56  ! 0;  nImporte = #993#56;  nAgru = 4;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 4;  nCasi = 3;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 4;  nCasi = 4;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 4;  nCasi = 5;  |HAZ PonDedu;  |FINSI;

     nImporte = 0;
     |SI #993#59  ! 0;  nImporte = #993#59;  nAgru = 5;  nCasi = 1;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 5;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 5;  nCasi = 3;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 5;  nCasi = 4;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 5;  nCasi = 5;  |HAZ PonDedu;  |FINSI;

     |SI #993#62  ! 0;  nImporte = #993#62;  nAgru = 5;  nCasi = 6;  |HAZ PonDedu;  |FINSI;

     |SI #993#65  ! 0;  nImporte = #993#65;  nAgru = 5;  nCasi = 7;  |HAZ PonDedu;  |FINSI;

     nImporte = 0;
     |SI #993#68  ! 0;  nImporte = #993#68;  nAgru = 5;  nCasi = 8;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 5;  nCasi = 9;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 5;  nCasi = 10; |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 5;  nCasi = 11; |HAZ PonDedu;  |FINSI;

     |SI #993#71  ! 0;  nImporte = #993#71;  nAgru = 5;  nCasi = 12; |HAZ PonDedu;  |FINSI;

     nImporte = 0;
     |SI #993#74  ! 0;  nImporte = #993#74;  nAgru = 5;  nCasi = 13; |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 5;  nCasi = 14; |HAZ PonDedu;  |FINSI;

     |SI #993#77  ! 0;  nImporte = #993#77;  nAgru = 5;  nCasi = 15; |HAZ PonDedu;  |FINSI;

     |SI #993#80  ! 0;  nImporte = #993#80;  nAgru = 5;  nCasi = 16; |HAZ PonDedu;  |FINSI;

     |SI #993#83  ! 0;  nImporte = #993#83;  nAgru = 6;  nCasi = 1;  |HAZ PonDedu;  |FINSI;

     nImporte = 0;
     |SI #993#86  ! 0;  nImporte = #993#86;  nAgru = 7;  nCasi = 1;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 7;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 8;  nCasi = 1;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 8;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 8;  nCasi = 3;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 8;  nCasi = 4;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 8;  nCasi = 5;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 8;  nCasi = 6;  |HAZ PonDedu;  |FINSI;

     |SI #993#96  ! 0;  nImporte = #993#96;  nAgru = 9;  nCasi = 2;  |HAZ PonDedu;  |FINSI;

     |SI #993#100 ! 0;  nImporte = #993#100; nAgru = 9;  nCasi = 3;  |HAZ PonDedu;  |FINSI;

     |SI #993#104 ! 0;  nImporte = #993#104; nAgru = 9;  nCasi = 4;  |HAZ PonDedu;  |FINSI;

     |SI #993#108 ! 0;  nImporte = #993#108; nAgru = 9;  nCasi = 5;  |HAZ PonDedu;  |FINSI;
|FPRC;

|PROCESO GrabaOtras;
     |SI #992#2 = "TITULAR   ";
         |SI #994#2 = "CONYUGE   ";  |ACABA;  |FINSI;
         |SI #994#2 = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "4 FAMILIAR";  |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "CONYUGE   ";
         |SI #994#2 = "TITULAR   ";  |ACABA;  |FINSI;
         |SI #994#2 = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "4 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "GANANCIAL ";  |ACABA;  |FINSI;
         |SI #994#2 = "VARIOS    ";  |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "1 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "2 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "3 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "4 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     #1001#0 = #994#0;
     #1001#1 = #994#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |PARA nCampoPase = 0;  |SI nCampoPase [ 15;  |HACIENDO nCampoPase = nCampoPase + 1;
           #1001nCampoPase = #994nCampoPase;
     |SIGUE;

     |SI #994#14 [ nImporte;
         nImporte = nImporte - #994#14;
         |ACABA;
     |SINO;
         #1001#14 = (N\ #994#14 - nImporte);
         nImporte = 0;
     |FINSI;

     |SI nAnyo = 0;  nAnyo = #994#13;  |FINSI;

     |SI nAnyo = 0;  |ACABA;  |FINSI;

     #1001#13  = nAnyo;
                       #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #994#3;  |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;
|FPRC;

|DEFBUCLE rem00056_2005;
     #994#1002;
     11, 13;
     #993#0, 01, nTipo, nDEjer;
     #993#0, 99, nTipo, nHEjer;
     ;
     NULL, GrabaOtras;
|FIN;

|PROCESO PonOtras;
     |BUCLE rem00056_2005;
|FPRC;

|PROCESO OtrasDeducciones;
     #993#0 = #992#0;
     #993#1 = #992#1;
     #993#2 = #992#2;
     |LEE 040#993=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     #995#0 = #992#0;
     #995#1 = #992#1;
     #995#2 = #992#2;
     |LEE 040#995=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     || Tipo 10;
     nImporte = #993#55;
     nDEjer   = 2002;
     nHEjer   = 2005;
     nAnyo    = 0;
     nTipo    = 10;
     |HAZ PonOtras;

     || Tipo 0;
     nImporte = #993#4 + #993#7;
     nDEjer   = 2001;
     nHEjer   = 2005;
     nAnyo    = 0;
     nTipo    = 0;
     |HAZ PonOtras;

     || Tipo 11;
     nImporte = #993#13;
     nDEjer   = 2001;
     nHEjer   = 2005;
     nAnyo    = 0;
     nTipo    = 11;
     |HAZ PonOtras;

     |SI #993#53 < 0;
         aContri = #993#2;
         |SI #993#2 = "CONJUNTA  ";  aContri = "TITULAR";  |FINSI;
         |SI #993#2 = "CONJUNTAE ";  aContri = "TITULAR";  |FINSI;

         #1001#0  = #993#0;
         #1001#1  = 99;
         |LEE 000#1001];
         |SI FSalida = 0;
             |LEE 000#1001a;
         |SINO;
             |LEE 000#1001u;
         |FINSI;

         nLinea = 1;
         |SI FSalida = 0;  #1001#0 = #993#0;
             nLinea = #1001#1 + 1;
         |FINSI;

         nImporte = -#993#53;

         |DDEFECTO #1001;
         #1001#0  = #993#0;
         #1001#1  = nLinea;
         #1001#2  = aContri;
         #1001#11 = 10;
         #1001#12 = "CASILLA 627";
         #1001#13 = 2005;
         #1001#14 = nImporte;
                           #1001#3   = "X";
         |SI #0#37 = "N";  #1001#3 = #994#3;  |FINSI;

         |GRABA 020#1001n;
         |LIBERA #1001;
     |FINSI;

     |SI #993#9 > 0;
         aContri = #993#2;
         |SI #993#2 = "CONJUNTA  ";  aContri = "TITULAR";  |FINSI;
         |SI #993#2 = "CONJUNTAE ";  aContri = "TITULAR";  |FINSI;

         #1001#0  = #993#0;
         #1001#1  = 99;
         |LEE 000#1001];
         |SI FSalida = 0;
             |LEE 000#1001a;
         |SINO;
             |LEE 000#1001u;
         |FINSI;

         nLinea = 1;
         |SI FSalida = 0;  #1001#0 = #993#0;
             nLinea = #1001#1 + 1;
         |FINSI;

         nImporte = #993#9;

         |DDEFECTO #1001;
         #1001#0  = #993#0;
         #1001#1  = nLinea;
         #1001#2  = aContri;
         #1001#11 = 0;
         #1001#12 = "CASILLA 475";
         #1001#13 = 2005;
         #1001#14 = nImporte;
                           #1001#3   = "X";
         |SI #0#37 = "N";  #1001#3 = #994#3;  |FINSI;

         |GRABA 020#1001n;
         |LIBERA #1001;
     |FINSI;

     |SI #995#34 > 0;
         aContri = #995#2;
         |SI #995#2 = "CONJUNTA  ";  aContri = "TITULAR";  |FINSI;
         |SI #995#2 = "CONJUNTAE ";  aContri = "TITULAR";  |FINSI;

         #1001#0  = #995#0;
         #1001#1  = 99;
         |LEE 000#1001];
         |SI FSalida = 0;
             |LEE 000#1001a;
         |SINO;
             |LEE 000#1001u;
         |FINSI;

         nLinea = 1;
         |SI FSalida = 0;  #1001#0 = #995#0;
             nLinea = #1001#1 + 1;
         |FINSI;

         nImporte = #995#34;

         |DDEFECTO #1001;
         #1001#0  = #995#0;
         #1001#1  = nLinea;
         #1001#2  = aContri;
         #1001#11 = 11;
         #1001#12 = "CASILLA 465";
         #1001#13 = 2005;
         #1001#14 = nImporte;
                           #1001#3   = "X";
         |SI #0#37 = "N";  #1001#3 = #994#3;  |FINSI;

         |GRABA 020#1001n;
         |LIBERA #1001;
     |FINSI;
|FPRC;

|PROCESO BuscaPension;
     |SI #1001#2 ! aContri;  |ACABA;  |FINSI;

     |SI nTipo = 1;  |Y #1001#23 = "N";  |Y #1001#21 = "N";
         #1001#14 = nImporte;
         |GRABA 020#1001a;
         |LIBERA #1001;
         |ERROR10;
     |FINSI;

     |SI nTipo = 2;  |Y #1001#23 = "N";  |Y #1001#21 = "S";
         #1001#14 = nImporte;
         |GRABA 020#1001a;
         |LIBERA #1001;
         |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE rem00053_2006;
     #1001#1002;
     ;
     #993#0, 01;
     #993#0, 99;
     be;
     NULL, BuscaPension;
|FIN;

|PROCESO GrabaPension;
     |BUCLE rem00053_2006;
|FPRC;

|PROCESO BuscaDiscapacidad;
     |SI #1002#2 ! aContri;  |ACABA;  |FINSI;

     #1002#13 = nImporte;
     |GRABA 020#1002a;
     |LIBERA #1002;
     |ERROR10;
|FPRC;

|DEFBUCLE rem00061_2006;
     #1002#1002;
     ;
     #993#0, 01;
     #993#0, 99;
     be;
     NULL, BuscaDiscapacidad;
|FIN;

|PROCESO GrabaDiscapacidad;
     |BUCLE rem00061_2006;
|FPRC;

|PROCESO ExcesoPens;
     #993#0 = #992#0;
     #993#1 = #992#1;
     #993#2 = #992#2;
     |LEE 040#993=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #992#2 = "CONJUNTA  ";  |O #992#2 = "CONJUNTAE ";
         nImporte = #993#65;
         |SI nImporte > 0;
              nTipo   = 1;
              aContri = "TITULAR   ";
              |HAZ GrabaPension;
         |FINSI;

         nImporte = #993#66;
         |SI nImporte > 0;
             nTipo   = 2;
             aContri = "TITULAR   ";
             |HAZ GrabaPension;
         |FINSI;

         nImporte = #993#68;
         |SI nImporte > 0;
             nTipo   = 1;
             aContri = "CONYUGE   ";
             |HAZ GrabaPension;
         |FINSI;

         nImporte = #993#69;
         |SI nImporte > 0;
             nTipo   = 2;
             aContri = "CONYUGE   ";
             |HAZ GrabaPension;
         |FINSI;

         nImporte = #993#80;
         |SI nImporte > 0;
              aContri = "TITULAR   ";
              |HAZ GrabaDiscapacidad;
         |FINSI;

         nImporte = #993#82;
         |SI nImporte > 0;
             aContri = "CONYUGE   ";
             |HAZ GrabaDiscapacidad;
         |FINSI;
     |SINO;
         nImporte = #993#65;
         |SI nImporte > 0;
             nTipo   = 1;
             aContri = #993#2;
             |HAZ GrabaPension;
         |FINSI;

         nImporte = #993#66;
         |SI nImporte > 0;
             nTipo   = 2;
             aContri = #993#2;
             |HAZ GrabaPension;
         |FINSI;

         nImporte = #993#80;
         |SI nImporte > 0;
              aContri = "TITULAR   ";
              |HAZ GrabaDiscapacidad;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO DobleImposicion;
     #993#0 = #994#0;
     #993#1 = #994#1;
     #993#2 = #994#2;
     |LEE 040#993=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nDobleImpo = #993#32 + #993#35;

     |SI nDobleImpo [ 0;  |ACABA;  |FINSI;

     aContri = #993#2;
     |SI #993#2 = "CONJUNTA  ";  aContri = "TITULAR";  |FINSI;
     |SI #993#2 = "CONJUNTAE ";  aContri = "TITULAR";  |FINSI;

     #1002#0  = #993#0;
     #1002#1  = 99;
     |LEE 000#1002];
     |SI FSalida = 0;
         |LEE 000#1002a;
     |SINO;
         |LEE 000#1002u;
     |FINSI;

     nLinea = 1;
     |SI FSalida = 0;  |Y #1002#0 = #993#0;
         nLinea = #1002#1 + 1;
     |FINSI;

     |DDEFECTO #1002;
     #1002#0  = #993#0;
     #1002#1  = nLinea;
     #1002#2  = aContri;
     #1002#11 = 24;
     #1002#12 = "CASILLA 723";
     #1002#13 = 2005;
     #1002#14 = nDobleImpo;
                       #1002#3   = "X";
     |SI #0#37 = "N";  #1002#3 = #993#3;  |FINSI;

     |GRABA 020#1002n;
     |LIBERA #1002;
|FPRC;

|PROCESO MiraLiquidacion;
     |SI nQueHago = 1;  |HAZ InvEmpresariales;  |FINSI;
     |SI nQueHago = 2;  |HAZ OtrasDeducciones;  |FINSI;
     |SI nQueHago = 3;  |HAZ ExcesoPens;        |FINSI;
     |SI nQueHago = 4;  |HAZ DobleImposicion;   |FINSI;
|FPRC;

|DEFBUCLE rem01001_2005;
     #992#1003;
     5;
     #991#0, 00, "          ", "100";
     #991#0, 99, "zzzzzzzzzz", "101";
     ;
     NULL, MiraLiquidacion;
|FIN;

|DEFBUCLE rem01001_2005_2;
     #994#1003;
     5;
     #991#0, 00, "          ", "100";
     #991#0, 99, "zzzzzzzzzz", "101";
     ;
     NULL, MiraLiquidacion;
|FIN;

|PROCESO Mobiliario1;
     aDef = #0#0 + "/def/rem00022.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00022 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem01041.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01041 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem01001.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01001 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00022.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00022 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00056.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00056 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;
     |PATH_DAT #993 aFich;
     |PATH_DAT #994 aFich;

     nQueHago = 4;
     nDobleImpo = 0;
     |ABRE #1002;
     |ABRE #993;
     |BUCLE rem01001_2005_2;
     |CIERRA #993;
     |CIERRA #1002;

     |ABRE #1001;
     |BUCLE rem00022_2005;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor2@;
     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante4@;
     |DESCARGA_DEF #aficante3@;
     |DESCARGA_DEF #aficante2@;

     aDef = #0#0 + "/def/rem00043.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00043 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00043.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00043 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00043C_2005;
     |CIERRA #1001;

     |BUCLE rem00043V_2005;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Deducciones;
     aDef = #0#0 + "/def/rem01001.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01001 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem01042.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01042 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem00045.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00045 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00045.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00045 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;
     |PATH_DAT #993 aFich;
     |PATH_DAT #994 aFich;

     nQueHago = 1;

     |ABRE #993;
     |ABRE #1001;
     |BUCLE rem01001_2005;
     |CIERRA #993;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante4@;
     |DESCARGA_DEF #aficante3@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO BasesNegativas;
     aDef = #0#0 + "/def/rem01001.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01001 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem01034.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01034 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem00056.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00056 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem01033.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante5@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01033 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00056.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00056 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;
     |PATH_DAT #993 aFich;
     |PATH_DAT #994 aFich;
     |PATH_DAT #995 aFich;

     nQueHago = 2;

     |ABRE #993;
     |ABRE #995;
     |ABRE #1001;
     |BUCLE rem01001_2005;
     |CIERRA #995;
     |CIERRA #993;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante5@;
     |DESCARGA_DEF #aficante4@;
     |DESCARGA_DEF #aficante3@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO ExcesoPensiones;
     aDef = #0#0 + "/def/rem01001.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01001 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem01034.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01034 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem00053.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00053 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem00061.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante5@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00061 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00053.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00053 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00061.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00061 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;
     |PATH_DAT #993 aFich;
     |PATH_DAT #994 aFich;
     |PATH_DAT #995 aFich;

     nQueHago = 3;

     |ABRE #993;
     |BUCLE rem01001_2005;
     |CIERRA #993;

     |DESCARGA_DEF #aficahor2@;
     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante5@;
     |DESCARGA_DEF #aficante4@;
     |DESCARGA_DEF #aficante3@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO El39Pdtes;
     |SELECT #1#39;
     #39#0 = #992#0;
     #39#1 = 99;
     |LEE 040#39];
     |SI FSalida = 0;
         |LEE 040#39a;
     |SINO;
         |LEE 040#39u;
     |FINSI;

     |SI FSalida = 0; |Y #39#0 = #992#0;
         nLinea = #39#1 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     #39#0   = #992#0;
     #39#1   = nLinea;
     #39#2   = #992#2;
                       #39#3   = "X";
     |SI #0#37 = "N";  #39#3 = #992#3;  |FINSI;

     #39#4   = 0;
     #39#5   = #992#5;
     #39#6   = #992#6;
     #39#7   = #992#7;
     #39#8   = #992#8;
     #39#9   = #992#9;
     #39#10  = #992#10;
     #39#14  = "01.01.0000";
     #39#15  = "PENDIENTE EJERCICIO 2005";
     #39#16  = 0;
     #39#17  = 0;
     #39#18  = nPendiente;
     #39#19  = 0;
     #39#20  = 0;
     #39#13  = 0;
     #39#21  = 1;
     #39#22  = "M";

     |GRABA 020#39n;
     |LIBERA #39;
|FPRC;

|PROCESO El42Pdtes;
     |ABRE #42;
     |SELECT #1#42;
     #42#0 = #992#0;
     #42#1 = 99;
     |LEE 040#42];
     |SI FSalida = 0;
         |LEE 040#42a;
     |SINO;
         |LEE 040#42u;
     |FINSI;

     |SI FSalida = 0; |Y #42#0 = #992#0;
         nLinea = #42#1 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     #42#0   = #992#0;
     #42#1   = nLinea;
     #42#2   = #992#2;
                       #42#3   = "X";
     |SI #0#37 = "N";  #42#3 = #992#3;  |FINSI;

     #42#4   = 0;
     #42#5   = #992#5;
     #42#6   = #992#6;
     #42#7   = #992#7;
     #42#8   = #992#8;
     #42#9   = #992#9;
     #42#10  = #992#10;
     #42#14  = "01.01.0000";
     #42#15  = "PENDIENTE EJERCICIO 2005";
     #42#16  = 0;
     #42#17  = 0;
     #42#18  = nPendiente;
     #42#19  = 0;
     #42#20  = 0;
     #42#13  = 0;
     #42#21  = 1;
     #42#22  = "M";

     |GRABA 020#42n;
     |LIBERA #42;
|FPRC;

|PROCESO Pasa038;
     |SI #992#27 = "C1";  |O #992#27 = "B1";
         |ACABA;
     |FINSI;

     nPendiente = #992#21 - #992#22;
     |SI nPendiente ! 0;
         |HAZ El39Pdtes;
         |ACABA;
     |FINSI;

     nPendiente = #992#24 - #992#26;
     |SI nPendiente ! 0;
         |HAZ El39Pdtes;
     |FINSI;
|FPRC;

|DEFBUCLE rem00038_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa038;
|FIN;

|PROCESO Pasa039;
     nPendiente = #992#12 - #992#13;
     |SI nPendiente > 0;
         |HAZ El39Pdtes;
         |ACABA;
     |FINSI;
|FPRC;

|DEFBUCLE rem00039_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa039;
|FIN;

|PROCESO Pasa041;
     |SI #992#34 = "C1";  |O #992#34 = "B1";
         |ACABA;
     |FINSI;

     nPendiente = #992#28 - #992#29;
     |SI nPendiente ! 0;
         |HAZ El42Pdtes;
         |ACABA;
     |FINSI;

     nPendiente = #992#31 - #992#33;
     |SI nPendiente ! 0;
         |HAZ El42Pdtes;
     |FINSI;
|FPRC;

|DEFBUCLE rem00041_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa041;
|FIN;

|PROCESO Pasa042;
     nPendiente = #992#12 - #992#13;
     |SI nPendiente > 0;
         |HAZ El42Pdtes;
         |ACABA;
     |FINSI;
|FPRC;

|DEFBUCLE rem00042_2005;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa042;
|FIN;

|PROCESO Incrementos;
|| Esta calculo cambia radicalmente en la RENTA DEL 2007

     aDef = #0#0 + "/def/rem00038.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00038 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #39;
     |BUCLE rem00038_2005;
     |CIERRA #39;

     |DESCARGA_DEF #aficante2@;

     aDef = #0#0 + "/def/rem00039.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00039 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #39;
     |BUCLE rem00039_2005;
     |CIERRA #39;

     |DESCARGA_DEF #aficante2@;

     aDef = #0#0 + "/def/rem00041.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00041 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #39;
     |BUCLE rem00041_2005;
     |CIERRA #39;

     |DESCARGA_DEF #aficante2@;

     aDef = #0#0 + "/def/rem00042.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00042 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #39;
     |BUCLE rem00042_2005;
     |CIERRA #39;

     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa090;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     #1001#2 = #992#2;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;

     |PARA nCampoPase = 0;  |SI nCampoPase [ 23;  |HACIENDO nCampoPase = nCampoPase + 1;
           #1001nCampoPase = #992nCampoPase;
     |SIGUE;

     |SI #0#34 = "N";
         #1001#10 = 0;
         #1001#14 = 0;
         #1001#23 = 0;
     |SINO;
         #1001#10 = #1001#10;
         #1001#14 = #1001#14;
         #1001#23 = #1001#23;
     |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00099";
     eaLetra    = #1001#1;
     eaPunto    = #1001#1;
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00099_2005;
     #992#1003;
     4, 5;
     #991#0, "  ", 001, "  ", 00;
     #991#0, "zz", 999, "  ", 00;
     ;
     NULL, Pasa090;
|FIN;

|PROCESO Patrimonio;
     aDef = #0#0 + "/def/rem00099.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00099 A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2006 + "/def/rem00099.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00099 A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00099_2005;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO rem00039B;
     |BORRA 020#39a;
     |LIBERA #39;
|FPRC;

|DEFBUCLE rem00039B;
     #39#1;
     21;
     enEmpresa, 01, 01;
     enEmpresa, 99, 99;
     be;
     NULL, rem00039B;
|FIN;

|PROCESO rem00042B;
     |BORRA 020#42a;
     |LIBERA #42;
|FPRC;

|DEFBUCLE rem00042B;
     #42#1;
     21;
     enEmpresa, 01, 01;
     enEmpresa, 99, 99;
     be;
     NULL, rem00042B;
|FIN;

|PROCESO Pasa2006;
     enEmpresa = #991#0;

     aDef = aBaseRenta2006 + "/def/reacceso.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def reacceso  A쨚 2006 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aAlfa1 = #991#1;  |QBF aAlfa1;
     aAlfa  = "     Recogiendo Contribuyente [" + (("00000" + #991#0) % -105) + " " + aAlfa1 + "]";

     |ABRE #1001;
     #1001#0 = #991#0;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |SI enCodCli = 0;
             |SI #0#41 = "S";
                 aAlfa  = "0000NYa existe Contribuyente [" + (("00000" + #991#0) % -105) + " " + aAlfa1 + "] Desea pasar los datos de nuevo : ";
                 |CONFI aAlfa;
             |SINO;
                 |SI #1001#12 = "*";
                     FSalida = 1;
                 |FINSI;
             |FINSI;

             |SI FSalida ! 0;
                 |CIERRA #1001;
                 |DESCARGA_DEF #aficahor1@;
                 |ACABA;
             |FINSI;
         |FINSI;

         #1001#0 = #991#0;
         #1001#1 = #991#1;
         #1001#2 = #991#2;
         |GRABA 020#1001a;
     |SINO;
         #1001#0 = #991#0;
         #1001#1 = #991#1;
         #1001#2 = #991#2;
         |GRABA 020#1001n;
     |FINSI;
     |LIBERA #1001;
     |CIERRA #1001;
     |DESCARGA_DEF #aficahor1@;

     aAlfa1 = #991#1;  |QBF aAlfa1;
     aAlfa  = "     Recogiendo Contribuyente [" + (("00000" + #991#0) % -105) + " " + aAlfa1 + "]";
     |MENSA aAlfa;

     |SI #0#39 = "S";
         |BUCLE rem00039B;
         |BUCLE rem00042B;
     |FINSI;

     |SI #0#38 = "S";  |HAZ DatosPersonales;  |FINSI;
     |SI #0#24 = "S";  |HAZ Trabajo;          |FINSI;
     |SI #0#25 = "S";  |HAZ Inmuebles;        |FINSI;
     |SI #0#26 = "S";  |HAZ Mobiliario1;      |FINSI;
     |SI #0#26 = "S";  |HAZ Mobiliario2;      |FINSI;
     |SI #0#26 = "S";  |HAZ Mobiliario3;      |FINSI;
     |SI #0#26 = "S";  |HAZ Mobiliario4;      |FINSI;
     |SI #0#26 = "S";  |HAZ Mobiliario6;      |FINSI;
     |SI #0#35 = "S";  |HAZ Actividad1;       |FINSI;
     |SI #0#35 = "S";  |HAZ Actividad2;       |FINSI;
     |SI #0#35 = "S";  |HAZ Actividad3;       |FINSI;
     |SI #0#35 = "S";  |HAZ Actividad4;       |FINSI;
     |SI #0#36 = "S";  |HAZ Anualidades;      |FINSI;
     |SI #0#36 = "S";  |HAZ TFiscal;          |FINSI;
     |SI #0#36 = "S";  |HAZ Donativos;        |FINSI;
     |SI #0#27 = "S";  |HAZ Deducciones;      |FINSI;
     |SI #0#28 = "S";  |HAZ Patrimonio;       |FINSI;
     |SI #0#39 = "S";  |HAZ BasesNegativas;   |FINSI;
     |SI #0#39 = "S";  |HAZ Pensiones;        |FINSI;
     |SI #0#39 = "S";  |HAZ ExcesoPensiones;  |FINSI;
     |SI #0#39 = "S";  |HAZ Incrementos;      |FINSI;
|FPRC;

|DEFBUCLE reacceso_2005;
     #991#1001;
     ;
     #0#2;
     #0#3;
     ;
     NULL, Pasa2006;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |ABRE #401;
     |LEE 040#401p;
     nPatrones = FSalida;
     |CIERRA #401;

     |SI nPatrones ! 0;
         |DELINDEX #401;
         |SUB_EJECUTA_NP ":basica/dspatron";
     |FINSI;

     |DBASE aBaseRenta2006;  |QBT aBaseRenta2006;

     aFichero = "repoblac";  |HAZ Auxiliares;
     aFichero = "reauxpai";  |HAZ Auxiliares;
     aFichero = "rerenpre";  |HAZ Auxiliares;
     aFichero = "reauxdiv";  |HAZ Auxiliares;
     aFichero = "reauxval";  |HAZ Auxiliares;
     aFichero = "rebancos";  |HAZ Auxiliares;

     aDef = #0#0 + "/def/reacceso.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def reacceso A쨚 2005 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aFich = #0#0 + "/" + #0#1 + "/";  |QBT aFich;
     |PATH_DAT #991 aFich;

     |SI #0#2 ! 0;
         |BUCLE reacceso_2005;
     |SINO;
         |PARA nCampo = 4;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo ! 0;
                   #0#2 = #0nCampo;
                   #0#3 = #0nCampo;
                   |BUCLE reacceso_2005;
               |FINSI;
         |SIGUE;
     |FINSI;

     |DESCARGA_DEF #aficante1@;
|FPRC;

|PROGRAMA;
     |SI enCodCli ! 0;
         |PARA nCampo = 2;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
         |SIGUE;
         |C_M #0#41, 1, "N";

         #0#2  = enCodCli;  |PINTA #0#2;
         #0#3  = enCodCli;  |PINTA #0#3;
         #0#41 = "N";

         |PINPA #0#0;
         |PINDA #0#0;
         |ENDATOS #1#0;
     |SINO;
         |MANTE #0;
     |FINSI;
|FPRO;
