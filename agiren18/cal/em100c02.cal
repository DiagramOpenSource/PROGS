|FICHEROS;
     reemi100;

     rem00016;
     rem00100;
     rem00101;
     rem00102;
     rem01001;
     rem01002;

     rerenpre;
     reauxpai;

     rem01010;
     rem01011;
     rem01012;
     rem01013;
     rem01015;

     m100h001;
     m100h004;
     m100h005;

     Referen@;
     &poblaci@;
|FIN;

|INCLUYE em100var;

|PROCESO CargaFecha;
     DiaInf   = #reemi100#33 % 102;
     MesNum   = #reemi100#33 % 402;
     MesInf   = #reemi100#33 % 402;
     EjerInf  = #reemi100#33 % -104;

     |SI MesNum = "01"; MesInf = "Enero     "; |FINSI;
     |SI MesNum = "02"; MesInf = "Febrero   "; |FINSI;
     |SI MesNum = "03"; MesInf = "Marzo     "; |FINSI;
     |SI MesNum = "04"; MesInf = "Abril     "; |FINSI;
     |SI MesNum = "05"; MesInf = "Mayo      "; |FINSI;
     |SI MesNum = "06"; MesInf = "Junio     "; |FINSI;
     |SI MesNum = "07"; MesInf = "Julio     "; |FINSI;
     |SI MesNum = "08"; MesInf = "Agosto    "; |FINSI;
     |SI MesNum = "09"; MesInf = "Septiembre"; |FINSI;
     |SI MesNum = "10"; MesInf = "Octubre   "; |FINSI;
     |SI MesNum = "11"; MesInf = "Noviembre "; |FINSI;
     |SI MesNum = "12"; MesInf = "Diciembre "; |FINSI;

     MesInf = MesInf > MesInf;
|FPRC;

|PROCESO BuscaPais;
     |ABRE #reauxpai;
     #reauxpai#0 = eaAlfa;
     |LEE 000#reauxpai.=;
     |SI FSalida = 0;
        eaAlfa = #reauxpai#2;
     |SINO;
        eaAlfa = "   ";
     |FINSI;
     |CIERRA #reauxpai;
|FPRC;

|PROCESO SeparaNombre;
     aNom = ""; aApel1 = ""; aApel2 = "";
     nInd = 1;
     aLong = eaAlfa % 0; nLong = aLong;
     aAlfa1 = "";
     |PARA nCalc = 1; |SI nCalc [ nLong; |HACIENDO nCalc = nCalc + 1;
        nPos = (nCalc * 100) + 1;
        aAlfa2 = eaAlfa % nPos;
        |SI aAlfa2 = " "; |O aAlfa2 = ",";
           |SI aAlfa1 ! "DE";  |Y aAlfa1 ! "de";
            |Y aAlfa1 ! "LA";  |Y aAlfa1 ! "la";
            |Y aAlfa1 ! "LAS"; |Y aAlfa1 ! "las";
            |Y aAlfa1 ! "LOS"; |Y aAlfa1 ! "los";
            |Y aAlfa1 ! "DEL"; |Y aAlfa1 ! "del";
              |SI nInd = 1; |Y aAlfa1 ! ""; aApel1 = aApel1 + aAlfa1 + " "; |FINSI;
              |SI nInd = 2; |Y aAlfa1 ! ""; aApel2 = aApel2 + aAlfa1 + " "; |FINSI;
              |SI nInd ] 3; |Y aAlfa1 ! ""; aNom   = aNom   + aAlfa1 + " "; |FINSI;
               nInd = nInd + 1;
           |SINO;
              |SI nInd > 1; nInd = nInd - 1; |FINSI;
              |SI nInd = 1; |Y aAlfa1 ! ""; aApel1 = aApel1 + aAlfa1 + " "; |FINSI;
              |SI nInd = 2; |Y aAlfa1 ! ""; aApel2 = aApel2 + aAlfa1 + " "; |FINSI;
              |SI nInd ] 3; |Y aAlfa1 ! ""; aNom   = aNom   + aAlfa1 + " "; |FINSI;
           |FINSI;
           aAlfa1 = "";
        |SINO;
           aAlfa1 = aAlfa1 + aAlfa2;
        |FINSI;
     |SIGUE;

     |PARA; |SI SwSalir = 0; |HACIENDO;
        SwSalir = 1;
        aAlfa1 = aApel1 % 0101;
        |SI aAlfa1 = " "; aApel1 = aApel1 % 0299; SwSalir = 0; |FINSI;
        aAlfa1 = aApel2 % 0101;
        |SI aAlfa1 = " "; aApel2 = aApel2 % 0299; SwSalir = 0; |FINSI;
        aAlfa1 = aNom   % 0101;
        |SI aAlfa1 = " "; aNom   = aNom   % 0299; SwSalir = 0; |FINSI;
     |SIGUE;
|FPRC;

|PROCESO RecogeFam;
     |SI #rem00101#4 = "DESCENDIENTE";
        nDescend = #rem00101#1; InDescend = InDescend + 1;
        |SI #rem00101#16 = "X"; |O #rem00101#16 = "Z";
           aCDoc = "1";
        |FINSI;
        |SI #rem00101#16 = "D"; |O #rem00101#16 = "Z";
           aPDec = "1";
        |FINSI;
     |SINO;
        nAscend = #rem00101#1;  InAscend = InAscend + 1;
     |FINSI;
|FPRC;

|DEFBUCLE RecogeFam;
     #rem00101#1;
     ;
     #rem00100#0, 01;
     #rem00100#0, 99;
     ;
     NULL, RecogeFam;
|FIN;

|PROCESO CargaDatos;
     eaAlfa = eaVTipo; |QBF eaAlfa;

     aSMS1      = ""; aSMS2      = "";
     aNif1      = ""; aNif2      = "";
     aApell11   = ""; aApell12   = "";
     aApell21   = ""; aApell22   = "";
     aC1        = ""; aC2        = "";
     aSg1       = ""; aSg2       = "";
     aCalle1    = ""; aCalle2    = "";
     aNumero1   = ""; aNumero2   = "";
     aEscalera1 = ""; aEscalera2 = "";
     aPiso1     = ""; aPiso2     = "";
     aPuerta1   = ""; aPuerta2   = "";
     aLocali1   = ""; aLocali2   = "";
     aLocalB1   = ""; aLocalB2   = "";
     aCP1       = ""; aCP2       = "";
     aProvin1   = ""; aProvin2   = "";
     aEC1       = ""; aEC2       = "";
     aAnyoN1    = ""; aAnyoN2    = "";
     aFNac1     = ""; aFNac2     = "";
     aSexo1     = ""; aSexo2     = "";
     aCodPais1  = "";  aCodPais2  = "";
     aMinusval1 = "0"; aMinusval2 = "";
     aTelef1    = "";  aTelef2    = "";
     aIglesia1  = "";  aIglesia2  = "";
     aMovil1    = "";  aMovil2    = "";

     aFax1      = "";  aFax2      = "";
     aTipNum1   = "";  aTipNum2   = "";
     aCalNum1   = "";  aCalNum2   = "";
     aDatComp1  = "";  aDatComp2  = "";
     aBloque1   = "";  aBloque2   = "";
     aPortal1   = "";  aPortal2   = "";
     aDomExtr1  = "";  aDomExtr2  = "";
     aDtCmpEx1  = "";  aDtCmpEx2  = "";
     aPoblExt1  = "";  aPoblExt2  = "";
     aEmailExt1 = "";  aEmailExt2 = "";
     aCPExt1    = "";  aCPExt2    = "";
     aEstExt1   = "";  aEstExt2   = "";
     aPaisExt1  = "";  aPaisExt2  = "";
     aCdPaisEx1 = "";  aCdPaisEx2 = "";
     aTlfExtr1  = "";  aTlfExtr2  = "";
     aFaxExtr1  = "";  aFaxExtr2  = "";
     aMovExtr1  = "";  aMovExtr2  = "";
     aNacExtr1  = "0"; aNacExtr2  = "0";
     aRUEExtr1  = "";  aRUEExtr2  = "";
     aCambioDom1 = ""; aCambioDom2 = "";

     aAlfa1 = eaAlfa - " FAMILIAR";
     |SI FSalida ! 0;
        aFamil = "S";
        |QBF aAlfa1; nCalc = aAlfa1;
        #rem00101#0 = #rem00100#0;
        #rem00101#1 = 1;
        |LEE 000#rem00101.];
        |PARA; |SI FSalida = 0; |Y #rem00101#0 = #rem00100#0; |HACIENDO;
           |SI #rem00101#13 = "S";
              nCalc = nCalc - 1;
              |SI nCalc = 0;
                 |SI #rem00101#6 < 33; aMinusval1 = 0; |FINSI;

                 |SI #rem00101#6 ] 33; |Y #rem00101#6 < 65; |Y #rem00101#14 = "N";
                     aMinusval1 = 1;
                 |FINSI;

                 |SI #rem00101#6 ] 33; |Y #rem00101#6 < 65; |Y #rem00101#14 = "S";
                     aMinusval1 = 2;
                 |FINSI;

                 |SI #rem00101#6 ] 65;  aMinusval1 = 3; |FINSI;
                 |SI #rem00101#6 = 100; aMinusval1 = 4; |FINSI;

                 enCodProv = #rem00100#20; enCodPobl = #rem00100#21; |HAZ LeePoblacion;
                 aNif1 = #rem00101#2;
                 eaAlfa = #rem00101#3; |HAZ SeparaNombre;
                 aApell11 = aApel1;   aApell12 = aApel2;   aNombre1  = aNom;
                 aC1        = #rem00101#16;   aSg1     = #rem00100#14;
                 aCalle1    = #rem00100#15;   aNumero1 = #rem00100#16;
                 aEscalera1 = #rem00100#17;   aPiso1   = #rem00100#18;
                 aPuerta1   = #rem00100#19;   aLocali1 = #rem00100#22;
                 aLocalB1   = #rem00100#119;
                 aCP1       = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103)
                 aProvin1   = #poblaci@#2;
                 aEC1       = "S";            aAnyoN1    = #rem00101#5;
                 aFNac1     = #rem00101#17;   aSexo1     = #rem00101#20;
                 aCodPais1  = #rem00100#107;  aTelef1    = #rem00100#12;
                 aIglesia1  = #rem00100#59;
                 eaCuenta1  = #rem00101#25;   eaBIC1     = #rem00101#26;
                 aMovil1    = #rem00100#109;  aSMS1      = #rem00100#111;
                 aFax1      = #rem00100#112;  aTipNum1   = #rem00100#114;
                 aCalNum1   = #rem00100#115;  aDatComp1  = #rem00100#118;
                 aBloque1   = #rem00100#116;  aPortal1   = #rem00100#117;
                 aDomExtr1  = #rem00100#120;  aDtCmpEx1  = #rem00100#121;
                 aPoblExt1  = #rem00100#122;  aEmailExt1 = #rem00100#123;
                 aCPExt1    = #rem00100#124;  aEstExt1   = #rem00100#125;
                 aNacExtr1  = #rem00100#150;  aRUEExtr1  = #rem00100#157;
                 aPaisExt1  = #rem00100#127;

                 aCambioDom1 = "N";
                 |SI #rem00101#16 = "X";
                    aCambioDom1 = "S";
                 |FINSI;

                 |ABRE #reauxpai;
                 #reauxpai#0 = #rem00100#126;
                 |LEE 000#reauxpai.=;
                 |SI FSalida = 0; aCdPaisEx1 = #reauxpai#2; |SINO; aCdPaisEx1 = ""; |FINSI;
                 |CIERRA #reauxpai;
                 aTlfExtr1  = #rem00100#12;   aFaxExtr1  = #rem00100#112;
                 aMovExtr1  = #rem00100#109;
              |SINO;
                 |LEE 000#rem00101.s;
              |FINSI;
           |SINO;
              |LEE 000#rem00101.s;
           |FINSI;
        |SIGUE;

        eaAlfa = eaCuenta1; |QBF eaAlfa;
        |SI eaAlfa = ""; eaCuenta1 = " " * 34;  |FINSI;

        eaAlfa = eaBIC1; |QBF eaAlfa;
        |SI eaAlfa = ""; eaBIC1 = " " * 11;  |FINSI;

        eaAlfa = aCodPais1; |HAZ BuscaPais; aCodPais1 = eaAlfa;

        |SI aSexo1 = "V"; aSexo1 = "H"; |FINSI;
        |SI aSexo1 = "";  aSexo1 = " "; |FINSI;
        |SI aSexo2 = "V"; aSexo2 = "H"; |FINSI;
        |SI aSexo2 = "";  aSexo2 = " "; |FINSI;
        |ACABA;
     |SINO;
        aFamil = "N";
     |FINSI;

     |SI eaAlfa = "TITULAR"; |O eaAlfa = "CONJUNTA";
        |SI #rem00100#8 < 33; aMinusval1 = 0; |FINSI;

        |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "N";
            aMinusval1 = 1;
        |FINSI;

        |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "S";
            aMinusval1 = 2;
        |FINSI;

        |SI #rem00100#8 ] 65;  aMinusval1 = 3; |FINSI;
        |SI #rem00100#8 = 100; aMinusval1 = 4; |FINSI;

        enCodProv = #rem00100#20; enCodPobl = #rem00100#21; |HAZ LeePoblacion;
        aNif1      = #rem00100#1;    aNombre1 = #rem00100#4;
        aApell11   = #rem00100#2;    aApell12 = #rem00100#3;
        aC1        = #rem00100#100;  aSg1     = #rem00100#14;
        aCalle1    = #rem00100#15;   aNumero1 = #rem00100#16;
        aEscalera1 = #rem00100#17;   aPiso1   = #rem00100#18;
        aPuerta1   = #rem00100#19;   aLocali1 = #rem00100#22;
        aLocalB1   = #rem00100#119;
        aCP1       = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103)
        aProvin1   = #poblaci@#2;
        aEC1       = #rem00100#6;    aAnyoN1  = #rem00100#7;
        aFNac1     = #rem00100#103;  aSexo1   = #rem00100#105;
        aCodPais1  = #rem00100#107;  aTelef1  = #rem00100#12;
        aIglesia1  = #rem00100#59;   aMovil1  = #rem00100#109;
        aSMS1      = #rem00100#111;
        aFax1      = #rem00100#112;  aTipNum1   = #rem00100#114;
        aCalNum1   = #rem00100#115;  aDatComp1  = #rem00100#118;
        aBloque1   = #rem00100#116;  aPortal1   = #rem00100#117;
        aDomExtr1  = #rem00100#120;  aDtCmpEx1  = #rem00100#121;
        aPoblExt1  = #rem00100#122;  aEmailExt1 = #rem00100#123;
        aCPExt1    = #rem00100#124;  aEstExt1   = #rem00100#125;
        aNacExtr1  = #rem00100#150;  aRUEExtr1  = #rem00100#157;
        aPaisExt1  = #rem00100#127;
        aCambioDom1 = #rem00100#145;

        |ABRE #reauxpai;
        #reauxpai#0 = #rem00100#126;
        |LEE 000#reauxpai.=;
        |SI FSalida = 0; aCdPaisEx1 = #reauxpai#2; |SINO; aCdPaisEx1 = ""; |FINSI;
        |CIERRA #reauxpai;
        aTlfExtr1  = #rem00100#12;   aFaxExtr1  = #rem00100#112;
        aMovExtr1  = #rem00100#109;
        |SI eaAlfa = "TITULAR";
            eaCuenta1  = #rem00100#147;
            eaBIC1     = #rem00100#154;
        |FINSI;

        |SI eaAlfa = "CONJUNTA";
            eaCuenta1  = #rem00100#149;
            eaBIC1     = #rem00100#156;
        |FINSI;

        |SI #rem00100#41 < 33; aMinusval2 = 0; |FINSI;

        |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "N";
            aMinusval2 = 1;
        |FINSI;

        |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "S";
            aMinusval2 = 2;
        |FINSI;

        |SI #rem00100#41 ] 65;  aMinusval2 = 3; |FINSI;
        |SI #rem00100#41 = 100; aMinusval2 = 4; |FINSI;

        enCodProv = #rem00100#50; enCodPobl = #rem00100#51; |HAZ LeePoblacion;
        aNif2      = #rem00100#35;   aNombre2 = #rem00100#38;
        aApell21   = #rem00100#36;   aApell22 = #rem00100#37;
        aC2        = #rem00100#101;  aSg2     = #rem00100#44;
        aCalle2    = #rem00100#45;   aNumero2 = #rem00100#46;
        aEscalera2 = #rem00100#47;   aPiso2   = #rem00100#48;
        aPuerta2   = #rem00100#49;   aLocali2 = #rem00100#52;
        aLocalB2   = #rem00100#136;
        aCP2       = (("00" + #rem00100#50) % -102) + (("000" + #rem00100#51) % -103);
        aProvin2   = #poblaci@#2;         aAnyoN2   = #rem00100#40;
        aFNac2     = #rem00100#104;  aCodPais2 = #rem00100#108;
        aTelef2    = #rem00100#13;   aSexo2 = #rem00100#106;
        aIglesia2  = #rem00100#60;   aMovil2  = #rem00100#110;
        aSMS2      = #rem00100#128;
        aFax2      = #rem00100#129;  aTipNum2   = #rem00100#131;
        aCalNum2   = #rem00100#132;  aDatComp2  = #rem00100#135;
        aBloque2   = #rem00100#133;  aPortal2   = #rem00100#134;
        aDomExtr2  = #rem00100#137;  aDtCmpEx2  = #rem00100#138;
        aPoblExt2  = #rem00100#139;  aEmailExt2 = #rem00100#140;
        aCPExt2    = #rem00100#141;  aEstExt2   = #rem00100#142;
        aPaisExt2  = #rem00100#144;  aCambioDom2 = #rem00100#146;
        aNacExtr2  = #rem00100#152;  aRUEExtr1  = #rem00100#158;
        |ABRE #reauxpai;
        #reauxpai#0 = #rem00100#143;
        |LEE 000#reauxpai.=;
        |SI FSalida = 0; aCdPaisEx2 = #reauxpai#2; |SINO; aCdPaisEx2 = ""; |FINSI;
        |CIERRA #reauxpai;
        aTlfExtr2  = #rem00100#13;   aFaxExtr2  = #rem00100#129;
        aMovExtr2  = #rem00100#110;

        |SI eaAlfa = "TITULAR";
            eaCuenta2  = #rem00100#148;
            eaBIC2     = #rem00100#155;
        |FINSI;

        |SI eaAlfa = "CONJUNTA";
            eaCuenta2  = #rem00100#149;
            eaBIC2     = #rem00100#156;
        |FINSI;

        |SI #rem00100#91 = "C";
           aEC1 = "V";
           aNif2      = "";   aNombre2 = "";
           aApell21   = "";   aApell22 = "";
           aC2        = "";   aSg2     = "";
           aCalle2    = "";   aNumero2 = "";
           aEscalera2 = "";   aPiso2   = "";
           aPuerta2   = "";   aLocali2 = "";
           aCP2       = "";   aSexo2   = "";
           aProvin2   = "";   aAnyoN2   = "";
           aFNac2     = "";   aCodPais2 = "";
           aMinusval2 = "0";  aTelef2   = "";
           aMovil2    = "";   aFax2 = "";
           aTipNum2   = "";   aCalNum2   = "";
           aDatComp2  = "";   aBloque2   = "";
           aPortal2   = "";   aDomExtr2  = "";
           aDtCmpEx2  = "";   aPoblExt2  = "";
           aEmailExt2 = "";   aCPExt2    = "";
           aEstExt2   = "";   aPaisExt2  = "";
           aCdPaisEx2 = "";   aTlfExtr2  = "";
           aFaxExtr2  = "";   aMovExtr2  = "";
           aNacExtr2  = "0";  aRUEExtr2  = "0";
           aCambioDom2 = "";
        |FINSI;

        |QBF aNif2;  |QBF aNombre2;
        |SI aNif2 = "";   |Y aNombre2 = "";
            aCambioDom2 = "";
        |FINSI;

     |FINSI;

     |SI eaAlfa = "CONYUGE";
        |SI #rem00100#41 < 33; aMinusval1 = 0; |FINSI;

        |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "N";
            aMinusval1 = 1;
        |FINSI;

        |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "S";
            aMinusval1 = 2;
        |FINSI;

        |SI #rem00100#41 ] 65;  aMinusval1 = 3; |FINSI;

        |SI #rem00100#41 = 100; aMinusval1 = 4; |FINSI;

        enCodProv  = #rem00100#50;   enCodPobl = #rem00100#51; |HAZ LeePoblacion;
        aNif1      = #rem00100#35;   aNombre1 = #rem00100#38;
        aApell11   = #rem00100#36;   aApell12 = #rem00100#37;
        aC1        = #rem00100#101;  aSg1     = #rem00100#44;
        aCalle1    = #rem00100#45;   aNumero1 = #rem00100#46;
        aEscalera1 = #rem00100#47;   aPiso1   = #rem00100#48;
        aPuerta1   = #rem00100#49;   aLocali1 = #rem00100#52;
        aLocalB1   = #rem00100#136;
        aCP1       = (("00" + #rem00100#50) % -102) + (("000" + #rem00100#51) % -103);
        aEC1       = #rem00100#6;
        aProvin1   = #poblaci@#2;         aAnyoN1  = #rem00100#40;
        aFNac1     = #rem00100#104;  aSexo1   = #rem00100#106;
        aCodPais1  = #rem00100#108;  aTelef1  = #rem00100#13;
        aIglesia1  = #rem00100#60;
        eaCuenta1  = #rem00100#148;  eaBIC2     = #rem00100#155;
        aMovil1    = #rem00100#110;  aSMS1      = #rem00100#128;
        aFax1      = #rem00100#129;  aTipNum1   = #rem00100#131;
        aCalNum1   = #rem00100#132;  aDatComp1  = #rem00100#135;
        aBloque1   = #rem00100#133;  aPortal1   = #rem00100#134;
        aDomExtr1  = #rem00100#137;  aDtCmpEx1  = #rem00100#138;
        aPoblExt1  = #rem00100#139;  aEmailExt1 = #rem00100#140;
        aCPExt1    = #rem00100#141;  aEstExt1   = #rem00100#142;
        aPaisExt1  = #rem00100#144;  aCambioDom1 = #rem00100#146;
        aNacExtr1  = #rem00100#152;  aRUEExtr1  = #rem00100#158;
        |ABRE #reauxpai;
        #reauxpai#0 = #rem00100#143;
        |LEE 000#reauxpai.=;
        |SI FSalida = 0; aCdPaisEx1 = #reauxpai#2; |SINO; aCdPaisEx1 = ""; |FINSI;
        |CIERRA #reauxpai;
        aTlfExtr1  = #rem00100#13;   aFaxExtr1  = #rem00100#129;
        aMovExtr1  = #rem00100#110;

        |SI #rem00100#8 < 33; aMinusval2 = 0; |FINSI;

        |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "N";
            aMinusval2 = 1;
        |FINSI;

        |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "S";
            aMinusval2 = 2;
        |FINSI;

        |SI #rem00100#8 ] 65;  aMinusval2 = 3; |FINSI;
        |SI #rem00100#8 = 100; aMinusval2 = 4; |FINSI;

        enCodProv = #rem00100#20; enCodPobl = #rem00100#21; |HAZ LeePoblacion;
        aNif2      = #rem00100#1;    aNombre2 = #rem00100#4;
        aApell21   = #rem00100#2;    aApell22 = #rem00100#3;
        aC2        = #rem00100#100;  aSg2     = #rem00100#14;
        aCalle2    = #rem00100#15;   aNumero2 = #rem00100#16;
        aEscalera2 = #rem00100#17;   aPiso2   = #rem00100#18;
        aPuerta2   = #rem00100#19;   aLocali2 = #rem00100#22;
        aLocalB2   = #rem00100#119;
        aCP2       = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103);
        aProvin2   = #poblaci@#2;    aAnyoN2    = #rem00100#7;
        aFNac2     = #rem00100#103;  aCodPais2  = #rem00100#107;
        aTelef2    = #rem00100#12;   aSexo2     = #rem00100#105;
        aIglesia2  = #rem00100#59;
        eaCuenta2  = #rem00100#147;  eaBIC2     = #rem00100#154;
        aMovil2    = #rem00100#109;  aSMS2      = #rem00100#111;
        aFax2      = #rem00100#112;  aTipNum2   = #rem00100#114;
        aCalNum2   = #rem00100#115;  aDatComp2  = #rem00100#118;
        aBloque2   = #rem00100#116;  aPortal2   = #rem00100#117;
        aDomExtr2  = #rem00100#120;  aDtCmpEx2  = #rem00100#121;
        aPoblExt2  = #rem00100#122;  aEmailExt2 = #rem00100#123;
        aCPExt2    = #rem00100#124;  aEstExt2   = #rem00100#125;
        aPaisExt2  = #rem00100#127;  aCambioDom2 = #rem00100#145;
        aNacExtr2  = #rem00100#150;  aRUEExtr2  = #rem00100#157;
        |ABRE #reauxpai;
        #reauxpai#0 = #rem00100#126;
        |LEE 000#reauxpai.=;
        |SI FSalida = 0; aCdPaisEx2 = #reauxpai#2; |SINO; aCdPaisEx2 = ""; |FINSI;
        |CIERRA #reauxpai;
        aTlfExtr2  = #rem00100#12;   aFaxExtr2  = #rem00100#112;
        aMovExtr2  = #rem00100#109;
        |SI #rem00100#91 = "T";
           aEC1 = "V";

           aNif2      = "";   aNombre2 = "";
           aApell21   = "";   aApell22 = "";
           aC2        = "";   aSg2     = "";
           aCalle2    = "";   aNumero2 = "";
           aEscalera2 = "";   aPiso2   = "";
           aPuerta2   = "";   aLocali2 = "";
           aCP2       = "";   aSexo2   = "";
           aProvin2   = "";   aAnyoN2   = "";
           aFNac2     = "";   aCodPais2 = "";
           aMinusval2 = "0";  aTelef2   = "";
           aMovil2    = ""; aFax2 = "";
           aTipNum2   = "";   aCalNum2   = "";
           aDatComp2  = "";   aBloque2   = "";
           aPortal2   = "";   aDomExtr2  = "";
           aDtCmpEx2  = "";   aPoblExt2  = "";
           aEmailExt2 = "";   aCPExt2    = "";
           aEstExt2   = "";   aPaisExt2  = "";
           aCdPaisEx2 = "";   aTlfExtr2  = "";
           aFaxExtr2  = "";   aMovExtr2  = "";
           aNacExtr2  = "0";  aRUEExtr2  = "";
           aCambioDom2 = "";
        |FINSI;
     |FINSI;

     |SI eaAlfa = "CONJUNTAE";
        |SI #rem00100#91 = "T";
           |SI #rem00100#41 < 33; aMinusval1 = 0; |FINSI;

           |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "N";
               aMinusval1 = 1;
           |FINSI;

           |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "S";
               aMinusval1 = 2;
           |FINSI;

           |SI #rem00100#41 ] 65;  aMinusval1 = 3; |FINSI;
           |SI #rem00100#41 = 100; aMinusval1 = 4; |FINSI;

           enCodProv = #rem00100#50; enCodPobl = #rem00100#51; |HAZ LeePoblacion;
           aNif1      = #rem00100#35;   aNombre1 = #rem00100#38;
           aApell11   = #rem00100#36;   aApell12 = #rem00100#37;
           aC1        = #rem00100#101;  aSg1     = #rem00100#44;
           aCalle1    = #rem00100#45;   aNumero1 = #rem00100#46;
           aEscalera1 = #rem00100#47;   aPiso1   = #rem00100#48;
           aPuerta1   = #rem00100#49;   aLocali1 = #rem00100#52;
           aLocalB1   = #rem00100#136;
           aCP1       = (("00" + #rem00100#50) % -102) + (("000" + #rem00100#51) % -103);
           aEC1       = "V";            aSexo1     = #rem00100#106;
           aProvin1   = #poblaci@#2;    aAnyoN1    = #rem00100#40;
           aFNac1     = #rem00100#104;  aCodPais1  = #rem00100#108;
           aTelef1    = #rem00100#13;   aMovil1    = #rem00100#110;
           aIglesia1  = #rem00100#60;
           eaCuenta1  = #rem00100#148;  eaBIC1     = #rem00100#155;
           aSMS1      = #rem00100#128;
           aFax1      = #rem00100#129;  aTipNum1   = #rem00100#131;
           aCalNum1   = #rem00100#132;  aDatComp1  = #rem00100#135;
           aBloque1   = #rem00100#133;  aPortal1   = #rem00100#134;
           aDomExtr1  = #rem00100#137;  aDtCmpEx1  = #rem00100#138;
           aPoblExt1  = #rem00100#139;  aEmailExt1 = #rem00100#140;
           aCPExt1    = #rem00100#141;  aEstExt1   = #rem00100#142;
           aPaisExt1  = #rem00100#144;  aCambioDom1 = #rem00100#146;
           aNacExtr1  = #rem00100#152;  aRUEExtr1  = #rem00100#158;
           |ABRE #reauxpai;
           #reauxpai#0 = #rem00100#143;
           |LEE 000#reauxpai.=;
           |SI FSalida = 0; aCdPaisEx1 = #reauxpai#2; |SINO; aCdPaisEx1 = ""; |FINSI;
           |CIERRA #reauxpai;

           aTlfExtr1  = #rem00100#13;   aFaxExtr1  = #rem00100#129;
           aMovExtr1  = #rem00100#110;
        |SINO;
           |SI #rem00100#8 < 33; aMinusval1 = 0; |FINSI;

           |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "N";
               aMinusval1 = 1;
           |FINSI;

           |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "S";
               aMinusval1 = 2;
           |FINSI;

           |SI #rem00100#8 ] 65;  aMinusval1 = 3; |FINSI;
           |SI #rem00100#8 = 100; aMinusval1 = 4; |FINSI;

           enCodProv = #rem00100#20; enCodPobl = #rem00100#21; |HAZ LeePoblacion;
           aNif1      = #rem00100#1;    aNombre1 = #rem00100#4;
           aApell11   = #rem00100#2;    aApell12 = #rem00100#3;
           aC1        = #rem00100#100;  aSg1     = #rem00100#14;
           aCalle1    = #rem00100#15;   aNumero1 = #rem00100#16;
           aEscalera1 = #rem00100#17;   aPiso1   = #rem00100#18;
           aPuerta1   = #rem00100#19;   aLocali1 = #rem00100#22;
           aLocalB1   = #rem00100#119;
           aCP1       = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103);
           aProvin1   = #poblaci@#2;
           aEC1       = "V";            aAnyoN1   = #rem00100#7;
           aFNac1     = #rem00100#103;  aSexo1     = #rem00100#105;
           aCodPais1  = #rem00100#107;  aTelef1    = #rem00100#12;
           aIglesia1  = #rem00100#60;
           eaCuenta1  = #rem00100#147;  eaBIC1     = #rem00100#154;
           aMovil1    = #rem00100#109;  aSMS1      = #rem00100#111;
           aFax1      = #rem00100#112;  aTipNum1   = #rem00100#114;
           aCalNum1   = #rem00100#115;  aDatComp1  = #rem00100#118;
           aBloque1   = #rem00100#116;  aPortal1   = #rem00100#117;
           aDomExtr1  = #rem00100#120;  aDtCmpEx1  = #rem00100#121;
           aPoblExt1  = #rem00100#122;  aEmailExt1 = #rem00100#123;
           aCPExt1    = #rem00100#124;  aEstExt1   = #rem00100#125;
           aPaisExt1  = #rem00100#127;  aCdPaisEx1 = #rem00100#126;
           aNacExtr1  = #rem00100#150;  aRUEExtr1  = #rem00100#157;
           aCambioDom1 = #rem00100#145;
           |ABRE #reauxpai;
           #reauxpai#0 = #rem00100#126;
           |LEE 000#reauxpai.=;
           |SI FSalida = 0; aCdPaisEx1 = #reauxpai#2; |SINO; aCdPaisEx1 = ""; |FINSI;
           |CIERRA #reauxpai;
           aTlfExtr1  = #rem00100#12;   aFaxExtr1  = #rem00100#112;
           aMovExtr1  = #rem00100#109;
        |FINSI;
        aNif2      = "";   aNombre2 = "";
        aApell21   = "";   aApell22 = "";
        aC2        = "";   aSg2     = "";
        aCalle2    = "";   aNumero2 = "";
        aEscalera2 = "";   aPiso2   = "";
        aPuerta2   = "";   aLocali2 = "";
        aLocalB2   = "";
        aCP2       = "";   aSMS2    = "";
        aProvin2   = "";   aAnyoN2  = "";
        aMinusval2 = "0";  aTelef2  = "";
        aIglesia2  = "";
        eaCuenta2  = "";   eaBIC2     = "";
        aMovil2    = "";   aSexo2     = "";
        aFax2      = "";
        aTipNum2   = "";   aCalNum2   = "";
        aDatComp2  = "";   aBloque2   = "";
        aPortal2   = "";   aDomExtr2  = "";
        aDtCmpEx2  = "";   aPoblExt2  = "";
        aEmailExt2 = "";   aCPExt2    = "";
        aEstExt2   = "";   aPaisExt2  = "";
        aCdPaisEx2 = "";   aTlfExtr2  = "";
        aFaxExtr2  = "";   aMovExtr2  = "";
        aNacExtr2  = "0";  aRUEExtr2  = "";
        aCambioDom2 = "";
     |FINSI;

     |SI eaAlfa = "TITULAR"; |O eaAlfa = "CONYUGE";
         aCambioDom2 = "";
     |FINSI;

     eaAlfa = eaCuenta1; |QBF eaAlfa;
     |SI eaAlfa = "";  eaCuenta1 = " " * 34;  |FINSI;

     eaAlfa = eaCuenta2; |QBF eaAlfa;
     |SI eaAlfa = ""; eaCuenta2 = " " * 34; |FINSI;

     eaAlfa = eaBIC1; |QBF eaAlfa;
     |SI eaAlfa = "";  eaBIC1 = " " * 11;  |FINSI;

     eaAlfa = eaBIC2; |QBF eaAlfa;
     |SI eaAlfa = ""; eaBIC2 = " " * 11; |FINSI;

     |QBF aTelef1; |QBF aTelef2;

     |SI aC1 = "X"; |O aC1 = "Z";
        |SI aTelef1 = ""; aTelef1 = aTelef2; |FINSI;
     |FINSI;
     |SI aC2 = "X"; |O aC2 = "Z";
        |SI aTelef2 = ""; aTelef2 = aTelef1; |FINSI;
     |FINSI;

     |SI #reemi100#34 = "F";
        |SI aC1 = "X";  |O aC1 = "Z";
           aSg1     = ""; aCalle1  = ""; aNumero1 = ""; aEscalera1 = "";
           aPiso1   = ""; aPuerta1 = ""; aLocali1 = ""; aCP1       = "";
           aProvin1 = "";                aFNac1   = ""; aSexo1     = "";
           aCodPais1  = ""; aMovil1 = "";
        |FINSI;
        |SI aC2 = "X"; |O aC2 = "Z";
           aSg2     = ""; aCalle2  = ""; aNumero2 = ""; aEscalera2 = "";
           aPiso2   = ""; aPuerta2 = ""; aLocali2 = ""; aCP2       = "";
           aProvin2 = ""; aSexo2   = ""; aFNac2   = ""; aCodPais2  = "";
           aMovil2  = "";
        |FINSI;
     |FINSI;

     eaAlfa = aCodPais1; |HAZ BuscaPais; aCodPais1 = eaAlfa;
     eaAlfa = aCodPais2; |HAZ BuscaPais; aCodPais2 = eaAlfa;

     eaTDato = "F"; eaAlfa = aFNac1; |HAZ FormatoCmp; aFNac1 = eaAlfa;
     eaTDato = "F"; eaAlfa = aFNac2; |HAZ FormatoCmp; aFNac2 = eaAlfa;
     eaTDato = "F"; eaAlfa = aFNacH; |HAZ FormatoCmp; aFNacH = eaAlfa;
     eaTDato = "F"; eaAlfa = aFAdoH; |HAZ FormatoCmp; aFAdoH = eaAlfa;
     |SI aFNac1 = "          "; aFNac1 = "00000000"; |FINSI;
     |SI aFNac2 = "          "; aFNac2 = "00000000"; |FINSI;
     |SI aFNacH = "          "; aFNacH = "00000000"; |FINSI;
     |SI aFAdoH = "          "; aFAdoH = "00000000"; |FINSI;

     |SI aSexo1 = "V"; aSexo1 = "H"; |FINSI;
     |SI aSexo1 = "";  aSexo1 = " "; |FINSI;
     |SI aSexo2 = "V"; aSexo2 = "H"; |FINSI;
     |SI aSexo2 = "";  aSexo2 = " "; |FINSI;

     nCambia = 0;
     |SI aSg1 ! aSg2; |O aCalle1 ! aCalle2; |O aNumero1 ! aNumero2;
      |O aEscalera1 ! aEscalera2; |O aPiso1 ! aPiso2; |O aPuerta1 ! aPuerta2;
      |O aLocali1 ! aLocali2;
        nCambia = 1;
     |FINSI;

     eaAlfa = eaVTipo; |QBF eaAlfa;
     |SI eaAlfa = "CONJUNTA"; |O eaAlfa = "CONJUNTAE";
        |SI nCambia = 0;
           aSg2       = ""; aCalle2    = "";
           aNumero2   = ""; aEscalera2 = "";
           aPiso2     = ""; aPuerta2   = ""; aLocali2   = "";
           aLocalB2   = ""; aCP2       = ""; aProvin2   = "";
           aCodPais2  = ""; aTipNum2   = ""; aCalNum2   = "";
           aDatComp2  = ""; aBloque2   = ""; aPortal2   = "";
           aDomExtr2  = ""; aDtCmpEx2  = ""; aPoblExt2  = "";
           aCPExt2    = ""; aEstExt2   = "";
           aPaisExt2  = ""; aCdPaisEx2 = "";
           aNacExtr2  = "0";aRUEExtr2  = "";
        |FINSI;
     |FINSI;

     |SI eaAlfa ! "CONJUNTA"; |Y eaAlfa ! "CONJUNTAE";
        aSg2       = ""; aCalle2    = "";
        aNumero2   = ""; aEscalera2 = "";
        aPiso2     = ""; aPuerta2   = ""; aLocali2   = "";
        aLocalB2   = ""; aCP2       = ""; aProvin2   = "";
        aCodPais2  = ""; aTipNum2   = ""; aCalNum2   = "";
        aDatComp2  = ""; aBloque2   = ""; aPortal2   = "";
        aDomExtr2  = ""; aDtCmpEx2  = ""; aPoblExt2  = "";
        aCPExt2    = ""; aEstExt2   = "";
        aPaisExt2  = ""; aCdPaisEx2 = "";
        aNacExtr2  = "0";aRUEExtr2  = "";
     |FINSI;

     |QBF aApell11;  |QBF aApell12;  |QBF aNombre1;
     |QBF aApell21;  |QBF aApell22;  |QBF aNombre2;

     |QBF aCP1;
     |SI aCP1 = ""; aCP1 = "00000"; |FINSI;

     |QBF aCP2;
     |SI aCP2 = ""; aCP2 = "00000"; |FINSI;
|FPRC;

|PROCESO Inicializa;
     eaVTipo = eaTipo;
     aTipo = eaVTipo % 0110;

     |SI #rem00100#91 = "C"; |Y #m100h001#12 = "2";
        |SI aTipo = "TITULAR   "; |O aTipo = "CONJUNTA  "; |O aTipo = "CONJUNTAE ";
           #m100h001#12 = "3";

           aNif2      = ""; aApell21   = "";
           aApell22   = ""; aC2        = "";
           aSg2       = ""; aCalle2    = "";
           aNumero2   = ""; aEscalera2 = "";
           aPiso2     = ""; aPuerta2   = "";
           aLocali2   = ""; aCP2       = "";
           aProvin2   = ""; aEC2       = "";
           aAnyoN2    = ""; aFNac2     = "";
           aCodPais2  = ""; aMinusval2 = "";
           aTelef2    = ""; aIglesia2  = "";
           aNombre2   = ""; aSexo2     = " ";
           aMovil2    = ""; aFax2      = "";
           aTipNum2   = ""; aCalNum2   = "";
           aDatComp2  = ""; aBloque2   = "";
           aPortal2   = ""; aDomExtr2  = "";
           aDtCmpEx2  = ""; aPoblExt2  = "";
           aEmailExt2 = ""; aCPExt2    = "";
           aEstExt2   = ""; aPaisExt2  = "";
           aCdPaisEx2 = ""; aTlfExtr2  = "";
           aFaxExtr2  = ""; aMovExtr2  = "";
           aNacExtr2  = "0";aRUEExtr2  = "";
           aCambioDom2 = "";
        |FINSI;
     |FINSI;

     |SI #rem00100#91 = "T"; |Y #m100h001#12 = "2";
        |SI aTipo = "CONYUGE   "; |O aTipo = "CONJUNTAE ";
           #m100h001#12 = "3";

           aNif2      = ""; aApell21   = "";
           aApell22   = ""; aC2        = "";
           aSg2       = ""; aCalle2    = "";
           aNumero2   = ""; aEscalera2 = "";
           aPiso2     = ""; aPuerta2   = "";
           aLocali2   = ""; aCP2       = "";
           aProvin2   = ""; aEC2       = "";
           aAnyoN2    = ""; aFNac2     = "";
           aCodPais2  = ""; aMinusval2 = "";
           aTelef2    = ""; aIglesia2  = "";
           aNombre2   = ""; aSexo2     = " ";
           aMovil2    = ""; aFax2      = "";
           aTipNum2   = ""; aCalNum2   = "";
           aDatComp2  = ""; aBloque2   = "";
           aPortal2   = ""; aDomExtr2  = "";
           aDtCmpEx2  = ""; aPoblExt2  = "";
           aEmailExt2 = ""; aCPExt2    = "";
           aEstExt2   = ""; aPaisExt2  = "";
           aCdPaisEx2 = ""; aTlfExtr2  = "";
           aFaxExtr2  = ""; aMovExtr2  = "";
           aNacExtr2  = "0";aRUEExtr2  = "";
           aCambioDom2 = "";
        |FINSI;
     |FINSI;
|FPRC;

|PROCESO MiraViv;
     nDat   = 0;
     aRfC   = "";
     aTit   = "";
     nPc1   = "";
     nPc2   = "";
     aSit   = "";

     aAlfa1 = aTipo;       |QBF aAlfa1;
     aAlfa2 = #rem00102#2; |QBF aAlfa2;
     |SI aAlfa1 = aAlfa2;
         aTit = #rem00102#9;
         nPc1 = 0;
         nPc2 = 0;
         aRfC = #rem00102#11;
         aSit = #rem00102#14;

         |SI aTit = "3";  |O aTit = "4";
             nDat = 1;
         |FINSI;

         |SI aTit = "1";  |O aTit = "2";
             nPc1 = 100;
             nDat = 1;
         |FINSI;

         |ACABA;
     |FINSI;

     eaAlfa = #rem00102#2; |QBF eaAlfa;
     eaAlfa = eaAlfa - "FAMILIAR";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI aTipo = "TITULAR";  |O aTipo = "CONJUNTA";
         aTit = #rem00102#9;
         aRfC = #rem00102#11;
         aSit = #rem00102#14;

         |SI #rem00100#91 = " ";
             |SI #rem00102#2 = "TITULAR   "; nPc1 = 100; nPc2 = 0;   |FINSI;
             |SI #rem00102#2 = "CONYUGE   "; nPc1 = 0;   nPc2 = 100; |FINSI;
             |SI #rem00102#2 = "GANANCIAL "; nPc1 = 50;  nPc2 = 50;  |FINSI;
             |SI #rem00102#2 = "VARIOS    ";
                 nPc1 = #rem00102#3;
                 nPc2 = #rem00102#4;
             |FINSI;
         |SINO;
             |SI #rem00102#2 = "TITULAR   "; nPc1 = 100;             |FINSI;
             |SI #rem00102#2 = "GANANCIAL "; nPc1 = 50;              |FINSI;
             |SI #rem00102#2 = "VARIOS    "; nPc1 = #rem00102#3;     |FINSI;
         |FINSI;

         |SI aTit = "3";  |O aTit = "4";
             nDat = 1;
         |FINSI;

         |SI aTit = "1";  |O aTit = "2";
             |SI nPc1 ! 0;  |O nPc2 ! 0;
                 nDat = 1;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI aTipo = "CONYUGE";
         aTit = #rem00102#9;
         aRfC = #rem00102#11;
         aSit = #rem00102#14;

         |SI #rem00100#91 = " ";
             |SI #rem00102#2 = "TITULAR   "; nPc1 = 0;   nPc2 = 100; |FINSI;
             |SI #rem00102#2 = "CONYUGE   "; nPc1 = 100; nPc2 = 0;   |FINSI;
             |SI #rem00102#2 = "GANANCIAL "; nPc1 = 50;  nPc2 = 50;  |FINSI;
             |SI #rem00102#2 = "VARIOS    ";
                 nPc1 = #rem00102#4;
                 nPc2 = #rem00102#3;
             |FINSI;
         |SINO;
             |SI #rem00102#2 = "CONYUGE   "; nPc1 = 100;             |FINSI;
             |SI #rem00102#2 = "GANANCIAL "; nPc1 = 50;              |FINSI;
             |SI #rem00102#2 = "VARIOS    "; nPc1 = #rem00102#4;     |FINSI;
         |FINSI;

         |SI aTit = "3";  |O aTit = "4";
             nDat = 1;
         |FINSI;

         |SI aTit = "1";  |O aTit = "2";
             |SI nPc1 ! 0;  |O nPc2 ! 0;
                 nDat = 1;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI aTipo = "CONJUNTAE";
         aTit = #rem00102#9;
         aRfC  = #rem00102#11;
         aSit = #rem00102#14;
         |SI #rem00100#91 = " ";
             aTit = #rem00102#9;
             |SI #rem00102#2 = "TITULAR   "; nPc1 = 100; nPc2 = 0;   |FINSI;
             |SI #rem00102#2 = "CONYUGE   "; nPc1 = 0;   nPc2 = 100; |FINSI;
             |SI #rem00102#2 = "GANANCIAL "; nPc1 = 50;  nPc2 = 50;  |FINSI;
             |SI #rem00102#2 = "VARIOS    ";
                 nPc1 = #rem00102#3;
                 nPc2 = #rem00102#4;
             |FINSI;
          |SINO;
             |SI #rem00100#91 = "C";
                 |SI #rem00102#2 = "TITULAR   "; nPc1 = 100; nPc2 = 0; |FINSI;
                 |SI #rem00102#2 = "GANANCIAL "; nPc1 = 50;            |FINSI;
                 |SI #rem00102#2 = "VARIOS    "; nPc1 = #rem00102#3;   |FINSI;
             |FINSI;

             |SI #rem00100#91 = "T";
                 |SI #rem00102#2 = "CONYUGE   "; nPc1 = 100; nPc2 = 0; |FINSI;
                 |SI #rem00102#2 = "GANANCIAL "; nPc1 = 50;            |FINSI;
                 |SI #rem00102#2 = "VARIOS    "; nPc1 = #rem00102#4;   |FINSI;
             |FINSI;
         |FINSI;

         |SI aTit = "3";  |O aTit = "4";
             nDat = 1;
         |FINSI;

         |SI aTit = "1";  |O aTit = "2";
             |SI nPc1 ! 0;  |O nPc2 ! 0;
                 nDat = 1;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI aTit = "3";  |O aTit = "4";
         nPc1 = 0;
         nPc2 = 0;
     |FINSI;
|FPRC;

|PROCESO rem00102;
     |HAZ MiraViv;
     |SI nDat = 0;  |ACABA;  |FINSI;

     nLinea = nLinea + 1;
     |SI nLinea > 8;
         |ERROR10;
         |ACABA;
     |FINSI;

     |SI aTit = "3";
         |SI aNifArrend = "";  |Y aNifArrendEx = "";
             |SI #rem00102#16 = "S";
                 aNifArrend = #rem00102#15 % 109; |QBF aNifArrend;
             |SINO;
                 aNifArrendEx = #rem00102#15; |QBF aNifArrendEx;
             |FINSI;
         |FINSI;
     |FINSI;

     nCampo = 43 + ((nLinea - 1) * 5);  #m100h001#nCampo# = aTit;

     enLongDec = 2; eaTDato = "N"; enLong = 3;  eaAlfa = nPc1;  |HAZ FormatoCmp;
     nCampo  = nCampo + 1;  #m100h001#nCampo# = eaAlfa;

     enLongDec = 2; eaTDato = "N"; enLong = 3;  eaAlfa = nPc2;  |HAZ FormatoCmp;
     nCampo  = nCampo + 1;  #m100h001#nCampo# = eaAlfa;

     enLongDec = 0; eaTDato = "N"; enLong = 1;  eaAlfa = aSit;  |HAZ FormatoCmp;
     nCampo  = nCampo + 1;  #m100h001#nCampo# = eaAlfa;

     nCampo  = nCampo + 1;  #m100h001#nCampo# = aRfC;
|FPRC;

|DEFBUCLE rem00102;
     #rem00102#1;
     ;
     enVEmpre, 01;
     enVEmpre, 99;
     ;
     NULL, rem00102;
|FIN;

|PROCESO TDeclaracion;
     nTotal    = 0;
     eaCasilla = "47-0693";  |HAZ SacaImporte;
     nTotal    = enImp;
     |SI enError = 1; |O nTotal = 0;
         eaCasilla = "48-0694";  |HAZ SacaImporte;
         nTotal    = enImp;
     |FINSI;

     |SI enError = 1; |O nTotal = 0;
         eaCasilla = "43-0670";  |HAZ SacaImporte;
         nTotal    = enImp;
     |SINO;
         nTotal    = #rem01001#16;
     |FINSI;

     eaCasilla = "45-0680";  |HAZ SacaImporte;
     |SI #rem01001#14 = "4"; enImp = 0; |FINSI;

     nCalc = enImp;
     |SI nCalc ! 0; nTotal = nCalc; |FINSI;

     #m100h001#6 = "N";
     |SI nTotal > 0;
                                #m100h001#6 = "I";
         |SI #rem01001#9 = "D"; #m100h001#6 = "U"; |FINSI;
     |FINSI;

     |SI nTotal < 0;
                                 #m100h001#6 = "D";
         |SI #rem01001#11 = "X"; #m100h001#6 = "R"; |FINSI;
     |FINSI;
|FPRC;

|PROCESO Hoja01;
     |ABRE #rem00100;
     #rem00100#0 = enVEmpre;
     |LEE 000#rem00100.=;
     |SI FSalida = 0;
        |HAZ CargaDatos;
     |FINSI;
     |CIERRA #rem00100;

     |QBF aCP1;
     |SI aCP1 = ""; aCP1 = "00000"; |FINSI;

     |QBF aCP2;
     |SI aCP2 = ""; aCP2 = "00000"; |FINSI;

     |DDEFECTO #m100h001;

     |HAZ TDeclaracion;
     #m100h001#7  = aNif1;
     #m100h001#8  = aApell11 + " " + aApell12 + ", " + aNombre1;
     #m100h001#11 = aSexo1;

     |SI aEC1 = "S"; #m100h001#12 = "1"; aSexo2 = " "; |FINSI;
     |SI aEC1 = "C"; #m100h001#12 = "2";               |FINSI;
     |SI aEC1 = "V"; #m100h001#12 = "3"; aSexo2 = " "; |FINSI;
     |SI aEC1 = "L"; #m100h001#12 = "4"; aSexo2 = " "; |FINSI;

     |HAZ Inicializa;

     eaTDato = "F";  enLong = 8;  eaAlfa = aFNac1;  |HAZ FormatoCmp;
     #m100h001#13 = eaAlfa;

     eaTDato = "N";  enLong = 1;  eaAlfa = aMinusval1;  |HAZ FormatoCmp;
     #m100h001#14 = eaAlfa;

     |SI aCambioDom1 = "S";
         #m100h001#15 = "1";
     |FINSI;

     #m100h001#16 = aSg1;
     #m100h001#18 = aCalle1;
     #m100h001#19 = aTipNum1;

     eaTDato = "N"; enLong = 5;  eaAlfa = aNumero1;   |HAZ FormatoCmp;
     #m100h001#20 = eaAlfa;

     #m100h001#21 = aCalNum1;
     #m100h001#22 = aBloque1;
     #m100h001#23 = aPortal1;
     #m100h001#24 = aEscalera1;
     #m100h001#25 = aPiso1;
     #m100h001#26 = aPuerta1;
     #m100h001#27 = aDatComp1;
     #m100h001#28 = aLocalB1;
     #m100h001#29 = aCP1;
     #m100h001#31 = aLocali1;
     #m100h001#32 = aCP1 % 102;
     #m100h001#33 = aProvin1;
     #m100h001#34 = aDomExtr1;
     #m100h001#35 = aDtCmpEx1;
     #m100h001#36 = aPoblExt1;
     #m100h001#37 = aCPExt1;
     #m100h001#38 = aEstExt1;
     #m100h001#39 = aPaisExt1;
     #m100h001#40 = aCdPaisEx1;
     #m100h001#41 = aRUEExtr1;
     #m100h001#42 = aNacExtr1;

     aNifArrend   = "";
     aNifArrendEx = "";
     nLinea       = 0;

     aTipo = eaVTipo % 0110; |QBF aTipo;
     |BUCLE rem00102;

     #m100h001#83 = aNifArrend;
     #m100h001#84 = aNifArrendEx;
     #m100h001#85 = aNif2;

     eaAlfa = aApell21 + aApell22 + aNombre2;  |QBF eaAlfa;
     |SI eaAlfa ! "";
         #m100h001#86 = aApell21 + " " + aApell22 + ", " + aNombre2;
     |FINSI;

     #m100h001#87 = aSexo2;

     eaTDato = "F";  enLong = 8;  eaAlfa = aFNac2;  |HAZ FormatoCmp;
     #m100h001#88 = eaAlfa;

     eaTDato = "N";  enLong = 1;  eaAlfa = aMinusval2;  |HAZ FormatoCmp;
     #m100h001#89 = eaAlfa;

     |SI #rem00100#102 = "X";
         #m100h001#90 = "1";
     |FINSI;

     |SI #rem00100#161 = "S";
         #m100h001#91 = "1";
     |FINSI;

     |SI aCambioDom2 = "S";
         #m100h001#92 = "1";
     |FINSI;

     #m100h001#93 = aSg2;
     #m100h001#95 = aCalle2;
     #m100h001#96 = aTipNum2;

     eaTDato = "N"; enLong = 5;  eaAlfa = aNumero2;   |HAZ FormatoCmp;
     #m100h001#97 = eaAlfa;

     #m100h001#98  = aCalNum2;
     #m100h001#99  = aBloque2;
     #m100h001#100 = aPortal2;
     #m100h001#101 = aEscalera2;
     #m100h001#102 = aPiso2;
     #m100h001#103 = aPuerta2;
     #m100h001#104 = aDatComp2;
     #m100h001#105 = aLocalB2;
     #m100h001#106 = aCP2;
     #m100h001#108 = aLocali2;
     #m100h001#109 = aCP2 % 102;
     #m100h001#110 = aProvin2;
     #m100h001#111 = aDomExtr2;
     #m100h001#112 = aDtCmpEx2;
     #m100h001#113 = aPoblExt2;
     #m100h001#114 = aCPExt2;
     #m100h001#115 = aEstExt2;
     #m100h001#116 = aPaisExt2;
     #m100h001#117 = aCdPaisEx2;
     #m100h001#118 = aRUEExtr2;
     #m100h001#119 = aNacExtr2;

     |ABRE #rerenpre;
     #rerenpre#0 = #rem00100#65;
     |LEE 000#rerenpre.=;
     |SI FSalida ! 0;  |DDEFECTO #rerenpre;  |FINSI;
     |CIERRA #rerenpre;

     #m100h001#121 = #rerenpre#2;
     #m100h001#122 = #rerenpre#1;

     |SI #rem00100#91 = "T"; |Y aTipo = "TITULAR";
        eaAlfa = #rem00100#92;
        |SI eaAlfa = "01.01.0000"; eaAlfa = "00.00.0000"; |FINSI;
        eaAlfa = eaAlfa - "."; eaAlfa = eaAlfa - ".";

        #m100h001#123 = eaAlfa;
     |FINSI;

     |SI #rem00100#91 = "C"; |Y aTipo = "CONYUGE";
        eaAlfa = #rem00100#92;
        |SI eaAlfa = "01.01.0000"; eaAlfa = "00.00.0000"; |FINSI;
        eaAlfa = eaAlfa - "."; eaAlfa = eaAlfa - ".";

        #m100h001#123 = eaAlfa;
     |FINSI;

     |SI eaTipoBor ! "";
         aTipo = eaVTipo; |QBF aTipo;
         |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
              #rem00100#57 = "X";
         |FINSI;
     |FINSI;

     aTipo = eaVTipo; |QBF aTipo;
     |SI #rem00100#57 = "X";
         aSeparada = "N";
         #m100h001#124 = "1";
         |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
             #m100h001#124 = "2";
         |FINSI;
     |SINO;
         aSeparada = "S";
         #m100h001#124 = "1";
     |FINSI;

     eaAlfa = eaVTipo; |QBF eaAlfa;
     |SI eaAlfa = "CONYUGE";
        eaTDato = "N";  enLong = 2;  eaAlfa = #rem00100#43;  |HAZ FormatoCmp;
        #m100h001#125 = eaAlfa;
     |SINO;
        eaTDato = "N";  enLong = 2;  eaAlfa = #rem00100#11;  |HAZ FormatoCmp;
        #m100h001#125 = eaAlfa;
     |FINSI;

     |PARA nCampo = 1;  |SI nCampo [ 132;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #m100h001#nCampo#; |HAZ QuitaRaros;
           #m100h001#nCampo# = eaAlfa;

           eaAlfa = #m100h001#nCampo#;
           |XGRABA enHandle, eaAlfa;
     |SIGUE;

     eaAlfa = eaCRLF;  |XGRABA enHandle, eaAlfa;
|FPRC;

|PROCESO PonNifHijos;
     |SI aNifDc1 = "";  aNifDc1 = eaAlfa;  |ACABA;  |FINSI;
     |SI aNifDc2 = "";  aNifDc2 = eaAlfa;  |ACABA;  |FINSI;
     |SI aNifDc3 = "";  aNifDc3 = eaAlfa;  |ACABA;  |FINSI;
     |SI aNifDc4 = "";  aNifDc4 = eaAlfa;  |ACABA;  |FINSI;
|FPRC;

|PROCESO OtroProg;
     |QBF aNifOtroProg;
     |QBF aNomOtroProg;

     |SI aNifOtroProg = aNifOtroProg1;  |Y aNomOtroProg = aNomOtroProg1;
         nOrden = 1;
         |ACABA;
     |FINSI;

     |SI aNifOtroProg = aNifOtroProg2;  |Y aNomOtroProg = aNomOtroProg2;
         nOrden = 2;
         |ACABA;
     |FINSI;

     |SI aNifOtroProg = aNifOtroProg3;  |Y aNomOtroProg = aNomOtroProg3;
         nOrden = 3;
         |ACABA;
     |FINSI;

     |SI aNifOtroProg = aNifOtroProg4;  |Y aNomOtroProg = aNomOtroProg4;
         nOrden = 4;
         |ACABA;
     |FINSI;

     |SI aNifOtroProg1 = "";  |Y aNomOtroProg1 = "";
         aNifOtroProg1 = aNifOtroProg;
         aNomOtroProg1 = aNomOtroProg;
         nOrden = 1;
         |ACABA;
     |FINSI;

     |SI aNifOtroProg2 = "";  |Y aNomOtroProg2 = "";
         aNifOtroProg2 = aNifOtroProg;
         aNomOtroProg2 = aNomOtroProg;
         nOrden = 2;
         |ACABA;
     |FINSI;

     |SI aNifOtroProg3 = "";  |Y aNomOtroProg3 = "";
         aNifOtroProg3 = aNifOtroProg;
         aNomOtroProg3 = aNomOtroProg;
         nOrden = 3;
         |ACABA;
     |FINSI;

     |SI aNifOtroProg4 = "";  |Y aNomOtroProg4 = "";
         aNifOtroProg4 = aNifOtroProg;
         aNomOtroProg4 = aNomOtroProg;
         nOrden = 4;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO CargaMinuH;
     |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;

     |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N";
         aMinuH = 1;
     |FINSI;

     |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S";
         aMinuH = 2;
     |FINSI;

     |SI #rem00101#6 ] 65;  aMinuH = 3; |FINSI;
     |SI #rem00101#6 = 100; aMinuH = 4; |FINSI;
|FPRC;

|PROCESO HijosIndividual;
     aNifOtroProg  = "";
     aNomOtroProg  = "";

     #rem00101#0 = #rem00100#0;
     #rem00101#1 = nCont;
     |LEE 000#rem00101.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #rem00101#11 < 0;  |ACABA;  |FINSI;

     nOrden = 0;
     eaAlfa  = #rem00101#2; |QBF eaAlfa;
     |SI eaAlfa ! ""; |Y #rem00101#7 = " ";
         |HAZ PonNifHijos;
     |FINSI;

     |SI #rem00101#7 = " ";
         nHijosTit = nHijosTit + 1;
         nHijosCon = nHijosCon + 1;
     |FINSI;

     |SI #rem00101#7 = "1"; |O #rem00101#7 = "3";
         nHijosTit = nHijosTit + 1;
     |FINSI;

     |SI #rem00101#7 = "2"; |O #rem00101#7 = "4";
         nHijosCon = nHijosCon + 1;
     |FINSI;

     |SI #rem00101#7 = "3"; |O #rem00101#7 = "4";
         |SI aTipo = "TITULAR"; |Y #rem00101#7 = "3";
             aNifOtroProg = #rem00101#23;
             aNomOtroProg = #rem00101#24;
             |HAZ OtroProg;
         |FINSI;

         |SI aTipo = "CONYUGE"; |Y #rem00101#7 = "4";
             aNifOtroProg = #rem00101#23;
             aNomOtroProg = #rem00101#24;
             |HAZ OtroProg;
         |FINSI;
    |FINSI;

    |SI #rem00101#21 ! "01.01.0000";
        |SI aTipo = "TITULAR";
            |SI #rem00101#7 = "1"; |O #rem00101#7 = "3"; |O #rem00101#7 = " ";
                |SI nOrdDMuerto1 = 0;
                    aFecDMuerto1 = #rem00101#21;
                    nOrdDMuerto1 = nHijosTit
                |SINO;
                    |SI nOrdDMuerto2 = 0;
                        aFecDMuerto2 = #rem00101#21;
                        nOrdDMuerto2 = nHijosTit
                    |FINSI;
                |FINSI;
           |FINSI;
        |FINSI;

        |SI aTipo = "CONYUGE";
            |SI #rem00101#7 = "2"; |O #rem00101#7 = "4"; |O #rem00101#7 = " ";
                |SI nOrdDMuerto1 = 0;
                    aFecDMuerto1 = #rem00101#21;
                    nOrdDMuerto1 = nHijosCon;
                |SINO;
                    |SI nOrdDMuerto2 = 0;
                        aFecDMuerto2 = #rem00101#21;
                        nOrdDMuerto2 = nHijosCon;
                    |FINSI;
                |FINSI;
            |FINSI;
        |FINSI;
     |FINSI;

     |SI aTipo = "TITULAR";
         |SI #rem00101#7 = "1"; |O #rem00101#7 = "3"; |O #rem00101#7 = " ";
             |HAZ CargaMinuH;

             |SI #rem00101#27 = "S";  aUE = "1";  |FINSI;

             aNifH  = #rem00101#2;  aNombH = #rem00101#3;
             aAnyoH = #rem00101#5; |QBF aAnyoH;
             aVincH = #rem00101#7;  aOtroH = #rem00101#8;
             aFNacH = #rem00101#17; aFAdoH = #rem00101#18;

             eaTDato = "F";
             eaAlfa = aFNacH; |HAZ FormatoCmp; |SI eaAlfa = "        "; aFNacH = "00000000"; |SINO; aFNacH = eaAlfa; |FINSI;
             eaAlfa = aFAdoH; |HAZ FormatoCmp; |SI eaAlfa = "        "; aFAdoH = "00000000"; |SINO; aFAdoH = eaAlfa; |FINSI;

             |SI #m100h001#12 = "3"; |Y aEC1 = "C"; aVincH = ""; |FINSI;

             |SI #rem00100#91 = "C";
                 |SI aVincH = " ";
                     aVincH = "3";

                     aNifOtroProg = #rem00100#35;   |QBF aNifOtroProg;
                     aNomOtroProg = #rem00100#36;   |QBF aNomOtroProg;
                     aNomOtroProg = aNomOtroProg + " "  + #rem00100#37; |QBF aNomOtroProg;
                     aNomOtroProg = aNomOtroProg + ", " + #rem00100#38; |QBF aNomOtroProg;
                     |HAZ OtroProg;
                 |FINSI;
             |FINSI;

             |SI aVincH = "4"; aVincH = "3"; |FINSI;

             eaTDato = "An"; enLong = 9;  eaAlfa = aNifH;   |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
             eaTDato = "A";  enLong = 60; eaAlfa = aNombH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
             eaTDato = "N";  enLong = 8;  eaAlfa = aFNacH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
             eaTDato = "N";  enLong = 8;  eaAlfa = aFAdoH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
             eaTDato = "N";  enLong = 1;  eaAlfa = aMinuH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
             eaTDato = "An"; enLong = 1;  eaAlfa = aVincH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
             eaTDato = "N";  enLong = 2;  eaAlfa = nOrden;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
             eaTDato = "An"; enLong = 1;  eaAlfa = aOtroH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
             |HAZ GrabaCadena;

             nCont10 = nCont10 + 1;
         |FINSI;
     |FINSI;

     |SI aTipo = "CONYUGE";
         |SI #rem00101#7 = "2"; |O #rem00101#7 = "4"; |O #rem00101#7 = " ";
             |HAZ CargaMinuH;

             |SI #rem00101#27 = "S";  aUE = "1";  |FINSI;

             aNifH  = #rem00101#2;  aNombH = #rem00101#3;
             aAnyoH = #rem00101#5; |QBF aAnyoH;
             aVincH = #rem00101#7;
             |SI #rem00101#7 = "2"; aVincH = "1"; |FINSI;

             aOtroH = #rem00101#8;
             aFNacH = #rem00101#17; aFAdoH = #rem00101#18;

             eaTDato = "F";
             eaAlfa = aFNacH; |HAZ FormatoCmp;
             aFNacH = "00000000";
             |SI eaAlfa ! "        ";
                 aFNacH = eaAlfa;
             |FINSI;

             eaAlfa  = aFAdoH; |HAZ FormatoCmp;
             aFAdoH = "00000000";
             |SI eaAlfa ! "        ";
                 aFAdoH = eaAlfa;
             |FINSI;

             |SI #m100h001#12 = "3"; |Y aEC1 = "C"; aVincH = ""; |FINSI;

             |SI #rem00100#91 = "T";
                 |SI aVincH = " ";
                     aVincH = "3";

                     aNifOtroProg = #rem00100#1;        |QBF aNomOtroProg;
                     aNomOtroProg = #rem00100#2;        |QBF aNomOtroProg;
                     aNomOtroProg = aNomOtroProg + " "  + #rem00100#3; |QBF aNomOtroProg;
                     aNomOtroProg = aNomOtroProg + ", " + #rem00100#4; |QBF aNomOtroProg;
                     |HAZ OtroProg;
                 |FINSI;
             |FINSI;

             |SI aVincH = "4"; aVincH = "3"; |FINSI;

             eaTDato = "An"; enLong = 9;  eaAlfa = aNifH;   |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
             eaTDato = "A";  enLong = 60; eaAlfa = aNombH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
             eaTDato = "N";  enLong = 8;  eaAlfa = aFNacH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
             eaTDato = "N";  enLong = 8;  eaAlfa = aFAdoH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
             eaTDato = "N";  enLong = 1;  eaAlfa = aMinuH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
             eaTDato = "An"; enLong = 1;  eaAlfa = aVincH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
             eaTDato = "N";  enLong = 2;  eaAlfa = nOrden;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
             eaTDato = "An"; enLong = 1;  eaAlfa = aOtroH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
             |HAZ GrabaCadena;

             nCont10 = nCont10 + 1;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO HijosConjunta;
     aNifOtroProg  = "";
     aNomOtroProg  = "";

     #rem00101#0 = #rem00100#0;
     #rem00101#1 = nCont;
     |LEE 000#rem00101.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #rem00101#11 < 0;  |ACABA;  |FINSI;

     nOrden = 0;

     |SI #rem00101#7 = "3"; |O #rem00101#7 = "4";
         |SI aNifOtroProg = "";
             aNifOtroProg = #rem00101#23;  |QBF aNifOtroProg;
             aNomOtroProg = #rem00101#24;  |QBF aNomOtroProg;
             |HAZ OtroProg;
         |FINSI;
     |FINSI;

     |SI #rem00101#21 ! "01.01.0000";
         |SI nOrdDMuerto1 = 0;
             aFecDMuerto1 = #rem00101#21;
             nOrdDMuerto1 = nCont;
         |SINO;
             |SI nOrdDMuerto2 = 0;
                 aFecDMuerto2 = #rem00101#21;
                 nOrdDMuerto2 = nCont;
             |FINSI;
         |FINSI;
     |FINSI;

     |HAZ CargaMinuH;

     |SI #rem00101#27 = "S";  aUE = "1";  |FINSI;

     aNifH  = #rem00101#2;  aNombH = #rem00101#3;
     aAnyoH = #rem00101#5; |QBF aAnyoH;
     aVincH = #rem00101#7;  aOtroH = #rem00101#8;
     |SI #rem00100#91 ! " ";
         |SI #rem00100#91 = "T";
             |SI aVincH = "2";
                 aVincH = "1";
             |FINSI;
         |FINSI;

         |SI aVincH = " ";
             aVincH = "3";
             |SI #rem00100#91 = "T";
                 aNifOtroProg = #rem00100#1;        |QBF aNifOtroProg;
                 aNomOtroProg =        #rem00100#2; |QBF aNomOtroProg;
                 aNomOtroProg = aNomOtroProg + " "  + #rem00100#3; |QBF aNomOtroProg;
                 aNomOtroProg = aNomOtroProg + ", " + #rem00100#4; |QBF aNomOtroProg;
                 |HAZ OtroProg;
             |SINO;
                 aNifOtroProg = #rem00100#35;        |QBF aNifOtroProg;
                 aNomOtroProg =        #rem00100#36; |QBF aNomOtroProg;
                 aNomOtroProg = aNomOtroProg + " "  + #rem00100#37; |QBF aNomOtroProg;
                 aNomOtroProg = aNomOtroProg + ", " + #rem00100#38; |QBF aNomOtroProg;
                 |HAZ OtroProg;
             |FINSI;
             |HAZ OtroProg;
         |FINSI;
     |FINSI;

     aFNacH = #rem00101#17;
     aFAdoH = #rem00101#18;
     eaTDato = "F";
     eaAlfa = aFNacH; |HAZ FormatoCmp;
     aFNacH = "00000000";
     |SI eaAlfa ! "        ";
         aFNacH = eaAlfa;
     |FINSI;

     eaAlfa  = aFAdoH; |HAZ FormatoCmp;
     aFAdoH = "00000000";
     |SI eaAlfa ! "        ";
         aFAdoH = eaAlfa;
     |FINSI;

     eaTDato = "An"; enLong = 9;  eaAlfa = aNifH;   |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     eaTDato = "A";  enLong = 60; eaAlfa = aNombH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     eaTDato = "N";  enLong = 8;  eaAlfa = aFNacH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     eaTDato = "N";  enLong = 8;  eaAlfa = aFAdoH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     eaTDato = "N";  enLong = 1;  eaAlfa = aMinuH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     eaTDato = "An"; enLong = 1;  eaAlfa = aVincH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     eaTDato = "N";  enLong = 2;  eaAlfa = nOrden;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     eaTDato = "An"; enLong = 1;  eaAlfa = aOtroH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     |HAZ GrabaCadena;

     nCont10 = nCont10 + 1;
|FPRC;

|PROCESO PonDescendientes;
     |DDEF eaAlfa; |QBF eaAlfa;
     eaAlfa = eaAlfa + "rem00101.mas";
     |CARGA_DEF eaAlfa, Referen@;
     |SI FSalida = 0;
        nNumFam = 1;
        eaAlfa = "tu" + Usuario; |NOME_DAT #Referen@#eaAlfa#;
        |DELINDEX #Referen@; |ABRE #Referen@;
        |SELECT #4#rem00101;

        |DDEFECTO #rem00101;
        #rem00101#0  = #rem00100#0;
        #rem00101#8  = "2";
        #rem00101#17 = "31.12.9999";
        |LEE 000#rem00101.];
        |PARA; |SI FSalida = 0; |Y #rem00101#0 = #rem00100#0;
                                |Y #rem00101#8 = "2";  |HACIENDO;
           |SI #rem00101#4 = "DESCENDIENTE";
              eaAlfa = "|NC"; eaAlfa = #rem00101#eaAlfa#; nCalc = eaAlfa;
              |PARA nCont = 0; |SI nCont < nCalc; |HACIENDO nCont = nCont + 1;
                 #Referen@#nCont# = #rem00101#nCont#;
              |SIGUE;
              #Referen@#1 = nNumFam; nNumFam = nNumFam + 1;
              |GRABA 020#Referen@.n;
           |FINSI;

           |LEE 000#rem00101.s;
        |SIGUE;

        |DDEFECTO #rem00101;
        #rem00101#0  = #rem00100#0;
        #rem00101#8  = "";
        #rem00101#17 = "31.12.9999";
        |LEE 000#rem00101.];
        |PARA; |SI FSalida = 0; |Y #rem00101#0 = #rem00100#0;
                                |Y #rem00101#8 ! "2";  |HACIENDO;
           |SI #rem00101#4 = "DESCENDIENTE";
              eaAlfa = "|NC"; eaAlfa = #rem00101#eaAlfa#; nCalc = eaAlfa;
              |PARA nCont = 0; |SI nCont < nCalc; |HACIENDO nCont = nCont + 1;
                 #Referen@#nCont# = #rem00101#nCont#;
              |SIGUE;
              #Referen@#1 = nNumFam; nNumFam = nNumFam + 1;
              |GRABA 020#Referen@.n;
           |FINSI;

           |LEE 000#rem00101.s;
        |SIGUE;
        |SELECT #1#rem00101;
        |CIERRA #Referen@; |DESCARGA_DEF #Referen@;

        |CIERRA #rem00101;
        eaAlfa = "tu" + Usuario; |NOME_DAT #rem00101#eaAlfa#;
        |ABRE #rem00101;
     |FINSI;

     aUE           = "0";
     aNifOtroProg  = "";
     aNomOtroProg  = "";
     aNifOtroProg1 = "";
     aNifOtroProg2 = "";
     aNifOtroProg3 = "";
     aNifOtroProg4 = "";
     aNomOtroProg1 = "";
     aNomOtroProg2 = "";
     aNomOtroProg3 = "";
     aNomOtroProg4 = "";
     nOrdDMuerto1  = 0;
     aFecDMuerto1  = "00.00.0000";
     nOrdDMuerto2  = 0;
     aFecDMuerto2  = "00.00.0000";
     nCont10       = 1;

     aTipo = eaVTipo; |QBF aTipo;
     |SI aTipo = "TITULAR"; |O aTipo = "CONYUGE";
         nHijosTit = 0;
         nHijosCon = 0;

         |PARA nCont = 1; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
               InDescend = nDescend1<-;
               InDescend = InDescend + (nCont - 1);

               |HAZ HijosIndividual;
         |SIGUE;
     |FINSI;

     |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
         |PARA nCont = 1; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
               InDescend = nDescend1<-;
               InDescend = InDescend + (nCont - 1);

               |HAZ HijosConjunta;
         |SIGUE;
     |FINSI;

     |PARA nCont = nCont10; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
           aNifH    = "";
           aNombH   = "";
           aAnyoH   = "";
           aMinuH   = "0";
           aVincH   = "";
           aOtroH   = "";
           nOrden   = 0;
           aFNacH   = "00000000";
           aFAdoH   = "00000000";

           eaTDato = "An"; enLong = 9;  eaAlfa = aNifH;   |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
           eaTDato = "A";  enLong = 60; eaAlfa = aNombH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
           eaTDato = "N";  enLong = 8;  eaAlfa = aFNacH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
           eaTDato = "N";  enLong = 8;  eaAlfa = aFAdoH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
           eaTDato = "N";  enLong = 1;  eaAlfa = aMinuH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
           eaTDato = "An"; enLong = 1;  eaAlfa = aVincH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
           eaTDato = "N";  enLong = 2;  eaAlfa = nOrden;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
           eaTDato = "An"; enLong = 1;  eaAlfa = aOtroH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
           |HAZ GrabaCadena;
     |SIGUE;

     |CIERRA #rem00101;
     eaAlfa = "rem00101"; |NOME_DAT #rem00101#eaAlfa#;
     |ABRE #rem00101;

     || Hijos y otros descendientes : Fallecido - N orden
     eaTDato = "N"; enLong = 2;  eaAlfa = nOrdDMuerto1;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     || Hijos y otros descendientes : Fecha fallecimiento
     eaTDato = "F"; enLong = 8;  eaAlfa = aFecDMuerto1;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     || Hijos y otros descendientes : Fallecido - N orden
     eaTDato = "N"; enLong = 2;  eaAlfa = nOrdDMuerto2;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     || Hijos y otros descendientes : Fecha fallecimiento
     eaTDato = "F"; enLong = 8;  eaAlfa = aFecDMuerto2;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;

     eaTDato = "An"; enLong = 1;  eaAlfa = aUE;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;

     eaTDato = "A"; enLong = 9;  eaAlfa = aNifDc1;      |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     eaTDato = "A"; enLong = 9;  eaAlfa = aNifDc2;      |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     eaTDato = "A"; enLong = 9;  eaAlfa = aNifDc3;      |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     eaTDato = "A"; enLong = 9;  eaAlfa = aNifDc4;      |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;

     || Hijos y otros descendientes : Nif de otro progenitor
     || Hijos y otros descendientes : Nombre de otro progenitor

     eaTDato = "An"; enLong = 9;  eaAlfa = aNifOtroProg1; |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     eaTDato = "A";  enLong = 60; eaAlfa = aNomOtroProg1; |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;

     eaAlfa = "0";
     |SI aNifOtroProg1 = "";  |Y aNomOtroProg1 ! "";
         eaAlfa = "1";
     |FINSI;
     eaTDato = "N"; enLong = 1; |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;

     eaTDato = "An"; enLong = 9;  eaAlfa = aNifOtroProg2; |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     eaTDato = "A";  enLong = 60; eaAlfa = aNomOtroProg2; |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;

     eaAlfa = "0";
     |SI aNifOtroProg2 = "";  |Y aNomOtroProg2 ! "";
         eaAlfa = "1";
     |FINSI;
     eaTDato = "N"; enLong = 1; |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     |HAZ GrabaCadena;

     eaCadena  = "";
     eaTDato = "An"; enLong = 9;  eaAlfa = aNifOtroProg3; |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     eaTDato = "A";  enLong = 60; eaAlfa = aNomOtroProg3; |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;

     eaAlfa = "0";
     |SI aNifOtroProg3 = "";  |Y aNomOtroProg3 ! "";
         eaAlfa = "1";
     |FINSI;
     eaTDato = "N"; enLong = 1; |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;

     eaTDato = "An"; enLong = 9;  eaAlfa = aNifOtroProg4; |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     eaTDato = "A";  enLong = 60; eaAlfa = aNomOtroProg4; |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;

     eaAlfa = "0";
     |SI aNifOtroProg4 = "";  |Y aNomOtroProg4 ! "";
         eaAlfa = "1";
     |FINSI;
     eaTDato = "N"; enLong = 1; |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     |HAZ GrabaCadena;

     || RESERVADO AEAT
     eaCadena = "";
     eaTDato = "A"; enLong = 24;  eaAlfa = ""; |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     |HAZ GrabaCadena;  eaCadena = "";
|FPRC;

|PROCESO CargaMuertoA;
     |SI #rem00101#21 = "01.01.0000";
         |ACABA;
     |FINSI;

     |SI aNifAMuerto1 = "";
         aNifAMuerto1 = #rem00101#2;
         aFecAMuerto1 = #rem00101#21;
     |SINO;
         |SI aNifAMuerto2 = "";
             aNifAMuerto2 = #rem00101#2;
             aFecAMuerto2 = #rem00101#21;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO AbuelosIndividual;
     |SI aFamil ! "N"; |ACABA;  |FINSI;

     #rem00101#0 = #rem00100#0;
     #rem00101#1 = nAscend;
     |LEE 000#rem00101.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #rem00101#13 = "S";  |ACABA;  |FINSI;

     |SI aTipo = "TITULAR";
         |SI #rem00101#7 = "2";  |ACABA;  |FINSI;

         |HAZ CargaMuertoA;
         |HAZ CargaMinuH;

         aNifH  = #rem00101#2;
         aNombH = #rem00101#3;
         aAnyoH = #rem00101#5;
         aVincH = #rem00101#7;
         aOtroH = #rem00101#9;
         aNivRe = #rem00101#19;
         aFNacH = #rem00101#17;

         eaTDato = "F";
         eaAlfa = aFNacH; |HAZ FormatoCmp;
         aFNacH = "00000000";
         |SI eaAlfa ! "        ";
             aFNacH = eaAlfa;
         |FINSI;

         |SI #m100h001#12 = "3"; |Y aEC1 = "C";
             aVincH = "";
         |FINSI;

         eaTDato = "An"; enLong = 9;  eaAlfa = aNifH;   |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
         eaTDato = "A";  enLong = 60; eaAlfa = aNombH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
         eaTDato = "N";  enLong = 8;  eaAlfa = aFNacH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
         eaTDato = "N";  enLong = 1;  eaAlfa = aMinuH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
         eaTDato = "An"; enLong = 1;  eaAlfa = aVincH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
         eaTDato = "An"; enLong = 1;  eaAlfa = aOtroH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
         |HAZ GrabaCadena;

         nCont10 = nCont10 + 1;
     |FINSI;

     |SI aTipo = "CONYUGE";
         |SI #rem00101#7 = "1";  |ACABA;  |FINSI;

         |HAZ CargaMuertoA;
         |HAZ CargaMinuH;

         aNifH  = #rem00101#2;
         aNombH = #rem00101#3;
         aAnyoH = #rem00101#5;
         aVincH = #rem00101#7;

         |SI #rem00101#7 = "2"; aVincH = "1"; |FINSI;

         aOtroH = #rem00101#9;
         aNivRe = #rem00101#19;
         aFNacH = #rem00101#17;

         eaTDato = "F";
         eaAlfa = aFNacH; |HAZ FormatoCmp;
         aFNacH = "00000000";
         |SI eaAlfa ! "        ";
             aFNacH = eaAlfa;
         |FINSI;

         |SI #m100h001#12 = "3"; |Y aEC1 = "C";
             aVincH = "";
         |FINSI;

         eaTDato = "An"; enLong = 9;  eaAlfa = aNifH;   |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
         eaTDato = "A";  enLong = 60; eaAlfa = aNombH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
         eaTDato = "N";  enLong = 8;  eaAlfa = aFNacH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
         eaTDato = "N";  enLong = 1;  eaAlfa = aMinuH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
         eaTDato = "An"; enLong = 1;  eaAlfa = aVincH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
         eaTDato = "An"; enLong = 1;  eaAlfa = aOtroH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
         |HAZ GrabaCadena;

         nCont10 = nCont10 + 1;
     |FINSI;
|FPRC;

|PROCESO AbuelosConjunta;
     |SI aFamil ! "N"; |ACABA;  |FINSI;

     #rem00101#0 = #rem00100#0;
     #rem00101#1 = nAscend;
     |LEE 000#rem00101.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #rem00101#13 = "S";  |ACABA;  |FINSI;

     |HAZ CargaMuertoA;
     |HAZ CargaMinuH;

     aNifH  = #rem00101#2; aNombH = #rem00101#3;
     aAnyoH = #rem00101#5;
     aVincH = #rem00101#7;
     aOtroH = #rem00101#9;
     aNivRe = #rem00101#19;
     aFNacH = #rem00101#17;

     |SI #rem00100#91 = "T";
         |SI aVincH = "2";
             aVincH = "1";
         |FINSI;
     |FINSI;

     eaTDato = "F";
     eaAlfa = aFNacH; |HAZ FormatoCmp;
     aFNacH = "00000000";
     |SI eaAlfa ! "        ";
         aFNacH = eaAlfa;
     |FINSI;

     eaTDato = "An"; enLong = 9;  eaAlfa = aNifH;   |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     eaTDato = "A";  enLong = 60; eaAlfa = aNombH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     eaTDato = "N";  enLong = 8;  eaAlfa = aFNacH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     eaTDato = "N";  enLong = 1;  eaAlfa = aMinuH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     eaTDato = "An"; enLong = 1;  eaAlfa = aVincH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     eaTDato = "An"; enLong = 1;  eaAlfa = aOtroH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     |HAZ GrabaCadena;

     nCont10 = nCont10 + 1;
     aTipo = eaVTipo; |QBF aTipo;
|FPRC;

|PROCESO PonAscendientes;
     aNifAMuerto1 = "";
     aNifAMuerto2 = "";
     aFecAMuerto1 = "00.00.0000";
     aFecAMuerto2 = "00.00.0000";
     nCont10      = 1;

     || Bucle para la declaracion de ascendientes
     |SI aTipo = "TITULAR"; |O aTipo = "CONYUGE";
        |PARA nCont = 1; |SI nCont [ 4; |HACIENDO nCont = nCont + 1;
              InAscend = nAscend1<-;
              InAscend = InAscend + (nCont - 1);
              |HAZ AbuelosIndividual;
        |SIGUE;
     |FINSI;

     |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
        |PARA nCont = 1; |SI nCont [ 4; |HACIENDO nCont = nCont + 1;
              InAscend = nAscend1<-;
              InAscend = InAscend + (nCont - 1);
              |HAZ AbuelosConjunta;
        |SIGUE;
     |FINSI;

     |PARA nCont = nCont10; |SI nCont [ 4; |HACIENDO nCont = nCont + 1;
           aNifH  = ""; aNombH = "";
           aAnyoH = ""; aMinuH = "0";
           aVincH = ""; aOtroH = "";
           aNivRe = ""; aFNacH = "00000000";

           eaTDato = "An"; enLong = 9;  eaAlfa = aNifH;   |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
           eaTDato = "A";  enLong = 60; eaAlfa = aNombH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
           eaTDato = "N";  enLong = 8;  eaAlfa = aFNacH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
           eaTDato = "N";  enLong = 1;  eaAlfa = aMinuH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
           eaTDato = "An"; enLong = 1;  eaAlfa = aVincH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
           eaTDato = "An"; enLong = 1;  eaAlfa = aOtroH;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
           |HAZ GrabaCadena;
     |SIGUE;

     eaTDato = "A"; enLong = 9;  eaAlfa = aNifAMuerto1;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     eaTDato = "F"; enLong = 8;  eaAlfa = aFecAMuerto1;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     eaTDato = "A"; enLong = 9;  eaAlfa = aNifAMuerto2;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     eaTDato = "F"; enLong = 8;  eaAlfa = aFecAMuerto2;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
|FPRC;

|PROCESO Hoja02;
     eaCadena = ""; enLongDec = 0;
     eaVTipo = eaTipo; aTipo = eaVTipo % 0110;

     eaCadena = "<T10002000> ";

     aNifDc1 = ""; aNifDc2 = "";  aNifDc3 = ""; aNifDc4 = "";

     InAscend = nAscend1<-; InDescend = nDescend1<-;
     |PARA nCont = 1; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
        nDescend = 0;
        InDescend = InDescend + 1;

        |SI nCont [ 4;
            nAscend = 0; InAscend = InAscend + 1;
        |FINSI;
     |SIGUE;

     InAscend  = nAscend1<-;
     InDescend = nDescend1<-;
     aCDoc     = "0";
     aPDec     = "0";
     |BUCLE RecogeFam;

     |HAZ PonDescendientes;
     |HAZ PonAscendientes;

     |CIERRA #rem00101;

     || Sostenimiento de la iglesia catolica
     |SI aIglesia1 = "I"; |O aIglesia1 = "D";
        eaAlfa = "X";
     |SINO;
        |SI aIglesia1 = "O"; |O aIglesia1 = " "; |O aIglesia1 = "N";
            eaAlfa = "";
        |FINSI;
     |FINSI;
     eaTDato = "A";  enLong = 1;                        |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;

     || Colaboracion en fines sociales
     |SI aIglesia1 = "O"; |O aIglesia1 = "D";
        eaAlfa = "X";
     |SINO;
        |SI aIglesia1 = "I"; |O aIglesia1 = " ";  |O aIglesia1 = "N";
            eaAlfa = "";
        |FINSI;
     |FINSI;
     eaTDato = "A";  enLong = 1;  |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;

     |HAZ GrabaCadena;

     eaCadena = " " * 200;  |HAZ GrabaCadena;
     eaCadena = " " * 200;  |HAZ GrabaCadena;
     eaCadena = " " * 200;  |HAZ GrabaCadena;

     eaCadena = "</T10002000>";
     eaCadena = eaCadena + eaCRLF; |HAZ GrabaCadena;
|FPRC;

|PROCESO Hoja03;
     #rem01001#0 = enVEmpre;
     #rem01001#1 = 0;
     #rem01001#2 = eaVTipo;
     |LEE 000#rem01001.=;
     |SI FSalida ! 0; |DDEFECTO #rem01001; |FINSI;

     |SI #rem01001#14 = "   "; |ACABA;  |FINSI;

     eaCadena = "<T10003000> ";
     |HAZ GrabaCadena;

     eaAlfa = "00000000000000000";
     |SI #rem01001#14 = "107"; eaAlfa = "10000000000000000";  |FINSI;
     |SI #rem01001#14 = "108"; eaAlfa = "01000000000000000";  |FINSI;
     |SI #rem01001#14 = "109"; eaAlfa = "00100000000000000";  |FINSI;
     |SI #rem01001#14 = "110"; eaAlfa = "00010000000000000";  |FINSI;
     |SI #rem01001#14 = "111"; eaAlfa = "00001000000000000";  |FINSI;
     |SI #rem01001#14 = "112"; eaAlfa = "00000100000000000";  |FINSI;
     |SI #rem01001#14 = "113"; eaAlfa = "00000010000000000";  |FINSI;
     |SI #rem01001#14 = "114"; eaAlfa = "00000001000000000";  |FINSI;
     |SI #rem01001#14 = "115"; eaAlfa = "00000000100000000";  |FINSI;
     |SI #rem01001#14 = "116"; eaAlfa = "00000000010000000";  |FINSI;
     |SI #rem01001#14 = "117"; eaAlfa = "00000000001000000";  |FINSI;
     |SI #rem01001#14 = "118"; eaAlfa = "00000000000100000";  |FINSI;
     |SI #rem01001#14 = "119"; eaAlfa = "00000000000010000";  |FINSI;
     |SI #rem01001#14 = "120"; eaAlfa = "00000000000001000";  |FINSI;
     |SI #rem01001#14 = "121"; eaAlfa = "00000000000000100";  |FINSI;
     |SI #rem01001#14 = "122"; eaAlfa = "00000000000000010";  |FINSI;
     |SI #rem01001#14 = "127"; eaAlfa = "00000000000000001";  |FINSI;

     eaCadena = eaAlfa;     |HAZ GrabaCadena;

     eaCadena = " " * 200; |HAZ GrabaCadena;
     eaCadena = " " * 200; |HAZ GrabaCadena;
     eaCadena = " " * 200; |HAZ GrabaCadena;

     eaCadena = "</T10003000>";
     eaCadena = eaCadena + eaCRLF; |HAZ GrabaCadena;
|FPRC;

|PROCESO rem00016;
     |SI #rem00016#4 = 0;
         |ACABA;
     |FINSI;

     nConta  = nConta + 1;

     #m100h004#0 = nConta;
     |LEE 000#m100h004.=;
     |SI FSalida ! 0;
         |DDEFECTO #m100h004;

         #m100h004#0 = nConta;

         |SI nConta > 1;
             #m100h004#5 = "C";
         |FINSI;

         |GRABA 000#m100h004.b;
     |FINSI;

     eaAlfa  = #rem00016#1; |HAZ TContribuyente;

     #m100h004#47 = eaTContri;

     eaTDato = "N";  enLong = 11;  enLongDec = 2;
     eaAlfa = #rem00016#3;  |HAZ FormatoCmp; #m100h004#48 = eaAlfa;
     eaAlfa = #rem00016#4;  |HAZ FormatoCmp; #m100h004#49 = eaAlfa;

     |GRABA 000#m100h004.a;
     |LIBERA #m100h004;
|FPRC;

|DEFBUCLE rem00016;
     #rem00016#1;
     ;
     enVEmpre, aDes;
     enVEmpre, aHas;
     ;
     NULL, rem00016;
|FIN;

|PROCESO rem01002c02;
     |SI #rem01002#8  ! 0;  nTit = 1;  |FINSI;
     |SI #rem01002#9  ! 0;  nCon = 1;  |FINSI;
     |SI #rem01002#10 ! 0;  nHi1 = 1;  |FINSI;
     |SI #rem01002#11 ! 0;  nHi2 = 1;  |FINSI;
     |SI #rem01002#12 ! 0;  nHi3 = 1;  |FINSI;
     |SI #rem01002#13 ! 0;  nHi4 = 1;  |FINSI;
|FPRC;

|DEFBUCLE rem01002c02;
     #rem01002#2;
     ;
     enVEmpre, 0, eaVTipo, 01, aDCas;
     enVEmpre, 0, eaVTipo, 03, aHCas;
     ;
     NULL, rem01002c02;
|FIN;

|PROCESO PrepPag_c02;
     |BUCLE rem01002c02;

     |SI nTit ! 0;
         nPagTit = 1;
     |FINSI;

     |SI nCon ! 0;
         nPagCon = 2;

         |SI nPagTit = 0;
             nPagCon = 1;
         |FINSI;
     |FINSI;

     |SI nHi1 ! 0;
         nPagHi1 = 3;

         |SI nPagCon = 0;
             nPagHi1 = 2;
         |FINSI;

         |SI nPagTit = 0;
          |Y nPagCon = 0;
             nPagHi1 = 1;
         |FINSI;
     |FINSI;

     |SI nHi2 ! 0;
         nPagHi2 = 4;

         |SI nPagHi1 = 0;
             nPagHi2 = 3;
         |FINSI;

         |SI nPagCon = 0;
          |Y nPagHi1 = 0;
             nPagHi2 = 2;
         |FINSI;

         |SI nPagTit = 0;
          |Y nPagCon = 0;
          |Y nPagHi1 = 0;
             nPagHi2 = 1;
         |FINSI;
     |FINSI;

     |SI nHi3 ! 0;
         nPagHi3 = 5;

         |SI nPagHi2 = 0;
             nPagHi3 = 4;
         |FINSI;

         |SI nPagHi1 = 0;
          |Y nPagHi2 = 0;
             nPagHi3 = 3;
         |FINSI;

         |SI nPagCon = 0;
          |Y nPagHi1 = 0;
          |Y nPagHi2 = 0;
             nPagHi3 = 2;
         |FINSI;

         |SI nPagTit = 0;
          |Y nPagCon = 0;
          |Y nPagHi1 = 0;
          |Y nPagHi2 = 0;
             nPagHi3 = 1;
         |FINSI;
     |FINSI;

     |SI nHi4 ! 0;
         nPagHi4 = 6;

         |SI nPagHi3 = 0;
             nPagHi4 = 5;
         |FINSI;

         |SI nPagHi2 = 0;
          |Y nPagHi3 = 0;
             nPagHi4 = 4;
         |FINSI;

         |SI nPagHi1 = 0;
          |Y nPagHi2 = 0;
          |Y nPagHi3 = 0;
             nPagHi4 = 3;
         |FINSI;

         |SI nPagCon = 0;
          |Y nPagHi1 = 0;
          |Y nPagHi2 = 0;
          |Y nPagHi3 = 0;
             nPagHi4 = 2;
         |FINSI;

         |SI nPagTit = 0;
          |Y nPagCon = 0;
          |Y nPagHi1 = 0;
          |Y nPagHi2 = 0;
          |Y nPagHi3 = 0;
             nPagHi4 = 1;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Graba04;
     #m100h004#0 = nPag;
     |LEE 000#m100h004.=;
     |SI FSalida ! 0;
         |DDEFECTO #m100h004;

         #m100h004#0 = nPag;

         |SI nPag > 1;
             #m100h004#5 = "C";
         |FINSI;

         |GRABA 000#m100h004.b;
     |FINSI;

     |SI eaTContri ! "";
         aBlq   = eaCasilla % 102;
         |SI aBlq = "01";  #m100h004#7  = eaTContri; |FINSI;
         |SI aBlq = "01";  #m100h004#8  = a0002;      |FINSI;
         |SI aBlq = "02";  #m100h004#31 = eaTContri;  |FINSI;
     |FINSI;

     eaTDato = "N";  enLong = 11;  enLongDec = 2;
     eaAlfa  = enImp;  |HAZ FormatoCmp;

     #m100h004#nCmp#  = eaAlfa;

     |GRABA 000#m100h004.a;
     |LIBERA #m100h004;
|FPRC;

|PROCESO Lee1010;
     |ABRE #rem01010;
     #rem01010#0 = enVEmpre;
     #rem01010#1 = 0;
     #rem01010#2 = eaAlfa;
     |LEE 000#rem01010.=;
     |SI FSalida ! 0; |DDEFECTO #rem01010; |FINSI;
     |CIERRA #rem01010;

     a0002 = #rem01010#31;
|FPRC;

|PROCESO MeteHoja04;
     |HAZ SacaImporte;
     |SI enImp = 0;  |ACABA;  |FINSI;

     nOk = 0;

     |SI aTipo = "CONJUNTA";     nOk = 1;  |FINSI;
     |SI aTipo = "CONJUNTAE";    nOk = 1;  |FINSI;

     |SI eaCasilla = "01-0018";  nOk = 0;  |FINSI;
     |SI eaCasilla = "01-0019";  nOk = 0;  |FINSI;
     |SI eaCasilla = "01-0020";  nOk = 0;  |FINSI;
     |SI eaCasilla = "01-0021";  nOk = 0;  |FINSI;
     |SI eaCasilla = "01-0022";  nOk = 0;  |FINSI;
     |SI eaCasilla = "01-0023";  nOk = 0;  |FINSI;
     |SI eaCasilla = "01-0025";  nOk = 0;  |FINSI;
     |SI eaCasilla = "02-0041";  nOk = 0;  |FINSI;

     |SI nOk = 1;
         |SI enImpT ! 0;
             enImp = enImpT;
             nPag  = nPagTit;

             eaAlfa = "TITULAR";
             |HAZ TContribuyente;
             |HAZ Lee1010;
             |HAZ Graba04;
         |FINSI;

         |SI enImpC ! 0;
             enImp = enImpC;
             nPag  = nPagCon;

             eaAlfa = "CONYUGE";
             |HAZ TContribuyente;
             |HAZ Lee1010;
             |HAZ Graba04;
         |FINSI;

         |SI enImp1 ! 0;
             enImp = enImp1;
             nPag  = nPagHi1;

             eaAlfa = "1 FAMILIAR";
             |HAZ TContribuyente;
             |HAZ Lee1010;
             |HAZ Graba04;
         |FINSI;

         |SI enImp2 ! 0;
             enImp = enImp2;
             nPag  = nPagHi2;

             eaAlfa = "2 FAMILIAR";
             |HAZ TContribuyente;
             |HAZ Lee1010;
             |HAZ Graba04;
         |FINSI;

         |SI enImp3 ! 0;
             enImp = enImp3;
             nPag  = nPagHi3;

             eaAlfa = "3 FAMILIAR";
             |HAZ TContribuyente;
             |HAZ Lee1010;
             |HAZ Graba04;
         |FINSI;

         |SI enImp4 ! 0;
             enImp = enImp4;
             nPag  = nPagHi4;

             eaAlfa = "4 FAMILIAR";
             |HAZ TContribuyente;
             |HAZ Lee1010;
             |HAZ Graba04;
         |FINSI;

         |ACABA;
     |FINSI;

     nOk = 0;
     |SI aTipo = "CONJUNTA";     nOk = 1;  |FINSI;
     |SI aTipo = "CONJUNTAE";    nOk = 1;  |FINSI;

     nPag      = 1;
     eaTContri = "";
     |SI nOk = 0;
         eaAlfa = eaVTipo;
         |HAZ Lee1010;
         |HAZ TContribuyente;
     |FINSI;

     |HAZ Graba04;
|FPRC;

|PROCESO Hoja04;
     enPagina = 4;
     |HAZ MiraObligatoria;
     |SI enConDatos = 0; |ACABA; |FINSI;

     aFicTmp = "m100h004" + Usuario;
     |NOME_DAT #m100h004#aFicTmp#;
     |ABRE #m100h004;  |CIERRA #m100h004;  |DELINDEX #m100h004;

     eaVTipo = eaTipo; aTipo = eaVTipo % 0110;

     |ABRE #m100h004;

     nPagTit = 1;
     nPagCon = 0;
     nPagHi1 = 0;
     nPagHi2 = 0;
     nPagHi3 = 0;
     nPagHi4 = 0;

     |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
         nTit    = 0;
         nCon    = 0;
         nHi1    = 0;
         nHi2    = 0;
         nHi3    = 0;
         nHi4    = 0;
         nPagTit = 0;
         nPagCon = 0;
         nPagHi1 = 0;
         nPagHi2 = 0;
         nPagHi3 = 0;
         nPagHi4 = 0;
         aDCas   = "0003";
         aHCas   = "0041";

         |HAZ PrepPag_c02;
     |FINSI;

     eaCasilla = "01-0003";  nCmp = 9;   |HAZ MeteHoja04;
     eaCasilla = "01-0004";  nCmp = 10;  |HAZ MeteHoja04;
     eaCasilla = "01-0005";  nCmp = 11;  |HAZ MeteHoja04;
     eaCasilla = "01-0006";  nCmp = 12;  |HAZ MeteHoja04;
     eaCasilla = "01-0007";  nCmp = 13;  |HAZ MeteHoja04;
     eaCasilla = "01-0008";  nCmp = 14;  |HAZ MeteHoja04;
     eaCasilla = "01-0009";  nCmp = 15;  |HAZ MeteHoja04;
     eaCasilla = "01-0010";  nCmp = 16;  |HAZ MeteHoja04;
     eaCasilla = "01-0011";  nCmp = 17;  |HAZ MeteHoja04;
     eaCasilla = "01-0012";  nCmp = 18;  |HAZ MeteHoja04;
     eaCasilla = "01-0013";  nCmp = 19;  |HAZ MeteHoja04;
     eaCasilla = "01-0014";  nCmp = 20;  |HAZ MeteHoja04;
     eaCasilla = "01-0015";  nCmp = 21;  |HAZ MeteHoja04;
     eaCasilla = "01-0016";  nCmp = 22;  |HAZ MeteHoja04;
     eaCasilla = "01-0017";  nCmp = 23;  |HAZ MeteHoja04;
     eaCasilla = "01-0018";  nCmp = 24;  |HAZ MeteHoja04;
     eaCasilla = "01-0019";  nCmp = 25;  |HAZ MeteHoja04;
     eaCasilla = "01-0020";  nCmp = 26;  |HAZ MeteHoja04;
     eaCasilla = "01-0021";  nCmp = 27;  |HAZ MeteHoja04;
     eaCasilla = "01-0022";  nCmp = 28;  |HAZ MeteHoja04;
     eaCasilla = "01-0023";  nCmp = 29;  |HAZ MeteHoja04;
     eaCasilla = "01-0025";  nCmp = 30;  |HAZ MeteHoja04;

     eaCasilla = "02-0026";  nCmp = 31;  |HAZ MeteHoja04;
     eaCasilla = "02-0027";  nCmp = 32;  |HAZ MeteHoja04;
     eaCasilla = "02-0028";  nCmp = 33;  |HAZ MeteHoja04;
     eaCasilla = "02-0029";  nCmp = 34;  |HAZ MeteHoja04;
     eaCasilla = "02-0030";  nCmp = 35;  |HAZ MeteHoja04;
     eaCasilla = "02-0031";  nCmp = 36;  |HAZ MeteHoja04;
     eaCasilla = "02-0032";  nCmp = 37;  |HAZ MeteHoja04;
     eaCasilla = "02-0033";  nCmp = 38;  |HAZ MeteHoja04;
     eaCasilla = "02-0034";  nCmp = 39;  |HAZ MeteHoja04;
     eaCasilla = "02-0035";  nCmp = 40;  |HAZ MeteHoja04;
     eaCasilla = "02-0036";  nCmp = 41;  |HAZ MeteHoja04;
     eaCasilla = "02-0037";  nCmp = 42;  |HAZ MeteHoja04;
     eaCasilla = "02-0038";  nCmp = 43;  |HAZ MeteHoja04;
     eaCasilla = "02-0039";  nCmp = 44;  |HAZ MeteHoja04;
     eaCasilla = "02-0040";  nCmp = 45;  |HAZ MeteHoja04;
     eaCasilla = "02-0041";  nCmp = 46;  |HAZ MeteHoja04;

     aDes   = aTipo;
     aHas   = aTipo;
     |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
         aDes = "";
         aHas = "zzzzzzzzzz";
     |FINSI;

     nConta = 0;  |BUCLE rem00016;

     |LEE 000#m100h004.p;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
         |PARA nCampo = 1;  |SI nCampo [ 53;  |HACIENDO nCampo = nCampo + 1;
               eaAlfa = #m100h004#nCampo#; |HAZ QuitaRaros;
               #m100h004#nCampo# = eaAlfa;

               eaAlfa = #m100h004#nCampo#;
               |XGRABA enHandle, eaAlfa;
         |SIGUE;
         eaAlfa = eaCRLF;  |XGRABA enHandle, eaAlfa;

         |LEE 000#m100h004.s;
     |SIGUE;

     |CIERRA #m100h004;
     |DELINDEX #m100h004;
|FPRC;

|PROCESO Graba05;
     #m100h005#0 = nPag;
     |LEE 000#m100h005.=;
     |SI FSalida ! 0;
         |DDEFECTO #m100h005;

         #m100h005#0 = nPag;

         |SI nPag > 1;
             #m100h005#5 = "C";
         |FINSI;

         |GRABA 000#m100h005.b;
     |FINSI;

     |SI eaTContri ! "";
         aBlq   = eaCasilla % 102;
         |SI aBlq = "03";  #m100h005#7  = eaTContri;  |FINSI;
         |SI aBlq = "03";  #m100h005#11 = a0049;      |FINSI;
     |FINSI;

     eaTDato = "N";  enLong = 11;  enLongDec = 2;
     eaAlfa  = enImp;  |HAZ FormatoCmp;

     #m100h005#nCmp#  = eaAlfa;

     |GRABA 000#m100h005.a;
     |LIBERA #m100h005;
|FPRC;

|PROCESO Lee1012;
     |ABRE #rem01012;
     #rem01012#0 = enVEmpre;
     #rem01012#1 = 0;
     #rem01012#2 = eaAlfa;
     |LEE 000#rem01012.=;
     |SI FSalida ! 0; |DDEFECTO #rem01012; |FINSI;
     |CIERRA #rem01012;

     a0049 = #rem01012#32;
|FPRC;

|PROCESO MeteHoja05;
     |HAZ SacaImporte;
     |SI enImp = 0;  |ACABA;  |FINSI;

     nOk = 0;
     |SI aTipo = "CONJUNTA";     nOk = 1;  |FINSI;
     |SI aTipo = "CONJUNTAE";    nOk = 1;  |FINSI;
     |SI eaCasilla = "03-0060";  nOk = 0;  |FINSI;

     |SI nOk = 1;
         |SI enImpT ! 0;
             enImp = enImpT;
             nPag  = nPagTit;

             eaAlfa = "TITULAR";
             |HAZ TContribuyente;
             |HAZ Lee1012;
             |HAZ Graba05;
         |FINSI;

         |SI enImpC ! 0;
             enImp = enImpC;
             nPag  = nPagCon;

             eaAlfa = "CONYUGE";
             |HAZ TContribuyente;
             |HAZ Lee1012;
             |HAZ Graba05;
         |FINSI;

         |SI enImp1 ! 0;
             enImp = enImp1;
             nPag  = nPagHi1;

             eaAlfa = "1 FAMILIAR";
             |HAZ TContribuyente;
             |HAZ Lee1012;
             |HAZ Graba05;
         |FINSI;

         |SI enImp2 ! 0;
             enImp = enImp2;
             nPag  = nPagHi2;

             eaAlfa = "2 FAMILIAR";
             |HAZ TContribuyente;
             |HAZ Lee1012;
             |HAZ Graba05;
         |FINSI;

         |SI enImp3 ! 0;
             enImp = enImp3;
             nPag  = nPagHi3;

             eaAlfa = "3 FAMILIAR";
             |HAZ TContribuyente;
             |HAZ Lee1012;
             |HAZ Graba05;
         |FINSI;

         |SI enImp4 ! 0;
             enImp = enImp4;
             nPag  = nPagHi4;

             eaAlfa = "4 FAMILIAR";
             |HAZ TContribuyente;
             |HAZ Lee1012;
             |HAZ Graba05;
         |FINSI;

         |ACABA;
     |FINSI;

     nOk = 0;
     |SI aTipo = "CONJUNTA";     nOk = 1;  |FINSI;
     |SI aTipo = "CONJUNTAE";    nOk = 1;  |FINSI;

     nPag      = 1;
     eaTContri = "";
     |SI nOk = 0;
         eaAlfa = eaVTipo;
         |HAZ TContribuyente;
         |HAZ Lee1012;
     |FINSI;

     |HAZ Graba05;
|FPRC;

|PROCESO rem01011c02;
     nConta  = nConta + 1;
     nPag    = nConta;

     #m100h005#0 = nPag;
     |LEE 000#m100h005.=;
     |SI FSalida ! 0;
         |DDEFECTO #m100h005;

         #m100h005#0 = nPag;

         |SI nPag > 1;
             #m100h005#5 = "C";
         |FINSI;

         |GRABA 000#m100h005.b;
     |FINSI;

     eaTDato = "N";  enLong = 3;  enLongDec = 0;
     eaAlfa = #rem01011#38; |HAZ FormatoCmp;     #m100h005#20 = eaAlfa;
     eaAlfa = #rem01011#4;  |HAZ TContribuyente; #m100h005#21 = eaTContri;

     eaTDato = "N";  enLong = 3;  enLongDec = 2;
     eaAlfa = #rem01011#5;  |HAZ FormatoCmp;     #m100h005#22 = eaAlfa;
     eaAlfa = #rem01011#23; |HAZ FormatoCmp;     #m100h005#23 = eaAlfa;

     enLong = 1; enLongDec = 0;
     eaAlfa = #rem01011#6;  |HAZ FormatoCmp;     #m100h005#24 = eaAlfa;
     eaAlfa = #rem01011#7;  |HAZ FormatoCmp;     #m100h005#25 = eaAlfa;
     eaAlfa = #rem01011#8;  |HAZ FormatoCmp;     #m100h005#26 = eaAlfa;

     eaTDato = "A";  enLong = 20;  enLongDec = 0;
     eaAlfa = #rem01011#9;  |HAZ FormatoCmp;     #m100h005#27 = eaAlfa;

     |SI #rem01011#7 = "6";
         eaTDato = "A";  enLong = 20;  enLongDec = 0;
         eaAlfa  = #rem01011#32;  |HAZ FormatoCmp;  #m100h005#28 = eaAlfa;
         |QBF eaAlfa;

         #m100h005#29 = "0";
         |SI eaAlfa = "";
             #m100h005#29 = "1";
         |FINSI;
     |FINSI;

     eaTDato = "A";  enLong = 65;  enLongDec = 0;
     eaAlfa  = #rem01011#33;  |HAZ FormatoCmp;  #m100h005#30 = eaAlfa;

     |SI #rem01011#7 = 1; #rem01011#10 = 0; |FINSI;

     eaTDato = "N";  enLong = 3;  enLongDec = 2;
     eaAlfa = #rem01011#10;  |HAZ FormatoCmp;     #m100h005#31= eaAlfa;

     eaTDato = "N";  enLong = 3;  enLongDec = 0;
     eaAlfa = #rem01011#11;  |HAZ FormatoCmp;     #m100h005#32 = eaAlfa;

     eaTDato = "N";  enLong = 11;  enLongDec = 2;
     eaAlfa = #rem01011#12;  |HAZ FormatoCmp;     #m100h005#33 = eaAlfa;

     eaTDato = "A";  enLong = 20;  enLongDec = 0;
     eaAlfa = #rem01011#34;  |HAZ FormatoCmp;     #m100h005#34 = eaAlfa;
     eaAlfa = #rem01011#36;  |HAZ FormatoCmp;     #m100h005#36 = eaAlfa;

     #m100h005#35 = "0";
     #m100h005#37 = "0";
     |SI  #rem01011#35 = "X";  #m100h005#35 = "1";  |FINSI;
     |SI  #rem01011#37 = "X";  #m100h005#37 = "1";  |FINSI;

     eaTDato = "N";  enLong = 11;  enLongDec = 2;
     eaAlfa = #rem01011#13;  |HAZ FormatoCmp;     #m100h005#38 = eaAlfa;
     eaAlfa = #rem01011#22;  |HAZ FormatoCmp;     #m100h005#39 = eaAlfa;
     eaAlfa = #rem01011#14;  |HAZ FormatoCmp;     #m100h005#40 = eaAlfa;
     eaAlfa = #rem01011#15;  |HAZ FormatoCmp;     #m100h005#41 = eaAlfa;
     eaAlfa = #rem01011#24;  |HAZ FormatoCmp;     #m100h005#42 = eaAlfa;
     eaAlfa = #rem01011#25;  |HAZ FormatoCmp;     #m100h005#43 = eaAlfa;
     eaAlfa = #rem01011#26;  |HAZ FormatoCmp;     #m100h005#44 = eaAlfa;
     eaAlfa = #rem01011#27;  |HAZ FormatoCmp;     #m100h005#45 = eaAlfa;
     eaAlfa = #rem01011#28;  |HAZ FormatoCmp;     #m100h005#46 = eaAlfa;
     eaAlfa = #rem01011#16;  |HAZ FormatoCmp;     #m100h005#47 = eaAlfa;
     eaAlfa = #rem01011#17;  |HAZ FormatoCmp;     #m100h005#48 = eaAlfa;
     eaAlfa = #rem01011#18;  |HAZ FormatoCmp;     #m100h005#49 = eaAlfa;
     eaAlfa = #rem01011#19;  |HAZ FormatoCmp;     #m100h005#50 = eaAlfa;
     eaAlfa = #rem01011#20;  |HAZ FormatoCmp;     #m100h005#51 = eaAlfa;
     eaAlfa = #rem01011#21;  |HAZ FormatoCmp;     #m100h005#52 = eaAlfa;

     |SI #m100h005#0 = 1;
         eaTDato = "N";  enLong = 11;  enLongDec = 2;

         eaCasilla = "04-0094";  |HAZ SacaImporte;
         eaAlfa = enImp;  |HAZ FormatoCmp;     #m100h005#53 = eaAlfa;

         eaCasilla = "04-0095";  |HAZ SacaImporte;
         eaAlfa = enImp;  |HAZ FormatoCmp;     #m100h005#54 = eaAlfa;
     |FINSI;

     |GRABA 000#m100h005.a;
     |LIBERA #m100h005;
|FPRC;

|DEFBUCLE rem01011c02;
     #rem01011#1;
     ;
     enVEmpre, 0, aTipo2, 001;
     enVEmpre, 0, aTipo2, 999;
     ;
     NULL, rem01011c02;
|FIN;

|PROCESO rem01015c02;
     nConta  = nConta + 1;
     nEleme  = nEleme + 1;
     |SI nEleme > 3; nEleme = 1;  |FINSI;

     nPag    = ((nConta / 3) + 0.49) ! 0;

     #m100h005#0 = nPag;
     |LEE 000#m100h005.=;
     |SI FSalida ! 0;
         |DDEFECTO #m100h005;

         #m100h005#0 = nPag;

         |SI nPag > 1;
             #m100h005#5 = "C";
         |FINSI;

         |GRABA 000#m100h005.b;
     |FINSI;

     |SI nEleme = 1;  nCmp = 56;  |FINSI;
     |SI nEleme = 2;  nCmp = 63;  |FINSI;
     |SI nEleme = 3;  nCmp = 70;  |FINSI;

     eaAlfa = #rem01015#4; |HAZ TContribuyente; #m100h005#nCmp# = eaTContri;

     eaTDato = "A";  enLong = 20;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01015#5;  |HAZ FormatoCmp; #m100h005#nCmp# = eaAlfa;

     eaTDato = "N";  enLong = 3;  enLongDec = 2;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01015#6;  |HAZ FormatoCmp; #m100h005#nCmp# = eaAlfa;

     eaTDato = "N";  enLong = 1;  enLongDec = 0;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01015#7;  |HAZ FormatoCmp; #m100h005#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01015#8;  |HAZ FormatoCmp; #m100h005#nCmp# = eaAlfa;

     eaTDato = "A";  enLong = 20;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01015#9;  |HAZ FormatoCmp; #m100h005#nCmp# = eaAlfa;

                              eaAlfa = "0";
     |SI #rem01015#10 = "S";  eaAlfa = "1";  |FINSI;

     eaTDato = "N";  enLong = 1;  enLongDec = 0;
     nCmp    = nCmp + 1;  |HAZ FormatoCmp; #m100h005#nCmp# = eaAlfa;

     |GRABA 000#m100h005.a;
     |LIBERA #m100h005;
|FPRC;

|DEFBUCLE rem01015c02;
     #rem01015#1;
     ;
     enVEmpre, 0, aTipo2, 001;
     enVEmpre, 0, aTipo2, 999;
     ;
     NULL, rem01015c02;
|FIN;

|PROCESO rem01013c02;
     nConta  = nConta + 1;
     nEleme  = nEleme + 1;
     |SI nEleme > 3; nEleme = 1;  |FINSI;

     nPag    = ((nConta / 3) + 0.49) ! 0;

     #m100h005#0 = nPag;
     |LEE 000#m100h005.=;
     |SI FSalida ! 0;
         |DDEFECTO #m100h005;

         #m100h005#0 = nPag;

         |SI nPag > 1;
             #m100h005#5 = "C";
         |FINSI;

         |GRABA 000#m100h005.b;
     |FINSI;

     |SI nEleme = 1;  nCmp = 77;  |FINSI;
     |SI nEleme = 2;  nCmp = 83;  |FINSI;
     |SI nEleme = 3;  nCmp = 89;  |FINSI;

     eaAlfa = #rem01013#4; |HAZ TContribuyente; #m100h005#nCmp# = eaTContri;

     eaTDato = "N";  enLong = 3;  enLongDec = 2;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01013#5;  |HAZ FormatoCmp; #m100h005#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01013#7;  |HAZ FormatoCmp; #m100h005#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01013#8;                   #m100h005#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01013#9;                   #m100h005#nCmp# = eaAlfa;

     eaTDato = "A";  enLong = 20;  enLongDec = 0;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01013#6;  |HAZ FormatoCmp; #m100h005#nCmp# = eaAlfa;

     |GRABA 000#m100h005.a;
     |LIBERA #m100h005;
|FPRC;

|DEFBUCLE rem01013c02;
     #rem01013#1;
     ;
     enVEmpre, 0, aTipo2, 001;
     enVEmpre, 0, aTipo2, 999;
     ;
     NULL, rem01013c02;
|FIN;

|PROCESO Hoja05;
     enPagina = 5; |HAZ MiraObligatoria;
     |SI enConDatos = 0; |ACABA; |FINSI;

     aFicTmp = "m100h005" + Usuario;
     |NOME_DAT #m100h005#aFicTmp#;
     |ABRE #m100h005;  |CIERRA #m100h005;  |DELINDEX #m100h005;

     eaVTipo = eaTipo;
     aTipo   = eaVTipo % 0110;
     aTipo2  = (aTipo + "          ") % 110;

     |ABRE #m100h005;

     nPagTit = 1;
     nPagCon = 0;
     nPagHi1 = 0;
     nPagHi2 = 0;
     nPagHi3 = 0;
     nPagHi4 = 0;

     |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
         nTit    = 0;
         nCon    = 0;
         nHi1    = 0;
         nHi2    = 0;
         nHi3    = 0;
         nHi4    = 0;
         nPagTit = 0;
         nPagCon = 0;
         nPagHi1 = 0;
         nPagHi2 = 0;
         nPagHi3 = 0;
         nPagHi4 = 0;
         aDCas   = "0045";
         aHCas   = "0056";

         |HAZ PrepPag_c02;
     |FINSI;

     eaCasilla = "03-0046";  nCmp = 8;   |HAZ MeteHoja05;
     eaCasilla = "03-0047";  nCmp = 9;   |HAZ MeteHoja05;
     eaCasilla = "03-0048";  nCmp = 10;  |HAZ MeteHoja05;
     eaCasilla = "03-0050";  nCmp = 12;  |HAZ MeteHoja05;
     eaCasilla = "03-0051";  nCmp = 13;  |HAZ MeteHoja05;
     eaCasilla = "03-0052";  nCmp = 14;  |HAZ MeteHoja05;
     eaCasilla = "03-0053";  nCmp = 15;  |HAZ MeteHoja05;
     eaCasilla = "03-0054";  nCmp = 16;  |HAZ MeteHoja05;
     eaCasilla = "03-0055";  nCmp = 17;  |HAZ MeteHoja05;
     eaCasilla = "03-0056";  nCmp = 18;  |HAZ MeteHoja05;
     eaCasilla = "03-0060";  nCmp = 19;  |HAZ MeteHoja05;

     nConta = 0;             |BUCLE rem01011c02;
     nConta = 0; nEleme = 0; |BUCLE rem01015c02;
     nConta = 0; nEleme = 0; |BUCLE rem01013c02;

     |LEE 000#m100h005.p;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
         |PARA nCampo = 1;  |SI nCampo [ 98;  |HACIENDO nCampo = nCampo + 1;
               eaAlfa = #m100h005#nCampo#; |HAZ QuitaRaros;
               #m100h005#nCampo# = eaAlfa;

               eaAlfa = #m100h005#nCampo#;
               |XGRABA enHandle, eaAlfa;
         |SIGUE;
         eaAlfa = eaCRLF;  |XGRABA enHandle, eaAlfa;

         |LEE 000#m100h005.s;
     |SIGUE;

     |CIERRA #m100h005;
     |DELINDEX #m100h005;
|FPRC;

|PROCESO ImporteCadena;
     enImp = 0;
     |SI #rem01001#14 ! "127";
         |HAZ SacaImporte;
     |FINSI;

     eaAlfa = enImp;  |HAZ FormatoCmp;
     eaCadena = eaAlfa;
     |HAZ GrabaCadena;

     eaCadena = "";
|FPRC;

|PROCESO Hoja35;
     eaVTipo = eaTipo;
     aTipo   = eaVTipo % 0110;
     aTipo2  = (aTipo + "          ") % 110;

     #rem01001#0 = enVEmpre;
     #rem01001#1 = 0;
     #rem01001#2 = eaVTipo;
     |LEE 000#rem01001.=;
     |SI FSalida ! 0;  |DDEFECTO #rem01001;  |FINSI;

     eaCadena = "<T10035000> ";
     |HAZ GrabaCadena;  eaCadena = "";

     eaTDato = "N"; enLong = 11; enLongDec = 2;

     eaCasilla = "35-0505";  |HAZ ImporteCadena;
     eaCasilla = "36-0510";  |HAZ ImporteCadena;
     eaCasilla = "39-0545";  |HAZ ImporteCadena;
     eaCasilla = "40-0546";  |HAZ ImporteCadena;
     eaCasilla = "39-0570";  |HAZ ImporteCadena;
     eaCasilla = "40-0571";  |HAZ ImporteCadena;

     enImp  = 0;
     nTotal = 0;
     nSusp  = 0;

     |SI #rem01001#14 ! "127";
         eaCasilla = "47-0693";  |HAZ SacaImporte;  nTotal = enImp;

         |SI enError = 1; |O nTotal = 0;
             eaCasilla = "48-0694";  |HAZ SacaImporte;  nTotal = enImp;
         |FINSI;

         |SI enError = 1; |O nTotal = 0;
             eaCasilla = "43-0670";  |HAZ SacaImporte;  nTotal = enImp;
             nSusp = 0;
         |SINO;
             nSusp = 1;
             nTotal = #rem01001#16;
         |FINSI;
     |FINSI;

     nConCta = 0;
     eaAlfa = nTotal; |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     |HAZ GrabaCadena;  eaCadena = "";

     |SI eaTipoBor ! "";
         aTipo = eaVTipo; |QBF aTipo;
         |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
              #rem00100#57 = "X";
         |FINSI;
     |FINSI;

     |SI #rem01001#14 ! "127";
         aTipo = eaVTipo; |QBF aTipo;
         |SI #rem00100#57 = "X";
             aSeparada = "N";
             |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
                 eaCadena = eaCadena + "2";
             |SINO;
                 eaCadena = eaCadena + "1";
             |FINSI;
         |SINO;
             aSeparada = "S";
             eaCadena = eaCadena + "1";
         |FINSI;

         eaAlfa = nSusp; eaCadena = eaCadena + eaAlfa;
     |SINO;
         eaCadena = eaCadena + "00";
     |FINSI;

     |SI #rem01001#14 ! "127";
         eaCasilla = "45-0680";  |HAZ SacaImporte;

         |SI #rem01001#14 = "4"; enImp = 0; |FINSI;
     |FINSI;

     nCalc  = enImp;
     eaAlfa = enImp; |HAZ FormatoCmp;  eaCadena = eaCadena + eaAlfa;
     |SI nCalc ! 0; nTotal = nCalc;  |FINSI;

     nConCta = 0;
     |SI nTotal > 0;
         |SI #rem01001#8 = "S";
             eaAlfa = "01";
         |SINO;
             eaAlfa = "10";
         |FINSI;
         eaCadena = eaCadena + eaAlfa;

         nCalc1 = #rem01001#16;
         |SI #rem01001#8 = "S";
             nCalc1 = (nCalc1 % 60) ! 2;
         |FINSI;

         |SI #rem01001#14 = "127";
             nCalc1 = 0;
         |FINSI;

         eaAlfa = nCalc1; |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;

         |SI #rem01001#9 = "E"; eaAlfa = "1";              |FINSI;
         |SI #rem01001#9 = "A"; eaAlfa = "2"; nConCta = 1; |FINSI;
         |SI #rem01001#9 = "D"; eaAlfa = "3"; nConCta = 1; |FINSI;
         eaCadena = eaCadena + eaAlfa;

         |SI #rem01001#8 = "S";
             |SI #rem01001#10 = "S";
                 eaAlfa = "01"; nConCta = 1;
             |SINO;
                 eaAlfa = "10";
             |FINSI;
         |SINO;
             eaAlfa = "00";
         |FINSI;
         eaCadena = eaCadena + eaAlfa;

         nCalc1 = 0;
         |SI #rem01001#8 = "S"; |Y #rem01001#10 = "S";
             nCalc1 = (#rem01001#16 % 40) ! 2;
         |FINSI;

         |SI #rem01001#14 = "127";
             nCalc1 = 0;
         |FINSI;

         eaAlfa = nCalc1; |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     |SINO;
         eaCadena = eaCadena + "00";
         eaAlfa = 0; |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;

         eaCadena = eaCadena + "0";
         eaCadena = eaCadena + "00";
         eaAlfa = 0; |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     |FINSI;

     |SI nTotal < 0;
         nTotal = 0 - nTotal; eaAlfa = "";
         |SI #rem01001#11 = "X";
             eaCadena = eaCadena + "2";
         |SINO;
             |SI #rem01001#12 = "X";
                 eaCadena = eaCadena + "1";
                 nConCta = 1;
             |SINO;
                 eaCadena = eaCadena + "0";
             |FINSI;
         |FINSI;

         eaAlfa = nTotal; |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     |SINO;
         eaCadena = eaCadena + "0";
         eaAlfa = 0; |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     |FINSI;

     |SI nConCta = 1;  |Y #rem01001#14 ! "127";
         eaTDato = "A"; enLong = 34;   enLongDec = 0;
         eaAlfa = eaCuenta1; |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;

         eaTDato = "A"; enLong = 11;   enLongDec = 0;
         eaAlfa = eaBIC1; |HAZ FormatoCmp; eaCadena = eaCadena + eaAlfa;
     |SINO;
         eaCadena = eaCadena + (" " * 45);
     |FINSI;
     |HAZ GrabaCadena;  eaCadena = "";

     eaCadena = " " * 200;  |HAZ GrabaCadena;
     eaCadena = " " * 200;  |HAZ GrabaCadena;
     eaCadena = " " * 200;  |HAZ GrabaCadena;

     eaCadena = eaCadena + "</T10035000>" + eaCRLF; |HAZ GrabaCadena;
|FPRC;
