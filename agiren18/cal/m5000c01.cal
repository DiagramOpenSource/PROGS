||DESCARGAS

|FICHEROS;
     rem05000;
     rem05001;
     rem05002;
     rem05003;
     rem05004;
     rem05005;
     rem05006;
     rem05007;
     rem05008;
     rem05009;
     rem05010;
     rem05031;

     zregubic;

     tempora0@;
|FIN;

|INCLUYE m5000c99;

|PROCESO ClaveRT;
     nLinea = 1;

     |ABRE #rem05001;
     #rem05001#0 = #rem05000#0;
     #rem05001#1 = enContri;
     #rem05001#2 = 999;
     |LEE 000#rem05001.];
     |SI FSalida = 0;
         |LEE 000#rem05001.a;
     |SINO;
         |LEE 000#rem05001.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05001#0 = #rem05000#0; |Y #rem05001#1 = enContri;
         nLinea = #rem05001#2 + 1;
     |FINSI;

     |DDEFECTO #rem05001;
     #rem05001#0   = #rem05000#0;
     #rem05001#1   = enContri;
     #rem05001#2   = nLinea;
     #rem05001#3   = aNegro;
     #rem05001#4   = "Pendiente";
     #rem05001#5   = "rem00020";
     #rem05001#6   = 0;
     #rem05001#7   = eaCadena1 % 0909;
     #rem05001#8   = eaCadena1 % 1840;

     eaAlfa = eaCadena1 % 5802;
     |SI eaAlfa = "A ";  #rem05001#9 = "Empleados";             |FINSI;
     |SI eaAlfa = "B1";  #rem05001#9 = "Pensionistas";          |FINSI;
     |SI eaAlfa = "B2";  #rem05001#9 = "Pensionistas";          |FINSI;
     |SI eaAlfa = "B3";  #rem05001#9 = "Pensionistas";          |FINSI;
     |SI eaAlfa = "C ";  #rem05001#9 = "Prestaci¢n desempleo";  |FINSI;
     |SI eaAlfa = "D ";  #rem05001#9 = "Prestaci¢n desempleo";  |FINSI;
     |SI eaAlfa = "E1";  #rem05001#9 = "Consej.y adminstrad.";  |FINSI;
     |SI eaAlfa = "E2";  #rem05001#9 = "Consej.y adminstrad.";  |FINSI;
     |SI eaAlfa = "E3";  #rem05001#9 = "Consej.y adminstrad.";  |FINSI;
     |SI eaAlfa = "E4";  #rem05001#9 = "Consej.y adminstrad.";  |FINSI;
     |SI eaAlfa = "F1";  #rem05001#9 = "Premios             ";  |FINSI;
     |SI eaAlfa = "F2";  #rem05001#9 = "Premios             ";  |FINSI;
     |SI eaAlfa = "L ";  #rem05001#9 = "Rentas exentas";        |FINSI;

     eaAlfa = eaCadena1 % 6013;  |HAZ CtrlImporte;  #rem05001#10 = eaAlfa;  #rem05001#10 = #rem05001#10 / 100;
     eaAlfa = eaCadena1 % 7313;  |HAZ CtrlImporte;  #rem05001#11 = eaAlfa;  #rem05001#11 = #rem05001#11 / 100;
     eaAlfa = eaCadena1 % 8613;  |HAZ CtrlImporte;  #rem05001#12 = eaAlfa;  #rem05001#12 = #rem05001#12 / 100;
     eaAlfa = eaCadena1 % 9913;  |HAZ CtrlImporte;  #rem05001#13 = eaAlfa;  #rem05001#13 = #rem05001#13 / 100;
     eaAlfa = eaCadena1 % 11213; |HAZ CtrlImporte;  #rem05001#14 = eaAlfa;  #rem05001#14 = #rem05001#14 / 100;
     eaAlfa = eaCadena1 % 12513; |HAZ CtrlImporte;  #rem05001#15 = eaAlfa;  #rem05001#15 = #rem05001#15 / 100;
     eaAlfa = eaCadena1 % 13813; |HAZ CtrlImporte;  #rem05001#16 = eaAlfa;  #rem05001#16 = #rem05001#16 / 100;
     eaAlfa = eaCadena1 % 15113; |HAZ CtrlImporte;  #rem05001#17 = eaAlfa;  #rem05001#17 = #rem05001#17 / 100;
     eaAlfa = eaCadena1 % 16413; |HAZ CtrlImporte;  #rem05001#18 = eaAlfa;  #rem05001#18 = #rem05001#18 / 100;
     eaAlfa = eaCadena1 % 17713; |HAZ CtrlImporte;  #rem05001#19 = eaAlfa;  #rem05001#19 = #rem05001#19 / 100;
     eaAlfa = eaCadena1 % 19013; |HAZ CtrlImporte;  #rem05001#20 = eaAlfa;  #rem05001#20 = #rem05001#20 / 100;
     eaAlfa = eaCadena1 % 20313; |HAZ CtrlImporte;  #rem05001#21 = eaAlfa;  #rem05001#21 = #rem05001#21 / 100;
     eaAlfa = eaCadena1 % 21613; |HAZ CtrlImporte;  #rem05001#22 = eaAlfa;  #rem05001#22 = #rem05001#22 / 100;
     eaAlfa = eaCadena1 % 22913; |HAZ CtrlImporte;  #rem05001#23 = eaAlfa;  #rem05001#23 = #rem05001#23 / 100;

     eaAlfa = eaCadena1 % 24201;
     |SI eaAlfa = "0";  #rem05001#24 = "N";   |FINSI;
     |SI eaAlfa = "1";  #rem05001#24 = "S";   |FINSI;

     eaAlfa = eaCadena1 % 24301;
     |SI eaAlfa = "0";  #rem05001#25 = "N";   |FINSI;
     |SI eaAlfa ! "0";  #rem05001#25 = "S";   |FINSI;

     #rem05001#26 = eaCadena1 % 24401;

     |GRABA 020#rem05001.n;
     |LIBERA #rem05001;
     |CIERRA #rem05001;
|FPRC;

|PROCESO ClaveRC;
     nLinea = 1;

     |ABRE #rem05008;
     #rem05008#0 = #rem05000#0;
     #rem05008#1 = enContri;
     #rem05008#2 = 999;
     |LEE 000#rem05008.];
     |SI FSalida = 0;
         |LEE 000#rem05008.a;
     |SINO;
         |LEE 000#rem05008.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05008#0 = #rem05000#0; |Y #rem05008#1 = enContri;
         nLinea = #rem05008#2 + 1;
     |FINSI;

     |DDEFECTO #rem05008;
     #rem05008#0   = #rem05000#0;
     #rem05008#1   = enContri;
     #rem05008#2   = nLinea;
     #rem05008#3   = aNegro;
     #rem05008#4   = "Pendiente";
     #rem05008#5   = "rem00031";
     #rem05008#6   = 0;
     #rem05008#7   = eaCadena1 % 0909;
     #rem05008#8   = eaCadena1 % 1840;

     eaAlfa = eaCadena1 % 5801;
     |SI eaAlfa = "G";  #rem05008#9 = "Profesionales";         |FINSI;
     |SI eaAlfa = "H";  #rem05008#9 = "Agr¡colas";             |FINSI;
     |SI eaAlfa = "I";  #rem05008#9 = "Art¡culo 70.2";         |FINSI;
     |SI eaAlfa = "J";  #rem05008#9 = "Derechos imagen";       |FINSI;

     eaAlfa = eaCadena1 % 6013;   |HAZ CtrlImporte;  #rem05008#10 = eaAlfa;  #rem05008#10 = #rem05008#10 / 100;
     eaAlfa = eaCadena1 % 7313;   |HAZ CtrlImporte;  #rem05008#11 = eaAlfa;  #rem05008#11 = #rem05008#11 / 100;
     eaAlfa = eaCadena1 % 8613;   |HAZ CtrlImporte;  #rem05008#12 = eaAlfa;  #rem05008#12 = #rem05008#12 / 100;
     eaAlfa = eaCadena1 % 9913;   |HAZ CtrlImporte;  #rem05008#13 = eaAlfa;  #rem05008#13 = #rem05008#13 / 100;
     eaAlfa = eaCadena1 % 11213;  |HAZ CtrlImporte;  #rem05008#14 = eaAlfa;  #rem05008#14 = #rem05008#14 / 100;
     eaAlfa = eaCadena1 % 12513;  |HAZ CtrlImporte;  #rem05008#15 = eaAlfa;  #rem05008#15 = #rem05008#15 / 100;

     |GRABA 020#rem05008.n;
     |LIBERA #rem05008;
     |CIERRA #rem05008;
|FPRC;

|PROCESO ClaveCB;
     nLinea = 1;

     |ABRE #rem05002;
     #rem05002#0 = #rem05000#0;
     #rem05002#1 = enContri;
     #rem05002#2 = 999;
     |LEE 000#rem05002.];
     |SI FSalida = 0;
         |LEE 000#rem05002.a;
     |SINO;
         |LEE 000#rem05002.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05002#0 = #rem05000#0; |Y #rem05002#1 = enContri;
         nLinea = #rem05002#2 + 1;
     |FINSI;

     |DDEFECTO #rem05002;
     #rem05002#0   = #rem05000#0;
     #rem05002#1   = enContri;
     #rem05002#2   = nLinea;
     #rem05002#3   = aNegro;
     #rem05002#4   = "Pendiente";
     #rem05002#5   = "rem00023";
     #rem05002#6   = 0;
     #rem05002#7   = eaCadena1 % 0909;
     #rem05002#8   = eaCadena1 % 1840;
     #rem05002#9   = eaCadena1 % 5810;

     eaAlfa = eaCadena1 % 6801;
     |SI eaAlfa = "1";  #rem05002#10 = "Cuenta corriente";     |FINSI;
     |SI eaAlfa = "2";  #rem05002#10 = "Cuenta ahorro";        |FINSI;
     |SI eaAlfa = "3";  #rem05002#10 = "Imposici¢n a plazo";   |FINSI;
     |SI eaAlfa = "4";  #rem05002#10 = "Cuentas financieras";  |FINSI;
     |SI eaAlfa = "5";  #rem05002#10 = "Cuentas de cr‚dito";   |FINSI;
     |SI eaAlfa = "6";  #rem05002#10 = "Cuentas soportadas";   |FINSI;

     eaAlfa = eaCadena1 % 6903;   #rem05002#11 = eaAlfa;
     eaAlfa = eaCadena1 % 7213;   |HAZ CtrlImporte;  #rem05002#12 = eaAlfa;  #rem05002#12 = #rem05002#12 / 100;
     eaAlfa = eaCadena1 % 8513;   |HAZ CtrlImporte;  #rem05002#13 = eaAlfa;  #rem05002#13 = #rem05002#13 / 100;
     eaAlfa = eaCadena1 % 9813;   |HAZ CtrlImporte;  #rem05002#14 = eaAlfa;  #rem05002#14 = #rem05002#14 / 100;
     eaAlfa = eaCadena1 % 11113;  |HAZ CtrlImporte;  #rem05002#15 = eaAlfa;  #rem05002#15 = #rem05002#15 / 100;

     |GRABA 020#rem05002.n;
     |LIBERA #rem05002;
     |CIERRA #rem05002;
|FPRC;

|PROCESO ClaveRE;
     nLinea = 1;

     |ABRE #rem05003;
     #rem05003#0 = #rem05000#0;
     #rem05003#1 = enContri;
     #rem05003#2 = 999;
     |LEE 000#rem05003.];
     |SI FSalida = 0;
         |LEE 000#rem05003.a;
     |SINO;
         |LEE 000#rem05003.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05003#0 = #rem05000#0; |Y #rem05003#1 = enContri;
         nLinea = #rem05003#2 + 1;
     |FINSI;

     |DDEFECTO #rem05003;
     #rem05003#0   = #rem05000#0;
     #rem05003#1   = enContri;
     #rem05003#2   = nLinea;
     #rem05003#3   = aNegro;
     #rem05003#4   = "Pendiente";
     #rem05003#6   = 0;
     #rem05003#7   = eaCadena1 % 0909;
     #rem05003#8   = eaCadena1 % 1840;
     #rem05003#9   = eaCadena1 % 5809;
     #rem05003#10  = eaCadena1 % 6740;
     #rem05003#11  = "";

     eaAlfa = eaCadena1 % 10703;
     |SI eaAlfa = "A01";  #rem05003#11 = "Base imponible ahorro: primas asistencia";  #rem05003#5 = "rem00022";   |FINSI;
     |SI eaAlfa = "A02";  #rem05003#11 = "Base imponible ahorro: dividendos       ";  #rem05003#5 = "rem00022";   |FINSI;
     |SI eaAlfa = "A03";  #rem05003#11 = "Base imponible ahorro: rendimientos     ";  #rem05003#5 = "rem00022";   |FINSI;
     |SI eaAlfa = "A04";  #rem05003#11 = "Base imponible ahorro: rendimientos     ";  #rem05003#5 = "rem00022";   |FINSI;
     |SI eaAlfa = "A05";  #rem05003#11 = "Base imponible ahorro: rendimientos     ";  #rem05003#5 = "rem00022";   |FINSI;
     |SI eaAlfa = "A07";  #rem05003#11 = "Base imponible ahorro: dividendos       ";  #rem05003#5 = "rem00022";   |FINSI;
     |SI eaAlfa = "A08";  #rem05003#11 = "Base imponible ahorro: dividendos       ";  #rem05003#5 = "rem00022";   |FINSI;

     |SI eaAlfa = "B01";  #rem05003#11 = "Base imponible ahorro: intereses        ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI eaAlfa = "B02";  #rem05003#11 = "Base imponible ahorro: intereses        ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI eaAlfa = "B03";  #rem05003#11 = "Base imponible ahorro: intereses        ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI eaAlfa = "B04";  #rem05003#11 = "Base imponible ahorro: rendimientos     ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI eaAlfa = "B05";  #rem05003#11 = "Base imponible ahorro: rendimientos     ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI eaAlfa = "B06";  #rem05003#11 = "Base imponible ahorro: rendimientos     ";  #rem05003#5 = "rem00023";   |FINSI;

     |SI eaAlfa = "C05";  #rem05003#11 = "Rentas vitalicias o temporales          ";  #rem05003#5 = "rem00051";   |FINSI;
     |SI eaAlfa = "GAS";  #rem05003#11 = "Base imponible ahorro: gastos deducibles";  #rem05003#5 = "rem00022";   |FINSI;

     |SI eaAlfa = "C01";  #rem05003#11 = "Base imponible general: rendimientos    ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI eaAlfa = "C02";  #rem05003#11 = "Base imponible general: rendimientos    ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI eaAlfa = "C03";  #rem05003#11 = "Base imponible general: rendimientos    ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI eaAlfa = "C04";  #rem05003#11 = "Base imponible general: rendimientos    ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI eaAlfa = "C06";  #rem05003#11 = "Base imponible general: rendimientos    ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI eaAlfa = "C07";  #rem05003#11 = "Base imponible general: rendimientos    ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI eaAlfa = "C12";  #rem05003#11 = "Base imponible general: rendimientos    ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI eaAlfa = "C13";  #rem05003#11 = "Otros rendimientos BIA                  ";  #rem05003#5 = "rem00023";   |FINSI;

     |SI eaAlfa = "D01";  #rem05003#11 = "Base imponible general: intereses       ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI eaAlfa = "D02";  #rem05003#11 = "Base imponible general: intereses       ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI eaAlfa = "D03";  #rem05003#11 = "Base imponible general: intereses       ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI eaAlfa = "D04";  #rem05003#11 = "Base imponible general: rendimientos    ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI eaAlfa = "D05";  #rem05003#11 = "Base imponible general: rendimientos    ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI eaAlfa = "D06";  #rem05003#11 = "Base imponible general: rendimientos    ";  #rem05003#5 = "rem00023";   |FINSI;

     #rem05003#16 = eaAlfa;

     eaAlfa = #rem05003#11;  |QBF eaAlfa;
     |SI eaAlfa  = "";  |ACABA;  |FINSI;

     eaAlfa = eaCadena1 % 11001;
     |SI eaAlfa = "1";  #rem05003#12 = "Dineraria";   |FINSI;
     |SI eaAlfa = "2";  #rem05003#12 = "En especie";  |FINSI;

     eaAlfa = eaCadena1 % 11313;  |HAZ CtrlImporte;  #rem05003#13 = eaAlfa;  #rem05003#13 = #rem05003#13 / 100;
     eaAlfa = eaCadena1 % 12613;  |HAZ CtrlImporte;  #rem05003#14 = eaAlfa;  #rem05003#14 = #rem05003#14 / 100;
     eaAlfa = eaCadena1 % 13913;  |HAZ CtrlImporte;  #rem05003#15 = eaAlfa;  #rem05003#15 = #rem05003#15 / 100;

     |GRABA 020#rem05003.n;
     |LIBERA #rem05003;
     |CIERRA #rem05003;
|FPRC;

|PROCESO ClaveTV;
     nLinea = 1;

     |ABRE #rem05004;
     #rem05004#0 = #rem05000#0;
     #rem05004#1 = enContri;
     #rem05004#2 = 999;
     |LEE 000#rem05004.];
     |SI FSalida = 0;
         |LEE 000#rem05004.a;
     |SINO;
         |LEE 000#rem05004.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05004#0 = #rem05000#0; |Y #rem05004#1 = enContri;
         nLinea = #rem05004#2 + 1;
     |FINSI;

     |DDEFECTO #rem05004;
     #rem05004#0   = #rem05000#0;
     #rem05004#1   = enContri;
     #rem05004#2   = nLinea;
     #rem05004#3   = aNegro;
     #rem05004#4   = "No trasladable";
     #rem05004#5   = "";
     #rem05004#6   = 0;
     #rem05004#7   = eaCadena1 % 0909;
     #rem05004#8   = eaCadena1 % 1840;
     #rem05004#9   = eaCadena1 % 5809;
     #rem05004#10  = eaCadena1 % 6740;
     eaAlfa = (eaCadena1 % 11302) + "." + (eaCadena1 % 11102) + "." + (eaCadena1 % 10704);
     #rem05004#11  = eaAlfa;

     eaAlfa = eaCadena1 % 11501;
     |SI eaAlfa = "A";  #rem05004#17 = "Mercado secundario oficial de valores espa¤ol";     |FINSI;
     |SI eaAlfa = "B";  #rem05004#17 = "Mercado secundario oficial de valores extranjeros"; |FINSI;
     |SI eaAlfa = "C";  #rem05004#17 = "Otros mercados nacionales";                         |FINSI;
     |SI eaAlfa = "D";  #rem05004#17 = "Otros mercados extranjeros";                        |FINSI;
     |SI eaAlfa = "F";  #rem05004#17 = "Operaciones intervenidas por fedatarios p£blicos";  |FINSI;
     |SI eaAlfa = "F";  #rem05004#17 = "Operaciones realizadas fuera de mercado (OTC)";     |FINSI;

     eaAlfa = eaCadena1 % 11601;
     |SI eaAlfa = "A";  #rem05004#12 = "Acciones en sociedades resp.limitada    ";  |FINSI;
     |SI eaAlfa = "B";  #rem05004#12 = "Activos con rdtos explicitos            ";  |FINSI;
     |SI eaAlfa = "C";  #rem05004#12 = "Activos con rdtos implicitos            ";  |FINSI;
     |SI eaAlfa = "D";  #rem05004#12 = "Principales segregados                  ";  |FINSI;
     |SI eaAlfa = "E";  #rem05004#12 = "Cupones segregados                      ";  |FINSI;
     |SI eaAlfa = "F";  #rem05004#12 = "Derechos de Garant¡a                    ";  |FINSI;
     |SI eaAlfa = "G";  #rem05004#12 = "Derechos de Disfrute                    ";  |FINSI;
     |SI eaAlfa = "H";  #rem05004#12 = "Derechos de suscripci¢n                 ";  |FINSI;
     |SI eaAlfa = "I";  #rem05004#12 = "Otros                                   ";  |FINSI;
     |SI eaAlfa = "K";  #rem05004#12 = "Participaciones preferentes             ";  |FINSI;
     |SI eaAlfa = "M";  #rem05004#12 = "Acciones Instit.Inversion Colectivas    ";  |FINSI;

     eaAlfa = eaCadena1 % 11703;  #rem05004#13 = eaAlfa;
     eaAlfa = eaCadena1 % 12015;  |HAZ CtrlImporte;  #rem05004#14 = eaAlfa;  #rem05004#14 = #rem05004#14 / 100;
     eaAlfa = eaCadena1 % 13512;  |HAZ CtrlImporte;  #rem05004#15 = eaAlfa;  #rem05004#15 = #rem05004#15 / 100;

     eaAlfa = eaCadena1 % 14701;
     |SI eaAlfa = "B";  #rem05004#16 = "Perceptor de los rendimientos";  |FINSI;
     |SI eaAlfa = "C";  #rem05004#16 = "Tercero por cuenta           ";  |FINSI;
     |SI eaAlfa = "N";  #rem05004#16 = "Nudo propietario             ";  |FINSI;
     |SI eaAlfa = "P";  #rem05004#16 = "Prestamista                  ";  |FINSI;
     |SI eaAlfa = "Q";  #rem05004#16 = "Prestatario                  ";  |FINSI;
     |SI eaAlfa = "T";  #rem05004#16 = "Titular                      ";  |FINSI;
     |SI eaAlfa = "U";  #rem05004#16 = "Usufructuario                ";  |FINSI;

     |GRABA 020#rem05004.n;
     |LIBERA #rem05004;
     |CIERRA #rem05004;
|FPRC;

|PROCESO ClaveSG;
     nLinea = 1;

     |ABRE #rem05005;
     #rem05005#0 = #rem05000#0;
     #rem05005#1 = enContri;
     #rem05005#2 = 999;
     |LEE 000#rem05005.];
     |SI FSalida = 0;
         |LEE 000#rem05005.a;
     |SINO;
         |LEE 000#rem05005.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05005#0 = #rem05000#0; |Y #rem05005#1 = enContri;
         nLinea = #rem05005#2 + 1;
     |FINSI;

     |DDEFECTO #rem05005;
     #rem05005#0   = #rem05000#0;
     #rem05005#1   = enContri;
     #rem05005#2   = nLinea;
     #rem05005#3   = aNegro;
     #rem05005#4   = "Pendiente";
     #rem05005#5   = "rem00024"
     #rem05005#6   = 0;
     #rem05005#7   = eaCadena1 % 0909;
     #rem05005#8   = eaCadena1 % 1840;

     eaAlfa = eaCadena1 % 5801;
     |SI eaAlfa = "1";  #rem05005#9 = "Dineraria";   |FINSI;
     |SI eaAlfa = "2";  #rem05005#9 = "En especie";  |FINSI;

     eaAlfa = eaCadena1 % 5913;  |HAZ CtrlImporte;  #rem05005#10 = eaAlfa;  #rem05005#10 = #rem05005#10 / 100;
     eaAlfa = eaCadena1 % 7213;  |HAZ CtrlImporte;  #rem05005#11 = eaAlfa;  #rem05005#11 = #rem05005#11 / 100;
     eaAlfa = eaCadena1 % 8513;  |HAZ CtrlImporte;  #rem05005#12 = eaAlfa;  #rem05005#12 = #rem05005#12 / 100;

     |GRABA 020#rem05005.n;
     |LIBERA #rem05005;
     |CIERRA #rem05005;
|FPRC;

|PROCESO ClaveCT;
     nLinea = 1;

     |ABRE #rem05006;
     #rem05006#0 = #rem05000#0;
     #rem05006#1 = enContri;
     #rem05006#2 = 999;
     |LEE 000#rem05006.];
     |SI FSalida = 0;
         |LEE 000#rem05006.a;
     |SINO;
         |LEE 000#rem05006.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05006#0 = #rem05000#0; |Y #rem05006#1 = enContri;
         nLinea = #rem05006#2 + 1;
     |FINSI;

     |DDEFECTO #rem05006;
     #rem05006#0   = #rem05000#0;
     #rem05006#1   = enContri;
     #rem05006#2   = nLinea;
     #rem05006#3   = aNegro;
     #rem05006#4   = "No trasladable";
     #rem05006#5   = "";
     #rem05006#6   = 0;
     #rem05006#7   = eaCadena1 % 0912;
     eaAlfa = eaCadena1 % 2104;

     |SI eaAlfa = "0138";   #rem05006#8 = "R‚gimen General de Empleados Hogar   ";  |FINSI;
     |SI eaAlfa = "0140";   #rem05006#8 = "R‚gimen General (Conv.Esp.)          ";  |FINSI;
     |SI eaAlfa = "0161";   #rem05006#8 = "R‚gimen General Agrario              ";  |FINSI;
     |SI eaAlfa = "0521";   #rem05006#8 = "Reg. Esp. Trabajadores Aut¢nomos     ";  |FINSI;
     |SI eaAlfa = "0540";   #rem05006#8 = "Reg. Esp. Aut¢nomos (Conv.Esp.)      ";  |FINSI;
     |SI eaAlfa = "0825";   #rem05006#8 = "Reg. Esp. Del Mar (Aut¢nomos)        ";  |FINSI;
     |SI eaAlfa = "0840";   #rem05006#8 = "Reg. Esp. Del Mar (Conv.Esp.)        ";  |FINSI;
     |SI eaAlfa = "0940";   #rem05006#8 = "Reg. Esp. Miner¡a Carb¢n (Conv.Esp.) ";  |FINSI;
     |SI eaAlfa = "1211";   #rem05006#8 = "Reg. Esp. Empleados Hogar (Fijos)    ";  |FINSI;

     eaAlfa = eaCadena1 % 2517;  |HAZ CtrlImporte;  #rem05006#9 = eaAlfa;  #rem05006#9 = #rem05006#9 / 100;

     |GRABA 020#rem05006.n;
     |LIBERA #rem05006;
     |CIERRA #rem05006;
|FPRC;

|PROCESO ClaveUR;
     nLinea = 1;

     |ABRE #rem05007;
     #rem05007#0 = #rem05000#0;
     #rem05007#1 = enContri;
     #rem05007#2 = 999;
     |LEE 000#rem05007.];
     |SI FSalida = 0;
         |LEE 000#rem05007.a;
     |SINO;
         |LEE 000#rem05007.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05007#0 = #rem05000#0; |Y #rem05007#1 = enContri;
         nLinea = #rem05007#2 + 1;
     |FINSI;

     |DDEFECTO #rem05007;
     #rem05007#0   = #rem05000#0;
     #rem05007#1   = enContri;
     #rem05007#2   = nLinea;
     #rem05007#3   = aNegro;
     #rem05007#4   = "Pendiente";
     #rem05007#5   = "rem00021"
     #rem05007#6   = 0;
     #rem05007#7   = eaCadena1 % 0920;
     eaAlfa = eaCadena1 % 2902;  |QBF eaAlfa;
     eaAlfa = eaAlfa + " " + (eaCadena1 % 3125);   |QBF eaAlfa;
     eaAlfa = eaAlfa + " " + (eaCadena1 % 5604);   |QBF eaAlfa;
     eaAlfa = eaAlfa + " " + (eaCadena1 % 6002);   |QBF eaAlfa;
     eaAlfa = eaAlfa + " " + (eaCadena1 % 6203);   |QBF eaAlfa;
     eaAlfa = eaAlfa + " " + (eaCadena1 % 6503);   |QBF eaAlfa;
     #rem05007#8   = eaAlfa;

     #rem05007#10  = eaCadena1 % 6820;

     #rem05007#11  = eaCadena1 % 8802;
     |SI #rem05007#11 = "UR";  #rem05007#12 = "Urbana";   |FINSI;
     |SI #rem05007#11 = "RU";  #rem05007#12 = "R£stica";  |FINSI;

     #rem05007#13  = eaCadena1 % 9001;
                              #rem05007#14 = "Sin definir                                       ";
     |SI #rem05007#13 = "A";  #rem05007#14 = "Almac‚n y aparcamiento                            ";  |FINSI;
     |SI #rem05007#13 = "V";  #rem05007#14 = "Residencial                                       ";  |FINSI;
     |SI #rem05007#13 = "I";  #rem05007#14 = "Industrial                                        ";  |FINSI;
     |SI #rem05007#13 = "O";  #rem05007#14 = "Oficinas                                          ";  |FINSI;
     |SI #rem05007#13 = "C";  #rem05007#14 = "Comercial                                         ";  |FINSI;
     |SI #rem05007#13 = "M";  #rem05007#14 = "Solares                                           ";  |FINSI;
     |SI #rem05007#13 = "K";  #rem05007#14 = "Deportivo                                         ";  |FINSI;
     |SI #rem05007#13 = "T";  #rem05007#14 = "Espect culos                                      ";  |FINSI;
     |SI #rem05007#13 = "G";  #rem05007#14 = "Ocio y Hosteler¡a                                 ";  |FINSI;
     |SI #rem05007#13 = "Y";  #rem05007#14 = "Sanidad y Beneficiencia                           ";  |FINSI;
     |SI #rem05007#13 = "E";  #rem05007#14 = "Cultural                                          ";  |FINSI;
     |SI #rem05007#13 = "R";  #rem05007#14 = "Religioso                                         ";  |FINSI;
     |SI #rem05007#13 = "M";  #rem05007#14 = "Obras de urbanizaci¢n, suelos sin edificar        ";  |FINSI;
     |SI #rem05007#13 = "P";  #rem05007#14 = "Edificio singular                                 ";  |FINSI;
     |SI #rem05007#13 = "B";  #rem05007#14 = "Almac‚n agrario                                   ";  |FINSI;
     |SI #rem05007#13 = "J";  #rem05007#14 = "Industrial agrario                                ";  |FINSI;
     |SI #rem05007#13 = "Z";  #rem05007#14 = "Agrario                                           ";  |FINSI;

     #rem05007#15  = eaCadena1 % 9101;
     |SI #rem05007#15 = "1";  #rem05007#16 = "Residencial garaje";    |FINSI;
     |SI #rem05007#15 = "2";  #rem05007#16 = "Industrial";            |FINSI;
     |SI #rem05007#15 = "3";  #rem05007#16 = "Residencial trastero";  |FINSI;

     eaAlfa = eaCadena1 % 9213;   |HAZ CtrlImporte;  #rem05007#17 = eaAlfa;  #rem05007#17 = #rem05007#17 / 100;
     eaAlfa = eaCadena1 % 10513;  |HAZ CtrlImporte;  #rem05007#27 = eaAlfa;  #rem05007#27 = #rem05007#27 / 100;

     #rem05007#18  = eaCadena1 % 11801;

     #rem05007#19 = eaCadena1 % 11902;
     |SI #rem05007#19 = "PR";  #rem05007#20 = "Propietario";               |FINSI;
     |SI #rem05007#19 = "US";  #rem05007#20 = "Usufructuario";             |FINSI;
     |SI #rem05007#19 = "CA";  #rem05007#20 = "Concesi¢n administrativa";  |FINSI;
     |SI #rem05007#19 = "DS";  #rem05007#20 = "Derecho de superficie   ";  |FINSI;
     |SI #rem05007#19 = "NP";  #rem05007#20 = "Nuda propiedad          ";  |FINSI;
     |SI #rem05007#19 = "DF";  #rem05007#20 = "Disfrutador             ";  |FINSI;

     eaAlfa = eaCadena1 % 12105;   |HAZ CtrlImporte;  #rem05007#21 = eaAlfa;  #rem05007#21 = #rem05007#21 / 100;
     eaAlfa = eaCadena1 % 12603;   #rem05007#22 = eaAlfa;

     #rem05007#23 = eaCadena1 % 12901;
     |SI #rem05007#23 = "H";  #rem05007#24 = "Vivienda habitual";      |FINSI;
     |SI #rem05007#23 = "A";  #rem05007#24 = "Arrendada";              |FINSI;
     |SI #rem05007#23 = "C";  #rem05007#24 = "Habitual y arrendada";   |FINSI;
     |SI #rem05007#23 = "O";  #rem05007#24 = "";                       |FINSI;

     #rem05007#25 = eaCadena1 % 13001;
     |SI #rem05007#25 = "1";  #rem05007#26 = "Inmuebles en territorio com£n";  |FINSI;
     |SI #rem05007#25 = "2";  #rem05007#26 = "Inmuebles en territorio foral";  |FINSI;
     |SI #rem05007#25 = "3";  #rem05007#26 = "Inmuebles en Navarra";  |FINSI;
     |SI #rem05007#25 = "4";  #rem05007#26 = "Inmuebles sin referencia catastral";  |FINSI;

     |GRABA 020#rem05007.n;
     |LIBERA #rem05007;
     |CIERRA #rem05007;
|FPRC;

|PROCESO ClavePF;
     nLinea = 1;

     |ABRE #rem05009;
     #rem05009#0 = #rem05000#0;
     #rem05009#1 = enContri;
     #rem05009#2 = 999;
     |LEE 000#rem05009.];
     |SI FSalida = 0;
         |LEE 000#rem05009.a;
     |SINO;
         |LEE 000#rem05009.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05009#0 = #rem05000#0; |Y #rem05009#1 = enContri;
         nLinea = #rem05009#2 + 1;
     |FINSI;

     |DDEFECTO #rem05009;
     #rem05009#0   = #rem05000#0;
     #rem05009#1   = enContri;
     #rem05009#2   = nLinea;
     #rem05009#3   = aNegro;
     #rem05009#4   = "Pendiente";
     #rem05009#5   = "rem00031";
     #rem05009#6   = 0;
     #rem05009#7   = eaCadena1 % 0903;

     eaAlfa = eaCadena1 % 1201;
     |SI eaAlfa = "I";  #rem05009#8 = "Ingreso";                      |FINSI;
     |SI eaAlfa = "N";  #rem05009#8 = "Negativa";                     |FINSI;
     |SI eaAlfa = "C";  #rem05009#8 = "Compensaci¢n";                 |FINSI;
     |SI eaAlfa = "D";  #rem05009#8 = "Devoluci¢n";                   |FINSI;
     |SI eaAlfa = "F";  #rem05009#8 = "Formalizaci¢n";                |FINSI;
     |SI eaAlfa = "A";  #rem05009#8 = "Aplazamiento";                 |FINSI;
     |SI eaAlfa = "M";  #rem05009#8 = "Imposibilidad de pago";        |FINSI;
     |SI eaAlfa = "S";  #rem05009#8 = "Solicitud de compensaci¢n";    |FINSI;
     |SI eaAlfa = "E";  #rem05009#8 = "Devoluci¢n ingreso excesivo";  |FINSI;
     |SI eaAlfa = "G";  #rem05009#8 = "Ingreso CCT";                  |FINSI;
     |SI eaAlfa = "V";  #rem05009#8 = "Devoluci¢n CCT";               |FINSI;

     #rem05009#9   = eaCadena1 % 1302;
     #rem05009#10  = eaCadena1 % 1502;
     #rem05009#11  = eaCadena1 % 1713;

     eaAlfa = eaCadena1 % 3013;  |HAZ CtrlImporte;  #rem05009#12 = eaAlfa;  #rem05009#12 = #rem05009#12 / 100;

     |SI #rem05009#12 = 0;
         #rem05009#4 = "No trasladable";
     |FINSI;

     |GRABA 020#rem05009.n;
     |LIBERA #rem05009;
     |CIERRA #rem05009;
|FPRC;

|PROCESO ClaveDN;
     nLinea = 1;

     |ABRE #rem05010;
     #rem05010#0 = #rem05000#0;
     #rem05010#1 = enContri;
     #rem05010#2 = 999;
     |LEE 000#rem05010.];
     |SI FSalida = 0;
         |LEE 000#rem05010.a;
     |SINO;
         |LEE 000#rem05010.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05010#0 = #rem05000#0; |Y #rem05010#1 = enContri;
         nLinea = #rem05010#2 + 1;
     |FINSI;

     |DDEFECTO #rem05010;
     #rem05010#0   = #rem05000#0;
     #rem05010#1   = enContri;
     #rem05010#2   = nLinea;
     #rem05010#3   = aNegro;
     #rem05010#4   = "Pendiente";
     #rem05010#5   = "rem00046";
     #rem05010#6   = 0;
     #rem05010#7   = eaCadena1 % 0909;
     #rem05010#8   = eaCadena1 % 1840;

     eaAlfa = eaCadena1 % 5801;
     |SI eaAlfa = " ";  #rem05010#9  = "Dinerarias";   |FINSI;
     |SI eaAlfa = "X";  #rem05010#9  = "En especie";   |FINSI;

     #rem05010#16 = eaCadena1 % 5901;
     #rem05010#17 = eaCadena1 % 8501;

     |SI #rem05010#16 = " ";  #rem05010#10 = "Donativos";     |FINSI;
     |SI #rem05010#16 = "A";  #rem05010#10 = "Donativos";     |FINSI;
     |SI #rem05010#16 = "B";  #rem05010#10 = "Donativos";     |FINSI;
     |SI #rem05010#16 = "G";  #rem05010#10 = "Donativos";     |FINSI;
     |SI #rem05010#16 = "C";  #rem05010#10 = "Aportaciones";  |FINSI;
     |SI #rem05010#16 = "F";  #rem05010#10 = "Cuota";         |FINSI;

     eaAlfa = eaCadena1 % 6005;  |HAZ CtrlImporte;  #rem05010#11 = eaAlfa;  #rem05010#11 = #rem05010#11 / 100;

     #rem05010#12 = eaCadena1 % 6502;

     eaAlfa = eaCadena1 % 6713;  |HAZ CtrlImporte;  #rem05010#13 = eaAlfa;  #rem05010#13 = #rem05010#13 / 100;
     eaAlfa = eaCadena1 % 8005;  |HAZ CtrlImporte;  #rem05010#15 = eaAlfa;  #rem05010#15 = #rem05010#15 / 100;

     |GRABA 020#rem05010.n;
     |LIBERA #rem05010;
     |CIERRA #rem05010;
|FPRC;

|| Aqui insertar

|PROCESO TrataCadena;
     aAlfa = eaCadena1 - "0DDFF2018";
     |SI FSalida ! 0;
         nOk = 1;
     |FINSI;

     |SI nOk = 0;  |ACABA;  |FINSI;

     eaAlfa = eaCadena1 % 101;
     |SI eaAlfa = "0";  |ACABA;  |FINSI;
     |SI eaAlfa = "1";  |ACABA;  |FINSI;

     |SI eaAlfa = "3";  |HAZ DatosPersonales;  |ACABA;  |FINSI;

     eaAlfa = eaCadena1 % 203;
     |SI eaAlfa = "DOM";  |HAZ DatosPersonales;  |ACABA;  |FINSI;
     |SI eaAlfa = "VHR";  |HAZ DatosPersonales;  |ACABA;  |FINSI;

     |SI eaAlfa = "RTA";  |HAZ ClaveRT;   |ACABA;  |FINSI;
     |SI eaAlfa = "RTB";  |HAZ ClaveRB;   |ACABA;  |FINSI;
     |SI eaAlfa = "RTC";  |HAZ ClaveRC;   |ACABA;  |FINSI;
     |SI eaAlfa = "EAA";  |HAZ ClaveEA;   |ACABA;  |FINSI;
     |SI eaAlfa = "EAB";  |HAZ ClaveEB;   |ACABA;  |FINSI;
     |SI eaAlfa = "EAC";  |HAZ ClaveEC;   |ACABA;  |FINSI;
     |SI eaAlfa = "EAD";  |HAZ ClaveED;   |ACABA;  |FINSI;
     |SI eaAlfa = "EAE";  |HAZ ClaveEE;   |ACABA;  |FINSI;
     |SI eaAlfa = "EAF";  |HAZ ClaveEF;   |ACABA;  |FINSI;
     |SI eaAlfa = "PHD";  |HAZ ClavePHD;  |ACABA;  |FINSI;
     |SI eaAlfa = "FIE";  |HAZ ClaveFIE;  |ACABA;  |FINSI;
     |SI eaAlfa = "FIC";  |HAZ ClaveFIC;  |ACABA;  |FINSI;
     |SI eaAlfa = "FID";  |HAZ ClaveFID;  |ACABA;  |FINSI;
     |SI eaAlfa = "TVD";  |HAZ ClaveTVD;  |ACABA;  |FINSI;
     |SI eaAlfa = "DNP";  |HAZ ClaveDNP;  |ACABA;  |FINSI;
     |SI eaAlfa = "PDA";  |HAZ ClavePDA;  |ACABA;  |FINSI;
     |SI eaAlfa = "PDB";  |HAZ ClavePDB;  |ACABA;  |FINSI;
     |SI eaAlfa = "PDC";  |HAZ ClavePDC;  |ACABA;  |FINSI;
     |SI eaAlfa = "PDD";  |HAZ ClavePDD;  |ACABA;  |FINSI;
     |SI eaAlfa = "PDE";  |HAZ ClavePDE;  |ACABA;  |FINSI;
     |SI eaAlfa = "PDF";  |HAZ ClavePDF;  |ACABA;  |FINSI;
     |SI eaAlfa = "PDG";  |HAZ ClavePDG;  |ACABA;  |FINSI;
     |SI eaAlfa = "PDH";  |HAZ ClavePDH;  |ACABA;  |FINSI;
     |SI eaAlfa = "PDI";  |HAZ ClavePDI;  |ACABA;  |FINSI;
     |SI eaAlfa = "PDJ";  |HAZ ClavePDJ;  |ACABA;  |FINSI;
     |SI eaAlfa = "PDK";  |HAZ ClavePDK;  |ACABA;  |FINSI;
     |SI eaAlfa = "CLP";  |HAZ ClaveCLP;  |ACABA;  |FINSI;
     |SI eaAlfa = "TPU";  |HAZ ClaveTPU;  |ACABA;  |FINSI;
     |SI eaAlfa = "TPR";  |HAZ ClaveTPR;  |ACABA;  |FINSI;
     |SI eaAlfa = "DMG";  |HAZ ClaveDMG;  |ACABA;  |FINSI;
     |SI eaAlfa = "COD";  |HAZ ClaveCOD;  |ACABA;  |FINSI;

     eaAlfa = eaCadena1 % 202;
     |SI eaAlfa = "DO";                  |ACABA;  |FINSI;
     |SI eaAlfa = "CB";   |HAZ ClaveCB;  |ACABA;  |FINSI;
     |SI eaAlfa = "RE";   |HAZ ClaveRE;  |ACABA;  |FINSI;
     |SI eaAlfa = "RI";   |HAZ ClaveRI;  |ACABA;  |FINSI;
     |SI eaAlfa = "AE";   |HAZ ClaveAE;  |ACABA;  |FINSI;
     |SI eaAlfa = "TV";   |HAZ ClaveTV;  |ACABA;  |FINSI;
     |SI eaAlfa = "SG";   |HAZ ClaveSG;  |ACABA;  |FINSI;
     |SI eaAlfa = "CD";   |HAZ ClaveCD;  |ACABA;  |FINSI;
     |SI eaAlfa = "CT";   |HAZ ClaveCT;  |ACABA;  |FINSI;
     |SI eaAlfa = "UR";   |HAZ ClaveUR;  |ACABA;  |FINSI;
     |SI eaAlfa = "PF";   |HAZ ClavePF;  |ACABA;  |FINSI;
     |SI eaAlfa = "DN";   |HAZ ClaveDN;  |ACABA;  |FINSI;
     |SI eaAlfa = "AR";   |HAZ ClaveAR;  |ACABA;  |FINSI;
     |SI eaAlfa = "DM";   |HAZ ClaveDM;  |ACABA;  |FINSI;
     |SI eaAlfa = "PP";   |HAZ ClavePP;  |ACABA;  |FINSI;
     |SI eaAlfa = "IP";   |HAZ ClaveIP;  |ACABA;  |FINSI;
     |SI eaAlfa = "AG";   |HAZ ClaveAG;  |ACABA;  |FINSI;
     |SI eaAlfa = "SC";   |HAZ ClaveSC;  |ACABA;  |FINSI;
     |SI eaAlfa = "CU";   |HAZ ClaveCU;  |ACABA;  |FINSI;
     |SI eaAlfa = "LT";   |HAZ ClaveLT;  |ACABA;  |FINSI;
     |SI eaAlfa = "CC";   |HAZ ClaveCC;  |ACABA;  |FINSI;
     |SI eaAlfa = "EV";   |HAZ ClaveEV;  |ACABA;  |FINSI;
     |SI eaAlfa = "SB";   |HAZ ClaveSB;  |ACABA;  |FINSI;
     |SI eaAlfa = "FA";   |HAZ ClaveFA;  |ACABA;  |FINSI;
     |SI eaAlfa = "FN";   |HAZ ClaveFN;  |ACABA;  |FINSI;
     |SI eaAlfa = "DD";   |HAZ ClaveDD;  |ACABA;  |FINSI;
     |SI eaAlfa = "AD";   |HAZ ClaveAD;  |ACABA;  |FINSI;
     |SI eaAlfa = "FM";   |HAZ ClaveFM;  |ACABA;  |FINSI;
     |SI eaAlfa = "DS";   |HAZ ClaveDS;  |ACABA;  |FINSI;

     || Aqui insertar

     |SI aClave ! eaAlfa;
         aAlfa2 = eaCadena1 % 401;
         |SI aAlfa2 ] "0";  |Y aAlfa2 [ "9";
             aAlfa3 = eaCadena1 % 202;
         |SINO;
             aAlfa3 = eaCadena1 % 203;
         |FINSI;

         |SI aAlfa3 = "AA";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "AT";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "DA";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "DI";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "EH";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "PC";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "VH";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "VA";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "VXG";  aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "VE";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "VN";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "OT";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "PX";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "RTD";  aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "PHI";  aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "PHM";  aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "99";   aAlfa3 = "";  |FINSI;

         |SI aAlfa3 ! "";
             aAlfa = "0000Clave " + aAlfa3 + " no reconocida en esta versi¢n, ";
             aAlfa = aAlfa + "contacte con nuestro departamento de soporte para ";
             aAlfa = aAlfa + "incluirlo en una pr¢xima versi¢n";
             |MENAV aAlfa;
         |FINSI;
     |FINSI;

     aClave = eaAlfa;
|FPRC;

|PROCESO tempora0;
     |BORRA 020#tempora0@.a;
     |LIBERA #tempora0@;
|FPRC;

|DEFBUCLE tempora0;
     #tempora0@#1003;
     ;
     #rem05000#0, enContri, 001;
     #rem05000#0, enContri, 999;
     be;
     NULL, tempora0;
|FIN;

|PROCESO ElBorrado;
     aDef = eaBase + "def/" + aMas;

     |CARGA_DEF aDef, tempora0@;

     |BUCLE tempora0;

     |DESCARGA_DEF #tempora0@;
|FPRC;

|PROCESO BorraDatos;
     aMas = "rem05001.mas";  |HAZ ElBorrado;
     aMas = "rem05002.mas";  |HAZ ElBorrado;
     aMas = "rem05003.mas";  |HAZ ElBorrado;
     aMas = "rem05004.mas";  |HAZ ElBorrado;
     aMas = "rem05005.mas";  |HAZ ElBorrado;
     aMas = "rem05006.mas";  |HAZ ElBorrado;
     aMas = "rem05007.mas";  |HAZ ElBorrado;
     aMas = "rem05008.mas";  |HAZ ElBorrado;
     aMas = "rem05009.mas";  |HAZ ElBorrado;
     aMas = "rem05010.mas";  |HAZ ElBorrado;
     aMas = "rem05011.mas";  |HAZ ElBorrado;
     aMas = "rem05012.mas";  |HAZ ElBorrado;
     aMas = "rem05013.mas";  |HAZ ElBorrado;
     aMas = "rem05014.mas";  |HAZ ElBorrado;
     aMas = "rem05015.mas";  |HAZ ElBorrado;
     aMas = "rem05016.mas";  |HAZ ElBorrado;
     aMas = "rem05017.mas";  |HAZ ElBorrado;
     aMas = "rem05018.mas";  |HAZ ElBorrado;
     aMas = "rem05019.mas";  |HAZ ElBorrado;
     aMas = "rem05020.mas";  |HAZ ElBorrado;
     aMas = "rem05021.mas";  |HAZ ElBorrado;
     aMas = "rem05022.mas";  |HAZ ElBorrado;
     aMas = "rem05023.mas";  |HAZ ElBorrado;
     aMas = "rem05024.mas";  |HAZ ElBorrado;
     aMas = "rem05025.mas";  |HAZ ElBorrado;
     aMas = "rem05026.mas";  |HAZ ElBorrado;
     aMas = "rem05027.mas";  |HAZ ElBorrado;
     aMas = "rem05028.mas";  |HAZ ElBorrado;
     aMas = "rem05029.mas";  |HAZ ElBorrado;
     aMas = "rem05030.mas";  |HAZ ElBorrado;
     aMas = "rem05031.mas";  |HAZ ElBorrado;
     aMas = "rem05032.mas";  |HAZ ElBorrado;
     aMas = "rem05033.mas";  |HAZ ElBorrado;
     aMas = "rem05034.mas";  |HAZ ElBorrado;
     aMas = "rem05035.mas";  |HAZ ElBorrado;
     aMas = "rem05036.mas";  |HAZ ElBorrado;
     aMas = "rem05037.mas";  |HAZ ElBorrado;
     aMas = "rem05038.mas";  |HAZ ElBorrado;
     aMas = "rem05039.mas";  |HAZ ElBorrado;
     aMas = "rem05040.mas";  |HAZ ElBorrado;
     aMas = "rem05041.mas";  |HAZ ElBorrado;
     aMas = "rem05042.mas";  |HAZ ElBorrado;
     aMas = "rem05043.mas";  |HAZ ElBorrado;
     aMas = "rem05044.mas";  |HAZ ElBorrado;
     aMas = "rem05045.mas";  |HAZ ElBorrado;
     aMas = "rem05046.mas";  |HAZ ElBorrado;
     aMas = "rem05047.mas";  |HAZ ElBorrado;
     aMas = "rem05048.mas";  |HAZ ElBorrado;
     aMas = "rem05049.mas";  |HAZ ElBorrado;
     aMas = "rem05050.mas";  |HAZ ElBorrado;
     aMas = "rem05051.mas";  |HAZ ElBorrado;
     aMas = "rem05052.mas";  |HAZ ElBorrado;
     aMas = "rem05053.mas";  |HAZ ElBorrado;
     aMas = "rem05054.mas";  |HAZ ElBorrado;
     aMas = "rem05055.mas";  |HAZ ElBorrado;
     aMas = "rem05056.mas";  |HAZ ElBorrado;
     aMas = "rem05057.mas";  |HAZ ElBorrado;
     aMas = "rem05058.mas";  |HAZ ElBorrado;
     aMas = "rem05059.mas";  |HAZ ElBorrado;
     aMas = "rem05060.mas";  |HAZ ElBorrado;
|FPRC;

|PROCESO CargaDatos;
     aAbre = eaDirServidor + #rem05000#enCampo# + ".dfp";  |QBT aAbre;
     |XABRE "AB", aAbre, nHandle;

     aCR        = &10;
     aLF        = &13;
     nSalir     = 0;
     aClave     = "";
     eaCadena1   = "";
     eaCadena2   = "";
     eaCadena3   = "";
     nFiCad1    = 254;
     nFiCad2    = 508;
     nOk        = 0;

     |XLEE nHandle, 1, aAlfa;
     |PARA; |SI FSalida > 0; |HACIENDO;
            nCaracter = nCaracter + 1;

            |SI aAlfa = aCR;
                |HAZ TrataCadena;
                eaCadena1  = "";
                eaCadena2  = "";
                eaCadena3  = "";
                nCaracter = 0;
            |SINO;
                |SI aAlfa ! aLF;
                    |SI nCaracter [ nFiCad1;
                        eaCadena1 = eaCadena1 + aAlfa;
                    |SINO;
                        |SI nCaracter [ nFiCad2;
                            eaCadena2 = eaCadena2 + aAlfa;
                        |SINO;
                            eaCadena3 = eaCadena3 + aAlfa;
                        |FINSI;
                    |FINSI;
                |FINSI;
            |FINSI;

            |SI nSalir = 1;  |SAL;  |FINSI;

            |XLEE nHandle, 1, aAlfa;
     |SIGUE;
     |XCIERRA nHandle;

     |SI nOk = 0;
         |MENAV "0000Servicio de descarga de datos fiscales de Hacienda no disponible. Intentelo mas tarde";
         |ACABA;
     |FINSI;

     |SI enContri = 1;
         |ABRE #rem05031;
         #rem05031#0  = #rem05000#0;
         #rem05031#1  = enContri;
         #rem05031#2  = 2;
         |LEE 101#rem05031.=;
         |SI FSalida = 0;
             aDef = eaBase + "def/rem05031.mas";
             |CARGA_DEF aDef, tempora0@;
             |ABRE #tempora0@;
             #tempora0@#0 = #rem05000#0;
             #tempora0@#1 = enContri;
             #tempora0@#2 = 1;
             |LEE 000#tempora0@.=;
             |SI FSalida = 0;
                 |PARA nCampoGet = 19;  |SI nCampoGet [ 37;  |HACIENDO nCampoGet = nCampoGet + 1;
                       #rem05031#nCampoGet# = #tempora0@#nCampoGet#;
                 |SIGUE;
                 |GRABA 020#rem05031.a;
                 |LIBERA #rem05031;
             |FINSI;
             |CIERRA #tempora0@;
             |DESCARGA_DEF #tempora0@;
         |FINSI;
         |CIERRA #rem05031;
     |FINSI;
|FPRC;

|PROCESO EnciendeBotones;
     |ESTADO_CONTROL enBoton1_1, "DISABLE";
     |ESTADO_CONTROL enBoton1_2, "DISABLE";
     |ESTADO_CONTROL enBoton1_3, "DISABLE";
     |ESTADO_CONTROL enBoton2_1, "DISABLE";
     |ESTADO_CONTROL enBoton2_2, "DISABLE";
     |ESTADO_CONTROL enBoton2_3, "DISABLE";
     |ESTADO_CONTROL enBoton3_1, "DISABLE";
     |ESTADO_CONTROL enBoton3_2, "DISABLE";
     |ESTADO_CONTROL enBoton3_3, "DISABLE";
     |ESTADO_CONTROL enBoton4_1, "DISABLE";
     |ESTADO_CONTROL enBoton4_2, "DISABLE";
     |ESTADO_CONTROL enBoton4_3, "DISABLE";
     |ESTADO_CONTROL enBoton5_1, "DISABLE";
     |ESTADO_CONTROL enBoton5_2, "DISABLE";
     |ESTADO_CONTROL enBoton5_3, "DISABLE";
     |ESTADO_CONTROL enBoton6_1, "DISABLE";
     |ESTADO_CONTROL enBoton6_2, "DISABLE";
     |ESTADO_CONTROL enBoton6_3, "DISABLE";

     aAlfa = #rem05000#2;  |QBF aAlfa;
     |SI aAlfa ! "";
         |SI nModo ! 4;
             |ESTADO_CONTROL enBoton1_1, "ENABLE";
             |ESTADO_CONTROL enBoton1_2, "ENABLE";
         |FINSI;

         aAlfa = #rem05000#4;  |QBF aAlfa;
         |SI aAlfa = "Procesado";
             |ESTADO_CONTROL enBoton1_3, "ENABLE";
         |FINSI;
     |FINSI;

     aAlfa = #rem05000#6;  |QBF aAlfa;
     |SI aAlfa ! "";
         |SI nModo ! 4;
             |ESTADO_CONTROL enBoton2_1, "ENABLE";
             |ESTADO_CONTROL enBoton2_2, "ENABLE";
         |FINSI;

         |ESTADO_CONTROL enBoton2_3, "DISABLE";
         aAlfa = #rem05000#8;  |QBF aAlfa;
         |SI aAlfa = "Procesado";
             |ESTADO_CONTROL enBoton2_3, "ENABLE";
         |FINSI;
     |FINSI;

     aAlfa = #rem05000#10;  |QBF aAlfa;
     |SI aAlfa ! "";
         |SI nModo ! 4;
             |ESTADO_CONTROL enBoton3_1, "ENABLE";
             |ESTADO_CONTROL enBoton3_2, "ENABLE";
         |FINSI;

         |ESTADO_CONTROL enBoton3_3, "DISABLE";
         aAlfa = #rem05000#12;  |QBF aAlfa;
         |SI aAlfa = "Procesado";
             |ESTADO_CONTROL enBoton3_3, "ENABLE";
         |FINSI;
     |FINSI;

     aAlfa = #rem05000#14;  |QBF aAlfa;
     |SI aAlfa ! "";
         |SI nModo ! 4;
             |ESTADO_CONTROL enBoton4_1, "ENABLE";
             |ESTADO_CONTROL enBoton4_2, "ENABLE";
         |FINSI;

         |ESTADO_CONTROL enBoton4_3, "DISABLE";
         aAlfa = #rem05000#16;  |QBF aAlfa;
         |SI aAlfa = "Procesado";
             |ESTADO_CONTROL enBoton4_3, "ENABLE";
         |FINSI;
     |FINSI;

     aAlfa = #rem05000#18;  |QBF aAlfa;
     |SI aAlfa ! "";
         |SI nModo ! 4;
             |ESTADO_CONTROL enBoton5_1, "ENABLE";
             |ESTADO_CONTROL enBoton5_2, "ENABLE";
         |FINSI;

         |ESTADO_CONTROL enBoton5_3, "DISABLE";
         aAlfa = #rem05000#20;  |QBF aAlfa;
         |SI aAlfa = "Procesado";
             |ESTADO_CONTROL enBoton5_3, "ENABLE";
         |FINSI;
     |FINSI;

     aAlfa = #rem05000#22;  |QBF aAlfa;
     |SI aAlfa ! "";
         |SI nModo ! 4;
             |ESTADO_CONTROL enBoton6_1, "ENABLE";
             |ESTADO_CONTROL enBoton6_2, "ENABLE";
         |FINSI;

         |ESTADO_CONTROL enBoton6_3, "DISABLE";
         aAlfa = #rem05000#24;  |QBF aAlfa;
         |SI aAlfa = "Procesado";
             |ESTADO_CONTROL enBoton6_3, "ENABLE";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO GrabaPortal;
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO Explorador;
     |HAZ CogeMac;

     |ABRE #zregubic;
     #zregubic#0 = 2018;
     #zregubic#1 = eaDSMAC;
     |LEE 101#zregubic.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregubic;
         #zregubic#0 = 2018;
         #zregubic#1 = eaDSMAC;
         |GRABA 020#zregubic.b;
     |FINSI;

     aPathExplorador = #zregubic#4;  |QBF aPathExplorador;

     |SI aPathExplorador = "";  |O aForzExplorador = "S";
         |MENAV "0000Busque y pinche en el explorador con el que quiera trabajar";

         aPathExplorador = "F" + aPathExplorador;
         |BROWSE aPathExplorador;
         aPathExplorador = aPathExplorador % 290;  |QBF aPathExplorador;
     |FINSI;

     |SI aPathExplorador ! "";
         #zregubic#4 = aPathExplorador;
     |FINSI;

     |GRABA 020#zregubic.a;
     |LIBERA #zregubic;
     |CIERRA #zregubic;
|FPRC;

|PROCESO BotonExplora;
     aForzExplorador = "S";  |HAZ Explorador;
|FPRC;

|PROCESO BuscaError;
     aMensa = "0000Clave de Referencia incorrecta";

     |SI aAlfa = "2";   aMensa = "0000NIF err¢neo";      |FINSI;
     |SI aAlfa = "3";   aMensa = "0000NIF err¢neo";      |FINSI;
     |SI aAlfa = "4";   aMensa = "0000Usuario de baja";  |FINSI;
     |SI aAlfa = "6";   aMensa = "0000Usuario bloqueado por superar accesos err¢neos en el d¡a";  |FINSI;
     |SI aAlfa = "7";   aMensa = "0000Usuario inhabilitado para pedir referencia con casilla";    |FINSI;
     |SI aAlfa = "8";   aMensa = "0000Exceso de peticiones de referencias satisfechas en el d¡a"; |FINSI;
     |SI aAlfa = "30";  aMensa = "0000Dato err¢neo";  |FINSI;
     |SI aAlfa = "31";  aMensa = "0000Dato err¢neo";  |FINSI;
     |SI aAlfa = "32";  aMensa = "0000Dato err¢neo";  |FINSI;
     |SI aAlfa = "35";  aMensa = "0000Faltan datos";  |FINSI;
     |SI aAlfa = "36";  aMensa = "0000Faltan datos";  |FINSI;
     |SI aAlfa = "37";  aMensa = "0000Dato err¢neo";  |FINSI;
     |SI aAlfa = "38";  aMensa = "0000Contribuyente dice que es no declarante, pero tiene alguna declaraci¢n activa";  |FINSI;
     |SI aAlfa = "52";  aMensa = "0000Dato  incorrecto";  |FINSI;
     |SI aAlfa = "53";  aMensa = "0000Faltan datos por completar";  |FINSI;
     |SI aAlfa = "54";  aMensa = "0000Dato incorrecto";  |FINSI;
     |SI aAlfa = "55";  aMensa = "0000Dato incorrecto";  |FINSI;
     |SI aAlfa = "61";  aMensa = "0000Dato err¢neo";  |FINSI;
     |SI aAlfa = "67";  aMensa = "0000Dato err¢neo";  |FINSI;
     |SI aAlfa = "90";  aMensa = "0000IP bloqueada por superar accesos err¢neos en el d¡a";  |FINSI;
     |SI aAlfa = "97";  aMensa = "0000NIF en blanco";  |FINSI;
     |SI aAlfa = "98";  aMensa = "0000Clave de Referencia en blanco";  |FINSI;
     |SI aAlfa = "99";  aMensa = "0000Clave de Referencia incorrecta";  |FINSI;
     |SI aAlfa = "160"; aMensa = "0000Error en el servicio de identificaci¢n";  |FINSI;
     |SI aAlfa = "170"; aMensa = "0000Error en el servicio de env¡o";  |FINSI;
     |SI aAlfa = "171"; aMensa = "0000Error en el servicio de env¡o";  |FINSI;
     |SI aAlfa = "172"; aMensa = "0000Error en el servicio de env¡o";  |FINSI;
     |SI aAlfa = "180"; aMensa = "0000Error en el servicio de validaci¢n";  |FINSI;
     |SI aAlfa = "181"; aMensa = "0000Error en el servicio de validaci¢n";  |FINSI;
     |SI aAlfa = "210"; aMensa = "0000Error estad¡sticas";  |FINSI;
     |SI aAlfa = "220"; aMensa = "0000Error log";  |FINSI;
     |SI aAlfa = "221"; aMensa = "0000Error de transformaci¢n";  |FINSI;

     |MENAV aMensa;
     nError = 1;
|FPRC;

|PROCESO LeeRespuesta;
     nError = 0;

     aAbre = eaDirResp + #rem05000#enCampo# + ".dfp";  |QBT aAbre;
     |XABRE "C", aAbre, nHandle;

     nConta = 0;
     |PARA; |SI;  |HACIENDO;
          |XLEE nHandle, 250, aAlfa;
          |SI FSalida < 0; |SAL;  |FINSI;

          |QBT aAlfa;
          aAlfa = aAlfa - "<status>";
          |SI FSalida ! 0;
              aAlfa = aAlfa - "</status>";
              |SI aAlfa = "0";  |SAL;  |FINSI;
          |FINSI;

          aAlfa = aAlfa - "<codigo>";
          |SI FSalida ! 0;
              aAlfa = aAlfa - "</codigo>";
              |HAZ BuscaError;
          |FINSI;
     |SIGUE;
     |XCIERRA nHandle;
|FPRC;

|PROCESO PaginaDescarga;
     nCampo1 = enCampo + 2;

     aAbre = eaDirResp + #rem05000#enCampo# + ".dfp";  |QBT aAbre;
     |RFBORRA aAbre;

     aAbre = eaDirServidor + #rem05000#enCampo# + ".dfp";  |QBT aAbre;
     |FBORRA aAbre;

     aEnlace = eaDirLocal + "dsrentadatfisc ";
     aEnlace = aEnlace + #rem05000#enCampo#;  |QBF aEnlace;
     aEnlace = aEnlace + " " + #rem05000#nCampo1#;  |QBF aEnlace;
     aEnlace = aEnlace + " S ";
     aEnlace = aEnlace + eaDirResp + #rem05000#enCampo#;  |QBF aEnlace;
     aEnlace = aEnlace + ".dfp";

     aAlfa  = "cmd " + &34 + "/c START /WAIT " + aEnlace + &34;
     |RSYSTEM aAlfa;

     aAbre = eaDirResp + #rem05000#enCampo# + ".dfp";  |QBT aAbre;
     |XABRE "EC", aAbre, 0;
     |SI FSalida ] 0;
         |HAZ LeeRespuesta;
         |SI nError = 1;
             |ACABA;
         |FINSI;
     |SINO;
         |MENAV "0000El fichero no se ha descargado.";
         |ACABA;
     |FINSI;

     eaOrigen  = eaDirResp + #rem05000#enCampo# + ".dfp";  |QBT eaOrigen;
     eaDestino = eaDirServidor + #rem05000#enCampo# + ".dfp";  |QBT eaDestino;
     |HAZ RecibeFichero;

     |HAZ BorraDatos;

     aAbre = eaDirServidor + #rem05000#enCampo# + ".dfp";  |QBT aAbre;
     |XABRE "E", aAbre, 0;
     |SI FSalida ] 0;
         nCampo1   = enCampo + 3;
         #rem05000#nCampo1# = "Procesado";   |PINTA #rem05000#nCampo1#;

         |HAZ CargaDatos;
         |HAZ EnciendeBotones;
     |SINO;
         |MENAV "0000Ha habido algun error en la descarga del borrador. Por favor intentelo de nuevo";
     |FINSI;
|FPRC;

|PROCESO Descarga;
     |PARA nCampoGet = 3;  |SI nCampoGet [ 23;  |HACIENDO nCampoGet = nCampoGet + 4;
           aGet2 = nCampoGet;
           IaGet = aGet1<-;
           |ESPECIFICA "GETDATACONTROL", aGet;
           #rem05000#nCampoGet# = FSalida;
     |SIGUE;

     nCampo1 = enCampo + 3;
     aAlfa   = #rem05000#nCampo1#;  |QBF aAlfa;
     |SI aAlfa = "Procesado";
          |CONFI "0000NEl borrador ya ha sido procesado. Lo descargamos de nuevo";
          |SI FSalida ! 0;  |ACABA;  |FINSI;

          #rem05000#nCampo1# = "Sin descargar";   |PINTA #rem05000#nCampo1#;

          |HAZ EnciendeBotones;
     |FINSI;

     aAbre = eaDirServidor + #rem05000#enCampo# + ".dfp";  |QBT aAbre;
     |FBORRA aAbre;

     nCampo1 = enCampo + 2;
     |HAZ PaginaDescarga;

     |PULSATECLA;
|FPRC;

|PROCESO PaginaVisualiza;
     aEnlace  = "https://www9.agenciatributaria.gob.es/wlpl/DFPA-D182/SvVisDF18Net";

     aAbre = eaDirLocal + "Presenta.html";
     |XABRE "WBC", aAbre, nHandle;

     aAlfa = "<!DOCTYPE HTML PUBLIC " + &34 + "-//W3C//DTD HTML 4.01 Transitional//EN" + &34;
     |HAZ GrabaPortal;

     aAlfa = &34 + "http://www.w3.org/TR/html4/loose.dtd" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "<html>";
     |HAZ GrabaPortal;

     aAlfa = "<head>";
     |HAZ GrabaPortal;

     aAlfa = "<title>Documento sin t&iacute;tulo</title>";
     |HAZ GrabaPortal;

     aAlfa = "<meta http-equiv=" + &34 + "Content-Type" + &34 + " content=" + &34 + "text/html; charset=iso-8859-1" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "</head>";
     |HAZ GrabaPortal;

     aAlfa = "";
     |HAZ GrabaPortal;

     aAlfa = "<script language=" + &34 + "javascript" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "     function carga()";
     |HAZ GrabaPortal;

     aAlfa = "     {";
     |HAZ GrabaPortal;

     aAlfa = "          document.location = ";
     aAlfa = aAlfa + &34 + aEnlace + &34 + ";";
     |HAZ GrabaPortal;

     aAlfa = "     }";
     |HAZ GrabaPortal;

     aAlfa = "</script>";
     |HAZ GrabaPortal;

     aAlfa = "";
     |HAZ GrabaPortal;

     aAlfa = "<body onload=" + &34 + "javascript:carga();" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "";  |HAZ GrabaPortal;
     aAlfa = "";  |HAZ GrabaPortal;

     aAlfa = "</form>";   |HAZ GrabaPortal;
     aAlfa = "</body>";   |HAZ GrabaPortal;
     aAlfa = "</html>";   |HAZ GrabaPortal;

     |XCIERRA nHandle;

     aForzExplorador = "N";
     aPathExplorador = "";
     |HAZ Explorador; |QBF aPathExplorador;
     |SI aPathExplorador = "";
         aForzExplorador = "S"; aPathExplorador = "";
         |HAZ Explorador;
     |FINSI;

     |SI aPathExplorador ! "";
         aAlfa = aPathExplorador + " " + aAbre;
         aAlfa = "cmd " + &34 + "/c START /WAIT " + aAlfa + &34;
     |SINO;
        aAlfa  = "cmd " + &34 + "/c START /WAIT " + aAbre + &34;
     |FINSI;

     |RSYSTEM aAlfa;

     |PULSATECLA;
|FPRC;

|PROCESO Visualiza;
     |PARA nCampoGet = 3;  |SI nCampoGet [ 23;  |HACIENDO nCampoGet = nCampoGet + 4;
           aGet2 = nCampoGet;
           IaGet = aGet1<-;
           |ESPECIFICA "GETDATACONTROL", aGet;
           #rem05000#nCampoGet# = FSalida;
     |SIGUE;

     nCampo1 = enCampo + 2;
     |HAZ PaginaVisualiza;

     |PULSATECLA;
|FPRC;

|PROCESO Pondsselect;
     |HAZ LeeUnidadBasico;

     |DBASE eaBase;  |QBF eaBase;
     aFicOrigen = eaBase + "plugins/dsselect.exe";
     |XABRE "E", aFicOrigen, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     aFicDestino  = eaDirLocal + "dsselect.exe";

     aContiene1 = aFicDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = aFicOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aFicOrigen, aFicDestino;
         |SINO;
             |COPIA_FICHERO aFicOrigen, aFicDestino;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Browse;
     |HAZ Pondsselect;
     aPrograma = eaDirLocal + "dsselect.exe " + eaDirLocal + "dsselect.ini";

     aBorra = eaDirLocal + "dsselect.txt";  |RFBORRA aBorra;
     aBorra = eaDirLocal + "dsselect.ini";  |RFBORRA aBorra;

     aAbre = eaDirLocal + "dsselect.ini";
     |XABRE "CW", aAbre, nHandle;
     |SI FSalida ] 0;
          aLinea = &34 + eaUnidadBasico + "\AEAT\" + &34 + " " + &34 + eaDirLocal + "dsselect.txt" + &34;
          |XGRABA nHandle, aLinea;
     |FINSI;
     |XCIERRA nHandle;

     |RSYSTEM aPrograma;
     |PULSATECLA;

     aRuta = "";
     aAbre = eaDirLocal + "dsselect.txt";
     |XABRE "CU", aAbre, nHandle;
     |SI FSalida ] 0;
         |XLEE nHandle, 250, aRuta;
     |FINSI;
     |XCIERRA nHandle;

     aBorra = eaDirLocal + "dsselect.txt";
     |RFBORRA aBorra;

     |PULSATECLA;

     aAlfa = aRuta;
     aRuta = "";
     aLong = aAlfa % 0;
     nLong = aLong;
     |PARA nCarac = 1;  |SI nCarac [ nLong;  |HACIENDO nCarac = nCarac + 1;
           nPos       = (nCarac * 100) + 1;
           aCaracter  = aAlfa % nPos;
           aRuta      = aRuta      + aCaracter;
           aNombreFic = aNombreFic + aCaracter;

           |SI aCaracter = "/";  |O aCaracter = "\";
               aNombreFic = "";
           |FINSI;
     |SIGUE;

     aNombreRea = aNombreFic < "";

     eaAlfa = (#rem05000#enCampo# + ".dfp") < "";   |QBT eaAlfa;
     aAlfa2 = aNombreRea;

     |SI eaAlfa ! aAlfa2;
         |ACABA;
     |FINSI;

     eaOrigen = aRuta;
     eaDestino = eaDirServidor + aNombreFic;
     |HAZ RecibeFichero;
|FPRC;

|PROCESO LeeFichero;
     |PARA nCampoGet = 3;  |SI nCampoGet [ 23;  |HACIENDO nCampoGet = nCampoGet + 4;
           aGet2 = nCampoGet;
           IaGet = aGet1<-;
           |ESPECIFICA "GETDATACONTROL", aGet;
           #rem05000#nCampoGet# = FSalida;
     |SIGUE;

     nCampo1 = enCampo + 3;
     aAlfa   = #rem05000#nCampo1#;  |QBF aAlfa;
     |SI aAlfa = "Procesado";
          aAlfa = "0000El borrador ya ha sido procesado.";
          aAlfa = aAlfa + " Si se vuelve a leer se perder n todas las conexiones posibles con los datos de la renta";
          |MENAV aAlfa;
          |CONFI "0000NQuiere leerlo de nuevo";
          |SI FSalida ! 0;  |ACABA;  |FINSI;

          #rem05000#nCampo1# = "Sin leer";   |PINTA #rem05000#nCampo1#;

          |HAZ EnciendeBotones;
     |FINSI;

     aAbre = eaDirServidor + #rem05000#enCampo# + ".dfp";  |QBT aAbre;
     |FBORRA aAbre;

     nCampo1 = enCampo + 2;
     aAlfa   = #rem05000#nCampo1#;  |QBF aAlfa;
     |HAZ Browse;
     |HAZ BorraDatos;

     aAbre = eaDirServidor + #rem05000#enCampo# + ".dfp";  |QBT aAbre;
     |XABRE "E", aAbre, nHandle;
     |SI FSalida ] 0;
         nCampo1   = enCampo + 3;
         #rem05000#nCampo1# = "Procesado";   |PINTA #rem05000#nCampo1#;

         |HAZ CargaDatos;
         |HAZ EnciendeBotones;
     |SINO;
         |MENAV "0000Ha habido algun error en la descarga del borrador. Por favor intentelo de nuevo";
     |FINSI;

     |PULSATECLA;
|FPRC;
