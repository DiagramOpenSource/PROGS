|FICHEROS;
      rezcalcu;
      rem00100;
      reparame;
      reacceso;

     &refere1@ #1;
     &refere2@ #2;
     &refere3@ #3;
|FIN;

|VARIABLES;
     nDias             = 0;

     aPathRenta        = "";
     aDef              = "";
     aFichero          = "";
     aAlfa             = "";
     fFecha            = @;

     &enEmpresa        = 0;
     &enComplementaria = 0;
     &eaPathDef        = "";
     &enSwPresenta     = 1;
     &enNomeDat        = 0;
     &enNomeAgr        = 0;
     &eaMuerto         = "";
     &efFechaMuerto    = @;
     &enCalcuMuerto    = 0;
     &eaPaisano        = "";
     &eaReside         = "";
     &enPatrimonio     = 0;
     &enRedon          = 0;
|FIN;

|PROCESO CargaDefLiq;
     aDef = eaPathDef + "rem01001.mas";
     |CARGA_DEF aDef, refere1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aFichero + ".mas";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere1@#"zdat1001"#;  |FINSI;

     aDef = eaPathDef + "rem01002.mas";
     |CARGA_DEF aDef, refere2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aFichero + ".mas";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere2@#"zdat1002"#;  |FINSI;

     aDef = eaPathDef + "rem01003.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aFichero + ".mas";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere3@#"zdat1003"#;  |FINSI;

     |ABRET #refere1@;
     |ABRET #refere2@;
     |ABRET #refere3@;
|FPRC;

|PROCESO DescargaDefLiq;
     |CIERRAT #refere1@;
     |CIERRAT #refere2@;
     |CIERRAT #refere3@;

     |DESCARGA_DEF #refere3@;
     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|PROGRAMA;
     |HAZ CargaColores;

     |SI PARAMETRO ! "";
         enNomeDat = 1;
         enEmpresa = PARAMETRO;
     |FINSI;

     |PINPA #0#rezcalcu;

     |SUB_EJECUTA "rezchequ";

     eaMuerto  = "";
     eaPaisano = "";

     |ABRE #reacceso;
     #reacceso#0 = enEmpresa;
     |LEE 000#reacceso.=;
     |SI FSalida ! 0;  |DDEFECTO #reacceso; |FINSI;
     |CIERRA #reacceso;

                              enRedon   = 0;
     |SI #reacceso#28 = "S";  enRedon   = .00049;  |FINSI;

     |ABRE #rem00100;
     #rem00100#0 = enEmpresa;
     |LEE 040#rem00100.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00100; |FINSI;
     |SI #rem00100#90 = "S";
         eaMuerto      = #rem00100#91;  |QBT eaMuerto;
         efFechaMuerto = #rem00100#92;
         enCalcuMuerto = #rem00100#98;
     |FINSI;

     eaPaisano = #rem00100#10;
     eaReside  = #rem00100#94;

     |CIERRA #rem00100;

     enSwPresenta = 1;
     |HAZ SacaDeclarantes;
     enSwPresenta = 0;

     |DBASE aPathRenta;  |QBT aPathRenta;
     eaPathDef = aPathRenta + "def/";

     |SI enPatrimonio = 0;
         |SI enNomeDat = 0;  |HAZ BorraLiquidacion;  |FINSI;

         |HAZ Borra1003;
     |FINSI;

     |HAZ CargaDefLiq;

     |SI enPatrimonio = 1;
         |HAZ LimpiaPatrimonio;
     |FINSI;

     |SI enPatrimonio ! 0;
         |HAZ CalculaPatrimonio;

         |HAZ DescargaDefLiq;

         |ACABA;
     |FINSI;

     |HAZ Bloque1;
     |HAZ Bloque2;
     |HAZ Bloque3;
     |HAZ Bloque4;
     |HAZ Bloque5;
     |HAZ Bloque6;

     |HAZ DescargaDefLiq;
     |SUB_EJECUTA "rezcal01";
     |HAZ CargaDefLiq;

     |HAZ CalculaPatrimonio;
|FPRO;
