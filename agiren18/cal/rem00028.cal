|FICHEROS;
     rem00028;
     rem00058;
     rem00029;
     rem00500;

     rew00628,MANTE;
     rew00629,MANTE;

     rem00028@;

     rew00003;
|FIN;

|VARIABLES;
     aAlfa         = "";
     aAlfa1        = "";
     aAlfa2        = "";
     aAlfa3        = "";
     aLong         = "";
     aQueQuiero    = "";
     aNumCampos    = "";
     aNumPanta     = "";
     aPathRenta    = "";
     aDef          = "";
     aDescri       = "";
     aCheq1        = "";
     aJoven        = "";
     aCon          = "";

     aEsc1         = "";
     aEsc2         = "";
     aRetu         = "";
     aTecla        = "";
     aID           = "";

     nLin           = 0;
     nPas           = 0;
     nRdtoMin       = 0;
     nVentana       = -1;
     nVentana629    = -1;
     nCampo         = 0;
     nRango         = 0;
     nGrid          = -1;
     nGrid29        = -1;
     nBotonAlta     = 0;
     nBotonModi     = 0;
     nBotonBaja     = 0;
     nBotonCntr     = 0;
     nBotonAlta29   = 0;
     nBotonModi29   = 0;
     nBotonBaja29   = 0;
     nEBotonModi29  = 0;
     nEBotonBaja29  = 0;
     nPanta         = 0;
     nPanta629      = 0;
     nID            = 0;
     nEntrar        = 0;

     nLong         = 0;
     nPorce        = 0;
     nAnyos        = 0;
     nCaracter     = 0;
     nPosi         = 0;
     nNumCampos    = 0;
     nNumPanta     = 0;
     nModo         = 0;
     nEntrada      = 0;
     nPtas         = 0;
     nRetencion    = 0;
     nCampo15      = 0;
     nCampo16      = 0;
     nCampo17      = 0;
     nCampo20      = 0;
     nCampo27      = 0;
     nValor        = 0;
     nValor28      = 0;
     nValor1       = 0;
     nValor2       = 0;
     nValorPat     = 0;
     nDias         = 0;
     nAnyoVenta    = 0;
     nAnyoCompra   = 0;
     nDiferencia   = 0;
     nCoefi        = 0;
     nLinea        = 0;
     nContenido    = 0;
     nAnyo         = 0;
     nSwHay        = 0;
     nCampo1       = 0;
     nCampo2       = 0;
     nCampo3       = 0;
     nCampo4       = 0;
     nCampo5       = 0;
     nCanti1       = 0;
     nCanti2       = 0;
     nImporte1     = 0;
     nImporte2     = 0;
     nTecla        = 0;

     nTodosDias    = 0;
     nParciDias    = 0;

     fFechaLim     = @;

     fFechaAdq     = @;
     fFechaTra     = @;
     fFecha1       = @;
     fFecha2       = @;

     &enEmpresa    = 0;
     &enModo       = 0;
     &enModoReg    = 0;
     &eaDeclarante = "";
     &enComunes    = 0;
     &enChequeo    = 0;
     &enMinusvalia = 0;
     &eaMinuAyuda  = "";
     &eaFallece    = "";
     &eaSwVarios   = "";
     &eaVarDni     = "";
     &enCalcCif    = 0;
     &enSwLiquida  = 0;
     &enSwRetorno  = 0;
     &eaPrograma   = "";
     &eaPunto      = "";
     &enTipo       = 0;
     &enCultivo    = 0;
     &eaTipo       = "";
     &enNomeAgr    = 0;
     &enImporteT   = 0;
     &enImporteC   = 0;
     &enImporte1   = 0;
     &enImporte2   = 0;
     &enImporte3   = 0;
     &enImporte4   = 0;

     &eaLetra      = "";
     &eaDeDonde    = "";
     &eaLinDonde   = "";
     &eaAnyoUsu    = "";
     &eaEdadDec    = "";
     &eaPatr06     = "";
     &eaPatr07     = "";
     &eaPatr08     = "";
     &eaPatr09     = "";
     &eaPatr10     = "";
     &eaPatr11     = "";
     &eaPatr12     = "";
     &eaPatr13     = "";
     &eaPatr14     = "";
     &eaPatr15     = "";
     &eaPatr16     = "";
     &eaPatr17     = "";
     &eaPatr18     = "";
     &eaPatr19     = "";
     &eaPatr20     = "";
     &eaPatr21     = "";

     &eaAzul       = "";
     &eaVerde      = "";
     &eaRojo       = "";
     &eaRosa       = "";
     &enBtnSalir   = 0;
|FIN;

|| ---- PROCESOS GRABACIONES EXTERIORES

|PROCESO rem00029B;
     |BORRA 020#rem00029.a;
     |LIBERA #rem00029;
|FPRC;

|DEFBUCLE rem00029B;
     #rem00029#1;
     ;
     #rem00028#0, #rem00028#1, 01;
     #rem00028#0, #rem00028#1, 99;
     be;
     NULL, rem00029B;
|FIN;

|PROCESO Patrimonio;
     |SI #rem00028#3  = "R";           |ACABA;  |FINSI;
     |SI #rem00028#3  = "X";           |ACABA;  |FINSI;
     |SI #rem00028#2  = "1 FAMILIAR";  |ACABA;  |FINSI;
     |SI #rem00028#2  = "2 FAMILIAR";  |ACABA;  |FINSI;
     |SI #rem00028#2  = "3 FAMILIAR";  |ACABA;  |FINSI;
     |SI #rem00028#2  = "4 FAMILIAR";  |ACABA;  |FINSI;
     |SI #rem00028#11 = 0;             |ACABA;  |FINSI;

     |HAZ LimpiaPatrim;

     eaDeclarante = #rem00028#2;

     eaLetra    = "C1";
     eaDeDonde  = "D4";
     eaLinDonde = #rem00028#1;
     eaAnyoUsu  = 0;
     eaPatr06   = #rem00028#24;              || Domicilio
     eaPatr08   = #rem00028#22;              || Codigo Postal 1
     eaPatr09   = #rem00028#23;              || Codigo Postal 2
     eaPatr15   = #rem00028#21;              || Actividad
     eaPatr18   = #rem00028#19;              || Epigrafe
     nValor     = #rem00028#11 % #rem00028#15;     || Valor Patrimonial
     eaPatr10   = nValor;              || Valor Patrimonial
     eaPatr20   = #rem00028#5;
     eaPatr21   = #rem00028#6;

     |HAZ GrabaPatrimonio;
|FPRC;

|PROCESO Graba58;
     |SI #rem00028#14 ! "S";  |ACABA;  |FINSI;

     |ABRE #rem00058;
     |SELECT #1#rem00058;
     #rem00058#0 = #rem00028#0;
     #rem00058#1 = 99;
     |LEE 040#rem00058.];
     |SI FSalida = 0;
         |LEE 040#rem00058.a;
     |SINO;
         |LEE 040#rem00058.u;
     |FINSI;
     nLinea = 1;

     |SI FSalida = 0;  |Y #rem00058#0 = #rem00028#0;
         nLinea = #rem00058#1 + 1;
     |FINSI;

     |DDEFECTO #rem00058;
     #rem00058#0  = #rem00028#0;
     #rem00058#1  = nLinea;
     #rem00058#2  = #rem00028#2;
     #rem00058#3  = "R";
     |SI #rem00028#3 = "X";
         #rem00058#3  = "X";
         #rem00058#48 = eaRojo;
     |FINSI;
     #rem00058#4  = #rem00028#4;
     #rem00058#5  = #rem00028#5;
     #rem00058#6  = #rem00028#6;
     #rem00058#7  = #rem00028#7;
     #rem00058#8  = #rem00028#8;
     #rem00058#9  = #rem00028#9;
     #rem00058#10 = #rem00028#10;
     #rem00058#11 = #rem00028#15;
     #rem00058#12 = #rem00028#20;
     #rem00058#13 = 3;
     #rem00058#14 = "E4";
     #rem00058#15 = #rem00028#1;
     #rem00058#27 = #rem00028#49 % #rem00058#11;
     #rem00058#28 = nValor28;
     #rem00058#29 = #rem00028#51 % #rem00058#11;
     #rem00058#30 = #rem00058#27 - #rem00058#28 - #rem00058#29;
     #rem00058#55 = #rem00028#16;

     |GRABA 020#rem00058.n;
     |LIBERA #rem00058;
     |CIERRA #rem00058;

     eaPrograma   = "rem00058";
     eaLetra      = #rem00058#13;
     eaPunto      = eaLetra;
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO Borra58;
     nValor28 = 0;

     |ABRE #rem00058;
     |SELECT #2#rem00058;
     #rem00058#0  = #rem00028#0;
     #rem00058#14 = "E4";
     #rem00058#15 = #rem00028#1;
     |LEE 101#rem00058.=;
     |SI FSalida = 0;
         nValor28 = #rem00058#28;

         |BORRA 020#rem00058.a;
         |LIBERA #rem00058;

         eaPrograma   = "rem00058";
         eaLetra      = #rem00058#13;
         eaPunto      = eaLetra;
         |HAZ ProgramaActivo;
     |FINSI;
     |CIERRA #rem00058;
|FPRC;

|PROCESO rem00029;
     #rew00628#25 = #rew00628#25 + (#rem00029#6 + #rem00029#11);

     |SI #rem00029#8 = "N";
         #rew00628#26 = #rew00628#26 + #rem00029#7;
     |SINO;
         #rew00628#27 = #rew00628#27 + #rem00029#7;
     |FINSI;
|FPRC;

|DEFBUCLE rem00029;
     #rem00029#1;
     ;
     #rew00628#0, #rew00628#1, 00;
     #rew00628#0, #rew00628#1, 99;
     ;
     NULL, rem00029;
|FIN;

|PROCESO Ingresos;
     #rew00628#25 = 0;
     #rew00628#26 = 0;
     #rew00628#27 = 0;
     |BUCLE rem00029;

     |SI #rew00628#25 > 300000;
         |MENAV "0000Los ingresos superan los 300.0000 Euros. No puede estar en este regimen";
     |FINSI;

     |PINTA #rew00628#25;
     |PINTA #rew00628#26;
     |PINTA #rew00628#27;

     |HAZ TotalFw628;
|FPRC;

|| ---- PROCESOS DEL REW00629

|PROCESO FinVentana629;
     |SI nVentana629 ! -1;
         |FINVENTANA nVentana629;
     |FINSI;

     nVentana629 = -1;
     |PULSATECLA;
|FPRC;

|PROCESO Tipo12Fw629;  |TIPO 12;
     |HAZ FinVentana629;
|FPRC;

|PROCESO Tipo7C3Fw629;  |TIPO 7;
     |VENTANA 0625, 1045, nPanta629, 1, "";
     nVentana629 = FSalida;

     |CONTROL_SIMPLE 0, "LABEL,{{15}}OPCIONES", 0626, 0645, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}F2.- Por C¢digo renta", 0726, 0745, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}F3.- Por Nombre", 0826, 0845, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}F4.- Todos", 0926, 0945, NULL;

     |PTEC 802;  |PAUSA;
|FPRC;

|PROCESO Tipo0C3Fw629;  |TIPO 0;
     nTecla = FSalida;

     |HAZ FinVentana629;

     nContenido = Contenido;
     |SI nContenido ! #rew00629#3;
         #rew00629#5 = 0;  |PINTA #rew00629#5;
     |FINSI;

     eaTipo = "";

     |SI nTecla = 10;  |O nTecla = 11;
         |VENTANA 0625, 1045, nPanta629, 1, "";
         nVentana629 = FSalida;

         |CONTROL_SIMPLE 0, "LABEL,{{15}}TIPO PRODUCTO", 0626, 0645, NULL;

         |CONTROL_SIMPLE 0, "LABEL,{{16}}-A- Agrario", 0726, 0740, NULL;
         |CONTROL_SIMPLE 0, "LABEL,{{16}}-G- Ganaderos", 0826, 0840, NULL;
         |CONTROL_SIMPLE 0, "LABEL,{{16}}-F- Forestales", 0926, 0940, NULL;

         E_inf  = "AGFagf";
         E_sup  = "1";
         eaTipo = 0842 ? 1;
         eaTipo = eaTipo > " ";

         |HAZ FinVentana629;
     |FINSI;

     |SI nTecla = 10;
         enTipo    = 1;
         enCultivo = #rew00629#3;
         |SUB_EJECUTA_NP "rem00500";

         #rew00629#3 = enCultivo;
         |PINTA #rew00629#3;

         |ERROR;
         |ACABA;
     |FINSI;

     |SI nTecla = 11;
         enTipo    = 2;
         enCultivo = #rew00629#3;
         |SUB_EJECUTA_NP "rem00500";

         #rew00629#3 = enCultivo;
         |PINTA #rew00629#3;

         |ERROR;
         |ACABA;
     |FINSI;

     |SI nTecla = 12;
         eaTipo    = "";
         enTipo    = 3;
         enCultivo = #rew00629#3;
         |SUB_EJECUTA_NP "rem00500";

         #rew00629#3 = enCultivo;
         |PINTA #rew00629#3;

         |ERROR;
         |ACABA;
     |FINSI;

     |ABRE #rem00500;
     #rem00500#0 = #rew00629#3;
     |LEE 040#rem00500.=;
     |SI FSalida ! 0;
         |CIERRA #rem00500;
         |MENAV "0000 No existe el Producto";
         |ERROR;
         |ACABA;
     |FINSI;
     |CIERRA #rem00500;
|FPRC;

|PROCESO T0C11Fw29;  |TIPO 0;
     |SI #rew00629#11 ! Contenido;
         #rew00629#5 = 0;
     |FINSI;

     |SI #rew00629#5 = 0;
         #rew00629#5 = #rem00500#5;
     |FINSI;

     |SI #rew00629#11 ! 0;  |Y #rew00629#6 = 0;
         #rew00629#5 = 0.56;
     |FINSI;

     #rew00629#9 = #rem00500#8;

     |C_M #rew00629#8, 1, "S";
     |SI #rem00500#6 ! "A";
         #rew00629#8 = "N";  |PINTA #rew00629#8;
         |C_M #rew00629#8, 1, "N";
     |FINSI;

     |PINTA #rew00629#5;
     |PINTA #rew00629#9;
|FPRC;

|PROCESO TotalLin;
     #rew00629#7  = (#rew00629#6 + #rew00629#11) * #rew00629#5;
|FPRC;

|PROCESO Arrendamiento;
     |ABRE #rem00500;
     #rem00500#0 = #rew00629#3;
     |LEE 040#rem00500.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00500;  |FINSI;
     |CIERRA #rem00500;

     |SI #rew00629#8 = "S";
         #rew00629#9 = #rem00500#8 + 1;
     |SINO;
         #rew00629#9 = #rem00500#8;
     |FINSI;
|FPRC;

|PROCESO Tipo0C2Fw629;  |TIPO 0;
     |C_M #rew00629#2, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     #rem00029#0 = #rew00629#0;
     #rem00029#1 = #rew00629#1;
     #rem00029#2 = #rew00629#2;
     |LEE 000#rem00029.=;
     |SI FSalida = 0;
         |MENAV "0000El registro ya existe.";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO CargaFantasma629;
     |PARA nCampo = 0;  |SI nCampo [ 11;  |HACIENDO nCampo = nCampo + 1;
           #rew00629#nCampo# = #rem00029#nCampo#;
     |SIGUE;
|FPRC;

|PROCESO DescargaFantasma629;
     |PARA nCampo = 0;  |SI nCampo [ 11;  |HACIENDO nCampo = nCampo + 1;
           #rem00029#nCampo# = #rew00629#nCampo#;
     |SIGUE;
|FPRC;

|PROCESO Alta29;
     |SI enModoReg = 4;  |ACABA;  |FINSI;

     |VENTANA 0501, 1180, -1, 0, "";
     nVentana = FSalida;

     |PTEC 802;  |PAUSA;

     |DDEFECTO #rew00629;

     #rem00029#0 = #rew00628#0;
     #rem00029#1 = #rew00628#1;
     #rem00029#2 = 99;
     |LEE 000#rem00029.];
     |SI FSalida = 0;
         |LEE 000#rem00029.a;
     |SINO;
         |LEE 000#rem00029.u;
     |FINSI;

     #rew00629#2 = 1;
     |SI FSalida = 0;  |Y  #rem00029#0 = enEmpresa;
         #rew00629#2 = #rem00029#2 + 1;
     |FINSI;

     |DDEFECTO #rem00029;

     #rem00029#0 = #rew00628#0;
     #rem00029#1 = #rew00628#1;
     #rem00029#2 = #rew00629#2;

     |PINPA #0#rew00629;  nPanta629 = FSalida;

     |C_M #rew00629#2, 1, "S";

     |HAZ CargaFantasma629;
     |PINDA #0#rew00629;

     |ENDATOS #1#rew00629;
     |SI FSalida = 0;
         |HAZ DescargaFantasma629;

         |GRABA 020#rem00029.n;
         |LIBERA #rem00029;

         enSwRetorno = 1;
     |FINSI;

     |HAZ FinVentana;

     Control = "rew00628";

     |HAZ Ingresos;

     |REFRESCACONTROL nGrid29;
     |FOCOTECLADO nGrid29;
     |PULSATECLA;
|FPRC;

|PROCESO Modificar29;
     |SI nEBotonModi29 = 0;  |ACABA;  |FINSI;

     |LEE 101#rem00029.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |VENTANA 0501, 1180, -1, 0, "";
     nVentana = FSalida;

     |PTEC 802;  |PAUSA;

     |PINPA #0#rew00629;  nPanta629 = FSalida;

     |C_M #rew00629#2, 1, "N";

     |HAZ CargaFantasma629;
     |PINDA #0#rew00629;

     |ENDATOS #1#rew00629;
     |SI FSalida = 0;
         |HAZ DescargaFantasma629;

         |GRABA 020#rem00029.a;
         |LIBERA #rem00029;
         enSwRetorno = 1;
     |FINSI;

     |HAZ FinVentana;

     Control = "rew00628";

     |HAZ Ingresos;

     |REFRESCACONTROL nGrid29;
     |FOCOTECLADO nGrid29;
     |PULSATECLA;
|FPRC;

|PROCESO Baja29;
     |SI nEBotonBaja29 = 0;  |ACABA;  |FINSI;

     |CONFI "0000 Confirma la baja del registro seleccionado";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |LEE 101#rem00029.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BORRA 020#rem00029.a;
     |LIBERA #rem00029;

     |HAZ Ingresos;

     enSwRetorno = 1;

     |REFRESCACONTROL nGrid29;
     |FOCOTECLADO nGrid29;
|FPRC;

|| ---- PROCESOS DEL REW00628

|PROCESO FinVentana;
     |SI nVentana ! -1;
         |FINVENTANA nVentana;
     |FINSI;

     nVentana = -1;
     |PULSATECLA;
|FPRC;

|PROCESO Tipo12Fw628;  |TIPO 12;
     |SI FSalida = 7;
         |HAZ FinVentana;
         |ACABA;
     |FINSI;

     |HAZ FinVentana;

     aAlfa = #rew00628#2;  |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000No se puede validar la ficha, no hay contribuyente introducido";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO TotalFw628;
     #rew00628#47 = 0;
     |SI #rew00628#56 = "S";
         #rew00628#47 = 25;
         #rew00628#39 = 0;
     |FINSI;

     #rew00628#33 = #rew00628#31 + #rew00628#32;
     |PINTA #rew00628#33;

     #rew00628#30 = #rew00628#26 + #rew00628#27;
     #rew00628#34 = #rew00628#30 - #rew00628#33;

     |SI #rew00628#34 < 0;
         #rew00628#35 = 0;   |PINTA #rew00628#35;
         #rew00628#36 = 0;   |PINTA #rew00628#36;
         #rew00628#37 = 0;   |PINTA #rew00628#37;
         #rew00628#38 = 0;   |PINTA #rew00628#38;
         #rew00628#54 = 0;   |PINTA #rew00628#54;
         #rew00628#42 = 0;   |PINTA #rew00628#42;
         #rew00628#55 = 0;   |PINTA #rew00628#55;
     |FINSI;

     nCanti1 = #rew00628#26 - #rew00628#31;
     |SI #rew00628#35 ! 0;  nCanti1 = nCanti1 * #rew00628#35;  |FINSI;
     |SI #rew00628#36 ! 0;  nCanti1 = nCanti1 * #rew00628#36;  |FINSI;
     |SI #rew00628#38 ! 0;  nCanti1 = nCanti1 * #rew00628#38;  |FINSI;
     |SI #rew00628#54 ! 0;  nCanti1 = nCanti1 * #rew00628#54;  |FINSI;

     nCanti2 = #rew00628#27 - #rew00628#32;
     |SI #rew00628#35 ! 0;  nCanti2 = nCanti2 * #rew00628#35;  |FINSI;
     |SI #rew00628#36 ! 0;  nCanti2 = nCanti2 * #rew00628#36;  |FINSI;
     |SI #rew00628#37 ! 0;  nCanti2 = nCanti2 * #rew00628#37;  |FINSI;
     |SI #rew00628#38 ! 0;  nCanti2 = nCanti2 * #rew00628#38;  |FINSI;
     |SI #rew00628#54 ! 0;  nCanti2 = nCanti2 * #rew00628#54;  |FINSI;

     |SI #rew00628#42 ! 0;
         nValor2 = nCanti1 - (nCanti1 % #rew00628#41);
         nValor1 = nCanti1 - nValor2;
         nCanti1 = (nValor1 * #rew00628#42) + nValor2;

         nValor2 = nCanti2 - (nCanti2 % #rew00628#41);
         nValor1 = nCanti2 - nValor2;
         nCanti2 = (nValor1 * #rew00628#42) + nValor2;
     |FINSI;

     |SI #rew00628#56 = "N";
         #rew00628#39 = 0;
         |SI #rew00628#17 ! "2";  |Y  #rew00628#17 ! "6";  |Y  #rew00628#17 ! "8";
             |SI #rew00628#34 ] 0;
                 |SI nPas = 0;
                     |SI #rew00628#34 [ 9447.91;
                         #rew00628#39 = 0.9;
                     |FINSI;
                 |FINSI;

                 |SI nPas = 1;
                     |SI nRdtoMin [ 9447.91;
                         #rew00628#39 = 0.9;
                     |FINSI;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |PINTA #rew00628#47;
     |PINTA #rew00628#39;

     |SI #rew00628#39 ! 0;  nCanti1 = nCanti1 * #rew00628#39;  |FINSI;
     |SI #rew00628#55 ! 0;  nCanti1 = nCanti1 * #rew00628#55;  |FINSI;

     |SI #rew00628#39 ! 0;  nCanti2 = nCanti2 * #rew00628#39;  |FINSI;
     |SI #rew00628#55 ! 0;  nCanti2 = nCanti2 * #rew00628#55;  |FINSI;

     |C_M #rew00628#36, 1, "S";
     |SI #rew00628#35 ! 0;  #rew00628#36 = 0;  |C_M #rew00628#36, 1, "N";  |PINTA #rew00628#36;  |FINSI;

     |C_M #rew00628#35, 1, "S";
     |SI #rew00628#36 ! 0;  #rew00628#35 = 0;  |C_M #rew00628#35, 1, "N";  |PINTA #rew00628#35;  |FINSI;

     |C_M #rew00628#37, 1, "S";
     |SI #rew00628#27 = 0;  #rew00628#37 = 0;  |C_M #rew00628#37, 1, "N";  |PINTA #rew00628#37;  |FINSI;


     #rew00628#40 = nCanti1 + nCanti2;
     #rew00628#57 = 0;

     |C_M #rew00628#64, 1, "N";

     |SI #rew00628#40 > 0;
           #rew00628#64 =  5;
           #rew00628#57 = #rew00628#40 % #rew00628#64;
     |SINO;
          #rew00628#64 = 0;
     |FINSI;

     #rew00628#44 = #rew00628#40 - #rew00628#57;
     #rew00628#48 = 0;

     |SI #rew00628#47 > 0;
         #rew00628#48 = #rew00628#44 % #rew00628#47;
     |FINSI;

     |SI #rew00628#48 < 0;  #rew00628#48 = -#rew00628#48;  |FINSI;

     #rew00628#49 = #rew00628#44 - #rew00628#48 - #rew00628#43;

     #rew00628#51 = 0;
     |SI #rew00628#50 = "S";
         #rew00628#51 = #rew00628#49 % 30;
          |SI #rew00628#51 > 90000; #rew00628#51 = 90000;  |FINSI;
     |FINSI;

     #rew00628#52 = #rew00628#49 - #rew00628#51;

     |PINTA #rew00628#25;
     |PINTA #rew00628#30;
     |PINTA #rew00628#34;
     |PINTA #rew00628#40;
     |PINTA #rew00628#44;
     |PINTA #rew00628#49;
     |PINTA #rew00628#52;
     |PINTA #rew00628#51;
     |PINTA #rew00628#57;
     |PINTA #rew00628#48;
     |PINTA #rew00628#64;
|FPRC;

|PROCESO BtnRecoger;
     enEmpresa = #rew00628#0;
     |SUB_EJECUTA "rezcaptu;ASALARIADO";

     |SI #rew00628#2 = "TITULAR   ";  #rew00628#53 = enImporteT;  |FINSI;
     |SI #rew00628#2 = "CONYUGE   ";  #rew00628#53 = enImporteC;  |FINSI;
     |SI #rew00628#2 = "1 FAMILIAR";  #rew00628#53 = enImporte1;  |FINSI;
     |SI #rew00628#2 = "2 FAMILIAR";  #rew00628#53 = enImporte2;  |FINSI;
     |SI #rew00628#2 = "3 FAMILIAR";  #rew00628#53 = enImporte3;  |FINSI;
     |SI #rew00628#2 = "4 FAMILIAR";  #rew00628#53 = enImporte4;  |FINSI;

     |SI #rew00628#2 = "GANANCIAL ";
         #rew00628#53 = enImporteT + enImporteC;
     |FINSI;

     |SI #rew00628#2 = "VARIOS    ";
         |SI #rew00628#5  ! 0;  #rew00628#53 = enImporteT;            |FINSI;
         |SI #rew00628#6  ! 0;  #rew00628#53 = #rew00628#53 + enImporteC;  |FINSI;
         |SI #rew00628#7  ! 0;  #rew00628#53 = #rew00628#53 + enImporte1;  |FINSI;
         |SI #rew00628#8  ! 0;  #rew00628#53 = #rew00628#53 + enImporte2;  |FINSI;
         |SI #rew00628#9  ! 0;  #rew00628#53 = #rew00628#53 + enImporte3;  |FINSI;
         |SI #rew00628#10 ! 0;  #rew00628#53 = #rew00628#53 + enImporte4;  |FINSI;
     |FINSI;

     |PINTA #rew00628#53;
|FPRC;

|PROCESO PonPorce;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     FSalida = 0;
     |SI Campo = 36;
         |VENTANA 0501, 0955, -1, 16, "Importe personal asalariado";
         nVentana = FSalida;

         |CONTROL_SIMPLE 0, "BOTON,Recoger importe de contabilidad", 0615, 0640, BtnRecoger;
         |CONTROL_SIMPLE 0, "LABEL,{{7}}El importe de contabilidad se recoge del fichero de cuentas y del grupo 64.", 0802, 0853, NULL;
         |CONTROL_SIMPLE 0, "LABEL,{{7}}Si la empresa tiene m s de una actividad el importe puede ser err¢neo.", 0902, 0953, NULL;

         |C_P #rew00628#53, 1, 0602;  |C_V #rew00628#53, 1, "S";  |C_M #rew00628#53, 1, "S";
         |ENCAMPO #53#rew00628;
                                 |C_V #rew00628#53, 1, "N";  |C_M #rew00628#53, 1, "N";

         |HAZ FinVentana;

         nPorce = (#rew00628#53 / #rew00628#25) * 100;

         #rew00628#36 = 1;
         |SI nPorce ] 10; #rew00628#36 = 0.90; |FINSI;
         |SI nPorce > 20; #rew00628#36 = 0.85; |FINSI;
         |SI nPorce > 30; #rew00628#36 = 0.80; |FINSI;
         |SI nPorce > 40; #rew00628#36 = 0.75; |FINSI;

         |PINTA #rew00628#36;
     |FINSI;

     |SI Campo = 35;  #rew00628#35 = 0.75;  |PINTA #rew00628#35;  |FINSI;
     |SI Campo = 37;  #rew00628#37 = 0.90;  |PINTA #rew00628#37;  |FINSI;
     |SI Campo = 38;  #rew00628#38 = 0.75;  |PINTA #rew00628#38;  |FINSI;
     |SI Campo = 47;  #rew00628#47 = 25;    |PINTA #rew00628#47;  |FINSI;
     |SI Campo = 42;  #rew00628#42 = .8;    |PINTA #rew00628#42;  |FINSI;
     |SI Campo = 54;  #rew00628#54 = .95;   |PINTA #rew00628#54;  |FINSI;
     |SI Campo = 55;  #rew00628#55 = .80;   |PINTA #rew00628#55;  |FINSI;
|FPRC;

|PROCESO Tipo7C17Fw628;  |TIPO 7;
     |VENTANA 1636, 2692, -1, 1, "";
     nVentana = FSalida;

     |CONTROL_SIMPLE 0, "LABEL,{{15}}CLAVE ACTIVIDAD", 1650, 1680, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}1.- Agricola o ganadera R.E. de Agr.Ganad.y Pesca", 1737, 1792, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}2.- Forestal R.E.de Agricultura,Ganaderia y Pesca", 1837, 1892, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}3.- Ganaderia independiente en la division 0 IAE", 1937, 1992, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}4.- Servicio de cria, guarda y engorde de ganado", 2037, 2092, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}5.- Otros trabajos o servicios excluido del 1.", 2137, 2192, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}6.- Otros trabajos o servicios excluido del 2.", 2237, 2292, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}7.- Aprovechamiento del cedente Actividad Agricola", 2337, 2392, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}8.- Aprovechamiento del cedente Actividad Forestal", 2437, 2492, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}9.- Procesos de Transformacion.", 2537, 2592, NULL;

     |PTEC 802;  |PAUSA;
|FPRC;

|PROCESO Tipo0C17Fw628;  |TIPO 0;
     |HAZ FinVentana;
|FPRC;

|PROCESO Tipo7C15Fw628;  |TIPO 7;
     |SI #rew00628#14 = "N";
         #rew00628#15 = 100;   |PINTA #rew00628#15;
         #rew00628#20 = "";    |PINTA #rew00628#20;
         #rew00628#69 = "";    |PINTA #rew00628#69;
         |C_M #rew00628#15, 1, "N";
         |C_M #rew00628#20, 1, "N";
         |C_M #rew00628#69, 1, "N";
         |ACABA;
     |FINSI;

     |C_M #rew00628#15, 1, "S";
     |C_M #rew00628#20, 1, "S";
     |C_M #rew00628#69, 1, "S";

     |VENTANA 1536, 1890, -1, 1, "";
     nVentana = FSalida;

     |CONTROL_SIMPLE 0, "LABEL,{{15}}RECUERDE", 1550, 1580, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}Las cantidades se introducir n al 100%, luego el c lculo las ", 1637, 1690, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}computar  al porcentaje de comunero que le hayamos informado ", 1737, 1790, NULL;

     |PTEC 802;  |PAUSA;
|FPRC;

|PROCESO Tipo0C15Fw628;  |TIPO 0;
     |HAZ FinVentana;
|FPRC;

|PROCESO LetraNif;  |TIPO 6;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     eaVarDni = #rew00628#Campo#;
     |HAZ CalculoDNI;
     #rew00628#Campo# = eaVarDni;
     |PINTA #rew00628#Campo#;
     |ERROR;
|FPRC;

|PROCESO CampoNif;  |TIPO 0;
     |SI #rew00628#14 = "N";  |ACABA;  |FINSI;

     |SI #rew00628#20 = "            ";
         |MENAV "     Introduzca un Nif.";
         |ERROR;
         |ACABA;
     |FINSI;

     aLong = #rew00628#20;  |QBF aLong;
     aLong = aLong % 0;
     nLong = aLong;
     |SI nLong ! 9;
         |MENAV "     Longitud Erronea.";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa = #rew00628#20 % 101;
     |SI aAlfa ! "E";  |Y aAlfa ! "H";  |Y aAlfa ! "J";
         |MENAV "     El Nif  debe empezar por E, H o J";
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO Tipo0C1Fw628;  |TIPO 0;
     |C_M #rew00628#1, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     #rem00028#0 = #rew00628#0;
     #rem00028#1 = #rew00628#1;
     |LEE 000#rem00028.=;
     |SI FSalida = 0;
         |MENAV "0000El registro ya existe.";
         |ERROR;
         |ACABA;
     |FINSI;

     |HAZ CreaLineal29;
|FPRC;

|PROCESO Baja_29;
     #rem00029#0 = #rew00628#0;
     #rem00029#1 = #rew00628#1;
     #rem00029#2 = 1;
|FPRC;

|PROCESO Alta_29;
     #rem00029#0 = #rew00628#0;
     #rem00029#1 = #rew00628#1;
     #rem00029#2 = 99;
|FPRC;

|PROCESO Evento29;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#rem00029.=;

         |SI enModoReg = 4;
             |ESTADO_CONTROL nBotonModi29, "DISABLE";  nEBotonModi29 = 0;
             |ESTADO_CONTROL nBotonBaja29, "DISABLE";  nEBotonBaja29 = 0;
         |SINO;
             |ESTADO_CONTROL nBotonModi29, "ENABLE";  nEBotonModi29 = 1;
             |ESTADO_CONTROL nBotonBaja29, "ENABLE";  nEBotonBaja29 = 1;
         |FINSI;

         |PULSATECLA;
     |FINSI;
|FPRC;

|PROCESO CreaLineal29;
     |SI nGrid29 ! -1;
         |DESTRUYECONTROL nGrid29;
     |FINSI;

     |LINEAL_SIMPLE #1#rem00029, nRango, 1802, 2398, Baja_29, Alta_29, Evento29;
     nGrid29 = FSalida;
|FPRC;

|PROCESO CargaFantasma;
     |C_M #rew00628#11, 1, "S";
     |C_M #rew00628#14, 1, "S";
     |C_M #rew00628#15, 1, "S";
     |C_M #rew00628#16, 1, "S";
     |C_M #rew00628#17, 1, "S";
     |C_M #rew00628#18, 1, "S";
     |C_M #rew00628#19, 1, "S";
     |C_M #rew00628#21, 1, "S";
     |C_M #rew00628#22, 1, "S";
     |C_M #rew00628#23, 1, "S";
     |C_M #rew00628#24, 1, "S";
     |C_M #rew00628#31, 1, "S";
     |C_M #rew00628#32, 1, "S";
     |C_M #rew00628#35, 1, "S";
     |C_M #rew00628#36, 1, "S";
     |C_M #rew00628#37, 1, "S";
     |C_M #rew00628#38, 1, "S";
     |C_M #rew00628#41, 1, "S";
     |C_M #rew00628#42, 1, "S";
     |C_M #rew00628#54, 1, "S";
     |C_M #rew00628#54, 1, "S";
     |C_M #rew00628#39, 1, "N";
     |C_M #rew00628#55, 1, "S";
     |C_M #rew00628#64, 1, "S";
     |C_M #rew00628#47, 1, "N";
     |C_M #rew00628#43, 1, "S";
     |C_M #rew00628#50, 1, "S";
     |C_M #rew00628#56, 1, "S";

     |PARA nCampo = 0;  |SI nCampo [ nNumCampos;  |HACIENDO nCampo = nCampo + 1;
           #rew00628#nCampo# = #rem00028#nCampo#;

           |C_V #rew00628#nCampo#, 0, aAlfa;
           |SI aAlfa = "S";  |PINTA #rew00628#nCampo#;  |FINSI;
     |SIGUE;

     |HAZ Borra58;

     eaDeDonde  = "D4";
     eaLinDonde = #rem00028#1;
     eaLetra    = "C1";
     |HAZ BorraPatrimonio;

     |HAZ CreaLineal29;
|FPRC;

|PROCESO DescargaFantasma;
     |PARA nCampo = 0;  |SI nCampo [ nNumCampos;  |HACIENDO nCampo = nCampo + 1;
           |SI enSwLiquida = 1;
               |SI #rem00028#nCampo# = #rew00628#nCampo#;
                   enSwRetorno = 1;
               |FINSI;
           |FINSI;

           #rem00028#nCampo# = #rew00628#nCampo#;
     |SIGUE;

                        #rem00028#68 = "";
     |SI #rem00028#3  = "X";  #rem00028#68 = eaRojo;  |FINSI;

     |HAZ PintaDatosPantalla;
|FPRC;

|PROCESO rem00028_Ajus;
     |SI nPas = 0;
         |SI aJoven = "";
             aJoven = #rem00028#56;
         |FINSI;

         |SI #rew00628#17 ! "2";  |Y  #rew00628#17 ! "6";  |Y  #rew00628#17 ! "8";
             nRdtoMin = nRdtoMin + #rem00028#34;
         |FINSI;
     |FINSI;

     |SI nPas = 1;
         #rem00028#56 = aJoven;

         |SI #rem00028#17 ! "2";  |Y  #rem00028#17 ! "6";  |Y  #rem00028#17 ! "8";
             |SI nRdtoMin > 9447.91;
                 #rem00028#39 = 0;
             |FINSI;
         |FINSI;

         |PARA nCampo = 0;  |SI nCampo [ nNumCampos;  |HACIENDO nCampo = nCampo + 1;
               #rew00628#nCampo# = #rem00028#nCampo#;
         |SIGUE;

         |HAZ TotalFw628;

         |PARA nCampo = 0;  |SI nCampo [ nNumCampos;  |HACIENDO nCampo = nCampo + 1;
               #rem00028#nCampo# = #rew00628#nCampo#;
         |SIGUE;

         |GRABA 020#rem00028.a;
         |LIBERA #rem00028;
     |FINSI;
|FPRC;

|DEFBUCLE rem00028_Ajus;
     #rem00028#2;
     ;
     enEmpresa, aCon, 01;
     enEmpresa, aCon, 99;
     ;
     NULL, rem00028_Ajus;
|FIN;

|PROCESO Ajusta;
     nRdtoMin = 0;
     aJoven   = "";
     nPas = 0;  |BUCLE rem00028_Ajus;
     nPas = 1;  |BUCLE rem00028_Ajus;
|FPRC;

|PROCESO AjustaReduc;
     nLin = #rem00028#1;

     aCon = "TITULAR";     |HAZ Ajusta;
     aCon = "CONYUGE";     |HAZ Ajusta;
     aCon = "1 FAMILIAR";  |HAZ Ajusta;
     aCon = "2 FAMILIAR";  |HAZ Ajusta;
     aCon = "3 FAMILIAR";  |HAZ Ajusta;
     aCon = "4 FAMILIAR";  |HAZ Ajusta;

     nPas = 0;

     #rem00028#0 = enEmpresa;
     #rem00028#1 = nLin;
     |LEE 000#rem00028.=;
|FPRC;

|PROCESO Alta;
     |ESTADO_CONTROL nBotonAlta,   "DISABLE";
     |ESTADO_CONTROL nBotonModi,   "DISABLE";
     |ESTADO_CONTROL nBotonBaja,   "DISABLE";
     |ESTADO_CONTROL nBotonAlta29, "ENABLE";

     |HAZ QuitaBtnSalir;

     |ESTADO_CONTROL nGrid, "DISABLE";

     |PULSATECLA;

     #rem00028#0 = enEmpresa;
     #rem00028#1 = 99;
     |LEE 000#rem00028.];
     |SI FSalida = 0;
         |LEE 000#rem00028.a;
     |SINO;
         |LEE 000#rem00028.u;
     |FINSI;

     nValor28 = 0;

     |DDEFECTO #rew00628;
     #rew00628#0 = enEmpresa;
     #rew00628#1 = 1;
     |SI FSalida = 0;  |Y  #rem00028#0 = enEmpresa;
         #rew00628#1  = #rem00028#1 + 1;
     |FINSI;

     |DDEFECTO #rem00028;

     #rem00028#0  = #rew00628#0;
     #rem00028#1  = #rew00628#1;

     enModoReg = 1;
     |HAZ CargaFantasma;

     |C_M #rew00628#1, 1, "S";
     |ENDATOS #1#rew00628;
     |SI FSalida = 0;
         |HAZ DescargaFantasma;

         |GRABA 020#rem00028.n;
         |LIBERA #rem00028;

         |HAZ AjustaReduc;
         |HAZ Patrimonio;
         |HAZ Graba58;
     |FINSI;

     |SI enModo ! 4;
         |ESTADO_CONTROL nBotonAlta, "ENABLE";
     |FINSI;

     |ESTADO_CONTROL nBotonAlta29, "DISABLE";
     |ESTADO_CONTROL nBotonModi29, "DISABLE";  nEBotonModi29 = 0;
     |ESTADO_CONTROL nBotonBaja29, "DISABLE";  nEBotonBaja29 = 0;

     |HAZ PonBtnSalir;

     enModoReg = 4;
     |ESTADO_CONTROL nGrid, "ENABLE";
     |REFRESCACONTROL nGrid;

     |SI #rem00028#0 ! enEmpresa;
         |DDEFECTO #rem00028;
         #rem00028#0 = enEmpresa;
     |FINSI;

     FSalida = 1;  |HAZ Evento20;

     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO Modificar;
     |SI nEntrar = 0;  |ACABA;  |FINSI;

     |LEE 101#rem00028.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ESTADO_CONTROL nBotonAlta,  "DISABLE";
     |ESTADO_CONTROL nBotonModi,  "DISABLE";
     |ESTADO_CONTROL nBotonBaja,  "DISABLE";
     |ESTADO_CONTROL nBotonAlta29, "ENABLE";

     |HAZ QuitaBtnSalir;

     |ESTADO_CONTROL nGrid, "DISABLE";

     enModoReg = 2;
     |C_M #rew00628#1, 1, "N";

     |HAZ CargaFantasma;
     |ENDATOS #2#rew00628;
     |SI FSalida = 0;
         |HAZ DescargaFantasma;

         |GRABA 020#rem00028.a;
     |FINSI;
     |LIBERA #rem00028;

     |HAZ AjustaReduc;
     |HAZ Patrimonio;
     |HAZ Graba58;

     |ESTADO_CONTROL nBotonAlta, "ENABLE";
     |ESTADO_CONTROL nBotonModi, "ENABLE";
     |ESTADO_CONTROL nBotonBaja, "ENABLE";
     |ESTADO_CONTROL nBotonAlta29, "DISABLE";
     |ESTADO_CONTROL nBotonModi29, "DISABLE";  nEBotonModi29 = 0;
     |ESTADO_CONTROL nBotonBaja29, "DISABLE";  nEBotonBaja29 = 0;

     |HAZ PonBtnSalir;

     enModoReg = 4;
     |ESTADO_CONTROL nGrid, "ENABLE";
     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO Baja;
     |SI nEntrar = 0;  |ACABA;  |FINSI;

     |CONFI "0000 Confirma la baja del registro seleccionado";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |LEE 101#rem00028.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BORRA 020#rem00028.a;
     |LIBERA #rem00028;

     |BUCLE rem00029B;

     |HAZ Borra58;

     eaDeDonde  = "D4";
     eaLinDonde = #rem00028#1;
     eaLetra    = "C1";
     |HAZ BorraPatrimonio;

     |HAZ AjustaReduc;

     nEntrar     = 0;
     enSwRetorno = 1;

     |ESTADO_CONTROL nBotonModi,  "DISABLE";  nEBotonModi29 = 0;
     |ESTADO_CONTROL nBotonBaja,  "DISABLE";  nEBotonBaja29 = 0;

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO BotonCntr;
     enComunes   = 0;
     enChequeo   = 0;

     #rew00003#0 = #rew00628#2;
     #rew00003#1 = #rew00628#3;
     #rew00003#2 = #rew00628#4;
     #rew00003#3 = #rew00628#5;
     #rew00003#4 = #rew00628#6;
     #rew00003#5 = #rew00628#7;
     #rew00003#6 = #rew00628#8;
     #rew00003#7 = #rew00628#9;
     #rew00003#8 = #rew00628#10;

     |HAZ PantaREW00003;

     #rew00628#2  = #rew00003#0;    |PINTA #rew00628#2;
     #rew00628#3  = #rew00003#1;
     #rew00628#4  = #rew00003#2;
     #rew00628#5  = #rew00003#3;
     #rew00628#6  = #rew00003#4;
     #rew00628#7  = #rew00003#5;
     #rew00628#8  = #rew00003#6;
     #rew00628#9  = #rew00003#7;
     #rew00628#10 = #rew00003#8;

     aAlfa = "|C014WID";
     aID   = #rew00628#aAlfa#;
     nID   = aID;
     |FOCOTECLADO nID;

     Control = "rew00628";

     |SI #rew00628#3 = "X";  |Y enModoReg ! 4;
         |PTEC 806;
     |FINSI;
|FPRC;

|PROCESO rem00028_Joven;
     aJoven = #rem00028@#56;
     |SI #rem00028@#1 = #rew00628#1;
         |C_M #rew00628#56, 1, "S";
     |FINSI;

     |ERROR10;
|FPRC;

|DEFBUCLE rem00028_Joven;
     #rem00028@#1002;
     2;
     #rew00628#0,  1, #rew00628#2;
     #rew00628#0, 99, #rew00628#2;
     ;
     NULL, rem00028_Joven;
|FIN;

|PROCESO Jovenes;
     |C_M #rew00628#56, 1, "N";

     aJoven = "";
     |DDEF aDef;
     aDef = aDef + "rem00028.mas";
     |CARGA_DEF aDef, rem00028@;
     |SI FSalida = 0;
         |BUCLE rem00028_Joven;
     |FINSI;
     |DESCARGA_DEF #rem00028@;

     |SI aJoven = "";
         aJoven = "N";
         |C_M #rew00628#56, 1, "S";
     |FINSI;

     #rew00628#56 = aJoven;
     |PINTA #rew00628#56;
|FPRC;

|PROCESO Tipo7C2Fw628;  |TIPO 7;
     aAlfa = #rew00628#2;  |QBF aAlfa;
     |SI aAlfa ! "";  |Y #rew00628#3 ! "X";
         |HAZ Jovenes;
         |ACABA;
     |FINSI;

     |HAZ BotonCntr;

     |HAZ Jovenes;
|FPRC;

|PROCESO PintaDatosPantalla;
     |DDEFECTO #rew00628;
     |PARA nCampo = 0;  |SI nCampo [ nNumCampos;  |HACIENDO nCampo = nCampo + 1;
           #rew00628#nCampo# = #rem00028#nCampo#;

           |C_V #rew00628#nCampo#, 0, aAlfa;
           |SI aAlfa = "S";  |PINTA #rew00628#nCampo#;  |FINSI;

           |C_M #rew00628#nCampo#, 1, "N";
     |SIGUE;

     |HAZ CreaLineal29;
|FPRC;

|PROCESO Evento20;
     |SI enModoReg ! 4;  |ACABA;  |FINSI;

     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#rem00028.=;

         |SI enModo = 4;
             |ESTADO_CONTROL nBotonAlta, "DISABLE";
             |ESTADO_CONTROL nBotonModi, "DISABLE";
             |ESTADO_CONTROL nBotonBaja, "DISABLE";
         |SINO;
             |ESTADO_CONTROL nBotonModi, "ENABLE";
             |ESTADO_CONTROL nBotonBaja, "ENABLE";
         |FINSI;

         |PULSATECLA;

         nEntrar   = 1;
         enModoReg = 4;
         |HAZ PintaDatosPantalla;
     |FINSI;

     |SI FSalida = 4;
         |SI enModo = 4;  |ACABA;  |FINSI;

         |HAZ Modificar;
     |FINSI;
|FPRC;

|PROCESO BotonesPanta;
     |CONTROL_SIMPLE nPanta, "BOTON,{{193}}&Alta ", 1264, 1274, Alta;
     nBotonAlta = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}&Modificar ", 1276, 1286, Modificar;
     nBotonModi = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{199}}&Borrar", 1288, 1298, Baja;
     nBotonBaja = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}} &Y", 1240, 1244, BotonCntr;
     nBotonCntr = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{193}}al&Ta ", 2464, 2474, Alta29;
     nBotonAlta29 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}mo&Dificar ", 2476, 2486, Modificar29;
     nBotonModi29 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{199}}b&Orrar", 2488, 2498, Baja29;
     nBotonBaja29 = FSalida;

     nEntrar = 0;

     |ESTADO_CONTROL nBotonModi,   "DISABLE";
     |ESTADO_CONTROL nBotonBaja,   "DISABLE";
     |ESTADO_CONTROL nBotonAlta29, "DISABLE";
     |ESTADO_CONTROL nBotonModi29, "DISABLE";  nEBotonModi29 = 0;
     |ESTADO_CONTROL nBotonBaja29, "DISABLE";  nEBotonBaja29 = 0;

     |SI enModo = 4;
         |ESTADO_CONTROL nBotonAlta, "DISABLE";
     |FINSI;
|FPRC;

|PROCESO Baja20;
     #rem00028#0 = enEmpresa;
     #rem00028#1 = 1;
|FPRC;

|PROCESO Alta20;
     #rem00028#0 = enEmpresa;
     #rem00028#1 = 99;
|FPRC;

|PROGRAMA;
     |HAZ CargaColores;

     |SI enNomeAgr = 1;
         |NOME_DAT #rem00028#"zzm00028"#;
         |NOME_DAT #rem00029#"zzm00029"#;
         |NOME_DAT #rem00058#"zzm00058"#;
     |FINSI;

     enSwRetorno = 0;
     aQueQuiero  = "|NC";
     aNumCampos  = #rem00028#aQueQuiero#;
     nNumCampos  = aNumCampos;
     nNumCampos  = nNumCampos - 1;
     nRango      = 4 + 8 + 16 + 32 + 128;
     enModoReg   = 4;

     |PINPA #0#rew00628;  nPanta = FSalida;

     |HAZ BotonesPanta;

     |DDEFECTO #rem00028;
     |HAZ PintaDatosPantalla;

     |ABRET #rem00028;
     |ABRET #rem00029;

     |LINEAL_SIMPLE #1#rem00028, nRango, 0602, 1198, Baja20, Alta20, Evento20;
     nGrid = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{001}}sa&Lir", 3488, 3498, Ptec806;
     enBtnSalir = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::," + nGrid;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;

          |SI aTecla = aRetu;
              |HAZ Modificar;
          |FINSI;
     |SIGUE;

     |CIERRAT #rem00028;
     |CIERRAT #rem00029;

     eaPrograma   = "rem00028";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRO;
