|FICHEROS;
    reinfimp #0;
    rey00100 #1;
    rem01001 #2;
    rem00100 #3;
    reacceso #4;
    retabla3 #103;

    reparame #100;
|FIN;

|VARIABLES;
   &EURO   = 0;
   &EURODB = 0;
   &EURODV = 0;

   nCmp = 0;
   Comodin = "";
   SwPasar = 0;
   SwPrint = 0;
   Sw100   = 0;
   Sw101   = 0;
   Sw714   = 0;
   Cont = 0;
   Calc = 0;
   Campo1 = 0;
   Campo2 = 0;
   Campo3 = 0;

   nImporte = 0;
   nParte   = 0;

   aTit     = "";

   DEmpresa = 0;
   HEmpresa = 0;

   SwError    = 0;
   nAutonomia = 0;

   &R214 = 0;
   &P214 = 0;
|FIN;

|INCLUYE i_consul;

|PROCESO Parrilla; |TIPO 0;
  |SI #0#18 = "S";
      |PARA nCmp = 19; |SI nCmp [ 36; |HACIENDO nCmp = nCmp + 1;
            #0nCmp = 0; |PINTA #0nCmp;
            |CAMPO_MODIFICA #0nCmp, 1, "N";
      |SIGUE;
      |CAMPO_MODIFICA #0#00, 1, "S";
      |CAMPO_MODIFICA #0#01, 1, "S";
  |SINO;
      #0#0 = 1;     |PINTA #0#0;
      #0#1 = 99999; |PINTA #0#1;
      |PARA nCmp = 19; |SI nCmp [ 36; |HACIENDO nCmp = nCmp + 1;
            |CAMPO_MODIFICA #0nCmp, 1, "S";
      |SIGUE;
      |CAMPO_MODIFICA #0#00, 1, "N";
      |CAMPO_MODIFICA #0#01, 1, "N";
  |FINSI;
|FPRC;

|PROCESO ContribNac;
   Comodin = #rem01001#2; |QBF Comodin;

   SwPasar = 1;
   |SI #0#5 ! "O";
       |SI #0#5 = "N"; |Y #rem01001#8 = "S"; SwPasar = 0; |FINSI;
       |SI #0#5 = "2"; |Y #rem01001#8 = "N"; SwPasar = 0; |FINSI;
       |SI #0#5 = "3";
            |SI #rem01001#8  = "N"; SwPasar = 0; |FINSI;
            |SI #rem01001#10 = "S"; SwPasar = 0; |FINSI;
       |FINSI;
       |SI #0#5 = "4";
            |SI #rem01001#8  = "N"; SwPasar = 0; |FINSI;
            |SI #rem01001#10 = "N"; SwPasar = 0; |FINSI;
       |FINSI;
   |FINSI;

   |SI #0#9 = "S"; |Y #rem01001#6 = "N"; SwPasar = 0; |FINSI;
   |SI #0#9 = "N"; |Y #rem01001#6 = "S"; SwPasar = 0; |FINSI;

   |SI #0#15 = "P"; |Y #rem01001#3 < 0; SwPasar = 0; |FINSI;
   |SI #0#15 = "D"; |Y #rem01001#3 ] 0; SwPasar = 0; |FINSI;

   |SI #0#2 ! "O";
       |SI #rem01001#5 = "100"; |Y #0#2 = "N"; SwPasar = 0; |FINSI;
       |SI #rem01001#5 = "101"; |Y #0#2 = "N"; SwPasar = 0; |FINSI;
   |FINSI;

   |SI #rem01001#5 = "714"; |Y #0#8 = "n"; SwPasar = 0; |FINSI;

   |SI SwPasar = 0; |O #rem01001#5 = "   "; |ACABA; |FINSI;

   nImporte = #rem01001#16;
   |SI #rem01001#5 = "714";
       nImporte = #rem01001#3;
   |FINSI;

   |SI #rem01001#8 = "S";
       |SI #0#5 = "1"; nImporte = nImporte % 60; |FINSI;
       |SI #0#5 = "2"; nImporte = nImporte % 40; |FINSI;
       |SI #0#5 = "3"; nImporte = nImporte % 40; |FINSI;
       |SI #0#5 = "4"; nImporte = nImporte % 40; |FINSI;
   |FINSI;

   #reacceso#0 = #rem00100#0;
   |LEE 010#reacceso.=;

   |SI nImporte ! 0;
      |SI #rem01001#5 = "100"; |O #rem01001#5 = "101";
         #rey00100#13 = 1;
         |SI Comodin = "CONJUNTA";   #rey00100#0 = nImporte; SwPrint = 1; |FINSI;
         |SI Comodin = "TITULAR";    #rey00100#1 = nImporte; SwPrint = 1; |FINSI;
         |SI Comodin = "CONYUGE";    #rey00100#2 = nImporte; SwPrint = 1; |FINSI;
         |SI Comodin = "1 FAMILIAR"; #rey00100#3 = nImporte; SwPrint = 1; |FINSI;
         |SI Comodin = "2 FAMILIAR"; #rey00100#4 = nImporte; SwPrint = 1; |FINSI;
         |SI Comodin = "3 FAMILIAR"; #rey00100#5 = nImporte; SwPrint = 1; |FINSI;
         |SI Comodin = "4 FAMILIAR"; #rey00100#6 = nImporte; SwPrint = 1; |FINSI;
      |FINSI;
      |SI #rem01001#5 = "714";
         #rey00100#14 = 1;
         |SI Comodin = "ZPATRITIT"; #rey00100#7 = nImporte; SwPrint = 1; |FINSI;
         |SI Comodin = "ZPATRICON"; #rey00100#8 = nImporte; SwPrint = 1; |FINSI;
      |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE ContribNac;
#rem01001#1;
;
#rem00100#0,00,"          ";
#rem00100#0,99,"zzzzzzzzzz";
;
NULL,ContribNac;
|FIN;

|PROCESO Contrib;
    SwPrint = 0;
    |DDEFECTO #rey00100;

||  |SI #rem00100#10 = "S";   1231 _ 682
       |BUCLE ContribNac;
       |SI SwPrint = 1;
          |PRINT;
       |FINSI;
||  |FINSI;
|FPRC;

|DEFBUCLE ContribCod;
#rem00100#1;
96;
DEmpresa,#0#12;
HEmpresa,#0#13;
;
NULL,Contrib;
|FIN;

|DEFBUCLE ContribNom;
#rem00100#1;
96;
DEmpresa,#0#12;
HEmpresa,#0#13;
;
NULL,NULL,NULL,NULL,NULL,Contrib;
#rem00100#5;
|FIN;

|PROCESO Tipo3; |TIPO 3;
   |IMPRE 0;
   |SI FSalida ! 0; |ACABA; |FINSI;

   |INFOR "reinfimp";
   |SI FSalida ! 0;
      |FINIMP;
      |ACABA;
   |FINSI;

   |ABRE #reacceso;
   |SI #0#18 = "S";
      DEmpresa = #0#0;
      HEmpresa = #0#1;
      |SI #0#17 = "1"; |BUCLE ContribCod; |FINSI;
      |SI #0#17 = "2"; |BUCLE ContribNom; |FINSI;
   |SINO;
      |PARA Cont = 19; |SI Cont [ 36; |HACIENDO Cont = Cont + 1;
         |SI #0#Cont# ! 0;
            DEmpresa = #0Cont;
            HEmpresa = #0Cont;
            |SI #0#17 = "1"; |BUCLE ContribCod; |FINSI;
            |SI #0#17 = "2"; |BUCLE ContribNom; |FINSI;
         |FINSI;
      |SIGUE;
   |FINSI;

   |PIEINF;
   |FININF;
   |FINIMP;

   |CIERRA #reacceso;
|FPRC;
