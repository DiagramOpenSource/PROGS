|FICHEROS;
     rew01004,MANTE;
|FIN;

|VARIABLES;
     nOk     = 0;
     nCampo1 = 0;
     nCampo2 = 0;
     nCampo3 = 0;
     nCampo4 = 0;
     nCampo5 = 0;
     nCampo6 = 0;
     nCampo7 = 0;
     nCampo8 = 0;

     aAlfa   = "";

 {20}aPopup  = "";
|FIN;

|PROCESO Tipo12Fw1004;  |TIPO 12;
     |SI FSalida ! 1;
         |ERROR;
         |POSICIONATE #rew01004#0;

         |ACABA;
     |FINSI;

     nOk = 0;
     |PARA nCampo2 = 1;  |SI nCampo2 [ 57;  |HACIENDO nCampo2 = nCampo2 + 8;
           nCampo1 = nCampo2 - 1;

           |SI #rew01004#nCampo2# ! "   ";  |Y #rew01004#nCampo1# = "   ";
               nOk = 1;
               |SAL;
           |FINSI;
     |SIGUE;

     |SI nOk = 1;
         |MENAV "0000Faltan campos obligatorios por introducir.";
         |ERROR;
         |POSICIONATE #rew01004#0;
     |FINSI;
|FPRC;

|PROCESO NoMod1004;  |TIPO 7;
     |PARA nCampo2 = 1;  |SI nCampo2 [ 57;  |HACIENDO nCampo2 = nCampo2 + 8;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;
           nCampo4 = nCampo2 + 2;
           nCampo5 = nCampo2 + 3;
           nCampo6 = nCampo2 + 4;
           nCampo7 = nCampo2 + 5;
           nCampo8 = nCampo2 + 6;

           |C_M #rew01004#nCampo7#, 1, "N";
           |C_M #rew01004#nCampo8#, 1, "N";

           |SI #rew01004#nCampo2# ! "   ";
               |C_M #rew01004#nCampo1#, 1, "S";
               |C_M #rew01004#nCampo4#, 1, "S";
               |C_M #rew01004#nCampo5#, 1, "S";

               |SI #rew01004#nCampo1# = "127";
                   |C_M #rew01004#nCampo7#, 1, "S";
                   |C_M #rew01004#nCampo8#, 1, "S";
               |FINSI;
           |SINO;
               |C_M #rew01004#nCampo1#, 1, "N";
               |C_M #rew01004#nCampo4#, 1, "N";
               |C_M #rew01004#nCampo5#, 1, "N";
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO T66Tipo;  |TIPO 66;
     aPopup1  = -1;
     aPopup2  = 17;

     aPopup3  = "107-Si de la declaracion complementaria resulta una cantidad ";
     aPopup3  = aPopup3 + "a devolver inferior a la solicitada en la declaracion ";
     aPopup3  = aPopup3 + "anterior y dicha devolucion no hubiera sido todavia ";
     aPopup3  = aPopup3 + "efectuada por la Agencia Tributaria";

     aPopup4  = "108-Haber percibido atrasos de rendimientos del trabajo despues ";
     aPopup4  = aPopup4 + "de la presentacion de la declaracion anterior del ";
     aPopup4  = aPopup4 + "ejercicio 2018 (artículo 14.2.b) de la Ley del Impuesto)";

     aPopup5  = "109-La devolucion de cantidades derivadas de la clausula suelo, ";
     aPopup5  = aPopup5 + "cuando tales cantidades hubieran tenido la consideracion ";
     aPopup5  = aPopup5 + "de gasto deducible (D.A. 45 de la Ley del Impuesto).";

     aPopup6  = "110-Haber perdido la condicion de contribuyente por cambio de ";
     aPopup6  = aPopup6 + "residencia, salvo en el supuesto siguiente (primer ";
     aPopup6  = aPopup6 + "parrafo del articulo 14.3 de la Ley del Impuesto)";

     aPopup7  = "111-El traslado de residencia a otro Estado miembro de la Union ";
     aPopup7  = aPopup7 + "Europea y el contribuyente opta por imputar las rentas ";
     aPopup7  = aPopup7 + "pendientes a medida que se obtengan (parrafo segundo ";
     aPopup7  = aPopup7 + "del articulo 14.3 de la Ley del Impuesto)";

     aPopup8  = "112-Perdida de la condicion de contribuyente por cambio de ";
     aPopup8  = aPopup8 + "residencia que genere ganancias patrimoniales (articulo ";
     aPopup8  = aPopup8 + "95 bis.2 de la Ley del Impuesto)";

     aPopup9  = "113-Perdida de la condicion de residente del socio al que le ";
     aPopup9  = aPopup9 + "haya sido de aplicacion el regimen especial de canje ";
     aPopup9  = aPopup9 + "de valores o el regimen especial de fusiones y escisiones ";

     aPopup10 = "114-No producir efecto el cambio de residencia a otra Comunidad ";
     aPopup10 = aPopup10 + "Aut¢noma (articulo 72.2 de la Ley del Impuesto)";

     aPopup11 = "115-Disposicion anticipada de derechos consolidados de sistemas ";
     aPopup11 = aPopup11 + "de prevision social (articulo 50 del Reglamento del ";
     aPopup11 = aPopup11 + "Impuesto)";

     aPopup12 = "116-Disposicion de bienes o derechos aportados a patrimonios ";
     aPopup12 = aPopup12 + "protegidos (articulo 54.5 de la Ley del Impuesto)";

     aPopup13 = "117-Incumplimiento de las condiciones para poder aplicar la exencion ";
     aPopup13 = aPopup13 + "por reinversion en vivienda habitual y entidades de nueva ";
     aPopup13 = aPopup13 + "o reciente creación (artículo 41.5 del Reglamento del Impuesto)";

     aPopup14 = "118-Incumplimiento de las condiciones para poder aplicar la exencion ";
     aPopup14 = aPopup14 + "por reinversion en rentas vitalicias o anticipacion, ";
     aPopup14 = aPopup14 + "total o parcial, de los derechos economicos derivados ";
     aPopup14 = aPopup14 + "de la renta vitalicia constituida";

     aPopup15 = "119-Incumplimiento del plazo de 3 a¤os de mantenimiento de las ";
     aPopup15 = aPopup15 + "acciones entregadas a los trabajadores (articulo 43.2 ";
     aPopup15 = aPopup15 + "del Reglamento del Impuesto)";

     aPopup16 = "120-Perdida de la exencion de la indemnizacion por despido o ";
     aPopup16 = aPopup16 + "cese (articulo 73.1 del Reglamento del Impuesto)";

     aPopup17 = "121-Adquisicion de elementos patrimoniales, valores o participaciones ";
     aPopup17 = aPopup17 + "homogeneos que impidan computar la perdida patrimonial ";
     aPopup17 = aPopup17 + "inicialmente consignada en la declaracion (articulo ";
     aPopup17 = aPopup17 + "73.2 del Reglamento del Impuesto).";

     aPopup18 = "122-Por supuestos distintos a los reflejados en las casillas anteriores";

     aPopup19 = "127-Si inicia un procedimiento de rectificacion de autoliquidacion, ";
     aPopup19 = aPopup19 + "por resultar una cantidad a devolver mayor a la solicitada, ";
     aPopup19 = aPopup19 + "o una cantidad a ingresar menor, (tambien si el resultado no varia).";

     |PARA;  |SI;  |HACIENDO;
          IaPopup  = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 103;

              |SAL;
              |PULSATECLA;
          |FINSI;
     |SIGUE;

     #rew01004#Campo# = aAlfa;
     |PINTA #rew01004#Campo#;

     |PULSATECLA;
|FPRC;

|PROCESO NoComple;  |TIPO 0;
     nCampo1 = Campo;
     nCampo2 = Campo + 1;
     nCampo3 = Campo + 2;
     nCampo4 = Campo + 3;
     nCampo5 = Campo + 4;
     nCampo6 = Campo + 5;
     nCampo7 = Campo + 6;
     nCampo8 = Campo + 7;

     |C_M #rew01004#Campo#, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

                                      nOk = 0;
     |SI #rew01004#nCampo1# = "107";  nOk = 1;  |FINSI;
     |SI #rew01004#nCampo1# = "108";  nOk = 1;  |FINSI;
     |SI #rew01004#nCampo1# = "109";  nOk = 1;  |FINSI;
     |SI #rew01004#nCampo1# = "110";  nOk = 1;  |FINSI;
     |SI #rew01004#nCampo1# = "111";  nOk = 1;  |FINSI;
     |SI #rew01004#nCampo1# = "112";  nOk = 1;  |FINSI;
     |SI #rew01004#nCampo1# = "113";  nOk = 1;  |FINSI;
     |SI #rew01004#nCampo1# = "114";  nOk = 1;  |FINSI;
     |SI #rew01004#nCampo1# = "115";  nOk = 1;  |FINSI;
     |SI #rew01004#nCampo1# = "116";  nOk = 1;  |FINSI;
     |SI #rew01004#nCampo1# = "117";  nOk = 1;  |FINSI;
     |SI #rew01004#nCampo1# = "118";  nOk = 1;  |FINSI;
     |SI #rew01004#nCampo1# = "119";  nOk = 1;  |FINSI;
     |SI #rew01004#nCampo1# = "120";  nOk = 1;  |FINSI;
     |SI #rew01004#nCampo1# = "121";  nOk = 1;  |FINSI;
     |SI #rew01004#nCampo1# = "122";  nOk = 1;  |FINSI;
     |SI #rew01004#nCampo1# = "127";  nOk = 1;  |FINSI;

     |SI nOk = 0;
         |MENAV "0000Tipo incorrecto. Consulte los diferentes tipos.";
         |ERROR;
         |ACABA;
     |FINSI;

     |SI #rew01004#nCampo1# = "127";
||         |MENAV "0000Se generan por RentaWeb";
||         |ERROR;
||         |ACABA;
     |FINSI;

     |SI #rew01004#nCampo1# = "107";
         |C_M #rew01004#nCampo4#, 1, "N";  #rew01004#nCampo4# = 0;    |PINTA #rew01004#nCampo4#;
         |C_M #rew01004#nCampo5#, 1, "N";  #rew01004#nCampo5# = 0;    |PINTA #rew01004#nCampo5#;
         |C_M #rew01004#nCampo6#, 1, "N";  #rew01004#nCampo6# = 0;    |PINTA #rew01004#nCampo6#;
         |C_M #rew01004#nCampo7#, 1, "N";  #rew01004#nCampo7# = "";   |PINTA #rew01004#nCampo7#;
         |C_M #rew01004#nCampo8#, 1, "N";  #rew01004#nCampo8# = "T";  |PINTA #rew01004#nCampo8#;

         |ACABA;
     |FINSI;

     |SI #rew01004#nCampo1# = "   ";
         |C_M #rew01004#nCampo1#, 1, "N";
         |C_M #rew01004#nCampo4#, 1, "N";
         |C_M #rew01004#nCampo5#, 1, "N";
         |C_M #rew01004#nCampo6#, 1, "N";
         |C_M #rew01004#nCampo7#, 1, "N";
         |C_M #rew01004#nCampo8#, 1, "N";
     |SINO;
         |C_M #rew01004#nCampo1#, 1, "S";
         |C_M #rew01004#nCampo4#, 1, "S";
         |C_M #rew01004#nCampo5#, 1, "S";
         |C_M #rew01004#nCampo7#, 1, "N";
         |C_M #rew01004#nCampo8#, 1, "N";

         |SI #rew01004#nCampo1# = "127";
             |C_M #rew01004#nCampo7#, 1, "S";
             |C_M #rew01004#nCampo8#, 1, "S";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Total1004;  |TIPO 7;
     |SI #rew01004#0 ! "   ";  |Y #rew01004#0 ! "107";
         #rew01004#1 = "100";
         #rew01004#5 = #rew01004#2 - #rew01004#3 + #rew01004#4;

         |PINTA #rew01004#1;
         |PINTA #rew01004#5;
     |FINSI;

     |SI #rew01004#8 ! "   ";  |Y #rew01004#8 ! "107";
         #rew01004#9  = "100";
         #rew01004#13 = #rew01004#10 - #rew01004#11 + #rew01004#12;

         |PINTA #rew01004#9;
         |PINTA #rew01004#13;
     |FINSI;

     |SI #rew01004#16 ! "   "; |Y #rew01004#16 ! "107";
         #rew01004#17 = "100";
         #rew01004#21 = #rew01004#18 - #rew01004#19 + #rew01004#20;

         |PINTA #rew01004#17;
         |PINTA #rew01004#21;
     |FINSI;

     |SI #rew01004#24 ! "   ";  |Y #rew01004#24 ! "107";
         #rew01004#25 = "100";
         #rew01004#29 = #rew01004#26 - #rew01004#27 + #rew01004#28;

         |PINTA #rew01004#25;
         |PINTA #rew01004#29;
     |FINSI;

     |SI #rew01004#32 ! "   ";  |Y #rew01004#32 ! "107";
         #rew01004#33 = "100";
         #rew01004#37 = #rew01004#34 - #rew01004#35 + #rew01004#36;

         |PINTA #rew01004#33;
         |PINTA #rew01004#37;
     |FINSI;

     |SI #rew01004#40 ! "   ";  |Y #rew01004#40 ! "107";
         #rew01004#41 = "100";
         #rew01004#45 = #rew01004#42 - #rew01004#43 + #rew01004#44;

         |PINTA #rew01004#41;
         |PINTA #rew01004#45;
     |FINSI;

     |SI #rew01004#48 ! "   ";  |Y #rew01004#48 ! "107";
         #rew01004#49 = "100";
         #rew01004#53 = #rew01004#50 - #rew01004#51 + #rew01004#52;

         |PINTA #rew01004#49;
         |PINTA #rew01004#53;
     |FINSI;

     |SI #rew01004#56 ! "   ";  |Y #rew01004#56 ! "107";
         #rew01004#57 = "100";
         #rew01004#61 = #rew01004#58 - #rew01004#59 + #rew01004#60;

         |PINTA #rew01004#57;
         |PINTA #rew01004#61;
     |FINSI;
|FPRC;

|PROCESO Menav;
     nCampo1 = Campo - 4;
     nCampo2 = Campo - 3;
     nCampo3 = Campo - 2;
     nCampo4 = Campo - 1;
     nCampo5 = Campo;
     nCampo6 = Campo + 1;
     nCampo7 = Campo + 2;
     nCampo8 = Campo + 3;

     |HAZ Total1004;

     |SI #rew01004#nCampo1# = "107";
         |SI #rew01004#nCampo3# > 0;
             |MENAV "0000 Para el tipo 107 la declaraci¢n debe ser negativa.";
             |POSICIONATE #rew01004#nCampo1#;
         |FINSI;
     |FINSI;

     |SI #rew01004#nCampo1# = "127";
         |C_M #rew01004#nCampo8#, 1, "S";
         |SI #rew01004#nCampo6# ] 0;
             |C_M #rew01004#nCampo8#, 1, "N";
         |FINSI;
     |FINSI;

     |SI #rew01004#nCampo1# ! "   ";  |Y #rew01004#nCampo1# ! "107";
                                      |Y #rew01004#nCampo1# ! "127";
         |SI #rew01004#nCampo6# [ 0;
             |MENAV "0000 Para una declaracion complementaria la Casilla 0680 / 0685 debe ser positiva.";
             |POSICIONATE #rew01004#nCampo1#;
         |FINSI;
     |FINSI;

     |SI #rew01004#nCampo1# = "127";
         |SI #rew01004#nCampo6# > 0;
             |MENAV "0000 Para una declaracion complementaria la Casilla 0680 / 0685 debe ser negativa.";
             |POSICIONATE #rew01004#nCampo1#;
         |FINSI;
     |FINSI;
|FPRC;
