|FICHEROS;
     rem00101 #101;
     rem00100 #100;
     rem01001 #1001;
     rem01002 #1002;
     rem01018 #1018;

     rew01003 #2003,MANTE;
|FIN;

|VARIABLES;
     nCampo       = 0;
     nCampo1      = 0;
     nCampo2      = 0;
     nCampo3      = 0;
     nCampo4      = 0;
     nCampo5      = 0;
     nCampo6      = 0;
     nCampo7      = 0;
     nCampo8      = 0;
     nDCampo      = 0;
     nHCampo      = 0;
     nComple      = 0;
     nError       = 0;
     nValor       = 0;
     nValor1      = 0;
     nValor2      = 0;

     aAlfa        = "";

     &enEmpresa   = 0;
     &enImporte   = 0;
     &enBloque    = 0;
     &eaCasilla   = "";
|FIN;

|PROCESO Tipo12Fw1003;  |TIPO 12;
|FPRC;

|PROCESO FormaPago1003;
|FPRC;

|PROCESO Individual;  |TIPO 7;
     |C_M #2003Campo, 1, "S";
     |SI #2003Campo = "I";
||         |C_M #2003Campo, 1, "N";
     |FINSI;
|FPRC;

|PROCESO rem00101T3;
     |SI #101#7 = "3";  |O #101#7 = "4";
         aAlfa = "0000 Declaracion CONJUNTA, lo que obliga al ";
         aAlfa = aAlfa + "otro progenitor de los hijos tipo 3 y 4 a no incluirlos en su renta";
         |MENAV aAlfa;
         |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE rem00101T3;
     #101#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     ;
     NULL, rem00101T3;
|FIN;

|PROCESO Lee1001;
     #1001#0 = enEmpresa;
     #1001#1 = 0;
     #1001#2 = aAlfa;
     |LEE 000#1001=;

     aAlfa = "";
     |SI FSalida = 0;
         aAlfa = "100";
     |FINSI;
|FPRC;

|PROCESO LeeImporte;
     enImporte  = 0;

     #1002#0 = #1001#0;
     #1002#1 = #1001#1;
     #1002#2 = #1001#2;
     #1002#3 = enBloque;
     #1002#4 = eaCasilla;
     |LEE 040#1002=;
     |SI FSalida = 0;
         enImporte  = #1002#6;
     |FINSI;
|FPRC;

|PROCESO LeeRdtos;
     |HAZ Lee1001;

     |ABRE #1002;
     |ABRE #1018;
     #1018#0 = #1001#0;
     #1018#1 = #1001#1;
     #1018#2 = #1001#2;
     |LEE 000#1018=;
     |SI FSalida ! 0;  |DDEFECTO #1018;  |FINSI;
     |CIERRA #1018;

                                                        nValor = 0;
     enBloque = 2;  eaCasilla = "035"; |HAZ LeeImporte; nValor = nValor + enImporte;
     enBloque = 3;  eaCasilla = "047"; |HAZ LeeImporte; nValor = nValor + enImporte;
     enBloque = 4;  eaCasilla = "080"; |HAZ LeeImporte; nValor = nValor + enImporte;
     enBloque = 8;  eaCasilla = "221"; |HAZ LeeImporte; nValor = nValor + enImporte;
     enBloque = 9;  eaCasilla = "245"; |HAZ LeeImporte; nValor = nValor + enImporte;
     enBloque = 10; eaCasilla = "255"; |HAZ LeeImporte; nValor = nValor + enImporte;
     enBloque = 11; eaCasilla = "265"; |HAZ LeeImporte; nValor = nValor + enImporte;
     enBloque = 12; eaCasilla = "275"; |HAZ LeeImporte; nValor = nValor + enImporte;
     enBloque = 21; eaCasilla = "440"; |HAZ LeeImporte; nValor = nValor + enImporte;
     enBloque = 21; eaCasilla = "441"; |HAZ LeeImporte; nValor = nValor - enImporte;
     enBloque = 22; eaCasilla = "443"; |HAZ LeeImporte; nValor = nValor + enImporte;
     enBloque = 22; eaCasilla = "444"; |HAZ LeeImporte; nValor = nValor - enImporte;

     nValor1   = #1018#19;
     nValor2   = #1018#28;
     |SI nValor1 ] nValor2;
         nValor    = nValor + nValor1;    || 075
     |SINO;
         nValor    = nValor + nValor2;    || 078
     |FINSI;

     nValor    = nValor + #1018#7;     || 131
     nValor    = nValor + #1018#11;    || 164
     nValor    = nValor + #1018#13;    || 192
     nValor    = nValor + #1018#8;     || 203-209-212

     |CIERRA #1002;

     nError = 0;
     |SI nValor > 1800;
         nError = 1;

         #2003#13 = "";
         #2003#22 = "";
         #2003#31 = "";
         #2003#40 = "";
         #2003#49 = "";
         #2003#58 = "";

         |C_M #2003#3, 1, "S";
         #2003#3 = "C";  |PINTA #2003#3;
     |FINSI;
|FPRC;

|PROCESO Modifica1003;
    |PARA nCampo = 4;  |SI nCampo [ 66;  |HACIENDO nCampo = nCampo + 1;
          |C_M #2003nCampo, 1, "N";
    |SIGUE;

    |SI #2003#3 = "C";
         #2003#4 = "100";

         |C_M #2003#4,  1, "S";
         |C_M #2003#6,  1, "S";
         |C_M #2003#7,  1, "S";
         |C_M #2003#10, 1, "S";
         |C_M #2003#11, 1, "S";
         |C_M #2003#12, 1, "S";

         |SI #2003#5 [ 0;
             |SI #2003#10 = "N";  #2003#11 = "S";  |FINSI;

             #2003#6  = "N";
             #2003#7  = "N";
         |SINO;
             #2003#6  = "S";
             #2003#7  = "S";
             #2003#11 = "N";
         |FINSI;

         #2003#13 = "";  #2003#15 = "N";   #2003#16 = "N";  #2003#19 = "N";  #2003#20 = "N";
         #2003#22 = "";  #2003#24 = "N";   #2003#25 = "N";  #2003#28 = "N";  #2003#29 = "N";
         #2003#31 = "";  #2003#33 = "N";   #2003#34 = "N";  #2003#37 = "N";  #2003#38 = "N";
         #2003#40 = "";  #2003#42 = "N";   #2003#43 = "N";  #2003#46 = "N";  #2003#47 = "N";
         #2003#49 = "";  #2003#51 = "N";   #2003#52 = "N";  #2003#55 = "N";  #2003#56 = "N";
         #2003#58 = "";  #2003#60 = "N";   #2003#61 = "N";  #2003#64 = "N";  #2003#65 = "N";

         |BUCLE rem00101T3;
     |SINO;
         #2003#13 = "";
         #2003#22 = "";
         #2003#31 = "";
         #2003#40 = "";
         #2003#49 = "";
         #2003#58 = "";

         aAlfa = "TITULAR";     |HAZ Lee1001;  #2003#13 = aAlfa;
         aAlfa = "CONYUGE";     |HAZ Lee1001;  #2003#22 = aAlfa;
         aAlfa = "1 FAMILIAR";  |HAZ Lee1001;  #2003#31 = aAlfa;
         aAlfa = "2 FAMILIAR";  |HAZ Lee1001;  #2003#40 = aAlfa;
         aAlfa = "3 FAMILIAR";  |HAZ Lee1001;  #2003#49 = aAlfa;
         aAlfa = "4 FAMILIAR";  |HAZ Lee1001;  #2003#58 = aAlfa;

         |SI #2003#31 ! "   ";
              aAlfa = "1 FAMILIAR";
              |HAZ LeeRdtos;
              |SI nError = 1;
                  |MENAV "00001 FAMILIAR con rentas superiores a 1.800 euros, solo es posible imprimir renta conjunta";

                  |ERROR;
                  |ACABA;
              |FINSI;
         |FINSI;

         |SI #2003#40 ! "   ";
              aAlfa = "2 FAMILIAR";
              |HAZ LeeRdtos;
              |SI nError = 1;
                  |MENAV "00002 FAMILIAR con rentas superiores a 1.800 euros, solo es posible imprimir renta conjunta";

                  |ERROR;
                  |ACABA;
              |FINSI;
         |FINSI;

         |SI #2003#49 ! "   ";
              aAlfa = "3 FAMILIAR";
              |HAZ LeeRdtos;
              |SI nError = 1;
                  |MENAV "00003 FAMILIAR con rentas superiores a 1.800 euros, solo es posible imprimir renta conjunta";

                  |ERROR;
                  |ACABA;
              |FINSI;
         |FINSI;

         |SI #2003#58 ! "   ";
              aAlfa = "4 FAMILIAR";
              |HAZ LeeRdtos;
              |SI nError = 1;
                  |MENAV "000034FAMILIAR con rentas superiores a 1.800 euros, solo es posible imprimir renta conjunta";

                  |ERROR;
                  |ACABA;
              |FINSI;
         |FINSI;

         |SI #2003#13 ! "   ";
             |C_M #2003#13, 1, "S";
             |C_M #2003#15, 1, "S";
             |C_M #2003#16, 1, "S";
             |C_M #2003#19, 1, "S";
             |C_M #2003#20, 1, "S";
             |C_M #2003#21, 1, "S";

             |SI #2003#14 [ 0;
                 |SI #2003#19 = "N";  #2003#20 = "S";  |FINSI;

                 #2003#15 = "N";
                 #2003#16 = "N";
             |SINO;
                 #2003#15 = "S";
                 #2003#16 = "S";
                 #2003#20 = "N";
             |FINSI;
         |FINSI;

         |SI #2003#22 ! "   ";
             |C_M #2003#22, 1, "S";
             |C_M #2003#24, 1, "S";
             |C_M #2003#25, 1, "S";
             |C_M #2003#28, 1, "S";
             |C_M #2003#29, 1, "S";
             |C_M #2003#30, 1, "S";

             |SI #2003#23 [ 0;
                 |SI #2003#28 = "N";  #2003#29 = "S";  |FINSI;
                 #2003#24 = "N";
                 #2003#25 = "N";
             |SINO;
                 #2003#24 = "S";
                 #2003#25 = "S";
                 #2003#29 = "N";
             |FINSI;
         |FINSI;

         |SI #2003#31 ! "   ";
             |C_M #2003#31, 1, "S";
             |C_M #2003#33, 1, "S";
             |C_M #2003#34, 1, "S";
             |C_M #2003#37, 1, "S";
             |C_M #2003#38, 1, "S";
             |C_M #2003#39, 1, "S";

             |SI #2003#32 [ 0;
                 |SI #2003#37 = "N";  #2003#38 = "S";  |FINSI;
                 #2003#33 = "N";
                 #2003#34 = "N";
             |SINO;
                 #2003#33 = "S";
                 #2003#34 = "S";
                 #2003#38 = "N";
             |FINSI;
         |FINSI;

         |SI #2003#40 ! "   ";
             |C_M #2003#40, 1, "S";
             |C_M #2003#42, 1, "S";
             |C_M #2003#43, 1, "S";
             |C_M #2003#46, 1, "S";
             |C_M #2003#47, 1, "S";
             |C_M #2003#48, 1, "S";

             |SI #2003#41 [ 0;
                 |SI #2003#46 = "N";  #2003#47 = "S";  |FINSI;
                 #2003#42 = "N";
                 #2003#43 = "N";
             |SINO;
                 #2003#42 = "S";
                 #2003#43 = "S";
                 #2003#47 = "N";
             |FINSI;
         |FINSI;


         |SI #2003#49 ! "   ";
             |C_M #2003#49, 1, "S";
             |C_M #2003#51, 1, "S";
             |C_M #2003#52, 1, "S";
             |C_M #2003#55, 1, "S";
             |C_M #2003#56, 1, "S";
             |C_M #2003#57, 1, "S";

             |SI #2003#50 [ 0;
                 |SI #2003#55 = "N";  #2003#56 = "S";  |FINSI;
                 #2003#51 = "N";
                 #2003#52 = "N";
             |SINO;
                 #2003#51 = "S";
                 #2003#52 = "S";
                 #2003#56 = "N";
             |FINSI;
         |FINSI;

         |SI #2003#58 ! "   ";
             |C_M #2003#58, 1, "S";
             |C_M #2003#60, 1, "S";
             |C_M #2003#61, 1, "S";
             |C_M #2003#64, 1, "S";
             |C_M #2003#65, 1, "S";
             |C_M #2003#66, 1, "S";

             |SI #2003#59 [ 0;
                 |SI #2003#64 = "N";  #2003#65 = "S";  |FINSI;
                 #2003#60 = "N";
                 #2003#61 = "N";
             |SINO;
                 #2003#60 = "S";
                 #2003#61 = "S";
                 #2003#65 = "N";
             |FINSI;
         |FINSI;

         |C_M #2003#4,  1, "N";
         |C_M #2003#6,  1, "N";
         |C_M #2003#7,  1, "N";
         |C_M #2003#10, 1, "N";
         |C_M #2003#11, 1, "N";
         |C_M #2003#12, 1, "N";

         #2003#4  = "";  #2003#6  = "N";   #2003#7  = "N";  #2003#10 = "N";  #2003#11 = "N";
     |FINSI;

     Campo = 6;   |HAZ Calcula102;  Campo = 3;
     Campo = 15;  |HAZ Calcula102;  Campo = 3;
     Campo = 24;  |HAZ Calcula102;  Campo = 3;
     Campo = 33;  |HAZ Calcula102;  Campo = 3;
     Campo = 42;  |HAZ Calcula102;  Campo = 3;
     Campo = 51;  |HAZ Calcula102;  Campo = 3;
     Campo = 60;  |HAZ Calcula102;  Campo = 3;

     |PINDA #0#2003;
|FPRC;

|PROCESO ControlaModelo;
     |SI #2003Campo = "   ";  |ACABA;  |FINSI;

     nComple = 0;
     |ABRE #100;
     #100#0 = enEmpresa;
     |LEE 040#100=;
     |SI FSalida = 0;  |Y #100#97 ! "N";
         nComple = 1;
     |FINSI;
     |CIERRA #100;

     nCampo1 = Campo + 1;
     nCampo2 = Campo + 2;
     nCampo3 = Campo + 3;
     nCampo4 = Campo + 4;
     nCampo5 = Campo + 5;
     nCampo6 = Campo + 6;
     nCampo7 = Campo + 7;
     nCampo8 = Campo + 8;

     |C_M #2003nCampo2, 1, "S";
     |C_M #2003nCampo3, 1, "S";
     |C_M #2003nCampo6, 1, "S";
     |C_M #2003nCampo7, 1, "S";
     |C_M #2003nCampo8, 1, "S";
     |SI #2003nCampo1 [ 0;
         |C_M #2003nCampo2, 1, "N";  #2003nCampo2 = "N";
         |C_M #2003nCampo3, 1, "N";  #2003nCampo3 = "N";
                                     #2003nCampo4 = 0;
                                     #2003nCampo5 = 0;

         |SI nComple = 0;
             |C_M #2003nCampo8, 1, "N";  #2003nCampo8 = "N";
         |FINSI;
     |SINO;
         |C_M #2003nCampo6, 1, "N";  #2003nCampo6 = "N";
         |C_M #2003nCampo7, 1, "N";  #2003nCampo7 = "N";
     |FINSI;
|FPRC;

|PROCESO Calcula102;
     nCampo1 = Campo - 1;
     nCampo2 = Campo + 2;
     nCampo3 = Campo + 3;
     nCampo4 = Campo + 1;
     |SI #2003Campo = "S";
         #2003nCampo2 = #2003nCampo1 % 60;  |PINTA #2003nCampo2;
         #2003nCampo3 = #2003nCampo1 % 40;  |PINTA #2003nCampo3;
         |C_M #2003nCampo4, 1, "S";
     |SINO;
         #2003nCampo2 = 0;  |PINTA #2003nCampo2;
         #2003nCampo3 = 0;  |PINTA #2003nCampo3;
         |C_M #2003nCampo4, 1, "N"; #2003nCampo4 = "N";  |PINTA #2003nCampo4;
     |FINSI;
|FPRC;

|PROCESO Transferencia;  |TIPO 7;
     nCampo1 = Campo - 6;
     nCampo2 = Campo - 1;
     #2003Campo = "N";
     |SI #2003nCampo2 = "N";  |Y #2003nCampo1 < 0;
         #2003Campo = "S";
     |FINSI;
     |PINTA #2003Campo;
|FPRC;

|PROCESO Tipo12w6;  |TIPO 12;
|FPRC;
