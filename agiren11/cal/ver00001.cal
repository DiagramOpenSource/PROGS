|FICHEROS;
     ver00001;
     retabla1;
     retabla2;
     retabla3;
     rem00500;
     rem00008;
     rem00099;

     defrent@;
|FIN;

|VARIABLES;
     aDef         = "";
     aMas         = "";
     aBase        = "";
     aPerceptor   = "";
     aAlfa        = "";
     aAlfa1       = "";
     aAlfa2       = "";

     nSwHay       = 0;
     nLimite      = 0;
     nPorce       = 0;
     nCanti1      = 0;
     nCanti2      = 0;
     nCanti3      = 0;
     nCanti4      = 0;
     nDias        = 0;
     nValor       = 0;
     nRecalculo   = 0;

     &enError     = 0;
     &eaRenta     = "";
|FIN;

|| ************************************************************************
|| PROCESOS DE CAMBIO DE VERSION
|| ************************************************************************

|PROCESO MiraSiEsta;
     aMas = aBase + aDef + ".mas";
     |CARGA_DEF aMas, defrent@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #defrent@;
     #defrent@#0 = #rem00099#0;
     #defrent@#1 = #rem00099#5;
     |LEE 000#defrent@.=;
     |SI FSalida = 0;
         aPerceptor = #defrent@#2;
     |FINSI;
     |CIERRA #defrent@;

     |DESCARGA_DEF #defrent@;

     |QBF aPerceptor;
|FPRC;

|PROCESO rem00099;
     aPerceptor = "";

     |SI  #rem00099#4 = "B1";  aDef = "rem00021";  |HAZ MiraSiEsta;  |FINSI;
     |SI  #rem00099#4 = "C0";  aDef = "rem00022";  |HAZ MiraSiEsta;  |FINSI;
     |SI  #rem00099#4 = "C1";  aDef = "rem00023";  |HAZ MiraSiEsta;  |FINSI;
     |SI  #rem00099#4 = "C2";  aDef = "rem00024";  |HAZ MiraSiEsta;  |FINSI;
     |SI  #rem00099#4 = "C3";  aDef = "rem00051";  |HAZ MiraSiEsta;  |FINSI;
     |SI  #rem00099#4 = "C4";  aDef = "rem00052";  |HAZ MiraSiEsta;  |FINSI;
     |SI  #rem00099#4 = "C5";  aDef = "rem00055";  |HAZ MiraSiEsta;  |FINSI;
     |SI  #rem00099#4 = "D0";  aDef = "rem00025";  |HAZ MiraSiEsta;  |FINSI;
     |SI  #rem00099#4 = "D1";  aDef = "rem00026";  |HAZ MiraSiEsta;  |FINSI;
     |SI  #rem00099#4 = "D3";  aDef = "rem00027";  |HAZ MiraSiEsta;  |FINSI;
     |SI  #rem00099#4 = "D4";  aDef = "rem00028";  |HAZ MiraSiEsta;  |FINSI;

     |SI aPerceptor = "";
         aPerceptor = "TITULAR":
     |FINSI;

     #rem00099#3 = aPerceptor;
     |GRABA 020#rem00099.a;
     |LIBERA #rem00099;
|FPRC;

|DEFBUCLE rem00099;
     #rem00099#4;
     ;
     "          ";
     "          ";
     be;
     NULL, rem00099;
|FIN;

|PROCESO MiraPatrones;
     nSwHay     = 0;

     |ABRE #retabla1;
     |LEE 040#retabla1.p;
     |SI FSalida ! 0;
         |CIERRA #retabla1;  |DELINDEX #retabla1;
         nSwHay = 1;
     |SINO;
         |CIERRA #retabla1;
     |FINSI;

     |ABRE #rem00500;
     #rem00500#0 = 5;
     |LEE 000#rem00500.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00500;  |FINSI;
     |CIERRA #rem00500;

     |SI #rem00500#5 ! 0.16;
         |DELINDEX #rem00500;
         nSwHay      = 1;
     |FINSI;

     |ABRE #retabla3;
     #retabla3#0 = 1;
     |LEE 040#retabla3.=;
     |SI FSalida ! 0;
                           |CIERRA #retabla3;  |DELINDEX #retabla3;
         |ABRE #rem00500;  |CIERRA #rem00500;  |DELINDEX #rem00500;
         |ABRE #rem00008;  |CIERRA #rem00008;  |DELINDEX #rem00008;

         nSwHay      = 1;
     |SINO;
         |CIERRA #retabla3;
     |FINSI;

     |SI nSwHay = 1;
         |MENAV "0000 Han cambiado o no se han instalado los ficheros patrones, por favor instalelos.";
         |SUB_EJECUTA_NP "rez00001";
     |FINSI;

     |SI nSwHay = 2;
         |SUB_EJECUTA_NP "rez00001;AUTOMATICO";
     |FINSI;

     |ABRE #retabla1;
     |LEE 040#retabla1.p;
     |SI FSalida ! 0;
         enError = 1;
         |CIERRA #retabla1;  |DELINDEX #retabla1;
     |SINO;
         |CIERRA #retabla1;
     |FINSI;

     |ABRE #rem00500;
     #rem00500#0 = 5;
     |LEE 000#rem00500.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00500;  |FINSI;
     |CIERRA #rem00500;

     |SI #rem00500#5 ! 0.16;
         |DELINDEX #rem00500;
         enError = 1;
     |FINSI;

     |ABRE #retabla3;
     #retabla3#0 = 1;
     |LEE 040#retabla3.=;
     |SI FSalida ! 0;
         enError = 1;
                           |CIERRA #retabla3;  |DELINDEX #retabla3;
         |ABRE #rem00500;  |CIERRA #rem00500;  |DELINDEX #rem00500;
         |ABRE #rem00008;  |CIERRA #rem00008;  |DELINDEX #rem00008;
     |SINO;
         |CIERRA #retabla3;
     |FINSI;
|FPRC;

|PROGRAMA;
     |MENSA "0000Comprobando configuracion patrones.";
     enError = 0;
     |HAZ MiraPatrones;

     |DDEF aBase;
     |ABRET #rem00099;
     |SELECT #4#rem00099;
     #rem00099#3 = "";
     |LEE 000#rem00099.=;
     |SI FSalida = 0;
         |BUCLE rem00099;
     |FINSI;
     |CIERRAT #rem00099;
|FPRO;
