|FICHEROS;
      rew99999 #999;
      rem00019 #19;

     &refere1@ #1001;
     &refere2@ #1002;
     &referr3@ #1003;

      datfic0@ #0;
      datfic1@ #1;
      datfic2@ #2;
      datfic3@ #3;
      datfic4@ #4;
      datfic5@ #5;

      retabla1 #401;
      retabla2 #402;
      rem00008 #408;
|FIN;

|VARIABLES;
|FIN;

|INCLUYE i_varcal;

|PROCESO CalculaH;
     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1033"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |GRABA 020#0b;
     |FINSI;

     enBloque = 23; eaCasilla = "451"; |HAZ SacaImporte; #0#40 = enImporte;

     #0#39  = #0#33;
     |SI #0#39 > 0;
         |SI #0#40 > #0#39;
             #0#42 = (N\ #0#40 - #0#39);
             #0#40 = #0#39;
         |FINSI;
     |SINO;
         #0#42 = (N\ #0#40);
         #0#40 = 0;
     |FINSI;

     #0#41    = 0;
     enBloque = 1;  eaCasilla = "021"; |HAZ SacaImporte; #0#41 = (N\ #0#41 + enImporte);
     enBloque = 3;  eaCasilla = "050"; |HAZ SacaImporte; #0#41 = (N\ #0#41 + enImporte);
     enBloque = 4;  eaCasilla = "080"; |HAZ SacaImporte; #0#41 = (N\ #0#41 + enImporte);
     enBloque = 4;  eaCasilla = "085"; |HAZ SacaImporte; #0#41 = (N\ #0#41 + enImporte);
     enBloque = 5;  eaCasilla = "140"; |HAZ SacaImporte; #0#41 = (N\ #0#41 + enImporte);
     enBloque = 6;  eaCasilla = "170"; |HAZ SacaImporte; #0#41 = (N\ #0#41 + enImporte);
     enBloque = 7;  eaCasilla = "197"; |HAZ SacaImporte; #0#41 = (N\ #0#41 + enImporte);
     enBloque = 8;  eaCasilla = "220"; |HAZ SacaImporte; #0#41 = (N\ #0#41 + enImporte);
     enBloque = 8;  eaCasilla = "222"; |HAZ SacaImporte; #0#41 = (N\ #0#41 + enImporte);
     enBloque = 8;  eaCasilla = "223"; |HAZ SacaImporte; #0#41 = (N\ #0#41 + enImporte);
     enBloque = 9;  eaCasilla = "245"; |HAZ SacaImporte; #0#41 = (N\ #0#41 + enImporte);
     enBloque = 10; eaCasilla = "255"; |HAZ SacaImporte; #0#41 = (N\ #0#41 + enImporte);
     enBloque = 11; eaCasilla = "265"; |HAZ SacaImporte; #0#41 = (N\ #0#41 + enImporte);
     enBloque = 12; eaCasilla = "275"; |HAZ SacaImporte; #0#41 = (N\ #0#41 + enImporte);

     #0#43 = #0#34;
     |SI #0#41 > 0;
         nSuma  = #0#42 + #0#43;
         nValor = #0#41 % 25;
         |SI nSuma > nValor;
             nResta = nValor;
             |SI #0#42 ! 0;
                 |SI nResta ! 0;
                     |SI #0#42 ] nResta;
                         #0#42  = nResta;
                         nResta = 0;
                     |SINO;
                        nResta = nResta - #0#42;
                     |FINSI;
                  |SINO;
                     #0#42  = 0;
                  |FINSI;
             |FINSI;

             |SI #0#43 ! 0;
                 |SI nResta ! 0;
                     |SI #0#43 ] nResta;
                         #0#43 = nResta;
                         nResta = 0;
                     |SINO;
                         nResta = nResta - #0#43;
                     |FINSI;
                 |SINO;
                     #0#43 = 0;
                 |FINSI;
             |FINSI;
         |FINSI;

         nSuma  = #0#42 + #0#43;
         |SI nSuma > #0#41;
             nResta = #0#41;
             |SI #0#43 ! 0;
                 |SI nResta ! 0;
                     |SI #0#43 ] nResta;
                         #0#43  = nResta;
                         nResta = 0;
                     |SINO;
                         nResta = nResta - #0#43;
                     |FINSI;
                 |SINO;
                     #0#43 = 0;
                 |FINSI;
             |FINSI;

             |SI #0#42 ! 0;
                 |SI nResta ! 0;
                     |SI #0#42 ] nResta;
                         #0#42  = nResta;
                         nResta = 0;
                     |SINO;
                         nResta = nResta - #0#42;
                     |FINSI;
                 |SINO;
                     #0#42 = 0;
                 |FINSI;
             |FINSI;
         |FINSI;

         #0#45 = #0#34 - #0#43;
     |SINO;
         #0#42 = 0;
         #0#43 = 0;
     |FINSI;

     #0#44  = (N\ #0#39 - #0#40 + #0#41 - #0#42 - #0#43);

     enBloque = 24; eaCasilla = "458"; |HAZ SacaImporte; #0#47 = enImporte;

     #0#46  = #0#37;

     |SI #0#47 > #0#46;  |Y #0#46 ] 0;
         #0#47 = #0#46;
     |FINSI;

     nSuma = 0;

     enBloque = 2;  eaCasilla = "035"; |HAZ SacaImporte; nSuma = nSuma + enImporte;
     enBloque = 8;  eaCasilla = "221"; |HAZ SacaImporte; nSuma = nSuma + enImporte;

     |SI nSuma > 0;
         #0#49 = nSuma;
     |FINSI;

     |SI #0#111 > #0#49;
         #0#111 = #0#49;
     |FINSI;

     |SI nSuma < 0;
         #0#48 = -nSuma;
     |FINSI;

     #0#50  = (N\ #0#46 - #0#47 + #0#49 - #0#111);

     enSwAcum  = 0;
     enBloque  = 23;

     eaCasilla = "450";  enImporte = #0#39;  |HAZ GrabaLineal;
     eaCasilla = "451";  enImporte = #0#40;  |HAZ GrabaLineal;
     eaCasilla = "452";  enImporte = #0#41;  |HAZ GrabaLineal;
     eaCasilla = "453";  enImporte = #0#42;  |HAZ GrabaLineal;
     eaCasilla = "454";  enImporte = #0#43;  |HAZ GrabaLineal;
     eaCasilla = "455";  enImporte = #0#44;  |HAZ GrabaLineal;
     eaCasilla = "456";  enImporte = #0#45;  |HAZ GrabaLineal;

     enBloque  = 24;

     eaCasilla = "457";  enImporte = #0#46;  |HAZ GrabaLineal;
     eaCasilla = "458";  enImporte = #0#47;  |HAZ GrabaLineal;
     eaCasilla = "459";  enImporte = #0#48;  |HAZ GrabaLineal;
     eaCasilla = "460";  enImporte = #0#49;  |HAZ GrabaLineal;
     eaCasilla = "461";  enImporte = #0#111; |HAZ GrabaLineal;
     eaCasilla = "465";  enImporte = #0#50;  |HAZ GrabaLineal;

     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;

     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO Trabajo;
     aDef    = eaPathDef + "rem01010.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1010"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |DESCARGA_DEF #datfic1@;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1033"#;  |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, datfic3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |DESCARGA_DEF #datfic2@;
         |DESCARGA_DEF #datfic1@;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic3@#"zdat1018"#;  |FINSI;

     |ABRE #999;
     |SELECT #2#999;
     #999#1 = #1001#2;
     |LEE 040#999=;
     |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;
     |CIERRA #999;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 040#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         #1#0 = #1001#0;
         #1#1 = #1001#1;
         #1#2 = #1001#2;
         |GRABA 020#1b;
     |FINSI;

     |ABRE #2;
     #2#0 = #1001#0;
     #2#1 = #1001#1;
     #2#2 = #1001#2;
     |LEE 000#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     |ABRE #3;
     #3#0 = #1001#0;
     #3#1 = #1001#1;
     #3#2 = #1001#2;
     |LEE 000#3=;
     |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;
     |CIERRA #3;

     nValor = 0;
     enBloque = 2;  eaCasilla = "035"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 3;  eaCasilla = "047"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 4;  eaCasilla = "080"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 8;  eaCasilla = "221"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 9;  eaCasilla = "245"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 10; eaCasilla = "255"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 11; eaCasilla = "265"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 12; eaCasilla = "275"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 21; eaCasilla = "440"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 21; eaCasilla = "441"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 22; eaCasilla = "443"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 22; eaCasilla = "444"; |HAZ SacaImporte; nValor = nValor - enImporte;

     nValor1   = #3#19;
     nValor2   = #3#28;
     |SI nValor1 ] nValor2;
         nValor    = nValor + nValor1;    || 075
     |SINO;
         nValor    = nValor + nValor2;    || 078
     |FINSI;

     nValor    = nValor + #3#7;     || 131
     nValor    = nValor + #3#11;    || 164
     nValor    = nValor + #3#13;    || 192
     nValor    = nValor + #3#8;     || 203-209-212

     |SI enConta = 1;  nRentas1 = nValor + #1#15;  nRdtosTrab1 = #1#15;  nActivo1 = #1#20;  |FINSI;
     |SI enConta = 2;  nRentas2 = nValor + #1#15;  nRdtosTrab2 = #1#15;  nActivo2 = #1#20;  |FINSI;
     |SI enConta = 3;  nRentas3 = nValor + #1#15;  nRdtosTrab3 = #1#15;  nActivo3 = #1#20;  |FINSI;
     |SI enConta = 4;  nRentas4 = nValor + #1#15;  nRdtosTrab4 = #1#15;  nActivo4 = #1#20;  |FINSI;
     |SI enConta = 5;  nRentas5 = nValor + #1#15;  nRdtosTrab5 = #1#15;  nActivo5 = #1#20;  |FINSI;
     |SI enConta = 6;  nRentas6 = nValor + #1#15;  nRdtosTrab6 = #1#15;  nActivo6 = #1#20;  |FINSI;
     |SI enConta > 6;                              nRdtosTrab7 = #1#15;                     |FINSI;

     nRdto = 0;
     |SI #1#15 > 0;
         |SI #1#15 > #401#4; |O nValor > #401#5;
             nRdto = #401#6;
         |SINO;
             |SI #1#15 [ #401#7;
                 nRdto = #401#8;
             |SINO;
                 nRdto = (N\ #401#8 - (0.35 * (#1#15 - #401#7)));
            |FINSI;
         |FINSI;
     |FINSI;

     nCam25   = nRdto;

     |SI #3#26 = "S";
         enImporte = #3#18;
         nRdto     = 0;
         |SI enImporte > 0;
             |SI enImporte [ #401#8;
                 nRdto = #401#8;
             |SINO;
                |SI enImporte > #401#7;  |Y enImporte [ #401#4;
                    nRdto = (N\ #401#8 - (0.35 * (enImporte - #401#7)));
                |SINO;
                    nRdto = #401#6;
                 |FINSI;
             |FINSI;

             |SI #999#3 ! 0;
                 |SI #999#3 ] 65;  |O #999#4 = "S";
                     nRdto = nRdto + 7242;
                 |SINO;
                     nRdto = nRdto + 3264;
                 |FINSI;
             |FINSI;

             |SI nRdto > #3#18;  nRdto = #3#18;  |FINSI;
         |FINSI;

         enSwAcum  = 0;
         enBloque  = 5;
         eaCasilla = "137";
         enImporte = nRdto;
         |HAZ GrabaLineal;

         enBloque = 5;  eaCasilla = "136"; |HAZ SacaImporte; nValor = enImporte;
         enBloque = 5;  eaCasilla = "137"; |HAZ SacaImporte; nValor = nValor - enImporte;
         enBloque = 5;  eaCasilla = "138"; |HAZ SacaImporte; nValor = nValor - enImporte;

         enBloque = 5;  eaCasilla = "136"; |HAZ SacaImporte;
         |SI enImporte ] 0;
             |SI nValor < 0;  nValor = 0;   |FINSI;
         |FINSI;

         enSwAcum  = 0;
         enBloque  = 5;
         eaCasilla = "140";
         enImporte = nValor;
         |HAZ GrabaLineal;
     |FINSI;

     nCam26   = 0;
     nCam27   = 0;
     nImporte = 0;

     |ABRE #19;

     |SI enConta = 1;
         nRedTrab1 = nRdto;

         #19#0     = #1#0;
         #19#1     = "TITULAR";
         |LEE 000#19=;
         |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;

         aProlon1  = #19#2;
         aMovili1  = #19#3;
         nEjerMo1  = #19#4;
         nImporte  = 0;

         |SI #19#2 = "S";                    nCam26 = nRedTrab1;  |FINSI;
         |SI #19#3 = "S";  |Y #19#4 ] 2005;  nCam27 = nRedTrab1;  |FINSI;

         |SI #999#3 ] 33;  |Y #999#3 < 65;
            |Y nRdtosTrab1 ! 0;  |Y nActivo1 ! 0;
               |SI #999#4 = "N";
                   nImporte = nImporte + #401#20;
               |SINO;
                   nImporte = nImporte + #401#21;
               |FINSI;
         |FINSI;

         |SI #999#3 ] 65; |Y nRdtosTrab1 ! 0;  |Y nActivo1 ! 0;
             nImporte = nImporte + #401#21;
         |FINSI;

         |SI nCam28 < nImporte; nCam28 = nImporte;  |FINSI;
     |FINSI;

     |SI enConta = 2;
         nRedTrab2 = nRdto;

         #19#0     = #1#0;
         #19#1     = "CONYUGE";
         |LEE 000#19=;
         |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;

         aProlon2 = #19#2;
         aMovili2 = #19#3;
         nEjerMo2 = #19#4;

         |SI #19#2 = "S";                    nCam26 = nRedTrab2;  |FINSI;
         |SI #19#3 = "S";  |Y #19#4 ] 2005;  nCam27 = nRedTrab2;  |FINSI;

         |SI #999#3 ] 33;  |Y #999#3 < 65;
            |Y nRdtosTrab2 ! 0;  |Y nActivo2 ! 0;
               |SI #999#4 = "N";
                   nImporte = nImporte + #401#20;
               |SINO;
                   nImporte = nImporte + #401#21;
               |FINSI;
         |FINSI;

         |SI #999#3 ] 65; |Y nRdtosTrab2 ! 0;  |Y nActivo2 ! 0;
             nImporte = nImporte + #401#21;
         |FINSI;

         |SI nCam28 < nImporte;  nCam28 = nImporte;  |FINSI;
     |FINSI;

     |SI enConta = 3;
         nRedTrab3 = nRdto;

         #19#0     = #1#0;
         #19#1     = "1 FAMILIAR";
         |LEE 000#19=;
         |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;

         aMovili3 = #19#3;
         nEjerMo3 = #19#4;

         |SI #19#3 = "S";  |Y #19#4 ] 2005;  nCam27 = nRedTrab3;  |FINSI;

         |SI #999#3 ] 33;  |Y #999#3 < 65;
            |Y nRdtosTrab3 ! 0;  |Y nActivo3 ! 0;
               |SI #999#4 = "N";
                   nImporte = nImporte + #401#20;
               |SINO;
                   nImporte = nImporte + #401#21;
               |FINSI;
         |FINSI;

         |SI #999#3 ] 65; |Y nRdtosTrab3 ! 0;  |Y nActivo3 ! 0;
             nImporte = nImporte + #401#21;
         |FINSI;

         |SI nCam28 < nImporte;  nCam28 = nImporte;  |FINSI;
     |FINSI;

     |SI enConta = 4;
         nRedTrab4 = nRdto;

         #19#0     = #1#0;
         #19#1     = "2 FAMILIAR";
         |LEE 000#19=;
         |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;

         aMovili4 = #19#3;
         nEjerMo4 = #19#4;

         |SI #19#3 = "S";  |Y #19#4 ] 2005;  nCam27 = nRedTrab4;  |FINSI;

         |SI #999#3 ] 33;  |Y #999#3 < 65;
            |Y nRdtosTrab4 ! 0;  |Y nActivo4 ! 0;
               |SI #999#4 = "N";
                   nImporte = nImporte + #401#20;
               |SINO;
                   nImporte = nImporte + #401#21;
               |FINSI;
         |FINSI;

         |SI #999#3 ] 65; |Y nRdtosTrab4 ! 0;  |Y nActivo4 ! 0;
             nImporte = nImporte + #401#21;
         |FINSI;

         |SI nCam28 < nImporte;  nCam28 = nImporte;  |FINSI;
     |FINSI;

     |SI enConta = 5;
         nRedTrab5 = nRdto;

         #19#0     = #1#0;
         #19#1     = "3 FAMILIAR";
         |LEE 000#19=;
         |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;

         aMovili5 = #19#3;
         nEjerMo5 = #19#4;

         |SI #19#3 = "S";  |Y #19#4 ] 2005;  nCam27 = nRedTrab5;  |FINSI;

         |SI #999#3 ] 33;  |Y #999#3 < 65;
            |Y nRdtosTrab5 ! 0;  |Y nActivo5 ! 0;
               |SI #999#4 = "N";
                   nImporte = nImporte + #401#20;
               |SINO;
                   nImporte = nImporte + #401#21;
               |FINSI;
         |FINSI;

         |SI #999#3 ] 65; |Y nRdtosTrab5 ! 0;  |Y nActivo5 ! 0;
             nImporte = nImporte + #401#21;
         |FINSI;

         |SI nCam28 < nImporte;  nCam28 = nImporte;  |FINSI;

     |FINSI;

     |SI enConta = 6;
         nRedTrab6 = nRdto;

         #19#0     = #1#0;
         #19#1     = "4 FAMILIAR";
         |LEE 000#19=;
         |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;

         aMovili6 = #19#3;
         nEjerMo6 = #19#4;

         |SI #19#3 = "S";  |Y #19#4 ] 2005;  nCam27 = nRedTrab6;  |FINSI;

         |SI #999#3 ] 33;  |Y #999#3 < 65;
            |Y nRdtosTrab6 ! 0;  |Y nActivo6 ! 0;
               |SI #999#4 = "N";
                   nImporte = nImporte + #401#20;
               |SINO;
                   nImporte = nImporte + #401#21;
               |FINSI;
         |FINSI;

         |SI #999#3 ] 65; |Y nRdtosTrab6 ! 0;  |Y nActivo6 ! 0;
             nImporte = nImporte + #401#21;
         |FINSI;

         |SI nCam28 < nImporte;  nCam28 = nImporte;  |FINSI;
     |FINSI;

     #1#28 = nImporte;

     |SI enConta > 6;
         nRedTrab1 = nRdto;

         |SI aProlon1 = "S";                     nCam26  = nRedTrab1;  |FINSI;
         |SI aProlon2 = "S";                     nCam26  = nRedTrab1;  |FINSI;

         |SI aMovili1 = "S"; |Y nEjerMo1 ] 2005; nCam27  = nRedTrab1;  |FINSI;
         |SI aMovili2 = "S"; |Y nEjerMo2 ] 2005; nCam27  = nRedTrab1;  |FINSI;
         |SI aMovili3 = "S"; |Y nEjerMo3 ] 2005; nCam27  = nRedTrab1;  |FINSI;
         |SI aMovili4 = "S"; |Y nEjerMo4 ] 2005; nCam27  = nRedTrab1;  |FINSI;
         |SI aMovili5 = "S"; |Y nEjerMo5 ] 2005; nCam27  = nRedTrab1;  |FINSI;
         |SI aMovili6 = "S"; |Y nEjerMo6 ] 2005; nCam27  = nRedTrab1;  |FINSI;

         #1#28 = nCam28;
     |FINSI;
     |CIERRA #19;

     enBloque = 1;  eaCasilla = "015"; |HAZ SacaImporte;
     |SI nCam25 > enImporte;
         nCam25 = enImporte;
     |FINSI;

     #1#25 = nCam25;
     |SI #1#25 < 0;  #1#25 = 0;  |FINSI;

     #1#26 = nCam26;
     #1#27 = nCam27;

     |SI enImporte < 0;
         #1#17 = 0;
         #1#25 = 0;
         #1#26 = 0;
         #1#27 = 0;
         #1#28 = 0;
     |SINO;
         nSuma = #1#15 + #1#17;

         |SI #1#25 ] nSuma;
             #1#25 = nSuma;
             nSuma = 0;
         |SINO;
             nSuma = nSuma - #1#25;
         |FINSI;

         |SI nSuma > 0;
             |SI #1#26 ] nSuma;
                 #1#26 = nSuma;
                 nSuma = 0;
             |SINO;
                 nSuma = nSuma - #1#26;
             |FINSI;
         |SINO;
             #1#26 = 0;
         |FINSI;

         |SI nSuma > 0;
             |SI #1#27 ] nSuma;
                 #1#27 = nSuma;
                 nSuma = 0;
             |SINO;
                 nSuma = nSuma - #1#27;
             |FINSI;
         |SINO;
             #1#27 = 0;
         |FINSI;

         |SI nSuma > 0;
             |SI #1#28 ] nSuma;
                 #1#28 = nSuma;
                 nSuma = 0;
             |SINO;
                 nSuma = nSuma - #1#28;
             |FINSI;
         |SINO;
             #1#28 = 0;
         |FINSI;
     |FINSI;

     #1#23 = (N\ #1#15 - #1#17 - #1#25 - #1#26 - #1#27 - #1#28);
     |SI #1#23 < 0;  |Y #1#15 ] 0;
         #1#23 = 0;
     |FINSI;

     |GRABA 020#1a;
     |LIBERA #1;
     |CIERRA #1;

     enSwAcum  = 0;
     enBloque  = 1;
     eaCasilla = "017";  enImporte = #1#25;  |HAZ GrabaLineal;
     eaCasilla = "018";  enImporte = #1#26;  |HAZ GrabaLineal;
     eaCasilla = "019";  enImporte = #1#27;  |HAZ GrabaLineal;
     eaCasilla = "020";  enImporte = #1#28;  |HAZ GrabaLineal;
     eaCasilla = "021";  enImporte = #1#23;  |HAZ GrabaLineal;

     |DESCARGA_DEF #datfic3@;
     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
|FPRC;

|PROCESO CalculaPlan;
     |ABRE #999;
     |SELECT #2#999;
     #999#1 = #1001#2;
     |LEE 040#999=;
     |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;
     |CIERRA #999;

     nEdad = 2012 - #999#6;

     nValor = #2#15  + #2#7  +  #2#11  + #2#13;

     enBloque = 8;  eaCasilla = "223"; |HAZ SacaImporte; nValor = nValor + enImporte;

     |SI nValor [ 0;  nValor = 0;  |FINSI;

     |SI nEdad [ 49;
         nValor  = (nValor % 30) ! 2;
         |SI nValor > 10000;
             nValor = 10000;
         |FINSI;

         |SI #1#11 > 10000;  #1#11 = 10000;  |FINSI;
         |SI #1#6  > 10000;  #1#6  = 10000;  |FINSI;
     |SINO;
         nValor  = (nValor % 50) ! 2;
         |SI nValor > 12500;
             nValor = 12500;
         |FINSI;

         |SI #1#11 > 12500;  #1#11 = 12500;  |FINSI;
         |SI #1#6  > 12500;  #1#6  = 12500;  |FINSI;
     |FINSI;

     ||#1#5  = (N\ #1#10 + #1#11);

     nValor1 = nValor + #1#10;
     |SI #1#7 > nValor1;
         #1#7 = nValor1;
     |FINSI;

     |SI nEdad [ 49;
         |SI #1#7 > 10000;
             #1#7  = 10000;
         |FINSI;
     |SINO;
         |SI #1#7 > 12500;
             #1#7  = 12500;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CalculaI1;
     |SI enConta ! 7;  |Y enConta ! 8;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem00100.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |DESCARGA_DEF #datfic0@;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1033"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     |LEE 040#0=;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
     |CIERRA #0;

     |ABRE #1;

     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 101#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         #1#0 = #1001#0;
         #1#1 = #1001#1;
         #1#2 = #1001#2;
         |GRABA 020#1b;
     |FINSI;

     #1#51 = 0;
     |SI enConta ! 8;
        |SI #0#6 = "C";
            #1#51 = 3400;
        |SINO;
            |SI #0#95 ! "S";
                #1#51 = 2150;
            |FINSI;
        |FINSI;
     |SINO;
        #1#51 = 2150;
     |FINSI;

     |GRABA 020#1a;
     |LIBERA #1;
     |CIERRA #1;

     enSwAcum  = 0;
     enBloque  = 25;
     eaCasilla = "470";  enImporte = #1#51;   |HAZ GrabaLineal;

     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO CalculaI2;
     aDef    = eaPathDef + "rem01037.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1037"#;  |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |DESCARGA_DEF #datfic1@;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1018"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |DESCARGA_DEF #datfic2@;
         |DESCARGA_DEF #datfic1@;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic3@#"zdat1033"#;  |FINSI;

     |ABRE #1;
     |ABRE #2;
     |ABRE #3;

     #3#0 = #1001#0;
     #3#1 = #1001#1;
     #3#2 = #1001#2;
     |LEE 101#3=;
     |SI FSalida ! 0;
         |DDEFECTO #3;
         #3#0 = #1001#0;
         #3#1 = #1001#1;
         #3#2 = #1001#2;
         |GRABA 020#3b;
     |FINSI;

     |SI enConta = 1;
         #1#0 = #1001#0;
         #1#1 = #1001#1;
         #1#2 = #1001#2;
         #1#3 = 1;
         |LEE 101#1=;
         |SI FSalida ! 0;
             |DDEFECTO #1;
             #1#0 = #1001#0;
             #1#1 = #1001#1;
             #1#2 = #1001#2;
             #1#3 = 1;
             |GRABA 020#1b;
         |FINSI;

         #2#0 = #1001#0;
         #2#1 = #1001#1;
         #2#2 = #1001#2;
         |LEE 000#2=;
         |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

         |SI #1#8 ! "N";  |Y aCalcP = "";
             aCalcP = #1#8;  |QBF aCalcP;
             nCalcP = #1#9;
         |FINSI;

         |HAZ CalculaPlan;

         n481T = #1#5;
         n482T = #1#6;
         n483T = #1#7;

         |GRABA 020#1a;
         |LIBERA #1;

         #3#52 = #1#7;

         enBloque = 8;  eaCasilla = "223"; |HAZ SacaImporte;

         nRdtoTit16 = #1#5 + #1#6;
         nRdtoTit17 = (#1#5 + #1#6) - #1#7;
         nRdtoTit   = #2#15  + #2#7  +  #2#11  + #2#13 + enImporte;
     |FINSI;

     |SI enConta = 2;
         #1#0 = #1001#0;
         #1#1 = #1001#1;
         #1#2 = #1001#2;
         #1#3 = 2;
         |LEE 101#1=;
         |SI FSalida ! 0;
             |DDEFECTO #1;
             #1#0 = #1001#0;
             #1#1 = #1001#1;
             #1#2 = #1001#2;
             #1#3 = 2;
             |GRABA 020#1b;
         |FINSI;

         #2#0 = #1001#0;
         #2#1 = #1001#1;
         #2#2 = #1001#2;
         |LEE 000#2=;
         |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

         |SI #1#8 ! "N";  |Y aCalcP = "";
             aCalcP = #1#8;  |QBF aCalcP;
             nCalcP = #1#9;
         |FINSI;

         |HAZ CalculaPlan;

         n481C = #1#5;
         n482C = #1#6;
         n483C = #1#7;

         |GRABA 020#1a;
         |LIBERA #1;

         #3#52 = #1#7;

         enBloque = 8;  eaCasilla = "223"; |HAZ SacaImporte;

         nRdtoCon16 = #1#5 + #1#6;
         nRdtoCon17 = (#1#5 + #1#6) - #1#7;
         nRdtoCon   = #2#15  + #2#7  +  #2#11  + #2#13 + enImporte;
     |FINSI;

     |SI enConta = 7;
         #1#0 = #1001#0;
         #1#1 = #1001#1;
         #1#2 = #1001#2;
         #1#3 = 1;
         |LEE 101#1=;
         |SI FSalida = 0;
             #1#5  = n481T;
             #1#6  = n482T;
             #1#7  = n483T;

             |GRABA 020#1a;
             |LIBERA #1;
         |FINSI;

         #1#0 = #1001#0;
         #1#1 = #1001#1;
         #1#2 = #1001#2;
         #1#3 = 2;
         |LEE 101#1=;
         |SI FSalida = 0;
             #1#5  = n481C;
             #1#6  = n482C;
             #1#7  = n483C;

             |GRABA 020#1a;
             |LIBERA #1;
         |FINSI;

         #3#52 = n483T + n483C;
     |FINSI;

     |SI enConta = 8;
         |SI eaMuerto = "T";
             #1#0 = #1001#0;
             #1#1 = #1001#1;
             #1#2 = #1001#2;
             #1#3 = 2;
             |LEE 101#1=;
             |SI FSalida = 0;
                 #1#5  = n481C;
                 #1#6  = n482C;
                 #1#7  = n483C;
                 |GRABA 020#1a;
                 |LIBERA #1;
             |FINSI;

             #3#52 = n483C;
         |SINO;
             #1#0 = #1001#0;
             #1#1 = #1001#1;
             #1#2 = #1001#2;
             #1#3 = 1;
             |LEE 101#1=;
             |SI FSalida = 0;
                 #1#5  = n481T;
                 #1#6  = n482T;
                 #1#7  = n483T;

                 |GRABA 020#1a;
                 |LIBERA #1;
              |FINSI;

             #3#52 = n483T;
         |FINSI;
     |FINSI;

     |GRABA 020#3a;
     |LIBERA #3;

     enSwAcum  = 0;
     enBloque  = 26;
     eaCasilla = "500";  enImporte = #3#52;   |HAZ GrabaLineal;

     |CIERRA #1;
     |CIERRA #2;
     |CIERRA #3;

     |DESCARGA_DEF #datfic3@;
     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
|FPRC;

|PROCESO QuitaConyuge;
     |SI #3#10 ] nResto;
         #3#10 = (N\ #3#10 - nResto);
         nResto = 0;
     |SINO;
         nResto = nResto - #3#10;
         #3#10  = (N\ 0);
     |FINSI;

     |SI nResto ] 0;
         |SI #3#11 ] nResto;
             #3#11 = (N\ #3#11 - nResto);
             nResto = 0;
         |SINO;
             nResto = nResto - #3#11;
             #3#11  = 0;
         |FINSI;
     |FINSI;

     |SI nResto ] 0;
         |SI #3#6 ] nResto;
             #3#6 = (N\ #3#6 - nResto);
             nResto = 0;
         |SINO;
             nResto = nResto - #3#6;
             #3#6  = 0;
         |FINSI;
     |FINSI;

     #3#5  = (N\ #3#10 + #3#11);
     #3#7  = (N\ #3#5  + #3#6);
|FPRC;

|PROCESO Calcula505;
     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef + " " + FSalida;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1033"#;  |FINSI;

     aDef    = eaPathDef + "rem01037.mas";
     |CARGA_DEF aDef, datfic3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |DESCARGA_DEF #datfic0@;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic3@#"zdat1037"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 040#0=;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;

     nLimiteGral = 0;
     enBloque = 23;  eaCasilla = "455"; |HAZ SacaImporte; nLimiteGral = nLimiteGral + enImporte;
     enBloque = 24;  eaCasilla = "465"; |HAZ SacaImporte; nLimiteGral = nLimiteGral + enImporte;

     |SI enConta = 1;
         nSuma        = nRdtoCon16;
         nPdte        = nSuma;
         |SI nSuma ! 0;  |Y nRdtoCon < #401#27;
             |SI aCalcP = "P";
                 |SI nRdtoTit ] #401#27;
                     #0#55 = nPdte;
                     |SI #0#55 ] #401#28;
                         #0#55 = (N\ #401#28);
                     |FINSI;
                 |FINSI;
             |FINSI;

             |SI aCalcP = "R";
                 #0#55 = (N\ nRdtoCon17);
                 |SI #0#55 ] #401#28;
                     #0#55 = (N\ #401#28);
                 |FINSI;
             |FINSI;

             |SI aCalcP = "M";
                 #0#55 = (N\ nCalcP);
                 |SI #0#55 ] #401#28;
                     #0#55 = (N\ #401#28);
                 |FINSI;

                 |SI #0#55 ] nSuma;
                     #0#55 = (N\ nSuma);
                 |FINSI;
             |FINSI;

             |SI #0#55 > nLimiteGral;  #0#55 = nLimiteGral;  |FINSI;
             |SI #0#55 < 0;            #0#55 = 0;            |FINSI;

             nRdtoCon18 = #0#55;

             #0#0 = #1001#0;
             #0#1 = #1001#1;
             #0#2 = "TITULAR   ";
             |LEE 101#0=;
             |SI FSalida = 0;
                 #0#55 = nRdtoCon18;
                 |GRABA 020#0a;
                 |LIBERA #0;

                 enSwAcum  = 0;
                 enBloque  = 26;
                 eaCasilla = "505";  enImporte = #0#55;   |HAZ GrabaLineal;
             |FINSI;

             |ABRE #3;
             #3#0 = #1001#0;
             #3#1 = #1001#1;
             #3#2 = "CONYUGE   ";
             #3#3 = 2;
             |LEE 101#3=;
             |SI FSalida = 0;
                 nResto  = nRdtoCon18;
                 aAlfa   = #3#2;
                 |HAZ QuitaConyuge;

                 |GRABA 020#3a;
                 |LIBERA #3;
             |FINSI;
             |CIERRA #3;
         |FINSI;
     |FINSI;

     |SI enConta = 2;
         nSuma        = nRdtoTit16;
         nPdte        = nSuma;
         |SI nSuma ! 0;  |Y nRdtoTit < #401#27;
             |SI aCalcP = "P";
                 |SI nRdtoCon ] #401#27;
                     #0#55 = nPdte;
                     |SI #0#55 ] #401#28;
                         #0#55 = (N\ #401#28);
                     |FINSI;
                 |FINSI;
             |FINSI;

             |SI aCalcP = "R";
                 #0#55 = (N\ nRdtoTit17);
                 |SI #0#55 ] #401#28;
                     #0#55 = (N\ #401#28);
                 |FINSI;
             |FINSI;

             |SI aCalcP = "M";
                 #0#55 = (N\ nCalcP);
                 |SI #0#55 ] #401#28;
                     #0#55 = (N\ #401#28);
                 |FINSI;
                 |SI #0#55 ] nSuma;
                     #0#55 = (N\ nSuma);
                 |FINSI;
             |FINSI;

             |SI #0#55 > nLimiteGral;  #0#55 = nLimiteGral;  |FINSI;
             |SI #0#55 < 0;            #0#55 = 0;            |FINSI;

             nRdtoTit18 = #0#55;

             #0#0 = #1001#0;
             #0#1 = #1001#1;
             #0#2 = "CONYUGE   ";
             |LEE 101#0=;
             |SI FSalida = 0;
                 #0#55 = nRdtoTit18;
                 |GRABA 020#0a;
                 |LIBERA #0;

                 enSwAcum  = 0;
                 enBloque  = 26;
                 eaCasilla = "505";  enImporte = #0#55;   |HAZ GrabaLineal;
             |FINSI;

             |ABRE #3;
             #3#0 = #1001#0;
             #3#1 = #1001#1;
             #3#2 = "TITULAR   ";
             #3#3 = 1;
             |LEE 101#3=;
             |SI FSalida = 0;
                 nResto  = nRdtoTit18;
                 aAlfa   = #3#2;
                 |HAZ QuitaConyuge;

                 |GRABA 020#3a;
                 |LIBERA #3;
             |FINSI;
             |CIERRA #3;
         |FINSI;
     |FINSI;

     |SI enConta = 7;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |LEE 101#0=;
         |SI FSalida ! 0;
             |DDEFECTO #0;
             #0#0 = #1001#0;
             #0#1 = #1001#1;
             #0#2 = #1001#2;
             |GRABA 020#0b;
         |FINSI;

         |SI nLimiteGral > 0;  |O aCalcP = "M";
             #0#55  = (N\ nRdtoTit18  + nRdtoCon18);
         |SINO;
             #0#55      = 0;
             nRdtoTit18 = 0;
             nRdtoCon18 = 0;
         |FINSI;

         nPdte = #0#55;
         |SI nPdte > nLimiteGral;  |Y aCalcP ! "M";
             #0#55 = nLimiteGral;
             |SI #0#55 < 0;  #0#55 = 0;  |FINSI;

             nResto  = #0#55;
             |SI nResto > 0;
                 |SI nRdtoTit18 > nResto;
                     nRdtoTit18 = nResto;
                     nRdtoCon18 = 0;
                     nResto     = 0;
                 |SINO;
                     nResto = nResto - nRdtoTit18;
                 |FINSI;

                 |SI nResto > 0;
                     |SI nRdtoCon18 > nResto;
                         nRdtoCon18 = nResto;
                     |FINSI;
                 |FINSI;
             |SINO;
                 nRdtoTit18 = 0;
                 nRdtoCon18 = 0;
             |FINSI;
         |FINSI;

         enSwAcum  = 0;
         enBloque  = 26;
         eaCasilla = "505";  enImporte = #0#55;   |HAZ GrabaLineal;

         |GRABA 020#0a;
         |LIBERA #0;

         |ABRE #3;
         #3#0 = #1001#0;
         #3#1 = #1001#1;
         #3#2 = #1001#2;
         #3#3 = 1;
         |LEE 101#3=;
         |SI FSalida = 0;
             nResto  = nRdtoTit18;
             aAlfa   = "TITULAR";
             |HAZ QuitaConyuge;

             |GRABA 020#3a;
             |LIBERA #3;
         |FINSI;

         #3#0 = #1001#0;
         #3#1 = #1001#1;
         #3#2 = #1001#2;
         #3#3 = 2;
         |LEE 101#3=;
         |SI FSalida = 0;
             nResto  = nRdtoCon18;
             aAlfa   = "CONYUGE";
             |HAZ QuitaConyuge;

             |GRABA 020#3a;
             |LIBERA #3;
         |FINSI;

         |CIERRA #3;
     |FINSI;

     |SI enConta = 8;  |Y nLimiteGral > 0;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |LEE 101#0=;
         |SI FSalida ! 0;
             |DDEFECTO #0;
             #0#0 = #1001#0;
             #0#1 = #1001#1;
             #0#2 = #1001#2;
             |GRABA 020#0b;
         |FINSI;

         |SI nLimiteGral > 0;
             |SI eaMuerto = "T";
                 #0#55 = (N\ nRdtoCon18);
                 nRdtoTit18 = 0;
             |SINO;
                 #0#55 = (N\ nRdtoTit18);
                 nRdtoCon18 = 0;
             |FINSI;
         |SINO;
             #0#55      = 0;
             nRdtoTit18 = 0;
             nRdtoCon18 = 0;
         |FINSI;

         nPdte = #0#55;
         |SI nPdte > nLimiteGral;
             #0#55 = nLimiteGral;
             |SI #0#55 < 0;  #0#55 = 0;  |FINSI;

             nResto  = #0#55;
             |SI nResto > 0;
                 |SI nRdtoTit18 > nResto;
                     nRdtoTit18 = nResto;
                     nRdtoCon18 = 0;
                     nResto     = 0;
                 |SINO;
                     nResto = nResto - nRdtoTit18;
                 |FINSI;

                 |SI nResto > 0;
                     |SI nRdtoCon18 > nResto;
                         nRdtoCon18 = nResto;
                     |FINSI;
                 |FINSI;
             |SINO;
                 nRdtoTit18 = 0;
                 nRdtoCon18 = 0;
             |FINSI;
         |FINSI;

         enSwAcum  = 0;
         enBloque  = 26;
         eaCasilla = "505";  enImporte = #0#55;   |HAZ GrabaLineal;

         |GRABA 020#0a;
         |LIBERA #0;

         |ABRE #3;

         #3#0 = #1001#0;
         #3#1 = #1001#1;
         #3#2 = #1001#2;
         #3#3 = 1;
         |LEE 101#3=;
         |SI FSalida = 0;
             nResto  = nRdtoTit18;
             aAlfa   = "TITULAR";
             |HAZ QuitaConyuge;

             |GRABA 020#3a;
             |LIBERA #3;
         |FINSI;

         #3#0 = #1001#0;
         #3#1 = #1001#1;
         #3#2 = #1001#2;
         #3#3 = 2;
         |LEE 101#3=;
         |SI FSalida = 0;
             nResto  = nRdtoCon18;
             aAlfa   = "CONYUGE";
             |HAZ QuitaConyuge;

             |GRABA 020#3a;
             |LIBERA #3;
         |FINSI;

         |CIERRA #3;
     |FINSI;

     |CIERRA #0;

     |DESCARGA_DEF #datfic3@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO SacaTope;
     aDef    = eaPathDef + "rem01026.mas";
     |CARGA_DEF aDef, datfic5@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic5@#"zdat1026"#;  |FINSI;

     |ABRE #5;
     #5#0 = #1001#0;
     #5#1 = #1001#1;
     #5#2 = #1001#2;
     |LEE 040#5=;
     |SI FSalida ! 0;  |DDEFECTO #5;  |FINSI;
     |CIERRA #5;

     nValor = #2#15  + #2#7  + #2#8  + #2#11  + #2#13 + #5#12;
     |SI nValor [ 0;  nValor = 0;  |FINSI;

     |DESCARGA_DEF #datfic5@;
|FPRC;

|PROCESO CalculaI6;
     aDef    = eaPathDef + "rem01047.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1047"#;  |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |DESCARGA_DEF #datfic1@;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1018"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |DESCARGA_DEF #datfic2@;
         |DESCARGA_DEF #datfic1@;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic3@#"zdat1033"#;  |FINSI;

     |ABRE #1;
     |ABRE #2;
     |ABRE #3;

     #3#0 = #1001#0;
     #3#1 = #1001#1;
     #3#2 = #1001#2;
     |LEE 101#3=;
     |SI FSalida ! 0;
         |DDEFECTO #3;
         #3#0 = #1001#0;
         #3#1 = #1001#1;
         #3#2 = #1001#2;
         |GRABA 020#3b;
     |FINSI;

     |SI enConta = 1;
         #1#0 = #1001#0;
         #1#1 = #1001#1;
         #1#2 = #1001#2;
         #1#3 = 1;
         |LEE 101#1=;
         |SI FSalida ! 0;
             |DDEFECTO #1;
             #1#0 = #1001#0;
             #1#1 = #1001#1;
             #1#2 = #1001#2;
             #1#3 = 1;
             |GRABA 020#1b;
         |FINSI;

         #2#0 = #1001#0;
         #2#1 = #1001#1;
         #2#2 = #1001#2;
         |LEE 000#2=;
         |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

         |HAZ SacaTope;

         nValor = #1#5 + #1#6;
         nResto = 0;
         |SI nValor > #401#23;
             nValor = #401#23;
             nResta = #401#23 - #1#6;
             |SI nResta < 0;  nResta = 0;  |FINSI;

             nResto = #1#5 - nResta;
         |FINSI;

         nValorTit20 = nValor;

         |GRABA 020#1a;
         |LIBERA #1;

         #3#63 = nValor;
     |FINSI;

     |SI enConta = 2;
         #1#0 = #1001#0;
         #1#1 = #1001#1;
         #1#2 = #1001#2;
         #1#3 = 2;
         |LEE 101#1=;
         |SI FSalida ! 0;
             |DDEFECTO #1;
             #1#0 = #1001#0;
             #1#1 = #1001#1;
             #1#2 = #1001#2;
             #1#3 = 2;
             |GRABA 020#1b;
         |FINSI;

         #2#0 = #1001#0;
         #2#1 = #1001#1;
         #2#2 = #1001#2;
         |LEE 000#2=;
         |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

         |HAZ SacaTope;

         nValor = #1#5 + #1#6;
         nResto = 0;
         |SI nValor > #401#23;
             nValor = #401#23;
             nResta = #401#23 - #1#6;
             |SI nResta < 0;  nResta = 0;  |FINSI;

             nResto = #1#5 - nResta;
         |FINSI;

         nValorCon20 = nValor;

         |GRABA 020#1a;
         |LIBERA #1;

         #3#63 = nValor;
     |FINSI;

     |SI enConta = 7;
         #3#63 = nValorTit20 + nValorCon20;
     |FINSI;

     |SI enConta = 8;
         |SI eaMuerto = "T";
             #3#63 = nValorCon20;
         |SINO;
             #3#63 = nValorTit20;
         |FINSI;
     |FINSI;

     |GRABA 020#3a;
     |LIBERA #3;

     enSwAcum  = 0;
     enBloque  = 30;
     eaCasilla = "600";  enImporte = #3#63;   |HAZ GrabaLineal;

     |CIERRA #1;
     |CIERRA #2;
     |CIERRA #3;

     |DESCARGA_DEF #datfic3@;
     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
|FPRC;

|PROCESO rem01035;
     |SI #2#3 = 1;
         nExcesoT = nExcesoT  + #2#7;
         nAportaT = nAportaT  + #2#6;
     |FINSI;

     |SI #2#3 = 2;
         nExcesoC = nExcesoC  + #2#7;
         nAportaC = nAportaC  + #2#6;
     |FINSI;
|FPRC;

|DEFBUCLE rem01035;
     #2#1004;
     ;
     #1001#0, #1001#1, #1001#2, 001;
     #1001#0, #1001#1, #1001#2, 999;
     ;
     NULL, rem01035;
|FIN;

|PROCESO rem01037;
     |SI enConta < 7;
         nExcesoT   = nExcesoT   + #1#5;
         nAportaT   = nAportaT   + #1#6;
         nValorTit  = nValorTit  + #1#7;
     |SINO;
         |SI #1#3 = 1;
             nExcesoT   = nExcesoT   + #1#5;
             nAportaT   = nAportaT   + #1#6;
             nValorTit  = nValorTit  + #1#7;
         |FINSI;

         |SI #1#3 = 2;
             nExcesoC   = nExcesoC  + #1#5;
             nAportaC   = nAportaC  + #1#6;
             nValorCon  = nValorCon + #1#7;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE rem01037;
     #1#1004;
     ;
     #1001#0, #1001#1, #1001#2, 001;
     #1001#0, #1001#1, #1001#2, 999;
     ;
     NULL, rem01037;
|FIN;

|PROCESO rem01045;
     |SI enConta < 7;
         nExcesoT = nExcesoT  + #3#6;
         nAportaT = nAportaT  + #3#9 + #3#10;
     |SINO;
         |SI #3#3 = 1;
             nExcesoT = nExcesoT  + #3#6;
             nAportaT = nAportaT  + #3#9 + #3#10;
         |FINSI;

         |SI #3#3 = 2;
             nExcesoC = nExcesoC + #3#6;
             nAportaC = nAportaC  + #3#9 + #3#10;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE rem01045;
     #3#1004;
     ;
     #1001#0, #1001#1, #1001#2, 001;
     #1001#0, #1001#1, #1001#2, 999;
     ;
     NULL, rem01045;
|FIN;

|PROCESO rem01047;
     |SI enConta < 7;
         nExcesoT = nExcesoT  + #4#5;
         nAportaT = nAportaT  + #4#6;
     |SINO;
         |SI #4#3 = 1;
             nExcesoT = nExcesoT  + #4#5;
             nAportaT = nAportaT  + #4#6;
         |FINSI;

         |SI #3#3 = 2;
             nExcesoC = nExcesoC  + #4#5;
             nAportaC = nAportaC  + #4#6;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE rem01047;
     #4#1004;
     ;
     #1001#0, #1001#1, #1001#2, 001;
     #1001#0, #1001#1, #1001#2, 999;
     ;
     NULL, rem01047;
|FIN;

|PROCESO CalculaJ;
     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1033"#;  |FINSI;

     aDef    = eaPathDef + "rem01037.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |DESCARGA_DEF #datfic0@;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1037"#;  |FINSI;

     aDef    = eaPathDef + "rem01035.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |DESCARGA_DEF #datfic1@;
         |DESCARGA_DEF #datfic0@;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1035"#;  |FINSI;

     aDef    = eaPathDef + "rem01045.mas";
     |CARGA_DEF aDef, datfic3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;

         |DESCARGA_DEF #datfic2@;
         |DESCARGA_DEF #datfic1@;
         |DESCARGA_DEF #datfic0@;

         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic3@#"zdat1045"#;  |FINSI;

     aDef    = eaPathDef + "rem01047.mas";
     |CARGA_DEF aDef, datfic4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |DESCARGA_DEF #datfic3@;
         |DESCARGA_DEF #datfic2@;
         |DESCARGA_DEF #datfic1@;
         |DESCARGA_DEF #datfic0@;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic4@#"zdat1047"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |GRABA 020#0b;
     |FINSI;

     #0#66      = (N\ #0#44);
     #0#67      = 0;
     #0#68      = 0;
     #0#69      = 0;
     #0#70      = 0;
     #0#71      = 0;
     #0#72      = 0;
     #0#73      = 0;
     nAfiliados = #0#74;
     #0#74      = 0;

     |SI nAfiliados > 600;  nAfiliados = 600;  |FINSI;

     |SI #0#66 > 0;
         nResta = #0#66;

         |SI #0#51 ! 0;
             |SI #0#51 [ nResta;
                 #0#67  = #0#51;
                 nResta = nResta - #0#51;
             |SINO;
                 #0#67  = nResta;
                 nResta = 0;
             |FINSI;
         |FINSI;

         |SI nResta ! 0;  |Y #0#52 ! 0;
             |SI #0#52 [ nResta;
                 #0#68  = #0#52;
                 nResta = nResta - #0#52;
             |SINO;
                 #0#68  = nResta;
                 nResta = 0;
             |FINSI;
         |FINSI;

         |SI nResta ! 0;  |Y #0#55 ! 0;
             |SI #0#55 [ nResta;
                 #0#69  = #0#55;
                 nResta = nResta - #0#55;
             |SINO;
                 #0#69  = nResta;
                 nResta = 0;
             |FINSI;
         |FINSI;

         |SI nResta ! 0;  |Y #0#56 ! 0;
             |SI #0#56 [ nResta;
                 #0#70  = #0#56;
                 nResta = nResta - #0#56;
             |SINO;
                 #0#70  = nResta;
                 nResta = 0;
             |FINSI;
         |FINSI;

         |SI nResta ! 0;  |Y #0#59 ! 0;
             |SI #0#59 [ nResta;
                 #0#71  = #0#59;
                 nResta = nResta - #0#59;
             |SINO;
                 #0#71  = nResta;
                 nResta = 0;
             |FINSI;
         |FINSI;

         |SI nResta ! 0;  |Y #0#62 ! 0;
             |SI #0#62 [ nResta;
                 #0#72  = #0#62;
                 nResta = nResta - #0#62;
             |SINO;
                 #0#72  = nResta;
                 nResta = 0;
             |FINSI;
         |FINSI;

         |SI nResta ! 0;  |Y #0#63 ! 0;
             |SI #0#63 [ nResta;
                 #0#73  = #0#63;
                 nResta = nResta - #0#63;
             |SINO;
                 #0#73  = nResta;
                 nResta = 0;
             |FINSI;
         |FINSI;

         |SI nResta ! 0;  |Y nAfiliados ! 0;
             |SI nAfiliados [ nResta;
                 #0#74  = nAfiliados;
                 nResta = nResta - nAfiliados;
             |SINO;
                 #0#74  = nResta;
                 nResta = 0;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #0#44 < 0;
         #0#75 = #0#44;
     |SINO;
         #0#75 = (N\ #0#44 - #0#67 - #0#68 - #0#69 - #0#70 - #0#71 - #0#72 - #0#73 - #0#74);
         |SI #0#75 < 0;  #0#75 = 0;  |FINSI;
     |FINSI;

     |SI #0#75 > 0;
         |SI #0#76 > #0#75;
             #0#76  = #0#75;
         |FINSI;
     |SINO;
         #0#76 = 0;
     |FINSI;

     #0#77  = (N\ #0#75 - #0#76);

     #0#78  = (N\ #0#50);
     #0#79  = 0;
     #0#80  = 0;
     #0#81  = 0;
     #0#110 = 0;

     |SI #0#78 > 0;
         nResta     = #0#78;
         nRemanente = #0#51 - #0#67;
         |SI nRemanente > 0;
             |SI nRemanente [ nResta;
                 #0#79  = nRemanente;
                 nResta = nResta - nRemanente;
             |SINO;
                 #0#79  = nResta;
                 nResta = 0;
             |FINSI;
         |FINSI;

         nRemanente = #0#62 - #0#72;
         |SI nRemanente > 0;  |Y nResta > 0;
             |SI nRemanente [ nResta;
                 #0#80  = nRemanente;
                 nResta = nResta - nRemanente;
             |SINO;
                 #0#80  = nResta;
                 nResta = 0;
             |FINSI;
         |FINSI;

         nRemanente = nAfiliados - #0#74;
         |SI nRemanente > 0;  |Y nResta > 0;
             |SI nRemanente [ nResta;
                 #0#110 = nRemanente;
                 nResta = nResta - nRemanente;
             |SINO;
                 #0#110 = nResta;
                 nResta = 0;
             |FINSI;
         |FINSI;
     |FINSI;

     #0#81 = (N\ #0#78 - #0#79 - #0#80 - #0#110);

     nAportaT  = 0;
     nAportaC  = 0;
     nExcesoT  = 0;
     nExcesoC  = 0;
     nValorTit = 0;
     nValorCon = 0;
     |BUCLE rem01037;

     |SI nExcesoT > nValorTit;  nExcesoT = nValorTit;  |FINSI;
     |SI nExcesoC > nValorCon;  nExcesoC = nValorCon;  |FINSI;

     nValor = #0#68;
     nResta = nValor - nExcesoT;
     |SI nResta ] 0;
         nValorTit = nValorTit - nExcesoT;
     |FINSI;

     |SI nResta > 0;
         |SI nResta > nExcesoC;
             nResta    = nResta    - nExcesoC;
             nValorCon = nValorCon - nExcesoC;
         |SINO;
             nResta = 0;
         |FINSI;
     |FINSI;

     |SI nValorTit < 0;  nValorTit = 0;  |FINSI;
     |SI nValorCon < 0;  nValorCon = 0;  |FINSI;

     |SI nResta > 0;
         nPorce   = (nValorTit / (nValorTit + nValorCon)) * 100;
         |SI nPorce = 100;
             nAportaT = nAportaT - nResta;
         |SINO;
            nResta1  = (nResta % nPorce) ! 2;
            nAportaT = nAportaT - nResta1;
            nAportaC = nAportaC - (nResta - nResta1);
         |FINSI;
     |FINSI;

     |SI nAportaT > 0;  |Y nAportaC > 0;
         #0#82 = "TITULAR";
         #0#83 = nAportaT;

         #0#84 = "CONYUGE";
         #0#85 = nAportaC;
     |SINO;
         |SI nAportaT > 0;
             #0#82 = "TITULAR";
             #0#83 = nAportaT;
         |FINSI;

         |SI nAportaC > 0;
             #0#82 = "CONYUGE";
             #0#83 = nAportaC;
         |FINSI;
     |FINSI;

     nPdte = #0#56 - #0#70;
     |SI nPdte > 0;
         nAportaT = 0;
         nAportaC = 0;
         nExcesoT = 0;
         nExcesoC = 0;
         |BUCLE rem01045;

         |SI nPdte = 0;
             nAportaT = 0;
             nAportaC = 0;
         |SINO;
             nResta  = (nAportaT + nAportaC) - (#0#70 - nExcesoT - nExcesoC);
             |SI nResta [ 0;
                 nResta   = 0;
                 nAportaT = 0;
                 nAportaC = 0;
             |FINSI;

             nValor = nAportaT + nAportaC;
             |SI nResta > nValor;
                 nResta = nValor;
             |FINSI;

             |SI nResta > 0;
                 |SI nResta ] nAportaT;
                     nResta   = nResta - nAportaT;
                 |SINO;
                     nAportaT = nResta;
                     nResta   = 0;
                 |FINSI;
             |FINSI;

             |SI nResta > 0;
                 |SI nResta > nAportaC;
                     nResta   = nResta - nAportaC;
                 |SINO;
                     nAportaC = nResta;
                     nResta   = 0;
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI nAportaT ! 0;  |Y nAportaC ! 0;
             #0#86 = "TITULAR";
             #0#87 = nAportaT;

             #0#88 = "CONYUGE";
             #0#89 = nAportaC;
         |SINO;
             |SI nAportaT ! 0;
                 #0#86 = "TITULAR";
                 #0#87 = nAportaT;
             |FINSI;

             |SI nAportaC ! 0;
                 #0#86 = "CONYUGE";
                 #0#87 = nAportaC;
             |FINSI;
         |FINSI;
     |FINSI;

     nPdte = #0#59 - #0#71;
     |SI nPdte > 0;
         nAportaT = 0;
         nExcesoT = 0;
         nAportaC = 0;
         nExcesoC = 0;
         |BUCLE rem01035;

         nValor = #0#59 - #0#71;
         |SI nValor = 0;
             nAportaT = 0;
             nAportaC = 0;
         |SINO;
             nResta  = (nAportaT + nAportaC) - (#0#71 - nExcesoT - nExcesoC);
             |SI nResta [ 0;
                 nResta   = 0;
                 nAportaT = 0;
                 nAportaC = 0;
             |FINSI;

             nValor = nAportaT + nAportaC;
             |SI nResta > nValor;
                 nResta = nValor;
             |FINSI;

             |SI nResta [ 0;
                 nResta   = 0;
                 nAportaT = 0;
                 nAportaC = 0;
             |FINSI;

             |SI nResta > 0;
                 |SI nResta ] nAportaT;
                     nResta   = nResta - nAportaT;
                 |SINO;
                     nAportaT = nResta;
                     nResta   = 0;
                 |FINSI;
             |FINSI;

             |SI nResta > 0;
                 |SI nResta > nAportaC;
                     nResta   = nResta - nAportaC;
                 |SINO;
                     nAportaC = nResta;
                     nResta   = 0;
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI nAportaT ! 0;  |Y nAportaC ! 0;
             #0#90 = "TITULAR";
             #0#91 = nAportaT;

             #0#92 = "CONYUGE";
             #0#93 = nAportaC;
         |SINO;
             |SI nAportaT ! 0;
                 #0#90 = "TITULAR";
                 #0#91 = nAportaT;
             |FINSI;

             |SI nAportaC ! 0;
                 #0#90 = "CONYUGE";
                 #0#91 = nAportaC;
             |FINSI;
         |FINSI;
     |FINSI;

     nPdte = #0#63 - #0#73;
     |SI nPdte > 0;
         nAportaT = 0;
         nAportaC = 0;
         nExcesoT = 0;
         nExcesoC = 0;
         |BUCLE rem01047;

         nValor = #0#63 - #0#73;
         |SI nValor = 0;
             nAportaT = 0;
             nAportaC = 0;
         |SINO;
             nResta  = (nAportaT + nAportaC) - (#0#73 - nExcesoT - nExcesoC);
             |SI nResta [ 0;
                 nResta   = 0;
                 nAportaT = 0;
                 nAportaC = 0;
             |FINSI;

             nValor = nAportaT + nAportaC;
             |SI nResta > nValor;
                 nResta = nValor;
             |FINSI;

             |SI nResta [ 0;
                 nResta   = 0;
                 nAportaT = 0;
                 nAportaC = 0;
             |FINSI;

             |SI nResta > 0;
                 |SI nResta ] nAportaT;
                     nResta   = nResta - nAportaT;
                 |SINO;
                     nAportaT = nResta;
                     nResta   = 0;
                 |FINSI;
             |FINSI;

             |SI nResta > 0;
                 |SI nResta > nAportaC;
                     nResta   = nResta - nAportaC;
                 |SINO;
                     nAportaC = nResta;
                     nResta   = 0;
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI nAportaT ! 0;  |Y nAportaC ! 0;
             #0#94 = "TITULAR";
             #0#95 = nAportaT;

             #0#94 = "CONYUGE";
             #0#95 = nAportaC;
         |SINO;
             |SI nAportaT ! 0;
                 #0#94 = "TITULAR";
                 #0#95 = nAportaT;
             |FINSI;

             |SI nAportaC ! 0;
                 #0#96 = "CONYUGE";
                 #0#97 = nAportaC;
             |FINSI;
         |FINSI;
     |FINSI;

     |GRABA 020#0a;
     |LIBERA #0;

     enSwAcum   = 0;
     enBloque   = 31;
     eaCasilla  = "455";  enImporte = #0#66;   |HAZ GrabaLineal;
     eaCasilla  = "610";  enImporte = #0#67;   |HAZ GrabaLineal;
     eaCasilla  = "611";  enImporte = #0#68;   |HAZ GrabaLineal;
     eaCasilla  = "612";  enImporte = #0#69;   |HAZ GrabaLineal;
     eaCasilla  = "613";  enImporte = #0#70;   |HAZ GrabaLineal;
     eaCasilla  = "614";  enImporte = #0#71;   |HAZ GrabaLineal;
     eaCasilla  = "615";  enImporte = #0#72;   |HAZ GrabaLineal;
     eaCasilla  = "616";  enImporte = #0#74;   |HAZ GrabaLineal;
     eaCasilla  = "617";  enImporte = #0#73;   |HAZ GrabaLineal;
     eaCasilla  = "618";  enImporte = #0#75;   |HAZ GrabaLineal;
     eaCasilla  = "619";  enImporte = #0#76;   |HAZ GrabaLineal;
     eaCasilla  = "620";  enImporte = #0#77;   |HAZ GrabaLineal;

     enBloque   = 32;
     eaCasilla  = "465";  enImporte = #0#78;   |HAZ GrabaLineal;
     eaCasilla  = "621";  enImporte = #0#79;   |HAZ GrabaLineal;
     eaCasilla  = "622";  enImporte = #0#80;   |HAZ GrabaLineal;
     eaCasilla  = "623";  enImporte = #0#110;  |HAZ GrabaLineal;
     eaCasilla  = "630";  enImporte = #0#81;   |HAZ GrabaLineal;

     |DESCARGA_DEF #datfic4@;
     |DESCARGA_DEF #datfic3@;
     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO rem00101;
     enNumFamilia = 1;

     |SI #2#6 = "C";
         enNumFamilia = 2;
     |FINSI;

     |ABRE #1;
     |DDEFECTO #1;
     #1#0 = #1001#0;
     #1#1 = 1;
     |LEE 040#1];
     |PARA; |SI FSalida = 0;  |Y #1#0 = #1001#0;  |HACIENDO;
            nImputT = 0;
            nImputC = 0;
            nCompar = #1#11 / 100;

            |SI enConta = 1;
                |SI #1#7 = " ";  nImput = 0.5;  nImputT = 0.5;  nImputC = 0.5; |FINSI;
                |SI #1#7 = "1";  nImput = 1;    nImputT = 1;                   |FINSI;
                |SI #1#7 = "2";  nImput = 0;    nImputC = 1;                   |FINSI;
                |SI #1#7 = "3";  nImput = 0.5;  nImputT = 0.5;                 |FINSI;
                |SI #1#7 = "4";  nImput = 0;    nImputC = 0.5;                 |FINSI;

                |SI #1#15 = "S";  |Y #1#4 = "ASCENDIENTE ";
                    |SI #1#7 = " ";
                        nImput  = nCompar / 2;
                        nImputT = nCompar / 2;
                        nImputC = nCompar / 2;
                    |FINSI;
                    |SI #1#7 = "2";  nImput = 0;        nImputC = nCompar; |FINSI;
                    |SI #1#7 = "1";  nImput = nCompar;  nImputT = nCompar; |FINSI;
                |FINSI;
            |FINSI;

            |SI enConta = 2;
                |SI #1#7 = " ";  nImput = 0.5;  nImputT = 0.5;  nImputC = 0.5; |FINSI;
                |SI #1#7 = "1";  nImput = 0;    nImputT = 1;                   |FINSI;
                |SI #1#7 = "2";  nImput = 1;    nImputC = 1;                   |FINSI;
                |SI #1#7 = "3";  nImput = 0;    nImputT = 0.5;                 |FINSI;
                |SI #1#7 = "4";  nImput = 0.5;  nImputC = 0.5;                 |FINSI;

                |SI #1#15 = "S";  |Y #1#4 = "ASCENDIENTE ";
                    |SI #1#7 = " ";
                        nImput  = nCompar / 2;
                        nImputT = nCompar / 2;
                        nImputC = nCompar / 2;
                    |FINSI;
                    |SI #1#7 = "1";  nImput = 0;        nImputT = nCompar; |FINSI;
                    |SI #1#7 = "2";  nImput = nCompar;  nImputC = nCompar; |FINSI;
                |FINSI;
            |FINSI;

            |SI enConta = 8;  |Y eaMuerto = "C";
                |SI #1#7 = " ";  nImput = 0.5;  nImputT = 0.5;  nImputC = 0.5; |FINSI;
                |SI #1#7 = "1";  nImput = 1;    nImputT = 1;    |FINSI;
                |SI #1#7 = "2";  nImput = 0;    nImputC = 1;    |FINSI;
                |SI #1#7 = "3";  nImput = 0.5;  nImputT = 0.5;  |FINSI;
                |SI #1#7 = "4";  nImput = 0;    nImputC = 0.5;  |FINSI;

                |SI #1#15 = "S";  |Y #1#4 = "ASCENDIENTE ";
                    |SI #1#7 = " ";
                        nImput  = nCompar / 2;
                        nImputT = nCompar / 2;
                        nImputC = nCompar / 2;
                    |FINSI;
                    |SI #1#7 = "2";  nImput = 0;        nImputC = nCompar; |FINSI;
                    |SI #1#7 = "1";  nImput = nCompar;  nImputT = nCompar; |FINSI;
                |FINSI;
            |FINSI;

            |SI enConta = 8;  |Y eaMuerto = "T";
                |SI #1#7 = " ";  nImput = 0.5;  nImputT = 0.5;  nImputC = 0.5; |FINSI;
                |SI #1#7 = "1";  nImput = 0;    nImputT = 1;    |FINSI;
                |SI #1#7 = "2";  nImput = 1;    nImputC = 1;    |FINSI;
                |SI #1#7 = "3";  nImput = 0;    nImputT = 0.5;  |FINSI;
                |SI #1#7 = "4";  nImput = 0.5;  nImputC = 0.5;  |FINSI;

                |SI #1#15 = "S";  |Y #1#4 = "ASCENDIENTE ";
                    |SI #1#7 = " ";
                        nImput  = nCompar / 2;
                        nImputT = nCompar / 2;
                        nImputC = nCompar / 2;
                    |FINSI;
                    |SI #1#7 = "1";  nImput = 0;        nImputT = nCompar; |FINSI;
                    |SI #1#7 = "2";  nImput = nCompar;  nImputC = nCompar; |FINSI;
                |FINSI;
            |FINSI;

            |SI enConta = 7;
                nImput = 1;

                |SI #1#7 = "3";  |O #1#7 = "4";
                    nImput = 0.5;
                |FINSI;

                |SI #1#11 = -2;
                    nImput = 1;
                |FINSI;

                |SI #1#15 = "S";  |Y #1#4 = "ASCENDIENTE ";
                    nImput = nCompar;
                |FINSI;
            |FINSI;

            |SI #1#13 = "S";  |Y  #1#4 = "DESCENDIENTE";
                nFamiliar = nFamiliar + 1;
            |FINSI;

            |SI #1#13 = "S";  |Y  #1#4 = "DESCENDIENTE";  |Y #1#11 ! -1;
             |Y nFamiliar [ 4;
                 |SI #1#5 > 0;
                     |ABRE #3;
                     #3#0 = #0#0;
                     #3#1 = #0#1;
                     |SI nFamiliar = 1;   #3#2 = "1 FAMILIAR";  |FINSI;
                     |SI nFamiliar = 2;   #3#2 = "2 FAMILIAR";  |FINSI;
                     |SI nFamiliar = 3;   #3#2 = "3 FAMILIAR";  |FINSI;
                     |SI nFamiliar = 4;   #3#2 = "4 FAMILIAR";  |FINSI;
                     |LEE 000#3=;
                     |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;
                     |CIERRA #3;

                     nValor   = #3#19;
                     nValor   = nValor + #3#7;
                     nValor   = nValor + #3#11;
                     nValor   = nValor + #3#13;

                     aAlfa   = #1001#2;
                     #1001#2 = #3#2;

                     enBloque = 1;  eaCasilla = "015"; |HAZ SacaImporte; nValor = nValor + enImporte;
                     enBloque = 2;  eaCasilla = "031"; |HAZ SacaImporte; nValor = nValor + enImporte;
                     enBloque = 3;  eaCasilla = "047"; |HAZ SacaImporte; nValor = nValor + enImporte;
                     enBloque = 4;  eaCasilla = "080"; |HAZ SacaImporte; nValor = nValor + enImporte;
                     enBloque = 9;  eaCasilla = "245"; |HAZ SacaImporte; nValor = nValor + enImporte;
                     enBloque = 10; eaCasilla = "255"; |HAZ SacaImporte; nValor = nValor + enImporte;
                     enBloque = 11; eaCasilla = "265"; |HAZ SacaImporte; nValor = nValor + enImporte;
                     enBloque = 12; eaCasilla = "275"; |HAZ SacaImporte; nValor = nValor + enImporte;
                     enBloque = 21; eaCasilla = "450"; |HAZ SacaImporte; nValor = nValor + enImporte;
                     enBloque = 21; eaCasilla = "442"; |HAZ SacaImporte; nValor = nValor - enImporte;
                     enBloque = 22; eaCasilla = "457"; |HAZ SacaImporte; nValor = nValor + enImporte;
                     enBloque = 22; eaCasilla = "445"; |HAZ SacaImporte; nValor = nValor - enImporte;

                     #1001#2 = aAlfa;

                     nEdad   = 2012 - #1#5;
                     |SI nEdad < 25;
                         |SI nEdad [ 17;  |O #1#8 = "2";
                             nSwConjunta = 1;

                             |SI eaMuerto = "T";  |Y #1#7 ! "1";
                                 nSwConjuntaE = 1;
                             |FINSI;

                             |SI eaMuerto = "C";  |Y #1#7 ! "2";
                                 nSwConjuntaE = 1;
                             |FINSI;
                         |FINSI;

                         |SI nEdad < 25;  |Y nValor > 8000;
                             #1#4 = "";
                         |FINSI;
                     |SINO;
                         |SI #1#8 = "2";
                             nSwConjunta  = 1;

                             |SI eaMuerto = "T";  |Y #1#7 ! "1";
                                 nSwConjuntaE = 1;
                             |FINSI;

                             |SI eaMuerto = "C";  |Y #1#7 ! "2";
                                 nSwConjuntaE = 1;
                            |FINSI;
                         |FINSI;

                         |SI #1#6 ] 33;  |Y nValor > 8000;
                             #1#4 = "";
                         |FINSI;
                     |FINSI;
                 |FINSI;
            |FINSI;

            |SI #1#11 = -1;
                |SI #1#4 = "DESCENDIENTE";
                    |SI #1#5 > 0;
                        nEdad   = 2012 - #1#5;

                        |SI nEdad < 25;
                            |SI nEdad [ 17;  |O #1#8 = "2";
                                nSwConjunta = 1;

                                |SI eaMuerto = "T";  |Y #1#7 ! "1";
                                    nSwConjuntaE = 1;
                                |FINSI;

                                |SI eaMuerto = "C";  |Y #1#7 ! "2";
                                    nSwConjuntaE = 1;
                                |FINSI;
                            |FINSI;
                        |SINO;
                            |SI #1#8 = "2";
                                nSwConjunta  = 1;

                                |SI eaMuerto = "T";  |Y #1#7 ! "1";
                                    nSwConjuntaE = 1;
                                |FINSI;

                                |SI eaMuerto = "C";  |Y #1#7 ! "2";
                                    nSwConjuntaE = 1;
                                |FINSI;
                            |FINSI;
                        |FINSI;
                    |FINSI;
                |FINSI;

                #1#4 = "";
            |FINSI;

            |SI #1#4 = "DESCENDIENTE";
                |SI #1#5 > 0;
                    nEdad     = 2012 - #1#5;

                    |SI nEdad [ 18;
                        enNumFamilia = enNumFamilia + 1;
                    |FINSI;

                    |SI nEdad = 25;  |Y eaMuerto ! "";
                        |SI eaMuerto = "T";  |Y enConta = 1;
                            nEdad    = (((#2#92 - #1#17) / 366) - 0.49) ! 0;
                        |FINSI;

                        |SI eaMuerto = "C";  |Y enConta = 2;
                            nEdad    = (((#2#92 - #1#17) / 366) - 0.49) ! 0;
                        |FINSI;
                    |FINSI;

                    nEdadAdop = 0;
                    |SI #1#18 ! "01.01.0000";
                        aAlfa     = #1#18 % -104;
                        nAnyo     = aAlfa;
                        nEdad1    = (((#1#18 - #1#17) / 366) - 0.49) ! 0;
                        nEdadAdop = 0;
                        |SI nEdad1 < 18;
                            nEdadAdop = (2012 - nAnyo) + 1;
                            |SI nEdadAdop > 3;  nEdadAdop = 0;  |FINSI;
                        |FINSI;
                    |FINSI;

                    |SI nEdad < 25;
                        |SI nEdad [ 17;  |O #1#8 = "2";
                            nSwConjunta = 1;

                            |SI eaMuerto = "T";  |Y #1#7 ! "1";
                                nSwConjuntaE = 1;
                            |FINSI;

                            |SI eaMuerto = "C";  |Y #1#7 ! "2";
                                nSwConjuntaE = 1;
                            |FINSI;
                        |FINSI;

                        |SI nImput ! 0;
                            |SI #1#21 ] "01.01.2012";
                                nTotalHF = nTotalHF + nImput;
                            |SINO;
                                nTHijos  = nTHijos  + 1;
                                |SI nTHijos = 1;  nTotalH1 = nTotalH1 + nImput;  |FINSI;
                                |SI nTHijos = 2;  nTotalH2 = nTotalH2 + nImput;  |FINSI;
                                |SI nTHijos = 3;  nTotalH3 = nTotalH3 + nImput;  |FINSI;
                                |SI nTHijos ] 4;  nTotalH4 = nTotalH4 + nImput;  |FINSI;
                            |FINSI;
                        |FINSI;
                    |SINO;
                        |SI #1#8 = "2";
                            nSwConjunta  = 1;

                            |SI eaMuerto = "T";  |Y #1#7 ! "1";
                                nSwConjuntaE = 1;
                            |FINSI;

                            |SI eaMuerto = "C";  |Y #1#7 ! "2";
                                nSwConjuntaE = 1;
                            |FINSI;
                        |FINSI;

                        |SI #1#6 ] 33;
                            |SI nImput ! 0;
                                |SI #1#21 ] "01.01.2012";
                                    nTotalHF = nTotalHF + nImput;
                                |SINO;
                                    nTHijos  = nTHijos  + 1;
                                    |SI nTHijos = 1;  nTotalH1 = nTotalH1 + nImput;  |FINSI;
                                    |SI nTHijos = 2;  nTotalH2 = nTotalH2 + nImput;  |FINSI;
                                    |SI nTHijos = 3;  nTotalH3 = nTotalH3 + nImput;  |FINSI;
                                    |SI nTHijos ] 4;  nTotalH4 = nTotalH4 + nImput;  |FINSI;
                                |FINSI;
                            |FINSI;
                        |FINSI;
                    |FINSI;

                    |SI #1#6 ] 65;
                        nHijosM65 = nHijosM65 + nImput;
                    |SINO;
                        |SI #1#6 ] 33;
                            nHijosM33 = nHijosM33 + nImput;
                            |SI #1#14 = "S";
                                nHijosM33D = nHijosM33D + nImput;
                            |FINSI;
                        |FINSI;
                    |FINSI;

                    |SI nEdad < 3;
                        nHijos3 = nHijos3  + nImput;
                    |SINO;
                        |SI nEdadAdop > 0;  |Y nEdadAdop [ 3;
                            nHijos3 = nHijos3  + nImput;
                        |SINO;
                            |SI nEdad < 16;
                                nHijos16 = nHijos16 + nImput;
                            |FINSI;
                        |FINSI;
                    |FINSI;
                |FINSI;
            |FINSI;

            |SI #1#4 = "ASCENDIENTE ";
                |SI #1#5 > 0;
                    nEdad   = 2012 - #1#5;

                    |SI nEdad ] 65;
                        nTAscen   = nTAscen   + nImput;
                    |SINO;
                        |SI #1#6 ] 65;
                            nAscenEM65 = nAscenEM65 + nImput;
                        |SINO;
                            |SI #1#6 ] 33;
                                nAscenEM33 = nAscenEM33 + nImput;
                                |SI #1#14 = "S";
                                    nAscenEM33D = nAscenEM33D + nImput;
                                |FINSI;
                            |FINSI;
                        |FINSI;
                    |FINSI;

                    |SI nEdad ] 75;
                        |SI #1#13 = "N";
                            nTAscen75 = nTAscen75 + nImput;
                        |SINO;
                            |ABRE #999;
                            |SELECT #3#999;
                            #999#2 = #1#3;
                            |LEE 040#999=;
                            |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;
                            |CIERRA #999;

                            |SI #999#1 = "1 FAMILIAR";
                                |SI nRentas3 < 8000;  nTAscen75 = nTAscen75 + nImput;  |FINSI;
                            |FINSI;

                            |SI #999#1 = "2 FAMILIAR";
                                |SI nRentas4 < 8000;  nTAscen75 = nTAscen75 + nImput;  |FINSI;
                            |FINSI;

                            |SI #999#1 = "3 FAMILIAR";
                                |SI nRentas5 < 8000;  nTAscen75 = nTAscen75 + nImput;  |FINSI;
                            |FINSI;

                            |SI #999#1 = "4 FAMILIAR";
                                |SI nRentas6 < 8000;  nTAscen75 = nTAscen75 + nImput;  |FINSI;
                            |FINSI;
                        |FINSI;
                    |FINSI;

                    |SI #1#6 ] 65;
                        nAscenM65 = nAscenM65 + nImput;
                    |SINO;
                        |SI #1#6 ] 33;
                            nAscenM33 = nAscenM33 + nImput;
                            |SI #1#14 = "S";
                                nAscenM33D = nAscenM33D + nImput;
                            |FINSI;
                        |FINSI;
                    |FINSI;
                |FINSI;
            |FINSI;

            |LEE 040#1s;
     |SIGUE;
     |CIERRA #1;
|FPRC;

|PROCESO EleGeneral;
     nEdadAdop  = 0;
     nTHijos    = 0;
     nHijos3    = 0;
     nHijos16   = 0;
     nHijosM33  = 0;
     nHijosM65  = 0;
     nHijosM33D = 0;
     nTAscen    = 0;
     nTAscen75  = 0;
     nAscenM33  = 0;
     nAscenEM33 = 0;
     nAscenM33D = 0;
     nAscenEM33D= 0;
     nAscenM65  = 0;
     nAscenEM65 = 0;
     nTotalH1   = 0;
     nTotalH2   = 0;
     nTotalH3   = 0;
     nTotalH4   = 0;
     nTotalHF   = 0;

     |SI #999#6 > 0;  |Y enConta < 7;
         #0#103 = 5151;

         |SI enConta = 1;  |O enConta = 2;
             |SI #999#6 [ 1947;
                 #0#103 = (N\ #0#103 + 918);
                 nMinFam_G = nMinFam_G + 918;
             |FINSI;

             |SI #999#6 [ 1937;
                 #0#103 = (N\ #0#103 + 1122);
                 nMinFam_G = nMinFam_G + 1122;
             |FINSI;

             |SI enConta = 1;  |Y eaMuerto = "C";
                 |SI #999#6 [ 1947;
                     nMinFamE_G = nMinFamE_G + 918;
                 |FINSI;

                 |SI #999#6 [ 1937;
                     nMinFamE_G = nMinFamE_G + 1122;
                 |FINSI;
             |FINSI;

             |SI enConta = 2;  |Y eaMuerto = "T";
                 |SI #999#6 [ 1947;
                     nMinFamE_G = nMinFamE_G + 918;
                 |FINSI;

                 |SI #999#6 [ 1937;
                     nMinFamE_G = nMinFamE_G + 1122;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI enConta = 1;  |O enConta = 2;  |O enConta = 7;  |O enConta = 8;
         nFamiliar = 0;
         |HAZ rem00101;
     |FINSI;

     |ABRE #999;
     |SELECT #2#999;
     #999#1 = #1001#2;
     |LEE 040#999=;
     |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;
     |CIERRA #999;

     nCodAutonomico = #2#11;
     |SI enConta = 2;         nCodAutonomico = #2#43;  |FINSI;
     |SI nCodAutonomico = 0; nCodAutonomico = #2#11;  |FINSI;

     #0#104 = (N\ 1836 * nTotalH1) +  (N\ 2040 * nTotalH2);
     #0#104 = (N\ #0#104) + (N\ 3672 * nTotalH3) + (N\ 4182 * nTotalH4);
     #0#104 = (N\ #0#104) + (N\ nTotalHF * 1836) + (N\ 2244 * nHijos3);

     |SI #999#6 > 0;  |Y enConta < 7;
         nEdad = 2012 - #999#6;
         |SI #999#5 = "S";
             |SI eaMuerto = "T";  fFechaNac = #2#103;  |FINSI;
             |SI eaMuerto = "C";  fFechaNac = #2#104;  |FINSI;

             aAlfa1 = efFechaMuerto; |QBF aAlfa1;
             aAlfa1 = (aAlfa1 % 0704); nAnyo1 = aAlfa1;
             aAlfa2 = fFechaNac;     |QBF aAlfa2;
             aAlfa2 = (aAlfa2 % 0704); nAnyo2 = aAlfa2;
             nEdad  = nAnyo1 - nAnyo2;

             aAlfa1 = efFechaMuerto; |QBF aAlfa1;
             aAlfa1 = (aAlfa1  % 0402) + (aAlfa1 % 0102);
             aAlfa2 = fFechaNac;     |QBF aAlfa2;
             aAlfa2 = (aAlfa2 % 0402) + (aAlfa2 % 0102);
             |SI aAlfa1 < aAlfa2; nEdad = nEdad - 1; |FINSI;
         |FINSI;

         |SI enConta = 1;  |O enConta = 2;
             #0#105  = (N\ #0#105 + (nTAscen * 918) + (nAscenEM65 * 918));
             #0#105  = (N\ #0#105 + (nAscenEM33 * 918) + (nTAscen75 * 1122));
         |FINSI;

         nCam105 = nCam105 + #0#105;

         nImporte = 0;
         |SI #999#3  ] 33;
             nImporte = 2316;
             |SI #999#4 = "S";
                 nImporte = nImporte + 2316;
             |FINSI;
         |FINSI;

         |SI #999#3  ] 65;
             nImporte = 7038;
             nImporte = nImporte + 2316;
         |FINSI;

         |SI eaMuerto = "T";  |Y enConta = 2;
             nCam106M = nCam106M + nImporte;
         |FINSI;

         |SI eaMuerto = "C";  |Y enConta = 1;
             nCam106M = nCam106M + nImporte;
         |FINSI;

         nImporte1 = 0;
         |SI enConta = 1;  |O enConta = 2;
             nImporte1  = nImporte1 + (nHijosM33  * 2316) + (nHijosM65 * 7038);
             nImporte1  = nImporte1 + (nAscenM33  * 2316) + (nAscenM65 * 7038);
             nImporte1  = nImporte1 + (nHijosM33D * 2316) + (nHijosM65 * 2316);
             nImporte1  = nImporte1 + (nAscenM33D * 2316) + (nAscenM65 * 2316);
         |FINSI;

         #0#106   = nImporte + nImporte1;

         |SI enConta = 1;  |O enConta = 2;
             nCam106  = nCam106  + #0#106;
             nCam106M = nCam106M + nImporte1;
         |FINSI;
     |FINSI;

     |SI enConta = 7;
         #0#103 = (N\ 5151 + nMinFam_G);
         #0#105 = nCam105;
         #0#106 = nCam106;
     |FINSI;

     |SI enConta = 8;
         #0#103 = (N\ 5151 + nMinFamE_G);
         #0#105 = nCam105;
         #0#106 = nCam106M;
     |FINSI;
|FPRC;

|PROCESO EleAutonomico;
     nEdadAdop  = 0;
     nTHijos    = 0;
     nHijos3    = 0;
     nHijos16   = 0;
     nHijosM33  = 0;
     nHijosM65  = 0;
     nHijosM33D = 0;
     nTAscen    = 0;
     nTAscen75  = 0;
     nAscenM33  = 0;
     nAscenEM33 = 0;
     nAscenM33D = 0;
     nAscenEM33D= 0;
     nAscenM65  = 0;
     nAscenEM65 = 0;
     nTotalH1   = 0;
     nTotalH2   = 0;
     nTotalH3   = 0;
     nTotalH4   = 0;
     nTotalHF   = 0;

     |SI #999#6 > 0;  |Y enConta < 7;
         #0#113 = 5151;

         |SI enConta = 1;  |O enConta = 2;
             |SI #999#6 [ 1947;
                 #0#113 = (N\ #0#113 + 918);
                 nMinFam_A = nMinFam_A + 918;
             |FINSI;

             |SI #999#6 [ 1937;
                 #0#113 = (N\ #0#113 + 1122);
                 nMinFam_A = nMinFam_A + 1122;
             |FINSI;

             |SI enConta = 1;  |Y eaMuerto = "C";
                 |SI #999#6 [ 1947;
                     nMinFamE_A = nMinFamE_A + 918;
                 |FINSI;

                 |SI #999#6 [ 1937;
                     nMinFamE_A = nMinFamE_A + 1122;
                 |FINSI;
             |FINSI;

             |SI enConta = 2;  |Y eaMuerto = "T";
                 |SI #999#6 [ 1947;
                     nMinFamE_A = nMinFamE_A + 918;
                 |FINSI;

                 |SI #999#6 [ 1937;
                     nMinFamE_A = nMinFamE_A + 1122;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI enConta = 1;  |O enConta = 2;  |O enConta = 7;  |O enConta = 8;
         nFamiliar = 0;
         |HAZ rem00101;
     |FINSI;

     |ABRE #999;
     |SELECT #2#999;
     #999#1 = #1001#2;
     |LEE 040#999=;
     |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;
     |CIERRA #999;

     nCodAutonomico = #2#11;
     |SI enConta = 2;         nCodAutonomico = #2#43;  |FINSI;
     |SI nCodAutonomico = 0; nCodAutonomico = #2#11;  |FINSI;

     nPartir3 = 3672;
     nPartir4 = 4182;
     |SI nCodAutonomico = 12;
         nPartir3 = 4039.20;
         nPartir4 = 4600.20;
     |FINSI;

     #0#114 = (N\ 1836 * nTotalH1) +  (N\ 2040 * nTotalH2);
     #0#114 = (N\ #0#114) + (N\ nPartir3 * nTotalH3) + (N\ nPartir4 * nTotalH4);
     #0#114 = (N\ #0#114) + (N\ nTotalHF * 1836) + (N\ 2244 * nHijos3);

     |SI #999#6 > 0;  |Y enConta < 7;
         nEdad = 2012 - #999#6;
         |SI #999#5 = "S";
             |SI eaMuerto = "T";  fFechaNac = #2#103;  |FINSI;
             |SI eaMuerto = "C";  fFechaNac = #2#104;  |FINSI;

             aAlfa1 = efFechaMuerto; |QBF aAlfa1;
             aAlfa1 = (aAlfa1 % 0704); nAnyo1 = aAlfa1;
             aAlfa2 = fFechaNac;     |QBF aAlfa2;
             aAlfa2 = (aAlfa2 % 0704); nAnyo2 = aAlfa2;
             nEdad  = nAnyo1 - nAnyo2;

             aAlfa1 = efFechaMuerto; |QBF aAlfa1;
             aAlfa1 = (aAlfa1  % 0402) + (aAlfa1 % 0102);
             aAlfa2 = fFechaNac;     |QBF aAlfa2;
             aAlfa2 = (aAlfa2 % 0402) + (aAlfa2 % 0102);
             |SI aAlfa1 < aAlfa2; nEdad = nEdad - 1; |FINSI;
         |FINSI;

         |SI enConta = 1;  |O enConta = 2;
             #0#115  = (N\ #0#115 + (nTAscen * 918) + (nAscenEM65 * 918));
             #0#115  = (N\ #0#115 + (nAscenEM33 * 918) + (nTAscen75 * 1122));
         |FINSI;

         nCam115 = nCam115 + #0#115;

         nImporte = 0;
         |SI #999#3  ] 33;
             nImporte = 2316;
             |SI #999#4 = "S";
                 nImporte = nImporte + 2316;
             |FINSI;
         |FINSI;

         |SI #999#3  ] 65;
             nImporte = 7038;
             nImporte = nImporte + 2316;
         |FINSI;

         |SI eaMuerto = "T";  |Y enConta = 2;
             nCam116M = nCam116M + nImporte;
         |FINSI;

         |SI eaMuerto = "C";  |Y enConta = 1;
             nCam116M = nCam116M + nImporte;
         |FINSI;

         nImporte1 = 0;
         |SI enConta = 1;  |O enConta = 2;
             nImporte1  = nImporte1 + (nHijosM33  * 2316) + (nHijosM65 * 7038);
             nImporte1  = nImporte1 + (nAscenM33  * 2316) + (nAscenM65 * 7038);
             nImporte1  = nImporte1 + (nHijosM33D * 2316) + (nHijosM65 * 2316);
             nImporte1  = nImporte1 + (nAscenM33D * 2316) + (nAscenM65 * 2316);
         |FINSI;

         #0#116   = nImporte + nImporte1;

         |SI enConta = 1;  |O enConta = 2;
             nCam116  = nCam116  + #0#116;
             nCam116M = nCam116M + nImporte1;
         |FINSI;
     |FINSI;

     |SI enConta = 7;
         #0#113 = (N\ 5151 + nMinFam_A);
         #0#115 = nCam115;
         #0#116 = nCam116;
     |FINSI;

     |SI enConta = 8;
         #0#113 = (N\ 5151 + nMinFamE_A);
         #0#115 = nCam115;
         #0#116 = nCam116M;
     |FINSI;
|FPRC;

|PROCESO CalculaL;
     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1033"#;  |FINSI;

     aDef    = eaPathDef + "rem00101.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |DESCARGA_DEF #datfic0@;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem00100.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |DESCARGA_DEF #datfic1@;
         |DESCARGA_DEF #datfic0@;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, datfic3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |DESCARGA_DEF #datfic2@;
         |DESCARGA_DEF #datfic1@;
         |DESCARGA_DEF #datfic0@;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic3@#"zdat1018"#;  |FINSI;

     |ABRE #999;
     |SELECT #2#999;
     #999#1 = #1001#2;
     |LEE 040#999=;
     |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;
     |CIERRA #999;

     |ABRE #2;
     #2#0 = #1001#0;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |GRABA 020#0b;
     |FINSI;

     |HAZ EleGeneral;
     |HAZ EleAutonomico;

     #0#107 = (N\ #0#103 + #0#104 + #0#105 + #0#106);
     #0#117 = (N\ #0#113 + #0#114 + #0#115 + #0#116);

     nValor1 = #0#77;
     nValor2 = #0#107;
     |SI nValor1 < 0;  nValor1 = 0;  |FINSI;

     |SI nValor1 = 0;
         #0#108 = 0;
     |SINO;
        #0#108 = nValor1;
        |SI nValor2 < nValor1;  #0#108 = nValor2;  |FINSI;
     |FINSI;

     nValor1 = #0#107 - #0#108;
     nValor2 = #0#81;

     #0#109 = nValor1;
     |SI nValor2 < nValor1;  #0#109 = nValor2;  |FINSI;

     nValor1 = #0#77;
     nValor2 = #0#117;
     |SI nValor1 < 0;  nValor1 = 0;  |FINSI;

     |SI nValor1 = 0;
         #0#118 = 0;
     |SINO;
        #0#118 = nValor1;
        |SI nValor2 < nValor1;  #0#118 = nValor2;  |FINSI;
     |FINSI;

     nValor1 = #0#117 - #0#118;
     nValor2 = #0#81;

     #0#119 = nValor1;
     |SI nValor2 < nValor1;  #0#119 = nValor2;  |FINSI;

     enSwAcum  = 0;
     enBloque  = 33;

     eaCasilla = "675";  enImporte = #0#103;   |HAZ GrabaLineal;
     eaCasilla = "676";  enImporte = #0#104;   |HAZ GrabaLineal;
     eaCasilla = "677";  enImporte = #0#105;   |HAZ GrabaLineal;
     eaCasilla = "678";  enImporte = #0#106;   |HAZ GrabaLineal;
     eaCasilla = "679";  enImporte = #0#107;   |HAZ GrabaLineal;

     eaCasilla = "635";  enImporte = #0#113;   |HAZ GrabaLineal;
     eaCasilla = "636";  enImporte = #0#114;   |HAZ GrabaLineal;
     eaCasilla = "637";  enImporte = #0#115;   |HAZ GrabaLineal;
     eaCasilla = "638";  enImporte = #0#116;   |HAZ GrabaLineal;
     eaCasilla = "639";  enImporte = #0#117;   |HAZ GrabaLineal;

     eaCasilla = "680";  enImporte = #0#108;  |HAZ GrabaLineal;
     eaCasilla = "681";  enImporte = #0#109;  |HAZ GrabaLineal;
     eaCasilla = "683";  enImporte = #0#118;  |HAZ GrabaLineal;
     eaCasilla = "684";  enImporte = #0#119;  |HAZ GrabaLineal;

     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;

     |DESCARGA_DEF #datfic3@;
     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO Estatal;
     |ABRE #402;
     #402#0 = nCodAutonomico;
     |LEE 040#402=;
     |SI FSalida ! 0;
         #402#0 = 0;
         |LEE 040#402=;
         |SI FSalida ! 0;  |DDEFECTO #402;  |FINSI;
     |FINSI;
     |CIERRA #402;

     |PARA nCampo4 = 81;  |SI nCampo4 ] 45;  |HACIENDO nCampo4 = nCampo4 - 4;
           |SI #402nCampo4 ! 0;
               nCampo1 = nCampo4 - 3;
               nCampo2 = nCampo4 - 2;
               |SI nLimite1 = 0;
                   nParte1 = #402nCampo2;
                   nResta1 = #402nCampo1;
                   nTipo1  = #402nCampo4;
               |SINO;
                   nLimite2 = #402nCampo1;
                   |SI nCuotaT [ nLimite1;  |Y nCuotaT > nLimite2;
                       nParte1 = #402nCampo2;
                       nResta1 = #402nCampo1;
                       nTipo1  = #402nCampo4;
                   |FINSI;
               |FINSI;
               nLimite1 = #402nCampo1;
           |FINSI;
     |SIGUE;

     |SI nCuotaT = 0;
         nParte1 = 0;
         nResta1 = 0;
         nTipo1  = #402#45;
     |FINSI;
|FPRC;

|PROCESO Autonomica;
     |ABRE #402;
     #402#0 = nCodAutonomico;
     |LEE 040#402=;
     |SI FSalida ! 0;
         #402#0 = 0;
         |LEE 040#402=;
         |SI FSalida ! 0;  |DDEFECTO #402;  |FINSI;
     |FINSI;
     |CIERRA #402;

     |PARA nCampo4 = 41;  |SI nCampo4 ] 5;  |HACIENDO nCampo4 = nCampo4 - 4;
           |SI #402nCampo4 ! 0;
               nCampo1 = nCampo4 - 3;
               nCampo2 = nCampo4 - 2;
               |SI nLimite1 = 0;
                   nParte2 = #402nCampo2;
                   nResta2 = #402nCampo1;
                   nTipo2  = #402nCampo4;
               |SINO;
                   nLimite2 = #402nCampo1;
                   |SI nCuotaT [ nLimite1;  |Y nCuotaT > nLimite2;
                       nParte2 = #402nCampo2;
                       nResta2 = #402nCampo1;
                       nTipo2  = #402nCampo4;
                   |FINSI;
               |FINSI;
               nLimite1 = #402nCampo1;
           |FINSI;
     |SIGUE;

     |SI nCuotaT = 0;
         nParte2 = 0;
         nResta2 = 0;
         nTipo2  = #402#5;
     |FINSI;
|FPRC;

|PROCESO Tabla;
     nParte1  = 0;
     nResta1  = 0;
     nTipo1   = 0;
     nParte2  = 0;
     nResta2  = 0;
     nTipo2   = 0;
     nLimite1 = 0;   |HAZ Estatal;
     nLimite1 = 0;   |HAZ Autonomica;
|FPRC;

|PROCESO TablaComp;
     nParte1  = 0;
     nResta1  = 0;
     nTipo1   = 0;
     nParte2  = 0;
     nResta2  = 0;
     nTipo2   = 0;
     nLimite1 = 0;   |HAZ Estatal;
|FPRC;

|PROCESO AplicaEscalaA687;
     nCuota1 = 0;
     nCuota2 = 0;
     nCuota3 = 0;
     nCuota4 = 0;

     enBloque = 34; eaCasilla = "688"; |HAZ SacaImporte; nAnuHijos     = enImporte;
     enBloque = 34; eaCasilla = "686"; |HAZ SacaImporte; nRentaExenta1 = enImporte;
     enBloque = 34; eaCasilla = "687"; |HAZ SacaImporte; nRentaExenta2 = enImporte;
     enBloque = 31; eaCasilla = "620"; |HAZ SacaImporte; nCuota        = enImporte + nRentaExenta2;
     |SI nCuota < 0;  nCuota = 0;  |FINSI;

     |SI nAnuHijos = 0;  |O nAnuHijos > nCuota;
         nCuotaT = nCuota;
         |HAZ Tabla;

         nCuota1   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
         |SI nCuota1 < 0;  nCuota1 = 0;  |FINSI;

         nCuota2   = (nParte2 + (((nCuotaT - nResta2) * nTipo2) / 100)) ! 2;
         |SI nCuota2 < 0;  nCuota2 = 0;  |FINSI;

         enBloque = 33; eaCasilla = "680"; |HAZ SacaImporte;
         nCuotaT  = enImporte;
         |HAZ Tabla;

         nCuota3   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
         |SI nCuota3 < 0;  nCuota3 = 0;  |FINSI;

         nCuota4   = (nParte2 + (((nCuotaT - nResta2) * nTipo2) / 100)) ! 2;
         |SI nCuota4 < 0;  nCuota4 = 0;  |FINSI;

         enSwAcum  = 0;
         enBloque  = 35;
         eaCasilla = "693";
         enImporte = nCuota1 - nCuota3;
         |HAZ GrabaLineal;

         enSwAcum  = 0;
         enBloque  = 36;
         eaCasilla = "694";
         enImporte = nCuota2 - nCuota4;
         |HAZ GrabaLineal;

         |SI nAnuHijos ! 0;
             enSwAcum   = 0;
             enBloque   = 34;
             eaCasilla  = "688";  enImporte  = 0;  |HAZ GrabaLineal;
         |FINSI;
         nAnuHijos = 0;
     |SINO;
         |SI nCuota = 0;  |ACABA; |FINSI;

         enImporte  = nAnuHijos;

         nCuotaT  = enImporte;
         |HAZ Tabla;

         nCuota1   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
         |SI nCuota1 < 0;  nCuota1 = 0;  |FINSI;

         nCuota2   = (nParte2 + (((nCuotaT - nResta2) * nTipo2) / 100)) ! 2;
         |SI nCuota2 < 0;  nCuota2 = 0;  |FINSI;

         nCuotaT  = nCuota - nAnuHijos;
         |HAZ Tabla;

         nCuota3   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
         |SI nCuota3 < 0;  nCuota3 = 0;  |FINSI;

         nCuota4   = (nParte2 + (((nCuotaT - nResta2) * nTipo2) / 100)) ! 2;
         |SI nCuota4 < 0;  nCuota4 = 0;  |FINSI;

         enBloque = 33; eaCasilla = "680"; |HAZ SacaImporte;
         nCuotaT  = enImporte + 1600;
         |HAZ Tabla;

         nCuota5   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
         |SI nCuota5 < 0;  nCuota5 = 0;  |FINSI;

         nCuota6   = (nParte2 + (((nCuotaT - nResta2) * nTipo2) / 100)) ! 2;
         |SI nCuota6 < 0;  nCuota6 = 0;  |FINSI;

         enSwAcum  = 0;
         enBloque  = 35;
         eaCasilla = "693";
         enImporte = nCuota1 + nCuota3 - nCuota5;
         |HAZ GrabaLineal;

         enSwAcum  = 0;
         enBloque  = 36;
         eaCasilla = "694";
         enImporte = nCuota2 + nCuota4 - nCuota6;
         |HAZ GrabaLineal;
     |FINSI;
|FPRC;

|PROCESO AplicaEscalaA620;
     enBloque = 34; eaCasilla = "688"; |HAZ SacaImporte; nAnuHijos    = enImporte;
     enBloque = 31; eaCasilla = "620"; |HAZ SacaImporte; nCuota       = enImporte;
     |SI nCuota < 0;  nCuota = 0;  |FINSI;

     |SI nAnuHijos = 0;  |O nAnuHijos > nCuota;
         nCuotaT = nCuota;

         |HAZ Tabla;

         |SI nCuota < 0;  nCuota = 0;  |FINSI;

         enSwAcum  = 0;
         enBloque  = 35;
         eaCasilla = "689";

         nValor2   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
         enImporte = nValor2;
         |HAZ GrabaLineal;

         enSwAcum  = 0;
         enBloque  = 36;
         eaCasilla = "690";

         nValor2   = (nParte2 + (((nCuotaT - nResta2) * nTipo2) / 100)) ! 2;
         enImporte = nValor2;
         |HAZ GrabaLineal;

         |SI nAnuHijos ! 0;
             enSwAcum   = 0;
             enBloque   = 34;
             eaCasilla  = "688"; enImporte  = 0;  |HAZ GrabaLineal;
         |FINSI;

         nAnuHijos = 0;
     |SINO;
         |SI nCuota = 0;  |ACABA; |FINSI;

         enImporte  = nAnuHijos;

         enSwAcum   = 0;
         enBloque   = 35;
         eaCasilla  = "689";
         enImporte  = nCuota - nAnuHijos;
         |SI enImporte < 0;  enImporte = 0;  |FINSI;
         |HAZ GrabaLineal;

         nCuota1   = enImporte;

         nCuota    = nAnuHijos;
         nCuotaT   = nAnuHijos;
         |HAZ Tabla;

         || Calcula Cuota Estatal 1 Base

         nValor1   = (nParte1 + (((nCuota - nResta1) * nTipo1) / 100)) ! 2;
         nVEstatal1 = nValor1 ! 2;

         || Calcula Cuota Autonomica 1 Base

         nValor1   = (nParte2 + (((nCuota - nResta2) * nTipo2) / 100)) ! 2;
         nVAutonom1 = nValor1 ! 2;

         || Calcula Cuota Estatal 2 Base

         nCuota   = nCuota1;
         nCuotaT  = nCuota1;
         |HAZ Tabla;

         nValor1  = (nParte1 + (((nCuota - nResta1) * nTipo1) / 100)) ! 2;
         nVEstatal2 = nValor1 ! 2;

         || Calcula Cuota Autonomica 2 Base

         nValor1   = (nParte2 + (((nCuota - nResta2) * nTipo2) / 100)) ! 2;
         nVAutonom2 = nValor1 ! 2;

         enSwAcum   = 0;
         enBloque   = 35;
         eaCasilla  = "689";
         enImporte  = (nVEstatal1 + nVEstatal2) ! 2;
         |HAZ GrabaLineal;

         enSwAcum   = 0;
         enBloque   = 36;
         eaCasilla  = "690";
         enImporte  = (nVAutonom1 + nVAutonom2) ! 2;
         |HAZ GrabaLineal;
     |FINSI;
|FPRC;

|PROCESO AplicaEscalaA620Comp;
     nGuarda        = nCodAutonomico;
     nCodAutonomico = 90;

     enBloque = 34; eaCasilla = "688"; |HAZ SacaImporte; nAnuHijos    = enImporte;
     enBloque = 31; eaCasilla = "620"; |HAZ SacaImporte; nCuota       = enImporte;
     |SI nCuota < 0;  nCuota = 0;  |FINSI;

     |SI nAnuHijos = 0;  |O nAnuHijos > nCuota;
         nCuotaT = nCuota;

         |HAZ TablaComp;

         |SI nCuota < 0;  nCuota = 0;  |FINSI;

         enSwAcum  = 0;
         enBloque  = 35;
         eaCasilla = "624";

         nValor2   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
         enImporte = nValor2;
         |HAZ GrabaLineal;
     |SINO;
         |SI nCuota = 0;  |ACABA; |FINSI;

         enImporte  = nAnuHijos;

         enSwAcum   = 0;
         enBloque   = 35;
         eaCasilla  = "624";
         enImporte  = nCuota - nAnuHijos;
         |SI enImporte < 0;  enImporte = 0;  |FINSI;
         |HAZ GrabaLineal;

         nCuota1   = enImporte;

         nCuota    = nAnuHijos;
         nCuotaT   = nAnuHijos;
         |HAZ TablaComp;

         || Calcula Cuota Estatal 1 Base

         nValor1   = (nParte1 + (((nCuota - nResta1) * nTipo1) / 100)) ! 2;
         nVEstatal1 = nValor1 ! 2;

         || Calcula Cuota Autonomica 1 Base

         nValor1   = (nParte2 + (((nCuota - nResta2) * nTipo2) / 100)) ! 2;
         nVAutonom1 = nValor1 ! 2;

         || Calcula Cuota Estatal 2 Base

         nCuota   = nCuota1;
         nCuotaT  = nCuota1;
         |HAZ TablaComp;

         nValor1  = (nParte1 + (((nCuota - nResta1) * nTipo1) / 100)) ! 2;
         nVEstatal2 = nValor1 ! 2;

         || Calcula Cuota Autonomica 2 Base

         nValor1   = (nParte2 + (((nCuota - nResta2) * nTipo2) / 100)) ! 2;
         nVAutonom2 = nValor1 ! 2;

         enSwAcum   = 0;
         enBloque   = 35;
         eaCasilla  = "624";
         enImporte  = (nVEstatal1 + nVEstatal2) ! 2;
         |HAZ GrabaLineal;
     |FINSI;

     nCodAutonomico = nGuarda;
|FPRC;

|PROCESO AplicaEscalaA680;
     enBloque = 34; eaCasilla = "688"; |HAZ SacaImporte; nAnuHijos    = enImporte;
     enBloque = 33; eaCasilla = "680"; |HAZ SacaImporte; nCuota       = enImporte;
     enBloque = 31; eaCasilla = "620"; |HAZ SacaImporte; nCuota2      = enImporte;

     |SI nCuota  < 0;  nCuota = 0;  |FINSI;
     |SI nCuota2 < 0;  nCuota2 = 0;  |FINSI;

     |SI nAnuHijos = 0;  |O nAnuHijos > nCuota2;
         nCuotaT = nCuota;
     |SINO;
         nCuotaT = nCuota + 1600;
     |FINSI;

     |HAZ Tabla;

     |SI nCuota < 0;  nCuota = 0;  |FINSI;

     enSwAcum  = 0;
     enBloque  = 35;
     eaCasilla = "691";

     nValor2   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
     enImporte = nValor2;
     |HAZ GrabaLineal;
|FPRC;

|PROCESO AplicaEscalaA680Comp;
     nGuarda        = nCodAutonomico;
     nCodAutonomico = 90;

     enBloque = 34; eaCasilla = "688"; |HAZ SacaImporte; nAnuHijos    = enImporte;
     enBloque = 33; eaCasilla = "680"; |HAZ SacaImporte; nCuota       = enImporte;
     enBloque = 31; eaCasilla = "620"; |HAZ SacaImporte; nCuota2      = enImporte;

     |SI nCuota  < 0;  nCuota = 0;  |FINSI;
     |SI nCuota2 < 0;  nCuota2 = 0;  |FINSI;

     |SI nAnuHijos = 0;  |O nAnuHijos > nCuota2;
         nCuotaT = nCuota;
     |SINO;
         nCuotaT = nCuota + 1600;
     |FINSI;

     |HAZ TablaComp;

     |SI nCuota < 0;  nCuota = 0;  |FINSI;

     enSwAcum  = 0;
     enBloque  = 35;
     eaCasilla = "625";

     nValor2   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
     enImporte = nValor2;
     |HAZ GrabaLineal;

     nCodAutonomico = nGuarda;
|FPRC;

|PROCESO AplicaEscalaA683;
     enBloque = 34; eaCasilla = "688"; |HAZ SacaImporte; nAnuHijos    = enImporte;
     enBloque = 33; eaCasilla = "683"; |HAZ SacaImporte; nCuota       = enImporte;
     enBloque = 31; eaCasilla = "620"; |HAZ SacaImporte; nCuota2      = enImporte;

     |SI nCuota  < 0;  nCuota = 0;   |FINSI;
     |SI nCuota2 < 0;  nCuota2 = 0;  |FINSI;

     |SI nAnuHijos = 0;  |O nAnuHijos > nCuota2;
         nCuotaT = nCuota;
     |SINO;
         nCuotaT = nCuota + 1600;
     |FINSI;

     |HAZ Tabla;

     |SI nCuota < 0;  nCuota = 0;  |FINSI;

     enSwAcum  = 0;
     enBloque  = 36;
     eaCasilla = "692";

     nValor2   = (nParte2 + (((nCuotaT - nResta2) * nTipo2) / 100)) ! 2;
     enImporte = nValor2;
     |HAZ GrabaLineal;
|FPRC;

|PROCESO AplicaEscalaA695;
     nGuarda        = nCodAutonomico;
     nCodAutonomico = 91;

     nCuotaT =  nBaseEsp1;
     |SI nCuotaT < 0;  nCuotaT = 0;  |FINSI;

     |HAZ TablaComp;

     |SI nCuota < 0;  nCuota = 0;  |FINSI;

     enSwAcum  = 0;
     enBloque  = 35;
     eaCasilla = "629";

     nValor2   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
     enImporte = nValor2;
     |HAZ GrabaLineal;

     nCodAutonomico = nGuarda;
|FPRC;

|PROCESO FicticiaExenta;
     enBloque = 34; eaCasilla = "688"; |HAZ SacaImporte; nAnuHijos    = enImporte;
     enBloque = 31; eaCasilla = "620"; |HAZ SacaImporte; nCuota       = enImporte;
     nCuota   = nCuota + (#1#29 - #1#30);

     nCuota1 = 0;
     nCuota2 = 0;
     nCuota3 = 0;
     nCuota4 = 0;

     |SI nCuota < 0;  nCuota = 0;  |FINSI;

     |SI nAnuHijos = 0;  |O nAnuHijos > nCuota;
         nCuotaT = nCuota;
         |HAZ Tabla;

         nCuota1   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
         |SI nCuota1 < 0;  nCuota1 = 0;  |FINSI;

         nCuota2   = (nParte2 + (((nCuotaT - nResta2) * nTipo2) / 100)) ! 2;
         |SI nCuota2 < 0;  nCuota2 = 0;  |FINSI;

         enBloque = 33; eaCasilla = "680"; |HAZ SacaImporte;
         nCuotaT  = enImporte;
         |HAZ Tabla;

         nCuota3   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
         |SI nCuota3 < 0;  nCuota3 = 0;  |FINSI;

         nCuota4   = (nParte2 + (((nCuotaT - nResta2) * nTipo2) / 100)) ! 2;
         |SI nCuota4 < 0;  nCuota4 = 0;  |FINSI;

         nImporte1 = nCuota1 - nCuota3;
         nImporte2 = nCuota2 - nCuota4;

         nAnuHijos = 0;
     |SINO;
         |SI nCuota = 0;  |ACABA; |FINSI;

         nCuotaT  = nAnuHijos;
         |HAZ Tabla;

         nCuota1   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
         |SI nCuota1 < 0;  nCuota1 = 0;  |FINSI;

         nCuota2   = (nParte2 + (((nCuotaT - nResta2) * nTipo2) / 100)) ! 2;
         |SI nCuota2 < 0;  nCuota2 = 0;  |FINSI;

         nCuotaT  = nCuota - nAnuHijos;
         |HAZ Tabla;

         nCuota3   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
         |SI nCuota3 < 0;  nCuota3 = 0;  |FINSI;

         nCuota4   = (nParte2 + (((nCuotaT - nResta2) * nTipo2) / 100)) ! 2;
         |SI nCuota4 < 0;  nCuota4 = 0;  |FINSI;

         enBloque = 33; eaCasilla = "680"; |HAZ SacaImporte;
         nCuotaT  = enImporte + 1600;
         |HAZ Tabla;

         nCuota5   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
         |SI nCuota5 < 0;  nCuota5 = 0;  |FINSI;

         nCuota6   = (nParte2 + (((nCuotaT - nResta2) * nTipo2) / 100)) ! 2;
         |SI nCuota6 < 0;  nCuota6 = 0;  |FINSI;

         nImporte1 = nCuota1 + nCuota3 - nCuota5;
         nImporte2 = nCuota2 + nCuota4 - nCuota6;
     |FINSI;
|FPRC;

|PROCESO FicticiaExentaComp;
     nGuarda        = nCodAutonomico;
     nCodAutonomico = 90;

     enBloque = 34; eaCasilla = "688"; |HAZ SacaImporte; nAnuHijos    = enImporte;
     enBloque = 31; eaCasilla = "620"; |HAZ SacaImporte; nCuota       = enImporte;
     nCuota   = nCuota + (#1#29 - #1#30);

     nCuota1 = 0;
     nCuota2 = 0;
     nCuota3 = 0;
     nCuota4 = 0;

     |SI nCuota < 0;  nCuota = 0;  |FINSI;

     |SI nAnuHijos = 0;  |O nAnuHijos > nCuota;
         nCuotaT = nCuota;
         |HAZ TablaComp;

         nCuota1   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
         |SI nCuota1 < 0;  nCuota1 = 0;  |FINSI;

         nCuota2   = (nParte2 + (((nCuotaT - nResta2) * nTipo2) / 100)) ! 2;
         |SI nCuota2 < 0;  nCuota2 = 0;  |FINSI;

         enBloque = 33; eaCasilla = "680"; |HAZ SacaImporte;
         nCuotaT  = enImporte;
         |HAZ TablaComp;

         nCuota3   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
         |SI nCuota3 < 0;  nCuota3 = 0;  |FINSI;

         nCuota4   = (nParte2 + (((nCuotaT - nResta2) * nTipo2) / 100)) ! 2;
         |SI nCuota4 < 0;  nCuota4 = 0;  |FINSI;

         nImporte3 = nCuota1 - nCuota3;
         nImporte4 = nCuota2 - nCuota4;

         nAnuHijos = 0;
     |SINO;
         |SI nCuota = 0;  |ACABA; |FINSI;

         nCuotaT  = nAnuHijos;
         |HAZ TablaComp;

         nCuota1   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
         |SI nCuota1 < 0;  nCuota1 = 0;  |FINSI;

         nCuota2   = (nParte2 + (((nCuotaT - nResta2) * nTipo2) / 100)) ! 2;
         |SI nCuota2 < 0;  nCuota2 = 0;  |FINSI;

         nCuotaT  = nCuota - nAnuHijos;
         |HAZ TablaComp;

         nCuota3   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
         |SI nCuota3 < 0;  nCuota3 = 0;  |FINSI;

         nCuota4   = (nParte2 + (((nCuotaT - nResta2) * nTipo2) / 100)) ! 2;
         |SI nCuota4 < 0;  nCuota4 = 0;  |FINSI;

         enBloque = 33; eaCasilla = "680"; |HAZ SacaImporte;
         nCuotaT  = enImporte + 1600;
         |HAZ TablaComp;

         nCuota5   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
         |SI nCuota5 < 0;  nCuota5 = 0;  |FINSI;

         nCuota6   = (nParte2 + (((nCuotaT - nResta2) * nTipo2) / 100)) ! 2;
         |SI nCuota6 < 0;  nCuota6 = 0;  |FINSI;

         nImporte3 = nCuota1 + nCuota3 - nCuota5;
         nImporte4 = nCuota2 + nCuota4 - nCuota6;
     |FINSI;

     nCodAutonomico = nGuarda;
|FPRC;

|PROCESO FicticiaNoExenta;
     enBloque = 34; eaCasilla = "688"; |HAZ SacaImporte; nAnuHijos    = enImporte;
     enBloque = 31; eaCasilla = "620"; |HAZ SacaImporte; nCuota       = enImporte;
     nCuota   = nCuota + (#1#29 - #1#30);

     |SI nCuota < 0;  nCuota = 0;  |FINSI;

     |SI nAnuHijos = 0;  |O nAnuHijos > nCuota;
         nCuotaT = nCuota;
         |HAZ Tabla;

         |SI nCuota < 0;  nCuota = 0;  |FINSI;

         nImporte1 = 0;

         nValor2   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
         nImporte1 = nValor2;

         nImporte2 = 0;
         nValor2   = (nParte2 + (((nCuotaT - nResta2) * nTipo2) / 100)) ! 2;
         nImporte2 = nValor2;

         nAnuHijos = 0;
     |SINO;
         |SI nCuota = 0;  |ACABA; |FINSI;

         nImporte1  = nCuota - nAnuHijos;
         |SI nImporte1 < 0;  nImporte1 = 0;  |FINSI;

         nCuota1   = nImporte1;

         nCuota    = nAnuHijos;
         nCuotaT   = nCuota;
         |HAZ Tabla;

         || Calcula Cuota Estatal 1 Base

         nValor1    = (nParte1 + (((nCuota - nResta1) * nTipo1) / 100)) ! 2;
         nVEstatal1 = nValor1 ! 2;

         || Calcula Cuota Autonomica 1 Base

         nValor1    = (nParte2 + (((nCuota - nResta2) * nTipo2) / 100)) ! 2;
         nVAutonom1 = nValor1 ! 2;

         || Calcula Cuota Estatal 2 Base

         nCuota   = nCuota1;
         nCuotaT  = nCuota1;
         |HAZ Tabla;

         nValor1    = (nParte1 + (((nCuota - nResta1) * nTipo1) / 100)) ! 2;
         nVEstatal2 = nValor1 ! 2;

         || Calcula Cuota Autonomica 2 Base

         nValor1    = (nParte2 + (((nCuota - nResta2) * nTipo2) / 100)) ! 2;
         nVAutonom2 = nValor1 ! 2;

         nImporte1  = (nVEstatal1 + nVEstatal2) ! 2;
         nImporte2  = (nVAutonom1 + nVAutonom2) ! 2;
     |FINSI;
|FPRC;

|PROCESO FicticiaNoExentaComp;
     nGuarda        = nCodAutonomico;
     nCodAutonomico = 90;

     enBloque = 34; eaCasilla = "688"; |HAZ SacaImporte; nAnuHijos    = enImporte;
     enBloque = 31; eaCasilla = "620"; |HAZ SacaImporte; nCuota       = enImporte;
     nCuota   = nCuota + (#1#29 - #1#30);

     |SI nCuota < 0;  nCuota = 0;  |FINSI;

     |SI nAnuHijos = 0;  |O nAnuHijos > nCuota;
         nCuotaT = nCuota;
         |HAZ TablaComp;

         |SI nCuota < 0;  nCuota = 0;  |FINSI;

         nImporte3 = 0;

         nValor2   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
         nImporte3 = nValor2;

         nImporte4 = 0;
         nValor2   = (nParte2 + (((nCuotaT - nResta2) * nTipo2) / 100)) ! 2;
         nImporte4 = nValor2;

         nAnuHijos = 0;
     |SINO;
         |SI nCuota = 0;  |ACABA; |FINSI;

         nImporte3  = nCuota - nAnuHijos;
         |SI nImporte3 < 0;  nImporte3 = 0;  |FINSI;

         nCuota1   = nImporte3;

         nCuota    = nAnuHijos;
         nCuotaT   = nCuota;
         |HAZ TablaComp;

         || Calcula Cuota Estatal 1 Base

         nValor1    = (nParte1 + (((nCuota - nResta1) * nTipo1) / 100)) ! 2;
         nVEstatal1 = nValor1 ! 2;

         || Calcula Cuota Autonomica 1 Base

         nValor1    = (nParte2 + (((nCuota - nResta2) * nTipo2) / 100)) ! 2;
         nVAutonom1 = nValor1 ! 2;

         || Calcula Cuota Estatal 2 Base

         nCuota   = nCuota1;
         nCuotaT  = nCuota1;
         |HAZ TablaComp;

         nValor1    = (nParte1 + (((nCuota - nResta1) * nTipo1) / 100)) ! 2;
         nVEstatal2 = nValor1 ! 2;

         || Calcula Cuota Autonomica 2 Base

         nValor1    = (nParte2 + (((nCuota - nResta2) * nTipo2) / 100)) ! 2;
         nVAutonom2 = nValor1 ! 2;

         nImporte3  = (nVEstatal1 + nVEstatal2) ! 2;
         nImporte4  = (nVAutonom1 + nVAutonom2) ! 2;
     |FINSI;

     nCodAutonomico = nGuarda;
|FPRC;

|PROCESO AplicaEscalaFicticia;
     nImporte1 = 0;
     nImporte2 = 0;
     nImporte3 = 0;
     nImporte4 = 0;

     enBloque = 34; eaCasilla = "686"; |HAZ SacaImporte; nRentaExenta1 = enImporte;
     enBloque = 34; eaCasilla = "687"; |HAZ SacaImporte; nRentaExenta2 = enImporte;
     |SI nRentaExenta2 ! 0;
         |HAZ FicticiaExenta;
         |HAZ FicticiaExentaComp;
     |SINO;
         |HAZ FicticiaNoExenta;
         |HAZ FicticiaNoExentaComp;
     |FINSI;
|FPRC;

|PROCESO GravamenAhorroNormal;
     enSwAcum   = 0;
     |SI #0#94 = "N";
         |SI nBaseEsp1 [ 6000;
             enImporte = nBaseEsp1 % 9.50;
         |SINO;
             enImporte = (6000 % 9.50) + ((nBaseEsp1 - 6000) % 10.5);
         |FINSI;

         enBloque   = 35;
         eaCasilla  = "628";
         |HAZ GrabaLineal;

         |SI nBaseEsp2 [ 6000;
             enImporte = nBaseEsp2 % 9.5;
         |SINO;
             enImporte = (6000 % 9.5) + ((nBaseEsp2 - 6000) % 10.5);
         |FINSI;

         enBloque   = 36;
         eaCasilla  = "697";  |HAZ GrabaLineal;
         eaCasilla  = "738";  |HAZ GrabaLineal;

         |HAZ AplicaEscalaA695;

         nValor = 0;
         enBloque = 35; eaCasilla = "628"; |HAZ SacaImporte; nValor = enImporte;
         enBloque = 35; eaCasilla = "629"; |HAZ SacaImporte; nValor = nValor + enImporte;
         |SI nValor < 0;  nValor = 0;  |FINSI;

         enSwAcum   = 0;
         enBloque   = 35;
         eaCasilla  = "696";
         enImporte  = nValor;
         |HAZ GrabaLineal;

     |SINO;
         nBaseEsp1 = nBaseEsp1 + nBaseEsp2;

         |SI nBaseEsp1 [ 6000;
             enImporte = nBaseEsp1 % 19;
         |SINO;
             enImporte = (6000 % 19) + ((nBaseEsp1 - 6000) % 21);
         |FINSI;

         enBloque   = 35;
         eaCasilla  = "628";
         |HAZ GrabaLineal;

         |HAZ AplicaEscalaA695;

         nValor = 0;
         enBloque = 35; eaCasilla = "628"; |HAZ SacaImporte; nValor = enImporte;
         enBloque = 35; eaCasilla = "629"; |HAZ SacaImporte; nValor = nValor + enImporte;
         |SI nValor < 0;  nValor = 0;  |FINSI;

         enSwAcum   = 0;
         enBloque   = 35;
         eaCasilla  = "696";
         enImporte  = nValor;
         |HAZ GrabaLineal;
     |FINSI;
|FPRC;

|PROCESO GravamenAhorroEspecial;
     enBloque = 32; eaCasilla = "630"; |HAZ SacaImporte; nValor1 = enImporte;

     nSuma = nValor1 + nRentaExenta1 - n681;
     |SI nSuma [ 0;  |ACABA;  |FINSI;

     enSwAcum   = 0;
     nCuota1    = 0;
     nCuota2    = 0;
     |SI #0#94 = "N";
         |SI nSuma [ 6000;
             nCuota1 = nSuma % 9.50;
         |SINO;
             nCuota1 = (6000 % 9.50) + ((nSuma - 6000) % 10.5);
         |FINSI;

         nCuota2 = nCuota1;
     |SINO;
         |SI nSuma [ 6000;
             nCuota1 = nSuma % 19;
         |SINO;
             nCuota1 = (6000 % 19) + ((nSuma - 6000) % 21);
         |FINSI;
     |FINSI;

     nTipo1 = (((nCuota1 * 100) / (nValor1 + nRentaExenta1)) - 0.0049) ! 2;
     nTipo2 = (((nCuota2 * 100) / (nValor1 + nRentaExenta1)) - 0.0049) ! 2;

     enBloque   = 35;
     eaCasilla  = "628";
     enImporte  = ((nValor1 * nTipo1) / 100) ! 2;
     |HAZ GrabaLineal;

     enImporte  = ((nValor1 * nTipo2) / 100) ! 2;
     enBloque   = 36;
     eaCasilla  = "697";  |HAZ GrabaLineal;
     eaCasilla  = "738";  |HAZ GrabaLineal;

     nBaseEsp1  = nSuma;
     |HAZ AplicaEscalaA695;

     nValor = 0;
     enBloque = 35; eaCasilla = "628"; |HAZ SacaImporte; nValor = enImporte;
     enBloque = 35; eaCasilla = "629"; |HAZ SacaImporte; nValor = nValor + enImporte;
     |SI nValor < 0;  nValor = 0;  |FINSI;

     enSwAcum   = 0;
     enBloque   = 35;
     eaCasilla  = "696";
     enImporte  = nValor;
     |HAZ GrabaLineal;
|FPRC;

|PROCESO GravamenAhorro;
     aDef    = eaPathDef + "rem00100.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     |LEE 040#0=;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
     |CIERRA #0;

     enSwAcum   = 0;
     enImporte  = 0;
     enBloque   = 35;
     eaCasilla  = "628";  |HAZ GrabaLineal;
     eaCasilla  = "629";  |HAZ GrabaLineal;
     eaCasilla  = "696";  |HAZ GrabaLineal;

     enBloque   = 36;
     eaCasilla  = "697";  |HAZ GrabaLineal;
     eaCasilla  = "738";  |HAZ GrabaLineal;

     enBloque = 33; eaCasilla = "681"; |HAZ SacaImporte; n681      = enImporte;
     enBloque = 35; eaCasilla = "695"; |HAZ SacaImporte; nBaseEsp1 = enImporte;
     enBloque = 36; eaCasilla = "771"; |HAZ SacaImporte; nBaseEsp2 = enImporte;

     |SI nRentaExenta1 ! 0;
         |SI n681 > 0;
             |HAZ GravamenAhorroEspecial;
         |SINO;
             |HAZ GravamenAhorroNormal;
         |FINSI;
     |SINO;
         |HAZ GravamenAhorroNormal;
     |FINSI;

     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO Ajusta1;
     |SI nAjuste = 0;  |ACABA;  |FINSI;

     nAcumLimite = nAcumLimite + nAjuste;
     |SI nLimite < nAcumLimite;
         nAjuste     = nAjuste - (nAcumLimite - nLimite);
         nAcumLimite = nLimite;
     |FINSI;
|FPRC;

|PROCESO Donaciones;
     enBloque = 31;  eaCasilla = "618"; |HAZ SacaImporte; nCuota = enImporte;
     enBloque = 32;  eaCasilla = "630"; |HAZ SacaImporte; nCuota = nCuota + enImporte;

     nAjuste10 = nCuota % 10;
     nAjuste15 = nCuota % 15;

     |SI #0#38 < 0;  #0#38 = 0;  |FINSI;
     |SI #0#40 < 0;  #0#40 = 0;  |FINSI;

     nValor    = #0#34;
     |SI nValor > nAjuste10;  |Y nValor > 0;
         #0#34 = nAjuste10;
         #0#35 = (N\ #0#34 % 15);
     |FINSI;

     #0#36 = (N\ #0#35 % 50);
     #0#37 = (N\ #0#35 - #0#36);

     nValor    = #0#38;
     |SI nValor > nAjuste15;  |Y nValor > 0;
         #0#38 = nAjuste15;
         |SI #0#38 < 0;  #0#38 = 0;  |FINSI;

         #0#39 = (N\ #0#38 % 30);
     |FINSI;

     nAjuste10 = (nCuota % 10) - #0#38;
     |SI nAjuste10 < 0;  nAjuste10 = 0;  |FINSI;

     nExceso  = nAjuste10;

     nValor25 = #0#77;
     nExceso  = nExceso - #0#77;
     |SI nExceso [ 0;
         nValor25 = #0#77 + nExceso;
         nExceso  = 0;
     |FINSI;

     nValor10 = #0#78;
     nExceso = nExceso - #0#78;
     |SI nExceso [ 0;
         nValor10 = #0#78 + nExceso;
         nExceso = 0;
     |FINSI;

     #0#40 = (N\ nValor10 + nValor25);
     |SI #0#40 < 0;  #0#40 = 0;  |FINSI;

     #0#41 = (N\ ((nValor10 % 10) + (nValor25 % 25)) ! 2);
     |SI #0#41 < 0;  #0#41 = 0;  |FINSI;

     #0#42 = 0;
     #0#43 = 0;

     nValor = (N\ (#0#39 + #0#41));
     |SI nValor > 0;
         #0#42 = (N\ (#0#39 + #0#41) % 50);
         #0#43 = (N\ (#0#39 + #0#41) - #0#42);
     |FINSI;
|FPRC;

|PROCESO Anexo1Punto1;
     nAcumLimite = 0;

     nLimite = 9040;
     nTope   = nLimite / 2;

     nAjuste = #0#63;  |HAZ Ajusta1;  #0#63  = nAjuste;
     nAjuste = #0#64;  |HAZ Ajusta1;  #0#64  = nAjuste;
     nAjuste = #0#65;  |HAZ Ajusta1;  #0#65  = nAjuste;
     nAjuste = #0#66;  |HAZ Ajusta1;  #0#66  = nAjuste;
     nAjuste = #0#164; |HAZ Ajusta1;  #0#164 = nAjuste;
     nAjuste = #0#79;  |HAZ Ajusta1;  #0#79  = nAjuste;

     nAjuste  = #0#63 + #0#64 + #0#65;
     nAjuste2 = 0;
     |SI nAjuste > nTope;
         nAjuste2 = nAjuste - nTope;
         nAjuste  = nTope;
     |FINSI;

     nPorce1 = 7.5;
     nPorce2 = 7.5;
     nPorce3 = 7.5;
     nPorce4 = 7.5;

     |SI #0#31 < "30.07.2011";
         |SI nCatalunyaA ! 0;
             |SI enConta = 1;  |Y eaMuerto = "T";  |Y efFechaMuerto < "30.07.2011";
                 nPorce2 =  6;  nPorce4 =  6;
             |FINSI;
             |SI enConta = 2;  |Y eaMuerto = "C";  |Y efFechaMuerto < "30.07.2011";
                 nPorce2 =  6;  nPorce4 =  6;
             |FINSI;
         |FINSI;

         |SI nCatalunyaB ! 0;  nPorce2 =  9;  nPorce4 =  9;  |FINSI;
     |FINSI;

     nValor1 = ((nAjuste % nPorce1) + (nAjuste2 % nPorce3)) ! 2;
     nValor2 = ((nAjuste % nPorce2) + (nAjuste2 % nPorce4)) ! 2;
     #0#3    = nAjuste + nAjuste2;
     #0#4    = nValor1;
     #0#5    = nValor2;

     nAjuste  = #0#66;
     nAjuste2 = 0;
     nLimitee = nTope - #0#63 - #0#64 - #0#65;
     |SI nLimitee < 0;
         nLimitee = 0;
     |FINSI;

     |SI #0#66 > nLimitee;
         nAjuste  = nLimitee;
         nAjuste2 = #0#66 - nLimitee;
     |FINSI;

     nValor1 = ((nAjuste % nPorce1) + (nAjuste2 % nPorce3)) ! 2;
     nValor2 = ((nAjuste % nPorce2) + (nAjuste2 % nPorce4)) ! 2;
     #0#6    = nAjuste + nAjuste2;
     #0#7    = nValor1;
     #0#8    = nValor2;

     nAjuste  = #0#164;
     nAjuste2 = 0;
     nLimitee = nTope - #0#63 - #0#64 - #0#65 - #0#66;
     |SI nLimitee < 0;  nLimitee = 0;  |FINSI;

     |SI #0#164 > nLimitee;
         nAjuste  = nLimitee;
         nAjuste2 = #0#164 - nLimitee;
     |FINSI;

     nValor1 = ((nAjuste % nPorce1) + (nAjuste2 % nPorce3)) ! 2;
     nValor2 = ((nAjuste % nPorce2) + (nAjuste2 % nPorce4)) ! 2;
     #0#9    = nAjuste + nAjuste2;
     #0#10   = nValor1;
     #0#11   = nValor2;

     nAjuste  = #0#79;
     nAjuste2 = 0;
     nLimitee = nTope - #0#63 - #0#64 - #0#65 - #0#66 + #0#164;
     |SI nLimitee < 0;
         nLimitee = 0;
     |FINSI;

     |SI #0#79 > nLimitee;
         nAjuste  = nLimitee;
         nAjuste2 = #0#79 - nLimitee;
     |FINSI;

     nValor1 = ((nAjuste % nPorce1) + (nAjuste2 % nPorce3)) ! 2;
     nValor2 = ((nAjuste % nPorce2) + (nAjuste2 % nPorce4)) ! 2;
     #0#114  = nAjuste + nAjuste2;
     #0#115  = nValor1;
     #0#116  = nValor2;
|FPRC;

|PROCESO Anexo1Punto2;
     nAcumLimite = 0;

     nLimite = 12080;
     nTope   = nLimite / 2;

     nAjuste = #0#67;  |HAZ Ajusta1;  #0#67 = nAjuste;
     nAjuste = #0#68;  |HAZ Ajusta1;  #0#68 = nAjuste;
     nAjuste = #0#69;  |HAZ Ajusta1;  #0#69 = nAjuste;

     nAjuste  = #0#67 + #0#68 + #0#69;
     nAjuste2 = 0;
     |SI nAjuste > nTope;
         nAjuste2 = nAjuste - nTope;
         nAjuste  = nTope;
     |FINSI;

     nPorce1 = 10;
     nPorce2 = 10;
     nPorce3 = 10;
     nPorce4 = 10;

     |SI #0#31 < "30.07.2011";
         |SI nCatalunyaA ! 0;  nPorce2 =  15;  nPorce4 = 15;  |FINSI;
         |SI nCatalunyaB ! 0;  nPorce2 =  15;  nPorce4 = 15;  |FINSI;
     |SINO;
         |SI nCatalunyaA ! 0;  nPorce2 =  12;  nPorce4 = 12;  |FINSI;
         |SI nCatalunyaB ! 0;  nPorce2 =  12;  nPorce4 = 12;  |FINSI;
     |FINSI;

     nValor1 = ((nAjuste % nPorce1) + (nAjuste2 % nPorce3)) ! 2;
     nValor2 = ((nAjuste % nPorce2) + (nAjuste2 % nPorce4)) ! 2;

     #0#24   = nAjuste + nAjuste2;
     #0#25   = nValor1;
     #0#26   = nValor2;
|FPRC;

|PROCESO AnexoMejoras;
     nAcumLimite = 0;
     nLimite     = 0;

     |SI nLimiteGral < 53007.20;
         nLimite = 4000;
         |SI nLimiteGral > 33007.20;
             nLimite = 4000 - ((nLimiteGral - 33007.20) * 0.2);
             |SI nLimite > 4000;
                 nLimite = 4000;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nLimite > 0;
         n532   = 0;
         nValor = #0#125;
         |SI nValor > 12000;  #0#125 = 12000;  |FINSI;

         nValor = #0#125;

         |SI nValor > nLimite;
             n532        = nValor - nLimite;
             nValor      = nLimite;
             nLimite     = 0;
         |SINO;
             nLimite = nLimite - nValor;
         |FINSI;

         #0#126 = nValor;
         nValor = nValor % 10;
         #0#127 = nValor;

         nValor = #0#128;
         |SI nValor > 12000;  #0#128 = 12000;  |FINSI;
         nValor = #0#128;

         |SI nValor > nLimite;
             n532    = n532 + (nValor - nLimite);
             nValor  = nLimite;
             nLimite = 0;
         |SINO;
             nLimite = nLimite - nValor;
         |FINSI;

         #0#101 = nValor;
         nValor = nValor % 10;
         #0#102 = nValor;

         #0#131 = (N\ #0#127 + #0#102);
         #0#103 = n532;
     |SINO;
         #0#100 = "";
         #0#132 = "";
         #0#101 = 0;
         #0#102 = 0;
         #0#103 = 0;
         #0#125 = 0;
         #0#126 = 0;
         #0#127 = 0;
         #0#128 = 0;
         #0#129 = 0;
         #0#130 = 0;
         #0#131 = 0;
     |FINSI;

     nLimiteAnt = (N\ #0#126 + #0#101);

     |SI nLimiteGral < 71007.20;
         nLimite = 6750;
         |SI nLimiteGral > 53007.20;
             nLimite = 6750 - ((nLimiteGral - 53007.20) * 0.375);
             |SI nLimite > 6750;
                 nLimite = 6750;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nLimite > 0;
         nLimite = nLimite - nLimiteAnt;

         n532   = 0;
         nValor = #0#155;
         |SI nValor > 20000;  #0#155 = 20000;  |FINSI;
         nValor = #0#155;

         |SI nValor > nLimite;
             n532    = nValor - nLimite;
             nValor  = nLimite;
             nLimite = 0;
         |SINO;
             nLimite = nLimite - nValor;
         |FINSI;

         #0#156 = nValor;
         nValor = nValor % 20;
         #0#157 = nValor;

         nValor = #0#133;
         |SI nValor > 20000;  #0#133 = 20000;  |FINSI;
         nValor = #0#133;

         |SI nValor > nLimite;
             n532    = n532 + (nValor - nLimite);
             nValor  = nLimite;
             nLimite = 0;
         |SINO;
             nLimite = nLimite - nValor;
         |FINSI;

         #0#134 = nValor;
         nValor = nValor % 20;
         #0#135 = nValor;
         #0#138 = n532;

         n532   = 0;
         nValor = #0#158;
         |SI nValor > 20000;  #0#158 = 20000;  |FINSI;
         nValor = #0#158;

         |SI nValor > nLimite;
             n532    = nValor - nLimite;
             nValor  = nLimite;
             nLimite = 0;
         |SINO;
             nLimite = nLimite - nValor;
         |FINSI;

         #0#159 = nValor;
         nValor = nValor % 20;
         #0#160 = nValor;

         nValor = #0#141;
         |SI nValor > 20000;  #0#141 = 20000;  |FINSI;
         nValor = #0#141;

         |SI nValor > nLimite;
             n532    = n532 + (nValor - nLimite);
             nValor  = nLimite;
             nLimite = 0;
         |SINO;
             nLimite = nLimite - nValor;
         |FINSI;

         #0#142 = nValor;
         nValor = nValor % 20;
         #0#143 = nValor;
         #0#146 = n532;

         n532   = 0;
         nValor = #0#161;
         |SI nValor > 20000;  #0#161 = 20000;  |FINSI;
         nValor = #0#161;

         |SI nValor > nLimite;
             n532    = nValor - nLimite;
             nValor  = nLimite;
             nLimite = 0;
         |SINO;
             nLimite = nLimite - nValor;
         |FINSI;

         #0#162 = nValor;
         nValor = nValor % 20;
         #0#163 = nValor;

         nValor = #0#150;
         |SI nValor > 20000;  #0#150 = 20000;  |FINSI;
         nValor = #0#150;

         |SI nValor > nLimite;
             n532    = n532 + (nValor - nLimite);
             nValor  = nLimite;
             nLimite = 0;
         |SINO;
             nLimite = nLimite - nValor;
         |FINSI;

         #0#151 = nValor;
         nValor = nValor % 20;
         #0#152 = nValor;
         #0#153 = n532;

         #0#154 = (N\ #0#157 + #0#135 + #0#160 + #0#143 + #0#163 + #0#152);
     |SINO;
         |PDEFECTO #0, 133, 164;
     |FINSI;
|FPRC;

|PROCESO CalculaAnexoA;
     aDef    = eaPathDef + "rem01041.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1041"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |GRABA 020#0b;
     |FINSI;

     nLimiteGral = 0;
     enBloque = 23;  eaCasilla = "455"; |HAZ SacaImporte; nLimiteGral = nLimiteGral + enImporte;
     enBloque = 24;  eaCasilla = "465"; |HAZ SacaImporte; nLimiteGral = nLimiteGral + enImporte;

|| Vivienda habitual

     nCatalunyaA = 0;
     nCatalunyaB = 0;

     |SI #0#76 = "1";  nCatalunyaA = 1;  |FINSI;
     |SI #0#76 = "2";  nCatalunyaB = 1;  |FINSI;

     |HAZ Anexo1Punto1;
     |HAZ Anexo1Punto2;

     #0#27   = (N\ #0#4 + #0#7 + #0#10 + #0#25 + #0#115);
     #0#28   = (N\ #0#5 + #0#8 + #0#11 + #0#26 + #0#116);


|| Alquiler de la vivienda habitual

     nValor      = #0#89;

     |SI nLimiteGral < 24107.20;
         |SI nLimiteGral [ 17707.20;
             |SI nValor > 9040;
                 nValor = 9040;
             |FINSI;
         |FINSI;

         |SI nLimiteGral > 17707.20;
             nLimite = 9040 - ((nLimiteGral - 17707.20) * 1.4125);
             |SI nValor > nLimite;
                 nValor = nLimite;
             |FINSI;
         |FINSI;

         #0#89  = nValor;
         nValor = nValor % 10.05;
         #0#90  = nValor;

         nValor = nValor / 2;

         #0#92  = nValor;
         #0#91  = (N\ (#0#90 - nValor));
     |SINO;
         #0#85 = "";
         #0#86 = 0;
         #0#87 = "";
         #0#88 = 0;
         #0#89 = 0;
         #0#90 = 0;
         #0#91 = 0;
         #0#92 = 0;
     |FINSI;

|| Obras de mejora de la vivienda habitual

     |HAZ AnexoMejoras;

|| Donaciones

     |HAZ Donaciones;

|| Ceuta y Melilla

     enBloque = 35;  eaCasilla = "698"; |HAZ SacaImporte; nCuotaIntegra = enImporte;
     enBloque = 36;  eaCasilla = "699"; |HAZ SacaImporte; nCuotaIntegra = nCuotaIntegra + enImporte;
     enBloque = 35;  eaCasilla = "712"; |HAZ SacaImporte; nValor2       = enImporte;
     enBloque = 36;  eaCasilla = "713"; |HAZ SacaImporte; nValor2       = nValor2 + enImporte;

     nValor1 = nCuotaIntegra % 50;

     |SI nValor2 > nValor1;
         #0#44   = nValor1;
     |SINO;
         #0#44   = nValor2;
     |FINSI;

     nValor  = #0#44;
     nValor1 = (nValor % 50) ! 2;
     nValor2 = nValor - nValor1;

     #0#45   = nValor1;
     #0#46   = nValor2;

|| Cuentas Ahorro

     nValor  = (#0#47 % 15) ! 2;
     nValor1 = (nValor % 50) ! 2;
     nValor2 = nValor - nValor1;
     #0#48   = nValor;
     #0#49   = nValor1;
     #0#50   = nValor2;

     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;

     enSwAcum  = 0;

     enBloque  = 35;  eaCasilla = "700";  enImporte = #0#27;  |HAZ GrabaLineal;
     enBloque  = 35;  eaCasilla = "702";  enImporte = #0#36;  |HAZ GrabaLineal;
     enBloque  = 35;  eaCasilla = "704";  enImporte = #0#42;  |HAZ GrabaLineal;
     enBloque  = 35;  eaCasilla = "712";  enImporte = #0#45;  |HAZ GrabaLineal;
     enBloque  = 35;  eaCasilla = "714";  enImporte = #0#49;  |HAZ GrabaLineal;
     enBloque  = 35;  eaCasilla = "716";  enImporte = #0#91;  |HAZ GrabaLineal;
     enBloque  = 35;  eaCasilla = "773";  enImporte = #0#131; |HAZ GrabaLineal;
     enBloque  = 35;  eaCasilla = "733";  enImporte = #0#154; |HAZ GrabaLineal;

     enBloque  = 36;  eaCasilla = "701";  enImporte = #0#28;  |HAZ GrabaLineal;
     enBloque  = 36;  eaCasilla = "703";  enImporte = #0#37;  |HAZ GrabaLineal;
     enBloque  = 36;  eaCasilla = "705";  enImporte = #0#43;  |HAZ GrabaLineal;
     enBloque  = 36;  eaCasilla = "713";  enImporte = #0#46;  |HAZ GrabaLineal;
     enBloque  = 36;  eaCasilla = "715";  enImporte = #0#50;  |HAZ GrabaLineal;
     enBloque  = 36;  eaCasilla = "772";  enImporte = #0#92;  |HAZ GrabaLineal;

     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO Deduce;
     |SI nAcum = 0;     nAplicado = 0;  |ACABA;  |FINSI;
     |SI nLimiteT [ 0;  nAplicado = 0;  |ACABA;  |FINSI;

     nAcum = nAcum - nDeducido;
     |SI nAcum ] 0
         nAplicado = nDeducido;
     |SINO;
         nAplicado = nDeducido + nAcum;
         nAcum     = 0;
     |FINSI;

     nLimiteT = nLimiteT - nAplicado;
     |SI nLimiteT < 0;
         nAplicado = nAplicado + nLimiteT;
         nLimiteT  = 0;
     |FINSI;
|FPRC;

|PROCESO CalculaAnexoC;
     aDef    = eaPathDef + "rem01042.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1042"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |CIERRA #0;
         |DESCARGA_DEF #datfic0@;
         |ACABA;
     |FINSI;

     nValor   = 0;
     enBloque = 35; eaCasilla = "698"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 36; eaCasilla = "699"; |HAZ SacaImporte; nValor = nValor + enImporte;
     nLimiteT = nValor;

     enBloque = 35; eaCasilla = "700"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 36; eaCasilla = "701"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 35; eaCasilla = "702"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 36; eaCasilla = "703"; |HAZ SacaImporte; nValor = nValor - enImporte;

     |SI nValor < 0;  nValor = 0;  |FINSI;

     nLimite25  = (nValor % 25) ! 2;
     nLimite35  = (nValor % 35) ! 2;
     nLimite50  = (nValor % 50) ! 2;
     nLimite60  = (nValor % 60) ! 2;
     nLimite70  = (nValor % 70) ! 2;
     nLimite90  = (nValor % 90) ! 2;
     nLimite100 = nValor;

                       nAcum     = nLimite25;
     |SI #0#123 = 2;   nAcum     = nLimite50;  |FINSI;

     nDeducido = #0#4;   |HAZ Deduce;  #0#4   = nAplicado;
     nDeducido = #0#7;   |HAZ Deduce;  #0#7   = nAplicado;
     nDeducido = #0#10;  |HAZ Deduce;  #0#10  = nAplicado;
     nDeducido = #0#13;  |HAZ Deduce;  #0#13  = nAplicado;
     nDeducido = #0#16;  |HAZ Deduce;  #0#16  = nAplicado;
     nDeducido = #0#19;  |HAZ Deduce;  #0#19  = nAplicado;
     nDeducido = #0#22;  |HAZ Deduce;  #0#22  = nAplicado;
     nDeducido = #0#25;  |HAZ Deduce;  #0#25  = nAplicado;
     nDeducido = #0#28;  |HAZ Deduce;  #0#28  = nAplicado;
     nDeducido = #0#31;  |HAZ Deduce;  #0#31  = nAplicado;
     nDeducido = #0#34;  |HAZ Deduce;  #0#34  = nAplicado;
     nDeducido = #0#37;  |HAZ Deduce;  #0#37  = nAplicado;
     nDeducido = #0#40;  |HAZ Deduce;  #0#40  = nAplicado;
     nDeducido = #0#43;  |HAZ Deduce;  #0#43  = nAplicado;
     nDeducido = #0#46;  |HAZ Deduce;  #0#46  = nAplicado;
     nDeducido = #0#49;  |HAZ Deduce;  #0#49  = nAplicado;
     nDeducido = #0#52;  |HAZ Deduce;  #0#52  = nAplicado;
     nDeducido = #0#55;  |HAZ Deduce;  #0#55  = nAplicado;
     nDeducido = #0#58;  |HAZ Deduce;  #0#58  = nAplicado;
     nDeducido = #0#61;  |HAZ Deduce;  #0#61  = nAplicado;
     nDeducido = #0#64;  |HAZ Deduce;  #0#64  = nAplicado;
     nDeducido = #0#67;  |HAZ Deduce;  #0#67  = nAplicado;
     nDeducido = #0#70;  |HAZ Deduce;  #0#70  = nAplicado;
     nDeducido = #0#73;  |HAZ Deduce;  #0#73  = nAplicado;
     nDeducido = #0#76;  |HAZ Deduce;  #0#76  = nAplicado;
     nDeducido = #0#79;  |HAZ Deduce;  #0#79  = nAplicado;
     nDeducido = #0#82;  |HAZ Deduce;  #0#82  = nAplicado;
     nDeducido = #0#85;  |HAZ Deduce;  #0#85  = nAplicado;
     nDeducido = #0#88;  |HAZ Deduce;  #0#88  = nAplicado;
     nDeducido = #0#91;  |HAZ Deduce;  #0#91  = nAplicado;
     nDeducido = #0#94;  |HAZ Deduce;  #0#94  = nAplicado;
     nDeducido = #0#97;  |HAZ Deduce;  #0#97  = nAplicado;
     nDeducido = #0#100; |HAZ Deduce;  #0#100 = nAplicado;
     nDeducido = #0#103; |HAZ Deduce;  #0#103 = nAplicado;
     nDeducido = #0#106; |HAZ Deduce;  #0#106 = nAplicado;
     nDeducido = #0#109; |HAZ Deduce;  #0#109 = nAplicado;
     nDeducido = #0#112; |HAZ Deduce;  #0#112 = nAplicado;
     nDeducido = #0#115; |HAZ Deduce;  #0#115 = nAplicado;
     nDeducido = #0#118; |HAZ Deduce;  #0#118 = nAplicado;
     nDeducido = #0#121; |HAZ Deduce;  #0#121 = nAplicado;

     nAcum   = nLimite50;
     nDeducido = #0#174; |HAZ Deduce;  #0#174 = nAplicado;

     nAcum     = nLimite60;
     nDeducido = #0#124; |HAZ Deduce;  #0#124 = nAplicado;
     #0#123    = (N\ #0#123 + #0#173); #0#124 = (N\ #0#124 + #0#174);

                      nAcum     = nLimite60;
     |SI #0#124 = 2;  nAcum     = nLimite90;  |FINSI;

     nDeducido = #0#127; |HAZ Deduce;  #0#79 = nAplicado;
     nDeducido = #0#130; |HAZ Deduce;  #0#82 = nAplicado;
     nDeducido = #0#133; |HAZ Deduce;  #0#85 = nAplicado;
     nDeducido = #0#136; |HAZ Deduce;  #0#88 = nAplicado;
     nDeducido = #0#139; |HAZ Deduce;  #0#91 = nAplicado;
     nDeducido = #0#142; |HAZ Deduce;  #0#94 = nAplicado;

     nAcum     = nLimite50;
     nDeducido = #0#145; |HAZ Deduce;  #0#97 = nAplicado;

     nAcum   = nLimite100;
     nDeducido = #0#151; |HAZ Deduce;  #0#151 = nAplicado;
     nDeducido = #0#152; |HAZ Deduce;  #0#152 = nAplicado;
     nDeducido = #0#154; |HAZ Deduce;  #0#154 = nAplicado;
     nDeducido = #0#155; |HAZ Deduce;  #0#155 = nAplicado;
     nDeducido = #0#158; |HAZ Deduce;  #0#158 = nAplicado;
     nDeducido = #0#159; |HAZ Deduce;  #0#159 = nAplicado;
     nDeducido = #0#162; |HAZ Deduce;  #0#162 = nAplicado;
     nDeducido = #0#163; |HAZ Deduce;  #0#163 = nAplicado;
     nDeducido = #0#166; |HAZ Deduce;  #0#166 = nAplicado;
     nDeducido = #0#167; |HAZ Deduce;  #0#167 = nAplicado;

     |PARA nCampo1 = 3;  |SI nCampo1 [ 144;  |HACIENDO nCampo1 = nCampo1 + 3;
           nCampo2   = nCampo1 + 1;
           nCampo3   = nCampo1 + 2;
           #0nCampo3 = (N\ #0nCampo1 - #0nCampo2);
     |SIGUE;

     #0#156 = (N\ #0#153 - #0#154 - #0#155);
     #0#160 = (N\ #0#157 - #0#158 - #0#159);
     #0#164 = (N\ #0#161 - #0#162 - #0#163);
     #0#168 = (N\ #0#165 - #0#166 - #0#167);

     nSuma = 0;
     |PARA nCampo1 = 4;  |SI nCampo1 [ 145;  |HACIENDO nCampo1 = nCampo1 + 3;
           nSuma = nSuma + #0nCampo1;
     |SIGUE;

     #0#147  = nSuma;

     nValor1 = (nSuma % 50) ! 2;
     nValor2 = nSuma - nValor1;

     #0#148 = nValor1;
     #0#149 = nValor2;

     enSwAcum   = 0;
     enBloque   = 35;  eaCasilla  = "706";  enImporte  = nValor1;  |HAZ GrabaLineal;
     enBloque   = 36;  eaCasilla  = "707";  enImporte  = nValor2;  |HAZ GrabaLineal;

     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;

     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO AjustaDobleInternac;
     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic1@;

     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1033"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |SI #1#123 ! 0;
         nValor1  = #1#123;
         enBloque = 1;  eaCasilla = "015"; |HAZ SacaImporte; nValor2 = enImporte;
         enBloque = 1;  eaCasilla = "017"; |HAZ SacaImporte; nValor3 = enImporte;

         nValor  = ((nValor1 * 100) / nValor2) ! 2;
         nValor  = (nValor3 % nValor) ! 2;
         nValor1 = nValor1 - nValor;

         #1#123 = nValor1;
     |FINSI;

     nValor = #1#98 + #1#123 + #1#99 + #1#100 + #1#101;
     |SI nValor ! 0;
         enBloque   = 31; eaCasilla = "620";  |HAZ SacaImporte; nValor54 = enImporte;
         enBloque   = 32; eaCasilla = "630";  |HAZ SacaImporte; nValor55 = enImporte;
         enBloque   = 35; eaCasilla = "693";  |HAZ SacaImporte; nValorZ  = enImporte;
         enBloque   = 36; eaCasilla = "694";  |HAZ SacaImporte; nValorB  = enImporte;
         enBloque   = 23; eaCasilla = "452";  |HAZ SacaImporte; nValor35 = enImporte;
         enBloque   = 35; eaCasilla = "696";  |HAZ SacaImporte; nValorC  = enImporte;
         enBloque   = 36; eaCasilla = "697";  |HAZ SacaImporte; nValorC  = nValorC + enImporte;

         nValor91  = 0;
         enBloque  = 35; eaCasilla = "700";  |HAZ SacaImporte; nValor91 = enImporte;
         enBloque  = 35; eaCasilla = "702";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte;
         enBloque  = 35; eaCasilla = "704";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte;
         enBloque  = 35; eaCasilla = "706";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte;
         enBloque  = 35; eaCasilla = "708";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte;
         enBloque  = 35; eaCasilla = "710";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte;
         enBloque  = 35; eaCasilla = "712";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte;
         enBloque  = 35; eaCasilla = "714";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte;
         enBloque  = 35; eaCasilla = "716";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte;
         enBloque  = 36; eaCasilla = "701";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte;
         enBloque  = 36; eaCasilla = "703";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte;
         enBloque  = 36; eaCasilla = "705";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte;
         enBloque  = 36; eaCasilla = "707";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte;
         enBloque  = 36; eaCasilla = "709";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte;
         enBloque  = 36; eaCasilla = "711";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte;
         enBloque  = 36; eaCasilla = "713";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte;
         enBloque  = 36; eaCasilla = "715";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte;
         enBloque  = 36; eaCasilla = "717";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte;

         nValorE = nValorZ + nValorB;
         nValorF = nValorC + nValorD;
         nValorG = nValorE + nValorF;
         nValorH = nValorG - nValor91;
         |SI nValorH < 0;  nValorH = 0;  |FINSI;

         nValorP1 = ((((nValorH * (nValorE / nValorG)) * 100) / nValor54) - 0.0049) ! 2;
         nValorP2 = 0;
         |SI nValor55 ! 0;
             nValorP2 = 18;
         |FINSI;

         nValorB3 = (nValor54 * (#1#98 + #1#123)) / nValor35;

         |SI nValorB3 > nValor54;
             nValorB3 = nValor54;
         |FINSI;

         nValorC1 = #1#99;
         nValor   = ((nValorB3 % nValorP1) - 0.0049) ! 2;
         |SI nValor < 0;  nValor = 0;  |FINSI;
         |SI nValor < nValorC1;
             nValorC1 = nValor;
         |FINSI;

         nValorC2 = #1#101;
         nValorB4 = #1#100;

         |SI nValorB4 > nValor55;
             nValorB4 = nValor55;
         |FINSI;

         nValor   = ((nValorB4 % nValorP2) - 0.0049) ! 2;
         |SI nValor < 0;  nValor = 0;  |FINSI;
         |SI nValor < nValorC2;
             nValorC2 = nValor;
         |FINSI;

         enImporte = (nValorC1 + nValorC2) ! 2;
         |SI enImporte < 0;  enImporte = 0;  |FINSI;

         enSwAcum   = 0;
         enBloque   = 37;
         eaCasilla  = "734";
         |HAZ GrabaLineal;
     |FINSI;

     |DESCARGA_DEF #datfic1@;
|FPRC;

|PROCESO LosCuatrocientos;
     enBloque  = 37;
     eaCasilla = "735";
     |HAZ SacaImporte;
     |SI enImporte ! 0;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
          aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1018"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 040#0=;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
     |CIERRA #0;

     enBloque = 23;  eaCasilla = "455"; |HAZ SacaImporte; nLimiteGral = enImporte;
     enBloque = 24;  eaCasilla = "465"; |HAZ SacaImporte; nLimiteGral = nLimiteGral + enImporte;

     nValor = 0;
     enBloque = 1;  eaCasilla = "015"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 1;  eaCasilla = "017"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 1;  eaCasilla = "018"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 1;  eaCasilla = "019"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 1;  eaCasilla = "020"; |HAZ SacaImporte; nValor = nValor - enImporte;

     enBloque = 6;  eaCasilla = "170"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 7;  eaCasilla = "197"; |HAZ SacaImporte; nValor = nValor + enImporte;
                                                         nValor = nValor + #0#27;

     enBloque = 8;  eaCasilla = "223"; |HAZ SacaImporte; nValor = nValor + enImporte;

     enBloque = 35; eaCasilla = "TME"; |HAZ SacaImporte; nValor1 = enImporte;
     enBloque = 36; eaCasilla = "TMA"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte;

     enImporte = 0;
     |SI nLimiteGral [ 12000;
         enImporte = 400;
         |SI nLimiteGral > 8000.01;
             enImporte = 400 - ((nLimiteGral - 8000) * 0.1);
         |FINSI;
     |FINSI;

     nValor2   = nValor % nValor1;
     |SI nValor2 < 0;  nValor2 = 0;  |FINSI;

     |SI nValor2 ] 0;  |Y nValor2 < enImporte;
         enImporte = nValor2;
     |FINSI;

     enBloque  = 37;
     eaCasilla = "735";
     |HAZ GrabaLineal;

     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO CompensacionMobiliario;
     aDef    = eaPathDef + "rem01012.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1012"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 040#0=;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
     |CIERRA #0;

     |SI #0#29 = 0;  |Y #0#30 = 0;
         |DESCARGA_DEF #datfic1@;
         |ACABA;
     |FINSI;

     |HAZ AplicaEscalaFicticia;

     enBloque = 35; eaCasilla = "689"; |HAZ SacaImporte; nValor = enImporte;
     enBloque = 35; eaCasilla = "624"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 36; eaCasilla = "690"; |HAZ SacaImporte; nValor = nValor + enImporte;

     nImporte = (nImporte1 + nImporte2 + nImporte3 + nImporte4) - nValor;
     nValor   = #0#29;
     |SI nValor > 6000;
         nValor1 = nValor - 6000;
         nValor  = ((6000 % 19) + (nValor1 % 21)) ! 2;
     |SINO;
         nValor  = (#0#29 % 19) ! 2;
     |FINSI;

     enImporte = nValor - nImporte;
     |SI enImporte < 0; enImporte = 0;  |FINSI;

     enSwAcum  = 0;
     enBloque  = 37;
     eaCasilla = "739";
     |HAZ GrabaLineal;

     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO CalculaM;
     enBloque = 34; eaCasilla = "686"; |HAZ SacaImporte; nRentaExenta1 = enImporte;
     enBloque = 34; eaCasilla = "687"; |HAZ SacaImporte; nRentaExenta2 = enImporte;

     |SI nRentaExenta2 ! 0;
         |HAZ AplicaEscalaA687;
     |SINO;
         |HAZ AplicaEscalaA620;
         |HAZ AplicaEscalaA620Comp;
         |HAZ AplicaEscalaA680;
         |HAZ AplicaEscalaA680Comp;
         |HAZ AplicaEscalaA683;
     |FINSI;

     |SI nRentaExenta2 = 0;
         nValor = 0;
         enBloque = 35; eaCasilla = "689"; |HAZ SacaImporte; nValor = enImporte;
         enBloque = 35; eaCasilla = "691"; |HAZ SacaImporte; nValor = nValor - enImporte;
         |SI nValor < 0;  nValor = 0;  |FINSI;

         enSwAcum   = 0;
         enBloque   = 35;
         eaCasilla  = "626";
         enImporte  = nValor;
         |HAZ GrabaLineal;

         nValor = 0;
         enBloque = 35; eaCasilla = "624"; |HAZ SacaImporte; nValor = enImporte;
         enBloque = 35; eaCasilla = "625"; |HAZ SacaImporte; nValor = nValor - enImporte;
         |SI nValor < 0;  nValor = 0;  |FINSI;

         enSwAcum   = 0;
         enBloque   = 35;
         eaCasilla  = "627";
         enImporte  = nValor;
         |HAZ GrabaLineal;

         nValor = 0;
         enBloque = 35; eaCasilla = "626"; |HAZ SacaImporte; nValor = enImporte;
         enBloque = 35; eaCasilla = "627"; |HAZ SacaImporte; nValor = nValor + enImporte;
         |SI nValor < 0;  nValor = 0;  |FINSI;

         enSwAcum   = 0;
         enBloque   = 35;
         eaCasilla  = "693";
         enImporte  = nValor;
         |HAZ GrabaLineal;

         nValor = 0;
         enBloque = 36; eaCasilla = "690"; |HAZ SacaImporte; nValor = enImporte;
         enBloque = 36; eaCasilla = "692"; |HAZ SacaImporte; nValor = nValor - enImporte;
         |SI nValor < 0;  nValor = 0;  |FINSI;

         enSwAcum   = 0;
         enBloque   = 36;
         eaCasilla  = "694";
         enImporte  = nValor;
         |HAZ GrabaLineal;

         enBloque = 35; eaCasilla = "693"; |HAZ SacaImporte; nValor1 = enImporte;
         enBloque = 31; eaCasilla = "620"; |HAZ SacaImporte; nValor2 = enImporte;
     |SINO;
         enBloque = 35; eaCasilla = "693"; |HAZ SacaImporte; nValor1 = enImporte;
         enBloque = 31; eaCasilla = "620"; |HAZ SacaImporte; nValor2 = enImporte + nRentaExenta2;
     |FINSI;

     enImporte  = (((nValor1 * 100) / nValor2) - 0.0049) ! 2;
     |SI enImporte < 0;  enImporte = 0;  |FINSI;

     enSwAcum   = 0;
     enBloque   = 35;
     eaCasilla  = "TME";
     |HAZ GrabaLineal;

     |SI nRentaExenta2 ! 0;
         nPorce     = enImporte;
         enBloque   = 31; eaCasilla = "620"; |HAZ SacaImporte; nValor1 = enImporte;
         enImporte  = (nValor1 % nPorce) ! 2;

         enSwAcum   = 0;
         enBloque   = 35;
         eaCasilla  = "693";
         |HAZ GrabaLineal;
     |FINSI;

     enBloque = 36; eaCasilla = "694"; |HAZ SacaImporte; nValor1 = enImporte;

     enImporte  = (((nValor1 * 100) / nValor2) - 0.0049) ! 2;
     |SI enImporte < 0;  enImporte = 0;  |FINSI;

     enSwAcum   = 0;
     enBloque   = 36;
     eaCasilla  = "TMA";
     |HAZ GrabaLineal;

     |SI nRentaExenta2 ! 0;
         nPorce    = enImporte;
         enBloque  = 31; eaCasilla = "620"; |HAZ SacaImporte; nValor1 = enImporte;
         enImporte  = (nValor1 % nPorce) ! 2;
         enSwAcum   = 0;
         enBloque   = 36;
         eaCasilla  = "694";
         |HAZ GrabaLineal;
     |FINSI;

     enBloque = 32; eaCasilla = "630"; |HAZ SacaImporte; nValor1 = enImporte;
     enBloque = 33; eaCasilla = "681"; |HAZ SacaImporte; nValor2 = enImporte;

     enImporte = nValor1 - nValor2;
     |SI enImporte < 0;  enImporte = 0;  |FINSI;

     enSwAcum   = 0;
     enBloque   = 35;
     eaCasilla  = "695";
     |HAZ GrabaLineal;

     enBloque = 32; eaCasilla = "630"; |HAZ SacaImporte; nValor1 = enImporte;
     enBloque = 33; eaCasilla = "684"; |HAZ SacaImporte; nValor2 = enImporte;

     enImporte = nValor1 - nValor2;
     |SI enImporte < 0;  enImporte = 0;  |FINSI;

     enSwAcum   = 0;
     enBloque   = 36;
     eaCasilla  = "771";
     |HAZ GrabaLineal;

     |HAZ GravamenAhorro;

     enBloque = 35; eaCasilla = "693"; |HAZ SacaImporte; nValor1 = enImporte;
     enBloque = 35; eaCasilla = "696"; |HAZ SacaImporte; nValor2 = enImporte;

     enImporte  = nValor1 + nValor2;
     enSwAcum   = 0;
     enBloque   = 35;
     eaCasilla  = "698";
     |HAZ GrabaLineal;

     enBloque = 36; eaCasilla = "694"; |HAZ SacaImporte; nValor1 = enImporte;
     enBloque = 36; eaCasilla = "697"; |HAZ SacaImporte; nValor2 = enImporte;

     enImporte  = nValor1 + nValor2;
     enSwAcum   = 0;
     enBloque   = 36;
     eaCasilla  = "699";
     |HAZ GrabaLineal;

     |HAZ CalculaAnexoA;
     |HAZ CalculaAnexoC;
     |HAZ CalculaAnexoB;

     nValor   = 0;
     enBloque = 35; eaCasilla = "698"; |HAZ SacaImporte; nValor = enImporte;
     enBloque = 35; eaCasilla = "700"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 35; eaCasilla = "702"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 35; eaCasilla = "704"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 35; eaCasilla = "706"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 35; eaCasilla = "708"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 35; eaCasilla = "710"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 35; eaCasilla = "712"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 35; eaCasilla = "714"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 35; eaCasilla = "716"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 35; eaCasilla = "773"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 35; eaCasilla = "733"; |HAZ SacaImporte; nValor = nValor - enImporte;

     |SI nValor < 0;  nValor = 0;  |FINSI;

     enImporte  = nValor;
     enSwAcum   = 0;
     enBloque   = 35;
     eaCasilla  = "720";
     |HAZ GrabaLineal;

     nValor   = 0;
     enBloque = 36; eaCasilla = "699"; |HAZ SacaImporte; nValor = enImporte;
     enBloque = 36; eaCasilla = "701"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 36; eaCasilla = "703"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 36; eaCasilla = "705"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 36; eaCasilla = "707"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 36; eaCasilla = "709"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 36; eaCasilla = "711"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 36; eaCasilla = "713"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 36; eaCasilla = "715"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 36; eaCasilla = "772"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 36; eaCasilla = "717"; |HAZ SacaImporte; nValor = nValor - enImporte;

     |SI nValor < 0;  nValor = 0;  |FINSI;

     enImporte  = nValor;
     enSwAcum   = 0;
     enBloque   = 36;
     eaCasilla  = "721";
     |HAZ GrabaLineal;

     nValor   = 0;
     enBloque = 35; eaCasilla = "720"; |HAZ SacaImporte; nValor = enImporte;
     enBloque = 35; eaCasilla = "722"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 35; eaCasilla = "723"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 35; eaCasilla = "724"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 35; eaCasilla = "725"; |HAZ SacaImporte; nValor = nValor + enImporte;

     enImporte  = nValor;
     enSwAcum   = 0;
     enBloque   = 35;
     eaCasilla  = "730";
     |HAZ GrabaLineal;

     nValor   = 0;
     enBloque = 36; eaCasilla = "721"; |HAZ SacaImporte; nValor = enImporte;
     enBloque = 36; eaCasilla = "726"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 36; eaCasilla = "727"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 36; eaCasilla = "728"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 36; eaCasilla = "729"; |HAZ SacaImporte; nValor = nValor + enImporte;

     enImporte  = nValor;
     enSwAcum   = 0;
     enBloque   = 36;
     eaCasilla  = "731";
     |HAZ GrabaLineal;

     nValor   = 0;
     enBloque = 35; eaCasilla = "730"; |HAZ SacaImporte; nValor = enImporte;
     enBloque = 36; eaCasilla = "731"; |HAZ SacaImporte; nValor = nValor + enImporte;

     enImporte  = nValor;
     enSwAcum   = 0;
     enBloque   = 37;
     eaCasilla  = "732";
     |HAZ GrabaLineal;

     |HAZ AjustaDobleInternac;
     |HAZ LosCuatrocientos;
     |HAZ CompensacionMobiliario;

     enBloque = 37; eaCasilla = "732"; |HAZ SacaImporte; nValor = enImporte;
     enBloque = 37; eaCasilla = "734"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 37; eaCasilla = "735"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 37; eaCasilla = "736"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 37; eaCasilla = "737"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 37; eaCasilla = "739"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 37; eaCasilla = "740"; |HAZ SacaImporte; nValor = nValor - enImporte;

     |SI nValor < 0;  nValor = 0;  |FINSI;

     enImporte  = nValor;
     enSwAcum   = 0;
     enBloque   = 37;
     eaCasilla  = "741";
     |HAZ GrabaLineal;

     enBloque = 38; eaCasilla = "742"; |HAZ SacaImporte; nValor = enImporte;
     enBloque = 38; eaCasilla = "743"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = "744"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = "745"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = "746"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = "747"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = "748"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = "749"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = "750"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = "751"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = "752"; |HAZ SacaImporte; nValor = nValor + enImporte;

     enImporte  = nValor;
     enSwAcum   = 0;
     enBloque   = 38;
     eaCasilla  = "754";
     |HAZ GrabaLineal;
     nValor1 = enImporte;

     enBloque = 37; eaCasilla = "741"; |HAZ SacaImporte; nValor = enImporte - nValor1;

     enSwAcum   = 0;
     enBloque   = 39;
     eaCasilla  = "755";
     |SI nValor < 0;
          nValor2 = -nValor;
          |SI nValor2 > nValor1;
               nValor = -nValor1;
          |FINSI;
     |FINSI;
     enImporte  = nValor;
     |HAZ GrabaLineal;

     enBloque = 39; eaCasilla = "756"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 39; eaCasilla = "757"; |HAZ SacaImporte; nValor = nValor + enImporte;

     enImporte  = nValor;
     enSwAcum   = 0;
     enBloque   = 39;
     eaCasilla  = "760";
     |HAZ GrabaLineal;
|FPRC;

|PROCESO VivBaleares;
     aDef    = eaPathDef + "rem01041.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1041"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 101#0=;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
     |CIERRA #0;

     |SI #0#24 ! 0;
         nValor1 = #0#24 + #0#122;
         |SI nValor1 > 12020;  nValor1 = 12020;  |FINSI;
         nValor1 = nValor1 % 13.3;

         nValor2 = #0#3 + #0#6 + #0#9 + #0#105 + #0#108 + #0#111 + #0#114;
         |SI nValor2 > 9015;  nValor2 = 9015;  |FINSI;
         nValor2 = nValor2 % 7.5;

         nImporte = nValor1 + nValor2;
     |SINO;
         enBloque = 35; eaCasilla = "700"; |HAZ SacaImporte;  nImporte = enImporte;
         enBloque = 36; eaCasilla = "701"; |HAZ SacaImporte;  nImporte = nImporte + enImporte;
         nImporte = (nImporte % 50) ! 2;
     |FINSI;

     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO VivCatalunya;
     aDef    = eaPathDef + "rem01041.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1041"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 101#0=;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
     |CIERRA #0;

     |SI #0#76 = "2";
         nValor1 = #0#24 + #0#122;
         |SI nValor1 > 12020;  nValor1 = 12020;  |FINSI;
         nValor1 = nValor1 % 12;

         nValor2 = #0#3 + #0#6 + #0#9 + #0#105 + #0#108 + #0#111 + #0#114;
         |SI nValor2 > 9015;  nValor2 = 9015;  |FINSI;
         nValor2 = nValor2 % 9;

         nImporte = nValor1 + nValor2;
     |SINO;
         nValor1 = #0#24 + #0#122;
         |SI nValor1 > 12020;  nValor1 = 12020;  |FINSI;
         nValor1 = nValor1 % 12;

         nValor2 = #0#3 + #0#6 + #0#9 + #0#105 + #0#108 + #0#111 + #0#114;
         |SI nValor2 > 9015;  nValor2 = 9015;  |FINSI;
         nValor2 = nValor2 % 6;

         nImporte = nValor1 + nValor2;
     |FINSI;

     |SI #1#2 ! "CONJUNTA  ";  |Y #1#2 ! "CONJUNTAE  ";
         nCas702 = nCas702 + nImporte;
     |SINO;
         nImporte = nCas702;
     |FINSI;

     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO CalculaO;
     aDef    = eaPathDef + "rem00100.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     |LEE 040#0=;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
     |CIERRA #0;

     nCodAutonomico     = #0#11;
     |SI enConta        = 2;  nCodAutonomico = #0#43;  |FINSI;
     |SI nCodAutonomico = 0;  nCodAutonomico = #0#11;  |FINSI;

     |DESCARGA_DEF #datfic0@;

     |SI nCodAutonomico = 18;  |ACABA; |FINSI;
     |SI nCodAutonomico = 19;  |ACABA; |FINSI;
     |SI nCodAutonomico = 20;  |ACABA; |FINSI;

     nImporte = 0;
     enBloque = 36; eaCasilla = "731"; |HAZ SacaImporte;
     enBloque = 40; eaCasilla = "775"; |HAZ GrabaLineal;

     nImporte = 0;
     enBloque = 37; eaCasilla = "734"; |HAZ SacaImporte;  nImporte = nImporte + enImporte;
     enBloque = 37; eaCasilla = "736"; |HAZ SacaImporte;  nImporte = nImporte + enImporte;
     enBloque = 37; eaCasilla = "737"; |HAZ SacaImporte;  nImporte = nImporte + enImporte;

     nImporte = (nImporte % 50) ! 2;
     enBloque = 40; eaCasilla = "776"; enImporte = nImporte;  |HAZ GrabaLineal;

     nImporte = 0;
     enBloque = 37; eaCasilla = "739"; |HAZ SacaImporte;  nImporte = enImporte;

     nImporte = (nImporte % 50) ! 2;
     enBloque = 40; eaCasilla = "778"; enImporte = nImporte;  |HAZ GrabaLineal;

     nImporte = 0;
     enBloque = 40; eaCasilla = "775"; |HAZ SacaImporte;  nImporte = enImporte;
     enBloque = 40; eaCasilla = "776"; |HAZ SacaImporte;  nImporte = nImporte - enImporte;
     enBloque = 40; eaCasilla = "778"; |HAZ SacaImporte;  nImporte = nImporte - enImporte;

     |SI nImporte < 0;  nImporte = 0;  |FINSI;

     enBloque = 40; eaCasilla = "779"; enImporte = nImporte;  |HAZ GrabaLineal;
|FPRC;

|PROCESO Empresarial1;
     |SI #1#5 = "4";  |O #1#5 = "5";
         nProfesional =  nProfesional + #1#35;
     |FINSI;
|FPRC;

|DEFBUCLE rem01014;
     #1#1004;
     ;
     #1001#0, #1001#1, #1001#2, 001;
     #1001#0, #1001#1, #1001#2, 999;
     ;
     NULL, Empresarial1;
|FIN;

|PROCESO rem01011_6;
     nImput = nImput + #0#12;
|FPRC;

|DEFBUCLE rem01011_6;
     #0#1004;
     ;
     #1001#0, #1001#1, #1001#2, 001;
     #1001#0, #1001#1, #1001#2, 999;
     ;
     NULL, rem01011_6;
|FIN;

|PROCESO SeleccionRenta;
     aDef    = eaPathDef + "rem01010.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1010"#;  |FINSI;

     #1001#5 = "";
     #1001#6 = "N";
     #1001#4 = "N";

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     enBloque = 38; eaCasilla = "742"; |HAZ SacaImporte;

     |SI #1#22 > #401#71;  |Y enImporte = 0;
         #1001#4 = "S";
     |FINSI;

     |SI enConta ! 7;  |Y enConta ! 8;
         |SI #1#19 > 1;
             nPagadoresC = nPagadoresC + #1#19;
         |FINSI;
     |FINSI;

     nPagadores = #1#19;
     nTotalPag  = #1#21;

     |DESCARGA_DEF #datfic1@;

     nValor = 0;
     enBloque = 29; eaCasilla = "585"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     |SI enImporte ! 0;
         |SI enConta ! 7;  |Y enConta ! 8;
             nPagadores  = nPagadores + 1;
         |SINO;
             nPagadoresC = nPagadoresC + 1;
         |FINSI;
         nTotalPag  = nTotalPag + enImporte;
     |FINSI;

     enBloque = 1; eaCasilla = "001"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     enBloque = 1; eaCasilla = "005"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     enBloque = 1; eaCasilla = "006"; |HAZ SacaImporte;  nValor = nValor + enImporte;

     |SI enConta ! 7;  |Y enConta ! 8;
         |SI nValor ] #401#70;  #1001#4 = "S";  |FINSI;

         |SI nPagadores > 1;
             |SI nTotalPag > #401#72;
                 |SI nValor > #401#71;
                     #1001#4 = "S";
                 |FINSI;
             |FINSI;
         |FINSI;
     |SINO;
         |SI nValor ] #401#70;  #1001#4 = "S";  |FINSI;

         |SI nPagadoresC > 1;
             |SI nTotalPag > #401#72;
                 |SI nValor > #401#71;
                     #1001#4 = "S";
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1018"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     nAlquiler = #1#17;
     nSuma1    = #1#22;

     |DESCARGA_DEF #datfic1@;

     aDef    = eaPathDef + "rem01014.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1014"#;  |FINSI;

     nProfesional   = 0;
     |BUCLE rem01014;

     |DESCARGA_DEF #datfic1@;

     |SI nSuma1 ] 2;
         #1001#4 = "S";
     |SINO;
         enBloque = 4; eaCasilla = "085"; |HAZ SacaImporte;
         |SI enImporte > #401#74;  #1001#4 = "S";  |FINSI;
     |FINSI;

     nContaAct = 0;

     enBloque = 6; eaCasilla = "170"; |HAZ SacaImporte;
     |SI enImporte ! 0;
         nContaAct = nContaAct + 2;
     |FINSI;

     enBloque = 7; eaCasilla = "197"; |HAZ SacaImporte;
     |SI enImporte ! 0;
         nContaAct = nContaAct + 2;
     |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1033"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |SI #1#11 ! 0;  |O #1#13 ! 0;  |O #1#15 ! 0; |O #1#16 ! 0;  |O #1#20 ! 0;
      |O #1#32 ! 0;  |O #1#34 ! 0;  |O #1#36 ! 0; |O #1#38 ! 0;
         nSuma = #1#11 + #1#13 +  #1#15 + #1#16 + #1#20;
         |SI nSuma > 500;
             nContaAct = nContaAct + 2;
         |FINSI;
     |FINSI;

     nSuma1 = #1#12;

     |DESCARGA_DEF #datfic1@;

     enBloque = 23; eaCasilla = "450"; |HAZ SacaImporte; nValor29 = enImporte;
     enBloque = 24; eaCasilla = "457"; |HAZ SacaImporte; nValor36 = enImporte;
     nSuma = nValor29 + nValor36 + nProfesional;
     |SI nSuma = nSuma1;
         |SI nSuma ! 0;
             |SI nSuma > #401#76;
                 nContaAct = nContaAct + 2;
             |FINSI;
         |FINSI;
     |SINO;
         |SI nSuma ! 0;
             |SI nSuma > #401#77;
                 nContaAct = nContaAct + 2;
             |FINSI;
         |FINSI;
     |FINSI;

     nValor = 0;
     enBloque = 8; eaCasilla = "220"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     enBloque = 8; eaCasilla = "221"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     enBloque = 8; eaCasilla = "222"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     enBloque = 8; eaCasilla = "223"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     enBloque = 8; eaCasilla = "224"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     enBloque = 8; eaCasilla = "225"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     enBloque = 8; eaCasilla = "226"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     enBloque = 8; eaCasilla = "227"; |HAZ SacaImporte;  nValor = nValor + enImporte;

     |SI nValor ! 0;  nContaAct = 2;  |FINSI;

     nValor1   = 0;
     nHay      = 0;

     enBloque = 4;  eaCasilla = "085"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte; |SI enImporte ! 0;  nHay = nHay + 1;  |FINSI;
     enBloque = 5;  eaCasilla = "140"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte; |SI enImporte ! 0;  nHay = nHay + 1;  |FINSI;
     enBloque = 6;  eaCasilla = "170"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte; |SI enImporte ! 0;  nHay = nHay + 1;  |FINSI;
     enBloque = 7;  eaCasilla = "197"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte; |SI enImporte ! 0;  nHay = nHay + 1;  |FINSI;
     enBloque = 21; eaCasilla = "450"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte;  nValor2 = enImporte;
     enBloque = 22; eaCasilla = "457"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte;  nValor2 = nValor2 + enImporte;
     nValor2  = nValor2 - nSuma1;
     |SI nValor2 ! 0;  nHay = nHay + 1;  |FINSI;

     enBloque = 2;  eaCasilla = "031"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte;
     enBloque = 3;  eaCasilla = "047"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte;
     enBloque = 4;  eaCasilla = "080"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte;
     enBloque = 9;  eaCasilla = "245"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte;
     enBloque = 10; eaCasilla = "255"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte;
     enBloque = 11; eaCasilla = "265"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte;
     enBloque = 12; eaCasilla = "275"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte;
     enBloque = 1;  eaCasilla = "015"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte;

     |SI nHay ! 0;
         |SI nValor1 ] 1000;
             nContaAct = 2;
         |FINSI;
     |FINSI;

     nValor2  = 0;
     enBloque = 21; eaCasilla = "442"; |HAZ SacaImporte; nValor2 = nValor2 + enImporte;
     enBloque = 22; eaCasilla = "445"; |HAZ SacaImporte; nValor2 = nValor2 + enImporte;

     |SI nValor2 ] 500;
         nContaAct = 2;
     |FINSI;

     #1001#5 = "";
     |SI nContaAct > 1;  #1001#4 = "S";  |FINSI;

     enBloque = 4; eaCasilla = "080"; |HAZ SacaImporte;
     |SI enImporte > #401#78;  #1001#4 = "S";  |FINSI;

     enBloque = 9; eaCasilla = "245"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";    |FINSI;

     enBloque = 10; eaCasilla = "255"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";    |FINSI;

     enBloque = 11; eaCasilla = "265"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";    |FINSI;

     enBloque = 12; eaCasilla = "275"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";    |FINSI;

     aDef    = eaPathDef + "rem01011.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1011"#;  |FINSI;

     nImput = 0;
     |BUCLE rem01011_6;

     |DESCARGA_DEF #datfic0@;

     aDef    = eaPathDef + "rem01012.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1012"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 040#0=;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
     |CIERRA #0;

     nValor = #0#13 - #0#5;

     enBloque = 13;  eaCasilla = "300"; |HAZ SacaImporte;
     nValor = nValor + enImporte;

     enBloque = 15;  eaCasilla = "329"; |HAZ SacaImporte;
     nValor = nValor + enImporte;

     |SI nValor > #401#73;  #1001#4 = "S";  |FINSI;

     nValor = #0#5 + nImput;
     |SI nValor > #401#79;  #1001#4 = "S";  |FINSI;

     |DESCARGA_DEF #datfic0@;

     |SI nAlquiler > 0;
         aDef    = eaPathDef + "rem01033.mas";
         |CARGA_DEF aDef, datfic0@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def " + aDef;
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1033"#;  |FINSI;

         aDef    = eaPathDef + "rem01018.mas";
         |CARGA_DEF aDef, datfic1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def " + aDef;
             |MENAV aAlfa;
             |DESCARGA_DEF #datfic0@;
             |ACABA;
         |FINSI;

         |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1018"#;  |FINSI;

         |ABRE #0;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |LEE 040#0=;
         |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
         |CIERRA #0;

         |ABRE #1;
         #1#0 = #1001#0;
         #1#1 = #1001#1;
         #1#2 = #1001#2;
         |LEE 040#1=;
         |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
         |CIERRA #1;

         enBloque = 4;  eaCasilla = "080"; |HAZ SacaImporte;
         nValor   = #1#15  + #1#16 + #1#19 + #1#7 + #1#8;
         nValor   = nValor + #1#11 + #1#13 + #0#102;
         nValor   = nValor + #0#31 - #0#32 + #0#35 - #0#36;
         nValor   = nValor + enImporte;

         |SI nValor > 1000;
             #1001#4 = "S";
         |FINSI;

         |DESCARGA_DEF #datfic1@;
         |DESCARGA_DEF #datfic0@;
     |FINSI;

     #1001#13 = #1001#5;

     |SI #1001#4 = "S";  |ACABA;  |FINSI;

     enBloque  = 39; eaCasilla = "760"; |HAZ SacaImporte;
     |SI enImporte ] 0;  |ACABA;  |FINSI;

     enBloque  = 31;
     eaCasilla = "611";  |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "R";  |FINSI;

     eaCasilla = "612";  |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "R";  |FINSI;

     eaCasilla = "613";  |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "R";  |FINSI;

     eaCasilla = "614";  |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "R";  |FINSI;

     enBloque  = 35;  eaCasilla = "700";  |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "R";  |FINSI;
|FPRC;

|PROCESO EsIndividual;
     aDef    = eaPathDef + "rem00100.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     |LEE 101#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |SI #1#40 = "    ";  #1#40 = "0000";  |FINSI;

     |SI nSwConjunta = 0;  |Y #1#40 = "0000";  |Y enConta = 7;
         eaLiquida = #1001#2;
         |HAZ BorraLiquidacion;
         eaLiquida = "";
     |FINSI;

     |SI nSwConjuntaE = 0;  |Y enConta = 8;
         eaLiquida = #1001#2;
         |HAZ BorraLiquidacion;
         eaLiquida = "";
     |FINSI;

     |SI eaMuerto ! "";  |Y enConta = 7;
         eaLiquida = #1001#2;
         |HAZ BorraLiquidacion;
         eaLiquida = "";
     |FINSI;

     |DESCARGA_DEF #datfic1@;
|FPRC;

|PROCESO Bloque6;
     enEdadCon = 0;
     enEdadTit = 0;

     |ABRE #999;

     |SELECT #2#999;
     #999#1 = "CONYUGE   ";
     |LEE 040#999=;
     |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;

     nSwConyuge = 0;
     |SI #999#6 ! 0;
         nSwConyuge = 1;
         enEdadCon   = #999#6;
     |FINSI;

     |SELECT #2#999;
     #999#1 = "TITULAR   ";
     |LEE 040#999=;
     |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;

     nSwTitular = 0;
     |SI #999#6 ! 0;
         nSwTitular = 1;
         enEdadTit   = #999#6;
     |FINSI;

     |CIERRA #999;

     |DDEFECTO #1001;
     FSalida      = 0;
     #1001#0      = enEmpresa;
     #1001#1      = enComplementaria;
     nLimite1     = 0;
     nLimite2     = 0;
     nValorTit    = 0;
     nValorCon    = 0;
     nCompeT      = 0;
     nCompeC      = 0;
     nSwConjunta  = 0;
     nSwConjuntaE = 0;
     nSwBorrar1   = 0;
     nSwBorrar2   = 0;
     nPagadoresC  = 0;
     aCalcP       = "";
     nCalcP       = 0;
     nRedTrab1    = 0;
     nRedTrab2    = 0;
     nRedTrab3    = 0;
     nRedTrab4    = 0;
     nRedTrab5    = 0;
     nRedTrab6    = 0;
     aProlon1     = "";
     aProlon2     = "";
     aProlon3     = "";
     aProlon4     = "";
     aProlon5     = "";
     aProlon6     = "";
     aMovili1     = "";
     aMovili2     = "";
     aMovili3     = "";
     aMovili4     = "";
     aMovili5     = "";
     aMovili6     = "";
     nEjerMo1     = 0;
     nEjerMo2     = 0;
     nEjerMo3     = 0;
     nEjerMo4     = 0;
     nEjerMo5     = 0;
     nEjerMo6     = 0;
     nRentas1     = 0;
     nRentas2     = 0;
     nRentas3     = 0;
     nRentas4     = 0;
     nRentas5     = 0;
     nRentas6     = 0;
     nRdtosTrab1  = 0;
     nRdtosTrab2  = 0;
     nRdtosTrab3  = 0;
     nRdtosTrab4  = 0;
     nRdtosTrab5  = 0;
     nRdtosTrab6  = 0;
     nRdtosTrab7  = 0;
     nActivo1     = 0;
     nActivo2     = 0;
     nActivo3     = 0;
     nActivo4     = 0;
     nActivo5     = 0;
     nActivo6     = 0;
     nRdtosTrab   = 0;

     nCam28       = 0;
     nCam105      = 0;
     nCam115      = 0;
     nCam106      = 0;
     nCam116      = 0;
     nCam106M     = 0;
     nCam116M     = 0;
     nMinFam_G    = 0;
     nMinFamE_G   = 0;
     nMinFam_A    = 0;
     nMinFamE_A   = 0;

     |PARA enConta = 1;  |SI enConta [ 8;  |HACIENDO enConta = enConta + 1;
           |SI enConta = 1;   #1001#2 = "TITULAR   ";  |FINSI;
           |SI enConta = 2;   #1001#2 = "CONYUGE   ";  |FINSI;
           |SI enConta = 3;   #1001#2 = "1 FAMILIAR";  |FINSI;
           |SI enConta = 4;   #1001#2 = "2 FAMILIAR";  |FINSI;
           |SI enConta = 5;   #1001#2 = "3 FAMILIAR";  |FINSI;
           |SI enConta = 6;   #1001#2 = "4 FAMILIAR";  |FINSI;
           |SI enConta = 7;   #1001#2 = "CONJUNTA  ";  |FINSI;
           |SI enConta = 8;   #1001#2 = "CONJUNTAE ";  |FINSI;

           |LEE 101#1001=;
           |SI FSalida ! 0;  |Y enConta = 2;  |Y nSwConyuge = 1;
                #1001#0    = enEmpresa;
                #1001#1    = enComplementaria;
                #1001#2    = "CONYUGE   ";
                nSwBorrar2 = 1;
                |GRABA 020#1001b;
            |FINSI;

            |SI FSalida ! 0;  |Y enConta = 1;  |Y nSwTitular = 1;
                #1001#0    = enEmpresa;
                #1001#1    = enComplementaria;
                #1001#2    = "TITULAR   ";
                nSwBorrar1 = 1;
                |GRABA 020#1001b;
            |FINSI;

            |SI FSalida = 0;
                |HAZ Trabajo;
                |HAZ CalculaH;
                |HAZ CalculaI1;
                |HAZ CalculaI2;

                |GRABA 020#1001a;
                |LIBERA #1001;
            |FINSI;
     |SIGUE;

     |PARA enConta = 1;  |SI enConta [ 8;  |HACIENDO enConta = enConta + 1;
           |SI enConta = 1;   #1001#2 = "TITULAR   ";  |FINSI;
           |SI enConta = 2;   #1001#2 = "CONYUGE   ";  |FINSI;
           |SI enConta = 3;   #1001#2 = "1 FAMILIAR";  |FINSI;
           |SI enConta = 4;   #1001#2 = "2 FAMILIAR";  |FINSI;
           |SI enConta = 5;   #1001#2 = "3 FAMILIAR";  |FINSI;
           |SI enConta = 6;   #1001#2 = "4 FAMILIAR";  |FINSI;
           |SI enConta = 7;   #1001#2 = "CONJUNTA  ";  |FINSI;
           |SI enConta = 8;   #1001#2 = "CONJUNTAE ";  |FINSI;
           |LEE 101#1001=;
           |SI FSalida = 0;
               |HAZ  Calcula505;
           |FINSI;
     |SIGUE;

     |PARA enConta = 1;  |SI enConta [ 8;  |HACIENDO enConta = enConta + 1;
           |SI enConta = 1;   #1001#2 = "TITULAR   ";  |FINSI;
           |SI enConta = 2;   #1001#2 = "CONYUGE   ";  |FINSI;
           |SI enConta = 3;   #1001#2 = "1 FAMILIAR";  |FINSI;
           |SI enConta = 4;   #1001#2 = "2 FAMILIAR";  |FINSI;
           |SI enConta = 5;   #1001#2 = "3 FAMILIAR";  |FINSI;
           |SI enConta = 6;   #1001#2 = "4 FAMILIAR";  |FINSI;
           |SI enConta = 7;   #1001#2 = "CONJUNTA  ";  |FINSI;
           |SI enConta = 8;   #1001#2 = "CONJUNTAE ";  |FINSI;
           |LEE 101#1001=;
           |SI FSalida = 0;
               |HAZ CalculaI2;
               |HAZ CalculaI6;
               |HAZ CalculaJ;
               |HAZ CalculaL;
               |HAZ CalculaM;
               |HAZ CalculaO;
               |HAZ SeleccionRenta;

                enBloque  = 39; eaCasilla = "760"; |HAZ SacaImporte;
                #1001#3  = enImporte;
                #1001#15 = enImporte;
                #1001#16 = enImporte;

                |GRABA 020#1001a;
                |LIBERA #1001;

                |SI enConta ] 7;
                    |HAZ EsIndividual;
                |FINSI;
            |FINSI;

            |SI nSwBorrar1 = 1; |Y enConta = 1;
                eaLiquida = #1001#2;
                |HAZ BorraLiquidacion;
                eaLiquida = "";
            |FINSI;

            |SI nSwBorrar2 = 1; |Y enConta = 2;
                eaLiquida = #1001#2;
                |HAZ BorraLiquidacion;
                eaLiquida = "";
            |FINSI;
     |SIGUE;
|FPRC;
