|FICHEROS;
     rez00200;
     rem00200;
     rem00201;
     rem00202,MANTE;

     rem00025;
     rem00026;
     rem00027;
     rem00028;

     rew00800,MANTE;

     trabajo@;
     trabajo1@;
     trabajo2@;
     trabajo3@;
|FIN;

|VARIABLES;
     nVentana        = 0;
     nVentTrab       = 0;
     nVentRev        = 0;
     nPanta          = 0;
     nPanta800       = 0;
     nRango          = 0;
     nGrid           = 0;
     nGrid1          = 0;
     nGrid2          = 0;
     nGrid3          = 0;
     nGrid4          = 0;
     nGrid201        = 0;
     nBtnAlta        = 0;
     nBtnModi        = 0;
     nBtnBaja        = 0;
     nBtnReva        = 0;
     nCampo          = 0;
     nCampo800       = 0;
     nLinea          = 0;
     nIDE            = 0;
     nCoef           = 0;
     nBtnSal         = 0;

     aEsc1           = "";
     aEsc2           = "";
     aRetu           = "";
     aTecla          = "";
     aDef            = "";
     aMas            = "";
     aAlfa           = "";

 {-1}aVent           = "";
     aVent1          = 0;
     aVent2          = 0;
     aVent3          = 0;
     aVent4          = 0;
     aVent5          = "";

     &enEmpresa      = 0;
     &enModo         = 0;
     &enModoReg      = 0;
|FIN;

|PROCESO rem00202Calc;
     #trabajo@#6  = #trabajo@#6  + #rem00202#6;
     #trabajo@#7  = #trabajo@#7  + #rem00202#7;
     #trabajo@#9  = #trabajo@#9  + #rem00202#9;
     #trabajo@#10 = #trabajo@#10 + #rem00202#10;
|FPRC;

|DEFBUCLE rem00202Calc;
     #rem00202#1;
     ;
     #rem00201#0, #rem00201#1, #rem00201#2, #rem00201#3, 01;
     #rem00201#0, #rem00201#1, #rem00201#2, #rem00201#3, 30;
     be;
     NULL, rem00202Calc;
|FIN;

|PROCESO Calculo;
     |DDEF aMas;
     aMas = aMas + "rem00202.mas";
     |CARGA_DEF aMas, trabajo@;

     |ABRE #trabajo@;
     #trabajo@#0 = #rem00202#0;
     #trabajo@#1 = #rem00202#1;
     #trabajo@#2 = #rem00202#2;
     #trabajo@#3 = #rem00202#3;
     #trabajo@#4 = 31;
     |LEE 101#trabajo@.=;
     |SI FSalida = 0;
         #trabajo@#6  = 0;
         #trabajo@#7  = 0;
         #trabajo@#9  = 0;
         #trabajo@#10 = 0;

         |BUCLE rem00202Calc;

         |GRABA 020#trabajo@.a;
         |LIBERA #trabajo@;

         #rew00800#16 = #trabajo@#9 - #trabajo@#10 - #trabajo@#6 - #trabajo@#7;
         |PINTA #rew00800#16;
     |FINSI;
     |CIERRA #trabajo@;

     |DESCARGA_DEF #trabajo@;
|FPRC;

|PROCESO PintaDatosPantalla;
     |PARA nCampo = 4;  |SI nCampo [ 18;  |HACIENDO nCampo = nCampo + 1;
           nCampo800  = nCampo + 3;

           #rew00800#nCampo800# = #rem00201#nCampo#;

           |C_V #rew00800#nCampo800#, 0, aAlfa;
           |SI aAlfa = "S";  |PINTA #rew00800#nCampo800#;  |FINSI;

           |C_M #rew00800#nCampo800#, 1, "N";
     |SIGUE;

     #rew00800#23 = #rem00201#19;
|FPRC;

|PROCESO CargaFantasma;
     |C_M #rew00800#7,  1, "S";
     |C_M #rew00800#8,  1, "S";
     |C_M #rew00800#10, 1, "S";
     |C_M #rew00800#11, 1, "S";
     |C_M #rew00800#12, 1, "S";
     |C_M #rew00800#13, 1, "S";
     |C_M #rew00800#14, 1, "S";
     |C_M #rew00800#15, 1, "S";
     |C_M #rew00800#17, 1, "S";
     |C_M #rew00800#19, 1, "S";
     |C_M #rew00800#20, 1, "S";
     |C_M #rew00800#23, 1, "S";

     |PARA nCampo = 4;  |SI nCampo [ 18;  |HACIENDO nCampo = nCampo + 1;
           nCampo800  = nCampo + 3;

           #rew00800#nCampo800# = #rem00201#nCampo#;

           |C_V #rew00800#nCampo800#, 0, aAlfa;
           |SI aAlfa = "S";  |PINTA #rew00800#nCampo800#;  |FINSI;
     |SIGUE;

     |PINTA #rew00800#23;
|FPRC;

|PROCESO DescargaFantasma;
     |PARA nCampo = 4;  |SI nCampo [ 18;  |HACIENDO nCampo = nCampo + 1;
           nCampo800  = nCampo + 3;
           #rem00201#nCampo# = #rew00800#nCampo800#;
     |SIGUE;

     #rem00201#19 = #rew00800#23;

     |HAZ PintaDatosPantalla;
|FPRC;

|PROCESO Graba202;
     nIDE = nIDE + 1;

     #rem00202#0 = #rem00201#0;
     #rem00202#1 = #rem00201#1;
     #rem00202#2 = #rem00201#2;
     #rem00202#3 = #rem00201#3;
     #rem00202#4 = nIDE;
     |LEE 101#rem00202.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00202;
         #rem00202#0 = #rem00201#0;
         #rem00202#1 = #rem00201#1;
         #rem00202#2 = #rem00201#2;
         #rem00202#3 = #rem00201#3;
         #rem00202#4 = nIDE;
         |GRABA 020#rem00202.b;
     |FINSI;

     #rem00202#5 = aAlfa;
     #rem00202#8 = nCoef;
     |GRABA 020#rem00202.a;
     |LIBERA #rem00202;
|FPRC;

|PROCESO CargaRevalorizacion;
     nIDE   = 0;

     aAlfa = "1983 y anteriores";  nCoef = 2.2946;  |HAZ Graba202;
     aAlfa = "      1984       ";  nCoef = 2.0836;  |HAZ Graba202;
     aAlfa = "      1985       ";  nCoef = 1.9243;  |HAZ Graba202;
     aAlfa = "      1986       ";  nCoef = 1.8116;  |HAZ Graba202;
     aAlfa = "      1987       ";  nCoef = 1.7258;  |HAZ Graba202;
     aAlfa = "      1988       ";  nCoef = 1.6487;  |HAZ Graba202;
     aAlfa = "      1989       ";  nCoef = 1.5768;  |HAZ Graba202;
     aAlfa = "      1990       ";  nCoef = 1.5151;  |HAZ Graba202;
     aAlfa = "      1991       ";  nCoef = 1.4633;  |HAZ Graba202;
     aAlfa = "      1992       ";  nCoef = 1.4309;  |HAZ Graba202;
     aAlfa = "      1993       ";  nCoef = 1.4122;  |HAZ Graba202;
     aAlfa = "      1994       ";  nCoef = 1.3867;  |HAZ Graba202;
     aAlfa = "      1995       ";  nCoef = 1.3312;  |HAZ Graba202;
     aAlfa = "      1996       ";  nCoef = 1.2679;  |HAZ Graba202;
     aAlfa = "      1997       ";  nCoef = 1.2396;  |HAZ Graba202;
     aAlfa = "      1998       ";  nCoef = 1.2235;  |HAZ Graba202;
     aAlfa = "      1999       ";  nCoef = 1.2150;  |HAZ Graba202;
     aAlfa = "      2000       ";  nCoef = 1.2089;  |HAZ Graba202;
     aAlfa = "      2001       ";  nCoef = 1.1839;  |HAZ Graba202;
     aAlfa = "      2002       ";  nCoef = 1.1696;  |HAZ Graba202;
     aAlfa = "      2003       ";  nCoef = 1.1499;  |HAZ Graba202;
     aAlfa = "      2004       ";  nCoef = 1.1389;  |HAZ Graba202;
     aAlfa = "      2005       ";  nCoef = 1.1238;  |HAZ Graba202;
     aAlfa = "      2006       ";  nCoef = 1.1017;  |HAZ Graba202;
     aAlfa = "      2007       ";  nCoef = 1.0781;  |HAZ Graba202;
     aAlfa = "      2008       ";  nCoef = 1.0446;  |HAZ Graba202;
     aAlfa = "      2009       ";  nCoef = 1.0221;  |HAZ Graba202;
     aAlfa = "      2010       ";  nCoef = 1.0100;  |HAZ Graba202;
     aAlfa = "      2011       ";  nCoef = 1.0100;  |HAZ Graba202;
     aAlfa = "      2012       ";  nCoef = 1.0000;  |HAZ Graba202;
     aAlfa = "    Totales      ";  nCoef = 0;       |HAZ Graba202;
|FPRC;

|PROCESO Alta;
     |ESTADO_CONTROL nBtnAlta, "DISABLE";
     |ESTADO_CONTROL nBtnModi, "DISABLE";
     |ESTADO_CONTROL nBtnBaja, "DISABLE";
     |ESTADO_CONTROL nBtnReva, "ENABLE";

     |HAZ QuitaBotonSalir;

     |ESTADO_CONTROL nGrid201, "DISABLE";

     |PULSATECLA;

     #rem00201#0 = #rem00200#0;
     #rem00201#1 = #rem00200#1;
     #rem00201#2 = #rem00200#2;
     #rem00201#3 = 9999;
     |LEE 000#rem00201.];
     |SI FSalida = 0;
         |LEE 000#rem00201.a;
     |SINO;
         |LEE 000#rem00201.u;
     |FINSI;

     nLinea = 1;
     |SI FSalida = 0;  |Y #rem00201#0 = #rem00200#0;
                       |Y #rem00201#1 = #rem00200#1;
                       |Y #rem00201#2 = #rem00200#2;
         nLinea = #rem00201#3 + 1;
     |FINSI;

     |DDEFECTO #rem00201;

     #rem00201#0 = #rem00200#0;
     #rem00201#1 = #rem00200#1;
     #rem00201#2 = #rem00200#2;
     #rem00201#3 = nLinea;

     |SI #rem00200#9 ! 0;
         #rem00201#17 = #rem00200#9;
     |FINSI;

     enModoReg = 1;
     |HAZ CargaFantasma;
     |HAZ CargaRevalorizacion;

     |ENDATOS #1#rew00800;
     |SI FSalida = 0;
         |HAZ DescargaFantasma;

         |GRABA 020#rem00201.n;
     |FINSI;
     |LIBERA #rem00201;

     |ESTADO_CONTROL nBtnAlta, "ENABLE";

     |ESTADO_CONTROL nBtnReva, "DISABLE";

     |HAZ PonBotonSalir;

     |ESTADO_CONTROL nGrid201, "ENABLE";
     |REFRESCACONTROL nGrid201;

     FSalida = 1;  |HAZ Evento201;

     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO Modificar;
     |LEE 101#rem00201.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ESTADO_CONTROL nBtnAlta,  "DISABLE";
     |ESTADO_CONTROL nBtnModi,  "DISABLE";
     |ESTADO_CONTROL nBtnBaja,  "DISABLE";
     |ESTADO_CONTROL nBtnReva,  "ENABLE";

     |HAZ QuitaBotonSalir;

     |ESTADO_CONTROL nGrid201, "DISABLE";

     |HAZ CargaFantasma;
     |ENDATOS #2#rew00800;
     |SI FSalida = 0;
         |HAZ DescargaFantasma;

         |GRABA 020#rem00201.a;
     |FINSI;
     |LIBERA #rem00201;

     |ESTADO_CONTROL nBtnAlta, "ENABLE";
     |ESTADO_CONTROL nBtnModi, "ENABLE";
     |ESTADO_CONTROL nBtnBaja, "ENABLE";

     |ESTADO_CONTROL nBtnReva, "DISABLE";

     |HAZ PonBotonSalir;

     |ESTADO_CONTROL nGrid201, "ENABLE";
     |REFRESCACONTROL nGrid201;
     |FOCOTECLADO nGrid201;
|FPRC;

|PROCESO rem00202B;
     |BORRA 020#rem00202.a;
     |LIBERA #rem00202;
|FPRC;

|DEFBUCLE rem00202B;
     #rem00202#1;
     ;
     #rem00201#0, #rem00201#1, #rem00201#2, #rem00201#3, 01;
     #rem00201#0, #rem00201#1, #rem00201#2, #rem00201#3, 99;
     be;
     NULL, rem00202B;
|FIN;

|PROCESO Baja;
     |CONFI "0000 Confirma la baja del registro seleccionado";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |LEE 101#rem00201.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BORRA 020#rem00201.a;
     |LIBERA #rem00201;

     |BUCLE rem00202B;

     |ESTADO_CONTROL nBtnModi,  "DISABLE";
     |ESTADO_CONTROL nBtnBaja,  "DISABLE";

     |REFRESCACONTROL nGrid201;
     |FOCOTECLADO nGrid201;
|FPRC;

|PROCESO BotonSalir;
     |PTEC 806;
|FPRC;

|PROCESO Baja202;
     #rem00202#0 = #rem00201#0;
     #rem00202#1 = #rem00201#1;
     #rem00202#2 = #rem00201#2;
     #rem00202#3 = #rem00201#3;
     #rem00202#4 = 1;
|FPRC;

|PROCESO Alta202;
     #rem00202#0 = #rem00201#0;
     #rem00202#1 = #rem00201#1;
     #rem00202#2 = #rem00201#2;
     #rem00202#3 = #rem00201#3;
     #rem00202#4 = 99;
|FPRC;

|PROCESO Evento202;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#rem00202.=;
     |FINSI;
|FPRC;

|PROCESO Revalorizar;
     |VENTANA 0501, 3599, -1, 16, "Revalorizacion";
     nVentRev = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentRev;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Salir", 3588, 3598, BotonSalir;
     nBtnSal = FSalida;

     nRango = 1 + 4 + 8 + 16 + 128 + 256;

     |LINEAL_SIMPLE #1#rem00202, nRango, 0502, 3398, Baja202, Alta202, Evento202;

     |FIN_CONTROL_WINDOWS nBtnSal;

     |HAZ Calculo;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentRev;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentRev;

     |POSICIONATE #rew00800#17;
     |PTEC 808;
     |PTEC 809;
     |PTEC 809;
|FPRC;

|PROCESO Evento201;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#rem00201.=;

         |ESTADO_CONTROL nBtnModi, "ENABLE";
         |ESTADO_CONTROL nBtnBaja, "ENABLE";

         |PULSATECLA;

         enModoReg = 4;
         |HAZ PintaDatosPantalla;
     |FINSI;

     |SI FSalida = 4;
         |HAZ Modificar;
     |FINSI;
|FPRC;

|PROCESO Baja201;
     #rem00201#0 = #rem00200#0;
     #rem00201#1 = #rem00200#1;
     #rem00201#2 = #rem00200#2;
     #rem00201#3 = 1;
|FPRC;

|PROCESO Alta201;
     #rem00201#0 = #rem00200#0;
     #rem00201#1 = #rem00200#1;
     #rem00201#2 = #rem00200#2;
     #rem00201#3 = 9999;
|FPRC;

|PROCESO BotonesPanta800;
     |CONTROL_SIMPLE nPanta800, "BOTON,{{193}}&Alta ", 2164, 2174, Alta;
     nBtnAlta = FSalida;

     |CONTROL_SIMPLE nPanta800, "BOTON,{{197}}&Modificar ", 2176, 2186, Modificar;
     nBtnModi = FSalida;

     |CONTROL_SIMPLE nPanta800, "BOTON,{{199}}&Borrar", 2188, 2198, Baja;
     nBtnBaja = FSalida;

     |CONTROL_SIMPLE nPanta800, "BOTON,{{197}}&Revalorizaci¢n", 3083, 3098, Revalorizar;
     nBtnReva = FSalida;

     |ESTADO_CONTROL nBtnModi,  "DISABLE";
     |ESTADO_CONTROL nBtnBaja,  "DISABLE";
     |ESTADO_CONTROL nBtnReva,  "DISABLE";
|FPRC;

|PROCESO Activos;
     |SI nGrid = 1;
         #rem00200#0 = #trabajo1@#0;
         #rem00200#1 = #trabajo1@#1;
         #rem00200#2 = #trabajo1@#2;
     |FINSI;

     |SI nGrid = 2;
         #rem00200#0 = #trabajo2@#0;
         #rem00200#1 = #trabajo2@#1;
         #rem00200#2 = #trabajo2@#2;
     |FINSI;

     |SI nGrid = 3;
         #rem00200#0 = #trabajo3@#0;
         #rem00200#1 = #trabajo3@#1;
         #rem00200#2 = #trabajo3@#2;
     |FINSI;

     |LEE 000#rem00200.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |VENTANA 0501, 3599, -1, 16, "Activos";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |DDEFECTO #rew00800;

     #rew00800#0  = #rem00200#3;
     #rew00800#1  = #rem00200#4;
     #rew00800#2  = #rem00200#5;
     #rew00800#3  = #rem00200#6;
     #rew00800#4  = #rem00200#7;
     #rew00800#5  = #rem00200#8;
     #rew00800#6  = #rem00200#9;
     #rew00800#22 = #rem00200#10;

     |PINPA #0#rew00800;  nPanta800 = FSalida;
     |PINDA #0#rew00800;

     |HAZ BotonesPanta800;

     |LINEAL_SIMPLE #1#rem00201, nRango, 1102, 2098, Baja201, Alta201, Evento201;
     nGrid201 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
            FSalida = "::{{001}}Salir," + nGrid201;
            |LEETECLA aTecla;
            |SI aTecla = aEsc1; |SAL;  |FINSI;
            |SI aTecla = aEsc2; |SAL;  |FINSI;
            |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;
|FPRC;

|PROCESO rem00025;
     #rem00200#0 = enEmpresa;
     #rem00200#1 = "E1";
     #rem00200#2 = #rem00025#1;
     |LEE 101#rem00200.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00200;
         #rem00200#0 = enEmpresa;
         #rem00200#1 = "E1";
         #rem00200#2 = #rem00025#1;
         |GRABA 020#rem00200.b;
     |FINSI;

                              #rem00200#3 = "A";
     |SI #rem00025#18 = "E";  #rem00200#3 = "A";  |FINSI;
     |SI #rem00025#18 = "O";  #rem00200#3 = "B";  |FINSI;
     |SI #rem00025#18 = "P";  #rem00200#3 = "C";  |FINSI;

     #rem00200#4 = #rem00025#19;
     #rem00200#5 = #rem00025#22;
     #rem00200#6 = "ED";

     #rem00200#7  = "";
     #rem00200#8  = "";
     #rem00200#9  = 0;
     #rem00200#10 = #rem00025#2;
     #rem00200#11 = #rem00025#5;
     #rem00200#12 = #rem00025#6;

     |SI #rem00025#14 = "S";
         #rem00200#7 = #rem00025#21;
         #rem00200#8 = #rem00025#58;
         #rem00200#9 = #rem00025#15;
     |FINSI;

     |GRABA 020#rem00200.a;
     |LIBERA #rem00200;
|FPRC;

|DEFBUCLE rem00025;
     #rem00025#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     ;
     NULL, rem00025;
|FIN;

|PROCESO rem00026;
     #rem00200#0 = enEmpresa;
     #rem00200#1 = "E2";
     #rem00200#2 = #rem00026#1;
     |LEE 101#rem00200.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00200;
         #rem00200#0 = enEmpresa;
         #rem00200#1 = "E2";
         #rem00200#2 = #rem00026#1;
         |GRABA 020#rem00200.b;
     |FINSI;

                              #rem00200#3 = "A";
     |SI #rem00026#18 = "E";  #rem00200#3 = "A";  |FINSI;
     |SI #rem00026#18 = "O";  #rem00200#3 = "B";  |FINSI;
     |SI #rem00026#18 = "P";  #rem00200#3 = "C";  |FINSI;

     #rem00200#4 = #rem00026#19;
     #rem00200#5 = #rem00026#22;
     #rem00200#6 = "EDS";

     #rem00200#7  = "";
     #rem00200#8  = "";
     #rem00200#9  = 0;
     #rem00200#10 = #rem00026#2;
     #rem00200#11 = #rem00026#5;
     #rem00200#12 = #rem00026#6;

     |SI #rem00026#14 = "S";
         #rem00200#7 = #rem00026#21;
         #rem00200#8 = #rem00026#60;
         #rem00200#9 = #rem00026#15;
     |FINSI;

     |GRABA 020#rem00200.a;
     |LIBERA #rem00200;
|FPRC;

|DEFBUCLE rem00026;
     #rem00026#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     ;
     NULL, rem00026;
|FIN;

|PROCESO rem00027;
     #rem00200#0 = enEmpresa;
     #rem00200#1 = "E3";
     #rem00200#2 = #rem00027#1;
     |LEE 101#rem00200.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00200;
         #rem00200#0 = enEmpresa;
         #rem00200#1 = "E3";
         #rem00200#2 = #rem00027#1;
         |GRABA 020#rem00200.b;
     |FINSI;

                              #rem00200#3 = "A";
     |SI #rem00027#16 = "E";  #rem00200#3 = "A";  |FINSI;
     |SI #rem00027#16 = "O";  #rem00200#3 = "B";  |FINSI;
     |SI #rem00027#16 = "P";  #rem00200#3 = "C";  |FINSI;

     #rem00200#4 = #rem00027#17;
     #rem00200#5 = #rem00027#20;
     #rem00200#6 = "EO";

     #rem00200#7  = "";
     #rem00200#8  = "";
     #rem00200#9  = 0;
     #rem00200#10 = #rem00027#2;
     #rem00200#11 = #rem00027#5;
     #rem00200#12 = #rem00027#6;

     |SI #rem00027#14 = "S";
         #rem00200#7 = #rem00027#19;
         #rem00200#8 = #rem00027#126;
         #rem00200#9 = #rem00027#15;
     |FINSI;

     |GRABA 020#rem00200.a;
     |LIBERA #rem00200;
|FPRC;

|DEFBUCLE rem00027;
     #rem00027#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     ;
     NULL, rem00027;
|FIN;

|PROCESO rem00028;
     #rem00200#0 = enEmpresa;
     #rem00200#1 = "E4";
     #rem00200#2 = #rem00028#1;
     |LEE 101#rem00200.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00200;
         #rem00200#0 = enEmpresa;
         #rem00200#1 = "E4";
         #rem00200#2 = #rem00028#1;
         |GRABA 020#rem00200.b;
     |FINSI;

                              #rem00200#3 = "A";
     |SI #rem00028#18 = "E";  #rem00200#3 = "A";  |FINSI;
     |SI #rem00028#18 = "O";  #rem00200#3 = "B";  |FINSI;
     |SI #rem00028#18 = "P";  #rem00200#3 = "C";  |FINSI;

     #rem00200#4 = #rem00028#19;
     #rem00200#5 = #rem00028#21;
     #rem00200#6 = "EO";

     #rem00200#7  = "";
     #rem00200#8  = "";
     #rem00200#9  = 0;
     #rem00200#10 = #rem00028#2;
     #rem00200#11 = #rem00028#5;
     #rem00200#12 = #rem00028#6;

     |SI #rem00028#14 = "S";
         #rem00200#7 = #rem00028#20;
         #rem00200#8 = #rem00028#69;
         #rem00200#9 = #rem00028#15;
     |FINSI;

     |GRABA 020#rem00200.a;
     |LIBERA #rem00200;
|FPRC;

|DEFBUCLE rem00028;
     #rem00028#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     ;
     NULL, rem00028;
|FIN;

|PROCESO TraeActividades;
     |VENTANA 0501, 0540, -1, 16, "Procesando trabajo";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |BUCLE rem00025;
     |BUCLE rem00026;
     |BUCLE rem00027;
     |BUCLE rem00028;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;
|FPRC;

|PROCESO EventoTrab1;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#trabajo1@.=;
     |FINSI;

     |SI FSalida = 4;
         nGrid = 1;   |HAZ Activos;
     |FINSI;
|FPRC;

|PROCESO BajaTrab1;
     #trabajo1@#0 = enEmpresa;
     #trabajo1@#3 = "A";
     #trabajo1@#4 = "";
|FPRC;

|PROCESO AltaTrab1;
     #trabajo1@#0 = enEmpresa;
     #trabajo1@#3 = "A";
     #trabajo1@#4 = "zzzz";
|FPRC;

|PROCESO EventoTrab2;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#trabajo2@.=;
     |FINSI;

     |SI FSalida = 4;
         nGrid = 2;   |HAZ Activos;
     |FINSI;
|FPRC;

|PROCESO BajaTrab2;
     #trabajo2@#0 = enEmpresa;
     #trabajo2@#3 = "B";
     #trabajo2@#4 = "";
|FPRC;

|PROCESO AltaTrab2;
     #trabajo2@#0 = enEmpresa;
     #trabajo2@#3 = "B";
     #trabajo2@#4 = "zzzz";
|FPRC;

|PROCESO EventoTrab3;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#trabajo3@.=;
     |FINSI;

     |SI FSalida = 4;
         nGrid = 3;   |HAZ Activos;
     |FINSI;
|FPRC;

|PROCESO BajaTrab3;
     #trabajo3@#0 = enEmpresa;
     #trabajo3@#3 = "C";
     #trabajo3@#4 = "";
|FPRC;

|PROCESO AltaTrab3;
     #trabajo3@#0 = enEmpresa;
     #trabajo3@#3 = "C";
     #trabajo3@#4 = "zzzz";
|FPRC;

|PROCESO rem00201B;
     |BUCLE rem00202B;

     |BORRA 020#rem00201.a;
     |LIBERA #rem00201;
|FPRC;

|DEFBUCLE rem00201B;
     #rem00201#1;
     ;
     #rem00200#0, #rem00200#1, #rem00200#2, 0001;
     #rem00200#0, #rem00200#1, #rem00200#2, 9999;
     be;
     NULL, rem00201B;
|FIN;

|PROCESO rem00200B;
     |SI #rem00200#1 = "E1";
         |ABRE #rem00025;
         #rem00025#0 = #rem00200#0;
         #rem00025#1 = #rem00200#2;
         |LEE 000#rem00025.=;
         |SI FSalida = 0;  |CIERRA #rem00025;  |ACABA;  |FINSI;
         |CIERRA #rem00025;
     |FINSI;

     |SI #rem00200#1 = "E2";
         |ABRE #rem00026;
         #rem00026#0 = #rem00200#0;
         #rem00026#1 = #rem00200#2;
         |LEE 000#rem00026.=;
         |SI FSalida = 0;  |CIERRA #rem00026;  |ACABA;  |FINSI;
         |CIERRA #rem00026;
     |FINSI;

     |SI #rem00200#1 = "E3";
         |ABRE #rem00027;
         #rem00027#0 = #rem00200#0;
         #rem00027#1 = #rem00200#2;
         |LEE 000#rem00027.=;
         |SI FSalida = 0;  |CIERRA #rem00027;  |ACABA;  |FINSI;
         |CIERRA #rem00027;
     |FINSI;

     |SI #rem00200#1 = "E4";
         |ABRE #rem00028;
         #rem00028#0 = #rem00200#0;
         #rem00028#1 = #rem00200#2;
         |LEE 000#rem00028.=;
         |SI FSalida = 0;  |CIERRA #rem00028;  |ACABA;  |FINSI;
         |CIERRA #rem00028;
     |FINSI;

     |BUCLE rem00201B;

     |BORRA 020#rem00200.a;
     |LIBERA #rem00200;
|FPRC;

|DEFBUCLE rem00200B;
     #rem00200#1;
     ;
     enEmpresa, "  ", 00;
     enEmpresa, "zz", 99;
     be;
     NULL, rem00200B;
|FIN;

|PROGRAMA;
     |VENTANA 0501, 3599, -1, 16, "Pantalla actividades";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |PINPA #0#rez00200;    nPanta = FSalida;

     |ABRET #rem00200;
     |ABRET #rem00201;
     |ABRET #rem00202;
     |HAZ TraeActividades;
     |BUCLE rem00200B;

     |DDEF aDef;
     aMas = aDef + "rem00200.mas";
     |CARGA_DEF aMas, trabajo1@;  |ABRE #trabajo1@;
     |CARGA_DEF aMas, trabajo2@;  |ABRE #trabajo2@;
     |CARGA_DEF aMas, trabajo3@;  |ABRE #trabajo3@;

     nRango = 4 + 8 + 16 + 32 + 128;

     |LINEAL_SIMPLE #2#trabajo1@, nRango, 0602, 1498, BajaTrab1, AltaTrab1, EventoTrab1;
     nGrid1 = FSalida;

     |LINEAL_SIMPLE #2#trabajo2@, nRango, 1702, 2598, BajaTrab2, AltaTrab2, EventoTrab2;
     nGrid2 = FSalida;

     |LINEAL_SIMPLE #2#trabajo3@, nRango, 2802, 3698, BajaTrab3, AltaTrab3, EventoTrab3;
     nGrid3 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
            FSalida = "::{{001}}Salir," + nGrid1;
            |LEETECLA aTecla;
            |SI aTecla = aEsc1; |SAL;  |FINSI;
            |SI aTecla = aEsc2; |SAL;  |FINSI;
            |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     |CIERRAT #rem00200;
     |CIERRAT #rem00201;
     |CIERRAT #rem00202;
     |CIERRA  #trabajo1@;
     |CIERRA  #trabajo2@;
     |CIERRA  #trabajo3@;

     |DESCARGA_DEF #trabajo3@;
     |DESCARGA_DEF #trabajo2@;
     |DESCARGA_DEF #trabajo1@;
|FPRO;
