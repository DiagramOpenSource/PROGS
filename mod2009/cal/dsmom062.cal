|FICHEROS;
   dsmom062 #62;
   dsmom063 #63,MANTE;
   dsmom064 #64,MANTE;

   :/modelos/def/dsmom100 #100;
   :/contagen/def/cacuenta #2;
   :/contagen/def/ca8cumay #3;
|FIN;

|VARIABLES;
   aAlfa1  = "";
   nCuenta = 0;
   nNume1  = 0;
   nNume2  = 0;
   nNume3  = 0;
   nNume4  = 0;
   nModoEntrada = 0;
   nInkey  = 0;
|FIN;

|INCLUYE i_variar;
|INCLUYE i_varcon;


|| .... Calculos de m064;

|PROCESO ConsCta;
    |SI enPlan = 1990;
        |ABRE #2;
        |CONSULTA_CLAVE #1#2;
        #64#2 = #2#0; |PINTA #64#2;
        |CIERRA #2;
        |ERROR;
    |FINSI;

    |SI enPlan = 2008;
        |ABRE #3;
        |CONSULTA_CLAVE #1#3;
        #64#2 = #3#0; |PINTA #64#2;
        |CIERRA #3;
        |ERROR;
    |FINSI;
|FPRC;

|CALCULO AntesCuenta; |TIPO 7;
     |C_M #64#3,1,"N";
     |SI nCuenta = 1;  |C_M #64#3,1,"S"; |FINSI;
|FCAL;


|CALCULO LeeLaCuenta; |TIPO 0;
 |SI nCuenta = 1; |ACABA; |FINSI;

     |SI enPlan = 1990;
         |ABRE #2;
         #2#0 = #64#2;
         |LEE 001#2=;
         |SI FSalida ! 0;
             |MENAV "    Error No Existe Cuenta ";
             |ERROR;
         |FINSI;
         |CIERRA #2;
         #64#3 = #2#2;
    |FINSI;

    |SI enPlan = 2008;
        |C_M #64#3,1,"N";

        |ABRE #3;
        #3#10 = 0;
        #3#0  = #64#2;
        |LEE 000#3=;
        |SI FSalida ! 0;
            |C_M #64#3,1,"S";
            |MENAV "    Error No Existe Cuenta ";
            |DDEFECTO #3;
        |FINSI;
        |CIERRA #3;
        #64#3 = #3#1;
    |FINSI;

    |PINTA #64#3;

    |SI #64#4 = " ";
        #64#4 = "+";
        |SI #2#5 = "P"; |O #2#5 = "H"; #64#4 = "-"; |FINSI;
        |PINTA #64#4;
    |FINSI;
|FCAL;

|CALCULO DespuesSigno; |TIPO 0;
  |SI #64#4 = " ";
      |ERROR;
  |FINSI;
|FCAL;

|CALCULO Tm66m064; |TIPO 66;
     |HAZ ConsCta;
|FCAL;

|| ************************************************************************
|PROCESO Borram064;
 |BORRA 020#64a;
 |LIBERA #64;
|FPRC;

|DEFBUCLE Borram064;
 #64#1;
 ;
 #63#4, #63#0, #63#1, "    ";
 #63#4, #63#0, #63#1, "zzzz";
 be;
 NULL, Borram064;
|FIN;

|PROCESO Borram063;
 |BUCLE Borram064;
 |BORRA 020#63a;
 |LIBERA #63;
|FPRC;

|DEFBUCLE Borram063;
 #63#1;
 ;
 #62#4, #62#0, 0001;
 #62#4, #62#0, 9999;
 be;
 NULL, Borram063;
|FIN;

|RUTINA ClauBaja64;
 #64#5 = #63#4;
 #64#0 = #63#0;
 #64#1 = #63#1;
 #64#2 = "0000";
|FRUT;

|RUTINA ClauAlta64;
 #64#5 = #63#4;
 #64#0 = #63#0;
 #64#1 = #63#1;
 #64#2 = "zzzz";
|FRUT;

|CALCULO T7m063; |TIPO 7;
 |PINDA #0#64;
 |ENTLINEAL #1#64, -4, 7, 20, 0, ClauBaja64, ClauAlta64;
|FCAL;

|CALCULO T12m063; |TIPO 12;
 |ENTLINEAL #1#64, -4, 2, 20, 0, ClauBaja64, ClauAlta64;
|FCAL;

|CALCULO T2m063; |TIPO 2;
 nModoEntrada = (FEntrada / 100) ! 0;
 nNume1 = 0 +. 1;
 |SI nModoEntrada = 3;
     |CONFI "    NBorrar la Partida del Informe ";
     |SI FSalida ! 0;
         |ERROR;
         |ACABA;
     |FINSI;
     |BUCLE Borram064;
 |FINSI;
|FCAL;
|| *************************************************************************
|RUTINA ClauBaja63;
 #63#4 = #62#4;
 #63#0 = #62#0;
 #63#1 = 0001;
|FRUT;

|RUTINA ClauAlta63;
 #63#4 = #62#4;
 #63#0 = #62#0;
 #63#1 = 9999;
|FRUT;

|CALCULO T7m062; |TIPO 7;
 |PINDA #0#63;
 |ENTLINEAL #1#63, -3, 7, 21, 0, ClauBaja63, ClauAlta63;
 #63#0 = #62#0;
 #63#1 = 0001;
 |ENTLINEAL #1#64, -4, 7, 20, 0, ClauBaja64, ClauAlta64;
|FCAL;

|CALCULO T2m062; |TIPO 2;
 nModoEntrada = (FEntrada / 100) ! 0;
 nNume1 = 0 +. 1;
 |SI nModoEntrada = 3;
     |CONFI "    NBorrar el Apartado del Informe ";
     |SI FSalida ! 0;
         |ERROR;
         |ACABA;
     |FINSI;
     |BUCLE Borram063;
 |FINSI;
|FCAL;

|CALCULO SiTotal; |TIPO 0;
 aAlfa1 = #62Campo;
 |C_M #62#3,1,aAlfa1;
 |SI aAlfa1 = "N";
     #62#3 = "";
     |PINTA #62#3;
 |FINSI;
|FCAL;

|CALCULO T12m062; |TIPO 12;
 |ENTLINEAL #1#63, -3, 2, 21, 0, ClauBaja63, ClauAlta63;
|FCAL;
|| ********************************************************************

|RUTINA ClauBaja62;
 #62#4 = enPlan;
 #62#0 = 01;
|FRUT;

|RUTINA ClauAlta62;
 #62#4 = enPlan;
 #62#0 = 99;
|FRUT;

|PROGRAMA;
     nCuenta = 0;
     |SI enPlan = 1990;
         |ABRE #100;
         |LEE 040#100p;
         |SI FSalida ! 0;
             |MENAV "    No esta configurada las Empresas Maestras de Contabilidad";
             nCuenta = 1;
         |FINSI;
         |CIERRA #100;

         enEmpresa  = #100#1;
         enPerConta = #100#2;
         |HAZ LeeEmpConta;
         |PATH_DAT #2 aPathConta;
     |FINSI;

     |CLS;
     |CABEZA "Control Inf.Interno Sit.Contable";
     |ENTLINEAL #1#62, -2, 2, 22, 1, ClauBaja62, ClauAlta62;
|FPRO;
