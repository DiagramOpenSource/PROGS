|FICHEROS;
   dsm18406 #0;

   dsm18401 #10;
   dsm18431 #11,MANTE;
|FIN;

|VARIABLES;
   &enEmpresa = 0; &enEjer     = 0; &eaFichero = ""; &enCampo = 0;
   &eaTabla = "";  &enPosicion = 0; &eaDestino = ""; &enComp = 0;
   &eaAlfa  = "";  &enError    = 0; &enTotalCas = 0; &eaTitulo = "";
   &enRegimen = 0;

   nLCod  = 0;
   nLDes  = 0;
   nCalc  = 0;

   aAlfa  = "";
   aAlfa1 = "";
   aAlfa2 = "";
|FIN;

|PROCESO SacaActiv; |TIPO 7;
     eaTabla = "ztabla01.txt";
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompActiv;
     |SI FSalida = 10;
         enPosicion = 10;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 101;
         #0Campo  = aAlfa1;
         |PINTA #0Campo;
     |FINSI;

     enComp = 1;
     eaAlfa = #0#5;

     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |PULSATECLA;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 101;
     aAlfa2   = eaDestino % 360;
     #0#5     = aAlfa1;
     #0#15    = aAlfa2;

     |PINTA #0#5;
     |PINTA #0#15;

     |HAZ FinTabla;
|FPRC;

|PROCESO SacaEpis; |TIPO 7;
                           eaTabla = "ztabla02.txt";
      |SI #dsm18406#5 = 4; eaTabla = "ztabla04.txt"; |FINSI;
      |SI #dsm18406#5 = 5; eaTabla = "ztabla03.txt"; |FINSI;

      |HAZ CargaTabla;
|FPRC;

|PROCESO CompEpis;  |TIPO 0;
     |SI FSalida = 10;
         enPosicion = 10;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 104;
         #0Campo  = aAlfa1;
         |PINTA #0Campo;
     |FINSI;

     enComp = 4;
     eaAlfa = ("0000" + #0#6) % -104;

     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |PULSATECLA;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 104;
     aAlfa2   = eaDestino % 660;
     #0#6     = aAlfa1;
     #0#16    = aAlfa2;

     |PINTA #0#6;
     |PINTA #0#16;

     |HAZ FinTabla;
|FPRC;

|PROCESO PintaTipo;
   |SI #dsm18406#4 = 1; #dsm18406#14 = "Regimen de estimacion directa normal"; |FINSI;
   |SI #dsm18406#4 = 2; #dsm18406#14 = "Regimen de estimacion directa simplificada"; |FINSI;
   |SI #dsm18406#4 = 3; #dsm18406#14 = "Regimen de estimacion objetiva"; |FINSI;
   |PINTA #dsm18406#14;
|FPRC;

|RUTINA inf31;
   #dsm18431#0 = #dsm18406#0;
   #dsm18431#1 = #dsm18406#1;
   #dsm18431#2 = #dsm18406#2;
   #dsm18431#3 = #dsm18406#3;
   #dsm18431#4 = "  ";
|FRUT;

|RUTINA sup31;
   #dsm18431#0 = #dsm18406#0;
   #dsm18431#1 = #dsm18406#1;
   #dsm18431#2 = #dsm18406#2;
   #dsm18431#3 = #dsm18406#3;
   #dsm18431#4 = "zz";
|FRUT;

|PROCESO Recalcula;
   |SI #dsm18431#4 = "ES";
      #dsm18406#7 = #dsm18406#7 + #dsm18431#6;
      #dsm18406#8 = #dsm18406#8 + #dsm18431#7;
      #dsm18406#9 = #dsm18406#9 + #dsm18431#8;
   |SINO;
      #dsm18406#10 = #dsm18406#10 + #dsm18431#6;
      #dsm18406#11 = #dsm18406#11 + #dsm18431#7;
      #dsm18406#12 = #dsm18406#12 + #dsm18431#8;
   |FINSI;

   |SI #dsm18431#9 = "S"; #dsm18406#13 = #dsm18406#13 + #dsm18431#8; |FINSI;
|FPRC;

|DEFBUCLE Recalcula;
#dsm18431#1;
;
#dsm18406#0, #dsm18406#1, #dsm18406#2, #dsm18406#3, "  ";
#dsm18406#0, #dsm18406#1, #dsm18406#2, #dsm18406#3, "zz";
;
NULL,Recalcula;
|FIN;

|PROCESO Tipo306; |TIPO 3;
      enRegimen = #dsm18406#4;
      |PUSHV 0501 2380;
      |ENTLINEAL #1#dsm18431,-5,1,20,1,inf31,sup31;
      #dsm18406#7  = 0; #dsm18406#8  = 0; #dsm18406#9  = 0;
      #dsm18406#10 = 0; #dsm18406#11 = 0; #dsm18406#12 = 0;
      #dsm18406#13 = 0;
      |BUCLE Recalcula;
      |POPV;
      |PINTA #dsm18406#7;  |PINTA #dsm18406#8;  |PINTA #dsm18406#9;
      |PINTA #dsm18406#10; |PINTA #dsm18406#11; |PINTA #dsm18406#12;
      |PINTA #dsm18406#13;
|FPRC;
