|FICHEROS;
     dsmoy000 #0;
     dsmom001 #1;
     dsmom004 #4;

     dsm18401 #101;
     dsm18403 #103;
     dsm18404 #104;
     dsm18405 #105;
     dsm18406 #106;
     dsm18407 #107;
     dsm18408 #108;
     dsm18409 #109;
     dsm18414 #114;
     dsm18430 #130;
     dsm18431 #131;

     dsmow504 #504;
     dsmow565 #565;
     dsmow568 #568;
     dsmow014 #999;
     dsmow016 #997;

     :/basica/def/agicen17 #17;
     :/basica/def/agim0024 #24;
     :/basica/def/agim0026 #26;

     &regisnif@ #709;
     &clientes@ #715;
|FIN;

|VARIABLES;
     &enTotSoc = 0;
     &enNumDec = 0;
     &eaFecha  = "";
     &eaJustPr = "";
     &eaJustAn = "";
     &eaPorcen = "";

     nImpI1 = 0; nImpJ1 = 0;
     nImpI2 = 0; nImpJ2 = 0;
     nImpI3 = 0; nImpJ3 = 0;
     nImpI4 = 0; nImpJ4 = 0;
     nImpI5 = 0; nImpJ5 = 0;
     nImpI6 = 0; nImpJ6 = 0;

     nCont      = 0;
     nCalc      = 0;
     nHandle    = 0;
     nCont1     = 0;
     nSwError   = 0;
     nRegistros = 0;
     nPortada   = 0;

     nNumDecl    = 0;
     nNumTotSocs = 0;
     nNumSocs    = 0;
     nDEmpresa   = 0;
     nHEmpresa   = 0;

     Cadena    = "";
     aAntPais  = "";
     aRed      = "";
     aDPais    = "";
     aHPais    = "";
     aPais     = "";
     aCadena1  = "";
     aClave    = "";
     aSubClave = "";
     aDerecho  = "";
     aJusti    = "";
     aEsc      = "";

     aTRegimen = ""; aTActivid = ""; nEpigrafe = 0;
     aNifCes   = ""; aNomCes   = ""; nAnyoAdq  = 0;
     nMesAdq   = 0;  nDiaAdq   = 0;        nValLiq   = 0;
     nValAdq   = 0;  nImpIngr  = 0;        nImpGast  = 0;
     nImpRtas  = 0;  nPorcRed  = 0;        nImpRtaR  = 0;
     nGanPer   = 0;  nBaseDed  = 0;        nRetIng   = 0;

     TipoDato  = "";
     Vacio1    = ""; Vacio2   = "";
     Long      = 0;  LongDec  = 0;
     nNegativo = 0;
     Calc1     = 0;  Calc2  = 0;
     nPer      = 0;  nGan   = 0;
     nSwDatos  = 0;  nSigno = 0;

     &sw03 = 0;
     &sw04 = 0;
     &sw05 = 0;
     &sw06 = 0;
     &sw07 = 0;
     &sw08 = 0;
     &sw09 = 0;
     &sw10 = 0;
     &sw14 = 0;
     &sw30 = 0;
     &swB = 0;
     &swC = 0;
     &swCont = 0;
     nNumLin = 0;
     nNumBlan = 0;
     nTotLin = 0;
     nElval = 0;
     nElsw = 0;
|FIN;

|INCLUYE i_varemi;

|PROCESO Formateo1;
        |QBF aAlfa;
        |SI TipoDato = "F";
           aAlfa = aAlfa - "."; aAlfa = aAlfa - ".";
           |SI aAlfa = "01010000"; aAlfa = "0" * 8; |FINSI;
           |ACABA;
        |FINSI;
        |SI TipoDato = "N";
           Vacio1 = "0" * Long;
           Vacio2 = "0" * LongDec;
           aAlfa = aAlfa - "N";
           |SI FSalida ! 0;
              nNegativo = 1;
           |SINO;
              nNegativo = 0;
           |FINSI;
        |SINO;
           Vacio1 = " " * Long;
        |FINSI;

        |SI TipoDato ! "N";
           Calc1 = 100 + Long; aAlfa = (aAlfa + Vacio1) % Calc1;
        |SINO;
           |SI LongDec = 0;
              Calc1 = 0 - (100 + Long);
              aAlfa = (Vacio1 + aAlfa) % Calc1;
           |SINO;
              aAlfa = aAlfa - ".";
              |SI FSalida = 0;
                 Calc1 = 0 - (100 + Long);
                 aAlfa = (Vacio1 + aAlfa) % Calc1;
                 aAlfa1 = "0" * LongDec;
              |SINO;
                 Calc1 = (((FSalida / 100) ! 0) - 1) + 100;
                 Calc2 = (((FSalida / 100) ! 0) * 100) + 99;
                 aAlfa1 = aAlfa % Calc2;
                 aAlfa = aAlfa % Calc1;
                 Calc1 = 0 - (100 + Long);
                 aAlfa = (Vacio1 + aAlfa)  % Calc1;
                 Calc1 = 100 + LongDec;
                 aAlfa1 = (aAlfa1 + Vacio2) % Calc1;
              |FINSI;
              aAlfa = aAlfa + aAlfa1;
           |FINSI;
           |SI nNegativo = 1;
              Calc1 = 0 - (100 + (Long + LongDec)); Calc1 = Calc1 + 1;
              aAlfa = aAlfa % Calc1;
              aAlfa = "N" + aAlfa;
           |FINSI;
        |FINSI;

        aAlfa2 = "";

        |SI TipoDato = "A"; |O TipoDato = "An";
           aLong = aAlfa % 0; nLong = aLong;
           |PARA nCont1 = 1; |SI nCont1 [ nLong; |HACIENDO nCont1 = nCont1 + 1;
              Calc1 = (nCont1 * 100) + 1; aAlfa1  = aAlfa % Calc1;
              aAlfa1 = aAlfa1 > aAlfa1;
              |SI aAlfa1 = " ";                  |VETE Sigue1; |FINSI;
              |SI aAlfa1 ] "A"; |Y aAlfa1 [ "Z"; |VETE Sigue1; |FINSI;
              |SI aAlfa1 ] "0"; |Y aAlfa1 [ "9"; |VETE Sigue1; |FINSI;
              |SI aAlfa1 = "¥"; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
              |SI aAlfa1 = "¤"; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
              |SI aAlfa1 = "ç"; aAlfa1 = &199;   |VETE Sigue1; |FINSI;
              |SI aAlfa1 = "Ç"; aAlfa1 = &199;   |VETE Sigue1; |FINSI;
              |SI aAlfa1 = "-"; aAlfa1 = &45;    |VETE Sigue1; |FINSI;
              |SI aAlfa1 = "'"; aAlfa1 = &49;    |VETE Sigue1; |FINSI;
              |SI TipoDato = "An";
                 |SI aAlfa1 = "&"; aAlfa1 = &38;    |VETE Sigue1; |FINSI;
                 |SI aAlfa1 = ","; aAlfa1 = &44;    |VETE Sigue1; |FINSI;
                 |SI aAlfa1 = "."; aAlfa1 = &46;    |VETE Sigue1; |FINSI;
                 |SI aAlfa1 = ":"; aAlfa1 = &58;    |VETE Sigue1; |FINSI;
                 |SI aAlfa1 = ";"; aAlfa1 = &59;    |VETE Sigue1; |FINSI;
                 |SI aAlfa1 = "_"; aAlfa1 = &95;    |VETE Sigue1; |FINSI;
              |FINSI;
              aAlfa1 = " ";
     |ET Sigue1;
              aAlfa2 = aAlfa2 + aAlfa1;
           |SIGUE;
           aAlfa = aAlfa2;
        |FINSI;
        Calc1 = aAlfa;
        |SI nSwDatos = 0; |Y Calc1 ! 0; nSwDatos = 1; |FINSI;
|FPRC;

|PROCESO Portada184;
     |SI nTecla = 3;  |O nTecla = 4;
         |SI nRegistros = 0;
             aJusti   = #997#19;
             enNumDec = nNumDecl;
             enTotSoc = nNumTotSocs;
             |INFOR "dsm184pr";
             |SI FSalida ! 0;  |ACABA; |FINSI;

             |MENAV "0000 Coloque Portada 184 y Pulse una Tecla.";

             |PRINT;
             |PIEINF;
             |FININF;
         |FINSI;
     |FINSI;

     |DDEFECTO #997;

     enCodCli = #999#0;
     |HAZ LeePersona;
     |SI enSwDeDonde = 1;
         #997#20 = #715#17;
         #997#21 = #715#18;
         #997#11 = #715#15;
         #997#12 = #715#16;
     |SINO;
         #997#20 = #715#91;
         #997#21 = #715#92;
         #997#11 = #715#63;
         #997#12 = #715#64;
     |FINSI;

     |SI nTecla = 1;  |O nTecla = 2;
         #997#26 = "X";
     |SINO;
         #997#27 = "X";
         #997#19 = aJusti;
     |FINSI;

     #997#39 = #101#26;
     #997#40 = "REPRESENTANTE";

     |INFOR "dsm184dc";
     |SI FSalida ! 0;  |ACABA; |FINSI;

     |MENAV "0000 Coloque Portada 184 y Pulse una Tecla.";

     |PRINT;
     |PIEINF;
     |FININF;
|FPRC;

|PROCESO CuentaSocios;
     |SI #130#12 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #130#14 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #130#16 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #130#18 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #130#19 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #130#20 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #130#21 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #130#22 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #130#25 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #130#26 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #130#27 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #130#28 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #130#29 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #130#30 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #130#31 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #130#43 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
|FPRC;

|DEFBUCLE CuentaSocios;
     #130#2;
     ;
     #101#0, #101#1, #101#3, "               ";
     #101#0, #101#1, #101#3, "zzzzzzzzzzzzzzz";
     ;
     NULL, CuentaSocios;
|FIN;

|PROCESO GrabaDomicilio;
   |SI #0#6 ] 2006;
      aAlfa = #130#36; |QBF aAlfa; aAlfa = aAlfa + " ";
      aAlfa1 = #130#5; aAlfa1 = aAlfa1 % 114;
      aAlfa = aAlfa + aAlfa1;  |QBF aAlfa; aAlfa = aAlfa + ",";
      aAlfa = aAlfa + #130#37; |QBF aAlfa;
      |SI #130#37 ! "   "; aAlfa = aAlfa + ","; |FINSI;
      aAlfa = aAlfa + #130#38; |QBF aAlfa;
      |SI #130#38 ! " "; aAlfa = aAlfa + ","; |FINSI;
      aAlfa = aAlfa + #130#39; |QBF aAlfa;
      |SI #130#39 ! "  "; aAlfa = aAlfa + ","; |FINSI;
      aAlfa = aAlfa + #130#40; |QBF aAlfa;
      |SI #130#40 ! "  "; aAlfa = aAlfa + ","; |FINSI;
      aAlfa1 = (("00" + #130#6) % -102) + (("000" + #130#41) % -103);
      aAlfa = aAlfa + "C.P." + aAlfa1 + ",";
      aAlfa1 = #130#42; aAlfa1 = aAlfa1 % 110;
      aAlfa = aAlfa + aAlfa1;  |QBF aAlfa;
      TipoDato = "A"; LongDec = 0;
      Long = 40; |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
   |SINO;
      TipoDato = "A"; LongDec = 0;
      Long = 2;  aAlfa = #130#36;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
      Long = 14; aAlfa = #130#5;   |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
      TipoDato = "N"; LongDec = 0;
      Long = 4;  aAlfa = #130#37;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
      TipoDato = "A"; LongDec = 0;
      Long = 1;  aAlfa = #130#38;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
      Long = 2;  aAlfa = #130#39;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
      Long = 2;  aAlfa = #130#40;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
      aAlfa = (("00" + #130#6) % -102) + (("000" + #130#41) % -103);
      aCadena1 = aCadena1 + aAlfa;
      Long = 10; aAlfa = #130#42;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
   |FINSI;
|FPRC;

|PROCESO RegistroSoc;
     aCadena = "2184";
     aCadena = aCadena + #101#1;
     aCadena = aCadena + #565#4;

     TipoDato = "A"; LongDec = 0;
     Long = 9;  aAlfa = #130#2; |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 9;  aAlfa = #130#3; |HAZ Formateo1; aCadena = aCadena + aAlfa;
     TipoDato = "An";
     Long = 40; aAlfa = #130#4; |HAZ Formateo1; aCadena = aCadena + aAlfa;
     aCadena = aCadena + "S";
     TipoDato = "N"; LongDec = 0;
     Long = 2; aAlfa = #130#6;  |HAZ Formateo1; aCadena = aCadena + aAlfa;

     TipoDato = "A"; LongDec = 0;
     aPais = #130#7; |SI aPais = "ES"; aPais = "  "; |FINSI;
     Long = 2;  aAlfa = aPais;       |HAZ Formateo1; aCadena = aCadena + aAlfa;

     TipoDato = "N"; LongDec = 0;
     Long = 1;  aAlfa = #130#8; |HAZ Formateo1; aCadena = aCadena + aAlfa;

     TipoDato = "A"; LongDec = 0;
     Long = 1; aAlfa = #130#9;   |HAZ Formateo1; aCadena = aCadena + aAlfa;

     TipoDato = "N"; LongDec = 0;
     Long = 3;  aAlfa = #130#10; |HAZ Formateo1; aCadena = aCadena + aAlfa;
     LongDec = 4;
     Long = 3;  aAlfa = #130#11; |HAZ Formateo1; aCadena = aCadena + aAlfa;

     |SI #0#6 > 2006;
        aCadena1 = aCadena + "A01";
        TipoDato = "N"; LongDec = 2;
        |SI #130#12 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #130#12; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #130#12;
        |FINSI;
        Long = 10; |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
        |SI #130#13 < 0;
           aCadena1 = aCadena1 + "0";
           nCalc = 0 - #130#13; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + "0"; aAlfa = #130#13;
        |FINSI;
        Long = 8;   |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
        |HAZ GrabaDomicilio;

        |SI #130#12 ! 0; |O #130#13 ! 0;
           aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
           aCadena1 = (" " * 91) + &13 + &10;
           aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        |FINSI;

        aCadena1 = aCadena + "A02";
        TipoDato = "N"; LongDec = 2;
        |SI #130#43 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #130#43; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #130#43;
        |FINSI;
        Long = 10; |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
        |SI #130#44 < 0;
           aCadena1 = aCadena1 + "0";
           nCalc = 0 - #130#44; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + "0"; aAlfa = #130#44;
        |FINSI;
        Long = 8;   |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
        |HAZ GrabaDomicilio;

        |SI #130#43 ! 0; |O #130#44 ! 0;
           aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
           aCadena1 = (" " * 91) + &13 + &10;
           aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        |FINSI;
     |SINO;
        aCadena1 = aCadena + "A00";
        TipoDato = "N"; LongDec = 2;
        |SI #130#12 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #130#12; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #130#12;
        |FINSI;
        Long = 10; |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
        |SI #130#13 < 0;
           aCadena1 = aCadena1 + "0";
           nCalc = 0 - #130#13; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + "0"; aAlfa = #130#13;
        |FINSI;
        Long = 8;   |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
        |HAZ GrabaDomicilio;

        |SI #130#12 ! 0; |O #130#13 ! 0;
           aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
           aCadena1 = (" " * 91) + &13 + &10;
           aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;

     aCadena1 = aCadena + "C00";
     TipoDato = "N"; LongDec = 2;
     |SI #130#14 < 0;
        aCadena1 = aCadena1 + "N";
        nCalc = 0 - #130#14; aAlfa = nCalc;
     |SINO;
        aCadena1 = aCadena1 + " ";  aAlfa = #130#14;
     |FINSI;
     Long = 10;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |SI #130#15 < 0;
        aCadena1 = aCadena1 + "0";
        nCalc = 0 - #130#15; aAlfa = nCalc;
     |SINO;
        aCadena1 = aCadena1 + "0"; aAlfa = #130#15;
     |FINSI;
     Long = 8;   |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     TipoDato = "A"; LongDec = 0;
     |HAZ GrabaDomicilio;
     |SI #130#14 ! 0; |O #130#15 ! 0;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        aCadena1 = (" " * 91) + &13 + &10;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
     |FINSI;

     aCadena1 = aCadena + "D00";
     TipoDato = "N"; LongDec = 2;
     |SI #130#16 < 0;
        aCadena1 = aCadena1 + "N";
        nCalc = 0 - #130#16; aAlfa = nCalc;
     |SINO;
        aCadena1 = aCadena1 + " ";  aAlfa = #130#16;
     |FINSI;
     Long = 10;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |SI #130#17 < 0;
        aCadena1 = aCadena1 + "0";
        nCalc = 0 - #130#17; aAlfa = nCalc;
     |SINO;
        aCadena1 = aCadena1 + "0";  aAlfa = #130#17;
     |FINSI;
     Long = 8;   |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #130#16 ! 0; |O #130#17 ! 0;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        aCadena1 = (" " * 91) + &13 + &10;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
     |FINSI;

     aCadena1 = aCadena + "E00";
     TipoDato = "N"; LongDec = 2;
     |SI #130#18 < 0;
        aCadena1 = aCadena1 + "N";  nCalc = 0 - #130#18; aAlfa = nCalc;
     |SINO;
        aCadena1 = aCadena1 + " ";  aAlfa = #130#18;
     |FINSI;
     Long = 10;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #130#18 ! 0;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        aCadena1 = (" " * 91) + &13 + &10;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
     |FINSI;

     aCadena1 = aCadena + "F01";
     TipoDato = "N"; LongDec = 2;
     |SI #130#19 < 0;
        aCadena1 = aCadena1 + "N";
        nCalc = 0 - #130#19; aAlfa = nCalc;
     |SINO;
        aCadena1 = aCadena1 + " ";  aAlfa = #130#19;
     |FINSI;
     Long = 10;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #130#19 ! 0;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        aCadena1 = (" " * 91) + &13 + &10;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
     |FINSI;

     aCadena1 = aCadena + "F02";
     TipoDato = "N"; LongDec = 2;
     |SI #130#20 < 0;
        aCadena1 = aCadena1 + "N";
        nCalc = 0 - #130#20; aAlfa = nCalc;
     |SINO;
        aCadena1 = aCadena1 + " ";  aAlfa = #130#20;
     |FINSI;
     Long = 10;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #130#20 ! 0;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        aCadena1 = (" " * 91) + &13 + &10;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
     |FINSI;

     aCadena1 = aCadena + "G01";
     TipoDato = "N"; LongDec = 2;
     |SI #130#21 < 0;
        aCadena1 = aCadena1 + "N";
        nCalc = 0 - #130#21; aAlfa = nCalc;
     |SINO;
        aCadena1 = aCadena1 + " ";  aAlfa = #130#21;
     |FINSI;
     Long = 10;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #130#21 ! 0;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        aCadena1 = (" " * 91) + &13 + &10;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
     |FINSI;

     aCadena1 = aCadena + "G02";
     TipoDato = "N"; LongDec = 2;
     |SI #130#22 < 0;
        aCadena1 = aCadena1 + "N";
        nCalc = 0 - #130#22; aAlfa = nCalc;
     |SINO;
        aCadena1 = aCadena1 + " "; aAlfa = #130#22;
     |FINSI;
     Long = 10;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #130#22 ! 0;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        aCadena1 = (" " * 91) + &13 + &10;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
     |FINSI;

     aCadena1 = aCadena + "I01";
     TipoDato = "N"; LongDec = 2;
     |SI #130#23 = "X";
        |SI #130#25 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #130#25; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #130#25;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = "0";          |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #130#23 = "X"; |Y #130#25 ! 0;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        aCadena1 = (" " * 91) + &13 + &10;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
     |FINSI;

     aCadena1 = aCadena + "I02";
     TipoDato = "N"; LongDec = 2;
     |SI #130#23 = "X";
        |SI #130#26 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #130#26; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #130#26;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #130#23 = "X"; |Y #130#26 ! 0;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        aCadena1 = (" " * 91) + &13 + &10;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
     |FINSI;

     aCadena1 = aCadena + "I03";
     TipoDato = "N"; LongDec = 2;
     |SI #130#23 = "X";
        |SI #130#27 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #130#27; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #130#27;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #130#23 = "X"; |Y #130#27 ! 0;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        aCadena1 = (" " * 91) + &13 + &10;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
     |FINSI;

     aCadena1 = aCadena + "I04";
     TipoDato = "N"; LongDec = 2;
     |SI #130#23 = "X";
        |SI #130#28 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #130#28; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #130#28;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #130#23 = "X"; |Y #130#28 ! 0;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        aCadena1 = (" " * 91) + &13 + &10;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
     |FINSI;

     aCadena1 = aCadena + "I05";
     TipoDato = "N"; LongDec = 2;
     |SI #130#23 = "X";
        |SI #130#29 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #130#29; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #130#29;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #130#23 = "X"; |Y #130#29 ! 0;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        aCadena1 = (" " * 91) + &13 + &10;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
     |FINSI;

     aCadena1 = aCadena + "I06";
     TipoDato = "N"; LongDec = 2;
     |SI #130#23 = "X";
        |SI #130#30 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #130#30; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #130#30;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #130#23 = "X"; |Y #130#30 ! 0;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        aCadena1 = (" " * 91) + &13 + &10;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
     |FINSI;

     aCadena1 = aCadena + "J01";
     TipoDato = "N"; LongDec = 2;
     |SI #130#24 = "X";
        |SI #130#25 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #130#25; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #130#25;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = "0";          |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #130#24 = "X"; |Y #130#25 ! 0;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        aCadena1 = (" " * 91) + &13 + &10;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
     |FINSI;

     aCadena1 = aCadena + "J02";
     TipoDato = "N"; LongDec = 2;
     |SI #130#24 = "X";
        |SI #130#26 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #130#26; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #130#26;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #130#24 = "X"; |Y #130#26 ! 0;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        aCadena1 = (" " * 91) + &13 + &10;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
     |FINSI;

     aCadena1 = aCadena + "J03";
     TipoDato = "N"; LongDec = 2;
     |SI #130#24 = "X";
        |SI #130#27 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #130#27; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #130#27;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #130#24 = "X"; |Y #130#27 ! 0;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        aCadena1 = (" " * 91) + &13 + &10;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
     |FINSI;

     aCadena1 = aCadena + "J04";
     TipoDato = "N"; LongDec = 2;
     |SI #130#24 = "X";
        |SI #130#28 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #130#28; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #130#28;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #130#24 = "X"; |Y #130#28 ! 0;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        aCadena1 = (" " * 91) + &13 + &10;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
     |FINSI;

     aCadena1 = aCadena + "J05";
     TipoDato = "N"; LongDec = 2;
     |SI #130#24 = "X";
        |SI #130#29 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #130#29; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #130#29;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #130#24 = "X"; |Y #130#29 ! 0;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        aCadena1 = (" " * 91) + &13 + &10;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
     |FINSI;

     aCadena1 = aCadena + "J06";
     TipoDato = "N"; LongDec = 2;
     |SI #130#24 = "X";
        |SI #130#30 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #130#30; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #130#30;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #130#24 = "X"; |Y #130#30 ! 0;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        aCadena1 = (" " * 91) + &13 + &10;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
     |FINSI;

     aCadena1 = aCadena + "K00";
     TipoDato = "N"; LongDec = 2;
     |SI #130#31 < 0;
        aCadena1 = aCadena1 + "N";
        nCalc = 0 - #130#31; aAlfa = nCalc;
     |SINO;
        aCadena1 = aCadena1 + " "; aAlfa = #130#31;
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #130#31 ! 0;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
        aCadena1 = (" " * 91) + &13 + &10;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;
     |FINSI;
|FPRC;

|DEFBUCLE RegistroSoc;
     #130#2;
     ;
     #101#0, #101#1, #101#3, "               ";
     #101#0, #101#1, #101#3, "zzzzzzzzzzzzzzz";
     ;
     NULL,RegistroSoc;
|FIN;

|PROCESO RegistroDec;
     aCadena = "2184";
     aCadena = aCadena + #101#1;
     aCadena = aCadena + #565#4;
     aCadena = aCadena + #565#4;
     aCadena = aCadena + (" " * 9);
     eaAlfa  = #565#5;  |HAZ QuitaRaros;
     aCadena = aCadena + eaAlfa;

     aCadena = aCadena + "E";
     TipoDato = "A"; LongDec = 0;
     Long = 1;  aAlfa = aClave;    |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 2;  aAlfa = aSubClave; |HAZ Formateo1; aCadena = aCadena + aAlfa;
     |SI #0#6 [ 2006;
        |SI aPais = "ES"; aPais = "  "; |FINSI;
     |SINO;
        |SI aClave ! "B"; |Y aClave ! "L";
           |SI aPais = "ES"; aPais = "  "; |FINSI;
        |FINSI;
     |FINSI;
     Long = 2;  aAlfa = aPais;     |HAZ Formateo1; aCadena = aCadena + aAlfa;

     TipoDato = "N"; LongDec = 0;
     Long = 1;  aAlfa = aTRegimen; |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 1;  aAlfa = aTActivid; |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 4;  aAlfa = nEpigrafe; |HAZ Formateo1; aCadena = aCadena + aAlfa;
     TipoDato = "A"; LongDec = 0;
     Long = 9;  aAlfa = aNifCes;   |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 20; aAlfa = aNomCes;   |HAZ Formateo1; aCadena = aCadena + aAlfa;
     TipoDato = "N"; LongDec = 0;
     Long = 4;  aAlfa = nAnyoAdq;  |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 2;  aAlfa = nMesAdq;   |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 2;  aAlfa = nDiaAdq;   |HAZ Formateo1; aCadena = aCadena + aAlfa;
     aCadena = aCadena; |XGRABA nHandle, aCadena; aCadena = "";

     TipoDato = "N"; LongDec = 2;
     Long = 11; aAlfa = nValLiq;   |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 11; aAlfa = nValAdq;   |HAZ Formateo1; aCadena = aCadena + aAlfa;
     |SI nImpIngr < 0;
        aCadena = aCadena + "N";
        nImpIngr = 0 - nImpIngr;
     |SINO;
        aCadena = aCadena + " ";
     |FINSI;
     Long = 11; aAlfa = nImpIngr;  |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 10; aAlfa = nImpGast;  |HAZ Formateo1; aCadena = aCadena + aAlfa;
     |SI nImpRtas < 0;
        aCadena = aCadena + "N";
        nImpRtas = 0 - nImpRtas;
     |SINO;
        aCadena = aCadena + " ";
     |FINSI;
     Long = 11; aAlfa = nImpRtas;  |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 3;  aAlfa = nPorcRed;  |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 10; aAlfa = nImpRtaR;  |HAZ Formateo1; aCadena = aCadena + aAlfa;
     |SI nGanPer < 0; nGanPer = 0 - nGanPer; |FINSI;
     Long = 11; aAlfa = nGanPer;   |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 10; aAlfa = nBaseDed;  |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 10; aAlfa = nRetIng;   |HAZ Formateo1; aCadena = aCadena + aAlfa;
     aCadena = aCadena + "      " + &13 + &10;
     aCadena = aCadena; |XGRABA nHandle, aCadena;
|FPRC;

|PROCESO DefectVars;
     aPais     = "";
     aTRegimen = "0";      aTActivid = "0";      nEpigrafe = 0;
     aNifCes   = " " * 9;  aNomCes   = " " * 20; nAnyoAdq  = 0;
     nMesAdq   = 0;        nDiaAdq   = 0;        nValLiq   = 0;
     nValAdq   = 0;        nImpIngr  = 0;        nImpGast  = 0;
     nImpRtas  = 0;        nPorcRed  = 0;        nImpRtaR  = 0;
     nGanPer   = 0;        nBaseDed  = 0;        nRetIng   = 0;
|FPRC;

|PROCESO CapituloL;
     |HAZ DefectVars; aClave = "L";
     aSubClave = #114#4; aPais    = #114#5; nImpGast = #114#6;
     |SI nImpGast ! 0; |HAZ RegistroDec; |FINSI;
|FPRC;

|DEFBUCLE CapituloL;
     #114#1;
     ;
     #101#0, #101#1, #101#3, 001;
     #101#0, #101#1, #101#3, 999;
     ;
     NULL,CapituloL;
|FIN;

|PROCESO CapituloK;
     |HAZ DefectVars;
     aClave = "K"; aSubClave = "01"; nRetIng = #101#50;
     |SI nRetIng ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars;
     aClave = "K"; aSubClave = "02"; nRetIng = #101#51;
     |SI nRetIng ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars;
     aClave = "K"; aSubClave = "03"; nRetIng = #101#52;
     |SI nRetIng ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars;
     aClave = "K"; aSubClave = "04"; nRetIng = #101#53;
     |SI nRetIng ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars;
     aClave = "K"; aSubClave = "05"; nRetIng = #101#54;
     |SI nRetIng ! 0; |HAZ RegistroDec; |FINSI;
|FPRC;

|PROCESO CapituloJ;
     |HAZ DefectVars;
     aClave = "J"; aSubClave = "01"; nBaseDed = #101#44;
     |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars;
     aClave = "J"; aSubClave = "02"; nBaseDed = #101#45;
     |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars;
     aClave = "J"; aSubClave = "03"; nBaseDed = #101#46;
     |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars;
     aClave = "J"; aSubClave = "04"; nBaseDed = #101#47;
     |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars;
     aClave = "J"; aSubClave = "05"; nBaseDed = #101#48;
     |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars;
     aClave = "J"; aSubClave = "06"; nBaseDed = #101#49;
     |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;
|FPRC;

|PROCESO CapituloI;
     |HAZ DefectVars;
     aClave = "I"; aSubClave = "01"; nBaseDed = #101#38;
     |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars;
     aClave = "I"; aSubClave = "02"; nBaseDed = #101#39;
     |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars;
     aClave = "I"; aSubClave = "03"; nBaseDed = #101#40;
     |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars;
     aClave = "I"; aSubClave = "04"; nBaseDed = #101#41;
     |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

     |SI #0#6 [ 2006;
        |HAZ DefectVars;
        aClave = "I"; aSubClave = "05"; nBaseDed = #101#42;
        |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

        |HAZ DefectVars;
        aClave = "I"; aSubClave = "06"; nBaseDed = #101#43;
        |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;
     |SINO;
        |HAZ DefectVars;
        aClave = "I"; aSubClave = "05"; nBaseDed = #101#43;
        |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;
     |FINSI;
|FPRC;

|PROCESO CapituloH;
     |SI #101#35 = 0;  |Y #101#36 = 0;  |Y #101#34 = 0;  |Y #101#37 = 0;
         |ACABA;
     |FINSI;

     |HAZ DefectVars;
     aClave = "H"; aSubClave = "  ";
     nValLiq  = #101#35; nValAdq  = #101#36;
     nImpIngr = #101#34; nImpRtas = #101#37;
     |HAZ RegistroDec;
|FPRC;

|PROCESO BCapituloG;
     |SI aDPais = "ES"; |Y aHPais = "ES";
        |SI #109#6 = "G";
           nGan = nGan + #109#7;
        |SINO;
           nPer = nPer + #109#7;
        |FINSI;
     |SINO;
        |SI #109#5 = "ES"; |ACABA; |FINSI;
        |SI aAntPais ! #109#5;
           |SI nPer ! 0; |O nGan ! 0;
              aClave = "G";
              |SI nGan ! 0;
                 |SI aDerecho = "N";
                    aSubClave = "03";
                 |SINO;
                    aSubClave = "07";
                 |FINSI;
                 aPais = aAntPais; nGanPer = nGan;
                 |HAZ RegistroDec;
              |FINSI;
              |SI nPer ! 0;
                 |SI aDerecho = "N";
                    aSubClave = "04";
                 |SINO;
                    aSubClave = "08";
                 |FINSI;
                 aPais = aAntPais; nGanPer = nPer;
                 |HAZ RegistroDec;
              |FINSI;
           |FINSI;
           aAntPais = #109#5;
        |FINSI;
        |SI #108#6 = "G"; nGan = nGan + #109#7; |FINSI;
        |SI #108#6 = "P"; nPer = nPer + #109#7; |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE BCapituloG;
     #109#2;
     9;
     #101#0, #101#1, #101#3, aDPais, aDerecho;
     #101#0, #101#1, #101#3, aHPais, aDerecho;
     ;
     NULL,BCapituloG;
|FIN;

|PROCESO CapituloG;
     aDerecho = "N";

     |HAZ DefectVars; nGan = 0; nPer = 0; aAntPais = "";
     aDPais = "ES"; aHPais = "ES"; |BUCLE BCapituloG;
     aClave = "G"; aSubClave = "01"; aPais = "ES"; nGanPer = nGan;
     |SI nGanPer ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars; nGan = 0; nPer = 0; aAntPais = "";
     aDPais = "ES"; aHPais = "ES"; |BUCLE BCapituloG;
     aClave = "G"; aSubClave = "02"; aPais = "ES"; nGanPer = nPer;
     |SI nGanPer ! 0; |HAZ RegistroDec; |FINSI;

     aDPais = "  "; aHPais = "zz";
     nPer = 0; nGan = 0;
     |BUCLE BCapituloG;
     |SI nPer ! 0; |O nGan ! 0;
        aClave = "G";
        |SI nGan ! 0;
           nGanPer = nGan; aSubClave = "03"; aPais = aAntPais;
           |HAZ RegistroDec;
        |FINSI;
        |SI nPer ! 0;
           nGanPer = nPer; aSubClave = "04"; aPais = aAntPais;
           |HAZ RegistroDec;
        |FINSI;
     |FINSI;

     aDerecho = "S";

     |HAZ DefectVars; nGan = 0; nPer = 0; aAntPais = "";
     aDPais = "ES"; aHPais = "ES"; |BUCLE BCapituloG;
     aClave = "G"; aSubClave = "05"; aPais = "ES"; nGanPer = nGan;
     |SI nGanPer ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars; nGan = 0; nPer = 0; aAntPais = "";
     aDPais = "ES"; aHPais = "ES"; |BUCLE BCapituloG;
     aClave = "G"; aSubClave = "06"; aPais = "ES"; nGanPer = nPer;
     |SI nGanPer ! 0; |HAZ RegistroDec; |FINSI;

     aDPais = "  "; aHPais = "zz";
     nPer = 0; nGan = 0;
     |BUCLE BCapituloG;
     |SI nPer ! 0; |O nGan ! 0;
        aClave = "G";
        |SI nGan ! 0;
           nGanPer = nGan; aSubClave = "07"; aPais = aAntPais;
           |HAZ RegistroDec;
        |FINSI;
        |SI nPer ! 0;
           nGanPer = nPer; aSubClave = "08"; aPais = aAntPais;
           |HAZ RegistroDec;
        |FINSI;
     |FINSI;
|FPRC;

|PROCESO BCapituloF;
     |SI aDPais = "ES"; |Y aHPais = "ES";
        |SI #108#5 = "G";
           nGan = nGan + #108#6;
        |SINO;
           nPer = nPer - #108#6;
        |FINSI;
     |SINO;
        |SI #108#4 = "ES"; |ACABA; |FINSI;
        |SI aAntPais ! #108#4;
           |SI nPer ! 0; |O nGan ! 0;
              aClave = "F";
              |SI nGan ! 0;
                 nGanPer = nGan; aSubClave = "03"; aPais = aAntPais;
                 |HAZ RegistroDec;
              |FINSI;
              |SI nPer ! 0;
                 nGanPer = nPer; aSubClave = "04"; aPais = aAntPais;
                 |HAZ RegistroDec;
              |FINSI;
           |FINSI;
           aAntPais = #108#4;
           |HAZ DefectVars; nGan = 0; nPer = 0;
        |FINSI;
        |SI #108#5 = "G"; nGan = nGan + #108#6; |FINSI;
        |SI #108#5 = "P"; nPer = nPer + #108#6; |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE BCapituloF;
     #108#2;
     ;
     #101#0, #101#1, #101#3, aDPais;
     #101#0, #101#1, #101#3, aHPais;
     ;
     NULL,BCapituloF;
|FIN;

|PROCESO CapituloF;
     |HAZ DefectVars; nGan = 0; nPer = 0;
     aDPais = "ES"; aHPais = "ES";
     |BUCLE BCapituloF;
     aClave = "F"; aSubClave = "01"; aPais = "ES"; nGanPer = nGan;
     |SI nGanPer ! 0; |HAZ RegistroDec; |FINSI;
     aClave = "F"; aSubClave = "02"; aPais = "ES"; nGanPer = nPer;
     |SI nGanPer ! 0; |HAZ RegistroDec; |FINSI;

     aDPais = "  "; aHPais = "zz";
     nPer = 0; nGan = 0;
     |BUCLE BCapituloF;
     |SI nPer ! 0; |O nGan ! 0;
        aClave = "F";
        |SI nGan ! 0;
           nGanPer = nGan; aSubClave = "03"; aPais = aAntPais;
           |HAZ RegistroDec;
        |FINSI;
        |SI nPer ! 0;
           nGanPer = nPer; aSubClave = "04"; aPais = aAntPais;
           |HAZ RegistroDec;
        |FINSI;
     |FINSI;
|FPRC;

|PROCESO BCapituloE;
     |HAZ DefectVars;

     aClave = "E"; aSubClave = "";
     aNifCes = #107#4; aNomCes = #107#5;
     aAlfa = #107#6; |QBF aAlfa;
     aAlfa1 = aAlfa % 0102;  nDiaAdq  = aAlfa1;
     aAlfa1 = aAlfa % 0402;  nMesAdq  = aAlfa1;
     aAlfa1 = aAlfa % 0704;  nAnyoAdq = aAlfa1;
     nValLiq = #107#7;  nValAdq  = #107#8;
     nImpRtas = #107#9;
     |HAZ RegistroDec;
|FPRC;

|DEFBUCLE BCapituloE;
     #107#1;
     ;
     #101#0, #101#1, #101#3, 001;
     #101#0, #101#1, #101#3, 999;
     ;
     NULL,BCapituloE;
|FIN;

|PROCESO CapituloE;
     |BUCLE BCapituloE;
|FPRC;

|PROCESO Paises;
     |SI #131#4 = "ES"; |ACABA; |FINSI;

     |SI aAntPais ! #131#4;
        |SI nImpIngr ! 0; |O nImpGast ! 0; |O nImpRtas ! 0;
           aSubClave = "02"; aPais = aAntPais;
           aTRegimen = #106#4; aTActivid = #106#5; nEpigrafe = #106#6;
           ||SI nEpigrafe < 1000; nEpigrafe = nEpigrafe * 10; |FINSI;
           |SI nImpIngr ! 0; |O nImpGast ! 0; |O nImpRtas ! 0;
              |HAZ RegistroDec; |HAZ DefectVars;
              nImpIngr = 0; nImpGast = 0; nImpRtas = 0;
           |FINSI;
        |FINSI;
        aAntPais = #131#4;
     |FINSI;

     nImpIngr = nImpIngr + #131#6;
     nImpGast = nImpGast + #131#7;
     nImpRtas = nImpRtas + #131#8;
|FPRC;

|DEFBUCLE Paises;
     #131#1;
     ;
     #106#0, #106#1, #106#2, #106#3, "  ";
     #106#0, #106#1, #106#2, #106#3, "zz";
     ;
     NULL,Paises;
|FIN;

|PROCESO ActEcon;
     |HAZ DefectVars;
     aSubClave = "01";
     aTRegimen = #106#4; aTActivid = #106#5; nEpigrafe = #106#6;
     ||SI nEpigrafe < 1000; nEpigrafe = nEpigrafe * 10; |FINSI;
     nImpIngr =  #106#7; nImpGast =  #106#8; nImpRtas =  #106#9;
     |SI nImpIngr ! 0; |O nImpGast ! 0; |O nImpRtas ! 0;
        |HAZ RegistroDec;
     |FINSI;

     nImpIngr = 0; nImpGast = 0; nImpRtas = 0;
     |HAZ DefectVars; |BUCLE Paises;
     aSubClave = "02"; aPais = aAntPais;
     aTRegimen = #106#4; aTActivid = #106#5; nEpigrafe = #106#6;
     ||SI nEpigrafe < 1000; nEpigrafe = nEpigrafe * 10; |FINSI;
     |SI nImpIngr ! 0; |O nImpGast ! 0; |O nImpRtas ! 0;
        |HAZ RegistroDec;
     |FINSI;

     |HAZ DefectVars;
     aSubClave = "03";
     aTRegimen = #106#4; aTActivid = #106#5; nEpigrafe = #106#6;
     ||SI nEpigrafe < 1000; nEpigrafe = nEpigrafe * 10; |FINSI;
     nImpRtaR =  #106#13;
     |SI nImpRtaR ! 0; |HAZ RegistroDec; |FINSI;
|FPRC;

|DEFBUCLE ActEcon;
     #106#1;
     ;
     #101#0, #101#1, #101#3, 01;
     #101#0, #101#1, #101#3, 99;
     ;
     NULL,ActEcon;
|FIN;

|PROCESO CapituloD;
     aClave = "D"; |BUCLE ActEcon;
|FPRC;

|PROCESO CapituloC;
     |HAZ DefectVars; aClave = "C";
     aSubClave = "  ";
     |SI #105#4 = "S";
        aSubClave = "03"; aPais = "  ";
        nPorcRed = #105#9;
        nImpRtaR = #105#10;
     |SINO;
        aPais    = #105#5;
        nImpIngr = #105#6;
        nImpGast = #105#7;
        nImpRtas = #105#8;
        |SI aPais = "ES";
           aSubClave = "01";
        |SINO;
           aSubClave = "02";
        |FINSI;
     |FINSI;
     |HAZ RegistroDec;
|FPRC;

|DEFBUCLE CapituloC;
     #105#1;
     ;
     #101#0, #101#1, #101#3, 001;
     #101#0, #101#1, #101#3, 999;
     ;
     NULL,CapituloC;
|FIN;

|PROCESO CapituloB;
     |HAZ DefectVars; aClave = "B";
     aSubClave = "  ";
     aPais    = #104#7; aNifCes  = #104#4;
     aNomCes  = #104#5; nImpIngr = #104#6;
     |HAZ RegistroDec;
|FPRC;

|DEFBUCLE CapituloB;
     #104#1;
     ;
     #101#0, #101#1, #101#3, 001;
     #101#0, #101#1, #101#3, 999;
     ;
     NULL,CapituloB;
|FIN;

|PROCESO BCapituloA;
     |HAZ DefectVars; aClave = "A";

     |SI #103#4 = "S";
         aSubClave = "03"; aPais = "  ";
         nPorcRed = #103#9;
         nImpRtaR = #103#10;
     |SINO;
         aPais    = #103#5;
         nImpIngr = #103#6;
         nImpGast = #103#7;
         nImpRtas = #103#8;
         |SI aPais = "ES";
             aSubClave = "01";
         |SINO;
             aSubClave = "02";
         |FINSI;
     |FINSI;
     |HAZ RegistroDec;
|FPRC;

|DEFBUCLE BCapituloA;
     #103#2;
     ;
     #101#0, #101#1, #101#3, aRed, aDPais, 001;
     #101#0, #101#1, #101#3, aRed, aHPais, 999;
     ;
     NULL, BCapituloA;
|FIN;

|PROCESO CapituloA;
     aRed = "N"; aDPais = "ES"; aHPais = "ES"; |BUCLE BCapituloA;
     aRed = "N"; aDPais = " !"; aHPais = "ER"; |BUCLE BCapituloA;
     aRed = "N"; aDPais = "ET"; aHPais = "ZZ"; |BUCLE BCapituloA;
     aRed = "S"; aDPais = "  "; aHPais = "ZZ"; |BUCLE BCapituloA;
|FPRC;

|PROCESO Declarantes;
     aCadena = "";
     |PARA nCont = 1; |SI nCont [ 24; |HACIENDO nCont = nCont + 1;
           eaAlfa  = #565nCont;  |HAZ QuitaRaros;
           aCadena = eaAlfa;
           |XGRABA nHandle, aCadena;
     |SIGUE;
     aCadena = &13 + &10;
     |XGRABA nHandle, aCadena;

     |HAZ CapituloA;
     |BUCLE CapituloB;
     |BUCLE CapituloC;
     |HAZ CapituloD;
     |HAZ CapituloE;
     |HAZ CapituloF;
     |HAZ CapituloG;
     |HAZ CapituloH;
     |HAZ CapituloI;
     |HAZ CapituloJ;
     |HAZ CapituloK;
     |BUCLE CapituloL;
     |BUCLE RegistroSoc;
|FPRC;

|DEFBUCLE Declarantes;
     #565#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Declarantes;
|FIN;

|PROCESO BuscaCargo;
     eaAlfa  = #26#4;  |HAZ QuitaRaros;
     #dsmow568#13 = eaAlfa;

     eaAlfa  = #26#17;  |HAZ QuitaRaros;
     #dsmow568#14 = eaAlfa;
|FPRC;

|DEFBUCLE agim0026;
     #26#1;
     16;
     #dsm18401#0, 01, 01, 3;
     #dsm18401#0, 99, 99, 3;
     ;
     NULL, BuscaCargo;
|FIN;

|PROCESO BuscaCargo184R;
     eaAlfa  = #24#4;  |HAZ QuitaRaros;
     #dsmow568#13 = eaAlfa;

     eaAlfa  = "REPRESENTANTE";  |HAZ QuitaRaros;
     #dsmow568#14 = eaAlfa;

     nHayRepre = 1;
     |ERROR10;
|FPRC;

|DEFBUCLE agim0024;
     #24#2;
     ;
     #dsm18401#0, 99, 01;
     #dsm18401#0, 01, 99;
     ;
     NULL, BuscaCargo184R;
|FIN;

|PROCESO BuscaComuneros184;
     aAlfa = "31.12." + #dsm18401#1;
     |SI #dsmom001#8 > aAlfa;  |ACABA;  |FINSI;

     aAlfa = "01.01." + #dsm18401#1;
     |SI #dsmom001#9 ! "01.01.0000";
         |SI #dsmom001#9 < aAlfa;  |ACABA;  |FINSI;
     |FINSI;

     nHayRepre = 1;

     enCodCli = #dsmom001#3; |HAZ LeePersona;

     eaAlfa  = #715#1;           |HAZ QuitaRaros;   #dsmow568#13 = eaAlfa;
     eaAlfa  = "REPRESENTANTE";  |HAZ QuitaRaros;   #dsmow568#14 = eaAlfa;

     |ERROR10;
|FPRC;

|DEFBUCLE dsmom001;
     #dsmom001#1;
     ;
     #dsm18401#0, 01, 0001;
     #dsm18401#0, 99, 9999;
     ;
     NULL, BuscaComuneros184;
|FIN;

|PROCESO Individual2006;
     |ABRE #101;
     #101#0 = #999#0;
     #101#1 = #999#1;
     #101#2 = #999#5;
     #101#3 = #999#7;
     |LEE 000#101=;
     |SI FSalida ! 0;  |DDEFECTO #101;  |FINSI;
     |CIERRA #101;

     aAbre = eaPathEmision + "OPA" + (("00000" + #999#0) % -105) + ".TXT";
     |XABRE "BW", aAbre, nHandle2;

     nNumSocs = 0; |BUCLE CuentaSocios;

     |DDEFECTO #565;        ||Declarante
     #565#0 = #101#0;
     #565#3 = #101#1;
     aAlfa  = #101#8; |QBF aAlfa;
     aAlfa  = (aAlfa + (" " * 9)) % 0109;  #565#4 = aAlfa;
     aAlfa  = #101#9; |QBF aAlfa;
     aAlfa  = (aAlfa + (" " * 40)) % 0140; #565#5 = aAlfa;

     |SI nTecla = 2; |O nTecla = 3;
         #565#6 = "T";
     |SINO;
         #565#6 = "P";
     |FINSI;

     aAlfa = #101#16; |QBT aAlfa;
     aAlfa = (aAlfa + (" " * 40)) % 0140; #565#7 = aAlfa;
     aAlfa = #101#55; |QBF aAlfa;
     aAlfa = (aAlfa + (" " * 50)) % 0150; #565#8 = aAlfa;

     #565#9 = "1840000000000";
     |SI #101#3 = 0;
         #565#10 = " ";
         #565#11 = " ";
         #565#12 = "0000000000000";
     |SINO;
         |SI #101#7 = 0;
             #565#10 = "C";
             #565#11 = " ";
             #565#12 = "0000000000000";
         |SINO;
             #565#10 = " ";
             #565#11 = "S";
             aAlfa   = "184" + (("0000000000" + #101#7) % -110);
             #565#12 = aAlfa;
         |FINSI;
     |FINSI;
     aAlfa   = nNumSocs; aAlfa = (("0" * 9) + aAlfa) % -109;
     #565#13 = aAlfa;
     #565#14 = #101#18;
     #565#15 = #101#19;
     #565#16 = #101#20;
     #565#17 = #101#21;
     #565#18 = #101#22;
     nCalc   = #101#23; nCalc = nCalc * 100; aAlfa = nCalc;
     aAlfa   = (("0" * 5) + aAlfa) % -105;
     #565#19 = aAlfa;
     |SI #101#56 = "S";
         #565#20 = "X";
     |SINO;
         #565#20 = " ";
     |FINSI;
     nCalc   = #101#24; nCalc = nCalc * 100; aAlfa = nCalc;
     aAlfa   = (("0" * 15) + aAlfa) % -115;
     #565#21 = aAlfa;
     aAlfa   = #101#25; |QBF aAlfa;
     aAlfa   = (aAlfa + (" " * 9)) % 0109;  #565#22 = aAlfa;
     #565#23 = #101#26;

     nNumDecl = 1; |HAZ Declarantes;

     |XCIERRA nHandle;

     eaFOrigen  = eaPathEmision  + "OPA" + (("00000" + #999#0) % -105) + ".TXT";
     eaFDestino = eaPathLanza + "OPA" + (("00000" + #999#0) % -105) + ".TXT";
     |HAZ CopiaFichero;

     |FBORRA eaFOrigen;

     |SI nTecla = 2;
        aAbre = eaPathEmision + "AUXILIAR.TXT";
     |SINO;
        aAbre = eaPathEmision + "OPB" + (("00000" + #999#0) % -105) + ".TXT";
     |FINSI;
     |XABRE "BW", aAbre, nHandle;

     enCodCli = #dsm18401#0;
     |HAZ LeePersona;
     |DDEFECTO #dsmow568;
     #dsmow568#0  = "1";
     #dsmow568#1  = "184";
     #dsmow568#2  = #dsm18401#1;
     |SI enSwDeDonde = 1;
         eaVarDni = #715#3;  |HAZ CalculameDNI;
         #dsmow568#3   = eaVarDni;
         #dsmow568#4   = ("00" + #715#15) % -102;
         #dsmow568#5   = ("000" + #715#16) % -103;
         #dsmow568#6   = #715#29;
         eaAlfa   = #715#30;  |HAZ QuitaRaros;
         #dsmow568#7   = eaAlfa;
         nNume    = #715#31;
         #dsmow568#8   = ("00000" + nNume) % -105;
         eaAlfa   = #715#37;  |HAZ QuitaRaros;
         #dsmow568#9   = eaAlfa;
         #dsmow568#10  = ("00" + #715#35) % -102;
         #dsmow568#11  = (("00" + #715#35) % -102) + (("000" + #715#36) % -103);
     |SINO;
         eaVarDni = #715#13;  |HAZ CalculameDNI;
         #dsmow568#3   = eaVarDni;
         #dsmow568#4   = ("00" + #715#63) % -102;
         #dsmow568#5   = ("000" + #715#64) % -103;
         #dsmow568#6   = #715#3;
         eaAlfa   = #715#4;  |HAZ QuitaRaros;
         #dsmow568#7   = eaAlfa;
         nNume    = #715#5;
         #dsmow568#8   = ("00000" + nNume) % -105;
         #dsmow568#9   = #715#11;
         #dsmow568#10  = ("00" + #715#9) % -102;
         #dsmow568#11  = (("00" + #715#9) % -102) + (("000" + #715#10) % -103);
     |FINSI;
     #dsmow568#12  = (#0#7 % -104) + (#0#7 % 402) + (#0#7 % 102);
     |SI #107#1 = "S";
         |BUCLE agim0026;
     |SINO;
         nHayRepre = 0;
         |BUCLE agim0024;
         |SI nHayRepre = 0;
            |BUCLE dsmom001;
            |SI nHayRepre = 0;
               eaAlfa  = #999#3;  |HAZ QuitaRaros;
               #dsmow568#13 = eaAlfa;
               eaAlfa  = "TITULAR";  |HAZ QuitaRaros;
               #dsmow568#14 = eaAlfa;
            |FINSI;
         |FINSI;
     |FINSI;
     #dsmow568#15  = ("00000" + #999#0) % -105;
     #dsmow568#16  = "";
     eaAlfa  = #dsm18401#27;  |HAZ QuitaRaros; eaAlfa = eaAlfa % 0120;
     #dsmow568#17  = eaAlfa;
     aAlfa = ("00000" + #dsm18401#28) % -105;
     #dsmow568#18  = aAlfa;
     aAlfa = (("00" + #dsm18401#29) % -102) + (("000" + #dsm18401#29) % -103);
     #dsmow568#19  = aAlfa;
     eaAlfa  = #dsm18401#31;  |HAZ QuitaRaros; eaAlfa = eaAlfa % 0112;
     #dsmow568#20  = eaAlfa;
     aAlfa = (("00" + #dsm18401#29) % -102);
     #dsmow568#21  = aAlfa;
     #dsmow568#22 = &13 + &10;

     aAlfa = "";
     |PARA nCampo = 0;  |SI nCampo [ 22;  |HACIENDO nCampo = nCampo + 1;
        aAlfa = #dsmow568#nCampo#;
        |XGRABA nHandle, aAlfa;
     |SIGUE;

     |XCIERRA nHandle;

     |SI nTecla = 2;
         eaFOrigen  = eaPathEmision  + "AUXILIAR.TXT";
         eaFDestino = eaPathLanza + "AUXILIAR.TXT";
     |SINO;
         eaFOrigen  = eaPathEmision  + "OPB" + (("00000" + #999#0) % -105) + ".TXT";
         eaFDestino = eaPathLanza + "OPB" + (("00000" + #999#0) % -105) + ".TXT";
     |FINSI;

     |HAZ CopiaFichero;
     |FBORRA eaFOrigen;
|FPRC;

|PROCESO Individual;
     |ABRE #101;
     #101#0 = #999#0;
     #101#1 = #999#1;
     #101#2 = #999#5;
     #101#3 = #999#7;
     |LEE 000#101=;
     |SI FSalida ! 0;  |DDEFECTO #101;  |FINSI;
     |CIERRA #101;

     aAbre = eaPathEmision + "184" + (("00000" + #999#0) % -105) + ".seq";
     |XABRE "BW", aAbre, nHandle;

     nNumSocs = 0;
     |BUCLE CuentaSocios;

     |DDEFECTO #565;        ||Declarante
     #565#0 = #101#0;
     #565#3 = #101#1;
     aAlfa  = #101#8; |QBF aAlfa;
     aAlfa  = (aAlfa + (" " * 9)) % 0109;  #565#4 = aAlfa;
     aAlfa  = #101#9; |QBF aAlfa;
     aAlfa  = (aAlfa + (" " * 40)) % 0140; #565#5 = aAlfa;

     |SI nTecla = 2;
         #565#6 = "T";
     |SINO;
         #565#6 = "D";
     |FINSI;

     aAlfa = #101#16; |QBT aAlfa;
     aAlfa = (aAlfa + (" " * 40)) % 0140; #565#7 = aAlfa;
     aAlfa = #101#55; |QBF aAlfa;
     aAlfa = (aAlfa + (" " * 50)) % 0150; #565#8 = aAlfa;

     #565#9 = "1840000000000";

     |SI #101#7 = 0;
         #565#10 = " ";
         #565#11 = " ";
         #565#12 = "0000000000000";
     |SINO;
         |SI #101#5 = "C";
             #565#10 = "C";
             #565#11 = " ";
             #565#12 = "0000000000000";
         |SINO;
             #565#10 = " ";
             #565#11 = "S";
             aAlfa   = "184" + (("0000000000" + #101#7) % -110);
             #565#12 = aAlfa;
         |FINSI;
     |FINSI;

     aAlfa   = nNumSocs; aAlfa = (("0" * 9) + aAlfa) % -109;
     #565#13 = aAlfa;
     #565#14 = #101#18;
     #565#15 = #101#19;
     #565#16 = #101#20;
     #565#17 = #101#21;
     #565#18 = #101#22;
     nCalc   = #101#23; nCalc = nCalc * 100; aAlfa = nCalc;
     aAlfa   = (("0" * 5) + aAlfa) % -105;
     #565#19 = aAlfa;
     |SI #101#56 = "S";
         #565#20 = "X";
     |SINO;
         #565#20 = " ";
     |FINSI;
     nCalc   = #101#24; nCalc = nCalc * 100; aAlfa = nCalc;
     aAlfa   = (("0" * 15) + aAlfa) % -115;
     #565#21 = aAlfa;
     aAlfa   = #101#25; |QBF aAlfa;
     aAlfa   = (aAlfa + (" " * 9)) % 0109;  #565#22 = aAlfa;
     #565#23 = #101#26;

     nNumDecl = 1;

     |HAZ Declarantes;

     |XCIERRA nHandle;

     eaFOrigen  = eaPathEmision  + "184" + (("00000" + #999#0) % -105) + ".seq";
     eaFDestino = eaPathInternet + "184" + (("00000" + #999#0) % -105) + ".seq";
     |HAZ CopiaFichero;

     |SI nTecla = 1;
         |MENAV "     Introduzca un diskette vacio en la disketera de su PC.";
         |MENAV "     Pulse una tecla si el diskette esta preparado";

         aOrigen  = eaFDestino;
         aDestino = "a:/184" + (("00000" + #999#0) % -105) + ".seq";
         |RCOPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     |SI nPortada = 1;  |HAZ Portada184;  |FINSI;

     |HAZ GrabaImpreso;
|FPRC;

|PROCESO Presentador;
     aCadena = "0184";
     aCadena = aCadena + #999#1;
     aAlfa   = #997#0; |QBF aAlfa;
     aAlfa   = (("0" * 9) + aAlfa) % -109; aCadena = aCadena + aAlfa;
     aAlfa   = #997#1; |QBF aAlfa;
     aAlfa   = (aAlfa + (" " * 40)) % 0140; aCadena = aCadena + aAlfa;
     aCadena = aCadena + #997#2;
     aAlfa   = #997#3; |QBF aAlfa;
     aAlfa   = (aAlfa + (" " * 20)) % 0120; aCadena = aCadena + aAlfa;
     aAlfa   = #997#4; |QBF aAlfa;
     aAlfa   = (("0" * 5) + aAlfa) % -105; aCadena = aCadena + aAlfa;
     aCadena = aCadena + (#997#5 % 102);
     aCadena = aCadena + #997#6;
     aCadena = aCadena + #997#7;
     aAlfa   = #997#8; |QBF aAlfa;
     aAlfa   = (("0" * 2) + aAlfa) % -102; aCadena = aCadena + aAlfa;
     aAlfa   = #997#9#24; |QBF aAlfa;
     aAlfa   = (("0" * 3) + aAlfa) % -103; aCadena = aCadena + aAlfa;
     aCadena = aCadena + #997#10;
     aAlfa   = #997#8; |QBF aAlfa;
     aAlfa   = (("0" * 2) + aAlfa) % -102; aCadena = aCadena + aAlfa;
     aAlfa   = nNumDecl; |QBF aAlfa;
     aAlfa   = (("0" * 5) + aAlfa) % -105; aCadena = aCadena + aAlfa;
     aAlfa   = nNumTotSocs; |QBF aAlfa;
     aAlfa   = (("0" * 9) + aAlfa) % -109; aCadena = aCadena + aAlfa;
     aCadena = aCadena + "D";
     aAlfa   = #997#14; |QBF aAlfa;
     aAlfa   = (("0" * 9) + aAlfa) % -109; aCadena = aCadena + aAlfa;
     aAlfa   = #997#13; |QBF aAlfa;
     aAlfa   = (aAlfa + (" " * 40)) % 0140; aCadena = aCadena + aAlfa;
     aCadena = aCadena + (" " * 77);
     aCadena = aCadena + &13 + &10;
     |XGRABA nHandle, aCadena;
|FPRC;

|PROCESO Colectivo;
     |SI nRegistros = 0;
         aAbre = eaPathEmision + "18400000.seq";

         |XABRE "BW", aAbre, nHandle;

         #997#17 = nNumDecl;
         #997#18 = nNumTotSocs;

         |PUSHV 0501 2380;
         |PINPA #0#997;
         |PINDA #0#997;
         |ENDATOS #1#997;
         |SI FSalida ! 0; |POPV;  |ACABA;  |FINSI;
         |POPV;

         |HAZ Presentador;

         |SI nPortada = 1;  |HAZ Portada184;  |FINSI;
     |FINSI;

     nRegistros = 1;

     |ABRE #101;
     #101#0 = #999#0;
     #101#1 = #999#1;
     #101#2 = #999#5;
     #101#3 = #999#7;
     |LEE 000#101=;
     |SI FSalida ! 0;  |DDEFECTO #101;  |FINSI;
     |CIERRA #101;

     nNumSocs = 0;
     |BUCLE CuentaSocios;

     |DDEFECTO #565;        ||Declarante
     #565#0 = #101#0;
     #565#3 = #101#1;
     aAlfa  = #101#8; |QBF aAlfa;
     aAlfa  = (aAlfa + (" " * 9)) % 0109;  #565#4 = aAlfa;
     aAlfa  = #101#9; |QBF aAlfa;
     aAlfa  = (aAlfa + (" " * 40)) % 0140; #565#5 = aAlfa;

     |SI nTecla = 4;
         #565#6 = "T";
     |SINO;
         #565#6 = "D";
     |FINSI;

     aAlfa = #101#16; |QBT aAlfa;
     aAlfa = (aAlfa + (" " * 40)) % 0140; #565#7 = aAlfa;
     aAlfa = #101#55; |QBF aAlfa;
     aAlfa = (aAlfa + (" " * 50)) % 0150; #565#8 = aAlfa;

     #565#9 = "1840000000000";

     |SI #101#7 = 0;
         #565#10 = " ";
         #565#11 = " ";
         #565#12 = "0000000000000";
     |SINO;
         |SI #101#5 = "C";
             #565#10 = "C";
             #565#11 = " ";
             #565#12 = "0000000000000";
         |SINO;
             #565#10 = " ";
             #565#11 = "S";
             aAlfa   = "184" + (("0000000000" + #101#7) % -110);
             #565#12 = aAlfa;
         |FINSI;
     |FINSI;

     aAlfa   = nNumSocs; aAlfa = (("0" * 9) + aAlfa) % -109;
     #565#13 = aAlfa;
     #565#14 = #101#18;
     #565#15 = #101#19;
     #565#16 = #101#20;
     #565#17 = #101#21;
     #565#18 = #101#22;
     nCalc   = #101#23; nCalc = nCalc * 100; aAlfa = nCalc;
     aAlfa   = (("0" * 5) + aAlfa) % -105;
     #565#19 = aAlfa;
     |SI #101#56 = "S";
         #565#20 = "X";
     |SINO;
         #565#20 = " ";
     |FINSI;
     nCalc   = #101#24; nCalc = nCalc * 100; aAlfa = nCalc;
     aAlfa   = (("0" * 15) + aAlfa) % -115;
     #565#21 = aAlfa;
     aAlfa   = #101#25; |QBF aAlfa;
     aAlfa   = (aAlfa + (" " * 9)) % 0109;  #565#22 = aAlfa;
     #565#23 = #101#26;

     nNumDecl = 1;

     |HAZ Declarantes;

     |SI nPortada = 1;  |HAZ Portada184;  |FINSI;

     |HAZ GrabaImpreso;
|FPRC;

|PROCESO QueHacemos184;
     |SI nSwLee = 1;
         nNumDecl    = nNumDecl + 1;
         nNumTotSocs = 0;
         nNumSocs    = 0;

         |ABRE #101;
         #101#0 = #999#0;
         #101#1 = #999#1;
         #101#2 = #999#5;
         #101#3 = #999#7;
         |LEE 000#101=;
         |SI FSalida ! 0;  |DDEFECTO #101;  |FINSI;
         |CIERRA #101;

         |BUCLE CuentaSocios;
         nNumTotSocs = nNumTotSocs + nNumSocs;

         |ACABA;
     |FINSI;

     |SI #0#6 < 2006;
        |SI nTecla = 1;  |HAZ Individual;     |FINSI;
        |SI nTecla = 2;  |HAZ Individual;     |FINSI;
        |SI nTecla = 3;  |HAZ Colectivo;      |FINSI;
        |SI nTecla = 4;  |HAZ Colectivo;      |FINSI;
     |SINO;
        |HAZ Individual2006;

        |SI nTecla = 2;
           eaTipoV =  "S";
        |FINSI;
        |SI nTecla = 5; |O nTecla = 6;
           eaTipoV =  "N";
        |FINSI;
        eaTipoE =  "OPA" + (("00000" + #999#0) % -105) + ".TXT";
        eaTipoR =  "OPC" + (("00000" + #999#0) % -105) + ".TXT";
        eaTipoP =  "PDF" + (("00000" + #999#0) % -105) + ".PDF";
        eaTipoC =  aTercera;
        eaTipoA =  "OPB" + (("00000" + #999#0) % -105) + ".TXT";

        |HAZ LineaShellJava;
        |HAZ GrabaImpreso;
     |FINSI;
|FPRC;

|DEFBUCLE dsmow014C184;
     #999#1;
     6;
     00000, 0000, 00, "S";
     99999, 9999, 99, "S";
     ;
     NULL, QueHacemos184;
|FIN;

|DEFBUCLE dsmow014N184;
     #999#2;
     6;
     "                                        ", "S";
     "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz", "S";
     ;
     NULL, QueHacemos184;
|FIN;

/**************** PROCESOS PARA INFORME DE COMPROBACION *********************/

|PROCESO PonACero;
     sw03 = 0; sw04 = 0; sw05 = 0; sw06 = 0; sw07 = 0;
     sw08 = 0; sw09 = 0; sw10 = 0; sw14 = 0; sw30 = 0;
|FPRC;

|PROCESO Recupera;
/*
     |SI nElsw = 30; sw30 = nElval; |FINSI;
     |SI nElsw = 03; sw03 = nElval; |FINSI;
     |SI nElsw = 04; sw04 = nElval; |FINSI;
     |SI nElsw = 05; sw05 = nElval; |FINSI;
     |SI nElsw = 06; sw06 = nElval; |FINSI;
     |SI nElsw = 07; sw07 = nElval; |FINSI;
     |SI nElsw = 08; sw08 = nElval; |FINSI;
     |SI nElsw = 09; sw09 = nElval; |FINSI;
     |SI nElsw = 10; sw10 = nElval; |FINSI;
     |SI nElsw = 14; sw14 = nElval; |FINSI;
*/
     |SI nElsw = 30; sw30 = 1; |FINSI;
     |SI nElsw = 03; sw03 = 1; |FINSI;
     |SI nElsw = 04; sw04 = 1; |FINSI;
     |SI nElsw = 05; sw05 = 1; |FINSI;
     |SI nElsw = 06; sw06 = 1; |FINSI;
     |SI nElsw = 07; sw07 = 1; |FINSI;
     |SI nElsw = 08; sw08 = 1; |FINSI;
     |SI nElsw = 09; sw09 = 1; |FINSI;
     |SI nElsw = 10; sw10 = 1; |FINSI;
     |SI nElsw = 14; sw14 = 1; |FINSI;
|FPRC;

|PROCESO Imprime;
     |SI sw30 = 1;  nNumLin = 13; nElval = 1;  nElsw = 30; |FINSI;
     |SI sw30 = 11; nNumLin = 12; nElval = 11; nElsw = 30; |FINSI;
     |SI sw03 = 1;  nNumLin = 3;  nElval = 1;  nElsw = 03; |FINSI;
     |SI sw03 = 11; nNumLin = 1;  nElval = 11; nElsw = 03; |FINSI;
     |SI sw04 = 1;  nNumLin = 4;  nElval = 1;  nElsw = 04; |FINSI;
     |SI sw04 = 11; nNumLin = 1;  nElval = 11; nElsw = 04; |FINSI;
     |SI sw05 = 1;  nNumLin = 4;  nElval = 1;  nElsw = 05; |FINSI;
     |SI sw05 = 11; nNumLin = 1;  nElval = 11; nElsw = 05; |FINSI;
     |SI sw06 = 1;  nNumLin = 6;  nElval = 1;  nElsw = 06; |FINSI;
     |SI sw06 = 11; nNumLin = 3;  nElval = 11; nElsw = 06; |FINSI;
     |SI sw07 = 1;  nNumLin = 4;  nElval = 1;  nElsw = 07; |FINSI;
     |SI sw07 = 11; nNumLin = 1;  nElval = 11; nElsw = 07; |FINSI;
     |SI sw08 = 1;  nNumLin = 4;  nElval = 1;  nElsw = 08; |FINSI;
     |SI sw08 = 11; nNumLin = 1;  nElval = 11; nElsw = 08; |FINSI;
     |SI sw09 = 1;  nNumLin = 4;  nElval = 1;  nElsw = 09; |FINSI;
     |SI sw09 = 11; nNumLin = 1;  nElval = 11; nElsw = 09; |FINSI;
     |SI sw10 = 1;  nNumLin = 16; nElval = 1;  nElsw = 10; |FINSI;
     |SI sw14 = 1;  nNumLin = 4;  nElval = 1;  nElsw = 14; |FINSI;
     |SI sw14 = 11; nNumLin = 1;  nElval = 11; nElsw = 14; |FINSI;

     nTotLin = nTotLin + nNumLin;
     |SI nTotLin > 72;
          swB = 1;
          |HAZ PonACero;
          |SI nElval = 11;    swCont = 1;    |FINSI;
          nNumBlan = 72 - (nTotLin - nNumLin);
          |PARA nNume = 1; |SI nNume [ nNumBlan; |HACIENDO nNume = nNume + 1;
               |PRINT;
          |SIGUE;
          nTotLin = nNumLin;
          swB = 0;
          |HAZ Recupera;
          |PIEINF;
     |FINSI;

     |PRINT;

     |SI sw03 = 1; sw03 = 11; |FINSI;
     |SI sw04 = 1; sw04 = 11; |FINSI;
     |SI sw05 = 1; sw05 = 11; |FINSI;
     |SI sw06 = 1; sw06 = 11; |FINSI;
     |SI sw07 = 1; sw07 = 11; |FINSI;
     |SI sw08 = 1; sw08 = 11; |FINSI;
     |SI sw09 = 1; sw09 = 11; |FINSI;
     |SI sw14 = 1; sw14 = 11; |FINSI;
     |SI sw30 = 1; sw30 = 11; |FINSI;
     |SI swC = 1;  swC = 0;   |FINSI;
     |SI swCont = 1;  swCont = 0;   |FINSI;
|FPRC;

|DEFBUCLE Comp30;
     #130#2;
     ;
     #101#0, #101#1, #101#3, "               ";
     #101#0, #101#1, #101#3, "zzzzzzzzzzzzzzz";
     ;
     NULL, Imprime;
|FIN;

|DEFBUCLE Comp14;
     #114#1;
     ;
     #101#0, #101#1, #101#3, 001;
     #101#0, #101#1, #101#3, 999;
     ;
     NULL, Imprime;
|FIN;

|DEFBUCLE Comp09;
     #109#1;
     ;
     #101#0, #101#1, #101#3, 001;
     #101#0, #101#1, #101#3, 999;
     ;
     NULL, Imprime;
|FIN;

|DEFBUCLE Comp08;
     #108#1;
     ;
     #101#0, #101#1, #101#3, 001;
     #101#0, #101#1, #101#3, 999;
     ;
     NULL, Imprime;
|FIN;

|DEFBUCLE Comp07;
     #107#1;
     ;
     #101#0, #101#1, #101#3, 001;
     #101#0, #101#1, #101#3, 999;
     ;
     NULL, Imprime;
|FIN;

|DEFBUCLE Comp06;
     #106#1;
     ;
     #101#0, #101#1, #101#3, 001;
     #101#0, #101#1, #101#3, 999;
     ;
     NULL, Imprime;
|FIN;

|DEFBUCLE Comp05;
     #105#1;
     ;
     #101#0, #101#1, #101#3, 001;
     #101#0, #101#1, #101#3, 999;
     ;
     NULL, Imprime;
|FIN;

|DEFBUCLE Comp04;
     #104#1;
     ;
     #101#0, #101#1, #101#3, 001;
     #101#0, #101#1, #101#3, 999;
     ;
     NULL, Imprime;
|FIN;

|DEFBUCLE Comp03;
     #103#1;
     ;
     #101#0, #101#1, #101#3, 001;
     #101#0, #101#1, #101#3, 999;
     ;
     NULL, Imprime;
|FIN;

|PROCESO ElGranInforme;
     sw03 = 0;
     sw04 = 0;
     sw05 = 0;
     sw06 = 0;
     sw07 = 0;
     sw08 = 0;
     sw09 = 0;
     sw10 = 0;
     sw14 = 0;
     sw30 = 0;
     swC = 1;
     nTotLin = 25;

     sw30 = 1; |BUCLE Comp30; sw30 = 0;
     sw03 = 1; |BUCLE Comp03; sw03 = 0;
     sw04 = 1; |BUCLE Comp04; sw04 = 0;
     sw05 = 1; |BUCLE Comp05; sw05 = 0;
     sw06 = 1; |BUCLE Comp06; sw06 = 0;
     sw07 = 1; |BUCLE Comp07; sw07 = 0;
     sw08 = 1; |BUCLE Comp08; sw08 = 0;
     sw09 = 1; |BUCLE Comp09; sw09 = 0;
     sw10 = 1; |HAZ Imprime;  sw10 = 0;
     sw14 = 1; |BUCLE Comp14; sw14 = 0;
     |PIEINF;
|FPRC;

|DEFBUCLE ElGranInforme;
     #101#1;
     ;
     #999#0, #999#1, #999#5, 00;
     #999#0, #999#1, #999#5, 99;
     ;
     NULL, ElGranInforme;
|FIN;

|PROCESO InformeComp;
     |BUCLE ElGranInforme;

/*
     |ABRE #101;
     #101#0 = #999#0;
     #101#1 = #999#1;
     #101#2 = #999#5;
     #101#3 = #999#7;
     |LEE 000#101=;
     |SI FSalida = 0;
     |FINSI;
*/
|FPRC;

|DEFBUCLE InformeComp;
     #999#1;
     6;
     00000, 0000, 00, "S";
     99999, 9999, 99, "S";
     ;
     NULL, InformeComp;
|FIN;

/**************** FIN PROCESOS INFORME DE COMPROBACION **********************/

|PROCESO Boton1841_06;
     |PTEC 824;
|FPRC;

|PROCESO Boton1842_06;
     |PTEC 825;
|FPRC;

|PROCESO Boton1843_06;
     |PTEC 826;
|FPRC;

|PROCESO Boton1844_06;
     |PTEC 827;
|FPRC;

|PROCESO Boton1845_06;
     |PTEC 828;
|FPRC;

|PROCESO Boton1846_06;
     |PTEC 829;
|FPRC;

|PROCESO Boton1847_06;
     |PTEC 830;
|FPRC;

|PROCESO Boton184Esc_06;
     |PTEC 806;
|FPRC;

|PROCESO Botones184Del2006;
     |BLANCO 0501 2380;

     |CONTROL_SIMPLE 0, "LBOTON, <F2> Emision Papel Oficial Laser (Directo por impresora)", 0613, 0754, Boton1841_06;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F3> Emision Papel Oficial Laser (Vista previa  por el Acrobat)", 0913, 1054, Boton1842_06;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F4> Presentaci¢n Telem tica Individual (con validacion)", 1213, 1354, Boton1843_06;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F5> Informe de comprobación ", 1513, 1654, Boton1844_06;
     nBoton5 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F6> Directorio Acrobat ", 1813, 1954, Boton1845_06;
     nBoton6 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,ESC Cancelar", 2365, 2378, Boton184Esc_06;
     nBoton7 = FSalida;

     aEsc = &255 + "806";
     aF2 = &255 + "824";
     aF3 = &255 + "825";
     aF4 = &255 + "826";
     aF5 = &255 + "827";
     aF6 = &255 + "828";
     aF7 = &255 + "829";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         nTecla = 0;
         |SI aTecla = aEsc;               |SAL;  |FINSI;

         |SI aTecla = aF2; nTecla = 5; eaModoImpre = "I"; |SAL; |FINSI;
         |SI aTecla = aF3; nTecla = 6; eaModoImpre = "P"; |SAL; |FINSI;
         |SI aTecla = aF4;  nTecla = 2;   |SAL;  |FINSI;
         |SI aTecla = aF5;  nTecla = 4;   |SAL;  |FINSI;
         |SI aTecla = aF6;  |HAZ Acrobat;        |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton5;
     |FIN_CONTROL_WINDOWS nBoton6;
     |FIN_CONTROL_WINDOWS nBoton7;

     |SI nTecla = 5; |O nTecla = 6;
        aTercera = "N";
        aAlfa = "    " + &191 + " Desea emitir una tercera copia del modelo ? ";
        |CONFI aAlfa;
        |SI FSalida = 0; aTercera = "S"; |FINSI;
     |FINSI;
     |PULSATECLA;
|FPRC;

|PROCESO Boton1841;
   |PTEC 824;
|FPRC;

|PROCESO Boton1842;
   |PTEC 825;
|FPRC;

|PROCESO Boton1843;
   |PTEC 806;
|FPRC;

|PROCESO Botones184;
     |BLANCO 0501 2380;

||     |CONTROL_SIMPLE 0, "LBOTON, <F2> Soporte Magnetico Individual ", 0813, 1054, Boton1841;
||     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F2> Internet Individual ", 1013, 1254, Boton1841;
     nBoton1 = FSalida;

||     |CONTROL_SIMPLE 0, "LBOTON, <F4> Soporte Magnetico Colectivo ", 1513, 1654, Boton1843;
||     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F3> Internet Colectivo ", 1413, 1654, Boton1842;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,ESC Cancelar", 2365, 2378, Boton1843;
     nBoton3 = FSalida;

     aF2 = &255 + "824";
     aF3 = &255 + "825";
     aF4 = &255 + "826";
     aF5 = &255 + "827";
     aF6 = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF6;  nTecla = 0;   |SAL;  |FINSI;

         |SI aTecla = aF2;  nTecla = 2;   |SAL;  |FINSI;
         |SI aTecla = aF3;  nTecla = 4;   |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;

     |PULSATECLA;
|FPRC;

|PROGRAMA;
     aFichero = ("000" + Usuario) % 108;
     |NOME_DAT #0 aFichero;

     aFichero = ("imp" + Usuario) % 108;
     |NOME_DAT #999 aFichero;

     |ABRE #0;
     |LEE 000#0p;
     |CIERRA #0;

     |SI #0#6 ] 2006;
        |SI eaParametro ! "184C";
           |HAZ Botones184Del2006;
           |SI nTecla = 4; || informe de comprobacion
              |IMPRE 0;
              |SI FSalida = 0;
                  |INFOR "dsmoy184";
                  |BUCLE InformeComp;
                  |FININF;
              |FINSI;
              |FINIMP;
              |ACABA;
           |FINSI;
        |FINSI;
        |SI nTecla = 0;  |ACABA;  |FINSI;

        |SI nTecla = 4;
           nSwLee   = 1; nNumDecl = 0;
           |BUCLE dsmow014C184;
        |FINSI;

        |SI nTecla ! 5;
           nSwLee = 0;
           |SI #0#8 = "C";
              |BUCLE dsmow014C184;
           |SINO;
              |BUCLE dsmow014N184;
           |FINSI;
        |SINO;
           |BUCLE dsmow014C184;
        |FINSI;

        |SI nTecla = 2;
           enInternet = 1;
           enValidacion = 0;
        |SINO;
           enValidacion = 0;
           enInternet = 0;
        |FINSI;

        eaFichError = "opc";
        eaFichDatos = "opa";
        eaFichAuxil = "opb";

        |HAZ BuscaErroresL;

        |SI nTecla = 2;
           nSwError = 0;
           aAlfa = eaPathLanza + "/opa*.txt";
           |R_PDIR aAlfa;
           |PARA; |SI FSalida = 0; |HACIENDO;
              aOrigen = aAlfa;
              aAlfa1 = aAlfa % -112;
              aDestino = eaPathInternet + aAlfa1;
              |RCOPIA_FICHERO aOrigen, aDestino;
              |RFBORRA aAlfa;
              nSwError = 1; |R_SDIR aAlfa;
           |SIGUE;

           |SI nSwError = 1;
              aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
              |MENAV aAlfa;
           |FINSI;
        |FINSI;
     |SINO;
        enCambiaMoneda = 1;
        enSwTrata      = 0;
        nTecla         = 0;
        fFecha         = #0#7;
        fFecha         = fFecha % 2;
        aAlfa          = fFecha;
        eaFecha        = aAlfa % 1199;

        |SI eaParametro ! "184C";
          |HAZ Botones184;
        |SINO;
          nTecla = 5;
        |FINSI;

        |SI nTecla = 0;  |ACABA;  |FINSI;

        nPortada = 0;

        |SI nTecla = 5;
          || informe de comprobacion
          |IMPRE 0;
          |SI FSalida = 0;
               |INFOR "dsmoy184";
               |BUCLE InformeComp;
               |FININF;
          |FINSI;
          |FINIMP;
          |ACABA;
        |FINSI;

        |SI nTecla = 3;  |O nTecla = 4;
           nSwLee   = 1; nNumDecl = 0;
           |BUCLE dsmow014C184;
        |FINSI;

        nSwLee = 0;
        |SI #0#8 = "C";
           |BUCLE dsmow014C184;
        |SINO;
           |BUCLE dsmow014N184;
        |FINSI;

        |SI nPortada = 1;
           |FINIMP;
        |FINSI;

        |SI nTecla = 3;  |O nTecla = 4;
           |XCIERRA nHandle;

           eaFOrigen  = eaPathEmision  + "184" + (("00000" + #999#0) % -105) + ".seq";
           eaFDestino = eaPathInternet + "184" + (("00000" + #999#0) % -105) + ".seq";
           |HAZ CopiaFichero;
        |FINSI;

        |SI nTecla = 3;
           |MENAV "     Introduzca un diskette vacio en la disketera de su PC.";
           |MENAV "     Pulse una tecla si el diskette esta preparado";

           aOrigen  = eaFDestino;
           aDestino = "a:/18400000.seq";
           |RCOPIA_FICHERO aOrigen, aDestino;
        |FINSI;

        |SI nTecla = 2;  |O nTecla = 4;
           aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
           |MENAV aAlfa;
        |FINSI;
     |FINSI;
|FPRO;
