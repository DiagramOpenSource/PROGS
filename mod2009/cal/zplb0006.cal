|FICHEROS;
   dsmow103 #913;
   dsmow013 #999;
|FIN;

|VARIABLES;
  aFichero = "";
  &eaSINO  = "";
|FIN;

|INCLUYE i_variar;
|INCLUYE i_varcon;


|PROCESO eGrabaW103;
  aFichero = ("sd" + Usuario) % 108;
  |NOME_DAT #913 aFichero;

  |ABRE #913;
  |DDEFECTO #913;
  #913#0 = enEmpresa;
  #913#1 = 0;
  #913#2 = enEjer;
  #913#3 = enPeriodo;
  #913#7 = enModelo;
  |LEE 040#913=;
  |SI FSalida ! 0;
      #913#0 = enEmpresa;
      #913#1 = 0;
      #913#2 = enEjer;
      #913#3 = enPeriodo;
      #913#7 = enModelo;
      |GRABA 020#913c;
  |FINSI;

  #913#4 = eaNombreEmp;
  #913#5 = eaNomPer;
  #913#6 = eaNombreAct;
  #913#8 = eaCa8103;
  #913#9 = enComplem;
  |GRABA 020#913a;
  |CIERRA #913;

  enFichW103 = 1;
|FPRC;

|PROCESO eIniciW103;
   enFichW103 = -1;
   aFichero = ("sd" + Usuario) % 108;
   |NOME_DAT #913 aFichero;
   |ABRE #913;  |CIERRA #913;  |DELINDEX #913;
|FPRC;


|PROCESO LeeDsmow103;
  eaSINO = "SI";
  |SI #913#8 = "N";
      eaSINO = "NO";
  |FINSI;
  |PRINT;
|FPRC;

|DEFBUCLE LeeDsmow103;
 #913#1;
 ;
 00001, 00, enEjer, enPeriodo, enModelo;
 99999, 99, enEjer, enPeriodo, enModelo;
 ;
 NULL, LeeDsmow103;
|FIN;

|PROCESO eListaW103;
   aFichero = ("sd" + Usuario) % 108;
   |NOME_DAT #913 aFichero;

   |IMPRE 0;
   |SI FSalida = 0;
        |INFOR "dsmow103";
        |SI FSalida = 0;
            |BUCLE LeeDsmow103;
            |PIEINF;
            |FININF;
        |FINSI;
        |FINIMP;
   |FINSI;
   |DELINDEX #913;
|FPRC;
