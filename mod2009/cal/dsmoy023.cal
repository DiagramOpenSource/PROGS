|FICHEROS;
     dsmoy023  #0;
     dsmom017  #17;
     dsmom019  #18;
     dsmod310  #19;
     dsmod370  #20;
     dsmod310@ #119;
     dsmod370@ #120;
     dsmow011  #70;

     :/integral/def/dsam0054 #54;
     :/integral/def/dsam0121 #121;
     :/integral/def/dsam0122 #122;

     &clientes@ #715;
|FIN;

|VARIABLES;
     nCampo      = 0;
     nCampo1     = 0;
     nCampo5     = 0;
     nSwHay      = 0;
     nWord       = 0;
     nNume       = 0;
     nLong       = 0;
     nDecimal    = 0;
     nCaracter   = 0;
     nPos        = 0;
     nCanal      = 0;
     nLinea      = 0;

     aBase       = "";
     aMas        = "";
     aFichero    = "";
     aAlfa       = "";
     aAlfa1      = "";
     aAlfa2      = "";
     aCarta      = "";
     aOrigen     = "";
     aDestino    = "";
     aIPRemoto   = "";
     aAbre       = "";
     aIdenti     = "";
     aAsigna     = "";
     aDecima     = "";
     aEntero     = "";
     aLong       = "";
     aImpor1     = "";
     aImpor2     = "";
     aImpor3     = "";
     aImpor4     = "";
     aCaracter   = "";
     aMenav      = "";
     aDia        = "";
     aEje        = "";
     aMes        = "";

     &enResult        = 0;
     &enResultD       = 0;
     &enCodCarta      = 0;
     &eaPrograma      = "";
     &enFSalida       = 0;
     &enCodUbica      = 0;
     &eaRutaDocumento = "";
     &eaNomUbicacion  = "";
     &eaNomDocumento  = "";
     &eaPathIntegral  = "";
     &eaModelo        = "";
     &eaDocumento     = "";
     &eaAplica        = "";
     &enCodCli        = 0;
     &enSwDeDonde     = 0;
     &eaVarDni        = "";
     &eaNombre        = "";
     &eaEntidad      = "";
     &eaOficina      = "";
     &eaDC           = "";
     &eaCuenta       = "";
     &enForzar       = 0;
     &enModelo       = 0;
|FIN;

|| -------------------------------------------------------------------------

|PROCESO LeeUbicaciones;
     enFSalida = 0;
     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;   |QBT aIPRemoto;
     |SI aIPRemoto = "";  aIPRemoto = "LOCAL";  |FINSI;

     aIPRemoto = (aIPRemoto + (" " * 20)) % 120;

     |ABRE #121;
     #121#0 = enCodUbica;
     |LEE 040#121=;
     enFSalida = FSalida;
     |SI FSalida ! 0;
         |MENAV "      No existe Ubicacion ";
         |CIERRA #121;
         |ACABA;
     |FINSI;
     |CIERRA #121;

     |ABRE #122;
     #122#0 = enCodUbica;
     #122#1 = aIPRemoto;
     |LEE 040#122=;
     enFSalida = FSalida;
     |SI FSalida ! 0;
         aMenav =  "      No existe Ubicacion en la Maquina : " + aIPRemoto;
         |MENAV aMenav;
         |CIERRA #122;
         |ACABA;
     |FINSI;
     |CIERRA #122;

     eaRutaDocumento = #122#3;  |QBF eaRutaDocumento;
     |SI eaRutaDocumento = "";
         aMenav = "      No esta configurada la Ruta en la Maquina " + aIPRemoto;
         |MENAV aMenav;
         enFSalida = 1;
         |ACABA;
     |FINSI;
     eaNomUbicacion = #121#1;
|FPRC;

|PROCESO Ubicacion;  |TIPO 0;
     |DBASS aBase;  |QBF aBase;

     aAlfa = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathIntegral  = aBase + "integral/";
     |FINSI;

     |SI eaPathIntegral = "";
         |C_M #0#5, 1, "N";  #0#5 = "N";  |PINTA #0#5;
         |C_M #0#6, 1, "N";  #0#6 = 0;    |PINTA #0#6;
         |ACABA;
     |FINSI;

     |C_M #0#6, 1, "S";
     |SI #0#5 = "N";
         |C_M #0#6, 1, "N";  #0#6 = 0;  |PINTA #0#6;
     |FINSI;
|FPRC;

|PROCESO BuscaUbicacion;
     |SI #0#5 = "N";  |ACABA;  |FINSI;

     enCodUbica = #0#6;
     |HAZ LeeUbicaciones;
     |SI enFSalida ! 0;  |ERROR;  |ACABA;  |FINSI;

     #0#7 = eaNomUbicacion;  |PINTA #0#7;
|FPRC;

|PROCESO CartaOInforme;
     |C_M #0#5, 1, "S";
     |SI #0#2 = "I";
         |C_M #0#5, 1, "N";
         |C_M #0#8, 1, "N";
         #0#5 = "N";   |PINTA #0#5;
         #0#6 = 0;     |PINTA #0#6;
         #0#7 = "";    |PINTA #0#7;
         #0#8 = "";    |PINTA #0#8;
     |FINSI;
|FPRC;

|| -------------------------------------------------------------------------

|PROCESO Modelo310;
     #119#0 = #19#0;
     #119#1 = #19#1;
     #119#2 = #19#2;
     #119#3 = #19#3;
     #119#4 = #19#4;
     #119#5 = #19#5;
     |LEE 040#119=;
     |SI FSalida ! 0;
         |DDEFECTO #119;
         |PARA nCampo = 0;  |SI nCampo [ 40;  |HACIENDO nCampo = nCampo + 1;
               #119nCampo = #19nCampo;
         |SIGUE;
         |GRABA 020#119b;
     |FINSI;

     |SI #119#6 = #17#5;  |Y #119#7 = #18#142;
         #119#7 = #18#138;
     |FINSI;

     |SI #119#8 = #17#5;  |Y #119#9 = #18#142;
         #119#9 = #18#138;
     |FINSI;

     |SI #119#10 = #17#5;  |Y #119#11 = #18#142;
         #119#11 = #18#138;
     |FINSI;

     |SI #119#12 = #17#5;  |Y #119#13 = #18#142;
         #119#13 = #18#138;
     |FINSI;

     |SI #119#14 = #17#5;  |Y #119#15 = #18#142;
         #119#15 = #18#138;
     |FINSI;

     #119#24 = #119#7  + #119#9  + #119#11 + #119#13 + #119#15;
     #119#24 = #119#24 + #119#17 + #119#19 + #119#21 + #119#23;
     #119#26 = #119#24 - #119#25;
     #119#30 = #119#26 + #119#27 + #119#28 + #119#29;
     #119#33 = #119#31 + #119#32;
     #119#34 = #119#30 - #119#33;
     #119#36 = #119#34 - #119#35;

     |GRABA 020#119a;
     |LIBERA #119;
|FPRC;

|PROCESO Modelo370;
     #120#0 = #20#0;
     #120#1 = #20#1;
     #120#2 = #20#2;
     #120#3 = #20#3;
     #120#4 = #20#4;
     #120#5 = #20#5;
     |LEE 040#120=;
     |SI FSalida ! 0;
         |DDEFECTO #120;
         |PARA nCampo = 0;  |SI nCampo [ 86;  |HACIENDO nCampo = nCampo + 1;
               #120nCampo = #20nCampo;
         |SIGUE;
         |GRABA 020#120b;
     |FINSI;

     |SI #120#57 = #17#5;  |Y #120#58 = #18#142;
         #120#58 = #18#138;
     |FINSI;

     |SI #120#59 = #17#5;  |Y #120#60 = #18#142;
         #120#60 = #18#138;
     |FINSI;

     |SI #120#61 = #17#5;  |Y #120#62 = #18#142;
         #120#62 = #18#138;
     |FINSI;

     #120#69 = #120#58 + #120#60 + #120#62 + #120#64 + #120#66 + #120#68;
     #120#71 = #120#69 - #120#70;
     #120#75 = #120#71 + #120#72 + #120#73 + #120#74;
     #120#78 = #120#76 + #120#77;
     #120#79 = #120#75 - #120#78;

     #120#80 = #120#56 + #120#79;
     #120#82 = #120#80 - #120#81;

     |GRABA 020#120a;
     |LIBERA #120;
|FPRC;

|PROCESO dsmom017;
     |SI #17#5 ! "7211"; |Y #17#5 ! "7213";  |Y #17#5 ! "7212";
      |Y #17#5 ! "722 "; |Y #17#5 ! "757 ";
          |ACABA;
     |FINSI;

     |SI #17#5 = "722 "; |Y #17#6 = 2;
          |ACABA;
     |FINSI;

     #18#0 = #17#0;
     #18#1 = #17#1;
     #18#2 = #17#2;
     #18#3 = #17#3;
     |LEE 040#18=;
     |SI FSalida ! 0;  |DDEFECTO #18;  |FINSI;

     #18#132 = #18#125 + #18#127 + #18#129 + #18#131;
     #18#133 = (#18#118 + #18#132) % 1;          || 1 % Cuota Devengada
     #18#135 = #18#133 + #18#134;                || Total Cuota Soportada

     #18#136 = #18#118 - #18#135;                || Resultado
     |SI #18#120 ! 0;
         #18#136 = #18#136 * #18#120;            || Resultado
     |FINSI;

     |SI #17#5 = "7211";  #18#122 = 1;   |FINSI;
     |SI #17#5 = "7213";  #18#122 = 1;   |FINSI;
     |SI #17#5 = "7212";  #18#122 = 10;  |FINSI;
     |SI #17#5 = "722 ";  #18#122 = 10;  |FINSI;
     |SI #17#5 = "757 ";  #18#122 = 10;  |FINSI;

     #18#137  = #18#118 % #18#122;               || Total Cuota Minima
     |SI #18#120 ! 0;
         #18#137 = #18#137 * #18#120;            || Total Cuota Minima
     |FINSI;
     #18#137  = #18#137 + #18#147;               || Total Cuota Minima

     #18#138  = #18#136;                         || Cuota derivada regiman general
     |SI #18#138 < #18#137;  #18#138 = #18#137;  |FINSI;

     |SI #18#138 = #18#142;  |ACABA;  |FINSI;

     #19#0  = #17#0;
     #19#1  = #17#1;
     #19#2  = 12;
     #19#3  = 310;
     #19#4  = 0;
     #19#5  = 0;
     |LEE 040#19=;
     |SI FSalida ! 0;
         |HAZ Modelo370;
     |SINO;
         |HAZ Modelo310;
     |FINSI;
|FPRC;

|DEFBUCLE dsmom017;
     #17#1;
     ;
     #0#0, 2002, 00, 01;
     #0#1, 2002, 99, 99;
     ;
     NULL, dsmom017;
|FIN;

|PROCESO AbreWord;
     aAlfa = "C:/MODELOS";                   |RMKDIR aAlfa;
     aAlfa = "C:/MODELOS/DOCUMENTOS";        |RMKDIR aAlfa;

     |DBASS aBase;
     aOrigen   = aBase + "basica/word/" + eaDocumento;
     aDestino  = "C:/MODELOS/DOCUMENTOS/" + eaDocumento;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     nWord  = 1;
     aAbre  = aDestino;

     |MENSA "      Abriendo el Documento, espere un Momento.";

     |WORD_ABRE nWord, aAbre;
     |WORD_PROPIEDADES nWord, "Visible", "NO";
|FPRC;

|PROCESO Asigna;
     FSalida = 0;
     |PARA; |SI FSalida = 0; |HACIENDO;
            |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;
     |SIGUE;
|FPRC;

|PROCESO NumeroDecimal;
     aAsigna   = nNume;
     aDecima   = "";
     aEntero   = "";
     aLong     = aAsigna % 0;
     nLong     = aLong;
     nDecimal = 0;
     |PARA nCaracter = 1;  |SI nCaracter [ nLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPos      = (100 * nCaracter) + 1;
           aCaracter = aAsigna % nPos;
           |SI aCaracter = ".";
               nDecimal = 1;
           |SINO;
               |SI nDecimal = 0;
                   aEntero = aEntero + aCaracter;
               |SINO;
                   aDecima = aDecima + aCaracter;
               |FINSI;
           |FINSI;
     |SIGUE;
     aDecima   = (aDecima + "00") % 102;
     aAsigna   = aEntero;

     aLong     = aAsigna % 0;
     nLong     = aLong;
     aAsigna   = "             " + aAsigna;
     aAsigna   = aAsigna % -113;
     aImpor1   = aAsigna % -103;
     aImpor2   = aAsigna % -403;
     aImpor3   = aAsigna % -703;
     aImpor4   = aAsigna % -1004;
     |SI nLong ] 10;
         |SI aImpor4 ! "  -";
             aAsigna = aImpor4 + "." + aImpor3  + "." + aImpor2 + "." + aImpor1;
         |SINO;
             aAsigna = aImpor4 + aImpor3  + "." + aImpor2 + "." + aImpor1;
      |FINSI;
    |SINO;
        |SI nLong ] 7;
            |SI aImpor3 ! "  -";
                aAsigna = aImpor3  + "." + aImpor2 + "." + aImpor1;
            |SINO;
                aAsigna = aImpor3 + aImpor2 + "." + aImpor1;
            |FINSI;
        |SINO;
            |SI nLong ] 4;
                |SI aImpor2 ! "  -";
                    aAsigna = aImpor2 + "." + aImpor1;
                |SINO;
                    aAsigna = aImpor2 + aImpor1;
                |FINSI;
            |SINO;
                aAsigna = aImpor1;
            |FINSI;
        |FINSI;
     |FINSI;

     |QBT aAsigna;

     |SI aDecima ! "00";
         aAsigna = ("                " + aAsigna + "," + aDecima) % -116;
     |SINO;
         aAsigna = ("             " + aAsigna) % -113;
     |FINSI;

     |SI aAsigna = "            0";     aAsigna = "";  |FINSI;
     |SI aAsigna = "            0,00";  aAsigna = "";  |FINSI;

     FSalida = 0;
     |PARA; |SI FSalida = 0; |HACIENDO;
            |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;
     |SIGUE;
|FPRC;

|PROCESO Fecha;
     aDia = #0#3 % 102;
     aEje = #0#3 % -104;
     aMes = #0#3 % 402;

     |SI aMes = "01";  aMes = "Enero";       |FINSI;
     |SI aMes = "02";  aMes = "Febrero";     |FINSI;
     |SI aMes = "03";  aMes = "Marzo";       |FINSI;
     |SI aMes = "04";  aMes = "Abril";       |FINSI;
     |SI aMes = "05";  aMes = "Mayo";        |FINSI;
     |SI aMes = "06";  aMes = "Junio";       |FINSI;
     |SI aMes = "07";  aMes = "Julio";       |FINSI;
     |SI aMes = "08";  aMes = "Agosto";      |FINSI;
     |SI aMes = "09";  aMes = "Septiembre";  |FINSI;
     |SI aMes = "10";  aMes = "Octubre";     |FINSI;
     |SI aMes = "11";  aMes = "Noviembre";   |FINSI;
     |SI aMes = "12";  aMes = "Diciembre";   |FINSI;
|FPRC;

|PROCESO Asignacion;
     |MENSA "      Asignado Campos al Documento, espere un Momento.";

     aAsigna = "En " + #0#4;  |QBF aAsigna;
     |SI aAsigna ! "";  aAsigna = aAsigna + ", ";  |FINSI;
     |HAZ Fecha;
     aAsigna = aAsigna + aDia + " de " + aMes + " de " + aEje;
     aIdenti = "!#FECHA#";
     |HAZ Asigna;

     aAsigna = #715#2;  |QBF aAsigna;
     aIdenti = "!#NOM#";
     |HAZ Asigna;

     |SI enSwDeDonde = 1;
         eaVarDni = #715#3;  |HAZ CalculameDNI;
         aAsigna  = eaVarDni;   |QBF aAsigna;
         aIdenti  = "!#NIF#";
         |HAZ Asigna;

         aAsigna  = #715#29;
         aIdenti  = "!#SG#";
         |HAZ Asigna;

         aAsigna  = #715#30;  |QBF aAsigna;
         aIdenti  = "!#DOMICILIO#";
         |HAZ Asigna;

         aAsigna = #715#31 % 104;  |QBF aAsigna;
         aIdenti  = "!#NUMERO#";
         |HAZ Asigna;

         aAsigna = #715#37;        |QBF aAsigna;
         aIdenti = "!#POBLACION#";
         |HAZ Asigna;

         aAsigna = #715#38;  |QBF aAsigna;
         aIdenti = "!#PROVINCIA#";
         |HAZ Asigna;
     |SINO;
         eaVarDni = #715#13;  |HAZ CalculameDNI;
         aAsigna  = eaVarDni;   |QBF aAsigna;
         aIdenti  = "!#NIF#";
         |HAZ Asigna;

         aAsigna  = #715#3;
         aIdenti  = "!#SG#";
         |HAZ Asigna;

         aAsigna  = #715#4;  |QBF aAsigna;
         aIdenti  = "!#DOMICILIO#";
         |HAZ Asigna;

         aAsigna = #715#5 % 104;  |QBF aAsigna;
         aIdenti  = "!#NUMERO#";
         |HAZ Asigna;

         aAsigna = #715#11;  |QBF aAsigna;
         aIdenti = "!#POBLACION#";
         |HAZ Asigna;

         aAsigna = #715#12;  |QBF aAsigna;
         aIdenti = "!#PROVINCIA#";
         |HAZ Asigna;
     |FINSI;

     enModelo = 310;  enForzar = 1;  |HAZ CogeDatosBancos;

     aAsigna = eaEntidad + " " + eaOficina + " " +  eaDC + " " + eaCuenta;
     aIdenti = "!#CUENTA#";
     |HAZ Asigna;

     nNume = enResultD;    aIdenti = "!#1#";   |HAZ NumeroDecimal;
     nNume = enResult;     aIdenti = "!#2#";   |HAZ NumeroDecimal;
     nNume = enResult - enResultD;
     |SI nNume < 0;  nNume = -nNume;  |FINSI;
                           aIdenti = "!#3#";   |HAZ NumeroDecimal;
|FPRC;

|PROCESO GuardaDocumento;
     |ABRE #54;
     #54#0  = #715#0;
     #54#1  = 9999;
     |LEE 040#54];
     |SI FSalida = 0;
         |LEE 040#54a;
     |SINO;
         |LEE 040#54u;
     |FINSI;
     |SI FSalida = 0;  |Y #54#0 = #715#0;
         nLinea = #54#1 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #54;
     |HORA aAlfa;
     aAlfa1 = aAlfa % 102;
     aAlfa2 = aAlfa % 402;

     #54#0  = #715#0;
     #54#1  = nLinea;
     #54#2  = eaNomDocumento;
     #54#3  = "DOC" + (("00000" + #54#0) % -105) + (("0000" + #54#1) % -104) + ".DOC";
     #54#4  = ~;
     #54#5  = aAlfa1;
     #54#6  = aAlfa2;
     #54#7  = ~;
     #54#8  = aAlfa1;
     #54#9  = aAlfa2;
     #54#10 = #0#6;
     #54#11 = "";
     #54#12 = "";
     |GRABA 020#54n;
     |LIBERA #54;
     |CIERRA #54;

     aOrigen  = "C:/MODELOS/DOCUMENTOS/" + eaDocumento;
     aDestino = eaRutaDocumento + "/" + "DOC" + (("00000" + #715#0) % -105) + (("0000" + nLinea) % -104) + ".DOC";
     |QBT aOrigen;
     |QBT aDestino;

     |RCOPIA_FICHERO aOrigen, aDestino;
     |SI FSalida ! 0;
         |MENAV "     No se ha podido copia el Documento al Cliente.";
     |FINSI;
|FPRC;

|PROCESO Cierre;
     |MENSA "      Imprimiendo el Documento, espere un Momento.";

     |SI #0#8 = "I";
         |WORD_IMPRIME nWord, "";
         |WORD_PROPIEDADES nWord, "Visible", "NO";

         |SLEEP 10;

         |MENSA "      Cerrando Documento";

         |WORD_SALVA nWord, "";
     |SINO;
         |WORD_PROPIEDADES nWord, "Visible", "SI";
         FSalida = "NO";
         |PARA;  |SI FSalida = "NO";  |HACIENDO;
                 |PULSATECLA;
                 |WORD_PROPIEDADES nWord, "Quit", "";
         |SIGUE;
     |FINSI;

     |SI #0#5 = "S";  |HAZ GuardaDocumento;  |FINSI;
|FPRC;

|PROCESO dsmod310Tempo;
     nSwHay = 1;

     enCodCli = #119#0;
     |HAZ LeePersona;

     #19#0 = #119#0;
     #19#1 = #119#1;
     #19#2 = #119#2;
     #19#3 = #119#3;
     #19#4 = #119#4;
     #19#5 = #119#5;
     |LEE 040#19=;
     |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;

     enResultD = #19#36;
     enResult  = #119#36;
     eaNombre  = #715#2;

     |SI #0#2 = "I";
         |PRINT;
     |FINSI;

     |SI #0#2 = "C";
         |HAZ AbreWord;
         |HAZ Asignacion;
         |HAZ Cierre;
         |RFBORRA aAbre;
     |FINSI;
|FPRC;

|DEFBUCLE dsmod310Tempo;
     #119#1006;
     ;
     00001, 2002, 12, 000, 00, 00;
     99999, 2002, 12, 999, 99, 99;
     ;
     NULL, dsmod310Tempo;
|FIN;

|PROCESO dsmod370Tempo;
     nSwHay = 1;

     enCodCli = #120#0;
     |HAZ LeePersona;

     #20#0 = #120#0;
     #20#1 = #120#1;
     #20#2 = #120#2;
     #20#3 = #120#3;
     #20#4 = #120#4;
     #20#5 = #120#5;
     |LEE 040#20=;
     |SI FSalida ! 0;  |DDEFECTO #20;  |FINSI;

     enResultD = #20#82;
     enResult  = #120#82;

     |SI #0#2 = "I";
         |PRINT;
     |FINSI;

     |SI #0#2 = "C";
         |HAZ AbreWord;
         |HAZ Asignacion;
         |HAZ Cierre;
         |RFBORRA aAbre;
     |FINSI;
|FPRC;

|DEFBUCLE dsmod370Tempo;
     #120#1006;
     ;
     00001, 2002, 12, 000, 00, 00;
     99999, 2002, 12, 999, 99, 99;
     ;
     NULL, dsmod370Tempo;
|FIN;

|PROCESO Informe;
     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |INFOR "dsmoy023";
     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     nSwHay   = 0;
     eaModelo = "310";
     |BUCLE dsmod310Tempo;
     |SI nSwHay = 1;  |PIEINF;  |FINSI;

     nSwHay   = 0;
     eaModelo = "370";
     |BUCLE dsmod370Tempo;
     |SI nSwHay = 1;  |PIEINF;  |FINSI;

     |FININF;
     |FINIMP;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;
     |DBASE aBase;  |QBT aBase;

     aMas = aBase + "def/dsmod310.mas";
     |CARGA_DEF aMas, dsmod310@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aMas = aBase + "def/dsmod370.mas";
     |CARGA_DEF aMas, dsmod370@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #dsmod310@;
         |ACABA;
     |FINSI;

     aFichero = ("19" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #119 aFichero;
     |ABRE #119;  |CIERRA #119;  |DELINDEX #119;

     aFichero = ("20" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #120 aFichero;
     |ABRE #120;  |CIERRA #120;  |DELINDEX #120;

     |ABRE #19;
     |ABRE #20;
     |ABRE #119;
     |ABRE #120;
     |ABRE #18;
     |BUCLE dsmom017;
     |CIERRA #18;
     |CIERRA #120;
     |CIERRA #119;

     |SI #0#2 = "I";  |HAZ Informe;  |FINSI;

     |SI #0#2 = "C";
         eaAplica    = "modelos";
         eaPrograma  = "dsmoy023";
         eaDocumento = "";
         |SUB_EJECUTA_NP ":basica/wordm000;SACA";
         |QBF eaDocumento;
         |SI eaDocumento = "";
             |MENAV "     No ha seleccionado un Documento.";
             |ACABA;
         |SINO;
             |BUCLE dsmod310Tempo;
             |BUCLE dsmod370Tempo;
         |FINSI;
     |FINSI;

     |CIERRA #19;
     |CIERRA #20;

     |DELINDEX #119;
     |DESCARGA_DEF #dsmod310@;
|FPRC;
