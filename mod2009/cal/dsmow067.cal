|FICHEROS;
     dsm39001 #1;
     dsmow067 #167,MANTE;
     :/basica/def/agicen14 #100;

     &regisnif@ #709;
|FIN;

|VARIABLES;
     nCampo1 = 0;
     nCampo2 = 0;
     nCampo3 = 0;

     aAlfa   = "";
|FIN;

|INCLUYE i_variar;

|PROCESO Tipo0C28Fw67;  |TIPO 0;
     |C_M #167#29, 1, "S";
     |C_M #167#30, 1, "S";
     |C_M #167#31, 1, "S";
     |C_M #167#32, 1, "S";

     |SI #167#28 = "N";
         #167#29 = 0;     |C_M #167#29, 1, "N";  |PINTA #167#29;
         #167#30 = "N";   |C_M #167#30, 1, "N";  |PINTA #167#30;
         #167#31 = "N";   |C_M #167#31, 1, "N";  |PINTA #167#31;
         #167#32 = "N";   |C_M #167#32, 1, "N";  |PINTA #167#32;
     |FINSI;
|FPRC;

|PROCESO Tipo0C31Fw67;  |TIPO 0;
     |C_M #167#33, 1, "S";

     |SI #167#31 = "N";
         #167#33 = "";    |C_M #167#33, 1, "N";  |PINTA #167#33;
     |FINSI;
|FPRC;

|PROCESO Actividad;
     nCampo1 = Campo + 1;
     nCampo2 = Campo + 2;
     nCampo3 = Campo + 3;
     |SI #167Campo = 0;
         #167nCampo1 = "";  |PINTA #167nCampo1;
         #167nCampo2 = "";  |PINTA #167nCampo2;
         #167nCampo3 = 0;   |PINTA #167nCampo3;
         |ACABA;
     |FINSI;

     |ABRE #100;
     #100#0 = #1#0;
     #100#1 = #167Campo;
     |LEE 040#100=;
     |SI FSalida ! 0;
         |MENAV "     No existe Actividad";
         |ERROR;
     |SINO;
         aAlfa = #100#6 % -104;
         |SI aAlfa ! "0000";
             aAlfa = "01.01." + #1#1;
             |SI #100#6 < aAlfa;
                 |MENAV "    La Actividad a finalizado en a¤os anteriores.";
                 #167Campo   = 0;   |PINTA #167Campo;
                 #167nCampo1 = "";  |PINTA #167nCampo1;
                 #167nCampo2 = "";  |PINTA #167nCampo2;
                 #167nCampo3 = 0;   |PINTA #167nCampo3;
                 |ACABA;
             |FINSI;
         |FINSI;

         |SI #100#7 = 1;
             |MENAV "    La Actividad tiene IVA Exento.";
             #167Campo   = 0;   |PINTA #167Campo;
             #167nCampo1 = "";  |PINTA #167nCampo1;
             #167nCampo2 = "";  |PINTA #167nCampo2;
             #167nCampo3 = 0;   |PINTA #167nCampo3;
             |ACABA;
         |FINSI;

         #167nCampo1 = #100#3;  |PINTA #167nCampo1;
         #167nCampo2 = #100#4;  |PINTA #167nCampo2;

         |SI #100#7  = 11;  |O #100#7 = 13;
             #167#25 = "X";
         |FINSI;

         |SI #100#16 = 1;  |O #100#16 = 2;
             #167nCampo3 = 1;  |PINTA #167nCampo3;
         |FINSI;

         |SI #100#16 = 4;  |O #100#16 = 5;
             #167nCampo3 = 2;  |PINTA #167nCampo3;
         |FINSI;

         |SI #100#3 = "8612";
             #167nCampo3 = 3;  |PINTA #167nCampo3;
         |FINSI;

         |SI #100#16 = 3;
             #167nCampo3 = 1;  |PINTA #167nCampo3;
         |FINSI;

         |SI #100#16 = 6;
             #167nCampo3 = 6;  |PINTA #167nCampo3;
         |FINSI;

         |SI #100#3 = "9999";  |Y #100#16 = 3;
             #167nCampo3 = 4;  |PINTA #167nCampo3;
         |FINSI;

         |SI #100#3 = "9999";  |Y #100#16 = 6;
             #167nCampo3 = 6;  |PINTA #167nCampo3;
         |FINSI;

         |SI #167nCampo3 = 0;  |O #167nCampo3 = 4;  |O #167nCampo3 = 5;
          |O #167nCampo3 = 6;
             #167nCampo1 = "";  |PINTA #167nCampo1;
         |FINSI;
     |FINSI;

     |CIERRA #100;
|FPRC;

|PROCESO LetraNif;  |TIPO 6;
     |SI FSalida = 10;
         eaVarDni  = #167Campo;
         enCalcCif = 1;
         |HAZ CalculameDNI;
         #167Campo = eaVarDni;
         |PINTA #167Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #167Campo;
     enCalcCif = 0;
     |HAZ CalculameDNI;
     eaVarDni = (eaVarDni + "             ") % 112;
     |SI #167Campo ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #167Campo = eaVarDni;  |PINTA #167Campo;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     eaCodNif  = #167Campo;
     |HAZ LeeNifs;

     #167#27 = #709#1;   |PINTA #167#27;
|FPRC;

|PROCESO Tipo12w067;  |TIPO 12;
|FPRC;
