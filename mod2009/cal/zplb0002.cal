|| Proceso de Actividad

|FICHEROS;
   :/basica/def/agicen14 #114;
   :/basica/def/agifigen #1000;
|FIN;

|VARIABLES;
|FIN;

|INCLUYE i_variar;
|INCLUYE i_varcon;  || Variables de Contabilidad

|| ************************ Actividades y Reparto
|RUTINA ActInf;
   #114#0 = enEmpresa;
   #114#1 = 01;
|FRUT;

|RUTINA ActSup;
   #114#0 = enEmpresa;
   #114#1 = 99;
|FRUT;

|PROCESO LActividad;
   eaNombreAct  = "";
   eswLect  = 0;
   efActIni = "01.01.0000";
   efActFin = "01.01.0000";

   |ABRE #114;
   |SI eOpDep = 1;
       |CONSULTA_F_CLAVE #1#114,ActInf,ActSup;
        enActividad = #114#1;
   |FINSI;
   |CIERRA #114;

  || Lee Actividad
  |ABRE #114;
  eaEsCom = "N";
  #114#0 = enEmpresa;
  #114#1 = enActividad;
  |LEE 041#114=;
  |SI FSalida ! 0;
      eswLect = 1;
      |CIERRA #114;
      |ACABA;
  |FINSI;
  |CIERRA #114;

  enActividad  = #114#1;
  eaNombreAct  = #114#4;
  enTipoIva    = #114#7;
  enTipoTribut = #114#9;
  enTipoSector = #114#11;
  efActIni     = #114#5;
  efActFin     = #114#6;
  eaEsCom      = #114#14;
|FPRC;

|PROCESO LeeMayorAct;
  enMayorAct = 0;
  |ABRE #114;
  #114#0 = enEmpresa;
  #114#1 = 99;
  |LEE 041#114];
  |SI FSalida = 0;
      |LEE 040#114a;
  |SINO;
      |LEE 040#114u;
  |FINSI;
  |SI FSalida = 0; |Y #114#0 = enEmpresa;
      enMayorAct = #114#1;
  |FINSI;
  |CIERRA #114;
|FPRC;

|PROCESO eComprobarCom;
 aCoBien    = "N";
 |ABRE #114;
 #114#0 = enEmpresa;
 #114#1 = 00;
 |LEE 041#114];
 |SI FSalida = 0; |Y #114#0 = enEmpresa;
     aCoBien = #114#13;  ||Comunidad de Bienes
 |FINSI;
 |CIERRA #114;
|FPRC;
