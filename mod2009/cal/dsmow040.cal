|FICHEROS;
     dsmoz040 #0;
     dsmom040 #40;
     dsmow040 #999,MANTE;

     :/basica/def/agicen14 #114;
     :/basica/def/agifigen #1000;
|FIN;

|VARIABLES;
 &errconta = 0;
 &esalta = 0;
 alfa1 = "";
 nume1 = 0;
 nInkey = 0;
 &enEmpreOri = 0;
 &enEmpreDes = 0;
 &swUno      = 0;
|FIN;

|INCLUYE i_variar;
|INCLUYE i_varcon;

|CALCULO LeelaEmpresa; |TIPO 0;

   errconta = 0;
   enEmpresa = #999#0;
   |SI eaAnNiv = "E";
       |HAZ Analitica;
   |FINSI;
  || Lee Empresa
    |ABRE #1000;
    #1000#0 = enEmpresa;
    |LEE 040#1000=;
    |SI FSalida ! 0;
        |MENAV "      Empresa Inexistente";
        errconta = 1;
        |CIERRA #1000;
        |ERROR;
        |ACABA;
    |SINO;
        |SI #1000#23 = "N";
            errconta = 1;
            |MENAV "     Empresa Sin Contabilidad";
        |FINSI;
    |FINSI;
    #dsmow040#1 = #1000#1; |PINTA #dsmow040#1;
    |CIERRA #1000;

    |SALVA_DATOS #dsmow040;
    |LEE 010#dsmow040.=;
    |SI FSalida ! 0;
        |REPON_DATOS #dsmow040;
        |GRABA 000#dsmow040.b;
        |ERROR;
        |PTEC 824;
    |SINO;
        |REPON_DATOS #dsmow040;
    |FINSI;
|FCAL;

|PROCESO BorraGrupo;
 |BORRA 020#dsmom040.a;
 |LIBERA #dsmom040;
|FPRC;

|DEFBUCLE borrarGrupos;
 #dsmom040#1;
 ;
 #999#0,0000;
 #999#0,9999;
 be;
 NULL, BorraGrupo;
|FIN;

|PROCESO Tipo1; |TIPO 1;
 esalta = (FEntrada / 100) ! 0;
 |SI esalta = 2;
    |ERROR;
    |PTEC 824;
 |FINSI;
 |SI esalta = 3;
     |CONFI "    NEsta Seguro de Borrar todos los Grupos de Amortizacion de esta Empresa";
     |SI FSalida ! 0;
         |ERROR;
     |SINO;
         |BUCLE borrarGrupos;
     |FINSI;
 |FINSI;
|FPRC;

|PROCESO leeGrupo;
 nume1 = 1;
 |ERROR10;
|FPRC;

|DEFBUCLE LeeGrupos;
 #dsmom040#1;
 ;
 #999#0,0000;
 #999#0,9999;
 ;
 NULL, leeGrupo;
|FIN;

|PROCESO ComprueboLinea;
 #999#0 = enEmpresa;
 |LEE 040#dsmow040.=;
 nume1 = 0;
 |BUCLE LeeGrupos;
 |SI nume1 = 0;
     |BORRA 040#dsmow040.c;
    || |PTEC 808;
 |FINSI;
 |LIBERA #dsmow040;
|FPRC;

|| **********************************************************************
|RUTINA ClaveBaja40;
     #40#0 = #999#0;
     #40#2 = 0001;
|FRUT;

|RUTINA ClaveAlta40;
     #40#0 = #999#0;
     #40#2 = 9999;
|FRUT;

|PROCESO Tipo7;  |TIPO 7;
    |SI eaAnNiv = "E";
        enEmpresa = #dsmow040#0;
        |HAZ Analitica;
     |FINSI;
     |PINTA  #dsmow040#0; |PINTA  #dsmow040#1;
     enModo = 7;
     |SI enSwAna = 1;
         |C_V #dsmom040#09,1,"S";
         |ATRI P; |PINTA 0934, "Cuenta Analitica: "; |ATRI 0;
     |SINO;
         |C_V #dsmom040#09,1,"N";
                  |PINTA 0934, "                           ";
     |FINSI;
     |ENTLINEAL #1#40, -2, 7, 22, 0, ClaveBaja40, ClaveAlta40;
|FPRC;

|PROCESO Tipo11;  |TIPO 11;
   nInkey = FSalida;

   |SI nInkey = 11;         || F3
       |ERROR;
       eaElProm = "dsmow040";
       |HAZ ConsuCliente;
       #0#0 = #999#0;
       eaElProm = "";
       |PTEC 802;
       |ACABA;
   |FINSI;

   |SI nInkey =  10;         || F2
         errconta = 0;
         enModo = 2;
         enEmpresa   = #999#0;
         enPerConta  = -1;
         enActividad = #999#1;
         |SI enSwAna = 1;
             |C_V #dsmom040#09,1,"S";
             |ATRI P; |PINTA 0934, "Cuenta Analitica: "; |ATRI 0;
         |SINO;
             |C_V #dsmom040#09,1,"N";
                  |PINTA 0934, "                           ";
         |FINSI;
         |ENTLINEAL #1#40, -2, 2, 22, 0, ClaveBaja40, ClaveAlta40;
         |HAZ ComprueboLinea;
   |FINSI;
   |SI nInkey =  12;  || F4
       |ERROR;
       swUno      = 1;
       enEmpreOri = 99999;
       enEmpreDes = #999#0;
       |SUB_EJECUTA_NP ":modelos/dsmoz049";
       #999#0 = enEmpreDes;
   |FINSI;

   |SI nInkey = 13; || F5;
       |ERROR;
       |CONFI "    NDesea Calcular el Plan Contables 2008 de esta Empresa";
       |SI FSalida = 0;
            swUno      = 1;
            enEmpreOri = #999#0;
            enEmpreDes = #999#0;
            |SUB_EJECUTA_NP ":modelos/dsmoz061";
            #999#0 = enEmpreDes;
            |ENTLINEAL #1#40, -2, 7, 22, 0, ClaveBaja40, ClaveAlta40;
       |FINSI;
   |FINSI;
   |SI nInkey = 14; || F6;
       |ERROR;
       |CONFI "    NDesea Calcular el Plan Contable 2008 de las Empresas";
       |SI FSalida = 0;
            swUno      = 1;
            enEmpreOri = 1;
            enEmpreDes = 99999;
            |SUB_EJECUTA_NP ":modelos/dsmoz061";
            |ENTLINEAL #1#40, -2, 7, 22, 0, ClaveBaja40, ClaveAlta40;
       |FINSI;
   |FINSI;
|FPRC;
