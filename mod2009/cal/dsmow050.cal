|| ... este programa ya no sirve
|FICHEROS;
     dsmow050 #0;
     dsmom041 #2;
     dsmom042 #3;
|FIN;

|VARIABLES;
     aAlfa1        = "";
     XPara         = 0;
     Fecha         = @;
     aTempo        = "";
     aTempoF       = "";
     aAlfa         = "";
     FEstado       = 0;
     nSwExiste     = 0;

     nCampos       = 0;
     fFecha        = @;
     nAnyo         = 0;

     &nAmordef   = 0;
     &nAmorpro   = 0;

     &nAmort       = 0;
     &nVAnyo       = 0;
     &nCAnyo       = 0;
     &nPendiente   = 0;
     &nTCompra     = 0;
     &nPorceA      = 0;
     &nPorceD      = 0;
     &nImport      = 0;
     &nTipoMod     = 0;

     &fFechaUso    = @;
     &fFechaCompra = @;
     &fFechaVenta  = @;
     &fPriCompra   = @;
     &fFinCompra   = @;
     &fPriVenta    = @;
     &fFinVenta    = @;

     &eaIniActi    = "";
     &efFecActi    = @;

     &Modo          = 0;
     &enEmpresa     = 0;
     &enActividad   = 0;
     &enEjer        = 0;
     &enTeclaF      = 0;
     &enRdtos       = 0;
     {18}&epTAmorc   = 0;
|FIN;

|INCLUYE i_varcon;

|PROCESO MiraCabe;
     |DDEFECTO #0;
     #0#0  = #2#2 + " " + #2#4;
     #0#1  = #2#27;
     #0#2  = #2#10;
     #0#11 = #2#28;
     |SI #0#11 = 0;
         #0#3 = #2#21;
         |SI #0#3 = 0;  #0#3 = #2#22;  |FINSI;
         #0#4 = 0;
         #0#6 = 0;
         #0#7 = 0;
         #0#8 = 0;
     |SINO;
         #0#4 = #2#21;
         #0#6 = #2#29;
         #0#8 = #2#30;
         #0#7 = #2#22;
     |FINSI;

     |SI enRdtos = 1;
         #2#14 = #2#29;
         #2#20 = #2#29;
     |SINO;
         #2#14 = #2#30;
         #2#20 = #2#30;
     |FINSI;

     eaElemento  = #dsmom041#2;
     enElemeNum  = #dsmom041#3;
     nAnyAmor    = enEjer;
|| .............................Miralo Manolo - Carol
     aAlfa1 = enEjer; |QBF aAlfa1;
     aAlfa1 = "31.12." + aAlfa1;
     fFechaAmor  = aAlfa1;
     |HAZ CalAmorModulo;
     #0#9  = nAmorpro;
     #0#10 = nAmordef;

/*
     fFechaAmor  = ~;
     nConcpAmor  = 0;
     aConcpAmor  = "";
     |HAZ CalculaAmor;
     #0#9  = enImpAmor;
     |SI #2#28 = 0;  #0#9 = 0;  |FINSI;
     #0#10 = #3#5;
*/

     |GRABA 140#0n;
     |LIBERA #0;
     nSwExiste = 1;
|FPRC;

|DEFBUCLE dsmom041;
     #2#1;
     1;
     enEmpresa, "        ", 00, enActividad;
     enEmpresa, "zzzzzzzz", 99, enActividad;
     ;
     NULL, MiraCabe;
|FIN;

|PROCESO CargaEste;
     |ABRE #0;
     |ABRE #3;
     |BUCLE dsmom041;
     |CIERRA #0;
     |CIERRA #3;
|FPRC;

|RUTINA ClaveBaja;
  #0#0 = "                                        ";
|FRUT;

|RUTINA ClaveAlta;
  #0#0 = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
|FRUT;

|PROCESO CogeValores;
  |SI #0#11 = 1;
      |SI #0#1 [ Fecha;
          IepTAmorc = epTAmorc1 <-;   epTAmorc = epTAmorc + #0#2;
          IepTAmorc = epTAmorc2 <-;   epTAmorc = epTAmorc + #0#9;
      |FINSI;
      IepTAmorc = epTAmorc10 <-;   epTAmorc = epTAmorc + #0#2;
      IepTAmorc = epTAmorc11 <-;   epTAmorc = epTAmorc + #0#10;
  |FINSI;

  |SI #0#11 = 2;
      |SI #0#1 [ Fecha;
          IepTAmorc = epTAmorc3 <-;   epTAmorc = epTAmorc + #0#2;
          IepTAmorc = epTAmorc4 <-;   epTAmorc = epTAmorc + #0#9;
      |FINSI;
      IepTAmorc = epTAmorc12 <-;   epTAmorc = epTAmorc + #0#2;
      IepTAmorc = epTAmorc13 <-;   epTAmorc = epTAmorc + #0#10;
  |FINSI;

  |SI #0#11 = 3;
      |SI #0#1 [ Fecha;
          IepTAmorc = epTAmorc5 <-;   epTAmorc = epTAmorc + #0#2;
          IepTAmorc = epTAmorc6 <-;   epTAmorc = epTAmorc + #0#9;
      |FINSI;
      IepTAmorc = epTAmorc14 <-;   epTAmorc = epTAmorc + #0#2;
      IepTAmorc = epTAmorc15 <-;   epTAmorc = epTAmorc + #0#10;
  |FINSI;

  |SI #0#11 = 4;
      |SI #0#1 [ Fecha;
          IepTAmorc = epTAmorc7 <-;   epTAmorc = epTAmorc + #0#2;
          IepTAmorc = epTAmorc8 <-;   epTAmorc = epTAmorc + #0#9;
      |FINSI;
      IepTAmorc = epTAmorc16 <-;   epTAmorc = epTAmorc + #0#2;
      IepTAmorc = epTAmorc17 <-;   epTAmorc = epTAmorc + #0#10;
  |FINSI;

  |SI #0#11 = 0;
      |SI eaIniActi = "P";
          IepTAmorc = epTAmorc18 <-;   epTAmorc = epTAmorc + #0#3;
      |FINSI;

      IepTAmorc = epTAmorc9  <-;   epTAmorc = epTAmorc + #0#10;
  |FINSI;
|FPRC;

|DEFBUCLE eosw0064;
  #0#1;
  ;
  "                                        ";
  "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
  ;
  NULL, CogeValores;
|FIN;

|PROGRAMA;
     aAlfa = "";
     aTempo = "";
     |DFICE aAlfa;
     |TEMPO aTempo;
     aTempoF = aTempo - aAlfa;
     |NOME_DAT #0 aTempoF;
     |FBORRA aTempo;

     |ABRE #0;  |CIERRA #0;  |DELINDEX #0;

     nSwExiste = 0;
     |HAZ CargaEste;

     |SI enTeclaF = 10;
          |SI nSwExiste ! 0;
              |ENTLINEAL #1#0, -1, 4, 22, 1, ClaveBaja, ClaveAlta;
          |FINSI;
     |FINSI;

/*
     |SI enTeclaF = 11;
         |SUB_EJECUTA "reoz0001";
     |FINSI;

     IepTAmorc = epTAmorc1 <-;
     |PARA XPara = 1;  |SI XPara [ 18;  |HACIENDO XPara = XPara + 1;
           epTAmorc = 0;
           IepTAmorc = IepTAmorc + 1;
     |SIGUE;

     |ABRE #0;  |CIERRA #0;  |DELINDEX #0;
     |HAZ CargaEste;

     |SI MAnyo [ 80;
         aAlfa = "01.01.20" + (("00" + MAnyo) % -102);
     |SINO;
         aAlfa = "01.01.19" + (("00" + MAnyo) % -102);
     |FINSI;

     Fecha = aAlfa;
     |SI eaIniActi = "S";  Fecha = efFecActi;     |FINSI;
     |SI eaIniActi = "P";  Fecha = "31.12.2999";  |FINSI;

     |BUCLE eosw0064;

     |ABRE #0;  |CIERRA #0;  |DELINDEX #0;
*/

|FPRO;
