|FICHEROS;
 dsmom109 #109;
 dsmom107 #107;

 dsmom007 #7;
|FIN;

|VARIABLES;
  nInkey  = 0;
  fFecha  = @;
  aAlfa1  = "";
  nEjer   = 0;
  nCampo  = 0;
  nCampo1 = 0;
  nCampo2 = 0;

  nNume1  = 0;
  nPara1  = 0;
  nPara2  = 0;
  aAlfaCom = "";
|FIN;

|INCLUYE i_variar;

|PROCESO ClBaja7;
 #7#0 = 1;
 #7#1 = 1;
|FPRC;

|PROCESO ClAlta7;
 #7#0 = 3;
 #7#1 = 99;
|FPRC;

|PROCESO Consulto;
     |ABRE #7;
     |CONSULTA_F_CLAVE #1#7,ClBaja7,ClAlta7;
     |CIERRA #7;
     #109nCampo  = #7#0; |PINTA #109nCampo;
     #109nCampo1 = #7#1; |PINTA #109nCampo1;
|FPRC;

|PROCESO LeeLaCarga; |TIPO 0;
 nInkey = FSalida;
 |C_M #109Campo,0,aAlfa1;
 |SI aAlfa1 = "N"; |ACABA; |FINSI;

 nCampo  = Campo;
 nCampo1 = Campo + 1;
 nCampo2 = nCampo + ( 20 - (nCampo - 6) / 2);
 |SI nInkey = 10;
     |HAZ Consulto;
 |FINSI;

 nNume1 = 24; |SI Campo [ 14; nNume1 = 14; |FINSI;
 |SI #109Campo = 0;
      |PARA nPara1 = Campo + 1; |SI nPara1 [ nNume1; |HACIENDO nPara1 = nPara1 + 1;
            nPara2 = nPara1 + 1;
            nCampo2 = nPara1 + ( 20 - (nPara1 - 6) / 2);
            |C_M #109nPara1,1,"N"; #109nPara1 = 0; |PINTA #109nPara1;
            |C_M #109nPara2,1,"N"; #109nPara2 = 0; |PINTA #109nPara2;
            #109nCampo2 = ""; |PINTA #109nCampo2;
      |SIGUE;
      |ACABA;
 |SINO;
      |PARA nPara1 = Campo + 1; |SI nPara1 [ nNume1; |HACIENDO nPara1 = nPara1 + 1;
            nPara2 = nPara1 + 1;
            |C_M #109nPara1,1,"S";
            |C_M #109nPara2,1,"S";
      |SIGUE;
 |FINSI;


 |SI #109Campo ! 1; |Y #109Campo ! 3;
     |MENAV "    Introduzca una Agrupacion de Ventas (1 o 3) ";
     |ERROR;
 |FINSI;
|FPRC;

|PROCESO LeeLaCarga2;
 nInkey = FSalida;

 |C_M #109Campo,0,aAlfa1;
 |SI aAlfa1 = "N"; |ACABA; |FINSI;

 nCampo  = Campo - 1;
 nCampo1 = Campo;
 nCampo2 = nCampo + ( 20 - (nCampo - 6) / 2);
 |SI nInkey = 10;
     |HAZ Consulto;
 |FINSI;

 |SI #109nCampo = 1; aAlfa1 = "BI. y C."; |FINSI;
 |SI #109nCampo = 3; aAlfa1 = "V.OP. "; |FINSI;

 |ABRE #7;
 #7#0 = #109nCampo;
 #7#1 = #109nCampo1;
 |LEE 001#7=;
 |SI FSalida ! 0;
     |CIERRA #7;
     |MENAV "    Error no Existe Agrupacion de IVA ";
     |ERROR;
     |ACABA;
 |FINSI;
 |CIERRA #7;
 #109nCampo2 = aAlfa1 + #7#2; |PINTA #109nCampo2;
|FPRC;


|PROCESO Baja109;
 |SI FSalida = "POSICION";
     #109#0 = nEjer;
 |SINO;
     #109#0 = 2000;
 |FINSI;
|FPRC;

|PROCESO Alta109;
     #109#0 = 2999;
|FPRC;

|PROGRAMA;
     |ABRE #107;
     |LEE 040#107p;
     |SI FSalida ! 0;  |DDEFECTO #107;  |FINSI;
     |CIERRA #107;

     aAlfaCom = #107#12;

     |SI #107#9 = "N";
         |MENAV "    EN CONTROL ESTA INFORMADO NO CALCULAR PRORRATA.";
         |ACABA;
     |FINSI;

     fFecha = ~;
     aAlfa1 = fFecha;
     aAlfa1 = aAlfa1 % -104;
     nEjer  = aAlfa1;

     |ABRE #109
     |LEE 101#109p;
     |SI FSalida ! 0;
         |DDEFECTO #109;
         #109#0 = nEjer;
         #109#1 = aAlfaCom;
         #109#26 = "BI.y C. Regimen Ordinario.";
         #109#31 = "V.OP. Otras Operaciones exentas con derecho a deduccion";
         #109#32 = "V.OP. Operaciones exentas sin derecho a deduccion";
         |GRABA 020#109b;
     |FINSI;
     |LIBERA #109;
     |CIERRA #109;



     |CLS;
     |CABEZA "Control de Prorratas";

     |PINPA #0#109;
     |ENTLINEAL #1#109, -1, 2, 22, 0, Baja109, Alta109;

|FPRO;
