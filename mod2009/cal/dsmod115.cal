|FICHEROS;
     dsmod115 #0;
     dsm180li #180;
     dsmom004 #4;
     dsmod115@ #900;
|FIN;

|VARIABLES;
     aBase      = "";
     aDef       = "";
     aAlfa      = "";
|FIN;

|INCLUYE i_variar;

|PROCESO Justificante;  |TIPO 7;
     |SI #0#11 = "             ";  |Y #0#4 ! 0;
         |ABRE #4;
         #4#0 = #0#0;
         #4#1 = #0#1;
         #4#2 = #0#2;
         #4#3 = #0#3;
         #4#4 = #0#4 - 1;
         |LEE 000#4=;
         |SI FSalida ! 0;  |DDEFECTO #4;  |FINSI;
         |CIERRA #4;

         #0#11 = #4#19;  |PINTA #0#11;
     |FINSI;

     |C_M #0#11, 1, "N";
     |SI #0#4 ! 0;
         |C_M #0#11, 1, "S";
     |FINSI;
|FPRC;

|PROCESO Totales;
     #0#10 = #0#8 - #0#9;

     |PINTA #0#10;
|FPRC;

|PROCESO dsm180li;
     #0#6 = #0#6 + 1;
     #0#7 = #0#7 + #180#11;
     #0#8 = #0#8 + #180#13;
|FPRC;

|DEFBUCLE dsm180li;
     #180#1;
     ;
     #0#0, #0#1, 99, 180, 00, 0, "            ", 1, 0000;
     #0#0, #0#1, 99, 180, 00, 0, "zzzzzzzzzzzz", 2, 9999;
     ;
     NULL, dsm180li;
|FIN;

|PROCESO dsmod115;
     #0#7  = #0#7  - #900#7;
     #0#8  = #0#8  - #900#8;
|FPRC;

|DEFBUCLE dsmod115;
     #900#1006;
     ;
     #0#0, #0#1, 01, 115, 00, 00;
     #0#0, #0#1, 11, 115, 99, 99;
     ;
     NULL, dsmod115;
|FIN;

|PROCESO SacaPantallas115;
     enEntrada = 1;
     |PUSHV 0401 2380;

     |ABRE #0;
     #0#0 = enEmpresa;
     #0#1 = enEjer;
     #0#2 = enPeriodo;
     #0#3 = enModelo;
     #0#4 = enComplem;
     #0#5 = enActividad;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = enEmpresa;
         #0#1 = enEjer;
         #0#2 = enPeriodo;
         #0#3 = enModelo;
         #0#4 = enComplem;
         #0#5 = enActividad;
         |GRABA 020#0b;
     |FINSI;

     |SI enPeriodo = 12;
         |CONFI "0000NDesea Regularizacion de los Periodos Anteriores con el Modelo 180.";
         |SI FSalida = 0;
             |PDEFECTO #0, 6, 11;
             |BUCLE dsm180li;

             |DBASE aBase;  |QBT aBase;
             aDef = aBase + "def/dsmod115.mas";
             |CARGA_DEF aDef, dsmod115@;
             |SI FSalida ! 0;
                 aAlfa = "     Error en cargar el Def dsmod115";
                 |MENAV aAlfa;
             |SINO;
                 |BUCLE dsmod115;
             |FINSI;
             |DESCARGA_DEF #dsmod115@;
         |FINSI;
     |FINSI;

     |PINPA #0#0;
     |PINDA #0#0;

     |ENDATOS #2#0;
     |SI FSalida = 0; |Y #0#10 ! 0;
         |GRABA 020#0a;
     |SINO;
        |CONFI "0000NEl Importe es igual a Cero, desea Impreso SIN Actividad ";
        |SI FSalida = 0;
            |GRABA 020#0a;
        |SINO;
            enEntrada = 0;
            |BORRA 020#0a;
        |FINSI;
     |FINSI;

     |LIBERA #0;
     |CIERRA #0;
     |POPV;
|FPRC;

|PROGRAMA;
     eaNomDef  = "dsmod115";

|| \\\\\\ Consulta del Modelo ////////

     |SI enTipoEntrada = 4;              || Consulta del Modelo
         |CABEZA "Modelo 115";
         |SI enComplem = 0;
              |HAZ SacaPantallas;
         |SINO;
             |ABRE #0;
             #0#0 = enEmpresa;
             #0#1 = enEjer;
             #0#2 = enPeriodo;
             #0#3 = enModelo;
             #0#4 = enComplem;
             #0#5 = enActividad;
             |LEE 101#0=;
             |SI FSalida ! 0;  |ACABA;  |FINSI;
             |PINPA #0#0;
             |PINDA #0#0;
             |ENDATOS #1#0;
             |SI FSalida = 0;
                 |GRABA 020#0a;
             |FINSI;
             |LIBERA #0;
             |CIERRA #0;
         |FINSI;
         |ACABA;
     |FINSI;

     |SI enTipoEntrada = 1;              || Alta del Modelo
          |CABEZA "Modelo 115";
          |HAZ SacaPantallas115;
          enResultado = #0#10;
          |ACABA;
     |FINSI;

|| \\\\\\ Comprobacion Existencia del Modelo

     |SI enTipoEntrada = 99;              || Existencia del Modelo ????
         |ABRE #0;
         #0#0 = enEmpresa;
         #0#1 = enEjer;
         #0#2 = enPeriodo;
         #0#3 = enModelo;
         #0#4 = enComplem;
         #0#5 = enActividad;
         |LEE 040#0=;
         |SI FSalida ! 0;  enExistencia = 1;  |DDEFECTO #0; |FINSI;
         |CIERRA #0;

         |SI enActividad = 0;  enResultado = #0#10;  |FINSI;
     |FINSI;
|FPRO;
