|FICHEROS;
     dsmoy072 #0;

     :/contasoc/def/isacceso #200;
     :/contasoc/def/isocie29 #202;
     :/contasoc/def/isocie59 #259;
     :/contasoc/def/isocie91 #291;

     &clientes@ #715;
|FIN;

|VARIABLES;
     nBanco    = 0;
     nLinea    = 0;
     nChequeo  = 0;
     nMes      = 0;
     nAnyo     = 0;
     nImpor    = 0;
     nAnyoAnt  = 0;

     aFichero  = "";
     aAlfa     = "";
     aPathSoc  = "";

     fFecha    = @;
|FIN;

|INCLUYE i_variar;

|PROCESO isacceso;
     |SI #200#5 = "225";
         #291#0 = #200#0;
         #291#1 = #200#1;
         |LEE 000#291=;
         |SI FSalida ! 0;  |DDEFECTO  #291;  |FINSI;

         |SI #291#103 [ 0;  |ACABA;  |FINSI;

         #0#9 = #291#103;
     |SINO;
         #259#0 = #200#0;
         #259#1 = #200#1;
         |LEE 000#259=;
         |SI FSalida ! 0;  |DDEFECTO  #259;  |FINSI;

         |SI #259#83 [ 0;  |ACABA;  |FINSI;

         #0#9 = #259#83;
     |FINSI;

     #0#3  = #200#0;

     enCodCli = #200#0;
     |HAZ LeePersona;
     |SI enSwDeDonde = 1;
         #0#4  = #715#3;
         #0#5  = #715#1;
         #0#6  = #715#5;
         #0#7  = #715#6;
         #0#8  = #715#7;
     |SINO;
         #0#4  = #715#13;
         #0#5  = #715#1;
         #0#6  = "";
         #0#7  = #715#93;
         #0#8  = #715#94;
     |FINSI;

     #202#0 = #200#0;
     #202#1 = #0#2;
     |LEE 000#202=;
     |SI FSalida ! 0;
         #0#11 = "SIN ELABORAR";
     |SINO;
         |SI #0#0 = 1;
             fFecha = #202#9;
             |SI fFecha [ "01.01.1900";
                 #0#11 = "SIN IMPRIMIR";
             |SINO;
                 #0#11 = "IMPRESO";
             |FINSI;

             #0#10 = #202#6 + #202#24;
         |FINSI;

         |SI #0#0 = 2;
             fFecha = #202#10;
             |SI fFecha [ "01.01.1900";
                 #0#11 = "SIN IMPRIMIR";
             |SINO;
                 #0#11 = "IMPRESO";
             |FINSI;

             #0#10 = #202#7 + #202#25;
         |FINSI;

         |SI #0#0 = 3;
             fFecha = #202#11;
             |SI fFecha [ "01.01.1900";
                 #0#11 = "SIN IMPRIMIR";
             |SINO;
                 #0#11 = "IMPRESO";
             |FINSI;

             #0#10 = #202#8 + #202#26;
         |FINSI;
     |FINSI;

     |SI #0#10 = 0;  #0#11 = "SIN ELABORAR";  |FINSI;

     |PRINT;
|FPRC;

|DEFBUCLE isacceso;
     #200#1;
     ;
     nAnyoAnt, 00001;
     nAnyoAnt, 99999;
     ;
     NULL, isacceso;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |INFOR "dsmoy072";
     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     |DBASS aPathSoc;  |QBF aPathSoc;
     aPathSoc = aPathSoc + "contasoc/fich/";

     |PATH_DAT #200 aPathSoc;
     |PATH_DAT #202 aPathSoc;
     |PATH_DAT #259 aPathSoc;
     |PATH_DAT #291 aPathSoc;

     nAnyoAnt = #0#2 - 1;

     |ABRE #202;
     |ABRE #259;
     |ABRE #291;
     |BUCLE isacceso;
     |CIERRA #202;
     |CIERRA #259;
     |CIERRA #291;

     |PIEINF;
     |FININF;
     |FINIMP;
|FPRC;

|PROCESO Periodo;
     |SI #0#0 = 1;   #0#1 = "1 - PAGO  ";  |FINSI;
     |SI #0#0 = 2;   #0#1 = "2 - PAGO  ";  |FINSI;
     |SI #0#0 = 3;   #0#1 = "3 - PAGO  ";  |FINSI;

     fFecha = ~;
     aAlfa  = fFecha % -104;
     #0#2   = aAlfa;

     |PINTA #0#0;
     |PINTA #0#1;
     |PINTA #0#2;
|FPRC;
