|FICHEROS;
  dsmom060 #0,MANTE;
  dsmom061 #1,MANTE;

  dsmom61@ #61;
|FIN;

|VARIABLES;
  inkey     = 0;
  esalta    = 0;
  esaltaL   = 0;
  nSwSal    = 0;

  aAlfa1    = "";
  aAlfa2    = "";
  aAlfa3    = "";
  nNume1    = 0;
  nNume2    = 0;
  nNume3    = 0;
  swError   = 0;
|FIN;

|INCLUYE i_variar;
|INCLUYE i_varcon;

**************************************************************************
|CALCULO Lacolumna; |TIPO 7;
 |C_M #0#4,0,aAlfa1;
 |SI aAlfa1 = "N"; |ACABA; |FINSI;

 aAlfa1 = #0#4; |QBF aAlfa1;
 |SI aAlfa1 = "";
     #0#4 = #0#3; |PINTA #0#4;
 |FINSI;
|FCAL;

|RUTINA ClaveBajaL;
     #1#6  = #0#6;
     #1#0  = #0#0;
     #1#1  = #0#1;
     #1#2  = #0#2;
     #1#3  = 001;
|FRUT;

|RUTINA ClaveAltaL;
     #1#6  = #0#6;
     #1#0  = #0#0;
     #1#1  = #0#1;
     #1#2  = #0#2;
     #1#3  = 999;
|FRUT;

|PROCESO BorraLineas;
     |BORRA 140#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE dsmom061;
     #1#1;
     ;
     #0#6, #0#0, #0#1, #0#2, 001;
     #0#6, #0#0, #0#1, #0#2, 999;
     be;
     NULL, BorraLineas;
|FIN;

|CALCULO Tipo2_1;  |TIPO 2;
     esalta  = (FEntrada / 100) ! 0;
     |SI esalta ! 3;  |ACABA;  |FINSI;
     |BUCLE dsmom061;
|FCAL;

||************************************************************************

|CALCULO elTipo3; |TIPO 3;
    esalta  = (FEntrada / 100) ! 0;
    nSwSal = 0;
    |ENTLINEAL #1#1, -5, 2, 21, 0, ClaveBajaL, ClaveAltaL;
|FCAL;

|CALCULO PresentaLinea;  |TIPO 7;
    nSwSal = 1;
    |ENTLINEAL #1#1, -5, 7, 21, 0, ClaveBajaL, ClaveAltaL;
|FCAL;

|| ************************************************************************
|CALCULO SalgoYa;  |TIPO 7;
     |SI nSwSal = 1;  |PTEC 807;  |FINSI;
|FCAL;

|PROCESO VerEspejo0;
  |SI #1#4 = #61#4;
      |SI #1#0 = #61#0; |Y #1#1 = #61#1; |Y #1#2 = #61#2; |Y #1#3 = #61#3;  |Y #1#6 = #61#6;
          || ... Es la misma linea
      |SINO;
          swError = 1;
          |ERROR10;
      |FINSI;
  |FINSI;
|FPRC;

|DEFBUCLE VerEspejo;
  #dsmom61@#1005;
  ;
  #0#6, #0#0, #0#1, #0#2, 001;
  #0#6, #0#0, #0#1, #0#2, 999;
  be;
  NULL, VerEspejo0;
|FIN;

|CALCULO cuenta_L; |TIPO 0;

   aAlfa1  = #1#4; |QBF aAlfa1;
   |SI aAlfa1 = "";
       |MENAV "    Error. Introcuzca Cuenta";
       |ERROR;
       |ACABA;
   |FINSI;

   swError = 0;
   aAlfa2 = aAlfa1 % 0;
   nNume1 = aAlfa2;
   |PARA nNume2 = 1; |SI nNume2 [ nNume1; |HACIENDO nNume2 = nNume2 + 1;
         aAlfa2 = nNume2; |QBF aAlfa2;
         aAlfa2 = aAlfa2 + "01";
         aAlfa3 = aAlfa1 % aAlfa2;
         |SI aAlfa3 < "0"; |O aAlfa3 > "9";
             swError = 1;
             |SAL;
         |FINSI;
   |SIGUE;
   |SI swError = 1;
       |MENAV "    Cuenta Erronea ... ";
       |ERROR;
   |FINSI;

   |DBASE aAlfa1; |QBF aAlfa1;
   aAlfa2 = aAlfa1 + "def/dsmom061.mas";
   |CARGA_DEF aAlfa2, dsmom61@;
   |SI FSalida = 0;
       swError = 0;
       |BUCLE VerEspejo;
       |DESCARGA_DEF #dsmom61@;
       |SI swError = 1;
           |MENAV "    Error Cuenta Ya Introducida en la Planilla";
           |ERROR;
       |FINSI;
   |FINSI;
|FCAL;

|CALCULO ElDefecto; |TIPO 0;
   esaltaL = (FEntrada / 100) ! 0;
   |SI esaltaL = 1;
       |SI #0#1 = "G"; #1#5 = "+"; |FINSI;
       |SI #0#1 = "I"; #1#5 = "-"; |FINSI;
       |PINTA #1#5;
   |FINSI;
|FCAL;
