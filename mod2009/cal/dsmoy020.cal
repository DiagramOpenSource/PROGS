|FICHEROS;
    dsmoy020 #0;

    dsmom001 #1;
    dsmom004 #4;
    dsmom037 #37;

    dsm190ca #190;
    dsm190li #191;
    dsmom107 #107;

    :/basica/def/agicen17 #17;
    :/basica/def/agim0024 #24;
    :/basica/def/agim0026 #26;
    :/basica/def/agim0029 #29;

    :/integral/def/dsam0003 #300;
    :/laboral/def/labempre  #310;
    :/laboral/def/labtraba  #311;

    &regisnif@ #709;
    &clientes@ #715;

    dsmow036 #36;
    dsmow093 #93;
    dsmow101 #998,MANTE;
    dsmow014 #999;

    Ref0001@ #1000;
|FIN;

|VARIABLES;
     &eaParam  = "";
     nSwGraba  = 0;
     nCampo    = 0;
     nPara1    = 0;
     nDEmpresa = 0;
     nHEmpresa = 0;
     nEjer     = 0;
     nSwHay    = 0;
     nSw       = 0;
     nEmpr     = 0;

     &eaEmpr   = ""; &eaTrab   = "";

     &RetDin1 = 0; &ImpDin1 = 0; &ValDin1 = 0; &InCDin1 = 0; &ICRDin1 = 0;
     &RetEsp1 = 0; &ImpEsp1 = 0; &ValEsp1 = 0; &InCEsp1 = 0; &ICREsp1 = 0;

     &RetDin2 = 0; &ImpDin2 = 0; &ValDin2 = 0; &InCDin2 = 0; &ICRDin2 = 0;
     &RetEsp2 = 0; &ImpEsp2 = 0; &ValEsp2 = 0; &InCEsp2 = 0; &ICREsp2 = 0;

     &RetDin3 = 0; &ImpDin3 = 0; &ValDin3 = 0; &InCDin3 = 0; &ICRDin3 = 0;
     &RetEsp3 = 0; &ImpEsp3 = 0; &ValEsp3 = 0; &InCEsp3 = 0; &ICREsp3 = 0;

     &RetDin4 = 0; &ImpDin4 = 0; &ValDin4 = 0; &InCDin4 = 0; &ICRDin4 = 0;
     &RetEsp4 = 0; &ImpEsp4 = 0; &ValEsp4 = 0; &InCEsp4 = 0; &ICREsp4 = 0;

     &RetDin5 = 0; &ImpDin5 = 0; &ValDin5 = 0; &InCDin5 = 0; &ICRDin5 = 0;
     &RetEsp5 = 0; &ImpEsp5 = 0; &ValEsp5 = 0; &InCEsp5 = 0; &ICREsp5 = 0;

     aClv1 = ""; aClv2 = ""; aClv3 = "";
     aSubClv = "";

     informe = "";
     aAlfa1    = "";
     aAlfa2    = "";
     aAlfa3    = "";
     aAlfa4    = "";
     aFichero  = "";
     aPath     = "";
     eaMoneda = "";
     &eaTMoneda = "";
     &aElDni    = "";
     &aElNombre = "";
     &aElDniEmp = "";
     &aElNomEmp = "";
     &aElMunEmp = "";
     &aElProEmp = "";
     &aElCPEmp  = "";
     &aElSg     = "";
     &aElCl     = "";
     &aElNu     = "";
     &aElEs     = "";
     &aElPi     = "";
     &aElPt     = "";
     &aElTl     = "";
     &aElRe     = "";
     aAlfa     = "";

     &periodo = 0;
     &codemp = "";
     &nomrep = "";
     &dnirep = "";
     &carrep = "";
     &nomemp = "";
     &dniemp = "";
     &domemp = "";
     &munemp = "";
     &cpoemp = "";
     &proemp = "";
     &nomtra = "";
     &dnitra = "";
     &domtra = "";
     &muntra = "";
     &cpotra = "";
     &protra = "";

     &190sg = "";
     &190cl = "";
     &190nu = "";
     &190es = "";
     &190pi = "";
     &190pt = "";
     &190tl = "";
     &190fp = "";

     fecsys  = @;
     &fletra = "";
     &fprese = @;

     nContador = 0;
     nCont     = 0;
     nCalc    = 0;
     aSClave  = "";
     aClave   = "";
     aClave1  = "";
     aClave2  = "";
     aClave3  = "";

     &tbases1 = 0;
     &tbases2 = 0;
     &tbases3 = 0;
     &tbases4 = 0;
     &treten1 = 0;
     &treten2 = 0;
     &treten3 = 0;
     &treten4 = 0;
     &trep1 = 0;
     &trep2 = 0;
     &trep3 = 0;
     &trep4 = 0;
     &tdescue = 0;
     &texenta = 0;
     &letrai = 0;
     &clave1  = "";
     &clave2  = "";
     &clave3  = "";
     &clave4  = "";
     &especie1    = "";
     &especie2    = "";
     &especie3    = "";
     &xespe4      = "";
     &eaPathIntegral = "";
     &eaCodRenta     = "";

     SwPrimer  = 0;
      enSwHay  = 0;
     sw_valido = 0;
     nVale     = 0;
     nHayRepre = 0;
     nLectura  = 0;
     nDComple  = 0;
     nHComple  = 0;
     aBase     = "";
     nCanal    = 0;
     nSwLaboral = 0;
     nSwExiLab  = 0;
     &enLabornet = 0;
     &eaRutaFichLab = "";
|FIN;

|INCLUYE i_variar;
|| /////////////////////// PROCESOS ENTRADA POR PANTALLA \\\\\\\\\\\\\\\\\\\\

|PROCESO CodigoRenta;
     |DBASS aBase;  |QBF aBase;
     aAlfa = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathIntegral  = aBase + "integral/";
     |FINSI;

     |C_M #0#33, 1, "S";
     |SI eaPathIntegral = "";
         |C_M #0#33, 1, "N";  #0#33 = "N";  |PINTA #0#33;
     |SINO;
         |SI #0#15 = 1;
             |C_M #0#33, 1, "N";  #0#33 = "N";  |PINTA #0#33;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO T7;  |TIPO 7;
     |SI enEmpresa ! 0;
         #0#0 = enEmpresa;  |PINTA #0#0;
         #0#1 = enEmpresa;  |PINTA #0#1;

         |C_M #0#0, 1, "N";
         |C_M #0#1, 1, "N";
     |FINSI;
     aAlfa1 = #0#16; aAlfa1 = aAlfa1 % -104;
     #0#14 = aAlfa1;
     #0#14 = #0#14 - 1;
     |PINTA #0#14;
     |HAZ Orden;
|FPRC;

|PROCESO Parrilla;
     |SI #0#0 = 0;
         #0#0 = 0;  |PINTA #0#0;
         #0#1 = 0;  |PINTA #0#1;  |C_M #0#1, 1, "N";
         |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |SINO;
         |SI enEmpresa = 0;
             |C_M #0#0, 1, "S";
             |C_M #0#1, 1, "S";
         |FINSI;

         |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
               #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasEmpresas;
     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               #0nCampo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO DesdeDni;
     |SI #0#19 = "            ";
         #0#20 = "zzzzzzzzzzzz";  |C_M #0#20,1,"N"; |PINTA #0#20;
         |PARA nCampo = 21;  |SI nCampo [ 28;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |SINO;
         |C_M #0#20,1,"S";
         |PARA nCampo = 21;  |SI nCampo [ 28;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
               #0nCampo = ""; |PINTA #0nCampo;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasDni;
     |SI #0Campo = "            ";
         |PARA nCampo = Campo + 1;  |SI nCampo [ 28;  |HACIENDO nCampo = nCampo + 1;
               #0nCampo = "";  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 28;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO AntesCargo;  |TIPO 7;
     |PUSHV 1901 2380;
     |SI nSwLaboral = 1; |Y enEmpresa = 0;
         |CUADRO 1905 2269;
         |ATRI R;
         |PINTA 2006, " Introduzca cargo de la Persona de la Empresa que  figurara en ";
         |PINTA 2106, " el Certificado, en caso de no llevar Nominas de dicha Empresa ";
         |ATRI 0;
     |FINSI;
|FPRC;

|PROCESO LeeCargo;
 |POPV;
 |ABRE #29;
 #29#0 = #0Campo;
 |LEE 001#29=;
 |SI FSalida = 0;
     #0#17 = #29#1; |PINTA #0#17;
 |FINSI;
 |CIERRA #29;
|FPRC;

|PROCESO Orden;
     |SI #0#15 = 3;
          |CAMPO_MODIFICA #0#35, 1, "S";
          |CAMPO_VISUAL #0#35, 1, "S";
          |PINTA 2051, "Orden.:";
          |PINTA #0#35;
     |SINO;
          |CAMPO_MODIFICA #0#35, 1, "N";
          |CAMPO_VISUAL #0#35, 1, "N";
          |PINTA 2051, "          ";
          |PINTA 2151, "컴컴컴컴컴";
     |FINSI;
|FPRC;

|| /////////////////////// //////////////////////////////////////////////////
|| /////////////////////// PROCESOS DE INFORMES \\\\\\\\\\\\\\\\\\\\\
|| \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\

|PROCESO ElTrabajador;
 especie1 = "";
 especie2 = "";
 especie3 = "";
 xespe4   = "N";

 tbases1 = 0;
 tbases2 = 0;
 tbases3 = 0;

 treten1 = 0;
 treten2 = 0;
 treten3 = 0;

 trep1 = 0;
 trep2 = 0;
 trep3 = 0;

 tdescue = 0;
 texenta = 0;
 aClave1 = "";
 aClave2 = "";
 aClave3 = "";
 aClave  = "";

 nContador = 0;

 aElDni = #191#6;

 eaCodNif = #191#6;
 |HAZ LeeNifs;

 nomtra = #709#1;
 dnitra = aElDni;
 aElNombre = nomtra;
 aElDniEmp = #dsmow093#38;
 aElNomEmp = #dsmow093#37;
 aElMunEmp = #dsmow093#40;
 aElProEmp = #dsmow093#42;
 aElCPEmp  = #dsmow093#41;
 aElSg     = #dsmow093#43;
 aElCl     = #dsmow093#44;
 aElNu     = #dsmow093#45;
 aElEs     = #dsmow093#46;
 aElPi     = #dsmow093#47;
 aElPt     = #dsmow093#48;
 aElTl     = #dsmow093#49;
 aElRe     = #dsmow093#34;

 aAlfa1 = #709#9; |QBF aAlfa1; |SI aAlfa1 ! ""; aAlfa1 = aAlfa1 + " "; |FINSI;
 aAlfa2 = #709#2; |QBF aAlfa2; |SI aAlfa2 ! ""; aAlfa2 = aAlfa2 + " "; |FINSI;
 aAlfa3 = #709#3;
 domtra = aAlfa1 + aAlfa2 + aAlfa3;
 muntra = #709#6;
 protra = #709#7;

 aAlfa1 = #709#4; |QBF aAlfa1; aAlfa1 = ("00" + aAlfa1) % -102;
 aAlfa2 = #709#5; |QBF aAlfa2; aAlfa2 = ("000" + aAlfa2) % -103;
 cpotra = aAlfa1 + aAlfa2;
|FPRC;

|| **********************************************************************
____________________________________/ CALCULOS DE LECTURA E IMPRESION

|PROCESO ElCerti;
     sw_valido = 1;
     |SI texenta = 0;|Y #0#18 = "S"; sw_valido = 0; |FINSI; || exentas S/N

     |SI sw_valido = 1;
          |PRINT;
          |PIEINF;
    |FINSI;
|FPRC;

|| ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
|PROCESO FechaPres;
 |ABRE #4;
 #4#0 = #190#0;
 #4#1 = #190#1;
 #4#2 = #190#2;
 #4#3 = #190#3;
 #4#4 = #190#4;
 |LEE 000#4=;
 fprese = #4#10;
 |CIERRA #4;
|FPRC;


||/////////////////////////////////////////////////////////////////////////
||///// Calculos para el Tipo 1 de Informe ////////////////////////////////
||/////////////////////////////////////////////////////////////////////////
|PROCESO Imprimir;
  |SI tbases1!0;|O tbases2!0;|O tbases3!0;|O treten1!0;
                  |O treten2!0;|O treten3!0;|O tdescue!0;
          letrai = 0;
          clave1 = aClave1;
          clave2 = aClave2;
          clave3 = aClave3;
          |HAZ ElCerti;
  |FINSI;

  |SI texenta ! 0;
          letrai = 1;
          clave1 = "L";
          clave2 = "";
          clave3 = "";
          |HAZ ElCerti;
  |FINSI;
|FPRC;

|PROCESO Man190Li;
 |SI #0#19 = "            ";
     nVale = 0;
     |PARA nCampo = 21; |SI nCampo [ 28; |HACIENDO nCampo = nCampo + 1;
           |SI #0nCampo ! "            ";
               nVale = 1;
               |SI #0nCampo = #191#6;
                   nVale = 2;
                   |SAL;
               |FINSI;
           |FINSI;
     |SIGUE;
 |FINSI;
 |SI nVale = 1; |ACABA; |FINSI;

 |SI #0#34 = "S"; |HAZ OtraSeleccion; |FINSI;
 |SI nVale = 1; |ACABA; |FINSI;

 |SI SwPrimer = 0;
     |HAZ ElTrabajador;
     SwPrimer = 1;
 |FINSI;

 |SI aElDni ! #191#6;
     |HAZ Imprimir;
     |HAZ ElTrabajador;
 |FINSI;

|| ............................. Sumo Cantidades donde van
     |SI #191#8 = "L";
         texenta = texenta + (#191#16 + #191#18);     || bases
         |ACABA;
     |FINSI;

     |SI aClave ! #191#8;
         aClave = #191#8;
         nContador = nContador + 1;
     |FINSI;

     |SI nContador > 3;  |ERROR10;  |ACABA;  |FINSI;

     tdescue = tdescue + #191#22;                 || seg.social
     |SI nContador = 1;
         |SI #191#16 ! 0;  |Y #191#18 = 0;
             |SI aClave1 = "";
                 tbases1   = tbases1   + #191#16;     || bases
                 treten1   = treten1   + #191#17;     || cuota
                 aClave1   = #191#8;
                 especie1  = "N";
             |SINO;
                 |SI especie1 = "N";
                     tbases1   = tbases1   + #191#16;     || bases
                     treten1   = treten1   + #191#17;     || cuota
                     aClave1   = #191#8;
                     especie1  = "N";
                 |SINO;
                     tbases2   = tbases2   + #191#16;     || bases
                     treten2   = treten2   + #191#17;     || cuota
                     aClave2   = #191#8;
                     especie2  = "S";
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI #191#16 = 0;  |Y #191#18 ! 0;
             |SI aClave1 = "";
                 tbases1   = tbases1   + #191#18;     || bases
                 treten1   = treten1   + #191#19;     || cuota
                 trep1     = trep1     + #191#20;     || cuota
                 aClave1   = #191#8;
                 especie1  = "S";
                 xespe4    = "S";
             |SINO;
                 |SI especie1 = "S";
                     tbases1   = tbases1   + #191#18;    || bases
                     treten1   = treten1   + #191#19;    || cuota
                     trep1     = trep1     + #191#20;     || cuota
                     aClave1   = #191#8;
                     especie1  = "S";
                     xespe4    = "S";
                 |SINO;
                     tbases2   = tbases2   + #191#18;    || bases
                     treten2   = treten2   + #191#19;    || cuota
                     trep2     = trep2     + #191#20;     || cuota
                     aClave2   = #191#8;
                     especie2  = "S";
                     xespe4    = "S";
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI #191#16 ! 0;  |Y #191#18 ! 0;
             |SI aClave1 = "";
                 tbases1   = tbases1   + #191#16;     || bases
                 treten1   = treten1   + #191#17;     || cuota
                 aClave1   = #191#8;
                 especie1  = "N";

                 tbases2   = tbases2   + #191#18;     || bases
                 treten2   = treten2   + #191#19;     || cuota
                 trep2     = trep2     + #191#20;     || cuota
                 xespe4    = "S";
                 aClave2   = #191#8;
                 especie2  = "S";
             |SINO;
                 |SI especie1 = "N";
                     tbases1   = tbases1   + #191#16;     || bases
                     treten1   = treten1   + #191#17;     || cuota
                     aClave1   = #191#8;
                     especie1  = "N";

                     tbases2   = tbases2   + #191#18;     || bases
                     treten2   = treten2   + #191#19;     || cuota
                     trep2     = trep2     + #191#20;     || cuota
                     aClave2   = #191#8;
                     especie2  = "S";
                     xespe4    = "S";
                 |SINO;
                     tbases2   = tbases2   + #191#16;     || bases
                     treten2   = treten2   + #191#17;     || cuota
                     aClave2   = #191#8;
                     especie2  = "N";

                     tbases1   = tbases1   + #191#18;     || bases
                     treten1   = treten1   + #191#19;     || cuota
                     trep1     = trep1     + #191#20;     || cuota
                     aClave1   = #191#8;
                     especie1  = "S";
                     xespe4    = "S";
                 |FINSI;
             |FINSI;
          |FINSI;
          |ACABA;
     |FINSI;

     |SI nContador = 2;
         |SI #191#16 ! 0;  |Y #191#18 = 0;
             |SI aClave2 = "";
                 tbases2   = tbases2   + #191#16;     || bases
                 treten2   = treten2   + #191#17;     || cuota
                 aClave2   = #191#8;
                 especie2  = "N";
             |SINO;
                 |SI aClave2 = aClave;
                     |SI especie2 = "N";
                         tbases2   = tbases2   + #191#16;     || bases
                         treten2   = treten2   + #191#17;     || cuota
                         aClave2   = #191#8;
                         especie2  = "N";
                     |SINO;
                         tbases3   = tbases3   + #191#16;     || bases
                         treten3   = treten3   + #191#17;     || cuota
                         aClave3   = #191#8;
                         especie3  = "N";
                     |FINSI;
                 |SINO;
                     tbases3   = tbases3   + #191#16 + #191#18;     || bases
                     treten3   = treten3   + #191#17 + #191#19;     || cuota
                     aClave3   = #191#8;
                     especie3  = "N";
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI #191#16 = 0;  |Y #191#18 ! 0;
             |SI aClave2 = "";
                 tbases2   = tbases2   + #191#18;     || bases
                 treten2   = treten2   + #191#19;     || cuota
                 trep2     = trep2     + #191#20;     || cuota
                 aClave2   = #191#8;
                 especie2  = "S";
                 xespe4    = "S";
             |SINO;
                 |SI aClave2 = aClave;
                     |SI especie2 = "S";
                         tbases2   = tbases1   + #191#18;    || bases
                         treten2   = treten1   + #191#19;    || cuota
                         trep2     = trep2     + #191#20;     || cuota
                         aClave2   = #191#8;
                         especie2  = "S";
                         xespe4    = "S";
                     |SINO;
                         tbases3   = tbases3   + #191#18;    || bases
                         treten3   = treten3   + #191#19;    || cuota
                         trep3     = trep3     + #191#20;     || cuota
                         aClave3   = #191#8;
                         especie3  = "S";
                         xespe4    = "S";
                     |FINSI;
                  |SINO;
                      tbases3   = tbases3   + #191#16 + #191#18;     || bases
                      treten3   = treten3   + #191#17 + #191#19;     || cuota
                      aClave3   = #191#8;
                      especie3  = "N";
                  |FINSI;
             |FINSI;
         |FINSI;

         |SI #191#16 ! 0;  |Y #191#18 ! 0;
             |SI aClave2 = "";
                 tbases2   = tbases2   + #191#16;     || bases
                 treten2   = treten2   + #191#17;     || cuota
                 aClave2   = #191#8;
                 especie2  = "N";

                 tbases3   = tbases3   + #191#18;     || bases
                 treten3   = treten3   + #191#19;     || cuota
                 trep3     = trep3     + #191#20;     || cuota
                 aClave3   = #191#8;
                 especie3  = "S";
                 xespe4    = "S";
             |SINO;
                 |SI aClave2 = aClave;
                     |SI especie2 = "N";
                         tbases2   = tbases2   + #191#16;     || bases
                         treten2   = treten2   + #191#17;     || cuota
                         aClave2   = #191#8;
                         especie2  = "N";

                         tbases3   = tbases3   + #191#18;     || bases
                         treten3   = treten3   + #191#19;     || cuota
                         trep3     = trep3     + #191#20;     || cuota
                         aClave3   = #191#8;
                         especie3  = "S";
                         xespe4    = "S";
                     |SINO;
                         tbases3   = tbases3   + #191#16;     || bases
                         treten3   = treten3   + #191#17;     || cuota
                         aClave3   = #191#8;
                         especie3  = "N";

                         tbases2   = tbases2   + #191#18;     || bases
                         treten2   = treten2   + #191#19;     || cuota
                         trep2     = trep2     + #191#20;     || cuota
                         aClave2   = #191#8;
                         especie2  = "S";
                         xespe4    = "S";
                    |FINSI;
                  |SINO;
                      tbases3   = tbases3   + #191#16 + #191#18;     || bases
                      treten3   = treten3   + #191#17 + #191#19;     || cuota
                      aClave3   = #191#8;
                      especie3  = "N";
                  |FINSI;
             |FINSI;
          |FINSI;
          |ACABA;
     |FINSI;

     |SI nContador = 3;
         |SI aClave3 = "";
             tbases3   = tbases3   + #191#16 + #191#18;     || bases
             treten3   = treten3   + #191#17 + #191#19;     || cuota
             aClave3   = #191#8;
             especie3  = "N";
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE Man190Li;
     #191#1;
     ;
     #190#0,#190#1,#190#2,#190#3,#190#4,#190#5,#0#19,0000," ","  ",0;
     #190#0,#190#1,#190#2,#190#3,#190#4,#190#5,#0#20,9999,"z","zz",9;
     ;
     NULL, Man190Li;
|FIN;
||\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\

||/////////////////////////////////////////////////////////////////////////
||///// Calculos para el Tipo 2 de Informe ////////////////////////////////
||/////////////////////////////////////////////////////////////////////////

|PROCESO ElAuxw36;
 |SI SwPrimer = 0; |O aElDni ! #36#0;
     #191#6  = #36#0;
     |HAZ ElTrabajador;
     SwPrimer = 1;
 |FINSI;

 |ABRE #37;
 |DDEFECTO #37;
 #37#0 = #36#1;
 #37#1 = #36#2;
 |LEE 001#37=;
 |CIERRA #37;

 eaCodRenta = "";
 |SI #0#33 = "S";
     |ABRE #300;
     |SELECT #2#300;
     #300#1 = #36#0;
     |LEE 040#300=;
     |SI FSalida = 0;
         eaCodRenta = "Codigo de Renta : " + (("00000" + #300#0) % -105);
     |SINO;
         |SELECT #3#300;
         #300#35 = #36#0;
         |LEE 040#300=;
         |SI FSalida = 0;
             eaCodRenta = "Codigo de Renta : " + (("00000" + #300#0) % -105);
         |FINSI;
     |FINSI;
     |CIERRA #300;
 |FINSI;

 |PRINT;
 |PIEINF;
|FPRC;

|DEFBUCLE ElAuxw36;
 #36#1;
 ;
 "            ", " ", "  ";
 "zzzzzzzzzzzz", "z", "zz";
 ;
 NULL, ElAuxw36;
|FIN;

|PROCESO Imprimir_2;
   aElDni = ""; aElNombre = "";
   aElDniEmp = ""; aElNomEmp = "";
   aElMunEmp = ""; aElProEmp = ""; aElCPEmp = "";
   aElSg     = ""; aElCl     = ""; aElNu     = "";
   aElEs     = ""; aElPi     = ""; aElPt     = "";
   aElTl     = ""; aElRe     = "";
   SwPrimer = 0;
   aElDni   = ""; aElNombre = "";
   aElDniEmp = ""; aElNomEmp = "";
   aElMunEmp = ""; aElProEmp = ""; aElCPEmp = "";
   aElSg     = ""; aElCl     = ""; aElNu     = "";
   aElEs     = ""; aElPi     = ""; aElPt     = "";
   aElTl     = ""; aElRe     = "";
   |BUCLE ElAuxw36;
|FPRC;

||\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\

||/////////////////////////////////////////////////////////////////////////
||///// Calculos para el Tipo 3 de Informe ////////////////////////////////
||/////////////////////////////////////////////////////////////////////////

|PROCESO Auxiliar;
 |SI #93#1 ! aClv1; |Y #93#1 ! aClv2; |Y #93#1 ! aClv3;
    |ACABA;
 |FINSI;
 |SI aSubClv ! "";
    |SI aSubClv ! #93#2; |ACABA; |FINSI;
 |FINSI;
 nSwHay    = 1;

 |SI nSw = 1; |ACABA; |FINSI;

 |SI SwPrimer = 0; |O aElDni ! #93#0; |O nEmpr ! #93#33;
     |SI informe = "dsmor121"; |Y SwPrimer ! 0;
         |PRINT; |PIEINF;
         RetDin1 = 0; ImpDin1 = 0; ValEsp1 = 0; InCEsp1 = 0; ICREsp1 = 0;
         RetDin2 = 0; ImpDin2 = 0; ValEsp2 = 0; InCEsp2 = 0; ICREsp2 = 0;
         RetDin3 = 0; ImpDin3 = 0; ValEsp3 = 0; InCEsp3 = 0; ICREsp3 = 0;
         RetDin4 = 0; ImpDin4 = 0; ValEsp4 = 0; InCEsp4 = 0; ICREsp4 = 0;
         RetDin5 = 0; ImpDin5 = 0; ValEsp5 = 0; InCEsp5 = 0; ICREsp5 = 0;
     |FINSI;
     #191#6  = #93#0;
     |HAZ ElTrabajador;
     SwPrimer = 1;

  |SI nSwLaboral = 1;
     #labtraba#7 = #93#0;
     |LEE 000#labtraba.=;
     |PARA; |SI FSalida = 0; |Y #labtraba#7 = #93#0; |HACIENDO;
        |SI #labtraba#0 = #93#33; |SAL; |FINSI;
        |LEE 000#labtraba.s;
     |SIGUE;

     |SI #labtraba#0 = #93#33; |Y FSalida = 0;
        eaEmpr = #labtraba#0;
        eaTrab = #labtraba#1;
        eaTrab = ("00000" + eaTrab) % -105;
     |SINO;
        eaEmpr = #93#50; eaTrab = #93#51;
     |FINSI;
   |SINO;
        eaEmpr = #93#50; eaTrab = #93#51;
   |FINSI;

     eaEmpr = ("000000" + eaEmpr) % -106;
     nEmpr = #93#33;
 |FINSI;

 |ABRE #37;
 |DDEFECTO #37;
 #37#0 = #93#1;
 #37#1 = #93#2;
 |LEE 001#37=;
 |CIERRA #37;

 eaCodRenta = "";
 |SI #0#33 = "S";
     |ABRE #300;
     |SELECT #2#300;
     #300#1 = #93#0;
     |LEE 040#300=;
     |SI FSalida = 0;
         eaCodRenta = "Codigo de Renta : " + (("00000" + #300#0) % -105);
     |SINO;
         |SELECT #3#300;
         #300#35 = #93#0;
         |LEE 040#300=;
         |SI FSalida = 0;
             eaCodRenta = "Codigo de Renta : " + (("00000" + #300#0) % -105);
         |FINSI;
     |FINSI;
     |CIERRA #300;
 |FINSI;

 |SI informe ! "dsmor121";
    |PRINT;
    |PIEINF;
 |SINO;
    |SI #93#1 = "G";
       RetDin1 = (RetDin1 + #93#4) ! 2; ImpDin1 = (ImpDin1 + #93#3) ! 2;
       ValEsp1 = (ValEsp1 + #93#5) ! 2; InCEsp1 = (InCEsp1 + #93#6) ! 2;
       ICREsp1 = (ICREsp1 + #93#7) ! 2;
    |FINSI;
    |SI #93#1 = "H";
       |SI #93#2 ! "03"; |Y #93#2 ! "04";
          RetDin2 = (RetDin2 + #93#4) ! 2; ImpDin2 = (ImpDin2 + #93#3) ! 2;
          ValEsp2 = (ValEsp2 + #93#5) ! 2; InCEsp2 = (InCEsp2 + #93#6) ! 2;
          ICREsp2 = (ICREsp2 + #93#7) ! 2;
       |SINO;
          |SI #93#2 = "03";
             RetDin4 = (RetDin4 + #93#4) ! 2; ImpDin4 = (ImpDin4 + #93#3) ! 2;
             ValEsp4 = (ValEsp4 + #93#5) ! 2; InCEsp4 = (InCEsp4 + #93#6) ! 2;
             ICREsp4 = (ICREsp4 + #93#7) ! 2;
          |FINSI;
          |SI #93#2 = "04";
             RetDin5 = (RetDin5 + #93#4) ! 2; ImpDin5 = (ImpDin5 + #93#3) ! 2;
             ValEsp5 = (ValEsp5 + #93#5) ! 2; InCEsp5 = (InCEsp5 + #93#6) ! 2;
             ICREsp5 = (ICREsp5 + #93#7) ! 2;
          |FINSI;
       |FINSI;
    |FINSI;
    |SI #93#1 = "I";
       RetDin3 = (RetDin3 + #93#4) ! 2; ImpDin3 = (ImpDin3 + #93#3) ! 2;
       ValEsp3 = (ValEsp3 + #93#5) ! 2; InCEsp3 = (InCEsp3 + #93#6) ! 2;
       ICREsp3 = (ICREsp3 + #93#7) ! 2;
    |FINSI;
 |FINSI;
|FPRC;

|DEFBUCLE Auxiliar;
 #93#1;
 ;
 00000, "            ", " ", "  ";
 99999, "zzzzzzzzzzzz", "z", "zz";
 ;
 NULL, Auxiliar;
|FIN;

||\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\

|PROCESO LeeLaboral;
    nSwExiLab = 0;
    |SI nSwLaboral = 1;
        |ABRE #310;
        |DDEFECTO #310;
        #310#0 = #190#0;
        |LEE 000#310=;
        |SI FSalida = 0;
            nSwExiLab = 1;
            nomrep = #310#15;
            dnirep = #310#17;
            carrep = #310#18;
        |FINSI;
        |CIERRA #310;
        |QBF nomrep;
        |SI nomrep = "";
            nSwExiLab = 0;
        |FINSI;
    |FINSI;
|FPRC;

|PROCESO BuscaCargo190;
   nomrep = #26#4;
   dnirep = #26#3;
   carrep = #26#17;
|FPRC;

|DEFBUCLE agim0026;
    #26#1;
    16;
    #190#0, 01, 01, #0#32;
    #190#0, 99, 99, #0#32;
    ;
    NULL, BuscaCargo190;
|FIN;

|PROCESO BuscaCargo190R;
     nomrep = #24#4;
     dnirep = #24#3;
     carrep = "REPRESENTANTE";
     nHayRepre = 1;
     |ERROR10;
|FPRC;

|DEFBUCLE agim0024;
     #24#2;
     ;
     #190#0, 99, 01;
     #190#0, 01, 99;
     ;
     NULL, BuscaCargo190R;
|FIN;

|PROCESO BuscaComuneros;
     aAlfa = "31.12." + #190#1;
     |SI #1#8 > aAlfa;  |ACABA;  |FINSI;

     aAlfa = "01.01." + #190#1;
     |SI #1#9 ! "01.01.0000";
         |SI #1#9 < aAlfa;  |ACABA;  |FINSI;
     |FINSI;

     nHayRepre = 1;

     enCodCli = #1#3;
     |HAZ LeePersona;

     |SI enSwDeDonde = 1;
         nomrep = #715#1;
         dnirep = #715#3;
         carrep = "REPRESENTANTE";
     |SINO;
         nomrep = #715#1;
         dnirep = #715#13;
         carrep = "REPRESENTANTE";
     |FINSI;

     |ERROR10;
|FPRC;

|DEFBUCLE dsmom001;
     #1#1;
     ;
     #190#0, 01, 0001;
     #190#0, 99, 9999;
     ;
     NULL, BuscaComuneros;
|FIN;

|PROCESO Man190Li_2;
     |SI #0#19 = "            ";
         nVale = 0;
         |PARA nCampo = 21; |SI nCampo [ 28; |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo ! "            ";
                   nVale = 1;
                   |SI #0nCampo = #191#6;
                       nVale = 2;
                       |SAL;
                   |FINSI;
               |FINSI;
          |SIGUE;
     |FINSI;

     |SI nVale = 1; |ACABA; |FINSI;
     |SI #0#34 = "S"; |HAZ OtraSeleccion; |FINSI;
     |SI nVale = 1; |ACABA; |FINSI;

     |SI SwPrimer = 0; |O aElDni ! #191#6;
         aElDni = #191#6;
         eaCodNif = #191#6;
         |HAZ LeeNifs;
         aElNombre = #709#1;
         aElDniEmp = #dsmow093#38;
         aElNomEmp = #dsmow093#37;
         aElMunEmp = #dsmow093#40;
         aElProEmp = #dsmow093#42;
         aElCPEmp  = #dsmow093#41;
         aElSg     = #dsmow093#43;
         aElCl     = #dsmow093#44;
         aElNu     = #dsmow093#45;
         aElEs     = #dsmow093#46;
         aElPi     = #dsmow093#47;
         aElPt     = #dsmow093#48;
         aElTl     = #dsmow093#49;
         aElRe     = #dsmow093#34;
         SwPrimer = 1;
     |FINSI;

     || ............................. Sumo Cantidades donde van

     |SI #191#8 = "L";
         texenta = texenta + (#191#16 + #191#18);     || bases
         aClave  = "A";
         aSClave = "";
     |SINO;
         aClave  = #191#8;
         aSClave = #191#9;
     |FINSI;

     #36#0 = aElDni;
     #36#1 = aClave;
     #36#2 = aSClave;
     |LEE 001#36=;
     |SI FSalida ! 0;
         |DDEFECTO #36;
         #36#0 = aElDni;
         #36#1 = aClave;
         #36#2 = aSClave;
         |GRABA 020#36c;
     |FINSI;

     |SI #191#8 = "L";
        aAlfa = #191#9; |QBF aAlfa; aAlfa = ("00" + aAlfa) % -102;
        |SI aAlfa = "01";
           #36#11 = #36#11 + #191#16;
        |SINO;
           #36#12 = #36#12 + #191#16;
        |FINSI;
     |SINO;
         |SI #191#7 ! 0;
             |SI #36#13 = 0; |O #36#13 = #191#7;
                 #36#13 = #191#7;
                 #36#14 = #36#14 + #191#17;
                 #36#15 = #36#15 + #191#16;
                 #36#25 = #36#25 + #191#22;
                 #36#29 = #36#29 + #191#21;
             |SINO;
                 |SI #36#16 = 0; |O #36#16 = #191#7;
                     #36#16 = #191#7;
                     #36#17 = #36#17 + #191#17;
                     #36#18 = #36#18 + #191#16;
                     #36#26 = #36#26 + #191#22;
                     #36#30 = #36#30 + #191#21;
                 |SINO;
                     |SI #36#19 = 0; |O #36#19 = #191#7;
                         #36#19 = #191#7;
                         #36#20 = #36#20 + #191#17;
                         #36#21 = #36#21 + #191#16;
                         #36#27 = #36#27 + #191#22;
                         #36#31 = #36#31 + #191#21;
                     |SINO;
                         |SI #36#22 = 0; |O #36#22 = #191#7;
                             #36#22 = #191#7;
                             #36#23 = #36#23 + #191#17;
                             #36#24 = #36#24 + #191#16;
                             #36#28 = #36#28 + #191#22;
                             #36#32 = #36#32 + #191#21;
                         |FINSI;
                     |FINSI;
                 |FINSI;
             |FINSI;
         |SINO;
             #36#3 = #36#3 + #191#16;
             #36#4 = #36#4 + #191#17;
             #36#5 = #36#5 + #191#18;
             #36#6 = #36#6 + #191#19;
             #36#7 = #36#7 + #191#20;
         |FINSI;
     |FINSI;

     #36#8 = #36#8 + #191#21;
     #36#9 = #36#9 + #191#22;

     |GRABA 020#36a;

||ABDON  Se unifican las claves A, E, F, L y M en la Clave Z a efectos de
||        impresion
     |SI #dsmoy020#15 = "3";
        |SI aClave = "A"; |O aClave = "L"; |O aClave = "E";
         |O aClave = "F"; |O aClave = "M";
           #36#0 = aElDni;
           #36#1 = "Z";    || La clave Z agrupa las claves A, L, E, F y M
           #36#2 = 00;
           |LEE 001#36=;
           |SI FSalida ! 0;
               |DDEFECTO #36;
               #36#0 = aElDni;
               #36#1 = "Z";
               #36#2 = 00;
               |GRABA 020#36c;
           |FINSI;

           |SI #191#8 = "L";
              aAlfa = #191#9; |QBF aAlfa; aAlfa = ("00" + aAlfa) % -102;
              |SI aAlfa = "01";
                 #36#11 = #36#11 + #191#16;
              |SINO;
                 #36#12 = #36#12 + #191#16;
              |FINSI;
           |SINO;
               |SI #191#7 ! 0;
                   |SI #36#13 = 0; |O #36#13 = #191#7;
                       #36#13 = #191#7;
                       #36#14 = #36#14 + #191#17;
                       #36#15 = #36#15 + #191#16;
                       #36#25 = #36#25 + #191#22;
                       #36#29 = #36#29 + #191#21;
                   |SINO;
                       |SI #36#16 = 0; |O #36#16 = #191#7;
                           #36#16 = #191#7;
                           #36#17 = #36#17 + #191#17;
                           #36#18 = #36#18 + #191#16;
                           #36#26 = #36#26 + #191#22;
                           #36#30 = #36#30 + #191#21;
                       |SINO;
                           |SI #36#19 = 0; |O #36#19 = #191#7;
                               #36#19 = #191#7;
                               #36#20 = #36#20 + #191#17;
                               #36#21 = #36#21 + #191#16;
                               #36#27 = #36#27 + #191#22;
                               #36#31 = #36#31 + #191#21;
                           |SINO;
                               |SI #36#22 = 0; |O #36#22 = #191#7;
                                   #36#22 = #191#7;
                                   #36#23 = #36#23 + #191#17;
                                   #36#24 = #36#24 + #191#16;
                                   #36#28 = #36#28 + #191#22;
                                   #36#32 = #36#32 + #191#21;
                               |FINSI;
                           |FINSI;
                       |FINSI;
                   |FINSI;
               |SINO;
                   #36#3 = #36#3 + #191#16;
                   #36#4 = #36#4 + #191#17;
                   #36#5 = #36#5 + #191#18;
                   #36#6 = #36#6 + #191#19;
                   #36#7 = #36#7 + #191#20;
               |FINSI;
           |FINSI;

           #36#8 = #36#8 + #191#21;
           #36#9 = #36#9 + #191#22;

           |GRABA 020#36a;
        |FINSI;
     |FINSI;

||FIN ABDON
|FPRC;

|DEFBUCLE Man190Li_2;
     #191#1;
     ;
     #190#0,#190#1,#190#2,#190#3,#190#4,#190#5,#0#19,0000," ","  ",0;
     #190#0,#190#1,#190#2,#190#3,#190#4,#190#5,#0#20,9999,"z","zz",9;
     ;
     NULL, Man190Li_2;
|FIN;

|PROCESO Man190C;
     |SI nLectura = 0;
         |SI #190#4 ! 0;
             |SI #190#10 = "S";
                 nDComple = #190#4;
                 nHComple = #190#4;
             |SINO;
                 nHComple = #190#4;
             |FINSI;
         |SINO;
             nDComple = #190#4;
             nHComple = #190#4;
         |FINSI;
         |ACABA;
     |FINSI;

     codemp = "";
     nomrep = "";
     dnirep = "";
     carrep = "";
     nomemp = "";
     dniemp = "";
     domemp = "";
     munemp = "";
     cpoemp = "";
     proemp = "";

     nSwExiLab = 0;
     |HAZ LeeLaboral;
     |SI nSwExiLab = 0;
         |SI #107#1 = "S";
             |BUCLE agim0026;
         |SINO;
             nHayRepre = 0;
             |BUCLE agim0024;
             |SI nHayRepre = 0;
                 |BUCLE dsmom001;
                 |SI nHayRepre = 0;
                     nomrep  = #999#3;
                     carrep  = "TITULAR";
                     dnirep  = "";
                 |FINSI;
             |FINSI;
         |FINSI;
    |FINSI;

    codemp = #190#0; |QBF codemp; codemp = ("00000" + codemp) % -105;
    enCodCli = #190#0;
    |HAZ LeePersona;

    |SI enSwDeDonde = 1;
          nomemp = #715#2;
          dniemp = #715#3;
          aAlfa1 = #715#29; |QBF aAlfa1; |SI aAlfa1 ! ""; aAlfa1 = aAlfa1 + " "; |FINSI;
          aAlfa2 = #715#30; |QBF aAlfa2; aAlfa2 = aAlfa2 + " ";
          aAlfa3 = #715#31;
          domemp = aAlfa1 + aAlfa2 + aAlfa3;
          190sg = #715#29; 190cl = #715#30; 190nu = #715#31;
          190es = #715#32; 190pi = #715#33; 190pt = #715#34;
          190tl = #715#54;
          munemp = #715#37;
          aAlfa1 = #715#35;  |QBF aAlfa1; aAlfa1 = ("00" + aAlfa1) % -102;
          aAlfa2 = #715#36; |QBF aAlfa2; aAlfa2 = ("000" + aAlfa2) % -103;
          cpoemp = aAlfa1 + aAlfa2;
          proemp = #715#38;
     |SINO;
          nomemp = #715#1;
          dniemp = #715#13;
          aAlfa1 = #715#3; |QBF aAlfa1; |SI aAlfa1 ! ""; aAlfa1 = aAlfa1 + " "; |FINSI;
          aAlfa2 = #715#4; |QBF aAlfa2; aAlfa2 = aAlfa2 + " ";
          aAlfa3 = #715#5;
          domemp = aAlfa1 + aAlfa2 + aAlfa3;
          munemp = #715#11;
          aAlfa1 = #715#9;  |QBF aAlfa1; aAlfa1 = ("00" + aAlfa1) % -102;
          aAlfa2 = #715#10; |QBF aAlfa2; aAlfa2 = ("000" + aAlfa2) % -103;
          cpoemp = aAlfa1 + aAlfa2;
          proemp = #715#12;
          190sg = #715#3;  190cl = #715#4;  190nu = #715#5;
          190es = #715#6;  190pi = #715#7;  190pt = #715#8;
          190tl = #715#14;
     |FINSI;

     |SI dnirep = ""; dnirep = dniemp; |FINSI;

     periodo = #0#14;

     fprese = #0#16;
     aAlfa1 = #0#16;
     fecsys = aAlfa1 % 2;    || pasa la fecha a letras
     190fp = fecsys;
     fletra = fecsys % 11;   || coge la parte literal de la fecha
     aAlfa1 = munemp; |QBF aAlfa1;
     fletra = aAlfa1 + ", a " + fletra;  || une la localidad a la fecha literal
     |HAZ FechaPres;

     |SI #0#15 = 1;
         SwPrimer = 0;
         aElDni   = ""; aElNombre = "";
         aElDniEmp = ""; aElNomEmp = "";
         aElMunEmp = ""; aElProEmp = ""; aElCPEmp = "";
         aElSg     = ""; aElCl     = ""; aElNu     = "";
         aElEs     = ""; aElPi     = ""; aElPt     = "";
         aElTl     = ""; aElRe     = "";
         |BUCLE Man190Li;
         |SI SwPrimer = 1;
             |HAZ Imprimir;
         |FINSI;
     |FINSI;
     |SI #0#15 = 2; |O #0#15 = 3;
         |DELINDEX #36;
         SwPrimer = 0;
         aElDni   = "";
         aElNombre = "";
         aElDniEmp = ""; aElNomEmp = "";
         aElMunEmp = ""; aElProEmp = ""; aElCPEmp = "";
         aElSg     = ""; aElCl     = ""; aElNu     = "";
         aElEs     = ""; aElPi     = ""; aElPt     = "";
         aElTl     = ""; aElRe     = "";
         |ABRE #36;
         |BUCLE Man190Li_2;
         |CIERRA #36;
         |SI SwPrimer = 1;
             |SI #0#15 = 2; |HAZ Imprimir_2; |FINSI;
             |SI #0#15 = 3;
                |ABRE #36;
                |LEE 000#36p;
                |PARA; |SI FSalida = 0; |HACIENDO;
                   |DDEFECTO #dsmow093;
                   aAlfa = "|NC"; aAlfa = #dsmow036#aAlfa#; nCalc = aAlfa; nCalc = nCalc - 1;
                   |PARA nCont = 0; |SI nCont [ nCalc; |HACIENDO nCont = nCont + 1;
                      #dsmow093#nCont# = #36#nCont#;
                   |SIGUE;
                   #dsmow093#33 = #999#0;
                   #dsmow093#34 = nomrep;
                   #dsmow093#35 = dnirep;
                   #dsmow093#36 = carrep;
                   #dsmow093#37 = nomemp;
                   #dsmow093#38 = dniemp;
                   #dsmow093#39 = domemp;
                   #dsmow093#40 = munemp;
                   #dsmow093#41 = cpoemp;
                   #dsmow093#42 = proemp;
                   #dsmow093#43 = 190sg;
                   #dsmow093#44 = 190cl;
                   #dsmow093#45 = 190nu;
                   #dsmow093#46 = 190es;
                   #dsmow093#47 = 190pi;
                   #dsmow093#48 = 190pt;
                   #dsmow093#49 = 190tl;

                   eaCodNif = #36#0; |HAZ LeeNifs;

|SI nSwLaboral = 1; |ABRE #labtraba; |SELECT #2#labtraba;
                   #labtraba#7 = #93#0;
                   |LEE 000#labtraba.=;
                   |PARA; |SI FSalida = 0; |Y #labtraba#7 = #93#0; |HACIENDO;
                      |SI #labtraba#0 = #93#33; |SAL; |FINSI;
                      |LEE 000#labtraba.s;
                   |SIGUE;
                   |SI #labtraba#0 = #93#33; |Y FSalida = 0;
                      aAlfa = ("00000" + #labtraba#1) % -105; #dsmow093#51 = aAlfa;
                   |FINSI;
                   |SELECT #1#labtraba; |CIERRA #labtraba;
|FINSI;
                   aAlfa = ("00000" + #93#33) % -105; #dsmow093#50 = aAlfa;
                   #dsmow093#52 = #709#1;
                   #dsmow093#53 = #36#0;
                   aAlfa1 = #709#9; |QBF aAlfa1; |SI aAlfa1 ! ""; aAlfa1 = aAlfa1 + " "; |FINSI;
                   aAlfa2 = #709#2; |QBF aAlfa2; |SI aAlfa2 ! ""; aAlfa2 = aAlfa2 + " "; |FINSI;
                   aAlfa3 = #709#3;
                   #dsmow093#54 = aAlfa1 + aAlfa2 + aAlfa3;
                   #dsmow093#55 = #709#6;
                   #dsmow093#56 = #709#7;
                   aAlfa1 = #709#4; |QBF aAlfa1; aAlfa1 = ("00" + aAlfa1) % -102;
                   aAlfa2 = #709#5; |QBF aAlfa2; aAlfa2 = ("000" + aAlfa2) % -103;
                   #dsmow093#57 = aAlfa1 + aAlfa2;

                   |GRABA 020#dsmow093.n;
                   |LEE 000#36s;
                |SIGUE;
                |CIERRA #36;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE Man190C;
     #190#1;
     ;
     #999#0, #999#1, #999#2, #0#30, nDComple, 00;
     #999#0, #999#1, #999#2, #0#30, nHComple, 99;
     ;
     NULL, Man190C;
|FIN;

|RUTINA ClaveBaja998;
     #998#0 = #999#0;
     #998#1 = #999#1;
     #998#2 = #999#2;
     #998#8 = "            ";
|FRUT;

|RUTINA ClaveAlta998;
     #998#0 = #999#0;
     #998#1 = #999#1;
     #998#2 = #999#2;
     #998#8 = "zzzzzzzzzzzz";
|FRUT;

|PROCESO Imprime;
    |SI #0#34 = "S";
        |ABRE #998;
        #998#0 = #999#0;
        #998#1 = #999#1;
        #998#2 = #999#2;
        #998#8 = "            ";
        |LEE 001#998];
        |SI FSalida = 0; |Y #998#0 = #999#0; |Y #998#1 = #999#1; |Y #998#2 = #999#2;
            |CIERRA #998;
            |HAZ PonBoton;
            |ENTLINEAL #1#998, -4, 4, 22, 1, ClaveBaja998, ClaveAlta998;
            |HAZ QuitaBoton;
        |SINO;
            |CIERRA #998;
        |FINSI;
    |FINSI;

    enEmpresa = #999#0;
    enSwHay   = enSwHay + 1;

    nDComple  = 0;
    nHComple  = 99;

    nLectura  = 0;  |BUCLE Man190C;
    nLectura  = 1;  |BUCLE Man190C;
|FPRC;

|DEFBUCLE dsmow014M;
     #999#1;
     6;
     00000, 0000, 00, "S";
     99999, 9999, 99, "S";
     ;
     NULL, Imprime;
|FIN;

|| ///////////////////////////////////////////////////
|PROCESO CreoAux102;
   eaCodNif = #191#6;
   |SI #0#19 = "            ";
       nVale = 0;
       |PARA nCampo = 21; |SI nCampo [ 28; |HACIENDO nCampo = nCampo + 1;
             |SI #0nCampo ! "            ";
                 nVale = 1;
                 |SI #0nCampo = #191#6;
                      nVale = 2;
                      |SAL;
                  |FINSI;
              |FINSI;
        |SIGUE;
    |FINSI;
    |SI nVale = 1; |ACABA; |FINSI;

    |HAZ LeeNifs;
    |ABRE #998;
    #998#0 = #999#0;
    #998#1 = #999#1;
    #998#2 = #999#2;
    #998#8 = #191#6;
    |LEE 001#998=;
    |SI FSalida ! 0;
        #998#0 = #999#0;
        #998#1 = #999#1;
        #998#2 = #999#2;
        #998#3 = #999#3;
        #998#4 = #999#4;
        #998#5 = #999#5;
        #998#6 = #999#6;
        #998#7 = #999#7;
        #998#8 = #191#6;
        #998#9 = #709#1;
        |GRABA 020#998n;
    |FINSI;
    |CIERRA #998;
|FPRC;

|DEFBUCLE CreoAux102;
     #191#1;
     ;
     #190#0,#190#1,#190#2,#190#3,#190#4,#190#5,#0#19,0000," ","  ",0;
     #190#0,#190#1,#190#2,#190#3,#190#4,#190#5,#0#20,9999,"z","zz",9;
     ;
     NULL, CreoAux102;
|FIN;

|PROCESO CreoAux101;
    |BUCLE CreoAux102;
|FPRC;

|DEFBUCLE CreoAux101;
     #190#1;
     ;
     #999#0, #999#1, #999#2, #0#30, nDComple, 00;
     #999#0, #999#1, #999#2, #0#30, nHComple, 99;
     ;
     NULL, CreoAux101;
|FIN;

|PROCESO GrabaTempo;
     |SI enLabornet = 1;
          #labempre#0 = #4#0;
          |LEE 000#labempre.=;
          |SI FSalida ! 0;
               |ACABA;
          |FINSI;
     |FINSI;

    enCodCli = #4#0;
    |HAZ LeePersona;

    #999#0  = #4#0;
    #999#1  = #4#1;
    #999#2  = #4#2;
    |LEE 101#999=;
    |SI FSalida ! 0;
        |DDEFECTO #999;
        #999#0  = #4#0;
        #999#1  = #4#1;
        #999#2  = #4#2;
        |GRABA 020#999b;
    |FINSI;

    #999#3  = #715#1;
    #999#4  = "ANUAL";
    #999#5  = #0#30;
    #999#6  = "S";
    #999#7  = #4#4;
    |GRABA 020#999a;
    |LIBERA #999;

    nSwGraba = 1;

    |SI #0#34 = "S";
        |BUCLE CreoAux101;
    |FINSI;
|FPRC;

|DEFBUCLE dsmom004;
     #4#1;
     ;
     nDEmpresa, #0#14, #0#31, #0#30, 00;
     nHEmpresa, #0#14, #0#31, #0#30, 99;
     ;
     NULL, GrabaTempo;
|FIN;

|PROCESO IT3;  |TIPO 3;
     |SI #0#29 = "PESETAS";
         eaTMoneda = "Ptas.";
     |SINO;
         eaTMoneda = "Euros";
     |FINSI;
     eaMoneda = #0#29;

     informe =  "dsmoy020";
     |SI #0#15 = 2; informe = "dsmoy120"; |FINSI;
     |SI #0#15 = 3; informe = "dsmor120"; |FINSI;

     enEjer      = #0#14;        || A쨚 Calculo
     aAlfa1      = #0#14;
     aAlfa1      = aAlfa1 % -102;
     nEjer       = aAlfa1;       || Dos ultimos digitos del A쨚

     aFichero = ("ce" + Usuario) % 108;
     |NOME_DAT #999 aFichero;
     |ABRE #999;  |CIERRA #999;  |DELINDEX #999;

     aFichero = ("0w" + Usuario) % 108; |NOME_DAT #36 aFichero;
     aFichero = ("1w" + Usuario) % 108; |NOME_DAT #93 aFichero;
     aFichero = ("2w" + Usuario) % 108; |NOME_DAT #998 aFichero;
     |ABRE #998;  |CIERRA #998;  |DELINDEX #998;

     |ABRE #310;
     nSwGraba = 0;
     |ABRE #999;
     |SI #0#0 ! 0;
         nDEmpresa = #0#0;
         nHEmpresa = #0#1;
         |BUCLE dsmom004;
     |SINO;
         |PARA nPara1 = 2;  |SI nPara1 [ 13;  |HACIENDO nPara1 = nPara1 + 1;
               |SI #0nPara1 ! 0;
                   nDEmpresa = #0nPara1;
                   nHEmpresa = #0nPara1;
                   |BUCLE dsmom004;
               |FINSI;
         |SIGUE;
     |FINSI;
     |CIERRA #999;
     |CIERRA #310;

     |SI nSwGraba = 0;
          |MENAV "     Seleccion Vacia.";
          |DELINDEX #36;  |DELINDEX #93;
          |DELINDEX #998; |DELINDEX #999;
          |ACABA;
     |FINSI;

     |SI #0#15 < 3;
        |IMPRE 0;
        |SI FSalida ! 0;  |ACABA;  |FINSI;

        |INFOR informe;
        |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;
     |FINSI;

     |DELINDEX #93; |ABRE #93;
     |ABRE #190; enSwHay = 0;
     |BUCLE dsmow014M;
     |CIERRA #190; |CIERRA #93;
     |SI #0#15 ! 3;
        |FININF; |FINIMP;
     |SINO;
        Impresora = "CrystalReport";
        |IMPRE -1;
        |SI FSalida ! 0; |ACABA; |FINSI;

        aElDni = ""; SwPrimer = 0;
        aElNombre = "";
        aElDniEmp = ""; aElNomEmp = "";
        aElMunEmp = ""; aElProEmp = ""; aElCPEmp = "";
        aElSg     = ""; aElCl     = ""; aElNu     = "";
        aElEs     = ""; aElPi     = ""; aElPt     = "";
        aElTl     = ""; aElRe     = "";

|SI nSwLaboral = 1;         |ABRE #labtraba; |SELECT #2#labtraba; |FINSI;
        aClv1 = "Z"; aClv2 = ""; aClv3 = "";  ||La clave Z engloba las claves A, L, F, E y M
        nSwHay = 0; nSw = 1; |BUCLE Auxiliar; nSw = 0; SwPrimer = 0;
        |SI nSwHay > 0;
           nSw = 0;
           informe = "dsmor120"; |INFOR informe;
           aClv1 = "Z"; aClv2 = ""; aClv3 = "";  |BUCLE Auxiliar; |FININF;
        |FINSI;

        aClv1 = "G"; aClv2 = "H"; aClv3 = "I";
        nSwHay = 0; nSw = 1; |BUCLE Auxiliar; nSw = 0; SwPrimer = 0;
        |SI nSwHay > 0;
           informe = "dsmor121"; |INFOR informe;
           aClv1 = "G"; aClv2 = "H"; aClv3 = "I"; |BUCLE Auxiliar;
           |PRINT; |PIEINF; |FININF;
        |FINSI;

        aClv1 = "K"; aClv2 = "";  aClv3 = ""; aSubClv = "01";
        nSwHay = 0; nSw = 1; |BUCLE Auxiliar; nSw = 0; SwPrimer = 0;
        |SI nSwHay > 0;
           informe = "dsmor122"; |INFOR informe;
           aClv1 = "K"; aClv2 = "";  aClv3 = "";  |BUCLE Auxiliar; |FININF;
        |FINSI;

        aClv1 = "K"; aClv2 = "";  aClv3 = ""; aSubClv = "02";
        nSwHay = 0; nSw = 1; |BUCLE Auxiliar; nSw = 0; SwPrimer = 0;
        |SI nSwHay > 0;
           informe = "dsmor124"; |INFOR informe;
           aClv1 = "K"; aClv2 = "";  aClv3 = "";  |BUCLE Auxiliar; |FININF;
        |FINSI;
        aSubClv = "";

        aClv1 = "J"; aClv2 = "";  aClv3 = "";
        nSwHay = 0; nSw = 1; |BUCLE Auxiliar; nSw = 0; SwPrimer = 0;
        |SI nSwHay > 0;
           informe = "dsmor123"; |INFOR informe;
           aClv1 = "J"; aClv2 = "";  aClv3 = "";  |BUCLE Auxiliar; |FININF;
        |FINSI;

        |FINIMP;
|SI nSwLaboral = 1; |SELECT #1#labtraba; |CIERRA #labtraba; |FINSI;
     |FINSI;

     |DELINDEX #36;  |DELINDEX #dsmow093;
     |DELINDEX #998; |DELINDEX #999;
|FPRC;

||............... PROGRAMA ......................................

|PROGRAMA;
     eaParam = PARAMETRO; |QBF eaParam;
     |SI eaParam = "LABORNET";
          enLabornet = 1;
          |SI eaRutaFichLab ! "";
               |PATH_DAT #310 eaRutaFichLab;
          |FINSI;
     |FINSI;

     |SI eaParam = ""; |O eaParam = "LABORNET";
         eaParam = "190";
     |FINSI;

     #0#30 = eaParam;
     #0#31 = 99;

     |ABRE #107;
     |LEE 040#107p;
     |SI FSalida ! 0;
         |CIERRA #107;
         |SUB_EJECUTA_NP "dsmom107";
         |ABRE #107;
     |FINSI;

     |LEE 040#107p;
     |SI FSalida ! 0;  |DDEFECTO #107;  |FINSI;
     |CIERRA #107;

     nSwLaboral = 0;
     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "laboral/def/labempre.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
         nSwLaboral = 1;
     |FINSI;

     |SI enEmpresa ! 0;
         |DDEFECTO #0;
         #0#0  = enEmpresa;
         #0#1  = enEmpresa;
         #0#14 = enEjer;
         |HAZ IT3;
     |SINO;
         |CLS;
         |MANTE #0;
     |FINSI;
|FPRO;

|PROCESO OtraSeleccion;
 nVale = 0;
 |ABRE #998;
 #998#0 = #191#0;
 #998#1 = #191#1;
 #998#2 = #191#2;
 #998#8 = #191#6;
 |LEE 001#998=;
 |SI FSalida ! 0;
     nVale = 1;
 |SINO;
     |SI #998#6 = "N";
         nVale = 1;
     |FINSI;
 |FINSI;
 |CIERRA #998;
|FPRC;

/*
|PROCESO Imprimir_3;
   Impresora = "CrystalReport"; |IMPRE -1;
   |SI FSalida ! 0; |ACABA; |FINSI;

   aElDni = ""; aElNombre = "";
   aElDniEmp = ""; aElNomEmp = "";
   aElMunEmp = ""; aElProEmp = ""; aElCPEmp = "";
   aElSg     = ""; aElCl     = ""; aElNu     = "";
   aElEs     = ""; aElPi     = ""; aElPt     = "";
   aElTl     = ""; aElRe     = "";
   SwPrimer = 0;
   aElDni   = ""; aElNombre = "";
   aElDniEmp = ""; aElNomEmp = "";
   aElMunEmp = ""; aElProEmp = ""; aElCPEmp = "";
   aElSg     = ""; aElCl     = ""; aElNu     = "";
   aElEs     = ""; aElPi     = ""; aElPt     = "";
   aElTl     = ""; aElRe     = "";

   |ABRE #labtraba; |SELECT #2#labtraba;
   aClv1 = "Z"; aClv2 = ""; aClv3 = "";  ||La clave Z engloba las claves A, L, F, E y M
   nSwHay = 0; nSw = 1; |BUCLE Auxiliar; nSw = 0; SwPrimer = 0;
   |SI nSwHay > 0;
      nSw = 0;
      informe = "dsmor120"; |INFOR informe;
      ||aClv1 = "A"; aClv2 = "L"; aClv3 = "F";  |BUCLE Auxiliar; |FININF;
      aClv1 = "Z"; aClv2 = ""; aClv3 = "";  |BUCLE Auxiliar; |FININF;
   |FINSI;

   aClv1 = "G"; aClv2 = "H"; aClv3 = "I";
   nSwHay = 0; nSw = 1; |BUCLE Auxiliar; nSw = 0; SwPrimer = 0;
   |SI nSwHay > 0;
      informe = "dsmor121"; |INFOR informe;
      aClv1 = "G"; aClv2 = "H"; aClv3 = "I"; |BUCLE Auxiliar;
      |PRINT; |PIEINF; |FININF;
   |FINSI;

   aClv1 = "K"; aClv2 = "";  aClv3 = ""; aSubClv = "01";
   nSwHay = 0; nSw = 1; |BUCLE Auxiliar; nSw = 0; SwPrimer = 0;
   |SI nSwHay > 0;
      informe = "dsmor122"; |INFOR informe;
      aClv1 = "K"; aClv2 = "";  aClv3 = ""; |BUCLE Auxiliar; |FININF;
   |FINSI;

   aClv1 = "K"; aClv2 = "";  aClv3 = ""; aSubClv = "02";
   nSwHay = 0; nSw = 1; |BUCLE Auxiliar; nSw = 0; SwPrimer = 0;
   |SI nSwHay > 0;
      informe = "dsmor124"; |INFOR informe;
      aClv1 = "K"; aClv2 = "";  aClv3 = ""; |BUCLE Auxiliar; |FININF;
   |FINSI;
   aSubClv = "";

   aClv1 = "J"; aClv2 = "";  aClv3 = "";
   nSwHay = 0; nSw = 1; |BUCLE Auxiliar; nSw = 0; SwPrimer = 0;
   |SI nSwHay > 0;
      informe = "dsmor123"; |INFOR informe;
      aClv1 = "J"; aClv2 = "";  aClv3 = "";  |BUCLE Auxiliar; |FININF;
   |FINSI;

   |FINIMP;
   |SELECT #1#labtraba; |CIERRA #labtraba;
|FPRC;
*/
