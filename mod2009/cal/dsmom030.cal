|FICHEROS;
     :/modelos/def/dsmom030 #30;
     :/modelos/def/dsmom007 #7;
     :/modelos/def/dsmom031 #31,MANTE;
     :/modelos/def/dsmom034 #34;
     :/modelos/def/dsmom100 #100;
     :/modelos/def/dsmow020 #920,MANTE;
     :/modelos/def/dsmow021 #921,MANTE;
     :/modelos/def/dsmow022 #922,MANTE;
     :/modelos/def/dsmow023 #923,MANTE;
     :/modelos/def/dsmow048 #948,MANTE;
     :/modelos/def/dsmow095 #995,MANTE;

     :/basica/def/agitab99   #99;
     :/contagen/def/calibros #2;
     :/contagen/def/cacuenta #3;
     :/basica/def/agitab10   #98;

|FIN;

|VARIABLES;
     nOpcion        = 0;
     nBoton1        = 0;
     nBoton2        = 0;
     nBoton3        = 0;
     nBoton4        = 0;
     nBoton5        = 0;
     nBoton6        = 0;
     nSubBoton1     = 0;
     nSubBoton2     = 0;
     nSubBoton3     = 0;
     nSwSubBoton3   = 0;
     nSubOpcion     = 0;
     nSwDentro      = 0;
     nModo          = 0;
     nGrupo         = 0;
     nEntli         = 0;
     nCampo         = 0;
     nCampo1        = 0;

     aTecla         = "";
     aAlfa          = "";

     &enEmpresa     = 0;
     &enPerConta    = 0;
     &enActividad   = 0;
     &aPathConta    = "";
     &salidas       = 0;
     &eaCuenta      = "";


     &enConcepOri = 0;
     &enConcepDes = 0;
     &swUno       = 0;

     aFichero     = "";
     nPara1       = 0;
     nTecla       = 0;

     &eaExtension = "";
     &eaPrograma  = "";
|FIN;

|| ------------------------- Proceso dsmow020

|PROCESO Tipo12w020;  |TIPO 12;
     || Este proceso sirve para que el endatos que se hace en el
     || calculo dsam0000 no pregunte Correcto S/N
     || POR LO TANTO NO LO QUITEIS !!!!!!
|FPRC;

|PROCESO Tipo0w020;  |TIPO 0;
     |SI FSalida = 10;  nOpcion = 1;  |PTEC 806;  |FINSI;
     |SI FSalida = 11;  nOpcion = 2;  |PTEC 806;  |FINSI;
     |SI FSalida = 12;  nOpcion = 3;  |PTEC 806;  |FINSI;
     |SI FSalida = 13;  nOpcion = 4;  |PTEC 806;  |FINSI;
     |SI FSalida = 14;  nOpcion = 5;  |PTEC 806;  |FINSI;
|FPRC;

|PROCESO ModFiltros;  |TIPO 0;
     |SI nOpcion ! 2;  |ACABA;  |FINSI;

     |PARA nCampo = 12;  |SI nCampo [ 31;  |HACIENDO nCampo = nCampo + 1;
           |C_M #920nCampo, 1, "N";
     |SIGUE;

     |SI Campo = 4;  |O Campo = 6;
         |SI #920Campo = "S";
             #920#5 = "N";  |PDEFECTO #920, 17, 22;
             #920#7 = "N";  |PDEFECTO #920, 27, 32;

             |PARA nCampo = 12;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
                   |C_M #920nCampo, 1, "S";
             |SIGUE;

             |PARA nCampo = 22;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
                   |C_M #920nCampo, 1, "S";
             |SIGUE;
         |FINSI;
     |FINSI;

     |SI Campo = 5;  |O Campo = 7;
         |SI #920Campo = "S";
             #920#4 = "N";  |PDEFECTO #920, 12, 17;
             #920#6 = "N";  |PDEFECTO #920, 22, 27;

             |PARA nCampo = 17;  |SI nCampo [ 21;  |HACIENDO nCampo = nCampo + 1;
                   |C_M #920nCampo, 1, "S";
             |SIGUE;

             |PARA nCampo = 27;  |SI nCampo [ 31;  |HACIENDO nCampo = nCampo + 1;
                   |C_M #920nCampo, 1, "S";
             |SIGUE;
         |FINSI;
     |FINSI;

     |PINTA #920#4;   |PINTA #920#5;   |PINTA #920#6;   |PINTA #920#7;
     |PINTA #920#12;  |PINTA #920#13;  |PINTA #920#14;  |PINTA #920#15;
     |PINTA #920#16;  |PINTA #920#17;  |PINTA #920#18;  |PINTA #920#19;
     |PINTA #920#20;  |PINTA #920#21;  |PINTA #920#22;  |PINTA #920#23;
     |PINTA #920#24;  |PINTA #920#25;  |PINTA #920#26;  |PINTA #920#27;
     |PINTA #920#28;  |PINTA #920#29;  |PINTA #920#30;  |PINTA #920#31;
|FPRC;

|PROCESO FiltraPartida; |TIPO 6;
     eaCuenta = #dsmow020#Campo#;
     salidas  = FSalida;
     |HAZ FiltraPuntos;
     #dsmow020#Campo# = eaCuenta;
     |PINTA #dsmow020#Campo#;
|FPRC;

|| ------------------------- Proceso dsmow021

|PROCESO Tipo12w021;  |TIPO 12;
     || Este proceso sirve para que el endatos que se hace en el
     || calculo dsam0000 no pregunte Correcto S/N
     || POR LO TANTO NO LO QUITEIS !!!!!!
|FPRC;

|PROCESO Tipo7w021; |TIPO 7;
     |ESTADO_CONTROL nSubBoton3, "ENABLE"; nSwSubBoton3 = 1;
|FPRC;

|PROCESO Tipo0w021;  |TIPO 0;
     |SI FSalida = 10;  nOpcion    = 1;    |PTEC 806;  |FINSI;
     |SI FSalida = 11;  nOpcion    = 2;    |PTEC 806;  |FINSI;
     |SI FSalida = 12;  nOpcion    = 3;    |PTEC 806;  |FINSI;
     |SI FSalida = 13;  nOpcion    = 4;    |PTEC 806;  |FINSI;
     |SI FSalida = 14;  nOpcion    = 5;    |PTEC 806;  |FINSI;
     |SI FSalida = 16;  nSubOpcion = 2;    |PTEC 806;  |FINSI;
     |SI Campo = 0;
         |SI FSalida = 17;
             |ESTADO_CONTROL nSubBoton3, "DISABLE"; nSwSubBoton3 = 0;
             |HAZ MasRegIVA;
         |SINO;
             |ESTADO_CONTROL nSubBoton3, "DISABLE"; nSwSubBoton3 = 0;
         |FINSI;
     |FINSI;
|FPRC;

|RUTINA ClaveBaja7;
      #7#0 = 1;
      #7#1 = 00;
      #7#6 = nGrupo;
      #7#7 = nGrupo;
|FRUT;

|RUTINA ClaveAlta7;
      #7#0 = 9;
      #7#1 = 99;
      #7#6 = nGrupo;
      #7#7 = nGrupo;
|FRUT;

|PROCESO SacaLineal;
     |SI nOpcion ! 3;  |ACABA;  |FINSI;

     |SI FSalida ! 18;  |ACABA;  |FINSI;

     nGrupo = 0;
     |SI Campo = 2;   nGrupo = 1;  |FINSI;
     |SI Campo = 4;   nGrupo = 2;  |FINSI;
     |SI Campo = 6;   nGrupo = 8;  |FINSI;
     |SI Campo = 8;   nGrupo = 9;  |FINSI;
     |SI Campo = 10;  nGrupo = 3;  |FINSI;
     |SI Campo = 12;  nGrupo = 4;  |FINSI;

     |SI nGrupo = 0;  |ACABA;  |FINSI;

     |ABRE #7;
     |SI nEntli = 1;
         |CONSULTA_F_CLAVE #2#7, ClaveBaja7, ClaveAlta7;
     |SINO;
         |CONSULTA_F_CLAVE #3#7, ClaveBaja7, ClaveAlta7;
     |FINSI;

     |SI FSalida = 0;
         #921Campo    = #7#1;  |PINTA #921Campo;
     |FINSI;

     |CIERRA #7;
|FPRC;

|PROCESO LeeAgrupa;
     |SI nOpcion ! 3;  |ACABA;  |FINSI;

     nCampo1    = Campo + 1;
     |SI #921Campo = 0;
         #921nCampo1 = "";   |PINTA #921nCampo1;
         |ACABA;
     |FINSI;

     nGrupo = 0;
     |SI Campo = 2;   nGrupo = 1;  |FINSI;
     |SI Campo = 4;   nGrupo = 2;  |FINSI;
     |SI Campo = 6;   nGrupo = 8;  |FINSI;
     |SI Campo = 8;   nGrupo = 9;  |FINSI;
     |SI Campo = 10;  nGrupo = 3;  |FINSI;
     |SI Campo = 12;  nGrupo = 4;  |FINSI;

     |SI nGrupo = 0;  |ACABA;  |FINSI;

     |ABRE #7;
 |SI #921#16 = "S"; |Y #921Campo = 11; |Y Campo = 4;
     |SELECT #1#7;
     #7#0 = nGrupo;
     #7#1 = #921Campo;
     |LEE 040#7=;
     |SI FSalida ! 0;
         |MENAV "     No existe Agrupacion";
         |ERROR;
     |SINO;
         #921nCampo1 = #7#2;   |PINTA #921nCampo1;
     |FINSI;

 |SINO;
     |SI nEntli = 1;
         |SELECT #2#7;
         #7#6 = nGrupo;
         #7#0 = nGrupo;
         #7#1 = #921Campo;
         |LEE 040#7=;
         |SI FSalida ! 0;
             |MENAV "     No existe Agrupacion";
             |ERROR;
         |SINO;
             #921nCampo1 = #7#2;   |PINTA #921nCampo1;
         |FINSI;
     |SINO;
         |SELECT #3#7;
         #7#7 = nGrupo;
         #7#0 = nGrupo;
         #7#1 = #921Campo;
         |LEE 040#7=;
         |SI FSalida ! 0;
             |MENAV "     No existe Agrupacion";
             |ERROR;
         |SINO;
             #921nCampo1 = #7#2;   |PINTA #921nCampo1;
         |FINSI;
     |FINSI;
 |FINSI;
     |CIERRA #7;
|FPRC;

|PROCESO Modifica;
     |SI nOpcion ! 3;  |ACABA;  |FINSI;

     |SI Campo = 0;
         nTecla = FSalida;
         |HAZ CuidoTabla;
         FSalida = nTecla;
     |FINSI;

     |C_M #921#2,  1, "N";
     |C_M #921#4,  1, "N";
     |C_M #921#6,  1, "N";
     |C_M #921#8,  1, "N";
     |C_M #921#10, 1, "N";
     |C_M #921#12, 1, "N";

     nEntli = 1;
     |SI #921#0 = 1;
         #921#2  = 0;  #921#3  = "";  |PINTA #921#2;   |PINTA #921#3;
         |SI #921#16 = "N";
             #921#4  = 0;  #921#5  = "";  |PINTA #921#4;   |PINTA #921#5;
         |FINSI;
         #921#6  = 0;  #921#7  = "";  |PINTA #921#6;   |PINTA #921#7;
         #921#8  = 0;  #921#9  = "";  |PINTA #921#8;   |PINTA #921#9;
         #921#10 = 0;  #921#11 = "";  |PINTA #921#10;  |PINTA #921#11;
         #921#12 = 0;  #921#13 = "";  |PINTA #921#12;  |PINTA #921#13;
     |FINSI;

     |SI #921#0 = 2;
         |C_M #921#2,   1, "S";
         |C_M #921#4,   1, "S";
         |C_M #921#10,  1, "S";
         |C_M #921#12,  1, "S";
     |FINSI;

     |SI #921#0 = 3;
     |FINSI;

     |SI #921#0 = 4;
         |C_M #921#2,   1, "S";
         |C_M #921#10,  1, "S";
     |FINSI;

     |SI #921#0 = 5;
         |C_M #921#2,   1, "S";
         |C_M #921#10,  1, "S";
     |FINSI;

     |SI #921#0 = 6;
         |C_M #921#2,   1, "S";
         |C_M #921#10,  1, "S";
     |FINSI;

     |SI #921#0 = 7;
         |C_M #921#2,   1, "S";
         |C_M #921#10,  1, "S";
     |FINSI;

     |SI #921#0 = 8;
         |C_M #921#2,   1, "S";
         |C_M #921#10,  1, "S";
     |FINSI;

     |SI #921#0 = 9;
     |FINSI;

     |SI #921#0 = 10;
         |C_M #921#6,   1, "S";
         |C_M #921#8,   1, "S";
         |C_M #921#10,  1, "S";
         |C_M #921#12,  1, "S";
     |FINSI;

     |SI #921#0 = 11;
         |C_M #921#10,  1, "S";
     |FINSI;

     |SI #921#0 = 12;
         |C_M #921#2,   1, "S";
         |C_M #921#4,   1, "S";
         |C_M #921#10,  1, "S";
         |C_M #921#12,  1, "S";
         nEntli = 2;
     |FINSI;

     |SI #921#0 = 13;
         |C_M #921#2,   1, "S";
         |C_M #921#4,   1, "S";
         |C_M #921#10,  1, "S";
         |C_M #921#12,  1, "S";
         nEntli = 2;
     |FINSI;
|FPRC;

|PROCESO DespuesPror; |TIPO 0;
  |SI #30#0 ] 800; |Y #30#0 [ 899;
      |SI #921#15 = "U";
          |C_M #921#16,1,"N";
           #921#16 = "N"; |PINTA #921#16;
      |SINO;
          |C_M #921#16,1,"S";
      |FINSI;
  |SINO;
      |SI #921#15 = "U";
          |MENAV "    Opcion No Validad. No es un concepto de Subvencion (800 a 899)";
          |ERROR;
      |FINSI;
      |C_M #921#16,1,"N";
      #921#16 = "N"; |PINTA #921#16;
  |FINSI;
|FPRC;

|PROCESO LaSubvencion;
     |SI nOpcion ! 3;  |ACABA;  |FINSI;

     |SI #921Campo = "N"; |ACABA; |FINSI;

     |PUSHV 1401 1780;
     |CUADRO 1414 1770;
     |ATRI R;
     |PINTA 1415, " RECUERDE, ESTA INTRODUCIENDO CONCEPTO DE SUBVENCION   ";
     |PINTA 1515, " Casilla  : 1 a 7  -Resta en casilla y aplica prorrata ";
     |PINTA 1615, " Soportado: 0 o 11 - Aplica prorrata y Resta al total  ";
     |ATRI 0;

     |C_M #921#4,  1, "S";
     |PAUSA;
     |POPV;
|FPRC;

|| ------------------------- Proceso dsmom031

|PROCESO RecogeLibro;
     #99#0 = #31#1;
     |LEE 000#99=;
     |SI FSalida = 0;
         #31#2 = #99#1; |PINTA #31#2;
     |SINO;
         |MENAV "    Libro inexistente";
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO Tipo11m031;  |TIPO 11;
     |SI FSalida = 10;  nOpcion    = 1;  |PTEC 806;  |PTEC 806;  |FINSI;
     |SI FSalida = 11;  nOpcion    = 2;  |PTEC 806;  |PTEC 806;  |FINSI;
     |SI FSalida = 13;  nOpcion    = 4;  |PTEC 806;  |PTEC 806;  |FINSI;
     |SI FSalida = 14;  nOpcion    = 5;  |PTEC 806;  |PTEC 806;  |FINSI;
     |SI FSalida = 15;  nSubOpcion = 1;  |PTEC 806;  |PTEC 806;  |FINSI;
|FPRC;

|| ------------------------- Proceso dsmow022

|PROCESO Tipo12w022;  |TIPO 12;
     || Este proceso sirve para que el endatos que se hace en el
     || calculo dsam0000 no pregunte Correcto S/N
     || POR LO TANTO NO LO QUITEIS !!!!!!
|FPRC;

|PROCESO Tipo0w022;  |TIPO 0;
     |SI FSalida = 10;  nOpcion = 1;  |PTEC 806;  |FINSI;
     |SI FSalida = 11;  nOpcion = 2;  |PTEC 806;  |FINSI;
     |SI FSalida = 12;  nOpcion = 3;  |PTEC 806;  |FINSI;
     |SI FSalida = 13;  nOpcion = 4;  |PTEC 806;  |FINSI;
     |SI FSalida = 14;  nOpcion = 5;  |PTEC 806;  |FINSI;
|FPRC;


|RUTINA ClaveBaja34;
     #34#0 = 1;
|FRUT;

|RUTINA ClaveAlta34;
     #34#0 = 99;
|FRUT;

|PROCESO SacaGrupos;
     |SI #922Campo = 0;
         nCampo1      = Campo + 1;
         #922nCampo1  = "";  |PINTA #922nCampo1;
     |FINSI;

     |SI nOpcion ! 4;  |ACABA;  |FINSI;

     |SI FSalida = 18;

         |CAMPO_ANCHO #34#1, 1, 100;

         |ABRE #34;

         |CONSULTA_F_CLAVE #1#34, ClaveBaja34, ClaveAlta34;
         |SI FSalida = 0;
             #922Campo = #34#0;  |PINTA #922Campo;
         |FINSI;
     |SINO;
         |ABRE #34;
         #34#0 = #922Campo;
         |LEE 001#34=;
     |FINSI;

     |SI FSalida = 0;
         nCampo1      = Campo + 1;
         #922nCampo1  = #34#1;  |PINTA #922nCampo1;
         #922#4       = #34#2;  |PINTA #922#4;
         #922#5       = #34#3;  |PINTA #922#5;
     |FINSI;

     |CIERRA #34;
|FPRC;

|PROCESO FiltraModelo;
     |SI nOpcion ! 4;  |ACABA;  |FINSI;

     |SI #922#0 = 0;  |ACABA;  |FINSI;

     aAlfa = #922#0;
     aAlfa = aAlfa % 102;
     |SI aAlfa ! "18";  |Y aAlfa ! "19";
         |MENAV "      Modelo Incorrecto.";
         |ERROR;
         #922#0 = 0;  |PINTA #922#0;
     |FINSI;
|FPRC;

|| ------------------------- Proceso dsmow023

|PROCESO Tipo12w023;  |TIPO 12;
     || Este proceso sirve para que el endatos que se hace en el
     || calculo dsam0000 no pregunte Correcto S/N
     || POR LO TANTO NO LO QUITEIS !!!!!!
|FPRC;

|PROCESO Tipo0w023;  |TIPO 0;
     |SI FSalida = 10;  nOpcion = 1;  |PTEC 806;  |FINSI;
     |SI FSalida = 11;  nOpcion = 2;  |PTEC 806;  |FINSI;
     |SI FSalida = 12;  nOpcion = 3;  |PTEC 806;  |FINSI;
     |SI FSalida = 13;  nOpcion = 4;  |PTEC 806;  |FINSI;
     |SI FSalida = 14;  nOpcion = 5;  |PTEC 806;  |FINSI;
|FPRC;

|PROCESO FiltraX;
     |SI nOpcion ! 5;  |ACABA;  |FINSI;

     |SI Campo = 0;
         |SI #923#0 = "X";
             #923#1 = "";
             #923#2 = "";
             #923#3 = "";
             #923#4 = "";
             #923#5 = "";
             #923#7 = "";
             #923#8 = "";
             #923#9 = "";
         |FINSI;
     |FINSI;

     |SI Campo = 1;
         |SI #923#1 = "X";
             #923#0 = "";
             #923#2 = "";
             #923#3 = "";
             #923#4 = "";
             #923#5 = "";
             #923#7 = "";
             #923#8 = "";
             #923#9 = "";
         |FINSI;
     |FINSI;

     |SI Campo = 2;
         |SI #923#2 = "X";
             #923#0 = "";
             #923#1 = "";
             #923#3 = "";
             #923#4 = "";
             #923#5 = "";
             #923#7 = "";
             #923#8 = "";
             #923#9 = "";
         |FINSI;
     |FINSI;

     |SI Campo = 3;
         |SI #923#3 = "X";
             #923#0 = "";
             #923#1 = "";
             #923#2 = "";
             #923#4 = "";
             #923#5 = "";
             #923#7 = "";
             #923#8 = "";
             #923#9 = "";
         |FINSI;
     |FINSI;

     |SI Campo = 4;
         |SI #923#4 = "X";
             #923#0 = "";
             #923#1 = "";
             #923#2 = "";
             #923#3 = "";
             #923#5 = "";
             #923#7 = "";
             #923#8 = "";
             #923#9 = "";
         |FINSI;
     |FINSI;

     |SI Campo = 5;
         |SI #923#5 = "X";
             #923#0 = "";
             #923#1 = "";
             #923#2 = "";
             #923#3 = "";
             #923#4 = "";
             #923#6 = "";
             #923#7 = "";
             #923#8 = "";
             #923#9 = "";
         |FINSI;
     |FINSI;

     |SI Campo = 6;
         |SI #923#6 = "X";
             #923#5 = "";
             #923#7 = "";
         |FINSI;
     |FINSI;

     |SI Campo = 7;
         |SI #923#7 = "X";
             #923#0 = "";
             #923#1 = "";
             #923#2 = "";
             #923#3 = "";
             #923#4 = "";
             #923#5 = "";
             #923#6 = "";
             #923#8 = "";
             #923#9 = "";
         |FINSI;
     |FINSI;

     |SI Campo = 8;
         |SI #923#8 = "X";
             #923#0 = "";
             #923#1 = "";
             #923#2 = "";
             #923#3 = "";
             #923#4 = "";
             #923#5 = "";
             #923#6 = "";
             #923#7 = "";
             #923#9 = "";
         |FINSI;
     |FINSI;

     |SI Campo = 9;
         |SI #923#9 = "X";
             #923#0 = "";
             #923#1 = "";
             #923#2 = "";
             #923#3 = "";
             #923#4 = "";
             #923#5 = "";
             #923#6 = "";
             #923#7 = "";
             #923#8 = "";
         |FINSI;
     |FINSI;

     |PINTA #923#0;
     |PINTA #923#1;
     |PINTA #923#2;
     |PINTA #923#3;
     |PINTA #923#4;
     |PINTA #923#5;
     |PINTA #923#6;
     |PINTA #923#7;
     |PINTA #923#8;
     |PINTA #923#9;
|FPRC;

|| ------------------------- Proceso dsmom000

|PROCESO ModGrupo;  |TIPO 0;
     |SI Campo = 4;
         |SI #30#4 = "S"; #30#5 = "N"; #30#6 = "N"; #30#7 = "N"; #30#8 = "N"; #30#9 = "N"; |FINSI;
     |FINSI;

     |SI Campo = 5;
         |SI #30#5 = "S"; #30#4 = "N"; #30#6 = "N"; #30#7 = "N"; #30#8 = "N"; #30#9 = "N"; |FINSI;
         |SI #30#5 = "G"; #30#4 = "N"; #30#6 = "N"; #30#7 = "N"; #30#8 = "N"; #30#9 = "S"; |FINSI;
     |FINSI;

     |SI Campo = 6;
         |SI #30#6 = "S"; #30#4 = "N"; #30#5 = "N"; #30#7 = "N"; #30#8 = "N"; #30#9 = "N"; |FINSI;
     |FINSI;

     |SI Campo = 7;
         |SI #30#7 = "S"; #30#4 = "N"; #30#5 = "N"; #30#6 = "N"; #30#8 = "N"; #30#9 = "N"; |FINSI;
     |FINSI;

     |SI Campo = 8;
         |SI #30#8 = "S"; #30#4 = "N"; #30#5 = "N"; #30#6 = "N"; #30#7 = "N"; #30#9 = "N"; |FINSI;
     |FINSI;

     |SI Campo = 9;
         |SI #30#9 = "S";
             #30#4 = "N"; #30#6 = "N"; #30#7 = "N"; #30#8 = "N";
             |SI #30#5 = "S"; #30#5 = "N"; |FINSI;
         |FINSI;
     |FINSI;

     |PINTA #30#4;
     |PINTA #30#5;
     |PINTA #30#6;
     |PINTA #30#7;
     |PINTA #30#8;
     |PINTA #30#9;
|FPRC;

|PROCESO ModSubDepar;  |TIPO 0;
     |SI Campo = 10;
         |SI #30#10 = "S"; #30#11 = "N";  |FINSI;
     |FINSI;

     |SI Campo = 11;
         |SI #30#11 = "S"; #30#10 = "N";  |FINSI;
     |FINSI;

     |PINTA #30#10;
     |PINTA #30#11;
|FPRC;

|PROCESO DatosConta;
     |PUSHV 1401 2380;
     |PINPA #0#920;

     |PARA nCampo = 0;  |SI nCampo [ 11;  |HACIENDO nCampo = nCampo + 1;
           nCampo1 = nCampo + 12;
           #920nCampo = #30nCampo1;
     |SIGUE;

     |PARA nCampo = 12;  |SI nCampo [ 31;  |HACIENDO nCampo = nCampo + 1;
           nCampo1 = nCampo + 40;
           #920nCampo = #30nCampo1;
     |SIGUE;

     |PINDA #0#920;
     |SI nModo ! 4;
         |ENDATOS #1#920;
         |SI FSalida = 0;
             |PARA nCampo = 0;  |SI nCampo [ 11;  |HACIENDO nCampo = nCampo + 1;
                   nCampo1 = nCampo + 12;
                   #30nCampo1 = #920nCampo;
             |SIGUE;

             |PARA nCampo = 12;  |SI nCampo [ 31;  |HACIENDO nCampo = nCampo + 1;
                   nCampo1 = nCampo + 40;
                   #30nCampo1 = #920nCampo;
             |SIGUE;
          |FINSI;
     |SINO;
         |LEETECLA aTecla;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO Opcion2;
     |ABRE #100;
     |LEE 040#100p;
     |SI FSalida ! 0;
         |CIERRA #100;
         |MENAV "    No esta configurada las Empresas Maestras de Contabilidad";
         nOpcion = 1;
         |ACABA;
     |FINSI;
     |CIERRA #100;

     enEmpresa  = #100#1;
     enPerConta = #100#2;
     |HAZ LeeEmpConta;

     |PATH_DAT #2 aPathConta;
     |PATH_DAT #3 aPathConta;

     |ESTADO_CONTROL nBoton2, "DISABLE";

     |PARA;  |SI;  |HACIENDO;
          |SI nOpcion = 1;  |SAL;  |FINSI;
          |SI nOpcion = 3;  |SAL;  |FINSI;
          |SI nOpcion = 4;  |SAL;  |FINSI;
          |SI nOpcion = 5;  |SAL;  |FINSI;

          |HAZ DatosConta;
     |SIGUE;

     |ESTADO_CONTROL nBoton2, "ENABLE";
|FPRC;

|PROCESO PulsoSubBoton1;
     nSubOpcion = 1;
     |PTEC 806;
|FPRC;

|PROCESO PulsoSubBoton2;
     nSubOpcion = 2;
     |PTEC 806;
|FPRC;

|PROCESO PulsoSubBoton3;
     |SI nSwSubBoton3 = 1;
         |PTEC 831;
     |FINSI;
|FPRC;

|RUTINA ClaveBaja31;
     #31#0 = #30#0;
     #31#1 = 901;
|FRUT;

|RUTINA ClaveAlta31;
     #31#0 = #30#0;
     #31#1 = 999;
|FRUT;


|PROCESO LinealLibro;
     nSubOpcion = 2;

     |PUSHV 1401 2380;
     |ESTADO_CONTROL nSubBoton1, "ENABLE";
     |ESTADO_CONTROL nSubBoton2, "DISABLE";

     |ABRET #99;
     |SI nModo ! 4;
         |ENTLINEAL #1#31, -2, 2, 22, 1, ClaveBaja31, ClaveAlta31;
     |SINO;
         |ENTLINEAL #1#31, -2, 4, 22, 1, ClaveBaja31, ClaveAlta31;
     |FINSI;
     |CIERRAT #99;

     |POPV;

     |ESTADO_CONTROL nSubBoton1, "DISABLE";
     |ESTADO_CONTROL nSubBoton2, "ENABLE";
|FPRC;

|RUTINA ClaveBaja95;
     #995#0 = #30#0;
     #995#1 = 01;
|FRUT;

|RUTINA ClaveAlta95;
     #995#0 = #30#0;
     #995#1 = 13;
|FRUT;

|PROCESO MiroCampo24; |TIPO 0;
 nModo = (FEntrada / 100) ! 0;
 |SI #995#1 = #921#0; |Y nModo = 1;
     |MENAV "    Regimen de IVA Ya Informado ";
     |ERROR;
 |FINSI;
|FPRC;

|PROCESO MasRegIVA;
     |PUSHV 1601 2380;
     |ESTADO_CONTROL nSubBoton2, "DISABLE";
     |SI nModo ! 4;
         |ENTLINEAL #1#995, -2, 2, 22, 1, ClaveBaja95, ClaveAlta95;
     |SINO;
         |ENTLINEAL #1#995, -2, 4, 22, 1, ClaveBaja95, ClaveAlta95;
     |FINSI;
     |POPV;
     |ESTADO_CONTROL nSubBoton2, "ENABLE";
|FPRC;

|PROCESO CasillaIva;

     nSubOpcion = 1;
     |ESTADO_CONTROL nSubBoton1, "DISABLE";
     |ESTADO_CONTROL nSubBoton2, "ENABLE";

     |PUSHV 1401 2380;
     |PINPA #0#921;

     nSwSubBoton3 = 0;
     |CONTROL_SIMPLE 0, "BOTON, F9 Mas...", 1541, 1548, PulsoSubBoton3;
     nSubBoton3 = FSalida;

     #921#0  = #30#24;  #921#1  = #30#25;
     #921#2  = #30#26;  #921#3  = #30#27;
     #921#4  = #30#28;  #921#5  = #30#29;
     #921#6  = #30#30;  #921#7  = #30#31;
     #921#8  = #30#32;  #921#9  = #30#33;
     #921#10 = #30#34;  #921#11 = #30#35;
     #921#12 = #30#36;  #921#13 = #30#37;
     #921#14 = #30#72;  #921#15 = #30#73;
     #921#16 = #30#74;  #921#17 = #30#90;
     |HAZ CreoTabla;

     |PINDA #0#921;
     |SI nModo ! 4;
         |ENDATOS #1#921;
         |SI FSalida = 0;
             #30#24 = #921#0;   #30#25 = #921#1;
             #30#26 = #921#2;   #30#27 = #921#3;
             #30#28 = #921#4;   #30#29 = #921#5;
             #30#30 = #921#6;   #30#31 = #921#7;
             #30#32 = #921#8;   #30#33 = #921#9;
             #30#34 = #921#10;  #30#35 = #921#11;
             #30#36 = #921#12;  #30#37 = #921#13;
             #30#72 = #921#14;  #30#73 = #921#15;
             #30#74 = #921#16;  #30#90 = #921#17;
             |HAZ RecojoTabla;
         |FINSI;
     |SINO;
         |LEETECLA aTecla;
     |FINSI;

     |FIN_CONTROL_WINDOWS nSubBoton3;
     |POPV;

|FPRC;


|PROCESO Opcion3;
     |SI #30#4 ! "S";
         |MENAV "    El Concepto no es de I.V.A.";
         nSubOpcion = 2;
         || ... nOpcion = 1;
         || ... |ACABA;
     |FINSI;

     |ESTADO_CONTROL nBoton3, "DISABLE";

     |CONTROL_SIMPLE 0, "BOTON,F7 Casilla I.V.A. Declaracion Resumen Anual", 1301, 1343, PulsoSubBoton1;
     nSubBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,F8 Libros Oficiales de I.V.A", 1345, 1372, PulsoSubBoton2;
     nSubBoton2 = FSalida;

     nSubOpcion = 1;
     |PARA;  |SI;  |HACIENDO;
          |SI #30#4 ! "S"; nSubOpcion = 2; |FINSI;
          |SI nOpcion = 1;  |SAL;  |FINSI;
          |SI nOpcion = 2;  |SAL;  |FINSI;
          |SI nOpcion = 4;  |SAL;  |FINSI;
          |SI nOpcion = 5;  |SAL;  |FINSI;

          |SI nSubOpcion = 1;  |HAZ CasillaIva;   |FINSI;
          |SI nSubOpcion = 2;  |HAZ LinealLibro;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nSubBoton1;
     |FIN_CONTROL_WINDOWS nSubBoton2;

     |ESTADO_CONTROL nBoton3, "ENABLE";

     |PULSATECLA;
|FPRC;

|PROCESO DatosIRPF;
    |ABRE #34;
    |LEE 040#34u;
    |SI FSalida ! 0;  |O #34#0 < 59;
        |CIERRA #34;
        eaExtension = "mod";
        eaPrograma  = "dsmom034";
        |SUB_EJECUTA_NP ":basica/dspatron";
    |SINO;
        |CIERRA #34;
    |FINSI;


     |PUSHV 1401 2380;
     |PINPA #0#922;
     #922#0  = #30#38;  #922#1  = #30#39;  #922#2  = #30#40;  #922#3  = #30#41;
     #922#4  = #30#42;  #922#5  = #30#43;

     |PINDA #0#922;
     |SI nModo ! 4;
         |ENDATOS #1#922;
         |SI FSalida = 0;
             #30#38 = #922#0;  #30#39 = #922#1;  #30#40 = #922#2;   #30#41 = #922#3;
             #30#42 = #922#4;  #30#43 = #922#5;
          |FINSI;
     |SINO;
         |LEETECLA aTecla;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO Opcion4;
     |SI #30#5 ! "S";
         |MENAV "    El Concepto no es de I.R.P.F.";
         nOpcion = 1;
         |ACABA;
     |FINSI;

     |ESTADO_CONTROL nBoton4, "DISABLE";

     |PARA;  |SI;  |HACIENDO;
          |SI nOpcion = 1;  |SAL;  |FINSI;
          |SI nOpcion = 2;  |SAL;  |FINSI;
          |SI nOpcion = 3;  |SAL;  |FINSI;
          |SI nOpcion = 5;  |SAL;  |FINSI;

          |HAZ DatosIRPF;
     |SIGUE;

     |ESTADO_CONTROL nBoton4, "ENABLE";
|FPRC;

|PROCESO Datos347;
     |PUSHV 1301 2380;
     |PINPA #0#923;
     #923#0  = #30#44;  #923#1  = #30#45;  #923#2  = #30#46;  #923#3  = #30#47;
     #923#4  = #30#48;  #923#5  = #30#49;  #923#6  = #30#50;  #923#7  = #30#51;
     #923#8  = #30#76;  #923#9  = #30#77;

     |PINDA #0#923;
     |SI nModo ! 4;
         |ENDATOS #1#923;
         |SI FSalida = 0;
             #30#44 = #923#0;  #30#45 = #923#1;  #30#46 = #923#2;
             #30#47 = #923#3;  #30#48 = #923#4;  #30#49 = #923#5;
             #30#50 = #923#6;  #30#51 = #923#7;  #30#76 = #923#8;
             #30#77 = #923#9;
          |FINSI;
     |SINO;
         |LEETECLA aTecla;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO Opcion5;
     |ESTADO_CONTROL nBoton5, "DISABLE";

     |PARA;  |SI;  |HACIENDO;
          |SI nOpcion = 1;  |SAL;  |FINSI;
          |SI nOpcion = 2;  |SAL;  |FINSI;
          |SI nOpcion = 3;  |SAL;  |FINSI;
          |SI nOpcion = 4;  |SAL;  |FINSI;

          |HAZ Datos347;
     |SIGUE;

     |ESTADO_CONTROL nBoton5, "ENABLE";
|FPRC;


|PROCESO ControlProg;  |TIPO 0;
     |PUSHV 1401 2380;

     nSubOpcion = 0;
     |SI FSalida = 10;  nOpcion = 1;  |FINSI;
     |SI FSalida = 11;  nOpcion = 2;  |FINSI;
     |SI FSalida = 12;  nOpcion = 3;  |FINSI;
     |SI FSalida = 13;  nOpcion = 4;  |FINSI;
     |SI FSalida = 14;  nOpcion = 5;  |FINSI;
     |SI FSalida = 17;
         |SI Campo = 1; |HAZ zCopiar; nOpcion = 1; |FINSI;
     |FINSI;

     |SI nOpcion ] 2;
         |ESTADO_CONTROL nBoton1, "ENABLE";
     |SINO;
         |ESTADO_CONTROL nBoton1, "DISABLE";
     |FINSI;

     |SI nOpcion = 0;  nOpcion = 1;  |FINSI;

     nSwDentro = 0;
     |SI nOpcion ] 2;
         nSwDentro = 1;
         |PUSHV 1401 2380;
         |BLANCO 1401 2380;
     |FINSI;

     |PARA;  |SI nOpcion ] 2;  |HACIENDO;
          |SI nOpcion = 2;  |HAZ Opcion2;  |FINSI;
          |SI nOpcion = 3;  |HAZ Opcion3;  |FINSI;
          |SI nOpcion = 4;  |HAZ Opcion4;  |FINSI;
          |SI nOpcion = 5;  |HAZ Opcion5;  |FINSI;
     |SIGUE;

     |SI nSwDentro = 1;
         |POPV;
         |SI nModo ! 4;  |PTEC 808; |FINSI;
     |FINSI;

     |ESTADO_CONTROL nBoton1, "DISABLE";

     |POPV;
     |PINTA #30#1;
|FPRC;


|PROCESO ModoEntrada;  |TIPO 7;
     nModo   = (FEntrada / 100) ! 0;
     |SI FEntrada < 10;  nModo = FEntrada;  |FINSI;
|FPRC;

|PROCESO Tipo13;  |TIPO 13;
     |SI #30#0 = 0;  |ACABA;  |FINSI;

     nModo    = 4;
|FPRC;

|PROCESO Tipo12m030;  |TIPO 12;
     || Este proceso sirve para que el endatos que se hace en el
     || calculo dsam0000 no pregunte Correcto S/N
     || POR LO TANTO NO LO QUITEIS !!!!!!
|FPRC;

|PROCESO PulsoBoton1;
     nSubOpcion = 0;
     nOpcion    = 1;
     |PTEC 824;
     FSalida = 10;
|FPRC;

|PROCESO PulsoBoton2;
     nSubOpcion = 0;
     |SI nModo = 4;  |Y nOpcion = 1;
         nOpcion = 2;
         |HAZ ControlProg;
         |ACABA;
     |FINSI;

     nOpcion = 2;
     |PTEC 825;
     FSalida = 11;
|FPRC;

|PROCESO PulsoBoton3;
     nSubOpcion = 1;
     |SI nModo = 4;  |Y nOpcion = 1;
         nOpcion = 3;
         |HAZ ControlProg;
         |ACABA;
     |FINSI;

     nOpcion = 3;
     |PTEC 826;
     FSalida = 12;
|FPRC;

|PROCESO PulsoBoton4;
     nSubOpcion = 0;
     |SI nModo = 4;  |Y nOpcion = 1;
         nOpcion = 4;
         |HAZ ControlProg;
         |ACABA;
     |FINSI;

     nOpcion = 4;
     |PTEC 827;
     FSalida = 13;
|FPRC;

|PROCESO PulsoBoton5;
     nSubOpcion = 0;
     |SI nModo = 4;  |Y nOpcion = 1;
         nOpcion = 5;
         |HAZ ControlProg;
         |ACABA;
     |FINSI;

     nOpcion = 5;
     |PTEC 828;
     FSalida = 14;
|FPRC;

|PROCESO Tipo88m030;  |TIPO 8;
     |CONTROL_SIMPLE 0, "BOTON,F2 D.Generales", 1201, 1214, PulsoBoton1;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,F3 Contabilidad", 1216, 1230, PulsoBoton2;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,F4 I.V.A", 1232, 1239, PulsoBoton3;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,F5 I.R.P.F", 1241, 1250, PulsoBoton4;
     nBoton4 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,F6 Compras/Ventas Superiores", 1252, 1280, PulsoBoton5;
     nBoton5 = FSalida;

     aFichero = "9w" + Usuario;
     |NOME_DAT #995 aFichero;
|FPRC;

|PROCESO Tipo99m030;  |TIPO 9;
       |FIN_CONTROL_WINDOWS nBoton1;
       |FIN_CONTROL_WINDOWS nBoton2;
       |FIN_CONTROL_WINDOWS nBoton3;
       |FIN_CONTROL_WINDOWS nBoton4;
       |FIN_CONTROL_WINDOWS nBoton5;
       |PULSATECLA;
|FPRC;

|PROCESO zCopiar;
   |POPV;
   |PUSHV 0525 0880;
   |PINPA #0#948;
   #948#0 = 1;
   #948#1 = "";
   #948#2 = #30#0;
   #948#3 = "N";
   |PINDA #0#948;

   |ENDATOS #1#948;
   |PINDA #0#30;
|FPRC;

|PROCESO CreoTabla;
 |DELINDEX #995;
 |ABRE #995;
 |ABRE #98;
 |PARA nPara1 = 78; |SI nPara1 [ 89; |HACIENDO nPara1 = nPara1 + 1;
       |SI #30nPara1 ! #30#24; |Y #30nPara1 ! 00;
           #995#0 = #30#0;
           #995#1 = #30nPara1;
           |LEE 040#995=;
           |SI FSalida ! 0;
               #995#0 = #30#0;
               #995#1 = #30nPara1;
               |DDEFECTO #98;
               #98#0 = #995#1;
               |LEE 000#98=;
               #995#2 = #98#5;
               |GRABA 020#995n;
           |FINSI;
        |FINSI;
  |SIGUE;
  |CIERRA #98;
  |CIERRA #995;
|FPRC;

|PROCESO RecojoT;
  |SI #995#1 ! #30#24;
      nPara1 = nPara1 + 1;
      #30nPara1 = #995#1;
  |FINSI;
|FPRC;

|DEFBUCLE RecojoT;
 #995#1;
 ;
 #30#0, 01;
 #30#0, 99;
 ;
 NULL, RecojoT;
|FIN;

|PROCESO RecojoTabla;
   |PARA nPara1 = 78; |SI nPara1 [ 89; |HACIENDO nPara1 = nPara1 + 1;
         #30nPara1 = 0;
   |SIGUE;
   nPara1 = 77;
   |BUCLE RecojoT;
|FPRC;

|PROCESO CuidoTabla;
 |ABRE #995;
 #995#0 = #30#0;
 #995#1 = #921#0;
 |LEE 001#995=;
 |SI FSalida = 0;
     |BORRA 020#995a;
 |FINSI;
 |CIERRA #995;
|FPRC;
