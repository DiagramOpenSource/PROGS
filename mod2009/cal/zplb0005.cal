|FICHEROS;
   :/basica/def/agicen14 #114;
   :/basica/def/agifigen #118;
   :/basica/def/agim0019 #119;

   dsmow030 #900;
|FIN;

|VARIABLES;
   nSPin1   = 0;
   nPin1    = 0;
   aPin1    = "";
   efPn10   = @;
   efPn11   = @;
   aAlfa1   = "";
|FIN;

|INCLUYE i_variar;
|INCLUYE i_varcon;
|INCLUYE i_varlib;

|PROCESO DatosEmpr_w30;

  |DDEFECTO #900;

  #900#0 = enEmpresa;
  nPin1 = 0;
  aPin1 = "";
  efPn10 = "01.01.0000";
  efPn11 = "01.01.0000";
  enEjerBajaM = 0;

  || Lee Primera Actividad
    |ABRE #agicen14;
    #agicen14#0 = #900#0; || Empresa
    #agicen14#1 = 00;
    |LEE 041#agicen14.];
    |SI FSalida = 0; |Y #agicen14#0 = #900#0;
        #900#5 = #agicen14#9;
        #900#6 = #agicen14#10;
        #900#7 = #agicen14#7;
        #900#8 = #agicen14#8;
        efPn10 = #agicen14#5;
        efPn11 = #agicen14#6;
    |FINSI;

  || Lee Actividad en concreto.
    swNoExis = 0;
    |SI enActividad ! 0;
        #agicen14#0 = #900#0; || Empresa
        #agicen14#1 = enActividad;
        |LEE 041#agicen14.=;
        |SI FSalida = 0;
            #900#69 = #agicen14#1;   ||Act.
            #900#70 = #agicen14#2;   ||Tipo Epig.
            #900#71 = #agicen14#3;   ||Epigrafe
            #900#72 = #agicen14#4;   ||Descripcion Actividad
            #900#73 = #agicen14#5;   ||Fecha Inicio
            #900#74 = #agicen14#6;   ||Fecha Fin
            #900#75 = #agicen14#11;  ||Sector actividad
            #900#76 = #agicen14#12;  ||Sector actividad
            #900#77 = #agicen14#16;  ||Tipo Actividad
            #900#78 = #agicen14#17;  ||Descripcion Tipo Actividad
            #900#80 = #agicen14#20;  ||CNAE
            |SI #agicen14#6 > "01.01.0000";
                |SI eaInac = "N";
                    |CIERRA #agicen14;
                    swNoExis = 1;
                    |ACABA;
                |FINSI;
            |FINSI;
       |SINO;
            |CIERRA #agicen14;
            swNoExis = 1;
            |ACABA;
       |FINSI;
    |FINSI;

    |CIERRA #agicen14;

 || Lee Ficha Sociedades
    swExiste = 0; nPvp     = 0;
    nRegis   = 0; nTAccion = 0;
    |ABRE #agim0019;
    #agim0019#0 = #900#0; || Empresa
    #agim0019#1 = 99;
    |LEE 041#agim0019.];
    |SI FSalida = 0;
        |SI #agim0019#0 ! #900#0;
            |LEE 041#agim0019.a;
            |SI FSalida = 0; |Y #agim0019#0 = #900#0;
                swExiste = 1;
            |FINSI;
        |SINO;
            swExiste = 1;
        |FINSI;
    |FINSI;
    |SI swExiste = 1;
        nRegis = #agim0019#1;      ||Registre
        efPn10 = #agim0019#7;      || Fecha Activa
        efPn11 = #agim0019#55;     || Fecha Inactiva
        nPin1  = #agim0019#4;
        aPin1  = #agim0019#5;
        nSuma  = 0;
        |SI #agim0019#15 ! 0; nTAccion = #agim0019#15; nPvp = #agim0019#16; nSuma = 1; |FINSI;
        |SI #agim0019#19 ! 0; nTAccion = #agim0019#19; nPvp = #agim0019#20; nSuma = 2; |FINSI;
        |SI #agim0019#23 ! 0; nTAccion = #agim0019#23; nPvp = #agim0019#24; nSuma = 3; |FINSI;
        |SI #agim0019#12 > "01.01.1000";
            aAlfa1 = #agim0019#12; aAlfa1 = aAlfa1 % -104; enEjerBajaM = aAlfa1;
        |FINSI;
    |FINSI;
    |CIERRA #agim0019;
    |ABRE #agifigen;
    #agifigen#0 = #900#0; || Empresa
    |LEE 041#agifigen.=;
    |SI FSalida = 0;
        efPn10  = #agifigen#93;
        efPn11  = #agifigen#94;
        nPin1   = #agifigen#87;
        aPin1   = #agifigen#88;
        enTpEm  = #agifigen#87;
        #900#1 = #agifigen#13;  || Nif
        #900#2 = #agifigen#1;   || Nombre
    |FINSI;
    |CIERRA #agifigen;
    |SI efPn10 [ "01.01.1000"; efPn10 = ""; |FINSI;
    |SI efPn11 [ "01.01.1000"; efPn11 = ""; |FINSI;
    #900#3 = nPin1;
    #900#4 = aPin1;
    #900#9 = efPn10;
    #900#10 = efPn11;

    #900#11 = "ACTIVA";
    |SI efPn11 > "01.01.1900";
        #900#11 = "INACTIVA";
    |FINSI;
    #900#12 = enEjer;                                   || Ejercicio
    #900#13 = efDFecha;
    #900#14 = efHFecha;

    #900#64 = eaTituloL; ||Titulo del Libro

|FPRC;


|PROCESO DatosEmpr_w30_SA;

  |DDEFECTO #900;

  #900#0 = enEmpresa;
  nPin1 = 0;
  aPin1 = "";
  efPn10 = "01.01.0000";
  efPn11 = "01.01.0000";
  enEjerBajaM = 0;

  || Lee Primera Actividad
    |ABRE #agicen14;
    #agicen14#0 = #900#0; || Empresa
    #agicen14#1 = 00;
    |LEE 041#agicen14.];
    |SI FSalida = 0; |Y #agicen14#0 = #900#0;
        #900#5 = #agicen14#9;
        #900#6 = #agicen14#10;
        #900#7 = #agicen14#7;
        #900#8 = #agicen14#8;
        efPn10 = #agicen14#5;
        efPn11 = #agicen14#6;
    |FINSI;

  || Lee Actividad en concreto.
    swNoExis = 0;
    |SI enActividad ! 0;
        #agicen14#0 = #900#0; || Empresa
        #agicen14#1 = enActividad;
        |LEE 041#agicen14.=;
        |SI FSalida = 0;
            #900#69 = #agicen14#1;   ||Act.
            #900#70 = #agicen14#2;   ||Tipo Epig.
            #900#71 = #agicen14#3;   ||Epigrafe
            #900#72 = #agicen14#4;   ||Descripcion Actividad
            #900#73 = #agicen14#5;   ||Fecha Inicio
            #900#74 = #agicen14#6;   ||Fecha Fin
            #900#75 = #agicen14#11;  ||Sector actividad
            #900#76 = #agicen14#12;  ||Sector actividad
            #900#77 = #agicen14#16;  ||Tipo Actividad
            #900#78 = #agicen14#17;  ||Descripcion Tipo Actividad
            #900#80 = #agicen14#20;  ||CNAE
            |SI #agicen14#6 > "01.01.0000";
                |SI eaInac = "N";
                    |CIERRA #agicen14;
                    swNoExis = 1;
                    |ACABA;
                |FINSI;
            |FINSI;
       |SINO;
            |CIERRA #agicen14;
            swNoExis = 1;
            |ACABA;
       |FINSI;
    |FINSI;

    |CIERRA #agicen14;

 || Lee Ficha Sociedades
    swExiste = 0; nPvp     = 0;
    nRegis   = 0; nTAccion = 0;
    |ABRE #agim0019;
    #agim0019#0 = #900#0; || Empresa
    #agim0019#1 = 99;
    |LEE 041#agim0019.];
    |SI FSalida = 0;
        |SI #agim0019#0 ! #900#0;
            |LEE 041#agim0019.a;
            |SI FSalida = 0; |Y #agim0019#0 = #900#0;
                swExiste = 1;
            |FINSI;
        |SINO;
            swExiste = 1;
        |FINSI;
    |FINSI;
    |SI swExiste = 1;
        nRegis = #agim0019#1;      ||Registre
        efPn10 = #agim0019#7;      || Fecha Activa
        efPn11 = #agim0019#55;     || Fecha Inactiva
        nPin1  = #agim0019#4;
        aPin1  = #agim0019#5;
        nSuma  = 0;
        |SI #agim0019#15 ! 0; nTAccion = #agim0019#15; nPvp = #agim0019#16; nSuma = 1; |FINSI;
        |SI #agim0019#19 ! 0; nTAccion = #agim0019#19; nPvp = #agim0019#20; nSuma = 2; |FINSI;
        |SI #agim0019#23 ! 0; nTAccion = #agim0019#23; nPvp = #agim0019#24; nSuma = 3; |FINSI;
        |SI #agim0019#12 > "01.01.1000";
            aAlfa1 = #agim0019#12; aAlfa1 = aAlfa1 % -104; enEjerBajaM = aAlfa1;
        |FINSI;
    |FINSI;
    |CIERRA #agim0019;

     efPn10  = #agifigen#93;
     efPn11  = #agifigen#94;
     nPin1   = #agifigen#87;
     aPin1   = #agifigen#88;
     enTpEm  = #agifigen#87;
     #900#1 = #agifigen#13;  || Nif
     #900#2 = #agifigen#1;   || Nombre
     |SI efPn10 [ "01.01.1000"; efPn10 = ""; |FINSI;
     |SI efPn11 [ "01.01.1000"; efPn11 = ""; |FINSI;
     #900#3 = nPin1;
     #900#4 = aPin1;
     #900#9 = efPn10;
     #900#10 = efPn11;

     #900#11 = "ACTIVA";
     |SI efPn11 > "01.01.1900";
         #900#11 = "INACTIVA";
     |FINSI;
     #900#12 = enEjer;                                   || Ejercicio
     #900#13 = efDFecha;
     #900#14 = efHFecha;

    #900#64 = eaTituloL; ||Titulo del Libro
|FPRC;
