|FICHEROS;
     dsmom006 #0;
     :/basica/def/agitab99 #199;
|FIN;

|VARIABLES;
 {-1} aMenu       = "";
      aMenu1      = "1262";
      aMenu2      = "1";
      aMenu3      = "2";
      aMenu4      = "DEVOLVER ";
      aMenu5      = "COMPENSAR";
|FIN;

|INCLUYE i_variar;

|PROCESO PeriodoTipo7;  |TIPO 7;
     |SI #0#1 = 349;
         |C_M #0#6, 1, "S";
         |ACABA;
     |FINSI;

     |C_M #0#6, 1, "N";
     |SI #0#6 = "C";  |C_M #0#6, 1, "S";  |FINSI;
|FPRC;

|PROCESO PeriodoTipo0;  |TIPO 0;
     |SI #0#6 = "M";  #0#7 = "MENSUAL   ";  |FINSI;
     |SI #0#6 = "T";  #0#7 = "TRIMESTRAL";  |FINSI;
     |SI #0#6 = "A";  #0#7 = "ANUAL     ";  |FINSI;
     |SI #0#6 = "C";  #0#7 = "SELECCIONA";  |FINSI;
     |PINTA #0#7;
|FPRC;

|PROCESO ConfiguraTipo7;  |TIPO 7;
     |ABRE #199;
     #199#0 = #0#1;
     |LEE 040#199=;
     |SI FSalida ! 0;  |DDEFECTO #199;  |FINSI;
     |CIERRA #199;

     |C_M #0#8, 1, "S";
     |SI #0#1 ! 110; |Y #0#1 ! 115;  |Y #0#1 ! 123; |Y #0#1 ! 216;
         |SI #199#6 = "M";  |C_M #0#8, 1, "N";  |FINSI;
     |FINSI;
|FPRC;

|PROCESO ConfiguraTipo0;  |TIPO 0;
     |SI #199#6 = "F";  |Y #0#8 = "M";
         |SI #0#1 ! 110; |Y #0#1 ! 115;  |Y #0#1 ! 123; |Y #0#1 ! 216;
             |MENAV "     El Modelo no se puede introducir por Empresa.";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #199#6 = "X";  |Y #0#8 ! "M";
         |MENAV "     El Modelo no se puede introducir por Actividades.";
         |ERROR;
         |ACABA;
     |FINSI;

     |SI #0#8 = "A";  #0#9 = "ACTIVIDAD ";  |FINSI;
     |SI #0#8 = "M";  #0#9 = "EMPRESA   ";  |FINSI;
     |SI #0#8 = "C";  #0#9 = "ACT.+ REG.";  |FINSI;
     |PINTA #0#9;
|FPRC;

|PROCESO UltimoPeriodo;  |TIPO 7;
     |SI #199#7 = "N";
         #0#12 = "";
     |SINO;
         |PUSHV 0501 2380;
         |PARA; |SI; |HACIENDO;
                |MENUG aMenu;
                aMenu2 = FSalida;

                |SI aMenu2 = "1";   #0#12 = aMenu4;  |SAL;  |FINSI;
                |SI aMenu2 = "2";   #0#12 = aMenu5;  |SAL;  |FINSI;
         |SIGUE;
         |POPV;
     |FINSI;
     |PINTA #0#12;
|FPRC;

|RUTINA ClaveBaja0;
     #0#0 = enEmpresa;
     #0#1 = 000;
|FRUT;

|RUTINA ClaveAlta0;
     #0#0 = enEmpresa;
     #0#1 = 999;
|FRUT;

|PROGRAMA;
     |SI enModo ! 4;
         |ENTLINEAL #1#0, -2, 1, 22, 1, ClaveBaja0, ClaveAlta0;
     |SINO;
         |ENTLINEAL #1#0, -2, 4, 22, 1, ClaveBaja0, ClaveAlta0;
     |FINSI;
|FPRO;
