|FICHEROS;
     dsmom015 #15;
     dsmom016 #16;
     dsmom018 #18;
     dsmom019 #19;
     dsmow008 #108;
     dsmow009 #109;
     dsmow011 #111;

     :/basica/def/agicen14 #214;
|FIN;

|VARIABLES;
     aFichero      = "";
     aTipoElemento = "";
     aModTrab      = "";
     aModElem      = "";
     aAlfa         = "";

     fFechaIni     = @;
     fFechaFin     = @;

     nCampoPtas    = 0;
     nCampoElem    = 0;
     nCampoAsala1  = 0;
     nCampoAsala2  = 0;
     nCampoAsala3  = 0;
     nCampoAsala4  = 0;
     nCampoAsala5  = 0;
     nCampoAsala6  = 0;
     nCampoAsala7  = 0;
     nCampoAsala8  = 0;
     nCampoAsala9  = 0;
     nCampoAsalar  = 0;
     nError        = 0;
     nSwPregunta   = 0;
     nDias         = 0;
     nDiasEjer     = 0;
     nControl      = 0;
     nCampoImp     = 0;
     nTeclaPara    = 0;
     nTeclaAsal    = 0;
     nTAsalariado  = 0;
     nCampo1       = 0;
     nConta        = 0;
     nCampoTrab    = 0;
     nPosi         = 0;
     nRendimiento  = 0;
     nTAsala       = 0;
     nCampoD       = 0;
     nCampoH       = 0;
     nSuma         = 0;
     nCampo        = 0;

     &enTipoPase   = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO Lee15;
     #15#0 = #16nCampoElem;
     |LEE 040#15=;
     |SI FSalida ! 0;  |DDEFECTO #15;  |FINSI;

     aTipoElemento = "";
     |SI #15#3 = "L";
         |SI #15#2 = "S";  aTipoElemento = "L";  |FINSI;
         |ACABA;
     |FINSI;

     |SI #15#3 = "N";
         |SI #15#2 = "S";  aTipoElemento = "P";  |FINSI;
         |ACABA;
     |FINSI;

     aTipoElemento = "A";
     |SI #15#4 = "S";  aTipoElemento = "N";  |FINSI;
|FPRC;

|PROCESO PonTipos;
     |ABRE #15;

     nCampoElem = 4;   |HAZ Lee15;  #19#70 = aTipoElemento;
     nCampoElem = 8;   |HAZ Lee15;  #19#71 = aTipoElemento;
     nCampoElem = 12;  |HAZ Lee15;  #19#72 = aTipoElemento;
     nCampoElem = 16;  |HAZ Lee15;  #19#73 = aTipoElemento;
     nCampoElem = 20;  |HAZ Lee15;  #19#74 = aTipoElemento;
     nCampoElem = 24;  |HAZ Lee15;  #19#75 = aTipoElemento;
     nCampoElem = 28;  |HAZ Lee15;  #19#76 = aTipoElemento;
     nCampoElem = 32;  |HAZ Lee15;  #19#77 = aTipoElemento;
     nCampoElem = 36;  |HAZ Lee15;  #19#78 = aTipoElemento;

     |CIERRA #15;

     nCampoAsala1 = 0; nCampoAsala2 = 0; nCampoAsala3 = 0;
     nCampoAsala4 = 0; nCampoAsala5 = 0; nCampoAsala6 = 0;
     nCampoAsala7 = 0; nCampoAsala8 = 0; nCampoAsala9 = 0;

     |SI #19#70 = "A";  nCampoAsala1 = 1;  |FINSI;
     |SI #19#71 = "A";  nCampoAsala2 = 1;  |FINSI;
     |SI #19#72 = "A";  nCampoAsala3 = 1;  |FINSI;
     |SI #19#73 = "A";  nCampoAsala4 = 1;  |FINSI;
     |SI #19#74 = "A";  nCampoAsala5 = 1;  |FINSI;
     |SI #19#75 = "A";  nCampoAsala6 = 1;  |FINSI;
     |SI #19#76 = "A";  nCampoAsala7 = 1;  |FINSI;
     |SI #19#77 = "A";  nCampoAsala8 = 1;  |FINSI;
     |SI #19#78 = "A";  nCampoAsala9 = 1;  |FINSI;

     |SI #19#70 = "A";  nCampoAsalar = 0;  |ACABA;    |FINSI;
     |SI #19#71 = "A";  nCampoAsalar = 1;  |ACABA;    |FINSI;
     |SI #19#72 = "A";  nCampoAsalar = 2;  |ACABA;    |FINSI;
     |SI #19#73 = "A";  nCampoAsalar = 3;  |ACABA;    |FINSI;
     |SI #19#74 = "A";  nCampoAsalar = 4;  |ACABA;    |FINSI;
     |SI #19#75 = "A";  nCampoAsalar = 5;  |ACABA;    |FINSI;
     |SI #19#76 = "A";  nCampoAsalar = 6;  |ACABA;    |FINSI;
     |SI #19#77 = "A";  nCampoAsalar = 7;  |ACABA;    |FINSI;
     |SI #19#78 = "A";  nCampoAsalar = 8;  |ACABA;    |FINSI;
|FPRC;

|PROCESO CogeModulo;
     aAlfa = "01.01." + #19#1;  fFechaIni = aAlfa;
     aAlfa = "31.12." + #19#1;  fFechaFin = aAlfa;
     nDiasEjer = (fFechaFin - fFechaIni) + 1;

     #19#107 = enDiaTrimP1;
     #19#108 = enDiaTrimP2;
     #19#109 = enDiaTrimP3;
     #19#110 = enDiaTrimP4;
     #19#111 = #19#107 + #19#108 + #19#109 + #19#110;

     #19#112 = enDiaTrimD1;
     #19#113 = enDiaTrimD2;
     #19#114 = enDiaTrimD3;
     #19#115 = enDiaTrimD4;
     #19#116 = #19#112 + #19#113 + #19#114 + #19#115;

     nError = 0;

     |ABRE #16;
     |SELECT #1#16;
     #16#0  = "E";
     #16#1  = eaCodEpi2;
     #16#41 = enCodEpi3;
     #16#2  = enEjer;
     |LEE 040#16=;
     |SI FSalida ! 0;  nError = 1;  |ACABA;  |FINSI;
     |CIERRA #16;

     |HAZ PonTipos;

     #19#4  = #16#5;           || Elemento  1
     #19#5  = #16#9;           || Elemento  2
     #19#6  = #16#13;          || Elemento  3
     #19#7  = #16#17;          || Elemento  4
     #19#8  = #16#21;          || Elemento  5
     #19#9  = #16#25;          || Elemento  6
     #19#10 = #16#29;          || Elemento  7
     #19#11 = #16#33;          || Elemento  8
     #19#12 = #16#37;          || Elemento  9

     |SI EURODBMOD ! 0;
         #19#15  = #16#58;          || Euro IVA 1
         #19#16  = #16#59;          || Euro IVA 2
         #19#17  = #16#60;          || Euro IVA 3
         #19#18  = #16#61;          || Euro IVA 4
         #19#19  = #16#62;          || Euro IVA 5
         #19#20  = #16#63;          || Euro IVA 6
         #19#21  = #16#64;          || Euro IVA 7
         #19#22  = #16#65;          || Euro IVA 8
         #19#23  = #16#66;          || Euro IVA 9
     |SINO;
         #19#15  = #16#7;           || Ptas IVA 1
         #19#16  = #16#11;          || Ptas IVA 2
         #19#17  = #16#15;          || Ptas IVA 3
         #19#18  = #16#19;          || Ptas IVA 4
         #19#19  = #16#23;          || Ptas IVA 5
         #19#20  = #16#27;          || Ptas IVA 6
         #19#21  = #16#31;          || Ptas IVA 7
         #19#22  = #16#35;          || Ptas IVA 8
         #19#23  = #16#39;          || Ptas IVA 9
     |FINSI;

     nSuma = #19#15 + #19#16 + #19#17 + #19#18 + #19#19;
     nSuma = nSuma  + #19#20 + #19#21 + #19#22 + #19#23;
     |SI nSuma = 0;  nError = 1;  |ACABA;  |FINSI;

     #19#121 = #16#42;
     #19#122 = #16#48;

     |SI #19#70 = "L";  #19#123 = #16#58; #19#04 = "";  #19#15 = 0;  |FINSI;
     |SI #19#71 = "L";  #19#123 = #16#59; #19#05 = "";  #19#16 = 0;  |FINSI;
     |SI #19#72 = "L";  #19#123 = #16#60; #19#06 = "";  #19#17 = 0;  |FINSI;
     |SI #19#73 = "L";  #19#123 = #16#61; #19#07 = "";  #19#18 = 0;  |FINSI;
     |SI #19#74 = "L";  #19#123 = #16#62; #19#08 = "";  #19#19 = 0;  |FINSI;
     |SI #19#75 = "L";  #19#123 = #16#63; #19#09 = "";  #19#20 = 0;  |FINSI;
     |SI #19#76 = "L";  #19#123 = #16#64; #19#10 = "";  #19#21 = 0;  |FINSI;
     |SI #19#77 = "L";  #19#123 = #16#65; #19#11 = "";  #19#22 = 0;  |FINSI;
     |SI #19#78 = "L";  #19#123 = #16#66; #19#12 = "";  #19#23 = 0;  |FINSI;

     |C_M #19#26, 1, "S";  |C_M #19#48,  1, "S";
     |C_M #19#27, 1, "S";  |C_M #19#49,  1, "S";
     |C_M #19#28, 1, "S";  |C_M #19#50,  1, "S";
     |C_M #19#29, 1, "S";  |C_M #19#51,  1, "S";
     |C_M #19#30, 1, "S";  |C_M #19#52,  1, "S";
     |C_M #19#31, 1, "S";  |C_M #19#53,  1, "S";
     |C_M #19#32, 1, "S";  |C_M #19#53,  1, "S";
     |C_M #19#33, 1, "S";  |C_M #19#55,  1, "S";

     |SI #19#15  = 0;  |C_M #19#26,  1, "N";  |C_M #19#48,  1, "N";  |FINSI;
     |SI #19#16  = 0;  |C_M #19#27,  1, "N";  |C_M #19#49,  1, "N";  |FINSI;
     |SI #19#17  = 0;  |C_M #19#28,  1, "N";  |C_M #19#50,  1, "N";  |FINSI;
     |SI #19#18  = 0;  |C_M #19#29,  1, "N";  |C_M #19#51,  1, "N";  |FINSI;
     |SI #19#19  = 0;  |C_M #19#30,  1, "N";  |C_M #19#52,  1, "N";  |FINSI;
     |SI #19#20  = 0;  |C_M #19#31,  1, "N";  |C_M #19#53,  1, "N";  |FINSI;
     |SI #19#21  = 0;  |C_M #19#32,  1, "N";  |C_M #19#54,  1, "N";  |FINSI;
     |SI #19#22  = 0;  |C_M #19#33,  1, "N";  |C_M #19#55,  1, "N";  |FINSI;
|FPRC;

|PROCESO MensaAsala;
     |SI Campo = 26;  |O Campo = 48;
         |MENSA "     <F2> Datos Personal Asalariado; <F3> N.IRPF Provisional; <F4> N.IRPF Definitivo";
     |SINO;
         |MENSA "     <F2> Datos Personal Asalariado; ";
     |FINSI;
|FPRC;

|PROCESO MensaNAsala;
     |MENSA "     <F2> Recoge Datos Personal No Asalariado.";
|FPRC;

|PROCESO PintaElemento;  |TIPO 7;
     || Pinta los mensajes  de las teclas de funciones

     |MENSA "        ";

     aModTrab = "S";
     |SI eaDesTrab = "S";  aModTrab = "N";  |FINSI;

     aModElem = "S";
     |SI eaDesElem = "S";  aModElem = "N";  |FINSI;

     nSwPregunta = 0;

     |C_M #19Campo, 1, "S";

     |SI Campo = 26; |O Campo = 48;
         |SI #19#70 = "A"; |Y nCampoAsalar [ 1;
             |SI Campo = 26; nSwPregunta = 1;  |FINSI;
             |SI Campo = 48; nSwPregunta = 2;  |FINSI;

             |C_M #19Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaAsala;
             |FINSI;
         |FINSI;

         |SI #19#70 = "N";
             |SI Campo = 26; nSwPregunta = 3;  |FINSI;
             |SI Campo = 48; nSwPregunta = 4;  |FINSI;

             |C_M #19Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaNAsala;
             |FINSI;
         |FINSI;

         |SI #19#70 ! "N"; |Y  #19#70 ! "A";
             |C_M #19Campo, 1, aModElem;
         |FINSI;
     |FINSI;

     |SI Campo = 27; |O Campo = 49;
         |SI #19#71 = "A"; |Y nCampoAsalar [ 1;
             |SI Campo = 27; nSwPregunta = 1;  |FINSI;
             |SI Campo = 49; nSwPregunta = 2;  |FINSI;

             |C_M #19Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaAsala;
             |FINSI;
         |FINSI;

         |SI #19#71 = "N";
             |SI Campo = 27; nSwPregunta = 3;  |FINSI;
             |SI Campo = 49; nSwPregunta = 4;  |FINSI;

             |C_M #19Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaNAsala;
             |FINSI;
         |FINSI;

         |SI #19#71 ! "N"; |Y  #19#71 ! "A";
             |C_M #19Campo, 1, aModElem;
         |FINSI;
     |FINSI;

     |SI Campo = 28; |O Campo = 50;
         |SI #19#72 = "A"; |Y nCampoAsalar [ 1;
             |SI Campo = 28; nSwPregunta = 1;  |FINSI;
             |SI Campo = 50; nSwPregunta = 2;  |FINSI;

             |C_M #19Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaAsala;
             |FINSI;
         |FINSI;

         |SI #19#72 = "N";
             |SI Campo = 28; nSwPregunta = 3;  |FINSI;
             |SI Campo = 50; nSwPregunta = 4;  |FINSI;

             |C_M #19Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaNAsala;
             |FINSI;
         |FINSI;

         |SI #19#72 ! "N"; |Y  #19#72 ! "A";
             |C_M #19Campo, 1, aModElem;
         |FINSI;
     |FINSI;

     |SI Campo = 29; |O Campo = 51;
         |SI #19#73 = "A"; |Y nCampoAsalar [ 1;
             |SI Campo = 29; nSwPregunta = 1;  |FINSI;
             |SI Campo = 51; nSwPregunta = 2;  |FINSI;

             |C_M #19Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaAsala;
             |FINSI;
         |FINSI;

         |SI #19#73 = "N";
             |SI Campo = 29; nSwPregunta = 3;  |FINSI;
             |SI Campo = 51; nSwPregunta = 4;  |FINSI;

             |C_M #19Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaNAsala;
             |FINSI;
         |FINSI;

         |SI #19#73 ! "N"; |Y  #19#73 ! "A";
             |C_M #19Campo, 1, aModElem;
         |FINSI;
     |FINSI;

     |SI Campo = 30; |O Campo = 52;
         |SI #19#74 = "A"; |Y nCampoAsalar [ 1;
             |SI Campo = 30; nSwPregunta = 1;  |FINSI;
             |SI Campo = 52; nSwPregunta = 2;  |FINSI;

             |C_M #19Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaAsala;
             |FINSI;
         |FINSI;

         |SI #19#74 = "N";
             |SI Campo = 30; nSwPregunta = 3;  |FINSI;
             |SI Campo = 52; nSwPregunta = 4;  |FINSI;

             |C_M #19Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaNAsala;
             |FINSI;
         |FINSI;

         |SI #19#74 ! "N"; |Y  #19#74 ! "A";
             |C_M #19Campo, 1, aModElem;
         |FINSI;
     |FINSI;

     |SI Campo = 31; |O Campo = 53;
         |SI #19#75 = "A"; |Y nCampoAsalar [ 1;
             |SI Campo = 31; nSwPregunta = 1;  |FINSI;
             |SI Campo = 53; nSwPregunta = 2;  |FINSI;

             |C_M #19Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaAsala;
             |FINSI;
         |FINSI;

         |SI #19#75 = "N";
             |SI Campo = 31; nSwPregunta = 3;  |FINSI;
             |SI Campo = 53; nSwPregunta = 4;  |FINSI;

             |C_M #19Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaNAsala;
             |FINSI;
         |FINSI;

         |SI #19#75 ! "N"; |Y  #19#75 ! "A";
             |C_M #19Campo, 1, aModElem;
         |FINSI;
     |FINSI;

     |SI Campo = 32; |O Campo = 54;
         |SI #19#76 = "A"; |Y nCampoAsalar [ 1;
             |SI Campo = 32; nSwPregunta = 1;  |FINSI;
             |SI Campo = 54; nSwPregunta = 2;  |FINSI;

             |C_M #19Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaAsala;
             |FINSI;
         |FINSI;

         |SI #19#76 = "N";
             |SI Campo = 32; nSwPregunta = 3;  |FINSI;
             |SI Campo = 54; nSwPregunta = 4;  |FINSI;

             |C_M #19Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaNAsala;
             |FINSI;
         |FINSI;

         |SI #19#76 ! "N"; |Y  #19#76 ! "A";
             |C_M #19Campo, 1, aModElem;
         |FINSI;
     |FINSI;

     |SI Campo = 33; |O Campo = 55;
         |SI #19#77 = "A"; |Y nCampoAsalar [ 1;
             |SI Campo = 33; nSwPregunta = 1;  |FINSI;
             |SI Campo = 55; nSwPregunta = 2;  |FINSI;

             |C_M #19Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaAsala;
             |FINSI;
         |FINSI;

         |SI #19#77 = "N";
             |SI Campo = 33; nSwPregunta = 3;  |FINSI;
             |SI Campo = 55; nSwPregunta = 4;  |FINSI;

             |C_M #19Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaNAsala;
             |FINSI;
         |FINSI;

         |SI #19#77 ! "N"; |Y  #19#77 ! "A";
             |C_M #19Campo, 1, aModElem;
         |FINSI;
     |FINSI;

     |SI Campo = 26;  nDias = 111;  nControl = 70;  nCampoImp = 15;  |FINSI;
     |SI Campo = 27;  nDias = 111;  nControl = 71;  nCampoImp = 16;  |FINSI;
     |SI Campo = 28;  nDias = 111;  nControl = 72;  nCampoImp = 17;  |FINSI;
     |SI Campo = 29;  nDias = 111;  nControl = 73;  nCampoImp = 18;  |FINSI;
     |SI Campo = 30;  nDias = 111;  nControl = 74;  nCampoImp = 19;  |FINSI;
     |SI Campo = 31;  nDias = 111;  nControl = 75;  nCampoImp = 20;  |FINSI;
     |SI Campo = 32;  nDias = 111;  nControl = 76;  nCampoImp = 21;  |FINSI;
     |SI Campo = 33;  nDias = 111;  nControl = 77;  nCampoImp = 22;  |FINSI;

     |SI Campo = 48;  nDias = 116;  nControl = 70;  nCampoImp = 15;  |FINSI;
     |SI Campo = 49;  nDias = 116;  nControl = 71;  nCampoImp = 16;  |FINSI;
     |SI Campo = 50;  nDias = 116;  nControl = 72;  nCampoImp = 17;  |FINSI;
     |SI Campo = 51;  nDias = 116;  nControl = 73;  nCampoImp = 18;  |FINSI;
     |SI Campo = 52;  nDias = 116;  nControl = 74;  nCampoImp = 19;  |FINSI;
     |SI Campo = 53;  nDias = 116;  nControl = 75;  nCampoImp = 20;  |FINSI;
     |SI Campo = 54;  nDias = 116;  nControl = 76;  nCampoImp = 21;  |FINSI;
     |SI Campo = 55;  nDias = 116;  nControl = 77;  nCampoImp = 22;  |FINSI;

     |SI Campo = 26;  |O Campo = 48;
         |SI #19#15  = 0;  |C_M #19#26,  1, "N";  |C_M #19#48,  1, "N";  |FINSI;
     |FINSI;

     |SI Campo = 27;  |O Campo = 49;
         |SI #19#16  = 0;  |C_M #19#27,  1, "N";  |C_M #19#49,  1, "N";  |FINSI;
     |FINSI;

     |SI Campo = 28;  |O Campo = 50;
         |SI #19#17  = 0;  |C_M #19#28,  1, "N";  |C_M #19#50,  1, "N";  |FINSI;
     |FINSI;

     |SI Campo = 29;  |O Campo = 51;
         |SI #19#18  = 0;  |C_M #19#29,  1, "N";  |C_M #19#51,  1, "N";  |FINSI;
     |FINSI;

     |SI Campo = 30;  |O Campo = 52;
         |SI #19#19  = 0;  |C_M #19#30,  1, "N";  |C_M #19#52,  1, "N";  |FINSI;
     |FINSI;

     |SI Campo = 31;  |O Campo = 53;
         |SI #19#20  = 0;  |C_M #19#31,  1, "N";  |C_M #19#53,  1, "N";  |FINSI;
     |FINSI;

     |SI Campo = 32;  |O Campo = 54;
         |SI #19#21  = 0;  |C_M #19#32,  1, "N";  |C_M #19#54,  1, "N";  |FINSI;
     |FINSI;

     |SI Campo = 33;  |O Campo = 55;
         |SI #19#22  = 0;  |C_M #19#33,  1, "N";  |C_M #19#55,  1, "N";  |FINSI;
     |FINSI;

     |PULSATECLA;
|FPRC;

|| \\\\\\\\ PANTALLA DESGLOSE DEL PERSONAL ASALARIADO PROVISIONAL //////////

|PROCESO CalcuAsalar;
     |SI #19#1 < 2000;
         #19nCampoTrab = (#19enCampo1 * 0.60) + #19enCampo2 + #19enCampo3 + #19enCampo4;
     |SINO;
         #19nCampoTrab = (#19enCampo1 * 0.60) + (#19enCampo2 * 0.60) + #19enCampo3 + #19enCampo4;
     |FINSI;
     |PINTA #19nCampoTrab;
|FPRC;

|PROCESO CalcuNoAsalar;
     #19nCampoTrab = #19enCampo1 + #19enCampo2 + #19enCampo3;
     nTAsalariado  = #19enCampo4 + #19enCampo5;
     |SI #19nCampoTrab > 1; |Y #19enCampo1 = 1; |Y nTAsalariado [ 1;
          #19nCampoTrab = ((#19nCampoTrab - 1) / 2) + 1;
     |FINSI;
     |PINTA #19nCampoTrab;
|FPRC;

|PROCESO PersAsalariado;
     |PUSHV 0501 2380;

     #108#0 = #19enCampo1;
     #108#1 = #19enCampo2;
     #108#2 = #19enCampo3;
     #108#3 = #19enCampo4;
     #108#4 = #19nCampoTrab;

     |PINPA #0#108;

     |SI #19#1 ] 2000;
         |PINTA 1219, "N§.Menores 19 a¤os/Minus.33% ..:";
     |SINO;
         |PINTA 1219, "N§.Menores 19 a¤os ............:";
     |FINSI;

     |PINDA #0#108;
     |ENDATOS #1#108;
     |SI FSalida = 0;
         #19enCampo1    = #108#0;
         #19enCampo2    = #108#1;
         #19enCampo3    = #108#2;
         #19enCampo4    = #108#3;
         #19nCampoTrab = #108#4;
     |FINSI;

     |POPV;

     |HAZ CalcuAsalar;
|FPRC;

|PROCESO PersNoAsalariado;
     |PUSHV 0501 2380;

     #109#0 = #19enCampo1;
     #109#1 = #19enCampo2;
     #109#2 = #19enCampo3;
     #109#3 = #19nCampoTrab;

     |PINPA #0#109;
     |PINDA #0#109;
     |ENDATOS #1#109;
     |SI FSalida = 0;
         #19enCampo1    = #109#0;
         #19enCampo2    = #109#1;
         #19enCampo3    = #109#2;
         #19nCampoTrab  = #109#3;
     |FINSI;

     |POPV;
|FPRC;

|PROCESO ImporteTotal;
     #19#117 = 0;
     |PARA nConta = 37;  |SI nConta [ 44;  |HACIENDO nConta = nConta + 1;
           #19#117 = #19#117 + #19nConta;
     |SIGUE;

     #19#132  = #19#125 + #19#127 + #19#129 + #19#131;

     #19#118 = #19#132;
     |PARA nConta = 59;  |SI nConta [ 66;  |HACIENDO nConta = nConta + 1;
           #19#118 = #19#118 + #19nConta;
     |SIGUE;

     #19#97 = 0;  #19#99  = 0;
     #19#98 = 0;  #19#100 = 0;

     |SI nCampoAsala1 = 1;
         #19#97 = #19#97 + #19#26;
         #19#98 = #19#98 + #19#48;
     |FINSI;

     |SI nCampoAsala2 = 1;
         #19#99  = #19#99  + #19#27;
         #19#100 = #19#100 + #19#49;
     |FINSI;

     |SI nCampoAsala3 = 1;
         #19#99  = #19#99  + #19#28;
         #19#100 = #19#100 + #19#50;
     |FINSI;

     |SI nCampoAsala4 = 1;
         #19#99  = #19#99  + #19#29;
         #19#100 = #19#100 + #19#51;
     |FINSI;

     |SI nCampoAsala5 = 1;
         #19#99  = #19#99  + #19#30;
         #19#100 = #19#100 + #19#52;
     |FINSI;

     |SI nCampoAsala6 = 1;
         #19#99  = #19#99  + #19#31;
         #19#100 = #19#100 + #19#53;
     |FINSI;

     |SI nCampoAsala7 = 1;
         #19#99  = #19#99  + #19#32;
         #19#100 = #19#100 + #19#54;
     |FINSI;

     |SI nCampoAsala8 = 1;
         #19#99  = #19#99  + #19#33;
         #19#100 = #19#100 + #19#55;
     |FINSI;

     |SI #19#120 ! 0;  #19#117 = #19#117 * #19#120;  |FINSI;

     |PINTA #19#117;
     |PINTA #19#118;

     |SI #19#107 = 0;  #19#124 = 0;  #19#125 = 0;  |FINSI;
     |SI #19#108 = 0;  #19#126 = 0;  #19#127 = 0;  |FINSI;
     |SI #19#109 = 0;  #19#128 = 0;  #19#129 = 0;  |FINSI;

     nRendimiento = #19#117 % #19#121;

     |C_M #19#148, 1, "N";
     |C_M #19#149, 1, "N";
     |C_M #19#150, 1, "N";

     |SI #19#143 ! "S";
         |C_M #19#148, 1, "S";

         |SI #19#120 = 0;
             |SI #19#1 = 2000;  |O #19#1 = 2004;  |O #19#1 = 2008;
              |O #19#1 = 2012;  |O #19#1 = 2016;  |O #19#1 = 2020;
                 #19#139 = ((#19#117 * (#19#107 / 91)) % #19#121) + #19#125;
             |SINO;
                 #19#139 = ((#19#117 * (#19#107 / 90)) % #19#121) + #19#125;
             |FINSI;
         |SINO;
             #19#139 = ((nRendimiento * #19#107) / #19#111) + #19#125;
         |FINSI;
     |FINSI;

     |SI #19#144 ! "S";
         |C_M #19#149, 1, "S";

         |SI #19#120 = 0;
             #19#140 = ((#19#117 * (#19#108 / 91)) % #19#121) + #19#127;
         |SINO;
             #19#140 = ((nRendimiento * #19#108) / #19#111) + #19#127;
         |FINSI;
     |FINSI;

     |SI #19#145 ! "S";
         |C_M #19#150, 1, "S";

         |SI #19#120 = 0;
             #19#141 = ((#19#117 * (#19#109 / 92)) % #19#121) + #19#129;
         |SINO;
             #19#141 = ((nRendimiento * #19#109) / #19#111) + #19#129;
         |FINSI;
     |FINSI;

     |SI #19#146 ! "S";
         #19#133  = #19#118 % 1;                 || 1 % Cuota Devengada
         #19#135  = #19#133 + #19#134;           || Total Cuota Soportada

         #19#136  = #19#118 - #19#135;           || Resultado
         |SI #19#120 ! 0;
             #19#136 = #19#136 * #19#120;        || Resultado
         |FINSI;

         #19#137  = #19#118 % #19#122;           || Total Cuota Minima
         |SI #19#120 ! 0;
             #19#137 = #19#137 * #19#120;        || Total Cuota Minima
         |FINSI;
         #19#137  = #19#137 + #19#147;           || Total Cuota Minima

         #19#138  = #19#136;                     || Cuota derivada regiman general
         |SI #19#138 < #19#137;  #19#138 = #19#137;  |FINSI;

         #19#142  = #19#138;
     |FINSI;

     |PINTA #19#139;
     |PINTA #19#140;
     |PINTA #19#141;
     |PINTA #19#142;
|FPRC;

|PROCESO TraeProvisionIRPF;
     |ABRE #18;
     #18#0 = #19#0;
     #18#1 = #19#1;
     #18#2 = #19#2;
     #18#3 = #19#3;
     |LEE 040#18=;
     |SI FSalida ! 0;  |DDEFECTO #18;  |FINSI;
     |CIERRA #18;

     |PARA nCampo = 26;  |SI nCampo [ 36;  |HACIENDO nCampo = nCampo + 1;
           #19nCampo = #18nCampo;

           |SI nCampo [ 33;  |PINTA #19nCampo;  |FINSI;
     |SIGUE;
     #19#81  = #18#81;
     #19#83  = #18#83;
     #19#85  = #18#85;
     #19#87  = #18#87;
     #19#89  = #18#89;
     #19#91  = #18#91;
     #19#93  = #18#93;
     #19#95  = #18#95;
     #19#97  = #18#97;
     #19#99  = #18#99;
     #19#101 = #18#101;
     #19#103 = #18#103;
     #19#105 = #18#105;
|FPRC;

|PROCESO TraeDefinitivoIRPF;
     |ABRE #18;
     #18#0 = #19#0;
     #18#1 = #19#1;
     #18#2 = #19#2;
     #18#3 = #19#3;
     |LEE 040#18=;
     |SI FSalida ! 0;  |DDEFECTO #18;  |FINSI;
     |CIERRA #18;

     |PARA nCampo = 48;  |SI nCampo [ 58;  |HACIENDO nCampo = nCampo + 1;
           #19nCampo = #18nCampo;

           |SI nCampo [ 55;  |PINTA #19nCampo;  |FINSI;
     |SIGUE;
     #19#82  = #18#82;
     #19#84  = #18#84;
     #19#86  = #18#86;
     #19#88  = #18#88;
     #19#90  = #18#90;
     #19#92  = #18#92;
     #19#94  = #18#94;
     #19#96  = #18#96;
     #19#98  = #18#98;
     #19#100 = #18#100;
     #19#102 = #18#102;
     #19#104 = #18#104;
     #19#106 = #18#106;
|FPRC;

|PROCESO Importe;  |TIPO 0;
     |SI nTeclaPara = 5;  |ACABA;  |FINSI;

     enCampo1   = 0;
     enCampo2   = 0;
     enCampo3   = 0;
     enCampo4   = 0;
     enCampo5   = 0;
     nTeclaPara = FSalida;
     nCampoTrab = Campo;
     nTeclaAsal = FSalida;
     |BLIN 04;

     |SI nSwPregunta ! 0;
         |SI nSwPregunta = 1;
             |SI nCampoTrab = 26;
                 enCampo1 = 81;  enCampo2 = 85;  enCampo3 = 89;  enCampo4 = 93;
             |SINO;
                 enCampo1 = 83;  enCampo2 = 87;  enCampo3 = 91;  enCampo4 = 95;
             |FINSI;

             |SI nTeclaAsal = 10;  |HAZ PersAsalariado;  |FINSI;

             |HAZ CalcuAsalar;
         |FINSI;

         |SI nSwPregunta = 2;
             |SI nCampoTrab = 48;
                 enCampo1 = 82;  enCampo2 = 86;  enCampo3 = 90;  enCampo4 = 94;
             |SINO;
                 enCampo1 = 84;  enCampo2 = 88;  enCampo3 = 92;  enCampo4 = 96;
             |FINSI;

             |SI nTeclaAsal = 10;  |HAZ PersAsalariado;  |FINSI;

             |HAZ CalcuAsalar;
         |FINSI;

         |SI nSwPregunta = 3;
             enCampo1 = 101;  enCampo2 = 103;  enCampo3 = 105;
             enCampo4 = 97;   enCampo5 = 99;

             |SI nTeclaAsal = 10;  |HAZ PersNoAsalariado;  |FINSI;

             |HAZ CalcuNoAsalar;
         |FINSI;

         |SI nSwPregunta = 4;
             enCampo1 = 102;  enCampo2 = 104;  enCampo3 = 106;
             enCampo4 = 98;   enCampo5 = 100;

             |SI nTeclaAsal = 10;  |HAZ PersNoAsalariado;  |FINSI;

             |HAZ CalcuNoAsalar;
         |FINSI;
     |FINSI;

     nCampo1 = Campo + 11;

     |SI nSwPregunta = 0; |Y #19nControl = "P"; |Y nDias = 116; |Y eaDesElem = "N";
         #19nCampo1 = #19nCampoImp * ((#19nCampoTrab * #19nDias) / nDiasEjer);
     |SINO;
         #19nCampo1 = #19nCampoImp * #19nCampoTrab;
     |FINSI;

     |PINTA #19nCampo1;

     |SI #19nCampo1 = 0;
         #19nCampoTrab = 0;
         |PINTA #19nCampoTrab;
     |FINSI;

     |HAZ ImporteTotal;

     |SI nTeclaAsal = 11;
         |SI nCampoTrab = 26;  |O nCampoTrab = 48;
             |SI #19#117 ! 0;
                 |CONFI "      Ya tenemos Numeros introducidos, Desea traer numeros del IRPF";
                 |SI FSalida ! 0;  |ACABA;  |FINSI;
             |FINSI;
             |HAZ TraeProvisionIRPF;
             |ERROR;
         |FINSI;
     |FINSI;

     |SI nTeclaAsal = 12;
         |SI nCampoTrab = 26;  |O nCampoTrab = 48;
             |SI #19#118 ! 0;
                 |CONFI "      Ya tenemos Numeros introducidos, Desea traer numeros del IRPF";
                 |SI FSalida ! 0;  |ACABA;  |FINSI;
             |FINSI;
             |HAZ TraeDefinitivoIRPF;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Para;
     |SI nTeclaPara ! 5;  |ACABA;  |FINSI;

     nTeclaPara = 0;
     |ERROR;
|FPRC;

|PROCESO Dias;
     |SI #19#119 [ 60;                     #19#120 = 1.50;  |FINSI;
     |SI #19#119 ] 61; |Y #19#119 [ 120;   #19#120 = 1.35;  |FINSI;
     |SI #19#119 ] 121;                    #19#120 = 1.25;  |FINSI;
     |SI #19#119 = 0;                      #19#120 = 0;     |FINSI;
     |PINTA #19#120;
|FPRC;

|PROCESO SacaLoterias;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     |PUSHV 0501 2380;

     #111#0  = #19#123;
     #111#1  = #19#124;
     #111#2  = #19#125;
     #111#3  = #19#126;
     #111#4  = #19#127;
     #111#5  = #19#128;
     #111#6  = #19#129;
     #111#7  = #19#130;
     #111#8  = #19#131;
     #111#9  = #19#132;
     #111#20 = #19#118 - #19#132;
     #111#10 = #19#118;
     #111#11 = #19#133;
     #111#12 = #19#134;
     #111#13 = #19#135;
     #111#14 = #19#120;
     #111#15 = #19#136;
     #111#16 = #19#122;
     #111#17 = #19#137;
     #111#18 = #19#138;
     #111#19 = #19#147;

     |PINPA #0#111;
     |PINDA #0#111;
     |ENDATOS #1#111;
     |SI FSalida = 0;
         #19#123 = #111#0;
         #19#124 = #111#1;
         #19#125 = #111#2;
         #19#126 = #111#3;
         #19#127 = #111#4;
         #19#128 = #111#5;
         #19#129 = #111#6;
         #19#130 = #111#7;
         #19#131 = #111#8;
         #19#132 = #111#9;
         #19#118 = #111#10;
         #19#133 = #111#11;
         #19#134 = #111#12;
         #19#135 = #111#13;
         #19#120 = #111#14;
         #19#136 = #111#15;
         #19#122 = #111#16;
         #19#137 = #111#17;
         #19#138 = #111#18;
         #19#147 = #111#19;
     |FINSI;
     |POPV;
     |HAZ ImporteTotal;

     |ERROR;
|FPRC;

|PROCESO Tipo12m019;  |TIPO 12;
     |MENSA "       Pulse Tecla para Salir";
     |LEETECLA aAlfa;
|FPRC;

|PROCESO ImporteDeFuera;
     |ABRE #19;
     #19#0 = enEmpresa;
     #19#1 = enEjer;
     #19#2 = enComplem;
     #19#3 = enActividad;
     |LEE 101#19=;
     |SI FSalida ! 0;  |CIERRA #19;  |ACABA;  |FINSI;

     |ABRE #16;
     |SELECT #1#16;
     #16#0  = "E";
     #16#1  = eaCodEpi2;
     #16#41 = enCodEpi3;
     #16#2  = enEjer;
     |LEE 040#16=;
     |SI FSalida ! 0;  |DDEFECTO #16;  |FINSI;
     |CIERRA #16;

     |HAZ PonTipos;
     |HAZ ImporteTotal;

     |GRABA 020#19a;
     |LIBERA #19;
     |CIERRA #19;
|FPRC;

|PROGRAMA;
     |HAZ LeeEURODBMOD;

     |SI enTipoPase = 1;
         |HAZ ImporteDeFuera;
         |ACABA;
     |FINSI;

     enDondeEstoy = 2;

     |SI enEmpresa = 0;
         aFichero = ("19" + Usuario + "zzzzzzzz") % 108;
         |NOME_DAT #19 aFichero;

         aFichero = ("18" + Usuario + "zzzzzzzz") % 108;
         |NOME_DAT #18 aFichero;
     |FINSI;

     |ABRE #19;
     #19#0 = enEmpresa;
     #19#1 = enEjer;
     #19#2 = enComplem;
     #19#3 = enActividad;
     |LEE 101#19=;
     |SI FSalida ! 0;
         |DDEFECTO #19;
         #19#0 = enEmpresa;
         #19#1 = enEjer;
         #19#2 = enComplem;
         #19#3 = enActividad;

         |ABRE #214;
         #214#0 = #19#0;
         #214#1 = #19#3;
         |LEE 040#214=;
         |SI FSalida ! 0;  |DDEFECTO #214;  |FINSI;
         |CIERRA #214;

         #19#117 = #214#13;

         |GRABA 020#19b;
     |FINSI;

     |HAZ CogeModulo;

     |SI nError = 1;
         |SI enEntradaMod = 0;
             |MENAV "     Epigrafe no sujeto a Actividad de Modulos por I.V.A.";
         |FINSI;

         |BORRA 020#19a;
         |LIBERA #19;
         |CIERRA #19;
         |ACABA;
     |FINSI;

     |SI enEntradaMod [ 1;
         |SI enEntradaMod = 1;
             |PTEC 806;
             |PTEC 806;
         |FINSI;

         |PINPA #0#19;
         |PINDA #0#19;
         |ENDATOS #1#19;
         |SI FSalida = 0;
             |GRABA 020#19a;
         |FINSI;
         |LIBERA #19;
         |CIERRA #19;
     |FINSI;
|FPRO;
