|FICHEROS;
    dsmoz039 #0;
    dsmom041 #41;
    dsmom042 #42;

    dsmow035 #995,MANTE;      || Temporal de Grupos / Cuentas
    dsmow034 #997,MANTE;      || Temporal de Grupos / Cuentas
    dsmow041 #998,MANTE;
    dsmow043 #999;            || Temporal de Empresas Contables

   :/contagen/def/canempre #300;
   :/contagen/def/camaniva #301;
   :/contagen/def/caivalin #302;
|FIN;

|VARIABLES;
  aAlfa1 = "";
  aAlfa2 = "";
  nInkey = 0;
  nLibro = 0;
  aSerie = "";
  nDocum = 0;
  nElModo = 0;
  nSwEste = 0;
|FIN;

|INCLUYE i_variar;
|INCLUYE i_varcon;

|PROCESO eltipo11; |TIPO 11;
 nInkey = FSalida;
 |SI nInkey = 10; |O nInkey = 0;
     |PTEC 802;
 |FINSI;
 |SI nInkey = 11;
     |PTEC 825;
     |PTEC 802;
 |FINSI;
|FPRC;

|CALCULO eltipo0; |TIPO 0;
 nElModo = (FEntrada / 100) ! 0;
 |SI nElModo ! 2;
     |ERROR;
 |FINSI;
|FCAL;

|CALCULO eltipo1; |TIPO 1;
 nElModo = (FEntrada / 100) ! 0;
 |SI nElModo ! 2;
     |ERROR;
 |FINSI;
|FCAL;

|| ******************** Proceso de Facturas

|RUTINA ClaveBaja995;
 #995#0 = enEmpresa;
 #995#1 = 01;
 #995#2 = 00000000001;
|FRUT;

|RUTINA ClaveAlta995;
 #995#0 = enEmpresa;
 #995#1 = 99;
 #995#2 = 99999999999;
|FRUT;

|CALCULO lasfunciones; |TIPO 0;
 nInkey = FSalida;
 |SI nInkey = 10;
     nLibro =  #997#10;
     aSerie =  #997#11;
     nDocum =  #997#12;
     |PUSHV 1401 2380;
     |ENTLINEAL #1#995, -3, 5, 22, 1, ClaveBaja995, ClaveAlta995;
     #997#10 = nLibro;
     #997#11 = aSerie;
     #997#12 = nDocum;
     |POPV;
     |PINTA #997#10;
     |PINTA #997#11;
     |PINTA #997#12;
 |FINSI;
 |SI nInkey = 11;
     |HAZ BuscaEste;
 |FINSI;
|FCAL;

|CALCULO loleo; |TIPO 0;
 |ABRE #995;
 |SELECT #2#995;
 #995#0 = #997#0;  || Empresa
 #995#1 = #997#10; || Libro
 #995#3 = #997#11; || Serie
 #995#4 = #997#12; || Factura
 |LEE 001#995=;
 |SI FSalida ! 0;
     |MENAV "    Error, No existe Factura";
     |ERROR;
     |CIERRA #995;
     |ACABA;
 |FINSI;
 |SELECT #1#995;
 |CIERRA #995;

 |SI #995#7 ! #997#13;
     |MENAV "    Error. La Actividad NO es la del Elemento de Amortizacion";
     |ERROR;
     |ACABA;
 |FINSI;
 |SI #995#17 ! #997#6;
     |CONFI "    NLa Factura no tiene la misma fecha de venta. Continuar ";
     |SI FSalida ! 0;
         |ERROR;
         |ACABA;
     |FINSI;
 |FINSI;
 |SI #995#11 ! #997#7;
     |CONFI "    NLa Factura no tiene el mismo IMPORTE. Continuar ";
     |SI FSalida ! 0;
         |ERROR;
     |FINSI;
 |FINSI;
|FCAL;


|CALCULO LaRecoge;
 |SI FSalida = 0;
     nLibro = #995#1;
     aSerie = #995#3;
     nDocum = #995#4;

     |SI #995#7 ! #997#13;
         |MENAV "    Error. La Actividad NO es la del Elemento de Amortizacion";
         |ERROR;
         |ACABA;
     |FINSI;
     |SI #995#17 ! #997#6;
         |CONFI "    NLa Factura no tiene la misma fecha de venta. Continuar ";
         |SI FSalida ! 0;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
     |SI #995#11 ! #997#7;
         |CONFI "    NLa Factura no tiene el mismo IMPORTE. Continuar ";
         |SI FSalida ! 0;
             |ERROR;
         |FINSI;
     |FINSI;
 |FINSI;
 |PTEC 806;
|FCAL;

|| *********************************************************************
|PROCESO Busca1;
 nLibro =  #995#1;
 aSerie =  #995#3;
 nDocum =  #995#4;
 nSwEste = 1;
 |ERROR10;
|FPRC;

|DEFBUCLE Busca1;
 #995#1;
 5,7,11;
 #997#0, 00, 0000000001, #997#6, #997#13, #997#7;
 #997#0, 99, 9999999999, #997#6, #997#13, #997#7;
 ;
 NULL, Busca1;
|FIN;

|PROCESO BuscaEste;
 nLibro =  #997#10;
 aSerie =  #997#11;
 nDocum =  #997#12;
 nSwEste = 0;
 |BUCLE Busca1;
 |SI nSwEste = 1;
     #997#10 = nLibro; |PINTA #997#10;
     #997#11 = aSerie; |PINTA #997#11;
     #997#12 = nDocum; |PINTA #997#12;
 |SINO;
     |MENAV "    No encontrada factura correspondiente ";
 |FINSI;
|FPRC;
