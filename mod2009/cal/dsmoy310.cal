|FICHEROS;
     dsmoy000 #0;
     dsmom004 #4;
     dsmom107 #107;
     dsmow600 #600;
     dsmow601 #601,MANTE;

     dsmod310 #310;
     dsmow014 #999;

     dsmow508 #508;
     dsmow509 #509;
     dsmow510 #510;
     dsmow528 #528;
     dsmow530 #530;
     dsmow545 #545;
     dsmow546 #546;
     dsmow569 #569;

     &regisnif@ #709;
     &clientes@ #715;
     &datosper@ #718;
|FIN;

|VARIABLES;
|FIN;

|INCLUYE i_varemi;

|PROCESO Registro310_2001;
     |DDEFECTO #508;
     #508#1  = "310";
     #508#2  = "01";
     #508#3  = "";

     |SI enSwDeDonde = 1;
         #508#4   = (("00" + #715#15) % -102) + (("000" + #715#16) % -103);
         eaVarDni = #715#3;  |HAZ CalculameDNI;   #508#5   = eaVarDni;

         aAlfa1   = #718#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = aAlfa1;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa;
             eaAlfa = #718#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa;
             #508#6 = aAlfa1 + " " + aAlfa2;
             eaAlfa = #718#4;  |HAZ QuitaRaros;  #508#7 = eaAlfa;
         |SINO;
             eaAlfa = #715#1;  |HAZ QuitaRaros;  #508#6  = eaAlfa;
             #508#7  = ".";
         |FINSI;
         #508#8  = #715#29;
         eaAlfa  = #715#30;  |HAZ QuitaRaros;  #508#9 = eaAlfa;
         #508#10 = #715#31 % 104;
         #508#11 = #715#32;
         #508#12 = #715#33;
         #508#13 = #715#34;
         #508#14 = (("00" + #715#35) % -102) + (("000" + #715#36) % -103);
         eaAlfa  = #715#37;  |HAZ QuitaRaros;      #508#15 = eaAlfa;
         eaAlfa  = #715#38;  |HAZ QuitaRaros;      #508#16 = eaAlfa;
         eaAlfa  = #715#54;  |HAZ QuitaRarosTfno;  #508#17 = eaAlfa;

         eaDeleg     = #715#17;
         eaAdmin     = #715#18;

         |SI #310#40 ! 0;
             enModelo = 310;  enForzar = 0;  |HAZ CogeDatosBancos;

             |SI eaFormaPago = "1";  #508#51 = "X";  |FINSI;
             |SI eaFormaPago ! "1";  #508#52 = "X";  |FINSI;

             #508#53 = eaEntidad;
             #508#54 = eaOficina;
             #508#55 = eaDC;
             #508#56 = eaCuenta;
         |FINSI;
     |SINO;
         #508#4   = (("00" + #715#63) % -102) + (("000" + #715#64) % -103);
         eaVarDni = #715#13;  |HAZ CalculameDNI;   #508#5   = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;      #508#6  = eaAlfa;
         #508#7   = ".";
         #508#8   = #715#3;
         eaAlfa   = #715#4;  |HAZ QuitaRaros;      #508#9 = eaAlfa;
         #508#10 = #715#5 % 104;
         #508#11 = #715#6;
         #508#12 = #715#7;
         #508#13 = #715#8;
         #508#14 = (("00" + #715#9) % -102) + (("000" + #715#10) % -103);
         eaAlfa  = #715#11;  |HAZ QuitaRaros;     #508#15 = eaAlfa;
         eaAlfa  = #715#12;  |HAZ QuitaRaros;     #508#16 = eaAlfa;
         eaAlfa  = #715#14;  |HAZ QuitaRarosTfno; #508#17 = eaAlfa;

         eaDeleg     = #715#91;
         eaAdmin     = #715#92;

         |SI #310#40 ! 0;
             |SI #715#84 = "                    ";
                 #508#51  = "X";
             |SINO;
                 #508#52  = "X";
                 #508#53 = #715#81;
                 #508#54 = #715#82;
                 #508#55 = #715#83;
                 #508#56 = #715#84 % 110;
             |FINSI;
         |FINSI;
     |FINSI;

     #508#18  = #310#1;

     |SI #310#2 = 3;   #508#19 = 1;  |FINSI;
     |SI #310#2 = 6;   #508#19 = 2;  |FINSI;
     |SI #310#2 = 9;   #508#19 = 3;  |FINSI;
     |SI #310#2 = 12;  #508#19 = 4;  |FINSI;

     #508#20 = #310#6;
     enNume  = #310#7;   |HAZ Conver12;  #508#21 = eaAlfa;
     #508#22 = #310#8;
     enNume  = #310#9;   |HAZ Conver12;  #508#23 = eaAlfa;
     #508#24 = #310#10;
     enNume  = #310#11;  |HAZ Conver12;  #508#25 = eaAlfa;
     #508#26 = #310#12;
     enNume  = #310#13;  |HAZ Conver12;  #508#27 = eaAlfa;
     #508#28 = #310#14;
     enNume  = #310#15;  |HAZ Conver12;  #508#29 = eaAlfa;

     #508#30 = #310#16;
     enNume  = #310#17;  |HAZ Conver12;  #508#31 = eaAlfa;
     #508#32 = #310#18;
     enNume  = #310#19;  |HAZ Conver12;  #508#33 = eaAlfa;
     #508#34 = #310#20;
     enNume  = #310#21;  |HAZ Conver12;  #508#35 = eaAlfa;
     #508#36 = #310#22;
     enNume  = #310#23;  |HAZ Conver12;  #508#37 = eaAlfa;

     enNume  = #310#24;  |HAZ Conver12;  #508#38 = eaAlfa;
     enNume  = #310#27;  |HAZ Conver12;  #508#39 = eaAlfa;
     enNume  = #310#28;  |HAZ Conver12;  #508#40 = eaAlfa;
     enNume  = #310#29;  |HAZ Conver12;  #508#41 = eaAlfa;
     enNume  = #310#30;  |HAZ Conver12;  #508#42 = eaAlfa;
     enNume  = #310#31;  |HAZ Conver12;  #508#43 = eaAlfa;
     enNume  = #310#34;  |HAZ Conver12;  #508#44 = eaAlfa;
     enNume  = #310#35;  |HAZ Conver12;  #508#45 = eaAlfa;
     enNume  = #310#36;  |HAZ Conver12;  #508#46 = eaAlfa;
     enNume  = #310#37;  |HAZ Conver12;  #508#47 = eaAlfa;
     enNume  = #310#38;  |HAZ Conver12;  #508#48 = eaAlfa;

     |SI #310#24 = 0;  |Y #310#30 = 0; |Y #310#33 = 0;
         #508#49 = "X";
     |FINSI;
     enNume  = #310#40;  |HAZ Conver12;  #508#50 = eaAlfa;

     eaAlfa = #0#7;  |HAZ FechaBonito;
     #508#62 = #508#15;
     #508#63 = eaDiaB;
     #508#64 = eaMesB;
     #508#65 = eaAnyoB;
     #508#66 = &13 + &10;
|FPRC;

|PROCESO Registro311_2001;
     |DDEFECTO #509;
     #509#1  = "311";
     #509#2  = "01";
     #509#3  = "";

     |SI enSwDeDonde = 1;
         #509#4   = (("00" + #715#15) % -102) + (("000" + #715#16) % -103);
         eaVarDni = #715#3;  |HAZ CalculameDNI;   #509#5   = eaVarDni;

         aAlfa1   = #718#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = aAlfa1;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa;
             eaAlfa = #718#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa;
             #509#6 = aAlfa1 + " " + aAlfa2;
             eaAlfa = #718#4;  |HAZ QuitaRaros;  #509#7 = eaAlfa;
         |SINO;
             eaAlfa = #715#1;  |HAZ QuitaRaros;  #509#6  = eaAlfa;
             #509#7  = ".";
         |FINSI;
         #509#8  = #715#29;
         eaAlfa  = #715#30;  |HAZ QuitaRaros;  #509#9 = eaAlfa;
         #509#10 = #715#31 % 104;
         #509#11 = #715#32;
         #509#12 = #715#33;
         #509#13 = #715#34;
         #509#14 = (("00" + #715#35) % -102) + (("000" + #715#36) % -103);
         eaAlfa  = #715#37;  |HAZ QuitaRaros;      #509#15 = eaAlfa;
         eaAlfa  = #715#38;  |HAZ QuitaRaros;      #509#16 = eaAlfa;
         eaAlfa  = #715#54;  |HAZ QuitaRarosTfno;  #509#17 = eaAlfa;

         eaDeleg     = #715#17;
         eaAdmin     = #715#18;

         |SI #310#39 ! 0;
             enModelo = 310;  enForzar = 1;  |HAZ CogeDatosBancos;

             #509#54 = eaEntidad;
             #509#55 = eaOficina;
             #509#56 = eaDC;
             #509#57 = eaCuenta;
         |FINSI;

         |SI #310#40 ! 0;
             enModelo = 310;  enForzar = 0;  |HAZ CogeDatosBancos;

             |SI eaFormaPago = "1";  #509#58 = "X";  |FINSI;
             |SI eaFormaPago ! "1";  #509#59 = "X";  |FINSI;

             #509#61 = eaEntidad;
             #509#62 = eaOficina;
             #509#63 = eaDC;
             #509#64 = eaCuenta;
         |FINSI;
     |SINO;
         #509#4   = (("00" + #715#63) % -102) + (("000" + #715#64) % -103);
         eaVarDni = #715#13;  |HAZ CalculameDNI;   #509#5   = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;      #509#6  = eaAlfa;
         #509#7   = ".";
         #509#8   = #715#3;
         eaAlfa   = #715#4;  |HAZ QuitaRaros;      #509#9 = eaAlfa;
         #509#10 = #715#5 % 104;
         #509#11 = #715#6;
         #509#12 = #715#7;
         #509#13 = #715#8;
         #509#14 = (("00" + #715#9) % -102) + (("000" + #715#10) % -103);
         eaAlfa  = #715#11;  |HAZ QuitaRaros;     #509#15 = eaAlfa;
         eaAlfa  = #715#12;  |HAZ QuitaRaros;     #509#16 = eaAlfa;
         eaAlfa  = #715#14;  |HAZ QuitaRarosTfno; #509#17 = eaAlfa;

         eaDeleg     = #715#91;
         eaAdmin     = #715#92;

         |SI #310#39 ! 0;
             #509#54 = #715#81;
             #509#55 = #715#82;
             #509#56 = #715#83;
             #509#57 = #715#84 % 110;
         |FINSI;

         |SI #310#40 ! 0;
             |SI #715#84 = "                    ";
                 #509#58  = "X";
             |SINO;
                 #509#59  = "X";
                 #509#61 = #715#81;
                 #509#62 = #715#82;
                 #509#63 = #715#83;
                 #509#64 = #715#84 % 110;
             |FINSI;
         |FINSI;
     |FINSI;

     #509#18  = #310#1;

     #509#19 = #310#6;
     enNume  = #310#7;   |HAZ Conver12;  #509#20 = eaAlfa;
     #509#21 = #310#8;
     enNume  = #310#9;   |HAZ Conver12;  #509#22 = eaAlfa;
     #509#23 = #310#10;
     enNume  = #310#11;  |HAZ Conver12;  #509#24 = eaAlfa;
     #509#25 = #310#12;
     enNume  = #310#13;  |HAZ Conver12;  #509#26 = eaAlfa;
     #509#27 = #310#14;
     enNume  = #310#15;  |HAZ Conver12;  #509#28 = eaAlfa;

     #509#29 = #310#16;
     enNume  = #310#17;  |HAZ Conver12;  #509#30 = eaAlfa;
     #509#31 = #310#18;
     enNume  = #310#19;  |HAZ Conver12;  #509#32 = eaAlfa;
     #509#33 = #310#20;
     enNume  = #310#21;  |HAZ Conver12;  #509#34 = eaAlfa;
     #509#35 = #310#22;
     enNume  = #310#23;  |HAZ Conver12;  #509#36 = eaAlfa;

     enNume  = #310#24;  |HAZ Conver12;  #509#37 = eaAlfa;
     enNume  = #310#25;  |HAZ Conver12;  #509#38 = eaAlfa;
     enNume  = #310#26;  |HAZ Conver12;  #509#39 = eaAlfa;
     enNume  = #310#27;  |HAZ Conver12;  #509#40 = eaAlfa;
     enNume  = #310#28;  |HAZ Conver12;  #509#41 = eaAlfa;
     enNume  = #310#29;  |HAZ Conver12;  #509#42 = eaAlfa;
     enNume  = #310#30;  |HAZ Conver12;  #509#43 = eaAlfa;
     enNume  = #310#31;  |HAZ Conver12;  #509#44 = eaAlfa;
     enNume  = #310#32;  |HAZ Conver12;  #509#45 = eaAlfa;
     enNume  = #310#33;  |HAZ Conver12;  #509#46 = eaAlfa;
     enNume  = #310#34;  |HAZ Conver12;  #509#47 = eaAlfa;
     enNume  = #310#35;  |HAZ Conver12;  #509#48 = eaAlfa;
     enNume  = #310#36;  |HAZ Conver12;  #509#49 = eaAlfa;
     enNume  = #310#37;  |HAZ Conver12;  #509#50 = eaAlfa;
     enNume  = #310#38;  |HAZ Conver12;  #509#51 = eaAlfa;

     |SI #310#24 = 0;  |Y #310#30 = 0; |Y #310#33 = 0;
         #509#52 = "X";
     |FINSI;
     enNume  = #310#39;  |HAZ Conver12;  #509#53 = eaAlfa;
     enNume  = #310#40;  |HAZ Conver12;  #509#60 = eaAlfa;

     eaAlfa = #0#7;  |HAZ FechaBonito;
     #509#65 = #509#15;
     #509#66 = eaDiaB;
     #509#67 = eaMesB;
     #509#68 = eaAnyoB;
     #509#69 = &13 + &10;
|FPRC;

|PROCESO Registro374_2001;
     |DDEFECTO #530;
     #530#1  = "374";
     #530#2  = "01";
     #530#3  = "";

     |SI enSwDeDonde = 1;
         #530#4   = (("00" + #715#15) % -102) + (("000" + #715#16) % -103);
         eaVarDni = #715#3;  |HAZ CalculameDNI;   #530#5   = eaVarDni;

         aAlfa1   = #718#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = aAlfa1;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa;
             eaAlfa = #718#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa;
             #530#6 = aAlfa1 + " " + aAlfa2;
             eaAlfa = #718#4;  |HAZ QuitaRaros;  #530#7 = eaAlfa;
         |SINO;
             eaAlfa = #715#1;  |HAZ QuitaRaros;  #530#6  = eaAlfa;
             #530#7  = ".";
         |FINSI;
         #530#8  = #715#29;
         eaAlfa  = #715#30;  |HAZ QuitaRaros;  #530#9 = eaAlfa;
         #530#10 = #715#31 % 104;
         #530#11 = #715#32;
         #530#12 = #715#33;
         #530#13 = #715#34;
         #530#14 = (("00" + #715#35) % -102) + (("000" + #715#36) % -103);
         eaAlfa  = #715#37;  |HAZ QuitaRaros;      #530#15 = eaAlfa;
         eaAlfa  = #715#38;  |HAZ QuitaRaros;      #530#16 = eaAlfa;
         eaAlfa  = #715#54;  |HAZ QuitaRarosTfno;  #530#17 = eaAlfa;

         eaDeleg     = #715#17;
         eaAdmin     = #715#18;

         |SI #310#39 ! 0;
             enModelo = 310;  enForzar = 1;  |HAZ CogeDatosBancos;

             #530#56 = eaEntidad;
             #530#57 = eaOficina;
             #530#58 = eaDC;
             #530#59 = eaCuenta;
         |FINSI;

         |SI #310#40 ! 0;
             enModelo = 310;  enForzar = 0;  |HAZ CogeDatosBancos;

             |SI eaFormaPago = "1";  #530#60 = "X";  |FINSI;
             |SI eaFormaPago ! "1";  #530#61 = "X";  |FINSI;

             #530#63 = eaEntidad;
             #530#64 = eaOficina;
             #530#65 = eaDC;
             #530#66 = eaCuenta;
         |FINSI;
     |SINO;
         #530#4   = (("00" + #715#63) % -102) + (("000" + #715#64) % -103);
         eaVarDni = #715#13;  |HAZ CalculameDNI;   #530#5   = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;      #530#6  = eaAlfa;
         #530#7   = ".";
         #530#8   = #715#3;
         eaAlfa   = #715#4;  |HAZ QuitaRaros;      #530#9 = eaAlfa;
         #530#10 = #715#5 % 104;
         #530#11 = #715#6;
         #530#12 = #715#7;
         #530#13 = #715#8;
         #530#14 = (("00" + #715#9) % -102) + (("000" + #715#10) % -103);
         eaAlfa  = #715#11;  |HAZ QuitaRaros;     #530#15 = eaAlfa;
         eaAlfa  = #715#12;  |HAZ QuitaRaros;     #530#16 = eaAlfa;
         eaAlfa  = #715#14;  |HAZ QuitaRarosTfno; #530#17 = eaAlfa;

         eaDeleg     = #715#91;
         eaAdmin     = #715#92;

         |SI #310#39 ! 0;
             #530#56 = #715#81;
             #530#57 = #715#82;
             #530#58 = #715#83;
             #530#59 = #715#84 % 110;
         |FINSI;

         |SI #310#40 ! 0;
             |SI #715#84 = "                    ";
                 #530#60  = "X";
             |SINO;
                 #530#61  = "X";
                 #530#63 = #715#81;
                 #530#64 = #715#82;
                 #530#65 = #715#83;
                 #530#66 = #715#84 % 110;
             |FINSI;
         |FINSI;
     |FINSI;

     #530#18  = #310#1;

     #530#19 = #310#6;
     enNume  = #310#7;   |HAZ Conver12;  #530#20 = eaAlfa;
     #530#21 = #310#8;
     enNume  = #310#9;   |HAZ Conver12;  #530#22 = eaAlfa;
     #530#23 = #310#10;
     enNume  = #310#11;  |HAZ Conver12;  #530#24 = eaAlfa;
     #530#25 = #310#12;
     enNume  = #310#13;  |HAZ Conver12;  #530#26 = eaAlfa;
     #530#27 = #310#14;
     enNume  = #310#15;  |HAZ Conver12;  #530#28 = eaAlfa;

     #530#29 = #310#16;
     enNume  = #310#17;  |HAZ Conver12;  #530#30 = eaAlfa;
     #530#31 = #310#18;
     enNume  = #310#19;  |HAZ Conver12;  #530#32 = eaAlfa;
     #530#33 = #310#20;
     enNume  = #310#21;  |HAZ Conver12;  #530#34 = eaAlfa;
     #530#35 = #310#22;
     enNume  = #310#23;  |HAZ Conver12;  #530#36 = eaAlfa;

     enNume  = #310#24;  |HAZ Conver12;  #530#37 = eaAlfa;
     enNume  = #310#25;  |HAZ Conver12;  #530#38 = eaAlfa;
     enNume  = #310#26;  |HAZ Conver12;  #530#39 = eaAlfa;
     enNume  = #310#27;  |HAZ Conver12;  #530#40 = eaAlfa;
     enNume  = #310#28;  |HAZ Conver12;  #530#41 = eaAlfa;
     enNume  = #310#29;  |HAZ Conver12;  #530#42 = eaAlfa;
     enNume  = #310#30;  |HAZ Conver12;  #530#43 = eaAlfa;
     enNume  = #310#31;  |HAZ Conver12;  #530#44 = eaAlfa;
     enNume  = #310#32;  |HAZ Conver12;  #530#45 = eaAlfa;
     enNume  = #310#33;  |HAZ Conver12;  #530#46 = eaAlfa;
     enNume  = #310#34;  |HAZ Conver12;  #530#47 = eaAlfa;
     enNume  = #310#35;  |HAZ Conver12;  #530#48 = eaAlfa;
     enNume  = #310#36;  |HAZ Conver12;  #530#49 = eaAlfa;
     enNume  = #310#37;  |HAZ Conver12;  #530#50 = eaAlfa;
     enNume  = 0;        |HAZ Conver12;  #530#51 = eaAlfa;
     enNume  = #310#36;  |HAZ Conver12;  #530#52 = eaAlfa;
     enNume  = #310#38;  |HAZ Conver12;  #530#53 = eaAlfa;

     |SI #310#24 = 0;  |Y #310#30 = 0; |Y #310#33 = 0;
         #530#54 = "X";
     |FINSI;
     enNume  = #310#39;  |HAZ Conver12;  #530#55 = eaAlfa;
     enNume  = #310#40;  |HAZ Conver12;  #530#62 = eaAlfa;

     eaAlfa = #0#7;  |HAZ FechaBonito;
     #530#69 = #530#15;
     #530#70 = eaDiaB;
     #530#71 = eaMesB;
     #530#72 = eaAnyoB;
     #530#73 = &13 + &10;
|FPRC;

|PROCESO Registro311Internet_2001;
     |DDEFECTO #528;
     #528#1  = "311";
     #528#2  = "E";

     |SI enSwDeDonde = 1;
         eaVarDni = #715#3;  |HAZ CalculameDNI;    #528#3  = eaVarDni;
         eaAlfa = #715#57;  |HAZ QuitaRaros;       #528#4  = eaAlfa;
         eaAlfa = #715#53;  |HAZ QuitaRaros;       #528#41 = eaAlfa;
         eaAlfa = #715#54;  |HAZ QuitaRarosTfno;   #528#42 = eaAlfa;

         |SI #310#39 ! 0;
             enModelo = 310;  enForzar = 1;  |HAZ CogeDatosBancos;

             #528#35 = eaEntidad;
             #528#36 = eaOficina;
             #528#37 = eaDC;
             #528#38 = eaCuenta;
         |FINSI;
     |SINO;
         eaVarDni = #715#13;  |HAZ CalculameDNI;   #528#3  = eaVarDni;
         eaAlfa   = #715#1;   |HAZ QuitaRaros;     #528#41 = eaAlfa;
         eaAlfa   = #715#14;  |HAZ QuitaRarosTfno; #528#42 = eaAlfa;

         |SI #310#39 ! 0;
             |SI #715#84 ! "                    ";
                 #528#35 = #715#81;
                 #528#36 = #715#82;
                 #528#37 = #715#83;
                 #528#38 = #715#84 % 110;
             |FINSI;
         |FINSI;
     |FINSI;

     #528#5 = #310#1;

     |SI #310#2 = 3;   #528#6 = "1T";  |FINSI;
     |SI #310#2 = 6;   #528#6 = "2T";  |FINSI;
     |SI #310#2 = 9;   #528#6 = "3T";  |FINSI;
     |SI #310#2 = 12;  #528#6 = "4T";  |FINSI;

     |SI #310#6 ! "    ";
         #528#7  = "1" + #310#6;
     |FINSI;
     enNume  = #310#7;   |HAZ Conver17;  #528#8  = eaAlfa;

     |SI #310#8 ! "    ";
         #528#9  = "1" + #310#8;
     |FINSI;
     enNume  = #310#9;   |HAZ Conver17;  #528#10 = eaAlfa;

     |SI #310#10 ! "    ";
         #528#11 = "1" + #310#10;
     |FINSI;
     enNume  = #310#11;  |HAZ Conver17;  #528#12 = eaAlfa;

     #528#13 = #310#16;
     enNume  = #310#17;  |HAZ Conver17;  #528#14 = eaAlfa;
     #528#15 = #310#18;
     enNume  = #310#19;  |HAZ Conver17;  #528#16 = eaAlfa;
     #528#17 = #310#20;
     enNume  = #310#21;  |HAZ Conver17;  #528#18 = eaAlfa;

     enNume  = #310#24;  |HAZ Conver17;  #528#19 = eaAlfa;
     enNume  = #310#25;  |HAZ Conver17;  #528#20 = eaAlfa;
     enNume  = #310#26;  |HAZ Conver17;  #528#21 = eaAlfa;
     enNume  = #310#27;  |HAZ Conver17;  #528#22 = eaAlfa;
     enNume  = #310#28;  |HAZ Conver17;  #528#23 = eaAlfa;
     enNume  = #310#29;  |HAZ Conver17;  #528#24 = eaAlfa;
     enNume  = #310#30;  |HAZ Conver17;  #528#25 = eaAlfa;
     enNume  = #310#31;  |HAZ Conver17;  #528#26 = eaAlfa;
     enNume  = #310#32;  |HAZ Conver17;  #528#27 = eaAlfa;
     enNume  = #310#33;  |HAZ Conver17;  #528#28 = eaAlfa;
     enNume  = #310#34;  |HAZ Conver17;  #528#29 = eaAlfa;
     enNume  = #310#35;  |HAZ Conver17;  #528#30 = eaAlfa;
     enNume  = #310#36;  |HAZ Conver17;  #528#31 = eaAlfa;
     enNume  = #310#37;  |HAZ Conver17;  #528#32 = eaAlfa;
     enNume  = 0;        |HAZ Conver17;  #528#33 = eaAlfa;
     enNume  = #310#36;  |HAZ Conver17;  #528#34 = eaAlfa;

     enIngresar = #310#40;
     enDevolver = #310#39;
     enCompensar= #310#38;
     enImpReal  = #310#34;
     enCas21    = #310#30;
     enCas27    = #310#33;
     enCas31    = #310#35;
     enCas34    = #310#36;
     |HAZ GrabaImpreso;
|FPRC;

|PROCESO Registro313_2001;
     |DDEFECTO #510;
     #510#1  = "313";
     #510#2  = "01";
     #510#3  = "";

     |SI enSwDeDonde = 1;
         #510#4   = (("00" + #715#15) % -102) + (("000" + #715#16) % -103);
         eaVarDni = #715#3;  |HAZ CalculameDNI;   #510#5   = eaVarDni;

         aAlfa1   = #718#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = aAlfa1;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa;
             eaAlfa = #718#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa;
             #510#6 = aAlfa1 + " " + aAlfa2;
             eaAlfa = #718#4;  |HAZ QuitaRaros;  #510#7 = eaAlfa;
         |SINO;
             eaAlfa = #715#1;  |HAZ QuitaRaros;  #510#6  = eaAlfa;
             #510#7  = ".";
         |FINSI;
         #510#8  = #715#29;
         eaAlfa  = #715#30;  |HAZ QuitaRaros;  #510#9 = eaAlfa;
         #510#10 = #715#31 % 104;
         #510#11 = #715#32;
         #510#12 = #715#33;
         #510#13 = #715#34;
         #510#14 = (("00" + #715#35) % -102) + (("000" + #715#36) % -103);
         eaAlfa  = #715#37;  |HAZ QuitaRaros;      #510#15 = eaAlfa;
         eaAlfa  = #715#38;  |HAZ QuitaRaros;      #510#16 = eaAlfa;
         eaAlfa  = #715#54;  |HAZ QuitaRarosTfno;  #510#17 = eaAlfa;

         eaDeleg     = #715#17;
         eaAdmin     = #715#18;

         |SI #310#40 ! 0;
             enModelo = 310;  enForzar = 0;  |HAZ CogeDatosBancos;

             |SI eaFormaPago = "1";  #510#53 = "X";  |FINSI;
             |SI eaFormaPago ! "1";  #510#54 = "X";  |FINSI;

             #510#55 = eaEntidad;
             #510#56 = eaOficina;
             #510#57 = eaDC;
             #510#58 = eaCuenta;
         |FINSI;
     |SINO;
         #510#4   = (("00" + #715#63) % -102) + (("000" + #715#64) % -103);
         eaVarDni = #715#13;  |HAZ CalculameDNI;   #510#5   = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;      #510#6  = eaAlfa;
         #510#7   = ".";
         #510#8   = #715#3;
         eaAlfa   = #715#4;  |HAZ QuitaRaros;      #510#9 = eaAlfa;
         #510#10 = #715#5 % 104;
         #510#11 = #715#6;
         #510#12 = #715#7;
         #510#13 = #715#8;
         #510#14 = (("00" + #715#9) % -102) + (("000" + #715#10) % -103);
         eaAlfa  = #715#11;  |HAZ QuitaRaros;     #510#15 = eaAlfa;
         eaAlfa  = #715#12;  |HAZ QuitaRaros;     #510#16 = eaAlfa;
         eaAlfa  = #715#14;  |HAZ QuitaRarosTfno; #510#17 = eaAlfa;

         eaDeleg     = #715#91;
         eaAdmin     = #715#92;

         |SI #310#40 ! 0;
             |SI #715#84 = "                    ";
                 #510#53  = "X";
             |SINO;
                 #510#54  = "X";
                 #510#55 = #715#81;
                 #510#56 = #715#82;
                 #510#57 = #715#83;
                 #510#58 = #715#84 % 110;
             |FINSI;
         |FINSI;
     |FINSI;

     #510#18  = #310#1;

     |SI #310#2 = 3;   #510#19 = 1;  |FINSI;
     |SI #310#2 = 6;   #510#19 = 2;  |FINSI;
     |SI #310#2 = 9;   #510#19 = 3;  |FINSI;
     |SI #310#2 = 12;  #510#19 = 4;  |FINSI;

     #510#20 = #310#6;
     enNume  = #310#7;   |HAZ Conver12;  #510#21 = eaAlfa;
     #510#22 = #310#8;
     enNume  = #310#9;   |HAZ Conver12;  #510#23 = eaAlfa;
     #510#24 = #310#10;
     enNume  = #310#11;  |HAZ Conver12;  #510#25 = eaAlfa;
     #510#26 = #310#12;
     enNume  = #310#13;  |HAZ Conver12;  #510#27 = eaAlfa;

     #510#28 = #310#16;
     enNume  = #310#17;  |HAZ Conver12;  #510#29 = eaAlfa;
     #510#30 = #310#18;
     enNume  = #310#19;  |HAZ Conver12;  #510#31 = eaAlfa;
     #510#32 = #310#20;
     enNume  = #310#21;  |HAZ Conver12;  #510#33 = eaAlfa;
     #510#34 = #310#22;
     enNume  = #310#23;  |HAZ Conver12;  #510#35 = eaAlfa;

     enNume  = #310#24;  |HAZ Conver12;  #510#36 = eaAlfa;
     enNume  = #310#27;  |HAZ Conver12;  #510#37 = eaAlfa;
     enNume  = #310#28;  |HAZ Conver12;  #510#38 = eaAlfa;
     enNume  = #310#29;  |HAZ Conver12;  #510#39 = eaAlfa;
     enNume  = #310#30;  |HAZ Conver12;  #510#40 = eaAlfa;
     enNume  = #310#31;  |HAZ Conver12;  #510#41 = eaAlfa;
     enNume  = #310#34;  |HAZ Conver12;  #510#42 = eaAlfa;
     enNume  = #310#35;  |HAZ Conver12;  #510#43 = eaAlfa;
     enNume  = #310#36;  |HAZ Conver12;  #510#44 = eaAlfa;
     enNume  = #310#37;  |HAZ Conver12;  #510#45 = eaAlfa;
     enNume  = 0;        |HAZ Conver12;  #510#46 = eaAlfa;
     enNume  = 0;        |HAZ Conver12;  #510#47 = eaAlfa;
     enNume  = #310#38;  |HAZ Conver12;  #510#48 = eaAlfa;

     |SI #310#24 = 0;  |Y #310#30 = 0; |Y #310#33 = 0;
         #510#49 = "X";
     |FINSI;
     enNume  = #310#40;  |HAZ Conver12;  #510#52 = eaAlfa;

     eaAlfa = #0#7;  |HAZ FechaBonito;
     #510#64 = #510#15;
     #510#65 = eaDiaB;
     #510#66 = eaMesB;
     #510#67 = eaAnyoB;
     #510#68 = &13 + &10;
|FPRC;

|PROCESO Carga310_2001;
     |SI eaMoneda = "PESETAS";
         |SI #0#4 ! 12;
             |HAZ Registro310_2001;  || Modelo 1, 2, 3 Trimestre
             |SI nTecla = 1;
                 aAlfa = "";
                 |PARA nCampo = 1;  |SI nCampo [ 66;  |HACIENDO nCampo = nCampo + 1;
                       aAlfa = #508nCampo;
                       |XGRABA nHandle2, aAlfa;
                 |SIGUE;
                 |XCIERRA nHandle2;

                 eaFOrigen  = eaPathEmision + "310" + (("00000" + #999#0) % -105) + ".TXT";
                 eaFDestino = eaPathLanza + "310" + (("00000" + #999#0) % -105) + ".TXT";
                 |HAZ CopiaFichero;

                 |FBORRA eaFOrigen;
             |FINSI;
         |SINO;
             |SI #0#6 [ 2000;
                 |HAZ Registro311_2001;   || Ultimo Trimestre 2000
             |SINO;
                 |HAZ Registro374_2001;   || Ultimo Trimestre 2001
             |FINSI;

             |SI nTecla = 1;
                 aAlfa = "";
                 |SI #0#6 [ 2000;
                     |PARA nCampo = 1;  |SI nCampo [ 69;  |HACIENDO nCampo = nCampo + 1;
                           aAlfa = #509nCampo;
                           |XGRABA nHandle2, aAlfa;
                     |SIGUE;
                 |SINO;
                     |PARA nCampo = 1;  |SI nCampo [ 73;  |HACIENDO nCampo = nCampo + 1;
                           aAlfa = #530nCampo;
                           |XGRABA nHandle2, aAlfa;
                     |SIGUE;
                 |FINSI;
                 |XCIERRA nHandle2;

                 eaFOrigen  = eaPathEmision + "310" + (("00000" + #999#0) % -105) + ".TXT";
                 eaFDestino = eaPathLanza + "310" + (("00000" + #999#0) % -105) + ".TXT";
                 |HAZ CopiaFichero;

                 |FBORRA eaFOrigen;
             |FINSI;
         |FINSI;
     |SINO;
         |SI nTecla = 4;
             |SI #0#4 ! 12;
                 |HAZ Registro310_2001;  || Modelo 1, 2, 3 Trimestre
             |SINO;
                 |SI #0#6 [ 2000;
                     |HAZ Registro311_2001;  || Ultimo Trimestre 2000
                 |SINO;
                     |HAZ Registro374_2001;  || Ultimo Trimestre 2001
                 |FINSI;
             |FINSI;
         |SINO;
             |SI #0#4 ! 12;
                 |HAZ Registro313_2001;
                 |SI nTecla = 1;
                     aAlfa = "";
                     |PARA nCampo = 1;  |SI nCampo [ 68;  |HACIENDO nCampo = nCampo + 1;
                           aAlfa = #510nCampo;
                           |XGRABA nHandle2, aAlfa;
                     |SIGUE;
                     |XCIERRA nHandle2;

                     eaFOrigen  = eaPathEmision + "310" + (("00000" + #999#0) % -105) + ".TXT";
                     eaFDestino = eaPathLanza + "310" + (("00000" + #999#0) % -105) + ".TXT";
                     |HAZ CopiaFichero;

                     |FBORRA eaFOrigen;
                 |FINSI;
             |SINO;
                 |SI nTecla = 1;
                     |HAZ Registro374_2001;   || Ultimo Trimestre 2001
                     |PARA nCampo = 1;  |SI nCampo [ 73;  |HACIENDO nCampo = nCampo + 1;
                           aAlfa = #530nCampo;
                           |XGRABA nHandle2, aAlfa;
                     |SIGUE;
                     |XCIERRA nHandle2;

                     eaFOrigen  = eaPathEmision + "310" + (("00000" + #999#0) % -105) + ".TXT";
                     eaFDestino = eaPathLanza + "310" + (("00000" + #999#0) % -105) + ".TXT";
                     |HAZ CopiaFichero;

                     |FBORRA eaFOrigen;
                 |SINO;
                     |HAZ Registro311Internet_2001;   || Ultimo Trimestre 2001
                     |PARA nCampo = 1;  |SI nCampo [ 46;  |HACIENDO nCampo = nCampo + 1;
                           aAlfa = #528nCampo;
                           |XGRABA nHandle2, aAlfa;
                     |SIGUE;
                     |XCIERRA nHandle2;

                     eaFOrigen  = eaPathEmision + "310" + (("00000" + #999#0) % -105) + ".TXT";
                     eaFDestino = eaPathInternet + "310" + (("00000" + #999#0) % -105) + ".TXT";
                     |HAZ CopiaFichero;

                     |FBORRA eaFOrigen;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nTecla = 1;
         aAlfa = "del err" + (("00000" + #999#0) % -105) + ".TXT" + &13 + &10;
         |XGRABA nHandle1, aAlfa;

         aAlfa = "wait mipf " + "310" + (("00000" + #999#0) % -105) + ".TXT";

         |SI #600#0 = "N";  aAlfa = aAlfa + " s";  |FINSI;
         |SI #600#1 = "S";  aAlfa = aAlfa + " a";  |FINSI;
         aAlfa = aAlfa + " " + #600#2;
         aAlfa = aAlfa + &13 + &10;
         |XGRABA nHandle1, aAlfa;

         aAlfa = "move errores.txt err" + (("00000" + #999#0) % -105) + ".TXT" + &13 + &10;
         aAlfa = aAlfa + &13 + &10;

         |XGRABA nHandle1, aAlfa;
     |FINSI;

     |SI nTecla = 4;
         |PRINT;
         |PIEINF;
     |FINSI;
|FPRC;

|PROCESO CargaImprime310;
     aAlfa = "del err" + (("00000" + #999#0) % -105) + ".TXT" + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "wait mipf32 ";
     aAlfa = aAlfa + "/E:310" + (("00000" + #999#0) % -105) + ".TXT ";
     aAlfa = aAlfa + "/R:err" + (("00000" + #999#0) % -105) + ".TXT ";
     |SI eaImpresora ! "";
         aAlfa = aAlfa + "/I:" + &34 + eaImpresora + &34;
     |FINSI;
     aAlfa = aAlfa + " /C:" + #601#0;
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle1, aAlfa;
|FPRC;

|PROCESO TDeclaracion310;
     |SI #310#40 ! 0;
         enNume = #310#40;  |HAZ Conver13;  #545#61 = eaAlfa;

         enModelo = 310;  enForzar = 0;  |HAZ CogeDatosBancos;

         |SI eaFormaPago = "1";  #545#62 = "X";  |FINSI;
         |SI eaFormaPago ! "1";  #545#63 = "X";  |FINSI;

         #545#64 = eaEntidad;
         #545#65 = eaOficina;
         #545#66 = eaDC;
         #545#67 = eaCuenta;
     |SINO;
         enNume  = 0;  |HAZ Conver13;  #545#61 = eaAlfa;
     |FINSI;

     #545#4 = "";
     |SI nTecla ! 3;
         |SI #310#40 = 0;  |Y #310#38 = 0;  |Y #310#39 = 0;
          |Y #310#24 = 0;
             #545#4 = "N";
         |FINSI;
     |SINO;
         #545#4 = "";
         |SI #310#40 ! 0;  #545#4 = "I";  |FINSI;
         |SI #310#39 ! 0;  #545#4 = "D";  |FINSI;
         |SI #310#38 ! 0;  #545#4 = "C";  |FINSI;

         |SI #310#40 = 0;  |Y #310#38 = 0;  |Y #310#39 = 0;
          |Y #310#24 = 0;
             #545#4 = "N";
        |FINSI;
     |FINSI;
|FPRC;

|PROCESO Carga310_2002;
     enCodCli = #310#0;
     |HAZ LeePersona;

     |DDEFECTO #545;

     #545#1  = "310";
     #545#2  = "01";
     #545#3  = "";

     |SI enSwDeDonde = 1;
         #545#5   = (("00" + #715#15) % -102) + (("000" + #715#16) % -103);
         eaVarDni = #715#3;   |HAZ CalculameDNI;   #545#6  = eaVarDni;
         eaAlfa   = #715#57;  |HAZ QuitaRaros;     #545#7  = eaAlfa;

         aAlfa1   = #718#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = aAlfa1;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa;
             eaAlfa = #718#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa;
             #545#8 = aAlfa1 + " " + aAlfa2;
             eaAlfa = #718#4;  |HAZ QuitaRaros;  #545#9 = eaAlfa;
         |SINO;
             eaAlfa = #715#1;  |HAZ QuitaRaros;  #545#8  = eaAlfa;
             #545#9  = ".";
         |FINSI;
         #545#10 = #715#29;
         eaAlfa  = #715#30;  |HAZ QuitaRaros;  #545#11 = eaAlfa;
         #545#12 = #715#31 % 104;
         #545#13 = #715#32;
         #545#14 = #715#33;
         #545#15 = #715#34;
         #545#16 = (("00" + #715#35) % -102) + (("000" + #715#36) % -103);
         eaAlfa  = #715#37;  |HAZ QuitaRaros;       #545#17 = eaAlfa;
         eaAlfa  = #715#38;  |HAZ QuitaRaros;       #545#18 = eaAlfa;
         eaAlfa  = #715#54;  |HAZ QuitaRarosTfno;   #545#19 = eaAlfa;
         eaAlfa  = #715#53;  |HAZ QuitaRaros;       #545#55 = eaAlfa;
         eaAlfa  = #715#54;  |HAZ QuitaRarosTfno;   #545#56 = eaAlfa;
         eaDeleg = #715#17;
         eaAdmin = #715#18;
     |SINO;
         #545#5   = (("00" + #715#63) % -102) + (("000" + #715#64) % -103);
         eaVarDni = #715#13;  |HAZ CalculameDNI;   #545#6   = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;      #545#8   = eaAlfa;
         #545#9   = ".";
         #545#10  = #715#3;
         eaAlfa   = #715#4;  |HAZ QuitaRaros;      #545#11  = eaAlfa;
         #545#12 = #715#5 % 104;
         #545#13 = #715#6;
         #545#14 = #715#7;
         #545#15 = #715#8;
         #545#16 = (("00" + #715#9) % -102) + (("000" + #715#10) % -103);
         eaAlfa  = #715#11;  |HAZ QuitaRaros;     #545#17 = eaAlfa;
         eaAlfa  = #715#12;  |HAZ QuitaRaros;     #545#18 = eaAlfa;
         eaAlfa  = #715#14;  |HAZ QuitaRarosTfno; #545#19 = eaAlfa;
         eaAlfa  = #715#1;   |HAZ QuitaRaros;     #545#55 = eaAlfa;
         eaAlfa  = #715#14;  |HAZ QuitaRarosTfno; #545#56 = eaAlfa;
         eaDeleg = #715#91;
         eaAdmin = #715#92;
     |FINSI;

     #545#20  = #310#1;

     |SI #310#2 = 3;   #545#21 = "1T";  |FINSI;
     |SI #310#2 = 6;   #545#21 = "2T";  |FINSI;
     |SI #310#2 = 9;   #545#21 = "3T";  |FINSI;

     |SI #310#7 ! 0;   #545#22 = #310#6;  |FINSI;
      enNume  = #310#7;   |HAZ Conver13;  #545#23 = eaAlfa;

     |SI #310#9 ! 0;   #545#24 = #310#8;  |FINSI;
     enNume  = #310#9;   |HAZ Conver13;  #545#25 = eaAlfa;

     |SI #310#11 ! 0;  #545#26 = #310#10; |FINSI;
     enNume  = #310#11;  |HAZ Conver13;  #545#27 = eaAlfa;

     |SI #310#13 ! 0;  #545#28 = #310#12; |FINSI;
     enNume  = #310#13;  |HAZ Conver13;  #545#29 = eaAlfa;

     |SI #310#15 ! 0;  #545#30 = #310#14; |FINSI;
     enNume  = #310#15;  |HAZ Conver13;  #545#31 = eaAlfa;

     #545#32 = #310#16;
     enNume  = #310#17;  |HAZ Conver13;  #545#33 = eaAlfa;
     #545#34 = #310#18;
     enNume  = #310#19;  |HAZ Conver13;  #545#35 = eaAlfa;
     #545#36 = #310#20;
     enNume  = #310#21;  |HAZ Conver13;  #545#37 = eaAlfa;
     #545#38 = #310#22;
     enNume  = #310#23;  |HAZ Conver13;  #545#39 = eaAlfa;

     enNume  = #310#24;  |HAZ Conver13;  #545#40 = eaAlfa;
     enNume  = #310#27;  |HAZ Conver13;  #545#41 = eaAlfa;
     enNume  = #310#28;  |HAZ Conver13;  #545#42 = eaAlfa;
     enNume  = #310#29;  |HAZ Conver13;  #545#43 = eaAlfa;
     enNume  = #310#30;  |HAZ Conver13;  #545#44 = eaAlfa;
     enNume  = #310#31;  |HAZ Conver13;  #545#45 = eaAlfa;
     enNume  = #310#34;  |HAZ Conver13;  #545#46 = eaAlfa;
     enNume  = #310#35;  |HAZ Conver13;  #545#47 = eaAlfa;
     enNume  = #310#36;  |HAZ Conver13;  #545#48 = eaAlfa;
     enNume  = #310#37;  |HAZ Conver13;  #545#49 = eaAlfa;
     enNume  = #310#41;  |HAZ Conver13;  #545#50 = eaAlfa;

     #310#36 = #310#36 - #310#41;

     enNume  = #310#36;  |HAZ Conver13;  #545#51 = eaAlfa;
     enNume  = #310#38;  |HAZ Conver13;  #545#52 = eaAlfa;

     |HAZ TDeclaracion310;

     |SI #310#4 > 0;
         #545#53 = #4#20;
         #545#54 = #4#21;
     |FINSI;

     eaAlfa  = #0#7;  |HAZ FechaBonito;
     #545#73 = #545#17;
     #545#74 = eaDiaB;
     #545#75 = eaMesB;
     #545#76 = eaAnyoB;
     #545#77 = &13 + &10;

     |SI nTecla = 1;
         #545#7  = "";
         #545#53 = "";
         #545#55 = "";
         #545#56 = "";
         #545#57 = "";
         nTCampo = 77;
     |FINSI;

     |SI nTecla = 3;
         #545#2  = "";
         #545#3  = "";
         #545#5  = "";
         #545#8  = "";
         #545#9  = "";
         #545#10 = "";
         #545#11 = "";
         #545#12 = "";
         #545#13 = "";
         #545#14 = "";
         #545#15 = "";
         #545#16 = "";
         #545#17 = "";
         #545#18 = "";
         #545#19 = "";
         #545#30 = "";
         #545#31 = "0000000000000";
         #545#61 = "0000000000000";
         #545#62 = "";
         #545#63 = "";
         #545#64 = "";
         #545#65 = "";
         #545#66 = "";
         #545#67 = "";
         #545#68 = "";
         #545#69 = "";
         #545#70 = "";
         #545#71 = "";
         #545#72 = "";
         #545#73 = "";
         #545#74 = "";
         #545#75 = "";
         #545#76 = "";
         #545#77 = "";
         nTCampo = 76;
     |FINSI;

     |SI nTecla = 1;  |O nTecla = 3;
         aAlfa = "";
         |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #545nCampo;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
         |XCIERRA nHandle2;

         |SI nTecla = 1;
             eaFOrigen  = eaPathEmision + "310" + (("00000" + #999#0) % -105) + ".TXT";
             eaFDestino = eaPathLanza + "310" + (("00000" + #999#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

             |FBORRA eaFOrigen;

             |HAZ CargaImprime310;
         |FINSI;

         |SI nTecla = 3;
             eaFOrigen  = eaPathEmision + "310" + (("00000" + #999#0) % -105) + ".TXT";
             eaFDestino = eaPathInternet + "310" + (("00000" + #999#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

             |FBORRA eaFOrigen;

             |HAZ GrabaImpreso;
         |FINSI;
     |SINO;
         |PRINT;
         |PIEINF;
     |FINSI;
|FPRC;

|PROCESO TDeclaracion310_2007;
     |SI #310#40 ! 0;
         enNume = #310#40;  |HAZ Conver13;  #569#51 = eaAlfa;

         enModelo = 310;  enForzar = 0;  |HAZ CogeDatosBancos;

                                  #569#52 = "0";
         |SI eaFormaPago = "1";   #569#52 = "1";  |FINSI;
         |SI eaFormaPago = "2";   #569#52 = "2";  |FINSI;

         |SI eaFormaPago = "3"; |O eaFormaPago = "4"; |O eaFormaPago = "5";
                                 #569#52 = "2";
             |SI nTecla = 3;     #569#52 = eaFormaPago;  |FINSI;
         |FINSI;

         #569#53 = eaEntidad;
         #569#54 = eaOficina;
         #569#55 = eaDC;
         #569#56 = eaCuenta;
     |SINO;
         #569#52 = "0";
         enNume  = 0;  |HAZ Conver13;  #569#51 = eaAlfa;
     |FINSI;

     #569#4 = "";
     |SI nTecla ! 3;
         |SI #310#40 = 0;  |Y #310#38 = 0;  |Y #310#39 = 0;
          |Y #310#24 = 0;
             #569#4 = "N";
         |FINSI;
     |SINO;
         #569#4 = "";
         |SI #310#40 ! 0;
                                     #569#4 = "I";
             |SI eaFormaPago = "3";  #569#4 = "U";  |FINSI;
             |SI eaFormaPago = "4";  #569#4 = "A";  |FINSI;
             |SI eaFormaPago = "5";  #569#4 = "E";  |FINSI;
         |FINSI;

         |SI #310#38 ! 0;
             #569#4 = "C";
         |FINSI;

         |SI #310#40 = 0;  |Y #310#38 = 0;  |Y #310#39 = 0;
          |Y #310#24 = 0;
             #569#4 = "N";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Carga310_2007;
     enCodCli = #310#0;
     |HAZ LeePersona;

     |DDEFECTO #569;

     #569#1  = "310";
     #569#2  = "01";
     #569#3  = "";

     |SI enSwDeDonde = 1;
         #569#5   = (("00" + #715#15) % -102) + (("000" + #715#16) % -103);
         eaVarDni = #715#3;   |HAZ CalculameDNI;   #569#6  = eaVarDni;
         eaAlfa   = #715#57;  |HAZ QuitaRaros;     #569#7  = eaAlfa;

         aAlfa1   = #718#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = aAlfa1;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa;
             eaAlfa = #718#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa;
             #569#8 = aAlfa1 + " " + aAlfa2;
             eaAlfa = #718#4;  |HAZ QuitaRaros;  #569#9 = eaAlfa;
         |SINO;
             eaAlfa = #715#1;  |HAZ QuitaRaros;  #569#8  = eaAlfa;
             #569#9  = ".";
         |FINSI;
         eaAlfa  = #715#53;  |HAZ QuitaRaros;       #569#45 = eaAlfa;
         eaAlfa  = #715#54;  |HAZ QuitaRarosTfno;   #569#46 = eaAlfa;
         eaDeleg = #715#17;
         eaAdmin = #715#18;
         eaAlfa  = #715#37;  |HAZ QuitaRaros;       #569#57 = eaAlfa;
     |SINO;
         #569#5   = (("00" + #715#63) % -102) + (("000" + #715#64) % -103);
         eaVarDni = #715#13;  |HAZ CalculameDNI;   #569#6   = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;      #569#8   = eaAlfa;
         #569#9   = ".";
         eaAlfa  = #715#1;   |HAZ QuitaRaros;     #569#45 = eaAlfa;
         eaAlfa  = #715#14;  |HAZ QuitaRarosTfno; #569#46 = eaAlfa;
         eaDeleg = #715#91;
         eaAdmin = #715#92;
         eaAlfa  = #715#11;  |HAZ QuitaRaros;     #569#57 = eaAlfa;
     |FINSI;

     #569#10  = #310#1;

     |SI #310#2 = 3;   #569#11 = "1T";  |FINSI;
     |SI #310#2 = 6;   #569#11 = "2T";  |FINSI;
     |SI #310#2 = 9;   #569#11 = "3T";  |FINSI;

     |SI #310#7 ! 0;   #569#12 = #310#6;  |FINSI;
     enNume  = #310#7;   |HAZ Conver13;  #569#13 = eaAlfa;

     |SI #310#9 ! 0;   #569#14 = #310#8;  |FINSI;
     enNume  = #310#9;   |HAZ Conver13;  #569#15 = eaAlfa;

     |SI #310#11 ! 0;  #569#16 = #310#10; |FINSI;
     enNume  = #310#11;  |HAZ Conver13;  #569#17 = eaAlfa;

     |SI #310#13 ! 0;  #569#18 = #310#12; |FINSI;
     enNume  = #310#13;  |HAZ Conver13;  #569#19 = eaAlfa;

     |SI #310#15 ! 0;  #569#20 = #310#14; |FINSI;
     enNume  = #310#15;  |HAZ Conver13;  #569#21 = eaAlfa;

     #569#22 = #310#16;
     enNume  = #310#17;  |HAZ Conver13;  #569#23 = eaAlfa;
     #569#24 = #310#18;
     enNume  = #310#19;  |HAZ Conver13;  #569#25 = eaAlfa;
     #569#26 = #310#20;
     enNume  = #310#21;  |HAZ Conver13;  #569#27 = eaAlfa;
     #569#28 = #310#22;
     enNume  = #310#23;  |HAZ Conver13;  #569#29 = eaAlfa;

     enNume  = #310#24;  |HAZ Conver13;  #569#30 = eaAlfa;
     enNume  = #310#27;  |HAZ Conver13;  #569#31 = eaAlfa;
     enNume  = #310#28;  |HAZ Conver13;  #569#32 = eaAlfa;
     enNume  = #310#29;  |HAZ Conver13;  #569#33 = eaAlfa;
     enNume  = #310#30;  |HAZ Conver13;  #569#34 = eaAlfa;
     enNume  = #310#31;  |HAZ Conver13;  #569#35 = eaAlfa;
     enNume  = #310#34;  |HAZ Conver13;  #569#36 = eaAlfa;
     enNume  = #310#35;  |HAZ Conver13;  #569#37 = eaAlfa;
     enNume  = #310#36;  |HAZ Conver13;  #569#38 = eaAlfa;
     enNume  = #310#37;  |HAZ Conver13;  #569#39 = eaAlfa;
     enNume  = #310#41;  |HAZ Conver13;  #569#40 = eaAlfa;

     #310#36 = #310#36 - #310#41;

     enNume  = #310#36;  |HAZ Conver13;  #569#41 = eaAlfa;
     enNume  = #310#38;  |HAZ Conver13;  #569#42 = eaAlfa;

     |HAZ TDeclaracion310_2007;

     |SI #310#4 > 0;
         #569#43 = #4#20;
         #569#44 = #4#21;
     |FINSI;

     eaAlfa  = #0#7;  |HAZ FechaBonito;
     #569#58 = eaDiaB;
     #569#59 = eaMesB;
     #569#60 = eaAnyoB;
     #569#61 = &13 + &10;

     |SI nTecla = 1;
         #569#7  = "";
         #569#43 = "";
         #569#45 = "";
         #569#46 = "";
         #569#47 = "";
         #569#48 = "";
         #569#49 = "";
         #569#50 = "";
         nTCampo = 61;
     |FINSI;

     |SI nTecla = 3;
         #569#2  = "";
         #569#3  = "";
         #569#5  = "";
         #569#8  = "";
         #569#9  = "";
         #569#20 = "";
         #569#21 = "0000000000000";
         #569#42 = "0000000000000";
         #569#48 = "0000000000000";
         #569#57 = "";
         #569#58 = "";
         #569#59 = "";
         #569#60 = "";
         #569#61 = "";
         nTCampo = 60;
     |FINSI;

     |SI nTecla = 1;  |O nTecla = 3;
         aAlfa = "";
         |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #569nCampo;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
         |XCIERRA nHandle2;

         |SI nTecla = 1;
             eaFOrigen  = eaPathEmision + "310" + (("00000" + #999#0) % -105) + ".TXT";
             eaFDestino = eaPathLanza + "310" + (("00000" + #999#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

             |FBORRA eaFOrigen;

             |HAZ CargaImprime310;
         |FINSI;

         |SI nTecla = 3;
             eaFOrigen  = eaPathEmision + "310" + (("00000" + #999#0) % -105) + ".TXT";
             eaFDestino = eaPathInternet + "310" + (("00000" + #999#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

             |FBORRA eaFOrigen;

             |HAZ GrabaImpreso;
         |FINSI;
     |SINO;
         |PRINT;
         |PIEINF;
     |FINSI;
|FPRC;

|PROCESO TDeclaracion311;
     |SI #310#39 ! 0;
         enNume = #310#39;  |HAZ Conver13;  #546#50 = eaAlfa;

         enModelo = 310;  enForzar = 1;  |HAZ CogeDatosBancos;

         #546#51 = eaEntidad;
         #546#52 = eaOficina;
         #546#53 = eaDC;
         #546#54 = eaCuenta;
     |SINO;
         enNume  = 0;  |HAZ Conver13;  #546#50 = eaAlfa;
     |FINSI;

     |SI #310#40 ! 0;
         enNume = #310#40;  |HAZ Conver13;  #546#57 = eaAlfa;

         enModelo = 310;  enForzar = 0;  |HAZ CogeDatosBancos;

         |SI eaFormaPago = "1";  #546#55 = "X";  |FINSI;
         |SI eaFormaPago ! "1";  #546#56 = "X";  |FINSI;

         #546#58 = eaEntidad;
         #546#59 = eaOficina;
         #546#60 = eaDC;
         #546#61 = eaCuenta;
     |SINO;
         enNume  = 0;  |HAZ Conver13;  #546#57 = eaAlfa;
     |FINSI;

     #546#4 = "";
     |SI nTecla ! 3;
         |SI #310#40 = 0;  |Y #310#38 = 0;  |Y #310#39 = 0;
          |Y #310#24 = 0;
             #546#4 = "N";
         |FINSI;
     |SINO;
         #546#4 = "";
         |SI #310#40 ! 0;
                                     #546#4 = "I";
             |SI eaFormaPago = "3";  #546#4 = "U";  |FINSI;
             |SI eaFormaPago = "4";  #546#4 = "A";  |FINSI;
             |SI eaFormaPago = "5";  #546#4 = "E";  |FINSI;
         |FINSI;

         |SI #310#39 ! 0;  #546#4 = "D";  |FINSI;
         |SI #310#38 ! 0;  #546#4 = "C";  |FINSI;

         |SI #310#40 = 0;  |Y #310#38 = 0;  |Y #310#39 = 0;
          |Y #310#24 = 0;
             #546#4 = "N";
         |FINSI;

         |SI #310#2 = 12;  |Y #310#1 = 2007;  |Y #310#40 ! 0;
                                     aAlfa  = "0";
             |SI eaFormaPago = "1";  aAlfa  = "1";  |FINSI;
             |SI eaFormaPago = "2";  aAlfa  = "2";  |FINSI;
             |SI eaFormaPago = "3";  aAlfa  = "3";  |FINSI;
             |SI eaFormaPago = "4";  aAlfa  = "4";  |FINSI;
             |SI eaFormaPago = "5";  aAlfa  = "5";  |FINSI;

             #546#55 = aAlfa;
             #546#56 = "";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO TDeclaracion311_2008;
     #546#55 = "0";

     |SI #310#39 ! 0;
         enNume = #310#39;  |HAZ Conver13;  #546#50 = eaAlfa;

         enModelo = 310;  enForzar = 1;  |HAZ CogeDatosBancos;

         #546#51 = eaEntidad;
         #546#52 = eaOficina;
         #546#53 = eaDC;
         #546#54 = eaCuenta;
     |SINO;
         enNume  = 0;  |HAZ Conver13;  #546#50 = eaAlfa;
     |FINSI;

     |SI #310#40 ! 0;
         enNume = #310#40;  |HAZ Conver13;  #546#57 = eaAlfa;

         enModelo = 310;  enForzar = 0;  |HAZ CogeDatosBancos;

                                 aAlfa  = "0";
         |SI eaFormaPago = "1";  aAlfa  = "1";  |FINSI;
         |SI eaFormaPago = "2";  aAlfa  = "2";  |FINSI;
         |SI eaFormaPago = "3";  aAlfa  = "3";  |FINSI;
         |SI eaFormaPago = "4";  aAlfa  = "4";  |FINSI;
         |SI eaFormaPago = "5";  aAlfa  = "5";  |FINSI;

         #546#55 = aAlfa;
         #546#56 = "";

         #546#58 = eaEntidad;
         #546#59 = eaOficina;
         #546#60 = eaDC;
         #546#61 = eaCuenta;
     |SINO;
         enNume  = 0;  |HAZ Conver13;  #546#57 = eaAlfa;
     |FINSI;

     #546#4 = "";
     |SI nTecla ! 3;
         |SI #310#40 = 0;  |Y #310#38 = 0;  |Y #310#39 = 0;
          |Y #310#24 = 0;
             #546#4 = "N";
         |FINSI;
     |SINO;
         #546#4 = "";
         |SI #310#40 ! 0;
                                      #546#4 = "I";
             |SI eaFormaPago = "3";   #546#4 = "U";  |FINSI;
             |SI eaFormaPago = "4";   #546#4 = "A";  |FINSI;
             |SI eaFormaPago = "5";   #546#4 = "E";  |FINSI;
         |FINSI;

         |SI #310#39 ! 0;  #546#4 = "D";  |FINSI;
         |SI #310#38 ! 0;  #546#4 = "C";  |FINSI;

         |SI #310#40 = 0;  |Y #310#38 = 0;  |Y #310#39 = 0;
          |Y #310#24 = 0;
             #546#4 = "N";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Carga311_2002;
     enCodCli = #310#0;
     |HAZ LeePersona;

     |DDEFECTO #546;

     #546#1  = "311";
     #546#2  = "01";
     #546#3  = "";

     |SI enSwDeDonde = 1;
         #546#5   = (("00" + #715#15) % -102) + (("000" + #715#16) % -103);
         eaVarDni = #715#3;  |HAZ CalculameDNI;   #546#6   = eaVarDni;
         eaAlfa   = #715#57;  |HAZ QuitaRaros;    #546#7  = eaAlfa;

         aAlfa1   = #718#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = aAlfa1;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa;
             eaAlfa = #718#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa;
             #546#8 = aAlfa1 + " " + aAlfa2;
             eaAlfa = #718#4;  |HAZ QuitaRaros;  #546#9 = eaAlfa;
         |SINO;
             eaAlfa = #715#1;  |HAZ QuitaRaros;  #546#8  = eaAlfa;
             #546#9  = ".";
         |FINSI;
         #546#10 = #715#29;
         eaAlfa  = #715#30;  |HAZ QuitaRaros;  #546#11 = eaAlfa;
         #546#12 = #715#31 % 104;
         #546#13 = #715#32;
         #546#14 = #715#33;
         #546#15 = #715#34;
         #546#16 = (("00" + #715#35) % -102) + (("000" + #715#36) % -103);
         eaAlfa  = #715#37;  |HAZ QuitaRaros;       #546#17 = eaAlfa;
         eaAlfa  = #715#38;  |HAZ QuitaRaros;       #546#18 = eaAlfa;
         eaAlfa  = #715#54;  |HAZ QuitaRarosTfno;   #546#19 = eaAlfa;
         eaAlfa  = #715#53;  |HAZ QuitaRaros;       #546#64 = eaAlfa;
         eaAlfa  = #715#54;  |HAZ QuitaRarosTfno;   #546#65 = eaAlfa;
         eaDeleg = #715#17;
         eaAdmin = #715#18;
     |SINO;
         #546#5   = (("00" + #715#63) % -102) + (("000" + #715#64) % -103);
         eaVarDni = #715#13;  |HAZ CalculameDNI;   #546#6   = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;      #546#8   = eaAlfa;
         #546#9   = ".";
         #546#10  = #715#3;
         eaAlfa   = #715#4;  |HAZ QuitaRaros;      #546#11  = eaAlfa;
         #546#12 = #715#5 % 104;
         #546#13 = #715#6;
         #546#14 = #715#7;
         #546#15 = #715#8;
         #546#16 = (("00" + #715#9) % -102) + (("000" + #715#10) % -103);
         eaAlfa  = #715#11;  |HAZ QuitaRaros;     #546#17 = eaAlfa;
         eaAlfa  = #715#12;  |HAZ QuitaRaros;     #546#18 = eaAlfa;
         eaAlfa  = #715#14;  |HAZ QuitaRarosTfno; #546#19 = eaAlfa;
         eaAlfa  = #715#1;   |HAZ QuitaRaros;     #546#64 = eaAlfa;
         eaAlfa  = #715#14;  |HAZ QuitaRarosTfno; #546#65 = eaAlfa;
         eaDeleg = #715#91;
         eaAdmin = #715#92;
     |FINSI;

     #546#20  = #310#1;

     |SI #310#7 ! 0;   #546#21 = #310#6;  |FINSI;
     enNume  = #310#7;   |HAZ Conver13;  #546#22 = eaAlfa;

     |SI #310#9 ! 0;   #546#23 = #310#8;  |FINSI;
     enNume  = #310#9;   |HAZ Conver13;  #546#24 = eaAlfa;

     |SI #310#11 ! 0;   #546#25 = #310#10;  |FINSI;
     enNume  = #310#11;  |HAZ Conver13;  #546#26 = eaAlfa;

     #546#27 = #310#16;
     enNume  = #310#17;  |HAZ Conver13;  #546#28 = eaAlfa;
     #546#29 = #310#18;
     enNume  = #310#19;  |HAZ Conver13;  #546#30 = eaAlfa;
     #546#31 = #310#20;
     enNume  = #310#21;  |HAZ Conver13;  #546#32 = eaAlfa;

     enNume  = #310#24;  |HAZ Conver13;  #546#33 = eaAlfa;
     enNume  = #310#25;  |HAZ Conver13;  #546#34 = eaAlfa;
     enNume  = #310#26;  |HAZ Conver13;  #546#35 = eaAlfa;
     enNume  = #310#27;  |HAZ Conver13;  #546#36 = eaAlfa;
     enNume  = #310#28;  |HAZ Conver13;  #546#37 = eaAlfa;
     enNume  = #310#29;  |HAZ Conver13;  #546#38 = eaAlfa;
     enNume  = #310#30;  |HAZ Conver13;  #546#39 = eaAlfa;
     enNume  = #310#31;  |HAZ Conver13;  #546#40 = eaAlfa;
     enNume  = #310#32;  |HAZ Conver13;  #546#41 = eaAlfa;
     enNume  = #310#33;  |HAZ Conver13;  #546#42 = eaAlfa;
     enNume  = #310#34;  |HAZ Conver13;  #546#43 = eaAlfa;
     enNume  = #310#35;  |HAZ Conver13;  #546#44 = eaAlfa;
     enNume  = #310#36;  |HAZ Conver13;  #546#45 = eaAlfa;
     enNume  = #310#37;  |HAZ Conver13;  #546#46 = eaAlfa;
     enNume  = #310#41;  |HAZ Conver13;  #546#47 = eaAlfa;

     #310#36 = #310#36 - #310#41;

     enNume  = #310#36;  |HAZ Conver13;  #546#48 = eaAlfa;
     enNume  = #310#38;  |HAZ Conver13;  #546#49 = eaAlfa;

     |SI #310#1 [ 2007;
         |HAZ  TDeclaracion311;
     |SINO;
         |HAZ  TDeclaracion311_2008;
     |FINSI;

     |SI #310#4 > 0;
         #546#62 = #4#20;
         #546#63 = #4#21;
     |FINSI;

     eaAlfa  = #0#7;  |HAZ FechaBonito;
     #546#70 = #546#17;
     #546#71 = eaDiaB;
     #546#72 = eaMesB;
     #546#73 = eaAnyoB;
     #546#74 = &13 + &10;

     |SI nTecla = 1;
         #546#7  = "";
         #546#62 = "";
         #546#64 = "";
         #546#65 = "";
         #546#66 = "";
         nTCampo = 74;
     |FINSI;

     |SI nTecla = 3;
         |SI #310#1 < 2007;
             #546#2  = "";
             #546#3  = "";
             #546#5  = "";
             #546#8  = "";
             #546#9  = "";
             #546#10 = "";
             #546#11 = "";
             #546#12 = "";
             #546#13 = "";
             #546#14 = "";
             #546#15 = "";
             #546#16 = "";
             #546#17 = "";
             #546#18 = "";
             #546#19 = "";
             #546#49 = "0000000000000";
             #546#50 = "0000000000000";
             #546#55 = "";
             #546#56 = "";
             #546#57 = "";
             #546#58 = "";
             #546#59 = "";
             #546#60 = "";
             #546#61 = "";
             #546#70 = "";
             #546#71 = "";
             #546#72 = "";
             #546#73 = "";
             #546#74 = "";
         |SINO;
             #546#2  = "";
             #546#3  = "";
             #546#5  = "";
             #546#8  = "";
             #546#9  = "";
             #546#10 = "";
             #546#11 = "";
             #546#12 = "";
             #546#13 = "";
             #546#14 = "";
             #546#15 = "";
             #546#16 = "";
             #546#17 = "";
             #546#18 = "";
             #546#19 = "";
             #546#49 = "0000000000000";
             #546#50 = "0000000000000";
             #546#70 = "";
             #546#71 = "";
             #546#72 = "";
             #546#73 = "";
             #546#74 = "";
         |FINSI;

         nTCampo = 73;
     |FINSI;

     |SI nTecla = 1;  |O nTecla = 3;
         aAlfa = "";
         |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
               nGraba = 0;
               |SI nCampo = 56;
                   |SI #310#1 = 2007;  |Y nTecla = 3;
                       nGraba = 1;
                   |FINSI;

                   |SI #310#1 ] 2008;
                       nGraba = 1;
                   |FINSI;
               |FINSI;

               |SI nGraba = 0;
                   aAlfa = #546nCampo;
                   |XGRABA nHandle2, aAlfa;
               |FINSI;
         |SIGUE;
         |XCIERRA nHandle2;

         |SI nTecla = 1;
             eaFOrigen  = eaPathEmision + "310" + (("00000" + #999#0) % -105) + ".TXT";
             eaFDestino = eaPathLanza + "310" + (("00000" + #999#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

             |FBORRA eaFOrigen;

             |HAZ CargaImprime310;
         |FINSI;

         |SI nTecla = 3;
             eaFOrigen  = eaPathEmision + "310" + (("00000" + #999#0) % -105) + ".TXT";
             eaFDestino = eaPathInternet + "310" + (("00000" + #999#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

             |FBORRA eaFOrigen;

             |HAZ GrabaImpreso;
         |FINSI;
     |SINO;
         |PRINT;
         |PIEINF;
     |FINSI;
|FPRC;

|PROCESO QueHacemos310;
     |ABRE #4;
     #4#0  = #999#0;
     #4#1  = #999#1;
     #4#2  = #999#2;
     #4#3  = #999#5;
     #4#4  = #999#7;
     |LEE 040#4=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #4;

     |ABRE #310;
     #310#0 = #4#0;
     #310#1 = #4#1;
     #310#2 = #4#2;
     #310#3 = #4#3;
     #310#4 = #4#4;
     #310#5 = 0;
     |LEE 040#310=;
     |SI FSalida ! 0;  |CIERRA #310;  |ACABA;  |FINSI;
     |CIERRA #310;

     enIngresar = #310#40;
     enDevolver = #310#39;
     enCompensar= #310#38;
     enImpReal  = #310#34;
     enCas21    = #310#30;
     enCas27    = #310#33;
     enCas31    = #310#35;
     enCas34    = #310#36;

     |SI nTecla = 1;  |O nTecla = 3;
         aAbre = eaPathEmision + "310" + (("00000" + #999#0) % -105) + ".TXT";
         |XABRE "BW", aAbre, nHandle2;
     |FINSI;

     enCodCli = #310#0;
     |HAZ LeePersona;

     |SI #0#6 [ 2001;
         |HAZ Carga310_2001;
     |FINSI;

     |SI #0#6 ] 2002;  |Y #0#6 [ 2006;
         |SI #0#4 ! 12;
             |HAZ Carga310_2002;
         |SINO;
             |HAZ Carga311_2002;
         |FINSI;
     |FINSI;

     |SI #0#6 ] 2007;
         |SI #0#4 ! 12;
             |HAZ Carga310_2007;
         |SINO;
             |HAZ Carga311_2002;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsmow014C310;
     #999#1;
     6;
     00000, 0000, 00, "S";
     99999, 9999, 99, "S";
     ;
     NULL, QueHacemos310;
|FIN;

|DEFBUCLE dsmow014N310;
     #999#2;
     6;
     "                                        ", "S";
     "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz", "S";
     ;
     NULL, QueHacemos310;
|FIN;

|PROCESO AbreImprime310;
     aAbre = eaPathLanza + "imprime.bat";
     |XABRE "CBW", aAbre, nHandle1;

     aAlfa = "CD " + eaPathLanza + &13 + &10;    |XGRABA nHandle1, aAlfa;

     aAlfa    = #0#6;
     aAlfa    = aAlfa % -102;
     aVersion = "";

     |SI #0#6 ] 2008;
         aVersion = "01";
         |SI #0#6 = 2008;
             |SI #0#4 ] 4;
                 aVersion = "02";
             |FINSI;
         |FINSI;
     |FINSI;

     |SI aVersion = "";
         aAlfa = "ZLS" + aAlfa + "MPF.EXE -y" + &13 + &10;
     |SINO;
         aAlfa = "Z" + aAlfa + aVersion + "MPF.EXE -y" + &13 + &10;
     |FINSI;
     |XGRABA nHandle1, aAlfa;
|FPRC;

|PROCESO EmiteEsto310_2001;
     aAlfa = "DEL die*.*" + &13 + &10;  |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.exe"  + &13 + &10;  |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.tab"  + &13 + &10;  |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.imp"  + &13 + &10;  |XGRABA nHandle1, aAlfa;
     |XCIERRA nHandle1;

     |HAZ Copiampf;

     aAlfa = eaPathLanza + "IMPRIME";
     |RSYSTEM aAlfa;

     eaFichError = "err";
     eaFichDatos = #0#0;
     eaFichAuxil = "";

     |HAZ BuscaErroresL;
|FPRC;

|PROCESO EmiteEsto310_2002;
     aAlfa = "DEL *.wmf" + &13 + &10;             |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.tab"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.dll"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errorm~1.txt" + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errormipf.txt"  + &13 + &10;    |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errmipf.txt"  + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.exe"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     |XCIERRA nHandle1;

     |HAZ Copiampf;

     aAlfa = eaPathLanza + "IMPRIME";
     |RSYSTEM aAlfa;

     eaFichError = "err";
     eaFichDatos = #0#0;
     eaFichAuxil = "";

     |HAZ BuscaErroresL;
|FPRC;

|PROCESO Boton3101;
     |PTEC 824;
|FPRC;

|PROCESO Boton3102;
     |PTEC 825;
|FPRC;

|PROCESO Boton3103;
     |PTEC 826;
|FPRC;

|PROCESO Boton3104;
     |PTEC 827;
|FPRC;

|PROCESO Boton3105;
     |PTEC 806;
|FPRC;

|PROCESO Botones310;
     |BLANCO 0501 2380;

     |CONTROL_SIMPLE 0, "LBOTON, <F2> Emision Papel Oficial Laser          ", 0513, 0754, Boton3101;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F3> Emision Papel Oficial Continuo       ", 0913, 1154, Boton3102;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F4> Presentacion Telematica              ", 1313, 1554, Boton3103;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F5> Informe de Comprobacion              ", 1713, 1954, Boton3104;
     nBoton4 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,ESC Cancelar", 2365, 2378, Boton3105;
     nBoton5 = FSalida;

     aF2 = &255 + "824";
     aF3 = &255 + "825";
     aF4 = &255 + "826";
     aF5 = &255 + "827";
     aF6 = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF2;  nTecla = 1;   |SAL;  |FINSI;
         |SI aTecla = aF3;  nTecla = 2;   |SAL;  |FINSI;
         |SI aTecla = aF4;  nTecla = 3;   |SAL;  |FINSI;
         |SI aTecla = aF5;  nTecla = 4;   |SAL;  |FINSI;
         |SI aTecla = aF6;  nTecla = 0;   |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton5;

     |PULSATECLA;
|FPRC;

|PROGRAMA;
     aFichero = ("000" + Usuario) % 108;
     |NOME_DAT #0 aFichero;

     aFichero = ("imp" + Usuario) % 108;
     |NOME_DAT #999 aFichero;

     |ABRE #107;
     |LEE 040#107p;
     |SI FSalida ! 0;
         |CIERRA #107;
         |SUB_EJECUTA_NP "dsmom107";
         |ABRE #107;
     |FINSI;

     |LEE 040#107p;
     |SI FSalida ! 0;  |DDEFECTO #107;  |FINSI;
     |CIERRA #107;

     |ABRE #0;
     |LEE 000#0p;
     |CIERRA #0;

     enCambiaMoneda = 1;
     enSwTrata      = 0;

     |SI eaParametro ! "310C";
         |HAZ Botones310;
     |SINO;
         nTecla = 4;
     |FINSI;

     |SI nTecla = 0;  |ACABA;  |FINSI;

     |SI nTecla = 1;
         |HAZ CompruebaEjecutable;
         |SI enError = 1;  |ACABA;  |FINSI;

         |SI #0#6 [ 2001;
             |PARA;  |SI;  |HACIENDO;
                  |DDEFECTO #600;
                  |PINPA #0#600;
                  |PINDA #0#600;
                  |ENDATOS #1#600;
                  |SI FSalida = 0;
                      |HAZ AbreImprime310;
                      |SAL;
                  |FINSI;
             |SIGUE;
         |SINO;
             |PARA;  |SI;  |HACIENDO;
                  #601#0 = #107#5;
                  #601#1 = #107#7;

                  |C_M #601#0, 1, "S";
                  |C_M #601#1, 1, "S";
                  |SI #107#6 = "N";  |C_M #601#0, 1, "N";  |FINSI;
                  |SI #107#8 = "N";  |C_M #601#1, 1, "N";  |FINSI;

                  nPedirPanta = 0;
                  |SI #107#6 = "N";  |Y #107#8 = "N";  |Y #107#7 = "N";
                      nPedirPanta = 1;
                  |FINSI;

                  FSalida = 0;
                  |SI nPedirPanta = 0;
                      |PINPA #0#601;
                      |PINDA #0#601;
                      |ENDATOS #1#601;
                  |FINSI;

                  |SI FSalida = 0;
                      |HAZ AbreImprime310;
                      |SAL;
                  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;

     |SI nTecla = 2;
         |MENAV "     Opcion no instalada";
         |ACABA;
     |FINSI;

     |SI nTecla = 3;
         |SI #0#6 [ 2001;
             |SI eaMoneda = "PESETAS";
                 |MENAV "     Moneda Incorrecta";
                 |ACABA;
             |FINSI;

             |SI #0#4 ! 12;
                 |MENAV "     Opcion no instalada";
                 |ACABA;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nTecla = 4;
         |IMPRE 0;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |SI #0#6 [ 2001;
             |SI #0#4 ! 12;
                 |INFOR "m310co01";
             |SINO;
                 |SI #0#6 [ 2000;
                     |INFOR "m311co01";
                 |SINO;
                     |INFOR "m311co02";
                 |FINSI;
             |FINSI;
         |SINO;
             |SI #0#4 ! 12;
                 |INFOR "m310co02";
             |SINO;
                 |INFOR "m311co03";
             |FINSI;
         |FINSI;
         |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;
     |FINSI;

     nSwLee = 0;
     |SI #0#8 = "C";
         |BUCLE dsmow014C310;
     |SINO;
         |BUCLE dsmow014N310;
     |FINSI;

     |SI nTecla = 1;
         |SI #0#6 [ 2001;
             |HAZ EmiteEsto310_2001;
         |FINSI;

         |SI #0#6 ] 2002;
             |HAZ EmiteEsto310_2002;
         |FINSI;
     |FINSI;

     |SI nTecla = 3;
         aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
         |MENAV aAlfa;
     |FINSI;

     |SI nTecla = 4;
         |FININF;
         |FINIMP;
     |FINSI;
|FPRO;
