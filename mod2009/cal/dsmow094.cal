|FICHEROS;
   dsmoz090 #0;
   dsmom090 #90,MANTE;
   dsmom091 #91,MANTE;
   dsmow094 #94,MANTE;

   &imagen90@ #441;
   &imagen91@ #442;
|FIN;

|VARIABLES;
  &enDMaqu   = 0;
  &enHMaqu   = 0;
  inkey      = 0;
  aAlfa1     = "";
  aAlfa2     = "";
  nNume1     = 0;
  nSwSal     = 0;
  nSwEsta    = 0;
  nContenido = "";
  aAlfa      = "";
   esalta    = 0;
   esaltaL   = 0;
   elcon       = 0;
   aTMov       = "";
   nTMov       = 0;
   nSw         = 0;
   nAlta       = 0;
   nBaja       = 0;
   nTMovAnt    = 0;
   nHLin       = 0;
   aTABaja     = "";
   aTAAlta     = 0;
   fTAAlta     = @;
   fTABaja     = @;
   nEstaLin    = 0;

   fFecha1 = @;
   fFecha2 = @;
   nUltEjer = 0;
   nCuota   = 0;
   nEjer    = 0;
   nExiLin  = 0;
   nPara1   = 0;
   nSwExiste = 0;


   nNumero   = 0;
   nNumNueva = 0;
   nEstado   = 0;
|FIN;

|INCLUYE i_variar;
|INCLUYE i_varcon;  || Variables de Contabilidad

**************************************************************************
|PROCESO BuscaNumero;
      #441#0 = #94#0;
      #441#1 = 99999;
      |LEE 001#441];
      |SI FSalida = 0;
          |LEE 040#441a;
       |SINO;
          |LEE 040#441u;
       |FINSI;
       |SI FSalida = 0; |Y #441#0 = #94#0;
            nNumNueva = #441#1;
       |FINSI;
       nNumNueva = nNumNueva + 1;
|FPRC;

|PROCESO LaAlta_w;

      aAlfa1 = #441#10;
      aAlfa1 = aAlfa1 % -104;
      |DDEFECTO #442;
      #442#0 = #441#0;
      #442#1 = #441#1;
      #442#2 = nNumero;
      |LEE 101#442=;
      nEstado = FSalida;
      #442#0 = #441#0;
      #442#1 = #441#1;
      #442#2 = nNumero;
      #442#3 = #441#10;
      #442#4 = #441#9;
      nTMov = #442#4;
      |HAZ VerTipos_w;
      #442#5 = aTMov;
      #442#6 = #441#4;
      #442#7 = #90#1;
      #442#8 = #90#6;
      #442#9 = #90#7;
      #442#10 = #90#8;
      #442#11 = #90#10;
      #442#13 = aAlfa1;
      #442#14 = #94#2;
      |SI nEstado = 0; |GRABA 021#442a; |FINSI;
      |SI nEstado ! 0; |GRABA 021#442n; |FINSI;

      |SI #94#14 = 0;
          #442#0 = #441#0;
          #442#1 = #441#1;
          #442#2 = nNumero + 1;
          #442#3 = #441#10;
          #442#4 = 0;
          nTMov = #442#4;
          |HAZ VerTipos_w;
          #442#5 = aTMov;
          #442#7 = #90#1;
          #442#8 = #90#6;
          #442#9 = #90#7;
          #442#10 = #90#8;
          #442#11 = #90#17;
          #442#13 = aAlfa1;
          |GRABA 020#442n;
     |FINSI;
|FPRC;

|PROCESO LaBaja_w;
      aAlfa1 = #441#17;
      aAlfa1 = aAlfa1 % -104;
      |DDEFECTO #442;
      #442#0 = #441#0;
      #442#1 = #441#1;
      #442#2 = nNumero;
      |LEE 101#442=;
      nEstado = FSalida;
      #442#0 = #441#0;
      #442#1 = #441#1;
      #442#2 = nNumero;
      #442#3 = #441#17;
      #442#4 = #441#18;
      nTMov = #442#4;
      |HAZ VerTipos_w;
      #442#5 = aTMov;
      #442#6 = #441#4;
      #442#13 = aAlfa1;
      #442#14 = #94#2;
      |SI nEstado = 0; |GRABA 021#442a; |FINSI;
      |SI nEstado ! 0; |GRABA 021#442n; |FINSI;
|FPRC;

|PROCESO Tipo12_w; |TIPO 12;
 |SI #94#4 = 4; |O #94#4 = 8;

     |SI #94#15 = "N"; |ACABA; |FINSI;

     |ABRE #441;
     nNumNueva = #94#7;
     |SI nNumNueva = 0; |HAZ BuscaNumero; |FINSI;

     #441#0 = #94#0;
     #441#1 = nNumNueva;
     |LEE 101#441=;
     |SI FSalida ! 0;
         |DDEFECTO #441;
         #441#0 = #94#0;
         #441#1 = nNumNueva;
         #441#3 = #90#3; #441#4 = #90#4; #441#5 = #90#5;
         #441#6 = #94#8;
         #441#7 = #94#9;
         #441#8 = #94#10;
         #441#10 = #94#11;
         #441#12 = #90#12; #441#13 = #90#13; #441#14 = #90#14;
         #441#15 = #90#15; #441#16 = #90#16;
         #441#19 = #90#19; #441#20 = #90#20; #441#21 = #90#21;
         #441#22 = #90#22; #441#23 = #90#23;
         |GRABA 020#441b;
      |FINSI;
      |SI #94#4 = 4;
          #441#17 = #94#3;
          #441#18 = 8;
      |SINO;
          #441#10 = #94#3;
          #441#9  = 4;
      |FINSI;

      |ABRE #442;
      nNumero = 0;
      |SI #94#14 ! 0;
          nNumero = #94#14;
      |SINO;
          #442#0 = #441#0;
          #442#1 = #441#1;
          #442#2 = 999;
          |LEE 001#442];
          |SI FSalida = 0;
              |LEE 040#442a;
          |SINO;
              |LEE 040#442u;
          |FINSI;
          nNumero = 1;
          |SI FSalida = 0; |Y #442#0 = #441#0; |Y #442#1 = #441#1;
              nNumero = #442#2 + 1;
          |FINSI;
      |FINSI;

       #442#0 = #441#0;
       #442#1 = #441#1;
       #442#2 = nNumero;
       |SI #94#4 = 8;
           |HAZ LaAlta_w;
       |SINO;
           |HAZ LaBaja_w;
       |FINSI;
       |CIERRA #442;

       |GRABA 020#441a;
       |LIBERA #441;
       |CIERRA #441;
       #94#7  = nNumNueva;
       #94#14 = nNumero;
 |FINSI;

|FPRC;


|PROCESO inf441_w;
 #441#0 = enEmpresa;
 #441#1 = 00001;
 #441#2 = "";
|FPRC;

|PROCESO sup441_w;
 #441#0 = enEmpresa;
 #441#1 = 99999;
 #441#2 = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
|FPRC;

|| ***************************************************************************
|PROCESO LeeMaquina;
   nSwExiste = 0;
   |ABRE #441;
   #441#0 = #94#0;
   #441#1 = #94#7;
   |LEE 001#441=;
   |SI FSalida = 0;
       nSwExiste = 1;
   |FINSI;
   |CIERRA #441;
|FPRC;

|PROCESO NuevaMaquina;
 inkey = FSalida;

 |SI #94#7 = #94#1;
     |MENAV "    Error. Ha introducido el mismo codigo de maquina que la actual";
     |ERROR;
     |ACABA;
 |FINSI;

 |SI inkey = 10;
      enEmpresa  = #90#0;
      |ABRE #441;
      #441#0 = #94#0;
      #441#1 = #94#7;
      |CONSULTA_F_CLAVE #1#441,inf441_w,sup441_w;
      #94#0 = #441#0;
      #94#7 = #441#1;
      |CIERRA #441;
 |FINSI;

 aAlfa1 = "S";
 |SI #94#7 ! 0;
     enEmpresa = #94#0;
     |HAZ LeeMaquina;
     |SI nSwExiste = 1;
         aAlfa1 = "N";
         #94#8  = #441#6; |PINTA #94#8;
         #94#9  = #441#7; |PINTA #94#9;
         #94#10 = #441#8; |PINTA #94#10;
         nNume1 = 10; |SI #441#11 > "01.01.1900"; nNume1 = 11; |FINSI;
         #94#11 = #441nNume1; |PINTA #94#11;
     |SINO;
         |MENAV "    No existe maquina informada. Introduzca 000000 para seguir";
         |ERROR;
         |ACABA;
     |FINSI;
 |FINSI;
 |C_M #94#8,1,aAlfa1;
 |C_M #94#9,1,aAlfa1;
 |C_M #94#10,1,aAlfa1;
 |C_M #94#11,1,aAlfa1;
|FPRC;

|PROCESO VerTipos_w;
   aTMov = "";
   |SI nTMov = 0; aTMov = "Cuota tributaria devengada en el ejercicio     "; |FINSI;
   |SI nTMov = 4; aTMov = "Alta por sustitucion                           "; |FINSI;
   |SI nTMov = 8; aTMov = "Baja definitiva de la maquina con sustitucion  "; |FINSI;
|FPRC;
