|FICHEROS;
     dsmom015 #15;
     dsmom016 #16;
     dsmom018 #18;
     dsmom019 #19;
     dsmow008 #108;
     dsmow009 #109;
     dsmow010 #110;

     :/basica/def/agicen14 #214;
     :/basica/def/agifigen #118;
|FIN;

|VARIABLES;
     aFichero      = "";
     aTipoElemento = "";
     aModTrab      = "";
     aModElem      = "";
     aAlfa         = "";

     fFechaIni     = @;
     fFechaFin     = @;

     nCampoPtas    = 0;
     nCampoElem    = 0;
     nCampoAsala1  = 0;
     nCampoAsala2  = 0;
     nCampoAsala3  = 0;
     nCampoAsala4  = 0;
     nCampoAsala5  = 0;
     nCampoAsala6  = 0;
     nCampoAsala7  = 0;
     nCampoAsala8  = 0;
     nCampoAsala9  = 0;
     nCampoAsalar  = 0;
     nError        = 0;
     nSwPregunta   = 0;
     nDias         = 0;
     nDiasEjer     = 0;
     nControl      = 0;
     nCampoImp     = 0;
     nTeclaPara    = 0;
     nTeclaAsal    = 0;
     nTAsalariado  = 0;
     nCampo1       = 0;
     nConta        = 0;
     nCampoTrab    = 0;
     nPosi         = 0;
     nRendimiento  = 0;
     nCampoD       = 0;
     nCampoH       = 0;
     nSuma         = 0;
     nCampo        = 0;

     &enTipoPase   = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO Lee15;
     #15#0 = #16nCampoElem;
     |LEE 040#15=;
     |SI FSalida ! 0;  |DDEFECTO #15;  |FINSI;

     aTipoElemento = "";
     |SI #15#3 = "L";
         |SI #15#2 = "S";  aTipoElemento = "L";  |FINSI;
         |ACABA;
     |FINSI;

     |SI #15#3 = "N";
         |SI #15#2 = "S";  aTipoElemento = "P";  |FINSI;
         |ACABA;
     |FINSI;

     aTipoElemento = "A";
     |SI #15#4 = "S";  aTipoElemento = "N";  |FINSI;

     |SI EURODBMOD = 0;
         nCampoPtas    = nCampoElem + 2;
     |SINO;
         |SI nCampoElem = 4;   nCampoPtas = 49;  |FINSI;
         |SI nCampoElem = 8;   nCampoPtas = 50;  |FINSI;
         |SI nCampoElem = 12;  nCampoPtas = 51;  |FINSI;
         |SI nCampoElem = 16;  nCampoPtas = 52;  |FINSI;
         |SI nCampoElem = 20;  nCampoPtas = 53;  |FINSI;
         |SI nCampoElem = 24;  nCampoPtas = 54;  |FINSI;
         |SI nCampoElem = 28;  nCampoPtas = 55;  |FINSI;
         |SI nCampoElem = 32;  nCampoPtas = 56;  |FINSI;
         |SI nCampoElem = 36;  nCampoPtas = 57;  |FINSI;
     |FINSI;

     |SI #15#4 = "N";
         |SI #110#57 = 0;
             #110#57 = #16nCampoPtas;
         |SINO;
             #110#62 = #110#62 + #16nCampoPtas;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO PonTipos;
     #110#57 = 0;
     #110#62 = 0;

     |ABRE #15;

     nCampoElem = 4;   |HAZ Lee15;  #18#70 = aTipoElemento;
     nCampoElem = 8;   |HAZ Lee15;  #18#71 = aTipoElemento;
     nCampoElem = 12;  |HAZ Lee15;  #18#72 = aTipoElemento;
     nCampoElem = 16;  |HAZ Lee15;  #18#73 = aTipoElemento;
     nCampoElem = 20;  |HAZ Lee15;  #18#74 = aTipoElemento;
     nCampoElem = 24;  |HAZ Lee15;  #18#75 = aTipoElemento;
     nCampoElem = 28;  |HAZ Lee15;  #18#76 = aTipoElemento;
     nCampoElem = 32;  |HAZ Lee15;  #18#77 = aTipoElemento;
     nCampoElem = 36;  |HAZ Lee15;  #18#78 = aTipoElemento;

     |CIERRA #15;

     nCampoAsala1 = 0; nCampoAsala2 = 0; nCampoAsala3 = 0;
     nCampoAsala4 = 0; nCampoAsala5 = 0; nCampoAsala6 = 0;
     nCampoAsala7 = 0; nCampoAsala8 = 0; nCampoAsala9 = 0;

     |SI #18#70 = "A";  nCampoAsala1 = 1;  |FINSI;
     |SI #18#71 = "A";  nCampoAsala2 = 1;  |FINSI;
     |SI #18#72 = "A";  nCampoAsala3 = 1;  |FINSI;
     |SI #18#73 = "A";  nCampoAsala4 = 1;  |FINSI;
     |SI #18#74 = "A";  nCampoAsala5 = 1;  |FINSI;
     |SI #18#75 = "A";  nCampoAsala6 = 1;  |FINSI;
     |SI #18#76 = "A";  nCampoAsala7 = 1;  |FINSI;
     |SI #18#77 = "A";  nCampoAsala8 = 1;  |FINSI;
     |SI #18#78 = "A";  nCampoAsala9 = 1;  |FINSI;

     |SI #18#70 = "A";  nCampoAsalar = 0;  |ACABA;    |FINSI;
     |SI #18#71 = "A";  nCampoAsalar = 1;  |ACABA;    |FINSI;
     |SI #18#72 = "A";  nCampoAsalar = 2;  |ACABA;    |FINSI;
     |SI #18#73 = "A";  nCampoAsalar = 3;  |ACABA;    |FINSI;
     |SI #18#74 = "A";  nCampoAsalar = 4;  |ACABA;    |FINSI;
     |SI #18#75 = "A";  nCampoAsalar = 5;  |ACABA;    |FINSI;
     |SI #18#76 = "A";  nCampoAsalar = 6;  |ACABA;    |FINSI;
     |SI #18#77 = "A";  nCampoAsalar = 7;  |ACABA;    |FINSI;
     |SI #18#78 = "A";  nCampoAsalar = 8;  |ACABA;    |FINSI;
|FPRC;

|PROCESO CogeModulo;
     aAlfa = "01.01." + #18#1;  fFechaIni = aAlfa;
     aAlfa = "31.12." + #18#1;  fFechaFin = aAlfa;
     nDiasEjer = (fFechaFin - fFechaIni) + 1;

     #18#107 = enDiaTrimP1;
     #18#108 = enDiaTrimP2;
     #18#109 = enDiaTrimP3;
     #18#110 = enDiaTrimP4;
     #18#111 = #18#107 + #18#108 + #18#109 + #18#110;

     #18#112 = enDiaTrimD1;
     #18#113 = enDiaTrimD2;
     #18#114 = enDiaTrimD3;
     #18#115 = enDiaTrimD4;
     #18#116 = #18#112 + #18#113 + #18#114 + #18#115;

     nError = 0;

     |ABRE #16;
     |SELECT #1#16;
     #16#0  = "E";
     #16#1  = eaCodEpi2;
     #16#41 = enCodEpi3;
     #16#2  = enEjer;
     |LEE 040#16=;
     |SI FSalida ! 0;  nError = 1;  |ACABA;  |FINSI;
     |CIERRA #16;

     |HAZ PonTipos;

     #18#4  = #16#5;           || Elemento  1
     #18#5  = #16#9;           || Elemento  2
     #18#6  = #16#13;          || Elemento  3
     #18#7  = #16#17;          || Elemento  4
     #18#8  = #16#21;          || Elemento  5
     #18#9  = #16#25;          || Elemento  6
     #18#10 = #16#29;          || Elemento  7
     #18#11 = #16#33;          || Elemento  8
     #18#12 = #16#37;          || Elemento  9

     |SI EURODBMOD ! 0;
         #18#15  = #16#49;          || Euro IRPF 1
         #18#16  = #16#50;          || Eur0oIRPF 2
         #18#17  = #16#51;          || Ptas IRPF 3
         #18#18  = #16#52;          || Ptas IRPF 4
         #18#19  = #16#53;          || Ptas IRPF 5
         #18#20  = #16#54;          || Ptas IRPF 6
         #18#21  = #16#55;          || Ptas IRPF 7
         #18#22  = #16#56;          || Ptas IRPF 8
         #18#23  = #16#57;          || Ptas IRPF 9
     |SINO;
         #18#15  = #16#6;           || Ptas IRPF 1
         #18#16  = #16#10;          || Ptas IRPF 2
         #18#17  = #16#14;          || Ptas IRPF 3
         #18#18  = #16#18;          || Ptas IRPF 4
         #18#19  = #16#22;          || Ptas IRPF 5
         #18#20  = #16#26;          || Ptas IRPF 6
         #18#21  = #16#30;          || Ptas IRPF 7
         #18#22  = #16#34;          || Ptas IRPF 8
         #18#23  = #16#38;          || Ptas IRPF 9
     |FINSI;

     nSuma = #18#15 + #18#16 + #18#17 + #18#18 + #18#18;
     nSuma = nSuma  + #18#20 + #18#21 + #18#22 + #18#23;
     |SI nSuma = 0;  nError = 1;  |ACABA;  |FINSI;

     |SI #18#70 = "L";  #18#04 = "";  #18#15 = 0;  |FINSI;
     |SI #18#71 = "L";  #18#05 = "";  #18#16 = 0;  |FINSI;
     |SI #18#72 = "L";  #18#06 = "";  #18#17 = 0;  |FINSI;
     |SI #18#73 = "L";  #18#07 = "";  #18#18 = 0;  |FINSI;
     |SI #18#74 = "L";  #18#08 = "";  #18#19 = 0;  |FINSI;
     |SI #18#75 = "L";  #18#09 = "";  #18#20 = 0;  |FINSI;
     |SI #18#76 = "L";  #18#10 = "";  #18#21 = 0;  |FINSI;
     |SI #18#77 = "L";  #18#11 = "";  #18#22 = 0;  |FINSI;
     |SI #18#78 = "L";  #18#12 = "";  #18#23 = 0;  |FINSI;

     |C_M #18#26, 1, "S";  |C_M #18#48,  1, "S";
     |C_M #18#27, 1, "S";  |C_M #18#49,  1, "S";
     |C_M #18#28, 1, "S";  |C_M #18#50,  1, "S";
     |C_M #18#29, 1, "S";  |C_M #18#51,  1, "S";
     |C_M #18#30, 1, "S";  |C_M #18#52,  1, "S";
     |C_M #18#31, 1, "S";  |C_M #18#53,  1, "S";
     |C_M #18#32, 1, "S";  |C_M #18#53,  1, "S";
     |C_M #18#33, 1, "S";  |C_M #18#55,  1, "S";

     |SI #18#15  = 0;  |C_M #18#26,  1, "N";  |C_M #18#48,  1, "N";  |FINSI;
     |SI #18#16  = 0;  |C_M #18#27,  1, "N";  |C_M #18#49,  1, "N";  |FINSI;
     |SI #18#17  = 0;  |C_M #18#28,  1, "N";  |C_M #18#50,  1, "N";  |FINSI;
     |SI #18#18  = 0;  |C_M #18#29,  1, "N";  |C_M #18#51,  1, "N";  |FINSI;
     |SI #18#19  = 0;  |C_M #18#30,  1, "N";  |C_M #18#52,  1, "N";  |FINSI;
     |SI #18#20  = 0;  |C_M #18#31,  1, "N";  |C_M #18#53,  1, "N";  |FINSI;
     |SI #18#21  = 0;  |C_M #18#32,  1, "N";  |C_M #18#54,  1, "N";  |FINSI;
     |SI #18#22  = 0;  |C_M #18#33,  1, "N";  |C_M #18#55,  1, "N";  |FINSI;
|FPRC;

|PROCESO MensaAsala;
     |SI Campo = 26;  |O Campo = 48;
         |MENSA "     <F2> Datos Personal Asalariado; <F3> N.IVA Provisional; <F4> N.IVA Definitivo";
     |SINO;
         |MENSA "     <F2> Datos Personal Asalariado; ";
     |FINSI;
|FPRC;

|PROCESO MensaNAsala;
     |MENSA "     <F2> Recoge Datos Personal No Asalariado.";
|FPRC;

|PROCESO PintaElemento;  |TIPO 7;
     || Pinta los mensajes  de las teclas de funciones

     |MENSA "        ";

     aModTrab = "S";
     |SI eaDesTrab = "S";  aModTrab = "N";  |FINSI;

     aModElem = "S";
     |SI eaDesElem = "S";  aModElem = "N";  |FINSI;

     nSwPregunta = 0;

     |C_M #18Campo, 1, "S";

     |SI Campo = 26; |O Campo = 48;
         |SI #18#70 = "A"; |Y nCampoAsalar [ 1;
             |SI Campo = 26; nSwPregunta = 1;  |FINSI;
             |SI Campo = 48; nSwPregunta = 2;  |FINSI;

             |C_M #18Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaAsala;
             |FINSI;
         |FINSI;

         |SI #18#70 = "N";
             |SI Campo = 26; nSwPregunta = 3;  |FINSI;
             |SI Campo = 48; nSwPregunta = 4;  |FINSI;

             |C_M #18Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaNAsala;
             |FINSI;
         |FINSI;

         |SI #18#70 ! "N"; |Y  #18#70 ! "A";
             |C_M #18Campo, 1, aModElem;
         |FINSI;
     |FINSI;

     |SI Campo = 27; |O Campo = 49;
         |SI #18#71 = "A"; |Y nCampoAsalar [ 1;
             |SI Campo = 27; nSwPregunta = 1;  |FINSI;
             |SI Campo = 49; nSwPregunta = 2;  |FINSI;

             |C_M #18Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaAsala;
             |FINSI;
         |FINSI;

         |SI #18#71 = "N";
             |SI Campo = 27; nSwPregunta = 3;  |FINSI;
             |SI Campo = 49; nSwPregunta = 4;  |FINSI;

             |C_M #18Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaNAsala;
             |FINSI;
         |FINSI;

         |SI #18#71 ! "N"; |Y  #18#71 ! "A";
             |C_M #18Campo, 1, aModElem;
         |FINSI;
     |FINSI;

     |SI Campo = 28; |O Campo = 50;
         |SI #18#72 = "A"; |Y nCampoAsalar [ 1;
             |SI Campo = 28; nSwPregunta = 1;  |FINSI;
             |SI Campo = 50; nSwPregunta = 2;  |FINSI;

             |C_M #18Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaAsala;
             |FINSI;
         |FINSI;

         |SI #18#72 = "N";
             |SI Campo = 28; nSwPregunta = 3;  |FINSI;
             |SI Campo = 50; nSwPregunta = 4;  |FINSI;

             |C_M #18Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaNAsala;
             |FINSI;
         |FINSI;

         |SI #18#72 ! "N"; |Y  #18#72 ! "A";
             |C_M #18Campo, 1, aModElem;
         |FINSI;
     |FINSI;

     |SI Campo = 29; |O Campo = 51;
         |SI #18#73 = "A"; |Y nCampoAsalar [ 1;
             |SI Campo = 29; nSwPregunta = 1;  |FINSI;
             |SI Campo = 51; nSwPregunta = 2;  |FINSI;

             |C_M #18Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaAsala;
             |FINSI;
         |FINSI;

         |SI #18#73 = "N";
             |SI Campo = 29; nSwPregunta = 3;  |FINSI;
             |SI Campo = 51; nSwPregunta = 4;  |FINSI;

             |C_M #18Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaNAsala;
             |FINSI;
         |FINSI;

         |SI #18#73 ! "N"; |Y  #18#73 ! "A";
             |C_M #18Campo, 1, aModElem;
         |FINSI;
     |FINSI;

     |SI Campo = 30; |O Campo = 52;
         |SI #18#74 = "A"; |Y nCampoAsalar [ 1;
             |SI Campo = 30; nSwPregunta = 1;  |FINSI;
             |SI Campo = 52; nSwPregunta = 2;  |FINSI;

             |C_M #18Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaAsala;
             |FINSI;
         |FINSI;

         |SI #18#74 = "N";
             |SI Campo = 30; nSwPregunta = 3;  |FINSI;
             |SI Campo = 52; nSwPregunta = 4;  |FINSI;

             |C_M #18Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaNAsala;
             |FINSI;
         |FINSI;

         |SI #18#74 ! "N"; |Y  #18#74 ! "A";
             |C_M #18Campo, 1, aModElem;
         |FINSI;
     |FINSI;

     |SI Campo = 31; |O Campo = 53;
         |SI #18#75 = "A"; |Y nCampoAsalar [ 1;
             |SI Campo = 31; nSwPregunta = 1;  |FINSI;
             |SI Campo = 53; nSwPregunta = 2;  |FINSI;

             |C_M #18Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaAsala;
             |FINSI;
         |FINSI;

         |SI #18#75 = "N";
             |SI Campo = 31; nSwPregunta = 3;  |FINSI;
             |SI Campo = 53; nSwPregunta = 4;  |FINSI;

             |C_M #18Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaNAsala;
             |FINSI;
         |FINSI;

         |SI #18#75 ! "N"; |Y  #18#75 ! "A";
             |C_M #18Campo, 1, aModElem;
         |FINSI;
     |FINSI;

     |SI Campo = 32; |O Campo = 54;
         |SI #18#76 = "A"; |Y nCampoAsalar [ 1;
             |SI Campo = 32; nSwPregunta = 1;  |FINSI;
             |SI Campo = 54; nSwPregunta = 2;  |FINSI;

             |C_M #18Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaAsala;
             |FINSI;
         |FINSI;

         |SI #18#76 = "N";
             |SI Campo = 32; nSwPregunta = 3;  |FINSI;
             |SI Campo = 54; nSwPregunta = 4;  |FINSI;

             |C_M #18Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaNAsala;
             |FINSI;
         |FINSI;

         |SI #18#76 ! "N"; |Y  #18#76 ! "A";
             |C_M #18Campo, 1, aModElem;
         |FINSI;
     |FINSI;

     |SI Campo = 33; |O Campo = 55;
         |SI #18#77 = "A"; |Y nCampoAsalar [ 1;
             |SI Campo = 33; nSwPregunta = 1;  |FINSI;
             |SI Campo = 55; nSwPregunta = 2;  |FINSI;

             |C_M #18Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaAsala;
             |FINSI;
         |FINSI;

         |SI #18#77 = "N";
             |SI Campo = 33; nSwPregunta = 3;  |FINSI;
             |SI Campo = 55; nSwPregunta = 4;  |FINSI;

             |C_M #18Campo, 1, aModTrab;
             |SI eaDesTrab = "N";
                 |HAZ MensaNAsala;
             |FINSI;
         |FINSI;

         |SI #18#77 ! "N"; |Y  #18#77 ! "A";
             |C_M #18Campo, 1, aModElem;
         |FINSI;
     |FINSI;

     |SI Campo = 26;  nDias = 111;  nControl = 70;  nCampoImp = 15;  |FINSI;
     |SI Campo = 27;  nDias = 111;  nControl = 71;  nCampoImp = 16;  |FINSI;
     |SI Campo = 28;  nDias = 111;  nControl = 72;  nCampoImp = 17;  |FINSI;
     |SI Campo = 29;  nDias = 111;  nControl = 73;  nCampoImp = 18;  |FINSI;
     |SI Campo = 30;  nDias = 111;  nControl = 74;  nCampoImp = 19;  |FINSI;
     |SI Campo = 31;  nDias = 111;  nControl = 75;  nCampoImp = 20;  |FINSI;
     |SI Campo = 32;  nDias = 111;  nControl = 76;  nCampoImp = 21;  |FINSI;
     |SI Campo = 33;  nDias = 111;  nControl = 77;  nCampoImp = 22;  |FINSI;

     |SI Campo = 48;  nDias = 116;  nControl = 70;  nCampoImp = 15;  |FINSI;
     |SI Campo = 49;  nDias = 116;  nControl = 71;  nCampoImp = 16;  |FINSI;
     |SI Campo = 50;  nDias = 116;  nControl = 72;  nCampoImp = 17;  |FINSI;
     |SI Campo = 51;  nDias = 116;  nControl = 73;  nCampoImp = 18;  |FINSI;
     |SI Campo = 52;  nDias = 116;  nControl = 74;  nCampoImp = 19;  |FINSI;
     |SI Campo = 53;  nDias = 116;  nControl = 75;  nCampoImp = 20;  |FINSI;
     |SI Campo = 54;  nDias = 116;  nControl = 76;  nCampoImp = 21;  |FINSI;
     |SI Campo = 55;  nDias = 116;  nControl = 77;  nCampoImp = 22;  |FINSI;

     |SI Campo = 26;  |O Campo = 48;
         |SI #18#15  = 0;  |C_M #18#26,  1, "N";  |C_M #18#48,  1, "N";  |FINSI;
     |FINSI;

     |SI Campo = 27;  |O Campo = 49;
         |SI #18#16  = 0;  |C_M #18#27,  1, "N";  |C_M #18#49,  1, "N";  |FINSI;
     |FINSI;

     |SI Campo = 28;  |O Campo = 50;
         |SI #18#17  = 0;  |C_M #18#28,  1, "N";  |C_M #18#50,  1, "N";  |FINSI;
     |FINSI;

     |SI Campo = 29;  |O Campo = 51;
         |SI #18#18  = 0;  |C_M #18#29,  1, "N";  |C_M #18#51,  1, "N";  |FINSI;
     |FINSI;

     |SI Campo = 30;  |O Campo = 52;
         |SI #18#19  = 0;  |C_M #18#30,  1, "N";  |C_M #18#52,  1, "N";  |FINSI;
     |FINSI;

     |SI Campo = 31;  |O Campo = 53;
         |SI #18#20  = 0;  |C_M #18#31,  1, "N";  |C_M #18#53,  1, "N";  |FINSI;
     |FINSI;

     |SI Campo = 32;  |O Campo = 54;
         |SI #18#21  = 0;  |C_M #18#32,  1, "N";  |C_M #18#54,  1, "N";  |FINSI;
     |FINSI;

     |SI Campo = 33;  |O Campo = 55;
         |SI #18#22  = 0;  |C_M #18#33,  1, "N";  |C_M #18#55,  1, "N";  |FINSI;
     |FINSI;

     |PULSATECLA;
|FPRC;

|| \\\\\\\\ PANTALLA DESGLOSE DEL PERSONAL ASALARIADO PROVISIONAL //////////

|PROCESO CalcuAsalar;
     #18nCampoTrab = (#18enCampo1 * 0.60) + (#18enCampo2 * 0.60) + (#18enCampo3 * 0.30) + #18enCampo4;
     |PINTA #18nCampoTrab;
|FPRC;

|PROCESO CalcuNoAsalar;
     #18nCampoTrab = #18enCampo1 + #18enCampo2 + #18enCampo3;
     nTAsalariado  = #18enCampo4 + #18enCampo5;
     |SI #18nCampoTrab > 1; |Y #18enCampo1 = 1; |Y nTAsalariado [ 1;
          #18nCampoTrab = ((#18nCampoTrab - 1) / 2) + 1;
     |FINSI;
     |PINTA #18nCampoTrab;
|FPRC;

|PROCESO PersAsalariado;
     |PUSHV 0501 2380;

     #108#0 = #18enCampo1;
     #108#1 = #18enCampo2;
     #108#2 = #18enCampo3;
     #108#3 = #18enCampo4;
     #108#4 = #18nCampoTrab;

     |PINPA #0#108;

     |SI #18#1 ] 2000;
         |PINTA 1219, "N§.Menores 19 a¤os/Minus.33% ..:";
     |SINO;
         |PINTA 1219, "N§.Menores 19 a¤os ............:";
     |FINSI;

     |PINDA #0#108;
     |ENDATOS #1#108;
     |SI FSalida = 0;
         #18enCampo1   = #108#0;
         #18enCampo2   = #108#1;
         #18enCampo3   = #108#2;
         #18enCampo4   = #108#3;
         #18nCampoTrab = #108#4;
     |FINSI;

     |POPV;

     |HAZ CalcuAsalar;
|FPRC;

|PROCESO PersNoAsalariado;
     |PUSHV 0501 2380;

     #109#0 = #18enCampo1;
     #109#1 = #18enCampo2;
     #109#2 = #18enCampo3;
     #109#3 = #18nCampoTrab;

     |PINPA #0#109;
     |PINDA #0#109;
     |ENDATOS #1#109;
     |SI FSalida = 0;
         #18enCampo1    = #109#0;
         #18enCampo2    = #109#1;
         #18enCampo3    = #109#2;
         #18nCampoTrab = #109#3;
     |FINSI;

     |POPV;
|FPRC;

|PROCESO RdtoNetoPrevio;
     enRdtos = 1;
     #110#52 = #18#120;
     #110#53 = #18#133;
     #110#54 = #18#134;
     #110#55 = #18#97;
     #110#56 = #18#135;
     #110#58 = #18#136;
     #110#59 = #18#137;
     #110#60 = #18#99;
     #110#61 = #18#138;
     #110#63 = #18#139;
     |PARA nCampoD = 140;  |SI nCampoD [ 193;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD - 76;
           #110nCampoH = #18nCampoD;
     |SIGUE;

     |SI FSalida = 10;  |Y Campo = 122;
         enPinta = 1;
         |PUSHV 0501 2380;
         |PINPA #0#110;

         |ATRI S;
         |PINTA 1017, "P";
         |PINTA 1117, "R";
         |PINTA 1217, "O";
         |PINTA 1317, "V";
         |PINTA 1417, "I";
         |PINTA 1517, "S";
         |PINTA 1617, "I";
         |PINTA 1717, "O";
         |PINTA 1817, "N";
         |PINTA 1917, "A";
         |PINTA 2017, "L";
         |ATRI s;

         |PINDA #0#110;
         |ENDATOS #1#110;
         |SI FSalida = 0;
             #18#120 = #110#52;
             #18#133 = #110#53;
             #18#134 = #110#54;
             #18#97  = #110#55;
             #18#135 = #110#56;
             #18#136 = #110#58;
             #18#137 = #110#59;
             #18#99  = #110#60;
             #18#138 = #110#61;
             #18#139 = #110#63;
             |PARA nCampoD = 140;  |SI nCampoD [ 193;  |HACIENDO nCampoD = nCampoD + 1;
                   nCampoH = nCampoD - 76;
                   #18nCampoD = #110nCampoH;
             |SIGUE;
         |FINSI;
         |POPV;

         |ERROR;
     |FINSI;

     enPinta = 0;
     |HAZ Totalw010;

     #18#122 = #110#117;

     |PINTA #18#122;
|FPRC;

|PROCESO RdtoNetoDefinitivo;
     |SI #18#129 ! "S"; |Y #18#130 ! "S"; |Y #18#131 ! "S";
         |SI #18#194 = 0; #18#194 = #18#134; |FINSI;    || ... recoge el provisional?
         |SI #18#197 = 0; #18#197 = #18#139; |FINSI;
     |FINSI;
     enRdtos = 2;
     #110#52 = #18#121;
     #110#53 = #18#133;
     #110#54 = #18#194;
     #110#55 = #18#98;
     #110#56 = #18#195;
     #110#58 = #18#196;
     #110#59 = #18#197;
     #110#60 = #18#100;
     #110#61 = #18#198;
     #110#63 = #18#199;
     |PARA nCampoD = 200;  |SI nCampoD [ 253;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD - 136;
           #110nCampoH = #18nCampoD;
     |SIGUE;

     #110#52 = #18#121;
     #110#55 = #18#98;
     #110#60 = #18#100;

     |SI FSalida = 10;  |Y Campo = 123;
         enPinta = 1;
         |PUSHV 0501 2380;
         |PINPA #0#110;

         |ATRI S;
         |PINTA 1017, "D";
         |PINTA 1117, "E";
         |PINTA 1217, "F";
         |PINTA 1317, "I";
         |PINTA 1417, "N";
         |PINTA 1517, "I";
         |PINTA 1617, "T";
         |PINTA 1717, "I";
         |PINTA 1817, "V";
         |PINTA 1917, "O";
         |ATRI s;

         |PINDA #0#110;
         |ENDATOS #1#110;
         |SI FSalida = 0;
             #18#121 = #110#52;
             #18#133 = #110#53;
             #18#194 = #110#54;
             #18#98  = #110#55;
             #18#195 = #110#56;
             #18#196 = #110#58;
             #18#197 = #110#59;
             #18#100 = #110#60;
             #18#198 = #110#61;
             #18#199 = #110#63;
             |PARA nCampoD = 200;  |SI nCampoD [ 253;  |HACIENDO nCampoD = nCampoD + 1;
                   nCampoH = nCampoD - 136;
                   #18nCampoD = #110nCampoH;
             |SIGUE;
         |FINSI;
         |POPV;

         |ERROR;
     |FINSI;

     enPinta = 0;
     |HAZ Totalw010;

     #18#123 = #110#117;
     #18#124 = #110#106;

     |PINTA #18#123;
     |PINTA #18#124;
|FPRC;

|PROCESO ImporteTotal;
     |HAZ RdtoNetoPrevio;
     |HAZ RdtoNetoDefinitivo;

     |SI eaDesTrab = "N";
         #18#254 = #18#97 + #18#99;
     |FINSI;

     |SI #18#118 = "S";
         |SI #18#1 [ 1998;
             #18#119 = 5;
             |SI #18#254 [ 1;    #18#119 = 4;    |FINSI;
             |SI #18#254 = 0;    #18#119 = 2.5;  |FINSI;
             |SI #18#117 = "S";  #18#119 = 5;    |FINSI;
         |SINO;
             #18#119 = 4;
             |SI #18#254 [ 1;    #18#119 = 3;    |FINSI;
             |SI #18#254 = 0;    #18#119 = 2;    |FINSI;
             |SI #18#117 = "S";  #18#119 = 4;    |FINSI;
         |FINSI;
     |FINSI;

     |PINTA #18#119;

     |SI #18#167 = 0;
         nRendimiento = #18#122 % #18#119;
         |SI #18#1 = 2000;  |O #18#1 = 2004;  |O #18#1 = 2008;
          |O #18#1 = 2012;  |O #18#1 = 2016;  |O #18#1 = 2020;
             |SI #18#129 ! "S";  #18#125 = nRendimiento * (#18#107 / 91);  |PINTA #18#125;  |FINSI;
          |SINO;
             |SI #18#129 ! "S";  #18#125 = nRendimiento * (#18#107 / 90);  |PINTA #18#125;  |FINSI;
          |FINSI;
          |SI #18#130 ! "S";  #18#126 = nRendimiento * (#18#108 / 91);  |PINTA #18#126;  |FINSI;
          |SI #18#131 ! "S";  #18#127 = nRendimiento * (#18#109 / 92);  |PINTA #18#127;  |FINSI;
          |SI #18#132 ! "S";  #18#128 = nRendimiento * (#18#110 / 92);  |PINTA #18#128;  |FINSI;
     |SINO;
          nRendimiento = #18#122 / #18#111;
          |SI #18#129 ! "S";
              #18#125 = (nRendimiento * #18#107) % #18#119;  |PINTA #18#125;
          |FINSI;

          |SI #18#130 ! "S";
              #18#126 = (nRendimiento * #18#108) % #18#119;  |PINTA #18#126;
          |FINSI;

          |SI #18#131 ! "S";
              #18#127 = (nRendimiento * #18#109) % #18#119;  |PINTA #18#127;
          |FINSI;

          |SI #18#132 ! "S";
              #18#128 = (nRendimiento * #18#110) % #18#119;  |PINTA #18#128;
          |FINSI;
     |FINSI;

     |SI #18#125 < 0;  #18#125 = 0;  |FINSI;
     |SI #18#126 < 0;  #18#126 = 0;  |FINSI;
     |SI #18#127 < 0;  #18#127 = 0;  |FINSI;
     |SI #18#128 < 0;  #18#128 = 0;  |FINSI;

     |PINTA #18#117;
     |PINTA #18#119;
     |PINTA #18#125;
     |PINTA #18#126;
     |PINTA #18#127;
     |PINTA #18#128;
|FPRC;

|PROCESO TraeProvisionIVA;
     |ABRE #19;
     #19#0 = #18#0;
     #19#1 = #18#1;
     #19#2 = #18#2;
     #19#3 = #18#3;
     |LEE 040#19=;
     |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;
     |CIERRA #19;

     |PARA nCampo = 26;  |SI nCampo [ 36;  |HACIENDO nCampo = nCampo + 1;
           #18nCampo = #19nCampo;

           |SI nCampo [ 33;  |PINTA #18nCampo;  |FINSI;
     |SIGUE;
     #18#81  = #19#81;
     #18#83  = #19#83;
     #18#85  = #19#85;
     #18#87  = #19#87;
     #18#89  = #19#89;
     #18#91  = #19#91;
     #18#93  = #19#93;
     #18#95  = #19#95;
     #18#97  = #19#97;
     #18#99  = #19#99;
     #18#101 = #19#101;
     #18#103 = #19#103;
     #18#105 = #19#105;
|FPRC;

|PROCESO TraeDefinitivoIVA;
     |ABRE #19;
     #19#0 = #18#0;
     #19#1 = #18#1;
     #19#2 = #18#2;
     #19#3 = #18#3;
     |LEE 040#19=;
     |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;
     |CIERRA #19;

     |PARA nCampo = 48;  |SI nCampo [ 58;  |HACIENDO nCampo = nCampo + 1;
           #18nCampo = #19nCampo;

           |SI nCampo [ 55;  |PINTA #18nCampo;  |FINSI;
     |SIGUE;
     #18#82  = #19#82;
     #18#84  = #19#84;
     #18#86  = #19#86;
     #18#88  = #19#88;
     #18#90  = #19#90;
     #18#92  = #19#92;
     #18#94  = #19#94;
     #18#96  = #19#96;
     #18#98  = #19#98;
     #18#100 = #19#100;
     #18#102 = #19#102;
     #18#104 = #19#104;
     #18#106 = #19#106;
|FPRC;

|PROCESO Importe;  |TIPO 0;
     |SI nTeclaPara = 5;  |ACABA;  |FINSI;

     enCampo1   = 0;
     enCampo2   = 0;
     enCampo3   = 0;
     enCampo4   = 0;
     enCampo5   = 0;
     nTeclaPara = FSalida;
     nCampoTrab = Campo;
     nTeclaAsal = FSalida;
     |BLIN 04;

     |SI nSwPregunta ! 0;
         |SI nSwPregunta = 1;
             |SI nCampoTrab = 26;
                 enCampo1 = 81;  enCampo2 = 85;  enCampo3 = 89;  enCampo4 = 93;
             |SINO;
                 enCampo1 = 83;  enCampo2 = 87;  enCampo3 = 91;  enCampo4 = 95;
             |FINSI;

             |SI nTeclaAsal = 10;  |HAZ PersAsalariado;  |FINSI;

             |HAZ CalcuAsalar;
         |FINSI;

         |SI nSwPregunta = 2;
             |SI nCampoTrab = 48;
                 enCampo1 = 82;  enCampo2 = 86;  enCampo3 = 90;  enCampo4 = 94;
             |SINO;
                 enCampo1 = 84;  enCampo2 = 88;  enCampo3 = 92;  enCampo4 = 96;
             |FINSI;

             |SI nTeclaAsal = 10;  |HAZ PersAsalariado;  |FINSI;

             |HAZ CalcuAsalar;
         |FINSI;

         |SI nSwPregunta = 3;
             enCampo1 = 101;  enCampo2 = 103;  enCampo3 = 105;
             enCampo4 = 97;   enCampo5 = 99;

             |SI nTeclaAsal = 10;  |HAZ PersNoAsalariado;  |FINSI;

             |HAZ CalcuNoAsalar;
         |FINSI;

         |SI nSwPregunta = 4;
             enCampo1 = 102;  enCampo2 = 104;  enCampo3 = 106;
             enCampo4 = 98;   enCampo5 = 100;

             |SI nTeclaAsal = 10;  |HAZ PersNoAsalariado;  |FINSI;

             |HAZ CalcuNoAsalar;
         |FINSI;
     |FINSI;

     nCampo1 = Campo + 11;

     |SI nSwPregunta = 0; |Y #18nControl = "P"; |Y nDias = 116; |Y eaDesElem = "N";
         #18nCampo1 = #18nCampoImp * ((#18nCampoTrab * #18nDias) / nDiasEjer);
     |SINO;
         #18nCampo1 = #18nCampoImp * #18nCampoTrab;
     |FINSI;

     |PINTA #18nCampo1;

     |SI #18nCampo1 = 0;
         #18nCampoTrab = 0;
         |PINTA #18nCampoTrab;
     |FINSI;

     #18#120 = 0;
     |PARA nConta = 37;  |SI nConta [ 44;  |HACIENDO nConta = nConta + 1;
           #18#120 = #18#120 + #18nConta;
     |SIGUE;

     #18#121 = 0;
     |PARA nConta = 59;  |SI nConta [ 66;  |HACIENDO nConta = nConta + 1;
           #18#121 = #18#121 + #18nConta;
     |SIGUE;

     #18#97 = 0;  #18#99  = 0;
     #18#98 = 0;  #18#100 = 0;

     |SI nCampoAsala1 = 1;
         #18#97 = #18#97 + #18#26;
         #18#98 = #18#98 + #18#48;
     |FINSI;

     |SI nCampoAsala2 = 1;
         #18#99  = #18#99  + #18#27;
         #18#100 = #18#100 + #18#49;
     |FINSI;

     |SI nCampoAsala3 = 1;
         #18#99  = #18#99  + #18#28;
         #18#100 = #18#100 + #18#50;
     |FINSI;

     |SI nCampoAsala4 = 1;
         #18#99  = #18#99  + #18#29;
         #18#100 = #18#100 + #18#51;
     |FINSI;

     |SI nCampoAsala5 = 1;
         #18#99  = #18#99  + #18#30;
         #18#100 = #18#100 + #18#52;
     |FINSI;

     |SI nCampoAsala6 = 1;
         #18#99  = #18#99  + #18#31;
         #18#100 = #18#100 + #18#53;
     |FINSI;

     |SI nCampoAsala7 = 1;
         #18#99  = #18#99  + #18#32;
         #18#100 = #18#100 + #18#54;
     |FINSI;

     |SI nCampoAsala8 = 1;
         #18#99  = #18#99  + #18#33;
         #18#100 = #18#100 + #18#55;
     |FINSI;

     |PINTA #18#120;
     |PINTA #18#121;
     |PINTA #18#122;
     |PINTA #18#123;

     |HAZ ImporteTotal;

     |SI nTeclaAsal = 11;
         |SI nCampoTrab = 26;  |O nCampoTrab = 48;
             |SI #18#120 ! 0;
                 |CONFI "      Ya tenemos Numeros introducidos, Desea traer numeros del IVA";
                 |SI FSalida ! 0;  |ACABA;  |FINSI;
             |FINSI;
             |HAZ TraeProvisionIVA;
             |ERROR;
         |FINSI;
     |FINSI;

     |SI nTeclaAsal = 12;
         |SI nCampoTrab = 26;  |O nCampoTrab = 48;
             |SI #18#121 ! 0;
                 |CONFI "      Ya tenemos Numeros introducidos, Desea traer numeros del IVA";
                 |SI FSalida ! 0;  |ACABA;  |FINSI;
             |FINSI;
             |HAZ TraeDefinitivoIVA;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Para;
     |SI nTeclaPara ! 5;  |ACABA;  |FINSI;

     nTeclaPara = 0;
     |ERROR;
|FPRC;


|PROCESO Tipo12m018;  |TIPO 12;
     |MENSA "       Pulse Tecla para Salir";
     |LEETECLA aAlfa;
|FPRC;

|PROCESO ImporteDeFuera;
     |ABRE #18;
     #18#0 = enEmpresa;
     #18#1 = enEjer;
     #18#2 = enComplem;
     #18#3 = enActividad;
     |LEE 101#18=;
     |SI FSalida ! 0;  |CIERRA #18;  |ACABA;  |FINSI;

     |ABRE #16;
     |SELECT #1#16;
     #16#0  = "E";
     #16#1  = eaCodEpi2;
     #16#41 = enCodEpi3;
     #16#2  = enEjer;
     |LEE 040#16=;
     |SI FSalida ! 0;  |DDEFECTO #16;  |FINSI;
     |CIERRA #16;

     |HAZ PonTipos;

     #18#120 = 0;
     |PARA nConta = 37;  |SI nConta [ 44;  |HACIENDO nConta = nConta + 1;
           #18#120 = #18#120 + #18nConta;
     |SIGUE;

     #18#121 = 0;
     |PARA nConta = 59;  |SI nConta [ 66;  |HACIENDO nConta = nConta + 1;
           #18#121 = #18#121 + #18nConta;
     |SIGUE;

     #18#97 = 0;  #18#99  = 0;
     #18#98 = 0;  #18#100 = 0;

     |SI nCampoAsala1 = 1;
         #18#97 = #18#97 + #18#26;
         #18#98 = #18#98 + #18#48;
     |FINSI;

     |SI nCampoAsala2 = 1;
         #18#99  = #18#99  + #18#27;
         #18#100 = #18#100 + #18#49;
     |FINSI;

     |SI nCampoAsala3 = 1;
         #18#99  = #18#99  + #18#28;
         #18#100 = #18#100 + #18#50;
     |FINSI;

     |SI nCampoAsala4 = 1;
         #18#99  = #18#99  + #18#29;
         #18#100 = #18#100 + #18#51;
     |FINSI;

     |SI nCampoAsala5 = 1;
         #18#99  = #18#99  + #18#30;
         #18#100 = #18#100 + #18#52;
     |FINSI;

     |SI nCampoAsala6 = 1;
         #18#99  = #18#99  + #18#31;
         #18#100 = #18#100 + #18#53;
     |FINSI;

     |SI nCampoAsala7 = 1;
         #18#99  = #18#99  + #18#32;
         #18#100 = #18#100 + #18#54;
     |FINSI;

     |SI nCampoAsala8 = 1;
         #18#99  = #18#99  + #18#33;
         #18#100 = #18#100 + #18#55;
     |FINSI;

     |HAZ ImporteTotal;

     |GRABA 020#18a;
     |LIBERA #18;
     |CIERRA #18;
|FPRC;

|PROGRAMA;
    |HAZ LeeEURODBMOD;

    |SI enTipoPase = 1;
         |HAZ ImporteDeFuera;
         |ACABA;
     |FINSI;

     enDondeEstoy = 1;

     |SI enEmpresa = 0;
         aFichero = ("18" + Usuario + "zzzzzzzz") % 108;
         |NOME_DAT #18 aFichero;

         aFichero = ("19" + Usuario + "zzzzzzzz") % 108;
         |NOME_DAT #19 aFichero;
     |FINSI;

     enTpEm = 0;
     |ABRE #118;
     #118#0 = enEmpresa;
     |LEE 041#118=;
     |SI FSalida = 0;
         enTpEm  = #118#87;
     |FINSI;
     |CIERRA #118;


     |ABRE #18;
     #18#0 = enEmpresa;
     #18#1 = enEjer;
     #18#2 = enComplem;
     #18#3 = enActividad;
     |LEE 101#18=;
     |SI FSalida ! 0;
         |DDEFECTO #18;
         #18#0 = enEmpresa;
         #18#1 = enEjer;
         #18#2 = enComplem;
         #18#3 = enActividad;

         |ABRE #214;
         #214#0 = #18#0;
         #214#1 = #18#3;
         |LEE 040#214=;
         |SI FSalida ! 0;  |DDEFECTO #214;  |FINSI;
         |CIERRA #214;

         #18#117 = #214#13;

         |GRABA 020#18b;
     |FINSI;

     |HAZ CogeModulo;

     |SI nError = 1;
         |SI enEntradaMod = 0;
             |MENAV "     Epigrafe no sujeto a Actividad de Modulos por I.R.P.F.";
         |FINSI;

         |BORRA 020#18a;
         |LIBERA #18;
         |CIERRA #18;
         |ACABA;
     |FINSI;

     |SI enEntradaMod [ 1;
         |SI enEntradaMod = 1;
             |PTEC 806;
             |PTEC 806;
         |FINSI;

         |PINPA #0#18;
         |PINDA #0#18;
         |ENDATOS #1#18;
         |SI FSalida = 0;
             |GRABA 020#18a;
         |FINSI;
         |LIBERA #18;
         |CIERRA #18;
     |FINSI;
|FPRO;
