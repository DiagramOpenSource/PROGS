|FICHEROS;
     dsmoy000 #0;
     dsmom001 #1;
     dsmom004 #4;
     dsmom107 #107;
     dsmom999 #199;

     dsm39001 #390;
     dsm39002 #490;
     dsm39003 #590;
     dsm39004 #690;

     dsmow014 #999;

     dsmow531 #531;  || Def Secuencial 2001
     dsmow532 #532;
     dsmow533 #533;
     dsmow534 #534;

     dsmow547 #547;  || Def Secuencial 2002
     dsmow548 #548;
     dsmow549 #549;
     dsmow550 #550;

     :/basica/def/agim0004 #24;
     :/basica/def/agicen15 #1015;

     &regisnif@ #709;
     &clientes@ #715;
     &datosper@ #718;
|FIN;

|VARIABLES;
     aLetrasCif      = "ABCDEFGHNPQSKLMJUVWR";
     aImpre          = "";
     aIPRemoto       = "";
     nNueEjer        = 0;

     nGrupo          = 0;
     nSubGrupo       = 0;
     nCampo1         = 0;
     nCampo2         = 0;
     nCampo3         = 0;
     nCampo4         = 0;
     nCampo5         = 0;
     nCampo6         = 0;
     nSwHay          = 0;
     nModulos        = 0;
     nLineaC         = 0;
     nTopeD          = 0;
     nTopeH          = 0;
     nComple         = 0;
     nComplementaria = 0;
     nImpreLaser     = 0;

     &enTecla        = 0;
     &enEmpresa      = 0;
     &enEjer         = 0;
     &enComplem      = 0;
     &enTipoEntrada  = 0;
|FIN;

|INCLUYE i_varemi;

|PROCESO EmiteAntes390;
     aAlfa = "DEL *.tab"  + &13 + &10;  |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.exe"  + &13 + &10;  |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.wmf"  + &13 + &10;  |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.dll"  + &13 + &10;  |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL error390.txt"  + &13 + &10;  |XGRABA nHandle1, aAlfa;
     |XCIERRA nHandle1;

     |DBASS aModelos;  |QBT aModelos;
     aModelos = aModelos + "basica/";

     |SI #0#6 = 2001;
         eaFOrigen  = aModelos + "patrones/zls01390.exe";
         eaFDestino = eaPathLanza + "zls01390.exe";
     |FINSI;

     |SI #0#6 = 2002;
         eaFOrigen  = aModelos + "patrones/zls02390.exe";
         eaFDestino = eaPathLanza + "zls02390.exe";
     |FINSI;

     |SI #0#6 = 2003;
         eaFOrigen  = aModelos + "patrones/zls03390.exe";
         eaFDestino = eaPathLanza + "zls03390.exe";
     |FINSI;

     |SI #0#6 [ 2003;
         |HAZ CopiaFichero;

         aAlfa = eaPathLanza + "IMPRIME";
         |RSYSTEM aAlfa;

         eaFichError = "err";
         eaFichDatos = #0#0;
         eaFichAuxil = "";
         eaExtension = "";

         |HAZ BuscaErroresL;
     |FINSI;
|FPRC;

|PROCESO GrabaPdf;
     |DBASE aPathPdf;  |QBT aPathPdf;
     aPathPdf = aPathPdf + "modelospdf";                    |MKDIR aPathPdf;
     aPathPdf = aPathPdf + "/" + #0#0;                      |MKDIR aPathPdf;
     aPathPdf = aPathPdf + "/" + #0#6;                      |MKDIR aPathPdf;
     aPathPdf = aPathPdf + "/99";                           |MKDIR aPathPdf;
     aPathPdf = aPathPdf + "/" + (("00" + #390#3) % -102);  |MKDIR aPathPdf;
     aPathPdf = aPathPdf + "/";

     aOrigen  = eaPathLanza + aFichPdf;
     aDestino = aPathPdf + aFichPdf;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;
     |SI aIPRemoto ! "";
         |RECIBE_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;
|FPRC;

|PROCESO BorraPdf390;
     |DBASE aPathPdf;  |QBT aPathPdf;
     aPathPdf = aPathPdf + "modelospdf";                    |MKDIR aPathPdf;
     aPathPdf = aPathPdf + "/" + #0#0;                      |MKDIR aPathPdf;
     aPathPdf = aPathPdf + "/" + #0#6;                      |MKDIR aPathPdf;
     aPathPdf = aPathPdf + "/99";                           |MKDIR aPathPdf;
     aPathPdf = aPathPdf + "/" + (("00" + #390#3) % -102);  |MKDIR aPathPdf;
     aPathPdf = aPathPdf + "/";

     aDestino = aPathPdf + aFichPdf;
     |FBORRA aDestino;
|FPRC;

|PROCESO EmiteXml390;
     |PUSHV 0501 2380;
     |BLANCO 0501 2380;
     |CUADRO 0501 2380;
     |CUADRO 0714 0970;
     |ATRI R;
     |PINTA 0815, " EMITIENDO EL MODELO, ESTO PUEDE TARDAR VARIOS MINUTOS ";
     |ATRI r;

     |MENSA "0000 EMITIENDO EL MODELO, ESTO PUEDE TARDAR VARIOS MINUTOS";

     aAbre = eaPathLanza + aFichPdf;
     |RFBORRA aAbre;

     aAbre =  eaPathLanza + "390" + (("00000" + #999#0) % -105) + "Borrador.pdf";
     |RFBORRA aAbre;

     aAbre = eaPathLanza + aFichJus2;
     |RFBORRA aAbre;

     aAbre = eaPathLanza + "imprime.bat";
     |XABRE "CBW", aAbre, nHandle1;

     aAlfa = "CD " + eaPathLanza + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = eaDirJava + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = #0#6;
     aAlfa = aAlfa % -102;
     |SI aImpre = "I";  |O aImpre = "P";
         |HAZ BorraPdf390;

         aAlfa = "MIIVA" + aAlfa;
         aAlfa = aAlfa + " /E:" + aFichXml;
         aAlfa = aAlfa + " /P:" + aFichPdf;
         aAlfa = aAlfa + " /R:" + aFichErr;
         aAlfa = aAlfa + " /C:" + aTercera;
         |SI #0#6 = 2004;
             aAlfa = aAlfa + " /V:S";
         |FINSI;
         aAlfa = aAlfa + &13 + &10;
     |SINO;
         aAlfa = "MIIVA" + aAlfa;
         aAlfa = aAlfa + " /E:" + aFichXml;
         aAlfa = aAlfa + " /P:" + aFichPdf;
         aAlfa = aAlfa + " /R:" + aFichErr;
         |SI #0#6 = 2004;  aAlfa = aAlfa + " /V:S";  |FINSI;
         |SI #0#6 = 2005;  aAlfa = aAlfa + " /S:S";  |FINSI;
         |SI #0#6 ] 2006;  aAlfa = aAlfa + " /V:S";  |FINSI;
         aAlfa = aAlfa + &13 + &10;
     |FINSI;

     |XGRABA nHandle1, aAlfa;

     |XCIERRA nHandle1;

     aAlfa = eaPathLanza + "imprime.bat";
     |RSYSTEM aAbre;

     |RFBORRA aAlfa;

     |SI #0#6 ] 2008;
         |SI aImpre = "I";  |O aImpre = "P";
             aAbre =  eaPathLanza + "390" + (("00000" + #999#0) % -105) + "Borrador.pdf";
             |XABRE "EC", aAbre, nHandle1;
             |SI FSalida ] 0;
                 aOrigen  = aAbre;
                 aDestino = eaPathLanza + aFichPdf;
                 |RRENOMBRA_FICHERO aOrigen, aDestino;
             |FINSI;
         |FINSI;
     |FINSI;

     aAbre = eaPathLanza + aFichPdf;
     |XABRE "EC", aAbre, nHandle1;
     |SI FSalida ] 0;
         |SI aImpre = "I";  |O aImpre = "P";
             aOrigen  = eaPathLanza + aFichJus1;
             aDestino = eaPathLanza + aFichJus2;
             |RRENOMBRA_FICHERO aOrigen, aDestino;

             |HAZ LocalizaAcrobat;
             |SI enError = 0;
                 aAbre = eaPathLanza + "imprime.bat";
                 |XABRE "CBW", aAbre, nHandle1;

                 aAlfa = "CD " + eaPathLanza + &13 + &10;
                 |XGRABA nHandle1, aAlfa;

                 |HAZ TraeWait;

                 |SI aImpre = "I";
                     aAlfa = "wait dsprint " + aFichPdf + &13 + &10;
                     |XGRABA nHandle1, aAlfa;
                 |FINSI;

                 |SI aImpre = "P";
                     aAlfa = "wait " + eaPathAcrobat + " " + aFichPdf + &13 + &10;
                     |XGRABA nHandle1, aAlfa;
                 |FINSI;

                 |XCIERRA nHandle1;
                 |RSYSTEM aAbre;

                 |RFBORRA aAbre;

                 aAlfa = eaPathLanza + aFichXml;
                 |RFBORRA aAlfa;

                 |HAZ GrabaPdf;

                 aAlfa  = eaPathLanza + aFichPdf;
                 |RFBORRA aAlfa;
             |FINSI;
         |SINO;
             |SI #0#6 = 2004;
                 aAlfa  = eaPathLanza + aFichJus1;  |RFBORRA aAlfa;
                 aAlfa  = eaPathLanza + aFichPdf;   |RFBORRA aAlfa;

                 aOrigen  = eaPathLanza + aFichXml;
                 aDestino = eaPathInternet  + aFichXml;
                 |RCOPIA_FICHERO aOrigen, aDestino;

                 |RFBORRA aOrigen;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #0#6 ] 2005;
         |SI aImpre = "C";
             aAbre = eaPathLanza + aFichJus1;
             |XABRE "EC", aAbre, nHandle1;
             |SI FSalida ] 0;
                 aAlfa  = eaPathLanza + aFichJus1;  |RFBORRA aAlfa;

                 aOrigen  = eaPathLanza + aFichXml;
                 aDestino = eaPathInternet  + aFichXml;
                 |RCOPIA_FICHERO aOrigen, aDestino;

                 |RFBORRA aOrigen;
             |FINSI;
         |FINSI;
     |FINSI;

     |POPV;
|FPRC;

|PROCESO EmiteEsto390;
     |SI #0#6 [ 2003;
         |HAZ EmiteAntes390;
     |SINO;
         |HAZ EmiteXml390;
     |FINSI;
|FPRC;

|PROCESO BuscaComuneros;
     aAlfa = "31.12." + #390#1;
     |SI #1#8 > aAlfa;  |ACABA;  |FINSI;

     aAlfa = "01.01." + #390#1;
     |SI #1#9 ! "01.01.0000";
         |SI #1#9 < aAlfa;  |ACABA;  |FINSI;
     |FINSI;

     enComuneros = 1;

     enCodCli = #1#3;
     |HAZ LeePersona;

     |SI #0#6 = 2001;
         |SI enSwDeDonde = 1;
             eaVarDni = #715#3;  |HAZ CalculameDNI;   #531#39 = eaVarDni;
             eaAlfa   = #715#1;  |HAZ QuitaRaros;     #531#40 = eaAlfa;
             #531#41  = #715#29;
             eaAlfa   = #715#30;  |HAZ QuitaRaros;    #531#42 = eaAlfa;
             #531#43  = #715#31 % 104;
             #531#44  = #715#32;
             #531#45  = #715#33;
             #531#46  = #715#34;
             eaAlfa   = #715#54;  |HAZ QuitaRarosTfno;  #531#47  = eaAlfa;
             eaAlfa   = #715#37;  |HAZ QuitaRaros;      #531#48  = eaAlfa;
             eaAlfa   = #715#38;  |HAZ QuitaRaros;      #531#49  = eaAlfa;
             #531#50 = (("00" + #715#35) % -102) + (("000" + #715#36) % -103);
         |SINO;
             eaVarDni = #715#13; |HAZ CalculameDNI;     #531#39  = eaVarDni;
             eaAlfa   = #715#1;  |HAZ QuitaRaros;       #531#40  = eaAlfa;
             #531#41  = #715#3;
             eaAlfa   = #715#4;  |HAZ QuitaRaros;       #531#42  = eaAlfa;
             #531#43  = #715#5 % 104;
             #531#44  = #715#6;
             #531#45  = #715#7;
             #531#46  = #715#8;
             eaAlfa   = #715#14;  |HAZ QuitaRarosTfno;  #531#47  = eaAlfa;
             eaAlfa   = #715#11;  |HAZ QuitaRaros;      #531#48  = eaAlfa;
             eaAlfa   = #715#12;  |HAZ QuitaRaros;      #531#49  = eaAlfa;
             #531#50  = (("00" + #715#9) % -102) + (("000" + #715#10) % -103);
         |FINSI;
     |FINSI;

     |SI #0#6 ] 2002;
         |SI enSwDeDonde = 1;
             eaVarDni = #715#3;  |HAZ CalculameDNI;   #547#41 = eaVarDni;
             eaAlfa   = #715#1;  |HAZ QuitaRaros;     #547#42 = eaAlfa;
             #547#43  = #715#29;
             eaAlfa   = #715#30;  |HAZ QuitaRaros;    #547#44 = eaAlfa;
             #547#45  = #715#31 % 104;
             #547#46  = #715#32;
             #547#47  = #715#33;
             #547#48  = #715#34;
             eaAlfa   = #715#54;  |HAZ QuitaRarosTfno;  #547#49  = eaAlfa;
             eaAlfa   = #715#37;  |HAZ QuitaRaros;      #547#50  = eaAlfa;
             eaAlfa   = #715#38;  |HAZ QuitaRaros;      #547#51  = eaAlfa;
             #547#52 = (("00" + #715#35) % -102) + (("000" + #715#36) % -103);
         |SINO;
             eaVarDni = #715#13; |HAZ CalculameDNI;     #547#41  = eaVarDni;
             eaAlfa   = #715#1;  |HAZ QuitaRaros;       #547#42  = eaAlfa;
             #547#43  = #715#3;
             eaAlfa   = #715#4;  |HAZ QuitaRaros;       #547#44  = eaAlfa;
             #547#45  = #715#5 % 104;
             #547#46  = #715#6;
             #547#47  = #715#7;
             #547#48  = #715#8;
             eaAlfa   = #715#14;  |HAZ QuitaRarosTfno;  #547#49  = eaAlfa;
             eaAlfa   = #715#11;  |HAZ QuitaRaros;      #547#50  = eaAlfa;
             eaAlfa   = #715#12;  |HAZ QuitaRaros;      #547#51  = eaAlfa;
             #547#52  = (("00" + #715#9) % -102) + (("000" + #715#10) % -103);
         |FINSI;
     |FINSI;

     |ERROR10;
|FPRC;

|DEFBUCLE dsmom001;
     #1#1;
     ;
     #390#0, 01, 0001;
     #390#0, 99, 9999;
     ;
     NULL, BuscaComuneros;
|FIN;

|PROCESO PonRepresentantes;
     |SI #0#6 = 2001;
         nLinea = nLinea + 1;
         |SI nLinea = 1;
             eaAlfa   = #24#3;   |HAZ QuitaRaros;
             #531#56  = eaAlfa % 118;
             #531#57  = eaAlfa % 1918;
             eaVarDni = #24#2; |HAZ CalculameDNI;     #531#58  = eaVarDni;
             #531#59  = (#24#4 % 102) + (#24#4 % 402) + (#24#4 % -104);
             eaAlfa   = #24#5;  |HAZ QuitaRaros;      #531#60  = eaAlfa;
         |FINSI;

         |SI nLinea = 2;
             eaAlfa   = #24#3;   |HAZ QuitaRaros;
             #531#61  = eaAlfa % 118;
             #531#62  = eaAlfa % 1918;
             eaVarDni = #24#2; |HAZ CalculameDNI;     #531#63  = eaVarDni;
             #531#64  = (#24#4 % 102) + (#24#4 % 402) + (#24#4 % -104);
             eaAlfa   = #24#5;  |HAZ QuitaRaros;      #531#65  = eaAlfa;
         |FINSI;

         |SI nLinea = 3;
             eaAlfa   = #24#3;   |HAZ QuitaRaros;
             #531#66  = eaAlfa % 118;
             #531#67  = eaAlfa % 1918;
             eaVarDni = #24#2; |HAZ CalculameDNI;     #531#68  = eaVarDni;
             #531#69  = (#24#4 % 102) + (#24#4 % 402) + (#24#4 % -104);
             eaAlfa   = #24#5;  |HAZ QuitaRaros;      #531#70  = eaAlfa;
         |FINSI;
     |FINSI;

     |SI #0#6 ] 2002;
         nLinea = nLinea + 1;
         |SI nLinea = 1;
             eaAlfa   = #24#3;   |HAZ QuitaRaros;     #547#58  = eaAlfa;
             eaVarDni = #24#2;   |HAZ CalculameDNI;   #547#59  = eaVarDni;
             #547#60  = (#24#4 % 102) + (#24#4 % 402) + (#24#4 % -104);
             eaAlfa   = #24#5;   |HAZ QuitaRaros;     #547#61  = eaAlfa;
         |FINSI;

         |SI nLinea = 2;
             eaAlfa   = #24#3;   |HAZ QuitaRaros;     #547#62  = eaAlfa;
             eaVarDni = #24#2;   |HAZ CalculameDNI;   #547#63  = eaVarDni;
             #547#64  = (#24#4 % 102) + (#24#4 % 402) + (#24#4 % -104);
             eaAlfa   = #24#5;   |HAZ QuitaRaros;     #547#65  = eaAlfa;
         |FINSI;

         |SI nLinea = 3;
             eaAlfa   = #24#3;   |HAZ QuitaRaros;     #547#66  = eaAlfa;
             eaVarDni = #24#2;   |HAZ CalculameDNI;   #547#67  = eaVarDni;
             #547#68  = (#24#4 % 102) + (#24#4 % 402) + (#24#4 % -104);
             eaAlfa   = #24#5;   |HAZ QuitaRaros;     #547#69  = eaAlfa;
         |FINSI;
     |FINSI;

     |SI nLinea = 3;  |ERROR10;  |FINSI;
|FPRC;

|DEFBUCLE agim0004;
     #24#1;
     ;
     #390#0, 01;
     #390#0, 99;
     ;
     NULL, PonRepresentantes;
|FIN;

|PROCESO BuscaFirmantes;
     |SI #0#6 = 2001;
         enComuneros = 0;
         |BUCLE dsmom001;
         |SI enComuneros = 1;
             #531#51 = (#0#7 % 102) + (#0#7 % 402) + (#0#7 % -104);
             |ACABA;
         |FINSI;

         nLinea = 0;
         |BUCLE agim0004;
         eaAlfa  = #0#7;  |HAZ FechaBonito;
         |SI nLinea = 0;
             #531#51 = (#0#7 % 102) + (#0#7 % 402) + (#0#7 % -104);
         |SINO;
             #531#52 = #531#12;
             #531#53 = eaDiaB;
             #531#54 = eaMesB;
             #531#55 = eaAnyoB;
         |FINSI;
     |FINSI;

     |SI #0#6 ] 2002;
         enComuneros = 0;
         |BUCLE dsmom001;
         |SI enComuneros = 1;  |O eaComBienes = "S";
             #547#53 = (#0#7 % 102) + (#0#7 % 402) + (#0#7 % -104);

             |SI enComuneros = 1;
                 |ACABA;
             |FINSI;
         |FINSI;

         |SI #547#53 = "        ";
             nLinea = 0;
             |BUCLE agim0004;
             eaAlfa  = #0#7;  |HAZ FechaBonito;
             |SI nLinea = 0;
                 #547#53 = (#0#7 % 102) + (#0#7 % 402) + (#0#7 % -104);
             |SINO;
                 #547#54 = #547#14;
                 #547#55 = eaDiaB;
                 #547#56 = eaMesB;
                 #547#57 = eaAnyoB;
             |FINSI;
         |FINSI;

         |SI #547#53 ! "        ";
             aAlfa = #547#58;  |QBF aAlfa;
             |SI #547#41 = "         ";  |Y aAlfa = "";
                 |ABRE #1015;
                 #1015#0 = #390#0;
                 |LEE 000#1015=;
                 |SI FSalida ! 0;  |DDEFECTO #1015;  |FINSI;
                 |CIERRA #1015;

                 |SI #1015#0 =  "            ";  |ACABA;  |FINSI;

                 enCodCli = #390#0;
                 |HAZ LeePersona;
                 |SI enSwDeDonde = 1;
                     |SI #715#3  = #1015#4;  |ACABA;  |FINSI;
                 |SINO;
                     |SI #715#13 = #1015#4;  |ACABA;  |FINSI;
                 |FINSI;

                 eaVarDni = #1015#4;  |HAZ CalculameDNI;   #547#41 = eaVarDni;
                 eaAlfa   = #1015#5;  |HAZ QuitaRaros;     #547#42 = eaAlfa;
                 #547#43  = #1015#8;
                 eaAlfa   = #1015#9;  |HAZ QuitaRaros;     #547#44 = eaAlfa;
                 #547#45  = #1015#10 % 104;
                 #547#46  = #1015#11;
                 #547#47  = #1015#12;
                 #547#48  = #1015#13;
                 eaAlfa   = #1015#14;  |HAZ QuitaRarosTfno;  #547#49  = eaAlfa;
                 eaAlfa   = #1015#17;  |HAZ QuitaRaros;      #547#50  = eaAlfa;
                 eaAlfa   = #1015#18;  |HAZ QuitaRaros;      #547#51  = eaAlfa;
                 #547#52 = (("00" + #1015#15) % -102) + (("000" + #1015#16) % -103);
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Regis390T1A2001;
     |ABRE #390;
     #390#0 = #4#0;
     #390#1 = #4#1;
     #390#2 = #4#3;
     #390#3 = #4#4;
     |LEE 040#390=;
     |SI FSalida ! 0;  |CIERRA #390;  |ACABA;  |FINSI;
     |CIERRA #390;

     enCodCli = #390#0;
     |HAZ LeePersona;

     |DDEFECTO #531;

     #531#1  = "390";
     #531#2  = "01";
     #531#3  = "";

     |SI enSwDeDonde = 1;
         #531#4   = (("00" + #715#15) % -102) + (("000" + #715#16) % -103);
         eaVarDni = #715#3;  |HAZ CalculameDNI;   #531#5   = eaVarDni;

         aAlfa1   = #718#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = aAlfa1;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa;
             eaAlfa = #718#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa;
             #531#6 = aAlfa1 + " " + aAlfa2;
             eaAlfa = #718#4;  |HAZ QuitaRaros;  #531#7 = eaAlfa;
         |SINO;
             eaAlfa = #715#1;  |HAZ QuitaRaros;  #531#6  = eaAlfa;
             #531#7  = ".";
         |FINSI;
         eaAlfa  = #715#54;  |HAZ QuitaRarosTfno;  #531#8  = eaAlfa;

         #531#9  = #715#29;
         eaAlfa  = #715#30;  |HAZ QuitaRaros;  #531#10 = eaAlfa;
         #531#11 = #715#31 % 104;
         eaAlfa  = #715#37;  |HAZ QuitaRaros;  #531#12 = eaAlfa;
         eaAlfa  = #715#38;  |HAZ QuitaRaros;  #531#13 = eaAlfa;
         #531#14 = (("00" + #715#35) % -102) + (("000" + #715#36) % -103);

         eaDeleg     = #715#17;
         eaAdmin     = #715#18;
         eaComBienes = #715#12;
     |SINO;
         #531#4   = (("00" + #715#63) % -102) + (("000" + #715#64) % -103);
         eaVarDni = #715#13; |HAZ CalculameDNI;    #531#5  = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;      #531#6  = eaAlfa;
         #531#7   = ".";
         eaAlfa   = #715#14;  |HAZ QuitaRarosTfno; #531#8  = eaAlfa;
         #531#9   = #715#3;
         eaAlfa   = #715#4;  |HAZ QuitaRaros;      #531#10 = eaAlfa;
         #531#11  = #715#5 % 104;
         eaAlfa   = #715#11;  |HAZ QuitaRaros;     #531#12 = eaAlfa;
         eaAlfa   = #715#12;  |HAZ QuitaRaros;     #531#13 = eaAlfa;
         #531#14 = (("00" + #715#9) % -102) + (("000" + #715#10) % -103);

         eaDeleg     = #715#91;
         eaAdmin     = #715#92;
     |FINSI;

     #531#15  = #390#88;
     #531#16  = #390#1;
     #531#17  = #390#13;

     eaAlfa   = #390#65;  |HAZ QuitaRaros;      #531#18 = eaAlfa;
     #531#19  = #390#66;
     #531#20  = #390#64;
     eaAlfa   = #390#69;  |HAZ QuitaRaros;      #531#21 = eaAlfa;
     #531#22  = #390#70;
     #531#23  = #390#68;
     eaAlfa   = #390#73;  |HAZ QuitaRaros;      #531#24 = eaAlfa;
     #531#25  = #390#74;
     #531#26  = #390#72;
     eaAlfa   = #390#77;  |HAZ QuitaRaros;      #531#27 = eaAlfa;
     #531#28  = #390#78;
     #531#29  = #390#76;
     eaAlfa   = #390#81;  |HAZ QuitaRaros;      #531#30 = eaAlfa;
     #531#31  = #390#82;
     #531#32  = #390#80;
     eaAlfa   = #390#85;  |HAZ QuitaRaros;      #531#33 = eaAlfa;
     #531#34  = #390#86;
     #531#35  = #390#84;

     #531#36  = #390#87;
     eaVarDni = #390#89;  |HAZ CalculameDNI;    #531#37 = eaVarDni;
     eaAlfa   = #390#90;  |HAZ QuitaRaros;      #531#38 = eaAlfa;

     |HAZ BuscaFirmantes;

     #531#73 = &13 + &10;

     |SI nTecla = 1;  |O nTecla = 3;
         aAlfa = "";
         |PARA nCampo = 1;  |SI nCampo [ 73;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #531nCampo;
               |XGRABA enHandle2, aAlfa;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Regis390T1A2002;
     |ABRE #390;
     #390#0 = #4#0;
     #390#1 = #4#1;
     #390#2 = #4#3;
     #390#3 = #4#4;
     |LEE 040#390=;
     |SI FSalida ! 0;  |CIERRA #390;  |ACABA;  |FINSI;
     |CIERRA #390;

     enCodCli = #390#0;
     |HAZ LeePersona;

     |DDEFECTO #547;

     #547#1  = "<T";
     #547#2  = "390";
     #547#3  = "01";
     #547#4  = ">";
     #547#5  = "";

     |SI enSwDeDonde = 1;
         #547#6   = (("00" + #715#15) % -102) + (("000" + #715#16) % -103);
         eaVarDni = #715#3;  |HAZ CalculameDNI;   #547#7   = eaVarDni;

         aAlfa1   = #718#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = aAlfa1;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa;
             eaAlfa = #718#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa;
             #547#8 = aAlfa1 + " " + aAlfa2;
             eaAlfa = #718#4;  |HAZ QuitaRaros;  #547#9 = eaAlfa;
         |SINO;
             eaAlfa = #715#1;  |HAZ QuitaRaros;  #547#8  = eaAlfa;
             aCaracter  = eaVarDni % 101;
             aAlfa      = aLetrasCif - aCaracter;
             |SI aAlfa  = aLetrasCif;  #547#9 = ".";  |FINSI;
         |FINSI;

         eaAlfa = #715#55;  |QBF eaAlfa;
         |SI eaAlfa = "";  eaAlfa  = #715#54;  |FINSI;

         |HAZ QuitaRarosTfno;  #547#10 = eaAlfa;

         #547#11  = #715#29;
         eaAlfa   = #715#30;  |HAZ QuitaRaros;  #547#12 = eaAlfa;
         #547#13  = #715#31 % 104;
         eaEscal  = #715#32 % 102;  |QBF eaEscal;
         eaPiso   = #715#33;        |QBF eaPiso;
         eaPuerta = #715#34;        |QBF eaPuerta;
         eaAlfa   = #715#37;  |HAZ QuitaRaros;  #547#14 = eaAlfa;
         eaAlfa   = #715#38;  |HAZ QuitaRaros;  #547#15 = eaAlfa;
         #547#16  = (("00" + #715#35) % -102) + (("000" + #715#36) % -103);

         eaComBienes = #715#12;
         eaDeleg     = #715#17;
         eaAdmin     = #715#18;
     |SINO;
         #547#6   = (("00" + #715#63) % -102) + (("000" + #715#64) % -103);
         eaVarDni = #715#13; |HAZ CalculameDNI;    #547#7  = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;      #547#8  = eaAlfa;

         aCaracter  = eaVarDni % 101;
         aAlfa      = aLetrasCif - aCaracter;
         |SI aAlfa  = aLetrasCif;  #547#9 = ".";  |FINSI;

         eaAlfa   = #715#14;  |HAZ QuitaRarosTfno; #547#10 = eaAlfa;
         #547#11  = #715#3;
         eaAlfa   = #715#4;  |HAZ QuitaRaros;      #547#12 = eaAlfa;
         #547#13  = #715#5 % 104;
         eaEscal  = #715#6 % 102;  |QBF eaEscal;
         eaPiso   = #715#7;        |QBF eaPiso;
         eaPuerta = #715#8;        |QBF eaPuerta;
         eaAlfa   = #715#11;  |HAZ QuitaRaros;     #547#14 = eaAlfa;
         eaAlfa   = #715#12;  |HAZ QuitaRaros;     #547#15 = eaAlfa;
         #547#16 = (("00" + #715#9) % -102) + (("000" + #715#10) % -103);

         eaDeleg     = #715#91;
         eaAdmin     = #715#92;
     |FINSI;

     #547#17 = "0";
     |SI #390#88 = "X";  #547#17  = "1";  |FINSI;

     #547#18  = #390#1;
     #547#19  = #390#13;

     |SI #390#64 = "9999";  #390#64 = "";  |FINSI;
     |SI #390#68 = "9999";  #390#68 = "";  |FINSI;
     |SI #390#72 = "9999";  #390#72 = "";  |FINSI;
     |SI #390#76 = "9999";  #390#76 = "";  |FINSI;
     |SI #390#80 = "9999";  #390#80 = "";  |FINSI;
     |SI #390#84 = "9999";  #390#84 = "";  |FINSI;

     eaAlfa   = #390#65;  |HAZ QuitaRaros;      #547#20 = eaAlfa;
     #547#21  = #390#66;
     #547#22  = #390#64;
     eaAlfa   = #390#69;  |HAZ QuitaRaros;      #547#23 = eaAlfa;
     #547#24  = #390#70;
     #547#25  = #390#68;
     eaAlfa   = #390#73;  |HAZ QuitaRaros;      #547#26 = eaAlfa;
     #547#27  = #390#74;
     #547#28  = #390#72;
     eaAlfa   = #390#77;  |HAZ QuitaRaros;      #547#29 = eaAlfa;
     #547#30  = #390#78;
     #547#31  = #390#76;
     eaAlfa   = #390#81;  |HAZ QuitaRaros;      #547#32 = eaAlfa;
     #547#33  = #390#82;
     #547#34  = #390#80;
     eaAlfa   = #390#85;  |HAZ QuitaRaros;      #547#35 = eaAlfa;
     #547#36  = #390#86;
     #547#37  = #390#84;

     #547#38  = "0";
     |SI #390#87 = "X";  #547#38  = "1";  |FINSI;

     eaVarDni = #390#89;  |HAZ CalculameDNI;    #547#39 = eaVarDni;
     eaAlfa   = #390#90;  |HAZ QuitaRaros;      #547#40 = eaAlfa;

     |HAZ BuscaFirmantes;

     #547#72 = "</T39001>";
     #547#73 = &13 + &10;

     |SI #0#6 [ 2003;
         |SI nTecla = 1;  |O nTecla = 3;
             aAlfa = "";
             |PARA nCampo = 1;  |SI nCampo [ 73;  |HACIENDO nCampo = nCampo + 1;
                   aAlfa = #547nCampo;
                   |XGRABA enHandle2, aAlfa;
             |SIGUE;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO LeeCasilla;
     #490#0  = #390#0;
     #490#1  = #390#1;
     #490#2  = #390#2;
     #490#3  = #390#3;
     #490#4  = nGrupo;
     #490#5  = nSubGrupo;
     |SELECT #1#490;
     |LEE 040#490=;
     |SI FSalida ! 0;  |DDEFECTO #490;  |FINSI;
|FPRC;

|PROCESO LeeCasilla2;
     #490#0   = #390#0;
     #490#1   = #390#1;
     #490#2   = #390#2;
     #490#3   = #390#3;
     #490#24  = nGrupo;
     #490#25  = nSubGrupo;
     |SELECT #2#490;
     |LEE 040#490=;
     |SI FSalida ! 0;  |DDEFECTO #490;  |FINSI;
|FPRC;

|PROCESO CargaModulo;
     |SI #0#6 = 2001;
                                                                #532nCampo = #590#5;
         nCampo = nCampo + 1; enNume  = #590#6;  |HAZ Conver10; #532nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#7;  |HAZ Conver13; #532nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#8;  |HAZ Conver10; #532nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#9;  |HAZ Conver13; #532nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#10; |HAZ Conver10; #532nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#11; |HAZ Conver13; #532nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#12; |HAZ Conver10; #532nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#13; |HAZ Conver13; #532nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#14; |HAZ Conver10; #532nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#15; |HAZ Conver13; #532nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#16; |HAZ Conver10; #532nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#17; |HAZ Conver13; #532nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#18; |HAZ Conver10; #532nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#19; |HAZ Conver13; #532nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#20; |HAZ Conver13; #532nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#21; |HAZ Conver13; #532nCampo = eaAlfa;
         nCampo = nCampo + 1; nNume   = #590#22 * 100;          aAlfa      = ("000" + nNume) % -103;
                                                                #532nCampo = aAlfa;
         nCampo = nCampo + 1; enNume  = #590#23; |HAZ Conver13; #532nCampo = eaAlfa;
         nCampo = nCampo + 1;                                   aAlfa      = ("00" + #590#24) % -102;
                                                                #532nCampo = aAlfa;
         nCampo = nCampo + 1; enNume  = #590#25; |HAZ Conver13; #532nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#26; |HAZ Conver13; #532nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#27; |HAZ Conver13; #532nCampo = eaAlfa;
     |FINSI;

     |SI #0#6 ] 2002;
                                                                #548nCampo = #590#5;
         nCampo = nCampo + 1; enNume  = #590#6;  |HAZ Conver10; #548nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#7;  |HAZ Conver13; #548nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#8;  |HAZ Conver10; #548nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#9;  |HAZ Conver13; #548nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#10; |HAZ Conver10; #548nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#11; |HAZ Conver13; #548nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#12; |HAZ Conver10; #548nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#13; |HAZ Conver13; #548nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#14; |HAZ Conver10; #548nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#15; |HAZ Conver13; #548nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#16; |HAZ Conver10; #548nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#17; |HAZ Conver13; #548nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#18; |HAZ Conver10; #548nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#19; |HAZ Conver13; #548nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#20; |HAZ Conver13; #548nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#21; |HAZ Conver13; #548nCampo = eaAlfa;
         nCampo = nCampo + 1; nNume   = #590#22 * 100;          aAlfa      = ("000" + nNume) % -103;
                                                                #548nCampo = aAlfa;
         nCampo = nCampo + 1; enNume  = #590#23; |HAZ Conver13; #548nCampo = eaAlfa;
         nCampo = nCampo + 1;                                   aAlfa      = ("00" + #590#24) % -102;
                                                                #548nCampo = aAlfa;
         nCampo = nCampo + 1; enNume  = #590#25; |HAZ Conver13; #548nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#26; |HAZ Conver13; #548nCampo = eaAlfa;
         nCampo = nCampo + 1; enNume  = #590#27; |HAZ Conver13; #548nCampo = eaAlfa;
     |FINSI;

     nSwHay = 1;
|FPRC;

|PROCESO Modulos;
     |SI nModulos = 0;
         nLinea = nLinea + 1;
         |SI nLinea > 2; |ACABA;  |FINSI;

         |SI #0#6 = 2001;
             |SI nLinea = 1;  nCampo = 63;  |FINSI;
             |SI nLinea = 2;  nCampo = 86;  |FINSI;
         |FINSI;

         |SI #0#6 ] 2002;
             |SI nLinea = 1;  nCampo = 65;  |FINSI;
             |SI nLinea = 2;  nCampo = 88;  |FINSI;
         |FINSI;

         |HAZ CargaModulo;
     |SINO;
         nLineaC = nLineaC + 1;

         |SI nLineaC [ nTopeD;             |ACABA;  |FINSI;
         |SI nLineaC > nTopeH;  |ERROR10;  |ACABA;  |FINSI;

         nNume = nLineaC - nTopeD;

         |SI #0#6 = 2001;
             |SI nNume = 1;  nCampo = 63;  |FINSI;
             |SI nNume = 2;  nCampo = 86;  |FINSI;
         |FINSI;

         |SI #0#6 ] 2002;
             |SI nNume = 1;  nCampo = 65;  |FINSI;
             |SI nNume = 2;  nCampo = 88;  |FINSI;
         |FINSI;

         |HAZ CargaModulo;
     |FINSI;
|FPRC;

|DEFBUCLE dsm39003;
     #590#1;
     ;
     #390#0, #390#1, #390#2, #390#3, 01;
     #390#0, #390#1, #390#2, #390#3, 99;
     ;
     NULL, Modulos;
|FIN;

|PROCESO Regis390T2A2001;
     |DDEFECTO #532;

     |ABRE #490;

     nSwHay = 0;
     #532#1 = "390";
     #532#2 = "02";
     #532#3 = "";

     nGrupo  = 1;  nSubGrupo = 1;  |HAZ LeeCasilla;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 4;
               enNume  = #490nCampo1;  |HAZ Conver13;  #532#4  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #532#5  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 7;
               enNume  = #490nCampo1;  |HAZ Conver13;  #532#6  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #532#7  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 16;
               enNume  = #490nCampo1;  |HAZ Conver13;  #532#8  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #532#9  = eaAlfa;
           |FINSI;
     |SIGUE;

     nGrupo  = 1;  nSubGrupo = 2;  |HAZ LeeCasilla;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 4;
               enNume  = #490nCampo1;  |HAZ Conver13;  #532#10  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #532#11  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 7;
               enNume  = #490nCampo1;  |HAZ Conver13;  #532#12 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #532#13 = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 16;
               enNume  = #490nCampo1;  |HAZ Conver13;  #532#14 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #532#15 = eaAlfa;
           |FINSI;
     |SIGUE;

     nGrupo  = 1;  nSubGrupo = 3;  |HAZ LeeCasilla;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 16;
               enNume  = #490nCampo1;  |HAZ Conver13;  #532#16 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #532#17 = eaAlfa;
           |FINSI;
     |SIGUE;

     nGrupo  = 1;  nSubGrupo = 5;  |HAZ LeeCasilla;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 4;
               enNume  = #490nCampo1;  |HAZ Conver13;  #532#18  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #532#19  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 7;
               enNume  = #490nCampo1;  |HAZ Conver13;  #532#20 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #532#21 = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 16;
               enNume  = #490nCampo1;  |HAZ Conver13;  #532#22 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #532#23 = eaAlfa;
           |FINSI;
     |SIGUE;

     nGrupo  = 1;  nSubGrupo = 6;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #532#24 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #532#25 = eaAlfa;

     nGrupo  = 1;  nSubGrupo = 7;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #532#26 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #532#27 = eaAlfa;

     nGrupo  = 1;  nSubGrupo = 8;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #532#28 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #532#29 = eaAlfa;

     nGrupo  = 1;  nSubGrupo = 9;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #532#30 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #532#31 = eaAlfa;

     nGrupo  = 1;  nSubGrupo = 10;  |HAZ LeeCasilla;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 0.5;
               enNume  = #490nCampo1;  |HAZ Conver13;  #532#32  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #532#33  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 1;
               enNume  = #490nCampo1;  |HAZ Conver13;  #532#34 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #532#35 = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 4;
               enNume  = #490nCampo1;  |HAZ Conver13;  #532#36 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #532#37 = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 1.75;
               enNume  = #490nCampo1;  |HAZ Conver13;  #532#38 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #532#39 = eaAlfa;
           |FINSI;
     |SIGUE;

     nGrupo  = 1;  nSubGrupo = 11;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #532#40 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #532#41 = eaAlfa;

     nGrupo  = 1;  nSubGrupo = 12;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #532#42 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #532#43 = eaAlfa;

     nGrupo  = 1;  nSubGrupo = 13;  |HAZ LeeCasilla;
     enNume  = #490#11;  |HAZ Conver13;  #532#44 = eaAlfa;
     |SI #490#11 ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 2;  nSubGrupo = 1;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #532#45 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #532#46 = eaAlfa;

     nGrupo  = 2;  nSubGrupo = 2;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #532#47 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #532#48 = eaAlfa;

     nGrupo  = 2;  nSubGrupo = 3;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #532#49 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #532#50 = eaAlfa;

     nGrupo  = 2;  nSubGrupo = 4;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #532#51 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #532#52 = eaAlfa;

     nGrupo  = 2;  nSubGrupo = 5;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #532#53 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #532#54 = eaAlfa;

     nGrupo  = 2;  nSubGrupo = 6;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #532#55 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #532#56 = eaAlfa;

     nGrupo  = 2;  nSubGrupo = 7;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #532#57 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #532#58 = eaAlfa;

     nGrupo  = 2;  nSubGrupo = 8;   |HAZ LeeCasilla;
     enNume  = #490#11;  |HAZ Conver13;  #532#59 = eaAlfa;

     nGrupo  = 2;  nSubGrupo = 9;   |HAZ LeeCasilla;
     enNume  = #490#11;  |HAZ Conver13;  #532#60 = eaAlfa;

     nGrupo  = 2;  nSubGrupo = 10;  |HAZ LeeCasilla;
     enNume  = #490#11;  |HAZ Conver13;  #532#61 = eaAlfa;
     |SI #490#11 ! 0;  nSwHay = 1;  |FINSI;

     enNume  = #390#4;   |HAZ Conver13;  #532#62 = eaAlfa;

     |CIERRA #490;

     nModulos = 0;
     nLinea   = 0;
     |BUCLE dsm39003;

     #532#109 = &13 + &10;

     |SI nTecla = 1;  |O nTecla = 3;
         |SI nSwHay = 1;
              aAlfa = "";
              |PARA nCampo = 1;  |SI nCampo [ 109;  |HACIENDO nCampo = nCampo + 1;
                    aAlfa = #532nCampo;
                    |XGRABA enHandle2, aAlfa;
              |SIGUE;

              |SI nLinea > 2;
                  nComple         = 0;
                  nComplementaria = (((nLinea - 2) / 2) + 0.5) ! 0;
                  nTopeD  = 2;
                  nTopeH  = 4;

                  |PARA nComple = 1; |SI nComple [ nComplementaria;  |HACIENDO nComple = nComple + 1;
                        nTopeD = nComple * 2;
                        nTopeH = nTopeD + 2;

                        |DDEFECTO #532;
                        nSwHay = 0;
                        #532#1 = "390";
                        #532#2 = "02";
                        #532#3 = "C";
                        nModulos = 1;
                        nLinea   = 0;
                        nLineaC  = 0;
                        |BUCLE dsm39003;

                        #532#109 = &13 + &10;

                        |SI nSwHay = 1;
                            aAlfa = "";
                            |PARA nCampo = 1;  |SI nCampo [ 109;  |HACIENDO nCampo = nCampo + 1;
                                  aAlfa = #532nCampo;
                                  |XGRABA enHandle2, aAlfa;
                            |SIGUE;
                        |FINSI;
                  |SIGUE;
              |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Regis390T2A2002;
     |DDEFECTO #548;

     |ABRE #490;

     nSwHay = 0;
     #548#1 = "<T";
     #548#2 = "390";
     #548#3 = "02";
     #548#4 = ">";
     #548#5 = "";

     nGrupo  = 1;  nSubGrupo = 1;  |HAZ LeeCasilla;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 4;
               enNume  = #490nCampo1;  |HAZ Conver13;  #548#6  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #548#7  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 7;
               enNume  = #490nCampo1;  |HAZ Conver13;  #548#8  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #548#9  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 16;
               enNume  = #490nCampo1;  |HAZ Conver13;  #548#10 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #548#11 = eaAlfa;
           |FINSI;
     |SIGUE;

     nGrupo  = 1;  nSubGrupo = 2;  |HAZ LeeCasilla;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 4;
               enNume  = #490nCampo1;  |HAZ Conver13;  #548#12  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #548#13  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 7;
               enNume  = #490nCampo1;  |HAZ Conver13;  #548#14 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #548#15 = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 16;
               enNume  = #490nCampo1;  |HAZ Conver13;  #548#16 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #548#17 = eaAlfa;
           |FINSI;
     |SIGUE;

     nGrupo  = 1;  nSubGrupo = 3;  |HAZ LeeCasilla;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 16;
               enNume  = #490nCampo1;  |HAZ Conver13;  #548#18 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #548#19 = eaAlfa;
           |FINSI;
     |SIGUE;

     nGrupo  = 1;  nSubGrupo = 5;  |HAZ LeeCasilla;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 4;
               enNume  = #490nCampo1;  |HAZ Conver13;  #548#20 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #548#21 = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 7;
               enNume  = #490nCampo1;  |HAZ Conver13;  #548#22 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #548#23 = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 16;
               enNume  = #490nCampo1;  |HAZ Conver13;  #548#24 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #548#25 = eaAlfa;
           |FINSI;
     |SIGUE;

     nGrupo  = 1;  nSubGrupo = 4;  |HAZ LeeCasilla;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 4;
               enNume  = #490nCampo1;  |HAZ Conver13;  #548#113 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #548#114 = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 7;
               enNume  = #490nCampo1;  |HAZ Conver13;  #548#115 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #548#116 = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 16;
               enNume  = #490nCampo1;  |HAZ Conver13;  #548#117 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #548#118 = eaAlfa;
           |FINSI;
     |SIGUE;

     nGrupo  = 1;  nSubGrupo = 6;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #548#26 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #548#27 = eaAlfa;

     nGrupo  = 1;  nSubGrupo = 7;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #548#28 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #548#29 = eaAlfa;

     nGrupo  = 1;  nSubGrupo = 8;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #548#30 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #548#31 = eaAlfa;

     nGrupo  = 1;  nSubGrupo = 9;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #548#32 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #548#33 = eaAlfa;

     nGrupo  = 1;  nSubGrupo = 10;  |HAZ LeeCasilla;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 0.5;
               enNume  = #490nCampo1;  |HAZ Conver13;  #548#34  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #548#35  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 1;
               enNume  = #490nCampo1;  |HAZ Conver13;  #548#36 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #548#37 = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 4;
               enNume  = #490nCampo1;  |HAZ Conver13;  #548#38 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #548#39 = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 1.75;
               enNume  = #490nCampo1;  |HAZ Conver13;  #548#40 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #548#41 = eaAlfa;
           |FINSI;
     |SIGUE;

     nGrupo  = 1;  nSubGrupo = 11;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #548#42 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #548#43 = eaAlfa;

     nGrupo  = 1;  nSubGrupo = 12;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #548#44 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #548#45 = eaAlfa;

     nGrupo  = 1;  nSubGrupo = 13;  |HAZ LeeCasilla;
     enNume  = #490#11;  |HAZ Conver13;  #548#46 = eaAlfa;
     |SI #490#11 ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 2;  nSubGrupo = 1;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #548#47 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #548#48 = eaAlfa;

     nGrupo  = 2;  nSubGrupo = 2;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #548#49 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #548#50 = eaAlfa;

     nGrupo  = 2;  nSubGrupo = 3;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #548#51 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #548#52 = eaAlfa;

     nGrupo  = 2;  nSubGrupo = 4;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #548#53 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #548#54 = eaAlfa;

     nGrupo  = 2;  nSubGrupo = 5;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #548#55 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #548#56 = eaAlfa;

     nGrupo  = 2;  nSubGrupo = 6;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #548#57 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #548#58 = eaAlfa;

     nGrupo  = 2;  nSubGrupo = 7;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #548#59 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #548#60 = eaAlfa;

     nGrupo  = 2;  nSubGrupo = 8;   |HAZ LeeCasilla;
     enNume  = #490#11;  |HAZ Conver13;  #548#61 = eaAlfa;

     nGrupo  = 2;  nSubGrupo = 9;   |HAZ LeeCasilla;
     enNume  = #490#11;  |HAZ Conver13;  #548#62 = eaAlfa;

     |SI #0#6 [ 2007;
         nGrupo  = 2;  nSubGrupo = 10;  |HAZ LeeCasilla;
         enNume  = #490#11;  |HAZ Conver13;  #548#63 = eaAlfa;
         |SI #490#11 ! 0;  nSwHay = 1;  |FINSI;
     |SINO;
         nGrupo  = 2;  nSubGrupo = 11;   |HAZ LeeCasilla;
         enNume  = #490#10;  |HAZ Conver13;  #548#119 = eaAlfa;
         enNume  = #490#11;  |HAZ Conver13;  #548#120 = eaAlfa;

         nGrupo  = 2;  nSubGrupo = 12;   |HAZ LeeCasilla;
         enNume  = #490#10;  |HAZ Conver13;  #548#121 = eaAlfa;
         enNume  = #490#11;  |HAZ Conver13;  #548#122 = eaAlfa;

         nGrupo  = 2;  nSubGrupo = 10;  |HAZ LeeCasilla;
         enNume  = #490#11;  |HAZ Conver13;  #548#123 = eaAlfa;

         nGrupo  = 2;  nSubGrupo = 13;  |HAZ LeeCasilla;
         enNume  = #490#11;  |HAZ Conver13;  #548#63 = eaAlfa;
         |SI #490#11 ! 0;  nSwHay = 1;  |FINSI;
     |FINSI;
     enNume  = #390#4;   |HAZ Conver13;  #548#64 = eaAlfa;

     |CIERRA #490;

     nModulos = 0;
     nLinea   = 0;
     |BUCLE dsm39003;

     #548#111 = "</T39002>";
     #548#112 = &13 + &10;

     |SI #0#6 [ 2003;
         |SI nTecla = 1;  |O nTecla = 3;
             |SI nSwHay = 1;
                  aAlfa = "";
                  |PARA nCampo = 1;  |SI nCampo [ 112;  |HACIENDO nCampo = nCampo + 1;
                        aAlfa = #548nCampo;
                        |XGRABA enHandle2, aAlfa;
                  |SIGUE;

                  |SI nLinea > 2;
                      nComple         = 0;
                      nComplementaria = (((nLinea - 2) / 2) + 0.5) ! 0;
                      nTopeD  = 2;
                      nTopeH  = 4;

                      |PARA nComple = 1; |SI nComple [ nComplementaria;  |HACIENDO nComple = nComple + 1;
                            nTopeD = nComple * 2;
                            nTopeH = nTopeD + 2;

                            |DDEFECTO #548;
                            nSwHay = 0;
                            #548#1 = "<T";
                            #548#2 = "390";
                            #548#3 = "02";
                            #548#4 = ">";
                            #548#5 = "C";
                            nModulos = 1;
                            nLinea   = 0;
                            nLineaC  = 0;
                            |BUCLE dsm39003;

                            #548#111 = "</T39002>";
                            #548#112 = &13 + &10;

                            |SI nSwHay = 1;
                                aAlfa = "";
                                |PARA nCampo = 1;  |SI nCampo [ 112;  |HACIENDO nCampo = nCampo + 1;
                                      aAlfa = #548nCampo;
                                      |XGRABA enHandle2, aAlfa;
                                |SIGUE;
                            |FINSI;
                      |SIGUE;
                  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Regis390T3A2001;
     |DDEFECTO #533;

     |ABRE #490;

     nSwHay = 0;
     #533#1 = "390";
     #533#2 = "03";
     #533#3 = "";

     |PARA nCampo1 = 14;  |SI nCampo1 [ 38;  |HACIENDO nCampo1 = nCampo1 + 6;
           nCampo2 = nCampo1 + 1;
           nCampo3 = nCampo1 + 2;
           nCampo4 = nCampo1 + 3;
           nCampo5 = nCampo1 + 4;
           nCampo6 = nCampo1 + 5;

           |SI #390nCampo1 ! 0;
               nCampo = nCampo1 - 10; aAlfa   = ("00" + #390nCampo1) % -102; #533nCampo = aAlfa;
               nCampo = nCampo + 1;   enNume  = #390nCampo2;  |HAZ Conver13; #533nCampo = eaAlfa;
               nCampo = nCampo + 1;   enNume  = #390nCampo3 * 1000;          aAlfa  = ("0000" + enNume) % -104;
               #533nCampo = aAlfa;
               nCampo = nCampo + 1;   enNume  = #390nCampo4;  |HAZ Conver13; #533nCampo = eaAlfa;
               nCampo = nCampo + 1;   enNume  = #390nCampo4 - #390nCampo6;   |HAZ Conver13; #533nCampo = eaAlfa;
               nCampo = nCampo + 1;   enNume  = #390nCampo6;  |HAZ Conver13; #533nCampo = eaAlfa;
               nSwHay  = 1;
           |FINSI;
     |SIGUE;

     enNume  = #390#44;  |HAZ Conver13;  #533#34 = eaAlfa;
     enNume  = #390#45;  |HAZ Conver13;  #533#35 = eaAlfa;
     enNume  = #390#46;  |HAZ Conver13;  #533#36 = eaAlfa;
     enNume  = #390#47;  |HAZ Conver13;  #533#37 = eaAlfa;
     enNume  = #390#48;  |HAZ Conver13;  #533#38 = eaAlfa;
     enNume  = #390#49;  |HAZ Conver13;  #533#39 = eaAlfa;
     enNume  = #390#50;  |HAZ Conver13;  #533#40 = eaAlfa;
     enNume  = #390#51;  |HAZ Conver13;  #533#41 = eaAlfa;
     enNume  = #390#52;  |HAZ Conver13;  #533#42 = eaAlfa;
     enNume  = #390#5;   |HAZ Conver13;  #533#43 = eaAlfa;
     enNume  = #390#53;  |HAZ Conver13;  #533#44 = eaAlfa;

     |SI #390#54 = 0.01;
         enNume  = 0;        |HAZ Conver13;  #533#45 = eaAlfa;
     |SINO;
         enNume  = #390#54;  |HAZ Conver13;  #533#45 = eaAlfa;
     |FINSI;

     enNume  = #390#6;   |HAZ Conver13;  #533#46 = eaAlfa;
     enNume  = #390#55 * 100;            #533#47 = ("0000" + enNume) % -104;
     enNume  = #390#56 * 100;            #533#48 = ("0000" + enNume) % -104;
     enNume  = #390#57 * 100;            #533#49 = ("0000" + enNume) % -104;
     enNume  = #390#58 * 100;            #533#50 = ("0000" + enNume) % -104;
     enNume  = #390#59 * 100;            #533#51 = ("0000" + enNume) % -104;
     enNume  = #390#60;  |HAZ Conver13;  #533#52 = eaAlfa;
     enNume  = #390#61;  |HAZ Conver13;  #533#53 = eaAlfa;

     |SI #390#62 = 0.01;
         enNume  = 0;        |HAZ Conver13;  #533#54 = eaAlfa;
     |SINO;
         enNume  = #390#62;  |HAZ Conver13;  #533#54 = eaAlfa;
     |FINSI;

     enNume  = #390#7;   |HAZ Conver13;  #533#55 = eaAlfa;
     enNume  = #390#8;   |HAZ Conver13;  #533#56 = eaAlfa;
     enNume  = #390#9;   |HAZ Conver13;  #533#57 = eaAlfa;
     enNume  = #390#10;  |HAZ Conver13;  #533#58 = eaAlfa;
     enNume  = #390#11;  |HAZ Conver13;  #533#59 = eaAlfa;

     |ABRE #490;
     nGrupo  = 3;  nSubGrupo = 1;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #533#60 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 2;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #533#61 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 3;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #533#62 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 8;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #533#63 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 9;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #533#64 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 10;  |HAZ LeeCasilla;
     enNume  = #490#10;
     nGrupo  = 3;  nSubGrupo = 11;  |HAZ LeeCasilla;
     enNume  = enNume + #490#10;  |HAZ Conver13;  #533#65 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 12;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #533#66 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 13;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #533#67 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 14;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #533#68 = eaAlfa;

     enNume  = #390#12;  |HAZ Conver13;  #533#69 = eaAlfa;

     nGrupo  = 4;  nSubGrupo = 1;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #533#70 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 4;  nSubGrupo = 5;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #533#71 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 4;  nSubGrupo = 6;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #533#72 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 4;  nSubGrupo = 7;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #533#73 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 4;  nSubGrupo = 8;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #533#74 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     |CIERRA #490;

     |SI #390#49 ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#5  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#6  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#7  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#8  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#9  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#10 ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#11 ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#12 ! 0;  nSwHay = 1;  |FINSI;

     #533#75 = &13 + &10;

     |SI nTecla = 1;  |O nTecla = 3;
         |SI nSwHay = 1;
             aAlfa = "";
             |PARA nCampo = 1;  |SI nCampo [ 75;  |HACIENDO nCampo = nCampo + 1;
                   aAlfa = #533nCampo;
                   |XGRABA enHandle2, aAlfa;
             |SIGUE;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Regis390T3A2002;
     |DDEFECTO #549;

     |ABRE #490;

     nSwHay = 0;
     #549#1 = "<T";
     #549#2 = "390";
     #549#3 = "03";
     #549#4 = ">";
     #549#5 = "";

     |PARA nCampo1 = 14;  |SI nCampo1 [ 38;  |HACIENDO nCampo1 = nCampo1 + 6;
           nCampo2 = nCampo1 + 1;
           nCampo3 = nCampo1 + 2;
           nCampo4 = nCampo1 + 3;
           nCampo5 = nCampo1 + 4;
           nCampo6 = nCampo1 + 5;

           |SI #390nCampo1 ! 0;
               nCampo = nCampo1 - 8;  aAlfa   = ("00" + #390nCampo1) % -102; #549nCampo = aAlfa;
               nCampo = nCampo + 1;   enNume  = #390nCampo2;  |HAZ Conver13; #549nCampo = eaAlfa;
               nCampo = nCampo + 1;   enNume  = #390nCampo3 * 1000;          aAlfa  = ("0000" + enNume) % -104;
               #549nCampo = aAlfa;
               nCampo = nCampo + 1;   enNume  = #390nCampo4;  |HAZ Conver13; #549nCampo = eaAlfa;
               nCampo = nCampo + 1;   enNume  = #390nCampo4 - #390nCampo6;   |HAZ Conver13; #549nCampo = eaAlfa;
               nCampo = nCampo + 1;   enNume  = #390nCampo6;  |HAZ Conver13; #549nCampo = eaAlfa;
               nSwHay  = 1;
           |FINSI;
     |SIGUE;

     enNume  = #390#44;  |HAZ Conver13;  #549#36 = eaAlfa;
     enNume  = #390#45;  |HAZ Conver13;  #549#37 = eaAlfa;
     enNume  = #390#46;  |HAZ Conver13;  #549#38 = eaAlfa;
     enNume  = #390#47;  |HAZ Conver13;  #549#39 = eaAlfa;
     enNume  = #390#48;  |HAZ Conver13;  #549#40 = eaAlfa;
     enNume  = #390#49;  |HAZ Conver13;  #549#41 = eaAlfa;
     enNume  = #390#50;  |HAZ Conver13;  #549#42 = eaAlfa;
     enNume  = #390#51;  |HAZ Conver13;  #549#43 = eaAlfa;
     enNume  = #390#52;  |HAZ Conver13;  #549#44 = eaAlfa;
     enNume  = #390#5;   |HAZ Conver13;  #549#45 = eaAlfa;
     enNume  = #390#53;  |HAZ Conver13;  #549#46 = eaAlfa;

     |SI #0#6 [ 2002;
         |SI #390#54 = 0.01;
             enNume  = 0;        |HAZ Conver13;  #549#47 = eaAlfa;
         |SINO;
             enNume  = #390#54;  |HAZ Conver13;  #549#47 = eaAlfa;
         |FINSI;
     |SINO;
         enNume  = #390#54;  |HAZ Conver13;  #549#47 = eaAlfa;
     |FINSI;

     enNume  = #390#6;   |HAZ Conver13;  #549#48 = eaAlfa;
     enNume  = #390#55 * 100;            #549#49 = ("0000" + enNume) % -104;
     enNume  = #390#56 * 100;            #549#50 = ("0000" + enNume) % -104;
     enNume  = #390#57 * 100;            #549#51 = ("0000" + enNume) % -104;
     enNume  = #390#58 * 100;            #549#52 = ("0000" + enNume) % -104;
     enNume  = #390#59 * 100;            #549#53 = ("0000" + enNume) % -104;
     enNume  = #390#60;  |HAZ Conver13;  #549#54 = eaAlfa;
     enNume  = #390#61;  |HAZ Conver13;  #549#55 = eaAlfa;

     |SI #0#6 [ 2002;
         |SI #390#62 = 0.01;
             enNume  = 0;        |HAZ Conver13;  #549#56 = eaAlfa;
         |SINO;
             enNume  = #390#62;  |HAZ Conver13;  #549#56 = eaAlfa;
         |FINSI;
     |SINO;
         enNume  = #390#62;  |HAZ Conver13;  #549#56 = eaAlfa;
     |FINSI;

     enNume  = #390#7;   |HAZ Conver13;  #549#57 = eaAlfa;
     enNume  = #390#8;   |HAZ Conver13;  #549#58 = eaAlfa;
     enNume  = #390#9;   |HAZ Conver13;  #549#59 = eaAlfa;
     enNume  = #390#10;  |HAZ Conver13;  #549#60 = eaAlfa;
     enNume  = #390#11;  |HAZ Conver13;  #549#61 = eaAlfa;

     |ABRE #490;
     nGrupo  = 3;  nSubGrupo = 1;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #549#62 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 2;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #549#63 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 3;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #549#64 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 8;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #549#65 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 9;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #549#66 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 10;  |HAZ LeeCasilla;
     enNume  = #490#10;
     nGrupo  = 3;  nSubGrupo = 11;  |HAZ LeeCasilla;
     enNume  = enNume + #490#10;  |HAZ Conver13;  #549#67 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 12;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #549#68 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 13;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #549#69 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 14;  |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #549#70 = eaAlfa;

     enNume  = #390#12;  |HAZ Conver13;  #549#71 = eaAlfa;

     nGrupo  = 4;  nSubGrupo = 2;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #549#72 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 4;  nSubGrupo = 5;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #549#73 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 4;  nSubGrupo = 6;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #549#74 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 4;  nSubGrupo = 7;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #549#75 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 4;  nSubGrupo = 8;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #549#76 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     |CIERRA #490;

     |SI #390#49 ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#5  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#6  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#7  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#8  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#9  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#10 ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#11 ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#12 ! 0;  nSwHay = 1;  |FINSI;

     #549#77 = "</T39003>";
     #549#78 = &13 + &10;

     |SI #0#6 [ 2003;
         |SI nTecla = 1;  |O nTecla = 3;
             |SI nSwHay = 1;
                 aAlfa = "";
                 |PARA nCampo = 1;  |SI nCampo [ 78;  |HACIENDO nCampo = nCampo + 1;
                       aAlfa = #549nCampo;
                       |XGRABA enHandle2, aAlfa;
                 |SIGUE;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Regis390T3A2006;
     |DDEFECTO #549;

     |ABRE #490;

     nSwHay = 0;
     #549#1 = "<T";
     #549#2 = "390";
     #549#3 = "03";
     #549#4 = ">";
     #549#5 = "";

     |PARA nCampo1 = 14;  |SI nCampo1 [ 38;  |HACIENDO nCampo1 = nCampo1 + 6;
           nCampo2 = nCampo1 + 1;
           nCampo3 = nCampo1 + 2;
           nCampo4 = nCampo1 + 3;
           nCampo5 = nCampo1 + 4;
           nCampo6 = nCampo1 + 5;

           |SI #390nCampo1 ! 0;
               nCampo = nCampo1 - 8;  aAlfa   = ("00" + #390nCampo1) % -102; #549nCampo = aAlfa;
               nCampo = nCampo + 1;   enNume  = #390nCampo2;  |HAZ Conver13; #549nCampo = eaAlfa;
               nCampo = nCampo + 1;   enNume  = #390nCampo3 * 1000;          aAlfa  = ("0000" + enNume) % -104;
               #549nCampo = aAlfa;
               nCampo = nCampo + 1;   enNume  = #390nCampo4;  |HAZ Conver13; #549nCampo = eaAlfa;
               nCampo = nCampo + 1;   enNume  = #390nCampo4 - #390nCampo6;   |HAZ Conver13; #549nCampo = eaAlfa;
               nCampo = nCampo + 1;   enNume  = #390nCampo6;  |HAZ Conver13; #549nCampo = eaAlfa;
               nSwHay  = 1;
           |FINSI;
     |SIGUE;

     enNume  = #390#44;  |HAZ Conver13;  #549#36 = eaAlfa;
     enNume  = #390#45;  |HAZ Conver13;  #549#37 = eaAlfa;
     enNume  = #390#46;  |HAZ Conver13;  #549#38 = eaAlfa;
     enNume  = #390#47;  |HAZ Conver13;  #549#39 = eaAlfa;
     enNume  = #390#48;  |HAZ Conver13;  #549#40 = eaAlfa;
     enNume  = #390#49;  |HAZ Conver13;  #549#41 = eaAlfa;
     enNume  = #390#50;  |HAZ Conver13;  #549#42 = eaAlfa;
     enNume  = #390#51;  |HAZ Conver13;  #549#43 = eaAlfa;
     enNume  = #390#52;  |HAZ Conver13;  #549#44 = eaAlfa;
     enNume  = #390#5;   |HAZ Conver13;  #549#45 = eaAlfa;
     enNume  = #390#53;  |HAZ Conver13;  #549#46 = eaAlfa;

     |SI #0#6 [ 2002;
         |SI #390#54 = 0.01;
             enNume  = 0;        |HAZ Conver13;  #549#47 = eaAlfa;
         |SINO;
             enNume  = #390#54;  |HAZ Conver13;  #549#47 = eaAlfa;
         |FINSI;
     |SINO;
         enNume  = #390#54;  |HAZ Conver13;  #549#47 = eaAlfa;
     |FINSI;

     enNume  = #390#6;   |HAZ Conver13;  #549#48 = eaAlfa;
     enNume  = #390#55 * 100;            #549#49 = ("0000" + enNume) % -104;
     enNume  = #390#56 * 100;            #549#50 = ("0000" + enNume) % -104;
     enNume  = #390#57 * 100;            #549#51 = ("0000" + enNume) % -104;
     enNume  = #390#58 * 100;            #549#52 = ("0000" + enNume) % -104;
     enNume  = #390#59 * 100;            #549#53 = ("0000" + enNume) % -104;
     enNume  = #390#60;  |HAZ Conver13;  #549#54 = eaAlfa;
     enNume  = #390#61;  |HAZ Conver13;  #549#55 = eaAlfa;

     |SI #0#6 [ 2002;
         |SI #390#62 = 0.01;
             enNume  = 0;        |HAZ Conver13;  #549#56 = eaAlfa;
         |SINO;
             enNume  = #390#62;  |HAZ Conver13;  #549#56 = eaAlfa;
         |FINSI;
     |SINO;
         enNume  = #390#62;  |HAZ Conver13;  #549#56 = eaAlfa;
     |FINSI;

     enNume  = #390#7;   |HAZ Conver13;  #549#57 = eaAlfa;
     enNume  = #390#8;   |HAZ Conver13;  #549#58 = eaAlfa;
     enNume  = #390#9;   |HAZ Conver13;  #549#59 = eaAlfa;
     enNume  = #390#10;  |HAZ Conver13;  #549#60 = eaAlfa;
     enNume  = #390#11;  |HAZ Conver13;  #549#61 = eaAlfa;

     |ABRE #490;
     nGrupo  = 3;  nSubGrupo = 1;  |HAZ LeeCasilla2;
     enNume  = #490#10;  |HAZ Conver13;  #549#62 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 2;  |HAZ LeeCasilla2;
     enNume  = #490#10;  |HAZ Conver13;  #549#63 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 3;  |HAZ LeeCasilla2;
     enNume  = #490#10;
     nGrupo  = 3;  nSubGrupo = 4;  |HAZ LeeCasilla2;
     enNume  = enNume + #490#10;  |HAZ Conver13;  #549#64 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 5;  |HAZ LeeCasilla2;
     enNume  = #490#10;  |HAZ Conver13;  #549#65 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 6;  |HAZ LeeCasilla2;
     enNume  = #490#10;  |HAZ Conver13;  #549#66 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 7;  |HAZ LeeCasilla2;
     enNume  = #490#10;  |HAZ Conver13;  #549#67 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 8;  |HAZ LeeCasilla2;
     enNume  = #490#10;  |HAZ Conver13;  #549#68 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 9;  |HAZ LeeCasilla2;
     enNume  = #490#10;  |HAZ Conver13;  #549#69 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 10;  |HAZ LeeCasilla2;
     enNume  = #490#10;  |HAZ Conver13;  #549#70 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 11;  |HAZ LeeCasilla2;
     enNume  = #490#10;  |HAZ Conver13;  #549#71 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 12;  |HAZ LeeCasilla2;
     enNume  = #490#10;  |HAZ Conver13;  #549#72 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 13;  |HAZ LeeCasilla2;
     enNume  = #490#10;  |HAZ Conver13;  #549#73 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 14;  |HAZ LeeCasilla2;
     enNume  = #490#10;  |HAZ Conver13;  #549#74 = eaAlfa;

     enNume  = #390#12;  |HAZ Conver13;  #549#75 = eaAlfa;

     nGrupo  = 4;  nSubGrupo = 2;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #549#76 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 4;  nSubGrupo = 6;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #549#79 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 4;  nSubGrupo = 8;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #549#80 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 4;  nSubGrupo = 1;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #549#81 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 4;  nSubGrupo = 3;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #549#82 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 4;  nSubGrupo = 16;   |HAZ LeeCasilla;
     enNume  = #490#10;  |HAZ Conver13;  #549#83 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     |CIERRA #490;

     |SI #390#49 ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#5  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#6  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#7  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#8  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#9  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#10 ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#11 ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#12 ! 0;  nSwHay = 1;  |FINSI;

     #549#77 = "</T39003>";
     #549#78 = &13 + &10;

     |SI #0#6 [ 2003;
         |SI nTecla = 1;  |O nTecla = 3;
             |SI nSwHay = 1;
                 aAlfa = "";
                 |PARA nCampo = 1;  |SI nCampo [ 78;  |HACIENDO nCampo = nCampo + 1;
                       aAlfa = #549nCampo;
                       |XGRABA enHandle2, aAlfa;
                 |SIGUE;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaProrrata;
     |SI #0#6 = 2001;
         eaAlfa = #690#5;      |HAZ QuitaRaros;                    #534nCampo = eaAlfa;
         nCampo = nCampo + 1;  aAlfa = #690#6 % -103;              #534nCampo = aAlfa;
         nCampo = nCampo + 1;  enNume  = #690#7;   |HAZ Conver13;  #534nCampo = eaAlfa;
         nCampo = nCampo + 1;  enNume  = #690#8;   |HAZ Conver13;  #534nCampo = eaAlfa;
         nCampo = nCampo + 1;                                      #534nCampo = #690#9;
         nCampo = nCampo + 1;  aAlfa = ("000" + #690#10) % -103;   #534nCampo = aAlfa;
     |FINSI;

     |SI #0#6 ] 2002;
         eaAlfa = #690#5;      |HAZ QuitaRaros;                    #550nCampo = eaAlfa;
         nCampo = nCampo + 1;  aAlfa = #690#6 %  103;              #550nCampo = aAlfa;   ||LOS tres primeros
         nCampo = nCampo + 1;  enNume  = #690#7;   |HAZ Conver13;  #550nCampo = eaAlfa;
         nCampo = nCampo + 1;  enNume  = #690#8;   |HAZ Conver13;  #550nCampo = eaAlfa;
         nCampo = nCampo + 1;                                      #550nCampo = #690#9;
         nCampo = nCampo + 1;  aAlfa = ("000" + #690#10) % -103;   #550nCampo = aAlfa;
     |FINSI;

     nSwHay = 1;
|FPRC;

|PROCESO Prorratas;
     |SI #0#6 = 2001;
         |SI nModulos = 0;
             nLinea = nLinea + 1;
             |SI nLinea > 9; |ACABA;  |FINSI;

             |SI nLinea = 1;  nCampo = 4;   |FINSI;
             |SI nLinea = 2;  nCampo = 10;  |FINSI;
             |SI nLinea = 3;  nCampo = 16;  |FINSI;
             |SI nLinea = 4;  nCampo = 22;  |FINSI;
             |SI nLinea = 5;  nCampo = 28;  |FINSI;
             |SI nLinea = 6;  nCampo = 34;  |FINSI;
             |SI nLinea = 7;  nCampo = 40;  |FINSI;
             |SI nLinea = 8;  nCampo = 46;  |FINSI;
             |SI nLinea = 9;  nCampo = 52;  |FINSI;

             |HAZ CargaProrrata;
         |SINO;
             nLineaC = nLineaC + 1;

             |SI nLineaC [ nTopeD;             |ACABA;  |FINSI;
             |SI nLineaC > nTopeH;  |ERROR10;  |ACABA;  |FINSI;

             nNume = nLineaC - nTopeD;

             |SI nNume = 1;  nCampo = 4;   |FINSI;
             |SI nNume = 2;  nCampo = 10;  |FINSI;
             |SI nNume = 3;  nCampo = 16;  |FINSI;
             |SI nNume = 4;  nCampo = 22;  |FINSI;
             |SI nNume = 5;  nCampo = 28;  |FINSI;
             |SI nNume = 6;  nCampo = 34;  |FINSI;
             |SI nNume = 7;  nCampo = 40;  |FINSI;
             |SI nNume = 8;  nCampo = 46;  |FINSI;
             |SI nNume = 9;  nCampo = 52;  |FINSI;

             |HAZ CargaProrrata;
         |FINSI;
     |FINSI;

     |SI #0#6 ] 2002;
         |SI nModulos = 0;
             nLinea = nLinea + 1;
             |SI nLinea > 9; |ACABA;  |FINSI;

             |SI nLinea = 1;  nCampo = 6;   |FINSI;
             |SI nLinea = 2;  nCampo = 12;  |FINSI;
             |SI nLinea = 3;  nCampo = 18;  |FINSI;
             |SI nLinea = 4;  nCampo = 24;  |FINSI;
             |SI nLinea = 5;  nCampo = 30;  |FINSI;
             |SI nLinea = 6;  nCampo = 36;  |FINSI;
             |SI nLinea = 7;  nCampo = 42;  |FINSI;
             |SI nLinea = 8;  nCampo = 48;  |FINSI;
             |SI nLinea = 9;  nCampo = 54;  |FINSI;

             |HAZ CargaProrrata;
         |SINO;
             nLineaC = nLineaC + 1;

             |SI nLineaC [ nTopeD;             |ACABA;  |FINSI;
             |SI nLineaC > nTopeH;  |ERROR10;  |ACABA;  |FINSI;

             nNume = nLineaC - nTopeD;

             |SI nNume = 1;  nCampo = 6;   |FINSI;
             |SI nNume = 2;  nCampo = 12;  |FINSI;
             |SI nNume = 3;  nCampo = 18;  |FINSI;
             |SI nNume = 4;  nCampo = 24;  |FINSI;
             |SI nNume = 5;  nCampo = 30;  |FINSI;
             |SI nNume = 6;  nCampo = 36;  |FINSI;
             |SI nNume = 7;  nCampo = 42;  |FINSI;
             |SI nNume = 8;  nCampo = 48;  |FINSI;
             |SI nNume = 9;  nCampo = 54;  |FINSI;

             |HAZ CargaProrrata;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsm39004;
     #690#1;
     ;
     #390#0, #390#1, #390#2, #390#3, 01;
     #390#0, #390#1, #390#2, #390#3, 99;
     ;
     NULL, Prorratas;
|FIN;

|PROCESO Regis390T4A2001;
     |DDEFECTO #534;

     nSwHay = 0;
     #534#1 = "390";
     #534#2 = "04";
     #534#3 = "";

     nModulos = 0;
     nLinea   = 0;
     |BUCLE dsm39004;

     #534#58 = &13 + &10;

     |SI nTecla = 1;  |O nTecla = 3;
         |SI nSwHay = 1;
             aAlfa = "";
             |PARA nCampo = 1;  |SI nCampo [ 58;  |HACIENDO nCampo = nCampo + 1;
                   aAlfa = #534nCampo;
                   |XGRABA enHandle2, aAlfa;
             |SIGUE;

             |SI nLinea > 9;
                 nComple         = 0;
                 nComplementaria = (((nLinea - 9) / 9) + 0.5) ! 0;
                 nTopeD  = 9;
                 nTopeH  = 18;

                 |PARA nComple = 1; |SI nComple [ nComplementaria;  |HACIENDO nComple = nComple + 1;
                       nTopeD = nComple * 9;
                       nTopeH = nTopeD + 9;

                       |DDEFECTO #534;
                       nSwHay   = 0;
                       #534#1   = "390";
                       #534#2   = "04";
                       #534#3   = "C";
                       nModulos = 1;
                       nLinea   = 0;
                       nLineaC  = 0;
                       |BUCLE dsm39004;

                       #534#58 = &13 + &10;

                       |SI nSwHay = 1;
                           aAlfa = "";
                           |PARA nCampo = 1;  |SI nCampo [ 58;  |HACIENDO nCampo = nCampo + 1;
                                 aAlfa = #534nCampo;
                                 |XGRABA enHandle2, aAlfa;
                           |SIGUE;
                       |FINSI;
                 |SIGUE;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Regis390T4A2002;
     |DDEFECTO #550;

     nSwHay = 0;
     #550#1 = "<T";
     #550#2 = "390";
     #550#3 = "04";
     #550#4 = ">";
     #550#5 = "";

     nModulos = 0;
     nLinea   = 0;
     |BUCLE dsm39004;

     #550#60 = "</T39004>";
     #550#61  = &13 + &10;

     |SI #0#6 [ 2003;
         |SI nTecla = 1;  |O nTecla = 3;
             |SI nSwHay = 1;
                 aAlfa = "";
                 |PARA nCampo = 1;  |SI nCampo [ 61;  |HACIENDO nCampo = nCampo + 1;
                       aAlfa = #550nCampo;
                       |XGRABA enHandle2, aAlfa;
                 |SIGUE;

                 |SI nLinea > 9;
                     nComple         = 0;
                     nComplementaria = (((nLinea - 9) / 9) + 0.5) ! 0;
                     nTopeD  = 9;
                     nTopeH  = 18;

                     |PARA nComple = 1; |SI nComple [ nComplementaria;  |HACIENDO nComple = nComple + 1;
                           nTopeD = nComple * 9;
                           nTopeH = nTopeD + 9;

                           |DDEFECTO #550;
                           nSwHay   = 0;
                           #550#1   = "<T";
                           #550#2   = "390";
                           #550#3   = "04";
                           #550#4   = ">";
                           #550#5   = "C";
                           nModulos = 1;
                           nLinea   = 0;
                           nLineaC  = 0;
                           |BUCLE dsm39004;

                           #550#60 = "</T39004>";
                           #550#61 = &13 + &10;

                           |SI nSwHay = 1;
                               aAlfa = "";
                               |PARA nCampo = 1;  |SI nCampo [ 61;  |HACIENDO nCampo = nCampo + 1;
                                     aAlfa = #550nCampo;
                                     |XGRABA enHandle2, aAlfa;
                               |SIGUE;
                           |FINSI;
                     |SIGUE;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO QueHacemos390;
     |ABRE #4;
     #4#0  = #999#0;
     #4#1  = #999#1;
     #4#2  = #999#2;
     #4#3  = #999#5;
     #4#4  = #999#7;
     |LEE 040#4=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #4;

     |SI #0#6 [ 2003;
         |SI nTecla = 1;
             aAbre = eaPathEmision + "390" + (("00000" + #999#0) % -105) + ".TXT";
         |SINO;
             aAbre = eaPathEmision + "INT" + (("00000" + #999#0) % -105) + ".TXT";
         |FINSI;
     |FINSI;

     |SI #0#6 ] 2004;
         |SI aImpre ! "";
             aAbre     = eaPathEmision + "390" + (("00000" + #999#0) % -105) + ".xml";
             aFichXml  = "390" + (("00000" + #999#0) % -105) + ".xml";
             aFichPdf  = "390" + (("00000" + #999#0) % -105) + ".pdf";
             aFichErr  = "err" + (("00000" + #999#0) % -105) + ".xml";
             aFichJus1 = "err" + (("00000" + #999#0) % -105) + ".rst.xml";
             aFichJus2 = "jus" + (("00000" + #999#0) % -105) + ".xml";
         |SINO;
             aFichPdf  = "390" + (("00000" + #999#0) % -105) + ".pdf";
             aAbre     = eaPathEmision + "390" + (("00000" + #999#0) % -105) + ".xml";
         |FINSI;
     |FINSI;

     |XABRE "BW", aAbre, enHandle2;

     |SI #0#6 = 2001;
         |HAZ Regis390T1A2001;
         |HAZ Regis390T2A2001;
         |HAZ Regis390T3A2001;
         |HAZ Regis390T4A2001;
     |FINSI;

     |SI #0#6 = 2002;  |O #0#6 = 2003;
         |HAZ Regis390T1A2002;
         |HAZ Regis390T2A2002;
         |HAZ Regis390T3A2002;
         |HAZ Regis390T4A2002;
     |FINSI;

     |SI #0#6 [ 2003;
         |SI nTecla = 1;  |O nTecla = 3;
             |XCIERRA enHandle2;

             |SI nTecla = 1; |O nImpreLaser = 1;
                 eaFOrigen  = eaPathEmision + "390" + (("00000" + #999#0) % -105) + ".txt";
                 eaFDestino = eaPathLanza   + "390" + (("00000" + #999#0) % -105) + ".txt";
                 |HAZ CopiaFichero;

                 |FBORRA eaFOrigen;

                 aAlfa = "del err" + (("00000" + #999#0) % -105) + ".TXT" + &13 + &10;
                 |XGRABA nHandle1, aAlfa;

                 |SI nTecla = 1;
                     aAlfa = "wait 390pdf " + "/E:390" + (("00000" + #999#0) % -105) + ".TXT";
                 |SINO;
                     aAlfa = "wait 390pdf " + "/E:INT" + (("00000" + #999#0) % -105) + ".TXT";
                 |FINSI;
                 aAlfa = aAlfa + " /R:err" + (("00000" + #999#0) % -105) + ".TXT";
                 aAlfa = aAlfa + " /I: ";
                 aAlfa = aAlfa + " /C:" + aTercera;
                 aAlfa = aAlfa + "/F:FLAG.TXT ";
                 aAlfa = aAlfa + &13 + &10;
                 |XGRABA nHandle1, aAlfa;

                 aAlfa = "move errores.txt err" + (("00000" + #999#0) % -105) + ".TXT" + &13 + &10;
                 aAlfa = aAlfa + &13 + &10;
                 |XGRABA nHandle1, aAlfa;
             |SINO;
                 eaFOrigen  = eaPathEmision   + "INT" + (("00000" + #999#0) % -105) + ".txt";
                 eaFDestino = eaPathInternet  + "INT" + (("00000" + #999#0) % -105) + ".txt";
                 |HAZ CopiaFichero;

                 |FBORRA eaFOrigen;

                 |HAZ GrabaImpreso;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #0#6 ] 2004;
         |HAZ Regis390T1A2002;
         |HAZ Regis390T2A2002;
         |SI #0#6 [ 2005;
              |HAZ Regis390T3A2002;
         |SINO;
              |HAZ Regis390T3A2006;
         |FINSI;
         |HAZ Regis390T4A2002;

         nNueEjer = #0#6;
         |ABRE #199;
         |DDEFECTO #199;
         #199#0 = #0#0;
         #199#1 = #0#6;
         #199#2 = 00;
         |LEE 001#199];
         |SI FSalida ! 0; |O #199#1 ! #0#6;
             aAlfa1 = "    SNo tenemos informacion del Modelo en el Ejercicio Actual. Lanzar segun diseo Anterior?";
             |CONFI aAlfa1;
             |SI FSalida ! 0;
                 |CIERRA #199;
                 |ACABA;
             |FINSI;
             #0#6 = #0#6 - 1;
         |FINSI;
         |CIERRA #199;

         |ABRE #199;
         |HAZ CargaXml;
         |CIERRA #199;
         #0#6 = nNueEjer;

         |XCIERRA enHandle2;

         eaFOrigen  = eaPathEmision   + "390" + (("00000" + #999#0) % -105) + ".xml";
         |SI aImpre ! "";
             eaFDestino = eaPathLanza     + "390" + (("00000" + #999#0) % -105) + ".xml";
         |SINO;
             eaFDestino = eaPathInternet  + "390" + (("00000" + #999#0) % -105) + ".xml";
         |FINSI;
         |HAZ CopiaFichero;

         |FBORRA eaFOrigen;

         |SI nTecla ! 5;
             |SI aImpre ! "";
                 |HAZ EmiteEsto390;
             |SINO;
                 |HAZ BorraPdf390;
                 |HAZ GrabaImpreso;
             |FINSI;
         |SINO;
             |PIEINF;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsmow014C390;
     #999#1;
     6;
     00000, 0000, 00, "S";
     99999, 9999, 99, "S";
     ;
     NULL, QueHacemos390;
|FIN;

|DEFBUCLE dsmow014N390;
     #999#2;
     6;
     "                                        ", "S";
     "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz", "S";
     ;
     NULL, QueHacemos390;
|FIN;

|PROCESO AbreImprime390;
     aAbre = eaPathLanza + "imprime.bat";
     |XABRE "CBW", aAbre, nHandle1;

     aAlfa = "CD " + eaPathLanza + &13 + &10;    |XGRABA nHandle1, aAlfa;

     |SI #0#6 = 2001;
         aAlfa = "ZLS01390.EXE -y" + &13 + &10;      |XGRABA nHandle1, aAlfa;
     |FINSI;

     |SI #0#6 = 2002;
         aAlfa = "ZLS02390.EXE -y" + &13 + &10;      |XGRABA nHandle1, aAlfa;
     |FINSI;

     |SI #0#6 = 2003;
         aAlfa = "ZLS03390.EXE -y" + &13 + &10;      |XGRABA nHandle1, aAlfa;
     |FINSI;
|FPRC;

|PROCESO BotonF2;
     |PTEC 824;
|FPRC;

|PROCESO BotonF3;
     |PTEC 825;
|FPRC;

|PROCESO BotonF4;
     |PTEC 826;
|FPRC;

|PROCESO BotonF5;
     |PTEC 827;
|FPRC;

|PROCESO BotonF6;
     |PTEC 828;
|FPRC;

|PROCESO BotonF7;
     |PTEC 829;
|FPRC;

|PROCESO Boton390Esc;
     |PTEC 806;
|FPRC;

|PROCESO Botones390_2003;
     |BLANCO 0501 2380;

     |CONTROL_SIMPLE 0, "LBOTON, <F2> Emision Papel Oficial Laser ", 0513, 0754, BotonF2;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F3> Presentacion Telematica ", 0913, 1154, BotonF3;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,ESC Cancelar", 2365, 2378, Boton390Esc;
     nBoton3 = FSalida;

     aF2 = &255 + "824";
     aF3 = &255 + "825";
     aF6 = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF2;  nTecla = 1;  |SAL;  |FINSI;
         |SI aTecla = aF3;  nTecla = 3;  |SAL;  |FINSI;
         |SI aTecla = aF6;  nTecla = 0;  |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;

     |PULSATECLA;
|FPRC;

|PROCESO Botones390_2004;
     |BLANCO 0501 2380;

     |CONTROL_SIMPLE 0, "LBOTON, <F2> Emision Papel Oficial Laser (Directo por Impresora) ", 0513, 0654, BotonF2;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F3> Emision Papel Oficial Laser (Vista previa por el Acrobat)", 0813, 0954, BotonF3;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F4> Presentacion Telematica (Comprobacion Previa del Fichero)", 1113, 1254, BotonF4;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F5> Presentacion Telematica (Sin Comprobacion)", 1413, 1554, BotonF5;
     nBoton4 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F6> Informe de Comprobacion", 1713, 1854, BotonF6;
     nBoton5 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F7> Directorio Acrobat", 2013, 2154, BotonF7;
     nBoton6 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,ESC Cancelar", 2365, 2378, Boton390Esc;
     nBoton7 = FSalida;

     aF2 = &255 + "824";
     aF3 = &255 + "825";
     aF4 = &255 + "826";
     aF5 = &255 + "827";
     aF6 = &255 + "828";
     aF7 = &255 + "829";
     aF8 = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF2;  nTecla = 1; aImpre = "I";  |SAL;  |FINSI;
         |SI aTecla = aF3;  nTecla = 1; aImpre = "P";  |SAL;  |FINSI;
         |SI aTecla = aF4;  nTecla = 3; aImpre = "C";  |SAL;  |FINSI;
         |SI aTecla = aF5;  nTecla = 3; aImpre = "";   |SAL;  |FINSI;
         |SI aTecla = aF6;  nTecla = 5; aImpre = "";   |SAL;  |FINSI;
         |SI aTecla = aF7;  |HAZ Acrobat;                     |FINSI;
         |SI aTecla = aF8;  nTecla = 0;                |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton5;
     |FIN_CONTROL_WINDOWS nBoton6;
     |FIN_CONTROL_WINDOWS nBoton7;

     |PULSATECLA;

     enError = 0;
     |SI #0#6 ] 2004;  |Y aImpre ! "";
         |SI #0#7 < "01.01.2005";  #0#7 = "01.01.2005";  |FINSI;

         |PUSHV 0501 2380;
         |BLANCO 0501 2380;
         |CUADRO 0501 2380;
         |CUADRO 0719 0965;
         |ATRI R;
         |PINTA 0820, "COPIANDO PROGRAMAS NECESARIOS PARA LA EMISION";
         |ATRI r;

         |DBASS aModelos;  |QBT aModelos;
         aModelos = aModelos + "basica/";

         aAlfa      = #0#6;
         aAlfa      = aAlfa % -102;
         eaFOrigen  = aModelos + "patrones/zls" + aAlfa + "390.tgz";
         eaFDestino = eaPathLanza + "zls" + aAlfa + "390.tgz";
         |HAZ CopiaFicheroXml;

         |HAZ BuscaJava;
         |SI enError = 1;  |POPV;  |ACABA;  |FINSI;
         |POPV;
     |FINSI;
|FPRC;

|PROGRAMA;
     enEmpresa     = 0;
     enEjer        = 2008;
     enModelo      = 390;
     enComplem     = 0;
     enTipoEntrada = 99;
     |SUB_EJECUTA_NP "dsm39001";

     aFichero = ("000" + Usuario) % 108;
     |NOME_DAT #0 aFichero;

     aFichero = ("imp" + Usuario) % 108;
     |NOME_DAT #999 aFichero;

     |ABRE #107;
     |LEE 040#107p;
     |SI FSalida ! 0;
         |CIERRA #107;
         |SUB_EJECUTA_NP "dsmom107";
         |ABRE #107;
     |FINSI;

     |LEE 040#107p;
     |SI FSalida ! 0;  |DDEFECTO #107;  |FINSI;
     |CIERRA #107;

     |ABRE #0;
     |LEE 000#0p;
     |CIERRA #0;

     enSwTrata      = 0;
     enCambiaMoneda = 1;

     |SI eaParametro ! "390C";
         |SI #0#6 [ 2003;
             |HAZ Botones390_2003;
         |SINO;
             |HAZ Botones390_2004;
             |SI enError = 1;  |ACABA;  |FINSI;
         |FINSI;
     |SINO;
         nTecla = 5;
     |FINSI;

     |SI nTecla  = 0;  |ACABA;  |FINSI;

     |SI nTecla = 1;
         |SI #107#6 = "S";
             aTercera = "N";
             aAlfa    = "0000" + #107#5 + "Desea la impresion de la tercera copia  ";
             |CONFI aAlfa;
             |SI FSalida = 0;  aTercera = "S";  |FINSI;
         |SINO;
             aTercera = #107#5;
         |FINSI;

         |SI #0#6 [ 2003;
             |HAZ AbreImprime390;
         |FINSI;
     |FINSI;

     |SI nTecla = 3;
         aTercera   = "N";

         |SI #0#6 [ 2003;
             |CONFI "0000S Desea imprimir el Modelo antes en Laser para su comprobacion";
             nImpreLaser = 0;
             |SI FSalida = 0;
                 nImpreLaser = 1;
                 |HAZ AbreImprime390;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nTecla = 5;
         |IMPRE 0;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |INFOR "dsmoy390";
         |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;
     |FINSI;

     nSwLee  = 0;
     enTecla = nTecla;

     |SI #0#8 = "C";
         |BUCLE dsmow014C390;
     |SINO;
         |BUCLE dsmow014N390;
     |FINSI;

     |SI #0#6 [ 2003;
         |SI nTecla = 1;  |O nImpreLaser = 1;
             |HAZ EmiteEsto390;
         |FINSI;
     |FINSI;

     |SI #0#6 ] 2004;
         |SI aImpre ! "";
             aAlfa = #0#6;
             aAlfa = aAlfa % -106;
             aAlfa = eaPathLanza + "miiva" + aAlfa + ".log";
             |RFBORRA aAlfa;

             eaFichError = "err";
             eaFichDatos = #0#0;
             eaFichAuxil = "";
             eaExtension = "xml";
             |HAZ BuscaErroresL;
         |FINSI;
     |FINSI;

     |SI nTecla = 3;
         aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
         |MENAV aAlfa;
     |FINSI;

     |SI nTecla = 5;
         |FININF;
         |FINIMP;
     |FINSI;

     |PULSATECLA;
|FPRO;
