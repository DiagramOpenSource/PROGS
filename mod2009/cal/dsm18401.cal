|FICHEROS;
   dsm18401 #1;   || DEF general del modelo

   dsm18402 #10,MANTE;  || Datos generales
   dsm18403 #11,MANTE;  || Rdtos Capital mobiliario
   dsm18404 #12,MANTE;  || Ident.cesionario capitales propios
   dsm18405 #13,MANTE;  || Rdtos Capital inmobiliario
   dsm18406 #14,MANTE;  || Rdtos actividades economicas
   dsm18407 #15,MANTE;  || Rentas participacion Inst.Inv.Colect.
   dsm18408 #16,MANTE;  || Ganancias y perdidas <= 1 a밢
   dsm18409 #17,MANTE;  || Ganancias y perdidas > 1 a밢
   dsm18410 #18,MANTE;  || Ent.Renta atrib.segun Imp.Soc.
   dsm18411 #19,MANTE;  || Deducciones ley 40/98
   dsm18412 #20,MANTE;  || Deducciones ley 43/95
   dsm18413 #21,MANTE;  || Retenc.e ing.a cta soportados por la entidad
   dsm18414 #22,MANTE;  || Excesos rentas negativas
   dsm18430 #30,MANTE;  || Relacion de socios
   dsm18431 #31,MANTE;

   dsmom004 #4;
   dsmom001 #102;
   dsmom107 #107;
   dsmoc130 #130;
   dsmoc131 #131;
   dsmom018 #118;
   dsmom014 #1114;
   dsmom022 #1122;

   :/basica/def/agifigen #100;
   :/basica/def/agim0024 #124;
   :/basica/def/agicen14 #114;
   :/integral/def/dsam0000 #101;

   :/contagen/def/cacuenta #800;
   :/contagen/def/camaasil #801;
   :/contagen/def/caexistl #802;

   dsm18401@ #500;
   dsmoc130@ #1300;
|FIN;

|VARIABLES;
    nModo         = 0;
    nLin          = 0;
    nComp         = 0;
    nEmpresa      = 0;
    nSwBorra      = 0;
    nBoton1       = 0;
    nCanal        = 0;
    nSocio        = 0;
    nDias         = 0;
    nCampo        = 0;
    nRecoge       = 0;
    nIngreso130   = 0;
    nGastos130    = 0;
    nRdtos130     = 0;
    nRetencion130 = 0;
    nRdtos131     = 0;
    nVentas131    = 0;
    nRetencion131 = 0;
    nPer130       = 0;
    nPer131       = 0;
    nTipoAct      = 0;
    nDActiv       = 0;
    nHActiv       = 0;
    nPorce        = 0;
    nTotSocios    = 0;
    swerror       = 0;
    nSwRetencion  = 0;
    nDepar        = 0;
    nNume1        = 0;
    nNume3        = 0;
    nSumaCtas     = 0;
    nCtExisten    = 0;
    nCc1          = 0;
    nCc2          = 0;
    nExini        = 0;
    nExfin        = 0;
    nExisInicio   = 0;
    nExisFinal    = 0;
    nEl8          = 0;
    nEl11         = 0;
    nEl47         = 0;
    nEl14         = 0;
    nEl21         = 0;
    nEl31         = 0;
    nHay          = 0;

    aUno          = "";
    aDos          = "";
    aTipCta       = "";
    aAlfa1        = "";
    aAlfa2        = "";
    aAlfa3        = "";
    aRepre        = "";
    aBase         = "";
    aMas          = "";
    aComunidad    = "";
    aFichero      = "";

    fDFecha  = @;
    fHFecha  = @;
    fFechaIni = @;
    fFechaFin = @;

{-1}aMenuGen = "";
    aMenuGen1  = " 1) Datos generales                                                    ";
    aMenuGen2  = " A) Rendimientos del capital mobiliario                                ";
    aMenuGen3  = " B) Identificacion persona/entidad cesionaria de los capitales propios ";
    aMenuGen4  = " C) Rendimientos del capital inmobiliario                              ";
    aMenuGen5  = " D) Rendimientos de actividades economicas                             ";
    aMenuGen6  = " E) Rentas contab.derivadas de participar en Inst.inversion colectiva  ";
    aMenuGen7  = " F) Ganancias y perdidas patrimoniales con periodo generacion <= 1 a밢 ";
    aMenuGen8  = " G) Ganancias y perdidas patrimoniales con periodo generacion > 1 a밢  ";
    aMenuGen9  = " H) Entidades que determinan renta atribuible segun el Imp.Sociedades  ";
    aMenuGen10 = " I) Deducciones Ley 40/1998                                            ";
    aMenuGen11 = " J) Deducciones Ley 43/1995                                            ";
    aMenuGen12 = " K) Retenciones e ingresos a cuenta soportados por la entidad          ";
    aMenuGen13 = " L) Exceso de rentas negativos                                         ";
    aMenuGen14 = " Z) Recoger Datos Ejercicio Anterior (Menos Actividades Economicas)    ";

{1000}aPais = "";
{1000}nIngr = 0;
{1000}nGast = 0;

    nAnyo    = 0;
    nOpcion  = 0;
    nOpcs    = 0;
    nCont    = 0;
    nPosic   = 0;
    nCalc    = 0;
    nCalc1   = 0;
    nLinea   = 0;
    nLinea30 = 0;
    nPorc    = 0;

    aTecla    = "";
    aAlfa     = "";
    aDescPais = "";

    &eaTabla   = "";
    &eaAlfa    = "";
    &eaDestino = "";
    &enComp    = 0;

    nSwOp = 0;
    nSw   = 0;
    aDNif = "";
    aHNif = "";
|FIN;

|INCLUYE i_variar;

|PROCESO camaasil;
     |SI nSwRetencion = 1;  |Y #801#0 = 0;
         |ACABA;
     |FINSI;

     nDepar = #801#21;
     |SI nDepar = 0;  nDepar = 1;   |FINSI;
     |SI nDepar ! #130#5;
         |ACABA;
     |FINSI;

     nNume3 = 1;
     |SI #1114#2 = "I";
         |SI #801#8 = "D"; nNume3 = -1; |FINSI;
     |SINO;
         |SI #801#8 = "H"; nNume3 = -1; |FINSI;
     |FINSI;

     |SI nSwRetencion = 1;
         nNume3 = 1; |SI #801#8 = "H"; #801#9 = 0; |FINSI;
     |FINSI;

     nNume1 = ((#801#9 * nNume3) / enConversor) ! EURODBMOD;
     nSumaCtas = nSumaCtas + nNume1;
|FPRC;

|DEFBUCLE camaasil;
     #801#3;
     ;
     aUno, fFechaIni, 000001, 0001;
     aDos, fFechaFin, 999999, 9999;
     ;
     NULL, camaasil;
|FIN;

|PROCESO caexistl;
     aUno     = #802#2;      ||Planilla Cuentas
     aUno     = aUno % 104;
     #1114#10 = enPlan;
     #1114#0  = aUno;
     |LEE 000#1114=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;  || Si no existe en la Planilla, sale

     nExisInicio = (#802nCc1 / enConversor) ! EURODBMOD;
     nExisFinal  = (#802nCc2 / enConversor) ! EURODBMOD;

     nExini      = nExini + nExisInicio;
     nExfin      = nExfin + nExisFinal;
     nCtExisten  = nExini - nExfin;
|FPRC;

|DEFBUCLE caexistl;
     #802#1;
     ;
     #130#5, 01;
     #130#5, 99;
     ;
     NULL, caexistl;
|FIN;

|PROCESO dsmom014;
     |SI nSwRetencion = 1;
         nSumaCtas = 0;
         aUno = #1122#0;
         aDos = #1122#0;
         |BUCLE camaasil;
         |SI #1122#3 = "-";
             #1300#31 = #1300#31 - nSumaCtas;
         |SINO;
             #1300#31 = #1300#31 + nSumaCtas;
         |FINSI;
     |SINO;
         nSumaCtas = 0;
         aUno = #1114#0; |QBF aUno;
         aDos = aUno + "999999999999"; aDos = aDos % A112;
         aUno = aUno + "            "; aUno = aUno % A112;
         |BUCLE camaasil;
         |SI aTipCta = "I";
             |SI #1114#3 = "-";
                 #1300#8 = #1300#8 - nSumaCtas;
             |SINO;
                 #1300#8 = #1300#8 + nSumaCtas;
             |FINSI;
         |FINSI;

         |SI aTipCta = "C";
             |SI #1114#3 = "-";
                 #1300#11 = #1300#11 - nSumaCtas;
             |SINO;
                 #1300#11 = #1300#11 + nSumaCtas;
             |FINSI;
         |FINSI;

         |SI aTipCta = "G";
             |SI #1114#3 = "-";
                 #1300#14 = #1300#14 - nSumaCtas;
             |SINO;
                 #1300#14 = #1300#14 + nSumaCtas;
             |FINSI;
        |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsmom014;
     #1114#1;
     2;
     enPlan, "    ", aTipCta;
     enPlan, "zzzz", aTipCta;
     ;
     NULL, dsmom014;
|FIN;

|DEFBUCLE dsmom022;
     #1122#1;
     ;
     "            ";
     "zzzzzzzzzzzz";
     ;
     NULL, dsmom014;
|FIN;

|PROCESO dsmom001A;
     |SI #102#8 ! "01.01.0000";
         |SI #102#8 > fHFecha; |ACABA;  |FINSI;
     |FINSI;

     |SI #102#9 ! "01.01.0000";
         |SI #102#9 < fDFecha;  |ACABA;  |FINSI;
     |FINSI;

     nDias = (fHFecha - fDFecha) + 1;
     |SI #102#9 < fHFecha;  |Y #102#9 > "01.01.0000";
         nDias = #102#9 - fDFecha;
     |FINSI;

     #100#0 = #102#3;
     |LEE 000#100=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     #1300#0 = #102#3;
     #1300#1 = #130#1;
     #1300#2 = #130#2;
     #1300#3 = #130#3;
     #1300#4 = #130#4;
     #1300#5 = #102#4;
     |LEE 101#1300=;
     |SI FSalida ! 0;
         |DDEFECTO #1300;
         #1300#0 = #102#3;
         #1300#1 = #130#1;
         #1300#2 = #130#2;
         #1300#3 = #130#3;
         #1300#4 = #130#4;
         #1300#5 = #102#4;
         |GRABA 020#1300b;
     |FINSI;

     #1300#8  = nEl8  % #102#7;
     #1300#11 = nEl11 % #102#7;
     #1300#47 = nEl47 % #102#7;
     #1300#14 = nEl14 % #102#7;
     #1300#21 = nEl21 % #102#7;
     #1300#31 = nEl31 % #102#7;
     |GRABA 020#1300a;
     |LIBERA #1300;
|FPRC;

|DEFBUCLE dsmom001A;
     #102#1;
     ;
     #130#0, #130#5, 0001;
     #130#0, #130#5, 9999;
     ;
     NULL, dsmom001A;
|FIN;

|PROCESO dsmoc130A;
     nHay = 1;

     #4#0 = #130#0;
     #4#1 = #130#1;
     #4#2 = #130#2;
     #4#3 = #130#3;
     #4#4 = #130#4 + 1;
     |LEE 000#4=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     #1300#0 = #130#0;
     #1300#1 = #130#1;
     #1300#2 = #130#2;
     #1300#3 = #130#3;
     #1300#4 = #130#4;
     #1300#5 = #130#5;
     |LEE 101#1300=;
     |SI FSalida ! 0;
         |DDEFECTO #1300;
         #1300#0  = #130#0;
         #1300#1  = #130#1;
         #1300#2  = #130#2;
         #1300#3  = #130#3;
         #1300#4  = #130#4;
         #1300#5  = #130#5;
         #1300#18 = #130#18;

         |GRABA 020#1300b;
     |FINSI;

     |ABRE #1114;
     nCtExisten = 0;
     |BUCLE caexistl;
     #1300#47 = nCtExisten;
     |CIERRA #1114;

     aTipCta = "I";   |BUCLE dsmom014;
     aTipCta = "C";   |BUCLE dsmom014;
     aTipCta = "G";   |BUCLE dsmom014;

     nSwRetencion = 1;
     |BUCLE dsmom022;
     nSwRetencion = 0;

     |SI #1300#21 ! 0;
         #1300#17 = #1300#8  - (#1300#11 + #1300#47) - #1300#14;
         #1300#21 = #1300#17 % #1300#18;

         |SI #1300#21 < 0;  #1300#21 = 0;  |FINSI;

         |SI #1300#8 = 0;  |Y #1300#11 = 0;  |Y #1300#47 = 0;
              #1300#21 = #1300#14 % #1300#18;
         |FINSI;
     |FINSI;

     |GRABA 020#1300a;
     |LIBERA #1300;

     nEl8  = #1300#8;
     nEl11 = #1300#11;
     nEl47 = #1300#47;
     nEl14 = #1300#14;
     nEl21 = #1300#21;
     nEl31 = #1300#31;
     |BUCLE dsmom001A;
|FPRC;

|DEFBUCLE dsmoc130A;
     #130#1;
     ;
     #1#0, #1#1, nPer130, 130, 01, #114#1;
     #1#0, #1#1, nPer130, 130, 99, #114#1;
     ;
     NULL, dsmoc130A;
|FIN;

|PROCESO agicen14;
     |SI #114#5 > "01.01.0000";
         |SI #114#5 > fFechaFin;  |ACABA;  |FINSI;
     |FINSI;

     |SI #114#6 > "01.01.0000";
         |SI #114#6 < fFechaIni;  |ACABA; |FINSI; || Baja
     |FINSI;

     nHay = 0;
     |BUCLE dsmoc130A;

     |SI nHay = 0;
         #130#0  = #1#0;
         #130#1  = #1#1;
         #130#2  = 12;
         #130#3  = 130;
         #130#4  = 0;
         #130#5  = #114#1;
         #130#45 = #114#9;

         |SI #130#45 = 3;  |O #130#45 = 8;  |O #130#45 = 13;
             #130#18 = 0;
             #130#19 = 0;
             #130#20 = 0;
             #130#21 = 0;
         |SINO;
             |SI #130#18 = 0;  #130#18 = 5;  |FINSI;
         |FINSI;

         |HAZ dsmoc130A;
     |FINSI;
|FPRC;

|DEFBUCLE agicen14;
     #114#1;
     ;
     #1#0, 01;
     #1#0, 99;
     ;
     NULL, agicen14;
|FIN;

|PROCESO ModelosFicticios;
     swerror      =  0;
     enPerConta = -1;      || No sabemos el Periodo Contable
     |HAZ SituaContagen;
     |SI swerror = 1;
         |MENAV "    Error. No existen Datos Contables de esta Empresa ";
         |ACABA;
     |FINSI;

     |HAZ EnConversor;

     aAlfa1    = #1#1;
     aAlfa2    = "01.01." + #1#1;
     aAlfa3    = "31.12." + #1#1;
     fFechaIni = aAlfa2;
     fFechaFin = aAlfa3;

     |PATH_DAT #800 aPathConta;
     |PATH_DAT #801 aPathConta;
     |PATH_DAT #802 aPathConta;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/dsmoc130.mas";
     |CARGA_DEF aMas, dsmoc130@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aFichero = ("C0" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #1300 aFichero;
     |ABRE #1300;  |CIERRA #1300;  |DELINDEX #1300;

     |ABRE #1300;
     |BUCLE agicen14;
     |CIERRA #1300;

     |DESCARGA_DEF #dsmoc130@;
|FPRC;

|PROCESO DestruyeFicheros;
      |SI #1#57 ! "C";  |ACABA;  |FINSI;

      |ABRE #130;  |CIERRA #130;  |DELINDEX #130;
|FPRC;

||--------------------------------------------------------------------------
|PROCESO Tipo12;  |TIPO 12;
|FPRC;

|PROCESO Menu;
   |BLANCO 0901 2480;
   |CUADRO 0901 2480;
   nOpcion = 1; nPosic = 1005; nOpcs = 14;

|ET OtraVez;
   |PARA nCont = 1; |SI nCont [ nOpcs; |HACIENDO nCont = nCont + 1;
      IaMenuGen = aMenuGen1<-; IaMenuGen = IaMenuGen + (nCont - 1);
      nCalc = ((nPosic / 100) ! 0);
      nCalc = nCalc + (nCont - 1);
      nCalc1 = nPosic - (((nPosic / 100) ! 0) * 100);
      nCalc = (nCalc * 100) + nCalc1;
      |SI nCont = nOpcion; |ATRI R; |SINO; |ATRI N; |FINSI;
      |PINTA nCalc, aMenuGen;
   |SIGUE;
   |LEETECLA aTecla; aTecla = aTecla % -103;

   |SI aTecla = "809"; nOpcion = nOpcion + 1; |FINSI;
   |SI aTecla = "808"; nOpcion = nOpcion - 1; |FINSI;

   |SI nOpcion > nOpcs; nOpcion = 1;     |FINSI;
   |SI nOpcion < 1;     nOpcion = nOpcs; |FINSI;

   |SI aTecla ! "806"; |Y aTecla ! "802"; |Y aTecla ! "807";
      |VETE OtraVez;
   |SINO;
      |SI aTecla = "802";
         |PULSATECLA;
         |SI nOpcion = 1;  |HAZ DatosGen; |FINSI;
         |SI nOpcion = 2;  |HAZ RdCapMob; |FINSI;
         |SI nOpcion = 3;  |HAZ IdCesCap; |FINSI;
         |SI nOpcion = 4;  |HAZ RdCapInm; |FINSI;
         |SI nOpcion = 5;  |HAZ RdActEco; |FINSI;
         |SI nOpcion = 6;  |HAZ RtasIIC;  |FINSI;
         |SI nOpcion = 7;  |HAZ GyPmenor; |FINSI;
         |SI nOpcion = 8;  |HAZ GyPmayor; |FINSI;
         |SI nOpcion = 9;  |HAZ RtaAtISo; |FINSI;
         |SI nOpcion = 10; |HAZ Ded4098;  |FINSI;
         |SI nOpcion = 11; |HAZ Ded4395;  |FINSI;
         |SI nOpcion = 12; |HAZ RetIngCt; |FINSI;
         |SI nOpcion = 13; |HAZ Excesos;  |FINSI;
         |SI nOpcion = 14; |HAZ Copia;    |FINSI;
         |VETE OtraVez;
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO RevExcesoA;
   |SI #11#12 = "N"; |Y #11#7 > #11#6;
      |DDEFECTO #22;
      #22#0 = #1#0;
      #22#1 = #1#1;
      #22#2 = #1#3;
      #22#3 = nLinea; nLinea = nLinea + 1;
      #22#4 = "A";
      #22#5 = #11#5;
      #22#6 = #11#7 - #11#6;
      #22#7 = #11#11;
      |GRABA 020#22n;

      #11#8 = 0; |GRABA 020#11a;
   |FINSI;
|FPRC;

|DEFBUCLE RevExcesoA;
#11#1;
;
#1#0, #1#1, #1#3, 001;
#1#0, #1#1, #1#3, 999;
be;
NULL,RevExcesoA;
|FIN;

|PROCESO RevExcesoC;
   |SI #13#12 = "N"; |Y #13#7 > #13#6;
      |DDEFECTO #22;
      #22#0 = #1#0;
      #22#1 = #1#1;
      #22#2 = #1#3;
      #22#3 = nLinea; nLinea = nLinea + 1;
      #22#4 = "C";
      #22#5 = #13#5;
      #22#6 = #13#7 - #13#6;
      #22#7 = #13#11;
      |GRABA 020#22n;

      #13#8 = 0;
      |GRABA 020#13a;
   |FINSI;
|FPRC;

|DEFBUCLE RevExcesoC;
#13#1;
;
#1#0, #1#1, #1#3, 001;
#1#0, #1#1, #1#3, 999;
be;
NULL,RevExcesoC;
|FIN;

|PROCESO RevExcesoD;
   |SI #31#10 = "N"; |Y #31#7 > #31#6;
      |DDEFECTO #22;
      #22#0 = #1#0;
      #22#1 = #1#1;
      #22#2 = #1#3;
      #22#3 = nLinea; nLinea = nLinea + 1;
      #22#4 = "D";
      #22#5 = #31#4;
      #22#6 = #31#7 - #31#6;
      #22#7 = #31#5;
      |GRABA 020#22n;

      #31#8 = 0; |GRABA 020#31a;
   |FINSI;
|FPRC;

|DEFBUCLE RevExcesoD;
#31#1;
;
#1#0, #1#1, #1#3, 001, "  ";
#1#0, #1#1, #1#3, 999, "zz";
be;
NULL,RevExcesoD;
|FIN;

|PROCESO RevExcesoE;
   |PARA nCont = 0; |SI nCont [ 999; |HACIENDO nCont = nCont + 1;
      IaPais = aPais1<-; IaPais = IaPais + nCont;
      |SI aPais = ""; |SAL; |FINSI;
      |SI aPais = #15#10;
         |SI #15#8 > #15#7;
            |DDEFECTO #22;
            #22#0 = #1#0;
            #22#1 = #1#1;
            #22#2 = #1#3;
            #22#3 = nLinea; nLinea = nLinea + 1;
            #22#4 = "E";
            #22#5 = #15#10;
            #22#6 = #15#8 - #15#7;
            #22#7 = #15#11;
            |GRABA 020#22n;
         |FINSI;
      |FINSI;
   |SIGUE;
|FPRC;

|DEFBUCLE RevExcesoE;
#15#1;
;
#1#0, #1#1, #1#3, 001;
#1#0, #1#1, #1#3, 999;
;
NULL,RevExcesoE;
|FIN;

|PROCESO ExcesoE;
   |PARA nCont = 0; |SI nCont [ 999; |HACIENDO nCont = nCont + 1;
      IaPais = aPais1<-; IaPais = IaPais + nCont; aPais = "";
      InIngr = nIngr1<-; InIngr = InIngr + nCont; nIngr = 0;
      InGast = nGast1<-; InGast = InGast + nCont; nGast = 0;
   |SIGUE;
   |BUCLE RevExcesoE;
|FPRC;

|PROCESO RevExcesoF;
   |PARA nCont = 0; |SI nCont [ 999; |HACIENDO nCont = nCont + 1;
      IaPais = aPais1<-; IaPais = IaPais + nCont;
      |SI aPais = ""; |SAL; |FINSI;
      |SI aPais = #16#4;
         |SI #16#5 = "G";
            InGast = nGast1<-; InGast = InGast + nCont;
            |SI nGast > #16#6;
               |DDEFECTO #22;
               #22#0 = #1#0;
               #22#1 = #1#1;
               #22#2 = #1#3;
               #22#3 = nLinea; nLinea = nLinea + 1;
               #22#4 = "F";
               #22#5 = aPais;
               #22#6 = nGast - #16#6;
               #22#7 = aDescPais;
               |GRABA 020#22n;
            |FINSI;
         |SINO;
            InIngr = nIngr1<-; InIngr = InIngr + nCont;
            |SI nIngr < #16#6;
               |DDEFECTO #22;
               #22#0 = #1#0;
               #22#1 = #1#1;
               #22#2 = #1#3;
               #22#3 = nLinea; nLinea = nLinea + 1;
               #22#4 = "F";
               #22#5 = aPais;
               #22#6 = #16#6 - nIngr;
               #22#7 = aDescPais;
               |GRABA 020#22n;
            |FINSI;
         |FINSI;
      |FINSI;
   |SIGUE;

   |SI aPais = "";
      aPais = #16#4; aDescPais = #16#8;
      |SI #16#5 = "G";
         InIngr = nIngr1<-; InIngr = InIngr + nCont; nIngr = #16#6;
      |SINO;
         InGast = nGast1<-; InGast = InGast + nCont; nGast = #16#6;
      |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE RevExcesoF;
#16#1;
7;
#1#0, #1#1, #1#3, 001, "N";
#1#0, #1#1, #1#3, 999, "N";
;
NULL,RevExcesoF;
|FIN;

|PROCESO ExcesoF;
   |PARA nCont = 0; |SI nCont [ 999; |HACIENDO nCont = nCont + 1;
      IaPais = aPais1<-; IaPais = IaPais + nCont; aPais = "";
      InIngr = nIngr1<-; InIngr = InIngr + nCont; nIngr = 0;
      InGast = nGast1<-; InGast = InGast + nCont; nGast = 0;
   |SIGUE;
   |BUCLE RevExcesoF;
|FPRC;

|PROCESO RevExcesoG;
   |PARA nCont = 0; |SI nCont [ 999; |HACIENDO nCont = nCont + 1;
      IaPais = aPais1<-; IaPais = IaPais + nCont;
      |SI aPais = ""; |SAL; |FINSI;
      |SI aPais = #17#5;
         |SI #17#6 = "G";
            InGast = nGast1<-; InGast = InGast + nCont;
            |SI nGast > #17#7;
               |DDEFECTO #22;
               #22#0 = #1#0;
               #22#1 = #1#1;
               #22#2 = #1#3;
               #22#3 = nLinea; nLinea = nLinea + 1;
               #22#4 = "G";
               #22#5 = aPais;
               #22#6 = nGast - #17#7;
               #22#7 = aDescPais;
               |GRABA 020#22n;
            |FINSI;
         |SINO;
            InIngr = nIngr1<-; InIngr = InIngr + nCont;
            |SI nIngr < #17#7;
               |DDEFECTO #22;
               #22#0 = #1#0;
               #22#1 = #1#1;
               #22#2 = #1#3;
               #22#3 = nLinea; nLinea = nLinea + 1;
               #22#4 = "G";
               #22#5 = aPais;
               #22#6 = #17#7 - nIngr;
               #22#7 = aDescPais;
               |GRABA 020#22n;
            |FINSI;
         |FINSI;
      |FINSI;
   |SIGUE;

   |SI aPais = "";
      aPais = #17#5; aDescPais = #17#10;
      |SI #17#6 = "G";
         InIngr = nIngr1<-; InIngr = InIngr + nCont; nIngr = #17#7;
      |SINO;
         InGast = nGast1<-; InGast = InGast + nCont; nGast = #17#7;
      |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE RevExcesoG;
#17#1;
8;
#1#0, #1#1, #1#3, 001, "N";
#1#0, #1#1, #1#3, 999, "N";
;
NULL,RevExcesoG;
|FIN;

|PROCESO ExcesoG;
   |PARA nCont = 0; |SI nCont [ 999; |HACIENDO nCont = nCont + 1;
      IaPais = aPais1<-; IaPais = IaPais + nCont; aPais = "";
      InIngr = nIngr1<-; InIngr = InIngr + nCont; nIngr = 0;
      InGast = nGast1<-; InGast = InGast + nCont; nGast = 0;
   |SIGUE;
   |BUCLE RevExcesoG;
|FPRC;

|PROCESO CalcExcesos;
   |ABRE #22;
   #22#0 = #1#0;
   #22#1 = #1#1;
   #22#2 = #1#3;
   #22#3 = 1;
   |LEE 000#22];
   |PARA; |SI FSalida = 0; |Y #22#0 = #1#0; |Y #22#1 = #1#1;
           |Y #22#2 = #1#3; |HACIENDO;
      |BORRA 020#22a; |LEE 000#22s;
   |SIGUE;

   nLinea = 1;

   |BUCLE RevExcesoA;
   |BUCLE RevExcesoC;
   |BUCLE RevExcesoD;
   |HAZ   ExcesoF;
   |HAZ   ExcesoG;
   |CIERRA #22;
|FPRC;

|PROCESO RetIngCt;
   |PARA nCont = 50; |SI nCont [ 54; |HACIENDO nCont = nCont + 1;
      nCalc = nCont - 50;
      #21nCalc = #1nCont;
   |SIGUE;
   |PUSHV 0501 2380;
   |PINPA #0#21; |PINDA #0#21;
   |ENDATOS #1#21;
   |SI FSalida = 0;
      |PARA nCont = 50; |SI nCont [ 54; |HACIENDO nCont = nCont + 1;
         nCalc = nCont - 50;
         #1nCont = #21nCalc;
      |SIGUE;
      |GRABA 020#1a;
   |FINSI;
   |POPV;
|FPRC;

|PROCESO Ded4395;
   |PARA nCont = 44; |SI nCont [ 49; |HACIENDO nCont = nCont + 1;
      nCalc = nCont - 44;
      #20nCalc = #1nCont;
   |SIGUE;
   |PUSHV 0501 2380;
   |PINPA #0#20;
   |SI #dsm18401#1 > 2006;
      |PINTA 1732, "42 ....";
   |FINSI;
   |PINDA #0#20;
   |ENDATOS #1#20;
   |SI FSalida = 0;
      |PARA nCont = 44; |SI nCont [ 49; |HACIENDO nCont = nCont + 1;
         nCalc = nCont - 44;
         #1nCont = #20nCalc;
      |SIGUE;
      |GRABA 020#1a;
   |FINSI;
   |POPV;
|FPRC;

|PROCESO Ded4098;
   |PARA nCont = 38; |SI nCont [ 43; |HACIENDO nCont = nCont + 1;
      nCalc = nCont - 38;
      #19nCalc = #1nCont;
   |SIGUE;

   |PUSHV 0501 2380;
   |PINPA #0#19;
   |SI #dsm18401#1 > 2006;
      |C_M #dsm18411#4, 1, "N"; |C_V #dsm18411#4, 1, "N";
      |PINTA 1707, "05. Deduccion por doble imposicion internacional ......";
      |PINTA 1807, "                                                       ";
      |C_P #dsm18411#5, 1, 1763;
   |FINSI;

   |PINDA #0#19;
   |ENDATOS #1#19;
   |SI FSalida = 0;
      |PARA nCont = 38; |SI nCont [ 43; |HACIENDO nCont = nCont + 1;
         nCalc = nCont - 38;
         #1nCont = #19nCalc;
      |SIGUE;
      |GRABA 020#1a;
   |FINSI;
   |POPV;
|FPRC;

|PROCESO RtaAtISo;
   |PARA nCont = 34; |SI nCont [ 37; |HACIENDO nCont = nCont + 1;
      nCalc = nCont - 34;
      #18nCalc = #1nCont;
   |SIGUE;
   |PUSHV 0501 2380;
   |PINPA #0#18; |PINDA #0#18;
   |ENDATOS #1#18;
   |SI FSalida = 0;
      |PARA nCont = 34; |SI nCont [ 37; |HACIENDO nCont = nCont + 1;
         nCalc = nCont - 34;
         #1nCont = #18nCalc;
      |SIGUE;
      |GRABA 020#1a;
   |FINSI;
   |POPV;
|FPRC;

|RUTINA inf14;
   #22#0 = #1#0;
   #22#1 = #1#1;
   #22#2 = #1#3;
   #22#3 = 01;
|FRUT;

|RUTINA sup14;
   #22#0 = #1#0;
   #22#1 = #1#1;
   #22#2 = #1#3;
   #22#3 = 99;
|FRUT;

|PROCESO Excesos;
   |PUSHV 1005 2276;
   |ENTLINEAL #1#22,-4,1,20,1,inf14,sup14;
   |POPV;
|FPRC;

|RUTINA inf09;
   #17#0 = #1#0;
   #17#1 = #1#1;
   #17#2 = #1#3;
   #17#3 = 001;
|FRUT;

|RUTINA sup09;
   #17#0 = #1#0;
   #17#1 = #1#1;
   #17#2 = #1#3;
   #17#3 = 999;
|FRUT;

|PROCESO GyPmayor;
   |PUSHV 1005 2276;
   |ENTLINEAL #1#17,-4,1,20,1,inf09,sup09;
   |HAZ CalcExcesos;
   |POPV;
|FPRC;

|RUTINA inf08;
   #16#0 = #1#0;
   #16#1 = #1#1;
   #16#2 = #1#3;
   #16#3 = 001;
|FRUT;

|RUTINA sup08;
   #16#0 = #1#0;
   #16#1 = #1#1;
   #16#2 = #1#3;
   #16#3 = 999;
|FRUT;

|PROCESO GyPmenor;
   |PUSHV 1005 2276;
   |ENTLINEAL #1#16,-4,1,20,1,inf08,sup08;
   |HAZ CalcExcesos;
   |POPV;
|FPRC;

|RUTINA inf07;
   #15#0 = #1#0;
   #15#1 = #1#1;
   #15#2 = #1#3;
   #15#3 = 001;
|FRUT;

|RUTINA sup07;
   #15#0 = #1#0;
   #15#1 = #1#1;
   #15#2 = #1#3;
   #15#3 = 999;
|FRUT;

|PROCESO RtasIIC;
   |PUSHV 1005 2276;
   |ENTLINEAL #1#15,-4,1,20,1,inf07,sup07;
   |POPV;
|FPRC;

|RUTINA inf06;
   #14#0 = #1#0;
   #14#1 = #1#1;
   #14#2 = #1#3;
   #14#3 = 001;
|FRUT;

|RUTINA sup06;
   #14#0 = #1#0;
   #14#1 = #1#1;
   #14#2 = #1#3;
   #14#3 = 999;
|FRUT;

|PROCESO RdActEco;
   |PUSHV 1005 2276;
   |ENTLINEAL #1#14,-4,1,20,1,inf06,sup06;
   |HAZ CalcExcesos;
   |POPV;
|FPRC;

|RUTINA inf05;
   #13#0 = #1#0;
   #13#1 = #1#1;
   #13#2 = #1#3;
   #13#3 = 001;
|FRUT;

|RUTINA sup05;
   #13#0 = #1#0;
   #13#1 = #1#1;
   #13#2 = #1#3;
   #13#3 = 999;
|FRUT;

|PROCESO RdCapInm;
   |PUSHV 1005 2276; |BLANCO 1005 2276;
   |ENTLINEAL #1#13,-4,1,21,1,inf05,sup05;
   |HAZ CalcExcesos;
   |POPV;
|FPRC;

|RUTINA inf04;
   #12#0 = #1#0;
   #12#1 = #1#1;
   #12#2 = #1#3;
   #12#3 = 001;
|FRUT;

|RUTINA sup04;
   #12#0 = #1#0;
   #12#1 = #1#1;
   #12#2 = #1#3;
   #12#3 = 999;
|FRUT;

|PROCESO IdCesCap;
   |PUSHV 1005 2276;
   |ENTLINEAL #1#12,-4,1,20,1,inf04,sup04;
   |POPV;
|FPRC;

|RUTINA inf03;
   #11#0 = #1#0;
   #11#1 = #1#1;
   #11#2 = #1#3;
   #11#3 = 001;
|FRUT;

|RUTINA sup03;
   #11#0 = #1#0;
   #11#1 = #1#1;
   #11#2 = #1#3;
   #11#3 = 999;
|FRUT;

|PROCESO RdCapMob;
   |PUSHV 1005 2276; |BLANCO 1005 2276;
   |ENTLINEAL #1#11,-4,1,21,1,inf03,sup03;
   |HAZ CalcExcesos;
   |POPV;
|FPRC;

|PROCESO DatosGen;
   |PUSHV 1005 2276;

   |PARA nCont = 8; |SI nCont [ 33; |HACIENDO nCont = nCont + 1;
      nCalc = nCont - 8;
      #10nCalc  = #1nCont;
   |SIGUE;
   #10#26 = #1#55;
   #10#27 = #1#56;

   |PINPA #0#10; |PINDA #0#10;
   |ENDATOS #1#10;
   |SI FSalida = 0;
      |PARA nCont = 8; |SI nCont [ 33; |HACIENDO nCont = nCont + 1;
         nCalc = nCont - 8;
         #1nCont = #10nCalc;
      |SIGUE;
      #1#55 = #10#26;
      #1#56 = #10#27;
   |FINSI;

   |POPV;
|FPRC;

|PROCESO dsmoc130;
     #4#0 = #130#0;
     #4#1 = #130#1;
     #4#2 = #130#2;
     #4#3 = #130#3;
     #4#4 = #130#4 + 1;
     |LEE 000#4=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     nSw = 1;
     |SI nSwOp = 1;  |ACABA;  |FINSI;

     nIngreso130   = nIngreso130   + #130#8;
     nGastos130    = nGastos130    + #130#11 + #130#47 + #130#14 + #130#21;
     nRdtos130     = nIngreso130   - nGastos130;
     nRetencion130 = nRetencion130 + #130#31;

     |SI nDActiv = nHActiv;  |ACABA;  |FINSI;

     #114#0  = #130#0;
     #114#1  = #130#5;
     |LEE 000#114=;
     |SI FSalida ! 0;  |DDEFECTO #114;  |FINSI;

     nLinea = nLinea + 1;

     #14#0 = #1#0;
     #14#1 = #1#1;
     #14#2 = #1#3;
     #14#3 = nLinea;
     |LEE 101#14=;
     |SI FSalida ! 0;
         |DDEFECTO #14;
         #14#0 = #1#0;
         #14#1 = #1#1;
         #14#2 = #1#3;
         #14#3 = nLinea;

         |SI #114#9 = 3;  #14#4 = 1;  |FINSI;
         |SI #114#9 = 4;  #14#4 = 2;  |FINSI;
         |SI #114#9 = 5;  #14#4 = 3;  |FINSI;
         |SI #114#9 = 6;  #14#4 = 3;  |FINSI;
         |SI #114#9 = 8;   #14#4 = 1;  |FINSI;
         |SI #114#9 = 9;   #14#4 = 2;  |FINSI;
         |SI #114#9 = 10;  #14#4 = 3;  |FINSI;
         |SI #114#9 = 11;  #14#4 = 3;  |FINSI;

         |SI #114#16 = 1;  |O #114#16 = 2;  |O #114#16 = 3;
             #14#5 = 1;
         |FINSI;

         |SI #114#16 = 4;  |O #114#16 = 5;
             #14#5 = 2;
         |FINSI;

         |SI #14#4 = 1; #14#14 = "Regimen de estimacion directa normal";       |FINSI;
         |SI #14#4 = 2; #14#14 = "Regimen de estimacion directa simplificada"; |FINSI;
         |SI #14#4 = 3; #14#14 = "Regimen de estimacion objetiva";             |FINSI;

         #14#6 = #114#3;
         |SI #14#6 = 9999;  #14#6 = 0;  |FINSI;

         #14#7 = #130#8;
         #14#8 = #130#11 + #130#47 + #130#14 + #130#21;
         #14#9 = #14#7 - #14#8;

         eaTabla = "ztabla01.txt";
         |HAZ CargaTabla;
         enComp = 1;
         eaAlfa = #14#5;
         |HAZ CompruebaTabla;
         #14#15 = eaDestino % 360;

                        eaTabla = "ztabla02.txt";
         |SI #14#5 = 4; eaTabla = "ztabla04.txt"; |FINSI;
         |SI #14#5 = 5; eaTabla = "ztabla03.txt"; |FINSI;

         |HAZ CargaTabla;
         enComp = 4;
         eaAlfa = ("0000" + #14#6) % -104;

         |HAZ CompruebaTabla;
         #14#16 = eaDestino % 660;

         |GRABA 020#14n;
         |LIBERA #14;

         |DDEFECTO #31;
         #31#0 = #14#0;
         #31#1 = #14#1;
         #31#2 = #14#2;
         #31#3 = #14#3;
         #31#4 = "ES";
         |LEE 101#31=;
         |SI FSalida ! 0;
             |DDEFECTO #31;
             #31#0 = #14#0;
             #31#1 = #14#1;
             #31#2 = #14#2;
             #31#3 = #14#3;
             #31#4 = "ES";
             #31#5 = "ESPA베";
             #31#6 = #14#7;
             #31#7 = #14#8;
             #31#8 = #14#9;
             |GRABA 020#31n;
         |FINSI;
         |LIBERA #31;
     |SINO;
         #14#7 = #130#8;
         #14#8 = #130#11 + #130#47 + #130#14 + #130#21;
         #14#9 = #14#7 - #14#8;
         |GRABA 020#14a;
         |LIBERA #14;

         #31#0 = #14#0;
         #31#1 = #14#1;
         #31#2 = #14#2;
         #31#3 = #14#3;
         #31#4 = "ES";
         |LEE 101#31=;
         |SI FSalida = 0;
             #31#5 = "ESPA베";
             #31#6 = #14#7;
             #31#7 = #14#8;
             #31#8 = #14#9;
             |GRABA 020#31a;
             |LIBERA #31;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsmoc130;
     #130#1;
     ;
     nEmpresa, #1#1, nPer130, 130, 00, nDActiv;
     nEmpresa, #1#1, nPer130, 130, 99, nHActiv;
     ;
     NULL, dsmoc130;
|FIN;

|PROCESO dsmoc131;
     #4#0 = #131#0;
     #4#1 = #131#1;
     #4#2 = #131#2;
     #4#3 = #131#3;
     #4#4 = #131#4 + 1;
     |LEE 000#4=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     nSw = 1; |SI nSwOp = 1; |ACABA; |FINSI;

     |SI #131#2 = nPer131;
         |ABRE #118;
         |SI nDActiv ! nHActiv;
             #118#0 = #131#0;
             #118#1 = #131#1;
             #118#2 = 0;
             #118#3 = #131#5;
             nPorce = 100;
         |SINO;
             #118#0 = #102#0;
             #118#1 = #131#1;
             #118#2 = 0;
             #118#3 = #102#1;
             nPorce = #102#7;
         |FINSI;

         |LEE 000#118=;
         |SI FSalida ! 0;  |DDEFECTO #118;  |FINSI;
         |CIERRA #118;

         nRdtos131 = nRdtos131 + ((#118#123 % nPorce) ! 2);
     |FINSI;

     nVentas131    = nVentas131    + #131#13;
     nRetencion131 = nRetencion131 + #131#12 + #131#15;

     |SI #131#2  ! nPer131;  |ACABA;  |FINSI;
     |SI nDActiv = nHActiv;  |ACABA;  |FINSI;

     #114#0  = #131#0;
     #114#1  = #131#5;
     |LEE 000#114=;
     |SI FSalida ! 0;  |DDEFECTO #114;  |FINSI;

     nLinea = nLinea + 1;

     #14#0 = #1#0;
     #14#1 = #1#1;
     #14#2 = #1#3;
     #14#3 = nLinea;
     |LEE 101#14=;
     |SI FSalida ! 0;
         |DDEFECTO #14;
         #14#0 = #1#0;
         #14#1 = #1#1;
         #14#2 = #1#3;
         #14#3 = nLinea;

         |SI #114#9 = 3;   #14#4 = 1;  |FINSI;
         |SI #114#9 = 4;   #14#4 = 2;  |FINSI;
         |SI #114#9 = 5;   #14#4 = 3;  |FINSI;
         |SI #114#9 = 6;   #14#4 = 3;  |FINSI;
         |SI #114#9 = 8;   #14#4 = 1;  |FINSI;
         |SI #114#9 = 9;   #14#4 = 2;  |FINSI;
         |SI #114#9 = 10;  #14#4 = 3;  |FINSI;
         |SI #114#9 = 11;  #14#4 = 3;  |FINSI;

         |SI #114#16 = 1;  |O #114#16 = 2;  |O #114#16 = 3;
             #14#5 = 1;
         |FINSI;

         |SI #114#16 = 4;  |O #114#16 = 5;
             #14#5 = 2;
         |FINSI;

         |SI #14#4 = 1; #14#14 = "Regimen de estimacion directa normal";       |FINSI;
         |SI #14#4 = 2; #14#14 = "Regimen de estimacion directa simplificada"; |FINSI;
         |SI #14#4 = 3; #14#14 = "Regimen de estimacion objetiva";             |FINSI;

         #14#6 = #114#3;
         |SI #14#6 = 9999;  #14#6 = 0;  |FINSI;

         #14#7 = 0;
         #14#8 = 0;
         #14#9 = #118#123 + nVentas131;

         eaTabla = "ztabla01.txt";
         |HAZ CargaTabla;
         enComp = 1;
         eaAlfa = #14#5;
         |HAZ CompruebaTabla;
         #14#15 = eaDestino % 360;

                              eaTabla = "ztabla02.txt";
         |SI #14#5 = 4; eaTabla = "ztabla04.txt"; |FINSI;
         |SI #14#5 = 5; eaTabla = "ztabla03.txt"; |FINSI;

         |HAZ CargaTabla;
         enComp = 4;
         eaAlfa = ("0000" + #14#6) % -104;

         |HAZ CompruebaTabla;
         #14#16 = eaDestino % 660;

         |GRABA 020#14n;
         |LIBERA #14;

         |DDEFECTO #31;
         #31#0 = #14#0;
         #31#1 = #14#1;
         #31#2 = #14#2;
         #31#3 = #14#3;
         #31#4 = "ES";
         #31#5 = "ESPA베";
         #31#6 = #14#7;
         #31#7 = #14#8;
         #31#8 = #14#9;
         |GRABA 020#31n;
         |LIBERA #31;
     |SINO;
         #14#7 = 0;
         #14#8 = 0;
         #14#9 = #118#123 + nVentas131;
         |GRABA 020#14a;
         |LIBERA #14;

         #31#0 = #14#0;
         #31#1 = #14#1;
         #31#2 = #14#2;
         #31#3 = #14#3;
         #31#4 = "ES";
         |LEE 101#31=;
         |SI FSalida = 0;
             #31#5 = "ESPA베";
             #31#6 = #14#7;
             #31#7 = #14#8;
             #31#8 = #14#9;
             |GRABA 020#31a;
             |LIBERA #31;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsmoc131;
     #131#1;
     ;
     nEmpresa, #1#1, 00, 131, 00, nDActiv;
     nEmpresa, #1#1, 99, 131, 99, nHActiv;
     ;
     NULL, dsmoc131;
|FIN;

|PROCESO dsm18430B;
     #30#16 = 0;
     #30#31 = 0;

     |GRABA 020#30a;
     |LIBERA #30;
|FPRC;

|DEFBUCLE dsm18430B;
     #30#1;
     2;
     #1#0, #1#1, #1#3, 001, aDNif;
     #1#0, #1#1, #1#3, 999, aHNif;
     be;
     NULL, dsm18430B;
|FIN;

|PROCESO VuelcaSocios;
     |SI #102#8 ! "01.01.0000";
         |SI #102#8 > fHFecha; |ACABA;  |FINSI;
     |FINSI;

     |SI #102#9 ! "01.01.0000";
         |SI #102#9 < fDFecha;  |ACABA;  |FINSI;
     |FINSI;

     nDias = (fHFecha - fDFecha) + 1;
     |SI #102#9 < fHFecha;  |Y #102#9 > "01.01.0000";
         nDias = #102#9 - fDFecha;
     |FINSI;

     #100#0 = #102#3;
     |LEE 000#100=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     nEmpresa      = #102#3;
     nDActiv       = #102#4;
     nHActiv       = #102#4;

     |SI nSwOp = 1;
         nSw    = 0;
         aDNif = #100#13;
         aHNif = #100#13 + "   ";
         |ABRE #4;
         |BUCLE dsmoc130;
         |BUCLE dsmoc131;
         |CIERRA #4;
         |SI nSw = 1; |BUCLE dsm18430B; |FINSI;
         |ACABA;
     |FINSI;

     nIngreso130   = 0;
     nGastos130    = 0;
     nRdtos130     = 0;
     nRetencion130 = 0;
     nRdtos131     = 0;
     nVentas131    = 0;
     nRetencion131 = 0;

     |SELECT #1#30;
     #30#0  = #1#0;
     #30#1  = #1#1;
     #30#33 = #1#3;
     #30#34 = 999;
     |LEE 000#30];
     |SI FSalida = 0;
         |LEE 000#30a;
     |SINO;
         |LEE 000#30u;
     |FINSI;

     nLinea30 = 1;
     |SI FSalida = 0;  |Y #30#0  = #1#0;  |Y #30#1  = #1#1;  |Y #30#33 = #1#3;
         nLinea30 = #30#34 + 1;
     |FINSI;

     |ABRE #4;
     |BUCLE dsmoc130;
     |BUCLE dsmoc131;
     |CIERRA #4;

     |SELECT #2#30;
     #30#0  = #1#0;
     #30#1  = #1#1;
     #30#33 = #1#3;
     #30#2  = #100#13;
     |LEE 000#30=;
     |SI FSalida = 0;
         nLin = #30#34;
     |SINO;
         nLin = nLinea30;
     |FINSI;

     |SELECT #1#30;
     #30#0  = #1#0;
     #30#1  = #1#1;
     #30#33 = #1#3;
     #30#34 = nLin;
     |LEE 101#30=;
     |SI FSalida ! 0;
         |DDEFECTO #30;
         #30#0  = #1#0;
         #30#1  = #1#1;
         #30#33 = #1#3;
         #30#34 = nLin;
         #30#2  = #100#13;
         #30#3  = "";
         #30#4  = #100#1;
/*
         aAlfa  = #100#3; |QBF aAlfa;
         aAlfa  = aAlfa + " " + #100#4; |QBF aAlfa;
         |SI #100#5 ! "    "; aAlfa = aAlfa + "," + #100#5; |QBF aAlfa; |FINSI;
         |SI #100#6 ! "   ";  aAlfa = aAlfa + "," + #100#6; |QBF aAlfa; |FINSI;
         |SI #100#7 ! "  ";   aAlfa = aAlfa + "," + #100#7; |QBF aAlfa; |FINSI;
         |SI #100#8 ! "  ";   aAlfa = aAlfa + "," + #100#8; |QBF aAlfa; |FINSI;
         aAlfa = aAlfa + "," + (("00" + #100#9) % -102);  |QBF aAlfa;
         aAlfa = aAlfa + "," + (("000" + #100#10) % -103); |QBF aAlfa;
         |SI #100#11 ! "                              ";
             aAlfa = aAlfa + "," + #100#11; |QBF aAlfa;
         |FINSI;
         #30#5  = aAlfa;
*/
         #30#36 = #100#3;
         #30#5  = #100#4;
         #30#37 = #100#5;
         #30#38 = #100#6;
         #30#39 = #100#7;
         #30#40 = #100#8;
         #30#41 = #100#10;
         #30#42 = #100#11;
         #30#6  = #100#9;
         #30#10 = nDias;

         enComp  = 2;
         eaTabla = "ztabla05.txt"; |HAZ CargaTabla;
         eaAlfa  = #30#7; |HAZ CompruebaTabla;

         #30#11  = #102#7;
         #30#35  = eaDestino % 430;
         nPorc   = nPorc + #102#7;

         |HAZ FinTabla;
         |GRABA 020#30b;
     |SINO;
         |SI #dsm18430#41 = 0;
            #30#36 = #100#3;
            #30#5  = #100#4;
            #30#37 = #100#5;
            #30#38 = #100#6;
            #30#39 = #100#7;
            #30#40 = #100#8;
            #30#41 = #100#10;
            #30#42 = #100#11;
         |FINSI;
     |FINSI;

     #30#16 = #30#16 + nRdtos130     + nRdtos131 + nVentas131;
     #30#31 = #30#31 + nRetencion130 + nRetencion131;

     |GRABA 020#30a;
     |LIBERA #30;

     nSocio = nSocio + 1;
     aAlfa  = #1#25;  |QBF aAlfa;
     |SI nSocio = 1;  |Y aAlfa = "";
         #1#25 = #100#13;
         #1#26 = #100#1;
         #1#27 = #100#4;
         #1#28 = #100#5;
         #1#29 = #100#9;
         #1#30 = #100#10;
         #1#31 = #100#11;
         #1#32 = #100#12;
     |FINSI;
|FPRC;

|DEFBUCLE VuelcaSocios;
     #102#1;
     ;
     #1#0, 0, 0001;
     #1#0, 9, 9999;
     ;
     NULL,VuelcaSocios;
|FIN;

|PROCESO dsm18403;
     |SI nSwBorra = 1;
         |BORRA 020#11a;
     |SINO;
         #11#2 = #1#3;
         |GRABA 020#11n;
         |LIBERA #11;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18403;
     #11#1;
     ;
     #1#0, #1#1, nComp, 001;
     #1#0, #1#1, nComp, 999;
     be;
     NULL,dsm18403;
|FIN;

|PROCESO dsm18404;
     |SI nSwBorra = 1;
         |BORRA 020#12a;
     |SINO;
         #12#2 = #1#3;
         |GRABA 020#12n;
         |LIBERA #12;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18404;
     #12#1;
     ;
     #1#0, #1#1, nComp, 001;
     #1#0, #1#1, nComp, 999;
     be;
     NULL, dsm18404;
|FIN;

|PROCESO dsm18405;
     |SI nSwBorra = 1;
         |BORRA 020#13a;
     |SINO;
         #13#2 = #1#3;
         |GRABA 020#13n;
         |LIBERA #13;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18405;
     #13#1;
     ;
     #1#0, #1#1, nComp, 001;
     #1#0, #1#1, nComp, 999;
     be;
     NULL, dsm18405;
|FIN;

|PROCESO dsm18406;
     |SI nSwBorra = 1;
         |BORRA 020#14a;
     |SINO;
         #14#2 = #1#3;
         |GRABA 020#14n;
         |LIBERA #14;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18406;
     #14#1;
     ;
     #1#0, #1#1, nComp, 001;
     #1#0, #1#1, nComp, 999;
     be;
     NULL, dsm18406;
|FIN;

|PROCESO dsm18407;
     |SI nSwBorra = 1;
         |BORRA 020#15a;
     |SINO;
         #15#2 = #1#3;
         |GRABA 020#15n;
         |LIBERA #15;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18407;
     #15#1;
     ;
     #1#0, #1#1, nComp, 001;
     #1#0, #1#1, nComp, 999;
     be;
     NULL, dsm18407;
|FIN;

|PROCESO dsm18408;
     |SI nSwBorra = 1;
         |BORRA 020#16a;
     |SINO;
         #16#2 = #1#3;
         |GRABA 020#16n;
         |LIBERA #16;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18408;
     #16#1;
     ;
     #1#0, #1#1, nComp, 001;
     #1#0, #1#1, nComp, 999;
     be;
     NULL, dsm18408;
|FIN;

|PROCESO dsm18409;
     |SI nSwBorra = 1;
         |BORRA 020#17a;
     |SINO;
         #17#2 = #1#3;
         |GRABA 020#17n;
         |LIBERA #17;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18409;
     #17#1;
     ;
     #1#0, #1#1, nComp, 001;
     #1#0, #1#1, nComp, 999;
     be;
     NULL,dsm18409;
|FIN;

|PROCESO dsm18414;
     |SI nSwBorra = 1;
         |BORRA 020#22a;
     |SINO;
         #22#2 = #1#3;
         |GRABA 020#22n;
         |LIBERA #22;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18414;
     #22#1;
     ;
     #1#0, #1#1, nComp, 001;
     #1#0, #1#1, nComp, 999;
     be;
     NULL,dsm18414;
|FIN;

|PROCESO dsm18430;
     |SI nSwBorra = 1;
         |BORRA 020#30a;
     |SINO;
         #30#33 = #1#3;
         |GRABA 020#30n;
         |LIBERA #30;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18430;
     #30#1;
     ;
     #1#0, #1#1, nComp, 001;
     #1#0, #1#1, nComp, 999;
     be;
     NULL, dsm18430;
|FIN;

|PROCESO dsm18431;
     |SI nSwBorra = 1;
         |BORRA 020#31a;
     |SINO;
         #31#2 = #1#3;
         |GRABA 020#31n;
         |LIBERA #31;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18431;
     #31#1;
     ;
     #1#0, #1#1, nComp, 001, "  ";
     #1#0, #1#1, nComp, 999, "zz";
     be;
     NULL, dsm18431;
|FIN;

|PROCESO dsmom004;
     |SI #4#3 = 130;  nPer130 = #4#2;  |FINSI;
     |SI #4#3 = 131;  nPer131 = #4#2;  |FINSI;
|FPRC;

|DEFBUCLE dsmom004;
     #4#1;
     ;
     #1#0, #1#1, 01, 130, 00;
     #1#0, #1#1, 12, 131, 00;
     ;
     NULL, dsmom004;
|FIN;

|PROCESO dsmom001;
     aComunidad = "S";

     #114#0  = #102#0;
     #114#1  = #102#1;
     |LEE 000#114=;
     |SI FSalida ! 0;  |DDEFECTO #114;  |FINSI;

     nTipoAct = #114#16;

     |ERROR10;
|FPRC;

|DEFBUCLE dsmom001;
     #102#1;
     ;
     #1#0, 0, 0001;
     #1#0, 9, 9999;
     ;
     NULL, dsmom001;
|FIN;

|PROCESO CopiaSocAnt;
   |SALVA_FICHA #30;
   #30#1 = #1#1;
   |LEE 000#30=;
   |SI FSalida ! 0;
      |PDEFECTO #30, 12, 33;
      |GRABA 020#30n;
   |FINSI;
   |REPON_FICHA #30;
|FPRC;

|DEFBUCLE CopiaSocAnt;
#30#1;
;
#1#0, nAnyo, #1#3, 001;
#1#0, nAnyo, #1#3, 999;
;
NULL,CopiaSocAnt;
|FIN;

|PROCESO RecogeDatos;
     |ABRE #107;
     |LEE 040#107p;
     |SI FSalida ! 0;
         |CIERRA #107;
         |SUB_EJECUTA_NP "dsmom107";
         |ABRE #107;
     |FINSI;

     |LEE 040#107p;
     |SI FSalida ! 0;  |DDEFECTO #107;  |FINSI;
     |CIERRA #107;

     |DBASS aBase;  |QBF aBase;
     aAlfa = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         |ABRE #101;
         #101#0 = #1#0;
         |LEE 000#101=;
         |SI FSalida ! 0;  |DDEFECTO #101;  |FINSI;

         aAlfa = #1#55;  |QBF aAlfa;
         |SI aAlfa = "";
             #1#55 = #101#53;
         |FINSI;

         |CIERRA #101;
     |FINSI;

     |ABRE #100;
     #100#0 = #1#0;
     |LEE 000#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;

     #1#4  = #100#1;
     #1#8  = #100#13;
     #1#9  = #100#1;
     #1#10 = #100#4;
     #1#11 = #100#5;
     #1#12 = #100#9;
     #1#13 = #100#10;
     #1#14 = #100#11;
     #1#15 = #100#12;
     #1#16 = #100#14;

     |SI #1#17 = " ";
         #1#17 = "A";
         #1#33 = "Entidades en Reg.atrib.rentas constituidas en Espa바";

         aComunidad = "";
         nTipoAct   = 0;

         |ABRE #114;
         |BUCLE dsmom001;
         |CIERRA #114;

         |SI aComunidad = "S";
             #1#18 = 2;
             |SI nTipoAct = 1;  |O nTipoAct = 2;  |O nTipoAct = 3;
                 #1#19 = 1;
             |FINSI;

             |SI nTipoAct = 4;  |O nTipoAct = 5;
                 #1#19 = 2;
             |FINSI;
         |FINSI;
     |FINSI;

     nPer130 = 12;
     |BUCLE dsmom004;

     aAlfa = #100#3; |QBF aAlfa;
     aAlfa = aAlfa + " " + #100#4; |QBF aAlfa;
     #1#10 = aAlfa;

     nLin    = 1;
     nPorc   = 0;
     aAlfa2  = #1#1;
     aAlfa1  = "01.01." + aAlfa2;
     aAlfa2  = "31.12." + aAlfa2;
     fDFecha = aAlfa1;
     fHFecha = aAlfa2;

     |SI #1#57 = "C";
         |HAZ ModelosFicticios;

         aFichero = ("C0" + Usuario + "zzzzzzzz") % 108;
         |NOME_DAT #130 aFichero;
     |FINSI;

     nSocio  = 0;

     nSwOp = 1;
     |BUCLE VuelcaSocios;

     nSwOp = 0;
     |ABRE #30;
     |BUCLE VuelcaSocios;
     |CIERRA #30;
     nPorc = nPorc ! 0;

     |SI nSocio = 0;
        nAnyo = -1;
        |ABRE #30;
        #30#0 = #1#0;
        #30#1 = 0;
        #30#33 = 0;
        |LEE 000#30];
        |PARA; |SI FSalida = 0; |Y #30#0 = #1#0; |Y #30#1 < #1#1; |HACIENDO;
           |SI #1#33 = 0; nAnyo = #30#1; |FINSI;
           |LEE 000#30s;
        |SIGUE;
        |SI nAnyo ! -1;
           |DDEFECTO #30;
           #30#0 = #1#0;
           #30#1 = nAnyo;
           #30#33 = 0;
           |LEE 000#30];
           |SI FSalida = 0; |Y #30#0 = #1#0; |Y #30#1 = nAnyo;
              |DBASE aBase;  |QBF aBase;
              aMas = aBase + "def/dsm18401.mas";
              |CARGA_DEF aMas, dsm18401@;
              |SI FSalida ! 0;
                  |MENAV "0000 Problemas en Crear Copia.";
                  |HAZ DestruyeFicheros;
                  |ACABA;
              |FINSI;

              |ABRE #500;
              #500#0 = #1#0;
              #500#1 = nAnyo;
              #500#2 = #1#2;
              #500#3 = #1#3;
              |LEE 000#500=;
              |SI FSalida = 0;
                 |PARA nCampo = 8;  |SI nCampo [ 33;  |HACIENDO nCampo = nCampo + 1;
                     #1nCampo = #500nCampo;
                 |SIGUE;
                 #1#24 = 0;
                 #1#55 = #500#55;
                 #1#56 = #500#56;
              |FINSI;
              |CIERRA #500;
              |DESCARGA_DEF #dsm18401@;
              |BUCLE CopiaSocAnt;
           |FINSI;
           |CIERRA #30;
        |FINSI;

        |SI enTipoEntrada = 1;              || Alta del Modelo
            |DBASE aBase;  |QBF aBase;
            aMas = aBase + "def/dsm18401.mas";
            |CARGA_DEF aMas, dsm18401@;
            |SI FSalida ! 0;
                |MENAV "0000 Problemas en Crear Copia.";
                |HAZ DestruyeFicheros;
                |ACABA;
            |FINSI;

            |ABRE #500;
            #500#0 = #1#0;
            #500#1 = #1#1 - 1;
            #500#2 = #1#2;
            #500#3 = #1#3;
            |LEE 000#500=;
            |SI FSalida = 0;
               |PARA nCampo = 8;  |SI nCampo [ 33;  |HACIENDO nCampo = nCampo + 1;
                   #1nCampo = #500nCampo;
               |SIGUE;
               #1#24 = 0;
               #1#55 = #500#55;
               #1#56 = #500#56;
            |FINSI;
            |CIERRA #500;
            |DESCARGA_DEF #dsm18401@;
        |FINSI;
     |FINSI;

     |SI nPorc ! 100; |Y nPorc ! 0;
         |MENAV "    Atencion. La suma de los porcentajes de los comuneros de esta comunidad no es del 100%";
     |FINSI;

     nEmpresa      = #1#0;
     nIngreso130   = 0;
     nGastos130    = 0;
     nRdtos130     = 0;
     nRetencion130 = 0;
     nRdtos131     = 0;
     nVentas131    = 0;
     nRetencion131 = 0;
     nDActiv       = 01;
     nHActiv       = 99;
     nLinea        = 0;
     nLinea30      = 0;

     |ABRE #14;
     |ABRE #31;
     |ABRE #114;
     |BUCLE dsmoc130;
     |BUCLE dsmoc131;
     |CIERRA #14;
     |CIERRA #31;
     |CIERRA #114;

     |SI nIngreso130 ! 0;  |O nRdtos131 ! 0;  |O nVentas131 ! 0;
         ||#1#24 = nIngreso130   + nRdtos131 + nVentas131;
         #1#24 = nIngreso130 + nVentas131;
     |FINSI;

     |SI nRetencion130 ! 0;  |O nRetencion131 ! 0;
         #1#52 = nRetencion130 + nRetencion131;
     |FINSI;

     |CIERRA #100;

     |HAZ DestruyeFicheros;
|FPRC;

|PROCESO Boton1;
     |SI enTipoEntrada ! 4;
         FSalida = -1;
         |SI #1#57 = "M";
             |CONFI "0000NQuiere recoger los datos de los modelos en estos momentos";
         |FINSI;

         |SI #1#57 = "C";
             |CONFI "0000NQuiere recoger los datos de la contabilidad en estos momentos";
         |FINSI;

         |SI FSalida = 0;
             |HAZ RecogeDatos;
         |FINSI;
     |FINSI;

     |ESTADO_CONTROL nBoton1, "HIDE";

     |HAZ Menu;
|FPRC

|PROCESO dsm18403C;
     #11#1  = #1#1;
     #11#6  = 0;
     #11#7  = 0;
     #11#8  = 0;
     #11#10 = 0;
     |GRABA 020#11n;
     |LIBERA #11;
|FPRC;

|DEFBUCLE dsm18403C;
     #dsm18403#1;
     ;
     #1#0, nAnyo, #1#3, 001;
     #1#0, nAnyo, #1#3, 999;
     be;
     NULL, dsm18403C;
|FIN;

|PROCESO dsm18404C;
     #12#1  = #1#1;
     #12#6  = 0;
     |GRABA 020#12n;
     |LIBERA #12;
|FPRC;

|DEFBUCLE dsm18404C;
     #12#1;
     ;
     #1#0, nAnyo, #1#3, 001;
     #1#0, nAnyo, #1#3, 999;
     be;
     NULL, dsm18404C;
|FIN;

|PROCESO dsm18405C;
     #13#1  = #1#1;
     #13#6  = 0;
     #13#7  = 0;
     #13#8  = 0;
     #13#10 = 0;
     |GRABA 020#13n;
     |LIBERA #13;
|FPRC;

|DEFBUCLE dsm18405C;
     #13#1;
     ;
     #1#0, nAnyo, #1#3, 001;
     #1#0, nAnyo, #1#3, 999;
     be;
     NULL, dsm18405C;
|FIN;

|PROCESO dsm18407C;
     #15#1  = #1#1;
     #15#7  = 0;
     #15#8  = 0;
     #15#9  = 0;
     |GRABA 020#15n;
     |LIBERA #15;
|FPRC;

|DEFBUCLE dsm18407C;
     #15#1;
     ;
     #1#0, nAnyo, #1#3, 001;
     #1#0, nAnyo, #1#3, 999;
     be;
     NULL, dsm18407C;
|FIN;

|PROCESO dsm18408C;
     #16#1  = #1#1;
     #16#6  = 0;
     |GRABA 020#16n;
     |LIBERA #16;
|FPRC;

|DEFBUCLE dsm18408C;
     #16#1;
     ;
     #1#0, nAnyo, #1#3, 001;
     #1#0, nAnyo, #1#3, 999;
     be;
     NULL, dsm18408C;
|FIN;

|PROCESO dsm18409C;
     #17#1  = #1#1;
     #17#7  = 0;
     |GRABA 020#17n;
     |LIBERA #17;
|FPRC;

|DEFBUCLE dsm18409C;
     #17#1;
     ;
     #1#0, nAnyo, #1#3, 001;
     #1#0, nAnyo, #1#3, 999;
     be;
     NULL, dsm18409C;
|FIN;

|PROCESO dsm18414C;
     #22#1  = #1#1;
     #22#6  = 0;
     |GRABA 020#22n;
     |LIBERA #22;
|FPRC;

|DEFBUCLE dsm18414C;
     #22#1;
     ;
     #1#0, nAnyo, #1#3, 001;
     #1#0, nAnyo, #1#3, 999;
     be;
     NULL, dsm18414C;
|FIN;

|PROCESO Copia;
     |CONFI "0000NSi nos traemos los Datos del Ejercicio Anterior perderemos lo que tenemos ahora. Continuar";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/dsm18401.mas";
     |CARGA_DEF aMas, dsm18401@;
     |SI FSalida ! 0;
         |MENAV "0000 Problemas en Crear Copia.";
         |ACABA;
     |FINSI;

     |ABRE #500;
     #500#0 = #1#0;
     #500#1 = #1#1 - 1;
     #500#2 = #1#2;
     #500#3 = #1#3;
     |LEE 000#500=;
     |SI FSalida = 0;
         ||SI #1#17 ! "A";
             |PARA nCampo = 8;  |SI nCampo [ 33;  |HACIENDO nCampo = nCampo + 1;
                   #1nCampo = #500nCampo;
             |SIGUE;
             #1#24 = 0;
             #1#55 = #500#55;
             #1#56 = #500#56;
         ||FINSI;

         nSwBorra = 1;
         nComp    = #1#3;

         |BUCLE dsm18403;
         |BUCLE dsm18404;
         |BUCLE dsm18405;
         |BUCLE dsm18407;
         |BUCLE dsm18408;
         |BUCLE dsm18409;
         |BUCLE dsm18414;

         nAnyo = #500#1;

         |BUCLE dsm18403C;
         |BUCLE dsm18404C;
         |BUCLE dsm18405C;
         |BUCLE dsm18407C;
         |BUCLE dsm18408C;
         |BUCLE dsm18409C;
         |BUCLE dsm18414C;
         |BUCLE CopiaSocAnt;
     |SINO;
         |MENAV "0000 No hay registro en el Ejercicio Anterior";
     |FINSI;
     |CIERRA #500;
     |DESCARGA_DEF #dsm18401@;
|FPRC;

|PROCESO MiraComp;
|FPRC;

|PROCESO RecogeCod;
|FPRC;

|PROCESO Justificante;
     |SI #1#3 = 0;  |ACABA;  |FINSI;

     |SI #1#5 ! "C";  |Y #1#5 ! "S";
         |MENAV "      Introduzca Complementaria o Sustitutoria";
         |ERROR;
     |FINSI;

     |C_M #1#7, 1, "N";
     |SI #1#5 = "S";
         |C_M #1#7, 1, "S";

         |SI #1#7 = 0;
             |ABRE #4;
             #4#0 = #1#0;
             #4#1 = #1#1;
             #4#2 = 99;
             #4#3 = #1#2;
             #4#4 = #1#3 - 1;
             |LEE 000#4=;
             |SI FSalida ! 0;  |DDEFECTO #4;  |FINSI;
             |CIERRA #4;
             aAlfa = #4#19 % 413;

             #1#7 = aAlfa;  |PINTA #1#7;
         |FINSI;
     |SINO;
         #1#7 = 0;  |PINTA #1#7;
     |FINSI;

     |SI #1#5 = "S";
         nSwBorra = 0;
         nComp    = #1#3 - 1;

         |DBASE aBase;  |QBF aBase;
         aMas = aBase + "def/dsm18401.mas";
         |CARGA_DEF aMas, dsm18401@;
         |SI FSalida = 0;
             |ABRE #500;
             #500#0 = #1#0;
             #500#1 = #1#1;
             #500#2 = #1#2;
             #500#3 = #1#3 - 1;
             |LEE 000#500=;
             |SI FSalida = 0;
                 |PARA nCampo = 8;  |SI nCampo [ 56;  |HACIENDO nCampo = nCampo + 1;
                       #1nCampo = #500nCampo;
                 |SIGUE;
             |FINSI;
             |CIERRA #500;
             |DESCARGA_DEF #dsm18401@;
         |FINSI;

         |SI nRecoge = 1;
             |BUCLE dsm18403;
             |BUCLE dsm18404;
             |BUCLE dsm18405;
             |BUCLE dsm18406;
             |BUCLE dsm18407;
             |BUCLE dsm18408;
             |BUCLE dsm18409;
             |BUCLE dsm18414;
             |BUCLE dsm18430;
             |BUCLE dsm18431;
         |FINSI;

         |PINPA #0#1;
         |PINDA #0#1;
         |HAZ PintaDatos;
     |FINSI;
|FPRC;

|PROGRAMA;
     eaPlanilla = "dsmom014";  |HAZ PlanDePlanillas;

     |HAZ LeeEURODBMOD;

     eaNomDef = "dsm18401";

|| \\\\\\ Alta del Modelo ////////

     |SI enTipoEntrada = 1;              || Alta del Modelo
         |CABEZA "Modelo 184";
         |ABRE #1;
         nRecoge = 0;
         #1#0 = enEmpresa;
         #1#1 = enEjer;
         #1#2 = enModelo;
         #1#3 = enComplem;
         |LEE 040#1=;
         |SI FSalida ! 0;
             |DDEFECTO #1;
             #1#0 = enEmpresa;
             #1#1 = enEjer;
             #1#2 = enModelo;
             #1#3 = enComplem;
             nRecoge = 1;
             |GRABA 020#1b;
         |FINSI;

         |PINPA #0#1;
         |PINDA #0#1;
         |HAZ PintaDatos;

         |CONTROL_SIMPLE 0, "BOTON,  Entrada de Datos  ", 1155, 1379, Boton1;
         nBoton1 = FSalida;

         |ESTADO_CONTROL nBoton1, "DISABLE";

         |C_M #1#5, 1, "N";
         |C_M #1#7, 1, "N";
         |SI #1#3 ! 0;
             |C_M #1#5, 1, "S";
         |FINSI;

         |ENDATOS #1#1;

         |ESTADO_CONTROL nBoton1, "ENABLE";

         |LEETECLA aTecla;

         |FIN_CONTROL_WINDOWS nBoton1;
         |PULSATECLA;

         |GRABA 020#1a;
         enEntrada = 1;
         |LIBERA #1;
         |CIERRA #1;

         |ACABA;
     |FINSI;

|| \\\\\\ Consulta del Modelo ////////

     |SI enTipoEntrada = 4;              || Consulta del Modelo
         |CABEZA "Modelo 184";
         |ABRE #1;
         #1#0 = enEmpresa;
         #1#1 = enEjer;
         #1#2 = enModelo;
         #1#3 = enComplem;
         |LEE 040#1=;
         |SI FSalida ! 0;
             |MENAV "      No existe Registro.";
             |CIERRA #1;
             |ACABA;
         |FINSI;

         |PINPA #0#1;
         |PINDA #0#1;
         |HAZ PintaDatos;

         |CONTROL_SIMPLE 0, "BOTON,  Entrada de Datos  ", 1155, 1379, Boton1;
         nBoton1 = FSalida;

         |LEETECLA aTecla;

         |FIN_CONTROL_WINDOWS nBoton1;
         |PULSATECLA;

         |CIERRA #1;

         |ACABA;
     |FINSI;

|| \\\\\\ Baja del Modelo ////////

     |SI enTipoEntrada = 3;              || Baja del Modelo
         |ABRE #1;
         #1#0 = enEmpresa;
         #1#1 = enEjer;
         #1#2 = enModelo;
         #1#3 = enComplem;
         |LEE 040#1=;
         |SI FSalida ! 0;
             |SI enMensa = 0;
                 |MENAV "      No existe Registro.";
             |FINSI;
             |CIERRA #1;
             |ACABA;
         |FINSI;

         nSwBorra = 1;
         nComp    = #1#3;

         |BUCLE dsm18403;
         |BUCLE dsm18404;
         |BUCLE dsm18405;
         |BUCLE dsm18406;
         |BUCLE dsm18407;
         |BUCLE dsm18408;
         |BUCLE dsm18409;
         |BUCLE dsm18414;
         |BUCLE dsm18430;
         |BUCLE dsm18431;

         |BORRA 020#1a;
         |LIBERA #1;
         |CIERRA #1;

         |ACABA;
     |FINSI;

|| \\\\\\ Comprobacion Existencia del Modelo

     |SI enTipoEntrada = 99;              || Existencia del Modelo ????
         |ABRE #1;
         #1#0 = enEmpresa;
         #1#1 = enEjer;
         #1#2 = enModelo;
         #1#3 = enComplem;
         |LEE 040#1=;
         |SI FSalida ! 0;  enExistencia = 1;  |FINSI;
         |CIERRA #1;

         |SI enActividad = 0;  enResultado = 0;  |FINSI;
     |FINSI;
|FPRO;
