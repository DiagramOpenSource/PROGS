|FICHEROS;
     dsmom004 #4;
     dsmom005 #5;
     dsmom006 #6;
     dsmom008 #8;
     dsmom900 #900;
     :/basica/def/agitab99 #99;
     dsmom024 #24;
     dsmom082 #82;
     dsmow084 #984,MANTE;

     dsmoc310 #310;
     dsmoc131 #131;
     dsmoc130 #130;
     dsmom010 #910;
     dsmom011 #911;
     dsmom012 #912;
     dsmom013 #913;
|FIN;

|VARIABLES;
     aAlfa      = "";
     aJusti     = "";
     aPathPdf   = "";
     aAbre      = "";
     aOrigen    = "";
     aDestino   = "";
     aIPRemoto  = "";
     aDirRemoto = "";
     aBase      = "";

     nCambio     = 0;
     nContador  = 0;
     nSinDatos  = 0;
     nLinea     = 0;

     nBoton2    = 0;
     nBoton3    = 0;
     nBoton4    = 0;
     nBoton5    = 0;
     nBoton6    = 0;
     nBoton7    = 0;
     nBoton8    = 0;
     nBoton9    = 0;
     nBoton10   = 0;
     nBoton12   = 0;
     nBoton13   = 0;
     nBoton15   = 0;
     nBoton16   = 0;
     nBoton17   = 0;
     nBoton18   = 0;

     nSwBoton2  = 0;
     nSwBoton3  = 0;
     nSwBoton4  = 0;
     nSwBoton5  = 0;
     nSwBoton6  = 0;
     nSwBoton7  = 0;
     nSwBoton8  = 0;
     nSwBoton9  = 0;
     nSwBoton10 = 0;
     nSwBoton12 = 0;
     nSwBoton13 = 0;
     nSwBoton15 = 0;
     nSwBoton16 = 0;
     nSwBoton17 = 0;
     nSwBoton18 = 0;

     nTecla     = 0;
     nModelo    = 0;
     nHandle    = 0;
     nUltimo    = 0;

     &enDEmpresa = 0;
     &enHEmpresa = 0;
     &enDEjer    = 0;
     &enHEjer    = 0;
     &enDModelo  = 0;
     &enHModelo  = 0;
     &eaPathAcrobat = "";

     &aCm9  = "";
     &aCm11 = "";
     &aCm13 = "";
|FIN;

|INCLUYE i_variar;

|PROCESO Tipo12;  |TIPO 12;
|FPRC;

|RUTINA ClaveBaja8;
     #8#0 = #4#0;
     #8#1 = #4#1;
     #8#2 = #4#2;
     #8#3 = #4#3;
     #8#4 = #4#4;
     #8#5 = 00;
|FRUT;

|RUTINA ClaveAlta8;
     #8#0 = #4#0;
     #8#1 = #4#1;
     #8#2 = #4#2;
     #8#3 = #4#3;
     #8#4 = #4#4;
     #8#5 = 99;
|FRUT;

|| \\\\\ Alta o Modificacion Modelos ////////

|PROCESO QuieresPasar390
     |SI #4#3 = 320;  |O #4#3 = 332;
         |CONFI "0000NDesea Realizar el Pase al Modelo 392";
     |SINO;
         |CONFI "0000NDesea Realizar el Pase al Modelo 390";
     |FINSI;

     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #4#3 = 320;  |O #4#3 = 332;
         enModelo  = 392;
         enModelo1 = 392;
     |SINO;
         enModelo  = 390;
         enModelo1 = 390;
     |FINSI;

     enPeriodo = 99;

     |SUB_EJECUTA_NP "dsmozpas";

     enModelo  = #4#3;
     enPeriodo = #4#2;
|FPRC;

|PROCESO QuieresPasar180;
     |CONFI "0000NDesea Realizar el Pase al Modelo 180";

     |SI FSalida ! 0;  |ACABA;  |FINSI;

     enModelo  = 180;
     enModelo1 = 180;
     enPeriodo = 99;

     |SUB_EJECUTA_NP "dsmozpas";

     enModelo  = #4#3;
     enPeriodo = #4#2;
|FPRC;

|PROCESO QuieresPasar190;
     |CONFI "0000NDesea Realizar el Pase al Modelo 190";

     |SI FSalida ! 0;  |ACABA;  |FINSI;

     enModelo  = 190;
     enModelo1 = 190;
     enPeriodo = 99;

     |SUB_EJECUTA_NP "dsmozpas";

     enModelo  = #4#3;
     enPeriodo = #4#2;
|FPRC;

|PROCESO AltaModelo;
     |SI #4#4 > 0;
         |SI #4#3 = 130;  |O #4#3 = 131;  |O #4#3 = 310;  |O #4#3 = 300;
                          |O #4#3 = 123;  |O #4#3 = 216;
             |LEE 101#4=;

             |HAZ PideJusti;

             |GRABA 020#4a;
             |LIBERA #4;
         |FINSI;
     |FINSI;

     |SI #4#11 ! "X"; |Y #4#13 ! "X";
         |SI #4#3 = 300;  |O #4#3 = 320;  |O #4#3 = 330;  |O #4#3 = 332;
          |O #4#3 = 310;  |O #4#3 = 370;
             |SI #4#17 = "COMPLETADO  ";
                 |HAZ ChequeaProrrata;
                 |SI enSwSeguir = 1;
                     |ACABA;
                 |FINSI;
             |FINSI;

             |HAZ eLaPrescripcion;
             |SI enSwSeguir = 1;  |ACABA; |FINSI;

             |HAZ eLaProrrata;
             |SI enSwSeguir ! 0;
                 |SI enSwSeguir = 2;
                     enEmpresa = #4#0;
                     enEjer    = #4#1;
                     enPeriodo = #4#2;
                     enModelo  = #4#3;
                     enComplem = #4#4;
                     |SUB_EJECUTA "dsmoz016";
                 |FINSI;
                 |ACABA;
             |FINSI;

          |FINSI;
     |FINSI;

     |SI #4#5 = "ACTIVIDAD ";  |O #4#5 = "ACT.+ REG.";
         |PUSHV 0501 2380;
         |ENTLINEAL #1#8, -6, 4, 21, 1, ClaveBaja8, ClaveAlta8;
         |POPV;

         |SI #4#3 = 300;  |O #4#3 = 320;  |O #4#3 = 330;  |O #4#3 = 332;
          |O #4#3 = 310;  |O #4#3 = 370;
             |SI #4#2 = 12;
                 |HAZ QuieresPasar390;
             |FINSI;
         |FINSI;

         |SI #4#3 = 115;
             |SI #4#2 = 12;
                 |HAZ QuieresPasar180;
             |FINSI;
         |FINSI;

         |SI #4#3 = 110;
             |SI #4#2 = 12;
                 |HAZ QuieresPasar190;
             |FINSI;
         |FINSI;

         |LEE 101#4=;

         |HAZ ChequeaSituacion;  || Esta en el PLB

         |GRABA 020#4a;
         |LIBERA #4;
         |VETE GrabaPror;
     |FINSI;

     |SI #4#11 = "X";
         |MENAV "     Modelo ya Remesado. No se puede Modificar";
         |ACABA;
     |FINSI;

     |SI #4#13 = "X";
         |MENAV "     Modelo ya Archivado. No se puede Modificar";
         |ACABA;
     |FINSI;

     |ABRE #8;
     #8#0 = #4#0;
     #8#1 = #4#1;
     #8#2 = #4#2;
     #8#3 = #4#3;
     #8#4 = #4#4;
     #8#5 = 0;
     |LEE 040#8=;
     |SI FSalida ! 0;  |DDEFECTO #8;  #8#12 = #4#3;  |FINSI;
     |CIERRA #8;

     enTipoEntrada = 1;
     |HAZ EntraModelo;

     |LEE 101#4=;
     |SI enEntrada = 1;
         #4#7  = "X";
         #4#8  = ~;
         #4#15 = enResultado;
         #4#17 = "COMPLETADO";
         aAlfa = #4#16;  |QBT aAlfa;
         |SI aAlfa ! "";
             |HAZ UltimoPeriodo;
             #4#16 = eaUltimoPer;
         |FINSI;
      |SINO;
         |SI #4#9 = " ";
             #4#7  = " ";
             #4#8  = "01.01.0000";
             #4#9  = " ";
             #4#10 = "01.01.0000";
             #4#15 = 0;
             #4#17 = "SIN DATOS";
         |FINSI;
      |FINSI;
      |GRABA 020#4a;
      |LIBERA #4;

      |ET GrabaPror;
      |SI #4#3 = 300;  |O #4#3 = 320;  |O #4#3 = 330;  |O #4#3 = 332;
          |O #4#3 = 310;  |O #4#3 = 370;
             |HAZ eLaProrrFin;
      |FINSI;
|FPRC;

|| \\\\\ Recoge Modelo ////////

|PROCESO TraeModelo;
     |ABRE #99;
     #99#0 = enModelo;
     |LEE 040#99=;
     |SI FSalida ! 0;  |DDEFECTO #99;  |FINSI;
     |CIERRA #99;

     |SI #4#3 ! 180;  |Y #4#3 ! 190; |Y #4#3 ! 390;  |Y #4#3 ! 392;
      |Y #4#3 ! 193;  |Y #4#3 ! 184; |Y #4#3 ! 296;
         |SI #99#4 = "N";
             |MENAV "     Modelo sin Activar el Pase de Registro.";
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #4#11 = "X";
         |MENAV "     Modelo ya Remesado. No se puede Recoger Datos";
         |ACABA;
     |FINSI;

     |SI #4#13 = "X";
         |MENAV "     Modelo ya Archivado. No se puede Recoger Datos";
         |ACABA;
     |FINSI;

     |SI #4#9 = "X";
         |MENAV "     Modelo ya Impreso. Para recoger datos hay que darlo de Baja primero.";
         |ACABA;
     |FINSI;

     |SI #4#5 = "EMPRESA   ";
         |CONFI "0000SDesea Realizar el Pase en estos momentos ";
         |SI FSalida = 0;
             enModelo1 = #4#3;
             |SUB_EJECUTA_NP "dsmozpas";
         |FINSI;
     |FINSI;
|FPRC;

|| \\\\\ Baja del Modelo ////////

|PROCESO BorraAct;
     |BORRA 020#8a;
     |LIBERA #8;

     enEmpresa     = #8#0;
     enEjer        = #8#1;
     enPeriodo     = #8#2;
     enModelo      = #8#3;
     enComplem     = #8#4;
     enActividad   = #8#5;
     enTipoEntrada = 3;
     |HAZ EntraModelo;
|FPRC;

|DEFBUCLE dsmom008B;
     #8#1;
     ;
     #4#0, #4#1, #4#2, #4#3, #4#4, 00;
     #4#0, #4#1, #4#2, #4#3, #4#4, 99;
     be;
     NULL, BorraAct;
|FIN;

|PROCESO BajaModelo;
     |SI #4#4 > 0;  |Y #4#5  ! "EMPRESA   ";
         |SI #4#9 = "X";
             |CONFI "0000NModelo ya Impreso, Esta Seguro de la Baja : ";
             |SI FSalida ! 0;  |ACABA;  |FINSI;
         |SINO;
             |CONFI "0000NEsta seguro de dar de Baja el Modelo ";
             |SI FSalida ! 0;  |ACABA;  |FINSI;
         |FINSI;

         |BUCLE dsmom008B;

         |LEE 101#4=;
         |SI FSalida = 0;
             |BORRA 020#4a;
             |LIBERA #4;
         |FINSI;

         |SI nSwBoton13 = 1;
             aOrigen =  aPathPdf;
             |FBORRA aOrigen;
         |FINSI;

         enEmpresa     = #4#0;
         enEjer        = #4#1;
         enPeriodo     = #4#2;
         enModelo      = #4#3;
         enComplem     = #4#4;
         enActividad   = 0;

         |ACABA;
     |FINSI;

     |SI #4#7 = " ";  |ACABA;  |FINSI;

     |SI #4#5  ! "EMPRESA   ";
         |MENAV "     Modelo por Actividad, no puedo dar de Baja";
         |ACABA;
     |FINSI;

     |SI #4#11 = "X";
         |MENAV "     Modelo ya Remesado. No se puede dar de Baja";
         |ACABA;
     |FINSI;

     |SI #4#13 = "X";
         |MENAV "     Modelo ya Archivado. No se puede dar de Baja";
         |ACABA;
     |FINSI;

     |SI #4#9 = "X";
         |CONFI "0000NModelo ya Impreso, Esta Seguro de la Baja : ";
         |SI FSalida ! 0;
             |ACABA;
         |FINSI;
     |SINO;
         |CONFI "0000NEsta seguro de dar de Baja el Modelo ";
         |SI FSalida ! 0;
             |ACABA;
         |FINSI;
     |FINSI;

     |ABRE #8;
     #8#0 = #4#0;
     #8#1 = #4#1;
     #8#2 = #4#2;
     #8#3 = #4#3;
     #8#4 = #4#4;
     #8#5 = 0;
     |LEE 040#8=;
     |SI FSalida ! 0;  |DDEFECTO #8;  #8#12 = #4#3;  |FINSI;
     |CIERRA #8;

     enTipoEntrada = 3;
     |HAZ EntraModelo;

     |LEE 101#4=;
     |SI #4#4 > 0;  |Y #4#5 = "EMPRESA   ";
         |BORRA 020#4a;
     |SINO;
         #4#7  = " ";
         #4#8  = "01.01.0000";
         #4#9  = " ";
         #4#10 = "01.01.0000";
         #4#15 = 0;
         #4#17 = "SIN DATOS";
         |GRABA 020#4a;
         |LIBERA #4;
     |FINSI;
     |LIBERA #4;

     |SI nSwBoton13 = 1;
         aOrigen =  aPathPdf;
         |FBORRA aOrigen;
     |FINSI;
|FPRC;

|PROCESO Boton2m004;
     |PTEC 824;
|FPRC;

|PROCESO Boton3m004;
     |PTEC 825;
|FPRC;

|PROCESO Boton4m004;
     |PTEC 826;
|FPRC;

|PROCESO Boton5m004;
     |PTEC 827;
|FPRC;

|PROCESO Boton6m004;
     |PTEC 828;
|FPRC;

|PROCESO Boton7m004;
     |PTEC 829;
|FPRC;

|PROCESO Boton8m004;
     |PTEC 830;
|FPRC;

|PROCESO Boton9m004;
     |PTEC 831;
|FPRC;

|PROCESO Boton10m004;
     |PTEC 832;
|FPRC;

|PROCESO Boton12m004;
     |PTEC 834;
|FPRC;

|PROCESO Boton13m004;
     |PTEC 835;
|FPRC;

|PROCESO Boton17m004;
     |PTEC 839;
|FPRC;

|PROCESO Boton15m004;
     |PTEC 837;
|FPRC;

|PROCESO Boton16m004;
     |PTEC 838
|FPRC;

|PROCESO Boton18m004;
     |PTEC 841;
|FPRC;

|PROCESO FinBotonm004;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton5;
     |FIN_CONTROL_WINDOWS nBoton6;
     |FIN_CONTROL_WINDOWS nBoton7;
     |FIN_CONTROL_WINDOWS nBoton8;
     |FIN_CONTROL_WINDOWS nBoton9;
     |FIN_CONTROL_WINDOWS nBoton10;
     |FIN_CONTROL_WINDOWS nBoton12;
     |FIN_CONTROL_WINDOWS nBoton13;
     |FIN_CONTROL_WINDOWS nBoton15;
     |FIN_CONTROL_WINDOWS nBoton16;
     |FIN_CONTROL_WINDOWS nBoton17;
     |FIN_CONTROL_WINDOWS nBoton18;

     |PULSATECLA;
|FPRC;

|PROCESO Tipo0m004;  |TIPO 0;
     |HAZ FinBotonm004;
|FPRC;

|PROCESO Tipo7m004;  |TIPO 7;
     |BLIN 04;

     |CONTROL_SIMPLE 0, "LBOTON,F2  Consulta Modelo     ", 1032, 1055, Boton2m004;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F3  Entrada de Datos    ", 1132, 1155, Boton3m004;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F4  Consulta Prorrata   ", 1232, 1255, Boton4m004;
     nBoton4 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F5  Consulta Prescripcion ", 1332, 1355, Boton5m004;
     nBoton5 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F6  Imprimir            ", 1432, 1455, Boton6m004;
     nBoton6 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F7  Recoger Datos       ", 1532, 1555, Boton7m004;
     nBoton7 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F8  Baja Modelo         ", 1632, 1655, Boton8m004;
     nBoton8 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F9  Crear Complementaria", 1057, 1080, Boton9m004;
     nBoton9 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F10 Dejar No Impreso    ", 1157, 1180, Boton10m004;
     nBoton10 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F12 Numero Justificante ", 1257, 1280, Boton12m004;
     nBoton12 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,Ctrl-F3 Ver Documento PDF", 1357, 1380, Boton13m004;
     nBoton13 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,Ctrl-F5  Regularizacion Manual ", 1457, 1480, Boton15m004;
     nBoton15 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,Ctrl-F6 Compensar/Devolver ", 1557, 1580, Boton16m004;
     nBoton16 = FSalida;

     aAlfa = "Archivar           "; |SI #4#13 = "X"; aAlfa = "Dejar No Archivado "; |FINSI;
     aAlfa = "LBOTON,Ctrl-F7 " + aAlfa;
     |CONTROL_SIMPLE 0, aAlfa, 1657, 1680, Boton17m004;
     nBoton17 = FSalida;

     |ABRE #900;
     #900#0 = #4#0;
     #900#1 = #4#1;
     #900#2 = #4#2;
     #900#3 = #4#3;
     #900#4 = #4#4;
     #900#5 = 1;
     |LEE 000#900];
     |SI FSalida = 0;  |Y  #900#0 = #4#0;  |Y  #900#1 = #4#1;
                       |Y  #900#2 = #4#2;  |Y  #900#3 = #4#3;
                       |Y #900#4 = #4#4;
         |CONTROL_SIMPLE 0, "LBOTON,Ctrl-F9 Comentarios (Con datos)", 0957, 0980, Boton18m004;
     |SINO;
         |CONTROL_SIMPLE 0, "LBOTON,Ctrl-F9 Comentarios (Sin datos)", 0957, 0980, Boton18m004;
     |FINSI;
         nBoton18 = FSalida;

     |ESTADO_CONTROL nBoton2,  "DISABLE";  nSwBoton2  = 0;
     |ESTADO_CONTROL nBoton3,  "DISABLE";  nSwBoton3  = 0;
     |ESTADO_CONTROL nBoton4,  "DISABLE";  nSwBoton4  = 0;
     |ESTADO_CONTROL nBoton5,  "DISABLE";  nSwBoton5  = 0;
     |ESTADO_CONTROL nBoton15, "DISABLE";  nSwBoton15 = 0;
     |ESTADO_CONTROL nBoton16, "DISABLE";  nSwBoton16 = 0;
     |ESTADO_CONTROL nBoton6,  "DISABLE";  nSwBoton6  = 0;
     |ESTADO_CONTROL nBoton7,  "DISABLE";  nSwBoton7  = 0;
     |ESTADO_CONTROL nBoton8,  "DISABLE";  nSwBoton8  = 0;
     |ESTADO_CONTROL nBoton9,  "DISABLE";  nSwBoton9  = 0;
     |ESTADO_CONTROL nBoton10, "DISABLE";  nSwBoton10 = 0;
     |ESTADO_CONTROL nBoton12, "DISABLE";  nSwBoton12 = 0;
     |ESTADO_CONTROL nBoton13, "DISABLE";  nSwBoton13 = 0;
     |ESTADO_CONTROL nBoton17, "DISABLE";  nSwBoton17 = 0;
     |ESTADO_CONTROL nBoton18, "DISABLE";  nSwBoton18 = 0;

     |SI #4#3 ] 900;  |ACABA;  |FINSI;

     |DBASE aPathPdf;  |QBF aPathPdf;
     aPathPdf = aPathPdf + "modelospdf";
     aPathPdf = aPathPdf + "/" + #4#3;
     aPathPdf = aPathPdf + "/" + #4#1;
     aPathPdf = aPathPdf + "/" + (("00" + #4#2) % -102);
     aPathPdf = aPathPdf + "/" + (("00" + #4#4) % -102);
     aPathPdf = aPathPdf + "/" + #4#3 + (("00000" + #4#0) % -105) + ".pdf";

     |XABRE "E", aPathPdf, nHandle;
     |SI FSalida ] 0;
         |ESTADO_CONTROL nBoton13, "ENABLE";  nSwBoton13 = 1;
     |FINSI;

     |SI #4#9 = "X";
         |ESTADO_CONTROL nBoton12, "ENABLE";  nSwBoton12 = 1;
     |FINSI;

     |SI #4#7 = "X";
         |ESTADO_CONTROL nBoton6,  "ENABLE";  nSwBoton6 = 1;
     |FINSI;

     |SI #4#9 = "X";  |Y #4#13 = " ";
         |ESTADO_CONTROL nBoton10,  "ENABLE";  nSwBoton10 = 1;
     |FINSI;

     |SI #4#9 = "X";
         |ESTADO_CONTROL nBoton17,  "ENABLE";  nSwBoton17 = 1;
     |FINSI;

     |SI #4#5 = "MANUAL    ";
         |ESTADO_CONTROL nBoton2,  "ENABLE";  nSwBoton2  = 1;
         |ESTADO_CONTROL nBoton18, "ENABLE";  nSwBoton18 = 1;
         |ACABA;
     |FINSI;

     |SI #4#5 = "EMPRESA   ";
         |ESTADO_CONTROL nBoton2,  "ENABLE";  nSwBoton2  = 1;
         |ESTADO_CONTROL nBoton3,  "ENABLE";  nSwBoton3  = 1;
         |ESTADO_CONTROL nBoton8,  "ENABLE";  nSwBoton8  = 1;
         |ESTADO_CONTROL nBoton18, "ENABLE";  nSwBoton18 = 1;

         |SI #4#3 = 347;  |O #4#3 = 190;  |O #4#3 = 180;
          |O #4#3 = 390;  |O #4#3 = 392;  |O #4#3 = 193;
          |O #4#3 = 296;
             |ESTADO_CONTROL nBoton7,  "ENABLE";  nSwBoton7 = 1;
             |ESTADO_CONTROL nBoton9,  "ENABLE";  nSwBoton9 = 1;
         |FINSI;

         |SI #4#3 = 110;  |O #4#3 = 115;  |O #4#3 = 184;
          |O #4#3 = 130;  |O #4#3 = 131;  |O #4#3 = 310;
          |O #4#3 = 123;  |O #4#3 = 216;
             |ESTADO_CONTROL nBoton9,  "ENABLE";  nSwBoton9 = 1;
         |FINSI;

         |ACABA;
     |FINSI;

     |SI #4#3 = 110;  |O #4#3 = 115;  |O #4#3 = 349;  |O #4#3 = 370;
      |O #4#3 = 300;  |O #4#3 = 330;  |O #4#3 = 320;  |O #4#3 = 332;
      |O #4#3 = 130;  |O #4#3 = 131;  |O #4#3 = 310;  |O #4#3 = 123;
      |O #4#3 = 216;
         |ESTADO_CONTROL nBoton9,  "ENABLE";  nSwBoton9 = 1;
     |FINSI;

     |SI #4#3 = 300;  |O #4#3 = 320;  |O #4#3 = 330;
      |O #4#3 = 332;  |O #4#3 = 370;
      |O #4#3 = 110;  |O #4#3 = 115;
      |O #4#3 = 130;  |O #4#3 = 131;  |O #4#3 = 310;
         |SI #4#4 > 0;
             |ESTADO_CONTROL nBoton8,  "ENABLE";  nSwBoton8 = 1;
         |FINSI;
     |FINSI;

     |SI #4#3 = 349;
         |ESTADO_CONTROL nBoton8,  "ENABLE";  nSwBoton8 = 1;
     |FINSI;

     |ESTADO_CONTROL nBoton2,  "ENABLE";  nSwBoton2  = 1;
     |ESTADO_CONTROL nBoton3,  "ENABLE";  nSwBoton3  = 1;
     |ESTADO_CONTROL nBoton18, "ENABLE";  nSwBoton18 = 1;

     |SI #4#3 = 300;  |O #4#3 = 370;  |O #4#3 = 320;
      |O #4#3 = 330;  |O #4#3 = 332;
         |ESTADO_CONTROL nBoton4,  "ENABLE";  nSwBoton4  = 1;
         |ESTADO_CONTROL nBoton15, "ENABLE";  nSwBoton15 = 1;
     |FINSI;

     |SI #4#3 = 300;  |O #4#3 = 370;  |O #4#3 = 320;
      |O #4#3 = 330;  |O #4#3 = 332;  |O #4#3 = 310;
         |ESTADO_CONTROL nBoton5,  "ENABLE";  nSwBoton5 =  1;
     |FINSI;

     |SI #4#3 = 300;  |O #4#3 = 370;  |O #4#3 = 310;
         |SI #4#2 = 12;  |Y #4#15 < 0;  |Y #4#13 = " ";
             |ESTADO_CONTROL nBoton16,  "ENABLE";  nSwBoton16 =  1;
         |FINSI;
     |FINSI;

     |SI #4#3 = 320;  |O #4#3 = 330;  |O #4#3 = 332;
         |SI #4#2 = 12; |Y #4#15 < 0;  |Y #4#13 = " ";
             |ESTADO_CONTROL nBoton16,  "ENABLE";  nSwBoton16 =  1;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO dsmom010;
     #910#3  = nLinea;

     |GRABA 020#910n;
     |LIBERA #910;
|FPRC;

|DEFBUCLE dsmom010;
     #910#1;
     ;
     #130#0, #130#1, #130#2, #130#4, #130#5, "    ";
     #130#0, #130#1, #130#2, #130#4, #130#5, "zzzz";
     ;
     NULL, dsmom010;
|FIN;

|PROCESO dsmom011;
     #911#3  = nLinea;

     |GRABA 020#911n;
     |LIBERA #911;
|FPRC;

|DEFBUCLE dsmom011;
     #911#1;
     ;
     #130#0, #130#1, #130#2, #130#4, #130#5, "    ";
     #130#0, #130#1, #130#2, #130#4, #130#5, "zzzz";
     ;
     NULL, dsmom011;
|FIN;

|PROCESO dsmom012;
     #912#3  = nLinea;

     |GRABA 020#912n;
     |LIBERA #912;
|FPRC;

|DEFBUCLE dsmom012;
     #912#1;
     ;
     #130#0, #130#1, #130#2, #130#4, #130#5, "    ";
     #130#0, #130#1, #130#2, #130#4, #130#5, "zzzz";
     ;
     NULL, dsmom012;
|FIN;

|PROCESO dsmom013;
     #913#3  = nLinea;

     |GRABA 020#913n;
     |LIBERA #913;
|FPRC;

|DEFBUCLE dsmom013;
     #913#1;
     ;
     #130#0, #130#1, #130#2, #130#4, #130#5, "    ";
     #130#0, #130#1, #130#2, #130#4, #130#5, "zzzz";
     ;
     NULL, dsmom013;
|FIN;

|PROCESO dsmoc130;
     |BUCLE dsmom010;
     |BUCLE dsmom011;
     |BUCLE dsmom012;
     |BUCLE dsmom013;

     #130#4  = nLinea;
     |GRABA 020#130n;
     |LIBERA #130;
|FPRC;

|DEFBUCLE dsmoc130;
     #130#1;
     ;
     #8#0, #8#1, #8#2, #8#3, #8#4, #8#5;
     #8#0, #8#1, #8#2, #8#3, #8#4, #8#5;
     ;
     NULL, dsmoc130;
|FIN;

|PROCESO dsmoc131;
     #131#4  = nLinea;
     |GRABA 020#131n;
     |LIBERA #131;
|FPRC;

|DEFBUCLE dsmoc131;
     #131#1;
     ;
     #8#0, #8#1, #8#2, #8#3, #8#4, #8#5;
     #8#0, #8#1, #8#2, #8#3, #8#4, #8#5;
     ;
     NULL, dsmoc131;
|FIN;

|PROCESO dsmoc310;
     |SALVA_DATOS #310;

     #310#4  = nLinea;
     |LEE 000#310=;
     |SI FSalida = 0;
         |REPON_DATOS #310;
         |LEE 000#310=;
         |ACABA;
     |FINSI;
     |REPON_DATOS #310;

     #310#4  = nLinea;
     |GRABA 020#310n;
     |LIBERA #310;
|FPRC;

|DEFBUCLE dsmoc310;
     #310#1;
     ;
     #8#0, #8#1, #8#2, #8#3, #8#4, #8#5;
     #8#0, #8#1, #8#2, #8#3, #8#4, #8#5;
     ;
     NULL, dsmoc310;
|FIN;

|PROCESO CompleAct;
     |SI #4#3 = 130;  |BUCLE dsmoc130;  |FINSI;
     |SI #4#3 = 131;  |BUCLE dsmoc131;  |FINSI;
     |SI #4#3 = 310;  |BUCLE dsmoc310;  |FINSI;

     #8#4  = nLinea;
     |SI #4#3 ! 130;
         #8#7  = "MANUAL";
     |FINSI;
     |SI #4#3 = 130;           || Lo pasamos a Manual
         |SI #8#7 = "PLANILLAS "; |O  #8#7 = "MODULOS   ";
             #8#7  = "MANUAL";
         |FINSI;
     |FINSI;

     #8#11 = "SIN DATOS";
     |GRABA 020#8n;
     |LIBERA #8;
|FPRC;

|DEFBUCLE dsmom008;
     #8#1;
     ;
     #4#0, #4#1, #4#2, #4#3, nUltimo, 00;
     #4#0, #4#1, #4#2, #4#3, nUltimo, 99;
     be;
     NULL, CompleAct;
|FIN;

|PROCESO PideJusti;
     |PUSHV 0501 2380;

     #984#0 = #4#20;
     #984#1 = #4#21;

     |PINPA #0#984;
     |PINDA #0#984;
     |ENDATOS #1#984;
     |SI FSalida = 0;
         #4#20 = #984#0;
         #4#21 = #984#1;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO Complementaria;
     |SALVA_DATOS #4;
     #4#4 = 0;
     |PARA;  |SI;  |HACIENDO;
          |LEE 040#4=;
          |SI FSalida = 0;
              #4#4 = #4#4 + 1;
          |SINO;
              nLinea = #4#4;
              |SAL;
          |FINSI;
     |SIGUE;

     nUltimo = nLinea - 1;

     |REPON_DATOS #4;

     |SI #4#3 = 110;  |O #4#3 = 115;
      |O #4#3 = 300;  |O #4#3 = 320;
      |O #4#3 = 330;  |O #4#3 = 332;
      |O #4#3 = 370;  |O #4#3 = 349;
      |O #4#3 = 130;  |O #4#3 = 131;  |O #4#3 = 310;
      |O #4#3 = 123;  |O #4#3 = 216;
         |BUCLE dsmom008;
     |FINSI;

     #4#4 = nLinea;
     #4#7  = " ";
     #4#8  = "01.01.0000";
     #4#9  = " ";
     #4#10 = "01.01.0000";
     #4#11 = " ";
     #4#12 = "01.01.0000";
     #4#13 = " ";
     #4#14 = "01.01.0000";
     #4#18 = 0;

     #4#15 = 0;
     #4#17 = "SIN DATOS";
     #4#19 = "";

     |SI #4#3 = 130;  |O #4#3 = 131;  |O #4#3 = 310;  |O #4#3 = 300;
                      |O #4#3 = 123;  |O #4#3 = 216;
         |HAZ PideJusti;
     |FINSI;

     |GRABA 020#4n;
     |LIBERA #4;

     |SI #4#3 = 390;  |O #4#3 = 392;
         enEmpresa     = #4#0;
         enEjer        = #4#1;
         enPeriodo     = #4#2;
         enModelo      = #4#3;
         enComplem     = #4#4;
         enActividad   = 0;
         enDComple     = 0;
         enHComple     = 0;
         |HAZ TraeModelo;
     |FINSI;
|FPRC;

|PROCESO CambiaPago;
     nCambio = 0;
     |HAZ UltimoPeriodo;
     #4#16 = eaUltimoPer;

     aAlfa = "0000NEl Importe es a " + #4#16;  |QBF aAlfa;
     aAlfa = aAlfa + ", desea cambiarlo ";

     |CONFI aAlfa;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #4#9 = "X";
         |CONFI "0000NModelo ya impreso, desea continuar";
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     |ABRE #5;
     #5#0 = #4#3;
     |LEE 000#5=;
     |SI FSalida ! 0;  |DDEFECTO #5;  |FINSI;
     |CIERRA #5;

     |ABRE #6;
     #6#0 = #4#0;
     #6#1 = #4#3;
     |LEE 101#6=;
     |SI FSalida ! 0;
         #6#0 = #4#0;
         #6#1 = #4#3;
         #6#2 = #5#1;
         #6#3 = #5#2;
         #6#4 = #5#3;
         #6#5 = #5#4;
         #6#6 = #5#5;
         #6#7 = #5#6;
         #6#8 = #5#7;
         #6#9 = #5#8;
         |GRABA 020#6b;
     |FINSI;

     |SI #4#16 = "COMPENSAR";
         #6#12 = "DEVOLVER";
     |SINO;
         #6#12 = "COMPENSAR";
     |FINSI;

     |GRABA 020#6a;
     |LIBERA #6;

     |ABRE #8;
     #8#0 = #4#0;
     #8#1 = #4#1;
     #8#2 = #4#2;
     #8#3 = #4#3;
     #8#4 = #4#4;
     #8#5 = 0;
     |LEE 040#8=;
     |SI FSalida ! 0;  |DDEFECTO #8;  #8#12 = #4#3;  |FINSI;
     |CIERRA #8;

     enEmpresa     = #4#0;
     enEjer        = #4#1;
     enPeriodo     = #4#2;
     enModelo      = #4#3;
     enComplem     = #4#4;
     enActividad   = 99;
     enDComple     = 0;
     enHComple     = 0;
     enTipoEntrada = 91;
     enResultado   = #4#15;

     |SI #4#3 = 370;  enActividad = 0;  |FINSI;

     |HAZ EntraModelo;

     |LEE 101#4=;
     |SI FSalida = 0;
         |SI #4#9 = "X";
             |HAZ BorraElHis;
             |SI nSwBoton13 = 1;
                 aOrigen =  aPathPdf;
                 |FBORRA aOrigen;
             |FINSI;
         |FINSI;

         #4#7  = "X";
         #4#8  = ~;
         #4#9  = "";
         #4#10 = "01.01.0000";
         #4#15 = enResultado;
         #4#17 = "COMPLETADO";

         |HAZ UltimoPeriodo;
         #4#16 = eaUltimoPer;

         |GRABA 020#4a;
         |LIBERA #4;
     |FINSI;
     nCambio = 1;
|FPRC;

|PROCESO Tipo11m004;  |TIPO 11;
     nTecla = FSalida;

     |HAZ FinBotonm004;

     |SI #4#3 ] 900;  |ACABA;  |FINSI;

     enEmpresa     = #4#0;
     enEjer        = #4#1;
     enPeriodo     = #4#2;
     enModelo      = #4#3;
     enComplem     = #4#4;
     enActividad   = 0;
     enDComple     = 0;
     enHComple     = 0;

|| \\\\\ Consulta Modelos ////////

     |SI nTecla = 10;  |Y nSwBoton2 = 1;
         |ABRE #8;
         #8#0 = #4#0;
         #8#1 = #4#1;
         #8#2 = #4#2;
         #8#3 = #4#3;
         #8#4 = #4#4;
         #8#5 = 0;
         |LEE 040#8=;
         |SI FSalida ! 0;  |DDEFECTO #8;  #8#12 = #4#3;  |FINSI;
         |CIERRA #8;

         enTipoEntrada = 4;

         |HAZ EntraModelo;
         |HAZ Refresco;
     |FINSI;

|| \\\\\ Alta o Modificacion Modelos ////////

     |SI nTecla = 11;  |Y nSwBoton3 = 1;
         |HAZ AltaModelo;
         |HAZ Refresco;
         |ACABA;
     |FINSI;

|| \\\\\ Visusalizacion Prorrata

     |SI nTecla = 12;  |Y nSwBoton4 = 1;
         |SI #4#3 = 300;  |O #4#3 = 370;  |O #4#3 = 320;
          |O #4#3 = 330;  |O #4#3 = 332;
             enTipoEntrada = 4;
             aCm9  = #4#9;
             aCm11 = #4#11;
             aCm13 = #4#13;
             |SUB_EJECUTA_NP "dsmom027";
             |HAZ Refresco;
         |FINSI;
     |FINSI;

|| \\\\\ Visusalizacion Prescripciones

     |SI nTecla = 13;  |Y nSwBoton5 = 1;
         |SI #4#3 = 300;  |O #4#3 = 370;  |O #4#3 = 320;
          |O #4#3 = 330;  |O #4#3 = 332;  |O #4#3 = 310;
             enTipoEntrada = 4;
             |SUB_EJECUTA_NP "dsmom028";
             |HAZ Refresco;
         |FINSI;
     |FINSI;

|| \\\\\ Emision del Modelo

     |SI nTecla = 14;  |Y nSwBoton6 = 1;
         |SI #4#7 = "X";
             |SI #4#13 = "X";
                 |CONFI "0000NModelo Archivado. Desea continuar";
                 |SI FSalida ! 0;  |ACABA;  |FINSI;
             |FINSI;

             |SUB_EJECUTA_NP "dsmoy000;PLANING";
             |HAZ Refresco;
         |FINSI;
     |FINSI;

|| \\\\\ Recoge Modelo desde Registro

     |SI nTecla = 15;  |Y nSwBoton7 = 1;
         |HAZ TraeModelo;
         |HAZ Refresco;
     |FINSI;

|| \\\\\ Baja del Modelo ////////

     |SI nTecla = 16;  |Y nSwBoton8 = 1;
         |HAZ BajaModelo;
         |HAZ Refresco;
     |FINSI;

|| \\\\\ Creacion de Complementaria del Modelo ////////

     |SI nTecla = 17;  |Y nSwBoton9 = 1;
         |SI #4#3 = 347;  |O #4#3 = 190;  |O #4#3 = 180; |O #4#3 = 184;
          |O #4#3 = 110;  |O #4#3 = 115;  |O #4#3 = 390; |O #4#3 = 392;
          |O #4#3 = 193;  |O #4#3 = 349;  |O #4#3 = 370; |O #4#3 = 300;
          |O #4#3 = 320;  |O #4#3 = 330;  |O #4#3 = 332; |O #4#3 = 130;
          |O #4#3 = 131;  |O #4#3 = 310;  |O #4#3 = 123; |O #4#3 = 216;
          |O #4#3 = 296;
             aCoBien = "N";
             |SI #4#3 = 130; |O #4#3 = 131;  |HAZ eComprobarCom; |FINSI;
             |SI aCoBien = "S";
                 aAlfa = #4#3;
                 aAlfa = "    No disponible Complementaria del Modelo " + aAlfa + " para Comunidad";
                 |MENAV aAlfa;
                 |MENAV "    Regularice en el proximo trimestre";
             |SINO;
                 |CONFI "     Estas seguro de crear una Complementaria : ";
                 |SI FSalida = 0;
                     |HAZ Complementaria;
                     |HAZ Refresco;
                  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

|| \\\\\ Dejar no Impreso ////////

     |SI nTecla = 18;  |Y nSwBoton10 = 1;
         |SI #4#9 = "X";  |Y #4#13 = " ";
             aAlfa =  "0000NEsta seguro de dejar el Modelo como no Impreso";
             |SI #4#3 = 130; |O #4#3 = 131;
                 aCoBien = "";
                 |HAZ eComprobarCom;
                 |SI aCoBien = "S";
                     aAlfa = "    NEsta seguro de dejar el Modelo de la COMUNIDAD como no Impreso";
                 |FINSI;
             |FINSI;
             |CONFI aAlfa;
             |SI FSalida ! 0;  |ACABA;  |FINSI;
             |LEE 101#4=;
             #4#9 = "";
             #4#10 = "01.01.0000";
             |GRABA 020#4a;
             |LIBERA #4;
             |PINTA #4#9;

             |HAZ BorraElHis;

             |SI nSwBoton13 = 1;
                 aOrigen =  aPathPdf;
                 |FBORRA aOrigen;
             |FINSI;
         |FINSI;
     |FINSI;

|| \\\\\ Numero de Justificante ////////

     |SI nSwBoton12 = 1;
         |SI nTecla = 9;  |O nTecla = 20;
             |SI #4#9 = "X";
                 |PUSHV 0501 2380;
                 |BLANCO 1439 1867;
                 |CUADRO 1439 1867;

                 |PINTA 1540, "   NUMERO DE JUSTIFICANTE  ";
                 |PINTA 1640, "---------------------------";

                 E_inf  = "";
                 E_sup  = "13";

                 aJusti = #4#19;
                 aJusti = 1747 ? 1;
                 |LEE 101#4=;
                 #4#19 = aJusti;
                 |GRABA 020#4a;
                 |LIBERA #4;
                 |POPV;
             |FINSI;
         |FINSI;
     |FINSI;

|| \\\\\ Editar Documento PDF ////////

     |SI nTecla = 21;  |Y nSwBoton13 = 1;
         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         aDirRemoto = "\MODELOS";                       |RMKDIR aDirRemoto;
         aDirRemoto = "\MODELOS\" + #4#3;               |RMKDIR aDirRemoto;
         aDirRemoto = "\MODELOS\" + #4#3 + "\" + #4#1;  |RMKDIR aDirRemoto;
         aDirRemoto = "\MODELOS\" + #4#3 + "\" + #4#1 + "\";

         |DBASE aBase;  |QBF aBase;

         aOrigen    = aBase + "modelospdf/wait.exe";
         aDestino   = aDirRemoto + "wait.exe";
         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;

         aOrigen    =  aPathPdf;
         aDestino   =  aDirRemoto + #4#3 + (("00000" + #4#0) % -105) + ".pdf";
         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;

         |HAZ LocalizaAcrobat;

         aAbre = aDirRemoto + "imprime.bat";
         |XABRE "CBW", aAbre, nHandle;

         aAlfa = "CD " + aDirRemoto + &13 + &10;
         |XGRABA nHandle, aAlfa;

         aAlfa = "wait " + eaPathAcrobat + " " + #4#3 + (("00000" + #4#0) % -105) + ".pdf";

         |XGRABA nHandle, aAlfa;

         |XCIERRA nHandle;

         |RSYSTEM aAbre;

         |RFBORRA aAbre;
         |RFBORRA aDestino;

         aDestino   = aDirRemoto + "wait.exe";
         |RFBORRA aDestino;
     |FINSI;

     |SI nTecla = 23;  |Y nSwBoton15 = 1;
         |SI #4#3 = 300;  |O #4#3 = 370;  |O #4#3 = 320;
          |O #4#3 = 330;  |O #4#3 = 332;
             enTipoEntrada = 4;
             |SUB_EJECUTA_NP "dsmom047";
             |HAZ Refresco;
         |FINSI;
     |FINSI;

     |SI nTecla = 24;  |Y nSwBoton16 = 1;
         |SI #4#3 = 300;  |O #4#3 = 370;  |O #4#3 = 310;
             |O #4#3 = 320;  |O #4#3 = 330;  |O #4#3 = 332;
             |HAZ CambiaPago;
             |HAZ Refresco;
             |SI nCambio = 1;  |HAZ QuieresPasar390;  |FINSI;
         |FINSI;
     |FINSI;

|| \\\\\ Archivar o Desarchivar  ////////

     |SI nTecla = 25;  |Y nSwBoton17 = 1;
         |SI #4#13 = "X";
             |CONFI "0000NEsta seguro de dejar el Modelo como no Archivado";
             |SI FSalida ! 0;  |ACABA;  |FINSI;
             |LEE 101#4=;
             #4#13 = "";
             #4#14 = "01.01.0000";
             |GRABA 020#4a;
             |LIBERA #4;
             |PINTA #4#13;
         |SINO;
             |CONFI "0000NDesea Archivar el Modelo ";
             |SI FSalida = 0;
                 aAlfa = #4#3;
                 aAlfa = "dsmoz007;" + aAlfa + "PLANING";
                 |SUB_EJECUTA_NP aAlfa;
                 |HAZ Refresco;
             |FINSI;
         |FINSI;
     |FINSI;

|| \\\\\ Archivar o Desarchivar  ////////
     |SI nTecla = 27;  |Y nSwBoton18 = 1;
        |SUB_EJECUTA_NP "dsmom900";
        |HAZ Refresco;
     |FINSI;
|FPRC;

|PROCESO BorraElHis;
    |ABRE #24;
    #24#0 = #4#0;
    #24#1 = #4#1;
    #24#2 = #4#2;
    #24#3 = #4#3;
    #24#4 = #4#4;
    |LEE 040#24=;
    |SI FSalida = 0;
        |BORRA 020#24a;
        |CIERRA #24;
        enDEmpresa = #24#0; enHEmpresa = #24#0;
        enDEjer    = #24#1; enHEjer    = #24#1;
        enDModelo  = #24#3; enHModelo  = #24#3;;
        |HAZ ReCalculaHis;
    |SINO;
        |CIERRA #24;
    |FINSI;
    |SI #4#3 = 300;  |O #4#3 = 370;  |O #4#3 = 320;
        |O #4#3 = 330;  |O #4#3 = 332;
            |ABRE #82;
            #82#0 = #4#0;
            #82#1 = #4#1;
            #82#2 = #4#2;
            |LEE 141#82=;
            |SI FSalida = 0;
                #82#61 = "S";
                |GRABA 020#82a;
            |FINSI;
            |LIBERA #82;
            |CIERRA #82;
    |FINSI;
|FPRC;
