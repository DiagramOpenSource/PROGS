|FICHEROS;
     dsmom014 #14;

     :/modelos/def/dsmom100 #100;

     :/contagen/def/cacuenta #2;
     :/contagen/def/ca8cumay #3;
|FIN;

|VARIABLES;
     aAlfa       = "";
     aAlfa1      = "";

     nCuenta     = 0;

     &eaTabla    = "";
     &eaAlfa     = "";
     &eaDestino  = "";
     &enPosicion = 0;
     &enComp     = 0;
     &enError    = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO AntesCuenta; |TIPO 7;
     |C_M #14#1,1,"N";
     |SI nCuenta = 1;  |C_M #14#1, 1, "S"; |FINSI;
|FPRC;

|PROCESO LeeLaCuenta;
     |SI nCuenta = 1; |ACABA; |FINSI;

     |SI enPlan = 1990;
         |ABRE #2;
         #2#0 = #14#0;
         |LEE 001#2=;
         |SI FSalida ! 0;
             |MENAV "    Error No Existe Cuenta ";
             |ERROR;
         |FINSI;
         |CIERRA #2;
         #14#1 = #2#2;
    |FINSI;

    |SI enPlan = 2008;
        |C_M #14#1,1,"N";
        |ABRE #3;
        #3#10 = 0;
        #3#0  = #14#0;
        |LEE 000#3=;
        |SI FSalida ! 0;
            |C_M #14#1,1,"S";
            |MENAV "    Error No Existe Cuenta ";
            |DDEFECTO #3;
        |FINSI;
        |CIERRA #3;
        #14#1 = #3#1;
    |FINSI;

    |PINTA #14#1;
|FPRC;

|RUTINA ClaveBaja14;
     #14#10 = enPlan;
     #14#0  = "    ";
|FRUT;

|RUTINA ClaveAlta14;
     #14#10 = enPlan;
     #14#0  = "zzzz";
|FRUT;

|PROCESO LeeTabla; |TIPO 7;
     |SI Campo = 7;  eaTabla = "ztabla06.txt";  |FINSI;
     |SI Campo = 8;  eaTabla = "ztabla07.txt";  |FINSI;
     |SI Campo = 9;  eaTabla = "ztabla08.txt";  |FINSI;
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompTabla;  |TIPO 0;
     |SI FSalida = 10;
         enPosicion = 15;
         |HAZ SacaTabla;

         aAlfa1    = eaDestino % 102;
         #14Campo  = aAlfa1;
         |PINTA #14Campo;
     |FINSI;

     enComp = 2;
     eaAlfa = ("00" + #14Campo) % -102;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |PULSATECLA;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 102;
     #14Campo = aAlfa1;

     |PINTA #14Campo;

     |HAZ FinTabla;
|FPRC;

|PROGRAMA;
     nCuenta = 0;
     |SI enPlan = 1990;
         |ABRE #100;
         |LEE 040#100p;
         |SI FSalida ! 0;
             |MENAV "    No esta configurada las Empresas Maestras de Contabilidad";
             nCuenta = 1;
         |FINSI;
         |CIERRA #100;

         enEmpresa  = #100#1;
         enPerConta = #100#2;
         |HAZ LeeEmpConta;
         |PATH_DAT #2 aPathConta;
     |FINSI;

     |CLS;
     |ENTLINEAL #1#14, -2, 2, 22, 1, ClaveBaja14, ClaveAlta14;
|FPRO;
