|FICHEROS;
     dsmo1347 #1;
     dsmo2347 #2;

     &regisnif@ #709;
     reflejo@   #22;
|FIN;

|VARIABLES;
     nMax        = 0;

     aMenav      = "";
     aPathModelo = "";
     aDef        = "";
     aAlfa       = "";
|FIN;

|INCLUYE i_variar;

|PROCESO PintaClave;
     |ATRI S;
     |PINTA 0835, eaClave347;
     |SI eaClave347 = "A";  |PINTA 0839, #1#6;   |PINTA 0845, #1#7;  |FINSI;
     |SI eaClave347 = "B";  |PINTA 0839, #1#8;   |PINTA 0845, #1#9;  |FINSI;
     |SI eaClave347 = "C";  |PINTA 0839, #1#10;  |PINTA 0845, #1#11; |FINSI;
     |SI eaClave347 = "D";  |PINTA 0839, #1#12;  |PINTA 0845, #1#13; |FINSI;
     |SI eaClave347 = "E";  |PINTA 0839, #1#14;  |PINTA 0845, #1#15; |FINSI;
     |SI eaClave347 = "F";  |PINTA 0839, #1#20;  |PINTA 0845, #1#21; |FINSI;
     |SI eaClave347 = "G";  |PINTA 0839, #1#22;  |PINTA 0845, #1#23; |FINSI;
     |ATRI s;
|FPRC;

|PROCESO Arrendamiento;
     |SI #2#6 = "B";  |Y #2#9 = "S";
         |MENAV "     Introduzca el Arrendamiento por el Apartado de Arrendamientos.";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO PonDatosNif;  |TIPO 7;
     eaCodNif  = #2#7;
     |HAZ LeeNifs;

     #2#11 = #709#1;   |PINTA #2#11;
|FPRC;

|PROCESO Importe;
     |HAZ LeeEURODBMOD;

     |SI EURODBMOD = 0;
         nMax = 500000;
         |SI #2#6 = "C";                 nMax = 50000;   |FINSI;
         |SI #2#6 = "B"; |Y #2#9 = "S";  nMax = 0;       |FINSI;
         |SI #2#6 = "F";                 nMax = 0;       |FINSI;
         |SI #2#6 = "G";                 nMax = 0;       |FINSI;
     |SINO;
         nMax = 3005.06;
         |SI #2#6 = "C";                 nMax = 300.51;  |FINSI;
         |SI #2#6 = "B"; |Y #2#9 = "S";  nMax = 0;       |FINSI;
         |SI #2#6 = "F";                 nMax = 0;       |FINSI;
         |SI #2#6 = "G";                 nMax = 0;       |FINSI;
     |FINSI;

     |SI #2#12 < nMax;
         aMenav = "     Introduzca Importe igual o superior a " + nMax;
         |MENAV aMenav;
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tipo2mo2347;  |TIPO 2;
     |SI #2#6 = "A";
         #1#6 = #1#6 +. 1;
         #1#7 = #1#7 +. #2#12;
     |FINSI;

     |SI #2#6 = "B";
         #1#8 = #1#8 +. 1;
         #1#9 = #1#9 +. #2#12;
     |FINSI;

     |SI #2#6 = "C";
         #1#10 = #1#10 +. 1;
         #1#11 = #1#11 +. #2#12;
     |FINSI;

     |SI #2#6 = "D";
         #1#12 = #1#12 +. 1;
         #1#13 = #1#13 +. #2#12;
     |FINSI;

     |SI #2#6 = "E";
         #1#14 = #1#14 +. 1;
         #1#15 = #1#15 +. #2#12;
     |FINSI;

     |SI #2#6 = "F";
         #1#20 = #1#20 +. 1;
         #1#21 = #1#21 +. #2#12;
     |FINSI;

     |SI #2#6 = "G";
         #1#22 = #1#22 +. 1;
         #1#23 = #1#23 +. #2#12;
     |FINSI;

     |HAZ PintaClave;
|FPRC;

|RUTINA ClaveBaja22;
     #22#0  = #1#0;
     #22#1  = #1#1;
     #22#2  = #1#2;
     #22#3  = #1#3;
     #22#4  = #1#4;
     #22#5  = #1#5;
     #22#6  = eaClave347;
     #22#11 = " ";
     #22#8  = "N";
     #22#9  = "N";
|FRUT;

|RUTINA ClaveAlta22;
     #22#0  = #1#0;
     #22#1  = #1#1;
     #22#2  = #1#2;
     #22#3  = #1#3;
     #22#4  = #1#4;
     #22#5  = #1#5;
     #22#6  = eaClave347;
     #22#11 = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     #22#8  = "S";
     #22#9  = "S";
|FRUT;

|PROCESO Tipo11mo2347;  |TIPO 11;
     |SI FSalida = 10;
         eaVarDni  = #2Campo;
         enCalcCif = 1;
         |HAZ CalculameDNI;
         #2Campo = eaVarDni;
         |PINTA #2Campo;
         |ERROR;
     |FINSI;

     |SI FSalida = 11;
         |DBASE aPathModelo;  |QBT aPathModelo;
         aDef = aPathModelo + "def/dsmo2347.mas";
         |CARGA_DEF aDef, reflejo@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dsmo2347.mas";
             |MENAV aAlfa;
             |ERROR;
         |FINSI;

         |PUSHV 0501 2380;
         |ATRI P;
         |PINTA 0703, "MODO CONSULTA";
         |PINTA 0803, "ORDENADO POR NOMBRE";
         |ATRI p;
         |ENTLINEAL #2#22, -8, 4, 22, 0, ClaveBaja22, ClaveAlta22;
         |POPV;

         |DESCARGA_DEF #reflejo@;

         |ERROR;
     |FINSI;
|FPRC;

|PROCESO MiraDnimo2347;  |TIPO 6;
     eaVarDni  = #2Campo;
     enCalcCif = 0;
     |HAZ CalculameDNI;
     eaVarDni = (eaVarDni + "             ") % 112;
     |SI #2Campo ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #2Campo = eaVarDni;  |PINTA #2Campo;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;
