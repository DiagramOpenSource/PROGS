|FICHEROS;
     dsm190li #191;
     dsmom026 #26;
     dsmom030 #30;

     :/basica/def/agidanif #3;
     :/laboral/def/labtraba #100;
     :/laboral/def/nomir003 #101;
     :/laboral/def/nomhicca #201;
     :/laboral/def/nomauto2 #202;
     :/laboral/def/nomnotay #215;

     &regisnif@ #709;

     :/contagen/def/canempre #330;
     :/contagen/def/camaniva #302;
     :/contagen/def/caivalin #303;
     :/contagen/def/caivaasi #304;

     :/basica/def/agitab99   #99;
|FIN;

|VARIABLES;
      aAlfa         = "";

      aCadena       = "";
      aCadena1      = "";
      aCadena2      = "";
      aCadena3      = "";
      aCaracter     = "";
      aLongAlfa     = "";
      aParaQuitar   = "";
      aPathLaboral  = "";
      aFichLaboral  = "";
      aBase         = "";
      aNif          = "";

      nBlanco1      = 0;
      nBlanco2      = 0;
      nComa         = 0;
      nPara         = 0;
      nPosi         = 0;
      nLongNume     = 0;
      nCanal        = 0;
      nEjer         = 0;
      nLinea        = 0;
      nCampo        = 0;
      nCampo1       = 0;
      nCampo2       = 0;
      nAnyo         = 0;
      nEdad         = 0;
      nEdadAdop     = 0;
      nEmpresa      = 0;
      nEmpresaTrab  = 0;
      nDTipo        = 0;
      nHTipo        = 0;
      nError        = 0;
      nGrupos       = 0;
      ded_not       = 0;
      notaria       = 0;

      &enError      = 0;
      nSw           = 0;
      aElDef        = "";
|FIN;

|INCLUYE i_variar;

|PROCESO QuitaBlanco;
     |ET aCadena;
         |QBF aParaQuitar;
         |SI aParaQuitar ! "";
             aCaracter = aParaQuitar % 101;
             |SI aCaracter = " ";
                 aParaQuitar = aParaQuitar % 240;
                 |VETE aCadena;
             |FINSI;
         |FINSI;
|FPRC;

|PROCESO SeparaNombre;
     || Busca una coma en la aCadena

     aCadena1 = "";
     aCadena2 = "";
     aCadena3 = "";

     nBlanco1 = 0;
     nBlanco2 = 0;
     nComa    = 0;

     |PARA nPara = 1; |SI nPara [ 40; |HACIENDO nPara = nPara + 1;
           nPosi = nPara * 100 + 1;
           aCaracter = aCadena % nPosi;

           |SI aCaracter = ","; nComa = nPara; |SAL; |FINSI;
     |SIGUE;

     |SI nComa = 0;
         || Si no hay coma busca el primer blanco empezando por detras

         aLongAlfa = aCadena % 0;
         nLongNume = aLongAlfa;

         |PARA nPara = nLongNume; |SI nPara ] 1; |HACIENDO nPara = nPara - 1;
               nPosi = nPara * 100 + 1;
               aCaracter = aCadena % nPosi;
               |SI aCaracter = " "; nComa = nPara; |SAL; |FINSI;
         |SIGUE;
     |FINSI;

     || Coge los dos primeros aCaracteres del segundo apellido

     nBlanco1  = nComa - 1;
     nPosi     = nBlanco1 + 100;
     aCadena2  = aCadena % nPosi;
     aLongAlfa = aCadena2 % 0;
     nLongNume = aLongAlfa;

     |PARA nPara = nLongNume; |SI nPara ] 1; |HACIENDO nPara = nPara - 1;
           nPosi = nPara * 100 + 1;
           aCaracter = aCadena2 % nPosi;
           |SI aCaracter = " "; nBlanco1 = nPara; |SAL; |FINSI;
     |SIGUE;

     nBlanco1 = nBlanco1 + 1;
     nPosi    = nBlanco1 * 100 + nLongNume;
     aCadena2 = aCadena2 % nPosi;

     || Coge las dos primeros caracteres del primer apellido

     nBlanco1 = nBlanco1 - 1;
     nPosi    = 100 + nBlanco1;
     aCadena1 = aCadena % nPosi;

     || Recoge los dos primero aCaracteres de Nombre

     nPosi    = ((nComa + 1) * 100) + 40;
     aCadena3 = aCadena % nPosi;

     aParaQuitar = aCadena1; |HAZ QuitaBlanco; aCadena1 = aParaQuitar;
     aParaQuitar = aCadena2; |HAZ QuitaBlanco; aCadena2 = aParaQuitar;
     aParaQuitar = aCadena3; |HAZ QuitaBlanco; aCadena3 = aParaQuitar;

     |QBF aCadena1;
     |QBF aCadena2;
     |QBF aCadena3;
|FPRC;

|PROCESO DatosConyuge;
     #3#0 = #191#6;
     #3#1 = 99;
     |LEE 010#3];
     |SI FSalida = 0;
         |LEE 040#3a;
     |SINO;
         |LEE 040#3u;
     |FINSI;

     nLinea = 1;
     |SI FSalida = 0;  |Y #3#0 = #191#6;
         nLinea = #3#1 + 1;
     |FINSI;

     eaCodNif  = aNif;
     |HAZ LeeNifs;

     |DDEFECTO #3;
     #3#0  = #191#6;
     #3#1  = nLinea;
     #3#2  = "CONYUGE";
     #3#8  = aNif;
     #3#12 = #709#1;
     #3#19 = #709#14;
     #3#24 = #709#9;
     #3#25 = #709#2;
     #3#26 = #709#3;
     #3#27 = #709#16;
     #3#28 = #709#10;
     #3#29 = #709#11;
     #3#30 = #709#4;
     #3#31 = #709#5;
     #3#32 = #709#6;
     #3#33 = #709#7;
     #3#34 = #709#8;

     aCadena = #3#12;
     |HAZ SeparaNombre;
     #3#9    = aCadena1;
     #3#10   = aCadena2;
     #3#11   = aCadena3;
     #3#14   = "C";
     #3#37   = "S";

     |GRABA 020#3n;
|FPRC;

|PROCESO DatosDescendiente;
     #3#0 = #191#6;
     #3#1 = 99;
     |LEE 010#3];
     |SI FSalida = 0;
         |LEE 040#3a;
     |SINO;
         |LEE 040#3u;
     |FINSI;

     nLinea = 0;
     |SI FSalida = 0;  |Y #3#0 = #191#6;
         nLinea = #3#1;
     |FINSI;

     |PARA nCampo = 20;  |SI nCampo [ 29;  |HACIENDO nCampo = nCampo + 1;
           nCampo1 = nCampo + 10;
           nCampo2 = nCampo + 22;

           |SI #101nCampo ! 0;
               nLinea  = nLinea + 1;

               |DDEFECTO #3;
               #3#0  = #191#6;
               #3#1  = nLinea;
               #3#2  = "DESCENDIENTE";

               |SI #101nCampo2 = "S";  #3#3 = "1";  |FINSI;

               #3#12 = "POR ACTUALIZAR";
               aAlfa = "01.01." + #101nCampo;
               #3#13 = aAlfa;
               |SI #101nCampo1 = "1";
                   #3#17 = 33;
               |FINSI;
               |SI #101nCampo1 = "2";
                   #3#17 = 65;
               |FINSI;
               |GRABA 020#3n;
               |LIBERA #3;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO DatosAscendiente;
     #3#0 = #191#6;
     #3#1 = 99;
     |LEE 010#3];
     |SI FSalida = 0;
         |LEE 040#3a;
     |SINO;
         |LEE 040#3u;
     |FINSI;

     nLinea = 0;
     |SI FSalida = 0;  |Y #3#0 = #191#6;
         nLinea = #3#1;
     |FINSI;

     |PARA nCampo = 52;  |SI nCampo [ 61;  |HACIENDO nCampo = nCampo + 1;
           nCampo1 = nCampo + 10;
           nCampo2 = nCampo + 43;

           |SI #101nCampo2 ! 0;
               nLinea  = nLinea + 1;

               |DDEFECTO #3;
               #3#0  = #191#6;
               #3#1  = nLinea;
               #3#2  = "ASCENDIENTE";
               #3#3  = "1";
               #3#5  = #101nCampo;

               #3#12 = "POR ACTUALIZAR";

               |SI #101nCampo1 = "1";
                   #3#17 = 33;
               |FINSI;

               |SI #101nCampo1 = "2";
                   #3#17 = 65;
               |FINSI;
               |GRABA 020#3n;
               |LIBERA #3;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO nomauto2;
     |ABRE #nomauto2;
     #nomauto2#0 = #100#0;
     #nomauto2#1 = #100#1;
     #nomauto2#2 = nEjer + 2000;
     |LEE 000#nomauto2.=;
     |SI FSalida = 0;
          |PARA nCampo = 4; |SI nCampo [ 26; |HACIENDO nCampo = nCampo + 2;
               enImporte2 = enImporte2 + #nomauto2#nCampo#;
          |SIGUE;
     |FINSI;
     |CIERRA #nomauto2;
|FPRC;

|PROCESO nomhiccaP;
     |ABRE #215;
     #215#0 = nEmpresa;
     #215#1 = #100#77;
     |LEE 000#215=;
     |SI FSalida ! 0;
         #215#2 = 0;       || (%) a cero
     |FINSI;
     notaria = #215#2;
     |CIERRA #215;

     ded_not      = (#201#48 < notaria) ! 2;
     enImporte2   = enImporte2 + (ded_not + #201#49 + #201#50 + #201#51);

     nEmpresaTrab = #100#0;
|FPRC;

|DEFBUCLE nomhiccaP;
     #201#1;
     ;
     #100#0, #100#1, nEjer, 01, nDTipo;
     #100#0, #100#1, nEjer, 12, nHTipo;
     ;
     NULL, nomhiccaP;
|FIN;

|PROCESO labtraba;
     aAlfa   = #191#1;
     aAlfa   = aAlfa % -102;
     nEjer   = aAlfa;
     nDTipo  = 0;
     nHTipo  = 9;

     |SI #191#7 ! 0;
         nDTipo = 5;
         nHTipo = 9;
         aAlfa  = #191#7;
         aAlfa  = aAlfa % -102;
         nEjer  = aAlfa;
     |FINSI;

     nEmpresaTrab = #100#0;
     |BUCLE nomhiccaP;
     |SI #100#42 = "H";
          |HAZ nomauto2;
     |FINSI;
|FPRC;

|DEFBUCLE labtraba;
     #100#5;
     ;
     nEmpresa, #191#6;
     nEmpresa, #191#6;
     ;
     NULL, labtraba;
|FIN;

|PROCESO MiraGrupos;
     |ABRE #100;
     |SELECT #5#100;
     #100#0 = #26#1;
     #100#7 = #191#6;
     |LEE 040#100=;
     |SI FSalida = 0;
        |CIERRA #100;
        nGrupos      = 1;
        nEmpresa     = #100#0;
        nEmpresaTrab = 0;
        |BUCLE labtraba;
     |SINO;
        |CIERRA #100;
     |FINSI;
|FPRC;

|DEFBUCLE dsmom026;
     #26#1;
     ;
     #191#0, 00001;
     #191#0, 99999;
     ;
     NULL, MiraGrupos;
|FIN;

|PROCESO DesdeLaboral;
     nGrupos   = 0;

     aFichLaboral = aPathLaboral + "fich/";
     |PATH_DAT #101 aFichLaboral;
     |PATH_DAT #201 aFichLaboral;
     |PATH_DAT #202 aFichLaboral;
     |PATH_DAT #215 aFichLaboral;

     |ABRE #26;
     #26#0 = #191#0;
     #26#1 = 0;
     |LEE 040#26];
     |SI FSalida = 0;  |Y #26#0 = #191#0;
         |CIERRA #26;
         enImporte2 = 0;
         |BUCLE dsmom026;

         |SI nGrupos = 0;
             nEmpresa     = #191#0;
             nEmpresaTrab = #191#0;
             |ABRE #100;
             |SELECT #5#100;
             #100#0    = #191#0;
             #100#7    = #191#6;
             |LEE 040#100=;
             |SI FSalida ! 0;  |DDEFECTO #100; |FINSI;
             |CIERRA #100;
         |FINSI;
     |SINO;
         |CIERRA #26;

         nEmpresa     = #191#0;
         nEmpresaTrab = #191#0;

         |ABRE #100;
         |SELECT #5#100;
         #100#0       = #191#0;
         #100#7       = #191#6;
         |LEE 040#100=;
         |SI FSalida ! 0;  |DDEFECTO #100; |FINSI;
         |CIERRA #100;
     |FINSI;

     eaCodNif  = #191#6;
     |HAZ LeeNifs;

     |ABRE #709;
     #709#0 = #191#6;
     |LEE 101#709=;
     |SI FSalida ! 0;
         |DDEFECTO #709;
         #709#0 = #191#6;
         #709#1 = #100#2;
         #709#4 = #100#8;
         |GRABA 020#709n;
         |LIBERA #709;
     |FINSI;
     |CIERRA #709;

     #3#0 = #191#6;
     #3#1 = 1;
     |LEE 010#3=;
     |SI FSalida ! 0;
         eaCodNif  = #191#6;
         |HAZ LeeNifs;

         |DDEFECTO #3;
         #3#0  = #191#6;
         #3#1  = 1;
         #3#2  = "TITULAR";
         #3#8  = #191#6;
         #3#12 = #709#1;
         #3#19 = #709#14;
         #3#24 = #709#9;
         #3#25 = #709#2;
         #3#26 = #709#3;
         #3#27 = #709#16;
         #3#28 = #709#10;
         #3#29 = #709#11;
         #3#30 = #709#4;
         #3#31 = #709#5;
         #3#32 = #709#6;
         #3#33 = #709#7;
         #3#34 = #709#8;

         aCadena = #3#12;
         |HAZ SeparaNombre;
         #3#9    = aCadena1;
         #3#10   = aCadena2;
         #3#11   = aCadena3;
         #3#37   = "S";

         |GRABA 020#3b;
     |FINSI;

     |ABRE #100;
     |SELECT #5#100;
     #100#0 = nEmpresaTrab;
     #100#7 = #191#6;
     |LEE 040#100=;
     |SI FSalida ! 0;
         |DDEFECTO #100;
         |GRABA 020#3a;
         |LIBERA #3;
         |ACABA;
     |FINSI;
     |CIERRA #100;

     eaCodNif  = #191#6;
     |HAZ LeeNifs;
     aAlfa = #709#1;  |QBT aAlfa;
     |SI aAlfa = "";
         #3#12 = #100#2;

         |ABRE #709;
         #709#0 = #191#6;
         |LEE 101#709=;
         |SI FSalida = 0;
             #709#1 = #100#2;
             #709#4 = #100#8;
             |GRABA 020#709a;
             |LIBERA #709;
         |FINSI;
         |CIERRA #709;
     |FINSI;

     enError = 0;
     |SI #3#13 = "01.01.0000";
         #3#13 = #100#11;
     |FINSI;

     ||#3#36   = #100#111;

     |ABRE #101;
     enImporte1 = 0;
     enImporte3 = 0;
     enImporte4 = 0;

     |SI nGrupos = 0;
         enImporte2 = 0;
         aAlfa   = #191#1;
         aAlfa   = aAlfa % -102;
         nEjer   = aAlfa;
         |BUCLE labtraba;
     |FINSI;

     nError = 0;
     |DDEFECTO #101;
     |PARA nEjer = #191#1;  |SI nEjer ] 2000;  |HACIENDO nEjer = nEjer - 1;
           #101#0  = #191#6;
           #101#40 = nEjer;
           #101#41 = #191#0;
           |LEE 040#101=;
           |SI FSalida = 0;
               |SI #101#40 = #191#1;
                   enImporte1 = #101#10;
                   enImporte3 = #101#13;
                   enImporte4 = #101#12;
                   |SI enImporte2 = 0; |Y #191#7 = 0;
                       enImporte2 = #101#11;
                   |FINSI;
               |FINSI;

               #3#15 = #101#3;
               #3#16 = #101#2;
               |SI #101#6 = "N";
                   #3#17 = 0;
                   #3#18 = "N";
               |SINO;
                   |SI #101#7 = "1";
                       #3#17 = 33;
                   |SINO;
                       #3#17 = 65;
                   |FINSI;

                   #3#18 = #101#8;
               |FINSI;
               |SI #101#14 = "N";  |O #101#14 = " ";  |O #101#14 = "1";
                   #3#23 = "";
               |SINO;
                   #3#23 = "1";
               |FINSI;
               nError = 0;
               |SAL;
           |SINO;
               nError = 1;
           |FINSI;
     |SIGUE;
     |CIERRA #101;

     |SI #3#15 = 1;
         #3#14 = "S";
     |FINSI;

     |SI #3#15 = 2;
         #3#14 = "C";
     |FINSI;

     |GRABA 020#3a;
     |LIBERA #3;

     |SI nError = 1;  |ACABA;  |FINSI;

     |SI #3#15 = 2;
         |SELECT #2#3;
         #3#0 = #191#6;
         #3#2 = "CONYUGE";
         |LEE 040#3=;
         |SI FSalida ! 0;
             nLinea = 0;
         |SINO;
             nLinea = #3#1;
         |FINSI;
     |FINSI;

     |SELECT #1#3;
     |SI nLinea = 0;  |Y #3#14 = "C";
         aNif = #101#4;  |QBF aNif;
         |SI aNif ! "";
             |HAZ DatosConyuge;
         |FINSI;
     |FINSI;

     |SELECT #2#3;
     #3#0 = #191#6;
     #3#2 = "DESCENDIENTE";
     |LEE 040#3=;
     |SI FSalida ! 0;
         nLinea = 0;
     |SINO;
         nLinea = #3#1;
     |FINSI;

     |SELECT #1#3;
     |SI nLinea = 0;
         aNif = #101#4;
         |HAZ DatosDescendiente;
     |FINSI;

     |SELECT #2#3;
     #3#0 = #191#6;
     #3#2 = "ASCENDIENTE";
     |LEE 040#3=;
     |SI FSalida ! 0;
         nLinea = 0;
     |SINO;
         nLinea = #3#1;
     |FINSI;

     |SELECT #1#3;
     |SI nLinea = 0;
         aNif = #101#4;
         |HAZ DatosAscendiente;
     |FINSI;
|FPRC;

||///////////////////////////////////
|PROCESO LeeLinea190;
     #30#0 = #303#18;
     |LEE 000#30=;
     |SI FSalida!0;
         #30#0 = #303#3;
         |LEE 000#30=;
         |SI FSalida!0;
             |ACABA;
         |FINSI;
     |FINSI;
     |SI #30#5  = "G";
         enImporte2 = enImporte2 + #303#11;  || sumo los descuentos S.Social
     |FINSI;
|FPRC;

|DEFBUCLE caivalin190;
     #303#1;
     ;
     #302#0, #302#1, 01;
     #302#0, #302#1, 99;
     e;
     NULL, LeeLinea190;
|FIN;

|PROCESO LeeCabecera190;
     |BUCLE caivalin190;
|FPRC;

|DEFBUCLE camaniva190;
     #302#1;
     14,36;
     00, 0000000000, aAlfa, "N";
     99, 9999999999, aAlfa, "N";
     e;
     NULL, LeeCabecera190;
|FIN;

|PROCESO PorContagen;
     aAlfa = #191#6 + "   "; || el nif en camaniva esta a longitud 15
     |SI enSwPartido = 0;
         |DBASS aPathConta;   |QBT aPathConta;
         aPathConta = aPathConta + "contagen/fich/" + (("00000" + #330#2) % -105) + #330#3 + "/";

         enEmpresa  = nEmpresa;
         enPerConta = #330#3;
         eaLaMonEmp = #330#28;
      |SINO;
         enPerConta = enPeriodoPar;
         eaLaMonEmp = "E";
      |FINSI;
      |HAZ EnConversor;

     |PATH_DAT #302 aPathConta;
     |PATH_DAT #303 aPathConta;
     |PATH_DAT #304 aPathConta;
     |ABRE #caivaasi;
     |DDEFECTO #caivaasi;
     |LEE 000#caivaasi.p;
     |CIERRA #caivaasi;

     |ABRE #30;
     |BUCLE camaniva190;
     |CIERRA #30;

     |SI enSwPartido = 1;
         enSwOpPar   = 2;
         |HAZ FinalPartido;
     |FINSI;
|FPRC;

|PROCESO DesdeConta_c;
       aAlfa     = #191#1;
       aAlfa     = aAlfa % -102;
       nEjer     = aAlfa;
       enEmpresa = nEmpresa;
       enSwOpPar = 0;
       nSw       = 0;
       |HAZ SituaEmpresa;
       |SI enSwPartido = 0;
           |ABRE #330;
           |SELECT #4#330;
           #330#2  = nEmpresa;
           #330#26 = nEjer;
           |LEE 040#330=;
           |SI FSalida = 0; nSw = 1; |FINSI;
           |CIERRA #330;
       |SINO;
            nSw = 1;
       |FINSI;
       |SI nSw = 1;
           |HAZ PorContagen;
       |FINSI;
       enEmpresa = #191#0;
|FPRC;

|PROCESO dsmom026_c;
     nEmpresa = #26#1;
     |HAZ DesdeConta_c;
|FPRC;

|DEFBUCLE dsmom026_c;
     #26#1;
     ;
     #191#0, 00001;
     #191#0, 99999;
     ;
     NULL, dsmom026_c;
|FIN;

|PROCESO DesdeContaEsp;
     aPathConta  = "";
     |DBASS aBase; |QBT aBase;
     aElDef = aBase + "contagen/def/";
     aElDef = aElDef + "canempre.mas";
     |XABRE "E", aElDef, nCanal;
     |SI FSalida ] 0;
         aPathConta = aBase + "contagen/fich/";
     |FINSI;
     |XCIERRA nCanal;
     |SI aPathConta = ""; |ACABA; |FINSI; ||tampoco hay contabilidad

     |ABRE #26;
     #26#0 = #191#0;
     #26#1 = 0;
     |LEE 040#26];
     |SI FSalida = 0;  |Y #26#0 = #191#0;
         |CIERRA #26;
         enImporte2 = 0;
         |BUCLE dsmom026_c;
     |SINO;
         |CIERRA #26;
         nEmpresa     = #191#0;
         nEmpresaTrab = #191#0;
         |HAZ DesdeConta_c;
     |FINSI;
     enError = 0;
|FPRC;

|PROCESO RecogeDatosNif;
    |SI aPathLaboral ! "";
        |HAZ DesdeLaboral;
    |SINO;
         |ABRE #99;
         #99#0 = 110;
         |LEE 040#99=;
         |SI FSalida ! 0;  |DDEFECTO #99;  |FINSI;
         |CIERRA #99;
         |SI #99#8 = "S"; |HAZ DesdeContaEsp; |FINSI;
    |FINSI;
|FPRC;

|PROCESO GrabaDatosNif;
     |DBASS aBase;   |QBF aBase;

     aPathLaboral = "";
     aAlfa        = aBase + "laboral/def/labempre.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         aPathLaboral = aBase + "laboral/";
     |FINSI;

     |ABRET #3;
     #3#0 = #191#6;
     #3#1 = 1;
     |LEE 040#3=;
     |SI FSalida ! 0;
         |HAZ RecogeDatosNif;
     |SINO;
         |HAZ RecogeDatosNif;
     |FINSI;

     |CIERRAT #3;
|FPRC;

|PROCESO CargaDatos2002;
     |SI #3#2 = "TITULAR     ";
         aAlfa = #3#13 % -104;
         #191#14 = aAlfa;
         #191#15 = #3#23;
         #191#25 = 0;
         |SI #3#17 ] 33;
             #191#25 = 1;
             |SI #3#18 = "S";
                 #191#25 = 2;
             |FINSI;
         |FINSI;

         |SI #3#17 ] 65;
             #191#25 = 3;
         |FINSI;

         #191#26 = #3#15;
     |FINSI;

     |SI #3#2 = "CONYUGE     ";
         |SI #191#26 = 2;
             #191#27 = #3#8;
         |FINSI;
     |FINSI;

     |SI #3#2 = "DESCENDIENTE";
         |SI #3#3 = "1";
             #191#28 = #191#28 + 1;
         |FINSI;

         aAlfa = #3#13 % -104;
         nAnyo = aAlfa;
         nEdad = #191#1 - nAnyo;
         |SI #3#17 ] 65;
             #191#33 = #191#33 + 1;
         |SINO;
             |SI #3#17 ] 33;
                 #191#32 = #191#32 + 1;
             |SINO;
                 |SI nEdad ] 0;
                     |SI nEdad < 3;                 #191#29 = #191#29 + 1;  |FINSI;
                     |SI nEdad ] 3;  |Y nEdad < 16; #191#30 = #191#30 + 1;  |FINSI;
                     |SI nEdad ] 16; |Y nEdad < 25; #191#31 = #191#31 + 1;  |FINSI;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #3#2 = "ASCENDIENTE ";
         |SI #3#3 = "1";
             #191#35 = #191#35 + 1;
         |FINSI;

         |SI #3#3 = "1";  |O #3#3 = " ";
             #191#38 = #191#38 + 1;
         |FINSI;

         |SI #3#17 ] 65;
             #191#37 = #191#37 + 1;
         |SINO;
             |SI #3#17 ] 33;
                 #191#36 = #191#36 + 1;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaDatos2003;
     |SI #3#2 = "TITULAR     ";
         aAlfa = #3#13 % -104;
         #191#14 = aAlfa;
         |SI #3#23 = " ";  #191#15 = 0;  |FINSI;
         |SI #3#23 = "1";  #191#15 = 1;  |FINSI;
         |SI #3#23 = "2";  #191#15 = 1;  |FINSI;
         #191#25 = 0;

         |SI #3#17 ] 33;
             #191#25 = 1;
             |SI #3#18 = "S";
                 #191#25 = 2;
             |FINSI;
         |FINSI;

         |SI #3#17 ] 65;
             #191#25 = 3;
         |FINSI;

         #191#26 = #3#15;
         #191#39 = #3#38;
         #191#40 = #3#39;
     |FINSI;

     |SI #3#2 = "CONYUGE     ";
         |SI #191#26 = 2;
             #191#27 = #3#8;
         |FINSI;
     |FINSI;

     |SI #3#2 = "DESCENDIENTE";
         aAlfa = #3#13 % -104;
         nAnyo = aAlfa;
         nEdad = #191#1 - nAnyo;

         |SI #3#41 ! 0;
             nEdadAdop = #191#1 - #3#41;
             |SI nEdadAdop < 3;  nEdad = nEdadAdop;  |FINSI;
         |FINSI;

         |SI nEdad ] 0;
             |SI #3#17 ] 65;
                                  #191#49 = #191#49 + 1;
                 |SI #3#3 = "1";  #191#50 = #191#50 + 1;  |FINSI;

                 |SI nEdad < 3;
                                      #191#41 = #191#41 + 1;
                     |SI #3#3 = "1";  #191#42 = #191#42 + 1;  |FINSI;
                 |SINO;
                                      #191#43 = #191#43 + 1;
                     |SI #3#3 = "1";  #191#44 = #191#44 + 1;  |FINSI;
                 |FINSI;
             |SINO;
                 |SI #3#17 ] 33;
                                      #191#45 = #191#45 + 1;
                     |SI #3#3 = "1";  #191#46 = #191#46 + 1;      |FINSI;

                     |SI #3#18 = "S";
                                          #191#47 = #191#47 + 1;
                         |SI #3#3 = "1";  #191#48 = #191#48 + 1;  |FINSI;
                     |FINSI;

                     |SI nEdad < 3;
                                          #191#41 = #191#41 + 1;
                         |SI #3#3 = "1";  #191#42 = #191#42 + 1;  |FINSI;
                     |SINO;
                                          #191#43 = #191#43 + 1;
                         |SI #3#3 = "1";  #191#44 = #191#44 + 1;  |FINSI;
                     |FINSI;
                 |SINO;
                     |SI nEdad < 3;
                                          #191#41 = #191#41 + 1;
                         |SI #3#3 = "1";  #191#42 = #191#42 + 1;  |FINSI;
                     |SINO;
                         |SI nEdad < 25;
                                              #191#43 = #191#43 + 1;
                             |SI #3#3 = "1";  #191#44 = #191#44 + 1;  |FINSI;
                         |FINSI;
                     |FINSI;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #3#2 = "ASCENDIENTE ";
         aAlfa = #3#13 % -104;
         nAnyo = aAlfa;
         nEdad = #191#1 - nAnyo;
         |SI nEdad ] 0;
             |SI #3#17 ] 65;
                                  #191#59 = #191#59 + 1;
                 |SI #3#3 = "1";  #191#60 = #191#60 + 1;  |FINSI;

                 |SI nEdad < 75;
                                      #191#51 = #191#51 + 1;
                     |SI #3#3 = "1";  #191#52 = #191#52 + 1;  |FINSI;
                 |SINO;
                                      #191#53 = #191#53 + 1;
                     |SI #3#3 = "1";  #191#54 = #191#54 + 1;  |FINSI;
                 |FINSI;
             |SINO;
                 |SI #3#17 ] 33;
                                      #191#55 = #191#55 + 1;
                     |SI #3#3 = "1";  #191#56 = #191#56 + 1;      |FINSI;

                     |SI #3#18 = "S";
                                          #191#57 = #191#57 + 1;
                         |SI #3#3 = "1";  #191#58 = #191#58 + 1;  |FINSI;
                     |FINSI;

                     |SI nEdad < 75;
                                          #191#51 = #191#51 + 1;
                         |SI #3#3 = "1";  #191#52 = #191#52 + 1;  |FINSI;
                     |SINO;
                                          #191#53 = #191#53 + 1;
                         |SI #3#3 = "1";  #191#54 = #191#54 + 1;  |FINSI;
                     |FINSI;
                 |SINO;
                     |SI nEdad < 75;
                                          #191#51 = #191#51 + 1;
                         |SI #3#3 = "1";  #191#52 = #191#52 + 1;  |FINSI;
                     |SINO;
                                          #191#53 = #191#53 + 1;
                         |SI #3#3 = "1";  #191#54 = #191#54 + 1;  |FINSI;
                     |FINSI;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaDatos;
     |SI #191#1 [ 2002;  |HAZ CargaDatos2002;  |FINSI;
     |SI #191#1 ] 2003;  |HAZ CargaDatos2003;  |FINSI;
|FPRC;

|DEFBUCLE agidanif;
     #3#1;
     ;
     #191#6, 01;
     #191#6, 99;
     ;
     NULL, CargaDatos;
|FIN;

|PROCESO CalculaDatosNif;
     |PARA nCampo = 28;  |SI nCampo [ 38;  |HACIENDO nCampo = nCampo + 1;
           #191nCampo = 0;
     |SIGUE;

     |PARA nCampo = 41;  |SI nCampo [ 60;  |HACIENDO nCampo = nCampo + 1;
           #191nCampo = 0;
     |SIGUE;

     |BUCLE agidanif;

     #191#34 = #191#29 + #191#30 + #191#31 + #191#32 + #191#33;
|FPRC;
