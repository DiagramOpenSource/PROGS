|FICHEROS;
     dsmozpas #0;
     dsmom002 #2;
     dsmom004 #4;
     dsmom008 #8;
     dsmom026 #26;
     dsmoc216 #100;

     :/laboral/def/labtraba  #200;
     :/laboral/def/nomhicca  #201;
     :/laboral/def/nomhicli  #202;
     :/laboral/def/labempre  #203;
     :/laboral/def/nomconli  #204;
     :/laboral/def/nomhiatr  #205;

     :/basica/def/agitab99   #99;

     dsmow013 #999,MANTE;
     espejo1@ #1300;

     &regisnif@ #709;
|FIN;

|VARIABLES;
     aTodoCero         = "";
     aNombreTrabajador = "";
     aCadena           = "";
     nMesLugar         = 0;
     nTipo             = 0;
     fFechaCamaniva    = @;
     nImporteBaseI     = 0;
     nPorcentaje       = 0;
     nImporteRetencion = 0;
     aEspecie          = "";
     aDni              = "";
     aDn               = "            ";
     aHn               = "zzzzzzzzzzzz";
     fDd               = @;
     fHd               = @;

     nSw               = 0;
     nNume             = 0;
     nDevengo          = 0;
     nAtrasos          = 0;
     nEmpresa          = 0;
     nEjerAt           = 0;
     nHandle           = 0;
     nPorGrupos        = 0;
     aClave            = "";
     aSubClave         = "";
     aPeriodicidad     = "";

     aAlfa1            = "";
     aAlfa2            = "";
     aMas              = "";
     aFecha            = "";
     aPathLaboral      = "";
     aBase             = "";

     aAlfa             = "";
     aPathModelo       = "";
     aDef              = "";
     aTipo             = "";

     nEjer             = 0;
     nDPeriodo         = 0;
     nHPeriodo         = 0;
     nCampo1           = 0;
     nCampo11          = 0;
     nCampo2           = 0;
     nCampo22          = 0;
     nCampo3           = 0;
     nCampo33          = 0;
     nSwEsta           = 0;
     nGrupo            = 0;
     nSubGrupo         = 0;
     nDepar            = 0;
     nBaseImpo         = 0;
     nPorce            = 0;
     nCuota            = 0;
     nPeriodo          = 0;
     nModelo           = 0;
     nSwPasa           = 0;
     nDComplem         = 0;
     nHComplem         = 0;
     nCampo            = 0;
     nAnyo             = 0;
     nHay              = 0;
     nHayPase          = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO MiraCampos216;
     aTodoCero = "S";
     |SI #100#12 ! 0;  aTodoCero = "N";  |FINSI;
     |SI #100#14 ! 0;  aTodoCero = "N";  |FINSI;
     |SI #100#15 ! 0;  aTodoCero = "N";  |FINSI;
|FPRC;

|PROCESO Compensa216;
     nHay  = 0;

     #100#0  = #1300#0;
     #100#1  = #1300#1;
     #100#2  = #999#3;
     #100#3  = #1300#3;
     #100#4  = #999#9;
     #100#5  = #1300#5;
     #100#6  = #1300#6;
     #100#7  = #1300#7;
     #100#8  = #1300#8;
     #100#9  = #1300#9;
     #100#10 = #1300#10;
     #100#11 = #1300#11;
     |LEE 101#100=;
     |SI FSalida ! 0;
         |DDEFECTO #100;
         #100#0  = #1300#0;
         #100#1  = #1300#1;
         #100#2  = #999#3;
         #100#3  = #1300#3;
         #100#4  = #999#9;
         #100#5  = #1300#5;
         #100#6  = #1300#6;
         #100#7  = #1300#7;
         #100#8  = #1300#8;
         #100#9  = #1300#9;
         #100#10 = #1300#10;
         #100#11 = #1300#11;
         #100#16 = #1300#16;
         #100#17 = #1300#17;
         #100#18 = #1300#18;
         #100#19 = #1300#19;
         #100#21 = #1300#21;
         #100#22 = #1300#22;
         #100#23 = #1300#23;
         #100#24 = #1300#24;
         #100#25 = #1300#25;
         #100#26 = #1300#26;
         #100#27 = #1300#27;
         #100#28 = #1300#28;
         #100#29 = #1300#29;
         #100#30 = #1300#30;
         #100#31 = #1300#31;

         |GRABA 020#100b;

         nHay = 1;
     |SINO;
         |HAZ MiraCampos216;
         |SI aTodoCero = "S";
             nHay = 1;
         |FINSI;
     |FINSI;

     |SI nHayPase = 1;  nHay = 0;  |FINSI;

     |SI nHay = 1;
         #100#12 = #100#12 + #1300#12;
         #100#14 = #100#14 + #1300#14;
         #100#15 = #100#15 + #1300#15;
     |FINSI;

     #100#12 = #100#12 - #1300#12;
     #100#14 = #100#14 - #1300#14;
     #100#15 = #100#15 - #1300#15;
     #100#13 = (#100#14 * 100) / #100#12;

     |GRABA 020#100a;
     |LIBERA #100;

     |HAZ MiraCampos216;  || mira si son todos = 0 o no

     |SI aTodoCero = "S";
         |SI nHay = 0;
             |BORRA 020#100a;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE Bdsmoc216;
     #1300#1012;
     ;
     #999#0, #999#2, nPeriodo, 216, nDComplem, #999#1, aDn, fDd, 1, " ", 00, 0;
     #999#0, #999#2, nPeriodo, 216, nHComplem, #999#1, aHn, fHd, 2, "z", 99, 9;
     ;
     NULL, Compensa216;
|FIN;

|PROCESO linea216;
     aAlfa1 = #1300#22;  |QBF aAlfa1;
     aAlfa2 = #1300#24;  |QBF aAlfa2;
     |SI aAlfa1 = "";   |Y aAlfa2 = "";
         |ACABA;
     |FINSI;

     #100#16 = #1300#16;
     #100#17 = #1300#17;
     #100#18 = #1300#18;
     #100#22 = #1300#22;
     #100#23 = #1300#23;
     #100#24 = #1300#24;
     #100#25 = #1300#25;
     #100#26 = #1300#26;
     #100#27 = #1300#27;
     #100#28 = #1300#28;
     #100#29 = #1300#29;
     #100#19 = #1300#19;
     #100#30 = #1300#30;
     #100#21 = #1300#21;
     #100#31 = #1300#31;
|FPRC;

|DEFBUCLE linea216;
     #1300#2001;
     ;
     #100#6;
     #100#6;
     ;
     NULL, linea216;
|FIN;

|PROCESO Grabadsmoc216;
     |SI aClave  = " ";  |Y aSubClave = "  ";  |ACABA;  |FINSI;

     |SI #200#42 ! "e";  |ACABA;  |FINSI;

     |ABRE #2;
     #2#0 = enEmpresa;
     #2#1 = enActividad;
     #2#2 = 216;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     aPeriodicidad = "T";
     |SI #2#7 = "MENSUAL   ";  aPeriodicidad = "M";  |FINSI;

     |SI nMesLugar = 1;   aFecha = "31.01." + enEjer;  |FINSI;
     |SI nMesLugar = 2;   aFecha = "28.02." + enEjer;  |FINSI;
     |SI nMesLugar = 3;   aFecha = "31.03." + enEjer;  |FINSI;
     |SI nMesLugar = 4;   aFecha = "30.04." + enEjer;  |FINSI;
     |SI nMesLugar = 5;   aFecha = "31.05." + enEjer;  |FINSI;
     |SI nMesLugar = 6;   aFecha = "30.06." + enEjer;  |FINSI;
     |SI nMesLugar = 7;   aFecha = "31.07." + enEjer;  |FINSI;
     |SI nMesLugar = 8;   aFecha = "31.08." + enEjer;  |FINSI;
     |SI nMesLugar = 9;   aFecha = "30.09." + enEjer;  |FINSI;
     |SI nMesLugar = 10;  aFecha = "31.10." + enEjer;  |FINSI;
     |SI nMesLugar = 11;  aFecha = "30.11." + enEjer;  |FINSI;
     |SI nMesLugar = 12;  aFecha = "31.12." + enEjer;  |FINSI;

     #100#0 = enEmpresa;
     #100#1 = enEjer;
     #100#2 = enPeriodo;
     #100#3 = enModelo;
     #100#4 = enComplem;
     #100#5 = enActividad;
     #100#6 = aDni;
     #100#7 = aFecha;

     |SI aEspecie = "N";  #100#8 = 1;  |FINSI;
     |SI aEspecie = "S";  #100#8 = 2;  |FINSI;

     #100#9  = aClave;
     #100#10 = aSubClave;
     #100#11 = 1;
     |LEE 101#100=;
     |SI FSalida ! 0;
         |DDEFECTO #100;
         #100#0 = enEmpresa;
         #100#1 = enEjer;
         #100#2 = enPeriodo;
         #100#3 = enModelo;
         #100#4 = enComplem;
         #100#5 = enActividad;
         #100#6 = aDni;
         #100#7 = aFecha;

         |SI aEspecie = "N";  #100#8 = 1;  |FINSI;
         |SI aEspecie = "S";  #100#8 = 2;  |FINSI;

         #100#9  = aClave;
         #100#10 = aSubClave;

         #100#11 = 1;
         |GRABA 020#100b;
     |FINSI;

     #100#12 = #100#12 + nImporteBaseI;
     #100#14 = #100#14 + nImporteRetencion;
     #100#13 = (#100#14 * 100) / #100#12;
     #100#16 = aNombreTrabajador;

     eaCodNif = #100#6;
     |HAZ LeeNifs;

     aAlfa = #100#6 % 101;
     |SI aAlfa = "0"; |O aAlfa = "1"; |O aAlfa = "2"; |O aAlfa = "3";
      |O aAlfa = "4"; |O aAlfa = "5"; |O aAlfa = "6"; |O aAlfa = "7";
      |O aAlfa = "8"; |O aAlfa = "9"; |O aAlfa = "X"; |O aAlfa = "Y";
      |O aAlfa = "Z";
         #100#18 = "F";
     |SINO;
         #100#18 = "J";
     |FINSI;

     aAlfa1 = #100#22;  |QBF aAlfa1;
     aAlfa2 = #100#24;  |QBF aAlfa2;
     |SI aAlfa1 = "";   |Y aAlfa2 = "";
         |DBASE aMas;  |QBF aMas;
         aMas = aMas + "def/dsmoc216.mas";
         |CARGA_DEF aMas, espejo1@;

         |BUCLE linea216;

         |DESCARGA_DEF #espejo1@;
     |FINSI;

     aAlfa1 = #100#22;  |QBF aAlfa1;
     aAlfa2 = #100#24;  |QBF aAlfa2;

     |SI aAlfa1 = "";   |Y aAlfa2 = "";
         #100#19 = #709#12;
         #100#22 = #709#2;
         #100#24 = #709#6;
         #100#25 = #709#7;
     |FINSI;

     |GRABA 020#100a;
     |LIBERA #100;
|FPRC;

|PROCESO nomhicli216;
     #204#0 = #200#87;
     #204#2 = #202#4;
     |LEE 101#204=;
     |SI FSalida = 0;
         |SI #204#8 = 0;  |ACABA;  |FINSI;

         |SI #204#13 = "  ";
             #204#13 = "01";
             |GRABA 020#204a;
         |FINSI;

         aClave            = "L";
         aSubClave         = #204#13;
         aEspecie          = "N";
         nImporteBaseI     = #202#11 * #202#10;
         nImporteRetencion = 0;
         |HAZ Grabadsmoc216;
     |SINO;
         aAlfa1 = "0000Concepto [" + #204#0 + "." + #204#2 + "] inaccesible ...";
         |SI #204#2 ! 431;
             |MENAV aAlfa1;
         |SINO;
              aClave            = "L";
              aSubClave         = #204#13;
              aEspecie          = "N";
              nImporteBaseI     = #202#11 * #202#10;
              nImporteRetencion = 0;
              |HAZ Grabadsmoc216;
         |FINSI;
     |FINSI;

     |LIBERA #204;
|FPRC;

|DEFBUCLE nomhicli216;
     #202#1;
     ;
     #201#0, #201#1, #201#66, #201#2, #201#3, 411;
     #201#0, #201#1, #201#66, #201#2, #201#3, 499;
     ;
     NULL, nomhicli216;
|FIN;

|PROCESO nomhicca216;
     nDevengo = 0;

     |SI nAtrasos = 1;
         |SI #205#1 ! #205#3;
             nDevengo = #205#3;
         |FINSI;
     |FINSI;

     #203#0 = #201#0;
     |LEE 000#203=;
     |SI FSalida ! 0;  |DDEFECTO #203; |FINSI;

     #200#0 = #201#0;
     #200#1 = #201#1;
     |LEE 000#200=;
     |SI FSalida ! 0;  |DDEFECTO #200; |FINSI;

     aNombreTrabajador = #200#2;
     aDni              = #200#7;
     nMesLugar         = #201#2;

     aClave            = #200#99;
     aSubClave         = #200#102;
     aEspecie          = #200#105;
     nImporteBaseI     = #201#14 + #201#16;
     nImporteRetencion = #201#15 + #201#17;
     |HAZ Grabadsmoc216;

     aClave            = #200#100;
     aSubClave         = #200#103;
     aEspecie          = #200#106;
     nImporteBaseI     = #201#108;
     nImporteRetencion = #201#110;
     |HAZ Grabadsmoc216;

     aClave            = #200#101;
     aSubClave         = #200#104;
     aEspecie          = #200#107;
     nImporteBaseI     = #201#109;
     nImporteRetencion = #201#111;
     |HAZ Grabadsmoc216;

     |SI #201#18 ! 0;
||         |BUCLE nomhicli216;
     |FINSI;
|FPRC;

|DEFBUCLE nomhicca216;
     #201#1;
     ;
     nEmpresa, 00001, nEjer, nDPeriodo, 0;
     nEmpresa, 99999, nEjer, nHPeriodo, 4;
     ;
     NULL, nomhicca216;
|FIN;

|DEFBUCLE nomhiccaA216;
     #201#1;
     ;
     #205#0, 00001, nEjerAt, 01, #205#2;
     #205#0, 99999, nEjerAt, 12, #205#2;
     ;
     NULL, nomhicca216;
|FIN;

|PROCESO nomhiatr216;
     |SI #205#4 > nHPeriodo;  |ACABA;  |FINSI;

     |SI #205#4 = 0;
         #205#4 = enPeriodo;
         |GRABA 020#205a;
         |LIBERA #205;
     |FINSI;

     aAlfa   = #205#3;
     aAlfa   = aAlfa % -102;
     nEjerAt = aAlfa;
     |BUCLE nomhiccaA216;
|FPRC;

|DEFBUCLE nomhiatr216;
     #205#1;
     ;
     nEmpresa, #0#3, 5, 0000;
     nEmpresa, #0#3, 9, 9999;
     be;
     NULL, nomhiatr216;
|FIN;

|PROCESO DesdeNominas216;
     |PATH_DAT #201 aPathLaboral;
     |PATH_DAT #202 aPathLaboral;
     |PATH_DAT #204 aPathLaboral;

     |ABRE #200;
     |ABRE #203;
     |ABRE #204;
     nAtrasos = 0;  |BUCLE nomhicca216;
     nAtrasos = 1;  |BUCLE nomhiatr216;
     |CIERRA #200;
     |CIERRA #203;
     |CIERRA #204;
|FPRC;

|PROCESO PorDonde216;
     |ABRE #99;
     #99#0 = 216;
     |LEE 040#99=;
     |SI FSalida ! 0;  |DDEFECTO #99;  |FINSI;
     |CIERRA #99;

     |ABRE #2;
     #2#0 = enEmpresa;
     #2#1 = enActividad;
     #2#2 = 216;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     aPeriodicidad = "T";
     |SI #2#7 = "MENSUAL   ";  aPeriodicidad = "M";  |FINSI;

     |ABRE #100;

     |SI #0#1 = 1;   nDPeriodo = 1;  nHPeriodo = 1;   |FINSI;
     |SI #0#1 = 2;   nDPeriodo = 1;  nHPeriodo = 2;   |FINSI;
     |SI #0#1 = 3;   nDPeriodo = 1;  nHPeriodo = 3;   |FINSI;
     |SI #0#1 = 4;   nDPeriodo = 1;  nHPeriodo = 4;   |FINSI;
     |SI #0#1 = 5;   nDPeriodo = 1;  nHPeriodo = 5;   |FINSI;
     |SI #0#1 = 6;   nDPeriodo = 1;  nHPeriodo = 6;   |FINSI;
     |SI #0#1 = 7;   nDPeriodo = 1;  nHPeriodo = 7;   |FINSI;
     |SI #0#1 = 8;   nDPeriodo = 1;  nHPeriodo = 8;   |FINSI;
     |SI #0#1 = 9;   nDPeriodo = 1;  nHPeriodo = 9;   |FINSI;
     |SI #0#1 = 10;  nDPeriodo = 1;  nHPeriodo = 10;  |FINSI;
     |SI #0#1 = 11;  nDPeriodo = 1;  nHPeriodo = 11;  |FINSI;
     |SI #0#1 = 12;  nDPeriodo = 1;  nHPeriodo = 12;  |FINSI;

     |DBASS aBase;   |QBF aBase;
     aAlfa = aBase + "laboral/def/labempre.mas";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     aPathLaboral = aBase + "laboral/fich/";
     |HAZ DesdeNominas216;
     nHayPase  = 2;
     enEmpresa = #999#0;

     |CIERRA #100;
|FPRC;

|PROCESO dsmom026_216;
     nEmpresa = #26#1;
     |HAZ PorDonde216;
|FPRC;

|DEFBUCLE dsmom026_216;
     #26#1;
     ;
     #999#0, 00001;
     #999#0, 99999;
     ;
     NULL, dsmom026_216;
|FIN;

|PROCESO OrganizaPase216;
     nPorGrupos = 0;
     |ABRE #26;
     #26#0 = #999#0;
     #26#1 = 0;
     |LEE 040#26];
     |SI FSalida = 0;  |Y #26#0 = #999#0;
         nPorGrupos = 1;
     |FINSI;
     |CIERRA #26;

     |SI nPorGrupos = 0;
         nEmpresa = #999#0;
         |HAZ PorDonde216;
     |SINO;
         |BUCLE dsmom026_216
     |FINSI;
|FPRC;

|PROCESO BorrarCeros216;
     aTodoCero = "N";
     |HAZ MiraCampos216;  || mira si son todos = 0 o no
     |SI aTodoCero = "S";
         |BORRA 020#100a;
         |LIBERA #100;
     |FINSI;
|FPRC;

|DEFBUCLE dsmoc216B;
     #100#1;
     ;
     #999#0, #999#2, #999#3, #999#7, #999#9, #999#1, aDn, fDd, 1, " ", 00, 0;
     #999#0, #999#2, #999#3, #999#7, #999#9, #999#1, aHn, fHd, 2, "z", 99, 9;
     be;
     NULL, BorrarCeros216;
|FIN;

|PROCESO Anterior216;
     |PARA nCampo = 0;  |SI nCampo [ 20;  |HACIENDO nCampo = nCampo + 1;
           #100nCampo = #1300nCampo;
     |SIGUE;
     #100#1  = #999#2;
     #100#2  = #999#3;
     #100#12 = 0;
     #100#13 = 0;
     #100#14 = 0;
     #100#15 = 0;
     #100#20 = 0;

     |GRABA 020#100n;
     |LIBERA #100;
|FPRC;

|DEFBUCLE dsmoc216A;
     #1300#1012;
     ;
     #999#0, nAnyo, nPeriodo, 216, nDComplem, #999#1, aDn, fDd, 1, " ", 00, 0;
     #999#0, nAnyo, nPeriodo, 216, nHComplem, #999#1, aHn, fHd, 2, "z", 99, 9;
     ;
     NULL, Anterior216;
|FIN;

|PROCESO PaseAnterior216;
     |DBASE aPathModelo;  |QBT aPathModelo;
     aDef = aPathModelo + "def/dsmoc216.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nAnyo = #999#2;
     |SI #999#3 = 3;
         nAnyo    = #999#2 - 1;
         nPeriodo = 12;
     |SINO;
         nPeriodo = #999#3 - 3;
     |FINSI;

     |ABRE #100;
     |BUCLE dsmoc216A;
     |CIERRA #100;

     |DESCARGA_DEF #espejo1@;

     enEmpresa     = #999#0;
     enEjer        = #999#2;
     enPeriodo     = #999#3;
     enModelo      = #999#7;
     enComplem     = #999#9;
     enActividad   = #999#1;
     enTipoEntrada = 98;
     eaNombreAct   = #999#6;
     |SUB_EJECUTA_NP "dsmoc216";

     |ABRE #4;
     #4#0 = #999#0;
     #4#1 = #999#2;
     #4#2 = #999#3;
     #4#3 = #999#7;
     #4#4 = #999#9;
     |LEE 101#4=;
     |SI FSalida = 0;
         |HAZ ChequeaSituacion;  || Esta en el PLB
         #4#9 = " ";
         |GRABA 020#4a;
         |LIBERA #4;
     |FINSI;
     |CIERRA #4;
|FPRC;

|PROCESO Pase216;
     || borrar dsmoc216 y dsmod296

     fDd = "01.01.0000";
     fHd = "31.12.9999";

     |DDEFECTO #8;
     |ABRE #8;
     #8#0 = #999#0;
     #8#1 = #999#2;
     #8#2 = #999#3;
     #8#3 = #999#7;
     #8#4 = #999#9;
     #8#5 = #999#1;
     |LEE 101#8=;
     |SI FSalida = 0;
         #8#11 = "SIN DATOS";
         |GRABA 020#8a;

         enEmpresa     = #8#0;
         enEjer        = #8#1;
         enPeriodo     = #8#2;
         enModelo      = #8#3;
         enComplem     = #8#4;
         enActividad   = #8#5;
         enTipoEntrada = 97;
         |SUB_EJECUTA_NP "dsmoc216";
     |FINSI;
     |LIBERA #8;
     |CIERRA #8;

     |SI enAnterior = 1;         || Recogida de un Periodo Anterior
         |HAZ PaseAnterior216;

         |ACABA;
     |FINSI;

     |ABRET #100;

     aAlfa = #999#2;
     aAlfa = aAlfa % -102;
     nEjer = aAlfa;

     enEmpresa     = #999#0;
     enEjer        = #999#2;
     enPeriodo     = #999#3;
     enModelo      = #999#7;
     enComplem     = #999#9;
     enActividad   = #999#1;
     nHayPase      = 0;

     |HAZ OrganizaPase216;

     |SI nHayPase = 0;
         enEmpresa     = #999#0;
         enEjer        = #999#2;
         enPeriodo     = #999#3;
         enModelo      = #999#7;
         enComplem     = #999#9;
         enActividad   = #999#1;
         enTipoEntrada = 98;
         eaNombreAct   = #999#6;
         |SUB_EJECUTA_NP "dsmoc216";
         |CIERRAT #100;
         |ACABA;
     |FINSI;

     |SI #999#3 ! 1;
         |DBASE aPathModelo;  |QBT aPathModelo;
         aDef = aPathModelo + "def/dsmoc216.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida = 0;
             nHComplem = enComplem;  || miro el ultimo complementario
                                     || de los periodos anteriores 14_1285
             |PARA nPeriodo = 1;  |SI nPeriodo < #999#3;  |HACIENDO nPeriodo = nPeriodo + 1;
                   nDComplem = -1;
                   |ABRE #1300;
                   |DDEFECTO #1300;
                   #1300#0 = #999#0;
                   #1300#1 = #999#2;
                   #1300#2 = nPeriodo
                   #1300#3 = 216;
                   #1300#4 = 99;
                   |LEE 040#1300];
                   |SI FSalida = 0;
                       |LEE 040#1300a;
                   |SINO;
                       |LEE 040#1300u;
                   |FINSI;
                   |SI FSalida = 0; |Y #1300#0 = #999#0; |Y #1300#1 = #999#2;
                             |Y #1300#2 = nPeriodo; |Y #1300#3 = 216;
                                nDComplem = #1300#4;
                                nHComplem = #1300#4;
                   |FINSI;
                   |CIERRA #1300;
                   |SI nDComplem ] 0; |BUCLE Bdsmoc216; |FINSI;
             |SIGUE;

             |SI #999#9 ! 0; ||las complementarias son en realidad sustitutivas
                             ||por tanto no restamos lo de las comp. anteriores
                             ||Lopez Andres: 14_1285
                 nDComplem = 0;
                 nHComplem = enComplem - 1;
                 nPeriodo  = #999#3;
             |FINSI;
         |FINSI;
         |DESCARGA_DEF #espejo1@;
     |FINSI;

     |CIERRAT #100;

     |SI nHayPase = 2; |Y #999#1 ! 99;
          |BUCLE dsmoc216B;
     |FINSI;

     enEmpresa     = #999#0;
     enEjer        = #999#2;
     enPeriodo     = #999#3;
     enModelo      = #999#7;
     enComplem     = #999#9;
     enActividad   = #999#1;
     enTipoEntrada = 98;
     eaNombreAct   = #999#6;
     |SUB_EJECUTA_NP "dsmoc216";

     |ABRE #4;
     #4#0 = #999#0;
     #4#1 = #999#2;
     #4#2 = #999#3;
     #4#3 = #999#7;
     #4#4 = #999#9;
     |LEE 101#4=;
     |SI FSalida = 0;
         |HAZ ChequeaSituacion;  || Esta en el PLB

         #4#9 = " ";
         |GRABA 020#4a;
         |LIBERA #4;
     |FINSI;
     |CIERRA #4;
|FPRC;
