|FICHEROS;
     dsmoz004 #0;
     dsmom009 #9;
     dsmom010 #10;
     dsmom011 #11;
     dsmom012 #12;
     dsmom013 #13;
     dsmow005 #999;
     dsmow006 #998;
|FIN;

|VARIABLES;
     aFichero  = "";
     aAlfa     = "";

     fFecha    = @;

     nCampo    = 0;
     nDEmpresa = 0;
     nHEmpresa = 0;
     enGraba   = 0;
     nImporte  = 0;
     nImporte1 = 0;
     nImporte2 = 0;
|FIN;

|INCLUYE i_variar;

|| /////////////////////// PROCESOS ENTRADA POR PANTALLA \\\\\\\\\\\\\\\\\\\\

|PROCESO Periodo;
     |SI #0#0 = 1;   #0#1 = "ENERO     ";  |FINSI;
     |SI #0#0 = 2;   #0#1 = "FEBRERO   ";  |FINSI;
     |SI #0#0 = 3;   #0#1 = "MARZO     ";  |FINSI;
     |SI #0#0 = 4;   #0#1 = "ABRIL     ";  |FINSI;
     |SI #0#0 = 5;   #0#1 = "MAYO      ";  |FINSI;
     |SI #0#0 = 6;   #0#1 = "JUNIO     ";  |FINSI;
     |SI #0#0 = 7;   #0#1 = "JULIO     ";  |FINSI;
     |SI #0#0 = 8;   #0#1 = "AGOSTO    ";  |FINSI;
     |SI #0#0 = 9;   #0#1 = "SEPTIEMBRE";  |FINSI;
     |SI #0#0 = 10;  #0#1 = "OCTUBRE   ";  |FINSI;
     |SI #0#0 = 11;  #0#1 = "NOVIEMBRE ";  |FINSI;
     |SI #0#0 = 12;  #0#1 = "DICIEMBRE ";  |FINSI;

     fFecha = ~;
     aAlfa  = fFecha % -104;
     #0#2   = aAlfa;

     |PINTA #0#1;
     |PINTA #0#2;
|FPRC;

|PROCESO Parrilla;
     |SI #0#3 = 0;
         #0#3 = 0;  |PINTA #0#3;
         #0#4 = 0;  |PINTA #0#4;  |C_M #0#4, 1, "N";
         |PARA nCampo = 5;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |SINO;
         |SI enEmpresa = 0;
             |C_M #0#3, 1, "S";
             |C_M #0#4, 1, "S";
         |FINSI;

         |PARA nCampo = 5;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
               #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasEmpresas;
     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               #0nCampo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|| /////////////////////// PROCESOS DE TRABAJO \\\\\\\\\\\\\\\\\\\\

|PROCESO GrabaTempo;
     #999#0 = #9#0;
     |LEE 101#999=;
     |SI FSalida ! 0;
         #999#0 = #9#0;
         #999#1 = #9#1;
         #999#2 = #9#2;
         #999#3 = #9#5;
         #999#4 = #0#1;
         |GRABA 020#999n;

         enGraba = 1;
     |FINSI;
     |LIBERA #999;
|FPRC;

|DEFBUCLE dsmom009;
     #9#1;
     ;
     nDEmpresa, #0#2, #0#0, 00, 01;
     nHEmpresa, #0#2, #0#0, 99, 99;
     ;
     NULL, GrabaTempo;
|FIN;

|RUTINA ClaveBaja999;
     #999#0 = 1;
|FRUT;

|RUTINA ClaveAlta999;
     #999#0 = 99999;
|FRUT;

|PROCESO Tipo3;  |TIPO 3;
     enEjer     = #0#2;
     eaPlanilla = "dsmom014";  |HAZ PlanDePlanillas;

     aFichero = ("04" + Usuario) % 108;
     |NOME_DAT #999 aFichero;
     |ABRE #999;  |CIERRA #999;  |DELINDEX #999;

     |ABRE #999;
     |SI #0#3 ! 0;
         nDEmpresa = #0#3;
         nHEmpresa = #0#4;
         |BUCLE dsmom009;
     |SINO;
         |PARA nCampo = 5;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               nDEmpresa = #0nCampo;
               nHEmpresa = #0nCampo;
               |BUCLE dsmom009;
         |SIGUE;
     |FINSI;
     |CIERRA #999;

     |SI enGraba = 1;
         |ENTLINEAL #1#999, -1, 4, 22, 1, ClaveBaja999, ClaveAlta999;
     |SINO;
         |MENAV "     Seleccion Vacia.";
     |FINSI;
     |DELINDEX #999;
|FPRC;

|PROGRAMA;
     |SI enEmpresa ! 0;
         #0#0 = enPeriodo;
         #0#1 = eaNomPer;
         #0#2 = enEjer;
         #0#3 = enEmpresa;
         #0#4 = enEmpresa;
         |HAZ Tipo3;
     |SINO;
         |CLS;
         |CABEZA "Entrada de Planillas";
         |DDEFECTO #0;
         |PINPA #0#0;
         |PINDA #0#0;
         |ENDATOS #1#0;
     |FINSI;
|FPRO;
