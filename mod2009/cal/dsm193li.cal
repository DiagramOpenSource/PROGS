|FICHEROS;
     dsm193ca #193;
     dsm193li #194,MANTE;
     dsm193ga #195,MANTE;

     &regisnif@ #709;
|FIN;

|VARIABLES;
     nCampo      = 0;
     nPtec       = 0;
     nCampoD     = 0;
     nCampoO     = 0;
     nForma      = 0;

     aMenav      = "";
     aPathModelo = "";
     aDef        = "";
     aAlfa       = "";
     aTecla      = "";

     &enError    = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO Tipo12;  |TIPO 12;
|FPRC;

|PROCESO PonDatosNif;  |TIPO 7;
     |SI #194#6 ! "999999999999";
         eaCodNif  = #194#6;
         |HAZ LeeNifs;

         |C_M #194#12, 1, "S";
         |C_M #194#14, 1, "S";

         #194#12 = #709#1;   |PINTA #194#12;
         #194#14 = #709#4;   |PINTA #194#14;
     |SINO;
         |C_M #194#12, 1, "N";
         |C_M #194#14, 1, "N";

         #194#12 = "VALORES PENDIENTES DE ABONO";   |PINTA #194#12;
         #194#14 = 0;                               |PINTA #194#14;
     |FINSI;

     |C_M #194#13, 1, "S";
     |C_M #194#15, 1, "S";
     |C_M #194#16, 1, "S";
     |C_M #194#17, 1, "S";
     |C_M #194#18, 1, "S";
     |C_M #194#19, 1, "S";
     |SI #194#8 ! "A";  |Y #194#8 ! "B";  |Y #194#8 ! "D";
         |C_M #194#13, 1, "N";  #194#13 = "N";  |PINTA #194#13;
         |C_M #194#15, 1, "N";  #194#15 = "0";  |PINTA #194#15;
         |C_M #194#16, 1, "N";  #194#16 = "";   |PINTA #194#16;
         |C_M #194#17, 1, "N";  #194#17 = "0";  |PINTA #194#17;
         |C_M #194#18, 1, "N";  #194#18 = "";   |PINTA #194#18;
         |C_M #194#19, 1, "N";  #194#19 = "";   |PINTA #194#19;
     |FINSI;

     |C_M #194#21, 1, "S";
     |SI #194#8 ! "A";
         |C_M #194#21, 1, "N";  #194#21 = 0;    |PINTA #194#21;
     |FINSI;

     |C_M #194#27, 1, "S";
     |C_M #194#28, 1, "S";

     |SI #194#8 ! "B";  |Y #194#8 ! "D";
         |C_M #194#27, 1, "N";  #194#27 = 0;    |PINTA #194#27;
         |C_M #194#28, 1, "N";  #194#28 = 0;    |PINTA #194#28;
     |FINSI;

     |SI #193#15 = "S";
         |C_M #194#15, 1, "N";  #194#15 = "0";  |PINTA #194#15;
         |C_M #194#16, 1, "N";  #194#16 = "";   |PINTA #194#16;
         |C_M #194#17, 1, "N";  #194#17 = "0";  |PINTA #194#17;
         |C_M #194#18, 1, "N";  #194#18 = "";   |PINTA #194#18;
         |C_M #194#19, 1, "N";  #194#19 = "";   |PINTA #194#19;
     |FINSI;

     |SI #194#6 = "999999999999";
         ||C_M #194#18, 1, "N";  #194#18 = "";   |PINTA #194#18;
         ||C_M #194#19, 1, "N";  #194#19 = "";   |PINTA #194#19;
     |FINSI;
|FPRC;

|PROCESO TipoCod;  |TIPO 0;
     |C_M #194#29, 1, "S";
     |C_M #194#30, 1, "S";
     |C_M #194#31, 1, "S";
     |C_M #194#32, 1, "S";

     |SI #194#18 ! "P";
         |C_M #194#29, 1, "N";   #194#29 = "00.00.0000";  |PINTA #194#29;
         |C_M #194#30, 1, "N";   #194#30 = "00.00.0000";  |PINTA #194#30;
         |C_M #194#31, 1, "N";   #194#31 = 0;             |PINTA #194#31;
         |C_M #194#32, 1, "N";   #194#32 = 0;             |PINTA #194#32;

         |ACABA;
     |FINSI;

     |SI #194#17 ! 2;
         |MENAV "0000 El Tipo P no procede.";
         |ERROR;
         |ACABA;
     |FINSI;

     |SI #194#8 ! "A";  |Y #194#8 ! "B";  |Y #194#8 ! "D";
         |MENAV "0000 El Tipo P no procede.";
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO Tipo2m193li;  |TIPO 2;
     #193#6  = #193#6  +. 1;
     #193#7  = #193#7  +. #194#23;
     #193#8  = #193#8  +. #194#25;
     #193#9  = #193#9  +. #194#26;
     #193#10 = #193#10 +. #194#27;
     #193#11 = #193#11 +. #194#28;
|FPRC;

|PROCESO Tipo11m193li;  |TIPO 11;
     |SI FSalida = 10;
         |SI #194Campo = "999999999999";  |ACABA;  |FINSI;
         eaVarDni  = #194Campo;
         enCalcCif = 1;
         |HAZ CalculameDNI;
         #194Campo = eaVarDni;
         |PINTA #194Campo;
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO MiraDni193li;  |TIPO 6;
     |SI #194#6 = "999999999999";
         |ABRE #709;
         #709#0 = "999999999999";
         |LEE 101#709=;
         |SI FSalida ! 0;
             |DDEFECTO #709;
              #709#0 = "999999999999";
              |GRABA 020#709n;
         |FINSI;
         |LIBERA #709;
         |CIERRA #709;
         |ACABA;
     |FINSI;

     eaVarDni  = #194Campo;
     enCalcCif = 0;
     |HAZ CalculameDNI;
     eaVarDni = (eaVarDni + "             ") % 112;
     |SI #194Campo ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #194Campo = eaVarDni;  |PINTA #194Campo;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Totales;
     |SI #194#23 = 0;  #194#23 = #194#20;  |FINSI;

     #194#25 =  #194#23 % #194#24;

     |PINTA #194#23;
     |PINTA #194#25;
|FPRC;
