|FICHEROS;
     dsmoc110 #0;
     dsmom002 #2;
     dsmom037 #3;
     dsmod110 #110;
     dsmom004 #4;
     dsmom008 #8;
     dsmow092 #992,MANTE;

     dsmow104 #904;
     &regisnif@ #709;
|FIN;

|VARIABLES;
     nGrupo        = 0;
     i             = 0;
     nMod          = 110;
     aDn           = "            ";
     aHn           = "zzzzzzzzzzzz";
     nDd           = 0;
     nHd           = 9999;
     aTipoCaptura  ="";
     nSwEsta       = 0;
     nEjerAnt      = 0;
     nPer          = 0;
     nSwGraba      = 0;
     nTipo         = 0;
     nGrupoAnt     = 0;
     nBoton        = 0;

     aPathModelo   = "";
     aDef          = "";
     aAlfa         = "";
     aPeriodicidad = "";
     aDNIAnt       = "";

     &eaExtension  = "";
     &eaPrograma   = "";
     nNume         = 0;
     nNume1        = 0;
     nNume2        = 0;
     nSwAux        = 0;
     aFichero      = "";
     nSwOp         = 0;
     nImpAnt       = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO Modificables; |TIPO 7;
     |ABRE #2;
     #2#0 = enEmpresa;
     #2#1 = enActividad;
     #2#2 = enModelo;
     |LEE 000#2=;
     |SI FSalida=0;
          aPeriodicidad=#2#7;
          |QBF aPeriodicidad;
     |SINO;
          aPeriodicidad="TRIMESTRAL";
     |FINSI;
     |CIERRA #2;

     |SI aPeriodicidad ! "TRIMESTRAL";
          |PARA i = 15;|SI i [ 24;|HACIENDO i = i + 1;
               |CAMPO_MODIFICA #0i,1,"N";
          |SIGUE;
     |FINSI;

     |SI #0#6 ! "PASEANTERIOR";  |Y #0#6 ! "MANUAL      ";
         |C_M #0#30, 1, "N";  |C_V #0#30, 1, "N";
         |C_M #0#31, 1, "N";  |C_V #0#31, 1, "N";
     |SINO;
         |C_M #0#30, 1, "S";  |C_V #0#30, 1, "S";
         |C_M #0#31, 1, "S";  |C_V #0#31, 1, "S";
     |FINSI;

     |PINTA #0#30;
     |PINTA #0#31;
|FPRC;

|PROCESO Tipo7;  |TIPO 7;
     |ESTADO_CONTROL nBoton, "DISABLE";

     |SI #0#6 ! "PASEANTERIOR";  |Y #0#6 ! "MANUAL      ";
         |C_M #0#30, 1, "N";  |C_V #0#30, 1, "N";
         |C_M #0#31, 1, "N";  |C_V #0#31, 1, "N";
     |SINO;
         |C_M #0#30, 1, "S";  |C_V #0#30, 1, "S";
         |C_M #0#31, 1, "S";  |C_V #0#31, 1, "S";
     |FINSI;

     |PINTA #0#30;
     |PINTA #0#31;
|FPRC;

|PROCESO PonNombre;  |TIPO 7;
     |ESTADO_CONTROL nBoton, "ENABLE";

     aAlfa = #0#29;  |QBF aAlfa;
     |SI aAlfa = "";
         eaCodNif = #0#6;
         |HAZ LeeNifs;
         #0#29 = #709#1;
         |PINTA #0#29;
     |FINSI;
|FPRC;

|PROCESO Dnimoc110;  |TIPO 11;
     |SI FSalida = 10;
         eaVarDni  = #0Campo;
         enCalcCif = 1;
         |HAZ CalculameDNI;
         #0Campo = eaVarDni;
         |PINTA #0Campo;
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO MiraDnimoc110;  |TIPO 6;
     eaVarDni  = #0Campo;
     enCalcCif = 0;
     |HAZ CalculameDNI;
     eaVarDni = (eaVarDni + "             ") % 112;
     |SI #0Campo ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #0Campo = eaVarDni;  |PINTA #0Campo;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO GrabaAuxiliar;
 |ABRE #904;
 #904#0 = #0#6;
 #904#1 = nGrupo;
 |LEE 101#904=;
 |SI FSalida ! 0;
      |DDEFECTO #904;
      #904#0 = #0#6;
      #904#1 = nGrupo;
      |GRABA 020#904b;
 |FINSI;
 #904#2 = #904#2  + #0#10 + #0#15 + #0#20;
 #904#3 = #904#3  + #0#11 + #0#16 + #0#21;
 #904#4 = #904#4  + #0#12 + #0#17 + #0#22;
 #904#5 = #904#5  + #0#13 + #0#14 + #0#18 + #0#19 + #0#23 + #0#24;
 nSwAux = 1;
 |SI #0#6 = "MANUAL      ";
     #904#7 = #904#7 + #0#30;
     #904#8 = #904#8 + #0#31;
 |FINSI;
 |GRABA 020#904a;
 |LIBERA #904;
 |CIERRA #904;
|FPRC;

|PROCESO RepasoAuxiliar;
 |SI #904#2 ! 0; |O #904#3 ! 0; |O #904#4 ! 0; |O #904#5 ! 0;
     |SI #904#1 = 1; nNume1 = 6;  nNume2 = 9;  |FINSI;
     |SI #904#1 = 2; nNume1 = 12; nNume2 = 15; |FINSI;
     |SI #904#1 = 3; nNume1 = 18; nNume2 = 21; |FINSI;
     |SI #904#1 = 4; nNume1 = 31; nNume2 = 34; |FINSI;
     |SI #904#1 = 5; nNume1 = 25; nNume2 = 0;  |FINSI;

     |SI #904#2 ! 0; |O #904#3 ! 0;
         |SI nSwOp = 0;
             |SI #904#0 = "MANUAL      ";
                 #110nNume1 = #110nNume1 + #904#7;
             |SINO;
                 #110nNume1 = #110nNume1 + 1;
             |FINSI;
         |SINO;
             #110nNume1 = 0;
         |FINSI;
     |FINSI;
     |SI #904#4 ! 0; |O #904#5 ! 0;
         |SI nSwOp = 0;
             |SI nNume2 ! 0;
                 |SI #904#0 = "MANUAL      ";
                     #110nNume2 = #110nNume2 + #904#8;
                 |SINO;
                     #110nNume2 = #110nNume2 + 1;
                 |FINSI;
             |FINSI;
         |SINO;
             |SI nNume2 ! 0; #110nNume2 = 0; |FINSI;
         |FINSI;
     |FINSI;
 |FINSI;
|FPRC;

|DEFBUCLE RepasoAuxiliar;
 #904#1;
 ;
 "            ", 1;
 "zzzzzzzzzzzz", 5;
 ;
 NULL, RepasoAuxiliar;
|FIN;

|PROCESO RepasoAux;
|| #110#6  = 0; #110#9  = 0; #110#12 = 0; #110#15 = 0;
|| #110#18 = 0; #110#21 = 0; #110#31 = 0; #110#34 = 0;
|| #110#24 = 0;   No los borra si no existe alguno en auxiliar 1185_405
 nSwOp = 1; |BUCLE RepasoAuxiliar;
 nSwOp = 0; |BUCLE RepasoAuxiliar;
|FPRC;

|PROCESO GrabaModelo;
     |SI #0#8 = "L";  |ACABA;  |FINSI;

     nGrupoAnt = nGrupo;
     |HAZ LeeGrupo;
     |SI nGrupoAnt ! nGrupo;
         aDNIAnt = "";
     |FINSI;

     |SI nGrupo = 0;  |ACABA;  |FINSI;

     nSwGraba = 1;

     |SI nGrupo = 1;
          |SI aDNIAnt ! #0#6;  |Y #0#6 ! "PASEANTERIOR";  |Y #0#6 ! "MANUAL      ";
              |SI #0#10 ! 0; |O #0#11 ! 0;
               |O #0#15 ! 0; |O #0#16 ! 0;
               |O #0#20 ! 0; |O #0#21 ! 0;
                  #110#6 = #110#6 + 1;
              |FINSI;
          |FINSI;

          |SI aDNIAnt ! #0#6;  |Y #0#6 ! "PASEANTERIOR";  |Y #0#6 ! "MANUAL      ";
              |SI #0#12 ! 0; |O #0#13 ! 0; |O #0#14 ! 0;
               |O #0#17 ! 0; |O #0#18 ! 0; |O #0#19 ! 0;
               |O #0#22 ! 0; |O #0#23 ! 0; |O #0#24 ! 0;
                  #110#9 = #110#9 + 1;
              |FINSI;
          |FINSI;

          |SI #0#6 = "PASEANTERIOR";  |O #0#6 = "MANUAL      ";
              |SI #0#30 ! 0;  #110#6 = #0#30;  |FINSI;
              |SI #0#31 ! 0;  #110#9 = #0#31;  |FINSI;
          |FINSI;

          #110#7  = #110#7  + #0#10 + #0#15 + #0#20;
          #110#8  = #110#8  + #0#11 + #0#16 + #0#21;
          #110#10 = #110#10 + #0#12 + #0#17 + #0#22;
          #110#11 = #110#11 + #0#13 + #0#14 + #0#18 + #0#19 + #0#23 + #0#24;
     |FINSI;

     |SI nGrupo = 2;
          |SI aDNIAnt ! #0#6;  |Y #0#6 ! "PASEANTERIOR";  |Y #0#6 ! "MANUAL      ";
              |SI #0#10 ! 0; |O #0#11 ! 0;
               |O #0#15 ! 0; |O #0#16 ! 0;
               |O #0#20 ! 0; |O #0#21 ! 0;
                  #110#12 = #110#12 + 1;
               |FINSI;
          |FINSI;

          |SI aDNIAnt ! #0#6;  |Y #0#6 ! "PASEANTERIOR";  |Y #0#6 ! "MANUAL      ";
              |SI #0#12 ! 0; |O #0#13 ! 0; |O #0#14 ! 0;
               |O #0#17 ! 0; |O #0#18 ! 0; |O #0#19 ! 0;
               |O #0#22 ! 0; |O #0#23 ! 0; |O #0#24 ! 0;
                  #110#15 = #110#15 + 1;
               |FINSI;
          |FINSI;

          |SI #0#6 = "PASEANTERIOR";  |O #0#6 = "MANUAL      ";
              |SI #0#30 ! 0;  #110#12 = #0#30;  |FINSI;
              |SI #0#31 ! 0;  #110#15 = #0#31;  |FINSI;
          |FINSI;

          #110#13 = #110#13 + #0#10 + #0#15 + #0#20;
          #110#14 = #110#14 + #0#11 + #0#16 + #0#21;
          #110#16 = #110#16 + #0#12 + #0#17 + #0#22;
          #110#17 = #110#17 + #0#13 + #0#14 + #0#18 + #0#19 + #0#23 + #0#24;
     |FINSI;

     |SI nGrupo = 3;
          |SI aDNIAnt ! #0#6;  |Y #0#6 ! "PASEANTERIOR";  |Y #0#6 ! "MANUAL      ";
              |SI #0#10 ! 0; |O #0#11 ! 0;
               |O #0#15 ! 0; |O #0#16 ! 0;
               |O #0#20 ! 0; |O #0#21 ! 0;
                  #110#18 = #110#18 + 1;
              |FINSI;
          |FINSI;

          |SI aDNIAnt ! #0#6;  |Y #0#6 ! "PASEANTERIOR";  |Y #0#6 ! "MANUAL      ";
              |SI #0#12 ! 0; |O #0#13 ! 0; |O #0#14 ! 0;
               |O #0#17 ! 0; |O #0#18 ! 0; |O #0#19 ! 0;
               |O #0#22 ! 0; |O #0#23 ! 0; |O #0#24 ! 0;
                  #110#21 = #110#21 + 1;
              |FINSI;
          |FINSI;

          |SI #0#6 = "PASEANTERIOR";  |O #0#6 = "MANUAL      ";
              |SI #0#30 ! 0;  #110#18 = #0#30;  |FINSI;
              |SI #0#31 ! 0;  #110#21 = #0#31;  |FINSI;
          |FINSI;

          #110#19 = #110#19 + #0#10 + #0#15 + #0#20;
          #110#20 = #110#20 + #0#11 + #0#16 + #0#21;
          #110#22 = #110#22 + #0#12 + #0#17 + #0#22;
          #110#23 = #110#23 + #0#13 + #0#14 + #0#18 + #0#19 + #0#23 + #0#24;
     |FINSI;

     |SI nGrupo = 4;
          |SI aDNIAnt ! #0#6;  |Y #0#6 ! "PASEANTERIOR";  |Y #0#6 ! "MANUAL      ";
              #110#24 = #110#24 + 1;
          |FINSI;

          |SI #0#6 = "PASEANTERIOR";  |O #0#6 = "MANUAL      ";
              |SI #0#30 ! 0;  #110#24 = #0#30;  |FINSI;
          |FINSI;

          #110#25 = #110#25 + #0#10 + #0#15 + #0#20 + #0#12 + #0#17 + #0#28;
          #110#26 = #110#26 + #0#11 + #0#16 + #0#21 + #0#13 + #0#14 + #0#18 + #0#19 + #0#23 + #0#24;
     |FINSI;

     |SI nGrupo = 5;
          |SI aDNIAnt ! #0#6;  |Y #0#6 ! "PASEANTERIOR";  |Y #0#6 ! "MANUAL      ";
              |SI #0#10 ! 0; |O #0#11 ! 0;
               |O #0#15 ! 0; |O #0#16 ! 0;
               |O #0#20 ! 0; |O #0#21 ! 0;
                  #110#31 = #110#31 + 1;
              |FINSI;
          |FINSI;

          |SI aDNIAnt ! #0#6;  |Y #0#6 ! "PASEANTERIOR";  |Y #0#6 ! "MANUAL      ";
              |SI #0#12 ! 0; |O #0#13 ! 0; |O #0#14 ! 0;
               |O #0#17 ! 0; |O #0#18 ! 0; |O #0#19 ! 0;
               |O #0#22 ! 0; |O #0#23 ! 0; |O #0#24 ! 0;
                  #110#34 = #110#34 + 1;
              |FINSI;
          |FINSI;

          |SI #0#6 = "PASEANTERIOR";  |O #0#6 = "MANUAL      ";
              |SI #0#30 ! 0;  #110#31 = #0#30;  |FINSI;
              |SI #0#31 ! 0;  #110#34 = #0#31;  |FINSI;
          |FINSI;

          #110#32 = #110#32 + #0#10 + #0#15 + #0#20;
          #110#33 = #110#33 + #0#11 + #0#16 + #0#21;
          #110#35 = #110#35 + #0#12 + #0#17 + #0#22;
          #110#36 = #110#36 + #0#13 + #0#14 + #0#18 + #0#19 + #0#23 + #0#24;
     |FINSI;

     #110#27 = #110#8 + #110#11 + #110#14 + #110#17 + #110#20 + #110#23 + #110#26 + #110#33 + #110#36;
     #110#28 = nImpAnt;
     #110#29 = #110#27 - #110#28;

     |SI aDNIAnt ! #0#6;  aDNIAnt = #0#6;  |FINSI;

     |SI #0#6 ! "PASEANTERIOR"; || Tique 1185_405 |Y #0#6 ! "MANUAL      "; sumar tambien los manuales
         |HAZ GrabaAuxiliar;
     |FINSI;
|FPRC;

|DEFBUCLE dsmoc110;
     #0#1;
     ;
     enEmpresa, enEjer, enPeriodo, nMod, enComplem, 01, aDn, nDd, " ", "  ";
     enEmpresa, enEjer, enPeriodo, nMod, enComplem, 99, aHn, nHd, "z", "zz";
     be;
     NULL, GrabaModelo;
|FIN;

|PROCESO GrabaRegistro0;
     |SI enModelo = 110;
         |ABRE #110;
         #110#0 = enEmpresa;
         #110#1 = enEjer;
         #110#2 = enPeriodo;
         #110#3 = enModelo;
         #110#4 = enComplem;
         #110#5 = 0;
         |LEE 101#110=;
         |SI FSalida = 0;
             |BORRA 020#110a;
         |FINSI;
         |LIBERA #110;
     |FINSI;

     |ABRE #8;
     #8#0 = enEmpresa;
     #8#1 = enEjer;
     #8#2 = enPeriodo;
     #8#3 = enModelo;
     #8#4 = enComplem;
     #8#5 = 0;
     |LEE 101#8=;
     |SI FSalida = 0;
         #8#11 = "SIN DATOS ";
         |GRABA 020#8a;
     |FINSI;
     |LIBERA #8;
     |CIERRA #8;
|FPRC;

|PROCESO BajaModelo;
     |BORRA 020#0a;
     |LIBERA #0;
|FPRC;

|DEFBUCLE dsmoc110B;
     #0#1;
     ;
     enEmpresa, enEjer, enPeriodo, nMod, enComplem, enActividad, aDn, nDd, " ", "  ";
     enEmpresa, enEjer, enPeriodo, nMod, enComplem, enActividad, aHn, nHd, "z", "zz";
     be;
     NULL, BajaModelo;
|FIN;

|PROCESO BorraRegistros;
     |BUCLE dsmoc110B;
     |HAZ GrabaRegistro0;

     |ABRE #8;
     #8#0 = enEmpresa;
     #8#1 = enEjer;
     #8#2 = nPer;
     #8#3 = 110;
     #8#4 = enComplem;
     #8#5 = enActividad;
     |LEE 101#8=;
     |SI FSalida = 0;
         #8#11 = "SIN DATOS";
         |GRABA 020#8a;
     |FINSI;
     |LIBERA #8;
     |CIERRA #8;
|FPRC;

|PROCESO LeeGrupo;
     |ABRE #3;
     #3#0=#0#8;
     #3#1=#0#9;
     |LEE 000#3=;
     |SI FSalida=0;
          nGrupo = #3#3;
     |SINO;
||          |MENAV "0000No ha configurado el grupo de rendimiento. Datos no grabados!";
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO GrabaTodo;
     aFichero = "x" + Usuario;
     |NOME_DAT #904 aFichero;
     |DELINDEX #904;

     |ABRE #110;
     nImpAnt = 0;
     |SI enComplem > 0;
         #110#0 = enEmpresa;
         #110#1 = enEjer;
         #110#2 = enPeriodo;
         #110#3 = enModelo;
         #110#4 = enComplem - 1;
         #110#5 = 0;
         |LEE 101#110=;
         |SI FSalida = 0;
             nImpAnt = #110#29 + #110#28;
             |SI nImpAnt < 0; nImpAnt = 0; |FINSI;
         |FINSI;
     |FINSI;
     #110#0 = enEmpresa;
     #110#1 = enEjer;
     #110#2 = enPeriodo;
     #110#3 = enModelo;
     #110#4 = enComplem;
     #110#5 = 0;
     |LEE 101#110=;
     |SI FSalida = 0;
          |BORRA 020#110a;
     |FINSI;

     |DDEFECTO #110;
     #110#0 = enEmpresa;
     #110#1 = enEjer;
     #110#2 = enPeriodo;
     #110#3 = enModelo;
     #110#4 = enComplem;
     #110#5 = 0;

     nSwGraba = 0;
     nSwAux   = 0;
     |BUCLE dsmoc110;
     |SI nSwGraba = 0;
         FSalida = 0;
         |SI enDesdePase = 0;
             |SI enMasivo = 1;
                 aAlfa = ("00000" + enEmpresa) % -105;
                 aAlfa = aAlfa + " " + eaNombreEmp; |QBF aAlfa;
                 aAlfa = "0000N"+ aAlfa + ". No hay registros NIF desea Impreso SIN Actividad ";
             |SINO;
                 aAlfa = "0000NNo hay registros de NIF desea Impreso SIN Actividad ";
             |FINSI;
             |CONFI aAlfa;
             nNume = FSalida;
             |SI enMasivo = 1; |Y enFichW103 ! 0;
                 eaCa8103 = "S"; |SI nNume ! 0; eaCa8103 = "N"; |FINSI;
                 |HAZ eGrabaW103;
             |FINSI;
             FSalida = nNume;
         |FINSI;

         |SI FSalida = 0;
             |DDEFECTO #0;
             #0#0 = enEmpresa;
             #0#1 = enEjer;
             #0#2 = enPeriodo;
             #0#3 = enModelo;
             #0#4 = enComplem;
             #0#5 = enActividad;
             #0#6 = "            ";
             #0#7 = 0000;
             #0#8 = " ";
             #0#9 = "  ";
             |LEE 101#0=;
             |SI FSalida ! 0;
                 |GRABA 020#0b;
             |FINSI;
             |GRABA 020#0a;
             |LIBERA #0;
             nSwGraba = 1;
         |FINSI;
     |FINSI;

     |SI nSwGraba ! 0;
         |SI nSwAux = 1; |HAZ RepasoAux; |FINSI;

         |SI #110#4 ! 0;  |Y #110#30 = "             ";
             |ABRE #4;
             #4#0 = #110#0;
             #4#1 = #110#1;
             #4#2 = #110#2;
             #4#3 = #110#3;
             #4#4 = #110#4 - 1;
             |LEE 000#4=;
             |SI FSalida ! 0;  |DDEFECTO #4;  |FINSI;
             |CIERRA #4;

             #110#30 = #4#19;
         |FINSI;

         |GRABA 020#110n;
         |LIBERA #110;

          |ABRE #8;
          #8#0 = enEmpresa;
          #8#1 = enEjer;
          #8#2 = enPeriodo;
          #8#3 = enModelo;
          #8#4 = enComplem;
          #8#5 = enActividad;
          |LEE 101#8=;
          |SI FSalida = 0;
               #8#11 = "COMPLETADO";
               |GRABA 020#8a;
          |FINSI;
          |LIBERA #8;

          #8#0 = enEmpresa;
          #8#1 = enEjer;
          #8#2 = enPeriodo;
          #8#3 = enModelo;
          #8#4 = enComplem;
          #8#5 = 0;
          |LEE 101#8=;
          |SI FSalida = 0;
               #8#11 = "EXISTENTE";
               |GRABA 020#8a;
          |FINSI;
          |LIBERA #8;
          |CIERRA #8;
     |FINSI;
     |CIERRA #110;

     |DELINDEX #904;
|FPRC;

|PROCESO Boton;
     |PTEC 827;
|FPRC;

|PROCESO Tipo0Fc110;  |TIPO 0;
     |SI FSalida ! 13;  |ACABA;  |FINSI;

     |PUSHV 0526 2379;

     |DDEFECTO #992;

     #992#0  = #0#10;
     #992#1  = (#0#11 / #0#10) * 100;
     #992#2  = #0#11;

     #992#3  = #0#12;
     #992#4  = (#0#13 / #0#12) * 100;
     #992#5  = #0#13;
     |SI #0#14 ! 0;  #992#6 = "S";  |FINSI;

     #992#7  = #0#15;
     #992#8  = (#0#16 / #0#15) * 100;
     #992#9  = #0#16;

     #992#10 = #0#17;
     #992#11 = (#0#18 / #0#17) * 100;
     #992#12 = #0#18;
     |SI #0#19 ! 0;  #992#13 = "S";  |FINSI;

     #992#14 = #0#20;
     #992#15 = (#0#21 / #0#20) * 100;
     #992#16 = #0#21;

     #992#17 = #0#22;
     #992#18 = (#0#23 / #0#22) * 100;
     #992#19 = #0#23;
     |SI #0#24 ! 0;  #992#20 = "S";  |FINSI;

     |C_M #992#7,  1, "S";
     |C_M #992#8,  1, "S";
     |C_M #992#9,  1, "S";
     |C_M #992#10, 1, "S";
     |C_M #992#11, 1, "S";
     |C_M #992#12, 1, "S";
     |C_M #992#13, 1, "S";
     |C_M #992#14, 1, "S";
     |C_M #992#15, 1, "S";
     |C_M #992#16, 1, "S";
     |C_M #992#17, 1, "S";
     |C_M #992#18, 1, "S";
     |C_M #992#19, 1, "S";
     |C_M #992#20, 1, "S";

     |C_M #0#15, 0, aAlfa;
     |SI aAlfa = "N";
         |C_M #992#7,  1, "N";
         |C_M #992#8,  1, "N";
         |C_M #992#9,  1, "N";
         |C_M #992#10, 1, "N";
         |C_M #992#11, 1, "N";
         |C_M #992#12, 1, "N";
         |C_M #992#13, 1, "N";
     |FINSI;

     |C_M #0#20, 0, aAlfa;
     |SI aAlfa = "N";
         |C_M #992#14, 1, "N";
         |C_M #992#15, 1, "N";
         |C_M #992#16, 1, "N";
         |C_M #992#17, 1, "N";
         |C_M #992#18, 1, "N";
         |C_M #992#19, 1, "N";
         |C_M #992#20, 1, "N";
     |FINSI;

     |PINPA #0#992;
     |PINDA #0#992;

     |ENDATOS #1#992;
     |SI FSalida = 0;
         #0#10 = #992#0;
         #0#11 = #992#2;
         #0#12 = #992#3;
         #0#13 = #992#5;
         |SI #992#6 = "S";  #0#14 = #0#13;  |FINSI;

         #0#15 = #992#7;
         #0#16 = #992#9;
         #0#17 = #992#10;
         #0#18 = #992#12;
         |SI #992#13 = "S";  #0#19 = #0#18;  |FINSI;

         #0#20 = #992#14;
         #0#21 = #992#16;
         #0#22 = #992#17;
         #0#23 = #992#19;
         |SI #992#20 = "S";  #0#24 = #0#23;  |FINSI;
     |FINSI;

     |POPV;

     |PINTA #0#10;  |PINTA #0#11;
     |PINTA #0#12;  |PINTA #0#13;  |PINTA #0#14;
     |PINTA #0#15;  |PINTA #0#16;
     |PINTA #0#17;  |PINTA #0#18;  |PINTA #0#19;
     |PINTA #0#20;  |PINTA #0#21;
     |PINTA #0#22;  |PINTA #0#23;  |PINTA #0#24;
|FPRC;

|PROCESO AltaModelo;
     |ABRET #0;
     |HAZ PintaDatos;

     |PINPA #0#0;

     |CONTROL_SIMPLE 0, "LBOTON,F5 Calculadora", 0668, 0678, Boton;
     nBoton = FSalida;

     |ESTADO_CONTROL nBoton, "DISABLE";

     |ENTLINEAL #1#0, -7, 2, 22, 0, ClaveBaja0, ClaveAlta0;

     |FIN_CONTROL_WINDOWS nBoton;

     |HAZ GrabaTodo;
     |CIERRAT #0;
|FPRC;

|RUTINA ClaveBaja0;
     #0#0 = enEmpresa;
     #0#1 = enEjer;
     #0#2 = enPeriodo;
     #0#3 = enModelo;
     #0#4 = enComplem;
     #0#5 = enActividad;
     #0#6 = "            ";
     #0#7 = 0000;
     #0#8 = " ";
     #0#9 = "  ";
|FRUT;

|RUTINA ClaveAlta0;
     #0#0 = enEmpresa;
     #0#1 = enEjer;
     #0#2 = enPeriodo;
     #0#3 = enModelo;
     #0#4 = enComplem;
     #0#5 = enActividad;
     #0#6 = "zzzzzzzzzzzz";
     #0#7 = 9999;
     #0#8 = "z";
     #0#9 = "zz";
|FRUT;

|PROCESO TipoCaptura;
     |ABRE #8;
     #8#0 = enEmpresa;
     #8#1 = enEjer;
     #8#2 = enPeriodo;
     #8#3 = enModelo;
     #8#4 = enComplem;
     #8#5 = enActividad;
     |LEE 101#8=;
     |SI FSalida = 0;
          aTipoCaptura = #8#7;
          |QBF aTipoCaptura;
     |FINSI;
     |CIERRA #8;
|FPRC;

|PROGRAMA;
     |ABRE #3;
     #3#0 = "L";
     #3#1 = "21";
     |LEE 000#3=;
     |SI FSalida ! 0;
         |MENAV "0000 Hay una nueva clave IRPF, se va a proceder a instalar el fichero";

         |CIERRA #3;
         eaExtension = "mod";
         eaPrograma  = "dsmom037";
         |SUB_EJECUTA_NP ":basica/dspatron";

         |ABRE #3;
         #3#0 = "L";
         #3#1 = "21";
         |LEE 000#3=;
         |SI FSalida = 0;
             |MENAV "0000 El fichero se ha instalado satisfactoriamente.";
         |SINO;
             |MENAV "0000 El fichero no se ha instalado, por favor instale la aplicacion ipbasica";
         |FINSI;
     |FINSI;
     |CIERRA #3;

     eaNoVisu = "";
     eaNomDef = "dsmoc110";

|| \\\\\\ Consulta del Modelo ////////

     |SI enTipoEntrada = 4;              || Consulta del Modelo
          |HAZ PintaDatos;
          |ENTLINEAL #1#0, -10, 4, 22, 1, ClaveBaja0, ClaveAlta0;
          |ACABA;
     |FINSI;

|| \\\\\\ Baja del Modelo ////////

     |SI enTipoEntrada = 3;              ||Baja del Modelo
         |HAZ BorraRegistros;
         |ABRET #0;
         |HAZ GrabaTodo;
         |CIERRAT #0;
         |ACABA;
     |FINSI;

|| \\\\\\ Baja del Modelo desde Modulo////////

     |SI enTipoEntrada = 97;              ||Baja del Modelo
         |HAZ BorraRegistros;
         |ACABA;
     |FINSI;

|| \\\\\\ Alta o Modificacion del Modelo ////////

     |SI enTipoEntrada = 1;              || Alta del Modelo
         |CABEZA "Modelo Trabajo 110";
         |HAZ AltaModelo;
         |ACABA;
     |FINSI;

|| \\\\\\ Grabacion del Modelo desde el Exterior

     |SI enTipoEntrada = 98;
         |ABRET #0;
         |HAZ GrabaTodo;
         |CIERRAT #0;
         |ACABA;
     |FINSI;

|| \\\\\\ Comprobacion Existencia del Modelo

     |SI enTipoEntrada = 99;              || Existencia del Modelo ????
         |ABRE #0;
         #0#0 = enEmpresa;
         #0#1 = enEjer;
         #0#2 = enPeriodo;
         #0#3 = enModelo;
         #0#4 = enComplem;
         #0#5 = enActividad;
         #0#6 = "            ";
         #0#7 = 0;
         #0#8 = " ";
         #0#9 = "  ";
         |LEE 040#0];
         |SI FSalida ! 0;  |O #0#0 ! enEmpresa;  |O #0#1 ! enEjer; |O #0#2 ! enPeriodo;
          |O #0#3 ! enModelo;  |O #0#4 ! enComplem; |O #0#5 ! enActividad;
             enExistencia = 1;
         |FINSI;
         |CIERRA #0;
     |FINSI;
|FPRO;
