|FICHEROS;
     dsmom018 #18;
     dsmom019 #19;
     dsmom020 #20;
|FIN;

|VARIABLES;
     aDesde    = "";
     aHasta    = "";
     aAlfa1    = "";
     aAlfa2    = "";

     nSalida18 = 0;
     nSalida19 = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO Informa;
     |PUSHV 0501 2380;
     |BLANCO 0854 2280;
     |CUADRO 0753 2380;
     |ATRI I;

     |PINTA 0854, "   DESGLOSE DE TIPOS      ";
     |SI #20#1 ] 2000;
         |PINTA 1054, "  -01- <19 a¤os/Min.33%";
     |SINO;
         |PINTA 1054, "  -01- Menores 19 a¤os ";
     |FINSI;
     |PINTA 1154, "  -02- Aprendices      ";
     |PINTA 1254, "  -03- F.Academica     ";
     |PINTA 1354, "  -04- Resto personal  ";

     |SI #20#1 ] 2000;
         |PINTA 1554, "  -05- <19 a¤os/Min.33%";
     |SINO;
         |PINTA 1554, "  -05- Menores 19 a¤os ";
     |FINSI;
     |PINTA 1654, "  -06- Aprendices      ";
     |PINTA 1754, "  -07- F.Academica     ";
     |PINTA 1854, "  -08- Resto personal  ";
     |PINTA 2054, "  -09- Titular         ";
     |PINTA 2154, "  -10- Conyuge         ";
     |PINTA 2254, "  -11- Hijos           ";

     |ATRI R;

     |PINTA 0954, " Personal Asalariado      ";
     |PINTA 1454, " Resto Personal Asalar.   ";
     |PINTA 1954, " Personal No Asalariado   ";

     |ATRI 0;
     |PAUSA;
     |POPV;
|FPRC;

|PROCESO PintaTipo;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     |HAZ Informa;
     |ERROR;
|FPRC;

|PROCESO Tipo11m020;  |TIPO 11;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     |HAZ Informa;
     |ERROR;
|FPRC;

|PROCESO HorasTP;  |TIPO 0;
     #20#10  = #20#8 * #20#9;
     #20#12 = #20#10 / #20#11;
     |SI #20#12 > 1;  #20#12 = 1;  |FINSI;

     |PINTA #20#10;
     |PINTA #20#12;
|FPRC;

|PROCESO HorasTD;  |TIPO 0;
     #20#15 = #20#13 * #20#14;
     #20#17 = #20#15 / #20#16;
     |SI #20#17 > 1;  #20#17 = 1;  |FINSI;

     |PINTA #20#15;
     |PINTA #20#17;
|FPRC;

|RUTINA ClaveBaja20;
     #20#0 = enEmpresa;
     #20#1 = enEjer;
     #20#2 = enComplem;
     #20#3 = enActividad;
     #20#4 = 1;
|FRUT;

|RUTINA ClaveAlta20;
     #20#0 = enEmpresa;
     #20#1 = enEjer;
     #20#2 = enComplem;
     #20#3 = enActividad;
     #20#4 = 999;
|FRUT;

|PROCESO CalculaTrab;
     |SI #20#6 = "R";  |O #20#6 = "A";
         |SI #20#5 [ 8;
             #18#254 = #18#254 + 1;

             aAlfa2 = #20#7;
             |SI aAlfa2 ! aAlfa1;
                 |SI #20#5 [ 4;
                     |SI #20#12 ! 0;  #18#97 = #18#97 + 1;  |FINSI;
                     |SI #20#17 ! 0;  #18#98 = #18#98 + 1;  |FINSI;
                 |FINSI;

                 |SI #20#5 > 4;
                     |SI #20#12 ! 0;  #18#99  = #18#99  + 1;  |FINSI;
                     |SI #20#17 ! 0;  #18#100 = #18#100 + 1;  |FINSI;
                 |FINSI;

                 aAlfa1  = aAlfa2;
             |FINSI;
         |FINSI;

         |SI #20#5 = 01;  #18#81  = #18#81  + #20#12;  |FINSI;
         |SI #20#5 = 02;  #18#85  = #18#85  + #20#12;  |FINSI;
         |SI #20#5 = 03;  #18#89  = #18#89  + #20#12;  |FINSI;
         |SI #20#5 = 04;  #18#93  = #18#93  + #20#12;  |FINSI;

         |SI #20#5 = 01;  #18#82  = #18#82  + #20#17;  |FINSI;
         |SI #20#5 = 02;  #18#86  = #18#86  + #20#17;  |FINSI;
         |SI #20#5 = 03;  #18#90  = #18#90  + #20#17;  |FINSI;
         |SI #20#5 = 04;  #18#94  = #18#94  + #20#17;  |FINSI;

         |SI #20#5 = 05;  #18#83  = #18#83  + #20#12;  |FINSI;
         |SI #20#5 = 06;  #18#87  = #18#87  + #20#12;  |FINSI;
         |SI #20#5 = 07;  #18#91  = #18#91  + #20#12;  |FINSI;
         |SI #20#5 = 08;  #18#95  = #18#95  + #20#12;  |FINSI;

         |SI #20#5 = 05;  #18#84  = #18#84  + #20#17;  |FINSI;
         |SI #20#5 = 06;  #18#88  = #18#88  + #20#17;  |FINSI;
         |SI #20#5 = 07;  #18#92  = #18#92  + #20#17;  |FINSI;
         |SI #20#5 = 08;  #18#96  = #18#96  + #20#17;  |FINSI;

         |SI #20#5 = 09;  #18#101 = #18#101 + #20#12;  |FINSI;
         |SI #20#5 = 10;  #18#103 = #18#103 + #20#12;  |FINSI;
         |SI #20#5 = 11;  #18#105 = #18#105 + #20#12;  |FINSI;

         |SI #20#5 = 09;  #18#102 = #18#102 + #20#17;  |FINSI;
         |SI #20#5 = 10;  #18#104 = #18#104 + #20#17;  |FINSI;
         |SI #20#5 = 11;  #18#106 = #18#106 + #20#17;  |FINSI;
     |FINSI;

     |SI #20#6 = "I";  |O #20#6 = "A";
         |SI #20#5 = 01;  #19#81  = #19#81  + #20#12;  |FINSI;
         |SI #20#5 = 02;  #19#85  = #19#85  + #20#12;  |FINSI;
         |SI #20#5 = 03;  #19#89  = #19#89  + #20#12;  |FINSI;
         |SI #20#5 = 04;  #19#93  = #19#93  + #20#12;  |FINSI;

         |SI #20#5 = 01;  #19#82  = #19#82  + #20#17;  |FINSI;
         |SI #20#5 = 02;  #19#86  = #19#86  + #20#17;  |FINSI;
         |SI #20#5 = 03;  #19#90  = #19#90  + #20#17;  |FINSI;
         |SI #20#5 = 04;  #19#94  = #19#94  + #20#17;  |FINSI;

         |SI #20#5 = 05;  #19#83  = #19#83  + #20#12;  |FINSI;
         |SI #20#5 = 06;  #19#87  = #19#87  + #20#12;  |FINSI;
         |SI #20#5 = 07;  #19#91  = #19#91  + #20#12;  |FINSI;
         |SI #20#5 = 08;  #19#95  = #19#95  + #20#12;  |FINSI;

         |SI #20#5 = 05;  #19#84  = #19#84  + #20#17;  |FINSI;
         |SI #20#5 = 06;  #19#88  = #19#88  + #20#17;  |FINSI;
         |SI #20#5 = 07;  #19#92  = #19#92  + #20#17;  |FINSI;
         |SI #20#5 = 08;  #19#96  = #19#96  + #20#17;  |FINSI;

         |SI #20#5 = 09;  #19#101 = #19#101 + #20#12;  |FINSI;
         |SI #20#5 = 10;  #19#103 = #19#103 + #20#12;  |FINSI;
         |SI #20#5 = 11;  #19#105 = #19#105 + #20#12;  |FINSI;

         |SI #20#5 = 09;  #19#102 = #19#102 + #20#17;  |FINSI;
         |SI #20#5 = 10;  #19#104 = #19#104 + #20#17;  |FINSI;
         |SI #20#5 = 11;  #19#106 = #19#106 + #20#17;  |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsmom020;
  #20#2;
  ;
  enEmpresa, enEjer, enComplem, enActividad, aDesde, 000;
  enEmpresa, enEjer, enComplem, enActividad, aHasta, 999;
  ;
  NULL, CalculaTrab;
|FIN;

|PROGRAMA;
      |SI eaDesTrab = "N";  |ACABA;  |FINSI;

      |SI enNoLineal = 0;
          |ENTLINEAL #1#20, -5, 2, 22, 1, ClaveBaja20, ClaveAlta20;
      |FINSI;

      aDesde = " " * 40;
      aHasta = "z" * 40;

      enEntradaMod = 2;
      |SUB_EJECUTA "dsmom018";
      |SUB_EJECUTA "dsmom019";

      |ABRE #18;
      #18#0 = enEmpresa;
      #18#1 = enEjer;
      #18#2 = enComplem;
      #18#3 = enActividad;
      |LEE 101#18=;
      nSalida18 = FSalida;

      |ABRE #19;
      #19#0 = enEmpresa;
      #19#1 = enEjer;
      #19#2 = enComplem;
      #19#3 = enActividad;
      |LEE 101#19=;
      nSalida19 = FSalida;

      |PDEFECTO #18, 81, 107;
      |PDEFECTO #19, 81, 107;
      #18#254 = 0;

      aAlfa1  = "";
      aAlfa2  = "";
      |BUCLE dsmom020;

      |SI nSalida18 = 0;  |GRABA 020#18a;  |FINSI;
      |SI nSalida19 = 0;  |GRABA 020#19a;  |FINSI;

      |LIBERA #18;
      |CIERRA #18;

      |LIBERA #19;
      |CIERRA #19;

      enEntradaMod = 1;
      |SUB_EJECUTA "dsmom018";
      |SUB_EJECUTA "dsmom019";

      enEntradaMod = 0;
|FPRO;
