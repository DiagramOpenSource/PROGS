|FICHEROS;
     dsmoy052 #0;
     dsmom054 #54;  ||Mant. Rendimientos
     dsmom055 #55;  ||Socios
|FIN;

|VARIABLES;
     nEstado   = 0;
     nCampo    = 0;
     nDEmpresa = 0;
     nHEmpresa = 0;
     nPeriodo  = 0;
     nEjer     = 0;
     fFecha    = @;
     aAlfa1    = "";
     aAlfa2    = "";
     aFichero  = "";
     aPath     = "";

     &eaCabe   = "";
     &swLinea  = 0;
     nCSocios  = 0;
     nNume1    = 0;
     nNume2    = 0;
     nNume3    = 0;
     nNume4    = 0;
     nPara1    = 0;
|FIN;

|INCLUYE i_variar;
|INCLUYE i_varcon;

|| /////////////////////// PROCESOS ENTRADA POR PANTALLA \\\\\\\\\\\\\\\\\\\\
|CALCULO ElAny; |TIPO 7;
 fFecha = ~;
 aAlfa1 = fFecha;
 aAlfa1 = aAlfa1 % -104;
 #0#14 = aAlfa1;
 #0#14 = #0#14 - 1;
 |PINTA #0#14;
|FCAL;

|PROCESO Tipo7;  |TIPO 7;
     |SI enEmpresa ! 0;
         #0#0 = enEmpresa;  |PINTA #0#0;
         #0#1 = enEmpresa;  |PINTA #0#1;

         |C_M #0#0, 1, "N";
         |C_M #0#1, 1, "N";
     |FINSI;
|FPRC;

|PROCESO Parrilla;
     |SI #0#0 = 0;
         #0#0 = 0;  |PINTA #0#0;
         #0#1 = 0;  |PINTA #0#1;  |C_M #0#1, 1, "N";
         |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |SINO;
         |SI enEmpresa = 0;
             |C_M #0#0, 1, "S";
             |C_M #0#1, 1, "S";
         |FINSI;

         |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
               #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasEmpresas;
     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               #0nCampo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|| /////////////////////// //////////////////////////////////////////////////
|| /////////////////////// PROCESOS DE INFORMES \\\\\\\\\\\\\\\\\\\\\
|PROCESO enpapel;
 |SI nCSocios = 1; eaCabe = "    SOCIO 01"; |FINSI;
 |SI nCSocios = 2; eaCabe = "    SOCIO 01      SOCIO 02"; |FINSI;
 |SI nCSocios = 3; eaCabe = "    SOCIO 01      SOCIO 02      SOCIO 03"; |FINSI;
 |SI nCSocios = 4; eaCabe = "    SOCIO 01      SOCIO 02      SOCIO 03      SOCIO 04"; |FINSI;
 |PRINT;
 |PIEINF;
 |PDEFECTO #0, 15, 63;
|FPRC;

|PROCESO ImpSocios0;
  nCSocios = nCSocios + 1;
  |SI nCSocios > 4;
      |HAZ enpapel;
      nCSocios = 1;
  |FINSI;
  nNume2 = 14 + (nCSocios - 1 ) * 11;
  |PARA nPara1 = 1; |SI nPara1 [ 11; |HACIENDO nPara1 = nPara1 + 1;
        nNume1 = nPara1 + 6;
        nNume2 = nNume2 + 1;
        #0nNume2 = #55nNume1;
  |SIGUE;
  nNume2  = 58 + nCSocios;
  #0nNume2 = #55#5; ||% participacion
|FPRC;

|DEFBUCLE ImpSocios;
    #55#1;
    ;
    #54#0, #54#1, 001;
    #54#0, #54#1, 999;
    be;
    NULL, ImpSocios0;
|FIN;

|| ....................................................................

|PROCESO Imprimir0;
 nCSocios = 0;
 |BUCLE ImpSocios;
 |SI nCSocios ! 0;
     |HAZ enpapel;
 |FINSI;
|FPRC;

|| .....................................................................
|DEFBUCLE Imprimir;
    #54#1;
    ;
    nDEmpresa, enEjer;
    nHEmpresa, enEjer;
    be;
    NULL, Imprimir0;
|FIN;

|| \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
|PROCESO ITipo3;  |TIPO 3;
     |IMPRE 0;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |INFOR "dsmoy052";
     |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;

     enEjer      = #0#14;        || A¤o Calculo
     aAlfa1      = #0#14;
     aAlfa1      = aAlfa1 % -102;
     nEjer       = aAlfa1;       || Dos ultimos digitos del A¤o
     |SI #0#0 ! 0;
         nDEmpresa = #0#0;
         nHEmpresa = #0#1;
         |BUCLE Imprimir;
     |SINO;
         |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               nDEmpresa = #0nCampo;
               nHEmpresa = #0nCampo;
               |BUCLE Imprimir;         || Imprimir Valor
         |SIGUE;
     |FINSI;
     |FININF;
     |FINIMP;
|FPRC;

|| =========================================================================
|PROGRAMA;
 |SI enEmpresa ! 0;
     #0#0 = enEmpresa;
     #0#1 = enEmpresa;
     #0#14 = enEjer;
     |HAZ ITipo3;
 |SINO;
     |CLS;
     |MANTE #0;
 |FINSI;
|FPRO;
