|FICHEROS;
     dsmoc310 #0;
     dsmoc311 #1,MANTE;
     dsmoc349 #349;
     dsmod310 #310;
     dsmod370 #370;
     dsmom004 #4;
     dsmom008 #8;
     dsmom017 #17;
     dsmom028 #28;
     dsmom047 #47;
     dsmom103 #103;

     dsmod310@ #1310;

     :/basica/def/agicen14 #114;
|FIN;

|VARIABLES;
     nSwEsta     = 0;
     nEjerAnt    = 0;
     nPer        = 0;
     nSwGraba    = 0;
     nTipo       = 0;
     nCompensar  = 0;
     nDPeriodo   = 0;
     nHPeriodo   = 0;
     nCuotaSopor = 0;
     nTotal      = 0;
     nHComple    = 0;
     nEl36       = 0;

     nParaBorra  = 0;
     aPathModelo = "";
     aDef        = "";
     aAlfa       = "";
     aBase       = "";
     aMas        = "";

     &EURODB     = 0;
|FIN;

|INCLUYE i_variar;

|| --------------------------------------------------------------------------
|| Calculos del proceso dsmoc311
|| --------------------------------------------------------------------------

|PROCESO Derivada;
     |SI #1#2 ! 12;
         nTotal      = #1#8 * #1#9;
         nTotal      = ((nTotal * #1#10) / 100) ! EURODB;
         nCuotaSopor = 0;
     |SINO;
         nTotal      = #1#8 * #1#9;
         nCuotaSopor = #1#11 + (nTotal % 1);
     |FINSI;

     #1#12 = nTotal - nCuotaSopor;
     |PINTA #1#12;
|FPRC;

|| --------------------------------------------------------------------------
|| Calculos del proceso dsmoc310
|| --------------------------------------------------------------------------

|RUTINA Baja1;
     #1#0 = #0#0;
     #1#1 = #0#1;
     #1#2 = #0#2;
     #1#3 = #0#3;
     #1#4 = #0#4;
     #1#5 = #0#5;
     #1#6 = 1;
|FRUT;

|RUTINA Alta1;
     #1#0 = #0#0;
     #1#1 = #0#1;
     #1#2 = #0#2;
     #1#3 = #0#3;
     #1#4 = #0#4;
     #1#5 = #0#5;
     #1#6 = 999;
|FRUT;

|PROCESO dsmoc311;
     #0#9 = #0#9 + #1#12;
|FPRC;

|DEFBUCLE dsmoc311;
     #1#1;
     ;
     #0#0, #0#1, #0#2, #0#3, #0#4, #0#5, 001;
     #0#0, #0#1, #0#2, #0#3, #0#4, #0#5, 999;
     ;
     NULL, dsmoc311;
|FIN;

|PROCESO Cultivos;  |TIPO 0;
     |SI #0#8 ! "S";  |ACABA;  |FINSI;

     |SI FSalida = 10;
         |PUSHV 0501 2380;

                         |C_M #1#11, 1, "S";
         |SI #0#2 ! 12;  |C_M #1#11, 1, "N";  |FINSI;

         |ENTLINEAL #1#1, -7, 2, 22, 1, Baja1, Alta1;
         |POPV;
     |FINSI;

     |ABRE #1;
     #1#0 = #0#0;
     #1#1 = #0#1;
     #1#2 = #0#2;
     #1#3 = #0#3;
     #1#4 = #0#4;
     #1#5 = #0#5;
     #1#6 = 1;
     |LEE 000#1];
     |SI FSalida = 0;  |Y #1#0 = #0#0; |Y #1#1 = #0#1; |Y #1#2 = #0#2;
                       |Y #1#3 = #0#3; |Y #1#4 = #0#4; |Y #1#5 = #0#5;
         |CIERRA #1;
         #0#9 = 0;
         |BUCLE dsmoc311;
         |PINTA #0#9;
     |FINSI;
     |CIERRA #1;
|FPRC;

|PROCESO dsmom004R;
     |SI #4#7 = " ";  |ACABA;  |FINSI;

     nCompensar = 0;
     |SI #4#15 < 0;  nCompensar = #4#15;  |FINSI;
|FPRC;

|DEFBUCLE dsmom004R;
     #4#1;
     ;
     enEmpresa, enEjer, nDPeriodo, enModelo, 00;
     enEmpresa, enEjer, nHPeriodo, enModelo, 99;
     ;
     NULL, dsmom004R;
|FINSI;

|PROCESO RecogeAnter;
     |SI enPeriodo = 3;
         enEjer     = enEjer - 1;
         nDPeriodo  = 12;
         nHPeriodo  = 12;
         nCompensar = 0;
         |BUCLE dsmom004R;
         enEjer = enEjer + 1;
     |SINO;
         nDPeriodo  = 3;
         nHPeriodo  = enPeriodo - 3;
         nCompensar = 0;
         |BUCLE dsmom004R;
     |FINSI;

     nEjerAnt = 0;
     |SI nCompensar < 0;
         |SI enPeriodo ! 3;
             nEjerAnt = -nCompensar;
         |SINO;
             |HAZ UltimoPeriodo;
             |SI eaUltimoPer = "COMPENSAR";
                 nEjerAnt = -nCompensar;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nEjerAnt = 0;
         |ABRE #103;
         #103#0 = enModelo;
         #103#1 = enEmpresa;
         #103#2 = 0;
         #103#3 = enEjer;
         |SI enPeriodo = 3;
             #103#3 = enEjer - 1;
             #103#4 = 12;
         |SINO;
             #103#4 = enPeriodo - 3;
         |FINSI;
         |LEE 040#103=;
         |SI FSalida = 0;
             nEjerAnt = #103#5;
         |FINSI;
         |CIERRA #103;
     |FINSI;

     |ABRE #47;
     #47#0 = enEmpresa;
     #47#1 = enEjer;
     #47#2 = enPeriodo;
     #47#3 = enModelo;
     #47#4 = enComplem;
     #47#5 = 0;
     |LEE 040#47=;
     |SI FSalida ! 0;  |DDEFECTO #47;  |FINSI;
     |CIERRA #47;

     |ABRE #28;
     #28#0 = enEmpresa;
     #28#1 = enEjer;
     #28#2 = enPeriodo;
     #28#3 = enModelo;
     #28#4 = enComplem;
     #28#5 = 0;
     |LEE 040#28=;
     |SI FSalida ! 0;  |DDEFECTO #28;  |FINSI;
     |CIERRA #28;

     |SI #28#7 = "N";  |ACABA;  |FINSI;

     nEjerAnt = nEjerAnt - #28#6;
     |SI nEjerAnt < 0;  nEjerAnt = 0;  |FINSI;
|FPRC;

|PROCESO GrabaModelo;
     nSwGraba = 1;
     #310#27 = #310#27 + #0#10;
     #310#28 = #310#28 + #0#11;
     #310#29 = #310#29 + #0#12;

     #310#31 = #310#31 + #0#13;
     #310#32 = #310#32 + #0#14;

     #310#37 = #310#37 + #0#15;

     |SI #0#16 ! 0;  #310#35 = #0#16;  |FINSI;

     |SI #0#8 = "N";
         |SI #310#6 = "    ";  |Y #310#7 = 0;
             #310#6 = #0#6;
             #310#7 = #0#9;
             |ACABA;
         |FINSI;

         |SI #310#8 = "    ";  |Y #310#9 = 0;
             #310#8 = #0#6;
             #310#9 = #0#9;
             |ACABA;
         |FINSI;

         |SI #310#10 = "    ";  |Y #310#11 = 0;
             #310#10 = #0#6;
             #310#11 = #0#9;
             |ACABA;
         |FINSI;

         |SI #310#12 = "    ";  |Y #310#13 = 0;
             #310#12 = #0#6;
             #310#13 = #0#9;
             |ACABA;
         |FINSI;

         |SI #310#14 = "    ";  |Y #310#15 = 0;
             #310#14 = #0#6;
             #310#15 = #0#9;
             |ACABA;
         |FINSI;

         #310#14 = "";
         #310#15 = #310#15 + #0#9;
     |FINSI;

     |SI #0#8 = "S";
         |SI #310#16 = "                                        ";  |Y #310#17 = 0;
             #310#16 = #0#7;
             #310#17 = #0#9;
             |ACABA;
         |FINSI;

         |SI #310#18 = "                                        ";  |Y #310#19 = 0;
             #310#18 = #0#7;
             #310#19 = #0#9;
             |ACABA;
         |FINSI;

         |SI #310#20 = "                                        ";  |Y #310#21 = 0;
             #310#20 = #0#7;
             #310#21 = #0#9;
             |ACABA;
         |FINSI;

         |SI #310#22 = "                                        ";  |Y #310#23 = 0;
             #310#22 = #0#7;
             #310#23 = #0#9;
             |ACABA;
         |FINSI;

         #310#22 = "";
         #310#23 = #310#23 + #0#9;
     |FINSI;
|FPRC;

|DEFBUCLE dsmoc310;
     #0#1;
     ;
     enEmpresa, enEjer, enPeriodo, enModelo, enComplem, 01;
     enEmpresa, enEjer, enPeriodo, enModelo, enComplem, 99;
     be;
     NULL, GrabaModelo;
|FIN;

|PROCESO IngreRealizados;
     #4#0   = #0#0;
     #4#1   = #0#1;
     #4#2   = #0#2;
     #4#3   = 310;
     #4#4   = #0#4 + 1;
     |LEE 040#4=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     #310#25 = #310#25 + #0#9;
|FPRC;

|DEFBUCLE dsmoc310R;
     #0#1;
     ;
     enEmpresa, enEjer, 3, 000,  0, 01;
     enEmpresa, enEjer, 9, 999, 99, 99;
     be;
     NULL, IngreRealizados;
|FIN;

|PROCESO dsmod310;
     #310#41 = #310#41 + #1310#40;
|FPRC;

|DEFBUCLE dsmod310;
     #1310#1006;
     ;
     #310#0, #310#1, #310#2, #310#3,        0, #310#5;
     #310#0, #310#1, #310#2, #310#3, nHComple, #310#5;
     ;
     NULL, dsmod310;
|FIN;

|PROCESO CapturaOtros310;
     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/dsmod310.mas";
     |CARGA_DEF aMas, dsmod310@;

     nHComple = #310#4 - 1;
     #310#41  = 0;

     |BUCLE dsmod310;

     |DESCARGA_DEF #dsmod310@;
|FPRC;

|PROCESO Totales310;
     |SI #310#2 = 12;
         #310#25 = 0;
         |ABRE #4;
         |BUCLE dsmoc310R;
         |CIERRA #4;
     |FINSI;
     #310#13 = #310#13 - #47#13;  ||regularizacion Manual

     #310#24 = #310#7  + #310#9  + #310#11 + #310#13 + #310#15;
     #310#24 = #310#24 + #310#17 + #310#19 + #310#21 + #310#23;
     #310#26 = #310#24 - #310#25;
     #310#30 = #310#26 + #310#27 + #310#28 + #310#29;
     #310#33 = #310#31 + #310#32;
     #310#34 = #310#30 - #310#33;
     #310#36 = #310#34 - #310#35;
     nEl36   = #310#36;

     |SI #310#4 > 0;
         |HAZ CapturaOtros310;
         nEl36 = nEl36 - #310#41;
         |SI nEl36 < 0;
             |MENAV "    RECUERDE. Si el resultado NO es a INGRESAR, NO procede declaracion complementaria";
         |FINSI;
     |FINSI;

     |SI nEl36 ] 0;
         #310#40 = nEl36;
     |SINO;
         |SI #310#2 = 12;
             |HAZ UltimoPeriodo;
             |SI eaUltimoPer = "COMPENSAR";
                 #310#38 = -nEl36;
                 #310#39 = 0;
                 #310#40 = 0;
             |SINO;
                 #310#39 = -nEl36;
                 #310#38 = 0;
                 #310#40 = 0;
             |FINSI;
         |SINO;
             #310#38 = -nEl36;
             #310#39 = 0;
             #310#40 = 0;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO GrabaRegistro0;
     |SI enModelo = 310;
         |ABRE #310;
         #310#0 = enEmpresa;
         #310#1 = enEjer;
         #310#2 = enPeriodo;
         #310#3 = enModelo;
         #310#4 = enComplem;
         #310#5 = 0;
         |LEE 101#310=;
         |SI FSalida = 0;
             |BORRA 020#310a;
         |FINSI;
         |LIBERA #310;
     |FINSI;

     |SI enModelo = 370;
         |ABRE #370;
         #370#0 = enEmpresa;
         #370#1 = enEjer;
         #370#2 = enPeriodo;
         #370#3 = enModelo;
         #370#4 = enComplem;
         #370#5 = 0;
         |LEE 101#370=;
         |SI FSalida = 0;
             |BORRA 020#370a;
         |FINSI;
         |LIBERA #370;
     |FINSI;

     |ABRE #8;
     #8#0 = enEmpresa;
     #8#1 = enEjer;
     #8#2 = enPeriodo;
     #8#3 = enModelo;
     #8#4 = enComplem;
     #8#5 = 0;
     |LEE 101#8=;
     |SI FSalida = 0;
         #8#11 = "SIN DATOS ";
         |GRABA 020#8a;
     |FINSI;
     |LIBERA #8;
     |CIERRA #8;

     |SI enModelo = 310;
         #310#0 = enEmpresa;
         #310#1 = enEjer;
         #310#2 = enPeriodo;
         #310#3 = enModelo;
         #310#4 = enComplem;
         #310#5 = 0;
         |LEE 101#310=;
         |SI FSalida ! 0;
             |DDEFECTO #310;
             #310#0 = enEmpresa;
             #310#1 = enEjer;
             #310#2 = enPeriodo;
             #310#3 = enModelo;
             #310#4 = enComplem;
             #310#5 = 0;
             |GRABA 020#310b;
         |FINSI;

         |HAZ RecogeAnter;
         #310#35 = nEjerAnt;

         nSwGraba = 0;
         |BUCLE dsmoc310;

         |SI nSwGraba = 0;
             |BORRA 020#310c;
             |LIBERA #310;
             |CIERRA #310;
             |ACABA;
         |FINSI;

         |HAZ Totales310;

         |GRABA 020#310a;
         |LIBERA #310;
         |CIERRA #310;
     |FINSI;

     |SI enModelo = 370;
         nTipo         = enTipoEntrada;
         enTipoEntrada = 98;
         |SUB_EJECUTA_NP "dsmod370;NOMEQUITES";
         enTipoEntrada = nTipo;
         nSwGraba      = enExistencia;
     |FINSI;

     |ABRE #8;
     #0#0 = enEmpresa;
     #0#1 = enEjer;
     #0#2 = enPeriodo;
     #0#3 = enModelo;
     #0#4 = enComplem;
     #0#5 = enActividad;
     |LEE 040#0=;
     |SI FSalida = 0;
         #8#0 = enEmpresa;
         #8#1 = enEjer;
         #8#2 = enPeriodo;
         #8#3 = enModelo;
         #8#4 = enComplem;
         #8#5 = enActividad;
         |LEE 101#8=;
         |SI FSalida = 0;
             #8#11 = "COMPLETADO";
             |GRABA 020#8a;
         |FINSI;
         |LIBERA #8;
     |FINSI;

     |SI nSwGraba = 1;
         #8#0 = enEmpresa;
         #8#1 = enEjer;
         #8#2 = enPeriodo;
         #8#3 = enModelo;
         #8#4 = enComplem;
         #8#5 = 0;
         |LEE 101#8=;
         |SI FSalida = 0;
             #8#11 = "EXISTENTE";
             |GRABA 020#8a;
         |FINSI;
         |LIBERA #8;
     |FINSI;
     |CIERRA #8;
|FPRC;

|PROCESO BajaModelo;
     |SI enTipoEntrada = 97;
         |SI #0#10 = 0; |Y  #0#11 = 0; |Y  #0#12 = 0;
          |Y #0#13 = 0; |Y  #0#14 = 0; |Y  #0#15 = 0;  |Y #0#16 = 0;
             |BORRA 020#0a;
             |LIBERA #0;
         |SINO;
             #0#9 = 0;
             |GRABA 020#0a;
             |LIBERA #0;
             |ACABA;
         |FINSI;
     |SINO;
         |SI #0#10 ! 0;  |O #0#15 ! 0;
             |MENAV "     Entre y borre las Adquisiciones y Entregas.";
             |ERROR;
             |ACABA;
         |SINO;
             |BORRA 020#0a;
             |LIBERA #0;
         |FINSI;
     |FINSI;

     |ABRE #8;
     #8#0 = enEmpresa;
     #8#1 = enEjer;
     #8#2 = enPeriodo;
     #8#3 = enModelo;
     #8#4 = enComplem;
     #8#5 = enActividad;
     |LEE 101#8=;
     |SI FSalida = 0;
         #8#11 = "SIN DATOS ";
         |GRABA 020#8a;
     |FINSI;
     |LIBERA #8;
     |CIERRA #8;
|FPRC;

|DEFBUCLE dsmoc310B;
     #0#1;
     ;
     enEmpresa, enEjer, enPeriodo, enModelo, enComplem, enActividad;
     enEmpresa, enEjer, enPeriodo, enModelo, enComplem, enActividad;
     be;
     NULL, BajaModelo;
|FIN;

|PROCESO Tipo12moc310;  |TIPO 12;
|FPRC;

|PROCESO ChequeaGraba;
     |SI #0#9  = 0; |Y  #0#10 = 0; |Y  #0#11 = 0; |Y  #0#12 = 0;
      |Y #0#13 = 0; |Y  #0#14 = 0; |Y  #0#15 = 0; |Y  #0#16 = 0;
         |ABRE #17;
         #17#0 = #0#0;
         #17#1 = #0#1;
         #17#2 = #0#4;
         #17#3 = #0#5;
         |LEE 040#17=;
         |SI FSalida ! 0;  |DDEFECTO #17;  |FINSI;
         |CIERRA #17;

         nParaBorra = 0;
         |SI #0#2 = 3;  |Y #17#15 = 0; nParaBorra = 1;  |FINSI;
         |SI #0#2 = 6;  |Y #17#16 = 0; nParaBorra = 1;  |FINSI;
         |SI #0#2 = 9;  |Y #17#17 = 0; nParaBorra = 1;  |FINSI;
         |SI #0#2 = 12; |Y #17#18 = 0; nParaBorra = 1;  |FINSI;
         |SI nParaBorra = 1;
            |CONFI "0000NEl Importe es igual a Cero, desea Impreso SIN Actividad ";
            |SI FSalida = 0;
                |GRABA 020#0a;
                |ACABA;
            |FINSI;
         |FINSI;

         |SI #0#2 = 3;  |Y #17#15 = 0;
             enEntrada = 0;
             |BORRA 020#0a;
             |ACABA;
         |FINSI;

         |SI #0#2 = 6;  |Y #17#16 = 0;
             enEntrada = 0;
             |BORRA 020#0a;
             |ACABA;
         |FINSI;

         |SI #0#2 = 9;  |Y #17#17 = 0;
             enEntrada = 0;
             |BORRA 020#0a;
             |ACABA;
         |FINSI;

         |SI #0#2 = 12; |Y #17#24 = 0;
             enEntrada = 0;
             |BORRA 020#0a;
             |ACABA;
         |FINSI;
     |FINSI;

     |GRABA 020#0a;
|FPRC;

|PROCESO Calcu349;
     |SI #349#6 = "A ";
         #0#10 = #0#10 + #349#12 + #349#15 + #349#18 + #349#21;
     |FINSI;

     |SI #349#6 = "E ";
         #0#15 = #0#15 + #349#22;
     |FINSI;

     |SI #349#6 = "AR";
         |SI #349#24 = "-";
             #0#10 = #0#10 - (#349#12 + #349#15 + #349#18 + #349#21);
         |SINO;
             #0#10 = #0#10 + (#349#12 + #349#15 + #349#18 + #349#21);
         |FINSI;
     |FINSI;

     |SI #349#6 = "ER";
         |SI #349#24 = "-";
             #0#15 = #0#15 - #349#22;
         |SINO;
             #0#15 = #0#15 + #349#22;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsmoc349;
     #349#1;
     ;
     #0#0, #0#1, #0#2, 349, #0#4, #0#5, "  ", 0000, 0, "            ";
     #0#0, #0#1, #0#2, 349, #0#4, #0#5, "zz", 9999, 9, "zzzzzzzzzzzz";
     ;
     NULL, Calcu349;
|FIN;

|PROCESO Adquisiciones;
     |SI FSalida = 10;
         |ABRE #8;
         #8#0 = enEmpresa;
         #8#1 = enEjer;
         #8#2 = enPeriodo;
         #8#3 = enModelo;
         #8#4 = enComplem;
         #8#5 = enActividad;
         |LEE 040#8=;
         |SI FSalida ! 0;  |DDEFECTO #8;  |FINSI;
         |CIERRA #8;

         nTipo         = enTipoEntrada;
         enEmpresa     = #0#0;
         enEjer        = #0#1;
         enPeriodo     = #0#2;
         enComplem     = #0#4;
         enActividad   = #0#5;
         eaTipo349     = "A";
         eaNombreAct   = #8#6;
         eaCaptura     = #8#7;
         eaComunidad   = #8#9;
         eaComunero    = #8#10;
         enTipoEntrada = 1;
         enModelo349   = 310;
         |SUB_EJECUTA_NP "dsmoc349";
         enTipoEntrada = nTipo;
         eaTipo349     = "";
     |FINSI;

     #0#10 = 0;
     #0#15 = 0;
     |BUCLE dsmoc349;
     |PINTA #0#10;
     |PINTA #0#15;
|FPRC;

|PROCESO Entregas;
     |SI FSalida = 10;
         |ABRE #8;
         #8#0 = enEmpresa;
         #8#1 = enEjer;
         #8#2 = enPeriodo;
         #8#3 = enModelo;
         #8#4 = enComplem;
         #8#5 = enActividad;
         |LEE 040#8=;
         |SI FSalida ! 0;  |DDEFECTO #8;  |FINSI;
         |CIERRA #8;

         nTipo         = enTipoEntrada;
         enEmpresa     = #0#0;
         enEjer        = #0#1;
         enPeriodo     = #0#2;
         enComplem     = #0#4;
         enActividad   = #0#5;
         eaTipo349     = "E";
         eaNombreAct   = #8#6;
         eaCaptura     = #8#7;
         eaComunidad   = #8#9;
         eaComunero    = #8#10;
         enTipoEntrada = 1;
         enModelo349   = 310;
         |SUB_EJECUTA_NP "dsmoc349";
         enTipoEntrada = nTipo;
         eaTipo349     = "";
     |FINSI;

     #0#10 = 0;
     #0#15 = 0;
     |BUCLE dsmoc349;
     |PINTA #0#10;
     |PINTA #0#15;
|FPRC;

|PROCESO AltaModelo;
     nSwEsta   = 0;
     enEntrada = 1;

     |ABRE #0;
     #0#0 = enEmpresa;
     #0#1 = enEjer;
     #0#2 = enPeriodo;
     #0#3 = enModelo;
     #0#4 = enComplem;
     #0#5 = enActividad;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = enEmpresa;
         #0#1 = enEjer;
         #0#2 = enPeriodo;
         #0#3 = enModelo;
         #0#4 = enComplem;
         #0#5 = enActividad;
         nSwEsta = 1;

         |GRABA 020#0b;
     |FINSI;

     |ABRE #114;
     #114#0 = enEmpresa;
     #114#1 = enActividad;
     |LEE 040#114=;
     |SI FSalida ! 0;  |DDEFECTO #114;  |FINSI;
     |CIERRA #114;

     #0#6  = #114#3;
     #0#7  = #114#4;
     #0#8  = "N";

     |SI #114#11 = 100;
         #0#8 = "S";
     |FINSI;

     |SI #114#9 = 6;  |O #114#9 = 7;  |O #114#9 = 11;  |O #114#9 = 12;
         #0#8 = "S";
     |FINSI;

     |C_M #0#9, 1, "S";
     |SI enModi310 = 1;
         |C_M #0#9, 1, "N";
     |FINSI;

     |PINPA #0#0;
     |PINDA #0#0;
     |HAZ PintaDatos;
     |ENDATOS #1#0;
     |SI FSalida = 0;
         |HAZ ChequeaGraba;

         |ABRE #8;
         #8#0 = enEmpresa;
         #8#1 = enEjer;
         #8#2 = enPeriodo;
         #8#3 = enModelo;
         #8#4 = enComplem;
         #8#5 = enActividad;
         |LEE 101#8=;
         |SI FSalida = 0;
             #8#11 = "SIN DATOS ";
             |GRABA 020#8a;
         |FINSI;
         |LIBERA #8;
         |CIERRA #8;
     |SINO;
         |SI nSwEsta = 1;
             enEntrada = 0;
             |BORRA 020#0a;
         |FINSI;
     |FINSI;
     |LIBERA #0;
     |CIERRA #0;

     |HAZ GrabaRegistro0;
|FPRC;

|PROGRAMA;
     eaNoVisu = "";
     eaNomDef = "dsmoc310";

|| \\\\\\ Consulta del Modelo ////////

     |SI enTipoEntrada = 4;              || Consulta del Modelo
         |HAZ SacaPantallas;
         |ACABA;
     |FINSI;

|| \\\\\\ Baja del Modelo ////////

     |SI enTipoEntrada = 3;              ||Baja del Modelo
         |BUCLE dsmoc310B;
         |HAZ GrabaRegistro0;
         |ACABA;
     |FINSI;

|| \\\\\\ Baja del Modelo desde Modulo////////

     |SI enTipoEntrada = 97;              ||Baja del Modelo
         |BUCLE dsmoc310B;
         |HAZ GrabaRegistro0;
         |ACABA;
     |FINSI;

|| \\\\\\ Alta o Modificacion del Modelo ////////

     |SI enTipoEntrada = 1;              || Alta del Modelo
         |CABEZA "Modelo Trabajo 310";
         |HAZ AltaModelo;
     |FINSI;

|| \\\\\\ Grabacion del Modelo desde el Exterior

     |SI enTipoEntrada = 98;  |O enTipoEntrada = 91;
         |ABRE #0;
         |HAZ GrabaRegistro0;
         |CIERRA #0;
     |FINSI;

|| \\\\\\ Comprobacion Existencia del Modelo

     |SI enTipoEntrada = 99;              || Existencia del Modelo ????
         |ABRE #0;
         #0#0 = enEmpresa;
         #0#1 = enEjer;
         #0#2 = enPeriodo;
         #0#3 = enModelo;
         #0#4 = enComplem;
         #0#5 = enActividad;
         |LEE 040#0=;
         |SI FSalida ! 0;  enExistencia = 1;  |FINSI;
         |CIERRA #0;
     |FINSI;
|FPRO;
