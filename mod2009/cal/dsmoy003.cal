|FICHEROS;
     dsmoy003 #0;
     dsmom016 #16;
     dsmom017 #17;
     dsmom018 #18;
     dsmom019 #19;
     dsmoz006 #99;

     dsmom100 #100;
     :/contagen/def/caconimp #306;  || configuracion impresiones
     dsmow030 #900;          ||Def de impresion
|FIN;

|VARIABLES;
     informe    = "";
     inform1    = "dsmoz006";
     inform2    = "dsmozn06";
     nCampo     = 0;
     fFecha     = @;
     aAlfa      = "";
     aAlfa1     = "";
     aAlfa2     = "";
     aPath      = "";
     &enDatos   = 0;
     &eaInac    = "";
     &eaTituloL = "";
     &efDFecha  = @;
     &efHFecha  = @;
|FIN;

|INCLUYE i_variar;

|PROCESO DatosEmp; |TIPO 7;

   |DDEFECTO #306;

   |ABRE #100;
   |LEE 040#100p;
   |SI FSalida = 0;
       aAlfa1 = #100#1; |QBF aAlfa1; aAlfa1 = ("00000" + aAlfa1) % -105;
       aAlfa2 = #100#2; |QBF aAlfa2; aAlfa2 = ("0"     + aAlfa2) % -101;
       |DBASS aPath; |QBT aPath;
       aPathConta = aPath + "contagen/fich/" + aAlfa1 + aAlfa2 + "/";

       |PATH_DAT #306 aPathConta;

       |ABRE #306;
       #306#0 = 1;
       |LEE 000#306=;
       |CIERRA #306;
   |FINSI;
   |CIERRA #100;

   #0#27  = #306#7; |PINTA #0#27;
   aAlfa1 = #306#8; |C_M #0#27,1,aAlfa1;
|FPRC;

|PROCESO Ejercicio;  |TIPO 7;
     fFecha = ~;
     aAlfa  = fFecha % -104;
     #0#26   = aAlfa;
     |PINTA #0#26;
|FPRC;

|PROCESO DesdeHasta;
     |C_M #0#1, 1, "S";
     |PARA nCampo = 2;  |SI nCampo [ 25;  |HACIENDO nCampo = nCampo + 1;
           |C_M #0nCampo, 1, "N";
           #0nCampo = 0;  |PINTA #0nCampo;
     |SIGUE;

     |SI #0#0 = 0;
         |C_M #0#1, 1, "N";  #0#1 = 0;  |PINTA #0#1;

         |PARA nCampo = 2;  |SI nCampo [ 25;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasEmpresas;
     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 25;  |HACIENDO nCampo = nCampo + 1;
               #0nCampo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 25;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;


|PROCESO Emite;

     enEmpresa   = #17#0;
     enActividad = #17#3;
     |SI enDatos = 1;
         |DDEFECTO #900;
         |HAZ DatosEmpr_w30;
     |FINSI;

     |ABRE #16;
     |SELECT #1#16;
     #16#0  = "E";
     #16#1  = #17#5;
     #16#41 = #17#6;
     #16#2  = #17#1;
     |LEE 040#16=;
     |SI FSalida ! 0;  |DDEFECTO #16;  |FINSI;
     |CIERRA #16;

     |ABRE #18;
     #18#0 = #17#0;
     #18#1 = #17#1;
     #18#2 = #17#2;
     #18#3 = #17#3;
     |LEE 040#18=;
     |SI FSalida ! 0;
         |DDEFECTO #18;
         #18#4  = #16#5;           || Elemento  1
         #18#5  = #16#9;           || Elemento  2
         #18#6  = #16#13;          || Elemento  3
         #18#7  = #16#17;          || Elemento  4
         #18#8  = #16#21;          || Elemento  5
         #18#9  = #16#25;          || Elemento  6
         #18#10 = #16#29;          || Elemento  7
         #18#11 = #16#33;          || Elemento  8
         #18#12 = #16#37;          || Elemento  9
     |FINSI;
     |CIERRA #18;

     |ABRE #19;
     #19#0 = #17#0;
     #19#1 = #17#1;
     #19#2 = #17#2;
     #19#3 = #17#3;
     |LEE 040#19=;
     |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;
     |CIERRA #19;

     #99#0  = #17#5;
     #99#1  = #17#6;
     #99#2  = #17#1;
     #99#3  = #17#8;
     #99#4  = #17#15;
     #99#5  = #17#16;
     #99#6  = #17#17;
     #99#7  = #17#18;
     #99#8  = #17#19;
     #99#9  = #17#20;
     #99#10 = #17#21;
     #99#11 = #17#22;
     #99#12 = #17#23;
     #99#13 = #17#24;

     |PRINT;
     |PIEINF;
|FPRC;

|DEFBUCLE dsmom017;
     #17#1;
     ;
     #0#0, #0#26, 00, 01;
     #0#1, #0#26, 99, 99;
     ;
     NULL, Emite;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     enDatos = 0; |SI #0#27 = "S"; enDatos = 1; |FINSI;

     enEjer    = #0#26;
     eaInac    = "S";
     eaTituloL = #0#28;
     aAlfa1 = #0#26; aAlfa1 = "01.01." + aAlfa1; efDFecha = aAlfa1;
     aAlfa1 = #0#26; aAlfa1 = "31.12." + aAlfa1; efHFecha = aAlfa1;

     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     informe = inform1; |SI enDatos = 1; informe = inform2; |FINSI;
     |INFOR informe;
     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     |SI #0#0 ! 0;
         |BUCLE dsmom017;
     |SINO;
         |PARA nCampo = 2;  |SI nCampo [ 25;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo ! 0;
                   #0#0 = #nCampo;
                   #0#1 = #nCampo;
                   |BUCLE dsmom017;
               |FINSI;
         |SIGUE;
     |FINSI;

     |FININF;
     |FINIMP;
|FPRC;
