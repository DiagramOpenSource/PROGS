|FICHEROS;
     rem00101 #1,MANTE;
     rew00039 #939;
|FIN;

|VARIABLES;
      aAlfa         = "";
      nForma        = 0;

     &eaVarDni      = "";

 {-1} aMenuFami     = "";
      aMenuFami1    = "1262";
      aMenuFami2    = "1";
      aMenuFami3    = "2";
      aMenuFami4    = "DESCENDIENTE";
      aMenuFami5    = "ASCENDIENTE ";
|FIN;

|PROCESO LetraNifm101;  |TIPO 6;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     eaVarDni = #1Campo;
     |HAZ CalculoDNI;
     #1Campo = eaVarDni;
     |PINTA #1Campo;
     |ERROR;
|FPRC;

|PROCESO Vincula;
     |SI #1#4 = "DESCENDIENTE";  |ACABA;  |FINSI;

     |SI #1Campo = " ";
         |MENAV "     Debe ser 1 o 2 dependiendo del Titular o del Conyuge.";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO PonTipo;
     |SI #1Campo = "DESCENDIENTE";  aMenuFami2 = "1";  |FINSI;
     |SI #1Campo = "ASCENDIENTE ";  aMenuFami2 = "2";  |FINSI;

     |PUSHV 0501 2380;
     |PARA; |SI; |HACIENDO;
            |MENUG aMenuFami;
            aMenuFami2 = FSalida;

            |SI aMenuFami2 = "1";   #1Campo = aMenuFami4;  |SAL;  |FINSI;
            |SI aMenuFami2 = "2";   #1Campo = aMenuFami5;  |SAL;  |FINSI;
     |SIGUE;
     |POPV;

     |PINTA #1Campo;

     |SI #1#4 =  "DESCENDIENTE";
         |C_M #1#8,  1, "S";
         |C_M #1#12, 1, "S";
         |C_M #1#9, 1, "N";  #1#9 = "";  |PINTA #1#9;
     |SINO;
         |C_M #1#9,  1, "S";
         |C_M #1#8,  1, "N";  #1#8  = "";  |PINTA #1#8;
         |C_M #1#12, 1, "N";  #1#12 = "";  |PINTA #1#12;
     |FINSI;
|FPRC;

|PROCESO CtasCtesm101;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     #939#0 = #1Campo % 104;
     #939#1 = #1Campo % 504;
     #939#2 = #1Campo % 902;
     #939#3 = #1Campo % 1110;

     |PUSHV 0501 2380;
     |PINPA #0#939;

     |ATRI R;
     |PINTA 1116, "            CUENTA CORRIENTE                ";
     |ATRI r;

     |PINDA #0#939;
     |ENDATOS #1#939;
     |SI FSalida = 0;
         aAlfa     = #939#0 + #939#1 + #939#2 + #939#3;
         #1Campo = aAlfa;
     |FINSI;
     |POPV;
     |PINTA #1Campo;
|FPRC;

|PROCESO Mayusm101;
     #1Campo = #1Campo > #1Campo;
     |PINTA #1Campo;
|FPRC;

|PROCESO Tipo2m101;  |TIPO 2;
     nForma = 0 +. 1;
     |SI nForma ! 1;  |ACABA;  |FINSI;

     |SI #1#5 = "    ";
         |MENAV "     Datos incorrectos. Informe la Edad ";
         |ERROR;
         |ACABA;
     |FINSI;

     |SI #1#4 = "            ";
         |MENAV "     Datos incorrectos. Informe ASCENDIENTE o DESCENDIENTE";
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO Compartido;  |TIPO 7;
     |C_M #1#15, 1, "S";
     |SI #1#4 = "DESCENDIENTE";
         |C_M #1#15, 1, "N";
         #1#15 = "N";  |PINTA #1#15;
     |FINSI;
|FPRC;
