|FICHEROS;
     rezcap99 #0;
     repobibi #1;
     rem02000 #2;
     aficahor1@ #1001;
     aficahor2@ #1002;
     aficante1@ #991;
     aficante2@ #992;
     aficante3@ #993;
     aficante4@ #994;
|FIN;

|VARIABLES;
     aAlfa          = "";
     aAlfa1         = "";
     aAlfa2         = "";
     aDef           = "";
     aFichero       = "";
     aBaseRenta2000 = "";
     aFich          = "";

     nCampo         = 0;
     nCampoPase     = 0;
     nSuma          = 0;
     nSuma1         = 0;
     nAcciones      = 0;
     nAgru          = 0;
     nCasi          = 0;
     nImporte       = 0;
     nCompara       = 0;

     &enEmpresa     = 0;
     &eaPrograma    = "";
     &eaPunto       = "";
     &eaLetra       = "";
|FIN;

|PROCESO Directorios; |TIPO 7;
     |DBASS aAlfa;
     #0#0 = aAlfa + "agiren99";
     #0#1 = "fich";
     |PINTA #0#0;
     |PINTA #0#1;
|FPRC;

|PROCESO Parrilla;
     |SI #0#2 = 0;
         #0#2 = 0;  |PINTA #0#2;
         #0#3 = 0;  |PINTA #0#3;  |C_M #0#3, 1, "N";
         |PARA nCampo = 4;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |SINO;
         |C_M #0#2, 1, "S";
         |C_M #0#3, 1, "S";
         |PARA nCampo = 4;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
               #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasContri;
     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               #0Campo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO ModInmuebles;
     |C_M #0#29, 1, "S";
     |C_M #0#30, 1, "S";
     |C_M #0#32, 1, "S";
     |SI #0#25 = "N";  |O #0#32 = "N";
         |C_M #0#29, 1, "N";  #0#29 = "N";  |PINTA #0#29;
         |C_M #0#30, 1, "N";  #0#30 = "N";  |PINTA #0#30;
         |SI #0#25 = "N";
             |C_M #0#32, 1, "N";  #0#32 = "N";  |PINTA #0#32;
         |FINSI;
     |FINSI;

     |C_M #0#31, 1, "S";
     |SI #0#30 = "N";
         |C_M #0#31, 1, "N";  #0#31 = 0;    |PINTA #0#31;
     |FINSI;
|FPRC;

|PROCESO ModMobiliario;
     |C_M #0#33, 1, "S";
     |SI #0#26 = "N";
         |C_M #0#33, 1, "N";  #0#33 = "N";  |PINTA #0#33;
     |FINSI;
|FPRC;

|PROCESO ModPatrimonio;
     |C_M #0#34, 1, "S";
     |SI #0#28 = "N";
         |C_M #0#34, 1, "N";  #0#34 = "N";  |PINTA #0#34;
     |FINSI;
|FPRC;

||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| COPIA FICHEROS
||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO CopiaFichero;
     aAlfa1 = #0#0 + "/" + #0#1 + "/"  + aFichero + ".dat";  |QBT aAlfa1;
     aAlfa2 = aBaseRenta2000 + "fich/" + aFichero + ".dat";
     |COPIA_FICHERO aAlfa1, aAlfa2;

     aAlfa1 = #0#0 + "/" + #0#1 + "/"  + aFichero + ".ddx";  |QBT aAlfa1;
     aAlfa2 = aBaseRenta2000 + "fich/" + aFichero + ".ddx";
     |COPIA_FICHERO aAlfa1, aAlfa2;

     aAlfa1 = #0#0 + "/" + #0#1 + "/"  + aFichero + ".ixx";  |QBT aAlfa1;
     aAlfa2 = aBaseRenta2000 + "fich/" + aFichero + ".ixx";
     |COPIA_FICHERO aAlfa1, aAlfa2;
|FPRC;

|PROCESO Auxiliares;
     aDef = aBaseRenta2000 + "def/" + aFichero + ".mas";
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aFichero + " A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |ABRE #1001;
     |LEE 040#1001p;
     |SI FSalida ! 0;
         |CIERRA #1001;
         |HAZ CopiaFichero;
     |FINSI;
     |CIERRA #1001;
     |DESCARGA_DEF #aficahor1@;
|FPRC;

||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| TRAERSE RENTA
||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO Pasa101;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida ! 0;
         |PARA nCampoPase = 0;  |SI nCampoPase [ 15;  |HACIENDO nCampoPase = nCampoPase + 1;
               #1001nCampoPase = #992nCampoPase;
         |SIGUE;
         |GRABA 020#1001n;
     |SINO;
         |PARA nCampoPase = 0;  |SI nCampoPase [ 15;  |HACIENDO nCampoPase = nCampoPase + 1;
               #1001nCampoPase = #992nCampoPase;
         |SIGUE;
         |GRABA 020#1001a;
     |FINSI;
     |LIBERA #1001;
|FPRC;

|DEFBUCLE rem0010199;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa101;
|FIN;

|PROCESO DatosPersonales;
     aDef = #0#0 + "/def/rem00100.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00100 A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #992;
     #992#0 = #991#0;
     |LEE 040#992=;
     |SI FSalida = 0;
         aDef = aBaseRenta2000 + "/def/rem00100.mas";  |QBT aDef;
         |CARGA_DEF aDef, aficahor1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def rem00100 A쨚 2000 ";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |ABRE #1001;
         #1001#0 = #992#0;
         |LEE 101#1001=;
         |SI FSalida ! 0;
             |PARA nCampoPase = 0;  |SI nCampoPase [ 97;  |HACIENDO nCampoPase = nCampoPase + 1;
                   #1001nCampoPase = #992nCampoPase;
             |SIGUE;
             |GRABA 020#1001n;
         |SINO;
             |PARA nCampoPase = 0;  |SI nCampoPase [ 97;  |HACIENDO nCampoPase = nCampoPase + 1;
                   #1001nCampoPase = #992nCampoPase;
             |SIGUE;
             |GRABA 020#1001a;
         |FINSI;
         |LIBERA #1001;
         |CIERRA #1001;

         |DESCARGA_DEF #aficahor1@;
     |FINSI;
     |CIERRA #992;

     |DESCARGA_DEF #aficante2@;

     aDef = #0#0 + "/def/rem00101.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00101 A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2000 + "/def/rem00101.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00101 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0010199;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;

     eaPrograma = "rem00100";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO Pasa020;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida ! 0;
         #1001#0  = #992#0;
         #1001#1  = #992#1;
         #1001#2  = #992#2;
         #1001#3  = "X";
         |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
         #1001#4  = 0;
         #1001#5  = #992#5;
         #1001#8  = #992#8;
         #1001#13 = #992#13;
         #1001#17 = #992#17;
         #1001#27 = #992#27;
         #1001#29 = #992#29;
         |GRABA 020#1001n;
     |SINO;
         #1001#0  = #992#0;
         #1001#1  = #992#1;
         #1001#2  = #992#2;
         #1001#3  = "X";
         |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
         #1001#4  = 0;
         #1001#5  = #992#5;
         #1001#8  = #992#8;
         #1001#13 = #992#13;
         #1001#17 = #992#17;
         #1001#27 = #992#27;
         #1001#29 = #992#29;
         |GRABA 020#1001a;
     |FINSI;
     |LIBERA #1001;
|FPRC;

|DEFBUCLE rem0002099;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa020;
|FIN;

|PROCESO Trabajo;
     aDef = #0#0 + "/def/rem00020.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00020 A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2000 + "/def/rem00020.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00020 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0002099;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;

     eaPrograma = "rem00020";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO Pasa021;
     |SI #992#24 = "S";  |ACABA;  |FINSI;

     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1;
     |FINSI;

     |DDEFECTO #1001;
     |SI #0#32 = "N";
         #1001#0   = #992#0;
         #1001#1   = #992#1;
         #1001#2   = #992#2;
         #1001#3   = "X";
         |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
         #1001#4   = 0;
         #1001#5   = #992#5;
         #1001#6   = #992#6;
         #1001#7   = #992#7;
         #1001#8   = #992#8;
         #1001#9   = #992#9;
         #1001#10  = #992#10;
         #1001#13  = #992#13;
         #1001#14  = #992#14;
         #1001#16  = #992#16;
         #1001#17  = #992#17;
         #1001#18  = #992#18;
         #1001#19  = #992#19;
         #1001#20  = #992#20;
         #1001#25  = #992#25;
         #1001#26  = #992#26;
         #1001#29  = #992#29;
         #1001#30  = #992#30;
         #1001#31  = #992#31;
         #1001#32  = #992#32;
         #1001#33  = #992#33;
         #1001#34  = #992#34;
         #1001#35  = #992#35;
         #1001#36  = #992#36;
         #1001#104 = #992#104;
         #1001#105 = #992#105;
         #1001#106 = #992#106;
     |SINO;
         #1001#0   = #992#0;
         #1001#1   = #992#1;
         #1001#2   = #992#2;
         #1001#3   = "X";
         |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
         #1001#4   = 0;
         #1001#5   = #992#5;
         #1001#6   = #992#6;
         #1001#7   = #992#7;
         #1001#8   = #992#8;
         #1001#9   = #992#9;
         #1001#10  = #992#10;
         #1001#13  = #992#13;
         #1001#14  = #992#14;
         #1001#15  = #992#15;
         #1001#16  = #992#16;
         #1001#17  = #992#17;
         #1001#18  = #992#18;
         #1001#19  = #992#19;
         #1001#20  = #992#20;
         #1001#21  = #992#21;
         #1001#22  = #992#22;
         #1001#23  = #992#23;
         #1001#25  = #992#25;
         #1001#26  = #992#26;
         #1001#27  = #992#27;
         #1001#28  = #992#28;
         #1001#29  = #992#29;
         #1001#95  = #992#95;
         #1001#96  = #992#96;
         #1001#97  = #992#97;
         #1001#98  = #992#98;
         #1001#99  = #992#99;
         #1001#100 = #992#100;
         #1001#101 = #992#101;
         #1001#103 = #992#103;
         #1001#104 = #992#104;
         #1001#105 = #992#105;
         #1001#106 = #992#106;
         |PARA nCampoPase = 30;  |SI nCampoPase [ 61;  |HACIENDO nCampoPase = nCampoPase + 1;
               #1001nCampoPase = #992nCampoPase;
         |SIGUE;

         |SI #1001#30 ! 0;  |Y  #1001#33 ! 0;
             nSuma = #1001#30 + #1001#33;
             #1001#30 = nSuma;
             #1001#33 = 0;
         |FINSI;

         |SI #1001#31 ! 0;  |Y  #1001#34 ! 0;
             nSuma = #1001#31 + #1001#34;
             #1001#31 = nSuma;
             #1001#34 = 0;
         |FINSI;

         |SI #1001#32 ! 0;  |Y  #1001#35 ! 0;
             nSuma = #1001#32 + #1001#35;
             #1001#32 = nSuma;
             #1001#35 = 0;
         |FINSI;

         |SI #1001#30 ! 0;
             #1001#30 = (N\ #1001#30 + 1);
         |SINO;
             |SI #1001#31 ! 0;
                 #1001#31 = (N\ #1001#31 + 1);
             |SINO;
                 |SI #1001#32 ! 0;
                     #1001#32 = (N\ #1001#32 + 1);
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI #0#30 = "S";
             #1001#15 = (N\ #1001#15 + (#1001#15 % #0#31));
         |FINSI;

         |SI #0#29 = "S";
             |ABRE #1;
             #1#0 = #1001#105;
             #1#1 = #1001#106;
             |LEE 040#1=;
             |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
             |CIERRA #1;

             nSuma  = ((#1001#21 / #1#2) * #1#3);
             nSuma1 = ((#1001#21 / #1#2) * #1#3) % #0#31;

             |SI #1#3 ] #1#2;
                 #1001#21 = (N\ nSuma + nSuma1);
             |SINO;
                 #1001#21 = (N\ nSuma - nSuma1);
             |FINSI;
         |FINSI;
     |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00021";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0002199;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa021;
|FIN;

|PROCESO Inmuebles;
     aDef = #0#0 + "/def/rem00021.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00021 A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2000 + "/def/rem00021.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00021 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0002199;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa022;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#13  = #992#13;
     #1001#14  = #992#14;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;
     #1001#28  = #992#28;

     |SI #0#33 = "S";
         #1001#15  = #992#15;
     |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00022";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0002299;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa022;
|FIN;

|PROCESO Pasa043C;
     |SI #992#4 = "V";  |ACABA;  |FINSI;

     #1001#0 = #992#0;
     #1001#1 = #992#1;
     #1001#2 = #992#2;
     #1001#3 = #992#3;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = #992#3;
     #1001#4   = #992#4;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#13  = #992#13;
     |GRABA 020#1001n;
     |LIBERA #1001;
|FPRC;

|DEFBUCLE rem00043C99;
     #992#1004;
     ;
     #991#0, 01, "01.01.0000", 01;
     #991#0, 99, "31.12.2999", 99;
     ;
     NULL, Pasa043C;
|FIN;

|PROCESO RegrabaCompra;
     |SI nAcciones = 0;  |ACABA;  |FINSI;

     |SI #992#6 = #1001#6;  |Y #992#7 = #1001#7;
         |SI nAcciones = #1001#5;
             |BORRA 020#1001a;
             nAcciones = 0;
             |ACABA;
         |FINSI;
         |SI nAcciones < #1001#5;
             #1001#5 = (N\ #1001#5 - nAcciones);
             #1001#8 = (N\ #1001#5 * #1001#7);
             |GRABA 020#1001a;
             nAcciones = 0;
             |ACABA;
         |FINSI;
         |SI nAcciones > #1001#5;
             nAcciones = nAcciones - #1001#5;
             |BORRA 020#1001a;
             |ACABA;
         |FINSI;
     |FINSI;

     |LIBERA #1001;
|FPRC;

|DEFBUCLE rem0004300;
     #1001#1004;
     ;
     #992#0, #992#1, "01.01.0000", 01;
     #992#0, #992#1, "31.12.2999", 99;
     be;
     NULL, RegrabaCompra;
|FIN;

|PROCESO Pasa043V;
     |SI #992#4 = "C";  |ACABA;  |FINSI;

     nAcciones = #992#5;
     |BUCLE rem0004300;
|FPRC;

|DEFBUCLE rem00043V99;
     #992#1004;
     ;
     #991#0, 01, "01.01.0000", 01;
     #991#0, 99, "31.12.2999", 99;
     ;
     NULL, Pasa043V;
|FIN;

|PROCESO Mobiliario1;
     aDef = #0#0 + "/def/rem00022.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00022 A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2000 + "/def/rem00022.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00022 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0002299;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;

     aDef = #0#0 + "/def/rem00043.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00043 A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2000 + "/def/rem00043.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00043 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00043C99;
     |CIERRA #1001;

     |BUCLE rem00043V99;

     |DESCARGA_DEF #aficahor1@;

     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa023;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#13  = #992#13;
     #1001#14  = #992#14;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#24  = #992#24;
     #1001#33  = #992#33;

     |SI #0#33 = "S";
         #1001#15  = #992#15;
     |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00023";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0002399;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa023;
|FIN;

|PROCESO Mobiliario2;
     aDef = #0#0 + "/def/rem00023.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00023 A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2000 + "/def/rem00023.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00023 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0002399;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa050;
     #1002#0 = #993#0;
     #1002#1 = #993#1;
     #1002#2 = #993#2;
     |LEE 101#1002=;
     |SI FSalida = 0;
         |BORRA 020#1002a;
         |LIBERA #1002;
     |FINSI;

     |DDEFECTO #1002;
     #1002#0   = #993#0;
     #1002#1   = #993#1;
     #1002#2   = #993#2;
     #1002#3   = #993#3;
     #1002#4   = #993#4;
     #1002#5   = #993#5;
     #1002#6   = #993#6;
     #1002#7   = #993#7;
     #1002#8   = #993#8;
     #1002#9   = #993#9;

     |GRABA 020#1002n;
     |LIBERA #1002;
|FPRC;

|DEFBUCLE rem0005099;
     #993#1003;
     ;
     #992#0, #992#1, 1900;
     #992#0, #992#1, 2999;
     ;
     NULL, Pasa050;
|FIN;

|PROCESO Pasa024;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#13  = #992#13;
     #1001#14  = #992#14;
     #1001#15  = #992#15;
     |SI #1001#12 ! 0;
         #1001#12 = (N\ #1001#12 + 1);
     |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00024";
     eaPunto    = "";
     |HAZ ProgramaActivo;

     |SI #1001#12 ] 1;  |Y #1001#12 [ 12;
         |BUCLE rem0005099;
     |FINSI;
|FPRC;

|DEFBUCLE rem0002499;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa024;
|FIN;

|PROCESO Mobiliario3;
     aDef = #0#0 + "/def/rem00024.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00024 A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem00050.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00050 A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2000 + "/def/rem00024.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00024 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2000 + "/def/rem00050.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00050 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;
     |PATH_DAT #993 aFich;

     |ABRE #1001;
     |ABRE #1002;
     |BUCLE rem0002499;
     |CIERRA #1001;
     |CIERRA #1002;

     |DESCARGA_DEF #aficahor2@;
     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante3@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa051;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#13  = #992#13;
     #1001#14  = #992#14;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#20  = #992#20;
     |SI #1001#20 > 0;  #1001#20 = (N\ #1001#20 + 1);  |FINSI;

     |SI #0#33 = "S";
         #1001#15  = #992#15;
     |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00051";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0005199;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa051;
|FIN;

|PROCESO Mobiliario4;
     aDef = #0#0 + "/def/rem00051.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00051 A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2000 + "/def/rem00051.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00051 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0005199;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa025;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#14  = #992#14;
     #1001#15  = #992#15;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#20  = #992#20;
     #1001#21  = #992#21;
     #1001#22  = #992#22;
     #1001#23  = #992#23;
     #1001#24  = #992#24;
     #1001#25  = #992#25;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00025";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0002599;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa025;
|FIN;

|PROCESO Actividad1;
     aDef = #0#0 + "/def/rem00025.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00025 A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2000 + "/def/rem00025.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00025 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0002599;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa026;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#14  = #992#14;
     #1001#15  = #992#15;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#20  = #992#20;
     #1001#21  = #992#21;
     #1001#22  = #992#22;
     #1001#23  = #992#23;
     #1001#24  = #992#24;
     #1001#25  = #992#25;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00026";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0002699;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa026;
|FIN;

|PROCESO Actividad2;
     aDef = #0#0 + "/def/rem00026.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00026 A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2000 + "/def/rem00026.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00026 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0002699;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa027;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#14  = #992#14;
     #1001#15  = #992#15;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#20  = #992#20;
     #1001#21  = #992#21;
     #1001#22  = #992#22;
     #1001#23  = #992#23;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00027";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0002799;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa027;
|FIN;

|PROCESO Actividad3;
     aDef = #0#0 + "/def/rem00027.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00027 A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2000 + "/def/rem00027.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00027 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0002799;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa028;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#14  = #992#14;
     #1001#15  = #992#15;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#20  = #992#20;
     #1001#21  = #992#21;
     #1001#22  = #992#22;
     #1001#23  = #992#23;
     #1001#24  = #992#24;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00028";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0002899;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa028;
|FIN;

|PROCESO Actividad4;
     aDef = #0#0 + "/def/rem00028.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00028 A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2000 + "/def/rem00028.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00028 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0002899;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa053;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#13  = #992#13;
     #1001#17  = #992#17;
     #1001#21  = #992#21;
     #1001#22  = #992#22;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00053";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0005399;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa053;
|FIN;

|PROCESO Pensiones;
     aDef = #0#0 + "/def/rem00053.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00053 A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2000 + "/def/rem00053.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00053 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0005399;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa054;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#14  = #992#14;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00054";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0005499;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa054;
|FIN;

|PROCESO Anualidades;
     aDef = #0#0 + "/def/rem00054.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00054 A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2000 + "/def/rem00054.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00054 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0005499;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa032;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#13  = #992#13;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00032";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0003299;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa032;
|FIN;

|PROCESO TFiscal;
     aDef = #0#0 + "/def/rem00032.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00032 A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2000 + "/def/rem00032.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00032 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0003299;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa046;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#14  = #992#14;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00046";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0004699;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa046;
|FIN;

|PROCESO Donativos;
     aDef = #0#0 + "/def/rem00046.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00046 A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2000 + "/def/rem00046.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00046 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0004699;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO GrabaDedu;
     |SI nImporte = 0;  |ACABA;  |FINSI;

     #2#7 = #994#11;
     #2#8 = #994#13;
     |LEE 040#2=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #992#2 = "TITULAR   ";
         |SI #994#2 = "CONYUGE   ";  |ACABA;  |FINSI;
         |SI #994#2 = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "4 FAMILIAR";  |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "CONYUGE   ";
         |SI #994#2 = "TITULAR   ";  |ACABA;  |FINSI;
         |SI #994#2 = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "4 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "GANANCIAL ";  |ACABA;  |FINSI;
         |SI #994#2 = "VARIOS    ";  |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "1 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "2 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "3 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "4 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #994#17 = 0;
         nCompara = #994#18;
     |SINO;
         nCompara = #994#19;
     |FINSI;

     |SI nImporte = nCompara;
         #1001#0 = #994#0;
         #1001#1 = #994#1;
         |LEE 101#1001=;
         |SI FSalida = 0;
             |BORRA 020#1001a;
             |LIBERA #1001;
         |FINSI;

         |PARA nCampoPase = 0;  |SI nCampoPase [ 21;  |HACIENDO nCampoPase = nCampoPase + 1;
               #1001nCampoPase = #994nCampoPase;
         |SIGUE;
         #1001#3  = "X";
         |SI #0#37 = "N";  #1001#3 = #994#3;  |FINSI;
         #1001#11 = #2#0;
         #1001#12 = #2#2;
         #1001#13 = #2#1;
         #1001#14 = #2#3;
         #1001#15 = #2#4;
         #1001#16 = #2#5;
         #1001#17 = #2#6;
         |GRABA 020#1001n;
         |LIBERA #1001;

         eaPrograma = "rem00045";
         eaPunto    = "";
         |HAZ ProgramaActivo;

         nImporte = 0;

         |ACABA;
     |FINSI;

     |SI nImporte < nCompara;
         #1001#0 = #994#0;
         #1001#1 = #994#1;
         |LEE 101#1001=;
         |SI FSalida = 0;
             |BORRA 020#1001a;
             |LIBERA #1001;
         |FINSI;

         |PARA nCampoPase = 0;  |SI nCampoPase [ 21;  |HACIENDO nCampoPase = nCampoPase + 1;
               #1001nCampoPase = #994nCampoPase;
         |SIGUE;
         #1001#3  = "X";
         |SI #0#37 = "N";  #1001#3 = #994#3;  |FINSI;
         #1001#11 = #2#0;
         #1001#12 = #2#2;
         #1001#13 = #2#1;
         #1001#14 = #2#3;
         #1001#15 = #2#4;
         #1001#16 = #2#5;
         #1001#17 = #2#6;

         |SI #1001#17 ! 0;
             #1001#18 = (N\ ((nImporte * 100) / #1001#17));
             #1001#19 = nImporte;
         |SINO;
             #1001#18 = nImporte;
             #1001#19 = nImporte;
         |FINSI;
         |GRABA 020#1001n;

         eaPrograma = "rem00045";
         eaPunto    = "";
         |HAZ ProgramaActivo;

         nImporte = 0;

         |ACABA;
     |FINSI;

     |SI nImporte > nCompara;
         #1001#0 = #994#0;
         #1001#1 = #994#1;
         |LEE 101#1001=;
         |SI FSalida = 0;
             |BORRA 020#1001a;
             |LIBERA #1001;
         |FINSI;

         |PARA nCampoPase = 0;  |SI nCampoPase [ 21;  |HACIENDO nCampoPase = nCampoPase + 1;
               #1001nCampoPase = #994nCampoPase;
         |SIGUE;
         #1001#3  = "X";
         |SI #0#37 = "N";  #1001#3 = #994#3;  |FINSI;
         #1001#11 = #2#0;
         #1001#12 = #2#2;
         #1001#13 = #2#1;
         #1001#14 = #2#3;
         #1001#15 = #2#4;
         #1001#16 = #2#5;
         #1001#17 = #2#6;
         |GRABA 020#1001n;

         eaPrograma = "rem00045";
         eaPunto    = "";
         |HAZ ProgramaActivo;

         nImporte = nImporte - nCompara;
         |ACABA;
     |FINSI;
|FPRC;

|DEFBUCLE rem0004599;
     #994#1002;
     11, 13;
     #993#0, 01, nAgru, nCasi;
     #993#0, 99, nAgru, nCasi;
     ;
     NULL, GrabaDedu;
|FIN;

|PROCESO PonDedu;
     |ABRE #2;
     |SELECT #3#2;
     |BUCLE rem0004599;
     |CIERRA #2;
|FPRC;

|PROCESO MiraLiquidacion;
     #993#0 = #992#0;
     #993#1 = #992#1;
     #993#2 = #992#2;
     |LEE 040#993=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #993#7   ! 0;  nImporte = #993#7;   nAgru = 1;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI #993#10  ! 0;  nImporte = #993#10;  nAgru = 1;  nCasi = 3;  |HAZ PonDedu;  |FINSI;

     |SI #993#13  ! 0;  nImporte = #993#13;  nAgru = 2;  nCasi = 1;  |HAZ PonDedu;  |FINSI;
     |SI #993#16  ! 0;  nImporte = #993#16;  nAgru = 2;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 2;  nCasi = 3;  |HAZ PonDedu;  |FINSI;

     |SI #993#19  ! 0;  nImporte = #993#19;  nAgru = 3;  nCasi = 1;  |HAZ PonDedu;  |FINSI;
     |SI #993#22  ! 0;  nImporte = #993#22;  nAgru = 3;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI #993#25  ! 0;  nImporte = #993#25;  nAgru = 3;  nCasi = 3;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 3;  nCasi = 4;  |HAZ PonDedu;  |FINSI;
     |SI #993#28  ! 0;  nImporte = #993#28;  nAgru = 3;  nCasi = 9;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 3;  nCasi = 10; |HAZ PonDedu;  |FINSI;
     |SI #993#31  ! 0;  nImporte = #993#31;  nAgru = 3;  nCasi = 5;  |HAZ PonDedu;  |FINSI;
     |SI #993#34  ! 0;  nImporte = #993#34;  nAgru = 3;  nCasi = 6;  |HAZ PonDedu;  |FINSI;
     |SI #993#37  ! 0;  nImporte = #993#37;  nAgru = 3;  nCasi = 7;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 3;  nCasi = 8;  |HAZ PonDedu;  |FINSI;
     |SI #993#40  ! 0;  nImporte = #993#40;  nAgru = 3;  nCasi = 11; |HAZ PonDedu;  |FINSI;
     |SI #993#43  ! 0;  nImporte = #993#43;  nAgru = 3;  nCasi = 12; |HAZ PonDedu;  |FINSI;
     |SI #993#46  ! 0;  nImporte = #993#46;  nAgru = 3;  nCasi = 13; |HAZ PonDedu;  |FINSI;

     |SI #993#54  ! 0;  nImporte = #993#54;  nAgru = 4;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI #993#57  ! 0;  nImporte = #993#57;  nAgru = 4;  nCasi = 3;  |HAZ PonDedu;  |FINSI;
     |SI #993#60  ! 0;  nImporte = #993#60;  nAgru = 4;  nCasi = 4;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 4;  nCasi = 5;  |HAZ PonDedu;  |FINSI;

     |SI #993#63  ! 0;  nImporte = #993#63;  nAgru = 5;  nCasi = 1;  |HAZ PonDedu;  |FINSI;
     |SI #993#66  ! 0;  nImporte = #993#66;  nAgru = 5;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 5;  nCasi = 3;  |HAZ PonDedu;  |FINSI;

     |SI #993#69  ! 0;  nImporte = #993#66;  nAgru = 6;  nCasi = 1;  |HAZ PonDedu;  |FINSI;
     |SI #993#72  ! 0;  nImporte = #993#72;  nAgru = 6;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI #993#75  ! 0;  nImporte = #993#75;  nAgru = 6;  nCasi = 3;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 6;  nCasi = 4;  |HAZ PonDedu;  |FINSI;
     |SI #993#78  ! 0;  nImporte = #993#78;  nAgru = 6;  nCasi = 5;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 6;  nCasi = 6;  |HAZ PonDedu;  |FINSI;
     |SI #993#81  ! 0;  nImporte = #993#81;  nAgru = 6;  nCasi = 7;  |HAZ PonDedu;  |FINSI;
     |SI #993#84  ! 0;  nImporte = #993#84;  nAgru = 6;  nCasi = 8;  |HAZ PonDedu;  |FINSI;
     |SI #993#87  ! 0;  nImporte = #993#87;  nAgru = 6;  nCasi = 9;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 6;  nCasi = 10; |HAZ PonDedu;  |FINSI;

     |SI #993#90  ! 0;  nImporte = #993#90;  nAgru = 7;  nCasi = 1;  |HAZ PonDedu;  |FINSI;

     |SI #993#98  ! 0;  nImporte = #993#98;  nAgru = 9;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI #993#101 ! 0;  nImporte = #993#101; nAgru = 9;  nCasi = 3;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 9;  nCasi = 4;  |HAZ PonDedu;  |FINSI;

     |SI #993#106 ! 0;  nImporte = #993#106; nAgru = 10; nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI #993#109 ! 0;  nImporte = #993#109; nAgru = 10; nCasi = 3;  |HAZ PonDedu;  |FINSI;
     |SI #993#112 ! 0;  nImporte = #993#112; nAgru = 10; nCasi = 4;  |HAZ PonDedu;  |FINSI;
     |SI #993#115 ! 0;  nImporte = #993#115; nAgru = 10; nCasi = 5;  |HAZ PonDedu;  |FINSI;

     |SI #993#123 ! 0;  nImporte = #993#123; nAgru = 11; nCasi = 2;  |HAZ PonDedu;  |FINSI;

     |SI #993#133 ! 0;  nImporte = #993#123; nAgru = 8;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 8;  nCasi = 3;  |HAZ PonDedu;  |FINSI;
|FPRC;

|DEFBUCLE rem0100199;
     #992#1003;
     5;
     #991#0, 00, "          ", "100";
     #991#0, 99, "zzzzzzzzzz", "101";
     ;
     NULL, MiraLiquidacion;
|FIN;

|PROCESO Deducciones;
     aDef = #0#0 + "/def/rem01001.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01001 A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem01042.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01042 A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem00045.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00045 A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2000 + "/def/rem00045.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00045 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;
     |PATH_DAT #993 aFich;
     |PATH_DAT #994 aFich;

     |ABRE #993;
     |ABRE #1001;
     |BUCLE rem0100199;
     |CIERRA #993;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante4@;
     |DESCARGA_DEF #aficante3@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa090;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     #1001#2 = #992#2;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;

     |PARA nCampoPase = 0;  |SI nCampoPase [ 21;  |HACIENDO nCampoPase = nCampoPase + 1;
           #1001nCampoPase = #992nCampoPase;
     |SIGUE;

     |SI #0#34 = "N";
         #1001#10 = 0;
         #1001#14 = 0;
     |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00099";
     eaLetra    = #1001#1;
     eaPunto    = #1001#1;
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0009999;
     #992#1003;
     4, 5;
     #991#0, "  ", 001, "  ", 00;
     #991#0, "zz", 999, "  ", 00;
     ;
     NULL, Pasa090;
|FIN;

|PROCESO Patrimonio;
     aDef = #0#0 + "/def/rem00099.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00099 A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2000 + "/def/rem00099.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00099 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0009999;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa2000;
     enEmpresa = #991#0;

     aDef = aBaseRenta2000 + "/def/reacceso.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def reacceso  A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aAlfa1 = #991#1;  |QBF aAlfa1;
     aAlfa  = "     Recogiendo Contribuyente [" + (("00000" + #991#0) % -105) + " " + aAlfa1 + "]";

     |ABRE #1001;
     #1001#0 = #991#0;
     |LEE 101#1001=;
     |SI FSalida = 0;
         aAlfa  = "0000NYa existe Contribuyente [" + (("00000" + #991#0) % -105) + " " + aAlfa1 + "] Desea pasar los datos de nuevo : ";
         |CONFI aAlfa;
         |SI FSalida ! 0;
             |CIERRA #1001;
             |DESCARGA_DEF #aficahor1@;
             |ACABA;
         |FINSI;

         #1001#0 = #991#0;
         #1001#1 = #991#1;
         #1001#2 = #991#2;
         |GRABA 020#1001a;
     |SINO;
         #1001#0 = #991#0;
         #1001#1 = #991#1;
         #1001#2 = #991#2;
         |GRABA 020#1001n;
     |FINSI;
     |LIBERA #1001;
     |CIERRA #1001;
     |DESCARGA_DEF #aficahor1@;

     aAlfa1 = #991#1;  |QBF aAlfa1;
     aAlfa  = "     Recogiendo Contribuyente [" + (("00000" + #991#0) % -105) + " " + aAlfa1 + "]";
     |MENSA aAlfa;

     |SI #0#38 = "S";  |HAZ DatosPersonales;  |FINSI;
     |SI #0#24 = "S";  |HAZ Trabajo;          |FINSI;
     |SI #0#25 = "S";  |HAZ Inmuebles;        |FINSI;
     |SI #0#26 = "S";  |HAZ Mobiliario1;      |FINSI;
     |SI #0#26 = "S";  |HAZ Mobiliario2;      |FINSI;
     |SI #0#26 = "S";  |HAZ Mobiliario3;      |FINSI;
     |SI #0#26 = "S";  |HAZ Mobiliario4;      |FINSI;
     |SI #0#35 = "S";  |HAZ Actividad1;       |FINSI;
     |SI #0#35 = "S";  |HAZ Actividad2;       |FINSI;
     |SI #0#35 = "S";  |HAZ Actividad3;       |FINSI;
     |SI #0#35 = "S";  |HAZ Actividad4;       |FINSI;
     |SI #0#36 = "S";  |HAZ Pensiones;        |FINSI;
     |SI #0#36 = "S";  |HAZ Anualidades;      |FINSI;
     |SI #0#36 = "S";  |HAZ TFiscal;          |FINSI;
     |SI #0#36 = "S";  |HAZ Donativos;        |FINSI;
     |SI #0#27 = "S";  |HAZ Deducciones;      |FINSI;
     |SI #0#28 = "S";  |HAZ Patrimonio;       |FINSI;
|FPRC;

|DEFBUCLE reacceso99;
     #991#1001;
     ;
     #0#2;
     #0#3;
     ;
     NULL, Pasa2000;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |DBASE aBaseRenta2000;  |QBT aBaseRenta2000;

     aFichero = "repoblac";  |HAZ Auxiliares;
     aFichero = "reauxpai";  |HAZ Auxiliares;
     aFichero = "rerenpre";  |HAZ Auxiliares;
     aFichero = "reauxdiv";  |HAZ Auxiliares;
     aFichero = "reauxval";  |HAZ Auxiliares;
     aFichero = "rebancos";  |HAZ Auxiliares;

     aDef = #0#0 + "/def/reacceso.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def reacceso A쨚 1999 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aFich = #0#0 + "/" + #0#1 + "/";  |QBT aFich;
     |PATH_DAT #991 aFich;

     |SI #0#2 ! 0;
         |BUCLE reacceso99;
     |SINO;
         |PARA nCampo = 4;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo ! 0;
                   #0#2 = #0nCampo;
                   #0#3 = #0nCampo;
                   |BUCLE reacceso99;
               |FINSI;
         |SIGUE;
     |FINSI;

     |DESCARGA_DEF #aficante1@;
|FPRC;
