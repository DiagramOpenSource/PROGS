|FICHEROS;
     reemi714 #0;        || def de emision
     rem00100 #1;        || datos contribuyentes
     rehacien #2;        || datos hacienda
     rerenpre #3;        || representantes
     repoblac #4;        || poblaciones
     recofisc #5;        || porcentajes c.fiscal

     repant50 #6;        || mensajes pantalla
     rew00001 #9;        || tmp. seleccion

     rew00027 #27;       || hoja 01
     rew00028 #28;       || hoja 02-08
     rew00029 #29;       || hoja 09
     rew00030 #30;       || hoja 10
     rew00031 #31;       || hoja ing./dev.

     rem00099 #50;       || afectos patrimonio
     rew00103 #70;       || ayuda liquidacion (igual que el retotpat_98)
     rem01001 #71;       || liquidacion cabs.
     rem01002 #72;       || liquidacion lins.
|FIN;

|VARIABLES;
    &alfa1     = "";
    &alfa2     = "";
    &alfa3     = "";
    &alfa4     = "";
    &nume1     = 0;
    &nume2     = 0;
    &nume3     = 0;
    &nume4     = 0;
    &para1     = 0;
    &para2     = 0;
    &para3     = 0;
    &para4     = 0;
    &fech1     = @;
    &informe   = "";
    &x         = 0;
    &n         = "N";
    &xxx       = 0;
    &d_empre   = 0;
    &h_empre   = 0;
    &var       = 0;
    &coefi     = 0;
    &papel     = 0;
    &Salteada  = 0;
    &eaTipoSec     = "";
    &enEmpresa     = 0;
    &enTipoEntrada = 0;

{200}&NEmpresas  = "";
    &NCopia = 0;

{-1}hojas    = "":
    hojas1   = "2400";
    hojas2   = "1";
    hojas3   = "Elija tipo de papel : ";
    hojas4   = "CHS";
    hojas5   = "  Continuo  ";
    hojas6   = "  Hoja a hoja  ";
    hojas7   = "  Salir  ";

    &EmpA1 = 10;
    &EmpB1 = 41;

    &EmpC1 = 11;
    &EmpC2 = 31;     || linea segun 1/6 de pulgada donde empieza cada apartado
    &EmpD1 = 49;     || (menos 1)

    &EmpE1 = 10;
    &EmpF1 = 38;
    &EmpF2 = 58;

    &EmpG1 = 11;
    &EmpG2 = 29;
    &EmpG3 = 59;

    &EmpG4 = 12;
    &EmpH1 = 36;
    &EmpH2 = 43;
    &EmpI1 = 51;
    &EmpJ1 = 61;

    &EmpK1 = 10;
    &EmpL1 = 28;
    &EmpM1 = 45;
    &EmpN1 = 63;

    &EmpO1 = 09;
    &EmpP1 = 17;
    &EmpQ1 = 24;
    &EmpU1 = 49;

    &Encab = 4;

    &TotA1 = 35;
    &TotB1 = 65;

    &TotC1 = 28;     || linea segun 1/6 de pulgada donde va el total
    &TotC2 = 42;     || (menos 1)
    &TotC0 = 44;
    &TotD1 = 65;

    &TotE1 = 32;
    &TotF1 = 54;
    &TotF2 = 66;

    &TotG1 = 25;
    &TotG2 = 55;
    &TotG3 = 67;

    &TotG4 = 30;
    &TotH1 = 39;
    &TotH2 = 46;
    &TotI1 = 56;
    &TotJ1 = 66;

    &TotK1 = 23;
    &TotL1 = 40;
    &TotM1 = 58;
    &TotN1 = 66;

    &TotO1 = 13;
    &TotP1 = 20;
    &TotQ1 = 40;
    &TotZ1 = 44;
    &TotU1 = 66;

    &TopeA1 = 21;
    &TopeB1 = 20;
    &TopeC1 = 13;
    &TopeC2 = 12;
    &TopeD1 = 13;
    &TopeE1 = 15;
    &TopeF1 = 15;
    &TopeF2 = 14;
    &TopeG1 = 12;
    &TopeG2 = 18;
    &TopeG3 = 13;
    &TopeG4 = 10;
    &TopeH1 = 5;
    &TopeH2 = 5;
    &TopeI1 = 5;
    &TopeJ1 = 5;
    &TopeK1 = 13;
    &TopeL1 = 9;
    &TopeM1 = 8;
    &TopeN1 = 6;
    &TopeO1 = 5;
    &TopeP1 = 5;
    &TopeQ1 = 12;
    &TopeU1 = 13;

    &nombre = "";
    &dnicif = "";
    &cuenta = "";
    &apell1 = "";
    &apell2 = "";
    &nompil = "";
    &cpadm = "";
    &cprep = "";
    &regim = "";
    &habit = "";
    &opta = "";
    &Cadena1 = "";
    &Cadena2 = "";
    &Cadena3 = "";
    &SwTmp = 0;
    &SwRepite = 0;
    &Daparta = "";
    &Haparta = "";
    &Detalle = 0;
    &Total = 0;
    &PTotal = "";
    &LTotal = "";
    &FechaInf = "";
    &Any = 0;
    &Mes = "";
    &Dia = 0;
    &Papel = 0;
    &Baja = 0;
    &TMaxi = 0;
    &Pinfor2 = "";
    &RelAdjunta = "SEGUN RELACION ADJUNTA";

    &FichLaser = "";
    &Fabre = "";
    &Fcanl = "";
    &Field = "";
    &Tope = 0;
    &Lineas = 0;
    &Longi = 0;
    &LFecha = "";
    &LFecDi = "";
    &LFecMe = "";
    &LFecAn = "";

    Comodin1 = "";
    Calc = 0;
    nParte1 = 0;
    nParte2 = 0;
    aParte1 = "";
    aParte2 = "";
    Caracter = "";
    aAlfa    = "";
    Sigue    = 0;

    &nSwTodos = 0;
    &Comodin = "";
    &Directorio = "";
    &aCodigo = "";
    &aAlfa1 = "";
    &aAlfa2 = "";
    &aAlfa3 = "";
    &aAlfa4 = "";
    &nNume1 = 0;
    &nNume2 = 0;
    &nNume3 = 0;
    &nNume4 = 0;

    nAdjunA1 = 0;
    nAdjunB1 = 0;
    nAdjunC1 = 0;
    nAdjunC2 = 0;
    nAdjunD1 = 0;
    nAdjunE1 = 0;
    nAdjunF1 = 0;
    nAdjunF2 = 0;
    nAdjunG1 = 0;
    nAdjunG2 = 0;
    nAdjunG3 = 0;
    nAdjunG4 = 0;
    nAdjunH1 = 0;
    nAdjunH2 = 0;
    nAdjunI1 = 0;
    nAdjunJ1 = 0;
    nAdjunK1 = 0;
    nAdjunL1 = 0;
    nAdjunM1 = 0;
    nAdjunN1 = 0;
    nAdjunO1 = 0;
    nAdjunP1 = 0;
    nAdjunQ1 = 0;
    nAdjunU1 = 0;

    aFichero  = "";
    nCanal    = 0;

    &eaTipoEmi = "L";
|FIN;

|INCLUYE i_ficher;
|INCLUYE i_utilid;

____________________________________/ CALCULOS DE PANTALLA
|PROCESO seleccion; |TIPO 0;
|SI #0#0 = "S";
    |CAMPO_MODIFICA #0#01, 1, "S";
    |CAMPO_MODIFICA #0#02, 1, "S";

    |PARA xxx = 3; |SI xxx [ 32; |HACIENDO xxx = xxx + 1;
            #0xxx = 0; |PINTA #0xxx;
        |CAMPO_MODIFICA #0xxx, 1, "N";
    |SIGUE;
|SINO;
        #0#1 = 00001;    |PINTA #0#1;   |CAMPO_MODIFICA #0#01, 1, "N";
        #0#2 = 99999;    |PINTA #0#2;   |CAMPO_MODIFICA #0#02, 1, "N";

    |PARA xxx = 3; |SI xxx [ 32; |HACIENDO xxx = xxx + 1;
        |CAMPO_MODIFICA #0xxx, 1, "S";
    |SIGUE;
|FINSI;
|FPRC;

|PROCESO tipo_imp; |TIPO 0;
|SI #0#49 = "O";    alfa1 = "S";   |FINSI;
|SI #0#49 = "L";    alfa1 = "N";   |FINSI;

|C_M #0#33, 1, alfa1;    || fecha de presentacion
|C_M #0#34, 1, alfa1;    || primera hoja en blanco
|C_M #0#37, 1, alfa1;    || nro. de copias
|C_M #0#38, 1, alfa1;    || hoja 1
|C_M #0#39, 1, alfa1;    || hoja 2
|C_M #0#40, 1, alfa1;    || hoja 3
|C_M #0#41, 1, alfa1;    || hoja 4
|C_M #0#42, 1, alfa1;    || hoja 5
|C_M #0#43, 1, alfa1;    || hoja 6
|C_M #0#44, 1, alfa1;    || hoja 7
|C_M #0#45, 1, alfa1;    || hoja 8
|C_M #0#46, 1, alfa1;    || hoja 9
|C_M #0#47, 1, alfa1;    || hoja 10
|C_M #0#48, 1, alfa1;    || hoja Ing./Dev.
|FPRC;

|PROCESO mayus; |TIPO 0;
    #0Campo = #0Campo > #0Campo;
|PINTA #0Campo;
|FPRC;

____________________________________/ IMPRESION EN LASER
|PROCESO Filtro;
   Sigue = 1;
   |PARA; |SI Sigue ! 0; |HACIENDO;
      Sigue = 0;
      Comodin1 = Comodin1 - "¤";
      |SI FSalida ! 0;
         Calc = FSalida;
         nParte1 = 100 + (((Calc / 100) ! 0) - 1);
         aParte1 = Comodin1 % nParte1;
         nParte2 = Calc + 98;
         aParte2 = Comodin1 % nParte2;
         Comodin1 = aParte1 + &209 + aParte2;
         Sigue = 1;
      |FINSI;
      Comodin1 = Comodin1 - "¥";
      |SI FSalida ! 0;
         Calc = FSalida;
         nParte1 = 100 + (((Calc / 100) ! 0) - 1);
         aParte1 = Comodin1 % nParte1;
         nParte2 = Calc + 98;
         aParte2 = Comodin1 % nParte2;
         Comodin1 = aParte1 + &209 + aParte2;
         Sigue = 1;
      |FINSI;
      Caracter = &128;
      Comodin1 = Comodin1 - Caracter;
      |SI FSalida ! 0;
         Calc = FSalida;
         nParte1 = 100 + (((Calc / 100) ! 0) - 1);
         aParte1 = Comodin1 % nParte1;
         nParte2 = Calc + 98;
         aParte2 = Comodin1 % nParte2;
         Comodin1 = aParte1 + &199 + aParte2;
         Sigue = 1;
      |FINSI;
      Caracter = &134;
      Comodin1 = Comodin1 - Caracter;
      |SI FSalida ! 0;
         Calc = FSalida;
         nParte1 = 100 + (((Calc / 100) ! 0) - 1);
         aParte1 = Comodin1 % nParte1;
         nParte2 = Calc + 98;
         aParte2 = Comodin1 % nParte2;
         Comodin1 = aParte1 + &199 + aParte2;
         Sigue = 1;
      |FINSI;
   |SIGUE;
|FPRC;

|PROCESO ElFgraba;
    nume1 = Longi + 100;
    Field = (Field + (" " * Longi)) % nume1;      || ajusta
    Field = Fcanl + " " + Field;

    Comodin1 = Field;    |HAZ Filtro;   Field = Comodin1;

    Field = Field > Field;    || todo en mayusculas

|FGRABA Field;
|FPRC;

|PROCESO Laser_31;
    Field = "71411 ";    Longi = 6;     |HAZ ElFgraba;
    Field = #31#7;       Longi = 2;     |HAZ ElFgraba; || los campos
    Field = #31#8;       Longi = 27;    |HAZ ElFgraba; ||/no se corresponden
    Field = #31#9;       Longi = 4;     |HAZ ElFgraba; ||/con los de H.P.
    Field = #31#10;      Longi = 2;     |HAZ ElFgraba;
    Field = #31#11;      Longi = 2;     |HAZ ElFgraba;
    Field = #31#12;      Longi = 2;     |HAZ ElFgraba;
    Field = #31#13;      Longi = 9;     |HAZ ElFgraba;
    Field = #31#14;      Longi = 33;    |HAZ ElFgraba;
    Field = #31#15;      Longi = 19;    |HAZ ElFgraba;
    Field = ("00000" + #31#16) % -105;  Longi = 5;     |HAZ ElFgraba;
    Field = #31#17;      Longi = 1;     |HAZ ElFgraba;
    Longi = 12;
|PARA para1 = 18; |SI para1 [ 21; |HACIENDO para1 = para1 + 1;
        CantiNum = #31para1;  |HAZ CambiCantiD12;
        Field = CantiAlfa;
    |HAZ ElFgraba;
|SIGUE;
    Field = #31#22;      Longi = 1;     |HAZ ElFgraba;
    Field = #31#23;      Longi = 1;     |HAZ ElFgraba;
    Field = #31#24;      Longi = 1;     |HAZ ElFgraba;
    CantiNum = #31#25;   |HAZ CambiCantiD12;
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;
    Field = #31#26;      Longi = 4;     |HAZ ElFgraba;
    Field = #31#27;      Longi = 4;     |HAZ ElFgraba;
    Field = #31#28;      Longi = 2;     |HAZ ElFgraba;
    Field = #31#29;      Longi = 10;    |HAZ ElFgraba;
    Field = #31#30;      Longi = 2;     |HAZ ElFgraba;
|FPRC;

|PROCESO Laser_30;
    Field = "71410 ";    Longi = 6;     |HAZ ElFgraba;
    Longi = 12;
|PARA para1 = 4; |SI para1 [ 7; |HACIENDO para1 = para1 + 1;
        CantiNum = #30para1;  |HAZ CambiCantiD12;
        Field = CantiAlfa;
    |HAZ ElFgraba;
|SIGUE;
    Field = ("00" + #30#8) % -102;      Longi = 2;     |HAZ ElFgraba;
    Field = ("00" + #30#9) % -102;      Longi = 2;     |HAZ ElFgraba;
    Longi = 12;
|PARA para1 = 10; |SI para1 [ 19; |HACIENDO para1 = para1 + 1;
        CantiNum = #30para1;  |HAZ CambiCantiD12;
        Field = CantiAlfa;
    |HAZ ElFgraba;
|SIGUE;
    Field = ("00" + #30#20) % -102;     Longi = 2;     |HAZ ElFgraba;
    Field = ("00" + #30#21) % -102;     Longi = 2;     |HAZ ElFgraba;
    Longi = 12;
|PARA para1 = 22; |SI para1 [ 28; |HACIENDO para1 = para1 + 1;
        CantiNum = #30para1;  |HAZ CambiCantiD12;
        Field = CantiAlfa;
    |HAZ ElFgraba;
|SIGUE;
    Field = #30#29;      Longi = 2;     |HAZ ElFgraba;
|FPRC;

|PROCESO Laser_29;
    Field = "71409 ";    Longi = 6;     |HAZ ElFgraba;
    Longi = 12;
|PARA para1 = 4; |SI para1 [ 30; |HACIENDO para1 = para1 + 1;
        CantiNum = #29para1;  |HAZ CambiCantiD12;
        Field = CantiAlfa;
    |HAZ ElFgraba;
|SIGUE;
    Field = #29#31;      Longi = 2;     |HAZ ElFgraba;
|FPRC;

|PROCESO TotalU1;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 62;
        Field = Field + "000000000000";
        Longi = 74;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#19;   |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalQ1;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 62;
        Field = Field + "000000000000";
        Longi = 74;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#17;   |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalP1;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 62;
        Field = Field + "000000000000";
        Longi = 74;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#16;   |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalO1;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 62;
        Field = Field + "000000000000";
        Longi = 74;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#15;   |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalN1;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 62;
        Field = Field + "000000000000";
        Longi = 74;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#14;   |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalM1;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 42;
        Field = Field + "000000000000000000000000";
        Longi = 66;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#13;   |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalL1;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 62;
        Field = Field + "000000000000";
        Longi = 74;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#12;   |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalK1;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 62;
        Field = Field + "000000000000";
        Longi = 74;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#11;   |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalJ1;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 42;
        Field = Field + "000000000000000000000000";
        Longi = 66;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#10;   |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalI1;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 62;
        Field = Field + "000000000000";
        Longi = 74;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#9;    |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalH2;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 62;
        Field = Field + "000000000000";
        Longi = 74;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#48;   |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalH1;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 62;
        Field = Field + "000000000000";
        Longi = 74;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#47;   |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalG4;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 62;
        Field = Field + "000000000000";
        Longi = 74;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#45;   |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalG3;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 62;
        Field = Field + "000000000000";
        Longi = 74;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#44;   |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalG2;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 62;
        Field = Field + "000000000000";
        Longi = 74;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#8;    |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalG1;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 62;
        Field = Field + "000000000000";
        Longi = 74;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#7;    |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalF2;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 62;
        Field = Field + "000000000000";
        Longi = 74;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#6;    |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalF1;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 62;
        Field = Field + "000000000000";
        Longi = 74;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#5;    |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalE1;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 61;
        Field = Field + "000000000000";
        Longi = 73;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#4;    |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalD1;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 55;
        Field = Field + "000000000000";
        Longi = 67;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#46;   |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalC2;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 55;
        Field = Field + "000000000000";
        Longi = 67;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#54;   |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
    CantiNum = #70#3;    |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalC1;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 59;
        Field = Field + "000000000000";
        Longi = 71;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#53;   |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalB1;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 58;
        Field = Field + "000000000000";
        Longi = 70;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#2;     |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO TotalA1;
|SI Lineas = 0;
        Field = " " * 54;
        Field = Field + "000000000000";      || linea v.habitual
        Field = Field + "000000000000";
        Field = Field + "000000000000";
        Longi = 90;
    |HAZ ElFgraba;
        Lineas = Lineas + 1;
|FINSI;
|PARA Lineas = Lineas + 1; |SI Lineas [ Tope; |HACIENDO Lineas = Lineas + 1;
        Field = " " * 55;
        Field = Field + "000000000000";      || resto
        Longi = 67;
    |HAZ ElFgraba;
|SIGUE;
    CantiNum = #70#55;    |HAZ CambiCantiD12;     || subtotal A2 (d)
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
    CantiNum = #70#1;     |HAZ CambiCantiD12;
    Field = CantiAlfa;
    Longi = 12;
|HAZ ElFgraba;
|FPRC;

|PROCESO LaserU1;
    Field = #28#5;  Longi = 62;    |HAZ ElFgraba; || descripcion
    CantiNum = #28#9;    |HAZ CambiCantiD12;      || valor
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserQ1;
    Field = #28#5;  Longi = 62;    |HAZ ElFgraba; || descripcion
    CantiNum = #28#9;    |HAZ CambiCantiD12;      || valor
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserP1;
    Field = #28#5;  Longi = 62;    |HAZ ElFgraba; || descripcion
    CantiNum = #28#9;    |HAZ CambiCantiD12;      || valor
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserO1;
    Field = #28#5;  Longi = 62;    |HAZ ElFgraba; || descripcion
    CantiNum = #28#9;    |HAZ CambiCantiD12;      || valor
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserN1;
    Field = #28#5;  Longi = 62;    |HAZ ElFgraba; || descripcion
    CantiNum = #28#9;    |HAZ CambiCantiD12;      || valor
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserM1;
    Field = #28#15; Longi = 1;     |HAZ ElFgraba; || clave U/M/O
    Field = #28#16; Longi = 20;    |HAZ ElFgraba; || ref.catastral
    Field = #28#14; Longi = 21;    |HAZ ElFgraba; || descripcion
    CantiNum = #28#13;   |HAZ CambiCantiD12;      || valor del bien
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;
    CantiNum = #28#9;    |HAZ CambiCantiD12;      || valor del derecho
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserL1;
    Field = #28#5;  Longi = 62;    |HAZ ElFgraba; || descripcion
    CantiNum = #28#9;    |HAZ CambiCantiD12;      || valor
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserK1;
    Field = #28#5;  Longi = 62;    |HAZ ElFgraba; || descripcion
    CantiNum = #28#9;    |HAZ CambiCantiD12;      || valor
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserJ1;
    Field = #28#5;  Longi = 41;    |HAZ ElFgraba; || entidad
    Field = #28#15; Longi = 1;     |HAZ ElFgraba; || clave T/V
    CantiNum = #28#13;   |HAZ CambiCantiD12;      || importe anualidad
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;
    CantiNum = #28#9;    |HAZ CambiCantiD12;      || valor
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserI1;
    Field = #28#5;  Longi = 62;    |HAZ ElFgraba; || descripcion
    CantiNum = #28#9;    |HAZ CambiCantiD12;      || valor
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserH2;
    Field = #28#5;  Longi = 62;    |HAZ ElFgraba; || descripcion
    CantiNum = #28#9;    |HAZ CambiCantiD12;      || valor
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserH1;
    Field = #28#5;  Longi = 62;    |HAZ ElFgraba; || descripcion
    CantiNum = #28#9;    |HAZ CambiCantiD12;      || valor
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserG4;
    Field = #28#5;  Longi = 62;    |HAZ ElFgraba; || descripcion
    CantiNum = #28#9;    |HAZ CambiCantiD12;      || valor
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserG3;
    Field = #28#5;  Longi = 62;    |HAZ ElFgraba; || descripcion
    CantiNum = #28#9;    |HAZ CambiCantiD12;      || valor
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserG2;
    Field = #28#5;  Longi = 62;    |HAZ ElFgraba; || descripcion
    CantiNum = #28#9;    |HAZ CambiCantiD12;      || valor
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserG1;
    Field = #28#5;  Longi = 62;    |HAZ ElFgraba; || descripcion
    CantiNum = #28#9;    |HAZ CambiCantiD12;      || valor
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserF2;
    Field = #28#5;  Longi = 62;    |HAZ ElFgraba; || descripcion
    CantiNum = #28#9;    |HAZ CambiCantiD12;      || valor
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserF1;
    Field = #28#5;  Longi = 62;    |HAZ ElFgraba; || descripcion
    CantiNum = #28#9;    |HAZ CambiCantiD12;      || valor
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserE1;
    Field = #28#5;  Longi = 41;    |HAZ ElFgraba; || entidad
    Field = #28#12; Longi = 20;    |HAZ ElFgraba; || cuenta
    CantiNum = #28#9;    |HAZ CambiCantiD12;      || valor
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserD1;
    Field = #28#17; Longi = 5;     |HAZ ElFgraba; || epigrafe
    Field = #28#18; Longi = 1;     |HAZ ElFgraba; || clave U/R
    Field = #28#16; Longi = 20;    |HAZ ElFgraba; || ref.catas.
    Field = #28#5;  Longi = 29;    |HAZ ElFgraba; || descripcion
    CantiNum = #28#9;    |HAZ CambiCantiD12;      || valor
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserC2;
    Field = #28#17; Longi = 5;     |HAZ ElFgraba; || epigrafe
    Field = #28#18; Longi = 1;     |HAZ ElFgraba; || clave U/R
    Field = #28#16; Longi = 20;    |HAZ ElFgraba; || ref.catas.
    alfa1 = #28#5;  |QBF alfa1;                   || calle
    alfa2 = #28#6;  |QBF alfa2;                   || numero
    alfa3 = #28#10; |QBF alfa3;                   || poblacion
    alfa4 = #28#11; |QBF alfa4;                   || provincia
    Field = alfa1+" "+alfa2+" "+alfa3+" "+alfa4;  Longi = 29;  |HAZ ElFgraba;
    CantiNum = #28#9;    |HAZ CambiCantiD12;      || valor
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserC1;
    Field = #28#17; Longi = 5;     |HAZ ElFgraba; || epigrafe
    alfa1 = #28#5;  |QBF alfa1;                   || calle
    alfa2 = #28#6;  |QBF alfa2;                   || numero
    alfa3 = #28#10; |QBF alfa3;                   || poblacion
    alfa4 = #28#11; |QBF alfa4;                   || provincia
    Field = alfa1+" "+alfa2+" "+alfa3+" "+alfa4;  Longi = 28;  |HAZ ElFgraba;
    Field = #28#14; Longi = 26;    |HAZ ElFgraba; || descrip. bien
    CantiNum = #28#9;    |HAZ CambiCantiD12;      || valor
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserB1;
    Field = #28#15; Longi = 1;     |HAZ ElFgraba;      || clave M/N/P
    Field = #28#16; Longi = 20;    |HAZ ElFgraba;      || refer.catastral
    alfa3 = #28#10; |QBF alfa3;                        || poblacion
    alfa4 = #28#11; |QBF alfa4;                        || provincia
    Field = alfa3+" "+alfa4;    Longi = 37;  |HAZ ElFgraba;
    CantiNum = #28#9;    |HAZ CambiCantiD12;           || valor
    Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;

    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserA1;
|SI Lineas = 0;          || vivienda habitual
        Field = #28#15; Longi = 1;     |HAZ ElFgraba;      || clave M/N/P
        Field = #28#16; Longi = 20;    |HAZ ElFgraba;      || refer.catastral
        alfa1 = #28#5;  |QBF alfa1;                        || calle
        alfa2 = #28#6;  |QBF alfa2;                        || numero
        alfa3 = #28#10; |QBF alfa3;                        || poblacion
        alfa4 = #28#11; |QBF alfa4;                        || provincia
        Field = alfa1 + " " + alfa2 + " " + alfa3 + " " + alfa4;  Longi = 33;  |HAZ ElFgraba;
        CantiNum = #28#9;    |HAZ CambiCantiD12;           || valor a)
        Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;
        CantiNum = #28#19;   |HAZ CambiCantiD12;           || valor exento b)
        Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;
        CantiNum = #28#20;   |HAZ CambiCantiD12;           || valor no exento c)
        Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;
|SINO;
        Field = #28#15; Longi = 1;     |HAZ ElFgraba;      || clave M/N/P
        Field = #28#18; Longi = 1;     |HAZ ElFgraba;      || V/L/O
        Field = #28#16; Longi = 20;    |HAZ ElFgraba;      || refer.catastral
        alfa1 = #28#5;  |QBF alfa1;                        || calle
        alfa2 = #28#6;  |QBF alfa2;                        || numero
        alfa3 = #28#10; |QBF alfa3;                        || poblacion
        alfa4 = #28#11; |QBF alfa4;                        || provincia
        Field = alfa1 + " " + alfa2 + " " + alfa3 + " " + alfa4;  Longi = 33;  |HAZ ElFgraba;
        CantiNum = #28#9;    |HAZ CambiCantiD12;           || valor
        Field = CantiAlfa;   Longi = 12;    |HAZ ElFgraba;
|FINSI;
    Lineas = Lineas + 1;
|FPRC;

|PROCESO LaserInter1;
|SI #28#1 = "A1";   |HAZ LaserA1;  |FINSI;
|SI #28#1 = "B1";   |HAZ LaserB1;  |FINSI;
|SI #28#1 = "C1";   |HAZ LaserC1;  |FINSI;
|SI #28#1 = "C2";   |HAZ LaserC2;  |FINSI;
|SI #28#1 = "D1";   |HAZ LaserD1;  |FINSI;
|SI #28#1 = "E1";   |HAZ LaserE1;  |FINSI;
|SI #28#1 = "F1";   |HAZ LaserF1;  |FINSI;
|SI #28#1 = "F2";   |HAZ LaserF2;  |FINSI;
|SI #28#1 = "G1";   |HAZ LaserG1;  |FINSI;
|SI #28#1 = "G2";   |HAZ LaserG2;  |FINSI;
|SI #28#1 = "G3";   |HAZ LaserG3;  |FINSI;
|SI #28#1 = "G4";   |HAZ LaserG4;  |FINSI;
|SI #28#1 = "H1";   |HAZ LaserH1;  |FINSI;
|SI #28#1 = "H2";   |HAZ LaserH2;  |FINSI;
|SI #28#1 = "I1";   |HAZ LaserI1;  |FINSI;
|SI #28#1 = "J1";   |HAZ LaserJ1;  |FINSI;
|SI #28#1 = "K1";   |HAZ LaserK1;  |FINSI;
|SI #28#1 = "L1";   |HAZ LaserL1;  |FINSI;
|SI #28#1 = "M1";   |HAZ LaserM1;  |FINSI;
|SI #28#1 = "N1";   |HAZ LaserN1;  |FINSI;
|SI #28#1 = "O1";   |HAZ LaserO1;  |FINSI;
|SI #28#1 = "P1";   |HAZ LaserP1;  |FINSI;
|SI #28#1 = "Q1";   |HAZ LaserQ1;  |FINSI;
|SI #28#1 = "U1";   |HAZ LaserU1;  |FINSI;
|FPRC;

|DEFBUCLE LaserInter;
 #28#1;
 ;
 #9#0, #9#1, Daparta,   1;
 #9#0, #9#1, Daparta, 999;
 ;
 NULL, LaserInter1;
|FIN;

|PROCESO LaserInter;
    Longi = 7;
|SI Daparta = "A1"; Field = "71402 0"; |HAZ ElFgraba; |FINSI;
|SI Daparta = "C1"; Field = "71403 0"; |HAZ ElFgraba; |FINSI;
|SI Daparta = "E1"; Field = "71404 0"; |HAZ ElFgraba; |FINSI;
|SI Daparta = "G1"; Field = "71405 0"; |HAZ ElFgraba; |FINSI;
|SI Daparta = "G4"; Field = "71406 0"; |HAZ ElFgraba; |FINSI;
|SI Daparta = "K1"; Field = "71407 0"; |HAZ ElFgraba; |FINSI;
|SI Daparta = "O1"; Field = "71408 0"; |HAZ ElFgraba; |FINSI;

    Lineas = 0;
|CIERRA #28;
|BUCLE LaserInter;
|ABRE #28;

|SI Daparta = "A1"; |HAZ TotalA1;  |FINSI;
|SI Daparta = "B1"; |HAZ TotalB1;  |FINSI;
|SI Daparta = "C1"; |HAZ TotalC1;  |FINSI;
|SI Daparta = "C2"; |HAZ TotalC2;  |FINSI;
|SI Daparta = "D1"; |HAZ TotalD1;  |FINSI;
|SI Daparta = "E1"; |HAZ TotalE1;  |FINSI;
|SI Daparta = "F1"; |HAZ TotalF1;  |FINSI;
|SI Daparta = "F2"; |HAZ TotalF2;  |FINSI;
|SI Daparta = "G1"; |HAZ TotalG1;  |FINSI;
|SI Daparta = "G2"; |HAZ TotalG2;  |FINSI;
|SI Daparta = "G3"; |HAZ TotalG3;  |FINSI;
|SI Daparta = "G4"; |HAZ TotalG4;  |FINSI;
|SI Daparta = "H1"; |HAZ TotalH1;  |FINSI;
|SI Daparta = "H2"; |HAZ TotalH2;  |FINSI;
|SI Daparta = "I1"; |HAZ TotalI1;  |FINSI;
|SI Daparta = "J1"; |HAZ TotalJ1;  |FINSI;
|SI Daparta = "K1"; |HAZ TotalK1;  |FINSI;
|SI Daparta = "L1"; |HAZ TotalL1;  |FINSI;
|SI Daparta = "M1"; |HAZ TotalM1;  |FINSI;
|SI Daparta = "N1"; |HAZ TotalN1;  |FINSI;
|SI Daparta = "O1"; |HAZ TotalO1;  |FINSI;
|SI Daparta = "P1"; |HAZ TotalP1;  |FINSI;
|SI Daparta = "Q1"; |HAZ TotalQ1;  |FINSI;
|SI Daparta = "U1"; |HAZ TotalU1;  |FINSI;

    Longi = 2;
|SI Daparta = "B1"; Field = &13 +&10; |HAZ ElFgraba; |FINSI;
|SI Daparta = "D1"; Field = &13 +&10; |HAZ ElFgraba; |FINSI;
|SI Daparta = "F2"; Field = &13 +&10; |HAZ ElFgraba; |FINSI;
|SI Daparta = "G3"; Field = &13 +&10; |HAZ ElFgraba; |FINSI;
|SI Daparta = "J1"; Field = &13 +&10; |HAZ ElFgraba; |FINSI;
|SI Daparta = "N1"; Field = &13 +&10; |HAZ ElFgraba; |FINSI;
|SI Daparta = "U1"; Field = &13 +&10; |HAZ ElFgraba; |FINSI;
|FPRC;

|PROCESO Laser_28;
|SI #29#32 ! 0;|O #29#4 ! 0;|O #29#5 ! 0;              || totales hoja 2
    Daparta = "A1"; Tope = TopeA1; |HAZ LaserInter;
    Daparta = "B1"; Tope = TopeB1; |HAZ LaserInter;
|FINSI;
|SI #29#6 ! 0;|O #29#28 ! 0;                           || totales hoja 3
    Daparta = "C1"; Tope = TopeC1; |HAZ LaserInter;
    Daparta = "C2"; Tope = TopeC2; |HAZ LaserInter;
    Daparta = "D1"; Tope = TopeD1; |HAZ LaserInter;
|FINSI;
|SI #29#7 ! 0;|O #29#8 ! 0;|O #29#9 ! 0;               || totales hoja 4
    Daparta = "E1"; Tope = TopeE1; |HAZ LaserInter;
    Daparta = "F1"; Tope = TopeF1; |HAZ LaserInter;
    Daparta = "F2"; Tope = TopeF2; |HAZ LaserInter;
|FINSI;
|SI #29#10 ! 0;|O #29#11 ! 0;|O #29#12 ! 0;            || totales hoja 5
    Daparta = "G1"; Tope = TopeG1; |HAZ LaserInter;
    Daparta = "G2"; Tope = TopeG2; |HAZ LaserInter;
    Daparta = "G3"; Tope = TopeG3; |HAZ LaserInter;
|FINSI;
|SI #29#13 ! 0;|O #29#29 ! 0;|O #29#30 ! 0;|O #29#14 ! 0;|O #29#15 ! 0;
    Daparta = "G4"; Tope = TopeG4; |HAZ LaserInter;    || totales hoja 6
    Daparta = "H1"; Tope = TopeH1; |HAZ LaserInter;
    Daparta = "H2"; Tope = TopeH2; |HAZ LaserInter;
    Daparta = "I1"; Tope = TopeI1; |HAZ LaserInter;
    Daparta = "J1"; Tope = TopeJ1; |HAZ LaserInter;
|FINSI;
|SI #29#16 ! 0;|O #29#17 ! 0;|O #29#18 ! 0;|O #29#19 ! 0;
    Daparta = "K1"; Tope = TopeK1; |HAZ LaserInter;    || totales hoja 7
    Daparta = "L1"; Tope = TopeL1; |HAZ LaserInter;
    Daparta = "M1"; Tope = TopeM1; |HAZ LaserInter;
    Daparta = "N1"; Tope = TopeN1; |HAZ LaserInter;
|FINSI;
|SI #29#20 ! 0;|O #29#21 ! 0;|O #29#22 ! 0;|O #29#24 ! 0;
    Daparta = "O1"; Tope = TopeO1; |HAZ LaserInter;    || totales hoja 8
    Daparta = "P1"; Tope = TopeP1; |HAZ LaserInter;
    Daparta = "Q1"; Tope = TopeQ1; |HAZ LaserInter;
    Daparta = "U1"; Tope = TopeU1; |HAZ LaserInter;
|FINSI;
|FPRC;

|PROCESO Laser_27;
    Field = "71401 ";    Longi = 6;     |HAZ ElFgraba;
    Field = #27#5;       Longi = 5;     |HAZ ElFgraba;
    Field = #27#6;       Longi = 1;     |HAZ ElFgraba;
    Field = #27#3;       Longi = 1;     |HAZ ElFgraba;
    Field = #27#7;       Longi = 9;     |HAZ ElFgraba;
    Field = #27#8;       Longi = 30;    |HAZ ElFgraba;
    Field = #27#9;       Longi = 15;    |HAZ ElFgraba;
    Field = #27#10;      Longi = 2;     |HAZ ElFgraba;
    Field = #27#11;      Longi = 27;    |HAZ ElFgraba;
    Field = #27#12;      Longi = 4;     |HAZ ElFgraba;
    Field = #27#13;      Longi = 2;     |HAZ ElFgraba;
    Field = #27#14;      Longi = 2;     |HAZ ElFgraba;
    Field = #27#15;      Longi = 2;     |HAZ ElFgraba;
    Field = #27#16;      Longi = 9;     |HAZ ElFgraba;
    Field = #27#17;      Longi = 33;    |HAZ ElFgraba;
    Field = #27#18;      Longi = 19;    |HAZ ElFgraba;
    Field = ("00000" + #27#19) % -105;  Longi = 5;     |HAZ ElFgraba;
    Field = #27#20;      Longi = 9;     |HAZ ElFgraba;
    Field = #27#21;      Longi = 36;    |HAZ ElFgraba;
    Field = #27#22;      Longi = 2;     |HAZ ElFgraba;
    Field = #27#23;      Longi = 27;    |HAZ ElFgraba;
    Field = #27#24;      Longi = 4;     |HAZ ElFgraba;
    Field = #27#25;      Longi = 2;     |HAZ ElFgraba;
    Field = #27#26;      Longi = 2;     |HAZ ElFgraba;
    Field = #27#27;      Longi = 2;     |HAZ ElFgraba;
    Field = #27#28;      Longi = 9;     |HAZ ElFgraba;
    Field = #27#29;      Longi = 33;    |HAZ ElFgraba;
    Field = #27#30;      Longi = 19;    |HAZ ElFgraba;
    Field = ("00000" + #27#31) % -105;  Longi = 5;     |HAZ ElFgraba;
    Field = #27#32;      Longi = 1;     |HAZ ElFgraba;
    alfa1 = #27#33; |QBF alfa1;
    Field = ("00" + alfa1) % -102;      Longi = 2;     |HAZ ElFgraba;
    Field = #27#34;      Longi = 1;     |HAZ ElFgraba;
    Field = #27#17;      Longi = 20;    |HAZ ElFgraba;
    Field = LFecDi;      Longi = 2;     |HAZ ElFgraba;
    Field = LFecMe;      Longi = 10;    |HAZ ElFgraba;
    Field = LFecAn;      Longi = 4;     |HAZ ElFgraba;
    Field = "";          Longi = 21;    |HAZ ElFgraba; || reservado AEAT
    Field = #27#4;       Longi = 20;    |HAZ ElFgraba;
    Field = #27#35;      Longi = 2;     |HAZ ElFgraba;
|FPRC;

|PROCESO Laser;
    Directorio = "";     |DBASE Directorio;
    Directorio = Directorio + "hacienda/";
|MKDIR Directorio;

    FichLaser = "pa" + (("0000" + #9#0) % -105) + #9#1;
    Fabre = "wb  " + Directorio + FichLaser;

    INEmpresas = NEmpresas1 <-;
    INEmpresas = INEmpresas + NCopia;
    NEmpresas  = Directorio + FichLaser;

    Pos = -1;
|FABRE Fabre;
|SI FSalida ] 0;
        Fcanl = FSalida;
    |HAZ Laser_27;
    |HAZ Laser_28;
    |HAZ Laser_29;
    |HAZ Laser_30;
    |HAZ Laser_31;
    |FCIERRA Fcanl;
|SINO;
        alfa1 = "    [" + (Fabre % 5) + "] inaccesible para escritura ...";
|FINSI;
    Pos = -1;
|FPRC;

____________________________________/ IMPRESION EN PAPEL
|PROCESO continuo;
     |SI informe = "rehoblan"; |Y #0#34  = "N"; |ACABA; |FINSI;
     |SI informe = "m714ch01"; |Y #0#38  = "N"; |ACABA; |FINSI;
     |SI informe = "m714ch09"; |Y #0#46  = "N"; |ACABA; |FINSI;
     |SI informe = "m714ch10"; |Y #0#47  = "N"; |ACABA; |FINSI;
     |SI informe = "m714ch11"; |Y #0#48  = "N"; |ACABA; |FINSI;

     |INFOR informe;
     |SI FSalida = 0;
         |PRINT;
         |PIEINF;
         |FININF;
     |SINO;
             alfa1 = "    Informe [" + informe + "] inaccesible o inexistente ...";
         |MENAV alfa1;
     |FINSI;
|FPRC;

|PROCESO Mensajes;
     |SI informe = "m714mh01";
             #6#2 = "COLOQUE HOJA 1 DEL PATRIMONIO, <INTRO PARA IMPRIMIR>";
     |FINSI;
     |SI Daparta = "A1";
             #6#2 = "COLOQUE HOJA 2 DEL PATRIMONIO, <INTRO PARA IMPRIMIR>";
     |FINSI;
     |SI Daparta = "C1";
             #6#2 = "COLOQUE HOJA 3 DEL PATRIMONIO, <INTRO PARA IMPRIMIR>";
     |FINSI;
     |SI Daparta = "D1";
             #6#2 = "COLOQUE HOJA 4 DEL PATRIMONIO, <INTRO PARA IMPRIMIR>";
     |FINSI;
     |SI Daparta = "F1";
             #6#2 = "COLOQUE HOJA 5 DEL PATRIMONIO, <INTRO PARA IMPRIMIR>";
     |FINSI;
     |SI Daparta = "F4";
             #6#2 = "COLOQUE HOJA 6 DEL PATRIMONIO, <INTRO PARA IMPRIMIR>";
     |FINSI;
     |SI Daparta = "I1";
             #6#2 = "COLOQUE HOJA 7 DEL PATRIMONIO, <INTRO PARA IMPRIMIR>";
     |FINSI;
     |SI Daparta = "M1";
             #6#2 = "COLOQUE HOJA 8 DEL PATRIMONIO, <INTRO PARA IMPRIMIR>";
     |FINSI;
     |SI informe = "m714mh09";
             #6#2 = "COLOQUE HOJA 9 DEL PATRIMONIO, <INTRO PARA IMPRIMIR>";
     |FINSI;
     |SI informe = "m714mh10";
             #6#2 = "COLOQUE HOJA 10 DEL PATRIMONIO, <INTRO PARA IMPRIMIR>";
     |FINSI;
     |SI informe = "m714mh11";
             #6#2 = "COLOQUE HOJA DE INGRESO O DEVOLUCION, <INTRO PARA IMPRIMIR>";
     |FINSI;

     |ATRI P;
     |PINTA #6#2;
     |ATRI 0;
     |AVISO;
     |PAUSA;
|FPRC;

|PROCESO manual;
     |SI informe = "m714mh01"; |Y #0#38  = "N"; |ACABA; |FINSI;
     |SI informe = "m714mh09"; |Y #0#46  = "N"; |ACABA; |FINSI;
     |SI informe = "m714mh10"; |Y #0#47  = "N"; |ACABA; |FINSI;
     |SI informe = "m714mh11"; |Y #0#48  = "N"; |ACABA; |FINSI;

     |ET comienzo;
         |HAZ Mensajes;
         |INFOR informe;
         |SI FSalida = 0;
             |PRINT;
             |PIEINF;
             |FININF;
             |AVISO;
             |CONFI "2400NDesea repetir la hoja (S/N): ";
             |SI FSalida = 0;
                 |VETE comienzo;
             |FINSI;
         |SINO;
                 alfa1 = "    Informe [" + informe + "] inaccesible o inexistente ...";
             |MENAV alfa1;
         |FINSI;
|FPRC;

|PROCESO ImpLinea;
     |SI Detalle = 1;  Pinfor2 = "m7140102"; |FINSI; || A
     |SI Detalle = 10; Pinfor2 = "m7140802"; |FINSI; || B
     |SI Detalle = 2;  Pinfor2 = "m7140202"; |FINSI; || C1
     |SI Detalle = 3;  Pinfor2 = "m7140302"; |FINSI; || C2, D
     |SI Detalle = 4;  Pinfor2 = "m7140402"; |FINSI; || E
     |SI Detalle = 5;  Pinfor2 = "m7140502"; |FINSI; || F1,F2,G1,G2,G3,G4,H1,H2,I,K,L,N,O,P,Q,U
     |SI Detalle = 6;  Pinfor2 = "m7140602"; |FINSI; || J
     |SI Detalle = 7;  Pinfor2 = "m7140702"; |FINSI; || M
     |SI Detalle = 97; Pinfor2 = "m7149702"; |FINSI; || encabezamiento (nif)
     |SI Detalle = 98; Pinfor2 = "m7149802"; |FINSI; || totales
     |SI Detalle = 99; Pinfor2 = "m7149902"; |FINSI; || linea en blanco
     |INFOR Pinfor2;
     |SI FSalida = 0;
         |PRINT;
         |PIEINF;
         |FININF;
             Papel = Papel + 1;
     |SINO;
             alfa1 = "    Informe [" + Pinfor2 + "] inaccesible o inexistente ...";
     |FINSI;
|FPRC;

|PROCESO BajaImp;
     |PARA; |SI Papel < Baja; |HACIENDO;
             Detalle = 99;
         |SI                 Papel=Encab; Detalle = 97;                |FINSI;
         |SI Daparta="A1";|Y Papel=TotA1; Detalle = 98; Total = #70#1; |FINSI; ||A
         |SI Daparta="A1";|Y Papel=TotB1; Detalle = 98; Total = #70#2; |FINSI; ||B
         |SI Daparta="C1";|Y Papel=TotC1; Detalle = 98; Total = #70#53;|FINSI; ||C1
         |SI Daparta="C1";|Y Papel=TotC2; Detalle = 98; Total = #70#54;|FINSI; ||C2
         |SI Daparta="C1";|Y Papel=TotD1; Detalle = 98; Total = #70#46;|FINSI; ||D
         |SI Daparta="E1";|Y Papel=TotE1; Detalle = 98; Total = #70#4; |FINSI; ||E
         |SI Daparta="E1";|Y Papel=TotF1; Detalle = 98; Total = #70#5; |FINSI; ||F1
         |SI Daparta="E1";|Y Papel=TotF2; Detalle = 98; Total = #70#6; |FINSI; ||F2
         |SI Daparta="G1";|Y Papel=TotG1; Detalle = 98; Total = #70#7; |FINSI; ||G1
         |SI Daparta="G1";|Y Papel=TotG2; Detalle = 98; Total = #70#8; |FINSI; ||G2
         |SI Daparta="G1";|Y Papel=TotG3; Detalle = 98; Total = #70#44;|FINSI; ||G3
         |SI Daparta="G4";|Y Papel=TotG4; Detalle = 98; Total = #70#45;|FINSI; ||G4
         |SI Daparta="G4";|Y Papel=TotH1; Detalle = 98; Total = #70#47;|FINSI; ||H1
         |SI Daparta="G4";|Y Papel=TotH2; Detalle = 98; Total = #70#48;|FINSI; ||H2
         |SI Daparta="G4";|Y Papel=TotI1; Detalle = 98; Total = #70#9; |FINSI; ||I
         |SI Daparta="G4";|Y Papel=TotJ1; Detalle = 98; Total = #70#10;|FINSI; ||J
         |SI Daparta="K1";|Y Papel=TotK1; Detalle = 98; Total = #70#11;|FINSI; ||K
         |SI Daparta="K1";|Y Papel=TotL1; Detalle = 98; Total = #70#12;|FINSI; ||L
         |SI Daparta="K1";|Y Papel=TotM1; Detalle = 98; Total = #70#13;|FINSI; ||M
         |SI Daparta="K1";|Y Papel=TotN1; Detalle = 98; Total = #70#14;|FINSI; ||N
         |SI Daparta="O1";|Y Papel=TotO1; Detalle = 98; Total = #70#15;|FINSI; ||O
         |SI Daparta="O1";|Y Papel=TotP1; Detalle = 98; Total = #70#16;|FINSI; ||P
         |SI Daparta="O1";|Y Papel=TotQ1; Detalle = 98; Total = #70#17;|FINSI; ||Q
         |SI Daparta="O1";|Y Papel=TotU1; Detalle = 98; Total = #70#19;|FINSI; ||D.
         |HAZ ImpLinea;
         |SI Daparta = "C1";|Y Papel= TotC0;      || total C1 y C2
                 Detalle = 98; Total = #70#3;  |HAZ ImpLinea;
         |FINSI;
         |SI Daparta = "O1";|Y Papel= TotZ1;      || total bienes y derechos
                 Detalle = 98; Total = #70#18; |HAZ ImpLinea;
         |FINSI;
     |SIGUE;
|FPRC;

|PROCESO HojasInter1;
     |SI #28#1= "A1";|Y Papel< EmpA1; Baja = EmpA1; |HAZ BajaImp; |FINSI; ||A
     |SI #28#1= "B1";|Y Papel< EmpB1; Baja = EmpB1; |HAZ BajaImp; |FINSI; ||B
     |SI #28#1= "C1";|Y Papel< EmpC1; Baja = EmpC1; |HAZ BajaImp; |FINSI; ||C1
     |SI #28#1= "C2";|Y Papel< EmpC2; Baja = EmpC2; |HAZ BajaImp; |FINSI; ||C2
     |SI #28#1= "D1";|Y Papel< EmpD1; Baja = EmpD1; |HAZ BajaImp; |FINSI; ||D
     |SI #28#1= "E1";|Y Papel< EmpE1; Baja = EmpE1; |HAZ BajaImp; |FINSI; ||E
     |SI #28#1= "F1";|Y Papel< EmpF1; Baja = EmpF1; |HAZ BajaImp; |FINSI; ||F1
     |SI #28#1= "F2";|Y Papel< EmpF2; Baja = EmpF2; |HAZ BajaImp; |FINSI; ||F2
     |SI #28#1= "G1";|Y Papel< EmpG1; Baja = EmpG1; |HAZ BajaImp; |FINSI; ||G1
     |SI #28#1= "G2";|Y Papel< EmpG2; Baja = EmpG2; |HAZ BajaImp; |FINSI; ||G2
     |SI #28#1= "G3";|Y Papel< EmpG3; Baja = EmpG3; |HAZ BajaImp; |FINSI; ||G3
     |SI #28#1= "G4";|Y Papel< EmpG4; Baja = EmpG4; |HAZ BajaImp; |FINSI; ||G4
     |SI #28#1= "H1";|Y Papel< EmpH1; Baja = EmpH1; |HAZ BajaImp; |FINSI; ||H1
     |SI #28#1= "H2";|Y Papel< EmpH2; Baja = EmpH2; |HAZ BajaImp; |FINSI; ||H2
     |SI #28#1= "I1";|Y Papel< EmpI1; Baja = EmpI1; |HAZ BajaImp; |FINSI; ||I
     |SI #28#1= "J1";|Y Papel< EmpJ1; Baja = EmpJ1; |HAZ BajaImp; |FINSI; ||J
     |SI #28#1= "K1";|Y Papel< EmpK1; Baja = EmpK1; |HAZ BajaImp; |FINSI; ||K
     |SI #28#1= "L1";|Y Papel< EmpL1; Baja = EmpL1; |HAZ BajaImp; |FINSI; ||L
     |SI #28#1= "M1";|Y Papel< EmpM1; Baja = EmpM1; |HAZ BajaImp; |FINSI; ||M
     |SI #28#1= "N1";|Y Papel< EmpN1; Baja = EmpN1; |HAZ BajaImp; |FINSI; ||N
     |SI #28#1= "O1";|Y Papel< EmpO1; Baja = EmpO1; |HAZ BajaImp; |FINSI; ||O
     |SI #28#1= "P1";|Y Papel< EmpP1; Baja = EmpP1; |HAZ BajaImp; |FINSI; ||P
     |SI #28#1= "Q1";|Y Papel< EmpQ1; Baja = EmpQ1; |HAZ BajaImp; |FINSI; ||Q
     |SI #28#1= "U1";|Y Papel< EmpU1; Baja = EmpU1; |HAZ BajaImp; |FINSI; ||D.

     |SI #28#1 = "A1";   Detalle = 1;   |FINSI;        || A
     |SI #28#1 = "B1";   Detalle = 10;  |FINSI;        || B
     |SI #28#1 = "C1";   Detalle = 2;   |FINSI;        || C1
     |SI #28#1 = "C2";   Detalle = 3;   |FINSI;        || C2
     |SI #28#1 = "D1";   Detalle = 3;   |FINSI;        || D
     |SI #28#1 = "E1";   Detalle = 4;   |FINSI;        || E
     |SI #28#1 = "F1";   Detalle = 5;   |FINSI;        || F1
     |SI #28#1 = "F2";   Detalle = 5;   |FINSI;        || F2
     |SI #28#1 = "G1";   Detalle = 5;   |FINSI;        || G1
     |SI #28#1 = "G2";   Detalle = 5;   |FINSI;        || G2
     |SI #28#1 = "G3";   Detalle = 5;   |FINSI;        || G3
     |SI #28#1 = "G4";   Detalle = 5;   |FINSI;        || G4
     |SI #28#1 = "H1";   Detalle = 5;   |FINSI;        || H1
     |SI #28#1 = "H2";   Detalle = 5;   |FINSI;        || H2
     |SI #28#1 = "I1";   Detalle = 5;   |FINSI;        || I
     |SI #28#1 = "J1";   Detalle = 6;   |FINSI;        || J
     |SI #28#1 = "K1";   Detalle = 5;   |FINSI;        || K
     |SI #28#1 = "L1";   Detalle = 5;   |FINSI;        || L
     |SI #28#1 = "M1";   Detalle = 7;   |FINSI;        || M
     |SI #28#1 = "N1";   Detalle = 5;   |FINSI;        || N
     |SI #28#1 = "O1";   Detalle = 5;   |FINSI;        || O
     |SI #28#1 = "P1";   Detalle = 5;   |FINSI;        || P
     |SI #28#1 = "Q1";   Detalle = 5;   |FINSI;        || Q
     |SI #28#1 = "U1";   Detalle = 5;   |FINSI;        || DEUDAS

     |HAZ ImpLinea;
|FPRC;

|DEFBUCLE HojasInter;
     #28#1;
     ;
     #9#0, #9#1, Daparta,   1;
     #9#0, #9#1, Haparta, 999;
     ;
     NULL, HojasInter1;
|FIN;

|PROCESO HojasInter;
         SwRepite = 1;
     |PARA; |SI SwRepite ! 0; |HACIENDO;
             SwRepite = 0;
         |SI papel = 2;  |HAZ Mensajes; |FINSI;
             Papel = 0;
         |CIERRA #28;
         |BUCLE HojasInter;
         |ABRE #28;
         |SI Papel< TMaxi; Baja = TMaxi; |HAZ BajaImp; |FINSI;
         |SI papel = 2;
             |AVISO;
             |CONFI "2400NDesea repetir la hoja (S/N): ";
             |SI FSalida = 0;
                     SwRepite = 1;
             |FINSI;
         |FINSI;
     |SIGUE;
|FPRC;

|PROCESO apartados;
     |SI #0#39 = "S"; Daparta = "A1";  Haparta = "B1"; |HAZ HojasInter;  |FINSI;
     |SI #0#40 = "S"; Daparta = "C1";  Haparta = "D1"; |HAZ HojasInter;  |FINSI;
     |SI #0#41 = "S"; Daparta = "E1";  Haparta = "F2"; |HAZ HojasInter;  |FINSI;
     |SI #0#42 = "S"; Daparta = "G1";  Haparta = "G3"; |HAZ HojasInter;  |FINSI;
     |SI #0#43 = "S"; Daparta = "G4";  Haparta = "J1"; |HAZ HojasInter;  |FINSI;
     |SI #0#44 = "S"; Daparta = "K1";  Haparta = "N1"; |HAZ HojasInter;  |FINSI;
     |SI #0#45 = "S"; Daparta = "O1";  Haparta = "U1"; |HAZ HojasInter;  |FINSI;
|FPRC;

|PROCESO Oficial;
     |SI papel = 1;      || continuo
             informe = "rehoblan"; |HAZ continuo;
             informe = "m714ch01"; |HAZ continuo;
                                   |HAZ apartados;
             informe = "m714ch09"; |HAZ continuo;
             informe = "m714ch10"; |HAZ continuo;
             informe = "m714ch11"; |HAZ continuo;
     |FINSI;
     |SI papel = 2;      || hoja a hoja
             informe = "m714mh01"; |HAZ manual;
                                   |HAZ apartados;
             informe = "m714mh09"; |HAZ manual;
             informe = "m714mh10"; |HAZ manual;
             informe = "m714mh11"; |HAZ manual;
     |FINSI;
|FPRC;

____________________________________/ CONTROL DE IMPRESION
|PROCESO Imprime;
         SwTmp = 0;
     |DDEFECTO #27; #27#0 = #9#0; #27#1 = #9#1; |LEE 000#27=;  SwTmp = SwTmp + FSalida;
     |DDEFECTO #29; #29#0 = #9#0; #29#1 = #9#1; |LEE 000#29=;  SwTmp = SwTmp + FSalida;
     |DDEFECTO #30; #30#0 = #9#0; #30#1 = #9#1; |LEE 000#30=;  SwTmp = SwTmp + FSalida;
     |DDEFECTO #31; #31#0 = #9#0; #31#1 = #9#1; |LEE 000#31=;  SwTmp = SwTmp + FSalida;

     |SI SwTmp = 0;
         |SI #0#49 = "O";
             |PARA xxx = 1; |SI xxx [ #9#4; |HACIENDO xxx = xxx + 1;  || copias
                     #6#3 = xxx;
                 |PINTA #6#3;
                 |HAZ Oficial;
             |SIGUE;
         |SINO;
             |HAZ Laser;
         |FINSI;
             NCopia = NCopia + 1;
     |SINO;
         |MENAV "    Error en grabacion de ficheros temporales ...";
     |FINSI;
|FPRC;

____________________________________/ GRABACION DE LA HOJA DE ING./DEV.
|PROCESO Graba_31;
     |DDEFECTO #31;
     #31#0 = #9#0;        || codigo
     #31#1 = #9#1;        || tipo
     #31#4 = cpadm;       || cod.admon
     #31#5 = dnicif;      || nif
     #31#6 = nombre;      || apellidos y nombre
     #31#7 = #1#14;       || SG
     #31#8 = #1#15;       || calle
     #31#9 = #1#16;       || numero
     alfa1 = #1#17; |QBF alfa1; alfa1 = (alfa1 + "  ") % 102;
     #31#10 = alfa1;      || escalera
     alfa1 = #1#18; |QBF alfa1; alfa1 = (alfa1 + "  ") % 102;
     #31#11 = alfa1;      || piso
     alfa1 = #1#19; |QBF alfa1; alfa1 = (alfa1 + "  ") % 102;
     #31#12 = alfa1;      || puerta
     nNume1 = #1#12;
     |SI nNume1 = 0; #31#13 = "000000000"; |SINO; #31#13 = #1#12; |FINSI;
                          || telefono
     #31#14 = #1#22;      || municipio
     #31#15 = #4#2;       || provincia
     aAlfa  = (("00" + #1#20) % -102) + (("000" + #1#21) % -103) ; || codigo postal
     #31#16 = aAlfa;
     #31#17 = habit;      || no residente
     #31#18 = #70#41;     || CUOTA A INGRESAR
     #31#19 = 0;          || declaracion complementaria cuota a ingresar
     #31#20 = 0;          || declaracion complementaria resultado a ingresar
     #31#21 = 0;          || declaracion complementaria diferencia a ingresar
     |SI #70#41 > 0;
             #31#22 = " ";    || declaracion negativa NO
     |SINO;
             #31#22 = "X";    || declaracion negativa SI
     |FINSI;
         #31#23 = "X";        || forma de pago en efectivo
         #31#24 = " ";        || forma de pago en cuenta

     |SI #70#41 > 0;               || datos bancarios (solo cuando es a ingresar)
             #31#25 = #31#18;           || importe

             |QBF cuenta;
             |SI #0#50 = "S";|Y cuenta ! "";
                 #31#23 = " ";              || forma de pago en efectivo
                 #31#24 = "X";              || forma de pago en cuenta
                 #31#26 = cuenta % 104;     || banco
                 #31#27 = cuenta % 504;     || sucursal
                 #31#28 = cuenta % 902;     || d.c.
                 #31#29 = cuenta % 1110;    || nro.cuenta
             |FINSI;
     |FINSI;

         #31#30 = &13 + &10;  || CRLF
     |GRABA 020#31n;
|FPRC;

____________________________________/ GRABACION DE LA HOJA 10
|PROCESO Graba_30;
      |DDEFECTO #30;
      #30#0 = #9#0;        || codigo
      #30#1 = #9#1;        || tipo
      #30#4 = #70#22;      || BASE LIQUIDABLE
      #30#5 = #70#24;      || hasta
      #30#6 = #70#29;      || cuota hasta
      #30#7 = #70#25;      || resto
      #30#8 = #70#51;      || parte entera %
      #30#9 = #70#52;      || parte decimal %
      #30#10 = #70#27;     || cuota desde
      #30#11 = #70#23;     || suma
      #30#12 = #70#23;     || CUOTA INTEGRA
      #30#13 = #70#30;     || cuota integra IRPF
      #30#14 = #70#31;     || parte cuota integra IRPF
      #30#15 = #70#32;     || suma de cuotas
      #30#16 = #70#33;     || limite conjunto cuotas
      #30#17 = #70#34;     || exceso
      #30#18 = #70#35;     || 80% cuota integra
      #30#19 = #70#36;     || TOTAL CUOTA INTEGRA
      #30#20 = #70#49;     || parte entera TM
      #30#21 = #70#50;     || parte decimal TM
      #30#22 = #70#42;     || impuestos extranjero
      #30#23 = #70#43;     || parte gravada extranjero
      #30#24 = #70#37;     || importe deduccion
      #30#25 = #70#38;     || valor neto Ceuta-Melilla
      #30#26 = #70#39;     || parte cuota proporcion
      #30#27 = #70#40;     || bonificacion
      #30#28 = #70#41;     || CUOTA A INGRESAR
      #30#29 = &13 + &10;  || CRLF
      |GRABA 020#30n;
|FPRC;

____________________________________/ GRABACION DE LA HOJA 09
|PROCESO Graba_29;
     |DDEFECTO #4;  #4#0 = #1#20;  #4#1 = #1#21;  |LEE 000#4=;   || repoblac

     |DDEFECTO #29;
     #29#0 = #9#0;        || codigo
     #29#1 = #9#1;        || tipo
     #29#4 = #70#1;       || A
     #29#5 = #70#2;       || B
     #29#6 = #70#3;       || C
     #29#7 = #70#4;       || E
     #29#8 = #70#5;       || F1
     #29#9 = #70#6;       || F2
     #29#10 = #70#7;      || G1
     #29#11 = #70#8;      || G2
     #29#12 = #70#44;     || G3
     #29#13 = #70#45;     || G4
     #29#14 = #70#9;      || I
     #29#15 = #70#10;     || J
     #29#16 = #70#11;     || K
     #29#17 = #70#12;     || L
     #29#18 = #70#13;     || M
     #29#19 = #70#14;     || N
     #29#20 = #70#15;     || O
     #29#21 = #70#16;     || P
     #29#22 = #70#17;     || Q
     #29#23 = #70#18;     || TOTAL BIENES Y DERECHOS NO EXENTOS
     #29#24 = #70#19;     || DEUDAS
     #29#25 = #70#20;     || BASE IMPONIBLE
     #29#26 = #70#21;     || REDUCCION
     #29#27 = #70#22;     || BASE LIQUIDABLE
     #29#28 = #70#46;     || D
     #29#29 = #70#47;     || H1
     #29#30 = #70#48;     || H2
     #29#31 = &13 + &10;  || CRLF

     #29#32 = #70#56;     || A1, casilla a, solo para comprobar si debe imprimir

     |GRABA 020#29n;
|FPRC;

____________________________________/ GRABACION DE LA HOJA 02-08

/__________________ DEUDAS (U)
|PROCESO carga_h8_4;
|SI Lineas [ TopeU1;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || descripcion
        #28#9 = #50#10 % coefi;   || valor
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeU1;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#5 = RelAdjunta;
            #28#9 = #28#9 + (#50#10 % coefi);
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunU1 = 1;
|FINSI;
|FPRC;
/__________________ Q
|PROCESO carga_h8_3;
|SI Lineas [ TopeQ1;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || descripcion
        #28#9 = #50#10 % coefi;   || valor
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeQ1;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#5 = RelAdjunta;
            #28#9 = #28#9 + (#50#10 % coefi);
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunQ1 = 1;
|FINSI;
|FPRC;
/__________________ P
|PROCESO carga_h8_2;
|SI Lineas [ TopeP1;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || descripcion
        #28#9 = #50#10 % coefi;    || valor
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeP1;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#5 = RelAdjunta;
            #28#9 = #28#9 + (#50#10 % coefi);
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunP1 = 1;
|FINSI;
|FPRC;
/__________________ O
|PROCESO carga_h8_1;
|SI Lineas [ TopeO1;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || descripcion
        #28#9 = #50#10 % coefi;   || valor
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeO1;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#5 = RelAdjunta;
            #28#9 = #28#9 + (#50#10 % coefi);
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunO1 = 1;
|FINSI;
|FPRC;
/__________________ N
|PROCESO carga_h7_4;
|SI Lineas [ TopeN1;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || descripcion
        #28#9 = #50#10 % coefi;   || valor
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeN1;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#5 = RelAdjunta;
            #28#9 = #28#9 + (#50#10 % coefi);
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunN1 = 1;
|FINSI;
|FPRC;
/__________________ M
|PROCESO carga_h7_3;
|SI Lineas [ TopeM1;
        #28#2 = Lineas;           || linea
        #28#9 = #50#10 % coefi;   || valor del derecho
        #28#13 = #50#14 % coefi;  || valor del bien
        #28#14 = #50#15;          || descripcion
        #28#15 = #50#16;          || clave U/M/O
        #28#16 = #50#17;          || referencia catastral
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeM1;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#9 = #28#9 + (#50#10 % coefi);
            #28#13 = #28#13 + (#50#14 % coefi);
            #28#14 = RelAdjunta;
            #28#15 = "";
            #28#16 = "";
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunM1 = 1;
|FINSI;
|FPRC;
/__________________ L
|PROCESO carga_h7_2;
|SI Lineas [ TopeL1;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || descripcion
        #28#9 = #50#10 % coefi;   || valor
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeL1;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#5 = RelAdjunta;
            #28#9 = #28#9 + (#50#10 % coefi);
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunL1 = 1;
|FINSI;
|FPRC;
/__________________ K
|PROCESO carga_h7_1;
|SI Lineas [ TopeK1;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || descripcion
        #28#9 = #50#10 % coefi;    || valor
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeK1;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#5 = RelAdjunta;
            #28#9 = #28#9 + (#50#10 % coefi);
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunK1 = 1;
|FINSI;
|FPRC;
/__________________ J
|PROCESO carga_h6_5;
|SI Lineas [ TopeJ1;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || entidad
        #28#9 = #50#10 % coefi;   || valor
        #28#13 = #50#14 % coefi;  || importe anualidad
        #28#15 = #50#16;          || clave T/V
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeJ1;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#5 = RelAdjunta;
            #28#9 = #28#9 + (#50#10 % coefi);
            #28#13 = #28#13 + (#50#14 % coefi);
            #28#15 = "";
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunJ1 = 1;
|FINSI;
|FPRC;
/__________________ I
|PROCESO carga_h6_4;
|SI Lineas [ TopeI1;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || descripcion
        #28#9 = #50#10 % coefi;   || valor
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeI1;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#5 = RelAdjunta;
            #28#9 = #28#9 + (#50#10 % coefi);
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunI1 = 1;
|FINSI;
|FPRC;
/__________________ H2
|PROCESO carga_h6_3;
|SI Lineas [ TopeH2;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || descripcion
        #28#9 = #50#10 % coefi;    || valor
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeH2;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#5 = RelAdjunta;
            #28#9 = #28#9 + (#50#10 % coefi);
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunH2 = 1;
|FINSI;
|FPRC;
/__________________ H1
|PROCESO carga_h6_2;
|SI Lineas [ TopeH1;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || descripcion
        #28#9 = #50#10 % coefi;    || valor
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeH1;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#5 = RelAdjunta;
            #28#9 = #28#9 + (#50#10 % coefi);
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunH1 = 1;
|FINSI;
|FPRC;
/__________________ G4
|PROCESO carga_h6_1;
|SI Lineas [ TopeG4;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || descripcion
        #28#9 = #50#10 % coefi;   || valor
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeG4;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#5 = RelAdjunta;
            #28#9 = #28#9 + (#50#10 % coefi);
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunG4 = 1;
|FINSI;
|FPRC;
/__________________ G3
|PROCESO carga_h5_3;
|SI Lineas [ TopeG3;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || descripcion
        #28#9 = #50#10 % coefi;    || valor
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeG3;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#5 = RelAdjunta;
            #28#9 = #28#9 + (#50#10 % coefi);
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunG3 = 1;
|FINSI;
|FPRC;
/__________________ G2
|PROCESO carga_h5_2;
|SI Lineas [ TopeG2;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || descripcion
        #28#9 = #50#10 % coefi;    || valor
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeG2;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#5 = RelAdjunta;
            #28#9 = #28#9 + (#50#10 % coefi);
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunG2 = 1;
|FINSI;
|FPRC;
/__________________ G1
|PROCESO carga_h5_1;
|SI Lineas [ TopeG1;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || descripcion
        #28#9 = #50#10 % coefi;    || valor
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeG1;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#5 = RelAdjunta;
            #28#9 = #28#9 + (#50#10 % coefi);
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunG1 = 1;
|FINSI;
|FPRC;
/__________________ F2
|PROCESO carga_h4_3;
|SI Lineas [ TopeF2;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || descripcion
        #28#9 = #50#10 % coefi;   || valor
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeF2;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#5 = RelAdjunta;
            #28#9 = #28#9 + (#50#10 % coefi);
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunF2 = 1;
|FINSI;
|FPRC;
/__________________ F1
|PROCESO carga_h4_2;
|SI Lineas [ TopeF1;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || descripcion
        #28#9 = #50#10 % coefi;   || valor
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeF1;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#5 = RelAdjunta;
            #28#9 = #28#9 + (#50#10 % coefi);
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunF1 = 1;
|FINSI;
|FPRC;
/__________________ E
|PROCESO carga_h4_1;
|SI Lineas [ TopeE1;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || entidad
        #28#9 = #50#10 % coefi;   || valor
        #28#12 = #50#13;          || cuenta
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeE1;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#5 = RelAdjunta;
            #28#9 = #28#9 + (#50#10 % coefi);
            #28#12 = "";
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunE1 = 1;
|FINSI;
|FPRC;
/__________________ D
|PROCESO carga_h3_3;
|SI Lineas [ TopeD1;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || calle
        #28#6 = #50#7;            || numero
        #28#9 = #50#10 % coefi;   || valor
        #28#10 = #4#3;            || poblacion
        #28#11 = #4#2;            || provincia
        #28#16 = #50#17;          || referencia catastral
        #28#17 = #50#18;          || epigrafe
        #28#18 = #50#19;          || clave U/R
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeD1;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#5 = RelAdjunta;
            #28#6 = "";
            #28#9 = #28#9 + (#50#10 % coefi);
            #28#10 = "";
            #28#11 = "";
            #28#16 = "";
            #28#17 = "";
            #28#18 = "";
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunD1 = 1;
|FINSI;
|FPRC;
/__________________ C2
|PROCESO carga_h3_2;
|SI Lineas [ TopeC2;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || calle
        #28#6 = #50#7;            || numero
        #28#9 = #50#10 % coefi;   || valor
        #28#10 = #4#3;            || poblacion
        #28#11 = #4#2;            || provincia
        #28#14 = #50#15;          || descripcion del bien
        #28#16 = #50#17;          || referencia catastral
        #28#17 = #50#18;          || epigrafe
        #28#18 = #50#19;          || clave U/R
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeC2;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#5 = RelAdjunta;
            #28#6 = "";
            #28#9 = #28#9 + (#50#10 % coefi);
            #28#10 = "";
            #28#11 = "";
            #28#14 = "";
            #28#16 = "";
            #28#17 = "";
            #28#18 = "";
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunC2 = 1;
|FINSI;

    #70#54 = #70#54 + (#50#10 % coefi);
|FPRC;
/__________________ C1
|PROCESO carga_h3_1;
|SI Lineas [ TopeC1;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || calle
        #28#6 = #50#7;            || numero
        #28#9 = #50#10 % coefi;   || valor
        #28#10 = #4#3;            || poblacion
        #28#11 = #4#2;            || provincia
        #28#14 = #50#15;          || descripcion del bien
        #28#17 = #50#18;          || epigrafe
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeC1;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#5 = RelAdjunta;
            #28#6 = "";
            #28#9 = #28#9 + (#50#10 % coefi);
            #28#10 = "";
            #28#11 = "";
            #28#14 = "";
            #28#17 = "";
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunC1 = 1;
|FINSI;

    #70#53 = #70#53 + (#50#10 % coefi);
|FPRC;
/__________________ B
|PROCESO carga_h2_2;
|SI Lineas [ TopeB1;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || calle
        #28#6 = #50#7;            || numero
        #28#9 = #50#10 % coefi;   || valor
        #28#10 = #4#3;            || poblacion
        #28#11 = #4#2;            || provincia
        #28#15 = #50#16;          || tipo (P/N/M)
        #28#16 = #50#17;          || referencia catastral
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeB1;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#16 = RelAdjunta;
            #28#6 = "";
            #28#9 = #28#9 + (#50#10 % coefi);
            #28#10 = "";
            #28#11 = "";
            #28#15 = "";
            #28#5 = "";
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunB1 = 1;
|FINSI;
|FPRC;
/__________________ A
|PROCESO carga_h2_1;
|SI Lineas [ TopeA1;
     |SI Lineas = 1;|Y #50#22 = "N";    || la primera linea esta reservada
          Lineas = Lineas + 1;          ||/a la vivienda habitual
          |GRABA 020#28n;
     |FINSI;
        #28#2 = Lineas;           || linea
        #28#5 = #50#6;            || calle
        #28#6 = #50#7;            || numero
        #28#9 = #50#10 % coefi;   || valor
        #28#10 = #4#3;            || poblacion
        #28#11 = #4#2;            || provincia
        #28#15 = #50#16;          || tipo (P/N/M)
        #28#16 = #50#17;          || referencia catastral
        #28#18 = #50#19;          || Tipo Vivienda
    |SI Lineas = 1;|Y #50#22 = "S";     || solo la 1ra. v.habit. es exenta
            #28#19 = #50#23 % coefi;              || valor exento
            #28#20 = (#50#10 - #50#23) % coefi;   || valor no exento
            #70#56 = #28#9;                       || casilla a)
    |SINO;
            #28#19 = 0;                           || valor exento
            #28#20 = #28#9;                       || valor no exento
            #70#55 = #70#55 + (#50#10 % coefi);
    |FINSI;
    |GRABA 020#28n;
        Lineas = Lineas + 1;
|SINO;
        #28#2 = TopeA1;           || linea
    |LEE 121#28=;
    |SI FSalida = 0;
            #28#5 = RelAdjunta;
            #28#6 = "";
            #28#9 = #28#9 + (#50#10 % coefi);
            #28#10 = "";
            #28#11 = "";
            #28#15 = "";
            #28#16 = "";
            #28#18 = "";
            #28#19 = 0;
            #28#20 = 0;
            #70#55 = #70#55 + (#50#10 % coefi);
        |GRABA 020#28a;
    |FINSI;
    |LIBERA #28;
    nAdjunA1 = 1;
|FINSI;
|FPRC;
/__________________ PARA TODAS
|PROCESO CargaClave;
     |DDEFECTO #4;
     #4#0 = #50#8;
     #4#1 = #50#9;
     |LEE 000#4=;        || repoblac

     |DDEFECTO #28;
     #28#0 = #9#0;             || empresa
     #28#3 = #9#1;             || tipo
     #28#1 = #50#1;            || codigo
|FPRC;

|PROCESO Carga;
     |HAZ CargaClave;
     |SI aCodigo = "A1"; |HAZ carga_h2_1;    |FINSI;
     |SI aCodigo = "B1"; |HAZ carga_h2_2;    |FINSI;
     |SI aCodigo = "C1"; |HAZ carga_h3_1;    |FINSI;
     |SI aCodigo = "C2"; |HAZ carga_h3_2;    |FINSI;
     |SI aCodigo = "D1"; |HAZ carga_h3_3;    |FINSI;
     |SI aCodigo = "E1"; |HAZ carga_h4_1;    |FINSI;
     |SI aCodigo = "F1"; |HAZ carga_h4_2;    |FINSI;
     |SI aCodigo = "F2"; |HAZ carga_h4_3;    |FINSI;
     |SI aCodigo = "G1"; |HAZ carga_h5_1;    |FINSI;
     |SI aCodigo = "G2"; |HAZ carga_h5_2;    |FINSI;
     |SI aCodigo = "G3"; |HAZ carga_h5_3;    |FINSI;
     |SI aCodigo = "G4"; |HAZ carga_h6_1;    |FINSI;
     |SI aCodigo = "H1"; |HAZ carga_h6_2;    |FINSI;
     |SI aCodigo = "H2"; |HAZ carga_h6_3;    |FINSI;
     |SI aCodigo = "I1"; |HAZ carga_h6_4;    |FINSI;
     |SI aCodigo = "J1"; |HAZ carga_h6_5;    |FINSI;
     |SI aCodigo = "K1"; |HAZ carga_h7_1;    |FINSI;
     |SI aCodigo = "L1"; |HAZ carga_h7_2;    |FINSI;
     |SI aCodigo = "M1"; |HAZ carga_h7_3;    |FINSI;
     |SI aCodigo = "N1"; |HAZ carga_h7_4;    |FINSI;
     |SI aCodigo = "O1"; |HAZ carga_h8_1;    |FINSI;
     |SI aCodigo = "P1"; |HAZ carga_h8_2;    |FINSI;
     |SI aCodigo = "Q1"; |HAZ carga_h8_3;    |FINSI;
     |SI aCodigo = "U1"; |HAZ carga_h8_4;    |FINSI;
|FPRC;

|PROCESO rem00099_1;
     |SI #50#10 = 0; |ACABA;   |FINSI;       || valor igual a cero

     coefi = 0;

     Comodin = #rem00099#3;   |QBF Comodin;
     |SI #9#1 = "T";
          |SI Comodin = "TITULAR";      coefi = 100;             |FINSI;
          |SI Comodin = "GANANCIAL";    coefi = 50;              |FINSI;
          |SI Comodin = "VARIOS";       coefi = #rem00099#20;    |FINSI;
     |FINSI;
     |SI #9#1 = "C";
          |SI Comodin = "CONYUGE";      coefi = 100;             |FINSI;
          |SI Comodin = "GANANCIAL";    coefi = 50;              |FINSI;
          |SI Comodin = "VARIOS";       coefi = #rem00099#21;    |FINSI;
     |FINSI;

     |SI coefi ! 0;
          |HAZ Carga;
     |FINSI;
|FPRC;

|DEFBUCLE rem00099_a1;        || para el A1 ordena por vivienda habitual
     #rem00099#3;             ||/para que la primera sea esa
     ;
     #rew00001#0, aCodigo, "S";         || el campo 22 es clave inversa
     #rew00001#0, aCodigo, "N";
     ;
     NULL, rem00099_1;
|FIN;

|DEFBUCLE rem00099;
     #rem00099#1;
     ;
     #rew00001#0, aCodigo,   1;
     #rew00001#0, aCodigo, 999;
     ;
     NULL, rem00099_1;
|FIN;

|PROCESO Graba_28;
     Lineas = 1;    aCodigo = "A1";     nAdjunA1 = 0;  |BUCLE rem00099_a1;
     Lineas = 1;    aCodigo = "B1";     nAdjunB1 = 0;  |BUCLE rem00099;
     Lineas = 1;    aCodigo = "C1";     nAdjunC1 = 0;  |BUCLE rem00099;
     Lineas = 1;    aCodigo = "C2";     nAdjunC2 = 0;  |BUCLE rem00099;
     Lineas = 1;    aCodigo = "D1";     nAdjunD1 = 0;  |BUCLE rem00099;
     Lineas = 1;    aCodigo = "E1";     nAdjunE1 = 0;  |BUCLE rem00099;
     Lineas = 1;    aCodigo = "F1";     nAdjunF1 = 0;  |BUCLE rem00099;
     Lineas = 1;    aCodigo = "F2";     nAdjunF2 = 0;  |BUCLE rem00099;
     Lineas = 1;    aCodigo = "G1";     nAdjunG1 = 0;  |BUCLE rem00099;
     Lineas = 1;    aCodigo = "G2";     nAdjunG2 = 0;  |BUCLE rem00099;
     Lineas = 1;    aCodigo = "G3";     nAdjunG3 = 0;  |BUCLE rem00099;
     Lineas = 1;    aCodigo = "G4";     nAdjunG4 = 0;  |BUCLE rem00099;
     Lineas = 1;    aCodigo = "H1";     nAdjunH1 = 0;  |BUCLE rem00099;
     Lineas = 1;    aCodigo = "H2";     nAdjunH2 = 0;  |BUCLE rem00099;
     Lineas = 1;    aCodigo = "I1";     nAdjunI1 = 0;  |BUCLE rem00099;
     Lineas = 1;    aCodigo = "J1";     nAdjunJ1 = 0;  |BUCLE rem00099;
     Lineas = 1;    aCodigo = "K1";     nAdjunK1 = 0;  |BUCLE rem00099;
     Lineas = 1;    aCodigo = "L1";     nAdjunL1 = 0;  |BUCLE rem00099;
     Lineas = 1;    aCodigo = "M1";     nAdjunM1 = 0;  |BUCLE rem00099;
     Lineas = 1;    aCodigo = "N1";     nAdjunN1 = 0;  |BUCLE rem00099;
     Lineas = 1;    aCodigo = "O1";     nAdjunO1 = 0;  |BUCLE rem00099;
     Lineas = 1;    aCodigo = "P1";     nAdjunP1 = 0;  |BUCLE rem00099;
     Lineas = 1;    aCodigo = "Q1";     nAdjunQ1 = 0;  |BUCLE rem00099;
     Lineas = 1;    aCodigo = "U1";     nAdjunU1 = 0;  |BUCLE rem00099;
|FPRC;

____________________________________/ GRABACION DE LA HOJA 01
|PROCESO Graba_27;
    |DDEFECTO #27;
    #27#0 = #9#0;        || codigo
    #27#1 = #9#1;        || tipo
    #27#2 = nombre;      || nombre completo
    #27#3 = opta;        || opta oblig. personal
    #27#4 = "";
    |SI #0#51 = "S";
        #27#4 = (("0" * 20) + ("00000" + #9#0) % -105) % -120;
    |FINSI;
    #27#5 = cpadm;       || cod.admon
    #27#6 = habit;       || residencia habitual
    #27#7 = dnicif;      || nif
    #27#8 = Cadena1 + " " + Cadena2;         || apellidos
    #27#9 = Cadena3;                         || nombre
    #27#10 = #1#14;      || SG
    #27#11 = #1#15;      || calle
    #27#12 = #1#16;      || numero
    alfa1 = #1#17; |QBF alfa1; alfa1 = (alfa1 + "  ") % 102;
    #27#13 = alfa1;      || escalera
    alfa1 = #1#18; |QBF alfa1; alfa1 = (alfa1 + "  ") % 102;
    #27#14 = alfa1;      || piso
    alfa1 = #1#19; |QBF alfa1; alfa1 = (alfa1 + "  ") % 102;
    #27#15 = alfa1;      || puerta
    nNume1 = #1#12;
    |SI nNume1 = 0; #27#16 = "000000000"; |SINO; #27#16 = #1#12; |FINSI;
                         || telefono
    #27#17 = #1#22;      || municipio
    #27#18 = #4#2;       || provincia
    aAlfa  = (("00" + #1#20) % -102) + (("000" + #1#21) % -103) ; || codigo postal
    #27#19 = aAlfa;
    #27#20 = #3#2;       || nif (repres.)
    #27#21 = #3#1;       || nombre (repres.)
    #27#22 = "";         || SG (repres.)
    #27#23 = #3#3;       || calle (repres.)
    #27#24 = #3#4;       || numero (repres.)
    #27#25 = "";         || escalera (repres.)
    #27#26 = "";         || piso (repres.)
    #27#27 = "";         || puerta (repres.)
    nNume1 = #3#9;
    |SI nNume1 = 0; #27#28 = "000000000"; |SINO; #27#28 = #3#9; |FINSI;
                         || telefono (repres.)
    #27#29 = #3#7;       || municipio (repres.)
    #27#30 = #3#8;       || provincia (repres.)
    #27#31 = cprep;      || codigo postal (repres.)
    #27#32 = regim;      || regimen economico
    |SI habit = " ";
       #27#33 = #5#3;       || codigo comunidad
    |SINO;
       #27#33 = "00";
    |FINSI;
    #27#34 = "";         || declaracion complementaria
    #27#35 = &13 + &10;  || CRLF
    |GRABA 020#27n;
|FPRC;

|PROCESO LeeFich;
|DDEFECTO #2;  #2#0 = #1#69;  #2#1 = #1#70;  |LEE 000#2=;   || rehacien
|DDEFECTO #3;  #3#0 = #1#65;                 |LEE 000#3=;   || rerenpre
|DDEFECTO #4;  #4#0 = #1#20;  #4#1 = #1#21;  |LEE 000#4=;   || repoblac
|DDEFECTO #5;  #5#0 = #1#20;                 |LEE 000#5=;   || recofisc
|DDEFECTO #70; #70#0 = #9#0; #70#28 = #9#1;  |LEE 000#70=;  || retotpat

    #70#53 = 0;          || subtotal C1, se calcula aqui, en la impresion
    #70#54 = 0;          || subtotal C2, se calcula aqui, en la impresion
    #70#55 = 0;          || subtotal A2, casilla d), se calcula aqui, en la impresion
    #70#56 = 0;          || subtotal A1, casilla a), se calcula aqui, en la impresion
|FPRC;

|PROCESO CamposCalculados;
|HAZ LeeFich;

    nombre = "";
    dnicif = "";
    cuenta = "";
    apell1 = "";
    apell2 = "";
    nompil = "";
|SI #9#1 = "T";
     nombre = #1#5;      || nombre completo
     dnicif = #1#1;      || dni
     cuenta = #1#53;     || cta.cte.
     apell1 = #1#2;      || apellido 1
     apell2 = #1#3;      || apellido 2
     nompil = #1#4;      || nombre
|FINSI;

|SI #9#1 = "C";
     nombre = #1#39;     || nombre completo
     dnicif = #1#35;     || dni
     cuenta = #1#54;     || cta.cte.
     apell1 = #1#36;     || apellido 1
     apell2 = #1#37;     || apellido 2
     nompil = #1#38;     || nombre
|FINSI;

    alfa1 = #1#69;  alfa1 = ("00"  + alfa1) % -102;
    alfa2 = #1#70;  alfa2 = ("000" + alfa2) % -103;
    cpadm = alfa1 + alfa2;                             || cod.administracion

    alfa1 = #3#5;   alfa1 = ("00"  + alfa1) % -102;
    alfa2 = #3#6;   alfa2 = ("000" + alfa2) % -103;
    cprep = alfa1 + alfa2;                             || cod.representante

|SI #1#93 = "G";    regim = "3";   |FINSI;
|SI #1#93 = "S";    regim = "4";   |FINSI;        || regimen economico
|SI #1#93 = "O";    regim = "5";   |FINSI;

|SI #1#94 = "N";    habit = " ";   |FINSI;
|SI #1#94 = "S";    habit = "X";   |FINSI;        || reside en extranjero

|SI #1#99 = "S";    opta = "X";    |FINSI;        || no residente
|SI #1#99 = "N";    opta = " ";    |FINSI;        ||/con tributacion

    Cadena1 = apell1;    || apellido 1
    Cadena2 = apell2;    || apellido 2
    Cadena3 = nompil;    || nombre
|FPRC;

____________________________________/ GRABACION DE TEMPORALES
|PROCESO Prepara;
    #6#0 = #9#0;    |PINTA #6#0;        || pinta codigo
    #6#1 = #9#3;    |PINTA #6#1;        || pinta nombre
    #6#3 = 0;       |PINTA #6#3;        || pinta copia (cero)

|HAZ CamposCalculados;
|HAZ Graba_27;           || hoja 01
|HAZ Graba_28;           || hoja 02-08
|HAZ Graba_29;           || hoja 09
|HAZ Graba_30;           || hoja 10
|HAZ Graba_31;           || hoja Ing./Dev.
|FPRC;
____________________________________/
/*
|PROCESO GrabaImpreso;
     |ABRE #rem01001;
     #rem01001#0 = #1#0;
     #rem01001#1 = 00;
     |SI #9#1 = "T";     #rem01001#2 = "ZPATRITIT";    |FINSI;
     |SI #9#1 = "C";     #rem01001#2 = "ZPATRICON";    |FINSI;
     |LEE 121#rem01001.=;
     |SI FSalida = 0;
          #rem01001#6 = "S";       || impreso SI
          |GRABA 020#rem01001.a;
     |FINSI;
     |LIBERA #rem01001;
     |CIERRA #rem01001;

     enEmpresa     = #rem01001#0;
     enTipoEntrada = 99;
     |SUB_EJECUTA_NP "reacceso";
|FPRC;
*/

|PROCESO lee_punteo;
    #1#0 = #9#0;
|LEE 000#1=;                            || lee contribuyente
|SI FSalida = 0;
    |ATRI P;   |PINTA 1111, "Preparando ";   |ATRI 0;
    |HAZ Prepara;        || graba temporales
    |ATRI P;   |PINTA 1111, "Imprimiendo";   |ATRI 0;
    |HAZ Imprime;        || imprime en oficial o en laser
    ||HAZ GrabaImpreso;   || graba impreso SI en el contribuyente
|SINO;
        alfa1 = "    Contribuyente [" + #9#0 + "] inaccesible o inexistente ...";
    |MENAV alfa1;
|FINSI;
|FPRC;

|DEFBUCLE rew00001;
 #9#1;
 5;
     0, " ", "S";        || codigo, tipo, punteado SI
 99999, "z", "S";
 be;
 NULL, lee_punteo;
|FIN;

|PROCESO funcion1; |TIPO 11;
|SI FSalida ! 9; |ACABA; |FINSI;      || punteado de lineas

|SI #9#5 = "S";
        #9#5 = "N";
|SINO;
        #9#5 = "S";
|FINSI;
|PINTA #9#5;
|GRABA 020#9a;
|FPRC;

|RUTINA inferior;
    #9#0 = 1;
    #9#1 = " ";
|FRUT;

|RUTINA superior;
    #9#0 = 99999;
    #9#1 = "z";
|FRUT;

|PROCESO rem01002_1;
     |SI #rem01002#6 = 0;     |ACABA;   |FINSI;

     |SI #rem01002#3 = 1;
          |SI #rem01002#4 = " 01";      || A1
               #rew00103#1 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 2;
          |SI #rem01002#4 = " 02";      || B1
               #rew00103#2 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 3;
          |SI #rem01002#4 = " 03";      || C1
               #rew00103#3 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 4;
          |SI #rem01002#4 = " 05";      || D1
               #rew00103#4 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 5;
          |SI #rem01002#4 = " 06";      || F1
               #rew00103#5 = #rem01002#6;
          |FINSI;
          |SI #rem01002#4 = " 07";      || F2
               #rew00103#6 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 6;
          |SI #rem01002#4 = " 08";      || G1
               #rew00103#7 = #rem01002#6;
          |FINSI;
          |SI #rem01002#4 = " 09";      || G2
               #rew00103#8 = #rem01002#6;
          |FINSI;
          |SI #rem01002#4 = " 10";      || G3
               #rew00103#44 = #rem01002#6;
          |FINSI;
          |SI #rem01002#4 = " 11";      || G4
               #rew00103#45 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 7;
          |SI #rem01002#4 = " 14";      || I1
               #rew00103#9 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 8;
          |SI #rem01002#4 = " 15";      || J1
               #rew00103#10 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 9;
          |SI #rem01002#4 = " 16";      || K1
               #rew00103#11 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 10;
          |SI #rem01002#4 = " 17";      || L1
               #rew00103#12 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 11;
          |SI #rem01002#4 = " 18";      || M1
               #rew00103#13 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 12;
          |SI #rem01002#4 = " 19";      || N1
               #rew00103#14 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 13;
          |SI #rem01002#4 = " 20";      || O1
               #rew00103#15 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 14;
          |SI #rem01002#4 = " 21";      || P1
               #rew00103#16 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 15;
          |SI #rem01002#4 = " 22";      || Q1
               #rew00103#17 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 16;
          |SI #rem01002#4 = " 23";      || TOTAL BIENES Y DERECHOS
               #rew00103#18 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 17;
          |SI #rem01002#4 = " 24";      || DEUDAS
               #rew00103#19 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 18;
          |SI #rem01002#4 = " 25";      || BASE IMPONIBLE
               #rew00103#20 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 19;
          |SI #rem01002#4 = " 26";      || REDUCCION 17300000
               #rew00103#21 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 20;
          |SI #rem01002#4 = " 27";      || BASE LIQUIDABLE
               #rew00103#22 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 21;
          |SI #rem01002#4 = " 04";      || D1
               #rew00103#46 = #rem01002#6;
          |FINSI;
          |SI #rem01002#4 = " 12";      || H1
               #rew00103#47 = #rem01002#6;
          |FINSI;
          |SI #rem01002#4 = " 13";      || H2
               #rew00103#48 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 22;
          |SI #rem01002#4 = " 01";      || BASE LIQUIDABLE
               || es la misma cantidad que la casilla 27
          |FINSI;
          |SI #rem01002#4 = " 02";      || HASTA
               #rew00103#24 = #rem01002#6;
          |FINSI;
          |SI #rem01002#4 = " 03";      || TOTAL HASTA
               #rew00103#29 = #rem01002#6;
          |FINSI;
          |SI #rem01002#4 = " 04";      || RESTO
               #rew00103#25 = #rem01002#6;
          |FINSI;
          |SI #rem01002#4 = " 05";      || PORCENTAJE
               #rew00103#26 = #rem01002#6;
          |FINSI;
          |SI #rem01002#4 = " 06";      || TOTAL RESTO
               #rew00103#27 = #rem01002#6;
          |FINSI;
          |SI #rem01002#4 = " 07";      || SUMA
               || campo no definido
          |FINSI;
          |SI #rem01002#4 = " 28";      || CUOTA INTEGRA 28
               #rew00103#23 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 23;
          |SI #rem01002#4 = " 29";      || CUOTA INTEGRA 29
               #rew00103#30 = #rem01002#6;
          |FINSI;
          |SI #rem01002#4 = " 30";      || PARTE DE LA CUOTA
               #rew00103#31 = #rem01002#6;
          |FINSI;
          |SI #rem01002#4 = " 31";      || SUMA DE CUOTAS
               #rew00103#32 = #rem01002#6;
          |FINSI;
          |SI #rem01002#4 = " 32";      || LIMITE CONJUNTO
               #rew00103#33 = #rem01002#6;
          |FINSI;
          |SI #rem01002#4 = " 33";      || EXCESO
               #rew00103#34 = #rem01002#6;
          |FINSI;
          |SI #rem01002#4 = " 34";      || 80% CUOTA INTEGRA
               #rew00103#35 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 24;
          |SI #rem01002#4 = " 35";      || TOTAL CUOTA INTEGRA
               #rew00103#36 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 25;
          |SI #rem01002#4 = "TM ";      || TIPO MEDIO GRAVAMEN
               nNume1 = #rem01002#6 * 100;
               #rew00103#49 = (nNume1 - (nNume1 $ 100)) / 100;   || entero
               #rew00103#50 = nNume1 $ 100;                      || decimal
          |FINSI;
          |SI #rem01002#4 = "a  ";      || IMPUESTOS EFEC. a)
               #rew00103#42 = #rem01002#6;
          |FINSI;
          |SI #rem01002#4 = "b  ";      || PARTE BASE b)
               #rew00103#43 = #rem01002#6;
          |FINSI;
          |SI #rem01002#4 = "z36";      || IMPORTE DEDUCCION
               #rew00103#37 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 26;
          |SI #rem01002#4 = " 37";      || VALOR NETO
               #rew00103#38 = #rem01002#6;
          |FINSI;
          |SI #rem01002#4 = " 38";      || PARTE DE CUOTA
               #rew00103#39 = #rem01002#6;
          |FINSI;
          |SI #rem01002#4 = " 39";      || BONIFICACION 50%
               #rew00103#40 = #rem01002#6;
          |FINSI;
     |FINSI;
     |SI #rem01002#3 = 27;
          |SI #rem01002#4 = " 40";      || CUOTA A INGRESAR
               #rew00103#41 = #rem01002#6;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE rem01002;
     #rem01002#1;
     ;
     #rem01001#0, #rem01001#1, #rem01001#2, 00, "   ";
     #rem01001#0, #rem01001#1, #rem01001#2, 99, "zzz";
     ;
     NULL, rem01002_1;
|FIN;

|PROCESO ImagenRetotpat;
     |DDEFECTO #rew00103;
     #rew00103#0 = #1#0;      || codigo
     #rew00103#28 = #9#1;     || tipo

     |BUCLE rem01002;

     nNume1 = #rew00103#26 * 100;
     #rew00103#51 = (nNume1 - (nNume1 $ 100)) / 100;   || parte entera %C.I.
     #rew00103#52 = nNume1 $ 100;                      || parte decimal %C.I.

     |GRABA 020#rew00103.n;
|FPRC;

|PROCESO graba_punteo;
     #rem01001#0 = #1#0;
     #rem01001#1 = 00;
     #rem01001#2 = "ZPATRITIT";
     |LEE 000#rem01001.=;
     |SI FSalida = 0;|Y #rem01001#5 = "714";|Y #rem01001#6 = #0#36;
          #9#0 = #1#0;
          #9#1 = "T";
          #9#2 = "TITULAR";
          #9#3 = #1#5;
          #9#4 = #0#37;
          #9#5 = "N";
          |SI nSwTodos = 0;   #9#5 = "S";    |FINSI;
          #9#6 = 1;
          |GRABA 020#9n;
          |SI FSalida = 0;    x = 1;    |HAZ ImagenRetotpat;     |FINSI;
     |FINSI;

     #rem01001#0 = #1#0;
     #rem01001#1 = 00;
     #rem01001#2 = "ZPATRICON";
     |LEE 000#rem01001.=;
     |SI FSalida = 0;|Y #rem01001#5 = "714";|Y #rem01001#6 = #0#36;
          #9#0 = #1#0;
          #9#1 = "C";
          #9#2 = "CONYUGE";
          #9#3 = #1#39;
          #9#4 = #0#37;
          #9#5 = "N";
          |SI nSwTodos = 0;   #9#5 = "S";    |FINSI;
          #9#6 = 1;
          |GRABA 020#9n;
          |SI FSalida = 0;    x = 1;    |HAZ ImagenRetotpat;     |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE rem00100;
 #1#1;
 ;
 d_empre;
 h_empre;
 ;
 NULL, graba_punteo;
|FIN;

|PROCESO TopesAdjunta;
  || no son los mismos topes para la relacion adjunta en laser que en papel!
  || por defecto vienen cargados los de laser

    TopeA1 = 25;
    TopeB1 = 24;
    TopeC1 = 17;
    TopeC2 = 11;
    TopeD1 = 16;
    TopeE1 = 22;
    TopeF1 = 16;
    TopeF2 = 8;
    TopeG1 = 14;
    TopeG2 = 26;
    TopeG3 = 8;
    TopeG4 = 18;
    TopeH1 = 3;
    TopeH2 = 3;
    TopeI1 = 5;
    TopeJ1 = 5;
    TopeK1 = 13;
    TopeL1 = 12;
    TopeM1 = 13;
    TopeN1 = 3;
    TopeO1 = 4;
    TopeP1 = 3;
    TopeQ1 = 16;
    TopeU1 = 17;
|FPRC;

|PROCESO LaFecha;
    fech1 = #0#33 % 2;
    alfa1 = fech1;
    FechaInf = alfa1 % 11;

    alfa1 = #0#33;
    alfa2 = alfa1 % 102;      Dia = alfa2;
    alfa2 = alfa1 % -101;     Any = alfa2;
    alfa2 = alfa1 % 402;
|SI alfa2 = "01";   Mes = "Enero     "; |FINSI;
|SI alfa2 = "02";   Mes = "Febrero   "; |FINSI;
|SI alfa2 = "03";   Mes = "Marzo     "; |FINSI;
|SI alfa2 = "04";   Mes = "Abril     "; |FINSI;
|SI alfa2 = "05";   Mes = "Mayo      "; |FINSI;
|SI alfa2 = "06";   Mes = "Junio     "; |FINSI;
|SI alfa2 = "07";   Mes = "Julio     "; |FINSI;
|SI alfa2 = "08";   Mes = "Agosto    "; |FINSI;
|SI alfa2 = "09";   Mes = "Septiembre"; |FINSI;
|SI alfa2 = "10";   Mes = "Octubre   "; |FINSI;
|SI alfa2 = "11";   Mes = "Noviembre "; |FINSI;
|SI alfa2 = "12";   Mes = "Diciembre "; |FINSI;

    Mes = Mes > Mes;
    LFecha = "";
    alfa1 = #0#33;
    alfa2 = alfa1 % 102;      LFecha = alfa2;
    alfa2 = alfa1 % 402;      LFecha = LFecha + "/" + alfa2;
    alfa2 = alfa1 % -104;     LFecha = LFecha + "/" + alfa2;

    alfa1 = #0#33;
    LFecDi = alfa1 % 102;
    LFecMe = Mes;
    LFecAn = alfa1 % -104;
|FPRC;

|PROCESO MiraLiqui;
     |SI #71#5 ! "714";
         |ACABA;
     |FINSI;

     #71#6 = "N";

     aFichero  = "pa" + (("0000" + #9#0) % -105) + #9#1 + ".txt";
     aFichero  = "C:/MODELOS/RENTA/714/" + aFichero;
     |XABRE "EC", aFichero, nCanal;
     |SI FSalida < 0;
         #71#6 = "S";
     |FINSI;
     |GRABA 020#71a;
     |LIBERA #71;
|FPRC;

|DEFBUCLE rem01001;
     #71#1;
     ;
     #9#0, 00, "          ";
     #9#0, 99, "zzzzzzzzzz";
     be;
     NULL, MiraLiqui;
|FIN;

|PROCESO Grabalos;
     |BUCLE rem01001;

     enEmpresa     = #9#0;
     enTipoEntrada = 99;
     |SUB_EJECUTA_NP "reacceso";
|FPRC;

|DEFBUCLE rew00001G;
     #9#1;
     5;
         0, " ", "S";        || codigo, tipo, punteado SI
     99999, "z", "S";
     ;
     NULL, Grabalos;
|FIN;

|PROCESO tipo3; |TIPO 3;
    eaTipoEmi = "L";
|SI #0#49 = "O";
    |IMPRE 0;
    |SI FSalida ! 0;
        |MENAV "    Proceso abortado ...";
        |ACABA;
    |FINSI;

    |MENU hojas;
        papel = FSalida;
    |SI papel ! 1;|Y papel ! 2;    |ACABA;   |FINSI;
    |SI papel = 1;  TMaxi = 72;    |FINSI;             || tope lineas cont.
    |SI papel = 2;  TMaxi = 70;    |FINSI;             || tope lineas hoja

    |HAZ TopesAdjunta;
|FINSI;

|HAZ LaFecha;

|SI #0#35 = "S";
    |CONFI "0000SMarcar todos: ";
        nSwTodos = FSalida;
|SINO;
        nSwTodos = 0;
|FINSI;

    comienza = "09";  |HAZ fichero;  |NOME_DAT #9 fichero;  |DELINDEX #9;
    comienza = "70";  |HAZ fichero;  |NOME_DAT #70 fichero; |DELINDEX #70;
|ABRE #rew00001;
|ABRE #rew00103;
|ABRE #rem01001;
    x = 0;
|SI #0#0 = "S";
        d_empre = #0#1;
        h_empre = #0#2;
    |BUCLE rem00100;
|SINO;
    |PARA Salteada = 3; |SI Salteada [ 32; |HACIENDO Salteada = Salteada + 1;
        |SI #0Salteada ! 0;
                d_empre = #0Salteada;
                h_empre = #0Salteada;
            |BUCLE rem00100;
        |FINSI;
    |SIGUE;
|FINSI;
|CIERRA #rew00001;
|CIERRA #rem01001;
|CIERRA #rew00103;

|SI x = 0;
    |MENAV "    Seleccion vacia ...";
    |FINIMP;
    |DELINDEX #rew00001;
    |DELINDEX #rew00103;
    |ACABA;
|FINSI;

|SI #0#35 = "S";                                  || punteado de patrimonios
    |PUSHV 0501 2380;
    |ENTLINEAL #1#9, -1, 4, 19, 1, inferior, superior;
    |POPV;
|FINSI;

    comienza = "27";  |HAZ fichero;  |NOME_DAT #27 fichero; |DELINDEX #27;
    comienza = "28";  |HAZ fichero;  |NOME_DAT #28 fichero; |DELINDEX #28;
    comienza = "29";  |HAZ fichero;  |NOME_DAT #29 fichero; |DELINDEX #29;
    comienza = "30";  |HAZ fichero;  |NOME_DAT #30 fichero; |DELINDEX #30;
    comienza = "31";  |HAZ fichero;  |NOME_DAT #31 fichero; |DELINDEX #31;

|PINPA #0#6;
|PINTA 1111, "           ";
|ABRE #1;           || rem00100
|ABRE #2;           || rehacien
|ABRE #3;           || rerenpre
|ABRE #4;           || repoblac
|ABRE #5;           || recofisc
|ABRE #27;          || rew00027 (hoja 01)
|ABRE #28;          || rew00028 (hoja 02-08)
|ABRE #29;          || rew00029 (hoja 09)
|ABRE #30;          || rew00030 (hoja 10)
|ABRE #31;          || rew00031 (hoja ing./dev.)
|ABRE #70;          || rew00103 (retotpat_98)
|BUCLE rew00001;
|CIERRA #1;
|CIERRA #2;
|CIERRA #3;
|CIERRA #4;
|CIERRA #5;
|CIERRA #27;
|CIERRA #28;
|CIERRA #29;
|CIERRA #30;
|CIERRA #31;
|CIERRA #70;

|FINIMP;

|SI NCopia ! 0;
        alfa1 = "    Procesado(s) [" + NCopia + "] patrimonio(s) ...";
    |MENAV alfa1;
    |SI #0#49 = "L";
        eaTipoSec = "714";
        |HAZ CopiaDisco;
    |FINSI;
|SINO;
    |MENAV "    Seleccion vacia ...";
|FINSI;

|BUCLE rew00001G;

|DELINDEX #9;
|DELINDEX #27;
|DELINDEX #28;
|DELINDEX #29;
|DELINDEX #30;
|DELINDEX #31;
|DELINDEX #70;
|FPRC;
