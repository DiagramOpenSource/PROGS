|FICHEROS;
     dsarm055;
|FIN;

|VARIABLES;
     aDirVistas       = "";
     aDN1             = "";
     aDN2             = "";
     aDN3             = "";
     aDN4             = "";
     aDN5             = "";
     aHN1             = "";
     aHN2             = "";
     aHN3             = "";
     aHN4             = "";
     aHN5             = "";
     aDOrd            = "";
     aHOrd            = "";
     aDNIF            = "";
     aHNIF            = "";
     aDDespanet       = "";
     aHDespanet       = "";
     aDFecha          = "";
     aHFecha          = "";
     aTria            = "";

     nParametro       = 0;
     nDEmpresa        = 0;
     nHEmpresa        = 0;
     nTDocumentos     = 0;

     &enReal          = 0;
     &enTemporal      = 0;
|FIN;

|| ***********************************************************************
||                    VISTAS TEMPORAL DESDE EL DSARM005
|| ***********************************************************************

|PROCESO dsarm005_0;
    |SI nFichero = 905;
         |PARA nCampo = 0;  |SI nCampo [ enNumCampos;  |HACIENDO nCampo = nCampo + 1;
               #dsarm005#nCampo# = #dsarm005@#nCampo#;
         |SIGUE;
    |FINSI;

    |SI nSwModoEnvio = 1;
        |SI aTria = "P";
             |SI #dsarm005#82 = "N";      ||Enviado Correcto = "N"
                  |HAZ EnviaUno;
             |FINSI;
        |SINO;
             |HAZ EnviaUno;
        |FINSI;
    |SINO;
        enReal = 0;
        |HAZ GrabaVistas;
    |FINSI;
|FPRC;

|DEFBUCLE dsarm005_0_7;
     #dsarm005#7;
     ;
     "S", #801#0, aDFecha, 000000001;
     "S", #801#0, aHFecha, 999999999;
     ;
     NULL, dsarm005_0;
|FIN;

|DEFBUCLE dsarm005_0_8;
     #dsarm005#8;
     ;
     aDFecha, "     ", 000000001;
     aHFecha, "zzzzz", 999999999;
     ;
     NULL, dsarm005_0;
|FIN;

|DEFBUCLE dsarm005_905_7;
     #dsarm005@#7004;
     ;
     "S", #801#0, aDFecha, 000000001;
     "S", #801#0, aHFecha, 999999999;
     ;
     NULL, dsarm005_0;
|FIN;

|DEFBUCLE dsarm005_905_8;
     #dsarm005@#8003;
     ;
     aDFecha, "     ", 000000001;
     aHFecha, "zzzzz", 999999999;
     ;
     NULL, dsarm005_0;
|FIN;

|DEFBUCLE dsarm005_905_1;
     #dsarm005@#1001;
     ;
     000000001;
     999999999;
     ;
     NULL, dsarm005_0;
|FIN;

|DEFBUCLE dsarm005_0_3;
     #dsarm005#3;
     ;
     nParametro, aDFecha, "     ", 000000001;
     nParametro, aHFecha, "zzzzz", 999999999;
     ;
     NULL, dsarm005_0;
|FIN;

|DEFBUCLE dsarm005_905_3;
     #dsarm005@#3004;
     ;
     nParametro, aDFecha, "     ", 000000001;
     nParametro, aHFecha, "zzzzz", 999999999;
     ;
     NULL, dsarm005_0;
|FIN;

|DEFBUCLE dsarm005_0_4;
     #dsarm005#4;
     ;
     aParametro, aDFecha, "     ", 000000001;
     aParametro, aHFecha, "zzzzz", 999999999;
     ;
     NULL, dsarm005_0;
|FIN;

|DEFBUCLE dsarm005_905_4;
     #dsarm005@#4004;
     ;
     aParametro, aDFecha, "     ", 000000001;
     aParametro, aHFecha, "zzzzz", 999999999;
     ;
     NULL, dsarm005_0;
|FIN;

|PROCESO CargaArbol;
     |QBF aAlfa;
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO DameDetalle;
     aAux = #8#14;  |QBF aAux;
     |SI aAux = "";
         aDetalle = "Documento: " + (("000000000" + #917#0) % -109);
         |ACABA;
     |FINSI;

     |SI #8#12 = "1";
         aDetalle = "";
         |SI #8#23 = "S";
             aDetalle = #8#14;  |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |FINSI;

         aBeta = #917#6 % 190;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;
     |FINSI;

     |SI #8#12 = "2";
         aDetalle = "";
         |SI #8#23 = "S";
             aDetalle = #8#14;  |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |FINSI;

         aBeta    = #917#6 % 160;  |QBF aBeta;
         aDetalle = aDetalle + aBeta;

         |SI #8#24 = "S";
             |SI aDetalle = "";
                 aDetalle = #8#16;
             |SINO;
                 aDetalle = aDetalle + " " + #8#16;
             |FINSI;
             |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |SINO;
             aDetalle = aDetalle + " / ";
         |FINSI;

         aBeta = #917#7 % 160;
         aDetalle = aDetalle + aBeta;
     |FINSI;

     |SI #8#12 = "3";
         aDetalle = "";
         |SI #8#23 = "S";
             aDetalle = #8#14;  |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |FINSI;

         aBeta = #917#6 % 140;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;

         |SI #8#24 = "S";
             |SI aDetalle = "";
                 aDetalle = #8#16;
             |SINO;
                 aDetalle = aDetalle + " " + #8#16;
             |FINSI;
             |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |SINO;
             aDetalle = aDetalle + " / ";
         |FINSI;

         aBeta = #917#7 % 140;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;

         |SI #8#25 = "S";
             |SI aDetalle = "";
                 aDetalle = #8#18;
             |SINO;
                 aDetalle = aDetalle + " " + #8#18;
             |FINSI;
             |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |SINO;
             aDetalle = aDetalle + " / ";
         |FINSI;

         aBeta = #917#8 % 140;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;
     |FINSI;

     |SI #8#12 = "4";
         aDetalle = "";
         |SI #8#23 = "S";
             aDetalle = #8#14;  |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |FINSI;

         aBeta = #917#6 % 130;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;

         |SI #8#24 = "S";
             |SI aDetalle = "";
                 aDetalle = #8#16;
             |SINO;
                 aDetalle = aDetalle + " " + #8#16;
             |FINSI;
             |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |SINO;
             aDetalle = aDetalle + " / ";
         |FINSI;

         aBeta = #917#7 % 130;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;

         |SI #8#25 = "S";
             |SI aDetalle = "";
                 aDetalle = #8#18;
             |SINO;
                 aDetalle = aDetalle + " " + #8#18;
             |FINSI;
             |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |SINO;
             aDetalle = aDetalle + " / ";
         |FINSI;

         aBeta = #917#8 % 130;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;

         |SI #8#26 = "S";
             |SI aDetalle = "";
                 aDetalle = #8#20;
             |SINO;
                 aDetalle = aDetalle + " " + #8#20;
             |FINSI;
             |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |SINO;
             aDetalle = aDetalle + " / ";
         |FINSI;

         aBeta = #917#9 % 130;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;
     |FINSI;

     |SI #8#12 = "5";
         aDetalle = "";
         |SI #8#23 = "S";
             aDetalle = #8#14;  |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |FINSI;

         aBeta = #917#6 % 130;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;

         |SI #8#24 = "S";
             |SI aDetalle = "";
                 aDetalle = #8#16;
             |SINO;
                 aDetalle = aDetalle + " " + #8#16;
             |FINSI;
             |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |SINO;
             aDetalle = aDetalle + " / ";
         |FINSI;

         aBeta = #917#7 % 130;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;

         |SI #8#25 = "S";
             |SI aDetalle = "";
                 aDetalle = #8#18;
             |SINO;
                 aDetalle = aDetalle + " " + #8#18;
             |FINSI;
             |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |SINO;
             aDetalle = aDetalle + " / ";
         |FINSI;

         aBeta = #917#8 % 130;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;

         |SI #8#26 = "S";
             |SI aDetalle = "";
                 aDetalle = #8#20;
             |SINO;
                 aDetalle = aDetalle + " " + #8#20;
             |FINSI;
             |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |SINO;
             aDetalle = aDetalle + " / ";
         |FINSI;

         aBeta = #917#9 % 130;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;

         |SI #8#27 = "S";
             |SI aDetalle = "";
                 aDetalle = #8#22;
             |SINO;
                 aDetalle = aDetalle + " " + #8#22;
             |FINSI;
             |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |SINO;
             aDetalle = aDetalle + " / ";
         |FINSI;

         aBeta = #917#10 % 130;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;
     |FINSI;
|FPRC;

|PROCESO dsarw017;
    |SI #8#1 = "1";
        |SI aCarpeta1 ! #917#1;
            nCarpeta1 = nCarpeta1 + 1;
            nCarpeta2 = 0;

            aAlfa     = #917#1;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        nCarpeta2 = nCarpeta2 + 1;
        aAlfa     = nCarpeta1 + "," + nCarpeta2 + ":";
        |QBF aAlfa;

        aDetalle = "";
        |HAZ DameDetalle;
        aAlfa = aAlfa + aDetalle;
        |QBF aAlfa;

        aAlfa     = aAlfa + "{{" + (("000000000" + #917#0) % -109) + "}}";
        |HAZ CargaArbol;

        aCarpeta1 = #917#1;
    |FINSI;

    |SI #8#1 = "2";
        |SI aCarpeta1 ! #917#1;
            aCarpeta2 = "";

            nCarpeta1 = nCarpeta1 + 1;
            nCarpeta2 = 0;
            nCarpeta3 = 0;

            aAlfa     = #917#1;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        |SI aCarpeta2 ! #917#2;
            nCarpeta2 = nCarpeta2 + 1;
            nCarpeta3 = 0;

            aAlfa     = #917#2;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + "," + nCarpeta2 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        aDetalle = "";
        |HAZ DameDetalle;
        aAlfa = aDetalle;
        |QBF aAlfa;

        nCarpeta3 = nCarpeta3 + 1;
        aAlfa     = nCarpeta1 + "," + nCarpeta2 + "," + nCarpeta3 + ":" + aAlfa;
        |QBF aAlfa;
        aAlfa     = aAlfa + "{{" + (("000000000" + #917#0) % -109) + "}}";
        |HAZ CargaArbol;

        nTDocumentos = nTDocumentos + 1;

        aCarpeta1 = #917#1;
        aCarpeta2 = #917#2;
    |FINSI;

    |SI #8#1 = "3";
        |SI aCarpeta1 ! #917#1;
            aCarpeta2 = "";
            aCarpeta3 = "";

            nCarpeta1 = nCarpeta1 + 1;
            nCarpeta2 = 0;
            nCarpeta3 = 0;
            nCarpeta4 = 0;

            aAlfa     = #917#1;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        |SI aCarpeta2 ! #917#2;
            aCarpeta3 = "";

            nCarpeta2 = nCarpeta2 + 1;
            nCarpeta3 = 0;
            nCarpeta4 = 0;

            aAlfa     = #917#2;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + "," + nCarpeta2 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        |SI aCarpeta3 ! #917#3;
            nCarpeta3 = nCarpeta3 + 1;
            nCarpeta4 = 0;

            aAlfa     = #917#3;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + "," + nCarpeta2 + "," + nCarpeta3 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        nCarpeta4 = nCarpeta4 + 1;
        aAlfa     = nCarpeta1 + "," + nCarpeta2 + "," + nCarpeta3 + "," + nCarpeta4;

        aDetalle = "";
        |HAZ DameDetalle;
        |QBF aDetalle;

        aAlfa     = aAlfa + ":" + aDetalle;
        |QBF aAlfa;
        aAlfa     = aAlfa + "{{" + (("000000000" + #917#0) % -109) + "}}";
        |HAZ CargaArbol;

        nTDocumentos = nTDocumentos + 1;

        aCarpeta1 = #917#1;
        aCarpeta2 = #917#2;
        aCarpeta3 = #917#3;
    |FINSI;

    |SI #8#1 = "4";
        |SI aCarpeta1 ! #917#1;
            aCarpeta2 = "";
            aCarpeta3 = "";
            aCarpeta4 = "";

            nCarpeta1 = nCarpeta1 + 1;
            nCarpeta2 = 0;
            nCarpeta3 = 0;
            nCarpeta4 = 0;
            nCarpeta5 = 0;

            aAlfa     = #917#1;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        |SI aCarpeta2 ! #917#2;
            aCarpeta3 = "";
            aCarpeta4 = "";

            nCarpeta2 = nCarpeta2 + 1;
            nCarpeta3 = 0;
            nCarpeta4 = 0;
            nCarpeta5 = 0;

            aAlfa     = #917#2;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + "," + nCarpeta2 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        |SI aCarpeta3 ! #917#3;
            aCarpeta4 = "";

            nCarpeta3 = nCarpeta3 + 1;
            nCarpeta4 = 0;
            nCarpeta5 = 0;

            aAlfa     = #917#3;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + "," + nCarpeta2 + "," + nCarpeta3 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        |SI aCarpeta4 ! #917#4;
            nCarpeta4 = nCarpeta4 + 1;
            nCarpeta5 = 0;

            aAlfa1     = #917#4;  |QBF aAlfa;
            |SI aAlfa1 = "";
                aAlfa1 = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + "," + nCarpeta2 + "," + nCarpeta3 + "," + nCarpeta4;
            aAlfa     = aAlfa + ":" + aAlfa1;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        nCarpeta5 = nCarpeta5 + 1;
        aAlfa     = nCarpeta1 + "," + nCarpeta2 + "," + nCarpeta3 + "," + nCarpeta4 + "," + nCarpeta5;

        aDetalle = "";
        |HAZ DameDetalle;
        |QBF aDetalle;

        aAlfa     = aAlfa + ":" + aDetalle;
        |QBF aAlfa;
        aAlfa     = aAlfa + "{{" + (("000000000" + #917#0) % -109) + "}}";
        |HAZ CargaArbol;

        nTDocumentos = nTDocumentos + 1;

        aCarpeta1 = #917#1;
        aCarpeta2 = #917#2;
        aCarpeta3 = #917#3;
        aCarpeta4 = #917#4;
    |FINSI;

    |SI #8#1 = "5";
        |SI aCarpeta1 ! #917#1;
            aCarpeta2 = "";
            aCarpeta3 = "";
            aCarpeta4 = "";
            aCarpeta5 = "";

            nCarpeta1 = nCarpeta1 + 1;
            nCarpeta2 = 0;
            nCarpeta3 = 0;
            nCarpeta4 = 0;
            nCarpeta5 = 0;
            nCarpeta6 = 0;

            aAlfa     = #917#1;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        |SI aCarpeta2 ! #917#2;
            aCarpeta3 = "";
            aCarpeta4 = "";
            aCarpeta5 = "";

            nCarpeta2 = nCarpeta2 + 1;
            nCarpeta3 = 0;
            nCarpeta4 = 0;
            nCarpeta5 = 0;
            nCarpeta6 = 0;

            aAlfa     = #917#2;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + "," + nCarpeta2 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        |SI aCarpeta3 ! #917#3;
            aCarpeta4 = "";
            aCarpeta5 = "";

            nCarpeta3 = nCarpeta3 + 1;
            nCarpeta4 = 0;
            nCarpeta5 = 0;
            nCarpeta6 = 0;

            aAlfa     = #917#3;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + "," + nCarpeta2 + "," + nCarpeta3 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        |SI aCarpeta4 ! #917#4;
            aCarpeta5 = "";

            nCarpeta4 = nCarpeta4 + 1;
            nCarpeta5 = 0;
            nCarpeta6 = 0;

            aAlfa1     = #917#4;  |QBF aAlfa;
            |SI aAlfa1 = "";
                aAlfa1 = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + "," + nCarpeta2 + "," + nCarpeta3 + "," + nCarpeta4;
            aAlfa     = aAlfa + ":" + aAlfa1;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        |SI aCarpeta5 ! #917#5;
            nCarpeta5 = nCarpeta5 + 1;
            nCarpeta6 = 0;

            aAlfa1     = #917#5;  |QBF aAlfa;
            |SI aAlfa1 = "";
                aAlfa1 = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + "," + nCarpeta2 + "," + nCarpeta3 + "," + nCarpeta4 + "," + nCarpeta5;
            aAlfa     = aAlfa + ":" + aAlfa1;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        nCarpeta6 = nCarpeta6 + 1;
        aAlfa     = nCarpeta1 + "," + nCarpeta2 + "," + nCarpeta3 + "," + nCarpeta4 + "," + nCarpeta5 + "," + nCarpeta6;

        aDetalle = "";
        |HAZ DameDetalle;
        |QBF aDetalle;

        aAlfa     = aAlfa + ":" + aDetalle;
        |QBF aAlfa;
        aAlfa     = aAlfa + "{{" + (("000000000" + #917#0) % -109) + "}}";
        |HAZ CargaArbol;

        nTDocumentos = nTDocumentos + 1;

        aCarpeta1 = #917#1;
        aCarpeta2 = #917#2;
        aCarpeta3 = #917#3;
        aCarpeta4 = #917#4;
        aCarpeta5 = #917#5;
    |FINSI;
|FPRC;

|PROCESO CargaTemporalVista;
     aFichero = ("17" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #917 aFichero;

     |ABRE #917;  |CIERRA #917;  |DELINDEX #917;

     |ABRE #917;
     |SELECT #1#917;

     |ABRE #dsarm044;
     nSwModoEnvio = 0;
     |SI aParametro = "";
          |SI enDESPANET = 1;
               |SI nFichero = 0;    |BUCLE dsarm005_0_7;    |FINSI;
               |SI nFichero = 905;  |BUCLE dsarm005_905_7;  |FINSI;
          |SINO;
               |SI nFichero = 0;    |BUCLE dsarm005_0_8;    |FINSI;
               |SI nFichero = 905;  |BUCLE dsarm005_905_8;  |FINSI;
          |FINSI;
     |SINO;
          aAlfa = aParametro % 0;
          |SI aAlfa = "5";
               |SI nFichero = 0;    |BUCLE dsarm005_0_3;    |FINSI;
               |SI nFichero = 905;  |BUCLE dsarm005_905_3;  |FINSI;
          |SINO;
               |SI enLABORAL = 0;
                    |SI nFichero = 0;    |BUCLE dsarm005_0_4;    |FINSI;
                    |SI nFichero = 905;  |BUCLE dsarm005_905_4;  |FINSI;
               |SINO;
                    |BUCLE dsarm005_905_1;
               |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #dsarm044;

     |DBASE aBase;  |QBF aBase;
     aAlfa = aBase + "tmp";          |MKDIR aAlfa;

     eaRutaOrigen  = aBase + "tmp/";
     |SI #1#7 = "N";
          |HAZ DimeUnidad;
          eaRutaDestino = eaUnidad + ":\documentos\dsarchi\";
     |SINO;
          |HAZ LeeUnidadBasico;
          eaRutaDestino = eaUnidadBasico + "\documentos\dsarchi\";
     |FINSI;
     eaFicheroTxt  = "dsarm00501" + Usuario + ".txt";
     eaFicheroTgz  = "dsarm00501" + Usuario + ".tgz";
     eaFicheroTar  = "dsarm00501" + Usuario + ".tar";

     eaFicheroTxt  = "dsarm00501" + Usuario + ".txt";
     aAlfa         = eaRutaDestino + eaFicheroTxt;
     |RFBORRA aAlfa;

     aAbre = eaRutaOrigen + eaFicheroTxt;

     sT_nID   = nTree;
     sT_nOper = 0;

     |XABRE "WB", aAbre, nHandle;

     nCarpeta1 = 0;
     nCarpeta2 = 0;
     nCarpeta3 = 0;
     nCarpeta4 = 0;
     nCarpeta5 = 0;
     nCarpeta6 = 0;
     aCarpeta1 = "";
     aCarpeta2 = "";
     aCarpeta3 = "";
     aCarpeta4 = "";
     aCarpeta5 = "";

     |SI #dsarm008#30 = "N";
          |SI #dsarm008#28 = 0;
               |SELECT #2#917;
          |SINO;
               |SELECT #3#917;
          |FINSI;
     |SINO;
          |SELECT #4#917;
     |FINSI;

     |LEE 000#917p;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
         |HAZ dsarw017;

         |LEE 000#917s;
     |SIGUE;

     |XCIERRA nHandle;

     |HAZ TraeTxtComprimido;

     |CIERRA #917;
     |DELINDEX #917;

     eaFicheroTxt  = "dsarm00501" + Usuario + ".txt";
     aAlfa         = eaRutaDestino + eaFicheroTxt;
|FPRC;

|| ***********************************************************************
||                    VISTAS TEMPORAL DESDE EL DSAZM005
|| ***********************************************************************

|DEFBUCLE dsarm005_Z5;
     #dsarm005#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dsarm005_0;
|FIN;

|DEFBUCLE dsarm905_Z5;
     #dsarm005@#1001;
     ;
     000000001;
     999999999;
     ;
     NULL, dsarm005_0;
|FIN;

|PROCESO CargaTemporalVista_Z5;
     aFichero = ("27" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #917 aFichero;

     |ABRE #917;  |CIERRA #917;  |DELINDEX #917;

     |ABRE #917;
     |SELECT #1#917;

     nSwModoEnvio = 0;

     |ABRE #dsarm044;
     |SI nFichero = 0;
          |BUCLE dsarm005_Z5;
     |SINO;
          |BUCLE dsarm905_Z5;
     |FINSI;
     |CIERRA #dsarm044;

     |DBASE aBase;  |QBF aBase;
     aAlfa = aBase + "tmp";          |MKDIR aAlfa;

     eaRutaOrigen  = aBase + "tmp/";
     |SI #1#7 = "N";
          |HAZ DimeUnidad;
          eaRutaDestino = eaUnidad + ":\documentos\dsarchi\";
     |SINO;
          |HAZ LeeUnidadBasico;
          eaRutaDestino = eaUnidadBasico + "\documentos\dsarchi\";
     |FINSI;

     eaFicheroTxt  = "asociados" + Usuario + ".txt";
     eaFicheroTgz  = "asociados" + Usuario + ".tgz";
     eaFicheroTar  = "asociados" + Usuario + ".tar";

     eaFicheroTxt  = "asociados" + Usuario + ".txt";
     aAlfa         = eaRutaDestino + eaFicheroTxt;
     |RFBORRA aAlfa;

     aAbre = eaRutaOrigen + eaFicheroTxt;

     sT_nID   = nTree;
     sT_nOper = 0;

     |XABRE "WB", aAbre, nHandle;

     nCarpeta1 = 0;
     nCarpeta2 = 0;
     nCarpeta3 = 0;
     nCarpeta4 = 0;
     nCarpeta5 = 0;
     nCarpeta6 = 0;
     aCarpeta1 = "";
     aCarpeta2 = "";
     aCarpeta3 = "";
     aCarpeta4 = "";
     aCarpeta5 = "";

     |SI #dsarm008#30 = "N";
          |SI #dsarm008#28 = 0;
               |SELECT #2#917;
          |SINO;
               |SELECT #3#917;
          |FINSI;
     |SINO;
          |SELECT #4#917;
     |FINSI;

     |LEE 000#917p;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
         |HAZ dsarw017;

         |LEE 000#917s;
     |SIGUE;

     |XCIERRA nHandle;

     |HAZ TraeTxtComprimido;

     |CIERRA #917;
     |DELINDEX #917;

     eaFicheroTxt  = "asociados" + Usuario + ".txt";
     aAlfa         = eaRutaDestino + eaFicheroTxt;
|FPRC;

|| ***********************************************************************
||                          VISTAS TIEMPO REAL DSARM005
|| ***********************************************************************

|PROCESO DameDetalle55;
     aAux = #8#14;  |QBF aAux;
     |SI aAux = "";
         aDetalle = "Documento: " + (("000000000" + #dsarm055#0) % -109);
         |ACABA;
     |FINSI;

     |SI #8#12 = "1";
         aDetalle = "";
         |SI #8#23 = "S";
             aDetalle = #8#14;  |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |FINSI;

         aBeta = #dsarm055#6 % 190;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;
     |FINSI;

     |SI #8#12 = "2";
         aDetalle = "";
         |SI #8#23 = "S";
             aDetalle = #8#14;  |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |FINSI;

         aBeta    = #dsarm055#6 % 160;  |QBF aBeta;
         aDetalle = aDetalle + aBeta;

         |SI #8#24 = "S";
             |SI aDetalle = "";
                 aDetalle = #8#16;
             |SINO;
                 aDetalle = aDetalle + " " + #8#16;
             |FINSI;
             |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |SINO;
             aDetalle = aDetalle + " / ";
         |FINSI;

         aBeta = #dsarm055#7 % 160;
         aDetalle = aDetalle + aBeta;
     |FINSI;

     |SI #8#12 = "3";
         aDetalle = "";
         |SI #8#23 = "S";
             aDetalle = #8#14;  |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |FINSI;

         aBeta = #dsarm055#6 % 140;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;

         |SI #8#24 = "S";
             |SI aDetalle = "";
                 aDetalle = #8#16;
             |SINO;
                 aDetalle = aDetalle + " " + #8#16;
             |FINSI;
             |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |SINO;
             aDetalle = aDetalle + " / ";
         |FINSI;

         aBeta = #dsarm055#7 % 140;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;

         |SI #8#25 = "S";
             |SI aDetalle = "";
                 aDetalle = #8#18;
             |SINO;
                 aDetalle = aDetalle + " " + #8#18;
             |FINSI;
             |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |SINO;
             aDetalle = aDetalle + " / ";
         |FINSI;

         aBeta = #dsarm055#8 % 140;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;
     |FINSI;

     |SI #8#12 = "4";
         aDetalle = "";
         |SI #8#23 = "S";
             aDetalle = #8#14;  |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |FINSI;

         aBeta = #dsarm055#6 % 130;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;

         |SI #8#24 = "S";
             |SI aDetalle = "";
                 aDetalle = #8#16;
             |SINO;
                 aDetalle = aDetalle + " " + #8#16;
             |FINSI;
             |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |SINO;
             aDetalle = aDetalle + " / ";
         |FINSI;

         aBeta = #dsarm055#7 % 130;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;

         |SI #8#25 = "S";
             |SI aDetalle = "";
                 aDetalle = #8#18;
             |SINO;
                 aDetalle = aDetalle + " " + #8#18;
             |FINSI;
             |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |SINO;
             aDetalle = aDetalle + " / ";
         |FINSI;

         aBeta = #dsarm055#8 % 130;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;

         |SI #8#26 = "S";
             |SI aDetalle = "";
                 aDetalle = #8#20;
             |SINO;
                 aDetalle = aDetalle + " " + #8#20;
             |FINSI;
             |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |SINO;
             aDetalle = aDetalle + " / ";
         |FINSI;

         aBeta = #dsarm055#9 % 130;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;
     |FINSI;

     |SI #8#12 = "5";
         aDetalle = "";
         |SI #8#23 = "S";
             aDetalle = #8#14;  |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |FINSI;

         aBeta = #dsarm055#6 % 130;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;

         |SI #8#24 = "S";
             |SI aDetalle = "";
                 aDetalle = #8#16;
             |SINO;
                 aDetalle = aDetalle + " " + #8#16;
             |FINSI;
             |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |SINO;
             aDetalle = aDetalle + " / ";
         |FINSI;

         aBeta = #dsarm055#7 % 130;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;

         |SI #8#25 = "S";
             |SI aDetalle = "";
                 aDetalle = #8#18;
             |SINO;
                 aDetalle = aDetalle + " " + #8#18;
             |FINSI;
             |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |SINO;
             aDetalle = aDetalle + " / ";
         |FINSI;

         aBeta = #dsarm055#8 % 130;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;

         |SI #8#26 = "S";
             |SI aDetalle = "";
                 aDetalle = #8#20;
             |SINO;
                 aDetalle = aDetalle + " " + #8#20;
             |FINSI;
             |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |SINO;
             aDetalle = aDetalle + " / ";
         |FINSI;

         aBeta = #dsarm055#9 % 130;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;

         |SI #8#27 = "S";
             |SI aDetalle = "";
                 aDetalle = #8#22;
             |SINO;
                 aDetalle = aDetalle + " " + #8#22;
             |FINSI;
             |QBF aDetalle;
             aDetalle = aDetalle + ": ";
         |SINO;
             aDetalle = aDetalle + " / ";
         |FINSI;

         aBeta = #dsarm055#10 % 130;   |QBF aBeta;
         aDetalle = aDetalle + aBeta;
     |FINSI;
|FPRC;

|PROCESO dsarm055;
    |SI enTemporal = 1;
        |SI nFichero = 0;
            |SELECT #1#0;
            #dsarm005#0 = #dsarm055#0;
            |LEE 000#dsarm005.=;
            |SI FSalida ! 0;  |ACABA;  |FINSI;
        |FINSI;
    |FINSI;

    |SI nFichero = 905;
        |SELECT #1#905;
        #dsarm005@#0 = #dsarm055#0;
        |LEE 000#dsarm005@.=;
        |SI FSalida ! 0;  |ACABA;  |FINSI;
    |FINSI;

    |SI #8#1 = "1";
        |SI aCarpeta1 ! #dsarm055#1;
            nCarpeta1 = nCarpeta1 + 1;
            nCarpeta2 = 0;

            aAlfa     = #dsarm055#1;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        nCarpeta2 = nCarpeta2 + 1;
        aAlfa     = nCarpeta1 + "," + nCarpeta2 + ":";
        |QBF aAlfa;

        aDetalle = "";
        |HAZ DameDetalle55;
        aAlfa = aAlfa + aDetalle;
        |QBF aAlfa;

        aAlfa     = aAlfa + "{{" + (("000000000" + #dsarm055#0) % -109) + "}}";
        |HAZ CargaArbol;

        nTDocumentos = nTDocumentos + 1;

        aCarpeta1 = #dsarm055#1;
    |FINSI;

    |SI #8#1 = "2";
        |SI aCarpeta1 ! #dsarm055#1;
            aCarpeta2 = "";

            nCarpeta1 = nCarpeta1 + 1;
            nCarpeta2 = 0;
            nCarpeta3 = 0;

            aAlfa     = #dsarm055#1;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        |SI aCarpeta2 ! #dsarm055#2;
            nCarpeta2 = nCarpeta2 + 1;
            nCarpeta3 = 0;

            aAlfa     = #dsarm055#2;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + "," + nCarpeta2 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        aDetalle = "";
        |HAZ DameDetalle55;
        aAlfa = aDetalle;
        |QBF aAlfa;

        nCarpeta3 = nCarpeta3 + 1;
        aAlfa     = nCarpeta1 + "," + nCarpeta2 + "," + nCarpeta3 + ":" + aAlfa;
        |QBF aAlfa;
        aAlfa     = aAlfa + "{{" + (("000000000" + #dsarm055#0) % -109) + "}}";
        |HAZ CargaArbol;

        nTDocumentos = nTDocumentos + 1;

        aCarpeta1 = #dsarm055#1;
        aCarpeta2 = #dsarm055#2;
    |FINSI;

    |SI #8#1 = "3";
        |SI aCarpeta1 ! #dsarm055#1;
            aCarpeta2 = "";
            aCarpeta3 = "";

            nCarpeta1 = nCarpeta1 + 1;
            nCarpeta2 = 0;
            nCarpeta3 = 0;
            nCarpeta4 = 0;

            aAlfa     = #dsarm055#1;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        |SI aCarpeta2 ! #dsarm055#2;
            aCarpeta3 = "";

            nCarpeta2 = nCarpeta2 + 1;
            nCarpeta3 = 0;
            nCarpeta4 = 0;

            aAlfa     = #dsarm055#2;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + "," + nCarpeta2 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        |SI aCarpeta3 ! #dsarm055#3;
            nCarpeta3 = nCarpeta3 + 1;
            nCarpeta4 = 0;

            aAlfa     = #dsarm055#3;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + "," + nCarpeta2 + "," + nCarpeta3 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        nCarpeta4 = nCarpeta4 + 1;
        aAlfa     = nCarpeta1 + "," + nCarpeta2 + "," + nCarpeta3 + "," + nCarpeta4;

        aDetalle = "";
        |HAZ DameDetalle55;
        |QBF aDetalle;

        aAlfa     = aAlfa + ":" + aDetalle;
        |QBF aAlfa;
        aAlfa     = aAlfa + "{{" + (("000000000" + #dsarm055#0) % -109) + "}}";
        |HAZ CargaArbol;

        nTDocumentos = nTDocumentos + 1;

        aCarpeta1 = #dsarm055#1;
        aCarpeta2 = #dsarm055#2;
        aCarpeta3 = #dsarm055#3;
    |FINSI;

    |SI #8#1 = "4";
        |SI aCarpeta1 ! #dsarm055#1;
            aCarpeta2 = "";
            aCarpeta3 = "";
            aCarpeta4 = "";

            nCarpeta1 = nCarpeta1 + 1;
            nCarpeta2 = 0;
            nCarpeta3 = 0;
            nCarpeta4 = 0;
            nCarpeta5 = 0;

            aAlfa     = #dsarm055#1;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        |SI aCarpeta2 ! #dsarm055#2;
            aCarpeta3 = "";
            aCarpeta4 = "";

            nCarpeta2 = nCarpeta2 + 1;
            nCarpeta3 = 0;
            nCarpeta4 = 0;
            nCarpeta5 = 0;

            aAlfa     = #dsarm055#2;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + "," + nCarpeta2 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        |SI aCarpeta3 ! #dsarm055#3;
            aCarpeta4 = "";

            nCarpeta3 = nCarpeta3 + 1;
            nCarpeta4 = 0;
            nCarpeta5 = 0;

            aAlfa     = #dsarm055#3;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + "," + nCarpeta2 + "," + nCarpeta3 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        |SI aCarpeta4 ! #dsarm055#4;
            nCarpeta4 = nCarpeta4 + 1;
            nCarpeta5 = 0;

            aAlfa1     = #dsarm055#4;  |QBF aAlfa;
            |SI aAlfa1 = "";
                aAlfa1 = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + "," + nCarpeta2 + "," + nCarpeta3 + "," + nCarpeta4;
            aAlfa     = aAlfa + ":" + aAlfa1;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        nCarpeta5 = nCarpeta5 + 1;
        aAlfa     = nCarpeta1 + "," + nCarpeta2 + "," + nCarpeta3 + "," + nCarpeta4 + "," + nCarpeta5;

        aDetalle = "";
        |HAZ DameDetalle55;
        |QBF aDetalle;

        aAlfa     = aAlfa + ":" + aDetalle;
        |QBF aAlfa;
        aAlfa     = aAlfa + "{{" + (("000000000" + #dsarm055#0) % -109) + "}}";
        |HAZ CargaArbol;

        nTDocumentos = nTDocumentos + 1;

        aCarpeta1 = #dsarm055#1;
        aCarpeta2 = #dsarm055#2;
        aCarpeta3 = #dsarm055#3;
        aCarpeta4 = #dsarm055#4;
    |FINSI;

    |SI #8#1 = "5";
        |SI aCarpeta1 ! #dsarm055#1;
            aCarpeta2 = "";
            aCarpeta3 = "";
            aCarpeta4 = "";
            aCarpeta5 = "";

            nCarpeta1 = nCarpeta1 + 1;
            nCarpeta2 = 0;
            nCarpeta3 = 0;
            nCarpeta4 = 0;
            nCarpeta5 = 0;
            nCarpeta6 = 0;

            aAlfa     = #dsarm055#1;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        |SI aCarpeta2 ! #dsarm055#2;
            aCarpeta3 = "";
            aCarpeta4 = "";
            aCarpeta5 = "";

            nCarpeta2 = nCarpeta2 + 1;
            nCarpeta3 = 0;
            nCarpeta4 = 0;
            nCarpeta5 = 0;
            nCarpeta6 = 0;

            aAlfa     = #dsarm055#2;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + "," + nCarpeta2 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        |SI aCarpeta3 ! #dsarm055#3;
            aCarpeta4 = "";
            aCarpeta5 = "";

            nCarpeta3 = nCarpeta3 + 1;
            nCarpeta4 = 0;
            nCarpeta5 = 0;
            nCarpeta6 = 0;

            aAlfa     = #dsarm055#3;  |QBF aAlfa;
            |SI aAlfa = "";
                aAlfa = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + "," + nCarpeta2 + "," + nCarpeta3 + ":" + aAlfa;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        |SI aCarpeta4 ! #dsarm055#4;
            aCarpeta5 = "";

            nCarpeta4 = nCarpeta4 + 1;
            nCarpeta5 = 0;
            nCarpeta6 = 0;

            aAlfa1     = #dsarm055#4;  |QBF aAlfa;
            |SI aAlfa1 = "";
                aAlfa1 = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + "," + nCarpeta2 + "," + nCarpeta3 + "," + nCarpeta4;
            aAlfa     = aAlfa + ":" + aAlfa1;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        |SI aCarpeta5 ! #dsarm055#5;
            nCarpeta5 = nCarpeta5 + 1;
            nCarpeta6 = 0;

            aAlfa1     = #dsarm055#5;  |QBF aAlfa;
            |SI aAlfa1 = "";
                aAlfa1 = "Sin Contenido";
            |FINSI;

            aAlfa     = nCarpeta1 + "," + nCarpeta2 + "," + nCarpeta3 + "," + nCarpeta4 + "," + nCarpeta5;
            aAlfa     = aAlfa + ":" + aAlfa1;  |QBF aAlfa;
            |HAZ CargaArbol;
        |FINSI;

        nCarpeta6 = nCarpeta6 + 1;
        aAlfa     = nCarpeta1 + "," + nCarpeta2 + "," + nCarpeta3 + "," + nCarpeta4 + "," + nCarpeta5 + "," + nCarpeta6;

        aDetalle = "";
        |HAZ DameDetalle55;
        |QBF aDetalle;

        aAlfa     = aAlfa + ":" + aDetalle;
        |QBF aAlfa;
        aAlfa     = aAlfa + "{{" + (("000000000" + #dsarm055#0) % -109) + "}}";
        |HAZ CargaArbol;

        nTDocumentos = nTDocumentos + 1;

        aCarpeta1 = #dsarm055#1;
        aCarpeta2 = #dsarm055#2;
        aCarpeta3 = #dsarm055#3;
        aCarpeta4 = #dsarm055#4;
        aCarpeta5 = #dsarm055#5;
    |FINSI;
|FPRC;

|DEFBUCLE dsarm055_1;
     #dsarm055#1;
     ;
     000000001;
     999999999;
     ;
     NULL, dsarm055;
|FIN;

|DEFBUCLE dsarm055_2;
     #dsarm055#2;
     ;
     aDN1, aDN2, aDN3, aDN4, aDN5, aDFecha, "     ", 000000001;
     aHN1, aHN2, aHN3, aHN4, aHN5, aHFecha, "zzzzz", 999999999;
     ;
     NULL, dsarm055;
|FIN;

|DEFBUCLE dsarm055_3;
     #dsarm055#3;
     ;
     aDN1, aDN2, aDN3, aDN4, aDN5, aDOrd, aDFecha, "     ";
     aHN1, aHN2, aHN3, aHN4, aHN5, aHOrd, aHFecha, "zzzzz";
     ;
     NULL, dsarm055;
|FIN;

|DEFBUCLE dsarm055_4;
     #dsarm055#4;
     ;
     aDN1, aDN2, aDN3, aDN4, aDN5, aHOrd, aDFecha, "     ";
     aHN1, aHN2, aHN3, aHN4, aHN5, aDOrd, aHFecha, "zzzzz";
     ;
     NULL, dsarm055;
|FIN;

|DEFBUCLE dsarm055_5;
     #dsarm055#5;
     ;
     aDN1, aDN2, aDN3, aDN4, aDN5, aDDespanet, nDEmpresa, aDFecha, "     ", 000000001;
     aHN1, aHN2, aHN3, aHN4, aHN5, aHDespanet, nHEmpresa, aHFecha, "zzzzz", 999999999;
     ;
     NULL, dsarm055;
|FIN;

|DEFBUCLE dsarm055_6;
     #dsarm055#6;
     ;
     aDN1, aDN2, aDN3, aDN4, aDN5, aDOrd, aDDespanet, nDEmpresa, aDFecha, "     ";
     aHN1, aHN2, aHN3, aHN4, aHN5, aHOrd, aHDespanet, nHEmpresa, aHFecha, "zzzzz";
     ;
     NULL, dsarm055;
|FIN;

|DEFBUCLE dsarm055_7;
     #dsarm055#7;
     ;
     aDN1, aDN2, aDN3, aDN4, aDN5, aHOrd, aDDespanet, nDEmpresa, aDFecha, "     ";
     aHN1, aHN2, aHN3, aHN4, aHN5, aDOrd, aHDespanet, nHEmpresa, aHFecha, "zzzzz";
     ;
     NULL, dsarm055;
|FIN;

|DEFBUCLE dsarm055_8;
     #dsarm055#8;
     ;
     aDN1, aDN2, aDN3, aDN4, aDN5, aDNIF, aDFecha, "     ", 000000001;
     aHN1, aHN2, aHN3, aHN4, aHN5, aHNIF, aHFecha, "zzzzz", 999999999;
     ;
     NULL, dsarm055;
|FIN;

|DEFBUCLE dsarm055_9;
     #dsarm055#9;
     ;
     aDN1, aDN2, aDN3, aDN4, aDN5, aDOrd, aDNIF, aDFecha, "     ";
     aHN1, aHN2, aHN3, aHN4, aHN5, aHOrd, aHNIF, aHFecha, "zzzzz";
     ;
     NULL, dsarm055;
|FIN;

|DEFBUCLE dsarm055_10;
     #dsarm055#10;
     ;
     aDN1, aDN2, aDN3, aDN4, aDN5, aHOrd, aDNIF, aDFecha, "     ";
     aHN1, aHN2, aHN3, aHN4, aHN5, aDOrd, aHNIF, aHFecha, "zzzzz";
     ;
     NULL, dsarm055;
|FIN;

|PROCESO CargaRealVista;
     |DBASE aDirVistas;  |QBF aDirVistas;
     aDirVistas = aDirVistas + "vistas/";

     aFichero = "va" + (("000000" + #dsarm008#31) % -106);
     |NOME_DAT #dsarm055#aFichero#;
     |PATH_DAT #dsarm055#aDirVistas#;
     |DBASE aBase;  |QBF aBase;
     aAlfa = aBase + "tmp";          |MKDIR aAlfa;

     eaRutaOrigen  = aBase + "tmp/";
     |SI #1#7 = "N";
          |HAZ DimeUnidad;
          eaRutaDestino = eaUnidad + ":\documentos\dsarchi\";
     |SINO;
          |HAZ LeeUnidadBasico;
          eaRutaDestino = eaUnidadBasico + "\documentos\dsarchi\";
     |FINSI;

     eaFicheroTxt  = "dsarm00501" + Usuario + ".txt";
     eaFicheroTgz  = "dsarm00501" + Usuario + ".tgz";
     eaFicheroTar  = "dsarm00501" + Usuario + ".tar";

     eaFicheroTxt  = "dsarm00501" + Usuario + ".txt";
     aAlfa         = eaRutaDestino + eaFicheroTxt;
     |RFBORRA aAlfa;

     aAbre = eaRutaOrigen + eaFicheroTxt;

     sT_nID   = nTree;
     sT_nOper = 0;

     |XABRE "WB", aAbre, nHandle;

     nCarpeta1 = 0;
     nCarpeta2 = 0;
     nCarpeta3 = 0;
     nCarpeta4 = 0;
     nCarpeta5 = 0;
     nCarpeta6 = 0;
     aCarpeta1 = "";
     aCarpeta2 = "";
     aCarpeta3 = "";
     aCarpeta4 = "";
     aCarpeta5 = "";
     aDN1      = "";
     aHN1      = "z" * 135;
     aDN2      = "";
     aHN2      = "z" * 135;
     aDN3      = "";
     aHN3      = "z" * 135;
     aDN4      = "";
     aHN4      = "z" * 135;
     aDN5      = "";
     aHN5      = "z" * 135;
     aDOrd     = "";
     aHOrd     = "z" * 135;

     |SI aParametro = "";
         |SI enDESPANET = 1;
             aDDespanet = "S";
             aHDespanet = "S";
             nDEmpresa  = #801#0;
             nHEmpresa  = #801#0;

              |SI #dsarm008#30 = "N";
                  |SI #dsarm008#28 = 0;
                      |BUCLE dsarm055_5;
                  |SINO;
                      |BUCLE dsarm055_6;
                  |FINSI;
              |SINO;
                  |BUCLE dsarm055_7;
              |FINSI;
          |SINO;
              |SI #dsarm008#30 = "N";
                  |SI #dsarm008#28 = 0;
                      |BUCLE dsarm055_2;
                  |SINO;
                      |BUCLE dsarm055_3;
                  |FINSI;
              |SINO;
                  |BUCLE dsarm055_4;
              |FINSI;
          |FINSI;
     |SINO;
          aAlfa = aParametro % 0;
          |SI aAlfa = "5";
              aDDespanet = " ";
              aHDespanet = "z";
              nDEmpresa  = nParametro;
              nHEmpresa  = nParametro;
              |SI #dsarm008#30 = "N";
                  |SI #dsarm008#28 = 0;
                      |BUCLE dsarm055_5;
                  |SINO;
                      |BUCLE dsarm055_6;
                  |FINSI;
              |SINO;
                  |BUCLE dsarm055_7;
              |FINSI;
          |SINO;
               |SI enLABORAL = 0;
                   aDNIF = aParametro;
                   aHNIF = aParametro;

                   |SI #dsarm008#30 = "N";
                       |SI #dsarm008#28 = 0;
                           |BUCLE dsarm055_8;
                       |SINO;
                           |BUCLE dsarm055_9;
                       |FINSI;
                   |SINO;
                       |BUCLE dsarm055_10;
                   |FINSI;
               |SINO;
                   |SI #dsarm008#30 = "N";
                       |SI #dsarm008#28 = 0;
                           |BUCLE dsarm055_2;
                       |SINO;
                           |BUCLE dsarm055_3;
                       |FINSI;
                   |SINO;
                       |BUCLE dsarm055_4;
                   |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;

     |XCIERRA nHandle;

     |HAZ TraeTxtComprimido;

     eaFicheroTxt  = "dsarm00501" + Usuario + ".txt";
     aAlfa         = eaRutaDestino + eaFicheroTxt;
|FPRC;

|| ***********************************************************************
||                          VISTAS TIEMPO REAL DSARZ005
|| ***********************************************************************

|PROCESO CargaRealVista_Z5;
     |DBASE aDirVistas;  |QBF aDirVistas;
     aDirVistas = aDirVistas + "vistas/";

     aFichero = "va" + (("000000" + #dsarm008#31) % -106);
     |NOME_DAT #dsarm055#aFichero#;
     |PATH_DAT #dsarm055#aDirVistas#;
     |DBASE aBase;  |QBF aBase;
     aAlfa = aBase + "tmp";          |MKDIR aAlfa;

     eaRutaOrigen  = aBase + "tmp/";
     |SI #1#7 = "N";
          |HAZ DimeUnidad;
          eaRutaDestino = eaUnidad + ":\documentos\dsarchi\";
     |SINO;
          |HAZ LeeUnidadBasico;
          eaRutaDestino = eaUnidadBasico + "\documentos\dsarchi\";
     |FINSI;

     eaFicheroTxt  = "asociados" + Usuario + ".txt";
     eaFicheroTgz  = "asociados" + Usuario + ".tgz";
     eaFicheroTar  = "asociados" + Usuario + ".tar";

     eaFicheroTxt  = "asociados" + Usuario + ".txt";
     aAlfa         = eaRutaDestino + eaFicheroTxt;
     |RFBORRA aAlfa;

     aAbre = eaRutaOrigen + eaFicheroTxt;

     sT_nID   = nTree;
     sT_nOper = 0;

     |XABRE "WB", aAbre, nHandle;

     nCarpeta1 = 0;
     nCarpeta2 = 0;
     nCarpeta3 = 0;
     nCarpeta4 = 0;
     nCarpeta5 = 0;
     nCarpeta6 = 0;
     aCarpeta1 = "";
     aCarpeta2 = "";
     aCarpeta3 = "";
     aCarpeta4 = "";
     aCarpeta5 = "";

     |BUCLE dsarm055_1;

     |XCIERRA nHandle;

     |HAZ TraeTxtComprimido;

     eaFicheroTxt  = "asociados" + Usuario + ".txt";
     aAlfa         = eaRutaDestino + eaFicheroTxt;
|FPRC;
