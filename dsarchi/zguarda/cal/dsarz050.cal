|FICHEROS;
     dsarz050 #0;

     dsarm001;
     dsarm005;
     dsarm008;
|FIN;

|VARIABLES;
     aBorra       = "";
     aDirVistas   = "";

     nVentTrab    = 0;

     {-1}aVent        = "";
         aVent1       = 0;
         aVent2       = 0;
         aVent3       = 0;
         aVent4       = 0;
         aVent5       = "";

     &eaCodVista   = "";
|FIN;

|PROCESO dsarm005;
     |HAZ IndexaTiempoReal;

     |PULSATECLA;
|FPRC;

|DEFBUCLE dsarm005;
     #dsarm005#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dsarm005;
|FIN;

|PROGRAMA;
     |ABRE #dsarm001;
     |LEE 000#dsarm001.p;
     |SI FSalida ! 0;  |DDEFECTO #dsarm001;  |FINSI;
     |CIERRA #dsarm001;

     |SI #dsarm001#191 = "N";
         |MENAV "0000La aplicaci¢n no tiene activada la vista r pida, act¡vela en par metros generales";
         |ACABA;
     |FINSI;

     |SI eaCodVista ! "";
         |MENAV "0000Se va a proceder a regenerar la tabla de la vistas r pidas de la vista que acaba de crear o modificar";
     |FINSI;

     |VENTANA 0501, 0550, -1, 16, "Procesando trabajo. Esto puede tardar varios minutos.";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;
     |PAUSA;

     |DBASE aDirVistas;  |QBF aDirVistas;
     aDirVistas = aDirVistas + "vistas";  |MKDIR aDirVistas;
     aDirVistas = aDirVistas + "/";

     |SI eaCodVista = "";
         aBorra = aDirVistas + "va*.*";
         |_PDIR aBorra;
         |PARA; |SI FSalida = 0; |HACIENDO;
              |FBORRA aBorra;
              |_SDIR aBorra;
         |SIGUE;
     |SINO;
         |ABRE #dsarm008;
         #dsarm008#0 = eaCodVista;
         |LEE 000#dsarm008.=;
         |SI FSalida ! 0;  |DDEFECTO #dsarm008;  |FINSI;
         |CIERRA #dsarm008;

         |SI #dsarm008#31 ! 0;
             aBorra = aDirVistas + "va" + (("000000" + #dsarm008#31) % -106);
             |FBORRA aBorra;
         |FINSI;
     |FINSI;

     |BUCLE dsarm005;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;
|FPRO;
