|FICHEROS;
     dsarm005 #5;

     dsarm033 #0;

     dsarm001 #1;        ||Parametros

     abom0001@  #1001;
     abom0002@  #1002;
     abom0020@  #1020;
     asclient@  #1003;
     facemp@    #1004;

     referen@   #1005;   ||Para cargar varios CARGA_DEF
|FIN;

|VARIABLES;
     nSwUbicarAnyoMes = 0;
     fFechaDocu = @;

     aModoArchivo = "";       ||C --> Centralizado (Servidor)  ||D --> Distribuido
     nCodUbica = 0;
     aIPRemotoCopia = "";
     aBaseDoc = "";
     aRutaDocumento = "";
     aDestino = "";
     aNombreDestino = "";
     nSwCopiaOk = 0;

     aOrigen = "";
     aExtension = "";
     aAlfa = "";
     aAlfa1 = "";

     aTexto = "";
     aMinutos = ""
     aTiempo = "";
     nUltimo = 0;

     nExpediente = 0;
     aFechaCierre = "";
     nCliente = 0;
     nCliAntes = 0;
     nGuardaCliAntes = 0;
     aEmp = "";
     nEmpAntes = 0;                ||Para el Boton.
     nGuardaEmpAntes = 0;          ||Para el tipo 7 y 0.
     aBase = "";
     aPathDef = "";
     aPathFich = "";
     aPathFichEmp = "";
     aDef = "";
     aMensaje = "";

     nPanta       = 0;
     nBoton1      = 0;
     nBoton2      = 0;
     nBoton3      = 0;
     nBoton4      = 0;
     nBoton5      = 0;
     nCampo       = 0;
     nGrid        = 0;
     nRango       = 0;

     aHora        = "";
     aEsc1        = "";
     aEsc2        = "";
     aRetu        = "";
     aTecla       = "";

     &enDocumento = 0;
     &eaDSMAC     = "";
     &enExped     = 0;
     &enDoc       = 0;
     &enTipoFac   = 0;
     &eaPath      = "";
     &eaEmpAcceso = "";
|FIN;

/*

|PROCESO Baja6;
     #6#0 = #5#0;
     #6#1 = 1;
|FPRC;

|PROCESO Alta6;
     #6#0 = #5#0;
     #6#1 = 999;
|FPRC;


|PROCESO Evento6;
     |SI FSalida ! 1;  |ACABA;  |FINSI;

     |LEE 000#6=;
     |SI FSalida = 0;  |Y #6#0 = #5#0;
         |PARA nCampo = 0;  |SI nCampo [ 12;  |HACIENDO nCampo = nCampo + 1;
               #912nCampo = #6nCampo;
         |SIGUE;

         |SI #6#1 = #5#49;
             |ESTADO_CONTROL nBoton2, "ENABLE";
             |ESTADO_CONTROL nBoton3, "ENABLE";
         |SINO;
             |ESTADO_CONTROL nBoton2, "DISABLE";
             |ESTADO_CONTROL nBoton3, "DISABLE";
         |FINSI;
     |SINO;
         |ESTADO_CONTROL nBoton2, "DISABLE";
         |ESTADO_CONTROL nBoton3, "DISABLE";
         |DDEFECTO #912;
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ 12;  |HACIENDO nCampo = nCampo + 1;
           |C_M #912nCampo, 1, "N";
     |SIGUE;

     |PINTA #912#1;
     |PINTA #912#2;
     |PINTA #912#3;
     |PINTA #912#4;
     |PINTA #912#5;
     |PINTA #912#6;
     |PINTA #912#7;
     |PINTA #912#8;
     |PINTA #912#9;
     |PINTA #912#10;
|FPRC;
*/

|PROCESO Boton1;
     nEmpAntes = #dsarm033#4;

     |ABRE #facemp@;
     |CONSULTA_CLAVE #1#facemp@;
     |SI FSalida = 0;
          #dsarm033#4 = #facemp@#0;
          #dsarm033#5 = #facemp@#1;
          |PINTA #dsarm033#4;
          |PINTA #dsarm033#5;
          |SI nEmpAntes ! #dsarm033#4;
               #dsarm033#6 = 0;
               #dsarm033#7 = "";
               #dsarm033#8 = 0;
               #dsarm033#9 = "";
               |PINTA #dsarm033#6;
               |PINTA #dsarm033#7;
               |PINTA #dsarm033#8;
               |PINTA #dsarm033#9;
          |FINSI;
     |FINSI;
     |CIERRA #facemp@;
|FPRC;

|PROCESO Tipo66C4; |TIPO 66;
     |HAZ Boton1;
|FPRC;

|PROCESO Tipo66C6; |TIPO 66;
     |HAZ Boton2;
|FPRC;

|PROCESO Tipo66C8; |TIPO 66;
     |HAZ Boton3;
|FPRC;


|PROCESO Tipo7C4_m033; |TIPO 7;
     nGuardaEmpAntes = #dsarm033#4;
|FPRC;

|PROCESO Tipo0C4_m033; |TIPO 0;
     |ABRE #facemp@;
     #facemp@#0 = #dsarm033#4;
     |LEE 000#facemp@.=;
     |SI FSalida = 0;
          #dsarm033#5 = #facemp@#1;
          |PINTA #dsarm033#5;
          |SI nGuardaEmpAntes ! #dsarm033#4;
               #dsarm033#6 = 0;
               #dsarm033#7 = "";
               #dsarm033#8 = 0;
               #dsarm033#9 = "";
               |PINTA #dsarm033#6;
               |PINTA #dsarm033#7;
               |PINTA #dsarm033#8;
               |PINTA #dsarm033#9;
          |FINSI;
     |SINO;
          #dsarm033#4 = 0;
          #dsarm033#5 = "";
          #dsarm033#6 = 0;
          #dsarm033#7 = "";
          #dsarm033#8 = 0;
          #dsarm033#9 = "";
          |PINTA #dsarm033#4;
          |PINTA #dsarm033#5;
          |PINTA #dsarm033#6;
          |PINTA #dsarm033#7;
          |PINTA #dsarm033#8;
          |PINTA #dsarm033#9;
     |FINSI;
     |CIERRA #facemp@;
|FPRC;

|PROCESO Boton2;
     nCliAntes = #dsarm033#6;

     aEmp = ("00" + #dsarm033#4) % -102;
     |QBF aEmp;
     |SI aEmp = "00";
          aMensaje = "0000Seleccione primero la Empresa";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;
     aPathFichEmp = aPathFich + aEmp + "/";

     |PATH_DAT #1003 aPathFichEmp;

     |ABRE #asclient@;
     |CONSULTA_CLAVE #1#asclient@;
     |SI FSalida = 0;
          #dsarm033#6 = #asclient@#0;
          #dsarm033#7 = #asclient@#1;
          |PINTA #dsarm033#6;
          |PINTA #dsarm033#7;
          |SI nCliAntes ! #dsarm033#6;
               #dsarm033#8 = 0;
               #dsarm033#9 = "";
               |PINTA #dsarm033#8;
               |PINTA #dsarm033#9;
          |FINSI;
     |FINSI;
     |CIERRA #asclient@;
|FPRC;

|PROCESO Tipo7C6_m033; |TIPO 7;
     nGuardaCliAntes = #dsarm033#6;
|FPRC;

|PROCESO Tipo0C6_m033; |TIPO 0;
     aEmp = ("00" + #dsarm033#4) % -102;
     |QBF aEmp;
     |SI aEmp = "00";
          aMensaje = "0000Seleccione primero la Empresa";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;
     aPathFichEmp = aPathFich + aEmp + "/";

     |PATH_DAT #1003 aPathFichEmp;

     |ABRE #asclient@;
     #asclient@#0 = #dsarm033#6;
     |LEE 000#asclient@.=;
     |SI FSalida = 0;
          #dsarm033#7 = #asclient@#1;
          |SI nGuardaCliAntes ! #dsarm033#6;
               #dsarm033#8 = 0;
               #dsarm033#9 = "";
          |FINSI;
     |SINO;
          #dsarm033#6 = 0;
          #dsarm033#7 = "";
          #dsarm033#8 = 0;
          #dsarm033#9 = "";
     |FINSI;
     |CIERRA #asclient@;
     |PINTA #dsarm033#6;
     |PINTA #dsarm033#7;
     |PINTA #dsarm033#8;
     |PINTA #dsarm033#9;
|FPRC;

|PROCESO Baja;
     #abom0001@#3 = nCliente;
     #abom0001@#0 = 99999999;
|FPRC;

|PROCESO Alta;
     #abom0001@#3 = nCliente;
     #abom0001@#0 = 0;
|FPRC;

|PROCESO Boton3;
     aEmp = ("00" + #dsarm033#4) % -102;
     |QBF aEmp;
     |SI aEmp = "00";
          aMensaje = "0000Seleccione primero la Empresa";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     nCliente = #dsarm033#6;
     |SI nCliente = 0;
          aMensaje = "0000Seleccione primero el Cliente";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     aPathFichEmp = aPathFich + aEmp + "/";

     |PATH_DAT #1001 aPathFichEmp;

     |ABRE #abom0001@;
     |CONSULTA_F_CLAVE #2#abom0001@, Baja, Alta;
     |SI FSalida = 0;
          aFechaCierre = #abom0001@#2;
          |QBF aFechaCierre;
          |SI aFechaCierre ! "01.01.0000";
               aMensaje = "0000Atencion: El expediente esta cerrado";
               |MENAV aMensaje;
          |FINSI;
          #dsarm033#8 = #abom0001@#0;
          #dsarm033#9 = #abom0001@#4;
          |PINTA #dsarm033#8;
          |PINTA #dsarm033#9;
     |FINSI;
     |CIERRA #abom0001@;
|FPRC;

|PROCESO Tipo0C8_m033; |TIPO 0;
     aEmp = ("00" + #dsarm033#4) % -102;
     |QBF aEmp;
     |SI aEmp = "00";
          aMensaje = "0000Seleccione primero la Empresa";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     nCliente = #dsarm033#6;
     |SI nCliente = 0;
          aMensaje = "0000Seleccione primero el Cliente";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     aPathFichEmp = aPathFich + aEmp + "/";
     |PATH_DAT #1001 aPathFichEmp;

     |ABRE #abom0001@;
     |SELECT #2#abom0001@;
     #abom0001@#3 = #dsarm033#6;
     #abom0001@#0 = #dsarm033#8;
     |LEE 000#abom0001@.=;
     |SI FSalida = 0;
          #dsarm033#9 = #abom0001@#4;
     |SINO;
          aMensaje = "0000No existe Expediente";
          |MENAV aMensaje;
          #dsarm033#8 = 0;
          #dsarm033#9 = "";
     |FINSI;
     |CIERRA #abom0001@;
     |PINTA #dsarm033#8;
     |PINTA #dsarm033#9;
|FPRC;

|PROCESO Boton4;
     aEmp = ("00" + #dsarm033#4) % -102;
     |QBF aEmp;
     |SI aEmp = "00";
          aMensaje = "0000Seleccione primero la Empresa";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     nCliente = #dsarm033#6;
     |SI nCliente = 0;
          aMensaje = "0000Seleccione primero el Cliente";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     nExpediente = #dsarm033#8;
     |SI nCliente = 0;
          aMensaje = "0000Seleccione primero el Expediente";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     aPathFichEmp = aPathFich + aEmp + "/";

     |PATH_DAT #1001 aPathFichEmp;

     |ABRE #abom0001@;
     |SELECT #2#abom0001@;
     #abom0001@#3 = #dsarm033#6;
     #abom0001@#0 = #dsarm033#8;
     |LEE 000#abom0001@.=;
     |SI FSalida ! 0;
          aMensaje = "0000No existe Expediente";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;
     |CIERRA #abom0001@;

     |ABRE #dsarm001;
     |DDEFECTO #dsarm001;
     |LEE 000#dsarm001.p;
     |CIERRA #dsarm001;

     |PATH_DAT #1002 aPathFichEmp;
     |PATH_DAT #1020 aPathFichEmp;

     nUltimo = 0;

     |ABRE #abom0002@;
     |DDEFECTO #abom0002@;
     #abom0002@#0 = nExpediente;
     #abom0002@#1 = 99999;
     |LEE 000#abom0002@.];
     |SI FSalida = 0;
          |LEE 000#abom0002@.a;
     |SINO;
          |LEE 000#abom0002@.u;
     |FINSI;
     |SI FSalida = 0; |Y #abom0002@#0 = nExpediente;
          nUltimo = #abom0002@#1 + 1;
     |SINO;
          nUltimo = 1;
     |FINSI;

     |DDEFECTO #abom0002@;
     #abom0002@#0 = nExpediente;
     #abom0002@#1 = nUltimo;
     |LEE 101#abom0002@.=;
     |SI FSalida ! 0;
          aTexto = "Documento vinculado desde DSARCHI. Num.Reg.: " + (("000000000" + #dsarm033#1) % -109);
          #abom0002@#2 = aTexto;

          nSwCopiaOk = 1;
          |HAZ CopiaDocumento;
          |SI nSwCopiaOk = 0;
               |PTEC 807;
               |LIBERA #abom0002@;
               |CIERRA #abom0002@;
               |ACABA;
          |FINSI;
          ||Vamos a poner el nuevo nombre.
          #abom0002@#3 = aNombreDestino;
          #abom0002@#4 = ~;
          |HORA aTiempo;
          |QBF aTiempo;
          aHora = aTiempo % 102;
          aMinutos = aTiempo % 402;

          #abom0002@#5 = aHora;
          #abom0002@#6 = aMinutos;
          #abom0002@#7 = #abom0002@#4;
          #abom0002@#8 = #abom0002@#5;
          #abom0002@#9 = #abom0002@#6;
          #abom0002@#10 = #dsarm001#165;
          |GRABA 020#abom0002@.n;
     |FINSI;
     |LIBERA #abom0002@;
     |CIERRA #abom0002@;

     |ABRE #abom0020@;
     #abom0020@#0 = #abom0001@#0
     #abom0020@#1 = ~;
     #abom0020@#2 = aTiempo;
     #abom0020@#3 = #abom0002@#0;
     #abom0020@#4 = #abom0001@#29;
     #abom0020@#5 = #abom0002@#1;
     #abom0020@#6 = #abom0002@#2;
     #abom0020@#7 = "N";
     |GRABA 020#abom0020@.n;
     |LIBERA #abom0020@;
     |CIERRA #abom0020@;

     enExped     = #abom0001@#0
     enDoc       = #abom0002@#1
     enTipoFac   = 99;
     eaPath      = aPathFichEmp;
     eaEmpAcceso = aEmp;
     |SUB_EJECUTA_NP ":facturar/abxz0001;DSARCHI";

     ||Cuando termino me salgo de la pantalla de Vincular.
     |PTEC 807;
|FPRC;

|PROCESO CopiaDocumento;
     ||Necesito 3 carga_def para leer
     ||abom0514
     ||dsam0121
     ||dsam0122
     aDef = aPathDef + "abom0514.mas";
     |CARGA_DEF aDef, referen@;
     |SI FSalida ! 0;
          aMensaje = "0000Problemas CargaDef del fichero: " + aDef;
          |MENAV aMensaje;
          nSwCopiaOk = 0;
          |ACABA;
     |FINSI;
     |PATH_DAT #1005 aPathFich;
     |ABRE #1005;
     |DDEFECTO #1005;
     |LEE 000#1005.p;
     aModoArchivo = #1005#21;        ||C --> Centralizado (Servidor)  ||D --> Distribuido
     |CIERRA #1005;
     |DESCARGA_DEF #referen@;

     nCodUbica = #dsarm001#165;

     aDef = aPathDef + "dsam0121.mas";
     |CARGA_DEF aDef, referen@;
     |SI FSalida ! 0;
          aMensaje = "0000Problemas CargaDef del fichero: " + aDef;
          |MENAV aMensaje;
          nSwCopiaOk = 0;
          |ACABA;
     |FINSI;
     |PATH_DAT #1005 aPathFich;
     |ABRE #1005;
     #1005#0 = nCodUbica;
     |LEE 000#1005=;
     |SI FSalida ! 0;
          aMensaje = "0000No existe Ubicacion: " + nCodUbica;
          |QBF aMensaje;
          aMensaje = aMensaje + &13 + "Revise Parametros | Conexion con Gestion Abogados";
          |MENAV aMensaje;
          |CIERRA #1005;
          nSwCopiaOk = 0;
          |DESCARGA_DEF #referen@;
          |ACABA;
     |SINO;
          |SI #referen@#4 = "S";
               nSwUbicarAnyoMes = 1;
          |SINO;
               nSwUbicarAnyoMes = 0;
          |FINSI;
     |FINSI;
     |CIERRA #1005;
     |DESCARGA_DEF #referen@;

     |SI aModoArchivo ! "C";
         aDef = aPathDef + "dsam0122.mas";
         |CARGA_DEF aDef, referen@;
         |SI FSalida ! 0;
              aMensaje = "0000Problemas CargaDef del fichero: " + aDef;
              |MENAV aMensaje;
              nSwCopiaOk = 0;
              |ACABA;
         |FINSI;
         |PATH_DAT #1005 aPathFich;

         |HAZ CogeMac;

         |ABRE #1005;
         #1005#0 = nCodUbica;
         #1005#1 = eaDSMAC;
         |LEE 000#1005=;
         |SI FSalida ! 0;
             aMensaje =  "      No existe Ubicacion en la Maquina : " + eaDSMAC;
             |MENAV aMensaje;
             |CIERRA #1005;
             nSwCopiaOk = 0;
             |DESCARGA_DEF #referen@;
             |ACABA;
         |SINO;
             aRutaDocumento = #1005#3;
             |QBF aRutaDocumento;
             |RMKDIR aRutaDocumento;
         |FINSI;
         |CIERRA #1005;
         |DESCARGA_DEF #referen@;
     |SINO;
         |DBASS aBaseDoc;  |QBF aBaseDoc;
         aBaseDoc = aBaseDoc + "facturar/";

         aRutaDocumento = aBaseDoc + "ipabogad";
         |MKDIR aRutaDocumento;

         aRutaDocumento = aRutaDocumento + "/documentos";
         |MKDIR aRutaDocumento;

         aRutaDocumento = aRutaDocumento + "/" + (("00" + #dsarm033#4) % -102);
         |MKDIR aRutaDocumento;

         aRutaDocumento = aRutaDocumento + "/" + (("0000" + nCodUbica) % -104);
         |MKDIR aRutaDocumento;
     |FINSI;

     ||ARA55
     |SI nSwUbicarAnyoMes = 1;
         ||fFechaDocu = #dsarm005#4;
         fFechaDocu = ~;
         |SI fFechaDocu ! "00.00.0000";
             aAlfa = (fFechaDocu % -104) + (fFechaDocu % 402);
             aRutaDocumento = aRutaDocumento + "/" + aAlfa;
             |SI aModoArchivo ! "C";
                 |RMKDIR aRutaDocumento;
             |SINO;
                 |MKDIR aRutaDocumento;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI aRutaDocumento = "";
         aMensaje = "      No esta configurada la Ruta en la Maquina " + eaDSMAC;
         |MENAV aMensaje;
         |ACABA;
     |FINSI;

     aOrigen = #dsarm005#7;
     |QBF aOrigen;
     aOrigen = aOrigen + #dsarm005#9;
     |QBF aOrigen;

     aExtension = (aOrigen % -104) < "";
     aAlfa1 = aExtension % 101;
     |SI aAlfa1 ! ".";
          aExtension = (aOrigen % -105) < "";
     |FINSI;
     aExtension = aExtension % 2;
     |QBF aExtension;

     aAlfa = "w";
     |SI aExtension ! "doc";
         |SI aExtension = "xls";  aAlfa = "e";  |FINSI;
         |SI aExtension = "tif";  aAlfa = "g";  |FINSI;
         |SI aExtension = "pdf";  aAlfa = "g";  |FINSI;
     |FINSI;

     |SI #1002#1 [ 999;
         aNombreDestino = aAlfa + (("00000000" + #1002#0) % -108) + (("000" + #1002#1) % -103) + "." + aExtension;
     |SINO;
         aNombreDestino = aAlfa + (("00000000" + #1002#0) % -108) + (("00000" + #1002#1) % -105) + "." + aExtension;
     |FINSI;

     aDestino = aRutaDocumento + "/" + aNombreDestino;

     |SI #dsarm001#7 = "N"; |Y aModoArchivo = "C";
          |COPIA_FICHERO aOrigen, aDestino;
     |SINO;
          |SI #dsarm001#7 = "N"; |Y aModoArchivo ! "C";
               aIPRemotoCopia = "";
               |IP_REMOTO aIPRemotoCopia;  |QBT aIPRemotoCopia;
               |SI aIPRemotoCopia ! "";
                    |ENVIA_FICHERO aOrigen, aDestino;
               |SINO;
                    |COPIA_FICHERO aOrigen, aDestino;
               |FINSI;
          |SINO;
               |SI #dsarm001#7 ! "N"; |Y aModoArchivo = "C";
                    aIPRemotoCopia = "";
                    |IP_REMOTO aIPRemotoCopia;  |QBT aIPRemotoCopia;
                    |SI aIPRemotoCopia ! "";
                         |RECIBE_FICHERO aOrigen, aDestino;
                    |SINO;
                         |COPIA_FICHERO aOrigen, aDestino;
                    |FINSI;
               |SINO;
                    |RCOPIA_FICHERO aOrigen, aDestino;
               |FINSI;
          |FINSI;
     |FINSI;
     ||ARA11. Falta copiar el documento.
|FPRC;

|PROCESO Boton5;
     |PTEC 807;
|FPRC;


|PROCESO Tipo12Fm033;  |TIPO 12;
|FPRC;

|PROCESO Tipo80Fm033;  |TIPO 80;
     |ABRET #5;

     FSalida = 2699;
|FPRC;

|PROCESO Tipo90Fm033;  |TIPO 90;
     |CIERRAT #5;
|FPRC;

|PROGRAMA;
     #5#0 = enDocumento;
     |LEE 101#5=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |DBASS aBase;
     |QBF aBase;
     aBase = aBase + "facturar/";
     aPathDef = aBase + "def/";
     aPathFich = aBase + "fich/";
     aDef = aPathDef + "facemp.mas";
     |CARGA_DEF aDef, facemp@;
     |SI FSalida ! 0;
          aMensaje = "0000Problemas CargaDef del fichero: " + aDef;
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     aDef = aPathDef + "asclient.mas";
     |CARGA_DEF aDef, asclient@;
     |SI FSalida ! 0;
          aMensaje = "0000Problemas CargaDef del fichero: " + aDef;
          |MENAV aMensaje;
          |DESCARGA_DEF #facemp@;
          |ACABA;
     |FINSI;

     aDef = aPathDef + "abom0001.mas";
     |CARGA_DEF aDef, abom0001@;
     |SI FSalida ! 0;
          aMensaje = "0000Problemas CargaDef del fichero: " + aDef;
          |MENAV aMensaje;
          |DESCARGA_DEF #asclient@;
          |DESCARGA_DEF #facemp@;
          |ACABA;
     |FINSI;

     aDef = aPathDef + "abom0002.mas";
     |CARGA_DEF aDef, abom0002@;
     |SI FSalida ! 0;
          aMensaje = "0000Problemas CargaDef del fichero: " + aDef;
          |MENAV aMensaje;
          |DESCARGA_DEF #abom0001@;
          |DESCARGA_DEF #asclient@;
          |DESCARGA_DEF #facemp@;
          |ACABA;
     |FINSI;

     aDef = aPathDef + "abom0020.mas";
     |CARGA_DEF aDef, abom0020@;
     |SI FSalida ! 0;
          aMensaje = "0000Problemas CargaDef del fichero: " + aDef;
          |MENAV aMensaje;
          |DESCARGA_DEF #abom0002@;
          |DESCARGA_DEF #abom0001@;
          |DESCARGA_DEF #asclient@;
          |DESCARGA_DEF #facemp@;
          |ACABA;
     |FINSI;

     |PATH_DAT #1004 aPathFich;

     |ABRE #dsarm033;

     |PINPA #0#dsarm033;
     nPanta = FSalida;
     |DDEFECTO #dsarm033;
     |LEE 000#dsarm033.=;
     #dsarm033#1 = #5#0;
     #dsarm033#2 = #5#4;
     #dsarm033#3 = #5#5;
     |PINDA #0#dsarm033;

     |CONTROL_SIMPLE nPanta, "BOTON,Seleccionar Empresa   ", 1403, 1420, Boton1;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,Seleccionar Cliente   ", 1603, 1620, Boton2;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,Seleccionar Expediente", 1803, 1820, Boton3;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,Vincular", 3175, 3185, Boton4;
     nBoton4 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,Salir", 3187, 3197, Boton5;
     nBoton5 = FSalida;

     |ENDATOS #1#dsarm033;
     |SI FSalida = 0;
          ||Controlar si esta todo correcto y en tal caso vincular
          ||No, ahora se vincula unicamente desde el boton Vincular.
     |FINSI;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton5;

     |DESCARGA_DEF #abom0020@;
     |DESCARGA_DEF #abom0002@;
     |DESCARGA_DEF #abom0001@;
     |DESCARGA_DEF #asclient@;
     |DESCARGA_DEF #facemp@;

     |CIERRA #dsarm033;
|FPRO;
