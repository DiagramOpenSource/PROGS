|VARIABLES;
     nInstala      = 0;
     nHandle       = 0;

     aDirBasico    = "";
     aDirDsPdf     = "";
     aAlfa         = "";
     aBase         = "";
     aAlfa1        = "";

     &eaOrigen     = "";
     &eaDestino    = "";
     &enSwNuevoMD5 = 0;

     &eaUnidadBasico = "";
|FIN;

|PROGRAMA;
     |HAZ LeeUnidadBasico;
     nInstala = 0;

     aDirBasico = eaUnidadBasico + "\ds";    |RMKDIR aDirBasico;
     aDirBasico = aDirBasico + "\bin";       |RMKDIR aDirBasico;
     aDirBasico = aDirBasico + "\";
     aDirDsPdf  = eaUnidadBasico + "\ds\dspdf\bin\";
     aAlfa      = aDirDsPdf + "puerto.exe";
     |XABRE "EC", aAlfa, nHandle;
     |SI FSalida < 0;  nInstala = 1;  |FINSI;

     |DBASE aBase;  |QBF aBase;

     eaOrigen  = aBase + "dlls/dspdf.tgz";
     eaDestino = aDirBasico + "dspdf.tgz";

     |HAZ EnviaFicheroConMD5;
     |SI enSwNuevoMD5 = 1;
         nInstala = 1;
     |FINSI;

     |SI nInstala = 1;
         aAlfa = aDirBasico + "dspdf.tgz";
         Pos   = -1;
         |RDESCOMPRIME aAlfa;
         aAlfa1 = eaUnidadBasico + "\ds\";
         |RDETAR aAlfa, aAlfa1;

         aAlfa = aDirBasico + "dspdf.tar";  |RFBORRA aAlfa;

         aAlfa = aDirDsPdf + "puerto.exe";
         |XABRE "EC", aAlfa, nHandle;
         |SI FSalida < 0;
             |MENAV "0000 No puedo instalar la impresora en PDF.";
             |ACABA;
         |FINSI;

         aAlfa  = "cmd " + &34 + "/c START /WAIT " + aDirDsPdf + "PUERTO.EXE" + &34;
         |RSYSTEM aAlfa;
     |FINSI;

     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;
|FPRO;
