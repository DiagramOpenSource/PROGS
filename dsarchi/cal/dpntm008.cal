|FICHEROS;
     dpntm008;

     dpntw016,MANTE;
|FIN;

|VARIABLES;
     n0Vent         = 0;
     n1Vent         = 0;
     nBtnNue        = 0;
     nBtnQui        = 0;
     nRango         = 0;
     nIde           = 0;

     aEsc1          = "";
     aEsc2          = "";
     aRetu          = "";
     aTecla         = "";
     aAlfa          = "";
     aHora          = "";
     aFecha         = "";
     aPathLab       = "";
     aMas           = "";

     fFecha         = @;

 {-1}aVent          = "";
     aVent1         = 0;
     aVent2         = 0;
     aVent3         = 0;
     aVent4         = 0;
     aVent5         = "";

     &enEmpresa       = 0;
     &enGrid8         = 0;
     &eaModoNet       = "";
     &eaUsuNet        = "";
     &eaFechaNet      = "";
     &eaAccesoNet     = "";
     &eaEmpNet        = "";
     &eaTraNet        = "";
     &eaAccNet        = "";
     &eaMaiNet        = "";
     &eaDesNet        = "";
     &eaLabNet        = "";
|FIN;

|PROCESO NuevoAcceso;
     |VENTANA 0501, 1680, -1, 16, "Nuevo Acceso";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |DDEFECTO #dpntw016;

     |PINPA #0#dpntw016;
     |PINDA #0#dpntw016;
     |ENDATOS #2#dpntw016;
     |SI FSalida = 0;
         #dpntm008#0 = #dpntw016#0;
         #dpntm008#1 = 999;
         |LEE 000#dpntm008.];
         |SI FSalida = 0;
             |LEE 000#dpntm008.a;
         |SINO;
             |LEE 000#dpntm008.u;
         |FINSI;

         nIde = 1;
         |SI FSalida = 0;  |Y #dpntm008#0 = #dpntw016#0;
             nIde = #dpntm008#1 + 1;
         |FINSI;

         #dpntm008#0 = #dpntw016#0;
         #dpntm008#1 = nIde;
         #dpntm008#2 = #dpntw016#2;

         |GRABA 020#dpntm008.n;
         |LIBERA #dpntm008;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;

     |REFRESCACONTROL enGrid8;
     |FOCOTECLADO enGrid8;
|FPRC;

|PROCESO QuitarAcceso;
     |CONFI "0000NSeguro que quiere quitar el acceso";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |LEE 101#dpntm008.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BORRA 020#dpntm008.a;
     |LIBERA #dpntm008;

     |REFRESCACONTROL enGrid8;
     |FOCOTECLADO enGrid8;
|FPRC;

|PROCESO Evnt8;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#dpntm008.=;

         |ESTADO_CONTROL nBtnQui, "ENABLE";
     |FINSI;

     |SI FSalida = 4;
     |FINSI;
|FPRC;

|PROGRAMA;
     |CLS;
     |CABEZA "Accesos agrupaciones DESPABOX";

     aAlfa = "Accesos agrupaciones DESPABOX ";  |QBF aAlfa;
     |VENTANA 0501, 2899, -1, 16, aAlfa;
     n0Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |CONTROL_SIMPLE 0, "BOTON,Nuevo acceso", 2502, 2614, NuevoAcceso;
     nBtnNue = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,Quitar acceso", 2516, 2628, QuitarAcceso;
     nBtnQui = FSalida;

     |ESTADO_CONTROL nBtnQui, "DISABLE";

     nRango = 4 + 8 + 16 + 32 + 128;

     |LINEAL_SIMPLE #1#dpntm008, nRango, 0602, 2498, NULL, NULL, Evnt8;
     enGrid8 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + enGrid8;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |DESTRUYECONTROL enGrid8;

     |FIN_CONTROL_WINDOWS nBtnNue;
     |FIN_CONTROL_WINDOWS nBtnQui;
     |FIN_CONTROL_WINDOWS nBtnQui;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n0Vent;
|FPRO;

|PROCESO dpntm008Quita;
     aAlfa = #dpntm008#2;  |QBT aAlfa;

     #dpntm008#2 = aAlfa;

     |GRABA 020#dpntm008.a;
     |LIBERA #dpntm008;
|FPRC;

|DEFBUCLE dpntm008Quita;
     #dpntm008#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, dpntm008Quita;
|FIN;

|PROCESO T80;  |TIPO 80;
     |BUCLE dpntm008Quita;

     |ABRET #dpntm008;
|FPRC;

|PROCESO T90;  |TIPO 90;
     |CIERRAT #dpntm008;
|FPRC;
