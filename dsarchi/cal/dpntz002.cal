|FICHEROS;
     dpntz002 #0;
     dsarm001 #1;

     dpntm000 #800;
     dpntm001 #801;
     dpntm100 #700;
     dpntm101 #701;
     dpntm102 #702;
     dpntm103 #703;

     dsarw010 #910;
     dpntw100 #900;
     dpntw101 #901;

     dsarm034;

     registro@ #1700;
|FIN;

|VARIABLES;
     nSwSMTPServPropio = 0;
     aVarSMTP = "";
     aVarUsuario = "";
     aVarPassword = "";
     aAlfa2 = "";

     nNumReg = 0;

     nCampo           = 0;
     nCampo1          = 0;
     nFichero         = 0;
     nPanta           = 0;
     nSubPan          = 0;
     nRango           = 0;
     nReg             = 0;
     nVent            = 0;
     nGrid1           = 0;
     nGrid2           = 0;
     nGrid3           = 0;
     nGrid4           = 0;
     nBoton1          = -1;
     nBoton2          = -1;
     nBoton3          = -1;
     nBoton4          = -1;
     nSubBoton1       = -1;
     nSubBoton2       = -1;
     nSubBoton3       = -1;
     nSubBoton4       = -1;
     nHandle          = 0;
     nHandle1         = 0;
     nHandle2         = 0;
     nCorreo          = 0;
     nLong            = 0;
     nPos             = 0;
     nPosi            = 0;
     nLLave           = 0;
     nRegilla         = 0;
     nTipoEntrada     = 0;
     nDsCorreo        = 0;

     aAlfa            = "";
     aAlfa1           = "";
     aPara            = "";
     aAsunto          = "";
     aFicheroAdjunto  = "";
     aEjecuta         = "";
     aNombre          = "";
     aBasePla         = "";
     aEsc1            = "";
     aEsc2            = "";
     aRetu            = "";
     aTecla           = "";
     aBase            = "";
     aDirLocal        = "";
     aFotoOrigen      = "";
     aFotoDestino     = "";
     aExt             = "";
     aNLogo           = "";
     aDocRemoto       = "";
     aDocServidor     = "";
     aIPRemoto        = "";
     aLong            = "";
     aTo              = "";
     aFrase           = "";
     aDirec           = "";
     aCarac           = "";
     aConten          = "";
     aEmpresa         = "";
     aTipo            = "";
     aMas             = "";
     aDef             = "";
     aReg             = "";
     aBaseMensaje     = "";
     aCarac10         = "";
     aAbre            = "";
     aIP              = "";
     aSalida          = "";
     aFrom            = "";
     aMensaje         = "";
     aAutenti         = "";
     aAbreHTMO        = "";
     aAbreHTMD        = "";
     aAbreTXT         = "";
     aAbreTXTO        = "";
     aAbreTXTD        = "";
     aAbreFIN         = "";

     {1}aContiene     = "";

     {-1}aVent        = "";
         aVent1       = 0;
         aVent2       = 0;
         aVent3       = 0;
         aVent4       = 0;
         aVent5       = "";

     &eaPathNet       = "";
     &eaUsuario       = "";
     &eaAlfa          = "";
     &eaUnidadBasico  = "";
     &eaPrograma      = "";
     &enAprobacion    = "";
     &eaTitulo        = "";
|FIN;

|PROCESO CamposAyudaFw100;
     |SI nTipoEntrada = 2;  |O nTipoEntrada = 4;
         |ACABA;
     |FINSI;

     |HAZ Tipo0C1Fw100;
     |HAZ Tipo7C5Fw100;
     |HAZ Tipo0C5Fw100;
     |HAZ Tipo0C6Fw100;
     |HAZ Tipo0C8Fw100;
|FPRC;

|PROCESO Evento1;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#700=;
         |SI FSalida ! 0;
             |DDEFECTO #700;
         |FINSI;

         |PULSATECLA;

         |SI nTipoEntrada ! 1;  |Y nTipoEntrada ! 4;
             |PARA nCampo = 30;  |SI nCampo [ 43;  |HACIENDO nCampo = nCampo + 1;
                   |C_V #900nCampo, 1, "N";
             |SIGUE;
         |FINSI;

         |DDEFECTO #900;
         |PARA nCampo = 0;  |SI nCampo [ 45;  |HACIENDO nCampo = nCampo + 1;
               #900nCampo = #700nCampo;

               |C_V #900nCampo, 0, aAlfa;
               |SI aAlfa = "S";  |PINTA #900nCampo;  |FINSI;
         |SIGUE;

         |HAZ CamposAyudaFw100;
     |FINSI;
|FPRC;

|PROCESO CamposAyudaFw101;
     |SI nTipoEntrada = 2;  |O nTipoEntrada = 4;
         |ACABA;
     |FINSI;

     |HAZ Tipo0C1Fw101;
     |HAZ Tipo7C5Fw101;
     |HAZ Tipo0C5Fw101;
     |HAZ Tipo0C6Fw101;
     |HAZ Tipo0C8Fw101;
|FPRC;

|PROCESO Evento2;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#701=;
         |SI FSalida ! 0;
             |DDEFECTO #701;
         |FINSI;

         |PULSATECLA;

         |SI nTipoEntrada ! 1;   |Y nTipoEntrada ! 4;
             |PARA nCampo = 30;  |SI nCampo [ 43;  |HACIENDO nCampo = nCampo + 1;
                   |C_V #901nCampo, 1, "N";
             |SIGUE;
         |FINSI;

         |DDEFECTO #901;
         |PARA nCampo = 0;  |SI nCampo [ 45;  |HACIENDO nCampo = nCampo + 1;
               #901nCampo = #701nCampo;

               |C_V #901nCampo, 0, aAlfa;
               |SI aAlfa = "S";  |PINTA #901nCampo;  |FINSI;
         |SIGUE;

         |HAZ CamposAyudaFw101;
     |FINSI;

     |SI FSalida = 4;
         |SI nTipoEntrada = 4;
             |HAZ Contabilizar;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Evento3;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#702=;
         |SI FSalida ! 0;
             |DDEFECTO #702;
         |FINSI;

         |PULSATECLA;

         |DDEFECTO #900;
         |PARA nCampo = 0;  |SI nCampo [ 28;  |HACIENDO nCampo = nCampo + 1;
               #900nCampo = #702nCampo;

               |C_V #900nCampo, 0, aAlfa;
               |SI aAlfa = "S";  |PINTA #900nCampo;  |FINSI;
         |SIGUE;

         |PARA nCampo = 30;  |SI nCampo [ 43;  |HACIENDO nCampo = nCampo + 1;
               nCampo1    = nCampo + 1;
               #900nCampo = #702nCampo1;

               |C_V #900nCampo, 0, aAlfa;
               |SI aAlfa = "S";  |PINTA #900nCampo;  |FINSI;
         |SIGUE;

         |HAZ CamposAyudaFw100;
     |FINSI;
|FPRC;

|PROCESO Evento4;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#703=;
         |SI FSalida ! 0;
             |DDEFECTO #703;
         |FINSI;

         |PULSATECLA;

         |DDEFECTO #901;
         |PARA nCampo = 0;  |SI nCampo [ 28;  |HACIENDO nCampo = nCampo + 1;
               #901nCampo = #703nCampo;

               |C_V #901nCampo, 0, aAlfa;
               |SI aAlfa = "S";  |PINTA #901nCampo;  |FINSI;
         |SIGUE;

         |PARA nCampo = 30;  |SI nCampo [ 43;  |HACIENDO nCampo = nCampo + 1;
               nCampo1    = nCampo + 1;
               #901nCampo = #703nCampo1;

               |C_V #901nCampo, 0, aAlfa;
               |SI aAlfa = "S";  |PINTA #901nCampo;  |FINSI;
         |SIGUE;

         |HAZ CamposAyudaFw101;
     |FINSI;
|FPRC;

|PROCESO registro;
     |BORRA 020#1700a;
     |LIBERA #1700;
|FPRC;

|DEFBUCLE registro;
     #1700#4002;
     ;
     #700#0, 000001;
     #700#0, 999999;
     be;
     NULL, registro;
|FIN;

|PROCESO Baja1700;
     |DBASE aBase;  |QBF aBase;
     aMas  = aBase + "def/" + aDef;
     |CARGA_DEF aMas, registro@;
     |SI FSalida = 0;
         |PATH_DAT #1700 eaPathNet;

         |BUCLE registro;

         |DESCARGA_DEF #registro@;
     |FINSI;
|FPRC;

|PROCESO EntraDatos900;
     |DDEFECTO #900;

     aDef = "dpntm100.mas";  |HAZ Baja1700;

     |PARA nCampo = 0;  |SI nCampo [ 45;  |HACIENDO nCampo = nCampo + 1;
            #900nCampo = #700nCampo;

            |C_V #900nCampo, 0, aAlfa;
            |SI aAlfa = "S";  |PINTA #900nCampo;  |FINSI;
     |SIGUE;

     |HAZ CamposAyudaFw100;

     |PULSATECLA;
     |ENDATOS #1#900;
|FPRC;

|PROCESO EntraDatos901;
     |DDEFECTO #901;

     aDef = "dpntm101.mas";  |HAZ Baja1700;

     |PARA nCampo = 0;  |SI nCampo [ 45;  |HACIENDO nCampo = nCampo + 1;
            #901nCampo = #701nCampo;

            |C_V #901nCampo, 0, aAlfa;
            |SI aAlfa = "S";  |PINTA #901nCampo;  |FINSI;
     |SIGUE;

     |HAZ CamposAyudaFw101;

     |PULSATECLA;
     |ENDATOS #1#901;
|FPRC;

|PROCESO BuscaCodigo;
     #1700#0 = #700#0 + 1;
     |PARA;  |SI;  |HACIENDO;
          |LEE 000#1700=;
          |SI FSalida ! 0;
              nReg = #1700#0;
              |SAL;
          |FINSI;
          #1700#0 = #1700#0 + 1;
     |SIGUE;

     |PULSATECLA;
|FPRC;

|PROCESO Graba1700_desde701;

     |DBASE aBase;  |QBF aBase;
     aMas  = aBase + "def/" + aDef;
     |CARGA_DEF aMas, registro@;
     |SI FSalida ! 0;   |ACABA;  |FINSI;

     |PATH_DAT #1700 eaPathNet;

     |ABRE #1700;
     |SELECT #1#1700;

     |SI #701#30 ! 0;
         |HAZ BuscaCodigo;

         |PARA nCampo = 1;  |SI nCampo [ 45;  |HACIENDO nCampo = nCampo + 1;
               #1700nCampo = #701nCampo;
         |SIGUE;

         #1700#0  = nReg;
         #1700#44 = "N";
         #1700#45 = #701#0;

         #1700#21 = #701#30;
         #1700#22 = #701#31;
         #1700#23 = #701#32;
         #1700#24 = #701#33;
         #1700#25 = #701#34;
         #1700#26 = #701#35;
         #1700#27 = #701#36;
         #1700#30 = #701#21;
         #1700#31 = #701#22;
         #1700#32 = #701#23;
         #1700#33 = #701#24;
         #1700#34 = #701#25;
         #1700#35 = #701#26;
         #1700#36 = #701#27;

         |GRABA 020#1700n;
         |LIBERA #1700;
     |FINSI;

     |SI #701#37 ! 0;
         |HAZ BuscaCodigo;

         |PARA nCampo = 1;  |SI nCampo [ 45;  |HACIENDO nCampo = nCampo + 1;
               #1700nCampo = #701nCampo;
         |SIGUE;

         #1700#0  = nReg;
         #1700#44 = "N";
         #1700#45 = #701#0;

         #1700#21 = #701#37;
         #1700#22 = #701#38;
         #1700#23 = #701#39;
         #1700#24 = #701#40;
         #1700#25 = #701#41;
         #1700#26 = #701#42;
         #1700#27 = #701#43;
         #1700#37 = #701#21;
         #1700#38 = #701#22;
         #1700#39 = #701#23;
         #1700#40 = #701#24;
         #1700#41 = #701#25;
         #1700#42 = #701#26;
         #1700#43 = #701#27;

         |GRABA 020#1700n;
         |LIBERA #1700;
     |FINSI;

     |CIERRA #1700;

     |DESCARGA_DEF #registro@;
|FPRC;

|PROCESO Graba1700;
     |DBASE aBase;  |QBF aBase;
     aMas  = aBase + "def/" + aDef;
     |CARGA_DEF aMas, registro@;
     |SI FSalida ! 0;   |ACABA;  |FINSI;

     |PATH_DAT #1700 eaPathNet;

     |ABRE #1700;
     |SELECT #1#1700;

     |SI #700#30 ! 0;
         |HAZ BuscaCodigo;

         |PARA nCampo = 1;  |SI nCampo [ 45;  |HACIENDO nCampo = nCampo + 1;
               #1700nCampo = #700nCampo;
         |SIGUE;

         #1700#0  = nReg;
         #1700#44 = "N";
         #1700#45 = #700#0;

         #1700#21 = #700#30;
         #1700#22 = #700#31;
         #1700#23 = #700#32;
         #1700#24 = #700#33;
         #1700#25 = #700#34;
         #1700#26 = #700#35;
         #1700#27 = #700#36;
         #1700#30 = #700#21;
         #1700#31 = #700#22;
         #1700#32 = #700#23;
         #1700#33 = #700#24;
         #1700#34 = #700#25;
         #1700#35 = #700#26;
         #1700#36 = #700#27;

         |GRABA 020#1700n;
         |LIBERA #1700;
     |FINSI;

     |SI #700#37 ! 0;
         |HAZ BuscaCodigo;

         |PARA nCampo = 1;  |SI nCampo [ 45;  |HACIENDO nCampo = nCampo + 1;
               #1700nCampo = #700nCampo;
         |SIGUE;

         #1700#0  = nReg;
         #1700#44 = "N";
         #1700#45 = #700#0;

         #1700#21 = #700#37;
         #1700#22 = #700#38;
         #1700#23 = #700#39;
         #1700#24 = #700#40;
         #1700#25 = #700#41;
         #1700#26 = #700#42;
         #1700#27 = #700#43;
         #1700#37 = #700#21;
         #1700#38 = #700#22;
         #1700#39 = #700#23;
         #1700#40 = #700#24;
         #1700#41 = #700#25;
         #1700#42 = #700#26;
         #1700#43 = #700#27;

         |GRABA 020#1700n;
         |LIBERA #1700;
     |FINSI;

     |CIERRA #1700;

     |DESCARGA_DEF #registro@;
|FPRC;

|PROCESO Alta;
     |SI nBoton1 ! -1;  |ESTADO_CONTROL nBoton1, "DISABLE";  |FINSI;
     |SI nBoton2 ! -1;  |ESTADO_CONTROL nBoton2, "DISABLE";  |FINSI;
     |SI nBoton3 ! -1;  |ESTADO_CONTROL nBoton3, "DISABLE";  |FINSI;
     |SI nBoton4 ! -1;  |ESTADO_CONTROL nBoton4, "DISABLE";  |FINSI;

     |SI nSubBoton1 ! -1;  |ESTADO_CONTROL nSubBoton1, "DISABLE";  |FINSI;
     |SI nSubBoton2 ! -1;  |ESTADO_CONTROL nSubBoton2, "DISABLE";  |FINSI;
     |SI nSubBoton3 ! -1;  |ESTADO_CONTROL nSubBoton3, "DISABLE";  |FINSI;

     |HAZ QuitaBotonSalir;

     |SI nFichero = 1;
         |ESTADO_CONTROL nGrid1, "DISABLE";

         |DBASE aBase;  |QBF aBase;
         aMas  = aBase + "def/dpntm100.mas";
         |CARGA_DEF aMas, registro@;
         |SI FSalida ! 0;   |ACABA;  |FINSI;

         |PATH_DAT #1700 eaPathNet;

         |ABRE #1700;
         |SELECT #1#700;
         |LEE 000#1700u;
         |SI FSalida ! 0;  #1700#0 = 0;  |FINSI;
         |CIERRA #1700;

         nReg = #1700#0 + 1;

         |DESCARGA_DEF #registro@;

         |DDEFECTO #700;
         #700#0  = nReg;
         |GRABA 020#700n;
         |LIBERA #700;

         |HAZ EntraDatos900;

         |SI FSalida = 0;
             #700#0  = nReg;
             |LEE 101#700=;

             |PARA nCampo = 1;  |SI nCampo [ 45;  |HACIENDO nCampo = nCampo + 1;
                   #700nCampo = #900nCampo;
             |SIGUE;

             #700#44 = "S";

             |GRABA 020#700a;
             |LIBERA #700;

             |SI #700#30 ! 0;  |O #700#37 ! 0;
                 |HAZ Graba1700;
             |FINSI;

             nCorreo = 1;
         |SINO;
             #700#0  = nReg;
             |LEE 101#700=;

             |BORRA 020#700a;
         |FINSI;
         |LIBERA #700;

         |REFRESCACONTROL nGrid1;
         |FOCOTECLADO nGrid1;

         |SI nBoton1 ! -1;  |ESTADO_CONTROL nBoton1, "DISABLE";  |FINSI;
         |SI nBoton2 ! -1;  |ESTADO_CONTROL nBoton2, "ENABLE";   |FINSI;
         |SI nBoton3 ! -1;  |ESTADO_CONTROL nBoton3, "ENABLE";   |FINSI;
         |SI nBoton4 ! -1;  |ESTADO_CONTROL nBoton4, "ENABLE";   |FINSI;

         |ESTADO_CONTROL nGrid1,  "ENABLE";
     |FINSI;

     |SI nFichero = 2;
         |ESTADO_CONTROL nGrid2, "DISABLE";

         |DBASE aBase;  |QBF aBase;
         aMas  = aBase + "def/dpntm101.mas";
         |CARGA_DEF aMas, registro@;
         |SI FSalida ! 0;   |ACABA;  |FINSI;

         |PATH_DAT #1700 eaPathNet;

         |ABRE #1700;
         |SELECT #1#700;
         |LEE 000#1700u;
         |SI FSalida ! 0;  #1700#0 = 0;  |FINSI;
         |CIERRA #1700;

         nReg = #1700#0 + 1;

         |DESCARGA_DEF #registro@;

         |DDEFECTO #701;
         #701#0  = nReg;
         |GRABA 020#701n;
         |LIBERA #701;

         |HAZ EntraDatos901;

         |SI FSalida = 0;
             #701#0  = nReg;
             |LEE 101#701=;

             |PARA nCampo = 1;  |SI nCampo [ 45;  |HACIENDO nCampo = nCampo + 1;
                   #701nCampo = #901nCampo;
             |SIGUE;

             #701#44 = "S";

             |GRABA 020#701a;
             |LIBERA #701;

             |SI #701#30 ! 0;  |O #701#37 ! 0;
                 |HAZ Graba1700_desde701;
             |FINSI;

             nCorreo = 1;
         |SINO;
             #701#0  = nReg;
             |LEE 101#701=;

             |BORRA 020#701a;
         |FINSI;
         |LIBERA #701;

         |REFRESCACONTROL nGrid2;
         |FOCOTECLADO nGrid2;

         |SI nBoton2 ! -1;  |ESTADO_CONTROL nBoton2, "DISABLE";  |FINSI;
         |SI nBoton1 ! -1;  |ESTADO_CONTROL nBoton1, "ENABLE";   |FINSI;
         |SI nBoton3 ! -1;  |ESTADO_CONTROL nBoton3, "ENABLE";   |FINSI;
         |SI nBoton4 ! -1;  |ESTADO_CONTROL nBoton4, "ENABLE";   |FINSI;

         |ESTADO_CONTROL nGrid2,  "ENABLE";
     |FINSI;

     |SI nSubBoton1 ! -1;  |ESTADO_CONTROL nSubBoton1, "ENABLE";  |FINSI;
     |SI nSubBoton2 ! -1;  |ESTADO_CONTROL nSubBoton2, "ENABLE";  |FINSI;
     |SI nSubBoton3 ! -1;  |ESTADO_CONTROL nSubBoton3, "ENABLE";  |FINSI;

     |HAZ PonBotonSalir;
|FPRC;

|PROCESO Modificar;
     |SI nBoton1 ! -1;  |ESTADO_CONTROL nBoton1, "DISABLE";  |FINSI;
     |SI nBoton2 ! -1;  |ESTADO_CONTROL nBoton2, "DISABLE";  |FINSI;
     |SI nBoton3 ! -1;  |ESTADO_CONTROL nBoton3, "DISABLE";  |FINSI;
     |SI nBoton4 ! -1;  |ESTADO_CONTROL nBoton4, "DISABLE";  |FINSI;

     |SI nSubBoton1 ! -1;  |ESTADO_CONTROL nSubBoton1, "DISABLE";  |FINSI;
     |SI nSubBoton2 ! -1;  |ESTADO_CONTROL nSubBoton2, "DISABLE";  |FINSI;
     |SI nSubBoton3 ! -1;  |ESTADO_CONTROL nSubBoton3, "DISABLE";  |FINSI;

     |HAZ QuitaBotonSalir;

     |SI nFichero = 1;
         |ESTADO_CONTROL nGrid1, "DISABLE";

         |LEE 101#700=;
         |SI FSalida = 0;
             |HAZ EntraDatos900;
             |SI FSalida = 0;
                |PARA nCampo = 1;  |SI nCampo [ 45;  |HACIENDO nCampo = nCampo + 1;
                      #700nCampo = #900nCampo;
                |SIGUE;
                #700#44 = "S";

                |GRABA 020#700a;
                |LIBERA #700;

                |SI #700#30 ! 0;  |O #700#37 ! 0;
                    |HAZ Graba1700;
                |FINSI;

                nCorreo = 1;

                |REFRESCACONTROL nGrid1;
                |FOCOTECLADO nGrid1;
             |FINSI;
         |FINSI;

         |SI nBoton1 ! -1;  |ESTADO_CONTROL nBoton1, "DISABLE";  |FINSI;
         |SI nBoton2 ! -1;  |ESTADO_CONTROL nBoton2, "ENABLE";   |FINSI;
         |SI nBoton3 ! -1;  |ESTADO_CONTROL nBoton3, "ENABLE";   |FINSI;
         |SI nBoton4 ! -1;  |ESTADO_CONTROL nBoton4, "ENABLE";   |FINSI;

         |ESTADO_CONTROL nGrid1,  "ENABLE";
     |FINSI;

     |SI nFichero = 2;
         |ESTADO_CONTROL nGrid2, "DISABLE";

         |LEE 101#701=;
         |SI FSalida = 0;
             |HAZ EntraDatos901;
             |SI FSalida = 0;
                |PARA nCampo = 1;  |SI nCampo [ 45;  |HACIENDO nCampo = nCampo + 1;
                      #701nCampo = #901nCampo;
                |SIGUE;
                #701#44 = "S";

                |GRABA 020#701a;
                |LIBERA #701;

                |SI #701#30 ! 0;  |O #701#37 ! 0;
                    |HAZ Graba1700_desde701;
                |FINSI;

                nCorreo = 1;

                |REFRESCACONTROL nGrid2;
                |FOCOTECLADO nGrid2;
             |FINSI;
         |FINSI;

         |SI nBoton2 ! -1;  |ESTADO_CONTROL nBoton2, "DISABLE";  |FINSI;
         |SI nBoton1 ! -1;  |ESTADO_CONTROL nBoton1, "ENABLE";   |FINSI;
         |SI nBoton3 ! -1;  |ESTADO_CONTROL nBoton3, "ENABLE";   |FINSI;
         |SI nBoton4 ! -1;  |ESTADO_CONTROL nBoton4, "ENABLE";   |FINSI;

         |ESTADO_CONTROL nGrid2,  "ENABLE";
     |FINSI;

     |SI nSubBoton1 ! -1;  |ESTADO_CONTROL nSubBoton1, "ENABLE";  |FINSI;
     |SI nSubBoton2 ! -1;  |ESTADO_CONTROL nSubBoton2, "ENABLE";  |FINSI;
     |SI nSubBoton3 ! -1;  |ESTADO_CONTROL nSubBoton3, "ENABLE";  |FINSI;

     |HAZ PonBotonSalir;
|FPRC;

|PROCESO Baja;
     |SI nFichero = 1;
         |LEE 101#700=;
         |SI FSalida = 0;
             |CONFI "0000 Confirma la baja del registro seleccionado";
             |SI FSalida ! 0;
                 |LIBERA #700;
                 |ACABA;
             |FINSI;

             aDef = "dpntm100.mas";  |HAZ Baja1700;

             |BORRA 020#700a;
             |LIBERA #700;

             |REFRESCACONTROL nGrid1;
             |FOCOTECLADO nGrid1;
         |FINSI;
     |FINSI;

         |REFRESCACONTROL nGrid1;
     |SI nFichero = 2;
         |LEE 101#701=;
         |SI FSalida = 0;
             |CONFI "0000 Confirma la baja del registro seleccionado";
             |SI FSalida ! 0;
                 |LIBERA #701;
                 |ACABA;
             |FINSI;

             aDef = "dpntm101.mas";  |HAZ Baja1700;

             |BORRA 020#701a;
             |LIBERA #701;

             |REFRESCACONTROL nGrid2;
             |FOCOTECLADO nGrid2;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Contabilizar;
     |ABRE #dsarm034;
     |SELECT #2#dsarm034;

     |SI nFichero = 2;  #dsarm034#16 = #701#50;  nReg = #701#0;  |FINSI;

     |LEE 000#dsarm034.=;
     |SI FSalida ! 0;
         |MENAV "0000No encuentro el registro en la bandeja dsEscan";
         |CIERRA #dsarm034;
         |ACABA;
     |FINSI;
     |CIERRA #dsarm034;

     aEjecuta = "|:contagen/gadz0001 canempr1 " + (("00000" + #dsarm034#18) % -105) + #dsarm034#19;
     aEjecuta = aEjecuta + ";" + nReg;
     |SUB_EJECUTA_NP aEjecuta;

     |SI nFichero = 1;
         |REFRESCACONTROL nGrid1;
         |FOCOTECLADO nGrid1;
     |FINSI;

     |SI nFichero = 2;
         |REFRESCACONTROL nGrid2;
         |FOCOTECLADO nGrid2;
     |FINSI;

     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;
|FPRC;

|PROCESO VerFactura;
     ||ARA38
     nNumReg = 0;

     |SI nFichero = 2;
          nNumReg = #701#50
     |FINSI;

     |SI nNumReg = 0;
          aMensaje = "0000No hay n£mero de registro en DsArchi.";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     aEjecuta = "|:dsarchi/dsarz047;" + nNumReg;
     |SUB_EJECUTA aEjecuta;
|FPRC;

|PROCESO Recoger;

     aAbre = eaPathNet + "recoger.txt";

     |XABRE "WB", aAbre, nHandle1;

     |SI nFichero = 1;
         aAlfa = (("000000" + #700#0) % -106) + &13 + &10;
     |FINSI;

     |SI nFichero = 2;
         aAlfa = (("000000" + #701#0) % -106) + &13 + &10;
     |FINSI;

     |XGRABA nHandle1, aAlfa;

     |XCIERRA nHandle1;

     |PTEC 806;
|FPRC;

|PROCESO BotonesSubPanta;
     |SI nTipoEntrada = 1;
         |CONTROL_SIMPLE nSubPan, "BOTON,{{193}}Alta ", 1364, 1374, Alta;
         nSubBoton1 = FSalida;

         |CONTROL_SIMPLE nSubPan, "BOTON,{{197}}Modificar ", 1376, 1386, Modificar;
         nSubBoton2 = FSalida;

         |CONTROL_SIMPLE nSubPan, "BOTON,{{199}}Borrar", 1388, 1398, Baja;
         nSubBoton3 = FSalida;
     |FINSI;

     |SI nTipoEntrada = 2;
         |CONTROL_SIMPLE nSubPan, "BOTON,{{197}}Recoger", 1388, 1398, Recoger;
         nSubBoton1 = FSalida;

         |CONTROL_SIMPLE nSubPan, "BOTON,{{197}}Ver Factura", 1372, 1386, VerFactura;
         nSubBoton4 = FSalida;
     |FINSI;

     |SI nTipoEntrada = 4;
         |CONTROL_SIMPLE nSubPan, "BOTON,{{197}}Contabilizar", 1385, 1398, Contabilizar;
         nSubBoton1 = FSalida;
     |FINSI;
|FPRC;

|PROCESO Baja700_2;
     #700#29 = "N";
     #700#0  = 1;
|FPRC;

|PROCESO Alta700_2;
     #700#29 = "N";
     #700#0  = 999999;
|FPRC;

|PROCESO Baja700_3;
     #700#44 = "S";
     #700#0  = 1;
|FPRC;

|PROCESO Alta700_3;
     #700#44 = "S";
     #700#0  = 999999;
|FPRC;

|PROCESO Baja701_2;
     #701#29 = "N";
     #701#0  = 1;
|FPRC;

|PROCESO Alta701_2;
     #701#29 = "N";
     #701#0  = 999999;
|FPRC;

|PROCESO Baja701_3;
     #701#44 = "S";
     #701#0  = 1;
|FPRC;

|PROCESO Alta701_3;
     #701#44 = "S";
     #701#0  = 999999;
|FPRC;

|PROCESO Boton1;
     |SI nFichero = 1;
         |DESTRUYECONTROL nGrid1;

         |SI nSubBoton1 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton1;  |FINSI;
         |SI nSubBoton2 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton2;  |FINSI;
         |SI nSubBoton3 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton3;  |FINSI;

         nGrid1 = -1;
         |PTEC 806;
     |FINSI;

     |SI nFichero = 2;
         |DESTRUYECONTROL nGrid2;

         |SI nSubBoton1 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton1;  |FINSI;
         |SI nSubBoton2 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton2;  |FINSI;
         |SI nSubBoton3 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton3;  |FINSI;

         nGrid2 = -1;
         |PTEC 806;
     |FINSI;

     |SI nFichero = 3;
         |DESTRUYECONTROL nGrid3;

         |SI nSubBoton1 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton1;  |FINSI;
         |SI nSubBoton2 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton2;  |FINSI;
         |SI nSubBoton3 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton3;  |FINSI;

         nGrid3 = -1;
         |PTEC 806;
     |FINSI;

     |SI nFichero = 4;
         |DESTRUYECONTROL nGrid4;

         |SI nSubBoton1 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton1;  |FINSI;
         |SI nSubBoton2 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton2;  |FINSI;
         |SI nSubBoton3 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton3;  |FINSI;

         nGrid4 = -1;
         |PTEC 806;
     |FINSI;

     |PULSATECLA;
     |BORRA_HIJOS_PAN #0#0;
     |SUB_PINPA #0#900, nPanta;
     nSubPan =  FSalida;

     nRango = 4 + 8 + 16 + 32 + 128;

     |SI nTipoEntrada = 1;  |O nTipoEntrada = 4;
         |LINEAL_SIMPLE #3#700, nRango, 0602, 1298, Baja700_3, Alta700_3, Evento1;
     |FINSI;

     |SI nTipoEntrada = 2;
         |LINEAL_SIMPLE #2#700, nRango, 0602, 1298, Baja700_2, Alta700_2, Evento1;
     |FINSI;

     |SI nTipoEntrada = 3;
         |LINEAL_SIMPLE #1#700, nRango, 0602, 1298, NULL, NULL, Evento1;
     |FINSI;

     nGrid1 = FSalida;

     |SI nBoton1 ! -1;  |ESTADO_CONTROL nBoton1, "DISABLE";  |FINSI;
     |SI nBoton2 ! -1;  |ESTADO_CONTROL nBoton2, "ENABLE";   |FINSI;
     |SI nBoton3 ! -1;  |ESTADO_CONTROL nBoton3, "ENABLE";   |FINSI;
     |SI nBoton4 ! -1;  |ESTADO_CONTROL nBoton4, "ENABLE";   |FINSI;

     nFichero = 1;

     |HAZ BotonesSubPanta;

     FSalida = 1;  |HAZ Evento1;

     |SI nTipoEntrada = 3;
         #700#0 = aReg;
         |LEE 000#700=;
         |REFRESCACONTROL nGrid1;
     |FINSI;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::{{001}}Salir," + nGrid1;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;
          |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aTecla = "";
|FPRC;

|PROCESO Boton2;
     |SI nFichero = 1;
         |DESTRUYECONTROL nGrid1;

         |SI nSubBoton1 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton1;  |FINSI;
         |SI nSubBoton2 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton2;  |FINSI;
         |SI nSubBoton3 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton3;  |FINSI;

         nGrid1 = -1;
         |PTEC 806;
     |FINSI;

     |SI nFichero = 2;
         |DESTRUYECONTROL nGrid2;

         |SI nSubBoton1 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton1;  |FINSI;
         |SI nSubBoton2 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton2;  |FINSI;
         |SI nSubBoton3 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton3;  |FINSI;

         nGrid2 = -1;
         |PTEC 806;
     |FINSI;

     |SI nFichero = 3;
         |DESTRUYECONTROL nGrid3;

         |SI nSubBoton1 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton1;  |FINSI;
         |SI nSubBoton2 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton2;  |FINSI;
         |SI nSubBoton3 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton3;  |FINSI;

         nGrid3 = -1;
         |PTEC 806;
     |FINSI;

     |SI nFichero = 4;
         |DESTRUYECONTROL nGrid4;

         |SI nSubBoton1 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton1;  |FINSI;
         |SI nSubBoton2 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton2;  |FINSI;
         |SI nSubBoton3 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton3;  |FINSI;

         nGrid4 = -1;
         |PTEC 806;
     |FINSI;

     |PULSATECLA;
     |BORRA_HIJOS_PAN #0#0;
     |SUB_PINPA #0#901, nPanta;
     nSubPan =  FSalida;

     nRango = 4 + 8 + 16 + 32 + 128;

     |SI nTipoEntrada = 1;  |O nTipoEntrada = 4;
         |LINEAL_SIMPLE #3#701, nRango, 0602, 1298, Baja701_3, Alta701_3, Evento2;
     |FINSI;

     |SI nTipoEntrada = 2;
         |LINEAL_SIMPLE #2#701, nRango, 0602, 1298, Baja701_2, Alta701_2, Evento2;
     |FINSI;

     |SI nTipoEntrada = 3;
         |LINEAL_SIMPLE #1#701, nRango, 0602, 1298, NULL, NULL, Evento2;
     |FINSI;

     nGrid2 = FSalida;

     |SI nBoton2 ! -1;  |ESTADO_CONTROL nBoton2, "DISABLE";  |FINSI;
     |SI nBoton1 ! -1;  |ESTADO_CONTROL nBoton1, "ENABLE";   |FINSI;
     |SI nBoton3 ! -1;  |ESTADO_CONTROL nBoton3, "ENABLE";   |FINSI;
     |SI nBoton4 ! -1;  |ESTADO_CONTROL nBoton4, "ENABLE";   |FINSI;

     nFichero = 2;

     |HAZ BotonesSubPanta;

     FSalida = 1;  |HAZ Evento2;

     |SI nTipoEntrada = 3;
         #701#0 = aReg;
         |LEE 000#701=;
         |REFRESCACONTROL nGrid2;
     |FINSI;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::{{001}}Salir," + nGrid2;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;
          |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aTecla = "";
|FPRC;

|PROCESO Boton3;
     |SI nFichero = 1;
         |DESTRUYECONTROL nGrid1;

         |SI nSubBoton1 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton1;  |FINSI;
         |SI nSubBoton2 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton2;  |FINSI;
         |SI nSubBoton3 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton3;  |FINSI;

         nGrid1 = -1;
         |PTEC 806;
     |FINSI;

     |SI nFichero = 2;
         |DESTRUYECONTROL nGrid2;

         |SI nSubBoton1 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton1;  |FINSI;
         |SI nSubBoton2 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton2;  |FINSI;
         |SI nSubBoton3 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton3;  |FINSI;

         nGrid2 = -1;
         |PTEC 806;
     |FINSI;

     |SI nFichero = 3;
         |DESTRUYECONTROL nGrid3;

         |SI nSubBoton1 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton1;  |FINSI;
         |SI nSubBoton2 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton2;  |FINSI;
         |SI nSubBoton3 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton3;  |FINSI;

         nGrid3 = -1;
         |PTEC 806;
     |FINSI;

     |SI nFichero = 4;
         |DESTRUYECONTROL nGrid4;

         |SI nSubBoton1 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton1;  |FINSI;
         |SI nSubBoton2 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton2;  |FINSI;
         |SI nSubBoton3 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton3;  |FINSI;

         nGrid4 = -1;
         |PTEC 806;
     |FINSI;

     |PULSATECLA;
     |BORRA_HIJOS_PAN #0#0;
     |SUB_PINPA #0#900, nPanta;
     nSubPan =  FSalida;

     nRango = 4 + 8 + 16 + 32 + 128;

     |LINEAL_SIMPLE #1#702, nRango, 0602, 1298, NULL, NULL, Evento3;
     nGrid3 = FSalida;

     |SI nBoton3 ! -1;  |ESTADO_CONTROL nBoton3, "DISABLE";  |FINSI;
     |SI nBoton1 ! -1;  |ESTADO_CONTROL nBoton1, "ENABLE";   |FINSI;
     |SI nBoton2 ! -1;  |ESTADO_CONTROL nBoton2, "ENABLE";   |FINSI;
     |SI nBoton4 ! -1;  |ESTADO_CONTROL nBoton4, "ENABLE";   |FINSI;

     nFichero = 3;

     FSalida = 1;  |HAZ Evento3;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::{{001}}Salir," + nGrid3;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;
          |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aTecla = "";
|FPRC;

|PROCESO Boton4;
     |SI nFichero = 1;
         |DESTRUYECONTROL nGrid1;

         |SI nSubBoton1 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton1;  |FINSI;
         |SI nSubBoton2 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton2;  |FINSI;
         |SI nSubBoton3 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton3;  |FINSI;

         nGrid1 = -1;
         |PTEC 806;
     |FINSI;

     |SI nFichero = 2;
         |DESTRUYECONTROL nGrid2;

         |SI nSubBoton1 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton1;  |FINSI;
         |SI nSubBoton2 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton2;  |FINSI;
         |SI nSubBoton3 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton3;  |FINSI;

         nGrid2 = -1;
         |PTEC 806;
     |FINSI;

     |SI nFichero = 3;
         |DESTRUYECONTROL nGrid3;

         |SI nSubBoton1 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton1;  |FINSI;
         |SI nSubBoton2 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton2;  |FINSI;
         |SI nSubBoton3 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton3;  |FINSI;

         nGrid3 = -1;
         |PTEC 806;
     |FINSI;

     |SI nFichero = 4;
         |DESTRUYECONTROL nGrid4;

         |SI nSubBoton1 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton1;  |FINSI;
         |SI nSubBoton2 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton2;  |FINSI;
         |SI nSubBoton3 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton3;  |FINSI;

         nGrid4 = -1;
         |PTEC 806;
     |FINSI;

     |PULSATECLA;
     |BORRA_HIJOS_PAN #0#0;
     |SUB_PINPA #0#901, nPanta;
     nSubPan =  FSalida;

     nRango = 4 + 8 + 16 + 32 + 128;

     |LINEAL_SIMPLE #1#703, nRango, 0602, 1298, NULL, NULL, Evento4;
     nGrid4 = FSalida;

     |SI nBoton4 ! -1;  |ESTADO_CONTROL nBoton4, "DISABLE";  |FINSI;
     |SI nBoton1 ! -1;  |ESTADO_CONTROL nBoton1, "ENABLE";   |FINSI;
     |SI nBoton2 ! -1;  |ESTADO_CONTROL nBoton2, "ENABLE";   |FINSI;
     |SI nBoton3 ! -1;  |ESTADO_CONTROL nBoton3, "ENABLE";   |FINSI;

     nFichero = 4;

     FSalida = 1;  |HAZ Evento4;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::{{001}}Salir," + nGrid4;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;
          |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aTecla = "";
|FPRC;

|PROCESO TraeLogo;
     |DBASE aBase;  |QBF aBase;

     aFotoOrigen = aBase + "logos/logodespanet.jpg";
     aExt        = ".jpg";
     aNLogo      = "logodespanet.jpg";
     |XABRE "E", aFotoOrigen, nHandle;
     |SI FSalida < 0;
         aFotoOrigen = aBase + "logos/logodespanet.bmp";
         aExt        = ".bmp";
         aNLogo      = "logodespanet.bmp";
         |XABRE "E", aFotoOrigen, nHandle;
         |SI FSalida < 0;
             aFotoOrigen = aBase + "logos/insertarlogo.jpg";
             aExt        = ".jpg";
             aNLogo      = "insertarlogo.jpg";
             |XABRE "E", aFotoOrigen, nHandle;
             |SI FSalida < 0;
                 |ACABA;
             |FINSI;
         |FINSI;
     |FINSI;

     aDirLocal    = eaUnidadBasico + "\DOCUMENTOS";                     |RMKDIR aDirLocal;
     aDirLocal    = eaUnidadBasico + "\DOCUMENTOS\DSARCHI";             |RMKDIR aDirLocal;
     aDirLocal    = eaUnidadBasico + "\DOCUMENTOS\DSARCHI\LOGOS";       |RMKDIR aDirLocal;
     aFotoDestino = aDirLocal + "/logods" + aExt;

     aContiene1 = aFotoDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = aFotoOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aFotoOrigen, aFotoDestino;
         |SINO;
             |COPIA_FICHERO aFotoOrigen, aFotoDestino;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO PonDirecciones;
     aLong  = aTo % 0;
     nLong  = aLong;
     aFrase = "";
     aDirec = "";
     |PARA nPosi = 1;  |SI nPosi [ nLong;  |HACIENDO nPosi = nPosi + 1;
           nPos   = (nPosi * 100) + 1;
           aCarac = aTo % nPos;

           |SI aCarac = ";";  |O aCarac = ",";
               aFrase = aFrase + "--to=" + &34 + aDirec + &34 + " ";
               aDirec = "";
           |SINO;
               aDirec = aDirec + aCarac;
           |FINSI;
     |SIGUE;

     |SI aDirec ! "";
         aFrase = aFrase + "--to=" + &34 + aDirec + &34;
     |FINSI;

     aConten = aFrase + " \" + &10;
|FPRC;

|PROCESO GrabaCuerpo;
     |HAZ QuitaRarosCorreo;

     |SI nDsCorreo= 0;
         |SI eaAlfa = "";
             eaAlfa = "<br>";
         |SINO;
             eaAlfa = eaAlfa + "<br>" + &13 + &10;
         |FINSI;
     |SINO;
         eaAlfa = eaAlfa + &13 + &10;
     |FINSI;

     |XGRABA nHandle, eaAlfa;
|FPRC;

|PROCESO EjecutaShellCorreo;
     enAprobacion = 0;
     eaPrograma = "SMTPSERVPROPIO";
     |HAZ DSARCHI_INI;
     nSwSMTPServPropio = enAprobacion;

     |ABRE #910;
     |LEE 000#910p;
     |SI FSalida ! 0;  |DDEFECTO #910;  |FINSI;
     |CIERRA #910;

     |HAZ ParametrosSMTPCLI;

     aEmpresa = #801#1;

     aAbreHTMO = aBaseMensaje + "despabox.htm";
     aAbreHTMD = aBaseMensaje + aEmpresa + ".htm";  |QBT aAbreHTMD;
     |FBORRA aAbreHTMD;

     |XABRE "WB", aAbreHTMD, nHandle1;
     |XABRE "AB", aAbreHTMO, nHandle2;

     nRegilla = 0;
     nLLave   = 0;
     |XLEE nHandle2, 1, aAlfa;
     |PARA; |SI FSalida > 0; |HACIENDO;
            |SI aAlfa = "#";
                nRegilla = nRegilla + 1;
            |FINSI;

            |SI nRegilla = 2;  |SAL;  |FINSI;

            |SI nLLave = 0;  |Y aAlfa ! "{";  |Y nRegilla = 0;
                |XGRABA nHandle1, aAlfa;
            |FINSI;

            |SI aAlfa = "}";
                aConten  = aConten + aAlfa;

                |SI aConten = "{LOGO}";
                    ||Por el tema del "cid:" Para la imagen embebida
                    ||aAlfa = &34 + aNLogo + &34;
                    aAlfa = aNLogo;
                |FINSI;

                |XGRABA nHandle1, aAlfa;

                nLLave   = 0;
                aConten  = "";
            |SINO;
                |SI aAlfa = "{";  |O nLLave = 1;
                    aConten  = aConten + aAlfa;
                    nLLave = 1;
                |FINSI;
            |FINSI;

            |XLEE nHandle2, 1, aAlfa;
     |SIGUE;
     |XCIERRA nHandle1;

     |AFEGIR_FICHERO aAbreTXT, aAbreHTMD;

     |XABRE "AB", aAbreHTMD, nHandle1;

     |XLEE nHandle2, 1, aAlfa;
     |PARA; |SI FSalida > 0; |HACIENDO;
            |XGRABA nHandle1, aAlfa;

            |XLEE nHandle2, 1, aAlfa;
     |SIGUE;
     |XCIERRA nHandle1;
     |XCIERRA nHandle2;

     aAbreTXTO = aBaseMensaje + "dscorreo.sh";
     aAbreTXTD = aBaseMensaje + aEmpresa + ".sh";  |QBT aAbreTXTD;
     aAbreFIN  = aBaseMensaje + aEmpresa + ".txt"; |QBT aAbreFIN;
     |FBORRA aAbreTXTD;
     |FBORRA aAbreFIN;

     |XABRE "WB", aAbreTXTD, nHandle1;
     |XABRE "AB", aAbreTXTO, nHandle2;

     aCarac10 = &10;
     aConten = "";
     aVarSMTP = #dsarw010#19;
     |QBF aVarSMTP;
     aVarUsuario = #dsarw010#21;
     |QBF aVarUsuario;
     aVarPassword = #dsarw010#22;
     |QBF aVarPassword;

     |XLEE nHandle2, 1, aAlfa;
     |PARA; |SI FSalida > 0; |HACIENDO;
            aConten = aConten + aAlfa;

            |SI aAlfa = aCarac10;
                aAlfa1 = aConten - "/usr/bin/smtp-cli";
                |SI FSalida ! 0;
                     ||SMTPSERVPROPIO
                     |SI nSwSMTPServPropio = 1;
                         |SI aVarSMTP ! ""; |Y aVarUsuario ! ""; |Y aVarPassword ! "";
                              aAlfa2 = aAlfa1 - "--host=asmtp.diagram.es --user=control.smtp@diagram.es --pass=elpollogalactico \";
                              |SI FSalida ! 0;
                                   aAlfa1 = " --host=" + aVarSMTP + " --user=" + aVarUsuario + " --pass=" + aVarPassword + " \" + &10;
                              |FINSI;
                         |FINSI;
                     |FINSI;

                     aConten = aBaseMensaje + "smtp-cli" + aAlfa1;
                |FINSI;

                aAlfa1 = aConten - "DE=$1";
                |SI FSalida ! 0;
                    aConten = "DE=" + &34 + aPara + &34 + &10;
                |FINSI;

                aAlfa1 = aConten - "$PARA";
                |SI FSalida ! 0;
                    |HAZ PonDirecciones;
                |FINSI;

                aAlfa1 = aConten - "ASUNTO=$3";
                |SI FSalida ! 0;
                    aConten = "ASUNTO=" + &34 + aAsunto + &34 + &10;
                |FINSI;

                aAlfa1 = aConten - "FICHTM=$4";
                |SI FSalida ! 0;
                    aConten = "FICHTM=" + &34 + aAbreHTMD + &34 + &10;
                |FINSI;

                aAlfa1 = aConten - "FICAT1=$5";
                |SI FSalida ! 0;
                    aConten = "FICAT1=" + &34 + aFotoOrigen + &34 + &10;
                |FINSI;

                aAlfa1 = aConten - "FICFIN=$6";
                |SI FSalida ! 0;
                    aConten = "FICFIN=" + &34 + aAbreFIN + &34 + &10;  |QBT aConten;
                |FINSI;

                aAlfa1 = aConten - "$ADJUNTO";
                |SI FSalida ! 0;
                    aConten = "";
                    |SI aFicheroAdjunto ! "";
                        aConten = "--attach " + aFicheroAdjunto + " \" + &10;
                    |FINSI;
                |FINSI;

                |XGRABA nHandle1, aConten;

                aConten = "";
            |FINSI;

            |XLEE nHandle2, 1, aAlfa;
     |SIGUE;

     |XCIERRA nHandle1;
     |XCIERRA nHandle2;

     aEjecuta = "/bin/sh " + aAbreTXTD;

     ||TODO CCC. DESCOMENTAR EL TROZO ESTE
     |SYSTEM aEjecuta;

     |PARA;  |SI;  |HACIENDO;
          |XABRE "E", aAbreFIN, nHandle;
          |SI FSalida ] 0;  |SAL;  |FINSI;

          |SLEEP 1;
          |PULSATECLA;
     |SIGUE;

     |FBORRA aAbreTXT;
     |FBORRA aAbreTXTD;
     |FBORRA aAbreHTMD;
     |FBORRA aAbreFIN;
|FPRC;

|PROCESO DsCorreo;
     |ABRE #910;
     |LEE 000#910p;
     |SI FSalida ! 0;  |DDEFECTO #910;  |FINSI;
     |CIERRA #910;

     aIP      = #910#18;  |QBF aIP;
     aSalida  = #910#19;  |QBF aSalida;

     aFrom    = aPara;   |QBF aFrom;
     eaAlfa   = #910#3;   |HAZ QuitaRarosCorreo;
     aMensaje = "$$$$" + aAbreTXT;
     aFicheroAdjunto = aAbreTXT;

     |SI #910#20 = "N";
          aAutenti = aFrom;
     |SINO;
          aAutenti = #910#22;
          |QBF aAutenti;
          aAutenti = aAutenti + ":" + #910#21;
          |QBF aAutenti;
          aAutenti = aAutenti + ":" + aFrom;
     |FINSI;

     |SI #910#23 = "S";
          aAutenti = "!" + aAutenti;
     |FINSI;

     |DSCORREO_ENVIA aIP, aSalida, aAutenti, aTo, aAsunto, aMensaje, aFicheroAdjunto;
     |SI FSalida < 0;
         |MENAV "0000 Ha habido un error durante el envio.";
     |FINSI;
|FPRC;

|PROCESO Correo;
     aNombre  = #801#2;
     aTo      = #800#2;
     aPara    = #801#9;
     |QBF aNombre;
     |QBF aTo;

     |SI aTo   = "";   |ACABA;  |FINSI;
     |SI aPara = "";   |ACABA;  |FINSI;

     eaPrograma   = "DSCORREO";
     |HAZ DSARCHI_INI;
     nDsCorreo = enAprobacion;

     |HAZ TraeLogo;

     |DBASE aBasePla;  |QBF aBasePla;

     aFicheroAdjunto = "";
     aBaseMensaje    = aBasePla + "dscorreo/";

     aAbreTXT  = aBaseMensaje + "adjunto.txt";
     |XABRE "WB", aAbreTXT, nHandle;

     eaAlfa = aNombre + ", comunicaci¢n de facturas nuevas introducidas por DESPABOX";
     |HAZ QuitaRarosCorreo;
     aAsunto  = eaAlfa;        |QBF aAsunto;

     eaAlfa = aNombre + ", le comunica:";
     |HAZ GrabaCuerpo;

     eaAlfa = "";  |HAZ GrabaCuerpo;

     eaAlfa = "Se han introducido nuevas facturas en la aplicaci¢n DESPABOX, para su revisi¢n.";
     |HAZ GrabaCuerpo;

     eaAlfa = "";  |HAZ GrabaCuerpo;

     eaAlfa = "Para cualquier aclaraci¢n o duda, por favor, contacte con nosotros.";
     |HAZ GrabaCuerpo;

     |XCIERRA nHandle;

     |SI nDsCorreo = 0;
         |HAZ EjecutaShellCorreo;
     |SINO;
         |HAZ DsCorreo;
     |FINSI;
|FPRC;

|PROCESO EntradaDESPANET;
     |ABRE #801;
     eaUsuario = Usuario % 810;
     #801#0   = eaUsuario;
     |LEE 000#801=;
     |SI FSalida ! 0;
         |MENAV "0000No eres un USUARIO DESPABOX";
         |CIERRA #801;
         |ACABA;
     |FINSI;
     |CIERRA #801;

     |DBASS aBase;  |QBF aBase;

     nCorreo   = 0;
     eaPathNet = aBase + "despanet";            |MKDIR eaPathNet;
     eaPathNet = eaPathNet + "/" + eaUsuario;   |MKDIR eaPathNet;
     eaPathNet = eaPathNet + "/fich";           |MKDIR eaPathNet;
     eaPathNet = eaPathNet + "/";

     |PATH_DAT #700 eaPathNet;
     |PATH_DAT #701 eaPathNet;
     |PATH_DAT #702 eaPathNet;
     |PATH_DAT #703 eaPathNet;

     |ABRET #700;
     |ABRET #701;
     |ABRET #702;
     |ABRET #703;

     |VENTANA 0501, 3599, -1, 16, "DESPABOX - Introducci¢n de facturas";
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PINPA #0#0;
     nPanta = FSalida;
     |PINDA #0#0;

     |CONTROL_SIMPLE nPanta, "BOTON,Facturas Expedidas", 0502, 0520, Boton1;
     nBoton1      = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,Facturas Recibidas", 0523, 0541, Boton2;
     nBoton2      = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,Facturas Expedidas Revisadas", 0552, 0574, Boton3;
     nBoton3      = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,Facturas Recibidas Revisadas", 0577, 0599, Boton4;
     nBoton4      = FSalida;

     |ESTADO_CONTROL nBoton1, "DISABLE";

     |HAZ Boton1;

     |SI nBoton1 ! -1;  |FIN_CONTROL_WINDOWS nBoton1;  |FINSI;
     |SI nBoton2 ! -1;  |FIN_CONTROL_WINDOWS nBoton2;  |FINSI;
     |SI nBoton3 ! -1;  |FIN_CONTROL_WINDOWS nBoton3;  |FINSI;
     |SI nBoton4 ! -1;  |FIN_CONTROL_WINDOWS nBoton4;  |FINSI;

     |SI nGrid1 ! -1;  |DESTRUYECONTROL nGrid1;  |FINSI;
     |SI nGrid2 ! -1;  |DESTRUYECONTROL nGrid2;  |FINSI;
     |SI nGrid3 ! -1;  |DESTRUYECONTROL nGrid3;  |FINSI;
     |SI nGrid4 ! -1;  |DESTRUYECONTROL nGrid4;  |FINSI;

     |SI nSubBoton1 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton1;  |FINSI;
     |SI nSubBoton2 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton2;  |FINSI;
     |SI nSubBoton3 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton3;  |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVent;

     |CIERRAT #700;
     |CIERRAT #701;
     |CIERRAT #702;
     |CIERRAT #703;

     |SI nCorreo = 1;
         |ABRE #800;
         |LEE 000#800p;
         |SI FSalida ! 0;  |DDEFECTO #800;  |FINSI;
         |CIERRA #800;

         |SI #800#4 = "N";
             |PULSATECLA;
             |PULSATECLA;
             |PULSATECLA;
             |ACABA;
         |FINSI;

         |SI #800#4 = "P";
             aAlfa = "0000SQuiere enviar a " + #800#1;  |QBF aAlfa;
             aAlfa = aAlfa + " un correo de notificaci¢n ";  |QBF aAlfa;
             |CONFI aAlfa;
             |SI FSalida ! 0;
                 |PULSATECLA;
                 |PULSATECLA;
                 |PULSATECLA;
                 |ACABA;
             |FINSI;

             |HAZ Correo;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO EntradaCONTAGEN;
     aTipo     = PARAMETRO % 601;
     eaUsuario = PARAMETRO % 105;

     |DBASS aBase;  |QBF aBase;

     nCorreo   = 0;
     eaPathNet = aBase + "despanet";            |MKDIR eaPathNet;
     eaPathNet = eaPathNet + "/" + eaUsuario;   |MKDIR eaPathNet;
     eaPathNet = eaPathNet + "/fich";           |MKDIR eaPathNet;
     eaPathNet = eaPathNet + "/";

     |PATH_DAT #700 eaPathNet;
     |PATH_DAT #701 eaPathNet;
     |PATH_DAT #702 eaPathNet;
     |PATH_DAT #703 eaPathNet;

     |ABRET #700;
     |ABRET #701;
     |ABRET #702;
     |ABRET #703;

     |VENTANA 0501, 3599, -1, 16, "DESPABOX - Introducci¢n de facturas";
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PINPA #0#0;
     nPanta = FSalida;
     |PINDA #0#0;

     |SI aTipo = "R";
         |CONTROL_SIMPLE nPanta, "BOTON,Facturas Expedidas", 0502, 0520, Boton1;
         nBoton1      = FSalida;

         |CONTROL_SIMPLE nPanta, "BOTON,Facturas Expedidas Revisadas", 0523, 0545, Boton3;
         nBoton3      = FSalida;

         |ESTADO_CONTROL nBoton1, "DISABLE";
         |HAZ Boton1;
     |FINSI;

     |SI aTipo = "S";
         |CONTROL_SIMPLE nPanta, "BOTON,Facturas Recibidas", 0502, 0520, Boton2;
         nBoton2      = FSalida;

         |CONTROL_SIMPLE nPanta, "BOTON,Facturas Recibidas Revisadas", 0523, 0545, Boton4;
         nBoton4      = FSalida;

         |ESTADO_CONTROL nBoton2, "DISABLE";
         |HAZ Boton2;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SI nBoton1 ! -1;  |FIN_CONTROL_WINDOWS nBoton1;  |FINSI;
     |SI nBoton2 ! -1;  |FIN_CONTROL_WINDOWS nBoton2;  |FINSI;
     |SI nBoton3 ! -1;  |FIN_CONTROL_WINDOWS nBoton3;  |FINSI;
     |SI nBoton4 ! -1;  |FIN_CONTROL_WINDOWS nBoton4;  |FINSI;

     |SI nGrid1 ! -1;  |DESTRUYECONTROL nGrid1;  |FINSI;
     |SI nGrid2 ! -1;  |DESTRUYECONTROL nGrid2;  |FINSI;
     |SI nGrid3 ! -1;  |DESTRUYECONTROL nGrid3;  |FINSI;
     |SI nGrid4 ! -1;  |DESTRUYECONTROL nGrid4;  |FINSI;

     |SI nSubBoton1 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton1;  |FINSI;
     |SI nSubBoton2 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton2;  |FINSI;
     |SI nSubBoton3 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton3;  |FINSI;

     |FINVENTANA nVent;

     |CIERRAT #700;
     |CIERRAT #701;
     |CIERRAT #702;
     |CIERRAT #703;
|FPRC;

|PROCESO VerCONTAGEN;
     eaUsuario = PARAMETRO % 105;
     aTipo     = PARAMETRO % 601;
     aReg      = PARAMETRO % 706;

     |DBASS aBase;  |QBF aBase;

     nCorreo   = 0;
     eaPathNet = aBase + "despanet";            |MKDIR eaPathNet;
     eaPathNet = eaPathNet + "/" + eaUsuario;   |MKDIR eaPathNet;
     eaPathNet = eaPathNet + "/fich";           |MKDIR eaPathNet;
     eaPathNet = eaPathNet + "/";

     |PATH_DAT #700 eaPathNet;
     |PATH_DAT #701 eaPathNet;
     |PATH_DAT #702 eaPathNet;
     |PATH_DAT #703 eaPathNet;

     |ABRET #700;
     |ABRET #701;
     |ABRET #702;
     |ABRET #703;


     |VENTANA 0501, 3599, -1, 16, "DESPABOX - Introducci¢n de facturas";
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PINPA #0#0;
     nPanta = FSalida;
     |PINDA #0#0;

     |SI aTipo = "R";
         |CONTROL_SIMPLE nPanta, "BOTON,Facturas Expedidas", 0502, 0520, Boton1;
         nBoton1      = FSalida;

         |CONTROL_SIMPLE nPanta, "BOTON,Facturas Expedidas Revisadas", 0523, 0545, Boton3;
         nBoton3      = FSalida;

         |ESTADO_CONTROL nBoton1, "DISABLE";
         |HAZ Boton1;
     |FINSI;

     |SI aTipo = "S";
         |CONTROL_SIMPLE nPanta, "BOTON,Facturas Recibidas", 0502, 0520, Boton2;
         nBoton2      = FSalida;

         |CONTROL_SIMPLE nPanta, "BOTON,Facturas Recibidas Revisadas", 0523, 0545, Boton4;
         nBoton4      = FSalida;

         |ESTADO_CONTROL nBoton2, "DISABLE";
         |HAZ Boton2;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SI nBoton1 ! -1;  |FIN_CONTROL_WINDOWS nBoton1;  |FINSI;
     |SI nBoton2 ! -1;  |FIN_CONTROL_WINDOWS nBoton2;  |FINSI;
     |SI nBoton3 ! -1;  |FIN_CONTROL_WINDOWS nBoton3;  |FINSI;
     |SI nBoton4 ! -1;  |FIN_CONTROL_WINDOWS nBoton4;  |FINSI;

     |SI nGrid1 ! -1;  |DESTRUYECONTROL nGrid1;  |FINSI;
     |SI nGrid2 ! -1;  |DESTRUYECONTROL nGrid2;  |FINSI;
     |SI nGrid3 ! -1;  |DESTRUYECONTROL nGrid3;  |FINSI;
     |SI nGrid4 ! -1;  |DESTRUYECONTROL nGrid4;  |FINSI;

     |SI nSubBoton1 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton1;  |FINSI;
     |SI nSubBoton2 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton2;  |FINSI;
     |SI nSubBoton3 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton3;  |FINSI;

     |FINVENTANA nVent;

     |CIERRAT #700;
     |CIERRAT #701;
     |CIERRAT #702;
     |CIERRAT #703;
|FPRC;

|PROCESO EntradaGAD;
     aTipo     = PARAMETRO % 601;
     eaUsuario = PARAMETRO % 105;

     |DBASS aBase;  |QBF aBase;

     nCorreo   = 0;
     eaPathNet = aBase + "despanet";            |MKDIR eaPathNet;
     eaPathNet = eaPathNet + "/" + eaUsuario;   |MKDIR eaPathNet;
     eaPathNet = eaPathNet + "/fich";           |MKDIR eaPathNet;
     eaPathNet = eaPathNet + "/";

     |PATH_DAT #700 eaPathNet;
     |PATH_DAT #701 eaPathNet;
     |PATH_DAT #702 eaPathNet;
     |PATH_DAT #703 eaPathNet;

     |ABRET #700;
     |ABRET #701;
     |ABRET #702;
     |ABRET #703;

     aAlfa = "Contabilizaci¢n de facturas. " + eaTitulo;
     |VENTANA 0501, 3599, -1, 16, aAlfa;
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PINPA #0#0;
     nPanta = FSalida;
     |PINDA #0#0;

     |SI aTipo = "R";
         |CONTROL_SIMPLE nPanta, "BOTON,Facturas Expedidas", 0502, 0520, Boton1;
         nBoton1      = FSalida;

         |CONTROL_SIMPLE nPanta, "BOTON,Facturas Expedidas Revisadas", 0523, 0545, Boton3;
         nBoton3      = FSalida;

         |ESTADO_CONTROL nBoton1, "DISABLE";
         |HAZ Boton1;
     |FINSI;

     |SI aTipo = "S";
         |CONTROL_SIMPLE nPanta, "BOTON,Facturas Recibidas", 0502, 0520, Boton2;
         nBoton2      = FSalida;

         |CONTROL_SIMPLE nPanta, "BOTON,Facturas Recibidas Revisadas", 0523, 0545, Boton4;
         nBoton4      = FSalida;

         |ESTADO_CONTROL nBoton2, "DISABLE";
         |HAZ Boton2;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SI nBoton1 ! -1;  |FIN_CONTROL_WINDOWS nBoton1;  |FINSI;
     |SI nBoton2 ! -1;  |FIN_CONTROL_WINDOWS nBoton2;  |FINSI;
     |SI nBoton3 ! -1;  |FIN_CONTROL_WINDOWS nBoton3;  |FINSI;
     |SI nBoton4 ! -1;  |FIN_CONTROL_WINDOWS nBoton4;  |FINSI;

     |SI nGrid1 ! -1;  |DESTRUYECONTROL nGrid1;  |FINSI;
     |SI nGrid2 ! -1;  |DESTRUYECONTROL nGrid2;  |FINSI;
     |SI nGrid3 ! -1;  |DESTRUYECONTROL nGrid3;  |FINSI;
     |SI nGrid4 ! -1;  |DESTRUYECONTROL nGrid4;  |FINSI;

     |SI nSubBoton1 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton1;  |FINSI;
     |SI nSubBoton2 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton2;  |FINSI;
     |SI nSubBoton3 ! -1;  |FIN_CONTROL_WINDOWS nSubBoton3;  |FINSI;

     |FINVENTANA nVent;

     |CIERRAT #700;
     |CIERRAT #701;
     |CIERRAT #702;
     |CIERRAT #703;
|FPRC;

|PROCESO Tipo7C4_m035; |TIPO 7;
|FPRC;

|PROCESO Tipo0C4_m035; |TIPO 0;
|FPRC;

|PROGRAMA;
     |HAZ LeeUnidadBasico;

     |ABRE #1;
     |LEE 000#1p;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     nBoton1    = -1;
     nBoton2    = -1;
     nBoton3    = -1;
     nBoton4    = -1;
     nSubBoton1 = -1;
     nSubBoton2 = -1;
     nSubBoton3 = -1;

     |SI PARAMETRO = "";
         nTipoEntrada = 1;
     |SINO;
         aAlfa = PARAMETRO % -103;
                             nTipoEntrada = 2;
         |SI aAlfa = "VER";  nTipoEntrada = 3;  |FINSI;
         |SI aAlfa = "GAD";  nTipoEntrada = 4;  |FINSI;
     |FINSI;

     |SI #1#122 = "N";
         |SI nTipoEntrada = 1;
              |MENAV "0000No tiene configurada la aplicaci¢n DESPABOX";
              |ACABA;
         |FINSI;
     |FINSI;

     |SI nTipoEntrada = 1;  |HAZ EntradaDESPANET;  |FINSI;
     |SI nTipoEntrada = 2;  |HAZ EntradaCONTAGEN;  |FINSI;
     |SI nTipoEntrada = 3;  |HAZ VerCONTAGEN;      |FINSI;
     |SI nTipoEntrada = 4;  |HAZ EntradaGAD;       |FINSI;

     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;
|FPRO;
