||Si se anyaden campos, en dsarm002,dsarm003, dsarm004 o dsarm008,
||hay que actualizar los patrones: para_asesorias.ptl

|FICHEROS;
     dsarm001 #1;
     dsarm002 #2;
     dsarm003 #3;
     dsarm004 #4;
     dsarm005 #5;

     dsarw002 #902,MANTE;
     dsarw003 #903,MANTE;
     dsarw004 #904,MANTE;

     dsarw104 #104,MANTE;          ||Aux. campos Libres
     dsarw115,MANTE;
|FIN;

|VARIABLES;
     nSwCopiaSubEnMismoGrupo = 0;

     nBotonLibresOn  = 0;
     nBotonLibresOff = 0;
     nVentmCL        = 0;
     nVoy            = 0;
     nFSalida        = 0;
     nSwCorrecto     = 0;
     aGuardaTexto    = "";
     nGrupoMov       = 0;
     nSubGrupoMov    = 0;
     nTipoMov        = 0;
     nVent           = 0;
     nPantaAux       = 0;
     nRango          = 0;
     nPos1           = 0;
     nPos2           = 0;
     nGrid1          = 0;
     nGrid2          = 0;
     nUltimo         = 0;
     nSwSeleccion    = 0;
     nSwRefresca     = 0;
     nGrupoOri       = 0;
     nGrupoDes       = 0;
     nSubGrupoOri    = 0;
     nSubGrupoDes    = 0;
     nTipoOri        = 0;
     nTipoDes        = 0;
     nVentTrab       = 0;
     nValor          = 0;
     nBusco          = 0;
     nCuentaX        = 0;
     nSwBorraTot     = 0;
     nPanta          = 0;
     nHandle         = 0;
     nTree           = 0;
     nBotonLabel     = 0;
     nBotonAsis      = 0;
     nCampoD         = 0;
     nCampoH         = 0;
     nCarpeta1       = 0;
     nCarpeta2       = 0;
     nCarpeta3       = 0;
     nBoton          = 0;
     nLong           = 0;
     nCargar         = 0;
     nPosi           = 0;
     nPos            = 0;
     nVentm2         = 0;
     nDSubGrupo      = 0;
     nHSubGrupo      = 0;
     nPanta904       = 0;
     nPanta104       = 0;
     nTipo           = 0;

     aFichero        = "";
     aPathRemoto     = "";
     aPath           = "";
     aUbicacion      = "";
     aFechaSis       = "";
     aAAAAMM         = "";
     aDesDes         = "";
     aCarpetaDes     = "";
     aDesSGDes       = "";
     aCarpetaSGDes   = "";
     aEsc1           = "";
     aEsc2           = "";
     aRetu           = "";
     aTecla          = "";
     aAlfa           = "";
     aAbre           = "";
     aBusca          = "";
     aRefresca       = "";
     aTexto          = "";
     aLong           = "";
     aCarac          = "";
     aAux            = "";
     aAux2           = "";
     aAux3           = "";
     aMensaje        = "";
     aAlfa1          = "";
     aDirectorio     = "";
     aBase           = "";
     aDirec          = "";
     aNom            = "";

     fFechaSis       = @;

     {-1}sTree       = 0;
     sT_nID          = 0;
     sT_nOper        = 0;
     sT_aData        = "";

     {-1}aVent       =  "";
         aVent1      = 0;
         aVent2      = 0;
         aVent3      = 0;
         aVent4      = 0;
         aVent5      = "";

     &enGrupo        = 0;
     &enSubGrupo     = 0;
     &enTipo         = 0;
     &enModo         = 0;
     &enPassword     = 0;
     &enSwBorraFis   = 0;
     &eaGrupoBorra   = 0;
     &eaSubBorra     = 0;
     &eaTipoBorra    = 0;
     &eaRutaOrigen   = "";
     &eaRutaDestino  = "";
     &eaFicheroTxt   = "";
     &eaFicheroTgz   = "";
     &eaFicheroTar   = "";
     &eaAlfa         = "";
     &enCalDESPANET  = 0;
     &eaUnidadBasico = "";
     &enCambio       = "";
     &enCamposDet    = 0;
     &enSwMueve      = 0;
     &eaCarpetaOri   = "";
     &eaOrigen       = "";
     &eaDestino      = "";
     &eaUnidad       = "";
|FIN;

|PROCESO Pantalla902;
     |VENTANA 1201, 1963, -1, 16, "Pantalla de Grupos";
     nVentm2 = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentm2;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |C_M #902#0, 1, "S";
     |DDEFECTO #902;

     |SI enModo ! 1;
         #2#0 = enGrupo;
         |LEE 101#2=;
         |SI FSalida ! 0;
             |DDEFECTO #2;
             #2#0 = enGrupo;
             |GRABA 020#2b;
         |FINSI;

         #902#0  = #2#0;
         #902#1  = #2#1;
         #902#2  = #2#2;
         #902#3  = #2#3;
         #902#4  = #2#4;

         |C_M #902#0, 1, "N";
     |FINSI;

     |PINPA #0#902;
     |PINDA #0#902;
     |ENDATOS #1#902;
     |SI FSalida = 0;
         |SI enModo ! 1;
             |SI #902#1 ! #2#1;  enCambio = 1;  |FINSI;
         |FINSI;

         #2#0  = #902#0;
         #2#1  = #902#1;
         #2#2  = #902#2;
         #2#3  = #902#3;
         #2#4  = #902#4;

         |SI enModo = 1;
             |GRABA 020#2n;
         |SINO;
             |GRABA 020#2a;
         |FINSI;
         |LIBERA #2;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentm2;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentm2;
|FPRC;

|PROCESO Pantalla903;
     |VENTANA 1201, 2463, -1, 16, "Pantalla de Subgrupos";
     nVentm2 = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentm2;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     #2#0 = enGrupo;
     |LEE 000#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

     |C_M #903#3, 1, "S";
     |DDEFECTO #903;

     #903#0  = #2#0;
     #903#1  = #2#1;
     #903#2  = #2#2;

     |SI enModo ! 1;
         #3#0 = enGrupo;
         #3#1 = enSubGrupo;
         |LEE 101#3=;
         |SI FSalida ! 0;
             |DDEFECTO #3;
             #3#0 = enGrupo;
             #3#1 = enSubGrupo;
             |GRABA 020#3b;
         |FINSI;

         #903#3  = #3#1;
         #903#4  = #3#2;
         #903#5  = #3#3;
         #903#6  = #3#5;

         |C_M #903#3, 1, "N";
     |FINSI;

     |PINPA #0#903;
     |PINDA #0#903;
     |ENDATOS #1#903;
     |SI FSalida = 0;
         |SI enModo ! 1;
             |SI #903#4 ! #3#2;  enCambio = 1;  |FINSI;
         |FINSI;

         #3#0  = #903#0;
         #3#1  = #903#3;
         #3#2  = #903#4;
         #3#3  = #903#5;
         #3#5  = #903#6;

         |SI enModo = 1;
             |GRABA 020#3n;
         |SINO;
             |GRABA 020#3a;
         |FINSI;
         |LIBERA #3;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentm2;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentm2;
|FPRC;

|PROCESO NoModificableCEFAX;
     |PARA nCampoD = 9;  |SI nCampoD [ 23;  |HACIENDO nCampoD = nCampoD + 1;
          |C_M #904nCampoD, 1, "N";
     |SIGUE;
     |PARA nCampoD = 30;  |SI nCampoD [ 34;  |HACIENDO nCampoD = nCampoD + 1;
          |C_M #904nCampoD, 1, "N";
     |SIGUE;
     |PARA nCampoD = 38;  |SI nCampoD [ 77;  |HACIENDO nCampoD = nCampoD + 1;
          |C_M #904nCampoD, 1, "N";
     |SIGUE;

     ||ARA66
|FPRC;

|PROCESO ModificableCEFAX;
     |PARA nCampoD = 9;  |SI nCampoD [ 23;  |HACIENDO nCampoD = nCampoD + 1;
          |C_M #904nCampoD, 1, "S";
     |SIGUE;
     |PARA nCampoD = 30;  |SI nCampoD [ 34;  |HACIENDO nCampoD = nCampoD + 1;
          |C_M #904nCampoD, 1, "S";
     |SIGUE;
     |PARA nCampoD = 38;  |SI nCampoD [ 77;  |HACIENDO nCampoD = nCampoD + 1;
          |C_M #904nCampoD, 1, "S";
     |SIGUE;

     ||ARA66
|FPRC;

|PROCESO LibresOn;
     |VENTANA 0601, 2899, 1, 1, "Campos Libres";
     nVentmCL = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentmCL;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PARA nVoy = 9; |SI nVoy [ 23; |HACIENDO nVoy = nVoy + 1;
          #dsarw104#nVoy# = #dsarw004#nVoy#;
     |SIGUE;
     |PARA nVoy = 30; |SI nVoy [ 34; |HACIENDO nVoy = nVoy + 1;
          #dsarw104#nVoy# = #dsarw004#nVoy#;
     |SIGUE;
     |PARA nVoy = 38; |SI nVoy [ 77; |HACIENDO nVoy = nVoy + 1;
          #dsarw104#nVoy# = #dsarw004#nVoy#;
     |SIGUE;

     |PINPA #0#dsarw104;
     nPanta104 = FSalida;
     |PINDA #0#dsarw104;

     |SI #1#25 = "N";

         |CONTROL_SIMPLE nPanta104, "LABEL,{{13}}       ", 0841, 0849, NULL;
         |CONTROL_SIMPLE nPanta104, "LABEL,{{13}}       ", 0891, 0899, NULL;

         |C_V #104#38, 1, "N";  |C_M #104#38, 1, "N";
         |C_V #104#39, 1, "N";  |C_M #104#39, 1, "N";
         |C_V #104#40, 1, "N";  |C_M #104#40, 1, "N";
         |C_V #104#41, 1, "N";  |C_M #104#41, 1, "N";
         |C_V #104#42, 1, "N";  |C_M #104#42, 1, "N";
         |C_V #104#43, 1, "N";  |C_M #104#43, 1, "N";
         |C_V #104#44, 1, "N";  |C_M #104#44, 1, "N";
         |C_V #104#45, 1, "N";  |C_M #104#45, 1, "N";
         |C_V #104#46, 1, "N";  |C_M #104#46, 1, "N";
         |C_V #104#47, 1, "N";  |C_M #104#47, 1, "N";
         |C_V #104#48, 1, "N";  |C_M #104#48, 1, "N";
         |C_V #104#49, 1, "N";  |C_M #104#49, 1, "N";
         |C_V #104#50, 1, "N";  |C_M #104#50, 1, "N";
         |C_V #104#51, 1, "N";  |C_M #104#51, 1, "N";
         |C_V #104#52, 1, "N";  |C_M #104#52, 1, "N";
         |C_V #104#53, 1, "N";  |C_M #104#53, 1, "N";
         |C_V #104#54, 1, "N";  |C_M #104#54, 1, "N";
         |C_V #104#55, 1, "N";  |C_M #104#55, 1, "N";
         |C_V #104#56, 1, "N";  |C_M #104#56, 1, "N";
         |C_V #104#57, 1, "N";  |C_M #104#57, 1, "N";
     |SINO;

         |CONTROL_SIMPLE nPanta104, "LABEL,{{13}}Compara", 0841, 0849, NULL;
         |CONTROL_SIMPLE nPanta104, "LABEL,{{13}}Compara", 0891, 0899, NULL;

         |C_V #104#38, 1, "S";  |C_M #104#38, 1, "S";
         |C_V #104#39, 1, "S";  |C_M #104#39, 1, "S";
         |C_V #104#40, 1, "S";  |C_M #104#40, 1, "S";
         |C_V #104#41, 1, "S";  |C_M #104#41, 1, "S";
         |C_V #104#42, 1, "S";  |C_M #104#42, 1, "S";
         |C_V #104#43, 1, "S";  |C_M #104#43, 1, "S";
         |C_V #104#44, 1, "S";  |C_M #104#44, 1, "S";
         |C_V #104#45, 1, "S";  |C_M #104#45, 1, "S";
         |C_V #104#46, 1, "S";  |C_M #104#46, 1, "S";
         |C_V #104#47, 1, "S";  |C_M #104#47, 1, "S";
         |C_V #104#48, 1, "S";  |C_M #104#48, 1, "S";
         |C_V #104#49, 1, "S";  |C_M #104#49, 1, "S";
         |C_V #104#50, 1, "S";  |C_M #104#50, 1, "S";
         |C_V #104#51, 1, "S";  |C_M #104#51, 1, "S";
         |C_V #104#52, 1, "S";  |C_M #104#52, 1, "S";
         |C_V #104#53, 1, "S";  |C_M #104#53, 1, "S";
         |C_V #104#54, 1, "S";  |C_M #104#54, 1, "S";
         |C_V #104#55, 1, "S";  |C_M #104#55, 1, "S";
         |C_V #104#56, 1, "S";  |C_M #104#56, 1, "S";
         |C_V #104#57, 1, "S";  |C_M #104#57, 1, "S";
     |FINSI;

     |ENDATOS #1#dsarw104;
     |SI FSalida = 0;
          |PARA nVoy = 9; |SI nVoy [ 23; |HACIENDO nVoy = nVoy + 1;
               #dsarw004#nVoy# = #dsarw104#nVoy#;
          |SIGUE;
          |PARA nVoy = 30; |SI nVoy [ 34; |HACIENDO nVoy = nVoy + 1;
               #dsarw004#nVoy# = #dsarw104#nVoy#;
          |SIGUE;
          |PARA nVoy = 38; |SI nVoy [ 77; |HACIENDO nVoy = nVoy + 1;
               #dsarw004#nVoy# = #dsarw104#nVoy#;
          |SIGUE;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentmCL;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentmCL;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentm2;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
|FPRC;

|PROCESO LibresOff;
     ||TODO CCC  ????    Quizas NO lo necesite.
|FPRC;

|PROCESO dsarm005Rec;
     |HAZ IndexaTiempoReal;

     |PULSATECLA;
|FPRC;

|DEFBUCLE dsarm005Rec;
     #dsarm005#2;
     ;
     #dsarm004#0, #dsarm004#1, #dsarm004#2,         0;
     #dsarm004#0, #dsarm004#1, #dsarm004#2, 999999999;
     be;
     NULL, dsarm005Rec;
|FIN;

|PROCESO CambiaDescri;
     |VENTANA 0501, 1865, -1, 16, "Descripci¢n en DESPABOX";
     nVentm2 = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentm2;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DDEFECTO #dsarw115;
     |PINPA #0#dsarw115;

     |C_V #dsarw115#1, 1, "S";  |C_M #dsarw115#1, 1, "S";
     |C_V #dsarw115#2, 1, "S";  |C_M #dsarw115#2, 1, "S";
     |C_V #dsarw115#3, 1, "S";  |C_M #dsarw115#3, 1, "S";

     nFSalida = 0;

     |SI nTipo = 1;
         #2#0 = enGrupo;
         |LEE 000#2=;
         nFSalida = FSalida;

         #dsarw115#0 = #2#5;

         |C_V #dsarw115#1, 1, "N";  |C_M #dsarw115#1, 1, "N";
         |C_V #dsarw115#2, 1, "N";  |C_M #dsarw115#2, 1, "N";
         |C_V #dsarw115#3, 1, "N";  |C_M #dsarw115#3, 1, "N";

         |BLANCO 0901 1560;
     |FINSI;

     |SI nTipo = 2;
         #3#0 = enGrupo;
         #3#1 = enSubGrupo;
         |LEE 000#3=;
         nFSalida = FSalida;

         #dsarw115#0 = #3#6;

         |C_V #dsarw115#1, 1, "N";  |C_M #dsarw115#1, 1, "N";
         |C_V #dsarw115#2, 1, "N";  |C_M #dsarw115#2, 1, "N";
         |C_V #dsarw115#3, 1, "N";  |C_M #dsarw115#3, 1, "N";

         |BLANCO 0901 1560;
     |FINSI;

     |SI nTipo = 3;
         #4#0 = enGrupo;
         #4#1 = enSubGrupo;
         #4#2 = enTipo;
         |LEE 000#4=;
         nFSalida = FSalida;

         #dsarw115#0 = #dsarm004#93;
         #dsarw115#1 = #dsarm004#94;
         #dsarw115#2 = #dsarm004#95;
         #dsarw115#3 = #dsarm004#96;
     |FINSI;

     |SI nFSalida = 0;
         |PINDA #0#dsarw115;

         |ENDATOS #2#dsarw115;
         nFSalida = FSalida;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentm2;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentm2;

     |SI nFSalida ! 0;  |ACABA;  |FINSI;

     |SI nTipo = 1;
         #dsarm002#0 = enGrupo;
         |LEE 101#dsarm002.=;
         |SI FSalida = 0;
             #dsarm002#5 = #dsarw115#0;

             |GRABA 020#dsarm002.a;
             |LIBERA #dsarm002;
         |FINSI;
     |FINSI;

     |SI nTipo = 2;
         #dsarm003#0 = enGrupo;
         #dsarm003#1 = enSubGrupo;
         |LEE 101#dsarm003.=;
         |SI FSalida = 0;
             #dsarm003#6 = #dsarw115#0;

             |GRABA 020#dsarm003.a;
             |LIBERA #dsarm003;
         |FINSI;
     |FINSI;

     |SI nTipo = 3;
         #dsarm004#0 = enGrupo;
         #dsarm004#1 = enSubGrupo;
         #dsarm004#2 = enTipo;
         |LEE 101#dsarm004.=;
         |SI FSalida = 0;
             #dsarm004#93 = #dsarw115#0;
             #dsarm004#94 = #dsarw115#1;
             #dsarm004#95 = #dsarw115#2;
             #dsarm004#96 = #dsarw115#3;

             |GRABA 020#dsarm004.a;
             |LIBERA #dsarm004;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Pantalla904;
     ||ATENCION. AHORA LOS CAMPOS LIBRES ESTAN EN EL dsarw104

     enCamposDet = 0;

     |VENTANA 0501, 3099, -1, 16, "Pantalla de Tipos";
     nVentm2 = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentm2;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     #2#0 = enGrupo;
     |LEE 000#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

     #3#0 = enGrupo;
     #3#1 = enSubGrupo;
     |LEE 000#3=;
     |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;

     |PINPA #0#904;  nPanta904 = FSalida;

     |CONTROL_SIMPLE nPanta904, "BOTON,Mostrar Campos Libres", 0970, 0998, LibresOn;
     nBotonLibresOn = FSalida;

     |CONTROL_SIMPLE nPanta904, "BOTON,Ocultar Campos Libres", 0970, 0998, LibresOff;
     nBotonLibresOff = FSalida;

     |ESTADO_CONTROL nBotonLibresOn , "ENABLE";
     |ESTADO_CONTROL nBotonLibresOff , "HIDE";

     |DDEFECTO #904;
     |PINDA #0#904;

     |SI #1#8 = "N";
         |C_M #904#0, 1, "S";
         |C_V #904#1, 1, "S";  |C_M #904#1, 1, "S";  |PINTA #904#1;
         |C_V #904#2, 1, "S";  |C_M #904#2, 1, "S";  |PINTA #904#2;
         |C_V #904#3, 1, "N";  |C_M #904#3, 1, "N";
         |C_V #904#4, 1, "N";  |C_M #904#4, 1, "N";
         |C_V #904#5, 1, "N";  |C_M #904#5, 1, "N";
         |C_V #904#6, 1, "N";  |C_M #904#6, 1, "N";
         |C_V #904#7, 1, "N";  |C_M #904#7, 1, "N";
         |C_V #904#8, 1, "N";  |C_M #904#8, 1, "N";

         |PINTA 0601, "                      ";
         |PINTA 0701, "                      ";
         |PINTA 0662, "                      ";
         |PINTA 0762, "                      ";
     |SINO;
         |C_M #904#0, 1, "N";
         |C_V #904#1, 1, "S";  |C_M #904#1, 1, "N";
         |C_V #904#2, 1, "S";  |C_M #904#2, 1, "N";
         |C_V #904#3, 1, "S";  |C_M #904#3, 1, "N";
         |C_V #904#4, 1, "S";  |C_M #904#4, 1, "N";
         |C_V #904#5, 1, "S";  |C_M #904#5, 1, "N";
         |C_V #904#6, 1, "S";  |C_M #904#6, 1, "S";
         |C_V #904#7, 1, "S";  |C_M #904#7, 1, "S";
         |C_V #904#8, 1, "S";  |C_M #904#8, 1, "S";

         #904#0 = #2#0;
         #904#1 = #2#1;
         #904#2 = #2#2;
         #904#3 = #3#1;
         #904#4 = #3#2;
         #904#5 = #3#3;
     |FINSI;

     |SI #1#25 = "N";
         |CONTROL_SIMPLE nPanta904, "LABEL,{{13}}       ", 1137, 1148, NULL;
         |C_V #904#85, 1, "N";  |C_M #904#85, 1, "N";
         |C_V #904#86, 1, "N";  |C_M #904#86, 1, "N";
         |C_V #904#87, 1, "N";  |C_M #904#87, 1, "N";
     |SINO;
         |CONTROL_SIMPLE nPanta904, "LABEL,{{13}}Compara", 1137, 1148, NULL;
         |C_V #904#85, 1, "S";  |C_M #904#85, 1, "S";
         |C_V #904#86, 1, "S";  |C_M #904#86, 1, "S";
         |C_V #904#87, 1, "S";  |C_M #904#87, 1, "S";
     |FINSI;


     |SI #1#95 = "N";
          |C_M #904#24, 1, "N"; |PINTA #904#24;
     |FINSI;
     |SI #1#96 = "N";
          |C_M #904#25, 1, "N"; |PINTA #904#25;
     |FINSI;
     |SI #1#97 = "N";
          |C_M #904#26, 1, "N"; |PINTA #904#26;
     |FINSI;
     |SI #1#98 = "N";
          |C_M #904#27, 1, "N"; |PINTA #904#27;
     |FINSI;
     |SI #1#99 = "N";
          |C_M #904#28, 1, "N"; |PINTA #904#28;
     |FINSI;

     |SI enModo ! 1;
         #4#0 = enGrupo;
         #4#1 = enSubGrupo;
         #4#2 = enTipo;
         |LEE 101#4=;
         |SI FSalida ! 0;
             |DDEFECTO #4;
             #4#0 = enGrupo;
             #4#1 = enSubGrupo;
             #4#2 = enTipo;
             |GRABA 020#4b;
         |FINSI;

         #904#0 = #2#0;
         #904#1 = #2#1;
         #904#2 = #2#2;
         #904#3 = #3#1;
         #904#4 = #3#2;
         #904#5 = #3#3;
         #904#6 = #4#2;
         #904#7 = #4#3;
         #904#8 = #4#4;

         |PARA nCampoD = 5;  |SI nCampoD [ 23;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH   = nCampoD + 4;
               #904nCampoH = #4nCampoD;
         |SIGUE;

         #904#29 = #4#26;
         #904#30 = #4#27;
         #904#31 = #4#28;
         #904#32 = #4#29;
         #904#33 = #4#30;
         #904#34 = #4#31;
         #904#35 = #4#32;
         #904#36 = #4#33;
         #904#37 = #4#34;

         |PARA nCampoD = 35;  |SI nCampoD [ 89;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH   = nCampoD + 3;
               #904nCampoH = #4nCampoD;
         |SIGUE;

         #904#88 = #4#85;
         #904#89 = #4#86;
         #904#93 = #4#90;
         #904#94 = #4#91;
         #904#95 = #4#92;

         |SI #1#8 = "N";
             |C_M #904#0, 1, "N";
         |SINO;
             |C_M #904#6, 1, "N";
         |FINSI;
     |FINSI;

     |C_M #904#79, 1, "S";
     |C_M #904#80, 1, "S";

     |SI #1#122 = "N";  |O #4#20 = "N";
         |C_M #904#79, 1, "N";  #904#79 = "N";
     |FINSI;

     |SI #1#122 = "N";
         |C_M #904#80, 1, "N";  #904#80 = "N";
     |FINSI;

     |C_M #904#84, 1, "S";
     |SI #1#45 = "N"; |Y #1#168 = "N";
         |C_M #904#84, 1, "N";
     |FINSI;

     |SI #1#66 = "S";    ||CONTROL CAMPOS CEFAX.
          |HAZ ModificableCEFAX;        ||Primero TODO MODIFICABLES

          |SI #1#67 = enGrupo; |Y #1#68 = enSubGrupo; |Y #1#69 = enTipo;
               |HAZ NoModificableCEFAX;
          |FINSI;
          |SI #1#89 = enGrupo; |Y #1#90 = enSubGrupo; |Y #1#91 = enTipo;
               |HAZ NoModificableCEFAX;
          |FINSI;
     |FINSI;

     |PINDA #0#904;

     |SI #1#8 = "N";
          |PINTA #904#1;
          |PINTA #904#2;
     |FINSI;

     |ENDATOS #1#904;
     |SI FSalida = 0;
         |SI #4#76 ! #904#79;
             enCalDESPANET = 1;
         |FINSI;

         |SI enModo ! 1;
             |SI #904#7 ! #4#3;  enCambio = 1;  |FINSI;
         |FINSI;

         |PARA nCampoD = 3;  |SI nCampoD [ 24;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH   = nCampoD + 4;
               #4nCampoD = #904nCampoH;
         |SIGUE;

         #4#26 = #904#29;
         #4#27 = #904#30;
         #4#28 = #904#31;
         #4#29 = #904#32;
         #4#30 = #904#33;
         #4#31 = #904#34;
         #4#32 = #904#35;
         #4#33 = #904#36;
         #4#34 = #904#37;

         |PARA nCampoD = 35;  |SI nCampoD [ 89;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH   = nCampoD + 3;
               #4nCampoD = #904nCampoH;
         |SIGUE;

         #4#85 = #904#88;
         #4#86 = #904#89;

         |SI #4#90 ! #904#93;
             |SI enModo ! 1;
                 enCamposDet = 1;
             |FINSI;
         |FINSI;

         #4#90 = #904#93;
         #4#91 = #904#94;
         #4#92 = #904#95;

         |SI enModo = 1;
             #4#93 = "";
             #4#94 = "N";
             #4#95 = "";
             #4#96 = "N";

             |GRABA 020#4n;
         |SINO;
             |GRABA 020#4a;
         |FINSI;
         |LIBERA #4;

         |SI #1#8 = "N";
             #2#0 = #904#0;
             |LEE 101#2=;
             |SI FSalida ! 0;
                 |GRABA 020#2b;
             |FINSI;
             #2#1 = #904#1;
             #2#2 = #904#2;
             #2#4 = #904#29;
             |GRABA 020#2a;
             |LIBERA #2;
         |FINSI;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentm2;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentm2;

     |SI enCamposDet = 1;
         |MENAV "0000Ha habido un cambio en los campos detalle de las vistas. Se va a proceder a recalcular";

         |VENTANA 0501, 0550, -1, 16, "Procesando vista, espere por favor...";
         nVentTrab = FSalida;

         aVent1 = -1;
         aVent2 = -1;
         aVent3 = 0;
         aVent4 = nVentTrab;
         aVent5 = "MODAL";
         |ESPECIFICA "ESTADO_VENTANA", aVent;

         |PTEC 802; |PAUSA;

         |BUCLE dsarm005Rec;

         aVent1 = -1;
         aVent2 = -1;
         aVent3 = 0;
         aVent4 = nVentTrab;
         aVent5 = "MODELESS";
         |ESPECIFICA "ESTADO_VENTANA", aVent;

         |FINVENTANA nVentTrab;
     |FINSI;
|FPRC;

|PROCESO CreaNuevo;
     aAlfa = aTexto - "TIPO";
     |SI aAlfa ! aTexto;
         aAlfa     = aTexto % -103;  enSubGrupo   = aAlfa;
         aAlfa     = aTexto % -403;  enGrupo      = aAlfa;
         enModo    = 1;

         |HAZ Pantalla904;

         |ACABA;
     |FINSI;

     aAlfa = aTexto - "SUBGRUPO";
     |SI aAlfa ! aTexto;
         aAlfa     = aTexto % -103;  enGrupo   = aAlfa;
         enModo    = 1;
         |HAZ Pantalla903;

         |ACABA;
     |FINSI;

     aAlfa = aTexto - "GRUPO";
     |SI aAlfa ! aTexto;
         enModo    = 1;

         |SI #1#8 = "S";
             |HAZ Pantalla902;
         |SINO;
             enSubGrupo = 1;
             enTipo     = 1;

             |HAZ Pantalla904;
         |FINSI;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO SacaPantalla;
     aAlfa = aTexto - "TIPO";
     |SI aAlfa ! aTexto;
         aAlfa     = aTexto % -103;  enTipo       = aAlfa;
         aAlfa     = aTexto % -403;  enSubGrupo   = aAlfa;
         aAlfa     = aTexto % -703;  enGrupo      = aAlfa;
         enModo    = 2;

         |SI PARAMETRO = "";
             |HAZ Pantalla904;
         |FINSI;

         |SI PARAMETRO ! "";
             nTipo = 3;
             |HAZ CambiaDescri;
         |FINSI;

         |ACABA;
     |FINSI;

     aAlfa = aTexto - "SUBGRUPO";
     |SI aAlfa ! aTexto;
         aAlfa     = aTexto % -103;  enSubGrupo   = aAlfa;
         aAlfa     = aTexto % -403;  enGrupo      = aAlfa;
         enModo    = 2;

         |SI PARAMETRO = "";
             |HAZ Pantalla903;
         |FINSI;

         |SI PARAMETRO ! "";
             nTipo = 2;
             |HAZ CambiaDescri;
         |FINSI;

         |ACABA;
     |FINSI;

     aAlfa = aTexto - "GRUPO";
     |SI aAlfa ! aTexto;
         aAlfa     = aTexto % -103;
         enGrupo   = aAlfa;
         enModo    = 2;

         |SI PARAMETRO = "";
             |SI #1#8 = "S";
                 |HAZ Pantalla902;
             |SINO;
                 enSubGrupo = 1;
                 enTipo     = 1;

                 |HAZ Pantalla904;
             |FINSI;
         |FINSI;

         |SI PARAMETRO ! "";
                              nTipo = 1;
             |SI #1#8 = "N";
                 enSubGrupo = 1;
                 enTipo     = 1;
                 nTipo      = 3;
             |FINSI;
             |HAZ CambiaDescri;
         |FINSI;

         |ACABA;
     |FINSI;
|FPRC;

|PROCESO EventoTree;
     |SI FEntrada = 0;
         aAlfa       = Contenido;  |QBF aAlfa;
         aTexto      = "";
         aLong       = aAlfa % 0;
         nLong       = aLong;
         nCargar     = 0;
         |PARA nPosi = 1;  |SI nPosi [ nLong;  |HACIENDO nPosi = nPosi + 1;
               nPos = (nPosi * 100) + 1;
               aCarac = aAlfa % nPos;

               |SI nCargar = 1;
                   aTexto = aTexto + aCarac;
               |FINSI;

               |SI aCarac = ":";  nCargar = 1; |FINSI;
         |SIGUE;

         aAlfa = aTexto - "NUEVO";

         |ESTADO_CONTROL nBoton, "ENABLE";

         |SI aTexto ! aAlfa;
             |ESTADO_CONTROL nBoton, "DISABLE";
         |FINSI;

         |ACABA;
     |FINSI;

     aAlfa = aTexto - "NUEVO";
     |SI aAlfa ! aTexto;
         |HAZ CreaNuevo;

         aBusca = aTexto;
         |HAZ MontaArbol;
         |ACABA;
     |FINSI;

     |HAZ SacaPantalla;

     aBusca = aTexto;
     |HAZ MontaArbol;
|FPRC;

|PROCESO dsarm004B;
     |BORRA 020#4a;
     |LIBERA #4;
|FPRC;

|DEFBUCLE dsarm004B;
     #4#1;
     ;
     #2#0, nDSubGrupo,   0;
     #2#0, nHSubGrupo, 999;
     be;
     NULL, dsarm004B;
|FIN;

|PROCESO dsarm003B;
     |BORRA 020#3a;
     |LIBERA #3;
|FPRC;

|DEFBUCLE dsarm003B;
     #3#1;
     ;
     #2#0,   0;
     #2#0, 999;
     be;
     NULL, dsarm003B;
|FIN;

|PROCESO BorraDir;          ||Borra todos los archivos de aDirectorio
     aDirec = "";
     |DIRECTORIO aDirec; |QBF aDirec;
     |SI aDirectorio ! "/";
         aAlfa1 = aDirec + "bin/agirm -r " + aDirectorio;
         |SYSTEM aAlfa1;
     |FINSI;
|FPRC;

|PROCESO BorraGrupo;
     aAlfa     = aTexto % -103;
     enGrupo   = aAlfa;

     #2#0  =  enGrupo;
     |LEE 101#2=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aAlfa = #2#2;  |QBF aAlfa;
     |SI aAlfa = "";
         aMensaje = "0000Error: La Ubicacion de los Documentos esta vacia. [Grupo]";
         |MENAV aMensaje;
         |LIBERA #2;
         |ACABA;
     |FINSI;

     nDSubGrupo = 000;
     nHSubGrupo = 999;

     |BUCLE dsarm003B;
     |BUCLE dsarm004B;

     eaGrupoBorra = #2#0;
     eaSubBorra   = "*";
     eaTipoBorra  = "*";
     |HAZ BorraRegistro;

     aDirectorio = aDirectorio + "/" + #2#2;
     |QBF aDirectorio;
     aDirectorio = aDirectorio + "/";

     |SI #1#7 = "N";  |HAZ BorraDir;  |FINSI;

     |BORRA 020#2a;
     |LIBERA #2;

     |LEE 000#2p;
     aBusca = "GRUPO" + (("000" + #2#0) % -103);
     |HAZ MontaArbol;
|FPRC;

|PROCESO BorraSubGrupo;
     aAlfa     = aTexto % -103;  enSubGrupo   = aAlfa;
     aAlfa     = aTexto % -403;  enGrupo      = aAlfa;

     #2#0  =  enGrupo;
     |LEE 000#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

     #3#0  =  enGrupo;
     #3#1  =  enSubGrupo;
     |LEE 101#3=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aAlfa = #3#3;  |QBF aAlfa;
     |SI aAlfa = "";
         aMensaje = "0000Error: La Ubicacion de los Documentos esta vacia. [Subgrupo]";
         |MENAV aMensaje;
         |LIBERA #3;
         |ACABA;
     |FINSI;

     nDSubGrupo = #3#1;
     nHSubGrupo = #3#1;

     |BUCLE dsarm004B;

     eaGrupoBorra = #3#0;
     eaSubBorra   = #3#1;
     eaTipoBorra  = "*";
     |HAZ BorraRegistro;

     aDirectorio = aDirectorio + "/" + #2#2;
     |QBF aDirectorio;
     aDirectorio = aDirectorio + "/" + #3#3;
     |QBF aDirectorio;
     aDirectorio = aDirectorio + "/";

     |SI #1#7 = "N";  |HAZ BorraDir;  |FINSI;

     |BORRA 020#3a;
     |LIBERA #3;

     aBusca = "GRUPO" + (("000" + #2#0) % -103);
     |HAZ MontaArbol;
|FPRC;

|PROCESO BorraTipo;
     aAlfa     = aTexto % -103;  enTipo       = aAlfa;
     aAlfa     = aTexto % -403;  enSubGrupo   = aAlfa;
     aAlfa     = aTexto % -703;  enGrupo      = aAlfa;

     #2#0  =  enGrupo;
     |LEE 000#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

     #3#0  =  enGrupo;
     #3#1  =  enSubGrupo;
     |LEE 000#3=;
     |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;

     #4#0  =  enGrupo;
     #4#1  =  enSubGrupo;
     #4#2  =  enTipo;
     |LEE 101#4=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aAlfa = #4#4;  |QBF aAlfa;
     |SI aAlfa = "";
         aMensaje = "0000Error: La Ubicacion de los Documentos esta vacia. [Tipo]";
         |MENAV aMensaje;
         |LIBERA #4;
         |ACABA;
     |FINSI;

     eaGrupoBorra = #4#0;
     eaSubBorra   = #4#1;
     eaTipoBorra  = #4#2;
     |HAZ BorraRegistro;

     aDirectorio = aDirectorio + "/" + #2#2;
     |QBF aDirectorio;
     aDirectorio = aDirectorio + "/" + #3#3;
     |QBF aDirectorio;
     aDirectorio = aDirectorio + "/" + #4#4;
     |QBF aDirectorio;
     aDirectorio = aDirectorio + "/";

     |SI #1#7 = "N";  |HAZ BorraDir;  |FINSI;

     |BORRA 020#4a;
     |LIBERA #4;

     aBusca = "SUBGRUPO" + (("000" + #4#0) % -103) + (("000" + #4#0) % -103);
     |HAZ MontaArbol;
|FPRC;

|PROCESO BajaPanta2;
     #dsarm002#0 = 001;
|FPRC;

|PROCESO AltaPanta2;
     #dsarm002#0 = 999;
|FPRC;

|PROCESO BajaPanta3;
     #dsarm003#0 = nGrupoDes;
     #dsarm003#1 = 001;
|FPRC;

|PROCESO AltaPanta3;
     #dsarm003#0 = nGrupoDes;
     #dsarm003#1 = 999;
|FPRC;

|PROCESO EventoPanta2tipo;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#dsarm002.=;
     |FINSI;
     |SI FSalida = 4;
          nGrupoDes = #dsarm002#0;
          aDesDes = #dsarm002#1;
          aCarpetaDes = #dsarm002#2;
          nSwSeleccion = 1;
          |PTEC 806;
     |FINSI;
|FPRC;

|PROCESO EventoPanta2;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#dsarm002.=;
     |FINSI;
     |SI FSalida = 4;
          nGrupoDes = #dsarm002#0;
          aDesDes = #dsarm002#1;
          aCarpetaDes = #dsarm002#2;
          |SI nGrupoDes = enGrupo;
/*
               aMensaje = "0000No es posible seleccionar como grupo destino, el mismo grupo origen";
               |MENAV aMensaje;
*/
               nSwCopiaSubEnMismoGrupo = 1;

               nSwSeleccion = 1;
               |PTEC 806;
          |SINO;
               nSwCopiaSubEnMismoGrupo = 0;
               nSwSeleccion = 1;
               |PTEC 806;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO EventoPanta3;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#dsarm003.=;
     |FINSI;
     |SI FSalida = 4;
          nSubGrupoDes = #dsarm003#1;
          aDesSGDes = #dsarm003#2;
          aCarpetaSGDes = #dsarm003#3;
          |SI nGrupoDes = enGrupo; |Y nSubGrupoDes = enSubGrupo;
               aMensaje = "0000No es posible seleccionar como subgrupo destino, el mismo subgrupo origen";
               |MENAV aMensaje;
          |SINO;
               nSwSeleccion = 1;
               |PTEC 806;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO dsarm004_clona903;
     #dsarm004#0 = nGrupoDes;
     #dsarm004#1 = nSubGrupoDes;
     |GRABA 020#dsarm004.n;
     |LIBERA #dsarm004;
|FPRC;

|DEFBUCLE dsarm004_clona903;
 #dsarm004#1;
 ;
 nGrupoOri, nSubGrupoOri, 001;
 nGrupoOri, nSubGrupoOri, 999;
 ;
 NULL, dsarm004_clona903;
|FIN;

|PROCESO BorrarCarpeta;
     |CONFI "0000NVa Vd. a borrar la carpeta y los documentos que contiene, est  seguro ";
     |SI FSalida ! 0;
          |ACABA;
     |SINO;
          |CONFI "0000NPor favor, confirme el borrado de la carpeta y todos sus documentos. Realizar";
          |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     aDirectorio =  #1#1;
     |QBF aDirectorio;

     |SI aDirectorio = "";
         aMensaje = "0000Error: La Ubicacion de los Documentos esta vacia. [Parametros]";
         |MENAV aMensaje;
         |ACABA;
     |FINSI;

     |HAZ PidePassword;
     |SI enPassword = 1;  |ACABA;  |FINSI;

     aAlfa = aTexto - "TIPO";
     |SI aAlfa ! aTexto;
         |HAZ BorraTipo;

         |ACABA;
     |FINSI;

     aAlfa = aTexto - "SUBGRUPO";
     |SI aAlfa ! aTexto;
         |HAZ BorraSubGrupo;

         |ACABA;
     |FINSI;

     aAlfa = aTexto - "GRUPO";
     |SI aAlfa ! aTexto;
         |HAZ BorraGrupo;
     |FINSI;
|FPRC;

|PROCESO CargaArbol;
     |QBF aAlfa;
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO dsarm004;
     aNom = #dsarm004#3;
     |SI PARAMETRO ! "";
         aNom = #dsarm004#93;  |QBF aNom;
         |SI aNom = "";
             #dsarm004#93 = #dsarm004#3;
         |FINSI;
         aNom = #dsarm004#93;  |QBF aNom;

         |SI #dsarm004#94 = "S";
             aNom = aNom + " (Se muestra en compartir como " + #dsarm004#95;  |QBF aNom;
             aNom = aNom + ")";
         |FINSI;
     |FINSI;

     |GRABA 020#dsarm004.a;
     |LIBERA #dsarm004;

     nCarpeta3 = nCarpeta3 + 1;
     aAlfa     = nCarpeta1 + "," + nCarpeta2 + "," + nCarpeta3 + ":";
     aAlfa     = aAlfa + (("000" + #4#2) % -103) + " - " + aNom;  |QBF aAlfa;
     aAlfa     = aAlfa + "{{TIPO" + (("000" + #4#0) % -103) + (("000" + #4#1) % -103) + (("000" + #4#2) % -103) + "}}";
     |HAZ CargaArbol;
|FPRC;

|DEFBUCLE dsarm004;
     #4#1;
     ;
     #3#0, #3#1, 001;
     #3#0, #3#1, 999;
     be;
     NULL, dsarm004;
|FIN;

|PROCESO dsarm003;
     aNom = #dsarm003#2;
     |SI PARAMETRO ! "";
         aNom = #dsarm003#6;  |QBF aNom;
         |SI aNom = "";
             #dsarm003#6 = #dsarm003#2;
         |FINSI;
         aNom = #dsarm003#6;
     |FINSI;

     |GRABA 020#dsarm003.a;
     |LIBERA #dsarm003;

     nCarpeta2 = nCarpeta2 + 1;
     aAlfa     = nCarpeta1 + "," + nCarpeta2 + ":" + (("000" + #3#1) % -103) + " - " + aNom;  |QBF aAlfa;
     aAlfa     = aAlfa + "{{SUBGRUPO" + (("000" + #3#0) % -103) + (("000" + #3#1) % -103) + "}}";
     |HAZ CargaArbol;

     nCarpeta3 = 0;

     |BUCLE dsarm004;

     |SI PARAMETRO ! "";  |ACABA;  |FINSI;

     nCarpeta3 = nCarpeta3 + 1;
     aAlfa = nCarpeta1 + "," + nCarpeta2 + "," + nCarpeta3;
     aAlfa = aAlfa + ":* NUEVO TIPO {{NUEVOTIPO" + (("000" + #3#0) % -103) + (("000" + #3#1) % -103) + "}}";
     |HAZ CargaArbol;
|FPRC;

|DEFBUCLE dsarm003;
     #3#1;
     ;
     #2#0, 001;
     #2#0, 999;
     be;
     NULL, dsarm003;
|FIN;

|PROCESO dsarm002;
     aNom = #dsarm002#1;
     |SI PARAMETRO ! "";
         aNom = #dsarm002#5;  |QBF aNom;
         |SI aNom = "";
             #dsarm002#5 = #dsarm002#1;
         |FINSI;
         aNom = #dsarm002#5;
     |FINSI;

     |GRABA 020#dsarm002.a;
     |LIBERA #dsarm002;

     nCarpeta1 = nCarpeta1 + 1;
     aAlfa     = nCarpeta1 + ":" + (("000" + #2#0) % -103) + " - " + aNom;  |QBF aAlfa;
     aAlfa     = aAlfa + "{{GRUPO" + (("000" + #2#0) % -103) + "}}";
     |HAZ CargaArbol;

     nCarpeta2 = 0;
     nCarpeta3 = 0;

     |SI #1#8 = "S";
         |BUCLE dsarm003;

         |SI PARAMETRO ! "";  |ACABA;  |FINSI;

         nCarpeta2 = nCarpeta2 + 1;
         aAlfa = nCarpeta1 + "," + nCarpeta2 + ":* NUEVO SUBGRUPO {{NUEVOSUBGRUPO" + (("000" + #2#0) % -103) + "}}";
         |HAZ CargaArbol;
     |FINSI;
|FPRC;

|DEFBUCLE dsarm002;
     #2#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dsarm002;
|FIN;

|PROCESO MontaArbol;
     |SI nTree ! -1;
         |FIN_CONTROL_WINDOWS nTree;
         nTree = -1;
     |FINSI;

     |CONTROL_SIMPLE 0, "LABEL,{{5}}Cargando informaci¢n ...", 1315, 1680, NULL;
     nBotonLabel = FSalida;

     |PTEC 802;  |PAUSA;

     |DBASE aBase;  |QBF aBase;
     aAlfa = aBase + "tmp";          |MKDIR aAlfa;

     eaRutaOrigen  = aBase + "tmp/";

     |SI #1#7 = "N";
          |HAZ DimeUnidad;
          eaRutaDestino = eaUnidad + ":\documentos\tmp";  |RMKDIR eaRutaDestino;
          eaRutaDestino = eaUnidad + ":\documentos\tmp\";
     |SINO;
          |HAZ LeeUnidadBasico;
          eaRutaDestino = eaUnidadBasico + "\documentos\tmp";   |RMKDIR eaRutaDestino;
          eaRutaDestino = eaUnidadBasico + "\documentos\tmp\";
     |FINSI;
     eaFicheroTxt  = "dsarm00201" + Usuario + ".txt";
     eaFicheroTgz  = "dsarm00201" + Usuario + ".tgz";
     eaFicheroTar  = "dsarm00201" + Usuario + ".tar";

     aAbre = eaRutaOrigen + eaFicheroTxt;

     sT_nID   = nTree;
     sT_nOper = 0;

     |XABRE "WB", aAbre, nHandle;

     nCarpeta1 = 0;
     nCarpeta2 = 0;
     nCarpeta3 = 0;

     |BUCLE dsarm002;

     |SI PARAMETRO = "";
         nCarpeta1 = nCarpeta1 + 1;
         aAlfa = nCarpeta1 + ":* NUEVO GRUPO {{NUEVOGRUPO}}";
         |HAZ CargaArbol;
     |FINSI;

     |XCIERRA nHandle;

     |HAZ TraeTxtComprimido;
     aAlfa = eaRutaDestino + eaFicheroTxt;

     eaAlfa = "TREECTRL,Configuraci¢n estructura de documentos";
     |SI PARAMETRO ! "";
         eaAlfa = "TREECTRL,Configuraci¢n predeterminada de la estructura de documentos";
     |FINSI;

     eaAlfa = eaAlfa +  "{{" + aAlfa + "}}";
     |CONTROL_SIMPLE nPanta, eaAlfa, 0602, 2598, EventoTree;
     nTree = FSalida;

     eaFicheroTxt  = "dsarm00201" + Usuario + ".txt";
     aAlfa         = eaRutaDestino + eaFicheroTxt;
     |RFBORRA aAlfa;

     |FIN_CONTROL_WINDOWS nBotonLabel;

     |SI aBusca ! "";
         sT_nID   = nTree;
         sT_nOper = 3;
         sT_aData = "[" + aBusca;
         |ESPECIFICA "COMMANDCONTROL", sTree;
         aRefresca = ":" + FSalida;
     |FINSI;

     sT_nID   = nTree;
     sT_nOper = 2;
     |SI aRefresca = "";
         sT_aData = "1:";
     |SINO;
         sT_aData = aRefresca;
     |FINSI;

     |ESPECIFICA "COMMANDCONTROL", sTree;
     |PULSATECLA;

     |FOCOTECLADO nTree;
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     |ABRET #2;
     |ABRET #3;
     |ABRET #4;

     FSalida = 2699;
|FPRC;

|PROCESO Tipo90;  |TIPO 90;
     |CIERRAT #2;
     |CIERRAT #3;
     |CIERRAT #4;
|FPRC;

|PROCESO ControlRepe; |TIPO 0;
/*

     ||Ahora se comparan todos los campos marcados. No esta limitado a unicamente 2 campos
     |SI #1#25 = "S";
          |SI #dsarw004#Campo# = "S";
               nCuentaX = 0;
               |PARA nCampoD = 38;  |SI nCampoD [ 57;  |HACIENDO nCampoD = nCampoD + 1;
                    |SI #904nCampoD = "S";
                         nCuentaX = nCuentaX + 1;
                    |FINSI;
               |SIGUE;
               |SI nCuentaX > 2;
                    aMensaje = "0000El maximo de campos comparables son 2";
                    |MENAV aMensaje;
                    #dsarw004#Campo# = "N";
                    |PINTA #dsarw004#Campo#;
               |FINSI;
          |FINSI;
     |FINSI;
*/
|FPRC;

|PROCESO Obligatorio; |TIPO 0;
     aAux = #dsarw004#Campo#;
     |QBF aAux;
     |SI aAux ! "N";
          nValor = Campo;
          |SI nValor ] 58; |Y nValor [ 62;
               nBusco = Campo - 49;
          |FINSI;
          |SI nValor ] 63; |Y nValor [ 67;
               nBusco = Campo - 33;
          |FINSI;
          |SI nValor ] 68; |Y nValor [ 77;
               nBusco = Campo - 54;
          |FINSI;
          aAux = #dsarw004#nBusco#;
          |QBF aAux;
          |SI aAux = "";
               aMensaje = "0000Campo NO definido. No es posible ponerlo como obligado";
               |MENAV aMensaje;
               #dsarw004#Campo# = "N";
               |PINTA #dsarw004#Campo#;
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Asistente;
     |VENTANA 0501, 3599, -1, 0, "";
     nVent = FSalida;

     |PTEC 802;  |PAUSA;

     |SUB_EJECUTA "dsarz020";
     |SUB_EJECUTA "dpntm003;ACTUALIZAR";

     |FINVENTANA nVent;

     |HAZ MontaArbol;
|FPRC;

|PROGRAMA;
     |ABRE #1;
     |LEE 000#1p;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |PINPA #0#2;  nPanta = FSalida;

     |SI PARAMETRO = "";
         |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Asistente Copiar/Mover estructuras", 2601, 2728, Asistente;
         nBotonAsis = FSalida;

         |CONTROL_SIMPLE nPanta, "BOTON,{{199}}Borrar carpeta", 2680, 2698, BorrarCarpeta;
         nBoton = FSalida;
     |FINSI;

     enCambio = 0;

     |HAZ MontaArbol;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nTree;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nTree;

     |SI PARAMETRO ! "";  |ACABA; |FINSI;

     |FIN_CONTROL_WINDOWS nBoton;
     |FIN_CONTROL_WINDOWS nBotonAsis;

     |PULSATECLA;

     |SI enCambio = 1;
         |SUB_EJECUTA "dpntm003;ACTUALIZAR";
     |FINSI;

     |SI #1#191 = "S";  |Y enCambio = 1;
         |MENAV "0000Se va a proceder a regenerar la tabla de la vistas r pidas con las descripciones modificadas";

         |SUB_EJECUTA "dsarz050";
     |FINSI;

     enCambio = 0;
|FPRO;
