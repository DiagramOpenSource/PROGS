|FICHEROS;
     dsarm001;
     dsarm002;
     dsarm004;
     dsarm059;

     dsarw004;

     dsarm024;
|FIN;

|VARIABLES;
     aCarpetaAnt = "";

     aCarpeta   = "";
     aMensaje   = "";
     aAlfa      = "";

     aAux = "";
     nSwEstaCarpeta = 0;
     nGrupoEstoy = 0;
     nSubGrupoEstoy = 0;
     nTipoEstoy = 0;
     aTipoRepe = "";
     aGrupoRepe = "";

     &enModo        = 0;
|FIN;

|| ------------------------------------------------------
|| Procesos Grabacion del TipoDoc
|| ------------------------------------------------------

|PROCESO Tipo12Fw4;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     |SI #dsarm001#8 = "N";
         aCarpeta = #dsarw004#2;
     |SINO;
         aCarpeta = #dsarw004#8;
     |FINSI;

     |QBT aCarpeta;
     |SI aCarpeta = "";
          aMensaje = "0000Carpeta Vacia. Por favor, introduzca un nombre valido.";
          |MENAV aMensaje;
          |ERROR;
          |ACABA;
     |FINSI;
|FPRC;

|PROCESO Tipo0C93Fw4;  |TIPO 0;
     aAlfa = #dsarw004#93;  |QBF aAlfa;
     |SI aAlfa = "";  |ACABA;  |FINSI;

     |ABRE #dsarm059;
     #dsarm059#0 = #dsarw004#93;
     |LEE 000#dsarm059.=;
     |SI FSalida ! 0;
         |MENAV "0000No existe la vista general.";
         |ERROR;
     |FINSI;
     |CIERRA #dsarm059;
|FPRC;

|PROCESO Tipo0C35Fw4;  |TIPO 0;
     |C_M #dsarw004#36, 1, "S";

     |SI #dsarw004#35 = "N";
         |C_M #dsarw004#36, 1, "N";  #dsarw004#36 = "N";
     |FINSI;

     |PINTA #dsarw004#36;
|FPRC;

|PROCESO Tipo0C24Fw4;  |TIPO 0;
     |C_M #dsarw004#25, 1, "S";
     |C_M #dsarw004#26, 1, "S";
     |C_M #dsarw004#27, 1, "S";

     |SI #dsarw004#24 = "N";
         |C_M #dsarw004#26, 1, "N";  #dsarw004#26 = "N";
         |C_M #dsarw004#27, 1, "N";  #dsarw004#27 = "N";
         |C_M #dsarw004#79, 1, "N";  #dsarw004#79 = "N";
     |SINO;
         |C_M #dsarw004#25, 1, "N";  #dsarw004#25 = "N";

         |SI #dsarm001#122 ! "N";
             |C_M #dsarw004#79, 1, "S";
         |FINSI;
     |FINSI;

     |PINTA #dsarw004#25;
     |PINTA #dsarw004#26;
     |PINTA #dsarw004#27;
     |PINTA #dsarw004#79;

     |HAZ ControlPide;
|FPRC;

|PROCESO dsarm002_carpetagrupo;
     |SI #dsarm002#0 ! nGrupoEstoy;
          aAux = #dsarm002#2;
          |QBF aAux;
          |SI aAux = aCarpeta;
               nSwEstaCarpeta = 1;
               aGrupoRepe = #dsarm002#0;
               |QBF aGrupoRepe;
               |ERROR10;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsarm002_carpetagrupo;
 #dsarm002#1;
 ;
 INICIO;
 FINAL;
 ;
 NULL, dsarm002_carpetagrupo;
|FIN;

|PROCESO MiraCarpetaw002grupo;
     nGrupoEstoy = #dsarw004#0;
     nSubGrupoEstoy = #dsarw004#3;
     nTipoEstoy = #dsarw004#6;

     |BUCLE dsarm002_carpetagrupo;
|FPRC;

|PROCESO dsarm024_mira;
     aAux = #dsarm024#2;
     |QBT aAux;
     |SI aAux = aCarpeta;
          nSwEstaCarpeta = 1;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE dsarm024_mira;
 #dsarm024#1;
 ;
 INICIO;
 FINAL;
 ;
 NULL, dsarm024_mira;
|FIN;

|PROCESO MiraRestoUbicacionesw004;
     |BUCLE dsarm024_mira;
|FPRC;

|PROCESO Tipo0C84w004; |TIPO 0;
     |C_M #dsarw004#88, 1, "S";
     |C_M #dsarw004#90, 1, "S";
     |C_M #dsarw004#94, 1, "S";

     |SI #dsarw004#84 = "N";
          #dsarw004#88 = "N";                 |C_M #dsarw004#88, 1, "N";
          #dsarw004#90 = "N";                 |C_M #dsarw004#90, 1, "N";
          #dsarw004#94 = 0;                   |C_M #dsarw004#94, 1, "N";
          #dsarw004#95 = "*Sin determinar*";
     |FINSI;

     |PINTA #dsarw004#88;
     |PINTA #dsarw004#90;
     |PINTA #dsarw004#94;
     |PINTA #dsarw004#95;
|FPRC;

|PROCESO Tipo0C27Fw4;  |TIPO 0;
     |C_M #dsarw004#90, 1, "S";
     |SI #dsarw004#27 = "S";
         |C_M #dsarw004#90, 1, "N";  #dsarw004#90 = "N";  |PINTA #dsarw004#90;
     |FINSI;

     |PINTA #dsarw004#90;
|FPRC;

|PROCESO Tipo0C2Fw4;  |TIPO 0;
     |C_M #dsarw004#2, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     aAlfa    = Contenido;  |QBF aAlfa;
     aCarpeta = #dsarw004#2;     |QBF aCarpeta;

     |SI aCarpeta ! "";
         nSwEstaCarpeta = 0;
         |HAZ MiraCarpetaw002grupo;
         |SI nSwEstaCarpeta = 1;
              aMensaje = "0000Carpeta ubicaci¢n [" + aCarpeta + "] ya utilizado en Grupo: " + aGrupoRepe;
              |MENAV aMensaje;
              |ERROR;
              |ACABA;
         |SINO;
              ||Ahora la carpeta del dsarm024, es una carpeta de la maquina local
              ||HAZ MiraRestoUbicacionesw004;
              |SI nSwEstaCarpeta = 1;
                   aMensaje = "0000Carpeta ubicaci¢n [" + aCarpeta + "] ya utilizado en Prep.Documentaci¢n.";
                   |MENAV aMensaje;
                   |ERROR;
                   |ACABA;
              |FINSI;
         |FINSI;
     |FINSI;

     |SI aAlfa ! "";
         |SI #dsarw004#2 ! Contenido;
             |SI aCarpeta = "";
                 #dsarw004#2 = Contenido;
             |SINO;
                 aCarpetaAnt = Contenido;
                 |QBF aCarpetaAnt;
                 aMensaje = "0000El cambio de ubicaci¢n desvincular  los archivos ya existentes en [" + aCarpetaAnt + "]";
                 |MENAV aMensaje;
                 |CONFI "0000NContinuar?";
                 |SI FSalida ! 0;
                     #dsarw004#2 = Contenido;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     aCarpeta = #dsarw004#2;
     |QBT aCarpeta;
     |SI aCarpeta = "";
          aMensaje = "0000Carpeta Vacia. Por favor, introduzca un nombre valido.";
          |MENAV aMensaje;
          |ERROR;
     |SINO;
          #dsarw004#2 = aCarpeta;
          |PINTA #dsarw004#2;
     |FINSI;
|FPRC;

|PROCESO dsarm004_carpeta;
     |SI #dsarm004#2 ! nTipoEstoy;
          aAux = #dsarm004#4;
          |QBF aAux;
          |SI aAux = aCarpeta;
               nSwEstaCarpeta = 1;
               aTipoRepe = #dsarm004#3;
               |QBF aTipoRepe;
               |ERROR10;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsarm004_carpeta;
 #dsarm004#1;
 ;
 nGrupoEstoy, nSubGrupoEstoy, 001;
 nGrupoEstoy, nSubGrupoEstoy, 999;
 ;
 NULL, dsarm004_carpeta;
|FIN;

|PROCESO MiraCarpetaw004;
     nGrupoEstoy = #dsarw004#0;
     nSubGrupoEstoy = #dsarw004#3;
     nTipoEstoy = #dsarw004#6;

     |BUCLE dsarm004_carpeta;

     #dsarm004#0 = nGrupoEstoy;
     #dsarm004#1 = nSubGrupoEstoy;
     #dsarm004#2 = nTipoEstoy;
     |LEE 000#dsarm004.=;
|FPRC;


|PROCESO Tipo0C8Fw4;  |TIPO 0;
     |C_M #dsarw004#8, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     aAlfa    = Contenido;  |QBF aAlfa;
     aCarpeta = #dsarw004#8;     |QBF aCarpeta;

     |SI aCarpeta ! "";
         nSwEstaCarpeta = 0;
         |HAZ MiraCarpetaw004;
         |SI nSwEstaCarpeta = 1;
              aMensaje = "0000Carpeta ubicaci¢n [" + aCarpeta + "] ya utilizado en Tipo: " + aTipoRepe;
              |MENAV aMensaje;
              |ERROR;
              |ACABA;
         |FINSI;
     |FINSI;

     |SI aAlfa ! "";
         |SI #dsarw004#8 ! Contenido;
             |SI aCarpeta = "";
                 #dsarw004#8 = Contenido;
             |SINO;
                 aCarpetaAnt = Contenido;
                 |QBF aCarpetaAnt;
                 aMensaje = "0000El cambio de ubicaci¢n desvincular  los archivos ya existentes en [" + aCarpetaAnt + "]";
                 |MENAV aMensaje;
                 |CONFI "0000NContinuar?";
                 |SI FSalida ! 0;
                     #dsarw004#8 = Contenido;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     aCarpeta = #dsarw004#8;
     |QBT aCarpeta;
     |SI aCarpeta = "";
          aMensaje = "0000Carpeta Vacia. Por favor, introduzca un nombre valido.";
          |MENAV aMensaje;
          |ERROR;
     |SINO;
          #dsarw004#8 = aCarpeta;
          |PINTA #dsarw004#8;
     |FINSI;
|FPRC;

|PROCESO Tipo0C6Fw4;  |TIPO 0;
     |SI enModo ! 1;  |ACABA;  |FINSI;

     #dsarm004#0 = #dsarw004#0;
     #dsarm004#1 = #dsarw004#3;
     #dsarm004#2 = #dsarw004#6;
     |LEE 000#dsarm004.=;
     |SI FSalida = 0;
         |MENAV "0000 El Tipo ya Existe.";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tipo7C6Fw4;  |TIPO 7;
     |C_M #dsarw004#6, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |SI enModo ! 1;   |ACABA;  |FINSI;

     #dsarm004#0 = #dsarw004#0;
     #dsarm004#1 = #dsarw004#3;
     #dsarm004#2 = 999;
     |LEE 000#dsarm004.];
     |SI FSalida = 0;
         |LEE 000#dsarm004.a;
     |SINO;
         |LEE 000#dsarm004.u;
     |FINSI;

     #dsarw004#6 = 1;
     |SI FSalida = 0;  |Y #dsarm004#0 = #dsarw004#0;  |Y #dsarm004#1 = #dsarw004#3;
         #dsarw004#6 = #dsarm004#2 + 1;
     |FINSI;

     |PINTA #dsarw004#6;
|FPRC;

|PROCESO Tipo0C91Fw04; |TIPO 0;
|FPRC;

|PROCESO Tipo0C81Fw04; |TIPO 0;
|FPRC;

|PROCESO Tipo0C0Fw4;  |TIPO 0;
     |C_M #dsarw004#0, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |SI enModo ! 1;   |ACABA;  |FINSI;

     #dsarm002#0 = #dsarw004#0;
     |LEE 000#dsarm002.=;
     |SI FSalida = 0;
         |MENAV "0000 El grupo ya existe.";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO ControlPide;
     |SI #dsarm001#95 = "N";
          |C_M #dsarw004#24, 1, "N"; |PINTA #dsarw004#24;
     |FINSI;
     |SI #dsarm001#96 = "N";
          |C_M #dsarw004#25, 1, "N"; |PINTA #dsarw004#25;
     |FINSI;
     |SI #dsarm001#97 = "N";
          |C_M #dsarw004#26, 1, "N"; |PINTA #dsarw004#26;
     |FINSI;
     |SI #dsarm001#98 = "N";
          |C_M #dsarw004#27, 1, "N"; |PINTA #dsarw004#27;
     |FINSI;
     |SI #dsarm001#99 = "N";
          |C_M #dsarw004#28, 1, "N"; |PINTA #dsarw004#28;
     |FINSI;
|FPRC;

|PROCESO Tipo7C0Fw4;  |TIPO 7;
     |HAZ ControlPide;

     |C_M #dsarw004#0, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |SI enModo ! 1;   |ACABA;  |FINSI;

     |LEE 000#dsarm002.u;
     |SI FSalida ! 0;  |DDEFECTO #dsarm002;  |FINSI;

     #dsarw004#0 = #dsarm002#0 + 1;  |PINTA #dsarw004#0;
|FPRC;

|PROCESO Tipo0C78Fw4; |TIPO 0;
     |SI #dsarw004#78 ! Contenido;
          |SI #dsarm001#8 = "N";
               aCarpetaAnt = #dsarw004#2;
          |SINO;
               aCarpetaAnt = #dsarw004#8;
          |FINSI;
          |QBF aCarpetaAnt;
          |SI #dsarw004#78 = "N";
               aCarpetaAnt = aCarpetaAnt + "/AAAAMM";
               |QBF aCarpetaAnt;
          |FINSI;
          aMensaje = "0000El cambio de ubicaci¢n desvincular  los archivos ya existentes en [" + aCarpetaAnt + "]";
          |MENAV aMensaje;
          |CONFI "0000NContinuar?";
          |SI FSalida ! 0;
               #dsarw004#78 = Contenido;
          |FINSI;
     |FINSI;
|FPRC;
