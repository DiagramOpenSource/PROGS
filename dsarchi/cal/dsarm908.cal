|FICHEROS;
     dsarm002 #2;
     dsarm003 #3;
     dsarm004 #4;

     dsarw015 #915,MANTE;

     dsarm044 #44;
|FIN;

|VARIABLES;
     &eaVista = "";

     aIP             = "";
     aMensaje        = "";
     aTempo67        = "";
     aDescripcion    = "";
     aCarpeta        = "";
     aCodigo         = "";
     aTecla          = "";
     aEsc1           = "";
     aEsc2           = "";
     aRetu           = "";
     aMarca          = "";
     aAlfa           = "";

     nVent44        = 0;
     nGrid44        = 0;
     nRango          = 0;

     {-1}aVent       = "";
         aVent1      = 0;
         aVent2      = 0;
         aVent3      = 0;
         aVent4      = 0;
         aVent5      = "";

     &Tempo          = "";
     &enBotonOCR     = 0;
     &enBotondsEscan = 0;
     &eaCodVista     = "";
|FIN;

|PROCESO dsarm004_44;
     aCodigo = ((("000" + #4#0) % -103) + (("000" + #4#1) % -103) + (("000" + #4#2) % -103));

     |ABRE #2;
     |DDEFECTO #2;
     #2#0 = #4#0;
     |LEE 000#2=;
     |CIERRA #2;

     aDescripcion = #2#1;
     |QBF aDescripcion;

     |ABRE #3;
     |DDEFECTO #3;
     #3#0 = #4#0;
     #3#1 = #4#1;
     |LEE 000#3=;
     |CIERRA #3;

     |SI aDescripcion = "";
          aDescripcion = #3#2;
     |SINO;
          aDescripcion = aDescripcion + " " + #3#2;
     |FINSI;
     |QBF aDescripcion;

     |SI aDescripcion = "";
          aDescripcion = #4#3;
     |SINO;
          aDescripcion = aDescripcion + " " + #4#3;
     |FINSI;
     |QBF aDescripcion;

     aCarpeta = #2#2;
     |QBF aCarpeta;
     |SI aCarpeta = "";
           aCarpeta = #3#3;
     |SINO;
           aCarpeta = aCarpeta + "/" + #3#3;
     |FINSI;
     |QBF aCarpeta;
     |SI aCarpeta = "";
           aCarpeta = #4#4;
     |SINO;
           aCarpeta = aCarpeta + "/" + #4#4;
     |FINSI;

     #44#0 = eaVista;
     #44#1 = aCodigo;
     |LEE 101#44=;
     |SI FSalida ! 0;
         |DDEFECTO #44;
         #44#0 = eaVista;
         #44#1 = aCodigo;
         |GRABA 020#44b;

         |SI #915#32 = "1";  #44#4 = "S";  |FINSI;
         |SI #915#32 = "2";  #44#4 = "N";  |FINSI;
     |FINSI;

     #44#2 = aDescripcion;
     #44#3 = aCarpeta;

     |SI #44#4 = "S";
         #44#5 = "0,185,0;255,255,255";
     |SINO;
         #44#5 = "255,0,0;255,255,255";
     |FINSI;

     |GRABA 020#44a;
     |LIBERA #44;
|FPRC;

|DEFBUCLE dsarm004_44;
     #4#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dsarm004_44;
|FIN;

|PROCESO Evento44;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#44=;
     |FINSI;

     |SI FSalida = 4;
         |LEE 101#44=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |SI #dsarm044#4 = "S";
             #dsarm044#4 = "N";
             #dsarm044#5 = "255,0,0;255,255,255";
         |SINO;
             |ABRE #dsarm004;
             aAlfa = #dsarm044#1 % 103;  #dsarm004#0 = aAlfa;
             aAlfa = #dsarm044#1 % 403;  #dsarm004#1 = aAlfa;
             aAlfa = #dsarm044#1 % 703;  #dsarm004#2 = aAlfa;
             |LEE 000#dsarm004.=;
             |SI FSalida ! 0;  |DDEFECTO #dsarm004;  |FINSI;
             |CIERRA #dsarm004;

             aAlfa = #dsarm004#90;  |QBF aAlfa;
             |SI aAlfa ! "";
                 aAlfa = "0000A tener en cuenta que este tipo est  configurado con la estructura de campos detalle " + aAlfa;
                 |MENAV aAlfa;
             |FINSI;

             #dsarm044#4 = "S";
             #dsarm044#5 = "0,185,0;255,255,255";
         |FINSI;

         eaCodVista = #44#0;

         |GRABA 020#dsarm044.a;
         |LIBERA #dsarm044;

         |REFRESCACONTROL nGrid44;
     |FINSI;
|FPRC;

|PROCESO Min44;
     #44#0 = eaVista;
     #44#1 = "000000000";
|FPRC;

|PROCESO Max44;
     #44#0 = eaVista;
     #44#1 = "999999999";
|FPRC;

|PROCESO dsarm044;
     #dsarm044#4 = aMarca;

     |SI #dsarm044#4 = "S";
         #dsarm044#5 = "0,185,0;255,255,255";
     |SINO;
         #dsarm044#5 = "255,0,0;255,255,255";
     |FINSI;

     |GRABA 020#dsarm044.a;
     |LIBERA #dsarm044;
|FPRC;

|DEFBUCLE dsarm044;
     #44#1;
     ;
     eaVista, "         ";
     eaVista, "999999999";
     be;
     NULL, dsarm044;
|FIN;

|PROCESO Todo;
     aMarca = "S";
     |BUCLE dsarm044;

     |REFRESCACONTROL nGrid44;

     eaCodVista = eaVista;
|FPRC;

|PROCESO Ninguno;
     aMarca = "N";
     |BUCLE dsarm044;

     |REFRESCACONTROL nGrid44;

     eaCodVista = eaVista;
|FPRC;

|PROCESO GrabaAcotaciones;
     |ABRE #44;
     |BUCLE dsarm004_44;
     |CIERRA #44;
|FPRC;

|PROCESO Acotaciones;
     |VENTANA 0501, 2999, -1, 17, "VERDE - ACTIVADO.  ROJO - DESACTIVADO";
     nVent44 = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent44;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |HAZ GrabaAcotaciones;

     |ABRET #44;
     |CONTROL_SIMPLE 0, "BOTON,{{235}}Activar todo", 0502, 0620, Todo;
     |CONTROL_SIMPLE 0, "BOTON,{{234}}Desactivar todo", 0522, 0640, Ninguno;
     |CONTROL_SIMPLE 0, "LABEL,{{1}}Doble click en la l¡nea para seleccionar o quitar el registro seleccionado", 0542, 0698, NULL;

     nRango  = 2 + 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#44, nRango, 0701, 2799, Min44, Max44, Evento44;
     nGrid44 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nGrid44;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent44;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVent44;

     |CIERRAT #44;
|FPRC;
