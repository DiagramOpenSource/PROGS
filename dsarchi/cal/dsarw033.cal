|FICHEROS;
     dsarm002 #2;
     dsarm003 #3;
     dsarm004 #4;

     dsarw033 #933,MANTE;
     dsarw067 #967;
|FIN;

|VARIABLES;
     nVinExte = 0;
     nSwModoVinExte = 0;
     aIP             = "";
     aMensaje        = "";
     aTempo67        = "";
     aDescripcion    = "";
     aCarpeta        = "";
     aCodigo         = "";
     aTecla          = "";
     aEsc1           = "";
     aEsc2           = "";
     aRetu           = "";

     nVent967        = 0;
     nGrid967        = 0;
     nRango          = 0;

     {-1}aVent       = "";
         aVent1      = 0;
         aVent2      = 0;
         aVent3      = 0;
         aVent4      = 0;
         aVent5      = "";

     &Tempo          = "";
     &enBotonOCR     = 0;
     &enBotondsEscan = 0;
     &enBotonVistas = 0;
|FIN;

|PROCESO dsarm004_967;
     aCodigo = ((("000" + #dsarm004#0) % -103) + (("000" + #dsarm004#1) % -103) + (("000" + #dsarm004#2) % -103));

     |ABRE #2;
     |DDEFECTO #2;
     #2#0 = #dsarm004#0;
     |LEE 000#2=;
     |CIERRA #2;

     aDescripcion = #2#1;
     |QBF aDescripcion;

     |ABRE #3;
     |DDEFECTO #3;
     #3#0 = #dsarm004#0;
     #3#1 = #dsarm004#1;
     |LEE 000#3=;
     |CIERRA #3;

     |SI aDescripcion = "";
          aDescripcion = #3#2;
     |SINO;
          aDescripcion = aDescripcion + " " + #3#2;
     |FINSI;
     |QBF aDescripcion;

     |SI aDescripcion = "";
          aDescripcion = #dsarm004#3;
     |SINO;
          aDescripcion = aDescripcion + " " + #dsarm004#3;
     |FINSI;
     |QBF aDescripcion;

     aCarpeta = #2#2;
     |QBF aCarpeta;
     |SI aCarpeta = "";
           aCarpeta = #3#3;
     |SINO;
           aCarpeta = aCarpeta + "/" + #3#3;
     |FINSI;
     |QBF aCarpeta;
     |SI aCarpeta = "";
           aCarpeta = #dsarm004#4;
     |SINO;
           aCarpeta = aCarpeta + "/" + #dsarm004#4;
     |FINSI;

     #967#0 = aCodigo;
     |LEE 101#967=;
     |SI FSalida ! 0;
         |DDEFECTO #967;
         #967#0 = aCodigo;
         |GRABA 020#967b;
     |FINSI;

     #967#1 = aDescripcion;
     #967#2 = aCarpeta;

     |SI nSwModoVinExte = 1;
          #967#3 = "255,0,0;255,255,255";                   ||ROJO
          |SI #dsarm004#86 = "S";
              #967#3 = "0,185,0;255,255,255";               ||VERDE
          |SINO;
               |SI nVinExte = 2; |Y #dsarm004#86 = "E";
                    #967#3 = "0,0,185;255,255,255";         ||AZUL
               |FINSI;
          |FINSI;
     |SINO;
          |SI #dsarm004#81 = "S"; |Y #dsarm004#87 = "S";
               #967#3 = "0,185,0;255,255,255";
          |SINO;
               |SI #dsarm004#81 = "S"; |Y #dsarm004#87 = "N";
                    #967#3 = "18,28,245;255,255,255";
               |SINO;
                    #967#3 = "255,0,0;255,255,255";
               |FINSI;
          |FINSI;
     |FINSI;

     |GRABA 020#967a;
     |LIBERA #967;
|FPRC;

|DEFBUCLE dsarm004_967;
     #dsarm004#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dsarm004_967;
|FIN;

|PROCESO Evento967;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#967=;
     |FINSI;

     |SI FSalida = 4;
         |LEE 101#967=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |ABRE #4;
         aCodigo = #967#0 % 103; #dsarm004#0 = aCodigo;
         aCodigo = #967#0 % 403; #dsarm004#1 = aCodigo;
         aCodigo = #967#0 % 703; #dsarm004#2 = aCodigo;
         |LEE 101#4=;
         |SI FSalida = 0;
             |SI nSwModoVinExte = 1;
                  |SI nVinExte = 1;
                       |SI #dsarm004#86 = "S";
                           #dsarm004#86 = "N";
                       |SINO;
                           #dsarm004#86 = "S";
                       |FINSI;
                  |SINO;
                       |SI #dsarm004#86 = "S";
                           #dsarm004#86 = "E";
                       |SINO;
                           |SI #dsarm004#86 = "E";
                                #dsarm004#86 = "N";
                           |SINO;
                                #dsarm004#86 = "S";
                           |FINSI;
                       |FINSI;
                  |FINSI;
             |SINO;
                  |SI #dsarm004#81 = "S"; |Y #dsarm004#87 = "S";
                      #dsarm004#81 = "S";
                      #dsarm004#87 = "N";
                  |SINO;
                      |SI #dsarm004#81 = "S"; |Y #dsarm004#87 = "N";
                           #dsarm004#81 = "N";
                           #dsarm004#87 = "N";
                      |SINO;
                           #dsarm004#81 = "S";
                           #dsarm004#87 = "S";
                      |FINSI;
                  |FINSI;
             |FINSI;
             |GRABA 020#4a;
             |LIBERA #4;
         |FINSI;
         |CIERRA #4;

         |SI nSwModoVinExte = 1;
              #967#3 = "255,0,0;255,255,255";
              |SI #dsarm004#86 = "S";
                   #967#3 = "0,185,0;255,255,255";
              |SINO;
                   |SI nVinExte = 2; |Y #dsarm004#86 = "E";
                        #967#3 = "0,0,185;255,255,255";         ||AZUL
                   |FINSI;
              |FINSI;
         |SINO;
              |SI #dsarm004#81 = "S"; |Y #dsarm004#87 = "S";
                  #967#3 = "0,185,0;255,255,255";
              |SINO;
                   |SI #dsarm004#81 = "S"; |Y #dsarm004#87 = "N";
                       #967#3 = "18,28,245;255,255,255";
                   |SINO;
                        #967#3 = "255,0,0;255,255,255";
                   |FINSI;
              |FINSI;
         |FINSI;

         |GRABA 020#967a;
         |LIBERA #967;

         |REFRESCACONTROL nGrid967;
     |FINSI;
|FPRC;

|PROCESO CarpetasEscan;
     |HAZ CreaTempo; aTempo67 = Tempo;
     |NOME_DAT #967 aTempo67;

     |ABRE #967;  |CIERRA #967;  |DELINDEX #967;

     |VENTANA 0501, 2799, -1, 17, "Doble click en la linea para cambiar estado: VERDE - ACTIVADO. AZUL - dsEscan SIN PANEL. ROJO - DESACTIVADO";
     nVent967 = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent967;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |ABRE #967;
     |BUCLE dsarm004_967;

     nRango  = 2 + 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#967, nRango, 0501, 2599, NULL, NULL, Evento967;
     nGrid967 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nGrid967;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent967;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVent967;

     |CIERRA #967;
     |DELINDEX #967; Tempo = aTempo67; |HAZ BoraTempo;
|FPRC;

|PROCESO CarpetasVinExteTaller;
     nVinExte = 1;       ||TALLER;
     |HAZ CarpetasVinExte;
|FPRC;

|PROCESO CarpetasVinExteClinica;
     nVinExte = 2;
     |HAZ CarpetasVinExte;
|FPRC;

|PROCESO CarpetasVinExte;                    ||Modulo TALLER (1). Modulo Clinica (2)
                                             ||nVinExte

     |HAZ CreaTempo; aTempo67 = Tempo;
     |NOME_DAT #967 aTempo67;

     |ABRE #967;
     |CIERRA #967;
     |DELINDEX #967;

     |SI nVinExte = 1;
          |VENTANA 0501, 2799, -1, 17, "Doble click en la linea para activar o desactivar. VERDE - ACTIVADO.  ROJO - DESACTIVADO";
     |SINO;
          |VENTANA 0501, 2799, -1, 17, "Doble click en la linea. VERDE - HISTORIA/EPISODIO. AZUL - SOLO HISTORIA. ROJO - DESACTIVADO";
     |FINSI;
     nVent967 = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent967;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |ABRE #967;
     nSwModoVinExte = 1;
     |BUCLE dsarm004_967;

     nRango  = 2 + 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#967, nRango, 0501, 2599, NULL, NULL, Evento967;
     nGrid967 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nGrid967;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;
     nSwModoVinExte = 0;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent967;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVent967;

     |CIERRA #967;
     |DELINDEX #967; Tempo = aTempo67; |HAZ BoraTempo;
|FPRC;

|PROCESO Tipo12Fw33;  |TIPO 12;
     |SI FSalida ! 7;
          |SI #dsarw033#3 = "S";
               aIP = #dsarw033#1;
               |QBF aIP;
               |SI aIP = "";
                    aMensaje = "0000Por favor, introduzca la IP del servidor de dsEscan";
                    |MENAV aMensaje;
                    |ERROR;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0Fw33;  |TIPO 0;
     |C_M #933#1,  1, "S";
     |C_M #933#2,  1, "S";
     |C_M #933#4,  1, "S";
     |C_M #933#10, 1, "S";
     |C_M #933#11, 1, "S";
     |C_M #933#12, 1, "S";
     |C_M #933#13, 1, "S";
     |C_M #933#14, 1, "S";
     |||C_M #933#15, 1, "S";

     |ESTADO_CONTROL enBotondsEscan, "ENABLE";
     |ESTADO_CONTROL enBotonVistas, "ENABLE";
     |ESTADO_CONTROL enBotonOCR, "ENABLE";

     |SI #933#3 = "N";
         |ESTADO_CONTROL enBotondsEscan, "DISABLE";
         |ESTADO_CONTROL enBotonVistas, "DISABLE";

         |C_M #933#1,  1, "N";
         |C_M #933#2,  1, "N";
         |C_M #933#4,  1, "N";
         |C_M #933#10, 1, "N";
         |C_M #933#11, 1, "N";
         |C_M #933#12, 1, "N";
         |C_M #933#13, 1, "N";
         |C_M #933#14, 1, "N";
         ||C_M #933#15, 1, "N";
     |FINSI;

/*
     |SI #933#0 = "N";
         |ESTADO_CONTROL enBotonOCR, "DISABLE";
     |FINSI;
*/

     |PINTA #933#1;
     |PINTA #933#2;
     |PINTA #933#4;
     |PINTA #933#10;
     |PINTA #933#11;
     |PINTA #933#12;
     |PINTA #933#13;
     |PINTA #933#14;
     ||PINTA #933#15;
|FPRC;
