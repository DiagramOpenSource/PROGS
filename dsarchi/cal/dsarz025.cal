|FICHEROS;
     dsarz025 #0;
     dsarm001 #1;
     dpntm000 #800,MANTE;

     dsarw010 #910;
     dsarw011 #911,MANTE;
     dsarw029 #929,MANTE;
     dsarw030 #930,MANTE;
     dsarw031 #931,MANTE;
     dsarw032 #932,MANTE;
     dsarw033 #933;
     dsarw034 #934,MANTE;
     dsarw035 #935,MANTE;
     dsarw036 #936,MANTE;
     dsarw038 #938,MANTE;
     dsarw044 #944,MANTE;
     dsarw049 #949,MANTE;
     dsarw059 #959,MANTE;
     dsarw061 #961,MANTE;
     dsarw066 #966,MANTE;
     dsarw082 #982,MANTE;
     dsarw083 #983,MANTE;
     dsarw116,MANTE;

     dsarw117 #117,MANTE;

     Ref0001@ #1000;

     dsarm005 #5;
|FIN;

|VARIABLES;

     nSwBLAT = 0;

     aCampo129 = "";
     nPausa = 0;
     aNomSQL = "";
     aFicheroSQL = "";

     aBarra = "";
     aAuxPath = "";
     aAuxDos = "";
     aPathAhora = "";

     aSistema = "";
     aTiempoIni = "";
     nHandle2 = 0;
     aTimeout = "";
     aDBass = "";

     nPantaAbogax = 0;
     nSwLogoNominas = 0;
     nBotonFotoNomi = 0;

     aIP = "";

     nPantaOCR = 0;
     nPantaVinExte = 0;

     nGuarda = 0;
     nSwSMTPCLI = 0;
     nBotonFotoFE = 0;
     nSwLogoFacturaE = 0;
     nReplica        = 0;

     aNombreLogo = "";

     aExiste          = "";
     aPathBase        = "";
     aAuxVersion      = "";
     aPathRemoto      = "";
     aPassAra         = "";
     aMensaje         = "";
     aDirSaca         = "";
     aValor           = "";
     aPath            = "";
     aNombre          = "";
     aAdjunto         = "";
     aBorra           = "";
     aMas             = "";
     aEjecuta         = "";
     aAbre            = "";
     aBase            = "";
     aAlfa            = "";
     aEsc1            = "";
     aEsc2            = "";
     aRetu            = "";
     aTecla           = "";
     aFichero         = "";
     aCarga           = "";
     aQueQuiero       = "";
     aTexto           = "";
     aLong            = "";
     aCarac           = "";
     aRefresca        = "";
     aBusca           = "";
     aContenido       = "";
     aDirec           = "";
     aLogo            = "";
     aCaracter        = "";
     aPathLogo        = "";
     aOrigen          = "";
     aDestino         = "";
     aIPRemoto        = "";
     aPassAntes       = "";
     aFotoOrigen      = "";
     aFotoDestino     = "";
     aFoto            = "";
     aExt             = "";
     aDirLocal        = "";
     aDocRemoto       = "";
     aDocServidor     = "";
     aVistas          = "";

     nPantaDos        = 0;
     nPanta116        = 0;
     nPanta800        = 0;
     nAdjunto         = 0;
     nBotonLabel      = -1;
     nLabel           = -1;
     nHandle          = 0;
     nTree            = -1;
     nPanta           = 0;
     nSubPanta        = 0;
     nLong            = 0;
     nCargar          = 0;
     nPos             = 0;
     nPosi            = 0;
     nBotonFoto       = -1;
     nConta           = 0;
     nVent            = 0;
     nSubVent         = 0;
     nCampo           = 0;
     nTCampo          = 0;
     nCarpeta         = 0;
     nRango           = 0;
     nGrid            = 0;
     nCaracter        = 0;
     nArbol           = 0;
     nPIBOX           = 0;

     {-1}sTree        = 0;
     sT_nID           = 0;
     sT_nOper         = 0;
     sT_aData         = "";

     {-1}aVent        = "";
         aVent1       = 0;
         aVent2       = 0;
         aVent3       = 0;
         aVent4       = 0;
         aVent5       = "";

     {1}aContiene     = "";

     &eaRutaOrigen    = "";
     &eaRutaDestino   = "";
     &eaFicheroTxt    = "";
     &eaFicheroTgz    = "";
     &eaFicheroTar    = "";
     &eaAlfa          = "";
     &eaPassword      = "";
     &eaClave         = "";
     &eaCadena        = "";
     &eaClaveCorreo   = "";
     &eaClaveEntrante = "";
     &enAprobacion    = 0;
     &eaPrograma      = "";
     &enBoton1        = 0;
     &enBoton2        = 0;
     &enBoton3        = 0;
     &enBoton4        = 0;
     &enBoton5        = 0;
     &enBoton6        = 0;
     &enBoton7        = 0;
     &enBoton8        = 0;
     &enBoton9        = 0;
     &enBotonXSL      = 0;
     &enBotonConfigFE = 0;
     &enSwIOCorrecta  = 0;
     &eaUnidad        = "";
     &eaDestino       = "";
     &eaOrigen        = "";
     &enCalDESPANET   = 0;
     &enSoyDESPANET   = 0;
     &eaUnidadBasico  = "";
     &enBotonConta    = 0;
     &enBotonOCR      = 0;
     &enBotondsEscan  = 0;
     &enBotonVinExte  = 0;
     &enBotonVinExteCli = 0;
     &enBotonVistas   = 0;
     &enSwWebServiceFace = 0;
     &enBotonWSFACE = 0;
     &enCorreoMultiEmp = 0;
     &enTipoCorreo = 0;
     &enSwSMTPCLI = 0;
     &enSwBLAT = 0;
     &eaClaveBBDD = "";
     &enBotonSQL1 = 0;
     &enBotonSQL2 = 0;
     &enBotonSQL3 = 0;
     &enBotonSQL4 = 0;
     &enBotonSQL5 = 0;
     &enBotonSQL6 = 0;
     &eaPathAntes = "";
     &enAdaptarPath = 0;
     &enErrorPy     = 0;
     &eaMensaPy     = "";
|FIN;

|PROCESO Tipo12_w082; |TIPO 12;
|FPRC;

|PROCESO Tipo12_w083; |TIPO 12;
|FPRC;

|PROCESO Tipo0C18w029; |TIPO 0;
     |SI #dsarw029#18 = "S";
          |C_M #dsarw029#23, 1, "S";
     |SINO;
          |C_M #dsarw029#23, 1, "N";
          #dsarw029#23 = "N";
     |FINSI;
     |PINTA #dsarw029#23;
|FPRC;

|PROCESO Tipo0C8w034;  |TIPO 0;
     |C_M #934#9, 1, "S";

     |SI #934#8 = "N";
         |C_M #934#9, 1, "N";  #934#9 = "N";
     |FINSI;

     |PINTA #934#9;
|FPRC;

|PROCESO Tipo7C0_w082; |TIPO 7;
     |HAZ Tipo0C0_w082;
|FPRC;

|PROCESO Tipo0C0_w082; |TIPO 0;
     |SI #dsarw082#0 = "S";
          |C_M #dsarw082#1, 1, "S";
          |ESTADO_CONTROL enBotonVinExte, "ENABLE";
     |SINO;
          |C_M #dsarw082#1, 1, "N";
          |ESTADO_CONTROL enBotonVinExte, "DISABLE";
     |FINSI;
     |PINTA #dsarw082#1;
|FPRC;

|PROCESO Tipo7C0_w083; |TIPO 7;
     |HAZ Tipo0C0_w083;
|FPRC;

|PROCESO Tipo0C0_w083; |TIPO 0;
     |SI #dsarw083#0 = "S";
          |ESTADO_CONTROL enBotonVinExteCli, "ENABLE";
          |C_M #dsarw083#1, 1, "S";
          |C_M #dsarw083#2, 1, "S";
          |C_M #dsarw083#3, 1, "S";
          |C_M #dsarw083#4, 1, "S";
          |C_M #dsarw083#5, 1, "S";
     |SINO;
          |ESTADO_CONTROL enBotonVinExteCli, "DISABLE";
          |C_M #dsarw083#1, 1, "N";
          |C_M #dsarw083#2, 1, "N";
          |C_M #dsarw083#3, 1, "N";
          |C_M #dsarw083#4, 1, "N";
          |C_M #dsarw083#5, 1, "N";
     |FINSI;
     |PINTA #dsarw083#1;
     |PINTA #dsarw083#2;
     |PINTA #dsarw083#3;
     |PINTA #dsarw083#4;
     |PINTA #dsarw083#5;
|FPRC;

|PROCESO PasswordNuevo;
     |CONTROL_SIMPLE 0, "LABEL,{{1}}Introduzca password nuevo", 1117, 1150, NULL;
     nLabel = FSalida;

     E_inf     = "";
     E_sup     = "10";
     eaPassword = "";
     eaPassword = 1325 ? -1;
     |SI eaPassword ! "          ";
         eaClave = eaPassword;
         |HAZ Encripta;
         eaPassword = eaClave;
     |FINSI;

     |FIN_CONTROL_WINDOWS nLabel;

     aPassAntes = #1nCampo;
     #1nCampo   = eaPassword;

     |CONTROL_SIMPLE 0, "LABEL,{{1}}Confirme el password", 1117, 1150, NULL;
     nLabel = FSalida;

     E_inf     = "";
     E_sup     = "10";
     eaPassword = "";
     eaPassword = 1325 ? -1;
     |SI eaPassword ! "          ";
         eaClave = eaPassword;
         |HAZ Encripta;
         eaPassword = eaClave;
     |FINSI;

     |SI eaClave ! #1nCampo;
         |MENAV "0000 Password incorrecto, proceso cancelado";
         eaPassword = aPassAntes;
     |FINSI;

     |FIN_CONTROL_WINDOWS nLabel;
|FPRC;

|PROCESO VerificaPassword;
     |CONTROL_SIMPLE 0, "LABEL,{{1}}Introduzca password actual", 1117, 1150, NULL;
     nLabel = FSalida;

     E_inf      = "";
     E_sup      = "10";
     eaPassword = "";
     eaPassword = 1325 ? -1;
     |SI eaPassword ! "          ";
         eaClave = eaPassword;
         |HAZ Encripta;
     |FINSI;

     |SI eaClave ! #1nCampo;
         |MENAV "0000 Password incorrecto, proceso cancelado";
         eaPassword = #1nCampo;

         |FIN_CONTROL_WINDOWS nLabel;
         |ACABA;
     |FINSI;

     |FIN_CONTROL_WINDOWS nLabel;

     |HAZ PasswordNuevo;
|FPRC;

|PROCESO BotonConfigFE;
     ||ARA38

     |VENTANA 0501, 2799, nPanta, 17, "Configuraci¢n Factura_E por empresa";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SUB_EJECUTA_NP "dsarz052";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO BotonXSL;
     ||TODO CCC.
     ||ESTE ES el STANDARD, el que usaremos por defecto, si esta activo y no hay conf.por empresa (dscustom)
     ||Miro si existe dscustom3[01]0.xsl, sino la creo a partir del dsfacturae3[10]0.xsl
     |DBASE aPathBase;
     |QBF aPathBase;
     aAuxVersion = #dsarm001#40;
     |QBF aAuxVersion;
     |SI aAuxVersion = "3.1";
          eaOrigen = aPathBase + "plugins/dscustom310.xsl";
     |SINO;
          |SI aAuxVersion = "3.2";
               eaOrigen = aPathBase + "plugins/dscustom320.xsl";
          |SINO;
               eaOrigen = aPathBase + "plugins/dscustom300.xsl";
          |FINSI;
     |FINSI;

     |XABRE "E", eaOrigen, nHandle;
     |SI FSalida ! 0;
          |SI aAuxVersion = "3.1";
               eaOrigen = aPathBase + "plugins/dsfacturae310.xsl";
               eaDestino = aPathBase + "plugins/dscustom310.xsl";
          |SINO;
               |SI aAuxVersion = "3.2";
                    eaOrigen = aPathBase + "plugins/dsfacturae320.xsl";
                    eaDestino = aPathBase + "plugins/dscustom320.xsl";
               |SINO;
                    eaOrigen = aPathBase + "plugins/dsfacturae300.xsl";
                    eaDestino = aPathBase + "plugins/dscustom300.xsl";
               |FINSI;
          |FINSI;

          |COPIA_FICHERO eaOrigen, eaDestino;
          eaOrigen = eaDestino;
     |FINSI;

     |HAZ DimeUnidad;
     aPathRemoto = eaUnidad + ":\DOCUMENTOS";              |RMKDIR aPathRemoto;
     aPathRemoto = eaUnidad + ":\DOCUMENTOS\DSARCHI";      |RMKDIR aPathRemoto;
     |SI aAuxVersion = "3.1";
          eaDestino = aPathRemoto + "\dscustom310.xsl";
     |SINO;
          |SI aAuxVersion = "3.2";
               eaDestino = aPathRemoto + "\dscustom320.xsl";
          |SINO;
               eaDestino = aPathRemoto + "\dscustom300.xsl";
          |FINSI;
     |FINSI;
     |HAZ EnviaFicheroConMD5;

     aEjecuta = eaDestino;
     |RSYSTEM aEjecuta;

     enSwIOCorrecta = 0;
     |HAZ RecibeConMD5;
     |SI enSwIOCorrecta = 0;
          |MENAV "0000 Ha habido un error al transferir el documento al servidor. Revise Permisos y espacio disponible.";
          |ACABA;
     |FINSI;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI #1#7 = "N";  |Y aIPRemoto ! "";
          |XABRE "E", eaOrigen, nHandle;
     |SINO;
          |XABRE "EC", eaOrigen, nHandle;
     |FINSI;

     |SI FSalida < 0;
          |MENAV "0000 Ha habido un error al transferir el documento al servidor. Intentelo de nuevo";
     |FINSI;
|FPRC;

|PROCESO BotonWSFACE;
     ||ARA42
     |VENTANA 0501, 2799, nPanta, 17, "Configuraci¢n WebService FACE (Factura Electr¢nica)";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SUB_EJECUTA_NP "dsarz062";

     ||SUB_EJECUTA_NP "dsarz011";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Botones1;
     |CONTROL_SIMPLE nPantaDos, "BOTON,Editar XSL", 1669, 1679, BotonXSL;
     enBotonXSL = FSalida;

     |CONTROL_SIMPLE nPantaDos, "BOTON,Configuraci¢n Factura_E por empresa", 1833, 1860, BotonConfigFE;
     enBotonConfigFE = FSalida;

     |SI enSwWebServiceFace = 1;
          |CONTROL_SIMPLE nPantaDos, "BOTON,WS FACE", 1990, 1998, BotonWSFACE;
          enBotonWSFACE = FSalida;
     |FINSI;
|FPRC;

|PROCESO dsarm005_path;
     aAuxPath = #dsarm005#7;
     |QBF aAuxPath;

     aAuxDos = aAuxPath - eaPathAntes;
     |QBF aAuxDos;

     |SI aAuxDos ! aAuxPath;
          aAuxDos = aPathAhora + aAuxDos;
          #dsarm005#7 = aAuxDos;
          |GRABA 020#dsarm005.a;
     |FINSI;
     |LIBERA #dsarm005;
|FPRC;

|DEFBUCLE dsarm005_path;
     #dsarm005#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, dsarm005_path;
|FIN;

|PROCESO Punto1;
     |VENTANA 0501, 2799, nPanta, 17, "Configuraci¢n general";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#1p;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         |GRABA 020#1b;
     |FINSI;

     #929#0  = #1#1;
     #929#1  = #1#7;
     #929#2  = #1#8;
     #929#3  = #1#25;
     #929#4  = #1#26;
     #929#5  = #1#27;
     #929#6  = #1#40;
     #929#7  = #1#41;
     #929#8  = #1#42;
     #929#9  = #1#43;
     #929#10 = #1#44;
     #929#11 = #1#64;
     #929#12 = #1#95;
     #929#13 = #1#96;
     #929#14 = #1#97;
     #929#15 = #1#98;
     #929#16 = #1#99;
     #929#17 = #1#100;
     #929#18 = #1#164;
     #929#19 = #1#181;
     #929#20 = #1#184;
     #929#21 = #1#188;
     #929#22 = #1#191;
     #929#23 = #1#201;
     #929#24 = #1#216;
     #929#25 = #1#217;

     eaPathAntes = #929#0;
     |QBF eaPathAntes;

     |PINPA #0#929; nPantaDos = FSalida;
     |PINDA #0#929;

     |HAZ Botones1;

     enAdaptarPath = 0;
     |ENDATOS #1#929;
     |SI FSalida = 0;
         #1#01 = #929#0;
         #1#07 = #929#1;
         #1#08 = #929#2;
         #1#25 = #929#3;
         #1#26 = #929#4;
         #1#27 = #929#5;
         #1#40 = #929#6;
         #1#41 = #929#7;
         #1#42 = #929#8;
         #1#43 = #929#9;
         #1#44 = #929#10;
         #1#64 = #929#11;
         #1#95 = #929#12;
         #1#96 = #929#13;
         #1#97 = #929#14;
         #1#98 = #929#15;
         #1#99 = #929#16;
         #1#100 = #929#17;
         #1#164 = #929#18;
         #1#181 = #929#19;
         #1#184 = #929#20;
         #1#188 = #929#21;
         #1#191 = #929#22;
         #1#201 = #929#23;
         #1#216 = #929#24;
         #1#217 = #929#25;

         |GRABA 020#1a;
         |LIBERA #1;

         |SI enAdaptarPath = 1;
               aPathAhora = #1#1; |QBF aPathAhora;
               |SI eaPathAntes ! aPathAhora;
                   |VENTANA 0501, 0560, -1, 16, "Cambiando ubicaci¢n a los documentos. Espere por favor";
                   nVent = FSalida;

                   aVent1 = -1;
                   aVent2 = -1;
                   aVent3 = 0;
                   aVent4 = nVent;
                   aVent5 = "MODAL";
                   |ESPECIFICA "ESTADO_VENTANA", aVent;

                   |PTEC 802;  |PAUSA;

                   |BUCLE dsarm005_path;

                   aVent1 = -1;
                   aVent2 = -1;
                   aVent3 = 0;
                   aVent4 = nVent;
                   aVent5 = "MODELESS";
                   |ESPECIFICA "ESTADO_VENTANA", aVent;

                   |FINVENTANA nVent;
               |FINSI;
         |FINSI;
     |SINO;
         |LIBERA #1;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Punto21;
     |VENTANA 0501, 2750, -1, 16, "Configuraci¢n de campos detalle en estructura de documentos";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SUB_EJECUTA_NP "dsarm059";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Punto22;
     |VENTANA 0501, 2799, nPanta, 17, "Configuraci¢n estructura de documentos";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SUB_EJECUTA_NP "dsarm002";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Punto23;
     |SUB_EJECUTA_NP "dsarm008";
|FPRC;

|PROCESO Punto24;
     |VENTANA 1010, 1450, nPanta, 17, "Password tratamiento de documentos";
     nSubVent = FSalida;

     nLabel = -1;
     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#1p;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         |GRABA 020#1b;
     |FINSI;

     nCampo = 2;

     aPassAra = #1#2;
     |QBF aPassAra;
     |SI aPassAra = "";
         |HAZ PasswordNuevo;
         #1#2 = eaPassword;
     |SINO;
         aPassAntes = #1nCampo;
         |HAZ VerificaPassword;
         #1#2 = eaPassword;
     |FINSI;

     |GRABA 020#1a;
     |LIBERA #1;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Punto25;
     |VENTANA 0501, 1770, -1, 16, "Configuraci¢n borrado cliente desde PI";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#1p;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         |GRABA 020#1b;
     |FINSI;

     #949#0  = #1#115;
     #949#1  = #1#116;
     #949#2  = #1#117;
     #949#3  = #1#118;
     #949#4  = #1#119;
     #949#5  = #1#120;
     #949#6  = #1#121;

     |PINPA #0#949;
     |PINDA #0#949;

     |ENDATOS #1#949;
     |SI FSalida = 0;
         #1#115 = #949#0;
         #1#116 = #949#1;
         #1#117 = #949#2;
         #1#118 = #949#3;
         #1#119 = #949#4;
         #1#120 = #949#5;
         #1#121 = #949#6;

         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Punto3;
     |VENTANA 0501, 2799, nPanta, 17, "Configuraci¢n Permisos Usuarios";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SUB_EJECUTA_NP "dsarz010";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO ActualizaTiempoIni;
     ||Si desactivan el timeout, entonces borro el tiempo.ini
     ||si lo activan, genero el tiempo.ini.
     |DBASS aDBass;
     |QBF aDBass;

     aTiempoIni = aDBass + "bin/tiempo.ini";

     |SI #1#179 = "N";
          |FBORRA aTiempoIni;
     |SINO;
          |XABRE "CW", aTiempoIni, nHandle2;
          |SI FSalida ] 0;
               aTimeout = #1#180;
               |QBF aTimeout;
               |XGRABA nHandle2, aTimeout;
               |XCIERRA nHandle2;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO TraeTiempoIni;
     |SI #1#179 = "S";
          |DBASE aBase;
          |QBF aBase;
          aFotoOrigen = aBase + "dlls/tiempo.exe";
          |XABRE "E", aFotoOrigen, nHandle;
          |SI FSalida < 0;  |ACABA;  |FINSI;

          |DBASS aDBass;
          |QBF aDBass;
          aFotoDestino = aDBass + "bin/tiempo.exe";

          aContiene1 = aFotoDestino;
          |ESPECIFICA "REMOTOMD5", aContiene;
          aDocRemoto = FSalida;  |QBF aDocRemoto;

          aContiene1 = aFotoOrigen;
          |ESPECIFICA "MD5", aContiene;
          aDocServidor = FSalida;  |QBF aDocServidor;

          |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
              aIPRemoto = "";
              |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

              |SI aIPRemoto ! "";
                  |ENVIA_FICHERO aFotoOrigen, aFotoDestino;
              |SINO;
                  |COPIA_FICHERO aFotoOrigen, aFotoDestino;
              |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Punto4;
     |VENTANA 0501, 2799, nPanta, 17, "Configuraci¢n DSCORREO";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |ABRE #910;
     |DDEFECTO #910;
     |LEE 000#910.p;

     #911#0 = #910#18;
     #911#1 = #910#19;
     #911#2 = #910#1;
     #911#3 = #910#20;
     #911#4 = #910#21;
     eaClaveCorreo   = #910#22;
     eaClaveEntrante = #910#26;
     #911#5 = "*********";
     #911#6 = #910#23;
     #911#7 = #910#24;
     #911#8 = #910#25;
     #911#9 = "*********";
     #911#10 = #1#101;
     #911#11 = #1#179;
     #911#12 = #1#180;
     #911#13 = #910#140;

     |SI #911#6 = "S";
          |C_M #911#2, 1, "N";
          |PINTA #911#2;
     |SINO;
          |C_M #911#2, 1, "S";
          |PINTA #911#2;
     |FINSI;

     |PINDA #0#911;
     |ENDATOS #2#911;
     |SI FSalida = 0;
          |DDEFECTO #910;
          #910#0 = 1;
          |LEE 101#910=;
          |SI FSalida ! 0; |GRABA 020#910.b; |FINSI;

          #910#18 = #911#0;
          #910#19 = #911#1;
          #910#1 = #911#2;

          #910#20 = #911#3;
          #910#21 = #911#4;
          #910#22 = eaClaveCorreo;
          #910#23 = #911#6;
          #910#24 = #911#7;
          #910#25 = #911#8;
          #910#26 = eaClaveEntrante;

          #910#140 = #911#13;
/*
          |SI #910#23 = "S";
                |HAZ MeteCrontcom;
          |SINO;
                |HAZ SacaCrontcom;
          |FINSI;
*/

          |GRABA 020#910.a;
          |LIBERA #910;

          |LEE 101#1.p;
          |SI FSalida = 0;
               #1#101 = #911#10;
               #1#179 = #911#11;
               #1#180 = #911#12;
               |GRABA 020#1.a;
               |LIBERA #1;

               |QUE_SISTEMA aSistema;
               |SI aSistema = "ESDOS";
                    |HAZ TraeTiempoIni;
                    |HAZ ActualizaTiempoIni;
               |FINSI;
          |FINSI;

     |FINSI;

     |CIERRA #910;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;


|PROCESO Punto42;
     |VENTANA 0501, 2799, nPanta, 17, "Configuraci¢n smtp-cli";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |ABRE #910;
     |DDEFECTO #910;
     |LEE 000#910.p;

     #117#0 = #910#141;

     eaClaveCorreo = #910#142;

     #117#1 = "*********";

     |PINDA #0#117;
     |ENDATOS #2#117;
     |SI FSalida = 0;
          |DDEFECTO #910;
          #910#0 = 1;
          |LEE 101#910=;
          |SI FSalida ! 0; |GRABA 020#910.b; |FINSI;

          #910#141 = #117#0;
          #910#142 = eaClaveCorreo;

          |GRABA 020#910.a;
          |LIBERA #910;
     |FINSI;

     |CIERRA #910;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;


|PROCESO PlantillasOCR;
     |VENTANA 0501, 2799, nPanta, 17, "Plantillas de Auto-relleno campos registro";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SUB_EJECUTA_NP "dsarz034";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO PlantillasConta;
     |VENTANA 0501, 2799, nPanta, 17, "Plantillas de Auto-relleno campos CONTAGEN";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SUB_EJECUTA_NP "dsarz058";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO VistasdsEscan;
     |VENTANA 0501, 2799, nPanta, 17, "Configuraci¢n vistas  rbol dsEscan";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SUB_EJECUTA_NP "dsarz041";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO BrowseMe;
     ||TODO CCC
     aAlfa = "DSeleccione el directorio para exportacion";
     |BROWSE aAlfa;
     aAlfa = aAlfa % 2;
     |QBF aAlfa;
     |SI aAlfa ! "D";
          |SI aAlfa ! "";
               aBarra = aAlfa % -101;
               |QBF aBarra;
               |SI aBarra ! "\";
                    aAlfa = aAlfa + "\";
               |FINSI;
               #dsarw033#16 = aAlfa;
               |PINTA #dsarw033#16;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0C9;
     |SI FSalida = 13;
          ||TODO CCC
          aAlfa = "DSeleccione el directorio para importacion xml";
          |BROWSE aAlfa;
          aAlfa = aAlfa % 2;
          |QBF aAlfa;
          |SI aAlfa ! "D";
               |SI aAlfa ! "";
                    aBarra = aAlfa % -101;
                    |QBF aBarra;
                    |SI aBarra ! "\";
                         aAlfa = aAlfa + "\";
                    |FINSI;
                    #dsarw035#9 = aAlfa;
                    |PINTA #dsarw035#9;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0C16; |TIPO 0;
     |SI FSalida = 13;
          |HAZ BrowseMe;
     |FINSI;

     aAlfa = #dsarw033#16;
     |QBF aAlfa;
     |SI aAlfa ! "";
          aBarra = aAlfa % -101;
          |QBF aBarra;
          |SI aBarra ! "\";
               aAlfa = aAlfa + "\";
          |FINSI;
          #dsarw033#16 = aAlfa;
          |PINTA #dsarw033#16;
     |FINSI;
|FPRC;

|PROCESO Punto5;
     |VENTANA 0501, 2799, nPanta, 17, "Configuraci¢n OCR";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#1p;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         |GRABA 020#1b;
     |FINSI;

     |DDEFECTO #933;

     #933#0  = #1#45;
     #933#1  = #1#166;
     #933#2  = #1#167;
     #933#3  = #1#168;
     #933#4  = #1#169;
     #933#5  = #1#170;
     #933#6  = #1#171;
     #933#7  = #1#172;
     #933#8  = #1#173;
     #933#9  = #1#174;
     #933#10 = #1#175;
     #933#11 = #1#176;
     #933#12 = #1#177;
     #933#13 = #1#178;
     #933#14 = #1#182;
     #933#15 = #1#185;
     #933#16 = #1#189;
     #933#17 = #1#199;
     #933#18 = #1#218;

     |PINPA #0#933;
     nPantaOCR = FSalida;

     |CONTROL_SIMPLE nPantaOCR, "BOTON,Activar / Desactivar carpetas dsEscan", 1654, 1698, CarpetasEscan;
     enBotondsEscan  = FSalida;

     |CONTROL_SIMPLE nPantaOCR, "BOTON,Configuraci¢n vistas  rbol dsEscan", 1754, 1798, VistasdsEscan;
     enBotonVistas  = FSalida;

     |CONTROL_SIMPLE nPantaOCR, "BOTON, Plantillas de auto-relleno campos registro", 1854, 1898, PlantillasOCR;
     enBotonOCR = FSalida;

     |CONTROL_SIMPLE nPantaOCR, "BOTON, Plantillas de auto-relleno campos contagen", 1954, 1998, PlantillasConta;
     enBotonConta = FSalida;

     |C_M #933#1,  1, "S";
     |C_M #933#2,  1, "S";
     |C_M #933#4,  1, "S";
     |C_M #933#10, 1, "S";
     |C_M #933#11, 1, "S";
     |C_M #933#12, 1, "S";
     |C_M #933#13, 1, "S";
     |C_M #933#14, 1, "S";
     |C_M #933#15, 1, "S";

     |SI #933#3 = "N";
         |ESTADO_CONTROL enBotondsEscan, "DISABLE";
         |ESTADO_CONTROL enBotonVistas, "DISABLE";

         |C_M #933#1,  1, "N";
         |C_M #933#2,  1, "N";
         |C_M #933#4,  1, "N";
         |C_M #933#10, 1, "N";
         |C_M #933#11, 1, "N";
         |C_M #933#12, 1, "N";
         |C_M #933#13, 1, "N";
         |C_M #933#14, 1, "N";
         |C_M #933#15, 1, "N";
     |FINSI;

     |PINDA #0#933;

     |ENDATOS #1#933;
     |SI FSalida = 0;
         #1#45 = #933#0;
         #1#166 = #933#1;
         #1#167 = #933#2;
         #1#168 = #933#3;
         #1#169 = #933#4;
         #1#170 = #933#5;
         #1#171 = #933#6;
         #1#172 = #933#7;
         #1#173 = #933#8;
         #1#174 = #933#9;
         #1#175 = #933#10;
         #1#176 = #933#11;
         #1#177 = #933#12;
         #1#178 = #933#13;
         #1#182 = #933#14;
         #1#185 = #933#15;
         #1#189 = #933#16;
         #1#199 = #933#17;
         #1#218 = #933#18;

         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;

     |FIN_CONTROL_WINDOWS enBotonOCR;
     |FIN_CONTROL_WINDOWS enBotondsEscan;
     |FIN_CONTROL_WINDOWS enBotonVistas;
     |FIN_CONTROL_WINDOWS enBotonConta;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Punto6;
     |VENTANA 0501, 2799, nPanta, 17, "Configuraci¢n CEFAX";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#1p;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         |GRABA 020#1b;
     |FINSI;

     #936#0  = #1#66;
     #936#2  = #1#67;
     #936#3  = #1#68;
     #936#4  = #1#69;
     #936#5  = #1#70;
     #936#6  = #1#71;
     #936#7  = #1#72;
     #936#8  = #1#73;

     |ABRE #dsarw010;
     |DDEFECTO #dsarw010;
     |LEE 000#dsarw010.p;
     |CIERRA #dsarw010;

     #936#9 = #dsarw010#27;
     #936#10 = #dsarw010#28;
     #936#11 = "*********";
     eaClaveCorreo = #dsarw010#29;
     #936#12  = #1#89;
     #936#13  = #1#90;
     #936#14  = #1#91;
     #936#15  = #1#92;
     #936#16  = #1#93;
     #936#17  = #1#94;

     |PINPA #0#936;
     |PINDA #0#936;

     |ENDATOS #1#936;
     |SI FSalida = 0;
         #1#66 = #936#0;
         #1#67 = #936#2;
         #1#68 = #936#3;
         #1#69 = #936#4;
         #1#70 = #936#5;
         #1#71 = #936#6;
         #1#72 = #936#7;
         #1#73 = #936#8;
         #1#89 = #936#12;
         #1#90 = #936#13;
         #1#91 = #936#14;
         #1#92 = #936#15;
         #1#93 = #936#16;
         #1#94 = #936#17;

         |GRABA 020#1a;

         |SI #936#0 = "S";
              |ABRE #dsarw010;
              |DDEFECTO #dsarw010;
              |LEE 101#dsarw010.p;
              |SI FSalida ! 0; |GRABA 020#dsarw010.b; |FINSI;
              #dsarw010#27 = #936#9;
              #dsarw010#28 = #936#10;
              #dsarw010#29 = eaClaveCorreo;
              |GRABA 020#dsarw010.a;
              |LIBERA #dsarw010;
              |CIERRA #dsarw010;
         |FINSI;
     |FINSI;
     |LIBERA #1;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Punto7;
     |VENTANA 0501, 2799, nPanta, 17, "Configuraci¢n Centralita Telef¢nica";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#1p;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         |GRABA 020#1b;
     |FINSI;

     #961#0  = #1#141;
     #961#1  = #1#142;
     #961#2  = #1#143;
     #961#3  = #1#144;
     #961#4  = #1#145;
     #961#5  = #1#146;
     #961#6  = #1#147;
     #961#7  = #1#148;
     #961#8  = #1#149;
     #961#9  = #1#150;
     #961#10  = #1#151;
     #961#11  = #1#152;
     #961#12  = #1#153;
     #961#13  = #1#154;
     #961#14  = #1#155;

     |ABRE #dsarw010;
     |DDEFECTO #dsarw010;
     |LEE 000#dsarw010.p;
     |CIERRA #dsarw010;

     #961#15 = #dsarw010#30;
     #961#16 = #dsarw010#31;
     #961#17 = "*********";
     eaClaveCorreo = #dsarw010#32;

     #961#18  = #1#156;
     #961#19  = #1#157;
     #961#20  = #1#158;
     #961#21  = #1#159;
     #961#22  = #1#160;
     #961#23  = #1#161;
     #961#24  = #1#162;

     |PINPA #0#961;
     |PINDA #0#961;

     |ENDATOS #1#961;
     |SI FSalida = 0;


         #1#141 = #961#0;
         #1#142 = #961#1;
         #1#143 = #961#2;
         #1#144 = #961#3;
         #1#145 = #961#4;
         #1#146 = #961#5;
         #1#147 = #961#6;
         #1#148 = #961#7;
         #1#149 = #961#8;
         #1#150 = #961#9;
         #1#151 = #961#10;
         #1#152 = #961#11;
         #1#153 = #961#12;
         #1#154 = #961#13;
         #1#155 = #961#14;

         #1#156 = #961#18;
         #1#157 = #961#19;
         #1#158 = #961#20;
         #1#159 = #961#21;
         #1#160 = #961#22;
         #1#161 = #961#23;
         #1#162 = #961#24;

         |GRABA 020#1a;

         |SI #961#0 = "S";
              |ABRE #dsarw010;
              |DDEFECTO #dsarw010;
              |LEE 101#dsarw010.p;
              |SI FSalida ! 0; |GRABA 020#dsarw010.b; |FINSI;
              #dsarw010#30 = #961#15;
              #dsarw010#31 = #961#16;
              #dsarw010#32 = eaClaveCorreo;
              |GRABA 020#dsarw010.a;
              |LIBERA #dsarw010;
              |CIERRA #dsarw010;
         |FINSI;
     |FINSI;
     |LIBERA #1;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Punto81;
     |VENTANA 0501, 2799, nPanta, 17, "Conexi¢n con minutas (ipfactur)";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#1p;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         |GRABA 020#1b;
     |FINSI;

     #930#0  = #1#3;
     #930#1  = #1#4;
     #930#2  = #1#5;
     #930#3  = #1#6;
     #930#4  = #1#18;
     #930#5  = #1#23;
     #930#6  = #1#28;
     #930#7  = #1#29;
     #930#8  = #1#30;
     #930#9  = #1#54;
     #930#10  = #1#192;
     #930#11  = #1#193;

     |PINPA #0#930;
     |PINDA #0#930;

     |ENDATOS #1#930;
     |SI FSalida = 0;
         #1#03 = #930#0;
         #1#04 = #930#1;
         #1#05 = #930#2;
         #1#06 = #930#3;
         #1#18 = #930#4;
         #1#23 = #930#5;
         #1#28 = #930#6;
         #1#29 = #930#7;
         #1#30 = #930#8;
         #1#54 = #930#9;
         #1#192 = #930#10;
         #1#193 = #930#11;

         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Punto82;
     |VENTANA 0501, 2799, nPanta, 17, "Conexi¢n con adConta";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#1p;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         |GRABA 020#1b;
     |FINSI;

     #931#0  = #1#9;
     #931#1  = #1#10;
     #931#2  = #1#11;
     #931#3  = #1#12;
     #931#4  = #1#13;
     #931#5  = #1#14;
     #931#6  = #1#15;
     #931#7  = #1#16;
     #931#8  = #1#17;
     #931#9  = #1#24;
     #931#10  = #1#65;

     |PINPA #0#931;
     |PINDA #0#931;

     |ENDATOS #1#931;
     |SI FSalida = 0;
         #1#09 = #931#0;
         #1#10 = #931#1;
         #1#11 = #931#2;
         #1#12 = #931#3;
         #1#13 = #931#4;
         #1#14 = #931#5;
         #1#15 = #931#6;
         #1#16 = #931#7;
         #1#17 = #931#8;
         #1#24 = #931#9;
         #1#65 = #931#10;

         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Punto821;
     |VENTANA 0501, 2799, nPanta, 17, "Configuraci¢n Contabilidad";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SUB_EJECUTA "dsarw118";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Punto83;
     |VENTANA 0501, 2799, nPanta, 17, "Conexi¢n con gesti¢n comercial";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#1p;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         |GRABA 020#1b;
     |FINSI;

     #932#0  = #1#31;
     #932#1  = #1#32;
     #932#2  = #1#34;
     #932#3  = #1#35;
     #932#4  = #1#36;
     #932#5  = #1#37;
     #932#6  = #1#38;
     #932#7  = #1#39;

     #932#8  = #1#203;
     #932#9  = #1#204;
     #932#10  = #1#205;
     #932#11  = #1#206;
     #932#12  = #1#207;
     #932#13  = #1#208;
     #932#14  = #1#209;
     #932#15  = #1#210;
     #932#16  = #1#211;
     #932#17  = #1#212;
     #932#18  = #1#213;
     #932#19  = #1#214;
     #932#20  = #1#215;

     |PINPA #0#932;
     |PINDA #0#932;

     |ENDATOS #1#932;
     |SI FSalida = 0;
         #1#31 = #932#0;
         #1#32 = #932#1;
         #1#34 = #932#2;
         #1#35 = #932#3;
         #1#36 = #932#4;
         #1#37 = #932#5;
         #1#38 = #932#6;
         #1#39 = #932#7;

         #1#203 = #932#8;
         #1#204 = #932#9;
         #1#205 = #932#10;
         #1#206 = #932#11;
         #1#207 = #932#12;
         #1#208 = #932#13;
         #1#209 = #932#14;
         #1#210 = #932#15;
         #1#211 = #932#16;
         #1#212 = #932#17;
         #1#213 = #932#18;
         #1#214 = #932#19;
         #1#215 = #932#20;

         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Punto84;
     |VENTANA 0501, 2799, nPanta, 17, "Conexi¢n con minutacion (facges)";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#1p;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         |GRABA 020#1b;
     |FINSI;

     #934#0  = #1#46;
     #934#1  = #1#47;
     #934#2  = #1#48;
     #934#3  = #1#49;
     #934#4  = #1#50;
     #934#5  = #1#51;
     #934#6  = #1#52;
     #934#7  = #1#53;
     #934#8  = #1#192;
     #934#9  = #1#193;

     |PINPA #0#934;
     |PINDA #0#934;

     |ENDATOS #1#934;
     |SI FSalida = 0;
         #1#46 = #934#0;
         #1#47 = #934#1;
         #1#48 = #934#2;
         #1#49 = #934#3;
         #1#50 = #934#4;
         #1#51 = #934#5;
         #1#52 = #934#6;
         #1#53 = #934#7;
         #1#192 = #934#8;
         #1#193 = #934#9;

         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;


|PROCESO Punto85;

     ||TODO CCC

     |VENTANA 0501, 2799, nPanta, 17, "Conexi¢n a medida personalizada";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#1p;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         |GRABA 020#1b;
     |FINSI;

     #935#0  = #1#55;
     #935#1  = #1#56;
     #935#2  = #1#57;
     #935#3  = #1#58;
     #935#4  = #1#59;
     #935#5  = #1#60;
     #935#6  = #1#61;
     #935#7  = #1#62;
     #935#8  = #1#63;
     #935#9  = #1#190;

     |PINPA #0#935;
     |PINDA #0#935;

     |ENDATOS #1#935;
     |SI FSalida = 0;
         #1#55 = #935#0;
         #1#56 = #935#1;
         #1#57 = #935#2;
         #1#58 = #935#3;
         #1#59 = #935#4;
         #1#60 = #935#5;
         #1#61 = #935#6;
         #1#62 = #935#7;
         #1#63 = #935#8;
         #1#190 = #935#9;

         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Punto86;
     |VENTANA 0501, 2799, nPanta, 17, "Configuraci¢n Laboral";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SUB_EJECUTA "dsarw045";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;



|PROCESO Punto87;        ||Gestion Abogados
     ||Copia del OCR :)
     |VENTANA 0501, 2799, nPanta, 17, "Gesti¢n abogados (ipabogax)";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#1p;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         |GRABA 020#1b;
     |FINSI;

     #966#0 = #1#165;

     |PINPA #0#966;
     nPantaAbogax = FSalida;
     |PINDA #0#966;

     |ENDATOS #1#966;
     |SI FSalida = 0;
         #1#165 = #966#0;

         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Boton1;
     nAdjunto = 1;
     |HAZ Asignar;
|FPRC;

|PROCESO Boton2;
     nAdjunto = 1;
     |HAZ VisuAdjunto;
|FPRC;

|PROCESO Boton3;
     nAdjunto = 1;
     |HAZ BorrarAdjunto;
|FPRC;

|PROCESO Boton4;
     nAdjunto = 2;
     |HAZ Asignar;
|FPRC;

|PROCESO Boton5;
     nAdjunto = 2;
     |HAZ VisuAdjunto;
|FPRC;

|PROCESO Boton6;
     nAdjunto = 2;
     |HAZ BorrarAdjunto;
|FPRC;

|PROCESO Boton7;
     nAdjunto = 3;
     |HAZ Asignar;
|FPRC;

|PROCESO Boton8;
     nAdjunto = 3;
     |HAZ VisuAdjunto;
|FPRC;

|PROCESO Boton9;
     nAdjunto = 3;
     |HAZ BorrarAdjunto;
|FPRC;

|PROCESO SacaNombre;
     aNombre = "";
     aLong = aDirSaca % A0;
     nLong = aLong;
     |PARA nConta = nLong; |SI nConta ] 1; |HACIENDO nConta = nConta - 1;
          nCampo = (100 * nConta) + 1;
          aValor = aDirSaca % nCampo;
          |SI aValor ! "/"; |Y aValor ! "\";
               aNombre = aValor + aNombre;
          |SINO;
               |SAL;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Asignar;
     |DBASE aBase;  |QBF aBase;

     aPath = "A" + "";
     |BROWSE aPath;
     aPath = (aPath % 270);
     |QBF aPath;
     |SI aPath ! "";
          aNombre = "";
          aDirSaca = aPath;
          |HAZ SacaNombre;
          |QBF aNombre;
          |SI aNombre ! "";
               ||COPIA A SERVIDOR.
               eaOrigen = aBase + "adjuntos/";
               |MKDIR eaOrigen;
               eaOrigen = eaOrigen + aNombre;
               eaDestino = aPath;
               |HAZ RecibeEnServidorMD5;

               |SI nAdjunto = 1;
                    |SI nSwLogoNominas = 1;
                         #959#1 = aNombre;
                         |PINTA #959#1;
                    |SINO;
                         #938#1 = aNombre;
                         |PINTA #938#1;
                    |FINSI;
                    |ESTADO_CONTROL enBoton2, "ENABLE";
                    |ESTADO_CONTROL enBoton3, "ENABLE";
               |FINSI;
               |SI nAdjunto = 2;
                    |SI nSwLogoNominas = 1;
                         #959#2 = aNombre;
                         |PINTA #959#2;
                    |SINO;
                         #938#2 = aNombre;
                         |PINTA #938#2;
                    |FINSI;
                    |ESTADO_CONTROL enBoton5, "ENABLE";
                    |ESTADO_CONTROL enBoton6, "ENABLE";
               |FINSI;
               |SI nAdjunto = 3;
                    |SI nSwLogoNominas = 1;
                         #959#3 = aNombre;
                         |PINTA #959#3;
                    |SINO;
                         #938#3 = aNombre;
                         |PINTA #938#3;
                    |FINSI;
                    |ESTADO_CONTROL enBoton8, "ENABLE";
                    |ESTADO_CONTROL enBoton9, "ENABLE";
               |FINSI;
          |FINSI;
     |FINSI;
     ||TODO CCC
     ||BROWSE
|FPRC;

|PROCESO VisuAdjunto;
     aNombre = "";
     |SI nAdjunto = 1;
          |SI nSwLogoNominas = 1;
               aNombre = #959#1;
          |SINO;
               aNombre = #938#1;
          |FINSI;
          |QBF aNombre;
     |FINSI;
     |SI nAdjunto = 2;
          |SI nSwLogoNominas = 1;
               aNombre = #959#2;
          |SINO;
               aNombre = #938#2;
          |FINSI;
          |QBF aNombre;
     |FINSI;
     |SI nAdjunto = 3;
          |SI nSwLogoNominas = 1;
               aNombre = #959#3;
               |QBF aNombre;
          |SINO;
               aNombre = #938#3;
               |QBF aNombre;
          |FINSI;
     |FINSI;


     |SI aNombre = "";
          aMensaje = "0000No hay Documento que mostrar";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     |DBASE aBase;
     |QBF aBase;
     eaOrigen = aBase + "adjuntos/" + aNombre;

     eaUnidad = "";
     |HAZ DimeUnidad;
     |SI eaUnidad = "";
          eaUnidad = "C";
     |FINSI;
     eaDestino = eaUnidad + ":\documentos\dsarchi\" + aNombre;
     |HAZ EnviaFicheroConMD5;

     |RSYSTEM eaDestino;
     ||TODO CCC
     ||COPIAR a CACHE + DOCUMENTOS y RSYSTEM.
|FPRC;

|PROCESO BorrarAdjunto;
     |SI nSwLogoNominas = 1;
          aAdjunto = #959#nAdjunto#;
     |SINO;
          aAdjunto = #938#nAdjunto#;
     |FINSI;
     |QBF aAdjunto;
     |SI aAdjunto ! "";
          |DBASE aBase;  |QBF aBase;
          aBorra = aBase + "adjuntos/" + aAdjunto;
          |FBORRA aBorra;

          |SI nSwLogoNominas = 1;
               #959#nAdjunto# = "";
               |PINTA #959#nAdjunto#;
          |SINO;
               #938#nAdjunto# = "";
               |PINTA #938#nAdjunto#;
          |FINSI;

          |SI nAdjunto = 1;
               |ESTADO_CONTROL enBoton2, "DISABLE";
               |ESTADO_CONTROL enBoton3, "DISABLE";
          |FINSI;
          |SI nAdjunto = 2;
               |ESTADO_CONTROL enBoton5, "DISABLE";
               |ESTADO_CONTROL enBoton6, "DISABLE";
          |FINSI;
          |SI nAdjunto = 3;
               |ESTADO_CONTROL enBoton8, "DISABLE";
               |ESTADO_CONTROL enBoton9, "DISABLE";
          |FINSI;
     |FINSI;
     ||TODO CCC
|FPRC;

|PROCESO Botones8;
     |CONTROL_SIMPLE nPantaDos, "BOTON,{{197}} Asignar", 1035, 1045, Boton1;
     enBoton1 = FSalida;

     |CONTROL_SIMPLE nPantaDos, "BOTON,{{137}} Visualizar", 1047, 1057, Boton2;
     enBoton2 = FSalida;

     |CONTROL_SIMPLE nPantaDos, "BOTON,{{207}} Borrar", 1059, 1069, Boton3;
     enBoton3 = FSalida;

     |CONTROL_SIMPLE nPantaDos, "BOTON,{{197}} Asignar", 1135, 1145, Boton4;
     enBoton4 = FSalida;

     |CONTROL_SIMPLE nPantaDos, "BOTON,{{137}} Visualizar", 1147, 1157, Boton5;
     enBoton5 = FSalida;

     |CONTROL_SIMPLE nPantaDos, "BOTON,{{207}} Borrar", 1159, 1169, Boton6;
     enBoton6 = FSalida;

     |CONTROL_SIMPLE nPantaDos, "BOTON,{{197}} Asignar", 1235, 1245, Boton7;
     enBoton7 = FSalida;

     |CONTROL_SIMPLE nPantaDos, "BOTON,{{137}} Visualizar", 1247, 1257, Boton8;
     enBoton8 = FSalida;

     |CONTROL_SIMPLE nPantaDos, "BOTON,{{207}} Borrar", 1259, 1269, Boton9;
     enBoton9 = FSalida;
|FPRC;

|PROCESO Punto96;        ||Correos por Empresa
     enCorreoMultiEmp = 1;
     enTipoCorreo = 1;
     |SUB_EJECUTA_NP "dsarz056";
|FPRC;

|PROCESO Punto95;
     enCorreoMultiEmp = 0;
     enTipoCorreo = 1;
     |SUB_EJECUTA_NP "dsarz056";
|FPRC;

|PROCESO Punto94;        ||Nominas por Empresa
     ||TODO CCC
     ||ARA39
     enCorreoMultiEmp = 1;
     enTipoCorreo = 3;
     |SUB_EJECUTA_NP "dsarz056";
|FPRC;

|PROCESO Punto93;
     enCorreoMultiEmp = 0;
     enTipoCorreo = 3;
     |SUB_EJECUTA_NP "dsarz056";
     ||Nominas
|FPRC;

|PROCESO Punto92;        ||FacE por Empresa
     ||TODO CCC
     ||ARA39
     enCorreoMultiEmp = 1;
     enTipoCorreo = 2;
     |SUB_EJECUTA_NP "dsarz056";
|FPRC;

|PROCESO Punto91;
     enCorreoMultiEmp = 0;
     enTipoCorreo = 2;
     |SUB_EJECUTA_NP "dsarz056";
|FPRC;




|PROCESO Punto10;
     |VENTANA 0501, 2799, nPanta, 17, "Reglas automatizaci¢n documentos";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SUB_EJECUTA_NP "dsarz028";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Punto88;
     |VENTANA 0501, 2799, nPanta, 17, "Configuraci¢n destino recepci¢n de documentos aplicaciones DS";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#1p;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         |GRABA 020#1b;
     |FINSI;

     #944#0  = #1#102;
     #944#1  = #1#103;
     #944#2  = #1#104;
     #944#3  = #1#105;
     #944#4  = #1#106;
     #944#5  = #1#107;

     |PINPA #0#944;
     |PINDA #0#944;

     |ENDATOS #1#944;
     |SI FSalida = 0;
         #1#102 = #944#0;
         #1#103 = #944#1;
         #1#104 = #944#2;
         #1#105 = #944#3;
         #1#106 = #944#4;
         #1#107 = #944#5;

         |GRABA 020#1a;

     |FINSI;
     |LIBERA #1;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Punto89;
     |VENTANA 0501, 2799, nPanta, 17, "Configuraci¢n m¢dulo Taller";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#1p;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         |GRABA 020#1b;
     |FINSI;

     |DDEFECTO #982;
     #982#0  = #1#186;
     #982#1  = #1#187;

     |PINPA #0#982; nPantaVinExte = FSalida;
     |PINDA #0#982;

     |CONTROL_SIMPLE nPantaVinExte, "BOTON,Activar / Desactivar tipos con vinculaci¢n", 0654, 0696, CarpetasVinExteTaller;
     enBotonVinExte  = FSalida;

     |ENDATOS #1#982;
     |SI FSalida = 0;
         #1#186 = #982#0;
         #1#187 = #982#1;

         |SI #1#186 = "S";
              #1#194 = "N";
         |FINSI;

         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Tipo7C5_w083; |TIPO 7;
     #dsarw083#2 = eaClaveBBDD;
|FPRC;

|PROCESO Tipo0C5_w083; |TIPO 0;
     eaClaveBBDD = #dsarw083#2;
     #dsarw083#2 = "************";
     |PINTA #dsarw083#2;
|FPRC;

|PROCESO EditaSQL;
     ||TODO CCC
     ||ARA38

     |HAZ DimeUnidad;

     |DBASE aPathBase;
     |QBF aPathBase;

     eaDestino = eaUnidad + ":\DOCUMENTOS\DSARCHI\" + "dsabreextension.exe";
     eaOrigen = aPathBase + "dlls/dsabreextension.exe";
     |HAZ EnviaFicheroConMD5;

     aFicheroSQL = aPathBase + "fich/" + aNomSQL;

     || Lo traigo a la maquina
     eaOrigen = aFicheroSQL;

     |XABRE "E", eaOrigen, nHandle;
     |SI FSalida < 0;
          eaOrigen = aPathBase + "fich/" + "vacio.txt";
     |FINSI;

     eaDestino = eaUnidad + ":\DOCUMENTOS\DSARCHI\" + aNomSQL;
     |HAZ EnviaFicheroSinMD5;

     ||Luego lo ejecuto ...   y una vez he terminado .. comparo con
     ||un md5 . y si es distinto .. lo  llevo al servidor.

     aEjecuta = "START " + eaUnidad + ":\DOCUMENTOS\DSARCHI\dsabreextension ";
     aEjecuta = aEjecuta + eaDestino;
     aEjecuta = aEjecuta + " " + eaUnidad + ":\DOCUMENTOS\DSARCHI\" + "fin" + Usuario + ".txt";

     aAlfa  = eaUnidad + ":\DOCUMENTOS\DSARCHI\" + "fin" + Usuario + ".txt";
     |RFBORRA aAlfa;

     |RSYSTEM aEjecuta;
     aAlfa  = eaUnidad + ":\DOCUMENTOS\DSARCHI\" + "fin" + Usuario + ".txt";
     |PARA;  |SI;  |HACIENDO;
             |XABRE "EC", aAlfa, nHandle;
             |SI FSalida ] 0;
                 |SAL;
             |FINSI;

             |PARA nPausa = 1; |SI nPausa < 10000; |HACIENDO nPausa = nPausa + 1;
             |SIGUE;
             |PULSATECLA;
     |SIGUE;
     |PULSATECLA;

     aAlfa  = eaUnidad + ":\DOCUMENTOS\DSARCHI\" + "fin" + Usuario + ".txt";
     |RFBORRA aAlfa;

     eaDestino = eaUnidad + ":\DOCUMENTOS\DSARCHI\" + aNomSQL;
     eaOrigen = aFicheroSQL;
     |HAZ RecibeEnServidorMD5;

     |RFBORRA eaOrigen;
|FPRC;

|PROCESO BotonSQL1;
     aNomSQL = "sqlcli01.txt";
     |HAZ EditaSQL;
|FPRC;

|PROCESO BotonSQL2;
     aNomSQL = "sqlcli02.txt";
     |HAZ EditaSQL;
|FPRC;

|PROCESO BotonSQL3;
     aNomSQL = "sqlcli03.txt";
     |HAZ EditaSQL;
|FPRC;

|PROCESO BotonSQL4;
     aMensaje = "0000Sentencia SQL inhabilitada";
     |MENAV aMensaje;
/*
     aNomSQL = "sqlcli04.txt";
     |HAZ EditaSQL;
*/
|FPRC;

|PROCESO BotonSQL5;
     aNomSQL = "sqlcli05.txt";
     |HAZ EditaSQL;
|FPRC;

|PROCESO BotonSQL6;
     aNomSQL = "sqlcli06.txt";
     |HAZ EditaSQL;
|FPRC;

|PROCESO Punto810;
     |VENTANA 0501, 2799, nPanta, 17, "Configuraci¢n conexi¢n con cl¡nicas";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#1p;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         |GRABA 020#1b;
     |FINSI;

     |DDEFECTO #983;
     #983#0  = #1#194;
     #983#1  = #1#195;
     eaClaveBBDD = #1#196;
     #983#2  = "************";
     #983#3  = #1#197;
     #983#4  = #1#198;
     #983#5  = #1#202;

     |PINPA #0#983; nPantaVinExte = FSalida;
     |PINDA #0#983;

     |CONTROL_SIMPLE nPantaVinExte, "BOTON,Activar / Desactivar tipos con vinculaci¢n", 0654, 0696, CarpetasVinExteClinica;
     enBotonVinExteCli = FSalida;

     |CONTROL_SIMPLE nPantaVinExte, "BOTON,SQL Historias", 1503, 1543, BotonSQL1;
     enBotonSQL1 = FSalida;

     |CONTROL_SIMPLE nPantaVinExte, "BOTON,SQL Episodios", 1546, 1586, BotonSQL2;
     enBotonSQL2 = FSalida;

     |CONTROL_SIMPLE nPantaVinExte, "BOTON,SQL Sustituciones de Historia", 1703, 1743, BotonSQL3;
     enBotonSQL3 = FSalida;

     |CONTROL_SIMPLE nPantaVinExte, "BOTON,SQL Cambio N£m. de Historia", 1746, 1786, BotonSQL4;
     enBotonSQL4 = FSalida;

     |CONTROL_SIMPLE nPantaVinExte, "BOTON,SQL Cambio de Historia de un Episodio", 1903, 1943, BotonSQL5;
     enBotonSQL5 = FSalida;

     |CONTROL_SIMPLE nPantaVinExte, "BOTON,SQL Anulaciones de Episodio", 1946, 1986, BotonSQL6;
     enBotonSQL6 = FSalida;

     ||En la clinica se carga los sql .txt que se utilizan como base
     ||dejo esto desactivo, y si tenemos que modificar algo (cosa muy rara)
     ||mejor hacerlo directamente desde el sistema de archivos
     |ESTADO_CONTROL enBotonSQL1, "DISABLE";
     |ESTADO_CONTROL enBotonSQL2, "DISABLE";
     |ESTADO_CONTROL enBotonSQL3, "DISABLE";
     |ESTADO_CONTROL enBotonSQL4, "DISABLE";
     |ESTADO_CONTROL enBotonSQL5, "DISABLE";
     |ESTADO_CONTROL enBotonSQL6, "DISABLE";

     |ENDATOS #1#983;
     |SI FSalida = 0;
         #1#194 = #983#0;
         #1#195 = #983#1;
         #1#196 = eaClaveBBDD;
         #1#197 = #983#3;
         #1#198 = #983#4;
         #1#202 = #983#5;

         |SI #1#194 = "S";
              #1#186 = "N";
         |FINSI;

         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Punto811;
     |VENTANA 0501, 2799, nPanta, 17, "Conexi¢n con Servicio 060";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#dsarm001.p;
     |SI FSalida ! 0;
         |DDEFECTO #dsarm001;
         |GRABA 020#dsarm001.b;
     |FINSI;

     #dsarw116#0  = #dsarm001#220;
     #dsarw116#1  = #dsarm001#221;
     #dsarw116#2  = #dsarm001#222;
     #dsarw116#3  = #dsarm001#223;
     #dsarw116#7  = #dsarm001#224;

     |PINPA #0#dsarw116; nPanta116 = FSalida;
     |PINDA #0#dsarw116;

     |CONTROL_SIMPLE nPanta116, "LABEL,{{11}}Conectar servicio 060", 0602, 0621, NULL;

     |ENDATOS #1#dsarw116;
     |SI FSalida = 0;
         #dsarm001#220 = #dsarw116#0;
         #dsarm001#221 = #dsarw116#1;
         #dsarm001#222 = #dsarw116#2;
         #dsarm001#223 = #dsarw116#3;
         #dsarm001#224 = #dsarw116#7;

         |GRABA 020#dsarm001.a;
     |FINSI;
     |LIBERA #dsarm001;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Punto812;
     |VENTANA 0501, 2799, nPanta, 17, "Conexi¢n con Mailing";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#dsarm001.p;
     |SI FSalida ! 0;
         |DDEFECTO #dsarm001;
         |GRABA 020#dsarm001.b;
     |FINSI;

     #dsarw116#0  = #dsarm001#227;
     #dsarw116#1  = #dsarm001#228;
     #dsarw116#2  = #dsarm001#229;
     #dsarw116#3  = #dsarm001#230;
     #dsarw116#7  = #dsarm001#231;

     |PINPA #0#dsarw116; nPanta116 = FSalida;
     |PINDA #0#dsarw116;

     |CONTROL_SIMPLE nPanta116, "LABEL,{{11}}Conectar mailing", 0602, 0621, NULL;

     |ENDATOS #1#dsarw116;
     |SI FSalida = 0;
         #dsarm001#227 = #dsarw116#0;
         #dsarm001#228 = #dsarw116#1;
         #dsarm001#229 = #dsarw116#2;
         #dsarm001#230 = #dsarw116#3;
         #dsarm001#231 = #dsarw116#7;

         |GRABA 020#dsarm001.a;
     |FINSI;
     |LIBERA #dsarm001;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO PonImagen;
     |SI nSwLogoFacturaE = 0; |Y nSwLogoNominas = 0;
          aNombreLogo = "logodespanet";
          |SI nBotonFoto ! -1;
              |FIN_CONTROL_WINDOWS nBotonFoto;
          |FINSI;
     |SINO;
          |SI nSwLogoNominas = 1;
               aNombreLogo = "logonominas";
               |SI nBotonFotoFE ! -1;
                   |FIN_CONTROL_WINDOWS nBotonFotoNomi;
               |FINSI;
          |SINO;
               aNombreLogo = "logofacturae";
               |SI nBotonFotoFE ! -1;
                   |FIN_CONTROL_WINDOWS nBotonFotoFE;
               |FINSI;
          |FINSI;
     |FINSI;

     |DBASE aBase;  |QBF aBase;

     aFotoOrigen = aBase + "logos/" + aNombreLogo + ".jpg";
     aExt        = ".jpg";
     |XABRE "E", aFotoOrigen, nHandle;
     |SI FSalida < 0;
          |SI aNombreLogo = "logodespanet";
               aFotoOrigen = aBase + "logos/logo_despabox_ori.jpg";
               aFotoDestino = aBase + "logos/logodespanet.jpg";
               |COPIA_FICHERO aFotoOrigen, aFotoDestino;

               aFotoOrigen = aFotoDestino;
          |SINO;
               aFotoOrigen = aBase + "logos/insertarlogo.jpg";
               aExt        = ".jpg";
               |XABRE "E", aFotoOrigen, nHandle;
               |SI FSalida < 0;
                   |MENAV "0000Hay un problema en su aplicaci¢n, no est n instalado los logos";
                   aVent1 = -1;
                   aVent2 = -1;
                   aVent3 = 0;
                   aVent4 = nSubVent;
                   aVent5 = "MODELESS";
                   |ESPECIFICA "ESTADO_VENTANA", aVent;

                   |FINVENTANA nSubVent;
                   |ACABA;
               |FINSI;
          |FINSI;
     |FINSI;

     aDirLocal    = eaUnidadBasico + "\DOCUMENTOS";                     |RMKDIR aDirLocal;
     aDirLocal    = eaUnidadBasico + "\DOCUMENTOS\DSARCHI";             |RMKDIR aDirLocal;
     aDirLocal    = eaUnidadBasico + "\DOCUMENTOS\DSARCHI\LOGOS";       |RMKDIR aDirLocal;
     aFotoDestino = aDirLocal + "/" + aNombreLogo + aExt;

     aContiene1 = aFotoDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = aFotoOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aFotoOrigen, aFotoDestino;
         |SINO;
             |COPIA_FICHERO aFotoOrigen, aFotoDestino;
         |FINSI;
     |FINSI;

     aFoto = "IMAGEN,"  + aFotoDestino;

     |SI nSwLogoFacturaE = 0; |Y nSwLogoNominas = 0;
          |CONTROL_SIMPLE nPanta800, aFoto, 0710, 1137, NULL;
          nBotonFoto = FSalida;
     |SINO;
          |CONTROL_SIMPLE nPantaDos, aFoto, 0770, 1197, NULL;
          |SI nSwLogoNominas = 1;
               nBotonFotoNomi = FSalida;
          |SINO;
               nBotonFotoFE = FSalida;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO CambiaLogo;
     |SI nSwLogoFacturaE = 0; |Y nSwLogoNominas = 0;
          aNombreLogo = "logodespanet";
     |SINO;
          |SI nSwLogoNominas = 1;
               aNombreLogo = "logonominas";
          |SINO;
               aNombreLogo = "logofacturae";
          |FINSI;
     |FINSI;

     aAlfa = aDirLocal + "/" + aNombreLogo + ".jpg";   |RFBORRA aAlfa;

     aDirec = "F";
     |BROWSE aDirec;
     aDirec = aDirec % 290;  |QBF aDirec;
     |SI aDirec = "";  |ACABA;  |FINSI;

     aExt = (aDirec % -103) < "";
     |SI aExt ! "jpg";
         |MENAV "0000Por favor seleccione una imagen JPG";
         |ACABA;
     |FINSI;

     aAlfa = aBase + "logos/" + aNombreLogo + ".jpg";  |FBORRA aAlfa;

     aFotoOrigen  = aDirec;
     aFotoDestino = aBase + "logos/" + aNombreLogo + "." + aExt;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |RECIBE_FICHERO aFotoOrigen, aFotoDestino;
     |SINO;
         |COPIA_FICHERO aFotoOrigen, aFotoDestino;
     |FINSI;

     |HAZ PonImagen;
|FPRC;

|PROCESO Punto111;
     nSwLogoFacturaE = 0;

     |VENTANA 0501, 2999, nPanta, 17, "Configuraci¢n DESPABOX";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PINPA #0#800;
     nPanta800 = FSalida;

     |CONTROL_SIMPLE nPanta800, "LABEL,{{10}}Logo para correos y programas DESPABOX", 0502, 0598, NULL;
     |CONTROL_SIMPLE nPanta800, "LABEL,{{16}}Se recomienda una imagen JPG de 170 X 80", 0940, 0998, NULL;
     |CONTROL_SIMPLE nPanta800, "BOTON,Pulse aqu¡ para cambiar el logo", 1310, 1437, CambiaLogo;

     nBotonFoto = -1;
     |HAZ PonImagen;

     |ABRE #800;
     |LEE 101#800p;
     |SI FSalida ! 0;
         |DDEFECTO #800;
         |GRABA 020#800b;
     |FINSI;

     |SI nReplica = 1;
         |CONTROL_SIMPLE nPanta800, "LABEL,{{2}}Path replica", 1702, 1715, NULL;
         ||C_P #800#5, 1, 1719;
         |C_V #800#5, 1, "S";
         |C_M #800#5, 1, "S";
     |SINO;
         |C_V #800#5, 1, "N";
         |C_M #800#5, 1, "N";
         #800#5 = "";
     |FINSI;

     aAlfa = #dpntm000#6 - "requiere";
     |SI FSalida ! 0;
         #dpntm000#6 = "Versi¢n python correcta.";
     |FINSI;

     |HAZ VersionPython;
     |SI enErrorPy ! 0;
         #dpntm000#6 = eaMensaPy;
     |FINSI;

     |PINDA #0#800;

     |ENDATOS #1#800;
     |SI FSalida = 0;
         |GRABA 020#800a;
     |FINSI;
     |LIBERA #800;
     |CIERRA #800;

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Punto112;
     |VENTANA 0501, 2799, nPanta, 17, "Configuraci¢n predeterminada de la Estructura de documentos DESPABOX ";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SUB_EJECUTA_NP "dsarm002;DESPABOX";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Punto113;
     |SUB_EJECUTA "dpntm001;DESPABOX";
|FPRC;

|PROCESO Punto114;
     |VENTANA 0501, 3599, -1, 16, "Envio de notificaciones a DESPABOX";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SUB_EJECUTA "dpntz004";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Punto121;
     |SUB_EJECUTA "dpntm001;PIBOX";
|FPRC;

|PROCESO Punto122;
     |SUB_EJECUTA "dpntz005";
|FPRC;

|PROCESO Punto131;
     |SUB_EJECUTA "flowm001";
|FPRC;

|PROCESO Punto132;
     |SUB_EJECUTA "flowm010";
|FPRC;

|PROCESO Punto133;
     |SUB_EJECUTA "flowm020";
|FPRC;

|PROCESO EventoTree;
     |SI FEntrada = 0;
         aAlfa = "";
         aLong = Contenido % 0;
         nLong = aLong;
         |PARA nPosi = 1;  |SI nPosi [ nLong;  |HACIENDO nPosi = nPosi + 1;
               nPos = (nPosi * 100) + 1;
               aCarac = Contenido % nPos;
               |SI aCarac = ":";  |SAL;  |FINSI;
               aAlfa  = aAlfa + aCarac;
         |SIGUE;

         |QBT aAlfa;

         sT_nID   = nTree;
         sT_nOper = 4;
         sT_aData = ":" + aAlfa;

         |ESPECIFICA "COMMANDCONTROL", sTree;
         aTexto = Contenido;

         |ACABA;
     |FINSI;

     aContenido = Contenido;

     |SI Contenido = "1";     |HAZ Punto1;          |FINSI;
     |SI Contenido = "21";    |HAZ Punto21;         |FINSI;
     |SI Contenido = "22";    |HAZ Punto22;         |FINSI;
     |SI Contenido = "23";    |HAZ Punto23;         |FINSI;
     |SI Contenido = "24";    |HAZ Punto24;         |FINSI;
     |SI Contenido = "25";    |HAZ Punto25;         |FINSI;
     |SI Contenido = "3";     |HAZ Punto3;          |FINSI;
     |SI Contenido = "4";     |HAZ Punto4;          |FINSI;
     |SI Contenido = "42";    |HAZ Punto42;         |FINSI;
     |SI Contenido = "5";     |HAZ Punto5;          |FINSI;
     |SI Contenido = "6";     |HAZ Punto6;          |FINSI;
     |SI Contenido = "7";     |HAZ Punto7;          |FINSI;
     |SI Contenido = "81";    |HAZ Punto81;         |FINSI;
     |SI Contenido = "82";    |HAZ Punto82;         |FINSI;
     |SI Contenido = "821";   |HAZ Punto821;        |FINSI;
     |SI Contenido = "83";    |HAZ Punto83;         |FINSI;
     |SI Contenido = "84";    |HAZ Punto84;         |FINSI;
     |SI Contenido = "85";    |HAZ Punto85;         |FINSI;
     |SI Contenido = "86";    |HAZ Punto86;         |FINSI;
     |SI Contenido = "87";    |HAZ Punto87;         |FINSI;
     |SI Contenido = "88";    |HAZ Punto88;         |FINSI;
     |SI Contenido = "89";    |HAZ Punto89;         |FINSI;
     |SI Contenido = "810";   |HAZ Punto810;        |FINSI;
     |SI Contenido = "811";   |HAZ Punto811;        |FINSI;
     |SI Contenido = "812";   |HAZ Punto812;        |FINSI;
     |SI Contenido = "91";    |HAZ Punto91;         |FINSI;
     |SI Contenido = "92";    |HAZ Punto92;         |FINSI;
     |SI Contenido = "93";    |HAZ Punto93;         |FINSI;
     |SI Contenido = "94";    |HAZ Punto94;         |FINSI;
     |SI Contenido = "95";    |HAZ Punto95;         |FINSI;
     |SI Contenido = "96";    |HAZ Punto96;         |FINSI;
     |SI Contenido = "10";    |HAZ Punto10;         |FINSI;
     |SI Contenido = "111";   |HAZ Punto111;        |FINSI;
     |SI Contenido = "112";   |HAZ Punto112;        |FINSI;
     |SI Contenido = "113";   |HAZ Punto113;        |FINSI;
     |SI Contenido = "114";   |HAZ Punto114;        |FINSI;
     |SI Contenido = "121";   |HAZ Punto121;        |FINSI;
     |SI Contenido = "122";   |HAZ Punto122;        |FINSI;
     |SI Contenido = "131";   |HAZ Punto131;        |FINSI;
     |SI Contenido = "132";   |HAZ Punto132;        |FINSI;
     |SI Contenido = "133";   |HAZ Punto133;        |FINSI;
     |SI aContenido ! "";
         |FOCOTECLADO nTree;
     |FINSI;
|FPRC;

|PROCESO CargaArbol;
     |QBF aAlfa;
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO MontaArbol;
     |SI nTree ! -1;
         |FIN_CONTROL_WINDOWS nTree;
         nTree = -1;
     |FINSI;

     |CONTROL_SIMPLE 0, "LABEL,{{5}}Cargando informaci¢n ...", 1315, 1680, NULL;
     nBotonLabel = FSalida;

     |PTEC 802;  |PAUSA;

     |DBASE aBase;  |QBF aBase;
     aAlfa = aBase + "tmp";          |MKDIR aAlfa;

     eaRutaOrigen  = aBase + "tmp/";
     eaRutaDestino = eaUnidadBasico + "\documentos";           |RMKDIR eaRutaDestino;
     eaRutaDestino = eaUnidadBasico + "\documentos\tmp";       |RMKDIR eaRutaDestino;
     eaRutaDestino = eaUnidadBasico + "\documentos\tmp\";
     eaFicheroTxt  = "dsarz02501" + Usuario + ".txt";
     eaFicheroTgz  = "dsarz02501" + Usuario + ".tgz";
     eaFicheroTar  = "dsarz02501" + Usuario + ".tar";

     aAbre = eaRutaOrigen + eaFicheroTxt;

     sT_nID   = nTree;
     sT_nOper = 0;

     |XABRE "WB", aAbre, nHandle;

     aAlfa = "1: Configuraci¢n general {{1}}";
     |HAZ CargaArbol;

     aAlfa = "2: Configuraci¢n documentos";
     |HAZ CargaArbol;

     aAlfa = "2,1: Configuraci¢n de campos detalle en estructura de documentos {{21}}";
     |HAZ CargaArbol;

     aAlfa = "2,2: Configuraci¢n estructura de documentos{{22}}";
     |HAZ CargaArbol;

     aAlfa = "2,3: Configuraci¢n vistas por arbol en la entrada de registros {{23}}";
     |HAZ CargaArbol;

     aAlfa = "2,4: Password tratamiento documentos {{24}}";
     |HAZ CargaArbol;

     aAlfa = "2,5: Configuraci¢n borrado cliente desde PI {{25}}";
     |HAZ CargaArbol;

     aAlfa = "3: Configuraci¢n permisos de usuarios {{3}}";
     |HAZ CargaArbol;

     aAlfa = "4: Configuraci¢n Correo Electr¢nico";
     |HAZ CargaArbol;

     aAlfa = "4,1: Configuraci¢n DSCORREO {{4}}";
     |HAZ CargaArbol;

     aAlfa = "4,2: Configuraci¢n smtp-cli {{42}}";
     |HAZ CargaArbol;

     aAlfa = "5: Configuraci¢n OCR (dsEscan) {{5}}";
     |HAZ CargaArbol;

     aAlfa = "6: Configuraci¢n CEFAX {{6}}";
     |HAZ CargaArbol;

     aAlfa = "7: Configuraci¢n centralita telef¢nica {{7}}";
     |HAZ CargaArbol;

     aAlfa = "8: Configuraci¢n conexi¢n otras aplicaciones";
     |HAZ CargaArbol;

     aAlfa = "8,1: Conexi¢n con minutas (ipfactur){{81}}";
     |HAZ CargaArbol;

     aAlfa = "8,2: Conexi¢n Contabilidad";
     |HAZ CargaArbol;

     aAlfa = "8,2,1: Conexi¢n Contabilidad {{821}}";
     |HAZ CargaArbol;

     aAlfa = "8,2,2: Conexi¢n adConta {{82}}";
     |HAZ CargaArbol;

     aAlfa = "8,3: Conexi¢n con gesti¢n comercial {{83}}";
     |HAZ CargaArbol;

     aAlfa = "8,4: Conexi¢n con minutas (facges) {{84}}";
     |HAZ CargaArbol;

     aAlfa = "8,5: Conexi¢n a medida personalizada {{85}}";
     |HAZ CargaArbol;

     aAlfa = "8,6: Conexi¢n con laboral {{86}}";
     |HAZ CargaArbol;

     aAlfa = "8,7: Conexi¢n con gesti¢n abogados (ipabogax) {{87}}";
     |HAZ CargaArbol;

     aAlfa = "8,8: Conexi¢n con aplicaciones DS {{88}}";
     |HAZ CargaArbol;

     aAlfa = "8,9: Conexi¢n con m¢dulo Taller {{89}}";
     |HAZ CargaArbol;

     aAlfa = "8,10: Conexi¢n con cl¡nicas{{810}}";
     |HAZ CargaArbol;

     aAlfa = "8,11: Conexi¢n Avisos 060 {{811}}";
     |HAZ CargaArbol;

     aAlfa = "8,12: Conexi¢n Mailing {{812}}";
     |HAZ CargaArbol;

     |SI nSwSMTPCLI = 1;
          aAlfa = "9: Configuraci¢n Asunto/Adjuntos/Textos/Logo Correos";
     |SINO;
          aAlfa = "9: Configuraci¢n Asunto/Adjuntos/Textos Correos";
     |FINSI;
     |HAZ CargaArbol;

     aAlfa = "9,1: Correos {{95}}";
     |HAZ CargaArbol;

     aAlfa = "9,2: Correos (Configuraci¢n por Empresa) {{96}}";
     |HAZ CargaArbol;

     aAlfa = "9,3: Correos FacturaE {{91}}";
     |HAZ CargaArbol;

     aAlfa = "9,4: Correos FacturaE (Configuraci¢n por Empresa) {{92}}";
     |HAZ CargaArbol;

     aAlfa = "9,5: Correos N¢minas {{93}}";
     |HAZ CargaArbol;

     aAlfa = "9,6: Correos N¢minas (Configuraci¢n por Empresa) {{94}}";
     |HAZ CargaArbol;

     aAlfa = "10: Reglas automatizaci¢n documentos {{10}}";
     |HAZ CargaArbol;

     nArbol = 10;

     |SI #1#122 ! "N";
         nArbol = nArbol + 1;
         aAlfa  = nArbol + ": Configuraci¢n DESPABOX";                          |HAZ CargaArbol;
         aAlfa  = nArbol + ",1: Configuraci¢n {{111}}";                         |HAZ CargaArbol;
         aAlfa  = nArbol + ",2: Configuraci¢n predeterminada de la estructura de documentos{{112}}"; |HAZ CargaArbol;
         aAlfa  = nArbol + ",3: Asistente por empresas  {{113}}";       |HAZ CargaArbol;
         aAlfa  = nArbol + ",4: Envio de notificaciones {{114}}";               |HAZ CargaArbol;
     |FINSI;

     |SI nPIBOX = 1;
         nArbol = nArbol + 1;
         aAlfa  = nArbol + ": Configuraci¢n PIBOX";                             |HAZ CargaArbol;
         aAlfa  = nArbol + ",1: Asistente por empresas {{121}}";   |HAZ CargaArbol;
         aAlfa  = nArbol + ",2: Asistente por accesos {{122}}";     |HAZ CargaArbol;
     |FINSI;

     eaPrograma   = "WORKFLOW";
     |HAZ DSARCHI_INI;
     |SI enAprobacion = 1;
         nArbol = nArbol + 1;
         aAlfa  = nArbol + ": Configuraci¢n WORKFLOW";      |HAZ CargaArbol;
         aAlfa  = nArbol + ",1: Configuraci¢n dep¢sitos  {{132}}";     |HAZ CargaArbol;
         aAlfa  = nArbol + ",2: Configuraci¢n situaciones{{131}}";     |HAZ CargaArbol;
         aAlfa  = nArbol + ",3: Configuraci¢n administradores{{133}}"; |HAZ CargaArbol;
     |FINSI;

     |XCIERRA nHandle;

     |HAZ TraeTxtComprimido;
     aAlfa = eaRutaDestino + eaFicheroTxt;

     eaAlfa = "TREECTRL,Par metros {{" + aAlfa + "}}";
     |CONTROL_SIMPLE nPanta, eaAlfa, 0702, 2598, EventoTree;
     nTree = FSalida;

     eaFicheroTxt  = "dsarz02501" + Usuario + ".txt";
     aAlfa         = eaRutaDestino + eaFicheroTxt;
     |RFBORRA aAlfa;

     |FIN_CONTROL_WINDOWS nBotonLabel;

     |SI aBusca ! "";
         sT_nID   = nTree;
         sT_nOper = 3;
         sT_aData = "[" + aBusca;
         |ESPECIFICA "COMMANDCONTROL", sTree;
         aRefresca = ":" + FSalida;
     |FINSI;

     sT_nID   = nTree;
     sT_nOper = 2;
     |SI aRefresca = "";
         sT_aData = "1:";
     |SINO;
         sT_aData = aRefresca;
     |FINSI;

     |ESPECIFICA "COMMANDCONTROL", sTree;
     |PULSATECLA;

     |FOCOTECLADO nTree;
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     FSalida = 2799;
|FPRC;

|PROCESO CompruebaBOX;
     |LEE 101#1p;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         |GRABA 020#1b;
     |FINSI;

     #1#122 = "S";

     eaPrograma = "DESPANET";
     |HAZ DSARCHI_INI;
     |SI enAprobacion = 0;
          eaPrograma = "DESPABOX";
          |HAZ DSARCHI_INI;
          |SI enAprobacion = 0;
              #1#122 = "N";
          |FINSI;
     |FINSI;

     |SI #1#7 = "S";  #1#122 = "N";  |FINSI;

     nReplica = 0;
     |SI #1#122 = "N";
         eaPrograma = "REPLICA_DESPANET";
         |HAZ DSARCHI_INI;
         |SI enAprobacion ! 0;
             nReplica = 1;
             #1#122   = "S";
         |FINSI;

         eaPrograma = "REPLICA_DESPABOX";
         |HAZ DSARCHI_INI;
         |SI enAprobacion ! 0;
             nReplica = 1;
             #1#122   = "S";
         |FINSI;
     |FINSI;

     |GRABA 020#1a;
     |LIBERA #1;

     nPIBOX = 0;
     |SI #1#7 = "S";   |ACABA;  |FINSI;

     |DBASS aDBass;
     aAlfa = aDBass + "integral/def/dsam0000.mas";
     |XABRE "E", aAlfa, 0;
     |SI FSalida ] 0;
         nPIBOX = 1;
     |FINSI;
|FPRC;

|PROGRAMA;
     |SUB_EJECUTA_NP "dsarz057";

     |ABRET #1;

     |HAZ LeeUnidadBasico;
     |HAZ SoyDESPANET;
     |SI enSoyDESPANET = 1;  |ACABA;  |FINSI;

     enCalDESPANET   = 0;

     nGuarda      = enAprobacion;
     enAprobacion = 0;
     eaPrograma   = "WEBSERVICEFACE";
     |HAZ DSARCHI_INI;
     enSwWebServiceFace = enAprobacion;
     enAprobacion = nGuarda;

     nGuarda      = enAprobacion;
     enAprobacion = 0;
     eaPrograma   = "BLAT";
     |HAZ DSARCHI_INI;
     nSwBLAT   = enAprobacion;
     enAprobacion = nGuarda;
     enSwBLAT = nSwBLAT;

     nGuarda      = enAprobacion;
     enAprobacion = 0;
     eaPrograma   = "SMTPCLI";
     |HAZ DSARCHI_INI;
     nSwSMTPCLI   = enAprobacion;
     enAprobacion = nGuarda;
     enSwSMTPCLI = nSwSMTPCLI;

     ||Miramos si tiene que copiar los patrones.
     aEjecuta = "dsarz014";
     |SUB_EJECUTA_NP aEjecuta;

     ||Ahora miramos los ficheros ".xsl". Por si esta correctamente instalada la aplicacion.

     |DBASE aBase;
     |QBF aBase;
     aExiste = aBase + "plugins/dsfacturae320.xsl";
     |XABRE "E", aExiste, 0;
     |SI FSalida < 0;
          aMensaje = "0000No existe fichero:" + &13 + aExiste;
          |MENAV aMensaje;
          aMensaje = "0000Problemas instalacion DSARCHI";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     aExiste = aBase + "plugins/dsfacturae310.xsl";
     |XABRE "E", aExiste, 0;
     |SI FSalida < 0;
          aMensaje = "0000No existe fichero:" + &13 + aExiste;
          |MENAV aMensaje;
          aMensaje = "0000Problemas instalacion DSARCHI";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     aExiste = aBase + "plugins/dsfacturae300.xsl";
     |XABRE "E", aExiste, 0;
     |SI FSalida < 0;
          aMensaje = "0000No existe fichero:" + &13 + aExiste;
          |MENAV aMensaje;
          aMensaje = "0000Problemas instalacion DSARCHI";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     |HAZ CompruebaBOX;

     |CLS;
     |CABEZA "Par metros";

     ||Tiquet 3283.680
     ||Tengo un problema con el campo 129, que no aparece, pq. por defecto, no lleva el "N".
     ||sino que va vacio. De forma que no se puede pulsar el boton con el raton
     ||pero con el tab si que se puede marcar. Ahora ya esta solucionado.
     |LEE 101#1p;
     |SI FSalida = 0;
          aCampo129 = #1#129;
          |QBF aCampo129;
          |SI aCampo129 = "";
               #1#129 = "N";
               |GRABA 020#1.a;
          |FINSI;
          |LIBERA #1;
     |FINSI;

     |LEE 000#1p;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     aVistas = #1#191;

     |PINPA #0#0;
     nPanta = FSalida;

     |HAZ MontaArbol;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nTree;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nTree;

     |SI enCalDESPANET = 1;
         |SUB_EJECUTA "dpntz001;CLI";
     |FINSI;

     |LEE 000#1p;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |SI #1#191 = "S";  |Y aVistas = "N";
         |MENAV "0000A continuaci¢n se va a crear los ficheros para las vistas r pidas.";
         |SUB_EJECUTA "dsarz050";
     |FINSI;

     |CIERRAT #1;
|FPRO;
