|FICHEROS;
     dsarz010 #510;

     dsarm043 #43;       ||Permisos Vistas Usu.
     dsarm008 #8;       ||Vistas Arbol dsEscan
|FIN;

|VARIABLES;
     aMensaje = "";
     nVenta = 0;
     nGrid43 = 0;
     aTecla = "";
     aEsc1 = "";
     aEsc2 = "";
     aRetu = "";
     nRango = 0;
     aUsuario = "";
     aVista = "";
     aVacio60 = "";
     aZeta60 = "";
     aMarca   = "";

     {-1}aVent       = "";
         aVent1      = 0;
         aVent2      = 0;
         aVent3      = 0;
         aVent4      = 0;
         aVent5      = "";
|FIN;

|PROCESO dsarm008;
     aVista = #dsarm008#0;

     |DDEFECTO #dsarm043;
     #dsarm043#0 = aUsuario;
     #dsarm043#1 = aVista;
     |LEE 101#dsarm043.=;
     |SI FSalida ! 0;
         |SI #dsarm008#32 = "1";  #dsarm043#2 = "S";  |FINSI;
         |SI #dsarm008#32 = "2";  #dsarm043#2 = "N";  |FINSI;

         |SI #dsarm043#2 = "S";
             #dsarm043#3 = "0,185,0;255,255,255";
         |SINO;
             #dsarm043#3 = "255,0,0;255,255,255";
         |FINSI;
         |GRABA 020#dsarm043.n;
     |FINSI;
     |LIBERA #dsarm043;
|FPRC;

|DEFBUCLE dsarm008;
 #dsarm008#1;
 ;
 INICIO;
 FINAL;
 ;
 NULL, dsarm008;
|FIN;

|PROCESO RellenaVistas;
     |BUCLE dsarm008;
|FPRC;

|PROCESO Evento43;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#dsarm043.=;
     |FINSI;

     |SI FSalida = 4;
         |LEE 101#dsarm043.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |SI #dsarm043#2 = "S";
             #dsarm043#2 = "N";
             #dsarm043#3 = "255,0,0;255,255,255";
         |SINO;
             #dsarm043#2 = "S";
             #dsarm043#3 = "0,185,0;255,255,255";
         |FINSI;
         |GRABA 020#dsarm043.a;
         |LIBERA #dsarm043;

         |REFRESCACONTROL nGrid43;
     |FINSI;
|FPRC;

|PROCESO Min;
     #dsarm043#0 = aUsuario;
     #dsarm043#1 = aVacio60;
|FPRC;

|PROCESO Max;
     #dsarm043#0 = aUsuario;
     #dsarm043#1 = aZeta60;
|FPRC;

|PROCESO dsarm043;
     #dsarm043#2 = aMarca;

     |SI #dsarm043#2 = "S";
         #dsarm043#3 = "0,185,0;255,255,255";
     |SINO;
         #dsarm043#3 = "255,0,0;255,255,255";
     |FINSI;

     |GRABA 020#dsarm043.a;
     |LIBERA #dsarm043;
|FPRC;

|DEFBUCLE dsarm043;
     #dsarm043#1;
     ;
     aUsuario, aVacio60;
     aUsuario, aZeta60;
     be;
     NULL, dsarm043;
|FIN;

|PROCESO Todo;
     aMarca = "S";
     |BUCLE dsarm043;

     |REFRESCACONTROL nGrid43;
|FPRC;

|PROCESO Ninguno;
     aMarca = "N";
     |BUCLE dsarm043;

     |REFRESCACONTROL nGrid43;
|FPRC;

|PROCESO BotonVistas;
     aVacio60 = " " * 60;
     aZeta60 = "z" * 60;

     aUsuario = #510#0;
     |QBF aUsuario;

     |ABRE #dsarm043;

     |HAZ RellenaVistas;

     |VENTANA 0501, 3099, -1, 17, "Doble click en la linea para activar o desactivar. VERDE - ACTIVADO.  ROJO - DESACTIVADO";
     nVenta = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVenta;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |CONTROL_SIMPLE 0, "BOTON,{{235}}Activar todo", 0502, 0620, Todo;
     |CONTROL_SIMPLE 0, "BOTON,{{234}}Desactivar todo", 0522, 0640, Ninguno;
     |CONTROL_SIMPLE 0, "LABEL,{{1}}Doble click en la l¡nea para seleccionar o quitar el registro seleccionado", 0542, 0698, NULL;

     nRango  = 2 + 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#43, nRango, 0701, 2999, Min, Max, Evento43;
     nGrid43 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nGrid43;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVenta;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVenta;

     |CIERRA #dsarm043;
|FPRC;
