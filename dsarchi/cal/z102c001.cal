                             FACTURAS NCS

|FICHEROS;
     dsarw123;
|FIN;

|INCLUYE z1000var;

|PROCESO Graba123_C001;
     |DDEFECTO #dsarw123;

     enConta      = enConta + 1;
     #dsarw123#0  = enConta;
     #dsarw123#1  = eaFicRes;
     #dsarw123#2  = eaNIF;
     #dsarw123#3  = enCodEmp;
     #dsarw123#4  = eaNomEmp;
     #dsarw123#5  = aFecha;
     #dsarw123#6  = aFactura;

     |HAZ PonColor;

     |GRABA 020#dsarw123.n;
     |LIBERA #dsarw123;
|FPRC;

|PROCESO TipoC001;
     enLinea = 13;  |HAZ LeeContenido;

     |QBF eaContenido;
     aLong = eaContenido % 0;
     nLong = aLong;
     nLoc  = 0;
     |PARA nCar = 1;  |SI nCar [ nLong;  |HACIENDO nCar = nCar + 1;
           nPos = (nCar * 100) + 1
           aCar = eaContenido % nPos;

           |SI aCar = " ";
               nBla = nBla + 1;
               |SI nBla ] 2;
                   |SI eaNIF    ! "";  nLoc = 1;  |FINSI;
                   |SI aFactura ! "";  nLoc = 2;  |FINSI;
               |FINSI;
           |FINSI;

           |SI aCar ! " ";
               |SI nLoc = 0;
                   eaNIF = eaNIF + aCar;
               |FINSI;

               |SI nLoc = 1;
                   aFactura = aFactura + aCar;
               |FINSI;

               |SI nLoc = 2;
                   aFecha = aFecha + aCar;
               |FINSI;

               nBla = 0;
           |FINSI;
     |SIGUE;

     |QBT aFactura;
     |QBT aFecha;
     |QBT eaNIF;

     aFecha   = (aFecha % 102) + "." + (aFecha % 402) + "." + (aFecha % -104);
|FPRC;

|PROCESO MiraSiC001;
     eaNIF    = "";
     aFecha   = "";
     aFactura = "";

     nTipoModelo = 1;  |HAZ TipoC001;
     |SI aFecha = "";  |Y eaNIF = "";  |Y aFactura = "";
         |ACABA;
     |FINSI;

     |HAZ LeeFactura;
     |HAZ Graba123_C001;

     enChequeo = 1;
|FPRC;
