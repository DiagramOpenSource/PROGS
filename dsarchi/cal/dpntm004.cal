|FICHEROS;
     dpntm001;
     dpntm004;
     dpntm005;

     dpntw007,MANTE;

     &labtraba@;
|FIN;

|VARIABLES;
     nNumeroEnviados    = 0;
     nVentana           = 0;
     nBtnMT             = -1;
     nBtnDT             = -1;
     nBtnED             = -1;
     nBtnEA             = -1;
     nBtnEC             = -1;
     nBtnAD             = -1;
     nRango             = 0;
     nGrid              = 0;
     nSwLaboralNotFound = 0;
     nTrabCapturados    = 0;
     nCorreosActuali    = 0;
     nPanW7             = 0;
     nOk                = 0;

     aEsc1              = "";
     aEsc2              = "";
     aRetu              = "";
     aTecla             = "";
     aBase              = "";
     aLaboral           = "";
     aDef               = "";
     aMensaje           = "";
     aAlfa              = "";

     aDni               = "";
     aEmail             = "";
     aUsuario           = "";
     aCorreo            = "";
     nVentCorreo        = 0;
     aMarca             = "";
     aVerde             = "0,185,0;255,255,255";
     aRojo              = "255,80,80;255,255,255";
     aHora              = "";
     aFecha             = "";

     fFecha             = @;

     {-1}aVent          = "";
         aVent1         = 0;
         aVent2         = 0;
         aVent3         = 0;
         aVent4         = 0;
         aVent5         = "";

     &enEmpresa         = 0;
     &eaModoNet         = "";
     &eaUsuNet          = "";
     &eaFechaNet        = "";
     &eaAccesoNet       = "";
     &eaEmpNet          = "";
     &eaTraNet          = "";
     &eaAccNet          = "";
     &eaMaiNet          = "";
     &eaDesNet          = "";
     &eaLabNet          = "";
     &eaAcceso          = "";
     &enSwHayRegistros  = 0;
|FIN;

|PROGRAMA;
     |SI nSwLaboralNotFound = 1;
         aMensaje = "0000Proceso cancelado. Modulo Laboral NO instalado";
         |MENAV aMensaje;
         |ACABA;
     |FINSI;

     |SI eaAcceso = "DESPABOX";
         |HAZ Despabox;
     |FINSI;

     |SI eaAcceso = "PIBOX";
         |HAZ Pibox;
     |FINSI;
|FPRO;

|PROCESO dpntm004Cheq;
     enSwHayRegistros = 1;
     |ERROR10;
|FPRC;

|DEFBUCLE dpntm004Cheq;
     #dpntm004#1;
     ;
     enEmpresa, "            ";
     enEmpresa, "zzzzzzzzzzzz";
     ;
     NULL, dpntm004Cheq;
|FIN;

|PROCESO T80;  |TIPO 80;
     |ABRE #dpntm001;
     |DDEFECTO #dpntm001;
     #dpntm001#0 = enEmpresa;
     |LEE 000#dpntm001.=;
     |CIERRA #dpntm001;

     |DBASS aBase;   |QBF aBase;

     aLaboral = aBase + "laboral/";
     aDef = aLaboral + "def/labtraba.mas";
     |CARGA_DEF aDef, labtraba@;
     |SI FSalida ! 0;
          nSwLaboralNotFound = 1;
     |FINSI;

     aMarca = "";
     |BUCLE dpntm004Cheq;

     |ABRET #dpntm004;
     |ABRET #labtraba@;
|FPRC;

|PROCESO T90;  |TIPO 90;
     |CIERRAT #dpntm004;

     |CIERRAT #labtraba@;
     |DESCARGA_DEF #labtraba@;
|FPRC;
