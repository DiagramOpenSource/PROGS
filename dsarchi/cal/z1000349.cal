|FICHEROS;
|FIN;

|VARIABLES;
|FIN;

|INCLUYE z1000var;

|PROCESO Verifica349;
     aAlfa = eaDni % 201;
     |SI aAlfa < "0";  |O aAlfa > "9";
         eaDni       = "";
         eaEjercicio = "";
         enModelo    = 0;
         enChequeo   = 0;
         |ACABA;
     |FINSI;

     eaEjercicio = eaEjercicio - ".";
     nEjercicio  = eaEjercicio;

     |SI nEjercicio [ 2000;  eaEjercicio = "";  |ACABA;  |FINSI;
     |SI nEjercicio ] 2999;  eaEjercicio = "";  |ACABA;  |FINSI;

     enChequeo = 1;  enModelo  = 349;

     aAlfa = eaJusti % 103;
     |SI aAlfa ! "349";
         eaJusti = "";
     |FINSI;
|FPRC;

|PROCESO Es349;
     enChequeo = 1;
     enModelo  = 349;

     |SI nTipoModelo = 1;
         eaEjercicio =  eaContenido % -104;

         enLinea = 14;  |HAZ LeeContenido;  eaContenido = eaContenido % -102;
         |HAZ CargaPeriodoPdf;

         enLinea = 10;  |HAZ LeeContenido;  eaDni   = eaContenido % 109;
                                           eaJusti = eaContenido % -113;
         enLinea = 6;   |HAZ LeeContenido;  eaElect = eaContenido % -116;

         |ACABA;
     |FINSI;

     |SI nTipoModelo = 2;
         enLinea = 15;  |HAZ LeeContenido;  eaEjercicio = (eaContenido % 505) - ".";
         eaContenido = eaContenido % -102; |HAZ CargaPeriodoPdf;

         enLinea = 9;    |HAZ LeeContenido;  eaDni   = eaContenido % -109;

         |PARA enLinea = 70;  |SI enLinea [ 90;  |HACIENDO enLinea = enLinea + 1;
               |HAZ LeeContenido;  |HAZ CogeJustificante;
               |SI eaJusti ! "";  |Y eaElect ! ""; |SAL;  |FINSI;
         |SIGUE;

         |ACABA;
     |FINSI;

     |SI nTipoModelo = 3;
         enLinea = 11;  |HAZ LeeContenido;  eaEjercicio = (eaContenido % 2105) - ".";
         eaContenido = eaContenido % -102; |HAZ CargaPeriodoPdf;

         enLinea = 13;   |HAZ LeeContenido;  eaDni   = eaContenido % 209;

         |PARA enLinea = 70;  |SI enLinea [ 90;  |HACIENDO enLinea = enLinea + 1;
               |HAZ LeeContenido;  |HAZ CogeJustificante;
               |SI eaJusti ! "";  |Y eaElect ! ""; |SAL;  |FINSI;
         |SIGUE;

         |ACABA;
     |FINSI;

     enLinea = 35;  |HAZ LeeContenido;  eaEjercicio = (eaContenido % 2105) - ".";
     eaContenido = eaContenido % -102; |HAZ CargaPeriodoPdf;

     enLinea = 12;  |HAZ LeeContenido;  eaElect     = eaContenido % -116;
     enLinea = 32;  |HAZ LeeContenido;  eaDni       = eaContenido % -109;
     enLinea = 18;  |HAZ LeeContenido;  eaJusti     = eaContenido % 2213;
     |HAZ Verifica349;
     |SI eaEjercicio ! "";  |ACABA;  |FINSI;

     enLinea = 42;  |HAZ LeeContenido;  eaEjercicio = (eaContenido % 2105) - ".";
     eaContenido = eaContenido % -102; |HAZ CargaPeriodoPdf;

     enLinea = 12;  |HAZ LeeContenido;  eaElect     = eaContenido % -116;
     enLinea = 39;  |HAZ LeeContenido;  eaDni       = eaContenido % -109;
     enLinea = 25;  |HAZ LeeContenido;  eaJusti     = eaContenido % 2213;
     |HAZ Verifica349;
     |SI eaEjercicio ! "";  |ACABA;  |FINSI;

     enLinea = 37;  |HAZ LeeContenido;  eaEjercicio = (eaContenido % 2105) - ".";
     eaContenido = eaContenido % -102; |HAZ CargaPeriodoPdf;

     enLinea = 8;   |HAZ LeeContenido;  eaElect     = eaContenido % -116;
     enLinea = 34;  |HAZ LeeContenido;  eaDni       = eaContenido % -109;
     enLinea = 20;  |HAZ LeeContenido;  eaJusti     = eaContenido % 2213;
     |HAZ Verifica349;
     |SI eaEjercicio ! "";  |ACABA;  |FINSI;

     enLinea = 34;  |HAZ LeeContenido;  eaEjercicio = (eaContenido % 2104);
     eaContenido = eaContenido % -102; |HAZ CargaPeriodoPdf;

     enLinea = 8;   |HAZ LeeContenido;  eaElect     = eaContenido % -116;
     enLinea = 36;  |HAZ LeeContenido;  eaDni       = eaContenido % 209;
     enLinea = 20;  |HAZ LeeContenido;  eaJusti     = eaContenido % 2213;
     |HAZ Verifica349;
     |SI eaEjercicio ! "";  |ACABA;  |FINSI;

     enLinea = 35;  |HAZ LeeContenido;  eaEjercicio = (eaContenido % 2105) - ".";
     eaContenido = eaContenido % -102; |HAZ CargaPeriodoPdf;

     enLinea = 8;   |HAZ LeeContenido;  eaElect     = eaContenido % -116;
     enLinea = 32;  |HAZ LeeContenido;  eaDni       = eaContenido % -109;
     enLinea = 20;  |HAZ LeeContenido;  eaJusti     = eaContenido % 2213;
     |HAZ Verifica349;
     |SI eaEjercicio ! "";  |ACABA;  |FINSI;

     enLinea = 45;  |HAZ LeeContenido;  eaEjercicio = eaContenido % -104;
     enLinea = 49;  |HAZ LeeContenido;
     eaContenido = eaContenido % -102; |HAZ CargaPeriodoPdf;

     enLinea = 8;   |HAZ LeeContenido;  eaElect     = eaContenido % -116;
     enLinea = 51;  |HAZ LeeContenido;  eaDni       = eaContenido % 109;
     enLinea = 20;  |HAZ LeeContenido;  eaJusti     = eaContenido % 2213;
     |HAZ Verifica349;
     |SI eaEjercicio ! "";  |ACABA;  |FINSI;
|FPRC;

|PROCESO MiraSiEs349;
     enLinea = 3;  |HAZ LeeContenido;  eaContenido = eaContenido % -103;
     |SI eaContenido = "349";
         nTipoModelo = 4;  |HAZ Es349;
         |SI eaEjercicio ! "";  |Y eaPeriodo ! "";
             |ACABA;
         |FINSI;
     |FINSI;

     enLinea = 2;  |HAZ LeeContenido;
     eaContenido = eaContenido - "Modelo349";
     |SI FSalida ! 0;
         nTipoModelo = 1;
         |HAZ Es349;
         |ACABA;
     |FINSI;

     enLinea = 8;  |HAZ LeeContenido;
     eaContenido = eaContenido %  -103;
     |SI eaContenido = "349";
         nTipoModelo = 2;
         |HAZ Es349;
         |ACABA;
     |FINSI;

     enLinea = 7;  |HAZ LeeContenido;
     eaContenido = eaContenido %  -103;
     |SI eaContenido = "349";
         nTipoModelo = 3;
         |HAZ Es349;
         |ACABA;
     |FINSI;
|FPRC;
