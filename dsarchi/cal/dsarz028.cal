|FICHEROS;
     dsarz028 #1;

     dsarm018 #18;       ||Reglas Automatizacio
     dsarm019 #19;       ||Reglas. Cond. Campos
     dsarw039 #39,MANTE; ||Aux.Reglas Automat.
     dsarw016 #916;
     referen@ #999;
     dsarw040 #40,MANTE; ||Aux. Copiar Regla

     dsarm004 #4;        ||Tipos Documentos

     dsarw010 #510;       ||Configuracion DSCORREO
     dsarw065 #565,MANTE; ||Aux. Cuenta CORREO
|FIN;

|VARIABLES;
     aPassword = "";
     {1}aContiene     = "";
     nError = 0;
     aOrigen = "";
     nHandle = 0;
     aDestino = "";
     aDocDestino = "";
     aDocOrigen = "";
     aIPRemoto = "";
     aLinea = "";


     &eaUnidad = "";
     nRegla = 0;
     nLabel = 0;

     {-1}aVent      = "";
         aVent1     = 0;
         aVent2     = 0;
         aVent3     = 0;
         aVent4     = 0;
         aVent5     = "";

     nSubVent = 0;
     &enNumRegla = 0;
     aEjecuta = "";
     aQueBoton     = "";
     aID           = "";
     nBotonAceptar = 0;
     nBotonCancelar = 0;

     aAux = "";
     nTCampo = 0;
     aQueQuiero = "";
     aFichero = "";
     aBase = "";
     aCarga = "";
     nCampo = 0;
     nBotonElegir = 0;
     nBotonCondiciones = 0;
     aImpre = "";

     nUltimo = 0;
     nIdSalir = 0;
     {2}nNivel = 0;
     nVentana = 0;
     nPantaDos = 0;
     aCadena = "";
     aAlfa = "";
     nCampoHasta = 0;
     nCampoD = 0;
     nCampoH = 0;


     aMensaje = "";

     nBoton1 = 0;
     nBoton2 = 0;
     nBoton3 = 0;
     nBoton4 = 0;
     nBoton5 = 0;
     nPanta = 0;
     nRango = 0;
     nPos1  = 0;
     nPos2  = 0;
     nGrid = 0;
     aEsc1  = "";
     aEsc2  = "";
     aRetu  = "";
     aTecla = "";

     nModo = 0;
|FIN;

|PROCESO Tipo12w065; |TIPO 12;

|FPRC;

|PROCESO Tipo12w039; |TIPO 12;

|FPRC;

|PROCESO Tipo0C5_w065; |TIPO 0;
     aPassword = #dsarw065#5;
     #dsarw065#5 = "*********";
     |PINTA #dsarw065#5;
|FPRC;

|PROCESO Tipo7C5_w065; |TIPO 7;
     #dsarw065#5 = aPassword;
     |PINTA #dsarw065#5;
|FPRC;

|PROCESO Tipo0C0w039; |TIPO 0;
     |SI FSalida ! 7;
          |SI nModo = 1;
               #dsarm018#0 = #dsarw039#0;
               |LEE 000#dsarm018.=;
               |SI FSalida = 0;
                    aMensaje = "0000Error: Regla YA definida previamente";
                    |MENAV aMensaje;
                    |ERROR;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0C0w040; |TIPO 0;
     |SI FSalida ! 7;
          |SI #dsarw040#0 = #dsarw040#2;
               aMensaje = "0000Error: Regla Origen = Regla Destino";
               |MENAV aMensaje;
               |ERROR;
          |SINO;

               #dsarm018#0 = #dsarw040#2;
               |LEE 000#dsarm018.=;
               |SI FSalida = 0;
                    aMensaje = "0000Error: Regla YA definida previamente";
                    |MENAV aMensaje;
                    |ERROR;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo12w040; |TIPO 12;
|FPRC;


|PROCESO Tipo0Etiqueta; |TIPO 0;
     nCampo = Campo - 2;
     aAux = #39Campo;
     |QBF aAux;
     |SI aAux = ""; |Y #39nCampo = 0;
          nCampo = nCampo + 1;
          #39nCampo = "";
          |PINTA #39nCampo;
     |SINO;
          |SI aAux ! ""; |Y #39nCampo = 0;
               nCampo = Campo - 1;
               #39nCampo = "Linea";
               |PINTA #39nCampo;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo66Campos;  |TIPO 66;
     |ABRE #916;
     |LEE 000#916p;
     |CONSULTA_CLAVE #1#916;
     |SI FSalida = 0;
         nCampo    = Campo + 1;
         #39Campo  = #916#0;    |PINTA #39Campo;
         #39nCampo = #916#1;    |PINTA #39nCampo;
     |FINSI;
     |CIERRA #916;
|FPRC;

|PROCESO Tipo0Campos;  |TIPO 0;
     |ABRE #916;
     #916#0 = #39Campo;
     |LEE 000#916=;
     |SI FSalida ! 0;
         |MENAV "0000No existe el campo";
         |ERROR;
         |CIERRA #916;
         |ACABA;
     |FINSI;
     |CIERRA #916;

     |SI #39Campo ! 0;
          nCampo = Campo + 1;
          #39Campo = #916#0;    |PINTA #39Campo;
          #39nCampo = #916#1;    |PINTA #39nCampo;
          nCampo = nCampo + 1;
          aAux = #39nCampo;
          |QBF aAux;
          |SI aAux = "";
               |SI #39Campo = 23; |O #39Campo = 24; |O #39Campo = 25;
                |O #39Campo = 26; |O #39Campo = 27; |O #39Campo = 28;
                |O #39Campo = 29; |O #39Campo = 30; |O #39Campo = 31;
                |O #39Campo = 32; |O #39Campo = 33; |O #39Campo = 34;
                |O #39Campo = 35; |O #39Campo = 36; |O #39Campo = 37;
                |O #39Campo = 60; |O #39Campo = 61; |O #39Campo = 62;
                |O #39Campo = 63; |O #39Campo = 64;
                    |ABRE #dsarm004;
                    |DDEFECTO #dsarm004;
                    #dsarm004#0 = #dsarw039#3;
                    #dsarm004#1 = #dsarw039#5;
                    #dsarm004#2 = #dsarw039#7;
                    |LEE 000#dsarm004.=;
                    |SI FSalida = 0;
                         #39nCampo = #916#1;    |PINTA #39nCampo;
                         |SI #39Campo = 23;
                              #39nCampo = #dsarm004#5;    |PINTA #39nCampo;
                         |FINSI;
                         |SI #39Campo = 24;
                              #39nCampo = #dsarm004#6;    |PINTA #39nCampo;
                         |FINSI;
                         |SI #39Campo = 25;
                              #39nCampo = #dsarm004#7;    |PINTA #39nCampo;
                         |FINSI;
                         |SI #39Campo = 26;
                              #39nCampo = #dsarm004#8;    |PINTA #39nCampo;
                         |FINSI;
                         |SI #39Campo = 27;
                              #39nCampo = #dsarm004#9;    |PINTA #39nCampo;
                         |FINSI;
                         |SI #39Campo = 28;
                              #39nCampo = #dsarm004#10;    |PINTA #39nCampo;
                         |FINSI;
                         |SI #39Campo = 29;
                              #39nCampo = #dsarm004#11;    |PINTA #39nCampo;
                         |FINSI;
                         |SI #39Campo = 30;
                              #39nCampo = #dsarm004#12;    |PINTA #39nCampo;
                         |FINSI;
                         |SI #39Campo = 31;
                              #39nCampo = #dsarm004#13;    |PINTA #39nCampo;
                         |FINSI;
                         |SI #39Campo = 32;
                              #39nCampo = #dsarm004#14;    |PINTA #39nCampo;
                         |FINSI;
                         |SI #39Campo = 33;
                              #39nCampo = #dsarm004#15;    |PINTA #39nCampo;
                         |FINSI;
                         |SI #39Campo = 34;
                              #39nCampo = #dsarm004#16;    |PINTA #39nCampo;
                         |FINSI;
                         |SI #39Campo = 35;
                              #39nCampo = #dsarm004#17;    |PINTA #39nCampo;
                         |FINSI;
                         |SI #39Campo = 36;
                              #39nCampo = #dsarm004#18;    |PINTA #39nCampo;
                         |FINSI;
                         |SI #39Campo = 37;
                              #39nCampo = #dsarm004#19;    |PINTA #39nCampo;
                         |FINSI;
                         |SI #39Campo = 60;
                              #39nCampo = #dsarm004#27;    |PINTA #39nCampo;
                         |FINSI;
                         |SI #39Campo = 61;
                              #39nCampo = #dsarm004#28;    |PINTA #39nCampo;
                         |FINSI;
                         |SI #39Campo = 62;
                              #39nCampo = #dsarm004#29;    |PINTA #39nCampo;
                         |FINSI;
                         |SI #39Campo = 63;
                              #39nCampo = #dsarm004#30;    |PINTA #39nCampo;
                         |FINSI;
                         |SI #39Campo = 64;
                              #39nCampo = #dsarm004#31;    |PINTA #39nCampo;
                         |FINSI;
                    |SINO;
                         #39nCampo = #916#1;    |PINTA #39nCampo;
                    |FINSI;
                    |CIERRA #dsarm004;
               |SINO;
                    #39nCampo = #916#1;    |PINTA #39nCampo;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO ObtenIdSalir;
     InNivel = nNivel1<-;
     nNivel1 = 0;
     |ESPECIFICA "IDBOTONTECLA", nNivel;
     nIdSalir = nNivel2;
|FPRC;


|PROCESO Tipo80C0; |TIPO 80;
     FSalida = 2999;
|FPRC;

|PROCESO BajaPanta;
     #dsarm018#0 = 01;
|FPRC;

|PROCESO AltaPanta;
     #dsarm018#0 = 99;
|FPRC;

|PROCESO EventoPanta;
     |SI FSalida = 1;  |O FSalida = 2;
          |LEE 000#dsarm018.=;
          |SI FSalida = 0;
               |ESTADO_CONTROL nBoton2, "ENABLE";
               |ESTADO_CONTROL nBoton3, "ENABLE";
               |ESTADO_CONTROL nBoton4, "ENABLE";
          |SINO;
               |ESTADO_CONTROL nBoton2, "DISABLE";
               |ESTADO_CONTROL nBoton3, "DISABLE";
               |ESTADO_CONTROL nBoton4, "DISABLE";
          |FINSI;
     |FINSI;

     |SI FSalida = 4;
          |HAZ Boton2;
     |FINSI;
|FPRC;

|PROCESO Boton1;
     nModo = 1;
     |HAZ ModiAlta;
     |REFRESCACONTROL nGrid;
|FPRC;

|PROCESO Boton2;
     |LEE 000#dsarm018.=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     nModo = 2;
     |HAZ ModiAlta;
     |REFRESCACONTROL nGrid;
|FPRC;

|PROCESO dsarm019_borra;
     |BORRA 020#dsarm019.a;
|FPRC;

|DEFBUCLE dsarm019_borra;
 #dsarm019#1;
 ;
 #dsarm018#0, 0001;
 #dsarm018#0, 9999;
 be;
 NULL, dsarm019_borra;
|FIN;

|PROCESO Boton3;
     |LEE 000#dsarm018.=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |LEE 101#dsarm018.=;
     |SI FSalida = 0;
          aMensaje = "0000NDesea Borrar " + #18#1;
          |QBF aMensaje;
          aMensaje = aMensaje + "?";
          |CONFI aMensaje;
          |SI FSalida = 0;
               |BUCLE dsarm019_borra;
               |BORRA 020#dsarm018.a;
          |FINSI;
          |LIBERA #dsarm018;
     |FINSI;

     |REFRESCACONTROL nGrid;
|FPRC;

|PROCESO dsarm019_copia;
     #dsarm019#0 = #dsarw040#2;
     |GRABA 020#dsarm019.n;
     |LIBERA #dsarm019;
|FPRC;

|DEFBUCLE dsarm019_copia;
 #dsarm019#1;
 ;
 nRegla, 0001;
 nRegla, 9999;
 ;
 NULL, dsarm019_copia;
|FIN;

|PROCESO Boton4;
     |LEE 000#dsarm018.=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     nRegla = #dsarm018#0;

     |VENTANA 1010, 1590, nPanta, 17, "Copiar Regla";
     nSubVent = FSalida;

     nLabel = -1;
     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DDEFECTO #dsarw040;
     #dsarw040#0 = #dsarm018#0;
     #dsarw040#1 = #dsarm018#1;
     nUltimo = 0;
     |HAZ DameUltimo;
     nUltimo = nUltimo + 1;
     #dsarw040#2 = nUltimo;

     |PINPA #0#dsarw040;
     |PINDA #0#dsarw040;

     |ENDATOS #1#dsarw040;
     |SI FSalida = 0;
          #dsarm018#0 = nRegla;
          |LEE 000#dsarm018.=;
          |SI FSalida = 0;
               #dsarm018#0 = #dsarw040#2;
               #dsarm018#1 = #dsarw040#3;
               |GRABA 020#dsarm018.n;
               |LIBERA #dsarm018;

               |BUCLE dsarm019_copia;
          |FINSI;

          ||TODO CCC
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;

     |REFRESCACONTROL nGrid;
|FPRC;

|PROCESO TraeteDSBrowserPrint;
     |DBASE aBase;
     |QBF aBase;

     nError = 0;

     aOrigen = aBase + "dlls/dsbrowserprint.exe";
     |XABRE "E", aOrigen, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     eaUnidad = "C";
     |HAZ DimeUnidad;
     aDestino = eaUnidad + ":\DOCUMENTOS\DSARCHI\dsbrowserprint.exe";

     aContiene1 = aDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocDestino = FSalida;  |QBF aDocDestino;

     aContiene1 = aOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocOrigen = FSalida;  |QBF aDocOrigen;

     |SI aDocDestino ! aDocOrigen;  |O aDocDestino = "";
         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;
     |FINSI;

     aAlfa = eaUnidad + ":\DOCUMENTOS\DSARCHI\dsbrowserprint.exe";
     |XABRE "EC", aAlfa, nHandle;
     |SI FSalida < 0;
         |MENAV "0000 No puedo instalar el Selector de Impresoras (dsbrowserprint.exe)";
         nError = 1;
     |FINSI;
|FPRC;

|PROCESO BotonElegir;
     |HAZ TraeteDSBrowserPrint;

     aDestino = eaUnidad + ":\DOCUMENTOS\DSARCHI\impresora.sel";

     aEjecuta = eaUnidad + ":\DOCUMENTOS\DSARCHI\dsbrowserprint.exe";
     aEjecuta = aEjecuta + " " + eaUnidad + ":\DOCUMENTOS\DSARCHI\impresora.sel";
     |RSYSTEM aEjecuta;

     aAlfa = eaUnidad + ":\DOCUMENTOS\DSARCHI\impresora.sel";
     |XABRE "CU", aAlfa, nHandle;
     |SI FSalida < 0;
          #dsarw039#10 = "";
     |SINO;
          |XLEE nHandle, 250, aLinea;
          |SI FSalida ] 0;
               #dsarw039#10 = aLinea;
          |SINO;
               #dsarw039#10 = "";
          |FINSI;
     |FINSI;
     |XCIERRA nHandle;
     |PINTA #dsarw039#10;


/*
     |IMPRE 0;
     |SI FSalida = 0;
          aImpre = Impresora;
          |QBF aImpre;
          aMensaje = "0000Seleccionada Impresora: " + aImpre;
          |MENAV aMensaje;
          #dsarw039#10 = aImpre;
          |PINTA #dsarw039#10;
          |FINIMP;
     |FINSI;
*/
|FPRC;

|PROCESO BotonCondiciones;
     aQueBoton     = "|X000";
     aID           = #dsarw039#aQueBoton#;
     nBotonAceptar = aID;
     |ESTADO_CONTROL nBotonAceptar, "HIDE";

     aQueBoton      = "|X001";
     aID            = #dsarw039#aQueBoton#;
     nBotonCancelar = aID;
     |ESTADO_CONTROL nBotonCancelar, "HIDE";

     enNumRegla = #dsarw039#0;

     aEjecuta = "dsarz029";
     |SUB_EJECUTA_NP aEjecuta;

     |ESTADO_CONTROL nBotonAceptar, "SHOW";
     |ESTADO_CONTROL nBotonCancelar, "SHOW";
|FPRC;

|PROCESO CargaTemporal;
     aFichero = ("17" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #916 aFichero;

     |ABRE #916;  |CIERRA #916;  |DELINDEX #916;

     |ABRE #916;

     |DBASE aBase;  |QBF aBase;
     aCarga    = aBase + "def/dsarm005.mas";  |QBF aCarga;
     |CARGA_DEF aCarga, referen@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aQueQuiero = "|NC";
     aAlfa      = #999#aQueQuiero#;
     nTCampo    = aAlfa;
     nTCampo    = nTCampo - 1;

     |PARA nCampo = 0;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           aFichero   = (#999#aQueQuiero# + (" " * 20)) % 120;
           #916#0 = nCampo;
           #916#1 = aFichero;

           |GRABA 020#916n;
     |SIGUE;
     |CIERRA #916;

     |DESCARGA_DEF #referen@;
|FPRC;


|PROCESO ModiAlta;
     nIdSalir = 0;
     |HAZ ObtenIdSalir;
     |ESTADO_CONTROL nIdSalir, "HIDE";

     |VENTANA 0501, 2999, -1, -1, "";
     nVentana = FSalida;

     aCadena ="|NC";
     aAlfa = #18#aCadena#;
     nCampoHasta = aAlfa;
     nCampoHasta = nCampoHasta - 1;

     |SI nModo ! 1;
          |PARA nCampoD = 0;  |SI nCampoD [ nCampoHasta; |HACIENDO nCampoD = nCampoD + 1;
                nCampoH = nCampoD;
                #39nCampoH = #18nCampoD;
          |SIGUE;

          |C_M #39#0, 1, "N";
     |SINO;
          |C_M #39#0, 1, "S";
          nUltimo = 0;
          |HAZ DameUltimo;
          |DDEFECTO #39;
          nUltimo = nUltimo + 1;
          #39#0 = nUltimo;
     |FINSI;

     |HAZ CargaTemporal;

     |PINPA #0#39; nPantaDos = FSalida;
     |PINDA #0#39;

     |CONTROL_SIMPLE nPantaDos, "BOTON,Elegir", 1311, 1321, BotonElegir;
     nBotonElegir = FSalida;

     |CONTROL_SIMPLE nPantaDos, "BOTON,Condiciones Campos", 0883, 0993, BotonCondiciones;
     nBotonCondiciones = FSalida;

     |SI nModo = 1;  |ENDATOS #1#39;  |FINSI;
     |SI nModo = 2;  |ENDATOS #2#39;  |FINSI;

     |SI FSalida = 0;
          |HAZ GrabaDatos;
     |FINSI;

     |ABRE #916;  |CIERRA #916;  |DELINDEX #916;


     |FIN_CONTROL_WINDOWS nBotonElegir;
     |FIN_CONTROL_WINDOWS nBotonCondiciones;

     |FINVENTANA nVentana;

     |ESTADO_CONTROL nIdSalir, "SHOW";
|FPRC;

|PROCESO DameUltimo;
     |LEE 000#dsarm018.u;
     |SI FSalida = 0;
          nUltimo = #dsarm018#0;
     |SINO;
          nUltimo = 0;
     |FINSI;
|FPRC;

|PROCESO GrabaDatos;
     #18#0 = #39#0;
     |LEE 101#18=;
     |SI FSalida ! 0;
         |DDEFECTO #18;
         #18#0 = #39#0;
         |GRABA 020#18b;
     |FINSI;

     |PARA nCampoD = 1;  |SI nCampoD [ nCampoHasta;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH   = nCampoD;
           #18nCampoD = #39nCampoH;
     |SIGUE;

     |GRABA 020#18a;
     |LIBERA #18;
|FPRC;

|PROCESO Boton5;
     |VENTANA 0802, 1898, nPanta, 17, "Cuenta Correo -REGLAS DSARCHI-";
     nSubVent = FSalida;

     nLabel = -1;
     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     ||ARA99
     |ABRE #dsarw010;
     |DDEFECTO #dsarw010;
     |LEE 000#dsarw010.p;
     |CIERRA #dsarw010;

     #dsarw065#0 = #dsarw010#33;
     #dsarw065#1 = #dsarw010#34;
     #dsarw065#2 = #dsarw010#35;
     #dsarw065#3 = #dsarw010#36;
     #dsarw065#4 = #dsarw010#37;
     aPassword = #dsarw010#38
     #dsarw065#5 = "**********";

     |PINPA #0#dsarw065;
     |PINDA #0#dsarw065;

     |ENDATOS #1#dsarw065;
     |SI FSalida = 0;
          |ABRE #dsarw010;
          |DDEFECTO #dsarw010;
          |LEE 101#dsarw010.p;
          |SI FSalida ! 0; |GRABA 020#dsarw010.b; |FINSI;
          #dsarw010#33 = #dsarw065#0;
          #dsarw010#34 = #dsarw065#1;
          #dsarw010#35 = #dsarw065#2;
          #dsarw010#36 = #dsarw065#3;
          #dsarw010#37 = #dsarw065#4;
          #dsarw010#38 = aPassword;
          |GRABA 020#dsarw010.a;
          |LIBERA #dsarw010;
          |CIERRA #dsarw010;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;


|PROGRAMA;
     |CLS;
     |CABEZA "Reglas Automatizacion Documentos";

     |ABRE #dsarm018;

     |PINPA #0#dsarz028;
     nPanta = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{193}}Alta ", 2753, 2763, Boton1;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Modificar ", 2765, 2775, Boton2;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{199}}Baja ", 2777, 2787, Boton3;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,[+]   Copiar ", 2703, 2713, Boton4;
     nBoton4 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,Cuenta Correo", 0685, 0695, Boton5;
     nBoton5= FSalida;

     ||POner los 5 botones

     nRango = 4 + 8 + 16 + 32;
     nPos1  = 0702;
     nPos2  = 2698;

     |LINEAL_SIMPLE #1#dsarm018, nRango, nPos1, nPos2, BajaPanta, AltaPanta, EventoPanta;
     nGrid = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nGrid;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nGrid;

     |DESTRUYECONTROL nBoton1;
     |DESTRUYECONTROL nBoton2;
     |DESTRUYECONTROL nBoton3;
     |DESTRUYECONTROL nBoton4;
     |DESTRUYECONTROL nBoton5;

     |CIERRA #dsarm018;
|FPRO;
