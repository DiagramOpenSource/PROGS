|FICHEROS;
     dsarw102;
     dsarm001;
     dsarm002;
     dsarm003;
     dsarm004;
|FIN;

|VARIABLES;
     nSalida        = 0;
     nRango         = 0;
     nGrid          = 0;
     nHandle        = 0;
     nBotonAceptar  = 0;
     nBotonCancelar = 0;

     aAlfa          = "";
     aTecla         = "";
     aEsc1          = "";
     aEsc2          = "";
     aRetu          = "";
     aBase          = "";
     aDef           = "";
     aMensaje       = "";
     aEjecuta       = "";
     aQueBoton      = "";
     aID            = "";
|FIN;

|PROCESO Tipo12Fw102;  |TIPO 12;
|FPRC;

|PROCESO Tipo0C0Fw102;
     |SI FSalida  = 2;  |ACABA;  |FINSI;

     |SI #dsarw102#0 = 000;
          |ACABA;
     |FINSI;

     |ABRE #dsarm002;
     #dsarm002#0 = #dsarw102#0;
     |LEE 000#dsarm002.=;
     |SI FSalida ! 0;
          |MENAV "    Grupo inexistente"; |ERROR;
          #dsarw102#3 = "";
          #dsarw102#3 = #dsarm002#1;
     |SINO;
          #dsarw102#3 = #dsarm002#1;
     |FINSI;
     |CIERRA #dsarm002;

     |PINTA #dsarw102#3;
|FPRC;

|PROCESO Bajas3;
     #dsarm003#0 = #dsarw102#0;
     #dsarm003#1 = 0;
|FPRC;

|PROCESO Altas3;
     #dsarm003#0 = #dsarw102#0;
     #dsarm003#1 = 999;
|FPRC;

|PROCESO T66C1w102;  |TIPO 66;
     |ABRE #dsarm003;
     |CONSULTA_F_CLAVE #1#dsarm003, Bajas3, Altas3;
     |SI FSalida = 0;
         #dsarw102#1 = #dsarm003#1;
         #dsarw102#4 = #dsarm003#2;
     |FINSI;
     |CIERRA #dsarm003;

     |PINTA #dsarw102#1;
     |PINTA #dsarw102#4;
|FPRC;

|PROCESO Bajas4;
     #dsarm004#0 = #dsarw102#0;
     #dsarm004#1 = #dsarw102#1;
     #dsarm004#2 = 0;
|FPRC;

|PROCESO Altas4;
     #dsarm004#0 = #dsarw102#0;
     #dsarm004#1 = #dsarw102#1;
     #dsarm004#2 = 999;
|FPRC;

|PROCESO T66C2w102;  |TIPO 66;
     |ABRE #dsarm004;
     |CONSULTA_F_CLAVE #1#dsarm004, Bajas4, Altas4;
     |SI FSalida = 0;
         #dsarw102#2 = #dsarm004#2;
         #dsarw102#5 = #dsarm004#3;
     |FINSI;
     |CIERRA #dsarm004;

     |PINTA #dsarw102#2;
     |PINTA #dsarw102#5;
|FPRC;

|PROCESO Tipo0C1Fw102;
     |SI FSalida  = 2;  |ACABA;  |FINSI;

     |SI #dsarm001#8   = "N";  |ACABA;  |FINSI;

     |SI #dsarw102#1 = 000;
          |ACABA;
     |FINSI;

     |ABRE #dsarm003;
     #dsarm003#0 = #dsarw102#0;
     #dsarm003#1 = #dsarw102#1;
     |LEE 000#dsarm003.=;
     |SI FSalida ! 0;
          |MENAV "    Subgrupo inexistente"; |ERROR;
          #dsarw102#4 = "";
     |SINO;
          #dsarw102#4 = #dsarm003#2;
     |FINSI;
     |CIERRA #dsarm003;

     |PINTA #dsarw102#4;
|FPRC;

|PROCESO Tipo0C2Fw102;
     |SI FSalida  = 2;  |ACABA;  |FINSI;

     |SI #dsarm001#8   = "N";  |ACABA;  |FINSI;

     |SI #dsarw102#2 = 000;
          |ACABA;
     |FINSI;

     |ABRE #dsarm004;
     #dsarm004#0 = #dsarw102#0;
     #dsarm004#1 = #dsarw102#1;
     #dsarm004#2 = #dsarw102#2;
     |LEE 000#dsarm004.=;
     |SI FSalida ! 0;
          |MENAV "    Tipo inexistente"; |ERROR;
          #dsarw102#5 = "";
     |SINO;
          #dsarw102#5 = #dsarm004#3;
     |FINSI;
     |CIERRA #dsarm004;

     |PINTA #dsarw102#5;
|FPRC;

|PROCESO Tipo7C0Fw102; |TIPO 7;
     |SI #dsarm001#8 = "N";
          |C_M #dsarw102#1, 1, "N";  #dsarw102#1 = 1;
          |C_M #dsarw102#2, 1, "N";  #dsarw102#2 = 1;
     |SINO;
          |C_M #dsarw102#1, 1, "S";
          |C_M #dsarw102#2, 1, "S";
     |FINSI;

     |PINTA #dsarw102#1;
     |PINTA #dsarw102#2;
|FPRC;
