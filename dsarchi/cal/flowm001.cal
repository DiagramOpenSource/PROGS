||ControlLiterales

|FICHEROS;
     dsarm001 #1;
     dsarm002 #2;
     dsarm003 #3;
     dsarm004 #4;

     flowm001 #601;
     flowm002 #602;
     flowm003 #603;
     flowm004 #604;
     flowm008 #608;

     dsarz010 #110;

     dpntw002 #902;
     dpntw003 #903;
     dpntw004 #904;

     floww001 #801,MANTE;
     floww002 #802,MANTE;
     floww005 #805,MANTE;

     flowm002@ #1602;
|FIN;

|VARIABLES;
     aMarca = "";
     nGrupoOri = 0;
     nSubGOri = 0;
     nTipoOri = 0;
     aMensaje = "";
     &enGrupoTres    = 0;
     &enSubGTres     = 0;
     &enTipoTres     = 0;
     aEjecuta = "";

     aLiteral = "";
     nSwModo = 0;
     aEsc1           = "";
     aEsc2           = "";
     aRetu           = "";
     aTecla          = "";
     aFichero        = "";
     aAlfa           = "";
     aBase           = "";
     aMas            = "";

     nVentana        = 0;
     nVentTrab       = 0;
     nRango          = 0;
     nGrupo          = 0;
     nSubGrupo       = 0;
     nTipo           = 0;
     nDSubGrupo      = 0;
     nHSubGrupo      = 0;
     nDTipo          = 0;
     nHTipo          = 0;
     nDesde          = 0;
     nHasta          = 0;
     nVent           = 0;
     nPanta801       = 0;
     nPanta802       = 0;
     nGrid601        = 0;
     nGrid602        = 0;
     nGrid603        = 0;
     nGrid604        = 0;
     nGrid902        = 0;
     nGrid903        = 0;
     nGrid904        = 0;
     nBoton1         = 0;
     nBoton2         = 0;
     nBoton3         = 0;
     nBoton4         = 0;
     nBoton5         = 0;
     nSubBoton1      = 0;
     nSubBoton2      = 0;
     nSubBoton3      = 0;
     nSubBoton4      = 0;
     nSubBoton5      = 0;
     nLabelCarpeta   = -1;
     nLabelSitua     = -1;
     nSituacion      = -1;
     nRespuesta      = -1;
     nCampo          = -1;
     nUsuarios       = 0;

     &enGrupo        = 0;
     &enSubGrupo     = 0;
     &enTipo         = 0;

     {-1}aVent       = "";
         aVent1      = 0;
         aVent2      = 0;
         aVent3      = 0;
         aVent4      = 0;
         aVent5      = "";
|FIN;

|PROCESO CtrlSoloUna; |TIPO 0;
     aMarca = #floww005#Campo#;
     |QBF aMarca;
     |SI aMarca = "S";
          |SI Campo = 44;
               #floww005#45 = "N";
               #floww005#46 = "N";
               #floww005#47 = "N";
               #floww005#48 = "N";
          |FINSI;
          |SI Campo = 45;
               #floww005#44 = "N";
               #floww005#46 = "N";
               #floww005#47 = "N";
               #floww005#48 = "N";
          |FINSI;
          |SI Campo = 46;
               #floww005#44 = "N";
               #floww005#45 = "N";
               #floww005#47 = "N";
               #floww005#48 = "N";
          |FINSI;
          |SI Campo = 47;
               #floww005#44 = "N";
               #floww005#45 = "N";
               #floww005#46 = "N";
               #floww005#48 = "N";
          |FINSI;
          |SI Campo = 48;
               #floww005#44 = "N";
               #floww005#45 = "N";
               #floww005#46 = "N";
               #floww005#47 = "N";
          |FINSI;
          |PINTA #floww005#44;
          |PINTA #floww005#45;
          |PINTA #floww005#46;
          |PINTA #floww005#47;
          |PINTA #floww005#48;
     |FINSI;
|FPRC;

|PROCESO flowm003B;
     |BORRA 020#603a;
     |LIBERA #603;
|FPRC;

|DEFBUCLE flowm003B;
     #603#1;
     ;
     #602#0, #602#1, #602#2, #602#3, 001;
     #602#0, #602#1, #602#2, #602#3, 999;
     be;
     NULL, flowm003B;
|FIN;

|PROCESO flowm004B;
     |BORRA 020#604a;
     |LIBERA #604;
|FPRC;

|DEFBUCLE flowm004B;
     #604#1;
     ;
     #602#0, #602#1, #602#2, #602#3, "          ";
     #602#0, #602#1, #602#2, #602#3, "zzzzzzzzzz";
     be;
     NULL, flowm004B;
|FIN;

|PROCESO flowm008B;
     |BORRA 020#608a;
     |LIBERA #608;
|FPRC;

|DEFBUCLE flowm008B;
     #608#1;
     ;
     #602#0, #602#1, #602#2, #602#3;
     #602#0, #602#1, #602#2, #602#3;
     be;
     NULL, flowm008B;
|FIN;

|PROCESO Tipo12Fw2;  |TIPO 12;
|FPRC;

|PROCESO Tipo12Fw005; |TIPO 12;
|FPRC;

|PROCESO Tipo12Fw1;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     |SI #801#17 = "S";  |ACABA;  |FINSI;

     |SI #801#11 = 0;
         |MENAV "0000Introduzca la unidad de tiempo de caducidad.";
         |ERROR;
         |ACABA;
     |FINSI;

     #603#0 = #602#0;
     #603#1 = #602#1;
     #603#2 = #602#2;
     #603#3 = #602#3;
     #603#4 = 1;
     |LEE 000#603];
     |SI FSalida ! 0;  |O #603#0 ! #602#0; |O #603#1 ! #602#1;
                       |O #603#2 ! #602#2; |O #603#3 ! #602#3;
         |MENAV "0000Introduzca por lo menos una RESPUESTA.";
         |ERROR;
         |ACABA;
     |FINSI;

     #604#0 = #602#0;
     #604#1 = #602#1;
     #604#2 = #602#2;
     #604#3 = #602#3;
     #604#4 = "";
     |LEE 000#604];
     |SI FSalida ! 0;  |O #604#0 ! #602#0; |O #604#1 ! #602#1;
                       |O #604#2 ! #602#2; |O #604#3 ! #602#3;
         |MENAV "0000Introduzca por lo menos un USUARIO.";
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO Tipo0C11Fw1;  |TIPO 0;
     |SI #801#10 = "H";
         |SI #801#11 > 24;
             |MENAV "0000M ximo 24 horas.";
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0C17Fw1;  |TIPO 0;
     |SI #801#17 = "N";  |ACABA;  |FINSI;

     |CONFI "0000NSeguro que es situaci¢n final";
     |SI FSalida ! 0;
         #801#17 = "N";  |PINTA #801#17;
         |ACABA;
     |FINSI;

     |PDEFECTO #801, 5, 17;

     |BUCLE flowm004B;
     |BUCLE flowm003B;

     |PTEC 806;
|FPRC;

|PROCESO Evento604;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#604=;
     |FINSI;
|FPRC;

|PROCESO Evento603;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#603=;
     |FINSI;

     |SI FSalida = 4;
         nSwModo = 2;

         |LEE 101#603=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |VENTANA 0501, 1299, -1, 16, "Respuesta";
         nVentTrab = FSalida;

         aVent1 = -1;
         aVent2 = -1;
         aVent3 = 0;
         aVent4 = nVentTrab;
         aVent5 = "MODAL";
         |ESPECIFICA "ESTADO_VENTANA", aVent;

         |DDEFECTO #802;
         #802#0 = #603#5;
         #802#1 = #603#6;
         #802#2 = #603#7;
         #802#3 = #603#8;
         #802#4 = #603#9;

         |PINPA #0#802;
         |PINDA #0#802;
         |ENDATOS #1#802;
         |SI FSalida = 0;
             #603#5 = #802#0;
             #603#6 = #802#1;
             #603#7 = #802#2;
             #603#8 = #802#3;
             #603#9 = #802#4;
             |GRABA 020#603a;
         |FINSI;

         |LIBERA #603;

         aVent1 = -1;
         aVent2 = -1;
         aVent3 = 0;
         aVent4 = nVentTrab;
         aVent5 = "MODELESS";
         |ESPECIFICA "ESTADO_VENTANA", aVent;

         |FINVENTANA nVentTrab;

         |REFRESCACONTROL nGrid603;
     |FINSI;
|FPRC;

|PROCESO Baja602;
     #602#0 = #601#0;
     #602#1 = #601#1;
     #602#2 = #601#2;
     #602#3 = 001;
|FPRC;

|PROCESO Alta602;
     #602#0 = #601#0;
     #602#1 = #601#1;
     #602#2 = #601#2;
     #602#3 = 999;
|FPRC;

|PROCESO Baja603;
     #603#0 = #602#0;
     #603#1 = #602#1;
     #603#2 = #602#2;
     #603#3 = #602#3;
     #603#4 = 001;
|FPRC;

|PROCESO Alta603;
     #603#0 = #602#0;
     #603#1 = #602#1;
     #603#2 = #602#2;
     #603#3 = #602#3;
     #603#4 = 999;
|FPRC;

|PROCESO Baja604;
     #604#0 = #602#0;
     #604#1 = #602#1;
     #604#2 = #602#2;
     #604#3 = #602#3;
     #604#4 = "";
|FPRC;

|PROCESO Alta604;
     #604#0 = #602#0;
     #604#1 = #602#1;
     #604#2 = #602#2;
     #604#3 = #602#3;
     #604#4 = "zzzzzzzzzz";
|FPRC;

|PROCESO BotonAlta604;
     |ABRE #110;
     |CONSULTA_CLAVE #1#110;
     |SI FSalida = 0;
         #604#0 = #602#0;
         #604#1 = #602#1;
         #604#2 = #602#2;
         #604#3 = #602#3;
         #604#4 = #110#0;
         |LEE 101#604=;
         |SI FSalida ! 0;
             #604#0 = #602#0;
             #604#1 = #602#1;
             #604#2 = #602#2;
             #604#3 = #602#3;
             #604#4 = #110#0;
             |GRABA 020#604n;
         |FINSI;
         |LIBERA #604;
     |FINSI;
     |CIERRA #110;

     |REFRESCACONTROL nGrid604;
|FPRC;

|PROCESO BotonBaja604;
     |LEE 101#604=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #604#0 ! #602#0; |O #604#1 ! #602#1; |O #604#2 ! #602#2; |O #604#3 ! #602#3;
          |ACABA;
     |FINSI;

     |CONFI "0000NSeguro que quiere dar de baja al usuario.";
     |SI FSalida ! 0;  |LIBERA #604;  |ACABA;  |FINSI;

     |BORRA 020#604a;
     |LIBERA #604;

     |REFRESCACONTROL nGrid604;
|FPRC;

|PROCESO Baja1602;
     #1602#0 = #602#0;
     #1602#1 = #602#1;
     #1602#2 = #602#2;
     #1602#3 = 001;
|FPRC;

|PROCESO Alta1602;
     #1602#0 = #602#0;
     #1602#1 = #602#1;
     #1602#2 = #602#2;
     #1602#3 = 999;
|FPRC;

|PROCESO Tipo66C1Fw2;  |TIPO 66;
     |DBASE aBase;
     aMas = aBase + "def/flowm002.mas";
     |CARGA_DEF aMas, flowm002@;

     |ABRE #1602;
     |CONSULTA_F_CLAVE #1#1602, Baja1602, Alta1602;
     |SI FSalida = 0;
         #802#1 = #1602#3;  |PINTA #802#1;
     |FINSI;
     |CIERRA #1602;

     |DESCARGA_DEF #flowm002@;
|FPRC;

|PROCESO Tipo0C1Fw2;  |TIPO 0;
     |DBASE aBase;
     aMas = aBase + "def/flowm002.mas";
     |CARGA_DEF aMas, flowm002@;

     |ABRE #1602;
     #1602#0 = #603#0;
     #1602#1 = #603#1;
     #1602#2 = #603#2;
     #1602#3 = #802#1;
     |LEE 000#1602=;
     |SI FSalida ! 0;
         |MENAV "0000No existe la situaci¢n";
         #802#1 = 0;   |PINTA #802#1;
         |ERROR;
     |FINSI;
     |CIERRA #1602;

     #802#2 = #1602#4;  |PINTA #802#2;

     |SI #802#1 ! 0;
         |SI #802#1 = #602#3;
             |MENAV "0000Ha introducido la misma situaci¢n en la que estamos.";
             #802#1 = 0;   |PINTA #802#1;
             |ERROR;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #flowm002@;
|FPRC;

|PROCESO flowm004U;
     nUsuarios = nUsuarios + 1;
|FPRC;

|DEFBUCLE flowm004U;
     #604#1;
     ;
     #602#0, #602#1, #602#2, #802#1, "          ";
     #602#0, #602#1, #602#2, #802#1, "zzzzzzzzzz";
     be;
     NULL, flowm004U;
|FIN;

|PROCESO Tipo7C0Fw2; |TIPO 7;
     |SI nSwModo = 2;
          |HAZ Tipo7C3Fw2;
     |FINSI;
|FPRC;

|PROCESO Tipo7C3Fw2;  |TIPO 7;
     nUsuarios = 0;
     |BUCLE flowm004U;
     |C_M #802#3, 1, "S";
     |SI nUsuarios [ 1;
         |C_M #802#3, 1, "N";  #802#3 = "N";
     |FINSI;
     |PINTA #802#3;
|FPRC;

|PROCESO BotonAlta603;
     #603#0 = #602#0;
     #603#1 = #602#1;
     #603#2 = #602#2;
     #603#3 = #602#3;
     #603#4 = 999;
     |LEE 000#603];
     |SI FSalida = 0;
         |LEE 000#603a;
     |SINO;
         |LEE 000#603u;
     |FINSI;

     nRespuesta = 1;
     |SI FSalida = 0;  |Y #603#0 = #602#0; |Y #603#1 = #602#1;
                       |Y #603#2 = #602#2; |Y #603#3 = #602#3;
         nRespuesta = #603#4 + 1;
     |FINSI;

     |DDEFECTO #603;
     #603#0 = #602#0;
     #603#1 = #602#1;
     #603#2 = #602#2;
     #603#3 = #602#3;
     #603#4 = nRespuesta;
     |GRABA 020#603b;

     nSwModo = 1;
     |VENTANA 0501, 1299, -1, 16, "Respuesta";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DDEFECTO #802;
     #802#0 = #603#5;
     #802#1 = #603#6;
     #802#2 = #603#7;
     #802#3 = #603#8;
     #802#4 = #603#9;

     |PINPA #0#802;
     |PINDA #0#802;
     |ENDATOS #1#802;
     |SI FSalida = 0;
         #603#5 = #802#0;
         #603#6 = #802#1;
         #603#7 = #802#2;
         #603#8 = #802#3;
         #603#9 = #802#4;
         |GRABA 020#603a;
     |SINO;
         |BORRA 020#603a;
     |FINSI;

     |LIBERA #603;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |REFRESCACONTROL nGrid603;
|FPRC;

|PROCESO BotonBaja603;
     |LEE 101#603=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #603#0 ! #602#0; |O #603#1 ! #602#1; |O #603#2 ! #602#2; |O #603#3 ! #602#3;
          |ACABA;
     |FINSI;

     |CONFI "0000NSeguro que quiere dar de baja la respuesta.";
     |SI FSalida ! 0;  |LIBERA #603;  |ACABA;  |FINSI;

     |BORRA 020#603a;
     |LIBERA #603;

     |REFRESCACONTROL nGrid603;
|FPRC;

|PROCESO BotonDatos603;
     |LEE 000#603=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #603#0 ! #602#0; |O #603#1 ! #602#1; |O #603#2 ! #602#2; |O #603#3 ! #602#3;
          |ACABA;
     |FINSI;

     |VENTANA 0701, 2499, -1, 16, "Campos Obligados por Situaci¢n";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |ABRE #dsarm004;
     |DDEFECTO #dsarm004;
     #dsarm004#0 = #603#0;
     #dsarm004#1 = #603#1;
     #dsarm004#2 = #603#2;
     |LEE 000#dsarm004.=;

     |ABRE #flowm008;
     |DDEFECTO #flowm008;
     #flowm008#0 = #603#0;
     #flowm008#1 = #603#1;
     #flowm008#2 = #603#2;
     #flowm008#3 = #603#6;
     |LEE 000#flowm008.=;

     #805#0 = #603#0;
     #805#1 = #603#1;
     #805#2 = #603#2;
     #805#3 = #603#6;
     |PARA nCampo = 4; |SI nCampo [ 48; |HACIENDO nCampo = nCampo + 1;
          #805#nCampo# = #flowm008#nCampo#;
     |SIGUE;

     |HAZ ControlLiterales;

     |PINPA #0#805;
     |PINDA #0#805;
     |ENDATOS #1#805;
     |SI FSalida = 0;
          |DDEFECTO #flowm008;
          #flowm008#0 = #805#0;
          #flowm008#1 = #805#1;
          #flowm008#2 = #805#2;
          #flowm008#3 = #805#3;
          |LEE 101#flowm008.=;
          |SI FSalida ! 0; |GRABA 020#flowm008.b; |FINSI;
          |PARA nCampo = 4; |SI nCampo [ 48; |HACIENDO nCampo = nCampo + 1;
               #flowm008#nCampo# = #805#nCampo#;
          |SIGUE;

          |GRABA 020#flowm008.a;
          |LIBERA #flowm008;
     |FINSI;

     |CIERRA #flowm008;
     |CIERRA #dsarm004;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;
|FPRC;

|PROCESO ControlLiterales;
     ||Alfa1
     aLiteral = #dsarm004#5;
     |QBF aLiteral;
     #805#4 = aLiteral;
     |SI aLiteral ! "";
          |C_M #805#24, 1, "S";
     |SINO;
          #805#24 = "N";
          |C_M #805#24, 1, "N";
     |FINSI;

     ||Alfa2
     aLiteral = #dsarm004#6;
     |QBF aLiteral;
     #805#5 = aLiteral;
     |SI aLiteral ! "";
          |C_M #805#25, 1, "S";
     |SINO;
          #805#25 = "N";
          |C_M #805#25, 1, "N";
     |FINSI;

     ||Alfa3
     aLiteral = #dsarm004#7;
     |QBF aLiteral;
     #805#6 = aLiteral;
     |SI aLiteral ! "";
          |C_M #805#26, 1, "S";
     |SINO;
          #805#26 = "N";
          |C_M #805#26, 1, "N";
     |FINSI;

     ||Alfa4
     aLiteral = #dsarm004#8;
     |QBF aLiteral;
     #805#7 = aLiteral;
     |SI aLiteral ! "";
          |C_M #805#27, 1, "S";
     |SINO;
          #805#27 = "N";
          |C_M #805#27, 1, "N";
     |FINSI;

     ||Alfa5
     aLiteral = #dsarm004#9;
     |QBF aLiteral;
     #805#8 = aLiteral;
     |SI aLiteral ! "";
          |C_M #805#28, 1, "S";
     |SINO;
          #805#28 = "N";
          |C_M #805#28, 1, "N";
     |FINSI;

     ||Alfa6
     aLiteral = #dsarm004#27;
     |QBF aLiteral;
     #805#9 = aLiteral;
     |SI aLiteral ! "";
          |C_M #805#29, 1, "S";
     |SINO;
          #805#29 = "N";
          |C_M #805#29, 1, "N";
     |FINSI;

     ||Alfa7
     aLiteral = #dsarm004#28;
     |QBF aLiteral;
     #805#10 = aLiteral;
     |SI aLiteral ! "";
          |C_M #805#30, 1, "S";
     |SINO;
          #805#30 = "N";
          |C_M #805#30, 1, "N";
     |FINSI;

     ||Alfa8
     aLiteral = #dsarm004#29;
     |QBF aLiteral;
     #805#11 = aLiteral;
     |SI aLiteral ! "";
          |C_M #805#31, 1, "S";
     |SINO;
          #805#31 = "N";
          |C_M #805#31, 1, "N";
     |FINSI;

     ||Alfa9
     aLiteral = #dsarm004#30;
     |QBF aLiteral;
     #805#12 = aLiteral;
     |SI aLiteral ! "";
          |C_M #805#32, 1, "S";
     |SINO;
          #805#32 = "N";
          |C_M #805#32, 1, "N";
     |FINSI;

     ||Alfa10
     aLiteral = #dsarm004#31;
     |QBF aLiteral;
     #805#13 = aLiteral;
     |SI aLiteral ! "";
          |C_M #805#33, 1, "S";
     |SINO;
          #805#33 = "N";
          |C_M #805#33, 1, "N";
     |FINSI;

     ||Nume1
     aLiteral = #dsarm004#10;
     |QBF aLiteral;
     #805#14 = aLiteral;
     |SI aLiteral ! "";
          |C_M #805#34, 1, "S";
     |SINO;
          #805#34 = "N";
          |C_M #805#34, 1, "N";
     |FINSI;

     ||Nume2
     aLiteral = #dsarm004#11;
     |QBF aLiteral;
     #805#15 = aLiteral;
     |SI aLiteral ! "";
          |C_M #805#35, 1, "S";
     |SINO;
          #805#35 = "N";
          |C_M #805#35, 1, "N";
     |FINSI;

     ||Nume3
     aLiteral = #dsarm004#12;
     |QBF aLiteral;
     #805#16 = aLiteral;
     |SI aLiteral ! "";
          |C_M #805#36, 1, "S";
     |SINO;
          #805#36 = "N";
          |C_M #805#36, 1, "N";
     |FINSI;

     ||Nume4
     aLiteral = #dsarm004#13;
     |QBF aLiteral;
     #805#17 = aLiteral;
     |SI aLiteral ! "";
          |C_M #805#37, 1, "S";
     |SINO;
          #805#37 = "N";
          |C_M #805#37, 1, "N";
     |FINSI;

     ||Nume5
     aLiteral = #dsarm004#14;
     |QBF aLiteral;
     #805#18 = aLiteral;
     |SI aLiteral ! "";
          |C_M #805#38, 1, "S";
     |SINO;
          #805#38 = "N";
          |C_M #805#38, 1, "N";
     |FINSI;

     ||Fecha1
     aLiteral = #dsarm004#15;
     |QBF aLiteral;
     #805#19 = aLiteral;
     |SI aLiteral ! "";
          |C_M #805#39, 1, "S";
          |C_M #805#44, 1, "S";
     |SINO;
          #805#39 = "N";
          |C_M #805#39, 1, "N";
          #805#44 = "N";
          |C_M #805#44, 1, "N";
     |FINSI;

     ||Fecha2
     aLiteral = #dsarm004#16;
     |QBF aLiteral;
     #805#20 = aLiteral;
     |SI aLiteral ! "";
          |C_M #805#40, 1, "S";
          |C_M #805#45, 1, "S";
     |SINO;
          #805#40 = "N";
          |C_M #805#40, 1, "N";
          #805#45 = "N";
          |C_M #805#45, 1, "N";
     |FINSI;

     ||Fecha3
     aLiteral = #dsarm004#17;
     |QBF aLiteral;
     #805#21 = aLiteral;
     |SI aLiteral ! "";
          |C_M #805#41, 1, "S";
          |C_M #805#46, 1, "S";
     |SINO;
          #805#41 = "N";
          |C_M #805#41, 1, "N";
          #805#46 = "N";
          |C_M #805#46, 1, "N";
     |FINSI;

     ||Fecha4
     aLiteral = #dsarm004#18;
     |QBF aLiteral;
     #805#22 = aLiteral;
     |SI aLiteral ! "";
          |C_M #805#42, 1, "S";
          |C_M #805#47, 1, "S";
     |SINO;
          #805#42 = "N";
          |C_M #805#42, 1, "N";
          #805#47 = "N";
          |C_M #805#47, 1, "N";
     |FINSI;

     ||Fecha5
     aLiteral = #dsarm004#19;
     |QBF aLiteral;
     #805#23 = aLiteral;
     |SI aLiteral ! "";
          |C_M #805#43, 1, "S";
          |C_M #805#48, 1, "S";
     |SINO;
          #805#43 = "N";
          |C_M #805#43, 1, "N";
          #805#48 = "N";
          |C_M #805#48, 1, "N";
     |FINSI;
|FPRC;

|PROCESO Procedimientos;
     |LEE 101#602=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aAlfa = "Procedimientos - " + (("000" + #602#0) % -103);
     aAlfa = aAlfa + " / " + (("000" + #602#1) % -103);
     aAlfa = aAlfa + " / " + (("000" + #602#2) % -103);
     aAlfa = aAlfa + " " + #601#3;  |QBF aAlfa;
     aAlfa = aAlfa + " Situaci¢n " + (("000" + #602#3) % -103);
     aAlfa = aAlfa + ": " + #602#4;  |QBF aAlfa;

     |DESTRUYECONTROL nGrid604;

     |VENTANA 0501, 2999, -1, 16, aAlfa;
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PINPA #0#801;  nPanta801 = FSalida;
     |PINDA #0#801;

     nRango = 4 + 8 + 16 + 32;

     |LINEAL_SIMPLE #1#604, nRango, 1172, 1698, Baja604, Alta604, Evento604;
     nGrid604 = FSalida;

     |LINEAL_SIMPLE #1#603, nRango, 2326, 2898, Baja603, Alta603, Evento603;
     nGrid603 = FSalida;

     |CONTROL_SIMPLE nPanta801, "BOTON,{{193}}Alta ", 1776, 1786, BotonAlta604;
     nSubBoton1 = FSalida;

     |CONTROL_SIMPLE nPanta801, "BOTON,{{199}}Baja ", 1788, 1798, BotonBaja604;
     nSubBoton2 = FSalida;

     |CONTROL_SIMPLE nPanta801, "BOTON,{{193}}Alta ", 2976, 2986, BotonAlta603;
     nSubBoton3 = FSalida;

     |CONTROL_SIMPLE nPanta801, "BOTON,{{199}}Baja ", 2988, 2998, BotonBaja603;
     nSubBoton4 = FSalida;

     |CONTROL_SIMPLE nPanta801, "BOTON,{{197}}Datos ", 2964, 2974, BotonDatos603;
     nSubBoton5 = FSalida;

     |DDEFECTO #801;
     |PARA nCampo = 0;  |SI nCampo [ 19;  |HACIENDO nCampo = nCampo + 1;
           #801nCampo = #602nCampo;
     |SIGUE;
     |PINDA #0#801;
     |ENDATOS #1#801;
     |SI FSalida = 0;
         |PARA nCampo = 0;  |SI nCampo [ 19;  |HACIENDO nCampo = nCampo + 1;
               #602nCampo = #801nCampo;
         |SIGUE;

         |GRABA 020#602a;
     |FINSI;

     |LIBERA #602;

     |DESTRUYECONTROL nGrid603;
     |DESTRUYECONTROL nGrid604;

     |FIN_CONTROL_WINDOWS nSubBoton1;
     |FIN_CONTROL_WINDOWS nSubBoton2;
     |FIN_CONTROL_WINDOWS nSubBoton3;
     |FIN_CONTROL_WINDOWS nSubBoton4;
     |FIN_CONTROL_WINDOWS nSubBoton5;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVent;

     |LINEAL_SIMPLE #1#604, nRango, 1675, 2498, Baja604, Alta604, NULL;
     nGrid604 = FSalida;

     |REFRESCACONTROL nGrid602;
|FPRC;

|PROCESO Alta;
     #602#0 = #601#0;
     #602#1 = #601#1;
     #602#2 = #601#2;
     #602#3 = 999;
     |LEE 000#602];
     |SI FSalida = 0;
         |LEE 000#602a;
     |SINO;
         |LEE 000#602u;
     |FINSI;

     nSituacion = 1;
     |SI FSalida = 0;  |Y #602#0 = #601#0; |Y  #602#1 = #601#1;
                       |Y #602#2 = #601#2;
         nSituacion = #602#3 + 1;
     |FINSI;

     |DDEFECTO #602;
     #602#0 = #601#0;
     #602#1 = #601#1;
     #602#2 = #601#2;
     #602#3 = nSituacion;
     |GRABA 020#602b;

     |VENTANA 1610, 2055, -1, 16, "Descripci¢n de la situaci¢n";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     E_inf = "";
     E_sup = "40";

     aAlfa   = #602#4;
     aAlfa   = 1812 ? 1;  |QBF aAlfa;
     #602#4  = aAlfa;

     |SI aAlfa ! "";
         |GRABA 020#602a;
     |SINO;
         |BORRA 020#602a;
     |FINSI;
     |LIBERA #602;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |REFRESCACONTROL nGrid602;
     |FOCOTECLADO nGrid602;
|FPRC;


|PROCESO Baja;
     |LEE 101#602=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |CONFI "0000NSeguro que quiere borrar la situaci¢n";
     |SI FSalida ! 0;  |LIBERA #602;  |ACABA;  |FINSI;

     |BUCLE flowm003B;
     |BUCLE flowm004B;
     |BUCLE flowm008B;

     |BORRA 020#602a;
     |LIBERA #602;

     |REFRESCACONTROL nGrid602;
     |FOCOTECLADO nGrid602;
|FPRC;

|PROCESO dsarm004;
     #601#0 = #4#0;
     #601#1 = #4#1;
     #601#2 = #4#2;
     |LEE 000#601=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     #2#0 = #4#0;
     |LEE 000#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

     #3#0 = #4#0;
     #3#1 = #4#1;
     |LEE 000#3=;
     |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;

     #902#0 = #4#0;
     |LEE 101#902=;
     |SI FSalida ! 0;
         #902#0 = #4#0;
         #902#1 = #2#1;
         |GRABA 020#902n;
     |FINSI;
     |LIBERA #902;

     #903#0 = #4#0;
     #903#1 = #4#1;
     |LEE 101#903=;
     |SI FSalida ! 0;
         #903#0 = #4#0;
         #903#1 = #4#1;
         #903#2 = #3#2;
         |GRABA 020#903n;
     |FINSI;
     |LIBERA #903;

     #904#0 = #4#0;
     #904#1 = #4#1;
     #904#2 = #4#2;
     |LEE 101#904=;
     |SI FSalida ! 0;
         #904#0 = #4#0;
         #904#1 = #4#1;
         #904#2 = #4#2;
         #904#3 = #4#3;
         |GRABA 020#904n;
     |FINSI;
     |LIBERA #904;
|FPRC;

|DEFBUCLE dsarm004;
     #4#1;
     ;
     000, nDSubGrupo, nDTipo;
     999, nHSubGrupo, nHTipo;
     ;
     NULL, dsarm004;
|FIN;

|PROCESO ReconstruyeGrids;
     aFichero = ("e2" + Usuario + "zzzzzzzz") % 108;  |NOME_DAT #902 aFichero;
     aFichero = ("e3" + Usuario + "zzzzzzzz") % 108;  |NOME_DAT #903 aFichero;
     aFichero = ("e4" + Usuario + "zzzzzzzz") % 108;  |NOME_DAT #904 aFichero;

     |ABRE #902;  |CIERRA #902;  |DELINDEX #902;
     |ABRE #903;  |CIERRA #903;  |DELINDEX #903;
     |ABRE #904;  |CIERRA #904;  |DELINDEX #904;

     |ABRE #2;
     |ABRE #3;

     |ABRE #902;
     |ABRE #903;
     |ABRE #904;

     |BUCLE dsarm004;

     |CIERRA #2;
     |CIERRA #3;

     #902#0 = nGrupo;
     |LEE 000#902];
     |SI FSalida ! 0;
         |LEE 000#902p;
         nSubGrupo = 1;
         nTipo     = 1;
     |FINSI;

     #903#0 = #902#0;
     #903#1 = nSubGrupo;
     |LEE 000#903];
     |SI FSalida ! 0;
         #903#0 = #902#0;
         #903#1 = 1;
         |LEE 000#903];
         nTipo     = 1;
     |FINSI;

     #904#0 = #903#0;
     #904#1 = #903#1;
     #904#2 = nTipo;
     |LEE 000#904];
     |SI FSalida ! 0;  |DDEFECTO #904;  |FINSI;
|FPRC;

|PROCESO Evento601T;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#601=;
     |FINSI;

     |SI FSalida = 4;
         |LEE 101#601=;
         |SI FSalida = 0;
             #602#0 = #601#0;
             #602#1 = #601#1;
             #602#2 = #601#2;
             #602#3 = 1;
             |LEE 000#602];
             |SI FSalida = 0;  |Y #602#0 = #601#0; |Y  #602#1 = #601#1;
                               |Y #602#2 = #601#2;
                 |MENAV "0000No se puede quitar la carpeta, ya est  configurada.";
                 |LIBERA #601;
                 |ACABA;
             |FINSI;

             |BORRA 020#601a;
             |LIBERA #601;

             |CIERRA  #902;
             |CIERRA  #903;
             |CIERRA  #904;

             nGrupo    = #601#0;
             nSubGrupo = #601#1;
             nTipo     = #601#2;

             |HAZ ReconstruyeGrids;

             #601#0 = nGrupo;
             #601#1 = nSubGrupo;
             #601#2 = nTipo;
             |LEE 000#601];
             |SI FSalida ! 0;
                 |LEE 000#601u;
             |FINSI;

             |REFRESCACONTROL nGrid902;
             |REFRESCACONTROL nGrid903;
             |REFRESCACONTROL nGrid904;
             |REFRESCACONTROL nGrid601;
             |FOCOTECLADO nGrid601;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO dpntw004;
     #601#0 = #904#0;
     #601#1 = #904#1;
     #601#2 = #904#2;
     #601#3 = #904#3;
     |GRABA 020#601n;
     |LIBERA #601;
|FPRC;

|DEFBUCLE dpntw004;
     #904#1;
     ;
     #902#0, nDesde, 000;
     #902#0, nHasta, 999;
     ;
     NULL, dpntw004;
|FIN;

|PROCESO Evento902;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#902=;
         |SI FSalida = 0;
             #903#0 = #902#0;
             #903#1 = 1;
             |LEE 000#903];

             |SI #1#8 = "S";
                  |REFRESCACONTROL nGrid903;
             |SINO;
                  |REFRESCACONTROL nGrid602;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI FSalida = 4;
         nDesde = 000;
         nHasta = 999;
         |BUCLE dpntw004;

         |CIERRA  #902;
         |CIERRA  #903;
         |CIERRA  #904;

         nGrupo    = 1;
         nSubGrupo = 1;
         nTipo     = 1;

         |HAZ ReconstruyeGrids;


         |SI #1#8 = "S";
              |REFRESCACONTROL nGrid902;
              |REFRESCACONTROL nGrid903;
              |REFRESCACONTROL nGrid904;
              |REFRESCACONTROL nGrid601;
         |SINO;
              |REFRESCACONTROL nGrid602;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Evento903;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#903=;
         |SI FSalida = 0;
             #904#0 = #903#0;
             #904#1 = #903#1;
             #904#2 = 1;
             |LEE 000#904];

             |REFRESCACONTROL nGrid904;
         |FINSI;
     |FINSI;

     |SI FSalida = 4;
         nDesde = #903#1;
         nHasta = #903#1;
         |BUCLE dpntw004;

         |CIERRA  #902;
         |CIERRA  #903;
         |CIERRA  #904;

         nGrupo    = #903#0;
         nSubGrupo = 1;
         nTipo     = 1;

         |HAZ ReconstruyeGrids;

         |REFRESCACONTROL nGrid902;
         |REFRESCACONTROL nGrid903;
         |REFRESCACONTROL nGrid904;
         |REFRESCACONTROL nGrid601;
     |FINSI;
|FPRC;

|PROCESO Evento904;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#904=;
     |FINSI;

     |SI FSalida = 4;
         #601#0 = #904#0;
         #601#1 = #904#1;
         #601#2 = #904#2;
         #601#3 = #904#3;
         |GRABA 020#601n;
         |LIBERA #601;

         |CIERRA  #902;
         |CIERRA  #903;
         |CIERRA  #904;

         nGrupo    = #904#0;
         nSubGrupo = #904#1;
         nTipo     = #904#2;

         |HAZ ReconstruyeGrids;

         |REFRESCACONTROL nGrid902;
         |REFRESCACONTROL nGrid903;
         |REFRESCACONTROL nGrid904;
         |REFRESCACONTROL nGrid601;
     |FINSI;
|FPRC;

|PROCESO Baja903;
     #903#0 = #902#0;
     #903#1 = nDSubGrupo;
|FPRC;

|PROCESO Alta903;
     #903#0 = #902#0;
     #903#1 = nHSubGrupo;
|FPRC;

|PROCESO Baja904;
     #904#0 = #903#0;
     #904#1 = #903#1;
     #904#2 = nDTipo;
|FPRC;

|PROCESO Alta904;
     #904#0 = #903#0;
     #904#1 = #903#1;
     #904#2 = nHTipo;
|FPRC;


|PROCESO Completo;
     nDSubGrupo  = 000;
     nHSubGrupo  = 999;
     nDTipo      = 000;
     nHTipo      = 999;

     |CONTROL_SIMPLE 0, "LABEL,{{15}}Carpetas asignadas", 0555, 0699, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{15}}Grupos", 0502, 0545, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{15}}Subgrupos", 1402, 1445, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{15}}Tipos", 2302, 2345, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{2}}Doble click en los registros para moverlos", 3302, 3380, NULL;

     |HAZ ReconstruyeGrids;

     nRango = 4 + 8 + 16 + 32;

     |LINEAL_SIMPLE #1#601, nRango, 0652, 3298, NULL, NULL, Evento601T;
     nGrid601 = FSalida;

     |LEE 000#902p;
     |LEE 000#903p;
     |LEE 000#904p;

     |LINEAL_SIMPLE #1#902, nRango, 0602, 1350, NULL, NULL, Evento902;
     nGrid902 = FSalida;

     |LINEAL_SIMPLE #1#903, nRango, 1502, 2250, Baja903, Alta903, Evento903;
     nGrid903 = FSalida;

     |LINEAL_SIMPLE #1#904, nRango, 2402, 3250, Baja904, Alta904, Evento904;
     nGrid904 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          |PULSATECLA;
          FSalida = "::{{001}}Salir," + nGrid902;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;
          |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |CIERRA #902;
     |CIERRA #903;
     |CIERRA #904;

     |DELINDEX #902;
     |DELINDEX #903;
     |DELINDEX #904;
|FPRC;

|PROCESO SoloGrupos;
     nDSubGrupo  = 001;
     nHSubGrupo  = 001;
     nDTipo      = 001;
     nHTipo      = 001;

     |CONTROL_SIMPLE 0, "LABEL,{{15}}Carpetas asignadas", 0555, 0699, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{15}}Grupos", 0502, 0545, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{2}}Doble click en los registros para moverlos", 3302, 3380, NULL;

     |HAZ ReconstruyeGrids;

     nRango = 4 + 8 + 16 + 32;

     |LINEAL_SIMPLE #1#601, nRango, 0652, 3298, NULL, NULL, Evento601T;
     nGrid602 = FSalida;

     |LEE 000#902p;

     |LINEAL_SIMPLE #1#902, nRango, 0602, 3250, NULL, NULL, Evento902;
     nGrid902 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          |PULSATECLA;
          FSalida = "::{{001}}Salir," + nGrid902;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;
          |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |CIERRA #902;
     |CIERRA #903;
     |CIERRA #904;

     |DELINDEX #902;
     |DELINDEX #903;
     |DELINDEX #904;
|FPRC;

|PROCESO Evento601;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#601=;
         |SI FSalida = 0;
             |ESTADO_CONTROL nBoton5, "ENABLE";
             |REFRESCACONTROL nGrid602;
             |REFRESCACONTROL nGrid604;

             |ESTADO_CONTROL nBoton2, "ENABLE";
             |ESTADO_CONTROL nBoton3, "DISABLE";
             |ESTADO_CONTROL nBoton4, "DISABLE";

             |SI nLabelCarpeta ! -1;
                 |FIN_CONTROL_WINDOWS nLabelCarpeta;
                 nLabelCarpeta = -1;
             |FINSI;

             aAlfa = "LABEL,{{15}}" + (("000" + #601#0) % -103);
             aAlfa = aAlfa + " / " + (("000" + #601#1) % -103);
             aAlfa = aAlfa + " / " + (("000" + #601#2) % -103);
             aAlfa = aAlfa + ": " +  #601#3;   |QBF aAlfa;
             |CONTROL_SIMPLE 0, aAlfa, 1502, 1570, NULL;
             nLabelCarpeta = FSalida;
         |SINO;
              |ESTADO_CONTROL nBoton5, "DISABLE";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Evento602;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#602=;
         |SI FSalida = 0;
             |REFRESCACONTROL nGrid604;

             |ESTADO_CONTROL nBoton3, "ENABLE";
             |ESTADO_CONTROL nBoton4, "ENABLE";

             |SI nLabelSitua ! -1;
                 |FIN_CONTROL_WINDOWS nLabelSitua;
                 nLabelSitua = -1;
             |FINSI;

             aAlfa = "LABEL,{{15}}" + (("000" + #602#3) % -103);
             aAlfa = aAlfa + " " +  #602#4;   |QBF aAlfa;
             |CONTROL_SIMPLE 0, aAlfa, 1575, 1599, NULL;
             nLabelSitua = FSalida;
         |FINSI;
     |FINSI;

     |SI FSalida = 4;
         |HAZ Procedimientos;
     |FINSI;
|FPRC;

|PROCESO AsignaCarpetas;
     |VENTANA 0501, 3399, -1, 16, "Asignaci¢n de carpetas";
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DESTRUYECONTROL nGrid601;

     |SI #1#8 = "S";
         |HAZ Completo;
     |SINO;
         |HAZ SoloGrupos;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVent;
     |PULSATECLA;

     |LINEAL_SIMPLE #1#601, nRango, 0502, 1298, NULL, NULL, Evento601;
     nGrid601 = FSalida;

     |PULSATECLA;
|FPRC;

|PROCESO CopiaWF;
     aMensaje = "0000Seleccione Destino copia estructura WorkFlow";
     |MENAV aMensaje;

     enGrupoTres = 0;
     enSubGTres = 0;
     enTipoTres = 0;
     aEjecuta = "dsarz003;DAMETRE";
     |SUB_EJECUTA_NP aEjecuta;
     |SI enGrupoTres ! 0;
          nGrupoOri = #601#0;
          nSubGOri = #601#1;
          nTipoOri = #601#2;

          #601#0 = enGrupoTres;
          #601#1 = enSubGTres;
          #601#2 = enTipoTres;
          |LEE 000#601.=;
          |SI FSalida = 0;
               aMensaje = "0000El WorkFlow destino YA existe. Proceso cancelado";
               |MENAV aMensaje;
               #601#0 = nGrupoOri;
               #601#1 = nSubGOri;
               #601#2 = nTipoOri;
               |LEE 000#601.=;
          |SINO;
               |HAZ CopiaWorkFlow;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO flowm002_copia;
     #flowm002#0 = enGrupoTres;
     #flowm002#1 = enSubGTres;
     #flowm002#2 = enTipoTres;
     |GRABA 020#flowm002.n;
     |LIBERA #flowm002;
|FPRC;

|DEFBUCLE flowm002_copia;
 #flowm002#1;
 ;
 nGrupoOri, nSubGOri, nTipoOri, 001;
 nGrupoOri, nSubGOri, nTipoOri, 999;
 ;
 NULL, flowm002_copia;
|FIN;

|PROCESO flowm003_copia;
     #flowm003#0 = enGrupoTres;
     #flowm003#1 = enSubGTres;
     #flowm003#2 = enTipoTres;
     |GRABA 020#flowm003.n;
     |LIBERA #flowm003;
|FPRC;

|DEFBUCLE flowm003_copia;
 #flowm003#1;
 ;
 nGrupoOri, nSubGOri, nTipoOri, 001, 001;
 nGrupoOri, nSubGOri, nTipoOri, 999, 999;
 ;
 NULL, flowm003_copia;
|FIN;

|PROCESO flowm004_copia;
     #flowm004#0 = enGrupoTres;
     #flowm004#1 = enSubGTres;
     #flowm004#2 = enTipoTres;
     |GRABA 020#flowm004.n;
     |LIBERA #flowm004;
|FPRC;

|DEFBUCLE flowm004_copia;
 #flowm004#1;
 ;
 nGrupoOri, nSubGOri, nTipoOri, 001, "          ";
 nGrupoOri, nSubGOri, nTipoOri, 999, "zzzzzzzzzz";
 ;
 NULL, flowm004_copia;
|FIN;

|PROCESO flowm008_copia;
     #flowm008#0 = enGrupoTres;
     #flowm008#1 = enSubGTres;
     #flowm008#2 = enTipoTres;
     |GRABA 020#flowm008.n;
     |LIBERA #flowm008;
|FPRC;

|DEFBUCLE flowm008_copia;
 #flowm008#1;
 ;
 nGrupoOri, nSubGOri, nTipoOri, 001;
 nGrupoOri, nSubGOri, nTipoOri, 999;
 ;
 NULL, flowm008_copia;
|FIN;


|PROCESO CopiaWorkFlow;
     #601#0 = nGrupoOri;
     #601#1 = nSubGOri;
     #601#2 = nTipoOri;
     |LEE 000#601.=;
     |SI FSalida = 0;
          #601#0 = enGrupoTres;
          #601#1 = enSubGTres;
          #601#2 = enTipoTres;
          |GRABA 020#601.n;
          |LIBERA #601;

          |BUCLE flowm002_copia;
          |BUCLE flowm003_copia;
          |BUCLE flowm004_copia;
          |BUCLE flowm008_copia;


          aMensaje = "0000WorkFlow Copiado correctamente";
          |MENAV aMensaje;
          #601#0 = enGrupoTres;
          #601#1 = enSubGTres;
          #601#2 = enTipoTres;
          |LEE 000#601.=;
          |REFRESCACONTROL nGrid601;
     |FINSI;
|FPRC;

|PROGRAMA;
     nDSubGrupo  = 000;
     nHSubGrupo  = 999;
     nDTipo      = 000;
     nHTipo      = 999;

     |ABRE #1;
     |LEE 000#1p;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |CLS;
     |CABEZA "Configuraci¢n WORKFLOW";

     |VENTANA 0501, 2799, -1, 16, "Configuraci¢n WORKFLOW - Definir situaciones";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |CONTROL_SIMPLE 0, "BOTON,{{193}}Copiar WorkFlow", 1302, 1320, CopiaWF;
     nBoton5    = FSalida;

     |ESTADO_CONTROL nBoton5, "DISABLE";

     |CONTROL_SIMPLE 0, "BOTON,{{193}}Asignar carpetas", 1380, 1398, AsignaCarpetas;
     nBoton1    = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{193}}Alta ", 2502, 2512, Alta;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{199}}Borrar", 2514, 2524, Baja;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Procedimientos", 2526, 2540, Procedimientos;
     nBoton4 = FSalida;

     |ESTADO_CONTROL nBoton2, "DISABLE";
     |ESTADO_CONTROL nBoton3, "DISABLE";
     |ESTADO_CONTROL nBoton4, "DISABLE";

     nRango = 4 + 8 + 16 + 32 + 128;

     |ABRET #601;
     |ABRET #602;
     |ABRET #603;
     |ABRET #604;

     |LINEAL_SIMPLE #1#602, nRango, 1602, 2470, Baja602, Alta602, Evento602;
     nGrid602 = FSalida;

     |LINEAL_SIMPLE #1#604, nRango, 1675, 2498, Baja604, Alta604, NULL;
     nGrid604 = FSalida;

     |LINEAL_SIMPLE #1#601, nRango, 0502, 1298, NULL, NULL, Evento601;
     nGrid601 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nGrid601;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |CIERRAT #601;
     |CIERRAT #602;
     |CIERRAT #603;
     |CIERRAT #604;

     |DESTRUYECONTROL nGrid601;
     |DESTRUYECONTROL nGrid602;
     |DESTRUYECONTROL nGrid604;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton5;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;
|FPRO;
