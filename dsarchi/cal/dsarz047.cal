|FICHEROS;
     dsarm005 #5;        ||Registro Documentos
     dsarm001;
|FIN;

|VARIABLES;
     aParametro = "";
     aMensaje = "";

     nDocumento = 0;

     aAuxNom = "";
     &eaDestino = "";
     &eaOrigen = "";
     aIPRemoto   = "";

     {-1}aVent        = "";
         aVent1       = 0;
         aVent2       = 0;
         aVent3       = 0;
         aVent4       = 0;
         aVent5       = "";

     nVentm5         = 0;
     &enDocumento    = 0;
     &enModoSilencio = 0;
     &eaBorraCache   = "";
|FIN;

|PROCESO ControlBorraCache;
     |ABRE #dsarm001;
     |LEE 000#dsarm001.p;
     |SI FSalida ! 0;  |DDEFECTO #dsarm001;  |FINSI;
     |CIERRA #dsarm001;

     |SI #dsarm001#181 = "S";
          |SI eaBorraCache ! "";
               |RFBORRA eaBorraCache;
               eaBorraCache = "";
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO VerDocumento;
     ||Pillar el codigo de la misma forma que se hace en el dsarm005

     enDocumento = nDocumento;
     enModoSilencio = 1;

     |VENTANA 0501, 2999, -1, 16, "Visualizar Documento";
     nVentm5 = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentm5;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |HAZ ControlBorraCache;
     |SUB_EJECUTA_NP "dsarw006;VERDOCUMENTO";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentm5;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentm5;
     enModoSilencio = 0;
|FPRC;


|PROGRAMA;
     aParametro = PARAMETRO;
     |QBF aParametro;

     |SI aParametro = "";
          aMensaje = "0000Parametro incorrecto [vacio]";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     nDocumento = aParametro;
     |SI nDocumento = 0;
          aMensaje = "0000Parametro incorrecto [" + aParametro + "]";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     |ABRE #dsarm005;
     |DDEFECTO #dsarm005;
     #dsarm005#0 = nDocumento;
     |LEE 000#dsarm005.=;
     |SI FSalida ! 0;
          aMensaje = "0000Error: no existe documento con N£mero: " + nDocumento;
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     |HAZ VerDocumento;

     |CIERRA #dsarm005;
|FPRO;
