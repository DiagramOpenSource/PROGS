|FICHEROS;
     dpnty001;

     dpntm001;

     :integral/dsam0000;

     :/laboral/def/labempre;
     :/laboral/def/nomw0003;
     :/laboral/def/nomcalca;
     :/laboral/def/nomhicca;

     dpntw010;
|FIN;

|VARIABLES;
     nNume               = 0;
     nHandle             = 0;
     nCab                = 0;
     nPausa              = 0;
     nMes                = 0;
     nAnyo               = 0;
     nAnyo2D             = 0;
     nMesG               = 0;
     nAnyG               = 0;
     nAgr                = 0;
     nEmp                = 0;
     nDiaPri             = 0;
     nDiaUlt             = 0;
     nDia                = 0;
     nAnte               = 0;
     nOk                 = 0;

     aAlfa               = "";
     aBase               = "";
     aPathDoc            = "";
     aPathLocal          = "";
     aPathLab            = "";
     aAbre               = "";
     aNomFic             = "";
     aEjecuta            = "";
     aFicTmp             = "";
     aDia                = "";
     aLee                = "";
     aDeDonde            = "";

     fFecha              = @;

     &eaAlfa             = "";
     &eaUnidad           = "";
     &eaOrigen           = "";
     &eaDestino          = "";
     &eaDoc              = "";
     &efFecha            = @;

     &enEAgr             = 0;
     &enEEmp             = 0;
     &enEAlt             = 0;

     &enEEmpX            = 0;
     &enEAltX            = 0;

     &enEEmpL            = 0;
     &enEAltL            = 0;

     &enEObj             = 0;
     &efEObj             = @;
     &enEDia             = 0;
     &enEMed             = 0;
     &enEPor             = 0;
     &eaECta             = "";
|FIN;

|PROCESO PresentaDocumento;
     |XABRE "E", aAbre, 0;
     |SI FSalida < 0;
         |MENAV "0000Selecci¢n vac¡a";
         |ACABA;
     |FINSI;

     |HAZ DimeUnidad;
     aPathLocal = eaUnidad + ":\DOCUMENTOS";              |RMKDIR aPathLocal;
     aPathLocal = eaUnidad + ":\DOCUMENTOS\DSARCHI";      |RMKDIR aPathLocal;
     aPathLocal = eaUnidad + ":\DOCUMENTOS\DSARCHI/";

     eaOrigen  = aBase + "dlls/dsabreextension.exe";
     eaDestino = aPathLocal + "dsabreextension.exe";
     |HAZ EnviaFicheroConMD5;

     |XABRE "EC", eaDestino, 0;
     |SI FSalida < 0;
         |ACABA;
     |FINSI;

     eaOrigen  = aPathDoc + aNomFic;
     eaDestino = aPathLocal + aNomFic;
     |HAZ EnviaFicheroConMD5;

     aEjecuta = "START " + aPathLocal + "dsabreextension ";
     aEjecuta = aEjecuta + eaDestino;
     aEjecuta = aEjecuta + " " + aPathLocal + "fin" + Usuario + ".txt";

     aAlfa    = aPathLocal + "fin" + Usuario + ".txt";
     |RFBORRA aAlfa;

     |RSYSTEM aEjecuta;
     aAlfa    = aPathLocal + "fin" + Usuario + ".txt";
     |PARA;  |SI;  |HACIENDO;
             |XABRE "EC", aAlfa, nHandle;
             |SI FSalida ] 0;
                 |SAL;
             |FINSI;

             |PARA nPausa = 1; |SI nPausa < 10000; |HACIENDO nPausa = nPausa + 1;
             |SIGUE;
             |PULSATECLA;
     |SIGUE;
     |PULSATECLA;

     aAlfa    = aPathLocal + "fin" + Usuario + ".txt";
     |RFBORRA aAlfa;

     aAlfa    = aPathLocal + aNomFic;
     |RFBORRA aAlfa;
|FPRC;

|PROCESO GrabaDato;
     |QBF eaAlfa;  |HAZ QuitaRaros;
     eaAlfa = eaAlfa + ";";
     |XGRABA nHandle, eaAlfa;
|FPRC;

|PROCESO nomw0003;
    |SI #nomw0003#36  = "..........";  |ACABA;  |FINSI;
    |SI #nomw0003#36  = "          ";  |ACABA;  |FINSI;

    fFecha = #nomw0003#36;
    aAlfa  = fFecha % 402;   nMes  = aAlfa;
    aAlfa  = fFecha % -104;  nAnyo = aAlfa;

    |SI nMes  ! #dpnty001#2;  |ACABA;  |FINSI;
    |SI nAnyo ! #dpnty001#4;  |ACABA;  |FINSI;

    #dpntw010#0  = #dpntm001#15;
    #dpntw010#1  = #dpntm001#0;
    #dpntw010#2  = #nomw0003#1;
    #dpntw010#3  = "ALTA";
    #dpntw010#4  = #dpntm001#16;
    #dpntw010#5  = #dpntm001#2;
    #dpntw010#6  = #dpntm001#10;
    #dpntw010#7  = #nomw0003#2;
    #dpntw010#8  = #nomw0003#7;
    #dpntw010#9  = #nomw0003#45;
    #dpntw010#10 = #nomw0003#36;
    #dpntw010#11 = 1;
    #dpntw010#12 = 0;

    |GRABA 000#dpntw010.n;
    |LIBERA #dpntw010;
|FPRC;

|DEFBUCLE nomw0003;
     #nomw0003#1;
     ;
     #dpntm001#0, 00001;
     #dpntm001#0, 99999;
     ;
     NULL, nomw0003;
|FIN;

|PROCESO nomcalca;
    #nomw0003#0 = #nomcalca#0;
    #nomw0003#1 = #nomcalca#1;
    |LEE 000#nomw0003.=;
    |SI FSalida ! 0;  |DDEFECTO #nomw0003;  |FINSI;

    #dpntw010#0  = #dpntm001#15;
    #dpntw010#1  = #dpntm001#0;
    #dpntw010#2  = #nomcalca#1;

    |SI #nomcalca#3 = 0;  #dpntw010#3  = "NOMINA MES";  |FINSI;
    |SI #nomcalca#3 = 1;  #dpntw010#3  = "NOMINA MES";  |FINSI;
    |SI #nomcalca#3 = 3;  #dpntw010#3  = "NOMINA MES";  |FINSI;
    |SI #nomcalca#3 = 4;  #dpntw010#3  = "NOMINA MES";  |FINSI;
    |SI #nomcalca#3 = 2;  #dpntw010#3  = "FINIQUITOS";  |FINSI;
    |SI #nomcalca#3 ] 5;  #dpntw010#3  = "ATRASOS";     |FINSI;

    #dpntw010#4  = #dpntm001#16;
    #dpntw010#5  = #dpntm001#2;
    #dpntw010#6  = #dpntm001#10;
    #dpntw010#7  = #nomw0003#2;
    #dpntw010#8  = #nomw0003#7;
    #dpntw010#9  = #nomw0003#45;
    #dpntw010#10 = #nomcalca#188;
    #dpntw010#11 = 0;
    #dpntw010#12 = 1;

    |GRABA 000#dpntw010.n;
    |LIBERA #dpntw010;
|FPRC;

|DEFBUCLE nomcalca;
     #nomcalca#1;
     184;
     #dpntm001#0, 00001, #dpnty001#2, 00, #dpnty001#4;
     #dpntm001#0, 99999, #dpnty001#2, 99, #dpnty001#4;
     ;
     NULL, nomcalca;
|FIN;

|PROCESO nomhicca;
    #nomw0003#0 = #nomhicca#0;
    #nomw0003#1 = #nomhicca#1;
    |LEE 000#nomw0003.=;
    |SI FSalida ! 0;  |DDEFECTO #nomw0003;  |FINSI;

    #dpntw010#0  = #dpntm001#15;
    #dpntw010#1  = #dpntm001#0;
    #dpntw010#2  = #nomhicca#1;

    |SI #nomhicca#3 = 0;  #dpntw010#3  = "NOMINA MES";  |FINSI;
    |SI #nomhicca#3 = 1;  #dpntw010#3  = "NOMINA MES";  |FINSI;
    |SI #nomhicca#3 = 3;  #dpntw010#3  = "NOMINA MES";  |FINSI;
    |SI #nomhicca#3 = 4;  #dpntw010#3  = "NOMINA MES";  |FINSI;
    |SI #nomhicca#3 = 2;  #dpntw010#3  = "FINIQUITOS";  |FINSI;
    |SI #nomhicca#3 ] 5;  #dpntw010#3  = "ATRASOS";     |FINSI;

    #dpntw010#4  = #dpntm001#16;
    #dpntw010#5  = #dpntm001#2;
    #dpntw010#6  = #dpntm001#10;
    #dpntw010#7  = #nomw0003#2;
    #dpntw010#8  = #nomw0003#7;
    #dpntw010#9  = #nomw0003#45;
    #dpntw010#10 = #nomhicca#230;
    #dpntw010#11 = 0;
    #dpntw010#12 = 1;

    |GRABA 000#dpntw010.n;
    |LIBERA #dpntw010;
|FPRC;

|DEFBUCLE nomhicca;
     #nomhicca#1;
     ;
     #dpntm001#0, 00001, nAnyo2D, #dpnty001#2, 00;
     #dpntm001#0, 99999, nAnyo2D, #dpnty001#2, 99;
     ;
     NULL, nomhicca;
|FIN;

|PROCESO dpntm001;
     #dsam0000#0 = #dpntm001#0;
     |LEE 000#dsam0000.=;
     |SI FSalida = 0;
         |SI #dsam0000#85 = "I";
             |ACABA;
         |FINSI;
     |FINSI;

     |BUCLE nomw0003;
     |BUCLE nomcalca;
     |BUCLE nomhicca;
|FPRC;

|DEFBUCLE dpntm001;
     #dpntm001#4;
     ;
     #dpnty001#0, 00001;
     #dpnty001#1, 99999;
     ;
     NULL, dpntm001;
|FIN;

|PROCESO dpntw010;
     |SI #dpnty001#5 = "1";
         |PRINT;
     |FINSI;

     |SI #dpnty001#5 = "2";
         |SI nCab = 0;
             eaAlfa = "C¢digo agrupador";       |HAZ GrabaDato;
             eaAlfa = "Descripci¢n agrupador";  |HAZ GrabaDato;
             eaAlfa = "C¢digo empresa";         |HAZ GrabaDato;
             eaAlfa = "Nombre empresa";         |HAZ GrabaDato;
             eaAlfa = "CIF empresa";            |HAZ GrabaDato;
             eaAlfa = "C¢digo trabajador";      |HAZ GrabaDato;
             eaAlfa = "Nombre trabajador";      |HAZ GrabaDato;
             eaAlfa = "DNI trabajador";         |HAZ GrabaDato;
             eaAlfa = "Contrato trabajador";    |HAZ GrabaDato;
             eaAlfa = "Tipo";                   |HAZ GrabaDato;
             eaAlfa = "Fecha alta trabajador";  |HAZ GrabaDato;

             eaAlfa = &13 + &10;
             |XGRABA nHandle, eaAlfa;

             nCab = 1;
         |FINSI;

         eaAlfa = ("00000" + #dpntw010#0) % -105;   |HAZ GrabaDato;
         eaAlfa = #dpntw010#4;                      |HAZ GrabaDato;
         eaAlfa = ("00000" + #dpntw010#1) % -105;   |HAZ GrabaDato;
         eaAlfa = #dpntw010#5;                      |HAZ GrabaDato;
         eaAlfa = #dpntw010#6;                      |HAZ GrabaDato;
         eaAlfa = ("00000" + #dpntw010#2) % -105;   |HAZ GrabaDato;
         eaAlfa = #dpntw010#7;                      |HAZ GrabaDato;
         eaAlfa = #dpntw010#8;                      |HAZ GrabaDato;
         eaAlfa = #dpntw010#9;                      |HAZ GrabaDato;
         eaAlfa = #dpntw010#3;                      |HAZ GrabaDato;
         eaAlfa = #dpntw010#10;                     |HAZ GrabaDato;

         eaAlfa = &13 + &10;
         |XGRABA nHandle, eaAlfa;
     |FINSI;
|FPRC;

|DEFBUCLE dpntw010;
     #dpntw010#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dpntw010;
|FIN;

|PROCESO PorCrystal;
     Impresora = "CrystalReport";
     |IMPRE -1;
     |SI FSalida ! 0;
         |MENAV "0000 No tiene instalada Impresora CrystalReport, pongase en contacto con su Administrador";
         |ACABA;
     |FINSI;

     |INFOR "dpnty001";
     |SI FSalida ! 0;
         |FINIMP;
         |ACABA;
     |FINSI;

     |BUCLE dpntw010;

     |PIEINF;
     |FININF;
     |FINIMP;
|FPRC;

|PROCESO PorCSV;
     |DBASE aBase;
     aPathDoc = aBase + "tmp";             |MKDIR aPathDoc;
     aPathDoc = aBase + "tmp/" + Usuario;  |MKDIR aPathDoc;
     aPathDoc = aBase + "tmp/" + Usuario + "/";

     aNomFic = "dpnty001" + Usuario + ".csv";
     aAbre   = aPathDoc + aNomFic;
     |XABRE "WB", aAbre, nHandle;

     |BUCLE dpntw010;

     |XCIERRA nHandle;

     |SI nCab = 0;
         |FBORRA aAbre;
     |FINSI;

     |HAZ PresentaDocumento;
|FPRC;

|PROCESO T12;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     |SI FSalida ! 1;
         |ERROR;
         |POSICIONATE #dpnty001#2;
         |ACABA;
     |FINSI;

     nAnyo2D = #dpnty001#4 - 2000;

     aFicTmp = "dpntw010" + Usuario;
     |NOME_DAT #dpntw010#aFicTmp#;
     |ABRE #dpntw010;  |CIERRA #dpntw010;  |DELINDEX #dpntw010;

     |ABRET #dpntw010;

     |ABRE #dsam0000;
     |BUCLE dpntm001;
     |CIERRA #dsam0000;

     |SI #dpnty001#5 = "1";  |HAZ PorCrystal;  |FINSI;
     |SI #dpnty001#5 = "2";  |HAZ PorCSV;      |FINSI;

     |CIERRAT #dpntw010;  |DELINDEX #dpntw010;
|FPRC;

|PROCESO T0C2;
     |SI #dpnty001#2 = 1;   #dpnty001#3 = "Enero     ";  |FINSI;
     |SI #dpnty001#2 = 2;   #dpnty001#3 = "Febrero   ";  |FINSI;
     |SI #dpnty001#2 = 3;   #dpnty001#3 = "Marzo     ";  |FINSI;
     |SI #dpnty001#2 = 4;   #dpnty001#3 = "Abril     ";  |FINSI;
     |SI #dpnty001#2 = 5;   #dpnty001#3 = "Mayo      ";  |FINSI;
     |SI #dpnty001#2 = 6;   #dpnty001#3 = "Junio     ";  |FINSI;
     |SI #dpnty001#2 = 7;   #dpnty001#3 = "Julio     ";  |FINSI;
     |SI #dpnty001#2 = 8;   #dpnty001#3 = "Agosto    ";  |FINSI;
     |SI #dpnty001#2 = 9;   #dpnty001#3 = "Septiembre";  |FINSI;
     |SI #dpnty001#2 = 10;  #dpnty001#3 = "Octubre   ";  |FINSI;
     |SI #dpnty001#2 = 11;  #dpnty001#3 = "Noviembre ";  |FINSI;
     |SI #dpnty001#2 = 12;  #dpnty001#3 = "Diciembre ";  |FINSI;

     |PINTA #dpnty001#3;
|FPRC;

|PROGRAMA;
     |SI PARAMETRO ! "";
         |ACABA;
     |FINSI;

     |PINPA #0#dpnty001;
     |PINDA #0#dpnty001;
     |ENDATOS #1#dpnty001;
|FPRO;

|PROCESO nomw0003Correo;
     |SI #nomw0003#44  ! "A";  |ACABA;  |FINSI;
     |SI #nomw0003#143 = "N";  |ACABA;  |FINSI;

     |DDEFECTO #dpntw010;

     #dpntw010#0  = 0;
     #dpntw010#4  = "";

     |SI aDeDonde = "LABORBOX";
         #dpntw010#0  = #dpntm001#15;
         #dpntw010#4  = #dpntm001#16;
     |FINSI;

     #dpntw010#1  = #labempre#0;
     #dpntw010#2  = #nomw0003#1;
     #dpntw010#3  = aDeDonde;
     #dpntw010#5  = #labempre#2;
     #dpntw010#6  = #labempre#10;
     #dpntw010#7  = #nomw0003#2;
     #dpntw010#8  = #nomw0003#7;
     #dpntw010#9  = #nomw0003#45;
     #dpntw010#10 = #nomw0003#36;
     #dpntw010#11 = 1;
     #dpntw010#12 = 0;

     |GRABA 000#dpntw010.n;
     |LIBERA #dpntw010;
|FPRC;

|DEFBUCLE nomw0003Correo;
     #nomw0003#1;
     ;
     #labempre#0, 00001;
     #labempre#0, 99999;
     ;
     NULL, nomw0003Correo;
|FIN;

|PROCESO labempreCorreo;
     aDeDonde = "LABORAL";

     #dsam0000#0 = #labempre#0;
     |LEE 000#dsam0000.=;
     |SI FSalida = 0;
         |SI #dsam0000#85 = "I";
             |ACABA;
         |FINSI;
     |FINSI;

     #dpntm001#0 = #labempre#0;
     |LEE 000#dpntm001.=;
     |SI FSalida = 0;
         |SI #dpntm001#15 = 99999;
             |ACABA;
         |FINSI;

         aDeDonde = "LABORBOX";
     |FINSI;

     |BUCLE nomw0003Correo;
|FPRC;

|DEFBUCLE labempreCorreo;
     #labempre#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, labempreCorreo;
|FIN;

|PROCESO dpntw010Correo;
     |SI nAgr ! #dpntw010#0;  |Y #dpntw010#0 ! 0;
         enEAgr = enEAgr + 1;
     |FINSI;

     |SI nEmp ! #dpntw010#1;
         |SI #dpntw010#3 = "LABORBOX            ";
             enEEmpX = enEEmpX + 1;
         |SINO;
             enEEmpL = enEEmpL + 1;
         |FINSI;

         enEEmp = enEEmp + 1;
     |FINSI;

     |SI #dpntw010#3 = "LABORBOX            ";
         enEAltX = enEAltX + 1;
     |SINO;
         enEAltL = enEAltL + 1;
     |FINSI;

     enEAlt = enEAlt + 1;

     |SI nCab = 0;
         eaAlfa = "C¢digo agrupador";       |HAZ GrabaDato;
         eaAlfa = "Descripci¢n agrupador";  |HAZ GrabaDato;
         eaAlfa = "C¢digo empresa";         |HAZ GrabaDato;
         eaAlfa = "Nombre empresa";         |HAZ GrabaDato;
         eaAlfa = "CIF empresa";            |HAZ GrabaDato;
         eaAlfa = "C¢digo trabajador";      |HAZ GrabaDato;
         eaAlfa = "Nombre trabajador";      |HAZ GrabaDato;
         eaAlfa = "DNI trabajador";         |HAZ GrabaDato;
         eaAlfa = "Contrato trabajador";    |HAZ GrabaDato;
         eaAlfa = "Fecha alta trabajador";  |HAZ GrabaDato;
         eaAlfa = "LABORBOX/LABORAL";       |HAZ GrabaDato;

         eaAlfa = &13 + &10;
         |XGRABA nHandle, eaAlfa;

         nCab = 1;
     |FINSI;

     eaAlfa = ("00000" + #dpntw010#0) % -105;   |HAZ GrabaDato;
     eaAlfa = #dpntw010#4;                      |HAZ GrabaDato;
     eaAlfa = ("00000" + #dpntw010#1) % -105;   |HAZ GrabaDato;
     eaAlfa = #dpntw010#5;                      |HAZ GrabaDato;
     eaAlfa = #dpntw010#6;                      |HAZ GrabaDato;
     eaAlfa = ("00000" + #dpntw010#2) % -105;   |HAZ GrabaDato;
     eaAlfa = #dpntw010#7;                      |HAZ GrabaDato;
     eaAlfa = #dpntw010#8;                      |HAZ GrabaDato;
     eaAlfa = #dpntw010#9;                      |HAZ GrabaDato;
     eaAlfa = #dpntw010#10;                     |HAZ GrabaDato;
     eaAlfa = #dpntw010#3;                      |HAZ GrabaDato;

     eaAlfa = &13 + &10;
     |XGRABA nHandle, eaAlfa;

     nAgr = #dpntw010#0;
     nEmp = #dpntw010#1;
|FPRC;

|DEFBUCLE dpntw010Correo;
     #dpntw010#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dpntw010Correo;
|FIN;

|PROCESO CuerpoCorreo;
     enEAlt  = 0;
     enEAgr  = 0;
     enEEmp  = 0;
     enEEmpX = 0;
     enEAltX = 0;
     enEEmpL = 0;
     enEAltL = 0;
     nAgr    = -1;
     nEmp    = -1;

     |DBASE aBase;
     aPathDoc = aBase + "tmp";             |MKDIR aPathDoc;
     aPathDoc = aBase + "tmp/" + Usuario;  |MKDIR aPathDoc;
     aPathDoc = aBase + "tmp/" + Usuario + "/";

     aNomFic = "dpnty001" + Usuario + ".csv";
     aAbre   = aPathDoc + aNomFic;
     |XABRE "WB", aAbre, nHandle;

     |CONSULTA_CLAVE #1#dpntw010;

     |BUCLE dpntw010Correo;

     |XCIERRA nHandle;

     aAbre   = aBase + "objetivo.txt";
     |XABRE "", aAbre, nHandle;
     |XLEE nHandle, 200, aLee;   enEObj = aLee;
     |XLEE nHandle, 200, aLee;   efEObj = aLee;
     |XLEE nHandle, 200, aLee;   eaECta = aLee;
     |XCIERRA nHandle;

     fFecha  = ~;
     nDiaPri = fFecha;
     nDiaUlt = efEObj;
     enEDia  = 0;

     |PARA nDia = nDiaPri;  |SI nDia [ nDiaUlt;  |HACIENDO nDia = nDia + 1;
           fFecha = nDia;

           fFecha = fFecha % 1;
           aDia   = (fFecha % 1109) > " ";  |QBF aDia;

           fFecha = nDia;

           nOk = 1;
           |SI aDia = "SABADO";        nOk = 0;  |FINSI;
           |SI aDia = "DOMINGO";       nOk = 0;  |FINSI;

           |SI fFecha = "01.11.2017";  nOk = 0;  |FINSI;
           |SI fFecha = "06.12.2017";  nOk = 0;  |FINSI;
           |SI fFecha = "08.12.2017";  nOk = 0;  |FINSI;
           |SI fFecha = "25.12.2017";  nOk = 0;  |FINSI;
           |SI fFecha = "01.01.2018";  nOk = 0;  |FINSI;

           |SI nOk = 1;
               enEDia = enEDia + 1;
           |FINSI;
     |SIGUE;

     enEMed = ((enEObj - enEAlt) / enEDia) ! 2;
     enEPor = ((enEAlt * 100) / enEObj) ! 2;
|FPRC;

|PROCESO EnviaDocumento;
     |ABRE #dsam0000;
     |BUCLE labempreCorreo;
     |CIERRA #dsam0000;

     |HAZ CuerpoCorreo;

     eaDoc   = aPathDoc + aNomFic;

     |XABRE "E", eaDoc, 0;
     |SI FSalida < 0;
         eaDoc = "";
     |FINSI;

     efFecha = #dpnty001#2;
     aAlfa   = "dsarw010;ENVIA_DPNTY001";
     |SUB_EJECUTA aAlfa;
|FPRC;

|PROCESO T80;  |TIPO 80;
     |SI PARAMETRO ! "";
         aFicTmp = "dpntw010" + Usuario;
         |NOME_DAT #dpntw010#aFicTmp#;
         |ABRE #dpntw010;  |CIERRA #dpntw010;  |DELINDEX #dpntw010;

         |ABRET #dpntm001;
         |ABRET #dpntw010;

         |HAZ EnviaDocumento;

         |CIERRAT #dpntm001;
         |CIERRAT #dpntw010;  |DELINDEX  #dpntw010;

         |ACABA;
     |FINSI;

     fFecha  = ~;
     aAlfa   = fFecha % 402;   #dpnty001#2 = aAlfa;
     aAlfa   = fFecha % -104;  #dpnty001#4 = aAlfa;

     |HAZ T0C2;

     aFicTmp = "dpntw010" + Usuario;
     |NOME_DAT #dpntw010#aFicTmp#;
     |ABRE #dpntw010;  |CIERRA #dpntw010;  |DELINDEX #dpntw010;

     |DBASS aPathLab;
     aPathLab = aPathLab + "laboral/fich/";
     |PATH_DAT #labempre#aPathLab#;
     |PATH_DAT #nomcalca#aPathLab#;
     |PATH_DAT #nomhicca#aPathLab#;

     |ABRET #nomw0003;

     FSalida = 2399;
|FPRC;

|PROCESO T90;  |TIPO 90;
     |SI #dpnty001#5 = "2";
         aAbre = aPathDoc + aNomFic;
         |FBORRA aAbre;
     |FINSI;

     |CIERRAT #dpntm001;
     |CIERRAT #nomw0003;

     |DELINDEX #dpntw010;
|FPRC;

|PROCESO Nomcalca_15;
|FPRC;

|PROCESO Nomcalca_16;
|FPRC;

|PROCESO Nomcalca_17;
|FPRC;
