|FICHEROS;
     dpntw007;

     dpntm005;
|FIN;

|VARIABLES;
     aAlfa      = "";
     aEMail     = "";

     &enEmpresa = 0;
|FIN;

|PROCESO Tipo12Fw7;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     |SI FSalida ! 1;
         |ERROR;
         |POSICIONATE #dpntw007#0;
     |FINSI;
|FPRC;

|PROCESO Tipo0C1Fw7;  |TIPO 0;
     |C_M #dpntw007#1, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |ABRE #dpntm005;
     #dpntm005#0 = enEmpresa;
     #dpntm005#1 = #dpntw007#1;
     |LEE 000#dpntm005.=;
     |SI FSalida ! 0;
         |CIERRA #dpntm005;
         |MENAV "0000No existe el supervisor";
     |FINSI;
     |CIERRA #dpntm005;

     #dpntw007#2 = #dpntm005#2;  |PINTA #dpntw007#2;
|FPRC;

|PROCESO Baja5;
     #dpntm005#0 = enEmpresa;
     #dpntm005#1 = 1;
|FPRC;

|PROCESO Alta5;
     #dpntm005#0 = enEmpresa;
     #dpntm005#1 = 999;
|FPRC;

|PROCESO Tipo66C1Fw7;  |TIPO 66;
     |ABRE #dpntm005;
     |CONSULTA_F_CLAVE #1#dpntm005, Baja5, Alta5;
     |SI FSalida = 0;
         #dpntw007#1 = #dpntm005#1;  |PINTA #dpntw007#1;
     |FINSI;
     |CIERRA #dpntm005;
|FPRC;

|PROCESO Tipo0C0Fw7;  |TIPO 0;
     aEMail = #dpntw007#0;  |QBF aEMail;
     |SI aEMail = "";
         |MENAV "0000Email incorrecto.";
         |ERROR;
         |ACABA;
     |FINSI;

     aEMail = #dpntw007#0 - "@";
     |SI FSalida = 0;
         |MENAV "0000Email incorrecto.";
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;
