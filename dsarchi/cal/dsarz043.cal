|VARIABLES;
     aMensaje = "";
     aAlfa = "";
     aAlfa1 = "";
     aBase = "";
     aParametro = "";
     nSwEsta = 0;
     nBufUsr = 0;
     nEleUsr = 0;
     nRegis = 0;
     nMayor = 0;
     nNumero = 0;
     aAbre = "";
     nHandle = 0;
|FIN;


|PROCESO BuscaSecuencial;
     aAlfa = aBase + "dev/usr/ds_sys.psw"
     |LEESECUENCIAL aAlfa, nBufUsr, nEleUsr, 0, 0;
     |PARA nRegis = 0; |SI nRegis < nEleUsr; |HACIENDO nRegis = nRegis + 1;
           |DEL_BUF nBufUsr, nRegis, aAlfa;

           aAlfa1 = aAlfa % 410;
           |QBF aAlfa1;
           |SI aAlfa1 = "batch";
                 nSwEsta = 1;
                 |SAL;
           |FINSI;

           aAlfa1 = aAlfa % 103;
           nNumero = aAlfa1;

           |SI nMayor < nNumero;
               nMayor = nNumero;
           |FINSI;
     |SIGUE;
     |FINDIM nBufUsr;
|FPRC;


|PROCESO MeteBatch;
     aAbre = aBase + "dev/usr/ds_sys.psw"
     |XABRE "A", aAbre, nHandle;

     aAlfa = ("000" + nMayor) % -103;
     aAlfa = aAlfa + "batch     HOHMIYHQIACMCMCMCMCMN";
     |XGRABA nHandle, aAlfa;

     |XCIERRA nHandle;
|FPRC;

|PROGRAMA;
     aParametro = PARAMETRO;
     |QBF aParametro;

     |SI aParametro = "";
          aMensaje = "0000Error: No se ha llamado al programa con los parámetros correctos";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     |DBASS aBase;
     |QBF aBase;

     nSwEsta = 0;
     nMayor = 0;
     |HAZ BuscaSecuencial;
     |SI nSwEsta = 0;
          nMayor = nMayor + 1;
          |HAZ MeteBatch;
     |FINSI;
|FPRO;
