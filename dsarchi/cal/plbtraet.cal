|FICHEROS;
     dsarw013 #913;
     dsarw019 #919;
|FIN;

|VARIABLES;
     nHandle          = 0;

     aAlfa            = "";
     aBase            = "";
     aOrigen          = "";
     aDestino         = "";
     aDirLocal        = "";
     aDocRemoto       = "";
     aDocServidor     = "";
     aIPRemoto        = "";
     aDirBaseLocal    = "";

     {1}aContiene     = "";

     &enError         = 0;
     &eaUnidad        = "";
     &eaConversorPDF  = "";

     &enSwDesde9 = 0;
     &eaAdjuntoPLB = "";
     &eaServidorSMTP = "";
     &eaUsuarioPLB = "";
     &eaPassPLB = "";
     &eaOrigenPLB = "";
     &eaDestinoPLB = "";
     &eaDirRespoPLB = "";
     &eaAsuntoPLB = "";
     &eaCuerpoPLB = "";
     &eaConfLecPLB = "";
     &enSwErrorCorreoPLB = 0;
     &eaBorraCache1 = "";
     &eaBorraCache2 = "";

     ||VARIABLES;
     aFrom = "";
     aReply  = "";
     aSalida = "";
     aDestinoCorreo = "";
     aAsunto  = "";
     aCuerpo = "";
     aAdjunto = "";
     aUsuAuntenti = "";
     aPassAuntenti = "";
     aConfLectura = "";
     aUsuario = "";
     aNomEnvia = "";
     aParaEnvio = "";
     aEjecuta = "";
     aRespuesta = "";
     nHandleE = 0;
     aError = "";
     nVent1 = 0;
     aMensaje = "";
     aFicheroTrae = "";
     &enSwNomina = 0;
     &eaAlfa = "";
     aBorra = "";
     aNombreTrae = "";
     aLong = "";
     nLong = 0;
     nConta = 0;
     nCampo = 0;
     aValor = "";
|FIN;

|PROCESO Traete_dsenviacorreo;
     enError = 0;

     |DBASE aBase;   |QBF aBase;

     aOrigen = aBase + "dlls/dsenviacorreo.exe";
     |XABRE "E", aOrigen, nHandle;
     |SI FSalida < 0;  enError = 1;  |ACABA;  |FINSI;

     |HAZ DimeUnidad;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS";              |RMKDIR aDirBaseLocal;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS\DSARCHI";      |RMKDIR aDirBaseLocal;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS\DSARCHI\";
     aDestino      = aDirBaseLocal + "dsenviacorreo.exe";

     aContiene1 = aDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = aOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Traete_dsselect;
     enError = 0;

     |DBASE aBase;   |QBF aBase;

     aOrigen = aBase + "dlls/dsselect.exe";
     |XABRE "E", aOrigen, nHandle;
     |SI FSalida < 0;  enError = 1;  |ACABA;  |FINSI;

     |HAZ DimeUnidad;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS";              |RMKDIR aDirBaseLocal;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS\DSARCHI";      |RMKDIR aDirBaseLocal;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS\DSARCHI\";
     aDestino      = aDirBaseLocal + "\dsselect.exe";

     aContiene1 = aDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = aOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Traete_libtiff;
     enError = 0;

     |DBASE aBase;   |QBF aBase;

     aOrigen = aBase + "dlls/libtiff.tgz";
     |XABRE "E", aOrigen, nHandle;
     |SI FSalida < 0;  enError = 1;  |ACABA;  |FINSI;

     |HAZ DimeUnidad;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS";              |RMKDIR aDirBaseLocal;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS\DSARCHI";      |RMKDIR aDirBaseLocal;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS\DSARCHI\";

     eaConversorPDF = aDirBaseLocal + "tiff2pdf.exe";
     aAlfa          = aDirBaseLocal + "tiff2pdf.exe";
     |XABRE "EC", aAlfa, nHandle;
     |SI FSalida < 0;
         aAlfa = aDirBaseLocal + "libtiff.tgz";  |RFBORRA aAlfa;
     |FINSI;

     aDestino = aDirBaseLocal + "libtiff.tgz";

     aContiene1 = aDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto  = FSalida;  |QBF aDocRemoto;

     aContiene1 = aOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;

         |RDESCOMPRIME aDestino;
         |RDETAR aDestino, aDirBaseLocal;

         aAlfa = aDirBaseLocal + "libtiff.tar";  |RFBORRA aAlfa;
     |FINSI;

     aAlfa = aDirBaseLocal + "tiff2pdf.exe";
     |XABRE "EC", aAlfa, nHandle;
     |SI FSalida < 0;
         |MENAV "0000 No puedo instalar el conversor de TIFF a PDF.";
         enError = 1;
     |FINSI;
|FPRC;

|PROCESO Traete_dstesseract;
     enError = 0;

     |DBASE aBase;   |QBF aBase;

     |HAZ DimeUnidad;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS";              |RMKDIR aDirBaseLocal;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS\DSARCHI";      |RMKDIR aDirBaseLocal;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS\DSARCHI\";

     aAlfa = aDirBaseLocal + "dstesseract/dstesseract.exe";
     |XABRE "EC", aAlfa, nHandle;
     |SI FSalida < 0;
         aAlfa = aDirBaseLocal + "dstesseract.tgz";  |RFBORRA aAlfa;
     |FINSI;

     aOrigen = aBase + "dlls/dstesseract.tgz";
     |XABRE "E", aOrigen, nHandle;
     |SI FSalida < 0;  enError = 1;  |ACABA;  |FINSI;

     aDestino = aDirBaseLocal + "dstesseract.tgz";

     aContiene1 = aDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = aOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;

         |RDESCOMPRIME aDestino;
         |RDETAR aDestino, aDirBaseLocal;

         aAlfa = aDirBaseLocal + "dstesseract.tar";  |RFBORRA aAlfa;
     |FINSI;

     aAlfa = aDirBaseLocal + "dstesseract/dstesseract.exe";
     |XABRE "EC", aAlfa, nHandle;
     |SI FSalida < 0;
         |MENAV "0000 No puedo instalar el OCR.";
         enError = 1;
     |FINSI;
|FPRC;

|PROCESO Traete_dsescan_cli;
     enError = 0;

     |DBASE aBase;   |QBF aBase;

     |HAZ DimeUnidad;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS";              |RMKDIR aDirBaseLocal;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS\DSARCHI";      |RMKDIR aDirBaseLocal;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS\DSARCHI\";
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS\DSARCHI\bin\"; |RMKDIR aDirBaseLocal;

     aAlfa = aDirBaseLocal + "dsescan_cli.exe";
     |XABRE "EC", aAlfa, nHandle;
     |SI FSalida < 0;
         aAlfa = aDirBaseLocal + "dsescan_cli.tgz";  |RFBORRA aAlfa;
     |FINSI;

     aOrigen = aBase + "dlls/dsescan_cli.tgz";
     |XABRE "E", aOrigen, nHandle;
     |SI FSalida < 0;  enError = 1;  |ACABA;  |FINSI;

     aDestino = aDirBaseLocal + "dsescan_cli.tgz";

     aContiene1 = aDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = aOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;

         |RDESCOMPRIME aDestino;
         |RDETAR aDestino, aDirBaseLocal;

         aAlfa = aDirBaseLocal + "dsescan_cli.tar";  |RFBORRA aAlfa;
     |FINSI;

     aAlfa = aDirBaseLocal + "dsescan_cli.exe";
     |XABRE "EC", aAlfa, nHandle;
     |SI FSalida < 0;
         |MENAV "0000 No puedo instalar el OCR (dsescan_cli).";
         enError = 1;
     |FINSI;
|FPRC;

|PROCESO Traete_pdftotext;
     enError = 0;

     |DBASE aBase;   |QBF aBase;

     |HAZ DimeUnidad;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS";              |RMKDIR aDirBaseLocal;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS\DSARCHI";      |RMKDIR aDirBaseLocal;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS\DSARCHI\";

     aAlfa = aDirBaseLocal + "pdftotext/pdftotext.exe";
     |XABRE "EC", aAlfa, nHandle;
     |SI FSalida < 0;
         aAlfa = aDirBaseLocal + "pdftotext.tgz";  |RFBORRA aAlfa;
     |FINSI;

     aOrigen = aBase + "dlls/pdftotext.tgz";
     |XABRE "E", aOrigen, nHandle;
     |SI FSalida < 0;  enError = 1;  |ACABA;  |FINSI;

     aDestino = aDirBaseLocal + "pdftotext.tgz";

     aContiene1 = aDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = aOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;

         |RDESCOMPRIME aDestino;
         |RDETAR aDestino, aDirBaseLocal;

         aAlfa = aDirBaseLocal + "pdftotext.tar";  |RFBORRA aAlfa;
     |FINSI;

     aAlfa = aDirBaseLocal + "pdftotext/pdftotext.exe";
     |XABRE "EC", aAlfa, nHandle;
     |SI FSalida < 0;
         |MENAV "0000 No puedo instalar el conversor de pdf a texto";
         enError = 1;
     |FINSI;
|FPRC;

|PROCESO Traete_dsofficetxt;
     enError = 0;

     |DBASE aBase;   |QBF aBase;

     |HAZ DimeUnidad;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS";              |RMKDIR aDirBaseLocal;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS\DSARCHI";      |RMKDIR aDirBaseLocal;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS\DSARCHI\";

     aAlfa = aDirBaseLocal + "dsofficetxt/dsofficetxt.exe";
     |XABRE "EC", aAlfa, nHandle;
     |SI FSalida < 0;
         aAlfa = aDirBaseLocal + "dsofficetxt.tgz";  |RFBORRA aAlfa;
     |FINSI;

     aOrigen = aBase + "dlls/dsofficetxt.tgz";
     |XABRE "E", aOrigen, nHandle;
     |SI FSalida < 0;  enError = 1;  |ACABA;  |FINSI;

     aDestino = aDirBaseLocal + "dsofficetxt.tgz";

     aContiene1 = aDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = aOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;

         |RDESCOMPRIME aDestino;
         |RDETAR aDestino, aDirBaseLocal;

         aAlfa = aDirBaseLocal + "dsofficetxt.tar";  |RFBORRA aAlfa;
     |FINSI;

     aAlfa = aDirBaseLocal + "dsofficetxt/dsofficetxt.exe";
     |XABRE "EC", aAlfa, nHandle;
     |SI FSalida < 0;
         |MENAV "0000 No puedo instalar el conversor de Word/Excel (dsofficetxt)";
         enError = 1;
     |FINSI;
|FPRC;

|PROCESO Traete_imagemagick;
     enError = 0;

     |DBASE aBase;   |QBF aBase;

     |HAZ DimeUnidad;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS";              |RMKDIR aDirBaseLocal;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS\DSARCHI";      |RMKDIR aDirBaseLocal;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS\DSARCHI\";

     aAlfa = aDirBaseLocal + "imagemagick/convert.exe";
     |XABRE "EC", aAlfa, nHandle;
     |SI FSalida < 0;
         aAlfa = aDirBaseLocal + "imagemagick.tgz";  |RFBORRA aAlfa;
     |FINSI;

     aOrigen = aBase + "dlls/imagemagick.tgz";
     |XABRE "E", aOrigen, nHandle;
     |SI FSalida < 0;  enError = 1;  |ACABA;  |FINSI;

     aDestino = aDirBaseLocal + "imagemagick.tgz";

     aContiene1 = aDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = aOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;

         |RDESCOMPRIME aDestino;
         |RDETAR aDestino, aDirBaseLocal;

         aAlfa = aDirBaseLocal + "imagemagick.tar";  |RFBORRA aAlfa;
     |FINSI;

     aAlfa = aDirBaseLocal + "imagemagick/convert.exe";
     |XABRE "EC", aAlfa, nHandle;
     |SI FSalida < 0;
         |MENAV "0000 No puedo instalar imagemagick. (conversor JPEG/PDF/TIFF)";
         enError = 1;
     |FINSI;
|FPRC;

|PROCESO SacaNombrePLB;
     aNombreTrae = "";
     aLong = aFicheroTrae % A0;
     nLong = aLong;
     |PARA nConta = nLong; |SI nConta ] 1; |HACIENDO nConta = nConta - 1;
          nCampo = (100 * nConta) + 1;
          aValor = aFicheroTrae % nCampo;
          |SI aValor ! "/"; |Y aValor ! "\";
               aNombreTrae = aValor + aNombreTrae;
          |SINO;
               |SAL;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO TraeFicheroPLB;
     aOrigen = aFicheroTrae;
     |HAZ SacaNombrePLB;
     aDestino = aDirBaseLocal + aNombreTrae;

     aBorra = aDestino;
     |RFBORRA aBorra;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
          |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
          |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     |XABRE "CE", aDestino, nHandleE;
     |SI FSalida ] 0;
          aFicheroTrae = aDestino;
     |FINSI;
|FPRC;

|PROCESO MeteParaEnvioPLB;
     |XABRE "CWB", aParaEnvio, nHandle;
     |SI FSalida < 0;
          aMensaje = "0000Problemas al crear " + aParaEnvio;
          |MENAV aMensaje;
     |SINO;
          ||1
          |QBF aSalida;
          aAlfa = aSalida + &13 + &10;
          |XGRABA nHandle, aAlfa;

          |QBF aUsuAuntenti;
          aAlfa = aUsuAuntenti + &13 + &10;
          |XGRABA nHandle, aAlfa;

          ||3
          |QBF aPassAuntenti;
          aAlfa = aPassAuntenti + &13 + &10;
          |XGRABA nHandle, aAlfa;

          |QBF aFrom;
          aAlfa = aFrom + &13 + &10;
          |XGRABA nHandle, aAlfa;

          ||5
          |QBF aDestinoCorreo;
          aAlfa = aDestinoCorreo + &13 + &10;
          |XGRABA nHandle, aAlfa;

          |QBF aReply;
          aAlfa = aReply + &13 + &10;
          |XGRABA nHandle, aAlfa;

          ||7
          |QBF aAsunto;
          aAlfa = aAsunto + &13 + &10;
          |XGRABA nHandle, aAlfa;

          |QBF aCuerpo;
          aFicheroTrae = aCuerpo;
          |SI aCuerpo ! "";
              |HAZ TraeFicheroPLB;
          |FINSI;
          aCuerpo = aFicheroTrae;
          aAlfa = aCuerpo + &13 + &10;
          |XGRABA nHandle, aAlfa;
          eaBorraCache2 = aFicheroTrae;

          ||9
          |QBF aConfLectura;
          aAlfa = aConfLectura + &13 + &10;
          |XGRABA nHandle, aAlfa;

          aAlfa = "" + &13 + &10;
          |XGRABA nHandle, aAlfa;

          ||11
          aAlfa = "" + &13 + &10;
          |XGRABA nHandle, aAlfa;

          aAlfa = "" + &13 + &10;
          |XGRABA nHandle, aAlfa;

          ||13
          aAlfa = "" + &13 + &10;
          |XGRABA nHandle, aAlfa;

          aAlfa = "" + &13 + &10;
          |XGRABA nHandle, aAlfa;

          ||15
          |QBF aAdjunto;
          aFicheroTrae = aAdjunto;
          |HAZ TraeFicheroPLB;
          aAdjunto = aFicheroTrae;
          aAlfa = aAdjunto + &13 + &10;
          |XGRABA nHandle, aAlfa;

          eaBorraCache1 = aAdjunto;

          |XCIERRA nHandle;
     |FINSI;
|FPRC;

|PROCESO DSEnviaCorreoPLB;
     |HAZ Traete_dsenviacorreo;

     |SI enSwDesde9 = 0;
          |VENTANA 0501, 2799, -1, 1, "";
          nVent1   = FSalida;

          |PINPA #0#913;
          |PINDA #0#913;
          |PTEC 802;
          |PAUSA;
     |SINO;
          |SI enSwNomina = 0;
               |PINPA #0#919;
               |PINDA #0#919;
               |PTEC 802;
               |PAUSA;
          |FINSI;
     |FINSI;

     aFrom = eaOrigenPLB;
     |QBF aFrom;
     aReply  = eaDirRespoPLB;
     |QBF aReply;
     aSalida = eaServidorSMTP;
     |QBF aSalida;
     aDestinoCorreo = eaDestinoPLB;
     |QBF aDestinoCorreo;
     eaAlfa   = eaAsuntoPLB;
     |HAZ QuitaRarosCorreo;
     aAsunto  = eaAlfa;
     |QBF aAsunto;
     aCuerpo = eaCuerpoPLB;
     |QBF aCuerpo;
     aAdjunto = eaAdjuntoPLB;

     aUsuAuntenti = eaUsuarioPLB;
     aPassAuntenti = eaPassPLB;

     aConfLectura = eaConfLecPLB;

     aUsuario = Usuario;
     |QBF aUsuario;
     aNomEnvia = "dsenvia_" + aUsuario;

     |HAZ DimeUnidad;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS";              |RMKDIR aDirBaseLocal;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS\DSARCHI";      |RMKDIR aDirBaseLocal;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS\DSARCHI\";

     aBorra = aDirBaseLocal + aNomEnvia + ".err";
     |RFBORRA aBorra;

     aBorra = aDirBaseLocal + aNomEnvia + ".bue";
     |RFBORRA aBorra;

     aBorra = aDirBaseLocal + aNomEnvia + ".txt";
     |RFBORRA aBorra;

     aParaEnvio = aDirBaseLocal + aNomEnvia + ".txt";
     |HAZ MeteParaEnvioPLB;

     aEjecuta = aDirBaseLocal + "dsenviacorreo.exe" + " " + aParaEnvio;
     |RSYSTEM aEjecuta;

     ||Falta recoger el resultado

     ||Falta recoger respuesta.
     ||ARA99
     aRespuesta = aDirBaseLocal + aNomEnvia + ".err";
     |XABRE "CU", aRespuesta, nHandleE;
     |SI FSalida ] 0;
          |XLEE nHandleE, 250, aError;
          |QBF aError;
          enSwErrorCorreoPLB = 1;
     |SINO;
          enSwErrorCorreoPLB = 0;
     |FINSI;
     |XCIERRA nHandleE;

     |SI enSwDesde9 = 0;
          |FINVENTANA nVent1;
     |FINSI;
|FPRC;
