                         HUELLA CONTRATO DE TRABAJO

|FICHEROS;
     dsarw121;

     dsarm072;
|FIN;

|INCLUYE z1000var;

|PROCESO Graba121_99200;
     |DDEFECTO #dsarw121;

     enConta      = enConta + 1;
     #dsarw121#0  = enConta;
     #dsarw121#1  = eaFicRes;
     #dsarw121#2  = eaCotiza;
     #dsarw121#3  = eaNIF;
     #dsarw121#4  = aFecha;
     #dsarw121#5  = #dsarm072#0;
     #dsarw121#6  = #dsarm072#1;
     #dsarw121#7  = #dsarm072#2;
     #dsarw121#8  = #dsarm072#3;
     #dsarw121#9  = #dsarm072#4;
     #dsarw121#10 = #dsarm072#5;
     #dsarw121#11 = #dsarm072#6;
     #dsarw121#12 = #dsarm072#7;
     #dsarw121#13 = #dsarm072#8;

     aAlfa = aFecha % -104;  #dsarw121#14 = aAlfa;
     aAlfa = aFecha % 402;   #dsarw121#15 = aAlfa;

     #dsarw121#16 = enCodEmp;
     #dsarw121#17 = eaNIFEmp;
     #dsarw121#18 = eaNomEmp;
     #dsarw121#19 = enCodTra;
     #dsarw121#20 = eaNomTra;
     #dsarw121#23 = aMot1;
     #dsarw121#24 = aMot2;
     #dsarw121#25 = aMot3;

     |HAZ PonColor;

     |GRABA 020#dsarw121.n;
     |LIBERA #dsarw121;
|FPRC;

|PROCESO Tipo1_99200;
     enLinea = 2;  |HAZ LeeContenido;
     nLinTit = 3;
     nLinCot = 20;
     nLinNif = 32;
     nLinFec = 47;

     |SI eaContenido ! "";
         nLinTit = nLinTit + 1;
         nLinCot = nLinCot + 1;
         nLinNif = nLinNif + 1;
         nLinFec = nLinFec + 1;
     |FINSI;

     enLinea  = nLinCot;  |HAZ LeeContenido;
     eaCotiza = eaContenido % 182;

     enLinea  = nLinFec;  |HAZ LeeContenido;
     aFecha   = eaContenido % -110;

     enLinea  = nLinNif;  |HAZ LeeContenido;
     eaNIF    = eaContenido % 10840;

     |QBT eaNIF;
     |QBT eaCotiza;
     |QBT aFecha;

     eaNIF    = eaNIF % -109;
     eaCotiza = eaCotiza % -111;
     aFecha   = (aFecha % 102) + "." + (aFecha % 402) + "." + (aFecha % -104);

     aMot1   = "HUELLA DEL CONTRATO DE TRABAJO";
     enLinea = nLinTit; |HAZ LeeContenido; |HAZ QuitaBlan;  aMot2 = eaContenido;
     aMot3   = "";
|FPRC;

|PROCESO Docu_99200;
     |SI nTipoModelo = 1;  |HAZ Tipo1_99200;  |FINSI;
|FPRC;

|PROCESO MiraSi99200;
     eaCotiza = "";
     eaNIF    = "";
     aFecha   = "";
     nEnc     = 0;

     enLinea = 1;  |HAZ LeeContenido;
     eaContenido = eaContenido - "COMUNICACIÓN DEL CONTRATO DE TRABAJO";
     |SI FSalida ! 0;
        enLinea = 1;  |HAZ LeeContenido;
         nTipoModelo = 1;  |HAZ Docu_99200;
     |FINSI;

     |SI eaCotiza = "";  |Y aFecha = "";  |Y eaNIF = "";
         |ACABA;
     |FINSI;

     #dsarm072#0 = 992;
     #dsarm072#1 = 0;
     |LEE 000#dsarm072.=;
     |SI FSalida ! 0;  |DDEFECTO #dsarm072;  |FINSI;

     |HAZ LeeLaboral;
     |HAZ Graba121_99200;

     enChequeo = 1;
|FPRC;
