|FICHEROS;
     dsarm001;
     dsarm002;
     dsarm003;
     dsarm004;
     dsarm005;
     dsarm006;
     dsarm007;
     dsarm033;
     dsarm034;
     dpntm001;

     dsarz016;
|FIN;

|VARIABLES;
     nSubVent        = 0;
     nOk             = 0;

     aTipo           = "";
     aAlfa           = "";
     aAlfa1          = "";
     aAlfa2          = "";
     aAlfa3          = "";
     aAlfa4          = "";
     aOrigen         = "";
     aDestino        = "";
     aPath           = "";

     {-1}aVent       = "";
         aVent1      = 0;
         aVent2      = 0;
         aVent3      = 0;
         aVent4      = 0;
         aVent5      = "";

     nEmpAntARCHI    = 0;
     nEmpNueARCHI    = 0;
     nTraAntARCHI    = 0;
     nTraNueARCHI    = 0;
     nEmpresa        = 0;
     nTrabajador     = 0;
     nPeriodo        = 0;
     nAnyo           = 0;
     nTipo           = 0;
     nModelo         = 0;
     nDPeriodo       = 0;
     nHPeriodo       = 0;
     nDAnyo          = 0;
     nHAnyo          = 0;
     nDTipo          = 0;
     nHTipo          = 0;
     nDModelo        = 0;
     nHModelo        = 0;

     aNifAntARCHI    = "";
     aNifNueARCHI    = "";

     &eaPasaCont     = "";
|FIN;

|PROCESO dsarm006B;
     |BORRA 020#dsarm006.a;
     |LIBERA #dsarm006;
|FPRC;

|DEFBUCLE dsarm006B;
     #dsarm006#1;
     ;
     #dsarm005#0, 001;
     #dsarm005#0, 999;
     be;
     NULL, dsarm006B;
|FIN;

|PROCESO dsarm007_1B;
     |BORRA 020#dsarm007.a;
     |LIBERA #dsarm007;
|FPRC;

|DEFBUCLE dsarm007_1B;
     #dsarm007#1;
     ;
     #dsarm005#0, 000000001;
     #dsarm005#0, 999999999;
     be;
     NULL, dsarm007_1B;
|FIN;

|PROCESO dsarm007_2B;
     |BORRA 020#dsarm007.a;
     |LIBERA #dsarm007;
|FPRC;

|DEFBUCLE dsarm007_2B;
     #dsarm007#2;
     ;
     #dsarm005#0, 000000001;
     #dsarm005#0, 999999999;
     be;
     NULL, dsarm007_2B;
|FIN;

|PROCESO dsarm034_2;
     |SI aTipo = "BORR";
         |BORRA 020#dsarm034.a;
     |FINSI;

     |SI aTipo = "CAMB";
         |SI #dsarm034#18 = nEmpAntARCHI;

             #dsarm034#18 = nEmpNueARCHI;
             |GRABA 020#dsarm034.a;
         |FINSI;
     |FINSI;

     |LIBERA #dsarm034;
|FPRC;

|DEFBUCLE dsarm034_2;
     #dsarm034#2;
     ;
     #dsarm005#0;
     #dsarm005#0;
     be;
     NULL, dsarm034_2;
|FIN;

|PROCESO SacaUbicacion;
     aPath = #dsarm001#1;  |QBF aPath;

     |ABRE #dsarm002;
     |DDEFECTO #dsarm002;
     #dsarm002#0 = #dsarz016#1;
     |LEE 000#dsarm002.=;
     |CIERRA #dsarm002;

     aPath = aPath + "/" + #dsarm002#2;  |QBF aPath;
     |SI #dsarm001#7 = "N";
         |MKDIR aPath;
     |SINO;
         |RMKDIR aPath;
     |FINSI;

     |SI #dsarm001#8 = "N";
         aPath = aPath + "/";

         |ABRE #dsarm004;
         |DDEFECTO #dsarm004;
         #dsarm004#0 = #dsarz016#1;
         #dsarm004#1 = 1;
         #dsarm004#2 = 1;
         |LEE 000#dsarm004.=;
         |CIERRA #dsarm004;

         |SI #dsarm004#75 = "S";
              |SI #dsarm001#7 = "N";
                   |MKDIR aPath;
              |SINO;
                   |RMKDIR aPath;
              |FINSI;
         |FINSI;

         |ACABA;
     |FINSI;

     |ABRE #dsarm003;
     |DDEFECTO #dsarm003;
     #dsarm003#0 = #dsarz016#1;
     #dsarm003#1 = #dsarz016#2;
     |LEE 000#dsarm003.=;
     |CIERRA #dsarm003;

     aPath = aPath + "/" + #dsarm003#3;  |QBF aPath;
     |SI #dsarm001#7 = "N";
         |MKDIR aPath;
     |SINO;
         |RMKDIR aPath;
     |FINSI;

     |ABRE #dsarm004;
     |DDEFECTO #dsarm004;
     #dsarm004#0 = #dsarz016#1;
     #dsarm004#1 = #dsarz016#2;
     #dsarm004#2 = #dsarz016#3;
     |LEE 000#dsarm004.=;
     |CIERRA #dsarm004;

     aPath = aPath + "/" + #dsarm004#4;  |QBF aPath;
     |SI #dsarm001#7 = "N";
         |MKDIR aPath;
     |SINO;
         |RMKDIR aPath;
     |FINSI;

     aPath      = aPath + "/";

     |SI #dsarm004#75 = "S";
          |SI #dsarm001#7 = "N";
               |MKDIR aPath;
          |SINO;
               |RMKDIR aPath;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO dsarm005_3;
     |SI aTipo = "BORR";
         |SI #dsarz016#0 = "B";
             |BUCLE dsarm006B;
             |BUCLE dsarm007_1B;
             |BUCLE dsarm007_2B;
             |BUCLE dsarm034_2;

             |BORRA 020#dsarm005.a;

             aOrigen  = #dsarm005#7;  |QBF aOrigen;
             aOrigen  = aOrigen + #dsarm005#9;  |QBF aOrigen;

             |SI #dsarm001#7 = "N";
                 |FBORRA aOrigen;
             |SINO;
                 |RFBORRA aOrigen;
             |FINSI;
         |FINSI;

         |SI #dsarz016#0 = "M";
             |HAZ SacaUbicacion;
             #dsarm005#1 = #dsarz016#1;
             #dsarm005#2 = #dsarz016#2;
             #dsarm005#3 = #dsarz016#3;

             aOrigen  = #dsarm005#7;  |QBF aOrigen;
             aOrigen  = aOrigen + #dsarm005#9;  |QBF aOrigen;

             #dsarm005#7 = aPath;

             aDestino = #dsarm005#7;  |QBF aDestino;
             aDestino = aDestino + #dsarm005#9;  |QBF aDestino;

             |SI #dsarm001#7 = "N";
                 |RENOMBRA_FICHERO aOrigen, aDestino;
             |SINO;
                 |RRENOMBRA_FICHERO aOrigen, aDestino;
             |FINSI;

             #dsarm005#8  = 0;
             #dsarm005#94 = "N";
             |GRABA 020#dsarm005.a;
             |LIBERA #dsarm005;
         |FINSI;
     |FINSI;

     |SI aTipo = "CAMB";
         |SI nTraAntARCHI ! 0;
             |SI #dsarm005#15 ! nTraAntARCHI;  |ACABA;  |FINSI;

             #dsarm005#15 = nTraNueARCHI;
         |FINSI;

         #dsarm005#8  = nEmpNueARCHI;
         #dsarm005#94 = "N";
         |GRABA 020#dsarm005.a;

         |BUCLE dsarm034_2;
     |FINSI;
     |LIBERA #dsarm005;
|FPRC;

|DEFBUCLE dsarm005_3;
     #dsarm005#3;
     ;
     nEmpAntARCHI, "01.01.0000", "     ",         1;
     nEmpAntARCHI, "31.12.9999", "zzzzz", 999999999;
     be;
     NULL, dsarm005_3;
|FIN;

|PROCESO dsarm005_C;
     |SI aTipo = "CAMB";
         #dsarm005#67  = nEmpNueARCHI;
         |GRABA 020#dsarm005.a;

         |BUCLE dsarm034_2;
     |FINSI;
     |LIBERA #dsarm005;
|FPRC;

|DEFBUCLE dsarm005_C;
     #dsarm005#1;
     67;
     000000001, nEmpAntARCHI;
     999999999, nEmpAntARCHI;
     be;
     NULL, dsarm005_C;
|FIN;

|PROCESO dsarm005_4;
     #dsarm005#10 = aNifNueARCHI;
     |GRABA 020#dsarm005.a;
     |LIBERA #dsarm005;
|FPRC;

|DEFBUCLE dsarm005_4;
     #dsarm005#4;
     ;
     aNifAntARCHI, "01.01.0000", "     ", 1;
     aNifAntARCHI, "31.12.9999", "zzzzz", 999999999;
     be;
     NULL, dsarm005_4;
|FIN;

|PROCESO dsarm005_Trab;
     #dsarm005#95 = aNifNueARCHI;
     |GRABA 020#dsarm005.a;
     |LIBERA #dsarm005;
|FPRC;

|DEFBUCLE dsarm005_Trab;
     #dsarm005#1;
     95;
             1, aNifAntARCHI;
     999999999, aNifAntARCHI;
     be;
     NULL, dsarm005_Trab;
|FIN;

|PROCESO Tipo12Fz16;  |TIPO 12;
     |SI aTipo = "BORR";
         |SI #dsarz016#0 = "M";
             |SI #dsarz016#1 = 0;
                 |MENAV "0000Por favor rellene los datos de la carpeta.";
                 |ERROR;
                 |ACABA;
             |FINSI;
         |FINSI;

         |SI #dsarz016#0 = "N";  |ACABA;   |FINSI;

         |BUCLE dsarm005_3;

         nOk = 0;

         |ABRE #dpntm001;
         #dpntm001#0 = nEmpAntARCHI;
         |LEE 000#dpntm001.=;
         |SI FSalida = 0;  nOk = 1;  |FINSI;
         |CIERRA #dpntm001;

         |SI nOk = 1;
             aAlfa = "dpntm001;" + #dpntm001#0;
             |SUB_EJECUTA aAlfa;
         |FINSI;
     |FINSI;

     |SI aTipo = "CAMB";
         |BUCLE dsarm005_3;
         |SI eaPasaCont ! "NO"; |BUCLE dsarm005_C; |FINSI;

         nOk = 0;

         |ABRE #dpntm001;
         #dpntm001#0 = nEmpAntARCHI;
         |LEE 000#dpntm001.=;
         |SI FSalida = 0;  nOk = 1;  |FINSI;
         |CIERRA #dpntm001;

         |SI nOk = 1;
             |MENAV "0000Empresa con acceso DESPABOX, tendr  que gestionarla desde los accesos DESPABOX";
         |FINSI;
     |FINSI;

     |SI aTipo = "CNIF";
         |BUCLE dsarm005_Trab;
         |BUCLE dsarm005_4;
     |FINSI;
|FPRC;

|PROCESO Tipo7C1Fz16;  |TIPO 7;
     |SI #dsarz016#0 ! "M";
         |C_M #dsarz016#1, 1, "N";  #dsarz016#1 = 0;   |PINTA #dsarz016#1;
         |C_M #dsarz016#2, 1, "N";  #dsarz016#2 = 0;   |PINTA #dsarz016#2;
         |C_M #dsarz016#3, 1, "N";  #dsarz016#3 = 0;   |PINTA #dsarz016#3;
                                    #dsarz016#4 = "";  |PINTA #dsarz016#4;
                                    #dsarz016#5 = "";  |PINTA #dsarz016#4;
                                    #dsarz016#6 = "";  |PINTA #dsarz016#4;
         |ACABA;
     |FINSI;

     |C_M #dsarz016#1, 1, "S";
     |C_M #dsarz016#2, 1, "S";
     |C_M #dsarz016#3, 1, "S";

     |SI #dsarm001#8 = "N";
         |C_M #dsarz016#2, 1, "N";  #dsarz016#2 = 1;
         |C_M #dsarz016#3, 1, "N";  #dsarz016#3 = 1;
                                    #dsarz016#5 = "";
                                    #dsarz016#6 = "";

     |FINSI;

     |PINTA #dsarz016#1;
     |PINTA #dsarz016#2;
     |PINTA #dsarz016#3;
     |PINTA #dsarz016#4;
     |PINTA #dsarz016#5;
|FPRC;

|PROCESO Tipo0C1Fz16;
     |SI #dsarz016#0  ! "M";  |ACABA;  |FINSI;
     |SI FSalida  = 2;   |ACABA;  |FINSI;

     |ABRE #dsarm002;
     #dsarm002#0 = #dsarz016#1;
     |LEE 000#dsarm002.=;
     |SI FSalida ! 0;
          |MENAV "    Grupo inexistente"; |ERROR;
          #dsarz016#4 = "";
     |SINO;
          #dsarz016#4 = #dsarm002#1;
     |FINSI;
     |CIERRA #dsarm002;

     |PINTA #dsarz016#2;
|FPRC;

|PROCESO Baja3;
     #dsarm003#0 = #dsarz016#1;
     #dsarm003#1 = 1;
|FPRC;

|PROCESO Alta3;
     #dsarm003#0 = #dsarz016#1;
     #dsarm003#1 = 999;
|FPRC;

|PROCESO Tipo66C2Fz16;  |TIPO 66;
     |ABRE #dsarm003;
     #dsarm003#0 = #dsarz016#1;
     #dsarm003#1 = #dsarz016#2;
     |LEE 000#dsarm003.=;

     |CONSULTA_F_CLAVE #1#dsarm003, Baja3, Alta3;
     |SI FSalida = 0;
         #dsarz016#2 = #dsarm003#1;  |PINTA #dsarz016#2;
     |FINSI;

     |CIERRA #dsarm003;

     |ERROR;
|FPRC;

|PROCESO Tipo0C2Fz16;
     |SI #dsarz016#0  ! "M";  |ACABA;  |FINSI;
     |SI #dsarm001#8    = "N";  |ACABA;  |FINSI;
     |SI FSalida  = 2;   |ACABA;  |FINSI;

     |ABRE #dsarm003;
     #dsarm003#0 = #dsarz016#1;
     #dsarm003#1 = #dsarz016#2;
     |LEE 000#dsarm003.=;
     |SI FSalida ! 0;
          |MENAV "    Subgrupo inexistente"; |ERROR;
          #dsarz016#5 = "";
     |SINO;
          #dsarz016#5 = #dsarm003#2;
     |FINSI;
     |CIERRA #dsarm003;

     |PINTA #dsarz016#5;
|FPRC;

|PROCESO Baja4;
     #dsarm004#0 = #dsarz016#1;
     #dsarm004#1 = #dsarz016#2;
     #dsarm004#2 = 1;
|FPRC;

|PROCESO Alta4;
     #dsarm004#0 = #dsarz016#1;
     #dsarm004#1 = #dsarz016#2;
     #dsarm004#2 = 999;
|FPRC;

|PROCESO Tipo66C3Fz16;  |TIPO 66;
     |ABRE #dsarm004;
     #dsarm004#0 = #dsarz016#1;
     #dsarm004#1 = #dsarz016#2;
     #dsarm004#2 = #dsarz016#3;
     |LEE 000#dsarm004.=;

     |CONSULTA_F_CLAVE #1#dsarm004, Baja4, Alta4;
     |SI FSalida = 0;
         #dsarz016#3 = #dsarm004#2;  |PINTA #dsarz016#3;
     |FINSI;

     |CIERRA #dsarm004;

     |ERROR;
|FPRC;

|PROCESO Tipo0C3Fz16;
     |SI #dsarz016#0  ! "M";  |ACABA;  |FINSI;
     |SI #dsarm001#8    = "N";  |ACABA;  |FINSI;
     |SI FSalida  = 2;   |ACABA;  |FINSI;

     |ABRE #dsarm004;
     #dsarm004#0 = #dsarz016#1;
     #dsarm004#1 = #dsarz016#2;
     #dsarm004#2 = #dsarz016#3;
     |LEE 000#dsarm004.=;
     |SI FSalida ! 0;
          |MENAV "    Tipo inexistente"; |ERROR;
          #dsarz016#6 = "";
     |SINO;
          #dsarz016#6 = #dsarm004#3;
     |FINSI;
     |CIERRA #dsarm004;

     |PINTA #dsarz016#6;
|FPRC;

|PROCESO Borrado;
     |ABRE #dsarm001;
     |LEE 000#dsarm001.p;
     |CIERRA #dsarm001;

     |SI #dsarm001#115 = "N";  |ACABA;   |FINSI;

     |VENTANA 0501, 1770, -1, 16, "Tratando registros en DSARCHI";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;
     |PAUSA;

     #dsarz016#0  = #dsarm001#115;
     #dsarz016#1  = #dsarm001#116;
     #dsarz016#2  = #dsarm001#117;
     #dsarz016#3  = #dsarm001#118;
     #dsarz016#4  = #dsarm001#119;
     #dsarz016#5  = #dsarm001#120;
     #dsarz016#6  = #dsarm001#121;

     |SI #dsarm001#115 ! "P";
         |CONTROL_SIMPLE 0, "LABEL,{{9}}Tratando registros DSARCHI", 0602, 0768, NULL;

         #dsarz016#0  = #dsarm001#115;
         #dsarz016#1  = #dsarm001#116;
         #dsarz016#2  = #dsarm001#117;
         #dsarz016#3  = #dsarm001#118;
         #dsarz016#4  = #dsarm001#119;
         #dsarz016#5  = #dsarm001#120;
         #dsarz016#6  = #dsarm001#121;

         |HAZ Tipo12Fz16;
     |SINO;
         |SI #dsarz016#1 ! 0;
             #dsarz016#0 = "M";
         |SINO;
             #dsarz016#0 = "B";
         |FINSI;

         |PINPA #0#dsarz016;
         |PINDA #0#dsarz016;
         |ENDATOS #1#dsarz016;
         |SI FSalida = 0;
             |HAZ Tipo12Fz16;

             |ABRE #dsarm001;
             |LEE 101#dsarm001.p;
             |SI FSalida = 0;
                 #dsarm001#116 = #dsarz016#1;
                 #dsarm001#117 = #dsarz016#2;
                 #dsarm001#118 = #dsarz016#3;
                 #dsarm001#119 = #dsarz016#4;
                 #dsarm001#120 = #dsarz016#5;
                 #dsarm001#121 = #dsarz016#6;
                 |GRABA 020#dsarm001.a;
                 |LIBERA #dsarm001;
             |FINSI;
             |CIERRA #dsarm001;
         |FINSI;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Cambio;
     |VENTANA 0501, 1770, -1, 16, "Tratando registros en DSARCHI";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;
     |PAUSA;

     |CONTROL_SIMPLE 0, "LABEL,{{2}}Tratando registros DSARCHI", 0602, 0768, NULL;

     |HAZ Tipo12Fz16;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO CambioNif;
     |VENTANA 0501, 1770, -1, 16, "Tratando registros en DSARCHI";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;
     |PAUSA;

     |CONTROL_SIMPLE 0, "LABEL,{{2}}Tratando registros DSARCHI", 0602, 0768, NULL;

     |HAZ Tipo12Fz16;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO dsarm005BLAB;
     |BUCLE dsarm006B;
     |BUCLE dsarm007_1B;
     |BUCLE dsarm007_2B;
     |BUCLE dsarm034_2;

     |BORRA 020#dsarm005.a;
     |LIBERA #dsarm005;

     aOrigen  = #dsarm005#7;  |QBF aOrigen;
     aOrigen  = aOrigen + #dsarm005#9;  |QBF aOrigen;

     |SI #dsarm001#7 = "N";
         |FBORRA aOrigen;
     |SINO;
         |RFBORRA aOrigen;
     |FINSI;
|FPRC;

|DEFBUCLE dsarm005BLAB;
     #dsarm005#9;
     15;
     nEmpresa, nDModelo, nDAnyo, nDPeriodo, nDTipo,         0, nTrabajador;
     nEmpresa, nHModelo, nHAnyo, nHPeriodo, nHTipo, 999999999, nTrabajador;
     be;
     NULL, dsarm005BLAB;
|FIN;

|PROCESO BorradoLAB;
     |VENTANA 0501, 1770, -1, 16, "Borrando registros trabajador en DSARCHI";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;
     |PAUSA;

     |BUCLE dsarm005BLAB;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROGRAMA;
     aTipo   = PARAMETRO % 104;
     aAlfa1  = PARAMETRO % 0515;
     aAlfa2  = PARAMETRO % 2015;
     aAlfa3  = PARAMETRO % 3505;
     aAlfa4  = PARAMETRO % 4005;

     |SI aTipo = "BORR";
         nEmpAntARCHI    = aAlfa1;
         nEmpNueARCHI    = 0;

         |HAZ Borrado;
     |FINSI;

     |SI aTipo = "CAMB";
         nEmpAntARCHI    = aAlfa1;
         nEmpNueARCHI    = aAlfa2;
         nTraAntARCHI    = aAlfa3;
         nTraNueARCHI    = aAlfa4;
         |HAZ Cambio;
     |FINSI;

     |SI aTipo = "CNIF";
         aNifAntARCHI = aAlfa1 % 112;
         aNifNueARCHI = aAlfa2 % 112;
         |HAZ CambioNif;
     |FINSI;

     |SI aTipo = "BLAB";
         || aAlfa = Empresa + Trabajador + Periodo + A¤o + Tipo + Modelo

         aAlfa = PARAMETRO % 0521;

         aAlfa1 = aAlfa % 105;   nEmpresa    = aAlfa1;
         aAlfa1 = aAlfa % 605;   nTrabajador = aAlfa1;
         aAlfa1 = aAlfa % 1102;  nPeriodo    = aAlfa1;
         aAlfa1 = aAlfa % 1304;  nAnyo       = aAlfa1;
         aAlfa1 = aAlfa % 1702;  nTipo       = aAlfa1;
         aAlfa1 = aAlfa % 1903;  nModelo     = aAlfa1;

         nDPeriodo = nPeriodo;
         nHPeriodo = nPeriodo;
         nDAnyo    = nAnyo;
         nHAnyo    = nAnyo;
         nDModelo  = nModelo;
         nHModelo  = nModelo;
         nDTipo    = nTipo;
         nHTipo    = nTipo;

         |SI nPeriodo = 0;
             nDPeriodo = 0;
             nHPeriodo = 99;
         |FINSI;

         |SI nAnyo = 0;
             nDAnyo = 0;
             nHAnyo = 9999;
         |FINSI;

         |SI nModelo = 0;
             nDModelo = 0;
             nHModelo = 999;
         |FINSI;

         |SI nTipo = -1;
             nDTipo = 0;
             nHTipo = 999;
         |FINSI;

         |SI nTipo = 0;
             nDTipo = 0;
             nHTipo = 1;
         |FINSI;

         |HAZ BorradoLAB;
     |FINSI;
|FPRO;
