|FICHEROS;
     dsarm002 #2;
     dsarw002 #902;

     dsarm024 #24;
|FIN;

|VARIABLES;
     &enSwMueve = 0;      ||Para boton nuevo de Mover Estructura/Registros/Doc
     &eaCarpetaOri = "";

     aCarpetaAnt    = "";
     aCarpeta       = "";
     aMensaje       = "";
     aAlfa          = "";

     aAux           = "";
     nSwEstaCarpeta = 0;
     nGrupoEstoy    = 0;
     aGrupoRepe     = "";

     &enModo        = 0;
|FIN;

|PROCESO Tipo12Fw2;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     aCarpeta = #902#2;
     |QBT aCarpeta;
     |SI aCarpeta = "";
          aMensaje = "0000Carpeta Vacia. Por favor, introduzca un nombre valido.";
          |MENAV aMensaje;
          |ERROR;
          |ACABA;
     |FINSI;
|FPRC;


|PROCESO dsarm002_carpeta;
     |SI #dsarm002#0 ! nGrupoEstoy;
          aAux = #dsarm002#2;
          |QBF aAux;
          |SI aAux = aCarpeta;
               |SI enSwMueve = 1;
                    |SI aAux ! eaCarpetaOri;
                         nSwEstaCarpeta = 1;
                         aGrupoRepe = #dsarm002#1;
                         |QBF aGrupoRepe;
                         |ERROR10;
                    |FINSI;
               |SINO;
                    nSwEstaCarpeta = 1;
                    aGrupoRepe = #dsarm002#1;
                    |QBF aGrupoRepe;
                    |ERROR10;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsarm002_carpeta;
 #dsarm002#1;
 ;
 INICIO;
 FINAL;
 ;
 NULL, dsarm002_carpeta;
|FIN;

|PROCESO MiraCarpetaw002;
     nGrupoEstoy = #902#0;

     |BUCLE dsarm002_carpeta;

     #2#0 = nGrupoEstoy;
     |LEE 000#2=;
|FPRC;

|PROCESO dsarm024;
     aAux = #dsarm024#2;
     |QBT aAux;
     |SI aAux = aCarpeta;
          nSwEstaCarpeta = 1;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE dsarm024;
 #dsarm024#1;
 ;
 INICIO;
 FINAL;
 ;
 NULL, dsarm024;
|FIN;

|PROCESO MiraRestoUbicaciones;
     |BUCLE dsarm024;
|FPRC;

|PROCESO Tipo0C2Fw2; |TIPO 0;
     aAlfa    = Contenido;  |QBF aAlfa;
     aCarpeta = #902#2;     |QBF aCarpeta;

     |SI aCarpeta ! "";
         nSwEstaCarpeta = 0;
         |HAZ MiraCarpetaw002;
         |SI nSwEstaCarpeta = 1;
              aMensaje = "0000Carpeta ubicaci¢n [" + aCarpeta + "] ya utilizado en grupo: " + aGrupoRepe;
              |MENAV aMensaje;
              |ERROR;
              |ACABA;
         |SINO;
              ||Ahora la carpeta del dsarm024, es una carpeta de la maquina local
              ||HAZ MiraRestoUbicaciones;
              |SI nSwEstaCarpeta = 1;
                   aMensaje = "0000Carpeta ubicaci¢n [" + aCarpeta + "] ya utilizado en Prep.Documentaci¢n.";
                   |MENAV aMensaje;
                   |ERROR;
                   |ACABA;
              |FINSI;
         |FINSI;
     |FINSI;

     |SI aAlfa ! "";
          |SI #902#2 ! Contenido;
              |SI aCarpeta = "";
                  #902#2 = Contenido;
              |SINO;
                  aCarpetaAnt = Contenido;
                  |QBF aCarpetaAnt;
                  aMensaje = "0000El cambio de ubicaci¢n desvincular  los archivos ya existentes en [" + aCarpetaAnt + "]";
                  |MENAV aMensaje;
                  |CONFI "0000NContinuar?";
                  |SI FSalida ! 0;
                      #902#2 = Contenido;
                  |FINSI;
              |FINSI;
          |FINSI;
     |FINSI;

     aCarpeta = #902#2;
     |QBT aCarpeta;
     |SI aCarpeta = "";
          aMensaje = "0000Carpeta Vacia. Por favor, introduzca un nombre valido.";
          |MENAV aMensaje;
          |ERROR;
     |SINO;
          #902#2 = aCarpeta;
          |PINTA #902#2;
     |FINSI;
|FPRC;

|PROCESO Tipo0C0Fw2;  |TIPO 0;
     |SI enModo ! 1;  |ACABA;  |FINSI;

     #2#0 = #902#0;
     |LEE 000#2=;
     |SI FSalida = 0;
         |MENAV "0000 El Grupo ya Existe.";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tipo7C0Fw2;  |TIPO 7;
     |SI enModo ! 1;  |ACABA;  |FINSI;

     |LEE 000#2u;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

     #902#0 = #2#0 + 1;  |PINTA #902#0;
|FPRC;
