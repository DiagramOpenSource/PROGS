|FICHEROS;
     dsarz029 #0;        ||Este Def
     dsarm019 #19,MANTE; ||Reglas. Cond. Campos
     dsarw016 #916;
|FIN;

|VARIABLES;
     aAux = "";
     nModo = 0;
     nCont7 = 0;

     &enNumRegla = 0;
     aFichero = "";
     nCampo = 0;

     nExiste = 0;
     aMensaje = "";
     nRango =0;
     nPos1 = 0;
     nPos2 = 0;
     nGrid = 0;
     aEsc1  = "";
     aEsc2  = "";
     aRetu  = "";
     aTecla = "";
|FIN;

|PROCESO Tipo80; |TIPO 80;
     FSalida = 2999;
|FPRC;

|PROCESO Evento;

|FPRC;

|PROCESO Alta;
     #dsarm019#0 = enNumRegla;
     #dsarm019#4 = 9999;
|FPRC;

|PROCESO Baja;
     #dsarm019#0 = enNumRegla;
     #dsarm019#4 = 0001;
|FPRC;

|PROCESO Tipo66Campos;  |TIPO 66;
     |ABRE #916;
     |LEE 000#916p;
     |CONSULTA_CLAVE #1#916;
     |SI FSalida = 0;
         nCampo    = Campo + 1;
         #19Campo  = #916#0;    |PINTA #19Campo;
         #19nCampo = #916#1;    |PINTA #19nCampo;
     |FINSI;
     |CIERRA #916;
|FPRC;

|PROCESO Tipo0Campos;  |TIPO 0;
     |ABRE #916;
     #916#0 = #19Campo;
     |LEE 000#916=;
     |SI FSalida ! 0;
         |MENAV "0000No existe el campo";
         |ERROR;
         |CIERRA #916;
         |ACABA;
     |FINSI;
     |CIERRA #916;

     nCampo     = Campo + 1;
     #19Campo  = #916#0;    |PINTA #19Campo;
     #19nCampo = #916#1;    |PINTA #19nCampo;
|FPRC;

|PROCESO Tipo7C4m019;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          #dsarm019#0 = enNumRegla;
          #dsarm019#4 = 9999;
          |LEE 000#dsarm019.];
          |SI FSalida = 0;
               |LEE 000#dsarm019.a;
          |SINO;
               |LEE 000#dsarm019.u;
          |FINSI;
          |SI FSalida = 0; |Y #dsarm019#0 = enNumRegla;
               nCont7 = #dsarm019#4 + 1;
          |SINO;
               nCont7 = 1;
          |FINSI;
          |DDEFECTO #dsarm019;
          #dsarm019#0 = enNumRegla;
          #dsarm019#4 = nCont7;
          |PINTA #dsarm019#4;
     |FINSI;
|FPRC;

|PROCESO Tipo0C5m019; |TIPO 0;
     aAux = #dsarm019#5;
     |QBF aAux;
     |SI aAux ! "="; |Y aAux ! "!"; |Y aAux ! "<"; |Y aAux ! ">"; |Y aAux ! "<="; |Y aAux ! ">=";
          aMensaje = "0000Operaci¢n NO permitida. Solo se permite: =,!,<,>,<= y >=";
          |MENAV aMensaje;
          |ERROR;
     |FINSI;
|FPRC;

|PROGRAMA;
     |CLS;
     |ABRE #0;
     |ABRE #19;
     |PINPA #0#0;

     aFichero = ("17" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #916 aFichero;

     nRango = 1 + 4 + 8 + 16 + 32;
     nPos1 = 0803;
     nPos2 = 2895;

     |LINEAL_SIMPLE #1#dsarm019, nRango, nPos1, nPos2, Baja, Alta, Evento;
     nGrid = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nGrid;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |CIERRA #19;
     |CIERRA #0;
|FPRO;
