|FICHEROS;
     dsarm002 #2;
     dsarm003 #3;
     dsarw003 #903;
|FIN;

|VARIABLES;
     aCarpetaAnt = "";
     aCarpeta   = "";
     aMensaje   = "";
     aAlfa      = "";

     &enModo    = 0;

     aAux = "";
     nSwEstaCarpeta = 0;
     nGrupoEstoy = 0;
     nSubGrupoEstoy = 0;
     aSubGrupoRepe = "";
|FIN;

|PROCESO Tipo12Fw3;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     aCarpeta = #903#5;
     |QBT aCarpeta;
     |SI aCarpeta = "";
          aMensaje = "0000Carpeta Vacia. Por favor, introduzca un nombre valido.";
          |MENAV aMensaje;
          |ERROR;
          |ACABA;
     |FINSI;
|FPRC;

|PROCESO dsarm003_carpeta;
     |SI #dsarm003#1 ! nSubGrupoEstoy;
          aAux = #dsarm003#3;
          |QBF aAux;
          |SI aAux = aCarpeta;
               nSwEstaCarpeta = 1;
               aSubGrupoRepe = #dsarm003#2;
               |QBF aSubGrupoRepe;
               |ERROR10;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsarm003_carpeta;
 #dsarm003#1;
 ;
 nGrupoEstoy, 001;
 nGrupoEstoy, 999;
 ;
 NULL, dsarm003_carpeta;
|FIN;

|PROCESO MiraCarpetaw003;
     nGrupoEstoy = #903#0;
     nSubGrupoEstoy = #903#3;

     |BUCLE dsarm003_carpeta;


     #3#0 = nGrupoEstoy;
     #3#1 = nSubGrupoEstoy;
     |LEE 000#3=;
|FPRC;


|PROCESO Tipo0C5Fw3;  |TIPO 0;
     aAlfa    = Contenido;  |QBF aAlfa;
     aCarpeta = #903#5;     |QBF aCarpeta;


     |SI aCarpeta ! "";
         nSwEstaCarpeta = 0;
         |HAZ MiraCarpetaw003;
         |SI nSwEstaCarpeta = 1;
              aMensaje = "0000Carpeta ubicaci¢n [" + aCarpeta + "] ya utilizado en Subgrupo: " + aSubGrupoRepe;
              |MENAV aMensaje;
              |ERROR;
              |ACABA;
         |FINSI;
     |FINSI;

     |SI aAlfa ! "";
         |SI #903#5 ! Contenido;
             |SI aCarpeta = "";
                 #903#5 = Contenido;
             |SINO;
                 aCarpetaAnt = Contenido;
                 |QBF aCarpetaAnt;
                 aMensaje = "0000El cambio de ubicaci¢n desvincular  los archivos ya existentes en [" + aCarpetaAnt + "]";
                 |MENAV aMensaje;
                 |CONFI "0000NContinuar?";
                 |SI FSalida ! 0;
                     #903#5 = Contenido;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     aCarpeta = #903#5;
     |QBT aCarpeta;
     |SI aCarpeta = "";
          aMensaje = "0000Carpeta Vacia. Por favor, introduzca un nombre valido.";
          |MENAV aMensaje;
          |ERROR;
     |SINO;
          #903#5 = aCarpeta;
          |PINTA #903#5;
     |FINSI;
|FPRC;

|PROCESO Tipo0C3Fw3;  |TIPO 0;
     |SI enModo ! 1;  |ACABA;  |FINSI;

     #3#0 = #903#0;
     #3#1 = #903#3;
     |LEE 000#3=;
     |SI FSalida = 0;
         |MENAV "0000 El Subgrupo ya Existe.";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tipo7C3Fw3;  |TIPO 7;
     |SI enModo ! 1;  |ACABA;  |FINSI;

     #3#0 = #903#0;
     #3#1 = 999;
     |LEE 000#3];
     |SI FSalida = 0;
         |LEE 000#3a;
     |SINO;
         |LEE 000#3u;
     |FINSI;

     #903#3 = 1;
     |SI FSalida = 0;  |Y #3#0 = #903#0;
         #903#3 = #3#1 + 1;
     |FINSI;

     |PINTA #903#3;
|FPRC;
