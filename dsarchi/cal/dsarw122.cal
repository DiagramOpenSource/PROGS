|FICHEROS;
     dsarw122,MANTE;

     dsarm072;

     :/laboral/def/labempre;
     :/laboral/def/labcentr;
     :/laboral/def/nomcenes;
     :/laboral/def/nomw0003;
|FIN;

|VARIABLES;
|FIN;

|INCLUYE z1000var;

|PROCESO nomw0003_C7;
     enCodTra = #nomw0003#1;
     eaNomTra = #nomw0003#2;
|FPRC;

|DEFBUCLE nomw0003_C7;
     #nomw0003#7;
     ;
     eaNIF, #labempre#0, 00001;
     eaNIF, #labempre#0, 99999;
     ;
     NULL, nomw0003_C7;
|FIN;

|PROCESO LeeLaboral;
     |DBASS aBase;
     aPathLab = aBase + "laboral/fich/";
     |PATH_DAT #labempre#aPathLab#;
     |PATH_DAT #labcentr#aPathLab#;
     |PATH_DAT #nomcenes#aPathLab#;
     |PATH_DAT #nomw0003#aPathLab#;

     |ABRE #labcentr;  |SELECT #2#labcentr;
     #labcentr#10 = eaCotiza;
     |LEE 000#labcentr.=;
     |SI FSalida ! 0;
         |DDEFECTO #labcentr;
         #labcentr#0 = 0;
     |FINSI;
     |CIERRA #labcentr;

     nEmp = #labcentr#0;

     |SI nEmp = 0;
         |ABRE #nomcenes;  |SELECT #2#nomcenes;
         #nomcenes#10 = eaCotiza;
         |LEE 000#nomcenes.=;
         |SI FSalida = 0;
             nEmp = #nomcenes#0;
         |FINSI;
         |CIERRA #nomcenes;
     |FINSI;

     |ABRE #labempre;
     #labempre#0 = nEmp;
     |LEE 000#labempre.=;
     |SI FSalida ! 0;
         |DDEFECTO #labempre;
         #labempre#0 = 0;
     |FINSI;
     |CIERRA #labempre;

     enCodTra = 0;
     eaNomTra = "";
     |BUCLE nomw0003_C7;

     enCodEmp = #labempre#0;
     eaNIFEmp = #labempre#10;
     eaNomEmp = #labempre#2;
|FPRC;

|PROCESO T12Fw122;  |TIPO 12;
     |SI FSalida = 7;
         |ACABA;
     |FINSI;

     |SI FSalida ! 1;
         |ERROR;

         |POSICIONATE #dsarw122#1;
     |FINSI;
|FPRC;

|PROCESO T0C5Fw122;  |TIPO 0;
     #dsarm072#0 = #dsarw122#4;
     #dsarm072#1 = #dsarw122#5;
     |LEE 000#dsarm072.=;
     |SI FSalida ! 0;
         |MENAV "0000No existe tipo de documento.";
         |ERROR;
     |FINSI;

     #dsarw122#6  = #dsarm072#2;
     #dsarw122#7  = #dsarm072#3;
     #dsarw122#8  = #dsarm072#4;
     #dsarw122#9  = #dsarm072#5;
     #dsarw122#10 = #dsarm072#6;
     #dsarw122#11 = #dsarm072#7;
     #dsarw122#12 = #dsarm072#8;

     |PINTA #dsarw122#6;
     |PINTA #dsarw122#7;
     |PINTA #dsarw122#8;
     |PINTA #dsarw122#9;
     |PINTA #dsarw122#10;
     |PINTA #dsarw122#11;
     |PINTA #dsarw122#12;
|FPRC;

|PROCESO Bajam72;
     #dsarm072#0 = #dsarw122#4;
     #dsarm072#1 = 00;
|FPRC;

|PROCESO Altam72;
     #dsarm072#0 = #dsarw122#4;
     #dsarm072#1 = 99;
|FPRC;

|PROCESO T66C5Fw122;  |TIPO 66;
     #dsarm072#0 = #dsarw122#4;
     #dsarm072#1 = #dsarw122#5;
     |LEE 000#dsarm072.];

     |CONSULTA_F_CLAVE #1#dsarm072, Bajam72, Altam72;
     |SI FSalida = 0;
         #dsarw122#5  = #dsarm072#1;
         #dsarw122#6  = #dsarm072#2;
         #dsarw122#7  = #dsarm072#3;
         #dsarw122#8  = #dsarm072#4;
         #dsarw122#9  = #dsarm072#5;
         #dsarw122#10 = #dsarm072#6;
         #dsarw122#11 = #dsarm072#7;
         #dsarw122#12 = #dsarm072#8;
     |FINSI;

     |PINTA #dsarw122#5;
     |PINTA #dsarw122#6;
     |PINTA #dsarw122#7;
     |PINTA #dsarw122#8;
     |PINTA #dsarw122#9;
     |PINTA #dsarw122#10;
     |PINTA #dsarw122#11;
     |PINTA #dsarw122#12;
|FPRC;

|PROCESO T0C3Fw122;  |TIPO 0;
     aAlfa = #dsarw122#3 % -104;  #dsarw122#13 = aAlfa;
     aAlfa = #dsarw122#3 % 402;   #dsarw122#14 = aAlfa;

     |PINTA #dsarw122#13;
     |PINTA #dsarw122#14;
|FPRC;

|PROCESO T0C2Fw122;  |TIPO 0;
     eaCotiza = #dsarw122#1;
     eaNIF    = #dsarw122#2;
     |HAZ LeeLaboral;
     |SI enCodTra = 0;
         |MENAV "0000No existe ningun trabajador con el NIF introducido.";
         |ERROR;
     |FINSI;

     #dsarw122#15 = enCodEmp;
     #dsarw122#16 = eaNIFEmp;
     #dsarw122#17 = eaNomEmp;
     #dsarw122#18 = enCodTra;
     #dsarw122#19 = eaNomTra;

     |PINTA #dsarw122#15;
     |PINTA #dsarw122#16;
     |PINTA #dsarw122#17;
     |PINTA #dsarw122#18;
     |PINTA #dsarw122#19;
|FPRC;

|PROCESO Bajaw3;
     #nomw0003#0  = #dsarw122#15;
     #nomw0003#1  = 1;
|FPRC;

|PROCESO Altaw3;
     #nomw0003#0  = #dsarw122#15;
     #nomw0003#1  = 99999;
|FPRC;

|PROCESO T66C2Fw122;  |TIPO 66;
     |DBASS aBase;
     aPathLab = aBase + "laboral/fich/";
     |PATH_DAT #nomw0003#aPathLab#;

     |ABRE #nomw0003;  |SELECT #1#nomw0003;
     #nomw0003#0  = #dsarw122#15;
     #nomw0003#1  = #dsarw122#18;
     |LEE 000#nomw0003.];

     |CONSULTA_F_CLAVE #1#nomw0003, Bajaw3, Altaw3;
     |SI FSalida = 0;
         #dsarw122#18 = #nomw0003#1;
         #dsarw122#19 = #nomw0003#2;
         #dsarw122#2  = #nomw0003#7;
     |FINSI;
     |CIERRA #nomw0003;

     |PINTA #dsarw122#2;
     |PINTA #dsarw122#18;
     |PINTA #dsarw122#19;
|FPRC;

|PROCESO T0C1Fw122;  |TIPO 0;
     eaCotiza = #dsarw122#1;
     eaNIF    = #dsarw122#2;
     |HAZ LeeLaboral;
     |SI enCodEmp = 0;
         |MENAV "0000No existe ninguna empresa con esta Cuenta de Cotizaci¢n.";
         |ERROR;
     |FINSI;

     #dsarw122#15 = enCodEmp;
     #dsarw122#16 = eaNIFEmp;
     #dsarw122#17 = eaNomEmp;
     #dsarw122#18 = enCodTra;
     #dsarw122#19 = eaNomTra;

     |PINTA #dsarw122#15;
     |PINTA #dsarw122#16;
     |PINTA #dsarw122#17;
     |PINTA #dsarw122#18;
     |PINTA #dsarw122#19;
|FPRC;

|PROCESO T66C1Fw122;  |TIPO 66;
     |DBASS aBase;
     aPathLab = aBase + "laboral/fich/";
     |PATH_DAT #labcentr#aPathLab#;
     |PATH_DAT #nomcenes#aPathLab#;

     |ABRE #labcentr;  |SELECT #2#labcentr;
     #labcentr#10 = #dsarw122#1;
     |LEE 000#labcentr.=;
     |SI FSalida ! 0;  |DDEFECTO #labcentr;  |FINSI;

     |CONSULTA_CLAVE #2#labcentr;
     |SI FSalida = 0;
         #dsarw122#1 = #labcentr#10;
     |SINO;
         #labcentr#10 = "";
     |FINSI;
     |CIERRA #labcentr;

     |SI #labcentr#10 = "               ";
         |CONFI "0000SQuiere consultar en los centros especiales de formaci¢n";
         |SI FSalida = 0;
            |ABRE #nomcenes;  |SELECT #2#nomcenes;
            #nomcenes#10 = #dsarw122#1;
            |LEE 000#nomcenes.=;
            |SI FSalida ! 0;  |DDEFECTO #nomcenes;  |FINSI;

            |CONSULTA_CLAVE #2#nomcenes;
            |SI FSalida = 0;
                #dsarw122#1 = #nomcenes#10;
            |FINSI;
            |CIERRA #nomcenes;
         |FINSI;
     |FINSI;

     |PINTA #dsarw122#1;
|FPRC;
