                    SOBRE RECONOCIMIENTO DE BAJA

|FICHEROS;
     dsarw121;

     dsarm072;
|FIN;

|INCLUYE z1000var;

|PROCESO Graba121_99101;
     |DDEFECTO #dsarw121;

     enConta      = enConta + 1;
     #dsarw121#0  = enConta;
     #dsarw121#1  = eaFicRes;
     #dsarw121#2  = eaCotiza;
     #dsarw121#3  = eaNIF;
     #dsarw121#4  = aFecha;
     #dsarw121#5  = #dsarm072#0;
     #dsarw121#6  = #dsarm072#1;
     #dsarw121#7  = #dsarm072#2;
     #dsarw121#8  = #dsarm072#3;
     #dsarw121#9  = #dsarm072#4;
     #dsarw121#10 = #dsarm072#5;
     #dsarw121#11 = #dsarm072#6;
     #dsarw121#12 = #dsarm072#7;
     #dsarw121#13 = #dsarm072#8;

     aAlfa = aFecha % -104;  #dsarw121#14 = aAlfa;
     aAlfa = aFecha % 402;   #dsarw121#15 = aAlfa;

     #dsarw121#16 = enCodEmp;
     #dsarw121#17 = eaNIFEmp;
     #dsarw121#18 = eaNomEmp;
     #dsarw121#19 = enCodTra;
     #dsarw121#20 = eaNomTra;
     #dsarw121#23 = aMot1;
     #dsarw121#24 = aMot2;
     #dsarw121#25 = aMot3;

     |HAZ PonColor;

     |GRABA 020#dsarw121.n;
     |LIBERA #dsarw121;
|FPRC;

|PROCESO SacaInfo_99101;
     |QBF eaContenido;
     aLong = eaContenido % 0;
     nLong = aLong;
     |PARA nCar = 1;  |SI nCar [ nLong;  |HACIENDO nCar = nCar + 1;
           nPos = (nCar * 100) + 1
           aCar = eaContenido % nPos;

           |SI aCar = ",";  |O aCar = ".";
               nLoc = 0;
           |FINSI;

           |SI nLoc = 1;
               eaNIF = eaNIF + aCar;
               nEnc  = 1;
           |FINSI;

           |SI nLoc = 2;
               aFecha = aFecha + aCar;
               nEnc   = 2;
           |FINSI;

           |SI nLoc = 3;
               eaCotiza = eaCotiza + aCar;
               aAlfa    = eaCotiza;  |QBT aAlfa;
               aAlfa    = aAlfa % 0;
               |SI aAlfa = "15";
                   nEnc = 3;
               |FINSI;
           |FINSI;

           aPal = aPal + aCar;
           |SI aPal = "DNI ";  |O aPal = "NIE ";
               |SI nEnc = 0;
                   nLoc = 1;
               |FINSI;
           |FINSI;

           |SI aPal = "fecha ";
               |SI nEnc = 1;
                   nLoc = 2;
               |FINSI;
           |FINSI;

           |SI aPal = "cotización ";
               |SI nEnc = 2;
                   nLoc = 3;
               |FINSI;
           |FINSI;

           |SI aCar = " ";  |O aCar = ",";
               aPal = "";
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Tipo1_99101;
     |PARA enLinea = 1;  |SI;  |HACIENDO enLinea = enLinea + 1;
           |HAZ LeeContenido;
           |SI enError = 1;  |SAL;  |FINSI;

           |SI nEnc = 3;
               |SAL;
           |FINSI;

           |HAZ SacaInfo_99101;
     |SIGUE;

     |QBT eaNIF;
     |QBT eaCotiza;
     |QBT aFecha;

     eaNIF    = eaNIF % -109;
     eaCotiza = eaCotiza % -111;
     aFecha   = (aFecha % 102) + "." + (aFecha % 402) + "." + (aFecha % -104);

     aMot1   = "";
     aMot2   = "";
     aMot3   = "";
     enLinea = 1; |HAZ LeeContenido; |HAZ QuitaBlan;  aMot1 = eaContenido;
     enLinea = 2; |HAZ LeeContenido; |HAZ QuitaBlan;  aMot2 = eaContenido;
|FPRC;

|PROCESO Docu_99101;
     |SI nTipoModelo = 1;  |HAZ Tipo1_99101;  |FINSI;
|FPRC;

|PROCESO MiraSi99101;
     eaCotiza = "";
     eaNIF    = "";
     aFecha   = "";
     nEnc     = 0;

     enLinea = 1;  |HAZ LeeContenido;
     eaContenido = eaContenido - "SOBRE RECONOCIMIENTO DE BAJA:";
     |SI FSalida ! 0;
         nTipoModelo = 1;  |HAZ Docu_99101;
     |FINSI;

     |SI eaCotiza = "";  |Y aFecha = "";  |Y eaNIF = "";
         |ACABA;
     |FINSI;

     #dsarm072#0 = 991;
     #dsarm072#1 = 1;
     |LEE 000#dsarm072.=;
     |SI FSalida ! 0;  |DDEFECTO #dsarm072;  |FINSI;

     |HAZ LeeLaboral;
     |HAZ Graba121_99101;

     enChequeo = 1;
|FPRC;
