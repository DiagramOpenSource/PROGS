|FICHEROS;
     dsarz037 #0;

     dsarm001 #1;

     dsarm005 #5;
|FIN;

|VARIABLES;
     aMensaje = "";

     nRegistros = 0;
     aBusco = "";
     nDonde = 0;
     nDestino = 0;
     nGrupo = 0;
     nSubGrupo = 0;
     nTipo = 0;
     nLong = 0;
     nSaca = 0;
     aSaca = "";
     aAlfa = "";
|FIN;

|PROCESO dsarm005;
     aAlfa = #dsarm005#nDonde#;
     |QBF aAlfa;
     |SI aAlfa ! "";
          nSaca = 100 + nLong;
          aSaca = aAlfa % nSaca;
          |SI aSaca = aBusco;
               #dsarm005#nDestino# = #dsarm005#nDonde#;
               #dsarm005#nDonde# = "";
               |GRABA 020#dsarm005.a;
               nRegistros = nRegistros + 1;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsarm005;
 #dsarm005#2;
 ;
 nGrupo, nSubGrupo, nTipo, 000000001;
 nGrupo, nSubGrupo, nTipo, 999999999;
 be;
 NULL, dsarm005;
|FIN;

|PROGRAMA;
     |CLS;

     |ABRE #1;
     |LEE 000#1p;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     aBusco = "FECHA:";
     nLong = 6;
     nDonde = 28;
     nDestino = 29;

     nRegistros = 0;

     nGrupo = #1#67;
     nSubGrupo = #1#68;
     nTipo = #1#69;
     |BUCLE dsarm005;

     nGrupo = #1#89;
     nSubGrupo = #1#90;
     nTipo = #1#91;
     |BUCLE dsarm005;

     |SI nRegistros = 0;
          aMensaje = "0000No se ha modificado ningun registro.";
     |SINO;
          |SI nRegistros = 1;
               aMensaje = "0000Se ha modificado un registro.";
          |SINO;
               aMensaje = "0000Se han modificado " + nRegistros + " registros.";
          |FINSI;
     |FINSI;
     |MENAV aMensaje;
|FPRO;
