|FICHEROS;
     dsarm005 #5;
     dsarm006 #6;

     dsarw012 #912;
|FIN;

|VARIABLES;
     nPanta       = 0;
     nBoton1      = 0;
     nBoton2      = 0;
     nBoton3      = 0;
     nCampo       = 0;
     nGrid        = 0;
     nRango       = 0;

     aHora        = "";
     aEsc1        = "";
     aEsc2        = "";
     aRetu        = "";
     aTecla       = "";

     &enDocumento = 0;
|FIN;

|PROCESO Baja6;
     #6#0 = #5#0;
     #6#1 = 1;
|FPRC;

|PROCESO Alta6;
     #6#0 = #5#0;
     #6#1 = 999;
|FPRC;

|PROCESO Tipo12Fw012;  |TIPO 12;
|FPRC;

|PROCESO Evento6;
     |SI FSalida ! 1;  |ACABA;  |FINSI;

     |LEE 000#6=;
     |SI FSalida = 0;  |Y #6#0 = #5#0;
         |PARA nCampo = 0;  |SI nCampo [ 12;  |HACIENDO nCampo = nCampo + 1;
               #912nCampo = #6nCampo;
         |SIGUE;

         |SI #6#1 = #5#49;
             |ESTADO_CONTROL nBoton2, "ENABLE";
             |ESTADO_CONTROL nBoton3, "ENABLE";
         |SINO;
             |ESTADO_CONTROL nBoton2, "DISABLE";
             |ESTADO_CONTROL nBoton3, "DISABLE";
         |FINSI;
     |SINO;
         |ESTADO_CONTROL nBoton2, "DISABLE";
         |ESTADO_CONTROL nBoton3, "DISABLE";
         |DDEFECTO #912;
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ 12;  |HACIENDO nCampo = nCampo + 1;
           |C_M #912nCampo, 1, "N";
     |SIGUE;

     |PINTA #912#1;
     |PINTA #912#2;
     |PINTA #912#3;
     |PINTA #912#4;
     |PINTA #912#5;
     |PINTA #912#6;
     |PINTA #912#7;
     |PINTA #912#8;
     |PINTA #912#9;
     |PINTA #912#10;
|FPRC;

|PROCESO Boton1;
     |HAZ QuitaBotonSalir;

     |DDEFECTO #912;

     |PARA nCampo = 0;  |SI nCampo [ 12;  |HACIENDO nCampo = nCampo + 1;
           |C_M #912nCampo, 1, "N";
     |SIGUE;

     |SI #5#48 = "ENTRADA ";
         #912#2 = "SALIDA";
     |SINO;
         #912#2 = "ENTRADA";
     |FINSI;

                             |PINTA #912#2;
     |C_M #912#05, 1, "S";   |PINTA #912#5;
     |C_M #912#06, 1, "S";   |PINTA #912#6;
     |C_M #912#07, 1, "S";   |PINTA #912#7;
     |C_M #912#08, 1, "S";   |PINTA #912#8;
     |C_M #912#09, 1, "S";   |PINTA #912#9;
     |C_M #912#10, 1, "S";   |PINTA #912#10;

     |HORA aHora;

     #912#0 = #5#0;
     #912#1 = #5#49 + 1;   |PINTA #912#1;
     #912#3 = ~;           |PINTA #912#3;
     #912#4 = aHora;       |PINTA #912#4;

     |ENDATOS #1#912;
     |SI FSalida = 0;
         |PARA nCampo = 0;  |SI nCampo [ 12;  |HACIENDO nCampo = nCampo + 1;
               #6nCampo = #912nCampo;
         |SIGUE;
         |GRABA 020#6n;
         |LIBERA #6;

         #5#48   = #6#2;
         #5#49   = #6#1;
         #5#50   = #6#3;
         #5#51   = #6#4;
         #5#52   = #6#5;
         #5#53   = #6#6;
         #5#54   = #6#7;
         #5#55   = #6#8;
         #5#56   = #6#9;
         #5#57   = #6#10;
         #5#58   = #6#11;
         #5#59   = #6#12;

         |GRABA 020#5a;
         |LIBERA #5;

         |LEE 101#5=;
     |FINSI;

     |HAZ Evento6;

     |REFRESCACONTROL nGrid;
     |PULSATECLA;

     |FOCOTECLADO nGrid;

     |HAZ PonBotonSalir;
|FPRC;

|PROCESO Boton2;
     |HAZ QuitaBotonSalir;
     |DDEFECTO #912;

     |LEE 101#6=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ 12;  |HACIENDO nCampo = nCampo + 1;
           #912nCampo = #6nCampo;
     |SIGUE;

                             |PINTA #912#1;
                             |PINTA #912#2;
                             |PINTA #912#3;
                             |PINTA #912#4;
     |C_M #912#05, 1, "S";   |PINTA #912#5;
     |C_M #912#06, 1, "S";   |PINTA #912#6;
     |C_M #912#07, 1, "S";   |PINTA #912#7;
     |C_M #912#10, 1, "S";   |PINTA #912#10;

     |SI #912#2 = "SALIDA  ";
         |C_M #912#08, 1, "S";   |PINTA #912#8;
         |C_M #912#09, 1, "S";   |PINTA #912#9;
     |FINSI;

     |ENDATOS #1#912;
     |SI FSalida = 0;
         |PARA nCampo = 0;  |SI nCampo [ 12;  |HACIENDO nCampo = nCampo + 1;
               #6nCampo = #912nCampo;
         |SIGUE;
         |GRABA 020#6a;
         |LIBERA #6;

         #5#48   = #6#2;
         #5#49   = #6#1;
         #5#50   = #6#3;
         #5#51   = #6#4;
         #5#52   = #6#5;
         #5#53   = #6#6;
         #5#54   = #6#7;
         #5#55   = #6#8;
         #5#56   = #6#9;
         #5#57   = #6#10;
         #5#58   = #6#11;
         #5#59   = #6#12;

         |GRABA 020#5a;
         |LIBERA #5;

         |LEE 101#5=;
     |FINSI;

     |HAZ Evento6;

     |REFRESCACONTROL nGrid;
     |PULSATECLA;

     |FOCOTECLADO nGrid;
     |HAZ PonBotonSalir;
|FPRC;

|PROCESO Boton3;
     |CONFI "0000NEst  seguro de que quiere dar de baja la l¡nea.";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |LEE 101#6=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BORRA 020#6a;
     |LIBERA #6;

     #6#0 = #5#0;
     #6#1 = 9999;
     |LEE 000#6];
     |SI FSalida = 0;
         |LEE 000#6a;
     |SINO;
         |LEE 000#6u;
     |FINSI;

     |SI FSalida = 0;  |Y #6#0 = #5#0;
         #5#48   = #6#2;
         #5#49   = #6#1;
         #5#50   = #6#3;
         #5#51   = #6#4;
         #5#52   = #6#5;
         #5#53   = #6#6;
         #5#54   = #6#7;
         #5#55   = #6#8;
         #5#56   = #6#9;
         #5#57   = #6#10;
         #5#58   = #6#11;
         #5#59   = #6#12;
     |SINO;
         |PDEFECTO #5, 48, 60;
     |FINSI;

     |GRABA 020#5a;
     |LIBERA #5;

     |LEE 101#5=;

     |REFRESCACONTROL nGrid;
     |PULSATECLA;
     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO Tipo80Fw12;  |TIPO 80;
     |ABRET #5;
     |ABRET #6;

     FSalida = 2699;
|FPRC;

|PROCESO Tipo90Fw12;  |TIPO 90;
     |CIERRAT #5;
     |CIERRAT #6;
|FPRC;

|PROGRAMA;
     #5#0 = enDocumento;
     |LEE 101#5=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PINPA #0#912;
     nPanta = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{193}}Alta ", 1665, 1675, Boton1;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Modificar ", 1677, 1687, Boton2;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{199}}Borrar", 1689, 1699, Boton3;
     nBoton3 = FSalida;

     nRango = 2 + 4 + 8 + 16 + 32 + 128;

     |LINEAL_SIMPLE #1#6, nRango, 0602, 1598, Baja6, Alta6, Evento6;
     nGrid = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::Salir," + nGrid;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nGrid;
|FPRO;
