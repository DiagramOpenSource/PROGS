|FICHEROS;
     dsarz048 #0;

     dsarm001 #1;
     dsarm002 #2;
     dsarm003 #3;
     dsarm004 #4;
     dsarm005 #5;
|FIN;

|VARIABLES;
     nExiste = 0;
     aMensaje = "";
     aTexto = "";

     nReg = 0;
     nCuenta = 0;
     aPrograma = "";
|FIN;

|PROCESO Tipo12_z048; |TIPO 12;
|FPRC;

|PROCESO Tipo80_z048; |TIPO 80;
     FSalida = 2799;
|FPRC;


|PROCESO Tipo0C3_z048; |TIPO 0;
     |SI #dsarz048#2 = 1; |Y #dsarz048#3 = 999;
          #dsarz048#8 = "-TODOS-";
     |SINO;
          |ABRE #dsarm002;
          |DDEFECTO #dsarm002;
          #dsarm002#0 = #dsarz048#2;
          |LEE 000#dsarm002.=;
          aTexto = #dsarm002#1;
          |QBF aTexto;
          aTexto = aTexto + " - ";

          |DDEFECTO #dsarm002;
          #dsarm002#0 = #dsarz048#3;
          |LEE 000#dsarm002.=;
          aTexto = aTexto + #dsarm002#1;
          |QBF aTexto;

          #dsarz048#8 = aTexto;
     |FINSI;
     |PINTA #dsarz048#8;
|FPRC;

|PROCESO Tipo0C5_z048; |TIPO 0;
     |SI #dsarz048#4 = 1; |Y #dsarz048#5 = 999;
          #dsarz048#9 = "-TODOS-";
     |SINO;
          |SI #dsarz048#2 = #dsarz048#3;
               |ABRE #dsarm003;
               |DDEFECTO #dsarm003;
               #dsarm003#0 = #dsarz048#2;
               #dsarm003#1 = #dsarz048#4;
               |LEE 000#dsarm003.=;
               aTexto = #dsarm003#2;
               |QBF aTexto;
               aTexto = aTexto + " - ";

               |DDEFECTO #dsarm003;
               #dsarm003#0 = #dsarz048#2;
               #dsarm003#1 = #dsarz048#5;
               |LEE 000#dsarm003.=;
               aTexto = aTexto + #dsarm003#2;
               |QBF aTexto;

               #dsarz048#9 = aTexto;
          |SINO;
               #dsarz048#9 = "-MULTIPLE SELECCION-";
          |FINSI;
     |FINSI;
     |PINTA #dsarz048#9;
|FPRC;

|PROCESO Tipo0C7_z048; |TIPO 0;
     |SI #dsarz048#6 = 1; |Y #dsarz048#7 = 999;
          #dsarz048#10 = "-TODOS-";
     |SINO;
          |SI #dsarz048#2 = #dsarz048#3; |Y  #dsarz048#4 = #dsarz048#5;

               |ABRE #dsarm004;
               |DDEFECTO #dsarm004;
               #dsarm004#0 = #dsarz048#2;
               #dsarm004#1 = #dsarz048#4;
               #dsarm004#2 = #dsarz048#6;
               |LEE 000#dsarm004.=;
               aTexto = #dsarm004#3;
               |QBF aTexto;
               aTexto = aTexto + " - ";

               |DDEFECTO #dsarm004;
               #dsarm004#0 = #dsarz048#2;
               #dsarm004#1 = #dsarz048#4;
               #dsarm004#2 = #dsarz048#7;
               |LEE 000#dsarm004.=;
               aTexto = aTexto + #dsarm004#3;
               |QBF aTexto;

               #dsarz048#10 = aTexto;
          |SINO;
               #dsarz048#10 = "-MULTIPLE SELECCION-";
          |FINSI;
     |FINSI;
     |PINTA #dsarz048#10;
|FPRC;

|PROCESO Baja3;
     #dsarm003#0 = #dsarz048#2;
     #dsarm003#1 = 1;
|FPRC;

|PROCESO Alta3;
     #dsarm003#0 = #dsarz048#2;
     #dsarm003#1 = 999;
|FPRC;

|PROCESO Tipo66C4_z048; |TIPO 66;
     |SI #dsarz048#2 = #dsarz048#3;
          |ABRE #dsarm003;
          |CONSULTA_F_CLAVE #1#dsarm003, Baja3, Alta3;
          |SI FSalida = 0;
               #dsarz048#4 = #dsarm003#1;
               |PINTA #dsarz048#4;
          |FINSI;
          |CIERRA #dsarm003;
     |SINO;
          aMensaje = "0000Seleccion con F11 solo posible si Desde = Hasta Grupo";
          |MENAV aMensaje;
     |FINSI;
|FPRC;

|PROCESO Tipo66C5_z048; |TIPO 66;
     |SI #dsarz048#2 = #dsarz048#3;
          |ABRE #dsarm003;
          |CONSULTA_F_CLAVE #1#dsarm003, Baja3, Alta3;
          |SI FSalida = 0;
               #dsarz048#5 = #dsarm003#1;
               |PINTA #dsarz048#5;
          |FINSI;
          |CIERRA #dsarm003;
     |SINO;
          aMensaje = "0000Seleccion con F11 solo posible si Desde = Hasta Grupo";
          |MENAV aMensaje;
     |FINSI;
|FPRC;

|PROCESO Baja4;
     #dsarm004#0 = #dsarz048#2;
     #dsarm004#1 = #dsarz048#4;
     #dsarm004#2 = 1;
|FPRC;

|PROCESO Alta4;
     #dsarm004#0 = #dsarz048#2;
     #dsarm004#1 = #dsarz048#4;
     #dsarm004#2 = 999;
|FPRC;

|PROCESO Tipo66C6_z048; |TIPO 66;
     |SI #dsarz048#2 = #dsarz048#3; |Y  #dsarz048#4 = #dsarz048#5;
          |ABRE #dsarm004;
          |CONSULTA_F_CLAVE #1#dsarm004, Baja4, Alta4;
          |SI FSalida = 0;
               #dsarz048#6 = #dsarm004#2;
               |PINTA #dsarz048#6;
          |FINSI;
          |CIERRA #dsarm004;
     |SINO;
          aMensaje = "0000Seleccion con F11 solo posible si Desde = Hasta Grupo/SubGrupo";
          |MENAV aMensaje;
     |FINSI;
|FPRC;

|PROCESO Tipo66C7_z048; |TIPO 66;
     |SI #dsarz048#2 = #dsarz048#3; |Y  #dsarz048#4 = #dsarz048#5;
          |ABRE #dsarm004;
          |CONSULTA_F_CLAVE #1#dsarm004, Baja4, Alta4;
          |SI FSalida = 0;
               #dsarz048#7 = #dsarm004#2;
               |PINTA #dsarz048#7;
          |FINSI;
          |CIERRA #dsarm004;
     |SINO;
          aMensaje = "0000Seleccion con F11 solo posible si Desde = Hasta Grupo/SubGrupo";
          |MENAV aMensaje;
     |FINSI;
|FPRC;

|PROCESO dsarm005;
     |SI #dsarm005#4 ] #dsarz048#11; |Y #dsarm005#4 [ #dsarz048#12;
          |SI nCuenta = 1;
               nReg = nReg + 1;
          |SINO;
               aPrograma = "dsarz030;" + #dsarm005#0;
               |SUB_EJECUTA aPrograma;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsarm005;
 #dsarm005#2;
 ;
 #dsarz048#2, #dsarz048#4, #dsarz048#6, #dsarz048#13;
 #dsarz048#3, #dsarz048#5, #dsarz048#7, #dsarz048#14;
 ;
 NULL, dsarm005;
|FIN;

|PROCESO Principal;
     nReg = 0;

     nCuenta = 1;
     |BUCLE dsarm005;

     |SI nReg = 0;
          aMensaje = "0000Selecci¢n vacia. Proceso cancelado";
          |MENAV aMensaje;
     |SINO;
          |SI nReg = 1;
               aMensaje = "0000NSeleccionado 1 registro. Aplicar Reglas?";
          |SINO;
               aMensaje = "0000NSeleccionados " + nReg + " registros. Aplicar Reglas?";
          |FINSI;
          |CONFI aMensaje;
          |SI FSalida = 0;
               nCuenta = 0;
               |BUCLE dsarm005;
          |FINSI;
     |FINSI;
|FPRC;

|PROGRAMA;
     |CLS;
     |ABRE #dsarm001;
     |LEE 000#dsarm001.p;
     |SI FSalida ! 0; |DDEFECTO #dsarm001; |FINSI;
     |CIERRA #dsarm001;

     |ABRE #0;
     |DDEFECTO #0;
     |LEE 101#0p;
     nExiste = FSalida;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |SI nExiste = 0;
               |GRABA 020#0a;
          |SINO;
               |GRABA 020#0n;
          |FINSI;
          |HAZ Principal;
     |FINSI;
     |LIBERA #0;
     |CIERRA #0;
|FPRO;
