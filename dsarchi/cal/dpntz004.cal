|FICHEROS;
     dpntz004 #0;

     dpntm000;
     dpntm001;
     dpntw006;
|FIN;

|VARIABLES;
     nTodos       = 0;
     nCampo       = 0;
     nRango       = 0;
     nGrid        = 0;
     nPanta       = 0;
     nHasta       = 0;
     nEnviar      = 0;
     nBtnEnvio    = -1;
     nBtnAceptar  = -1;
     nBtnCancelar = -1;

     aFicTmp      = "";
     aAlfa        = "";
     aMarca       = "";
     aQueBoton    = "";
     aID          = "";
     aVerde       = "0,185,0;255,255,255";

     &eaAlfa      = "";
     &eaParamA    = "";
     &eaParamD    = "";
     &eaParamT    = "";
     &eaParamU    = "";
     &eaParamM    = "";
|FIN;

|PROCESO Ptec806;
     |PTEC 806;

     nEnviar = 1;
|FPRC;

|PROCESO Ptec807;
     |PTEC 807;
|FPRC;

|PROCESO dpntw006Envia;
     eaParamT = "cliente";
     eaParamU = #dpntw006#1;   |QBF eaParamU;
     |HAZ LanzaPush;
|FPRC;

|DEFBUCLE dpntw006Envia;
     #dpntw006#2;
     ;
     "*", 00001;
     "*", 99999;
     ;
     NULL, dpntw006Envia;
|FIN;

|PROCESO Tipo12;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     |SI nEnviar = 0;
         |ERROR;
     |FINSI;

     |SELECT #2#dpntw006;
     #dpntw006#5 = "*";
     #dpntw006#0 = 1;
     |LEE 000#dpntw006.];
     |SI FSalida ! 0;  |O #dpntw006#5 = " ";
         |MENAV "0000No hay registros marcados.";
         |ERROR;
         |ACABA;
     |FINSI;

     nTodos = 1;

     |SELECT #2#dpntw006;
     #dpntw006#5 = " ";
     #dpntw006#0 = 1;
     |LEE 000#dpntw006.];
     |SI FSalida = 0;  |Y #dpntw006#5 = " ";
         nTodos = 0;
     |FINSI;

     |ABRE #dpntm000;
     |LEE 000#dpntm000.p;
     |SI FSalida ! 0;  |DDEFECTO #dpntm000;  |FINSI;
     |CIERRA #dpntm000;

     |PARA nCampo = 4;  |SI nCampo ] 0;   |HACIENDO nCampo = nCampo - 1;
           aAlfa = #dpntz004#nCampo#;  |QBF aAlfa;
           |SI aAlfa ! "";  |SAL;  |FINSI;
     |SIGUE;

     nHasta = nCampo;
     eaAlfa = "";
     |PARA nCampo = 0;  |SI nCampo [ nHasta;   |HACIENDO nCampo = nCampo + 1;
           |SI eaAlfa = "";
               eaAlfa = #dpntz004#nCampo#;
           |SINO;
               eaAlfa = eaAlfa + " \n " + #dpntz004#nCampo#;
           |FINSI;
           |QBF eaAlfa;
     |SIGUE;

     eaParamM = eaAlfa;
     eaParamA = #dpntm000#1;   |QBF eaParamA;        || Nombre despacho

     eaParamD = "";
     |SI nTodos = 1;
         eaParamU = "";
         eaParamT = "asesoria";
         |HAZ LanzaPush;
     |SINO;
         |BUCLE dpntw006Envia;
     |FINSI;
|FPRC;

|PROCESO Tipo7;  |TIPO 7;
     |SI nBtnEnvio ! -1;  |ACABA;  |FINSI;

     aQueBoton   = "|X000";
     aID         = #dpntz004#aQueBoton#;
     nBtnAceptar = aID;
     |ESTADO_CONTROL nBtnAceptar, "HIDE";

     aQueBoton    = "|X001";
     aID          = #dpntz004#aQueBoton#;
     nBtnCancelar = aID;
     |ESTADO_CONTROL nBtnCancelar, "HIDE";

     |CONTROL_SIMPLE 0, "BOTON,{{230}}Enviar", 3588, 3598, Ptec806;
     |CONTROL_SIMPLE 0, "BOTON,{{207}}Cancelar", 3575, 3585, Ptec807;
|FPRC;

|PROCESO Evnt;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#dpntw006.=;
     |FINSI;

     |SI FSalida = 4;
         |LEE 101#dpntw006.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |SI #dpntw006#5 = " ";
             #dpntw006#5 = "*";
             #dpntw006#6 = aVerde;
         |SINO;
             #dpntw006#5 = "";
             #dpntw006#6 = "";
         |FINSI;

         |GRABA 020#dpntw006.a;
         |LIBERA #dpntw006;

         |REFRESCACONTROL nGrid;
     |FINSI;
|FPRC;

|PROCESO dpntw006Marca;
     |SI aMarca = "*";
         #dpntw006#5 = "*";
         #dpntw006#6 = aVerde;
     |SINO;
         #dpntw006#5 = "";
         #dpntw006#6 = "";
     |FINSI;

     |GRABA 020#dpntw006.a;
     |LIBERA #dpntw006;
|FPRC;

|DEFBUCLE dpntw006Marca;
     #dpntw006#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dpntw006Marca;
|FIN;

|PROCESO Todos;
     aMarca = "*";
     |BUCLE dpntw006Marca;

     |REFRESCACONTROL nGrid;
|FPRC;

|PROCESO Ninguno;
     aMarca = "";
     |BUCLE dpntw006Marca;

     |REFRESCACONTROL nGrid;
|FPRC;

|PROGRAMA;
     |PINPA #0#dpntz004;
     nPanta = FSalida;

     nRango = 4 + 8 + 16 + 32;
     |LINEAL_SIMPLE #1#dpntw006, nRango, 0502, 2698, NULL, NULL, Evnt;
     nGrid = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Marcar todos", 2702, 2720, Todos;
     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Desmarcar todos", 2722, 2740, Ninguno;
     |CONTROL_SIMPLE nPanta, "LABEL,{{7}}Doble click en el registro para marcar o desmarcar el registro", 2745, 2799, NULL;

     |PINDA #0#dpntz004;
     |ENDATOS #1#dpntz004;
|FPRO;

|PROCESO dpntm001;
     #dpntw006#0 = #dpntm001#0;
     #dpntw006#1 = #dpntm001#1;
     #dpntw006#2 = #dpntm001#2;
     #dpntw006#3 = #dpntm001#9;
     #dpntw006#4 = #dpntm001#10;
     #dpntw006#5 = "";
     #dpntw006#6 = "";
     |GRABA 020#dpntw006.n;
     |LIBERA #dpntw006;
|FPRC;

|DEFBUCLE dpntm001;
     #dpntm001#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dpntm001;
|FIN;

|PROCESO Tipo80;  |TIPO 80;
     aFicTmp = "dpntw006" + Usuario;
     |NOME_DAT #dpntw006#aFicTmp#;
     |ABRE #dpntw006;  |CIERRA #dpntw006;  |DELINDEX #dpntw006;

     |ABRET #dpntw006;
     |BUCLE dpntm001;

     |LEE 000#dpntw006.p;

     nEnviar = 0;
     FSalida = 3599;
|FPRC;

|PROCESO Tipo90;  |TIPO 90;
     |CIERRAT #dpntw006;
     |DELINDEX #dpntw006;
|FPRC;
