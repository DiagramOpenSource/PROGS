|FICHEROS;
     dpntm001;
     dpntm007;

     :laboral/labcentr;
|FIN;

|VARIABLES;
     n0Vent         = 0;
     nBtnNue        = 0;
     nBtnQui        = 0;
     nRango         = 0;

     aEsc1          = "";
     aEsc2          = "";
     aRetu          = "";
     aTecla         = "";
     aAlfa          = "";
     aHora          = "";
     aFecha         = "";
     aPathLab       = "";
     aMas           = "";

     fFecha         = @;

 {-1}aVent          = "";
     aVent1         = 0;
     aVent2         = 0;
     aVent3         = 0;
     aVent4         = 0;
     aVent5         = "";

     &enEmpresa       = 0;
     &enGridC         = 0;
     &enGrid7         = 0;
     &eaModoNet       = "";
     &eaUsuNet        = "";
     &eaFechaNet      = "";
     &eaAccesoNet     = "";
     &eaEmpNet        = "";
     &eaTraNet        = "";
     &eaAccNet        = "";
     &eaMaiNet        = "";
     &eaDesNet        = "";
     &eaLabNet        = "";
|FIN;

|PROCESO QuitarAcceso;
     |CONFI "0000NSeguro que quiere quitar el acceso";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |LEE 101#dpntm007.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BORRA 020#dpntm007.a;
     |LIBERA #dpntm007;

     |REFRESCACONTROL enGrid7;
     |FOCOTECLADO enGrid7;
|FPRC;

|PROCESO Evnt7;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#dpntm007.=;

         |ESTADO_CONTROL nBtnQui, "ENABLE";
         |ESTADO_CONTROL nBtnQui, "ENABLE";
     |FINSI;

     |SI FSalida = 4;
     |FINSI;
|FPRC;

|PROCESO Baja7;
     #dpntm007#0 = #dpntm001#0;
     #dpntm007#1 = #labcentr#1;
     #dpntm007#2 = 001;
|FPRC;

|PROCESO Alta7;
     #dpntm007#0 = #dpntm001#0;
     #dpntm007#1 = #labcentr#1;
     #dpntm007#2 = 999;
|FPRC;

|PROCESO EvntC;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#labcentr.=;

         |ESTADO_CONTROL nBtnNue, "ENABLE";

         |REFRESCACONTROL enGrid7;
     |FINSI;
|FPRC;

|PROCESO BajaC;
     #labcentr#0 = #dpntm001#0;
     #labcentr#1 = 001;
|FPRC;

|PROCESO AltaC;
     #labcentr#0 = #dpntm001#0;
     #labcentr#1 = 999;
|FPRC;

|PROGRAMA;
     |DBASS aPathLab;
     aMas  = aPathLab + "laboral/def/labcentr.mas";
     |XABRE "E", aMas, 0;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |CLS;
     |CABEZA "Accesos centros de trabajo DESPABOX";

     aAlfa = "Accesos Centros de Trabajo de la empresa DESPABOX " + #dpntm001#2;  |QBF aAlfa;
     |VENTANA 0501, 2899, -1, 16, aAlfa;
     n0Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |CONTROL_SIMPLE 0, "BOTON,Nuevo acceso", 2502, 2614, NuevoAcceso;
     nBtnNue = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,Quitar acceso", 2516, 2628, QuitarAcceso;
     nBtnQui = FSalida;

     |CONTROL_SIMPLE 0, "LABEL,{{15}}Centros de trabajo", 0502, 0550, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{15}}Acceso del centro", 1402, 1450, NULL;

     |ESTADO_CONTROL nBtnNue, "DISABLE";
     |ESTADO_CONTROL nBtnQui, "DISABLE";
     |ESTADO_CONTROL nBtnQui, "DISABLE";

     nRango = 4 + 8 + 16 + 32 + 128;

     |LINEAL_SIMPLE #1#labcentr, nRango, 0602, 1198, BajaC, AltaC, EvntC;
     enGridC = FSalida;

     |LINEAL_SIMPLE #1#dpntm007, nRango, 1502, 2498, Baja7, Alta7, Evnt7;
     enGrid7 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + enGridC;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |DESTRUYECONTROL enGridC;
     |DESTRUYECONTROL enGrid7;

     |FIN_CONTROL_WINDOWS nBtnNue;
     |FIN_CONTROL_WINDOWS nBtnQui;
     |FIN_CONTROL_WINDOWS nBtnQui;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n0Vent;
|FPRO;

|PROCESO T80;  |TIPO 80;
     |DBASS aPathLab;
     aMas  = aPathLab + "laboral/def/labcentr.mas";
     |XABRE "E", aMas, 0;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     aPathLab = aPathLab + "laboral/fich/";
     |PATH_DAT #labcentr#aPathLab#;

     |ABRET #dpntm001;
     |ABRET #dpntm007;
     |ABRET #labcentr;

     #dpntm001#0 = enEmpresa;
     |LEE 000#dpntm001.=;
|FPRC;

|PROCESO T90;  |TIPO 90;
     |CIERRAT #dpntm001;
     |CIERRAT #dpntm007;
     |CIERRAT #labcentr;
|FPRC;
