|FICHEROS;
     dsarw069,MANTE;
     dsarw070,MANTE;

     dsarm034;
     dsarm035,MANTE;
     dsarm036;

     :basica/agicen14;

     &regisnif@;
|FIN;

|VARIABLES;
     nTotLin = 0;

     nSwEsImporte = 0;
     nCampoEstoy = 0;

     &eaDimeActividad = "";
     &eaProcesoPIInte = "";
     &efFechaInte = @;
     &eaHoraInte = "";
     &eaFicInte = "";

     &enCodPrimeraInc = 0;
     &eaPrimeraInc = "";
     &enSwAvisaInte = 0;
     &enResultadoInte = 0;
     &enCodIncidencia = 0;
     &eaIncidencia = "";

     &enNumCampoPPI = 0;
     &eaValorPPI = "";
     &eaValorPPI2 = "";
     &eaValorPPI3 = "";
     &eaValorPPI4 = "";
     &eaValorPPI5 = "";
     &eaValorPPI6 = "";

     aMensaje = "";
     aCampoAntes = "";
     aCampoAhora = "";

     nOpcion        = 0;
     nTotalLinea    = 0;
     nConta         = 0;
     nBaffer        = 0;
     nCogeOpcion    = 0;
     nError         = 0;
     nPos           = 0;
     nComp          = 0;
     nLCod          = 0;
     nVentana       = 0;
     nCalc          = 0;
     nID            = 0;
     nEmpresa       = 0;
     nActiv         = 0;
     nValor         = 0;
     nVentw6        = 0;

     aAlfa          = "";
     aContenido     = "";
     aTabla         = "";
     aFTabla        = "";
     aDestino       = "";
     aAlfa1         = "";
     aID            = "";
     aVar           = "";
     aLetra         = "";

  {20}aPopup        = "";

     {-1}aVent      = "";
         aVent1     = 0;
         aVent2     = 0;
         aVent3     = 0;
         aVent4     = 0;
         aVent5     = "";

     {28}nLabel     = -1;
     {27}nValLabel  = 0;

     &eaVarDni      = "";
     &enCalcCif     = 0;
     &eaCodNif      = "";
     &eaAlfa        = "";
     &enError       = 0;
     &eaUsuario     = "";
     &eaValor       = "";
     &eaVar         = "";
     &enProveedor   = 0;
     &enNIF         = 0;

     &enBotonProv        = -1;
     &enPantallaFR000000 = 0;
     &enModoFormulario   = 0;
     &enIdeCli        = 0;
     &eaNomCli        = "";
     &eaNifCli        = "";
     &eaMaiCli        = "";
     &eaTelCli        = "";
     &eaIdeNif        = "";
     &eaNomNif        = "";
|FIN;

|PROCESO ControlRelaciones;
     |DBASS aAlfa;
     aAlfa = aAlfa + "/integral/def/dsam0000.mas";
     |XABRE "E", aAlfa, 0;
     |SI FSalida ] 0;
         |MODO_RELACION #dsarw069, 0, "dsam0103", "X", "X";
         |MODO_RELACION #dsarw069, 1, "dsam0103", "N", "S";
         |MODO_RELACION #dsarw069, 1, "agim0003", "N", "N";
         |MODO_RELACION #dsarw069, 1, "agim0003", "X", "X";
     |SINO;
         |MODO_RELACION #dsarw069, 0, "agim0003", "X", "X";
         |MODO_RELACION #dsarw069, 1, "agim0003", "N", "S";
         |MODO_RELACION #dsarw069, 1, "dsam0103", "N", "N";
         |MODO_RELACION #dsarw069, 1, "dsam0103", "X", "X";
     |FINSI;

     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;
|FPRC;

|PROCESO PantaProveedor;
     |VENTANA 0501, 1799, -1, 16, "Datos proveedor";
     nVentw6  = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentw6;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     #dsarw070#0 = #dsarw069#2;
     #dsarw070#1 = #dsarw069#4;
     #dsarw070#2 = #dsarw069#5;
     #dsarw070#3 = #dsarw069#47;
     #dsarw070#4 = #dsarw069#51;
     #dsarw070#5 = #dsarw069#52;
     #dsarw070#6 = #dsarw069#53;
     #dsarw070#7 = #dsarw069#54;
     #dsarw070#8 = #dsarw069#55;
     #dsarw070#9 = #dsarw069#56;

     |PINPA #0#dsarw070;

     |C_M #dsarw070#1, 1, "S";
     |C_M #dsarw070#2, 1, "S";
     |C_M #dsarw070#3, 1, "S";
     |C_M #dsarw070#4, 1, "S";
     |C_M #dsarw070#5, 1, "S";
     |C_M #dsarw070#6, 1, "S";
     |C_M #dsarw070#7, 1, "S";
     |C_M #dsarw070#8, 1, "S";

     |SI enNIF = 0;
         |C_M #dsarw070#1, 1, "N";
         |C_M #dsarw070#2, 1, "N";
         |C_M #dsarw070#3, 1, "N";
         |C_M #dsarw070#4, 1, "N";
         |C_M #dsarw070#5, 1, "N";
         |C_M #dsarw070#6, 1, "N";
         |C_M #dsarw070#7, 1, "N";
         |C_M #dsarw070#8, 1, "N";
     |FINSI;

     |PINDA #0#dsarw070;

     |SI enModoFormulario = 0;
         |ENDATOS #1#dsarw070;
     |SINO;
         |PAUSA;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentw6;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentw6;

     |POSICIONATE #dsarw069#2;
|FPRC;

|PROCESO DatosProveedor;
     |HAZ ControlRelaciones;

     |SI enBotonProv ! -1;
         |FIN_CONTROL_WINDOWS enBotonProv;
     |FINSI;

     eaCodNif  = #dsarw069#2;
     |HAZ LeeNifs;

     |ABRE #regisnif@;
     #regisnif@#0 = #dsarw069#2;
     |LEE 000#regisnif@.=;
     |SI FSalida = 0;
         enNIF = 0;
         aAlfa = "BOTON,Proveedor registrado";
     |SINO;
         enNIF = 1;
         aAlfa = "BOTON,     Proveedor nuevo.   Editar datos";
     |FINSI;
     |CIERRA #regisnif@;

     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 1081, 1198, PantaProveedor;
     enBotonProv = FSalida;
|FPRC;

|PROCESO GrabaVariable;
     |ABRE #dsarm036;
     |DDEFECTO #dsarm036;
     #dsarm036#0 = eaProcesoPIInte;
     #dsarm036#1 = eaVar;
     |LEE 000#dsarm036.=;
     |SI FSalida ! 0;  |CIERRA #dsarm036;  |ACABA;  |FINSI;
     |CIERRA #dsarm036;

     #dsarm035#0 = #dsarm034#0;
     #dsarm035#1 = #dsarm034#1;
     #dsarm035#2 = #dsarm034#2;
     #dsarm035#3 = eaVar;
     |LEE 101#dsarm035.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsarm035;
          #dsarm035#0 = #dsarm034#0;
          #dsarm035#1 = #dsarm034#1;
          #dsarm035#2 = #dsarm034#2;
          #dsarm035#3 = eaVar;
          |GRABA 020#dsarm035.b;
     |FINSI;

     #dsarm035#4  = eaValor;
     #dsarm035#9  = "*SIN CAMBIOS*";
     #dsarm035#8  = "";
     #dsarm035#10 = #dsarm036#9;
     |GRABA 020#dsarm035.a;
     |LIBERA #dsarm035;
|FPRC;

|PROCESO LeeVariable;
     #dsarm035#0 = #dsarm034#0;
     #dsarm035#1 = #dsarm034#1;
     #dsarm035#2 = #dsarm034#2;
     #dsarm035#3 = aVar;
     |LEE 000#dsarm035.=;
     |SI FSalida ! 0;  |DDEFECTO #dsarm035;  |FINSI;

     nValor = 0;
     aAlfa  = #dsarm035#8;  |QBF aAlfa;
     |SI aAlfa = "255,0,0;255,255,255";  nValor = 1;  |FINSI;
|FPRC;

|PROCESO ControlaVar;
     nValLabel1  = 0;  nValLabel2  = 0;  nValLabel3  = 0;  nValLabel4  = 0;
     nValLabel5  = 0;  nValLabel6  = 0;  nValLabel7  = 0;  nValLabel8  = 0;
     nValLabel9  = 0;  nValLabel10 = 0;  nValLabel11 = 0;  nValLabel12 = 0;
     nValLabel13 = 0;  nValLabel14 = 0;  nValLabel15 = 0;  nValLabel16 = 0;
     nValLabel17 = 0;  nValLabel18 = 0;  nValLabel19 = 0;  nValLabel20 = 0;
     nValLabel21 = 0;  nValLabel22 = 0;  nValLabel23 = 0;  nValLabel24 = 0;
     nValLabel25 = 0;

     aVar = "FR000000_actividad";         |HAZ LeeVariable;  nValLabel1  = nValor;
     aVar = "FR000000_total";             |HAZ LeeVariable;  nValLabel2  = nValor;
     aVar = "FR000000_pronif";            |HAZ LeeVariable;  nValLabel3  = nValor;
     aVar = "FR000000_reprelegal";        |HAZ LeeVariable;  nValLabel4  = nValor;
     aVar = "FR000000_pronom";            |HAZ LeeVariable;  nValLabel5  = nValor;
     aVar = "FR000000_pais";              |HAZ LeeVariable;  nValLabel6  = nValor;
     aVar = "FR000000_idpaisre";          |HAZ LeeVariable;  nValLabel7  = nValor;
     aVar = "FR000000_numidfiscalpais";   |HAZ LeeVariable;  nValLabel8  = nValor;
     aVar = "FR000000_cloperacion";       |HAZ LeeVariable;  nValLabel9  = nValor;
     aVar = "FR000000_nf";                |HAZ LeeVariable;  nValLabel10 = nValor;
     aVar = "FR000000_nr";                |HAZ LeeVariable;  nValLabel11 = nValor;
     aVar = "FR000000_primern";           |HAZ LeeVariable;  nValLabel12 = nValor;
     aVar = "FR000000_ultimon";           |HAZ LeeVariable;  nValLabel13 = nValor;
     aVar = "FR000000_idfactura";         |HAZ LeeVariable;  nValLabel14 = nValor;
     aVar = "FR000000_idfacrec";          |HAZ LeeVariable;  nValLabel15 = nValor;
     aVar = "FR000000_fechaexpe";         |HAZ LeeVariable;  nValLabel16 = nValor;
     aVar = "FR000000_fechaope";          |HAZ LeeVariable;  nValLabel17 = nValor;
     aVar = "FR000000_bieninve";          |HAZ LeeVariable;  nValLabel18 = nValor;
     aVar = "FR000000_desbieninve";       |HAZ LeeVariable;  nValLabel19 = nValor;
     aVar = "FR000000_obs";               |HAZ LeeVariable;  nValLabel20 = nValor;

     aVar = "FR000000_base1";  |HAZ LeeVariable;  nValLabel21 = nValor;
     |SI nValLabel21 = 0;  aVar = "FR000000_base2";  |HAZ LeeVariable;  nValLabel21 = nValor;  |FINSI;
     |SI nValLabel21 = 0;  aVar = "FR000000_base3";  |HAZ LeeVariable;  nValLabel21 = nValor;  |FINSI;
     |SI nValLabel21 = 0;  aVar = "FR000000_base4";  |HAZ LeeVariable;  nValLabel21 = nValor;  |FINSI;
     |SI nValLabel21 = 0;  aVar = "FR000000_base5";  |HAZ LeeVariable;  nValLabel21 = nValor;  |FINSI;

     aVar = "FR000000_iva1";  |HAZ LeeVariable;  nValLabel22 = nValor;
     |SI nValLabel22 = 0;  aVar = "FR000000_iva2";  |HAZ LeeVariable;  nValLabel22 = nValor;  |FINSI;
     |SI nValLabel22 = 0;  aVar = "FR000000_iva3";  |HAZ LeeVariable;  nValLabel22 = nValor;  |FINSI;
     |SI nValLabel22 = 0;  aVar = "FR000000_iva4";  |HAZ LeeVariable;  nValLabel22 = nValor;  |FINSI;
     |SI nValLabel22 = 0;  aVar = "FR000000_iva5";  |HAZ LeeVariable;  nValLabel22 = nValor;  |FINSI;

     aVar = "FR000000_cuotaiva1";  |HAZ LeeVariable;  nValLabel23 = nValor;
     |SI nValLabel23 = 0;  aVar = "FR000000_cuotaiva2";  |HAZ LeeVariable;  nValLabel23 = nValor;  |FINSI;
     |SI nValLabel23 = 0;  aVar = "FR000000_cuotaiva3";  |HAZ LeeVariable;  nValLabel23 = nValor;  |FINSI;
     |SI nValLabel23 = 0;  aVar = "FR000000_cuotaiva4";  |HAZ LeeVariable;  nValLabel23 = nValor;  |FINSI;
     |SI nValLabel23 = 0;  aVar = "FR000000_cuotaiva5";  |HAZ LeeVariable;  nValLabel23 = nValor;  |FINSI;

     aVar = "FR000000_re1";  |HAZ LeeVariable;  nValLabel24 = nValor;
     |SI nValLabel24 = 0;  aVar = "FR000000_re2";  |HAZ LeeVariable;  nValLabel24 = nValor;  |FINSI;
     |SI nValLabel24 = 0;  aVar = "FR000000_re3";  |HAZ LeeVariable;  nValLabel24 = nValor;  |FINSI;
     |SI nValLabel24 = 0;  aVar = "FR000000_re4";  |HAZ LeeVariable;  nValLabel24 = nValor;  |FINSI;
     |SI nValLabel24 = 0;  aVar = "FR000000_re5";  |HAZ LeeVariable;  nValLabel24 = nValor;  |FINSI;

     aVar = "FR000000_cuotare1";  |HAZ LeeVariable;  nValLabel25 = nValor;
     |SI nValLabel25 = 0;  aVar = "FR000000_cuotare2";  |HAZ LeeVariable;  nValLabel25 = nValor;  |FINSI;
     |SI nValLabel25 = 0;  aVar = "FR000000_cuotare3";  |HAZ LeeVariable;  nValLabel25 = nValor;  |FINSI;
     |SI nValLabel25 = 0;  aVar = "FR000000_cuotare4";  |HAZ LeeVariable;  nValLabel25 = nValor;  |FINSI;
     |SI nValLabel25 = 0;  aVar = "FR000000_cuotare5";  |HAZ LeeVariable;  nValLabel25 = nValor;  |FINSI;

     aVar = "FR000000_reten1";  |HAZ LeeVariable;  nValLabel26 = nValor;
     |SI nValLabel26 = 0;  aVar = "FR000000_reten2";  |HAZ LeeVariable;  nValLabel26 = nValor;  |FINSI;
     |SI nValLabel26 = 0;  aVar = "FR000000_reten3";  |HAZ LeeVariable;  nValLabel26 = nValor;  |FINSI;
     |SI nValLabel26 = 0;  aVar = "FR000000_reten4";  |HAZ LeeVariable;  nValLabel26 = nValor;  |FINSI;
     |SI nValLabel26 = 0;  aVar = "FR000000_reten5";  |HAZ LeeVariable;  nValLabel26 = nValor;  |FINSI;

     aVar = "FR000000_cuotareten1";  |HAZ LeeVariable;  nValLabel27 = nValor;
     |SI nValLabel27 = 0;  aVar = "FR000000_cuotareten2";  |HAZ LeeVariable;  nValLabel27 = nValor;  |FINSI;
     |SI nValLabel27 = 0;  aVar = "FR000000_cuotareten3";  |HAZ LeeVariable;  nValLabel27 = nValor;  |FINSI;
     |SI nValLabel27 = 0;  aVar = "FR000000_cuotareten4";  |HAZ LeeVariable;  nValLabel27 = nValor;  |FINSI;
     |SI nValLabel27 = 0;  aVar = "FR000000_cuotareten5";  |HAZ LeeVariable;  nValLabel27 = nValor;  |FINSI;
|FPRC;

|PROCESO  PintaLabels;
     |SI enPantallaFR000000 = -1;  |ACABA;  |FINSI;

     |HAZ ControlaVar;

     |SI nLabel1  ! -1;  |FIN_CONTROL_WINDOWS nLabel1;   |FINSI;
     |SI nLabel2  ! -1;  |FIN_CONTROL_WINDOWS nLabel2;   |FINSI;
     |SI nLabel3  ! -1;  |FIN_CONTROL_WINDOWS nLabel3;   |FINSI;
     |SI nLabel4  ! -1;  |FIN_CONTROL_WINDOWS nLabel4;   |FINSI;
     |SI nLabel5  ! -1;  |FIN_CONTROL_WINDOWS nLabel5;   |FINSI;
     |SI nLabel6  ! -1;  |FIN_CONTROL_WINDOWS nLabel6;   |FINSI;
     |SI nLabel7  ! -1;  |FIN_CONTROL_WINDOWS nLabel7;   |FINSI;
     |SI nLabel8  ! -1;  |FIN_CONTROL_WINDOWS nLabel8;   |FINSI;
     |SI nLabel9  ! -1;  |FIN_CONTROL_WINDOWS nLabel9;   |FINSI;
     |SI nLabel10 ! -1;  |FIN_CONTROL_WINDOWS nLabel10;  |FINSI;
     |SI nLabel11 ! -1;  |FIN_CONTROL_WINDOWS nLabel11;  |FINSI;
     |SI nLabel12 ! -1;  |FIN_CONTROL_WINDOWS nLabel12;  |FINSI;
     |SI nLabel13 ! -1;  |FIN_CONTROL_WINDOWS nLabel13;  |FINSI;
     |SI nLabel14 ! -1;  |FIN_CONTROL_WINDOWS nLabel14;  |FINSI;
     |SI nLabel15 ! -1;  |FIN_CONTROL_WINDOWS nLabel15;  |FINSI;
     |SI nLabel16 ! -1;  |FIN_CONTROL_WINDOWS nLabel16;  |FINSI;
     |SI nLabel17 ! -1;  |FIN_CONTROL_WINDOWS nLabel17;  |FINSI;
     |SI nLabel18 ! -1;  |FIN_CONTROL_WINDOWS nLabel18;  |FINSI;
     |SI nLabel19 ! -1;  |FIN_CONTROL_WINDOWS nLabel19;  |FINSI;
     |SI nLabel20 ! -1;  |FIN_CONTROL_WINDOWS nLabel20;  |FINSI;
     |SI nLabel21 ! -1;  |FIN_CONTROL_WINDOWS nLabel21;  |FINSI;
     |SI nLabel22 ! -1;  |FIN_CONTROL_WINDOWS nLabel22;  |FINSI;
     |SI nLabel23 ! -1;  |FIN_CONTROL_WINDOWS nLabel23;  |FINSI;
     |SI nLabel24 ! -1;  |FIN_CONTROL_WINDOWS nLabel24;  |FINSI;
     |SI nLabel25 ! -1;  |FIN_CONTROL_WINDOWS nLabel25;  |FINSI;
     |SI nLabel26 ! -1;  |FIN_CONTROL_WINDOWS nLabel26;  |FINSI;
     |SI nLabel27 ! -1;  |FIN_CONTROL_WINDOWS nLabel27;  |FINSI;
     |SI nLabel28 ! -1;  |FIN_CONTROL_WINDOWS nLabel28;  |FINSI;

     |SI #dsarm034#18 = 0;
         aAlfa = "LABEL,{{16}}Empresa contabilidad no detectada";
     |SINO;
         enIdeCli = #dsarm034#18;
         |HAZ LeeCliente;

         aAlfa = "LABEL,{{16}}" + (("000000" + #dsarm034#18) % -106) + "/" + #dsarm034#19;
         aAlfa = aAlfa + " " + eaNomCli;   |QBF aAlfa;
     |FINSI;

     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 632, 798, NULL;
     nLabel28 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel1  ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "Actividad";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 802, 810, NULL;
     nLabel1 = FSalida;

                          aLetra = "{{2}}";
     |SI nValLabel2  ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "Importe total factura";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 868, 885, NULL;
     nLabel2 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel3  ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "NIF del declarado";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 1002, 1018, NULL;
     nLabel3 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel4  ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "Representante legal";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 1019, 1036, NULL;
     nLabel4 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel5  ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "Apellidos y nombre";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 1038, 1056, NULL;
     nLabel5 = FSalida;

     || nLabel6 era el pais y se ha quitado.

                          aLetra = "{{0}}";
     |SI nValLabel7  ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "Clave identificaci¢n Pais Residencia";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 1202, 1234, NULL;
     nLabel7 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel8  ! 0; aLetra = "{{3}}";  |FINSI;

     aAlfa = "LABEL," + aLetra + "N§.Iden.Fiscal Pais Res.";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 1279, 1299, NULL;
     nLabel8 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel9  ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "Clave de operaci¢n";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 1402, 1419, NULL;
     nLabel9 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel10 ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "N§.Factura";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 1602, 1611, NULL;
     nLabel10 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel11 ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "NR";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 1613, 1615, NULL;
     nLabel11 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel12 ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "Primer n£mero";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 1618, 1630, NULL;
     nLabel12 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel13 ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "Ultimo n£mero";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 1659, 1671, NULL;
     nLabel13 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel14 ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "Identificaci¢n de la factura";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 1802, 1829, NULL;
     nLabel14 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel15 ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "Identificaci¢n factura rectificada";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 1845, 1878, NULL;
     nLabel15 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel16 ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "Fecha expedici¢n";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 2002, 2017, NULL;
     nLabel16 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel17 ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "Fecha operaci¢n";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 2020, 2034, NULL;
     nLabel17 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel18 ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "IGIC (Imp.Gnral.Indirecto Canario)";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 2037, 2066, NULL;
     nLabel18 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel19 ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "Bien de inversi¢n/Descripci¢n";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 2068, 2097, NULL;
     nLabel19 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel20 ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "Observación para el asesor";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 2202, 2229, NULL;
     nLabel20 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel21 ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "Base imponible";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 2502, 2515, NULL;
     nLabel21 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel22 ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "% IVA";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 2518, 2525, NULL;
     nLabel22 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel23 ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "Cuota IVA";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 2527, 2537, NULL;
     nLabel23 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel24 ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "% Recargo";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 2541, 2550, NULL;
     nLabel24 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel25 ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "Cuota recargo";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 2552, 2564, NULL;
     nLabel25 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel26 ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "% Retenci¢n";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 2567, 2578, NULL;
     nLabel26 = FSalida;

                          aLetra = "{{0}}";
     |SI nValLabel27 ! 0; aLetra = "{{3}}";  |FINSI;
     aAlfa = "LABEL," + aLetra + "Cuota retenci¢n";
     |CONTROL_SIMPLE enPantallaFR000000, aAlfa, 2580, 2593, NULL;
     nLabel27 = FSalida;
|FPRC;

|PROCESO Tipo0Integridad; |TIPO 0;
     enProveedor = 0;
     aCampoAhora = #dsarw069#Campo#;
     |QBF aCampoAhora;

     nSwEsImporte = 0;
     nCampoEstoy = Campo;

     |SI nCampoEstoy = 9;
         |SI #dsarw069#9 = 1;  |Y aCampoAntes ! "1";
             #dsarm035#0 = #dsarm034#0;
             #dsarm035#1 = #dsarm034#1;
             #dsarm035#2 = #dsarm034#2;
             #dsarm035#3 = "FR000000_primern";
             |LEE 101#dsarm035.=;
             |SI FSalida = 0;
                 nSwEsImporte = 1;

                 |BORRA 020#dsarm035.a;
                 |LIBERA #dsarm035;
             |FINSI;

             #dsarm035#0 = #dsarm034#0;
             #dsarm035#1 = #dsarm034#1;
             #dsarm035#2 = #dsarm034#2;
             #dsarm035#3 = "FR000000_ultimon";
             |LEE 101#dsarm035.=;
             |SI FSalida = 0;
                 nSwEsImporte = 1;

                 |BORRA 020#dsarm035.a;
                 |LIBERA #dsarm035;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nCampoEstoy ] 21; |Y nCampoEstoy [ 27;
          nSwEsImporte = 1;
     |FINSI;
     |SI nCampoEstoy ] 30; |Y nCampoEstoy [ 43;
          nSwEsImporte = 1;
     |FINSI;
     |SI nCampoEstoy ] 57; |Y nCampoEstoy [ 75;
          nSwEsImporte = 1;
     |FINSI;

     |SI aCampoAhora ! aCampoAntes; |O nSwEsImporte = 1;
          enNumCampoPPI = Campo;
          eaValorPPI = aCampoAhora;

          eaValorPPI2 = "";
          eaValorPPI3 = "";
          eaValorPPI4 = "";
          eaValorPPI5 = "";
          eaValorPPI6 = "";
          |SI eaProcesoPIInte = "FR000000";
               |SI Campo = 21;          ||Base Imp1.
                    |SI #dsarw069#22 ! 0;
                         eaValorPPI2 = #dsarw069#23;
                    |FINSI;
                    |SI #dsarw069#24 ! 0;
                         eaValorPPI3 = #dsarw069#25;
                    |FINSI;
                    |SI #dsarw069#26 ! 0;
                         eaValorPPI4 = #dsarw069#27;
                    |FINSI;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#71;
               |FINSI;
               |SI Campo = 22;  |O Campo = 23;        ||IVA 1
                    eaValorPPI2 = #dsarw069#23;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#71;
               |FINSI;
               |SI Campo = 24;  |O Campo = 25;        ||RECARGO 1
                    eaValorPPI2 = #dsarw069#25;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#71;
               |FINSI;
               |SI Campo = 26;  |O Campo = 27;        ||RETENCION 1
                    eaValorPPI2 = #dsarw069#27;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#71;
               |FINSI;

               |SI Campo = 30;          ||Base Imp2.
                    |SI #dsarw069#31 ! 0;
                         eaValorPPI2 = #dsarw069#32;
                    |FINSI;
                    |SI #dsarw069#33 ! 0;
                         eaValorPPI3 = #dsarw069#34;
                    |FINSI;
                    |SI #dsarw069#35 ! 0;
                         eaValorPPI4 = #dsarw069#36;
                    |FINSI;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#72;
               |FINSI;

               |SI Campo = 31;  |O Campo = 32;        ||IVA 2
                    eaValorPPI2 = #dsarw069#32;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#72;
               |FINSI;

               |SI Campo = 33;  |O Campo = 34;        ||RECARGO 2
                    eaValorPPI2 = #dsarw069#34;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#72;
               |FINSI;

               |SI Campo = 35;  |O Campo = 36;        ||RETENCION 2
                    eaValorPPI2 = #dsarw069#36;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#72;
               |FINSI;

               |SI Campo = 37;          ||Base Imp3.
                    |SI #dsarw069#38 ! 0;
                         eaValorPPI2 = #dsarw069#39;
                    |FINSI;
                    |SI #dsarw069#40 ! 0;
                         eaValorPPI3 = #dsarw069#41;
                    |FINSI;
                    |SI #dsarw069#42 ! 0;
                         eaValorPPI4 = #dsarw069#43;
                    |FINSI;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#73;
               |FINSI;

               |SI Campo = 38; |O Campo = 39;         ||IVA 3
                    eaValorPPI2 = #dsarw069#39;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#73;
               |FINSI;

               |SI Campo = 40;  |O Campo = 41;        ||RECARGO 3
                    eaValorPPI2 = #dsarw069#41;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#73;
               |FINSI;

               |SI Campo = 42;  |O Campo = 43;        ||RETENCION 3
                    eaValorPPI2 = #dsarw069#43;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#73;
               |FINSI;

               |SI Campo = 57;          ||Base Imp4.
                    |SI #dsarw069#58 ! 0;
                         eaValorPPI2 = #dsarw069#59;
                    |FINSI;
                    |SI #dsarw069#60 ! 0;
                         eaValorPPI3 = #dsarw069#61;
                    |FINSI;
                    |SI #dsarw069#62 ! 0;
                         eaValorPPI4 = #dsarw069#63;
                    |FINSI;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#74;
               |FINSI;

               |SI Campo = 58;  |O Campo = 59;        ||IVA 4
                    eaValorPPI2 = #dsarw069#59;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#74;
               |FINSI;

               |SI Campo = 60;  |O Campo = 61;        ||RECARGO 4
                    eaValorPPI2 = #dsarw069#61;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#74;
               |FINSI;

               |SI Campo = 62;  |O Campo = 63;        ||RETENCION 4
                    eaValorPPI2 = #dsarw069#63;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#74;
               |FINSI;

               |SI Campo = 64;          ||Base Imp5.
                    |SI #dsarw069#65 ! 0;
                         eaValorPPI2 = #dsarw069#66;
                    |FINSI;
                    |SI #dsarw069#67 ! 0;
                         eaValorPPI3 = #dsarw069#68;
                    |FINSI;
                    |SI #dsarw069#69 ! 0;
                         eaValorPPI4 = #dsarw069#70;
                    |FINSI;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#75;
               |FINSI;

               |SI Campo = 65;  |O Campo = 66;        ||IVA 5
                    eaValorPPI2 = #dsarw069#66;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#75;
               |FINSI;

               |SI Campo = 67;  |O Campo = 68;        ||RECARGO 5
                    eaValorPPI2 = #dsarw069#68;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#75;
               |FINSI;

               |SI Campo = 69;  |O Campo = 70;        ||RETENCION 5
                    eaValorPPI2 = #dsarw069#70;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#75;
               |FINSI;

               |SI Campo = 71;          ||RETENCION1 Sobre B/F
                    eaValorPPI2 = #dsarw069#27;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#71;
               |FINSI;

               |SI Campo = 72;          ||RETENCION2 Sobre B/F
                    eaValorPPI2 = #dsarw069#36;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#72;
               |FINSI;

               |SI Campo = 73;          ||RETENCION2 Sobre B/F
                    eaValorPPI2 = #dsarw069#43;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#73;
               |FINSI;

               |SI Campo = 74;          ||RETENCION2 Sobre B/F
                    eaValorPPI2 = #dsarw069#63;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#74;
               |FINSI;

               |SI Campo = 75;          ||RETENCION2 Sobre B/F
                    eaValorPPI2 = #dsarw069#70;
                    eaValorPPI5 = #dsarw069#28;
                    eaValorPPI6 = #dsarw069#75;
               |FINSI;
          |FINSI;

          |SI Campo = 2;
              eaValorPPI2 = #dsarw069#4;
          |FINSI;

          |HAZ FormularioaVariables;
          enCodPrimeraInc = 0;
          eaPrimeraInc    = "";
          enSwAvisaInte   = 1;
          enResultadoInte = 0;
          enCodIncidencia = 0;
          eaIncidencia    = "";
          |HAZ IntegridaddsEscan;
          |HAZ PintaLabels;
     |FINSI;
|FPRC;

|PROCESO Tipo7Intw70; |TIPO 7;
     aCampoAntes = #dsarw070#Campo#;
     |QBF aCampoAntes;
|FPRC;

|PROCESO Tipo0Intw70; |TIPO 0;
     enProveedor = 1;
     aCampoAhora = #dsarw070#Campo#;
     |QBF aCampoAhora;

     nSwEsImporte = 0;
     nCampoEstoy = Campo;

     |SI aCampoAhora ! aCampoAntes;
          enNumCampoPPI = Campo;
          eaValorPPI    = aCampoAhora;

          eaValorPPI2 = "";
          eaValorPPI3 = "";
          eaValorPPI4 = "";
          eaValorPPI5 = "";
          eaValorPPI6 = "";

          |HAZ FormularioaVariables;

          enCodPrimeraInc = 0;
          eaPrimeraInc    = "";
          enSwAvisaInte   = 1;
          enResultadoInte = 0;
          enCodIncidencia = 0;
          eaIncidencia    = "";
          |HAZ IntegridaddsEscan;
          |HAZ PintaLabels;
     |FINSI;
|FPRC;

|PROCESO Tipo7Integridad; |TIPO 7;
     aCampoAntes = #dsarw069#Campo#;
     |QBF aCampoAntes;
|FPRC;

|PROCESO Tipo12Fw70;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     #dsarw069#4  = #dsarw070#1;
     #dsarw069#5  = #dsarw070#2;
     #dsarw069#47 = #dsarw070#3;
     #dsarw069#51 = #dsarw070#4;
     #dsarw069#52 = #dsarw070#5;
     #dsarw069#53 = #dsarw070#6;
     #dsarw069#54 = #dsarw070#7;
     #dsarw069#55 = #dsarw070#8;
     #dsarw069#56 = #dsarw070#9;

     |PINTA #dsarw069#4;

     aAlfa1 = #dsarw069#5;  |QBF aAlfa1;
     |SI aAlfa1 ! "";
         eaVar   = "FR000000_pais";
         eaValor = #dsarw069#5;
         |HAZ GrabaVariable;
     |FINSI;

     |ABRE #regisnif@;
     #regisnif@#0 = #dsarw070#0;
     |LEE 000#regisnif@.=;
     |SI FSalida ! 0;
         |DDEFECTO #regisnif@;
         #regisnif@#0  = #dsarw070#0;
         #regisnif@#1  = #dsarw070#1;
         #regisnif@#2  = #dsarw070#4;
         #regisnif@#6  = #dsarw070#6;
         #regisnif@#8  = #dsarw070#7;
         #regisnif@#12 = #dsarw070#2;
         #regisnif@#13 = #dsarw070#3;

         aAlfa = #dsarw070#5 % 102;  #regisnif@#4  = aAlfa;
         aAlfa = #dsarw070#5 % 303;  #regisnif@#5  = aAlfa;
         |GRABA 020#regisnif@.n;
     |FINSI;
     |LIBERA #regisnif@;
     |CIERRA #regisnif@;
|FPRC;

|PROCESO CargaTablaFw70;
     |DBASS aTabla;  |QBF aTabla;
     aTabla = aTabla + "modelos/fich/";

     aTabla      = aTabla + aFTabla;
     nOpcion     = 1;
     nTotalLinea = 0;
     nConta      = -1;
     nBaffer     = 0;

     |LEESECUENCIAL aTabla, nBaffer, nTotalLinea, 0, 0;
|FPRC;

|PROCESO SacaTablaFw70;
     |VENTANA 1750, 2885, -1, 17, "Paises";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PARA; |SI;  |HACIENDO;
          nOpcion = 1;
          |BMENUG nBaffer, 0, 1, nTotalLinea, 1545, nOpcion;
          nOpcion     = FSalida;
          nCogeOpcion = nOpcion - 1;
          |SI FSalida [ nTotalLinea; |Y FSalida ] 1;
              |DEL_BUF nBaffer, nCogeOpcion, aDestino;

              |SAL;
         |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;
|FPRC;

|PROCESO CompruebaTablaFw70;
     enError = 1;
     nPos    = 100 + nComp;

     |LEESECUENCIAL aTabla, nBaffer, nTotalLinea, 0, 0;
     |PARA nConta = 0;  |SI nConta [ nTotalLinea;  |HACIENDO nConta = nConta + 1;
         |DEL_BUF nBaffer, nConta, aDestino;
         aAlfa = aDestino % nPos;

         |QBF aAlfa;
         |QBF eaAlfa;

         |SI aAlfa = eaAlfa;  enError = 0;  |SAL;  |FINSI;
     |SIGUE;

     |FINDIM nBaffer;
|FPRC;

|PROCESO FinTablaFw70;
     |FINDIM nBaffer;
|FPRC;

|PROCESO Tipo7C2Fw70; |TIPO 7;
     aFTabla = "ztabla05.txt";
     nLCod   = 2;
     |HAZ CargaTablaFw70;
|FPRC;

|PROCESO Tipo66C2Fw70; |TIPO 66;
     |HAZ SacaTablaFw70;
     aAlfa1  = aDestino % 102;  #dsarw070#2  = aAlfa1;
     aAlfa1  = aDestino % 440;  #dsarw070#3  = aAlfa1;

     |PINTA #dsarw070#2;
     |PINTA #dsarw070#3;
|FPRC;

|PROCESO Tipo0C2Fw70; |TIPO 0;
     nComp  = nLCod;
     aAlfa  = #dsarw070#2; |QBF aAlfa;
     nCalc  = 100 + nLCod;
     aAlfa  = (aAlfa + (" " * nComp)) % nCalc;
     eaAlfa = aAlfa;
     |HAZ CompruebaTablaFw70;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F11";
         |ERROR;
         |PULSATECLA;
         |ACABA;
     |FINSI;

     aAlfa1  = aDestino % 102;  #dsarw070#2 = aAlfa1;  |PINTA #dsarw070#2;
     aAlfa1  = aDestino % 440;  #dsarw070#3 = aAlfa1;  |PINTA #dsarw070#3;

     |HAZ FinTablaFw70;
|FPRC;

|PROCESO Tipo12Fw69;  |TIPO 12;
     |SI FSalida ! 1;  |ACABA;  |FINSI;

     |PULSATECLA;

     aAlfa = #dsarw069#13;  |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000Numero identificaci¢n de la factura sin contenido.";
         |ERROR;
         |ACABA;
     |FINSI;

     |SI #dsarw069#21 = 0;  |Y #dsarw069#30 = 0; |Y #dsarw069#37 = 0; |Y #dsarw069#57 = 0; |Y #dsarw069#64 = 0;
         |MENAV "0000La base imponible NO puede ser cero. Ponga un importe distinto a cero";
         |ERROR;
         |ACABA;
     |FINSI;

     enCodPrimeraInc = 0;
     eaPrimeraInc = "";
     enSwAvisaInte = 1;
     enResultadoInte = 0;
     enCodIncidencia = 0;
     eaIncidencia = "";
     |HAZ IntegridaddsEscan;
     |SI enCodPrimeraInc ! 0;
          |QBF eaIncidencia;
          aMensaje = "0000SIncidencia: " + eaPrimeraInc + &13 + "Corregir?";
          |CONFI aMensaje;
          |SI FSalida = 0;
               |ERROR;        ||No termina.
          |SINO;
               FSalida = -1;
          |FINSI;
     |SINO;
          ||Tengo que actualizar el NIF y el NOMBRE NIF, siempre
          ||porque en ciertos casos no se esta actualizando.
          ||Introduccion sin plantilla o al cambiar y anular el cambio.

          ||ARA1
          |SI eaProcesoPIInte = "FR000000";
               enNumCampoPPI = 2;
               eaValorPPI = #dsarw069#2;
               |QBF eaValorPPI;
               eaValorPPI2 = #dsarw069#4;
               |QBF eaValorPPI2;
               eaValorPPI3 = "";
               eaValorPPI4 = "";
               eaValorPPI5 = "";
               eaValorPPI6 = "";
               |HAZ FormularioaVariables;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO agicen14_w69;
     nConta = nConta + 1;
     nActiv = #agicen14#1;
|FPRC;

|DEFBUCLE agicen14_w69;
     #agicen14#1;
     6;
     nEmpresa, 01, "01.01.0000";
     nEmpresa, 99, "01.01.0000";
     ;
     NULL, agicen14_w69;
|FIN;

|PROCESO Tipo7C1Fw69; |TIPO 7;
     nEmpresa = eaUsuario;
     nConta   = 0;
     |BUCLE agicen14_w69;

     |C_M #dsarw069#1, 1, "S";
     |SI nConta = 1;
          |C_M #dsarw069#1, 1, "N";
          #dsarw069#1 = nActiv;

          enNumCampoPPI = 1;
          eaValorPPI = nActiv;
          enProveedor = 0;
          |HAZ FormularioaVariables;
          enCodPrimeraInc = 0;
          eaPrimeraInc = "";
          enSwAvisaInte = 1;
          enResultadoInte = 0;
          enCodIncidencia = 0;
          eaIncidencia = "";
          |HAZ IntegridaddsEscan;   ||aqui
          |HAZ PintaLabels;
     |FINSI;

     |PINTA #dsarw069#1;
|FPRC;

|PROCESO Baja714_w69;
     #agicen14#0 = nEmpresa;
     #agicen14#1 = 01;
|FPRC;

|PROCESO Alta714_w69;
     #agicen14#0 = nEmpresa;
     #agicen14#1 = 99;
|FPRC;

|PROCESO Tipo66C1Fw69; |TIPO 66;
     |ABRE #agicen14;
     #agicen14#0 = eaUsuario;
     #agicen14#1 = #dsarw069#1;
     |LEE 000#agicen14.=;

     |CONSULTA_F_CLAVE #1#agicen14, Baja714_w69, Alta714_w69;
     |SI FSalida = 0;
         #dsarw069#1  = #agicen14#1;
         #dsarw069#46 = #agicen14#4;
     |FINSI;
     |CIERRA #agicen14;

     |PINTA #dsarw069#1;
     |PINTA #dsarw069#46;
|FPRC;

|PROCESO DimeActividad;
     |ABRE #agicen14;
     #agicen14#0 = eaUsuario;
     #agicen14#1 = #dsarw069#1;
     |LEE 000#agicen14.=;
     |SI FSalida = 0;
          |SI #agicen14#6 = "01.01.0000";
               eaDimeActividad = #agicen14#4;
          |FINSI;
     |FINSI;
     |CIERRA #agicen14;
|FPRC;

|PROCESO Tipo0C1Fw69; |TIPO 0;
     |ABRE #agicen14;
     #agicen14#0 = eaUsuario;
     #agicen14#1 = #dsarw069#1;
     |LEE 000#agicen14.=;
     |SI FSalida ! 0;
         |MENAV "0000No existe la Actividad";
         |CIERRA #agicen14;
         |ERROR;
         |ACABA;
     |FINSI;
     |CIERRA #agicen14;

     |SI #agicen14#6 ! "01.01.0000";
         |MENAV "0000La actividad est  dada de baja";
         |ERROR;
         |ACABA;
     |FINSI;

     #dsarw069#1  = #agicen14#1;
     #dsarw069#46 = #agicen14#4;

     |PINTA #dsarw069#1;
     |PINTA #dsarw069#46;
|FPRC;

|PROCESO Tipo6C2Fw69;  |TIPO 6;
     eaVarDni  = #dsarw069#Campo#;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "             ") % 112;
     |SI #dsarw069#Campo# ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #dsarw069#Campo# = eaVarDni;  |PINTA #dsarw069#Campo#;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     eaCodNif  = #dsarw069#2;
     |HAZ LeeNifs;

     |ABRE #regisnif@;
     #regisnif@#0 = #dsarw069#2;
     |LEE 000#regisnif@.=;
     |SI FSalida = 0;
         #dsarw069#4  = #regisnif@#1;


         aAlfa1   = #regisnif@#2;  |QBF aAlfa1;
         aAlfa1   = aAlfa1 + " " + #regisnif@#3;
         #dsarw069#51 = aAlfa1;

         aAlfa1  = (("00" + #regisnif@#4) % -102) + (("000" + #regisnif@#5) % -103);
         #dsarw069#52 = aAlfa1;
         #dsarw069#53 = #regisnif@#6;
         #dsarw069#54 = #regisnif@#8;
         #dsarw069#55 = #regisnif@#17;

         eaVar   = "FR000000_pronom";
         eaValor = #dsarw069#4;
         |HAZ GrabaVariable;

         eaVar   = "FR000000_pais";
         eaValor = #dsarw069#5;
         |HAZ GrabaVariable;

         eaVar   = "FR000000_procalle";
         eaValor = #dsarw069#51;
         |HAZ GrabaVariable;

         eaVar   = "FR000000_procodpos";
         eaValor = #dsarw069#52;  |QBF eaValor;
         |HAZ GrabaVariable;

         eaVar   = "FR000000_prolocalidad";
         eaValor = #dsarw069#53;
         |HAZ GrabaVariable;

         eaVar   = "FR000000_protelefono";
         eaValor = #dsarw069#54;
         |HAZ GrabaVariable;

         eaVar   = "FR000000_profax";
         eaValor = #dsarw069#55;
         |HAZ GrabaVariable;

         |PINTA #dsarw069#4;
     |FINSI;
     |CIERRA #regisnif@;

     aContenido = Contenido;
     |SI #dsarw069#2 = aContenido;  |ACABA;   |FINSI;

     #dsarw069#5  = #regisnif@#12;
     #dsarw069#47 = #regisnif@#13;

     |SI #dsarw069#5  = "   ";
         #dsarw069#5  = "ES";
         #dsarw069#47 = "ESPAÑA";
     |FINSI;

     aAlfa = #dsarw069#2 % 101;
     |SI aAlfa = "X";  |O aAlfa = "Y";
         #dsarw069#6  = "4";
         #dsarw069#48 = "Documento Oficial de identificacion expedido por el pais o territorio de residencia";

         |PINTA #dsarw069#6;
         |PINTA #dsarw069#48;
     |FINSI;

     |HAZ DatosProveedor;
|FPRC;

|PROCESO Tipo66C6Fw69;  |TIPO 66;
     aAlfa = "|C006WID";
     aID   = #dsarw069#aAlfa#;
     nID   = aID;

     aPopup1  = nID;  || Si fuera -1 en la posicion
     aPopup2  = 6;
     aPopup3  = "1 NIF";
     aPopup4  = "2 NIF/IVA (NIF operador intracomunitario)";
     aPopup5  = "3 Pasaporte";
     aPopup6  = "4 Documento Oficial de identificacion expedido por el pais o territorio de residencia";
     aPopup7  = "5 Certificado de residencia fiscal";
     aPopup8  = "6 Otro documento probatorio";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 101;  #dsarw069#6  = aAlfa;
         aAlfa = aPopup % 360;  #dsarw069#48 = aAlfa;
     |FINSI;

     |PINTA #dsarw069#6;
     |PINTA #dsarw069#48;
|FPRC;

|PROCESO Tipo0C6Fw69;   |TIPO 0;
     #dsarw069#48 = "";

     |SI #dsarw069#6 = "1";
         #dsarw069#48 = "NIF";
     |FINSI;

     |SI #dsarw069#6 = "2";
         #dsarw069#48 = "NIF/IVA (NIF operador intracomunitario)";
     |FINSI;

     |SI #dsarw069#6 = "3";
         #dsarw069#48 = "Pasaporte";
     |FINSI;

     |SI #dsarw069#6 = "4";
         #dsarw069#48 = "Documento Oficial de identificacion expedido por el pais o territorio de residencia";
     |FINSI;

     |SI #dsarw069#6 = "5";
         #dsarw069#48 = "Certificado de residencia fiscal";
     |FINSI;

     |SI #dsarw069#6 = "6";
         #dsarw069#48 = "Otro documento probatorio";
     |FINSI;

     |PINTA #dsarw069#48;

     aAlfa = #dsarw069#48;  |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000 Clave identificaci¢n pais de residencia incorrecto";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tipo66C8Fw69;  |TIPO 66;
     aAlfa = "|C008WID";
     aID   = #dsarw069#aAlfa#;
     nID   = aID;

     aPopup1  = nID;  || Si fuera -1 en la posicion
     aPopup2  = 14;
     aPopup3  = "  Operación habitual";
     aPopup4  = "A Asiento resumen de facturas";
     aPopup5  = "B Asiento resumen de tiques";
     aPopup6  = "C Factura con varios asientos (varios tipo impositivos)";
     aPopup7  = "D Factura rectificativa";
     aPopup8  = "F Adquisiciones realizadas por las agencias de viajes directamente en interés del viajero ";
     aPopup9  = "G Régimen especial de grupo de entidades en IVA o IGIC";
     aPopup10 = "H Régimen especial de oro de inversión";
     aPopup11 = "I Inversión del Sujeto pasivo (ISP)";
     aPopup12 = "J Tiques";
     aPopup13 = "K Rectificación anotaciones registrales";
     aPopup14 = "L Adquisiciones a comerciantes minoristas del IGIC";
     aPopup15 = "P Adquisiciones intracomunitarias de bienes.";
     aPopup16 = "Q Operaciones a las que se aplique el régimen especial de bienes usados, ...";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 101;  #dsarw069#8  = aAlfa;
         aAlfa = aPopup % 380;  #dsarw069#49 = aAlfa;
     |FINSI;

     |PINTA #dsarw069#8;
     |PINTA #dsarw069#49;
|FPRC;

|PROCESO Tipo0C8Fw69;  |TIPO 0;
     #dsarw069#49 = "";
     |SI #dsarw069#8 = " ";
         #dsarw069#49 = "Operaci¢n habitual";
     |FINSI;

     |SI #dsarw069#8 = "A";
         #dsarw069#49 = "Asiento resumen de facturas";
     |FINSI;

     |SI #dsarw069#8 = "B";
         #dsarw069#49 = "Asiento resumen de tiques";
     |FINSI;

     |SI #dsarw069#8 = "C";
         #dsarw069#49 = "Factura con varios asientos (varios tipo impositivos)";
     |FINSI;

     |SI #dsarw069#8 = "D";
         #dsarw069#49 = "Factura rectificativa";
     |FINSI;

     |SI #dsarw069#8 = "F";
         #dsarw069#49 = "Adquisiciones realizadas por las agencias de viajes directamente en inter‚s del viajero";
     |FINSI;

     |SI #dsarw069#8 = "G";
         #dsarw069#49 = "R‚gimen especial de grupo de entidades en IVA o IGIC";
     |FINSI;

     |SI #dsarw069#8 = "H";
         #dsarw069#49 = "R‚gimen especial de oro de inversi¢n";
     |FINSI;

     |SI #dsarw069#8 = "I";
         #dsarw069#49 = "Inversi¢n del Sujeto pasivo (ISP)";
     |FINSI;

     |SI #dsarw069#8 = "J";
         #dsarw069#49 = "Tiques";
     |FINSI;

     |SI #dsarw069#8 = "K";
         #dsarw069#49 = "Rectificación anotaciones registrales";
     |FINSI;

     |SI #dsarw069#8 = "L";
         #dsarw069#49 = "Adquisiciones a comerciantes minoristas del IGIC";
     |FINSI;

     |SI #dsarw069#8 = "P";
         #dsarw069#49 = "Adquisiciones intracomunitarias de bienes.";
     |FINSI;

     |SI #dsarw069#8 = "Q";
         #dsarw069#49 = "Operaciones a las que se aplique el r‚gimen especial de bienes usados, ...";
     |FINSI;

     aAlfa = #dsarw069#49;  |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000 Clave de operaci¢n incorrecta";
         |ERROR;
         |ACABA;
     |FINSI;

     |PINTA #dsarw069#49;

     |C_M #dsarw069#9,  1, "S";
     |C_M #dsarw069#11, 1, "S";
     |C_M #dsarw069#12, 1, "S";
     |SI #dsarw069#8 ! "A";  |Y #dsarw069#8 ! "B";
         |C_M #dsarw069#9,  1, "N";  #dsarw069#9  = 1;
         |C_M #dsarw069#11, 1, "N";  #dsarw069#11 = "";
         |C_M #dsarw069#12, 1, "N";  #dsarw069#12 = "";
     |FINSI;

     |C_M #dsarw069#10, 1, "S";
     |SI #dsarw069#8 ! "C";
         |C_M #dsarw069#10, 1, "N";  #dsarw069#10 = 1;
     |FINSI;

     |PINTA #dsarw069#9;
     |PINTA #dsarw069#10;
     |PINTA #dsarw069#11;
     |PINTA #dsarw069#12;
|FPRC;

|PROCESO Tipo0C18Fw69;  |TIPO 0;
     |C_M #dsarw069#19, 1, "S";
     |SI #dsarw069#18 = "N";
         |C_M #dsarw069#19, 1, "N";  #dsarw069#19 = "";
     |FINSI;

     |PINTA #dsarw069#19;
|FPRC;

|PROCESO Tipo0C42Fw69;  |TIPO 0;
     |SI FSalida = 0;
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tipo0C21Fw69;  |TIPO 0;
     |SI Campo = 23;  |O Campo = 25;  |O Campo = 27;
         aCampoAntes = #dsarw069#Campo#;
     |FINSI;

     |SI #dsarw069#Campo# = aCampoAntes;
         #dsarw069#28 = #dsarw069#21 + #dsarw069#23 + #dsarw069#25 - #dsarw069#27;
         #dsarw069#28 = #dsarw069#28 + #dsarw069#30 + #dsarw069#32 + #dsarw069#34 - #dsarw069#36;
         #dsarw069#28 = #dsarw069#28 + #dsarw069#37 + #dsarw069#39 + #dsarw069#41 - #dsarw069#43;
         #dsarw069#28 = #dsarw069#28 + #dsarw069#57 + #dsarw069#59 + #dsarw069#61 - #dsarw069#63;
         #dsarw069#28 = #dsarw069#28 + #dsarw069#64 + #dsarw069#66 + #dsarw069#68 - #dsarw069#70;

         |PINTA #dsarw069#28;

         |HAZ Tipo0Integridad;

         |ACABA;
     |FINSI;

     #dsarw069#23 = #dsarw069#21 % #dsarw069#22;
     #dsarw069#25 = #dsarw069#21 % #dsarw069#24;
     |SI #dsarw069#71 = "F";
         nTotLin = #dsarw069#21 + #dsarw069#23 + #dsarw069#25;
         #dsarw069#27 = nTotLin % #dsarw069#26;
     |SINO;
         #dsarw069#27 = #dsarw069#21 % #dsarw069#26;
     |FINSI;

     #dsarw069#28 = #dsarw069#21 + #dsarw069#23 + #dsarw069#25 - #dsarw069#27;
     #dsarw069#28 = #dsarw069#28 + #dsarw069#30 + #dsarw069#32 + #dsarw069#34 - #dsarw069#36;
     #dsarw069#28 = #dsarw069#28 + #dsarw069#37 + #dsarw069#39 + #dsarw069#41 - #dsarw069#43;
     #dsarw069#28 = #dsarw069#28 + #dsarw069#57 + #dsarw069#59 + #dsarw069#61 - #dsarw069#63;
     #dsarw069#28 = #dsarw069#28 + #dsarw069#64 + #dsarw069#66 + #dsarw069#68 - #dsarw069#70;

     |PINTA #dsarw069#23;
     |PINTA #dsarw069#25;
     |PINTA #dsarw069#27;
     |PINTA #dsarw069#28;

     |HAZ Tipo0Integridad;
|FPRC;

|PROCESO Tipo0C30Fw69;  |TIPO 0;
     |SI Campo = 32;  |O Campo = 34;  |O Campo = 36
         aCampoAntes = #dsarw069#Campo#;
     |FINSI;

     |SI #dsarw069#Campo# = aCampoAntes;
         #dsarw069#28 = #dsarw069#21 + #dsarw069#23 + #dsarw069#25 - #dsarw069#27;
         #dsarw069#28 = #dsarw069#28 + #dsarw069#30 + #dsarw069#32 + #dsarw069#34 - #dsarw069#36;
         #dsarw069#28 = #dsarw069#28 + #dsarw069#37 + #dsarw069#39 + #dsarw069#41 - #dsarw069#43;
         #dsarw069#28 = #dsarw069#28 + #dsarw069#57 + #dsarw069#59 + #dsarw069#61 - #dsarw069#63;
         #dsarw069#28 = #dsarw069#28 + #dsarw069#64 + #dsarw069#66 + #dsarw069#68 - #dsarw069#70;

         |PINTA #dsarw069#28;

         |HAZ Tipo0Integridad;

         |ACABA;
     |FINSI;

     #dsarw069#32 = #dsarw069#30 % #dsarw069#31;
     #dsarw069#34 = #dsarw069#30 % #dsarw069#33;
     |SI #dsarw069#72 = "F";
          nTotLin = #dsarw069#30 + #dsarw069#32 + #dsarw069#34;
          #dsarw069#36 = nTotLin % #dsarw069#35;
     |SINO;
          #dsarw069#36 = #dsarw069#30 % #dsarw069#35;
     |FINSI;

     #dsarw069#28 = #dsarw069#21 + #dsarw069#23 + #dsarw069#25 - #dsarw069#27;
     #dsarw069#28 = #dsarw069#28 + #dsarw069#30 + #dsarw069#32 + #dsarw069#34 - #dsarw069#36;
     #dsarw069#28 = #dsarw069#28 + #dsarw069#37 + #dsarw069#39 + #dsarw069#41 - #dsarw069#43;
     #dsarw069#28 = #dsarw069#28 + #dsarw069#57 + #dsarw069#59 + #dsarw069#61 - #dsarw069#63;
     #dsarw069#28 = #dsarw069#28 + #dsarw069#64 + #dsarw069#66 + #dsarw069#68 - #dsarw069#70;

     |PINTA #dsarw069#32;
     |PINTA #dsarw069#34;
     |PINTA #dsarw069#36;
     |PINTA #dsarw069#28;

     |HAZ Tipo0Integridad;
|FPRC;

|PROCESO Tipo0C37Fw69;  |TIPO 0;
     |SI Campo = 39;  |O Campo = 41;  |O Campo = 43;
         aCampoAntes = #dsarw069#Campo#;
     |FINSI;

     |SI #dsarw069#Campo# = aCampoAntes;
         #dsarw069#28 = #dsarw069#21 + #dsarw069#23 + #dsarw069#25 - #dsarw069#27;
         #dsarw069#28 = #dsarw069#28 + #dsarw069#30 + #dsarw069#32 + #dsarw069#34 - #dsarw069#36;
         #dsarw069#28 = #dsarw069#28 + #dsarw069#37 + #dsarw069#39 + #dsarw069#41 - #dsarw069#43;
         #dsarw069#28 = #dsarw069#28 + #dsarw069#57 + #dsarw069#59 + #dsarw069#61 - #dsarw069#63;
         #dsarw069#28 = #dsarw069#28 + #dsarw069#64 + #dsarw069#66 + #dsarw069#68 - #dsarw069#70;

         |PINTA #dsarw069#28;

         |HAZ Tipo0Integridad;

         |ACABA;
     |FINSI;

     #dsarw069#39 = #dsarw069#37 % #dsarw069#38;
     #dsarw069#41 = #dsarw069#37 % #dsarw069#40;
     |SI #dsarw069#73 = "F";
          nTotLin = #dsarw069#37 + #dsarw069#39 + #dsarw069#41;
          #dsarw069#43 = nTotLin % #dsarw069#42;
     |SINO;
          #dsarw069#43 = #dsarw069#37 % #dsarw069#42;
     |FINSI;

     #dsarw069#28 = #dsarw069#21 + #dsarw069#23 + #dsarw069#25 - #dsarw069#27;
     #dsarw069#28 = #dsarw069#28 + #dsarw069#30 + #dsarw069#32 + #dsarw069#34 - #dsarw069#36;
     #dsarw069#28 = #dsarw069#28 + #dsarw069#37 + #dsarw069#39 + #dsarw069#41 - #dsarw069#43;
     #dsarw069#28 = #dsarw069#28 + #dsarw069#57 + #dsarw069#59 + #dsarw069#61 - #dsarw069#63;
     #dsarw069#28 = #dsarw069#28 + #dsarw069#64 + #dsarw069#66 + #dsarw069#68 - #dsarw069#70;

     |PINTA #dsarw069#39;
     |PINTA #dsarw069#41;
     |PINTA #dsarw069#43;
     |PINTA #dsarw069#28;

     |HAZ Tipo0Integridad;
|FPRC;

|PROCESO Tipo0C57Fw69;  |TIPO 0;
     |SI Campo = 59;  |O Campo = 61;  |O Campo = 63;
         aCampoAntes = #dsarw069#Campo#;
     |FINSI;

     |SI #dsarw069#Campo# = aCampoAntes;
         #dsarw069#28 = #dsarw069#21 + #dsarw069#23 + #dsarw069#25 - #dsarw069#27;
         #dsarw069#28 = #dsarw069#28 + #dsarw069#30 + #dsarw069#32 + #dsarw069#34 - #dsarw069#36;
         #dsarw069#28 = #dsarw069#28 + #dsarw069#37 + #dsarw069#39 + #dsarw069#41 - #dsarw069#43;
         #dsarw069#28 = #dsarw069#28 + #dsarw069#57 + #dsarw069#59 + #dsarw069#61 - #dsarw069#63;
         #dsarw069#28 = #dsarw069#28 + #dsarw069#64 + #dsarw069#66 + #dsarw069#68 - #dsarw069#70;

         |PINTA #dsarw069#28;

         |HAZ Tipo0Integridad;

         |ACABA;
     |FINSI;

     #dsarw069#59 = #dsarw069#57 % #dsarw069#58;
     #dsarw069#61 = #dsarw069#57 % #dsarw069#60;
     |SI #dsarw069#74 = "F";
          nTotLin = #dsarw069#57 + #dsarw069#59 + #dsarw069#61;
          #dsarw069#63 = nTotLin % #dsarw069#62;
     |SINO;
          #dsarw069#63 = #dsarw069#57 % #dsarw069#62;
     |FINSI;

     #dsarw069#28 = #dsarw069#21 + #dsarw069#23 + #dsarw069#25 - #dsarw069#27;
     #dsarw069#28 = #dsarw069#28 + #dsarw069#30 + #dsarw069#32 + #dsarw069#34 - #dsarw069#36;
     #dsarw069#28 = #dsarw069#28 + #dsarw069#37 + #dsarw069#39 + #dsarw069#41 - #dsarw069#43;
     #dsarw069#28 = #dsarw069#28 + #dsarw069#57 + #dsarw069#59 + #dsarw069#61 - #dsarw069#63;
     #dsarw069#28 = #dsarw069#28 + #dsarw069#64 + #dsarw069#66 + #dsarw069#68 - #dsarw069#70;

     |PINTA #dsarw069#59;
     |PINTA #dsarw069#61;
     |PINTA #dsarw069#63;
     |PINTA #dsarw069#28;

     |HAZ Tipo0Integridad;
|FPRC;

|PROCESO Tipo0C64Fw69;  |TIPO 0;
     |SI Campo = 66;  |O Campo = 68;  |O Campo = 71;
         aCampoAntes = #dsarw069#Campo#;
     |FINSI;

     |SI #dsarw069#Campo# = aCampoAntes;
         #dsarw069#28 = #dsarw069#21 + #dsarw069#23 + #dsarw069#25 - #dsarw069#27;
         #dsarw069#28 = #dsarw069#28 + #dsarw069#30 + #dsarw069#32 + #dsarw069#34 - #dsarw069#36;
         #dsarw069#28 = #dsarw069#28 + #dsarw069#37 + #dsarw069#39 + #dsarw069#41 - #dsarw069#43;
         #dsarw069#28 = #dsarw069#28 + #dsarw069#57 + #dsarw069#59 + #dsarw069#61 - #dsarw069#63;
         #dsarw069#28 = #dsarw069#28 + #dsarw069#64 + #dsarw069#66 + #dsarw069#68 - #dsarw069#70;

         |PINTA #dsarw069#28;

         |HAZ Tipo0Integridad;

         |ACABA;
     |FINSI;

     #dsarw069#66 = #dsarw069#64 % #dsarw069#65;
     #dsarw069#68 = #dsarw069#64 % #dsarw069#67;
     |SI #dsarw069#75 = "F";
          nTotLin = #dsarw069#64 + #dsarw069#66 + #dsarw069#68;
          #dsarw069#70 = nTotLin % #dsarw069#69;
     |SINO;
          #dsarw069#70 = #dsarw069#64 % #dsarw069#69;
     |FINSI;

     #dsarw069#28 = #dsarw069#21 + #dsarw069#23 + #dsarw069#25 - #dsarw069#27;
     #dsarw069#28 = #dsarw069#28 + #dsarw069#30 + #dsarw069#32 + #dsarw069#34 - #dsarw069#36;
     #dsarw069#28 = #dsarw069#28 + #dsarw069#37 + #dsarw069#39 + #dsarw069#41 - #dsarw069#43;
     #dsarw069#28 = #dsarw069#28 + #dsarw069#57 + #dsarw069#59 + #dsarw069#61 - #dsarw069#63;
     #dsarw069#28 = #dsarw069#28 + #dsarw069#64 + #dsarw069#66 + #dsarw069#68 - #dsarw069#70;

     |PINTA #dsarw069#66;
     |PINTA #dsarw069#68;
     |PINTA #dsarw069#70;
     |PINTA #dsarw069#28;

     |HAZ Tipo0Integridad;
|FPRC;
