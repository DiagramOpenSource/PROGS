|FICHEROS;
    agicen05 #5;
    agim0004 #4;
|FIN;

|VARIABLES;
   &c_empre     = 0;
   &c_activ     = 0;
   &c_tipo      = 0;
   &n_empre     = "";
   &n_activ     = "";

     aNifQbf1   = "";
     aNifQbf2   = "";

     &eaVarDni  = "";
     &enCalcCif = 0;
|FIN;

|PROCESO LetrasDni5;
     |SI FSalida = 9;
         eaVarDni   = #5Campo;
         enCalcCif  = 1;
         |HAZ CalculoDNI;
         #5Campo = eaVarDni;
         |PINTA #5Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #5Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;

     aNifQbf1 = #5Campo;   |QBF aNifQbf1;
     aNifQbf2 = eaVarDni;  |QBF aNifQbf2;

     |SI aNifQbf1 ! aNifQbf2; |Y aNifQbf1 ! "";
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #5Campo = eaVarDni;  |PINTA #5Campo;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CogeRepre;
#5#4  = #4#2;    || NIF
#5#5  = #4#3;    || Apellidos y Nombre
#5#9  = #4#6;    || Domicilio
#5#10 = #4#7;    || Numero
#5#15 = #4#8;    || Codigo Postal 1
#5#16 = #4#9;    || Codigo Postal 2
#5#17 = #4#10;   || Municipio
#5#18 = #4#11;   || Provincia
|ERROR10;
|FPRC;

|DEFBUCLE agim0004;
#4#1;
;
c_empre, 01;
c_empre, 99;
;
NULL, CogeRepre;
|FIN;

|PROGRAMA;
|ABRE #5;
|PINPA #0#5;
#5#0 = c_empre;
#5#1 = c_activ;
|LIBERA #5;
|LEE 140#5=;
|SI FSalida = 0;
    |PINDA #0#5;
    |ENDATOS #2#5;
    |SI FSalida = 0; |GRABA 140#5a; |FINSI;
|SINO;
    |DDEFECTO #5;
    #5#0 = c_empre;
    #5#1 = c_activ;
    #5#2 = n_empre;
    #5#3 = n_activ;
    |BUCLE agim0004;
    |PINDA #0#5;
    |ENDATOS #1#5;
    |SI FSalida = 0; |GRABA 140#5n; |FINSI;
|FINSI;
|CIERRA #5;
|FPRO;
