|FICHEROS;
     agicen44 #0;
     agim0019;
     agimunic #100;
|FIN;

|VARIABLES;
     nCampo     = 0;
     nCampo1    = 0;
     nCampo2    = 0;
     nCampo3    = 0;
     aAlfa1     = "";
     aAlfa2     = "";
     fFecha     = @;

     &eaVarDni  = "";
     &enCalcCif = 0;

     &eaTabla    = "";
     &eaDestino  = "";
     &eaAlfa     = "";
     &enError    = 0;
     &enComp     = 0;
     &enPosicion = 0;
|FIN;

|PROCESO DatosSoc;
     |ABRE #agim0019;
     #agim0019#0 = #0#0;
     #agim0019#1 = 99;
     |LEE 000#agim0019.];
     |SI FSalida = 0;
          |SI #agim0019#0 = #0#0;
               #0#10 = #agim0019#11;    || fecha constitucion
               #0#11 = #agim0019#28;    || fecha inscripcion registro
               |PINTA #0#10;
               |PINTA #0#11;
          |SINO;
               |LEE 000#agim0019.a;
               |SI FSalida = 0; |Y #agim0019#0 = #0#0;
                    #0#10 = #agim0019#11;    || fecha constitucion
                    #0#11 = #agim0019#28;    || fecha inscripcion registro
                    |PINTA #0#10;
                    |PINTA #0#11;
               |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #agim0019;
|FPRC;

|PROCESO SacaTipo44;  |TIPO 7;
     eaTabla = "txtn0018.txt";
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompTipo44;  |TIPO 0;
     |SI FSalida = 10;
         enPosicion = 55;
         |HAZ SacaTabla;
         #0Campo = eaDestino % 103;
         |PINTA #0Campo;
     |FINSI;

     enComp = 3;
     eaAlfa = #0Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     |HAZ FinTabla;
|FPRC;

|PROCESO LetraDni44;  |TIPO 6;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     eaVarDni  = #0Campo;
     enCalcCif = 1;
     |HAZ CalculoDNI;
     #0Campo = eaVarDni;
     |PINTA #0Campo;
|FPRC;

|PROCESO SacaPers44;  |TIPO 7;
     fFecha = ~;
     eaTabla = "txtn1002.txt";
     |SI Campo = 119;
         |SI fFecha ] "01.07.2018";
             eaTabla = "txtn2002.txt";
         |SINO;
             eaTabla = "txtn0002.txt";
         |FINSI;
     |FINSI;
     |SI Campo = 129; |Y fFecha ] "01.07.2018";
         eaTabla = "txtn3002.txt";
     |FINSI;
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompPers44;  |TIPO 0;
     |SI Campo = 119; nCampo = 131; |FINSI;
     |SI Campo = 129; nCampo = 130; |FINSI;
     |SI FSalida = 10;
         enPosicion = 15;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 102;
         #0Campo  = aAlfa1;
         |PINTA #0Campo;
     |FINSI;

     enComp = 2;
     eaAlfa = #0Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 102;
     aAlfa2   = eaDestino % 450;
     #0Campo  = aAlfa1;
     #0nCampo = aAlfa2;

     |PINTA #0Campo;
     |PINTA #0nCampo;

     |HAZ FinTabla;
|FPRC;

|PROCESO SacaEnti44;  |TIPO 7;
     |SI Campo = 121; |O Campo = 123;
         eaTabla = "txtn0003.txt";
     |SINO;
         eaTabla = "txtn1003.txt";
     |FINSI;
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompEnti44;  |TIPO 0;
     |SI Campo = 121; nCampo = 132; |FINSI;
     |SI Campo = 123; nCampo = 133; |FINSI;
     |SI Campo = 125; nCampo = 134; |FINSI;
     |SI Campo = 127; nCampo = 135; |FINSI;
     |SI FSalida = 10;
          enPosicion = 15;
          |HAZ SacaTabla;

          aAlfa1   = eaDestino % 102;
          #0Campo  = aAlfa1;
          |PINTA #0Campo;
     |FINSI;

     enComp = 2;
     eaAlfa = #0Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 102;
     aAlfa2   = eaDestino % 450;
     #0Campo  = aAlfa1;
     #0nCampo = aAlfa2;

     |PINTA #0Campo;
     |PINTA #0nCampo;

     |HAZ FinTabla;
|FPRC;

|PROCESO SacaCali44;  |TIPO 7;
     eaTabla = "txtn0005.txt";
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompCali44;  |TIPO 0;
     |SI Campo = 61; nCampo = 102; |FINSI;
     |SI Campo = 70; nCampo = 103; |FINSI;
     |SI FSalida = 10;
         enPosicion = 55;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 102;
         #0Campo  = aAlfa1;
         |PINTA #0Campo;
     |FINSI;

     enComp = 2;
     eaAlfa = #0Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 102;
     aAlfa2   = eaDestino % 415;
     #0Campo  = aAlfa1;
     #0nCampo = aAlfa2;

     |PINTA #0Campo;
     |PINTA #0nCampo;

     |HAZ FinTabla;
|FPRC;

|PROCESO SacaSg44;  |TIPO 7;
     eaTabla = "txtn0001.txt";
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompSg44;  |TIPO 0;
     |SI FSalida = 10;
         enPosicion = 55;
         |HAZ SacaTabla;
         #0Campo = eaDestino % 105;
         |PINTA #0Campo;
     |FINSI;

     enComp = 5;
     eaAlfa = #0Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     |HAZ FinTabla;
|FPRC;

|PROCESO SacaPais44;  |TIPO 7;
     eaTabla = "txtn0006.txt";
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompPais44;  |TIPO 0;
     |SI Campo = 4;
          nCampo = 106;
     |FINSI;
     |SI Campo = 38;
          nCampo = 37;
     |FINSI;
     |SI FSalida = 10;
         enPosicion = 55;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 102;
         #0Campo  = aAlfa1;
         |PINTA #0Campo;
     |FINSI;

     enComp = 3;
     eaAlfa = #0Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 102;
     aAlfa2   = eaDestino % 420;
     #0Campo  = aAlfa1;
     #0nCampo = aAlfa2;

     |PINTA #0Campo;
     |PINTA #0nCampo;

     |HAZ FinTabla;
|FPRC;

|PROCESO SacaMuni44;
     || nCampo = Cod. Postal
     || nCampo1 = Nombre Municipio
     || nCampo2 = Codigo Provincia
     || nCampo3 = Nombre Provincia

     nCampo1 = Campo + 1;
     nCampo2 = Campo + 2;
     |SI Campo = 24;
          nCampo3 = 107;
     |FINSI;
     |SI Campo = 54;
          nCampo3 = 101;
     |FINSI;
     |SI Campo = 64;
          nCampo1 = 63;
          nCampo2 = 65;
          nCampo3 = 104;
     |FINSI;
     |SI Campo = 84;
          nCampo3 = 105;
     |FINSI;
     |SI FSalida = 10;
          |SUB_EJECUTA "agimunic";
          |ABRE #100;
          |CONSULTA_CLAVE #1#100;
          |SI FSalida = 0;
               nCampo = Campo;
               #0nCampo = #100#0;     |PINTA #0nCampo;
               #0nCampo1 = #100#3;     |PINTA #0nCampo1;
               #0nCampo2 = (#100#0 % 102);     |PINTA #0nCampo2;
               #0nCampo3 = #100#2;     |PINTA #0nCampo3;
               |ACABA;
          |FINSI;
          |CIERRA #100;
     |FINSI;
     |ABRE #100;
     |SELECT #4#100;
     #100#0 = #0Campo;
     |LEE 000#100=;
     |SI FSalida = 0;
          |SI #0nCampo ! Contenido;
               nCampo = Campo;
               #0nCampo = #100#0;     |PINTA #0nCampo;
               #0nCampo1 = #100#3;     |PINTA #0nCampo1;
               #0nCampo2 = (#100#0 % 102);     |PINTA #0nCampo2;
               #0nCampo3 = #100#2;     |PINTA #0nCampo3;
          |FINSI;
     |SINO;
          |SI #0Campo ! "     ";
               nCampo = Campo;
               #0nCampo = "";     |PINTA #0nCampo;
               #0nCampo1 = "";     |PINTA #0nCampo1;
               #0nCampo2 = "";     |PINTA #0nCampo2;
               #0nCampo3 = "";     |PINTA #0nCampo3;
               |MENAV "    El Código Postal no existe. Pulse F2 para ver la lista."
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #100;
|FPRC;

|PROCESO LaBaja44; |TIPO 7;
     |SI #0Campo ! "S"; |Y #0Campo ! " ";
         #0Campo = " "; |PINTA #0Campo;
     |FINSI;
|FPRC;
