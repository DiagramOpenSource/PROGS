|FICHEROS;
    agiz0006 #0;

    agifigen #1;
    agiapl00 #900;
    agiapl01 #901;
    agicen00 #902;
    agicen01 #903;
    agicen02 #904;
    agicen03 #905;
    agicen04 #906;
    agicen05 #907;
    agicen06 #908;
    agicen07 #909;
    agicen08 #910;
    agicen09 #911;
    agicen10 #912;
    agiclgrc #913;
    agiclgrl #914;
    agitrabc #915;
    agitrabl #916;
    agiconpa #917;
    agim0001 #918;
    agim0002 #919;
    agim0004 #920;
    agim0007 #921;
    agim0011 #922;
    agim0012 #923;
    agicen11 #924;
    agicen12 #925;
    agicen13 #926;

    agicen19 #927;
    agicen20 #928;
    agicen21 #929;
    agicen22 #930;
    agicen23 #931;
    agicen24 #932;
    agicen25 #933;
    agicen26 #934;
    agicen27 #935;
    agicen28 #936;
|FIN;

|VARIABLES;
     &Empresa  = 0;

     Fiche     = 0;
     aRuta     = "";
     aAlfa     = "";
     aAlfa1    = "";
     aFichero  = "";
     nHandle   = 0;
     nSwBorrar = 0;
|FIN;

|| *************************************************************************
||                    PROCESO BORRADO DEL CLIENTE
|| *************************************************************************

|PROCESO Borra901;
|BORRA 140#901a;
|LIBERA #901;
|FPRC;

|DEFBUCLE agiapl01;
#901#1;
;
#900#0, 00;
#900#0, 99;
be;
NULL, Borra901;
|FIN;

|PROCESO BorraAdjunto;
|SI Fiche = 5;  |BUCLE agiapl01;                 |FINSI;

|SI Fiche = 900;  |BORRA 140#900a;  |LIBERA #900;  |FINSI;
|SI Fiche = 902;  |BORRA 140#902a;  |LIBERA #902;  |FINSI;
|SI Fiche = 903;  |BORRA 140#903a;  |LIBERA #903;  |FINSI;
|SI Fiche = 904;  |BORRA 140#904a;  |LIBERA #904;  |FINSI;
|SI Fiche = 905;  |BORRA 140#905a;  |LIBERA #905;  |FINSI;
|SI Fiche = 906;  |BORRA 140#906a;  |LIBERA #906;  |FINSI;
|SI Fiche = 907;  |BORRA 140#907a;  |LIBERA #907;  |FINSI;
|SI Fiche = 908;  |BORRA 140#908a;  |LIBERA #908;  |FINSI;
|SI Fiche = 909;  |BORRA 140#909a;  |LIBERA #909;  |FINSI;
|SI Fiche = 910;  |BORRA 140#910a;  |LIBERA #910;  |FINSI;
|SI Fiche = 911;  |BORRA 140#911a;  |LIBERA #911;  |FINSI;
|SI Fiche = 912;  |BORRA 140#912a;  |LIBERA #912;  |FINSI;
|SI Fiche = 913;  |BORRA 140#913a;  |LIBERA #913;  |FINSI;
|SI Fiche = 914;  |BORRA 140#914a;  |LIBERA #914;  |FINSI;
|SI Fiche = 915;  |BORRA 140#915a;  |LIBERA #915;  |FINSI;
|SI Fiche = 916;  |BORRA 140#916a;  |LIBERA #916;  |FINSI;
|SI Fiche = 917;  |BORRA 140#917a;  |LIBERA #917;  |FINSI;
|SI Fiche = 918;  |BORRA 140#918a;  |LIBERA #918;  |FINSI;
|SI Fiche = 919;  |BORRA 140#919a;  |LIBERA #919;  |FINSI;
|SI Fiche = 920;  |BORRA 140#920a;  |LIBERA #920;  |FINSI;
|SI Fiche = 921;  |BORRA 140#921a;  |LIBERA #921;  |FINSI;
|SI Fiche = 922;  |BORRA 140#922a;  |LIBERA #922;  |FINSI;
|SI Fiche = 923;  |BORRA 140#923a;  |LIBERA #923;  |FINSI;
|SI Fiche = 924;  |BORRA 140#924a;  |LIBERA #924;  |FINSI;
|SI Fiche = 925;  |BORRA 140#925a;  |LIBERA #925;  |FINSI;
|SI Fiche = 926;  |BORRA 140#926a;  |LIBERA #926;  |FINSI;
|SI Fiche = 927;  |BORRA 140#927a;  |LIBERA #927;  |FINSI;
|SI Fiche = 928;  |BORRA 140#928a;  |LIBERA #928;  |FINSI;
|SI Fiche = 929;  |BORRA 140#929a;  |LIBERA #929;  |FINSI;
|SI Fiche = 930;  |BORRA 140#930a;  |LIBERA #930;  |FINSI;
|SI Fiche = 931;  |BORRA 140#931a;  |LIBERA #931;  |FINSI;
|SI Fiche = 932;  |BORRA 140#932a;  |LIBERA #932;  |FINSI;
|SI Fiche = 933;  |BORRA 140#933a;  |LIBERA #933;  |FINSI;
|SI Fiche = 934;  |BORRA 140#934a;  |LIBERA #934;  |FINSI;
|SI Fiche = 935;  |BORRA 140#935a;  |LIBERA #935;  |FINSI;
|SI Fiche = 936;  |BORRA 140#936a;  |LIBERA #936;  |FINSI;
|FPRC;

|DEFBUCLE agiapl00;
#900#1;
1;
000000, Empresa;
999999, Empresa;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen00;
#902#1;
;
Empresa;
Empresa;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen01;
#903#1;
;
Empresa, 00;
Empresa, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen02;
#904#1;
;
Empresa, 00;
Empresa, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen03;
#905#1;
;
Empresa, 00;
Empresa, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen04;
#906#1;
;
Empresa, 00;
Empresa, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen05;
#907#1;
;
Empresa, 00;
Empresa, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen06;
#908#1;
;
Empresa, 00, 00;
Empresa, 99, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen07;
#909#1;
;
Empresa, 00;
Empresa, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen08;
#910#1;
;
Empresa, 00;
Empresa, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen09;
#911#1;
;
Empresa, 00;
Empresa, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen10;
#912#1;
;
Empresa, 00, 00;
Empresa, 99, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen11;
#924#1;
;
Empresa, 00;
Empresa, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen12;
#925#1;
;
Empresa, 00;
Empresa, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen13;
#926#1;
;
Empresa, 00, 00;
Empresa, 99, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agiclgrc;
#913#1;
;
Empresa, 0000;
Empresa, 9999;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agiclgrl;
#914#1;
;
Empresa, 0000, 0000;
Empresa, 9999, 9999;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agitrabc;
#915#1;
;
Empresa;
Empresa;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agitrabl;
#916#1;
;
Empresa, 0000;
Empresa, 9999;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agiconpa;
#917#1;
;
Empresa, 00;
Empresa, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agim0001;
#918#1;
;
Empresa, 00;
Empresa, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agim0002;
#919#1;
;
Empresa, 00, 0000;
Empresa, 99, 2999;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agim0004;
#920#1;
;
Empresa, 00;
Empresa, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agim0007;
#921#1;
;
Empresa, "01.01.0000";
Empresa, "31.12.2999";
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agim0011;
#922#1;
;
Empresa;
Empresa;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agim0012;
#923#1;
;
Empresa, 0000;
Empresa, 9999;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen19;
#927#1;
;
"   ", Empresa;
"zzz", Empresa;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen20;
#928#1;
;
Empresa, 00;
Empresa, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen21;
#929#1;
;
Empresa, 00;
Empresa, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen22;
#930#1;
;
Empresa, 00;
Empresa, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen23;
#931#1;
;
Empresa, 00, 00;
Empresa, 99, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen24;
#932#1;
;
Empresa, 00, 00, 00;
Empresa, 99, 99, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen25;
#933#1;
;
Empresa, 00, 00;
Empresa, 99, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen26;
#934#1;
;
Empresa, 00, 00;
Empresa, 99, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen27;
#935#1;
;
Empresa, 00, 00;
Empresa, 99, 99;
be;
NULL, BorraAdjunto;
|FIN;

|DEFBUCLE agicen28;
#936#1;
;
Empresa, 00, 00, 00;
Empresa, 99, 99, 99;
be;
NULL, BorraAdjunto;
|FIN;

|PROCESO Tipo3;
     Empresa = #0#0;

     |PINTA 0813, #0#0;
     |PINTA 0821, #0#1;

     Fiche = 900;   |BUCLE agiapl00;
     Fiche = 902;   |BUCLE agicen00;
     Fiche = 903;   |BUCLE agicen01;
     Fiche = 904;   |BUCLE agicen02;
     Fiche = 905;   |BUCLE agicen03;
     Fiche = 906;   |BUCLE agicen04;
     Fiche = 907;   |BUCLE agicen05;
     Fiche = 908;   |BUCLE agicen06;
     Fiche = 909;   |BUCLE agicen07;
     Fiche = 910;   |BUCLE agicen08;
     Fiche = 911;   |BUCLE agicen09;
     Fiche = 912;   |BUCLE agicen10;
     Fiche = 913;   |BUCLE agiclgrc;
     Fiche = 914;   |BUCLE agiclgrl;
     Fiche = 915;   |BUCLE agitrabc;
     Fiche = 916;   |BUCLE agitrabl;
     Fiche = 917;   |BUCLE agiconpa;
     Fiche = 918;   |BUCLE agim0001;
     Fiche = 919;   |BUCLE agim0002;
     Fiche = 920;   |BUCLE agim0004;
     Fiche = 921;   |BUCLE agim0007;
     Fiche = 922;   |BUCLE agim0011;
     Fiche = 923;   |BUCLE agim0012;
     Fiche = 924;   |BUCLE agicen11;
     Fiche = 925;   |BUCLE agicen12;
     Fiche = 926;   |BUCLE agicen13;
     Fiche = 927;   |BUCLE agicen19;
     Fiche = 928;   |BUCLE agicen20;
     Fiche = 929;   |BUCLE agicen21;
     Fiche = 930;   |BUCLE agicen22;
     Fiche = 931;   |BUCLE agicen23;
     Fiche = 932;   |BUCLE agicen24;
     Fiche = 933;   |BUCLE agicen25;
     Fiche = 934;   |BUCLE agicen26;
     Fiche = 935;   |BUCLE agicen27;
     Fiche = 936;   |BUCLE agicen28;

     |SI nSwBorrar = 1;
         #1#0 = #0#0; |BORRA 040#1c; |LIBERA #1;
     |FINSI;
|FPRC;

|DEFBUCLE agiz0006;
     #0#1;
     ;
     00001;
     99999;
     ;
     NULL, Tipo3;
|FIN;

|RUTINA ClaveBaja0;
     #0#0 = 1;
|FRUT;

|RUTINA ClaveAlta0;
     #0#0 = 99999;
|FRUT;

|PROCESO Tipo11;  |TIPO 11;
     |SI FSalida ! 13;  |ACABA;  |FINSI;

     aRuta = "F";
     |BROWSE aRuta;
     aRuta = aRuta % 299;

     |QBF aRuta;
     |SI aRuta = "";  |ACABA;  |FINSI;

     |XABRE "C", aRuta, nHandle;
     |SI FSalida ] 0;
         |PARA;  |SI;  |HACIENDO;
              |XLEE nHandle, 254, aAlfa;
              |SI FSalida < 0;  |SAL;  |FINSI;
              aAlfa1 = aAlfa % 106;  #0#0 = aAlfa;
              |LEE 101#0=;
              |SI FSalida ! 0;
                  aAlfa1 = aAlfa % 106;  #0#0 = aAlfa1;
                  aAlfa1 = aAlfa % 740;  #0#1 = aAlfa1;
                  |GRABA 020#0n;
              |FINSI;
              |LIBERA #0;
          |SIGUE;
     |FINSI;
     |XCIERRA nHandle;

     |PTEC 812;
     |PONCONTROL 23, "SI";
|FPRC;

|PROGRAMA;
     nSwBorrar = 0;
     |SI Empresa = 0;
          nSwBorrar = 1;
          aFichero = (Usuario + "zzzzzzzz") % 108;
          |NOME_DAT #0 aFichero;
          |ABRE #0;  |CIERRA #0;  |DELINDEX #0;

          |CLS;
          |CABEZA "Borrado General";
          |ENTLINEAL #1#0, -1, 2, 22, 1, ClaveBaja0, ClaveAlta0;
          |CONFI "    SRealizamos el Borrado ";
          |SI FSalida = 0;
              |ABRE #1;
              |BUCLE agiz0006;
              |CIERRA #1;
          |FINSI;
          |ACABA;
     |FINSI;

     #0#0 = Empresa;
     |HAZ Tipo3;
|FPRO;
