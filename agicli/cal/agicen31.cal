|FICHEROS;
     agifigen #1;
     agicen31 #31;
     agiw0050 #950,MANTE;
     agiw0051 #951,MANTE;
     agiw0052 #952,MANTE;
     agiw0053 #953,MANTE;
     agiw0060 #960,MANTE;
|FIN;

|VARIABLES;
     nCampoD     = 0;
     nCampoH     = 0;

     &enEmpresa  = 0;
     &enRegistro = 0;
     &eaTipo     = "";
     &enOpcion   = 0;
|FIN;

|PROCESO TipoA;
     |DDEFECTO #950;

     |PARA nCampoD = 0;  |SI nCampoD [ 14;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 2;
           #950nCampoD = #21nCampoH;
     |SIGUE;

     |PARA nCampoD = 15;  |SI nCampoD [ 25;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 3;
           #950nCampoD = #21nCampoH;
     |SIGUE;

     |PARA nCampoD = 26;  |SI nCampoD [ 30;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 45;
           #950nCampoD = #21nCampoH;
     |SIGUE;

     |PINPA #0#950;
     |PINDA #0#950;
     |ENDATOS #1#950;
     |SI FSalida = 0;
         |PARA nCampoD = 0;  |SI nCampoD [ 14;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH = nCampoD + 2;
               #21nCampoH = #950nCampoD;
         |SIGUE;

         |PARA nCampoD = 15;  |SI nCampoD [ 25;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH = nCampoD + 3;
               #21nCampoH = #950nCampoD;
         |SIGUE;

         |PARA nCampoD = 26;  |SI nCampoD [ 30;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH = nCampoD + 45;
               #21nCampoH = #950nCampoD;
         |SIGUE;
     |FINSI;

     |PDEFECTO #21, 29, 71;
|FPRC;

|PROCESO TipoB;
     |DDEFECTO #951;

     |PARA nCampoD = 0;  |SI nCampoD [ 39;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 2;
           #951nCampoD = #21nCampoH;
     |SIGUE;

     |PARA nCampoD = 40;  |SI nCampoD [ 44;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 31;
           #951nCampoD = #21nCampoH;
     |SIGUE;

     |PINPA #0#951;
     |PINDA #0#951;
     |ENDATOS #1#951;
     |SI FSalida = 0;
         |PARA nCampoD = 0;  |SI nCampoD [ 39;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH = nCampoD + 2;
               #21nCampoH = #951nCampoD;
         |SIGUE;

         |PARA nCampoD = 40;  |SI nCampoD [ 44;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH = nCampoD + 31;
               #21nCampoH = #951nCampoD;
         |SIGUE;
     |FINSI;

     |PDEFECTO #21, 42, 71;
|FPRC;

|PROCESO TipoC;
     |DDEFECTO #952;

     |PARA nCampoD = 0;  |SI nCampoD [ 15;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 2;
           #952nCampoD = #21nCampoH;
     |SIGUE;

     |PARA nCampoD = 16;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 26;
           #952nCampoD = #21nCampoH;
     |SIGUE;

     |PARA nCampoD = 38;  |SI nCampoD [ 42;  |HACIENDO nCampoD = nCampoD + 1;
            nCampoH = nCampoD + 33;
           #952nCampoD = #21nCampoH;
     |SIGUE;

     |PINPA #0#952;
     |PINDA #0#952;
     |ENDATOS #1#952;
     |SI FSalida = 0;
         |PARA nCampoD = 0;  |SI nCampoD [ 15;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH = nCampoD + 2;
               #21nCampoH = #952nCampoD;
         |SIGUE;

         |PARA nCampoD = 16;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH = nCampoD + 26;
               #21nCampoH = #952nCampoD;
         |SIGUE;

         |PARA nCampoD = 38;  |SI nCampoD [ 42;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH = nCampoD + 33;
               #21nCampoH = #952nCampoD;
         |SIGUE;
     |FINSI;

     |PDEFECTO #21, 18, 42;
     |PDEFECTO #21, 64, 71;
|FPRC;

|PROCESO TipoD;
     |DDEFECTO #953;

     |PARA nCampoD = 0;  |SI nCampoD [ 26;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 2;
           #953nCampoD = #21nCampoH;
     |SIGUE;

     |PARA nCampoD = 27;  |SI nCampoD [ 38;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 37;
           #953nCampoD = #21nCampoH;
     |SIGUE;

     |PINPA #0#953;
     |PINDA #0#953;
     |ENDATOS #1#953;
     |SI FSalida = 0;
         |PARA nCampoD = 0;  |SI nCampoD [ 26;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH = nCampoD + 2;
               #21nCampoH = #953nCampoD;
         |SIGUE;

         |PARA nCampoD = 27;  |SI nCampoD [ 38;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH = nCampoD + 37;
               #21nCampoH = #953nCampoD;
         |SIGUE;
     |FINSI;

     |PDEFECTO #21, 29, 64;
|FPRC;

|PROCESO Punto9;
     |DDEFECTO #960;

     |PARA nCampoD = 0;  |SI nCampoD [ 78;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH     = nCampoD + 76;
           #960nCampoD = #21nCampoH;
     |SIGUE;

     |PINPA #0#960;
     |PINDA #0#960;
     |ENDATOS #1#960;
     |SI FSalida = 0;
         |PARA nCampoD = 0;  |SI nCampoD [ 78;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH    = nCampoD + 76;
               #21nCampoH = #960nCampoD;
         |SIGUE;
     |FINSI;
|FPRC;

|PROGRAMA;
     |ABRE #21;
     #21#0 = enEmpresa;
     #21#1 = enRegistro;
     |LEE 101#21=;
     |SI FSalida ! 0;
         |DDEFECTO #21;
         #21#0 = enEmpresa;
         #21#1 = enRegistro;

         |ABRE #1;
         #1#0 = #21#0;
         |LEE 040#1=;
         |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
         |CIERRA #1;

         #21#2  = #1#13;
         #21#3  = #1#1;
         #21#4  = #1#3;
         #21#5  = #1#4;
         #21#6  = #1#5;
         #21#7  = #1#6;
         #21#8  = #1#7;
         #21#9  = #1#8;
         #21#10 = #1#14;
         #21#11 = #1#9;
         #21#12 = #1#10;
         #21#13 = #1#11;
         #21#14 = #1#12;
         #21#71 = #1#11;

         |GRABA 020#21b;
     |FINSI;

     |SI enOpcion = 1;
         |SI eaTipo = "A";  |HAZ TipoA;  |FINSI;
         |SI eaTipo = "B";  |HAZ TipoB;  |FINSI;
         |SI eaTipo = "C";  |HAZ TipoC;  |FINSI;
         |SI eaTipo = "D";  |HAZ TipoD;  |FINSI;
     |FINSI;

     |SI enOpcion = 9;      |HAZ Punto9;  |FINSI;

     |GRABA 020#21a;
     |LIBERA #21;

     |CIERRA #21;
|FPRO;
