|FICHEROS;
     agiy0016 #0;        || Este Def
     agifigen #1;        || Ficha de Clientes
     agicen01 #2;        || Acceso Censo Lineas
|FIN;

|VARIABLES;
     XPara = 0;
|FIN;

|INCLUYE i_consul;

|PROCESO Mayor; |TIPO 0;
  #0Campo = #0Campo > #0Campo;
  |PINTA #0Campo;
|FPRC;

|PROCESO SelecEmpre;
  |SI #0#2 = "S";
      |C_M #0#3, 1, "S";
      |C_M #0#4, 1, "S";
      |PARA XPara = 5; |SI XPara [ 24; |HACIENDO XPara = XPara + 1;
            |C_M #0XPara, 1, "N";  #0XPara = 0; |PINTA #0XPara;
      |SIGUE;
  |SINO;
      |C_M #0#3, 1, "N";  #0#3 =     1;  |PINTA #0#3;
      |C_M #0#4, 1, "N";  #0#4 = 99999;  |PINTA #0#4;
      |PARA XPara = 5; |SI XPara [ 24; |HACIENDO XPara = XPara + 1;
            |C_M #0XPara, 1, "S";
      |SIGUE;
  |FINSI;
|FPRC;

|PROCESO SelecTEmpre;
  |SI #0#25 = "S";
      |C_M #0#26, 1, "S";
      |C_M #0#27, 1, "S";
      |C_M #0#28, 1, "N";  #0#28 = 0;  |PINTA #0#28;
      |C_M #0#29, 1, "N";  #0#29 = 0;  |PINTA #0#29;
      |C_M #0#30, 1, "N";  #0#30 = 0;  |PINTA #0#30;
  |SINO;
      |C_M #0#26, 1, "N";  #0#26 = 00; |PINTA #0#26;
      |C_M #0#27, 1, "N";  #0#27 = 99; |PINTA #0#27;
      |C_M #0#28, 1, "S";
      |C_M #0#29, 1, "S";
      |C_M #0#30, 1, "S";
  |FINSI;
|FPRC;

|PROCESO SelecIVA;
  |SI #0#31 = "S";
      |C_M #0#32, 1, "S";
      |C_M #0#33, 1, "S";
      |C_M #0#34, 1, "N";  #0#34 = 0;  |PINTA #0#34;
      |C_M #0#35, 1, "N";  #0#35 = 0;  |PINTA #0#35;
      |C_M #0#36, 1, "N";  #0#36 = 0;  |PINTA #0#36;
  |SINO;
      |C_M #0#32, 1, "N";  #0#32 = 00; |PINTA #0#32;
      |C_M #0#33, 1, "N";  #0#33 = 99; |PINTA #0#33;
      |C_M #0#34, 1, "S";
      |C_M #0#35, 1, "S";
      |C_M #0#36, 1, "S";
  |FINSI;
|FPRC;

|PROCESO SelecTributa;
  |SI #0#37 = "S";
      |C_M #0#38, 1, "S";
      |C_M #0#39, 1, "S";
      |C_M #0#40, 1, "N";  #0#40 = 0;  |PINTA #0#40;
      |C_M #0#41, 1, "N";  #0#41 = 0;  |PINTA #0#41;
      |C_M #0#42, 1, "N";  #0#42 = 0;  |PINTA #0#42;
  |SINO;
      |C_M #0#38, 1, "N";  #0#38 = 00; |PINTA #0#38;
      |C_M #0#39, 1, "N";  #0#39 = 99; |PINTA #0#39;
      |C_M #0#40, 1, "S";
      |C_M #0#41, 1, "S";
      |C_M #0#42, 1, "S";
  |FINSI;
|FPRC;

|PROCESO SelecActivi;
  |SI #0#43 = "S";
      |C_M #0#44, 1, "S";
      |C_M #0#45, 1, "S";
      |C_M #0#46, 1, "N";  #0#46 = 0;  |PINTA #0#46;
      |C_M #0#47, 1, "N";  #0#47 = 0;  |PINTA #0#47;
      |C_M #0#48, 1, "N";  #0#48 = 0;  |PINTA #0#48;
  |SINO;
      |C_M #0#44, 1, "N";  #0#44 = 00; |PINTA #0#44;
      |C_M #0#45, 1, "N";  #0#45 = 99; |PINTA #0#45;
      |C_M #0#46, 1, "S";
      |C_M #0#47, 1, "S";
      |C_M #0#48, 1, "S";
  |FINSI;
|FPRC;

|PROCESO Imprime;
  |SI #0#31 = "S";
      |SI #2#8 < #0#32; |O #2#8 > #0#33; |ACABA; |FINSI;
  |SINO;
      |SI #2#8 ! #0#34; |Y #2#8 ! #0#35; |Y #2#8 ! #0#36;  |ACABA;  |FINSI;
  |FINSI;

  |SI #0#37 = "S";
      |SI #2#10 < #0#38; |O #2#10 > #0#39; |ACABA; |FINSI;
  |SINO;
      |SI #2#10 ! #0#40; |Y #2#10 ! #0#41; |Y #2#10 ! #0#42;  |ACABA;  |FINSI;
  |FINSI;

  |SI #0#43 = "S";
      |SI #2#12 < #0#44; |O #2#12 > #0#45; |ACABA; |FINSI;
  |SINO;
      |SI #2#12 ! #0#46; |Y #2#12 ! #0#47; |Y #2#12 ! #0#48;  |ACABA;  |FINSI;
  |FINSI;

  |PRINT;
  |PIEINF;
|FPRC;

|DEFBUCLE agicen01;
  #2#1;
  ;
  #1#0, 00;
  #1#0, 99;
  ;
  NULL, Imprime;
|FIN;

|PROCESO FichaCliente;
  |SI #0#25 = "S";
      |SI #1#87 < #0#26; |O #1#87 > #0#27; |ACABA; |FINSI;
  |SINO;
      |SI #1#87 ! #0#28; |Y #1#87 ! #0#29; |Y #1#87 ! #0#30;  |ACABA;  |FINSI;
  |FINSI;

  |BUCLE agicen01;
|FPRC;

|DEFBUCLE agifigen;
  #1#1;
  ;
  #0#3;
  #0#4;
  ;
  NULL, FichaCliente;
|FIN;

|PROCESO Tipo3; |TIPO 3;
  |IMPRE 0;
  |SI FSalida ! 0; |ACABA; |FINSI;

  |INFOR "agiy0016";
  |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;

  |SI #0#2 = "S";
      |BUCLE agifigen;
  |SINO;
      |PARA XPara = 5; |SI XPara [ 24; |HACIENDO XPara = XPara + 1;
            #0#3  = #0XPara;
            #0#4  = #0XPara;
            |BUCLE agifigen;
      |SIGUE;
  |FINSI;
  |FININF;
  |FINIMP;
|FPRC;
