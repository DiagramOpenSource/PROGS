|FICHEROS;
     agicen42 #0;
     agifigen;
|FIN;

|VARIABLES;
     nCampo     = 0;
     nCampo1    = 0;
     nCampo2    = 0;
     aAlfa1     = "";
     aAlfa2     = "";
     fFecha     = @;

     &eaVarDni  = "";
     &enCalcCif = 0;

     &eaTabla    = "";
     &eaDestino  = "";
     &eaAlfa     = "";
     &enError    = 0;
     &enComp     = 0;
     &enPosicion = 0;
     &enEmpresa  = 0;
     aAlfa = "";
|FIN;

|PROCESO DatosEmp42; |TIPO 7;
     |ABRE #agifigen;
     #agifigen#0 = enEmpresa;
     |LEE 000#agifigen.=;
     |SI FSalida = 0;
          aAlfa = #0#2;
          |QBF aAlfa;
          |SI aAlfa = "";
               #0#2 = #agifigen#13;
          |FINSI;
          |PINTA #0#2;

          aAlfa = #0#3;
          |QBF aAlfa;
          |SI aAlfa = "";
               #0#3 = #agifigen#2;
          |FINSI;
          |PINTA #0#3;
     |FINSI;
     |CIERRA #agifigen;
|FPRC;

|PROCESO Cese42_2;
     |C_M #0#29, 1, "S";
     |C_M #0#30, 1, "S";
     |SI #0#28 ! "S";
         |C_M #0#29, 1, "N";  #0#29 = "";            |PINTA #0#29;
                              #0#35 = "";            |PINTA #0#35;
         |C_M #0#30, 1, "N";  #0#30 = "01.01.0000";  |PINTA #0#30;
     |FINSI;
|FPRC;

|PROCESO Cese42_1;
     |C_M #0#27, 1, "S";
     |SI #0#26 ! "S";
         |C_M #0#27, 1, "N";  #0#27 = "";            |PINTA #0#27;
     |FINSI;
|FPRC;

|PROCESO SacaCese42;  |TIPO 7;
     fFecha = ~;
     |SI fFecha ] "01.07.2018";
         eaTabla = "txtn1008.txt";
     |SINO;
         eaTabla = "txtn0008.txt";
     |FINSI;
     |HAZ CargaTabla;
     FSalida = 0;
|FPRC;

|PROCESO CompCese42;  |TIPO 0;
     nCampo   = Campo + 1;
     |SI FSalida = 10;
         enPosicion = 10;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 101;
         #0Campo  = aAlfa1;
         |PINTA #0Campo;
     |FINSI;

     enComp = 1;
     eaAlfa = #0Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 101;
     aAlfa2   = eaDestino % 365;
     #0Campo  = aAlfa1;
     #0#35 = aAlfa2;

     |PINTA #0Campo;
     |PINTA #0#35;

     |HAZ FinTabla;
     |SI #0#28 = "S"; |Y fFecha ] "01.07.2018";
         |SI #0Campo = "2"; |O #0Campo = "4"; |O #0Campo = "5";
            |O #0Campo = "6"; |O #0Campo = "A";
               |MENAV "0000Recuerde introducir el detalle de sucesores de la pagina 9";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO LetraDni42;  |TIPO 6;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     eaVarDni  = #0Campo;
     enCalcCif = 1;
     |HAZ CalculoDNI;
     #0Campo = eaVarDni;
     |PINTA #0Campo;
|FPRC;

|PROCESO SacaCali42;  |TIPO 7;
     eaTabla = "txtn1005.txt";
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompCali42;  |TIPO 0;
     nCampo   = Campo + 1;
     |SI FSalida = 10;
         enPosicion = 55;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 102;
         #0Campo  = aAlfa1;
         |PINTA #0Campo;
     |FINSI;

     enComp = 2;
     eaAlfa = #0Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 102;
     aAlfa2   = eaDestino % 415;
     #0Campo  = aAlfa1;
     #0#36 = aAlfa2;

     |PINTA #0Campo;
     |PINTA #0#36;

     |HAZ FinTabla;
|FPRC;
