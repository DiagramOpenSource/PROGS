|FICHEROS;
    agitraba #0;
    asconcep #1;
    agifigen #2;
    agicontr #98;
    agitrabd #3;
|FIN;

|VARIABLES;
   path_fich  = "";
   path_pan   = "";
   empresa    = "";
   longi      = "";
   num        = 0;
   sino       = "";
   nada       = "";
   tope       = 0;
|FIN;

|PROCESO la_empresa;
empresa = #2#40;
|ERROR10;
|FPRC;

|DEFBUCLE agifigen;
#2#1;
40;
00001, 01;
99999, 99;
;
NULL, la_empresa;
|FIN;

|PROCESO tipo_8; |TIPO 8;
|DBASS path_fich;
|PATH_DAT #98  path_fich;
|ABRE #98;
|LEE 040#98p;
|SI FSalida ! 0; |DDEFECTO #98; |FINSI;
|CIERRA #98;

path_fich = #98#1; |QBF path_fich;

longi = path_fich % A0;
num   = longi;
num   = 100 + (num - 5);
longi = num;

path_pan  = (path_fich % longi) + "pan/";

|BUCLE agifigen;
empresa = ("00" + empresa) % -102;
path_fich = path_fich + empresa + "/";

|PATH_DAT #1 path_fich;
|PATH_PAN #1 path_pan;
|FPRC;

|PROCESO pantalla; |TIPO 0;
|SI FSalida ! 9; |ACABA; |FINSI;

|PUSHV 0501 2380;
|CUADRO 0856 1577;

|ATRI R;
|PINTA 0957, " 01 al 12 Meses     ";
|PINTA 1057, " 13.- Mensual       ";
|PINTA 1157, " 14.- Bimensual     ";
|PINTA 1257, " 15.- Trimestral    ";
|PINTA 1357, " 16.- Cuatrimestral ";
|PINTA 1457, " 17.- Semestral     ";
|ATRI r;

|PAUSA;
|POPV;

|ERROR;
|FPRC;

|PROCESO filtros; |TIPO 0;
tope = 31;

|SI #0#2 = 2;  tope = 29; |FINSI;
|SI #0#2 = 4;  tope = 30; |FINSI;
|SI #0#2 = 6;  tope = 30; |FINSI;
|SI #0#2 = 9;  tope = 30; |FINSI;
|SI #0#2 = 11; tope = 30; |FINSI;

|SI tope < #0#3;
    |MENAV "      El dia no coincide con los dias del mes introducido.";
    |ERROR;
|FINSI;
|FPRC;

|PROCESO filtrosl; |TIPO 0;
tope = 31;

|SI #3#6 = 2;  tope = 29; |FINSI;
|SI #3#6 = 4;  tope = 30; |FINSI;
|SI #3#6 = 6;  tope = 30; |FINSI;
|SI #3#6 = 9;  tope = 30; |FINSI;
|SI #3#6 = 11; tope = 30; |FINSI;

|SI tope < #3#7;
    |MENAV "      El dia no coincide con los dias del mes introducido.";
    |ERROR;
|FINSI;
|FPRC;

|PROCESO dia_mes; |TIPO 7;
|SI #3#6 = 0; |Y #3#7 = 1;
    #3#6 = #0#2; |PINTA #3#6;
    #3#7 = #0#3; |PINTA #3#7;
|FINSI;
|FPRC;

|PROCESO concepto; |TIPO 0;
sino = #3#3;
|CAMPO_MODIFICA #3#4, 1, sino;
|CAMPO_MODIFICA #3#5, 1, sino;
|SI sino = "N";
    #3#4 = ""; |PINTA #3#4;
    #3#5 = ""; |PINTA #3#5;
|FINSI;
|FPRC;

|PROCESO existe_conc; |TIPO 0;
|SI #3#3 = "N"; |ACABA; |FINSI;

|SI empresa = ""; |HAZ tipo_8; |FINSI;
|ABRE #1;
#1#0 = #3#4;
#1#1 = #3#5;
|LEE 040#1=;
|SI FSalida ! 0;
    |MENAV "      No existe el concepto en Minutacion ";
    |ERROR;
|FINSI;
|CIERRA #1;
|FPRC;


|PROCESO descri1; |TIPO 0;
nada = #1#16; |QBF nada;
|SI nada = ""; #1#16 = #1#2; |PINTA #1#16; |FINSI;
|FPRC;

|PROCESO ttconcep;
|FPRC;
