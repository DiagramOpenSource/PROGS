|FICHEROS;
    agiparen #0;
    agifigen #1;
    redatc94 #2;
    redatc95 #102;
    redatc96 #202;
    redatc97 #203;
    redatc98 #204;
    redatc99 #205;
    redatc00 #206;
    redatc01 #207;
    redatc02 #208;
    redatc03 #209;
    redatc04 #210;
    redatc05 #211;
    redatc06 #212;
    redatc07 #213;
    agicontr #99;
    agiprovi #4;
|FIN;

|VARIABLES;
    contador = 0;
    sw = 0;
    informe = "paserror"
    aviso1 = "     NO EXISTE INFORME";
    aviso2 = "     NO EXISTE IMPRESORA";
    ficha = "";
    nada = "";
    nada1 = "";
    codi1 = "";
    codi2 = "";
    &aplica = "";
    &codigo = 0;
    &nombre1 = "";
    &nombre2 = "";
    &cif1 = "";
    &cif2 = "";
    directorio = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    QueRenta = "";
|FIN;

|PROCESO provincia;
     |ABRE #4;
     #4#0 = #1#9;
     |LEE 001#4=;
     |SI FSalida ! 0;  |DDEFECTO #4;  |FINSI;
     |CIERRA #4;
|FPRC;

|PROCESO pon_demas;
     #1#41 = #1#3;
     #1#42 = #1#4;
     #1#43 = #1#5;
     #1#44 = #1#6;
     #1#45 = #1#7;
     #1#46 = #1#8;
     #1#47 = #1#9;
     #1#48 = #1#10;
     #1#49 = #1#11;
     #1#50 = #1#12;

     #1#51 = #1#3;
     #1#52 = #1#4;
     #1#53 = #1#5;
     #1#54 = #1#6;
     #1#55 = #1#7;
     #1#56 = #1#8;
     #1#57 = #1#9;
     #1#58 = #1#10;
     #1#59 = #1#11;
     #1#60 = #1#12;
|FPRC;

|PROCESO noexiste94;
     contador = contador + 1;
     #1#00 = #2#0;        || codigo empresa
     #1#01 = #2#1;        || razon social
     #1#02 = #2#1;        || nombre comercial
     #1#03 = #2#6;        || sg
     #1#04 = #2#7;        || direccion
     #1#05 = #2#8;        || numero
     #1#06 = #2#9;        || escalera
     #1#07 = #2#10;       || piso
     #1#08 = #2#11;       || puerta
     #1#16 = #2#16;       || codigo postal
     nume1 = #1#16;
     #1#09 = (nume1 - (nume1 $ 1000)) / 1000;      || codigo provincia
     #1#10 =  nume1 $ 1000;                        || codigo poblacion
     #1#11 = #2#14;       || poblacion
     |HAZ provincia;
     #1#12 = #4#1;        || provincia
     #1#13 = #2#2;        || cif
     #1#14 = #2#15;       || telefono
     #1#15 = "";          || fax
     #1#22 = "S";         || renta 'SI'
     |HAZ pon_demas;
     |GRABA 020#1n;
     |ATRI I;
     |SI FSalida = 0; |PINTA 1344, contador;  |FINSI;
     |ATRI 0;
|FPRC;

|PROCESO existe94;
     cif1 = #1#13;  |QBF cif1;
     cif2 = #2#2;   |QBF cif2;
     |SI cif1 ! cif2;
         sw      = 1;
         nombre1 = #1#1;
         nombre2 = #2#1;
         codigo  = #1#0;
         aplica  = directorio;
         |PRINT;
     |SINO;
         #1#22 = "S";
         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
|FPRC;

|PROCESO pasafich94;
     |DDEFECTO #1;
     #1#0 = #2#0;
     |LEE 101#1=;
     |SI FSalida = 0; |HAZ existe94; |SINO; |HAZ noexiste94; |FINSI;
|FPRC;

|DEFBUCLE agiren94;
     #2#1;
     ;
     #0#0;
     #0#1;
     ;
     NULL, pasafich94;
|FIN;

|PROCESO noexiste95;
     contador = contador + 1;
     #1#00 = #102#0;        || codigo empresa
     #1#01 = #102#1;        || razon social
     #1#02 = #102#1;        || nombre comercial
     #1#03 = #102#6;        || sg
     #1#04 = #102#7;        || direccion
     #1#05 = #102#8;        || numero
     #1#06 = #102#9;        || escalera
     #1#07 = #102#10;       || piso
     #1#08 = #102#11;       || puerta
     #1#16 = #102#16;       || codigo postal
     nume1 = #1#16;
     #1#09 = (nume1 - (nume1 $ 1000)) / 1000;      || codigo provincia
     #1#10 =  nume1 $ 1000;                        || codigo poblacion
     #1#11 = #102#14;       || poblacion
     |HAZ provincia;
     #1#12 = #4#1;        || provincia
     #1#13 = #102#2;        || cif
     #1#14 = #102#15;       || telefono
     #1#15 = "";          || fax
     #1#22 = "S";         || renta 'SI'
     |HAZ pon_demas;
     |GRABA 020#1n;
     |ATRI I;
     |SI FSalida = 0; |PINTA 1344, contador;  |FINSI;
     |ATRI 0;
|FPRC;

|PROCESO existe95;
     cif1 = #1#13;  |QBF cif1;
     cif2 = #102#2;   |QBF cif2;
     |SI cif1 ! cif2;
         sw      = 1;
         nombre1 = #1#1;
         nombre2 = #102#1;
         codigo  = #1#0;
         aplica  = directorio;
         |PRINT;
     |SINO;
         #1#22 = "S";
         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
|FPRC;

|PROCESO pasafich95;
     |DDEFECTO #1;
     #1#0 = #102#0;
     |LEE 101#1=;
     |SI FSalida = 0; |HAZ existe95; |SINO; |HAZ noexiste95; |FINSI;
|FPRC;

|DEFBUCLE agiren95;
     #102#1;
     ;
     #0#0;
     #0#1;
     e;
     NULL, pasafich95;
|FIN;

|PROCESO noexiste96;
     contador = contador + 1;
     #1#00 = #202#0;        || codigo empresa
     #1#01 = #202#1;        || razon social
     #1#02 = #202#1;        || nombre comercial
     #1#03 = #202#6;        || sg
     #1#04 = #202#7;        || direccion
     #1#05 = #202#8;        || numero
     #1#06 = #202#9;        || escalera
     #1#07 = #202#10;       || piso
     #1#08 = #202#11;       || puerta
     #1#16 = #202#16;       || codigo postal
     nume1 = #1#16;
     #1#09 = (nume1 - (nume1 $ 1000)) / 1000;      || codigo provincia
     #1#10 =  nume1 $ 1000;                        || codigo poblacion
     #1#11 = #202#14;       || poblacion
     |HAZ provincia;
     #1#12 = #4#1;        || provincia
     #1#13 = #202#2;        || cif
     #1#14 = #202#15;       || telefono
     #1#15 = "";          || fax
     #1#22 = "S";         || renta 'SI'
     |HAZ pon_demas;
     |GRABA 020#1n;
     |ATRI I;
     |SI FSalida = 0; |PINTA 1344, contador;  |FINSI;
     |ATRI 0;
|FPRC;

|PROCESO existe96;
     cif1 = #1#13;  |QBF cif1;
     cif2 = #202#2;   |QBF cif2;
     |SI cif1 ! cif2;
         sw      = 1;
         nombre1 = #1#1;
         nombre2 = #202#1;
         codigo  = #1#0;
         aplica  = directorio;
         |PRINT;
     |SINO;
         #1#22 = "S";
         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
|FPRC;

|PROCESO pasafich96;
     |DDEFECTO #1;
     #1#0 = #202#0;
     |LEE 101#1=;
     |SI FSalida = 0; |HAZ existe96; |SINO; |HAZ noexiste96; |FINSI;
|FPRC;

|DEFBUCLE agiren96;
     #202#1;
     ;
     #0#0;
     #0#1;
     ;
     NULL, pasafich96;
|FIN;

|PROCESO noexiste97;
     contador = contador + 1;
     #1#00 = #203#0;        || codigo empresa
     #1#01 = #203#1;        || razon social
     #1#02 = #203#1;        || nombre comercial
     #1#03 = #203#6;        || sg
     #1#04 = #203#7;        || direccion
     #1#05 = #203#8;        || numero
     #1#06 = #203#9;        || escalera
     #1#07 = #203#10;       || piso
     #1#08 = #203#11;       || puerta
     #1#16 = #203#16;       || codigo postal
     nume1 = #1#16;
     #1#09 = (nume1 - (nume1 $ 1000)) / 1000;      || codigo provincia
     #1#10 =  nume1 $ 1000;                        || codigo poblacion
     #1#11 = #203#14;       || poblacion
     |HAZ provincia;
     #1#12 = #4#1;        || provincia
     #1#13 = #203#2;        || cif
     #1#14 = #203#15;       || telefono
     #1#15 = "";          || fax
     #1#22 = "S";         || renta 'SI'
     |HAZ pon_demas;
     |GRABA 020#1n;
     |ATRI I;
     |SI FSalida = 0; |PINTA 1344, contador;  |FINSI;
     |ATRI 0;
|FPRC;

|PROCESO existe97;
     cif1 = #1#13;  |QBF cif1;
     cif2 = #203#2;   |QBF cif2;
     |SI cif1 ! cif2;
         sw      = 1;
         nombre1 = #1#1;
         nombre2 = #203#1;
         codigo  = #1#0;
         aplica  = directorio;
         |PRINT;
     |SINO;
         #1#22 = "S";
         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
|FPRC;

|PROCESO pasafich97;
     |DDEFECTO #1;
     #1#0 = #203#0;
     |LEE 101#1=;
     |SI FSalida = 0; |HAZ existe97; |SINO; |HAZ noexiste97; |FINSI;
|FPRC;

|DEFBUCLE agiren97;
     #203#1;
     ;
     #0#0;
     #0#1;
     e;
     NULL, pasafich97;
|FIN;

|PROCESO noexiste98;
     contador = contador + 1;
     #1#00 = #204#0;        || codigo empresa
     #1#01 = #204#1;        || razon social
     #1#02 = #204#1;        || nombre comercial
     #1#03 = #204#6;        || sg
     #1#04 = #204#7;        || direccion
     #1#05 = #204#8;        || numero
     #1#06 = #204#9;        || escalera
     #1#07 = #204#10;       || piso
     #1#08 = #204#11;       || puerta
     #1#16 = #204#16;       || codigo postal
     nume1 = #1#16;
     #1#09 = (nume1 - (nume1 $ 1000)) / 1000;      || codigo provincia
     #1#10 =  nume1 $ 1000;                        || codigo poblacion
     #1#11 = #204#14;       || poblacion
     |HAZ provincia;
     #1#12 = #4#1;        || provincia
     #1#13 = #204#2;        || cif
     #1#14 = #204#15;       || telefono
     #1#15 = "";          || fax
     #1#22 = "S";         || renta 'SI'
     |HAZ pon_demas;
     |GRABA 020#1n;

     |ATRI I;
     |SI FSalida = 0; |PINTA 1344, contador;  |FINSI;
     |ATRI 0;
|FPRC;

|PROCESO existe98;
     cif1 = #1#13;  |QBF cif1;
     cif2 = #204#2;   |QBF cif2;
     |SI cif1 ! cif2;
         sw      = 1;
         nombre1 = #1#1;
         nombre2 = #204#1;
         codigo  = #1#0;
         aplica  = directorio;
         |PRINT;
     |SINO;
         #1#22 = "S";
         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
|FPRC;

|PROCESO pasafich98;
     |DDEFECTO #1;
     #1#0 = #204#0;
     |LEE 101#1=;
     |SI FSalida = 0;
         |HAZ existe98;
     |SINO;
         |HAZ noexiste98;
     |FINSI;
|FPRC;

|DEFBUCLE agiren98;
     #204#1;
     ;
     #0#0;
     #0#1;
     ;
     NULL, pasafich98;
|FIN;

|PROCESO noexiste99;
     contador = contador + 1;
     #1#00 = #205#0;        || codigo empresa
     #1#01 = #205#5;        || razon social
     #1#02 = #205#5;        || nombre comercial
     #1#03 = #205#14;       || sg
     #1#04 = #205#15;       || direccion
     #1#05 = #205#16;       || numero
     #1#06 = #205#17;       || escalera
     #1#07 = #205#18;       || piso
     #1#08 = #205#19;       || puerta
     #1#16 = (("00" + #205#20) % -102) + (("000" + #205#21) % -103);   || codigo postal
     #1#09 = #205#20;                              || codigo provincia
     #1#10 = #205#21;                              || codigo poblacion
     #1#11 = #205#22;                              || poblacion
     |HAZ provincia;
     #1#12 = #4#1;                                 || provincia
     #1#13 = #205#1;                               || cif
     #1#14 = #205#12;                              || telefono
     #1#15 = "";          || fax
     #1#22 = "S";         || renta 'SI'
     |HAZ pon_demas;
     |GRABA 020#1n;

     |ATRI I;
     |SI FSalida = 0; |PINTA 1344, contador;  |FINSI;
     |ATRI 0;
|FPRC;

|PROCESO existe99;
     cif1 = #1#13;    |QBF cif1;
     cif2 = #205#1;   |QBF cif2;
     |SI cif1 ! cif2;
         sw      = 1;
         nombre1 = #1#1;
         nombre2 = #205#5;
         codigo  = #1#0;
         aplica  = directorio;
         |PRINT;
     |SINO;
         #1#22 = "S";
         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
|FPRC;

|PROCESO pasafich99;
     |DDEFECTO #1;
     #1#0 = #205#0;
     |LEE 101#1=;
     |SI FSalida = 0;
         |HAZ existe99;
     |SINO;
         |HAZ noexiste99;
     |FINSI;
|FPRC;

|DEFBUCLE agiren99;
     #205#1;
     ;
     #0#0;
     #0#1;
     ;
     NULL, pasafich99;
|FIN;

|PROCESO noexiste00;
     contador = contador + 1;
     #1#00 = #206#0;        || codigo empresa
     #1#01 = #206#5;        || razon social
     #1#02 = #206#5;        || nombre comercial
     #1#03 = #206#14;       || sg
     #1#04 = #206#15;       || direccion
     #1#05 = #206#16;       || numero
     #1#06 = #206#17;       || escalera
     #1#07 = #206#18;       || piso
     #1#08 = #206#19;       || puerta
     #1#16 = (("00" + #206#20) % -102) + (("000" + #206#21) % -103);   || codigo postal
     #1#09 = #206#20;                              || codigo provincia
     #1#10 = #206#21;                              || codigo poblacion
     #1#11 = #206#22;                              || poblacion
     |HAZ provincia;
     #1#12 = #4#1;                                 || provincia
     #1#13 = #206#1;                               || cif
     #1#14 = #206#12;                              || telefono
     #1#15 = "";          || fax
     #1#22 = "S";         || renta 'SI'
     |HAZ pon_demas;
     |GRABA 020#1n;

     |ATRI I;
     |SI FSalida = 0; |PINTA 1344, contador;  |FINSI;
     |ATRI 0;
|FPRC;

|PROCESO existe00;
     cif1 = #1#13;    |QBF cif1;
     cif2 = #206#1;   |QBF cif2;
     |SI cif1 ! cif2;
         sw      = 1;
         nombre1 = #1#1;
         nombre2 = #206#5;
         codigo  = #1#0;
         aplica  = directorio;
         |PRINT;
     |SINO;
         #1#22 = "S";
         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
|FPRC;

|PROCESO pasafich00;
     |DDEFECTO #1;
     #1#0 = #206#0;
     |LEE 101#1=;
     |SI FSalida = 0;
         |HAZ existe00;
     |SINO;
         |HAZ noexiste00;
     |FINSI;
|FPRC;

|DEFBUCLE agiren00;
     #206#1;
     ;
     #0#0;
     #0#1;
     ;
     NULL, pasafich00;
|FIN;

|PROCESO noexiste01;
     contador = contador + 1;
     #1#00 = #207#0;        || codigo empresa
     #1#01 = #207#5;        || razon social
     #1#02 = #207#5;        || nombre comercial
     #1#03 = #207#14;       || sg
     #1#04 = #207#15;       || direccion
     #1#05 = #207#16;       || numero
     #1#06 = #207#17;       || escalera
     #1#07 = #207#18;       || piso
     #1#08 = #207#19;       || puerta
     #1#16 = (("00" + #207#20) % -102) + (("000" + #207#21) % -103);   || codigo postal
     #1#09 = #207#20;                              || codigo provincia
     #1#10 = #207#21;                              || codigo poblacion
     #1#11 = #207#22;                              || poblacion
     |HAZ provincia;
     #1#12 = #4#1;                                 || provincia
     #1#13 = #207#1;                               || cif
     #1#14 = #207#12;                              || telefono
     #1#15 = "";          || fax
     #1#22 = "S";         || renta 'SI'
     |HAZ pon_demas;
     |GRABA 020#1n;

     |ATRI I;
     |SI FSalida = 0; |PINTA 1344, contador;  |FINSI;
     |ATRI 0;
|FPRC;

|PROCESO existe01;
     cif1 = #1#13;    |QBF cif1;
     cif2 = #207#1;   |QBF cif2;
     |SI cif1 ! cif2;
         sw      = 1;
         nombre1 = #1#1;
         nombre2 = #207#5;
         codigo  = #1#0;
         aplica  = directorio;
         |PRINT;
     |SINO;
         #1#22 = "S";
         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
|FPRC;

|PROCESO pasafich01;
     |DDEFECTO #1;
     #1#0 = #207#0;
     |LEE 101#1=;
     |SI FSalida = 0;
         |HAZ existe01;
     |SINO;
         |HAZ noexiste01;
     |FINSI;
|FPRC;

|DEFBUCLE agiren01;
     #207#1;
     ;
     #0#0;
     #0#1;
     ;
     NULL, pasafich01;
|FIN;

|PROCESO noexiste02;
     contador = contador + 1;
     #1#00 = #208#0;        || codigo empresa
     #1#01 = #208#5;        || razon social
     #1#02 = #208#5;        || nombre comercial
     #1#03 = #208#14;       || sg
     #1#04 = #208#15;       || direccion
     #1#05 = #208#16;       || numero
     #1#06 = #208#17;       || escalera
     #1#07 = #208#18;       || piso
     #1#08 = #208#19;       || puerta
     #1#16 = (("00" + #208#20) % -102) + (("000" + #208#21) % -103);   || codigo postal
     #1#09 = #208#20;                              || codigo provincia
     #1#10 = #208#21;                              || codigo poblacion
     #1#11 = #208#22;                              || poblacion
     |HAZ provincia;
     #1#12 = #4#1;                                 || provincia
     #1#13 = #208#1;                               || cif
     #1#14 = #208#12;                              || telefono
     #1#15 = "";          || fax
     #1#22 = "S";         || renta 'SI'
     |HAZ pon_demas;
     |GRABA 020#1n;

     |ATRI I;
     |SI FSalida = 0; |PINTA 1344, contador;  |FINSI;
     |ATRI 0;
|FPRC;

|PROCESO existe02;
     cif1 = #1#13;    |QBF cif1;
     cif2 = #208#1;   |QBF cif2;
     |SI cif1 ! cif2;
         sw      = 1;
         nombre1 = #1#1;
         nombre2 = #208#5;
         codigo  = #1#0;
         aplica  = directorio;
         |PRINT;
     |SINO;
         #1#22 = "S";
         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
|FPRC;

|PROCESO pasafich02;
     |DDEFECTO #1;
     #1#0 = #208#0;
     |LEE 101#1=;
     |SI FSalida = 0;
         |HAZ existe02;
     |SINO;
         |HAZ noexiste02;
     |FINSI;
|FPRC;

|DEFBUCLE agiren02;
     #208#1;
     ;
     #0#0;
     #0#1;
     ;
     NULL, pasafich02;
|FIN;

|PROCESO noexiste03;
     contador = contador + 1;
     #1#00 = #209#0;        || codigo empresa
     #1#01 = #209#5;        || razon social
     #1#02 = #209#5;        || nombre comercial
     #1#03 = #209#14;       || sg
     #1#04 = #209#15;       || direccion
     #1#05 = #209#16;       || numero
     #1#06 = #209#17;       || escalera
     #1#07 = #209#18;       || piso
     #1#08 = #209#19;       || puerta
     #1#16 = (("00" + #209#20) % -102) + (("000" + #209#21) % -103);   || codigo postal
     #1#09 = #209#20;                              || codigo provincia
     #1#10 = #209#21;                              || codigo poblacion
     #1#11 = #209#22;                              || poblacion
     |HAZ provincia;
     #1#12 = #4#1;                                 || provincia
     #1#13 = #209#1;                               || cif
     #1#14 = #209#12;                              || telefono
     #1#15 = "";          || fax
     #1#22 = "S";         || renta 'SI'
     |HAZ pon_demas;
     |GRABA 020#1n;

     |ATRI I;
     |SI FSalida = 0; |PINTA 1344, contador;  |FINSI;
     |ATRI 0;
|FPRC;

|PROCESO existe03;
     cif1 = #1#13;    |QBF cif1;
     cif2 = #209#1;   |QBF cif2;
     |SI cif1 ! cif2;
         sw      = 1;
         nombre1 = #1#1;
         nombre2 = #209#5;
         codigo  = #1#0;
         aplica  = directorio;
         |PRINT;
     |SINO;
         #1#22 = "S";
         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
|FPRC;

|PROCESO pasafich03;
     |DDEFECTO #1;
     #1#0 = #209#0;
     |LEE 101#1=;
     |SI FSalida = 0;
         |HAZ existe03;
     |SINO;
         |HAZ noexiste03;
     |FINSI;
|FPRC;

|DEFBUCLE agiren03;
     #209#1;
     ;
     #0#0;
     #0#1;
     ;
     NULL, pasafich03;
|FIN;

|PROCESO noexiste04;
     contador = contador + 1;
     #1#00 = #210#0;        || codigo empresa
     #1#01 = #210#5;        || razon social
     #1#02 = #210#5;        || nombre comercial
     #1#03 = #210#14;       || sg
     #1#04 = #210#15;       || direccion
     #1#05 = #210#16;       || numero
     #1#06 = #210#17;       || escalera
     #1#07 = #210#18;       || piso
     #1#08 = #210#19;       || puerta
     #1#16 = (("00" + #210#20) % -102) + (("000" + #210#21) % -103);   || codigo postal
     #1#09 = #210#20;                              || codigo provincia
     #1#10 = #210#21;                              || codigo poblacion
     #1#11 = #210#22;                              || poblacion
     |HAZ provincia;
     #1#12 = #4#1;                                 || provincia
     #1#13 = #210#1;                               || cif
     #1#14 = #210#12;                              || telefono
     #1#15 = "";          || fax
     #1#22 = "S";         || renta 'SI'
     |HAZ pon_demas;
     |GRABA 020#1n;

     |ATRI I;
     |SI FSalida = 0; |PINTA 1344, contador;  |FINSI;
     |ATRI 0;
|FPRC;

|PROCESO existe04;
     cif1 = #1#13;    |QBF cif1;
     cif2 = #210#1;   |QBF cif2;
     |SI cif1 ! cif2;
         sw      = 1;
         nombre1 = #1#1;
         nombre2 = #210#5;
         codigo  = #1#0;
         aplica  = directorio;
         |PRINT;
     |SINO;
         #1#22 = "S";
         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
|FPRC;

|PROCESO pasafich04;
     |DDEFECTO #1;
     #1#0 = #210#0;
     |LEE 101#1=;
     |SI FSalida = 0;
         |HAZ existe04;
     |SINO;
         |HAZ noexiste04;
     |FINSI;
|FPRC;

|DEFBUCLE agiren04;
     #210#1;
     ;
     #0#0;
     #0#1;
     ;
     NULL, pasafich04;
|FIN;

|PROCESO noexiste05;
     contador = contador + 1;
     #1#00 = #211#0;        || codigo empresa
     #1#01 = #211#5;        || razon social
     #1#02 = #211#5;        || nombre comercial
     #1#03 = #211#14;       || sg
     #1#04 = #211#15;       || direccion
     #1#05 = #211#16;       || numero
     #1#06 = #211#17;       || escalera
     #1#07 = #211#18;       || piso
     #1#08 = #211#19;       || puerta
     #1#16 = (("00" + #211#20) % -102) + (("000" + #211#21) % -103);   || codigo postal
     #1#09 = #211#20;                              || codigo provincia
     #1#10 = #211#21;                              || codigo poblacion
     #1#11 = #211#22;                              || poblacion
     |HAZ provincia;
     #1#12 = #4#1;                                 || provincia
     #1#13 = #211#1;                               || cif
     #1#14 = #211#12;                              || telefono
     #1#15 = "";          || fax
     #1#22 = "S";         || renta 'SI'
     |HAZ pon_demas;
     |GRABA 020#1n;

     |ATRI I;
     |SI FSalida = 0; |PINTA 1344, contador;  |FINSI;
     |ATRI 0;
|FPRC;

|PROCESO existe05;
     cif1 = #1#13;    |QBF cif1;
     cif2 = #211#1;   |QBF cif2;
     |SI cif1 ! cif2;
         sw      = 1;
         nombre1 = #1#1;
         nombre2 = #211#5;
         codigo  = #1#0;
         aplica  = directorio;
         |PRINT;
     |SINO;
         #1#22 = "S";
         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
|FPRC;

|PROCESO pasafich05;
     |DDEFECTO #1;
     #1#0 = #211#0;
     |LEE 101#1=;
     |SI FSalida = 0;
         |HAZ existe05;
     |SINO;
         |HAZ noexiste05;
     |FINSI;
|FPRC;

|DEFBUCLE agiren05;
     #211#1;
     ;
     #0#0;
     #0#1;
     ;
     NULL, pasafich05;
|FIN;

|PROCESO noexiste06;
     contador = contador + 1;
     #1#00 = #212#0;        || codigo empresa
     #1#01 = #212#5;        || razon social
     #1#02 = #212#5;        || nombre comercial
     #1#03 = #212#14;       || sg
     #1#04 = #212#15;       || direccion
     #1#05 = #212#16;       || numero
     #1#06 = #212#17;       || escalera
     #1#07 = #212#18;       || piso
     #1#08 = #212#19;       || puerta
     #1#16 = (("00" + #212#20) % -102) + (("000" + #212#21) % -103);   || codigo postal
     #1#09 = #212#20;                              || codigo provincia
     #1#10 = #212#21;                              || codigo poblacion
     #1#11 = #212#22;                              || poblacion
     |HAZ provincia;
     #1#12 = #4#1;                                 || provincia
     #1#13 = #212#1;                               || cif
     #1#14 = #212#12;                              || telefono
     #1#15 = "";          || fax
     #1#22 = "S";         || renta 'SI'
     |HAZ pon_demas;
     |GRABA 020#1n;

     |ATRI I;
     |SI FSalida = 0; |PINTA 1344, contador;  |FINSI;
     |ATRI 0;
|FPRC;

|PROCESO existe06;
     cif1 = #1#13;    |QBF cif1;
     cif2 = #212#1;   |QBF cif2;
     |SI cif1 ! cif2;
         sw      = 1;
         nombre1 = #1#1;
         nombre2 = #212#5;
         codigo  = #1#0;
         aplica  = directorio;
         |PRINT;
     |SINO;
         #1#22 = "S";
         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
|FPRC;

|PROCESO pasafich06;
     |DDEFECTO #1;
     #1#0 = #212#0;
     |LEE 101#1=;
     |SI FSalida = 0;
         |HAZ existe06;
     |SINO;
         |HAZ noexiste06;
     |FINSI;
|FPRC;

|DEFBUCLE agiren06;
     #212#1;
     ;
     #0#0;
     #0#1;
     ;
     NULL, pasafich06;
|FIN;

|PROCESO noexiste07;
     contador = contador + 1;
     #1#00 = #213#0;        || codigo empresa
     #1#01 = #213#5;        || razon social
     #1#02 = #213#5;        || nombre comercial
     #1#03 = #213#14;       || sg
     #1#04 = #213#15;       || direccion
     #1#05 = #213#16;       || numero
     #1#06 = #213#17;       || escalera
     #1#07 = #213#18;       || piso
     #1#08 = #213#19;       || puerta
     #1#16 = (("00" + #213#20) % -102) + (("000" + #213#21) % -103);   || codigo postal
     #1#09 = #213#20;                              || codigo provincia
     #1#10 = #213#21;                              || codigo poblacion
     #1#11 = #213#22;                              || poblacion
     |HAZ provincia;
     #1#12 = #4#1;                                 || provincia
     #1#13 = #213#1;                               || cif
     #1#14 = #213#12;                              || telefono
     #1#15 = "";          || fax
     #1#22 = "S";         || renta 'SI'
     |HAZ pon_demas;
     |GRABA 020#1n;

     |ATRI I;
     |SI FSalida = 0; |PINTA 1344, contador;  |FINSI;
     |ATRI 0;
|FPRC;

|PROCESO existe07;
     cif1 = #1#13;    |QBF cif1;
     cif2 = #213#1;   |QBF cif2;
     |SI cif1 ! cif2;
         sw      = 1;
         nombre1 = #1#1;
         nombre2 = #213#5;
         codigo  = #1#0;
         aplica  = directorio;
         |PRINT;
     |SINO;
         #1#22 = "S";
         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
|FPRC;

|PROCESO pasafich07;
     |DDEFECTO #1;
     #1#0 = #213#0;
     |LEE 101#1=;
     |SI FSalida = 0;
         |HAZ existe07;
     |SINO;
         |HAZ noexiste07;
     |FINSI;
|FPRC;

|DEFBUCLE agiren07;
     #213#1;
     ;
     #0#0;
     #0#1;
     ;
     NULL, pasafich07;
|FIN;

|PROCESO pase; |TIPO 3;
     |DBASS ficha;
     |PATH_DAT #99 ficha;
     |ABRE #99;
     |LEE 140#99p;
     |SI FSalida ! 0; |DDEFECTO #99; |FINSI;
     |CIERRA #99;

     ficha    = #99#6;   |QBF ficha;
     QueRenta = #99#10;  |QBF QueRenta;

     |SI QueRenta = "agiren94";  |PATH_DAT #2   ficha; |FINSI;
     |SI QueRenta = "agiren95";  |PATH_DAT #102 ficha; |FINSI;
     |SI QueRenta = "agiren96";  |PATH_DAT #202 ficha; |FINSI;
     |SI QueRenta = "agiren97";  |PATH_DAT #203 ficha; |FINSI;
     |SI QueRenta = "agiren98";  |PATH_DAT #204 ficha; |FINSI;
     |SI QueRenta = "agiren99";  |PATH_DAT #205 ficha; |FINSI;
     |SI QueRenta = "agiren00";  |PATH_DAT #206 ficha; |FINSI;
     |SI QueRenta = "agiren01";  |PATH_DAT #207 ficha; |FINSI;
     |SI QueRenta = "agiren02";  |PATH_DAT #208 ficha; |FINSI;
     |SI QueRenta = "agiren03";  |PATH_DAT #209 ficha; |FINSI;
     |SI QueRenta = "agiren04";  |PATH_DAT #210 ficha; |FINSI;
     |SI QueRenta = "agiren05";  |PATH_DAT #211 ficha; |FINSI;
     |SI QueRenta = "agiren06";  |PATH_DAT #212 ficha; |FINSI;
     |SI QueRenta = "agiren07";  |PATH_DAT #213 ficha; |FINSI;
     |SI QueRenta = "agiren08";  |PATH_DAT #213 ficha; |FINSI;

     contador = 0;
     sw = 0;
     |ABRE #1;
     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |INFOR informe;
     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     |SI QueRenta = "agiren94"; |BUCLE agiren94; |FINSI;
     |SI QueRenta = "agiren95"; |BUCLE agiren95; |FINSI;
     |SI QueRenta = "agiren96"; |BUCLE agiren96; |FINSI;
     |SI QueRenta = "agiren97"; |BUCLE agiren97; |FINSI;
     |SI QueRenta = "agiren98"; |BUCLE agiren98; |FINSI;
     |SI QueRenta = "agiren99"; |BUCLE agiren99; |FINSI;
     |SI QueRenta = "agiren00"; |BUCLE agiren00; |FINSI;
     |SI QueRenta = "agiren01"; |BUCLE agiren01; |FINSI;
     |SI QueRenta = "agiren02"; |BUCLE agiren02; |FINSI;
     |SI QueRenta = "agiren03"; |BUCLE agiren03; |FINSI;
     |SI QueRenta = "agiren04"; |BUCLE agiren04; |FINSI;
     |SI QueRenta = "agiren05"; |BUCLE agiren05; |FINSI;
     |SI QueRenta = "agiren06"; |BUCLE agiren06; |FINSI;
     |SI QueRenta = "agiren07"; |BUCLE agiren07; |FINSI;

     |SI sw = 1; |PIEINF; |FINSI;
     |FININF;
     |FINIMP;
     |CIERRA #1;
|FPRC;
