|FICHEROS;
    agiseg01 #0;
    agifigen #1;
    agiseg02 #2;         || agifisc
    agiseg03 #3;         || aginom1
    agiseg04 #4;         || agisoci
    agiseg05 #5;         || agicont
    agiseg06 #6;         || agirent
    agiseg07 #7,MANTE;   || informe impreso
    agiseg08 #8;         || Fichero Importes Modelos
    agiseg12 #12;        || agisoci
    agicontr #90;
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;

    opcion = 0;
    &codigo = 0;
    &Ejercicio = 0;
    &nombre = "";
    dbase = "";
    sw_corta = 0;

    &raginom = 0;
    &saginom = 0;
    &rrenta = 0;
    &prenta = 0;
    informe = "";

{-1}menu   = "";
    menu1  = "1423";
    menu2  = "1";
    menu3  = "7";
    menu4  = "<AGIFISC> Regimen Estimacion Objetiva.";
    menu5  = "<AGINOM1> Nominas y Seguros Sociales.";
    menu6  = "<AGISOCI> Impuesto de Sociedades.";
    menu7  = "<AGICONT> Contabilidad.";
    menu8  = "<AGIRENT> Renta y Patrimonio.";
    menu9  = "<.......> Importe por Modelo Presentado";
    menu10 = "<.......> Impresion Resultados.";
|FIN;
____________________________________/ PROCESO DE IMPRESION (opcion 6)
|PROCESO lee_todo;
|DDEFECTO #1;
|ABRE #1;
    #1#0 = #0#0;
|LEE 000#1=;             || lee agifigen
|CIERRA #1;

|DDEFECTO #2;
|ABRE #2;
    #2#0 = #0#0;  || Empresa
    #2#2 = #7#3;  || Perido
    #2#3 = #0#1;  || A¤o
|LEE 000#2=;             || lee agifisc
|CIERRA #2;

|DDEFECTO #3;
|ABRE #3;
    #3#0 = #0#0;
|LEE 000#3=;             || lee aginom1
|CIERRA #3;
    raginom = #3#17+#3#18+#3#19+#3#20+#3#21+#3#22+#3#23+#3#24+#3#25+#3#26+#3#27+#3#28;
    saginom = #3#41+#3#42+#3#43+#3#44+#3#45+#3#46+#3#47+#3#48+#3#49+#3#50+#3#51+#3#52+#3#53;

|DDEFECTO #4;
|ABRE #4;
    #4#0 = #0#0;
    #4#1 = 1900 + #0#1;
|LEE 000#4=;             || lee agisoci
|CIERRA #4;

|DDEFECTO #12;
|ABRE #12;
    #12#0 = #0#0;
    #12#1 = 1900 + #0#1;
|LEE 000#12=;             || lee agisoci
|CIERRA #12;

|DDEFECTO #5;
|ABRE #5;
    #5#0 = #0#0;
    #5#2 = #7#3;  || Perido
    #5#3 = #0#1;  || A¤o
|LEE 000#5=;             || lee agicont
|CIERRA #5;

|DDEFECTO #6;
|ABRE #6;
    #6#0  = #0#0;
    #6#60 = #0#1;
|LEE 000#6=;             || lee agirent
|CIERRA #6;
|SI #6#43 = "C";    rrenta = #6#41; |FINSI;   || total a pagar (conjunta)
|SI #6#43 ! "C";    rrenta = #6#42; |FINSI;   || total a pagar (individuales)
    prenta = #6#35+#6#36+#6#37+#6#38+#6#39+#6#40;      || patrimonio
|FPRC;

|PROCESO impresion;
  |ATRI R;  |BLIN 4;  |ATRI 0;
  |PUSHV 0501 2380;
  |PINPA #0#7;
  |PINDA #0#7;
  |ENDATOS #1#7;
  |SI FSalida ! 0;  |POPV;  |ACABA;  |FINSI;
  |POPV;
  |IMPRE 0;
  |SI FSalida ! 0;  |ACABA;  |FINSI;
  |HAZ lee_todo;
  |SI #7#0 = "R";  informe = "agisegre";    |FINSI;
  |SI #7#0 = "D";  informe = "agisegde";    |FINSI;
  |PARA para1 = 1; |SI para1 [ #7#2; |HACIENDO para1 = para1 + 1;
        |INFOR informe;
        |PRINT;
        |PIEINF;
        |FININF;
  |SIGUE;
  |FINIMP;
  |POPV;
|FPRC;
____________________________________/ PROCESO PRINCIPAL
|PROCESO controla;
    sw_corta = 1;
    dbase = "";
|DIRECTORIO dbase;
|PATH_DAT #90 dbase;
|ABRE #90;
|LEE 000#90p;
|SI FSalida = 0;
    |SI opcion = 1; nume1 = 3;     |FINSI;        || AGIFISC
    |SI opcion = 2; nume1 = 2;     |FINSI;        || AGINOM1
    |SI opcion = 3; nume1 = 4;     |FINSI;        || AGISOCI
    |SI opcion = 4; nume1 = 7;     |FINSI;        || AGICONT
    |SI opcion = 5; nume1 = 6;     |FINSI;        || AGIRENT
        alfa1 = #90nume1;   |QBF alfa1;
    |SI alfa1 = "*";
        |MENAV "    Aplicacion no instalada o no enlazada ...";
    |SINO;
            sw_corta = 0;
    |FINSI;
|SINO;
    |MENAV "    Control AGIFIGEN sin definir ...";
|FINSI;
|CIERRA #90;
|FPRC;

|RUTINA ClaveBaja8;
#8#0 = #0#0;
#8#1 = 00;
#8#2 = #0#1;
#8#3 = "  ";
#8#4 = "    ";
|FRUT;

|RUTINA ClaveAlta8;
#8#0 = #0#0;
#8#1 = 99;
#8#2 = #0#1;
#8#3 = "¤¤";
#8#4 = "¤¤¤¤";
|FRUT;

|PROCESO Importes;
|PUSHV 0501 2380;

|BLIN 04;
|ENTLINEAL #1#8, 5, 4, 22, 1, ClaveBaja8, ClaveAlta8;

|POPV;
|FPRC;

|PROGRAMA;
|CLS;
|CABEZA "Consulta -Tributaciones";
|DDEFECTO #0;
|PINPA #0#0;
|PINDA #0#0;
|ENDATOS #1#0;
|SI FSalida = 0;
        codigo    = #0#0;
        Ejercicio = #0#1;
        nombre    = #1#1;
    |PARA; |SI; |HACIENDO;
        |MENSA "    <Valide opcion>";
        |MENUG menu;
            opcion = FSalida;
        |SI opcion > 0;
                menu2 = opcion;
            |SI opcion [ 5;   |HAZ controla; |FINSI;
            |SI sw_corta = 0;
                |SI opcion = 1;   |SUB_EJECUTA "agiseg02"; |FINSI; || AGIFISC
                |SI opcion = 2;   |SUB_EJECUTA "agiseg03"; |FINSI; || AGINOM1
                |SI opcion = 3;                                    || AGISOCI
                    |SI #0#1 [ 95; |SUB_EJECUTA "agiseg04"; |FINSI;
                    |SI #0#1 ] 96; |SUB_EJECUTA "agiseg12"; |FINSI;
                |FINSI;
                |SI opcion = 4;   |SUB_EJECUTA "agiseg05"; |FINSI; || AGICONT
                |SI opcion = 5;
                   || |SUB_EJECUTA "agiseg06";
                |FINSI; || AGIRENT
                |SI opcion = 6;   |HAZ Importes;           |FINSI; || IMPORTE
                |SI opcion = 7;   |HAZ impresion;          |FINSI; || imprimir
            |FINSI;
        |SINO;
            |SAL;
        |FINSI;
    |SIGUE;
|FINSI;
|FPRO;
