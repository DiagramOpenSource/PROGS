|FICHEROS;
|FIN;

|VARIABLES;
     nBaffer     = 0;
     nOpcion     = 0;
     nTotalLinea = 0;
     nConta      = 0;
     nCogeOpcion = 0;
     nPos        = 0;
     nDesde      = 0;
     nHasta      = 0;

     aTabla      = "";
     aAlfa       = "";

     &eaDestino  = "";
     &eaTabla    = "";
     &eaAlfa     = "";
     &enError    = 0;
     &enComp     = 0;
     &enPosicion = 0;
|FIN;

|PROCESO CargaTabla;
     |DFICE aTabla;  |QBF aTabla;

     aTabla      = aTabla + eaTabla;
     nOpcion     = 1;
     nTotalLinea = 0;
     nConta      = -1;
     nBaffer     = 0;
     |LEESECUENCIAL aTabla, nBaffer, nTotalLinea, 0, 0;
|FPRC;

|PROCESO SacaTabla;
     |PUSHV 0501 2380;

     |SI nTotalLinea [ 400;
         |PARA; |SI;  |HACIENDO;
              nOpcion = 1;
              |BMENUG nBaffer, 0, 1, nTotalLinea, enPosicion, nOpcion;
              nOpcion     = FSalida;
              nCogeOpcion = nOpcion - 1;
              |SI FSalida [ nTotalLinea; |Y FSalida ] 1;
                  |DEL_BUF nBaffer, nCogeOpcion, eaDestino;

                  |SAL;
             |FINSI;
         |SIGUE;
     |SINO;
         nDesde  = 0;
         nHasta  = 400;
         nOpcion = 1;
         |PARA; |SI;  |HACIENDO;
              |BMENUG nBaffer, nDesde, 1, nHasta, enPosicion, nOpcion;
              nOpcion     = FSalida;

              nCogeOpcion = (nOpcion - 1) + nDesde;
              |SI FSalida [ nTotalLinea; |Y FSalida ] 1;
                  |DEL_BUF nBaffer, nCogeOpcion, eaDestino;

                  aAlfa = eaDestino;  |QBT aAlfa;
                  |SI aAlfa = "Mas...";
                      nDesde  = nDesde + 400;
                      nHasta  = nHasta + 400;
                      nOpcion = 1;
                  |FINSI;

                  |SI aAlfa = "Menos...";
                      nDesde  = nDesde - 400;
                      nHasta  = nHasta - 400;
                      nOpcion = 1;
                  |FINSI;

                  |SI aAlfa ! "Mas...";  |Y  aAlfa ! "Menos...";
                      |SAL;
                  |FINSI;
              |FINSI;
         |SIGUE;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO CompruebaTabla;
     enError = 1;
     nPos    = 100 + enComp;

     |LEESECUENCIAL aTabla, nBaffer, nTotalLinea, 0, 0;
     |PARA nConta = 0;  |SI nConta [ nTotalLinea;  |HACIENDO nConta = nConta + 1;
         |DEL_BUF nBaffer, nConta, eaDestino;
         aAlfa = eaDestino % nPos;

         |QBF aAlfa;
         |QBF eaAlfa;

         |SI aAlfa = eaAlfa;  enError = 0;  |SAL;  |FINSI;
     |SIGUE;

     |FINDIM nBaffer;
|FPRC;

|PROCESO FinTabla;
     |FINDIM nBaffer;
|FPRC;
