|FICHEROS;
     agiy0024 #0;             || Este def
     agifigen #1;             || Clientes
     agim0004 #2;             || Representantes Empresas
     agihacie #3;             || Hacienda
     agim0003 #4;             || Representantes
|FIN;

|VARIABLES;
     XPara = 0;
|FIN;

|PROCESO Representante; |TIPO 0;
  |ABRE #2;
  #2#0 = #0#0;           || Codigo Empresa
  #2#1 = 1;
  |LEE 040#2];
  |SI FSalida = 0; |Y #2#0 = #0#0;
      #0#3 = #2#2;       || Nif del Representante
      #0#4 = #2#3;       || Nombre del Representante;
  |SINO;
      #0#3 = "";         || Nif del Representante
      #0#4 = "";         || Nombre del Representante;
  |FINSI;

  |PINTA #0#3;
  |PINTA #0#4;

  |CIERRA #2;
|FPRC;

|PROCESO Cuadro;  |TIPO 7;
  |PUSHV 0501 2380;
  |D_CUADRO 1508, 2375;

  |ATRI R;
  |PINTA 1609, " 1.- No declarar por ning£n concepto.                             ";
  |PINTA 1709, " 2.- No haber presentado declaraci¢n del I.R.P.F.                 ";
  |PINTA 1809, " 3.- Copia certificada de la declaraci¢n del I.R.P.F.             ";
  |PINTA 1909, " 4.- Estar dado de alta en el I.A.E.                              ";
  |PINTA 2009, " 5.- Presentaci¢n de declaraciones u otros documentos tributarios.";
  |PINTA 2109, " 6.- Base Imponible declarada en I.R.P.F.                         ";
  |PINTA 2209, " 7.- Otros.                                                       ";
  |ATRI 0;
|FPRC;

|PROCESO Seleccion;
  |POPV;

  |PDEFECTO #0, 8, 19;
  |PINDA #0#0;

  |PARA XPara = 8; |SI XPara [ 18;  |HACIENDO XPara = XPara + 1;
        |C_M #0XPara, 1, "N";
  |SIGUE;

  |SI #0#7 = 2; |O #0#7 = 3; |O #0#7 = 6;
      |C_M #0#8, 1, "S";
  |FINSI;

  |SI #0#7 = 4;
      |C_M #0#11, 1, "S";
      |C_M #0#12, 1, "S";
      |C_M #0#13, 1, "S";
      |C_M #0#14, 1, "S";
      |C_M #0#15, 1, "S";
      |C_M #0#16, 1, "S";
  |FINSI;

  |SI #0#7 = 5;
      |C_M #0#9,  1, "S";
      |C_M #0#10, 1, "S";
  |FINSI;

  |SI #0#7 = 7;
      |C_M #0#17, 1, "S";
      |C_M #0#18, 1, "S";
  |FINSI;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;
  |ET Arriba;
      |IMPRE 0;
      |SI FSalida ! 0;  |ACABA;  |FINSI;

      |PUSHV 0501 2380;
      |D_CUADRO 1119, 1464;
      |ATRI R;
      |PINTA 1220, "INTRODUZCA MODELO OFICIAL 01 EN LA IMPRESORA";
      |PINTA 1320, "             (PULSE TECLA)                  ";
      |ATRI 0;
      |PAUSA;
      |POPV;

      |INFOR "agih9601";
      |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

      |ABRE #1;
      #1#0 = #0#0;
      |LEE 040#1=;
      |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
      |CIERRA #1;

      |ABRE #4;
      #4#0 = #0#3;
      |LEE 040#4=;
      |SI FSalida ! 0;  |DDEFECTO #4;  |FINSI;
      |CIERRA #4;

      |ABRE #3;
      #3#0 = #1#63;
      #3#1 = #1#64;
      |LEE 040#3=;
      |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;
      |CIERRA #3;

      |PRINT;
      |PIEINF;
      |FININF;
      |FINIMP;

      |CONFI "2400NDesea imprimirlo de nuevo : ";
      |SI FSalida = 0;  |VETE Arriba;  |FINSI;
|FPRC;
