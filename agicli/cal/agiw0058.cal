|FICHEROS;
     agiw0058 #0;
|FIN;

|VARIABLES;
     nCampo     = 0;
     aAlfa1     = "";
     aAlfa2     = "";


     &eaVarDni  = "";
     &enCalcCif = 0;

     &eaTabla    = "";
     &eaDestino  = "";
     &eaAlfa     = "";
     &enError    = 0;
     &enComp     = 0;
     &enPosicion = 0;
|FIN;

|PROCESO Tipo12w58;  |TIPO 12;
     || Para que no pregunte el correcto si o no
|FPRC;

|PROCESO LetraDniw0058;  |TIPO 6;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     eaVarDni  = #0Campo;
     enCalcCif = 1;
     |HAZ CalculoDNI;
     #0Campo = eaVarDni;
     |PINTA #0Campo;
|FPRC;

|PROCESO SacaGrupow58;  |TIPO 7;
     eaTabla = "txtm0009.txt";
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompruebaGrupow58;  |TIPO 0;
     |SI FSalida = 10;
         enPosicion = 55;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 101;
         #0Campo  = aAlfa1;
         |PINTA #0Campo;
     |FINSI;

     enComp = 1;
     eaAlfa = #0Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 101;
     #0Campo  = aAlfa1;

     |PINTA #0Campo;

     |HAZ FinTabla;
|FPRC;

|PROCESO SacaEpiw58;  |TIPO 7;
     nCampo = Campo - 1;
     |SI #0nCampo = " ";  |ACABA;                    |FINSI;
     |SI #0nCampo = "1";  eaTabla = "txtm0011.txt";  |FINSI;
     |SI #0nCampo = "2";  eaTabla = "txtm0012.txt";  |FINSI;
     |SI #0nCampo = "3";  eaTabla = "txtm0013.txt";  |FINSI;

     |HAZ CargaTabla;
|FPRC;

|PROCESO CompruebaEpiw58;  |TIPO 0;
     nCampo = Campo - 1;

     |SI #0nCampo  = " ";
         #0Campo   = "";
         |PINTA #0Campo;
         |ACABA;
     |FINSI;

     |SI FSalida = 10;
         enPosicion = 20;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 104;
         #0Campo  = aAlfa1;
         |PINTA #0Campo;
     |FINSI;

     enComp = 4;
     eaAlfa = #0Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 104;
     #0Campo  = aAlfa1;

     |PINTA #0Campo;

     |HAZ FinTabla;
|FPRC;

|PROCESO SacaTipow58;  |TIPO 7;
     eaTabla = "txtm0010.txt";
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompruebaTipow58;  |TIPO 0;
     |SI FSalida = 10;
         enPosicion = 55;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 103;
         #0Campo  = aAlfa1;
         |PINTA #0Campo;
     |FINSI;

     enComp = 3;
     eaAlfa = #0Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 103;
     #0Campo  = aAlfa1;

     |PINTA #0Campo;

     |HAZ FinTabla;
|FPRC;

|PROCESO Modifica601;
     |C_M #0#2, 1, "S";
     |C_M #0#3, 1, "S";
     |SI #0#1 ! "S";
         |C_M #0#2, 1, "N";  #0#2 = "";  |PINTA #0#2;
         |C_M #0#3, 1, "N";  #0#3 = "";  |PINTA #0#3;
     |FINSI;
|FPRC;

|PROCESO Modifica605;  |TIPO 7;
     |C_M #0#13, 1, "S";
     |C_M #0#14, 1, "S";
     |C_M #0#15, 1, "S";
     |C_M #0#16, 1, "S";
     |C_M #0#17, 1, "S";
     |C_M #0#18, 1, "S";
     |C_M #0#19, 1, "S";
     |C_M #0#20, 1, "S";
     |C_M #0#21, 1, "S";
     |C_M #0#22, 1, "S";
     |C_M #0#23, 1, "S";
     |C_M #0#24, 1, "S";

     |SI #0#5 ! "S";  |Y #0#7 ! "S";
         |C_M #0#13, 1, "N";  #0#13 = "";  |PINTA #0#13;
         |C_M #0#14, 1, "N";  #0#14 = "";  |PINTA #0#14;
         |C_M #0#15, 1, "N";  #0#15 = "";  |PINTA #0#15;
         |C_M #0#16, 1, "N";  #0#16 = "";  |PINTA #0#16;
         |C_M #0#17, 1, "N";  #0#17 = "";  |PINTA #0#17;
         |C_M #0#18, 1, "N";  #0#18 = "";  |PINTA #0#18;
         |C_M #0#19, 1, "N";  #0#19 = "";  |PINTA #0#19;
         |C_M #0#20, 1, "N";  #0#20 = "";  |PINTA #0#20;
         |C_M #0#21, 1, "N";  #0#21 = "";  |PINTA #0#21;
         |C_M #0#22, 1, "N";  #0#22 = "";  |PINTA #0#22;
         |C_M #0#23, 1, "N";  #0#23 = "";  |PINTA #0#23;
         |C_M #0#24, 1, "N";  #0#24 = "";  |PINTA #0#24;
     |FINSI;
|FPRC;

|PROCESO Modifica610;  |TIPO 7;
     |C_M #0#25, 1, "S";
     |C_M #0#26, 1, "S";
     |C_M #0#27, 1, "S";
     |C_M #0#28, 1, "S";
     |C_M #0#29, 1, "S";
     |C_M #0#30, 1, "S";
     |C_M #0#31, 1, "S";
     |C_M #0#32, 1, "S";
     |C_M #0#33, 1, "S";
     |C_M #0#34, 1, "S";
     |C_M #0#35, 1, "S";
     |C_M #0#36, 1, "S";

     |SI #0#10 ! "S";
         |C_M #0#25, 1, "N";  #0#25 = "";  |PINTA #0#25;
         |C_M #0#26, 1, "N";  #0#26 = "";  |PINTA #0#26;
         |C_M #0#27, 1, "N";  #0#27 = "";  |PINTA #0#27;
         |C_M #0#28, 1, "N";  #0#28 = "";  |PINTA #0#28;
         |C_M #0#29, 1, "N";  #0#29 = "";  |PINTA #0#29;
         |C_M #0#30, 1, "N";  #0#30 = "";  |PINTA #0#30;
         |C_M #0#31, 1, "N";  #0#31 = "";  |PINTA #0#31;
         |C_M #0#32, 1, "N";  #0#32 = "";  |PINTA #0#32;
         |C_M #0#33, 1, "N";  #0#33 = "";  |PINTA #0#33;
         |C_M #0#34, 1, "N";  #0#34 = "";  |PINTA #0#34;
         |C_M #0#35, 1, "N";  #0#35 = "";  |PINTA #0#35;
         |C_M #0#36, 1, "N";  #0#36 = "";  |PINTA #0#36;
     |FINSI;
|FPRC;

|PROCESO Modifica620;
     |C_M #0#38, 1, "S";
     |SI #0#37 ! "S";
         |C_M #0#38, 1, "N";  #0#38 = "01.01.0000";  |PINTA #0#38;
     |FINSI;
|FPRC;

|PROCESO Modifica622;
     |C_M #0#41, 1, "S";
     |C_M #0#42, 1, "S";
     |C_M #0#43, 1, "S";
     |SI #0#40 ! "S";
         |C_M #0#41, 1, "N";  #0#41 = "";  |PINTA #0#41;
         |C_M #0#42, 1, "N";  #0#42 = "";  |PINTA #0#42;
         |C_M #0#43, 1, "N";  #0#43 = "";  |PINTA #0#43;
     |FINSI;
|FPRC;

|PROCESO Modifica634;
     |C_M #0#51, 1, "S";
     |SI #0#50 ! "S";
         |C_M #0#51, 1, "N";  #0#51 = "01.01.0000";  |PINTA #0#51;
     |FINSI;
|FPRC;
