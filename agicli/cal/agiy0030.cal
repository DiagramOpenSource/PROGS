|FICHEROS;
     agiy0030 #0;  || Este
     agim0028 #1;  || Ficha de Sociedades Cabeceras
     agim0019 #2;  || Ficha de Sociedades Lineas
     agim0020 #3;  || Caracteres de la Declaracion
     agim0021 #4;  || Socios Transparencia Fiscal
     agim0022 #5;  || Internacional C Transparencia Fiscal
     agim0023 #6;  || Internacional L Transparencia Fiscal
     agim0024 #7;  || Representantes/Administradores
     agim0025 #8;  || Socios
     agim0026 #9;  || Cargos
     agim0027 #10; || Participaciones otras empresas
     agim0037 #37; || Participaciones otras empresas
|FIN;

|VARIABLES;
     TipoLin       = 0;
     NombreFichero = "";
     FicheroFabre  = "";
     Fich          = "";
     LineasAnte    = 0;
     TotalLinea    = -1;
     Variable      = "";
     VarGraba      = "";
     Baffer        = 0;
     NombreLis     = "";
     LineasPost    = 0;
     CuadroIni     = 0;
     CuadroFin     = 0;
     GruesoLis     = 0;
     LineaInicial  = 0;
     ColumInicial  = 0;
     ModoEdita     = 0;
     Handle        = "";
     Espacio       = "                                                                              ";
     Negrita       = 0;
     TipoImpre     = 0;
     SwPrint       = 0;
     XPara         = 0;
     Empresa       = 0;
     Registro      = 0;
     SwCab         = 0;
     Varalf1       = "";
     Varalf2       = "";
     Varalf3       = "";
     Varalf4       = "";
     Varalf5       = "";
     Varalf6       = "";
     Varalf7       = "";
     Varalf8       = "";
     Varalf9       = "";
     Valfa         = "";

     Cantidad      = "";
     Len           = "";
     Cantid1       = "";
     Cantid2       = "";
     Cantid3       = "";
     Cantid4       = "";
     CantiNum      = 0;
     Leng          = 0;

     XCarac        = 0;
     Posi          = 0;
     Caracter      = "";
     VarAlfa1      = "";
     VarAlfa2      = "";

     SwTranspa     = 0;

     aCaracter     = "";
     nCaracter     = 0;
     nRecojo       = 0;
     aParteEntero  = "";
     aParteDecima  = "";
     nPos          = 0;

 {-1}Menu          = "";
     Menu1         = "2400";
     Menu2         = "1";
     Menu3         = "Elija Impresion : ";
     Menu4         = "PI";
     Menu5         = "  Pantalla  ";
     Menu6         = "  Impresora  ";

     &VarImpre1    = "";
     &VarImpre2    = "";
     &EURODB       = 0;
|FIN;

|INCLUYE i_consul;

|| Formatea las cantidades con decimales 3 Enteros y 2 Decimales

|PROCESO CambiDeci3_2;
  CantiNum  = Cantidad;
  Len       = Cantidad % 0;
  Leng      = Len;
  |PARA XCarac = 1; |SI XCarac [ Leng; |HACIENDO XCarac = XCarac + 1;
        Posi     = (XCarac * 100) + 1;
        Caracter = Cantidad % Posi;
        |SI Caracter = ".";  |SAL;  |FINSI;
  |SIGUE;

  |SI Caracter ! ".";
      Cantidad = (("   " + CantiNum) % -103) + ".00";
  |SINO;
      Posi      = (XCarac - 1) + 100;
      VarAlfa1  = ("   " + (Cantidad % Posi)) % -103;

      Posi     = ((XCarac + 1) * 100) + 8;
      VarAlfa2 = (((Cantidad % Posi) + "00")) % 102;
      Cantidad = VarAlfa1 + "." + VarAlfa2;
  |FINSI;
|FPRC;

|PROCESO Cantidad;    || Calculo para poner las comas en Var Cantidad
  CantiNum = Cantidad;
  |SI EURODB ! 0;
      Len          = Cantidad % 0;
      Leng         = Len;
      nRecojo      = 0;
      aParteEntero = "";
      aParteDecima = "";
      |PARA nCaracter = 1;  |SI nCaracter [ Leng;  |HACIENDO nCaracter = nCaracter + 1;
            nPos = (100 * nCaracter) + 1;
            aCaracter = Cantidad % nPos;
            |SI aCaracter ! ".";
                |SI nRecojo = 0;  aParteEntero = aParteEntero + aCaracter;  |FINSI;
                |SI nRecojo = 1;  aParteDecima = aParteDecima + aCaracter;  |FINSI;
            |SINO;
                nRecojo = 1;
            |FINSI;
      |SIGUE;
      |SI aParteEntero = "";  aParteEntero = "0";  |FINSI;
      |SI aParteDecima = "";  aParteDecima = "";   |FINSI;

      Cantidad = aParteEntero;
  |SINO;
      CantiNum = CantiNum ! EURODB;
      Cantidad = CantiNum;
  |FINSI;


  Len      = Cantidad % 0;
  Leng     = Len;
  Cantidad = "             " + Cantidad;
  Cantidad = Cantidad % -113;
        Cantid1 = Cantidad % -103;
        Cantid2 = Cantidad % -403;
        Cantid3 = Cantidad % -703;
        Cantid4 = Cantidad % -1004;
  |SI Leng ] 10;
      |SI Cantid4 ! "  -";
          Cantidad = Cantid4 + "." + Cantid3  + "." + Cantid2 + "." + Cantid1;
      |SINO;
          Cantidad = Cantid4 + Cantid3  + "." + Cantid2 + "." + Cantid1;
      |FINSI;
  |SINO;
      |SI Leng ] 7;
         |SI Cantid3 ! "  -";
             Cantidad = Cantid3  + "." + Cantid2 + "." + Cantid1;
         |SINO;
             Cantidad = Cantid3 + Cantid2 + "." + Cantid1;
         |FINSI;
      |SINO;
         |SI Leng ] 4;
             |SI Cantid2 ! "  -";
                 Cantidad = Cantid2 + "." + Cantid1;
             |SINO;
                 Cantidad = Cantid2 + Cantid1;
             |FINSI;
         |SINO;
             Cantidad = Cantid1;
         |FINSI;
      |FINSI;
  |FINSI;

  |SI aParteDecima ! "";
      Cantidad = ("             " + (Cantidad + "," + aParteDecima)) % -113;
  |SINO;
      Cantidad = ("             " + Cantidad) % -113;
  |FINSI;
|FPRC;

|PROCESO GrabaTemporal;
  |SI TipoImpre = 2; |Y Negrita = 1;
      Variable = ("{{N}}" + ((Variable + Espacio) % 178)) + "{{n}}";
      VarGraba = Handle + " " + Variable;
  |SINO;
      Variable = (Variable + Espacio) % 178;
      VarGraba = Handle + " " + Variable;
  |FINSI;
  |FGRABA VarGraba;
|FPRC;

|PROCESO Cabecera;
  #1#0 = #2#0;
  |LEE 040#1=;
  |SI FSalida ! 0; |DDEFECTO  #1; |FINSI;

  |SI TipoImpre = 1;
      Negrita  = 1;
      Variable = "";                                         |HAZ GrabaTemporal;
      Variable = "                             < FICHA DE SOCIEDADES >";

                                                           |HAZ GrabaTemporal;
      Variable = "";                                       |HAZ GrabaTemporal;
      Variable = "";                                       |HAZ GrabaTemporal;
      Variable = "EMPRESA ........: " + #1#0 + " " + #1#2; |HAZ GrabaTemporal;
      Variable = "R.SOCIAL .......: " + #1#1;              |HAZ GrabaTemporal;
      Variable = "C.I.F. .........: " + #1#3;              |HAZ GrabaTemporal;
      Variable = "Anagrama .......: " + #1#4;              |HAZ GrabaTemporal;
      Variable = "Telefono .......: " + #1#5;              |HAZ GrabaTemporal;
      Variable = "";                                       |HAZ GrabaTemporal;
      Variable = "Registro .......: " + #2#1 + " " + #2#2; |HAZ GrabaTemporal;
      Variable = "Tipo Empresa ...: " + #2#4 + " " + #2#5; |HAZ GrabaTemporal;
      Variable = "Fecha Registro .: " + #2#3;              |HAZ GrabaTemporal;
      Variable = "Activa/Inactiva : " + #2#6  + " Fecha : " + #2#7;
                                                           |HAZ GrabaTemporal;
      Variable = "C.N.A.E. .......: " + #2#40 + " " + #2#41;
                                                           |HAZ GrabaTemporal;
  |SINO;
      Variable = Empresa;
      Variable = (("00000" + Empresa) % -105) + (("00" + #2#1) % -102);
      Variable = "\\\Empresa"+ Variable;                   |HAZ GrabaTemporal;
  |FINSI;
|FPRC;

|PROCESO Declaracion;
  |SI SwCab = 0;
      SwCab    = 1;
      Negrita  = 1;
      Variable = "CARACTERES DE LA DECLARACION";           |HAZ GrabaTemporal;
      Variable = "----------------------------";           |HAZ GrabaTemporal;
  |FINSI;

  Negrita  = 0;
  Variable = #3#2;
  |SI #3#3 ! 0; Variable = Variable + "  Grupo : " + #3#3;  |FINSI;
                                                           |HAZ GrabaTemporal;

  |SI #3#1 = 12;  |O #3#1 = 13;  |O #3#1 = 15;
      SwTranspa = 1;
  |FINSI;
|FPRC;

|DEFBUCLE agim0020;
  #3#1;
  ;
  #2#0, 000;
  #2#0, 999;
  ;
  NULL, Declaracion;
|FIN;

|PROCESO SocTranspa;
  |SI SwCab = 0;
      SwCab    = 1;
      Negrita  = 1;
      Variable = "RELACION DE SOCIOS TRANSPARENCIA FISCAL"; |HAZ GrabaTemporal;
      Variable = "---------------------------------------"; |HAZ GrabaTemporal;

      Negrita  = 0;
      Variable = "NIF          F/J R/X Apellidos y Nombre                CP  B.I.Imputada % Part";
                                                           |HAZ GrabaTemporal;
      Variable = "------------------------------------------------------------------------------";
                                                           |HAZ GrabaTemporal;
  |FINSI;

  Negrita  = 0;
  Varalf1  = #4#3;
  Varalf2  = #4#4;
  Varalf3  = #4#5;
  Varalf4  = #4#6 % 133;
  Varalf5  = #4#7;
  Cantidad = #4#8;  |HAZ Cantidad;
  Varalf6  = Cantidad;
  Cantidad = #4#9;  |HAZ CambiDeci3_2;
  Varalf7  = Cantidad;
  Varalf8  = "";
  Varalf9  = "";

  Variable = Varalf1  + "  " + Varalf2 + "   " + Varalf3 + "  " + Varalf4;
  Variable = Variable + " " + Varalf5 + " " + Varalf6 + " " + Varalf7;
  Variable = Variable + " " + Varalf8 + " " + Varalf9;
                                                           |HAZ GrabaTemporal;
|FPRC;

|DEFBUCLE agim0021;
  #4#1;
  ;
  #2#0, #2#1, 00;
  #2#0, #2#1, 99;
  ;
  NULL, SocTranspa;
|FIN;

|PROCESO IntTranspaL;
  Negrita  = 0;
  Varalf1  = #6#4;
  Varalf2  = #6#5;
  Varalf3  = #6#6;
  Cantidad = #6#7;  |HAZ Cantidad;
  Varalf4  = Cantidad;
  Varalf5  = "";
  Varalf6  = "";
  Varalf7  = "";
  Varalf8  = "";
  Varalf9  = "";

  Variable = Varalf1  + " " + Varalf2 + " " + Varalf3 + " " + Varalf4;
  Variable = Variable + " " + Varalf5 + " " + Varalf6 + " " + Varalf7;
  Variable = Variable + " " + Varalf8 + " " + Varalf9;
                                                           |HAZ GrabaTemporal;
|FPRC;

|DEFBUCLE agim0023;
  #6#1;
  ;
  #5#0, #5#1, #5#2, 00;
  #5#0, #5#1, #5#2, 99;
  ;
  NULL, IntTranspaL;
|FIN;

|PROCESO IntTranspaC;
  |SI SwCab = 0;
      SwCab    = 1;
      Negrita  = 1;
      Variable = "TRANSPARENCIA FISCAL INTERNACIONAL";      |HAZ GrabaTemporal;
      Variable = "----------------------------------";      |HAZ GrabaTemporal;

      Negrita  = 0;
      Variable = "Nombre/Administrador   Domicilio Fiscal         C.P Importe Renta";
                                                           |HAZ GrabaTemporal;
      Variable = "-----------------------------------------------------------------";
                                                           |HAZ GrabaTemporal;
  |FINSI;

  Negrita  = 1;
  Varalf1  = #5#3;
  Varalf2  = #5#4;
  Varalf3  = #5#5;
  Cantidad = #5#6;  |HAZ Cantidad;
  Varalf4  = Cantidad;
  Varalf5  = "";
  Varalf6  = "";
  Varalf7  = "";
  Varalf8  = "";
  Varalf9  = "";

  Variable = Varalf1  + " " + Varalf2 + " " + Varalf3 + " " + Varalf4;
  Variable = Variable + " " + Varalf5 + " " + Varalf6 + " " + Varalf7;
  Variable = Variable + " " + Varalf8 + " " + Varalf9;
                                                           |HAZ GrabaTemporal;

  |BUCLE agim0023;
  Variable = "";                                             |HAZ GrabaTemporal;
|FPRC;

|DEFBUCLE agim0022;
  #5#1;
  ;
  #2#0, #2#1, 00;
  #2#0, #2#1, 99;
  ;
  NULL, IntTranspaC;
|FIN;

|PROCESO agim0037A;
     Varalf1  = "     " + #37#5;
     Varalf2  = " " * 19;
     Varalf3  = #37#6;
     Varalf4  = #37#7;
     Variable = Varalf1  + " " + Varalf2 + Varalf3 + "  " + Varalf4;
                                                           |HAZ GrabaTemporal;
|FPRC;

|DEFBUCLE agim0037A;
     #37#1;
     ;
     "agim0019", #2#0, #2#1, TipoLin,  1;
     "agim0019", #2#0, #2#1, TipoLin, 99;
     ;
     NULL, agim0037A;
|FIN;

|PROCESO Notaria;
  Negrita  = 1;
  Variable = "DATOS NOTARIA";                          |HAZ GrabaTemporal;
  Variable = "-------------";                          |HAZ GrabaTemporal;
  Negrita  = 0;
  Variable = "Notaria ............: " + #2#8;          |HAZ GrabaTemporal;
  Variable = "Colegio Notario ....: " + #2#9;          |HAZ GrabaTemporal;
  Variable = "Numero de Protocolo : " + #2#10;         |HAZ GrabaTemporal;
  Variable = "Fecha Constitucion .: " + #2#11;
  |SI #2#12 ! "01.01.0000";
      Variable = Variable + "    Fecha Disolucion : " + #2#12;
  |FINSI;
                                                       |HAZ GrabaTemporal;
  Variable = "Objeto Social ......: " + #2#13;         |HAZ GrabaTemporal;
  Variable = "                      " + #2#42;         |HAZ GrabaTemporal;
  Variable = "                      " + #2#43;         |HAZ GrabaTemporal;
  Variable = "                      " + #2#44;         |HAZ GrabaTemporal;
  Variable = "                      " + #2#45;         |HAZ GrabaTemporal;
  Variable = "";                                       |HAZ GrabaTemporal;

  Cantidad = #2#14;    |HAZ Cantidad;
  Variable = "Capital Social .....: " + Cantidad;      |HAZ GrabaTemporal;

  |SI #2#15 ! 0;  |O #2#19 ! 0;  |O #2#23 ! 0;
      Variable = "";                                       |HAZ GrabaTemporal;
      Variable = "Concepto                  Numero Accion       Importe  Del N.    Al N.";
                                                           |HAZ GrabaTemporal;
      Variable = "-------------------------------------------------------------------------";
                                                           |HAZ GrabaTemporal;
      |SI #2#15 ! 0;
           Varalf1  = "Acciones Nominativas     ";
           Cantidad = #2#15;  |HAZ Cantidad;
           Varalf2  = Cantidad;
           Cantidad = #2#16;  |HAZ Cantidad;
           Varalf3  = Cantidad;
           Varalf4  = "";
           Varalf5  = "";
           Varalf6  = "";
           Varalf7  = "";
           Varalf8  = "";
           Varalf9  = "";

           Variable = Varalf1  + " " + Varalf2 + " " + Varalf3 + " " + Varalf4;
           Variable = Variable + " " + Varalf5 + " " + Varalf6 + " " + Varalf7;
           Variable = Variable + " " + Varalf8 + " " + Varalf9;
                                                           |HAZ GrabaTemporal;

           TipoLin = 1;                                    |BUCLE agim0037A;
           Variable = "";                                  |HAZ GrabaTemporal;
      |FINSI;

      |SI #2#19 ! 0;
           Varalf1  = "Acciones al Portador     ";
           Cantidad = #2#19;  |HAZ Cantidad;
           Varalf2  = Cantidad;
           Cantidad = #2#20;  |HAZ Cantidad;
           Varalf3  = Cantidad;
           Varalf4  = "";
           Varalf5  = "";
           Varalf6  = "";
           Varalf7  = "";
           Varalf8  = "";
           Varalf9  = "";

           Variable = Varalf1  + " " + Varalf2 + " " + Varalf3 + " " + Varalf4;
           Variable = Variable + " " + Varalf5 + " " + Varalf6 + " " + Varalf7;
           Variable = Variable + " " + Varalf8 + " " + Varalf9;
                                                           |HAZ GrabaTemporal;
           TipoLin = 2;                                    |BUCLE agim0037A;
           Variable = "";                                  |HAZ GrabaTemporal;
      |FINSI;

      |SI #2#23 ! 0;
           Varalf1  = "Participaciones Socios   ";
           Cantidad = #2#23;  |HAZ Cantidad;
           Varalf2  = Cantidad;
           Cantidad = #2#24;  |HAZ Cantidad;
           Varalf3  = Cantidad;
           Varalf4  = "";
           Varalf5  = "";
           Varalf6  = "";
           Varalf7  = "";
           Varalf8  = "";
           Varalf9  = "";

           Variable = Varalf1  + " " + Varalf2 + " " + Varalf3 + " " + Varalf4;
           Variable = Variable + " " + Varalf5 + " " + Varalf6 + " " + Varalf7;
           Variable = Variable + " " + Varalf8 + " " + Varalf9;
                                                           |HAZ GrabaTemporal;

           TipoLin = 3;                                    |BUCLE agim0037A;
           Variable = "";                                  |HAZ GrabaTemporal;
      |FINSI;
  |FINSI;

  Variable = "";                                       |HAZ GrabaTemporal;
  Negrita  = 1;
  Variable = "DATOS REGISTRO";                          |HAZ GrabaTemporal;
  Variable = "--------------";                          |HAZ GrabaTemporal;
  Negrita  = 0;
  |SI #2#91 ! "     ";
      Variable = "Numero Reg.Mercantil: " + #2#91;          |HAZ GrabaTemporal;
  |FINSI;
  Variable = "Registro ...........: " + #2#25;          |HAZ GrabaTemporal;
  Variable = "Registrador ........: " + #2#26;          |HAZ GrabaTemporal;
  Variable = "Localidad ..........: " + #2#27;          |HAZ GrabaTemporal;
  Variable = "Fecha inscripcion ..: " + #2#28;          |HAZ GrabaTemporal;
  Variable = "Tomo ...............: " + #2#29 + "  Libro ....: " + #2#30;
                                                        |HAZ GrabaTemporal;
  Variable = "Seccion ............: " + #2#31 + "  Folio ....: " + #2#32;
                                                        |HAZ GrabaTemporal;
  Variable = "Hoja ...............: " + #2#33 + "  Inscripc. : " + #2#34;
                                                        |HAZ GrabaTemporal;

  Variable = "Documento ..........: " + #2#35;
                                                        |HAZ GrabaTemporal;
  Variable = "Diario .............: " + #2#36 + "  Asiento ..: " + #2#37;
                                                        |HAZ GrabaTemporal;
  Variable = "Inscripcion BIS ....: " + #2#39 + "  Hoja BIS .: " + #2#38;
                                                        |HAZ GrabaTemporal;
|FPRC;

|PROCESO Representantes;
  |SI SwCab = 0;
      SwCab    = 1;
      Negrita  = 1;
      Variable = "REPRESENTANTES / ADMINISTRADORES";       |HAZ GrabaTemporal;
      Variable = "--------------------------------";       |HAZ GrabaTemporal;
  |FINSI;

  Negrita  = 0;
  Variable = "NIF........: " + #7#3 + " Nombre : " + #7#4;
                                                           |HAZ GrabaTemporal;
  Variable = "Domicilio .: " + #7#7 + " Numero : " + #7#8 + " Telefono : " + #7#13;
                                                           |HAZ GrabaTemporal;
  CantiNum = (#7#9 * 1000) + #7#10;
  Varalf1   = ("00000" + CantiNum) % -105;
  Varalf2   = #7#11;  |QBF Varalf2;
  Varalf3   = #7#12;  |QBF Varalf3;
  Varalf4   = Varalf2 + " (" + Varalf3 + ")";
  |SI Varalf4 = " ()"; Varalf4 = "";  |FINSI;
  Variable = "Cod.Postal : " + Varalf1 + " Poblacion  : " + Varalf4;
                                                           |HAZ GrabaTemporal;
  Variable = "Fecha Poder : " + #7#5 + " Notario : " + #7#6 + "  F/J : " + #7#14;
                                                           |HAZ GrabaTemporal;


  Variable = "";                                           |HAZ GrabaTemporal;
|FPRC;

|DEFBUCLE agim0024;
  #7#1;
  ;
  #2#0, #2#1, 00;
  #2#0, #2#1, 99;
  ;
  NULL, Representantes;
|FIN;

|PROCESO agim0037B;
  Variable = "" + #37#5 + "  Del N§ : " + #37#6 + "  Al N§ : " + #37#7;
                                                           |HAZ GrabaTemporal;
|FPRC;

|DEFBUCLE agim0037B;
     #37#1;
     ;
     "agim0025", #8#0, #8#1, #8#2,  1;
     "agim0025", #8#0, #8#1, #8#2, 99;
     ;
     NULL, agim0037B;
|FIN;

|PROCESO Socios;
  |SI SwCab = 0;
      SwCab    = 1;
      Negrita  = 1;
      Variable = "SOCIOS";                                 |HAZ GrabaTemporal;
      Variable = "------";                                 |HAZ GrabaTemporal;
  |FINSI;

  Negrita  = 0;
  Variable = "NIF........: " + #8#3 + " Nombre : " + #8#4;
                                                           |HAZ GrabaTemporal;
  Variable = "Domicilio .: " + #8#5 + " Numero : " + #8#6 + " Telefono : " + #8#11;
                                                           |HAZ GrabaTemporal;
  CantiNum = (#8#7 * 1000) + #8#8;
  Varalf1   = ("00000" + CantiNum) % -105;
  Varalf2   = #8#9;  |QBF Varalf2;
  Varalf3   = #8#10;  |QBF Varalf3;
  Varalf4   = Varalf2 + " (" + Varalf3 + ")";
  |SI Varalf4 = " ()"; Varalf4 = "";  |FINSI;
  Variable = "Cod.Postal : " + Varalf1 + " Poblacion  : " + Varalf4;
                                                           |HAZ GrabaTemporal;
  Cantidad = #8#14;  |HAZ Cantidad;
  Varalf1  = Cantidad;
  Cantidad = #8#13;  |HAZ CambiDeci3_2;
  Varalf2  = Cantidad;
  Variable = "Participacion : " + Varalf1 + "     Porcentaje : " + Varalf2 + "    F/J : " + #8#12;
                                                           |HAZ GrabaTemporal;

  Variable = "";                                           |HAZ GrabaTemporal;

  |BUCLE agim0037B;

  Variable = "";                                           |HAZ GrabaTemporal;
|FPRC;

|DEFBUCLE agim0025;
  #8#1;
  ;
  #2#0, #2#1, 00;
  #2#0, #2#1, 99;
  ;
  NULL, Socios;
|FIN;

|PROCESO Cargos;
  |SI SwCab = 0;
      SwCab    = 1;
      Negrita  = 1;
      Variable = "CARGOS ADMINISTRACION";                  |HAZ GrabaTemporal;
      Variable = "---------------------";                  |HAZ GrabaTemporal;
  |FINSI;

  Negrita  = 0;
  Variable = "NIF........: " + #9#3 + " Nombre : " + #9#4;
                                                           |HAZ GrabaTemporal;
  Variable = "Domicilio .: " + #9#5 + " Numero : " + #9#6 + " Telefono : " + #9#11;
                                                           |HAZ GrabaTemporal;
  CantiNum = (#9#7 * 1000) + #9#8;
  Varalf1   = ("00000" + CantiNum) % -105;
  Varalf2   = #9#9;  |QBF Varalf2;
  Varalf3   = #9#10;  |QBF Varalf3;
  Varalf4   = Varalf2 + " (" + Varalf3 + ")";
  |SI Varalf4 = " ()"; Varalf4 = "";  |FINSI;
  Variable = "Cod.Postal : " + Varalf1 + " Poblacion  : " + Varalf4;
                                                           |HAZ GrabaTemporal;
  Variable = "Cargo .....: " + #9#17 + "   F/J ..........: " + #9#12 +  "          U/S/R ...: " + #9#13;
                                                           |HAZ GrabaTemporal;
  Variable = "F.Nombramiento ..: " + #9#14 + "  F.Renovacion .: " + #9#15;
                                                           |HAZ GrabaTemporal;

  Variable = "";                                           |HAZ GrabaTemporal;
|FPRC;

|DEFBUCLE agim0026;
  #9#1;
  ;
  #2#0, #2#1, 00;
  #2#0, #2#1, 99;
  ;
  NULL, Cargos;
|FIN;

|PROCESO OtrasEmpresas;
  |SI SwCab = 0;
      SwCab    = 1;
      Negrita  = 1;
      Variable = "PARTICIPACIONES OTRAS EMPRESAS";          |HAZ GrabaTemporal;
      Variable = "------------------------------";          |HAZ GrabaTemporal;

      Negrita  = 0;
      Variable = "NIF          Apellidos y Nombre                       CP       Nominal % Part";
                                                           |HAZ GrabaTemporal;
      Variable = "-----------------------------------------------------------------------------";
                                                           |HAZ GrabaTemporal;
  |FINSI;

  Negrita  = 0;
  Varalf1  = #10#3;
  Varalf2  = #10#4;
  Varalf3  = #10#5;
  Cantidad = #10#6;  |HAZ Cantidad;
  Varalf4  = Cantidad;
  Cantidad = #10#7;  |HAZ CambiDeci3_2;
  Varalf5  = Cantidad;
  Varalf6  = "";
  Varalf7  = "";
  Varalf8  = "";
  Varalf9  = "";

  Variable = Varalf1  + " " + Varalf2 + " " + Varalf3 + " " + Varalf4;
  Variable = Variable + " " + Varalf5 + " " + Varalf6 + " " + Varalf7;
  Variable = Variable + " " + Varalf8 + " " + Varalf9;
                                                           |HAZ GrabaTemporal;
|FPRC;

|DEFBUCLE agim0027;
  #10#1;
  ;
  #2#0, #2#1, 00;
  #2#0, #2#1, 99;
  ;
  NULL, OtrasEmpresas;
|FIN;

|PROCESO LineaBlanc;
  |SI SwCab = 0;  |ACABA;  |FINSI;
  Variable = "";                                           |HAZ GrabaTemporal;
|FPRC;

|PROCESO Reparte;
  |SI Empresa  ! #2#0;
      Empresa  = #2#0;
      Registro = #2#1;
  |FINSI;

  |SI Empresa = #2#0; |Y Registro ! #2#1;
      |ACABA;
  |FINSI;

  SwTranspa = 0;
                      SwCab = 1; |HAZ Cabecera;   |HAZ LineaBlanc;
                      SwCab = 0; |BUCLE agim0020; |HAZ LineaBlanc;
  |SI SwTranspa = 1;  SwCab = 0; |BUCLE agim0021; |HAZ LineaBlanc;  |FINSI;
                      SwCab = 0; |BUCLE agim0022; |HAZ LineaBlanc;
                      SwCab = 1; |HAZ Notaria;    |HAZ LineaBlanc;
                      SwCab = 0; |BUCLE agim0024; |HAZ LineaBlanc;
                      SwCab = 0; |BUCLE agim0025; |HAZ LineaBlanc;
                      SwCab = 0; |BUCLE agim0026; |HAZ LineaBlanc;
                      SwCab = 0; |BUCLE agim0027; |HAZ LineaBlanc;

  Variable = "";                                             |HAZ GrabaTemporal;
  Variable = "";                                             |HAZ GrabaTemporal;
|FPRC;

|DEFBUCLE agim0019;
  #2#2;
  ;
  #0#1, 99;
  #0#2, 00;
  ;
  NULL, Reparte;
|FIN;

|PROCESO Pantalla;
  |CLS;
  |D_CUADRO 0101, 2380;

  LineasAnte   = 0;
  CuadroIni    = 0402;
  CuadroFin    = 2279;
  NombreLis    = "FICHA DE SOCIEDADES";
  GruesoLis    = 78;
  ModoEdita    = 2;
  LineaInicial = 1;
  ColumInicial = 1;
  Baffer       = 0;

  |LEESECUENCIAL NombreFichero, Baffer, TotalLinea, 0, 0;
  |SI TotalLinea > 0;
      LineasPost   = TotalLinea + 1;
      |EDITA Baffer, LineasAnte, LineasPost, CuadroIni, CuadroFin, ModoEdita, NombreLis, GruesoLis, LineaInicial, ColumInicial;
  |FINSI;
  |FINDIM Baffer;
|FPRC;

|PROCESO Impresora;
  |INFOR "agiy0030";
  |SI FSalida ! 0; |ACABA; |FINSI;

  FicheroFabre  = "rt  " + NombreFichero;
  |FABRE FicheroFabre;
  |SI FSalida < 0; |FININF; |ACABA; |FINSI;
  Handle     = FSalida;
  SwPrint = 0;
  |PARA; |SI; |HACIENDO;
       Variable = Handle + " 250";
       |FLEE Variable;
       |SI FSalida < 0; |SAL; |FINSI;

       Variable = (Variable + Espacio) % 0199;

       Varalf1 = Variable % 110;
       |SI Varalf1 = "\\\Empresa";
           |SI SwPrint = 1;  |PIEINF; |FINSI;

           Valfa = Variable % 1105;
           |ABRE #1;
           #1#0 = Valfa;
           |LEE 040#1=;
           |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
           |CIERRA #1;

           Valfa = Variable % 1602;
           |ABRE #2;
           #2#0 = #1#0;
           #2#1 = Valfa;
           |LEE 040#2=;
           |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
           |CIERRA #2;

           Varalf1 = Variable % 1105;
       |SINO;
           SwPrint = 1;
           VarImpre1 = "";
           VarImpre2 = "";
           VarImpre1 = Variable % 150;
           VarImpre2 = Variable % 5150;
           |PRINT;
       |FINSI;
  |SIGUE;
  FSalida = Variable;
  |FCIERRA FSalida;

  |PIEINF;
  |FININF;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
  |MENU Menu;
  |SI FSalida ! 1; |Y FSalida ! 2; |ACABA; |FINSI;
  TipoImpre = FSalida;

  |SI FSalida = 2;
      |IMPRE 0;
      |SI FSalida ! 0; |ACABA; |FINSI;
  |FINSI;

  |DFICE Fich;
  NombreFichero = "";
  NombreFichero = Usuario % 810; |QBF NombreFichero;
  NombreFichero = (NombreFichero + "zzzzzzzz") % 108;
  NombreFichero = Fich + NombreFichero + ".com";
  LineasAnte    = 0;
  TotalLinea    = -1;
  Baffer        = 0;
  FicheroFabre  = "wt  " + NombreFichero;

  |FABRE FicheroFabre;
  |SI FSalida < 0; |ACABA; |FINSI;

  Handle = FSalida;
  |ABRE #1;
  |SI #0#0 = "S";
      |BUCLE agim0019;
  |SINO;
      |PARA XPara = 3; |SI XPara [ 22; |HACIENDO XPara = XPara + 1;
            |SI #0XPara ! 0;
                #0#1 = #0XPara;
                #0#2 = #0XPara;
                |BUCLE agim0019;
            |FINSI;
      |SIGUE;
  |FINSI;
  |CIERRA #1;
  FSalida = Handle;
  |FCIERRA FSalida;
  Pos     = -1;

  |SI TipoImpre = 1; |HAZ Pantalla;  |FINSI;
  |SI TipoImpre = 2; |HAZ Impresora; |FINSI;

  |SI TipoImpre = 2; |FINIMP; |FINSI;
  |FBORRA NombreFichero;
|FPRC;

----------------------------------------------------------
|PROCESO Seleccion; |TIPO 0;
  #0Campo = #0Campo > #0Campo;   |PINTA #0Campo;

  |SI #0Campo = "S";
      |PARA XPara = 3; |SI XPara [ 22; |HACIENDO XPara = XPara + 1;
            |C_M #0XPara,1,"N";
      |SIGUE;
      |PARA XPara = 1; |SI XPara [ 2; |HACIENDO XPara = XPara + 1;
            |C_M #0XPara,1,"S";
      |SIGUE;
  |SINO;
      |PARA XPara = 1; |SI XPara [ 2; |HACIENDO XPara = XPara + 1;
            |C_M #0XPara,1,"N";
      |SIGUE;
      |PARA XPara = 3; |SI XPara [ 22; |HACIENDO XPara = XPara + 1;
            |C_M #0XPara,1,"S";
      |SIGUE;
  |FINSI;
|FPRC;
