|FICHEROS;
     agiy0001 #0;
     agicen00 #8;
     agicen01 #1;
     agicen02 #2;
     agicen03 #3;
     agicen04 #4;
     agicen05 #5;
     agicen06 #6;
     agicen07 #7;
     agicen11 #11;
     agicen12 #12;
     agicen13 #13;
     agiw0003 #95;
     agihacie #96;
     agifigen #97;
     agiw0002 #99,MANTE;
|FIN;

|INCLUYE i_consul;

|VARIABLES;
     Linea    = 0;
     Contador = 0;
     SwPrint  = 0;
     Tipo     = 0;

     &hoja    = 1;
     &t_hojas = 0;
|FIN;

|INCLUYE i_ficher;


|| *************************
|| IMPRESION MODELO A¥O 1997
|| *************************

|PROCESO CargaDef97;
  |DDEFECTO #95;
  |SI #3#004 = "A"; #95#000 = "X"; |FINSI;
  |SI #3#004 = "B"; #95#001 = "X"; |FINSI;
  |SI #3#005 = "S"; #95#002 = "X"; |FINSI;
  |SI #3#005 = "N"; #95#003 = "X"; |FINSI;
  |SI #3#006 = "S"; #95#004 = "X"; |FINSI;
  |SI #3#007 = "S"; #95#005 = "X"; |FINSI;
  |SI #3#007 = "N"; #95#006 = "X"; |FINSI;
  |SI #3#008 = "S"; #95#007 = "X"; |FINSI;
  |SI #3#008 = "N"; #95#008 = "X"; |FINSI;
  |SI #3#009 = "S"; #95#009 = "X"; |FINSI;
  |SI #3#010 = "S"; #95#010 = "X"; |FINSI;
  |SI #3#010 = "R"; #95#011 = "X"; |FINSI;
  |SI #3#010 = "V"; #95#012 = "X"; |FINSI;
  |SI #3#010 = "E"; #95#013 = "X"; |FINSI;
  |SI #3#011 = "S"; #95#014 = "X"; |FINSI;
  |SI #3#011 = "R"; #95#015 = "X"; |FINSI;
  |SI #3#011 = "V"; #95#016 = "X"; |FINSI;
  |SI #3#011 = "E"; #95#017 = "X"; |FINSI;
  |SI #3#012 = "S"; #95#018 = "X"; |FINSI;
  |SI #3#012 = "R"; #95#019 = "X"; |FINSI;
  |SI #3#012 = "V"; #95#020 = "X"; |FINSI;
  |SI #3#012 = "E"; #95#021 = "X"; |FINSI;
  |SI #3#013 = "R"; #95#022 = "X"; |FINSI;
  |SI #3#013 = "V"; #95#023 = "X"; |FINSI;
  |SI #3#013 = "E"; #95#024 = "X"; |FINSI;
  |SI #3#014 = "S"; #95#025 = "X"; |FINSI;
  |SI #3#014 = "R"; #95#026 = "X"; |FINSI;
  |SI #3#014 = "V"; #95#027 = "X"; |FINSI;
  |SI #3#014 = "E"; #95#028 = "X"; |FINSI;
  |SI #3#015 = "S"; #95#029 = "X"; |FINSI;
  |SI #3#015 = "R"; #95#030 = "X"; |FINSI;
  |SI #3#015 = "V"; #95#031 = "X"; |FINSI;
  |SI #3#015 = "E"; #95#032 = "X"; |FINSI;
  |SI #3#016 = "S"; #95#033 = "X"; |FINSI;
  |SI #3#016 = "N"; #95#034 = "X"; |FINSI;

  |SI #4#004 = "S"; #95#035 = "X"; |FINSI;
  |SI #4#004 = "N"; #95#036 = "X"; |FINSI;
  |SI #4#005 = "S"; #95#037 = "X"; |FINSI;
  |SI #4#005 = "N"; #95#038 = "X"; |FINSI;
  |SI #4#006 = "S"; #95#039 = "X"; |FINSI;
  |SI #4#006 = "N"; #95#040 = "X"; |FINSI;
  |SI #4#007 = "S"; #95#041 = "X"; |FINSI;
  |SI #4#007 = "N"; #95#042 = "X"; |FINSI;
  |SI #4#008 = "S"; #95#043 = "X"; |FINSI;
  |SI #4#008 = "N"; #95#044 = "X"; |FINSI;
  |SI #4#009 = "S"; #95#045 = "X"; |FINSI;
  |SI #4#009 = "N"; #95#046 = "X"; |FINSI;
  |SI #4#010 = "S"; #95#047 = "X"; |FINSI;
  |SI #4#010 = "N"; #95#048 = "X"; |FINSI;
  |SI #4#011 = "S"; #95#049 = "X"; |FINSI;
  |SI #4#011 = "N"; #95#050 = "X"; |FINSI;
  |SI #4#012 = "S"; #95#051 = "X"; |FINSI;
  |SI #4#012 = "N"; #95#052 = "X"; |FINSI;
  |SI #4#013 = "S"; #95#053 = "X"; |FINSI;
  |SI #4#013 = "N"; #95#054 = "X"; |FINSI;
  |SI #4#014 = "S"; #95#055 = "X"; |FINSI;
  |SI #4#014 = "N"; #95#056 = "X"; |FINSI;
  |SI #4#015 = "S"; #95#057 = "X"; |FINSI;
  |SI #4#015 = "N"; #95#058 = "X"; |FINSI;
  |SI #4#016 = "S"; #95#059 = "X"; |FINSI;
  |SI #4#016 = "N"; #95#060 = "X"; |FINSI;
  |SI #4#017 = "S"; #95#061 = "X"; |FINSI;
  |SI #4#017 = "N"; #95#062 = "X"; |FINSI;
  |SI #4#018 = "S"; #95#063 = "X"; |FINSI;
  |SI #4#018 = "N"; #95#064 = "X"; |FINSI;
  |SI #4#019 = "S"; #95#065 = "X"; |FINSI;
  |SI #4#019 = "N"; #95#066 = "X"; |FINSI;
  |SI #4#020 = "S"; #95#067 = "X"; |FINSI;
  |SI #4#020 = "N"; #95#068 = "X"; |FINSI;
  |SI #4#021 = "S"; #95#069 = "X"; |FINSI;
  |SI #4#021 = "N"; #95#070 = "X"; |FINSI;
  |SI #4#022 = "S"; #95#071 = "X"; |FINSI;
  |SI #4#022 = "N"; #95#072 = "X"; |FINSI;
  |SI #4#023 = "S"; #95#073 = "X"; |FINSI;
  |SI #4#023 = "N"; #95#074 = "X"; |FINSI;
  |SI #4#024 = "S"; #95#075 = "X"; |FINSI;
  |SI #4#024 = "N"; #95#076 = "X"; |FINSI;
  |SI #4#025 = "S"; #95#077 = "X"; |FINSI;
  |SI #4#025 = "N"; #95#078 = "X"; |FINSI;
  |SI #4#026 = "S"; #95#079 = "X"; |FINSI;
  |SI #4#026 = "N"; #95#080 = "X"; |FINSI;
  |SI #4#027 = "S"; #95#081 = "X"; |FINSI;
  |SI #4#027 = "N"; #95#082 = "X"; |FINSI;

  |SI #7#004 = "S"; #95#083 = "X"; |FINSI;
  |SI #7#015 = "S"; #95#084 = "X"; |FINSI;
  |SI #7#005 = "S"; #95#085 = "X"; |FINSI;
  |SI #7#006 = "S"; #95#086 = "X"; |FINSI;
  |SI #7#016 = "S"; #95#087 = "X"; |FINSI;
  |SI #7#008 = "S"; #95#088 = "X"; |FINSI;
  |SI #7#007 = "S"; #95#089 = "X"; |FINSI;
  |SI #7#009 = "S"; #95#090 = "X"; |FINSI;
  |SI #7#010 = "S"; #95#091 = "X"; |FINSI;
  |SI #7#011 = "S"; #95#092 = "X"; |FINSI;
  |SI #7#012 = "S"; #95#093 = "X"; |FINSI;
  |SI #7#013 = "S"; #95#094 = "X"; |FINSI;
  |SI #7#014 = "S"; #95#095 = "X"; |FINSI;
  |SI #7#017 = "S"; #95#096 = "X"; |FINSI;
  |SI #7#021 = "S"; #95#097 = "X"; |FINSI;

  |SI #7#004 = "N"; #95#098 = "X"; |FINSI;
  |SI #7#015 = "N"; #95#099 = "X"; |FINSI;
  |SI #7#005 = "N"; #95#100 = "X"; |FINSI;
  |SI #7#006 = "N"; #95#101 = "X"; |FINSI;
  |SI #7#016 = "N"; #95#102 = "X"; |FINSI;
  |SI #7#008 = "N"; #95#103 = "X"; |FINSI;
  |SI #7#007 = "N"; #95#104 = "X"; |FINSI;
  |SI #7#009 = "N"; #95#105 = "X"; |FINSI;
  |SI #7#010 = "N"; #95#106 = "X"; |FINSI;
  |SI #7#011 = "N"; #95#107 = "X"; |FINSI;
  |SI #7#012 = "N"; #95#108 = "X"; |FINSI;
  |SI #7#013 = "N"; #95#109 = "X"; |FINSI;
  |SI #7#014 = "N"; #95#110 = "X"; |FINSI;
  |SI #7#017 = "N"; #95#111 = "X"; |FINSI;
  |SI #7#021 = "N"; #95#112 = "X"; |FINSI;

  |SI #7#004 = "D"; #95#113 = "X"; |FINSI;
  |SI #7#015 = "D"; #95#114 = "X"; |FINSI;
  |SI #7#005 = "D"; #95#115 = "X"; |FINSI;
  |SI #7#006 = "D"; #95#116 = "X"; |FINSI;
  |SI #7#016 = "D"; #95#117 = "X"; |FINSI;
  |SI #7#008 = "D"; #95#118 = "X"; |FINSI;
  |SI #7#007 = "D"; #95#119 = "X"; |FINSI;
  |SI #7#009 = "D"; #95#120 = "X"; |FINSI;
  |SI #7#010 = "D"; #95#121 = "X"; |FINSI;
  |SI #7#011 = "D"; #95#122 = "X"; |FINSI;
  |SI #7#012 = "D"; #95#123 = "X"; |FINSI;
  |SI #7#013 = "D"; #95#124 = "X"; |FINSI;
  |SI #7#014 = "D"; #95#125 = "X"; |FINSI;
  |SI #7#017 = "D"; #95#126 = "X"; |FINSI;
  |SI #7#020 = "D"; #95#127 = "X"; |FINSI;
  |SI #7#021 = "D"; #95#128 = "X"; |FINSI;

  |SI #7#004 = "R"; #95#129 = "X"; |FINSI;
  |SI #7#015 = "R"; #95#130 = "X"; |FINSI;
  |SI #7#005 = "R"; #95#131 = "X"; |FINSI;
  |SI #7#006 = "R"; #95#132 = "X"; |FINSI;
  |SI #7#016 = "R"; #95#133 = "X"; |FINSI;
  |SI #7#008 = "R"; #95#134 = "X"; |FINSI;
  |SI #7#007 = "R"; #95#135 = "X"; |FINSI;
  |SI #7#009 = "R"; #95#136 = "X"; |FINSI;
  |SI #7#010 = "R"; #95#137 = "X"; |FINSI;
  |SI #7#011 = "R"; #95#138 = "X"; |FINSI;
  |SI #7#012 = "R"; #95#139 = "X"; |FINSI;
  |SI #7#013 = "R"; #95#140 = "X"; |FINSI;
  |SI #7#014 = "R"; #95#141 = "X"; |FINSI;
  |SI #7#017 = "R"; #95#142 = "X"; |FINSI;
  |SI #7#020 = "R"; #95#143 = "X"; |FINSI;
  |SI #7#021 = "R"; #95#144 = "X"; |FINSI;

  |SI #7#022 = "S"; #95#145 = "X"; |FINSI;
  |SI #7#022 = "N"; #95#146 = "X"; |FINSI;
  |SI #7#023 = "S"; #95#147 = "X"; |FINSI;
  |SI #7#023 = "N"; #95#148 = "X"; |FINSI;
|FPRC;

|PROCESO Particip97;
  Contador = Contador + 1;

  |SI SwPrint = 0; |ACABA; |FINSI;

  |SI Contador [ 4; |PRINT; |FINSI;
|FPRC;

|DEFBUCLE agicen06;
  #6#1;
  ;
  #99#1, #99#3, 01;
  #99#1, #99#3, 99;
  e;
  NULL, Particip97;
|FIN;

|PROCESO Imprime97;
  |ABRE #3;                                  || Situacion Tributaria
  #3#0 = #99#1;
  #3#1 = #99#3;
  |LEE 040#3=;
  |SI FSalida ! 0; |DDEFECTO #3; |FINSI;
  |CIERRA #3;

  |ABRE #4;                                  || Declaraciones y Cese
  #4#0 = #99#1;
  #4#1 = #99#3;
  |LEE 040#4=;
  |SI FSalida ! 0; |DDEFECTO #4; |FINSI;
  |CIERRA #4;

  |HAZ CargaDef97;

  |INFOR "m036h001";
  |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;

  |INFOR "m036h002";
  |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;

  |INFOR "m036h003";
  |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;

  |INFOR "m036h004";
  |SI FSalida  = 0;
      Contador    = 0; SwPrint = 0; |BUCLE agicen06;

      t_hojas = ((Contador / 4) + 0.49) ! 0;

      Contador   = 0; SwPrint = 1;  |BUCLE agicen06;

      |SI Contador ! 0; |PIEINF; |FINSI;
      |FININF;
  |FINSI;

  |INFOR "m036h005";
  |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
|FPRC;

|| *************************
|| IMPRESION MODELO A¥O 1998
|| *************************

|PROCESO CargaDef98;
  |DDEFECTO #95;
  |SI #11#004 = "A"; #95#000 = "X"; |FINSI;
  |SI #11#004 = "B"; #95#001 = "X"; |FINSI;
  |SI #11#005 = "S"; #95#002 = "X"; |FINSI;
  |SI #11#005 = "N"; #95#003 = "X"; |FINSI;
  |SI #11#006 = "S"; #95#005 = "X"; |FINSI;
  |SI #11#006 = "N"; #95#006 = "X"; |FINSI;
  |SI #11#007 = "S"; #95#007 = "X"; |FINSI;
  |SI #11#007 = "N"; #95#008 = "X"; |FINSI;
  |SI #11#008 = "S"; #95#009 = "X"; |FINSI;
  |SI #11#009 = "S"; #95#010 = "X"; |FINSI;
  |SI #11#009 = "R"; #95#011 = "X"; |FINSI;
  |SI #11#009 = "V"; #95#012 = "X"; |FINSI;
  |SI #11#009 = "E"; #95#013 = "X"; |FINSI;
  |SI #11#010 = "S"; #95#014 = "X"; |FINSI;
  |SI #11#010 = "R"; #95#015 = "X"; |FINSI;
  |SI #11#010 = "V"; #95#016 = "X"; |FINSI;
  |SI #11#010 = "E"; #95#017 = "X"; |FINSI;
  |SI #11#011 = "S"; #95#151 = "X"; |FINSI;
  |SI #11#011 = "R"; #95#022 = "X"; |FINSI;
  |SI #11#011 = "V"; #95#023 = "X"; |FINSI;
  |SI #11#011 = "E"; #95#024 = "X"; |FINSI;
  |SI #11#012 = "S"; #95#025 = "X"; |FINSI;
  |SI #11#012 = "R"; #95#026 = "X"; |FINSI;
  |SI #11#012 = "V"; #95#027 = "X"; |FINSI;
  |SI #11#012 = "E"; #95#028 = "X"; |FINSI;
  |SI #11#013 = "S"; #95#033 = "X"; |FINSI;
  |SI #11#013 = "N"; #95#034 = "X"; |FINSI;
  |SI #11#024 = "S"; #95#153 = "X"; |FINSI;
  |SI #11#024 = "N"; #95#154 = "X"; |FINSI;
  |SI #11#025 = "S"; #95#155 = "X"; |FINSI;
  |SI #11#025 = "N"; #95#156 = "X"; |FINSI;

  |SI #12#004 = "S"; #95#035 = "X"; |FINSI;
  |SI #12#004 = "N"; #95#036 = "X"; |FINSI;
  |SI #12#005 = "S"; #95#004 = "X"; |FINSI;
  |SI #12#005 = "N"; #95#152 = "X"; |FINSI;
  |SI #12#006 = "S"; #95#037 = "X"; |FINSI;
  |SI #12#006 = "N"; #95#038 = "X"; |FINSI;
  |SI #12#007 = "S"; #95#039 = "X"; |FINSI;
  |SI #12#007 = "N"; #95#040 = "X"; |FINSI;
  |SI #12#008 = "S"; #95#041 = "X"; |FINSI;
  |SI #12#008 = "N"; #95#042 = "X"; |FINSI;
  |SI #12#009 = "S"; #95#043 = "X"; |FINSI;
  |SI #12#009 = "N"; #95#044 = "X"; |FINSI;
  |SI #12#010 = "S"; #95#045 = "X"; |FINSI;
  |SI #12#010 = "N"; #95#046 = "X"; |FINSI;
  |SI #12#011 = "S"; #95#047 = "X"; |FINSI;
  |SI #12#011 = "N"; #95#048 = "X"; |FINSI;
  |SI #12#012 = "S"; #95#049 = "X"; |FINSI;
  |SI #12#012 = "N"; #95#050 = "X"; |FINSI;
  |SI #12#013 = "S"; #95#051 = "X"; |FINSI;
  |SI #12#013 = "N"; #95#052 = "X"; |FINSI;
  |SI #12#014 = "S"; #95#053 = "X"; |FINSI;
  |SI #12#014 = "N"; #95#054 = "X"; |FINSI;
  |SI #12#015 = "S"; #95#059 = "X"; |FINSI;
  |SI #12#015 = "N"; #95#060 = "X"; |FINSI;
  |SI #12#016 = "S"; #95#061 = "X"; |FINSI;
  |SI #12#016 = "N"; #95#062 = "X"; |FINSI;
  |SI #12#017 = "S"; #95#063 = "X"; |FINSI;
  |SI #12#017 = "N"; #95#064 = "X"; |FINSI;
  |SI #12#018 = "S"; #95#065 = "X"; |FINSI;
  |SI #12#018 = "N"; #95#066 = "X"; |FINSI;
  |SI #12#019 = "S"; #95#067 = "X"; |FINSI;
  |SI #12#019 = "N"; #95#068 = "X"; |FINSI;
  |SI #12#020 = "S"; #95#069 = "X"; |FINSI;
  |SI #12#020 = "N"; #95#070 = "X"; |FINSI;
  |SI #12#021 = "S"; #95#077 = "X"; |FINSI;
  |SI #12#021 = "N"; #95#078 = "X"; |FINSI;
  |SI #12#022 = "S"; #95#079 = "X"; |FINSI;
  |SI #12#022 = "N"; #95#080 = "X"; |FINSI;
  |SI #12#023 = "S"; #95#081 = "X"; |FINSI;
  |SI #12#023 = "N"; #95#082 = "X"; |FINSI;
  |SI #12#024 = "S"; #95#149 = "X"; |FINSI;
  |SI #12#024 = "N"; #95#150 = "X"; |FINSI;
  |SI #12#027 = "S"; #95#157 = "X"; |FINSI;
  |SI #12#027 = "N"; #95#158 = "X"; |FINSI;
  |SI #12#028 = "S"; #95#159 = "X"; |FINSI;
  |SI #12#028 = "N"; #95#160 = "X"; |FINSI;
  |SI #12#029 = "S"; #95#161 = "X"; |FINSI;
  |SI #12#029 = "N"; #95#162 = "X"; |FINSI;
  |SI #12#030 = "S"; #95#163 = "X"; |FINSI;
  |SI #12#030 = "N"; #95#164 = "X"; |FINSI;

  |SI #7#004 = "S"; #95#083 = "X"; |FINSI;
  |SI #7#015 = "S"; #95#084 = "X"; |FINSI;
  |SI #7#005 = "S"; #95#085 = "X"; |FINSI;
  |SI #7#006 = "S"; #95#086 = "X"; |FINSI;
  |SI #7#016 = "S"; #95#087 = "X"; |FINSI;
  |SI #7#008 = "S"; #95#088 = "X"; |FINSI;
  |SI #7#007 = "S"; #95#089 = "X"; |FINSI;
  |SI #7#009 = "S"; #95#090 = "X"; |FINSI;
  |SI #7#010 = "S"; #95#091 = "X"; |FINSI;
  |SI #7#011 = "S"; #95#092 = "X"; |FINSI;
  |SI #7#012 = "S"; #95#093 = "X"; |FINSI;
  |SI #7#013 = "S"; #95#094 = "X"; |FINSI;
  |SI #7#014 = "S"; #95#095 = "X"; |FINSI;
  |SI #7#017 = "S"; #95#096 = "X"; |FINSI;
  |SI #7#021 = "S"; #95#097 = "X"; |FINSI;

  |SI #7#004 = "N"; #95#098 = "X"; |FINSI;
  |SI #7#015 = "N"; #95#099 = "X"; |FINSI;
  |SI #7#005 = "N"; #95#100 = "X"; |FINSI;
  |SI #7#006 = "N"; #95#101 = "X"; |FINSI;
  |SI #7#016 = "N"; #95#102 = "X"; |FINSI;
  |SI #7#008 = "N"; #95#103 = "X"; |FINSI;
  |SI #7#007 = "N"; #95#104 = "X"; |FINSI;
  |SI #7#009 = "N"; #95#105 = "X"; |FINSI;
  |SI #7#010 = "N"; #95#106 = "X"; |FINSI;
  |SI #7#011 = "N"; #95#107 = "X"; |FINSI;
  |SI #7#012 = "N"; #95#108 = "X"; |FINSI;
  |SI #7#013 = "N"; #95#109 = "X"; |FINSI;
  |SI #7#014 = "N"; #95#110 = "X"; |FINSI;
  |SI #7#017 = "N"; #95#111 = "X"; |FINSI;
  |SI #7#021 = "N"; #95#112 = "X"; |FINSI;

  |SI #7#004 = "D"; #95#113 = "X"; |FINSI;
  |SI #7#015 = "D"; #95#114 = "X"; |FINSI;
  |SI #7#005 = "D"; #95#115 = "X"; |FINSI;
  |SI #7#006 = "D"; #95#116 = "X"; |FINSI;
  |SI #7#016 = "D"; #95#117 = "X"; |FINSI;
  |SI #7#008 = "D"; #95#118 = "X"; |FINSI;
  |SI #7#007 = "D"; #95#119 = "X"; |FINSI;
  |SI #7#009 = "D"; #95#120 = "X"; |FINSI;
  |SI #7#010 = "D"; #95#121 = "X"; |FINSI;
  |SI #7#011 = "D"; #95#122 = "X"; |FINSI;
  |SI #7#012 = "D"; #95#123 = "X"; |FINSI;
  |SI #7#013 = "D"; #95#124 = "X"; |FINSI;
  |SI #7#014 = "D"; #95#125 = "X"; |FINSI;
  |SI #7#017 = "D"; #95#126 = "X"; |FINSI;
  |SI #7#020 = "D"; #95#127 = "X"; |FINSI;
  |SI #7#021 = "D"; #95#128 = "X"; |FINSI;

  |SI #7#004 = "R"; #95#129 = "X"; |FINSI;
  |SI #7#015 = "R"; #95#130 = "X"; |FINSI;
  |SI #7#005 = "R"; #95#131 = "X"; |FINSI;
  |SI #7#006 = "R"; #95#132 = "X"; |FINSI;
  |SI #7#016 = "R"; #95#133 = "X"; |FINSI;
  |SI #7#008 = "R"; #95#134 = "X"; |FINSI;
  |SI #7#007 = "R"; #95#135 = "X"; |FINSI;
  |SI #7#009 = "R"; #95#136 = "X"; |FINSI;
  |SI #7#010 = "R"; #95#137 = "X"; |FINSI;
  |SI #7#011 = "R"; #95#138 = "X"; |FINSI;
  |SI #7#012 = "R"; #95#139 = "X"; |FINSI;
  |SI #7#013 = "R"; #95#140 = "X"; |FINSI;
  |SI #7#014 = "R"; #95#141 = "X"; |FINSI;
  |SI #7#017 = "R"; #95#142 = "X"; |FINSI;
  |SI #7#020 = "R"; #95#143 = "X"; |FINSI;
  |SI #7#021 = "R"; #95#144 = "X"; |FINSI;

  |SI #7#022 = "S"; #95#145 = "X"; |FINSI;
  |SI #7#022 = "N"; #95#146 = "X"; |FINSI;
  |SI #7#023 = "S"; #95#147 = "X"; |FINSI;
  |SI #7#023 = "N"; #95#148 = "X"; |FINSI;
  |SI #7#023 = "S"; #95#147 = "X"; |FINSI;
|FPRC;

|PROCESO Particip98;
  Contador = Contador + 1;

  |SI SwPrint = 0; |ACABA; |FINSI;

  |SI Contador [ 3; |PRINT; |FINSI;
|FPRC;

|DEFBUCLE agicen13;
  #13#1;
  ;
  #99#1, #99#3, 01;
  #99#1, #99#3, 99;
  e;
  NULL, Particip98;
|FIN;

|PROCESO Imprime98;
  |ABRE #11;                                  || Situacion Tributaria
  #11#0 = #99#1;
  #11#1 = #99#3;
  |LEE 040#11=;
  |SI FSalida ! 0; |DDEFECTO #11; |FINSI;
  |CIERRA #11;

  |ABRE #12;                                  || Declaraciones y Cese
  #12#0 = #99#1;
  #12#1 = #99#3;
  |LEE 040#12=;
  |SI FSalida ! 0; |DDEFECTO #12; |FINSI;
  |CIERRA #12;

  |HAZ CargaDef98;

  |SI #0#5 = 2;  |INFOR "m036h011";  |FINSI;
  |SI #0#5 = 3;  |INFOR "m036h021";  |FINSI;
  |SI #0#5 = 4;  |INFOR "m036h031";  |FINSI;
  |SI #0#5 = 5;  |INFOR "m036h041";  |FINSI;
  |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;

  |SI #0#5 = 2;  |INFOR "m036h012";  |FINSI;
  |SI #0#5 = 3;  |INFOR "m036h022";  |FINSI;
  |SI #0#5 = 4;  |INFOR "m036h032";  |FINSI;
  |SI #0#5 = 5;  |INFOR "m036h042";  |FINSI;
  |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;

  |SI #0#5 = 2;  |INFOR "m036h013";  |FINSI;
  |SI #0#5 = 3;  |INFOR "m036h023";  |FINSI;
  |SI #0#5 = 4;  |INFOR "m036h033";  |FINSI;
  |SI #0#5 = 5;  |INFOR "m036h043";  |FINSI;
  |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;

  |SI #0#5 = 2;  |INFOR "m036h014";  |FINSI;
  |SI #0#5 = 3;  |INFOR "m036h024";  |FINSI;
  |SI #0#5 = 4;  |INFOR "m036h034";  |FINSI;
  |SI #0#5 = 5;  |INFOR "m036h044";  |FINSI;
  |SI FSalida  = 0;
      Contador    = 0; SwPrint = 0; |BUCLE agicen13;

      t_hojas = ((Contador / 3) + 0.49) ! 0;

      Contador   = 0; SwPrint = 1;  |BUCLE agicen13;

      |SI Contador ! 0; |PIEINF; |FINSI;
      |FININF;
  |FINSI;

  |SI #0#5 = 2;  |INFOR "m036h015";  |FINSI;
  |SI #0#5 = 3;  |INFOR "m036h025";  |FINSI;
  |SI #0#5 = 4;  |INFOR "m036h035";  |FINSI;
  |SI #0#5 = 5;  |INFOR "m036h045";  |FINSI;
  |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
|FPRC;

|| ****************
|| IMPRESION MODELO
|| ****************

|PROCESO Imprime;
  |ABRE #97;                                  || Datos Contribuyentes
  #97#0 = #99#1;
  |LEE 040#97=;
  |SI FSalida ! 0; |DDEFECTO #97; |FINSI;
  |CIERRA #97;

  |ABRE #8;                                  || Acceso al Censo
  #8#0 = #99#1;
  |LEE 040#8=;
  |SI FSalida ! 0; |DDEFECTO #8; |FINSI;
  |CIERRA #8;

  |ABRE #96;                                  || Datos Hacienda
  #96#0 = #97#63;
  #96#1 = #97#64;
  |LEE 040#96=;
  |SI FSalida ! 0; |DDEFECTO #96; |FINSI;
  |CIERRA #96;

  |ABRE #1;                                  || Lineas Censo
  #1#0 = #99#1;
  #1#1 = #99#3;
  |LEE 040#1=;
  |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
  |CIERRA #1;

  |ABRE #2;                                  || Causas y otros Datos Censales
  #2#0 = #99#1;
  #2#1 = #99#3;
  |LEE 040#2=;
  |SI FSalida ! 0; |DDEFECTO #2; |FINSI;
  |CIERRA #2;

  |ABRE #5;                                  || Representante y Obligado Trib.
  #5#0 = #99#1;
  #5#1 = #99#3;
  |LEE 040#5=;
  |SI FSalida ! 0; |DDEFECTO #5; |FINSI;
  |CIERRA #5;

  |ABRE #7;                                  || Operaciones Intracomunitarias
  #7#0 = #99#1;
  #7#1 = #99#3;
  |LEE 040#7=;
  |SI FSalida ! 0; |DDEFECTO #7; |FINSI;
  |CIERRA #7;

  |SI #0#5 = 1;  |HAZ Imprime97;  |FINSI;
  |SI #0#5 ] 2;  |HAZ Imprime98;  |FINSI;
|FPRC;

|DEFBUCLE agiw0002;
  #99#1;
  5;
  00001, "S";
  Linea, "S";
  e;
  NULL, Imprime;
|FIN;

|| **********************
|| Grabacion del Temporal
||***********************

|PROCESO CargaTempo;
  Linea = Linea + 1;
  #99#0 = Linea;
  #99#1 = #1#0;
  #99#2 = #1#7;
  #99#3 = #1#1;
  #99#4 = #1#4;
  |SI #0#4 = "S"; #99#5 = "N"; |SINO; #99#5 = "S"; |FINSI;
  |GRABA 040#99n;
|FPRC;

|DEFBUCLE agicen01;
  #1#1;
  6;
  #0#0, #0#2, Tipo;
  #0#1, #0#3, Tipo;
  e;
  NULL, CargaTempo;
|FIN;

|RUTINA ClaveBaja;
  #99#0 = 1;
|FRUT;

|RUTINA ClaveAlta;
  #99#0 = Linea;
|FRUT;

|PROCESO Tipo3; |TIPO 3;
  |SI #0#5 = 1;  Tipo = 1;  |FINSI;
  |SI #0#5 ] 2;  Tipo = 3;  |FINSI;

  |IMPRE 0;
  |SI FSalida ! 0; |ACABA; |FINSI;

  comienza = "02";
  |HAZ fichero;

  |NOME_DAT #99 fichero;

  |ABRE #99; |CIERRA #99; |DELINDEX #99;

  Linea = 0;
  |ABRE #99;
  |BUCLE agicen01;
  |CIERRA #99;

  |SI Linea = 0; |FINIMP; |ACABA; |FINSI;

  |PINPA #0#99;
  |ENTLINEAL #1#99, 1, 4, 19, 0, ClaveBaja, ClaveAlta;

  |BUCLE agiw0002;

  |FINIMP;
  |DELINDEX #99;
|FPRC;


|PROCESO funcion_1; |TIPO 11;
  |SI FSalida ! 9; |ACABA; |FINSI;

  |LIBERA #99;
  |LEE 140#99=;

  |SI #99#5 = "S"; #99#5 = "N"; |SINO; #99#5 = "S"; |FINSI;
  |PINTA #99#5;
  |GRABA 140#99a;
  |PTEC 809;
|FPRC;
