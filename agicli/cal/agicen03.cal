|FICHEROS;
    agicen03 #3;
    agifigen #1;
|FIN;

|VARIABLES;
   &c_empre     = 0;
   &c_activ     = 0;
   &c_tipo      = 0;
   &n_empre     = "";
   &n_activ     = "";

     aNifQbf1   = "";
     aNifQbf2   = "";

     &eaVarDni  = "";
     &enCalcCif = 0;
|FIN;

|PROCESO LetrasDni;
     |SI FSalida = 9;
         eaVarDni   = #3Campo;
         enCalcCif  = 1;
         |HAZ CalculoDNI;
         #3Campo = eaVarDni;
         |PINTA #3Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #3Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;

     aNifQbf1 = #3Campo;   |QBF aNifQbf1;
     aNifQbf2 = eaVarDni;  |QBF aNifQbf2;

     |SI aNifQbf1 ! aNifQbf2; |Y aNifQbf1 ! "";
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #3Campo = eaVarDni;  |PINTA #3Campo;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROGRAMA;
|ABRE #3;
|PINPA #0#3;
#3#0 = c_empre;
#3#1 = c_activ;
|LIBERA #3;
|LEE 140#3=;
|SI FSalida = 0;
    |HAZ campo_03;
    |PINDA #0#3;
    |ENDATOS #2#3;
    |SI FSalida = 0; |GRABA 140#3a; |FINSI;
|SINO;
    |DDEFECTO #3;
    #3#0 = c_empre;
    #3#1 = c_activ;
    #3#2 = n_empre;
    #3#3 = n_activ;
    |HAZ campo_03;
    |HAZ CogeCliente;
    |PINDA #0#3;
    |ENDATOS #1#3;
    |SI FSalida = 0; |GRABA 140#3n; |FINSI;
|FINSI;
|CIERRA #3;
|FPRO;

|PROCESO campo_03;
|SI c_tipo = 2;
    |CAMPO_MODIFICA #3#19, 1, "N";
    |CAMPO_MODIFICA #3#20, 1, "N";
    |CAMPO_MODIFICA #3#21, 1, "N";
    |CAMPO_MODIFICA #3#22, 1, "N";

    #3#19 = "";  #3#20 = "";  #3#21 = "";  #3#22 = "";
|SINO;
    |CAMPO_MODIFICA #3#19, 1, "S";
    |CAMPO_MODIFICA #3#20, 1, "S";
    |CAMPO_MODIFICA #3#21, 1, "S";
    |CAMPO_MODIFICA #3#22, 1, "S";
|FINSI;
|FPRC;

|PROCESO CogeCliente;
|ABRE #1;
#1#0 = c_empre;
|LEE 040#1=;
|SI FSalida ! 0; |DDEFECTO #1; |FINSI;
|CIERRA #1;

#3#17 = #1#13;     || NIF
#3#18 = #1#1;      || Razon social
|FPRC;
