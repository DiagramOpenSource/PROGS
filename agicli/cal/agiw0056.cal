|FICHEROS;
     agiw0056 #0;
     agimunic #100;
|FIN;

|VARIABLES;
     nCampo     = 0;
     nCampo1    = 0;
     nCampo2    = 0;
     nCampo3    = 0;
     nCampo4    = 0;
     aAlfa1     = "";
     aAlfa2     = "";


     &eaVarDni  = "";
     &enCalcCif = 0;

     &eaTabla    = "";
     &eaDestino  = "";
     &eaAlfa     = "";
     &enError    = 0;
     &enComp     = 0;
     &enPosicion = 0;
|FIN;

|PROCESO Tipo12w56;  |TIPO 12;
     || Para que no pregunte el correcto si o no
|FPRC;

|PROCESO SacaGrupow56;  |TIPO 7;
     eaTabla = "txtm0009.txt";
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompruebaGrupow56;  |TIPO 0;
     nCampo   = Campo + 1;
     |SI FSalida = 10;
         enPosicion = 55;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 101;
         #0Campo  = aAlfa1;
         |PINTA #0Campo;
     |FINSI;

     enComp = 1;
     eaAlfa = #0Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 101;
     aAlfa2   = eaDestino % 315;
     #0Campo  = aAlfa1;
     #0nCampo = aAlfa2;

     |PINTA #0Campo;
     |PINTA #0nCampo;

     |HAZ FinTabla;
|FPRC;

|PROCESO SacaEpiw56;  |TIPO 7;
     |SI #0#0 = " ";  |ACABA;                    |FINSI;
     |SI #0#0 = "1";  |O #0#0= "E";  eaTabla = "txtm0011.txt";  |FINSI;
     |SI #0#0 = "2";  |O #0#0= "P";  eaTabla = "txtm0012.txt";  |FINSI;
     |SI #0#0 = "3";  |O #0#0= "A";  eaTabla = "txtm0013.txt";  |FINSI;

     |HAZ CargaTabla;
|FPRC;

|PROCESO CompruebaEpiw56;  |TIPO 0;
     nCampo   = Campo + 1;

     |SI #0#0 = " ";
         #0Campo   = "";
         #0nCampo  = "";
         |PINTA #0Campo;
         |PINTA #0nCampo;
         |ACABA;
     |FINSI;

     |SI FSalida = 10;
         enPosicion = 20;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 104;
         #0Campo  = aAlfa1;
         |PINTA #0Campo;
     |FINSI;

     enComp = 4;
     eaAlfa = #0Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 104;
     aAlfa2   = eaDestino % 660;
     #0Campo  = aAlfa1;
     #0nCampo = aAlfa2;

     |PINTA #0Campo;
     |PINTA #0nCampo;

     |HAZ FinTabla;
|FPRC;

|PROCESO SacaTipow56;  |TIPO 7;
     eaTabla = "txtm0010.txt";
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompruebaTipow56;  |TIPO 0;
     nCampo   = Campo + 1;
     |SI FSalida = 10;
         enPosicion = 55;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 103;
         #0Campo  = aAlfa1;
         |PINTA #0Campo;
     |FINSI;

     enComp = 3;
     eaAlfa = #0Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 103;
     aAlfa2   = eaDestino % 525;
     #0Campo  = aAlfa1;
     #0nCampo = aAlfa2;

     |PINTA #0Campo;
     |PINTA #0nCampo;

     |HAZ FinTabla;
|FPRC;

|PROCESO FueraLocal;
     |C_M #0#7, 1, "S";
     |SI #0#6 ! "S";
         |C_M #0#7, 1, "N";  #0#7 = "01.01.0000";  |PINTA #0#7;
     |FINSI;

     |C_M #0#10, 1, "S";
     |C_M #0#11, 1, "S";
     |SI #0#9 ! "S";
         |C_M #0#10, 1, "N";  #0#10 = "01.01.0000";  |PINTA #0#10;
         |C_M #0#11, 1, "N";  #0#11 = "";            |PINTA #0#11;
     |FINSI;
|FPRC;

|PROCESO SacaMuniw56;
     || nCampo = Codigo Municipio
     || nCampo1 = Nombre Municipio
     || nCampo2 = Codigo Provincia
     || nCampo3 = Nombre Provincia

     |SI Campo = 15;
          nCampo1 = 12;
          nCampo2 = 16;
          nCampo3 = 14;
     |FINSI;
     |SI FSalida = 10;
          |SUB_EJECUTA "agimunic";
          |ABRE #100;
          |CONSULTA_CLAVE #1#100;
          |SI FSalida = 0;
               nCampo = Campo;
               #0nCampo = #100#1;     |PINTA #0nCampo;
               #0nCampo1 = #100#3;     |PINTA #0nCampo1;
               #0nCampo2 = (#100#0 % 102);     |PINTA #0nCampo2;
               #0nCampo3 = #100#2;     |PINTA #0nCampo3;
               #0#13 = #0#16;
               |ACABA;
          |FINSI;
          |CIERRA #100;
     |FINSI;
     |ABRE #100;
     |SELECT #5#100;
     #100#1 = #0Campo;
     |LEE 000#100=;
     |SI FSalida = 0;
          |SI #0nCampo ! Contenido;
               nCampo = Campo;
               #0nCampo = #100#1;     |PINTA #0nCampo;
               #0nCampo1 = #100#3;     |PINTA #0nCampo1;
               #0nCampo2 = (#100#0 % 102);     |PINTA #0nCampo2;
               #0nCampo3 = #100#2;     |PINTA #0nCampo3;
               #0#13 = #0#16;
          |FINSI;
     |SINO;
          |SI #0Campo ! "     ";
               nCampo = Campo;
               #0nCampo = "";     |PINTA #0nCampo;
               #0nCampo1 = "";     |PINTA #0nCampo1;
               #0nCampo2 = "";     |PINTA #0nCampo2;
               #0nCampo3 = "";     |PINTA #0nCampo3;
               #0#13 = #0#16;
               |MENAV "    El Código de Municipal no existe. Pulse F2 para ver la lista."
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #100;
|FPRC;
