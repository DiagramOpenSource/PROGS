|FICHEROS;
     ver00001 #0;

     agim0019 #2;

     agim0035   #635;
     agim0135   #636;

     :/sociedad/def/maempr10 #700;
|FIN;

|VARIABLES;
     aCNAE2008    = "";
     aCNAE2009    = "";
     aTipoEpi     = "O";
     aEpigrafe    = "";
     aAlfa        = "";

     nAgrupa      = 0;

     &eaPrograma   = "";
     &eaExtension  = "";
     &eaPathSocie  = "";
     &enErrorVer   = 0;
|FIN;

|PROCESO agim0019;

     |ABRE #635;
     #635#0 = #2#40;
     |LEE 040#635=;
     |SI FSalida = 0;
         |SI #635#2 ! "    ";
             #2#81 = #2#40;
             #2#82 = #2#41;
             #2#40 = #635#2;
             |ABRE #636;
             #636#0 = #2#40;
             |LEE 040#636=;
             |SI FSalida ! 0; |DDEFECTO #636; |FINSI;
             #2#41 = #636#1;
             |CIERRA #636;
        |FINSI;
     |FINSI;
     #635#0 = #2#81;
     |LEE 040#635=;
     |SI FSalida ! 0;  |DDEFECTO #635;  |FINSI;
     |CIERRA #635;

      #2#82 = #635#1;

      |GRABA 020#2a;
      |LIBERA #2;
|FPRC;

|DEFBUCLE agim0019;
     #2#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, agim0019;
|FIN;

|PROCESO maempr10;
     #2#0 = #700#0;
     #2#1 = 99;
     |LEE 040#2];
     |SI FSalida = 0;
         |LEE 040#2a;
     |SINO;
         |LEE 040#2u;
     |FINSI;
     |SI FSalida ! 0;  |O #2#0 ! #700#0;
         |DDEFECTO #2;
     |FINSI;

     #700#17 = #2#40;
     |GRABA 020#700a;
     |LIBERA #700;
|FPRC;

|DEFBUCLE maempr10;
     #700#1;
     ;
     00000, 2008;
     99999, 2999;
     be;
     NULL, maempr10;
|FIN;

|PROCESO Tipo12;  |TIPO 12;
     |SI #0#1 ! "SI";  |ACABA;  |FINSI;

     |ABRE #636;
     |LEE 000#636p;
     |SI FSalida ! 0;
         |CIERRA #636;
         |DELINDEX #636;
         |SUB_EJECUTA_NP "instalar;agim0135";
         |SUB_EJECUTA_NP "instalar;agim0035";
     |FINSI;
     |CIERRA #636;

     #0#0 = 1;
     |GRABA 020#0a;

     |BUCLE agim0019;

     |HAZ BusquedaApli;
     |SI eaPathSocie ! "";
         aAlfa = eaPathSocie + "fich/";
         |PATH_DAT #700 aAlfa;
         |ABRE #2;
         |BUCLE maempr10;
         |CIERRA #2;
     |FINSI;
|FPRC;

|PROGRAMA;
     enErrorVer = 0;

     |ABRE #0
     |LEE 000#0p;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
     |CIERRA #0

     |SI #0#0 = 1;  |ACABA;  |FINSI;

     |MENAV "0000 No se ha realizado el proceso del cambio de CNAE para el 2009";
     |CONFI "0000SQuiere hacerlo en estos momentos";
     |SI FSalida ! 0;
         |MENAV "0000 No puede proseguir hasta que no realice el proceso";
         enErrorVer = 1;
         |ACABA;
     |FINSI;

     |CABEZA "Regeneracion CNAE 2009";

     |ABRE #0
     |LEE 101#0p;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = 0;
         |GRABA 020#0b;
     |FINSI;

     |PINPA #0#0;

     #0#1 = "NO";
     |PINDA #0#0;

     |ENDATOS #1#0;
     |SI FSalida ! 0;  |O #0#1 ! "SI";
         #0#0       = 0;
         enErrorVer = 1;

         |GRABA 020#0a;
     |FINSI;

     |LIBERA #0;
     |CIERRA #0;
|FPRO;
