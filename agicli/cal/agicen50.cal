|FICHEROS;
     agicen50 #0;
|FIN;

|VARIABLES;
     nCampo     = 0;
     aAlfa      = "";
     aAlfa1     = "";
     aAlfa2     = "";


     &eaVarDni  = "";
     &enCalcCif = 0;

     &eaTabla    = "";
     &eaDestino  = "";
     &eaAlfa     = "";
     &enError    = 0;
     &enComp     = 0;
     &enPosicion = 0;
     fFecha      = @;
     nNume1      = 0;
     nNume2      = 0;
     nNume3      = 0;
|FIN;

|PROCESO Fecha50;
     |SI Campo = 2; |O Campo = 3; |O Campo = 79; |O Campo = 80;
          nCampo = Campo + 2;
     |FINSI;
     |SI Campo = 50; |O Campo = 51;
          nCampo = Campo + 21;
     |FINSI;
     |SI Campo = 53; |O Campo = 54; |O Campo = 55; |O Campo = 56;
          nCampo = Campo + 20;
     |FINSI;
     |SI Campo = 63; |O Campo = 64; |O Campo = 65;
          nCampo = Campo + 3;
     |FINSI;
     |SI Campo = 85;
          nCampo = Campo + 1;
     |FINSI;

     |C_M #0nCampo, 1, "S";
     |SI #0Campo = " ";
          |C_M #0nCampo, 1, "N";
          #0nCampo = "01.01.0000";
          |PINTA #0nCampo;
     |SINO;
          |SI Campo = 53; |O Campo = 54; |O Campo = 55; |O Campo = 85;
              |SI #0nCampo = "01.01.0000";
                  #0nCampo = fFecha;
                  |PINTA #0nCampo;
              |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Excencio50;
     fFecha = "01.01.0000";
     |SI #0#73 > "01.01.0000"; fFecha = #0#73; |FINSI;
     |SI #0#74 > "01.01.0000"; fFecha = #0#74; |FINSI;
     |SI #0#75 > "01.01.0000"; fFecha = #0#75; |FINSI;
     |SI #0#86 > "01.01.0000"; fFecha = #0#86; |FINSI;

     |SI #0Campo = "S";
         |SI Campo = 53; nNume1 = 54; nNume2 = 55; nNume3 = 85; |FINSI;
         |SI Campo = 54; nNume1 = 53; nNume2 = 55; nNume3 = 85; |FINSI;
         |SI Campo = 55; nNume1 = 53; nNume2 = 54; nNume3 = 85; |FINSI;
         |SI Campo = 85; nNume1 = 53; nNume2 = 54; nNume3 = 55; |FINSI;
         #0nNume1 = "";           |PINTA #0nNume1; nNume1 = nNume1 + 20;
         #0nNume1 = "01.01.0000"; |PINTA #0nNume1;
         #0nNume2 = "";           |PINTA #0nNume2; nNume2 = nNume2 + 20;
         #0nNume2 = "01.01.0000"; |PINTA #0nNume2;
         #0nNume3 = "";           |PINTA #0nNume3;
         nNume3 = nNume3 + 1; |SI Campo = 85; nNume3 = nNume3 + 19; |FINSI;
         #0nNume3 = "01.01.0000"; |PINTA #0nNume3;
     |FINSI;

     |HAZ Fecha50;
|FPRC;


|PROCESO Fecha50_1; |TIPO 7;
     nCampo = 40;
     |CAMPO_MODIFICA #0nCampo, 1, "S";
     |SI #0#6 = " "; |Y #0#7 = " "; |Y #0#8 = " "; |Y #0#9 = " "; |Y #0#39 = " ";
          |CAMPO_MODIFICA #0nCampo, 1, "N";
          #0nCampo = "01.01.0000";
          |PINTA #0nCampo;
     |FINSI;
|FPRC;

|PROCESO Fecha50_2; |TIPO 7;
     nCampo = 42;
     |CAMPO_MODIFICA #0nCampo, 1, "S";
     |SI #0#10 = " "; |Y #0#41 = " ";
          |CAMPO_MODIFICA #0nCampo, 1, "N";
          #0nCampo = "01.01.0000";
          |PINTA #0nCampo;
     |FINSI;
|FPRC;

|PROCESO Fecha50_3; |TIPO 7;
     nCampo = 78;
     |CAMPO_MODIFICA #0nCampo, 1, "S";
     |SI #0#11 = " "; |Y #0#12 = " "; |Y #0#13 = " "; |Y #0#14 = " "; |Y #0#43 = " ";
          |CAMPO_MODIFICA #0nCampo, 1, "N";
          #0nCampo = "01.01.0000";
          |PINTA #0nCampo;
     |FINSI;
|FPRC;

|PROCESO Desactiva50;
     |PARA nCampo = 63; |SI nCampo [ 68; |HACIENDO nCampo = nCampo + 1;
          |CAMPO_MODIFICA #0nCampo, 1, "S";
     |SIGUE;
     |SI #0#62 = " ";
          |PARA nCampo = 63; |SI nCampo [ 68; |HACIENDO nCampo = nCampo + 1;
               |CAMPO_MODIFICA #0nCampo, 1, "N";
          |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Tipo12w58;  |TIPO 12;
     || Para que no pregunte el correcto si o no
|FPRC;

|PROCESO LetraDniw0058;  |TIPO 6;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     eaVarDni  = #0Campo;
     enCalcCif = 1;
     |HAZ CalculoDNI;
     #0Campo = eaVarDni;
     |PINTA #0Campo;
|FPRC;

|PROCESO SacaGrupow58;  |TIPO 7;
     eaTabla = "txtm0009.txt";
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompruebaGrupow58;  |TIPO 0;
     |SI FSalida = 10;
         enPosicion = 55;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 101;
         #0Campo  = aAlfa1;
         |PINTA #0Campo;
     |FINSI;

     enComp = 1;
     eaAlfa = #0Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 101;
     #0Campo  = aAlfa1;

     |PINTA #0Campo;

     |HAZ FinTabla;
|FPRC;

|PROCESO SacaEpiw58;  |TIPO 7;
     nCampo = Campo - 1;
     |SI #0nCampo = " ";  |ACABA;                    |FINSI;
     |SI #0nCampo = "1";  eaTabla = "txtm0011.txt";  |FINSI;
     |SI #0nCampo = "2";  eaTabla = "txtm0012.txt";  |FINSI;
     |SI #0nCampo = "3";  eaTabla = "txtm0013.txt";  |FINSI;

     |HAZ CargaTabla;
|FPRC;

|PROCESO CompruebaEpiw58;  |TIPO 0;
     nCampo = Campo - 1;

     |SI #0nCampo  = " ";
         #0Campo   = "";
         |PINTA #0Campo;
         |ACABA;
     |FINSI;

     |SI FSalida = 10;
         enPosicion = 20;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 104;
         #0Campo  = aAlfa1;
         |PINTA #0Campo;
     |FINSI;

     enComp = 4;
     eaAlfa = #0Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 104;
     #0Campo  = aAlfa1;

     |PINTA #0Campo;

     |HAZ FinTabla;
|FPRC;

|PROCESO SacaTipow58;  |TIPO 7;
     eaTabla = "txtm0010.txt";
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompruebaTipow58;  |TIPO 0;
     |SI FSalida = 10;
         enPosicion = 55;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 103;
         #0Campo  = aAlfa1;
         |PINTA #0Campo;
     |FINSI;

     enComp = 3;
     eaAlfa = #0Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 103;
     #0Campo  = aAlfa1;

     |PINTA #0Campo;

     |HAZ FinTabla;
|FPRC;

|PROCESO Modifica601;
     |C_M #0#4, 1, "S";
     |C_M #0#5, 1, "S";
     |SI #0#2 ! "A";
         |C_M #0#4, 1, "N";  #0#2 = "";  |PINTA #0#4;
     |FINSI;
     |SI #0#3 ! "A";
         |C_M #0#5, 1, "N";  #0#3 = "";  |PINTA #0#5;
     |FINSI;
|FPRC;

|PROCESO Modifica605;  |TIPO 7;
     |C_M #0#13, 1, "S";
     |C_M #0#14, 1, "S";
     |C_M #0#15, 1, "S";
     |C_M #0#16, 1, "S";
     |C_M #0#17, 1, "S";
     |C_M #0#18, 1, "S";
     |C_M #0#19, 1, "S";
     |C_M #0#20, 1, "S";
     |C_M #0#21, 1, "S";
     |C_M #0#22, 1, "S";
     |C_M #0#23, 1, "S";
     |C_M #0#24, 1, "S";

     |SI #0#5 ! "A";  |Y #0#7 ! "A";
         |C_M #0#13, 1, "N";  #0#13 = "";  |PINTA #0#13;
         |C_M #0#14, 1, "N";  #0#14 = "";  |PINTA #0#14;
         |C_M #0#15, 1, "N";  #0#15 = "";  |PINTA #0#15;
         |C_M #0#16, 1, "N";  #0#16 = "";  |PINTA #0#16;
         |C_M #0#17, 1, "N";  #0#17 = "";  |PINTA #0#17;
         |C_M #0#18, 1, "N";  #0#18 = "";  |PINTA #0#18;
         |C_M #0#19, 1, "N";  #0#19 = "";  |PINTA #0#19;
         |C_M #0#20, 1, "N";  #0#20 = "";  |PINTA #0#20;
         |C_M #0#21, 1, "N";  #0#21 = "";  |PINTA #0#21;
         |C_M #0#22, 1, "N";  #0#22 = "";  |PINTA #0#22;
         |C_M #0#23, 1, "N";  #0#23 = "";  |PINTA #0#23;
         |C_M #0#24, 1, "N";  #0#24 = "";  |PINTA #0#24;
     |FINSI;
|FPRC;

|PROCESO Modifica610;  |TIPO 7;
     |C_M #0#25, 1, "S";
     |C_M #0#26, 1, "S";
     |C_M #0#27, 1, "S";
     |C_M #0#28, 1, "S";
     |C_M #0#29, 1, "S";
     |C_M #0#30, 1, "S";
     |C_M #0#31, 1, "S";
     |C_M #0#32, 1, "S";
     |C_M #0#33, 1, "S";
     |C_M #0#34, 1, "S";
     |C_M #0#35, 1, "S";
     |C_M #0#36, 1, "S";

     |SI #0#10 ! "S";
         |C_M #0#25, 1, "N";  #0#25 = "";  |PINTA #0#25;
         |C_M #0#26, 1, "N";  #0#26 = "";  |PINTA #0#26;
         |C_M #0#27, 1, "N";  #0#27 = "";  |PINTA #0#27;
         |C_M #0#28, 1, "N";  #0#28 = "";  |PINTA #0#28;
         |C_M #0#29, 1, "N";  #0#29 = "";  |PINTA #0#29;
         |C_M #0#30, 1, "N";  #0#30 = "";  |PINTA #0#30;
         |C_M #0#31, 1, "N";  #0#31 = "";  |PINTA #0#31;
         |C_M #0#32, 1, "N";  #0#32 = "";  |PINTA #0#32;
         |C_M #0#33, 1, "N";  #0#33 = "";  |PINTA #0#33;
         |C_M #0#34, 1, "N";  #0#34 = "";  |PINTA #0#34;
         |C_M #0#35, 1, "N";  #0#35 = "";  |PINTA #0#35;
         |C_M #0#36, 1, "N";  #0#36 = "";  |PINTA #0#36;
     |FINSI;
|FPRC;

|PROCESO Modifica622;
     |C_M #0#41, 1, "S";
     |C_M #0#42, 1, "S";
     |C_M #0#43, 1, "S";
     |SI #0#40 ! "S";
         |C_M #0#41, 1, "N";  #0#41 = "";  |PINTA #0#41;
         |C_M #0#42, 1, "N";  #0#42 = "";  |PINTA #0#42;
         |C_M #0#43, 1, "N";  #0#43 = "";  |PINTA #0#43;
     |FINSI;
|FPRC;

|PROCESO Modifica634;
     |C_M #0#51, 1, "S";
     |SI #0#50 ! "S";
         |C_M #0#51, 1, "N";  #0#51 = "01.01.0000";  |PINTA #0#51;
     |FINSI;
|FPRC;

|PROCESO Campo83;
     aAlfa1 = "";
     |PARA nCampo = 15; |SI nCampo [ 26; |HACIENDO nCampo = nCampo + 1;
          aAlfa = #0nCampo;
          |QBF aAlfa;
          |SI aAlfa ! "";
               aAlfa1 = aAlfa1 + aAlfa;
               |SI nCampo = 17; |O nCampo = 20; |O nCampo = 23;
                    aAlfa1 = aAlfa1 + "/";
               |SINO;
                    aAlfa1 = aAlfa1 + " ";
               |FINSI;
          |FINSI;
     |SIGUE;
     #0#83 = aAlfa1;
|FPRC;

|PROCESO Campo84;
     aAlfa1 = "";
     |PARA nCampo = 27; |SI nCampo [ 38; |HACIENDO nCampo = nCampo + 1;
          aAlfa = #0nCampo;
          |QBF aAlfa;
          |SI aAlfa ! "";
               aAlfa1 = aAlfa1 + aAlfa;
               |SI nCampo = 29; |O nCampo = 32; |O nCampo = 35;
                    aAlfa1 = aAlfa1 + "/";
               |SINO;
                    aAlfa1 = aAlfa1 + " ";
               |FINSI;
          |FINSI;
     |SIGUE;
     #0#84 = aAlfa1;
|FPRC;
