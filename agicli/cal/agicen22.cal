|FICHEROS;
     agim0004 #4;
     agicen22 #22;
     agiw0054 #954,MANTE;
     agiw0055 #955,MANTE;
     agiw0057 #957,MANTE;
     agiw0058 #958,MANTE;
     agiw0059 #959,MANTE;
|FIN;

|VARIABLES;
     nCampoD     = 0;
     nCampoH     = 0;

     &enEmpresa  = 0;
     &enRegistro = 0;
     &eaTipo     = "";
     &enOpcion   = 0;
|FIN;

|PROCESO Punto2;
     |DDEFECTO #954;

     |PARA nCampoD = 0;  |SI nCampoD [ 24;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 2;
           #954nCampoD = #22nCampoH;
     |SIGUE;

     |PINPA #0#954;
     |PINDA #0#954;
     |ENDATOS #1#954;
     |SI FSalida = 0;
         |PARA nCampoD = 0;  |SI nCampoD [ 24;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH = nCampoD + 2;
               #22nCampoH = #954nCampoD;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Punto3;
     |DDEFECTO #955;

     |PARA nCampoD = 0;  |SI nCampoD [ 39;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 27;
           #955nCampoD = #22nCampoH;
     |SIGUE;

     |PINPA #0#955;
     |PINDA #0#955;
     |ENDATOS #1#955;
     |SI FSalida = 0;
         |PARA nCampoD = 0;  |SI nCampoD [ 39;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH = nCampoD + 27;
               #22nCampoH = #955nCampoD;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Punto5;
     |DDEFECTO #957;

     |PARA nCampoD = 0;  |SI nCampoD [ 87;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 67;
           #957nCampoD = #22nCampoH;
     |SIGUE;

     |PINPA #0#957;
     |PINDA #0#957;
     |ENDATOS #1#957;
     |SI FSalida = 0;
         |PARA nCampoD = 0;  |SI nCampoD [ 87;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH = nCampoD + 67;
               #22nCampoH = #957nCampoD;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Punto6;
     |DDEFECTO #958;

     |PARA nCampoD = 0;  |SI nCampoD [ 52;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 155;
           #958nCampoD = #22nCampoH;
     |SIGUE;

     |PINPA #0#958;
     |PINDA #0#958;
     |ENDATOS #1#958;
     |SI FSalida = 0;
         |PARA nCampoD = 0;  |SI nCampoD [ 52;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH = nCampoD + 155;
               #22nCampoH = #958nCampoD;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Punto7;
     |DDEFECTO #959;

     |PARA nCampoD = 0;  |SI nCampoD [ 10;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 208;
           #959nCampoD = #22nCampoH;
     |SIGUE;

     |PINPA #0#959;
     |PINDA #0#959;
     |ENDATOS #1#959;
     |SI FSalida = 0;
         |PARA nCampoD = 0;  |SI nCampoD [ 10;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH = nCampoD + 208;
               #22nCampoH = #959nCampoD;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO agim0004;
     #22#27 = #4#2;    || NIF
     #22#28 = #4#3;    || Apellidos y Nombre
     #22#31 = #4#6;    || Domicilio
     #22#32 = #4#7;    || Numero
     #22#36 = #4#12;   || Telefono
     #22#37 = #4#8;    || Codigo Postal 1
     #22#38 = #4#9;    || Codigo Postal 2
     #22#39 = #4#10;   || Municipio
     #22#40 = #4#11;   || Provincia

     |ERROR10;
|FPRC;

|DEFBUCLE agim0004;
     #4#1;
     ;
     #22#0, 01;
     #22#0, 99;
     ;
     NULL, agim0004;
|FIN;

|PROGRAMA;
     |ABRE #22;
     #22#0 = enEmpresa;
     #22#1 = enRegistro;
     |LEE 101#22=;
     |SI FSalida ! 0;
         |DDEFECTO #22;
         #22#0 = enEmpresa;
         #22#1 = enRegistro;

         |BUCLE agim0004;

         |GRABA 020#22b;
     |FINSI;

     |SI enOpcion = 2;  |HAZ Punto2;  |FINSI;
     |SI enOpcion = 3;  |HAZ Punto3;  |FINSI;
     |SI enOpcion = 5;  |HAZ Punto5;  |FINSI;
     |SI enOpcion = 6;  |HAZ Punto6;  |FINSI;
     |SI enOpcion = 7;  |HAZ Punto7;  |FINSI;

     |GRABA 020#22a;
     |LIBERA #22;
     |CIERRA #22;
|FPRO;
