|FICHEROS;
    agim0026 #0;
|FIN;

|VARIABLES;
     &Cliente  = 0;
     &Registro = 0;
     &Modo     = 0;

     aNifQbf1   = "";
     aNifQbf2   = "";

     &eaVarDni  = "";
     &enCalcCif = 0;
|FIN;

|PROCESO LetrasDni26;  |TIPO 6;
     |SI FSalida = 9;
         eaVarDni   = #0Campo;
         enCalcCif  = 1;
         |HAZ CalculoDNI;
         #0Campo = eaVarDni;
         |PINTA #0Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #0Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;

     aNifQbf1 = #0Campo;   |QBF aNifQbf1;
     aNifQbf2 = eaVarDni;  |QBF aNifQbf2;

     |SI aNifQbf1 ! aNifQbf2; |Y aNifQbf1 ! "";
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #0Campo = eaVarDni;  |PINTA #0Campo;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|RUTINA ClaveBaja0;
  #0#0 = Cliente;
  #0#1 = Registro;
  #0#2 = 1;
|FRUT;

|RUTINA ClaveAlta0;
  #0#0 = Cliente;
  #0#1 = Registro;
  #0#2 = 99;
|FRUT;

|PROGRAMA;
  |SI Modo ! 4;
      |ENTLINEAL #1#0, -3, 2, 22, 1, ClaveBaja0, ClaveAlta0;
  |SINO;
      |ENTLINEAL #1#0, -3, 4, 22, 1, ClaveBaja0, ClaveAlta0;
  |FINSI;
|FPRO;

|PROCESO Mayus;
  #0Campo = #0Campo > #0Campo;  |PINTA #0Campo;
|FPRC;
