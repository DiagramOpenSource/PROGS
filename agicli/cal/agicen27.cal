|FICHEROS;
     agicen27 #27;
     agicen05 #5;
     agiw0062 #962,MANTE;
     agiw0063 #963,MANTE;
     agiw0064 #964,MANTE;
     agiw0065 #965,MANTE;
     agiw0066 #966,MANTE;
|FIN;

|VARIABLES;
     nCampoD     = 0;
     nCampoH     = 0;

     &enEmpresa   = 0;
     &enActividad = 0;
     &enRegistro  = 0;
     &enOpcion    = 0;
|FIN;

|PROCESO Punto1;
     |DDEFECTO #962;

     |PARA nCampoD = 0;  |SI nCampoD [ 9;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH     = nCampoD + 3;
           #962nCampoD = #27nCampoH;
     |SIGUE;

     #962#10 = #27#149;

     |PINPA #0#962;
     |PINDA #0#962;
     |ENDATOS #1#962;
     |SI FSalida = 0;
         |PARA nCampoD = 0;  |SI nCampoD [ 9;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH    = nCampoD + 3;
               #27nCampoH = #962nCampoD;
         |SIGUE;
         #27#149 = #962#10;
     |FINSI;
|FPRC;

|PROCESO Punto2;
     |DDEFECTO #963;

     |PARA nCampoD = 0;  |SI nCampoD [ 13;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH     = nCampoD + 13;
           #963nCampoD = #27nCampoH;
     |SIGUE;

     |PINPA #0#963;
     |PINDA #0#963;
     |ENDATOS #1#963;
     |SI FSalida = 0;
         |PARA nCampoD = 0;  |SI nCampoD [ 13;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH    = nCampoD + 13;
               #27nCampoH = #963nCampoD;
         |SIGUE;

         |ABRE #5;
         #5#0 = #27#0;
         #5#1 = #27#1;
         |LEE 101#5=;
         |SI FSalida ! 0;
             |DDEFECTO #5;
             #5#0 = #27#0;
             #5#1 = #27#1;
             |GRABA 020#5b;
         |FINSI;

         #5#4  = #27#13;
         #5#5  = #27#14;
         #5#8  = #27#15;
         #5#9  = #27#16;
         #5#10 = #27#17;
         #5#11 = #27#19;
         #5#12 = #27#20;
         #5#13 = #27#21;
         #5#14 = #27#22;
         #5#15 = #27#23;
         #5#16 = #27#24;
         #5#17 = #27#25;
         #5#18 = #27#26;

         |GRABA 020#5a;
         |LIBERA #5;
         |CIERRA #5;
     |FINSI;
|FPRC;

|PROCESO Punto3;
     |DDEFECTO #964;

     |PARA nCampoD = 0;  |SI nCampoD [ 33;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH     = nCampoD + 27;
           #964nCampoD = #27nCampoH;
     |SIGUE;

     #964#34 = #27#150;
     #964#35 = #27#151;

     |PINPA #0#964;
     |PINDA #0#964;
     |ENDATOS #1#964;
     |SI FSalida = 0;
         |PARA nCampoD = 0;  |SI nCampoD [ 33;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH    = nCampoD + 27;
               #27nCampoH = #964nCampoD;
         |SIGUE;

         #27#150 = #964#34;
         #27#151 = #964#35;
     |FINSI;
|FPRC;

|PROCESO Punto4;
     |DDEFECTO #965;

     |PARA nCampoD = 0;  |SI nCampoD [ 14;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH     = nCampoD + 61;
           #965nCampoD = #27nCampoH;
     |SIGUE;

     |PINPA #0#965;
     |PINDA #0#965;
     |ENDATOS #1#965;
     |SI FSalida = 0;
         |PARA nCampoD = 0;  |SI nCampoD [ 14;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH    = nCampoD + 61;
               #27nCampoH = #965nCampoD;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Punto5;
     |DDEFECTO #966;

     |PARA nCampoD = 0;  |SI nCampoD [ 68;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH     = nCampoD + 76;
           #966nCampoD = #27nCampoH;
     |SIGUE;

     |PINPA #0#966;
     |PINDA #0#966;
     |ENDATOS #1#966;
     |SI FSalida = 0;
         |PARA nCampoD = 0;  |SI nCampoD [ 68;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH    = nCampoD + 76;
               #27nCampoH = #966nCampoD;
         |SIGUE;
     |FINSI;
|FPRC;

|PROGRAMA;
     |ABRE #27;
     #27#0 = enEmpresa;
     #27#1 = enActividad;
     #27#2 = enRegistro;
     |LEE 101#27=;
     |SI FSalida ! 0;
         |DDEFECTO #27;
         #27#0 = enEmpresa;
         #27#1 = enActividad;
         #27#2 = enRegistro;

         |ABRE #5;
         #5#0 = #27#0;
         #5#1 = #27#1;
         |LEE 040#5=;
         |SI FSalida ! 0;  |DDEFECTO #5;  |FINSI;
         |CIERRA #5;

         #27#13 = #5#4;
         #27#14 = #5#5;
         #27#15 = #5#8;
         #27#16 = #5#9;
         #27#17 = #5#10;
         #27#19 = #5#11;
         #27#20 = #5#12;
         #27#21 = #5#13;
         #27#22 = #5#14;
         #27#23 = #5#15;
         #27#24 = #5#16;
         #27#25 = #5#17;
         #27#26 = #5#18;

         |GRABA 020#27b;
     |FINSI;

     |SI enOpcion = 1;      |HAZ Punto1;  |FINSI;
     |SI enOpcion = 2;      |HAZ Punto2;  |FINSI;
     |SI enOpcion = 3;      |HAZ Punto3;  |FINSI;
     |SI enOpcion = 4;      |HAZ Punto4;  |FINSI;
     |SI enOpcion = 5;      |HAZ Punto5;  |FINSI;

     |GRABA 020#27a;
     |LIBERA #27;

     |CIERRA #27;
|FPRO;
