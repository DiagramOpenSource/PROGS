|FICHEROS;
     agiy0008 #0;  || Este
     agifigen #1;  || Clientes
     agim0001 #2;  || Contratos
     agim0004 #3;  || Representantes
     agicen00 #4;  || Actividades (C)
     agicen01 #5;  || Actividades (L)
|FIN;

|VARIABLES;
     i       = 0;
     SwPrint = 0;
     &NomCli = "";
     &fichero= 0;
     &ob1    = "";
     &ob2    = "";
     &ob3    = "";
     &ob4    = "";
     &ob5    = "";
     &ob6    = "";
     &ob7    = "";
     &ob8    = "";
     &ob9    = "";
     &ob10   = "";
     &ob11   = "";
     &ob12   = "";
     &ob13   = "";
     &ob14   = "";
     &ob15   = "";
     &ob16   = "";
|FIN;

|INCLUYE i_consul;

-----------------------------------------------------------
|PROCESO ActLin;
     SwPrint = 1;
     |PRINT;
|FPRC;

|PROCESO Actividades;
     |BUCLELIN 0ActLin#4;
|FPRC;

|DEFBUCLE BActividades;
     #4#1;
     ;
     #1#0;
     #1#0;
     ;
     NULL, Actividades;
|FIN;

|PROCESO Representantes;
     SwPrint = 1;
     |PRINT;
|FPRC;

|DEFBUCLE BRepresentantes;
     #3#1;
     ;
     #1#0, 01;
     #1#0, 99;
     ;
     NULL, Representantes;
|FIN;

|PROCESO Contratos;
     SwPrint = 1;
     |PRINT;
|FPRC;

|DEFBUCLE BContratos;
     #2#1;
     ;
     #1#0, 01;
     #1#0, 99;
     ;
     NULL, Contratos;
|FIN;
---------------------------------------------

|PROCESO Cliente;
     |SALVA_DATOS #1;
     #1#0 = #1#90;
     |LEE 040#1=;
     |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
     NomCli = #1#1;
     |REPON_DATOS #1;
     |LIBERA #1;
     |LEE 140#1=;

     SwPrint = 0;
     fichero = 1;
     |BUCLE  BActividades;
     fichero = 2;
     |BUCLE  BRepresentantes;
     fichero = 3;
     |BUCLE  BContratos;
     |SI SwPrint = 1;
          ob1 = #1#24; |QBF ob1;
          ob2 = #1#25; |QBF ob2;
          ob3 = #1#26; |QBF ob3;
          ob4 = #1#27; |QBF ob4;
          ob5 = #1#28; |QBF ob5;
          ob6 = #1#29; |QBF ob6;
          ob7 = #1#30; |QBF ob7;
          ob8 = #1#31; |QBF ob8;
          ob9 = #1#32; |QBF ob9;
          ob10= #1#33; |QBF ob10;
          ob11= #1#34; |QBF ob11;
          ob12= #1#35; |QBF ob12;
          ob13= #1#36; |QBF ob13;
          ob14= #1#37; |QBF ob14;
          ob15= #1#38; |QBF ob15;
          ob16= #1#39; |QBF ob16;
          |PIEINF;
      |FINSI;
|FPRC;

|DEFBUCLE BCliente;
     #1#1;
     ;
     #0#1;
     #0#2;
     ;
     NULL, Cliente;
|FIN;

|PROCESO imprime; |TIPO 3;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "agiy0008";
          |SI FSalida = 0;
               |SI #0#0 = "S";
                    |BUCLE BCliente;
               |SINO;
                    |PARA i = 3; |SI i [ 22; |HACIENDO i = i + 1;
                         |SI #0i > 0;
                              #0#1 = #0i;
                              #0#2 =  #0i;
                              |BUCLE BCliente;
                         |FINSI;
                    |SIGUE;
               |FINSI;
               |FININF;
           |FINSI;
           |FINIMP;
     |FINSI;
|FPRC;
----------------------------------------------------------
|PROCESO selec; |TIPO 0;
     #0Campo = #0Campo > #0Campo;
     |PINTA #0Campo;
     |SI #0Campo = "S";
          |PARA i = 3; |SI i [ 22; |HACIENDO i = i + 1;
               |CAMPO_MODIFICA #0i,1,"N";
          |SIGUE;
          |PARA i = 1; |SI i [ 2; |HACIENDO i = i + 1;
               |CAMPO_MODIFICA #0i,1,"S";
          |SIGUE;
     |SINO;
          |PARA i = 1; |SI i [ 2; |HACIENDO i = i + 1;
               |CAMPO_MODIFICA #0i,1,"N";
          |SIGUE;
          |PARA i = 3; |SI i [ 22; |HACIENDO i = i + 1;
               |CAMPO_MODIFICA #0i,1,"S";
          |SIGUE;
     |FINSI;
|FPRC;
