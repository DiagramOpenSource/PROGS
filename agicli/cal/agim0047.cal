|FICHEROS;
  agim0047 #0;
  agim0056 #1;
|FIN;

|VARIABLES;
  nInkey       = 0;
  aCodigo      = "";
  nNumero      = 0;
  aDProvincia  = "";
  aHProvincia  = "";
  aAlfa1       = "";
|FIN;

|PROCESO Tipo8m0047; |TIPO 8;
   |HAZ eVerRegMer;
|FPRC;

|PROCESO Buscame;
  nNumero = nNumero + 1;
  |SI nNumero = 1;
      aCodigo = #1#0;
  |FINSI;
|FPRC;

|DEFBUCLE Buscame;
  #1#2;
  ;
  aDProvincia;
  aHProvincia;
  ;
  NULL, Buscame;
|FIN;

|PROCESO Baja56;
  #1#0 = "     ";
  #1#3 = aDProvincia;
|FPRC;

|PROCESO Alta56;
  #1#0 = "zzzzz";
  #1#3 = aHProvincia;
|FPRC;

|PROCESO Buscam056;
  nInkey = FSalida;

  |SI nInkey = 10;

      aDProvincia = "";
      aHProvincia = "";

      aAlfa1 = #0#4; |QBF aAlfa1;
      |SI aAlfa1 = "";
          aAlfa1 = #0#1; |QBF aAlfa1;
          |SI aAlfa1 ! "";  aDProvincia = aAlfa1; |FINSI;
      |SINO;
          aDProvincia = aAlfa1;
          aHProvincia = aAlfa1;
      |FINSI;
      aDProvincia = (aDProvincia + (" " * 25)) % 125;
      aHProvincia = (aHProvincia + ("z" * 25)) % 125;

      nNumero = 0;
      aCodigo = "";
      |BUCLE Buscame;
      |SI nNumero = 0;
          |MENAV "    No existe Registro Mercantil de la Provincia";
      |SINO;
          |SI nNumero > 1;
             |ABRE #1;
             #1#3 = #0#4;
             |CONSULTA_F_CLAVE #2#1, Baja56, Alta56;
             |SI FSalida = 0;
                 aCodigo = #1#0;
             |FINSI;
             |CIERRA #1;
         |FINSI;
      |FINSI;
      |SI aCodigo ! "";
         #0#5 = aCodigo; |PINTA #0#5;
         |HAZ Encuentro056;
      |FINSI;
  |FINSI;
|FPRC;

|PROCESO Encuentro056; |TIPO 0;
  aCodigo = #0#5; |QBF aCodigo;

  |SI aCodigo ! "";
      |ABRE #1;
      #1#0 = #0#5;
      |LEE 001#1=;
      |SI FSalida = 0;
          #0#1 = #1#1; |PINTA #0#1;
          #0#4 = #1#3; |PINTA #0#4;
      |SINO;
          |CONFI "    NError. El Numero de Registro Mercantil no valido. Continuar";
          |SI FSalida ! 0;
              |ERROR;
          |FINSI;
      |FINSI;
      |CIERRA #1;
  |FINSI;
|FPRC;
