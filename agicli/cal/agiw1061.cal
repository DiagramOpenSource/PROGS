|FICHEROS;
     agiw0061 #0,MANTE;
     agifigen #1;
     agicen20 #20;
     agicen21 #21;
     agicen22 #22;
     agicen23 #23;
     agicen24 #24;
     agicen25 #25;

     agiw0100 #100;
     agiw0101 #101;
     agiw0102 #102;
     agiw0103 #103;
     agiw0104 #104;
     agiw0105 #105;
     agiw0106 #106;
     agiw0107 #107;
     agiw0108 #108;
     agiw0109 #109;
     agiw0110 #110;
|FIN;

|VARIABLES;
     nCampo       = 0;
     nHandle      = 0;
     nConta       = 0;
     nAscii       = 0;
     nLongitud    = 0;
     nPos         = 0;
     nBusca       = 0;
     nCasilla     = 0;
     nEspa        = 0;
     nLong        = 0;
     nNume        = 0;
     nNumero      = 0;
     nCas         = 0;
     nResto       = 0;
     nHay         = 0;
     nAcum        = 0;
     nSwPunto     = 0;
     nCaracter    = 0;
     nCampoD      = 0;
     nCampoH      = 0;
     nObliga      = 0;
     nPorDonde    = 0;
     nSocio       = 0;
     nBytes       = 0;
     nPon         = 0;

     aAlfa        = "";
     aAlfa0       = "";
     aAlfa1       = "";
     aAlfa2       = "";
     aAbre        = "";
     aFichero     = "";
     aOrigen      = "";
     aDestino     = "";
     aBasePdf     = "";
     aIP          = "";
     aLinea       = "";
     aCaracter    = "";
     aCaracterSal = "";
     aCadenaSal   = "";
     aCadena      = "";
     aLongitud    = "";
     aCampo       = "";
     aValor       = "";
     aSigla       = "";
     aArchivoPdf  = "";
     aArchivoTxt  = "";
     aLong        = "";
     aSi          = "Sí";
     aTipo        = "";
     aRuta        = "";
     aMiCaracter  = "";
     aPathReader  = "";
     aEjecutable  = "";
     aFicheroBAT  = "";
     aUnidad      = "";
     aWait        = "";
     aPath        = "";

     {1}aVersion  = "";

     &eaVarDni  = "";
     &enCalcCif = 0;

     &eaTabla    = "";
     &eaDestino  = "";
     &eaAlfa     = "";
     &enError    = 0;
     &enComp     = 0;
     &enPosicion = 0;
|FIN;

|| _________________________________________________________________________
|| PROCESOS DE LA PANTALLA
|| _________________________________________________________________________

|PROCESO TipoEmision;
     |C_M #0#6, 1, "S";
     |SI #0#0 = 2;  |C_M #0#6, 1, "N";  |FINSI;
|FPRC;

|PROCESO ExtraePath;
     aPath     = aVersion1;
     aLongitud = aPath % 0;
     nLongitud = aLongitud;
     |PARA nPos = 1; |SI nPos [ nLongitud; |HACIENDO nPos = nPos + 1;
          nCaracter = (nPos * 100) + 1;
          aCaracter = aPath % nCaracter;
          |SI aCaracter = ",";
               nPos = nLongitud - nPos;
               nPos = nPos + 100;
               nPos = (-1) * nPos;
               aPath = aPath % nPos;
               |SAL;
          |FINSI;
     |SIGUE;

     aPath = aPath - "[";
     aPath = aPath - "]";
     |QBF aPath;
     #0#6 = aPath;
     |PINTA #0#6;
|FPRC;

|PROCESO CompruebaRuta;
     |QBF aPath;
     |XABRE "CE", aPath, nHandle;
     |SI aPath = ""; |O FSalida < 0;
          |XCIERRA nHandle;
          aAlfa = "    No se ha encontrado el directorio donde esta instalado ";
          aAlfa = aAlfa + "Adobe Acrobat Reader. ";
          |MENAV aAlfa;

          aAlfa = "    Debera efectuar la instalacion manualmente.";
          |MENAV aAlfa;

          #0#6 = "";
          |PINTA #0#6;
     |FINSI;
|FPRC;

|PROCESO MensajeFallo;
     |CUADRO 1616 2166;
     |ATRI I;
     |PINTA 1717, " No se ha podido localizar  de manera automatica ";
     |PINTA 1817, " la carpeta donde esta instalado Acrobat Reader. ";
     |PINTA 1917, " Compruebe que la aplicacion esta instalada y si ";
     |PINTA 2017, "  es asi, efectue la busqueda de manera manual.  ";
     |ATRI 0;
|FPRC;

|PROCESO SacaBrowse;  |TIPO 7;
     |SI #0#0 = 2;  |ACABA;  |FINSI;

     aAlfa = #0#6;  |QBF aAlfa;
     |SI aAlfa ! "";  |Y nObliga = 0;
         |ACABA;
     |FINSI;

     aVersion1 = "AcroExch.Document";
     |ESPECIFICA "VERSION_PROGRAMA", aVersion;
     |HAZ ExtraePath;
     |SI aPath = "NO LOCALIZADO";
          aVersion1 = "AcroExch.App";
          |ESPECIFICA "VERSION_PROGRAMA", aVersion;
          |HAZ ExtraePath;
     |FINSI;

     |SI aPath ! "NO LOCALIZADO";
          |HAZ CompruebaRuta;
          nObliga = 0;
     |SINO;
          |HAZ MensajeFallo;       || se supone que no esta instalado
          |PAUSA;                  || el Acrobat
          #0#6 = "";
          |PINTA #0#6;
     |FINSI;

     aAlfa = #0#6;  |QBF aAlfa;
     |SI aAlfa ! "";  |Y nObliga = 0;
         |ACABA;
     |FINSI;

     aRuta = "F";
     |BROWSE aRuta;  |QBF aRuta;
     |SI aRuta = "F";
         |ERROR;
         |ACABA;
     |FINSI;

     #0#6 = aRuta % 280;  |PINTA #0#6;
|FPRC;

|PROCESO Browse;  |TIPO 0;
     |SI #0#0 = 2;  |ACABA;  |FINSI;

     nObliga = 1;
     |SI FSalida = 10;  |HAZ SacaBrowse;  |FINSI;

     aAlfa = #0#6;  |QBF aAlfa;
     |SI aAlfa = "";  |HAZ SacaBrowse;  |FINSI;

     nObliga = 0;
|FPRC;

|PROCESO SacaCalidadw61;  |TIPO 7;
     |MENSA "0000 <F2> Ayuda Calidad de";

     eaTabla = "txtm0005.txt";
     |HAZ CargaTabla;
|FPRC;

|PROCESO CompruebaCalidadw61;  |TIPO 0;
     nCampo   = Campo + 1;
     |SI FSalida = 10;
         enPosicion = 55;
         |HAZ SacaTabla;

         aAlfa1   = eaDestino % 101;
         #0Campo  = aAlfa1;
         |PINTA #0Campo;
     |FINSI;

     enComp = 1;
     eaAlfa = #0Campo;
     |HAZ CompruebaTabla;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta la Tabla con F2";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1   = eaDestino % 101;
     aAlfa2   = eaDestino % 415;
     #0Campo  = aAlfa1;
     #0nCampo = aAlfa2;

     |PINTA #0Campo;
     |PINTA #0nCampo;

     |HAZ FinTabla;

     |C_M #0nCampo, 1, "N";
     |SI #0Campo = " ";  |C_M #0nCampo, 1, "S";  |FINSI;
|FPRC;

|| _________________________________________________________________________
|| PROCESOS DE LA EMISION
|| _________________________________________________________________________

|PROCESO Conver3E2D;
     aAlfa     = (nNume + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     aAlfa = (("000" + aAlfa1) % -103) + ((aAlfa2 + "00") % 102);
|FPRC;

|PROCESO QuitaRaros;
     nEspa   = 0;
     aCadena = "";
     aLong   = aAlfa % 0;
     nLong   = aLong;
     |PARA nCampo = 1;  |SI nCampo [ aLong;  |HACIENDO nCampo = nCampo + 1;
           nPos = (100 * nCampo) + 1;
           aCaracter = aAlfa % nPos;
           |SI aCaracter = "¥";  aCaracter = &209; |FINSI;
           |SI aCaracter = "¤";  aCaracter = &209; |FINSI;
           |SI aCaracter = "§";  aCaracter = &176; |FINSI;
           |SI aCaracter = "¦";  aCaracter = &170; |FINSI;
           |SI aCaracter = "(";  aCaracter = " ";  |FINSI;
           |SI aCaracter = ")";  aCaracter = " ";  |FINSI;
           aCadena = aCadena + aCaracter;
     |SIGUE;
     aAlfa = aCadena;
|FPRC;

|PROCESO LeeSigla;
     eaTabla = "txtm0001.txt";
     |HAZ CargaTabla;

     eaAlfa = aSigla;
     enComp = 2;
     |HAZ CompruebaTabla;

     aSigla = eaDestino % 415;

     |HAZ FinTabla;
|FPRC;

|PROCESO CargaTemporal;
     aFichero = ("pd" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #100 aFichero;
     |ABRE #100;  |CIERRA #100;  |DELINDEX #100;

     |ABRE #100;
     |DFICE aAbre;  |QBF aAbre;
     aAbre  = aAbre + "txtm0050.txt";
     nConta = 0;

     |XABRE "AB", aAbre, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |PARA;  |SI;  |HACIENDO;
         |XLEE nHandle, 15, aAlfa;
         |SI  FSalida [ 0;  |SAL;  |FINSI;

         nConta = nConta + 1;

         |DDEFECTO #100;
         #100#0  = nConta;
         #100#1  = aAlfa % 113;
         |GRABA 020#100n;
         |LIBERA #100;
     |SIGUE;

     |XCIERRA nHandle;
     |CIERRA #100;
|FPRC;

|PROCESO Cabecera;
     aLinea = "%FDF-1.2";       |XGRABA nHandle, aLinea;
     aLinea = "%âãÏÓ";          |XGRABA nHandle, aLinea;
     aLinea = "1 0 obj";        |XGRABA nHandle, aLinea;
     aLinea = "<< /FDF ";       |XGRABA nHandle, aLinea;
     aLinea = "<< /Fields [ ";  |XGRABA nHandle, aLinea;
|FPRC;

|PROCESO Cambia;
     nAscii       = &aCaracter;
     aCaracterSal = aCaracter;

     |SI nAscii = 160;  aCaracterSal = "\341";  |FINSI;
     |SI nAscii = 130;  aCaracterSal = "\351";  |FINSI;
     |SI nAscii = 161;  aCaracterSal = "\355";  |FINSI;
     |SI nAscii = 162;  aCaracterSal = "\363";  |FINSI;
     |SI nAscii = 163;  aCaracterSal = "\372";  |FINSI;
     |SI nAscii = 164;  aCaracterSal = "\361";  |FINSI;
|FPRC;

|PROCESO Sustituye;
     aCadenaSal = "";
     aLongitud = aCadena % 0;
     nLongitud = aLongitud;
     |PARA nPos = 1; |SI nPos [ nLongitud; |HACIENDO nPos = nPos + 1;
          nBusca     = (nPos * 100) + 1;
          aCaracter  = aCadena % nBusca;
          |HAZ Cambia;
          aCadenaSal = aCadenaSal + aCaracterSal;
     |SIGUE;
|FPRC;

|PROCESO Lineas;
     aCampo = #100#1;  |QBF aCampo;
     aValor = #100#2;  |QBF aValor;
     |SI aValor = "";  |ACABA;  |FINSI;

     aLinea = "<< /V (" + aValor + ")/T (" + aCampo + ")>> ";
     aCadena = aLinea;
     |HAZ Sustituye;
     aLinea = aCadenaSal;
     |XGRABA nHandle, aLinea;
|FPRC;

|DEFBUCLE agiw0100;
     #100#1;
     ;
     00000;
     99999;
     ;
     NULL, Lineas;
|FIN;

|PROCESO Pie;
     aLinea = "] ";                                  |XGRABA nHandle, aLinea;
     aLinea = "/F (C:/DOCUMENTOS/PDF/MOD036E.PDF)";  |XGRABA nHandle, aLinea;
     aLinea = "/ID [ ] >>";                          |XGRABA nHandle, aLinea;
     aLinea = ">> ";                                 |XGRABA nHandle, aLinea;
     aLinea = "endobj";                              |XGRABA nHandle, aLinea;
     aLinea = "trailer";                             |XGRABA nHandle, aLinea;
     aLinea = "<</Root 1 0 R >>";                    |XGRABA nHandle, aLinea;
     aLinea = "%%EOF";                               |XGRABA nHandle, aLinea;
|FPRC;

|PROCESO BuscaCaracter;
     aLongitud = aCadena % 0;
     nLongitud = aLongitud;
     |PARA nPos = 1; |SI nPos [ nLongitud; |HACIENDO nPos = nPos + 1;
          nCaracter = ((nPos * 100) + 1) * nPorDonde;
          aCaracter = aCadena % nCaracter;
          |SI aCaracter = aMiCaracter;
               |SAL;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO ImprimePDF;
     |DBASE aBasePdf;  |QBF aBasePdf;
     aBasePdf = aBasePdf + "pdf/";

     nPon     = 0;
     aAbre    = aBasePdf + "mod036e.pdf";
     |XABRE "B", aAbre, nHandle;
     |SI FSalida < 0;
         nPon = 1;
     |SINO;
          nBytes = 0;
          |XPOSICION nHandle, nBytes, 2;
          |SI nBytes ! 3105704;
              nPon = 1;
          |FINSI;
     |FINSI;
     |XCIERRA nHandle;

     |SI nPon = 1;
         aFichero   = aBasePdf + "mod036e.tgz";
         |DESCOMPRIME aFichero;

         aFichero   = aBasePdf + "mod036e.tar";
         |DETAR aFichero, aBasePdf;

         |FBORRA aFichero;
     |FINSI;

     |XABRE "E", aAbre, nHandle;
     |SI FSalida < 0;
         |MENAV "0000 No encuentro el PDF, pongase en contacto con su distribuidor";
         |ACABA;
     |FINSI;

     aDestino = "C:\DOCUMENTOS";     |RMKDIR aDestino;
     aDestino = aDestino + "\PDF";   |RMKDIR aDestino;
     aDestino = aDestino + "\MOD036E.PDF";
     aOrigen  = aAbre;
     nPon     = 0;

     |XABRE "BC", aDestino, nHandle;
     |SI FSalida < 0;
         nPon = 1;
     |SINO;
         nBytes = 0;
         |XPOSICION nHandle, nBytes, 2;
         |SI nBytes ! 3105704;
             nPon = 1;
         |FINSI;
         |XCIERRA nHandle;
     |FINSI;

     |SI nPon = 1;
         aIP = "";
         |IP_REMOTO aIP;  |QBF aIP;
         |SI aIP ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;
     |FINSI;

     aDestino = "C:\DOCUMENTOS";     |RMKDIR aDestino;
     aDestino = aDestino + "\PDF";   |RMKDIR aDestino;
     aDestino = aDestino + "\wait.exe";
     aOrigen  = aBasePdf + "wait.exe";

     |XABRE "EC", aDestino, nHandle;
     |SI FSalida < 0;
         aIP = "";
         |IP_REMOTO aIP;  |QBF aIP;
         |SI aIP ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;
     |FINSI;

     aArchivoPdf = "C:\DOCUMENTOS\PDF\MOD036E.FDF";
     |XABRE "CW", aArchivoPdf, nHandle;
     |SI FSalida ] 0;
         |HAZ Cabecera;
         |BUCLE agiw0100;
         |HAZ Pie;
     |FINSI;
     |XCIERRA nHandle;

     aPathReader = #0#6;  |QBF aPathReader;
     aCadena     = aPathReader;
     aMiCaracter = "\";
     nPorDonde   = -1;
     |HAZ BuscaCaracter;
     nPos        = nPos -1;
     nPos        = nPos + 100;
     nPos        = (-1) * nPos;
     aEjecutable = aPathReader % nPos;
     aPathReader = aPathReader - aEjecutable;

     aWait       = "C:\DOCUMENTOS\PDF\wait.exe";
     aFicheroBAT = "C:\DOCUMENTOS\PDF\IMPRIME.BAT";
     |XABRE "CBW", aFicheroBAT, nHandle;
     |SI FSalida = 0;
         aAlfa   = "@echo off" + &13 + &10;  |XGRABA nHandle, aAlfa;
         aUnidad = aPathReader % 102;
         aAlfa   = aUnidad + &13 + &10;      |XGRABA nHandle, aAlfa;
         aAlfa   = "cd " + &34 + aPathReader + &34 + &13 + &10;
         aAlfa   = aAlfa - aUnidad;          |XGRABA nHandle, aAlfa;
         aAlfa   = aWait + " " + aEjecutable;
         aAlfa   = aAlfa + " " + aArchivoPdf + &13 + &10;
                                             |XGRABA nHandle, aAlfa;
     |FINSI;
     |XCIERRA nHandle;

     |RSYSTEM aFicheroBAT;

     |RFBORRA aFicheroBAT;
     |RFBORRA aArchivoPdf;

     |DELINDEX #100;
|FPRC;

|PROCESO AbreFichero;
     aArchivoTxt = "C:\AEAT";                   |RMKDIR aArchivoTxt;
     aArchivoTxt = aArchivoTxt + "\INTERNET";   |RMKDIR aArchivoTxt;
     aArchivoTxt = aArchivoTxt + "\036";        |RMKDIR aArchivoTxt;
     aArchivoTxt = aArchivoTxt + "\M" + (("00000" + #20#0) % -105) + (("00" + #20#1) % -102) + ".TXT";

     |XABRE "CBW", aArchivoTxt, nHandle;
|FPRC;

|PROCESO GrabaPdf;
     |QBF aValor;

     #100#0 = nCasilla;
     |LEE 101#100=;
     |SI FSalida = 0;
         aAlfa  = aValor;  |HAZ QuitaRaros;

         #100#2 = aAlfa;
         |GRABA 020#100a;
         |LIBERA #100;
    |FINSI;
|FPRC;

|PROCESO Hoja1A;
     |ABRE #1;
     #1#0 = #20#0;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |ABRE #21;
     #21#0 = #20#0;
     #21#1 = #20#1;
     |LEE 040#21=;
     |SI FSalida ! 0;  |DDEFECTO #21;  |FINSI;
     |CIERRA #21;

     |ABRE #22;
     #22#0 = #20#0;
     #22#1 = #20#1;
     |LEE 040#22=;
     |SI FSalida ! 0;  |DDEFECTO #22;  |FINSI;
     |CIERRA #22;

    |DDEFECTO #101;

     |SI #20#3 = "A";
         |SI #22#8 = "S";  |O #22#9 = "S";
             #101#3 = ("00"  + #1#63) % -102;
             #101#4 = ("000" + #1#64) % -103;
             #101#5  = #21#2;
             #101#6  = #21#3;
             aSigla  = #21#4;  |HAZ LeeSigla;
             #101#7  = #21#4 + " " + aSigla;
             #101#8  = #21#5;
             nNume   = #21#6;
             #101#9  = ("00000" + nNume) % -105;
             #101#10 = #21#7;
             #101#11 = #21#8;
             #101#12 = #21#9;
             nNume   = #21#10;
             #101#13 = ("000000000" + nNume) % -109;
             #101#14 = (("00" + #21#11) % -102) + (("000" + #21#12) % -103);
             #101#15 = #21#13;
             #101#16 = (("00" + #21#11) % -102);
             #101#18 = #21#15;
             #101#19 = #21#16;
             aSigla  = #21#18;  |HAZ LeeSigla;
             #101#20 = #21#18 + " " + aSigla;
             #101#21 = #21#19;
             nNume   = #21#20;
             #101#22 = ("00000" + nNume) % -105;
             #101#23 = #21#21;
             #101#24 = #21#22;
             #101#25 = #21#23;
             nNume   = #21#24;
             #101#26 = ("000000000" + nNume) % -109;
             #101#27 = (("00" + #21#25) % -102) + (("000" + #21#26) % -103);
             #101#28 = #21#27;
             #101#29 = (("00" + #21#25) % -102);
         |FINSI;
     |FINSI;

     |SI #20#3 = "B";
         |SI #22#8 = "S";  |O #22#9 = "S";
             #101#3 = ("00"  + #1#63) % -102;
             #101#4 = ("000" + #1#64) % -103;
             #101#31 = #21#2;
             #101#32 = #21#3;
             #101#33 = #21#17;

             aSigla  = #21#4;  |HAZ LeeSigla;
             #101#34 = #21#4 + " " + aSigla;
             #101#35 = #21#5;
             nNume   = #21#6;
             #101#36 = ("00000" + nNume) % -105;
             #101#37 = #21#7;
             #101#38 = #21#8;
             #101#39 = #21#9;
             nNume   = #21#10;
             #101#40 = ("000000000" + nNume) % -109;
             #101#41 = (("00" + #21#11) % -102) + (("000" + #21#12) % -103);
             #101#42 = #21#13;
             #101#43 = (("00" + #21#11) % -102);
             #101#45 = #21#15;
             #101#46 = #21#16;
             aSigla  = #21#18;  |HAZ LeeSigla;
             #101#47 = #21#18 + " " + aSigla;
             #101#48 = #21#19;
             nNume   = #21#20;
             #101#49 = ("00000" + nNume) % -105;
             #101#50 = #21#21;
             #101#51 = #21#22;
             #101#52 = #21#23;
             nNume   = #21#24;
             #101#53 = ("000000000" + nNume) % -109;
             #101#54 = (("00" + #21#25) % -102) + (("000" + #21#26) % -103);
             #101#55 = #21#27;
             #101#56 = (("00" + #21#25) % -102);

         #101#58 = #21#29;
         #101#59 = #21#30;
         #101#60 = #21#31;
         #101#61 = #21#33;
         #101#62 = #21#34;
         #101#63 = #21#36;
         #101#64 = #21#37;
         #101#65 = #21#39;
         #101#66 = #21#40;
         |FINSI;    || cambiado FINSI para que no ponga ningun datos en
                    || la hoja 1a si no es modificacion 05.06.2007
     |FINSI;

     |SI #20#3 = "C";
         |SI #22#8 = "S";  |O #22#9 = "S";
             #101#3 = ("00"  + #1#63) % -102;
             #101#4 = ("000" + #1#64) % -103;
             #101#67 = #21#2;
             #101#68 = #21#3;
             #101#69 = #21#17;

             aSigla  = #21#4;  |HAZ LeeSigla;
             #101#70 = #21#4 + " " + aSigla;
             #101#71 = #21#5;
             nNume   = #21#6;
             #101#72 = ("00000" + nNume) % -105;
             #101#73 = #21#7;
             #101#74 = #21#8;
             #101#75 = #21#9;
             nNume   = #21#10;
             #101#76 = ("000000000" + nNume) % -109;
             #101#77 = (("00" + #21#11) % -102) + (("000" + #21#12) % -103);
             #101#78 = #21#13;
             #101#79 = (("00" + #21#11) % -102);
             #101#81 = #21#15;
             #101#82 = #21#16;
         |FINSI;
     |FINSI;

     #101#84 = &13 + &10;

     |SI #0#0 = 1;
         nCasilla = 1;     aValor = #1#91;            |HAZ GrabaPdf;
         nCasilla = 2;     aValor = #1#92;            |HAZ GrabaPdf;
         nCasilla = 3;     aValor = #101#3 + #101#4;  |HAZ GrabaPdf;

         aValor   = #21#2;
         nCasilla = 1191;                             |HAZ GrabaPdf;
         nCasilla = 1192;                             |HAZ GrabaPdf;
         nCasilla = 1193;                             |HAZ GrabaPdf;
         nCasilla = 1194;                             |HAZ GrabaPdf;
         nCasilla = 1195;                             |HAZ GrabaPdf;
         nCasilla = 1196;                             |HAZ GrabaPdf;
         nCasilla = 1197;                             |HAZ GrabaPdf;
         nCasilla = 1198;                             |HAZ GrabaPdf;
         nCasilla = 1199;                             |HAZ GrabaPdf;
         nCasilla = 1200;                             |HAZ GrabaPdf;

         aValor   = #21#3;
         nCasilla = 1181;                             |HAZ GrabaPdf;
         nCasilla = 1182;                             |HAZ GrabaPdf;
         nCasilla = 1183;                             |HAZ GrabaPdf;
         nCasilla = 1184;                             |HAZ GrabaPdf;
         nCasilla = 1185;                             |HAZ GrabaPdf;
         nCasilla = 1186;                             |HAZ GrabaPdf;
         nCasilla = 1187;                             |HAZ GrabaPdf;
         nCasilla = 1188;                             |HAZ GrabaPdf;
         nCasilla = 1189;                             |HAZ GrabaPdf;
         nCasilla = 1190;                             |HAZ GrabaPdf;

         |SI #20#3 = "A";
             nCasilla = 6;     aValor = #21#2;            |HAZ GrabaPdf;
             nCasilla = 317;   aValor = #21#3;            |HAZ GrabaPdf;
             nCasilla = 318;   aValor = #21#4;            |HAZ GrabaPdf;
             nCasilla = 319;   aValor = #21#5;            |HAZ GrabaPdf;
             nCasilla = 320;   aValor = #21#6;            |HAZ GrabaPdf;
             nCasilla = 321;   aValor = #21#7;            |HAZ GrabaPdf;
             nCasilla = 322;   aValor = #21#8;            |HAZ GrabaPdf;
             nCasilla = 323;   aValor = #21#9;            |HAZ GrabaPdf;
             nCasilla = 324;   aValor = #21#10;           |HAZ GrabaPdf;
             #101#14 = (("00" + #21#11) % -102) + (("000" + #21#12) % -103);
             |SI #101#14 ! "00000";
                 nCasilla = 325;   aValor = #101#14;          |HAZ GrabaPdf;
             |FINSI;
             nCasilla = 326;   aValor = #21#13;           |HAZ GrabaPdf;
             nCasilla = 328;   aValor = #21#14;           |HAZ GrabaPdf;
             #101#16 = (("00" + #21#11) % -102);
             |SI #101#16 ! "00";
                 nCasilla = 329;   aValor = #101#16;          |HAZ GrabaPdf;
             |FINSI;
             nCasilla = 330;   aValor = #21#15;           |HAZ GrabaPdf;
             nCasilla = 331;   aValor = #21#16;           |HAZ GrabaPdf;
             nCasilla = 332;   aValor = #21#18;           |HAZ GrabaPdf;
             nCasilla = 333;   aValor = #21#19;           |HAZ GrabaPdf;
             nCasilla = 334;   aValor = #21#20;           |HAZ GrabaPdf;
             nCasilla = 335;   aValor = #21#21;           |HAZ GrabaPdf;
             nCasilla = 336;   aValor = #21#22;           |HAZ GrabaPdf;
             nCasilla = 337;   aValor = #21#23;           |HAZ GrabaPdf;
             nCasilla = 338;   aValor = #21#24;           |HAZ GrabaPdf;
             #101#27 = (("00" + #21#25) % -102) + (("000" + #21#26) % -103);
             |SI #101#27 ! "00000";
                 nCasilla = 339;   aValor = #101#27;          |HAZ GrabaPdf;
             |FINSI;
             nCasilla = 340;   aValor = #21#27;           |HAZ GrabaPdf;
             nCasilla = 342;   aValor = #21#28;           |HAZ GrabaPdf;
             #101#29 = (("00" + #21#25) % -102);
             |SI #101#29 ! "00";
                 nCasilla = 343;   aValor = #101#29;          |HAZ GrabaPdf;
             |FINSI;
         |FINSI;

         |SI #20#3 = "B";
             nCasilla = 4;     aValor = #21#2;            |HAZ GrabaPdf;
             nCasilla = 344;   aValor = #21#3;            |HAZ GrabaPdf;
             nCasilla = 345;   aValor = #21#17;           |HAZ GrabaPdf;
             nCasilla = 346;   aValor = #21#4;            |HAZ GrabaPdf;
             nCasilla = 347;   aValor = #21#5;            |HAZ GrabaPdf;
             nCasilla = 348;   aValor = #21#6;            |HAZ GrabaPdf;
             nCasilla = 349;   aValor = #21#7;            |HAZ GrabaPdf;
             nCasilla = 350;   aValor = #21#8;            |HAZ GrabaPdf;
             nCasilla = 351;   aValor = #21#9;            |HAZ GrabaPdf;
             nCasilla = 352;   aValor = #21#10;           |HAZ GrabaPdf;
             #101#41 = (("00" + #21#11) % -102) + (("000" + #21#12) % -103);
             |SI #101#41 ! "00000";
                 nCasilla = 353;   aValor = #101#41;          |HAZ GrabaPdf;
             |FINSI;
             nCasilla = 354;   aValor = #21#13;           |HAZ GrabaPdf;
             nCasilla = 356;   aValor = #21#14;           |HAZ GrabaPdf;
             #101#43 = (("00" + #21#11) % -102);
             |SI #101#43 ! "00";
                 nCasilla = 357;   aValor = #101#43;      |HAZ GrabaPdf;
             |FINSI;
             nCasilla = 358;   aValor = #21#15;           |HAZ GrabaPdf;
             nCasilla = 359;   aValor = #21#16;           |HAZ GrabaPdf;
             nCasilla = 360;   aValor = #21#18;           |HAZ GrabaPdf;
             nCasilla = 361;   aValor = #21#19;           |HAZ GrabaPdf;
             nCasilla = 362;   aValor = #21#20;           |HAZ GrabaPdf;
             nCasilla = 363;   aValor = #21#21;           |HAZ GrabaPdf;
             nCasilla = 364;   aValor = #21#22;           |HAZ GrabaPdf;
             nCasilla = 365;   aValor = #21#23;           |HAZ GrabaPdf;
             nCasilla = 366;   aValor = #21#24;           |HAZ GrabaPdf;
             #101#54 = (("00" + #21#25) % -102) + (("000" + #21#26) % -103);
             |SI #101#54 ! "00000";
                 nCasilla = 367;   aValor = #101#54;          |HAZ GrabaPdf;
             |FINSI;
             nCasilla = 368;   aValor = #21#27;           |HAZ GrabaPdf;
             nCasilla = 370;   aValor = #21#28;           |HAZ GrabaPdf;
             #101#56 = (("00" + #21#25) % -102);
             |SI #101#56 ! "00";
                 nCasilla = 371;   aValor = #101#56;          |HAZ GrabaPdf;
             |FINSI;

             |SI #21#29 = "S"; nCasilla = 17; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
             |SI #21#29 = "N"; nCasilla = 18; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
             |SI #21#30 = "S"; nCasilla = 19; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
             nCasilla = 372;   aValor = #21#32;           |HAZ GrabaPdf;
             |SI #21#33 = "S"; nCasilla = 20; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
             nCasilla = 373;   aValor = #21#35;           |HAZ GrabaPdf;
             |SI #21#36 = "S"; nCasilla = 21; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
             nCasilla = 374;   aValor = #21#38;           |HAZ GrabaPdf;
             |SI #21#39 = "S"; nCasilla = 22; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
             nCasilla = 375;   aValor = #21#41;           |HAZ GrabaPdf;
         |FINSI;

         |SI #20#3 = "C";
             nCasilla = 5;     aValor = #21#2;            |HAZ GrabaPdf;
             nCasilla = 376;   aValor = #21#3;            |HAZ GrabaPdf;
             nCasilla = 377;   aValor = #21#17;           |HAZ GrabaPdf;
             nCasilla = 378;   aValor = #21#4;            |HAZ GrabaPdf;
             nCasilla = 379;   aValor = #21#5;            |HAZ GrabaPdf;
             nCasilla = 380;   aValor = #21#6;            |HAZ GrabaPdf;
             nCasilla = 381;   aValor = #21#7;            |HAZ GrabaPdf;
             nCasilla = 382;   aValor = #21#8;            |HAZ GrabaPdf;
             nCasilla = 383;   aValor = #21#9;            |HAZ GrabaPdf;
             nCasilla = 384;   aValor = #21#10;           |HAZ GrabaPdf;
             #101#77 = (("00" + #21#11) % -102) + (("000" + #21#12) % -103);
             |SI #101#77 ! "00000";
                 nCasilla = 385;   aValor = #101#77;          |HAZ GrabaPdf;
             |FINSI;
             nCasilla = 386;   aValor = #21#13;           |HAZ GrabaPdf;
             nCasilla = 388;   aValor = #21#14;           |HAZ GrabaPdf;
             #101#79 = (("00" + #21#11) % -102);
             |SI #101#79 ! "00";
                 nCasilla = 389;   aValor = #101#79;      |HAZ GrabaPdf;
             |FINSI;
             nCasilla = 390;   aValor = #21#15;           |HAZ GrabaPdf;
             nCasilla = 391;   aValor = #21#16;           |HAZ GrabaPdf;
         |FINSI;
     |FINSI;

     |SI #0#0 = 2;
         |PARA nNumero = 1;  |SI nNumero [ 84;  |HACIENDO nNumero = nNumero + 1;
               aAlfa = #101nNumero;
               |HAZ QuitaRaros;
               #101nNumero = aAlfa;
               aAlfa = #101nNumero;
               |XGRABA nHandle, aAlfa;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Hoja1B;
     |DDEFECTO #102;

     |SI #20#3 = "C";
         |SI #22#8 = "S";  |O #22#9 = "S";
             #102#3  = #21#42;
             #102#4  = #21#43;
             #102#5  = #21#45;
         |FINSI;

         #102#6  = #21#47;
         #102#7  = #21#48;
         #102#8  = #21#49;
         #102#9  = #21#50;
         #102#10 = #21#51;
         #102#11 = #21#52;
         #102#12 = #21#53;
         #102#13 = #21#54;
         #102#14 = #21#55;
         #102#15 = #21#56;
         #102#16 = ("000" + #21#57) % -103;
         #102#17 = #21#58;
         #102#18 = #21#59;
         #102#19 = #21#60;
         #102#20 = #21#61;
         #102#21 = #21#62;
         #102#22 = #21#63;
     |FINSI;

     |SI #20#3 = "D";
         |SI #22#8 = "S";  |O #22#9 = "S";
             #102#23 = #21#2;
             #102#24 = #21#3;
             #102#25 = #21#17;

             aSigla  = #21#4;  |HAZ LeeSigla;
             #102#26 = #21#4 + " " + aSigla;
             #102#27 = #21#5;
             nNume   = #21#6;
             #102#28 = ("00000" + nNume) % -105;
             #102#29 = #21#7;
             #102#30 = #21#8;
             #102#31 = #21#9;
             nNume   = #21#10;
             #102#32 = ("000000000" + nNume) % -109;
             #102#33 = (("00" + #21#11) % -102) + (("000" + #21#12) % -103);
             #102#34 = #21#13;
             #102#35 = (("00" + #21#11) % -102);
             #102#37 = #21#15;
             #102#38 = #21#16;
             aSigla  = #21#18;  |HAZ LeeSigla;
             #102#39 = #21#18 + " " + aSigla;
             #102#40 = #21#19;
             nNume   = #21#20;
             #102#41 = ("00000" + nNume) % -105;
             #102#42 = #21#21;
             #102#43 = #21#22;
             #102#44 = #21#23;
             nNume   = #21#24;
             #102#45 = ("000000000" + nNume) % -109;
             #102#46 = (("00" + #21#25) % -102) + (("000" + #21#26) % -103);
             #102#47 = #21#27;
             #102#48 = (("00" + #21#25) % -102);
         |FINSI;

         #102#50 = #21#64;
         #102#51 = #21#66;
         #102#52 = #21#67;
         #102#53 = #21#68;
         #102#54 = #21#69;
     |FINSI;

     #102#55 = #21#71;
     |SI #21#72 ! "01.01.0000";
         aAlfa   = #21#72 % 102;   #102#56 = aAlfa;
         aAlfa   = #21#72 % 402;   #102#57 = aAlfa;
         aAlfa   = #21#72 % -104;  #102#58 = aAlfa;
     |FINSI;
     #102#59 = #21#73;
     #102#60 = #21#75;
     #102#62 = &13 + &10;

     |SI #0#0 = 1;
         |SI #20#3 = "C";
             nCasilla = 411;   aValor = #21#42;           |HAZ GrabaPdf;
             nCasilla = 412;   aValor = #21#44;           |HAZ GrabaPdf;
             nCasilla = 413;   aValor = #21#46;           |HAZ GrabaPdf;
             |SI #21#47 = "S"; nCasilla = 23; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
             |SI #21#48 = "S"; nCasilla = 24; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
             nCasilla = 414;   aValor = #21#49;           |HAZ GrabaPdf;
             |SI #21#50 = "S"; nCasilla = 25; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
             nCasilla = 415;   aValor = #21#51;           |HAZ GrabaPdf;
             |SI #21#52 = "S"; nCasilla = 26; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
             nCasilla = 416;   aValor = #21#53;           |HAZ GrabaPdf;
             |SI #21#54 = "S"; nCasilla = 27; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
             nCasilla = 417;   aValor = #21#55;           |HAZ GrabaPdf;
             |SI #21#56 = "S"; nCasilla = 28; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
             |SI #21#56 = "N"; nCasilla = 29; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
             |SI #21#57 ! 0;
                 nCasilla = 418;   aValor = #21#57;           |HAZ GrabaPdf;
             |FINSI;
             nCasilla = 9;     aValor = #21#58;           |HAZ GrabaPdf;
             nCasilla = 419;   aValor = #21#59;           |HAZ GrabaPdf;
             nCasilla = 10;    aValor = #21#60;           |HAZ GrabaPdf;
             nCasilla = 420;   aValor = #21#61;           |HAZ GrabaPdf;
             nCasilla = 11;    aValor = #21#62;           |HAZ GrabaPdf;
             nCasilla = 421;   aValor = #21#63;           |HAZ GrabaPdf;
         |FINSI;

         |SI #20#3 = "D";
             nCasilla = 7;     aValor = #21#2;            |HAZ GrabaPdf;
             nCasilla = 422;   aValor = #21#3;            |HAZ GrabaPdf;
             nCasilla = 423;   aValor = #21#17;           |HAZ GrabaPdf;
             nCasilla = 424;   aValor = #21#4;            |HAZ GrabaPdf;
             nCasilla = 425;   aValor = #21#5;            |HAZ GrabaPdf;
             nCasilla = 426;   aValor = #21#6;            |HAZ GrabaPdf;
             nCasilla = 427;   aValor = #21#7;            |HAZ GrabaPdf;
             nCasilla = 428;   aValor = #21#8;            |HAZ GrabaPdf;
             nCasilla = 429;   aValor = #21#9;            |HAZ GrabaPdf;
             nCasilla = 430;   aValor = #21#10;           |HAZ GrabaPdf;
             #102#33 = (("00" + #21#11) % -102) + (("000" + #21#12) % -103);
             |SI #102#33 ! "00000";
                 nCasilla = 431;   aValor = #102#33;          |HAZ GrabaPdf;
             |FINSI;
             nCasilla = 432;   aValor = #21#13;           |HAZ GrabaPdf;
             nCasilla = 434;   aValor = #21#14;           |HAZ GrabaPdf;
             #102#35 = (("00" + #21#11) % -102);
             |SI #102#35 ! "00";
                 nCasilla = 435;   aValor = #102#35;      |HAZ GrabaPdf;
             |FINSI;
             nCasilla = 436;   aValor = #21#15;           |HAZ GrabaPdf;
             nCasilla = 437;   aValor = #21#16;           |HAZ GrabaPdf;
             nCasilla = 438;   aValor = #21#18;           |HAZ GrabaPdf;
             nCasilla = 439;   aValor = #21#19;           |HAZ GrabaPdf;
             nCasilla = 440;   aValor = #21#20;           |HAZ GrabaPdf;
             nCasilla = 441;   aValor = #21#21;           |HAZ GrabaPdf;
             nCasilla = 442;   aValor = #21#22;           |HAZ GrabaPdf;
             nCasilla = 443;   aValor = #21#23;           |HAZ GrabaPdf;
             nCasilla = 444;   aValor = #21#24;           |HAZ GrabaPdf;
             #102#46 = (("00" + #21#25) % -102) + (("000" + #21#26) % -103);
             |SI #102#46 ! "00000";
                 nCasilla = 445;   aValor = #102#46;          |HAZ GrabaPdf;
             |FINSI;
             nCasilla = 446;   aValor = #21#27;           |HAZ GrabaPdf;
             nCasilla = 448;   aValor = #21#28;           |HAZ GrabaPdf;
             #102#48 = (("00" + #21#25) % -102);
             |SI #102#48 ! "00";
                 nCasilla = 449;   aValor = #102#48;          |HAZ GrabaPdf;
             |FINSI;

             nCasilla = 450;   aValor = #21#65;           |HAZ GrabaPdf;

             |SI #21#66 = "S"; nCasilla = 30; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
             |SI #21#66 = "N"; nCasilla = 31; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
             nCasilla = 8;     aValor = #21#67;           |HAZ GrabaPdf;
             nCasilla = 451;   aValor = #21#68;           |HAZ GrabaPdf;
             nCasilla = 452;   aValor = #21#70;           |HAZ GrabaPdf;
         |FINSI;

         nCasilla = 453;   aValor = #21#71;           |HAZ GrabaPdf;
         |SI #21#72 ! "01.01.0000";
             nCasilla = 454;   aValor = #21#72;           |HAZ GrabaPdf;
         |FINSI;
         nCasilla = 455;   aValor = #21#74;           |HAZ GrabaPdf;
         nCasilla = 456;   aValor = #21#75;           |HAZ GrabaPdf;
     |FINSI;

     |SI #0#0 = 2;
         |PARA nNumero = 1;  |SI nNumero [ 62;  |HACIENDO nNumero = nNumero + 1;
               aAlfa = #102nNumero;
               |HAZ QuitaRaros;
               #102nNumero = aAlfa;
               aAlfa = #102nNumero;
               |XGRABA nHandle, aAlfa;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Hoja2;
     |ABRE #22;
     #22#0 = #20#0;
     #22#1 = #20#1;
     |LEE 040#22=;
     |SI FSalida ! 0;  |DDEFECTO #22;  |FINSI;
     |CIERRA #22;

     |DDEFECTO #103;

     #103#3   = #21#2;
     #103#4   = #21#3;
     #103#6   = #22#2;
     #103#7   = #22#3;
     #103#8   = #22#4;
     #103#9   = #22#5;
     #103#10  = #22#6;
     #103#11  = #22#7;
     #103#12  = #22#8;
     #103#13  = #22#9;
     #103#14  = #22#10;
     #103#15  = #22#11;
     #103#16  = #22#12;
     #103#17  = #22#13;
     #103#18  = #22#14;
     #103#19  = #22#15;
     #103#20  = #22#16;
     #103#21  = #22#17;
     #103#22  = #22#18;
     #103#23  = #22#19;
     #103#24  = #22#20;
     #103#25  = #22#21;
     #103#26  = #22#22;
     #103#27  = #22#23;
     #103#28  = #22#24;
     |SI #22#26 ! "01.01.0000";
         aAlfa    = #22#26 % 102;   #103#29 = aAlfa;
         aAlfa    = #22#26 % 402;   #103#30 = aAlfa;
         aAlfa    = #22#26 % -104;  #103#31 = aAlfa;
     |FINSI;
     #103#34  = &13 + &10;

     |SI #0#0 = 1;
         |SI #22#2  = "S"; nCasilla = 32; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#3  = "S"; nCasilla = 33; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#4  = "S"; nCasilla = 34; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#5  = "S"; nCasilla = 35; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#6  = "S"; nCasilla = 36; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#7  = "S"; nCasilla = 37; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#8  = "S"; nCasilla = 38; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#9  = "S"; nCasilla = 39; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#10 = "S"; nCasilla = 40; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#11 = "S"; nCasilla = 41; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#12 = "S"; nCasilla = 42; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#13 = "S"; nCasilla = 43; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#14 = "S"; nCasilla = 44; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#15 = "S"; nCasilla = 45; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#16 = "S"; nCasilla = 46; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#17 = "S"; nCasilla = 47; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#18 = "S"; nCasilla = 48; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#19 = "S"; nCasilla = 49; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#20 = "S"; nCasilla = 50; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#21 = "S"; nCasilla = 51; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#22 = "S"; nCasilla = 52; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#23 = "S"; nCasilla = 53; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 466;   aValor = #22#25;           |HAZ GrabaPdf;
         |SI #22#26 ! "01.01.0000";
             nCasilla = 467;   aValor = #22#26 % 102;     |HAZ GrabaPdf;
             nCasilla = 468;   aValor = #22#26 % 402;     |HAZ GrabaPdf;
             nCasilla = 469;   aValor = #22#26 % -104;    |HAZ GrabaPdf;
         |FINSI;
     |FINSI;

     |SI #0#0 = 2;
         |PARA nNumero = 1;  |SI nNumero [ 34;  |HACIENDO nNumero = nNumero + 1;
               aAlfa = #103nNumero;
               |HAZ QuitaRaros;
               #103nNumero = aAlfa;
               aAlfa = #103nNumero;
               |XGRABA nHandle, aAlfa;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Hoja3;
     |ABRE #22;
     #22#0 = #20#0;
     #22#1 = #20#1;
     |LEE 040#22=;
     |SI FSalida ! 0;   |DDEFECTO #22;  |FINSI;

     |SI #22#10 = " ";  |Y #22#2  = " ";  |Y #22#3 = " ";  |Y #22#4 = " ";
      |Y #22#6  = " ";
         |DDEFECTO #22;
     |FINSI;
     |CIERRA #22;

     |DDEFECTO #104;

     #104#3   = #22#27;
     #104#4   = #22#28;
     #104#5   = #22#29;
     aSigla   = #22#30;  |HAZ LeeSigla;
     #104#6   = #22#30 + " " + aSigla;
     #104#7   = #22#31;
     nNume    = #22#32;
     #104#8   = ("00000" + nNume) % -105;
     #104#9   = #22#33;
     #104#10  = #22#34;
     #104#11  = #22#35;
     nNume    = #22#36;
     #104#12  = ("000000000" + nNume) % -109;
     #104#13  = (("00" + #22#37) % -102) + (("000" + #22#38) % -103);
     #104#14  = #22#39;
     #104#15  = (("00" + #22#37) % -102); |SI #104#15 = "00"; #104#15 = "  "; |FINSI;
     #104#17  = #22#41;
     #104#18  = #22#42;
     #104#19  = #22#43;
     #104#20  = #22#44;
     #104#21  = #22#45;
     #104#22  = #22#46;
     #104#23  = #22#47;
     #104#24  = #22#48;
     #104#25  = #22#49;
     #104#26  = #22#50;
     #104#27  = #22#51;
     #104#28  = #22#52;
     #104#29  = #22#53;
     #104#30  = #22#54;
     #104#31  = #22#55;
     #104#32  = #22#56;
     #104#33  = #22#57;
     |SI #22#58 ! "01.01.0000";
         #104#34  = #22#58 % 102;
         #104#35  = #22#58 % 402;
     |FINSI;
     #104#36  = #22#59;
     #104#37  = #22#60;
     #104#38  = #22#61;
     #104#39  = #22#62;
     #104#40  = #22#63;
     #104#41  = #22#64;
     #104#42  = #22#65;
     #104#43  = #22#66;

     #104#45  = &13 + &10;

     |SI #0#0 = 1;
         nCasilla = 12;    aValor = #22#27;             |HAZ GrabaPdf;
         nCasilla = 492;   aValor = #22#28;             |HAZ GrabaPdf;
         |SI #22#29 = "S"; nCasilla = 54; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#29 = "N"; nCasilla = 55; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 493;   aValor = #22#30;             |HAZ GrabaPdf;
         nCasilla = 494;   aValor = #22#31;             |HAZ GrabaPdf;
         nCasilla = 495;   aValor = #22#32;             |HAZ GrabaPdf;
         nCasilla = 496;   aValor = #22#33;             |HAZ GrabaPdf;
         nCasilla = 497;   aValor = #22#34;             |HAZ GrabaPdf;
         nCasilla = 498;   aValor = #22#35;             |HAZ GrabaPdf;
         nCasilla = 499;   aValor = #22#36;             |HAZ GrabaPdf;
         |SI #104#13 ! "00000";
             nCasilla = 500;   aValor = #104#13;        |HAZ GrabaPdf;
         |FINSI;
         nCasilla = 501;   aValor = #22#39;             |HAZ GrabaPdf;
         nCasilla = 503;   aValor = #22#40;             |HAZ GrabaPdf;
         |SI #104#15 ! "00";
             nCasilla = 504;   aValor = #104#15;        |HAZ GrabaPdf;
         |FINSI;

         |SI #22#41 = "S"; nCasilla = 56; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#42 = "S"; nCasilla = 57; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#43 = "S"; nCasilla = 58; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#44 = "S"; nCasilla = 59; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#45 = "S"; nCasilla = 60; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#46 = "S"; nCasilla = 61; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#47 = "S"; nCasilla = 62; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#48 = "S"; nCasilla = 63; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#49 = "S"; nCasilla = 64; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#50 = "S"; nCasilla = 65; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#51 = "S"; nCasilla = 66; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#52 = "S"; nCasilla = 67; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#53 = "S"; nCasilla = 68; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#54 = "S"; nCasilla = 69; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#55 = "S"; nCasilla = 70; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#56 = "S"; nCasilla = 71; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 505;   aValor = #22#57;             |HAZ GrabaPdf;
         |SI #22#58 ! "01.01.0000";
             nCasilla = 506;   aValor = #22#58 % 102;   |HAZ GrabaPdf;
             nCasilla = 507;   aValor = #22#58 % 402;   |HAZ GrabaPdf;
         |FINSI;

         |SI #22#59 = "S"; nCasilla = 72; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#59 = "N"; nCasilla = 73; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#60 = "S"; nCasilla = 74; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#60 = "N"; nCasilla = 75; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#61 = "S"; nCasilla = 76; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#61 = "N"; nCasilla = 77; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#62 = "S"; nCasilla = 78; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#62 = "N"; nCasilla = 79; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#63 = "S"; nCasilla = 80; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#63 = "N"; nCasilla = 81; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#64 = "B"; nCasilla = 82; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#64 = "E"; nCasilla = 83; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#64 = "F"; nCasilla = 84; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#65 = "A"; nCasilla = 85; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#65 = "B"; nCasilla = 86; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#65 = "C"; nCasilla = 87; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#65 = "D"; nCasilla = 88; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#65 = "E"; nCasilla = 89; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#65 = "F"; nCasilla = 90; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#65 = "G"; nCasilla = 91; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#65 = "H"; nCasilla = 92; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#66 = "S"; nCasilla = 93; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
     |FINSI;

     |SI #0#0 = 2;
         |PARA nNumero = 1;  |SI nNumero [ 45;  |HACIENDO nNumero = nNumero + 1;
               aAlfa = #104nNumero;
               |HAZ QuitaRaros;
               #104nNumero = aAlfa;
               aAlfa = #104nNumero;
               |XGRABA nHandle, aAlfa;
         |SIGUE;
     |FINSI;

     |ABRE #22;
     #22#0 = #20#0;
     #22#1 = #20#1;
     |LEE 040#22=;
     |SI FSalida ! 0;  |DDEFECTO #22;  |FINSI;
     |CIERRA #22;
|FPRC;

|PROCESO agicen24;
     |SI nHay ! 0;
         nAcum = nHay - 1;
     |FINSI;

     nConta = nConta + 1;

     #105#0 = nAcum + ((nConta / 2) ! 0);
     |LEE 101#105=;
     |SI FSalida ! 0;
         |DDEFECTO #105;
         #105#0   = nAcum + ((nConta / 2) ! 0);
         |SI nHay ! 0;  #105#1   = "<T03604B>";  |FINSI;
         #105#2   = "C";
         #105#3   = #23#6;
         #105#4   = #23#3;
         #105#5   = #23#5;
         #105#6   = #23#7;
         |SI nHay ! 0;  #105#125 = "</T03604B>";  |FINSI;
         #105#126 = &13 + &10;
         |GRABA 020#105b;
     |FINSI;

     nResto = nConta $ 2;
     |SI #24#4 = "D";
         |SI nResto ! 0;  nCas = 19;  |FINSI;
         |SI nResto = 0;  nCas = 45;  |FINSI;
     |SINO;
         |SI nResto ! 0;  nCas = 71;  |FINSI;
         |SI nResto = 0;  nCas = 98;  |FINSI;
     |FINSI;

                       #105nCas  = #24#5;
                       aSigla    = #24#6;  |HAZ LeeSigla;
                       aAlfa     = #24#6 + " " + aSigla;
     nCas = nCas + 1;  #105nCas  = aAlfa;
     nCas = nCas + 1;  #105nCas  = #24#7;
                       nNume     = #24#8;
                       aAlfa     = ("00000" + nNume) % -105;
     nCas = nCas + 1;  #105nCas  = aAlfa;
     nCas = nCas + 1;  #105nCas  = #24#9;
     nCas = nCas + 1;  #105nCas  = #24#10;
                       aAlfa     = (("00" + #24#11) % -102) + (("000" + #24#12) % -103);
     nCas = nCas + 1;  #105nCas  = aAlfa;
     nCas = nCas + 1;  #105nCas  = #24#13;
                       aAlfa     = (("00" + #24#11) % -102);
     nCas = nCas + 1;  #105nCas  = aAlfa;
     nCas = nCas + 1;  #105nCas  = "000000";
                       aAlfa     = (("0000000" + #24#16) % -107);
     nCas = nCas + 1;  #105nCas  = aAlfa;
                       aAlfa     = (("000" + #24#17) % -103);
     nCas = nCas + 1;  #105nCas  = aAlfa;
     |SI #24#4 = "I";
         nCas = nCas + 1;  #105nCas  = #24#27;
     |FINSI;

     nCas = nCas + 1;  #105nCas  = #24#18;

     |SI #24#19 ! "01.01.0000";
                           aAlfa     = #24#19 % 102;
         nCas = nCas + 1;  #105nCas  = aAlfa;
                           aAlfa     = #24#19 % 402;
         nCas = nCas + 1;  #105nCas  = aAlfa;
                           aAlfa     = #24#19 % -104;
         nCas = nCas + 1;  #105nCas  = aAlfa;
     |SINO;
         nCas = nCas + 1;  #105nCas  = "00";
         nCas = nCas + 1;  #105nCas  = "00";
         nCas = nCas + 1;  #105nCas  = "0000";
     |FINSI;

     nCas = nCas + 1;  #105nCas  = #24#21;

     |SI #24#22 ! "01.01.0000";
                           aAlfa     = #24#22 % 102;
         nCas = nCas + 1;  #105nCas  = aAlfa;
                           aAlfa     = #24#22 % 402;
         nCas = nCas + 1;  #105nCas  = aAlfa;
                           aAlfa     = #24#22 % -104;
         nCas = nCas + 1;  #105nCas  = aAlfa;
     |SINO;
         nCas = nCas + 1;  #105nCas  = "00";
         nCas = nCas + 1;  #105nCas  = "00";
         nCas = nCas + 1;  #105nCas  = "0000";
     |FINSI;

     nCas = nCas + 1;  #105nCas  = #24#23;

     nCas = nCas + 1;  #105nCas  = #24#24;

     |SI #24#25 ! "01.01.0000";
                           aAlfa     = #24#25 % 102;
         nCas = nCas + 1;  #105nCas  = aAlfa;
                           aAlfa     = #24#25 % 402;
         nCas = nCas + 1;  #105nCas  = aAlfa;
                           aAlfa     = #24#25 % -104;
         nCas = nCas + 1;  #105nCas  = aAlfa;
     |SINO;
         nCas = nCas + 1;  #105nCas  = "00";
         nCas = nCas + 1;  #105nCas  = "00";
         nCas = nCas + 1;  #105nCas  = "0000";
     |FINSI;

     nCas = nCas + 1;  #105nCas  = #24#26;

     |SI nResto ! 0;
         |SI #24#4 = "D";
             #105#129 = #24#14;
             #105#133 = #24#15;
         |FINSI;

         |SI #24#4 = "I";
             #105#131 = #24#14;
             #105#135 = #24#15;
             #105#137 = #24#28;
         |FINSI;
     |SINO;
         |SI #24#4 = "D";
             #105#130 = #24#14;
             #105#134 = #24#15;
         |FINSI;

         |SI #24#4 = "I";
             #105#132 = #24#14;
             #105#136 = #24#15;
             #105#138 = #24#28;
         |FINSI;
     |FINSI;

     |GRABA 020#105a;
     |LIBERA #105;
|FPRC;

|DEFBUCLE agicen24;
     #24#1;
     4;
     #23#0, #23#1, #23#2, 01, aTipo;
     #23#0, #23#1, #23#2, 99, aTipo;
     ;
     NULL, agicen24;
|FIN;

|PROCESO agiw0105;
     |PARA nNumero = 1;  |SI nNumero [ 126;  |HACIENDO nNumero = nNumero + 1;
           aAlfa = #105nNumero;
           |HAZ QuitaRaros;
           #105nNumero = aAlfa;
           aAlfa = #105nNumero;
           |XGRABA nHandle, aAlfa;
     |SIGUE;
|FPRC;

|DEFBUCLE agiw0105;
     #105#1;
     ;
     01;
     99;
     ;
     NULL, agiw0105;
|FIN;

|PROCESO Hoja4A;
     nHay = 0;

     |ABRE #23;
     #23#0 = #20#0;
     #23#1 = #20#1;
     #23#2 = 1;
     |LEE 040#23=;
     |SI FSalida ! 0;  |DDEFECTO #23;  |FINSI;
     |CIERRA #23;

     aFichero = ("36" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #105 aFichero;
     |ABRE #105;  |CIERRA #105;  |DELINDEX #105;

     |ABRE #105;
     |DDEFECTO #105;

     #105#0   = 1;
     #105#126 = &13 + &10;
     |GRABA 020#105b;

     #105#3  = #23#6;
     #105#4  = #23#3;
     #105#5  = #23#5;
     #105#6  = #23#7;
     #105#7  = #23#9;
     |SI #23#10 ! "01.01.0000";
         #105#8  = #23#10 % 102;
         #105#9  = #23#10 % 402;
         #105#10 = #23#10 % -104;
     |FINSI;
     #105#11  = #23#12;
     |SI #23#13 ! "01.01.0000";
         #105#12 = #23#13 % 102;
         #105#13 = #23#13 % 402;
         #105#14 = #23#13 % -104;
     |FINSI;
     #105#15  = #23#14;
     #105#16  = #23#15;
     #105#17  = (("00" + #23#16) % -102);

     #105#127 = #23#8;
     #105#128 = #23#17;

     |GRABA 020#105a;
     |LIBERA #105;

     nConta = 0;  aTipo = "D";  |BUCLE agicen24;
     nConta = 0;  aTipo = "I";  |BUCLE agicen24;
     |CIERRA #105;

     |SI #0#0 = 2;
         |BUCLE agiw0105;
     |FINSI;

     |SI #0#0 = 1;
         |ABRE #105;
         #105#0 = 1;
         |LEE 040#105=;
         |SI FSalida ! 0;
             |CIERRA #105;
             |DELINDEX #105;
             |ACABA;
         |FINSI;
         |CIERRA #105;

         nCasilla = 548;   aValor = #105#3;             |HAZ GrabaPdf;
         nCasilla = 549;   aValor = #105#5;             |HAZ GrabaPdf;
         nCasilla = 550;   aValor = #105#4;             |HAZ GrabaPdf;
         nCasilla = 551;   aValor = #105#127;           |HAZ GrabaPdf;
         nCasilla = 552;   aValor = #105#6;             |HAZ GrabaPdf;

         |SI #105#7  = "S";     nCasilla = 94;  aValor = aSi;     |HAZ GrabaPdf;  |FINSI;
         |SI #105#8  ! "00";    nCasilla = 553; aValor = #105#8;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#9  ! "00";    nCasilla = 554; aValor = #105#9;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#10 ! "0000";  nCasilla = 555; aValor = #105#10; |HAZ GrabaPdf;  |FINSI;

         |SI #105#11 = "S";     nCasilla = 95;  aValor = aSi;     |HAZ GrabaPdf;  |FINSI;
         |SI #105#12 ! "00";    nCasilla = 557; aValor = #105#12; |HAZ GrabaPdf;  |FINSI;
         |SI #105#13 ! "00";    nCasilla = 558; aValor = #105#13; |HAZ GrabaPdf;  |FINSI;
         |SI #105#14 ! "0000";  nCasilla = 559; aValor = #105#14; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 560;   aValor = #105#15;             |HAZ GrabaPdf;

         nCasilla = 561;   aValor = #105#16;             |HAZ GrabaPdf;
         nCasilla = 563;   aValor = #105#128;            |HAZ GrabaPdf;
         |SI #105#17 ! "00";    nCasilla = 564; aValor = #105#17; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 565;   aValor = #105#19;             |HAZ GrabaPdf;
         nCasilla = 566;   aValor = #105#20 % 102;       |HAZ GrabaPdf;
         nCasilla = 567;   aValor = #105#21;             |HAZ GrabaPdf;
         |SI #105#22 ! "00000";  nCasilla = 568;   nNume  = #105#22; aValor = nNume;  |HAZ GrabaPdf;  |FINSI;
         nCasilla = 569;   aValor = #105#23;             |HAZ GrabaPdf;
         nCasilla = 570;   aValor = #105#24;             |HAZ GrabaPdf;
         |SI #105#25 ! "00000";  nCasilla = 571; aValor = #105#25; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 572;   aValor = #105#26;             |HAZ GrabaPdf;
         nCasilla = 574;   aValor = #105#129;            |HAZ GrabaPdf;
         |SI #105#27 ! "00";    nCasilla = 575; aValor = #105#27; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 576;   aValor = #105#133;            |HAZ GrabaPdf;
         |SI #105#29 ! "0000000";  nCasilla = 577;   nNume  = #105#29; aValor = nNume;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#30 ! "000";      nCasilla = 578;   nNume  = #105#30; aValor = nNume;  |HAZ GrabaPdf;  |FINSI;

         |SI #105#31 = "S";     nCasilla = 96;  aValor = aSi;     |HAZ GrabaPdf;  |FINSI;
         |SI #105#32 ! "00";    nCasilla = 579; aValor = #105#32;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#33 ! "00";    nCasilla = 580; aValor = #105#33;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#34 ! "0000";  nCasilla = 581; aValor = #105#34; |HAZ GrabaPdf;  |FINSI;

         |SI #105#35 = "S";     nCasilla = 97;  aValor = aSi;     |HAZ GrabaPdf;  |FINSI;
         |SI #105#36 ! "00";    nCasilla = 583; aValor = #105#36;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#37 ! "00";    nCasilla = 584; aValor = #105#37;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#38 ! "0000";  nCasilla = 585; aValor = #105#38; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 586;   aValor = #105#39;             |HAZ GrabaPdf;

         |SI #105#40 = "S";     nCasilla = 98;  aValor = aSi;     |HAZ GrabaPdf;  |FINSI;
         |SI #105#41 ! "00";    nCasilla = 587; aValor = #105#41;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#42 ! "00";    nCasilla = 588; aValor = #105#42;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#43 ! "0000";  nCasilla = 589; aValor = #105#43; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 590;   aValor = #105#44;             |HAZ GrabaPdf;

         nCasilla = 591;   aValor = #105#45;             |HAZ GrabaPdf;
         nCasilla = 592;   aValor = #105#46 % 102;       |HAZ GrabaPdf;
         nCasilla = 593;   aValor = #105#47;             |HAZ GrabaPdf;
         |SI #105#48 ! "00000";  nCasilla = 594;   nNume  = #105#48; aValor = nNume;  |HAZ GrabaPdf;  |FINSI;
         nCasilla = 595;   aValor = #105#49;             |HAZ GrabaPdf;
         nCasilla = 596;   aValor = #105#50;             |HAZ GrabaPdf;
         |SI #105#51 ! "00000";  nCasilla = 597; aValor = #105#51; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 598;   aValor = #105#52;             |HAZ GrabaPdf;
         nCasilla = 600;   aValor = #105#130;            |HAZ GrabaPdf;
         |SI #105#53 ! "00";    nCasilla = 601; aValor = #105#53; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 602;   aValor = #105#134;            |HAZ GrabaPdf;
         |SI #105#55 ! "0000000";  nCasilla = 603;   nNume  = #105#55; aValor = nNume;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#56 ! "000";      nCasilla = 604;   nNume  = #105#56; aValor = nNume;  |HAZ GrabaPdf;  |FINSI;

         |SI #105#57 = "S";     nCasilla = 99;  aValor = aSi;      |HAZ GrabaPdf;  |FINSI;
         |SI #105#58 ! "00";    nCasilla = 605; aValor = #105#58;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#59 ! "00";    nCasilla = 606; aValor = #105#59;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#60 ! "0000";  nCasilla = 607; aValor = #105#60;  |HAZ GrabaPdf;  |FINSI;

         |SI #105#61 = "S";     nCasilla = 100; aValor = aSi;      |HAZ GrabaPdf;  |FINSI;
         |SI #105#62 ! "00";    nCasilla = 609; aValor = #105#62;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#63 ! "00";    nCasilla = 610; aValor = #105#63;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#64 ! "0000";  nCasilla = 611; aValor = #105#64;  |HAZ GrabaPdf;  |FINSI;
         nCasilla = 612;   aValor = #105#65;             |HAZ GrabaPdf;

         |SI #105#66 = "S";     nCasilla = 101; aValor = aSi;     |HAZ GrabaPdf;  |FINSI;
         |SI #105#67 ! "00";    nCasilla = 613; aValor = #105#67;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#68 ! "00";    nCasilla = 614; aValor = #105#68;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#69 ! "0000";  nCasilla = 615; aValor = #105#69; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 616;   aValor = #105#70;             |HAZ GrabaPdf;

         nCasilla = 617;   aValor = #105#71;             |HAZ GrabaPdf;
         nCasilla = 618;   aValor = #105#72 % 102;       |HAZ GrabaPdf;
         nCasilla = 619;   aValor = #105#73;             |HAZ GrabaPdf;
         |SI #105#74 ! "00000";  nCasilla = 620;   nNume  = #105#74; aValor = nNume;  |HAZ GrabaPdf;  |FINSI;
         nCasilla = 621;   aValor = #105#75;             |HAZ GrabaPdf;
         nCasilla = 622;   aValor = #105#76;             |HAZ GrabaPdf;
         |SI #105#77 ! "00000";  nCasilla = 623; aValor = #105#77; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 624;   aValor = #105#78;             |HAZ GrabaPdf;
         nCasilla = 626;   aValor = #105#131;            |HAZ GrabaPdf;
         |SI #105#53 ! "00";    nCasilla = 627; aValor = #105#79; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 628;   aValor = #105#135;            |HAZ GrabaPdf;
         |SI #105#81 ! "0000000";  nCasilla = 629;   nNume  = #105#81;  aValor = nNume;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#82 ! "000";      nCasilla = 630;   nNume  = #105#82;  aValor = nNume;  |HAZ GrabaPdf;  |FINSI;
         nCasilla = 931;   aValor = #105#137;            |HAZ GrabaPdf;
         nCasilla = 932;   aValor = #105#83;             |HAZ GrabaPdf;

         |SI #105#84 = "S";     nCasilla = 102; aValor = aSi;      |HAZ GrabaPdf;  |FINSI;
         |SI #105#85 ! "00";    nCasilla = 631; aValor = #105#85;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#86 ! "00";    nCasilla = 632; aValor = #105#86;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#87 ! "0000";  nCasilla = 633; aValor = #105#87;  |HAZ GrabaPdf;  |FINSI;

         |SI #105#88 = "S";     nCasilla = 103; aValor = aSi;      |HAZ GrabaPdf;  |FINSI;
         |SI #105#89 ! "00";    nCasilla = 635; aValor = #105#89;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#90 ! "00";    nCasilla = 636; aValor = #105#90;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#91 ! "0000";  nCasilla = 637; aValor = #105#91;  |HAZ GrabaPdf;  |FINSI;
         nCasilla = 638;   aValor = #105#92;             |HAZ GrabaPdf;

         |SI #105#93 = "S";     nCasilla = 104; aValor = aSi;      |HAZ GrabaPdf;  |FINSI;
         |SI #105#94 ! "00";    nCasilla = 639; aValor = #105#94;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#95 ! "00";    nCasilla = 640; aValor = #105#95;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#96 ! "0000";  nCasilla = 641; aValor = #105#96;  |HAZ GrabaPdf;  |FINSI;
         nCasilla = 642;   aValor = #105#97;             |HAZ GrabaPdf;

         nCasilla = 643;   aValor = #105#98;             |HAZ GrabaPdf;
         nCasilla = 644;   aValor = #105#99 % 102;       |HAZ GrabaPdf;
         nCasilla = 645;   aValor = #105#100;            |HAZ GrabaPdf;
         |SI #105#101 ! "00000";  nCasilla = 646;   nNume  = #105#101; aValor = nNume;  |HAZ GrabaPdf;  |FINSI;
         nCasilla = 647;   aValor = #105#102;            |HAZ GrabaPdf;
         nCasilla = 648;   aValor = #105#103;            |HAZ GrabaPdf;
         |SI #105#104 ! "00000";  nCasilla = 649; aValor = #105#104; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 650;   aValor = #105#105;            |HAZ GrabaPdf;
         nCasilla = 652;   aValor = #105#132;            |HAZ GrabaPdf;
         |SI #105#106 ! "00";    nCasilla = 653; aValor = #105#106; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 654;   aValor = #105#136;            |HAZ GrabaPdf;
         |SI #105#108 ! "0000000";  nCasilla = 655;   nNume  = #105#108;  aValor = nNume;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#109 ! "000";      nCasilla = 656;   nNume  = #105#109;  aValor = nNume;  |HAZ GrabaPdf;  |FINSI;

         nCasilla = 930;   aValor = #105#138;            |HAZ GrabaPdf;
         nCasilla = 1136;  aValor = #105#110;            |HAZ GrabaPdf;

         |SI #105#111 = "S";     nCasilla = 105; aValor = aSi;      |HAZ GrabaPdf;  |FINSI;
         |SI #105#112 ! "00";    nCasilla = 657; aValor = #105#112;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#113 ! "00";    nCasilla = 658; aValor = #105#113;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#114 ! "0000";  nCasilla = 659; aValor = #105#114;  |HAZ GrabaPdf;  |FINSI;

         |SI #105#115 = "S";     nCasilla = 106; aValor = aSi;       |HAZ GrabaPdf;  |FINSI;
         |SI #105#116 ! "00";    nCasilla = 661; aValor = #105#116;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#117 ! "00";    nCasilla = 662; aValor = #105#117;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#118 ! "0000";  nCasilla = 663; aValor = #105#118;  |HAZ GrabaPdf;  |FINSI;
         nCasilla = 664;   aValor = #105#119;             |HAZ GrabaPdf;

         |SI #105#120 = "S";     nCasilla = 107; aValor = aSi;      |HAZ GrabaPdf;  |FINSI;
         |SI #105#121 ! "00";    nCasilla = 665; aValor = #105#121; |HAZ GrabaPdf;  |FINSI;
         |SI #105#122 ! "00";    nCasilla = 666; aValor = #105#122; |HAZ GrabaPdf;  |FINSI;
         |SI #105#123 ! "0000";  nCasilla = 667; aValor = #105#123; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 668;   aValor = #105#124;             |HAZ GrabaPdf;
     |FINSI;

     |DELINDEX #105;
|FPRC;

|PROCESO agicen23;
     nHay = 1;
     |LEE 040#105u;
     |SI FSalida = 0;
         nHay = #105#0 + 1;
     |FINSI;

     |DDEFECTO #105;
     #105#0  = nHay;
     |SI #105#0 ! 1;  #105#2 = "C";  |FINSI;

     #105#1  = "<T03604B>";
     #105#3  = #23#6;
     #105#4  = #23#3;
     #105#5  = #23#5;
     #105#6  = #23#7;
     #105#7  = #23#9;
     |SI #23#10 ! "01.01.0000";
         #105#8  = #23#10 % 102;
         #105#9  = #23#10 % 402;
         #105#10 = #23#10 % -104;
     |FINSI;
     #105#11  = #23#12;
     |SI #23#13 ! "01.01.0000";
         #105#12 = #23#13 % 102;
         #105#13 = #23#13 % 402;
         #105#14 = #23#13 % -104;
     |FINSI;
     #105#15  = #23#14;
     #105#16  = #23#15;
     #105#17  = (("00" + #23#16) % -102);
     #105#125 = "</T03604B>";
     #105#126 = &13 + &10;
     #105#127 = #23#8;
     #105#128 = #23#17;

     |GRABA 020#105n;
     |LIBERA #105;

     nConta = 0;  aTipo = "D";  |BUCLE agicen24;
     nConta = 0;  aTipo = "I";  |BUCLE agicen24;
|FPRC;

|DEFBUCLE agicen23;
     #23#1;
     ;
     #20#0, #20#1, 02;
     #20#0, #20#1, 99;
     ;
     NULL, agicen23;
|FIN;

|PROCESO Hoja4B;
     aFichero = ("36" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #105 aFichero;
     |ABRE #105;  |CIERRA #105;  |DELINDEX #105;

     |ABRE #105;
     nHay = 0;
     |BUCLE agicen23;

     |SI nHay = 0;
         |DDEFECTO #105;
         #105#0   = 1;
         #105#1   = "<T03604B>";
         #105#125 = "</T03604B>";
         #105#126 = &13 + &10;
         |GRABA 020#105n;
     |FINSI;
     |CIERRA #105;

     |SI #0#0 = 2;
         |BUCLE agiw0105;
     |FINSI;

     |SI #0#0 = 1;  |Y nHay ! 0;
         |ABRE #105;
         #105#0 = 1;
         |LEE 040#105=;
         |SI FSalida ! 0;  |DDEFECTO #105;  |FINSI;
         |CIERRA #105;

         nCasilla = 683;   aValor = #105#3;             |HAZ GrabaPdf;
         nCasilla = 684;   aValor = #105#5;             |HAZ GrabaPdf;
         nCasilla = 685;   aValor = #105#4;             |HAZ GrabaPdf;
         nCasilla = 686;   aValor = #105#127;           |HAZ GrabaPdf;
         nCasilla = 687;   aValor = #105#6;             |HAZ GrabaPdf;

         |SI #105#7  = "S";     nCasilla = 108; aValor = aSi;     |HAZ GrabaPdf;  |FINSI;
         |SI #105#8  ! "00";    nCasilla = 688; aValor = #105#8;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#9  ! "00";    nCasilla = 689; aValor = #105#9;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#10 ! "0000";  nCasilla = 690; aValor = #105#10; |HAZ GrabaPdf;  |FINSI;

         |SI #105#11 = "S";     nCasilla = 109;  aValor = aSi;     |HAZ GrabaPdf;  |FINSI;
         |SI #105#12 ! "00";    nCasilla = 692; aValor = #105#12; |HAZ GrabaPdf;  |FINSI;
         |SI #105#13 ! "00";    nCasilla = 693; aValor = #105#13; |HAZ GrabaPdf;  |FINSI;
         |SI #105#14 ! "0000";  nCasilla = 694; aValor = #105#14; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 695;   aValor = #105#15;             |HAZ GrabaPdf;

         nCasilla = 696;   aValor = #105#16;             |HAZ GrabaPdf;
         nCasilla = 698;   aValor = #105#128;            |HAZ GrabaPdf;
         |SI #105#17 ! "00";    nCasilla = 699; aValor = #105#17; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 700;   aValor = #105#19;             |HAZ GrabaPdf;
         nCasilla = 701;   aValor = #105#20 % 102;       |HAZ GrabaPdf;
         nCasilla = 702;   aValor = #105#21;             |HAZ GrabaPdf;
         nCasilla = 703;   nNume  = #105#22; aValor = nNume;  |HAZ GrabaPdf;
         nCasilla = 704;   aValor = #105#23;             |HAZ GrabaPdf;
         nCasilla = 705;   aValor = #105#24;             |HAZ GrabaPdf;
         |SI #105#25 ! "00000";  nCasilla = 706; aValor = #105#25; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 707;   aValor = #105#26;             |HAZ GrabaPdf;
         nCasilla = 709;   aValor = #105#129;            |HAZ GrabaPdf;
         |SI #105#27 ! "00";    nCasilla = 710; aValor = #105#27; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 711;   aValor = #105#133;            |HAZ GrabaPdf;
         |SI #105#29 ! "0000000";  nCasilla = 712;   nNume  = #105#29; aValor = nNume;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#30 ! "000";      nCasilla = 713;   nNume  = #105#30; aValor = nNume;  |HAZ GrabaPdf;  |FINSI;

         |SI #105#31 = "S";     nCasilla = 110; aValor = aSi;     |HAZ GrabaPdf;  |FINSI;
         |SI #105#32 ! "00";    nCasilla = 714; aValor = #105#32;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#33 ! "00";    nCasilla = 715; aValor = #105#33;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#34 ! "0000";  nCasilla = 716; aValor = #105#34; |HAZ GrabaPdf;  |FINSI;

         |SI #105#35 = "S";     nCasilla = 111; aValor = aSi;     |HAZ GrabaPdf;  |FINSI;
         |SI #105#36 ! "00";    nCasilla = 718; aValor = #105#36;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#37 ! "00";    nCasilla = 719; aValor = #105#37;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#38 ! "0000";  nCasilla = 720; aValor = #105#38; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 721;   aValor = #105#39;             |HAZ GrabaPdf;

         |SI #105#40 = "S";     nCasilla = 112; aValor = aSi;     |HAZ GrabaPdf;  |FINSI;
         |SI #105#41 ! "00";    nCasilla = 722; aValor = #105#41;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#42 ! "00";    nCasilla = 723; aValor = #105#42;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#43 ! "0000";  nCasilla = 724; aValor = #105#43; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 725;   aValor = #105#44;             |HAZ GrabaPdf;

         nCasilla = 726;   aValor = #105#45;             |HAZ GrabaPdf;
         nCasilla = 727;   aValor = #105#46 % 102;       |HAZ GrabaPdf;
         nCasilla = 728;   aValor = #105#47;             |HAZ GrabaPdf;
         nCasilla = 729;   nNume  = #105#48; aValor = nNume;  |HAZ GrabaPdf;
         nCasilla = 739;   aValor = #105#49;             |HAZ GrabaPdf;
         nCasilla = 731;   aValor = #105#50;             |HAZ GrabaPdf;
         |SI #105#51 ! "00000";  nCasilla = 732; aValor = #105#51; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 733;   aValor = #105#52;             |HAZ GrabaPdf;
         nCasilla = 735;   aValor = #105#130;            |HAZ GrabaPdf;
         |SI #105#53 ! "00";    nCasilla = 736; aValor = #105#53; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 737;   aValor = #105#134;            |HAZ GrabaPdf;
         |SI #105#55 ! "0000000";  nCasilla = 738;   nNume  = #105#55; aValor = nNume;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#56 ! "000";      nCasilla = 739;   nNume  = #105#56; aValor = nNume;  |HAZ GrabaPdf;  |FINSI;

         |SI #105#57 = "S";     nCasilla = 113; aValor = aSi;      |HAZ GrabaPdf;  |FINSI;
         |SI #105#58 ! "00";    nCasilla = 740; aValor = #105#58;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#59 ! "00";    nCasilla = 741; aValor = #105#59;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#60 ! "0000";  nCasilla = 742; aValor = #105#60;  |HAZ GrabaPdf;  |FINSI;

         |SI #105#61 = "S";     nCasilla = 114; aValor = aSi;      |HAZ GrabaPdf;  |FINSI;
         |SI #105#62 ! "00";    nCasilla = 744; aValor = #105#62;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#63 ! "00";    nCasilla = 745; aValor = #105#63;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#64 ! "0000";  nCasilla = 746; aValor = #105#64;  |HAZ GrabaPdf;  |FINSI;
         nCasilla = 747;   aValor = #105#65;             |HAZ GrabaPdf;

         |SI #105#66 = "S";     nCasilla = 115; aValor = aSi;     |HAZ GrabaPdf;  |FINSI;
         |SI #105#67 ! "00";    nCasilla = 748; aValor = #105#67;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#68 ! "00";    nCasilla = 749; aValor = #105#68;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#69 ! "0000";  nCasilla = 750; aValor = #105#69; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 751;   aValor = #105#70;             |HAZ GrabaPdf;

         nCasilla = 752;   aValor = #105#71;             |HAZ GrabaPdf;
         nCasilla = 753;   aValor = #105#72 % 102;       |HAZ GrabaPdf;
         nCasilla = 754;   aValor = #105#73;             |HAZ GrabaPdf;
         nCasilla = 755;   nNume  = #105#74; aValor = nNume;  |HAZ GrabaPdf;
         nCasilla = 756;   aValor = #105#75;             |HAZ GrabaPdf;
         nCasilla = 757;   aValor = #105#76;             |HAZ GrabaPdf;
         |SI #105#77 ! "00000";  nCasilla = 758; aValor = #105#77; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 759;   aValor = #105#78;             |HAZ GrabaPdf;
         nCasilla = 761;   aValor = #105#131;            |HAZ GrabaPdf;
         |SI #105#53 ! "00";    nCasilla = 762; aValor = #105#79; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 763;   aValor = #105#135;            |HAZ GrabaPdf;
         |SI #105#81 ! "0000000";  nCasilla = 764;   nNume  = #105#81;  aValor = nNume;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#82 ! "000";      nCasilla = 765;   nNume  = #105#82;  aValor = nNume;  |HAZ GrabaPdf;  |FINSI;
         nCasilla = 1137;  aValor = #105#137;            |HAZ GrabaPdf;
         nCasilla = 1138;  aValor = #105#83;             |HAZ GrabaPdf;

         |SI #105#84 = "S";     nCasilla = 116; aValor = aSi;      |HAZ GrabaPdf;  |FINSI;
         |SI #105#85 ! "00";    nCasilla = 766; aValor = #105#85;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#86 ! "00";    nCasilla = 767; aValor = #105#86;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#87 ! "0000";  nCasilla = 768; aValor = #105#87;  |HAZ GrabaPdf;  |FINSI;

         |SI #105#88 = "S";     nCasilla = 117; aValor = aSi;      |HAZ GrabaPdf;  |FINSI;
         |SI #105#89 ! "00";    nCasilla = 770; aValor = #105#89;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#90 ! "00";    nCasilla = 771; aValor = #105#90;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#91 ! "0000";  nCasilla = 772; aValor = #105#91;  |HAZ GrabaPdf;  |FINSI;
         nCasilla = 773;   aValor = #105#92;             |HAZ GrabaPdf;

         |SI #105#93 = "S";     nCasilla = 118; aValor = aSi;      |HAZ GrabaPdf;  |FINSI;
         |SI #105#94 ! "00";    nCasilla = 774; aValor = #105#94;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#95 ! "00";    nCasilla = 775; aValor = #105#95;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#96 ! "0000";  nCasilla = 776; aValor = #105#96;  |HAZ GrabaPdf;  |FINSI;
         nCasilla = 777;   aValor = #105#97;             |HAZ GrabaPdf;

         nCasilla = 778;   aValor = #105#98;             |HAZ GrabaPdf;
         nCasilla = 779;   aValor = #105#99 % 102;       |HAZ GrabaPdf;
         nCasilla = 780;   aValor = #105#100;            |HAZ GrabaPdf;
         nCasilla = 781;   nNume  = #105#101; aValor = nNume;  |HAZ GrabaPdf;
         nCasilla = 782;   aValor = #105#102;            |HAZ GrabaPdf;
         nCasilla = 783;   aValor = #105#103;            |HAZ GrabaPdf;
         |SI #105#104 ! "00000";  nCasilla = 784; aValor = #105#104; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 785;   aValor = #105#105;            |HAZ GrabaPdf;
         nCasilla = 787;   aValor = #105#132;            |HAZ GrabaPdf;
         |SI #105#106 ! "00";    nCasilla = 788; aValor = #105#106; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 789;   aValor = #105#136;            |HAZ GrabaPdf;
         |SI #105#108 ! "0000000";  nCasilla = 790;   nNume  = #105#108;  aValor = nNume;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#109 ! "000";      nCasilla = 791;   nNume  = #105#109;  aValor = nNume;  |HAZ GrabaPdf;  |FINSI;

         nCasilla = 1139;  aValor = #105#138;            |HAZ GrabaPdf;
         nCasilla = 1140;  aValor = #105#110;            |HAZ GrabaPdf;

         |SI #105#111 = "S";     nCasilla = 119; aValor = aSi;      |HAZ GrabaPdf;  |FINSI;
         |SI #105#112 ! "00";    nCasilla = 792; aValor = #105#112;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#113 ! "00";    nCasilla = 793; aValor = #105#113;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#114 ! "0000";  nCasilla = 794; aValor = #105#114;  |HAZ GrabaPdf;  |FINSI;

         |SI #105#115 = "S";     nCasilla = 120; aValor = aSi;       |HAZ GrabaPdf;  |FINSI;
         |SI #105#116 ! "00";    nCasilla = 796; aValor = #105#116;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#117 ! "00";    nCasilla = 797; aValor = #105#117;  |HAZ GrabaPdf;  |FINSI;
         |SI #105#118 ! "0000";  nCasilla = 798; aValor = #105#118;  |HAZ GrabaPdf;  |FINSI;
         nCasilla = 799;   aValor = #105#119;             |HAZ GrabaPdf;

         |SI #105#120 = "S";     nCasilla = 121; aValor = aSi;      |HAZ GrabaPdf;  |FINSI;
         |SI #105#121 ! "00";    nCasilla = 800; aValor = #105#121; |HAZ GrabaPdf;  |FINSI;
         |SI #105#122 ! "00";    nCasilla = 801; aValor = #105#122; |HAZ GrabaPdf;  |FINSI;
         |SI #105#123 ! "0000";  nCasilla = 802; aValor = #105#123; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 803;   aValor = #105#124;             |HAZ GrabaPdf;
     |FINSI;

     |DELINDEX #105;
|FPRC;

|PROCESO Hoja5;
     |DDEFECTO #106;

     |PARA nCampoD = 3;  |SI nCampoD [ 73;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 64;
           #106nCampoD   = #22nCampoH;
     |SIGUE;

     |SI #22#138 ! "01.01.0000";
         #106#74 = #22#138 % 102;
         #106#75 = #22#138 % 402;
         #106#76 = #22#138 % -104;
     |FINSI;

     #106#77 = #22#139;
     |SI #22#140 ! "01.01.0000";
         #106#78 = #22#140 % 102;
         #106#79 = #22#140 % 402;
         #106#80 = #22#140 % -104;
     |FINSI;

     nNume   = #22#141;  |HAZ Conver3E2D;
     #106#81 = aAlfa;
     #106#82 = #22#142;
     #106#83 = ("000" + #22#143) % -103;
     #106#84 = ("000" + #22#144) % -103;
     #106#85 = ("000" + #22#145) % -103;
     #106#86 = #22#146;
     #106#87 = ("000" + #22#147) % -103;
     #106#88 = ("000" + #22#148) % -103;
     #106#89 = ("000" + #22#149) % -103;
     #106#90 = #22#150;
     #106#91 = ("000" + #22#151) % -103;
     #106#92 = ("000" + #22#152) % -103;
     #106#93 = ("000" + #22#153) % -103;
     #106#94 = #22#154;

     #106#96  = &13 + &10;

     |SI #0#0 = 1;
         |SI #22#67 = "S"; nCasilla = 122; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#67 = "N"; nCasilla = 123; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#68 = "S"; nCasilla = 124; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#68 = "N"; nCasilla = 125; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #22#69 = "S"; nCasilla = 126; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#69 = "N"; nCasilla = 127; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 819;    aValor = #22#70;            |HAZ GrabaPdf;
         nCasilla = 820;    aValor = #22#71;            |HAZ GrabaPdf;
         nCasilla = 821;    aValor = #22#72;            |HAZ GrabaPdf;

         |SI #22#73 = "S"; nCasilla = 128; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#73 = "N"; nCasilla = 129; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 822;    aValor = #22#74;            |HAZ GrabaPdf;
         nCasilla = 823;    aValor = #22#75;            |HAZ GrabaPdf;
         nCasilla = 824;    aValor = #22#76;            |HAZ GrabaPdf;

         |SI #22#77 = "S"; nCasilla = 130; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#77 = "N"; nCasilla = 131; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 827;    aValor = #22#78;            |HAZ GrabaPdf;
         nCasilla = 826;    aValor = #22#79;            |HAZ GrabaPdf;
         nCasilla = 825;    aValor = #22#80;            |HAZ GrabaPdf;

         |SI #22#81 = "S"; nCasilla = 132; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#81 = "N"; nCasilla = 133; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 828;    aValor = #22#82;            |HAZ GrabaPdf;
         nCasilla = 829;    aValor = #22#83;            |HAZ GrabaPdf;
         nCasilla = 830;    aValor = #22#84;            |HAZ GrabaPdf;

         |SI #22#85 = "S"; nCasilla = 134; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#85 = "N"; nCasilla = 135; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 831;    aValor = #22#86;            |HAZ GrabaPdf;
         nCasilla = 832;    aValor = #22#87;            |HAZ GrabaPdf;
         nCasilla = 833;    aValor = #22#88;            |HAZ GrabaPdf;

         |SI #22#89 = "S"; nCasilla = 136; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#89 = "N"; nCasilla = 137; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 834;    aValor = #22#90;            |HAZ GrabaPdf;
         nCasilla = 835;    aValor = #22#91;            |HAZ GrabaPdf;
         nCasilla = 836;    aValor = #22#92;            |HAZ GrabaPdf;

         |SI #22#93 = "S"; nCasilla = 138; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 837;    aValor = #22#94;            |HAZ GrabaPdf;
         nCasilla = 838;    aValor = #22#95;            |HAZ GrabaPdf;
         nCasilla = 839;    aValor = #22#96;            |HAZ GrabaPdf;

         |SI #22#97 = "S"; nCasilla = 139; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 840;    aValor = #22#98;            |HAZ GrabaPdf;
         nCasilla = 841;    aValor = #22#99;            |HAZ GrabaPdf;
         nCasilla = 842;    aValor = #22#100;           |HAZ GrabaPdf;

         |SI #22#101 = "S"; nCasilla = 140; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 843;    aValor = #22#102;            |HAZ GrabaPdf;
         nCasilla = 844;    aValor = #22#103;            |HAZ GrabaPdf;
         nCasilla = 845;    aValor = #22#104;            |HAZ GrabaPdf;

         |SI #22#105 = "S"; nCasilla = 141; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 846;    aValor = #22#106;            |HAZ GrabaPdf;
         nCasilla = 847;    aValor = #22#107;            |HAZ GrabaPdf;
         nCasilla = 848;    aValor = #22#108;            |HAZ GrabaPdf;

         |SI #22#109 = "S"; nCasilla = 142; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 849;    aValor = #22#110;            |HAZ GrabaPdf;
         nCasilla = 850;    aValor = #22#111;            |HAZ GrabaPdf;
         nCasilla = 851;    aValor = #22#112;            |HAZ GrabaPdf;

         |SI #22#113 = "S"; nCasilla = 143; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 852;    aValor = #22#114;            |HAZ GrabaPdf;
         nCasilla = 853;    aValor = #22#115;            |HAZ GrabaPdf;
         nCasilla = 854;    aValor = #22#116;            |HAZ GrabaPdf;

         |SI #22#117 = "S"; nCasilla = 144; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 855;    aValor = #22#118;            |HAZ GrabaPdf;
         nCasilla = 856;    aValor = #22#119;            |HAZ GrabaPdf;
         nCasilla = 857;    aValor = #22#120;            |HAZ GrabaPdf;

         |SI #22#121 = "S"; nCasilla = 145; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 858;    aValor = #22#122;            |HAZ GrabaPdf;
         nCasilla = 859;    aValor = #22#123;            |HAZ GrabaPdf;
         nCasilla = 860;    aValor = #22#124;            |HAZ GrabaPdf;

         |SI #22#125 = "S"; nCasilla = 147; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#125 = "N"; nCasilla = 146; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 861;    aValor = #22#126;            |HAZ GrabaPdf;
         nCasilla = 862;    aValor = #22#127;            |HAZ GrabaPdf;
         nCasilla = 863;    aValor = #22#128;            |HAZ GrabaPdf;

         |SI #22#129 = "S"; nCasilla = 148; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#129 = "N"; nCasilla = 149; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 864;    aValor = #22#130;            |HAZ GrabaPdf;
         nCasilla = 865;    aValor = #22#131;            |HAZ GrabaPdf;
         nCasilla = 866;    aValor = #22#132;            |HAZ GrabaPdf;

         |SI #22#133 = "S"; nCasilla = 151; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#133 = "N"; nCasilla = 150; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 867;    aValor = #22#134;            |HAZ GrabaPdf;
         nCasilla = 818;    aValor = #22#135;            |HAZ GrabaPdf;
         nCasilla = 868;    aValor = #22#136;            |HAZ GrabaPdf;

         |SI #22#137 = "A"; nCasilla = 152; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#137 = "B"; nCasilla = 153; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #22#138 ! "01.01.0000";
             nCasilla = 869;  aValor = #22#138 % 102;    |HAZ GrabaPdf;
             nCasilla = 870;  aValor = #22#138 % 402;    |HAZ GrabaPdf;
             nCasilla = 871;  aValor = #22#138 % -104;   |HAZ GrabaPdf;
         |FINSI;

         |SI #22#139 = "A"; nCasilla = 155; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#139 = "B"; nCasilla = 154; aValor = "2"; |HAZ GrabaPdf;  |FINSI;

         |SI #22#140 ! "01.01.0000";
             nCasilla = 872;  aValor = #22#140 % 102;    |HAZ GrabaPdf;
             nCasilla = 873;  aValor = #22#140 % 402;    |HAZ GrabaPdf;
             nCasilla = 874;  aValor = #22#140 % -104;   |HAZ GrabaPdf;
         |FINSI;

         |SI #22#141 ! 0;   nCasilla = 875; aValor = #22#141;  |HAZ GrabaPdf;  |FINSI;
         |SI #22#142 = "S"; nCasilla = 156; aValor = aSi;      |HAZ GrabaPdf;  |FINSI;
         |SI #22#142 = "N"; nCasilla = 157; aValor = aSi;      |HAZ GrabaPdf;  |FINSI;

         |SI #22#143 ! 0;   nCasilla = 877; aValor = #22#143;  |HAZ GrabaPdf;  |FINSI;
         |SI #22#144 ! 0;   nCasilla = 876; aValor = #22#144;  |HAZ GrabaPdf;  |FINSI;
         |SI #22#145 ! 0;   nCasilla = 878; aValor = #22#145;  |HAZ GrabaPdf;  |FINSI;
         |SI #22#146 = "S"; nCasilla = 158; aValor = aSi;      |HAZ GrabaPdf;  |FINSI;
         |SI #22#146 = "N"; nCasilla = 159; aValor = aSi;      |HAZ GrabaPdf;  |FINSI;

         |SI #22#147 ! 0;   nCasilla = 881; aValor = #22#147;  |HAZ GrabaPdf;  |FINSI;
         |SI #22#148 ! 0;   nCasilla = 880; aValor = #22#148;  |HAZ GrabaPdf;  |FINSI;
         |SI #22#149 ! 0;   nCasilla = 879; aValor = #22#149;  |HAZ GrabaPdf;  |FINSI;
         |SI #22#150 = "S"; nCasilla = 160; aValor = aSi;      |HAZ GrabaPdf;  |FINSI;
         |SI #22#150 = "N"; nCasilla = 161; aValor = aSi;      |HAZ GrabaPdf;  |FINSI;

         |SI #22#151 ! 0;   nCasilla = 882; aValor = #22#151;  |HAZ GrabaPdf;  |FINSI;
         |SI #22#152 ! 0;   nCasilla = 883; aValor = #22#152;  |HAZ GrabaPdf;  |FINSI;
         |SI #22#153 ! 0;   nCasilla = 884; aValor = #22#153;  |HAZ GrabaPdf;  |FINSI;
         |SI #22#154 = "S"; nCasilla = 162; aValor = "2";      |HAZ GrabaPdf;  |FINSI;
         |SI #22#154 = "N"; nCasilla = 163; aValor = aSi;      |HAZ GrabaPdf;  |FINSI;
     |FINSI;

     |SI #0#0 = 2;
         |PARA nNumero = 1;  |SI nNumero [ 96;  |HACIENDO nNumero = nNumero + 1;
               aAlfa = #106nNumero;
               |HAZ QuitaRaros;
               #106nNumero = aAlfa;
               aAlfa = #106nNumero;
               |XGRABA nHandle, aAlfa;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Hoja6;
     |DDEFECTO #107;

     |PARA nCampoD = 3;  |SI nCampoD [ 40;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 152;
           #107nCampoD   = #22nCampoH;
     |SIGUE;

     |SI #22#193 ! "01.01.0000";
         #107#41 = #22#193 % 102;
         #107#42 = #22#193 % 402;
         #107#43 = #22#193 % -104;
     |FINSI;

     |PARA nCampoD = 44;  |SI nCampoD [ 55;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 150;
           #107nCampoD   = #22nCampoH;
     |SIGUE;

     |SI #22#206 ! "01.01.0000";
         #107#56 = #22#206 % 102;
         #107#57 = #22#206 % 402;
         #107#58 = #22#206 % -104;
     |FINSI;

     #107#59 = #22#207;
     #107#61 = &13 + &10;

     |SI #0#0 = 1;
         |SI #22#155 = "S"; nCasilla = 198;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#155 = "N"; nCasilla = 164;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#156 = "S"; nCasilla = 165;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#156 = "N"; nCasilla = 166;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 13;     aValor = #22#157;            |HAZ GrabaPdf;
         nCasilla = 885;    aValor = #22#158;            |HAZ GrabaPdf;

         |SI #22#159 = "S"; nCasilla = 171; aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#160 = "S"; nCasilla = 172; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#161 = "S"; nCasilla = 168; aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#162 = "S"; nCasilla = 167; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #22#163 = "S"; nCasilla = 175; aValor = "2"; |HAZ GrabaPdf;  |FINSI;

         |SI #22#164 = "S"; nCasilla = 173; aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#165 = "S"; nCasilla = 174; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #22#166 = "S"; nCasilla = 170; aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#167 = "S"; nCasilla = 169; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         nCasilla = 886;

         |SI #22#168 ! " ";  |O #22#169 ! "    ";  |O #22#170 ! "   ";
             aValor   = "(" + #22#168 + " " + #22#169 + " " + #22#170 + ")";
         |FINSI;

         |SI #22#171 ! " ";  |O #22#172 ! "    ";  |O #22#173 ! "   ";
             aValor   = aValor + ", (" + #22#171 + " " + #22#172 + " " + #22#173 + ")";
         |FINSI;

         |SI #22#174 ! " ";  |O #22#175 ! "    ";  |O #22#176 ! "   ";
             aValor   = aValor + ", (" + #22#174 + " " + #22#175 + " " + #22#176 + ")";
         |FINSI;

         |SI #22#177 ! " ";  |O #22#178 ! "    ";  |O #22#179 ! "   ";
             aValor   = aValor + ", (" + #22#177 + " " + #22#178 + " " + #22#179 + ")";
         |FINSI;

         |HAZ GrabaPdf;

         nCasilla = 887;

         |SI #22#180 ! " ";  |O #22#181 ! "    ";  |O #22#182 ! "   ";
             aValor   = "(" + #22#180 + " " + #22#181 + " " + #22#182 + ")";
         |FINSI;

         |SI #22#183 ! " ";  |O #22#184 ! "    ";  |O #22#185 ! "   ";
             aValor   = aValor + ", (" + #22#183 + " " + #22#184 + " " + #22#185 + ")";
         |FINSI;

         |SI #22#186 ! " ";  |O #22#187 ! "    ";  |O #22#188 ! "   ";
             aValor   = aValor + ", (" + #22#186 + " " + #22#187 + " " + #22#188 + ")";
         |FINSI;

         |SI #22#189 ! " ";  |O #22#190 ! "    ";  |O #22#191 ! "   ";
             aValor   = aValor + ", (" + #22#189 + " " + #22#190 + " " + #22#191 + ")";
         |FINSI;

         |HAZ GrabaPdf;

         |SI #22#192 = "S"; nCasilla = 176; aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#192 = "N"; nCasilla = 179; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #22#194 = "S"; nCasilla = 177; aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#194 = "N"; nCasilla = 178; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #22#195 = "S"; nCasilla = 180; aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#195 = "N"; nCasilla = 181; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #22#196 = "S"; nCasilla = 188; aValor = "2"; |HAZ GrabaPdf;  |FINSI;

         |SI #22#197 = "S"; nCasilla = 187; aValor = "2"; |HAZ GrabaPdf;  |FINSI;

         |SI #22#198 = "S"; nCasilla = 186; aValor = "2"; |HAZ GrabaPdf;  |FINSI;

         |SI #22#199 = "S"; nCasilla = 182; aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#199 = "N"; nCasilla = 185; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #22#200 = "S"; nCasilla = 183; aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#200 = "N"; nCasilla = 184; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #22#201 = "S"; nCasilla = 191; aValor = "2"; |HAZ GrabaPdf;  |FINSI;

         |SI #22#202 = "S"; nCasilla = 190; aValor = "2"; |HAZ GrabaPdf;  |FINSI;

         |SI #22#203 = "S"; nCasilla = 189; aValor = "2"; |HAZ GrabaPdf;  |FINSI;

         |SI #22#204 = "S"; nCasilla = 192; aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#204 = "N"; nCasilla = 193; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #22#205 = "S"; nCasilla = 194; aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#205 = "N"; nCasilla = 195; aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #22#207 = "S"; nCasilla = 196; aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#207 = "N"; nCasilla = 197; aValor = aSi; |HAZ GrabaPdf;  |FINSI;
     |FINSI;

     |SI #0#0 = 2;
         |PARA nNumero = 1;  |SI nNumero [ 61;  |HACIENDO nNumero = nNumero + 1;
               aAlfa = #107nNumero;
               |HAZ QuitaRaros;
               #107nNumero = aAlfa;
               aAlfa = #107nNumero;
               |XGRABA nHandle, aAlfa;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Hoja7;
     |DDEFECTO #108;

     |PARA nCampoD = 3;  |SI nCampoD [ 13;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 205;
           #108nCampoD   = #22nCampoH;
     |SIGUE;

     #108#15 = &13 + &10;

     |SI #0#0 = 1;
         |SI #22#208 = "S"; nCasilla = 199;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#208 = "N"; nCasilla = 202;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #22#209 = "S"; nCasilla = 200;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#209 = "N"; nCasilla = 201;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #22#210 = "S"; nCasilla = 203;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#210 = "N"; nCasilla = 204;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #22#211 = "S"; nCasilla = 205;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#211 = "N"; nCasilla = 206;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #22#212 = "S"; nCasilla = 207;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#212 = "N"; nCasilla = 208;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #22#213 = "S"; nCasilla = 209;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#213 = "N"; nCasilla = 210;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #22#214 = "S"; nCasilla = 211;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#214 = "N"; nCasilla = 212;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #22#215 = "S"; nCasilla = 213;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#215 = "N"; nCasilla = 214;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #22#216 = "S"; nCasilla = 215;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#216 = "N"; nCasilla = 216;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #22#217 = "S"; nCasilla = 217;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#217 = "N"; nCasilla = 218;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #22#218 = "S"; nCasilla = 219;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #22#218 = "N"; nCasilla = 220;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;
     |FINSI;

     |SI #0#0 = 2;
         |PARA nNumero = 1;  |SI nNumero [ 15;  |HACIENDO nNumero = nNumero + 1;
               aAlfa = #108nNumero;
               |HAZ QuitaRaros;
               #108nNumero = aAlfa;
               aAlfa = #108nNumero;
               |XGRABA nHandle, aAlfa;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO agicen25;
     |SI nSocio = 3;  nSocio = 0;  |FINSI;

     nConta = nConta + 1;
     nSocio = nSocio + 1;

     |SI nSocio = 1; nCas = 3;   |FINSI;
     |SI nSocio = 2; nCas = 24;  |FINSI;
     |SI nSocio = 3; nCas = 45;  |FINSI;

     #109#0   = ((nConta / 3) + .49) ! 0;
     |LEE 101#109=;
     |SI FSalida ! 0;
         |DDEFECTO #109;
         #109#0   = ((nConta / 3) + .49) ! 0;
         |SI #109#0 ! 1;  #109#2 = "C";  |FINSI;
         |GRABA 020#109b;
     |FINSI;

                        #109nCas = #25#3;
     nCas = nCas + 1;   #109nCas = #25#4;
                        aSigla   = #25#5;  |HAZ LeeSigla;
                        aAlfa    = #25#5 + " " + aSigla;
     nCas = nCas + 1;   #109nCas = aAlfa;
     nCas = nCas + 1;   #109nCas = #25#6;
                        nNume    = #25#7;
                        aAlfa    = ("00000" + nNume) % -105;
     nCas = nCas + 1;   #109nCas = aAlfa;
     nCas = nCas + 1;   #109nCas = #25#8;
     nCas = nCas + 1;   #109nCas = #25#9;
     nCas = nCas + 1;   #109nCas = #25#10;
                        nNume    = #25#11;
                        aAlfa    = ("000000000" + nNume) % -109;
     nCas = nCas + 1;   #109nCas = aAlfa;
                        aAlfa    = (("00" + #25#12) % -102) + (("000" + #25#13) % -103);
     nCas = nCas + 1;   #109nCas = aAlfa;
     nCas = nCas + 1;   #109nCas = #25#14;
                        aAlfa    = ("00" + #25#12) % -102;
     nCas = nCas + 1;   #109nCas = aAlfa;
     nCas = nCas + 1;   #109nCas = "000000";
     nCas = nCas + 1;   #109nCas = #25#16;
     nCas = nCas + 1;   #109nCas = #25#18;
     nCas = nCas + 1;   #109nCas = #25#19;
                        nNume    = #25#21;  |HAZ Conver3E2D;
     nCas = nCas + 1;   #109nCas = aAlfa;
     nCas = nCas + 1;   #109nCas = #25#22;
     nCas = nCas + 1;   #109nCas = #25#23;
     nCas = nCas + 1;   #109nCas = #25#24;
     nCas = nCas + 1;   #109nCas = #25#25;

     |SI nSocio = 1;
         #109#68 = #25#15;
         #109#71 = #25#17;
         #109#74 = #25#20;
     |FINSI;

     |SI nSocio = 2;
         #109#69 = #25#15;
         #109#72 = #25#17;
         #109#75 = #25#20;
     |FINSI;

     |SI nSocio = 3;
         #109#70 = #25#15;
         #109#73 = #25#17;
         #109#76 = #25#20;
     |FINSI;

     #109#67  = &13 + &10;

     |GRABA 020#109a;
     |LIBERA #109;
|FPRC;

|DEFBUCLE agicen25;
     #25#1;
     ;
     #20#0, #20#1, 01;
     #20#0, #20#1, 99;
     ;
     NULL, agicen25;
|FIN;

|PROCESO agiw0109;
     |PARA nNumero = 1;  |SI nNumero [ 67;  |HACIENDO nNumero = nNumero + 1;
           aAlfa = #109nNumero;
           |HAZ QuitaRaros;
           #109nNumero = aAlfa;
           aAlfa = #109nNumero;
           |XGRABA nHandle, aAlfa;
     |SIGUE;
|FPRC;

|DEFBUCLE agiw0109;
     #109#1;
     ;
     01;
     99;
     ;
     NULL, agiw0109;
|FIN;

|PROCESO Hoja8;
     aFichero = ("36" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #109 aFichero;
     |ABRE #109;  |CIERRA #109;  |DELINDEX #109;

     |ABRE #109;
     nSocio = 0;
     nConta = 0;
     |BUCLE agicen25;
     |CIERRA #109;

     |SI #0#0 = 2;
         |BUCLE agiw0109;
     |FINSI;

     |SI #0#0 = 1;
         |ABRE #109;
         #109#0 = 1;
         |LEE 040#109=;
         |SI FSalida ! 0;
             |CIERRA #109;
             |DELINDEX #109;
             |ACABA;
         |FINSI;
         |CIERRA #109;

         nCasilla = 14;    aValor = #109#3;             |HAZ GrabaPdf;
         nCasilla = 889;   aValor = #109#4;             |HAZ GrabaPdf;
         nCasilla = 890;   aValor = #109#5 % 102;       |HAZ GrabaPdf;
         nCasilla = 891;   aValor = #109#6;             |HAZ GrabaPdf;
         nCasilla = 892;   aValor = #109#7;             |HAZ GrabaPdf;
         nCasilla = 893;   aValor = #109#8;             |HAZ GrabaPdf;
         nCasilla = 894;   aValor = #109#9;             |HAZ GrabaPdf;
         nCasilla = 895;   aValor = #109#10;            |HAZ GrabaPdf;
         |SI #109#11 ! "000000000"; nCasilla = 1134; aValor = #109#11; |HAZ GrabaPdf;|FINSI;
         |SI #109#12 ! "00000";     nCasilla = 1135; aValor = #109#12; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 896;   aValor = #109#13;            |HAZ GrabaPdf;
         nCasilla = 897;   aValor = #109#68;            |HAZ GrabaPdf;
         |SI #109#14 ! "00";     nCasilla = 1033; aValor = #109#14; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 898;   aValor = #109#71;            |HAZ GrabaPdf;

         |SI #109#17 = "S";  nCasilla = 221;  aValor = "2";     |HAZ GrabaPdf;  |FINSI;
         |SI #109#17 = "N";  nCasilla = 222;  aValor = aSi;     |HAZ GrabaPdf;  |FINSI;

         nCasilla = 899;   aValor = #109#74;            |HAZ GrabaPdf;

         |SI #109#19 ! "00000";
             nCasilla = 900; aValor = ((#109#19 % 103) + "," + (#109#19 % 402)) % -105; |HAZ GrabaPdf;
         |FINSI;

         |SI #109#20 = "S";  nCasilla = 224;  aValor = "2";     |HAZ GrabaPdf;  |FINSI;
         |SI #109#20 = "N";  nCasilla = 223;  aValor = aSi;     |HAZ GrabaPdf;  |FINSI;

         |SI #109#21 = "S";  nCasilla = 229;  aValor = "2";     |HAZ GrabaPdf;  |FINSI;
         |SI #109#21 = "N";  nCasilla = 230;  aValor = aSi;     |HAZ GrabaPdf;  |FINSI;

         |SI #109#22 = "S";  nCasilla = 225;  aValor = "2";     |HAZ GrabaPdf;  |FINSI;
         |SI #109#22 = "N";  nCasilla = 226;  aValor = aSi;     |HAZ GrabaPdf;  |FINSI;

         |SI #109#23 = "S";  nCasilla = 227;  aValor = "2";     |HAZ GrabaPdf;  |FINSI;
         |SI #109#23 = "N";  nCasilla = 228;  aValor = aSi;     |HAZ GrabaPdf;  |FINSI;


         nCasilla = 15;    aValor = #109#24;            |HAZ GrabaPdf;
         nCasilla = 910;   aValor = #109#25;            |HAZ GrabaPdf;
         nCasilla = 914;   aValor = #109#26 % 102;      |HAZ GrabaPdf;
         nCasilla = 911;   aValor = #109#27;            |HAZ GrabaPdf;
         nCasilla = 909;   aValor = #109#28;            |HAZ GrabaPdf;
         nCasilla = 908;   aValor = #109#29;            |HAZ GrabaPdf;
         nCasilla = 907;   aValor = #109#30;            |HAZ GrabaPdf;
         nCasilla = 906;   aValor = #109#31;            |HAZ GrabaPdf;
         |SI #109#32 ! "000000000";  nCasilla = 905;   aValor = #109#32; |HAZ GrabaPdf;  |FINSI;
         |SI #109#33 ! "00000";      nCasilla = 913;   aValor = #109#33; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 912;   aValor = #109#34;            |HAZ GrabaPdf;
         nCasilla = 904;   aValor = #109#69;            |HAZ GrabaPdf;
         |SI #109#35 ! "00";     nCasilla = 1035; aValor = #109#35; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 901;   aValor = #109#72;            |HAZ GrabaPdf;

         |SI #109#38 = "S";  nCasilla = 239;  aValor = "2";     |HAZ GrabaPdf;  |FINSI;
         |SI #109#38 = "N";  nCasilla = 240;  aValor = aSi;     |HAZ GrabaPdf;  |FINSI;

         nCasilla = 902;   aValor = #109#75;            |HAZ GrabaPdf;

         |SI #109#40 ! "00000";
             nCasilla = 903; aValor = ((#109#40 % 103) + "," + (#109#40 % 402)) % -105; |HAZ GrabaPdf;
         |FINSI;

         |SI #109#41 = "S";  nCasilla = 237;  aValor = "2";     |HAZ GrabaPdf;  |FINSI;
         |SI #109#41 = "N";  nCasilla = 238;  aValor = aSi;     |HAZ GrabaPdf;  |FINSI;

         |SI #109#42 = "S";  nCasilla = 233;  aValor = "2";     |HAZ GrabaPdf;  |FINSI;
         |SI #109#42 = "N";  nCasilla = 231;  aValor = aSi;     |HAZ GrabaPdf;  |FINSI;

         |SI #109#43 = "S";  nCasilla = 236;  aValor = "2";     |HAZ GrabaPdf;  |FINSI;
         |SI #109#43 = "N";  nCasilla = 235;  aValor = aSi;     |HAZ GrabaPdf;  |FINSI;

         |SI #109#44 = "S";  nCasilla = 232;  aValor = "2";     |HAZ GrabaPdf;  |FINSI;
         |SI #109#44 = "N";  nCasilla = 234;  aValor = aSi;     |HAZ GrabaPdf;  |FINSI;


         nCasilla = 16;    aValor = #109#45;            |HAZ GrabaPdf;
         nCasilla = 924;   aValor = #109#46;            |HAZ GrabaPdf;
         nCasilla = 928;   aValor = #109#47 % 102;      |HAZ GrabaPdf;
         nCasilla = 925;   aValor = #109#48;            |HAZ GrabaPdf;
         nCasilla = 923;   aValor = #109#49;            |HAZ GrabaPdf;
         nCasilla = 922;   aValor = #109#50;            |HAZ GrabaPdf;
         nCasilla = 921;   aValor = #109#51;            |HAZ GrabaPdf;
         nCasilla = 920;   aValor = #109#52;            |HAZ GrabaPdf;
         |SI #109#53 ! "000000000";  nCasilla = 919;  aValor = #109#53; |HAZ GrabaPdf;  |FINSI;
         |SI #109#54 ! "00000";      nCasilla = 927;  aValor = #109#54; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 926;   aValor = #109#55;            |HAZ GrabaPdf;
         nCasilla = 918;   aValor = #109#70;            |HAZ GrabaPdf;
         |SI #109#56 ! "00";     nCasilla = 1037; aValor = #109#56; |HAZ GrabaPdf;  |FINSI;
         nCasilla = 915;   aValor = #109#73;            |HAZ GrabaPdf;

         |SI #109#59 = "S";  nCasilla = 249;  aValor = "2";     |HAZ GrabaPdf;  |FINSI;
         |SI #109#59 = "N";  nCasilla = 250;  aValor = aSi;     |HAZ GrabaPdf;  |FINSI;

         nCasilla = 916;   aValor = #109#76;            |HAZ GrabaPdf;

         |SI #109#61 ! "00000";
             nCasilla = 917; aValor = ((#109#61 % 103) + "," + (#109#61 % 402)) % -105; |HAZ GrabaPdf;
         |FINSI;

         |SI #109#62 = "S";  nCasilla = 247;  aValor = "2";     |HAZ GrabaPdf;  |FINSI;
         |SI #109#62 = "N";  nCasilla = 248;  aValor = aSi;     |HAZ GrabaPdf;  |FINSI;

         |SI #109#63 = "S";  nCasilla = 243;  aValor = "2";     |HAZ GrabaPdf;  |FINSI;
         |SI #109#63 = "N";  nCasilla = 241;  aValor = aSi;     |HAZ GrabaPdf;  |FINSI;

         |SI #109#64 = "S";  nCasilla = 246;  aValor = "2";     |HAZ GrabaPdf;  |FINSI;
         |SI #109#64 = "N";  nCasilla = 245;  aValor = aSi;     |HAZ GrabaPdf;  |FINSI;

         |SI #109#65 = "S";  nCasilla = 242;  aValor = "2";     |HAZ GrabaPdf;  |FINSI;
         |SI #109#65 = "N";  nCasilla = 244;  aValor = aSi;     |HAZ GrabaPdf;  |FINSI;
     |FINSI;

     |DELINDEX #109;
|FPRC;

|PROCESO Hoja9;
     |DDEFECTO #110;

     #110#3   = #21#76;   #110#4   = #21#77;   #110#5   = #21#78;
     #110#6   = #21#79;   #110#7   = #21#80;   #110#8   = #21#81;
     #110#9   = #21#82;   #110#10  = #21#83;   #110#11  = #21#84;
     #110#12  = #21#125;  #110#13  = #21#126;  #110#14  = #21#127;
     #110#15  = #21#85;   #110#16  = #21#86;   #110#17  = #21#87;
     #110#18  = #21#128;  #110#19  = #21#129;  #110#20  = #21#130;
     #110#21  = #21#131;  #110#22  = #21#132;  #110#23  = #21#133;
     #110#24  = #21#88;   #110#25  = #21#89;   #110#26  = #21#90;
     #110#27  = #21#91;   #110#28  = #21#92;   #110#29  = #21#93;
     #110#30  = #21#94;   #110#31  = #21#95;   #110#32  = #21#96;
     #110#33  = #21#112;  #110#34  = #21#113;  #110#35  = #21#114;
     #110#36  = #21#106;  #110#37  = #21#107;  #110#38  = #21#108;
     #110#39  = #21#134;  #110#40  = #21#135;  #110#41  = #21#136;
     #110#42  = #21#97;   #110#43  = #21#98;   #110#44  = #21#99;
     #110#45  = #21#100;  #110#46  = #21#101;  #110#47  = #21#102;
     #110#48  = #21#137;  #110#49  = #21#138;  #110#50  = #21#139;
     #110#51  = #21#140;  #110#52  = #21#141;  #110#53  = #21#142;
     #110#54  = #21#103;  #110#55  = #21#104;  #110#56  = #21#105;
     #110#57  = #21#143;  #110#58  = #21#144;  #110#59  = #21#145;
     #110#60  = #21#146;  #110#61  = #21#147;  #110#62  = #21#148;
     #110#63  = #21#109;  #110#64  = #21#110;  #110#65  = #21#111;
     #110#66  = #21#149;  #110#67  = #21#150;  #110#68  = #21#151;
     #110#69  = #21#152;  #110#70  = #21#153;  #110#71  = #21#154;
     #110#72  = #21#115;  #110#73  = #21#116;  #110#74  = #21#117;
                          #110#75  = #21#118;  #110#76  = #21#119;
     #110#77  = #21#120;  #110#78  = #21#121;  #110#79  = #21#122;
                          #110#80  = #21#123;  #110#81  = #21#124;

     #110#83 = &13 + &10;

     |SI #0#0 = 1;
         |SI #21#76 = "S"; nCasilla = 251;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#76 = "N"; nCasilla = 252;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #21#77 = "S"; nCasilla = 254;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#78 = "S"; nCasilla = 253;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #21#79 = "S"; nCasilla = 255;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#79 = "N"; nCasilla = 256;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #21#80 = "S"; nCasilla = 257;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#81 = "S"; nCasilla = 258;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #21#82 = "S"; nCasilla = 265;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#82 = "N"; nCasilla = 266;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #21#83 = "S"; nCasilla = 259;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#84 = "S"; nCasilla = 261;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #21#85 = "S"; nCasilla = 264;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#85 = "N"; nCasilla = 263;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #21#86 = "S"; nCasilla = 260;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#87 = "S"; nCasilla = 262;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #21#88 = "S"; nCasilla = 276;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#88 = "N"; nCasilla = 277;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #21#89 = "S"; nCasilla = 280;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#90 = "S"; nCasilla = 281;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #21#91 = "S"; nCasilla = 275;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#91 = "N"; nCasilla = 278;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #21#92 = "S"; nCasilla = 279;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#93 = "S"; nCasilla = 282;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #21#94 = "S"; nCasilla = 273;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#94 = "N"; nCasilla = 274;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #21#95 = "S"; nCasilla = 267;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#96 = "S"; nCasilla = 269;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #21#97 = "S"; nCasilla = 272;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#97 = "N"; nCasilla = 271;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #21#98 = "S"; nCasilla = 268;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#99 = "S"; nCasilla = 270;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #21#100 = "S"; nCasilla = 292;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#100 = "N"; nCasilla = 293;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #21#101 = "S"; nCasilla = 296;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#102 = "S"; nCasilla = 297;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #21#103 = "S"; nCasilla = 291;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#103 = "N"; nCasilla = 294;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #21#104 = "S"; nCasilla = 295;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#105 = "S"; nCasilla = 298;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #21#106 = "S"; nCasilla = 289;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#106 = "N"; nCasilla = 290;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #21#107 = "S"; nCasilla = 283;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#108 = "S"; nCasilla = 285;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #21#109 = "S"; nCasilla = 288;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#109 = "N"; nCasilla = 287;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #21#110 = "S"; nCasilla = 284;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#111 = "S"; nCasilla = 286;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #21#112 = "S"; nCasilla = 301;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#112 = "N"; nCasilla = 300;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #21#113 = "S"; nCasilla = 304;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#114 = "S"; nCasilla = 305;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #21#115 = "S"; nCasilla = 302;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#115 = "N"; nCasilla = 299;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #21#116 = "S"; nCasilla = 303;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#117 = "S"; nCasilla = 306;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #21#118 = "S"; nCasilla = 310;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#119 = "S"; nCasilla = 311;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #21#120 = "S"; nCasilla = 308;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#120 = "N"; nCasilla = 307;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;
         |SI #21#121 = "S"; nCasilla = 309;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#122 = "S"; nCasilla = 312;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #21#123 = "S"; nCasilla = 313;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#123 = "N"; nCasilla = 315;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;

         |SI #21#124 = "S"; nCasilla = 314;  aValor = "2"; |HAZ GrabaPdf;  |FINSI;
         |SI #21#124 = "N"; nCasilla = 316;  aValor = aSi; |HAZ GrabaPdf;  |FINSI;
     |FINSI;

     |SI #0#0 = 2;
         |PARA nNumero = 1;  |SI nNumero [ 83;  |HACIENDO nNumero = nNumero + 1;
               aAlfa = #110nNumero;
               |HAZ QuitaRaros;
               #110nNumero = aAlfa;
               aAlfa = #110nNumero;
               |XGRABA nHandle, aAlfa;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO CierraFichero;
     |XCIERRA nHandle;

     aAlfa = "0000 El fichero generado esta en " + aArchivoTxt;
     |MENAV aAlfa;
|FPRC;

|PROCESO Emitir;
     |SI #0#0 = 1;  |HAZ CargaTemporal;  |FINSI;
     |SI #0#0 = 2;  |HAZ AbreFichero;    |FINSI;

     |ABRE #100;
     |HAZ Hoja1A;
     |HAZ Hoja1B;
     |HAZ Hoja2;
     |HAZ Hoja3;
     |HAZ Hoja4A;
     |HAZ Hoja4B;
     |HAZ Hoja5;
     |HAZ Hoja6;
     |HAZ Hoja7;
     |HAZ Hoja8;
     |HAZ Hoja9;
     |CIERRA #100;

     |SI #0#0 = 1;  |HAZ ImprimePDF;     |FINSI;
     |SI #0#0 = 2;  |HAZ CierraFichero;  |FINSI;
|FPRC;

|PROCESO EmiteEsto;
     |ABRE #21;
     #21#0 = #20#0;
     #21#1 = #20#1;
     |LEE 101#21=;
     |SI FSalida ! 0;
         |CIERRA #21;
         |MENAV "0000 Datos incompletos, rellene el registro del modelo 036.";
         |ACABA;
     |FINSI;

     |ABRE #0;
     aIP = "";
     |IP_REMOTO aIP;  |QBF aIP;
     #0#7 = aIP;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#7 = aIP;
         |GRABA 020#0b;
     |FINSI;

     |PUSHV 0501 2380;

     #0#1 = #21#71;
     #0#2 = #21#72;
     #0#3 = #21#73;
     #0#4 = #21#74;
     #0#5 = #21#75;

     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
         #21#71 = #0#1;
         #21#72 = #0#2;
         #21#73 = #0#3;
         #21#74 = #0#4;
         #21#75 = #0#5;
         |GRABA 020#21a;
         |LIBERA #21;

         |HAZ Emitir;
     |FINSI;
     |POPV;

     |PDEFECTO #0, 1, 6;
     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;

     |CIERRA #21;
|FPRC;
