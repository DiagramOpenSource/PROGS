|FICHEROS;
    etttarca #0;
    etttarli #1;
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;

    posic = 0;
    pos1 = 0;
    pos2 = 0;
    pos3 = 0;
    pos4 = 0;
    pos5 = 0;
    pos6 = 0;
    pos7 = 0;
|FIN;
____________________________________/
|PROCESO recalcula1;
|SI Campo = 3; #1#3 = (#1#2 + #1#6 + #1#7) % #0#3; |FINSI;  || costes
|SI Campo = 4; #1#4 = (#1#2 + #1#6 + #1#7) % #0#4; |FINSI;  || margen
    #1#5 = #1#2 + #1#6 + #1#7 + #1#3 + #1#4 + #1#9;         || total
|GRABA 020#1a;
|LIBERA #1;

|C_P #1#1, 0, posic;
|SI posic < 2100;
    |PINDA #0#1;
    |C_P #1#1, 0, nume1;     nume1 = nume1 + 100;   |C_P #1#1, 1, nume1;
    |C_P #1#2, 0, nume1;     nume1 = nume1 + 100;   |C_P #1#2, 1, nume1;
    |C_P #1#3, 0, nume1;     nume1 = nume1 + 100;   |C_P #1#3, 1, nume1;
    |C_P #1#4, 0, nume1;     nume1 = nume1 + 100;   |C_P #1#4, 1, nume1;
    |C_P #1#5, 0, nume1;     nume1 = nume1 + 100;   |C_P #1#5, 1, nume1;
    |C_P #1#6, 0, nume1;     nume1 = nume1 + 100;   |C_P #1#6, 1, nume1;
    |C_P #1#7, 0, nume1;     nume1 = nume1 + 100;   |C_P #1#7, 1, nume1;
    |C_P #1#9, 0, nume1;     nume1 = nume1 + 100;   |C_P #1#9, 1, nume1;
|FINSI;
|FPRC;

|PROCESO recalcula; |TIPO 0;
    modo = (FEntrada / 100) ! 0;
    nume1 = Contenido;
|SI #0Campo ! nume1;|Y modo ! 1;
    |CONFI "    SRecalcular Niveles (S/N): ";
    |SI FSalida = 0;
        |C_P #1#1, 0, pos1;
        |C_P #1#2, 0, pos2;
        |C_P #1#3, 0, pos3;
        |C_P #1#4, 0, pos4;
        |C_P #1#5, 0, pos5;
        |C_P #1#6, 0, pos6;
        |C_P #1#7, 0, pos7;
        |C_P #1#9, 0, pos7;
        |BUCLELIN 0recalcula1#0;
        |C_P #1#1, 1, pos1;
        |C_P #1#2, 1, pos2;
        |C_P #1#3, 1, pos3;
        |C_P #1#4, 1, pos4;
        |C_P #1#5, 1, pos5;
        |C_P #1#6, 1, pos6;
        |C_P #1#7, 1, pos7;
        |C_P #1#9, 1, pos7;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO calcula; |TIPO 0;
    nume1 = Contenido;
|SI #1Campo ! nume1;
        #1#3 = (#1#2 + #1#6 + #1#7) % #0#3;            || costes
        #1#4 = (#1#2 + #1#6 + #1#7) % #0#4;            || margen
        #1#5 = #1#2 + #1#6 + #1#7 + #1#3 + #1#4 + #1#9;|| total
    |PINTA #1#3;
    |PINTA #1#4;
    |PINTA #1#5;
|FINSI;
|FPRC;

|PROCESO suma; |TIPO 0;
    #1#5 = #1#2 + #1#6 + #1#7 + #1#3 + #1#4 + #1#9;
|PINTA #1#5;
|FPRC;

|PROCESO imp_margen; |TIPO 7;
    nume1 = (#1#2 + #1#6 + #1#7) % #1#8;
    #1#4 = nume1;
|FPRC;

|PROCESO por_margen; |TIPO 7;
    nume1 = (#1#4 * 100) / (#1#2 + #1#6 + #1#7);
    #1#8 = nume1;
|FPRC;
