|FICHEROS;
    ettemacc #0;         || relacion cabs.
    ettemacl #1;         || relacion lins.
    labempre #10;        || empresas AGINOM
    labcentr #11;        || centros AGINOM
    ettcontr #13;        || control AGIETT
    labtraba #14;        || trabajadores AGINOM
    nomcenes #15;        || centros especiales
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;

    p_mes = "";
    &ssesp = "";
|FIN;
____________________________________/ DESDE CAMPOS
|PROCESO tipo8; |TIPO 8;
|ABRE #13;
|LEE 000#13p;
|SI FSalida = 0;
        alfa1 = #13#3;    |QBF alfa1;   alfa1 = alfa1 + "/fich/";
    |PATH_DAT #10 alfa1;
    |PATH_DAT #11 alfa1;
    |PATH_DAT #14 alfa1;
    |PATH_DAT #15 alfa1;
        alfa1 = #13#3;    |QBF alfa1;   alfa1 = alfa1 + "/pan/";
    |PATH_PAN #10 alfa1;
    |PATH_PAN #11 alfa1;
    |PATH_PAN #14 alfa1;
|SINO;
    |MENAV "    Control AGIETT sin definir ...";
|FINSI;
|CIERRA #13;
|FPRC;

|PROCESO defecto; |TIPO 7;
    fech1 = ~;
    alfa1 = fech1;
    alfa1 = alfa1 % -104;
    #0Campo = alfa1;
|PINTA #0Campo;
|FPRC;

|PROCESO mirames; |TIPO 7;
    fech1 = ~;
    alfa1 = fech1;
    alfa1 = alfa1 % 402;
    #0Campo = alfa1;
|PINTA #0Campo;
|FPRC;

|PROCESO pintames; |TIPO 0;
|SI #0Campo =  1;  p_mes = "ENERO     ";  |FINSI;
|SI #0Campo =  2;  p_mes = "FEBRERO   ";  |FINSI;
|SI #0Campo =  3;  p_mes = "MARZO     ";  |FINSI;
|SI #0Campo =  4;  p_mes = "ABRIL     ";  |FINSI;
|SI #0Campo =  5;  p_mes = "MAYO      ";  |FINSI;
|SI #0Campo =  6;  p_mes = "JUNIO     ";  |FINSI;
|SI #0Campo =  7;  p_mes = "JULIO     ";  |FINSI;
|SI #0Campo =  8;  p_mes = "AGOSTO    ";  |FINSI;
|SI #0Campo =  9;  p_mes = "SEPTIEMBRE";  |FINSI;
|SI #0Campo = 10;  p_mes = "OCTUBRE   ";  |FINSI;
|SI #0Campo = 11;  p_mes = "NOVIEMBRE ";  |FINSI;
|SI #0Campo = 12;  p_mes = "DICIEMBRE ";  |FINSI;
|PINTA 1038, p_mes;
|FPRC;

|PROCESO mayus; |TIPO 0;
    #1Campo = #1Campo > #1Campo;
|PINTA #1Campo;
|FPRC;
____________________________________/
|PROCESO imprime;
|DDEFECTO #10;
    #10#0 = #1#0;
|LEE 000#10=;       || lee empresa

|DDEFECTO #14;
    #14#0 = #1#0;
    #14#1 = #1#3;
|LEE 000#14=;       || lee trabajador

|DDEFECTO #11;
    #11#0 = #1#0;
    #11#1 = #14#77; || lee centro
|LEE 000#11=;
    ssesp = #11#10; || s.s. del centro

|SI #14#45 = "87";|O #14#45 = "97";|O #14#45 = "64";
    |DDEFECTO #15;
        #15#0 = #1#0;
        #15#13= #14#77;
    |SI #14#45 = "97";
            #15#1 = "87";
    |SINO;
            #15#1 = #14#45;
    |FINSI;
    |LEE 000#15=;
        ssesp = #15#10;
|FINSI;

    seleccio = 1;
|PRINT;
|FPRC;

|PROCESO tipo4; |TIPO 4;
|IMPRE 0;
|SI FSalida = 0;
    |INFOR "ettemacc";
    |SI FSalida = 0;
            seleccio = 0;
        |ABRE #10;
        |ABRE #11;
        |ABRE #14;
        |ABRE #15;
        |BUCLELIN 2imprime#0;
        |CIERRA #10;
        |CIERRA #11;
        |CIERRA #14;
        |CIERRA #15;
        |SI seleccio ! 0;
            |PIEINF;
        |FINSI;
    |SINO;
        |MENAV "    Problemas con el informe 'ettemacc' ...";
    |FINSI;
    |FININF;
|SINO;
    |MENAV "    Proceso abortado ...";
|FINSI;
|FINIMP;
|FPRC;
