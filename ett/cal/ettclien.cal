|FICHEROS;
    ettclien #0;
    etttarca #1;         || tarifas

    :/facturar/def/asclient #10;        || clientes FACGES
    ettprovi #11;        || provinciero
    ettcontr #13;        || control
    :/facturar/def/asbancos #14;        || bancos remesa FACGES
    :/facturar/def/asbancli #15;        || bancos clientes FACGES
    :/facturar/def/asfpagos #16;        || formas de pago FACGES
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;

    x = "";
    final = "";
    letra = "";
    lugar = 0;
    resto = 0;
    nifnum = 0;

    corta = 0;
    jg = 0;
    sitio = 0;
    nafss = "";

     aNifQbf1   = "";
     aNifQbf2   = "";

     &eaVarDni  = "";
     &enCalcCif = 0;
|FIN;
____________________________________/
|PROCESO mayus_cli; |TIPO 0;
    #0Campo = #0Campo > #0Campo;
|PINTA #0Campo;
|FPRC;

|PROCESO ztipo8; |TIPO 8;
|ABRE #13;
|LEE 000#13p;
|SI FSalida = 0;
        alfa1 = #13#1;   |QBF alfa1;    alfa1 = alfa1 + "/fich/";
        alfa2 = #13#2;   |QBF alfa2;    alfa2 = ("00" + alfa2) % -102;
        alfa1 = alfa1 + alfa2 + "/";
    |PATH_DAT #10 alfa1;
    |PATH_DAT #14 alfa1;
    |PATH_DAT #15 alfa1;
    |PATH_DAT #16 alfa1;
        alfa1 = #13#1;   |QBF alfa1;    alfa1 = alfa1 + "/pan/";
    |PATH_PAN #14 alfa1;
    |PATH_PAN #15 alfa1;
    |PATH_PAN #16 alfa1;
|SINO;
    |MENAV "    Control AGIETT sin definir ...";
    |PTEC 807;
|FINSI;
|CIERRA #13;
|FPRC;

|PROCESO zmayus; |TIPO 0;
    #0Campo = #0Campo > #0Campo;
|PINTA #0Campo;
|FPRC;

|PROCESO zalta; |TIPO 7;
    modo = (FEntrada / 100) ! 0;
|SI modo = 1;
    |LEE 000#0u;
    |SI FSalida = 0;
            nume1 = #0#0 + 1;
        |DDEFECTO #0;
            #0#0 = nume1;
        |PINTA #0#0;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO nif; |TIPO 6;
     eaVarDni  = #0Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;

     aNifQbf1 = #0Campo;   |QBF aNifQbf1;
     aNifQbf2 = eaVarDni;  |QBF aNifQbf2;

     |SI aNifQbf1 ! aNifQbf2; |Y aNifQbf1 ! "";
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #0Campo = eaVarDni;  |PINTA #0Campo;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO ctass; |TIPO 0;
    alfa1 = #0Campo;
|QBF alfa1;
    alfa2 = alfa1 % 0;    nume1 = alfa2;
|SI nume1 ! 0;
    |SI nume1 > 9;  alfa1 = alfa1 % 109;     |FINSI;
        nafss = alfa1;

        alfa2 = alfa1 % 102; alfa3 = alfa1 % -107;
        alfa4 = alfa3 % 101;
    |SI alfa4 = "0";
            alfa3 = alfa3 % 206;
            alfa1 = alfa2 + alfa3;
    |FINSI;
        nume1 = alfa1;
        nume2 = nume1 / 97;
    |HAZ trunca2;
    |SI nume1 ] 0; |Y nume1 [ 99;
            alfa1 = nafss;
        |QBF alfa1;
            alfa2 = nume1;
            alfa2 = "00" + alfa2;
            alfa2 = alfa2 % -102;
            alfa1 = alfa1 + alfa2;
            #0Campo = alfa1;
        |PINTA #0Campo;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO trunca2;
    corta = 0;
    alfa1 = nume2;  alfa2 = alfa1 % 0;  nume3 = alfa2;
|PARA jg = nume3; |SI jg ] 1;|Y corta = 0; |HACIENDO jg = jg - 1;
        sitio = (jg * 100) + 1;
        alfa2 = alfa1 % sitio;
    |SI alfa2 = ".";  corta = jg;  |FINSI;
|SIGUE;
|SI corta ! 0;
        sitio = 100 + corta - 1;
        alfa1 = alfa1 % sitio;
|FINSI;
    nume3 = alfa1;
    nume1 = nume1 - (nume3 * 97);
|FPRC;

|PROCESO ztipo3; |TIPO 3;
|DDEFECTO #11; |ABRE #11; #11#0 = #0#5;  |LEE 000#11=; |CIERRA #11;
|DDEFECTO #15; |ABRE #15; #15#0 = #0#24; |LEE 000#15=; |CIERRA #15;

|ABRE #10;
    #10#0 = #0#0;
|LEE 000#10=;
    FEstado = FSalida;

    #10#0 = #0#0;        || nombre
    #10#1 = #0#1;        || razon social
    #10#2 = #10#1;       || nombre
    alfa1 = #0#2;   |QBF alfa1;         || calle
    alfa2 = #0#3;   |QBF alfa2;         || numero
    alfa3 = #0#4;   |QBF alfa3;         || piso
    #10#3 = alfa1 + ", " + alfa2 + "-" + alfa3;   || direccion
    #10#4 = #0#5;        || cp 1
    #10#5 = #0#6;        || cp 2
    #10#6 = #0#7;        || poblacion
    #10#7 = #11#1;       || provincia
    #10#8 = #0#8;        || cif
    #10#9 = #0#9;        || telefono
    #10#10= #0#10;       || fax
    #10#11= #15#1;       || banco
    #10#12= #15#2;       || direccion banco
    #10#13= #15#3;       || ccc
    #10#14= #0#25;       || cta.cte.
    #10#15= #0#26;       || forma pago
    #10#16= #0#27;       || banco a remesar
    #10#17= #0#28;       || retencion IRPF S/N
    #10#22= #0#29;       || tipo tarifa
    #10#23= #0#30;       || descuento
    #10#52= #0#31;       || cuenta contable
    #10#53= #0#24;       || codigo banco cliente

|SI FEstado = 0;    |GRABA 020#10a;     |FINSI;
|SI FEstado ! 0;    |GRABA 020#10n;     |FINSI;
|LIBERA #10;
|CIERRA #10;
|FPRC;

|PROCESO no_meses; |TIPO 7;
    alfa1 = #0#39;
|C_M #0#40, 1, alfa1;
|FPRC;

|PROCESO asbancos; |TIPO 6;
|ABRE #14;
    #14#0 = #0#27;
|LEE 000#14=;
|SI FSalida ! 0;
    |PUSHV 0501 2380;
    |DDEFECTO #14;
        #14#0 = #0#27;
    |PINPA #0#14;
    |PINDA #0#14;
    |CONFI "    SConfirma alta (S/N) ..: ";
    |SI FSalida = 0;
        |GRABA 020#14b;
        |ENDATOS #1#14;
        |SI FSalida = 0;
            |GRABA 020#14a;
        |SINO;
            |BORRA 020#14a;
            |ERROR;
        |FINSI;
        |LIBERA #14;
    |SINO;
        |ERROR;
    |FINSI;
    |POPV;
|FINSI;
|CIERRA #14;
|FPRC;

|PROCESO asbancli; |TIPO 6;
|ABRE #15;
    #15#0 = #0#24;
|LEE 000#15=;
|SI FSalida ! 0;
    |PUSHV 0501 2380;
    |DDEFECTO #15;
        #15#0 = #0#24;
    |PINPA #0#15;
    |PINDA #0#15;
    |CONFI "    SConfirma alta (S/N) ..: ";
    |SI FSalida = 0;
        |GRABA 020#15b;
        |ENDATOS #1#15;
        |SI FSalida = 0;
            |GRABA 020#15a;
        |SINO;
            |BORRA 020#15a;
            |ERROR;
        |FINSI;
        |LIBERA #15;
    |SINO;
        |ERROR;
    |FINSI;
    |POPV;
|FINSI;
|CIERRA #15;
|FPRC;

|PROCESO asfpagos; |TIPO 6;
|ABRE #16;
    #16#0 = #0#26;
|LEE 000#16=;
|SI FSalida ! 0;
    |PUSHV 0501 2380;
    |DDEFECTO #16;
        #16#0 = #0#26;
    |PINPA #0#16;
    |PINDA #0#16;
    |CONFI "    SConfirma alta (S/N) ..: ";
    |SI FSalida = 0;
        |GRABA 020#16b;
        |ENDATOS #1#16;
        |SI FSalida = 0;
            |GRABA 020#16a;
        |SINO;
            |BORRA 020#16a;
            |ERROR;
        |FINSI;
        |LIBERA #16;
    |SINO;
        |ERROR;
    |FINSI;
    |POPV;
|FINSI;
|CIERRA #16;
|FPRC;
