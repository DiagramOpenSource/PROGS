|FICHEROS;
     ettfotos #0;
     ettcontr #100;
|FIN;

|VARIABLES;
     &pasa     = "";
     &orden    = "";
     nSw       = 0;
     i         = 0;
     aIP       = "";
     aAlfa     = "";
     nBoton1   = 0;
     aPath     = "";
     aRuta     = "";
     aRuta0    = "";
     aFic      = "";
     aLon      = "";
     nPos      = 0;
     aDes      = "";
     &nCandidato = 0;
|FIN;

|PROCESO Ver;
     aFic = #0#1; |QBF aFic;
     |SI aFic ! "";
          aFic = aPath + aFic;
          |XABRE "E", aFic, 0;
          |SI FSalida = 0;
               |IP_REMOTO aIP;
               |SI aIP ! "";
                    aAlfa = "c:\tmp\"; |RMKDIR aAlfa;
                    aDes = "c:\tmp\" + #0#1; |QBF aDes;
                    |ENVIA_FICHERO aFic, aDes;
               |SINO;
                    aDes = aFic;
               |FINSI;
               aFic = "IMAGEN," + aDes;
               |CONTROL_SIMPLE 0, aFic , 0749, 2279, NULL;
               nBoton1 = FSalida;
               |ESTADO_CONTROL nBoton1, "ENABLE";
               |PAUSA;
               |FIN_CONTROL_WINDOWS nBoton1;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Asigna;
     aRuta = "F";
     aFic = "";
     |BROWSE aRuta;

     |SI aRuta ! "F";
          nSw = 0;
          aRuta0 = "";
          aLon = aRuta % A0;
          |PARA i = 1; |SI i < aLon; |HACIENDO i = i + 1;
               nPos = -1 * (i * 100 + 1);
               aAlfa = aRuta % nPos;
               |SI aAlfa = "/"; |O aAlfa = "\"; |O nSw = 1;
                    nSw = 1;
                    aRuta0 = aAlfa + aRuta0;
               |SINO;
                    aRuta0 = aAlfa + aRuta0;
                    aFic = aAlfa + aFic;
               |FINSI;
          |SIGUE;
          |QBT aFic;
          aFic = aFic < "";
          aDes = aPath + aFic;
          aDes = aDes < "";
          aIP = "";
          |IP_REMOTO aIP;
          |XABRE "E", aDes, 0;
          |SI FSalida = 0;
               aAlfa = "0000Existe el fichero en el directorio" + &13 +"NO SE COPIA";
               |MENAV aAlfa;
          |SINO;
               |SI aIP = "";
                    |COPIA_FICHERO aRuta0, aDes;
               |SINO;
                    |RECIBE_FICHERO aRuta0, aDes;
               |FINSI;
          |FINSI;
          #0#1 = aFic; |PINTA #0#1;
     |FINSI;
|FPRC;

|PROCESO Tecla11; |TIPO 11;
     |SI FSalida = 16;
          |HAZ Ver;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tecla0; |TIPO 0;
     |SI FSalida = 15;
          |HAZ Asigna
          |ERROR;
     |FINSI;
     |SI FSalida = 16;
          |HAZ Ver;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO mini;
     #0#0 = nCandidato;
     #0#1 = 001;
|FPRC;

|PROCESO maxi;
     #0#0 = nCandidato;
     #0#1 = 999;
|FPRC;

|PROGRAMA;
     |ABRE #0;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     aPath = #100#36; |QBF aPath;
     |MKDIR aPath;
     |SI FSalida ! 0;
          aPath = aPath + "/";
          #0#0 = nCandidato;
          |LEE 000#0=;
          |SI FSalida = 0;
               |PINTA #0#1;
               ||HAZ lafoto;
          |FINSI;
     |SINO;
          |SI aPath = "";
               aAlfa = "0000No esta definido el directorio de imagenes";
          |SINO;
               |RMDIR aPath;
               aAlfa = "0000No existe el directorio";
               aAlfa = aAlfa + &13 + "[" + aPath + "]";
          |FINSI;
          |MENAV aAlfa;
     |FINSI;
     |CIERRA #0;
|FPRO;
