|FICHEROS;
   rem01010 #0;
   rem01011 #1;
   rem01012 #2;
   rem01014 #3;
   rem01018 #7;
   rem01019 #8;
   rem01021 #10;
   rem01022 #11;
   rem01023 #12;
   rem01024 #13;
   rem01025 #14;
   rem01026 #15;
   rem01027 #16;
   rem01033 #18;
   rem01002 #19;
   rem01013 #20;
   rem01039 #22;
   rem01030 #24;
   rem01031 #25;
   rem01032 #26;
|FIN;

|VARIABLES;

   aLong = ""; nLong = 0;
   &aSeparada = "";

   Vacio1 = "";
   Vacio2 = "";
   nNegativo = "";

   nNumLin1 = 0;
   nNumLin2 = 0;
   nNumLin3 = 0;
   nNumLin4 = 0;
   nNumLinAnt = 0;

   aAlfa  = "";
   aAlfa1 = "";
   aAlfa2 = "";
   aAlfa3 = "";
   &aIP   = "";
   nETAct  = 0;
   nEnAct  = 0;

   nNumActiv  = 0;
   nNumActiv1 = 0;
   nNumActiv2 = 0;

   nPagAct = 0;
   nNumPag = 0;

   &Handle = 0;
   SwError = 0;
   Bloque = 0;
   Casilla = "";
   nSwDatos = 0;
   Cadena = "";
   Cadena1 = "";
   Cadena2 = "";
   Cadena3 = "";
   Cadena4 = "";
   Cadena5 = "";
   &VEmpresa = 0;
   &VTipo = "";
   aTipo  = "";
   aTipo2 = "";
   aTipoContr = "";

   aGan1 = ""; aGan2 = ""; aGan3 = "";
   aPer1 = ""; aPer2 = ""; aPer3 = "";

   TipoDato = "";
   Long     = 0;
   LongDec  = 0;
   nComp    = 0;

   Calc  = 0;
   Calc1 = 0;
   Calc2 = 0;
   nPag  = 0;
   nNumPags = 0;

   nPasada = 0;
   nCont  = 0;
   nCont1 = 0;
   nCont2 = 0;
   nSalir = 0;
   nCalc  = 0;
   nCalc1 = 0;
   nCalc2 = 0;
   nNoHay  = 0;
   nNoHay1  = 0;
   nNoHay2  = 0;
   nNoHay3  = 0;
   nNoHay4 = 0;
|FIN;

|PROCESO Hoja03;
   nSwDatos = 3; |HAZ MiraSiDatos1;
   |SI nSwDatos = 0; |ACABA; |FINSI;

   aTipo = VTipo % 0110;

   Cadena = "<T10003> ";
   |ABRE #rem01010;
   #rem01010#0 = VEmpresa;
   #rem01010#1 = 0;
   #rem01010#2 = aTipo;
   |LEE 000#rem01010.=;
   |SI FSalida ! 0; |DDEFECTO #rem01010; |FINSI;
   |CIERRA #rem01010;

   TipoDato = "N";  Long = 11;  LongDec = 2;
   || (A) Rendim.trabajo: Ingresos Integros: Ret.Dinerarias : Ingr.Integros
   aAlfa = #rem01010#3;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Ingresos Integros: Ret.Especie: Valoracion
   aAlfa = #rem01010#4;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Ingresos Integros: Ret.Especie: Ing.a Cuenta
   aAlfa = #rem01010#5;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Ingresos Integros: Ret.Especie: Ing.a Cuenta Reperc.
   aAlfa = #rem01010#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Ingresos Integros: Ret.Especie: Ing.Integros
   aAlfa = #rem01010#7;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Ingresos Integros: Contrib.Planes Pens. y Prev.Social: Importes
   aAlfa = #rem01010#8;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Ingresos Integros: Aportaciones al patrimonio protegido de discapacitados
   aAlfa = #rem01010#16;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Reducciones especiales: Importe
   aAlfa = #rem01010#9;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Total ingresos integros computables
   aAlfa = #rem01010#24; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Cotiz.Seg.Social/Mutuas grles.
   aAlfa = #rem01010#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   Cadena1 = Cadena; Cadena = "";

   || Rendim.trabajo: Gastos deducibles: Cuotas satisfechas a sindicatos
   aAlfa = #rem01010#11; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Cuotas a colegios profesionales
   aAlfa = #rem01010#12; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Gastos defensa jurid.derivados litigios con el empleador
   aAlfa = #rem01010#13; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Total gastos deducibles
   aAlfa = #rem01010#14; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Total rendimiento neto
   aAlfa = #rem01010#15; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Copa America 2007
   aAlfa = #rem01010#17; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Reduccion obtencio rdtos.trabajo: Cuantia aplicable con caracter general
   aAlfa = #rem01010#25; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Reduccion obtencio rdtos.trabajo: Increm.trab.activos > 65 a¤os
   aAlfa = #rem01010#26; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Reduccion obtencio rdtos.trabajo: Increm.contrib.desempleados con traslado de residencia
   aAlfa = #rem01010#27; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Reduccion obtencio rdtos.trabajo: Reduccion adicional trabajadores activos discapacitados
   aAlfa = #rem01010#28; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Rendimiento neto reducido
   aAlfa = #rem01010#23; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   Cadena2 = Cadena; Cadena = "";

   |ABRE #rem01012;
   #rem01012#0 = VEmpresa;
   #rem01012#1 = 0;
   #rem01012#2 = aTipo;
   |LEE 000#rem01012.=;
   |SI FSalida ! 0; |DDEFECTO #rem01012; |FINSI;
   |CIERRA #rem01012;

   || (B) Rend.Cap.Mobil: Base imp.ahorro: Int.de cuentas y dep.activos financieros
   aAlfa = #rem01012#3;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Base imp.ahorro: Intereses de activos financieros con derecho a bonificacion
   aAlfa = #rem01012#19; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Base imp.ahorro: Dividendos por part.fondos propios entidades
   aAlfa = #rem01012#4;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Base imp.ahorro: Rdtos.transm.o amort.Letras del tesoro
   aAlfa = #rem01012#5;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Base imp.ahorro: Rdtos.transm., amort.o reemb.otros activos financ.
   aAlfa = #rem01012#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Base imp.ahorro: Rdtos.contratos seg.vida o invalidez y oper.cap.
   aAlfa = #rem01012#7;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Base imp.ahorro: Rdtos.rentas imposic.capitales u otros rdtos.capital mobiliario a integrar en la B.I.del ahorro
   aAlfa = #rem01012#20; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Base imp.ahorro:  Total ingresos integros
   aAlfa = #rem01012#9;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   Cadena3 = Cadena; Cadena = "";

   || Rend.Cap.Mobil: Base imp.ahorro: Gastos fiscalmente deducibles
   aAlfa = #rem01012#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Gastos deducibles: Total rendimiento neto
   aAlfa = #rem01012#13; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Reducc.rendtos.contratos de seguro (Disp.Tr.4¦ Ley del Impuesto)
   aAlfa = #rem01012#15; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Total rendimiento neto reducido
   aAlfa = #rem01012#16; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil.: Base imponible general: Rdtos.arrendamientos bienes inmueb., negocios, minas y subarrendamientos
   aAlfa = #rem01012#21; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil.: Base imponible general: Rend.prestacion asistencia tecnica, salvo actividad economica
   aAlfa = #rem01012#22; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil.: Base imponible general: Rend.propiedad intelectual contribuyente no autor
   aAlfa = #rem01012#23; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil.: Base imponible general: Rend.propiedad industrial no afecta a actividad economica
   aAlfa = #rem01012#24; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil.: Base imponible general: Otros Rdtos.del capital mob.a integrar en la B.I.General
   aAlfa = #rem01012#8; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil.: Base imponible general: Total ingresos integros
   aAlfa = #rem01012#25; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Deuda Publ.: Base imponible general: Gtos.fiscalmente deducibles
   aAlfa = #rem01012#26; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil.: Base imponible general: Rendimiento neto
   aAlfa = #rem01012#27; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil.: Base imponible general: Reducc.rdtos.generados en mas de 2 a¤os u obtenidos de forma irregular
   aAlfa = #rem01012#14; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Deuda Publ.: Base imponible general: Rendimiento neto reducido
   aAlfa = #rem01012#28; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   Cadena = Cadena + "</T10003>" + &13 + &10;
   Cadena4 = Cadena; Cadena = "";

   |SI nSwDatos = 1;
      Cadena = Cadena1; |HAZ GrabaCad1;
      Cadena = Cadena2; |HAZ GrabaCad1;
      Cadena = Cadena3; |HAZ GrabaCad1;
      Cadena = Cadena4; |HAZ GrabaCad1;
   |FINSI;
|FPRC;

|PROCESO Hoja04;
   nSwDatos = 4; nCalc1 = 0;
   |HAZ MiraSiDatos1;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "<T10004> ";
   |ABRE #rem01013; |ABRE #rem01011;

   || Primero se calcula el n§ de paginas adicionales, puesto que las pide

   nPagAct = 1; nNumPag = 0;
   nCont = 0; nCalc1 = 0;
   #rem01013#0 = VEmpresa;
   #rem01013#1 = 0;
   #rem01013#2 = aTipo; aTipo2 = #rem01013#2;
   #rem01013#3 = 0;
   |LEE 000#rem01013.];
   |PARA nComp = 0; |SI FSalida = 0; |Y #rem01013#0 = VEmpresa; |Y #rem01013#1 = 0; |Y #rem01013#2 = aTipo2; |HACIENDO nComp = nComp + 1;
      |PARA nCont = 1; |SI nCont [ 5; |HACIENDO nCont = nCont + 1;
         |SI #rem01013#0 ! VEmpresa; |O #rem01013#1 ! 0; |O #rem01013#2 ! aTipo2;
            |DDEFECTO #rem01013;
         |SINO;
            |LEE 000#rem01013.s;
         |FINSI;
      |SIGUE;
   |SIGUE;

   nCalc1 = nComp - 1;
   |SI nCalc1 < 0; nCalc1 = 0; |FINSI;

   nCont = 0; nCalc1 = 0;
   #rem01011#0 = VEmpresa;
   #rem01011#1 = 0;
   #rem01011#2 = aTipo; aTipo2 = #rem01011#2;
   #rem01011#3 = 0;
   |LEE 000#rem01011.];
   |PARA nComp = 0; |SI FSalida = 0; |Y #rem01011#0 = VEmpresa; |Y #rem01011#1 = 0; |Y #rem01011#2 = aTipo2; |HACIENDO nComp = nComp + 1;
      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         |SI #rem01011#0 ! VEmpresa; |O #rem01011#1 ! 0; |O #rem01011#2 ! aTipo2;
            |DDEFECTO #rem01011;
         |SINO;
            |LEE 000#rem01011.s;
         |FINSI;
      |SIGUE;
   |SIGUE;

   nCalc2 = nComp - 1;
   |SI nCalc2 < 0; nCalc2 = 0; |FINSI;
   |SI nCalc1 > nCalc2;
      nNumPag = nCalc1;
   |SINO;
      nNumPag = nCalc2;
   |FINSI;

   || N§ hojas adicionales de inmuebles
   LongDec = 0; TipoDato = "N";
   aAlfa = nNumPag; Long = 2; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   LongDec = 2; nNumPag = nNumPag + 1;

   #rem01011#0 = VEmpresa;
   #rem01011#1 = 0;
   #rem01011#2 = aTipo; aTipo2 = #rem01011#2;
   #rem01011#3 = 0;
   |LEE 000#rem01011.];
   |SI FSalida ! 0; |O #rem01011#0 ! VEmpresa; |O #rem01011#1 ! 0; |O #rem01011#2 ! aTipo2;
      |DDEFECTO #rem01011;
   |FINSI;

   #rem01013#0 = VEmpresa;
   #rem01013#1 = 0;
   #rem01013#2 = aTipo; aTipo2 = #rem01013#2;
   #rem01013#3 = 0;
   |LEE 000#rem01013.];
   |SI FSalida ! 0; |O #rem01013#0 ! VEmpresa; |O #rem01013#1 ! 0; |O #rem01013#2 ! aTipo2;
      |DDEFECTO #rem01013;
   |FINSI;

   |PARA nPagAct = 1; |SI nPagAct [ nNumPag; |HACIENDO nPagAct = nPagAct + 1;
      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         |SI #rem01011#0 ! VEmpresa; |O #rem01011#1 ! 0; |O #rem01011#2 ! aTipo2;
            |DDEFECTO #rem01011;
         |FINSI;

         || (C) Bienes inmuebles no afectos: A disposicion y arrendados o cedidos: Inmueble X : Contribuyente
         aAlfa = #rem01011#4; |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
         || Bienes inmuebles no afectos: A disposicion y arrendados o cedidos: Inmueble X : Porcentaje titularidad
         TipoDato = "N";  Long = 3;  LongDec = 2;
         aAlfa = #rem01011#5; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: A disposicion y arrendados o cedidos: Inmueble X : Naturaleza
         Long = 1; LongDec = 0;
         aAlfa = #rem01011#6; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: A disposicion y arrendados o cedidos: Inmueble X : Uso o destino. Clave
         aAlfa = #rem01011#7; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |SI #rem01011#7 = 1; #rem01011#10 = 0; |FINSI;
         || Bienes inmuebles no afectos: A disposicion y arrendados o cedidos: Inmueble X : Situacion
         aAlfa = #rem01011#8; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: A disposicion y arrendados o cedidos: Inmueble X : Referencia catastral
         TipoDato = "A";  Long = 20;  LongDec = 0;
         aAlfa = #rem01011#9; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: A disposicion: Inmueble X : Porcentaje disposicion
         TipoDato = "N";  Long = 3;  LongDec = 2;
         aAlfa = #rem01011#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         LongDec = 0;
         || Bienes inmuebles no afectos: A disposicion: Inmueble X : Numero de dias
         aAlfa = #rem01011#11; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: A disposicion: Inmueble X : Renta imputada
         Long = 11;  LongDec = 2;
         aAlfa = #rem01011#12; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: Arrendado o cedido: Inmueble X : Ingresos integros computables
         aAlfa = #rem01011#13; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: Arrendado o cedido: Inmueble X : Gtos.deducibles : Int.Capit.Inv. : En esta declaracion
         aAlfa = #rem01011#14; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: Arrendado o cedido: Inmueble X : Gtos.deducibles : Int.Capit.Inv. : Pdte.deducir
         aAlfa = #rem01011#15; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: Arrendado o cedido: Inmueble X : Gtos.deducibles : Otros gtos.fiscalmente deducibles
         aAlfa = #rem01011#16; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: Arrendado o cedido: Inmueble X : Gtos.deducibles : Rendimiento neto
         aAlfa = #rem01011#17; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: Arrendado o cedido: Inmueble X : Gtos.deducibles : Reduccion por arrendamiento destinado a vivienda
         aAlfa = #rem01011#18; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: Arrendado o cedido: Inmueble X : Gtos.deducibles : Reduc.rdtos.mas de 2 a¤os o forma irregular
         aAlfa = #rem01011#19; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: Arrendado o cedido: Inmueble X : Gtos.deducibles : Rdto.minimo computable en caso de parentesco
         aAlfa = #rem01011#20; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: Arrendado o cedido: Inmueble X : Gtos.deducibles : Rdto.neto reducido
         aAlfa = #rem01011#21; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";

         |LEE 000#rem01011.s;
         |SI FSalida ! 0; |O #rem01011#0 ! VEmpresa; |O #rem01011#1 ! 0; |O #rem01011#2 ! aTipo2;
            |DDEFECTO #rem01011;
         |FINSI;
      |SIGUE;

      |SI nPagAct = 1;
         || Bienes inmuebles no afectos: Rentas totales: Suma de rentas inmuebles a disposicion
         Bloque = 4; Casilla = "080"; |HAZ BuscaCasilla1;
         aAlfa = Casilla; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: Rentas totales: Suma de rdtos.reduc.inmuebles arrendados o cedidos
         Bloque = 4; Casilla = "085"; |HAZ BuscaCasilla1;
         aAlfa = Casilla; |HAZ Formateo1; Cadena = Cadena + aAlfa;
      |SINO;
         Cadena = Cadena + ("0" * 26);
      |FINSI;
      |HAZ GrabaCad1; Cadena = "";

      |PARA nCont = 1; |SI nCont [ 5; |HACIENDO nCont = nCont + 1;
         || (D) Bienes inmuebles urbanos afectos: Inmueble X: Contribuyente
         aAlfa = #rem01013#4; |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
         || Bienes inmuebles urbanos afectos: Inmueble X: Porcentaje titularidad
         TipoDato = "N";  Long = 3;  LongDec = 2;
         aAlfa = #rem01013#5;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Bienes inmuebles urbanos afectos: Inmueble X: Situacion
         aAlfa = #rem01013#9;  Cadena = Cadena + aAlfa;
         || Bienes inmuebles urbanos afectos: Inmueble X: Referencia catastral
         TipoDato = "A";  Long = 20;  LongDec = 0;
         aAlfa = #rem01013#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";

         |LEE 000#rem01013.s;
         |SI FSalida ! 0; |O #rem01013#0 ! VEmpresa; |O #rem01013#1 ! 0; |O #rem01013#2 ! aTipo2;
            |DDEFECTO #rem01013;
         |FINSI;
      |SIGUE;

      Cadena = "</T10004>" + &13 + &10; |HAZ GrabaCad1;
      |SI nPagAct < nNumPag;
         Cadena = "<T10004>C00"; |HAZ GrabaCad1; FSalida = 0;
      |FINSI;
   |SIGUE;

   |CIERRA #rem01013; |CIERRA #rem01011;
|FPRC;

|PROCESO Hoja05;

   nSwDatos = 5; nCalc1 = 0;
   |HAZ MiraSiDatos1;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "<T10005> ";
   |ABRE #rem01014;

   || Primero se calcula el n§ de paginas adicionales, puesto que las pide

   nCont = 0; nCalc1 = 0; nETAct = 0; nEnAct = 0;
   #rem01014#0 = VEmpresa;
   #rem01014#1 = 0;
   #rem01014#2 = aTipo; aTipo2 = #rem01014#2;
   #rem01014#3 = 1;
   |LEE 000#rem01014.];
   |PARA; |SI FSalida = 0; |Y #rem01014#0 = VEmpresa; |Y #rem01014#1 = 0;
    |Y #rem01014#2 = aTipo2; |HACIENDO;
      nETAct = nETAct + 1;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 4; nCont = nCont + 1; nCalc1 = 1;|FINSI;
      |LEE 000#rem01014.s;
   |SIGUE;

   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nCont; |HAZ Formateo1;
   Cadena = Cadena + aAlfa;
   TipoDato = "N";  Long = 11;  LongDec = 2;

   || Hecho esto, procedemos a leer registro a registro

   #rem01014#0 = VEmpresa;
   #rem01014#1 = 0;
   #rem01014#2 = aTipo; aTipo2 = #rem01014#2;
   #rem01014#3 = 1;
   |LEE 000#rem01014.];
   |PARA; |SI FSalida = 0; |Y #rem01014#0 = VEmpresa; |Y #rem01014#1 = 0;
          |Y #rem01014#2 = aTipo2; |HACIENDO;
      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         || (E1-1) Rend.Activ.econ.est.directa : Actividad X: Contribuyente que realiza la actividad
         aAlfa = #rem01014#4;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
         || Rend.Activ.econ.est.directa : Actividad X: Clave ident.tipo actividad
         TipoDato = "An"; Long = 1;   LongDec = 0;
         aAlfa = #rem01014#5;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Modalidad normal o simplificada
         aAlfa = "0";
         |SI #rem01014#8 = "X"; aAlfa = "1"; |FINSI;
         |SI #rem01014#9 = "X"; aAlfa = "2"; |FINSI;
         Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Grupo o epigrafe IAE
         Long = 5; aAlfa = #rem01014#7; |HAZ Epigrafe;
         |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Criterio de cobros y pagos
         |SI #rem01014#6 = " "; aAlfa = "0"; |SINO; aAlfa = "1"; |FINSI;
         TipoDato = "A"; Long = 1;    LongDec = 0;
                               |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Explotacion
         TipoDato = "N"; Long = 11;   LongDec = 2;
         aAlfa = #rem01014#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Otros ingresos
         aAlfa = #rem01014#11; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Autoconsumo de bienes y servicios
         aAlfa = #rem01014#12; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Total ingresos computables
         aAlfa = #rem01014#13; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Gastos consumos explotacion
         aAlfa = #rem01014#14; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Gastos sueldos y salarios
         aAlfa = #rem01014#15; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Gastos seguridad social
         aAlfa = #rem01014#16; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Otros gastos de personal
         aAlfa = #rem01014#17; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Gastos arrend.y canones
         aAlfa = #rem01014#18; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Gastos reparacion y conservacion
         aAlfa = #rem01014#19; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Gastos servicios profesionales independientes
         aAlfa = #rem01014#20; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Gastos suministros
         aAlfa = #rem01014#21; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Gastos otros serv.exteriores
         aAlfa = #rem01014#22; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Gastos tributos fisc.deducibles
         aAlfa = #rem01014#23; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Gastos financieros
         aAlfa = #rem01014#24; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Gastos amortizaciones
         aAlfa = #rem01014#25; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Incentivos mecenazgo : Convenios
         aAlfa = #rem01014#26; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Incentivos mecenazgo : Gastos
         aAlfa = #rem01014#27; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Otros gastos fiscalmente deducibles
         aAlfa = #rem01014#28; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Suma de gastos
         aAlfa = #rem01014#29; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Modal.normal : Decl.Actividad X: Provisiones
         aAlfa = #rem01014#30; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Modal.normal : Decl.Actividad X: Total gastos deducibles
         aAlfa = #rem01014#31; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Modal.Simplif. : Decl.Actividad X: Diferencia
         aAlfa = #rem01014#32; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Modal.Simplif. : Decl.Actividad X: Provisiones deducc./gastos dificil justif.
         aAlfa = #rem01014#33; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Modal.Simplif. : Decl.Actividad X: Total gastos deducibles
         aAlfa = #rem01014#34; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Rendimiento neto
         aAlfa = #rem01014#35; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Reducciones
         aAlfa = #rem01014#36; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Diferencia
         aAlfa = #rem01014#37; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Reduccion rdtos.reg.esp."Copa America"
         aAlfa = #rem01014#38; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Rendimiento neto reducido
         aAlfa = #rem01014#39; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1;

         nEnAct = nEnAct + 1;
         |LEE 000#rem01014.s;
         |SI FSalida ! 0; |O #rem01014#0 ! VEmpresa; |O #rem01014#1 ! 0;
          |O #rem01014#2 ! aTipo2;
            |DDEFECTO #rem01014;
         |FINSI;
      |SIGUE;

      || Rend.Activ.econ.est.directa : Rendimiento neto reducido total
      |SI nEnAct = 3;
         Bloque = 5; Casilla = "136"; |HAZ BuscaCasilla1;
      |SINO;
         Casilla = 0;
      |FINSI;
      aAlfa = Casilla; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;

      |SI nEnAct = 3;
         Bloque = 5; Casilla = "137"; |HAZ BuscaCasilla1;
      |SINO;
         Casilla = 0;
      |FINSI;
      aAlfa = Casilla; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;

      |SI nEnAct = 3;
         Bloque = 5; Casilla = "140"; |HAZ BuscaCasilla1;
      |SINO;
         Casilla = 0;
      |FINSI;
      aAlfa = Casilla; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;

      Cadena = "</T10005>" + &13 + &10; |HAZ GrabaCad1;
      |SI nEnAct < nETAct;
         Cadena = "<T10005>C0"; |HAZ GrabaCad1; FSalida = 0;
      |FINSI;
   |SIGUE;

   |CIERRA #rem01014;
|FPRC;

|PROCESO Hoja06;

   nSwDatos = 6; nCalc1 = 0;
   |HAZ MiraSiDatos1;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "<T10006> ";
   |ABRE #rem01019;

   || Primero se calcula el n§ de paginas adicionales, puesto que las pide

   nCont = 0; nCalc1 = 0; nETAct = 0; nEnAct = 0;
   #rem01019#0 = VEmpresa;
   #rem01019#1 = 0;
   #rem01019#2 = aTipo; aTipo2 = #rem01019#2;
   #rem01019#3 = 1;
   |LEE 000#rem01019.];
   |PARA; |SI FSalida = 0; |Y #rem01019#0 = VEmpresa; |Y #rem01019#1 = 0;
    |Y #rem01019#2 = aTipo2; |HACIENDO;
      nETAct = nETAct + 1;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 3; nCont = nCont + 1; nCalc1 = 1;|FINSI;
      |LEE 000#rem01019.s;
   |SIGUE;

   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nCont; |HAZ Formateo1;
   Cadena = Cadena + aAlfa;

   || Hecho esto, procedemos a leer registro a registro

   #rem01019#0 = VEmpresa;
   #rem01019#1 = 0;
   #rem01019#2 = aTipo; aTipo2 = #rem01019#2;
   #rem01019#3 = 1;
   |LEE 000#rem01019.];
   |PARA; |SI FSalida = 0; |Y #rem01019#0 = VEmpresa; |Y #rem01019#1 = 0;
          |Y #rem01019#2 = aTipo2; |HACIENDO;
      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         |SI #rem01019#0 ! VEmpresa; |O #rem01019#1 ! 0; |O #rem01019#2 ! aTipo2; |O nNoHay1 ! 0;
            |DDEFECTO #rem01019;
         |FINSI;
         TipoDato = "An"; LongDec = 0;
         || (E2) Rend.Activ.econ.est.objetiva: Actividad X: Clasificacion IAE
         Long = 5; aAlfa = #rem01019#4; |HAZ Epigrafe;
         |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Contribuyente que realiza la actividad
         aAlfa = #rem01019#5;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
         || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 1¦
         TipoDato = "A"; Long = 24;   LongDec = 0;
         aAlfa = #rem01019#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 1¦
         TipoDato = "N"; Long = 7;   LongDec = 2;
         aAlfa = #rem01019#7;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 1¦
         Long = 9;
         aAlfa = #rem01019#8;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 2¦
         TipoDato = "A"; Long = 24;   LongDec = 0;
         aAlfa = #rem01019#9;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 2¦
         TipoDato = "N"; Long = 7;   LongDec = 2;
         aAlfa = #rem01019#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 2¦
         Long = 9;
         aAlfa = #rem01019#11; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 3¦
         TipoDato = "A"; Long = 24;   LongDec = 0;
         aAlfa = #rem01019#12; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 3¦
         TipoDato = "N"; Long = 7;   LongDec = 2;
         aAlfa = #rem01019#13; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 3¦
         Long = 9;
         aAlfa = #rem01019#14; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 4¦
         TipoDato = "A"; Long = 24;   LongDec = 0;
         aAlfa = #rem01019#15;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 4¦
         TipoDato = "N"; Long = 7;   LongDec = 2;
         aAlfa = #rem01019#16; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 4¦
         Long = 9;
         aAlfa = #rem01019#17; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 5¦
         TipoDato = "A"; Long = 24;   LongDec = 0;
         aAlfa = #rem01019#18; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 5¦
         TipoDato = "N"; Long = 7;   LongDec = 2;
         aAlfa = #rem01019#19; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 5¦
         Long = 9;
         aAlfa = #rem01019#20; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1;

         || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 6¦
         TipoDato = "A"; Long = 24;   LongDec = 0;
         aAlfa = #rem01019#21;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 6¦
         TipoDato = "N"; Long = 7;   LongDec = 2;
         aAlfa = #rem01019#22; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 6¦
         Long = 9;
         aAlfa = #rem01019#23; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 7¦
         TipoDato = "A"; Long = 24;   LongDec = 0;
         aAlfa = #rem01019#24;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 7¦
         TipoDato = "N"; Long = 7;   LongDec = 2;
         aAlfa = #rem01019#25; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 7¦
         Long = 9;
         aAlfa = #rem01019#26; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Rendimiento Neto previo
         Long = 11;
         aAlfa = #rem01019#27; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Minorizaciones por incentivo al empleo
         aAlfa = #rem01019#28; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Minorizaciones por incentivo a la inversion
         aAlfa = #rem01019#29; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto minorado
         aAlfa = #rem01019#30; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Indice corrector especial
         Long = 2; LongDec = 2;
         aAlfa = #rem01019#31; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Indice corrector empresas peque¤a dimension
         aAlfa = #rem01019#32; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Indice corrector temporada
         aAlfa = #rem01019#33; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Indice corrector exceso
         aAlfa = #rem01019#34; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Indice corrector inicio nueva actividad
         aAlfa = #rem01019#35; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto de modulos
         Long = 11;
         aAlfa = #rem01019#36; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1;

         || Rend.Activ.econ.est.objetiva: Actividad X: Gastos extraordinarios
         aAlfa = #rem01019#37; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Otras percepciones empresariales
         aAlfa = #rem01019#40; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Total rendimiento neto
         aAlfa = #rem01019#41; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Reduccion Art.30 Ley 40/98
         aAlfa = #rem01019#42; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Total rendto.neto reducido
         aAlfa = #rem01019#43; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1;

         nEnAct = nEnAct + 1;
         |LEE 000#rem01019.s;
         |SI FSalida ! 0; |O #rem01019#0 ! VEmpresa; |O #rem01019#1 ! 0;
          |O #rem01019#2 ! aTipo2;
            |DDEFECTO #rem01019;
         |FINSI;
      |SIGUE;

      || Rend.Activ.econ.est.objetiva : Rendimiento neto reducido total
      TipoDato = "N"; Long = 11;   LongDec = 2;
      |SI nEnAct = 2;
         Bloque = 6; Casilla = "170"; |HAZ BuscaCasilla1;
      |SINO;
         Casilla = 0;
      |FINSI;
      aAlfa = Casilla; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
      Cadena = "</T10006>" + &13 + &10; |HAZ GrabaCad1;
      |SI nEnAct < nETAct;
         Cadena = "<T10006>C0"; |HAZ GrabaCad1; FSalida = 0;
      |FINSI;
   |SIGUE;

   |CIERRA #rem01019;
|FPRC;

|PROCESO Hoja07;

   nSwDatos = 7; nCalc1 = 0;
   |HAZ MiraSiDatos1;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "<T10007> ";
   |ABRE #rem01021;

   || Primero se calcula el n§ de paginas adicionales, puesto que las pide

   nCont = 0; nCalc1 = 0; nETAct = 0; nEnAct = 0;
   #rem01021#0 = VEmpresa;
   #rem01021#1 = 0;
   #rem01021#2 = aTipo; aTipo2 = #rem01021#2;
   #rem01021#3 = 1;
   |LEE 000#rem01021.];
   |PARA; |SI FSalida = 0; |Y #rem01021#0 = VEmpresa; |Y #rem01021#1 = 0;
    |Y #rem01021#2 = aTipo2; |HACIENDO;
      nETAct = nETAct + 1;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 3; nCont = nCont + 1; nCalc1 = 1;|FINSI;
      |LEE 000#rem01021.s;
   |SIGUE;

   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nCont; |HAZ Formateo1;
   Cadena = Cadena + aAlfa;

   || Hecho esto, procedemos a leer registro a registro

   #rem01021#0 = VEmpresa;
   #rem01021#1 = 0;
   #rem01021#2 = aTipo; aTipo2 = #rem01021#2;
   #rem01021#3 = 1;
   |LEE 000#rem01021.];
   |PARA; |SI FSalida = 0; |Y #rem01021#0 = VEmpresa; |Y #rem01021#1 = 0;
          |Y #rem01021#2 = aTipo2; |HACIENDO;
      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         || (E3) Rend.A.G.y F.est.objetiva: Actividad X: Clave de actividad
         TipoDato = "N"; Long = 1;   LongDec = 0;
         aAlfa = #rem01021#5;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Contribuyente que realiza la actividad
         aAlfa = #rem01021#6;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
         || Rend.A.G.y F.est.objetiva: Actividad X: Imputacion temporal
         aAlfa = #rem01021#4;
         |SI aAlfa = "X"; aAlfa = "1"; |SINO; aAlfa = "0"; |FINSI;
         Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 1
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#7;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 1
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#8 ] 0; aAlfa = #rem01021#8; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 1
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#9;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 2
         aAlfa = #rem01021#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 2
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#11 ] 0; aAlfa = #rem01021#11; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 2
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#12; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 3
         aAlfa = #rem01021#13; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 3
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#14 ] 0; aAlfa = #rem01021#14; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 3
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#15; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 4
         aAlfa = #rem01021#16; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 4
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#17 ] 0; aAlfa = #rem01021#17; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 4
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#18; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 5
         aAlfa = #rem01021#19; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 5
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#20 ] 0; aAlfa = #rem01021#20; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 5
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#21; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 6
         aAlfa = #rem01021#22; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 6
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#23 ] 0; aAlfa = #rem01021#23; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 6
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#24; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 7
         aAlfa = #rem01021#25; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 7
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#26 ] 0; aAlfa = #rem01021#26; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 7
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#27; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 8
         aAlfa = #rem01021#28; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 8
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#29 ] 0; aAlfa = #rem01021#29; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 8
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#30; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1;

         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 9
         aAlfa = #rem01021#31; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 9
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#32 ] 0; aAlfa = #rem01021#32; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 9
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#33; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 10
         aAlfa = #rem01021#34; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 10
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#35 ] 0; aAlfa = #rem01021#35; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 10
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#36; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 11
         aAlfa = #rem01021#37; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 11
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#38 ] 0; aAlfa = #rem01021#38; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 11
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#39; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 12
         aAlfa = #rem01021#40; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 12
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#41 ] 0; aAlfa = #rem01021#41; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 12
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#42; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 13
         aAlfa = #rem01021#43; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 13
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#44 ] 0; aAlfa = #rem01021#44; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 13
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#45; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Total ingresos
         aAlfa = #rem01021#46; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendimiento neto previo (suma)
         aAlfa = #rem01021#47; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Amortizacion inmovilizado
         aAlfa = #rem01021#48; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendimiento neto minorado
         aAlfa = #rem01021#49; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector medios ajenos
         TipoDato = "N"; Long = 2;   LongDec = 2;
         aAlfa = #rem01021#50; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector util.pers.asalariado
         aAlfa = #rem01021#51; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector cultivos tierras arrend.
         aAlfa = #rem01021#52; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector piensos adq.a terceros, mas del 50% : Indice 1
         aAlfa = #rem01021#53; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector piensos adq.a terceros, mas del 50% : Indice 2
         aAlfa = "0.0";        |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector act.agricultura ecologica
         aAlfa = #rem01021#54; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector empresa no supera los 9015.18 E
         aAlfa = #rem01021#55; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1;

         || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector determ.act.forestales
         aAlfa = #rem01021#56; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.neto de modulos
         TipoDato = "N"; Long = 11;   LongDec = 2;
         aAlfa = #rem01021#57; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Reduccion agricultores jovenes
         aAlfa = #rem01021#58; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Gastos extraordinarios por circunstancias excepcionales
         aAlfa = #rem01021#59; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendimiento neto
         aAlfa = #rem01021#60; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Reduccion rdtos.generados mas 2 a¤os o forma irregular
         aAlfa = #rem01021#61; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendimiento neto reducido
         aAlfa = #rem01021#62; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1;

         nEnAct = nEnAct + 1;
         |LEE 000#rem01021.s;
         |SI FSalida ! 0; |O #rem01021#0 ! VEmpresa; |O #rem01021#1 ! 0;
          |O #rem01021#2 ! aTipo2;
            |DDEFECTO #rem01021;
         |FINSI;
      |SIGUE;

      TipoDato = "N"; Long = 11;   LongDec = 2;
      |SI nEnAct = 2;
         Bloque = 7; Casilla = "195"; |HAZ BuscaCasilla1;
         aAlfa = Casilla; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
      |SINO;
         aAlfa = 0;       |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
      |FINSI;
      Cadena = "</T10007>" + &13 + &10; |HAZ GrabaCad1;
      |SI nEnAct < nETAct;
         Cadena = "<T10007>C0"; |HAZ GrabaCad1; FSalida = 0;
      |FINSI;
   |SIGUE;

   |CIERRA #rem01021;
|FPRC;

|PROCESO Hoja08;
   nSwDatos = 8; nCalc1 = 0;
   |HAZ MiraSiDatos1;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "<T10008> ";
   |ABRE #rem01022; |ABRE #rem01023; |ABRE #rem01024;
   |ABRE #rem01025; |ABRE #rem01026;

   || Primero se calcula el n§ de paginas adicionales, puesto que las pide

   nCont = 0; nNumActiv = 0;
   #rem01022#0 = VEmpresa;
   #rem01022#1 = 0;
   #rem01022#2 = aTipo; aTipo2 = #rem01022#2;
   #rem01022#3 = 1;
   |LEE 000#rem01022.];
   |PARA; |SI FSalida = 0; |Y #rem01022#0 = VEmpresa; |Y #rem01022#1 = 0;
    |Y #rem01022#2 = aTipo2; |HACIENDO;
      nCont = nCont + 1;
      |LEE 000#rem01022.s;
   |SIGUE;
   |SI nCont > nNumActiv; nNumActiv = nCont; |FINSI;

   nCont = 0;
   #rem01023#0 = VEmpresa;
   #rem01023#1 = 0;
   #rem01023#2 = aTipo; aTipo2 = #rem01023#2;
   #rem01023#3 = 1;
   |LEE 000#rem01023.];
   |PARA; |SI FSalida = 0; |Y #rem01023#0 = VEmpresa; |Y #rem01023#1 = 0;
    |Y #rem01023#2 = aTipo2; |HACIENDO;
      nCont = nCont + 1;
      |LEE 000#rem01023.s;
   |SIGUE;
   |SI nCont > nNumActiv; nNumActiv = nCont; |FINSI;

   nCont = 0;
   #rem01024#0 = VEmpresa;
   #rem01024#1 = 0;
   #rem01024#2 = aTipo; aTipo2 = #rem01024#2;
   #rem01024#3 = 1;
   |LEE 000#rem01024.];
   |PARA; |SI FSalida = 0; |Y #rem01024#0 = VEmpresa; |Y #rem01024#1 = 0;
    |Y #rem01024#2 = aTipo2; |HACIENDO;
      nCont = nCont + 1;
      |LEE 000#rem01024.s;
   |SIGUE;
   |SI nCont > nNumActiv; nNumActiv = nCont; |FINSI;

   nCont = 0;
   #rem01025#0 = VEmpresa;
   #rem01025#1 = 0;
   #rem01025#2 = aTipo; aTipo2 = #rem01025#2;
   #rem01025#3 = 1;
   |LEE 000#rem01025.];
   |PARA; |SI FSalida = 0; |Y #rem01025#0 = VEmpresa; |Y #rem01025#1 = 0;
    |Y #rem01025#2 = aTipo2; |HACIENDO;
      nCont = nCont + 1;
      |LEE 000#rem01025.s;
   |SIGUE;
   |SI nCont > nNumActiv; nNumActiv = nCont; |FINSI;

   nNumPags = ((nNumActiv / 3) + 0.49) ! 0;

   |SI nNumPags = 0; nNumPags = 1; |FINSI;

   nCont = nNumPags - 1;

   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nCont; |HAZ Formateo1;
   Cadena = Cadena + aAlfa;

   || Hecho esto, procedemos a leer registro a registro

   #rem01022#0 = VEmpresa;
   #rem01022#1 = 0;
   #rem01022#2 = aTipo; aTipo2 = #rem01022#2;
   #rem01022#3 = 1;
   |LEE 000#rem01022.];
   |SI FSalida ! 0; |O #rem01022#0 ! VEmpresa; |O #rem01022#1 ! 0; |O #rem01022#2 ! aTipo2;
      |DDEFECTO #rem01022;
   |FINSI;

   #rem01023#0 = VEmpresa;
   #rem01023#1 = 0;
   #rem01023#2 = aTipo; aTipo2 = #rem01023#2;
   #rem01023#3 = 1;
   |LEE 000#rem01023.];
   |SI FSalida ! 0; |O #rem01023#0 ! VEmpresa; |O #rem01023#1 ! 0; |O #rem01023#2 ! aTipo2;
      |DDEFECTO #rem01023;
   |FINSI;

   #rem01024#0 = VEmpresa;
   #rem01024#1 = 0;
   #rem01024#2 = aTipo; aTipo2 = #rem01024#2;
   #rem01024#3 = 1;
   |LEE 000#rem01024.];
   |SI FSalida ! 0; |O #rem01024#0 ! VEmpresa; |O #rem01024#1 ! 0; |O #rem01024#2 ! aTipo2;
      |DDEFECTO #rem01024;
   |FINSI;

   nCalc1 = 0; nCalc2 = 0;
   #rem01025#0 = VEmpresa;
   #rem01025#1 = 0;
   #rem01025#2 = aTipo; aTipo2 = #rem01025#2;
   #rem01025#3 = 1;
   |LEE 000#rem01025.];
   |SI FSalida ! 0; |O #rem01025#0 ! VEmpresa; |O #rem01025#1 ! 0; |O #rem01025#2 ! aTipo2;
      |DDEFECTO #rem01025;
   |FINSI;

   #rem01026#0 = VEmpresa;
   #rem01026#1 = 0;
   #rem01026#2 = aTipo;
   |LEE 000#rem01026.=;
   |SI FSalida ! 0; |DDEFECTO #rem01026; |FINSI;
   |PARA nPag = 1; |SI nPag [ nNumPags; |HACIENDO nPag = nPag + 1;
      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         || (F) Reg.esp.: R.E. Atribucion rentas : Entidad X : Participes : Contribuyente
         aAlfa = #rem01022#5;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Participes : NIF entidad
         TipoDato = "A"; Long = 9;   LongDec = 0;
         aAlfa = #rem01022#4;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Participes : Porcentaje participacion
         TipoDato = "N"; Long = 2;   LongDec = 2;
         aAlfa = #rem01022#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Rdto.Cap.Mob. : Rdto.Neto atribuido
         TipoDato = "N"; Long = 11;   LongDec = 2;
         aAlfa = #rem01022#7;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Rdto.Cap.Mob. : Reducciones y minoraciones
         aAlfa = #rem01022#8;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Rdto.Cap.Mob. : Rdto.Neto computable
         aAlfa = #rem01022#9;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Rdto.Cap.Mob. : Rdto.Neto
         aAlfa = #rem01022#21; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Rdto.Cap.inmob. : Rdto.Neto atribuido
         aAlfa = #rem01022#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Rdto.Cap.inmob. : Reducciones y minoraciones
         aAlfa = #rem01022#11; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Rdto.Cap.inmob. : Rdto.Neto computable
         aAlfa = #rem01022#12; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Rdto.Act.Econ. : Rdto.Neto atribuido
         aAlfa = #rem01022#13; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Rdto.Act.Econ. : Reducciones y minoraciones
         aAlfa = #rem01022#14; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Rdto.Act.Econ. : Rdto.Neto computable
         aAlfa = #rem01022#15; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Gan./Per.patrim 2007: No derivadas transmision - Ganancias
         aAlfa = #rem01022#16; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Gan./Per.patrim 2007: No derivadas transmision - Perdidas
         aAlfa = #rem01022#17; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Gan./Per.patrim 2007: Derivadas transmision - Ganancias
         aAlfa = #rem01022#18; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Gan./Per.patrim 2007: Derivadas transmision - Perdidas
         aAlfa = #rem01022#19; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Retencion e ing.a cuenta atribuidos
         aAlfa = #rem01022#20; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1;

         |SI #rem01022#0 = VEmpresa; |Y #rem01022#1 = 0; |Y #rem01022#2 = aTipo2;
            |LEE 000#rem01022.s;
            |SI FSalida ! 0; |O #rem01022#0 ! VEmpresa; |O #rem01022#1 ! 0; |O #rem01022#2 ! aTipo2;
               |DDEFECTO #rem01022;
            |FINSI;
         |FINSI;
      |SIGUE;

      |SI nPag = 1;
         || Reg.esp.: R.E. Atribucion rentas : rentas atribuidas : Rdto.integrar base imponible general - Total rdto.computable
         aAlfa = #rem01026#13; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : rentas atribuidas : Rdto.integrar base imponible ahorro - Total rdto.computable
         aAlfa = #rem01026#22; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : rentas atribuidas : Rdto.Cap.Inmob : Total Rdto.Computable
         aAlfa = #rem01026#14; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : rentas atribuidas : Rdto.Act.Econ. : Total Rdto.Computable
         aAlfa = #rem01026#15; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : rentas atribuidas : G/P Patr.2003 < 1 a¤o : Total Ganancias
         aAlfa = #rem01026#16; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : rentas atribuidas : G/P Patr.2003 < 1 a¤o : Total Perdidas
         aAlfa = #rem01026#17; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : rentas atribuidas : G/P Patr.2003 > 1 a¤o : Total Ganancias
         aAlfa = #rem01026#18; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : rentas atribuidas : G/P Patr.2003 > 1 a¤o : Total Perdidas
         aAlfa = #rem01026#19; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : rentas atribuidas : Retencion e ing.a cuenta atribuidos
         aAlfa = #rem01026#20; |HAZ Formateo1; Cadena = Cadena + aAlfa;
      |SINO;
         aAlfa = "0" * 117; Cadena = Cadena + aAlfa; |FINSI;
      |HAZ GrabaCad1;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         || Reg.esp.: Transp.fiscal, agrup. y ute : Entidad X: Socios : Contribuyente
         aAlfa = #rem01023#4;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
         || Reg.esp.: Transp.fiscal, agrup. y ute : Entidad X: Socios : NIF Entidad
         TipoDato = "A"; Long = 9;   LongDec = 0;
         aAlfa = #rem01023#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: Transp.fiscal, agrup. y ute : Entidad X: Socios : Clave tipo entidad
         Long = 1;
         aAlfa = #rem01023#19;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: Transp.fiscal, agrup. y ute : Entidad X: Imp.Base imp. y deduc. : Base imponible imputada
         TipoDato = "N"; Long = 11;   LongDec = 2;
         aAlfa = #rem01023#7;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: Transp.fiscal, agrup. y ute : Entidad X: Imp.Base imp. y deduc. : Deduc.inv.empresarial
         aAlfa = #rem01023#11; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: Transp.fiscal, agrup. y ute : Entidad X: Imp.Base imp. y deduc. : Deduc.creacion empleo
         aAlfa = #rem01023#12; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: Transp.fiscal, agrup. y ute : Entidad X: Imp.Base imp. y deduc. : Deduc.rentas Ceuta/Melilla
         aAlfa = #rem01023#8;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: Transp.fiscal, agrup. y ute : Entidad X: Imp.Base imp. y deduc. : Deduc.doble imposic.internac.
         aAlfa = #rem01023#10;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: Transp.fiscal, agrup. y ute : Entidad X: Imp.otros conceptos : Pagos frac.ret.e ing.a cta.
         aAlfa = #rem01023#13;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1;

         |SI #rem01023#0 = VEmpresa; |Y #rem01023#1 = 0; |Y #rem01023#2 = aTipo2;
            |LEE 000#rem01023.s;
            |SI FSalida ! 0; |O #rem01023#0 ! VEmpresa; |O #rem01023#1 ! 0; |O #rem01023#2 ! aTipo2;
               |DDEFECTO #rem01023;
            |FINSI;
         |FINSI;
      |SIGUE;

      |SI nPag = 1;
         || Reg.esp.: Transp.fiscal, agrup. y ute : Total base imponible imputada
         aAlfa = #rem01026#3; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: Transp.fiscal, agrup. y ute : Total Retenciones e ingresos a cuenta imputados
         aAlfa = #rem01026#4; |HAZ Formateo1; Cadena = Cadena + aAlfa;
      |SINO;
         aAlfa = "0" * 26; Cadena = Cadena + aAlfa;
      |FINSI;
      |HAZ GrabaCad1;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         || Reg.esp.: Imputacion rentas positivas reg.transp.fiscal intern.: Entidad X : Contribuyente
         aAlfa = #rem01024#5;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
         || Reg.esp.: Imputacion rentas positivas reg.transp.fiscal intern.: Entidad X : Denominacion entidad
         TipoDato = "An"; Long = 24;   LongDec = 0;
         aAlfa = #rem01024#4;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: Imputacion rentas positivas reg.transp.fiscal intern.: Entidad X : Criterio imputacion
         TipoDato = "An"; Long = 1;
         aAlfa = #rem01024#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: Imputacion rentas positivas reg.transp.fiscal intern.: Entidad X : Importe imputacion
         TipoDato = "N"; Long = 11;   LongDec = 2;
         aAlfa = #rem01024#10;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1;

         |SI #rem01024#0 = VEmpresa; |Y #rem01024#1 = 0; |Y #rem01024#2 = aTipo2;
            |LEE 000#rem01024.s;
            |SI FSalida ! 0; |O #rem01024#0 ! VEmpresa; |O #rem01024#1 ! 0; |O #rem01024#2 ! aTipo2;
               |DDEFECTO #rem01024;
            |FINSI;
         |FINSI;
      |SIGUE;

      |SI nPag = 1;
         || Reg.esp.: Imputacion rentas positivas reg.transp.fiscal intern.: Total importe de la imputacion
         aAlfa = #rem01026#6; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: Imputacion rentas derechos imagen : Contribuyente
         aAlfa = #rem01026#7;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
         || Reg.esp.: Imputacion rentas derechos imagen : NIF o denom.cesionario derechos
         TipoDato = "An"; Long = 25; LongDec = 0;
         aAlfa = #rem01026#8; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: Imputacion rentas derechos imagen : NIF o denom.relacion laboral
         aAlfa = #rem01026#9; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp.: Imputacion rentas derechos imagen : Cantidad a imputar en la B.I.
         TipoDato = "N"; Long = 11; LongDec = 2;
         aAlfa = #rem01026#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
      |SINO;
         aAlfa = "0" * 14; Cadena = Cadena + aAlfa;
         aAlfa = " " * 50; Cadena = Cadena + aAlfa;
         aAlfa = "0" * 13; Cadena = Cadena + aAlfa;
      |FINSI;
      |HAZ GrabaCad1;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         || Reg.esp. : Imputacion rentas I.I.Colectiva paraisos fiscales : I.I.C. 1 : Contribuyente
         aAlfa = #rem01025#5;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
         || Reg.esp. : Imputacion rentas I.I.Colectiva paraisos fiscales : I.I.C. 1 : Denominacion Instit.
         TipoDato = "An"; Long = 24;   LongDec = 0;
         aAlfa = #rem01025#4;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Reg.esp. : Imputacion rentas I.I.Colectiva paraisos fiscales : I.I.C. 1 : Importe imputacion
         TipoDato = "N"; Long = 11;   LongDec = 2;
         aAlfa = #rem01025#8;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1;

         |SI #rem01025#0 = VEmpresa; |Y #rem01025#1 = 0; |Y #rem01025#2 = aTipo2;
            |LEE 000#rem01025.s;
            |SI FSalida ! 0; |O #rem01025#0 ! VEmpresa; |O #rem01025#1 ! 0; |O #rem01025#2 ! aTipo2;
               |DDEFECTO #rem01025;
            |FINSI;
         |FINSI;
      |SIGUE;

      |SI nPag = 1;
         || Reg.esp. : Imputacion rentas I.I.Colectiva paraisos fiscales : Total importe imputacion
         aAlfa = #rem01026#11; |HAZ Formateo1; Cadena = Cadena + aAlfa;
      |SINO;
         aAlfa = "0" * 13; Cadena = Cadena + aAlfa;
      |FINSI;
      |HAZ GrabaCad1;

      Cadena = "</T10008>" + &13 + &10; |HAZ GrabaCad1;
      |SI nPag < nNumPags;
         Cadena = "<T10008>C0"; |HAZ GrabaCad1;
      |FINSI;
   |SIGUE;

   |CIERRA #rem01026; |CIERRA #rem01025; |CIERRA #rem01024;
   |CIERRA #rem01023; |CIERRA #rem01022;
|FPRC;

|PROCESO Hoja09;
   nSwDatos = 9; nCalc1 = 0;
   |HAZ MiraSiDatos1;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "<T10009> ";
   |ABRE #rem01027; |ABRE #rem01031; |ABRE #rem01039; |ABRE #rem01033;

   || Primero se calcula el n§ de paginas adicionales, puesto que las pide

   nCont = 0; nNumActiv = 0; nPag = 1;
   #rem01027#0 = VEmpresa;
   #rem01027#1 = 0;
   #rem01027#2 = aTipo; aTipo2 = #rem01027#2;
   #rem01027#3 = 1;
   |LEE 000#rem01027.];
   |PARA; |SI FSalida = 0; |Y #rem01027#0 = VEmpresa; |Y #rem01027#1 = 0;
    |Y #rem01027#2 = aTipo2; |HACIENDO;
      nCont = nCont + 1;
      |LEE 000#rem01027.s;
   |SIGUE;
   |SI nCont > nNumActiv; nNumActiv = nCont; |FINSI;

   nCont = 0;
   #rem01031#0 = VEmpresa;
   #rem01031#1 = 0;
   #rem01031#2 = aTipo; aTipo2 = #rem01031#2;
   #rem01031#3 = 1;
   |LEE 000#rem01031.];
   |PARA; |SI FSalida = 0; |Y #rem01031#0 = VEmpresa; |Y #rem01031#1 = 0;
    |Y #rem01031#2 = aTipo2; |HACIENDO;
      nCont = nCont + 1;
      |LEE 000#rem01031.s;
   |SIGUE;
   nNumActiv1 = nCont;

   nCont = 0;
   #rem01039#0 = VEmpresa;
   #rem01039#1 = 0;
   #rem01039#2 = aTipo; aTipo2 = #rem01039#2;
   #rem01039#3 = 1;
   |LEE 000#rem01039.];
   |PARA; |SI FSalida = 0; |Y #rem01039#0 = VEmpresa; |Y #rem01039#1 = 0;
    |Y #rem01039#2 = aTipo2; |HACIENDO;
      nCont = nCont + 1;
      |LEE 000#rem01039.s;
   |SIGUE;
   |SI nCont > nNumActiv; nNumActiv = nCont; |FINSI;

   nNumPags = ((nNumActiv  / 3) + 0.49) ! 0;
   nCalc    = ((nNumActiv1 / 2) + 0.49) ! 0;
   |SI nNumPags < nCalc; nNumPags = nCalc; |FINSI;

   || Hecho esto, procedemos a leer registro a registro

   #rem01027#0 = VEmpresa;
   #rem01027#1 = 0;
   #rem01027#2 = aTipo; aTipo2 = #rem01027#2;
   #rem01027#3 = 1;
   |LEE 000#rem01027.];
   |SI FSalida ! 0; |O #rem01027#0 ! VEmpresa; |O #rem01027#1 ! 0; |O #rem01027#2 ! aTipo2;
      |DDEFECTO #rem01027;
   |FINSI;

   #rem01031#0 = VEmpresa;
   #rem01031#1 = 0;
   #rem01031#2 = aTipo; aTipo2 = #rem01031#2;
   #rem01031#3 = 1;
   |LEE 000#rem01031.];
   |SI FSalida ! 0; |O #rem01031#0 ! VEmpresa; |O #rem01031#1 ! 0; |O #rem01031#2 ! aTipo2;
      |DDEFECTO #rem01031;
   |FINSI;

   #rem01039#0 = VEmpresa;
   #rem01039#1 = 0;
   #rem01039#2 = aTipo; aTipo2 = #rem01039#2;
   #rem01039#3 = 1;
   |LEE 000#rem01039.];
   |SI FSalida ! 0; |O #rem01039#0 ! VEmpresa; |O #rem01039#1 ! 0; |O #rem01039#2 ! aTipo2;
      |DDEFECTO #rem01039;
   |FINSI;

   #rem01033#0 = VEmpresa;
   #rem01033#1 = 0;
   #rem01033#2 = aTipo;
   |LEE 000#rem01033.=;
   |SI FSalida ! 0; |DDEFECTO #rem01033; |FINSI;

   |SI nNumPags = 0; nNumPags = 1; |FINSI;

   nCont = nNumPags - 1;
   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nCont; |HAZ Formateo1;
   Cadena = Cadena + aAlfa;

   |PARA nPag = 1; |SI nPag [ nNumPags; |HACIENDO nPag = nPag + 1;
      |SI nPag = 1;
         TipoDato = "N";  Long = 11;  LongDec = 2;
         || (G-1) Ganancias/Perdidas patrimoniales no derivan transmision : Premios, juegos, concursos, rifas : Premio en metalico : Importe total
         aAlfa = #rem01033#3;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales no derivan transmision : Premios, juegos, concursos, rifas : Premio en especie : Valoracion
         aAlfa = #rem01033#4;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales no derivan transmision : Premios, juegos, concursos, rifas : Premio en especie : Ingresos a cuenta
         aAlfa = #rem01033#5;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales no derivan transmision : Premios, juegos, concursos, rifas : Premio en especie : Ingresos a cuenta repercutidos
         aAlfa = #rem01033#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales no derivan transmision : Premios, juegos, concursos, rifas : Premio en especie : Importe computable
         aAlfa = #rem01033#7;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales no derivan transmision : Otras ganancias/perdidas : Subvenciones/ayudas adquisicion/rehabilitacion de la vivienda habitual 2007
         aAlfa = #rem01033#8;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales no derivan transmision : Otras ganancias/perdidas : Ganancias patrimoniales vecinos 2007, aprovechamientos forestales
         aAlfa = #rem01033#9;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales no derivan transmision : Otras ganancias/perdidas : Otras ganancias 2007, no derivadas transmision
         aAlfa = #rem01033#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales no derivan transmision : Otras ganancias/perdidas : Perdidas patrimoniales 2007, no derivadas transmision
         aAlfa = #rem01033#11; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";
      |SINO;
         aAlfa = "0" * 111; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         || (G-2) Ganancias/Perdidas patrimoniales deriv.transmision : Inst.Inv.Colectiva : Sociedad/Fondo X : Contribuyente
         aAlfa = #rem01027#5;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Inst.Inv.Colectiva : Sociedad/Fondo X : NIF
         TipoDato = "An"; Long = 9;   LongDec = 0;
         aAlfa = #rem01027#4;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Inst.Inv.Colectiva : Sociedad/Fondo X : Result.Netos Positivos : Ganancias netas
         TipoDato = "N";  Long = 11;  LongDec = 2;
         aAlfa = #rem01027#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Inst.Inv.Colectiva : Sociedad/Fondo X : Result.Netos Positivos : Perdidas netas
         aAlfa = #rem01027#7;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";

         |SI #rem01027#0 = VEmpresa; |Y #rem01027#1 = 0; |Y #rem01027#2 = aTipo2;
            |LEE 000#rem01027.s;
            |SI FSalida ! 0; |O #rem01027#0 ! VEmpresa; |O #rem01027#1 ! 0; |O #rem01027#2 ! aTipo2;
               |DDEFECTO #rem01027;
            |FINSI;
         |FINSI;
      |SIGUE;

      |SI nPag = 1;
         TipoDato = "N";  Long = 11;  LongDec = 2;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Inst.Inv.Colectiva : Totales : Total ganancias netas
         aAlfa = #rem01033#12;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Inst.Inv.Colectiva : Totales : Total perdidas netas
         aAlfa = #rem01033#13;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";
      |SINO;
         aAlfa = "0" * 26; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Mercados oficiales : Entidad X : Contribuyente
         aAlfa = #rem01039#5;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Mercados oficiales : Entidad X : Denominacion valores
         TipoDato = "An"; Long = 20;  LongDec = 0;
         aAlfa = #rem01039#4;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Mercados oficiales : Entidad X : Importe global 2007
         TipoDato = "N"; Long = 11;  LongDec = 2;
         aAlfa = #rem01039#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Mercados oficiales : Entidad X : Valor adquisicion global
         aAlfa = #rem01039#7;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Mercados oficiales : Entidad X : Resultados - Ganancias. Importe obtenido
         aAlfa = #rem01039#8;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Mercados oficiales : Entidad X : Resultados - Ganancias. Importe reducido
         aAlfa = #rem01039#9;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Mercados oficiales : Entidad X : Resultados - Perdidas. Importe obtenido
         aAlfa = #rem01039#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Mercados oficiales : Entidad X : Resultados - Perdidas. Importe reducido
         aAlfa = #rem01039#11; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";

         |SI #rem01039#0 = VEmpresa; |Y #rem01039#1 = 0; |Y #rem01039#2 = aTipo2;
            |LEE 000#rem01039.s;
            |SI FSalida ! 0; |O #rem01039#0 ! VEmpresa; |O #rem01039#1 ! 0; |O #rem01039#2 ! aTipo2;
               |DDEFECTO #rem01039;
            |FINSI;
         |FINSI;
      |SIGUE;

      |SI nPag = 1;
         TipoDato = "N";  Long = 11;  LongDec = 2;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Mercados oficiales : Totales : Ganancias. Importe reducido
         aAlfa = #rem01033#14;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Mercados oficiales : Totales : Perdidas. Importe imputable
         aAlfa = #rem01033#15;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";
      |SINO;
         aAlfa = "0" * 26; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         || (G-3) Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : Contribuyente
         aAlfa = #rem01031#5; |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : Tipo elemento
         TipoDato = "N"; Long = 1;  LongDec = 0;
         aAlfa = #rem01031#6; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : Inmuebles Situacion : Clave
         aAlfa = #rem01031#23; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : Inmuebles Situacion : Ref.Catastral
         TipoDato = "A"; Long = 20;  LongDec = 0;
         aAlfa = #rem01031#24;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : Fecha transmision
         TipoDato = "F";
         aAlfa = #rem01031#8;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : Fecha adquisicion
         aAlfa = #rem01031#7;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : Valor transmision
         TipoDato = "N"; Long = 11;  LongDec = 2;
         aAlfa = #rem01031#9;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : Valor adquisicion
         aAlfa = #rem01031#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : Diferencia obtenida : Perdida obtenida
         aAlfa = #rem01031#11; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : Diferencia obtenida : Perdida imputable
         aAlfa = #rem01031#12; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : Diferencia obtenida : Ganancia obtenida
         aAlfa = #rem01031#13; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : No afectos : Parte ganancia susceptible reduccion
         aAlfa = #rem01031#26; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : No afectos : A¤os permanencia hasta 31/12/94
         TipoDato = "N"; Long = 4;  LongDec = 0;
         nCalc = #rem01031#14; nCalc = nCalc - 2;  || En el programa se toman hasta el 31/12/1996
         |SI nCalc < 0; nCalc = 0; |FINSI;
         aAlfa = nCalc; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : No afectos : Reduccion aplicable
         TipoDato = "N"; Long = 11;  LongDec = 2;
         aAlfa = #rem01031#27; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : No afectos : Ganancia reducida
         aAlfa = #rem01031#15; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : No afectos : Ganancia exenta reinversion vivienda hab.
         aAlfa = #rem01031#16; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : No afectos : Ganancia reducida no exenta
         aAlfa = #rem01031#17; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : No afectos : Ganancia reducida no exenta imputable 2007
         aAlfa = #rem01031#18; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : No afectos : Reduccion (licencia autotaxis)
         aAlfa = #rem01031#19; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : No afectos : Ganancia reducida
         aAlfa = #rem01031#20; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : No afectos : Ganancia reducida imputable 2007
         aAlfa = #rem01031#22; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";

         |SI #rem01031#0 = VEmpresa; |Y #rem01031#1 = 0; |Y #rem01031#2 = aTipo2;
            |LEE 000#rem01031.s;
            |SI FSalida ! 0; |O #rem01031#0 ! VEmpresa; |O #rem01031#1 ! 0; |O #rem01031#2 ! aTipo2;
               |DDEFECTO #rem01031;
            |FINSI;
         |FINSI;
      |SIGUE;

      |SI nPag = 1;
         TipoDato = "N";  Long = 11;  LongDec = 2;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Totales : Total perdida imputable 2007
         aAlfa = #rem01033#16;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Totales : No afectos : Total ganancia reducida imputable 2007
         aAlfa = #rem01033#17;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Totales : Afectos : Total ganancia reducida imputable 2007
         aAlfa = #rem01033#18;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";
      |SINO;
         aAlfa = "0" * 39; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";
      |FINSI;

      Cadena = "</T10009>" + &13 + &10; |HAZ GrabaCad1;

      |SI nPag < nNumPags;
         Cadena = "<T10009>C0000000"; |HAZ GrabaCad1;
      |FINSI;
      Cadena = "";
   |SIGUE;

   |CIERRA #rem01033; |CIERRA #rem01027; |CIERRA #rem01031;
|FPRC;

|PROCESO Hoja10;
   nCalc1 = 0;
   aTipo = VTipo % 0110;

   Cadena = "<T10010> ";
   |ABRE #rem01030; |ABRE #rem01032; |ABRE #rem01033;

   || Primero se calcula el n§ de paginas adicionales, puesto que las pide

   nCont = 0; nNumActiv = 0;
   #rem01030#0 = VEmpresa;
   #rem01030#1 = 0;
   #rem01030#2 = aTipo; aTipo2 = #rem01030#2;
   #rem01030#3 = 1;
   |LEE 000#rem01030.];
   |PARA; |SI FSalida = 0; |Y #rem01030#0 = VEmpresa; |Y #rem01030#1 = 0;
    |Y #rem01030#2 = aTipo2; |HACIENDO;
      nCont = nCont + 1;
      |LEE 000#rem01030.s;
   |SIGUE;
   |SI nCont > nNumActiv; nNumActiv = nCont; |FINSI;

   nCont = 0; nNumActiv2 = 0;
   #rem01032#0 = VEmpresa;
   #rem01032#1 = 0;
   #rem01032#2 = aTipo; aTipo2 = #rem01032#2;
   #rem01032#3 = 1;
   |LEE 000#rem01032.];
   |PARA; |SI FSalida = 0; |Y #rem01032#0 = VEmpresa; |Y #rem01032#1 = 0;
    |Y #rem01032#2 = aTipo2; |HACIENDO;
      |SI #rem01032#6 ! 0; nCont = nCont + 1; |FINSI;
      |LEE 000#rem01032.s;
   |SIGUE;
   |SI nCont > nNumActiv2; nNumActiv2 = nCont; |FINSI;

   || 2o. Bucle para las perdidas
   nCont = 0;
   #rem01032#0 = VEmpresa;
   #rem01032#1 = 0;
   #rem01032#2 = aTipo; aTipo2 = #rem01032#2;
   #rem01032#3 = 1;
   |LEE 000#rem01032.];
   |PARA; |SI FSalida = 0; |Y #rem01032#0 = VEmpresa; |Y #rem01032#1 = 0;
    |Y #rem01032#2 = aTipo2; |HACIENDO;
      |SI #rem01032#8 ! 0; nCont = nCont + 1; |FINSI;
      |LEE 000#rem01032.s;
   |SIGUE;
   |SI nCont > nNumActiv2; nNumActiv2 = nCont; |FINSI;

   nNumPags = ((nNumActiv / 3) + 0.49) ! 0;
   nCalc = ((nNumActiv2 / 3) + 0.49) ! 0;
   |SI nCalc > nNumPags; nNumPags = nCalc; |FINSI;

   || Hecho esto, procedemos a leer registro a registro

   #rem01030#0 = VEmpresa;
   #rem01030#1 = 0;
   #rem01030#2 = aTipo; aTipo2 = #rem01030#2;
   #rem01030#3 = 1;
   |LEE 000#rem01030.];
   |SI FSalida ! 0; |O #rem01030#0 ! VEmpresa; |O #rem01030#1 ! 0; |O #rem01030#2 ! aTipo2;
      |DDEFECTO #rem01030;
   |FINSI;

   #rem01032#0 = VEmpresa;
   #rem01032#1 = 0;
   #rem01032#2 = aTipo; aTipo2 = #rem01032#2;
   #rem01032#3 = 1;
   |LEE 000#rem01032.];
   |SI FSalida ! 0; |O #rem01032#0 ! VEmpresa; |O #rem01032#1 ! 0; |O #rem01032#2 ! aTipo2;
      |DDEFECTO #rem01032;
   |FINSI;

   #rem01033#0 = VEmpresa;
   #rem01033#1 = 0;
   #rem01033#2 = aTipo;
   |LEE 000#rem01033.=;
   |SI FSalida ! 0; |DDEFECTO #rem01033; |FINSI;

   |SI nNumPags = 0; nNumPags = 1; |FINSI;

   nCont = nNumPags - 1;
   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nCont; |HAZ Formateo1;
   Cadena = Cadena + aAlfa;

   nNumLin1 = 1; nNumLin2 = 1; nNumLin3 = 1; nNumLin4 = 1;
   |PARA nPag = 1; |SI nPag [ nNumPags; |HACIENDO nPag = nPag + 1;
      #rem01032#0 = VEmpresa;
      #rem01032#1 = 0;
      #rem01032#2 = aTipo; aTipo2 = #rem01032#2;
      #rem01032#2 = aTipo;
      #rem01032#3 = nNumLin3;
      |LEE 000#rem01032.];
      |PARA; |SI FSalida = 0; |Y #rem01032#0 = VEmpresa; |Y #rem01032#1 = 0; |Y #rem01032#2 ! aTipo2; |HACIENDO;
         |SI #rem01032#6 ! 0; nNumLin3 = #rem01032#3 + 1; |SAL; |FINSI;
         |LEE 000#rem01032.s;
      |SIGUE;
      |SI FSalida ! 0; |O #rem01032#0 ! VEmpresa; |O #rem01032#1 ! 0; |O #rem01032#2 ! aTipo2;
         |DDEFECTO #rem01032;
      |SINO;
         |SI #rem01032#6 = 0; |DDEFECTO #rem01032; |FINSI;
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         || (G-2) Ganancias/perdidas patrim.deriv.transmision : Imput.a 2007 ejerc.anter. : Ganancia X : Contribuyente
         aAlfa = #rem01032#4;   |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
         || Ganancias/perdidas patrim.deriv.transmision : Imput.a 2007 ejerc.anter. : Ganancia X : Importe ganancia
         TipoDato = "N";  Long = 11;   LongDec = 2;
         aAlfa = #rem01032#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";

         nNumLinAnt = #rem01032#3;
         |LEE 000#rem01032.s;
         |PARA; |SI FSalida = 0; |Y #rem01032#0 = VEmpresa; |Y #rem01032#1 = 0; |Y #rem01032#2 = aTipo2; |HACIENDO;
            |SI #rem01032#6 ! 0; nNumLin3 = #rem01032#3; |SAL; |FINSI;
            |LEE 000#rem01032.s;
         |SIGUE;
         |SI FSalida ! 0; |O #rem01032#0 ! VEmpresa; |O #rem01032#1 ! 0; |O #rem01032#2 ! aTipo2;
            |DDEFECTO #rem01032;
            |SI nNumLinAnt = nNumLin3; nNumLin3 = 999; |FINSI;
         |SINO;
            |SI #rem01032#6 = 0; |DDEFECTO #rem01032; |FINSI;
         |FINSI;
      |SIGUE;

      |SI nPag = 1;
         TipoDato = "N";  Long = 11;  LongDec = 2;
         || Ganancias/perdidas patrim.deriv.transmision : Imput.a 2007 ejerc.anter. : Total ganancias
         aAlfa = #rem01033#19;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";
      |SINO;
         aAlfa = "0" * 13; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";
      |FINSI;

      #rem01032#0 = VEmpresa;
      #rem01032#1 = 0;
      #rem01032#2 = aTipo; aTipo2 = #rem01032#2;
      #rem01032#3 = nNumLin4;
      |LEE 000#rem01032.];
      |PARA; |SI FSalida = 0; |Y #rem01032#0 = VEmpresa; |Y #rem01032#1 = 0; |Y #rem01032#2 = aTipo2; |HACIENDO;
         |SI #rem01032#8 ! 0; nNumLin4 = #rem01032#3 + 1; |SAL; |FINSI;
         |LEE 000#rem01032.s;
      |SIGUE;
      |SI FSalida ! 0; |O #rem01032#0 ! VEmpresa; |O #rem01032#1 ! 0; |O #rem01032#2 ! aTipo2;
         |DDEFECTO #rem01032;
      |SINO;
         |SI #rem01032#8 = 0; |DDEFECTO #rem01032; |FINSI;
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         || Ganancias/perdidas patrim.deriv.transmision : Imput.a 2007 ejerc.anter. : Perdida X : Contribuyente
         aAlfa = #rem01032#4;   |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
         || Ganancias/perdidas patrim.deriv.transmision : Imput.a 2007 ejerc.anter. : Perdida X : Importe ganancia
         TipoDato = "N";  Long = 11;   LongDec = 2;
         aAlfa = #rem01032#8;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";

         nNumLinAnt = #rem01032#3;
         |LEE 000#rem01032.s;
         |PARA; |SI FSalida = 0; |Y #rem01032#0 = VEmpresa; |Y #rem01032#1 = 0; |Y #rem01032#2 = aTipo2; |HACIENDO;
            |SI #rem01032#8 ! 0; nNumLin4 = #rem01032#3; |SAL; |FINSI;
            |LEE 000#rem01032.s;
         |SIGUE;
         |SI FSalida ! 0; |O #rem01032#0 ! VEmpresa; |O #rem01032#1 ! 0; |O #rem01032#2 ! aTipo2;
            |DDEFECTO #rem01032;
            |SI nNumLinAnt = nNumLin4; nNumLin4 = 999; |FINSI;
         |SINO;
            |SI #rem01032#8 = 0; |DDEFECTO #rem01032; |FINSI;
         |FINSI;
      |SIGUE;

      |SI nPag = 1;
         TipoDato = "N";  Long = 11;  LongDec = 2;
         || Ganancias/perdidas patrim.deriv.transmision : Imput.a 2007 ejerc.anter. : Total perdidas
         aAlfa = #rem01033#20;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";
      |SINO;
         aAlfa = "0" * 13; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         || Ganancias/perdidas patrim.deriv.transmision : Imput.a 2007 difer.reinversion : Ganancia X : Contribuyente
         aAlfa = #rem01030#4;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
         || Ganancias/perdidas patrim.deriv.transmision : Imput.a 2007 difer.reinversion : Ganancia X : Importe ganancia
         TipoDato = "N";  Long = 11;  LongDec = 2;
         aAlfa = #rem01030#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/perdidas patrim.deriv.transmision : Imput.a 2007 difer.reinversion : Ganancia X : Metodo integracion : Clave
         TipoDato = "A";  Long = 1;  LongDec = 0;
         aAlfa = #rem01030#7;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";

         |SI #rem01030#0 = VEmpresa; |Y #rem01030#1 = 0; |Y #rem01030#2 = aTipo2;
            |LEE 000#rem01030.s;
            |SI FSalida ! 0; |O #rem01030#0 ! VEmpresa; |O #rem01030#1 ! 0; |O #rem01030#2 ! aTipo2;
               |DDEFECTO #rem01030;
            |FINSI;
         |FINSI;
      |SIGUE;

      |SI nPag = 1;
         TipoDato = "N";  Long = 11;  LongDec = 2;
         || Ganancias/perdidas patrim.deriv.transmision : Imput.a 2007 difer.reinversion : Total ganancia
         aAlfa = #rem01033#21;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || (G-3) Exencion por reinversion ganancia patrimonial 2007 transm.vivienda hab. - Importe susceptible de reinversion
         aAlfa = #rem01033#22;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Exencion por reinversion ganancia patrimonial 2007 transm.vivienda hab. - Ganancia patrimonial consecuencia transmision
         aAlfa = #rem01033#23;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Exencion por reinversion ganancia patrimonial 2007 transm.vivienda hab. - Importe reinvertido a 31/12/2007 adqu.nueva vivienda
         aAlfa = #rem01033#24;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Exencion por reinversion ganancia patrimonial 2007 transm.vivienda hab. - Importe comprometido a reinvertir en 2 a¤os proximos
         aAlfa = #rem01033#25;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Exencion por reinversion ganancia patrimonial 2007 transm.vivienda hab. - Ganancia patrimonial exenta por reinversion
         aAlfa = #rem01033#26;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || (G-4) Opcion regimen especial fusiones, escisiones y canje valores entidades no residentes en Espa¤a : Contribuyente 1
         TipoDato = "N";  Long = 2;  LongDec = 0;
         aAlfa = #rem01033#27;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
         || Opcion regimen especial fusiones, escisiones y canje valores entidades no residentes en Espa¤a : Numero operaciones 1
         aAlfa = #rem01033#28;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Opcion regimen especial fusiones, escisiones y canje valores entidades no residentes en Espa¤a : Contribuyente 2
         aAlfa = #rem01033#29;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
         || Opcion regimen especial fusiones, escisiones y canje valores entidades no residentes en Espa¤a : Numero operaciones 2
         aAlfa = #rem01033#30;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || (G-5) Integracion/Compensacion ganancias/perdidas patrim.imputables 2007 - A integrar en base imponible general - Suma ganancias
         TipoDato = "N";  Long = 11;  LongDec = 2;
         aAlfa = #rem01033#31;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Integracion/Compensacion ganancias/perdidas patrim.imputables 2007 - A integrar en base imponible general - Suma perdidas
         aAlfa = #rem01033#32;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Integracion/Compensacion ganancias/perdidas patrim.imputables 2007 - A integrar en base imponible general - Saldo neto - Diferencia positiva
         aAlfa = #rem01033#33;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";

         || Integracion/Compensacion ganancias/perdidas patrim.imputables 2007 - A integrar en base imponible general - Saldo neto - Diferencia negativa
         aAlfa = #rem01033#34;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Integracion/Compensacion ganancias/perdidas patrim.imputables 2007 - A integrar en base imponible ahorro - Suma ganancias
         aAlfa = #rem01033#35;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Integracion/Compensacion ganancias/perdidas patrim.imputables 2007 - A integrar en base imponible ahorro - Suma perdidas
         aAlfa = #rem01033#36;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Integracion/Compensacion ganancias/perdidas patrim.imputables 2007 - A integrar en base imponible ahorro - Saldo neto - Diferencia positiva
         aAlfa = #rem01033#37;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Integracion/Compensacion ganancias/perdidas patrim.imputables 2007 - A integrar en base imponible ahorro - Saldo neto - Diferencia negativa
         aAlfa = #rem01033#38;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || (H) Base imp.general y ahorro : Base Imp.General : Saldo neto positivo ganan/perd. 2007 a integrar
         aAlfa = #rem01033#39;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Base imp.general y ahorro : Base Imp.General : Saldos netos positivo ganan/perd. 2003-2006 a integrar
         aAlfa = #rem01033#40;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Base imp.general y ahorro : Base Imp.General : Saldo neto rdtos.integrar en Base Imp.general/imputaciones renta
         aAlfa = #rem01033#41;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Base imp.general y ahorro : Base Imp.General : Compensaciones : Resto saldos negativos 2003-2006 a integrar
         aAlfa = #rem01033#42;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Base imp.general y ahorro : Base Imp.General : Compensaciones : Saldo neto negativo ganancias/perdidas 2007 a integrar
         aAlfa = #rem01033#43;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Base imp.general y ahorro : Base Imp.General : Total
         aAlfa = #rem01033#44;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Base imp.general y ahorro : Base Imp.General : Saldo neto negativo gan/per 2007 : Importe pdte.compensar
         aAlfa = #rem01033#45;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Base imp.general y ahorro : Base Imp.Ahorro : Saldo neto positivo gan/per 2007
         aAlfa = #rem01033#46;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Base imp.general y ahorro : Base Imp.Ahorro : Saldos netos negativos gan/per 2003-2006
         aAlfa = #rem01033#47;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Base imp.general y ahorro : Base Imp.Ahorro : Saldo rdtos.capital mobiliario : Saldo negativo
         aAlfa = #rem01033#48;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Base imp.general y ahorro : Base Imp.Ahorro : Saldo rdtos.capital mobiliario : Saldo positivo
         aAlfa = #rem01033#49;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Base imp.general y ahorro : Base Imp.Ahorro : Base Imp.Ahorro
         aAlfa = #rem01033#50;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";
      |SINO;
         aAlfa = "0" * 175; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1; Cadena = "";
         Cadena = "0" * 169; |HAZ GrabaCad1; Cadena = "";
      |FINSI;

      Cadena = "</T10010>" + &13 + &10; |HAZ GrabaCad1;

      |SI nPag < nNumPags;
         Cadena = "<T10010>C0"; |HAZ GrabaCad1;
      |FINSI;
      Cadena = "";
   |SIGUE;

   |CIERRA #rem01033; |CIERRA #rem01032; |CIERRA #rem01031;
   |CIERRA #rem01030;
|FPRC;

|PROCESO Formateo1;
   |QBF aAlfa;
   |SI TipoDato = "F";
      aAlfa = aAlfa - "."; aAlfa = aAlfa - ".";
      |SI aAlfa = "01010000"; aAlfa = "0" * 8; |FINSI;
      |ACABA;
   |FINSI;
   |SI TipoDato = "N";
      Vacio1 = "0" * Long;
      Vacio2 = "0" * LongDec;
      aAlfa = aAlfa - "-";
      |SI FSalida ! 0;
         nNegativo = 1;
      |SINO;
         nNegativo = 0;
      |FINSI;
   |SINO;
      Vacio1 = " " * Long;
   |FINSI;

   |SI TipoDato ! "N";
      Calc1 = 100 + Long; aAlfa = (aAlfa + Vacio1) % Calc1;
   |SINO;
      |SI LongDec = 0;
         Calc1 = 0 - (100 + Long);
         aAlfa = (Vacio1 + aAlfa) % Calc1;
      |SINO;
         aAlfa = aAlfa - ".";
         |SI FSalida = 0;
            Calc1 = 0 - (100 + Long);
            aAlfa = (Vacio1 + aAlfa) % Calc1;
            aAlfa1 = "0" * LongDec;
         |SINO;
            Calc1 = (((FSalida / 100) ! 0) - 1) + 100;
            Calc2 = (((FSalida / 100) ! 0) * 100) + 99;
            aAlfa1 = aAlfa % Calc2;
            aAlfa = aAlfa % Calc1;
            Calc1 = 0 - (100 + Long);
            aAlfa = (Vacio1 + aAlfa)  % Calc1;
            Calc1 = 100 + LongDec;
            aAlfa1 = (aAlfa1 + Vacio2) % Calc1;
         |FINSI;
         aAlfa = aAlfa + aAlfa1;
      |FINSI;
      |SI nNegativo = 1;
         Calc1 = 0 - (100 + (Long + LongDec)); Calc1 = Calc1 + 1;
         aAlfa = aAlfa % Calc1;
         aAlfa = "N" + aAlfa;
      |FINSI;
   |FINSI;

   aAlfa2 = "";

   |SI TipoDato = "A"; |O TipoDato = "An";
      aLong = aAlfa % 0; nLong = aLong;
      |PARA nCont1 = 1; |SI nCont1 [ nLong; |HACIENDO nCont1 = nCont1 + 1;
         Calc1 = (nCont1 * 100) + 1; aAlfa1  = aAlfa % Calc1;
         aAlfa1 = aAlfa1 > aAlfa1;
         |SI aAlfa1 = " ";                  |VETE Sigue1; |FINSI;
         |SI aAlfa1 ] "A"; |Y aAlfa1 [ "Z"; |VETE Sigue1; |FINSI;
         |SI aAlfa1 ] "0"; |Y aAlfa1 [ "9"; |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "¥"; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "¤"; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "ç"; aAlfa1 = &199;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "Ç"; aAlfa1 = &199;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "-"; aAlfa1 = &45;    |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "'"; aAlfa1 = &49;    |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "/"; aAlfa1 = " ";    |VETE Sigue1; |FINSI;
         |SI TipoDato = "An";
            |SI aAlfa1 = "&"; aAlfa1 = &38;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = ","; aAlfa1 = &44;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = "."; aAlfa1 = &46;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = ":"; aAlfa1 = &58;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = ";"; aAlfa1 = &59;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = "_"; aAlfa1 = &95;    |VETE Sigue1; |FINSI;
         |FINSI;
         aAlfa1 = " ";
|ET Sigue1;
         aAlfa2 = aAlfa2 + aAlfa1;
      |SIGUE;
      aAlfa = aAlfa2;
   |FINSI;
   Calc1 = aAlfa;
   |SI nSwDatos = 0; |Y Calc1 ! 0; nSwDatos = 1; |FINSI;
|FPRC;

|PROCESO TipoContr1;
   |QBF aAlfa;
   |SI aAlfa = ""; aTipoContr = "0"; |ACABA; |FINSI;
   |SI aSeparada = "S";
     aTipoContr = "2";
   |SINO;
      aTipoContr = "0";
      |SI aAlfa = "TITULAR";   aTipoContr = "2"; |FINSI;
      |SI aAlfa = "CONYUGE";
         aAlfa3 = VTipo; |QBF aAlfa3;
         |SI aAlfa3 = "CONYUGE"; aTipoContr = "2"; |SINO; aTipoContr = "3"; |FINSI;
      |FINSI;
      |SI aAlfa = "COMUNES";   aTipoContr = "1"; |FINSI;
      |SI aAlfa = "CONJUNTA";  aTipoContr = "1"; |FINSI;
      |SI aAlfa = "CONJUNTAE"; aTipoContr = "1"; |FINSI;
      |SI aAlfa = "GANANCIAL"; aTipoContr = "1"; |FINSI;
      |SI aAlfa = "1 FAMILIAR";aTipoContr = "4"; |FINSI;
      |SI aAlfa = "2 FAMILIAR";aTipoContr = "5"; |FINSI;
      |SI aAlfa = "3 FAMILIAR";aTipoContr = "6"; |FINSI;
      |SI aAlfa = "4 FAMILIAR";aTipoContr = "7"; |FINSI;
      |SI aAlfa = "VARIOS";    aTipoContr = "2"; |FINSI;
   |FINSI;

|FPRC;

|PROCESO GrabaCad1;
   |SI aIP ! "";
      |XGRABA Handle, Cadena; Cadena = "";
   |SINO;
      Cadena = Handle + " " + Cadena; |FGRABA Cadena; Cadena = "";
   |FINSI;
|FPRC;

|PROCESO BuscaCasilla1;
   #rem01002#0 = VEmpresa;
   #rem01002#1 = " ";
   #rem01002#2 = VTipo;
   #rem01002#3 = Bloque;
   #rem01002#4 = Casilla;
   |LEE 010#rem01002.=;
   |SI FSalida = 0;
       Casilla = #rem01002#6;
       SwError = 0;
   |SINO;
       Casilla = 0;
       SwError = 1;
   |FINSI;
|FPRC;

|PROCESO MiraSiDatos1;
   aTipo = VTipo % 0110;
   |SI nSwDatos = 3;
      nSwDatos = 0;

      |ABRE #rem01010;
      #rem01010#0 = VEmpresa;
      #rem01010#1 = 0;
      #rem01010#2 = aTipo;
      |LEE 000#rem01010.=;
      |SI FSalida = 0;
         |SI #rem01010#3 ! 0; |O #rem01010#4  ! 0; |O #rem01010#5 ! 0;
         |O #rem01010#6  ! 0; |O #rem01010#7  ! 0; |O #rem01010#8 ! 0;
         |O #rem01010#16 ! 0; |O #rem01010#9  ! 0; |O #rem01010#24 ! 0;
         |O #rem01010#10 ! 0; |O #rem01010#11 ! 0; |O #rem01010#12 ! 0;
         |O #rem01010#13 ! 0; |O #rem01010#14 ! 0; |O #rem01010#15 ! 0;
         |O #rem01010#17 ! 0; |O #rem01010#25 ! 0; |O #rem01010#26 ! 0;
         |O #rem01010#27 ! 0; |O #rem01010#28 ! 0; |O #rem01010#23 ! 0;
            nSwDatos = 1;
         |FINSI;
      |FINSI;
      |CIERRA #rem01010;
      |SI nSwDatos = 1; |ACABA; |FINSI;

      |ABRE #rem01012;
      #rem01012#0 = VEmpresa;
      #rem01012#1 = 0;
      #rem01012#2 = aTipo;
      |LEE 000#rem01012.=;
      |SI FSalida = 0;
         |SI #rem01012#3  ! 0; |O #rem01012#19 ! 0; |O #rem01012#4  ! 0;
         |O  #rem01012#5  ! 0; |O #rem01012#6  ! 0; |O #rem01012#7  ! 0;
         |O  #rem01012#20 ! 0; |O #rem01012#9  ! 0; |O #rem01012#10 ! 0;
         |O  #rem01012#13 ! 0; |O #rem01012#15 ! 0; |O #rem01012#16 ! 0;
         |O  #rem01012#21 ! 0; |O #rem01012#22 ! 0; |O #rem01012#23 ! 0;
         |O  #rem01012#24 ! 0; |O #rem01012#8  ! 0; |O #rem01012#25 ! 0;
         |O  #rem01012#26 ! 0; |O #rem01012#27 ! 0; |O #rem01012#14 ! 0;
         |O  #rem01012#28 ! 0;
            nSwDatos = 1;
         |FINSI;
      |FINSI;
      |CIERRA #rem01012;
      |SI nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;

   |SI nSwDatos = 4;
      nSwDatos = 0; Bloque = 4;
      Casilla = "080"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = "085"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      |ABRE #rem01013;
      #rem01013#0 = VEmpresa;
      #rem01013#1 = 0;
      #rem01013#2 = aTipo; aTipo = #rem01013#2;
      #rem01013#3 = 1;
      |LEE 000#rem01013.];
      |SI FSalida = 0; |Y #rem01013#0 = VEmpresa; |Y #rem01013#2 = aTipo; |Y #rem01013#1 = 0;
         nSwDatos = 1;
      |FINSI;
      |CIERRA #rem01013;
      |SI nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;

   |SI nSwDatos = 5;
      |ABRE #rem01014;
      #rem01014#0 = VEmpresa;
      #rem01014#1 = 0;
      #rem01014#2 = aTipo; aTipo = #rem01014#2;
      #rem01014#3 = 1;
      |LEE 000#rem01014.];
      |SI FSalida = 0; |Y #rem01014#0 = VEmpresa; |Y #rem01014#2 = aTipo; |Y #rem01014#1 = 0;
         nSwDatos = 1;
      |FINSI;
      |CIERRA #rem01014;
      |SI nSwDatos = 1; |ACABA; |FINSI;

      nSwDatos = 0; Bloque = 5;
      Casilla = "140"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
   |SI nSwDatos = 6;
      |ABRE #rem01019;
      #rem01019#0 = VEmpresa;
      #rem01019#1 = 0;
      #rem01019#2 = aTipo; aTipo = #rem01019#2;
      #rem01019#3 = 1;
      |LEE 000#rem01019.];
      |SI FSalida = 0; |Y #rem01019#0 = VEmpresa; |Y #rem01019#2 = aTipo; |Y #rem01019#1 = 0;
         nSwDatos = 1;
      |FINSI;
      |CIERRA #rem01019;
      |SI nSwDatos = 1; |ACABA; |FINSI;

      nSwDatos = 0; Bloque = 6;
      Casilla = "170"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
   |SI nSwDatos = 7;
      |ABRE #rem01021;
      #rem01021#0 = VEmpresa;
      #rem01021#1 = 0;
      #rem01021#2 = aTipo; aTipo = #rem01022#2;
      #rem01021#3 = 1;
      |LEE 000#rem01021.];
      |SI FSalida = 0; |Y #rem01021#0 = VEmpresa; |Y #rem01021#2 = aTipo; |Y #rem01021#1 = 0;
         nSwDatos = 1;
      |FINSI;
      |CIERRA #rem01021
      |SI nSwDatos = 1; |ACABA; |FINSI;

      nSwDatos = 0; Bloque = 7;
      Casilla = "195"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
   |SI nSwDatos = 8;
      nSwDatos = 0;
      |ABRE #rem01026;
      #rem01026#0 = VEmpresa;
      #rem01026#1 = 0;
      #rem01026#2 = aTipo;
      |LEE 000#rem01026.=;
      |SI FSalida = 0;
         |SI #rem01026#13 ! 0; |O #rem01026#22 ! 0; |O #rem01026#14 ! 0;
          |O #rem01026#15 ! 0; |O #rem01026#16 ! 0; |O #rem01026#17 ! 0;
          |O #rem01026#18 ! 0; |O #rem01026#19 ! 0; |O #rem01026#20 ! 0;
          |O #rem01026#3  ! 0; |O #rem01026#4  ! 0; |O #rem01026#6  ! 0;
          |O #rem01026#7  ! 0; |O #rem01026#8  ! 0; |O #rem01026#9  ! 0;
          |O #rem01026#10 ! 0; |O #rem01026#11 ! 0;
            nSwDatos = 1;
         |FINSI;
      |FINSI;
      |CIERRA #rem01026;
      |SI nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
   |SI nSwDatos = 9;
      nSwDatos = 0;
      |ABRE #rem01027;
      #rem01027#0 = VEmpresa;
      #rem01027#1 = 0;
      #rem01027#2 = aTipo; aTipo = #rem01027#2;
      #rem01027#3 = 1;
      |LEE 000#rem01027.];
      |SI FSalida = 0; |Y #rem01027#0 = VEmpresa; |Y #rem01027#2 = aTipo; |Y #rem01027#1 = 0;
         nSwDatos = 1;
      |FINSI;
      |CIERRA #rem01027
      |SI nSwDatos = 1; |ACABA; |FINSI;

      |ABRE #rem01039;
      #rem01039#0 = VEmpresa;
      #rem01039#1 = 0;
      #rem01039#2 = aTipo; aTipo = #rem01039#2;
      #rem01039#3 = 1;
      |LEE 000#rem01039.];
      |SI FSalida = 0; |Y #rem01039#0 = VEmpresa; |Y #rem01039#2 = aTipo; |Y #rem01039#1 = 0;
         nSwDatos = 1;
      |FINSI;
      |CIERRA #rem01039;
      |SI nSwDatos = 1; |ACABA; |FINSI;

      |ABRE #rem01031;
      #rem01031#0 = VEmpresa;
      #rem01031#1 = 0;
      #rem01031#2 = aTipo; aTipo = #rem01031#2;
      #rem01031#3 = 1;
      |LEE 000#rem01031.];
      |SI FSalida = 0; |Y #rem01031#0 = VEmpresa; |Y #rem01031#2 = aTipo; |Y #rem01031#1 = 0;
         nSwDatos = 1;
      |FINSI;
      |CIERRA #rem01031;
      |SI nSwDatos = 1; |ACABA; |FINSI;

      nSwDatos = 0;
      |ABRE #rem01033;
      #rem01033#0 = VEmpresa;
      #rem01033#1 = 0;
      #rem01033#2 = aTipo;
      |LEE 000#rem01033.=;
      |SI FSalida = 0;
         |SI #rem01033#3  ! 0; |O #rem01033#4  ! 0; |O #rem01033#5  ! 0;
          |O #rem01033#6  ! 0; |O #rem01033#7  ! 0; |O #rem01033#8  ! 0;
          |O #rem01033#9  ! 0; |O #rem01033#10 ! 0; |O #rem01033#11 ! 0;
          |O #rem01033#12 ! 0; |O #rem01033#13 ! 0; |O #rem01033#14 ! 0;
          |O #rem01033#15 ! 0; |O #rem01033#16 ! 0; |O #rem01033#17 ! 0;
          |O #rem01033#18 ! 0;
            nSwDatos = 1;
         |FINSI;
      |FINSI;
      |CIERRA #rem01033;
      |SI nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;

   |SI nSwDatos = 10;
      nSwDatos = 0;

      |ABRE #rem01030;
      #rem01030#0 = VEmpresa;
      #rem01030#1 = 0;
      #rem01030#2 = aTipo; aTipo = #rem01030#2;
      #rem01030#3 = 1;
      |LEE 000#rem01030.];
      |SI FSalida = 0; |Y #rem01030#0 = VEmpresa; |Y #rem01030#2 = aTipo; |Y #rem01030#1 = 0;
         nSwDatos = 1;
      |FINSI;
      |CIERRA #rem01030;

      |ABRE #rem01032;
      #rem01032#0 = VEmpresa;
      #rem01032#1 = 0;
      #rem01032#2 = aTipo; aTipo = #rem01032#2;
      #rem01032#3 = 1;
      |LEE 000#rem01032.];
      |SI FSalida = 0; |Y #rem01032#0 = VEmpresa; |Y #rem01032#2 = aTipo; |Y #rem01032#1 = 0;
         nSwDatos = 1;
      |FINSI;
      |CIERRA #rem01032;

      |ABRE #rem01033;
      #rem01033#0 = VEmpresa;
      #rem01033#1 = 0;
      #rem01033#2 = aTipo;
      |LEE 000#rem01033.=;
      |SI FSalida = 0;
         |SI #rem01033#22 ! 0; |O #rem01033#23 ! 0; |O #rem01033#24 ! 0;
          |O #rem01033#25 ! 0; |O #rem01033#26 ! 0; |O #rem01033#27 ! 0;
          |O #rem01033#28 ! 0; |O #rem01033#29 ! 0; |O #rem01033#30 ! 0;
          |O #rem01033#31 ! 0; |O #rem01033#32 ! 0; |O #rem01033#33 ! 0;
          |O #rem01033#34 ! 0; |O #rem01033#35 ! 0; |O #rem01033#36 ! 0;
          |O #rem01033#37 ! 0; |O #rem01033#38 ! 0; |O #rem01033#39 ! 0;
          |O #rem01033#40 ! 0; |O #rem01033#41 ! 0; |O #rem01033#42 ! 0;
          |O #rem01033#43 ! 0; |O #rem01033#44 ! 0; |O #rem01033#45 ! 0;
          |O #rem01033#46 ! 0; |O #rem01033#47 ! 0; |O #rem01033#48 ! 0;
          |O #rem01033#49 ! 0; |O #rem01033#50 ! 0;
            nSwDatos = 1;
         |FINSI;
      |FINSI;
      |CIERRA #rem01033;
      |SI nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
|FPRC;

|PROCESO Epigrafe;
   |QBF aAlfa;
   |SI aAlfa = "9999"; aAlfa = ""; |FINSI;
   aLong = aAlfa % 0; nLong = aLong;

   |SI nLong = 4;
      aAlfa = (aAlfa % 0103) + "." + (aAlfa % 0401);
   |FINSI;
|FPRC;
