|FICHEROS;
     ver00001 #100;
     rem02000 #0;
     rem01000 #1;
     rem01002 #3;
     rem01034 #534;
     rem01042 #542;
     rem00007 #7;
     rem00008 #8;
     rem00045 #45;
     retabla1 #401;
|FIN;

|VARIABLES;
     &enError = 0;

      nSwHay  = 0;
      aAlfa   = "";
|FIN;

|| ************************************************************************
|| PROCESOS DE CAMBIO DE VERSION
|| ************************************************************************

|PROCESO MiraPatrones;
     nSwHay = 0;

     |ABRE #0;
     |LEE 040#0p;
     |SI FSalida ! 0;  |O #0#4 ] 700;
         |CIERRA #0;  |DELINDEX #0;
         nSwHay = 1;
     |FINSI;
     |CIERRA #0;

     |ABRE #1;
     #1#0 = 22;
     #1#1 = "114";
     |LEE 040#1=;
     |SI FSalida = 0;
         |CIERRA #1;
         |DELINDEX #1;
         nSwHay = 1;
     |SINO;
         |CIERRA #1;
     |FINSI;

     |ABRE #8;
     #8#0 = 1;
     #8#1 = 421;
     |LEE 040#8=;
     |SI FSalida ! 0;
         |ABRE #7;  |CIERRA #7;  |DELINDEX #7;
         |CIERRA #8;
         |DELINDEX #8;
         nSwHay = 1;
     |SINO;
         |CIERRA #8;
     |FINSI;

     |ABRE #401;
     |LEE 000#401p;
     |SI FSalida ! 0;  |DDEFECTO #401;  |FINSI;
     |CIERRA #401;

     |SI #401#70 ! 22000;  |Y nSwHay = 0;
         |MENAV "0000 Ha cambiado el fichero patron retabla1 (LIMITES E IMPORTES), por favor instalelo.";
         |SUB_EJECUTA_NP "rez00001";
     |FINSI;

     |SI nSwHay = 1;
         |MENAV "0000 Han cambiado ficheros patrones, por favor instalelos.";
         |SUB_EJECUTA_NP "rez00001";
     |FINSI;

     |ABRE #0;
     |LEE 040#0p;
     |SI FSalida ! 0;  |O #0#4 ] 700;
         enError = 1;
         |CIERRA #0;
         |ACABA;
     |FINSI;
     |CIERRA #0;

     |ABRE #1;
     #1#0 = 22;
     #1#1 = "114";
     |LEE 040#1=;
     |SI FSalida = 0;
         enError = 1;
         |CIERRA #1;
         |ACABA;
     |FINSI;
     |CIERRA #1;

     |ABRE #8;
     #8#0 = 1;
     #8#1 = 421;
     |LEE 040#8=;
     |SI FSalida ! 0;
         enError = 1;
         |CIERRA #8;
         |ACABA;
     |FINSI;
     |CIERRA #8;

     |ABRE #401;
     |LEE 000#401p;
     |SI FSalida ! 0;  |DDEFECTO #401;  |FINSI;
     |CIERRA #401;

     |SI #401#70 ! 22000;
         enError = 1;
     |FINSI;
|FPRC;

|PROCESO rem00045;
     #0#7 = #45#11;
     #0#8 = #45#13;
     |LEE 040#0=;
     |SI FSalida = 0;
         #45#11 = #0#0;
         #45#12 = #0#2;
         #45#13 = #0#1;
         #45#14 = #0#3;
         #45#15 = #0#4;
         |GRABA 020#45a;
     |SINO;
         |BORRA 020#45a;
     |FINSI;
     |LIBERA #45;
|FPRC;

|DEFBUCLE rem00045;
     #45#1;
     ;
     00001, 00;
     99999, 99;
     be;
     NULL, rem00045;
|FIN;

|PROCESO CambioDeducciones;
     |ABRE #45;
     |LEE 040#45p;
     |SI FSalida = 0;
         |SI #45#15 ] 700;
             |ABRE #0;
             |SELECT #3#0;
             |BUCLE rem00045;
             |CIERRA #0;
         |FINSI;
     |FINSI;
     |CIERRA #45;
|FPRC;

|PROGRAMA;
     |ABRE #100;
     |LEE 101#100p;
     |SI FSalida ! 0;
         |DELINDEX #534;
         |ABRE #534;  |CIERRA #534;  |DELINDEX #534;

         |DELINDEX #542;
         |ABRE #542;  |CIERRA #542;  |DELINDEX #542;

         |MENAV "0000 Han cambiado ficheros patrones, por favor instalelos.";
         |SUB_EJECUTA_NP "rez00001";

         |DDEFECTO #100;
         |GRABA 020#100n;
         |LIBERA #100;
     |FINSI;
     |CIERRA #100;

     |MENSA "0000Comprobando configuracion patrones.";
     enError = 0;
     |HAZ MiraPatrones;
     |SI enError = 1;  |ACABA;  |FINSI;

     |MENSA "0000Comprobando configuracion deducciones.";
     |HAZ CambioDeducciones;

     |BLIN 5;
|FPRO;
