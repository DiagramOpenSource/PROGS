|FICHEROS;
      rew99999 #999;

     &refere1@ #1001;
     &refere2@ #1002;
     &referr3@ #1003;

      datfic0@ #0;
      datfic1@ #1;
      datfic2@ #2;
      datfic3@ #3;
      datfic4@ #4;

      retabla1 #401;
|FIN;

|VARIABLES;
      aDef             = "";
      aAlfa            = "";
      aFichero         = "";
      aTCalc           = "";
      aTipo            = "";
      aRenta           = "";

      nCoefi           = 0;
      nSwFich          = 0;
      nLinea           = 0;
      nCampo           = 0;
      nCampo1          = 0;
      nCampo2          = 0;
      nValor           = 0;
      nPasada          = 0;
      nTCalc           = 0;
      nCanti           = 0;
      nAporta          = 0;
      nAportaT         = 0;
      nAportaC         = 0;
      nAportaT1        = 0;
      nAportaT2        = 0;
      nAportaC1        = 0;
      nAportaC2        = 0;
      nResta           = 0;
      nResto           = 0;
      nRestoT          = 0;
      nRestoC          = 0;
      nSuma            = 0;
      nPdte            = 0;

     &enEmpresa        = 0;
     &enComplementaria = 0;
     &eaPathDef        = "";
     &eaContri         = "";
     &enMinusvalia     = 0;
     &eaMinuAyuda      = "";
     &enBloque         = 0;
     &eaCasilla        = "";
     &enImporte        = 0;
     &enSwAcum         = 0;
     &enNomeDat        = 0;
     &enNomeAgr        = 0;
     &eaMuerto         = "";
     &efFechaMuerto    = @;
     &enCalcuMuerto    = 0;
     &eaPrograma       = "";
     &enLinea          = 0;
     &eaObserva        = "";
|FIN;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
||                        PUNTO G1_1
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO LiquidaG1_1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 101#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         #1#0 = #1001#0;
         #1#1 = #1001#1;
         #1#2 = #1001#2;
         |GRABA 020#1b;
     |FINSI;

     #1#3   = (N\ #1#3   + (#0#11 % nCoefi));
     #1#4   = (N\ #1#4   + (#0#12 % nCoefi));
     #1#5   = (N\ #1#5   + (#0#13 % nCoefi));
     #1#6   = (N\ #1#6   + (#0#14 % nCoefi));
     #1#7   = (N\ #1#7   + (#0#15 % nCoefi));
     #1#112 = (N\ #1#112 + (#0#17 % nCoefi));

     |GRABA 020#1a;
     |LIBERA #1;

     enBloque  = 13;
     enSwAcum  = 0;
     eaCasilla = "300";  enImporte = #1#3;    |HAZ GrabaLineal;
     eaCasilla = "301";  enImporte = #1#4;    |HAZ GrabaLineal;
     eaCasilla = "302";  enImporte = #1#5;    |HAZ GrabaLineal;
     eaCasilla = "303";  enImporte = #1#6;    |HAZ GrabaLineal;
     eaCasilla = "304";  enImporte = #1#7;    |HAZ GrabaLineal;
     eaCasilla = "305";  enImporte = #1#112;  |HAZ GrabaLineal;

     enBloque  = 38;
     enSwAcum  = 1;
     eaCasilla = "749";  enImporte = (#0#16 % nCoefi) + (#0#13 % nCoefi);   |HAZ GrabaLineal;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
||                        PUNTO G1_2
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO LiquidaG1_2;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 101#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         #1#0 = #1001#0;
         #1#1 = #1001#1;
         #1#2 = #1001#2;
         |GRABA 020#1b;
     |FINSI;

     #1#8  = (N\ #1#8  + (#0#11 % nCoefi));
     #1#9  = (N\ #1#9  + (#0#12 % nCoefi));
     #1#10 = (N\ #1#10 + (#0#13 % nCoefi));
     #1#11 = (N\ #1#11 + (#0#14 % nCoefi));

     |GRABA 020#1a;
     |LIBERA #1;

     enSwAcum  = 1;
     enBloque  = 38;
     eaCasilla = "749";
     enImporte = #0#23 % nCoefi;
     |HAZ GrabaLineal;

     enBloque  = 14;
     enSwAcum  = 0;
     eaCasilla = "310";  enImporte = #1#8;   |HAZ GrabaLineal;
     eaCasilla = "311";  enImporte = #1#9;   |HAZ GrabaLineal;
     eaCasilla = "312";  enImporte = #1#10;  |HAZ GrabaLineal;
     eaCasilla = "313";  enImporte = #1#11;  |HAZ GrabaLineal;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
||                        PUNTO G2_1
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO LiquidaG2_1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     #1#3 = 99;
     |LEE 040#1];
     |SI FSalida = 0;
         |LEE 040#1a;
     |SINO;
         |LEE 040#1u;
     |FINSI;

     |SI FSalida = 0; |Y #1#0 = #1001#0; |Y #1#1 = #1001#1; |Y #1#2 = #1001#2;
         nLinea = #1#3 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #1;
     #1#0  = #1001#0;
     #1#1  = #1001#1;
     #1#2  = #1001#2;
     #1#3  = nLinea;
     #1#4  = #0#11;
     #1#5  = eaContri;
     |SI #1#2 = "CONJUNTA  ";
         #1#5 = #0#2;
         |SI #1#5 = "VARIOS    ";  #1#5 = "COMUNES";  |FINSI;
         |SI #1#5 = "GANANCIAL ";  #1#5 = "COMUNES";  |FINSI;
     |FINSI;

     #1#6  = (N\ #0#12 % nCoefi);
     #1#7  = (N\ #0#13 % nCoefi);
     #1#8  = (N\ #0#19 % nCoefi);

     |GRABA 020#1n;
     |LIBERA #1;

     #2#0 = #1001#0;
     #2#1 = #1001#1;
     #2#2 = #1001#2;
     |LEE 101#2=;
     |SI FSalida ! 0;
         |DDEFECTO #2;
         #2#0 = #1001#0;
         #2#1 = #1001#1;
         #2#2 = #1001#2;
         |GRABA 020#2b;
     |FINSI;

     #2#12 = (N\ #2#12 + (#0#12 % nCoefi));
     #2#13 = (N\ #2#13 + (#0#13 % nCoefi));

     |GRABA 020#2a;
     |LIBERA #2;

     enSwAcum  = 0;
     enBloque  = 15;
     eaCasilla = "329";  enImporte = #2#12;  |HAZ GrabaLineal;
     eaCasilla = "330";  enImporte = #2#13;  |HAZ GrabaLineal;

     enSwAcum  = 1;
     enBloque  = 38;
     eaCasilla = "749";
     enImporte = #0#19 % nCoefi;
     |HAZ GrabaLineal;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
||                        PUNTO G2_2
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO LiquidaG2_2;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     #1#3 = 99;
     |LEE 040#1];
     |SI FSalida = 0;
         |LEE 040#1a;
     |SINO;
         |LEE 040#1u;
     |FINSI;

     |SI FSalida = 0; |Y #1#0 = #1001#0; |Y #1#1 = #1001#1; |Y #1#2 = #1001#2;
         nLinea = #1#3 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #1;
     #1#0  = #1001#0;
     #1#1  = #1001#1;
     #1#2  = #1001#2;
     #1#3  = nLinea;
     #1#4  = #0#13;
     #1#5  = eaContri;
     |SI #1#2 = "CONJUNTA  ";
         #1#5 = #0#2;
         |SI #1#5 = "VARIOS    ";  #1#5 = "COMUNES";  |FINSI;
         |SI #1#5 = "GANANCIAL ";  #1#5 = "COMUNES";  |FINSI;
     |FINSI;

     #1#6  = (N\ #0#14 % nCoefi);
     #1#7  = (N\ #0#15 % nCoefi);
     #1#8  = (N\ #0#16 % nCoefi);
     #1#9  = (N\ #0#17 % nCoefi);
     #1#10 = (N\ #0#18 % nCoefi);
     #1#11 = (N\ #0#19 % nCoefi);

     |GRABA 020#1n;
     |LIBERA #1;

     #2#0 = #1001#0;
     #2#1 = #1001#1;
     #2#2 = #1001#2;
     |LEE 101#2=;
     |SI FSalida ! 0;
         |DDEFECTO #2;
         #2#0 = #1001#0;
         #2#1 = #1001#1;
         #2#2 = #1001#2;
         |GRABA 020#2b;
     |FINSI;

     #2#14 = (N\ #2#14 + (#0#17 % nCoefi));
     #2#15 = (N\ #2#15 + (#0#19 % nCoefi));

     |GRABA 020#2a;
     |LIBERA #2;

     enSwAcum  = 0;
     enBloque  = 16;
     eaCasilla = "349";  enImporte = #2#14;  |HAZ GrabaLineal;
     eaCasilla = "350";  enImporte = #2#15;  |HAZ GrabaLineal;

     enSwAcum  = 1;
     enBloque  = 38;
     eaCasilla = "749";
     enImporte = #0#23 % nCoefi;
     |HAZ GrabaLineal;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
||                        PUNTO G2_3
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO LiquidaG2_3;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     #1#3 = 99;
     |LEE 040#1];
     |SI FSalida = 0;
         |LEE 040#1a;
     |SINO;
         |LEE 040#1u;
     |FINSI;

     |SI FSalida = 0; |Y #1#0 = #1001#0; |Y #1#1 = #1001#1; |Y #1#2 = #1001#2;
         nLinea = #1#3 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #1;
     #1#0  = #1001#0;
     #1#1  = #1001#1;
     #1#2  = #1001#2;
     #1#3  = nLinea;
     #1#4  = #0#11;
     #1#5  = eaContri;
     |SI #1#2 = "CONJUNTA  ";
         #1#5 = #0#2;
         |SI #1#5 = "VARIOS    ";  #1#5 = "COMUNES";  |FINSI;
         |SI #1#5 = "GANANCIAL ";  #1#5 = "COMUNES";  |FINSI;
     |FINSI;

     |SI #0#12 = "1";  #1#6 = "6";  |FINSI;
     |SI #0#12 = "2";  #1#6 = "7";  |FINSI;
     |SI #0#12 = "3";  #1#6 = "1";  |FINSI;
     |SI #0#12 = "4";  #1#6 = "2";  |FINSI;
     |SI #0#12 = "5";  #1#6 = "3";  |FINSI;
     |SI #0#12 = "6";  #1#6 = "4";  |FINSI;
     |SI #0#12 = "7";  #1#6 = "5";  |FINSI;

     #1#7  = #0#14;
     #1#8  = #0#15;
     #1#9  = (N\ #0#16 % nCoefi);
     #1#10 = (N\ #0#21 % nCoefi);
     #1#11 = (N\ #0#22 % nCoefi);
     #1#12 = (N\ #0#23 % nCoefi);
     #1#13 = (N\ #0#24 % nCoefi);
     #1#14 = (N\ #0#25);
     #1#15 = (N\ #0#26 % nCoefi);
     #1#16 = (N\ #0#27 % nCoefi);
     #1#17 = (N\ #0#28 % nCoefi);
     #1#18 = (N\ #0#29 % nCoefi);
     #1#19 = (N\ #0#30 % nCoefi);
     #1#20 = (N\ #0#31 % nCoefi);
     #1#22 = (N\ #0#33 % nCoefi);
     #1#23 = (N\ #0#36);
     #1#24 = #0#37;
     #1#26 = (N\ #0#39 % nCoefi);
     #1#27 = (N\ #0#40 % nCoefi);

     |GRABA 020#1n;
     |LIBERA #1;

     #2#0 = #1001#0;
     #2#1 = #1001#1;
     #2#2 = #1001#2;
     |LEE 101#2=;
     |SI FSalida ! 0;
         |DDEFECTO #2;
         #2#0 = #1001#0;
         #2#1 = #1001#1;
         #2#2 = #1001#2;
         |GRABA 020#2b;
     |FINSI;

     #2#16 = (N\ #2#16 + #1#12);
     #2#17 = (N\ #2#17 + #1#18);
     #2#18 = (N\ #2#18 + #1#22);

     |GRABA 020#2a;
     |LIBERA #2;

     enSwAcum  = 0;
     enBloque  = 17;
     eaCasilla = "383";  enImporte = #2#16;  |HAZ GrabaLineal;
     eaCasilla = "384";  enImporte = #2#17;  |HAZ GrabaLineal;
     eaCasilla = "385";  enImporte = #2#18;  |HAZ GrabaLineal;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
||                        PUNTO G2_4
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO LiquidaG2_4;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     #1#3 = 99;
     |LEE 040#1];
     |SI FSalida = 0;
         |LEE 040#1a;
     |SINO;
         |LEE 040#1u;
     |FINSI;

     |SI FSalida = 0; |Y #1#0 = #1001#0; |Y #1#1 = #1001#1; |Y #1#2 = #1001#2;
         nLinea = #1#3 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #1;
     #1#0  = #1001#0;
     #1#1  = #1001#1;
     #1#2  = #1001#2;
     #1#3  = nLinea;
     #1#4  = eaContri;
     |SI #1#2 = "CONJUNTA  ";
         #1#4 = #0#2;
         |SI #1#4 = "VARIOS    ";  #1#4 = "COMUNES";  |FINSI;
         |SI #1#4 = "GANANCIAL ";  #1#4 = "COMUNES";  |FINSI;
     |FINSI;

     |SI #0#11 = "G";
         #1#5  = (N\ #0#12 % nCoefi);
         #1#6  = (N\ #0#13 % nCoefi);
     |SINO;
         #1#7  = (N\ #0#12 % nCoefi);
         #1#8  = (N\ #0#13 % nCoefi);
     |FINSI;

     |GRABA 020#1n;
     |LIBERA #1;

     #2#0 = #1001#0;
     #2#1 = #1001#1;
     #2#2 = #1001#2;
     |LEE 101#2=;
     |SI FSalida ! 0;
         |DDEFECTO #2;
         #2#0 = #1001#0;
         #2#1 = #1001#1;
         #2#2 = #1001#2;
         |GRABA 020#2b;
     |FINSI;

     #2#19 = (N\ #2#19 + #1#6);
     #2#20 = (N\ #2#20 + #1#8);

     |GRABA 020#2a;
     |LIBERA #2;

     enSwAcum  = 0;
     enBloque  = 18;
     eaCasilla = "395";  enImporte = #2#19;  |HAZ GrabaLineal;
     eaCasilla = "405";  enImporte = #2#20;  |HAZ GrabaLineal;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
||                        PUNTO G2_5
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO LiquidaG2_5;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     #1#3 = 99;
     |LEE 040#1];
     |SI FSalida = 0;
         |LEE 040#1a;
     |SINO;
         |LEE 040#1u;
     |FINSI;

     |SI FSalida = 0; |Y #1#0 = #1001#0; |Y #1#1 = #1001#1; |Y #1#2 = #1001#2;
         nLinea = #1#3 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #1;
     #1#0  = #1001#0;
     #1#1  = #1001#1;
     #1#2  = #1001#2;
     #1#3  = nLinea;
     #1#4  = eaContri;
     |SI #1#2 = "CONJUNTA  ";
         #1#4 = #0#2;
         |SI #1#4 = "VARIOS    ";  #1#4 = "COMUNES";  |FINSI;
         |SI #1#4 = "GANANCIAL ";  #1#4 = "COMUNES";  |FINSI;
     |FINSI;

     #1#5  = (N\ #0#11 % nCoefi);
     #1#6  = (N\ #0#12 % nCoefi);
     #1#7  = #0#13;

     |GRABA 020#1n;
     |LIBERA #1;

     #2#0 = #1001#0;
     #2#1 = #1001#1;
     #2#2 = #1001#2;
     |LEE 101#2=;
     |SI FSalida ! 0;
         |DDEFECTO #2;
         #2#0 = #1001#0;
         #2#1 = #1001#1;
         #2#2 = #1001#2;
         |GRABA 020#2b;
     |FINSI;

     #2#21 = (N\ #2#21 + #1#6);

     |GRABA 020#2a;
     |LIBERA #2;

     enSwAcum  = 0;
     enBloque  = 19;
     eaCasilla = "415";  enImporte = #2#21;  |HAZ GrabaLineal;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
||                        PUNTO G4
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO LiquidaG4;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 101#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         #1#0 = #1001#0;
         #1#1 = #1001#1;
         #1#2 = #1001#2;
         |GRABA 020#1b;
     |FINSI;

     |SI #1#27 = "          ";
         #1#27 = eaContri;
         |SI #1#2 = "CONJUNTA  ";
             #1#27 = #0#2;
         |SINO;
             #1#27 = "TITULAR";
         |FINSI;
         #1#28 = #0#5;
     |SINO;
         |SI #1#29 = "          ";
             #1#29 = eaContri;
             |SI #1#2 = "CONJUNTA  ";
                 #1#29 = #0#2;
             |SINO;
                 #1#29 = "TITULAR";
             |FINSI;
             #1#30 = #0#5;
         |FINSI;
     |FINSI;

     |GRABA 020#1a;
     |LIBERA #1;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
||                        PUNTO I2
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO LiquidaI2;
     |SI #0#23 ! "N";  |ACABA;  |FINSI;

     |SI #0#14 = 0;  |Y #0#15 = 0;  |Y #0#16 = 0;  |Y #0#27 = 0;
         |ACABA;
     |FINSI;

     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |SI #0#2 = "TITULAR   ";
         nLinea = 1;
     |SINO;
         nLinea = 2;
     |FINSI;

     |DDEFECTO #1;
     #1#0  = #1001#0;
     #1#1  = #1001#1;
     #1#2  = #1001#2;
     #1#3  = nLinea;
     |LEE 101#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         #1#0  = #1001#0;
         #1#1  = #1001#1;
         #1#2  = #1001#2;
         #1#3  = nLinea;
         |GRABA 020#1b;
     |FINSI;

     #1#4  = eaContri;
     |SI #1#2 = "CONJUNTA  ";
         #1#4 = #0#2;
         |SI #1#4 = "VARIOS    ";  #1#4 = "COMUNES";  |FINSI;
         |SI #1#4 = "GANANCIAL ";  #1#4 = "COMUNES";  |FINSI;
     |FINSI;

     |SI #1#4 = "1 FAMILIAR";  #1#4 = "TITULAR";  |FINSI;
     |SI #1#4 = "2 FAMILIAR";  #1#4 = "TITULAR";  |FINSI;
     |SI #1#4 = "3 FAMILIAR";  #1#4 = "TITULAR";  |FINSI;
     |SI #1#4 = "4 FAMILIAR";  #1#4 = "TITULAR";  |FINSI;

     #2#0 = #1001#0;
     #2#1 = #1001#1;
     #2#2 = #1001#2;
     |LEE 101#2=;
     |SI FSalida ! 0;
         |DDEFECTO #2;
         #2#0 = #1001#0;
         #2#1 = #1001#1;
         #2#2 = #1001#2;
         |GRABA 020#2n;
     |FINSI;

     #1#10 = (N\ #1#10 + (#0#14 % nCoefi));
     #1#11 = (N\ #1#11 + (#0#27 % nCoefi));
     #1#5  = (N\ #1#10 + #1#11);
     #1#6  = (N\ #1#6  + ((#0#15 % nCoefi) + (#0#16 % nCoefi)));
     #1#7  = (N\ #1#5  + #1#6);

     |SI nPasada = 0;
         aTipo   = #0#24;
         nCanti  = #0#25;
         nPasada = 1;
     |FINSI;

     #1#8  = aTipo;
     #1#9  = nCanti;

     |GRABA 020#1a;
     |LIBERA #1;
     |LIBERA #2;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
||                        PUNTO I3
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO LiquidaI3;
     |SI #0#23 ! "N";  |ACABA;  |FINSI;

     |SI #0#18 = 0;  |Y #0#19 = 0;  |Y #0#20 = 0;  |Y #0#26 = 0;
         |ACABA;
     |FINSI;

     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |SI #0#2 = "TITULAR   ";
         nLinea = 1;
     |SINO;
         nLinea = 2;
     |FINSI;

     |DDEFECTO #1;
     #1#0  = #1001#0;
     #1#1  = #1001#1;
     #1#2  = #1001#2;
     #1#3  = nLinea;
     |LEE 101#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         #1#0  = #1001#0;
         #1#1  = #1001#1;
         #1#2  = #1001#2;
         #1#3  = nLinea;
         |GRABA 020#1b;
     |FINSI;

     #1#4  = eaContri;
     |SI #1#2 = "CONJUNTA  ";
         #1#4 = #0#2;
         |SI #1#4 = "VARIOS    ";  #1#4 = "COMUNES";  |FINSI;
         |SI #1#4 = "GANANCIAL ";  #1#4 = "COMUNES";  |FINSI;
     |FINSI;

     |SI #1#4 = "1 FAMILIAR";  #1#4 = "TITULAR";  |FINSI;
     |SI #1#4 = "2 FAMILIAR";  #1#4 = "TITULAR";  |FINSI;
     |SI #1#4 = "3 FAMILIAR";  #1#4 = "TITULAR";  |FINSI;
     |SI #1#4 = "4 FAMILIAR";  #1#4 = "TITULAR";  |FINSI;

     #2#0 = #1001#0;
     #2#1 = #1001#1;
     #2#2 = #1001#2;
     |LEE 101#2=;
     |SI FSalida ! 0;
         |DDEFECTO #2;
         #2#0 = #1001#0;
         #2#1 = #1001#1;
         #2#2 = #1001#2;
         |GRABA 020#2n;
     |FINSI;

     #1#5  = #0#17;
     #1#6  = (N\ #1#6  + (#0#26 % nCoefi));

     #1#9  = (N\ #1#9  + ((#0#18 % nCoefi) + (#0#19 % nCoefi)));
     #1#7  = (N\ #1#7  + ((#0#18 % nCoefi) + (#0#19 % nCoefi)));
     |SI #1#7 > #401#25;  #1#7  = #401#25;  |FINSI;

     #1#10 = (N\ #1#10 + (#0#20 % nCoefi));
     #1#8  = (N\ #1#8  + (#0#20 % nCoefi));
     |SI #1#8 > #401#26;  #1#8  = #401#26;  |FINSI;

     |GRABA 020#1a;
     |LIBERA #1;
     |LIBERA #2;
|FPRC;

|PROCESO rem01045C4;
     #2#0 = #1#0;
     #2#1 = #1#1;
     #2#2 = #1#2;
     |LEE 101#2=;
     |SI FSalida ! 0;
         |DDEFECTO #2;
         #2#0 = #1#0;
         #2#1 = #1#1;
         #2#2 = #1#2;
         |GRABA 020#2b;
     |FINSI;

     #2#56  = (N\ #2#56  + #1#6);
     #2#57  = (N\ #2#57  + #1#7);
     #2#58  = (N\ #2#58  + #1#8);

     nSuma = #2#56 + #2#57;
     |SI nSuma ] #401#25;  #2#57 = #401#25;  #2#56 = 0;  |FINSI;
     |SI #2#58 ] 10000;    #2#58 = 10000;    #2#56 = 0;  |FINSI;

     #2#56  = (N\ #2#56 + #2#57 + #2#58);

     |GRABA 020#2a;
     |LIBERA #2;

     #1001#0   = #1#0;
     #1001#1   = #1#1;
     #1001#2   = #1#2;

     enBloque  = 27;
     enSwAcum  = 0;
     eaCasilla = "530";  enImporte = #2#56;   |HAZ GrabaLineal;
|FPRC;

|DEFBUCLE rem01045C4;
     #1#1004;
     ;
     #1001#0, #1001#1, "          ", 001;
     #1001#0, #1001#1, "zzzzzzzzzz", 999;
     ;
     NULL, rem01045C4;
|FIN;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
||                        PUNTO I4
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO LiquidaI4;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     #1#3 = 99;
     |LEE 040#1];
     |SI FSalida = 0;
         |LEE 040#1a;
     |SINO;
         |LEE 040#1u;
     |FINSI;

     |SI FSalida = 0; |Y #1#0 = #1001#0; |Y #1#1 = #1001#1; |Y #1#2 = #1001#2;
         nLinea = #1#3 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #1;
     #1#0  = #1001#0;
     #1#1  = #1001#1;
     #1#2  = #1001#2;
     #1#3  = nLinea;
     |LEE 101#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         #1#0  = #1001#0;
         #1#1  = #1001#1;
         #1#2  = #1001#2;
         #1#3  = nLinea;
         |GRABA 020#1b;
     |FINSI;

     #1#4  = eaContri;
     |SI #1#2 = "CONJUNTA  ";
         #1#4 = #0#2;
         |SI #1#4 = "VARIOS    ";  #1#4 = "COMUNES";  |FINSI;
         |SI #1#4 = "GANANCIAL ";  #1#4 = "COMUNES";  |FINSI;
     |FINSI;

     |SI #1#4 = "1 FAMILIAR";  #1#4 = "TITULAR";  |FINSI;
     |SI #1#4 = "2 FAMILIAR";  #1#4 = "TITULAR";  |FINSI;
     |SI #1#4 = "3 FAMILIAR";  #1#4 = "TITULAR";  |FINSI;
     |SI #1#4 = "4 FAMILIAR";  #1#4 = "TITULAR";  |FINSI;

     #1#5 = #0#11;
     #1#6 = (N\ #1#6 + (#0#12 % nCoefi));
     #1#7 = (N\ #1#7 + (#0#13 % nCoefi));

     |GRABA 020#1a;
     |LIBERA #1;
|FPRC;

|PROCESO rem01035C4;
     #2#0 = #1#0;
     #2#1 = #1#1;
     #2#2 = #1#2;
     |LEE 101#2=;
     |SI FSalida ! 0;
         |DDEFECTO #2;
         #2#0 = #1#0;
         #2#1 = #1#1;
         #2#2 = #1#2;
         |GRABA 020#2b;
     |FINSI;

     nValor = #1#6 + #1#7;
     nResto = 0;
     |SI nValor > 10000;
         nValor = 10000;
         nResta = 10000 - #1#7;
         |SI nResta < 0;  nResta = 0;  |FINSI;

         nResto = #1#6 - nResta;
     |FINSI;

     #2#59 = (N\ #2#59 + nValor);

     |SI #1#3 = 1;
         #2#60 = (N\ #2#60 + nResto);
     |SINO;
         #2#61 = (N\ #2#61 + nResto);
     |FINSI;

     |GRABA 020#2a;
     |LIBERA #2;

     #1001#0   = #1#0;
     #1001#1   = #1#1;
     #1001#2   = #1#2;

     enBloque  = 28;
     enSwAcum  = 0;
     eaCasilla = "560";  enImporte = #2#59;   |HAZ GrabaLineal;
|FPRC;

|DEFBUCLE rem01035C4;
     #1#1004;
     ;
     #1001#0, #1001#1, "          ", 001;
     #1001#0, #1001#1, "zzzzzzzzzz", 999;
     ;
     NULL, rem01035C4;
|FIN;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
||                        PUNTO I5
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO LiquidaI5;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |SI #0#2 = "TITULAR   ";
         nLinea = 1;
     |SINO;
         nLinea = 2;
     |FINSI;

     |DDEFECTO #1;
     #1#0  = #1001#0;
     #1#1  = #1001#1;
     #1#2  = #1001#2;
     #1#3  = nLinea;
     |LEE 101#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         #1#0  = #1001#0;
         #1#1  = #1001#1;
         #1#2  = #1001#2;
         #1#3  = nLinea;
         |GRABA 020#1b;
     |FINSI;

     #1#4  = eaContri;
     |SI #1#2 = "CONJUNTA  ";
         #1#4 = #0#2;
         |SI #1#4 = "VARIOS    ";  #1#4 = "COMUNES";  |FINSI;
         |SI #1#4 = "GANANCIAL ";  #1#4 = "COMUNES";  |FINSI;
     |FINSI;

     |SI #1#4 = "1 FAMILIAR";  #1#4 = "TITULAR";  |FINSI;
     |SI #1#4 = "2 FAMILIAR";  #1#4 = "TITULAR";  |FINSI;
     |SI #1#4 = "3 FAMILIAR";  #1#4 = "TITULAR";  |FINSI;
     |SI #1#4 = "4 FAMILIAR";  #1#4 = "TITULAR";  |FINSI;

     #2#0 = #1001#0;
     #2#1 = #1001#1;
     #2#2 = #1001#2;
     |LEE 101#2=;
     |SI FSalida ! 0;
         |DDEFECTO #2;
         #2#0 = #1001#0;
         #2#1 = #1001#1;
         #2#2 = #1001#2;
         |GRABA 020#2b;
     |FINSI;

     |SI #0#14 = "N";
         #1#5 = #0#12;
         #1#6 = (N\ #1#6 + (#0#13 % nCoefi));
         |GRABA 020#1a;

         #2#62 = (N\ #2#62 + (#0#13 % nCoefi));
         |GRABA 020#2a;

         enBloque  = 29;
         enSwAcum  = 0;
         eaCasilla = "585";  enImporte = #2#62;   |HAZ GrabaLineal;
     |SINO;
         enSwAcum  = 1;
         enBloque  = 34;
         eaCasilla = "688";  enImporte = #0#13 % nCoefi;   |HAZ GrabaLineal;
         eaCasilla = "682";  enImporte = #0#15 % nCoefi;   |HAZ GrabaLineal;
     |FINSI;
     |LIBERA #1;
     |LIBERA #2;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
||                        PUNTO I6
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO LiquidaI6;
     |SI #0#23 ! "S";  |ACABA;  |FINSI;

     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |SI #0#2 = "TITULAR   ";
         nLinea = 1;
     |SINO;
         nLinea = 2;
     |FINSI;

     |DDEFECTO #1;
     #1#0  = #1001#0;
     #1#1  = #1001#1;
     #1#2  = #1001#2;
     #1#3  = nLinea;
     |LEE 101#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         #1#0  = #1001#0;
         #1#1  = #1001#1;
         #1#2  = #1001#2;
         #1#3  = nLinea;
         |GRABA 020#1b;
     |FINSI;

     #1#4  = eaContri;
     |SI #1#2 = "CONJUNTA  ";
         #1#4 = #0#2;
         |SI #1#4 = "VARIOS    ";  #1#4 = "COMUNES";  |FINSI;
         |SI #1#4 = "GANANCIAL ";  #1#4 = "COMUNES";  |FINSI;
     |FINSI;

     |SI #1#4 = "1 FAMILIAR";  #1#4 = "TITULAR";  |FINSI;
     |SI #1#4 = "2 FAMILIAR";  #1#4 = "TITULAR";  |FINSI;
     |SI #1#4 = "3 FAMILIAR";  #1#4 = "TITULAR";  |FINSI;
     |SI #1#4 = "4 FAMILIAR";  #1#4 = "TITULAR";  |FINSI;

     #2#0 = #1001#0;
     #2#1 = #1001#1;
     #2#2 = #1001#2;
     |LEE 101#2=;
     |SI FSalida ! 0;
         |DDEFECTO #2;
         #2#0 = #1001#0;
         #2#1 = #1001#1;
         #2#2 = #1001#2;
         |GRABA 020#2n;
     |FINSI;

     #1#5 = (N\ #1#5 + ((#0#14 % nCoefi)));
     #1#6 = (N\ #1#6 + ((#0#15 % nCoefi) + (#0#16 % nCoefi)));

     |GRABA 020#1a;
     |LIBERA #1;
     |LIBERA #2;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
||                   PROCESOS DE SELECCION
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO Liquida4;
     |HAZ CreaLiquida;               || En el rezcalut

     |SI nSwFich = 1;  |HAZ LiquidaG1_1;      |FINSI;
     |SI nSwFich = 2;  |HAZ LiquidaG1_2;      |FINSI;
     |SI nSwFich = 3;  |HAZ LiquidaG2_1;      |FINSI;
     |SI nSwFich = 4;  |HAZ LiquidaG2_2;      |FINSI;
     |SI nSwFich = 5;  |HAZ LiquidaG2_3;      |FINSI;
     |SI nSwFich = 6;  |HAZ LiquidaG2_4;      |FINSI;
     |SI nSwFich = 7;  |HAZ LiquidaG2_5;      |FINSI;
     |SI nSwFich = 8;  |HAZ LiquidaG4;        |FINSI;
     |SI nSwFich = 9;  |HAZ LiquidaI2;        |FINSI;
     |SI nSwFich = 10; |HAZ LiquidaI3;        |FINSI;
     |SI nSwFich = 11; |HAZ LiquidaI4;        |FINSI;
     |SI nSwFich = 12; |HAZ LiquidaI5;        |FINSI;
     |SI nSwFich = 13; |HAZ LiquidaI6;        |FINSI;
|FPRC;

|PROCESO Seleccion4;
     |SI #0#2 = "GANANCIAL ";                || Si es Ganancial
         nCoefi = 50;  eaContri = "TITULAR   ";   |HAZ Liquida4;
         nCoefi = 50;  eaContri = "CONYUGE   ";   |HAZ Liquida4;
         nCoefi = 100; eaContri = "CONJUNTA  ";   |HAZ Liquida4;

         |SI eaMuerto ! "";
             nCoefi = 50;  eaContri = "CONJUNTAE ";   |HAZ Liquida4;
         |FINSI;

         |ACABA;
     |FINSI;

     |SI #0#2 ! "VARIOS    ";                || SI es TITULAR O CONYUGE;
         nCoefi = 100;  eaContri = #0#2;          |HAZ Liquida4;
         nCoefi = 100;  eaContri = "CONJUNTA  ";  |HAZ Liquida4;

         |SI eaMuerto = "T";  |Y #0#2 ! "TITULAR   ";
             nCoefi = 100;  eaContri = "CONJUNTAE ";   |HAZ Liquida4;
         |FINSI;

         |SI eaMuerto = "C";  |Y #0#2 ! "CONYUGE   ";
             nCoefi = 100;  eaContri = "CONJUNTAE ";   |HAZ Liquida4;
         |FINSI;
         |ACABA;
     |FINSI;
                                             || SI es Varios

     |SI #0#5  ! 0; nCoefi = #0#5;   eaContri = "TITULAR   ";  |HAZ Liquida4;  |FINSI;
     |SI #0#6  ! 0; nCoefi = #0#6;   eaContri = "CONYUGE   ";  |HAZ Liquida4;  |FINSI;
     |SI #0#7  ! 0; nCoefi = #0#7;   eaContri = "1 FAMILIAR";  |HAZ Liquida4;  |FINSI;
     |SI #0#8  ! 0; nCoefi = #0#8;   eaContri = "2 FAMILIAR";  |HAZ Liquida4;  |FINSI;
     |SI #0#9  ! 0; nCoefi = #0#9;   eaContri = "3 FAMILIAR";  |HAZ Liquida4;  |FINSI;
     |SI #0#10 ! 0; nCoefi = #0#10;  eaContri = "4 FAMILIAR";  |HAZ Liquida4;  |FINSI;

     nCoefi  = #0#5 + #0#6 + #0#7 + #0#8 + #0#9 + #0#10;
     eaContri = "CONJUNTA  "; |HAZ Liquida4;

     |SI eaMuerto = "T";
         nCoefi  = #0#6 + #0#7 + #0#8 + #0#9 + #0#10;
         eaContri = "CONJUNTAE "; |HAZ Liquida4;
     |FINSI;

     |SI eaMuerto = "C";
         nCoefi  = #0#5 + #0#7 + #0#8 + #0#9 + #0#10;
         eaContri = "CONJUNTAE "; |HAZ Liquida4;
     |FINSI;
|FPRC;

|PROCESO PuntoG1_1;
     nSwFich = 1;
     aDef    = eaPathDef + "rem00037.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1033"#;  |FINSI;

     |ABRE #0;
     |ABRE #1;
     |DDEFECTO #0;
     #0#0 = enEmpresa;
     #0#1 = 1;
     |LEE 040#0];
     |PARA; |SI FSalida = 0;  |Y #0#0 = enEmpresa;  |HACIENDO;
            |SI #0#3 = "R";   |HAZ Seleccion4;  |FINSI;
            |SI #0#3 = "X";
                eaPrograma = "rem00037";
                enLinea    = #0#1;
                eaObserva  = "(G1) PREMIOS";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#0s;
     |SIGUE;
     |CIERRA #0;
     |CIERRA #1;

     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO PuntoG1_2;
     nSwFich = 2;
     aDef    = eaPathDef + "rem00030.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1033"#;  |FINSI;

     |ABRE #0;
     |ABRE #1;
     |DDEFECTO #0;
     #0#0 = enEmpresa;
     #0#1 = 1;
     |LEE 040#0];
     |PARA; |SI FSalida = 0;  |Y #0#0 = enEmpresa;  |HACIENDO;
            |SI #0#3 = "R";   |HAZ Seleccion4;  |FINSI;
            |SI #0#3 = "X";
                eaPrograma = "rem00030";
                enLinea    = #0#1;
                eaObserva  = "(G1) OTRAS GANANCIAS";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#0s;
     |SIGUE;
     |CIERRA #0;
     |CIERRA #1;

     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO PuntoG2_1;
     nSwFich = 3;
     aDef    = eaPathDef + "rem00036.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01027.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1027"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1033"#;  |FINSI;

     |ABRE #0;
     |ABRE #1;
     |ABRE #2;
     |DDEFECTO #0;
     #0#0 = enEmpresa;
     #0#1 = 1;
     |LEE 040#0];
     |PARA; |SI FSalida = 0;  |Y #0#0 = enEmpresa;  |HACIENDO;
            |SI #0#3 = "R";   |HAZ Seleccion4;  |FINSI;
            |SI #0#3 = "X";
                eaPrograma = "rem00036";
                enLinea    = #0#1;
                eaObserva  = "(G2) INSTITUCIONES DE INVERSION COLECTIVA";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#0s;
     |SIGUE;
     |CIERRA #0;
     |CIERRA #1;
     |CIERRA #2;

     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO PuntoG2_2;
     nSwFich = 4;
     aDef    = eaPathDef + "rem00059.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01039.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1039"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1033"#;  |FINSI;

     |ABRE #0;
     |ABRE #1;
     |ABRE #2;
     |DDEFECTO #0;
     #0#0 = enEmpresa;
     #0#1 = 1;
     |LEE 040#0];
     |PARA; |SI FSalida = 0;  |Y #0#0 = enEmpresa;  |HACIENDO;
            |SI #0#3 = "R";   |HAZ Seleccion4;  |FINSI;
            |SI #0#3 = "X";
                eaPrograma = "rem00059";
                enLinea    = #0#1;
                eaObserva  = "(G2) ACCIONES ADMITIDAS EN MERCADOS OFICIALES";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#0s;
     |SIGUE;
     |CIERRA #0;
     |CIERRA #1;
     |CIERRA #2;

     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO PuntoG2_3;
     nSwFich = 5;
     aDef    = eaPathDef + "rem00041.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01031.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1031"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1033"#;  |FINSI;

     |ABRE #0;
     |ABRE #1;
     |ABRE #2;
     |DDEFECTO #0;
     #0#0 = enEmpresa;
     #0#1 = 1;
     |LEE 040#0];
     |PARA; |SI FSalida = 0;  |Y #0#0 = enEmpresa;  |HACIENDO;
            |SI #0#3 = "R";   |HAZ Seleccion4;  |FINSI;
            |SI #0#3 = "X";
                eaPrograma = "rem00041";
                enLinea    = #0#1;
                eaObserva  = "(G2) GANANCIAS Y PERDIDAS PRODUCIDAS EN EL 2010.";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#0s;
     |SIGUE;
     |CIERRA #0;
     |CIERRA #1;
     |CIERRA #2;

     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO PuntoG2_4;
     nSwFich = 6;
     aDef    = eaPathDef + "rem00042.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01032.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1032"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1033"#;  |FINSI;

     |ABRE #0;
     |ABRE #1;
     |ABRE #2;
     |DDEFECTO #0;
     #0#0 = enEmpresa;
     #0#1 = 1;
     |LEE 040#0];
     |PARA; |SI FSalida = 0;  |Y #0#0 = enEmpresa;  |HACIENDO;
            |SI #0#3 = "R";   |HAZ Seleccion4;  |FINSI;
            |SI #0#3 = "X";
                eaPrograma = "rem00042";
                enLinea    = #0#1;
                eaObserva  = "(G2) GANANCIAS Y PERDIDAS A쩙S ANTER. COBROS 2010";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#0s;
     |SIGUE;
     |CIERRA #0;
     |CIERRA #1;
     |CIERRA #2;

     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO PuntoG2_5;
     nSwFich = 7;
     aDef    = eaPathDef + "rem00040.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01030.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1030"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1033"#;  |FINSI;

     |ABRE #0;
     |ABRE #1;
     |ABRE #2;
     |DDEFECTO #0;
     #0#0 = enEmpresa;
     #0#1 = 1;
     |LEE 040#0];
     |PARA; |SI FSalida = 0;  |Y #0#0 = enEmpresa;  |HACIENDO;
            |SI #0#3 = "R";   |HAZ Seleccion4;  |FINSI;
            |SI #0#3 = "X";
                eaPrograma = "rem00040";
                enLinea    = #0#1;
                eaObserva  = "(G3) GANANCIAS Y PERDIDAS DIFER.POR REINVERSION";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#0s;
     |SIGUE;
     |CIERRA #0;
     |CIERRA #1;
     |CIERRA #2;

     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO PuntoG4;
     nSwFich = 8;
     aDef    = eaPathDef + "rem00057.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1033"#;  |FINSI;

     |ABRE #0;
     |ABRE #1;
     |DDEFECTO #0;
     #0#0 = enEmpresa;
     #0#1 = 1;
     |LEE 040#0];
     |PARA; |SI FSalida = 0;  |Y #0#0 = enEmpresa;  |HACIENDO;
            |SI #0#3 = "R";   |HAZ Seleccion4;  |FINSI;
            |SI #0#3 = "X";
                eaPrograma = "rem00057";
                enLinea    = #0#1;
                eaObserva  = "(G4) ENTIDADES NO RESIDENTES EN ESPA쩇";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#0s;
     |SIGUE;
     |CIERRA #0;
     |CIERRA #1;

     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO CalculaG;
     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1033"#;  |FINSI;

     aDef    = eaPathDef + "rem01012.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1012"#;  |FINSI;

     aDef    = eaPathDef + "rem01026.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1026"#;  |FINSI;

     |ABRE #0;
     |ABRE #1;
     |ABRE #2;

     |DDEFECTO #0;
     #0#0 = enEmpresa;
     #0#1 = enComplementaria;
     #0#2 = "          ";
     |LEE 101#0];
     |PARA; |SI FSalida = 0;  |Y #0#0 = enEmpresa;  |Y #0#1 = enComplementaria;  |HACIENDO;
            #1#0 = #0#0;
            #1#1 = #0#1;
            #1#2 = #0#2;
            |LEE 040#1=;
            |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;

            #2#0 = #0#0;
            #2#1 = #0#1;
            #2#2 = #0#2;
            |LEE 040#2=;
            |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

            #0#31  = (N\ #2#16 + #0#3 + #0#7  + #0#8  + #0#9  + #0#10 + #0#21);
            #0#32  = (N\ #2#17 + #0#11);
            nResta = #0#31 - #0#32;
            #0#33  = nResta;
            #0#34  = 0;
            |SI nResta < 0;
                #0#34 = -nResta;
                #0#33 = 0;
            |FINSI;

            #0#35  = (N\ #2#18 + #0#12 + #0#14 + #0#17 + #0#18 + #0#19);
            #0#36  = (N\ #2#19 + #0#13 + #0#15 + #0#16 + #0#20);
            nResta = #0#35 - #0#36;
            #0#37  = nResta;
            #0#38  = 0;
            |SI nResta < 0;
                #0#38 = -nResta;
                #0#37 = 0;
            |FINSI;

            |GRABA 020#0a;
            |LIBERA #0;

            #1001#0   = #0#0;
            #1001#1   = #0#1;
            #1001#2   = #0#2;

            enSwAcum   = 0;
            enBloque   = 21;
            eaCasilla  = "440";   enImporte  = #0#31;  |HAZ GrabaLineal;
            eaCasilla  = "441";   enImporte  = #0#32;  |HAZ GrabaLineal;
            eaCasilla  = "450";   enImporte  = #0#33;  |HAZ GrabaLineal;
            eaCasilla  = "442";   enImporte  = #0#34;  |HAZ GrabaLineal;

            enSwAcum   = 0;
            enBloque   = 22;
            eaCasilla  = "443";   enImporte  = #0#35;  |HAZ GrabaLineal;
            eaCasilla  = "444";   enImporte  = #0#36;  |HAZ GrabaLineal;
            eaCasilla  = "457";   enImporte  = #0#37;  |HAZ GrabaLineal;
            eaCasilla  = "445";   enImporte  = #0#38;  |HAZ GrabaLineal;

            |LEE 101#0s;
     |SIGUE;
     |LIBERA #0;
     |CIERRA #0;
     |CIERRA #1;

     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO PuntoI2;
     nSwFich = 9;
     aDef    = eaPathDef + "rem00053.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01037.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1037"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1033"#;  |FINSI;

     nPasada = 0;
     aTipo   = "";
     nCanti  = 0;
     |ABRE #0;
     |ABRE #1;
     |ABRE #2;
     |DDEFECTO #0;
     #0#0 = enEmpresa;
     #0#1 = 1;
     |LEE 040#0];
     |PARA; |SI FSalida = 0;  |Y #0#0 = enEmpresa;  |HACIENDO;
            |SI #0#3 = "R";   |HAZ Seleccion4;  |FINSI;
            |SI #0#3 = "X";
                eaPrograma = "rem00053";
                enLinea    = #0#1;
                eaObserva  = "(I) PLANES DE PENSIONES Y MUTUALIDADES";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#0s;
     |SIGUE;
     |CIERRA #0;
     |CIERRA #1;
     |CIERRA #2;


     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO PuntoI3;
     nSwFich = 10;
     aDef    = eaPathDef + "rem00053.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01045.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1045"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1033"#;  |FINSI;

     nPasada = 0;
     aTipo   = "";
     nCanti  = 0;
     |ABRE #0;
     |ABRE #1;
     |ABRE #2;
     |DDEFECTO #0;
     #0#0 = enEmpresa;
     #0#1 = 1;
     |LEE 040#0];
     |PARA; |SI FSalida = 0;  |Y #0#0 = enEmpresa;  |HACIENDO;
            |SI #0#3 = "R";   |HAZ Seleccion4;  |FINSI;
            |SI #0#3 = "X";
                eaPrograma = "rem00053";
                enLinea    = #0#1;
                eaObserva  = "(I) PLANES DE PENSIONES Y MUTUALIDADES";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#0s;
     |SIGUE;
     |CIERRA #0;
     |CIERRA #1;
     |CIERRA #2;

     |BUCLE rem01045C4;

     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO PuntoI4;
     nSwFich = 11;
     aDef    = eaPathDef + "rem00061.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01035.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1035"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1033"#;  |FINSI;

     |ABRE #0;
     |ABRE #1;
     |ABRE #2;
     |DDEFECTO #0;
     #0#0 = enEmpresa;
     #0#1 = 1;
     |LEE 040#0];
     |PARA; |SI FSalida = 0;  |Y #0#0 = enEmpresa;  |HACIENDO;
            |SI #0#3 = "R";   |HAZ Seleccion4;  |FINSI;
            |SI #0#3 = "X";
                eaPrograma = "rem00061";
                enLinea    = #0#1;
                eaObserva  = "(I) APORTACIONES A LOS PATRIMONIOS PROTEGIDOS";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#0s;
     |SIGUE;

     |BUCLE rem01035C4;

     |CIERRA #0;
     |CIERRA #1;
     |CIERRA #2;

     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO PuntoI5;
     nSwFich = 12;
     aDef    = eaPathDef + "rem00054.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01046.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1046"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1033"#;  |FINSI;

     |ABRE #0;
     |ABRE #1;
     |ABRE #2;
     |DDEFECTO #0;
     #0#0 = enEmpresa;
     #0#1 = 1;
     |LEE 040#0];
     |PARA; |SI FSalida = 0;  |Y #0#0 = enEmpresa;  |HACIENDO;
            |SI #0#3 = "R";   |HAZ Seleccion4;  |FINSI;
            |SI #0#3 = "X";
                eaPrograma = "rem00054";
                enLinea    = #0#1;
                eaObserva  = "(I) PENSIONES COMPENSATORIAS Y ANUALIDADES ALIMENTOS";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#0s;
     |SIGUE;
     |CIERRA #0;
     |CIERRA #1;
     |CIERRA #2;

     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO PuntoI6;
     nSwFich = 13;
     aDef    = eaPathDef + "rem00053.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01047.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1047"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1033"#;  |FINSI;

     nPasada = 0;
     aTipo   = "";
     nCanti  = 0;
     |ABRE #0;
     |ABRE #1;
     |ABRE #2;
     |DDEFECTO #0;
     #0#0 = enEmpresa;
     #0#1 = 1;
     |LEE 040#0];
     |PARA; |SI FSalida = 0;  |Y #0#0 = enEmpresa;  |HACIENDO;
            |SI #0#3 = "R";   |HAZ Seleccion4;  |FINSI;
            |SI #0#3 = "X";
                eaPrograma = "rem00053";
                enLinea    = #0#1;
                eaObserva  = "(I) PLANES DE PENSIONES Y MUTUALIDADES";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#0s;
     |SIGUE;
     |CIERRA #0;
     |CIERRA #1;
     |CIERRA #2;

     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO Bloque4;
     nAportaT1    = 0;
     nAportaT2    = 0;
     nAportaC1    = 0;
     nAportaC2    = 0;

     |HAZ PuntoG1_1;
     |HAZ PuntoG1_2;
     |HAZ PuntoG2_1;
     |HAZ PuntoG2_2;
     |HAZ PuntoG2_3;
     |HAZ PuntoG2_4;
     |HAZ PuntoG2_5;
     |HAZ PuntoG4;
     |HAZ CalculaG;

     |HAZ PuntoI2;
     |HAZ PuntoI3;
     |HAZ PuntoI4;
     |HAZ PuntoI5;
     |HAZ PuntoI6;
|FPRC;
