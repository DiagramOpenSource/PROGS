|FICHEROS;
     rem01014;
     rem00905;
     rew00711;
|FIN;

|VARIABLES;
      nCampo           = 0;
      nRango           = 0;
      nNumCampos       = 0;
      nGrid1011        = 0;
      nGrid711         = 0;
      nCmp             = 0;

      aAlfa            = "";
      aQueQuiero       = "";
      aNumCampos       = "";
      aEsc1            = "";
      aEsc2            = "";
      aRetu            = "";
      aTecla           = "";
      aNome            = "";

     &enEmpresa        = 0;
     &enComplementaria = 0;
     &eaContri         = "";
     &eaAlfa           = "";
     &eaImporte        = "";
|FIN;

|PROCESO Baja711;
     #rew00711#0 = #rem01014#3;
     #rew00711#1 = 0;
|FPRC;

|PROCESO Alta711;
     #rew00711#0 = #rem01014#3;
     #rew00711#1 = 999;
|FPRC;


|PROCESO Evento1011;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#rem01014.=;

         #rew00711#0 = #rem01014#3;
         #rew00711#1 = 0;
         |LEE 000#rew00711.];

         |REFRESCACONTROL nGrid711;
     |FINSI;
|FPRC;

|PROCESO Baja1011;
     #rem01014#0 = enEmpresa;
     #rem01014#1 = enComplementaria;
     #rem01014#2 = eaContri;
     #rem01014#3 = 1;
|FPRC;

|PROCESO Alta1011;
     #rem01014#0 = enEmpresa;
     #rem01014#1 = enComplementaria;
     #rem01014#2 = eaContri;
     #rem01014#3 = 999;
|FPRC;

|PROGRAMA;
     aQueQuiero  = "|NC";
     aNumCampos  = #rem01014#aQueQuiero#;
     nNumCampos  = aNumCampos;
     nNumCampos  = nNumCampos - 1;
     nRango      = 4 + 8 + 16 + 32 + 128;

     |ABRET #rem01014;

     |LINEAL_SIMPLE #1#rew00711, nRango, 1402, 3498, Baja711, Alta711, NULL;
     nGrid711 = FSalida;

     |LINEAL_SIMPLE #1#rem01014, nRango, 0602, 1298, Baja1011, Alta1011, Evento1011;
     nGrid1011 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::{{001}}Salir," + nGrid1011;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;
          |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |CIERRAT #rem01014;
|FPRO;

|PROCESO rem00905;
     |DDEFECTO #rew00711;

     #rew00711#0 = #rem01014#3;
     #rew00711#1 = #rem00905#0;
     #rew00711#2 = #rem00905#1;
     #rew00711#3 = #rem00905#2;

     |SI #rem00905#2 ! "    ";
         nCmp = nCmp + 1;

         eaAlfa = #rem01014#nCmp#;
         |SI #rem01014#nCmp# = 0;
             eaAlfa = "";
         |SINO;
             eaImporte = #rem01014#nCmp#;
             |HAZ SeparaImporte;
             eaAlfa = eaImporte;
         |FINSI;

         #rew00711#4 = eaAlfa;
     |FINSI;

     #rew00711#5 = #rem00905#6;
     |GRABA 020#rew00711.n;
     |LIBERA #rew00711;
|FPRC;

|DEFBUCLE rem00905;
     #rem00905#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, rem00905;
|FIN;

|PROCESO rem01014;
     nCmp = 9;
     |BUCLE rem00905;
|FPRC;

|DEFBUCLE rem01014;
     #rem01014#1;
     ;
     enEmpresa, enComplementaria,  eaContri, 001;
     enEmpresa, enComplementaria,  eaContri, 999;
     ;
     NULL, rem01014;
|FIN;

|PROCESO T80;  |TIPO 80;
     aNome = "rew00714" + Usuario;
     |NOME_DAT #rew00711#aNome#;

     |ABRE #rew00711;  |CIERRA #rew00711;  |DELINDEX #rew00711;

     |ABRET #rew00711;

     |BUCLE rem01014;

     FSalida = 3699;
|FPRC;

|PROCESO T90;  |TIPO 90;
     |CIERRAT #rew00711;
     |DELINDEX #rew00711;
|FPRC;
