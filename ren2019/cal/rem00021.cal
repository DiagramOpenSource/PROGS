|FICHEROS;
     reparame;
     rem00021;
     rem00015;
     rem00041;
     rem00100;
     rem00102;

     rew00621;
     rew00601;
     rew00602;
     rew00603;

     rew00003;
     rew00005;

     rew99999;

     rem00021@;

     :/basica/def/agicen17;
     :/basica/def/agicen18;
|FIN;

|VARIABLES;
     aAlfa         = "";
     aAlfa1        = "";
     aAlfa2        = "";
     aAlfa3        = "";
     aLong         = "";
     aQueQuiero    = "";
     aNumCampos    = "";
     aNumPanta     = "";
     aPathRenta    = "";
     aDef          = "";
     aDescri       = "";
     aTit          = "";

     aEsc1         = "";
     aEsc2         = "";
     aRetu         = "";
     aTecla        = "";
     aID           = "";

     nVentana603    = -1;
     nCampo         = 0;
     nRango         = 0;
     nGrid          = -1;
     nBotonAlta     = 0;
     nBotonModi     = 0;
     nBotonBaja     = 0;
     nBotonCntr     = 0;
     nBotonRdto     = 0;
     nBotonInve     = 0;
     nBotonVent     = 0;
     nBotonAlqu     = 0;
     nBotonMej      = 0;
     nBotonCopi     = 0;
     nBotonCalc1    = 0;
     nBotonCalc2    = 0;
     nBotonCalc3    = 0;
     nBotonCalc602_1= 0;
     nBotonCalc603_1= 0;
     nBotonCalc603_2= 0;
     nBotonCalc603_3= 0;
     nBotonCalc603_4= 0;
     nBotonCalc603_5= 0;
     nBotonCalc603_6= 0;
     nBotonCalc603_7= 0;
     nBotonCalc603_8= 0;
     nPanta         = 0;
     nPanta602      = 0;
     nPanta603      = 0;
     nID            = 0;
     nFecha         = 0;
     nEntrar        = 0;
     nOk            = 0;
     nRng           = 0;
     nCon           = 0;

     nDiasHT        = 0;
     nDiasHC        = 0;
     nDiasH1        = 0;
     nDiasH2        = 0;
     nDiasH3        = 0;
     nDiasH4        = 0;
     nPorce        = 0;
     nError        = 0;
     nTotal        = 0;
     nMejoras      = 0;
     nEdad         = 0;
     nAnyos        = 0;
     nLineaViv     = 0;
     nHabitual     = 0;
     nValor2       = 0;
     nNume         = 0;
     nAct117       = 0;
     nLin117       = 0;
     nSuma         = 0;
     nDiasHab      = 0;
     nDiasAlq      = 0;
     nDiasUso      = 0;
     nLong         = 0;
     nCaracter     = 0;
     nPosi         = 0;
     nNumPanta     = 0;
     nModo         = 0;
     nEntrada      = 0;
     nPtas         = 0;
     nRetencion    = 0;
     nValor        = 0;
     nValor1       = 0;
     nValorPat     = 0;
     nDias         = 0;
     nAnyoVenta    = 0;
     nAnyoCompra   = 0;
     nDiferencia   = 0;
     nCoefi        = 0;
     nLinea        = 0;
     nContenido    = 0;
     nAnyo         = 0;
     nSwHay        = 0;
     nCampo1       = 0;
     nCampo2       = 0;
     nCampo3       = 0;
     nCampo4       = 0;
     nCampo5       = 0;
     nFallecido    = 0;
     nCanti1       = 0;
     nCanti2       = 0;
     nCanti3       = 0;
     nCanti4       = 0;
     nDia1         = 0;
     nDia2         = 0;
     nCoef         = 0;
     nCampo21      = 0;
     nCampo22      = 0;
     nCampo23      = 0;
     nCampo51      = 0;
     nCampo52      = 0;
     nCampo25      = 0;
     nCampo26      = 0;
     nCampo27      = 0;
     nCampo29      = 0;
     nCampo44      = 0;
     nCampo45      = 0;
     nCoefMej      = 0;
     nCoefImp      = 0;

     nTodosDias    = 0;
     nParciDias    = 0;

     fFechaDT9     = @;
     fFechaTop     = @;

     fFechaAdq     = @;
     fFechaTra     = @;
     fFecha        = @;
     fFecha1       = @;
     fFecha2       = @;

 {10}aPopup        = "";

     &enEmpresa    = 0;
     &enModo       = 0;
     &enModoReg    = 0;
     &eaDeclarante = "";
     &enComunes    = 0;
     &enChequeo    = 0;
     &enMinusvalia = 0;
     &eaMinuAyuda  = "";
     &eaFallece    = "";
     &eaSwVarios   = "";
     &eaVarDni     = "";
     &enCalcCif    = 0;
     &enSwLiquida  = 0;
     &enSwRetorno  = 0;
     &eaPrograma   = "";
     &eaPunto      = "";

     &eaLetra      = "";
     &eaDeDonde    = "";
     &eaLinDonde   = "";
     &eaAnyoUsu    = "";
     &eaPatr06     = "";
     &eaPatr07     = "";
     &eaPatr08     = "";
     &eaPatr09     = "";
     &eaPatr10     = "";
     &eaPatr11     = "";
     &eaPatr12     = "";
     &eaPatr13     = "";
     &eaPatr14     = "";
     &eaPatr15     = "";
     &eaPatr16     = "";
     &eaPatr17     = "";
     &eaPatr18     = "";
     &eaPatr19     = "";
     &eaPatr20     = "";
     &eaPatr21     = "";
     &eaPatr22     = "";
     &eaPatr23     = "";
     &eaPatr25     = "";

     &eaExtr       = "";
     &enSwPresenta = 0
     &eaAzul       = "";
     &eaVerde      = "";
     &eaRojo       = "";
     &eaRosa       = "";
     &enBtnSalir   = 0;
     &enImporte    = 0;
     &enTotalDias  = 0;
     &enTotalDias1 = 0;
     &enTotalDias2 = 0;
     &enQuita      = 0;
     &enPanta601   = -1;
     &enVtna621    = -1;
     &enNumCampos  = 0;
|FIN;

|| ---- PROCESOS GRABACIONES EXTERIORES

|PROCESO BuscaEdad;
     |SELECT #2#rew99999;
     #rew99999#1 = aTit;
     |LEE 000#rew99999.=;
     |SI FSalida ! 0;  |DDEFECTO #rew99999;  |FINSI;

     nAnyos = (#rew00621#68 - #rew99999#12) / 365;
     |SI nAnyos ] 65;
         nOk = 1;
     |FINSI;
|FPRC;

|PROCESO MensaMayor65;
     nOk = 0;

     |SI #rew00621#30 = 0;
         |ACABA;
     |FINSI;

     |SI #rew00621#2 = "GANANCIAL ";
         aTit = "TITULAR";  |HAZ BuscaEdad;
         |SI nOk = 0;
             aTit = "CONYUGE";  |HAZ BuscaEdad;
         |FINSI;

         |ACABA;
     |FINSI;

     |SI #rew00621#2 = "VARIOS    ";
         |SI #rew00621#5 ! 0;
             aTit = "TITULAR";  |HAZ BuscaEdad;
         |FINSI;

         |SI nOk = 1;  |ACABA;  |FINSI;

         |SI #rew00621#6 ! 0;
             aTit = "CONYUGE";  |HAZ BuscaEdad;
         |FINSI;

         |SI nOk = 1;  |ACABA;  |FINSI;

         |SI #rew00621#7 ! 0;
             aTit = "1 FAMILIAR";  |HAZ BuscaEdad;
         |FINSI;

         |SI nOk = 1;  |ACABA;  |FINSI;

         |SI #rew00621#8 ! 0;
             aTit = "2 FAMILIAR";  |HAZ BuscaEdad;
         |FINSI;

         |SI nOk = 1;  |ACABA;  |FINSI;

         |SI #rew00621#9 ! 0;
             aTit = "3 FAMILIAR";  |HAZ BuscaEdad;
         |FINSI;

         |SI nOk = 1;  |ACABA;  |FINSI;

         |SI #rew00621#10 ! 0;
             aTit = "4 FAMILIAR";  |HAZ BuscaEdad;
         |FINSI;

         |ACABA;
     |FINSI;

     aTit = #rew00621#2;  |HAZ BuscaEdad;
|FPRC;

|PROCESO Total41;
     #rem00041#31 = #rem00021#144;

     |SI #rem00041#20 < "15.05.2012";  |O #rem00041#20 ] "01.01.2013";
         #rem00041#31 = "N";
     |FINSI;

     |SI #rem00041#16 = "6";  |O #rem00041#16 = "7";
         #rem00041#26 = 0;
         #rem00041#36 = 0;
         #rem00041#37 = 0;
         #rem00041#38 = 0;
         #rem00041#39 = 0;
         #rem00041#40 = 0;
     |SINO;
         #rem00041#41 = 0;
         #rem00041#42 = 0;
         #rem00041#43 = 0;
         #rem00041#44 = 0;
     |FINSI;

     #rem00041#24 = #rem00041#22 + #rem00041#23;

     nValor = #rem00041#21 - #rem00041#27;
     |SI nValor < 0;
         #rem00041#28 = -nValor;
         #rem00041#30 = 0;
         #rem00041#31 = "N";
         #rem00041#32 = 0;
         #rem00041#33 = 0;
         #rem00041#34 = 0;
         #rem00041#35 = 0;
         #rem00041#36 = 0;
         #rem00041#37 = 0;
         #rem00041#38 = 0;
         #rem00041#39 = 0;
         #rem00041#40 = 0;
         #rem00041#41 = 0;
         #rem00041#42 = 0;
         #rem00041#43 = 0;
         #rem00041#44 = 0;

         |ACABA;
     |FINSI;

     #rem00041#28 = 0;
     #rem00041#29 = 0;

     #rem00041#30 = nValor;
     #rem00041#32 = 0;
     #rem00041#33 = 0;
     #rem00041#34 = 0;

     |SI #rem00041#31 = "S";  #rem00041#32 = #rem00041#30 / 2;  |FINSI;

     |SI #rem00041#24 ! 0;
         #rem00041#33 = (#rem00041#30 - #rem00041#32) * (#rem00041#24 / #rem00041#21);
     |FINSI;

     |SI #rem00041#25 ! 0;
         #rem00041#34 = ((#rem00041#30 - #rem00041#32) / (#rem00041#21 - #rem00041#45)) * #rem00041#25;
     |FINSI;

     #rem00041#35 = #rem00041#30 - #rem00041#32 - #rem00041#33 - #rem00041#34;

     |SI #rem00041#16 = "6";  |O #rem00041#16 = "7";
         #rem00041#41 = 0;
         |SI #rem00041#42 ! 0;
             #rem00041#41 = #rem00041#35;
         |FINSI;

         #rem00041#43 = #rem00041#35 - #rem00041#42;

         #rem00041#44 = #rem00041#43 * nCampo44;
     |SINO;
         #rem00041#32 = 0;
         |SI #rem00041#31 = "S";
             #rem00041#32 = #rem00041#30 / 2;
         |FINSI;

         #rem00041#39 = #rem00041#35 - #rem00041#38;
         #rem00041#40 = (#rem00041#39 * nCampo44) * nCoefImp;
     |FINSI;

     #rem00041#36 = 0;
     #rem00041#37 = 0;
     #rem00041#38 = 0;

     |SI #rem00041#20 ] "31.12.1994";
         #rem00041#26 = 0;
     |FINSI;

     |SI #rem00041#20 < "31.12.1994";  |Y #rem00041#26 > 0;
         |SI #rem00041#14 = "I";  nPorce = 11.11;  |FINSI;
         |SI #rem00041#14 = "O";  nPorce = 14.28;  |FINSI;

         |SI #rem00041#14 = "A";
             nPorce = 25;
             |SI #rem00041#16 = "2";  nPorce = 11.11;  |FINSI;
         |FINSI;

         fFechaDT9 = "19.01.2006";
         fFechaTop = "31.12.1996";
         nDia1     = (fFechaDT9 - #rem00041#20) + 1;
         nDia2     = #rem00041#19 - #rem00041#20;

         nAnyos    = ((((fFechaTop - #rem00041#20) / 365) - 2) + .49) ! 0;
         |SI nAnyos < 0;  nAnyos = 0;  |FINSI;

         nCoefi    = nAnyos * nPorce;
         |SI nCoefi > 99.9; nCoefi = 100; |FINSI;

         #rem00041#36 = (((#rem00041#35 / nDia2) * nDia1) / (#rem00041#21 - #rem00041#25)) * #rem00041#26;
         |SI #rem00041#36 < 0;  #rem00041#36 = 0;  |FINSI;

         #rem00041#37 = nAnyos;

         #rem00041#38 = (#rem00041#36 * nCoefi) / 100;
         |SI #rem00041#38 < 0;  #rem00041#38 = 0;  |FINSI;

         #rem00041#39 = #rem00041#35 - #rem00041#38;
         #rem00041#40 = (#rem00041#39 * nCampo44) * nCoefImp;
     |FINSI;

     |SI #rem00041#16 = "6";  |O #rem00041#16 = "7";
         #rem00041#36 = 0;
         #rem00041#37 = 0;
         #rem00041#38 = 0;
     |FINSI;
|FPRC;

|PROCESO Graba41;
     #rem00041#0 = #rem00021#0;
     #rem00041#1 = 99;
     |LEE 040#rem00041.];
     |SI FSalida = 0;
         |LEE 040#rem00041.a;
     |SINO;
         |LEE 040#rem00041.u;
     |FINSI;

     |SI FSalida = 0; |Y #rem00041#0 = #rem00021#0;
         nLinea = #rem00041#1 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #rem00041;
     #rem00041#0  = #rem00021#0;
     #rem00041#1  = nLinea;

     |PARA nCampo = 2;  |SI nCampo [ 10;  |HACIENDO nCampo = nCampo + 1;
           #rem00041#nCampo# = #rem00021#nCampo#;
     |SIGUE;

                             #rem00041#3  = "R";
     |SI #rem00021#3 = "X";  #rem00041#3  = "X";  |FINSI;

     #rem00041#11 = "B1";
     #rem00041#12 = #rem00021#1;
     #rem00041#13 = aDescri;
     #rem00041#14 = "I";
     #rem00041#16 = "1";
     |SI #rem00021#128 = "2";  #rem00041#16 = "6";  |FINSI;
     |SI #rem00021#128 = "4";  #rem00041#16 = "6";  |FINSI;
     |SI #rem00021#128 = "5";  #rem00041#16 = "6";  |FINSI;

     #rem00041#17 = #rem00021#125;
     #rem00041#18 = #rem00021#14;
     #rem00041#19 = fFechaTra;
     #rem00041#20 = fFechaAdq;
     #rem00041#21 = nCampo21;
     #rem00041#22 = nCampo22;
     #rem00041#23 = nCampo23;
     #rem00041#51 = nCampo51;
     #rem00041#52 = nCampo52;
     #rem00041#24 = #rem00041#22 + #rem00041#23;
     #rem00041#25 = nCampo25;
     #rem00041#45 = nCampo45;
     #rem00041#26 = nCampo26;
     #rem00041#27 = nCampo27;
     #rem00041#29 = nCampo29;
     |HAZ Total41;

     |SI #rem00021#30 ! 0;
         |ABRE #rew99999;
         |HAZ MensaMayor65;
         |CIERRA #rew99999;

         |SI nOk = 1;
             |MENAV "0000Hay un declarante mayor de 65 a¤os, imputamos el elemento a cero.";
             |MENAV "0000Revise el dato.";
             #rem00041#40 = 0;
             #rem00041#44 = 0;
         |FINSI;
     |FINSI;

     |SI #rem00021#69 ! #rem00021#108;
         #rem00041#15 = "S";
     |FINSI;

     |GRABA 020#rem00041.n;
     |LIBERA #rem00041;

     eaPrograma   = "rem00041";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO PuntosG;
     |SI #rem00021#24 ! "S";  |ACABA;  |FINSI;

     nDias      = #rem00021#68 - #rem00021#25;
     nMejoras   = 0;
     fFechaAdq  = #rem00021#25;
     fFechaTra  = #rem00021#68;
     aDescri    = #rem00021#13;
     nCampo21   = #rem00021#71;
     nCampo27   = #rem00021#67;

     nCoefMej   = #rem00021#67 / (#rem00021#67 + #rem00021#82 + #rem00021#88 + #rem00021#94);

     nCampo22   = #rem00021#148 * nCoefMej;
     nCampo23   = #rem00021#149 * nCoefMej;
     nCampo51   = #rem00021#162 * nCoefMej;
     nCampo52   = #rem00021#163 * nCoefMej;
     nCampo25   = #rem00021#107;
     nCampo26   = #rem00021#153 * nCoefMej;
     nCampo29   = #rem00021#147;
     nCampo44   = #rem00021#108 / #rem00021#69;
     nCampo45   = #rem00021#111;
     nCoefImp   = 1;
     |SI #rem00021#69 = #rem00021#108;
         nCoefImp    = #rem00021#76 / #rem00021#75;
     |FINSI;

     |HAZ Graba41;

     |SI #rem00021#77 ! "01.01.0000";
         aDescri    = #rem00021#78;
         fFechaAdq  = #rem00021#77;
         fFechaTra  = #rem00021#68;

         nMejoras   = #rem00021#82 + #rem00021#88 + #rem00021#94;
         nCoef      = (#rem00021#82 / (#rem00021#67 + nMejoras));

         nCampo21   = (#rem00021#69 - #rem00021#70) * nCoef;
         nCampo27   = #rem00021#79;
         nCampo22   = #rem00021#148 * nCoef;
         nCampo23   = #rem00021#149 * nCoef;
         nCampo51   = #rem00021#162 * nCoef;
         nCampo52   = #rem00021#163 * nCoef;
         nCampo25   = (#rem00021#109 + #rem00021#110) * nCoef;
         nCampo26   = #rem00021#153 * nCoef;
         nCampo29   = #rem00021#147 * nCoef;
         nCampo45   = #rem00021#111 * nCoef;

         |HAZ Graba41;
     |FINSI;

     |SI #rem00021#83 ! "01.01.0000";
         aDescri    = #rem00021#84;
         fFechaAdq  = #rem00021#83;
         fFechaTra  = #rem00021#68;

         nMejoras   = #rem00021#82 + #rem00021#88 + #rem00021#94;
         nCoef      = (#rem00021#88 / (#rem00021#67 + nMejoras));

         nCampo21   = (#rem00021#69 - #rem00021#70) * nCoef;
         nCampo27   = #rem00021#85;
         nCampo22   = #rem00021#148 * nCoef;
         nCampo23   = #rem00021#149 * nCoef;
         nCampo51   = #rem00021#162 * nCoef;
         nCampo52   = #rem00021#163 * nCoef;
         nCampo23   = #rem00021#149 * nCoef;
         nCampo25   = (#rem00021#109 + #rem00021#110) * nCoef;
         nCampo26   = #rem00021#153 * nCoef;
         nCampo29   = #rem00021#147 * nCoef;
         nCampo45   = #rem00021#111 * nCoef;

         |HAZ Graba41;
     |FINSI;

     |SI #rem00021#89 ! "01.01.0000";
         aDescri    = #rem00021#90;
         fFechaAdq  = #rem00021#89;
         fFechaTra  = #rem00021#68;

         nMejoras   = #rem00021#82 + #rem00021#88 + #rem00021#94;
         nCoef      = (#rem00021#94 / (#rem00021#67 + nMejoras));

         nCampo21   = (#rem00021#69 - #rem00021#70) * nCoef;
         nCampo27   = #rem00021#91;
         nCampo22   = #rem00021#148 * nCoef;
         nCampo23   = #rem00021#149 * nCoef;
         nCampo51   = #rem00021#162 * nCoef;
         nCampo52   = #rem00021#163 * nCoef;
         nCampo25   = (#rem00021#109 + #rem00021#110) * nCoef;
         nCampo26   = #rem00021#153 * nCoef;
         nCampo29   = #rem00021#147 * nCoef;
         nCampo45   = #rem00021#111 * nCoef;

         |HAZ Graba41;
     |FINSI;
|FPRC;

|PROCESO GrabaEnRegistro;
     |DDEFECTO #rem00102;
     |SELECT #1#rem00102;
     #rem00102#0 = #rem00021#0;
     #rem00102#1 = nLineaViv;
     |LEE 101#rem00102.=;
     |SI FSalida ! 0;
         #rem00102#0 = #rem00021#0;
         #rem00102#1 = nLineaViv;
         |GRABA 020#rem00102.b;
     |FINSI;

     #rem00102#2  = #rem00021#2;
     #rem00102#3  = #rem00021#5;
     #rem00102#4  = #rem00021#6;
     #rem00102#5  = #rem00021#7;
     #rem00102#6  = #rem00021#8;
     #rem00102#7  = #rem00021#9;
     #rem00102#8  = #rem00021#10;

     |SI #rem00021#104 = "P";
         #rem00102#9  = "1";
         #rem00102#10 = "EN PROPIEDAD";
     |FINSI;

     |SI #rem00021#104 = "U";
         #rem00102#9 = "2";
         #rem00102#10 = "EN USUFRUCTO";
     |FINSI;

     #rem00102#11 = #rem00021#14;
     #rem00102#12 = #rem00021#1;
     #rem00102#14 = #rem00021#125;

     |ABRE #rem00100;
     #rem00100#0 = #rem00021#0;
     |LEE 040#rem00100.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00100;  |FINSI;
     |CIERRA #rem00100;

     |SI #rem00100#91 ! " ";
         #rem00102#13 = "F";
     |FINSI;

     |GRABA 020#rem00102.a;
     |LIBERA #rem00102;
|FPRC;

|PROCESO RegistraVivienda;
     |SELECT #2#rem00102;
     #rem00102#0  = #rem00021#0;
     #rem00102#12 = #rem00021#1;
     |LEE 101#rem00102.=;
     |SI FSalida = 0;
         nLineaViv = #rem00102#1;
         |HAZ GrabaEnRegistro;
         |ACABA;
     |FINSI;

     nLineaViv = 1;
     |SELECT #1#rem00102;
     #rem00102#0  = #rem00021#0;
     #rem00102#1  = 999;
     |LEE 000#rem00102.];
     |SI FSalida = 0;
         |LEE 000#rem00102.a;
     |SINO;
         |LEE 000#rem00102.u;
     |FINSI;
     |SI FSalida = 0;  |Y #rem00102#0 = #rem00021#0;
         nLineaViv = #rem00102#1 + 1;
     |FINSI;

     |HAZ GrabaEnRegistro;
|FPRC;

|PROCESO BorraVivienda;
     |SELECT #2#rem00102;
     #rem00102#0  = #rem00021#0;
     #rem00102#12 = #rem00021#1;
     |LEE 101#rem00102.=;
     |SI FSalida = 0;
         |BORRA 020#rem00102.a;
         |LIBERA #rem00102;
    |FINSI;
|FPRC;

|PROCESO GrabaLoDemas;
     |ABRE #rem00041;
     |HAZ PuntosG;
     |CIERRA #rem00041;

     |HAZ T7C141w621;
     |HAZ Patrimonio;

     |ABRE #rem00102;
     |SI #rem00021#124 = "S";
         |HAZ RegistraVivienda;
     |SINO;
         |HAZ BorraVivienda;
     |FINSI;
     |CIERRA #rem00102;

     eaPrograma   = "rem00102";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO rem00041B;
     |BORRA 020#rem00041.a;
     |LIBERA #rem00041;

     eaPrograma   = "rem00041";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00041B;
     #rem00041#1;
     11, 12;
     #rem00021#0, 01, "B1", #rem00021#1;
     #rem00021#0, 99, "B1", #rem00021#1;
     be;
     NULL, rem00041B;
|FIN;

|PROCESO rem00015B;
     |BORRA 020#rem00015.a;
     |LIBERA #rem00015;
|FPRC;

|DEFBUCLE rem00015B;
     #rem00015#1;
     ;
     #rem00021#0, #rem00021#1, "";
     #rem00021#0, #rem00021#1, "zzzzzzzzzzzzzzzzzzzz";
     be;
     NULL, rem00015B;
|FIN;

|PROCESO rem00015H;
     nOk = nOk + 1;
|FPRC;

|DEFBUCLE rem00015H;
     #rem00015#1;
     ;
     #rem00021#0, #rem00021#1, "";
     #rem00021#0, #rem00021#1, "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, rem00015H;
|FIN;

|PROCESO Patrimonio;
     |SI #rem00021#3  = "R";           |ACABA;  |FINSI;
     |SI #rem00021#3  = "X";           |ACABA;  |FINSI;

     |SI #rem00021#2  = "1 FAMILIAR";  |ACABA;  |FINSI;
     |SI #rem00021#2  = "2 FAMILIAR";  |ACABA;  |FINSI;
     |SI #rem00021#2  = "3 FAMILIAR";  |ACABA;  |FINSI;
     |SI #rem00021#2  = "4 FAMILIAR";  |ACABA;  |FINSI;

     eaDeclarante = #rem00021#2;

     |SI #rem00021#129 ! 0;
         nHabitual = 0;
         nValor    = 0;
         nValor1   = 0;
         nValor2   = 0;
         |SI #rem00021#30 ! 0;  |O #rem00021#33 ! 0;
             nHabitual = 1;
             nValor    = #rem00021#26;

             |SI #reparame#16 = "N";  |Y #reparame#17 = "S";
                 nValor = #rem00021#26 + #rem00021#29;
             |FINSI;

             |SI nValor < #rem00021#27;  nValor = #rem00021#27;  |FINSI;
             |SI nValor < #rem00021#15;  nValor = #rem00021#15;  |FINSI;

             |SI #rem00021#2 = "GANANCIAL ";
                 nValor = nValor / 2;
             |FINSI;

             |SI #rem00021#2 = "VARIOS    ";
                 nValor1 = nValor % #rem00021#5;
                 nValor2 = nValor % #rem00021#6;
             |FINSI;
         |FINSI;

         |SI nValor ] 150253.03;  |O nHabitual = 0;
             |HAZ LimpiaPatrim;
             eaLetra    = "U1";
             eaDeDonde  = "B1";
             eaPatr20   = #rem00021#5;
             eaPatr21   = #rem00021#6;
             eaLinDonde = #rem00021#1;
             eaAnyoUsu  = #rem00021#16;
             eaPatr06   = #rem00021#13;
             eaPatr10   = #rem00021#129;
             eaPatr25   = "V";

             |SI nValor1 = 0;  |Y nValor2 = 0;
                 |HAZ GrabaPatrimonio;
             |SINO;
                 |SI nValor1 ] 150253.03;  |O nValor2 ] 150253.03;
                     |SI nValor1 < 150253.03;  eaPatr20 = "0";  |FINSI;
                     |SI nValor2 < 150253.03;  eaPatr21 = "0";  |FINSI;

                     |HAZ GrabaPatrimonio;
                |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00021#24 = "S";  |ACABA;  |FINSI;

     |HAZ LimpiaPatrim;

     eaDeDonde  = "B1";
     eaLinDonde = #rem00021#1;
     eaAnyoUsu  = #rem00021#16;
     eaPatr06   = #rem00021#13;
     eaPatr08   = #rem00021#105;
     eaPatr09   = #rem00021#106;
     eaPatr16   = #rem00021#104;
     eaPatr17   = #rem00021#14;
     nValor     = #rem00021#26;

     |ABRE #rem00100;
     #rem00100#0 = #rem00021#0;
     |LEE 040#rem00100.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00100;  |FINSI;
     |CIERRA #rem00100;

     eaPatr25 = "P";

     |SI #reparame#16 = "N";  |Y #reparame#17 = "S";
         nValor = #rem00021#26 + #rem00021#29;
     |FINSI;

     |SI nValor < #rem00021#27;  nValor = #rem00021#27;  eaPatr25 = "A"; |FINSI;
     |SI nValor < #rem00021#15;  nValor = #rem00021#15;  eaPatr25 = "V"; |FINSI;

     |SI #rem00021#104 = "M";
         eaPatr25 = "D";
     |FINSI;

     |SI #rem00021#164 = "S";
         eaPatr25 = "C";
     |FINSI;

     eaPatr10   = nValor;

     |SI #rem00021#2 = "VARIOS    ";
         |SI #rem00021#5  ! 0;  nDiasHT = nDiasHT + #rem00021#30 + #rem00021#33;  |FINSI;
         |SI #rem00021#6  ! 0;  nDiasHC = nDiasHC + #rem00021#30 + #rem00021#33;  |FINSI;
         |SI #rem00021#7  ! 0;  nDiasH1 = nDiasH1 + #rem00021#30 + #rem00021#33;  |FINSI;
         |SI #rem00021#8  ! 0;  nDiasH2 = nDiasH2 + #rem00021#30 + #rem00021#33;  |FINSI;
         |SI #rem00021#9  ! 0;  nDiasH3 = nDiasH3 + #rem00021#30 + #rem00021#33;  |FINSI;
         |SI #rem00021#10 ! 0;  nDiasH4 = nDiasH4 + #rem00021#30 + #rem00021#33;  |FINSI;
     |FINSI;

     |SI #rem00021#2 = "1 FAMILIAR";
         nDiasH1 = nDiasH1 + #rem00021#30 + #rem00021#33;
     |FINSI;

     |SI #rem00021#2 = "2 FAMILIAR";
         nDiasH2 = nDiasH2 + #rem00021#30 + #rem00021#33;
     |FINSI;

     |SI #rem00021#2 = "3 FAMILIAR";
         nDiasH3 = nDiasH3 + #rem00021#30 + #rem00021#33;
     |FINSI;

     |SI #rem00021#2 = "4 FAMILIAR";
         nDiasH4 = nDiasH4 + #rem00021#30 + #rem00021#33;
     |FINSI;

     |SI #rem00021#18 = "R";  |O #rem00021#18 = "T";
         eaLetra    = "B1";
         eaPatr06   = #rem00021#13;
         eaPatr11   = #rem00021#19;
         eaPatr12   = #rem00021#20;
     |SINO;
         eaLetra    = "A1";
         eaPatr06   = #rem00021#13;
         eaPatr19   = "V";
         eaPatr22   = "N";
         eaPatr23   = "0";
         |SI #rem00021#18 = "L";  eaPatr19   = "L";  |FINSI;
         |SI #rem00021#18 = "O";  eaPatr19   = "O";  |FINSI;
         |SI #rem00021#18 = "S";  eaPatr19   = "O";  |FINSI;
         |SI #rem00021#30 ! 0;  |O #rem00021#33 ! 0;
             eaPatr22 = "S";
             nNume    = 300000;
             |SI #rem00021#2 = "GANANCIAL ";
                 nNume    = 600000;
             |FINSI;
             |SI nNume > nValor;
                 nNume = nValor;
             |FINSI;
             |SI #rem00100#94 = "S";  nNume = 0;  |FINSI;
             eaPatr23 = nNume;
         |FINSI;
     |FINSI;

     |SI #rem00021#104 = "U";  |Y #rem00021#30 = 0;  |Y #rem00021#33 = 0;
         eaLetra    = "M1";
         eaPatr06   = "";
         eaPatr15   = #rem00021#13;
         eaPatr14   = nValor;
     |FINSI;

     eaPatr20 = "0";
     eaPatr21 = "0";

     |SI #rem00021#2 = "TITULAR   ";
         eaPatr20 = "100";
     |FINSI;

     |SI #rem00021#2 = "CONYUGE   ";
         eaPatr21 = "100";
     |FINSI;

     |SI #rem00021#2 = "GANANCIAL ";
         eaPatr20 = "50";
         eaPatr21 = "50";
     |FINSI;

     |SI #rem00021#2 = "VARIOS    ";
         eaPatr20 = #rem00021#5;
         eaPatr21 = #rem00021#6;
     |FINSI;

     |HAZ GrabaPatrimonio;
|FPRC;

|PROCESO agicen17;
     nAct117 = #agicen17#1;
     nLin117 = #agicen17#2;
|FPRC;

|DEFBUCLE agicen17;
     #agicen17#1;
     3;
     #rem00021#0, 00, 00, #rem00021#14;
     #rem00021#0, 99, 99, #rem00021#14;
     ;
     NULL, agicen17;
|FIN;

|PROCESO GrabaReferencia;
     |SI #rem00021#117 = "N";    |ACABA;  |FINSI;
     |SI #rem00021#118 = "   ";  |ACABA;  |FINSI;

     nAct117 = 0;
     nLin117 = 0;
     |BUCLE agicen17;

     |SI nLin117 = 0;  |ACABA;  |FINSI;

     |ABRE #agicen18;
     #agicen18#0 = #rem00021#0;
     #agicen18#1 = nAct117;
     #agicen18#2 = nLin117;
     #agicen18#3 = 2019;
     |LEE 040#agicen18.=;
     |SI FSalida = 0;
         #agicen18#4 = #rem00021#15;
         #agicen18#5 = #rem00021#21;
         #agicen18#6 = #rem00021#28;
         |GRABA 020#agicen18.a;
         |LIBERA #agicen18;
     |FINSI;
     |CIERRA #agicen18;
|FPRC;

|PROCESO Rendimientos;
     |SI enModoReg ! 4;  |ACABA;  |FINSI;

     |HAZ QuitaBtnSalir;

     |SUB_EJECUTA_NP "rew00550";

     |HAZ PonBtnSalir;

     |FOCOTECLADO nGrid;
|FPRC;

|| ---- PROCESOS DEL REW00602

|PROCESO BotonCalc602;
     |DDEFECTO #rew00005;

     |SI FSalida = nBotonCalc602_1; nCampo = 70;  |FINSI;

     #rew00005#1  = #rew00602#nCampo#;
     #rew00005#20 = #rew00602#nCampo#;

     |HAZ PantaREW00005;

     #rew00602#nCampo# = #rew00005#20;  |PINTA #rew00602#nCampo#;

     aAlfa = "|C" + (("000" + nCampo) % -103) + "WID";
     aID   = #rew00602#aAlfa#;
     nID   = aID;
     |FOCOTECLADO nID;
|FPRC;


|PROCESO PantaVenta;
     |SI #rem00021#24 ! "S";
         |MENAV "0000No procede venta, el inmueble no est  vendido";
         |ACABA;
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ enNumCampos;  |HACIENDO nCampo = nCampo + 1;
           #rew00602#nCampo# = #rem00021#nCampo#;
     |SIGUE;

     |VENTANA 0701, 3699, -1, 16, "Venta del inmueble";
     enVtna621 = FSalida;

     |PINPA #0#rew00602;   nPanta602 = FSalida;
     |PINDA #0#rew00602;

     |CONTROL_SIMPLE nPanta602, "BOTON,{{197}}", 3639, 3640, CobroParcial;

     |LEETECLA aTecla;

     |HAZ FinVentana621;
|FPRC;

|| ---- PROCESOS DEL REW00621

|PROCESO ACeroInversion;
     #rew00621#95  = 0;
     #rew00621#96  = 0;
     #rew00621#97  = 0;
     #rew00621#98  = 0;
     #rew00621#99  = 0;
     #rew00621#100 = 0;
     #rew00621#101 = 0;
     #rew00621#102 = 0;
     #rew00621#126 = 0;
     #rew00621#127 = "";

     #rew00621#116 = "";
     #rew00621#134 = 0;
     #rew00621#129 = 0;
|FPRC;

|PROCESO MiraDeduVienda;
     nSuma = #rew00621#95 + #rew00621#99 + #rew00621#96 + #rew00621#100;
     nSuma = nSuma  + #rew00621#97 + #rew00621#101;
     nSuma = nSuma  + #rew00621#98 + #rew00621#126 + #rew00621#129;

     |SI nSuma = 0;  |ACABA;  |FINSI;

     |SI eaExtr = "";  eaExtr = "N";  |FINSI;

     |SI #rew00621#25 ] "01.01.2013";   || A partir de esta fecha ya no hay inversiones
         |HAZ ACeroInversion;
         |ACABA;
     |FINSI;

     |SI #rew00621#30 = 0;  |Y #rew00621#33 = 0;  |Y eaExtr = "N";
         |MENAV "0000Hay deducciones por la vivienda y la vivienda no es la habitual";
         |CONFI "0000SPonemos a cero las deducciones.";
         |SI FSalida ! 0;
             |MENAV "0000No puedo validar el registro. Introduzca dias en la vivienda habitual";
             |ERROR;
             |ACABA;
         |SINO;
             |HAZ ACeroInversion;
         |FINSI;
     |FINSI;

|FPRC;

|PROCESO MiraAlquiler;
     nSuma = #rew00621#47 + #rew00621#122 + #rew00621#123;

     |SI nSuma = 0;  |Y #rew00621#137 = "N";
         |ACABA;
     |FINSI;

     |SI #rew00621#31 = 0;  |Y #rew00621#34 = 0;
         |MENAV "0000Hay cantidades en alquileres y la vivienda no ha estado alquilada";
         |CONFI "0000SPonemos a cero los alquileres.";
         |SI FSalida ! 0;
             |MENAV "0000No puedo validar el registro. Introduzca dias en alquileres";
             |ERROR;
             |ACABA;
         |SINO;
             #rew00621#47  = 0;
             #rew00621#38  = 0;
             #rew00621#40  = 0;
             #rew00621#42  = 0;
             #rew00621#44  = 0;
             #rew00621#122 = 0;
             #rew00621#156 = 0;
             #rew00621#157 = 0;
             #rew00621#158 = 0;
             #rew00621#159 = 0;
             #rew00621#140 = 0;
             #rew00621#22  = 0;
             #rew00621#131 = 0;
             #rew00621#51  = 0;
             #rew00621#53  = 0;
             #rew00621#57  = 0;
             #rew00621#112 = 0;
             #rew00621#114 = 0;
             #rew00621#115 = 0;
             #rew00621#60  = 0;
             #rew00621#55  = 0;
             #rew00621#123 = 0;
             #rew00621#61  = 0;
             #rew00621#137 = "N";
             #rew00621#131 = 0;
             #rew00621#133 = 0;
         |FINSI;

         |BUCLE rem00015B;
         |ACABA;
     |FINSI;

     |SI #rew00621#137 = "S";
         |BUCLE rem00015B;
         |ACABA;
     |FINSI;

     nOk = 0;
     |BUCLE rem00015H;
     |SI nOk = 0;
         |MENAV "0000La vivienda ha sido alquilada y no se ha informado del NIF del arrendatario";
     |FINSI;

     |SI nOk > 2;
         |MENAV "0000Se han informado mas de dos NIF de arrendatarios, solo se emitir n los dos primeros.";
     |FINSI;
|FPRC;

|PROCESO Tipo0C23Fw621;
     |SI #rew00621#30 = 0;  |Y #rew00621#33 = 0;
         #rew00621#23 = 0;
     |SINO;
         #rew00621#23 = #rew00621#95 + #rew00621#96 + #rew00621#97;
         #rew00621#23 = #rew00621#23 + #rew00621#98 + #rew00621#99;
         #rew00621#23 = #rew00621#23 + #rew00621#100 + #rew00621#101;
         #rew00621#23 = #rew00621#23 + #rew00621#102;
     |FINSI;

     |PINTA #rew00621#23;
|FPRC;

|PROCESO CtrlGanancias;
     #rew00003#0 = #rem00021#2;
     #rew00003#1 = #rem00021#3;
     #rew00003#2 = #rem00021#4;
     #rew00003#3 = #rem00021#5;
     #rew00003#4 = #rem00021#6;
     #rew00003#5 = #rem00021#7;
     #rew00003#6 = #rem00021#8;
     #rew00003#7 = #rem00021#9;
     #rew00003#8 = #rem00021#10;

     enImporte = #rem00021#150;  |HAZ GrabaVitalicias;
     enImporte = #rem00021#153;  |HAZ GrabaDT9;
|FPRC;

|PROCESO Tipo12Fw621;  |TIPO 12;
     |SI FSalida = 7;
         |HAZ FinVentana621;
         |ACABA;
     |FINSI;

     |HAZ FinVentana621;

     |SI #rew00621#141 ! 6; |Y #rew00621#30 ! 0;  |Y #rew00621#124 = "N";
         |ABRE #rem00102;
         |SELECT #3#rem00102;
         #rem00102#0  = enEmpresa;
         #rem00102#11 = #rew00621#14;
         |LEE 000#rem00102.=;
         |SI FSalida ! 0;
             |CONFI "0000SVivienda habitual, quiere registrar la vivienda";
             |SI FSalida = 0;
                 #rew00621#124 = "S";
             |FINSI;
         |FINSI;
         |CIERRA #rem00102;
     |FINSI;

     |SI #rew00621#68 < "15.05.2019";
         #rew00621#144 = "N";
     |FINSI;

     aAlfa = #rew00621#2;  |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000No se puede validar la ficha, no hay contribuyente introducido";
         |ERROR;
         |ACABA;
     |FINSI;

     |HAZ TotalDias;

     nValor = #rew00621#30 + #rew00621#31 + #rew00621#32 + #rew00621#33 + #rew00621#34 + #rew00621#35;
     nTotal = enTotalDias1 + enTotalDias2;
     |SI nValor ! nTotal; |Y #rew00621#104 ! "M";
         aAlfa = "     N£meros de d¡as incompletos deben ser " + nTotal;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     nSuma = #rew00621#95 + #rew00621#96 + #rew00621#99 + #rew00621#100;
     |SI nSuma ! 0;
         |SI #rew00621#134 = 0;
             |MENAV "0000Hay financiaci¢n ajena y hay un porcentaje de prestamo igual a cero. Revise el dato.";
         |FINSI;

         aAlfa = #rew00621#116;  |QBF aAlfa;
         |SI aAlfa = "";
             |MENAV "0000Hay financiacion ajena y no esta introducido el n£mero de prestamo. Revise el dato.";
         |FINSI;
     |FINSI;

     |SI #rew00621#32 ! 0;  |O #rew00621#35 ! 0;
         |SI #rew00621#128 ! "2";  |Y #rew00621#128 ! "4";  |Y #rew00621#128 ! "5";
             |SI #rew00621#136 = 0;
                 |MENAV "0000 La parte de la disposici¢n esta a cero. Por favor revise el dato.";
             |FINSI;
         |SINO;
             |SI #rew00621#136 ! 0;
                 |MENAV "0000 La parte de la disposici¢n debe ser cero. Por favor revise el dato.";
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #rew00621#32 = 0;  |Y #rew00621#35 = 0;
         |SI #rew00621#136 ! 0;
             |MENAV "0000 La parte de la disposcion debe ser cero. Por favor revise el dato.";
         |FINSI;
     |FINSI;

     |SI #rew00621#18 = "S";  |O #rew00621#18 = "R";  |O #rew00621#18 = "T";
         |SI #rew00621#115 = 0;
             #rew00621#58  = 0;
         |FINSI;
     |FINSI;

     |SI #rew00621#24 = "S";  |Y #rew00621#3 ! "X";
         |ABRE #rew99999;
         |HAZ MensaMayor65;
         |CIERRA #rew99999;

         |SI nOk = 1;
             aAlfa = "0000Transmisi¢n vivienda habitual y contribuyente mayor de 65 a¤os. ";
             aAlfa = aAlfa + "Revise si la ganancia es exenta";
             |MENAV aAlfa;
         |FINSI;

         |PARA nCampo = 0;  |SI nCampo [ enNumCampos;  |HACIENDO nCampo = nCampo + 1;
               #rew00602#nCampo# = #rew00621#nCampo#;
         |SIGUE;

         |VENTANA 0701, 3699, -1, 16, "Venta del inmueble";
         enVtna621 = FSalida;

         enQuita = 1;  |HAZ CtrlGanancias;

         |PINPA #0#rew00602;   nPanta602 = FSalida;

         |CONTROL_SIMPLE nPanta602, "BOTON,&1", 1849, 1850, BotonCalc602;
         nBotonCalc602_1 = FSalida;

         |PINDA #0#rew00602;
         |ENDATOS #1#rew00602;
         |SI FSalida = 0;
             |PARA nCampo = 0;  |SI nCampo [ enNumCampos;  |HACIENDO nCampo = nCampo + 1;
                   #rew00621#nCampo# = #rew00602#nCampo#;
             |SIGUE;
         |FINSI;

         enQuita = 0;  |HAZ CtrlGanancias;

         |SI #rew00621#25 < "31.12.1994";  |Y #rew00621#153 = 0;
             |MENAV "0000Inmueble adquirido antes del 31.12.1994. Revise si se puede aplicat DT9";
         |FINSI;

         |HAZ FinVentana621;
     |FINSI;

     |SI #rew00621#31 ! 0;  |O #rew00621#34 ! 0;
         |SI #rew00621#3 ! "X";  |Y #rew00621#141 ! "4";
             |PARA nCampo = 0;  |SI nCampo [ enNumCampos;  |HACIENDO nCampo = nCampo + 1;
                   #rew00601#nCampo# = #rew00621#nCampo#;
             |SIGUE;

             |SI #rew00601#26 = 0;
                 |MENAV "0000Valor de Adquisi¢n no informado. Revise el dato.";
             |FINSI;

             |SI #rew00601#103 = 0;
                 |MENAV "0000Valor de Construcci¢n no informado. Revise el dato.";
             |FINSI;

             |VENTANA 501, 3799, -1, 16, "Alquileres";
             enVtna621 = FSalida;

             |PINPA #0#rew00601;
             enPanta601 = FSalida;

             nRng = 1 + 4 + 8 + 16 + 32 + 128;
             |LINEAL_SIMPLE #1#rem00015, nRng, 0702, 1148, Baja15, Alta15, NULL;

             |HAZ TotalFw601;

             |PINDA #0#rew00601;
             |HAZ MensaAlquiler;

             |ENDATOS #1#rew00601;
             |SI FSalida = 0;
                 |PARA nCampo = 0;  |SI nCampo [ enNumCampos;  |HACIENDO nCampo = nCampo + 1;
                       #rew00621#nCampo# = #rew00601#nCampo#;
                 |SIGUE;
             |FINSI;

             |HAZ FinVentana621;
         |FINSI;
     |FINSI;

     |HAZ MiraDeduVienda;
     |HAZ MiraAlquiler;
|FPRC;

|PROCESO T0C160w621;  |TIPO 0;
     |POSICIONATE #rew00621#13;
|FPRC;

|PROCESO T66C166w621;  |TIPO 66;
     aPopup1  = 0;
     aPopup2  = 2;

     aPopup3  = "O - Oneroso";
     aPopup4  = "L - Lucrativo";

     |PARA;  |SI;  |HACIENDO;
          IaPopup  = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 101;

              |SAL;
              |PULSATECLA;
          |FINSI;
     |SIGUE;

     #rew00621#166 = aAlfa;
     |PINTA #rew00621#166;

     |PULSATECLA;
|FPRC;

|PROCESO nContenidoDias;  |TIPO 0;
     |SI Contenido ! #rew00621#Campo#;
         #rew00621#30  = 0;  |PINTA #rew00621#30;
         #rew00621#31  = 0;  |PINTA #rew00621#31;
         #rew00621#32  = 0;  |PINTA #rew00621#32;
         #rew00621#33  = 0;  |PINTA #rew00621#33;
         #rew00621#34  = 0;  |PINTA #rew00621#34;
         #rew00621#35  = 0;  |PINTA #rew00621#36;
         #rew00621#141 = ""; |PINTA #rew00621#141;
     |FINSI;
|FPRC;

|PROCESO Venta;  |TIPO 0;
     |C_M #rew00621#68, 1, "S";
     |SI #rew00621#24 = "N";
         #rew00621#68 = "01.01.0000";
         |C_M #rew00621#68, 1, "N";
         |PINTA #rew00621#68;
     |SINO;
         |SI #rew00621#68 = "01.01.0000";
             #rew00621#68 = "01.01.2019";
         |FINSI;
     |FINSI;
     |PINTA #rew00621#68;

     |SI #reparame#16 = "S";
         #rew00621#29 = 0;
         |PINTA #rew00621#29;
     |FINSI;
|FPRC;

|PROCESO Tipo0C25Fw621;  |TIPO 0;
     |ABRE #rem00100;
     #rem00100#0 = #rew00621#0;
     |LEE 040#rem00100.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00100;  |FINSI;
     |CIERRA #rem00100;

     |SI #rem00100#10 = "S";
         |SI #rew00621#25 > "31.12.2019";
             |MENAV "0000 Fecha erronea";
             |ERROR;
         |FINSI;
     |FINSI;

     |SI #rew00621#24 ! "S";           |ACABA;  |FINSI;
     |SI #rew00621#25 ] "31.12.1994";  |ACABA;  |FINSI;

     |SI #rew00621#2 = "GANANCIAL ";  |O #rew00621#2 = "VARIOS    ";
         nFallecido = 0;

         |ABRE #rew99999;
         |SELECT #2#rew99999;
         #rew99999#1 = "TITULAR   ";
         |LEE 000#rew99999.=;
         |SI FSalida ! 0;  |DDEFECTO #rew99999;  |FINSI;
         |SI #rew99999#5 = "S";  nFallecido = 1;  |FINSI;

         |SELECT #2#rew99999;
         #rew99999#1 = "CONYUGE   ";
         |LEE 000#rew99999.=;
         |SI FSalida ! 0;  |DDEFECTO #rew99999;  |FINSI;
         |SI #rew99999#5 = "S";  nFallecido = 1;  |FINSI;

         |SELECT #1#rew99999;
         |CIERRA #rew99999;

         |SI nFallecido = 1;
             |MENAV "0000 Venta con un fallecido con fecha de adquisicion inferior a 31.12.1994, por favor introduzcalos individuales";
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO VTerreno;  |TIPO 0;
     |SI FSalida = 10;
         nValor = #rew00621#15;
         |SI #rew00621#103 ! 0;
             nPorce = 100 - ((#rew00621#103 / #rew00621#15) * 100);

             #rew00621#28 = nValor % nPorce;
         |SINO;

             #rew00621#28 = nValor % #reparame#14;
         |FINSI;

         |PINTA #rew00621#28;
     |FINSI;

     |SI #rew00621#28 > #rew00621#15;  |Y #rew00621#15 ! 0;
         |MENAV "0000 Puede haber un error, Valor del Terreno mayor al Valor Catastral";
     |FINSI;
|FPRC;

|PROCESO Tipo7C31F2621;  |TIPO 7;
     |SI #rew00621#18 = "S";  |O #rew00621#18 = "T";
      |O #rew00621#104 = "N";
         #rew00621#31 = 0;
         |PINTA #rew00621#31;
         |ACABA;
     |FINSI;

     nValor = #rew00621#30 + #rew00621#31 + #rew00621#32 + #rew00621#33 + #rew00621#34 + #rew00621#35;
     |SI nValor = 0;
         #rew00621#31 = enTotalDias1;
         |PINTA #rew00621#31;
     |FINSI;
|FPRC;

|PROCESO Tipo7C32F2621;  |TIPO 7;
     nValor = #rew00621#30 + #rew00621#31 + #rew00621#32 + #rew00621#33 + #rew00621#34 + #rew00621#35;
     |SI nValor = 0;
         #rew00621#32 = enTotalDias1;
         |PINTA #rew00621#32;
     |FINSI;
|FPRC;

|PROCESO Dias;  |TIPO 0;
     nContenido = Contenido;
     |SI nContenido ! #rew00621#Campo#;
         #rew00621#141 = " ";  |PINTA #rew00621#141;
     |FINSI;

     nValor = #rew00621#30 + #rew00621#31 + #rew00621#32 + #rew00621#33 + #rew00621#34 + #rew00621#35;
     nTotal = enTotalDias1 + enTotalDias2;
     |SI nValor > nTotal; |Y #rew00621#104 ! "M";
         aAlfa = "    Excedidos el numeros de dias, Total de dias = " + nTotal;

         |MENAV aAlfa;

         |SI #rew00621#18 = "S";  |O #rew00621#18 = "T";
          |O #rew00621#104 = "N";
             #rew00621#31 = 0;
             #rew00621#34 = 0;
         |FINSI;

         |SI #rew00621#30 ! 0;  #rew00621#30 = nTotal;  #rew00621#31 = 0;  #rew00621#32 = 0;  |FINSI;
         |SI #rew00621#31 ! 0;  #rew00621#31 = nTotal;  #rew00621#30 = 0;  #rew00621#32 = 0;  |FINSI;
         |SI #rew00621#32 ! 0;  #rew00621#32 = nTotal;  #rew00621#30 = 0;  #rew00621#31 = 0;  |FINSI;
         |SI #rew00621#33 ! 0;  #rew00621#33 = nTotal;  #rew00621#34 = 0;  #rew00621#35 = 0;  |FINSI;
         |SI #rew00621#34 ! 0;  #rew00621#34 = nTotal;  #rew00621#33 = 0;  #rew00621#35 = 0;  |FINSI;
         |SI #rew00621#35 ! 0;  #rew00621#35 = nTotal;  #rew00621#33 = 0;  #rew00621#34 = 0;  |FINSI;

         |PINTA #rew00621#30;
         |PINTA #rew00621#31;
         |PINTA #rew00621#32;
         |PINTA #rew00621#33;
         |PINTA #rew00621#34;
         |PINTA #rew00621#35;

         |ERROR;
     |FINSI;

     |HAZ Tipo7C136Fw621;
|FPRC;

|PROCESO Tipo0C68Fw621;  |TIPO 0;
     |ABRE #rem00100;
     #rem00100#0 = #rew00621#0;
     |LEE 040#rem00100.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00100;  |FINSI;
     |CIERRA #rem00100;

     |SI #rem00100#10 = "S";
         |SI #rew00621#68 > "31.12.2019";
             |MENAV "0000 Fecha erronea";
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO T66C104w621;  |TIPO 66;
     aPopup1  = 0;
     aPopup2  = 4;

     aPopup3  = "P - Propietario";
     aPopup4  = "U - Usufructuario";
     aPopup5  = "N - Nudo propietario";
     aPopup6  = "M - Multipropiedad";

     |PARA;  |SI;  |HACIENDO;
          IaPopup  = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 101;

              |SAL;
              |PULSATECLA;
          |FINSI;
     |SIGUE;

     #rew00621#104 = aAlfa;
     |PINTA #rew00621#104;

     |PULSATECLA;
|FPRC;

|PROCESO T0C104w621;  |TIPO 0;
     #rew00621#169 = "";
     |SI #rew00621#104 = "P";  #rew00621#169 = "Propietario";       |FINSI;
     |SI #rew00621#104 = "U";  #rew00621#169 = "Usufructuario";     |FINSI;
     |SI #rew00621#104 = "N";  #rew00621#169 = "Nudo prooietario";  |FINSI;
     |SI #rew00621#104 = "M";  #rew00621#169 = "Multipropiedad";    |FINSI;

     aAlfa = #rew00621#169;  |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000Tipo de titularidad incorrecto";
         |ERROR;
         |ACABA;
     |FINSI;

     |PINTA #rew00621#169;

     |C_M #rew00621#31, 1, "S";
     |C_M #rew00621#34, 1, "S";
     |SI #rew00621#104 = "N";
         |SI #rew00621#31 ! 0;  |O #rew00621#31 ! 0;
             |MENAV "0000 No puede poner la titularidad como nudo propietario, hay alquileres";
             |ERROR;
             |ACABA;
         |FINSI;

         #rew00621#31 = 0;  |C_M #rew00621#31, 1, "N";
         #rew00621#34 = 0;  |C_M #rew00621#34, 1, "N";
     |FINSI;

     |C_M #rew00621#16, 1, "S";
     |SI #rew00621#104 ! "N";
         |C_M #rew00621#16, 1, "N";  #rew00621#16 = 0;  |PINTA #rew00621#16;
     |FINSI;
|FPRC;

|PROCESO DatosAdicionales;  |TIPO 7;
     |C_M #rew00621#124, 1, "S";

     |SI #rew00621#30 = 0;
          |C_M #rew00621#124, 1, "N";  #rew00621#124 = "N";  |PINTA #rew00621#124;
          |ACABA;
     |FINSI;

     |SI #rew00621#104 ! "P";  |Y #rew00621#104 ! "U";
          |C_M #rew00621#124, 1, "N";  #rew00621#124 = "N";  |PINTA #rew00621#124;
          |ACABA;
     |FINSI;

     |ABRE #rem00102;
     |SELECT #3#rem00102;
     #rem00102#0  = enEmpresa;
     #rem00102#11 = #rew00621#14;
     |LEE 000#rem00102.=;
     |SI FSalida = 0;  |Y #rem00102#12 ! #rew00621#1;
         |C_M #rew00621#124, 1, "N";  #rew00621#124 = "N";  |PINTA #rew00621#124;
     |FINSI;
     |CIERRA #rem00102;
|FPRC;

|PROCESO T7C128w621;  |TIPO 7;
     |C_M #rew00621#128, 1, "S";
     |SI #rew00621#32 = 0;  |Y #rew00621#35 = 0;
         #rew00621#128 = "1";  |PINTA #rew00621#128;
         |C_M #rew00621#128, 1, "N";
     |FINSI;
|FPRC;

|PROCESO T66C128w621;  |TIPO 66;
     aPopup1  = 0;
     aPopup2  = 5;

     aPopup3  = "1 - Disposicion del titular";
     aPopup4  = "2 - Afectos actividades titular";
     aPopup5  = "5 - Afectos actividades conyuge";
     aPopup6  = "3 - Disposicion y afecto actividad titular";
     aPopup7  = "4 - Arrendamiento de negocio";

     |PARA;  |SI;  |HACIENDO;
          IaPopup  = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 101;

              |SAL;
              |PULSATECLA;
          |FINSI;
     |SIGUE;

     #rew00621#128 = aAlfa;
     |PINTA #rew00621#128;

     |PULSATECLA;
|FPRC;

|PROCESO T0C128w621;  |TIPO 0;
     #rew00621#168 = "";

     |SI #rew00621#128 = "1";  #rew00621#168 = "Disposici¢n titular ";  |FINSI;
     |SI #rew00621#128 = "2";  #rew00621#168 = "Afec.activid.titular";  |FINSI;
     |SI #rew00621#128 = "3";  #rew00621#168 = "Disp.activid.titular";  |FINSI;
     |SI #rew00621#128 = "4";  #rew00621#168 = "Arrendto.de negocio ";  |FINSI;
     |SI #rew00621#128 = "5";  #rew00621#168 = "Afec.activid.conyuge";  |FINSI;

     aAlfa = #rew00621#168;  |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000Uso inmueble incorrecto";
         |ERROR;
         |ACABA;
     |FINSI;

     |SI #rew00621#128 = "2";  |O #rew00621#128 = "5";
         |SI #rew00621#2 = "GANANCIAL ";
             |MENAV "0000Afectos actividades con m s de un titular. Sep relo en varias l¡neas";
             |ERROR;

             |ACABA;
         |FINSI;

         |SI #rew00621#2 = "VARIOS    ";
             nCon = 0;
             |SI #rew00621#5  ! 0;  nCon = nCon + 1;  |FINSI;
             |SI #rew00621#6  ! 0;  nCon = nCon + 1;  |FINSI;
             |SI #rew00621#7  ! 0;  nCon = nCon + 1;  |FINSI;
             |SI #rew00621#8  ! 0;  nCon = nCon + 1;  |FINSI;
             |SI #rew00621#9  ! 0;  nCon = nCon + 1;  |FINSI;
             |SI #rew00621#10 ! 0;  nCon = nCon + 1;  |FINSI;

             |SI nCon > 1;
                 |MENAV "0000Afectos actividades con m s de un titular. Sep relo en varias l¡neas";
                 |ERROR;
                 |ACABA;
             |FINSI;
         |FINSI;
     |FINSI;

     |PINTA #rew00621#168;

     nDias = #rew00621#30 + #rew00621#31 + #rew00621#33 + #rew00621#34;
     |SI #rew00621#128 = "2";  |O #rew00621#128 = "4";  |O #rew00621#128 = "5";
         |SI #rew00621#3 ! "R";  |Y nDias = 0;
             |MENAV "0000 ATENCION un bien afectos a actidades solo puede ser el tipo de calculo <R> Renta";
             |MENAV "0000 Se ha cambiando automaticamente a <R>, introduzca manualmente el bien en patrimonio.";
             #rew00621#3 = "R";   |PINTA #rew00621#3;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo7C136Fw621;  |TIPO 7;
     |C_M #rew00621#136, 1, "S";
     |SI #rew00621#32 = 0;  |Y #rew00621#35 = 0;
         |C_M #rew00621#136, 1, "N";
         #rew00621#136 = 0;    |PINTA #rew00621#136;
         |ACABA;
     |FINSI;

     |SI #rew00621#128 = "2";  |O #rew00621#128 = "4";  |O #rew00621#128 = "5";
         |C_M #rew00621#136, 1, "N";
         #rew00621#136 = 0;    |PINTA #rew00621#136;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO Tipo0C14Fw621;  |TIPO 0;
     aAlfa = #rew00621#14;  |QBF aAlfa;
     |SI aAlfa = "";  |ACABA;  |FINSI;

     aAlfa = aAlfa % 0;
     |SI aAlfa ! "20";
         |MENAV "0000 La longitud de la Referencia Catastral deberia ser de 20 Caracteres.";
     |FINSI;
|FPRC;

|PROCESO B21;
     #rem00021@#0 = #rew00621#0;
     #rem00021@#1 = 1;
|FPRC;

|PROCESO A21;
     #rem00021@#0 = #rew00621#0;
     #rem00021@#1 = 99;
|FPRC;

|PROCESO EligeInmueble;
     |MENAV "0000A continuaci¢n elija el inmueble principal del inmueble accesorio";

     |DDEF aDef;
     aDef = aDef + "rem00021.mas";
     |CARGA_DEF aDef, rem00021@;
     |SI FSalida ! 0;   |ACABA;  |FINSI;

     aAlfa = #rew00621#161 % 103;
     |ABRE #rem00021@;
     #rem00021@#0 = #rew00621#0;
     #rem00021@#1 = aAlfa;
     |LEE 000#rem00021@.];

     |CONSULTA_F_CLAVE #1#rem00021@, B21, A21;
     |SI FSalida = 0;
         nOk = 0;
         |SI #rem00021@#31 ! 0;  |O #rem00021@#34 ! 0;
             |SI #rem00021@#141 ! "4";  |Y #rem00021@#141 ! "5";
                 |SI #rew00621#2 = #rem00021@#2;
                     nOk = 1;
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI nOk = 1;
             #rew00621#161 = (("000" + #rem00021@#1) % -103) + "-" + #rem00021@#13;
             #rew00621#165 = #rem00021@#14;
             |PINTA #rew00621#165;
         |FINSI;

         |SI nOk = 0;
             |MENAV "0000El inmueble principal debe estar en alquiler y no ser accesorio y tener la misma titularidad";
         |FINSI;
     |FINSI;

     |CIERRA #rem00021@;
     |DESCARGA_DEF #rem00021@;
|FPRC;

|PROCESO T0C165w621;  |TIPO 0;
     |C_M #rew00621#165, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |DDEF aDef;
     aDef = aDef + "rem00021.mas";
     |CARGA_DEF aDef, rem00021@;
     |SI FSalida ! 0;   |ACABA;  |FINSI;

     aAlfa = #rew00621#161 % 103;
     |ABRE #rem00021@;
     #rem00021@#0 = #rew00621#0;
     #rem00021@#1 = aAlfa;
     |LEE 000#rem00021@.=;
     |SI FSalida ! 0;
         |MENAV "0000Seleccione el inmueble principal";
         |ERROR;
     |SINO;
         #rew00621#165 = #rem00021@#14;
         |PINTA #rew00621#165;
     |FINSI;
     |CIERRA #rem00021@;
     |DESCARGA_DEF #rem00021@;
|FPRC;

|PROCESO T66C165w621;  |TIPO 66;
     |HAZ EligeInmueble;
|FPRC;

|PROCESO T7C165w621;  |TIPO 7;
     |C_M #rew00621#165, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     aAlfa = #rew00621#161;  |QBF aAlfa;
     |SI aAlfa ! "";  |ACABA;  |FINSI;

     |HAZ EligeInmueble;
|FPRC;

|PROCESO T66C141w621;  |TIPO 66;
     aPopup1  = 0;
     aPopup2  = 7;

     aPopup3 = " - Vivienda habitual";
     aPopup4 = "1- Arrendamiento";
     aPopup5 = "2- A disposicion de sus titulares";
     aPopup6 = "3- Arrendamiento y a disposicion de sus titulares";
     aPopup7 = "4- Arrendamiento como inmueble accesorio";
     aPopup8 = "5- Arrendamiento como inmueble accesorio y a disposicion de sus titulares";
     aPopup9 = "6- Vivienda habitual del anterior conyuge";

     |PARA;  |SI;  |HACIENDO;
          IaPopup  = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 101;

              |SAL;
              |PULSATECLA;
          |FINSI;
     |SIGUE;

     #rew00621#141 = aAlfa;
     |PINTA #rew00621#141;

     |PULSATECLA;
|FPRC;

|PROCESO T7C141w621;  |TIPO 7;
     |C_M #rew00621#141, 1, "S";

     enTotalDias =  #rew00621#30 + #rew00621#31 + #rew00621#32 + #rew00621#33 + #rew00621#34 + #rew00621#35;
     nDiasAlq    =  #rew00621#31 + #rew00621#34;
     nDiasUso    =  #rew00621#32 + #rew00621#35;

     |SI #rew00621#128 = "2";  |O #rew00621#128 = "4";  |O #rew00621#128 = "5";
         |SI nDiasUso = enTotalDias;
             #rew00621#141 = " ";
             |C_M #rew00621#141, 1, "N";

             |PINTA #rew00621#141;
         |FINSI;
     |FINSI;

     |SI #rew00621#141 ! " ";  |ACABA;  |FINSI;

     |SI nDiasAlq = enTotalDias;
         #rew00621#141 = "1";
     |FINSI;

     |SI #rew00621#128 = "2";  |O #rew00621#128 = "4";  |O #rew00621#128 = "5";
         |SI nDiasAlq ! 0;  |Y nDiasUso ! 0;  |Y #rew00621#141 = " ";
             #rew00621#141 = "1";
         |FINSI;
     |FINSI;

     |SI nDiasAlq ! 0;  |Y nDiasUso ! 0;  |Y #rew00621#128 = "1";  |Y #rew00621#141 = " ";
         #rew00621#141 = "3";
     |FINSI;

     |SI nDiasAlq ! 0;  |Y nDiasUso ! 0;  |Y #rew00621#141 = " ";
                                          |Y #rew00621#128 = "3";
         #rew00621#141 = "3";
     |FINSI;

     |SI nDiasUso ! 0;  |Y nDiasAlq = 0;  |Y #rew00621#128 = "1";  |Y #rew00621#141 = " ";
         #rew00621#141 = "2";
     |FINSI;

     |SI nDiasUso ! 0;  |Y nDiasAlq = 0;  |Y #rew00621#141 = " ";
                                          |Y #rew00621#128 = "3";
         #rew00621#141 = "2";
     |FINSI;

     |SI #rew00621#141 = " ";  |Y nDiasAlq ! 0;
         #rew00621#141 = "1";
     |FINSI;

     |PINTA #rew00621#141;
|FPRC;

|PROCESO T0C141w621;  |TIPO 0;
     enTotalDias =  #rew00621#30 + #rew00621#31 + #rew00621#32 + #rew00621#33 + #rew00621#34 + #rew00621#35;
     nDiasHab    =  #rew00621#30 + #rew00621#33;
     nDiasAlq    =  #rew00621#31 + #rew00621#34;
     nDiasUso    =  #rew00621#32 + #rew00621#35;

     |C_M #rew00621#160, 1, "S";
     |C_M #rew00621#165, 1, "S";
     |SI #rew00621#141 ! "6";
         |C_M #rew00621#160, 1, "N";  #rew00621#160 = "";
     |FINSI;

     |SI #rew00621#141 ! "4";  |Y #rew00621#141 ! "5";
         |C_M #rew00621#165, 1, "N";  #rew00621#165 = "";
                                      #rew00621#161 = "";
     |FINSI;

     |PINTA #rew00621#160;
     |PINTA #rew00621#165;

     |C_M #rew00621#141, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |SI #rew00621#128 = "2";  |O #rew00621#128 = "4";  |O #rew00621#128 = "5";
         |SI nDiasUso = enTotalDias;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI nDiasHab = enTotalDias;
         |SI #rew00621#141 ! " ";  |Y #rew00621#141 ! "6";
             |MENAV "0000 Uso o destino erroneo.";
             |ERROR;
         |FINSI;
         |ACABA;
     |FINSI;

     |SI #rew00621#141 = " ";  |O #rew00621#141 = "6";
         |SI nDiasHab ! enTotalDias;
             |MENAV "0000 Uso o destino erroneo.";
             |ERROR;
         |FINSI;
         |ACABA;
     |FINSI;

     |SI #rew00621#141 = "1";
         |SI nDiasAlq ! enTotalDias;
             |SI #rew00621#128 = "2";  |O #rew00621#128 = "4";  |O #rew00621#128 = "5";
                 |SI nDiasAlq = 0;  |O nDiasUso = 0;
                     |MENAV "0000 Uso o destino erroneo.";
                     |ERROR;
                 |FINSI;
             |SINO;
                 |SI nDiasAlq = 0;  |O nDiasUso ! 0;
                     |MENAV "0000 Uso o destino erroneo.";
                     |ERROR;
                 |FINSI;
             |FINSI;
         |FINSI;
         |ACABA;
     |FINSI;

     |SI #rew00621#141 = "2";
         |SI #rew00621#128 ! "2";  |Y #rew00621#128 ! "4";  |Y #rew00621#128 ! "5";
             |SI nDiasAlq ! 0;
                 |MENAV "0000 Uso o destino erroneo.";
                 |ERROR;
             |FINSI;
         |SINO;
             |MENAV "0000 Uso o destino erroneo.";
             |ERROR;
         |FINSI;
         |ACABA;
     |FINSI;

     |SI #rew00621#141 = "3";
         |SI #rew00621#128 ! "2";  |Y #rew00621#128 ! "4";  |Y #rew00621#128 ! "5";
             |SI nDiasAlq = 0;  |O nDiasUso = 0;
                 |MENAV "0000 Uso o destino erroneo.";
                 |ERROR;
             |FINSI;
         |SINO;
             |MENAV "0000 Uso o destino erroneo.";
             |ERROR;
         |FINSI;
         |ACABA;
     |FINSI;

     |SI #rew00621#141 = "4";
         |SI nDiasAlq ! enTotalDias;
             |SI #rew00621#128 = "2";  |O #rew00621#128 = "4";  |O #rew00621#128 = "5";
                 |SI nDiasAlq = 0;  |O nDiasUso = 0;
                     |MENAV "0000 Uso o destino erroneo.";
                     |ERROR;
                 |FINSI;
             |SINO;
                 |MENAV "0000 Uso o destino erroneo.";
                 |ERROR;
             |FINSI;
         |FINSI;

         |SI #rew00621#122 ! 0;  |O #rew00621#123 ! 0;  |O #rew00621#61 ! 0;
             |MENAV "0000 No procede poner este tipo, hay importes en alquileres";
             |ERROR;
         |FINSI;

         |ACABA;
     |FINSI;

     |SI #rew00621#141 = "5";
         |SI nDiasAlq = 0;  |O nDiasUso = 0;
             |MENAV "0000 Uso o destino erroneo.";
             |ERROR;
             |ACABA;
         |FINSI;

         |SI #rew00621#122 ! 0;  |O #rew00621#123 ! 0;  |O #rew00621#61 ! 0;
             |MENAV "0000 No procede poner este tipo, hay importes en alquileres";
             |ERROR;
         |FINSI;

         |ACABA;
     |FINSI;
|FPRC;

|PROCESO T66C125w621;  |TIPO 66;
     aPopup1  = 0;
     aPopup2  = 5;

     aPopup3  = "1 - Vivienda o plaza de garaje situada en cualquier punto del territorio espa¤ol, ";
     aPopup3  = aPopup3 + "con excepcion del Pais Vasco y Navarra";
     aPopup4  = "2 - Vivienda o plaza de garaje situada en el Pais Vasco";
     aPopup5  = "3 - Vivienda o plaza de garaje situada en Navarra";
     aPopup6  = "4 - Vivienda o plaza de garaje situada en cualquier punto del territorio espa¤ol, ";
     aPopup6  = aPopup6 + "pero sin tener asignada referencia catastral.";
     aPopup7  = "5 - Vivienda o plaza de garaje situada en el extranjero. ";

     |PARA;  |SI;  |HACIENDO;
          IaPopup  = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 101;

              |SAL;
              |PULSATECLA;
          |FINSI;
     |SIGUE;

     #rew00621#125 = aAlfa;
     |PINTA #rew00621#125;

     |PULSATECLA;
|FPRC;

|PROCESO T0C125w621;  |TIPO 0;
     |C_M #rew00621#14, 1, "S";
     |SI #rew00621#125 > 3;
         |C_M #rew00621#14, 1, "N";  #rew00621#14 = "";
     |FINSI;
     |PINTA #rew00621#14;
|FPRC;

|PROCESO T66C18w621;  |TIPO 66;
     aPopup1  = 0;
     aPopup2  = 6;

     aPopup3  = "U - Urbano (con reduccion art.23.2)";
     aPopup4  = "S - Solar";
     aPopup5  = "L - Local (sin reduccion)";
     aPopup6  = "R - Rustico imputable";
     aPopup7  = "T - Rustico no imputable";
     aPopup8  = "O - Otros inmuebles";

     |PARA;  |SI;  |HACIENDO;
          IaPopup  = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 101;

              |SAL;
              |PULSATECLA;
          |FINSI;
     |SIGUE;

     #rew00621#18 = aAlfa;
     |PINTA #rew00621#18;

     |PULSATECLA;
|FPRC;

|PROCESO T0C18w621;  |TIPO 0;
     |PINTA #rew00621#18;

     #rew00621#167 = "";
     |SI #rew00621#18 = "U";  #rew00621#167 = "Urbano";                |FINSI;
     |SI #rew00621#18 = "S";  #rew00621#167 = "Solar sin edificar";    |FINSI;
     |SI #rew00621#18 = "L";  #rew00621#167 = "Local";                 |FINSI;
     |SI #rew00621#18 = "R";  #rew00621#167 = "R£stico imputable";     |FINSI;
     |SI #rew00621#18 = "T";  #rew00621#167 = "R£stico no imputable";  |FINSI;
     |SI #rew00621#18 = "O";  #rew00621#167 = "Otros inmuebles";       |FINSI;

     aAlfa = #rew00621#167;  |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000Tipo inmueble incorrecto";
         |ERROR;
         |ACABA;
     |FINSI;

     |PINTA #rew00621#167;

     |C_M #rew00621#19, 1, "S";
     |C_M #rew00621#20, 1, "S";

     |SI #rew00621#18 ! "R";  |Y #rew00621#18 ! "T";
         |C_M #rew00621#19, 1, "N";  #rew00621#19 = 0;  |PINTA #rew00621#19;
         |C_M #rew00621#20, 1, "N";  #rew00621#20 = 0;  |PINTA #rew00621#20;
     |FINSI;

     |C_M #rew00621#31, 1, "S";
     |C_M #rew00621#34, 1, "S";
     |SI #rew00621#18 = "S";  |O #rew00621#18 = "T";
         |SI #rew00621#31 ! 0;  |O #rew00621#34 ! 0;
             aAlfa = "0000 No puede poner el Tipo como " + #rew00621#18 + ", hay alquileres";
             |MENAV aAlfa;
             |ERROR;
             |ACABA;
         |FINSI;

         |C_M #rew00621#31, 1, "N";
         |C_M #rew00621#34, 1, "N";
     |FINSI;
|FPRC;

|PROCESO Tipo0C1Fw621;  |TIPO 0;
     |C_M #rew00621#1, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     #rem00021#0 = #rew00621#0;
     #rem00021#1 = #rew00621#1;
     |LEE 000#rem00021.=;
     |SI FSalida = 0;
         |MENAV "0000El registro ya existe.";
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO CargaFantasma;
     |HAZ T7C141w621;

     |C_M #rew00621#13, 1, "S";
     |C_M #rew00621#14, 1, "S";
     |C_M #rew00621#15, 1, "S";
     |C_M #rew00621#16, 1, "S";
     |C_M #rew00621#17, 1, "S";
     |C_M #rew00621#18, 1, "S";
     |C_M #rew00621#19, 1, "S";
     |C_M #rew00621#20, 1, "S";
     |C_M #rew00621#22, 1, "S";
     |C_M #rew00621#23, 1, "S";
     |C_M #rew00621#24, 1, "S";
     |C_M #rew00621#25, 1, "S";
     |C_M #rew00621#26, 1, "S";
     |C_M #rew00621#27, 1, "S";
     |C_M #rew00621#28, 1, "S";
     |C_M #rew00621#29, 1, "S";
     |C_M #rew00621#30, 1, "S";
     |C_M #rew00621#31, 1, "S";
     |C_M #rew00621#32, 1, "S";
     |C_M #rew00621#33, 1, "S";
     |C_M #rew00621#34, 1, "S";
     |C_M #rew00621#35, 1, "S";
     |C_M #rew00621#68, 1, "S";
     |C_M #rew00621#103, 1, "S";
     |C_M #rew00621#104, 1, "S";
     |C_M #rew00621#105, 1, "S";
     |C_M #rew00621#106, 1, "S";
     |C_M #rew00621#124, 1, "S";
     |C_M #rew00621#125, 1, "S";
     |C_M #rew00621#128, 1, "S";
     |C_M #rew00621#136, 1, "S";
     |C_M #rew00621#141, 1, "S";
     |C_M #rew00621#164, 1, "S";
     |C_M #rew00621#166, 1, "S";

     |SI #reparame#16 = "S";
         |C_M #rew00621#29, 1, "N";
         #rew00621#29 = 0;
         |PINTA #rew00621#29;
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ enNumCampos;  |HACIENDO nCampo = nCampo + 1;
           #rew00621#nCampo# = #rem00021#nCampo#;

           |C_V #rew00621#nCampo#, 0, aAlfa;
           |SI aAlfa = "S";  |PINTA #rew00621#nCampo#;  |FINSI;
     |SIGUE;

     |BUCLE rem00041B;

                               eaDeDonde  = "B1";
                               eaLinDonde = #rem00021#1;
                               eaLetra    = "A1";
     |SI #rem00021#18  = "R";  eaLetra    = "B1";  |FINSI;
     |SI #rem00021#18  = "T";  eaLetra    = "B1";  |FINSI;
     |SI #rem00021#104 = "U";  |Y #rem00021#30 = 0;  |Y #rem00021#33 = 0;
         eaLetra = "M1";
     |FINSI;

     |HAZ BorraPatrimonio;

     eaLetra    = "U1";
     |HAZ BorraPatrimonio;
|FPRC;

|PROCESO DescargaFantasma;
     |SI #rew00621#141 = "4";  |O #rew00621#141 = "5";
         |PARA nCampo = 0;  |SI nCampo [ enNumCampos;  |HACIENDO nCampo = nCampo + 1;
               #rew00601#nCampo# = #rew00621#nCampo#;
         |SIGUE;

         |SI #rew00601#26 = 0;
             |MENAV "0000Valor de Adquisi¢n no informado. Revise el dato.";
         |FINSI;

         |SI #rew00601#103 = 0;
             |MENAV "0000Valor de Construcci¢n no informado. Revise el dato.";
         |FINSI;

         |HAZ TotalFw601;

         #rew00621#176 = #rew00601#176;
         #rew00621#115 = #rew00601#115;
         #rew00621#58  = #rew00601#58;
         #rew00621#59  = #rew00601#59;
         #rew00621#60  = #rew00601#60;
         #rew00621#123 = 0;
         #rew00621#61  = 0;
         #rew00621#142 = 0;
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ enNumCampos;  |HACIENDO nCampo = nCampo + 1;
           |SI enSwLiquida = 1;
               |SI #rem00021#nCampo# = #rew00621#nCampo#;
                   enSwRetorno = 1;
               |FINSI;
           |FINSI;

           #rem00021#nCampo# = #rew00621#nCampo#;
     |SIGUE;

                               #rem00021#143 = "";
     |SI #rem00021#117 = "S";  #rem00021#143 = eaAzul;  |FINSI;
     |SI #rem00021#3   = "X";  #rem00021#143 = eaRojo;  |FINSI;

     |HAZ PintaDatosPantalla;
|FPRC;

|PROCESO Alta;
     |ESTADO_CONTROL nBotonAlta,   "DISABLE";
     |ESTADO_CONTROL nBotonModi,   "DISABLE";
     |ESTADO_CONTROL nBotonBaja,   "DISABLE";
     |ESTADO_CONTROL nBotonRdto,   "DISABLE";
     |ESTADO_CONTROL nBotonInve,   "DISABLE";
     |ESTADO_CONTROL nBotonVent,   "DISABLE";
     |ESTADO_CONTROL nBotonAlqu,   "DISABLE";
     |ESTADO_CONTROL nBotonCalc1,  "ENABLE";
     |ESTADO_CONTROL nBotonCalc2,  "ENABLE";
     |ESTADO_CONTROL nBotonCalc3,  "ENABLE";
     |ESTADO_CONTROL nBotonMej,    "ENABLE";

     |HAZ QuitaBtnSalir;

     |ESTADO_CONTROL nGrid, "DISABLE";

     |PULSATECLA;

     #rem00021#0 = enEmpresa;
     #rem00021#1 = 99;
     |LEE 000#rem00021.];
     |SI FSalida = 0;
         |LEE 000#rem00021.a;
     |SINO;
         |LEE 000#rem00021.u;
     |FINSI;

     |DDEFECTO #rew00621;
     #rew00621#0 = enEmpresa;
     #rew00621#1 = 1;
     |SI FSalida = 0;  |Y  #rem00021#0 = enEmpresa;
         #rew00621#1 = #rem00021#1 + 1;
     |FINSI;

     |DDEFECTO #rem00021;

     #rem00021#0 = #rew00621#0;
     #rem00021#1 = #rew00621#1;

     enModoReg = 1;
     |HAZ CargaFantasma;

     |C_M #rew00621#1, 1, "S";
     |ENDATOS #1#rew00621;
     |SI FSalida = 0;
         |HAZ DescargaFantasma;

         |GRABA 020#rem00021.n;
         |LIBERA #rem00021;

         |HAZ GrabaLoDemas;
         |HAZ GrabaReferencia;
     |FINSI;

     |SI enModo ! 4;
         |ESTADO_CONTROL nBotonAlta, "ENABLE";
     |FINSI;

     |ESTADO_CONTROL nBotonRdto,  "ENABLE";
     |ESTADO_CONTROL nBotonInve,  "ENABLE";
     |ESTADO_CONTROL nBotonVent,  "ENABLE";
     |ESTADO_CONTROL nBotonAlqu,  "ENABLE";
     |ESTADO_CONTROL nBotonCalc1, "DISABLE";
     |ESTADO_CONTROL nBotonCalc2, "DISABLE";
     |ESTADO_CONTROL nBotonCalc3, "DISABLE";
     |ESTADO_CONTROL nBotonMej,   "DISABLE";

     |HAZ PonBtnSalir;

     enModoReg = 4;
     |ESTADO_CONTROL nGrid, "ENABLE";
     |REFRESCACONTROL nGrid;

     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO Modificar;
     |SI nEntrar = 0;  |ACABA;  |FINSI;

     |LEE 101#rem00021.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ESTADO_CONTROL nBotonAlta,  "DISABLE";
     |ESTADO_CONTROL nBotonModi,  "DISABLE";
     |ESTADO_CONTROL nBotonBaja,  "DISABLE";
     |ESTADO_CONTROL nBotonRdto,  "DISABLE";
     |ESTADO_CONTROL nBotonInve,  "DISABLE";
     |ESTADO_CONTROL nBotonVent,  "DISABLE";
     |ESTADO_CONTROL nBotonAlqu,  "DISABLE";
     |ESTADO_CONTROL nBotonCalc1, "ENABLE";
     |ESTADO_CONTROL nBotonCalc2, "ENABLE";
     |ESTADO_CONTROL nBotonCalc3, "ENABLE";
     |ESTADO_CONTROL nBotonMej,   "ENABLE";

     |HAZ QuitaBtnSalir;

     |ESTADO_CONTROL nGrid, "DISABLE";

     enModoReg = 2;
     |C_M #rew00621#1, 1, "N";

     |HAZ CargaFantasma;
     |ENDATOS #2#rew00621;
     |SI FSalida = 0;
         |HAZ DescargaFantasma;

         |GRABA 020#rem00021.a;
     |FINSI;
     |LIBERA #rem00021;

     |HAZ GrabaLoDemas;

     |ESTADO_CONTROL nBotonAlta, "ENABLE";
     |ESTADO_CONTROL nBotonModi, "ENABLE";
     |ESTADO_CONTROL nBotonBaja, "ENABLE";
     |ESTADO_CONTROL nBotonRdto, "ENABLE";
     |ESTADO_CONTROL nBotonInve, "ENABLE";
     |ESTADO_CONTROL nBotonVent, "ENABLE";
     |ESTADO_CONTROL nBotonAlqu, "ENABLE";

     |ESTADO_CONTROL nBotonCalc1, "DISABLE";
     |ESTADO_CONTROL nBotonCalc2, "DISABLE";
     |ESTADO_CONTROL nBotonCalc3, "DISABLE";
     |ESTADO_CONTROL nBotonMej,   "DISABLE";

     |HAZ PonBtnSalir;

     enModoReg = 4;
     |ESTADO_CONTROL nGrid, "ENABLE";
     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO Baja;
     |SI nEntrar = 0;  |ACABA;  |FINSI;

     |CONFI "0000 Confirma la baja del registro seleccionado";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |LEE 101#rem00021.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BORRA 020#rem00021.a;
     |LIBERA #rem00021;

     |BUCLE rem00015B;
     |BUCLE rem00041B;

                               eaDeDonde  = "B1";
                               eaLinDonde = #rem00021#1;
                               eaLetra    = "A1";
     |SI #rem00021#18  = "R";  eaLetra    = "B1";  |FINSI;
     |SI #rem00021#18  = "T";  eaLetra    = "B1";  |FINSI;
     |SI #rem00021#104 = "U";  |Y #rem00021#30 = 0;  |Y #rem00021#33 = 0;
         eaLetra    = "M1";
     |FINSI;

     |HAZ BorraPatrimonio;

     eaLetra    = "U1";
     |HAZ BorraPatrimonio;

     |SI #rem00021#124 = "S";
         |ABRE #rem00102;
         |SELECT #2#rem00102;
         #rem00102#0  = #rem00021#0;
         #rem00102#12 = #rem00021#1;
         |LEE 101#rem00102.=;
         |SI FSalida = 0;
             |BORRA 020#rem00102.a;
             |LIBERA #rem00102;
         |FINSI;
         |CIERRA #rem00102;

         eaPrograma   = "rem00102";
         eaPunto      = "  ";
         |HAZ ProgramaActivo;
     |FINSI;

     nEntrar     = 0;
     enSwRetorno = 1;

     |ESTADO_CONTROL nBotonModi,  "DISABLE";
     |ESTADO_CONTROL nBotonBaja,  "DISABLE";

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO BotonCntr;
     enComunes   = 1;
     enChequeo   = 0;

     #rew00003#0 = #rew00621#2;
     #rew00003#1 = #rew00621#3;
     #rew00003#2 = #rew00621#4;
     #rew00003#3 = #rew00621#5;
     #rew00003#4 = #rew00621#6;
     #rew00003#5 = #rew00621#7;
     #rew00003#6 = #rew00621#8;
     #rew00003#7 = #rew00621#9;
     #rew00003#8 = #rew00621#10;

     |HAZ PantaREW00003;

     #rew00621#2  = #rew00003#0;    |PINTA #rew00621#2;
     #rew00621#3  = #rew00003#1;
     #rew00621#4  = #rew00003#2;
     #rew00621#5  = #rew00003#3;
     #rew00621#6  = #rew00003#4;
     #rew00621#7  = #rew00003#5;
     #rew00621#8  = #rew00003#6;
     #rew00621#9  = #rew00003#7;
     #rew00621#10 = #rew00003#8;

     aAlfa = "|C013WID";
     aID   = #rew00621#aAlfa#;
     nID   = aID;
     |FOCOTECLADO nID;

     |SI #rew00621#3 = "X";  |Y enModoReg ! 4;
         |PTEC 806;
     |FINSI;
|FPRC;

|PROCESO Tipo7C2Fw621;  |TIPO 7;
     aAlfa = #rew00621#2;  |QBF aAlfa;
     |SI aAlfa ! "";  |Y #rew00621#3 ! "X";
         |ACABA;
     |FINSI;

     |HAZ BotonCntr;
|FPRC;

|PROCESO BtnCopia;
     |HAZ CopiaInmueble;

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO BotonCalc;
     |SI enModoReg = 4;  |ACABA;  |FINSI;

     |DDEFECTO #rew00005;

     |SI FSalida = nBotonCalc1; nCampo = 22;  |FINSI;
     |SI FSalida = nBotonCalc2; nCampo = 29;  |FINSI;

     #rew00005#1  = #rew00621#nCampo#;
     #rew00005#20 = #rew00621#nCampo#;

     |HAZ PantaREW00005;

     #rew00621#nCampo# = #rew00005#20;  |PINTA #rew00621#nCampo#;

     aAlfa = "|C" + (("000" + nCampo) % -103) + "WID";
     aID   = #rew00621#aAlfa#;
     nID   = aID;
     |FOCOTECLADO nID;
|FPRC;

|PROCESO PintaDatosPantalla;
     |DDEFECTO #rew00621;
     |PARA nCampo = 0;  |SI nCampo [ enNumCampos;  |HACIENDO nCampo = nCampo + 1;
           #rew00621#nCampo# = #rem00021#nCampo#;

           |C_V #rew00621#nCampo#, 0, aAlfa;
           |SI aAlfa = "S";  |PINTA #rew00621#nCampo#;  |FINSI;

           |C_M #rew00621#nCampo#, 1, "N";
     |SIGUE;
|FPRC;

|PROCESO Evento20;
     |SI enModoReg ! 4;  |ACABA;  |FINSI;

     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#rem00021.=;

         |SI enModo = 4;
             |ESTADO_CONTROL nBotonAlta, "DISABLE";
             |ESTADO_CONTROL nBotonModi, "DISABLE";
             |ESTADO_CONTROL nBotonBaja, "DISABLE";
         |SINO;
             |ESTADO_CONTROL nBotonModi, "ENABLE";
             |ESTADO_CONTROL nBotonBaja, "ENABLE";
         |FINSI;

         |ESTADO_CONTROL nBotonInve, "ENABLE";
         |ESTADO_CONTROL nBotonVent, "ENABLE";
         |ESTADO_CONTROL nBotonAlqu, "ENABLE";

         |SI #rem00021#23 = 0;
             |ESTADO_CONTROL nBotonInve, "DISABLE";
         |FINSI;

         |SI #rem00021#24 ! "S";
             |ESTADO_CONTROL nBotonVent, "DISABLE";
         |FINSI;

         |SI #rem00021#31 = 0;  |Y #rem00021#34 = 0;
             |ESTADO_CONTROL nBotonAlqu, "DISABLE";
         |FINSI;

         |SI #rem00021#141 = "4";  |O #rem00021#141 = "5";
||             |ESTADO_CONTROL nBotonAlqu, "DISABLE";
         |FINSI;

         |SI #rem00021#79 ! 0;
             |ESTADO_CONTROL nBotonMej, "ENABLE";
         |FINSI;

         |PULSATECLA;

         nEntrar   = 1;
         enModoReg = 4;
         |HAZ PintaDatosPantalla;
     |FINSI;

     |SI FSalida = 4;
         |SI enModo = 4;  |ACABA;  |FINSI;

         |HAZ Modificar;
     |FINSI;
|FPRC;

|PROCESO BotonesPanta;
     |CONTROL_SIMPLE nPanta, "BOTON,{{193}}&Alta ", 1864, 1874, Alta;
     nBotonAlta = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}&Modificar ", 1876, 1886, Modificar;
     nBotonModi = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{199}}&Borrar", 1888, 1898, Baja;
     nBotonBaja = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}&Rendimientos", 0580, 0598, Rendimientos;
     nBotonRdto = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}&Inversi¢n", 2084, 2098, PantaInversion;
     nBotonInve = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}&Venta", 2184, 2198, PantaVenta;
     nBotonVent = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}alq&Uiler", 2284, 2298, PantaAlquiler;
     nBotonAlqu = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Me&Joras", 2384, 2398, EntraMejoras;
     nBotonMej = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}&Copiar de otro inmuelble", 1840, 1860, BtnCopia;
     nBotonCopi = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}} &Y", 1920, 1924, BotonCntr;
     nBotonCntr = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,&G", 3150, 3151, BotonCalc;
     nBotonCalc2 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,&O", 3472, 3473, EntraInversiones;
     nBotonCalc3 = FSalida;

     nEntrar   = 0;

     |ESTADO_CONTROL nBotonModi,   "DISABLE";
     |ESTADO_CONTROL nBotonBaja,   "DISABLE";
     |ESTADO_CONTROL nBotonCalc1,  "DISABLE";
     |ESTADO_CONTROL nBotonCalc2,  "DISABLE";
     |ESTADO_CONTROL nBotonCalc3,  "DISABLE";
     |ESTADO_CONTROL nBotonInve,   "DISABLE";
     |ESTADO_CONTROL nBotonVent,   "DISABLE";
     |ESTADO_CONTROL nBotonAlqu,   "DISABLE";
     |ESTADO_CONTROL nBotonMej,    "DISABLE";

     |SI enModo = 4;
         |ESTADO_CONTROL nBotonAlta, "DISABLE";
     |FINSI;
|FPRC;

|PROCESO Baja20;
     #rem00021#0 = enEmpresa;
     #rem00021#1 = 1;
|FPRC;

|PROCESO Alta20;
     #rem00021#0 = enEmpresa;
     #rem00021#1 = 99;
|FPRC;

|PROCESO rem00021;
     |SI #rem00021#2 = "TITULAR   ";
         nDiasHT = nDiasHT + #rem00021#30 + #rem00021#33;
     |FINSI;

     |SI #rem00021#2 = "CONYUGE   ";
         nDiasHC = nDiasHC + #rem00021#30 + #rem00021#33;
     |FINSI;

     |SI #rem00021#2 = "GANANCIAL ";
         nDiasHT = nDiasHT + #rem00021#30 + #rem00021#33;
         nDiasHC = nDiasHC + #rem00021#30 + #rem00021#33;
     |FINSI;

     |SI #rem00021#2 = "VARIOS    ";
         |SI #rem00021#5  ! 0;  nDiasHT = nDiasHT + #rem00021#30 + #rem00021#33;  |FINSI;
         |SI #rem00021#6  ! 0;  nDiasHC = nDiasHC + #rem00021#30 + #rem00021#33;  |FINSI;
         |SI #rem00021#7  ! 0;  nDiasH1 = nDiasH1 + #rem00021#30 + #rem00021#33;  |FINSI;
         |SI #rem00021#8  ! 0;  nDiasH2 = nDiasH2 + #rem00021#30 + #rem00021#33;  |FINSI;
         |SI #rem00021#9  ! 0;  nDiasH3 = nDiasH3 + #rem00021#30 + #rem00021#33;  |FINSI;
         |SI #rem00021#10 ! 0;  nDiasH4 = nDiasH4 + #rem00021#30 + #rem00021#33;  |FINSI;
     |FINSI;

     |SI #rem00021#2 = "1 FAMILIAR";
         nDiasH1 = nDiasH1 + #rem00021#30 + #rem00021#33;
     |FINSI;

     |SI #rem00021#2 = "2 FAMILIAR";
         nDiasH2 = nDiasH2 + #rem00021#30 + #rem00021#33;
     |FINSI;

     |SI #rem00021#2 = "3 FAMILIAR";
         nDiasH3 = nDiasH3 + #rem00021#30 + #rem00021#33;
     |FINSI;

     |SI #rem00021#2 = "4 FAMILIAR";
         nDiasH4 = nDiasH4 + #rem00021#30 + #rem00021#33;
     |FINSI;
|FPRC;

|DEFBUCLE rem00021;
     #rem00021#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     ;
     NULL, rem00021;
|FIN;

|PROCESO rem00021Cheq;
     |SI #rem00021#30 = 0;  |ACABA;  |FINSI;

     nError = 0;
     |ERROR10;
|FPRC;

|DEFBUCLE rem00021Cheq;
     #rem00021#1;
     14;
     enEmpresa, 01, #rem00102#11;
     enEmpresa, 99, #rem00102#11;
     ;
     NULL, rem00021Cheq;
|FIN;

|PROCESO rem00102;
     nError = 1;
     |BUCLE rem00021Cheq;

     |SI nError = 0;  |ACABA;  |FINSI;

     |VENTANA 1025, 1575, -1, 1, "";
     enVtna621 = FSalida;

     aAlfa = "LABEL,{{16}}" + "No existe la Referencia Catastral: " + #rem00102#11;
     |CONTROL_SIMPLE 0, aAlfa, 1128, 1175, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}informada en los datos adicionales de la vivienda habitual", 1228, 1275, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}en datos personales. Por favor inf¢rmelo. ", 1328, 1375, NULL;

     |LEETECLA  aAlfa;

     |HAZ FinVentana621;
|FPRC;

|DEFBUCLE rem00102;
     #rem00102#1;
     9;
     enEmpresa, 01, "1";
     enEmpresa, 99, "2";
     ;
     NULL,  rem00102;
|FIN;

|PROGRAMA;
     |HAZ CargaColores;
     |HAZ ChequeaDisp;

     |ABRE #reparame;
     |LEE 040#reparame.p;
     |SI FSalida ! 0;  |DDEFECTO #reparame;  |FINSI;
     |CIERRA #reparame;

     enSwRetorno = 0;
     aQueQuiero  = "|NC";
     aNumCampos  = #rem00021#aQueQuiero#;
     enNumCampos = aNumCampos;
     enNumCampos = enNumCampos - 1;
     nRango      = 4 + 8 + 16 + 32 + 128;
     enModoReg   = 4;

     |PINPA #0#rew00621;  nPanta = FSalida;

     |HAZ BotonesPanta;

     enComunes    = 1;
     enSwPresenta = 1;
     |HAZ SacaDeclarantes;
     enSwPresenta = 0;

     |DDEFECTO #rem00021;
     |HAZ PintaDatosPantalla;

     |ABRET #rem00021;
     |ABRET #rem00015;

     |LINEAL_SIMPLE #1#rem00021, nRango, 0602, 1798, Baja20, Alta20, Evento20;
     nGrid = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{001}}sa&Lir", 3488, 3498, Ptec806;
     enBtnSalir = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::," + nGrid;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;

          |SI aTecla = aRetu;
              |HAZ Modificar;
          |FINSI;
     |SIGUE;

     |CIERRAT #rem00021;
     |CIERRAT #rem00015;

     |DESTRUYECONTROL nGrid;
     |ESTADO_CONTROL nBotonAlta,   "DISABLE";
     |ESTADO_CONTROL nBotonModi,   "DISABLE";
     |ESTADO_CONTROL nBotonBaja,   "DISABLE";
     |ESTADO_CONTROL nBotonRdto,   "DISABLE";
     |ESTADO_CONTROL nBotonInve,   "DISABLE";
     |ESTADO_CONTROL nBotonVent,   "DISABLE";
     |ESTADO_CONTROL nBotonAlqu,   "DISABLE";
     |ESTADO_CONTROL nBotonMej,    "DISABLE";

     nDiasHT = 0;
     nDiasHC = 0;
     nDiasH1 = 0;
     nDiasH2 = 0;
     nDiasH3 = 0;
     nDiasH4 = 0;

     |BUCLE rem00021;

     |SI nDiasHT > 365;
         |MENAV "     Los dias de la Vivienda Habitual del Titular exceden de 365. ";
     |FINSI;

     |SI nDiasHC > 365;
         |MENAV "     Los dias de la Vivienda Habitual del Conyuge exceden de 365. ";
     |FINSI;

     |SI nDiasH1 > 365;
         |MENAV "     Los dias de la Vivienda Habitual del 1 FAMILIAR exceden de 365. ";
     |FINSI;

     |SI nDiasH2 > 365;
         |MENAV "     Los dias de la Vivienda Habitual del 2 FAMILIAR exceden de 365. ";
     |FINSI;

     |SI nDiasH3 > 365;
         |MENAV "     Los dias de la Vivienda Habitual del 3 FAMILIAR exceden de 365. ";
     |FINSI;

     |SI nDiasH4 > 365;
         |MENAV "     Los dias de la Vivienda Habitual del 4 FAMILIAR exceden de 365. ";
     |FINSI;

     |BUCLE rem00102;

     |HAZ ChequeaDisp;

     eaPrograma   = "rem00021";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRO;
