|FICHEROS;
     rem00099;
     rem00100;
     rem00099@;
|FIN;

|VARIABLES;
     aAlfa         = "";
     aAlfa1        = "";
     aLong         = "";
     aQueQuiero    = "";
     aNumCampos    = "";
     aNumPanta     = "";
     aPathRenta    = "";
     aDef          = "";
     aDescri       = "";
     aAlfa2        = "";

     nLong         = 0;
     nCaracter     = 0;
     nPosi         = 0;
     nPanta        = 0;
     nNumCampos    = 0;
     nNumPanta     = 0;
     nCampo        = 0;
     nCampo1       = 0;
     nCampo2       = 0;
     nModo         = 0;
     nEntrada      = 0;
     nRetencion    = 0;
     nValor        = 0;
     nDias         = 0;
     nContenido    = 0;
     nAnyo         = 0;
     nEjer         = 0;
     nAnyoH        = 0;
     nTLineas      = 0;
     nOk           = 0;

     &enEmpresa    = 0;
     &enModo       = 0;
     &eaDeclarante = "";
     &enComunes    = 0;
     &enMinusvalia = 0;
     &eaMinuAyuda  = "";
     &eaFallece    = "";
     &eaSwVarios   = "";
     &eaVarDni     = "";
     &enSwLiquida  = 0;
     &enSwRetorno  = 0;
     &eaPrograma   = "";
     &eaPunto      = "";
     &eaLetra      = "";
|FIN;

|PROCESO ClaveBaja20;
    #rem00099#0 = enEmpresa;
    #rem00099#1 = eaLetra;
    #rem00099#2 = 001;
|FPRC;

|PROCESO ClaveAlta20;
    #rem00099#0 = enEmpresa;
    #rem00099#1 = eaLetra;
    #rem00099#2 = 999;
|FPRC;

|PROCESO Catastral;
     aAlfa = #rem00099#17;  |QBF aAlfa;
     |SI aAlfa = "";  |ACABA;  |FINSI;

     aAlfa = aAlfa % 0;
     |SI aAlfa ! "20";
         |MENAV "0000 La longitud de la Referencia Catastral deberia ser de 20 Caracteres.";
     |FINSI;
|FPRC;

|PROCESO ValorExento;  |TIPO 7;
     |ABRE #rem00100;
     #rem00100#0 = #rem00099#0;
     |LEE 040#rem00100.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00100;  |FINSI;
     |CIERRA #rem00100;

     #rem00099#23 = 0;
     |SI #rem00099#1 = "A1"; |Y #rem00099#22 = "S";  |Y #rem00100#94 = "N";
         #rem00099#23 = 300000;
         |SI #rem00099#3 = "GANANCIAL ";
              #rem00099#23 = 600000;
         |FINSI;
         |SI #rem00099#23 > #rem00099#10;
             #rem00099#23 = #rem00099#10;
         |FINSI;
         |PINTA #rem00099#23;
     |FINSI;

     |HAZ PtecFinal;
|FPRC;

|PROCESO Titulos;
     |SI eaLetra = "A1"; aAlfa = "(A) BIENES DE NATURALEZA URBANA";                       |FINSI;
     |SI eaLetra = "B1"; aAlfa = "(B) BIENES DE NATURALEZA RUSTICA ";                     |FINSI;
     |SI eaLetra = "C1"; aAlfa = "C1) BIENES Y DERECHOS NO EXENTOS (EXCEPTO INMUEBLES)";  |FINSI;
     |SI eaLetra = "C2"; aAlfa = "C2) BIENES INMUEBLES NO EXENTOS ";                      |FINSI;
     |SI eaLetra = "D1"; aAlfa = "D) BIENES Y DERECHOS EXENTOS ";                         |FINSI;
     |SI eaLetra = "E1"; aAlfa = "E) DEPOSITOS EN CUENTAS CORRIENTES O AHORRO ";          |FINSI;
     |SI eaLetra = "F1"; aAlfa = "F1) VALORES EN BOLSA ";                                 |FINSI;
     |SI eaLetra = "F2"; aAlfa = "F2) VALORES NO BOLSA ";                                 |FINSI;
     |SI eaLetra = "G1"; aAlfa = "G1) ACCIONES EN BOLSA ";                                |FINSI;
     |SI eaLetra = "G2"; aAlfa = "G2) ACCIONES EN BOLSA OTRAS ENTIDADES ";                |FINSI;
     |SI eaLetra = "G3"; aAlfa = "G3) ACCIONES NO BOLSA ";                                |FINSI;
     |SI eaLetra = "G4"; aAlfa = "G4) ACCIONES NO BOLSA OTRAS ENTIDADES ";                |FINSI;
     |SI eaLetra = "H1"; aAlfa = "H1) ACCIONES EN BOLSA EXENTAS ";                        |FINSI;
     |SI eaLetra = "H2"; aAlfa = "H2) ACCIONES NO BOLSA EXENTAS ";                        |FINSI;
     |SI eaLetra = "I1"; aAlfa = "I) SEGUROS DE VIDA ";                                   |FINSI;
     |SI eaLetra = "J1"; aAlfa = "J) RENTAS TEMPORALES O VITALICIAS ";                    |FINSI;
     |SI eaLetra = "K1"; aAlfa = "K) JOYAS,PIELES,VEHICULOS,EMBARCACIONES,AERONAVES ";    |FINSI;
     |SI eaLetra = "L1"; aAlfa = "L) OBJETOS DE ARTE Y ANTIGUEDADES ";                    |FINSI;
     |SI eaLetra = "M1"; aAlfa = "M) DERECHOS REALES DE USO Y DISFRUTE ";                 |FINSI;
     |SI eaLetra = "N1"; aAlfa = "N) CONCESIONES ADMINISTRATIVAS ";                       |FINSI;
     |SI eaLetra = "O1"; aAlfa = "O) PROPIEDAD INTELECTUAL E INDUSTRIAL ";                |FINSI;
     |SI eaLetra = "P1"; aAlfa = "P) OPCIONES CONTRACTUALES ";                            |FINSI;
     |SI eaLetra = "Q1"; aAlfa = "Q) DEMAS BIENES Y DERECHOS DE CONTENIDO ECONOMICO ";    |FINSI;
     |SI eaLetra = "U1"; aAlfa = "DEUDAS ";                                               |FINSI;
     |SI eaLetra = "VI"; aAlfa = "PATRIMONIO IMPRODUCTIVO ";                              |FINSI;
     |SI eaLetra = "V0"; aAlfa = "GANANCIAS Y PERDIDAS PATRIMONIALES DE MAS DE 1 A¥O ";   |FINSI;
     |SI eaLetra = "V1"; aAlfa = "VALOR PATRIMONIO NO PRODUCTIVO ";                       |FINSI;
     |SI eaLetra = "V2"; aAlfa = "IMPORTES EN EL EXTRANJERO ";                            |FINSI;
     |SI eaLetra = "V3"; aAlfa = "BIENES Y DERECHOS CEUTA Y MELILLA ";                    |FINSI;
     |SI eaLetra = "V4"; aAlfa = "DATOS RENTA ";                                          |FINSI;
     |SI eaLetra = "V5"; aAlfa = "DATOS PATRIMONIO CALCULO CONJUNTA ";                    |FINSI;
     |SI eaLetra = "V6"; aAlfa = "DIVIDENDOS Y PARTICIPACION NO INTEGRADOS EN EL IRPF ";  |FINSI;
     |SI eaLetra = "V7"; aAlfa = "BONIFICACION AUTONOMICA ";                              |FINSI;
     |SI eaLetra = "V8"; aAlfa = "DEDUCCION AUTONOMICA ";                              |FINSI;
     |SI eaLetra = "V9"; aAlfa = "BIENES Y DERECHOS EXENTOS, EXCEPTO PARA DETERMINADO TIPO GRAVAMEN";  |FINSI;

     aAlfa = "LABEL,{{15}}" + aAlfa;
     |CONTROL_SIMPLE nPanta, aAlfa, 0502, 0599, NULL;

     |C_V #rem00099#26, 1, "N";
     |C_V #rem00099#27, 1, "N";

     |SI eaLetra = "A1";
         |C_V #rem00099#26, 1, "S";
     |FINSI;

     |SI eaLetra = "I1";  |O eaLetra = "N1";
      |O eaLetra = "V1";  |O eaLetra = "V3";  |O eaLetra = "V6";
      |O eaLetra = "V7";  |O eaLetra = "V8";  |O eaLetra = "V9";
      |O eaLetra = "V0";  |O eaLetra = "VI";

         |CONTROL_SIMPLE nPanta, "LABEL,{{11}}       ", 0756, 0781, NULL;
         |CONTROL_SIMPLE nPanta, "LABEL,{{11}}       ", 2725, 2790, NULL;
         |CONTROL_SIMPLE nPanta, "LABEL,{{11}}       ", 2702, 3021, NULL;

         |C_V #rem00099#16, 1, "N";
         |C_V #rem00099#20, 1, "N";
         |C_V #rem00099#21, 1, "N";
         |C_V #rem00099#13, 1, "N";
         |C_V #rem00099#14, 1, "N";
     |FINSI;

     |SI eaLetra = "K1";
         |CONTROL_SIMPLE nPanta, "LABEL,{{11}}       ", 2725, 2790, NULL;
         |CONTROL_SIMPLE nPanta, "LABEL,{{11}}Matricula", 2745, 2781, NULL;

         |C_V #rem00099#14, 1, "N";
     |FINSI;

     |SI eaLetra = "L1";
         |CONTROL_SIMPLE nPanta, "LABEL,{{11}}       ", 2725, 2790, NULL;

         |C_V #rem00099#13, 1, "N";
         |C_V #rem00099#14, 1, "N";
     |FINSI;

     |SI eaLetra = "F2";  |O eaLetra = "G3";  |O eaLetra = "G4";
                          |O eaLetra = "H2";
         |C_M #rem00099#13, 1, "N";
         #rem00099#13 = "";   |PINTA #rem00099#13;
     |FINSI;

     |SI eaLetra = "H1";  |O eaLetra = "H2";
         |CONTROL_SIMPLE nPanta, "LABEL,{{11}}%individual", 2768, 2778, NULL;
         |CONTROL_SIMPLE nPanta, "LABEL,{{11}}%familiar", 2782, 2792, NULL;

         |C_V #rem00099#26, 1, "S";
         |C_V #rem00099#27, 1, "S";
     |FINSI;

     |SI eaLetra = "O1";  |O eaLetra = "P1";  |O eaLetra = "Q1";
      |O eaLetra = "U1";
         |CONTROL_SIMPLE nPanta, "LABEL,{{11}}       ", 2725, 2790, NULL;
         |CONTROL_SIMPLE nPanta, "LABEL,{{11}}       ", 2702, 3021, NULL;

         |C_V #rem00099#13, 1, "N";
         |C_V #rem00099#14, 1, "N";
         |C_V #rem00099#16, 1, "N";
     |FINSI;

     |SI eaLetra = "V0";  |O eaLetra = "VI";
      |O eaLetra = "V6";  |O eaLetra = "V8";
      |O eaLetra = "V9";
         |CONTROL_SIMPLE nPanta, "LABEL,{{11}}             Importe", 0783, 0798, NULL;
     |FINSI;

     |SI eaLetra = "V2";
         |CONTROL_SIMPLE nPanta, "LABEL,{{11}}Valor neto", 0764, 0778, NULL;
         |CONTROL_SIMPLE nPanta, "LABEL,{{11}}Importe pagado", 0780, 0795, NULL;
     |FINSI;

     |SI eaLetra = "V5";
         |CONTROL_SIMPLE nPanta, "LABEL,{{11}}Casilla 36", 0765, 0778, NULL;
         |CONTROL_SIMPLE nPanta, "LABEL,{{11}}Casilla 38", 0783, 0795, NULL;
     |FINSI;
|FPRC;

|PROCESO PonDeclarante;  |TIPO 7;
     eaDeclarante = #rem00099#3;
     enComunes    = 3;

     |SI eaLetra = "I1"; enComunes = 2;  |FINSI;
     |SI eaLetra = "N1"; enComunes = 2;  |FINSI;
     |SI eaLetra = "O1"; enComunes = 2;  |FINSI;
     |SI eaLetra = "P1"; enComunes = 2;  |FINSI;
     |SI eaLetra = "Q1"; enComunes = 2;  |FINSI;
     |SI eaLetra = "U1"; enComunes = 2;  |FINSI;
     |SI eaLetra = "V1"; enComunes = 2;  |FINSI;
     |SI eaLetra = "V3"; enComunes = 2;  |FINSI;
     |SI eaLetra = "V6"; enComunes = 2;  |FINSI;
     |SI eaLetra = "V7"; enComunes = 2;  |FINSI;
     |SI eaLetra = "V8"; enComunes = 2;  |FINSI;
     |SI eaLetra = "V9"; enComunes = 2;  |FINSI;
     |SI eaLetra = "V0"; enComunes = 2;  |FINSI;
     |SI eaLetra = "VI"; enComunes = 2;  |FINSI;

     |HAZ SacaDeclarantes;
     #rem00099#3 = eaDeclarante;
     |PINTA #rem00099#3;

     |C_M #rem00099#20, 1, "N";
     |C_M #rem00099#21, 1, "N";

     #rem00099#20 = 0;
     #rem00099#21 = 0;

     nOk = 0;
     |SI eaLetra = "A1";  nOk = 1;  |FINSI;
     |SI eaLetra = "B1";  nOk = 1;  |FINSI;
     |SI eaLetra = "C1";  nOk = 1;  |FINSI;
     |SI eaLetra = "C2";  nOk = 1;  |FINSI;
     |SI eaLetra = "D1";  nOk = 1;  |FINSI;
     |SI eaLetra = "E1";  nOk = 1;  |FINSI;
     |SI eaLetra = "F1";  nOk = 1;  |FINSI;
     |SI eaLetra = "F2";  nOk = 1;  |FINSI;
     |SI eaLetra = "G1";  nOk = 1;  |FINSI;
     |SI eaLetra = "G2";  nOk = 1;  |FINSI;
     |SI eaLetra = "G3";  nOk = 1;  |FINSI;
     |SI eaLetra = "G4";  nOk = 1;  |FINSI;
     |SI eaLetra = "H1";  nOk = 1;  |FINSI;
     |SI eaLetra = "H2";  nOk = 1;  |FINSI;
     |SI eaLetra = "K1";  nOk = 1;  |FINSI;
     |SI eaLetra = "L1";  nOk = 1;  |FINSI;
     |SI eaLetra = "M1";  nOk = 1;  |FINSI;
     |SI eaLetra = "O1";  nOk = 1;  |FINSI;
     |SI eaLetra = "P1";  nOk = 1;  |FINSI;
     |SI eaLetra = "Q1";  nOk = 1;  |FINSI;
     |SI eaLetra = "U1";  nOk = 1;  |FINSI;

     |SI nOk = 0; |ACABA;  |FINSI;

     |SI #rem00099#3#2 = "TITULAR   ";
         #rem00099#20 = 100;
     |FINSI;

     |SI #rem00099#3#2 = "CONYUGE   ";
         #rem00099#21 = 100;
     |FINSI;

     |SI #rem00099#3#2 = "GANANCIAL ";
         #rem00099#20 = 50;
         #rem00099#21 = 50;
     |FINSI;

     |SI #rem00099#3#2 = "VARIOS    ";
         |C_M #rem00099#20, 1, "S";
         |C_M #rem00099#21, 1, "S";
     |FINSI;

     |PINTA #rem00099#20;
     |PINTA #rem00099#21;
|FPRC;

|PROCESO Tipo2m20;  |TIPO 2;
     nModo = (FEntrada / 100) ! 0;

     |SI #rem00099#4 ! "  ";  |Y #rem00099#5 ! 0;
         aAlfa = "     Patrimonio Introducido desde Renta, Letra " + #rem00099#4 + " Linea " + #rem00099#5;
         |MENAV aAlfa;
         |ERROR;
         |ACABA;
     |FINSI;

     |SI nModo = 1;  |O nModo = 3;
         enSwRetorno  = 1;
         |ACABA;
     |FINSI;

     nEntrada = 0 +. 1;

     |SI nEntrada ! 1;
         |PARA nCampo = 0;  |SI nCampo [ nNumCampos;  |HACIENDO nCampo = nCampo + 1;
               #rem00099@#nCampo# = #rem00099#nCampo#;
         |SIGUE;
     |SINO;
         |PARA nCampo = 0;  |SI nCampo [ nNumCampos;  |HACIENDO nCampo = nCampo + 1;
               |SI #rem00099@#nCampo# ! #rem00099#nCampo#;
                   enSwRetorno  = 1;
               |FINSI;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO T0C16;  |TIPO 0;
     |SI #rem00099#16 ! "U";
         |ACABA;
     |FINSI;

     |SI eaLetra ! "H1";  |Y eaLetra ! "H2";
         |MENAV "0000No procede esta clave";

         #rem00099#16 = "P";  |PINTA #rem00099#16;
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tipo7m20;  |TIPO 7;
     |SI #rem00099#4 = "PA";
         |ATRI I;
         |PINTA 0706, "PROVIENE DEL PASE AUTOMATICO";
         |ATRI 0;
     |SINO;
         ||PINTA 0706, "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ";
     |FINSI;
|FPRC;

|PROGRAMA;
     |SI eaLetra = "V8";
         |ABRE #rem00100;
         #rem00100#0 = enEmpresa;
         |LEE 040#rem00100.=;
         |SI FSalida ! 0;  |DDEFECTO #rem00100;  |FINSI;
         |CIERRA #rem00100;

         nOk = 0;

         |SI #rem00100#11 = 11; nOk = 1;  |FINSI;
         |SI #rem00100#43 = 11; nOk = 1;  |FINSI;
         |SI #rem00100#94 = "S";  |Y #rem00100#99 = "2";
             nOk = 1;
         |FINSI;
         |SI #rem00100#94 = "N";  |Y #rem00100#99 = "1";
             nOk = 1;
         |FINSI;

         |SI nOk = 0;
             |MENAV "0000No puede haber deducci¢n auton¢mica.";
             |ACABA;
         |FINSI;
     |FINSI;

     |HAZ CargaColores;

     enSwRetorno = 0;
     aQueQuiero  = "|NP";
     aNumPanta   = #rem00099#aQueQuiero#;
     nNumPanta   = aNumPanta;
     nNumPanta   = nNumPanta - 1;

     aQueQuiero = "|NC";
     aNumCampos = #rem00099#aQueQuiero#;
     nNumCampos = aNumCampos;
     nNumCampos = nNumCampos - 1;

     |DBASE aPathRenta;  |QBT aPathRenta;
     aDef = aPathRenta + "def/rem00099.mas";
     |CARGA_DEF aDef, rem00099@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00099.mas";
         |MENAV aAlfa;
         |ERROR;
     |FINSI;

     |PINPA #0#rem00099;  nPanta = FSalida;
     |HAZ Titulos;

     |ENTLINEAL #1#rem00099, -3, enModo, 24, 0, ClaveBaja20, ClaveAlta20;

     |DESCARGA_DEF #rem00099@;

     eaPrograma   = "rem00099";
     eaPunto      = eaLetra;
     |HAZ ProgramaActivo;
|FPRO;
