|FICHEROS;
   finm0009 #0;

   finm0006 #5;
   finm0011 #11;
   finm0012 #12;
   finm0014 #14;
|FIN;

|VARIABLES;
   &entrada = 1;
   &eaCuenta = "";
   sw = 0;
   long = 0;
   sw_yaesta = 0;
   mesalf = "";
   alfa1 = "";
   alfa2 = "";
   alfa3 = "";
   alfa4 = "";
   aAlfa = "";
   nume1 = 0;
   nume2 = 0;
   nume3 = 0;
   nume4 = 0;
   nume5 = 0;
   aparam = "";

   dig4 = 0;
   dig5 = 0;
   dig6 = 0;
   dig7 = 0;
   dig8 = 0;
   dig9 = 0;
   fFecha = @;

   nTotal = 0;
   nCont  = 0;
   nOpc   = 0;
   nCalc  = 0;
   nCalc1 = 0;
   salidas = 0;

{-1}aMenu = "";
    aMenu1 = "2400";
    aMenu2 = "1";
    aMenu3 = "";
    aMenu4 = "CS";
    aMenu5 = "Comprobacion Con niveles";
    aMenu6 = "Comprobacion Sin niveles";
|FIN;

|PROCESO mayor1;
   #finm0009#Campo# = #finm0009#Campo# > " ";
   |PINTA #finm0009#Campo#;
|FPRC;

|PROCESO antesque;  |TIPO 80;
   FSalida = 2499;
|FPRC;

|PROCESO alsalir;  |TIPO 9;
|FPRC;

|PROCESO deshas; |TIPO 7;
|FPRC;

|PROCESO mes;
   |SI nume5 =  1;  mesalf = "ENERO     ";  |FINSI;
   |SI nume5 =  2;  mesalf = "FEBRERO   ";  |FINSI;
   |SI nume5 =  3;  mesalf = "MARZO     ";  |FINSI;
   |SI nume5 =  4;  mesalf = "ABRIL     ";  |FINSI;
   |SI nume5 =  5;  mesalf = "MAYO      ";  |FINSI;
   |SI nume5 =  6;  mesalf = "JUNIO     ";  |FINSI;
   |SI nume5 =  7;  mesalf = "JULIO     ";  |FINSI;
   |SI nume5 =  8;  mesalf = "AGOSTO    ";  |FINSI;
   |SI nume5 =  9;  mesalf = "SEPTIEMBRE";  |FINSI;
   |SI nume5 = 10;  mesalf = "OCTUBRE   ";  |FINSI;
   |SI nume5 = 11;  mesalf = "NOVIEMBRE ";  |FINSI;
   |SI nume5 = 12;  mesalf = "DICIEMBRE ";  |FINSI;
|FPRC;

|PROCESO tipopre; |TIPO 0;
   |HAZ mayor1;
   |SI #finm0009#Campo# = "M";
      alfa1 = "S";
      |CAMPO_MODIFICA #finm0009#16, 1, "N";
   |SINO;
      alfa1 = "N";
      |CAMPO_MODIFICA #finm0009#16, 1, "S";
   |FINSI;
|FPRC;

|PROCESO divide; |TIPO 0;
   |SI #finm0009#3 = "A";
      nume2 = #finm0009#16 / 12;
      nume4 = 0;
      |PARA nume3 = 4; |SI nume3 [ 14; |HACIENDO nume3 = nume3 + 1;
         #finm0009#nume3# = nume2;
         nume4 = nume4 + #finm0009#nume3#;
      |SIGUE;
      #finm0009#15 = #finm0009#16 - nume4;
   |FINSI;
   |PINDA #0#0;
|FPRC;

|PROCESO cuenta; |TIPO 6;
   eaCuenta = #finm0009#Campo#;
   salidas  = FSalida;
   eaCuenta = eaCuenta - ".";
   |PARA; |SI FSalida ! 0; |HACIENDO;
      nCalc  = ((FSalida / 100) ! 0) + 99;
      nCalc1 = FSalida + 98;
      eaCuenta = (eaCuenta % nCalc) + "0" + (eaCuenta % nCalc1);
      eaCuenta = eaCuenta - ".";
   |SIGUE;
   #finm0009#Campo# = eaCuenta;
   |PINTA #finm0009#Campo#;

   nume1 = Campo + 1;
   alfa1 = #finm0009#Campo#;
   |QBF alfa1;
   alfa1 = alfa1 % 0;
   long = alfa1;
   sw   = 0;
   #finm0009#nume1# = 0;  || inicializa el digito
   |SI long = dig4; |Y dig4 ! 0; sw = 1; #finm0009#nume1# = 1; |FINSI;
   |SI long = dig5; |Y dig5 ! 0; sw = 1; #finm0009#nume1# = 2; |FINSI;
   |SI long = dig6; |Y dig6 ! 0; sw = 1; #finm0009#nume1# = 3; |FINSI;
   |SI long = dig7; |Y dig7 ! 0; sw = 1; #finm0009#nume1# = 4; |FINSI;
   |SI long = dig8; |Y dig8 ! 0; sw = 1; #finm0009#nume1# = 5; |FINSI;
   |SI long = dig9; |Y dig9 ! 0; sw = 1; #finm0009#nume1# = 6; |FINSI;
   |SI sw = 0;|Y long ! 0;
      |MENAV "    Longitud de Cuenta Fuera de Nivel !";
      |ERROR;
      |ACABA;
   |FINSI;

   aAlfa = #finm0009#2; |QBF aAlfa;
   aAlfa = aAlfa % 0104;
   |ABRE #finm0012;
   |ABRE #finm0014; |SELECT #2#finm0014;
   |PARA; |SI aAlfa ! ""; |HACIENDO;
      #finm0014#2 = aAlfa;
      |LEE 000#finm0014.=;
      |SI FSalida = 0;
         #finm0009#20 = #finm0014#0; |PINTA #finm0009#20; |SAL;

         #finm0012#0 = #finm0014#0;
         |LEE 000#finm0012.=;
         |SI FSalida ! 0; |DDEFECTO #finm0012; |FINSI;
         |PINTA 1227, #finm0012#1;
      |FINSI;
      aAlfa = aAlfa % -299;
   |SIGUE;
   |SELECT #1#finm0014; |CIERRA #finm0014;
   |CIERRA #finm0012;
|FPRC;

|PROCESO cuefin; |TIPO 0;
   |SI #finm0009#Campo# ! "            ";
      |ABRE #finm0006;
      fFecha = ~; aAlfa = fFecha; aAlfa = aAlfa % -104;
      #finm0006#0 = aAlfa;
      #finm0006#1 = #finm0009#2;
      |LEE 001#finm0006.=;
      |SI FSalida ! 0;
         |MENAV "    Cuenta Inexistente ...";
         |ERROR;
      |FINSI;
      |CIERRA #finm0006;
   |FINSI;
|FPRC;

|PROCESO acumula; |TIPO 0;
   #finm0009#16 = 0;
   |PARA nume1 = 4; |SI nume1 [ 15; |HACIENDO nume1 = nume1 + 1;
      #finm0009#16 = #finm0009#16 + #finm0009#nume1#;
   |SIGUE;
   |PINTA #finm0009#16;
|FPRC;

|PROCESO Controla;
   nTotal = 0;
   |PARA nCont = 4; |SI nCont [ 15; |HACIENDO nCont = nCont + 1;
      nTotal = nTotal + #finm0009#nCont#; nTotal = nTotal ! 2;
   |SIGUE;
   |SI #finm0009#3 = "A";
      |SI nTotal > #finm0009#16;
         |MENAV "    Total anual sobrepasado";
         |ERROR;
      |FINSI;
   |SINO;
      #finm0009#16 = nTotal; |PINTA #finm0009#16;
   |FINSI;
|FPRC;

|PROCESO Tipo20; |TIPO 20;
   |SI FSalida = "OPCION";
      FSalida = "Informes";
   |SINO;
      |MENU aMenu;
      nOpc = FSalida;
      |SI nOpc < 1; |O nOpc > 2; |ACABA; |FINSI;
      aAlfa = "FICHA:" + #finm0009#19 + "," + #finm0009#0;
      |SI nOpc = 1; aAlfa = "caysalpr.tab;" + aAlfa; |FINSI;
      |SI nOpc = 2; aAlfa = "cazsalpr.tab;" + aAlfa; |FINSI;
   |FINSI;
|FPRC;

|PROCESO Ajusta; |TIPO 7;
   |SI #finm0009#3 ! "A"; |ACABA; |FINSI;
   nTotal = 0;
   |PARA nCont = 4; |SI nCont [ 14; |HACIENDO nCont = nCont + 1;
      nTotal = nTotal + #finm0009#nCont#; nTotal = nTotal ! 2;
   |SIGUE;
   nTotal = #finm0009#16 - nTotal;
   #finm0009#15 = nTotal;
|FPRC;

|PROCESO Prueba;
   |SI FSalida = 2; |ACABA; |FINSI;
   |SI #finm0009#3 = "A";
      nTotal = 0;
      |PARA nCont = 4; |SI nCont [ 15; |HACIENDO nCont = nCont + 1;
         nTotal = nTotal + #finm0009#nCont#; nTotal = nTotal ! 2;
      |SIGUE;
      |SI nTotal ! #finm0009#16;
         |CONFI "    NEl importe total no coincide con el de desglose. Ajustar ? ";
         |SI FSalida = 0; |HAZ Ajusta; |FINSI;
         |ERROR;
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO CargaDefecto;
   |ABRE #finm0011;
   #finm0011#0 = #finm0009#0;
   #finm0011#1 = #finm0009#1;
   |LEE 000#finm0011.=;
   |SI FSalida ! 0; |DDEFECTO #finm0011; |FINSI;
   |CIERRA #finm0011;
|FPRC;
