|FICHEROS;
   finm0006 #0;
   finw0001 #10,MANTE;
   finw0002 #11;

   RfActual@ #1000;
   RfAnter1@ #1001;
   RfAnter2@ #1002;
   RfAnter3@ #1003;
   RfAnter4@ #1004;
   RfAnter5@ #1005;
|FIN;

|VARIABLES;
   aAlfa  = "";
   fFecha = @;
   nRango = 0;
   nPos1  = 0;
   nPos2  = 0;
   nAnyo  = 0;

   nLabel = 0;
   nLabel1 = 0;
   nCalc  = 0;

   aEsc1  = "";
   aEsc2  = "";
   aRetu  = "";
   aTecla = "";

   nPant0 = 0;
   nPant1 = 0;
   nPant2 = 0;
   nPant3 = 0;
   nPant4 = 0;
   nPant5 = 0;
   nPant6 = 0;

   nGrid  = 0;
   nGrid1 = 0;
   nGrid2 = 0;
   nGrid3 = 0;
   nGrid4 = 0;
   nGrid5 = 0;
   nGrid6 = 0;

   nBoton1 = 0;
   nBoton2 = 0;
   nBoton3 = 0;
   nBoton4 = 0;
   nBoton5 = 0;
   nBoton6 = 0;

   nPosa1 = 0;
   nPosa2 = 0;

|| NO METER VARIABLES ENTRE ESTE BLOQUE
{-1}aVent      = "";
    aVent1     = 0;
    aVent2     = 0;
    aVent3     = 0;
    aVent4     = 0;
    aVent5     = "";
|| NO METER VARIABLES ENTRE ESTE BLOQUE
    nVentEspera = 0;
|FIN;

|PROCESO Tipo80; |TIPO 80;
   FSalida = 2899;
|FPRC;

|PROCESO EvtoGridAct;
|FPRC;

|PROCESO EvtoGridAn1;
|FPRC;

|PROCESO EvtoGridAn2;
|FPRC;

|PROCESO EvtoGridAn3;
|FPRC;

|PROCESO EvtoGridAn4;
|FPRC;

|PROCESO EvtoGridAn5;
|FPRC;

|PROCESO EvtoGridAn6;
|FPRC;

|PROCESO Pantalla1;
   |ESTADO_CONTROL nGrid1, "SHOW";
   |ESTADO_CONTROL nGrid2, "HIDE";
   |ESTADO_CONTROL nGrid3, "HIDE";
   |ESTADO_CONTROL nGrid4, "HIDE";
   |ESTADO_CONTROL nGrid5, "HIDE";
   |ESTADO_CONTROL nGrid6, "HIDE";
   |ESTADO_CONTROL nBoton1, "DISABLE";
   |ESTADO_CONTROL nBoton2, "ENABLE";
   |ESTADO_CONTROL nBoton3, "ENABLE";
   |ESTADO_CONTROL nBoton4, "ENABLE";
   |ESTADO_CONTROL nBoton5, "ENABLE";
   |ESTADO_CONTROL nBoton6, "ENABLE";
|FPRC;

|PROCESO Pantalla2;
   |ESTADO_CONTROL nGrid1, "HIDE";
   |ESTADO_CONTROL nGrid2, "SHOW";
   |ESTADO_CONTROL nGrid3, "HIDE";
   |ESTADO_CONTROL nGrid4, "HIDE";
   |ESTADO_CONTROL nGrid5, "HIDE";
   |ESTADO_CONTROL nGrid6, "HIDE";
   |ESTADO_CONTROL nBoton1, "ENABLE";
   |ESTADO_CONTROL nBoton2, "DISABLE";
   |ESTADO_CONTROL nBoton3, "ENABLE";
   |ESTADO_CONTROL nBoton4, "ENABLE";
   |ESTADO_CONTROL nBoton5, "ENABLE";
   |ESTADO_CONTROL nBoton6, "ENABLE";
|FPRC;

|PROCESO Pantalla3;
   |ESTADO_CONTROL nGrid1, "HIDE";
   |ESTADO_CONTROL nGrid2, "HIDE";
   |ESTADO_CONTROL nGrid3, "SHOW";
   |ESTADO_CONTROL nGrid4, "HIDE";
   |ESTADO_CONTROL nGrid5, "HIDE";
   |ESTADO_CONTROL nGrid6, "HIDE";
   |ESTADO_CONTROL nBoton1, "ENABLE";
   |ESTADO_CONTROL nBoton2, "ENABLE";
   |ESTADO_CONTROL nBoton3, "DISABLE";
   |ESTADO_CONTROL nBoton4, "ENABLE";
   |ESTADO_CONTROL nBoton5, "ENABLE";
   |ESTADO_CONTROL nBoton6, "ENABLE";
|FPRC;

|PROCESO Pantalla4;
   |ESTADO_CONTROL nGrid1, "HIDE";
   |ESTADO_CONTROL nGrid2, "HIDE";
   |ESTADO_CONTROL nGrid3, "HIDE";
   |ESTADO_CONTROL nGrid4, "SHOW";
   |ESTADO_CONTROL nGrid5, "HIDE";
   |ESTADO_CONTROL nGrid6, "HIDE";
   |ESTADO_CONTROL nBoton1, "ENABLE";
   |ESTADO_CONTROL nBoton2, "ENABLE";
   |ESTADO_CONTROL nBoton3, "ENABLE";
   |ESTADO_CONTROL nBoton4, "DISABLE";
   |ESTADO_CONTROL nBoton5, "ENABLE";
   |ESTADO_CONTROL nBoton6, "ENABLE";
|FPRC;

|PROCESO Pantalla5;
   |ESTADO_CONTROL nGrid1, "HIDE";
   |ESTADO_CONTROL nGrid2, "HIDE";
   |ESTADO_CONTROL nGrid3, "HIDE";
   |ESTADO_CONTROL nGrid4, "HIDE";
   |ESTADO_CONTROL nGrid5, "SHOW";
   |ESTADO_CONTROL nGrid6, "HIDE";
   |ESTADO_CONTROL nBoton1, "ENABLE";
   |ESTADO_CONTROL nBoton2, "ENABLE";
   |ESTADO_CONTROL nBoton3, "ENABLE";
   |ESTADO_CONTROL nBoton4, "ENABLE";
   |ESTADO_CONTROL nBoton5, "DISABLE";
   |ESTADO_CONTROL nBoton6, "ENABLE";
|FPRC;

|PROCESO Pantalla6;
   |ESTADO_CONTROL nGrid1, "HIDE";
   |ESTADO_CONTROL nGrid2, "HIDE";
   |ESTADO_CONTROL nGrid3, "HIDE";
   |ESTADO_CONTROL nGrid4, "HIDE";
   |ESTADO_CONTROL nGrid5, "HIDE";
   |ESTADO_CONTROL nGrid6, "SHOW";
   |ESTADO_CONTROL nBoton1, "ENABLE";
   |ESTADO_CONTROL nBoton2, "ENABLE";
   |ESTADO_CONTROL nBoton3, "ENABLE";
   |ESTADO_CONTROL nBoton4, "ENABLE";
   |ESTADO_CONTROL nBoton5, "ENABLE";
   |ESTADO_CONTROL nBoton6, "DISABLE";
|FPRC;

|PROGRAMA;
   |CLS;

   |PINPA #0#finw0001; nPant0 = FSalida;
   |PINDA #0#finw0001;
   nPos1 = 0503; nPos2 = 0778;
   |CONTROL_SIMPLE nPant0, "LABEL,{{5}}Saldos", nPos1, nPos2, NULL;
   nLabel = FSalida;

   nRango = 2 + 4 + 8 + 16 + 32;
   nPos1  = 1002; nPos2  = 2998;
   |LINEAL_SIMPLE #1#finm0006, nRango, nPos1, nPos2, NULL, NULL, EvtoGridAct;
   nGrid1 = FSalida;

   |ENDATOS #1#finw0001;
   |SI FSalida ! 0; |ACABA; |FINSI;

   |DDEF aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "finm0006.mas";
   |CARGA_DEF aAlfa, RfActual@;
   |SI FSalida = 0;
      |VENTANA 1410, 1790, -1, 17, ""; nVentEspera = FSalida;
      |PINPA #0#finw0002; nPant1 = FSalida;

      aVent1 = -1;
      aVent2 = -1;
      aVent3 = 0;
      aVent4 = nVentEspera;
      aVent5 = "MODAL";
      |ESPECIFICA "ESTADO_VENTANA", aVent;

      nPos1 = 0608; nPos2 = 0878;
      |CONTROL_SIMPLE nPant1, "LABEL,{{5}}Obteniendo informacion", nPos1, nPos2, NULL;
      nLabel1 = FSalida;
      |PTEC 802; |PAUSA;
      |PULSATECLA;

      |CARGA_DEF aAlfa, RfAnter1@;
      |CARGA_DEF aAlfa, RfAnter2@;
      |CARGA_DEF aAlfa, RfAnter3@;
      |CARGA_DEF aAlfa, RfAnter4@;
      |CARGA_DEF aAlfa, RfAnter5@;

      aAlfa = "la" + Usuario; |NOME_DAT #RfActual@#aAlfa#;
      aAlfa = "l1" + Usuario; |NOME_DAT #RfAnter1@#aAlfa#;
      aAlfa = "l2" + Usuario; |NOME_DAT #RfAnter2@#aAlfa#;
      aAlfa = "l3" + Usuario; |NOME_DAT #RfAnter3@#aAlfa#;
      aAlfa = "l4" + Usuario; |NOME_DAT #RfAnter4@#aAlfa#;
      aAlfa = "l5" + Usuario; |NOME_DAT #RfAnter5@#aAlfa#;

      |DELINDEX #RfActual@; |DELINDEX #RfAnter1@;
      |DELINDEX #RfAnter2@; |DELINDEX #RfAnter3@;
      |DELINDEX #RfAnter4@; |DELINDEX #RfAnter5@;

      nAnyo = #finw0001#1;
      aAlfa = "SELECT * FROM finm0006 INTO la" + Usuario + " WHERE 1 == " + nAnyo;
      |SQL aAlfa;

      nAnyo = nAnyo - 1;
      aAlfa = "SELECT * FROM finm0006 INTO l1" + Usuario + " WHERE 1 == " + nAnyo;
      |SQL aAlfa;

      nAnyo = nAnyo - 1;
      aAlfa = "SELECT * FROM finm0006 INTO l2" + Usuario + " WHERE 1 == " + nAnyo;
      |SQL aAlfa;

      nAnyo = nAnyo - 1;
      aAlfa = "SELECT * FROM finm0006 INTO l3" + Usuario + " WHERE 1 == " + nAnyo;
      |SQL aAlfa;

      nAnyo = nAnyo - 1;
      aAlfa = "SELECT * FROM finm0006 INTO l4" + Usuario + " WHERE 1 == " + nAnyo;
      |SQL aAlfa;

      nAnyo = nAnyo - 1;
      aAlfa = "SELECT * FROM finm0006 INTO l5" + Usuario + " WHERE 1 == " + nAnyo;
      |SQL aAlfa;

      aVent1 = -1;
      aVent2 = -1;
      aVent3 = 0;
      aVent4 = nVentEspera;
      aVent5 = "MODELESS";
      |ESPECIFICA "ESTADO_VENTANA", aVent;

      |FINVENTANA nVentEspera;
      |DESTRUYECONTROL nGrid1;

      |ABRE #RfActual@; |ABRE #RfAnter1@;
      |ABRE #RfAnter2@; |ABRE #RfAnter3@;
      |ABRE #RfAnter4@; |ABRE #RfAnter5@;

      nRango = 2 + 4 + 8 + 16 + 32;
      nPos1  = 1002; nPos2  = 2998;

      |C_V #RfActual@#0, 1, "N"; |C_V #RfAnter1@#0, 1, "N";
      |C_V #RfAnter2@#0, 1, "N"; |C_V #RfAnter3@#0, 1, "N";
      |C_V #RfAnter4@#0, 1, "N"; |C_V #RfAnter5@#0, 1, "N";

      nAnyo = #finw0001#1;

      nPosa1 = 0902; nPosa2 = 0911;
      aAlfa = "BOTON,Saldo " + nAnyo;
      |CONTROL_SIMPLE nPant0, aAlfa, nPosa1, nPosa2, Pantalla1;
      nBoton1 = FSalida;
      |LINEAL_SIMPLE #1#RfActual@, nRango, nPos1, nPos2, NULL, NULL, EvtoGridAct;
      nGrid1 = FSalida;
      |ESTADO_CONTROL nGrid2, "SHOW";
      |ESTADO_CONTROL nBoton1, "DISABLE";

      nAnyo = nAnyo - 1;
      nPosa1 = 0912; nPosa2 = 0921;
      aAlfa = "BOTON,Saldo " + nAnyo;
      |CONTROL_SIMPLE nPant0, aAlfa, nPosa1, nPosa2, Pantalla2;
      nBoton2 = FSalida;
      |LINEAL_SIMPLE #1#RfAnter1@, nRango, nPos1, nPos2, NULL, NULL, EvtoGridAn1;
      nGrid2 = FSalida;
      |ESTADO_CONTROL nGrid2, "HIDE";
      |ESTADO_CONTROL nBoton2, "ENABLE";

      nAnyo = nAnyo - 1;
      nPosa1 = 0922; nPosa2 = 0931;
      aAlfa = "BOTON,Saldo " + nAnyo;
      |CONTROL_SIMPLE nPant0, aAlfa, nPosa1, nPosa2, Pantalla3;
      nBoton3 = FSalida;
      |LINEAL_SIMPLE #1#RfAnter2@, nRango, nPos1, nPos2, NULL, NULL, EvtoGridAn2;
      nGrid3 = FSalida;
      |ESTADO_CONTROL nGrid3, "HIDE";
      |ESTADO_CONTROL nBoton3, "ENABLE";

      nAnyo = nAnyo - 1;
      nPosa1 = 0932; nPosa2 = 0941;
      aAlfa = "BOTON,Saldo " + nAnyo;
      |CONTROL_SIMPLE nPant0, aAlfa, nPosa1, nPosa2, Pantalla4;
      nBoton4 = FSalida;
      |LINEAL_SIMPLE #1#RfAnter3@, nRango, nPos1, nPos2, NULL, NULL, EvtoGridAn3;
      nGrid4 = FSalida;
      |ESTADO_CONTROL nGrid4, "HIDE";
      |ESTADO_CONTROL nBoton4, "ENABLE";

      nAnyo = nAnyo - 1;
      nPosa1 = 0942; nPosa2 = 0951;
      aAlfa = "BOTON,Saldo " + nAnyo;
      |CONTROL_SIMPLE nPant0, aAlfa, nPosa1, nPosa2, Pantalla5;
      nBoton5 = FSalida;
      |LINEAL_SIMPLE #1#RfAnter4@, nRango, nPos1, nPos2, NULL, NULL, EvtoGridAn4;
      nGrid5 = FSalida;
      |ESTADO_CONTROL nGrid5, "HIDE";
      |ESTADO_CONTROL nBoton5, "ENABLE";

      nAnyo = nAnyo - 1;
      nPosa1 = 0952; nPosa2 = 0961;
      aAlfa = "BOTON,Saldo " + nAnyo;
      |CONTROL_SIMPLE nPant0, aAlfa, nPosa1, nPosa2, Pantalla6;
      nBoton6 = FSalida;
      |LINEAL_SIMPLE #1#RfAnter5@, nRango, nPos1, nPos2, NULL, NULL, EvtoGridAn5;
      nGrid6 = FSalida;
      |ESTADO_CONTROL nGrid6, "HIDE";
      |ESTADO_CONTROL nBoton6, "ENABLE";
      |PULSATECLA;

      aEsc1  = &255 + "806";
      aEsc2  = &255 + "807";
      aRetu  = &255 + "802";
      |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nGrid1;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL; |FINSI;
         |SI aTecla = aEsc2; |SAL; |FINSI;
         |SI aTecla = aRetu; |SAL; |FINSI;
      |SIGUE;

      |DESTRUYECONTROL nGrid1;
      |DESTRUYECONTROL nGrid2;
      |DESTRUYECONTROL nGrid3;
      ||DESTRUYECONTROL nGrid4;
      ||DESTRUYECONTROL nGrid5;
      ||DESTRUYECONTROL nGrid6;

      |FIN_CONTROL_WINDOWS nBoton1;
      |FIN_CONTROL_WINDOWS nBoton2;
      |FIN_CONTROL_WINDOWS nBoton3;
      ||FIN_CONTROL_WINDOWS nBoton4;
      ||FIN_CONTROL_WINDOWS nBoton5;
      ||FIN_CONTROL_WINDOWS nBoton6;

      |CIERRA #RfAnter5@; |DESCARGA_DEF #RfAnter5@;
      |CIERRA #RfAnter4@; |DESCARGA_DEF #RfAnter4@;
      |CIERRA #RfAnter3@; |DESCARGA_DEF #RfAnter3@;
      |CIERRA #RfAnter2@; |DESCARGA_DEF #RfAnter2@;
      |CIERRA #RfAnter1@; |DESCARGA_DEF #RfAnter1@;
      |CIERRA #RfActual@; |DESCARGA_DEF #RfActual@;
   |FINSI;
|FPRO;
