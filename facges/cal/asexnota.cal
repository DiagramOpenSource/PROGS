|FICHEROS;
   asexnota #0;
   asexpeli #1;
   asexnoin #2;
   asexpeca #3;
|FIN;

|VARIABLES;
    sw       = 0;
    conta    = 0;
    sw_index = 0;
    pepe     = 0;
    expedi   = 0;
    error2   = "    ATENCION fecha erronea";

    &vacio   = "                                        ";

    fecha    = "";
    fecha1   = "";
    fecha2   = "";
    fecha_d  = "";
    fecha_l  = "";
    fecha_h  = "";

    valtra   = 0;
    varalfa  = "";
    varalfa1 = "";
    varalfa2 = "";
    vardia   = 0;
    varmes   = 0;

    {-1}menu = "";
        menu1 = "2400";
        menu2 = "1";
        menu3 = " Elija Opcion : ";
        menu4 = "PI";
        menu5 = "  Pantalla  ";
        menu6 = "  Impresora  ";
     fFech = @;
     qFech = "";
     dFech = "";
     hFech = "";
|FIN;

|PROCESO imprimir;
|SI sw = 0;
   expedi = #2#0;
   conta = #2#12;
   sw = 1;
|FINSI;

|SI expedi ! #2#0;|O conta ! #2#12;
    |SI menu2 = 2; |PIEINF; |FINSI;
    |SI menu2 = 1; |MENAV "      Fin Expediente."; |FINSI;
    expedi = #2#0;
    conta = #2#12;
|FINSI;

|SI menu2 = 2; |PRINT; |FINSI;
|SI menu2 = 1; |PINDA #0#2; |PAUSA; |FINSI;
|FPRC;

|PROCESO indexa;
#3#0 = #1#0;
#3#14 = #1#16;
|LEE 040#3=;
|SI FSalida ! 0; |DDEFECTO #3; |FINSI;

#2#0 = #1#0;
#2#1 = #1#1;
#2#2 = #1#2;
#2#3 = #1#4;
#2#4 = #1#5;
#2#5 = #1#17;
#2#6 = #1#6;
#2#7 = #1#7;
#2#8 = #1#8;
#2#9 = #1#9;
#2#10 = #3#13;
#2#11 = #3#2;
#2#12 = #1#16;
sw_index = 1;
|GRABA 140#2n;
|LIBERA #2;
|FPRC;

|DEFBUCLE asexpeli;
#1#1;
1, 17, 10;
#0#0, #0#6, 001, #0#2, #0#4, "N";
#0#1, #0#7, 999, #0#3, #0#5, "N";
e;
NULL,indexa;
|FIN;

|DEFBUCLE asexnoin;
#2#1;
1;
#0#0, #0#6, 001, #0#2;
#0#1, #0#7, 999, #0#3;
e;
NULL,imprimir;
|FIN;

|PROCESO impre; |TIPO 3;
|MENU menu;
menu2 = FSalida;

|SI FSalida = 1; |HAZ pantalla;  |FINSI;
|SI FSalida = 2; |HAZ impresora; |FINSI;
|FPRC;

|PROCESO impresora;
|IMPRE 0;
|SI FSalida ! 0; |ACABA; |FINSI;

|INFOR "asexnota";
|SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;

|ABRE #2; |CIERRA #2; |DELINDEX #2;

sw_index = 0;

|ABRE #2;
|ABRE #3;

|BUCLE asexpeli;

|CIERRA #2;
|CIERRA #3;

|SI sw_index = 1;
    |BUCLE asexnoin;
    |PIEINF;
|FINSI;

|DELINDEX #2;
|FININF;
|FINIMP;
|FPRC;

|RUTINA min;
#2#0  = #0#0;
#2#12 = #0#6;
#2#2  = 000;
|FRUT;

|RUTINA max;
#2#0  = #0#1;
#2#12 = #0#7;
#2#2  = 999;
|FRUT;

|PROCESO pantalla;
|ABRE #2; |CIERRA #2; |DELINDEX #2;

sw_index = 0;
|ABRE #2;
|ABRE #3;

|PINPA #0#2;
|BUCLE asexpeli;

|CIERRA #2;
|CIERRA #3;

|SI sw_index = 1;
    |ENTLINEAL #1#2, 3, 4, 20, 0, min, max;
|FINSI;

|DELINDEX #2;
|FPRC;
|PROCESO sacaano; |TIPO 7;
     fFech = ~;
     qFech = fFech % -104;
     dFech = "01.01." + qFech;
     hFech = "31.12." + qFech;
     #0#4  = dFech;
     #0#5  = hFech;
     |PINTA #0#4;
     |PINTA #0#5;
|FPRC;
