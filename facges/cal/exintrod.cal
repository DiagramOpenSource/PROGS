|FICHEROS;
    exintrod #0;
    extramit #1,MANTE;    || tramites
    extribun #3;    || tribunales
    exletrad #4;    || letrados
    asclient #5;    || clientes
    exprocur #6;    || procuradores
    excontra #7;    || contrarios
    asconcep #8;    || conceptos
    exasunto #9;    || asuntos
    extextam #10;   || texto ampliado
    ascontro #55;   || Control

    exconsul #50,MANTE;  || consulta expedientes

    ascabmin #20;   || Minutas (Cab)
    aslinmin #21;   || Minutas (Lin)
|FIN;

|VARIABLES;
    Linea   = 0;
    Primero = 0;
    ModoEntrada = 0;
    Comodin = "";

    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;
    inkey = 0;

{-1}menu   = "";
    menu1  = "0730";
    menu2  = "1";
    menu3  = "10";
    menu4  = "Por clientes.";
    menu5  = "Por asuntos.";
    menu6  = "Por tribunales.";
    menu7  = "Por letrados.";
    menu8  = "Por procuradores.";
    menu9  = "Por contrarios.";
    menu10 = "Por letr.Contrarios.";
    menu11 = "Por proc.Contrarios.";
    menu12 = "Por tipo + codigo ";
    menu13 = "Directo.";
    opcion = 0;

    ultimo = 0;
    tempo1 = "";
    nomed1 = "";
    aMensaje = "";
    nSwVentana = 0;
    nULinea = 0;
    aFecha = "";
    aDia = "";
    aMes = "";
    aDiaMes = "";
    aTexto1 = "";
    aTexto2 = "";
    aTexto3 = "";
    aDatos = "";
    aLong = "";
    nLong = 0;
    aTipo = "";
    nIva = 0;
|FIN;
____________________________________/ PROCESOS DE CONSULTA
|PROCESO relacion;
|PUSHV 0501 2380;
|SI opcion = 1;               || clientes
    |ABRE #5;
    |PINPA #0#5;
    |PINDA #0#5;
    |CONSULTA #1#5;
    |SI FSalida = 0;     #50#0 = #5#0;  |FINSI;
    |CIERRA #5;
|FINSI;
|SI opcion = 2;               || asuntos
    |ABRE #9;
    |PINPA #0#9;
    |PINDA #0#9;
    |CONSULTA #1#9;
    |SI FSalida = 0;     #50#2 = #9#0;  |FINSI;
    |CIERRA #9;
|FINSI;
|SI opcion = 3;               || tribunales
    |ABRE #3;
    |PINPA #0#3;
    |PINDA #0#3;
    |CONSULTA #1#3;
    |SI FSalida = 0;     #50#1 = #3#0;  |FINSI;
    |CIERRA #3;
|FINSI;
|SI opcion = 4;|O opcion = 7; || letrados
    |ABRE #4;
    |PINPA #0#4;
    |PINDA #0#4;
    |CONSULTA #1#4;
    |SI FSalida = 0;     #50#0 = #4#0;  |FINSI;
    |CIERRA #4;
|FINSI;
|SI opcion = 5;|O opcion = 8; || procuradores
    |ABRE #6;
    |PINPA #0#6;
    |PINDA #0#6;
    |CONSULTA #1#6;
    |SI FSalida = 0;     #50#0 = #6#0;  |FINSI;
    |CIERRA #6;
|FINSI;
|SI opcion = 6;               || contrarios
    |ABRE #7;
    |PINPA #0#7;
    |PINDA #0#7;
    |CONSULTA #1#7;
    |SI FSalida = 0;     #50#0 = #7#0;  |FINSI;
    |CIERRA #7;
|FINSI;
|POPV;
|FPRC;

|PROCESO selec50; |TIPO 0;
|SI inkey = 9; inkey = 0;     |ACABA;   |FINSI;
    inkey = FSalida;
|SI inkey = 0;
        #0#0 = #50#4;
        #0#33 = #50#8;
    |ERROR;
    |PTEC 802; |PTEC 802;
    |PTEC 806;
|SINO;
    |SI inkey = 9;
        |HAZ relacion;
        |ERROR;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO lee_todo;
|SI opcion = 1;
    |DDEFECTO #5;  #5#0 = #0#3;              |LEE 000#5=;   || cliente
|FINSI;
|SI opcion = 3;
    |DDEFECTO #3;  #3#0 = #0#6;              |LEE 000#3=;   || tribunal
|FINSI;
|SI opcion = 4;
    |DDEFECTO #4;  #4#0 = #0#2;              |LEE 000#4=;   || letrado
|FINSI;
|SI opcion = 5;
    |DDEFECTO #6;  #6#0 = #0#4;              |LEE 000#6=;   || procurador
|FINSI;
|SI opcion = 6;
    |DDEFECTO #7;  #7#0 = #0#5;              |LEE 000#7=;   || contrario
|FINSI;
|SI opcion = 7;
    |DDEFECTO #4;  #4#0 = #0#29;             |LEE 000#4=;   || letrado con.
|FINSI;
|SI opcion = 8;
    |DDEFECTO #6;  #6#0 = #0#30;             |LEE 000#6=;   || procurador con.
|FINSI;
|FPRC;

|PROCESO lee_expe1;
|HAZ lee_todo;
|DDEFECTO #50;
|SI opcion = 1;     #50#0 = #0#3;  #50#3 = #5#1;  |FINSI;   || clientes (N5)
|SI opcion = 2;     #50#2 = #0#31; #50#3 = #0#32; |FINSI;   || asuntos (A2)
|SI opcion = 3;     #50#1 = #0#6;  #50#3 = #3#1;  |FINSI;   || tribunales (N3)
|SI opcion = 4;     #50#0 = #0#2;  #50#3 = #4#1;  |FINSI;   || letrados (N5)
|SI opcion = 5;     #50#0 = #0#4;  #50#3 = #6#1;  |FINSI;   || procurad. (N5)
|SI opcion = 6;     #50#0 = #0#5;  #50#3 = #7#1;  |FINSI;   || contrarios (N5)
|SI opcion = 7;     #50#0 = #0#29; #50#3 = #4#1;  |FINSI;   || letr.con. (N5)
|SI opcion = 8;     #50#0 = #0#30; #50#3 = #6#1;  |FINSI;   || proc.con. (N5)
|SI opcion = 9;     #50#0 = #0#0;  #50#2 = #0#33; |FINSI;   || Tipo+Codigo (A2+N5)
    #50#4 = #0#0;        || cod.exped.
    #50#5 = #0#1;        || fecha
    #50#6 = #0#12;       || cerrado S/N
    #50#7 = #0#26;       || minutado S/N
    #50#8 = #0#33;       || Cod.Exped.
|GRABA 020#50n;
|FPRC;

|DEFBUCLE lee_expe;
 #0#1;
 ;
     1,"  ";
 99999,"zz";
 ;
 NULL, lee_expe1;
|FIN;

|PROCESO actuacon;
|ATRI P;   |MENSA "2400Actualizando pantalla de consulta ...";  |ATRI 0;
|DELINDEX #50;
|ABRE #3;
|ABRE #4;
|ABRE #5;
|ABRE #6;
|ABRE #7;
|ABRE #50;
|BUCLE lee_expe;
|CIERRA #3;
|CIERRA #4;
|CIERRA #5;
|CIERRA #6;
|CIERRA #7;
|CIERRA #50;
|BLIN 24;
|FPRC;

|PROCESO min50;
    #50#0 = 0;
    #50#1 = 0;
    #50#2 = "  ";
    #50#4 = 1;
    #50#8 = "  ";
|FPRC;

|PROCESO max50;
    #50#0 = 99999;
    #50#1 = 999;
    #50#2 = "zz";
    #50#4 = 99999;
    #50#8 = "zz";
|FPRC;

|PROCESO consulta;
|PUSHV 0501 2380;
|ATRI R;
|MENSA "    Elija el modo de consulta ...";
|ATRI 0;
|MENUG menu;
    opcion = FSalida;
    menu2 = opcion;
|SI opcion ] 1;|Y opcion [ 9;
    |BLIN 4;
    |HAZ actuacon;
    |PINPA #0#50;
    |ATRI R;
    |SI opcion = 1; |PINTA 0906, "Clientes    "; |FINSI;
    |SI opcion = 2; |PINTA 0906, "Asuntos     "; |FINSI;
    |SI opcion = 3; |PINTA 0906, "Tribunales  "; |FINSI;
    |SI opcion = 4; |PINTA 0906, "Letrados    "; |FINSI;
    |SI opcion = 5; |PINTA 0906, "Procuradores"; |FINSI;
    |SI opcion = 6; |PINTA 0906, "Contrarios  "; |FINSI;
    |SI opcion = 7; |PINTA 0906, "Letr.Contra."; |FINSI;
    |SI opcion = 8; |PINTA 0906, "Proc.Contra."; |FINSI;
    |SI opcion = 9; |PINTA 0906, "Tipo+Codigo "; |FINSI;
    |ATRI 0;
    |SI opcion ! 9;
       |CUADRO 1007 2207;
       |CUADRO 1015 2215;
       |C_P #50#0,1,1006; |C_P #50#2,1,1016;
    |SINO;
       |CUADRO 1007 2207;
       |CUADRO 1010 2210;
       |C_P #50#0,1,1009; |C_P #50#2,1,1006;
    |FINSI;
    |SI opcion ! 2; |Y opcion ! 3; |Y opcion ! 9;
        |C_M #50#0, 1, "S";   |C_V #50#0, 1, "S";
        |C_M #50#1, 1, "N";   |C_V #50#1, 1, "N";
        |C_M #50#2, 1, "N";   |C_V #50#2, 1, "N";
        |ENTLINEAL #1#50, 1, 4, 22, 0, min50, max50;
    |FINSI;
    |SI opcion = 2;
        |C_M #50#0, 1, "N";   |C_V #50#0, 1, "N";
        |C_M #50#1, 1, "N";   |C_V #50#1, 1, "N";
        |C_M #50#2, 1, "S";   |C_V #50#2, 1, "S";
        |ENTLINEAL #1#50, 3, 4, 22, 0, min50, max50;
    |FINSI;
    |SI opcion = 3;
        |C_M #50#0, 1, "N";   |C_V #50#0, 1, "N";
        |C_M #50#1, 1, "S";   |C_V #50#1, 1, "S";
        |C_M #50#2, 1, "N";   |C_V #50#2, 1, "N";
        |ENTLINEAL #1#50, 2, 4, 22, 0, min50, max50;
    |FINSI;
    |SI opcion = 9;
        |C_M #50#0, 1, "S";   |C_V #50#0, 1, "S";
        |C_M #50#1, 1, "N";   |C_V #50#1, 1, "N";
        |C_M #50#2, 1, "S";   |C_V #50#2, 1, "S";
        |ENTLINEAL #2#50, 2, 4, 22, 0, min50, max50;
    |FINSI;
|FINSI;
|POPV;
|FPRC;
____________________________________/ DESDE PANTALLA PRINCIPAL
|PROCESO tipo8; |TIPO 8;
|DFICE alfa1;
|TEMPO tempo1; nomed1 = tempo1 - alfa1; |NOME_DAT #50 nomed1;
|HAZ Inicializa;
|FPRC;

|PROCESO tipo9; |TIPO 9;
|FBORRA tempo1;
|DELINDEX #50;
|FPRC;

|PROCESO tipo7; |TIPO 7;
    modo = (FEntrada / 100) ! 0;
|SI modo = 1;
    |LEE 000#0u;
    |SI FSalida = 0;
            ultimo = #0#0 + 1;
    |SINO;
            ultimo = 1;
    |FINSI;
    |DDEFECTO #0;
        #0#0 = ultimo;
    |PINTA #0#0;
|FINSI;
|SI modo = 4;
    |HAZ consulta;
|FINSI;
|FPRC;

|PROCESO sientra; |TIPO 7;
    modo = (FEntrada / 100) ! 0;
|SI modo = 4;
    |C_M #0Campo, 1, "S";
|SINO;
    |C_M #0Campo, 1, "N";
|FINSI;
|FPRC;

|PROCESO tipo2; |TIPO 2;
    modo = (FEntrada / 100) ! 0;
|SI modo = 2;
        elsw1 = 0 +. 1;
    |SI #0#12 = "S";|Y elsw1 = -1;
        |MENAV "    Expediente YA cerrado ...";
        |ERROR;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO expedientes2;
    seleccio = 1;
|PRINT;
|FPRC;

|PROCESO expedientes1;
    seleccio = 0;
|INFOR "exinfor1";
|DDEFECTO #3;  #3#0 = #0#6;                  |LEE 000#3=;   || tribunal
|DDEFECTO #4;  #4#0 = #0#2;                  |LEE 000#4=;   || letrado
|DDEFECTO #5;  #5#0 = #0#3;                  |LEE 000#5=;   || cliente
|DDEFECTO #6;  #6#0 = #0#4;                  |LEE 000#6=;   || procurador
|DDEFECTO #7;  #7#0 = #0#5;                  |LEE 000#7=;   || contrario
|DDEFECTO #8;  #8#0 = #0#10;  #8#1 = #0#11;  |LEE 000#8=;   || seccion/cto.
|BUCLELIN 2expedientes2#0;
|SI seleccio = 0;
    |PRINT;         || (por si no hay lineas)
|FINSI;
|PIEINF;
|FININF;
|FPRC;

|PROCESO tipo4; |TIPO 4;
|IMPRE 0;
|SI FSalida = 0;
    |ABRE #3;
    |ABRE #4;
    |ABRE #5;
    |ABRE #6;
    |ABRE #7;
    |ABRE #8;
    |HAZ expedientes1;
    |CIERRA #3;
    |CIERRA #4;
    |CIERRA #5;
    |CIERRA #6;
    |CIERRA #7;
    |CIERRA #8;
|SINO;
    |MENAV "    Proceso abortado ...";
|FINSI;
|FINIMP;
|FPRC;
____________________________________/
|PROCESO hora; |TIPO 0;
    nume1 = #1#5 $ 100;
|SI nume1 > 59;
    |MENAV "    Formato: HHMM ...";
    |ERROR;
|FINSI;
|FPRC;

|PROCESO Minuta; |TIPO 11;
     |SI FSalida = 11;
          |SI #extramit#12 = "N";
               |HAZ CamposMinuta;
          |SINO;
               aMensaje = "0000Error: Esta linea fue minutada anteriormente";
               |MENAV aMensaje;
               |HAZ Ventana;
          |FINSI;
     |SINO;
          |HAZ Ventana;
     |FINSI;
|FPRC;

|PROCESO CamposMinuta;
     |PUSHV 0501 2380;
     |BLANCO 0546 1178;
     |CUADRO 0546 1178;

     |PINTA 0648, "Tipo Fact.:";
     |PINTA 0748, "Seccion ..:";
     |PINTA 0848, "Concepto..:";
     |PINTA 0948, "Cuantia...:";
     |PINTA 1048, "Texto ampliado en minuta : ";
     |C_V #extramit#8, 1, "S";
     |C_V #extramit#9, 1, "S";
     |C_V #extramit#10, 1, "S";
     |C_V #extramit#11, 1, "S";
     |C_V #extramit#16, 1, "S";
     |C_M #extramit#8, 1, "S";
     |C_M #extramit#9, 1, "S";
     |C_M #extramit#10, 1, "S";
     |C_M #extramit#11, 1, "S";
     |C_M #extramit#16, 1, "S";
     |PINTA #extramit#8;
     |PINTA #extramit#9;
     |PINTA #extramit#10;
     |PINTA #extramit#11;
     |PINTA #extramit#16;
     nSwVentana = 1;
|FPRCM

|PROCESO Ventana;
     |SI nSwVentana = 1;
          nSwVentana = 0;
          |C_M #extramit#8, 1, "N";
          |C_M #extramit#9, 1, "N";
          |C_M #extramit#10, 1, "N";
          |C_M #extramit#11, 1, "N";
          |C_M #extramit#16, 1, "N";
          |C_V #extramit#8, 1, "N";
          |C_V #extramit#9, 1, "N";
          |C_V #extramit#10, 1, "N";
          |C_V #extramit#11, 1, "N";
          |C_V #extramit#16, 1, "N";
          |POPV;
     |FINSI;
|FPRC;

|PROCESO Seguro; |TIPO  0;
     |SI #extramit#12 = "N"; |Y nSwVentana = 1;
          |CONFI "00000Seguro que desea minutar la Linea seleccionada?";
          |SI FSalida = 0;
               |HAZ Minutacion;
               #extramit#12 = "S";
               |PINTA #extramit#12;
          |FINSI;
     |FINSI;
     |HAZ Ventana;
|FPRC;

|PROCESO VuelcaTextoAmp;
     |SI Primero = 0; Primero = 1; |ACABA; |FINSI;
     Linea = Linea + 1; |SI Linea = 4; Linea = 1; |FINSI;

     |SI Linea = 1;
        nULinea = nULinea + 5;
        |DDEFECTO #aslinmin;
        #aslinmin#0 = #extramit#8;
        #aslinmin#1 = #exintrod#3;
        #aslinmin#2 = nULinea;
        |LEE 101#aslinmin.=;
        |SI FSalida ! 0; |GRABA 020#aslinmin.b; |FINSI;
        #aslinmin#3 = 0;
        #aslinmin#4 = "";
        #aslinmin#5 = "";
        #aslinmin#6 = #extextam#4;
        #aslinmin#7 = #extextam#4;
        #aslinmin#8 = "";
        #aslinmin#9 = "";
        #aslinmin#10 = aTipo;
        #aslinmin#11 = 0;
        #aslinmin#12 = 0;
        #aslinmin#13 = 0;
        #aslinmin#15 = #extramit#4;
     |FINSI;
     |SI Linea = 2;
        #aslinmin#0 = #extramit#8;
        #aslinmin#1 = #exintrod#3;
        #aslinmin#2 = nULinea;
        |LEE 101#aslinmin.=;
        |SI FSalida = 0;
           #aslinmin#8 = #extextam#4;
        |FINSI;
     |FINSI;
     |SI Linea = 3;
        #aslinmin#0 = #extramit#8;
        #aslinmin#1 = #exintrod#3;
        #aslinmin#2 = nULinea;
        |LEE 101#aslinmin.=;
        |SI FSalida = 0;
           #aslinmin#9 = #extextam#4;
        |FINSI;
     |FINSI;
     |GRABA 020#aslinmin.a; |LIBERA #aslinmin;
|FPRC;

|DEFBUCLE VuelcaTextoAmp;
#extextam#1;
;
#extramit#0,#extramit#15,#extramit#1,001;
#extramit#0,#extramit#15,#extramit#1,999;
;
NULL,VuelcaTextoAmp;
|FIN;

|PROCESO Minutacion;
     |ABRE #asconcep;
     #asconcep#0 = #extramit#10;
     #asconcep#1 = #extramit#11;
     |LEE 000#asconcep.=;
     |SI FSalida = 0;
          aTipo = #asconcep#3;
     |SINO;
          aTipo = "H";
     |FINSI;
     |CIERRA #asconcep;

     |ABRE #ascabmin;
     #ascabmin#0 = #extramit#8;
     #ascabmin#1 = #exintrod#3;
     |LEE 101#ascabmin.=;
     |SI FSalida ! 0;
          ||TODO CCC
          ||Faltan los datos de la cabecera de la minuta.
          |ABRE #asclient;
          |LEE 000#asclient.=;
          |SI FSalida = 0;
               |DDEFECTO #ascabmin;
               #ascabmin#0 = #extramit#8;
               #ascabmin#1 = #exintrod#3;
               #ascabmin#2 = #asclient#1;    ||Razon Social
               #ascabmin#3 = #asclient#2;    ||nombre Cliente
               #ascabmin#4 = #asclient#3;    ||Direccion
               #ascabmin#5 = #asclient#4;    ||Cod. Postal 1
               #ascabmin#6 = #asclient#5;    ||Cod. Postal 2
               #ascabmin#7 = #asclient#6;    ||Poblacion
               #ascabmin#8 = #asclient#7;    ||Provincia
               #ascabmin#9 = #asclient#8;    ||CIF
               #ascabmin#10 = #asclient#15;  ||Forma de Pago
               #ascabmin#11 = #asclient#16;  ||Banco a Remesar
               #ascabmin#12 = #asclient#17;  ||Ret. IRPF
               #ascabmin#13 = #asclient#11;  ||Banco
               #ascabmin#14 = #asclient#12;  ||Dir. Banco
               #ascabmin#15 = #asclient#13;  ||Forma de Pago
               #ascabmin#16 = #asclient#14;  ||Forma de Pago

               ||TODO CCC
               ||Segun el la secc/cto --> Tipo
               |SI aTipo = "H";
                   #ascabmin#17 = #ascabmin#17 + #extramit#9;
               |FINSI;
               |SI aTipo = "S";
                   #ascabmin#18 = #ascabmin#18 + #extramit#9;
               |FINSI;
               |SI aTipo = "A";
                   #ascabmin#19 = #ascabmin#19 + #extramit#9;
               |FINSI;
               ||#ascabmin#20 = 00;       ||Valor por defecto
               |HAZ iva;
               #ascabmin#21 = #ascabmin#17 % #ascabmin#20;
               #ascabmin#22 = #ascabmin#17 - #ascabmin#21;
               #ascabmin#23 = #ascabmin#22 % nIva;
               #ascabmin#24 = #ascabmin#22 + #ascabmin#23 + #ascabmin#18;
               |SI #ascabmin#12 = "S";
                   #ascabmin#25 = #ascabmin#22 % #5#31;
               |SINO;
                   #ascabmin#25 = 0;
               |FINSI;
               #ascabmin#26 = #ascabmin#24 - #ascabmin#25 - #ascabmin#19;
          |FINSI;
          |CIERRA #asclient;
          |GRABA 020#ascabmin.b;
     |SINO;
          ||TODO CCC
          ||Segun el la secc/cto --> Tipo
          |SI aTipo = "H";
              #ascabmin#17 = #ascabmin#17 + #extramit#9;
          |FINSI;
          |SI aTipo = "S";
              #ascabmin#18 = #ascabmin#18 + #extramit#9;
          |FINSI;
          |SI aTipo = "A";
              #ascabmin#19 = #ascabmin#19 + #extramit#9;
          |FINSI;
          ||#ascabmin#20 = 00;       ||Valor por defecto
          |HAZ iva;
          #ascabmin#21 = #ascabmin#17 % #ascabmin#20;
          #ascabmin#22 = #ascabmin#17 - #ascabmin#21;
          #ascabmin#23 = #ascabmin#22 % nIva;
          #ascabmin#24 = #ascabmin#22 + #ascabmin#23 + #ascabmin#18;
          |SI #ascabmin#12 = "S";
              #ascabmin#25 = #ascabmin#22 % #5#31;
          |SINO;
              #ascabmin#25 = 0;
          |FINSI;
          #ascabmin#26 = #ascabmin#24 - #ascabmin#25 - #ascabmin#19;
     |FINSI;
     |SI #extramit#16 = "S";
        |ABRE #extextam;
        |ABRE #aslinmin;
        #extextam#0 = #extramit#0;
        #extextam#1 = #extramit#15;
        #extextam#2 = #extramit#1;
        #extextam#3 = 1;
        |LEE 000#extextam.];
        |SI FSalida = 0; |Y #extextam#0 = #extramit#0; |Y #extextam#1 = #extramit#15;
         |Y #extextam#2 = #extramit#1;
           aTexto1 = #extextam#4; |HAZ LineaMin;
        |FINSI;
        |CIERRA #extextam;
        Linea = 1; Primero = 0;|BUCLE VuelcaTextoAmp;
        |CIERRA #aslinmin;
     |SINO;
        aTexto1 = ""; |HAZ LineaMin;
     |FINSI;
     |GRABA 020#ascabmin.a;
     |LIBERA #ascabmin;
     |CIERRA #ascabmin;
|FPRC;

|PROCESO LineaMin;
     |ABRE #aslinmin;
     #aslinmin#0 = #extramit#8;
     #aslinmin#1 = #exintrod#3;
     #aslinmin#2 = 999;
     |LEE 000#aslinmin.];
     |SI FSalida = 0;
           |LEE 000#aslinmin.a;
     |SINO;
           |LEE 000#aslinmin.u;
     |FINSI;
     |SI FSalida = 0; |Y #aslinmin#0 = #extramit#8; |Y #aslinmin#1 = #exintrod#3;
          nULinea = #aslinmin#2 + 5;
     |SINO;
          nULinea = 5;
     |FINSI;

     aFecha = #extramit#4;
     aDia = aFecha % 102;
     aMes = aFecha % 402;
     aDiaMes = aDia + aMes;
     aTexto1 = #extramit#2 % 140;
     aTexto2 = "";
     aTexto3 = "";
     aDatos = #extramit#2;
     |QBF aDatos;
     aLong = aDatos % A0;
     nLong = aLong;
     |SI nLong > 40;
          aTexto2 = #extramit#2 % 4130;
     |FINSI;

     |DDEFECTO #aslinmin;
     #aslinmin#0 = #extramit#8;
     #aslinmin#1 = #exintrod#3;
     #aslinmin#2 = nULinea;
     |LEE 101#aslinmin.=;
     |SI FSalida ! 0; |GRABA 020#aslinmin.b; |FINSI;
     #aslinmin#3 = aDiaMes;
     #aslinmin#4 = #extramit#10;
     #aslinmin#5 = #extramit#11;
     #aslinmin#6 = aTexto1;
     #aslinmin#7 = aTexto1;
     #aslinmin#8 = aTexto2;
     #aslinmin#9 = aTexto3;
     #aslinmin#10 = aTipo;
     #aslinmin#11 = 1;
     #aslinmin#12 = #extramit#9;
     #aslinmin#13 = #extramit#9;
     #aslinmin#15 = #extramit#4;

     |GRABA 020#aslinmin.a;
     |CIERRA #aslinmin;
|FPRC;

|CALCULO iva;
     |ABRE #55;
     |LEE 040#55p;
     |SI FSalida ! 0; |DDEFECTO #55; |FINSI;
     |CIERRA #55;
     nIva = 0;
     |SI #ascabmin#0 = 0; nIva = #55#21; |FINSI;
     |SI #ascabmin#0 = 1; nIva = #55#22; |FINSI;
     |SI #ascabmin#0 = 2; nIva = #55#23; |FINSI;
     |SI #ascabmin#0 = 3; nIva = #55#24; |FINSI;
     |SI #ascabmin#0 = 4; nIva = #55#25; |FINSI;
     |SI #ascabmin#0 = 5; nIva = #55#26; |FINSI;
     |SI #ascabmin#0 = 6; nIva = #55#27; |FINSI;
     |SI #ascabmin#0 = 7; nIva = #55#28; |FINSI;
     |SI #ascabmin#0 = 8; nIva = #55#29; |FINSI;
     |SI #ascabmin#0 = 9; nIva = #55#30; |FINSI;
|FCAL;

|PROCESO Inicializa;
     |C_M #extramit#8, 1, "N";
     |C_M #extramit#9, 1, "N";
     |C_M #extramit#10, 1, "N";
     |C_M #extramit#11, 1, "N";
     |C_M #extramit#16, 1, "N";
     |C_V #extramit#8, 1, "N";
     |C_V #extramit#9, 1, "N";
     |C_V #extramit#10, 1, "N";
     |C_V #extramit#11, 1, "N";
     |C_V #extramit#16, 1, "N";
|FPRC;

|PROCESO TextoAmpliado;
   Comodin = "extextam.tab;" + (("00000" + #extramit#0) % -105) + ",";
   Comodin = Comodin + #extramit#15 + "," + (("000" + #extramit#1) % -103);
   |SUB_EJECUTA_NP Comodin;
|FPRC;

|PROCESO BajaTexto;
   |BORRA 020#extextam.a;
|FPRC;

|DEFBUCLE BajaTexto;
#extextam#1;
;
#extramit#0,#extramit#15,#extramit#1,001;
#extramit#0,#extramit#15,#extramit#1,999;
be;
NULL,BajaTexto;
|FIN;

|PROCESO Baja; |TIPO 1;
   ModoEntrada = (FEntrada / 100) ! 0;
   |SI ModoEntrada = 3; |BUCLE BajaTexto; |FINSI;
|FPRC;
