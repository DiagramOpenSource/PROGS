|FICHEROS;
     ashisfac #0;                         ||CALCULO DESDE-HASTA PARA INFORMES;
     asinfhds #1;
     asclient #2;
|FIN;

|VARIABLES;
     informe = "asinfhds";
     men1 = "     NO EXISTE INFORME.";
     men2 = "     NO EXISTE IMPRESORA.";
     men3 = "     NO SE PUDIERON SELECCIONAR REGISTROS";
     sw1 = 0;                            ||CAMBIAR VARIABLE informe NOMBRE;
     sw2 = 0;                            ||DE FICHERO Y DE CALCULO.       ;
     &ordena = " ";
     serie = "Serie-Factura.";
     cliente = "Cliente.";
     fech = "Fecha.";
     fFech = @;
     qFech = "";
     dFech = "";
     hFech = "";

     aAlfa = "";

     nSwTr      = 0;
     &enSwTr     = 0;
     &efFechaTr = @;

     fFecha = @;
     fDFecha = @;
     fHFecha = @;
|FIN;

|CALCULO imprimir;
   #2#0 = #0#3;
   |LEE 040#2=;
   #2#7 = #2#7 ! 0;
   #2#9 = #2#9 ! 0;
   |PRINT;
|FCAL;

|DEFBUCLE cainfhdf2;          ||Por fecha
#0#2;
2;
#1#4,#1#0,#1#2,fDFecha;
#1#5,#1#1,#1#3,fHFecha;
e;
NULL,imprimir;
#0#3, #0#2, #0#0, #0#1;
|FIN;

|CALCULO impre;|TIPO 3;
aAlfa = "01.01." + #asinfhds#7; fDFecha = aAlfa;
aAlfa = "31.12." + #asinfhds#7; fHFecha = aAlfa;

|ABRE #2;
Impresora = "CrystalReports"; |IMPRE -1;
|SI FSalida ! 0;
    |MENAV men2;
    |VETE termina;
|FINSI;
|INFOR informe;
|SI FSalida ! 0;
    |MENAV men1;
    |FINIMP;
    |VETE termina;
|FINSI;
|HAZ clave;
|PIEINF;                      ||condicion salto pagina;
|FININF;                          ||cierra informe;
|FINIMP;
|ET termina;
|LIBERA #2;
|CIERRA #2;
|FCAL;                                   ||termina el calculo;


|CALCULO clave;
    |BUCLE cainfhdf2;
|FCAL;

|PROCESO sacaano; |TIPO 7;
     fFech = ~;
     qFech = fFech % -104;
     #1#7  = qFech;
     |PINTA #1#7;
|FPRC;
