|FICHEROS;
     aszp9999 #0;

     origen@  #800;
     destino@ #900;
|FIN;

|VARIABLES;
     aAlfa          = "";
     aPassword      = "";
     aPathPI        = "";
     aPathNOPI      = "";
     aPathFicPI     = "";
     aPathFicNOPI   = "";
     aDir           = "";
     aFic           = "";
     aMas           = "";
     aOrigen        = "";
     aDestino       = "";
     aFichero       = "";
     aQueQuiero     = "";

     nCampoHasta    = 0;
     nCampo         = 0;
|FIN;

|PROCESO GrabaFichero;
     #0#4 = aFic;   |PINTA #0#4;
     |PULSATECLA;

     aMas = aPathPI   + "def/" + aFic + ".mas";
     |CARGA_DEF aMas, origen@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PATH_DAT #800 aPathFicPI;
     |PATH_DAT #900 aPathFicNOPI;

     |ABRE #900;  |CIERRA #900;  |DELINDEX #900;

     #0#5 = 0;
     |ABRE #800;
     |ABRE #900;
     |LEE 000#800p;
     |PARA; |SI FSalida = 0;  |HACIENDO;
          #0#5 = #0#5 + 1;  |PINTA #0#5;
          |PARA nCampo = 0;  |SI nCampo [ nCampoHasta;  |HACIENDO nCampo = nCampo + 1;
                #900nCampo = #800nCampo;
          |SIGUE;

          |SI aFic = "asclient";
              #900#55 = #800#57;
              #900#56 = #800#74;
              #900#57 = #800#75;
          |FINSI;

          |GRABA 020#900n;
          |LIBERA #900;

          |LEE 000#800s;
     |SIGUE;

     |DESCARGA_DEF #origen@;
     |DESCARGA_DEF #destino@;

     |PULSATECLA;
     |PULSATECLA;
|FPRC;

|PROCESO Copiar;
     |SI aFichero = "asm00003.dat";  |ACABA;  |FINSI;

     aFic = aFichero - ".dat";
     aMas = aPathNOPI + "def/" + aFic + ".mas";
     |CARGA_DEF aMas, destino@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aQueQuiero  = "|NC";
     aAlfa       = #900#aQueQuiero#;
     nCampoHasta = aAlfa;
     nCampoHasta = nCampoHasta - 1;
     |HAZ GrabaFichero;
     |PULSATECLA;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;
     |SI #0#3 ! "SI";  |ACABA;  |FINSI;

     aPathPI = #0#2;  |QBF aPathPI;
     aAlfa   = aPathPI % -101;
     |SI aAlfa ! "/";  |O aAlfa ! "\";
         aPathPI = aPathPI + "/";
     |FINSI;

     |DBASE aPathNOPI;  |QBF aPathNOPI;

     aPathPI      = aPathPI   + "facturar/";
     aPathFicPI   = aPathPI   + "fich/" + (("00" + #0#0) % -102) + "/";
     aPathFicNOPI = aPathNOPI + "fich/" + (("00" + #0#0) % -102) + "/";

     aDir    = aPathFicPI + "*.dat";
     |_PDIR aDir;
     |PARA; |SI FSalida = 0; |HACIENDO;
            aFichero = aDir - aPathFicPI;
            |HAZ Copiar;

            |_SDIR aDir;
     |SIGUE;
|FPRC;

|PROGRAMA;
     |CUADRO 0501 2380;
     |BLANCO 0602 2279;
     |PINTA 1320, "Introduzca Password : ";
     E_inf = "";
     E_sup = "20";
     aPassword = 1342 ? -1;
     |SI aPassword ! "<MYPASWD>     ";
         |MENAV "     Permiso denegado.";
         |ACABA;
     |FINSI;

     |CLS;
     |CABEZA "Pase";

     #0#0 = #48#0;
     #0#1 = #48#1;

     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
|FPRO;
