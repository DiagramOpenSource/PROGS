|FICHEROS;
     asconcli #0;                         ||CALCULO DESDE-HASTA PARA INFORMES;
     asinfccl #1;
|FIN;

|VARIABLES;
     informe = "asinfccl";
     men1 = "    NO EXISTE INFORME.";
     men2 = "    NO EXISTE IMPRESORA.";
     sw1 = 0;
     sw2 = 0;
     &ordena = " ";
     cliente = "Cliente"
     seccion = "Seccion";
|FIN;

|CALCULO imprimir;
|PRINT;
|FCAL;

|DEFBUCLE cainfccl0;
 #0#1;
 ;
 #1#0, #1#2, #1#4;
 #1#1, #1#3, #1#5;
 e;
 NULL, imprimir;
|FIN;

|DEFBUCLE cainfccl1;
 #0#2;
 ;
 #1#2, #1#4, #1#0;
 #1#3, #1#5, #1#1;
 e;
 NULL, imprimir;
|FIN;

|CALCULO impre;|TIPO 3;
|IMPRE 0;                                ||Abre impresora;
|SI FSalida = 0;                         ||?existe impresora;
    |INFOR informe;                      ||Abre informe;
    |SI FSalida = 0;                     ||?existe informe;
       |HAZ clave;
           |PIEINF;                      ||condicion salto pagina;
       |FININF;                          ||cierra informe;
    |SINO;
       |MENAV men1;                      ||mensaje error informe;
    |FINSI;
    |FINIMP;                             ||cierra impresora;
|SINO;
    |MENAV men2;                         ||mensaje error impresora;
|FINSI;
|FCAL;                                   ||termina el calculo;


|CALCULO clave;
|SI #1#6 = 1;
        ordena = cliente;
    |BUCLE cainfccl0;
|FINSI;
|SI #1#6 = 2;
        ordena = seccion;
    |BUCLE cainfccl1;
|FINSI;
|FCAL;
