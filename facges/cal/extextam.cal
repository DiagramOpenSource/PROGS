|FICHEROS;
   extextam #0;
|FIN;

|VARIABLES;
   Puntero = 0;
   CodigoExp = 0;
   TipoExp   = "";
   LineaTram = 0;
   Calc      = 0;
   Comodin = ""; Comodin1 = "";

   nBaffer = 0;
   nTotalLinea = 0; nTope = 0; nVari1 = 0; nVari2 = 0;

   &enModoEdita  = 0;
   &enTotalVaria = 0;
   &enCampoAncho = 0;
   &eaNombreList  = "";
   &enCuadroIni   = 0;
   &enCuadroFin   = 0;

{100}&epPuntEdita   = "";
|FIN;

|PROCESO GrabaSecuencial;
     IepPuntEdita  = epPuntEdita1 <-;
     |PARA nTotalLinea = 0;  |SI nTotalLinea [ enTotalVaria;  |HACIENDO nTotalLinea = nTotalLinea + 1;
          |AL_BUF nBaffer, nTotalLinea, epPuntEdita;
          IepPuntEdita = IepPuntEdita + 1;
     |SIGUE;
|FPRC;

|PROCESO Edicion;
     nTope  = nTotalLinea - 1;
     nVari1 = 0;
     nVari2 = 0;
     enModoEdita = enModoEdita + 100;
     |EDITA nBaffer, 1, nTope, enCuadroIni, enCuadroFin, enModoEdita, eaNombreList, enCampoAncho, nVari1, nVari2;
     enModoEdita = enModoEdita $ 100;
|FPRC;

|PROCESO CogePuntero;
     IepPuntEdita  = epPuntEdita1 <-;
     |PARA nTotalLinea = 0;  |SI nTotalLinea [ enTotalVaria;  |HACIENDO nTotalLinea = nTotalLinea + 1;
          |DEL_BUF nBaffer, nTotalLinea, epPuntEdita;
          IepPuntEdita = IepPuntEdita + 1;
     |SIGUE;
|FPRC;

|PROCESO Edita;
     |PUSHV 0501 2380;
     |DIMENSIONA  200, nBaffer, 0;

     |HAZ GrabaSecuencial;
     |HAZ Edicion;
     |HAZ CogePuntero;

     |FINDIM nBaffer;
     |POPV;
|FPRC;

|PROGRAMA;
   Comodin = PARAMETRO; |QBF Comodin;
   Comodin1 = Comodin % 0105; CodigoExp = Comodin1;
   Comodin1 = Comodin % 0702; TipoExp   = Comodin1;
   Comodin1 = Comodin % 1003; LineaTram = Comodin1;

   enTotalVaria = 100;
   enModoEdita  = 0;
   enCampoAncho = 40;
   eaNombreList  = "";
   enCuadroIni   = 1238;
   enCuadroFin   = 2180;

   |ABRE #extextam;
   |PARA Puntero = 1; |SI Puntero [ 100; |HACIENDO Puntero = Puntero + 1;
      IepPuntEdita  = epPuntEdita1 <-;
      IepPuntEdita = IepPuntEdita + (Puntero - 1);

      #extextam#0 = CodigoExp;
      #extextam#1 = TipoExp;
      #extextam#2 = LineaTram;
      #extextam#3 = Puntero;
      |LEE 101#extextam.=;
      |SI FSalida ! 0;
         epPuntEdita  = "";
      |SINO;
         epPuntEdita  = #extextam#4;
         |BORRA 020#extextam.a;
         |LIBERA #extextam;
      |FINSI;
   |SIGUE;
   |CIERRA #extextam;

   |PUSHV  0501 2380;
||   |BLANCO 0811 2071;
   |ATRI R;  |PINTA 1138, " Texto ampliado ";  |ATRI 0;

   |HAZ Edita;
   |POPV;

   |ABRE #extextam;
   |PARA Puntero = 1;  |SI Puntero [ 100;  |HACIENDO Puntero = Puntero + 1;
      IepPuntEdita  = epPuntEdita1 <-;
      IepPuntEdita = IepPuntEdita + (Puntero - 1);

      |DDEFECTO #extextam;
      #extextam#0 = CodigoExp;
      #extextam#1 = TipoExp;
      #extextam#2 = LineaTram;
      #extextam#3 = Puntero;
      |LEE 101#extextam.=;
      |SI FSalida ! 0;
         Comodin = epPuntEdita; |QBF Comodin;
         |SI Comodin ! "";
            #extextam#4 = epPuntEdita;
            |GRABA 020#extextam.n;
         |FINSI;
      |SINO;
         Comodin = epPuntEdita; |QBF Comodin;
         |SI Comodin ! "";
            #extextam#4 = epPuntEdita;
            |GRABA 020#extextam.a;
         |FINSI;
      |FINSI;
   |SIGUE;
   |CIERRA #extextam;

|FPRO;
