|FICHEROS;
     dspase33;

     asclient;
     ascaisec;

     refempr@;
|FIN;

|VARIABLES;
     aPathFich       = "";
     aAlfa           = "";
     aAlfa1          = "";
     aAlfa2          = "";
     aDigito         = "";
     aBase           = "";
     aMas            = "";
     aFich           = "";

     &eaCta          = "";
     &eaPais         = "";
     &eaIBAN         = "";
     &eaPathBasica   = "";
     &eaPathFacturar = "";
     &eaPathIntegral = "";
     &eaPathLaboral  = "";
     &eaEntidad      = "";
     &eaSucursal     = "";
     &eaCuenta       = "";
     &eaDC           = "";
|FIN;

|PROCESO asclient;
     |SI #asclient#68 = "   ";
         #asclient#68 = "ES ";
     |FINSI;

     eaPais = #asclient#68;
     eaCta  = #asclient#13;  |QBF eaCta;
     eaCta  = eaCta + #asclient#14;

     |HAZ CalcuIBAN;

     #asclient#59 = eaIBAN;

     |GRABA 020#asclient.a;
     |LIBERA #asclient;

     |PULSATECLA;
|FPRC;

|DEFBUCLE asclient;
     #asclient#1001;
     ;
     00000;
     99999;
     be;
     NULL, asclient;
|FIN;

|PROCESO ascaisec;
     eaCta  = #ascaisec#4 + #ascaisec#5 + #ascaisec#11 + #ascaisec#6;
     eaPais = #ascaisec#38;
     |HAZ CalcuIBAN;

     #ascaisec#32 = eaIBAN;

     |GRABA 020#ascaisec.a;
     |LIBERA #ascaisec;

     |PULSATECLA;
|FPRC;

|DEFBUCLE ascaisec;
     #ascaisec#1001;
     ;
     00;
     99;
     be;
     NULL, ascaisec;
|FIN;

|PROCESO facemp;
     aFich = aBase + "facges/fich/" + (("00" + #refempr@#0) % -102) + "/";

     |PATH_DAT #asclient#aFich#;
     |PATH_DAT #ascaisec#aFich#;

     |BUCLE asclient;
     |BUCLE ascaisec;

     |PULSATECLA;
|FPRC;

|DEFBUCLE facemp;
     #refempr@#1001;
     ;
     00;
     99;
     ;
     NULL, facemp;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |SI #dspase33#0 ! "SI";
         |ACABA;
     |FINSI;

     |ATRI R;
     |PINTA 1825, "PROCESANDO TRABAJO";
     |ATRI 0;

     aMas = aBase + "facges/def/facemp.mas";
     |CARGA_DEF aMas, refempr@;

     aFich = aBase + "facges/fich/";
     |PATH_DAT #refempr@#aFich#;

     |BUCLE facemp;

      |DESCARGA_DEF #refempr@;
|FPRC;

|PROGRAMA;
     |DBASS aBase;

     aMas = aBase + "agicli/def/dspase33.mas";
     |XABRE "E", aMas, 0;
     |SI FSalida ] 0;
         |MENAV "0000Detectado modulo integrador, por favor lanzar el proceso desde alli.";
         |ACABA;
     |FINSI;

     |MANTE #dspase33;
|FPRO;
