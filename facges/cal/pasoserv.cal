|FICHEROS;
   pasoserv #0;
   asclient #1;
   asexpcab #2;
   asexplin #3;
   asprovin #4;
|FIN;

|VARIABLES;
    corta = 0;

    alfa1 = "";
    alfa  = "";

    nif   = "";
    fiche = "";
    field = "";
    field1 = "";
    field2 = "";
    field3 = "";
    field4 = "";
    canal = "";
    FEstado = 0;
|FIN;

|PROCESO creacion; |TIPO 3;
|HAZ pase2;
|HAZ pase1;
|FPRC;

|PROCESO pase1;
|ABRE #1;
|ABRE #4;
fiche = "rb  " + #0#0;
|QBF fiche;
    |FABRE fiche;
    |SI FSalida ] 0;
         canal = FSalida;
         corta = 0;
        |PARA; |SI corta = 0; |HACIENDO;
            field1 = canal + " " + 132;
            |FLEE field1;
            |SI FSalida > 0;                     || realiza dos lecturas para
                |HAZ pasamel1;
            |SINO;
                corta = 1;
            |FINSI;
        |SIGUE;
        |FCIERRA canal;
    |FINSI;
    Pos = -1;
|CIERRA #1;
|CIERRA #4;
|FPRC;

|PROCESO pase2;
|ABRE #2;
|ABRE #3;
fiche = "rb  " + #0#1;
|QBF fiche;
    |FABRE fiche;
    |SI FSalida ] 0;
         canal = FSalida;
         corta = 0;
        |PARA; |SI corta = 0; |HACIENDO;
                field1 = canal + " " + 70;
            |FLEE field1;
            |SI FSalida > 0;                     || realiza dos lecturas para
                |HAZ pasamel2;
            |SINO;
                corta = 1;
            |FINSI;
        |SIGUE;
        ||DEBUG;
        |FCIERRA canal;
    |FINSI;
    Pos = -1;
|CIERRA #2;
|CIERRA #3;
|FPRC;

||**********************************************************************

|PROCESO pasamel1;
   field = field1 % 105;
   #0#2 = field;
   |PINTA #0#2;
   || ... |SI #0#2 = 1071; |DEBUG; |FINSI;

   #1#0 = #0#2;
   |LIBERA #1;
   |LEE 110#1=;
   |SI FSalida = 0; |AVISO; |PAUSA; |FINSI;
   FEstado = FSalida;
   |DDEFECTO #1;
   #1#0   = #0#2;
   #1#1   = field1 % 0640;
   #1#2   = #1#1;
   #1#3   = field1 % 4630;
   alfa   = field1 % 10102; #1#4 = alfa;
   alfa   = field1 % 10303; #1#5 = alfa;
   #1#6   = field1 % 7625;
   #1#7   = field1 % 10615;
   #1#9   = field1 % 12112;
   |SI FEstado = 0; |GRABA 020#1a; |SINO; |GRABA 020#1n; |FINSI;

   |SI #1#4 ! 0;
       #4#0 = #1#4;
       |LIBERA #4;
       |LEE 110#4=;
       |SI FSalida ! 0;
           #4#0 = #1#4;
           #4#1 = #1#7;
           |GRABA 020#4n;
       |FINSI;
   |FINSI;
|FPRC;

|PROCESO pasamel2;
   field = field1 % 105;
   #0#2 = field; |PINTA #0#2;
   field = field1 % 605;
   #0#3 = field; #0#3 = #0#3 * 100; |PINTA #0#3;

   #3#0 = #0#2;          || cliente
   #3#1 = #0#3;          || expediente
   |LEE 001#3=;
   |PARA; |SI FSalida = 0; |HACIENDO;
           #0#3 = #0#3 + 1;
           #3#1 = #0#3;
       |LEE 001#3=;
   |SIGUE;
   |DDEFECTO #3;
   #3#0   = #0#2;
   #3#1   = #0#3;
   #3#2   = field1 % 1140;
   alfa   = field1 % 5110;  #3#3 = alfa;
   #3#4   = field1 % 6110;
   |GRABA 020#3n;

   #2#0 = #0#2;
   |LIBERA #2;
   |LEE 110#2=;
   |SI FSalida ! 0;
       #2#0 = #0#2;
       |GRABA 020#2n;
   |FINSI;
|FPRC;
