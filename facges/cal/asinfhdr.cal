|FICHEROS;
     ashisrec #0;                         ||PROCESO DESDE-HASTA PARA INFORMES;
     asinfhdr #1;
     asclient #2;
|FIN;

|VARIABLES;
     informe = "asinfhdr";
     men1 = "     NO EXISTE INFORME.";
     men2 = "     NO EXISTE IMPRESORA.";
     men3 = "     NO SE PUDIERON SELECCIONAR REGISTROS";
     sw1 = 0;                            ||CAMBIAR VARIABLE informe NOMBRE;
     sw2 = 0;                            ||DE FICHERO Y DE CALCULO.       ;
     &ordena = " ";

     serie    = "Serie-Factura.";
     cliente  = "Cliente.";
     fech     = "Fecha Emision.";
     banco    = "Banco.";
     sw_impre = 0;
     fFech = @;
     qFech = "";
     dFech = "";
     hFech = "";
|FIN;


|PROCESO imprimir;
   sw_impre = 1;
   #2#0 = #0#3;
   |LEE 040#2=;
   |PRINT;
|FPRC;

|DEFBUCLE cainfhdr0;
#0#1;
3, 2, 5, 4, 7, 6;
#1#0, #1#2, #1#4, #1#6, #1#8, #1#10, #1#12,       #1#16;
#1#1, #1#3, #1#5, #1#7, #1#9, #1#11, #1#13, 99999999999;
e;
NULL,imprimir;
|FIN;


|DEFBUCLE cainfhdr1;
#0#3;
2, 5, 4, 7, 6;
#1#4, #1#0, #1#2, #1#6, #1#8, #1#10, #1#12,       #1#16;
#1#5, #1#1, #1#3, #1#7, #1#9, #1#11, #1#13, 99999999999;
e;
NULL,imprimir;
|FIN;


|DEFBUCLE cainfhdr2;
#0#2;
3, 5, 4, 7, 6;
#1#6, #1#0, #1#2, #1#4, #1#8, #1#10, #1#12,       #1#16;
#1#7, #1#1, #1#3, #1#5, #1#9, #1#11, #1#13, 99999999999;
e;
NULL,imprimir;
|FIN;


|DEFBUCLE cainfhdr3;
#0#4;
3, 2, 5, 4, 6;
#1#12, #1#0, #1#2, #1#4, #1#6, #1#8, #1#10,       #1#16;
#1#13, #1#1, #1#3, #1#5, #1#7, #1#9, #1#11, 99999999999;
e;
NULL,imprimir;
|FIN;

|PROCESO impre;|TIPO 3;
|IMPRE 0;
|SI FSalida ! 0; |ACABA; |FINSI;

|INFOR informe;
|SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;

sw_impre = 0;
|ABRE #2;
|HAZ clave;
|SI sw_impre = 1; |PIEINF; |FINSI;
|FININF;
|FINIMP;
|CIERRA #2;
|FPRC;                                   ||termina el calculo;

|PROCESO clave;
|SI #1#14 = 1;
      ordena = serie;
      |BUCLE cainfhdr0;
|FINSI;
|SI #1#14 = 2;
     ordena = cliente;
    |BUCLE cainfhdr1;
|FINSI;
|SI #1#14 = 3;
    ordena = fech;
    |BUCLE cainfhdr2;
|FINSI;
|SI #1#14 = 4;
    ordena = banco;
    |BUCLE cainfhdr3;
|FINSI;
|FPRC;

|PROCESO sacaano; |TIPO 7;
     fFech = ~;
     qFech = fFech % -104;
     dFech = "01.01." + qFech;
     hFech = "31.12." + qFech;
     #1#6  = dFech;
     #1#7  = hFech;
     #1#8  = dFech;
     #1#9  = hFech;
     |PINTA #1#6;
     |PINTA #1#7;
     |PINTA #1#8;
     |PINTA #1#9;
|FPRC;
