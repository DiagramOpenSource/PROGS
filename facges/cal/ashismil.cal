|FICHEROS;
    ashismil #0;
    asconcl1 #1;
    ashismic #2;
    asconcep #3;
    asclient #4;
    ascontro #5;
    ascontfd #15;
    ashiscon #92;

    asm00003 #500;
    ascuocab #501;
    ascuolin #502;
|FIN;

|VARIABLES;
     Modo     = 0;
     Flag     = 0;
     NumLin   = 0;
     nCliente = 0;
     nDivisor = 0;

     modo     = 0;
     traba    = "";
     valor    = "";
     clie     = 0;
     line     = 0;
     secc     = "";
     conc     = "";
     secc_cli = "";
     conc_cli = "";
     descr_ant = "";
     FEstado   = 0;
     mes_a     = "";
     mes_num   = 0;
     campo     = 0;
     nNume1    = 0;
     nNume2    = 0;
|FIN;

|RUTINA minimo;
#1#0 = #2#3;
#1#1 = "    ";
#1#2 = "  ";
|FRUT;

|RUTINA maximo;
#1#0 = #2#3;
#1#1 = "ееее";
#1#2 = "ее";
|FRUT;

|PROCESO leeconcl;|TIPO 0;    ||si pulsa F1 accede a conceptos / clientes
|SI FSalida ! 9; |ACABA; |FINSI;

secc_cli = "";
conc_cli = "";

|PUSHV 0501 2380;
|PINPA #0#1;
|PINTA 926, #2#5;

|ENTLINEAL #1#1, 3, 4, 19, 0, minimo, maximo;
|POPV;

|SI secc_cli ! ""; |O conc_cli ! "";
    #0#4 = secc_cli; |PINTA #0#4;
    #0#5 = conc_cli; |PINTA #0#5;
|FINSI;
|FPRC;

|PROCESO leconcep;|TIPO 0;
modo = (FEntrada / 100) ! 0;

|SI secc = #0#4; |Y conc = #0#5; |Y clie = #2#3; |Y modo ! 1;
    |ACABA;
|FINSI;

|ABRET #1;
|ABRET #3;

#1#0 = #2#3;
#1#1 = #0#4;
#1#2 = #0#5;
|LEE 040#1=;
|SI FSalida = 0;
    #0#6 = #1#6;
    #0#7 = #1#7;
    #0#8 = #1#8;
    #0#9 = #1#9;
    #0#10 = #1#3;
    #0#11 = 1;
    #0#12 = #1#10;
    #0#14 = #1#5;
|SINO;
    #3#0 = #0#4;
    #3#1 = #0#5;
    |LEE 040#3=;
    |SI FSalida = 0;
        |SI #3#3 = "N";
            |MENAV "     Es una nota de Expedientes";
            |ERROR;
            |CIERRAT #1;
            |CIERRAT #3;
            |ACABA;
        |SINO;
            |ABRE #4;
            #4#0 = #2#3;
            |LEE 040#4=;
            |SI FSalida = 0;
                |SI #4#22 = 1; #0#12 = #3#4;  #0#14 = #3#5;  |FINSI;
                |SI #4#22 = 2; #0#12 = #3#8;  #0#14 = #3#9;  |FINSI;
                |SI #4#22 = 3; #0#12 = #3#10; #0#14 = #3#11; |FINSI;
                |SI #4#22 = 4; #0#12 = #3#12; #0#14 = #3#13; |FINSI;
                |SI #4#22 = 5; #0#12 = #3#14; #0#14 = #3#15; |FINSI;
            |FINSI;
            |CIERRA #4;

            #0#6 = #3#2;
            #0#7 = #3#16;
            #0#8 = #3#17;
            #0#9 = #3#18;
            #0#10 = #3#3;
            #0#11 = 1;
        |FINSI;
    |SINO;
        #0#5 = 0;
        |MENAV "    ATENCION no existe el concepto automatico";
        |PTEC 808;
        |CIERRAT #1;
        |CIERRAT #3;
        |ACABA;
    |FINSI;
|FINSI;

|SI #0#14 = "U"; #0#13 = #0#12; |FINSI;

#0#13 = #0#12 * #0#11;  |PINTA #0#13;

|CIERRAT #1;
|CIERRAT #3;

|PINTA #0#6;
|PINTA #0#7;
|PINTA #0#8;
|PINTA #0#9;
|PINTA #0#11;
|PINTA #0#12;
|PINTA #0#13;

secc = #0#4;
conc = #0#5;
clie = #2#3;
|FPRC;

|PROCESO descabre; |TIPO 0;
traba = #0#7;  |QBF traba;
valor = traba % A0;
|SI valor = 0;
    #0#7 = #0#6;
    |PINTA #0#7;
|FINSI;
|SI #0#7 = descr_ant;
    #0#7 = #0#6;
    |PINTA #0#7;
|FINSI;
|FPRC;

|PROCESO descr_ant; |TIPO 7;
descr_ant = #0#6;
|FPRC;

|PROCESO imporref; |TIPO 0;
#0#13 = #0#12 * #0#11;
|PINTA #0#13;
|FPRC;

|PROCESO AltaCuotCli;
   #asm00003#0  = 0;
   #asm00003#1  = #ashismic#3;
   #asm00003#2  = #ashismil#0;
   #asm00003#3  = #ashismil#1;
   #asm00003#4  = #ashismil#2;
   #asm00003#5  = 1;
   #asm00003#10 = "S";
   |LEE 000#asm00003.];
   |SI FSalida = 0; |Y #asm00003#1 = #ashismic#3; |Y #asm00003#2 = #ashismil#0;
    |Y #asm00003#3 = #ashismil#1; |Y #asm00003#4 = #ashismil#2; |Y #asm00003#10 = "S";
       |PARA; |SI FSalida = 0; |Y #asm00003#1 = #ashismic#3; |Y #asm00003#2 = #ashismil#0;
        |Y #asm00003#3 = #ashismil#1; |Y #asm00003#4 = #ashismil#2; |Y #asm00003#10 = "S"; |HACIENDO;
          NumLin = #asm00003#5 + 1;
          |LEE 000#asm00003.s;
       |SIGUE;
   |SINO;
       NumLin = 1;
   |FINSI;

   |DDEFECTO #asm00003;
   #asm00003#0  = 0;
   #asm00003#1  = #ashismic#3;
   #asm00003#2  = #ashismil#0;
   #asm00003#3  = #ashismil#1;
   #asm00003#4  = #ashismil#2;
   #asm00003#5  = NumLin;
   #asm00003#6  = #ascuolin#2;
   #asm00003#7  = #ascuolin#3;
   #asm00003#9  = #ascuolin#4;
   #asm00003#10 = "S";
   #asm00003#11 = #ascuolin#6;
   |SI #ascuocab#2 = "M"; nDivisor = 12; |FINSI;
   |SI #ascuocab#2 = "T"; nDivisor = 4;  |FINSI;
   |SI #ascuocab#2 = "S"; nDivisor = 2;  |FINSI;
   |SI #ascuocab#2 = "A"; nDivisor = 1;  |FINSI;
   #asm00003#12 = #ascuolin#5 / nDivisor;
   #asm00003#8  = #ascuolin#7 / nDivisor;
   |GRABA 020#asm00003.n;
|FPRC;

|DEFBUCLE AltaCuotCli;
#ascuolin#1;
;
nCliente,001;
nCliente,999;
;
NULL,AltaCuotCli;
|FIN;

|PROCESO LinCuotCli;
   |SI Modo = 3;
      |BORRA 020#asm00003.a;
   |FINSI;
   |SI Modo = 2; |Y Flag < 0;
      |BORRA 020#asm00003.a;
   |FINSI;
|FPRC;

|DEFBUCLE LinCuotCli;
#asm00003#1;
;
0,#ashismic#3,#ashismil#0,#ashismil#1,"S",#ashismil#2,01;
9,#ashismic#3,#ashismil#0,#ashismil#1,"S",#ashismil#2,99;
;
NULL,LinCuotCli;
|FIN;

|PROCESO refresca; |TIPO 2;
|ABRE #5;
|LEE 040#5p;
|SI FSalida ! 0; |DDEFECTO #5; |FINSI;
|CIERRA #5;

clie = #2#3;
line = #0#2;
secc = #0#4;
conc = #0#5;

|SI #0#10 = "H"; #2#19 = #2#19 +. #0#13; |FINSI;
|SI #0#10 = "S"; #2#20 = #2#20 +. #0#13; |FINSI;
|SI #0#10 = "A"; #2#21 = #2#21 +. #0#13; |FINSI;

#2#23 = #2#19 % #2#22;
#2#24 = #2#19 - #2#23;
#2#25 = #2#24 % #2#45;
#2#26 = #2#24 + #2#25 + #2#20;
|SI #2#14 = "S";
    |SI #2#46 = 0;
        #2#46 = #5#31;
    |FINSI;

    #2#27 = #2#24 % #2#46;
|SINO;
    #2#27 = 0;
    #2#46 = 0;
|FINSI;

#2#28 = #2#26 - #2#27 - #2#21;

|PINTA #0#13;
|PINTA #2#19;
|PINTA #2#20;
|PINTA #2#21;
|PINTA #2#23;
|PINTA #2#24;
|PINTA #2#25;
|PINTA #2#26;
|PINTA #2#27;
|PINTA #2#28;

  Modo = (FEntrada / 100) ! 0;
  Flag = 0 +. 1;

  nCliente = #ashismic#3;
  |ABRE #ascuocab; |ABRE #ascuolin; |ABRE #asm00003;
  |SI Modo = 1;
     #ascuocab#0 = nCliente;
     |LEE 000#ascuocab.=;
     |SI FSalida = 0; |Y #ascuocab#3 = #ashismil#4; |Y #ascuocab#4 = #ashismil#5;
        |BUCLE AltaCuotCli;
     |FINSI;
  |FINSI;
  |SI Modo = 2;
     |SI Flag > 0;
        #ascuocab#0 = nCliente;
        |LEE 000#ascuocab.=;
        |SI FSalida = 0; |Y #ascuocab#3 = #ashismil#4; |Y #ascuocab#4 = #ashismil#5;
           |BUCLE AltaCuotCli;
        |FINSI;
     |SINO;
        |BUCLE LinCuotCli;
     |FINSI;
  |FINSI;
  |SI Modo = 3;
     |BUCLE LinCuotCli;
  |FINSI;
  |CIERRA #ascuocab; |CIERRA #ascuolin; |CIERRA #asm00003;

mes_a   = #0#3 % 402;
mes_num = mes_a;

|ABRE #3;
#3#0 = #0#4;
#3#1 = #0#5;
|LIBERA #3;
|LEE 140#3=;
|SI FSalida = 0;
    #3#31 = #3#31 +. #0#13;
    #3#6  = #3#6  +. #0#13;
    campo = 18 + mes_num; #3campo = #3campo +. #0#13;

    |GRABA 140#3a;
|FINSI;
|CIERRA #3;

modo = (FEntrada / 100) ! 0;
|SI modo = 3;
    |ABRE #92;
    #92#0 = #0#0; #92#1 = #0#1; #92#2 = #0#2; |BORRA 140#92c; |LIBERA #92;
    |CIERRA #92;
    |ACABA;
|FINSI;

|ABRE #92;
#92#0 = #0#0;
#92#1 = #0#1;
#92#2 = #0#2;
|LIBERA #92;
|LEE 140#92=;
FEstado = FSalida;

|DDEFECTO #92;
#92#0  = #0#0;
#92#1  = #0#1;
#92#2  = #0#2;
#92#3  = #0#3;
#92#4  = #2#3;
#92#5  = #0#4;
#92#6  = #0#5;
#92#7  = #0#7;
#92#8  = #0#10;
#92#9  = #0#13;
#92#10 = #0#8;
#92#11 = #0#9;
|SI FEstado ! 0; |GRABA 140#92n; |SINO; |GRABA 140#92a; |FINSI;
|FPRC;

|| ************************************************************************
||                  PROCESOS LLAMADOS DESDE CONCEPTOS CLIENTES
|| ************************************************************************

|PROCESO este_bueno; |TIPO 11;
|SI FSalida ! 9; |ACABA; |FINSI;

|CAMPO_ATRIBUTO #1#1, R, 0, 0; |PINTA #1#1;
|CAMPO_ATRIBUTO #1#2, R, 0, 0; |PINTA #1#2;
|CAMPO_ATRIBUTO #1#6, R, 0, 0; |PINTA #1#6;
|CAMPO_ATRIBUTO #1#3, R, 0, 0; |PINTA #1#3;

|CONFI "2400SEl concepto es el correcto : ";
|SI FSalida = 0;
    secc_cli = #1#1;
    conc_cli = #1#2;
|FINSI;

|CAMPO_ATRIBUTO #1#1, D, 0, 0; |PINTA #1#1;
|CAMPO_ATRIBUTO #1#2, D, 0, 0; |PINTA #1#2;
|CAMPO_ATRIBUTO #1#6, D, 0, 0; |PINTA #1#6;
|CAMPO_ATRIBUTO #1#3, D, 0, 0; |PINTA #1#3;

|SI secc_cli ! ""; |O conc_cli ! ""; |PTEC 807; |FINSI;
|FPRC;

|RUTINA infhis;
   #asm00003#0 = 0;
   #asm00003#1 = #ashismic#3;
   #asm00003#2 = #ashismic#0;
   #asm00003#3 = #ashismic#1;
   #asm00003#4 = #ashismil#2;
   #asm00003#5 = 01;
   #asm00003#10 = "S";
|FRUT;

|RUTINA suphis;
   #asm00003#0 = 9;
   #asm00003#1 = #ashismic#3;
   #asm00003#2 = #ashismic#0;
   #asm00003#3 = #ashismic#1;
   #asm00003#4 = #ashismil#2;
   #asm00003#5 = 99;
   #asm00003#10 = "S";
|FRUT;

|PROCESO Lineal; |TIPO 11;
|SI FSalida = 10 ;
   |PUSHV 0914 1869;
   |BLANCO 0914 1869;
   |ENTLINEAL #1#asm00003,-7,4,17,1,infhis,suphis;
   |POPV;
   |ERROR; |ACABA;
|FINSI;
|FPRC;
