|VARIABLES;
    tipo_ase     = "";
    secc_ase     = "";
    conc_ase     = "";
    dcab_ase     = "";
    des2_ase     = "";
    des3_ase     = "";
    impo_ase     = 0;

    seis         = "      ";
    cero         = 0;
    indisupl     = 0;
    indisup      = 0;

    &acue        = 0;
    &base        = 0;
    &tiva        = 0;

    {-1}&cod     = "        ";
        &cod1    = "        ";
        &cod2    = "        ";
        &cod3    = "        ";
        &cod4    = "        ";
        &cod5    = "        ";
        &cod6    = "        ";
        &cod7    = "        ";
        &cod8    = "        ";
        &cod9    = "        ";
        &cod10   = "        ";
        &cod11   = "        ";
        &cod12   = "        ";

    {-1}&csu     = "        ";
        &csu1    = "        ";
        &csu2    = "        ";
        &csu3    = "        ";
        &csu4    = "        ";
        &csu5    = "        ";

    {-1}&dsu     = "                                        ";
        &dsu1    = "                                        ";
        &dsu2    = "                                        ";
        &dsu3    = "                                        ";
        &dsu4    = "                                        ";
        &dsu5    = "                                        ";

    {-1}&isu     = 0;
        &isu1    = 0;
        &isu2    = 0;
        &isu3    = 0;
        &isu4    = 0;
        &isu5    = 0;

    {-1}codsup   = "        ";
        codsup1  = "        ";
        codsup2  = "        ";
        codsup3  = "        ";
        codsup4  = "        ";
        codsup5  = "        ";
        codsup6  = "        ";
        codsup7  = "        ";
        codsup8  = "        ";
        codsup9  = "        ";
        codsup10 = "        ";
        codsup11 = "        ";
        codsup12 = "        ";
        codsup13 = "        ";
        codsup14 = "        ";
        codsup15 = "        ";
        codsup16 = "        ";
        codsup17 = "        ";
        codsup18 = "        ";
        codsup19 = "        ";
        codsup20 = "        ";
        codsup21 = "        ";
        codsup22 = "        ";
        codsup23 = "        ";
        codsup24 = "        ";
        codsup25 = "        ";
        codsup26 = "        ";
        codsup27 = "        ";
        codsup28 = "        ";
        codsup29 = "        ";
        codsup30 = "        ";

    {-1}dessup   = "                                        ";
        dessup1  = "                                        ";
        dessup2  = "                                        ";
        dessup3  = "                                        ";
        dessup4  = "                                        ";
        dessup5  = "                                        ";
        dessup6  = "                                        ";
        dessup7  = "                                        ";
        dessup8  = "                                        ";
        dessup9  = "                                        ";
        dessup10 = "                                        ";
        dessup11 = "                                        ";
        dessup12 = "                                        ";
        dessup13 = "                                        ";
        dessup14 = "                                        ";
        dessup15 = "                                        ";
        dessup16 = "                                        ";
        dessup17 = "                                        ";
        dessup18 = "                                        ";
        dessup19 = "                                        ";
        dessup20 = "                                        ";
        dessup21 = "                                        ";
        dessup22 = "                                        ";
        dessup23 = "                                        ";
        dessup24 = "                                        ";
        dessup25 = "                                        ";
        dessup26 = "                                        ";
        dessup27 = "                                        ";
        dessup28 = "                                        ";
        dessup29 = "                                        ";
        dessup30 = "                                        ";

    {-1}impsup   = 0;
        impsup1  = 0;
        impsup2  = 0;
        impsup3  = 0;
        impsup4  = 0;
        impsup5  = 0;
        impsup6  = 0;
        impsup7  = 0;
        impsup8  = 0;
        impsup9  = 0;
        impsup10 = 0;
        impsup11 = 0;
        impsup12 = 0;
        impsup13 = 0;
        impsup14 = 0;
        impsup15 = 0;
        impsup16 = 0;
        impsup17 = 0;
        impsup18 = 0;
        impsup19 = 0;
        impsup20 = 0;
        impsup21 = 0;
        impsup22 = 0;
        impsup23 = 0;
        impsup24 = 0;
        impsup25 = 0;
        impsup26 = 0;
        impsup27 = 0;
        impsup28 = 0;
        impsup29 = 0;
        impsup30 = 0;

|| ABDON
    secc_ase_ant = "";
    conc_ase_ant = "";
    dcab_ase_ant = "";
    d2cb_ase_ant = "";
    d3cb_ase_ant = "";
    nimp_ase_ant = 0;

    {-1}&enOrd      = 0;
        &enOrd1     = 0;
        &enOrd2     = 0;
        &enOrd3     = 0;
        &enOrd4     = 0;
        &enOrd5     = 0;
        &enOrd6     = 0;
        &enOrd7     = 0;
        &enOrd8     = 0;
        &enOrd9     = 0;
        &enOrd10    = 0;
        &enOrd11    = 0;
        &enOrd12    = 0;

    {-1}&enImpTot   = 0;
        &enImpTot1  = 0;
        &enImpTot2  = 0;
        &enImpTot3  = 0;
        &enImpTot4  = 0;
        &enImpTot5  = 0;
        &enImpTot6  = 0;
        &enImpTot7  = 0;
        &enImpTot8  = 0;
        &enImpTot9  = 0;
        &enImpTot10 = 0;
        &enImpTot11 = 0;
        &enImpTot12 = 0;

    {-1}&enUnidad   = 0;
        &enUnidad1  = 0;
        &enUnidad2  = 0;
        &enUnidad3  = 0;
        &enUnidad4  = 0;
        &enUnidad5  = 0;
        &enUnidad6  = 0;
        &enUnidad7  = 0;
        &enUnidad8  = 0;
        &enUnidad9  = 0;
        &enUnidad10 = 0;
        &enUnidad11 = 0;
        &enUnidad12 = 0;

    nOrden         = 0;
    nImpTotal      = 0;
    nUnidades      = 0;
    nIndice        = 0;
    nSwInc         = 0;
|| FIN ABDON

|FIN;

|PROCESO asefeco;
|SI tipo_ase ! "S";  |Y tipo_ase ! "A";
    |SI indihono > 11; |HAZ escribe;  |FINSI;

|| ABDON
    |SI secc_ase_ant ! secc_ase; |O conc_ase_ant ! conc_ase;
     |O dcab_ase_ant ! dcab_ase; |O d2cb_ase_ant ! des2_ase;
     |O d3cb_ase_ant ! des3_ase; |O nimp_ase_ant ! impo_ase;

        nSwInc = 1;
        |SI nOrden ! 0;
           nIndice = nIndice + 1;
        |FINSI;

        IenOrd    = enOrd1 <-;
        IenImpTot = enImpTot1 <-;
        IenUnidad = enUnidad1 <-;

        IenOrd    = IenOrd    + nIndice;
        IenImpTot = IenImpTot + nIndice;
        IenUnidad = IenUnidad + nIndice;

        nOrden    = 1;
        nUnidades = 1;
        nImpTotal = (impo_ase /enFactor) ! EURODB;

        secc_ase_ant = secc_ase;
        conc_ase_ant = conc_ase;
        dcab_ase_ant = dcab_ase;
        d2cb_ase_ant = des2_ase;
        d3cb_ase_ant = des3_ase;
        nimp_ase_ant = impo_ase;
    |SINO;
        nSwInc    = 0;
        nOrden    = nOrden    + 1;
        nUnidades = nUnidades + 1;
        nImpTotal = nImpTotal + ((impo_ase /enFactor) ! EURODB);
    |FINSI;
    |SI tipo_ase = "H"; hono = hono + ((impo_ase /enFactor) ! EURODB); |FINSI;

    enOrd    = nOrden;
    enImpTot = nImpTotal;
    enUnidad = nUnidades;
||FIN ABDON

    |SI nSwInc = 1; || ABDON
       |HAZ inipuntero;
       Icod      = Icod + indihono;
       Ides      = Ides + indihono;
       Iimp      = Iimp + indihono;
       cod       = secc_ase + conc_ase;
       des       = dcab_ase;
       imp       = (impo_ase / enFactor) ! EURODB;

       indihono  = indihono + 1;
    |FINSI;         || ABDON

    ||SI tipo_ase = "H"; hono = hono + imp; |FINSI;

    |SI des2_ase ! vacio;
        |SI indihono > 11; |HAZ escribe; |FINSI;

        |HAZ inipuntero;

        Icod     = Icod + indihono;
        Ides     = Ides + indihono;
        Iimp     = Iimp + indihono;
        cod      = seis;
        des      = des2_ase;
        imp      = cero;

        |SI nSwInc = 1; || ABDON
           indihono = indihono + 1;
           nIndice = nIndice + 1; || ABDON
        |FINSI;         || ABDON
     |FINSI;

     |SI des3_ase ! vacio;
         |SI indihono > 11; |HAZ escribe; |FINSI;

         |HAZ inipuntero;

         Icod     = Icod + indihono;
         Ides     = Ides + indihono;
         Iimp     = Iimp + indihono;
         cod      = seis;
         des      = des2_ase;
         imp      = cero;

         |SI nSwInc = 1; || ABDON
            indihono = indihono + 1;
            nIndice = nIndice + 1; || ABDON
         |FINSI;         || ABDON
     |FINSI;
|FINSI;

|SI tipo_ase = "S";  |O tipo_ase = "A";
    |SI indisupl > 4; |HAZ escribe; |FINSI;

    |HAZ inipuntero;

    Icodsup  = Icodsup + indisupl;
    Idessup  = Idessup + indisupl;
    Iimpsup  = Iimpsup + indisupl;
    codsup   = secc_ase + conc_ase;
    dessup   = dcab_ase;
    impsup   = (impo_ase / enFactor) ! EURODB;
    indisupl = indisupl + 1;
    |SI tipo_ase = "S"; supli = supli + impsup; |FINSI;
    |SI tipo_ase = "A"; acue  = acue  + impsup; |FINSI;

    |SI des2_ase ! vacio;
        |SI indisupl > 4; |HAZ escribe; |FINSI;
        |HAZ inipuntero;

        Icodsup  = Icodsup + indisupl;
        Idessup  = Idessup + indisupl;
        Iimpsup  = Iimpsup + indisupl;
        codsup   = seis;
        dessup   = des2_ase;
        impsup   = cero;
        indisupl = indisupl + 1;
    |FINSI;

    |SI des3_ase ! vacio;
        |SI indisupl > 4; |HAZ escribe; |FINSI;
        |HAZ inipuntero;

        Icodsup = Icodsup + indisupl;
        Idessup = Idessup + indisupl;
        Iimpsup = Iimpsup + indisupl;
        codsup  = seis;
        dessup  = des3_ase;
        impsup  = cero;
        indisup = indisup + 1;
    |FINSI;
|FINSI;
|FPRC;

/*
|PROCESO asefeco;
|SI tipo_ase ! "S";  |Y tipo_ase ! "A";
    |SI indihono > 11; |HAZ escribe;  |FINSI;

    |HAZ inipuntero;
    Icod      = Icod + indihono;
    Ides      = Ides + indihono;
    Iimp      = Iimp + indihono;
    cod       = secc_ase + conc_ase;
    des       = dcab_ase;
    imp       = (impo_ase / enFactor) ! EURODB;

    indihono  = indihono + 1;

    |SI tipo_ase = "H"; hono = hono + imp; |FINSI;

    |SI des2_ase ! vacio;
        |SI indihono > 11; |HAZ escribe; |FINSI;

        |HAZ inipuntero;

        Icod     = Icod + indihono;
        Ides     = Ides + indihono;
        Iimp     = Iimp + indihono;
        cod      = seis;
        des      = des2_ase;
        imp      = cero;

        indihono = indihono + 1;
     |FINSI;

     |SI des3_ase ! vacio;
         |SI indihono > 11; |HAZ escribe; |FINSI;

         |HAZ inipuntero;

         Icod     = Icod + indihono;
         Ides     = Ides + indihono;
         Iimp     = Iimp + indihono;
         cod      = seis;
         des      = des2_ase;
         imp      = cero;

         indihono = indihono + 1;
     |FINSI;
|FINSI;

|SI tipo_ase = "S";  |O tipo_ase = "A";
    |SI indisupl > 4; |HAZ escribe; |FINSI;

    |HAZ inipuntero;

    Icodsup  = Icodsup + indisupl;
    Idessup  = Idessup + indisupl;
    Iimpsup  = Iimpsup + indisupl;
    codsup   = secc_ase + conc_ase;
    dessup   = dcab_ase;
    impsup   = (impo_ase / enFactor) ! EURODB;
    indisupl = indisupl + 1;
    |SI tipo_ase = "S"; supli = supli + impsup; |FINSI;
    |SI tipo_ase = "A"; acue  = acue  + impsup; |FINSI;

    |SI des2_ase ! vacio;
        |SI indisupl > 4; |HAZ escribe; |FINSI;
        |HAZ inipuntero;

        Icodsup  = Icodsup + indisupl;
        Idessup  = Idessup + indisupl;
        Iimpsup  = Iimpsup + indisupl;
        codsup   = seis;
        dessup   = des2_ase;
        impsup   = cero;
        indisupl = indisupl + 1;
    |FINSI;

    |SI des3_ase ! vacio;
        |SI indisupl > 4; |HAZ escribe; |FINSI;
        |HAZ inipuntero;

        Icodsup = Icodsup + indisupl;
        Idessup = Idessup + indisupl;
        Iimpsup = Iimpsup + indisupl;
        codsup  = seis;
        dessup  = des3_ase;
        impsup  = cero;
        indisup = indisup + 1;
    |FINSI;
|FINSI;
|FPRC;
*/

|PROCESO escribe;
csu1 = codsup1;
csu2 = codsup2;
csu3 = codsup3;
csu4 = codsup4;
csu5 = codsup5;
dsu1 = dessup1;
dsu2 = dessup2;
dsu3 = dessup3;
dsu4 = dessup4;
dsu5 = dessup5;
isu1 = impsup1;
isu2 = impsup2;
isu3 = impsup3;
isu4 = impsup4;
isu5 = impsup5;

|PRINT;
|PIEINF;

|HAZ borra_ase;
indihono = 0;

nIndice  = 0; nOrden = 0;               || ABDON
secc_ase_ant = ""; conc_ase_ant = "";   || ABDON
dcab_ase_ant = ""; d2cb_ase_ant = "";   || ABDON
d3cb_ase_ant = ""; nimp_ase_ant = 0;    || ABDON

indisupl = indisupl - 5;

|SI indisupl < 0; indisupl = 0; |FINSI;
|HAZ cambio;
|FPRC;

|PROCESO borra_ase;
Icod = cod1 <-;
Ides = des1 <-;
Iimp = imp1 <-;

IenOrd    = enOrd1 <-;    || ABDON
IenImpTot = enImpTot1 <-; || ABDON
IenUnidad = enUnidad1 <-; || ABDON
|PARA i = 0;|SI i < 12;|HACIENDO i = i + 1;
      cod = seis;
      des = vacio;
      imp = cero;
      Icod = Icod + 1;
      Ides = Ides + 1;
      Iimp = Iimp + 1;

      enOrd     = 0;             || ABDON
      enImpTot  = 0;             || ABDON
      enUnidad  = 0;             || ABDON
      IenOrd    = IenOrd + 1;    || ABDON
      IenImpTot = IenImpTot + 1; || ABDON
      IenUnidad = IenUnidad + 1; || ABDON
|SIGUE;

Icsu = csu1 <-;
Idsu = dsu1 <-;
Iisu = isu1 <-;
|PARA i = 0;|SI i < 5;|HACIENDO i = i + 1;
      csu = seis;
      dsu = vacio;
      isu = cero;
      Icsu = Icsu + 1;
      Idsu = Idsu + 1;
      Iisu = Iisu + 1;
|SIGUE;

base = 0;
tiva = 0;
tfac = 0;
|FPRC;

|PROCESO bormem;
Icodsup = codsup1 <-;
Idessup = dessup1 <-;
Iimpsup = impsup1 <-;

|PARA i = 0;|SI i > 30;|HACIENDO i = i + 1;
      codsup = seis;
      dessup = vacio;
      impsup = cero;
      Icodsup = Icodsup + 1;
      Idessup = Idessup + 1;
      Iimpsup = Iimpsup + 1;
|SIGUE;
|FPRC;

|PROCESO inipuntero;
Icod    = cod1 <-;
Ides    = des1 <-;
Iimp    = imp1 <-;
Icsu    = csu1 <-;
Idsu    = dsu1 <-;
Iisu    = isu1 <-;
Icodsup = codsup1 <-;
Idessup = dessup1 <-;
Iimpsup = impsup1 <-;
|FPRC;

|PROCESO cambio;
codsup1  = codsup6;
codsup2  = codsup7;
codsup3  = codsup8;
codsup4  = codsup9;
codsup5  = codsup10;
codsup6  = codsup11;
codsup7  = codsup12;
codsup8  = codsup13;
codsup9  = codsup14;
codsup10 = codsup15;
codsup11 = codsup16;
codsup12 = codsup17;
codsup13 = codsup18;
codsup14 = codsup19;
codsup15 = codsup20;
codsup16 = codsup21;
codsup17 = codsup22;
codsup18 = codsup23;
codsup19 = codsup24;
codsup20 = codsup25;
codsup21 = codsup26;
codsup22 = codsup27;
codsup23 = codsup28;
codsup24 = codsup29;
codsup25 = codsup30;

dessup1  = dessup6;
dessup2  = dessup7;
dessup3  = dessup8;
dessup4  = dessup9;
dessup5  = dessup10;
dessup6  = dessup11;
dessup7  = dessup12;
dessup8  = dessup13;
dessup9  = dessup14;
dessup10 = dessup15;
dessup11 = dessup16;
dessup12 = dessup17;
dessup13 = dessup18;
dessup14 = dessup19;
dessup15 = dessup20;
dessup16 = dessup21;
dessup17 = dessup22;
dessup18 = dessup23;
dessup19 = dessup24;
dessup20 = dessup25;
dessup21 = dessup26;
dessup22 = dessup27;
dessup23 = dessup28;
dessup24 = dessup29;
dessup25 = dessup30;

impsup1  = impsup6;
impsup2  = impsup7;
impsup3  = impsup8;
impsup4  = impsup9;
impsup5  = impsup10;
impsup6  = impsup11;
impsup7  = impsup12;
impsup8  = impsup13;
impsup9  = impsup14;
impsup10 = impsup15;
impsup11 = impsup16;
impsup12 = impsup17;
impsup13 = impsup18;
impsup14 = impsup19;
impsup15 = impsup20;
impsup16 = impsup21;
impsup17 = impsup22;
impsup18 = impsup23;
impsup19 = impsup24;
impsup20 = impsup25;
impsup21 = impsup26;
impsup22 = impsup27;
impsup23 = impsup28;
impsup24 = impsup29;
impsup25 = impsup30;
|FPRC;

|PROCESO calcula;
base = hono;
tiva = hono % ivabo;
tfac = hono + supli;
tfac = tfac + tiva;
|FPRC;
