|FICHEROS;
   aseospas #0;
   eossegui #1;
   asconcep #2;
   asclient #3;
   aseosenl #4;
   asnompat #5;
   ascabmin #6;
   aslinmin #7;
   ascontro #8;
|FIN;

|VARIABLES;
  sw      = 0;
  empresa = 0;
  path    = "";
  fecha   = @;
  varalf  = "";

  honorario = 0;
  suplido   = 0;
  acuenta   = 0;
  seccion   = "";
  concepto  = "";
  canti     = 0;
  import    = 0;
  tlinea    = 0;
  iva       = 0;
  linea     = 0;
  FEstado   = 0;
  conver    = "";
  conver1   = "";
  conver2   = "";

    &empre_f  = 0;
    &empre_p  = 0;
    &mes_p    = 0;
    &anyo_p   = 0;
    &fecha_p  = @;
    &tipo_p   = 0;
    &rete_p   = "";
    &tarifa   = 0;
    &s_130    = "";
    &sec_130  = "";
    &con_130  = "";
    &s_300    = "";
    &sec_300  = "";
    &con_300  = "";
    &trime_p  = 0;

|FIN;

|PROCESO pinta; |TIPO 7;
fecha = ~;
varalf = fecha % 402;
|SI varalf = "01"; |O varalf = "02"; |O varalf = "03"; varalf = "01"; |FINSI;
|SI varalf = "04"; |O varalf = "05"; |O varalf = "06"; varalf = "02"; |FINSI;
|SI varalf = "07"; |O varalf = "08"; |O varalf = "09"; varalf = "03"; |FINSI;
|SI varalf = "10"; |O varalf = "11"; |O varalf = "12"; varalf = "04"; |FINSI;
#0#2 = varalf;

varalf = fecha % 902;
#0#3 = varalf;
|PINTA #0#2;
|PINTA #0#3;
|FPRC;

|PROCESO linea;
linea = #7#2;
|FPRC;

|DEFBUCLE leelin;
#7#1;
;
#0#5, empre_f, 001;
#0#5, empre_f, 999;
e;
NULL, linea;
|FIN;

|PROCESO impresio;
|SI empre_p = 0;
    empre_f = #1#0;
    #4#0    = empre_f;
    |LEE 040#4=;
    |SI FSalida ! 0; |ACABA; |FINSI;

    s_130    = #4#2;
    sec_130  = #4#3;
    con_130  = #4#4;
    s_300    = #4#5;
    sec_300  = #4#6;
    con_300  = #4#7;
|FINSI;

|SI #1#5 [ 0; |ACABA; |FINSI;

|SI sw = 0; linea = 0; |BUCLE leelin; empresa = empre_f; sw = 1; |FINSI;

|SI empresa ! empre_f;
    |HAZ cabecera; empresa = empre_f; linea = 0; |BUCLE leelin;
|FINSI;

#3#0 = empre_f;
|LEE 040#3=;
|SI FSalida ! 0; |DDEFECTO #3; |FINSI;

|SI #1#3 = 300; |O #1#3 = 310; |O #1#3 = 370;
    |SI s_300 = "N"; |ACABA; |FINSI;
    seccion = sec_300; concepto = con_300;
|FINSI;

|SI #1#3 = 130; |O #1#3 = 131; |O #1#3 = 132;
    |SI s_130 = "N"; |ACABA; |FINSI;
    seccion = sec_130; concepto = con_130;
|FINSI;

|HAZ leeconc;

canti     = 1;
import    = #1#5;
tlinea    = #1#5;

#1#7 = "S";
|GRABA 140#1a;
|LIBERA #1;

|HAZ grabalin;
|FPRC;

|PROCESO leeconc;
    #2#0 = seccion; #2#1 = concepto;
    |LEE 040#2=;
    |SI FSalida ! 0; |DDEFECTO #2; |FINSI;
|FPRC;

|DEFBUCLE eossegui;
#1#1;
7;
#0#0, #0#3, #0#2, 000, 10, " ";
#0#1, #0#3, #0#2, 999, 99, "P";
be;
NULL, impresio;
|FIN;

|PROCESO grabalin;
|ABRE #7;

|SI linea = 0; |HAZ saldo_ant; |FINSI;

|HAZ leeconc;
linea = linea + 5;
#7#0  = #0#5;
#7#1  = empre_f;
#7#2  = linea;
|HAZ conver_fec;
#7#3  = conver;
#7#4  = seccion;
#7#5  = concepto;
#7#6  = #2#2;
#7#7  = #2#16;
#7#8  = #2#17;
#7#9  = #2#18;
#7#10 = #2#3;
#7#11 = canti;
#7#12 = import;
#7#13 = tlinea;
#7#14 = #2#5;
#7#15 = #0#4;
|GRABA 020#7n;
|LIBERA #7;
|CIERRA #7;
|FPRC;

|PROCESO conver_fec; |TIPO 0;
conver1 = #0#4 % 0102;
conver2 = #0#4 % 0402;
conver  = conver1 + conver2;
|FPRC;

|PROCESO saldo_ant;
|ABRE #8;
|LEE 040#8p;
|CIERRA #8;

|SI #8#32 ! "S"; |ACABA; |FINSI;

|SI #3#24 = 0;   |ACABA; |FINSI;

#2#0 = #8#33;
#2#1 = #8#34;
|LEE 040#2=;
|SI FSalida ! 0; |ACABA; |FINSI;
|SI #2#3 ! "A";  |ACABA; |FINSI;

linea = 5;
#7#0  = #0#5;
#7#1  = empre_f;
#7#2  = linea;
#7#3  = 0;
#7#4  = #2#0;
#7#5  = #2#1;
#7#6  = #2#2;
#7#7  = #2#16;
#7#8  = #2#17;
#7#9  = #2#18;
#7#10 = #2#3;
#7#11 = 1;
#7#12 = -#3#24;
#7#13 = -#3#24;
#7#14 = "G";
#7#15 = "00.00.0000";

|GRABA 040#7n;
|FPRC;

|PROCESO linealin;
|SI #7#10 = "H"; honorario = honorario + #7#13; |FINSI;
|SI #7#10 = "S"; suplido   = suplido   + #7#13; |FINSI;
|SI #7#10 = "A"; acuenta   = acuenta   + #7#13; |FINSI;
|FPRC;

|PROCESO cabecera;
|ABRE #6;
#6#0 = #0#5;
#6#1 = #3#0;
|LEE 101#6=;
FEstado = FSalida;

#6#0  = #0#5;
#6#1  = #3#0;
#6#2  = #3#1;
#6#3  = #3#2;
#6#4  = #3#3;
#6#5  = #3#4;
#6#6  = #3#5;
#6#7  = #3#6;
#6#8  = #3#7;
#6#9  = #3#8;
#6#10 = #3#15;
#6#11 = #3#16;
|SI #0#6 = "S"; #6#12 = #3#17; |SINO; #6#12 = "N"; |FINSI;
#6#13 = #3#11;
#6#14 = #3#12;
#6#15 = #3#13;
#6#16 = #3#14;

honorario = 0;
suplido   = 0;
acuenta   = 0;

|BUCLELIN 0linealin#6;

#6#17 = honorario;
#6#18 = suplido;
#6#19 = acuenta;
#6#20 = #3#23;
#6#21 = #6#17 % #6#20;
#6#22 = #6#17 - #6#21;
|HAZ iva;
#6#23 = #6#17 % iva;
#6#24 = #6#22 + #6#23 + #6#18;
|SI #6#12 = "S"; #6#25 = #6#22 % #8#31; |SINO; #6#25 = 0; |FINSI;
#6#26 = #6#24 - #6#19 - #6#25;
|SI FEstado = 0; |GRABA 020#6a; |SINO; |GRABA 020#6n; |FINSI;

|CIERRA #6;
|FPRC;

|PROCESO iva;
|ABRE #8;
|LEE 040#8p;
|SI FSalida ! 0; |DDEFECTO #8; |FINSI;
iva = 0;
|SI #6#0 = 0; iva = #8#21; |FINSI;
|SI #6#0 = 1; iva = #8#22; |FINSI;
|SI #6#0 = 2; iva = #8#23; |FINSI;
|SI #6#0 = 3; iva = #8#24; |FINSI;
|SI #6#0 = 4; iva = #8#25; |FINSI;
|SI #6#0 = 5; iva = #8#26; |FINSI;
|SI #6#0 = 6; iva = #8#27; |FINSI;
|SI #6#0 = 7; iva = #8#28; |FINSI;
|SI #6#0 = 8; iva = #8#29; |FINSI;
|SI #6#0 = 9; iva = #8#30; |FINSI;
|CIERRA #8;
|FPRC;

|PROCESO tipo_3;
|ABRE #5;
|LEE 040#5p;
|SI FSalida ! 0;
    |MENAV "    No existe directorio de R.E.O.";
    |ACABA;
|FINSI;
|CIERRA #5;

path = #5#3; |QBF path;
path = path + "fich/";

|PATH_DAT #1 path;

|ABRE #2;
|ABRE #3;
|ABRE #4;

|BUCLE eossegui;
|SI sw = 1; |HAZ cabecera; |FINSI;

|CIERRA #2;
|CIERRA #3;
|CIERRA #4;

|FININF;
|FINIMP;
|FPRC;

|PROGRAMA;
|SI empre_f = 0;
    |CLS;
    |CABEZA "Pase a Minuta R.E.O.";
    |DDEFECTO #0;
    |PINPA #0#0;
    |PINDA #0#0;
    |ENDATOS #1#0;
    |SI FSalida = 0; |HAZ tipo_3; |FINSI;
|SINO;
    #0#0 = empre_p
    #0#1 = empre_p
    #0#2 = trime_p;
    #0#3 = anyo_p;
    #0#4 = fecha_p;
    #0#5 = tipo_p;
    #0#6 = rete_p;
    |HAZ tipo_3;
|FINSI;
|FPRO;
