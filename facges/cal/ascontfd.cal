|FICHEROS;
    ascontfd #0;
    asconcep #1;
|FIN;

|VARIABLES;
    cab = "Control";
    men1 = "    NO EXISTE INFORME.";
    men2 = "    NO EXISTE IMPRESORA.";
    informe = "ascontfd";
    impri = "N";
    sino = "SN";
    si = "S";
    vacio = "                              ";
|FIN;

|PROGRAMA;
|CLS;
|PINPA #0#0;
|CABEZA cab;
    E_sup = 1;
    E_inf = sino;
    impri = 1769 ? 1;
|SI impri = si;
    |HAZ  ttcontro;
|FINSI;
|PINTA 1743,vacio;
|ABRE #0;
|DDEFECTO #0;
|LEE 101#0p;
|SI FSalida ! 0;
    |GRABA 020#0b;
|FINSI;
|PINDA #0#0;
|ENDATOS #1#0;
|SI FSalida = 0;
    |GRABA 020#0a;
|FINSI;
|LIBERA #0;
|CIERRA #0;
|FPRO;

|CALCULO ttcontro;
|ABRE #0;
|IMPRE 0;                                   ||Abre impresora.                ;
|SI FSalida = 0;                            ||? existe impresora.            ;
    |INFOR informe;                         ||Abre informe.                  ;
    |SI FSalida = 0;                        ||? existe informe               ;
        |LEE 040#0p;                        ||Lee el primer registro.        ;
        |SI FSalida = 0;
            |PRINT;                         ||Comienza informe.              ;
        |FINSI;
        |ET leer;                           ||Bucle de lectura e impresion.  ;
        |LEE 040#0s;
        |SI FSalida = 0;
            |PRINT;
            |VETE leer;
        |FINSI;                             ||Fin de fichero.                ;
        |PIEINF;                            ||Impresion final.               ;
        |FININF;                            ||Cierra informe.                ;
        |FINIMP;                            ||Cierra impresora.              ;
    |SINO;
        |MENAV men1;                        ||No informe.                    ;
    |FINSI;
|SINO;
    |MENAV men2;                            ||No impresora.                  ;
|FINSI;
|CIERRA #0;
|FCAL;

|PROCESO saldo; |TIPO 0;
|CAMPO_MODIFICA #0#33, 1, "S";
|CAMPO_MODIFICA #0#34, 1, "S";
|SI #0#32 = "N";
    |CAMPO_MODIFICA #0#33, 1, "N";
    |CAMPO_MODIFICA #0#34, 1, "N";
|FINSI;
|FPRC;

|PROCESO concepto; |TIPO 0;
|SI #0#33 = "    "; |Y #0#34 = "  "; |ACABA; |FINSI;

|ABRE #1;
#1#0 = #0#33;
#1#1 = #0#34;
|LEE 040#1=;
|SI FSalida ! 0;
    |MENAV "     No existe concepto ";
    |ERROR;
    |CIERRA #1;
    |ACABA;
|FINSI;

|SI #1#3 ! "A";
    |MENAV "     El concepto no es un A CUENTA ";
    |ERROR;
    |CIERRA #1;
    |ACABA;
|FINSI;
|CIERRA #1;
|FPRC;
