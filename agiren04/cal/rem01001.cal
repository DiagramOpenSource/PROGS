|FICHEROS;
     rem01000 #1000;
     rem01001 #1001;
     rem01002 #1002;
     rem01003 #1003;

     rew01003 #2003;
     rew01004 #2004;
     rew01005 #2005;
     rem00100 #100;
     reparame #99;
     reacceso #1;

     rem01001@;
|FIN;

|VARIABLES;
     aAlfa         = "";
     aTecla        = "";
     aMas          = "";

     nLinea        = 0;
     nCampo        = 0;
     nSwSeleccion  = 0;
     nValor        = 0;
     nResta        = 0;
     nIndi         = 0;
     nConj         = 0;
     nSwPrint      = 0;
     nCompensacion = 0;
     nAnterior     = 0;
     nHandle       = 0;
     nModo         = 0;

     &enEmpresa        = 0;
     &enModoLiq        = 0;
     &enSwRetorno      = 0;
     &eaPrograma       = "";
     &eaPunto          = "";
     &enSwPresenta     = 0;
     &enModo           = 0;
     &eaMuerto         = "";
     &enBloque         = 0;
     &eaCasilla        = "";
     &enImporte        = 0;
     &enSwAcum         = 0;
     &enDBloque        = 0;
     &enHBloque        = 99;
     &eaDCasilla       = "   ";
     &eaHCasilla       = "zzz";
     &enComplementaria = 0;
     &eaContri         = "";
     &enPatrimonio     = 0;
     &eaModoRenta      = "";
     &enDesdeRenta2004 = 0;
     &enDesdeRenta2005 = 0;
|FIN;

|PROCESO GrabaComple;
     |ABRE #1002;
     #1002#0 = #1001#0;
     #1002#1 = #1001#1;
     #1002#2 = #1001#2;
     #1002#3 = enBloque;
     #1002#4 = eaCasilla;
     |LEE 101#1002=;
     |SI FSalida = 0;
         |SI enSwAcum = 0;
             #1002#6 = enImporte;
         |SINO;
             #1002#6 = #1002#6 + enImporte;
         |FINSI;
         |GRABA 020#1002a;
     |FINSI;
     |LIBERA #1002;
     |CIERRA #1002;
|FPRC;

|PROCESO LeePatrimonio;
     |ABRE #1002;
     #1002#0 = #1001#0;
     #1002#1 = #1001#1;
     #1002#2 = #1001#2;
     #1002#3 = 30;
     #1002#4 = " 50";
     |LEE 000#1002=;
     |SI FSalida = 0;
         enImporte = #1002#6;
     |FINSI;
     |CIERRA #1002;
|FPRC;

|PROCESO PonDatosN;
     |SI #1001#2 = "CONJUNTA  ";  #2003#0 = #1001#15;            nLinea  = 1;  nIndi = 0;  nConj = 0; |FINSI;
     |SI #1001#2 = "TITULAR   ";  #2003#1 = #2003#1 + #1001#15;  nLinea  = 2;  |FINSI;
     |SI #1001#2 = "CONYUGE   ";  #2003#1 = #2003#1 + #1001#15;  nLinea  = 3;  nIndi = 0;  |FINSI;
     |SI #1001#2 = "1 FAMILIAR";  #2003#1 = #2003#1 + #1001#15;  nLinea  = 4;  nIndi = 0;  |FINSI;
     |SI #1001#2 = "2 FAMILIAR";  #2003#1 = #2003#1 + #1001#15;  nLinea  = 5;  nIndi = 0;  |FINSI;
     |SI #1001#2 = "3 FAMILIAR";  #2003#1 = #2003#1 + #1001#15;  nLinea  = 6;  nIndi = 0;  |FINSI;
     |SI #1001#2 = "4 FAMILIAR";  #2003#1 = #2003#1 + #1001#15;  nLinea  = 7;  nIndi = 0;  |FINSI;

     nCampo = ((nLinea - 1) * 9) + 4;  #2003nCampo = #1001#13;
     nCampo = nCampo + 1;              #2003nCampo = #1001#15;
     nCampo = nCampo + 1;              #2003nCampo = #1001#8;
     nCampo = nCampo + 1;              #2003nCampo = #1001#10;
     |SI #1001#8 = "S";
         nCampo = nCampo + 1;          #2003nCampo = #1001#15 % 60;
         nCampo = nCampo + 1;          #2003nCampo = #1001#15 % 40;
     |SINO;
         |SI #1001#15 > 0;
             nCampo = nCampo + 1;          #2003nCampo = #1001#15;
             nCampo = nCampo + 1;          #2003nCampo = 0;
         |SINO;
             nCampo = nCampo + 1;          #2003nCampo = 0;
             nCampo = nCampo + 1;          #2003nCampo = 0;
         |FINSI;
     |FINSI;
     nCampo = nCampo + 1;             #2003nCampo = "N";
     |SI #1001#11 = "X";  #2003nCampo = "S";  |FINSI;

     nCampo = nCampo + 1;             #2003nCampo = "N";
     |SI #1001#12 = "X";  #2003nCampo = "S";  |FINSI;

     nCampo = nCampo + 1;              #2003nCampo = #1001#9;

     #1001#5 = "";
     |GRABA 020#1001a;
     |LIBERA #1001;
|FPRC;

|PROCESO PonDatosP;
     |SI #1001#2 = "CONJUNTA  ";  #2005#1 = #1001#15;            nLinea  = 1;  |FINSI;
     |SI #1001#2 = "TITULAR   ";  #2005#0 = #2005#0 + #1001#15;  nLinea  = 2;  |FINSI;
     |SI #1001#2 = "CONYUGE   ";  #2005#0 = #2005#0 + #1001#15;  nLinea  = 3;  |FINSI;
     |SI #1001#2 = "1 FAMILIAR";  #2005#0 = #2005#0 + #1001#15;  nLinea  = 4;  |FINSI;
     |SI #1001#2 = "2 FAMILIAR";  #2005#0 = #2005#0 + #1001#15;  nLinea  = 5;  |FINSI;
     |SI #1001#2 = "3 FAMILIAR";  #2005#0 = #2005#0 + #1001#15;  nLinea  = 6;  |FINSI;
     |SI #1001#2 = "4 FAMILIAR";  #2005#0 = #2005#0 + #1001#15;  nLinea  = 7;  |FINSI;
     |SI #1001#2 = "CONJUNTAE ";  #2005#3 = #1001#15;            nLinea  = 8;  |FINSI;

     |SI #1001#2 = "TITULAR   ";  |Y eaMuerto = "T";
         #2005#2 =  #1001#15;
     |FINSI;

     |SI #1001#2 = "CONYUGE   ";  |Y eaMuerto = "C";
         #2005#2 =  #1001#15;
     |FINSI;

     nCampo = ((nLinea - 1) * 9) + 6;  #2005nCampo = #1001#13;
     nCampo = nCampo + 1;              #2005nCampo = #1001#15;
     nCampo = nCampo + 1;              #2005nCampo = #1001#8;
     nCampo = nCampo + 1;              #2005nCampo = #1001#10;
     |SI #1001#8 = "S";
         nCampo = nCampo + 1;          #2005nCampo = #1001#15 % 60;
         nCampo = nCampo + 1;          #2005nCampo = #1001#15 % 40;
     |SINO;
         |SI #1001#15 > 0;
             nCampo = nCampo + 1;          #2005nCampo = #1001#15;
             nCampo = nCampo + 1;          #2005nCampo = 0;
         |SINO;
             nCampo = nCampo + 1;          #2005nCampo = 0;
             nCampo = nCampo + 1;          #2005nCampo = 0;
         |FINSI;
     |FINSI;
     nCampo = nCampo + 1;             #2005nCampo = "N";
     |SI #1001#11 = "X";  #2005nCampo = "S";  |FINSI;

     nCampo = nCampo + 1;             #2005nCampo = "N";
     |SI #1001#12 = "X";  #2005nCampo = "S";  |FINSI;

     nCampo = nCampo + 1;              #2005nCampo = #1001#9;

     #2005#4 = #2005#2 + #2005#3;

     #1001#5 = "";
     |GRABA 020#1001a;
     |LIBERA #1001;
|FPRC;

|PROCESO PonDatos;
     |SI eaMuerto = "";
         |HAZ PonDatosN;
     |SINO;
         |HAZ PonDatosP;
     |FINSI;
|FPRC;

|DEFBUCLE rem01001;
     #1001#1;
     ;
     enEmpresa, 00, "          ";
     enEmpresa, 00, "Tzzzzzzzzz";
     be;
     NULL, PonDatos;
|FIN;

|PROCESO GrabaL;
     |DDEFECTO #1002;
     #1002#0 = enEmpresa;
     #1002#1 = enComplementaria;
     #1002#2 = eaContri;
     #1002#3 = #1000#0;
     #1002#4 = #1000#1;
     #1002#5 = #1000#2;
     |LEE 101#1002=;
     |SI FSalida = 0;
         |BORRA 020#1002a;
     |FINSI;

     |DDEFECTO #1002;
     #1002#0 = enEmpresa;
     #1002#1 = enComplementaria;
     #1002#2 = eaContri;
     #1002#3 = #1000#0;
     #1002#4 = #1000#1;
     #1002#5 = #1000#2;
     #1002#7 = #1000#3;
     |GRABA 020#1002n;
     |LIBERA #1002;
|FPRC;

|DEFBUCLE rem01000;
     #1000#1;
     ;
     enDBloque, eaDCasilla;
     enHBloque, eaHCasilla;
     ;
     NULL, GrabaL;
|FIN;

|PROCESO BorraL;
     |BORRA 020#1002a;
     |LIBERA #1002;
|FPRC;

|DEFBUCLE rem01002B;
     #1002#1;
     ;
     enEmpresa, 00, "          ", 32, "   ";
     enEmpresa, 00, "zzzzzzzzzz", 38, "zzz";
     be;
     NULL, BorraL;
|FIN;

|PROCESO Graba112;
     #1001#0 = enEmpresa;
     #1001#1 = enComplementaria;
     #1001#2 = eaContri;
     |LEE 101#1001=;
     |SI FSalida = 0;
         #1001#16 = enImporte;
         |SI enImporte = -9999999999; #1001#16 = #1001#3;  |FINSI;
         |GRABA 020#1001a;
         |LIBERA #1001;
     |FINSI;
|FPRC;

|PROCESO Compensaciones;
     |SI nCompensacion = 0;
         |BUCLE rem01002B;

         eaContri  = "TITULAR";
         enImporte = -9999999999;
         |HAZ Graba112;

         eaContri  = "CONYUGE";
         enImporte = -9999999999;
         |HAZ Graba112;

         |PONCONTROL 23, "SI";
         |PTEC 812;

         |ACABA;
     |FINSI;

     |SI #2003#14 > 0;
         enEmpresa        = #1001#0;
         enComplementaria = #1001#1;
         eaContri         = "TITULAR";

         enDBloque        = 32;
         enHBloque        = 32;
         eaDCasilla       = "1  ";
         eaHCasilla       = "1  ";
         |ABRE #1002;  |BUCLE rem01000;  |CIERRA #1002;

         enDBloque        = 33;
         enHBloque        = 35;
         eaDCasilla       = "   ";
         eaHCasilla       = "zzz";
         |ABRE #1002;  |BUCLE rem01000;  |CIERRA #1002;

         #1001#0 = enEmpresa;
         #1001#1 = 0;
         #1001#2 = "TITULAR   ";

         enImporte = #2003#14;
         enSwAcum  = 0; enBloque  = 33; eaCasilla = "a  "; |HAZ GrabaComple;

         enImporte = -#2003#23;
         enSwAcum  = 0; enBloque  = 33; eaCasilla = "b  "; |HAZ GrabaComple;

         nResta    = #2003#14 - (-#2003#23);
         |SI nResta > 0;
             enImporte = -#2003#23;
             enSwAcum  = 0; enBloque  = 34; eaCasilla = "768"; |HAZ GrabaComple;

             enImporte = nResta;
             enSwAcum  = 0; enBloque  = 34; eaCasilla = "770"; |HAZ GrabaComple;

             |HAZ Graba112;
         |SINO;
             enImporte = #2003#14;
             enSwAcum  = 0; enBloque  = 35; eaCasilla = "768"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 35; eaCasilla = "770"; |HAZ GrabaComple;

             |HAZ Graba112;
         |FINSI;
     |FINSI;

     |SI #2003#14 < 0;
         enEmpresa        = #1001#0;
         enComplementaria = #1001#1;
         eaContri         = "TITULAR";
         enDBloque        = 32;
         enHBloque        = 32;
         eaDCasilla       = "2  ";
         eaHCasilla       = "2  ";
         |ABRE #1002;  |BUCLE rem01000;  |CIERRA #1002;

         enDBloque        = 36;
         enHBloque        = 38;
         eaDCasilla       = "   ";
         eaHCasilla       = "zzz";
         |ABRE #1002;  |BUCLE rem01000;  |CIERRA #1002;

         #1001#0 = enEmpresa;
         #1001#1 = 0;
         #1001#2 = "TITULAR   ";

         enImporte = #2003#23;
         enSwAcum  = 0; enBloque  = 36; eaCasilla = "a  "; |HAZ GrabaComple;

         enImporte = -#2003#14;
         enSwAcum  = 0; enBloque  = 36; eaCasilla = "b  "; |HAZ GrabaComple;

         nResta    = #2003#23 - (-#2003#14);
         |SI nResta > 0;
             enImporte = -#2003#14;
             enSwAcum  = 0; enBloque  = 37; eaCasilla = "769"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 37; eaCasilla = "770"; |HAZ GrabaComple;

             |HAZ Graba112;
         |SINO;
             enImporte = #2003#23;
             enSwAcum  = 0; enBloque  = 38; eaCasilla = "769"; |HAZ GrabaComple;

             enImporte = nResta;
             enSwAcum  = 0; enBloque  = 38; eaCasilla = "770"; |HAZ GrabaComple;

             |HAZ Graba112;
         |FINSI;
     |FINSI;

     |SI #2003#23 > 0;
         enEmpresa        = #1001#0;
         enComplementaria = #1001#1;
         eaContri         = "CONYUGE";

         enDBloque        = 32;
         enHBloque        = 32;
         eaDCasilla       = "1  ";
         eaHCasilla       = "1  ";
         |ABRE #1002;  |BUCLE rem01000;  |CIERRA #1002;

         enDBloque        = 33;
         enHBloque        = 35;
         eaDCasilla       = "   ";
         eaHCasilla       = "zzz";
         |ABRE #1002;  |BUCLE rem01000;  |CIERRA #1002;

         #1001#0 = enEmpresa;
         #1001#1 = 0;
         #1001#2 = "CONYUGE   ";

         enImporte = #2003#23;
         enSwAcum  = 0; enBloque  = 33; eaCasilla = "a  "; |HAZ GrabaComple;

         enImporte = -#2003#14;
         enSwAcum  = 0; enBloque  = 33; eaCasilla = "b  "; |HAZ GrabaComple;

         nResta    = #2003#23 - (-#2003#14);
         |SI nResta > 0;
             enImporte = -#2003#14;
             enSwAcum  = 0; enBloque  = 34; eaCasilla = "768"; |HAZ GrabaComple;

             enImporte = nResta;
             enSwAcum  = 0; enBloque  = 34; eaCasilla = "770"; |HAZ GrabaComple;

             |HAZ Graba112;
         |SINO;
             enImporte = #2003#23;
             enSwAcum  = 0; enBloque  = 35; eaCasilla = "768"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 35; eaCasilla = "770"; |HAZ GrabaComple;

             |HAZ Graba112;
         |FINSI;
     |FINSI;

     |SI #2003#23 < 0;
         enEmpresa        = #1001#0;
         enComplementaria = #1001#1;
         eaContri         = "CONYUGE";
         enDBloque        = 32;
         enHBloque        = 32;
         eaDCasilla       = "2  ";
         eaHCasilla       = "2  ";
         |ABRE #1002;  |BUCLE rem01000;  |CIERRA #1002;

         enDBloque        = 36;
         enHBloque        = 38;
         eaDCasilla       = "   ";
         eaHCasilla       = "zzz";
         |ABRE #1002;  |BUCLE rem01000;  |CIERRA #1002;

         #1001#0 = enEmpresa;
         #1001#1 = 0;
         #1001#2 = "CONYUGE   ";

         enImporte = #2003#14;
         enSwAcum  = 0; enBloque  = 36; eaCasilla = "a  "; |HAZ GrabaComple;

         enImporte = -#2003#23;
         enSwAcum  = 0; enBloque  = 36; eaCasilla = "b  "; |HAZ GrabaComple;

         nResta    = #2003#14 - (-#2003#23);
         |SI nResta > 0;
             enImporte = -#2003#23;
             enSwAcum  = 0; enBloque  = 37; eaCasilla = "769"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 37; eaCasilla = "770"; |HAZ GrabaComple;

             |HAZ Graba112;
         |SINO;
             enImporte = #2003#14;
             enSwAcum  = 0; enBloque  = 38; eaCasilla = "769"; |HAZ GrabaComple;

             enImporte = nResta;
             enSwAcum  = 0; enBloque  = 38; eaCasilla = "770"; |HAZ GrabaComple;

             |HAZ Graba112;
         |FINSI;
     |FINSI;

     |PONCONTROL 23, "SI";
     |PTEC 812;
|FPRC;

|PROCESO SeleccionN;
     |PUSHV 0501 2380;
     |SALVA_FICHA #1001;

     |DDEFECTO #2003;
     nIndi = 1;
     nConj = 1;
     |BUCLE rem01001;

     |PINPA #0#2003;

     |ABRE #99;
     |LEE 040#99p;
     |SI FSalida ! 0;  |DDEFECTO #99;  |FINSI;
     |CIERRA #99;

     |SI nConj = 0;
         |C_M #2003#3, 1, "S";
         #2003#2 = "CONJUNTA";
         #2003#3 = "C";
     |SINO;
         #2003#2 = "SEPARADA";
         #2003#3 = "S";
     |FINSI;

     |SI #2003#1 < #2003#0;
         nResta = #2003#0 - #2003#1;
         |SI nResta [ 0;  nResta = -nResta;  |FINSI;
         |SI nResta [ #99#11;
             #2003#2 = "CONJUNTA";
             #2003#3 = "C";
         |SINO;
             #2003#2 = "SEPARADA";
             #2003#3 = "S";
         |FINSI;
     |FINSI;

     nValor = #2003#5 + #2003#14 + #2003#23 + #2003#32 + #2003#41 + #2003#50 + #2003#59;
     |SI nValor = #2003#14;  |Y nIndi = 1;
         #2003#2 = "INDIVIDUAL";
         #2003#3 = "I";
     |FINSI;

     |PINDA #0#2003;

     |ENDATOS #1#2003;
     |SI FSalida = 0;
         |DDEFECTO #2004;
         nSwSeleccion = 1;
         eaModoRenta  = "";
         |SI #2003#3 = "C";  eaModoRenta  = "C";  |FINSI;
         |SI #2003#4 ! "   ";
             #1001#0 = enEmpresa;
             #1001#1 = 0;
             #1001#2 = "CONJUNTA  ";
             |LEE 101#1001=;
             |SI FSalida = 0;
                 #1001#5  = #2003#4;
                 #1001#8  = #2003#6;
                 #1001#9  = #2003#12;
                 #1001#10 = #2003#7;
                 #1001#11 = " ";
                 #1001#12 = " ";
                 #1001#17 = #2003#67;
                 #1001#18 = #2003#74;
                 #1001#19 = #2003#75;
                 #1001#20 = #2003#76;
                 #1001#21 = #2003#77;
                 #1001#22 = #2003#78;
                 #1001#23 = #2003#79;
                 #1001#24 = #2003#80;
                 #1001#25 = #2003#81;
                 #1001#26 = #2003#82;
                 #1001#27 = #2003#83;
                 #1001#28 = #2003#84;
                 #1001#29 = #2003#85;
                 #1001#30 = #2003#86;
                 #1001#31 = #2003#87;
                 #1001#32 = #2003#88;
                 #1001#33 = #2003#89;
                 #1001#34 = #2003#90;
                 #1001#35 = #2003#91;

                 |SI #2003#10 = "S";  #1001#11 = "X";  |FINSI;
                 |SI #2003#11 = "S";  #1001#12 = "X";  |FINSI;
                 |GRABA 020#1001a;
                 |LIBERA #1001;

                 #2004#0  = #100#97;
                 #2004#1  = #1001#5;
                 #2004#2  = #1001#15;
             |FINSI;
         |FINSI;

         |SI #2003#13 ! "   ";
             #1001#0 = enEmpresa;
             #1001#1 = 0;
             #1001#2 = "TITULAR   ";
             |LEE 101#1001=;
             |SI FSalida = 0;
                 #1001#5  = #2003#13;    || Modelo
                 #1001#8  = #2003#15;    || Modelo 102
                 #1001#9  = #2003#21;    || Pago Efectivo
                 #1001#10 = #2003#16;    || 102 Domiciliado
                 #1001#11 = " ";
                 #1001#12 = " ";
                 #1001#17 = #2003#68;
                 #1001#18 = #2003#92;
                 #1001#19 = #2003#93;
                 #1001#20 = #2003#94;
                 #1001#21 = #2003#95;
                 #1001#22 = #2003#96;
                 #1001#23 = #2003#97;
                 #1001#24 = #2003#98;
                 #1001#25 = #2003#99;
                 #1001#26 = #2003#100;
                 #1001#27 = #2003#101;
                 #1001#28 = #2003#102;
                 #1001#29 = #2003#103;
                 #1001#30 = #2003#104;
                 #1001#31 = #2003#105;
                 #1001#32 = #2003#106;
                 #1001#33 = #2003#107;
                 #1001#34 = #2003#108;
                 #1001#35 = #2003#109;

                 |SI #2003#19 = "S";  #1001#11 = "X";  |FINSI;
                 |SI #2003#20 = "S";  #1001#12 = "X";  |FINSI;
                 |GRABA 020#1001a;
                 |LIBERA #1001;

                 #2004#12 = #100#97;
                 #2004#13 = #1001#5;
                 #2004#14 = #1001#15;
             |FINSI;
         |FINSI;

         |SI #2003#22 ! "   ";
             #1001#0 = enEmpresa;
             #1001#1 = 0;
             #1001#2 = "CONYUGE   ";
             |LEE 101#1001=;
             |SI FSalida = 0;
                 #1001#5  = #2003#22;    || Modelo
                 #1001#8  = #2003#24;    || Modelo 102
                 #1001#9  = #2003#30;    || Pago Efectivo
                 #1001#10 = #2003#25;    || 102 Domiciliado
                 #1001#11 = " ";
                 #1001#12 = " ";
                 #1001#17 = #2003#69;
                 #1001#18 = #2003#110;
                 #1001#19 = #2003#111;
                 #1001#20 = #2003#112;
                 #1001#21 = #2003#113;
                 #1001#22 = #2003#114;
                 #1001#23 = #2003#115;
                 #1001#24 = #2003#116;
                 #1001#25 = #2003#117;
                 #1001#26 = #2003#118;
                 #1001#27 = #2003#119;
                 #1001#28 = #2003#120;
                 #1001#29 = #2003#121;
                 #1001#30 = #2003#122;
                 #1001#31 = #2003#123;
                 #1001#32 = #2003#124;
                 #1001#33 = #2003#125;
                 #1001#34 = #2003#126;
                 #1001#35 = #2003#127;

                 |SI #2003#28 = "S";  #1001#11 = "X";  |FINSI;
                 |SI #2003#29 = "S";  #1001#12 = "X";  |FINSI;
                 |GRABA 020#1001a;
                 |LIBERA #1001;

                 #2004#18 = #100#97;
                 #2004#19 = #1001#5;
                 #2004#20 = #1001#15;
             |FINSI;
         |FINSI;

         |SI #2003#31 ! "   ";
             #1001#0 = enEmpresa;
             #1001#1 = 0;
             #1001#2 = "1 FAMILIAR";
             |LEE 101#1001=;
             |SI FSalida = 0;
                 #1001#5  = #2003#31;    || Modelo
                 #1001#8  = #2003#33;    || Modelo 102
                 #1001#9  = #2003#39;    || Pago Efectivo
                 #1001#10 = #2003#34;    || 102 Domiciliado
                 #1001#11 = " ";
                 #1001#12 = " ";
                 #1001#17 = #2003#70;
                 #1001#18 = #2003#128;
                 #1001#19 = #2003#129;
                 #1001#20 = #2003#130;
                 #1001#21 = #2003#131;
                 #1001#22 = #2003#132;
                 #1001#23 = #2003#133;
                 #1001#24 = #2003#134;
                 #1001#25 = #2003#135;
                 #1001#26 = #2003#136;
                 #1001#27 = #2003#137;
                 #1001#28 = #2003#138;
                 #1001#29 = #2003#139;
                 #1001#30 = #2003#140;
                 #1001#31 = #2003#141;
                 #1001#32 = #2003#142;
                 #1001#33 = #2003#143;
                 #1001#34 = #2003#144;
                 #1001#35 = #2003#145;

                 |SI #2003#37 = "S";  #1001#11 = "X";  |FINSI;
                 |SI #2003#38 = "S";  #1001#12 = "X";  |FINSI;
                 |GRABA 020#1001a;
                 |LIBERA #1001;

                 #2004#24 = #100#97;
                 #2004#25 = #1001#5;
                 #2004#26 = #1001#15;
             |FINSI;
         |FINSI;

         |SI #2003#40 ! "   ";
             #1001#0 = enEmpresa;
             #1001#1 = 0;
             #1001#2 = "2 FAMILIAR";
             |LEE 101#1001=;
             |SI FSalida = 0;
                 #1001#5  = #2003#40;    || Modelo
                 #1001#8  = #2003#42;    || Modelo 102
                 #1001#9  = #2003#48;    || Pago Efectivo
                 #1001#10 = #2003#43;    || 102 Domiciliado
                 #1001#11 = " ";
                 #1001#12 = " ";
                 #1001#17 = #2003#71;
                 #1001#18 = #2003#146;
                 #1001#19 = #2003#147;
                 #1001#20 = #2003#148;
                 #1001#21 = #2003#149;
                 #1001#22 = #2003#150;
                 #1001#23 = #2003#151;
                 #1001#24 = #2003#152;
                 #1001#25 = #2003#153;
                 #1001#26 = #2003#154;
                 #1001#27 = #2003#155;
                 #1001#28 = #2003#156;
                 #1001#29 = #2003#157;
                 #1001#30 = #2003#158;
                 #1001#31 = #2003#159;
                 #1001#32 = #2003#160;
                 #1001#33 = #2003#161;
                 #1001#34 = #2003#162;
                 #1001#35 = #2003#163;

                 |SI #2003#46 = "S";  #1001#11 = "X";  |FINSI;
                 |SI #2003#47 = "S";  #1001#12 = "X";  |FINSI;
                 |GRABA 020#1001a;
                 |LIBERA #1001;

                 #2004#30 = #100#97;
                 #2004#31 = #1001#5;
                 #2004#32 = #1001#15;
             |FINSI;
         |FINSI;

         |SI #2003#49 ! "   ";
             #1001#0 = enEmpresa;
             #1001#1 = 0;
             #1001#2 = "3 FAMILIAR";
             |LEE 101#1001=;
             |SI FSalida = 0;
                 #1001#5  = #2003#49;    || Modelo
                 #1001#8  = #2003#51;    || Modelo 102
                 #1001#9  = #2003#57;    || Pago Efectivo
                 #1001#10 = #2003#52;    || 102 Domiciliado
                 #1001#11 = " ";
                 #1001#12 = " ";
                 #1001#17 = #2003#72;
                 #1001#18 = #2003#164;
                 #1001#19 = #2003#165;
                 #1001#20 = #2003#166;
                 #1001#21 = #2003#167;
                 #1001#22 = #2003#168;
                 #1001#23 = #2003#169;
                 #1001#24 = #2003#170;
                 #1001#25 = #2003#171;
                 #1001#26 = #2003#172;
                 #1001#27 = #2003#173;
                 #1001#28 = #2003#174;
                 #1001#29 = #2003#175;
                 #1001#30 = #2003#176;
                 #1001#31 = #2003#177;
                 #1001#32 = #2003#178;
                 #1001#33 = #2003#179;
                 #1001#34 = #2003#180;
                 #1001#35 = #2003#181;

                 |SI #2003#55 = "S";  #1001#11 = "X";  |FINSI;
                 |SI #2003#56 = "S";  #1001#12 = "X";  |FINSI;
                 |GRABA 020#1001a;
                 |LIBERA #1001;

                 #2004#36 = #100#97;
                 #2004#37 = #1001#5;
                 #2004#38 = #1001#15;
             |FINSI;
         |FINSI;

         |SI #2003#58 ! "   ";
             #1001#0 = enEmpresa;
             #1001#1 = 0;
             #1001#2 = "4 FAMILIAR";
             |LEE 101#1001=;
             |SI FSalida = 0;
                 #1001#5  = #2003#58;    || Modelo
                 #1001#8  = #2003#60;    || Modelo 102
                 #1001#9  = #2003#66;    || Pago Efectivo
                 #1001#10 = #2003#61;    || 102 Domiciliado
                 #1001#11 = " ";
                 #1001#12 = " ";
                 #1001#17 = #2003#73;
                 #1001#18 = #2003#182;
                 #1001#19 = #2003#183;
                 #1001#20 = #2003#184;
                 #1001#21 = #2003#185;
                 #1001#22 = #2003#186;
                 #1001#23 = #2003#187;
                 #1001#24 = #2003#188;
                 #1001#25 = #2003#189;
                 #1001#26 = #2003#190;
                 #1001#27 = #2003#191;
                 #1001#28 = #2003#192;
                 #1001#29 = #2003#193;
                 #1001#30 = #2003#194;
                 #1001#31 = #2003#195;
                 #1001#32 = #2003#196;
                 #1001#33 = #2003#197;
                 #1001#34 = #2003#198;
                 #1001#35 = #2003#199;

                 |SI #2003#64 = "S";  #1001#11 = "X";  |FINSI;
                 |SI #2003#65 = "S";  #1001#12 = "X";  |FINSI;
                 |GRABA 020#1001a;
                 |LIBERA #1001;

                 #2004#42 = #100#97;
                 #2004#43 = #1001#5;
                 #2004#44 = #1001#15;
             |FINSI;
         |FINSI;

         |ABRE #100;
         #100#0 = enEmpresa;
         |LEE 101#100=;
         |SI FSalida = 0;
             #100#56 = " ";
             #100#57 = " ";
             #100#58 = " ";
             |SI #2003#3 = "I";  #100#56 = "X";  |FINSI;
             |SI #2003#3 = "S";  #100#58 = "X";  |FINSI;
             |SI #2003#3 = "C";  #100#57 = "X";  |FINSI;
             |GRABA 020#100a;
             |LIBERA #100;
         |FINSI;
         |CIERRA #100;

         nCompensacion = 0;
         |SI #2003#13 ! "   ";  |Y  #2003#22 ! "   ";  |Y #100#97 = "N";
             |SI #2003#14 > 0;  |Y #2003#23 < 0;
                 |CONFI "0000SDesea activar la Compensacion entre Conyuges";
                 |SI FSalida = 0;  nCompensacion = 1;  |FINSI;
             |FINSI;

             |SI #2003#14 < 0;  |Y #2003#23 > 0;
                 |CONFI "0000SDesea activar la Compensacion entre Conyuges";
                 |SI FSalida = 0;  nCompensacion = 1;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |REPON_FICHA #1001;
     |POPV;

     |HAZ Compensaciones;
|FPRC;

|PROCESO SeleccionP;
     |PUSHV 0501 2380;
     |SALVA_FICHA #1001;

     |DDEFECTO #2005;

     |BUCLE rem01001;

     |PINPA #0#2005;
     |PINDA #0#2005;

     |ENDATOS #1#2005;
     |SI FSalida = 0;
         |DDEFECTO #2004;
         nSwSeleccion = 1;
         eaModoRenta  = "";
         |SI #2005#6 ! "   ";
             #1001#0 = enEmpresa;
             #1001#1 = 0;
             #1001#2 = "CONJUNTA  ";
             |LEE 101#1001=;
             |SI FSalida = 0;
                 #1001#5  = #2005#6;
                 #1001#8  = #2005#8;
                 #1001#9  = #2005#14;
                 #1001#10 = #2005#9;
                 #1001#11 = " ";
                 #1001#12 = " ";
                 #1001#17 = #2005#78;
                 |SI #2005#12 = "S";  #1001#11 = "X";  |FINSI;
                 |SI #2005#13 = "S";  #1001#12 = "X";  |FINSI;
                 |GRABA 020#1001a;
                 |LIBERA #1001;

                 #2004#0  = #100#97;
                 #2004#1  = #1001#5;
                 #2004#2  = #1001#15;
             |FINSI;
         |FINSI;

         |SI #2005#15 ! "   ";
             #1001#0 = enEmpresa;
             #1001#1 = 0;
             #1001#2 = "TITULAR   ";
             |LEE 101#1001=;
             |SI FSalida = 0;
                 #1001#5  = #2005#15;    || Modelo
                 #1001#8  = #2005#17;    || Modelo 102
                 #1001#9  = #2005#23;    || Pago Efectivo
                 #1001#10 = #2005#18;    || 102 Domiciliado
                 #1001#11 = " ";
                 #1001#12 = " ";
                 #1001#17 = #2005#79;
                 |SI #2005#21 = "S";  #1001#11 = "X";  |FINSI;
                 |SI #2005#22 = "S";  #1001#12 = "X";  |FINSI;
                 |GRABA 020#1001a;
                 |LIBERA #1001;

                 #2004#12 = #100#97;
                 #2004#13 = #1001#5;
                 #2004#14 = #1001#15;
             |FINSI;
         |FINSI;

         |SI #2005#24 ! "   ";
             #1001#0 = enEmpresa;
             #1001#1 = 0;
             #1001#2 = "CONYUGE   ";
             |LEE 101#1001=;
             |SI FSalida = 0;
                 #1001#5  = #2005#24;    || Modelo
                 #1001#8  = #2005#26;    || Modelo 102
                 #1001#9  = #2005#32;    || Pago Efectivo
                 #1001#10 = #2005#27;    || 102 Domiciliado
                 #1001#11 = " ";
                 #1001#12 = " ";
                 #1001#17 = #2005#80;
                 |SI #2005#30 = "S";  #1001#11 = "X";  |FINSI;
                 |SI #2005#31 = "S";  #1001#12 = "X";  |FINSI;
                 |GRABA 020#1001a;
                 |LIBERA #1001;

                 #2004#18 = #100#97;
                 #2004#19 = #1001#5;
                 #2004#20 = #1001#15;
             |FINSI;
         |FINSI;

         |SI #2005#33 ! "   ";
             #1001#0 = enEmpresa;
             #1001#1 = 0;
             #1001#2 = "1 FAMILIAR";
             |LEE 101#1001=;
             |SI FSalida = 0;
                 #1001#5  = #2005#33;    || Modelo
                 #1001#8  = #2005#35;    || Modelo 102
                 #1001#9  = #2005#41;    || Pago Efectivo
                 #1001#10 = #2005#36;    || 102 Domiciliado
                 #1001#11 = " ";
                 #1001#12 = " ";
                 #1001#17 = #2005#81;
                 |SI #2005#39 = "S";  #1001#11 = "X";  |FINSI;
                 |SI #2005#40 = "S";  #1001#12 = "X";  |FINSI;
                 |GRABA 020#1001a;
                 |LIBERA #1001;

                 #2004#24 = #100#97;
                 #2004#25 = #1001#5;
                 #2004#26 = #1001#15;
             |FINSI;
         |FINSI;

         |SI #2005#42 ! "   ";
             #1001#0 = enEmpresa;
             #1001#1 = 0;
             #1001#2 = "2 FAMILIAR";
             |LEE 101#1001=;
             |SI FSalida = 0;
                 #1001#5  = #2005#42;    || Modelo
                 #1001#8  = #2005#44;    || Modelo 102
                 #1001#9  = #2005#50;    || Pago Efectivo
                 #1001#10 = #2005#45;    || 102 Domiciliado
                 #1001#11 = " ";
                 #1001#12 = " ";
                 #1001#17 = #2005#82;
                 |SI #2005#48 = "S";  #1001#11 = "X";  |FINSI;
                 |SI #2005#49 = "S";  #1001#12 = "X";  |FINSI;
                 |GRABA 020#1001a;
                 |LIBERA #1001;

                 #2004#30 = #100#97;
                 #2004#31 = #1001#5;
                 #2004#32 = #1001#15;
             |FINSI;
         |FINSI;

         |SI #2005#51 ! "   ";
             #1001#0 = enEmpresa;
             #1001#1 = 0;
             #1001#2 = "3 FAMILIAR";
             |LEE 101#1001=;
             |SI FSalida = 0;
                 #1001#5  = #2005#51;    || Modelo
                 #1001#8  = #2005#53;    || Modelo 102
                 #1001#9  = #2005#59;    || Pago Efectivo
                 #1001#10 = #2005#54;    || 102 Domiciliado
                 #1001#11 = " ";
                 #1001#12 = " ";
                 #1001#17 = #2005#83;
                 |SI #2005#57 = "S";  #1001#11 = "X";  |FINSI;
                 |SI #2005#58 = "S";  #1001#12 = "X";  |FINSI;
                 |GRABA 020#1001a;
                 |LIBERA #1001;

                 #2004#36 = #100#97;
                 #2004#37 = #1001#5;
                 #2004#38 = #1001#15;
             |FINSI;
         |FINSI;

         |SI #2005#60 ! "   ";
             #1001#0 = enEmpresa;
             #1001#1 = 0;
             #1001#2 = "4 FAMILIAR";
             |LEE 101#1001=;
             |SI FSalida = 0;
                 #1001#5  = #2005#60;    || Modelo
                 #1001#8  = #2005#62;    || Modelo 102
                 #1001#9  = #2005#68;    || Pago Efectivo
                 #1001#10 = #2005#63;    || 102 Domiciliado
                 #1001#11 = " ";
                 #1001#12 = " ";
                 #1001#17 = #2005#84;
                 |SI #2005#66 = "S";  #1001#11 = "X";  |FINSI;
                 |SI #2005#67 = "S";  #1001#12 = "X";  |FINSI;
                 |GRABA 020#1001a;
                 |LIBERA #1001;

                 #2004#42 = #100#97;
                 #2004#43 = #1001#5;
                 #2004#44 = #1001#15;
             |FINSI;
         |FINSI;

         |SI #2005#69 ! "   ";
             #1001#0 = enEmpresa;
             #1001#1 = 0;
             #1001#2 = "CONJUNTAE ";
             |LEE 101#1001=;
             |SI FSalida = 0;
                 #1001#5  = #2005#69;    || Modelo
                 #1001#8  = #2005#71;    || Modelo 102
                 #1001#9  = #2005#77;    || Pago Efectivo
                 #1001#10 = #2005#72;    || 102 Domiciliado
                 #1001#11 = " ";
                 #1001#12 = " ";
                 #1001#17 = #2005#85;
                 |SI #2005#75 = "S";  #1001#11 = "X";  |FINSI;
                 |SI #2005#76 = "S";  #1001#12 = "X";  |FINSI;
                 |GRABA 020#1001a;
                 |LIBERA #1001;

                 #2004#6  = #100#97;
                 #2004#7  = #1001#5;
                 #2004#8  = #1001#15;
             |FINSI;
         |FINSI;

         |ABRE #100;
         #100#0 = enEmpresa;
         |LEE 101#100=;
         |SI FSalida = 0;
             #100#56 = " ";
             #100#57 = " ";
             #100#58 = " ";
             |SI #2005#5 = "A";  #100#56 = "X";  |FINSI;
             |SI #2005#5 = "B";  #100#57 = "X";  |FINSI;
             |SI #2005#5 = "C";  #100#57 = "X";  |FINSI;
             |GRABA 020#100a;
             |LIBERA #100;
         |FINSI;
         |CIERRA #100;
     |FINSI;

     |REPON_FICHA #1001;
     |POPV;
|FPRC;

|PROCESO DatosComplementaria;
     |SALVA_FICHA #1001;

     |PUSHV 0501 2380;
     |PARA; |SI; |HACIENDO;
            |PINPA #0#2004;
            |PINDA #0#2004;
            |ENDATOS #1#2004;
            |SI FSalida = 0;  |SAL;  |FINSI;
     |SIGUE;
     |POPV;

     |SI #2004#0 ! "N";  |Y #2004#0 ! "3";
         #1001#0 = enEmpresa;
         #1001#1 = 0;
         #1001#2 = "CONJUNTA  ";
         |LEE 101#1001=;
         |SI FSalida = 0;
             #1001#3  = #2004#5;
             #1001#16 = #2004#5;
             #1001#5  = "100";
             #1001#8  = "N";
             #1001#10 = "N";
             #1001#14 = #2004#0;
             |GRABA 020#1001a;
             |LIBERA #1001;

             enImporte = #2004#3;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "761"; |HAZ GrabaComple;

             enImporte = #2004#4;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "762"; |HAZ GrabaComple;

             enImporte = #2004#5;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "765"; |HAZ GrabaComple;
         |FINSI;
     |SINO;
         #1001#0 = enEmpresa;
         #1001#1 = 0;
         #1001#2 = "CONJUNTA  ";
         |LEE 101#1001=;
         |SI FSalida = 0;
             #1001#3  = #1001#15;
             #1001#16 = #1001#15;
             |GRABA 020#1001a;
             |LIBERA #1001;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "761"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "762"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "765"; |HAZ GrabaComple;
         |FINSI;
     |FINSI;

     |SI #2004#12 ! "N";  |Y #2004#12 ! "3";
         #1001#0 = enEmpresa;
         #1001#1 = 0;
         #1001#2 = "TITULAR   ";
         |LEE 101#1001=;
         |SI FSalida = 0;
             #1001#3  = #2004#17;
             #1001#16 = #2004#17;
             #1001#5  = "100";
             #1001#8  = "N";
             #1001#10 = "N";
             #1001#14 = #2004#12;
             |GRABA 020#1001a;
             |LIBERA #1001;

             enImporte = #2004#15;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "761"; |HAZ GrabaComple;

             enImporte = #2004#16;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "762"; |HAZ GrabaComple;

             enImporte = #2004#17;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "765"; |HAZ GrabaComple;
         |FINSI;
     |SINO;
         #1001#0 = enEmpresa;
         #1001#1 = 0;
         #1001#2 = "TITULAR   ";
         |LEE 101#1001=;
         |SI FSalida = 0;
             #1001#3  = #1001#15;
             #1001#16 = #1001#15;
             |GRABA 020#1001a;
             |LIBERA #1001;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "761"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "762"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "765"; |HAZ GrabaComple;
         |FINSI;
     |FINSI;

     |SI #2004#18 ! "N";  |Y #2004#18 ! "3";
         #1001#0 = enEmpresa;
         #1001#1 = 0;
         #1001#2 = "CONYUGE   ";
         |LEE 101#1001=;
         |SI FSalida = 0;
             #1001#3  = #2004#23;
             #1001#16 = #2004#23;
             #1001#5  = "100";
             #1001#8  = "N";
             #1001#10 = "N";
             #1001#14 = #2004#18;
             |GRABA 020#1001a;
             |LIBERA #1001;

             enImporte = #2004#21;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "761"; |HAZ GrabaComple;

             enImporte = #2004#22;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "762"; |HAZ GrabaComple;

             enImporte = #2004#23;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "765"; |HAZ GrabaComple;
         |FINSI;
     |SINO;
         #1001#0 = enEmpresa;
         #1001#1 = 0;
         #1001#2 = "CONYUGE   ";
         |LEE 101#1001=;
         |SI FSalida = 0;
             #1001#3  = #1001#15;
             #1001#16 = #1001#15;
             |GRABA 020#1001a;
             |LIBERA #1001;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "761"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "762"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "765"; |HAZ GrabaComple;
         |FINSI;
     |FINSI;

     |SI #2004#24 ! "N";  |Y #2004#24 ! "3";
         #1001#0 = enEmpresa;
         #1001#1 = 0;
         #1001#2 = "1 FAMILIAR";
         |LEE 101#1001=;
         |SI FSalida = 0;
             #1001#3  = #2004#29;
             #1001#16 = #2004#29;
             #1001#5  = "100";
             #1001#8  = "N";
             #1001#10 = "N";
             #1001#14 = #2004#24;
             |GRABA 020#1001a;
             |LIBERA #1001;

             enImporte = #2004#27;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "761"; |HAZ GrabaComple;

             enImporte = #2004#28;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "762"; |HAZ GrabaComple;

             enImporte = #2004#29;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "765"; |HAZ GrabaComple;
         |FINSI;
     |SINO;
         #1001#0 = enEmpresa;
         #1001#1 = 0;
         #1001#2 = "1 FAMILIAR";
         |LEE 101#1001=;
         |SI FSalida = 0;
             #1001#3  = #1001#15;
             #1001#16 = #1001#15;
             |GRABA 020#1001a;
             |LIBERA #1001;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "761"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "762"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "765"; |HAZ GrabaComple;
         |FINSI;
     |FINSI;

     |SI #2004#30 ! "N";  |Y #2004#30 ! "3";
         #1001#0 = enEmpresa;
         #1001#1 = 0;
         #1001#2 = "2 FAMILIAR";
         |LEE 101#1001=;
         |SI FSalida = 0;
             #1001#3  = #2004#35;
             #1001#16 = #2004#35;
             #1001#5  = "100";
             #1001#8  = "N";
             #1001#10 = "N";
             #1001#14 = #2004#30;
             |GRABA 020#1001a;
             |LIBERA #1001;

             enImporte = #2004#33;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "761"; |HAZ GrabaComple;

             enImporte = #2004#34;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "762"; |HAZ GrabaComple;

             enImporte = #2004#35;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "765"; |HAZ GrabaComple;
         |FINSI;
     |SINO;
         #1001#0 = enEmpresa;
         #1001#1 = 0;
         #1001#2 = "2 FAMILIAR";
         |LEE 101#1001=;
         |SI FSalida = 0;
             #1001#3  = #1001#15;
             #1001#16 = #1001#15;
             |GRABA 020#1001a;
             |LIBERA #1001;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "761"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "762"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "765"; |HAZ GrabaComple;
         |FINSI;
     |FINSI;

     |SI #2004#36 ! "N";  |Y #2004#36 ! "3";
         #1001#0 = enEmpresa;
         #1001#1 = 0;
         #1001#2 = "3 FAMILIAR";
         |LEE 101#1001=;
         |SI FSalida = 0;
             #1001#3  = #2004#41;
             #1001#16 = #2004#41;
             #1001#5  = "100";
             #1001#8  = "N";
             #1001#10 = "N";
             #1001#14 = #2004#36;
             |GRABA 020#1001a;
             |LIBERA #1001;

             enImporte = #2004#39;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "761"; |HAZ GrabaComple;

             enImporte = #2004#40;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "762"; |HAZ GrabaComple;

             enImporte = #2004#41;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "765"; |HAZ GrabaComple;
         |FINSI;
     |SINO;
         #1001#0 = enEmpresa;
         #1001#1 = 0;
         #1001#2 = "3 FAMILIAR";
         |LEE 101#1001=;
         |SI FSalida = 0;
             #1001#3  = #1001#15;
             #1001#16 = #1001#15;
             |GRABA 020#1001a;
             |LIBERA #1001;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "761"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "762"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "765"; |HAZ GrabaComple;
         |FINSI;
     |FINSI;

     |SI #2004#42 ! "N";  |Y #2004#42 ! "3";
         #1001#0 = enEmpresa;
         #1001#1 = 0;
         #1001#2 = "4 FAMILIAR";
         |LEE 101#1001=;
         |SI FSalida = 0;
             #1001#3  = #2004#47;
             #1001#16 = #2004#47;
             #1001#5  = "100";
             #1001#8  = "N";
             #1001#10 = "N";
             #1001#14 = #2004#42;
             |GRABA 020#1001a;
             |LIBERA #1001;

             enImporte = #2004#45;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "761"; |HAZ GrabaComple;

             enImporte = #2004#46;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "762"; |HAZ GrabaComple;

             enImporte = #2004#47;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "765"; |HAZ GrabaComple;
         |FINSI;
     |SINO;
         #1001#0 = enEmpresa;
         #1001#1 = 0;
         #1001#2 = "4 FAMILIAR";
         |LEE 101#1001=;
         |SI FSalida = 0;
             #1001#3  = #1001#15;
             #1001#16 = #1001#15;
             |GRABA 020#1001a;
             |LIBERA #1001;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "761"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "762"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "765"; |HAZ GrabaComple;
         |FINSI;
     |FINSI;

     |SI #2004#6 ! "N";   |Y #2004#6 ! "3";
         #1001#0 = enEmpresa;
         #1001#1 = 0;
         #1001#2 = "CONJUNTAE ";
         |LEE 101#1001=;
         |SI FSalida = 0;
             #1001#3  = #2004#11;
             #1001#16 = #2004#11;
             #1001#5  = "100";
             #1001#8  = "N";
             #1001#10 = "N";
             #1001#14 = #2004#6;
             |GRABA 020#1001a;
             |LIBERA #1001;

             enImporte = #2004#9;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "761"; |HAZ GrabaComple;

             enImporte = #2004#10;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "762"; |HAZ GrabaComple;

             enImporte = #2004#11;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "765"; |HAZ GrabaComple;
         |FINSI;
     |SINO;
         #1001#0 = enEmpresa;
         #1001#1 = 0;
         #1001#2 = "CONJUNTAE ";
         |LEE 101#1001=;
         |SI FSalida = 0;
             #1001#3  = #1001#15;
             #1001#16 = #1001#15;
             |GRABA 020#1001a;
             |LIBERA #1001;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "761"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "762"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; enBloque  = 31; eaCasilla = "765"; |HAZ GrabaComple;
         |FINSI;
     |FINSI;

     |REPON_FICHA #1001;
|FPRC;

|PROCESO Seleccion;
     |ABRE #100;
     #100#0 = enEmpresa;
     |LEE 040#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;
     |CIERRA #100;

     |SI eaMuerto = "";
         |HAZ SeleccionN;
     |SINO;
         |HAZ SeleccionP;
     |FINSI;

     enPatrimonio = 1;
     |SUB_EJECUTA_NP "rezcalcu";
     enPatrimonio = 0;

     |ABRE #100;
     #100#0 = enEmpresa;
     |LEE 040#100=;
     |SI FSalida = 0;  |Y #100#97 ! "N";  |Y nSwSeleccion = 1;
         |HAZ DatosComplementaria;
     |FINSI;
     |CIERRA #100;
|FPRC;

|RUTINA ClaveBaja1002;
     #1002#0 = #1001#0;
     #1002#1 = #1001#1;
     #1002#2 = #1001#2;
     #1002#3 = 00;
     #1002#4 = "   ";
|FRUT;

|RUTINA ClaveAlta1002;
     #1002#0 = #1001#0;
     #1002#1 = #1001#1;
     #1002#2 = #1001#2;
     #1002#3 = 99;
     #1002#4 = "zzz";
|FRUT;

|PROCESO Tipo7;  |TIPO 7;
     |ENTLINEAL #1#1002, 5, 7, 22, 0, ClaveBaja1002, ClaveAlta1002;
|FPRC;

|PROCESO ImpreLiqui;
     |PRINT;
     nSwPrint = 1;
|FPRC;

|DEFBUCLE rem01002;
     #1002#1;
     ;
     #1001#0, #1001#1, #1001#2, 00, "   ";
     #1001#0, #1001#1, #1001#2, 99, "zzz";
     ;
     NULL, ImpreLiqui;
|FIN;

|PROCESO Tipo11;  |TIPO 11;
     |SI FSalida = 10;
         |PUSHV 0501 2380;
         |BLANCO 1202 2279;
         |CUADRO 1202 2279;

         |ATRI I;
         |PINTA 1322, " <F3>  Entrar al Lineal de Casillas.";
         |PINTA 1422, " <F5>  Seleccionar las Rentas.";
         |PINTA 1522, " <F6>  Activar/Desactivar Patrimonio";
         |PINTA 1622, " <F7>  Imprimir las Liquidaciones";
         |PINTA 1722, " <F8>  Lineal de las Rentas marcadas con X";
         |PINTA 1822, " <F9>  Crear Complementarias de Patrimonio";
         |PINTA 1922, " <F10> Ver Liquidacion A¤o Anterior";
         |PINTA 2022, " <F12> Cambiar Forma de Pago Patrimonio";
         |ATRI i;

         |LEETECLA aTecla;
         |POPV;

         FSalida = 0;

         |SI aTecla = "ÿ825";  FSalida = 11;  |FINSI;
         |SI aTecla = "ÿ827";  FSalida = 13;  |FINSI;
         |SI aTecla = "ÿ828";  FSalida = 14;  |FINSI;
         |SI aTecla = "ÿ829";  FSalida = 15;  |FINSI;
         |SI aTecla = "ÿ830";  FSalida = 16;  |FINSI;
         |SI aTecla = "ÿ831";  FSalida = 17;  |FINSI;
         |SI aTecla = "ÿ832";  FSalida = 18;  |FINSI;

         |SI FSalida = 0;
             |ERROR;
             |ACABA;
         |FINSI;

     |FINSI;

     |SI FSalida = 9;
         |SI #1001#2 ! "ZPATRITIT ";  |Y #1001#2 ! "ZPATRICON ";
             |ACABA;
         |FINSI;

         |LEE 101#1001=;
         |SI FSalida = 0;
             |ENCAMPO #9#1001;
             |GRABA 020#1001a;
             |LIBERA #1001;
         |FINSI;
         |ACABA;
     |FINSI;

     |SI FSalida = 11;
         enModoLiq = 4;
         |ENTLINEAL #1#1002, -5, 4, 22, 0, ClaveBaja1002, ClaveAlta1002;
         |ACABA;
     |FINSI;

     |SI FSalida = 13;  |Y enModo ! 4;
         |||MENAV "    La Renta aun no es la definitiva. ";  ||Quitar
         |||ACABA;
         |HAZ Seleccion;
         |ERROR;
     |FINSI;

     |SI FSalida = 14;  |Y enModo ! 4;
         |SI #1001#2 ! "ZPATRITIT ";  |Y #1001#2 ! "ZPATRICON ";
             |MENAV "       Esta linea no es de Patrimonio.";
             |ACABA;
         |FINSI;

         ||MENAV "    La Renta aun no es la definitiva. ";  || Quitar
         ||ACABA;

         |LEE 101#1001=;
         |SI #1001#5 = "714";
             #1001#5 = "";
         |SINO;
             #1001#5 = "714";

         |FINSI;
         |GRABA 020#1001a;
         |LIBERA #1001;

         |PINTA #1001#5;
     |FINSI;

     |SI FSalida = 15;
         |IMPRE 0;
         |SI FSalida ! 0;  |ACABA;  |FINSI;
         |INFOR "rey00001";
         |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;
         |BUCLE rem01002;
         |SI nSwPrint = 1;  |PIEINF;  |FINSI;
         |FININF;
         |FINIMP;
         |ERROR;
     |FINSI;

     |SI FSalida = 16;
         |PUSHV 0501 2380;
         |ABRE #1003;
         #1003#0 = enEmpresa;
         #1003#1 = "        ";
         #1003#2 = 1;
         |LEE 040#1003];
         |SI FSalida = 0;  |Y  #1003#0 = enEmpresa;
             |ENTLINEAL #1#1003, -3, 4, 22, 1, ClaveBaja1003, ClaveAlta1003;
         |SINO;
             |MENAV "     No hay Rendimientos marcados con X";
         |FINSI;
         |CIERRA #1003;
         |POPV;
     |FINSI;

     |SI FSalida = 17;  |Y enModo ! 4;
         |SI #1001#2 ! "ZPATRITIT ";  |Y #1001#2 ! "ZPATRICON ";
             |MENAV "       Esta linea no es de Patrimonio.";
             |ACABA;
         |FINSI;

         ||MENAV "    La Renta aun no es la definitiva. ";  || Quitar
         ||ACABA;

         |LEE 101#1001=;
         |SI FSalida ! 0;     |ACABA;  |FINSI;
         |SI #1001#5 ! "714"; |LIBERA #1001;  |ACABA;  |FINSI;

         |PUSHV 0501 2380;
         |BLANCO 1115 2359;
         |CUADRO 1115 2359;
         |ATRI R;
         |PINTA 1216, "     ACTIVADO COMPLEMENTARIA PATRIMONIO    ";
         |ATRI r;
         |PINTA 1416, "    Resultado Patrimonio : ";
         |PINTA 1516, "    Resultado Anteriores : ";
         |PINTA 1716, "    Resultado Patrimonio : ";

         |HAZ LeePatrimonio;
         |PINTA 1443, #1002#6;

         |ET Anterior;
             nAnterior = 0;
             E_inf     = "-999999999.?EURO";
             E_sup     = "9999999999";
             nAnterior = 1543 ? 1;
             |SI FSalida = 2;  |VETE Anterior;  |FINSI;

         enImporte = #1002#6 - nAnterior;
         |SI enImporte < 0;
             |MENAV "0000 La Renta se queda negativa, no se puede imprimir, debera hacer un escrito para Hacienda.";
         |FINSI;

         #1002#6   = enImporte;
         |PINTA 1743, #1002#6;

         |ABRE #1002;
         #1002#0 = #1001#0;
         #1002#1 = #1001#1;
         #1002#2 = #1001#2;
         #1002#3 = 31;
         #1002#4 = " 50";
         |LEE 101#1002=;
         |SI FSalida ! 0;
             #1002#0 = #1001#0;
             #1002#1 = #1001#1;
             #1002#2 = #1001#2;
             #1002#3 = 31;
             #1002#4 = " 50";
             #1002#5 = "Cuota a Ingresar Complementaria ";
             |GRABA 020#1002n;
             |LIBERA #1002;
         |FINSI;
         |CIERRA #1002;

         enBloque  = 31;
         eaCasilla = " 50";
         |HAZ GrabaComple;

         |ABRE #1002;
         #1002#0 = #1001#0;
         #1002#1 = #1001#1;
         #1002#2 = #1001#2;
         #1002#3 = 31;
         #1002#4 = "  A";
         |LEE 101#1002=;
         |SI FSalida ! 0;
             #1002#0 = #1001#0;
             #1002#1 = #1001#1;
             #1002#2 = #1001#2;
             #1002#3 = 31;
             #1002#4 = "  A";
             #1002#5 = "Cuota declaracion anterior";
             |GRABA 020#1002n;
             |LIBERA #1002;
         |FINSI;
         |CIERRA #1002;

         #1001#3 = enImporte;

         enImporte = nAnterior;
         enBloque  = 31;
         eaCasilla = "  A";
         |HAZ GrabaComple;

         |LEETECLA aAlfa;

         |POPV;

         |GRABA 020#1001a;
         |LIBERA #1001;

         |PINTA #1001#3;
     |FINSI;

     |SI FSalida = 18;
         |DBASS aMas;  |QBF aMas;
         aMas = aMas + "agiren03/def/rem01001.mas";
         |CARGA_DEF aMas, rem01001@;
         |SI FSalida ! 0;
             |MENAV "0000 No tiene instalada la Renta del 2003";
             |ERROR;
             |ACABA;
         |FINSI;

         aAlfa = "|TITULO";
         aAlfa = #rem01001@#aAlfa#;

         |DESCARGA_DEF #rem01001@;

         aAlfa = aAlfa % -101;
         |SI aAlfa ! "I";
             |MENAV "0000 Version incorrecta de la Renta 2003, por favor instalese la ultima version.";
             |ERROR;
             |ACABA;
         |FINSI;

         enDesdeRenta2004 = 1;
         |SUB_EJECUTA_NP ":agiren03/rem01001";

         |ERROR;
     |FINSI;
|FPRC;

|RUTINA ClaveBaja1001;
     #1001#0 = enEmpresa;
     #1001#1 = 00;
     #1001#2 = "          ";
|FRUT;

|RUTINA ClaveAlta1001;
     #1001#0 = enEmpresa;
     #1001#1 = 99;
     #1001#2 = "zzzzzzzzzz";
|FRUT;

|RUTINA ClaveBaja1003;
     #1003#0 = enEmpresa;
     #1003#1 = "          ";
     #1003#2 = 001;
|FRUT;

|RUTINA ClaveAlta1003;
     #1003#0 = enEmpresa;
     #1003#1 = "zzzzzzzzzz";
     #1003#2 = 99;
|FRUT;

|PROGRAMA;
     |SI enDesdeRenta2005 = 1;
         nModo  = enModo;
         enModo = 4;
         |ABRE #1001;
         #1001#0 = enEmpresa;
         #1001#1 = 00;
         #1001#2 = "          ";
         |LEE 000#1001];
         |SI FSalida = 0;  |Y  #1001#0 = enEmpresa;
             |ENTLINEAL #1#1001, -3, 4, 22, 1, ClaveBaja1001, ClaveAlta1001;
         |SINO;
             |MENAV "0000 No hay liquidacion en el Ejercicio 2004.";
         |FINSI;
         |CIERRA #1001;

         enModo = nModo;
         |ACABA;
     |FINSI;

     nSwSeleccion  = 0;
     |SI enModo    = 4;  nSwSeleccion = 1;    |FINSI;
     |SI enEmpresa = 0;  enEmpresa    = 991;  |FINSI;

     |ABRE #1003;
     #1003#0 = enEmpresa;
     #1003#1 = "        ";
     #1003#2 = 1;
     |LEE 040#1003];
     |SI FSalida = 0;  |Y  #1003#0 = enEmpresa;
         |ENTLINEAL #1#1003, -3, 4, 22, 1, ClaveBaja1003, ClaveAlta1003;
     |FINSI;
     |CIERRA #1003;

     |PARA;  |SI;  |HACIENDO;
             |ENTLINEAL #1#1001, -3, 4, 22, 1, ClaveBaja1001, ClaveAlta1001;

             |SI enSwRetorno = 0;
                 |SI nSwSeleccion = 0;
                     ||HAZ BorraLiquidacion;  || quitar
                     ||SAL;                   || quitar cuando activemos la renta

                     |CONFI "      Liquidacion sin seleccionar, Salir ";
                     |SI FSalida = 0;  |HAZ BorraLiquidacion;  |SAL;  |FINSI;
                 |SINO;
                     |SAL;
                 |FINSI;
             |FINSI;

             |SUB_EJECUTA_NP "rezcalcu";
             enSwRetorno = 0;
     |SIGUE;

     eaPrograma   = "rem01001";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRO;
