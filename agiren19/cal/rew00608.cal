|FICHEROS;
     rew00621;
     rew00608,MANTE;
|FIN;

|VARIABLES;
     nVtn608             = 0;
     nPan608             = 0;
     nCmp1               = 0;
     nCmp2               = 0;
     nCmp3               = 0;
     nOk                 = 0;

     aTecla              = "";

     &enModoReg          = 0;
     &eaVarDni           = "";
     &enCalcCif          = 0;
|FIN;

|PROCESO T12w608;  |TIPO 12;
|FPRC;

|PROCESO LetraNIFw608;  |TIPO 6;
     |SI FSalida = 10;
         eaVarDni  = #rew00608#Campo#;
         enCalcCif = 1;
         |HAZ CalculoDNI;
         #rew00608#Campo# = eaVarDni;
         |PINTA #rew00608#Campo#;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni      = #rew00608#Campo#;
     enCalcCif     = 0;
     |HAZ CalculoDNI;

     eaVarDni = (eaVarDni + "         ") % 109;
     |SI #rew00608#Campo# ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #rew00608#Campo# = eaVarDni;  |PINTA #rew00608#Campo#;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO T0Fec;
     nCmp1 = Campo + 1;
     nCmp2 = Campo + 2;
     nCmp3 = Campo + 3;

     |C_M #rew00608#nCmp1#, 1, "S";
     |C_M #rew00608#nCmp2#, 1, "S";
     |C_M #rew00608#nCmp3#, 1, "S";

     |SI #rew00608#Campo# = "01.01.0000";
         |C_M #rew00608#nCmp1#, 1, "N";  #rew00608#nCmp1# = "";  |PINTA #rew00608#nCmp1#;
         |C_M #rew00608#nCmp2#, 1, "N";  #rew00608#nCmp2# = "";  |PINTA #rew00608#nCmp2#;
         |C_M #rew00608#nCmp3#, 1, "N";  #rew00608#nCmp3# = 0;   |PINTA #rew00608#nCmp3#;
     |FINSI;
|FPRC;

|PROCESO EntraMejoras;
     #rew00608#0 = #rew00621#77;
     #rew00608#1 = #rew00621#78;
     #rew00608#2 = #rew00621#177;
     #rew00608#3 = #rew00621#79;

     #rew00608#4 = #rew00621#83;
     #rew00608#5 = #rew00621#84;
     #rew00608#6 = #rew00621#178;
     #rew00608#7 = #rew00621#85;

     #rew00608#8  = #rew00621#89;
     #rew00608#9  = #rew00621#90;
     #rew00608#10 = #rew00621#179;
     #rew00608#11 = #rew00621#91;

     |VENTANA 0501, 1699, -1, 16, "Introducci¢n de mejoras";
     nVtn608 = FSalida;

     |PINPA #0#rew00608;   nPan608 = FSalida;
     |PINDA #0#rew00608;

     nOk = 1;
     |SI #rew00621#24 = "S";  nOk = 0;  |FINSI;
     |SI #rew00621#31 ! 0;  |O #rew00621#34 ! 0;
         |SI #rew00621#141 ! "4";  |Y #rew00621#141 ! "5";
             nOk = 0;
         |FINSI;
     |FINSI;

     #rew00608#12 = #rew00621#180;

     |SI #rew00621#141 = "4";  |O #rew00621#141 = "5";
         |C_V #rew00608#12, 1, "S";
         |C_M #rew00608#12, 1, "S";
     |SINO;
         |CONTROL_SIMPLE nPan608, "LABEL,{{1}}                            ", 1425, 1480, NULL;
         |C_V #rew00608#12, 1, "N";
         |C_M #rew00608#12, 1, "N";
     |FINSI;

     |SI enModoReg = 4;  |O nOk = 0;
         |LEETECLA aTecla;
     |SINO;
         |ENDATOS #1#rew00608;
         |SI FSalida = 0;
             #rew00621#77  = #rew00608#0;
             #rew00621#78  = #rew00608#1;
             #rew00621#177 = #rew00608#2;
             #rew00621#79  = #rew00608#3;

             #rew00621#83  = #rew00608#4;
             #rew00621#84  = #rew00608#5;
             #rew00621#178 = #rew00608#6;
             #rew00621#85  = #rew00608#7;

             #rew00621#89  = #rew00608#8;
             #rew00621#90  = #rew00608#9;
             #rew00621#179 = #rew00608#10;
             #rew00621#91  = #rew00608#11;

             #rew00621#180 = #rew00608#12;
         |FINSI;
     |FINSI;

     |FINVENTANA nVtn608;
|FPRC;
