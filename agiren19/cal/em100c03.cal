|FICHEROS;
     rem01014;
     rem01019;
     rem01021;
|FIN;

|INCLUYE em100var;

|PROCESO Epigrafe;
     |QBF eaAlfa;
     |SI eaAlfa = "9999"; eaAlfa = ""; |FINSI;
     aLong = eaAlfa % 0; nLong = aLong;

     |SI nLong = 4;
        eaAlfa = (eaAlfa % 0103) + "." + (eaAlfa % 0401);
     |FINSI;
|FPRC;


|PROCESO Mete1014;
     eaTDato  = "AN"; enLong = 1;   enLongDec = 0;
     eaAlfa = #rem01014#4;  |HAZ TContribuyente;
     eaCadena =  eaTContri; |HAZ GrabaCadena;

     eaTDato = "An"; enLong = 1;   enLongDec = 0;
     eaAlfa = #rem01014#5;  |HAZ FormatoCmp;
     eaCadena = eaAlfa;    |HAZ GrabaCadena;

     enLong = 5; eaAlfa = #rem01014#6; |HAZ Epigrafe;
     |HAZ FormatoCmp;
     eaCadena = eaAlfa;    |HAZ GrabaCadena;

     eaCadena = "0";
     eaTDato = "N"; enLong = 1;   enLongDec = 0;
     |SI #rem01014#7 = "N"; eaCadena = "1";  |FINSI;
     |SI #rem01014#7 = "S"; eaCadena = "2";  |FINSI;
     |HAZ GrabaCadena;

     eaAlfa = #rem01014#8;  |HAZ FormatoCeroUno;
     eaCadena = eaAlfa;     |HAZ GrabaCadena;

     eaAlfa = #rem01014#9;  |HAZ FormatoCeroUno;
     eaCadena = eaAlfa;     |HAZ GrabaCadena;

     eaTDato = "N"; enLong = 11;   enLongDec = 2;
     |PARA nCmp = 10;  |SI nCmp [ 55;  |HACIENDO nCmp = nCmp + 1;
           eaAlfa   = #rem01014#nCmp#;  |HAZ FormatoCmp;
           eaCadena = eaAlfa;           |HAZ GrabaCadena;
     |SIGUE;

     enImp = 0;
     |SI nNumPag = 1;  eaCasilla = "05-0231"; |HAZ SacaImporte;  |FINSI;
     eaAlfa = enImp; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;

     |SI nNumPag = 1;  eaCasilla = "05-0232"; |HAZ SacaImporte;  |FINSI;
     eaAlfa = enImp; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;

     |SI nNumPag = 1;  eaCasilla = "05-0233"; |HAZ SacaImporte;  |FINSI;
     eaAlfa = enImp; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;

     |SI nNumPag = 1;  eaCasilla = "05-0234"; |HAZ SacaImporte;  |FINSI;
     eaAlfa = enImp; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;

     |SI nNumPag = 1;  eaCasilla = "05-0235"; |HAZ SacaImporte;  |FINSI;
     eaAlfa = enImp; |HAZ FormatoCmp; eaCadena = eaAlfa;
     |HAZ GrabaCadena;

     eaCadena = " " * 200;  |HAZ GrabaCadena;
     eaCadena = " " * 200;  |HAZ GrabaCadena;
     eaCadena = " " * 200;  |HAZ GrabaCadena;

     eaCadena = "</T10008000>" + eaCRLF; |HAZ GrabaCadena;
|FPRC;

|PROCESO Hoja08;
     enPagina = 8; |HAZ MiraObligatoria;
     |SI enConDatos = 0; |ACABA; |FINSI;

     nNumPag = enNumPags - 1; || En las hojas adicionales no entra la principal

     eaVTipo = eaTipo; aTipo = eaVTipo % 0110; nEnAct = 0;
     eaCadena = "<T10008000> ";
     |HAZ GrabaCadena;

     aTipo2      = (aTipo + "          ") % 110;

     nNumPag = 1;

     |ABRE #rem01014;
     #rem01014#0 = enVEmpre;
     #rem01014#1 = 0;
     #rem01014#2 = aTipo;
     #rem01014#3 = 1;
     |LEE 000#rem01014.];
     |PARA; |SI FSalida = 0; |Y #rem01014#0 = enVEmpre; |Y #rem01014#1 = 0;
                             |Y #rem01014#2 = aTipo2; |HACIENDO;
            |HAZ Mete1014;

            |LEE 000#rem01014.s;
            |SI FSalida ! 0; |O #rem01014#0 ! enVEmpre; |O #rem01014#1 ! 0;
                             |O #rem01014#2 ! aTipo2;
                |SAL;
            |FINSI;

            eaCadena = "<T10008000>C";
            |HAZ GrabaCadena; FSalida = 0;

            nNumPag = nNumPag + 1;
     |SIGUE;

     |CIERRA #rem01014;
|FPRC;

|PROCESO Mete1019;
     eaTDato  = "AN"; enLong = 1;   enLongDec = 0;
     eaAlfa   = #rem01019#5;  |HAZ TContribuyente;
     eaCadena = eaTContri;    |HAZ GrabaCadena;

     enLong = 5; eaAlfa = #rem01019#4; |HAZ Epigrafe;  |HAZ FormatoCmp;
     eaCadena =  eaAlfa; |HAZ GrabaCadena;

     eaTDato = "N"; enLong = 1;   enLongDec = 0;
     eaAlfa = #rem01019#44;  |HAZ FormatoCeroUno;
     eaCadena =  eaAlfa; |HAZ GrabaCadena;

     |PARA nCmp = 6;  |SI nCmp [ 24;  |HACIENDO nCmp = nCmp + 1;
           eaTDato  = "A"; enLong = 24;   enLongDec = 0;
           eaAlfa   = #rem01019#nCmp#;  |HAZ FormatoCmp;
           eaCadena =  eaAlfa; |HAZ GrabaCadena;

           nCmp     = nCmp + 1;
           eaTDato  = "N"; enLong = 7;   enLongDec = 2;
           eaAlfa   = #rem01019#nCmp#;  |HAZ FormatoCmp;
           eaCadena =  eaAlfa; |HAZ GrabaCadena;

           nCmp     = nCmp + 1;
           eaTDato = "N"; enLong = 9;   enLongDec = 2;
           eaAlfa   = #rem01019#nCmp#;  |HAZ FormatoCmp;
           eaCadena =  eaAlfa; |HAZ GrabaCadena;
     |SIGUE;

     eaTDato = "N"; enLong = 11;   enLongDec = 2;
     |PARA nCmp = 27;  |SI nCmp [ 30;  |HACIENDO nCmp = nCmp + 1;
           eaAlfa   = #rem01019#nCmp#;  |HAZ FormatoCmp;
           eaCadena =  eaAlfa; |HAZ GrabaCadena;
     |SIGUE;

     eaTDato = "N"; enLong = 2;   enLongDec = 2;
     |PARA nCmp = 31;  |SI nCmp [ 35;  |HACIENDO nCmp = nCmp + 1;
           eaAlfa   = #rem01019#nCmp#;  |HAZ FormatoCmp;
           eaCadena =  eaAlfa; |HAZ GrabaCadena;
     |SIGUE;

     eaTDato = "N"; enLong = 11;   enLongDec = 2;
     eaAlfa   = #rem01019#36;  |HAZ FormatoCmp; eaCadena =  eaAlfa; |HAZ GrabaCadena;
     eaAlfa   = #rem01019#38;  |HAZ FormatoCmp; eaCadena =  eaAlfa; |HAZ GrabaCadena;
     eaAlfa   = #rem01019#39;  |HAZ FormatoCmp; eaCadena =  eaAlfa; |HAZ GrabaCadena;
     eaAlfa   = #rem01019#37;  |HAZ FormatoCmp; eaCadena =  eaAlfa; |HAZ GrabaCadena;

     |PARA nCmp = 40;  |SI nCmp [ 43;  |HACIENDO nCmp = nCmp + 1;
           eaAlfa   = #rem01019#nCmp#;  |HAZ FormatoCmp;
           eaCadena =  eaAlfa; |HAZ GrabaCadena;
     |SIGUE;

     enImp = 0;

     eaTDato = "N"; enLong = 11;   enLongDec = 2;
     |SI nNumPag = 1;  eaCasilla = "06-1482"; |HAZ SacaImporte;  |FINSI;
     eaAlfa = enImp; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;

     |SI nNumPag = 1; eaCasilla = "06-1483"; |HAZ SacaImporte;  |FINSI;
     eaAlfa = enImp; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;

     |SI nNumPag = 1; eaCasilla = "06-1484"; |HAZ SacaImporte;  |FINSI;
     eaAlfa = enImp; |HAZ FormatoCmp; eaCadena = eaAlfa;
     |HAZ GrabaCadena;

     eaCadena = " " * 200;  |HAZ GrabaCadena;
     eaCadena = " " * 200;  |HAZ GrabaCadena;
     eaCadena = " " * 200;  |HAZ GrabaCadena;

     eaCadena = "</T10009000>" + eaCRLF; |HAZ GrabaCadena;
|FPRC;

|PROCESO Hoja09;
     enPagina = 9; |HAZ MiraObligatoria;
     |SI enConDatos = 0; |ACABA; |FINSI;

     nNumPag = enNumPags - 1; || En las hojas adicionales no entra la principal

     eaVTipo = eaTipo; aTipo = eaVTipo % 0110;  nEnAct = 0;
     eaCadena = "<T10009000> ";
     |HAZ GrabaCadena;

     nNumPag = 1;

     |ABRE #rem01019;
     #rem01019#0 = enVEmpre;
     #rem01019#1 = 0;
     #rem01019#2 = aTipo; aTipo2 = #rem01019#2;
     #rem01019#3 = 1;
     |LEE 000#rem01019.];
     |PARA; |SI FSalida = 0; |Y #rem01019#0 = enVEmpre; |Y #rem01019#1 = 0;
                             |Y #rem01019#2 = aTipo2; |HACIENDO;
            |HAZ Mete1019;

            |LEE 000#rem01019.s;
            |SI FSalida ! 0; |O #rem01019#0 ! enVEmpre; |O #rem01019#1 ! 0;
                             |O #rem01019#2 ! aTipo2;
               |SAL;
            |FINSI;

            eaCadena = "<T10009000>C";
            |HAZ GrabaCadena; FSalida = 0;

            nNumPag = nNumPag + 1;
     |SIGUE;

     |CIERRA #rem01019;
|FPRC;

|PROCESO MeteProducto;
     nCampo2 = nCampo1 + 1;
     nCampo3 = nCampo1 + 2;

     eaTDato  = "N"; enLong = 9;   enLongDec = 2;
     eaAlfa   = #rem01021#nCampo1#;  |HAZ FormatoCmp;
     eaCadena = eaAlfa;       |HAZ GrabaCadena;

     eaTDato = "An"; enLong = 6;   enLongDec = 0;
     eaAlfa = "      ";
     |SI #rem01021#nCampo2# > 0;
         eaAlfa = #rem01021#nCampo2#;
         |HAZ FormatoCmp;
     |FINSI;
     eaCadena = eaAlfa;       |HAZ GrabaCadena;

     eaTDato  = "N"; enLong = 9;   enLongDec = 2;
     eaAlfa   = #rem01021#nCampo3#;  |HAZ FormatoCmp;
     eaCadena = eaAlfa;       |HAZ GrabaCadena;
|FPRC;

|PROCESO Mete1021;
     eaTDato  = "AN"; enLong = 1;   enLongDec = 0;
     eaAlfa   = #rem01021#6;  |HAZ TContribuyente;
     eaCadena = eaTContri;    |HAZ GrabaCadena;

     eaTDato = "N"; enLong = 1;   enLongDec = 0;
     eaAlfa   = #rem01021#5;  |HAZ FormatoCmp;
     eaCadena = eaAlfa;       |HAZ GrabaCadena;

     eaTDato = "N"; enLong = 1;   enLongDec = 0;
     eaAlfa = #rem01021#4;  |HAZ FormatoCeroUno;
     eaCadena = eaAlfa;     |HAZ GrabaCadena;

     nCampo1 = 7;  |HAZ MeteProducto;
     nCampo1 = 10; |HAZ MeteProducto;
     nCampo1 = 13; |HAZ MeteProducto;
     nCampo1 = 16; |HAZ MeteProducto;
     nCampo1 = 19; |HAZ MeteProducto;
     nCampo1 = 22; |HAZ MeteProducto;
     nCampo1 = 25; |HAZ MeteProducto;
     nCampo1 = 28; |HAZ MeteProducto;
     nCampo1 = 31; |HAZ MeteProducto;
     nCampo1 = 34; |HAZ MeteProducto;
     nCampo1 = 37; |HAZ MeteProducto;
     nCampo1 = 40; |HAZ MeteProducto;
     nCampo1 = 43; |HAZ MeteProducto;
     nCampo1 = 68; |HAZ MeteProducto;
     nCampo1 = 71; |HAZ MeteProducto;
     nCampo1 = 74; |HAZ MeteProducto;

     eaTDato = "N"; enLong = 9;   enLongDec = 2;
     eaAlfa = #rem01021#46; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;
     eaAlfa = #rem01021#47; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;
     eaAlfa = #rem01021#48; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;
     eaAlfa = #rem01021#49; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;

     eaTDato = "N"; enLong = 2;   enLongDec = 2;
     eaAlfa = #rem01021#50; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;
     eaAlfa = #rem01021#51; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;
     eaAlfa = #rem01021#52; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;
     eaAlfa = #rem01021#53; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;
     eaAlfa = "0.0";        |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;
     eaAlfa = #rem01021#54; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;
     eaAlfa = #rem01021#67; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;
     eaAlfa = #rem01021#55; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;
     eaAlfa = #rem01021#56; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;

     eaTDato = "N"; enLong = 11;   enLongDec = 2;
     eaAlfa = #rem01021#57; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;
     eaAlfa = #rem01021#61; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;
     eaAlfa = #rem01021#66; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;
     eaAlfa = #rem01021#62; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;
     eaAlfa = #rem01021#59; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;
     eaAlfa = #rem01021#63; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;
     eaAlfa = #rem01021#64; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;
     eaAlfa = #rem01021#65; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;

     enImp = 0;

     eaTDato = "N"; enLong = 11;   enLongDec = 2;
     |SI nNumPag = 1; eaCasilla = "07-1558"; |HAZ SacaImporte;  |FINSI;
     eaAlfa = enImp; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;

     |SI nNumPag = 1;  eaCasilla = "07-1559"; |HAZ SacaImporte;  |FINSI;
     eaAlfa = enImp; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;

     |SI nNumPag = 1;  eaCasilla = "07-1560"; |HAZ SacaImporte;  |FINSI;
     eaAlfa = enImp; |HAZ FormatoCmp; eaCadena = eaAlfa; |HAZ GrabaCadena;

     eaCadena = " " * 200;  |HAZ GrabaCadena;
     eaCadena = " " * 200;  |HAZ GrabaCadena;
     eaCadena = " " * 200;  |HAZ GrabaCadena;

     eaCadena = "</T10010000>" + eaCRLF; |HAZ GrabaCadena;
|FPRC;

|PROCESO Hoja10;
     enPagina = 10; |HAZ MiraObligatoria;
     |SI enConDatos = 0; |ACABA; |FINSI;

     nNumPag = enNumPags - 1; || En las hojas adicionales no entra la principal

     eaVTipo = eaTipo; aTipo = eaVTipo % 0110;  nEnAct = 0;
     eaCadena = "<T10010000> ";
     |HAZ GrabaCadena;

     nNumPag = 1;

     |ABRE #rem01021;
     #rem01021#0 = enVEmpre;
     #rem01021#1 = 0;
     #rem01021#2 = aTipo;  aTipo2 = #rem01021#2;
     #rem01021#3 = 1;
     |LEE 000#rem01021.];
     |PARA; |SI FSalida = 0; |Y #rem01021#0 = enVEmpre; |Y #rem01021#1 = 0;
                             |Y #rem01021#2 = aTipo2; |HACIENDO;
            |HAZ Mete1021;

            |LEE 000#rem01021.s;
            |SI FSalida ! 0; |O #rem01021#0 ! enVEmpre; |O #rem01021#1 ! 0;
                             |O #rem01021#2 ! aTipo2;
                |SAL;
            |FINSI;

            eaCadena = "<T10010000>C";
            |HAZ GrabaCadena; FSalida = 0;

            nNumPag = nNumPag + 1;
     |SIGUE;

     |CIERRA #rem01021;
|FPRC;
