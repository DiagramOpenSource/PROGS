|FICHEROS;
     rem00025;
     rem00026;
     rem00058;
     rem00905;

     rew00625,MANTE;

     rew00003;
|FIN;

|VARIABLES;
     aAlfa         = "";
     aAlfa1        = "";
     aAlfa2        = "";
     aAlfa3        = "";
     aLong         = "";
     aQueQuiero    = "";
     aNumCampos    = "";
     aNumPanta     = "";
     aPathRenta    = "";
     aDef          = "";
     aDescri       = "";
     aCheq1        = "";
     aCheq2        = "";
     aContri       = "";

     aEsc1         = "";
     aEsc2         = "";
     aRetu         = "";
     aTecla        = "";
     aID           = "";

     n0Vnt          = -1;
     n1Vnt          = -1;
     nCampo         = 0;
     nRango         = 0;
     nGrid25        = -1;
     nGrid26        = -1;
     nBotonAlta     = 0;
     nBotonModi     = 0;
     nBotonBaja     = 0;
     nBotonCntr     = 0;
     nBotonInIm     = 0;
     nPanta         = 0;
     nID            = 0;
     nEntrar        = 0;
     nPorce         = 0;

     nLong         = 0;
     nCaracter     = 0;
     nPosi         = 0;
     nNumCampos    = 0;
     nNumPanta     = 0;
     nModo         = 0;
     nEntrada      = 0;
     nPtas         = 0;
     nRetencion    = 0;
     nCampo15      = 0;
     nCampo16      = 0;
     nCampo17      = 0;
     nCampo20      = 0;
     nCampo27      = 0;
     nValor        = 0;
     nValor1       = 0;
     nValor28      = 0;
     nValorPat     = 0;
     nDias         = 0;
     nAnyoVenta    = 0;
     nAnyoCompra   = 0;
     nDiferencia   = 0;
     nCoefi        = 0;
     nLinea        = 0;
     nContenido    = 0;
     nAnyo         = 0;
     nSwHay        = 0;
     nCampo1       = 0;
     nCampo2       = 0;
     nCampo3       = 0;
     nCampo4       = 0;
     nCampo5       = 0;
     nImporte1     = 0;
     nImporte2     = 0;

 {-1}aVent         = "";
     aVent1        = 0;
     aVent2        = 0;
     aVent3        = 0;
     aVent4        = 0;
     aVent5        = "";

     &enEmpresa    = 0;
     &enModo       = 0;
     &enModoReg    = 0;
     &enLin        = 0;
     &eaDeclarante = "";
     &enComunes    = 0;
     &enChequeo    = 0;
     &enMinusvalia = 0;
     &eaMinuAyuda  = "";
     &eaFallece    = "";
     &eaSwVarios   = "";
     &eaVarDni     = "";
     &enSwLiquida  = 0;
     &enSwRetorno  = 0;
     &eaPrograma   = "";
     &eaPunto      = "";
     &enCalcCif    = 0;

     &eaLetra      = "";
     &eaDeDonde    = "";
     &eaLinDonde   = "";
     &eaAnyoUsu    = "";
     &eaEdadDec    = "";
     &eaPatr06     = "";
     &eaPatr07     = "";
     &eaPatr08     = "";
     &eaPatr09     = "";
     &eaPatr10     = "";
     &eaPatr11     = "";
     &eaPatr12     = "";
     &eaPatr13     = "";
     &eaPatr14     = "";
     &eaPatr15     = "";
     &eaPatr16     = "";
     &eaPatr17     = "";
     &eaPatr18     = "";
     &eaPatr19     = "";
     &eaPatr20     = "";
     &eaPatr21     = "";
     &eaPatr25     = "";

     &eaAzul       = "";
     &eaVerde      = "";
     &eaRojo       = "";
     &eaRosa       = "";
     &enBtnSalir   = 0;

     &eaModal            = "";
     &ea32_1             = "";
     &ea32_2_1           = "";
     &en0180             = 0;
     &en0218             = 0;
     &en0219             = 0;
     &en0220             = 0;
     &en0221             = 0;
     &en0222             = 0;
     &en0223             = 0;
     &en0224             = 0;
     &en0225             = 0;
     &en0226             = 0;
|FIN;

|| ---- PROCESOS GRABACIONES EXTERIORES

|PROCESO Patrimonio;
     |SI #rem00025#3  = "R";           |ACABA;  |FINSI;
     |SI #rem00025#3  = "X";           |ACABA;  |FINSI;
     |SI #rem00025#2  = "1 FAMILIAR";  |ACABA;  |FINSI;
     |SI #rem00025#2  = "2 FAMILIAR";  |ACABA;  |FINSI;
     |SI #rem00025#2  = "3 FAMILIAR";  |ACABA;  |FINSI;
     |SI #rem00025#2  = "4 FAMILIAR";  |ACABA;  |FINSI;
     |SI #rem00025#12 = 0;             |ACABA;  |FINSI;

     |HAZ LimpiaPatrim;

     eaDeclarante = #rem00025#2;

     eaLetra    = "C1";
     eaDeDonde  = "D0";
     eaLinDonde = #rem00025#1;
     eaAnyoUsu  = 0;
     eaPatr06   = #rem00025#24;
     eaPatr08   = #rem00025#22;
     eaPatr09   = #rem00025#23;
     eaPatr15   = #rem00025#21;
     eaPatr18   = #rem00025#20;
     nValor     = #rem00025#12 % #rem00025#14;
     eaPatr10   = nValor;

     eaPatr16   = "P";
     eaPatr17   = "";
     eaPatr19   = "";
     eaPatr25   = "";

     eaPatr20 = "0";
     eaPatr21 = "0";

     |SI #rem00025#2 = "TITULAR   ";
         eaPatr20 = "100";
     |FINSI;

     |SI #rem00025#2 = "CONYUGE   ";
         eaPatr21 = "100";
     |FINSI;

     |SI #rem00025#2 = "GANANCIAL ";
         eaPatr20 = "50";
         eaPatr21 = "50";
     |FINSI;

     |SI #rem00025#2 = "VARIOS    ";
         eaPatr20 = #rem00025#5;
         eaPatr21 = #rem00025#6;
     |FINSI;

     |HAZ GrabaPatrimonio;
|FPRC;

|PROCESO Graba58;
     |SI #rem00025#13 ! "S";  |ACABA;  |FINSI;

     |ABRE #rem00058;
     |SELECT #1#rem00058;
     #rem00058#0 = #rem00025#0;
     #rem00058#1 = 99;
     |LEE 040#rem00058.];
     |SI FSalida = 0;
         |LEE 040#rem00058.a;
     |SINO;
         |LEE 040#rem00058.u;
     |FINSI;
     nLinea = 1;

     |SI FSalida = 0;  |Y #rem00058#0 = #rem00025#0;
         nLinea = #rem00058#1 + 1;
     |FINSI;

     |DDEFECTO #rem00058;
     #rem00058#0  = #rem00025#0;
     #rem00058#1  = nLinea;
     #rem00058#2  = #rem00025#2;
     #rem00058#3  = "R";
     |SI #rem00025#3 = "X";
         #rem00058#3  = "X";
         #rem00058#48 = eaRojo;
     |FINSI;
     #rem00058#4  = #rem00025#4;
     #rem00058#5  = #rem00025#5;
     #rem00058#6  = #rem00025#6;
     #rem00058#7  = #rem00025#7;
     #rem00058#8  = #rem00025#8;
     #rem00058#9  = #rem00025#9;
     #rem00058#10 = #rem00025#10;
     #rem00058#11 = #rem00025#14;
     #rem00058#12 = #rem00025#15;
     #rem00058#14 = "E1";
     #rem00058#15 = #rem00025#1;
     #rem00058#13 = 3;
     #rem00058#27 = #rem00025#28 % #rem00058#11;
     #rem00058#28 = nValor28;
     #rem00058#29 = #rem00025#29 % #rem00058#11;

     |SI #rem00025#11 = "S";
         |SI #rem00025#27 ! 0;
             #rem00058#50 = #rem00058#27 % 5;
             |SI #rem00058#50 > 2000;  #rem00058#50 = 2000;  |FINSI;
         |FINSI;
     |FINSI;

     #rem00058#30 = #rem00058#27 - #rem00058#28 - #rem00058#29;

     #rem00058#49 = #rem00025#33;
     #rem00058#55 = #rem00025#17;

     |GRABA 020#rem00058.n;
     |LIBERA #rem00058;

     |CIERRA #rem00058;

     eaPrograma   = "rem00058";
     eaLetra      = #rem00058#13;
     eaPunto      = eaLetra;
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO Borra58;
     nValor28 = 0;

     |ABRE #rem00058;
     |SELECT #2#rem00058;
     #rem00058#0  = #rem00025#0;
     #rem00058#14 = "E1";
     #rem00058#15 = #rem00025#1;
     |LEE 101#rem00058.=;
     |SI FSalida = 0;
         nValor28 = #rem00058#28;

         |BORRA 020#rem00058.a;
         |LIBERA #rem00058;

         eaPrograma   = "rem00058";
         eaLetra      = #rem00058#13;
         eaPunto      = eaLetra;
         |HAZ ProgramaActivo;
     |FINSI;
     |CIERRA #rem00058;
|FPRC;

|| ---- PROCESOS DEL rew00625

|PROCESO T0C30;
     |POSICIONATE #rew00625#12;
|FPRC;

|PROCESO BotonCntr;
     enComunes   = 0;   || Solo declarantes
     enChequeo   = 0;

     #rew00003#0 = #rew00625#2;
     #rew00003#1 = #rew00625#3;
     #rew00003#2 = #rew00625#4;
     #rew00003#3 = #rew00625#5;
     #rew00003#4 = #rew00625#6;
     #rew00003#5 = #rew00625#7;
     #rew00003#6 = #rew00625#8;
     #rew00003#7 = #rew00625#9;
     #rew00003#8 = #rew00625#10;

     |HAZ PantaREW00003;

     #rew00625#2  = #rew00003#0;    |PINTA #rew00625#2;
     #rew00625#3  = #rew00003#1;
     #rew00625#4  = #rew00003#2;
     #rew00625#5  = #rew00003#3;
     #rew00625#6  = #rew00003#4;
     #rew00625#7  = #rew00003#5;
     #rew00625#8  = #rew00003#6;
     #rew00625#9  = #rew00003#7;
     #rew00625#10 = #rew00003#8;

     aAlfa = "|C014WID";
     aID   = #rew00625#aAlfa#;
     nID   = aID;
     |FOCOTECLADO nID;

     Control = "rew00625";

     |SI #rew00625#3 = "X";  |Y enModoReg ! 4;
         |PTEC 806;
     |FINSI;
|FPRC;

|PROCESO FinVentana;
     |SI n0Vnt ! -1;
         |FINVENTANA n0Vnt;
         n0Vnt = -1;
     |FINSI;

     |PULSATECLA;
|FPRC;

|PROCESO Tipo12Fw625;  |TIPO 12;
     |SI FSalida = 7;
         |HAZ FinVentana;
         |ACABA;
     |FINSI;

     |HAZ FinVentana;

     aAlfa = #rew00625#2;  |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000No se puede validar la ficha, no hay contribuyente introducido";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Baja_26;
     #rem00026#0 = #rew00625#0;
     #rem00026#1 = #rew00625#1;
     #rem00026#2 = 1;
|FPRC;

|PROCESO Alta_26;
     #rem00026#0 = #rew00625#0;
     #rem00026#1 = #rew00625#1;
     #rem00026#2 = 9999;
|FPRC;

|PROCESO CreaLineal26;
     |SI nGrid26 ! -1;
         |DESTRUYECONTROL nGrid26;
     |FINSI;

     nRango = 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#rem00026, nRango, 2702, 3598, Baja_26, Alta_26, NULL;
     nGrid26 = FSalida;
|FPRC;

|PROCESO rem00905;
     #rem00026#0 = #rew00625#0;
     #rem00026#1 = #rew00625#1;
     #rem00026#2 = #rem00905#0;
     |LEE 000#rem00026.=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     |DDEFECTO #rem00026;
     #rem00026#0 = #rew00625#0;
     #rem00026#1 = #rew00625#1;
     #rem00026#2 = #rem00905#0;
     #rem00026#3 = #rem00905#1;
     #rem00026#4 = #rem00905#2;
     #rem00026#6 = #rem00905#6;

     |GRABA 020#rem00026.n;
     |LIBERA #rem00026;

     |ESTADO_CONTROL nBotonInIm, "ENABLE";
     |ESTADO_CONTROL nBotonCntr,   "ENABLE";
|FPRC;

|DEFBUCLE rem00905;
     #rem00905#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, rem00905;
|FIN;

|PROCESO CreaImportes;
     |SI #rew00625#0 = 0;  |O #rew00625#1 = 0;
         |ACABA;
     |FINSI;

     #rem00026#0 = #rew00625#0;
     #rem00026#1 = #rew00625#1;
     #rem00026#2 = 5;
     |LEE 000#rem00026.=;
     |SI FSalida = 0;
         |ACABA;
     |FINSI;

     |BUCLE rem00905;

     |HAZ CreaLineal26;
|FPRC;

|PROCESO Tipo0C1Fw625;  |TIPO 0;
     |C_M #rew00625#1, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     #rem00025#0 = #rew00625#0;
     #rem00025#1 = #rew00625#1;
     |LEE 000#rem00025.=;
     |SI FSalida = 0;
         |MENAV "0000El registro ya existe.";
         |ERROR;
         |ACABA;
     |FINSI;

     |HAZ CreaImportes;
|FPRC;

|PROCESO T0C11Fw625;   |TIPO 0;
     #rem00026#0 = #rew00625#0;
     #rem00026#1 = #rew00625#1;
     #rem00026#2 = 1;
     |LEE 000#rem00026.];
     |SI FSalida = 0;  |Y #rem00026#0 = #rew00625#0;
                       |Y #rem00026#1 = #rew00625#1;
         |ACABA;
     |FINSI;

     |HAZ CreaImportes;
|FPRC;

|PROCESO Tipo7C2Fw625;   |TIPO 7;
     aAlfa = #rew00625#2;  |QBF aAlfa;
     |SI aAlfa ! "";  |Y #rew00625#3 ! "X";
         |ACABA;
     |FINSI;

     |HAZ BotonCntr;
|FPRC;

|PROCESO LetraNif;  |TIPO 6;
     |SI FSalida = 10;
         enCalcCif = 1;
         eaVarDni  = #rew00625#Campo#;
         |HAZ CalculoDNI;
         #rew00625#Campo# = eaVarDni;
         |PINTA #rew00625#Campo#;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #rew00625#Campo#;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 112;
     |SI #rew00625#Campo# ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #rew00625#Campo# = eaVarDni;  |PINTA #rew00625#Campo#;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CampoNif;  |TIPO 0;
     |SI #rew00625#13 = "N";  |ACABA;  |FINSI;

     |SI #rew00625#15 = "            ";
         |MENAV "     Introduzca un Nif.";
         |ERROR;
         |ACABA;
     |FINSI;

     aLong = #rew00625#15;  |QBF aLong;
     aLong = aLong % 0;
     nLong = aLong;
     |SI nLong ! 9;
         |MENAV "     Longitud Erronea.";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa = #rew00625#15 % 101;
     |SI aAlfa ! "E";  |Y aAlfa ! "H";  |Y aAlfa ! "J";
         |MENAV "     El Nif  debe empezar por E, H o J";
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO Tipo7C14Fw625;  |TIPO 7;
     |HAZ FinVentana;

     |SI #rew00625#13 = "N";
         #rew00625#14 = 100;   |PINTA #rew00625#14;
         #rew00625#15 = "";    |PINTA #rew00625#15;
         #rew00625#16 = "";    |PINTA #rew00625#16;

         |C_M #rew00625#14, 1, "N";
         |C_M #rew00625#15, 1, "N";
         |C_M #rew00625#16, 1, "N";

         |ACABA;
     |FINSI;

     |C_M #rew00625#14, 1, "S";
     |C_M #rew00625#15, 1, "S";
     |C_M #rew00625#16, 1, "S";

     |VENTANA 1536, 1890, -1, 1, "";
     n0Vnt = FSalida;

     |CONTROL_SIMPLE 0, "LABEL,{{15}}RECUERDE", 1550, 1580, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}Las cantidades se introducir n al 100%, luego el c lculo las ", 1637, 1690, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}computar  al porcentaje de comunero que le hayamos informado ", 1737, 1790, NULL;

     |PTEC 802;  |PAUSA;
|FPRC;

|PROCESO Tipo0C14Fw625;  |TIPO 0;
     |HAZ FinVentana;
|FPRC;

|PROCESO Tipo7C18Fw625;  |TIPO 7;
     |HAZ FinVentana;

     |VENTANA 1536, 2292, -1, 1, "";
     n0Vnt = FSalida;

     |CONTROL_SIMPLE 0, "LABEL,{{15}}TIPO DE ACTIVIDAD", 1550, 1580, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}-1- Actividades empresariales de caracter mercantil", 1637, 1692, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}-2- Actividades agricolas y ganaderas (excepto las de claves -6-)", 1737, 1792, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}-3- Otras actividades empresariales de caracter no mercantil ", 1837, 1892, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}-4- Actividades profesionales de caracter artistico o deportivo", 1937, 1992, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}-5- Restantes actividades profesionales", 2037, 2092, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}-6- Actividades agrarias afectadas en 2019 por catastrofes naturales", 2137, 2192, NULL;

     |PTEC 802;  |PAUSA;
|FPRC;

|PROCESO Tipo0C18Fw625;  |TIPO 0;
     |HAZ FinVentana;
|FPRC;


|PROCESO CargaFantasma;
     |C_M #rew00625#11, 1, "S";
     |C_M #rew00625#12, 1, "S";
     |C_M #rew00625#13, 1, "S";
     |C_M #rew00625#14, 1, "S";
     |C_M #rew00625#15, 1, "S";
     |C_M #rew00625#16, 1, "S";
     |C_M #rew00625#17, 1, "S";
     |C_M #rew00625#18, 1, "S";
     |C_M #rew00625#19, 1, "S";
     |C_M #rew00625#20, 1, "S";
     |C_M #rew00625#22, 1, "S";
     |C_M #rew00625#23, 1, "S";
     |C_M #rew00625#24, 1, "S";
     |C_M #rew00625#31, 1, "S";
     |C_M #rew00625#32, 1, "S";
     |C_M #rew00625#33, 1, "S";
     |C_M #rew00625#34, 1, "S";

     |PARA nCampo = 0;  |SI nCampo [ nNumCampos;  |HACIENDO nCampo = nCampo + 1;
           #rew00625#nCampo# = #rem00025#nCampo#;

           |C_V #rew00625#nCampo#, 0, aAlfa;
           |SI aAlfa = "S";  |PINTA #rew00625#nCampo#;  |FINSI;
     |SIGUE;

     |HAZ Borra58;

     eaDeDonde  = "D0";
     eaLinDonde = #rem00025#1;
     eaLetra    = "C1";
     |HAZ BorraPatrimonio;

     |HAZ CreaLineal26;
|FPRC;

|PROCESO DescargaFantasma;
     |VENTANA 0501, 0502, -1, 1, "";
     n1Vnt = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vnt;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     enLin    = #rew00625#1;
     eaModal  = #rew00625#11;
     ea32_1   = #rew00625#31;
     ea32_2_1 = #rew00625#32;
     |SUB_EJECUTA "rem00026;RECALCULA";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vnt;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vnt;

     |ABRET #rem00026;

     #rew00625#25 = en0180;
     #rew00625#26 = en0218;
     #rew00625#27 = en0220 + en0223;
     #rew00625#28 = en0224;
     #rew00625#29 = en0225;
     #rew00625#30 = en0226;

     |PARA nCampo = 0;  |SI nCampo [ nNumCampos;  |HACIENDO nCampo = nCampo + 1;
           |SI enSwLiquida = 1;
               |SI #rem00025#nCampo# = #rew00625#nCampo#;
                   enSwRetorno = 1;
               |FINSI;
           |FINSI;

           #rem00025#nCampo# = #rew00625#nCampo#;
     |SIGUE;

                              #rem00025#36 = "";
     |SI #rem00025#3  = "X";  #rem00025#36 = eaRojo;  |FINSI;

     |HAZ PintaDatosPantalla;
|FPRC;

|PROCESO rem00025Cheq;
     |SI nLinea = #rem00025#1;  |LIBERA #rem00025; |ACABA;  |FINSI;

     #rem00025#32 = aCheq1;
     #rem00025#33 = aCheq2;

     |GRABA 020#rem00025.a;
     |LIBERA #rem00025;
|FPRC;

|DEFBUCLE rem00025Cheq;
     #rem00025#1;
     2;
     enEmpresa, 01, aContri;
     enEmpresa, 99, aContri;
     be;
     NULL, rem00025Cheq;
|FIN;

|PROCESO IgualaResto;
     aCheq1  = #rem00025#32;
     aCheq2  = #rem00025#33;
     aContri = #rem00025#2;
     nLinea  = #rem00025#1;

     |BUCLE rem00025Cheq;

     #rem00025#0 = enEmpresa;
     #rem00025#1 = nLinea;
     |LEE 000#rem00025.=;
|FPRC;

|PROCESO rem00026B;
     |BORRA 020#rem00026.a;
     |LIBERA #rem00026;
|FPRC;

|DEFBUCLE rem00026B;
     #rem00026#1;
     ;
     #rem00025#0, #rem00025#1, 0;
     #rem00025#0, #rem00025#1, 9999;
     be;
     NULL, rem00026B;
|FIN;

|PROCESO Alta;
     |ESTADO_CONTROL nBotonAlta,   "DISABLE";
     |ESTADO_CONTROL nBotonModi,   "DISABLE";
     |ESTADO_CONTROL nBotonBaja,   "DISABLE";

     |HAZ QuitaBtnSalir;

     |ESTADO_CONTROL nGrid25, "DISABLE";

     |PULSATECLA;

     #rem00025#0 = enEmpresa;
     #rem00025#1 = 99;
     |LEE 000#rem00025.];
     |SI FSalida = 0;
         |LEE 000#rem00025.a;
     |SINO;
         |LEE 000#rem00025.u;
     |FINSI;

     nValor28 = 0;

     |DDEFECTO #rew00625;
     #rew00625#0 = enEmpresa;
     #rew00625#1 = 1;
     |SI FSalida = 0;  |Y  #rem00025#0 = enEmpresa;
         #rew00625#1  = #rem00025#1 + 1;
         #rew00625#32 = #rem00025#32;
         #rew00625#33 = #rem00025#33;
     |FINSI;

     |DDEFECTO #rem00025;

     #rem00025#0  = #rew00625#0;
     #rem00025#1  = #rew00625#1;
     #rem00025#32 = #rew00625#32;
     #rem00025#33 = #rew00625#33;

     enModoReg = 1;
     |HAZ CargaFantasma;

     |C_M #rew00625#1, 1, "S";
     |ENDATOS #1#rew00625;
     |SI FSalida = 0;
         |HAZ DescargaFantasma;

         |GRABA 020#rem00025.n;
         |LIBERA #rem00025;

         |HAZ IgualaResto;
         |HAZ Patrimonio;
         |HAZ Graba58;
     |SINO;
         #rem00025#0 = #rew00625#0;
         #rem00025#1 = #rew00625#1;
         |BUCLE rem00026B;
     |FINSI;

     |SI enModo ! 4;
         |ESTADO_CONTROL nBotonAlta, "ENABLE";
     |FINSI;

     |HAZ PonBtnSalir;

     enModoReg = 4;
     |ESTADO_CONTROL nGrid25, "ENABLE";
     |REFRESCACONTROL nGrid25;

     |FOCOTECLADO nGrid25;
|FPRC;

|PROCESO Modificar;
     |SI nEntrar = 0;  |ACABA;  |FINSI;

     |LEE 101#rem00025.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ESTADO_CONTROL nBotonAlta,  "DISABLE";
     |ESTADO_CONTROL nBotonModi,  "DISABLE";
     |ESTADO_CONTROL nBotonBaja,  "DISABLE";

     |HAZ QuitaBtnSalir;

     |ESTADO_CONTROL nGrid25, "DISABLE";

     enModoReg = 2;
     |C_M #rew00625#1, 1, "N";

     |HAZ CargaFantasma;
     |ENDATOS #2#rew00625;
     |SI FSalida = 0;
         |HAZ DescargaFantasma;

         |GRABA 020#rem00025.a;
     |FINSI;
     |LIBERA #rem00025;

     |HAZ IgualaResto;
     |HAZ Patrimonio;
     |HAZ Graba58;

     |ESTADO_CONTROL nBotonAlta, "ENABLE";
     |ESTADO_CONTROL nBotonModi, "ENABLE";
     |ESTADO_CONTROL nBotonBaja, "ENABLE";

     |HAZ PonBtnSalir;

     enModoReg = 4;
     |ESTADO_CONTROL nGrid25, "ENABLE";
     |REFRESCACONTROL nGrid25;
     |FOCOTECLADO nGrid25;
|FPRC;

|PROCESO Baja;
     |SI nEntrar = 0;  |ACABA;  |FINSI;

     |CONFI "0000 Confirma la baja del registro seleccionado";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |LEE 101#rem00025.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BORRA 020#rem00025.a;
     |LIBERA #rem00025;

     |BUCLE rem00026B;

     |HAZ Borra58;

     eaDeDonde  = "D0";
     eaLinDonde = #rem00025#1;
     eaLetra    = "C1";
     |HAZ BorraPatrimonio;

     nEntrar     = 0;
     enSwRetorno = 1;

     |ESTADO_CONTROL nBotonModi,  "DISABLE";
     |ESTADO_CONTROL nBotonBaja,  "DISABLE";

     |REFRESCACONTROL nGrid26;
     |REFRESCACONTROL nGrid25;
     |FOCOTECLADO nGrid25;
|FPRC;

|PROCESO PintaDatosPantalla;
     |DDEFECTO #rew00625;
     |PARA nCampo = 0;  |SI nCampo [ nNumCampos;  |HACIENDO nCampo = nCampo + 1;
           #rew00625#nCampo# = #rem00025#nCampo#;

           |C_V #rew00625#nCampo#, 0, aAlfa;
           |SI aAlfa = "S";  |PINTA #rew00625#nCampo#;  |FINSI;

           |C_M #rew00625#nCampo#, 1, "N";
     |SIGUE;

     |HAZ CreaLineal26;
|FPRC;

|PROCESO Evento20;
     |SI enModoReg ! 4;  |ACABA;  |FINSI;

     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#rem00025.=;

         |ESTADO_CONTROL nBotonInIm,   "ENABLE";
         |ESTADO_CONTROL nBotonCntr,   "ENABLE";

         |SI enModo = 4;
             |ESTADO_CONTROL nBotonAlta, "DISABLE";
             |ESTADO_CONTROL nBotonModi, "DISABLE";
             |ESTADO_CONTROL nBotonBaja, "DISABLE";
         |SINO;
             |ESTADO_CONTROL nBotonModi, "ENABLE";
             |ESTADO_CONTROL nBotonBaja, "ENABLE";
         |FINSI;

         |PULSATECLA;

         nEntrar   = 1;
         enModoReg = 4;
         |HAZ PintaDatosPantalla;
     |FINSI;

     |SI FSalida = 4;
         |SI enModo = 4;  |ACABA;  |FINSI;

         |HAZ Modificar;
     |FINSI;
|FPRC;

|PROCESO IntroImp;
     |CIERRAT #rem00026;

     |VENTANA 0501, 0502, -1, 1, "";
     n1Vnt = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vnt;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     enLin    = #rew00625#1;
     eaModal  = #rew00625#11;
     ea32_1   = #rew00625#31;
     ea32_2_1 = #rew00625#32;
     |SUB_EJECUTA "rem00026";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vnt;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vnt;

     |ABRET #rem00026;

     |POSICIONATE #rew00625#12;

     |REFRESCACONTROL nGrid26;

     #rew00625#25 = en0180;            |PINTA #rew00625#25;
     #rew00625#26 = en0218;            |PINTA #rew00625#26;
     #rew00625#27 = en0220 + en0223;   |PINTA #rew00625#27;
     #rew00625#28 = en0224;            |PINTA #rew00625#28;
     #rew00625#29 = en0225;
     #rew00625#30 = en0226;            |PINTA #rew00625#30;
|FPRC;

|PROCESO BotonesPanta;
     |CONTROL_SIMPLE nPanta, "BOTON,{{193}}&Alta ", 1264, 1274, Alta;
     nBotonAlta = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}&Modificar ", 1276, 1286, Modificar;
     nBotonModi = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{199}}&Borrar", 1288, 1298, Baja;
     nBotonBaja = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}} &Y", 1340, 1344, BotonCntr;
     nBotonCntr = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{227}}&Introducci¢n", 2682, 2698, IntroImp;
     nBotonInIm = FSalida;

     |ESTADO_CONTROL nBotonModi,   "DISABLE";
     |ESTADO_CONTROL nBotonBaja,   "DISABLE";
     |ESTADO_CONTROL nBotonInIm,   "DISABLE";
     |ESTADO_CONTROL nBotonCntr,   "DISABLE";

     nEntrar = 0;

     |SI enModo = 4;
         |ESTADO_CONTROL nBotonAlta, "DISABLE";
     |FINSI;
|FPRC;

|PROCESO Baja20;
     #rem00025#0 = enEmpresa;
     #rem00025#1 = 1;
|FPRC;

|PROCESO Alta20;
     #rem00025#0 = enEmpresa;
     #rem00025#1 = 99;
|FPRC;

|PROGRAMA;
     |HAZ CargaColores;

     enSwRetorno = 0;
     aQueQuiero  = "|NC";
     aNumCampos  = #rem00025#aQueQuiero#;
     nNumCampos  = aNumCampos;
     nNumCampos  = nNumCampos - 1;
     nRango      = 4 + 8 + 16 + 32 + 128;
     enModoReg   = 4;

     |PINPA #0#rew00625;  nPanta = FSalida;

     |HAZ BotonesPanta;

     |DDEFECTO #rem00025;
     |HAZ PintaDatosPantalla;

     |ABRET #rem00025;
     |ABRET #rem00026;

     |LINEAL_SIMPLE #1#rem00025, nRango, 0602, 1198, Baja20, Alta20, Evento20;
     nGrid25 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{001}}sa&Lir", 3488, 3498, Ptec806;
     enBtnSalir = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::," + nGrid25;
          |LEETECLA aTecla;

          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;

          |SI aTecla = aRetu;
              |HAZ Modificar;
          |FINSI;
     |SIGUE;

     |SI nGrid26 ! -1;
         |FIN_CONTROL_WINDOWS nGrid26;
     |FINSI;

     |CIERRAT #rem00025;
     |CIERRAT #rem00026;

     eaPrograma   = "rem00025";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRO;
