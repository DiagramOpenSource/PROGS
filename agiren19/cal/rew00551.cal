|FICHEROS;
      rew00551;

      rem00022;
      rem00023;
      rem00024;
      rem00051;
      rem00052;
|FIN;

|VARIABLES;
      nSwHay     = 0;
      nTotal     = 0;
      nVentana   = 0;
      nRango     = 0;
      nGrid      = 0;

      aFichero   = "";
      aEsc1      = "";
      aEsc2      = "";
      aRetu      = "";
      aTecla     = "";

      &enEmpresa = 0;
      &eaAzul    = "";
|FIN;

|PROCESO Total;
     #rew00551#0 = "z";
     #rew00551#1 = 998;
     |LEE 101#rew00551.=;
     |SI FSalida ! 0;
         |DDEFECTO #rew00551;
         #rew00551#0 = "z";
         #rew00551#1 = 998;
         |GRABA 020#rew00551.n;
         |LIBERA #rew00551;
     |FINSI;

     #rew00551#0 = "z";
     #rew00551#1 = 999;
     |LEE 101#rew00551.=;
     |SI FSalida ! 0;
         |DDEFECTO #rew00551;
         #rew00551#0 = "z";
         #rew00551#1 = 999;
         #rew00551#2 = "TOTAL MOBILIARIO";
         |GRABA 020#rew00551.b;
     |FINSI;

     #rew00551#5 = #rew00551#5 + nTotal;
     #rew00551#6 = eaAzul;
     |GRABA 020#rew00551.a;
     |LIBERA #rew00551;
|FPRC;

|PROCESO LiquidaB1;
     |DDEFECTO #rew00551;

     #rew00551#0 = "rem00022";
     #rew00551#1 = #rem00022#1;
     #rew00551#2 = "PARTICIPACIONES EN FONDOS PROPIOS (ACCIONES ...)";
     #rew00551#3 = #rem00022#2;
     #rew00551#4 = #rem00022#17;
     #rew00551#5 = #rem00022#22 - #rem00022#27;

     |GRABA 020#rew00551.n;
     |LIBERA #rew00551;
     nSwHay = 1;

     nTotal = #rew00551#5;  |HAZ Total;
|FPRC;

|PROCESO LiquidaB2;
     |DDEFECTO #rew00551;

     #rew00551#0 = "rem00023";
     #rew00551#1 = #rem00023#1;
     #rew00551#2 = "INTERESES, CESION A TERCEROS Y OTROS RENDIMIENTOS";
     #rew00551#3 = #rem00023#2;
     #rew00551#4 = #rem00023#17;

     |SI #rem00023#19 = "I";
         #rew00551#5 = #rem00023#20 - #rem00023#23 - #rem00023#26;
     |FINSI;

     |SI #rem00023#19 = "C";
         #rew00551#5 = (#rem00023#20 + #rem00023#29) - (#rem00023#23 + #rem00023#32) - (#rem00023#26 + #rem00023#35);
     |FINSI;

     |SI #rem00023#19 = "O";
         #rew00551#5 = (#rem00023#20 + #rem00023#29) - (#rem00023#23 + #rem00023#32) - (#rem00023#26 + #rem00023#35);
     |FINSI;

     |GRABA 020#rew00551.n;
     |LIBERA #rew00551;

     nSwHay = 1;
     nTotal = #rew00551#5;  |HAZ Total;
|FPRC;

|PROCESO LiquidaB3;
     |DDEFECTO #rew00551;

     #rew00551#0 = "rem00024";
     #rew00551#1 = #rem00024#1;
     #rew00551#2 = "CONTRATO DE SEGURO, CAPITAL DIFERIDO";
     #rew00551#3 = #rem00024#2;
     #rew00551#4 = #rem00024#15;
     #rew00551#5 = #rem00024#18 - #rem00024#22 - #rem00024#24;

     |GRABA 020#rew00551.n;
     |LIBERA #rew00551;

     nSwHay = 1;
     nTotal = #rew00551#5;  |HAZ Total;
|FPRC;

|PROCESO LiquidaB4;
     |DDEFECTO #rew00551;

     #rew00551#0 = "rem00051";
     #rew00551#1 = #rem00051#1;
     #rew00551#2 = "RENTAS VITALICIAS O TEMPORALES";
     #rew00551#3 = #rem00051#2;
     #rew00551#4 = #rem00051#17;
     #rew00551#5 = #rem00051#26;

     |GRABA 020#rew00551.n;
     |LIBERA #rew00551;

     nSwHay = 1;
     nTotal = #rew00551#5;  |HAZ Total;
|FPRC;

|PROCESO LiquidaB5;
     |DDEFECTO #rew00551;

     #rew00551#0 = "rem00052";
     #rew00551#1 = #rem00052#1;
     #rew00551#2 = "DEUDA PUBLICA";
     #rew00551#3 = #rem00052#2;
     #rew00551#4 = #rem00052#16;
     |SI #rem00052#17 ] "31.12.1996";
         #rew00551#5 = #rem00052#24 + #rem00052#22;
         |GRABA 020#rew00551.n;
         |LIBERA #rew00551;

         nSwHay = 1;
         nTotal = #rew00551#5;  |HAZ Total;
     |FINSI;
|FPRC;

|DEFBUCLE rem00022;
     #rem00022#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     ;
     NULL, LiquidaB1;
|FIN;

|DEFBUCLE rem00023;
     #rem00023#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     ;
     NULL, LiquidaB2;
|FIN;

|DEFBUCLE rem00024;
     #rem00024#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     ;
     NULL, LiquidaB3;
|FIN;

|DEFBUCLE rem00051;
     #rem00051#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     ;
     NULL, LiquidaB4;
|FIN;

|DEFBUCLE rem00052;
     #rem00052#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     ;
     NULL, LiquidaB5;
|FIN;

|PROGRAMA;
     |HAZ CargaColores;

     aFichero = Usuario;  |QBT aFichero;
     aFichero = (aFichero + "zzzzzzzz") % -108;
     |NOME_DAT #rew00551#aFichero#;
     |ABRE #rew00551;  |CIERRA #rew00551;  |DELINDEX #rew00551;

     nSwHay = 0;

     |ABRE #rew00551;
     |BUCLE rem00022;
     |BUCLE rem00023;
     |BUCLE rem00024;
     |BUCLE rem00051;
     |BUCLE rem00052;
     |CIERRA #rew00551;

     |SI nSwHay = 1;
         |PINPA #0#rew00551;

         nRango = 4 + 8 + 16 + 32;

         |ABRE #rew00551;
         |LEE 000#rew00551.p;

         |LINEAL_SIMPLE #1#rew00551, nRango, 0702, 3698, NULL, NULL, NULL;
         nGrid = FSalida;

         aEsc1  = &255 + "806";
         aEsc2  = &255 + "807";
         aRetu  = &255 + "802";
         |PARA; |SI;  |HACIENDO;
              FSalida = "::{{001}}Salir," + nGrid;
              |LEETECLA aTecla;
              |SI aTecla = aEsc1; |SAL;  |FINSI;
              |SI aTecla = aEsc2; |SAL;  |FINSI;
              |SI aTecla = aRetu; |SAL;  |FINSI;
         |SIGUE;

         |CIERRA #rew00551;
     |FINSI;

     |DELINDEX #rew00551;
|FPRO;

|PROCESO Tipo80;  |TIPO 80;
     FSalida = 3699;
|FPRC;
