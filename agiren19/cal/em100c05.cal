|FICHEROS;
     rem01002;
     rem01030;
     rem01031;
     rem01032;
     rem01033;
     rem01034;
     rem01035;
     rem01037;
     rem01045;
     rem01046;
     rem01047;

     m100h016;
     m100h017;
     m100h019;
|FIN;

|INCLUYE em100var;

|PROCESO rem01031c05;
     nConta  = nConta + 1;

     #m100h016#0 = nConta;
     |LEE 000#m100h016.=;
     |SI FSalida ! 0;
         |DDEFECTO #m100h016;

         #m100h016#0 = nConta;

         |SI nConta > 1;
             #m100h016#5 = "C";
         |FINSI;

         |GRABA 000#m100h016.b;
     |FINSI;

     nCmp = 5;

     eaTDato = "N"; enLong = 3;  enLongDec = 0;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#3;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;

     nCmp    = nCmp + 1;
     eaTDato = "N"; enLong = 1;  enLongDec = 0;
     eaAlfa = #rem01031#5; |HAZ TContribuyente; #m100h016#nCmp# = eaTContri;

     eaTDato = "N"; enLong = 1;  enLongDec = 0;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#6;  |HAZ FormatoCeroUno; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#7;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#8;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;

     eaTDato = "An"; enLong = 20;  enLongDec = 0;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#9;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#34; |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#35; |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;

     eaTDato = "F"; enLong = 8;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#10; |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#11; |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;

     eaTDato = "N";  enLong = 11;  enLongDec = 2;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#12;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#13;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#14;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#15;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#16;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#17;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#18;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#19;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#20;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#21;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#22;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#33;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#23;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#24;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;

     eaTDato = "N";  enLong = 4;  enLongDec = 0;
     nCalc = #rem01031#25;
     |SI nCalc < 0; nCalc = 0; |FINSI;
     nCmp    = nCmp + 1;  eaAlfa  = nCalc;         |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;

     eaTDato = "N";  enLong = 11;  enLongDec = 2;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#26;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#27;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#28;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#29;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#30;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#31;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01031#32;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;

     |SI #m100h016#0 = 1;
         eaTDato = "N";  enLong = 11;  enLongDec = 2;

         eaCasilla = "19-0385";  |HAZ SacaImporte;
         eaAlfa = enImp;  |HAZ FormatoCmp;     #m100h016#38 = eaAlfa;

         eaCasilla = "19-0386";  |HAZ SacaImporte;
         eaAlfa = enImp;  |HAZ FormatoCmp;     #m100h016#39 = eaAlfa;

         eaCasilla = "19-0387";  |HAZ SacaImporte;
         eaAlfa = enImp;  |HAZ FormatoCmp;     #m100h016#40 = eaAlfa;
     |FINSI;

     |GRABA 000#m100h016.a;
     |LIBERA #m100h016;
|FPRC;

|DEFBUCLE rem01031c05;
     #rem01031#1;
     ;
     enVEmpre, 0, aTipo2, 001;
     enVEmpre, 0, aTipo2, 999;
     ;
     NULL, rem01031c05;
|FIN;

|PROCESO rem01032c05;
     |SI nTipo = 1;
         |SI #rem01032#5 = 0;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI nTipo = 2;
         |SI #rem01032#6 = 0;
             |ACABA;
         |FINSI;
     |FINSI;

     nConta  = nConta + 1;

     #m100h016#0 = nConta;
     |LEE 000#m100h016.=;
     |SI FSalida ! 0;
         |DDEFECTO #m100h016;

         #m100h016#0 = nConta;

         |SI nConta > 1;
             #m100h016#5 = "C";
         |FINSI;

         |GRABA 000#m100h016.b;
     |FINSI;

     |SI nTipo = 1;  nCmp = 45;  |FINSI;
     |SI nTipo = 2;  nCmp = 47;  |FINSI;

     eaAlfa = #rem01032#4; |HAZ TContribuyente; #m100h016#nCmp# = eaTContri;

     eaTDato = "N";  enLong = 11;  enLongDec = 2;

     |SI nTipo = 1;
         nCmp    = nCmp + 1;  eaAlfa  = #rem01032#5;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     |FINSI;

     |SI nTipo = 2;
         nCmp    = nCmp + 1;  eaAlfa  = #rem01032#6;  |HAZ FormatoCmp; #m100h016#nCmp# = eaAlfa;
     |FINSI;

     |SI #m100h016#0 = 1;
         |SI nTipo = 1;
             eaCasilla = "21-0393";  |HAZ SacaImporte;
             eaAlfa = enImp;  |HAZ FormatoCmp;     #m100h016#49 = eaAlfa;
         |FINSI;

         |SI nTipo = 2;
             eaCasilla = "21-0396";  |HAZ SacaImporte;
             eaAlfa = enImp;  |HAZ FormatoCmp;     #m100h016#50 = eaAlfa;
         |FINSI;
     |FINSI;

     |GRABA 000#m100h016.a;
     |LIBERA #m100h016;
|FPRC;

|DEFBUCLE rem01032c05;
     #rem01032#1;
     ;
     enVEmpre, 0, aTipo2, 001;
     enVEmpre, 0, aTipo2, 999;
     ;
     NULL, rem01032c05;
|FIN;

|PROCESO rem01002c05;
     |SI #rem01002#8  ! 0;  nTit = 1;  |FINSI;
     |SI #rem01002#9  ! 0;  nCon = 1;  |FINSI;
     |SI #rem01002#10 ! 0;  nHi1 = 1;  |FINSI;
     |SI #rem01002#11 ! 0;  nHi2 = 1;  |FINSI;
     |SI #rem01002#12 ! 0;  nHi3 = 1;  |FINSI;
     |SI #rem01002#13 ! 0;  nHi4 = 1;  |FINSI;
|FPRC;

|DEFBUCLE rem01002c05;
     #rem01002#2;
     ;
     enVEmpre, 0, eaVTipo, nDBlo, aDCas;
     enVEmpre, 0, eaVTipo, nHBlo, aHCas;
     ;
     NULL, rem01002c05;
|FIN;

|PROCESO PrepPagc05;
     |BUCLE rem01002c05;

     |SI nTit ! 0;
         nPagTit = 1;
     |FINSI;

     |SI nCon ! 0;
         nPagCon = 2;

         |SI nPagTit = 0;
             nPagCon = 1;
         |FINSI;
     |FINSI;

     |SI nHi1 ! 0;
         nPagHi1 = 3;

         |SI nPagCon = 0;
             nPagHi1 = 2;
         |FINSI;

         |SI nPagTit = 0;
          |Y nPagCon = 0;
             nPagHi1 = 1;
         |FINSI;
     |FINSI;

     |SI nHi2 ! 0;
         nPagHi2 = 4;

         |SI nPagHi1 = 0;
             nPagHi2 = 3;
         |FINSI;

         |SI nPagCon = 0;
          |Y nPagHi1 = 0;
             nPagHi2 = 2;
         |FINSI;

         |SI nPagTit = 0;
          |Y nPagCon = 0;
          |Y nPagHi1 = 0;
             nPagHi2 = 1;
         |FINSI;
     |FINSI;

     |SI nHi3 ! 0;
         nPagHi3 = 5;

         |SI nPagHi2 = 0;
             nPagHi3 = 4;
         |FINSI;

         |SI nPagHi1 = 0;
          |Y nPagHi2 = 0;
             nPagHi3 = 3;
         |FINSI;

         |SI nPagCon = 0;
          |Y nPagHi1 = 0;
          |Y nPagHi2 = 0;
             nPagHi3 = 2;
         |FINSI;

         |SI nPagTit = 0;
          |Y nPagCon = 0;
          |Y nPagHi1 = 0;
          |Y nPagHi2 = 0;
             nPagHi3 = 1;
         |FINSI;
     |FINSI;

     |SI nHi4 ! 0;
         nPagHi4 = 6;

         |SI nPagHi3 = 0;
             nPagHi4 = 5;
         |FINSI;

         |SI nPagHi2 = 0;
          |Y nPagHi3 = 0;
             nPagHi4 = 4;
         |FINSI;

         |SI nPagHi1 = 0;
          |Y nPagHi2 = 0;
          |Y nPagHi3 = 0;
             nPagHi4 = 3;
         |FINSI;

         |SI nPagCon = 0;
          |Y nPagHi1 = 0;
          |Y nPagHi2 = 0;
          |Y nPagHi3 = 0;
             nPagHi4 = 2;
         |FINSI;

         |SI nPagTit = 0;
          |Y nPagCon = 0;
          |Y nPagHi1 = 0;
          |Y nPagHi2 = 0;
          |Y nPagHi3 = 0;
             nPagHi4 = 1;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Graba16;
     #m100h016#0 = nPag;
     |LEE 000#m100h016.=;
     |SI FSalida ! 0;
         |DDEFECTO #m100h016;

         #m100h016#0 = nPag;

         |SI nPag > 1;
             #m100h016#5 = "C";
         |FINSI;

         |GRABA 000#m100h016.b;
     |FINSI;

     |SI eaTContri ! "";
         aBlq   = eaCasilla % 102;
         |SI aBlq = "20";  #m100h016#42 = eaTContri;  |FINSI;
     |FINSI;

     eaTDato = "N";  enLong = 11;  enLongDec = 2;
     eaAlfa  = enImp;  |HAZ FormatoCmp;

     #m100h016#nCmp#  = eaAlfa;

     |GRABA 000#m100h016.a;
     |LIBERA #m100h016;
|FPRC;

|PROCESO MeteHoja16;
     |HAZ SacaImporte;
     |SI enImp = 0;  |ACABA;  |FINSI;

     nOk = 0;
     |SI aTipo = "CONJUNTA";     nOk = 1;  |FINSI;
     |SI aTipo = "CONJUNTAE";    nOk = 1;  |FINSI;
     |SI eaCasilla = "20-0390";  nOk = 0;  |FINSI;

     |SI nOk = 1;
         |SI enImpT ! 0;
             enImp = enImpT;
             nPag  = nPagTit;

             eaAlfa = "TITULAR"; |HAZ TContribuyente;
             |HAZ Graba16;
         |FINSI;

         |SI enImpC ! 0;
             enImp = enImpC;
             nPag  = nPagCon;

             eaAlfa = "CONYUGE"; |HAZ TContribuyente;
             |HAZ Graba16;
         |FINSI;

         |SI enImp1 ! 0;
             enImp = enImp1;
             nPag  = nPagHi1;

             eaAlfa = "1 FAMILIAR"; |HAZ TContribuyente;
             |HAZ Graba16;
         |FINSI;

         |SI enImp2 ! 0;
             enImp = enImp2;
             nPag  = nPagHi2;

             eaAlfa = "2 FAMILIAR"; |HAZ TContribuyente;
             |HAZ Graba16;
         |FINSI;

         |SI enImp3 ! 0;
             enImp = enImp3;
             nPag  = nPagHi3;

             eaAlfa = "3 FAMILIAR"; |HAZ TContribuyente;
             |HAZ Graba16;
         |FINSI;

         |SI enImp4 ! 0;
             enImp = enImp4;
             nPag  = nPagHi4;

             eaAlfa = "4 FAMILIAR"; |HAZ TContribuyente;
             |HAZ Graba16;
         |FINSI;

         |ACABA;
     |FINSI;

     nOk = 0;
     |SI aTipo = "CONJUNTA";     nOk = 1;  |FINSI;
     |SI aTipo = "CONJUNTAE";    nOk = 1;  |FINSI;

     nPag      = 1;
     eaTContri = "";
     |SI nOk = 0;
         eaAlfa = eaVTipo; |HAZ TContribuyente;
     |FINSI;

     |HAZ Graba16;
|FPRC;

|PROCESO PuntoG2_6;
     nPagTit = 1;
     nPagCon = 0;
     nPagHi1 = 0;
     nPagHi2 = 0;
     nPagHi3 = 0;
     nPagHi4 = 0;

     |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
         nTit    = 0;
         nCon    = 0;
         nHi1    = 0;
         nHi2    = 0;
         nHi3    = 0;
         nHi4    = 0;
         nPagTit = 0;
         nPagCon = 0;
         nPagHi1 = 0;
         nPagHi2 = 0;
         nPagHi3 = 0;
         nPagHi4 = 0;
         nDBlo   = 20;
         nHBlo   = 20;
         aDCas   = "0389";
         aHCas   = "0389";

         |HAZ PrepPagc05;
     |FINSI;

     eaCasilla = "20-0389";  nCmp = 43;  |HAZ MeteHoja16;
     eaCasilla = "20-0390";  nCmp = 44;  |HAZ MeteHoja16;
|FPRC;

|PROCESO Hoja16;
     enPagina = 16; |HAZ MiraObligatoria;
     |SI enConDatos = 0; |ACABA; |FINSI;

     aFicTmp = "m100h016" + Usuario;
     |NOME_DAT #m100h016#aFicTmp#;
     |ABRE #m100h016;  |CIERRA #m100h016;  |DELINDEX #m100h016;

     eaVTipo = eaTipo;
     aTipo   = eaVTipo % 0110;
     aTipo2  = (aTipo + "          ") % 110;

     |ABRE #m100h016;

     nConta = 0;  |BUCLE rem01031c05;

     |HAZ PuntoG2_6;

     nTipo = 1;   nConta = 0; |BUCLE rem01032c05;
     nTipo = 2;   nConta = 0; |BUCLE rem01032c05;

     |LEE 000#m100h016.p;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
         |PARA nCampo = 1;  |SI nCampo [ 54;  |HACIENDO nCampo = nCampo + 1;
               eaAlfa = #m100h016#nCampo#; |HAZ QuitaRaros;
               #m100h016#nCampo# = eaAlfa;

               eaAlfa = #m100h016#nCampo#;
               |XGRABA enHandle, eaAlfa;
         |SIGUE;
         eaAlfa = eaCRLF;  |XGRABA enHandle, eaAlfa;

         |LEE 000#m100h016.s;
     |SIGUE;

     |CIERRA #m100h016;
     |DELINDEX #m100h016;
|FPRC;

|PROCESO rem01030c05;
     nConta  = nConta + 1;

     #m100h017#0 = nConta;
     |LEE 000#m100h017.=;
     |SI FSalida ! 0;
         |DDEFECTO #m100h017;

         #m100h017#0 = nConta;

         |SI nConta > 1;
             #m100h017#5 = "C";
         |FINSI;

         |GRABA 000#m100h017.b;
     |FINSI;

     nCmp = 6;

     eaAlfa = #rem01030#4; |HAZ TContribuyente; #m100h017#nCmp# = eaTContri;

     eaTDato = "N";  enLong = 11;  enLongDec = 2;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01030#5;  |HAZ FormatoCmp; #m100h017#nCmp# = eaAlfa;

     |SI #m100h017#0 = 1;
         eaCasilla = "22-0400";  |HAZ SacaImporte;
         eaAlfa = enImp;  |HAZ FormatoCmp; #m100h017#8 = eaAlfa;
     |FINSI;

     |GRABA 000#m100h017.a;
     |LIBERA #m100h017;
|FPRC;

|DEFBUCLE rem01030c05;
     #rem01030#1;
     ;
     enVEmpre, 0, aTipo2, 001;
     enVEmpre, 0, aTipo2, 999;
     ;
     NULL, rem01030c05;
|FIN;

|PROCESO rem01034c05;
     nConta  = nConta + 1;

     #m100h017#0 = nConta;
     |LEE 000#m100h017.=;
     |SI FSalida ! 0;
         |DDEFECTO #m100h017;

         #m100h017#0 = nConta;

         |SI nConta > 1;
             #m100h017#5 = "C";
         |FINSI;

         |GRABA 000#m100h017.b;
     |FINSI;

     nCmp = 8;

     nCmp = nCmp + 1;  eaAlfa  = #rem01034#15; |HAZ FormatoCeroUno; #m100h017#nCmp# = eaAlfa;

     nCmp    = nCmp + 1;
     eaAlfa = #rem01034#5; |HAZ TContribuyente; #m100h017#nCmp# = eaTContri;

     eaTDato = "A";  enLong = 9;  enLongDec = 0;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01034#4;  |HAZ FormatoCmp; #m100h017#nCmp# = eaAlfa;

     eaTDato = "N";  enLong = 11;  enLongDec = 2;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01034#6;  |HAZ FormatoCmp; #m100h017#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01034#7;  |HAZ FormatoCmp; #m100h017#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01034#8;  |HAZ FormatoCmp; #m100h017#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01034#9;  |HAZ FormatoCmp; #m100h017#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01034#10; |HAZ FormatoCmp; #m100h017#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01034#11; |HAZ FormatoCmp; #m100h017#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01034#12; |HAZ FormatoCmp; #m100h017#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01034#13; |HAZ FormatoCmp; #m100h017#nCmp# = eaAlfa;

     |SI #m100h017#0 = 1;
         eaCasilla = "23-0412";  |HAZ SacaImporte;
         eaAlfa = enImp;  |HAZ FormatoCmp;     #m100h017#20 = eaAlfa;
     |FINSI;

     |GRABA 000#m100h017.a;
     |LIBERA #m100h017;
|FPRC;

|DEFBUCLE rem01034c05;
     #rem01034#1;
     ;
     enVEmpre, 0, aTipo2, 001;
     enVEmpre, 0, aTipo2, 999;
     ;
     NULL, rem01034c05;
|FIN;

|PROCESO Hoja17;
     enPagina = 17; |HAZ MiraObligatoria;
     |SI enConDatos = 0; |ACABA; |FINSI;

     aFicTmp = "m100h017" + Usuario;
     |NOME_DAT #m100h017#aFicTmp#;
     |ABRE #m100h017;  |CIERRA #m100h017;  |DELINDEX #m100h017;

     eaVTipo = eaTipo;
     aTipo   = eaVTipo % 0110;
     aTipo2  = (aTipo + "          ") % 110;

     |ABRE #m100h017;

     nConta = 0; |BUCLE rem01030c05;
     nConta = 0; |BUCLE rem01034c05;

     |ABRE #rem01033;
     #rem01033#0 = enVEmpre;
     #rem01033#1 = 0;
     #rem01033#2 = aTipo;
     |LEE 000#rem01033.=;
     |SI FSalida ! 0; |DDEFECTO #rem01033; |FINSI;
     |CIERRA #rem01033;

     #m100h017#0 = 1;
     |LEE 000#m100h017.=;
     |SI FSalida ! 0;
         |DDEFECTO #m100h017;

         #m100h017#0 = 1;

         |GRABA 000#m100h017.b;
     |FINSI;

     eaAlfa = #rem01033#43; |HAZ TContribuyente; #m100h017#21 = eaTContri;
     eaAlfa = #rem01033#45; |HAZ TContribuyente; #m100h017#23 = eaTContri;

     eaTDato = "N";  enLong = 2;  enLongDec = 0;
     eaAlfa = #rem01033#44; |HAZ FormatoCmp;     #m100h017#22 = eaAlfa;
     eaAlfa = #rem01033#46; |HAZ FormatoCmp;     #m100h017#24 = eaAlfa;

     eaAlfa  = #rem01033#47; |HAZ FormatoCeroUno; #m100h017#25 = eaAlfa;

     eaTDato = "N";  enLong = 11;  enLongDec = 2;
     eaAlfa = #rem01033#48; |HAZ FormatoCmp;     #m100h017#26 = eaAlfa;
     eaAlfa = #rem01033#49; |HAZ FormatoCmp;     #m100h017#27 = eaAlfa;
     eaAlfa = #rem01033#50; |HAZ FormatoCmp;     #m100h017#28 = eaAlfa;
     eaAlfa = #rem01033#51; |HAZ FormatoCmp;     #m100h017#29 = eaAlfa;
     eaAlfa = #rem01033#52; |HAZ FormatoCmp;     #m100h017#30 = eaAlfa;
     eaAlfa = #rem01033#53; |HAZ FormatoCmp;     #m100h017#31 = eaAlfa;
     eaAlfa = #rem01033#54; |HAZ FormatoCmp;     #m100h017#32 = eaAlfa;
     eaAlfa = #rem01033#55; |HAZ FormatoCmp;     #m100h017#33 = eaAlfa;
     eaAlfa = #rem01033#56; |HAZ FormatoCmp;     #m100h017#34 = eaAlfa;
     eaAlfa = #rem01033#57; |HAZ FormatoCmp;     #m100h017#35 = eaAlfa;

     |GRABA 000#m100h017.a;
     |LIBERA #m100h017;

     |LEE 000#m100h017.p;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
         |PARA nCampo = 1;  |SI nCampo [ 39;  |HACIENDO nCampo = nCampo + 1;
               eaAlfa = #m100h017#nCampo#; |HAZ QuitaRaros;
               #m100h017#nCampo# = eaAlfa;

               eaAlfa = #m100h017#nCampo#;
               |XGRABA enHandle, eaAlfa;
         |SIGUE;
         eaAlfa = eaCRLF;  |XGRABA enHandle, eaAlfa;

         |LEE 000#m100h017.s;
     |SIGUE;

     |CIERRA #m100h017;
     |DELINDEX #m100h017;
|FPRC;

|PROCESO Hoja18;
     enPagina = 18; |HAZ MiraObligatoria;
     |SI enConDatos = 0; |ACABA; |FINSI;

     eaCadena = "<T10018000> ";
     |HAZ GrabaCadena;

     eaTDato = "N";  enLong = 11;  enLongDec = 2;

     eaCasilla = "27-0420";  |HAZ MeteImpCadena;
     eaCasilla = "27-0431";  |HAZ MeteImpCadena;
     eaCasilla = "27-0432";  |HAZ MeteImpCadena;
     eaCasilla = "27-0433";  |HAZ MeteImpCadena;
     eaCasilla = "27-0434";  |HAZ MeteImpCadena;
     eaCasilla = "27-0435";  |HAZ MeteImpCadena;

     eaCasilla = "28-0424";  |HAZ MeteImpCadena;
     eaCasilla = "28-0436";  |HAZ MeteImpCadena;
     eaCasilla = "28-0439";  |HAZ MeteImpCadena;
     eaCasilla = "28-0440";  |HAZ MeteImpCadena;
     eaCasilla = "28-0441";  |HAZ MeteImpCadena;
     eaCasilla = "28-0442";  |HAZ MeteImpCadena;
     eaCasilla = "28-0443";  |HAZ MeteImpCadena;
     eaCasilla = "28-0444";  |HAZ MeteImpCadena;
     eaCasilla = "28-0445";  |HAZ MeteImpCadena;
     eaCasilla = "28-0447";  |HAZ MeteImpCadena;
     eaCasilla = "28-0429";  |HAZ MeteImpCadena;
     eaCasilla = "28-0446";  |HAZ MeteImpCadena;
     eaCasilla = "28-0449";  |HAZ MeteImpCadena;
     eaCasilla = "28-0450";  |HAZ MeteImpCadena;
     eaCasilla = "28-0451";  |HAZ MeteImpCadena;
     eaCasilla = "28-0452";  |HAZ MeteImpCadena;
     eaCasilla = "28-0453";  |HAZ MeteImpCadena;
     eaCasilla = "28-0454";  |HAZ MeteImpCadena;
     eaCasilla = "28-0455";  |HAZ MeteImpCadena;
     eaCasilla = "28-0448";  |HAZ MeteImpCadena;
     eaCasilla = "28-0460";  |HAZ MeteImpCadena;

     eaCadena = " " * 200;  |HAZ GrabaCadena;
     eaCadena = " " * 200;  |HAZ GrabaCadena;
     eaCadena = " " * 200;  |HAZ GrabaCadena;

     eaCadena = "</T10018000>" + eaCRLF; |HAZ GrabaCadena;
|FPRC;

|PROCESO rem01037c05;
     nConta  = nConta + 1;

     #m100h019#0 = nConta;
     |LEE 000#m100h019.=;
     |SI FSalida ! 0;
         |DDEFECTO #m100h019;

         #m100h019#0 = nConta;

         |SI nConta > 1;
             #m100h019#5 = "C";
         |FINSI;

         |GRABA 000#m100h019.b;
     |FINSI;

     nCmp = 7;

     eaAlfa = #rem01037#4; |HAZ TContribuyente; #m100h019#nCmp# = eaTContri;

     eaTDato = "N";  enLong = 11;  enLongDec = 2;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01037#5;  |HAZ FormatoCmp; #m100h019#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01037#10; |HAZ FormatoCmp; #m100h019#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01037#6;  |HAZ FormatoCmp; #m100h019#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01037#12; |HAZ FormatoCmp; #m100h019#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01037#7;  |HAZ FormatoCmp; #m100h019#nCmp# = eaAlfa;

     |SI #m100h019#0 = 1;
         eaCasilla = "30-0468";  |HAZ SacaImporte;
         eaAlfa = enImp;  |HAZ FormatoCmp;     #m100h019#13 = eaAlfa;

         eaCasilla = "30-0469";  |HAZ SacaImporte;
         eaAlfa = enImp;  |HAZ FormatoCmp;     #m100h019#14 = eaAlfa;
     |FINSI;

     |GRABA 000#m100h019.a;
     |LIBERA #m100h019;
|FPRC;

|DEFBUCLE rem01037c05;
     #rem01037#1;
     ;
     enVEmpre, 0, aTipo2, 001;
     enVEmpre, 0, aTipo2, 999;
     ;
     NULL, rem01037c05;
|FIN;

|PROCESO rem01045c05;
     nConta  = nConta + 1;

     #m100h019#0 = nConta;
     |LEE 000#m100h019.=;
     |SI FSalida ! 0;
         |DDEFECTO #m100h019;

         #m100h019#0 = nConta;

         |SI nConta > 1;
             #m100h019#5 = "C";
         |FINSI;

         |GRABA 000#m100h019.b;
     |FINSI;

     nCmp = 15;

     eaAlfa = #rem01045#4; |HAZ TContribuyente; #m100h019#nCmp# = eaTContri;

     eaTDato = "A";  enLong = 9;  enLongDec = 0;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01045#5;  |HAZ FormatoCmp; #m100h019#nCmp# = eaAlfa;

     eaTDato = "N";  enLong = 11;  enLongDec = 2;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01045#6;  |HAZ FormatoCmp; #m100h019#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01045#11; |HAZ FormatoCmp; #m100h019#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01045#7;  |HAZ FormatoCmp; #m100h019#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01045#8;  |HAZ FormatoCmp; #m100h019#nCmp# = eaAlfa;

     |SI #m100h019#0 = 1;
         eaCasilla = "31-0476";  |HAZ SacaImporte;
         eaAlfa = enImp;  |HAZ FormatoCmp;     #m100h019#21 = eaAlfa;
     |FINSI;

     |GRABA 000#m100h019.a;
     |LIBERA #m100h019;
|FPRC;

|DEFBUCLE rem01045c05;
     #rem01045#1;
     ;
     enVEmpre, 0, aTipo2, 001;
     enVEmpre, 0, aTipo2, 999;
     ;
     NULL, rem01045c05;
|FIN;

|PROCESO rem01035c05;
     nConta  = nConta + 1;

     #m100h019#0 = nConta;
     |LEE 000#m100h019.=;
     |SI FSalida ! 0;
         |DDEFECTO #m100h019;

         #m100h019#0 = nConta;

         |SI nConta > 1;
             #m100h019#5 = "C";
         |FINSI;

         |GRABA 000#m100h019.b;
     |FINSI;

     nCmp = 22;

     eaAlfa = #rem01035#4; |HAZ TContribuyente; #m100h019#nCmp# = eaTContri;

     eaTDato = "A";  enLong = 9;  enLongDec = 0;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01035#5;  |HAZ FormatoCmp; #m100h019#nCmp# = eaAlfa;

     eaTDato = "N";  enLong = 11;  enLongDec = 2;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01035#7;  |HAZ FormatoCmp; #m100h019#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01035#6;  |HAZ FormatoCmp; #m100h019#nCmp# = eaAlfa;

     |SI #m100h019#0 = 1;
         eaCasilla = "32-0481";  |HAZ SacaImporte;
         eaAlfa = enImp;  |HAZ FormatoCmp;     #m100h019#26 = eaAlfa;
     |FINSI;

     |GRABA 000#m100h019.a;
     |LIBERA #m100h019;
|FPRC;

|DEFBUCLE rem01035c05;
     #rem01035#1;
     ;
     enVEmpre, 0, aTipo2, 001;
     enVEmpre, 0, aTipo2, 999;
     ;
     NULL, rem01035c05;
|FIN;

|PROCESO rem01046c05;
     nConta  = nConta + 1;

     #m100h019#0 = nConta;
     |LEE 000#m100h019.=;
     |SI FSalida ! 0;
         |DDEFECTO #m100h019;

         #m100h019#0 = nConta;

         |SI nConta > 1;
             #m100h019#5 = "C";
         |FINSI;

         |GRABA 000#m100h019.b;
     |FINSI;

     nCmp = 27;

     eaAlfa = #rem01046#4; |HAZ TContribuyente; #m100h019#nCmp# = eaTContri;

     eaTDato = "A";  enLong = 20;  enLongDec = 0;
     aAlfa = #rem01046#5;  |QBF aAlfa;
     |SI aAlfa ! "";
         nCmp    = nCmp + 1;  eaAlfa  = aAlfa;   |HAZ FormatoCmp; #m100h019#nCmp# = eaAlfa;
         nCmp    = nCmp + 1;  eaAlfa  = "0";     |HAZ FormatoCmp; #m100h019#nCmp# = eaAlfa;
     |SINO;
         aAlfa = #rem01046#7;  |QBF aAlfa;
         |SI aAlfa ! "";
             nCmp    = nCmp + 1;  eaAlfa  = aAlfa;   |HAZ FormatoCmp; #m100h019#nCmp# = eaAlfa;
             nCmp    = nCmp + 1;  eaAlfa  = "1";     |HAZ FormatoCmp; #m100h019#nCmp# = eaAlfa;
         |SINO;
             nCmp    = nCmp + 1;  eaAlfa  = "";      |HAZ FormatoCmp; #m100h019#nCmp# = eaAlfa;
             nCmp    = nCmp + 1;  eaAlfa  = "0";     |HAZ FormatoCmp; #m100h019#nCmp# = eaAlfa;
         |FINSI;
     |FINSI;

     eaTDato = "N";  enLong = 11;  enLongDec = 2;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01046#6;  |HAZ FormatoCmp; #m100h019#nCmp# = eaAlfa;

     |SI #m100h019#0 = 1;
         eaCasilla = "33-0486";  |HAZ SacaImporte;
         eaAlfa = enImp;  |HAZ FormatoCmp;     #m100h019#31 = eaAlfa;
     |FINSI;

     |GRABA 000#m100h019.a;
     |LIBERA #m100h019;
|FPRC;

|DEFBUCLE rem01046c05;
     #rem01046#1;
     ;
     enVEmpre, 0, aTipo2, 001;
     enVEmpre, 0, aTipo2, 999;
     ;
     NULL, rem01046c05;
|FIN;

|PROCESO rem01047c05;
     nConta  = nConta + 1;

     #m100h019#0 = nConta;
     |LEE 000#m100h019.=;
     |SI FSalida ! 0;
         |DDEFECTO #m100h019;

         #m100h019#0 = nConta;

         |SI nConta > 1;
             #m100h019#5 = "C";
         |FINSI;

         |GRABA 000#m100h019.b;
     |FINSI;

     nCmp = 32;

     eaAlfa = #rem01047#4; |HAZ TContribuyente; #m100h019#nCmp# = eaTContri;

     eaTDato = "N";  enLong = 11;  enLongDec = 2;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01047#5;  |HAZ FormatoCmp; #m100h019#nCmp# = eaAlfa;
     nCmp    = nCmp + 1;  eaAlfa  = #rem01047#6;  |HAZ FormatoCmp; #m100h019#nCmp# = eaAlfa;

     |SI #m100h019#0 = 1;
         eaCasilla = "34-0490";  |HAZ SacaImporte;
         eaAlfa = enImp;  |HAZ FormatoCmp;     #m100h019#35 = eaAlfa;
     |FINSI;

     |GRABA 000#m100h019.a;
     |LIBERA #m100h019;
|FPRC;

|DEFBUCLE rem01047c05;
     #rem01047#1;
     ;
     enVEmpre, 0, aTipo2, 001;
     enVEmpre, 0, aTipo2, 999;
     ;
     NULL, rem01047c05;
|FIN;

|PROCESO Hoja19;
     enPagina = 19; |HAZ MiraObligatoria;
     |SI enConDatos = 0; |ACABA; |FINSI;

     aFicTmp = "m100h019" + Usuario;
     |NOME_DAT #m100h019#aFicTmp#;
     |ABRE #m100h019;  |CIERRA #m100h019;  |DELINDEX #m100h019;

     eaVTipo = eaTipo;
     aTipo   = eaVTipo % 0110;
     aTipo2  = (aTipo + "          ") % 110;

     |ABRE #m100h019;

     |ABRE #rem01033;
     #rem01033#0 = enVEmpre;
     #rem01033#1 = 0;
     #rem01033#2 = aTipo;
     |LEE 000#rem01033.=;
     |SI FSalida ! 0; |DDEFECTO #rem01033; |FINSI;
     |CIERRA #rem01033;

     #m100h019#0 = 1;
     |LEE 000#m100h019.=;
     |SI FSalida ! 0;
         |DDEFECTO #m100h019;

         #m100h019#0 = 1;

         |GRABA 000#m100h019.b;
     |FINSI;

     eaAlfa = #rem01033#83;  |HAZ FormatoCmp;     #m100h019#6 = eaAlfa;

     |GRABA 000#m100h019.a;
     |LIBERA #m100h019;

     nConta = 0; nEleme = 0; |BUCLE rem01037c05;
     nConta = 0; nEleme = 0; |BUCLE rem01045c05;
     nConta = 0;             |BUCLE rem01035c05;
     nConta = 0;             |BUCLE rem01046c05;
     nConta = 0;             |BUCLE rem01047c05;

     |LEE 000#m100h019.p;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
         |PARA nCampo = 1;  |SI nCampo [ 39;  |HACIENDO nCampo = nCampo + 1;
               eaAlfa = #m100h019#nCampo#; |HAZ QuitaRaros;
               #m100h019#nCampo# = eaAlfa;

               eaAlfa = #m100h019#nCampo#;
               |XGRABA enHandle, eaAlfa;
         |SIGUE;
         eaAlfa = eaCRLF;  |XGRABA enHandle, eaAlfa;

         |LEE 000#m100h019.s;
     |SIGUE;

     |CIERRA #m100h019;
     |DELINDEX #m100h019;
|FPRC;

|PROCESO Hoja20;
     enPagina = 20; |HAZ MiraObligatoria;
     |SI enConDatos = 0; |ACABA; |FINSI;

     eaVTipo = eaTipo;
     aTipo   = eaVTipo % 0110;

     |ABRE #rem01033;
     #rem01033#0 = enVEmpre;
     #rem01033#1 = 0;
     #rem01033#2 = aTipo;
     |LEE 000#rem01033.=;
     |SI FSalida ! 0; |DDEFECTO #rem01033; |FINSI;
     |CIERRA #rem01033;

     eaCadena = "<T10020000> ";
     |HAZ GrabaCadena;

     eaTDato = "N";  enLong = 11;  enLongDec = 2;

     eaCasilla = "35-0435";  |HAZ MeteImpCadena;
     eaCasilla = "35-0491";  |HAZ MeteImpCadena;
     eaCasilla = "35-0492";  |HAZ MeteImpCadena;
     eaCasilla = "35-0493";  |HAZ MeteImpCadena;
     eaCasilla = "35-0494";  |HAZ MeteImpCadena;
     eaCasilla = "35-0495";  |HAZ MeteImpCadena;
     eaCasilla = "35-0496";  |HAZ MeteImpCadena;
     eaCasilla = "35-0497";  |HAZ MeteImpCadena;
     eaCasilla = "35-0500";  |HAZ MeteImpCadena;
     eaCasilla = "35-0501";  |HAZ MeteImpCadena;
     eaCasilla = "35-0505";  |HAZ MeteImpCadena;

     eaCasilla = "36-0460";  |HAZ MeteImpCadena;
     eaCasilla = "36-0506";  |HAZ MeteImpCadena;
     eaCasilla = "36-0507";  |HAZ MeteImpCadena;
     eaCasilla = "36-0510";  |HAZ MeteImpCadena;

     eaCasilla = "37-0511";  |HAZ MeteImpCadena;
     eaCasilla = "37-0512";  |HAZ MeteImpCadena;
     eaCasilla = "37-0513";  |HAZ MeteImpCadena;
     eaCasilla = "37-0514";  |HAZ MeteImpCadena;
     eaCasilla = "37-0515";  |HAZ MeteImpCadena;
     eaCasilla = "37-0516";  |HAZ MeteImpCadena;
     eaCasilla = "37-0517";  |HAZ MeteImpCadena;
     eaCasilla = "37-0518";  |HAZ MeteImpCadena;
     eaCasilla = "37-0519";  |HAZ MeteImpCadena;
     eaCasilla = "37-0520";  |HAZ MeteImpCadena;
     eaCasilla = "37-0521";  |HAZ MeteImpCadena;
     eaCasilla = "37-0522";  |HAZ MeteImpCadena;
     eaCasilla = "37-0523";  |HAZ MeteImpCadena;
     eaCasilla = "37-0524";  |HAZ MeteImpCadena;

     eaCasilla = "38-0525";  |HAZ MeteImpCadena;
     eaCasilla = "38-0526";  |HAZ MeteImpCadena;

     eaCasilla = "38-0527";  |HAZ SacaImporte;

     eaTDato  = "A";  enLong = 9;  enLongDec = 0;
     eaAlfa   = #rem01033#157;  |HAZ FormatoCmp;
     eaCadena = eaAlfa;  |HAZ GrabaCadena;
     |QBF eaAlfa;

     eaCadena = "0";
     |SI eaAlfa = "";  |Y enImp ! 0;
         eaCadena = "1";
     |FINSI;
     |HAZ GrabaCadena;

     eaTDato  = "A";  enLong = 9;  enLongDec = 0;
     eaAlfa   = #rem01033#158;  |HAZ FormatoCmp;
     eaCadena = eaAlfa;  |HAZ GrabaCadena;
     |QBF eaAlfa;

     eaCadena = "0";
     |SI eaAlfa = "";  |Y enImp ! 0;
         eaCadena = "1";
     |FINSI;
     |HAZ GrabaCadena;

     eaTDato = "N";  enLong = 11;  enLongDec = 2;

     eaCasilla = "38-0527";  |HAZ MeteImpCadena;

     eaCadena = " " * 200;  |HAZ GrabaCadena;
     eaCadena = " " * 200;  |HAZ GrabaCadena;
     eaCadena = " " * 200;  |HAZ GrabaCadena;

     eaCadena = "</T10020000>" + eaCRLF; |HAZ GrabaCadena;
|FPRC;
