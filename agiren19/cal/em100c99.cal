|FICHEROS;
     rem01002;
     rem01043;

     rem00099;

     Referen@;
|FIN;

|INCLUYE em100var;

|PROCESO BuscaDato;
   #rem01002#0 = enEmpr;
   #rem01002#1 = 0;
   #rem01002#2 = eaTipo;
   #rem01002#3 = Bloque;
   #rem01002#5 = Casilla;
   |LEE 010#rem01002.=;
   |SI FSalida = 0;
       Casilla = #rem01002#7;
       SwError = 0;
   |SINO;
       Casilla = 0; SwError = 1;
   |FINSI;
|FPRC;

|PROCESO RevisaCampos;
     |SI eaFicheros = "rem01057";

         |ACABA;
     |FINSI;


   aAlfaC2 = aAlfaC1 - "-";
   |SI FSalida ! 0;
      nCalc = FSalida + 98; aAlfaC2 = aAlfaC2 % nCalc;
      nHCampo = aAlfaC2; aAlfaC2 = "-" + aAlfaC2;
      aAlfaC1 = aAlfaC1 - aAlfaC2;
      nDCampo = aAlfaC1;
   |SINO;
      nDCampo = aAlfaC2; nHCampo = aAlfaC2;
   |FINSI;
   |PARA nContCas = nDCampo; |SI nContCas [ nHCampo; |HACIENDO nContCas = nContCas + 1;
      aAlfaC2 = #Referen@#nContCas#; |QBF aAlfaC2;
      |SI aAlfaC2 ! ""; |Y aAlfaC2 ! "0"; |Y aAlfaC2 ! "0.00";
                        |Y aAlfaC2 ! "01.01.0000";
         nContRegs = nContRegs + 1; enConDatos = 1;
         |SI nContRegs > nApartados;
            nNumPags = nNumPags + 1; nContRegs = 1;
         |FINSI;
         |SAL;
      |FINSI;
   |SIGUE;
|FPRC;

|PROCESO MiraSiEntra;
   enConDatos = 0; enNumPags = 1; nPYG = 0;

   |SI eaFicheros = "rem01057";
       |DDEF aAlfa2; |QBF aAlfa2;
       aAlfa2 = aAlfa2 + "rem01057.mas";
       |CARGA_DEF aAlfa2, Referen@;
       |SI FSalida ! 0;  |ACABA;  |FINSI;

       |ABRE #Referen@;
       #Referen@#0 = enEmpr;
       #Referen@#1 = 0;
       #Referen@#2 = eaTipo; aTipo = #Referen@#2;
       #Referen@#3 = aDCmp;
       |LEE 000#Referen@.];
       |SI FSalida = 0; |Y #Referen@#0 = enEmpr; |Y #Referen@#1 = 0;
                        |Y #Referen@#2 = aTipo;
           |SI #Referen@#3 ] aDCmp;  |Y #Referen@#3 [ aHCmp;
               enConDatos = 1;
           |FINSI;
       |FINSI;
       |CIERRA #Referen@;
       |DESCARGA_DEF #Referen@;

       |ACABA;
   |FINSI;

   |SI eaFicheros = "";
      Bloque = 0;
      aAlfa = eaCasillas; |QBF aAlfa;
      |PARA; |SI aAlfa ! ""; |HACIENDO;
         aAlfa2 = aAlfa - ",";
         |SI FSalida ! 0;
            nCalc = ((FSalida / 100) ! 0) + 99;
            aAlfa1 = aAlfa2 % nCalc; aAlfa2 = aAlfa1 + ","; aAlfa = aAlfa - aAlfa2;
         |SINO;
            aAlfa1 = aAlfa; aAlfa = "";
         |FINSI;

         |QBT aAlfa1; aAlfa2 = aAlfa1;
         aAlfa2 = aAlfa2 - "B";                || Miro si selecciono bloque
         |SI FSalida ! 0;
            nCalc = FSalida + 4; aAlfa2 = aAlfa1 % nCalc;
            aAlfa1 = aAlfa1 - aAlfa2;
            aAlfa2 = aAlfa2 - ":"; aAlfa2 = aAlfa2 - "B"; Bloque = aAlfa2;
            aAlfa2 = aAlfa1;
         |FINSI;

         aAlfa2 = aAlfa2 - "-";                || Miro si hay intervalo
         |SI FSalida ! 0;
            nCalc = FSalida + 98; aAlfa2 = aAlfa2 % nCalc; aHCasilla = aAlfa2;
            aAlfa2 = "-" + aAlfa2; aAlfa1 = aAlfa1 - aAlfa2;
            aDCasilla = aAlfa1;
         |SINO;
            aDCasilla = aAlfa1; aHCasilla = aAlfa1;
         |FINSI;

         |SI aDCasilla = aHCasilla;
            Casilla = aDCasilla; |QBF Casilla; Casilla = ("0000" + Casilla) % -104;
            |HAZ BuscaDato;
            |SI SwError = 0;
                |QBF Casilla;
                |SI Casilla ! ""; |Y Casilla ! "0"; |Y Casilla ! "0.00";
                    enConDatos = 1; |SAL;
                |FINSI;
            |FINSI;
         |SINO;
            |PARA nContCas = aDCasilla; |SI nContCas [ aHCasilla; |HACIENDO nContCas = nContCas + 1;
               Casilla = nContCas; |QBF Casilla; Casilla = ("0000" + Casilla) % -104;
               |HAZ BuscaDato;
               |SI SwError = 0;
                   |QBF Casilla;
                   |SI Casilla ! ""; |Y Casilla ! "0"; |Y Casilla ! "0.00";
                       enConDatos = 1; |SAL;
                   |FINSI;
               |FINSI;
            |SIGUE;
            |SI enConDatos ! 0; |SAL; |FINSI;
         |FINSI;
      |SIGUE;
   |SINO;
      enNumPags = 0;

      aAlfa = eaFicheros; |QBF aAlfa;
      |PARA; |SI aAlfa ! ""; |HACIENDO;
         aAlfa2 = aAlfa - ",";
         |SI FSalida ! 0;
            nCalc = ((FSalida / 100) ! 0) + 99;
            aAlfa1 = aAlfa2 % nCalc; aAlfa2 = aAlfa1 + ","; aAlfa = aAlfa - aAlfa2;
         |SINO;
            aAlfa1 = aAlfa; aAlfa = "";
         |FINSI;

         nApartados = 1;
         |QBT aAlfa1;
         aAlfa2 = aAlfa1 - "(";
         |SI FSalida ! 0;
            nCalc = FSalida + 100; aAlfa2 = aAlfa1 % nCalc;
            nApartados = aAlfa2; aAlfa2 = "(" + aAlfa2 + ")";
            aAlfa1 = aAlfa1 - aAlfa2;
         |FINSI;

         |SI aAlfa1 = "rem01032"; nPYG = 1; |FINSI;

         |DDEF aAlfa2; |QBF aAlfa2;
         aAlfa2 = aAlfa2 + aAlfa1 + ".mas";
         |CARGA_DEF aAlfa2, Referen@;
         |SI FSalida = 0;
            nContRegs = nApartados; nNumPags = 0;
            |ABRE #Referen@;
            #Referen@#0 = enEmpr;
            #Referen@#1 = 0;
            #Referen@#2 = eaTipo; aTipo = #Referen@#2;
            #Referen@#3 = 0;
            |LEE 000#Referen@.];
            |PARA; |SI FSalida = 0; |Y #Referen@#0 = enEmpr; |Y #Referen@#1 = 0; |Y #Referen@#2 = aTipo; |HACIENDO;
               |SI nPYG = 0;
                  |SI eaCampos = "";
                     nContRegs = nContRegs + 1; enConDatos = 1;
                     |SI nContRegs > nApartados;
                        nNumPags = nNumPags + 1; nContRegs = 1;
                     |FINSI;
                  |SINO;
                     aAlfaX1 = eaCampos; |QBF aAlfaX1;
                     aAlfaX1 = aAlfaX1 - ",";
                     |SI FSalida = 0;
                        aAlfaC1 = eaCampos; |QBF aAlfaC1;
                        |HAZ RevisaCampos;
                     |SINO;
                        |PARA; |SI FSalida ! 0; |HACIENDO;
                           nCalc  = ((FSalida / 100) ! 0) + 99;
                           nCalc1 = FSalida + 98;
                           aAlfaC1 = aAlfaX1 % nCalc; |QBF aAlfaC1;
                           aAlfaX1 = aAlfaX1 % nCalc1;
                           |HAZ RevisaCampos;
                           |SI enConDatos = 1; |SAL; |FINSI;
                           aAlfaX1 = aAlfaX1 - ",";
                        |SIGUE;
                        |SI enConDatos = 0;
                           aAlfaC1 = aAlfaX1; |QBF aAlfaC1;
                           |SI aAlfaC1 ! ""; |HAZ RevisaCampos; |FINSI;
                        |FINSI;
                     |FINSI;
                  |FINSI;
               |SINO;
                  || Ganancias
                  |SI nVuelta = 1; aAlfaC2 = #Referen@#6; |FINSI;
                  || Perdidas
                  |SI nVuelta = 2; aAlfaC2 = #Referen@#8; |FINSI;
                  |QBF aAlfaC2;

                  |SI aAlfaC2 ! ""; |Y aAlfaC2 ! "0"; |Y aAlfaC2 ! "0.00";
                     nContRegs = nContRegs + 1; enConDatos = 1;
                     |SI nContRegs > nApartados;
                        nNumPags = nNumPags + 1; nContRegs = 1;
                     |FINSI;
                  |FINSI;
               |FINSI;
               |LEE 000#Referen@.s;
            |SIGUE;
            |SI nNumPags > enNumPags; enNumPags = nNumPags; |FINSI;
            |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
         |FINSI;
         |SI nPYG = 1; nVuelta = nVuelta + 1; |FINSI;
      |SIGUE;
   |FINSI;
|FPRC;

|PROCESO AfectoPat;
   |SI aCapit = "A1"; |O aCapit = "A2";
      |SI aCapit = "A1"; |Y #rem00099#22 = "N"; |ACABA; |FINSI;
      |SI aCapit = "A2"; |Y #rem00099#22 = "S"; |ACABA; |FINSI;
   |FINSI;

   aAlfa = eaTipo; |QBF aAlfa;
   |SI aAlfa = "ZPATRITIT";
      |SI #rem00099#3 = "CONYUGE   "; |ACABA;        |FINSI;
   |FINSI;
   |SI aAlfa = "ZPATRICON";
      |SI #rem00099#3 = "TITULAR   "; |ACABA;        |FINSI;
   |FINSI;

   enConDatos = 1;
   nTotalReg = nTotalReg + 1;
|FPRC;

|DEFBUCLE AfectoPat;
#rem00099#1;
;
enEmpr, aCapitulo, 001;
enEmpr, aCapitulo, 999;
;
NULL, AfectoPat;
|FIN;

|PROCESO SacaPags;
     nTotalReg = 0; |BUCLE AfectoPat;
     enNumPags = ((nTotalReg /  nCantPP) + 0.49) ! 0;
|FPRC;

|PROCESO LeeTotalComunidad;
     |ABRE #rem01043;
     #rem01043#0 = enEmpr;
     #rem01043#1 = 0;
     #rem01043#2 = eaTipo;
     #rem01043#3 = nComunidad;
     #rem01043#4 = 9999;
     |LEE 000#rem01043.=;
     |SI FSalida ! 0; |DDEFECTO #rem01043; |FINSI;
     |CIERRA #rem01043;

     |SI #rem01043#6 ! 0;  enConDatos = 1;  |FINSI;
|FPRC;

|PROCESO Obligadas100;
     enNumPags = 1;

     || Pagina 1  (OBLIGATORIA)
     |SI enPagina = 1;
         enConDatos = 1;
         |ACABA;
     |FINSI;

     || Pagina 2  (OBLIGATORIA)
     |SI enPagina = 2;
         enConDatos = 1;
         |ACABA;
     |FINSI;

     || Pagina 3
     |SI enPagina = 3;
         || Se Controla ella misma
         |ACABA;
     |FINSI;

     || Pagina 4
     |SI enPagina = 4;
         eaFicheros = "rem01010(1)";
         |HAZ MiraSiEntra;
         |SI enConDatos = 0;
             eaCasillas = "B001:1-25";
             eaFicheros = "";
             |HAZ MiraSiEntra;
         |FINSI;

         |ACABA;
     |FINSI;

     || Pagina 5
     |SI enPagina = 5;
         eaFicheros = "rem01016(1)";
         |HAZ MiraSiEntra;
         |SI enConDatos = 0;
             eaCasillas = "B002:26-41,B003:45-60";
             eaFicheros = "";
             |HAZ MiraSiEntra;
         |FINSI;

         |ACABA;
     |FINSI;

     || Pagina 6 y 7
     |SI enPagina = 6;
         eaFicheros = "rem01011(1)";
         |HAZ MiraSiEntra;
         |SI enConDatos = 0;
             eaCasillas = "B004:155-156";
             eaFicheros = "";
             |HAZ MiraSiEntra;
         |FINSI;

         |ACABA;
     |FINSI;

     || Pagina 8
     |SI enPagina = 8;
        eaFicheros = "rem01014(1)";
        |HAZ MiraSiEntra;
         |SI enConDatos = 0;
              eaCasillas = "B005:231-235";
              eaFicheros = "";
             |HAZ MiraSiEntra;
         |FINSI;

         |ACABA;
     |FINSI;

     || Pagina 9
     |SI enPagina = 9;
         eaFicheros = "rem01019(1)";
         |HAZ MiraSiEntra;
         |SI enConDatos = 0;
            eaCasillas = "B006:1482-1484";
            eaFicheros = "";
            |HAZ MiraSiEntra;
         |FINSI;

         |ACABA;
     |FINSI;

     || Pagina 10
     |SI enPagina = 10;
         eaFicheros = "rem01021(1)";
         |HAZ MiraSiEntra;
         |SI enConDatos = 0;
            eaCasillas = "B007:1558-1560";
            eaFicheros = "";
            |HAZ MiraSiEntra;
         |FINSI;

         |ACABA;
     |FINSI;

     || Pagina 11
     |SI enPagina = 11;
         eaFicheros = "rem01022(1)";
         |HAZ MiraSiEntra;

         |ACABA;
     |FINSI;

     || Pagina 12
     |SI enPagina = 12;
         eaFicheros = "rem01015(6)";
         |HAZ MiraSiEntra;
         |SI enConDatos ! 0;
             |ACABA;
         |FINSI;

         eaFicheros = "";
         eaCasillas = "B008:1601-1609";
         |HAZ MiraSiEntra;
         |SI enConDatos ! 0;
             |ACABA;
         |FINSI;

         eaCasillas = "B008:592-600";
         |HAZ MiraSiEntra;

         |ACABA;
     |FINSI;

     || Pagina 13
     |SI enPagina = 13;
         eaFicheros = "rem01023(1),rem01024(1),rem01028(1),rem01025(1)";
         |HAZ MiraSiEntra;
         |SI enConDatos = 0;
             eaCasillas = "B009:265-265,B010:270-270,B011:275-275";
             eaFicheros = "";
             |HAZ MiraSiEntra;
         |FINSI;

         |ACABA;
     |FINSI;

     || Pagina 14
     |SI enPagina = 14;
         eaFicheros = "rem01027(1)";
         |HAZ MiraSiEntra;
         |SI enConDatos = 0;
             eaCasillas = "B013:288-290,B014:297-297,B015:306-307,B016:324-325";
             eaFicheros = "";
             |HAZ MiraSiEntra;
         |FINSI;

         |ACABA;
     |FINSI;

     || Pagina 15
     |SI enPagina = 15;
         eaFicheros = "rem01039(1),rem01038(1)";
         |HAZ MiraSiEntra;
         |SI enConDatos = 0;
            eaCasillas = "B017:339-340,B018:354-355";
            eaFicheros = "";
            |HAZ MiraSiEntra;
         |FINSI;

         |ACABA;
     |FINSI;

     || Pagina 16
     |SI enPagina = 16;
         nVuelta = 1;
         eaFicheros = "rem01031(1),rem01032(1)";
         |HAZ MiraSiEntra;
         |SI enConDatos = 0;
            eaCasillas = "B019:385-387,B020:390,B021:393-396";
            eaFicheros = "";
            |HAZ MiraSiEntra;
         |FINSI;

         |ACABA;
     |FINSI;

     || Pagina 17
     |SI enPagina = 17;
         nVuelta = 1;
         eaFicheros = "rem01030(1),rem01034(1)";
         |HAZ MiraSiEntra;
         |SI enConDatos = 0;
             eaCasillas = "B022:400,B023:412,B024:418-421,B025:422-425,B026:429-430";
             eaFicheros = "";
             |HAZ MiraSiEntra;
         |FINSI;

         |ACABA;
     |FINSI;

     || Pagina 18  (OBLIGATORIA)
     |SI enPagina = 18;
         enConDatos = 1;
         |ACABA;
     |FINSI;

     || Pagina 19
     |SI enPagina = 19;
         nVuelta = 1;
         eaFicheros = "rem01037(1),rem01045(1),rem01035(1),rem01046(1),";
         eaFicheros = aFicheros + "rem01047(1)";
         |HAZ MiraSiEntra;
         |SI enConDatos = 0;
             eaCasillas = "B029:461,B030:468-469,B031:476,B032:481,B033:486,B033:490";
             eaFicheros = "";
             |HAZ MiraSiEntra;
         |FINSI;

         |ACABA;
     |FINSI;

     || Pagina 20  (OBLIGATORIA)
     |SI enPagina = 20;
         enConDatos = 1;
         |ACABA;
     |FINSI;

     || Pagina 21  (OBLIGATORIA)
     |SI enPagina = 21;
         enConDatos = 1;
         |ACABA;
     |FINSI;

     || Pagina 22  (OBLIGATORIA)
     |SI enPagina = 22;
         enConDatos = 1;
         |ACABA;
     |FINSI;

     || Pagina 23  (OBLIGATORIA)
     |SI enPagina = 23;
         enConDatos = 1;
         |ACABA;
     |FINSI;

     || Pagina 24
     |SI enPagina = 24;
         eaFicheros = "";
         eaCasillas = "B047:693-695,B048:694-695";
         |HAZ MiraSiEntra;

         |ACABA;
     |FINSI;

     || Pagina 25 : ANEXO A.1  (Datos en el rem01041)
     |SI enPagina = 25;
         eaFicheros = "rem01041(1)"; eaCampos = "3-37"; |HAZ MiraSiEntra;

         |ACABA;
     |FINSI;

     || Pagina 26 : ANEXO A.2  (Datos en el rem01041 y rem01042)
     |SI enPagina = 26;
         eaFicheros = "rem01041(1)"; eaCampos = "38-54";  |HAZ MiraSiEntra;
         |SI enConDatos = 1; |ACABA;  |FINSI;

         eaFicheros = "rem01041(1)"; eaCampos = "80-86";  |HAZ MiraSiEntra;
         |SI enConDatos = 1; |ACABA;  |FINSI;

         eaFicheros = "rem01042(1)"; eaCampos = "37-54";  |HAZ MiraSiEntra;
         |SI enConDatos = 1; |ACABA;  |FINSI;

         eaFicheros = "rem01042(1)"; eaCampos = "60-62";  |HAZ MiraSiEntra;

         |ACABA;
     |FINSI;

     || Pagina 27 : ANEXO A.3  (Datos en el rem01042)
     |SI enPagina = 27;
         eaFicheros = "rem01057(1)"; aDCmp = "0759";  aHCmp = "0749"; |HAZ MiraSiEntra;
         |SI enConDatos = 1; |ACABA;  |FINSI;

         eaFicheros = "rem01057(1)"; aDCmp = "0843";  aHCmp = "0843"; |HAZ MiraSiEntra;
         |SI enConDatos = 1; |ACABA;  |FINSI;

         eaFicheros = "rem01057(1)"; aDCmp = "0760";  aHCmp = "0768"; |HAZ MiraSiEntra;
         |SI enConDatos = 1; |ACABA;  |FINSI;

         eaFicheros = "rem01057(1)"; aDCmp = "0771";  aHCmp = "0820"; |HAZ MiraSiEntra;

         |ACABA;
     |FINSI;

     || Pagina 28 : ANEXO A.4  (Datos en el rem01042)
     |SI enPagina = 28;
         eaFicheros = "rem01042(1)"; eaCampos = "3-36"; |HAZ MiraSiEntra;
         |SI enConDatos = 1; |ACABA;  |FINSI;

         eaFicheros = "rem01057(1)"; aDCmp = "0807";  aHCmp = "0829"; |HAZ MiraSiEntra;
         |SI enConDatos = 1; |ACABA;  |FINSI;

         eaFicheros = "rem01057(1)"; aDCmp = "0769";  aHCmp = "0770"; |HAZ MiraSiEntra;

         |ACABA;
     |FINSI;

     || Pagina 29 : ANEXO B.1
     |SI enPagina = 29;
         enConDatos = 0;
         nComunidad = 1;  |HAZ LeeTotalComunidad;  |SI enConDatos = 1; |ACABA;  |FINSI;
         nComunidad = 2;  |HAZ LeeTotalComunidad;  |SI enConDatos = 1; |ACABA;  |FINSI;
         nComunidad = 3;  |HAZ LeeTotalComunidad;  |SI enConDatos = 1; |ACABA;  |FINSI;
     |FINSI;

     || Pagina 30 : ANEXO B.2
     |SI enPagina = 30;
         enConDatos = 0;
         nComunidad = 4;  |HAZ LeeTotalComunidad;  |SI enConDatos = 1; |ACABA;  |FINSI;
         nComunidad = 5;  |HAZ LeeTotalComunidad;  |SI enConDatos = 1; |ACABA;  |FINSI;
     |FINSI;

     || Pagina 31 : ANEXO B.3
     |SI enPagina = 31;
         enConDatos = 0;
         nComunidad = 6;  |HAZ LeeTotalComunidad;  |SI enConDatos = 1; |ACABA;  |FINSI;
         nComunidad = 7;  |HAZ LeeTotalComunidad;  |SI enConDatos = 1; |ACABA;  |FINSI;
         nComunidad = 8;  |HAZ LeeTotalComunidad;  |SI enConDatos = 1; |ACABA;  |FINSI;
     |FINSI;

     || Pagina 32 : ANEXO B.4
     |SI enPagina = 32;
         enConDatos = 0;
         nComunidad = 9;   |HAZ LeeTotalComunidad;  |SI enConDatos = 1; |ACABA;  |FINSI;
         nComunidad = 10;  |HAZ LeeTotalComunidad;  |SI enConDatos = 1; |ACABA;  |FINSI;
         nComunidad = 11;  |HAZ LeeTotalComunidad;  |SI enConDatos = 1; |ACABA;  |FINSI;
     |FINSI;

     || Pagina 33 : ANEXO B.5
     |SI enPagina = 33;
         enConDatos = 0;
         nComunidad = 12;  |HAZ LeeTotalComunidad;  |SI enConDatos = 1; |ACABA;  |FINSI;
         nComunidad = 13;  |HAZ LeeTotalComunidad;  |SI enConDatos = 1; |ACABA;  |FINSI;
         nComunidad = 16;  |HAZ LeeTotalComunidad;  |SI enConDatos = 1; |ACABA;  |FINSI;
     |FINSI;

     || Pagina 34 : ANEXO B.6
     |SI enPagina = 34;
         enConDatos = 0;
         nComunidad = 17;  |HAZ LeeTotalComunidad;
         |SI enConDatos = 1; |ACABA;  |FINSI;

         eaFicheros = "rem01040(1)"; eaCampos = "9-11";  |HAZ MiraSiEntra;
     |FINSI;

     || Pagina 35 : ANEXO B.7
     |SI enPagina = 35;
         eaFicheros = "rem01040(1)"; eaCampos = "12-51";  |HAZ MiraSiEntra;
     |FINSI;

     || Pagina 36 : ANEXO B.8
     |SI enPagina = 36;
         eaFicheros = "rem01040(1)"; eaCampos = "52-83";  |HAZ MiraSiEntra;
     |FINSI;

     || Pagina 41 : I+D (OBLIGATORIA)
     |SI enPagina = 41; enConDatos = 1; |FINSI;
|FPRC

|PROCESO Obligadas714;
     || Pagina 1  (OBLIGATORIA)
     |SI enPagina = 1; enConDatos = 1; enNumPags = 1; |FINSI;

     || Pagina 2
     |SI enPagina = 2;
        enConDatos = 0;
        aCapitulo = "A1"; nCantPP = 4;  aCapit = "A1"; |HAZ SacaPags; nCalc1 = enNumPags;
        aCapitulo = "A1"; nCantPP = 7;  aCapit = "A2"; |HAZ SacaPags; nCalc2 = enNumPags;
        aCapit = "";
        aCapitulo = "B1"; nCantPP = 8; |HAZ SacaPags; nCalc3 = enNumPags;
        enNumPags = 0;
        |SI enNumPags < nCalc1; enNumPags = nCalc1; |FINSI;
        |SI enNumPags < nCalc2; enNumPags = nCalc2; |FINSI;
        |SI enNumPags < nCalc3; enNumPags = nCalc3; |FINSI;
     |FINSI;

     || Pagina 3
     |SI enPagina = 3;
        enConDatos = 0;
        aCapitulo = "C1"; nCantPP = 7;  |HAZ SacaPags; nCalc1 = enNumPags;
        aCapitulo = "C2"; nCantPP = 5;  |HAZ SacaPags; nCalc2 = enNumPags;
        aCapitulo = "D1"; nCantPP = 10; |HAZ SacaPags; nCalc3 = enNumPags;
        enNumPags = 0;
        |SI enNumPags < nCalc1; enNumPags = nCalc1; |FINSI;
        |SI enNumPags < nCalc2; enNumPags = nCalc2; |FINSI;
        |SI enNumPags < nCalc3; enNumPags = nCalc3; |FINSI;
     |FINSI;

     || Pagina 4
     |SI enPagina = 4;
        enConDatos = 0;
        aCapitulo = "E1"; nCantPP = 10; |HAZ SacaPags; nCalc1 = enNumPags;
        aCapitulo = "F1"; nCantPP = 10; |HAZ SacaPags; nCalc2 = enNumPags;
        aCapitulo = "F2"; nCantPP = 6;  |HAZ SacaPags; nCalc3 = enNumPags;
        enNumPags = 0;
        |SI enNumPags < nCalc1; enNumPags = nCalc1; |FINSI;
        |SI enNumPags < nCalc2; enNumPags = nCalc2; |FINSI;
        |SI enNumPags < nCalc3; enNumPags = nCalc3; |FINSI;
     |FINSI;

     || Pagina 5
     |SI enPagina = 5;
        enConDatos = 0;
        aCapitulo = "G1"; nCantPP = 8;  |HAZ SacaPags; nCalc1 = enNumPags;
        aCapitulo = "G2"; nCantPP = 8;  |HAZ SacaPags; nCalc2 = enNumPags;
        aCapitulo = "G3"; nCantPP = 4;  |HAZ SacaPags; nCalc3 = enNumPags;
        aCapitulo = "G4"; nCantPP = 4;  |HAZ SacaPags; nCalc4 = enNumPags;
        enNumPags = 0;
        |SI enNumPags < nCalc1; enNumPags = nCalc1; |FINSI;
        |SI enNumPags < nCalc2; enNumPags = nCalc2; |FINSI;
        |SI enNumPags < nCalc3; enNumPags = nCalc3; |FINSI;
        |SI enNumPags < nCalc4; enNumPags = nCalc4; |FINSI;
     |FINSI;

     || Pagina 6
     |SI enPagina = 6;
        enConDatos = 0;
        aCapitulo = "H1"; nCantPP = 3; |HAZ SacaPags; nCalc1 = enNumPags;
        aCapitulo = "H2"; nCantPP = 3; |HAZ SacaPags; nCalc2 = enNumPags;
        aCapitulo = "I1"; nCantPP = 3; |HAZ SacaPags; nCalc3 = enNumPags;
        aCapitulo = "J1"; nCantPP = 3; |HAZ SacaPags; nCalc4 = enNumPags;
        enNumPags = 0;
        |SI enNumPags < nCalc1; enNumPags = nCalc1; |FINSI;
        |SI enNumPags < nCalc2; enNumPags = nCalc2; |FINSI;
        |SI enNumPags < nCalc3; enNumPags = nCalc3; |FINSI;
        |SI enNumPags < nCalc4; enNumPags = nCalc4; |FINSI;
     |FINSI;

     || Pagina 7
     |SI enPagina = 7;
        enConDatos = 0;
        aCapitulo = "K1"; nCantPP = 7; |HAZ SacaPags; nCalc1 = enNumPags;
        aCapitulo = "L1"; nCantPP = 6; |HAZ SacaPags; nCalc2 = enNumPags;
        aCapitulo = "M1"; nCantPP = 6; |HAZ SacaPags; nCalc3 = enNumPags;
        aCapitulo = "N1"; nCantPP = 3; |HAZ SacaPags; nCalc4 = enNumPags;
        enNumPags = 0;
        |SI enNumPags < nCalc1; enNumPags = nCalc1; |FINSI;
        |SI enNumPags < nCalc2; enNumPags = nCalc2; |FINSI;
        |SI enNumPags < nCalc3; enNumPags = nCalc3; |FINSI;
        |SI enNumPags < nCalc4; enNumPags = nCalc4; |FINSI;
     |FINSI;

     || Pagina 8
     |SI enPagina = 8;
        enConDatos = 0;
        aCapitulo = "O1"; nCantPP = 3;  |HAZ SacaPags; nCalc1 = enNumPags;
        aCapitulo = "P1"; nCantPP = 3;  |HAZ SacaPags; nCalc2 = enNumPags;
        aCapitulo = "Q1"; nCantPP = 6;  |HAZ SacaPags; nCalc3 = enNumPags;
        aCapitulo = "U1"; nCantPP = 11; |HAZ SacaPags; nCalc4 = enNumPags;
        enNumPags = 0;
        |SI enNumPags < nCalc1; enNumPags = nCalc1; |FINSI;
        |SI enNumPags < nCalc2; enNumPags = nCalc2; |FINSI;
        |SI enNumPags < nCalc3; enNumPags = nCalc3; |FINSI;
        |SI enNumPags < nCalc4; enNumPags = nCalc4; |FINSI;
     |FINSI;

     || Pagina 9  (OBLIGATORIA)
     |SI enPagina = 9; enConDatos = 1; enNumPags = 1; |FINSI;

     || Pagina 10 (OBLIGATORIA)
     |SI enPagina = 10; enConDatos = 1; enNumPags = 1; |FINSI;

     || Pagina 11 (OBLIGATORIA)
     |SI enPagina = 11; enConDatos = 1; enNumPags = 1; |FINSI;
|FPRC;

|PROCESO MiraObligatoria;
     |ABRE #rem01002;
     |SELECT #2#rem01002;

     |SI eaModelo = "100";
         |HAZ Obligadas100;
     |FINSI;

     |SI eaModelo = "714";
         |HAZ Obligadas714;
     |FINSI;

     eaCampos = ""; eaFicheros = "";

     |CIERRA #rem01002;
|FPRC;

|PROCESO SacaImporte;
     aBlq = eaCasilla % 102;
     aCas = eaCasilla % 404;

     enImp  = 0;
     enImpT = 0;
     enImpC = 0;
     enImp1 = 0;
     enImp2 = 0;
     enImp3 = 0;
     enImp4 = 0;
     enError = 1;

     |ABRE #rem01002;
     |SELECT #2#rem01002;
     #rem01002#0 = enVEmpre;
     #rem01002#1 = 0;
     #rem01002#2 = eaVTipo;
     #rem01002#3 = aBlq;
     #rem01002#5 = aCas;
     |LEE 040#rem01002.=;
     |SI FSalida = 0;
         enImp      = #rem01002#7;
         enImpT     = #rem01002#8;
         enImpC     = #rem01002#9;
         enImp1     = #rem01002#10;
         enImp2     = #rem01002#11;
         enImp3     = #rem01002#12;
         enImp4     = #rem01002#13;
         enError    = 0;
     |FINSI;
     |CIERRA #rem01002;
|FPRC;

|PROCESO TContribuyente;
     aContri = eaVTipo;  |QBF aContri;

     |QBF eaAlfa;
     |SI eaAlfa = "";
         eaTContri = "0";
         |ACABA;
     |FINSI;

     |SI aSeparada = "S";
         eaTContri = "2";
     |SINO;
        eaTContri = "0";
        |SI eaAlfa = "TITULAR";
            eaTContri = "2";
        |FINSI;
        |SI eaAlfa = "CONYUGE";
            |SI enSwFalle = 1;
                eaTContri = "2";
            |SINO;
                |SI aContri = "CONYUGE";
                    eaTContri = "2";
                |SINO;
                    eaTContri = "3";
                |FINSI;
           |FINSI;
        |FINSI;

        |SI eaAlfa = "COMUNES";    eaTContri = "1"; |FINSI;
        |SI eaAlfa = "CONJUNTA";   eaTContri = "1"; |FINSI;
        |SI eaAlfa = "CONJUNTAE";  eaTContri = "1"; |FINSI;
        |SI eaAlfa = "GANANCIAL";  eaTContri = "1"; |FINSI;
        |SI eaAlfa = "1 FAMILIAR"; eaTContri = "4"; |FINSI;
        |SI eaAlfa = "2 FAMILIAR"; eaTContri = "5"; |FINSI;
        |SI eaAlfa = "3 FAMILIAR"; eaTContri = "6"; |FINSI;
        |SI eaAlfa = "4 FAMILIAR"; eaTContri = "7"; |FINSI;
        |SI eaAlfa = "VARIOS";     eaTContri = "2"; |FINSI;
     |FINSI;
|FPRC;

|PROCESO FormatoCeroUno;
     |SI eaAlfa = "X";
         eaAlfa = "1";
         |ACABA;
     |FINSI;

     |SI eaAlfa = "S";
         eaAlfa = "1";
         |ACABA;
     |FINSI;

     eaAlfa = "0";
|FPRC;

|PROCESO FormatoCmp;
     |QBF eaAlfa;
     |SI eaTDato = "F";
         eaAlfa = eaAlfa - "."; eaAlfa = eaAlfa - ".";
         |QBF eaAlfa;
         |SI eaAlfa = "";
             eaAlfa = "0" * 8;
         |FINSI;

         |SI eaAlfa = "01010000";
             eaAlfa = "0" * 8;
         |FINSI;

         |ACABA;
     |FINSI;

     Vacio1 = " " * enLong;
     |SI eaTDato = "N";
         Vacio1    = "0" * enLong;
         Vacio2    = "0" * enLongDec;
         eaAlfa    = eaAlfa - "-";
         nNegativo = 0;
         |SI FSalida ! 0;
             nNegativo = 1;
         |FINSI;
     |FINSI;

     |SI eaTDato ! "N";
         Calc1 = 100 + enLong; eaAlfa = (eaAlfa + Vacio1) % Calc1;
     |SINO;
         |SI enLongDec = 0;
             Calc1  = 0 - (100 + enLong);
             eaAlfa = (Vacio1 + eaAlfa) % Calc1;
         |SINO;
             eaAlfa = eaAlfa - ".";
             |SI FSalida = 0;
                 Calc1  = 0 - (100 + enLong);
                 eaAlfa = (Vacio1 + eaAlfa) % Calc1;
                 aAlfa1 = "0" * enLongDec;
             |SINO;
                 Calc1  = (((FSalida / 100) ! 0) - 1) + 100;
                 Calc2  = (((FSalida / 100) ! 0) * 100) + 99;
                 aAlfa1 = eaAlfa % Calc2;
                 eaAlfa = eaAlfa % Calc1;
                 Calc1  = 0 - (100 + enLong);
                 eaAlfa = (Vacio1 + eaAlfa)  % Calc1;
                 Calc1  = 100 + enLongDec;
                 aAlfa1 = (aAlfa1 + Vacio2) % Calc1;
             |FINSI;

             eaAlfa = eaAlfa + aAlfa1;
         |FINSI;

         |SI nNegativo = 1;
             Calc1 = 0 - (100 + (enLong + enLongDec)); Calc1 = Calc1 + 1;
             eaAlfa = eaAlfa % Calc1;
             eaAlfa = "N" + eaAlfa;
         |FINSI;
     |FINSI;

     aAlfa2 = "";

     |SI eaTDato = "A"; |O eaTDato = "An";
         aLong = eaAlfa % 0; nLong = aLong;
         |PARA nCont1 = 1; |SI nCont1 [ nLong; |HACIENDO nCont1 = nCont1 + 1;
               Calc1  = (nCont1 * 100) + 1; aAlfa1  = eaAlfa % Calc1;
               aAlfa1 = aAlfa1 > aAlfa1;

               |SI aAlfa1 = " ";                  |VETE Sigue1; |FINSI;
               |SI aAlfa1 ] "A"; |Y aAlfa1 [ "Z"; |VETE Sigue1; |FINSI;
               |SI aAlfa1 ] "0"; |Y aAlfa1 [ "9"; |VETE Sigue1; |FINSI;
               |SI aAlfa1 = "¥"; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
               |SI aAlfa1 = "¤"; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
               |SI nSwFiltraBarra = 1;
                   |SI aAlfa1 = "/"; aAlfa1 = ".";    |VETE Sigue1; |FINSI;
               |FINSI;

               aAlfa4 = &128;
               |SI aAlfa1 = aAlfa4; aAlfa1 = "Ç";   |VETE Sigue1; |FINSI;

               aAlfa4 = &135;
               |SI aAlfa1 = aAlfa4; aAlfa1 = "ç";   |VETE Sigue1; |FINSI;

               |SI aAlfa1 = "-"; aAlfa1 = &45;    |VETE Sigue1; |FINSI;
               |SI aAlfa1 = "'"; aAlfa1 = &49;    |VETE Sigue1; |FINSI;

               |SI aAlfa1 = "/";                  |VETE Sigue1; |FINSI;
               |SI eaTDato = "An";
                   |SI aAlfa1 = "&"; aAlfa1 = &38;    |VETE Sigue1; |FINSI;
                   |SI aAlfa1 = ","; aAlfa1 = &44;    |VETE Sigue1; |FINSI;
                   |SI aAlfa1 = "."; aAlfa1 = &46;    |VETE Sigue1; |FINSI;
                   |SI aAlfa1 = ":"; aAlfa1 = &58;    |VETE Sigue1; |FINSI;
                   |SI aAlfa1 = ";"; aAlfa1 = &59;    |VETE Sigue1; |FINSI;
                   |SI aAlfa1 = "_"; aAlfa1 = &95;    |VETE Sigue1; |FINSI;
               |FINSI;

               aAlfa1 = " ";

               |ET Sigue1;
                   aAlfa2 = aAlfa2 + aAlfa1;
         |SIGUE;
         eaAlfa = aAlfa2;
     |FINSI;

     |SI eaTDato = "A";
         aAlfa2 = "";
         aLong  = eaAlfa % 0; nLong = aLong;
         |PARA nCont1 = 1; |SI nCont1 [ nLong; |HACIENDO nCont1 = nCont1 + 1;
               Calc1  = (nCont1 * 100) + 1;
               aAlfa1 = eaAlfa % Calc1;
               |SI aAlfa1 = " ";
                   nEspa = nEspa + 1;
                   |SI nEspa > 1;
                       aAlfa1 = "";
                   |FINSI;
               |SINO;
                   nEspa = 0;
               |FINSI;

               aAlfa2 = aAlfa2 + aAlfa1;
         |SIGUE;

         eaAlfa = aAlfa2;

         Calc1 = 100 + enLong; eaAlfa = (eaAlfa + Vacio1) % Calc1;
     |FINSI;

     Calc1 = eaAlfa;
     |SI enSwDatos = 0; |Y Calc1 ! 0;
         enSwDatos = 1;
     |FINSI;
|FPRC;

|PROCESO GrabaCadena;
     |XGRABA enHandle, eaCadena;
     eaCadena = "";
|FPRC;

|PROCESO MeteImpCadena;
     |HAZ SacaImporte;

     eaAlfa = enImp; |HAZ FormatoCmp; eaCadena = eaAlfa;
     |HAZ GrabaCadena;
|FPRC;
