|FICHEROS;
     rem01011;
     rem00906;
     rew00711;
|FIN;

|VARIABLES;
      nCampo           = 0;
      nRango           = 0;
      nNumCampos       = 0;
      nGrid1011        = 0;
      nGrid711         = 0;
      nCmp             = 0;

      aAlfa            = "";
      aQueQuiero       = "";
      aNumCampos       = "";
      aEsc1            = "";
      aEsc2            = "";
      aRetu            = "";
      aTecla           = "";
      aNome            = "";

     &enEmpresa        = 0;
     &enComplementaria = 0;
     &eaContri         = "";
     &eaAlfa           = "";
     &eaImporte        = "";
|FIN;

|PROCESO Baja711;
     #rew00711#0 = #rem01011#3;
     #rew00711#1 = 0;
|FPRC;

|PROCESO Alta711;
     #rew00711#0 = #rem01011#3;
     #rew00711#1 = 999;
|FPRC;


|PROCESO Evento1011;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#rem01011.=;

         #rew00711#0 = #rem01011#3;
         #rew00711#1 = 0;
         |LEE 000#rew00711.];

         |REFRESCACONTROL nGrid711;
     |FINSI;
|FPRC;

|PROCESO Baja1011;
     #rem01011#0 = enEmpresa;
     #rem01011#1 = enComplementaria;
     #rem01011#2 = eaContri;
     #rem01011#3 = 1;
|FPRC;

|PROCESO Alta1011;
     #rem01011#0 = enEmpresa;
     #rem01011#1 = enComplementaria;
     #rem01011#2 = eaContri;
     #rem01011#3 = 999;
|FPRC;

|PROGRAMA;
     aQueQuiero  = "|NC";
     aNumCampos  = #rem01011#aQueQuiero#;
     nNumCampos  = aNumCampos;
     nNumCampos  = nNumCampos - 1;
     nRango      = 4 + 8 + 16 + 32 + 128;

     |ABRET #rem01011;

     |LINEAL_SIMPLE #1#rew00711, nRango, 1402, 3498, Baja711, Alta711, NULL;
     nGrid711 = FSalida;

     |LINEAL_SIMPLE #1#rem01011, nRango, 0602, 1298, Baja1011, Alta1011, Evento1011;
     nGrid1011 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::{{001}}Salir," + nGrid1011;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;
          |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |CIERRAT #rem01011;
|FPRO;

|PROCESO rem00906;
     |DDEFECTO #rew00711;

     #rew00711#0 = #rem01011#3;
     #rew00711#1 = #rem00906#0;
     #rew00711#2 = #rem00906#1;
     #rew00711#3 = #rem00906#2;

     |SI #rem00906#2 ! "    ";
         nCmp = nCmp + 1;

         eaAlfa = #rem01011#nCmp#;

         |SI #rem00906#3 = "F";
             |SI #rem01011#nCmp# = "01.01.0000";
                 eaAlfa = "";
             |FINSI;
         |FINSI;

         |SI #rem00906#3 = "N";
             |SI #rem01011#nCmp# = 0;
                 eaAlfa = "";
             |SINO;
                 eaImporte = #rem01011#nCmp#;
                 |HAZ SeparaImporte;
                 eaAlfa = eaImporte;
             |FINSI;
         |FINSI;

         #rew00711#4 = eaAlfa;
     |FINSI;

     #rew00711#5 = #rem00906#4;
     |GRABA 020#rew00711.n;
     |LIBERA #rew00711;
|FPRC;

|DEFBUCLE rem00906;
     #rem00906#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, rem00906;
|FIN;

|PROCESO rem01011;
     nCmp = 3;
     |BUCLE rem00906;
|FPRC;

|DEFBUCLE rem01011;
     #rem01011#1;
     ;
     enEmpresa, enComplementaria,  eaContri, 001;
     enEmpresa, enComplementaria,  eaContri, 999;
     ;
     NULL, rem01011;
|FIN;

|PROCESO T80;  |TIPO 80;
     aNome = "rew00711" + Usuario;
     |NOME_DAT #rew00711#aNome#;

     |ABRE #rew00711;  |CIERRA #rew00711;  |DELINDEX #rew00711;

     |ABRET #rew00711;

     |BUCLE rem01011;

     FSalida = 3699;
|FPRC;

|PROCESO T90;  |TIPO 90;
     |CIERRAT #rew00711;
     |DELINDEX #rew00711;
|FPRC;
