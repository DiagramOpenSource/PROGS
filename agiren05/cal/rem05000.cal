|FICHEROS;
     rem05000 #500;
     rem00500 #506;

     rem05000@ #900;
|FIN;

|VARIABLES;
     nTecla     = 0;
     nCoefi     = 0;

     aBase      = "";
     aMas       = "";

     &eaTipo    = "";
     &enTipo    = 0;
     &enCultivo = 0;
|FIN;

|PROCESO Consulta;  |TIPO 11;
     nTecla = FSalida;
     eaTipo = "";

     |SI nTecla = 10;  |O nTecla = 11;
         |PUSHV 0501 2380;
         |BLANCO 1434 2155;
         |CUADRO 1434 2155;

         |ATRI S;
         |PINTA 1535, "   Tipo Producto    ";
         |ATRI s;

         |ATRI I;
         |PINTA 1635, "<A> Agrario         ";
         |PINTA 1735, "<G> Ganaderos       ";
         |PINTA 1835, "<F> Forestales      ";
         |ATRI i;

         E_inf  = "AGFagf";
         E_sup  = "1";
         eaTipo = 2045 ? 1;
         eaTipo = eaTipo > " ";

         |POPV;
     |FINSI;

     |SI nTecla = 10;
         enTipo    = 1;
         enCultivo = #500#0;
         |SUB_EJECUTA_NP "rem00500";

         #500#0 = enCultivo;
         |PINTA #500#0;

         |ERROR;
         |ACABA;
     |FINSI;

     |SI nTecla = 11;
         enTipo    = 2;
         enCultivo = #500#0;
         |SUB_EJECUTA_NP "rem00500";

         #500#0 = enCultivo;
         |PINTA #500#0;

         |ERROR;
         |ACABA;
     |FINSI;

     |SI nTecla = 12;
         eaTipo    = "";
         enTipo    = 3;
         enCultivo = #500#0;
         |SUB_EJECUTA_NP "rem00500";

         #500#0 = enCultivo;
         |PINTA #500#0;

         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO ExisteProd;  |TIPO 7;
     |ABRE #506;
     #506#0 = #500#0;
     |LEE 040#506=;
     |SI FSalida ! 0;
         |CIERRA #506;
         |MENAV "0000 No existe el Producto";
         |ERROR;
         |ACABA;
     |FINSI;
     |CIERRA #506;

     |SI #500#3 = 0;
         #500#1 = #506#5;
     |FINSI;
     #500#2 = #506#1;

     |PINTA #500#1;
|FPRC;

|PROCESO Cambia;  |TIPO 11;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     |PUSHV 0501 2380;

     |BLANCO 0624 1264;
     |CUADRO 0624 1264;
     |PINTA 0930, "Nuevo Coeficiente: ";

     E_inf  = 0;
     E_sup  = 9.99;

     nCoefi = 0;
     nCoefi = 0950 ? 1;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/rem05000.mas";
     |CARGA_DEF aMas, rem05000@;
     |SI FSalida ! 0;  |POPV;  |ACABA;  |FINSI;

     |ABRE #900;
     #900#0 = #500#0;
     #900#1 = nCoefi;
     |LEE 000#900=;
     |SI FSalida = 0;
         |MENAV "0000 El Nuevo coeficiente ya existe.";
         |POPV;
         |CIERRA #900;
         |DESCARGA_DEF #rem05000@;
         |ACABA;
     |FINSI;

     #900#0 = #500#0;
     #900#1 = #500#1;
     |LEE 101#900=;
     |SI FSalida = 0;
         |BORRA 020#900a;

         #900#1 = nCoefi;
         |GRABA 020#900n;
         |LIBERA #900;
     |FINSI;
     |CIERRA #900;
     |DESCARGA_DEF #rem05000@;
     |POPV;

     |PONCONTROL 23, "SI";

     |PTEC 809;
|FPRC;

|RUTINA ClaveBaja500;
     #500#0 = 001;
     #500#1 = 0.00;
|FRUT;

|RUTINA ClaveAlta500;
     #500#0 = 999;
     #500#1 = 9.99;
|FRUT;

|PROGRAMA;
     |CLS;
     |CABEZA "Indices BOE";

     |ENTLINEAL #1#500, -1, 2, 22, 1, ClaveBaja500, ClaveAlta500;
|FPRO;
