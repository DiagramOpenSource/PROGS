|FICHEROS;
   reemi100 #0;
   rem01001 #1;
   rem01002 #2;

   rem00100 #91;
   rem00101 #92;
   rem01002 #93;
   repoblac #94;
   rehacien #95;
   rerenpre #96;
   reauxpai #97;
   rem00102 #98;

   rew00001 #99,MANTE;

   rem01010 #100;
   rem01011 #101;
   rem01012 #102;
   rem01014 #103;
   rem01018 #107;
   rem01019 #108;
   rem01021 #110;
   rem01022 #111;
   rem01023 #112;
   rem01024 #113;
   rem01025 #114;
   rem01026 #115;
   rem01027 #116;
   rem01028 #117;
   rem01029 #118;
   rem01030 #119;
   rem01031 #120;
   rem01032 #121;
   rem01033 #122;
   rem01034 #123;
   rem01037 #124;
   rem01041 #125;
   rem01042 #126;
   rem01043 #127;
   rem01035 #128;

   rew00055 #500;
|FIN;

|VARIABLES;

     &enEmpresa     = 0;
     &enTipoEntrada = 0;

     &eaTipoEmi = "";
     &enMinEmp  = 0;
     &enMaxEmp  = 0;

     {1}aContiene = "";
     aDocRemoto    = "";
     aDocServidor  = "";
     aBorrAnt      = "";

     aEstCiv = "";
     fFecRef = @;
     nAnyo1  = 0;
     nAnyo2  = 0;
     nOrdenFall1 = 0;
     aFechaFall1 = "";
     nOrdenFall2 = 0;
     aFechaFall2 = "";
     FEstado = 0;

     nNumPag = 0;
     nCopia  = 0;
     nHijosTit = 0;
     nHijosCon = 0;

     SwCopia = 0;
     nNume   = 0;
     nCampo  = 0;
     nSusp   = 0;
     SwCambio = 0;
     nTotal  = 0;
     nTotal1 = 0;
     nLong   = 0;
     nCanal  = 0;
     nCont   = 0;
     nCont1  = 0;
     nCont2  = 0;
     nCont3  = 0;
     nCont10 = 0;
     nCalc   = 0;
     nCalc1  = 0;
     nCalc2  = 0;
     nCalc3  = 0;
     nConCta = 0;
     Calc    = 0;
     Calc1   = 0;
     Calc2   = 0;
     Long    = 0;
     LongDec = 0;
     nConver = 0;
     SwDatos = 0;
     &nSwDatos = 0;
     XCampos = 0;

     nNumLin1 = 0;
     nNumLin2 = 0;
     nNumActiv = 0;
     nNumPags = 0;
     nPag     = 0;

     Casilla  = "";
     Casilla1 = "";
     Bloque  = 0;

     aHojas = "";
     aCDoc = "";
     aPDec = "";
     Modifica = "";
     &DiaInf  = "";
     MesNum   = "";
     &MesInf  = "";
     &EjerInf = "";
     DReimp   = "";
     HReimp   = "";

     aFamil   = "";
     aNombre  = "";
     aNombre1 = "";
     aNombre2 = "";
     aTipo    = "";
     &aIP     = "";

     nDat    = 0;
     {3}aTit = "";
     {3}aPc1 = "";
     {3}aPc2 = "";
     {3}aRfC = "";
     {3}aSit = "";

     DEmpre   = 0;
     HEmpre   = 0;
     SwEstar  = 0;
     SwError  = 0;
     SwSalir  = 0;

     aOrigen  = "";
     aDestino = "";
     aFichero = "";
     aLong    = "";
     TipoDato = "";
     aAlfa    = "";
     aAlfa1   = "";
     aAlfa2   = "";
     Cadena   = "";
     Cadena1  = "";
     Cadena2  = "";
     Cadena3  = "";
     Comodin  = "";
     Comodin1 = "";
     Comodin2 = "";
     Vacio1   = "";
     Vacio2   = "";

     nLinG = 0;
     nLinP = 0;

     &Handle   = 0;
     &VEmpresa = 0;
     &VTipo    = "";
     nNoHay   = 0;
     nNoHay1  = 0;
     nNoHay2  = 0;
     nNoHay3  = 0;
     nNoHay4  = 0;
     Nombre   = "";
     aNif     = "";
     aNif1      = ""; aNif2      = "";
     aApell11   = ""; aApell12   = "";
     aApell21   = ""; aApell22   = "";
     aC1        = ""; aC2        = "";
     aSg1       = ""; aSg2       = "";
     aCalle1    = ""; aCalle2    = "";
     aNumero1   = ""; aNumero2   = "";
     aEscalera1 = ""; aEscalera2 = "";
     aPiso1     = ""; aPiso2     = "";
     aPuerta1   = ""; aPuerta2   = "";
     aLocali1   = ""; aLocali2   = "";
     aCP1       = ""; aCP2       = "";
     aProvin1   = ""; aProvin2   = "";
     aEC1       = ""; aEC2       = "";
     aAnyoN1    = ""; aAnyoN2    = "";
     aSexo1     = ""; aSexo2     = "";
     aMovil1    = ""; aMovil2    = "";
     aNivRe     = ""; aSMS       = "";
     aFAdoH     = ""; aFNacH     = "";
     aFNac1     = ""; aFNac2     = "";
     aCodPais1  = ""; aCodPais2  = "";
     aMinusval1 = ""; aMinusval2 = "";
     aTelef1    = ""; aTelef2    = "";
     aIglesia1  = ""; aIglesia2  = "";
     aEntidad1  = ""; aEntidad2  = "";
     aSucursal1 = ""; aSucursal2 = "";
     aDC1       = ""; aDC2       = "";
     aCuenta1   = ""; aCuenta2   = "";
     aDom2P     = ""; aFra2P     = "";
     aRen2P     = ""; &aSeparada = "";

     aNifH  = ""; aNombH = "";
     aAnyoH = ""; aMinuH = "";
     aVincH = ""; aOtroH = "";

     aNom   = "";
     aApel1 = "";
     aApel2 = "";
     aTipoContr = "";
     nInd   = 0;
     nNegativo = 0;

     nSalir  = 0;
     nPasada = 0;
     nPos    = 0;

     &eaTipoSec = "";

{12}nDescend = 0;
{4}nAscend   = 0;

{200}&NEmpresas = "";
|FIN;

|PROCESO CargaDatos;
   aAlfa = VTipo; |QBF aAlfa;

   aSMS       = "";
   aNif1      = ""; aNif2      = "";
   aApell11   = ""; aApell12   = "";
   aApell21   = ""; aApell22   = "";
   aC1        = ""; aC2        = "";
   aSg1       = ""; aSg2       = "";
   aCalle1    = ""; aCalle2    = "";
   aNumero1   = ""; aNumero2   = "";
   aEscalera1 = ""; aEscalera2 = "";
   aPiso1     = ""; aPiso2     = "";
   aPuerta1   = ""; aPuerta2   = "";
   aLocali1   = ""; aLocali2   = "";
   aCP1       = ""; aCP2       = "";
   aProvin1   = ""; aProvin2   = "";
   aEC1       = ""; aEC2       = "";
   aAnyoN1    = ""; aAnyoN2    = "";
   aFNac1     = ""; aFNac2     = "";
   aSexo1     = "";
   aCodPais1  = "";  aCodPais2  = "";
   aMinusval1 = "0"; aMinusval2 = "";
   aTelef1    = "";  aTelef2    = "";
   aIglesia1  = "";  aIglesia2  = "";
   aMovil1    = "";  aMovil2    = "";

   aAlfa1 = aAlfa - " FAMILIAR";
   |SI FSalida ! 0;
      aFamil = "S";
      |QBF aAlfa1; nCalc = aAlfa1;
      #rem00101#0 = #rem00100#0;
      #rem00101#1 = 1;
      |LEE 000#rem00101.];
      |PARA; |SI FSalida = 0; |Y #rem00101#0 = #rem00100#0; |HACIENDO;
         |SI #rem00101#13 = "S";
            nCalc = nCalc - 1;
            |SI nCalc = 0;
               |SI #rem00101#6 < 33;                        aMinusval1 = 0; |FINSI;
               |SI #rem00101#6 ] 33; |Y #rem00101#6 < 65;   aMinusval1 = 1; |FINSI;
               |SI #rem00101#6 ] 65; |Y #rem00101#14 = "N"; aMinusval1 = 2; |FINSI;
               |SI #rem00101#6 ] 65; |Y #rem00101#14 = "S"; aMinusval1 = 3; |FINSI;
               #repoblac#0 = #rem00100#20; #repoblac#1 = #rem00100#21;
               |LEE 000#repoblac.=;
               aNif1 = #rem00101#2;
               aAlfa = #rem00101#3; |HAZ SeparaNombre;
               aApell11 = aApel1;   aApell12 = aApel2;   aNombre1  = aNom;
               aC1        = #rem00101#16;   aSg1     = #rem00100#14;
               aCalle1    = #rem00100#15;   aNumero1 = #rem00100#16;
               aEscalera1 = #rem00100#17;   aPiso1   = #rem00100#18;
               aPuerta1   = #rem00100#19;   aLocali1 = #rem00100#22;
               aCP1       = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103)
               aProvin1 = #repoblac#2;
               aEC1       = "S";            aAnyoN1  = #rem00101#5;
               aFNac1     = #rem00101#17;   aSexo1   = #rem00101#20;
               aCodPais1  = #rem00100#107;  aTelef1  = #rem00100#12;
               aIglesia1  = #rem00100#59;   aCuenta1 = #rem00101#10;
               aMovil1    = #rem00100#109;  aSMS     = #rem00100#111;
            |SINO;
               |LEE 000#rem00101.s;
            |FINSI;
         |SINO;
            |LEE 000#rem00101.s;
         |FINSI;
      |SIGUE;
      aNif2      = "";   aNombre2 = "";
      aApell21   = "";   aApell22 = "";
      aC2        = "";   aSg2     = "";
      aCalle2    = "";   aNumero2 = "";
      aEscalera2 = "";   aPiso2   = "";
      aPuerta2   = "";   aLocali2 = "";
      aCP2       = "";   aSexo2   = "";
      aProvin2   = "";   aAnyoN2   = "";
      aFNac2     = "";   aCodPais2 = "";
      aMinusval2 = "0";  aTelef2   = "";
      aMovil2    = "";
      aAlfa = aCuenta1; |QBF aAlfa; |SI aAlfa = ""; aCuenta1 = "0" * 20; |FINSI;
      aAlfa = aCodPais1; |HAZ BuscaPais; aCodPais1 = aAlfa;

      |SI aSexo1 = "V"; aSexo1 = "H"; |FINSI;
      |SI aSexo1 = "";  aSexo1 = " "; |FINSI;
      |SI aSexo2 = "V"; aSexo2 = "H"; |FINSI;
      |SI aSexo2 = "";  aSexo2 = " "; |FINSI;
      |ACABA;
   |SINO;
      aFamil = "N";
   |FINSI;

   |SI aAlfa = "TITULAR"; |O aAlfa = "CONJUNTA";
      |SI #rem00100#8 < 33; aMinusval1 = 0; |FINSI;
      |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "N"; aMinusval1 = 1; |FINSI;
      |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "S"; aMinusval1 = 2; |FINSI;
      |SI #rem00100#8 ] 65; aMinusval1 = 3; |FINSI;
      #repoblac#0 = #rem00100#20; #repoblac#1 = #rem00100#21;
      |LEE 000#repoblac.=;
      aNif1      = #rem00100#1;    aNombre1 = #rem00100#4;
      aApell11   = #rem00100#2;    aApell12 = #rem00100#3;
      aC1        = #rem00100#100;  aSg1     = #rem00100#14;
      aCalle1    = #rem00100#15;   aNumero1 = #rem00100#16;
      aEscalera1 = #rem00100#17;   aPiso1   = #rem00100#18;
      aPuerta1   = #rem00100#19;   aLocali1 = #rem00100#22;
      aCP1       = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103)
      aProvin1 = #repoblac#2;
      aEC1       = #rem00100#6;    aAnyoN1  = #rem00100#7;
      aFNac1     = #rem00100#103;  aSexo1   = #rem00100#105;
      aCodPais1  = #rem00100#107;  aTelef1  = #rem00100#12;
      aIglesia1  = #rem00100#59;   aMovil1  = #rem00100#109;
      aSMS       = #rem00100#111;
      |SI aAlfa = "TITULAR";  aCuenta1  = #rem00100#53; |FINSI;
      |SI aAlfa = "CONJUNTA"; aCuenta1  = #rem00100#55; |FINSI;

      |SI #rem00100#41 < 33; aMinusval2 = 0; |FINSI;
      |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "N"; aMinusval2 = 1; |FINSI;
      |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "S"; aMinusval2 = 2; |FINSI;
      |SI #rem00100#41 ] 65; aMinusval2 = 3; |FINSI;
      #repoblac#0 = #rem00100#50; #repoblac#1 = #rem00100#51;
      |LEE 000#repoblac.=;
      aNif2      = #rem00100#35;   aNombre2 = #rem00100#38;
      aApell21   = #rem00100#36;   aApell22 = #rem00100#37;
      aC2        = #rem00100#101;  aSg2     = #rem00100#44;
      aCalle2    = #rem00100#45;   aNumero2 = #rem00100#46;
      aEscalera2 = #rem00100#47;   aPiso2   = #rem00100#48;
      aPuerta2   = #rem00100#49;   aLocali2 = #rem00100#52;
      aCP2       = (("00" + #rem00100#50) % -102) + (("000" + #rem00100#51) % -103);
      aProvin2   = #repoblac#2;    aAnyoN2   = #rem00100#40;
      aFNac2     = #rem00100#104;  aCodPais2 = #rem00100#108;
      aTelef2   = #rem00100#13;    aSexo2    = #rem00100#106;
      aIglesia2  = #rem00100#60;   aMovil2   = #rem00100#110;
      aSMS       = #rem00100#111;
      |SI aAlfa = "TITULAR";  aCuenta2  = #rem00100#54; |FINSI;
      |SI aAlfa = "CONJUNTA"; aCuenta2  = #rem00100#55; |FINSI;
   |FINSI;

   |SI aAlfa = "CONYUGE";
      |SI #rem00100#41 < 33; aMinusval1 = 0; |FINSI;
      |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "N"; aMinusval1 = 1; |FINSI;
      |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "S"; aMinusval1 = 2; |FINSI;
      |SI #rem00100#41 ] 65; aMinusval1 = 3; |FINSI;
      #repoblac#0 = #rem00100#50; #repoblac#1 = #rem00100#51;
      |LEE 000#repoblac.=;
      aNif1      = #rem00100#35;   aNombre1 = #rem00100#38;
      aApell11   = #rem00100#36;   aApell12 = #rem00100#37;
      aC1        = #rem00100#101;  aSg1     = #rem00100#44;
      aCalle1    = #rem00100#45;   aNumero1 = #rem00100#46;
      aEscalera1 = #rem00100#47;   aPiso1   = #rem00100#48;
      aPuerta1   = #rem00100#49;   aLocali1 = #rem00100#52;
      aCP1       = (("00" + #rem00100#50) % -102) + (("000" + #rem00100#51) % -103);
      aEC1       = #rem00100#6;
      aProvin1   = #repoblac#2;    aAnyoN1  = #rem00100#40;
      aFNac1     = #rem00100#104;  aSexo1   = #rem00100#106;
      aCodPais1  = #rem00100#108;  aTelef1  = #rem00100#13;
      aIglesia1  = #rem00100#60;   aCuenta1   = #rem00100#54;
      aMovil1    = #rem00100#110;  aSMS       = #rem00100#111;
      |SI #rem00100#8 < 33; aMinusval2 = 0; |FINSI;
      |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "N"; aMinusval2 = 1; |FINSI;
      |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "S"; aMinusval2 = 2; |FINSI;
      |SI #rem00100#8 ] 65; aMinusval2 = 3; |FINSI;
      #repoblac#0 = #rem00100#20; #repoblac#1 = #rem00100#21;
      |LEE 000#repoblac.=;
      aNif2      = #rem00100#1;    aNombre2 = #rem00100#4;
      aApell21   = #rem00100#2;    aApell22 = #rem00100#3;
      aC2        = #rem00100#100;  aSg2     = #rem00100#14;
      aCalle2    = #rem00100#15;   aNumero2 = #rem00100#16;
      aEscalera2 = #rem00100#17;   aPiso2   = #rem00100#18;
      aPuerta2   = #rem00100#19;   aLocali2 = #rem00100#22;
      aCP2       = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103);
      aProvin2 = #repoblac#2;      aAnyoN2    = #rem00100#7;
      aFNac2     = #rem00100#103;  aCodPais2 = #rem00100#107;
      aTelef2  = #rem00100#12;     aSexo2    = #rem00100#105;
      aIglesia2  = #rem00100#59;   aCuenta2 = #rem00100#53;
      aMovil2    = #rem00100#109;  aSMS     = #rem00100#111;
   |FINSI;

   |SI aAlfa = "CONJUNTAE";
      |SI #rem00100#91 = "T";
         |SI #rem00100#41 < 33; aMinusval1 = 0; |FINSI;
         |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "N"; aMinusval1 = 1; |FINSI;
         |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "S"; aMinusval1 = 2; |FINSI;
         |SI #rem00100#41 ] 65; aMinusval1 = 3; |FINSI;
         #repoblac#0 = #rem00100#50; #repoblac#1 = #rem00100#51;
         |LEE 000#repoblac.=;
         aNif1      = #rem00100#35;   aNombre1 = #rem00100#38;
         aApell11   = #rem00100#36;   aApell12 = #rem00100#37;
         aC1        = #rem00100#101;  aSg1     = #rem00100#44;
         aCalle1    = #rem00100#45;   aNumero1 = #rem00100#46;
         aEscalera1 = #rem00100#47;   aPiso1   = #rem00100#48;
         aPuerta1   = #rem00100#49;   aLocali1 = #rem00100#52;
         aCP1       = (("00" + #rem00100#50) % -102) + (("000" + #rem00100#51) % -103);
         aEC1       = "V";            aSexo1   = #rem00100#106;
         aProvin1   = #repoblac#2;    aAnyoN1  = #rem00100#40;
         aFNac1     = #rem00100#104;  aCodPais1 = #rem00100#108;
         aTelef1    = #rem00100#13;   aMovil1   = #rem00100#109;
         aIglesia1  = #rem00100#59;   aCuenta1 = #rem00100#54;
         aSMS       = #rem00100#111;
      |SINO;
         |SI #rem00100#8 < 33; aMinusval1 = 0; |FINSI;
         |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "N"; aMinusval1 = 1; |FINSI;
         |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "S"; aMinusval1 = 2; |FINSI;
         |SI #rem00100#8 ] 65; aMinusval1 = 3; |FINSI;
         #repoblac#0 = #rem00100#20; #repoblac#1 = #rem00100#21;
         |LEE 000#repoblac.=;
         aNif1      = #rem00100#1;    aNombre1 = #rem00100#4;
         aApell11   = #rem00100#2;    aApell12 = #rem00100#3;
         aC1        = #rem00100#100;  aSg1     = #rem00100#14;
         aCalle1    = #rem00100#15;   aNumero1 = #rem00100#16;
         aEscalera1 = #rem00100#17;   aPiso1   = #rem00100#18;
         aPuerta1   = #rem00100#19;   aLocali1 = #rem00100#22;
         aCP1       = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103);
         aProvin1 = #repoblac#2;
         aEC1       = "V";            aAnyoN1  = #rem00100#7;
         aFNac1     = #rem00100#103;  aSexo1   = #rem00100#105;
         aCodPais1  = #rem00100#107;  aTelef1  = #rem00100#12;
         aIglesia1  = #rem00100#60;   aCuenta1 = #rem00100#53;
         aMovil1    = #rem00100#109;  aSMS     = #rem00100#111;
      |FINSI;
      aNif2      = "";   aNombre2 = "";
      aApell21   = "";   aApell22 = "";
      aC2        = "";   aSg2     = "";
      aCalle2    = "";   aNumero2 = "";
      aEscalera2 = "";   aPiso2   = "";
      aPuerta2   = "";   aLocali2 = "";
      aCP2       = "";
      aProvin2   = "";   aAnyoN2  = "";
      aMinusval2 = "0";  aTelef2  = "";
      aIglesia2  = "";   aCuenta2 = "";
      aMovil2    = "";   aSexo2   = "";
   |FINSI;

   aAlfa = aCuenta1; |QBF aAlfa; |SI aAlfa = ""; aCuenta1 = "0" * 20; |FINSI;
   aAlfa = aCuenta2; |QBF aAlfa; |SI aAlfa = ""; aCuenta2 = "0" * 20; |FINSI;

   |QBF aTelef1; |QBF aTelef2;

   |SI aC1 = "X"; |O aC1 = "Z";
      |SI aTelef1 = ""; aTelef1 = aTelef2; |FINSI;
   |FINSI;
   |SI aC2 = "X"; |O aC2 = "Z";
      |SI aTelef2 = ""; aTelef2 = aTelef1; |FINSI;
   |FINSI;

   |SI #0#34 = "F";
      |SI aC1 = "X";  |O aC1 = "Z";
         aSg1     = ""; aCalle1  = ""; aNumero1 = ""; aEscalera1 = "";
         aPiso1   = ""; aPuerta1 = ""; aLocali1 = ""; aCP1       = "";
         aProvin1 = "";                aFNac1   = ""; aSexo1     = "";
         aCodPais1  = ""; aMovil1 = "";
      |FINSI;
      |SI aC2 = "X"; |O aC2 = "Z";
         aSg2     = ""; aCalle2  = ""; aNumero2 = ""; aEscalera2 = "";
         aPiso2   = ""; aPuerta2 = ""; aLocali2 = ""; aCP2       = "";
         aProvin2 = ""; aSexo2   = ""; aFNac2   = ""; aCodPais2  = "";
         aMovil2  = "";
      |FINSI;
   |FINSI;

   aAlfa = aCodPais1; |HAZ BuscaPais; aCodPais1 = aAlfa;
   aAlfa = aCodPais2; |HAZ BuscaPais; aCodPais2 = aAlfa;

   TipoDato = "F"; aAlfa = aFNac1; |HAZ Formateo; aFNac1 = aAlfa;
   TipoDato = "F"; aAlfa = aFNac2; |HAZ Formateo; aFNac2 = aAlfa;
   TipoDato = "F"; aAlfa = aFNacH; |HAZ Formateo; aFNacH = aAlfa;
   TipoDato = "F"; aAlfa = aFAdoH; |HAZ Formateo; aFAdoH = aAlfa;
   |SI aFNac1 = "          "; aFNac1 = "00000000"; |FINSI;
   |SI aFNac2 = "          "; aFNac2 = "00000000"; |FINSI;
   |SI aFNacH = "          "; aFNacH = "00000000"; |FINSI;
   |SI aFAdoH = "          "; aFAdoH = "00000000"; |FINSI;

   |SI aSexo1 = "V"; aSexo1 = "H"; |FINSI;
   |SI aSexo1 = "";  aSexo1 = " "; |FINSI;
   |SI aSexo2 = "V"; aSexo2 = "H"; |FINSI;
   |SI aSexo2 = "";  aSexo2 = " "; |FINSI;
|FPRC;

|PROCESO RecogeFam;
   |SI #rem00101#4 = "DESCENDIENTE";
      nDescend = #rem00101#1; InDescend = InDescend + 1;
      |SI #rem00101#16 = "X"; |O #rem00101#16 = "Z";
         aCDoc = "1";
      |FINSI;
      |SI #rem00101#16 = "D"; |O #rem00101#16 = "Z";
         aPDec = "1";
      |FINSI;
   |SINO;
      nAscend = #rem00101#1;  InAscend = InAscend + 1;
   |FINSI;
|FPRC;

|DEFBUCLE RecogeFam;
#rem00101#1;
;
#rem00100#0,01;
#rem00100#0,99;
;
NULL,RecogeFam;
|FIN;

|PROCESO Hoja01;
   Cadena = "";
   |ABRE #rem00100;
   #rem00100#0 = VEmpresa;
   |LEE 000#rem00100.=;
   |SI FSalida = 0;
      |HAZ CargaDatos;
   |FINSI;
   |CIERRA #rem00100;

   LongDec = 0;
   Cadena = "<T10001> ";

   ||TITULAR
   || Nif del primer declarante
   TipoDato = "An"; Long = 9;  aAlfa = aNif1;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Apellido 1 del primer declarante
   TipoDato = "A";  Long = 15; aAlfa = aApell11;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Apellido 1 del primer declarante
   TipoDato = "A";  Long = 15; aAlfa = aApell12;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Nombre del primer declarante
   TipoDato = "A";  Long = 15; aAlfa = aNombre1;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Siglas de la via del primer declarante
   TipoDato = "A";  Long = 2;  aAlfa = aSg1;      |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Nombre de la via del primer declarante
   TipoDato = "A";  Long = 20; aAlfa = aCalle1;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Numero del primer declarante
   TipoDato = "An"; Long = 5;  aAlfa = aNumero1;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Escalera del primer declarante
   TipoDato = "An"; Long = 2;  aAlfa = aEscalera1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Piso del primer declarante
   TipoDato = "An"; Long = 2;  aAlfa = aPiso1;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Puerta del primer declarante
   TipoDato = "An"; Long = 2;  aAlfa = aPuerta1;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Municipio del primer declarante
   TipoDato = "An"; Long = 25; aAlfa = aLocali1;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Codigo provincial del primer declarante
   aAlfa = aCP1; aAlfa = aAlfa % 0102; |QBF aAlfa;
   aAlfa = ("00" + aAlfa) % -102;                   Cadena = Cadena + aAlfa;
   || Codigo postal del primer declarante
   aAlfa = aCP1; |QBF aAlfa; |SI aAlfa = ""; aAlfa = "00000"; |FINSI; Cadena = Cadena + aAlfa;
   || Cambio de domicilio
   |SI aC1 = "X"; |O aC1 = "Z";
      Cadena = Cadena + "1";
   |SINO;
      Cadena = Cadena + "0";
   |FINSI;
   || 1¦ declaracion
   |SI aC1 = "D"; |O aC1 = "Z";
      Cadena = Cadena + "1";
   |SINO;
      Cadena = Cadena + "0";
   |FINSI;
   || Sexo
   Cadena = Cadena + aSexo1;
   || Estado civil del declarante
   aAlfa = " ";
   |SI aEC1 = "S"; aAlfa = "1"; aSexo2 = " "; |FINSI;
   |SI aEC1 = "C"; aAlfa = "2";               |FINSI;
   |SI aEC1 = "V"; aAlfa = "3"; aSexo2 = " "; |FINSI;
   |SI aEC1 = "L"; aAlfa = "4"; aSexo2 = " "; |FINSI;
   aEstCiv = aAlfa;

   aTipo = VTipo % 0110;
   |SI #rem00100#91 = "C"; |Y aAlfa = "2";
      |SI aTipo = "TITULAR   "; |O aTipo = "CONJUNTA  "; |O aTipo = "CONJUNTAE ";
         aAlfa = "3";
         aNif2      = ""; aApell21   = "";
         aApell22   = ""; aC2        = "";
         aSg2       = ""; aCalle2    = "";
         aNumero2   = ""; aEscalera2 = "";
         aPiso2     = ""; aPuerta2   = "";
         aLocali2   = ""; aCP2       = "";
         aProvin2   = ""; aEC2       = "";
         aAnyoN2    = ""; aFNac2     = "";
         aCodPais2  = ""; aMinusval2 = "";
         aTelef2    = ""; aIglesia2  = "";
         aNombre2   = ""; aSexo2     = " ";
         aMovil2    = "";
      |FINSI;
   |FINSI;
   |SI #rem00100#91 = "T"; |Y aAlfa = "2";
      |SI aTipo = "CONYUGE   "; |O aTipo = "CONJUNTAE ";
         aAlfa = "3";
         aNif2      = ""; aApell21   = "";
         aApell22   = ""; aC2        = "";
         aSg2       = ""; aCalle2    = "";
         aNumero2   = ""; aEscalera2 = "";
         aPiso2     = ""; aPuerta2   = "";
         aLocali2   = ""; aCP2       = "";
         aProvin2   = ""; aEC2       = "";
         aAnyoN2    = ""; aFNac2     = "";
         aCodPais2  = ""; aMinusval2 = "";
         aTelef2    = ""; aIglesia2  = "";
         aNombre2   = ""; aSexo2     = " ";
         aMovil2    = "";
      |FINSI;
   |FINSI;

   Cadena = Cadena + aAlfa;
   || Fecha nacimiento
   TipoDato = "F";  Long = 8;  aAlfa = aFNac1;    |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Grado de minusvalia del declarante
   TipoDato = "N";  Long = 1;  aAlfa = aMinusval1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Codigo pais de residencia
   TipoDato = "A";  Long = 2;  aAlfa = aCodPais1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Telefono de contacto del declarante
   ||TipoDato = "N";  Long = 9;  aAlfa = aTelef1;    |HAZ Formateo; Cadena = Cadena + aAlfa;

   |HAZ GrabaCad;

   aTit1 = ""; aPc11 = ""; aPc21 = ""; aRfC1 = ""; aSit1 = "";
   aTit2 = ""; aPc12 = ""; aPc22 = ""; aRfC2 = ""; aSit2 = "";
   aTit3 = ""; aPc13 = ""; aPc23 = ""; aRfC3 = ""; aSit3 = "";

   aTipo = VTipo % 0110; |QBF aTipo; nDat  = 0;
   |ABRE #rem00102;
   #rem00102#0 = VEmpresa;
   #rem00102#1 = 1;
   |LEE 000#rem00102.];
   |PARA; |SI FSalida = 0; |Y #rem00102#0 = VEmpresa; |HACIENDO;
      |SI nDat ] 3; |SAL; |FINSI;

      IaTit = aTit1<-; IaPc1 = aPc11<-; IaPc2 = aPc21<-;
      IaRfC = aRfC1<-; IaSit = aSit1<-;
      IaTit = IaTit + nDat; IaPc1 = IaPc1 + nDat;
      IaPc2 = IaPc2 + nDat; IaRfC = IaRfC + nDat;
      IaSit = IaSit + nDat;

      aAlfa = aTipo; |QBF aAlfa; aAlfa = aAlfa - "FAMILIAR";
      |SI FSalida ! 0;
         aAlfa = #rem00102#2; |QBF aAlfa; aAlfa = aAlfa - "FAMILIAR";
         |SI FSalida ! 0;
            aTit = #rem00102#9; aPc1 = 0; aPc2 = 0; aRfC = #rem00102#11;
            aSit = #rem00102#14;
            nDat = nDat + 1;
         |FINSI;
      |SINO;
         |SI aTipo = "TITULAR"; |O aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
            |SI #rem00100#91 = " ";
               aTit = #rem00102#9;
               |SI #rem00102#2 = "TITULAR   "; aPc1 = 100; aPc2 = 0;   |FINSI;
               |SI #rem00102#2 = "CONYUGE   "; aPc1 = 0;   aPc2 = 100; |FINSI;
               |SI #rem00102#2 = "GANANCIAL "; aPc1 = 50;  aPc2 = 50;  |FINSI;
               |SI #rem00102#2 = "VARIOS    "; aPc1 = #rem00102#3; aPc2 = #rem00102#4;  |FINSI;
               aRfC = #rem00102#11;
               aSit = #rem00102#14;
               aAlfa = #rem00102#2; |QBF aAlfa; aAlfa = aAlfa - "FAMILIAR";
               |SI FSalida ! 0;
                  aRfC = ""; aTit = ""; aPc1 = ""; aPc2 = ""; aSit = "";
               |SINO;
                  nDat = nDat + 1;
               |FINSI;
            |SINO;
               |SI aTipo = "CONJUNTAE";
                  |SI #rem00102#13 = "F";
                     aTit = #rem00102#9;
                     |SI #rem00102#2 = "TITULAR   "; aPc1 = 100; aPc2 = 0;   |FINSI;
                     |SI #rem00102#2 = "CONYUGE   "; aPc1 = 0;   aPc2 = 100; |FINSI;
                     |SI #rem00102#2 = "GANANCIAL "; aPc1 = 50;  aPc2 = 50;  |FINSI;
                     |SI #rem00102#2 = "VARIOS    "; aPc1 = #rem00102#3; aPc2 = #rem00102#4;  |FINSI;
                     aRfC = #rem00102#11;
                     aSit = #rem00102#14;
                     aAlfa = #rem00102#2; |QBF aAlfa; aAlfa = aAlfa - "FAMILIAR";
                     |SI FSalida ! 0;
                        aRfC = ""; aTit = ""; aPc1 = ""; aPc2 = "";
                     |SINO;
                        nDat = nDat + 1;
                     |FINSI;
                  |FINSI;
               |SINO;
                  |SI #rem00102#13 = " ";
                     aTit = #rem00102#9;
                     |SI #rem00102#2 = "TITULAR   "; aPc1 = 100; aPc2 = 0;   |FINSI;
                     |SI #rem00102#2 = "CONYUGE   "; aPc1 = 0;   aPc2 = 100; |FINSI;
                     |SI #rem00102#2 = "GANANCIAL "; aPc1 = 50;  aPc2 = 50;  |FINSI;
                     |SI #rem00102#2 = "VARIOS    "; aPc1 = #rem00102#3; aPc2 = #rem00102#4;  |FINSI;
                     aRfC = #rem00102#11;
                     aSit = #rem00102#14;
                     aAlfa = #rem00102#2; |QBF aAlfa; aAlfa = aAlfa - "FAMILIAR";
                     |SI FSalida ! 0;
                        aRfC = ""; aTit = ""; aPc1 = ""; aPc2 = ""; aSit = "";
                     |SINO;
                        nDat = nDat + 1;
                     |FINSI;
                  |FINSI;
               |FINSI;
            |FINSI;
         |FINSI;
         |SI aTipo = "CONYUGE";
            |SI #rem00100#91 = " ";
               aTit = #rem00102#9;
               |SI #rem00102#2 = "TITULAR   "; aPc1 = 0;   aPc2 = 100; |FINSI;
               |SI #rem00102#2 = "CONYUGE   "; aPc1 = 100; aPc2 = 0;   |FINSI;
               |SI #rem00102#2 = "GANANCIAL "; aPc1 = 50;  aPc2 = 50;  |FINSI;
               |SI #rem00102#2 = "VARIOS    "; aPc1 = #rem00102#4; aPc2 = #rem00102#3;  |FINSI;
               aRfC = #rem00102#11;
               aSit = #rem00102#14;
               aAlfa = #rem00102#2; |QBF aAlfa; aAlfa = aAlfa - "FAMILIAR";
               |SI FSalida ! 0;
                  aRfC = ""; aTit = ""; aPc1 = ""; aPc2 = "";
               |SINO;
                  nDat = nDat + 1;
               |FINSI;
            |SINO;
               |SI #rem00102#13 = " ";
                  aTit = #rem00102#9;
                  |SI #rem00102#2 = "TITULAR   "; aPc1 = 0;   aPc2 = 100; |FINSI;
                  |SI #rem00102#2 = "CONYUGE   "; aPc1 = 100; aPc2 = 0;   |FINSI;
                  |SI #rem00102#2 = "GANANCIAL "; aPc1 = 50;  aPc2 = 50;  |FINSI;
                  |SI #rem00102#2 = "VARIOS    "; aPc1 = #rem00102#4; aPc2 = #rem00102#3;  |FINSI;
                  aRfC = #rem00102#11;
                  aSit = #rem00102#14;
                  aAlfa = #rem00102#2; |QBF aAlfa; aAlfa = aAlfa - "FAMILIAR";
                  |SI FSalida ! 0;
                     aRfC = ""; aTit = ""; aPc1 = ""; aPc2 = "";
                  |SINO;
                     nDat = nDat + 1;
                  |FINSI;
               |FINSI;
            |FINSI;
         |FINSI;
         |SI aTit = "3"; |O aTit = "4";
            aPc1 = 0; aPc2 = 0;
         |FINSI;
      |FINSI;
      |LEE 000#rem00102.s;
   |SIGUE;
   |CIERRA #rem00102;

   LongDec = 0;
   IaTit = aTit1<-; IaPc1 = aPc11<-; IaPc2 = aPc21<-;
   IaRfC = aRfC1<-; IaSit = aSit1<-;
   || Titularidad 1
   TipoDato = "N"; Long = 1;  aAlfa = aTit;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Porcentaje participacion 1 (1)
   LongDec = 2;
   TipoDato = "N"; Long = 3;  aAlfa = aPc1;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Porcentaje participacion 2 (1)
   TipoDato = "N"; Long = 3;  aAlfa = aPc2;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Situacion (clave)
   LongDec = 0;
   TipoDato = "N"; Long = 1;  aAlfa = aSit;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Referencia catastral 1
   TipoDato = "An"; Long = 20; aAlfa = aRfC;     |HAZ Formateo; Cadena = Cadena + aAlfa;

   IaTit = IaTit + 1; IaPc1 = IaPc1 + 1; IaPc2 = IaPc2 + 1; IaRfC = IaRfC + 1; IaSit = IaSit + 1;
   || Titularidad 2
   TipoDato = "N"; Long = 1;  aAlfa = aTit;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Porcentaje participacion 1 (2)
   LongDec = 2;
   TipoDato = "N"; Long = 3;  aAlfa = aPc1;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Porcentaje participacion 2 (2)
   TipoDato = "N"; Long = 3;  aAlfa = aPc2;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Situacion (clave)
   LongDec = 0;
   TipoDato = "N"; Long = 1;  aAlfa = aSit;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Referencia catastral 2
   TipoDato = "An"; Long = 20; aAlfa = aRfC;     |HAZ Formateo; Cadena = Cadena + aAlfa;

   IaTit = IaTit + 1; IaPc1 = IaPc1 + 1; IaPc2 = IaPc2 + 1; IaRfC = IaRfC + 1;  IaSit = IaSit + 1;
   || Titularidad 3
   TipoDato = "N"; Long = 1;  aAlfa = aTit;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Porcentaje participacion 1 (3)
   LongDec = 2;
   TipoDato = "N"; Long = 3;  aAlfa = aPc1;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Porcentaje participacion 2 (3)
   TipoDato = "N"; Long = 3;  aAlfa = aPc2;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Situacion (clave)
   LongDec = 0;
   TipoDato = "N"; Long = 1;  aAlfa = aSit;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Referencia catastral 3
   TipoDato = "An"; Long = 20; aAlfa = aRfC;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   LongDec = 0;
   |HAZ GrabaCad;

   ||CONYUGE
   || Nif del conyuge
   TipoDato = "An"; Long = 9;  aAlfa = aNif2;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Apellido 1 del conyuge
   TipoDato = "A";  Long = 15; aAlfa = aApell21;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Apellido 2 del conyuge
   TipoDato = "A";  Long = 15; aAlfa = aApell22;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Nombre del conyuge
   TipoDato = "A";  Long = 15; aAlfa = aNombre2;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Siglas de la via del conyuge
   TipoDato = "A";  Long = 2;  aAlfa = aSg2;      |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Nombre de la via del conyuge
   TipoDato = "A";  Long = 20; aAlfa = aCalle2;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Numero del conyuge
   TipoDato = "An"; Long = 5;  aAlfa = aNumero2;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Escalera del conyuge
   TipoDato = "An"; Long = 2;  aAlfa = aEscalera2; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Piso del conyuge
   TipoDato = "An"; Long = 2;  aAlfa = aPiso2;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Puerta del conyuge
   TipoDato = "An"; Long = 2;  aAlfa = aPuerta2;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Municipio del conyuge
   TipoDato = "An"; Long = 25; aAlfa = aLocali2;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Codigo provincial del conyuge
   aAlfa = aCP2; aAlfa = aAlfa % 0102; |QBF aAlfa;
   aAlfa = ("00" + aAlfa) % -102;                  Cadena = Cadena + aAlfa;
   || Codigo postal del conyuge
   aAlfa = aCP2; |QBF aAlfa; |SI aAlfa = ""; aAlfa = "00000"; |FINSI; Cadena = Cadena + aAlfa;
   || Cambio de domicilio
   |SI aC2 = "X"; |O aC2 = "Z";
      Cadena = Cadena + "1";
   |SINO;
      Cadena = Cadena + "0";
   |FINSI;
   || 1¦ declaracion
   |SI aC2 = "D"; |O aC2 = "Z";
      Cadena = Cadena + "1";
   |SINO;
      Cadena = Cadena + "0";
   |FINSI;
   || Sexo conyuge

   Cadena = Cadena + aSexo2;
   || Fecha nacimiento conyuge
   TipoDato = "F";  Long = 8;  aAlfa = aFNac2;    |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Grado de minusvalia del conyuge
   TipoDato = "N";  Long = 1; aAlfa = aMinusval2; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Codigo pais residencia
   TipoDato = "A";  Long = 2; aAlfa = aCodPais2; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Conyuge no residente y no contribuyente
   |SI #rem00100#102 = "X";
      Cadena = Cadena + "1";
   |SINO;
      Cadena = Cadena + "0";
   |FINSI;
   || Telefonos de contacto : Telefono fijo
   TipoDato = "N";  Long = 9;  aAlfa = aTelef1;    |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Telefonos de contacto : Telefono movil titular
   TipoDato = "N";  Long = 9;  aAlfa = aMovil1;    |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Telefonos de contacto : Telefono movil conyuge
   TipoDato = "N";  Long = 9;  aAlfa = aMovil2;    |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Suscripcion servicio mensajes SMS
   |SI aSMS = "S";
      Cadena = Cadena + "1";
   |SINO;
      Cadena = Cadena + "0";
   |FINSI;

   || Fecha Fallecimiento (en su caso)
   aTipo = VTipo; |QBF aTipo;
   aAlfa = "00000000";
   |SI #rem00100#91 = "T"; |Y aTipo = "TITULAR";
      aAlfa = #rem00100#92;
      |SI aAlfa = "01.01.0000"; aAlfa = "00.00.0000"; |FINSI;
      aAlfa = aAlfa - "."; aAlfa = aAlfa - ".";
   |FINSI;
   |SI #rem00100#91 = "C"; |Y aTipo = "CONYUGE";
      aAlfa = #rem00100#92;
      |SI aAlfa = "01.01.0000"; aAlfa = "00.00.0000"; |FINSI;
      aAlfa = aAlfa - "."; aAlfa = aAlfa - ".";
   |FINSI;
   Cadena = Cadena + aAlfa;
   || Tipo de tributacion
   aTipo = VTipo; |QBF aTipo;
   |SI #rem00100#57 = "X";
      aSeparada = "N";
      |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
         Cadena = Cadena + "2";
      |SINO;
         Cadena = Cadena + "1";
      |FINSI;
   |SINO;
      aSeparada = "S";
      Cadena = Cadena + "1";
   |FINSI;
   |HAZ GrabaCad;

   || Bucle para la declaracion de hijos y otros descendientes

   InAscend = nAscend1<-; InDescend = nDescend1<-;
   |PARA nCont = 1; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
      nDescend = 0; InDescend = InDescend + 1;
      |SI nCont [ 4; nAscend = 0; InAscend = InAscend + 1; |FINSI;
   |SIGUE;
   InAscend = nAscend1<-; InDescend = nDescend1<-;
   aCDoc = "0"; aPDec = "0";
   |BUCLE RecogeFam;
   || Cambio de domicilio descendientes y 1¦ declaracion
   Cadena = Cadena + aCDoc + aPDec;

   nOrdenFall1 = 0; aFechaFall1 = "00.00.0000";
   nOrdenFall2 = 0; aFechaFall2 = "00.00.0000";
   aTipo = VTipo; |QBF aTipo;
   |SI aTipo = "TITULAR"; |O aTipo = "CONYUGE";
      nCont10 = 1; nHijosTit = 0; nHijosCon = 0;
      |PARA nCont = 1; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
         InDescend = nDescend1<-; InDescend = InDescend + (nCont - 1);
         #rem00101#0 = #rem00100#0;
         #rem00101#1 = nDescend;
         |LEE 000#rem00101.=;
         |SI FSalida = 0;
            |SI #rem00101#7 = " ";
               nHijosTit = nHijosTit + 1;
               nHijosCon = nHijosCon + 1;
            |FINSI;
            |SI #rem00101#7 = "1"; |O #rem00101#7 = "3";
               nHijosTit = nHijosTit + 1;
            |FINSI;
            |SI #rem00101#7 = "2"; |O #rem00101#7 = "4";
               nHijosCon = nHijosCon + 1;
            |FINSI;
            |SI #rem00101#21 ! "01.01.0000";
               |SI aTipo = "TITULAR";
                  |SI #rem00101#7 = "1"; |O #rem00101#7 = "3"; |O #rem00101#7 = " ";
                     |SI nOrdenFall1 = 0;
                        aFechaFall1 = #rem00101#21;
                        nOrdenFall1 = nHijosTit
                     |SINO;
                        |SI nOrdenFall2 = 0;
                           aFechaFall2 = #rem00101#21;
                           nOrdenFall2 = nHijosTit
                        |FINSI;
                     |FINSI;
                  |FINSI;
               |FINSI;
               |SI aTipo = "CONYUGE";
                  |SI #rem00101#7 = "2"; |O #rem00101#7 = "4"; |O #rem00101#7 = " ";
                     |SI nOrdenFall1 = 0;
                        aFechaFall1 = #rem00101#21;
                        nOrdenFall1 = nHijosCon;
                     |SINO;
                        |SI nOrdenFall2 = 0;
                           aFechaFall2 = #rem00101#21;
                           nOrdenFall2 = nHijosCon;
                        |FINSI;
                     |FINSI;
                  |FINSI;
               |FINSI;
            |FINSI;
            |SI #rem00101#11 ] 0;
               |SI aTipo = "TITULAR";
                  |SI #rem00101#7 = "1"; |O #rem00101#7 = "3"; |O #rem00101#7 = " ";
                     |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
                     |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
                     |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
                     |SI #rem00101#6 ] 65; aMinuH = 3; |FINSI;
                     aNifH  = #rem00101#2;  aNombH = #rem00101#3;
                     aAnyoH = #rem00101#5;
                     aVincH = #rem00101#7;  aOtroH = #rem00101#8;
                     aFNacH = #rem00101#17; aFAdoH = #rem00101#18;
                     TipoDato = "F";
                     aAlfa = aFNacH; |HAZ Formateo; |SI aAlfa = "        "; aFNacH = "00000000"; |SINO; aFNacH = aAlfa; |FINSI;
                     aAlfa = aFAdoH; |HAZ Formateo; |SI aAlfa = "        "; aFAdoH = "00000000"; |SINO; aFAdoH = aAlfa; |FINSI;

                     |SI aEstCiv = "3"; |Y aEC1 = "C"; aVincH = ""; |FINSI;
                     |SI #rem00100#91 ! " ";
                        |SI aVincH = " "; aVincH = "3"; |FINSI;
                     |FINSI;
                     |SI aVincH = "4"; aVincH = "3"; |FINSI;

                     TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "N";  Long = 8;  aAlfa = aFAdoH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     |HAZ GrabaCad;
                     nCont10 = nCont10 + 1;
                  |FINSI;
               |FINSI;
               |SI aTipo = "CONYUGE";
                  |SI #rem00101#7 = "2"; |O #rem00101#7 = "4"; |O #rem00101#7 = " ";
                     |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
                     |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
                     |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
                     |SI #rem00101#6 ] 65; aMinuH = 3; |FINSI;
                     aNifH  = #rem00101#2;  aNombH = #rem00101#3;
                     aAnyoH = #rem00101#5;
                     aVincH = #rem00101#7;
                     |SI #rem00101#7 = "2"; aVincH = "1"; |FINSI;
                     aOtroH = #rem00101#8;
                     aFNacH = #rem00101#17; aFAdoH = #rem00101#18;
                     TipoDato = "F";
                     aAlfa = aFNacH; |HAZ Formateo; |SI aAlfa = "        "; aFNacH = "00000000"; |SINO; aFNacH = aAlfa; |FINSI;
                     aAlfa = aFAdoH; |HAZ Formateo; |SI aAlfa = "        "; aFAdoH = "00000000"; |SINO; aFAdoH = aAlfa; |FINSI;

                     |SI aEstCiv = "3"; |Y aEC1 = "C"; aVincH = ""; |FINSI;
                     |SI #rem00100#91 ! " ";
                        |SI aVincH = " "; aVincH = "3"; |FINSI;
                     |FINSI;
                     |SI aVincH = "4"; aVincH = "3"; |FINSI;

                     TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "N";  Long = 8;  aAlfa = aFAdoH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                     |HAZ GrabaCad;
                     nCont10 = nCont10 + 1;
                  |FINSI;
               |FINSI;
            |FINSI;
         |FINSI;
      |SIGUE;
      |PARA nCont = nCont10; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
         aNifH  = ""; aNombH = "";
         aAnyoH = ""; aMinuH = "0";
         aVincH = ""; aOtroH = "";
         aFNacH = "00000000"; aFAdoH = "00000000";
         TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 8;  aAlfa = aFAdoH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad;
      |SIGUE;
   |SINO;
      nCont10 = 1;
      |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
         |PARA nCont = 1; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
            InDescend = nDescend1<-; InDescend = InDescend + (nCont - 1);
            #rem00101#0 = #rem00100#0;
            #rem00101#1 = nDescend;
            |LEE 000#rem00101.=;
            |SI FSalida = 0; |Y #rem00101#11 ] 0;
               |SI #rem00101#21 ! "01.01.0000";
                  |SI nOrdenFall1 = 0;
                     aFechaFall1 = #rem00101#21;
                     nOrdenFall1 = nCont;
                  |SINO;
                     |SI nOrdenFall2 = 0;
                        aFechaFall2 = #rem00101#21;
                        nOrdenFall2 = nCont;
                     |FINSI;
                  |FINSI;
               |FINSI;
               |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
               |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
               |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
               |SI #rem00101#6 ] 65; aMinuH = 3; |FINSI;
               aNifH  = #rem00101#2;  aNombH = #rem00101#3;
               aAnyoH = #rem00101#5;
               aVincH = #rem00101#7;  aOtroH = #rem00101#8;
               |SI #rem00100#91 ! " ";
                  |SI aVincH = " "; aVincH = "3"; |FINSI;
               |FINSI;
               aFNacH = #rem00101#17; aFAdoH = #rem00101#18;
               TipoDato = "F";
               aAlfa = aFNacH; |HAZ Formateo; |SI aAlfa = "        "; aFNacH = "00000000"; |SINO; aFNacH = aAlfa; |FINSI;
               aAlfa = aFAdoH; |HAZ Formateo; |SI aAlfa = "        "; aFAdoH = "00000000"; |SINO; aFAdoH = aAlfa; |FINSI;
               TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ Formateo; Cadena = Cadena + aAlfa;
               TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
               TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
               TipoDato = "N";  Long = 8;  aAlfa = aFAdoH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
               TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
               TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
               TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
               |HAZ GrabaCad;
               nCont10 = nCont10 + 1;
            |FINSI;
         |SIGUE;
      |FINSI;

      |PARA nCont = nCont10; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
         aNifH  = ""; aNombH = "";
         aAnyoH = ""; aMinuH = "0";
         aVincH = ""; aOtroH = "";
         aFNacH = "00000000"; aFAdoH = "00000000";
         TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 8;  aAlfa = aFAdoH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad;
      |SIGUE;
   |FINSI;

   || Hijos y otros descendientes : Fallecido 2003 - N§ orden
   TipoDato = "N"; Long = 2;  aAlfa = nOrdenFall1;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Hijos y otros descendientes : Fecha fallecimiento
   TipoDato = "F"; Long = 8;  aAlfa = aFechaFall1;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Hijos y otros descendientes : Fallecido 2003 - N§ orden
   TipoDato = "N"; Long = 2;  aAlfa = nOrdenFall2;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Hijos y otros descendientes : Fecha fallecimiento
   TipoDato = "F"; Long = 8;  aAlfa = aFechaFall2;  |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Bucle para la declaracion de ascendientes

   |SI aTipo = "TITULAR"; |O aTipo = "CONYUGE";
      nCont10 = 1;
      |PARA nCont = 1; |SI nCont [ 4; |HACIENDO nCont = nCont + 1;
         InAscend = nAscend1<-; InAscend = InAscend + (nCont - 1);
         #rem00101#0 = #rem00100#0;
         #rem00101#1 = nAscend;
         |LEE 000#rem00101.=;
         |SI FSalida = 0;  |Y aFamil = "N";
            |SI aTipo = "TITULAR"; |Y #rem00101#13 = "N";
               |SI #rem00101#7 = "1"; |O #rem00101#7 = " ";
                  |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
                  |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
                  |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
                  |SI #rem00101#6 ] 65; aMinuH = 3; |FINSI;
                  aNifH  = #rem00101#2; aNombH = #rem00101#3;
                  aAnyoH = #rem00101#5;
                  aVincH = #rem00101#7; aOtroH = #rem00101#9;
                  aNivRe = #rem00101#19; aFNacH = #rem00101#17;
                  TipoDato = "F";
                  aAlfa = aFNacH; |HAZ Formateo; |SI aAlfa = "        "; aFNacH = "00000000"; |SINO; aFNacH = aAlfa; |FINSI;

                  |SI aEstCiv = "3"; |Y aEC1 = "C"; aVincH = ""; |FINSI;

                  TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ Formateo; Cadena = Cadena + aAlfa;
                  TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                  TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                  TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                  TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                  TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                  |HAZ GrabaCad;
                  nCont10 = nCont10 + 1;
               |FINSI;
            |FINSI;
            |SI aTipo = "CONYUGE"; |Y #rem00101#13 = "N";
               |SI #rem00101#7 = "2"; |O #rem00101#7 = " ";
                  |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
                  |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
                  |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
                  |SI #rem00101#6 ] 65;  aMinuH = 3; |FINSI;
                  aNifH  = #rem00101#2;  aNombH = #rem00101#3;
                  aAnyoH = #rem00101#5;
                  aVincH = #rem00101#7;
                  |SI #rem00101#7 = "2"; aVincH = "1"; |FINSI;
                  aOtroH = #rem00101#9;
                  aNivRe = #rem00101#19; aFNacH = #rem00101#17;
                  TipoDato = "F";
                  aAlfa = aFNacH; |HAZ Formateo; |SI aAlfa = "        "; aFNacH = "00000000"; |SINO; aFNacH = aAlfa; |FINSI;

                  |SI aEstCiv = "3"; |Y aEC1 = "C"; aVincH = ""; |FINSI;

                  TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ Formateo; Cadena = Cadena + aAlfa;
                  TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                  TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                  TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                  TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                  TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
                  |HAZ GrabaCad;
                  nCont10 = nCont10 + 1;
               |FINSI;
            |FINSI;
         |FINSI;
      |SIGUE;
      |PARA nCont = nCont10; |SI nCont [ 4; |HACIENDO nCont = nCont + 1;
         aNifH  = ""; aNombH = "";
         aAnyoH = ""; aMinuH = "0";
         aVincH = ""; aOtroH = "";
         aNivRe = ""; aFNacH = "00000000";

         TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad;
      |SIGUE;
   |SINO;
      nCont10 = 1;
      |PARA nCont = 1; |SI nCont [ 4; |HACIENDO nCont = nCont + 1;
         InAscend = nAscend1<-; InAscend = InAscend + (nCont - 1);
         #rem00101#0 = #rem00100#0;
         #rem00101#1 = nAscend;
         |LEE 000#rem00101.=;
         |SI FSalida = 0;  |Y aFamil = "N";
            |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
            |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
            |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
            |SI #rem00101#6 ] 65; aMinuH = 3; |FINSI;
            aNifH  = #rem00101#2; aNombH = #rem00101#3;
            aAnyoH = #rem00101#5;
            aVincH = #rem00101#7; aOtroH = #rem00101#9;
            aNivRe = #rem00101#19; aFNacH = #rem00101#17;
            TipoDato = "F";
            aAlfa = aFNacH; |HAZ Formateo; |SI aAlfa = "        "; aFNacH = "00000000"; |SINO; aFNacH = aAlfa; |FINSI;

            TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ Formateo; Cadena = Cadena + aAlfa;
            TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
            nCont10 = nCont10 + 1;
         |FINSI;
         aTipo = VTipo; |QBF aTipo;
      |SIGUE;

      |PARA nCont = nCont10; |SI nCont [ 4; |HACIENDO nCont = nCont + 1;
         aNifH  = ""; aNombH = "";
         aAnyoH = ""; aMinuH = "0";
         aVincH = ""; aOtroH = "";
         aNivRe = ""; aFNacH = "00000000";

         TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad;
      |SIGUE;
   |FINSI;
   |CIERRA #rem00101;

   || Comunidad autonoma de residencia
   TipoDato = "N";  Long = 2;  aAlfa = #rem00100#11;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Solicitudes : Borrador declaracion o datos fiscales
   |SI #rew00001#9 = "S"; aAlfa = "1"; |SINO; aAlfa = "0"; |FINSI;
   TipoDato = "A";  Long = 1;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Sostenimiento de la iglesia catolica
   |SI aIglesia1 = "I"; |O aIglesia1 = "D";
      aAlfa = "X";
   |SINO;
      |SI aIglesia1 = "O"; |O aIglesia1 = " "; aAlfa = ""; |FINSI;
   |FINSI;
   TipoDato = "A";  Long = 1;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Colaboracion en fines sociales
   |SI aIglesia1 = "O"; |O aIglesia1 = "D";
      aAlfa = "X";
   |SINO;
      |SI aIglesia1 = "I"; |O aIglesia1 = " "; aAlfa = ""; |FINSI;
   |FINSI;
   TipoDato = "A";  Long = 1;                        |HAZ Formateo; Cadena = Cadena + aAlfa;

   |ABRE #rerenpre;
   #rerenpre#0 = #rem00100#65;
   |LEE 000#rerenpre.=;
   |SI FSalida = 0;
      || Representante : Nif
      TipoDato = "An"; Long = 9;  aAlfa = #rerenpre#2;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Representante : Apellidos y nombre o razon social
      TipoDato = "An"; Long = 32; aAlfa = #rerenpre#1;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |SINO;
      Cadena = Cadena + (" " * 41);
   |FINSI;
   |CIERRA #rerenpre;

   #rem01001#0 = VEmpresa;
   #rem01001#1 = 0;
   #rem01001#2 = VTipo;
   |LEE 000#rem01001.=;
   |SI FSalida ! 0; |DDEFECTO #rem01001; |FINSI;

   || Decl.Complementaria a otra del mismo ejercicio o por atrasos de rend.trabajo o complementaria a devolver
   aAlfa = "000";
   |SI #rem00100#97 = "1"; aAlfa = "100"; |FINSI;
   |SI #rem00100#97 = "2"; aAlfa = "110"; |FINSI;
   |SI #rem00100#97 = "3"; aAlfa = "001"; |FINSI;
   TipoDato = "A";  Long = 3;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Fecha y firma de la declaracion : Localidad
   TipoDato = "An"; Long = 20; aAlfa = aLocali1;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ CargaFecha;
   || Fecha y firma de la declaracion : Dia Fecha
   TipoDato = "N";  Long = 2;  aAlfa = DiaInf;       |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Fecha y firma de la declaracion : Mes Fecha
   TipoDato = "A";  Long = 10; aAlfa = MesInf;       |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Fecha y firma de la declaracion : A¤o Fecha
   TipoDato = "N";  Long = 4;  aAlfa = EjerInf;      |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuenta bancaria
   |SI #rem01001#11 = "X";
      aAlfa = "0" * 20;
   |SINO;
      aAlfa = aCuenta1;
   |FINSI;
   TipoDato = "N";  Long = 20; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Numero justificante
   TipoDato = "N";  Long = 13;  aAlfa = "0";         |HAZ Formateo; Cadena = Cadena + aAlfa;
   ||Reservado para la AEAT : N§ Referencia PADRE
   aAlfa = " " * 21; Cadena = Cadena + aAlfa;
   || Liquidacion : Resultado a ingresar o a devolver
   |SI #rem00100#97 = "N";  |O #rem00100#97 = "3";
      nTotal = 0;
      Bloque = 32;     Casilla = "1  "; |HAZ BuscaCasilla;
      |SI SwError = 1; Casilla = "2  "; |HAZ BuscaCasilla; |FINSI;
      |SI SwError = 1;
         Bloque = 30; Casilla = "760"; |HAZ BuscaCasilla; nTotal = Casilla; SwError = 1;
      |SINO;
         nTotal = #rem01001#16;
      |FINSI;
   |SINO;
      Bloque = 31; Casilla = "765"; |HAZ BuscaCasilla; nTotal = Casilla; SwError = 1;
   |FINSI;

   TipoDato = "N"; Long = 11; LongDec = 2;
   aAlfa = nTotal;                                   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Fraccionamiento del pago
   |SI #rem01001#8 = "S"; aAlfa = "1"; |SINO; aAlfa = "0"; |FINSI;
   TipoDato = "N";  Long = 1; LongDec = 0;           |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Domiciliacion del 2§ plazo
   |SI #rem01001#10 = "S"; aAlfa = "1"; |SINO; aAlfa = "0"; |FINSI;
   TipoDato = "N";  Long = 1;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Renuncia a la devolucion
   |SI #rem01001#11 = "X"; aAlfa = "1"; |SINO; aAlfa = "0"; |FINSI;
   TipoDato = "N";  Long = 1;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Compensacion entre conyuges
   Bloque = 32;     Casilla = "1  "; |HAZ BuscaCasilla;
   |SI SwError = 1; Casilla = "2  "; |HAZ BuscaCasilla; |FINSI;
   |SI SwError = 1; aAlfa = "0"; |SINO; aAlfa = "1"; |FINSI;
   TipoDato = "N";  Long = 1;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Reservado para la AEAT : Identificacion cliente EEDD
   |SI #reemi100#59 = "S";
      aAlfa = VEmpresa + " " + VTipo;
      TipoDato = "An";  Long = 20;                   |HAZ Formateo; Cadena = Cadena + aAlfa;
   |SINO;
      Cadena = Cadena + (" " * 20);
   |FINSI;
   || Sello electronico reservado para la AEAT
   Cadena = Cadena + (" " * 13);
   Cadena = Cadena + "</T10001>";
   Cadena = Cadena + &13 + &10; |HAZ GrabaCad;
|FPRC;

|PROCESO Hoja09;

   nSwDatos = 9; nCalc1 = 0;
   aTipo = VTipo % 0110;

   Cadena = "<T10009> ";
   |ABRE #rem01033; |ABRE #rem01034;

   |SI nCont < nCalc1; nCont = nCalc1; |FINSI;
   |SI nCont < nCalc2; nCont = nCalc2; |FINSI;

   |SI nSwDatos = 0; |ACABA; |FINSI;

   #rem01033#0 = VEmpresa;
   #rem01033#1 = 0;
   #rem01033#2 = aTipo;
   |LEE 000#rem01033.=;
   |SI FSalida ! 0; |DDEFECTO #rem01033; |FINSI;

   #rem01034#0 = VEmpresa;
   #rem01034#1 = 0;
   #rem01034#2 = aTipo;
   |LEE 000#rem01034.=;
   |SI FSalida ! 0; |DDEFECTO #rem01034; |FINSI;

   || (G6) Integracion/compensacion ganancias/perdidas imputables 2003 : Ganancias/perdidas integrar parte general renta : Suma ganancias
   TipoDato = "N"; Long = 11;  LongDec = 2;
   aAlfa = #rem01033#27;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Integracion/compensacion ganancias/perdidas imputables 2003 : Ganancias/perdidas integrar parte general renta : Suma perdidas
   aAlfa = #rem01033#28;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Integracion/compensacion ganancias/perdidas imputables 2003 : Ganancias/perdidas integrar parte general renta : Saldo neto : Diferencia positiva
   aAlfa = #rem01033#29;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Integracion/compensacion ganancias/perdidas imputables 2003 : Ganancias/perdidas integrar parte general renta : Saldo neto : Diferencia negativa
   aAlfa = #rem01033#30;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Integracion/compensacion ganancias/perdidas imputables 2003 : Ganancias/perdidas integrar parte general renta : Suma ganancias/saldo positivo
   aAlfa = #rem01033#31;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Integracion/compensacion ganancias/perdidas imputables 2003 : Ganancias/perdidas integrar parte general renta : Suma perdidas/saldo negativo
   aAlfa = #rem01033#32;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Integracion/compensacion ganancias/perdidas imputables 2003 : Ganancias/perdidas integrar parte general renta : Saldo neto : Diferencia positiva
   aAlfa = #rem01033#33;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Integracion/compensacion ganancias/perdidas imputables 2003 : Ganancias/perdidas integrar parte general renta : Saldo neto : Diferencia negativa
   aAlfa = #rem01033#34;  |HAZ Formateo; Cadena = Cadena + aAlfa;

   || (H) Renta : Parte general/parte especial : Parte general : Saldo neto positivo
   aAlfa = #rem01034#3;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Renta : Parte general/parte especial : Parte general : Saldo neto negativo
   aAlfa = #rem01034#4;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Renta : Parte general/parte especial : Parte general : Saldo neto rendimiento e imputaciones
   aAlfa = #rem01034#5;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Renta : Parte general/parte especial : Parte general : Compensaciones : Resto saldo neto negativo ejercicios 2000 a 2003
   aAlfa = #rem01034#7;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Renta : Parte general/parte especial : Parte general : Compensaciones : Saldo neto negativo imputable 2004
   aAlfa = #rem01034#8;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Renta : Parte general/parte especial : Parte general : Compensaciones : Saldo neto negativo imputable 2004 - Importe pdte.compensar
   aAlfa = #rem01034#9;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Renta : Parte general/parte especial : Parte general de la renta
   aAlfa = #rem01034#10;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Renta : Parte general/parte especial : Parte especial : Saldo neto positivo
   aAlfa = #rem01034#11;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Renta : Parte general/parte especial : Parte especial : Compensaciones : Saldo neto negativo ejercicios 2000 a 2003
   aAlfa = #rem01034#13;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Renta : Parte general/parte especial : Parte especial de la renta
   aAlfa = #rem01034#14;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || (I) Base imponible : Minimo personal y familiar : Importe minimo personal
   aAlfa = #rem01034#15;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base imponible : Minimo personal y familiar : Importe minimo por descendientes
   aAlfa = #rem01034#16;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base imponible : Minimo personal y familiar
   aAlfa = #rem01034#17;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base imponible : Parte general de la base imponible : Parte general de la renta
   aAlfa = #rem01034#18;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base imponible : Parte general de la base imponible : Importe minimo personal y familiar
   aAlfa = #rem01034#19;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base imponible : Parte general de la base imponible
   aAlfa = #rem01034#20;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base imponible : Parte general de la base imponible.Cantidades reducidas ejerc.anteriores a 2005
   aAlfa = #rem01034#87;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base imponible : Parte especial de la base imponible : Parte especial de la renta
   aAlfa = #rem01034#21;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base imponible : Parte especial de la base imponible : Minimo personal y familiar
   aAlfa = #rem01034#22;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base imponible : Parte especial de la base imponible
   aAlfa = #rem01034#23;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base imponible : Parte especial de la base imponible.Cantidades reducidas ejerc.anteriores a 2005
   aAlfa = #rem01034#88;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || (J) Reducciones de la base imponible : Circunstancias laborales, personales y familiares : Reduccion rendimiento trabajo
   aAlfa = #rem01034#24;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Reducciones de la base imponible : Circunstancias laborales, personales y familiares : Reduccion prolongacion actividad laboral
   aAlfa = #rem01034#25;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Reducciones de la base imponible : Circunstancias laborales, personales y familiares : Reduccion movilidad geografica
   aAlfa = #rem01034#26;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Reducciones de la base imponible : Circunstancias laborales, personales y familiares : Reduccion cuidado hijos
   aAlfa = #rem01034#27;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Reducciones de la base imponible : Circunstancias laborales, personales y familiares : Reduccion por edad
   aAlfa = #rem01034#28;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Reducciones de la base imponible : Circunstancias laborales, personales y familiares : Reduccion por asistencia
   aAlfa = #rem01034#29;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Reducciones de la base imponible : Circunstancias laborales, personales y familiares : Reduccion discapacidad del contribuyente
   aAlfa = #rem01034#30;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Reducciones de la base imponible : Circunstancias laborales, personales y familiares : Reduccion discapacidad ascendientes/descendientes
   aAlfa = #rem01034#31;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Reducciones de la base imponible : Circunstancias laborales, personales y familiares : Reduccion discapacidad trabajadores activos
   aAlfa = #rem01034#32;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Reducciones de la base imponible : Circunstancias laborales, personales y familiares : Reduccion por gastos asistencia discapacitados
   aAlfa = #rem01034#33;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Reducciones de la base imponible : Circunstancias laborales, personales y familiares : Suma de reducciones
   aAlfa = #rem01034#34;  |HAZ Formateo; Cadena = Cadena + aAlfa;

   Cadena = Cadena + "</T10009>" + &13 + &10; |HAZ GrabaCad;

   |CIERRA #rem01033; |CIERRA #rem01034;
|FPRC;

|PROCESO Hoja10;

   nSwDatos = 10; nCalc1 = 0;
   aTipo = VTipo % 0110;

   Cadena = "<T10010> ";
   |ABRE #rem01034; |ABRE #rem01035; |ABRE #rem01037;

   #rem01034#0 = VEmpresa;
   #rem01034#1 = 0;
   #rem01034#2 = aTipo;
   |LEE 000#rem01034.=;
   |SI FSalida ! 0; |DDEFECTO #rem01034; |FINSI;

   #rem01035#0 = VEmpresa;
   #rem01035#1 = 0;
   #rem01035#2 = aTipo;
   #rem01035#3 = 1;
   |LEE 000#rem01035.];
   |SI FSalida = 0; |Y #rem01035#0 = VEmpresa; |Y #rem01035#1 = 0; |Y #rem01035#2 = aTipo;
      |PARA nCont = 0; |SI nCont < 2; |HACIENDO nCont = nCont + 1;
         || (J) Reducciones de la base imponible : Aportaciones patrimonios protegidos discapacitados : Contribuyente
         aAlfa = #rem01035#4; |HAZ TipoContr; Cadena = Cadena + aTipoContr;
         || Reducciones de la base imponible : Aportaciones patrimonios protegidos discapacitados : NIF Titular
         TipoDato = "A";  Long = 9;   LongDec = 0;
         aAlfa = #rem01035#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Reducciones de la base imponible : Aportaciones patrimonios protegidos discapacitados : Aportaciones 2004
         TipoDato = "N";  Long = 11;  LongDec = 2;
         aAlfa = #rem01035#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Reducciones de la base imponible : Aportaciones patrimonios protegidos discapacitados : Aportaciones
         aAlfa = #rem01035#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;

         |LEE 000#rem01035.s;
         |SI FSalida ! 0; |O #rem01035#0 ! VEmpresa; |O #rem01035#1 ! 0; |O #rem01035#2 ! aTipo;
            |DDEFECTO #rem01035;
         |FINSI;
      |SIGUE;
   |SINO;
      aAlfa = "0         00000000000000000000000000"; Cadena = Cadena + aAlfa;
      aAlfa = "0         00000000000000000000000000"; Cadena = Cadena + aAlfa;
   |FINSI;

   || Reducciones de la base imponible : Aportaciones patrimonios protegidos discapacitados : Aportaciones derecho reduccion
   TipoDato = "N";  Long = 11;  LongDec = 2;
   aAlfa = #rem01034#75;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   #rem01037#0 = VEmpresa;
   #rem01037#1 = 0;
   #rem01037#2 = aTipo;
   #rem01037#3 = 1;
   |LEE 000#rem01037.];
   |SI FSalida = 0; |Y #rem01037#0 = VEmpresa; |Y #rem01037#1 = 0; |Y #rem01037#2 = aTipo;
      || (J) Reducciones de la base imponible : Aportaciones patrimonios protegidos : Contribuyente
      |SI #rem01037#5 = 0; |Y #rem01037#6  = 0; |Y #rem01037#7  = 0; |Y #rem01037#8  = 0;
       |Y #rem01037#9 = 0; |Y #rem01037#10 = 0; |Y #rem01037#11 = 0; |Y #rem01037#12 = 0;
         aAlfa = "";
      |SINO;
         aAlfa = #rem01037#4;
      |FINSI;
      |HAZ TipoContr; Cadena = Cadena + aTipoContr;
      || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Regimen general : Aportaciones directas : Excesos pdtes.1998 a 2002
      TipoDato = "N";  Long = 11;  LongDec = 2;
      aAlfa = #rem01037#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Regimen general : Contribuciones imputadas : Excesos pdtes.1998 a 2002
      aAlfa = #rem01037#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Regimen general : Aportaciones directas : Aportaciones 2003
      aAlfa = #rem01037#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Regimen general : Contribuciones imputadas : Aportaciones 2003
      aAlfa = #rem01037#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Regimen general : Aportaciones directas : Totales derecho reduccion
      aAlfa = #rem01037#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Regimen general : Contribuciones imputadas : Totales derecho reduccion
      aAlfa = #rem01037#11; |HAZ Formateo; Cadena = Cadena + aAlfa;

      |LEE 000#rem01037.s;
      |SI FSalida = 0; |Y #rem01037#0 = VEmpresa; |Y #rem01037#1 = 0; |Y #rem01037#2 = aTipo;
         || (J) Reducciones de la base imponible : Aportaciones sistemas de prevision social : Regimen general : Contribuyente
         |SI #rem01037#5 = 0; |Y #rem01037#6  = 0; |Y #rem01037#7  = 0; |Y #rem01037#8  = 0;
          |Y #rem01037#9 = 0; |Y #rem01037#10 = 0; |Y #rem01037#11 = 0; |Y #rem01037#12 = 0;
            aAlfa = "";
         |SINO;
            aAlfa = #rem01037#4;
         |FINSI;
         |HAZ TipoContr; Cadena = Cadena + aTipoContr;
         || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Regimen general : Aportaciones directas : Excesos pdtes.1998 a 2002
         TipoDato = "N";  Long = 11;  LongDec = 2;
         aAlfa = #rem01037#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Regimen general : Contribuciones imputadas : Excesos pdtes.1998 a 2002
         aAlfa = #rem01037#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Regimen general : Aportaciones directas : Aportaciones 2003
         aAlfa = #rem01037#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Regimen general : Contribuciones imputadas : Aportaciones 2003
         aAlfa = #rem01037#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Regimen general : Aportaciones directas : Totales derecho reduccion
         aAlfa = #rem01037#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Regimen general : Contribuciones imputadas : Totales derecho reduccion
         aAlfa = #rem01037#11; |HAZ Formateo; Cadena = Cadena + aAlfa;
      |SINO;
         aAlfa = "0" * 79; Cadena = Cadena + aAlfa;
      |FINSI;
   |SINO;
      aAlfa = "0" * 158; Cadena = Cadena + aAlfa;
   |FINSI;
   |HAZ GrabaCad;

   || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Regimen general : Total derecho reduccion
   TipoDato = "N";  Long = 11;  LongDec = 2;
   aAlfa = #rem01034#35;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Conyuge : Aportaciones derecho reduccion
   aAlfa = #rem01034#36;  |HAZ Formateo; Cadena = Cadena + aAlfa;

   || N§ hojas adicionales
   Cadena = Cadena + "0";

   #rem01037#0 = VEmpresa;
   #rem01037#1 = 0;
   #rem01037#2 = aTipo;
   #rem01037#3 = 1;
   |LEE 000#rem01037.];
   |SI FSalida = 0; |Y #rem01037#0 = VEmpresa; |Y #rem01037#1 = 0; |Y #rem01037#2 = aTipo;
      || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Minusvalidos => 65% : Contribuyente
      |SI #rem01037#14 ! 0; |O #rem01037#15 ! 0; |O #rem01037#19 ! 0;
         aAlfa = #rem01037#4;
      |SINO;
         aAlfa = "";
      |FINSI;
      |HAZ TipoContr; Cadena = Cadena + aTipoContr;
      || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Minusvalidos => 65% : NIF
      TipoDato = "An";  Long = 9;  LongDec = 0;
      aAlfa = #rem01037#13;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Minusvalidos => 65% : Accesos pendientes 2003
      TipoDato = "N";  Long = 11;  LongDec = 2;
      aAlfa = #rem01037#19;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Minusvalidos => 65% : Aportaciones propias
      aAlfa = #rem01037#14;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Minusvalidos => 65% : Aportaciones de parientes
      aAlfa = #rem01037#15;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      |LEE 000#rem01037.s;
      |SI FSalida = 0; |Y #rem01037#0 = VEmpresa; |Y #rem01037#1 = 0; |Y #rem01037#2 = aTipo;
         || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Minusvalidos => 65% : Contribuyente
         |SI #rem01037#14 ! 0; |O #rem01037#15 ! 0; |O #rem01037#19 ! 0;
            aAlfa = #rem01037#4;
         |SINO;
            aAlfa = "";
         |FINSI;
         |HAZ TipoContr; Cadena = Cadena + aTipoContr;
         || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Minusvalidos => 65% : NIF
         TipoDato = "An";  Long = 9;  LongDec = 0;
         aAlfa = #rem01037#13;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Minusvalidos => 65% : Excesos pendientes 2003
         TipoDato = "N";  Long = 11;  LongDec = 2;
         aAlfa = #rem01037#19;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Minusvalidos => 65% : Aportaciones propias
         aAlfa = #rem01037#14;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Minusvalidos => 65% : Aportaciones de parientes
         aAlfa = #rem01037#15;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      |SINO;
         aAlfa = "0         " + ("0" * 39); Cadena = Cadena + aAlfa;
      |FINSI;
   |SINO;
      aAlfa = "0         " + ("0" * 39); Cadena = Cadena + aAlfa;
      aAlfa = "0         " + ("0" * 39); Cadena = Cadena + aAlfa;
   |FINSI;
   |HAZ GrabaCad;

   || Reducciones de la base imponible : Aportaciones sistemas de prevision social : Minusvalidos => 65% : Aportaciones derecho reduccion
   TipoDato = "N";  Long = 11;  LongDec = 2;
   aAlfa = #rem01034#37;  |HAZ Formateo; Cadena = Cadena + aAlfa;

   |SI #rem01034#38 = "X";
      || Reducciones de la base imponible : Pension compensatoria conyuge y anualidades por alimentos : Contribuyente
      aAlfa = "TITULAR   ";  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
      || Reducciones de la base imponible : Pension compensatoria conyuge y anualidades por alimentos : NIF receptores
      TipoDato = "An";  Long = 9;  LongDec = 0;
      aAlfa = #rem01034#39;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Reducciones de la base imponible : Pension compensatoria conyuge y anualidades por alimentos : Importe satisfecho 2003 por decision judicial
      TipoDato = "N";  Long = 11;  LongDec = 2;
      aAlfa = #rem01034#40;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |FINSI;
   |SI #rem01034#41 = "X";
      || Reducciones de la base imponible : Pension compensatoria conyuge y anualidades por alimentos : Contribuyente
      aAlfa = "CONYUGE   ";  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
      || Reducciones de la base imponible : Pension compensatoria conyuge y anualidades por alimentos : NIF receptores
      TipoDato = "An";  Long = 9;  LongDec = 0;
      aAlfa = #rem01034#42;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Reducciones de la base imponible : Pension compensatoria conyuge y anualidades por alimentos : Importe satisfecho 2003 por decision judicial
      TipoDato = "N";  Long = 11;  LongDec = 2;
      aAlfa = #rem01034#43;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |FINSI;
   |SI #rem01034#38 = " ";
      aAlfa = "0         0000000000000"; Cadena = Cadena + aAlfa;
   |FINSI;
   |SI #rem01034#41 = " ";
      aAlfa = "0         0000000000000"; Cadena = Cadena + aAlfa;
   |FINSI;
   aAlfa = "0         0000000000000"; Cadena = Cadena + aAlfa;
   TipoDato = "N";  Long = 11;  LongDec = 2;
   || Reducciones de la base imponible : Pension compensatoria conyuge y anualidades por alimentos : Total derecho reduccion
   aAlfa = #rem01034#44;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Reducciones de la base imponible : Aportaciones mutualidad deportistas profesionales - Aportaciones
   aAlfa = #rem01034#45;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || (K) Base liquidable general/especial : Determinacion base liquidable general : Parte general base imponible
   aAlfa = #rem01034#46;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general/especial : Determinacion base liquidable general : Reducciones base imponible : Circunst.laborales, personales, familiares
   aAlfa = #rem01034#47;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general/especial : Determinacion base liquidable general : Reducciones base imponible : Aportaciones patrim.protegidos discapacitados
   aAlfa = #rem01034#77;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general/especial : Determinacion base liquidable general : Reducciones base imponible : Aportaciones sistemas prev.social
   aAlfa = #rem01034#48;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general/especial : Determinacion base liquidable general : Reducciones base imponible : Aportaciones sistemas prev.social conyuge
   aAlfa = #rem01034#49;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general/especial : Determinacion base liquidable general : Reducciones base imponible : Aportaciones sistemas prev.social minusvalidos
   aAlfa = #rem01034#50;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general/especial : Determinacion base liquidable general : Reducciones base imponible : Pension compensatoria/anualidad alimentos
   aAlfa = #rem01034#51;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general/especial : Determinacion base liquidable general : Reducciones base imponible : Aportaciones mutua.deportistas profesionales
   aAlfa = #rem01034#52;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general/especial : Determinacion base liquidable general : Base liquidable general
   aAlfa = #rem01034#53;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Base liquidable general/especial : Determinacion base liquidable general : Compensaciones : Base liquidable negativa 2000 y 2003
   aAlfa = #rem01034#55;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general/especial : Determinacion base liquidable general : Base liquidable general sometida a gravamen
   aAlfa = #rem01034#56;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general/especial : Determinacion base liquidable general : Parte especial de la base imponible
   aAlfa = #rem01034#57;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general/especial : Determinacion base liquidable general : Remanente reduc.no aplicadas : Circunst.laborales, personales, familiares
   aAlfa = #rem01034#58;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general/especial : Determinacion base liquidable general : Remanente reduc.no aplicadas : Aportaciones patrim.protegidos discapacitados
   aAlfa = #rem01034#78;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general/especial : Determinacion base liquidable general : Remanente reduc.no aplicadas : Aportaciones sistemas prev.social
   aAlfa = #rem01034#59;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general/especial : Determinacion base liquidable general : Remanente reduc.no aplicadas : Aportaciones sistemas prev.social conyuge
   aAlfa = #rem01034#60;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general/especial : Determinacion base liquidable general : Remanente reduc.no aplicadas : Aportaciones sistemas prev.social minusvalidos
   aAlfa = #rem01034#61;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general/especial : Determinacion base liquidable general : Remanente reduc.no aplicadas : Pension compensatoria/anualidad por alimentos
   aAlfa = #rem01034#62;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general/especial : Determinacion base liquidable general : Base liquidable especial
   aAlfa = #rem01034#63;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   Cadena = "</T10010>" + &13 + &10; |HAZ GrabaCad;

   |CIERRA #rem01035; |CIERRA #rem01037; |CIERRA #rem01034;
|FPRC;

|PROCESO Hoja11;

   nSwDatos = 0; nCalc1 = 0;
   aTipo = VTipo % 0110;

   |ABRE #rem01034;

   #rem01034#0 = VEmpresa;
   #rem01034#1 = 0;
   #rem01034#2 = aTipo;
   |LEE 000#rem01034.=;
   |SI FSalida ! 0; |DDEFECTO #rem01034; |FINSI;

   Cadena = "<T10011> ";
   TipoDato = "N"; Long = 11; LongDec = 2;
   || Base liquidable general/especial : Aportac.Patrim.protegidos discapacitados no reducidas por exceso : Contribuyentes con derecho reduccion
   aAlfa = #rem01034#79; |SI #rem01034#80 = 0; aAlfa = ""; |FINSI;
   |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Base liquidable general/especial : Aportac.Patrim.protegidos discapacitados no reducidas por exceso : Aport. 2004 no aplicadas reducir 5 a¤os siguientes
   aAlfa = #rem01034#80;  |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Base liquidable general/especial : Aportac.Patrim.protegidos discapacitados no reducidas por exceso : Contribuyentes con derecho reduccion
   aAlfa = #rem01034#81; |SI #rem01034#82 = 0; aAlfa = ""; |FINSI;
   |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Base liquidable general/especial : Aportac.Patrim.protegidos discapacitados no reducidas por exceso : Aport. 2004 no aplicadas reducir 5 a¤os siguientes
   aAlfa = #rem01034#82;  |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Base liquidable general/especial : Aportac.sist.prev.social no reducidas insuficiencia base imponible : Contribuyentes con derecho reduccion
   aAlfa = #rem01034#64;
   |SI #rem01034#65 = 0; |Y #rem01034#66 = 0; aAlfa = ""; |FINSI;
   |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Base liquidable general/especial : Aportac.sist.prev.social no reducidas insuficiencia base imponible : Aport. 2004 no aplicadas reducir 5 a¤os siguientes
   aAlfa = #rem01034#65;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general/especial : Aportac.sist.prev.social no reducidas insuficiencia base imponible : Contrib.inputadas 2004 no aplicadas reducir 5 a¤os siguientes
   aAlfa = #rem01034#66;  |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Base liquidable general/especial : Aportac.sist.prev.social no reducidas insuficiencia base imponible : Contribuyentes con derecho reduccion
   aAlfa = #rem01034#67;
   |SI #rem01034#68 = 0; |Y #rem01034#69 = 0; aAlfa = ""; |FINSI;
   |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Base liquidable general/especial : Aportac.sist.prev.social no reducidas insuficiencia base imponible : Aport. 2004 no aplicadas reducir 5 a¤os siguientes
   aAlfa = #rem01034#68;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general/especial : Aportac.sist.prev.social no reducidas insuficiencia base imponible : Contrib.inputadas 2004 no aplicadas reducir 5 a¤os siguientes
   aAlfa = #rem01034#69;  |HAZ Formateo; Cadena = Cadena + aAlfa;

   Cadena = Cadena + "0";
   || Base liquidable general/especial : Aportac.sist.prev.social minusvalidos no reducidas insuficiencia base imponible : Contribuyente
   aAlfa = #rem01034#83;
   |SI #rem01034#84 = 0; aAlfa = ""; |FINSI;
   |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Base liquidable general/especial : Aportac.sist.prev.social minusvalidos no reducidas insuficiencia base imponible : Aport.no aplicadas 2004 a reducir 5 a¤os siguientes
   aAlfa = #rem01034#84;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Base liquidable general/especial : Aportac.sist.prev.social minusvalidos no reducidas insuficiencia base imponible : Contribuyente
   aAlfa = #rem01034#85;
   |SI #rem01034#86 = 0; aAlfa = ""; |FINSI;
   |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Base liquidable general/especial : Aportac.sist.prev.social minusvalidos no reducidas insuficiencia base imponible : Aport.no aplicadas 2004 a reducir 5 a¤os siguientes
   aAlfa = #rem01034#86;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   |CIERRA #rem01034;

   || (L) Determinacion cuotas/resultado : Datos adicionales : Rentas exentas progresividad/anualidad por alimentos : Importe rentas exentas IRPF
   TipoDato = "N"; Long = 11; LongDec = 2;
   Bloque = 15; Casilla = "673"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Datos adicionales : Rentas exentas progresividad/anualidad por alimentos : Importe anualidad alimentos hijos
   Bloque = 15; Casilla = "674"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte estatal : Gravamen base liquidable general
   Bloque = 16; Casilla = "675"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte autonomica : Gravamen base liquidable general
   aAlfa = Casilla1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte estatal    : Tipos medios gravamen (TME)
   Long = 2;
   Bloque = 16; Casilla = "TM1"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte autonomica : Tipos medios gravamen (TMA)
   Bloque = 16; Casilla = "TM2"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte estatal : Gravamen base liquidable especial : Cuotas
   Long = 11;
   Bloque = 17; Casilla = "679"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte autonomica : Gravamen base liquidable especial : Cuotas
   aAlfa = Casilla1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte estatal : Cuotas integras
   Bloque = 18; Casilla = "681"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte autonomica : Cuotas integras
   aAlfa = Casilla1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte estatal : Deducciones : Inversion cultura
   Bloque = 19; Casilla = "683"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte autonomica : Deducciones : Inversion cultura
   aAlfa = Casilla1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte estatal : Deducciones : Donativos
   Bloque = 19; Casilla = "685"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte autonomica : Deducciones : Donativos
   aAlfa = Casilla1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte estatal : Deducciones : Vvda.habit. : Adquis./Rehab. con financiacion ajena
   Bloque = 20; Casilla = "687"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte autonomica : Deducciones : Vvda.habit. : Adquis./Rehab. con financiacion ajena
   aAlfa = Casilla1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte estatal : Deducciones : Vvda.habit. : Adquis./Rehab. sin financiacion ajena
   Bloque = 20; Casilla = "689"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte autonomica : Deducciones : Vvda.habit. : Adquis./Rehab. sin financiacion ajena
   aAlfa = Casilla1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte estatal : Deducciones : Vvda.habit. : Construccion/Ampliacion
   Bloque = 20; Casilla = "691"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte autonomica : Deducciones : Vvda.habit. : Construccion/Ampliacion
   aAlfa = Casilla1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte estatal : Deducciones : Vvda.habit. : Cuenta vivienda
   Bloque = 20; Casilla = "693"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte autonomica : Deducciones : Vvda.habit. : Cuenta vivienda
   aAlfa = Casilla1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte estatal : Deducciones : Vvda.habit. : Adecuacion minusv.con financiacion ajena
   Bloque = 20; Casilla = "695"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte autonomica : Deducciones : Vvda.habit. : Adecuacion minusv.con financiacion ajena
   aAlfa = Casilla1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte estatal : Deducciones : Vvda.habit. : Adecuacion minusv.sin financiacion ajena
   Bloque = 20; Casilla = "697"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte autonomica : Deducciones : Vvda.habit. : Adecuacion minusv.sin financiacion ajena
   aAlfa = Casilla1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte estatal : Deducciones : Activ.Econom. : Incentivos inversion empresarial
   Bloque = 21; Casilla = "699"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte autonomica : Deducciones : Activ.Econom. : Incentivos inversion empresarial
   aAlfa = Casilla1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte estatal : Deducciones : Activ.Econom. : Inversiones en Canarias
   Bloque = 21; Casilla = "701"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte autonomica : Deducciones : Activ.Econom. :  Inversiones en Canarias
   aAlfa = Casilla1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte estatal : Deducciones : Activ.Econom. : Rdtos.venta bienes Canarias
   Bloque = 21; Casilla = "703"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte autonomica : Deducciones : Activ.Econom. :  Rdtos.venta bienes Canarias
   aAlfa = Casilla1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte estatal : Deducciones : Rentas obtenidas en Ceuta o Melilla
   Bloque = 22; Casilla = "705"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte autonomica : Deducciones :  Rentas obtenidas en Ceuta o Melilla
   aAlfa = Casilla1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte estatal : Deducciones : Depositos cuentas ahorro empresas
   Bloque = 23; Casilla = "707"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Parte autonomica : Deducciones : Depositos cuentas ahorro empresas
   aAlfa = Casilla1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Deducciones autonomicas
   Bloque = 24; Casilla = "709"; |HAZ BuscaCasilla;
   aAlfa = Casilla1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Cuotas liquidas : Cuota liquida estatal
   Bloque = 25; Casilla = "710"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Cuotas liquidas : Cuota liquida autonomica
   aAlfa = Casilla1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Cuotas liquidas : Deducciones 1996 y anteriores : Importe deduccion sin derecho
   Bloque = 26; Casilla = "712"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Cuotas liquidas : Deducciones 1996 y anteriores : Intereses demora
   Bloque = 26; Casilla = "713"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Cuotas liquidas : Importe deduccion sin derecho 1997 a 2003
   Bloque = 26; Casilla = "714"; |HAZ BuscaCasilla;
   nCalc = Casilla + Casilla1; aAlfa = nCalc; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Cuotas liquidas : Intereses de demora 1997 a 2003
   Bloque = 26; Casilla = "715"; |HAZ BuscaCasilla;
   nCalc = Casilla + Casilla1; aAlfa = nCalc; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Cuotas liquidas : Deduc.gral.1997 a 2003 : Importe deduccion sin derecho parte estatal
   Bloque = 26; Casilla = "714"; |HAZ BuscaCasilla;
   nCalc = Casilla;  aAlfa = nCalc; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Cuotas liquidas : Deduc.gral.1997 a 2003 : Intereses de demora parte estatal
   Bloque = 26; Casilla = "715"; |HAZ BuscaCasilla;
   nCalc = Casilla;  aAlfa = nCalc; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Cuotas liquidas : Deduc.gral.1997 a 2003 : Importe deduccion sin derecho parte autonomica
   Bloque = 26; Casilla = "714"; |HAZ BuscaCasilla;
   nCalc = Casilla1; aAlfa = nCalc; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Cuotas liquidas : Deduc.gral.1997 a 2003 : Intereses de demora parte autonomica
   Bloque = 26; Casilla = "715"; |HAZ BuscaCasilla;
   nCalc = Casilla1; aAlfa = nCalc; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Cuotas liquidas : Deduc.autonomica 1998 a 2003 : Importe deduccion sin derecho
   Bloque = 26; Casilla = "718"; |HAZ BuscaCasilla;
   nCalc = Casilla1; aAlfa = nCalc; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Cuotas liquidas : Deduc.autonomica 1998 a 2002 : Intereses demora
   Bloque = 26; Casilla = "719"; |HAZ BuscaCasilla;
   nCalc = Casilla1; aAlfa = nCalc; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Cuotas liquidas : Cuotas liquidas incrementadas, parte estatal
   Bloque = 26; Casilla = "720"; |HAZ BuscaCasilla;
   nCalc = Casilla;  aAlfa = nCalc; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Determinacion cuotas/resultado : Gravamen estatal/autonomico : Cuotas liquidas : Cuotas liquidas incrementadas, parte autonomica
   nCalc = Casilla1;  aAlfa = nCalc; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   Cadena = Cadena + "</T10011>" + &13 + &10;  |HAZ GrabaCad;
|FPRC;

|PROCESO Hoja12;

   nSwDatos = 0; nCalc1 = 0;
   aTipo = VTipo % 0110;

   Cadena = "<T10012> ";

   |ABRE #rem01018;
   #rem01018#0 = VEmpresa;
   #rem01018#1 = 0;
   #rem01018#2 = aTipo;
   |LEE 000#rem01018.=;
   |SI FSalida ! 0; |DDEFECTO #rem01018; |FINSI;
   |CIERRA #rem01018;

   |ABRE #rem01041;
   #rem01041#0 = VEmpresa;
   #rem01041#1 = 0;
   #rem01041#2 = aTipo;
   |LEE 000#rem01041.=;
   |SI FSalida ! 0; |DDEFECTO #rem01041; |FINSI;

   || (L) Liquidacion impuesto : Cuota autoliquidacion : Cuota liquida incrementada
   TipoDato = "N"; Long = 11; LongDec = 2;
   Bloque = 27; Casilla = "722"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida : Cuota autoliquidacion : Deducc.doble impos.: Saldo pdte.deduccion 2004. Deducciones 2000 a 2003
   aAlfa = #rem01041#30;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida : Cuota autoliquidacion : Deducc.doble impos.: Aplicado en declaracion : Deducciones 2000 a 2003
   aAlfa = #rem01041#31;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida : Cuota autoliquidacion : Deducc.doble impos.: Pendte. aplicacion : Deducciones 2000 a 2003
   aAlfa = #rem01041#32;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida : Cuota autoliquidacion : Deducc.doble impos.: Saldo pdte.deduccion 2004. Deduccion 2004
   aAlfa = #rem01041#33;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida : Cuota autoliquidacion : Deducc.doble impos.: Aplicado en declaracion : Deduccion 2004
   aAlfa = #rem01041#34;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida : Cuota autoliquidacion : Deducc.doble impos.: Pendte. aplicacion : Deduccion 2004
   aAlfa = #rem01041#35;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida : Cuota autoliquidacion : Deducc.doble impos.: Importe aplicado
   aAlfa = #rem01041#36;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida : Deducc.doble impos.internacional : Rentas obtenidas y gravadas en el extranjero
   Bloque = 28; Casilla = "730"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida : Deducc.doble impos.internacional : Deduccion doble imposicion internacional transparencia fiscal
   Bloque = 28; Casilla = "731"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida : Deducc.doble impos.internacional : Deduccion doble imposicion por cesion derechos de imagen
   Bloque = 28; Casilla = "732"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida : Compensaciones fiscales por deduccion. Compensacion arrendatarios vivienda habitual
   Bloque = 28; Casilla = "733"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida : Compensaciones fiscales por deduccion. Nif arrendador vivienda habitual
   TipoDato = "A"; Long = 9; LongDec = 0;
   |SI Casilla ! 0;
       aAlfa = #rem01018#21;
   |SINO;
       aAlfa = "";
   |FINSI;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida : Compensaciones fiscales por deduccion. Compensacion deduccion adquisicion vivienda habitual
   TipoDato = "N"; Long = 11; LongDec = 2;
   Bloque = 28; Casilla = "735"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida : Retenciones no practicadas pero fiscalmente deducibles
   Bloque = 28; Casilla = "736"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida : Cuota resultante de la autoliquidacion
   Bloque = 28; Casilla = "737"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Retenciones y demas pagos a cuenta : Por rendimiento de trabajo. Suma retenciones e ingresos a cuenta
   Bloque = 29; Casilla = "738"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta : Por rendimiento del capital mobiliario. Suma retenciones e ingresos a cuenta
   Bloque = 29; Casilla = "739"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta : Por arrend.inmuebles urbanos : Suma retenciones e ingresos a cuenta
   Bloque = 29; Casilla = "740"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta : Por rendim.actividades economicas : Suma
   Bloque = 29; Casilla = "741"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta : Por actividades economicas : Pagos fraccionados
   Bloque = 29; Casilla = "742"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta : Por regimen de atribucion de rentas
   Bloque = 29; Casilla = "743"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta : Imput.transparencia fiscal, agrupaciones, utes.: Retenc.e ingresos a cuenta
   Bloque = 29; Casilla = "744"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta : Imput.transparencia fiscal, agrupaciones, utes.: Exceso pagos
   Bloque = 29; Casilla = "745"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta : Imputaciones cesion derechos imagen : Ingresos a cuenta
   Bloque = 29; Casilla = "746"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta : Ganancias patrimoniales : Suma
   Bloque = 29; Casilla = "747"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta : Bonificaciones programa PREVER. Importe deducible
   Bloque = 29; Casilla = "748"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta : Cuotas no residentes
   Bloque = 29; Casilla = "749"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta : Total pagos a cuenta
   Bloque = 29; Casilla = "750"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Resultado de la declaracion : Cuota diferencial
   Bloque = 30; Casilla = "755"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Resultado de la declaracion : Deduccion por maternidad : Importe
   Bloque = 30; Casilla = "756"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Resultado de la declaracion : Deduccion por maternidad : Abono anticipado
   Bloque = 30; Casilla = "757"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Resultado de la declaracion : Intereses demora art.59.5
   Bloque = 30; Casilla = "758"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Resultado de la declaracion : Devoluciones modelo 104 en 2005
   Bloque = 30; Casilla = "759"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Resultado de la declaracion
   Bloque = 30; Casilla = "760"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa; nTotal1 = Casilla;
   || (M) Regularizacion complementaria : Resultado a ingresar de la anterior autoliquidacion
   Bloque = 31; Casilla = "761"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Regularizacion complementaria : Devolucion anterior liquidacion
   Bloque = 31; Casilla = "762"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Regularizacion complementaria : Resultado complementaria
   Bloque = 31; Casilla = "765"; |HAZ BuscaCasilla;
   aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   Bloque = 30; Casilla = "760"; |HAZ BuscaCasilla; nCalc1 = Casilla;
   |SI nCalc1 > 0; Bloque = 33; |SINO; Bloque = 36; |FINSI;

   Casilla = "a  "; |HAZ BuscaCasilla; nCalc1 = Casilla;
   Casilla = "b  "; |HAZ BuscaCasilla; nCalc2 = Casilla;
   nCalc = nCalc1 - nCalc2; nCalc1 = 0;
   |SI nCalc > 0;
      || Solucitud de suspension ingreso conyuge/Renuncia cobro devolucion otro conyuge : Ingreso/Suspension : Importe a suspender
      TipoDato = "N"; Long = 11; LongDec = 2;
      Bloque = 34; Casilla = "768"; |HAZ BuscaCasilla;
      aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      |SI nCalc1 = 0; nCalc1 = Casilla; |FINSI;
      || Solucitud de suspension ingreso conyuge/Renuncia cobro devolucion otro conyuge : Ingreso/Suspension : Resto a ingresar
      Bloque = 34; Casilla = "770"; |HAZ BuscaCasilla;
      aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      |SI nCalc1 = 0; nCalc1 = Casilla; |FINSI;
      || Solucitud de suspension ingreso conyuge/Renuncia cobro devolucion otro conyuge : Devolucion/Renuncia : Importe al que se renuncia
      Bloque = 37; Casilla = "769"; |HAZ BuscaCasilla;
      aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      |SI nCalc1 = 0; nCalc1 = Casilla; |FINSI;
      || Solucitud de suspension ingreso conyuge/Renuncia cobro devolucion otro conyuge : Devolucion/Renuncia : Resto a devolver
      Bloque = 37; Casilla = "770"; |HAZ BuscaCasilla;
      aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      |SI nCalc1 = 0; nCalc1 = Casilla; |FINSI;
   |SINO;
      || Solucitud de suspension ingreso conyuge/Renuncia cobro devolucion otro conyuge : Ingreso/Suspension : Importe a suspender
      TipoDato = "N"; Long = 11; LongDec = 2;
      Bloque = 35; Casilla = "768"; |HAZ BuscaCasilla;
      aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      |SI nCalc1 = 0; nCalc1 = Casilla; |FINSI;
      || Solucitud de suspension ingreso conyuge/Renuncia cobro devolucion otro conyuge : Ingreso/Suspension : Resto a ingresar
      Bloque = 35; Casilla = "770"; |HAZ BuscaCasilla;
      aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      |SI nCalc1 = 0; nCalc1 = Casilla; |FINSI;
      || Solucitud de suspension ingreso conyuge/Renuncia cobro devolucion otro conyuge : Devolucion/Renuncia : Importe al que se renuncia
      Bloque = 38; Casilla = "769"; |HAZ BuscaCasilla;
      aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      |SI nCalc1 = 0; nCalc1 = Casilla; |FINSI;
      || Solucitud de suspension ingreso conyuge/Renuncia cobro devolucion otro conyuge : Devolucion/Renuncia : Resto a devolver
      Bloque = 38; Casilla = "770"; |HAZ BuscaCasilla;
      aAlfa = Casilla;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      |SI nCalc1 = 0; nCalc1 = Casilla; |FINSI;
   |FINSI;

   |SI nCalc1 ! 0;
      Cadena = Cadena + aCuenta1;
   |SINO;
      Cadena = Cadena + ("0" * 20);
   |FINSI;
   Cadena = Cadena + "</T10012>" + &13 + &10; |HAZ GrabaCad;

   |CIERRA #rem01018; |CIERRA #rem01041;
|FPRC;

|PROCESO Hoja13;
   nSwDatos = 13; nCalc1 = 0;
   |HAZ MiraSiDatos;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "<T10013> ";

   |ABRE #rem01041;

   #rem01041#0 = VEmpresa;
   #rem01041#1 = 0;
   #rem01041#2 = aTipo;
   |LEE 000#rem01041.=;
   |SI FSalida ! 0; |DDEFECTO #rem01041; |FINSI;

   TipoDato = "N"; Long = 11; LongDec = 2;
   || Deducciones : Por inversion en cultura/donativos : Importe derecho deducc. ; Donativos (15% base liquidable)
   aAlfa = #rem01041#91;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en cultura/donativos : Importe deducible ; Donativos (15% base liquidable)
   aAlfa = #rem01041#92;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en cultura/donativos : Importes invertidos : Inversiones y gastos a la proteccion y difusion del Patrimonio Historico Espa¤ol
   aAlfa = #rem01041#3;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en cultura/donativos : Importe derecho deducc. : Inversiones y gastos a la proteccion y difusion del Patrimonio Historico Espa¤ol
   aAlfa = #rem01041#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en cultura/donativos : Importe deduccible : Inversiones y gastos a la proteccion y difusion del Patrimonio Historico Espa¤ol
   aAlfa = #rem01041#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en cultura/donativos : Importes donados : Donativos (10 % base liquidable)
   aAlfa = #rem01041#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en cultura/donativos : Importes derecho deducc.: Donativos (10 % base liquidable)
   aAlfa = #rem01041#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en cultura/donativos : Importes deducible : Donativos (10 % base liquidable)
   aAlfa = #rem01041#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en cultura/donativos : Suma
   aAlfa = #rem01041#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en cultura/donativos : Limite 10 %
   aAlfa = #rem01041#11; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en cultura/donativos : Deduccion por gastos en bienes de interes cultural - Parte estatal
   aAlfa = #rem01041#54; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en cultura/donativos : Deduccion por gastos en bienes de interes cultural - Parte autonomica
   aAlfa = #rem01041#55; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en cultura/donativos : Deduccion por donativos - Parte estatal
   aAlfa = #rem01041#56; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en cultura/donativos : Deduccion por donativos - Parte autonomica
   aAlfa = #rem01041#57; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Adquis.o rehabilitacion : Financiacion ajena 2 a¤os siguientes. Importe : Parte estatal
   aAlfa = #rem01041#38; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Adquis.o rehabilitacion : Financiacion ajena 2 a¤os siguientes. Importe : Parte autonomica
   aAlfa = #rem01041#58; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Adquis.o rehabilitacion : Financiacion ajena despues de 2 a¤os. Importe : Parte estatal
   aAlfa = #rem01041#40; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Deducciones : Por inversion en vivienda habitual : Adquis.o rehabilitacion : Financiacion ajena despues de 2 a¤os. Importe : Parte autonomica
   aAlfa = #rem01041#59; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Adquis.o rehabilitacion : Financiacion ajena. Importe total: Parte estatal
   aAlfa = #rem01041#12; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Adquis.o rehabilitacion : Financiacion ajena. Importe total: Parte autonomica
   aAlfa = #rem01041#60; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Adquis.o rehabilitacion : Sin financiacion ajena. Importe total: Parte estatal
   aAlfa = #rem01041#13; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Adquis.o rehabilitacion : Sin financiacion ajena. Importe total: Parte autonomica
   aAlfa = #rem01041#61; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Deducciones : Por inversion en vivienda habitual : Adquis.o rehabilitacion : Datos adicionales : Fecha adquisicion
   TipoDato = "F";
   |SI #rem01041#12 = 0; |Y #rem01041#60 = 0; |Y #rem01041#13 = 0; |Y #rem01041#61 = 0;
    |Y #rem01041#14 = 0; |Y #rem01041#64 = 0; |Y #rem01041#15 = 0; |Y #rem01041#65 = 0;
       aAlfa = "00.00.0000";
   |SINO;
      aAlfa = #rem01041#62;
   |FINSI;
   |HAZ Formateo;
   |SI aAlfa = "        "; aAlfa = "0" * 8; |FINSI; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Adquis.o rehabilitacion : Datos adicionales : Numero prestamo hipotecario
   TipoDato = "A"; Long = 20; LongDec = 0;
   aAlfa = #rem01041#63; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Construccion o ampliacion : Importe de la deduccion : Parte estatal
   TipoDato = "N"; Long = 11; LongDec = 2;
   aAlfa = #rem01041#14; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Construccion o ampliacion : Importe de la deduccion : Parte autonomica
   aAlfa = #rem01041#64; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Construccion o ampliacion : Importe pagos al promotor o constructor
   aAlfa = #rem01041#93; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Construccion o ampliacion : Nif del promotor o constructor
   TipoDato = "A"; Long = 9; LongDec = 0;
   aAlfa = #rem01041#94; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Cantidades depositadas en cuentas vivienda : Importe de la deduccion : Parte estatal
   TipoDato = "N"; Long = 11; LongDec = 2;
   aAlfa = #rem01041#15; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Cantidades depositadas en cuentas vivienda : Importe de la deduccion : Parte autonomica
   aAlfa = #rem01041#65; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Identificacion cuentas vivienda : Cuenta 1 : Titular de la cuenta
   aAlfa = #rem01041#20;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   |HAZ GrabaCad;

   || Deducciones : Por inversion en vivienda habitual : Identificacion cuentas vivienda : Cuenta 1 : Fecha de apertura
   TipoDato = "F";
   aAlfa = #rem01041#21; |HAZ Formateo;
   |SI aAlfa = "        "; aAlfa = "0" * 8; |FINSI;
   Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Identificacion cuentas vivienda : Cuenta 1 : Entidad
   TipoDato = "N"; Long = 4; LongDec = 0;
   aAlfa = #rem01041#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Identificacion cuentas vivienda : Cuenta 1 : Sucursal
   aAlfa = #rem01041#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Identificacion cuentas vivienda : Cuenta 1 : Digito control
   TipoDato = "N"; Long = 2;
   aAlfa = #rem01041#18; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Identificacion cuentas vivienda : Cuenta 1 : Numero cuenta
   TipoDato = "N"; Long = 10;
   aAlfa = #rem01041#19; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Identificacion cuentas vivienda : Cuenta 2 : Titular de la cuenta
   aAlfa = #rem01041#26;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Deducciones : Por inversion en vivienda habitual : Identificacion cuentas vivienda : Cuenta 2 : Fecha de apertura
   TipoDato = "F";
   aAlfa = #rem01041#27; |HAZ Formateo;
   |SI aAlfa = "        "; aAlfa = "0" * 8; |FINSI;
   Cadena = Cadena + aAlfa; |HAZ GrabaCad;

   || Deducciones : Por inversion en vivienda habitual : Identificacion cuentas vivienda : Cuenta 2 : Entidad
   TipoDato = "N"; Long = 4; LongDec = 0;
   aAlfa = #rem01041#22; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Identificacion cuentas vivienda : Cuenta 2 : Sucursal
   aAlfa = #rem01041#23; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Identificacion cuentas vivienda : Cuenta 2 : Digito control
   TipoDato = "N"; Long = 2;
   aAlfa = #rem01041#24; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Identificacion cuentas vivienda : Cuenta 2 : Numero cuenta
   TipoDato = "N"; Long = 10;
   aAlfa = #rem01041#25; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   TipoDato = "N"; Long = 11; LongDec = 2;
   || Deducciones : Por inversion en vivienda habitual : Adecuacion vivienda minusvalido : Financiacion ajena 2 a¤os siguientes : Importe : Parte estatal
   aAlfa = #rem01041#45; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Adecuacion vivienda minusvalido : Financiacion ajena 2 a¤os siguientes : Importe : Parte autonomica
   aAlfa = #rem01041#66; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Adecuacion vivienda minusvalido : Financiacion ajena despues de 2 a¤os : Importe : Parte estatal
   aAlfa = #rem01041#47; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Adecuacion vivienda minusvalido : Financiacion ajena despues de 2 a¤os : Importe : Parte autonomica
   aAlfa = #rem01041#67; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Adecuacion vivienda minusvalido : Financiacion ajena : Importe total : Parte estatal
   aAlfa = #rem01041#28; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Adecuacion vivienda minusvalido : Financiacion ajena : Importe total : Parte autonomica
   aAlfa = #rem01041#68; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Adecuacion vivienda minusvalido : Sin financiacion ajena : Importe deduccion : Parte estatal
   aAlfa = #rem01041#29; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Por inversion en vivienda habitual : Adecuacion vivienda minusvalido : Sin financiacion ajena : Importe deduccion : Parte autonomica
   aAlfa = #rem01041#69; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Rentas obtenidas en Ceuta y Melilla : Importe total deduccion
   aAlfa = #rem01041#70; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Rentas obtenidas en Ceuta y Melilla : Importe deduccion : Parte estatal
   aAlfa = #rem01041#71; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Rentas obtenidas en Ceuta y Melilla : Importe deduccion : Parte autonomica
   aAlfa = #rem01041#72; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Deducciones : Depositos cuenta-ahorro empresas : Importe total deduccion
   aAlfa = #rem01041#74; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Depositos cuenta-ahorro empresas : Importe deduccion : Parte estatal
   aAlfa = #rem01041#75; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Depositos cuenta-ahorro empresas : Importe deduccion : Parte autonomica
   aAlfa = #rem01041#76; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Depositos cuenta-ahorro empresas : Identificacion : 1¦ cuenta : Titular de la cuenta
   aAlfa = #rem01041#77;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Deducciones : Depositos cuenta-ahorro empresas : Identificacion : 1¦ cuenta : Fecha apertura
   TipoDato = "F"; aAlfa = #rem01041#78; |HAZ Formateo;
   |SI aAlfa = "        "; aAlfa = "0" * 8; |FINSI;
   Cadena = Cadena + aAlfa;
   || Deducciones : Depositos cuenta-ahorro empresas : Identificacion : 1¦ cuenta : Entidad
   TipoDato = "N"; Long = 4; LongDec = 0;
   aAlfa = #rem01041#79; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Depositos cuenta-ahorro empresas : Identificacion : 1¦ cuenta : Sucursal
   aAlfa = #rem01041#80; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Depositos cuenta-ahorro empresas : Identificacion : 1¦ cuenta : DC
   Long = 2;
   aAlfa = #rem01041#81; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Depositos cuenta-ahorro empresas : Identificacion : 1¦ cuenta : Numero de cuenta
   Long = 10;
   aAlfa = #rem01041#82; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Depositos cuenta-ahorro empresas : Identificacion : 2¦ cuenta : Titular de la cuenta
   aAlfa = #rem01041#83;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Deducciones : Depositos cuenta-ahorro empresas : Identificacion : 2¦ cuenta : Fecha apertura
   TipoDato = "F"; aAlfa = #rem01041#84; |HAZ Formateo;
   |SI aAlfa = "        "; aAlfa = "0" * 8; |FINSI;
   Cadena = Cadena + aAlfa;
   || Deducciones : Depositos cuenta-ahorro empresas : Identificacion : 2¦ cuenta : Entidad
   TipoDato = "N"; Long = 4; LongDec = 0;
   aAlfa = #rem01041#85; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Depositos cuenta-ahorro empresas : Identificacion : 2¦ cuenta : Sucursal
   aAlfa = #rem01041#86; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Depositos cuenta-ahorro empresas : Identificacion : 2¦ cuenta : DC
   Long = 2;
   aAlfa = #rem01041#87; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones : Depositos cuenta-ahorro empresas : Identificacion : 2¦ cuenta : Numero de cuenta
   Long = 10;
   aAlfa = #rem01041#88; |HAZ Formateo; Cadena = Cadena + aAlfa;

   Cadena = Cadena + "</T10013>" + &13 + &10; |HAZ GrabaCad;
|FPRC;

|PROCESO Hoja14;
   nSwDatos = 14; nCalc1 = 0;
   |HAZ MiraSiDatos;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "<T10014> ";

   |ABRE #rem01043;

   #rem01043#0 = VEmpresa;
   #rem01043#1 = 0;
   #rem01043#2 = aTipo;
   |LEE 000#rem01043.=;
   |SI FSalida ! 0; |DDEFECTO #rem01043; |FINSI;

   TipoDato = "N"; Long = 11; LongDec = 2;
   || Deducciones Autonomicas Cuota: Cmdad. Andalucia : Por ayudas familiares
   aAlfa = #rem01043#3;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Andalucia : Viviendas protegidas
   aAlfa = #rem01043#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Andalucia : Vivienda habitual jovenes
   aAlfa = #rem01043#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Andalucia : Alquiler vivienda jovenes: NIF Arrendador
   TipoDato = "An"; Long = 9; LongDec = 0;
   |SI #rem01043#6 ! 0; aAlfa = #rem01043#118; |SINO; aAlfa = ""; |FINSI;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Andalucia : Alquiler vivienda jovenes: Importe
   TipoDato = "N"; Long = 11; LongDec = 2;
   aAlfa = #rem01043#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Andalucia : Autoempleo jovenes
   aAlfa = #rem01043#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Andalucia : Autoempleo mujeres
   aAlfa = #rem01043#8;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Andalucia : Por adopcion internacional de ni¤os
   aAlfa = #rem01043#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Andalucia : Para contribuyentes con discapacidad
   aAlfa = #rem01043#10;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Andalucia : Suma deducciones
   aAlfa = #rem01043#11; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Deducciones Autonomicas Cuota: Cmdad. Aragon : Por nacimiento o adopcion 3er.o sucesivos hijos
   aAlfa = #rem01043#12; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Aragon : Por adopcion internacional de ni¤os
   aAlfa = #rem01043#13; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Aragon : Suma deducciones
   aAlfa = #rem01043#14; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Deducciones Autonomicas Cuota: Cmdad. Asturias: Acogimiento no remunerado de > 65 a¤os
   aAlfa = #rem01043#15; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Asturias: Adquis./Rehab.Vivienda habitual discapacitados
   aAlfa = #rem01043#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Asturias: Adquis./Rehab.Vivienda habitual con conyuge, ascendientes o descendientes minusvalidos
   aAlfa = #rem01043#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Asturias: Inversion en vivienda habitual protegida
   aAlfa = #rem01043#18; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Asturias: Alquiler vivienda habitual : NIF arrendador
   TipoDato = "An"; Long = 9; LongDec = 0;
   |SI #rem01043#19 ! 0; aAlfa = #rem01043#118; |SINO; aAlfa = ""; |FINSI;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   TipoDato = "N"; Long = 11; LongDec = 2;
   || Deducciones Autonomicas Cuota: Cmdad. Asturias: Alquiler vivienda habitual : Importe
   aAlfa = #rem01043#19; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Asturias: Para fomento autoempleo mujeres y jovenes emprendedores
   aAlfa = #rem01043#20; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Asturias: Para fomento autoempleo
   aAlfa = #rem01043#21; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Asturias: Donacion de fincas rusticas al principado de Asturias
   aAlfa = #rem01043#22; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Asturias: Suma deducciones
   aAlfa = #rem01043#23; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Deducciones Autonomicas Cuota: Cmdad. Baleares: Gastos adquisicion de libros
   aAlfa = #rem01043#24; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Baleares: Contribuyentes edad >= 65 a¤os
   aAlfa = #rem01043#25; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Baleares: Adquisicion o rehabilitacion de la vivienda habitual por jovenes
   aAlfa = #rem01043#26; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Baleares: Arrendamiento de la vivienda habitual jovenes : NIF arrendador
   TipoDato = "An"; Long = 9; LongDec = 0;
   |SI #rem01043#27 ! 0; aAlfa = #rem01043#118; |SINO; aAlfa = ""; |FINSI;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   TipoDato = "N"; Long = 11; LongDec = 2;
   || Deducciones Autonomicas Cuota: Cmdad. Baleares: Arrendamiento de la vivienda habitual jovenes : Importe
   aAlfa = #rem01043#27; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Baleares: Discapacitados > 33%
   aAlfa = #rem01043#28; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Baleares: Gastos conservacion y mejora de determinadas fincas o terrenos
   aAlfa = #rem01043#29; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Baleares: Suma deducciones autonomicas
   aAlfa = #rem01043#30; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Deducciones Autonomicas Cuota: Cmdad. Canarias : Por donaciones con finalidad ecologica
   aAlfa = #rem01043#31; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Canarias : Por donaciones al patrimonio historico de Canarias
   aAlfa = #rem01043#32; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Canarias : Por determinados gastos en inmuebles de interes cultural
   aAlfa = #rem01043#33; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Canarias : Por gastos de estudios en descendientes
   aAlfa = #rem01043#34; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Canarias : Por traslado de residencia a otra isla para realizar una actividad
   aAlfa = #rem01043#35; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Canarias : Por donacion a descendientes para su primera vivienda habitual
   aAlfa = #rem01043#36; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Canarias : Por nacimiento o adopcion de hijos
   aAlfa = #rem01043#37; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Canarias : Por contribuyentes minusvalidos y mayores de 65 a¤os
   aAlfa = #rem01043#38; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Canarias : Por gastos de guarderia
   aAlfa = #rem01043#39; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Canarias : Suma de deducciones
   aAlfa = #rem01043#40; |HAZ Formateo; Cadena = Cadena + aAlfa;
   Cadena = Cadena + "</T10014>" + &13 + &10; |HAZ GrabaCad;

   |CIERRA #rem01043;
|FPRC;

|PROCESO Hoja15;
   nSwDatos = 15; nCalc1 = 0;
   |HAZ MiraSiDatos;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "<T10015> ";

   |ABRE #rem01043;

   #rem01043#0 = VEmpresa;
   #rem01043#1 = 0;
   #rem01043#2 = aTipo;
   |LEE 000#rem01043.=;
   |SI FSalida ! 0; |DDEFECTO #rem01043; |FINSI;

   || Deducciones Autonomicas Cuota: Cmdad. Cantabria : Por arrendamiento de la vivienda habitual : NIF arrendador
   TipoDato = "An"; Long = 9; LongDec = 0;
   |SI #rem01043#41 ! 0; aAlfa = #rem01043#118; |SINO; aAlfa = ""; |FINSI;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   TipoDato = "N"; Long = 11; LongDec = 2;
   || Deducciones Autonomicas Cuota: Cmdad. Cantabria : Por arrendamiento de la vivienda habitual : Importe
   aAlfa = #rem01043#41; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Cantabria : Por cuidado familiares
   aAlfa = #rem01043#42; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Cantabria : Por adquisicion 2¦ vivienda en municipios con despoblacion
   aAlfa = #rem01043#43; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Cantabria : Total deducciones economicas
   aAlfa = #rem01043#44; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Deducciones Autonomicas Cuota: Cmdad. Castilla La Mancha : Por nacimiento o adopcion de hijos
   aAlfa = #rem01043#45; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Castilla La Mancha : Por discapacidad del contribuyente
   aAlfa = #rem01043#46; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Castilla La Mancha : Por discapacidad de ascendientes o descendientes
   aAlfa = #rem01043#47; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Castilla La Mancha : Por aportaciones al fondo Castellano-Manchego cooperacion
   aAlfa = #rem01043#48; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Castilla La Mancha : Total deducciones autonomicas
   aAlfa = #rem01043#49; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Deducciones Autonomicas Cuota: Cmdad. Castilla y Leon: Por familia numerosa
   aAlfa = #rem01043#50; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Castilla y Leon: Por nacimiento o adopcion de hijos
   aAlfa = #rem01043#51; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Castilla y Leon: Por adopcion internacional
   aAlfa = #rem01043#52; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Castilla y Leon: Por cuidado hijos menores
   aAlfa = #rem01043#53; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Castilla y Leon: Por discapacitados de 65 o mas a¤os con ayuda de terceros
   aAlfa = #rem01043#54; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Castilla y Leon: Por adquisicion de viviendas por jovenes en nucleos rurales
   aAlfa = #rem01043#55; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Castilla y Leon: Por donativos a fundaciones y Patrimonio Cultural y natural
   aAlfa = #rem01043#56; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Castilla y Leon: Por inversiones en bienes del Patrimonio Cultural y natural
   aAlfa = #rem01043#57; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Castilla y Leon: Suma deducciones autonomicas
   aAlfa = #rem01043#58; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Deducciones Autonomicas Cuota: Cmdad. Catalu¤a: Por nacimiento o adopcion de hijos
   aAlfa = #rem01043#59; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Catalu¤a: Por donativos para el fomento de la lengua catalana
   aAlfa = #rem01043#60; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Catalu¤a: Por alquiler de la vivienda habitual : Nif Arrendador
   TipoDato = "An"; Long = 9; LongDec = 0;
   |SI #rem01043#61 ! 0; aAlfa = #rem01043#118; |SINO; aAlfa = ""; |FINSI;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Catalu¤a: Por alquiler de la vivienda habitual : Importe
   TipoDato = "N"; Long = 11; LongDec = 2;
   aAlfa = #rem01043#61; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Catalu¤a: Por intereses prestamos estudios universitarios tercer ciclo
   aAlfa = #rem01043#62; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Catalu¤a: Por donacion a descendientes para adquisicion primera vivienda
   aAlfa = #rem01043#63; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Catalu¤a: Para contribuyentes que se queden viudos o viudas
   aAlfa = #rem01043#64; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Catalu¤a: Suma deducciones autonomicas
   aAlfa = #rem01043#65; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Deducciones Autonomicas Cuota: Cmdad. Extreme¤a : Adqu.o rehab.de la vivienda habitual por jovenes y victimas del terrorismo
   aAlfa = #rem01043#66; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Extreme¤a : Por trabajo dependiente
   aAlfa = #rem01043#67; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Extreme¤a : Por donaciones bienes Patrim.Historico Cultural
   aAlfa = #rem01043#68; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Extreme¤a : Por gastos en bienes Patrim.Historico Cultural
   aAlfa = #rem01043#69; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Extreme¤a : Por alquiler de vivienda habitual para jovenes, fam.num y minus. : NIF arrendador
   TipoDato = "An"; Long = 9; LongDec = 0;
   |SI #rem01043#70 ! 0; aAlfa = #rem01043#118; |SINO; aAlfa = ""; |FINSI;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   TipoDato = "N"; Long = 11; LongDec = 2;
   || Deducciones Autonomicas Cuota: Cmdad. Extreme¤a : Por alquiler de vivienda habitual para jovenes, fam.num y minus. : Importe
   aAlfa = #rem01043#70; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Extreme¤a : Por cuidado de familiares discapacitados
   aAlfa = #rem01043#71; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Extreme¤a : Por acogimiento de menores
   aAlfa = #rem01043#72; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Extreme¤a : Suma deducciones autonomicas
   aAlfa = #rem01043#73; |HAZ Formateo; Cadena = Cadena + aAlfa;
   Cadena = Cadena + "</T10015>" + &13 + &10; |HAZ GrabaCad;

   |CIERRA #rem01043;
|FPRC;

|PROCESO Hoja16;
   nSwDatos = 16; nCalc1 = 0;
   |HAZ MiraSiDatos;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "<T10016> ";

   |ABRE #rem01043;

   #rem01043#0 = VEmpresa;
   #rem01043#1 = 0;
   #rem01043#2 = aTipo;
   |LEE 000#rem01043.=;
   |SI FSalida ! 0; |DDEFECTO #rem01043; |FINSI;

   || Deducciones Autonomicas Cuota: Cmdad. Galicia: Por nacimiento o adopcion de hijos
   TipoDato = "N"; Long = 11; LongDec = 2;
   aAlfa = #rem01043#74; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Galicia: Por familia numerosa
   aAlfa = #rem01043#75; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Galicia: Por cuidado de hijos menores
   aAlfa = #rem01043#76; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Galicia: Por contribuyentes minusvalidos >= 65 a¤os que precisan ayuda
   aAlfa = #rem01043#77; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Galicia: Por gastos de nuevas tecnologias en hogares gallegos
   aAlfa = #rem01043#78; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Galicia: Por alquiler vivienda habitual por jovenes : NIF arrendador
   TipoDato = "An"; Long = 9; LongDec = 0;
   |SI #rem01043#79 ! 0; aAlfa = #rem01043#118; |SINO; aAlfa = ""; |FINSI;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   TipoDato = "N"; Long = 11; LongDec = 2;
   || Deducciones Autonomicas Cuota: Cmdad. Galicia: Por alquiler vivienda habitual por jovenes : Importe
   aAlfa = #rem01043#79; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Galicia: Suma deducciones autonomicas
   aAlfa = #rem01043#80; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Deducciones Autonomicas Cuota: Cmdad. Madrid: Por nacimiento o adopcion de hijos
   aAlfa = #rem01043#81; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Madrid: Por adopcion internacional de ni¤os
   aAlfa = #rem01043#82; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Madrid: Por acogimiento familiar de menores
   aAlfa = #rem01043#83; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Madrid: Por acogimiento no remunerado de mayores de 65 a¤os y/o minusvalidos
   aAlfa = #rem01043#84; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Madrid: Por alquiler vivienda habitual por jovenes : NIF arrendador
   TipoDato = "An"; Long = 9; LongDec = 0;
   |SI #rem01043#85 ! 0; aAlfa = #rem01043#118; |SINO; aAlfa = ""; |FINSI;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   TipoDato = "N"; Long = 11; LongDec = 2;
   || Deducciones Autonomicas Cuota: Cmdad. Madrid: Por alquiler vivienda habitual por jovenes : Importe
   aAlfa = #rem01043#85; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Madrid: Por donativos a determinadas fundaciones
   aAlfa = #rem01043#86; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Madrid: Para compensar la carga tributaria de determinadas ayudas
   aAlfa = #rem01043#87; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Madrid: Suma deducciones autonomicas
   aAlfa = #rem01043#88; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Deducciones Autonomicas Cuota: Cmdad. Murcia: Por adqu./rehab. vivienda habitual jovenes
   aAlfa = #rem01043#89; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Murcia: Por donativos proteccion patrimonio historico
   aAlfa = #rem01043#90; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Murcia: Por gastos de guarderia ni¤os menores 3 a¤os
   aAlfa = #rem01043#91; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Murcia: Por inversion en instalacion de recursos energeticos renovables
   aAlfa = #rem01043#92; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Murcia: Suma deducciones autonomicas
   aAlfa = #rem01043#93; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Deducciones Autonomicas Cuota: Cmdad. La Rioja: Por nacimiento o adopcion 2§ o ulterior hijo
   aAlfa = #rem01043#94; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. La Rioja: Por adqu./rehab.vivienda habitual por jovenes
   aAlfa = #rem01043#95; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. La Rioja: Por adqu./rehab.2¦ vivienda medio rural
   aAlfa = #rem01043#96; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. La Rioja: Por inversion no empresarial en adquisicion de ordenadores personales
   aAlfa = #rem01043#97; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. La Rioja: Suma deducciones autonomicas
   aAlfa = #rem01043#98; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Por nacimiento/adopcion hijos
   aAlfa = #rem01043#99;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Por nacimiento/adopcion multiples
   aAlfa = #rem01043#100;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Por nacimiento/adopcion hijos discapacitados
   aAlfa = #rem01043#101;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Por familia numerosa
   aAlfa = #rem01043#102;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Contribuyentes munisvalidos >= 65 a¤os
   aAlfa = #rem01043#103;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Por realizacion de labores del hogar no remuneradas
   aAlfa = #rem01043#104;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Adqu.1¦ vivienda habit. por jovenes
   aAlfa = #rem01043#105;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Adqu.vivienda habit.por discapacitados
   aAlfa = #rem01043#106;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Destinar ayudas public.a la vivienda habit.
   aAlfa = #rem01043#107;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Arrendamiento de la vivienda habit. : NIF arrendador
   TipoDato = "An"; Long = 9; LongDec = 0;
   |SI #rem01043#108 ! 0; aAlfa = #rem01043#118; |SINO; aAlfa = ""; |FINSI;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   TipoDato = "N"; Long = 11; LongDec = 2;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Arrendamiento de la vivienda habit. : Importe
   aAlfa = #rem01043#108;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Arrendamiento vivienda por realizacion de una actividad : NIF arrendador
   TipoDato = "An"; Long = 9; LongDec = 0;
   |SI #rem01043#109 ! 0; aAlfa = #rem01043#119; |SINO; aAlfa = ""; |FINSI;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   TipoDato = "N"; Long = 11; LongDec = 2;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Arrendamiento vivienda por realizacion de una actividad : Importe
   aAlfa = #rem01043#109;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Inversiones en fuentes de energia renovables
   aAlfa = #rem01043#110;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Donaciones con finalidad ecologica
   aAlfa = #rem01043#111;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Por donacion bienes del Patrimonio cultural
   aAlfa = #rem01043#112;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Por donativos destinados al Patrimonio cultural
   aAlfa = #rem01043#113;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Por gastos de titulares en bienes del Patrimonio cultural
   aAlfa = #rem01043#114;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Por donaciones al fomento de la lengua valenciana
   aAlfa = #rem01043#115;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Por custodia en guarderias y primer ciclo educacion infantil
   aAlfa = #rem01043#116;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Suma deducciones autonomicas
   aAlfa = #rem01043#117; |HAZ Formateo; Cadena = Cadena + aAlfa;
   Cadena = Cadena + "</T10016>" + &13 + &10; |HAZ GrabaCad;

   |CIERRA #rem01043;
|FPRC;

|PROCESO Hoja17;

   nSwDatos = 17; nCalc1 = 0;
   |HAZ MiraSiDatos;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "<T10017> ";

   |ABRE #rem01042;

   #rem01042#0 = VEmpresa;
   #rem01042#1 = 0;
   #rem01042#2 = aTipo;
   |LEE 000#rem01042.=;
   |SI FSalida ! 0; |DDEFECTO #rem01042; |FINSI;

   TipoDato = "N"; Long = 11; LongDec = 2;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Saldos pdtes.ejerc.ant.Saldo anterior         R.Gral.Ley 43/1995
   aAlfa = #rem01042#3;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Saldos pdtes.ejerc.ant.Aplicado en esta decl. R.Gral.Ley 43/1995
   aAlfa = #rem01042#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Saldos pdtes.ejerc.ant.Pendiente aplicacion   R.Gral.Ley 43/1995
   aAlfa = #rem01042#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Saldos pdtes.ejerc.ant.Saldo anterior         R.Esp. interes publico
   aAlfa = #rem01042#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Saldos pdtes.ejerc.ant.Aplicado en esta decl. R.Esp. interes publico
   aAlfa = #rem01042#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Saldos pdtes.ejerc.ant.Pendiente aplicacion   R.Esp. interes publico
   aAlfa = #rem01042#8; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Deduccion 2004         R.Gral. Gastos act.innov.tecnologica
   aAlfa = #rem01042#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Aplicado en esta decl. R.Gral. Gastos act.innov.tecnologica
   aAlfa = #rem01042#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Pendiente aplicacion   R.Gral. Gastos act.innov.tecnologica
   aAlfa = #rem01042#11; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Deduccion 2004         R.Gral. Fomento.Tecn.infor.y comunic.
   aAlfa = #rem01042#12; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Aplicado en esta decl. R.Gral. Fomento.Tecn.infor.y comunic.
   aAlfa = #rem01042#13; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Pendiente aplicacion   R.Gral. Fomento.Tecn.infor.y comunic.
   aAlfa = #rem01042#14; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Deduccion 2004         R.Gral. Actividades exportacion
   aAlfa = #rem01042#15; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Aplicado en esta decl. R.Gral. Actividades exportacion
   aAlfa = #rem01042#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Pendiente aplicacion   R.Gral. Actividades exportacion
   aAlfa = #rem01042#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Deduccion 2004         R.Gral. Inv.Articulo 38 L.I.S.
   aAlfa = #rem01042#18; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Aplicado en esta decl. R.Gral. Inv.Articulo 38 L.I.S.
   aAlfa = #rem01042#19; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Pendiente aplicacion   R.Gral. Inv.Articulo 38 L.I.S.
   aAlfa = #rem01042#20; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Deduccion 2004         R.Gral. Inv.Medioambientales
   aAlfa = #rem01042#21; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Aplicado en esta decl. R.Gral. Inv.Medioambientales
   aAlfa = #rem01042#22; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Pendiente aplicacion   R.Gral. Inv.Medioambientales
   aAlfa = #rem01042#23; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Deduccion 2004         R.Gral. Gtos.Formacion profesional
   aAlfa = #rem01042#24; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Aplicado en esta decl. R.Gral. Gtos.Formacion profesional
   aAlfa = #rem01042#25; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Pendiente aplicacion   R.Gral. Gtos.Formacion profesional
   aAlfa = #rem01042#26; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Deduccion 2004         R.Gral. Creacion empleo minusvalidos
   aAlfa = #rem01042#27; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Aplicado en esta decl. R.Gral. Creacion empleo minusvalidos
   aAlfa = #rem01042#28; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Pendiente aplicacion   R.Gral. Creacion empleo minusvalidos
   aAlfa = #rem01042#29; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Deduccion 2004         R.Gral. Contribuciones empresas Art.43 L.I.S.
   aAlfa = #rem01042#30; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Aplicado en esta decl. R.Gral. Contribuciones empresas Art.43 L.I.S.
   aAlfa = #rem01042#31; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Pendiente aplicacion   R.Gral. Contribuciones empresas Art.43 L.I.S.
   aAlfa = #rem01042#32; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Deduccion 2004         R.Esp.  Almeria 2005 Juegos del mediterraneo
   aAlfa = #rem01042#33; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Aplicado en esta decl. R.Esp.  Almeria 2005 Juegos del mediterraneo
   aAlfa = #rem01042#34; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Pendiente aplicacion   R.Esp.  Almeria 2005 Juegos del mediterraneo
   aAlfa = #rem01042#35; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Deduccion 2004         R.Esp.  IV Centenario del Quijote
   aAlfa = #rem01042#36; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Aplicado en esta decl. R.Esp.  IV Centenario del Quijote
   aAlfa = #rem01042#37; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Pendiente aplicacion   R.Esp.  IV Centenario del Quijote
   aAlfa = #rem01042#38; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Deduccion 2004         R.Esp.  Copa America 2007
   aAlfa = #rem01042#39; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Aplicado en esta decl. R.Esp.  Copa America 2007
   aAlfa = #rem01042#40; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Pendiente aplicacion   R.Esp.  Copa America 2007
   aAlfa = #rem01042#41; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Deduccion 2004         R.Esp.  Salamanca 2005 Plaza mayor de Europa
   aAlfa = #rem01042#42; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Aplicado en esta decl. R.Esp.  Salamanca 2005 Plaza mayor de Europa
   aAlfa = #rem01042#43; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Pendiente aplicacion   R.Esp.  Salamanca 2005 Plaza mayor de Europa
   aAlfa = #rem01042#44; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Deduccion 2004         R.Esp.  Galicia 2005. Vuelta al mundo en vela
   aAlfa = #rem01042#45; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Aplicado en esta decl. R.Esp.  Galicia 2005. Vuelta al mundo en vela
   aAlfa = #rem01042#46; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Pendiente aplicacion   R.Esp.  Galicia 2005. Vuelta al mundo en vela
   aAlfa = #rem01042#47; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Deduccion 2004         R.Esp.  Pekin 2008
   aAlfa = #rem01042#48; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Aplicado en esta decl. R.Esp.  Pekin 2008
   aAlfa = #rem01042#49; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2005 Pendiente aplicacion   R.Esp.  Pekin 2008
   aAlfa = #rem01042#50; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Saldo anterior         Inv.Adquisicion activos fijos
   aAlfa = #rem01042#51; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Aplicado en esta decl. Inv.Adquisicion activos fijos
   aAlfa = #rem01042#52; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Pendiente aplicacion   Inv.Adquisicion activos fijos
   aAlfa = #rem01042#53; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Saldo anterior         Restantes modalidades
   aAlfa = #rem01042#54; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Aplicado en esta decl. Restantes modalidades
   aAlfa = #rem01042#55; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Pendiente aplicacion   Restantes modalidades
   aAlfa = #rem01042#56; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Saldo anterior         Investigacion/innovacion tecnologica
   aAlfa = #rem01042#57; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Aplicado en esta decl. Investigacion/innovacion tecnologica
   aAlfa = #rem01042#58; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Pendiente aplicacion   Investigacion/innovacion tecnologica
   aAlfa = #rem01042#59; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Saldo anterior         Fomento tecnologias comunicacion
   aAlfa = #rem01042#60; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Aplicado en esta decl. Fomento tecnologias comunicacion
   aAlfa = #rem01042#61; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Pendiente aplicacion   Fomento tecnologias comunicacion
   aAlfa = #rem01042#62; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Saldo anterior         Actividades exportacion
   aAlfa = #rem01042#63; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Aplicado en esta decl. Actividades exportacion
   aAlfa = #rem01042#64; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Pendiente aplicacion   Actividades exportacion
   aAlfa = #rem01042#65; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Saldo anterior         Inversiones Art.38 L.I.S.
   aAlfa = #rem01042#66; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Aplicado en esta decl. Inversiones Art.38 L.I.S.
   aAlfa = #rem01042#67; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Pendiente aplicacion   Inversiones Art.38 L.I.S.
   aAlfa = #rem01042#68; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Saldo anterior         Inversiones medioambientales
   aAlfa = #rem01042#69; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Aplicado en esta decl. Inversiones medioambientales
   aAlfa = #rem01042#70; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Pendiente aplicacion   Inversiones medioambientales
   aAlfa = #rem01042#71; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Saldo anterior         Gastos en formacion profesional
   aAlfa = #rem01042#72; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Aplicado en esta decl. Gastos en formacion profesional
   aAlfa = #rem01042#73; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Pendiente aplicacion   Gastos en formacion profesional
   aAlfa = #rem01042#74; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Saldo anterior         Creacion empleo minusvalidos
   aAlfa = #rem01042#75; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Aplicado en esta decl. Creacion empleo minusvalidos
   aAlfa = #rem01042#76; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Pendiente aplicacion   Creacion empleo minusvalidos
   aAlfa = #rem01042#77; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Saldo anterior         Contribuciones empresas Art.43 L.I.S.
   aAlfa = #rem01042#78; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Aplicado en esta decl. Contribuciones empresas Art.43 L.I.S.
   aAlfa = #rem01042#79; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Pendiente aplicacion   Contribuciones empresas Art.43 L.I.S.
   aAlfa = #rem01042#80; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Saldo anterior         Inversion adquisicion activos fijos
   aAlfa = #rem01042#81; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Aplicado en esta decl. Inversion adquisicion activos fijos
   aAlfa = #rem01042#82; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2005.Pendiente aplicacion   Inversion adquisicion activos fijos
   aAlfa = #rem01042#83; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Incent.estim.inv.emp.R.Esp.Proy.Cartuja 93 Saldo anterior
   aAlfa = #rem01042#84;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Proy.Cartuja 93 Aplicado en esta decl.
   aAlfa = #rem01042#85;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Proy.Cartuja 93 Pendiente aplicacion
   aAlfa = #rem01042#86;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp. : Importe total de deducciones aplicado a esta declaracion : Deducciones por incentivos y estimulos a la inv.empresarial
   aAlfa = #rem01042#87;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp. : Deducciones : Parte estatal
   aAlfa = #rem01042#88;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp. : Deducciones : Parte autonomica
   aAlfa = #rem01042#89;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   TipoDato = "N"; Long = 11; LongDec = 2;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias 2001 Importe dotaciones
   aAlfa = #rem01042#90; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias 2001 Materializac.2005
   aAlfa = #rem01042#91; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias 2001 Clave
   TipoDato = "N"; Long = 1; LongDec = 0;
   aAlfa = #rem01042#92; |HAZ Formateo; Cadena = Cadena + aAlfa;
   TipoDato = "N"; Long = 11; LongDec = 2;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias 2002 Importe dotaciones
   aAlfa = #rem01042#93; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias 2002 Materializac.2005
   aAlfa = #rem01042#94; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias 2002 Clave
   TipoDato = "N"; Long = 1; LongDec = 0;
   aAlfa = #rem01042#95; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias 2003 Pdte.Materializar
   TipoDato = "N"; Long = 11; LongDec = 2;
   aAlfa = #rem01042#96; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias 2003 Importe dotaciones
   aAlfa = #rem01042#97; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias 2003 Materializac.2005
   aAlfa = #rem01042#98; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias 2003 Clave
   TipoDato = "N"; Long = 1; LongDec = 0;
   aAlfa = #rem01042#99; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias 2003 Pdte.Materializar
   TipoDato = "N"; Long = 11; LongDec = 2;
   aAlfa = #rem01042#100; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias 2004 Importe dotaciones
   aAlfa = #rem01042#101; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias 2004 Materializac.2005
   aAlfa = #rem01042#102; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias 2004 Clave
   TipoDato = "N"; Long = 1; LongDec = 0;
   aAlfa = #rem01042#103; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias 2004 Pdte.Materializar
   TipoDato = "N"; Long = 11; LongDec = 2;
   aAlfa = #rem01042#104; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias 2005 Importe dotaciones
   aAlfa = #rem01042#105; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias 2005 Materializac.2005
   aAlfa = #rem01042#106; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias 2005 Clave
   TipoDato = "N"; Long = 1; LongDec = 0;
   aAlfa = #rem01042#107; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias 2005 Pdte.Materializar
   TipoDato = "N"; Long = 11; LongDec = 2;
   aAlfa = #rem01042#108; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias Inv.Anticipadas Futuras materializaciones Materializac.2005
   aAlfa = #rem01042#109; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias Inv.Anticipadas Futuras materializaciones Clave
   TipoDato = "N"; Long = 1; LongDec = 0;
   aAlfa = #rem01042#110; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias: Importe de la deduccion
   TipoDato = "N"; Long = 11; LongDec = 2;
   Bloque = 21; Casilla = "701"; |HAZ BuscaCasilla;
   nCalc = Casilla + Casilla1;
   aAlfa = nCalc;  |HAZ Formateo; Cadena = Cadena + aAlfa;

   Cadena = Cadena + "</T10017>" + &13 + &10; |HAZ GrabaCad;
   |CIERRA #rem01043;
|FPRC;

|PROCESO Hoja18;
   nSwDatos = 0; nCalc1 = 0; nConCta = 0;
   aTipo = VTipo % 0110;

   Cadena = "<T10018> ";

   TipoDato = "N"; Long = 11; LongDec = 2;
   #rem01001#0 = VEmpresa;
   #rem01001#1 = 0;
   #rem01001#2 = VTipo;
   |LEE 000#rem01001.=;
   |SI FSalida = 0;
      nTotal = 0;
      || Liquidacion : Resultado a ingresar o a devolver
      Bloque = 32;     Casilla = "1  "; |HAZ BuscaCasilla;
      |SI SwError = 1; Casilla = "2  "; |HAZ BuscaCasilla; |FINSI;
      |SI SwError = 1;
         Bloque = 30; Casilla = "760"; |HAZ BuscaCasilla; nTotal = Casilla; SwError = 1;
         nSusp = 0;
      |SINO;
         nSusp = 1;
         nTotal = #rem01001#16;
      |FINSI;

      nConCta = 0;
      || Liquidacion : Resultado a ingresar o a devolver
      aAlfa = nTotal; |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Liquidacion : Solicitud de suspension del ingreso conyuge/renuncia a la devol.otro conyuge
      aAlfa = nSusp; Cadena = Cadena + aAlfa;
      || Declaracion complementaria : Resultado de la decl.complementaria
      Bloque = 31;     Casilla = "765"; |HAZ BuscaCasilla; nCalc = Casilla;
      aAlfa = Casilla; |HAZ Formateo;  Cadena = Cadena + aAlfa;
      |SI nCalc ! 0; nTotal = nCalc; |FINSI;
      nConCta = 0;
      |SI nTotal > 0;
         || Ingreso : Fracciona o no el pago
         |SI #rem01001#8 = "S"; aAlfa = "01"; |SINO; aAlfa = "10"; |FINSI;
         Cadena = Cadena + aAlfa;
         || Ingreso : Importe del ingreso
         nCalc1 = #rem01001#16;
         |SI #rem01001#8 = "S"; nCalc1 = (nCalc1 % 60) ! 2; |FINSI;
         aAlfa = nCalc1; |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Ingreso : Forma de pago
         |SI #rem01001#9 = "E"; aAlfa = "1";              |FINSI;
         |SI #rem01001#9 = "A"; aAlfa = "2"; nConCta = 1; |FINSI;
         |SI #rem01001#9 = "D"; aAlfa = "3"; nConCta = 1; |FINSI;
         Cadena = Cadena + aAlfa;
         || Opciones de pago 2§ plazo : Si domicilia o no el 2§ pago
         |SI #rem01001#8 = "S";
            |SI #rem01001#10 = "S";
               aAlfa = "01"; nConCta = 1;
            |SINO;
               aAlfa = "10";
            |FINSI;
         |SINO;
            aAlfa = "00";
         |FINSI;
         Cadena = Cadena + aAlfa;
         || Opciones de pago 2§ plazo : Importe 2§ plazo
         nCalc1 = 0;
         |SI #rem01001#8 = "S"; |Y #rem01001#10 = "S"; nCalc1 = (#rem01001#16 % 40) ! 2; |FINSI;
         aAlfa = nCalc1; |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Opciones de pago 2§ plazo : Codigo cuenta
      |SINO;
         || Ingreso : Fracciona o no el pago
         Cadena = Cadena + "00";
         || Ingreso : Importe del ingreso
         aAlfa = 0; |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Ingreso : Forma de pago
         Cadena = Cadena + "0";
         || Opciones de pago 2§ plazo : Si domicilia o no el 2§ pago
         Cadena = Cadena + "00";
         || Opciones de pago 2§ plazo : Importe 2§ plazo
         aAlfa = 0; |HAZ Formateo; Cadena = Cadena + aAlfa;
      |FINSI;
      |SI nTotal < 0;
         nTotal = 0 - nTotal; aAlfa = "";
         || Devolucion : Renuncia a la devolucion o Devolucion por transferencia
         |SI #rem01001#11 = "X";
            Cadena = Cadena + "2";
         |SINO;
            |SI #rem01001#12 = "X";
               Cadena = Cadena + "1";
               nConCta = 1;
            |SINO;
               Cadena = Cadena + "0";
            |FINSI;
         |FINSI;
         || Devolucion : Importe de la devolucion
         aAlfa = nTotal; |HAZ Formateo; Cadena = Cadena + aAlfa;
      |SINO;
         || Devolucion : Renuncia a la devolucion o Devolucion por transferencia
         Cadena = Cadena + "0";
         || Devolucion : Importe de la devolucion
         aAlfa = 0; |HAZ Formateo; Cadena = Cadena + aAlfa;
      |FINSI;
      || Codigo cuenta
      |SI nConCta = 1;
         Cadena = Cadena + aCuenta1;
      |SINO;
         Cadena = Cadena + ("0" * 20);
      |FINSI;
      Cadena = Cadena + "</T10018>" + &13 + &10; |HAZ GrabaCad;
   |FINSI;

|FPRC;

|PROCESO GrabaCad;
   |SI aIP ! "";
      |XGRABA Handle, Cadena; Cadena = "";
   |SINO;
      Cadena = Handle + " " + Cadena; |FGRABA Cadena; Cadena = "";
   |FINSI;
|FPRC;

***************************************************************************
**** PROCESOS DE IMPRESION ************************************************
***************************************************************************

|PROCESO ImprimeLos;
   aIP = ""; |IP_REMOTO aIP;

   VEmpresa = #99#0; VTipo    = #99#2;
   aNif = #99#7; |QBF aNif; aNif = aNif % 0108;

   |SI enMinEmp > VEmpresa; enMinEmp = VEmpresa; |FINSI;
   |SI enMaxEmp < VEmpresa; enMaxEmp = VEmpresa; |FINSI;

   Nombre = ("00000" + VEmpresa) % -105;
   Nombre = "or" + Nombre;
   |QBF Nombre;
   Comodin = VTipo; |QBF Comodin;
   |SI Comodin = "CONJUNTA";  Comodin = "A"; |FINSI;
   |SI Comodin = "CONJUNTAE"; Comodin = "A"; |FINSI;
   Nombre = Nombre + (Comodin % 0101);
   |QBF Nombre;

   NEmpresas  = Nombre;
   INEmpresas = INEmpresas + 1;

   Comodin = "\AEAT";             |SI aIP ! ""; |RMKDIR Comodin; |SINO; |MKDIR Comodin; |FINSI;
   |SI #0#34 = "L";
      Comodin = "\AEAT\100_2005"; |SI aIP ! ""; |RMKDIR Comodin; |SINO; |MKDIR Comodin; |FINSI;
      |SI SwCopia = 1;
         Comodin = "\AEAT\INTERNET";     |SI aIP ! ""; |RMKDIR Comodin; |SINO; |MKDIR Comodin; |FINSI;
         Comodin = "\AEAT\INTERNET\100_2005"; |SI aIP ! ""; |RMKDIR Comodin; |SINO; |MKDIR Comodin; |FINSI;
      |FINSI;
      Comodin = "\AEAT\100_2005\" + Nombre;
   |SINO;
      Comodin = "\AEAT\INTERNET";     |SI aIP ! ""; |RMKDIR Comodin; |SINO; |MKDIR Comodin; |FINSI;
      Comodin = "\AEAT\INTERNET\100_2005"; |SI aIP ! ""; |RMKDIR Comodin; |SINO; |MKDIR Comodin; |FINSI;
      Comodin = "\AEAT\INTERNET\100_2005\" + Nombre;
   |FINSI;

   |SI aIP ! "";
      |XABRE "CWB", Comodin, Handle;
   |SINO;
      Comodin = "wb  " + Comodin; |FABRE Comodin;
   |FINSI;
   Handle = FSalida;
   |SI FSalida < 0; |MENAV "    Problemas al abrir el fichero ascii"; |ACABA; |FINSI;

   |ABRE #rem00101; |ABRE #rem01001; |ABRE #rem01002;
   |HAZ Hoja01;
   |HAZ Hoja02;
   |HAZ Hoja03;
   |HAZ Hoja04;
   |HAZ Hoja05;
   |HAZ Hoja06;
   |HAZ Hoja07;
   |HAZ Hoja08;
   |HAZ Hoja09;
   |HAZ Hoja10;
   |HAZ Hoja11;
   |HAZ Hoja12;
   |HAZ Hoja13;
   |HAZ Hoja14;
   |HAZ Hoja15;
   |HAZ Hoja16;
   |HAZ Hoja17;
   |HAZ Hoja18;

   ||PEPE
   #rem01001#0 = #99#0;
   #rem01001#1 = 0;
   VTipo = #99#2; |QBF VTipo;
   #rem01001#2 = VTipo;
   |LEE 101#rem01001.=;
   |SI FSalida = 0;
      #rem01001#6 = "S";
      |GRABA 020#rem01001.a; |LIBERA #rem01001;
   |FINSI;

   |CIERRA #rem01002; |CIERRA #rem00101; |CIERRA #rem01001;

   |SI aIP ! "";
      |XCIERRA Handle;
   |SINO;
      FSalida = Handle; |FCIERRA FSalida;
   |FINSI;

   SwDatos = 1;

|FPRC;

|PROCESO CopiaFich;
   aDestino = "/AEAT/100_2005/IR05LASE.EXE";
   |DBASE aAlfa; |QBF aAlfa; aAlfa = aAlfa + "hacienda/";
   aOrigen  = aAlfa + "ir05lase.exe";
   aContiene1 = aDestino;
   |ESPECIFICA "REMOTOMD5", aContiene;
   aDocRemoto = FSalida;  |QBF aDocRemoto;

   aContiene1 = aOrigen;
   |ESPECIFICA "MD5", aContiene;
   aDocServidor = FSalida;  |QBF aDocServidor;

   |SI aDocRemoto ! aDocServidor; nCopia = 1; |SINO; nCopia = 0; |FINSI;
   aIP = ""; |IP_REMOTO aIP;

   |DBASE aAlfa; |QBF aAlfa; aAlfa = aAlfa + "hacienda/";
   aOrigen  = aAlfa + "ir05lase.exe";
   aDestino = "/AEAT/100_2005/ir05lase.exe";
   |SI aIP ! "";
      |SI nCopia = 1; |ENVIA_FICHERO aOrigen, aDestino; |FINSI;
      aAlfa = "/AEAT/100_2005/imprime.bat";
      |XABRE "CW", aAlfa, Handle;
   |SINO;
      |SI nCopia = 1; |COPIA_FICHERO aOrigen, aDestino; |FINSI;
      aAlfa = "wt  /AEAT/100_2005/imprime.bat";
      |FABRE aAlfa; Handle = FSalida;
   |FINSI;

   |SI FSalida ] 0;
      Cadena = Cadena + "";
      aAlfa = "CD \AEAT\100_2005";
      |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

      |SI nCopia = 1
         aAlfa = "attrib -r *.*";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         aAlfa = "del *.WMF";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         aAlfa = "del *.TAB";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         aAlfa = "del *.DLL";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         aAlfa = "del VERSION.TXT";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         aAlfa = "del SIGLAS.TXT";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         aAlfa = "del ERR10002.TXT";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         aAlfa = "del PAISES.TXT";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         aAlfa = "del PROVINCI.TXT";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         aAlfa = "del R05PDF.EXE";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         aAlfa = "del WAIT.EXE";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         aAlfa = "ir05lase -y";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;
      |FINSI;

      INEmpresas = NEmpresas1<-;
      Nombre = NEmpresas;
      |PARA; |SI Nombre ! ""; |HACIENDO;
         aAlfa = "DEL " + (Nombre % 0107) + "*.TXT";
         |SI aAlfa ! aBorrAnt;
            aBorrAnt = aAlfa;
            |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;
         |FINSI;
         INEmpresas = INEmpresas + 1; Nombre = NEmpresas;
      |SIGUE;

      INEmpresas = NEmpresas1<-;
      Nombre = NEmpresas;
      |PARA; |SI Nombre ! ""; |HACIENDO;
         aAlfa = "DEL " + Nombre + ".TXT";
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

         |SI SwCopia = 1;
            aAlfa = "COPY \AEAT\100_2005\" + Nombre + " \AEAT\INTERNET\100_2005\" + Nombre;
            |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;
         |FINSI;

         aAlfa = "WAIT R05PDF /E:" + Nombre + " /R:" + Nombre + ".txt /C:" + #reemi100#37;
         |SI #reemi100#62 ! "E"; aAlfa = aAlfa + " /L:" + #reemi100#62; |FINSI;
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;
         INEmpresas = INEmpresas + 1; Nombre = NEmpresas;
      |SIGUE;

      aAlfa = "del or*.";
      |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

      |SI aIP ! "";
         |XCIERRA Handle;
      |SINO;
         FSalida = Handle; |FCIERRA FSalida;
      |FINSI;

      aAlfa = "/AEAT/100_2005/imprime.bat";
      |SI aIP ! ""; |RSYSTEM aAlfa; |SINO; |SYSTEM aAlfa; |FINSI;
   |SINO;
      |MENAV "    Problemas para crear el proceso por lotes que ejecuta el programa";
      |ERROR;
   |FINSI;
   VEmpresa = enEmpresa;
|FPRC;

|RUTINA inferior;
  #99#0 = 1;
  #99#1 = " ";
|FRUT;

|RUTINA superior;
  #99#0 = 99999;
  #99#1 = "z";
|FRUT;

|DEFBUCLE rew00001;
  #99#1;
  5;
  00000, " ", "S";
  99999, "z", "S";
  ;
  NULL, ImprimeLos;
|FIN;

******************** Tipo de Impresion

|PROCESO funcion1; |TIPO 11;
  |SI FSalida ! 9; |ACABA; |FINSI;

  |LIBERA #99;
  |LEE 140#99=;

  |SI #99#5 = "S"; #99#5 = "N"; |SINO; #99#5 = "S"; |FINSI;
  |PINTA #99#5;
  |GRABA 140#99a;
|FPRC;

|PROCESO MiraLiqui;
     |SI #1#5 ! "100";  |Y #1#5 ! "101";
         |ACABA;
     |FINSI;
/*
     |SI eaTipoEmi = "I"
         #1#6 = "S";
     |SINO;
         #1#6 = "N";
     |FINSI;
*/
     aAlfa = #99#2; |QBF aAlfa;
     |SI aAlfa = "CONJUNTA";  aAlfa = "A"; |FINSI;
     |SI aAlfa = "CONJUNTAE"; aAlfa = "A"; |FINSI;
     aAlfa     = aAlfa % 101;
     aFichero  = "or" + (("00000" + #1#0) % -105) + aAlfa + ".txt";
     aFichero  = "C:/AEAT/100_2005/" + aFichero;
     |XABRE "EC", aFichero, nCanal;
     |SI FSalida < 0;
         || #1#6 = "S";
     |FINSI;
     |GRABA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE rem01001;
     #1#1;
     ;
     #99#0, 00, "          ";
     #99#0, 99, "zzzzzzzzzz";
     be;
     NULL, MiraLiqui;
|FIN;

|PROCESO GrabaTempo;
   #99#0 = #rem01001#0;
   #99#1 = "";
   #99#2 = #rem01001#2;
   Comodin = #99#2 % 0101;
   |SI #99#2 = "CONJUNTAE    ";
      Comodin = "J";
   |FINSI;
   |SI #99#2 = "CONJUNTA     ";
      Comodin = "N";
   |FINSI;
   #99#1 = Comodin;
   #99#3 = #rem01001#7;
   #99#4 = 1;
   #99#5 = "S";
   #99#6 = 1;
   #99#7 = "";
   #99#8 = #reemi100#60;
   #99#9 = #reemi100#61;
   |GRABA 000#99n;
   |SI FSalida = 0;
        SwEstar = 1;
   |FINSI;
|FPRC;

|DEFBUCLE DatosContrib;
  #rem01001#1;
  5,6;
  DEmpre,00,"          ","100",DReimp;
  HEmpre,99,"zzzzzzzzzz","101",HReimp;
  ;
  NULL, GrabaTempo;
|FIN;

|PROCESO CargaTempo;
  |DELINDEX #99;

  SwEstar = 0;

  |ABRE #99;

  |SI #0#36 = "S";
     DReimp = "N"; HReimp = "S";
  |SINO;
     DReimp = "N"; HReimp = "N";
  |FINSI;

  |SI #0#0 = "S";
      DEmpre = #0#1;
      HEmpre = #0#2;
      |BUCLE DatosContrib;
  |SINO;
      |PARA XCampos = 3; |SI XCampos [ 32; |HACIENDO XCampos = XCampos + 1;
            |SI #0XCampos ! 0;
                DEmpre = #0XCampos;
                HEmpre = #0XCampos;
                |BUCLE DatosContrib;
            |FINSI;
      |SIGUE;
  |FINSI;
  |CIERRA #99;

  |SI SwEstar = 0; |ACABA; |FINSI;

  |SI #0#35 = "N"; |ACABA; |FINSI;

  |ENTLINEAL #1#99, -1, 4, 19, 1, inferior, superior;
|FPRC;

|PROCESO Grabalos;
     |BUCLE rem01001;

     enEmpresa     = #99#0;
     enTipoEntrada = 99;
     |SUB_EJECUTA_NP "reacceso";
|FPRC;

|DEFBUCLE rew00001G;
     #99#1;
     5;
     00000, " ", "S";
     99999, "z", "S";
     ;
     NULL, Grabalos;
|FIN;

|PROCESO Emision;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
  Nombre = "or" + Usuario;
  |NOME_DAT #99 Nombre;

  |ABRE #rem01001;
  |HAZ CargaFecha;
  |HAZ CargaTempo;

  INEmpresas = NEmpresas1<-;
  SwDatos = 0;
  |SI #0#34 = "I";
     |CONFI "    NEmitir copia por impresora ? ";
     |SI FSalida = 0;
        SwCopia = 1; #0#34 = "L";
     |SINO;
        SwCopia = 0;
     |FINSI;
  |FINSI;

  enMinEmp = 999999; enMaxEmp = 000000;
  |BUCLE rew00001;

  |SI #0#34 = "L";
     |HAZ CopiaFich;
     eaTipoSec = "100_2005"; |HAZ Errores;
  |FINSI;

  |SI SwCopia = 1;
     INEmpresas = NEmpresas1<-;
     aAlfa = NEmpresas; |QBF aAlfa;
     |PARA; |SI aAlfa ! ""; |HACIENDO;
        aAlfa1  = "/AEAT/100_2005/" + aAlfa + ".txt";
        |XABRE "EC", aAlfa1, nCanal;
        |SI FSalida ] 0;
           aAlfa1 = "/AEAT/INTERNET/100_2005/" + aAlfa;
           |RFBORRA aAlfa1;
        |FINSI;
        INEmpresas = INEmpresas + 1;
        aAlfa = NEmpresas; |QBF aAlfa;
     |SIGUE;
     #0#34 = "I";
  |FINSI;

  ||HAZ Emision;

  |SI #0#34 = "I"; |Y SwDatos = 1;
     |CONFI "    NDesea copiar los ficheros a diskette ?";
     |SI FSalida = 0;
        |MENAV "    Introduzca un diskette vacio en su PC";
        Comodin = "/AEAT/INTERNET/100_2005/";
        INEmpresas = NEmpresas1<-;
        Comodin2 = Comodin + NEmpresas;
        |SI NEmpresas ! "";
           |PARA; |SI NEmpresas ! ""; |HACIENDO;
              aDestino = "a:/" + NEmpresas;
              Comodin1 = "COPY " + Comodin2 + " " + aDestino;
              |RSYSTEM Comodin1;
              |RFBORRA Comodin1;
              INEmpresas = INEmpresas + 1;
              Comodin2 = Comodin + NEmpresas;
           |SIGUE;
        |FINSI;
     |FINSI;
     |HAZ PresentaAyuda;
  |FINSI;
  |CIERRA #rem01001;

  |BUCLE rew00001G;
|FPRC;

|PROCESO PresentaAyuda;
   |PUSHV 0501 2380;
   |BLANCO 0501 2380;
   |CUADRO 0701 2080;
   |ATRI R;
   aAlfa = " INFORMACION IMPORTANTE PARA LA PRESENTACION TELEMATICA DE DECLARACIONES      ";
   |PINTA 0702, aAlfa; |ATRI I;
   |PINTA 0804, " Los ficheros generados  para la presentacion telematica  de declaraciones";
   |PINTA 0904, " de patrimonio podran recogerse de la carpeta 'AEAT/INTERNET/100_2005'";
   |PINTA 1004, " de  la maquina desde  la que se han emitido, sabiendo que  el formato del";
   |PINTA 1104, " nombre de los ficheros es el siguiente : ";
   |PINTA 1204, " * Los  dos primeros digitos coinciden para todas las declaraciones  de ";
   |PINTA 1304, "   renta ('or') ";
   |PINTA 1404, " * Los cinco siguientes digitos conforman el codigo de cliente ";
   |PINTA 1504, " * El ultimo  digito determinara el contribuyente  al que pertenece  la ";
   |PINTA 1604, "   declaracion, siendo las siguientes : ";
   |PINTA 1704, "       T - Titular           C - Conyuge        A - Conjunta";
   |PINTA 1804, "       1 - 1er.familiar      2 - 2§. familiar ";
   |PINTA 1904, "       3 - 3er.familiar      4 - 4§. familiar ";
   |ATRI N;
   |PAUSA; |POPV;
|FPRC;

|PROCESO SeparaNombre;
   aNom = ""; aApel1 = ""; aApel2 = "";
   nInd = 1;
   aLong = aAlfa % 0; nLong = aLong;
   aAlfa1 = "";
   |PARA nCalc = 1; |SI nCalc [ nLong; |HACIENDO nCalc = nCalc + 1;
      nPos = (nCalc * 100) + 1;
      aAlfa2 = aAlfa % nPos;
      |SI aAlfa2 = " "; |O aAlfa2 = ",";
         |SI aAlfa1 ! "DE";  |Y aAlfa1 ! "de";
          |Y aAlfa1 ! "LA";  |Y aAlfa1 ! "la";
          |Y aAlfa1 ! "LAS"; |Y aAlfa1 ! "las";
          |Y aAlfa1 ! "LOS"; |Y aAlfa1 ! "los";
          |Y aAlfa1 ! "DEL"; |Y aAlfa1 ! "def";
            |SI nInd = 1; |Y aAlfa1 ! ""; aApel1 = aApel1 + aAlfa1 + " "; |FINSI;
            |SI nInd = 2; |Y aAlfa1 ! ""; aApel2 = aApel2 + aAlfa1 + " "; |FINSI;
            |SI nInd ] 3; |Y aAlfa1 ! ""; aNom   = aNom   + aAlfa1 + " "; |FINSI;
             nInd = nInd + 1;
         |SINO;
            |SI nInd > 1; nInd = nInd - 1; |FINSI;
            |SI nInd = 1; |Y aAlfa1 ! ""; aApel1 = aApel1 + aAlfa1 + " "; |FINSI;
            |SI nInd = 2; |Y aAlfa1 ! ""; aApel2 = aApel2 + aAlfa1 + " "; |FINSI;
            |SI nInd ] 3; |Y aAlfa1 ! ""; aNom   = aNom   + aAlfa1 + " "; |FINSI;
         |FINSI;
         aAlfa1 = "";
      |SINO;
         aAlfa1 = aAlfa1 + aAlfa2;
      |FINSI;
   |SIGUE;

   |PARA; |SI SwSalir = 0; |HACIENDO;
      SwSalir = 1;
      aAlfa1 = aApel1 % 0101;
      |SI aAlfa1 = " "; aApel1 = aApel1 % 0299; SwSalir = 0; |FINSI;
      aAlfa1 = aApel2 % 0101;
      |SI aAlfa1 = " "; aApel2 = aApel2 % 0299; SwSalir = 0; |FINSI;
      aAlfa1 = aNom   % 0101;
      |SI aAlfa1 = " "; aNom   = aNom   % 0299; SwSalir = 0; |FINSI;
   |SIGUE;
|FPRC;

|PROCESO BuscaCasilla;
   #rem01002#0 = VEmpresa;
   #rem01002#1 = " ";
   #rem01002#2 = VTipo;
   #rem01002#3 = Bloque;
   #rem01002#4 = Casilla;
   |LEE 010#rem01002.=;
   |SI FSalida = 0;
       |SI #rem01002#4 = "TM1";  |O  #rem01002#4 = "TM2";
           Casilla = #rem01002#8;
       |SINO;
           Casilla = #rem01002#6; Casilla1 = #rem01002#9;
       |FINSI;
       SwError = 0;
   |SINO;
       Casilla = 0; SwError = 1;
   |FINSI;
|FPRC;

|PROCESO CargaFecha;
  DiaInf   = #0#33 % 102;
  MesNum   = #0#33 % 402;
  MesInf   = #0#33 % 402;
  EjerInf  = #0#33 % -104;

  |SI MesNum = "01"; MesInf = "Enero     "; |FINSI;
  |SI MesNum = "02"; MesInf = "Febrero   "; |FINSI;
  |SI MesNum = "03"; MesInf = "Marzo     "; |FINSI;
  |SI MesNum = "04"; MesInf = "Abril     "; |FINSI;
  |SI MesNum = "05"; MesInf = "Mayo      "; |FINSI;
  |SI MesNum = "06"; MesInf = "Junio     "; |FINSI;
  |SI MesNum = "07"; MesInf = "Julio     "; |FINSI;
  |SI MesNum = "08"; MesInf = "Agosto    "; |FINSI;
  |SI MesNum = "09"; MesInf = "Septiembre"; |FINSI;
  |SI MesNum = "10"; MesInf = "Octubre   "; |FINSI;
  |SI MesNum = "11"; MesInf = "Noviembre "; |FINSI;
  |SI MesNum = "12"; MesInf = "Diciembre "; |FINSI;

  MesInf = MesInf > MesInf;
|FPRC;

|PROCESO Formateo;
   |QBF aAlfa;
   |SI TipoDato = "F";
      aAlfa = aAlfa - "."; aAlfa = aAlfa - ".";
      |QBF aAlfa;
      |SI aAlfa = "";         aAlfa = "0" * 8; |FINSI;
      |SI aAlfa = "01010000"; aAlfa = "0" * 8; |FINSI;
      |ACABA;
   |FINSI;
   |SI TipoDato = "N";
      Vacio1 = "0" * Long;
      Vacio2 = "0" * LongDec;
      aAlfa = aAlfa - "-";
      |SI FSalida ! 0;
         nNegativo = 1;
      |SINO;
         nNegativo = 0;
      |FINSI;
   |SINO;
      Vacio1 = " " * Long;
   |FINSI;

   |SI TipoDato ! "N";
      Calc1 = 100 + Long; aAlfa = (aAlfa + Vacio1) % Calc1;
   |SINO;
      |SI LongDec = 0;
         Calc1 = 0 - (100 + Long);
         aAlfa = (Vacio1 + aAlfa) % Calc1;
      |SINO;
         aAlfa = aAlfa - ".";
         |SI FSalida = 0;
            Calc1 = 0 - (100 + Long);
            aAlfa = (Vacio1 + aAlfa) % Calc1;
            aAlfa1 = "0" * LongDec;
         |SINO;
            Calc1 = (((FSalida / 100) ! 0) - 1) + 100;
            Calc2 = (((FSalida / 100) ! 0) * 100) + 99;
            aAlfa1 = aAlfa % Calc2;
            aAlfa = aAlfa % Calc1;
            Calc1 = 0 - (100 + Long);
            aAlfa = (Vacio1 + aAlfa)  % Calc1;
            Calc1 = 100 + LongDec;
            aAlfa1 = (aAlfa1 + Vacio2) % Calc1;
         |FINSI;
         aAlfa = aAlfa + aAlfa1;
      |FINSI;
      |SI nNegativo = 1;
         Calc1 = 0 - (100 + (Long + LongDec)); Calc1 = Calc1 + 1;
         aAlfa = aAlfa % Calc1;
         aAlfa = "N" + aAlfa;
      |FINSI;
   |FINSI;

   aAlfa2 = "";

   |SI TipoDato = "A"; |O TipoDato = "An";
      aLong = aAlfa % 0; nLong = aLong;
      |PARA nCont1 = 1; |SI nCont1 [ nLong; |HACIENDO nCont1 = nCont1 + 1;
         Calc1 = (nCont1 * 100) + 1; aAlfa1  = aAlfa % Calc1;
         aAlfa1 = aAlfa1 > aAlfa1;
         |SI aAlfa1 = " ";                  |VETE Sigue1; |FINSI;
         |SI aAlfa1 ] "A"; |Y aAlfa1 [ "Z"; |VETE Sigue1; |FINSI;
         |SI aAlfa1 ] "0"; |Y aAlfa1 [ "9"; |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "¥"; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "¤"; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "ç"; aAlfa1 = &199;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "Ç"; aAlfa1 = &199;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "-"; aAlfa1 = &45;    |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "'"; aAlfa1 = &49;    |VETE Sigue1; |FINSI;
         |SI TipoDato = "An";
            |SI aAlfa1 = "&"; aAlfa1 = &38;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = ","; aAlfa1 = &44;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = "."; aAlfa1 = &46;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = ":"; aAlfa1 = &58;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = ";"; aAlfa1 = &59;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = "_"; aAlfa1 = &95;    |VETE Sigue1; |FINSI;
         |FINSI;
         aAlfa1 = " ";
|ET Sigue1;
         aAlfa2 = aAlfa2 + aAlfa1;
      |SIGUE;
      aAlfa = aAlfa2;
   |FINSI;
   Calc1 = aAlfa;
   |SI nSwDatos = 0; |Y Calc1 ! 0; nSwDatos = 1; |FINSI;
|FPRC;

|PROCESO TipoContr;
   |QBF aAlfa;
   |SI aAlfa = ""; aTipoContr = "0"; |ACABA; |FINSI;
   |SI aSeparada = "S";
     aTipoContr = "2";
   |SINO;
     aTipoContr = "0";
      |SI aAlfa = "TITULAR";   aTipoContr = "2"; |FINSI;
      |SI aAlfa = "CONYUGE";
         |SI VTipo = "CONYUGE      ";aTipoContr = "2"; |SINO;aTipoContr = "3"; |FINSI;
      |FINSI;
      |SI aAlfa = "COMUNES";   aTipoContr = "1"; |FINSI;
      |SI aAlfa = "CONJUNTA";  aTipoContr = "1"; |FINSI;
      |SI aAlfa = "CONJUNTAE"; aTipoContr = "1"; |FINSI;
      |SI aAlfa = "GANANCIAL"; aTipoContr = "1"; |FINSI;
      |SI aAlfa = "1 FAMILIAR";aTipoContr = "4"; |FINSI;
      |SI aAlfa = "2 FAMILIAR";aTipoContr = "5"; |FINSI;
      |SI aAlfa = "3 FAMILIAR";aTipoContr = "6"; |FINSI;
      |SI aAlfa = "4 FAMILIAR";aTipoContr = "7"; |FINSI;
      |SI aAlfa = "VARIOS";    aTipoContr = "2"; |FINSI;
   |FINSI;

|FPRC;

|PROCESO Seleccion; |TIPO 0;
  |SI enEmpresa ! 0;  |ACABA;  |FINSI;

  |SI #0#0 = "S";
      |CAMPO_MODIFICA #0#01, 1, "S";
      |CAMPO_MODIFICA #0#02, 1, "S";

      |PARA XCampos = 3; |SI XCampos [ 32; |HACIENDO XCampos = XCampos + 1;
            #0XCampos = 0; |PINTA #0XCampos;
            |CAMPO_MODIFICA #0XCampos, 1, "N";
      |SIGUE;
  |SINO;
      #0#1 = 00001; |PINTA #0#1;    |CAMPO_MODIFICA #0#01, 1, "N";
      #0#2 = 99999; |PINTA #0#2;    |CAMPO_MODIFICA #0#02, 1, "N";

      |PARA XCampos = 3; |SI XCampos [ 32; |HACIENDO XCampos = XCampos + 1;
            |CAMPO_MODIFICA #0XCampos, 1, "S";
      |SIGUE;
  |FINSI;
|FPRC;

|PROCESO SelecTipo;  |TIPO 0;

  Modifica = "S";
  |SI #0Campo = "L";
     Modifica = "N";
     #reemi100#54 = "S";
     #reemi100#55 = "N";
     |PINTA #reemi100#54;
     |PINTA #reemi100#55;
     |C_M #reemi100#54,1,"N";
     |C_M #reemi100#55,1,"N";
  |FINSI;
  eaTipoEmi = #0#34;

  #0#57 = "S";
  |C_M #0#57, 1, Modifica;

  |PINTA #0#37;
|FPRC;

|PROCESO Tipo8; |TIPO 8;
   ||MENAV "    En espera de los modulos de impresion"; |PTEC 807; |ACABA;
|FPRC;

|PROCESO MiraSiDatos;
   aTipo = VTipo % 0110;
   |SI nSwDatos = 9;
      nSwDatos = 1; |ACABA;
   |FINSI;

   |SI nSwDatos = 10;
      nSwDatos = 1; |ACABA;
   |FINSI;

   |SI nSwDatos = 13;
      nSwDatos = 0;
      |ABRE #rem01041;
      #rem01041#0 = VEmpresa;
      #rem01041#1 = 0;
      #rem01041#2 = aTipo;
      |LEE 000#rem01041.=;
      FEstado = FSalida;
      |CIERRA #rem01041;
      |SI FEstado = 0;
         |SI #rem01041#92 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#5  ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#9  ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#38 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#58 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#40 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#59 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#21 ! "01.01.0000"; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#27 ! "01.01.0000"; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#62 ! "01.01.0000"; nSwDatos = 1; |ACABA; |FINSI;
         aAlfa = #rem01041#63; |QBF aAlfa;
         |SI aAlfa ! "";      nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#45 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#47 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#66 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#67 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#70 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#74 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#14 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#64 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         |SI #rem01041#93 ! 0; nSwDatos = 1; |ACABA; |FINSI;
         aAlfa = #rem01041#94; |QBF aAlfa;
         |SI aAlfa ! "";      nSwDatos = 1; |ACABA; |FINSI;
      |FINSI;
   |FINSI;

   |SI nSwDatos = 14;
      nSwDatos = 0;
      |ABRE #rem01043;
      #rem01043#0 = VEmpresa;
      #rem01043#1 = 0;
      #rem01043#2 = aTipo;
      |LEE 000#rem01043.=;
      FEstado = FSalida;
      |CIERRA #rem01043;
      |SI FEstado = 0;
         |PARA nCont = 3; |SI nCont [ 40; |HACIENDO nCont = nCont + 1;
            |SI #rem01043#nCont# ! 0; nSwDatos = 1; |SAL; |FINSI;
         |SIGUE;
      |FINSI;
   |FINSI;

   |SI nSwDatos = 15;
      nSwDatos = 0;
      |ABRE #rem01043;
      #rem01043#0 = VEmpresa;
      #rem01043#1 = 0;
      #rem01043#2 = aTipo;
      |LEE 000#rem01043.=;
      FEstado = FSalida;
      |CIERRA #rem01043;
      |SI FEstado = 0;
         |PARA nCont = 41; |SI nCont [ 73; |HACIENDO nCont = nCont + 1;
            |SI #rem01043#nCont# ! 0; nSwDatos = 1; |SAL; |FINSI;
         |SIGUE;
      |FINSI;
   |FINSI;

   |SI nSwDatos = 16;
      nSwDatos = 0;
      |ABRE #rem01043;
      #rem01043#0 = VEmpresa;
      #rem01043#1 = 0;
      #rem01043#2 = aTipo;
      |LEE 000#rem01043.=;
      FEstado = FSalida;
      |CIERRA #rem01043;
      |SI FEstado = 0;
         |PARA nCont = 74; |SI nCont [ 117; |HACIENDO nCont = nCont + 1;
            |SI #rem01043#nCont# ! 0; nSwDatos = 1; |SAL; |FINSI;
         |SIGUE;
      |FINSI;
   |FINSI;

   |SI nSwDatos = 17;
      nSwDatos = 0;
      |ABRE #rem01042;
      #rem01042#0 = VEmpresa;
      #rem01042#1 = 0;
      #rem01042#2 = aTipo;
      |LEE 000#rem01042.=;
      |SI FSalida = 0;
         |PARA nCont = 3; |SI nCont [ 89; |HACIENDO nCont = nCont + 1;
            |SI #rem01042#nCont# ! 0; nSwDatos = 1; |SAL; |FINSI;
         |SIGUE;
         |SI nSwDatos = 0;
            |SI #rem01042#90  ! 0; |O #rem01042#91  ! 0;                       nSwDatos = 1; |FINSI;
            |SI #rem01042#93  ! 0; |O #rem01042#94  ! 0; |O #rem01042#96  ! 0; nSwDatos = 1; |FINSI;
            |SI #rem01042#97  ! 0; |O #rem01042#98  ! 0; |O #rem01042#100 ! 0; nSwDatos = 1; |FINSI;
            |SI #rem01042#101 ! 0; |O #rem01042#102 ! 0; |O #rem01042#104 ! 0; nSwDatos = 1; |FINSI;
            |SI #rem01042#105 ! 0; |O #rem01042#106 ! 0; |O #rem01042#108 ! 0; nSwDatos = 1; |FINSI;
            |SI #rem01042#109 ! 0;                                             nSwDatos = 1; |FINSI;
         |FINSI;
      |FINSI;
      |CIERRA #rem01042;
   |FINSI;
|FPRC;

|PROGRAMA;
     |SI enEmpresa ! 0;
         #0#0 = "S";
         |PARA nCampo = 0;  |SI nCampo [ 32;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
         |SIGUE;
         #0#1 = enEmpresa;  |PINTA #0#1;
         #0#2 = enEmpresa;  |PINTA #0#2;
         |PINPA #0#0;
         |PINDA #0#0;
         |ENDATOS #1#0;
     |SINO;
         |MANTE #0;
     |FINSI;
|FPRO;

|PROCESO MiraFecha;
   |SI #reemi100#33 < "01.05.2004";
      |MENAV "    Fecha presentacion incorrecta"; |ERROR;
   |FINSI;
|FPRC;

|PROCESO BuscaPais;
   |ABRE #reauxpai;
   #reauxpai#0 = aAlfa;
   |LEE 000#reauxpai.=;
   |SI FSalida = 0;
      aAlfa = #reauxpai#2;
   |SINO;
      aAlfa = "   ";
   |FINSI;
   |CIERRA #reauxpai;
|FPRC;
