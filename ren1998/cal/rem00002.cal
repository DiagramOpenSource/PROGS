|FICHEROS;
     rem00002 #0,MANTE;
     recapinm #1;
     reincreg #2;
     reincire #3;
     reparame #4;
     redatcon #5;
     repoblac #6;
     rerenpre #7;
     reauxdiv #8;
     retabla3 #9;
     retotpat #10;

     rem00003 #900,MANTE;     || Modelo 210
     rew00006 #901,MANTE;     || Utilidad Modelo 210

     rem00004 #902,MANTE;     || Modelo 212
     rew00007 #903,MANTE;     || Utilidad Modelo 212

     rem00005 #904,MANTE;     || Modelo 214

     rem00016 #916;           || Modelo 211 Adquirentes y Transmitentes
     rem00017 #917;           || Modelo 211
|FIN;

|VARIABLES;
     aTipo         = "";
     aClave        = "";
     aAlfa1        = "";
     aAlfa2        = "";
     nLinea        = 0;
     nCoefi        = 0;

     XPara         = 0;
     Posi          = 0;
     Valfa0        = "";
     Valfa1        = "";
     Valfa2        = "";
     SwPunto       = 0;
     Vanyo         = 0;
     Vanyo1        = "";
     Vanyo2        = "";
     Vanyon1       = 0;
     Vanyon2       = 0;
     Coefi         = 0;
     Coef          = 0;
     Valor1        = 0;
     Fecha         = 0;
     VAmortiza1    = 0;
     VAmortiza     = 0;
     DesdeFec      = @;
     HastaFec      = @;
     VAdquisicio   = 0;
     FechaCal      = 0;
     VIncroDismi   = 0;
     VIncremento   = 0;
     Exento        = 0;
     Porce         = 0;
     FInicio       = @;
     NFami         = 0;
     Base          = 0;
     Tecla         = 0;
     SwError       = 0;
     CampoTrabajo  = 0;
     Campo1        = 0;
     Campo2        = 0;
     Campo3        = 0;
     Valfa         = "";
     VAntes        = "";
     ModoE         = 0;
     nSalir        = 0;
     nSalir1       = 0;
     FEstado       = 0;
     Modelo        = 214;

     &aTipoGente = "";
     &indivi      = "";
     &errorlin    = 0;
     &empresa     = 0;
     &nombre      = "";
     &modo        = 0;
     &modelito    = 0;
     &numerica1   = 0;  &numerica2  = 0;   &numerica3  = 0;
     &numerica4   = 0;  &numerica5  = 0;   &numerica6  = 0;
     &numerica7   = 0;  &numerica8  = 0;   &numerica9  = 0;
     &numerica10  = 0;  &numerica11 = 0;   &numerica12 = 0;
     &numerica13  = 0;  &numerica14 = 0;   &numerica15 = 0;
     &numerica16  = 0;  &numerica17 = 0;   &numerica18 = 0;
     &numerica19  = 0;  &numerica20 = 0;   &numerica21 = 0;
     &numerica22  = 0;  &numerica23 = 0;   &numerica24 = 0;
     &numerica25  = 0;  &numerica26 = 0;   &numerica27 = 0;
     &numerica28  = 0;  &numerica29 = 0;   &numerica30 = 0;
     &numerica31  = 0;  &numerica32 = 0;   &numerica33 = 0;
     &numerica34  = 0;  &numerica35  = 0;  &numerica36 = 0;
     &numerica37  = 0;  &numerica38  = 0;  &numerica39 = 0;
     &numerica40  = 0;  &numerica41  = 0;  &numerica42 = 0;

     &alfanumer1  = ""; &alfanumer2  = ""; &alfanumer3  = "";
     &alfanumer4  = ""; &alfanumer5  = ""; &alfanumer6  = "";
     &alfanumer7  = ""; &alfanumer8  = ""; &alfanumer9  = "";
     &alfanumer10 = ""; &alfanumer11 = ""; &alfanumer12 = "";
     &alfanumer13 = ""; &alfanumer14 = ""; &alfanumer15 = "";
     &alfanumer16 = ""; &alfanumer17 = ""; &alfanumer18 = "";

     &fechas1     = @;  &fechas2     = @;  &fechas3     = @;
     &fechas4     = @;  &fechas5     = @;

{-1} MGeneral   = "";
     MGeneral1  = "1663";
     MGeneral2  = "1";
     MGeneral3  = "5";
     MGeneral4  = "Inmueble   ";
     MGeneral5  = "Modelo 210 ";
     MGeneral6  = "Modelo 211 ";
     MGeneral7  = "Modelo 212 ";
     MGeneral8  = "Modelo 214 ";

{-1} M211Mod   = "";
     M211Mod1  = "1862";
     M211Mod2  = "1";
     M211Mod3  = "3";
     M211Mod4  = "Adquirente  ";
     M211Mod5  = "Transmitente";
     M211Mod6  = "Liquidacion ";
|FIN;

|INCLUYE i_husuar;
|INCLUYE i_activo;
|INCLUYE i_patrim;

|PROCESO ConsuGente;
     |SI FSalida ! 13;  |ACABA;  |FINSI;

     aTipoGente = #0Campo;
     |SUB_EJECUTA "rez00003";
     #0Campo = aTipoGente;
     |PINTA #0Campo;
|FPRC;

|PROCESO Carga;
     #1#2  = alfanumer1;  #1#3  = alfanumer2;  #1#4  = alfanumer3;
     #1#5  = alfanumer4;  #1#6  = numerica1;   #1#7  = numerica2;
     #1#8  = numerica3;   #1#9  = numerica4;   #1#10 = numerica5;
     #1#11 = numerica6;   #1#12 = numerica7;   #1#13 = alfanumer5;
     #1#14 = numerica8;   #1#15 = alfanumer6;  #1#16 = numerica9;
     #1#17 = numerica10;  #1#18 = fechas1;     #1#19 = numerica11;
     #1#20 = numerica12;  #1#21 = alfanumer7;  #1#22 = alfanumer8;
     #1#23 = numerica13;  #1#24 = numerica14;  #1#25 = numerica15;
     #1#26 = numerica16;  #1#27 = numerica17;  #1#28 = numerica18;
     #1#29 = numerica19;  #1#30 = numerica20;  #1#31 = alfanumer9;
     #1#32 = numerica21;  #1#33 = numerica22;  #1#34 = fechas2;
     #1#35 = numerica23;  #1#36 = numerica24;  #1#37 = numerica25;
     #1#38 = fechas3;     #1#39 = fechas4;     #1#40 = fechas5;
     #1#41 = numerica26;  #1#42 = numerica27;  #1#43 = numerica28;
     #1#44 = alfanumer10; #1#45 = alfanumer11; #1#46 = alfanumer12;
     #1#48 = alfanumer13; #1#49 = numerica29;  #1#50 = numerica30;
     #1#51 = numerica31;  #1#52 = numerica32;  #1#53 = numerica33;
     #1#54 = numerica34;  #1#47 = numerica35;  #1#55 = alfanumer14;
     #1#56 = numerica36;  #1#59 = numerica37;  #1#66 = numerica38;
     #1#67 = numerica39;  #1#68 = numerica40;  #1#69 = numerica41;
     #1#71 = alfanumer15; #1#72 = alfanumer16;
     npro = 2;
     |HAZ sigrabo;

     #0#2  = #1#48;  |PINTA #0#2;
     #0#3  = #1#2;   |PINTA #0#3;
     #0#4  = #1#3;   |PINTA #0#4;
     #0#5  = #1#5;   |PINTA #0#5;
     #0#8  = #1#49;  |PINTA #0#8;
     #0#9  = #1#50;  |PINTA #0#9;
     #0#10 = #1#51;  |PINTA #0#10;
     #0#11 = #1#52;  |PINTA #0#11;
     #0#12 = #1#53;  |PINTA #0#12;
     #0#13 = #1#54;  |PINTA #0#13;
|FPRC;

|PROCESO  Inmobiliario;
     |SI #0#6 = "N";  |ACABA;  |FINSI;

     alfanumer1 = #0#3;     alfanumer2 = #0#4;    alfanumer3 = #1#4;
     alfanumer4 = #0#5;     numerica1  = #1#6;    numerica2  = #1#7;
     numerica3  = #1#8;     numerica4  = #1#9;    numerica5  = #1#10;
     numerica6  = #1#11;    numerica7  = #1#12;   alfanumer5 = #1#13;
     numerica8  = #1#14;    alfanumer6 = #1#15;   numerica9  = #1#16;
     numerica10 = #1#17;    fechas1    = #1#18;   numerica11 = #1#19;
     numerica12 = #1#20;    alfanumer7 = #1#21;   alfanumer8 = #1#22;
     numerica13 = #1#23;    numerica14 = #1#24;   numerica15 = #1#25;
     numerica16 = #1#26;    numerica17 = #1#27;   numerica18 = #1#28;
     numerica19 = #1#29;    numerica20 = #1#30;   alfanumer9 = #1#31;
     numerica21 = #1#32;    numerica22 = #1#33;   fechas2    = #1#34;
     numerica23 = #1#35;    numerica24 = #1#36;   numerica25 = #1#37;
     fechas3    = #1#38;    fechas4    = #1#39;   fechas5    = #1#40;
     numerica26 = #1#41;    numerica27 = #1#42;   numerica28 = #1#43;
     alfanumer10= #1#44;    alfanumer11= #1#45;   alfanumer12= #1#46;
     alfanumer13= #0#2;     numerica29 = #0#8;    numerica30 = #0#9;
     numerica31 = #0#10;    numerica32 = #0#11;   numerica33 = #0#12;
     numerica34 = #0#13;    numerica35 = #1#47;   alfanumer14= #1#55;
     numerica36 = #1#56;    numerica37 = #1#59;   numerica38 = #1#66;
     numerica39 = #1#67;    numerica40 = #1#68;   numerica41 = #1#69;
     alfanumer15= #1#71;    alfanumer16= #1#72;


     |PUSHV 0803 0815;
     |ATRI R;  |PINTA 0803, "Capital Inmob";  |ATRI 0;
     |SUB_EJECUTA "repant02";
     |SI errorlin = 0;
         |ERROR;
     |SINO;
         |HAZ Carga;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO BajaPatrimonio;
     patr_00 = #1#0;
     patr_01 = #1#73;
     patr_02 = #1#74;
     |HAZ borra_pat;
|FPRC;

|PROCESO AltaPatrimonio;
     |SI #1#48 = "X"; |O #1#48 = "R"; |ACABA; |FINSI;
     |SI #1#31 ! "N";                 |ACABA; |FINSI;

     patr_09 = #1#8;
     |SI patr_09 < #1#17; patr_09 = #1#17;    |FINSI;
     |SI patr_09 < #1#19; patr_09 = #1#19;    |FINSI;
     |SI patr_09 = 0;     |ACABA;             |FINSI;

     anyos_p  = #1#16;
     tpro_p   = #1#15;
     patr_15  = #1#15;

     patr_00 = #1#0;
     |SI #1#4 = "U"; patr_01 = "A1"; |FINSI;
     |SI #1#4 = "R"; patr_01 = "B1"; |FINSI;

     patr_03 = #1#2;
     patr_04 = #1#3;
     patr_07 = #1#6;
     patr_08 = #1#7;
     patr_16 = #1#72;
     patr_18 = "";
     |SI patr_01 = "A1";
         patr_05 = #1#5;
         patr_18 = "V";
         |SI #1#13 ! "H";  patr_18 = "O";  |FINSI;
     |SINO;
         patr_10 = #1#12;
         patr_11 = #1#11;
     |FINSI;

     |HAZ graba_pat;
     #1#73 = patr_01;
     #1#74 = patr_02;
|FPRC;

|PROCESO Mayus2;
     #0Campo = #0Campo > #1Campo;
     |PINTA #0Campo;
|FPRC;

|PROCESO Perceptor;
     |ABRE #5;
     #5#0 = #0#0;
     |LEE 040#5=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #5;

     indivi = "S";
     |SI #5#30  ! "    ";  indivi = "N"; |FINSI;

     |SI #5#164 = "H"; |Y #5#68 ] "1981"; indivi = "N"; |FINSI;
     |SI #5#165 = "H"; |Y #5#69 ] "1981"; indivi = "N"; |FINSI;
     |SI #5#166 = "H"; |Y #5#70 ] "1981"; indivi = "N"; |FINSI;
     |SI #5#167 = "H"; |Y #5#71 ] "1981"; indivi = "N"; |FINSI;
     |SI #5#168 = "H"; |Y #5#72 ] "1981"; indivi = "N"; |FINSI;
     |SI #5#169 = "H"; |Y #5#73 ] "1981"; indivi = "N"; |FINSI;
     |SI #5#170 = "H"; |Y #5#74 ] "1981"; indivi = "N"; |FINSI;
     |SI #5#171 = "H"; |Y #5#75 ] "1981"; indivi = "N"; |FINSI;
     |SI #5#172 = "H"; |Y #5#76 ] "1981"; indivi = "N"; |FINSI;
     |SI #5#173 = "H"; |Y #5#77 ] "1981"; indivi = "N"; |FINSI;

     |C_M #0#8,  1, "N";  |C_M #0#9,  1, "N";  |C_M #0#10, 1, "N";
     |C_M #0#11, 1, "N";  |C_M #0#12, 1, "N";  |C_M #0#13, 1, "N";

                     #0#4 = "VARIOS   ";
     |SI #0#3 = "T"; #0#4 = "TITULAR   "; |FINSI;
     |SI #0#3 = "C"; #0#4 = "CONYUGE   "; |FINSI;
     |SI #0#3 = "G"; #0#4 = "GANANCIAL "; |FINSI;
     |SI #0#3 = "1"; #0#4 = "FAMILIARES"; |FINSI;
     |SI #0#3 = "2"; #0#4 = "FAMILIARES"; |FINSI;
     |SI #0#3 = "3"; #0#4 = "FAMILIARES"; |FINSI;
     |SI #0#3 = "4"; #0#4 = "FAMILIARES"; |FINSI;
     |SI #0#3 = "V";
         |SI indivi = "N";
             |CAMPO_MODIFICA #0#8,  1, "S";
             |CAMPO_MODIFICA #0#9,  1, "S";
             |CAMPO_MODIFICA #0#10, 1, "S";
             |CAMPO_MODIFICA #0#11, 1, "S";
             |CAMPO_MODIFICA #0#12, 1, "S";
             |CAMPO_MODIFICA #0#13, 1, "S";
         |SINO;
             |CAMPO_MODIFICA #0#8, 1, "S";
             #0#9  = 0; |PINTA #0#9;
             #0#10 = 0; |PINTA #0#10;
             #0#11 = 0; |PINTA #0#11;
             #0#12 = 0; |PINTA #0#12;
             #0#13 = 0; |PINTA #0#13;
         |FINSI;
     |SINO;
         #0#8  = 0; |PINTA #0#8;
         #0#9  = 0; |PINTA #0#9;
         #0#10 = 0; |PINTA #0#10;
         #0#11 = 0; |PINTA #0#11;
         #0#12 = 0; |PINTA #0#12;
         #0#13 = 0; |PINTA #0#13;
     |FINSI;

     |PINTA #0#4;
|FPRC;

|PROCESO Tipo;
     |SI #0#6 = "S";  #0#7 = "VIVIENDA";  |FINSI;
     |SI #0#6 = "N";  #0#7 = "OTROS";     |FINSI;
     |PINTA #0#7;
|FPRC;

|PROCESO AltaVivienda1;
     |ABRE #1;
     #1#0 = #0#0;
     #1#1 = #0#1;
     |LIBERA #1;
     |LEE 140#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         #1#0  = #0#0;
         #1#1  = #0#1;
         #1#2  = #0#3;
         #1#3  = #0#4;
         #1#5  = #0#5;
         #1#48 = #0#2;
         |GRABA 140#1b;
     |FINSI;

     |HAZ BajaPatrimonio;

     QueTipo    = (FEntrada / 100) ! 0;
     HContribu  = #1#0;
     HNombre    = nombre;
     HPrograma  = "(recapinm) CAPITAL INMOBILIARIO";
     HLinea     = #1#1;
     HPerceptor = #1#3;
     HRdto      = #1#47;

     |SI QueTipo = 1; HTipo = "ALTA FICHA";         |FINSI;
     |SI QueTipo = 2; HTipo = "MODIFICACION FICHA"; |FINSI;
     |SI QueTipo = 3; HTipo = "BAJA FICHA";         |FINSI;

     |SI QueTipo = 3; |Y ModoE ! 1;
         #1#0 = #0#0;
         #1#1 = #0#1;
         |BORRA 140#1c;
         |LIBERA #1;

         |HAZ AltaHistorico;
     |FINSI;
|FPRC;

|PROCESO AltaVivienda2;
     |HAZ AltaHistorico;
     |HAZ AltaPatrimonio;

     |GRABA 140#1a;
     |CIERRA #1;
|FPRC;

|PROCESO PonArte;
      MGeneral4    = "Inmueble   ";
      MGeneral5    = "Modelo 210 ";
      MGeneral6    = "Modelo 211 ";
      MGeneral7    = "Modelo 212 ";
      MGeneral8    = "Modelo 214 ";

      |ABRE #1;
      #1#0 = #0#0;
      #1#1 = #0#1;
      |LEE 040#1=;
      |SI FSalida = 0;  MGeneral4    = "Inmueble  *";  |FINSI;
      |CIERRA #1;

      |ABRE #900;
      #900#0 = #0#0;
      #900#1 = #0#1;
      |LEE 040#900=;
      |SI FSalida = 0;  MGeneral5    = "Modelo 210*";  |FINSI;
      |CIERRA #900;

      |ABRE #917;
      #917#0 = #0#0;
      #917#1 = #0#1;
      |LEE 040#917=;
      |SI FSalida = 0;  MGeneral6    = "Modelo 211*";  |FINSI;
      |CIERRA #917;

      |ABRE #902;
      #902#0 = #0#0;
      #902#1 = #0#1;
      |LEE 040#902=;
      |SI FSalida = 0;  MGeneral7    = "Modelo 212*";  |FINSI;
      |CIERRA #902;

      |ABRE #904;
      #904#0 = #0#0;
      #904#1 = #0#1;
      |LEE 040#904=;
      |SI FSalida = 0;  MGeneral8    = "Modelo 214*";  |FINSI;
      |CIERRA #904;
|FPRC;

|PROCESO Borra916;
     |BORRA 020#916a;
     |LIBERA #916;
|FPRC;

|DEFBUCLE rem00016B;
     #916#1;
     ;
     #0#0, #0#1, " ", 00;
     #0#0, #0#1, "z", 99;
     be;
     NULL, Borra916;
|FIN;

|PROCESO Tipo2M02;  |TIPO 2;
     modelito = (FEntrada / 100) ! 0;
     ModoE    = 0 +. 1;

     |SI modelito = 3;
         |ABRE #1;    #001#0 = #0#0; #001#1 = #0#1; |BORRA 140#001c;  |LIBERA #001;  |CIERRA #001;
         |ABRE #900;  #900#0 = #0#0; #900#1 = #0#1; |BORRA 140#900c;  |LIBERA #900;  |CIERRA #900;
         |ABRE #902;  #902#0 = #0#0; #902#1 = #0#1; |BORRA 140#902c;  |LIBERA #902;  |CIERRA #902;
         |ABRE #904;  #904#0 = #0#0; #904#1 = #0#1; |BORRA 140#904c;  |LIBERA #904;  |CIERRA #904;
         |ABRE #917;  #917#0 = #0#0; #917#1 = #0#1; |BORRA 140#917c;  |LIBERA #917;  |CIERRA #917;
         |BUCLE rem00016B;
     |FINSI;

     |SI ModoE ! 1; |ACABA; |FINSI;

     |PUSHV 0501 2380;
     nSalir      = 0;
     |PARA;  |SI nSalir = 0;  |HACIENDO;
         nSalir = 1;
         |HAZ PonArte;
         |MENUG MGeneral;
         MGeneral2 = FSalida;
         |SI MGeneral2 ] 1; |Y MGeneral2 [ 5;
             |SI MGeneral2 = 1;
                 nSalir = 0;
                 |HAZ AltaVivienda1;
                 |HAZ Inmobiliario;
                 |HAZ AltaVivienda2;
             |FINSI;
             Modelo = 0;
             |SI MGeneral2 = 2; nSalir = 0;  |HAZ Modelo210;    |FINSI;
             |SI MGeneral2 = 3; nSalir = 0;  |HAZ Modelo211;    |FINSI;
             |SI MGeneral2 = 4; nSalir = 0;  |HAZ Modelo212;    |FINSI;
             |SI MGeneral2 = 5; nSalir = 0;  |HAZ Modelo214;    |FINSI;
         |FINSI;
     |SIGUE;
     |POPV;
|FPRC;

|PROCESO Tipo11;  |TIPO 7;
      MGeneral4    = "Inmueble   ";
      MGeneral5    = "Modelo 210 ";
      MGeneral6    = "Modelo 211 ";
      MGeneral7    = "Modelo 212 ";
      MGeneral8    = "Modelo 214 ";

      |ABRE #1;
      #1#0 = #0#0;
      #1#1 = #0#1;
      |LEE 040#1=;
      |SI FSalida = 0;  MGeneral4    = "Inmueble  *";  |FINSI;
      |CIERRA #1;

      |ABRE #900;
      #900#0 = #0#0;
      #900#1 = #0#1;
      |LEE 040#900=;
      |SI FSalida = 0;  MGeneral5    = "Modelo 210*";  |FINSI;
      |CIERRA #900;

      |ABRE #917;
      #917#0 = #0#0;
      #917#1 = #0#1;
      |LEE 040#917=;
      |SI FSalida = 0;  MGeneral6    = "Modelo 211*";  |FINSI;
      |CIERRA #917;

      |ABRE #902;
      #902#0 = #0#0;
      #902#1 = #0#1;
      |LEE 040#902=;
      |SI FSalida = 0;  MGeneral7    = "Modelo 212*";  |FINSI;
      |CIERRA #902;

      |ABRE #904;
      #904#0 = #0#0;
      #904#1 = #0#1;
      |LEE 040#904=;
      |SI FSalida = 0;  MGeneral8    = "Modelo 214*";  |FINSI;
      |CIERRA #904;

     |PINTA 1664, MGeneral4;
     |PINTA 1764, MGeneral5;
     |PINTA 1864, MGeneral6;
     |PINTA 1964, MGeneral7;
     |PINTA 2064, MGeneral8;
|FPRC;

 **********************************************************************
 PROCESOS DEL MANTENIMIENTO 210
 **********************************************************************

 PROCESOS PROPIOS DEL PROGRAMA rem00003

|PROCESO CargaDatos901;
     |PARA Campo1 = 1;  |SI Campo1 [ 17;  |HACIENDO Campo1 = Campo1 + 1;
           |C_M #901Campo1, 1, "S";
           |C_V #901Campo1, 1, "S";
     |SIGUE;

     |DDEFECTO #901;
     |SI CampoTrabajo = 2;
         #901#0  = "Sujeto pasivo, Representante o Responsable solidario (1)";
         |PARA Campo1 = 1;  |SI Campo1 [ 14;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 14;
               #901Campo1  = #900Campo2;
         |SIGUE;
         |C_M #901#15, 1, "N";  |C_V #901#15, 1, "N";  #901#15 = "";
         |C_M #901#16, 1, "N";  |C_V #901#16, 1, "N";  #901#16 = "";
         |C_M #901#17, 1, "N";  |C_V #901#17, 1, "N";  #901#17 = 0;
     |FINSI;

     |SI CampoTrabajo = 4;
         Valfa   = ("Sujeto pasivo " + (" " * 52)) % 152;
         #901#0  = Valfa;
         #901#1  = #900#29;
         #901#2  = #900#30;
         #901#3  = #900#31;
         #901#15 = #900#32;
         #901#16 = #900#33;
         #901#17 = #900#34;
         #901#5  = #900#35;
         #901#13 = #900#36;

         |C_M #901#4,  1, "N";  |C_V #901#4,  1, "N";
         |C_M #901#6,  1, "N";  |C_V #901#6,  1, "N";
         |C_M #901#7,  1, "N";  |C_V #901#7,  1, "N";
         |C_M #901#8,  1, "N";  |C_V #901#8,  1, "N";
         |C_M #901#9,  1, "N";  |C_V #901#9,  1, "N";
         |C_M #901#10, 1, "N";  |C_V #901#10, 1, "N";
         |C_M #901#11, 1, "N";  |C_V #901#11, 1, "N";
         |C_M #901#12, 1, "N";  |C_V #901#12, 1, "N";
         |C_M #901#14, 1, "N";  |C_V #901#14, 1, "N";
     |FINSI;

     |SI CampoTrabajo = 5;
         Valfa   = ("Representante del Sujeto pasivo" + (" " * 52)) % 152;
         #901#0  = Valfa;
         |PARA Campo1 = 1;  |SI Campo1 [ 14;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 36;
               #901Campo1  = #900Campo2;
         |SIGUE;
         |C_M #901#15, 1, "N";  |C_V #901#15, 1, "N";  #901#15 = "";
         |C_M #901#16, 1, "N";  |C_V #901#16, 1, "N";  #901#16 = "";
         |C_M #901#17, 1, "N";  |C_V #901#17, 1, "N";  #901#17 = 0;
     |FINSI;

     |SI CampoTrabajo = 6;
         Valfa   = ("Responsable solidario (Pagador)"+ (" " * 52)) % 152;
         #901#0  = Valfa;

         |PARA Campo1 = 1;  |SI Campo1 [ 9;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 50;
               #901Campo1  = #900Campo2;
         |SIGUE;

         |PARA Campo1 = 11;  |SI Campo1 [ 14; |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 49;
               #901Campo1  = #900Campo2;
         |SIGUE;

         |C_M #901#10, 1, "N";  |C_V #901#10, 1, "N";  #901#10 = "";
         |C_M #901#15, 1, "N";  |C_V #901#15, 1, "N";  #901#15 = "";
         |C_M #901#16, 1, "N";  |C_V #901#16, 1, "N";  #901#16 = "";
         |C_M #901#17, 1, "N";  |C_V #901#17, 1, "N";  #901#17 = 0;
     |FINSI;

     |SI CampoTrabajo = 7;
         Valfa   = ("Responsable solidario (Depositario)"+ (" " * 52)) % 152;
         #901#0  = Valfa;

         |PARA Campo1 = 1;  |SI Campo1 [ 9;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 63;
               #901Campo1  = #900Campo2;
         |SIGUE;

         |PARA Campo1 = 11;  |SI Campo1 [ 14; |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 62;
               #901Campo1  = #900Campo2;
         |SIGUE;

         |C_M #901#10, 1, "N";  |C_V #901#10, 1, "N";  #901#10 = "";
         |C_M #901#15, 1, "N";  |C_V #901#15, 1, "N";  #901#15 = "";
         |C_M #901#16, 1, "N";  |C_V #901#16, 1, "N";  #901#16 = "";
         |C_M #901#17, 1, "N";  |C_V #901#17, 1, "N";  #901#17 = 0;
     |FINSI;

     |SI CampoTrabajo = 8;
         Valfa   = ("Responsable solidario (Gestor)"+ (" " * 52)) % 152;
         #901#0  = Valfa;

         |PARA Campo1 = 1;  |SI Campo1 [ 9;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 76;
               #901Campo1  = #900Campo2;
         |SIGUE;

         |PARA Campo1 = 11;  |SI Campo1 [ 14; |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 75;
               #901Campo1  = #900Campo2;
         |SIGUE;

         |C_M #901#10, 1, "N";  |C_V #901#10, 1, "N";  #901#10 = "";
         |C_M #901#15, 1, "N";  |C_V #901#15, 1, "N";  #901#15 = "";
         |C_M #901#16, 1, "N";  |C_V #901#16, 1, "N";  #901#16 = "";
         |C_M #901#17, 1, "N";  |C_V #901#17, 1, "N";  #901#17 = 0;
     |FINSI;
|FPRC;

|PROCESO EntraDatos901;
     Valfa = #901#0;  |QBT Valfa;
     |SI Valfa = "";  |ACABA;  |FINSI;

     |PUSHV 0501 2380;
     |PINPA #0#901;
     |PINDA #0#901;
     |ENDATOS #1#901;
     |SI FSalida ! 0;  |POPV;  |ACABA;  |FINSI;

     |SI CampoTrabajo = 2;
         |PARA Campo1 = 1;  |SI Campo1 [ 14;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 14;
               #900Campo2 = #901Campo1;
         |SIGUE;
     |FINSI;

     |SI CampoTrabajo = 4;
         Valfa   = ("Sujeto pasivo " + (" " * 52)) % 152;
         #900#29 = #901#1;
         #900#30 = #901#2;
         #900#31 = #901#3;
         #900#32 = #901#15;
         #900#33 = #901#16;
         #900#34 = #901#17;
         #900#35 = #901#5;
         #900#36 = #901#13;
     |FINSI;

     |SI CampoTrabajo = 5;
         |PARA Campo1 = 1;  |SI Campo1 [ 14;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 36;
               #900Campo2 = #901Campo1;
         |SIGUE;
     |FINSI;

     |SI CampoTrabajo = 6;
         |PARA Campo1 = 1;  |SI Campo1 [ 9;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 50;
               #900Campo2 = #901Campo1;
         |SIGUE;

         |PARA Campo1 = 11;  |SI Campo1 [ 14;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 49;
               #900Campo2 = #901Campo1;
         |SIGUE;
     |FINSI;

     |SI CampoTrabajo = 7;
         |PARA Campo1 = 1;  |SI Campo1 [ 9;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 63;
               #900Campo2 = #901Campo1;
         |SIGUE;

         |PARA Campo1 = 11;  |SI Campo1 [ 14;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 62;
               #900Campo2 = #901Campo1;
         |SIGUE;
     |FINSI;

     |SI CampoTrabajo = 8;
         |PARA Campo1 = 1;  |SI Campo1 [ 9;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 76;
               #900Campo2 = #901Campo1;
         |SIGUE;

         |PARA Campo1 = 11;  |SI Campo1 [ 14;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 75;
               #900Campo2 = #901Campo1;
         |SIGUE;
     |FINSI;

     |POPV;
|FPRC;

|PROCESO CDatos900C90;
     |PUSHV 0501 2380;
     |D_CUADRO 1717, 2380;
     |BLANCO 1818 2279;
     |ATRI R;
     |PINTA 1818, "Descripcion                                                   ";
     |PINTA 2218, "Clave de Divisa :";

     |C_M #900#91, 1, "S";  |C_V #900#91, 1, "S";  |C_P #900#91, 1, 1918;
     |C_M #900#92, 1, "S";  |C_V #900#92, 1, "S";  |C_P #900#92, 1, 2018;
     |C_M #900#93, 1, "S";  |C_V #900#93, 1, "S";  |C_P #900#93, 1, 2118;
     |C_M #900#94, 1, "S";  |C_V #900#94, 1, "S";  |C_P #900#94, 1, 2236;

     |PINTA #900#91;  |PINTA #900#92;  |PINTA #900#93;  |PINTA #900#94;

     |ET Campo091;  |ENCAMPO #091#900;
                    |SI FSalida = 1;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo90;   |FINSI;

     |ET Campo092;  |ENCAMPO #092#900;
                    |SI FSalida = 1;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo091;  |FINSI;

     |ET Campo093;  |ENCAMPO #093#900;
                    |SI FSalida = 1;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo092;  |FINSI;

     |ET Campo094;  SwError = 0;
                    |ENCAMPO #094#900;
                    |SI FSalida = 1;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo90;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo093;  |FINSI;
                    |SI SwError = 1;  |VETE Campo094;  |FINSI;

     |ET Abajo90;

     |C_M #900#91, 1, "N";  |C_V #900#91, 1, "N";
     |C_M #900#92, 1, "N";  |C_V #900#92, 1, "N";
     |C_M #900#93, 1, "N";  |C_V #900#93, 1, "N";
     |C_M #900#94, 1, "N";  |C_V #900#93, 1, "N";

     |POPV;
|FPRC;

|PROCESO Divisas;
     Tecla = FSalida;
     |ABRET #8;

     |SI Tecla = 9;
         |PUSHV 0501 2380;
         #8#0 = #900#94;
         |LEE 040#8];
         |PINPA #0#8;
         |PINDA #0#8;
         |CONSULTA #1#8;
         |POPV;

         #900#94 = #8#0;  |PINTA #900#94;
     |FINSI;

     #8#0 = #900#94;
     |LEE 140#8=;
     |SI FSalida ! 0;
         |MENAV "     No existe el Codigo de Divisas";
         SwError = 1;
     |FINSI;
     |CIERRAT #8;
|FPRC;

|PROCESO CDatos900C95;
     |PUSHV 0501 2380;
     |D_CUADRO 1717, 2380;
     |BLANCO 1818 2279;
     |ATRI R;
     |PINTA 1818, "Tipo de renta: Clave  ";
     |PINTA 1918, "Referencia Catastral  ";
     |PINTA 2218, "Base Imponible ......:";

     |C_M #900#96, 1, "S";  |C_V #900#96, 1, "S";  |C_P #900#96, 1, 1841;
     |C_M #900#97, 1, "S";  |C_V #900#97, 1, "S";  |C_P #900#97, 1, 2018;
     |C_M #900#98, 1, "S";  |C_V #900#98, 1, "S";  |C_P #900#98, 1, 2241;

     |SI #900#98 = 0;
         #900#97 = #1#72;
         #900#98 = #1#47;
     |FINSI;

     |PINTA #900#96;  |PINTA #900#97;  |PINTA #900#98;

     |ET Campo096;  |ENCAMPO #096#900;
                    |SI FSalida = 1;  |VETE Abajo95;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo95;   |FINSI;

     |ET Campo097;  |ENCAMPO #097#900;
                    |SI FSalida = 1;  |VETE Abajo95;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo95;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo096;  |FINSI;

     |ET Campo098;  |ENCAMPO #098#900;
                    |SI FSalida = 1;  |VETE Abajo95;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo95;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo097;  |FINSI;

     |ET Abajo95;

     |C_M #900#96, 1, "N";  |C_V #900#96, 1, "N";
     |C_M #900#97, 1, "N";  |C_V #900#97, 1, "N";
     |C_M #900#98, 1, "N";  |C_V #900#98, 1, "N";

     |POPV;
|FPRC;

|PROCESO CDatos900C99;
     |PUSHV 0501 2380;
     |D_CUADRO 1817, 2380;
     |BLANCO 1918 2279;
     |ATRI R;
     |PINTA 1918, "Ingresos integros ...:";
     |PINTA 2018, "Gastos de personal ..:";
     |PINTA 2118, "Gtos.aprov.y mat.imp.:";
     |PINTA 2218, "Base imponible ......:";

     |C_M #900#100, 1, "S";  |C_V #900#100, 1, "S";  |C_P #900#100, 1, 1941;
     |C_M #900#101, 1, "S";  |C_V #900#101, 1, "S";  |C_P #900#101, 1, 2041;
     |C_M #900#102, 1, "S";  |C_V #900#102, 1, "S";  |C_P #900#102, 1, 2141;
                                                     |C_P #900#103, 1, 2241;

     |PINTA #900#100;  |PINTA #900#101;  |PINTA #900#102;  |PINTA #900#103;

     |ET Campo100;  |ENCAMPO #100#900;
                    |SI FSalida = 1;  |VETE Abajo99;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo99;   |FINSI;

     |ET Campo101;  |ENCAMPO #101#900;
                    |SI FSalida = 1;  |VETE Abajo99;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo99;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo100;  |FINSI;

     |ET Campo102;  |ENCAMPO #102#900;
                    |SI FSalida = 1;  |VETE Abajo99;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo99;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo101;  |FINSI;

     |ET Abajo99;

     |C_M #900#100, 1, "N";  |C_V #900#100, 1, "N";
     |C_M #900#101, 1, "N";  |C_V #900#101, 1, "N";
     |C_M #900#102, 1, "N";  |C_V #900#102, 1, "N";

     |POPV;
|FPRC;

|PROCESO Total103;
     #900#103 = #900#100 - #900#101 - #900#102;  |PINTA #900#103;
|FPRC;

|PROCESO CDatos900C104;
     |PUSHV 0501 2380;
     |D_CUADRO 1317, 2380;
     |BLANCO 1418 2279;
     |ATRI R;
     |PINTA 1418, "Acciones admitidas...:";
     |PINTA 1518, "Otros elementos .....:";
     |PINTA 1618, "Fecha de adquisicion :";
     |PINTA 1718, "Valor de Transmision :";
     |PINTA 1818, "Valor de adquisicion :";
     |PINTA 1918, "Diferencia ..........:";
     |PINTA 2018, "A¤os permanencia ....:";
     |PINTA 2118, "Incremento ..........:";
     |PINTA 2218, "Base imponible ......:";

     |C_M #900#105, 1, "S";  |C_V #900#105, 1, "S";  |C_P #900#105, 1, 1441;
     |C_M #900#106, 1, "S";  |C_V #900#106, 1, "S";  |C_P #900#106, 1, 1541;
     |C_M #900#107, 1, "S";  |C_V #900#107, 1, "S";  |C_P #900#107, 1, 1641;
     |C_M #900#108, 1, "S";  |C_V #900#108, 1, "S";  |C_P #900#108, 1, 1741;
     |C_M #900#109, 1, "S";  |C_V #900#109, 1, "S";  |C_P #900#109, 1, 1841;
                                                     |C_P #900#110, 1, 1941;
     |C_M #900#120, 1, "S";  |C_V #900#120, 1, "S";  |C_P #900#120, 1, 2041;
     |C_M #900#111, 1, "S";  |C_V #900#111, 1, "S";  |C_P #900#111, 1, 2141;
                                                     |C_P #900#112, 1, 2241;

     |PINTA #900#105;  |PINTA #900#106;  |PINTA #900#107;  |PINTA #900#108;
     |PINTA #900#109;  |PINTA #900#110;  |PINTA #900#111;  |PINTA #900#112;
     |PINTA #900#120;

     |ET Campo105;  |ENCAMPO #105#900;
                    |SI FSalida = 1;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo104;   |FINSI;

     |ET Campo106;  |ENCAMPO #106#900;
                    |SI FSalida = 1;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo105;   |FINSI;

     |ET Campo107;  |ENCAMPO #107#900;
                    |SI FSalida = 1;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo106;   |FINSI;

     |ET Campo108;  |ENCAMPO #108#900;
                    |SI FSalida = 1;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo107;   |FINSI;

     |ET Campo109;  |ENCAMPO #109#900;
                    |SI FSalida = 1;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo108;   |FINSI;

     |ET Campo120;  |ENCAMPO #120#900;
                    |SI FSalida = 1;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo109;   |FINSI;

     |ET Campo111;  |ENCAMPO #111#900;
                    |SI FSalida = 1;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 7;  |VETE Abajo104;   |FINSI;
                    |SI FSalida = 2;  |VETE Campo120;   |FINSI;


     |ET Abajo104;

     |C_M #900#105, 1, "N";  |C_V #900#105, 1, "N";
     |C_M #900#106, 1, "N";  |C_V #900#106, 1, "N";
     |C_M #900#107, 1, "N";  |C_V #900#107, 1, "N";
     |C_M #900#108, 1, "N";  |C_V #900#108, 1, "N";
     |C_M #900#109, 1, "N";  |C_V #900#109, 1, "N";
     |C_M #900#111, 1, "N";  |C_V #900#111, 1, "N";
     |C_M #900#120, 1, "N";  |C_V #900#120, 1, "N";

     |POPV;
|FPRC;

|PROCESO Total112;
     #900#110 = #900#108 - #900#109;   |PINTA #900#110;

     Coef  = 0;
     Vanyo = #900#120;
     |SI Vanyo ] 3;
         |SI #900#105 = "X"; Coef = (Vanyo - 2) * 25;     |FINSI;
         |SI #900#106 = "X"; Coef = (Vanyo - 2) * 14.28;  |FINSI;
     |FINSI;
     |SI Coef > 99; Coef = 100; |FINSI;
     |SI Coef [ 100;
         #900#111 = #900#110 % (100 - Coef);
     |SINO;
         #900#111 = 0;
     |FINSI;

     #900#112 = #900#111;              |PINTA #900#112;
|FPRC;

|PROCESO ModelosX;
     |C_M #900#95,  1, "S";
     |C_M #900#99,  1, "S";
     |C_M #900#104, 1, "S";

     |SI #0#6 = "S";
         #900#99  = " ";  |PINTA #900#99;   |C_M #900#99,   1, "N";
         #900#104 = " ";  |PINTA #900#104;  |C_M #900#104,  1, "N";
         |PDEFECTO #900, 100, 104;
         |PDEFECTO #900, 105, 112;
     |SINO;
         #900#95  = " ";  |PINTA #900#95;   |C_M #900#95,   1, "N";
         |PDEFECTO #900, 96,  99;
     |FINSI;

     |SI #900#95  = "X";
         #900#99  = " ";  |PINTA #900#99;   |C_M #900#99,   1, "N";
         #900#104 = " ";  |PINTA #900#104;  |C_M #900#104,  1, "N";
         |PDEFECTO #900, 100, 104;
         |PDEFECTO #900, 105, 112;
     |FINSI;

     |SI #900#99  = "X";
         #900#95  = " ";  |PINTA #900#95;   |C_M #900#95,   1, "N";
         #900#104 = " ";  |PINTA #900#104;  |C_M #900#104,  1, "N";
         |PDEFECTO #900, 96,  99;
         |PDEFECTO #900, 105, 112;
     |FINSI;

     |SI #900#104 = "X";
         #900#95  = " ";  |PINTA #900#95;   |C_M #900#95,   1, "N";
         #900#99  = " ";  |PINTA #900#99;   |C_M #900#99,   1, "N";
         |PDEFECTO #900, 96,  99;
         |PDEFECTO #900, 100, 104;
     |FINSI;
|FPRC;

|PROCESO Mayus3;
     CampoTrabajo = Campo;
     #900Campo = #900Campo > #900Campo;
     |PINTA #900Campo;

     |SI Campo ] 105;  |ACABA;  |FINSI;

     |SI Contenido = "X";  |Y #900Campo = " ";
         |CONFI "2400NEstas seguros de desactivar el apartado : ";
         |SI FSalida ! 0;
             #900Campo = "X";  |PINTA #900Campo;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #900Campo = " ";
         |SI Campo = 2;    |PDEFECTO #900, 15,  29;   |FINSI;
         |SI Campo = 4;    |PDEFECTO #900, 29,  37;   |FINSI;
         |SI Campo = 5;    |PDEFECTO #900, 37,  51;   |FINSI;
         |SI Campo = 6;    |PDEFECTO #900, 51,  64;   |FINSI;
         |SI Campo = 7;    |PDEFECTO #900, 64,  77;   |FINSI;
         |SI Campo = 8;    |PDEFECTO #900, 77,  90;   |FINSI;
         |SI Campo = 90;   |PDEFECTO #900, 91,  95;   |FINSI;
         |SI Campo = 95;   |PDEFECTO #900, 96,  99;   |FINSI;
         |SI Campo = 99;   |PDEFECTO #900, 100, 104;  |FINSI;
         |SI Campo = 104;  |PDEFECTO #900, 105, 112;  |FINSI;
         |ACABA;
     |FINSI;

     |SI #900Campo ! "I";  |ACABA;  |FINSI;

     |SI Campo [ 8;
         |HAZ CargaDatos901;
         |HAZ EntraDatos901;
     |FINSI;

     |SI Campo = 90; |HAZ CDatos900C90;   |FINSI;

     #900Campo = "X";  |PINTA #900Campo;

     |SI Campo = 95;
         |SI #0#6 = "S";
             |HAZ CDatos900C95;
              #900Campo = "X";  |PINTA #900Campo;
         |SINO;
              #900Campo = " ";  |PINTA #900Campo;
         |FINSI;
     |FINSI;

     |SI Campo = 99;
         |SI #0#6 = "N";
             |HAZ CDatos900C99;
              #900Campo = "X";  |PINTA #900Campo;
         |SINO;
              #900Campo = " ";  |PINTA #900Campo;
         |FINSI;
     |FINSI;

     |SI Campo = 104;
         |SI #0#6 = "N";
             |HAZ CDatos900C104;
              #900Campo = "X";  |PINTA #900Campo;
         |SINO;
              #900Campo = " ";  |PINTA #900Campo;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Total117;
     Base = #900#98 + #900#103 + #900#112;
     |SI #900#95  = "X";  #900#114 = (Base * #900#113) / 100;  |FINSI;
     |SI #900#99  = "X";  #900#114 = (Base * #900#113) / 100;  |FINSI;
     |SI #900#104 = "X";  #900#114 = (Base * #900#113) / 100;  |FINSI;
     |PINTA #900#114;

     #900#117 = #900#114 - #900#115 - #900#116;  |PINTA #900#117;

     Valfa   = (#900#113 + "     ") % 105;
     Posi    = 0;
     Valfa0  = "";
     Valfa1  = "";
     Valfa2  = "";
     SwPunto = 0;
     |PARA XPara = 1;  |SI XPara [ 5;  |HACIENDO XPara = XPara + 1;
           Posi   = (100 * XPara) + 1;
           Valfa0 = Valfa % Posi;
           |SI Valfa0 = "."; SwPunto = 1;  |FINSI;
           |SI SwPunto = 0;
               |SI Valfa0 ! " "; |Y Valfa0 ! ".";
                   Valfa1 = Valfa1 + Valfa0;
               |FINSI;
           |FINSI;

           |SI SwPunto = 1;
               |SI Valfa0 ! " "; |Y Valfa0 ! ".";
                   Valfa2 = Valfa2 + Valfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     #900#118 = Valfa1;
     #900#119 = Valfa2;
|FPRC;

|PROCESO Modelo210;
     |PUSHV 0501 2380;
     |ABRE #900;
     #900#0 = #0#0;
     #900#1 = #0#1;
     |LIBERA #900;
     |LEE 140#900=;
     FEstado = FSalida;
     QueTipo = 2;
     |SI FSalida ! 0;
         |DDEFECTO #900;
          #900#0 = #0#0;
          #900#1 = #0#1;
          |GRABA 140#900b;
          QueTipo = 1;
     |FINSI;

     |PINPA #0#900;
     |PINDA #0#900;
     |ENDATOS #1#900;
     |SI FSalida = 0;
         |SI #900#117 ! 0; |O #900#98 ! 0; |O #900#103 ! 0;  |O #900#112 ! 0;
             HContribu  = #0#0;
             HNombre    = #5#0;
             HPrograma  = "(rem00002) MODELO 210";
             HLinea     = #0#1;
             HPerceptor = #0#3;
             HRdto      = #900#117;
             |SI QueTipo = 1; HTipo = "ALTA FICHA";         |FINSI;
             |SI QueTipo = 2; HTipo = "MODIFICACION FICHA"; |FINSI;
             |HAZ AltaHistorico;
             |GRABA 140#900a;
         |SINO;
             HContribu  = #0#0;
             HNombre    = #5#0;
             HPrograma  = "(rem00002) MODELO 210";
             HLinea     = #0#1;
             HPerceptor = #0#3;
             HRdto      = #900#117;
             HTipo      = "BAJA FICHA"
             |HAZ AltaHistorico;
             |BORRA 140#900c;
         |FINSI;
     |SINO;
          |SI FEstado ! 0;  |BORRA 140#900c;  |FINSI;
     |FINSI;
     |CIERRA #900;
     |POPV;
|FPRC;

 **********************************************************************
 PROCESOS DEL MANTENIMIENTO 211
 **********************************************************************

|PROCESO CargaInmueble;
|FPRC;

|PROCESO Graba916;
     |DDEFECTO #916;
     #916#0 = #0#0;
     #916#1 = #0#1;
     #916#2 = "T";
     #916#3 = nLinea;
     #916#6 = "O";
     |SI nCoefi ! 100;  #916#6 = "C";  |FINSI;
     #916#7  = nCoefi;
     #916#9  = #5#6;
     #916#10 = #5#7;
     #916#11 = #5#8;
     #916#12 = #5#9;
     #916#13 = #5#10;
     #916#14 = #5#11;
     #916#15 = #5#12;
     #916#16 = #5#13;
     #916#17 = #5#14;

     |ABRE #6;
     #6#0 = #916#15;
     #6#1 = #916#16;
     |LEE 040#6=;
     |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;
     |CIERRA #6;

     #916#18 = #6#2;
     #916#19 = #5#193;

     |SI aTipo = "T";
         #916#4 = #5#2;
         #916#8 = #5#1;
     |FINSI;

     |SI aTipo = "C";
         #916#4  = #5#29;
         #916#8  = #5#28;
     |FINSI;

     |GRABA 020#916n;
     |LIBERA #916;

     |ABRE #917;
     #917#0 = #916#0;
     #917#1 = #916#1;
     |LEE 101#917=;
     |SI FSalida ! 0;
         |DDEFECTO #917;
         #917#0 = #916#0;
         #917#1 = #916#1;
         |GRABA 020#917b;
     |FINSI;
     |SI #916#2 = "A";  #917#33 = #917#33 + 1; |FINSI;
     |SI #916#2 = "T";  #917#34 = #917#34 + 1; |FINSI;
     |GRABA 020#917a;
     |LIBERA #917;
     |CIERRA #917;
|FPRC;

|PROCESO AltaT;
     |SI #0#3 ! "T";  |Y #0#3 ! "C";  |Y #0#3 ! "G";  |ACABA;  |FINSI;

     |ABRE #916;
     #916#0 = #0#0;
     #916#1 = #0#1;
     #916#2 = "T";
     #916#3 = 99;
     |LEE 040#916];
     |SI FSalida = 0;
         |LEE 040#916a;
     |SINO;
         |LEE 040#916u;
     |FINSI;

     |SI FSalida = 0; |Y #916#0 = #0#0;  |Y #916#1 = #0#1;  |Y #916#2 = "T";
         |CIERRA #916;
         |ACABA;
     |FINSI;

     |SI #0#3 = "G";
         nLinea = 1;
         aTipo  = "T";
         nCoefi = 50;
         |HAZ Graba916;

         nLinea = 2;
         aTipo  = "C";
         nCoefi = 50;
         |HAZ Graba916;
     |SINO;
         nLinea = 1;
         aTipo  = #0#3;
         nCoefi = 100;
         |HAZ Graba916;
     |FINSI;

     |CIERRA #916;
|FPRC;

|RUTINA ClaveBaja916;
     #916#0 = #0#0;
     #916#1 = #0#1;
     #916#2 = aClave;
     #916#3 = 01;
|FRUT;

|RUTINA ClaveAlta916;
     #916#0 = #0#0;
     #916#1 = #0#1;
     #916#2 = aClave;
     #916#3 = 99;
|FRUT;

|PROCESO El916;
     |PUSHV 0501 2380;
     |PINPA #0#916;
     |ATRI R;
     |SI aClave = "A";  |PINTA 1622, "Adquirentes  ";  |FINSI;
     |SI aClave = "T";  |PINTA 1622, "Transmitentes";  |HAZ AltaT;  |FINSI;
     |ATRI r;

     |ENTLINEAL #1#916, 4, 2, 21, 0, ClaveBaja916, ClaveAlta916;

     |POPV;
|FPRC;

|PROCESO CargaDatos211;
     |ABRE #6;
     #6#0 = #1#6;
     #6#1 = #1#7;
     |LEE 040#6=;
     |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;
     |CIERRA #6;

     |ABRE #7;
     #7#0 = #5#44;
     |LEE 040#7=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #7;

     #917#3  = #1#5;
     #917#8  = #1#6;
     #917#9  = #1#7;
     #917#10 = #6#3;
     #917#11 = #6#2;
     #917#16 = #1#72;
     #917#17 = #7#2;
     #917#18 = #7#1;
     #917#20 = #7#3;
     #917#21 = #7#4;
     #917#25 = #7#9;
     #917#26 = #7#5;
     #917#27 = #7#6;
     #917#28 = #7#7;
     #917#29 = #7#8;
     #917#30 = #1#34;
     #917#31 = #1#35;
     #917#32 = #917#31 % 5;
|FPRC;

|PROCESO El917;
     |PUSHV 0501 2380;
     |ABRE #917;
     #917#0 = #0#0;
     #917#1 = #0#1;
     |LIBERA #917;
     |LEE 140#917=;
     FEstado = FSalida;
     QueTipo = 2;
     |SI FSalida ! 0;
          |DDEFECTO #917;
          #917#0 = #0#0;
          #917#1 = #0#1;
          |HAZ CargaDatos211;
          |GRABA 140#917b;
          QueTipo = 1;
     |SINO;
          |SI #917#32 = 0;
              QueTipo = 1;
              |HAZ CargaDatos211;
          |FINSI;
     |FINSI;

     |PINPA #0#917;
     |PINDA #0#917;
     |SI QueTipo = 2;
         |CONFI "2400NDesea Actualizar Datos S/N : ";
         |SI FSalida = 0;
             |HAZ CargaDatos211;
             |PINDA #0#917;
         |FINSI;
     |FINSI;

     |ENDATOS #1#917;
     |SI FSalida = 0;
         |SI #917#32 ! 0;
             HContribu  = #0#0;
             HNombre    = #5#0;
             HPrograma  = "(rem00017) MODELO 211";
             HLinea     = #0#1;
             HPerceptor = #0#3;
             HRdto      = #917#32;
             |SI QueTipo = 1; HTipo = "ALTA FICHA";         |FINSI;
             |SI QueTipo = 2; HTipo = "MODIFICACION FICHA"; |FINSI;
             |HAZ AltaHistorico;
             |GRABA 140#917a;
         |SINO;
             HContribu  = #0#0;
             HNombre    = #5#0;
             HPrograma  = "(rem00017) MODELO 211";
             HLinea     = #0#1;
             HPerceptor = #0#3;
             HRdto      = #917#32;
             HTipo      = "BAJA FICHA"
             |HAZ AltaHistorico;
             |BORRA 140#917c;
         |FINSI;
     |SINO;
          |SI FEstado ! 0;  |BORRA 140#917c;  |FINSI;
     |FINSI;
     |CIERRA #917;
     |POPV;
|FPRC;

|PROCESO Modelo211;
     |SI #0#6  = "N";  |ACABA;  |FINSI;

     |ABRE #5;
     #5#0 = #0#0;
     |LEE 040#5=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #5;

     |ABRE #1;
     #1#0 = #0#0;
     #1#1 = #0#1;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |SI #1#31 ! "S";  |ACABA;  |FINSI;

     |PUSHV 0501 2380;
     |BLANCO 1454 2279;

     |ATRI R;
     |PINTA 1454, "        MODELO 211        ";
     |ATRI r;

     nSalir1 = 0;
     |PARA;  |SI nSalir1 = 0;  |HACIENDO;
         nSalir1 = 1;
         |HAZ PonArte;
         |MENUG M211Mod;
         M211Mod2 = FSalida;
         |SI M211Mod2 ] 1; |Y M211Mod2 [ 3;
             |SI M211Mod2 = 1;  aClave = "A";  |HAZ El916; nSalir1 = 0;  |FINSI;
             |SI M211Mod2 = 2;  aClave = "T";  |HAZ El916; nSalir1 = 0;  |FINSI;
             |SI M211Mod2 = 3;                 |HAZ El917; nSalir1 = 0;  |FINSI;
         |FINSI;
     |SIGUE;
     |POPV;
|FPRC;

 **********************************************************************
 PROCESOS DEL MANTENIMIENTO 212
 **********************************************************************

|PROCESO CDatos902C3;
     |PUSHV 0501 2380;

     |PARA Campo1 = 1;  |SI Campo1 [ 22;  |HACIENDO Campo1 = Campo1 + 1;
           |C_M #903Campo1, 1, "N";
           |C_V #903Campo1, 1, "N";
     |SIGUE;

     |DDEFECTO #903;

     #903#0  = "Sujeto Pasivo";
     #903#1  = #902#7;                          |C_V #903#1,  1, "S";
     #903#2  = #902#8;                          |C_V #903#2,  1, "S";
     #903#3  = #902#9;                          |C_V #903#3,  1, "S";
     #903#5  = #902#12;  |C_M #903#5,  1, "S";  |C_V #903#5,  1, "S";
     #903#11 = #902#13;  |C_M #903#11, 1, "S";  |C_V #903#11, 1, "S";
     #903#12 = #902#14;  |C_M #903#12, 1, "S";  |C_V #903#12, 1, "S";
     #903#13 = #902#15;  |C_M #903#13, 1, "S";  |C_V #903#13, 1, "S";
     #903#14 = #902#16;  |C_M #903#14, 1, "S";  |C_V #903#14, 1, "S";
     #903#15 = #902#10;  |C_M #903#15, 1, "S";  |C_V #903#15, 1, "S";
     #903#16 = #902#11;  |C_M #903#16, 1, "S";  |C_V #903#16, 1, "S";
     #903#17 = #902#17;  |C_M #903#17, 1, "S";  |C_V #903#17, 1, "S";

     |PINPA #0#903;
     |PINDA #0#903;
     |BLANCO 2011 2279;
     |ENDATOS #1#903;
     |SI FSalida = 0;
         #902#12 = #903#5;
         #902#16 = #903#14;
         #902#10 = #903#15;
         #902#11 = #903#16;
         #902#17 = #903#17;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO CDatos902C82;
     |PUSHV 0501 2380;

     |PARA Campo1 = 1;  |SI Campo1 [ 22;  |HACIENDO Campo1 = Campo1 + 1;
           |C_M #903Campo1, 1, "N";
           |C_V #903Campo1, 1, "N";
     |SIGUE;

     |DDEFECTO #903;

     #903#0  = "Conyuge      ";
     #903#1  = #902#18;                         |C_V #903#1,  1, "S";
     #903#2  = #902#8;                          |C_V #903#2,  1, "S";
     #903#3  = #902#19;                         |C_V #903#3,  1, "S";
     #903#5  = #902#12;                         |C_V #903#5,  1, "S";
     #903#11 = #902#13;                         |C_V #903#11, 1, "S";
     #903#12 = #902#14;                         |C_V #903#12, 1, "S";
     #903#13 = #902#15;                         |C_V #903#13, 1, "S";
     #903#14 = #902#16;                         |C_V #903#14, 1, "S";
     #903#15 = #902#20;  |C_M #903#15, 1, "S";  |C_V #903#15, 1, "S";
     #903#16 = #902#11;                         |C_V #903#16, 1, "S";
     #903#17 = #902#21;  |C_M #903#17, 1, "S";  |C_V #903#17, 1, "S";

     |PINPA #0#903;
     |PINDA #0#903;
     |ENDATOS #1#903;
     |BLANCO 2011 2279;
     |SI FSalida = 0;
         #902#20 = #903#15;
         #902#21 = #903#17;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO CDatos902C4;
     |PUSHV 0501 2380;
     |DDEFECTO #903;

     #903#0  = "Representante";
     |PARA Campo1 = 1;  |SI Campo1 [ 22;  |HACIENDO Campo1 = Campo1 + 1;
           |C_M #903Campo1, 1, "N";
           |C_V #903Campo1, 1, "N";
     |SIGUE;

     |PARA Campo1 = 1;  |SI Campo1 [ 9;  |HACIENDO Campo1 = Campo1 + 1;
           Campo2 = Campo1 + 21;
           #903Campo1  = #902Campo2;
           |C_M #903Campo1, 1, "S";  |C_V #903Campo1, 1, "S";
     |SIGUE;

     #903#10 = #902#83;  |C_M #903#10, 1, "S";  |C_V #903#10, 1, "S";
     #903#11 = #902#31;  |C_M #903#11, 1, "S";  |C_V #903#11, 1, "S";
     #903#12 = #902#32;  |C_M #903#12, 1, "S";  |C_V #903#12, 1, "S";
     #903#13 = #902#33;  |C_M #903#13, 1, "S";  |C_V #903#13, 1, "S";
     #903#14 = #902#34;  |C_M #903#14, 1, "S";  |C_V #903#14, 1, "S";

     |PINPA #0#903;
     |PINDA #0#903;
     |BLANCO 1811 1879;
     |BLANCO 2011 2279;
     |ENDATOS #1#903;
     |SI FSalida = 0;
         |PARA Campo1 = 1;  |SI Campo1 [ 9;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 21;
               #902Campo2  = #903Campo1;
         |SIGUE;

         #902#83 = #903#10;
         #902#31 = #903#11;
         #902#32 = #903#12;
         #902#33 = #903#13;
         #902#34 = #903#14;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO CDatos902C5;
     |PUSHV 0501 2380;
     |DDEFECTO #903;

     #903#0  = "Adquirente";
     |PARA Campo1 = 1;  |SI Campo1 [ 22;  |HACIENDO Campo1 = Campo1 + 1;
           |C_M #903Campo1, 1, "N";
           |C_V #903Campo1, 1, "N";
     |SIGUE;

     |PARA Campo1 = 1;  |SI Campo1 [ 9;  |HACIENDO Campo1 = Campo1 + 1;
           Campo2 = Campo1 + 34;
           #903Campo1  = #902Campo2;
           |C_M #903Campo1, 1, "S";  |C_V #903Campo1, 1, "S";
     |SIGUE;

     #903#11 = #902#44;  |C_M #903#11, 1, "S";  |C_V #903#11, 1, "S";
     #903#12 = #902#45;  |C_M #903#12, 1, "S";  |C_V #903#12, 1, "S";
     #903#13 = #902#46;  |C_M #903#13, 1, "S";  |C_V #903#13, 1, "S";
     #903#14 = #902#47;  |C_M #903#14, 1, "S";  |C_V #903#14, 1, "S";
     #903#17 = #902#48;  |C_M #903#17, 1, "S";  |C_V #903#17, 1, "S";

     |PINPA #0#903;
     |PINDA #0#903;
     |BLANCO 2011 2279;
     |ENDATOS #1#903;
     |SI FSalida = 0;
         |PARA Campo1 = 1;  |SI Campo1 [ 9;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 34;
               #902Campo2  = #903Campo1;
         |SIGUE;

         #902#44 = #903#11;
         #902#45 = #903#12;
         #902#46 = #903#13;
         #902#47 = #903#14;
         #902#48 = #903#17;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO CDatos902C6;
     |PUSHV 0501 2380;
     |DDEFECTO #903;

     #903#0  = "Descripcion del Inmueble";
     |PARA Campo1 = 1;  |SI Campo1 [ 22;  |HACIENDO Campo1 = Campo1 + 1;
           |C_M #903Campo1, 1, "N";
           |C_V #903Campo1, 1, "N";
     |SIGUE;

     #903#4  = #902#49;  |C_M #903#4 , 1, "S";  |C_V #903#4 , 1, "S";
     #903#5  = #902#50;  |C_M #903#5 , 1, "S";  |C_V #903#5 , 1, "S";
     #903#6  = #902#51;  |C_M #903#6 , 1, "S";  |C_V #903#6 , 1, "S";
     #903#7  = #902#52;  |C_M #903#7 , 1, "S";  |C_V #903#7 , 1, "S";
     #903#8  = #902#53;  |C_M #903#8 , 1, "S";  |C_V #903#8 , 1, "S";
     #903#9  = #902#54;  |C_M #903#9 , 1, "S";  |C_V #903#9 , 1, "S";
     #903#11 = #902#55;  |C_M #903#11, 1, "S";  |C_V #903#11, 1, "S";
     #903#12 = #902#56;  |C_M #903#12, 1, "S";  |C_V #903#12, 1, "S";
     #903#13 = #902#57;  |C_M #903#13, 1, "S";  |C_V #903#13, 1, "S";
     #903#14 = #902#58;  |C_M #903#14, 1, "S";  |C_V #903#14, 1, "S";
     #903#18 = #902#59;  |C_M #903#18, 1, "S";  |C_V #903#18, 1, "S";
     #903#19 = #902#60;  |C_M #903#19, 1, "S";  |C_V #903#19, 1, "S";
     #903#20 = #902#62;  |C_M #903#20, 1, "S";  |C_V #903#20, 1, "S";
     #903#21 = #902#61;  |C_M #903#21, 1, "S";  |C_V #903#21, 1, "S";
     #903#22 = #902#63;  |C_M #903#22, 1, "S";  |C_V #903#22, 1, "S";

     |PINPA #0#903;
     |PINDA #0#903;
     |BLANCO 1111 1379;
     |BLANCO 1811 1879;
     |ENDATOS #1#903;
     |SI FSalida = 0;
         #902#49 = #903#4;
         #902#50 = #903#5;
         #902#51 = #903#6;
         #902#52 = #903#7;
         #902#53 = #903#8;
         #902#54 = #903#9;
         #902#55 = #903#11;
         #902#56 = #903#12;
         #902#57 = #903#13;
         #902#58 = #903#14;
         #902#59 = #903#18;
         #902#60 = #903#19;
         #902#62 = #903#20;
         #902#61 = #903#21;
         #902#63 = #903#22;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO Mayus5;
     CampoTrabajo = Campo;
     #902Campo = #902Campo > #902Campo;
     |PINTA #902Campo;



     |SI Contenido = "X";  |Y #902Campo = " ";
         |CONFI "2400NEstas seguros de desactivar el apartado : ";
         |SI FSalida ! 0;
             #902Campo = "X";  |PINTA #902Campo;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #902Campo = " ";
         |SI Campo = 4;    |PDEFECTO #902, 22,  34;   |FINSI;
         |SI Campo = 5;    |PDEFECTO #902, 35,  48;   |FINSI;
         |SI Campo = 6;    |PDEFECTO #902, 49,  63;   |FINSI;
         |ACABA;
     |FINSI;

     |SI #902Campo ! "I";  |ACABA;  |FINSI;

     |SI Campo = 3;   |HAZ CDatos902C3;   |FINSI;
     |SI Campo = 82;  |HAZ CDatos902C82;  |FINSI;
     |SI Campo = 4;   |HAZ CDatos902C4;   |FINSI;
     |SI Campo = 5;   |HAZ CDatos902C5;   |FINSI;
     |SI Campo = 6;   |HAZ CDatos902C6;   |FINSI;

     #902Campo = "X";  |PINTA #902Campo;
|FPRC;

|PROCESO Amortizacion;
     HastaFec    = "31.12.1996";
     Valor1      = #1#17 + #1#20 - #1#33;
     Fecha       = HastaFec - #902#80;
     VAmortiza1  = (Fecha * #1#32) / 365;
     |SI VAmortiza1 > 100; VAmortiza1 = 100; |FINSI;
     VAmortiza1  = (VAmortiza1 * Valor1) / 100;

     VAmortiza = VAmortiza1;
|FPRC;

|PROCESO Tiempo;
     HastaFec = #902#2;
     Fecha    = (HastaFec - DesdeFec) / 365;

     Vanyo1   = HastaFec % -102;
     Vanyo2   = DesdeFec % -102;
     Vanyon1  = Vanyo1;
     Vanyon2  = Vanyo2;
     Fecha    = Vanyon1 - Vanyon2;

     |SI Vanyon1 [ 97;
                                       Coefi = 1;
         |SI DesdeFec = "31.12.1994";  Coefi = 1.083;  |FINSI;
         |SI Vanyo2 = 95;              Coefi = 1.083;  |FINSI;
         |SI Vanyo2 = 96;              Coefi = 1.035;  |FINSI;
         |SI Vanyo2 = 97;              Coefi = 1;      |FINSI;
         |SI Vanyo2 = 98;              Coefi = 1;      |FINSI;
         |SI Vanyo2 = 99;              Coefi = 1;      |FINSI;
         |SI Fecha < 1;                Coefi = 1;      |FINSI;
     |FINSI;

     |SI Vanyon1 = 98;
                                       Coefi = 1.020;
         |SI DesdeFec = "31.12.1994";  Coefi = 1.083;  |FINSI;
         |SI Vanyo2 = 95;              Coefi = 1.083;  |FINSI;
         |SI Vanyo2 = 96;              Coefi = 1.042;  |FINSI;
         |SI Vanyo2 = 97;              Coefi = 1.020;  |FINSI;
         |SI Vanyo2 = 98;              Coefi = 1;      |FINSI;
         |SI Vanyo2 = 99;              Coefi = 1;      |FINSI;
         |SI Fecha < 1;                Coefi = 1;      |FINSI;
     |FINSI;

     |SI Vanyon1 ] 99;
                                       Coefi = 1.038;
         |SI DesdeFec = "31.12.1994";  Coefi = 1.097;  |FINSI;
         |SI Vanyo2 = 95;              Coefi = 1.097;  |FINSI;
         |SI Vanyo2 = 96;              Coefi = 1.059;  |FINSI;
         |SI Vanyo2 = 97;              Coefi = 1.038;  |FINSI;
         |SI Vanyo2 = 98;              Coefi = 1.018;  |FINSI;
         |SI Vanyo2 = 99;              Coefi = 1;      |FINSI;
         |SI Fecha < 1;                Coefi = 1;      |FINSI;
     |FINSI;

    HastaFec  = "31.12.1996";
     Fecha    = (HastaFec - DesdeFec) / 365;
     Vanyo1   = HastaFec % -102;
     Vanyo2   = DesdeFec % -102;
     Vanyon1  = Vanyo1;
     Vanyon2  = Vanyo2;
     Fecha    = Vanyon1 - Vanyon2;

     Vanyo1 = HastaFec % 402;
     Vanyo2 = DesdeFec % 402;
     |SI Vanyo1 > Vanyo2;  Fecha = Fecha + 1;  |FINSI;

     |SI Vanyo1 = Vanyo2;
         Vanyo1 = HastaFec % 102;
         Vanyo2 = DesdeFec % 102;
          |SI Vanyo1 ] Vanyo2;  Fecha = Fecha + 1;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO IncroDismi;
     FechaCal = Fecha - 2;
     |SI FechaCal < 0; FechaCal = 0; |FINSI;


     Porce = FechaCal * 11.11;
     |SI Porce > 99; Porce = 100; |FINSI;

     VIncremento = (VIncroDismi - ((VIncroDismi * Porce) / 100)) ! 0;

     Porce = (#1#37 + #1#66) / (#1#35 - #1#36);
     |SI Porce > 1; Porce = 1; |FINSI;
     Exento = VIncremento * Porce;
     |SI Exento > VIncremento;  Exento = VIncremento;  |FINSI;
     |SI Exento < 0;  Exento = 0;  |FINSI;
|FPRC;

|PROCESO CalcuIrre;
     |SI FSalida ! 9;  |ACABA;  |FINSI;

     #902#2  = #1#34;
     #902#80 = #1#18;
     #902#81 = #1#38;
     |SI #902#2  = "01.01.1900";  #902#2  = "01.01.0000";  |FINSI;
     |SI #902#80 = "01.01.1900";  #902#80 = "01.01.0000";  |FINSI;
     |SI #902#81 = "01.01.1900";  #902#81 = "01.01.0000";  |FINSI;

     |HAZ Amortizacion;

     VAdquisicio = #1#17 + #1#20 - VAmortiza1;
     DesdeFec    = #902#80;
     HastaFec    = "31.12.1996";
     |HAZ Tiempo;

     #902#66     = #1#35 - #1#36;
     #902#68     = (#1#17  + #1#20 - VAmortiza1) * Coefi;
     #902#70     = #902#66 - #902#68;
     VIncroDismi = #902#70;
     |HAZ IncroDismi;
     #902#72     = VIncremento - Exento;

     |SI #1#41 ! 0;
         Adquisicio = #1#41  - VAmortiza1;
         DesdeFec   = #902#81;
         HastaFec   = "31.12.1996";
         |HAZ Tiempo;

         #902#67     =  #1#67;
         #902#69     =  (#1#41 - VAmortiza1) * Coefi;
         #902#71     = #902#67 - #902#69;
         VIncroDismi = #902#71;
         |HAZ IncroDismi;
         #902#73     = VIncremento - Exento;
     |FINSI;

     |PINTA #902#66;  |PINTA #902#67;  |PINTA #902#68;  |PINTA #902#69;
     |PINTA #902#70;  |PINTA #902#71;  |PINTA #902#72;  |PINTA #902#73;
     |PINTA #902#74;  |PINTA #902#75;  |PINTA #902#76;  |PINTA #902#77;
     |PINTA #902#78;  |PINTA #902#79;  |PINTA #902#2;

     |HAZ Total79;
|FPRC;

|PROCESO CargaDatos212;
     |ABRE #5;
     #5#0 = #0#0;
     |LEE 040#5=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #5;

     |ABRE #7;
     #7#0 = #5#44;
     |LEE 040#7=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #7;

     #902#3  = "X";
     #902#7  = #5#2;
     #902#8  = #5#192;
     #902#9  = #5#1;
     #902#12 = #5#7;
     #902#13 = #5#12;
     #902#14 = #5#13;
     #902#15 = #5#14;
     #902#18 = #5#29;
     #902#19 = #5#28;
     #902#63 = #1#72;

     #902#82 = " ";
     Valfa = #902#18;  |QBT Valfa;  |SI Valfa ! "";  #902#82 = "X";  |FINSI;
     Valfa = #902#19;  |QBT Valfa;  |SI Valfa ! "";  #902#82 = "X";  |FINSI;

     #902#22 = #7#2;
     #902#24 = #7#1;
     #902#26 = #7#3;
     #902#27 = #7#4;
     #902#83 = #7#9;
     #902#31 = #7#5;
     #902#32 = #7#6;
     #902#33 = #7#7;
     #902#34 = #7#8;

     #902#4 = " ";
     Valfa = #902#22;  |QBT Valfa;  |SI Valfa ! "";  #902#4 = "X";  |FINSI;
     Valfa = #902#24;  |QBT Valfa;  |SI Valfa ! "";  #902#4 = "X";  |FINSI;
|FPRC;

|PROCESO Total79;
     #902#74 = #902#72 + #902#73;             |PINTA #902#74;
     #902#76 = #902#74 % #902#75;             |PINTA #902#76;
     #902#79 = #902#76 - #902#77 - #902#78;   |PINTA #902#79;
|FPRC;

|PROCESO Modelo212;
     |SI #0#6  = "N";  |ACABA;  |FINSI;

     |ABRE #1;
     #1#0 = #0#0;
     #1#1 = #0#1;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |SI #1#31 ! "S";
         |ABRE #902;
         #902#0 = #0#0;
         #902#1 = #0#1;
         |BORRA 140#902c;
         |LIBERA #902;
         |CIERRA #902;
         |ACABA;
     |FINSI;

     |PUSHV 0501 2380;
     |ABRE #902;
     #902#0 = #0#0;
     #902#1 = #0#1;
     |LIBERA #902;
     |LEE 140#902=;
      FEstado = FSalida;
     QueTipo = 2;
     |SI FSalida ! 0;
         |DDEFECTO #902;
          #902#0 = #0#0;
          #902#1 = #0#1;
          |HAZ CargaDatos212;
          FSalida = 9;  |HAZ CalcuIrre;  FSalida = 0;
          |GRABA 140#902b;
          QueTipo = 1;
     |FINSI;

     |PINPA #0#902;
     |PINDA #0#902;
     |ENDATOS #1#902;
     |SI FSalida = 0;
         |SI #902#76 ! 0; |O #902#77 ! 0; |O #902#78 ! 0;  |O #900#79 ! 0;
             HContribu  = #0#0;
             HNombre    = #5#0;
             HPrograma  = "(rem00003) MODELO 212";
             HLinea     = #0#1;
             HPerceptor = #0#3;
             HRdto      = #902#79;
             |SI QueTipo = 1; HTipo = "ALTA FICHA";         |FINSI;
             |SI QueTipo = 2; HTipo = "MODIFICACION FICHA"; |FINSI;
             |HAZ AltaHistorico;
             |GRABA 140#902a;
         |SINO;
             HContribu  = #0#0;
             HNombre    = #5#0;
             HPrograma  = "(rem00003) MODELO 212";
             HLinea     = #0#1;
             HPerceptor = #0#3;
             HRdto      = #902#79;
             HTipo      = "BAJA FICHA"
             |HAZ AltaHistorico;
             |BORRA 140#902c;
         |FINSI;
     |SINO;
          |SI FEstado ! 0;  |BORRA 140#902c;  |FINSI;
     |FINSI;
     |CIERRA #902;
     |POPV;
|FPRC;

 **********************************************************************
 PROCESOS DEL MANTENIMIENTO 214
 **********************************************************************

|PROCESO CDatos904C3;
     |PUSHV 0501 2380;

     |PARA Campo1 = 1;  |SI Campo1 [ 22;  |HACIENDO Campo1 = Campo1 + 1;
           |C_M #903Campo1, 1, "N";
           |C_V #903Campo1, 1, "N";
     |SIGUE;

     aAlfa1 = #904#6;  |QBT aAlfa1;
     aAlfa2 = #904#7;  |QBT aAlfa2;
     |SI aAlfa1 = "";  |Y  aAlfa2 = "";
         |HAZ CargaDatos214;
     |FINSI;

     |DDEFECTO #903;

     #903#0  = "Sujeto Pasivo";
     #903#1  = #904#6;                          |C_V #903#1,   1, "S";
     #903#3  = #904#7;                          |C_V #903#3,   1, "S";
     #903#4  = #904#9;   |C_M #903#4,  1, "S";  |C_V #903#4,   1, "S";
     #903#5  = #904#10;  |C_M #903#5,  1, "S";  |C_V #903#5,   1, "S";
     #903#6  = #904#11;  |C_M #903#6,  1, "S";  |C_V #903#6,   1, "S";
     #903#7  = #904#12;  |C_M #903#7,  1, "S";  |C_V #903#7,   1, "S";
     #903#8  = #904#13;  |C_M #903#8,  1, "S";  |C_V #903#8,   1, "S";
     #903#9  = #904#14;  |C_M #903#9,  1, "S";  |C_V #903#9,   1, "S";
     #903#10 = #904#15;  |C_M #903#10, 1, "S";  |C_V #903#10,  1, "S";
     #903#11 = #904#16;  |C_M #903#11, 1, "S";  |C_V #903#11,  1, "S";
     #903#12 = #904#17;  |C_M #903#12, 1, "S";  |C_V #903#12,  1, "S";
     #903#13 = #904#18;  |C_M #903#13, 1, "S";  |C_V #903#13,  1, "S";
     #903#14 = #904#19;  |C_M #903#14, 1, "S";  |C_V #903#14,  1, "S";
     #903#16 = #904#8;   |C_M #903#16, 1, "S";  |C_V #903#16,  1, "S";

     |PINPA #0#903;
     |BLANCO 1843 1879;
     |BLANCO 2011 2279;
     |PINDA #0#903;
     |ENDATOS #1#903;
     |SI FSalida = 0;
         #904#8  = #903#16;
         #904#9  = #903#4;
         #904#10 = #903#5;
         #904#11 = #903#6;
         #904#12 = #903#7;
         #904#13 = #903#8;
         #904#14 = #903#9;
         #904#15 = #903#10;
         #904#16 = #903#11;
         #904#17 = #903#12;
         #904#18 = #903#13;
         #904#19 = #903#14;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO CDatos904C4;
     |PUSHV 0501 2380;
     |DDEFECTO #903;

     #903#0  = "Representante";
     |PARA Campo1 = 1;  |SI Campo1 [ 22;  |HACIENDO Campo1 = Campo1 + 1;
           |C_M #903Campo1, 1, "N";
           |C_V #903Campo1, 1, "N";
     |SIGUE;

     #903#1  = #904#45;  |C_M #903#1, 1, "S";  |C_V #903#1, 1, "S";
     |PARA Campo1 = 3;  |SI Campo1 [ 14;  |HACIENDO Campo1 = Campo1 + 1;
           Campo2 = Campo1 + 43;
           #903Campo1  = #904Campo2;
           |C_M #903Campo1, 1, "S";  |C_V #903Campo1, 1, "S";
     |SIGUE;

     |PINPA #0#903;
     |BLANCO 1811 1879;
     |BLANCO 2011 2279;
     |PINDA #0#903;
     |ENDATOS #1#903;
     |SI FSalida = 0;
         #902#45 = #902#45;
         |PARA Campo1 = 3;  |SI Campo1 [ 14;  |HACIENDO Campo1 = Campo1 + 1;
               Campo2 = Campo1 + 43;
               #904Campo2  = #903Campo1;
         |SIGUE;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO CDatos904C5;
     |PUSHV 0501 2380;
     |DDEFECTO #903;

     #903#0  = "Vivienda";
     |PARA Campo1 = 1;  |SI Campo1 [ 22;  |HACIENDO Campo1 = Campo1 + 1;
           |C_M #903Campo1, 1, "N";
           |C_V #903Campo1, 1, "N";
     |SIGUE;

     #903#4  = #904#33;  |C_M #903#4 , 1, "S";  |C_V #903#4 , 1, "S";
     #903#5  = #904#34;  |C_M #903#5 , 1, "S";  |C_V #903#5 , 1, "S";
     #903#6  = #904#35;  |C_M #903#6 , 1, "S";  |C_V #903#6 , 1, "S";
     #903#7  = #904#36;  |C_M #903#7 , 1, "S";  |C_V #903#7 , 1, "S";
     #903#8  = #904#37;  |C_M #903#8 , 1, "S";  |C_V #903#8 , 1, "S";
     #903#9  = #904#38;  |C_M #903#9 , 1, "S";  |C_V #903#9 , 1, "S";
     #903#11 = #904#40;  |C_M #903#11, 1, "S";  |C_V #903#11, 1, "S";
     #903#12 = #904#41;  |C_M #903#12, 1, "S";  |C_V #903#12, 1, "S";
     #903#13 = #904#42;  |C_M #903#13, 1, "S";  |C_V #903#13, 1, "S";
     #903#14 = #904#43;  |C_M #903#14, 1, "S";  |C_V #903#14, 1, "S";
     #903#22 = #904#44;  |C_M #903#22, 1, "S";  |C_V #903#22, 1, "S";
     #903#10 = #904#39;  |C_M #903#10, 1, "S";  |C_V #903#10, 1, "S";

     |PINPA #0#903;
     |PINDA #0#903;
     |BLANCO 1111 1379;
     |BLANCO 1811 1879;
     |ENDATOS #1#903;
     |SI FSalida = 0;
         #904#33 = #903#4;
         #904#34 = #903#5;
         #904#35 = #903#6;
         #904#36 = #903#7;
         #904#37 = #903#8;
         #904#38 = #903#9;
         #904#40 = #903#11;
         #904#41 = #903#12;
         #904#42 = #903#13;
         #904#43 = #903#14;
         #904#44 = #903#22;
         #904#39 = #903#10;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO Mayus7;
     CampoTrabajo = Campo;
     #904Campo = #904Campo > #904Campo;
     |PINTA #904Campo;

     |SI Contenido = "X";  |Y #904Campo = " ";
         |CONFI "2400NEstas seguros de desactivar el apartado : ";
         |SI FSalida ! 0;
             #904Campo = "X";  |PINTA #904Campo;

             |ACABA;
         |FINSI;
     |FINSI;

     |SI #904Campo = " ";
         |SI Campo = 3;    |PDEFECTO #904,  6,  20;   |FINSI;
         |SI Campo = 4;    |PDEFECTO #904, 45,  58;   |FINSI;
         |SI Campo = 5;    |PDEFECTO #904, 33,  45;   |FINSI;
         |ACABA;
     |FINSI;

     |SI #904Campo ! "I";  |ACABA;  |FINSI;

     |SI Campo = 3;   |HAZ CDatos904C3;   |FINSI;
     |SI Campo = 4;   |HAZ CDatos904C4;   |FINSI;
     |SI Campo = 5;   |HAZ CDatos904C5;   |FINSI;

     #904Campo = "X";  |PINTA #904Campo;
|FPRC;

|PROCESO CargaDatos214;
     |ABRE #5;
     #5#0 = #0#0;
     |LEE 040#5=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #5;

     |ABRE #7;
     #7#0 = #5#44;
     |LEE 040#7=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #7;

     #904#3  = "X";

     |SI #0#3 = "T"; |O #0#3 = "G";  |O #0#3 = "V";
         #904#6  = #5#2;
         #904#7  = #5#1;
     |FINSI;

     |SI #0#3 = "C";
         #904#6  = #5#29;
         #904#7  = #5#28;
     |FINSI;

     |SI #0#3 = "1";
         NFami = #5#98 + 47;  #904#6  = #5NFami;
         NFami = NFami + 10;  #904#7  = #5NFami;
     |FINSI;

     |SI #0#3 = "2";
         NFami = #5#99 + 47;  #904#6  = #5NFami;
         NFami = NFami + 10;  #904#7  = #5NFami;
     |FINSI;

     |SI #0#3 = "3";
         NFami = #5#100 + 47;  #904#6  = #5NFami;
         NFami = NFami  + 10;  #904#7  = #5NFami;
     |FINSI;

     |SI #0#3 = "4";
         NFami = #5#101 + 47;  #904#6  = #5NFami;
         NFami = NFami  + 10;  #904#7  = #5NFami;
     |FINSI;

     #904#9  = #5#6;
     #904#10 = #5#7;
     #904#11 = #5#8;
     #904#12 = #5#9;
     #904#13 = #5#10;
     #904#14 = #5#11;
     #904#15 = #5#15;
     #904#16 = #5#12;
     #904#17 = #5#13;
     #904#18 = #5#14;

     #904#45 = #7#2;
     #904#46 = #7#1;
     #904#48 = #7#3;
     #904#49 = #7#4;
     #904#53 = #7#9;
     #904#54 = #7#5;
     #904#55 = #7#6;
     #904#56 = #7#7;
     #904#57 = #7#8;

     #904#4 = " ";
     Valfa = #904#45;  |QBT Valfa;  |SI Valfa ! "";  #904#4 = "X";  |FINSI;
     Valfa = #904#46;  |QBT Valfa;  |SI Valfa ! "";  #904#4 = "X";  |FINSI;
|FPRC;

|PROCESO Patri214;
     |SI #4#15 = "S";
         |ABRE #10;
         #10#0  = #0#0;
         #10#28 = #0#3;
         |LEE 040#10=;
         |SI FSalida ! 0;  |DDEFECTO #10;  |FINSI;
         |CIERRA #10;

         #904#20 = #10#18;
         #904#21 = #10#19;
     |SINO;
         #904#20 = #1#8;
         |SI #904#20 < #1#17;  #904#20 = #1#17; |FINSI;
         |SI #904#20 < #1#19;  #904#20 = #1#19; |FINSI;
         |SI #904#20 = 0; |ACABA; |FINSI;
         #904#21 = #1#10 + #1#14 + #1#20;
     |FINSI;

     #904#22 = #904#20 - #904#21;
     |PARA Campo1 = 8;  |SI Campo1 ] 1; |HACIENDO  Campo1 = Campo1 - 1;
           Campo2 = Campo1 + 8;
           Campo3 = Campo1 + 16;
           |SI #904#22 > #9Campo1;
               #904#23 = #9Campo1;
               #904#25 = #9Campo2;
               #904#27 = #9Campo3;
               #904#24 = #904#22 - #904#23;
               #904#26 = #904#24 % #904#27;
               #904#28 = #904#25 + #904#26;
               |SAL;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Renta214;
     Valfa   = "01.01." + #904#2;
     FInicio = Valfa;
     |SI FInicio < #1#18;
         #904#29 = ((365 - (#1#18 - FInicio)) * #1#8) / 365;
     |SINO;
         #904#29 = #1#8;
     |FINSI;

     |SI #1#71 = "N";
         #904#29 = #904#29 % 2;
     |SINO;
         #904#29 = #904#29 % 1.1;
     |FINSI;

     #904#30 = 25;
     #904#31 = #904#29 % 25;
|FPRC;

|PROCESO Calcu214;
     |PDEFECTO #904, 20, 33;

     |SI #0#2 = "A";  |O #0#2 = "R";  |HAZ Renta214;  |FINSI;
     |SI #0#2 = "A";  |O #0#2 = "P";  |HAZ Patri214;  |FINSI;

     #904#32 = #904#28 + #904#31;

     |PINTA #904#20;  |PINTA #904#21;  |PINTA #904#22;
     |PINTA #904#23;  |PINTA #904#24;  |PINTA #904#25;
     |PINTA #904#26;  |PINTA #904#27;  |PINTA #904#28;
     |PINTA #904#29;  |PINTA #904#30;  |PINTA #904#31;
     |PINTA #904#32;
|FPRC;

|PROCESO Modelo214;
     |SI #0#6  = "N";  |ACABA;  |FINSI;

     |ABRE #4;
     |LEE 040#4p;
     |SI FSalida ! 0;  |DDEFECTO #4;  |FINSI;
     |CIERRA #4;

     |SI #4#15 = "S";
         |SI #0#3 ! "T";  |Y #0#3 ! "C";
             |MENAV "    Debe introducir como perceptor una <T> o una <C>";
             |ACABA;
         |FINSI;

         |ABRE #5;
         #5#0 = #0#0;
         |LEE 040#5=;
         |SI FSalida ! 0;  |DDEFECTO #5;  |FINSI;
         |CIERRA #5;

         |SI #5#142 ! "S";
             |MENAV "     Renta no calculada y no preparada.";
             |ACABA;
         |FINSI;
     |FINSI;

     |ABRE #1;
     #1#0 = #0#0;
     #1#1 = #0#1;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |SI #1#13 ! "H";  |O #1#31 = "S";
         |ABRE #904;
         #904#0 = #0#0;
         #904#1 = #0#1;
         |BORRA 140#904c;
         |LIBERA #904;
         |CIERRA #904;
         |ACABA;
     |FINSI;

     |ABRE #9;
     |LEE 040#9p;
     |SI FSalida ! 0;  |DDEFECTO #9;  |FINSI;
     |CIERRA #9;

     Modelo = 214;

     |PUSHV 0501 2380;
     |ABRE #904;
     #904#0 = #0#0;
     #904#1 = #0#1;
     |LIBERA #904;
     |LEE 140#904=;
     FEstado = FSalida;
     HTipo   = 2;
     |SI FSalida ! 0;
         |DDEFECTO #904;
          #904#0 = #0#0;
          #904#1 = #0#1;
          |HAZ CargaDatos214;
          |HAZ Calcu214;
          |GRABA 140#904b;
          HTipo   = 1;
     |FINSI;

     |PINPA #0#904;
     |PINDA #0#904;
     |ENDATOS #1#904;
     |SI FSalida = 0;
         |SI #904#32 ! 0; |O #904#28 ! 0; |O #904#31 ! 0;
             HContribu  = #0#0;
             HNombre    = #5#0;
             HPrograma  = "(rem00004) MODELO 214";
             HLinea     = #0#1;
             HPerceptor = #0#3;
             HRdto      = #904#32;
             |SI QueTipo = 1; HTipo = "ALTA FICHA";         |FINSI;
             |SI QueTipo = 2; HTipo = "MODIFICACION FICHA"; |FINSI;
             |HAZ AltaHistorico;
             |GRABA 140#904a;
         |SINO;
             HContribu  = #0#0;
             HNombre    = #5#0;
             HPrograma  = "(rem00004) MODELO 214";
             HLinea     = #0#1;
             HPerceptor = #0#3;
             HRdto      = #904#32;
             HTipo      = "BAJA FICHA"
             |HAZ AltaHistorico;
             |BORRA 140#904c;
         |FINSI;
     |SINO;
          |SI FEstado ! 0;  |BORRA 140#904c;  |FINSI;
     |FINSI;
     |CIERRA #904;
     |POPV;
|FPRC;

 **************************************
 PROCESOS PROPIOS DEL PROGRAMA rew00006
 **************************************

|PROCESO Mayus4;
     #901Campo = #901Campo > #901Campo;
     |PINTA #901Campo;
|FPRC;

|PROCESO TeclaF1;
     |ABRE #5;
     #5#0 = #0#0;
     |LEE 040#5=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #5;

     |PDEFECTO #901, 1, 18;

     |SI CampoTrabajo ! 4;
         #901#1  = #5#2;      |PINTA #901#1;
         #901#2  = #5#192;    |PINTA #901#2;
         #901#3  = #5#1;      |PINTA #901#3;
         #901#4  = #5#6;      |PINTA #901#4;
         #901#5  = #5#7;      |PINTA #901#5;
         #901#6  = #5#8;      |PINTA #901#6;
         #901#7  = #5#9;      |PINTA #901#7;
         #901#8  = #5#10;     |PINTA #901#8;
         #901#9  = #5#11;     |PINTA #901#9;
         #901#10 = #5#15;     |PINTA #901#10;
         #901#11 = #5#12;     |PINTA #901#11;
         #901#12 = #5#13;     |PINTA #901#12;
         #901#13 = #5#14;     |PINTA #901#13;
     |SINO;
         #901#1  = #5#2;      |PINTA #901#1;
         #901#2  = #5#192;    |PINTA #901#2;
         #901#3  = #5#1;      |PINTA #901#3;
         #901#5  = #5#144;    |PINTA #901#5;
         #901#13 = #5#147;    |PINTA #901#13;
         #901#16 = #5#148;    |PINTA #901#16;
         #901#17 = #5#193;    |PINTA #901#17;
     |FINSI;
|FPRC;

|PROCESO TeclaF2;
     |ABRE #5;
     #5#0 = #0#0;
     |LEE 040#5=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #5;

     |PDEFECTO #901, 1, 18;

     |SI CampoTrabajo ! 4;
         #901#1  = #5#29;     |PINTA #901#1;
         #901#2  = #5#192;    |PINTA #901#2;
         #901#3  = #5#28;     |PINTA #901#3;
         #901#4  = #5#6;      |PINTA #901#4;
         #901#5  = #5#7;      |PINTA #901#5;
         #901#6  = #5#8;      |PINTA #901#6;
         #901#7  = #5#9;      |PINTA #901#7;
         #901#8  = #5#10;     |PINTA #901#8;
         #901#9  = #5#11;     |PINTA #901#9;
         #901#10 = #5#15;     |PINTA #901#10;
         #901#11 = #5#12;     |PINTA #901#11;
         #901#12 = #5#13;     |PINTA #901#12;
         #901#13 = #5#14;     |PINTA #901#13;
     |SINO;
         #901#1  = #5#29;     |PINTA #901#1;
         #901#2  = #5#192;    |PINTA #901#2;
         #901#3  = #5#28;     |PINTA #901#3;
         #901#5  = #5#144;    |PINTA #901#5;
         #901#13 = #5#147;    |PINTA #901#13;
         #901#16 = #5#148;    |PINTA #901#16;
         #901#17 = #5#193;    |PINTA #901#17;
     |FINSI;
|FPRC;

|PROCESO TeclaF3;
     |ABRE #5;
     #5#0 = #0#0;
     |LEE 040#5=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #5;

     |ABRE #7;
     #7#0 = #5#44;
     |LEE 040#7=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #7;

     |PDEFECTO #901, 1, 18;

     |SI CampoTrabajo ! 4;
         #901#1  = #7#2;      |PINTA #901#1;
         #901#3  = #7#1;      |PINTA #901#3;
         #901#5  = #7#3;      |PINTA #901#5;
         #901#6  = #7#4;      |PINTA #901#6;
         #901#10 = #7#9;      |PINTA #901#10;
         #901#11 = #7#5;      |PINTA #901#11;
         #901#12 = #7#6;      |PINTA #901#12;
         #901#13 = #7#7;      |PINTA #901#13;
         #901#14 = #7#8;      |PINTA #901#14;
     |SINO;
         #901#1  = #7#2;      |PINTA #901#1;
         #901#3  = #7#1;      |PINTA #901#3;
         #901#5  = #7#3;      |PINTA #901#5;
         #901#13 = #7#7;      |PINTA #901#13;
     |FINSI;
|FPRC;

|PROCESO TeclaF4;
     |PDEFECTO #901, 1, 18;

     |SI CampoTrabajo = 2;  |ACABA;  |FINSI;

     |SI CampoTrabajo = 4;
         #901#1  = #900#15;      |PINTA #901#1;
         #901#2  = #900#16;      |PINTA #901#2;
         #901#3  = #900#17;      |PINTA #901#3;
         #901#5  = #900#19;      |PINTA #901#5;
         #901#13 = #900#27;      |PINTA #901#13;
         |ACABA;
     |FINSI;

     |PARA Campo1 = 15;  |SI Campo1 [ 28;  |HACIENDO Campo1 = Campo1 + 1;
           Campo2 = Campo1 - 14;
           #901Campo2 = #900Campo1;  |PINTA #901Campo2;
           |SI Campo2 = 10;  |Y CampoTrabajo ] 6;
               #901Campo2 = "";  |PINTA #901Campo2;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO TeclaF5;
     |PDEFECTO #901, 1, 18;

     |SI CampoTrabajo = 4;  |ACABA;  |FINSI;

     #901#1  = #900#29;           |PINTA #901#1;
     #901#2  = #900#30;           |PINTA #901#2;
     #901#3  = #900#31;           |PINTA #901#3;
     #901#5  = #900#35;           |PINTA #901#5;
     #901#13 = #900#36;           |PINTA #901#13;
|FPRC;

|PROCESO TeclaF6;
     |PDEFECTO #901, 1, 18;

     |SI CampoTrabajo = 6;  |ACABA;  |FINSI;

     |SI CampoTrabajo = 4;
         #901#1  = #900#51;      |PINTA #901#1;
         #901#2  = #900#52;      |PINTA #901#2;
         #901#3  = #900#53;      |PINTA #901#3;
         #901#5  = #900#55;      |PINTA #901#5;
         #901#13 = #900#62;      |PINTA #901#13;
         |ACABA;
     |FINSI;

     |PARA Campo1 = 51;  |SI Campo1 [ 63;  |HACIENDO Campo1 = Campo1 + 1;
           Campo2 = Campo1 - 50;
           |SI Campo2 ] 10;  Campo2 = Campo1 - 49;  |FINSI;
           #901Campo2 = #900Campo1;  |PINTA #901Campo2;
     |SIGUE;
|FPRC;

|PROCESO TeclaF7;
     |PDEFECTO #901, 1, 18;

     |SI CampoTrabajo = 7;  |ACABA;  |FINSI;

     |SI CampoTrabajo = 4;
         #901#1  = #900#64;      |PINTA #901#1;
         #901#2  = #900#65;      |PINTA #901#2;
         #901#3  = #900#66;      |PINTA #901#3;
         #901#5  = #900#68;      |PINTA #901#5;
         #901#13 = #900#75;      |PINTA #901#13;
         |ACABA;
     |FINSI;

     |PARA Campo1 = 64;  |SI Campo1 [ 76;  |HACIENDO Campo1 = Campo1 + 1;
           Campo2 = Campo1 - 63;
           |SI Campo2 ] 10;  Campo2 = Campo1 - 62;  |FINSI;
           #901Campo2 = #900Campo1;  |PINTA #901Campo2;
     |SIGUE;
|FPRC;

|PROCESO TeclaF8;
     |PDEFECTO #901, 1, 18;

     |SI CampoTrabajo = 8;  |ACABA;  |FINSI;

     |SI CampoTrabajo = 4;
         #901#1  = #900#77;      |PINTA #901#1;
         #901#2  = #900#78;      |PINTA #901#2;
         #901#3  = #900#79;      |PINTA #901#3;
         #901#5  = #900#81;      |PINTA #901#5;
         #901#13 = #900#88;      |PINTA #901#13;
         |ACABA;
     |FINSI;

     |PARA Campo1 = 77;  |SI Campo1 [ 89;  |HACIENDO Campo1 = Campo1 + 1;
           Campo2 = Campo1 - 76;
           |SI Campo2 ] 10;  Campo2 = Campo1 - 75;  |FINSI;
           #901Campo2 = #900Campo1;  |PINTA #901Campo2;
     |SIGUE;
|FPRC;

|PROCESO Tecla;  |TIPO 0;
     |SI FSalida < 9;  |O FSalida > 17;  |ACABA;  |FINSI;

     |SI FSalida = 9;   |HAZ TeclaF1;  |FINSI;
     |SI FSalida = 10;  |HAZ TeclaF2;  |FINSI;
     |SI FSalida = 11;  |HAZ TeclaF3;  |FINSI;
     |SI FSalida = 12;  |HAZ TeclaF4;  |FINSI;
     |SI FSalida = 13;  |HAZ TeclaF5;  |FINSI;
     |SI FSalida = 14;  |HAZ TeclaF6;  |FINSI;
     |SI FSalida = 15;  |HAZ TeclaF7;  |FINSI;
     |SI FSalida = 16;  |HAZ TeclaF8;  |FINSI;
     |ERROR;
|FPRC;

|PROCESO PintaNombre;
     |SI #901#11 = 0;  |Y #901#12 = 0;  |ACABA;  |FINSI;

     |ABRE #6;
     #6#0 = #901#11;
     #6#1 = #901#12;
     |LEE 040#6=;
     |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;
     |CIERRA #6;

     #901#13 = #6#3;  |PINTA #901#13;
|FPRC;

 **************************************
 PROCESOS PROPIOS DEL PROGRAMA rew00007
 **************************************

|PROCESO Mayus6;
     |SI CampoTrabajo = 6;  |ACABA;    |FINSI;
     |SI Modelo       = 214;  |ACABA;  |FINSI;

     #903Campo = #903Campo > #903Campo;
     |PINTA #903Campo;
|FPRC;
