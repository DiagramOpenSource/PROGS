|FICHEROS;
     rez00003 #0;
     redatcon #1;
|FIN;

|VARIABLES;
     aAlfa    = "";
     aFichero = "";
     nLinea   = 0;
     nCampo1  = 0;
     nCampo2  = 0;
     nCampo3  = 0;
     nCampo4  = 0;
     nCampo5  = 0;

     &empresa    = 0;
     &aTipoGente = "";
|FIN;

|PROCESO GrabaFichero;
     aFichero = ((Usuario % 810) + "zzzzzzzz") % 110;
     |NOME_DAT #0 aFichero;
     |ABRE #0;  |CIERRA #0;  |DELINDEX #0;

     |ABRE #0;
     |ABRE #1;
     #1#0 = empresa;
     |LEE 040#1=;
     |SI FSalida ! 0;  |CIERRA #1;  |ACABA;  |FINSI;
     |CIERRA #1;

     nLinea = 1;

     #0#0 = nLinea;
     #0#1 = "TITULAR";
     #0#2 = "T";
     #0#3 = #1#1;
     #0#4 = #1#3;
     #0#5 = #1#5;
     |GRABA 020#0n;
     |LIBERA #0;

     |SI #1#30 ! "    ";
         nLinea = nLinea + 1;

         #0#0 = nLinea;
         #0#1 = "CONYUGE";
         #0#2 = "C";
         #0#3 = #1#28;
         #0#4 = #1#30;
         #0#5 = #1#31;
         |GRABA 020#0n;
         |LIBERA #0;
     |FINSI;

     nCampo1 = #1#98 + 77;
     nCampo2 = #1#98 + 163;
     nCampo3 = #1#98 + 57;
     nCampo4 = #1#98 + 67;
     nCampo5 = #1#98 + 87;
     aAlfa   = "AMBOS";
     |SI #1nCampo2 = "T";  aAlfa   = "TITULAR";  |FINSI;
     |SI #1nCampo2 = "C";  aAlfa   = "CONYUGE";  |FINSI;

     |SI #1nCampo4 ! "    ";
         nLinea = nLinea + 1;

         #0#0 = nLinea;
         #0#1 = #1nCampo1 + " " + aAlfa
         #0#2 = "1";
         #0#3 = #1nCampo3;
         #0#4 = #1nCampo4;
         #0#5 = #1nCampo5;
         |GRABA 020#0n;
         |LIBERA #0;
     |FINSI;

     nCampo1 = #1#99 + 77;
     nCampo2 = #1#99 + 163;
     nCampo3 = #1#99 + 57;
     nCampo4 = #1#99 + 67;
     nCampo5 = #1#99 + 87;
     aAlfa   = "AMBOS";
     |SI #1nCampo2 = "T";  aAlfa   = "TITULAR";  |FINSI;
     |SI #1nCampo2 = "C";  aAlfa   = "CONYUGE";  |FINSI;

     |SI #1nCampo4 ! "    ";
         nLinea = nLinea + 1;

         #0#0 = nLinea;
         #0#1 = #1nCampo1 + " " + aAlfa
         #0#2 = "2";
         #0#3 = #1nCampo3;
         #0#4 = #1nCampo4;
         #0#5 = #1nCampo5;
         |GRABA 020#0n;
         |LIBERA #0;
     |FINSI;

     nCampo1 = #1#100 + 77;
     nCampo2 = #1#100 + 163;
     nCampo3 = #1#100 + 57;
     nCampo4 = #1#100 + 67;
     nCampo5 = #1#100 + 87;
     aAlfa   = "AMBOS";
     |SI #1nCampo2 = "T";  aAlfa   = "TITULAR";  |FINSI;
     |SI #1nCampo2 = "C";  aAlfa   = "CONYUGE";  |FINSI;

     |SI #1nCampo4 ! "    ";
         nLinea = nLinea + 1;

         #0#0 = nLinea;
         #0#1 = #1nCampo1 + " " + aAlfa
         #0#2 = "3";
         #0#3 = #1nCampo3;
         #0#4 = #1nCampo4;
         #0#5 = #1nCampo5;
         |GRABA 020#0n;
         |LIBERA #0;
     |FINSI;

     nCampo1 = #1#101 + 77;
     nCampo2 = #1#101 + 163;
     nCampo3 = #1#101 + 57;
     nCampo4 = #1#101 + 67;
     nCampo5 = #1#101 + 87;
     aAlfa   = "AMBOS";
     |SI #1nCampo2 = "T";  aAlfa   = "TITULAR";  |FINSI;
     |SI #1nCampo2 = "C";  aAlfa   = "CONYUGE";  |FINSI;

     |SI #1nCampo4 ! "    ";
         nLinea = nLinea + 1;

         #0#0 = nLinea;
         #0#1 = #1nCampo1 + " " + aAlfa
         #0#2 = "4";
         #0#3 = #1nCampo3;
         #0#4 = #1nCampo4;
         #0#5 = #1nCampo5;
         |GRABA 020#0n;
         |LIBERA #0;
     |FINSI;

     |CIERRA #0;
|FPRC;

|RUTINA ClaveBaja;
     #0#0 = 1;
|FRUT;

|RUTINA ClaveAlta;
     #0#0 = 6;
|FRUT;

|PROCESO TipoGente;  |TIPO 0;
     aTipoGente = #0#2;
     |PTEC 807;
|FPRC;

|PROGRAMA;
     |HAZ GrabaFichero;

     |ENTLINEAL #1#0, 1, 4, 22, 1, ClaveBaja, ClaveAlta;
|FPRO;
