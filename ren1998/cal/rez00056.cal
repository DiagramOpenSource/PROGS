|FICHEROS;
     rez00056 #0;
     repatrim #1;
     m2patrim #2;
     reliquid #3;
     redatcon #4;
     repoblac #6;
     rew00100 #99;
|FIN;

|VARIABLES;
     aFichero = "";
     aAlfa    = "";
     aObliga  = "";
     aImpreso = "";

     nCampo    = 0;
     nPasa     = 0;
     nEmpresaC = 0;
|FIN;

|INCLUYE i_varcpa;

|PROCESO Mayus;
     #0Campo = #0Campo > #0Campo;  |PINTA #0Campo;
|FPRC;

|PROCESO Renta97; |TIPO 7;
     |DBASS aAlfa;
     #0#2 = aAlfa + "ren1997/fich/";
     |PINTA #0#2;
|FPRC;

|PROCESO cabecera;
     cabecera = "************************************************************************";
     |IMPRIME cabecera;
     cabecera = "        *  POSIBLES LINEAS DUPLICADAS DEL PATRIMONIO 97 al 98  * ";
     |IMPRIME cabecera;
     cabecera = "            Se imprime todo el capitulo para su comprobacion  ";
     |IMPRIME cabecera;
     cabecera = "************************************************************************";
     |IMPRIME cabecera;
     hoja     = hoja + 1;
     importe  = hoja;
     cabecera = "";                                      |IMPRIME cabecera;
     cabecera = "Hoja ......: " + importe;               |IMPRIME cabecera;
     cabecera = "Declarante : " + #4#0 + " " + #4#1;     |IMPRIME cabecera;
     cabecera = "NIF....... : " + #4#2;                  |IMPRIME cabecera;
     cabecera = "";                                      |IMPRIME cabecera;
     swporta  = 1;
     linea    = 8;
|FPRC;

|PROCESO linea;
     |SI linea < TopeLinea; |ACABA; |FINSI;

     |SI SaltoPagina = "S";
         |CIMPR 7;
         |HAZ cabecera;
         |ACABA;
     |FINSI;

     cabecera = "";  |IMPRIME cabecera;
     cabecera = "                                                                     Sigue...";
     |IMPRIME cabecera;
     linea = linea + 2;
     |PARA x = linea; |SI x [ LineaInforme; |HACIENDO x = x + 1;
           cabecera = ""; |IMPRIME cabecera;
     |SIGUE;
     |HAZ cabecera;
|FPRC;

|PROCESO pie;
     |SI SaltoPagina = "S";
         |CIMPR 7;
         |ACABA;
     |FINSI;

     |PARA x = linea; |SI x [ LineaInforme; |HACIENDO x = x + 1;
           cabecera = ""; |IMPRIME cabecera;
     |SIGUE;
|FPRC;

|PROCESO importe;    || Calculo para poner las comas en el importe
     cantinum = importe;
     cantinum = cantinum ! 0;
     importe = cantinum;

     len = importe % 0;
     leng = len;
     importe = "             " + importe;
     importe = importe % -113;
           impor1 = importe % -103;
           impor2 = importe % -403;
           impor3 = importe % -703;
           impor4 = importe % -1004;
     |SI leng ] 10;
         |SI impor4 ! "  -";
             importe = impor4 + "." + impor3  + "." + impor2 + "." + impor1;
         |SINO;
             importe = impor4 + impor3  + "." + impor2 + "." + impor1;
         |FINSI;
     |SINO;
         |SI leng ] 7;
            |SI impor3 ! "  -";
                importe = impor3  + "." + impor2 + "." + impor1;
            |SINO;
                importe = impor3 + impor2 + "." + impor1;
            |FINSI;
         |SINO;
            |SI leng ] 4;
                |SI impor2 ! "  -";
                    importe = impor2 + "." + impor1;
                |SINO;
                    importe = impor2 + impor1;
                |FINSI;
            |SINO;
                importe = impor1;
            |FINSI;
         |FINSI;
     |FINSI;
     importe = "             " + importe;
     importe = importe % -113;
|FPRC;

|PROCESO Imprime;
     |SI swporta = 0; |HAZ cabecera; |FINSI;
     |CIMPR 1;  |IMPRIME varalf;  |CIMPR 2;
     linea = linea + 1; |HAZ linea;
|FPRC;

|PROCESO ImprimeA1;
     |SI swrrr = 0;
         varalf = ""; |HAZ Imprime;
         varalf = "A) BIENES INMUEBLES DE NATURALEZA URBANA"; |HAZ Imprime;
         varalf = "=" * 128; |HAZ Imprime;
         varalf = "Clave    Tipo Referencia catastral                       Situacion ";
         varalf = varalf + "del inmueble                                            ";
         varalf = varalf + "Valor";
         |HAZ Imprime;
         varalf = "=" * 128; |HAZ Imprime;
         swrrr = 1;
     |FINSI;
     varalf  = #1#15;
     varalf  = varalf + "        " + #1#18;
     varalf  = varalf + "    " + #1#16;
     varalf  = varalf + "                  " + #1#5 + "  ";
     varalf  = varalf + "                       ";
     importe = #1#9; |HAZ importe;
     varalf = varalf + "     " + importe;
     |HAZ Imprime;
|FPRC;

|PROCESO ImprimeB1;
     |SI swrrr = 0;
         varalf = ""; |HAZ Imprime;
         varalf = ""; |HAZ Imprime;
         varalf = "B) BIENES INMUEBLES DE NATURALEZA RUSTICA"; |HAZ Imprime;
         varalf = "=" * 122; |HAZ Imprime;
         varalf = "Clave   Referencia catastral      Municipio              ";
         varalf = varalf + "        Provincia           H.Regadio      H.Secano";
         varalf = varalf + "         Valor";
         |HAZ Imprime;
         varalf = "=" * 122; |HAZ Imprime;
         swrrr = 1;
     |FINSI;
     varalf  = #1#15;
     varalf  = varalf + "       " + #1#16;
     varalf  = varalf + " " + #6#3;
     varalf  = varalf + "      " + #6#2;
     importe = #1#11;                    |HAZ importe;
     varalf  = varalf + " " + importe;
     importe = #1#10;                    |HAZ importe;
     varalf  = varalf + " " + importe;
     importe = #1#9;                     |HAZ importe;
     varalf  = varalf + " " + importe;
     |HAZ Imprime;
|FPRC;

|PROCESO ImprimeC;
     |SI swrrr = 0;
         varalf = ""; |HAZ Imprime;
         varalf = ""; |HAZ Imprime;
         |SI sw_fich = 1;
             varalf = "C1) BIENES Y DERECHOS AFECTOS A ACTIVIDADES EMPRESARIALES";
             varalf = varalf + " O PROFESIONALES (EXCEPTO INMUEBLES)"; |HAZ Imprime;
             varalf = "=" * 127; |HAZ Imprime;
             varalf = "Epigrafe      Domicilio                        ";
             varalf = varalf + "   Descripcion del bien o derecho             ";
             varalf = varalf + "                             Valor";
             |HAZ Imprime;
             varalf = "=" * 127; |HAZ Imprime;
             swrrr = 1;
         |FINSI;

         |SI sw_fich = 2;
             varalf = "C2) BIENES Y DERECHOS NO EXENTOS AFECTOS A ACTIVIDADES ";
             varalf = varalf + "EMPRESARIALES O PROFESIONALES "; |HAZ Imprime;
             varalf = "=" * 127; |HAZ Imprime;
             varalf = "Epigrafe  Clave  Referencia catastral               Situacion          ";
             varalf = varalf + "                                         ";
             varalf = varalf + "          Valor";
             |HAZ Imprime;
             varalf = "=" * 127; |HAZ Imprime;
             swrrr = 1;
         |FINSI;

         |SI sw_fich = 3;
             varalf = "D) BIENES Y DERECHOS EXENTOS AFECTOS A ACTIVIDADES EMP";
             varalf = varalf + "RESARIALES       "; |HAZ Imprime;
             varalf = "=" * 127; |HAZ Imprime;
             varalf = "Epigrafe  Clave  Referencia catastral               Descripcion de bien";
             varalf = varalf + "es, derechos y deudas                    ";
             varalf = varalf + "          Valor";
             |HAZ Imprime;
             varalf = "=" * 127; |HAZ Imprime;
             swrrr = 1;
         |FINSI;
     |FINSI;

     |SI sw_fich = 1;
         varalf  = #1#17 + "      ";
         varalf  = varalf + "   " + #1#5 + "  ";
         varalf  = varalf + "      " + #1#14 + "                ";
         varalf  = varalf + "    ";
         importe = #1#9; |HAZ importe;
         varalf  = varalf + "                    " + importe;
         |HAZ Imprime;
     |FINSI;

     |SI sw_fich = 2;
         varalf  = #1#17 + "  ";
         varalf  = varalf + "     " + #1#18;
         varalf  = varalf + "    " + #1#16;
         varalf  = varalf + "          " + #1#5 + "  ";
         importe = #1#9; |HAZ importe;
         varalf = varalf + "                                " + importe;
         |HAZ Imprime;
     |FINSI;

     |SI sw_fich = 3;
         varalf  = #1#17 + "  ";
         varalf  = varalf + "     " + #1#18;
         varalf  = varalf + "    " + #1#16;
         varalf  = varalf + "          " + #1#5 + "            ";
         importe = #1#9; |HAZ importe;
         varalf = varalf + "                      " + importe;
         |HAZ Imprime;
     |FINSI;
|FPRC;

|PROCESO ImprimeD1;
     |SI swrrr = 0;
         varalf = ""; |HAZ Imprime;
         varalf = ""; |HAZ Imprime;
         varalf = "E) DEPOSITOS EN CUENTA CORRIENTE O DE AHORRO, A LA VISTA O A PLAZO";
         |HAZ Imprime;
         varalf = "=" * 124; |HAZ Imprime;
         varalf = "Entidad de deposito                                                     ";
         varalf = varalf + "        Numero de cuenta       ";
         varalf = varalf + "                Valor";
         |HAZ Imprime;
         varalf = "=" * 124; |HAZ Imprime;
         swrrr = 1;
     |FINSI;
     alfa1   = (#1#5 + (" " * 79)) % 179;
     alfa2   = (#1#12 + (" " * 30)) % 130;
     varalf  = alfa1;
     varalf  = varalf + " " + alfa2;
     importe = #1#9; |HAZ importe;
     varalf = varalf + " " + importe;
     |HAZ Imprime;
|FPRC;

|PROCESO ImprimeF;
     |SI swrrr = 0;
         varalf = ""; |HAZ Imprime;
         varalf = ""; |HAZ Imprime;
         |SI sw_fich = 2;
             varalf = "F1) DEUDA PUBLICA, OBLIGACIONES, BONOS Y DEMAS VALORES NEGOCIADOS";
             |HAZ Imprime;
             varalf = "=" * 122; |HAZ Imprime;
             varalf = "Descripcion                                                             ";
             varalf = varalf + "                                         ";
             varalf = varalf + "    Valor";
             |HAZ Imprime;
             varalf = "=" * 122; |HAZ Imprime;
             swrrr = 1;
         |SINO;
             varalf = "F2) CERTIFICADOS DE DEPOSITOS, PAGARES, OBLIGACIONES, BONOS Y DEMAS VALORES EQUIVALENTES NO NEGOCIADOS";
             |HAZ Imprime;
             varalf = "=" * 122; |HAZ Imprime;
             varalf = "Descripcion                                                             ";
             varalf = varalf + "                                         ";
             varalf = varalf + "    Valor";
             |HAZ Imprime;
             varalf = "=" * 122; |HAZ Imprime;
             swrrr = 1;
         |FINSI;
     |FINSI;
     alfa1   = (#1#5 + (" " * 80)) % 180;
     alfa2   = " " * 28;
     varalf  = alfa1 + alfa2;
     importe = #1#9; |HAZ importe;
     varalf  = varalf + " " + importe;
     |HAZ Imprime;
|FPRC;

|PROCESO ImprimeG;
     |SI swrrr = 0;
         varalf = ""; |HAZ Imprime;
         varalf = ""; |HAZ Imprime;
         |SI sw_fich = 1;
             varalf = "G1) ACCIONES Y PARTICIPACIONES EN CAPITAL SOCIAL O FONDOS PROPIOS DE SOCIEDADES Y FONDOS DE INVERSION,";
             |HAZ Imprime;
             varalf = "    NEGOCIADAS EN MERCADOS ORGANIZADOS";
             |HAZ Imprime;
             varalf = "=" * 122; |HAZ Imprime;
             varalf = "Descripcion                                                             ";
             varalf = varalf + "                                         ";
             varalf = varalf + "    Valor";
             |HAZ Imprime;
             varalf = "=" * 122; |HAZ Imprime;
             swrrr = 1;
         |FINSI;

         |SI sw_fich = 2;
             varalf = "G2) ACCIONES Y PARTICIPACIONES EN CAPITAL SOCIAL O FONDOS PROPIOS DE OTRAS ENTIDADES JURIDICAS, ";
             |HAZ Imprime;
             varalf = "    NEGOCIADAS EN MERCADOS ORGANIZADOS";
             |HAZ Imprime;
             varalf = "=" * 122; |HAZ Imprime;
             varalf = "Descripcion                                                             ";
             varalf = varalf + "                                         ";
             varalf = varalf + "    Valor";
             |HAZ Imprime;
             varalf = "=" * 122; |HAZ Imprime;
             swrrr = 1;
         |FINSI;

         |SI sw_fich = 5;
             varalf = "G3) ACCIONES Y PARTICIPACIONES EN CAPITAL SOCIAL O FONDOS PROPIOS DE SOCIEDADES Y FONDOS DE INVERSION,";
             |HAZ Imprime;
             varalf = "    NO NEGOCIADAS EN MERCADOS ORGANIZADOS";
             |HAZ Imprime;
             varalf = "=" * 122; |HAZ Imprime;
             varalf = "Descripcion                                                             ";
             varalf = varalf + "                                         ";
             varalf = varalf + "    Valor";
             |HAZ Imprime;
             varalf = "=" * 122; |HAZ Imprime;
             swrrr = 1;
         |FINSI;

         |SI sw_fich = 6;
             varalf = "G4) ACCIONES Y PARTICIPACIONES EN CAPITAL SOCIAL O FONDOS PROPIOS DE OTRAS ENTIDADES JURIDICAS, ";
             |HAZ Imprime;
             varalf = "    NO NEGOCIADAS EN MERCADOS ORGANIZADOS, Y PARTICIPACIONES EN EL CAPITAL SOCIAL DE COOPERATIVAS";
             |HAZ Imprime;
             varalf = "=" * 122; |HAZ Imprime;
             varalf = "Descripcion                                                             ";
             varalf = varalf + "                                         ";
             varalf = varalf + "    Valor";
             |HAZ Imprime;
             varalf = "=" * 122; |HAZ Imprime;
             swrrr = 1;
         |FINSI;

         |SI sw_fich = 7;
             varalf = "H1) ACCIONES Y PARTICIPACIONES EXENTAS EN CAPITAL SOCIAL O FONDOS PROPIOS DE ENTIDADES JURIDICAS,";
             |HAZ Imprime;
             varalf = "    NEGOCIADAS EN MERCADOS ORGANIZADOS";
             |HAZ Imprime;
             varalf = "=" * 122; |HAZ Imprime;
             varalf = "Descripcion                                                             ";
             varalf = varalf + "                                         ";
             varalf = varalf + "    Valor";
             |HAZ Imprime;
             varalf = "=" * 122; |HAZ Imprime;
             swrrr = 1;
         |FINSI;

         |SI sw_fich = 8;
             varalf = "H2) ACCIONES Y PARTICIPACIONES EXENTAS EN CAPITAL SOCIAL O FONDOS PROPIOS DE ENTIDADES JURIDICAS, NO";
             |HAZ Imprime;
             varalf = "    NEGOCIADAS EN MERCADOS ORGANIZADOS,Y PARTICIPACIONES EXENTAS EN EL CAPITAL SOCIAL DE COOPERATIVAS";
             |HAZ Imprime;
             varalf = "=" * 122; |HAZ Imprime;
             varalf = "Descripcion                                                             ";
             varalf = varalf + "                                         ";
             varalf = varalf + "    Valor";
             |HAZ Imprime;
             varalf = "=" * 122; |HAZ Imprime;
             swrrr = 1;
         |FINSI;

         |SI sw_fich = 3;
             varalf = "I)  SEGUROS DE VIDA";
             |HAZ Imprime;
             varalf = "=" * 122; |HAZ Imprime;
             varalf = "Entidad aseguradora                                                     ";
             varalf = varalf + "                                         ";
             varalf = varalf + "   Valor";
             |HAZ Imprime;
             varalf = "=" * 122; |HAZ Imprime;
             swrrr = 1;
         |FINSI;
     |FINSI;
     alfa1   = (#1#5 + (" " * 80)) % 180;
     alfa4   = " " * 28;
     varalf  = alfa1 + alfa4;
     importe = #1#9; |HAZ importe;
     varalf  = varalf + " " + importe;
     |HAZ Imprime;
|FPRC;

|PROCESO ImprimeH;
     |SI swrrr = 0;
         varalf = ""; |HAZ Imprime;
         varalf = ""; |HAZ Imprime;
         varalf = "J) RENTAS TEMPORALES O VITALICIAS";
         |HAZ Imprime;
         varalf = "=" * 122; |HAZ Imprime;
         varalf = "Persona o entidad pagadora                                              ";
         varalf = varalf + "  Descripcion  Importe Anualidad";
         varalf = varalf + "             Valor";
         |HAZ Imprime;
         varalf = "=" * 122; |HAZ Imprime;
         swrrr = 1;
     |FINSI;
     alfa1   = (#1#5 + (" " * 69)) % 169;
     varalf  = alfa1;
     varalf  = varalf + "         " + #1#15;
     importe = #1#13; |HAZ importe;
     varalf  = varalf + "            " + importe;
     importe = #1#9; |HAZ importe;
     varalf = varalf + "     " + importe;
     |HAZ Imprime;
|FPRC;

|PROCESO ImprimeM;
     |SI swrrr = 0;
         varalf = ""; |HAZ Imprime;
         varalf = ""; |HAZ Imprime;
         varalf = "M) DERECHOS REALES DE USO Y DISFRUTE";
         |HAZ Imprime;
         varalf = "=" * 122; |HAZ Imprime;
         varalf = "Clave  Descripcion del bien              Situacion del bien           ";
         varalf = varalf + "                  Valor del bien";
         varalf = varalf + "               Valor";
         |HAZ Imprime;
         varalf = "=" * 122; |HAZ Imprime;
         swrrr = 1;
     |FINSI;
     varalf  = "  " + #1#15;
     varalf  = varalf + "     " + #1#5;
     varalf  = varalf + "     " + #1#14;
     importe = #1#13; |HAZ importe;
     varalf  = varalf + "                        " + importe;
     importe = #1#9; |HAZ importe;
     varalf  = varalf + "       " + importe;
     |HAZ Imprime;
|FPRC;

|PROCESO Cabecera1;
     varalf = "K) JOYAS, PIELES DE CARACTER SUNTUARIO, VEHICULOS, EMBARCACIONES Y AERONAVES";
     |HAZ Imprime;
     varalf = "=" * 122; |HAZ Imprime;
     varalf = "Descripcion                                                             ";
     varalf = varalf + "                                         ";
     varalf = varalf + "    Valor";
     |HAZ Imprime;
     varalf = "=" * 122; |HAZ Imprime;
     swrrr = 1;
|FPRC;

|PROCESO Cabecera2;
     varalf = "L) OBJETOS DE ARTE Y ANTIGUEDADES";
     |HAZ Imprime;
     varalf = "=" * 122; |HAZ Imprime;
     varalf = "Descripcion                                                             ";
     varalf = varalf + "                                         ";
     varalf = varalf + "    Valor";
     |HAZ Imprime;
     varalf = "=" * 122; |HAZ Imprime;
     swrrr = 1;
|FPRC;

|PROCESO Cabecera4;
     varalf = "N) CONCESIONES ADMINISTRATIVAS";
     |HAZ Imprime;
     varalf = "=" * 122; |HAZ Imprime;
     varalf = "Descripcion                                                             ";
     varalf = varalf + "                                         ";
     varalf = varalf + "    Valor";
     |HAZ Imprime;
     varalf = "=" * 122; |HAZ Imprime;
     swrrr = 1;
|FPRC;

|PROCESO Cabecera5;
     varalf = "O) DERECHOS DERIVADOS DE LA PROPIEDAD INTELECTUAL E INDUSTRIAL";
     |HAZ Imprime;
     varalf = "=" * 122; |HAZ Imprime;
     varalf = "Descripcion                                                             ";
     varalf = varalf + "                                         ";
     varalf = varalf + "    Valor";
     |HAZ Imprime;
     varalf = "=" * 122; |HAZ Imprime;
     swrrr = 1;
|FPRC;

|PROCESO Cabecera6;
     varalf = "P) OPCIONES CONTRACTUALES";
     |HAZ Imprime;
     varalf = "=" * 122; |HAZ Imprime;
     varalf = "Descripcion                                                             ";
     varalf = varalf + "                                         ";
     varalf = varalf + "    Valor";
     |HAZ Imprime;
     varalf = "=" * 122; |HAZ Imprime;
     swrrr = 1;
|FPRC;

|PROCESO Cabecera7;
     varalf = "Q) DEMAS BIENES Y DERECHOS DE CONTENIDO ECONOMICO";
     |HAZ Imprime;
     varalf = "=" * 122; |HAZ Imprime;
     varalf = "Descripcion                                                             ";
     varalf = varalf + "                                         ";
     varalf = varalf + "    Valor";
     |HAZ Imprime;
     varalf = "=" * 122; |HAZ Imprime;
     swrrr = 1;
|FPRC;

|PROCESO Cabecera8;
     varalf = "DEUDAS";
     |HAZ Imprime;
     varalf = "=" * 122; |HAZ Imprime;
     varalf = "Descripcion                                                             ";
     varalf = varalf + "                                         ";
     varalf = varalf + "    Valor";
     |HAZ Imprime;
     varalf = "=" * 122; |HAZ Imprime;
     swrrr = 1;
|FPRC;

|PROCESO ImprimeR;
     |SI swrrr = 0;
         varalf = ""; |HAZ Imprime;
         varalf = ""; |HAZ Imprime;
         |SI sw_fich = 1; |HAZ Cabecera1; |FINSI;
         |SI sw_fich = 2; |HAZ Cabecera2; |FINSI;
         |SI sw_fich = 4; |HAZ Cabecera4; |FINSI;
         |SI sw_fich = 5; |HAZ Cabecera5; |FINSI;
         |SI sw_fich = 6; |HAZ Cabecera6; |FINSI;
         |SI sw_fich = 7; |HAZ Cabecera7; |FINSI;
         |SI sw_fich = 8; |HAZ Cabecera8; |FINSI;
     |FINSI;
     alfa1   = (#1#5 + (" " * 80)) % 180;
     alfa4   = " " * 28;
     varalf  = alfa1 + alfa4;
     importe = #1#9; |HAZ importe;
     varalf  = varalf + " " + importe;
     |HAZ Imprime;
|FPRC;

|PROCESO Repartelo;
     #6#0 = #1#7;
     #6#1 = #1#8;
     |LEE 040#6=;
     |SI FSalida ! 0; |DDEFECTO #6; |FINSI;

     |SI #1#1 = "A1";                |HAZ ImprimeA1;  |FINSI;
     |SI #1#1 = "B1";                |HAZ ImprimeB1;  |FINSI;
     |SI #1#1 = "C1";  sw_fich = 1;  |HAZ ImprimeC;   |FINSI;
     |SI #1#1 = "C2";  sw_fich = 2;  |HAZ ImprimeC;   |FINSI;
     |SI #1#1 = "C3";  sw_fich = 3;  |HAZ ImprimeC;   |FINSI;
     |SI #1#1 = "D1";                |HAZ ImprimeD1;  |FINSI;
     |SI #1#1 = "E1";  sw_fich = 2;  |HAZ ImprimeF;   |FINSI;
     |SI #1#1 = "E2";  sw_fich = 3;  |HAZ ImprimeF;   |FINSI;
     |SI #1#1 = "F1";  sw_fich = 1;  |HAZ ImprimeG;   |FINSI;
     |SI #1#1 = "F2";  sw_fich = 2;  |HAZ ImprimeG;   |FINSI;
     |SI #1#1 = "F3";  sw_fich = 5;  |HAZ ImprimeG;   |FINSI;
     |SI #1#1 = "F4";  sw_fich = 6;  |HAZ ImprimeG;   |FINSI;
     |SI #1#1 = "F5";  sw_fich = 7;  |HAZ ImprimeG;   |FINSI;
     |SI #1#1 = "F6";  sw_fich = 8;  |HAZ ImprimeG;   |FINSI;
     |SI #1#1 = "G1";  sw_fich = 3;  |HAZ ImprimeG;   |FINSI;
     |SI #1#1 = "H1";  sw_fich = 4;  |HAZ ImprimeH;   |FINSI;
     |SI #1#1 = "I1";  sw_fich = 1;  |HAZ ImprimeR;   |FINSI;
     |SI #1#1 = "J1";  sw_fich = 2;  |HAZ ImprimeR;   |FINSI;
     |SI #1#1 = "K1";  sw_fich = 3;  |HAZ ImprimeM;   |FINSI;
     |SI #1#1 = "L1";  sw_fich = 4;  |HAZ ImprimeR;   |FINSI;
     |SI #1#1 = "M1";  sw_fich = 5;  |HAZ ImprimeR;   |FINSI;
     |SI #1#1 = "N1";  sw_fich = 6;  |HAZ ImprimeR;   |FINSI;
     |SI #1#1 = "O1";  sw_fich = 7;  |HAZ ImprimeR;   |FINSI;
     |SI #1#1 = "U1";  sw_fich = 8;  |HAZ ImprimeR;   |FINSI;
|FPRC;

|DEFBUCLE repatrimP;
     #1#1;
     ;
     #99#0, #99#1, 000;
     #99#0, #99#1, 999;
     ;
     NULL, Repartelo;
|FIN;

|PROCESO Chequea;
     #3#0 = #99#0;
     |LEE 040#3=;
     |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;

     #4#0 = #99#0;
     |LEE 040#4=;
     |SI FSalida ! 0;  |DDEFECTO #4;  |FINSI;

     aObliga = "N";
     |SI #3#29 = "S";  aObliga = "S";  |FINSI;
     |SI #3#30 = "S";  aObliga = "S";  |FINSI;
     |SI #3#31 = "S";  aObliga = "S";  |FINSI;
     |SI #3#32 = "S";  aObliga = "S";  |FINSI;
     |SI #3#33 = "S";  aObliga = "S";  |FINSI;
     |SI #3#34 = "S";  aObliga = "S";  |FINSI;

     aImpreso = "N";
     |SI #4#138 = "S";  aImpreso = "S";  |FINSI;
     |SI #4#139 = "S";  aImpreso = "S";  |FINSI;
     |SI #4#198 = "S";  aImpreso = "S";  |FINSI;
     |SI #4#199 = "S";  aImpreso = "S";  |FINSI;
     |SI #4#200 = "S";  aImpreso = "S";  |FINSI;
     |SI #4#201 = "S";  aImpreso = "S";  |FINSI;

     |SI #0#0 ! "T";
         |SI #0#0 ! aObliga;  |ACABA;  |FINSI;
     |FINSI;

     |SI #0#1 ! "T";
         |SI #0#1 ! aImpreso;  |ACABA;  |FINSI;
     |FINSI;

     swrrr = 0;
     |SI nEmpresaC ! #99#0;
         |SI nEmpresaC ! 0;  |HAZ pie;  |FINSI;

         hoja      = 0;
         swporta   = 0;
         linea     = 0;
         nEmpresaC = #99#0;
     |FINSI;

     |BUCLE repatrimP;
|FPRC;

|DEFBUCLE rew00100;
     #99#1;
     ;
     00000, "  ";
     99999, "zz";
     ;
     NULL, Chequea;
|FIN;

|PROCESO Compara97;
     nPasa = 1;
     |PARA nCampo = 3; |SI nCampo [ 18;  |HACIENDO nCampo = nCampo + 1;
           |SI #1nCampo ! #2nCampo;  nPasa = 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nPasa = 0;  |ACABA;  |FINSI;

     #99#0 = #1#0;
     #99#1 = #1#1;
     |LEE 101#99=;
     |SI FSalida ! 0;
         #99#0 = #1#0;
         #99#1 = #1#1;
         |GRABA 020#99n;
     |FINSI;
     |LIBERA #99;
|FPRC;

|DEFBUCLE m2patrim;
     #2#1;
     ;
     #1#0, #1#1, 000;
     #1#0, #1#1, 999;
     ;
     NULL, Compara97;
|FIN;

|PROCESO Compara98;
     |BUCLE m2patrim;
|FPRC;

|DEFBUCLE repatrim;
     #1#1;
     ;
     00000, "  ", 000;
     99999, "zz", 999;
     ;
     NULL, Compara98;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     TopeLinea   = 66;
     SaltoPagina = "S";

     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aFichero = "56" + (Usuario % 810) + "zzzzzzzz";  |QBT aFichero;
     aFichero = aFichero % 108;
     |NOME_DAT #99 aFichero;
     |ABRE #99;  |CIERRA #99;  |DELINDEX #99;

     aAlfa = #0#2;  |QBT aAlfa;
     |PATH_DAT #2 aAlfa;
     |NOME_DAT #2 "repatrim";

     |ABRE #99;
     |BUCLE repatrim;
     |CIERRA #99;

     |ABRE #3;
     |ABRE #4;
     |ABRE #6;
     |BUCLE rew00100;
     |SI linea ! 0;  |HAZ pie;  |FINSI;

     |CIERRA #3;
     |CIERRA #4;
     |CIERRA #6;

     |FINIMP;
     |DELINDEX #99;
|FPRC;
