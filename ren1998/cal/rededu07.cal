|FICHEROS;
   rededu07 #0;
   reparame #1;
|FIN;

|VARIABLES;
   pepe       = 0;
   modelito   = 0;
   pantalla   = 0;
   nValor     = 0;

   &aTipoGente = "";
   &empresa   = 0;
   &nombre    = "";
   &modo      = 0;
   &indivi    = "";
|FIN;

|INCLUYE i_husuar;
|INCLUYE i_activo;
|INCLUYE i_patrim;

|| **************************************************************************
|| ***********************  ACTUALIZACION DEL PATRIMONIO ********************
|| **************************************************************************

|PROCESO baja_pat;
     patr_00 = #0#0;
     patr_01 = "G1";
     patr_02 = #0#18;
     |HAZ borra_pat;
|FPRC;

|PROCESO alta_pat;
     |SI #0#17 = 0; |ACABA; |FINSI;

     patr_09  = #0#17;
     patr_00  = #0#0;
     patr_01 = "G1";
     patr_02  = #0#18;
     patr_03  = #0#2;
     patr_04  = #0#3;
     patr_05  = #0#5;

     |HAZ graba_pat;

     #0#18 = patr_02;
|FPRC;

|PROCESO ConsuGente;
     |SI FSalida ! 13;  |ACABA;  |FINSI;

     aTipoGente = #0Campo;
     |SUB_EJECUTA "rez00003";
     #0Campo = aTipoGente;
     |PINTA #0Campo;
|FPRC;

|RUTINA inferior;
  #0#0 = empresa;
  #0#1 = 1;
|FRUT;

|RUTINA superior;
  #0#0 = empresa;
  #0#1 = 99;
|FRUT;

|PROGRAMA;
|PINPA #0#0;
|SI modo = 1;  |ENTLINEAL #1#0,2,1,15,0,inferior,superior;  |FINSI;
|SI modo = 2;  |ENTLINEAL #1#0,2,2,15,0,inferior,superior;  |FINSI;
|SI modo = 4;  |ENTLINEAL #1#0,2,4,15,0,inferior,superior;  |FINSI;
|FPRO;

|PROCESO Actualiza; |TIPO 2;
     |HAZ baja_pat;

     pantalla   = 0 +. 1;
     QueTipo    = (FEntrada / 100) ! 0;
     HContribu  = #0#0;
     HNombre    = nombre;
     HPrograma  = "(rededu07) DEDUCCIONES ENFERMEDAD, ALQUILER, SEGUROS, GUARDERIAS";
     HLinea     = #0#1;
     HPerceptor = #0#3;
     HRdto      = #0#7;

     |SI QueTipo = 1; HTipo = "ALTA FICHA";         |FINSI;
     |SI QueTipo = 2; HTipo = "MODIFICACION FICHA"; |FINSI;
     |SI QueTipo = 3; HTipo = "BAJA FICHA";         |FINSI;

     |SI QueTipo = 3; |Y pantalla ! 1; |HAZ AltaHistorico;  |FINSI;
     |SI QueTipo < 3; |Y pantalla = 1; |HAZ AltaHistorico;  |FINSI;

     |SI pantalla ! 1;  |ACABA;  |FINSI;

     |HAZ alta_pat;
|FPRC;

|PROCESO parametro; |TIPO 0;
modelito = (FEntrada / 100) ! 0;
|SI modelito = 1;
   |ABRE #1;
   |LEE 040#1=;
   |SI FSalida = 0;
      #0#2  = #1#6;
      #0#9 = #1#7;
      |PINTA #0#2;
      |PINTA #0#9;
   |FINSI;
   |CIERRA #1;
|FINSI;
|FPRC;

|PROCESO TipoIndi; |TIPO 7;
|SI indivi = "S"; |Y #0Campo ! "V";
    #0Campo = "T"; |PINTA #0Campo;
|FINSI;
|FPRC;

|PROCESO perceptor; |TIPO 0;
|CAMPO_MODIFICA #0#10, 1, "N";
|CAMPO_MODIFICA #0#11, 1, "N";
|CAMPO_MODIFICA #0#12, 1, "N";
|CAMPO_MODIFICA #0#13, 1, "N";
|CAMPO_MODIFICA #0#14, 1, "N";
|CAMPO_MODIFICA #0#15, 1, "N";

|SI indivi = "S"; |Y #0#2 ! "T";
    |MENAV "      La renta es individual";
    |ERROR; |ACABA;
|FINSI;

npro = 26; |HAZ sigrabo;
|SI #0#2 = "T"; #0#3 = "TITULAR  "; |FINSI;
|SI #0#2 = "C"; #0#3 = "CONYUGE  "; |FINSI;
|SI #0#2 = "G"; #0#3 = "GANANCIAL"; |FINSI;
|SI #0#2 = "1"; #0#3 = "FAMILIAR "; |FINSI;
|SI #0#2 = "2"; #0#3 = "FAMILIAR "; |FINSI;
|SI #0#2 = "3"; #0#3 = "FAMILIAR "; |FINSI;
|SI #0#2 = "4"; #0#3 = "FAMILIAR "; |FINSI;
|SI #0#2 = "V"; |Y #0#9 ! "X";
    #0#3 = "VARIOS   ";
    |CAMPO_MODIFICA #0#10, 1, "S";
    |CAMPO_MODIFICA #0#11, 1, "S";
    |CAMPO_MODIFICA #0#12, 1, "S";
    |CAMPO_MODIFICA #0#13, 1, "S";
    |CAMPO_MODIFICA #0#14, 1, "S";
    |CAMPO_MODIFICA #0#15, 1, "S";
|FINSI;
|PINTA #0#3;
|FPRC;

|PROCESO aplicado; |TIPO 0;
|SI #0#9 ! "X";
    #0#7 = #0#6 % 15;
    |SI #0#4 = "S"; #0#7 = #0#6 % 10; |FINSI;
    |SI #0#4 = "G";
        #0#7 = #0#6 % 20;
        |SI #0#7 > 50000; #0#7 = 50000; |FINSI;
    |FINSI;
    |SI #0#4 = "A";
        |SI #0#7 > 100000; #0#7 = 100000; |FINSI;
    |FINSI;
    pepe = #0#7;
    #0#8 = 0;
    |PINTA #0#7;
    |PINTA #0#8;
|FINSI;
|FPRC;

|PROCESO error; |TIPO 0;
|SI #0#9 ! "X";
   |SI #0#7 > pepe;
       |MENAV "     Exceso sobre el Limite de Deduccion";
       |ERROR;
   |SINO;
       |SI #0#7 ! pepe;
           #0#8 = pepe - #0#7;
           |PINTA #0#8;
       |FINSI;
   |FINSI;
|FINSI;
|FPRC;

|PROCESO nomodi; |TIPO 0;
|SI #0#9 = "X";
    |CAMPO_MODIFICA #0#2, 1, "N";
    |CAMPO_MODIFICA #0#3, 1, "N";
    |CAMPO_MODIFICA #0#4, 1, "N";
    |CAMPO_MODIFICA #0#5, 1, "N";
    |CAMPO_MODIFICA #0#6, 1, "N";
    |CAMPO_MODIFICA #0#7, 1, "N";
    |CAMPO_MODIFICA #0#10, 1, "N";
    |CAMPO_MODIFICA #0#11, 1, "N";
    |CAMPO_MODIFICA #0#13, 1, "N";
    |CAMPO_MODIFICA #0#14, 1, "N";
    |CAMPO_MODIFICA #0#15, 1, "N";
    |CAMPO_MODIFICA #0#16, 1, "N";
|SINO;
    |CAMPO_MODIFICA #0#2, 1, "S";
    |CAMPO_MODIFICA #0#3, 1, "S";
    |CAMPO_MODIFICA #0#4, 1, "S";
    |CAMPO_MODIFICA #0#5, 1, "S";
    |CAMPO_MODIFICA #0#6, 1, "S";
    |CAMPO_MODIFICA #0#7, 1, "S";
    |CAMPO_MODIFICA #0#10, 1, "S";
    |CAMPO_MODIFICA #0#11, 1, "S";
    |CAMPO_MODIFICA #0#13, 1, "S";
    |CAMPO_MODIFICA #0#14, 1, "S";
    |CAMPO_MODIFICA #0#15, 1, "S";
    |CAMPO_MODIFICA #0#16, 1, "S";
|FINSI;
|FPRC;

|PROCESO pinta_nif; |TIPO 7;
|SI #0#4 ! "A"; |ACABA; |FINSI;

|MENSA "     Introduzca el N.I.F. del Arrendador.";
|FPRC;

|PROCESO ValorPatrimo;
     |SI #0#4 ! "S";  |ACABA;  |FINSI;

     |PUSHV 0501 2380;
     |CUADRO 1130 1363;
     |PINTA 1231, "Valor Patrimonial :            ";

     E_inf  = -9999999999;
     E_sup  = 99999999999;
     nValor = #0#17;
     nValor = 1252 ? 1;
     #0#17  = nValor;
     |POPV;
|FPRC;
