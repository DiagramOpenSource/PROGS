|FICHEROS;
     readjren #0;
     redatcon #1;
     repartid #8;
     repant50 #90;

     rew00001 #99,MANTE;

     rew00012 #603;
     rew00013 #604;
     rew00014 #605;
     rew00015 #606;
     rew00016 #607;
     rew00018 #609;
     rew00019 #610;
     rew00021 #612;
|FIN;

|VARIABLES;
     CFBase      = "";
     CFAbre      = "";
     Hoja        = 0;
     NombreInf   = "";
     XCampos     = 0;
     SwEstar     = 0;
     Tempo       = "";
     Modifica    = "";
     NombreImpre = "";
     Casilla     = 0;
     DEmpre      = 0;
     HEmpre      = 0;
     Fefin       = @;
     Feini       = @;
     Dias        = 0;
     Valfa       = "";

     &Tippar      = 0;
     &Parte1      = 0;
     &Parte2      = 0;
     &Muerto      = "";
     &Fecpar      = @;
     &DiaInf     = "";
     &MesInf     = "";
     &EjerInf    = "";
     &VEmpresa    = 0;
     &VTipo       = "";
     &NCopia      = 0;
     &VSwCarga    = 0;
     &VTemporal0  = "";
     &VTemporal3  = "";
     &VTemporal4  = "";
     &VTemporal5  = "";
     &VTemporal6  = "";
     &VTemporal7  = "";
     &VTemporal9  = "";
     &VTemporal10 = "";
     &VTemporal12 = "";

{200}&NEmpresas  = "";
|FIN;

|INCLUYE i_husuar;

|| **************************************************************************
||                           PROCESOS DEL PROGRAMA
|| **************************************************************************

|PROCESO Mayus;
  #0Campo = #0Campo > #0Campo;  |PINTA #0Campo;
|FPRC;

|PROCESO Seleccion; |TIPO 0;
  |SI #0#0 = "S";
      |CAMPO_MODIFICA #0#01, 1, "S";
      |CAMPO_MODIFICA #0#02, 1, "S";

      |PARA XCampos = 3; |SI XCampos [ 32; |HACIENDO XCampos = XCampos + 1;
            #0XCampos = 0; |PINTA #0XCampos;
            |CAMPO_MODIFICA #0XCampos, 1, "N";
      |SIGUE;
  |SINO;
      #0#1 = 00001; |PINTA #0#1;    |CAMPO_MODIFICA #0#01, 1, "N";
      #0#2 = 99999; |PINTA #0#2;    |CAMPO_MODIFICA #0#02, 1, "N";

      |PARA XCampos = 3; |SI XCampos [ 32; |HACIENDO XCampos = XCampos + 1;
            |CAMPO_MODIFICA #0XCampos, 1, "S";
      |SIGUE;
  |FINSI;
|FPRC;

||********************************
|| PROCESOS DE LECTURAS Y REPARTOS
||********************************

|PROCESO PonTemporales;
  Valfa = "";  Tempo = "";
  |DFICE Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal3  = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal4  = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal5  = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal6  = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal7  = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal9  = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal10 = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal12 = Tempo - Valfa;
|FPRC;

|PROCESO BorraTemporales;
  Valfa = "";  Tempo = "";
  |DFICE Valfa;

  Tempo = Valfa + VTemporal3;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal3 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal3 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal3 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal4;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal4 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal4 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal4 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal5;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal5 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal5 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal5 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal6;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal6 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal6 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal6 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal7;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal7 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal7 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal7 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal9;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal9 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal9 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal9 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal10;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal10 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal10 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal10 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal12;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal12 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal12 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal12 + ".ixx";  |FBORRA Tempo;
|FPRC;

|PROCESO CargaHojas;
  VSwCarga = 0;

  |ABRE #1;
  #1#0 = #99#0;
  |LEE 040#1=;
  |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
  |CIERRA #1;

  |SI #1#143 = "S";
      |ABRE #8;
      #8#0 = #1#0;
      |LEE 040#8=;
      |SI FSalida ! 0; |ACABA; |FINSI;
      |CIERRA #8;

      Tippar   = #8#3;
      Muerto   = #8#5;
      |SI #8#3 = 2; Fecpar = #8#4; |SINO; Fecpar = #8#6; |FINSI;
      Feini    = "01.01.1998";
      Fefin    = Fecpar;
      Dias     = Fefin - Feini + 1;
      Parte1   = ((100 * Dias) / 36500) ! 4;
      Parte2   = 1 - Parte1;
      VSwCarga = 1;
  |FINSI;

  |SUB_EJECUTA "rew00012";
  |SUB_EJECUTA "rew00013";
  |SUB_EJECUTA "rew00014";
  |SUB_EJECUTA "rew00015";
  |SUB_EJECUTA "rew00016";
  |SUB_EJECUTA "rew00018";
  |SUB_EJECUTA "rew00019";
  |SUB_EJECUTA "rew00021";
|FPRC;

|PROCESO Impresion;
  NombreInf = "m100" + "ah" + (("00" + Hoja) % -102);


  |INFOR NombreInf;
  |SI FSalida ! 0;  |ACABA;  |FINSI;
  |PRINT;  |PIEINF;  |FININF;
|FPRC;

|DEFBUCLE rew00012;   || Hoja 3
  #603#1;
  ;
  01;
  99;
  ;
  NULL, Impresion;
|FIN;

|DEFBUCLE rew00013;   || Hoja 4
  #604#1;
  ;
  01;
  99;
  ;
  NULL, Impresion;
|FIN;

|DEFBUCLE rew00014;   || Hoja 5
  #605#1;
  ;
  01;
  99;
  ;
  NULL, Impresion;
|FIN;

|DEFBUCLE  rew00015;   || Hoja 6
  #606#1;
  ;
  01;
  99;
  ;
  NULL, Impresion;
|FIN;

|DEFBUCLE  rew00016;   || Hoja 7
  #607#1;
  ;
  01;
  99;
  ;
  NULL, Impresion;
|FIN;

|DEFBUCLE  rew00018;   || Hoja 9
  #609#1;
  ;
  01;
  99;
  ;
  NULL, Impresion;
|FIN;

|DEFBUCLE  rew00019;   || Hoja 10
  #610#1;
  ;
  01;
  99;
  ;
  NULL, Impresion;
|FIN;

|DEFBUCLE  rew00021;   ||Hoja 12
  #612#1;
  ;
  01;
  99;
  ;
  NULL, Impresion;
|FIN;

|PROCESO Papel;
  |NOME_DAT #603 VTemporal3;
  |NOME_DAT #604 VTemporal4;
  |NOME_DAT #605 VTemporal5;
  |NOME_DAT #606 VTemporal6;
  |NOME_DAT #607 VTemporal7;
  |NOME_DAT #609 VTemporal9;
  |NOME_DAT #610 VTemporal10;
  |NOME_DAT #612 VTemporal12;

  Hoja = 3;  |BUCLE rew00012;
  Hoja = 4;  |BUCLE rew00013;
  Hoja = 5;  |BUCLE rew00014;
  Hoja = 6;  |BUCLE rew00015;
  Hoja = 7;  |BUCLE rew00016;
  Hoja = 9;  |BUCLE rew00018;
  Hoja = 10; |BUCLE rew00019;
  Hoja = 12; |BUCLE rew00021;

  #603#121 = #99#7;    #603#122 = #99#3;
  #604#137 = #99#7;    #604#138 = #99#3;
  #605#111 = #99#7;    #605#112 = #99#3;
  #606#161 = #99#7;    #606#162 = #99#3;
  #607#194 = #99#7;    #607#195 = #99#3;
  #609#130 = #99#7;    #609#131 = #99#3;
  #610#129 = #99#7;    #610#130 = #99#3;
  #612#135 = #99#7;    #612#136 = #99#3;
|FPRC;

|PROCESO ImprimeLos;
  |PINPA #0#90;
  #90#0 = #99#0;  |PINTA #90#0;
  #90#1 = #99#3;  |PINTA #90#1;

  VEmpresa = #99#0;
  VTipo    = #99#1;

  |PARA XCampos = 1; |SI XCampos [ #99#4; |HACIENDO XCampos = XCampos + 1;
        #90#3 = XCampos;  |PINTA #90#3;

        |HAZ PonTemporales;
        |HAZ CargaHojas;
        |HAZ Papel;
        |HAZ  BorraTemporales;
  |SIGUE;
|FPRC;

|DEFBUCLE rew00001;
  #99#1;
  5;
  00000, " ", "S";
  99999, "z", "S";
  ;
  NULL, ImprimeLos;
|FIN;

******************** Grabacion del Indexado a Imprimir

|PROCESO GrabaTempo;
  |SI #1#142 = "N"; |ACABA; |FINSI;

  |SI #1#124 = #0#36;  |Y #1#103 ! "A";
      #99#0 = #1#0;
      #99#1 = "A";
      #99#2 = "CONJUNTA";
      #99#3 = #1#1;
      #99#4 = #0#37;
      #99#5 = "S";
      #99#6 = 1;
      #99#7 = #1#2;
      |GRABA 040#99n;
      SwEstar = 1;
  |FINSI;

  |SI #1#125 = #0#36;  |Y #1#104 ! "A";
      #99#0 = #1#0;
      #99#1 = "T";
      #99#2 = "TITULAR";
      #99#3 = #1#1;
      #99#4 = #0#37;
      #99#5 = "S";
      #99#6 = 1;
      #99#7 = #1#2;
      |GRABA 040#99n;
      SwEstar = 1;
  |FINSI;

  |SI #1#126 = #0#36;  |Y #1#105 ! "A";
      #99#0 = #1#0;
      #99#1 = "C";
      #99#2 = "CONYUGE";
      #99#3 = #1#28;
      #99#4 = #0#37;
      #99#5 = "S";
      #99#6 = 1;
      #99#7 = #1#29;
      |GRABA 040#99n;
      SwEstar = 1;
  |FINSI;

  |SI #1#127 = #0#36;  |Y #1#106 ! "A";
      #99#0 = #1#0;
      #99#1 = "1";
      #99#2 = "1. FAMILIAR";
      Casilla = 57 + #1#98; #99#3 = #1Casilla;
      #99#4 = #0#37;
      #99#5 = "S";
      #99#6 = 1;
      Casilla = 47 + #1#98; #99#7 = #1Casilla;
      |GRABA 040#99n;
      SwEstar = 1;
  |FINSI;

  |SI #1#128 = #0#36;  |Y #1#107 ! "A";
      #99#0 = #1#0;
      #99#1 = "2";
      #99#2 = "2. FAMILIAR";
      Casilla = 57 + #1#99; #99#3 = #1Casilla;
      #99#4 = #0#37;
      #99#5 = "S";
      #99#6 = 1;
      Casilla = 47 + #1#99; #99#7 = #1Casilla;
      |GRABA 040#99n;
      SwEstar = 1;
  |FINSI;

  |SI #1#129 = #0#36;  |Y #1#108 ! "A";
      #99#0 = #1#0;
      #99#1 = "3";
      #99#2 = "3. FAMILIAR";
      Casilla = 57 + #1#100;    #99#3 = #1Casilla;
      #99#4 = #0#37;
      #99#5 = "S";
      #99#6 = 1;
      Casilla = 47 + #1#100; #99#7 = #1Casilla;
      |GRABA 040#99n;
      SwEstar = 1;
  |FINSI;

  |SI #1#130 = #0#36;  |Y #1#109 ! "A";
      #99#0 = #1#0;
      #99#1 = "4";
      #99#2 = "4. FAMILIAR";
      Casilla = 57 + #1#101; #99#3 = #1Casilla;
      #99#4 = #0#37;
      #99#5 = "S";
      #99#6 = 1;
      Casilla = 47 + #1#101; #99#7 = #1Casilla;
      |GRABA 040#99n;
      SwEstar = 1;
  |FINSI;
|FPRC;

|DEFBUCLE redatcon;
  #1#1;
  ;
  DEmpre;
  HEmpre;
  ;
  NULL, GrabaTempo;
|FIN;

|RUTINA inferior;
  #99#0 = 1;
  #99#1 = " ";
|FRUT;

|RUTINA superior;
  #99#0 = 99999;
  #99#1 = "z";
|FRUT;

|PROCESO CargaTempo;
  Valfa = "";
  Tempo = "";
  |DFICE Valfa;
  |TEMPO Tempo; VTemporal0 = Tempo - Valfa; |NOME_DAT #99 VTemporal0;
  |ABRE #99;  |CIERRA #99;  |DELINDEX #99;

  |ABRE #99;
  SwEstar = 0;
  |SI #0#0 = "S";
      DEmpre = #0#1;
      HEmpre = #0#2;
      |BUCLE redatcon;
  |SINO;
      |PARA XCampos = 3; |SI XCampos [ 32; |HACIENDO XCampos = XCampos + 1;
            |SI #0XCampos ! 0;
                DEmpre = #0XCampos;
                HEmpre = #0XCampos;
                |BUCLE redatcon;
            |FINSI;
      |SIGUE;
  |FINSI;
  |CIERRA #99;

  |SI SwEstar = 0; |ACABA; |FINSI;

  |SI #0#35 = "N"; |ACABA; |FINSI;

  |ENTLINEAL #1#99, 1, 4, 19, 1, inferior, superior;
|FPRC;

******************** Proceso Marcar y Desmarcar el Entlineal

|PROCESO funcion1; |TIPO 11;
  |SI FSalida ! 9; |ACABA; |FINSI;

  |LIBERA #99;
  |LEE 140#99=;

  |SI #99#5 = "S"; #99#5 = "N"; |SINO; #99#5 = "S"; |FINSI;
  |PINTA #99#5;
  |GRABA 140#99a;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
  |IMPRE 0;
  |SI FSalida ! 0; |ACABA; |FINSI;

  |HAZ CargaTempo;

  |SI SwEstar = 0;
      |DFICE Valfa;
      Tempo = Valfa + VTemporal0;           |FBORRA Tempo;
      Tempo = Valfa + VTemporal0 + ".dat";  |FBORRA Tempo;
      Tempo = Valfa + VTemporal0 + ".ddx";  |FBORRA Tempo;
      Tempo = Valfa + VTemporal0 + ".ixx";  |FBORRA Tempo;
      |ACABA;
  |FINSI;

  |BUCLE rew00001;

  |DFICE Valfa;
  Tempo = Valfa + VTemporal0;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal0 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal0 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal0 + ".ixx";  |FBORRA Tempo;

  |FINIMP;
|FPRC;
