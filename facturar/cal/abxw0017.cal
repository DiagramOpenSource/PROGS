|FICHEROS;
     abom0001 #101;
     abom0007 #107;
     abom0511 #511;
     abxm0505 #505,MANTE;
     abxm0506 #506;
     abxm0512 #512,MANTE;
     abxm0022 #522,MANTE;
     abxw0017 #917;
     asconlin #17;
     asconcli #20;
|FIN;

|VARIABLES;
     nVentana    = 0;
     nVariable   = 0;
     nCampo1     = 0;
     nFichero    = 0;
     nCliente    = 0;
     nID         = 0;

     aSeccion    = "";
     aConcepto   = "";
     aAlfa       = "";
     aID         = "";

     {-1}aVent       = "";
         aVent1      = 0;
         aVent2      = 0;
         aVent3      = 0;
         aVent4      = 0;
         aVent5      = "";


  {13} aPopup        = "";

|FIN;

|PROCESO Tipo12Fxw17;  |TIPO 12;
|FPRC;

|PROCESO Tipo7C129Fxw17;  |TIPO 7;
     |C_M #917#129, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     aAlfa = "|C129WID";
     aID   = #917#aAlfa#;
     nID   = aID;

     aPopup1  = nID;
     aPopup2  = 11;
     aPopup3  = "0 - Solo el dia del aviso";
     aPopup4  = "T - Todos los dias";
     aPopup5  = "2 - Dos semanas antes";
     aPopup6  = "1 - Una semena antes";
     aPopup7  = "L - Todos los lunes";
     aPopup8  = "M - Todos los martes";
     aPopup9  = "X - Todos los miercoles";
     aPopup10 = "J - Todos los jueves";
     aPopup11 = "V - Todos los viernes";
     aPopup12 = "S - Todos los sabados";
     aPopup13 = "D - Todos los domingos";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         |SI FSalida = 1;   #917#129 = "0";   |FINSI;
         |SI FSalida = 2;   #917#129 = "T";         |FINSI;
         |SI FSalida = 3;   #917#129 = "2";         |FINSI;
         |SI FSalida = 4;   #917#129 = "1";         |FINSI;
         |SI FSalida = 5;   #917#129 = "L";         |FINSI;
         |SI FSalida = 6;   #917#129 = "M";         |FINSI;
         |SI FSalida = 7;   #917#129 = "X";         |FINSI;
         |SI FSalida = 8;   #917#129 = "J";         |FINSI;
         |SI FSalida = 9;   #917#129 = "V";         |FINSI;
         |SI FSalida = 10;  #917#129 = "S";         |FINSI;
         |SI FSalida = 11;  #917#129 = "D";         |FINSI;

         |PINTA #917#129;
     |FINSI;
|FPRC;

|PROCESO Tipo0C128Fxw17;  |TIPO 0;
     |SI #917#128 = "S";
         |C_M #917#129, 1, "S";
         |C_M #917#130, 1, "S";
         |C_M #917#131, 1, "S";
         |C_M #917#132, 1, "S";
     |SINO;
         |C_M #917#129, 1, "N";
         |C_M #917#130, 1, "N";
         |C_M #917#131, 1, "N";
         |C_M #917#132, 1, "N";

         #917#129 = " ";
         #917#130 = "01.01.0000";
         #917#131 = "  ";
         #917#132 = "  ";
     |FINSI;

     |PINTA #917#129;
     |PINTA #917#130;
     |PINTA #917#131;
     |PINTA #917#132;
|FPRC;

|PROCESO Tipo66C10Fxw17;  |TIPO 66;
     |ABRE #512;
     #512#0 = #917#10;
     |LEE 000#512=;
     |SI FSalida ! 0;  |DDEFECTO #512;  |FINSI;

     |CONSULTA_CLAVE #1#512;
     |SI FSalida = 0;
         #917#10 = #512#0;   |PINTA #917#10;
     |FINSI;
     |CIERRA #512;
|FPRC;

|PROCESO Tipo6C10Fxw17;  |TIPO 6;
     |ABRE #512;
     #512#0 = #917#10;
     |LEE 000#512=;
     |SI FSalida = 0;
         #917#11 = #512#3;
         #917#12 = #512#2;
         #917#13 = #512#4;
         #917#14 = #512#5;
         #917#15 = #512#6;
         #917#19 = "N";
         #917#20 = "N";

         |SI #917#12 = "S";
             |C_M #917#128, 1, "S";
             |C_M #917#133, 1, "S";

             |MENAV "0000 Apunte de agenda, no olvide completar los datos de agenda";
         |SINO;
             |C_M #917#128, 1, "N";
             |C_M #917#133, 1, "N";

             #917#128 = "N";
             #917#129 = " ";
             #917#130 = "01.01.0000";
             #917#131 = "  ";
             #917#132 = "  ";
             #917#133 = "N";
         |FINSI;

         #917#18 = 0;
         |SI #522#34 = "S";
             #917#18 = #917#16 * #917#17;
         |FINSI;

         |PINTA #917#18;
         |PINTA #917#128;
         |PINTA #917#129;
         |PINTA #917#130;
         |PINTA #917#131;
         |PINTA #917#132;
         |PINTA #917#133;

         |CIERRA #512;
         |ACABA;
     |FINSI;

     |CONFI "0000 No existe la opci¢n del seguimiento, quiere darlo de alta";
     |SI FSalida ! 0;
         |CIERRA #512;
         |ERROR;
         |ACABA;
     |FINSI;

     |VENTANA 1201, 3499, -1, 17, "Alta - Opciones seguimientos";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DDEFECTO #512;
     #512#0 = #917#10;

     |PINPA #0#512;
     |PINDA #0#512;
     |ENDATOS #1#512;
     |SI FSalida = 0;
         |GRABA 020#512n;
         |LIBERA #512;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     |CIERRA #512;

     |ERROR;
|FPRC;

|PROCESO Tipo66C5Fxw17;  |TIPO 66;
     |ABRE #522;
     #522#0 = #917#5;
     #522#1 = #917#6;
     |LEE 000#522=;
     |SI FSalida ! 0;  |DDEFECTO #522;  |FINSI;

     |CONSULTA_CLAVE #1#522;
     |SI FSalida = 0;
         #917#5 = #522#0;   |PINTA #917#5;
         #917#6 = #522#1;   |PINTA #917#6;
     |FINSI;
     |CIERRA #522;
|FPRC;

|PROCESO RecogeTexto;
     |ABRE #107;
     #107#0 = #917#0;
     #107#1 = #917#1;
     #107#2 = 1;
     |LEE 040#107];
     |SI FSalida = 0;  |Y #107#0 = #917#0; |Y #107#1 = #917#1;
         |CIERRA #107;
         |ACABA;
     |FINSI;

     |ABRE #17;
     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
           nCampo1 = 27 + nVariable;
           #17#0   = nFichero;
           #17#1   = nCliente;
           #17#2   = aSeccion;
           #17#3   = aConcepto;
           #17#4   = nVariable;
           |LEE 040#17=;
           |SI FSalida = 0;
               #917nCampo1 = #17#5;
           |FINSI;
     |SIGUE;

     |CIERRA #107;
     |CIERRA #17;
|FPRC;

|PROCESO Tipo6C6Fxw17;  |TIPO 6;
     |ABRE #522;
     #522#0 = #917#5;
     #522#1 = #917#6;
     |LEE 000#522=;
     |SI FSalida = 0;
         |C_M #917#16, 1, "S";
         |C_M #917#18, 1, "N";

         |SI #522#34 = "N";
             |C_M #917#16, 1, "N";
             |C_M #917#18, 1, "S";
         |FINSI;
         |PINTA #917#16;
         |PINTA #917#18;

         |ABRE #20;
         #20#0 = #101#3;
         #20#1 = #917#5;
         #20#2 = #917#6;
         |LEE 000#20=;
         |SI FSalida = 0;
             nFichero  = 2;
             nCliente  = #20#0;
             aSeccion  = #20#1;
             aConcepto = #20#2;
             |HAZ RecogeTexto;
         |SINO;
             nFichero  = 1;
             nCliente  = 0;
             aSeccion  = #522#0;
             aConcepto = #522#1;
             |HAZ RecogeTexto;
         |FINSI;
         |CIERRA #20;

         |PINTA #917#28;

         |CIERRA #522;
         |ACABA;
     |FINSI;
     |CIERRA #522;

     |CONFI "0000 No existe el servicio de minutaci¢n, quiere darlo de alta";
     |SI FSalida ! 0;
         |CIERRA #522;
         |ERROR;
         |ACABA;
     |FINSI;

     |VENTANA 1201, 3499, -1, 17, "Alta - Servicios";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DDEFECTO #522;
     #522#0 = #917#5;
     #522#1 = #917#6;

     |PINPA #0#522;
     |PINDA #0#522;
     |ENDATOS #1#522;
     |SI FSalida = 0;
         |GRABA 020#522n;
         |LIBERA #522;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     |CIERRA #522;

     |ERROR;
|FPRC;

|PROCESO Tipo66C2Fxw17;  |TIPO 66;
     |ABRE #505;
     #505#0 = #917#2;
     |LEE 000#505=;
     |SI FSalida ! 0;  |DDEFECTO #505;  |FINSI;

     |CONSULTA_CLAVE #1#505;
     |SI FSalida = 0;
         #917#2 = #505#0;   |PINTA #917#2;
         #917#3 = #505#1;   |PINTA #917#3;
     |FINSI;
     |CIERRA #505;
|FPRC;

|PROCESO Tipo6C2Fxw17;  |TIPO 6;
     |ABRE #505;
     #505#0 = #917#2;
     |LEE 000#505=;
     |SI FSalida = 0;
         #917#2  = #505#0;   |PINTA #917#2;
         #917#3  = #505#1;   |PINTA #917#3;
         #917#17 = (#505#19 / (60 / #505#20));

         |CIERRA #505;
         |ACABA;
     |FINSI;

     |CONFI "0000 No existe la persona del despacho, quiere darlo de alta";
     |SI FSalida ! 0;
         |CIERRA #505;
         |ERROR;
         |ACABA;
     |FINSI;

     |VENTANA 1201, 3499, -1, 17, "Alta - Personal del despacho";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DDEFECTO #505;
     #505#0 = #917#2;

     |PINPA #0#505;
     |PINDA #0#505;
     |ENDATOS #1#505;
     |SI FSalida = 0;
         |GRABA 020#505n;
         |LIBERA #505;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     |CIERRA #505;

     |ERROR;
|FPRC;
