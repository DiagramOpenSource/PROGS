|FICHEROS;
     abom0017 #0;        ||Este def

     abom0001 #1;        ||Expedientes
     abom0002 #2;        ||Expedientes Docum.
|FIN;

|VARIABLES;
     aIPRemoto = "";
     fSistema = @;
     fFecha = @;
     fFechaUltima = @;

     nSwHay = 0;
     nDiasFecha = 0;
     nDiaSis = 0;

     nExiste = 0;
     aMensaje = "";
     aRespuesta = "";
     aAlfa = "";
     nDias = 0;

     &eaTipoEnvio = "";
     &enNumExp = 0;
     &efFechaMov = @;
     &enCodDestino = 0;
     &enCodDesDos = 0;
|FIN;

|PROCESO abom0002;
     |SI fFechaUltima [ #abom0002#7;
          fFechaUltima = #abom0002#7;
          nSwHay = 1;
     |FINSI;
|FPRC;

|DEFBUCLE abom0002;
     #abom0002#1;
     ;
     #abom0001#0, 1;
     #abom0001#0, 1;
     ;
     NULL, abom0002;
|FIN;

|PROCESO DifDias;
     nDiasFecha = fFecha;
     nDias = nDiaSis - nDiasFecha;
|FPRC;

|PROCESO UltimoMovimiento;
     fFechaUltima = "01.01.0000";
     nSwHay = 0;
     |BUCLE abom0002;
     |SI nSwHay = 0;
          fFecha = #abom0001#1;
          |HAZ DifDias;
     |SINO;
          fFecha = fFechaUltima;
          |HAZ DifDias;
     |FINSI;
|FPRC;

|PROCESO abom0001;
     aAlfa = #abom0001#2;
     |QBF aAlfa;
     |SI aAlfa ! "01.01.0000";  |ACABA;  |FINSI;  ||Es decir esta cerrado

     nDias = 0;
     |HAZ UltimoMovimiento;

     |SI #abom0001#54 = "S";
         |SI nDias ] 90;
             efFechaMov   = fFecha;
             enNumExp     = #abom0001#0;
             enCodDestino = #abom0001#5;
             enCodDesDos  = #abom0001#28;
             eaTipoEnvio  = "90DIAS";
             |HAZ CtrlAlarmas;
          |FINSI;

          |ACABA;
     |FINSI;

     |SI PARAMETRO = "";
         |SI nDias ] 50;
             efFechaMov   = fFecha;
             enNumExp     = #abom0001#0;
             enCodDestino = #abom0001#5;
             enCodDesDos  = #abom0001#28;
             eaTipoEnvio  = "50DIAS";
             |HAZ CtrlAlarmas;
          |FINSI;

          |ACABA;
     |FINSI;

     aAlfa = #abom0001#0;
     aAlfa = aAlfa % 101;

     |SI PARAMETRO = "40";
         |SI aAlfa ! "3";  |ACABA;  |FINSI;

         |SI nDias ] 40;
             efFechaMov   = fFecha;
             enNumExp     = #abom0001#0;
             enCodDestino = #abom0001#5;
             enCodDesDos  = #abom0001#28;
             eaTipoEnvio  = "40DIAS";
             |HAZ CtrlAlarmas;
          |FINSI;

          |ACABA;
     |FINSI;

     |SI PARAMETRO = "50";
         |SI aAlfa = "3";  |ACABA;  |FINSI;

         |SI nDias ] 50;
             efFechaMov   = fFecha;
             enNumExp     = #abom0001#0;
             enCodDestino = #abom0001#5;
             enCodDesDos  = #abom0001#28;
             eaTipoEnvio  = "50DIAS";
             |HAZ CtrlAlarmas;
          |FINSI;

          |ACABA;
     |FINSI;
|FPRC;

|DEFBUCLE abom0001;
     #abom0001#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, abom0001;
|FIN;

|PROCESO Principal;
     |BUCLE abom0001;

     enNumExp = 0;
     |HAZ EnviaSituacion;
|FPRC;

|PROGRAMA;
     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;
     |QBT aIPRemoto;
     fSistema = ~;
     nDiaSis = fSistema;

     |CLS;
     |HAZ Principal;
|FPRO;
