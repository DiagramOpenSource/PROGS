|FICHEROS;
     ashisfac #0;                         ||CALCULO DESDE-HASTA PARA INFORMES;
     asinfhdf #1;
     asclient #2;
|FIN;

|VARIABLES;
     informe = "asinfhdf";
     men1 = "     NO EXISTE INFORME.";
     men2 = "     NO EXISTE IMPRESORA.";
     men3 = "     NO SE PUDIERON SELECCIONAR REGISTROS";
     sw1 = 0;                            ||CAMBIAR VARIABLE informe NOMBRE;
     sw2 = 0;                            ||DE FICHERO Y DE CALCULO.       ;
     &ordena = " ";
     serie = "Serie-Factura.";
     cliente = "Cliente.";
     fech = "Fecha.";
     fFech = @;
     qFech = "";
     dFech = "";
     hFech = "";
|FIN;


|CALCULO imprimir;
   #2#0 = #0#3;
   |LEE 040#2=;
   #2#7 = #2#7 ! 0;
   #2#9 = #2#9 ! 0;
   |PRINT;
|FCAL;

|DEFBUCLE cainfhdf0;
#0#1;
3,2;
#1#0,#1#2,#1#4,#1#6;
#1#1,#1#3,#1#5,#1#7;
e;
NULL,imprimir;
|FIN;


|DEFBUCLE cainfhdf1;          ||Por cliente
#0#2;
2;
#1#4,#1#0,#1#2,#1#6;
#1#5,#1#1,#1#3,#1#7;
e;
NULL,imprimir;
|FIN;


|DEFBUCLE cainfhdf2;          ||Por fecha
#0#3;
3;
#1#6,#1#0,#1#2,#1#4;
#1#7,#1#1,#1#3,#1#5;
e;
NULL,imprimir;
|FIN;


|CALCULO impre;|TIPO 3;
|ABRE #2;
|IMPRE 0;                                ||Abre impresora;
|SI FSalida ! 0;
    |MENAV men2;
    |VETE termina;
|FINSI;
|INFOR informe;
|SI FSalida ! 0;
    |MENAV men1;
    |FINIMP;
    |VETE termina;
|FINSI;
|HAZ clave;
|PIEINF;                      ||condicion salto pagina;
|FININF;                          ||cierra informe;
|FINIMP;
|ET termina;
|LIBERA #2;
|CIERRA #2;
|FCAL;                                   ||termina el calculo;


|CALCULO clave;
|SI #1#8 = 1;
       ordena = serie;
    |BUCLE cainfhdf0;
|FINSI;
|SI #1#8 = 2;
       ordena = cliente;
    |BUCLE cainfhdf1;
|FINSI;
|SI #1#8 = 3;
       ordena = fech;
    |BUCLE cainfhdf2;
|FINSI;
|FCAL;

|PROCESO sacaano; |TIPO 7;
     fFech = ~;
     qFech = fFech % -104;
     dFech = "01.01." + qFech;
     hFech = "31.12." + qFech;
     #1#6  = dFech;
     #1#7  = hFech;
     |PINTA #1#6;
     |PINTA #1#7;
|FPRC;
