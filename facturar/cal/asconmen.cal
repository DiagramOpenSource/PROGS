|FICHEROS;
     asconmen #0;                           || CALCULO PARA OPCION DE IM-   ;
     asconcep #1;
     asconlin #7;
|FIN;

|VARIABLES;
|FIN;

|VARIABLES;
      nVariable     = 0;
      nModo         = 0;
      aAlfa         = "";

     &enDentro      = 0;
     &eaNombreList  = "";
     &enCuadroIni   = 0;
     &enCuadroFin   = 0;
     &enCampoAncho  = 0;
     &enModoEdita   = 0;
     &enTotalVaria  = 0;
{101}&epPuntEdita   = "";
|FIN;

|PROCESO RecogeTexto3;  |TIPO 7;
     |ABRE #7;
     #7#0 = 3;
     #7#1 = 0;
     #7#2 = #0#0;
     #7#3 = #0#1;
     #7#4 = 1;
     |LEE 040#7=;
     |SI FSalida ! 0;
         |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
               #7#0 = 1;
               #7#1 = 0;
               #7#2 = #0#0;
               #7#3 = #0#1;
               #7#4 = nVariable;
               |LEE 040#7=;
               |SI FSalida = 0;
                   #7#0 = 3;
                   #7#1 = 0;
                   #7#2 = #0#0;
                   #7#3 = #0#1;
                   #7#4 = nVariable;
                   |GRABA 020#7n;
                   |LIBERA #7;

                   |SI nVariable = 1;  #0#2 = #7#5;  |FINSI;
                   |SI nVariable = 2;  #0#3 = #7#5;  |FINSI;
                   |SI nVariable = 3;  #0#4 = #7#5;  |FINSI;
               |FINSI;
         |SIGUE;
     |FINSI;

     |PINTA #0#2;
     |PINTA #0#3;
     |PINTA #0#4;

     |CIERRA #7;
|FPRC;

|PROCESO EditaTexto3;  |TIPO 7;
     enTotalVaria  = 99;
     eaNombreList  = "";
     enCuadroIni   = 1322;
     enCuadroFin   = 2171;
     enCampoAncho  = 50;
     enModoEdita   = 0;

     |ABRE #7;

     #7#0 = 3;
     #7#1 = 0;
     #7#2 = #0#0;
     #7#3 = #0#1;
     #7#4 = 1;
     |LEE 101#7=;
     |SI FSalida ! 0;
         #7#5 = #0#2;
         |GRABA 020#7n;
     |FINSI;
     |LIBERA #7;

     #7#0 = 3;
     #7#1 = 0;
     #7#2 = #0#0;
     #7#3 = #0#1;
     #7#4 = 2;
     |LEE 101#7=;
     |SI FSalida ! 0;
         #7#5 = #0#3;
         |GRABA 020#7n;
     |FINSI;
     |LIBERA #7;

     #7#0 = 3;
     #7#1 = 0;
     #7#2 = #0#0;
     #7#3 = #0#1;
     #7#4 = 3;
     |LEE 101#7=;
     |SI FSalida ! 0;
         #7#5 = #0#4;
         |GRABA 020#7n;
     |FINSI;
     |LIBERA #7;

     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita  = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           #7#0 = 3;
           #7#1 = 0;
           #7#2 = #0#0;
           #7#3 = #0#1;
           #7#4 = nVariable;
           |LEE 101#7=;
           |SI FSalida ! 0;
               epPuntEdita  = "";
           |SINO;
               epPuntEdita  = #7#5;
               |BORRA 020#7a;
           |FINSI;
           |LIBERA #7;
     |SIGUE;

     |PUSHV  0501 2380;
     |CUADRO 1221 2272;
     |BLANCO 1322 2171;
     |ATRI S;  |PINTA 1425, "Introduzca el Texto del Servicio Variable";  |ATRI s;

     |HAZ Edita;
     |POPV;

     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           |DDEFECTO #7;
           #7#0 = 3;
           #7#1 = 0;
           #7#2 = #0#0;
           #7#3 = #0#1;
           #7#4 = nVariable;
           |LEE 1010#7=;
           |SI FSalida ! 0;  |GRABA 020#7b;  |FINSI;
           #7#5 = epPuntEdita;
           |GRABA 020#7a;
           |LIBERA #7;

           |SI nVariable = 1;  #0#2 = #7#5;  |FINSI;
           |SI nVariable = 2;  #0#3 = #7#5;  |FINSI;
           |SI nVariable = 3;  #0#4 = #7#5;  |FINSI;
     |SIGUE;

     |PARA nVariable = 100;  |SI nVariable ] 1;  |HACIENDO nVariable = nVariable - 1;
           #7#0 = 3;
           #7#1 = 0;
           #7#2 = #0#0;
           #7#3 = #0#1;
           #7#4 = nVariable;
           |LEE 101#7=;
           aAlfa = #7#5;  |QBF aAlfa;

           |LIBERA #7;

           |SI aAlfa ! "";  |SAL;  |FINSI;

           |BORRA 020#7a;
     |SIGUE;

     |CIERRA #7;

     |PINTA #0#2;
     |PINTA #0#3;
     |PINTA #0#4;
|FPRC;

|PROCESO BajaTexto3;  |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 3;  |ACABA;  |FINSI;

     |ABRE #7;
     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
          #7#0 = 3;
          #7#1 = 0;
          #7#2 = #0#0;
          #7#3 = #0#1;
          #7#4 = nVariable;
          |LEE 101#7=;
          |SI FSalida = 0;
              |BORRA 020#7a;
          |FINSI;
          |LIBERA #7;
     |SIGUE;
     |CIERRA #7;
|FPRC;
