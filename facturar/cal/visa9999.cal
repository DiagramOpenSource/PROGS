|VARIABLES;
     aIPRemoto        = "";
     aAlfa            = "";
     aAlfa1           = "";
     aLen             = "";
     aDecima          = "";
     aEntero          = "";
     aImpor1          = "";
     aImpor2          = "";
     aDocRemoto       = "";
     aDocRemotoTra    = "";
     aDocServidor     = "";
     aBase            = "";
     aDirec           = "";
     aLogo            = "";
     aGuarda          = "";
     aAbre            = "";
     aPath            = "";
     aSit             = "";
     aUsuario         = "";

     nSwError         = 0;
     nInstala         = 0;
     nLen             = 0;
     nLongitud        = 0;
     nSer             = 0;
     nLong            = 0;
     nBarra           = 0;
     nWord            = 0;
     nCar             = 0;
     nPos             = 0;
     nCampo           = 0;
     nDecimal         = 0;
     nCaracter        = 0;
     nHandle          = 0;
     nHandleYa        = 0;
     nTope            = 0;
     nPuntero         = 0;
     nIdSalir         = 0;
     nIdSalir1        = 0;
     nIdSalir2        = 0;
     nIdSalir3        = 0;
     nLinea           = 0;
     nHay             = 0;
     nDeci            = 0;

     &eaAlfa          = "";
     &eaImporte       = "";
     &eaPathLogo      = "";
     &eaPathLogoIso   = "";
     &eaAsigna        = "";
     &eaMes           = "";
     &enWord1         = 0;
     &enWord2         = 0;
     &enCamWord       = 0;
     &enModoExterno   = 0;
     &enHandleTxt     = 0;
     &enHandleTxt2    = 0;
     &enCargaPuntero  = 0;
     &efFecha         = @;

     &eaDirPlantilla  = "";
     &eaDirTrabajo    = "";
     &eaDirTrabServi  = "";
     &eaDirDocId2     = "";
     &eaDirTraId2     = "";
     &eaDirSerGuarda  = "";
     &eaDirSerPlan    = "";
     &eaOrigen        = "";
     &eaDestino       = "";
     &eaDestinoTra    = "";
     &eaFicheroTra    = "";
     &eaFicheroXgz    = "";
     &eaFicheroTgz    = "";
     &eaFicheroTar    = "";
     &eaFicheroTxt    = "";
     &eaFicheroPlaGz  = "";
     &eaFicheroPlaMl  = "";
     &eaEtiqueta      = "";
     &eaPlanilla      = "";
     &ea16            = "";
     &eaTipoImpresion = "";
     &enConverPDF     = 0;
     &eaUnidadBasico  = "";

     {1}aContiene     = "";

     &enError      = 0;
|FIN;

|PROCESO EnviaFicheroConMD5;
     aContiene1 = eaDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = eaOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     |SI aDocRemoto ! aDocServidor;
         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO eaOrigen, eaDestino;
         |SINO;
             |COPIA_FICHERO eaOrigen, eaDestino;
         |FINSI;

         aContiene1 = eaDestino;
         |ESPECIFICA "REMOTOMD5", aContiene;
         aDocRemoto = FSalida;  |QBF aDocRemoto;
     |FINSI;

     |SI eaDestinoTra ! "";  |Y eaDestinoTra ! eaDestino;
         aContiene1 = eaDestinoTra;
         |ESPECIFICA "REMOTOMD5", aContiene;
         aDocRemotoTra = FSalida;  |QBF aDocRemotoTra;

         |SI aDocRemoto ! aDocRemotoTra;  |O aDocRemotoTra = "";
             |RCOPIA_FICHERO eaDestino, eaDestinoTra;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO InstalaDsPDF;
     |HAZ LeeUnidadBasico;

     |DBASE aBase;  |QBF aBase;

     eaDirSerPlan   = aBase + "plantillas/";
     eaDirPlantilla = eaUnidadBasico + "\DOCUMENTOS\";
     |RMKDIR eaDirPlantilla;
     eaDirPlantilla = eaDirPlantilla + "FACTURAR\";
     |RMKDIR eaDirPlantilla;
     eaDirPlantilla = eaDirPlantilla + "PLANTILLAS\";
     |RMKDIR eaDirPlantilla;

     nInstala = 0;

     aAlfa = eaUnidadBasico + "\ds\dspdf\bin\puerto.exe";
     |XABRE "EC", aAlfa, nHandle;
     |SI FSalida < 0;  nInstala = 1;  |FINSI;

     eaOrigen       = eaDirSerPlan   + "dspdf.tgz";
     eaDestino      = eaDirPlantilla + "dspdf.tgz";
     eaDestinoTra   = "";

     |HAZ EnviaFicheroConMD5;
     |SI aDocRemoto ! aDocServidor;
         nInstala = 1;
     |FINSI;

     |SI nInstala = 1;
         aAlfa = eaDirPlantilla + "dspdf.tgz";
         Pos   = -1;
         |RDESCOMPRIME aAlfa;
         aAlfa1 = eaUnidadBasico + "\ds\";
         |RDETAR aAlfa, aAlfa1;

         aAlfa = eaDirPlantilla + "dspdf.tar";  |RFBORRA aAlfa;

         aAlfa = eaUnidadBasico + "\ds\dspdf\bin\puerto.exe";
         |XABRE "EC", aAlfa, nHandle;
         |SI FSalida < 0;
             |MENAV "0000 No puedo instalar la impresora en PDF.";
             nSwError = -1; |ACABA;
         |FINSI;

         aAlfa  = "cmd " + &34 + "/c START /WAIT " + eaUnidadBasico + "\DS\DSPDF\BIN\PUERTO.EXE" + &34;
         |RSYSTEM aAlfa;
     |FINSI;
|FPRC;
