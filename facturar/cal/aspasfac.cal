|FICHEROS;
     aspasfac #0;
     ashismic #1;
     ashismil #2;
     ashismit #3;

     ascabmin #10;
     aslinmin #11;
     aslinmil #12;
     asempcon #8;
     asenlcon #6;

     asw00001 #99;

     ascontro #5;
     ascontrt #450;

     asclient;
     ashismic@ #1001;
|FIN;

|VARIABLES;
     aMas          = "";
     aPath         = "";
     aAlfa1        = "";
     aAlfa2        = "";
     aAlfa         = "";

     fDFecha       = @;
     fFecha        = @;

     nHay          = 0;
     nNume         = 0;
     nIVA          = 0;
|FIN;

|INCLUYE agicon_i;

|PROCESO ashismit;
     #12#0  = #11#0;
     #12#1  = #11#1;
     #12#2  = #11#2;
     #12#3  = #3#3;
     #12#4  = #3#4;
     |GRABA 020#12n;
     |LIBERA #12;
|FPRC;

|DEFBUCLE ashismit;
     #3#1;
     ;
     #2#0, #2#1, #2#2, 000;
     #2#0, #2#1, #2#2, 999;
     ;
     NULL, ashismit;
|FIN;

|PROCESO IVA;
     |ABRE #450;
     #450#0 = #10#0;
     |LEE 000#450=;
     |SI FSalida ! 0; |DDEFECTO #450; |FINSI;
     |CIERRA #450;

     nIVA = #450#3;
|FPRC;

|PROCESO AltaConta;
     #6#0 = #11#4;
     #6#1 = #11#5;
     |LEE 000#6=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     #99#0 = #11#0;
     #99#1 = #11#1;
     #99#2 = #11#2;
     |LEE 101#99=;
     |SI FSalida ! 0;
         #99#0 = #11#0;
         #99#1 = #11#1;
         #99#2 = #11#2;
         |GRABA 020#99b;
     |FINSI;

     #99#3  = #8#1;
     #99#4  = #8#2;
     #99#5  = ("0000" + #11#3) % -104;
     aAlfa  = #8#3;  |QBF aAlfa;
     aAlfa  = aAlfa + (("00000" + #11#1) % -105);
     #99#6  = aAlfa;
     #99#7  = #6#2;
     #99#8  = #6#6;
     #99#9  = #6#3;
     #99#10 = #6#4;
     #99#11 = #11#13;
     #99#12 = #6#5;
     #99#13 = 0;
     #99#14 = "";
     |GRABA 020#99a;
|FPRC;

|PROCESO ashismil;
     #11#0  = #10#0;
     #11#1  = #10#1;
     #11#2  = #2#2;
     fFecha = ~;
     aAlfa1 = fFecha % 102;
     aAlfa2 = fFecha % 402;
     aAlfa  = aAlfa1 + aAlfa2;
     #11#3  = aAlfa;
     #11#4  = #2#4;
     #11#5  = #2#5;
     #11#6  = #2#6;
     #11#7  = #2#7;
     #11#8  = #2#8;
     #11#9  = #2#9;
     #11#10 = #2#10;
     #11#11 = #2#11;
     #11#12 = #2#12 > #0#4;
     #11#13 = #11#11 * #11#12;
     #11#14 = #2#14;
     #11#15 = fFecha;
     #11#17 = #2#15;
     #11#18 = #2#30;

     |SI #11#10 = "H";  #10#17 = #10#17 + #11#13;  |FINSI;
     |SI #11#10 = "S";  #10#18 = #10#18 + #11#13;  |FINSI;
     |SI #11#10 = "A";  #10#19 = #10#19 + #11#13;  |FINSI;

     |GRABA 020#11n;
     |LIBERA #11;

     |HAZ AltaConta;

     |ABRE #5;
     |LEE 040#5p;
     |SI FSalida ! 0; |DDEFECTO #5; |FINSI;
     |CIERRA #5;

     |HAZ IVA;

     #10#21 = #10#17 % #10#20;
     #10#22 = #10#17 - #10#21;
     #10#23 = #10#22 % nIVA;
     #10#24 = #10#22 + #10#23 + #10#18;
     |SI #10#12 = "S";
         #10#25 = #10#22 % #5#31;
     |SINO;
         #10#25 = 0;
     |FINSI;
     #10#26 = #10#24 - #10#25 - #10#19;

     |BUCLE ashismit;
|FPRC;

|DEFBUCLE ashismil;
     #2#1;
     ;
     #1#0, #1#1, 001;
     #1#0, #1#1, 999;
     ;
     NULL, ashismil;
|FIN;

|PROCESO ashismic2;
     nHay = 1;
|FPRC;

|DEFBUCLE ashismic2;
    #1001#5005;
    ;
    "S",      fDFecha, #1#3, "  ", 00000;
    "S", "31.12.2999", #1#3, "zz", 99999;
    ;
    NULL, ashismic2;
|FIN;

|PROCESO ashismic;
     #10#0  = #1#2;
     #10#1  = #1#3;
     |LEE 000#10=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     nHay = 0;
     |BUCLE ashismic2;

     |SI nHay = 1;  |ACABA;  |FINSI;

     |DDEFECTO #10;
     #10#0  = #1#2;
     #10#1  = #1#3;
     #10#2  = #1#4;
     #10#3  = #1#5;
     #10#4  = #1#6;
     #10#5  = #1#7;
     #10#6  = #1#8;
     #10#7  = #1#9;
     #10#8  = #1#10;
     #10#9  = #1#11;
     #10#10 = #1#12;
     #10#11 = #1#13;
     #10#12 = #1#14;
     #10#13 = #1#15;
     #10#14 = #1#16;
     #10#15 = #1#17;
     #10#16 = #1#18;
     #10#20 = #1#22;
     #10#30 = #1#34;
     #10#31 = #1#35;
     #10#32 = #1#36;
     #10#33 = #1#44;

     |BUCLE ashismil;

     |ABRE #5;
     |LEE 040#5p;
     |SI FSalida ! 0; |DDEFECTO #5; |FINSI;
     |CIERRA #5;

     |HAZ IVA;

     #10#21 = #10#17 % #10#20;
     #10#22 = #10#17 - #10#21;
     #10#23 = #10#22 % nIVA;
     #10#24 = #10#22 + #10#23 + #10#18;
     |SI #10#12 = "S";
         #10#25 = #10#22 % #5#31;
     |SINO;
         #10#25 = 0;
     |FINSI;
     #10#26 = #10#24 - #10#25 - #10#19;

     |GRABA 020#10n;
     |LIBERA #10;
|FPRC;

|DEFBUCLE ashismic;
    #1#5;
    ;
    "S", #0#2, #0#0, "  ", 00000;
    "S", #0#3, #0#1, "zz", 99999;
    ;
    NULL, ashismic;
|FIN;

|PROCESO Tipo12;  |TIPO 12;
     |SI #0#5 ! "SI";  |ACABA;  |FINSI;

     |ABRE #8;
     |LEE 000#8p;
     |SI FSalida ! 0; |DDEFECTO #8; |FINSI;
     |CIERRA #8;

     |DBASE aPath;  |QBF aPath;
     aMas = aPath + "def/ashismic.mas";
     |CARGA_DEF aMas, ashismic@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nNume   = #0#3;
     nNume   = nNume + 1;
     fDFecha = nNume;

     |ABRE #1001;
     |ABRE #6;
     |ABRE #10;
     |ABRE #11;
     |ABRE #12;
     |ABRE #99;
     |BUCLE ashismic;
     |CIERRA #1001;
     |CIERRA #6;
     |CIERRA #10;
     |CIERRA #11;
     |CIERRA #12;
     |CIERRA #99;

     |DESCARGA_DEF #ashismic@;
|FPRC;
