|FICHEROS;
     abor0006 #0,MANTE;
     abom0001 #6;
     abom0511 #511;
     abow0016 #916;
|FIN;

|VARIABLES;
     aHora          = "";
     aAlfa          = "";
     nMasMenos      = 0;
     nModo          = 0;
     nVariable      = 0;
     nForma         = 0;
     nLinea         = 0;
     nArregla       = 0;
     nSw            = 0;

     fFecha         = @;
     fDFecha        = @;
     fHFecha        = @;

     &enDentro      = 0;
     &enCodExpe     = 0;
     &enCodPers     = 0;

     &eaNombreList  = "";
     &enCuadroIni   = 0;
     &enCuadroFin   = 0;
     &enCampoAncho  = 0;
     &enModoEdita   = 0;
     &enTotalVaria  = 0;
     &eaUnidadBasico = "";

{100}&epPuntEdita   = "";
|FIN;

|PROCESO PonLosBien;
     |SI nArregla = 0;
          |SALVA_DATOS #0;

          |SI #0#4 = "N";
              #0#4 = "S";
              #0#5 = #0#1;
              #0#6 = #0#2;
              #0#7 = #0#3;
          |FINSI;
          #0#1 = fFecha;

          |ET Grabador;
          |LIBERA #0;
          |GRABA 040#0n;
          |SI FSalida ! 0;  #0#18 = #0#18 + 1;  |VETE Grabador;  |FINSI;

          |REPON_DATOS #0;
          |BORRA 020#0c;
     |SINO;
          |SI #0#4 = "S";  |Y #0#5 ] fFecha;
              #0#16 = "N";
              |GRABA 020#0a;
              |LIBERA #0;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE abor0006;
     #0#1;
     ;
            0, fDFecha, 00, 00, 00;
     99999999, fHFecha, 99, 99, 99;
     be;
     NULL, PonLosBien;
|FIN;

|PROCESO PonBien;
     nArregla = 0;
     fFecha   = ~;
     fDFecha  = fFecha + 1;
     fHFecha  = "31.12.2999";
     |BUCLE abor0006;

     nArregla = 1;
     fDFecha  = "01.01.0000";
     fHFecha  = "31.12.2999";
     |BUCLE abor0006;
     |BUCLE abor0006;
|FPRC;

|PROCESO CuadroM0006;  |TIPO 7;
     |PUSHV 0501 2380;

     |D_CUADRO 1320, 2072;
     |ATRI R;
     |PINTA 1421, "-0- Solo el dia de Aviso.  -X- Todos los Miercoles.";
     |PINTA 1521, "-T- Todos los Dias.        -J- Todos los Jueves.   ";
     |PINTA 1621, "-2- Dos Semanas Antes.     -V- Todos los Viernes.  ";
     |PINTA 1721, "-1- Una Semanas Antes.     -S- Todos los Sabados.  ";
     |PINTA 1821, "-L- Todos los Lunes.       -D- Todos los Domingos. ";
     |PINTA 1921, "-M- Todos los Martes.                              ";
     |ATRI 0;
|FPRC;

|PROCESO MayusM0006;
     #0Campo = #0Campo > #0Campo;
     |PINTA #0Campo;

     |SI Campo = 4;
         |SI FSalida = 2;  |ERROR;  |ACABA;  |FINSI;

         |C_M #0#5,  1, "S";
         |C_M #0#6,  1, "S";
         |C_M #0#7,  1, "S";
         |C_M #0#17, 1, "S";
         |SI #0#4 = "N";
             |C_M #0#5,  1, "N";  #0#5  = "01.01.0000";  |PINTA #0#5;
             |C_M #0#6,  1, "N";  #0#6  = 0;             |PINTA #0#6;
             |C_M #0#7,  1, "N";  #0#7  = 0;             |PINTA #0#7;
             |C_M #0#17, 1, "N";  #0#17 = "";            |PINTA #0#17;
                                  #0#16 = "S";           |PINTA #0#16;
         |SINO;
                                  #0#16 = "N";           |PINTA #0#16;
         |FINSI;
     |FINSI;

     |SI Campo = 17;
         |POPV;
         |PINTA #0Campo;
     |FINSI;
|FPRC;

|PROCESO Tipo11M0006;  |TIPO 11;
     |SI FSalida = 1;  |O FSalida = 7;
         |ACABA;
     |FINSI;

     |SI FSalida ! 0;  |Y FSalida ! 10;  |Y FSalida ! 11;  |Y FSalida ! 12;
         |ERROR;
         |ACABA;
     |FINSI;

     nSw = 0;
     |SI FSalida = 10;   nForma = 1;           |ERROR;     |FINSI;
     |SI FSalida = 11;   nForma = 0; nSw = 1;  |PTEC 807;  |FINSI;
     |SI FSalida = 12;   |HAZ PonBien;                     |FINSI;
|FPRC;

|PROCESO DentroM0006;  |TIPO 7;
     |SI Campo = 4;  |Y nSw = 0;
         |SI #0#0 ! 0;
             |PUSHV 0501 2380;

             |ABRE #6;
             #6#0 = #0#0;
             |LEE 040#6=;
             |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;
             |CIERRA #6;

             #916#0 = #6#0;
             #916#1 = #6#1;
             #916#2 = #6#2;
             #916#3 = #6#27;
             #916#4 = #6#3;
             #916#5 = #6#4;
             #916#6 = #6#26;
             #916#7 = #6#7;
             #916#8 = #6#8;
             #916#9 = #6#9;
             |PINPA #0#916;
             |PINDA #0#916;
         |FINSI;

         enDentro = 1;
     |FINSI;

     |SI Campo = 1;  |Y nForma = 1;
         |PTEC 809;
         |PTEC 809;
         enDentro = 0;
     |FINSI;
|FPRC;

|PROCESO EditaAsuntoM0006;  |TIPO 7;
     enTotalVaria  = 6;
     eaNombreList  = "";
     enCuadroIni   = 1737;
     enCuadroFin   = 2273;
     enCampoAncho  = 50;
     enModoEdita   = 0;

     IepPuntEdita  = epPuntEdita1 <-;
     |PARA nVariable = 10;  |SI nVariable [ 15;  |HACIENDO nVariable = nVariable + 1;
          epPuntEdita  = #0nVariable;
          IepPuntEdita = IepPuntEdita + 1;
     |SIGUE;

     |HAZ Edita;

     IepPuntEdita  = epPuntEdita1 <-;
     |PARA nVariable = 10;  |SI nVariable [ 15;  |HACIENDO nVariable = nVariable + 1;
          #0nVariable  = epPuntEdita;             |PINTA #0nVariable
          IepPuntEdita = IepPuntEdita + 1;
     |SIGUE;
|FPRC;

|PROCESO PonHora;  |TIPO 7;
     nSw   = 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 1;  |ACABA;  |FINSI;

     |HORA aHora;
                           #0#1  = ~;      |PINTA #0#1;
     aAlfa = aHora % 102;  #0#2  = aAlfa;  |PINTA #0#2;
     aAlfa = aHora % 402;  #0#3  = aAlfa;  |PINTA #0#3;
     aAlfa = aHora % 702;  #0#18 = aAlfa;
|FPRC;

|PROCESO BuscaExpe;  |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 1;  |ACABA;  |FINSI;

     |HORA aHora;
                           #0#1 = ~;      |PINTA #0#1;
     aAlfa = aHora % 102;  #0#2 = aAlfa;  |PINTA #0#2;
     aAlfa = aHora % 402;  #0#3 = aAlfa;  |PINTA #0#3;
     aAlfa = aHora % 702;  #0#18 = aAlfa;
     #0#0  = 0;

     |CONFI "2400NExpediente S/N : ";
     |SI FSalida ! 0;
         #0#0  = 0;  |PINTA #0#0;
         |ACABA;
     |FINSI;

     |SUB_EJECUTA "aboz0003";

     #0#0 = enCodExpe;  |PINTA #0#0;
     #0#8 = enCodPers;  |PINTA #0#8;
|FPRC;

|PROCESO Tipo2r6;  |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
         |CONFI "2400NSeguro de dar de Baja la Agenda.";
         |SI FSalida ! 0;
             |ERROR;
         |FINSI;
     |FINSI;

     nMasMenos = 0 +. 1;
     |SI nMasMenos ! 1;  |ACABA;  |FINSI;

     |SI #0#0 ! 0;
         |POPV;
     |FINSI;

     |SI #0#21 = "          ";
         #0#21 = Usuario % 810;

         |ABRE #511;
         |SELECT #2#511;
         #511#0 = 0;
         #511#1 = #0#21;
         |LEE 040#511];
         |SI FSalida = 0;  |Y #511#1 = #6#21;
             #0#22 = #511#2;
         |FINSI;
         |CIERRA #511;
     |FINSI;

     #0#20 = "N";
     |HAZ OutlookLinea;
|FPRC;

|| ************************************************************************
||                  PROCESO PARA PONER EN COLORES LAS LINEAS
|| ************************************************************************

|PROCESO Tipo5M0006;  |TIPO 5;
     |LEE 040#0p;
     |SI FSalida = 0;
         |SI #0#16 = "N";
             |LINEAS_BI_ATRI #0#16, N, I, 179;
         |SINO;
             |LINEAS_BI_ATRI #0#16, I, N, 179;
         |FINSI;
     |SINO;
         |LINEAS_BI_ATRI #0#16, I, N, 179;
     |FINSI;
|FPRC;

|RUTINA ClaveBaja;
     |SI FSalida = "POSICION";
         #0#1  = ~;
         |ACABA;
     |FINSI;

     #0#0  = 0;
     #0#1  = "01.01.0000";
     #0#2  = 00;
     #0#3  = 00;
     #0#18 = 00;
|FRUT;

|RUTINA ClaveAlta;
     #0#0  = 99999999;
     #0#1  = "31.12.2999";
     #0#2  = 23;
     #0#3  = 59;
     #0#18 = 99;
|FRUT;

|PROGRAMA;
     |HAZ LeeUnidadBasico;

     nForma = 1;
     |CLS;
     |CABEZA "Entrada Agenda";
     |ENTLINEAL #2#0, -1, 1, 22, 1, ClaveBaja, ClaveAlta;

     |HAZ Outlook;
|FPRO;
