|FICHEROS;
     abxz0050;

     abom0003,MANTE;
     abom0004,MANTE;
     abxm0024,MANTE;
     abxm0504,MANTE;
     abxw0014,MANTE;
     abxw0015,MANTE;
     abxw0016,MANTE;
     abxw0018,MANTE;

     abxm0022;
     abom0500;

     abom0001;
     abom0002;
     abom0005;
     abom0006;
     abom0007;
     abom0013;
     abom0015;
     abom0050;

     abom0508;
     abom0514;
     abom0602;
     abom0606;

     abom0001@;
     fichreal@;

     facemp;
|FIN;

|VARIABLES;
     nRango          = 0;
     nSubRango       = 0;
     nSubGrid        = 0;
     nPos1           = 0;
     nPos2           = 0;
     nPos1_101       = 0;
     nPos2_101       = 0;
     nPos1_150       = 0;
     nPos2_150       = 0;
     nHandle         = 0;
     nLong           = 0;
     nCaracter       = 0;
     nPos            = 0;
     nBotonFoto      = 0;
     nVentana        = 0;
     nPestana        = 0;
     nMostrar        = 0;
     nBotonSalir     = 0;
     nError          = 0;
     nFichero        = 0;
     nFEstado        = 0;
     nEmision        = 0;
     nID             = 0;
     nSubPanta       = 0;
     nGraba          = 0;
     nCodigo         = 0;
     nVentTrab       = 0;
     nVentArbol      = 0;
     nExpeAnt        = 0;
     nCambia         = 0;
     nEmpresa        = 0;
     nEmpreAhora     = 0;

     aID             = "";
     aUsuario        = "";
     aDZona          = "";
     aHZona          = "";
     aDUsuario       = "";
     aHUsuario       = "";
     aFotoOrigen     = "";
     aFotoDestino    = "";
     aLong           = "";
     aLogo           = "";
     aCaracter       = "";
     aDirLocal       = "";
     aDocRemoto      = "";
     aDocServidor    = "";
     aIPRemoto       = "";
     aFoto           = "";
     aEsc1           = "";
     aEsc2           = "";
     aRetu           = "";
     aTecla          = "";
     aDef            = "";
     aMas            = "";
     aPrograma       = "";
     aBase           = "";
     aAlfa           = "";
     aAlfa1          = "";
     aDocu           = "";
     aRaiz           = "";
     aFicheroActu    = "";
     aTxt            = "";
     aOrigen         = "";
     aDestino        = "";
     aEjecuta        = "";
     aCarac10        = "";
     aCarac13        = "";
     aAbre           = "";
     aModoLineal     = "";
     aTexto          = "";

     nBoton1         = 0;
     nBoton2         = 0;
     nBoton3         = 0;
     nBoton5         = 0;
     nBoton6         = 0;
     nBoton7         = 0;
     nBoton8         = 0;
     nBoton9         = 0;
     nBoton10        = 0;
     nBoton11        = 0;
     nBoton12        = 0;
     nBoton13        = 0;
     nBotonLabel     = 0;
     nConta1         = 0;
     nConta2         = 0;
     nCampo          = 0;

     fFecha          = @;
     fDFecha         = @;
     fHFecha         = @;

     {-1}aVent       = "";
         aVent1      = 0;
         aVent2      = 0;
         aVent3      = 0;
         aVent4      = 0;
         aVent5      = "";

     {1}aContiene    = "";

     &enGrid101      = -1;
     &enGrid150      = -1;
     &enPanta0       = 0;
     &eaAlfa         = "";
     &eaOrigen       = "";
     &eaDestino      = "";
     &eaRutaOrigen   = "";
     &eaRutaDestino  = "";
     &eaFicheroTxt   = "";
     &eaFicheroTgz   = "";
     &eaFicheroTar   = "";
     &eaPrograma     = "";
     &eaFicheroEdita = "";
     &eaRutaDocumento = "";
     &eaFichero      = "";
     &enExped        = 0;
     &enCodUbica     = 0;
     &enError        = 0;
     &efFechaDocu    = @;
     &aCadena        = "";
     &aPassword      = "";
     &enMailing      = 0;
     &enLineas       = 0;
     &enPregunta     = 0;
     &eaUnidadBasico = "";
     &eaExtension    = "";
     &eaFicExp       = "";

     nTree          = -1;

     {-1}sTree      = 0;
     sT_nID         = 0;
     sT_nOper       = 0;
     sT_aData       = "";

  {6} aPopup       = "";
|FIN;

|PROCESO DesactivaPantPrincipal;
     |ESTADO_CONTROL nBoton1,  "HIDE";
     |ESTADO_CONTROL nBoton2,  "HIDE";
     |ESTADO_CONTROL nBoton3,  "HIDE";
     |ESTADO_CONTROL nBoton5,  "HIDE";
     |ESTADO_CONTROL nBoton6,  "HIDE";
     |ESTADO_CONTROL nBoton7,  "HIDE";
     |ESTADO_CONTROL nBoton8,  "HIDE";
     |ESTADO_CONTROL nBoton9,  "HIDE";
     |ESTADO_CONTROL nBoton10, "HIDE";
     |ESTADO_CONTROL nBoton11, "HIDE";
     |ESTADO_CONTROL nBoton12, "HIDE";
     |ESTADO_CONTROL nBoton13, "HIDE";

     |ESTADO_CONTROL enGrid101, "DISABLE";
     |ESTADO_CONTROL enGrid150, "DISABLE";

     |HAZ QuitaBotonSalir1;

     |PULSATECLA; |PULSATECLA; |PULSATECLA;
|FPRC;

|PROCESO ActivaPantPrincipal;
     |ESTADO_CONTROL nBoton1,  "SHOW";
     |ESTADO_CONTROL nBoton2,  "SHOW";
     |ESTADO_CONTROL nBoton3,  "SHOW";
     |ESTADO_CONTROL nBoton5,  "SHOW";
     |ESTADO_CONTROL nBoton6,  "SHOW";
     |ESTADO_CONTROL nBoton7,  "SHOW";
     |ESTADO_CONTROL nBoton8,  "SHOW";
     |ESTADO_CONTROL nBoton9,  "SHOW";
     |ESTADO_CONTROL nBoton10, "SHOW";
     |ESTADO_CONTROL nBoton11, "SHOW";
     |ESTADO_CONTROL nBoton12, "SHOW";
     |ESTADO_CONTROL nBoton13, "SHOW";

     |ESTADO_CONTROL enGrid101, "ENABLE";
     |ESTADO_CONTROL enGrid150, "ENABLE";

     |HAZ PonBotonSalir1;

     |PULSATECLA; |PULSATECLA; |PULSATECLA;
|FPRC;

|PROCESO DesactivaArbol;
     |ESTADO_CONTROL nTree, "DISABLE";
     |HAZ QuitaBotonSalir2;

     |PULSATECLA; |PULSATECLA; |PULSATECLA;
|FPRC;

|PROCESO ActivaArbol;
     |ESTADO_CONTROL nTree, "ENABLE";
     |HAZ PonBotonSalir2;

     |PULSATECLA; |PULSATECLA; |PULSATECLA;
|FPRC;

|PROCESO ActualizaVisita;
     fFecha = ~;
     #abom0050#0 = aUsuario;
     #abom0050#1 = fFecha;
     #abom0050#2 = "zzzzzzzz";
     |LEE 101#abom0050.];
     |SI FSalida = 0;  |Y  #abom0050#0 = aUsuario;  |Y #abom0050#1 = fFecha;
         |SI #abom0050#3 = #abom0001#0;
             |BORRA 020#abom0050.a;
         |FINSI;
     |FINSI;
     |LIBERA #abom0050;

     |HORA aAlfa;

     #abom0050#0 = aUsuario;
     #abom0050#1 = fFecha;
     #abom0050#2 = aAlfa;
     #abom0050#3 = #abom0001#0;
     |GRABA 020#abom0050.n;
     |LIBERA #abom0050;

     |LEE 000#abom0050.=;

     |REFRESCACONTROL enGrid150;

     |PULSATECLA; |PULSATECLA; |PULSATECLA;
|FPRC;

|PROCESO NuevoCliente;
     |ABRE #abxm0024;
     |LEE 000#abxm0024.u;
     |SI FSalida ! 0;  |DDEFECTO #abxm0024;  |FINSI;

     nCodigo = #abxm0024#0 + 1;

     |SI nCodigo > 99999;
         |PARA nCodigo = 1;  |SI nCodigo [ 99999;  |HACIENDO nCodigo = nCodigo + 1;
               #abxm0024#0 = nCodigo;
               |LEE 000#abxm0024.=;
               |SI FSalida ! 0;  |SAL;  |FINSI;
         |SIGUE;

         |DDEFECTO #abxm0024;
     |FINSI;
     |CIERRA #abxm0024;

     |SI nCodigo > 99999;
         |MENAV "0000 El c¢digo del cliente mayor a 99999";
         |ACABA;
     |FINSI;

     #abxw0014#9 = nCodigo;  |PINTA #abxw0014#9;

     |PTEC 802;
     aAlfa      = "|C009WID";
     aID        = #abxw0014#aAlfa#;
     nID        = aID;
     enPregunta = 1;

     |FOCOTECLADO nID;
|FPRC;

|PROCESO DatosGenerales;
     |SI nFichero = 801;
         #abom0001#0 = #abom0001@#0;
         |LEE 101#abom0001.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |LEE 101#abom0001@.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |SINO;
         |LEE 101#abom0001.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     |SI eaFicExp ! "abom0001";
         #fichreal@#0 = #abom0001#0;
         |LEE 101#fichreal@.=;
     |FINSI;

     |HAZ DesactivaArbol;

     |VENTANA 1201, 3499, -1, 17, "Datos Generales";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     #abxw0014#0   =  #abom0001#0;
     #abxw0014#1   =  #abom0001#1;
     #abxw0014#2   =  #abom0001#43;
     #abxw0014#3   =  #abom0001#44;
     #abxw0014#4   =  #abom0001#45;
     #abxw0014#5   =  #abom0001#46;
     #abxw0014#6   =  #abom0001#47;
     #abxw0014#7   =  #abom0001#2;
     #abxw0014#8   =  #abom0001#27;
     #abxw0014#9   =  #abom0001#3;
     #abxw0014#10  =  #abom0001#4;
     #abxw0014#11  =  #abom0001#38;
     #abxw0014#12  =  #abom0001#34;
     #abxw0014#13  =  #abom0001#54;
     #abxw0014#14  =  #abom0001#7;
     #abxw0014#15  =  #abom0001#8;
     #abxw0014#16  =  #abom0001#9;
     #abxw0014#17  =  #abom0001#13;
     #abxw0014#18  =  #abom0001#14;
     #abxw0014#19  =  #abom0001#16;
     #abxw0014#20  =  #abom0001#17;
     #abxw0014#21  =  #abom0001#15;
     #abxw0014#22  =  #abom0001#5;
     #abxw0014#23  =  #abom0001#6;
     #abxw0014#24  =  #abom0001#28;
     #abxw0014#25  =  #abom0001#29;
     #abxw0014#26  =  #abom0001#35;
     #abxw0014#27  =  #abom0001#39;
     #abxw0014#28  =  #abom0001#40;

     |C_M #abxw0014#0, 1, "N";

     |PINPA #0#abxw0014;
     nSubPanta = FSalida;

     |CONTROL_SIMPLE nSubPanta, "BOTON,{{197}}", 0651, 0653, NuevoCliente;

     |PINDA #0#abxw0014;
     |ENDATOS #2#abxw0014;
     |SI FSalida = 0;
         #abom0001#0  =  #abxw0014#0;
         #abom0001#1  =  #abxw0014#1;
         #abom0001#43 =  #abxw0014#2;
         #abom0001#44 =  #abxw0014#3;
         #abom0001#45 =  #abxw0014#4;
         #abom0001#46 =  #abxw0014#5;
         #abom0001#47 =  #abxw0014#6;
         #abom0001#2  =  #abxw0014#7;
         #abom0001#27 =  #abxw0014#8;
         #abom0001#3  =  #abxw0014#9;
         #abom0001#4  =  #abxw0014#10;
         #abom0001#38 =  #abxw0014#11;
         #abom0001#34 =  #abxw0014#12;
         #abom0001#54 =  #abxw0014#13;
         #abom0001#7  =  #abxw0014#14;
         #abom0001#8  =  #abxw0014#15;
         #abom0001#9  =  #abxw0014#16;
         #abom0001#13 =  #abxw0014#17;
         #abom0001#14 =  #abxw0014#18;
         #abom0001#16 =  #abxw0014#19;
         #abom0001#17 =  #abxw0014#20;
         #abom0001#15 =  #abxw0014#21;
         #abom0001#5  =  #abxw0014#22;
         #abom0001#6  =  #abxw0014#23;
         #abom0001#28 =  #abxw0014#24;
         #abom0001#29 =  #abxw0014#25;
         #abom0001#35 =  #abxw0014#26;
         #abom0001#39 =  #abxw0014#27;
         #abom0001#40 =  #abxw0014#28;

         |GRABA 020#abom0001.a;
     |FINSI;

     |LIBERA #abom0001;

     |SI nFichero = 801;
         |PARA nCampo = 0;  |SI nCampo [ 69;  |HACIENDO nCampo = nCampo + 1;
               #abom0001@#nCampo# = #abom0001#nCampo#;
         |SIGUE;
         |GRABA 020#abom0001@.a;
         |LIBERA #abom0001@;
     |FINSI;

     |SI eaFicExp ! "abom0001";
         |PARA nCampo = 0;  |SI nCampo [ 69;  |HACIENDO nCampo = nCampo + 1;
               #fichreal@#nCampo# = #abom0001#nCampo#;
         |SIGUE;
         |GRABA 020#fichreal@.a;
         |LIBERA #fichreal@;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |HAZ ActivaArbol;
|FPRC;

|PROCESO Letrados;
     |SI nFichero = 801;
         #abom0001#0 = #abom0001@#0;
         |LEE 101#abom0001.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |LEE 101#abom0001@.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |SINO;
         |LEE 101#abom0001.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     |SI eaFicExp ! "abom0001";
         #fichreal@#0 = #abom0001#0;
         |LEE 101#fichreal@.=;
     |FINSI;

     |HAZ DesactivaArbol;

     |VENTANA 1701, 2899, -1, 17, "Letrados";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     #abxw0015#0   =  #abom0001#18;
     #abxw0015#1   =  #abom0001#19;
     #abxw0015#2   =  #abom0001#20;
     #abxw0015#3   =  #abom0001#21;
     #abxw0015#4   =  #abom0001#22;
     #abxw0015#5   =  #abom0001#23;
     #abxw0015#6   =  #abom0001#24;
     #abxw0015#7   =  #abom0001#25;

     |PINPA #0#abxw0015;
     |PINDA #0#abxw0015;
     |ENDATOS #2#abxw0015;
     |SI FSalida = 0;
         #abom0001#18 =  #abxw0015#0;
         #abom0001#19 =  #abxw0015#1;
         #abom0001#20 =  #abxw0015#2;
         #abom0001#21 =  #abxw0015#3;
         #abom0001#22 =  #abxw0015#4;
         #abom0001#23 =  #abxw0015#5;
         #abom0001#24 =  #abxw0015#6;
         #abom0001#25 =  #abxw0015#7;

         |GRABA 020#abom0001.a;
     |FINSI;

     |LIBERA #abom0001;

     |SI nFichero = 801;
         |PARA nCampo = 0;  |SI nCampo [ 69;  |HACIENDO nCampo = nCampo + 1;
               #abom0001@#nCampo# = #abom0001#nCampo#;
         |SIGUE;
         |GRABA 020#abom0001@.a;
         |LIBERA #abom0001@;
     |FINSI;

     |SI eaFicExp ! "abom0001";
         |PARA nCampo = 0;  |SI nCampo [ 69;  |HACIENDO nCampo = nCampo + 1;
               #fichreal@#nCampo# = #abom0001#nCampo#;
         |SIGUE;
         |GRABA 020#fichreal@.a;
         |LIBERA #fichreal@;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |HAZ ActivaArbol;
|FPRC;

|PROCESO Seguros;
     |SI nFichero = 801;
         #abom0001#0 = #abom0001@#0;
         |LEE 101#abom0001.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |LEE 101#abom0001@.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |SINO;
         |LEE 101#abom0001.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     |SI eaFicExp ! "abom0001";
         #fichreal@#0 = #abom0001#0;
         |LEE 101#fichreal@.=;
     |FINSI;

     |HAZ DesactivaArbol;

     |VENTANA 1701, 2499, -1, 17, "Corredur¡a de seguros";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     #abxw0016#0   =  #abom0001#39;
     #abxw0016#1   =  #abom0001#40;
     #abxw0016#2   =  #abom0001#41;
     #abxw0016#3   =  #abom0001#42;

     |PINPA #0#abxw0016;
     |PINDA #0#abxw0016;
     |ENDATOS #2#abxw0016;
     |SI FSalida = 0;
         #abom0001#39 =  #abxw0016#0;
         #abom0001#40 =  #abxw0016#1;
         #abom0001#41 =  #abxw0016#2;
         #abom0001#42 =  #abxw0016#3;

         |GRABA 020#abom0001.a;
     |FINSI;

     |LIBERA #abom0001;

     |SI nFichero = 801;
         |PARA nCampo = 0;  |SI nCampo [ 69;  |HACIENDO nCampo = nCampo + 1;
               #abom0001@#nCampo# = #abom0001#nCampo#;
         |SIGUE;
         |GRABA 020#abom0001@.a;
         |LIBERA #abom0001@;
     |FINSI;

     |SI eaFicExp ! "abom0001";
         |PARA nCampo = 0;  |SI nCampo [ 69;  |HACIENDO nCampo = nCampo + 1;
               #fichreal@#nCampo# = #abom0001#nCampo#;
         |SIGUE;
         |GRABA 020#fichreal@.a;
         |LIBERA #fichreal@;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |HAZ ActivaArbol;
|FPRC;

|PROCESO Baja103;
     #abom0003#0 = #abxz0050#0;
     #abom0003#1 = 1;
|FPRC;

|PROCESO Alta103;
     #abom0003#0 = #abxz0050#0;
     #abom0003#1 = 99999;
|FPRC;

|PROCESO Tipo66C1Fm3; |TIPO 66;
     |ABRE #abxm0024;
     #abxm0024#0 = #abom0003#1;
     |LEE 000#abxm0024.=;
     |SI FSalida ! 0;  |DDEFECTO #abxm0024;  |FINSI;

     |CONSULTA_CLAVE #1#abxm0024;
     |SI FSalida = 0;
         #abom0003#1  = #abxm0024#0;   |PINTA #abom0003#1;
     |FINSI;
     |CIERRA #abxm0024;
|FPRC;

|PROCESO Tipo6C1Fm3; |TIPO 6;
     |ABRE #abxm0024;
     #abxm0024#0 = #abom0003#1;
     |LEE 000#abxm0024.=;
     |SI FSalida = 0;
         #abom0003#1  = #abxm0024#0;   |PINTA #abom0003#1;
         |CIERRA #abxm0024;
         |ACABA;
     |FINSI;

     |SI enPregunta = 0;
         |CONFI "0000 No existe el cliente, quiere darlo de alta";
         |SI FSalida ! 0;
             |CIERRA #abxm0024;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     enPregunta = 0;

     |VENTANA 1201, 3499, -1, 17, "Alta r pida de clientes";
     nVentana = FSalida;
     nGraba   = 1;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DDEFECTO #abxm0024;
     #abxm0024#0 = #abom0003#1;

     |PINPA #0#abxm0024;
     |PINDA #0#abxm0024;
     |ENDATOS #1#abxm0024;
     |SI FSalida = 0;  nGraba = 0;  |FINSI;
     |CIERRA #abxm0024;


     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     |CIERRA #abxm0024;

     |ERROR;
|FPRC;

|PROCESO NuevoCliente103;
     |ABRE #abxm0024;
     |LEE 000#abxm0024.u;
     |SI FSalida ! 0;  |DDEFECTO #abxm0024;  |FINSI;

     nCodigo = #abxm0024#0 + 1;

     |SI nCodigo > 99999;
         |PARA nCodigo = 1;  |SI nCodigo [ 99999;  |HACIENDO nCodigo = nCodigo + 1;
               #abxm0024#0 = nCodigo;
               |LEE 000#abxm0024.=;
               |SI FSalida ! 0;  |SAL;  |FINSI;
         |SIGUE;

         |DDEFECTO #abxm0024;
     |FINSI;
     |CIERRA #abxm0024;

     |SI nCodigo > 99999;
         |MENAV "0000 El c¢digo del cliente mayor a 99999";
         |ACABA;
     |FINSI;

     enPregunta = 1;

     #abom0003#0 = #abxz0050#0;
     #abom0003#1 = nCodigo;
     |LEE 101#abom0003.=;
     |SI FSalida ! 0;
         #abom0003#0 = #abxz0050#0;
         #abom0003#1 = nCodigo;
         |HAZ Tipo6C1Fm3;
         |SI nGraba = 0;
             #abom0003#2 = #abxm0024#1;
             |GRABA 020#abom0003.n;
             |LIBERA #abom0003;

             |REFRESCACONTROL nSubGrid;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Clientes;
     |HAZ DesactivaArbol;

     |VENTANA 1701, 3499, -1, 17, "Clientes";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Nuevo cliente", 3320, 3335, NuevoCliente103;

     nSubRango = 1 + 4 + 8 + 16 + 32;

     |ABRE #abom0003;
     |LINEAL_SIMPLE #1#abom0003, nSubRango, 1820, 3280, Baja103, Alta103, NULL;
     nSubGrid = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nSubGrid;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |CIERRA #abom0003;

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |HAZ ActivaArbol;
|FPRC;

|PROCESO Baja104;
     #abom0004#0 = #abxz0050#0;
     #abom0004#1 = 1;
|FPRC;

|PROCESO Alta104;
     #abom0004#0 = #abxz0050#0;
     #abom0004#1 = 999999;
|FPRC;

|PROCESO Tipo66C1Fm4; |TIPO 66;
     |ABRE #abxm0504;
     #abxm0504#0 = #abom0004#1;
     |LEE 000#abxm0504.=;
     |SI FSalida ! 0;  |DDEFECTO #abxm0504;  |FINSI;

     |CONSULTA_CLAVE #1#abxm0504;
     |SI FSalida = 0;
         #abom0004#1  = #abxm0504#0;   |PINTA #abom0004#1;
     |FINSI;
     |CIERRA #abxm0504;
|FPRC;

|PROCESO Tipo6C1Fm4; |TIPO 6;
     |ABRE #abxm0504;
     #abxm0504#0 = #abom0004#1;
     |LEE 000#abxm0504.=;
     |SI FSalida = 0;
         #abom0004#1  = #abxm0504#0;   |PINTA #abom0004#1;
         |CIERRA #abxm0024;
         |ACABA;
     |FINSI;

     nGraba   = 1;

     |SI enPregunta = 0;
         |CONFI "0000 No existe el contrario, quiere darlo de alta";
         |SI FSalida ! 0;
             |CIERRA #abxm0504;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     enPregunta = 0;

     |VENTANA 1201, 3499, -1, 17, "Alta - Contrarios";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DDEFECTO #abxm0504;
     #abxm0504#0 = #abom0004#1;

     |PINPA #0#abxm0504;
     |PINDA #0#abxm0504;
     |ENDATOS #1#abxm0504;
     |SI FSalida = 0;
         |GRABA 020#abxm0504.n;
         |LIBERA #abxm0504;

         nGraba = 0;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     |CIERRA #abxm0504;

     |ERROR;
|FPRC;

|PROCESO MiraTeclam04;
     || No quitar se compila
|FPRC;

|PROCESO NuevoContrario;
     |ABRE #abxm0504;
     |LEE 000#abxm0504.u;
     |SI FSalida ! 0;  |DDEFECTO #abxm0504;  |FINSI;

     nCodigo = #abxm0504#0 + 1;

     |SI nCodigo > 99999;
         |PARA nCodigo = 1;  |SI nCodigo [ 99999;  |HACIENDO nCodigo = nCodigo + 1;
               #abxm0504#0 = nCodigo;
               |LEE 000#abxm0504.=;
               |SI FSalida ! 0;  |SAL;  |FINSI;
         |SIGUE;

         |DDEFECTO #abxm0504;
     |FINSI;
     |CIERRA #abxm0504;

     |SI nCodigo > 99999;
         |MENAV "0000 El c¢digo del cliente mayor a 99999";
         |ACABA;
     |FINSI;

     enPregunta = 1;

     #abom0004#0 = #abxz0050#0;
     #abom0004#1 = nCodigo;
     |LEE 101#abom0004.=;
     |SI FSalida ! 0;
         #abom0004#0 = #abxz0050#0;
         #abom0004#1 = nCodigo;
         |HAZ Tipo6C1Fm4;
         |SI nGraba = 0;
             #abom0004#2 = #abxm0504#1;
             |GRABA 020#abom0004.n;
             |LIBERA #abom0004;

             |REFRESCACONTROL nSubGrid;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Contrarios;
     |HAZ DesactivaArbol;

     |VENTANA 1701, 3499, -1, 17, "Contrarios";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     nSubRango = 1 + 4 + 8 + 16 + 32;

     |ABRE #abom0004;
     |LINEAL_SIMPLE #1#abom0004, nSubRango, 1820, 3280, Baja104, Alta104, NULL;
     nSubGrid = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Nuevo contrario", 3320, 3335, NuevoContrario;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nSubGrid;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |CIERRA #abom0004;

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |HAZ ActivaArbol;
|FPRC;

|PROCESO GestionDocumental;
     |PULSATECLA; |PULSATECLA; |PULSATECLA;

     nError = 0;
     |HAZ MiraPassword;
     |SI nError = 1;  |ACABA;  |FINSI;

     |HAZ DesactivaPantPrincipal;

     |VENTANA 1101, 3399, -1, 17, "Gesti¢n documental";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     enExped = #abxz0050#0;
     |SUB_EJECUTA_NP "abxz0055";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |HAZ ActivaPantPrincipal;

     |REFRESCACONTROL enGrid101;

     |HAZ ActualizaVisita;

     |PTEC 809;
     |PULSATECLA; |PULSATECLA; |PULSATECLA;
|FPRC;

|PROCESO Baja602;
     #abom0602#0 = 1;
     #abom0602#5 = "E";
|FPRC;

|PROCESO Alta602;
     #abom0602#0 = 999;
     #abom0602#5 = "E";
|FPRC;

|PROCESO Emisiones;
     nError = 0;
     |HAZ MiraPassword;
     |SI nError = 1;  |ACABA;  |FINSI;

     aPopup1  = 0;
     aPopup2  = 4;
     aPopup3  = "Emision de la Ficha del expediente (sin Documentos, agenda ni seguimientos)";
     aPopup4  = "Emision de la Ficha del expediente (completa)";
     aPopup5  = "Emision de cartas predeterminadas (mailings)";
     aPopup6  = "Emision de cartas predeterminadas (segun este el expediente: ordinaria, procesal, cerrada)";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     nEmision = FSalida;
     |SI nEmision ! 0;
         |VENTANA 0501, 3599, -1, 17, "Editando documento";
         nVentTrab = FSalida;

         aVent1 = -1;
         aVent2 = -1;
         aVent3 = 0;
         aVent4 = nVentTrab;
         aVent5 = "MODAL";
         |ESPECIFICA "ESTADO_VENTANA", aVent;

         |CONTROL_SIMPLE 0, "LABEL,{{5}}Editando documento", 1320, 1498, NULL;
         |CONTROL_SIMPLE 0, "LABEL,{{2}}Espere por favor ...", 1640, 1698, NULL;

         |PTEC 802;
         |PAUSA;

         |SI nEmision = 1;
             enExped = #abom0001#0;
             |SUB_EJECUTA "aboy0001;R";
         |FINSI;

         |SI nEmision = 2;
             enExped = #abom0001#0;
             |SUB_EJECUTA "aboy0001;T";
         |FINSI;

         |SI nEmision = 3;
             |ABRE #abom0602;
             |SELECT #2#abom0602;
             |LEE 000#abom0602.p;
             |SI FSalida ! 0;  |DDEFECTO #abom0602;  |FINSI;

             enMailing = 0;
             |CONSULTA_F_CLAVE #2#abom0602, Baja602, Alta602;
             |SI FSalida = 0;
                 enMailing = #abom0602#0;
             |FINSI;
             |CIERRA #abom0602;

             |SI enMailing ! 0;
                 enExped = #abom0001#0;
                 |SUB_EJECUTA "aboy0004;DIRECTO";
             |FINSI;
         |FINSI;

         |SI nEmision = 4;
             aAlfa = #abom0001#34;
             |SI #abom0001#2 ! "01.01.0000";  aAlfa = "3";  |FINSI;

             enMailing = 0;

             |ABRE #abom0606;
             |LEE 040#abom0606.p;
             |SI FSalida = 0;
                 |SI aAlfa = "1";  enMailing = #abom0606#1;  |FINSI;
                 |SI aAlfa = "2";  enMailing = #abom0606#3;  |FINSI;
                 |SI aAlfa = "3";  enMailing = #abom0606#5;  |FINSI;
             |FINSI;
             |CIERRA #abom0606;

             |SI enMailing ! 0;
                 enExped = #abom0001#0;
                 |SUB_EJECUTA "aboy0004;DIRECTO";
             |FINSI;
         |FINSI;

         aVent1 = -1;
         aVent2 = -1;
         aVent3 = 0;
         aVent4 = nVentTrab;
         aVent5 = "MODELESS";
         |ESPECIFICA "ESTADO_VENTANA", aVent;
         |FINVENTANA nVentTrab;
     |FINSI;
|FPRC;

|PROCESO Agenda;
     |HAZ DesactivaArbol;

     |VENTANA 1101, 3399, -1, 17, "Gesti¢n agenda";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     enExped = #abxz0050#0;
     |SUB_EJECUTA_NP "abxz0056";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |HAZ ActivaArbol;
|FPRC;

|PROCESO CorreoEntrada;
     |HAZ DesactivaArbol;

     |VENTANA 1101, 3399, -1, 17, "Bandeja de entrada";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     enExped = #abxz0050#0;
     |SUB_EJECUTA_NP "abxz0057";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |HAZ ActivaArbol;
|FPRC;

|PROCESO CorreoSalida;
     |HAZ DesactivaArbol;

     |VENTANA 1101, 3399, -1, 17, "Bandeja de correos enviados";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     enExped = #abxz0050#0;
     |SUB_EJECUTA_NP "abxz0059";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |HAZ ActivaArbol;
|FPRC;

|PROCESO abom0005G;
     #abxm0022#0 = #abom0005#5;
     #abxm0022#1 = #abom0005#6;
     |LEE 040#abxm0022.=;
     |SI FSalida ! 0;  |DDEFECTO #abxm0022;  |FINSI;

     |SI #abxm0022#3 = "H";  |O #abxm0022#3 = "S";
         #abom0001#33 = #abom0001#33 + #abom0005#18;
         |SI #abom0005#19 = "S";
             #abom0001#31 = #abom0001#31 + #abom0005#24;
         |FINSI;
         |SI #abom0005#20 = "S";
             #abom0001#10 = #abom0001#10 + #abom0005#25;
             #abom0001#36 = #abom0001#36 + #abom0005#26;
         |FINSI;

         #abom0001#11 = #abom0001#31 - (#abom0001#10 + #abom0001#36);
         #abom0001#32 = #abom0001#10 - #abom0001#33;
     |FINSI;

     |SI #abxm0022#3 = "A";
         |SI #abom0005#20 ! "S";
             #abom0001#37 = #abom0001#37 + #abom0005#18;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE abom0005G;
     #abom0005#1;
     ;
     #abxz0050#0, 000;
     #abxz0050#0, 999;
     ;
     NULL, abom0005G;
|FIN;

|PROCESO Seguimientos;
     |HAZ DesactivaArbol;

     |VENTANA 1101, 3499, -1, 17, "Seguimiento";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     enExped = #abxz0050#0;
     |SUB_EJECUTA_NP "abxz0060";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |HAZ ActivaArbol;

     |SI nFichero = 801;
         #abom0001#0 = #abom0001@#0;
         |LEE 101#abom0001.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |LEE 101#abom0001@.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |SINO;
         |LEE 101#abom0001.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     |SI eaFicExp ! "abom0001";
         #fichreal@#0 = #abom0001#0;
         |LEE 101#fichreal@.=;
     |FINSI;

     #abom0001#10 = 0;
     #abom0001#31 = 0;
     #abom0001#32 = 0;
     #abom0001#33 = 0;
     #abom0001#36 = 0;
     #abom0001#37 = 0;

     |ABRE #abxm0022;
     |BUCLE abom0005G;
     |CIERRA #abxm0022;

     |SI #abom0514#19 = "S";
         #abom0001#33 = #abom0001#33 - #abom0001#37;
         #abom0001#32 = #abom0001#10 - #abom0001#33;
     |FINSI;

     |GRABA 020#abom0001.a;
     |LIBERA #abom0001;

     |SI nFichero = 801;
         |PARA nCampo = 0;  |SI nCampo [ 69;  |HACIENDO nCampo = nCampo + 1;
               #abom0001@#nCampo# = #abom0001#nCampo#;
         |SIGUE;
         |GRABA 020#abom0001@.a;
         |LIBERA #abom0001@;
     |FINSI;

     |SI eaFicExp ! "abom0001";
         |PARA nCampo = 0;  |SI nCampo [ 69;  |HACIENDO nCampo = nCampo + 1;
               #fichreal@#nCampo# = #abom0001#nCampo#;
         |SIGUE;
         |GRABA 020#fichreal@.a;
         |LIBERA #fichreal@;
     |FINSI;
|FPRC;

|PROCESO Importes;
     |SI nFichero = 801;
         #abom0001#0 = #abom0001@#0;
         |LEE 101#abom0001.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |LEE 101#abom0001@.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |SINO;
         |LEE 101#abom0001.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     |SI eaFicExp ! "abom0001";
         #fichreal@#0 = #abom0001#0;
         |LEE 101#fichreal@.=;
     |FINSI;

     |HAZ DesactivaArbol;

     |VENTANA 1320, 3370, -1, 17, "Importes expediente";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     #abxw0018#0  =  #abom0001#48;
     #abxw0018#1  =  #abom0001#49;
     #abxw0018#2  =  #abom0001#50;
     #abxw0018#3  =  #abom0001#51;
     #abxw0018#4  =  #abom0001#12;
     #abxw0018#5  =  #abom0001#52;
     #abxw0018#6  =  #abom0001#53;
     #abxw0018#7  =  #abom0001#30;
     #abxw0018#8  =  #abom0001#33;
     #abxw0018#9  =  #abom0001#31;
     #abxw0018#10 =  #abom0001#36;
     #abxw0018#11 =  #abom0001#10;
     #abxw0018#12 =  #abom0001#32;
     #abxw0018#13 =  #abom0001#11;
     #abxw0018#14 =  #abom0001#37;
     #abxw0018#15 =  #abom0001#26;

     |PINPA #0#abxw0018;
     |PINDA #0#abxw0018;
     |ENDATOS #2#abxw0018;
     |SI FSalida = 0;
         #abom0001#48  = #abxw0018#0;
         #abom0001#49  = #abxw0018#1;
         #abom0001#50  = #abxw0018#2;
         #abom0001#51  = #abxw0018#3;
         #abom0001#12  = #abxw0018#4;
         #abom0001#52  = #abxw0018#5;
         #abom0001#53  = #abxw0018#6;
         #abom0001#30  = #abxw0018#7;
         #abom0001#33  = #abxw0018#8;
         #abom0001#31  = #abxw0018#9;
         #abom0001#36  = #abxw0018#10;
         #abom0001#10  = #abxw0018#11;
         #abom0001#32  = #abxw0018#12;
         #abom0001#11  = #abxw0018#13;
         #abom0001#37  = #abxw0018#14;
         #abom0001#26  = #abxw0018#15;
         |GRABA 020#abom0001.a;
     |FINSI;

     |LIBERA #abom0001;

     |SI nFichero = 801;
         |PARA nCampo = 0;  |SI nCampo [ 69;  |HACIENDO nCampo = nCampo + 1;
               #abom0001@#nCampo# = #abom0001#nCampo#;
         |SIGUE;
         |GRABA 020#abom0001@.a;
         |LIBERA #abom0001@;
     |FINSI;

     |SI eaFicExp ! "abom0001";
         |PARA nCampo = 0;  |SI nCampo [ 69;  |HACIENDO nCampo = nCampo + 1;
               #fichreal@#nCampo# = #abom0001#nCampo#;
         |SIGUE;
         |GRABA 020#fichreal@.a;
         |LIBERA #fichreal@;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |HAZ ActivaArbol;
|FPRC;

|PROCESO Baja101A;
     #abom0001#0 = 1;
     #abom0001#2 = "01.01.0000";
|FPRC;

|PROCESO Alta101A;
     #abom0001#0 = 99999999;
     #abom0001#2 = "01.01.0000";
|FPRC;

|PROCESO Baja101C;
     #abom0001#0 = 1;
     #abom0001#2 = "01.01.0001";
|FPRC;

|PROCESO Alta101C;
     #abom0001#0 = 99999999;
     #abom0001#2 = "31.12.9999";
|FPRC;

|PROCESO EventoPanta101;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#abom0001.c;

         |HAZ PonDatosCabecera;

         |LEE 000#abom0001.=;
         |SI FSalida = 0;
             |ESTADO_CONTROL nBoton1,  "ENABLE";
             |ESTADO_CONTROL nBoton3,  "ENABLE";
             |ESTADO_CONTROL nBoton13, "ENABLE";
         |SINO;
             |ESTADO_CONTROL nBoton1,  "DISABLE";
             |ESTADO_CONTROL nBoton3,  "DISABLE";
             |ESTADO_CONTROL nBoton13, "DISABLE";
         |FINSI;
     |FINSI;

     |SI FSalida = 4;
         |HAZ MostrarArbol;

         FSalida = "SKIPDEFAULT";
     |FINSI;
|FPRC;

|PROCESO EventoPanta801;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#abom0001@.c;

         #abom0001#0 = #abom0001@#0;
         |LEE 000#abom0001.=;

         |HAZ PonDatosCabecera;

         |LEE 000#abom0001@.=;
         |SI FSalida = 0;
             |ESTADO_CONTROL nBoton1,  "ENABLE";
             |ESTADO_CONTROL nBoton3,  "ENABLE";
             |ESTADO_CONTROL nBoton13, "ENABLE";
         |SINO;
             |ESTADO_CONTROL nBoton1,  "DISABLE";
             |ESTADO_CONTROL nBoton3,  "DISABLE";
             |ESTADO_CONTROL nBoton13, "DISABLE";
         |FINSI;
     |FINSI;

     |SI FSalida = 4;
         |HAZ MostrarArbol;

         FSalida = "SKIPDEFAULT";
     |FINSI;
|FPRC;

|PROCESO GridFicheroBusqueda;
     |ABRE #abom0001@;
     |LEE 000#abom0001@.p;

     nRango   = 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#abom0001@, nRango, nPos1_101, nPos2_101, NULL, NULL, EventoPanta801;

     enGrid101 = FSalida;
     nFichero  = 801;

     |FOCOTECLADO enGrid101;
|FPRC;

|PROCESO GridFicheroEntero;
     nRango   = 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#abom0001, nRango, nPos1_101, nPos2_101, NULL, NULL, EventoPanta101;
     enGrid101 = FSalida;
     nFichero  = 101;

     |FOCOTECLADO enGrid101;
|FPRC;

|PROCESO Busqueda;
     |CIERRA #abom0001@;

     |VENTANA 0501, 2699, -1, 16, "Busqueda de Documentos";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |CIERRAT #abom0001;
     |SUB_EJECUTA_NP "abxz0004";
     |ABRET #abom0001;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |SI enError = 1;
         |ABRE #abom0001@;
         |ACABA;
     |FINSI;

     |DESTRUYECONTROL enGrid101;
     |HAZ GridFicheroBusqueda;

     |ESTADO_CONTROL nBoton10, "ENABLE";
|FPRC;

|PROCESO Abiertos;
     |CIERRA #abom0001@;

     |VENTANA 0501, 2699, -1, 16, "Busqueda de Documentos";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SUB_EJECUTA_NP "abxz0004;ABIERTOS";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |SI enError = 1;
         |ABRE #abom0001@;
         |ACABA;
     |FINSI;

     |SI enGrid101 ! -1;  |DESTRUYECONTROL enGrid101;  |FINSI;

     |HAZ GridFicheroBusqueda;

     |ESTADO_CONTROL nBoton6, "ENABLE";
     |ESTADO_CONTROL nBoton7, "DISABLE";

     aModoLineal = "A";

     |PULSATECLA;
|FPRC;

|PROCESO Todos;
     |CIERRA #abom0001@;  |DELINDEX #abom0001@;

     |DESTRUYECONTROL enGrid101;

     |HAZ GridFicheroEntero;

     |ESTADO_CONTROL nBoton7,  "ENABLE";
     |ESTADO_CONTROL nBoton6,  "DISABLE";
     |ESTADO_CONTROL nBoton10, "DISABLE";

     aModoLineal = "T";
     |PULSATECLA;
|FPRC;

|PROCESO BorrarBusqueda;
     |CIERRA #abom0001@;  |DELINDEX #abom0001@;

     |DESTRUYECONTROL enGrid101;

     |HAZ GridFicheroEntero;

     |ESTADO_CONTROL nBoton10, "DISABLE";

     |SI aModoLineal = "T";  |HAZ Todos;     |FINSI;
     |SI aModoLineal = "A";  |HAZ Abiertos;  |FINSI;
|FPRC;

|PROCESO ActualizarTexto;
     |DBASE aBase;  |QBF aBase;
     aBase = aBase + "documentos/tmp";   |MKDIR aBase;

     aAbre = aBase + "/" + Usuario + ".txt";
     |FBORRA aAbre;

     |SI nFichero = 801;
         #abom0001#0 = #abom0001@#0;
         |LEE 000#abom0001.=;
     |FINSI;

     |ABRE #abom0002;
     #abom0002#0 = #abom0001#0;
     #abom0002#1 = 1;
     |LEE 101#abom0002.=;         || Dejarlo asi por si estan dentro del documento.
     |SI FSalida ! 0;
         |CIERRA #abom0002;
         |ACABA;
     |FINSI;
     |CIERRA #abom0002;

     |LEE 101#abom0001.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     #abom0001#60 = "";
     #abom0001#61 = "";
     #abom0001#62 = "";
     #abom0001#63 = "";
     #abom0001#64 = "";
     #abom0001#65 = "";
     #abom0001#66 = "";
     #abom0001#67 = "";
     #abom0001#68 = "";
     #abom0001#69 = "";

     |QBF aFicheroActu;
     efFechaDocu    = #abom0002#4;
     enCodUbica     = #abom0002#10;  |HAZ LeeUbicaciones;
     eaFicheroEdita = #abom0002#3;   |QBF eaFicheroEdita;
     enLineas       = 10;

     |HAZ LeeTexto;

     nCampo   = 59;
     aCarac10 = &10;
     aCarac13 = &13;
     aAbre = aBase + "/" + Usuario + ".txt";
     |XABRE "E", aAbre, nHandle;
     |SI FSalida ] 0;
         |XABRE "AB", aAbre, nHandle;
         |PARA;  |SI FSalida ] 0;  |HACIENDO;
             |XLEE nHandle, 1, aAlfa;
             |SI FSalida [ 0;  |SAL;  |FINSI;

             |SI aAlfa = aCarac10;  |O aAlfa = aCarac13;
                 |SI aAlfa ! aCarac10;
                     nCampo   = nCampo + 1;
                     #abom0001#nCampo# = aCadena;
                 |FINSI;
                 aCadena  = "";
             |SINO;
                 aCadena = aCadena + aAlfa;
             |FINSI;
         |SIGUE;
         |XCIERRA nHandle;
     |FINSI;

     |GRABA 020#abom0001.a;
     |LIBERA #abom0001;

     |FBORRA aAbre;
     |REFRESCACONTROL enGrid101;
|FPRC;

|PROCESO Factura;
     |CONFI "0000SSeguro que quiere hacer una factura de este expediente";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nEmpresa = -1;

     |SI #abom0514#46 = "S";
         |MENAV "0000A continuaci¢n seleccione la empresa a la que vamos a generar la factura";

         |ABRE #facemp;
         #facemp#0 = #abom0514#45;
         |LEE 000#facemp.=;

         |CONSULTA_CLAVE #1#facemp;
         |SI FSalida = 0;
             nEmpresa = #facemp#0;
         |FINSI;
         |CIERRA #facemp;
     |SINO;
         nEmpresa = #abom0514#45;
     |FINSI;

     |SI nEmpresa = -1;
         |MENAV "0000Debe seleccionar una empresa de facturaci¢n";
         |ACABA;
     |FINSI;

     |HAZ DesactivaArbol;

     |VENTANA 0501, 2799, -1, 16, "Minuta directa";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     nEmpreAhora = #48#0;

     aAlfa = ":facturar/abxfdica facemp1 " + (("00" + nEmpresa) % -102);
     |SUB_EJECUTA aAlfa;

     aAlfa = ":facturar/abxz9999 facemp1 " + (("00" + nEmpreAhora) % -102);
     |SUB_EJECUTA aAlfa;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |HAZ ActivaArbol;

|FPRC;

|PROCESO EventoTree;
     |SI FEntrada = 0;  |ACABA;  |FINSI;

     aAlfa = Contenido;

     |SI aAlfa = "DatosGenerales";  |HAZ DatosGenerales; |FINSI;
     |SI aAlfa = "Letrados";        |HAZ Letrados;       |FINSI;
     |SI aAlfa = "Seguros";         |HAZ Seguros;        |FINSI;
     |SI aAlfa = "Clientes";        |HAZ Clientes;       |FINSI;
     |SI aAlfa = "Contrarios";      |HAZ Contrarios;     |FINSI;
     |SI aAlfa = "Seguimientos";    |HAZ Seguimientos;   |FINSI;
     |SI aAlfa = "Importes";        |HAZ Importes;       |FINSI;
     |SI aAlfa = "Agenda";          |HAZ Agenda;         |FINSI;
     |SI aAlfa = "CorreoEntrada";   |HAZ CorreoEntrada;  |FINSI;
     |SI aAlfa = "CorreoSalida";    |HAZ CorreoSalida;   |FINSI;
     |SI aAlfa = "Factura";         |HAZ Factura;        |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentArbol;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FOCOTECLADO nTree;
     |HAZ PonDatosCabecera;
|FPRC;

|PROCESO PidePassword;
     nError = 1;

     |ABRE #abom0508;
     |LEE 000#abom0508.p;
     |SI FSalida ! 0;  |DDEFECTO #abom0508;  |FINSI;
     |CIERRA #abom0508;

     |SI #abom0508#nCampo# = "          ";
         nError = 0;
         |ACABA;
     |FINSI;

     |SI nCampo = 1;  aTexto = "Password expediente cerrado";       |FINSI;
     |SI nCampo = 2;  aTexto = "Password expediente confidencial";  |FINSI;

     |VENTANA 2330, 2770, enPanta0, 17, aTexto;
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     E_inf     = "";
     E_sup     = "10";
     aPassword = "";
     aPassword = 2545 ? -1;
     |HAZ PonPassword;

     |SI aCadena ! #abom0508#nCampo#;
         |MENAV "2300 Password incorrecto. Permiso denegado.";
     |SINO;
         nError = 0;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;
|FPRC;

|PROCESO MiraPassword;
     |SI #abom0001#2 ! "01.01.0000";
         nCampo = 1;
         |HAZ PidePassword;
         |SI nError = 1;  |ACABA;  |FINSI;
     |FINSI;

     |SI #abom0001#27 = "S";
         nCampo = 2;
         |HAZ PidePassword;
         |SI nError = 1;  |ACABA;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO MostrarArbol;
     nError = 0;
     |HAZ MiraPassword;
     |SI nError = 1;  |ACABA;  |FINSI;

     |HAZ DesactivaPantPrincipal;

                         nPos1  = 2802;
                         nPos2  = 3493;
     |SI #abom0514#27 ! "S";  nPos1  = 1802;  |FINSI;

     |VENTANA nPos1, 3695, enPanta0, 17, "Opciones";
     nVentArbol = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentArbol;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 082;  |PAUSA;

     aAlfa         = eaRutaDestino + eaFicheroTxt;
     aAlfa = "TREECTRL, Expediente {{" + aAlfa + "}}";
     |CONTROL_SIMPLE 0, aAlfa, nPos1, nPos2, EventoTree;
     nTree = FSalida;

     sT_nID   = nTree;
     sT_nOper = 2;
     sT_aData = "1:";

     |ESPECIFICA "COMMANDCONTROL", sTree;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nTree;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentArbol;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentArbol;

     |HAZ ActivaPantPrincipal;
     |HAZ ActualizaVisita;
|FPRC;

|PROCESO abom0002B;
     |BORRA 020#abom0002.a;
     |LIBERA #abom0002;

     efFechaDocu      = #abom0002#4;
     enCodUbica       = #abom0002#10;  |HAZ LeeUbicaciones;
     eaFicheroEdita   = #abom0002#3;   |QBF eaFicheroEdita;
     aFicheroActu     = eaRutaDocumento + "/" + eaFicheroEdita;

     |SI #abom0514#21 ! "C";
         |RFBORRA aFicheroActu;
     |SINO;
         |FBORRA aFicheroActu;
     |FINSI;
|FPRC;

|DEFBUCLE abom0002B;
     #abom0002#1;
     ;
     #abxz0050#0, 00000;
     #abxz0050#0, 99999;
     be;
     NULL, abom0002B;
|FIN;

|PROCESO abom0003B;
     |BORRA 020#abom0003.a;
     |LIBERA #abom0003;
|FPRC;

|DEFBUCLE abom0003B;
     #abom0003#1;
     ;
     #abxz0050#0, 00000;
     #abxz0050#0, 99999;
     be;
     NULL, abom0003B;
|FIN;

|PROCESO abom0004B;
     |BORRA 020#abom0004.a;
     |LIBERA #abom0004;
|FPRC;

|DEFBUCLE abom0004B;
     #abom0004#1;
     ;
     #abxz0050#0, 000000;
     #abxz0050#0, 999999;
     be;
     NULL, abom0004B;
|FIN;

|PROCESO abom0005B;
     |BORRA 020#abom0005.a;
     |LIBERA #abom0005;
|FPRC;

|DEFBUCLE abom0005B;
     #abom0005#1;
     ;
     #abxz0050#0, 000;
     #abxz0050#0, 999;
     be;
     NULL, abom0005B;
|FIN;

|PROCESO abom0006B;
     |BORRA 020#abom0006.a;
     |LIBERA #abom0006;
|FPRC;

|DEFBUCLE abom0006B;
     #abom0006#1;
     ;
     #abxz0050#0, "01.01.0000", 00, 00, 00;
     #abxz0050#0, "31.12.9999", 99, 99, 99;
     be;
     NULL, abom0006B;
|FIN;

|PROCESO abom0007B;
     |BORRA 020#abom0007.a;
     |LIBERA #abom0007;
|FPRC;

|DEFBUCLE abom0007B;
     #abom0007#1;
     ;
     #abxz0050#0, 000, 00;
     #abxz0050#0, 999, 99;
     be;
     NULL, abom0007B;
|FIN;

|PROCESO abom0013B;
     |BORRA 020#abom0013.a;
     |LIBERA #abom0013;

     efFechaDocu  = #abom0013#6;
     enCodUbica   = #abom0514#9;  |HAZ LeeUbicaciones;

     aFicheroActu = eaRutaDocumento + "/" + (("00000000" + #abom0013#0) % -108) + (("0000" + #abom0013#1) % -104) + ".eml";
     |SI #abom0514#21 ! "C";
         |RFBORRA aFicheroActu;
     |SINO;
         |FBORRA aFicheroActu;
     |FINSI;
|FPRC;

|DEFBUCLE abom0013B;
     #abom0013#1;
     ;
     #abxz0050#0, 0000;
     #abxz0050#0, 9999;
     be;
     NULL, abom0013B;
|FIN;

|PROCESO abom0015B;
     |BORRA 020#abom0015.a;
     |LIBERA #abom0015;

     efFechaDocu = #abom0015#7;
     enCodUbica  = #abom0514#9;  |HAZ LeeUbicaciones;
     aAlfa       = eaRutaDocumento + "/" + (("00000000" + #abom0015#0) % -108) + (("0000" + #abom0015#1) % -104) + ".txt";
     |SI #abom0514#21 ! "C";
         |RFBORRA aAlfa;
     |SINO;
         |FBORRA aAlfa;
     |FINSI;
|FPRC;

|DEFBUCLE abom0015B;
     #abom0015#1;
     ;
     #abxz0050#0, 0000;
     #abxz0050#0, 9999;
     be;
     NULL, abom0015B;
|FIN;

|PROCESO Borrar;
     |CONFI "0000NSeguro que quiere borrar el expediente.";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI nFichero = 801;
         |LEE 101#abom0001@.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         #abom0001#0 = #abxz0050#0;
         |LEE 101#abom0001.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |BORRA 020#abom0001@.a;
         |BORRA 020#abom0001.a;

         |LIBERA #abom0001;
         |LIBERA #abom0001@;
     |SINO;
         |LEE 101#abom0001.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |BORRA 020#abom0001.a;
         |LIBERA #abom0001;
     |FINSI;

     |SI eaFicExp ! "abom0001";
         #fichreal@#0 = #abom0001#0;
         |LEE 101#fichreal@.=;
         |SI FSalida = 0;
             |BORRA 020#fichreal@.a;
             |LIBERA #fichreal@;
         |FINSI;
     |FINSI;

     |BUCLE abom0002B;
     |BUCLE abom0003B;
     |BUCLE abom0004B;
     |BUCLE abom0005B;
     |BUCLE abom0006B;
     |BUCLE abom0007B;
     |BUCLE abom0013B;
     |BUCLE abom0015B;

     |REFRESCACONTROL enGrid101;
|FPRC;

|PROCESO abom0002C;
     |BORRA 020#abom0002.a;
     |LIBERA #abom0002;

     efFechaDocu  = #abom0002#4;
     enCodUbica   = #abom0002#10;  |HAZ LeeUbicaciones;
     eaExtension  = eaExtension < "";
     aAlfa        = #abom0002#3;   |QBF aAlfa;
     aOrigen      = eaRutaDocumento + "/" + aAlfa;

     aAlfa        = "w";
     |SI eaExtension ! "doc";
         |SI eaExtension = "xls";  aAlfa = "e";  |FINSI;
         |SI eaExtension = "tif";  aAlfa = "g";  |FINSI;
     |FINSI;

     #abom0002#0 = enExped;

     |SI #abom0002#1 [ 999;
         #abom0002#3 = aAlfa + (("00000000" + #abom0002#0) % -108) + (("000" + #abom0002#1) % -103) + "." + eaExtension;
     |SINO;
         #abom0002#3 = aAlfa + (("00000000" + #abom0002#0) % -108) + (("00000" + #abom0002#1) % -105) + "." + eaExtension;
     |FINSI;

     aDestino = eaRutaDocumento + "/" + #abom0002#3;   |QBF aDestino;

     |SI #abom0514#21 ! "C";
         |RCOPIA_FICHERO aOrigen, aDestino;

         |RFBORRA aOrigen;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;

         |FBORRA aOrigen;
     |FINSI;

     |GRABA 020#abom0002.n;
     |LIBERA #abom0002;
|FPRC;

|DEFBUCLE abom0002C;
     #abom0002#1;
     ;
     nExpeAnt, 00000;
     nExpeAnt, 99999;
     be;
     NULL, abom0002C;
|FIN;

|PROCESO abom0003C;
     |BORRA 020#abom0003.a;
     |LIBERA #abom0003;

     #abom0003#0 = enExped;

     |GRABA 020#abom0003.n;
     |LIBERA #abom0003;
|FPRC;

|DEFBUCLE abom0003C;
     #abom0003#1;
     ;
     nExpeAnt, 00000;
     nExpeAnt, 99999;
     be;
     NULL, abom0003C;
|FIN;

|PROCESO abom0004C;
     |BORRA 020#abom0004.a;
     |LIBERA #abom0004;

     #abom0004#0 = enExped;

     |GRABA 020#abom0004.n;
     |LIBERA #abom0004;
|FPRC;

|DEFBUCLE abom0004C;
     #abom0004#1;
     ;
     nExpeAnt, 00000;
     nExpeAnt, 99999;
     be;
     NULL, abom0004C;
|FIN;

|PROCESO abom0005C;
     |BORRA 020#abom0005.a;
     |LIBERA #abom0005;

     #abom0005#0 = enExped;

     |GRABA 020#abom0005.n;
     |LIBERA #abom0005;
|FPRC;

|DEFBUCLE abom0005C;
     #abom0005#1;
     ;
     nExpeAnt, 000;
     nExpeAnt, 999;
     be;
     NULL, abom0005C;
|FIN;

|PROCESO abom0006C;
     |BORRA 020#abom0006.a;
     |LIBERA #abom0006;

     #abom0006#0 = enExped;

     |GRABA 020#abom0006.n;
     |LIBERA #abom0006;
|FPRC;

|DEFBUCLE abom0006C;
     #abom0006#1;
     ;
     nExpeAnt, "01.01.0000", 00, 00, 00;
     nExpeAnt, "31.12.9999", 99, 99, 99;
     be;
     NULL, abom0006C;
|FIN;

|PROCESO abom0007C;
     |BORRA 020#abom0007.a;
     |LIBERA #abom0007;

     #abom0007#0 = enExped;

     |GRABA 020#abom0007.n;
     |LIBERA #abom0007;
|FPRC;

|DEFBUCLE abom0007C;
     #abom0007#1;
     ;
     nExpeAnt, 000, 00;
     nExpeAnt, 999, 99;
     be;
     NULL, abom0007C;
|FIN;

|PROCESO abom0013C;
     |BORRA 020#abom0013.a;
     |LIBERA #abom0013;

     efFechaDocu  = #abom0013#6;
     enCodUbica   = #abom0514#9;  |HAZ LeeUbicaciones;

     aOrigen      = eaRutaDocumento + "/" + (("00000000" + #abom0013#0)  % -108) + (("0000" + #abom0013#1) % -104) + ".eml";
     aDestino     = eaRutaDocumento + "/" + (("00000000" + enExped) % -108) + (("0000" + #abom0013#1) % -104) + ".eml";

     |SI #abom0514#21 ! "C";
         |RCOPIA_FICHERO aOrigen, aDestino;
         |RFBORRA aOrigen;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
         |FBORRA aOrigen;
     |FINSI;

     #abom0013#0 = enExped;
     |GRABA 020#abom0013.n;
     |LIBERA #abom0013;
|FPRC;

|DEFBUCLE abom0013C;
     #abom0013#1;
     ;
     nExpeAnt, 0000;
     nExpeAnt, 9999;
     be;
     NULL, abom0013C;
|FIN;

|PROCESO abom0015C;
     |BORRA 020#abom0015.a;
     |LIBERA #abom0015;

     efFechaDocu  = #abom0015#7;
     enCodUbica   = #abom0514#9;  |HAZ LeeUbicaciones;

     aOrigen      = eaRutaDocumento + "/" + (("00000000" + #abom0015#0) % -108)  + (("0000" + #abom0015#1) % -104) + ".txt";
     aDestino     = eaRutaDocumento + "/" + (("00000000" + enExped) % -108) + (("0000" + #abom0015#1) % -104) + ".txt";

     |SI #abom0514#21 ! "C";
         |RCOPIA_FICHERO aOrigen, aDestino;
         |RFBORRA aOrigen;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
         |FBORRA aOrigen;
     |FINSI;

     #abom0015#0 = enExped;
     |GRABA 020#abom0015.n;
     |LIBERA #abom0015;
|FPRC;

|DEFBUCLE abom0015C;
     #abom0015#1;
     ;
     nExpeAnt, 0000;
     nExpeAnt, 9999;
     be;
     NULL, abom0015C;
|FIN;

|PROCESO RealizaCambio;
     |BUCLE abom0002C;
     |BUCLE abom0003C;
     |BUCLE abom0004C;
     |BUCLE abom0005C;
     |BUCLE abom0006C;
     |BUCLE abom0007C;
     |BUCLE abom0013C;
     |BUCLE abom0015C;

     |SI nFichero = 801;
         #abom0001@#0 = nExpeAnt;
         |LEE 101#abom0001@.=;
         |SI FSalida = 0;
             |BORRA 020#abom0001@.a;

             #abom0001@#0 = enExped;
             |GRABA 020#abom0001@.n;

             |LIBERA #abom0001@;
         |FINSI;
     |FINSI;

     #abom0001#0 = nExpeAnt;
     |LEE 101#abom0001.=;
     |SI FSalida = 0;
         |BORRA 020#abom0001.a;

         #abom0001#0 = enExped;
         |GRABA 020#abom0001.n;
         |LIBERA #abom0001;
     |FINSI;

     |SI eaFicExp ! "abom0001";
         #fichreal@#0 = #abom0001#0;
         |LEE 101#fichreal@.=;
         |SI FSalida ! 0;
             |GRABA 020#fichreal@.n;
             |LIBERA #fichreal@;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CambioCodigo;
     |SI nFichero = 801;
         |LEE 000#abom0001@.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         #abom0001#0 = #abom0001@#0;
         |LEE 000#abom0001.=;
     |SINO;
         |LEE 000#abom0001.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     |SI eaFicExp ! "abom0001";
         #fichreal@#0 = #abom0001#0;
         |LEE 101#fichreal@.=;
     |FINSI;

     |HAZ DesactivaPantPrincipal;

     |VENTANA 1001, 1245, -1, 16, "Cambio c¢digo expediente. Introduzca el c¢digo nuevo.";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     nExpeAnt  = #abom0001#0;

     E_inf     = 1;
     E_sup     = 99999999;
     nCambia   = 0;
     enExped   = 0;
     enExped   = 1118 ? 1;

     #abom0001#0    = enExped;
     |LEE 000#abom0001.=;
     |SI FSalida = 0;
         |MENAV "0000El c¢digo introducido ya existe.";
     |SINO;
         aAlfa = "0000NSeguro que quiere cambiar el expediente " + nExpeAnt;
         aAlfa = aAlfa + " por el expediente " + enExped;
         |CONFI aAlfa;
         |SI FSalida = 0;
             nCambia = 1;
         |SINO;
             |MENAV "0000Proceso cancelado.";
         |FINSI;
     |FINSI;

     |SI nCambia = 0;
         #abom0001#0 = nExpeAnt;
         |LEE 000#abom0001.=;
     |SINO;
         |HAZ RealizaCambio;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |HAZ ActivaPantPrincipal;

     |SI nCambia = 1;
         |REFRESCACONTROL enGrid101;  |PULSATECLA;
     |FINSI;
|FPRC;

|PROCESO Nuevo;
     |LEE 000#abom0001.u;
     |SI FSalida ! 0;  |DDEFECTO #abom0001;  |FINSI;

     |SI #abom0001#0 > 99999999;
         |PARA nCampo = 1;  |SI nCampo [ 99999999;  |HACIENDO nCampo = nCampo + 1;
               #abom0001#0 = nCampo;
               |LEE 000#abom0001.=;
               |SI FSalida ! 0;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     #abom0001#0 = #abom0001#0 + 1;

     |DDEFECTO #abxw0014;
     #abxw0014#0 = #abom0001#0;

     |DDEFECTO #abom0001;

     |HAZ DesactivaPantPrincipal;

     |VENTANA 1201, 3499, -1, 17, "Datos Generales";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |C_M #abxw0014#0, 1, "S";

     |PINPA #0#abxw0014;
     nSubPanta = FSalida;

     |CONTROL_SIMPLE nSubPanta, "BOTON,{{197}}", 0651, 0653, NuevoCliente;

     |PINDA #0#abxw0014;
     |ENDATOS #2#abxw0014;
     nFEstado = FSalida;
     |SI FSalida = 0;
         #abom0001#0  =  #abxw0014#0;
         #abom0001#1  =  #abxw0014#1;
         #abom0001#43 =  #abxw0014#2;
         #abom0001#44 =  #abxw0014#3;
         #abom0001#45 =  #abxw0014#4;
         #abom0001#46 =  #abxw0014#5;
         #abom0001#47 =  #abxw0014#6;
         #abom0001#2  =  #abxw0014#7;
         #abom0001#27 =  #abxw0014#8;
         #abom0001#3  =  #abxw0014#9;
         #abom0001#4  =  #abxw0014#10;
         #abom0001#38 =  #abxw0014#11;
         #abom0001#34 =  #abxw0014#12;
         #abom0001#54 =  #abxw0014#13;
         #abom0001#7  =  #abxw0014#14;
         #abom0001#8  =  #abxw0014#15;
         #abom0001#9  =  #abxw0014#16;
         #abom0001#13 =  #abxw0014#17;
         #abom0001#14 =  #abxw0014#18;
         #abom0001#16 =  #abxw0014#19;
         #abom0001#17 =  #abxw0014#20;
         #abom0001#15 =  #abxw0014#21;
         #abom0001#5  =  #abxw0014#22;
         #abom0001#6  =  #abxw0014#23;
         #abom0001#28 =  #abxw0014#24;
         #abom0001#29 =  #abxw0014#25;
         #abom0001#35 =  #abxw0014#26;
         #abom0001#39 =  #abxw0014#27;
         #abom0001#40 =  #abxw0014#28;

         |GRABA 020#abom0001.n;
         |LIBERA #abom0001;

         |SI nFichero = 801;
             |PARA nCampo = 0;  |SI nCampo [ 69;  |HACIENDO nCampo = nCampo + 1;
                   #abom0001@#nCampo# = #abom0001#nCampo#;
             |SIGUE;
             |GRABA 020#abom0001@.n;
             |LIBERA #abom0001@;
         |FINSI;

         |SI eaFicExp ! "abom0001";
             |PARA nCampo = 0;  |SI nCampo [ 69;  |HACIENDO nCampo = nCampo + 1;
                   #fichreal@#nCampo# = #abom0001#nCampo#;
             |SIGUE;
             |GRABA 020#fichreal@.n;
             |LIBERA #fichreal@;
         |FINSI;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |HAZ ActivaPantPrincipal;

     |PULSATECLA;

     |SI nFEstado = 0;
         |SI nFichero = 801;
             #abom0001@#0 = #abxw0014#0;
             |LEE 000#abom0001@.=;

             #abom0001#0 = #abom0001@#0;
             |LEE 000#abom0001.=;
         |SINO;
             #abom0001#0 = #abxw0014#0;
             |LEE 000#abom0001.=;
         |FINSI;

         |HAZ PonDatosCabecera;

         |REFRESCACONTROL enGrid101;
         |HAZ MostrarArbol;
     |FINSI;
|FPRC;

|PROCESO DesdeFecha;
     |VENTANA 1001, 1245, -1, 16, "Expedientes visitados desde la fecha ...";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     E_inf     = "";
     E_sup     = "10";
     fDFecha   = 1118 ? 1;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |REFRESCACONTROL enGrid150;

     |FOCOTECLADO enGrid150;
|FPRC;

|PROCESO PonDatosCabecera;
     |DDEFECTO #abxz0050;

     #abxz0050#0  = #abom0001#0;
     #abxz0050#1  = #abom0001#3;
     #abxz0050#2  = #abom0001#4;
     #abxz0050#3  = #abom0001#28;
     #abxz0050#4  = #abom0001#29;
     #abxz0050#5  = #abom0001#5;
     #abxz0050#6  = #abom0001#6;
     #abxz0050#7  = #abom0001#16;
     #abxz0050#8  = #abom0001#17;
     #abxz0050#9  = #abom0001#15;
     #abxz0050#10 = #abom0001#18;
     #abxz0050#11 = #abom0001#19;
     #abxz0050#12 = #abom0001#24;
     #abxz0050#13 = #abom0001#25;
     #abxz0050#14 = #abom0001#7;
     #abxz0050#15 = #abom0001#8;
     #abxz0050#16 = #abom0001#9;
     #abxz0050#27 = #abom0001#38;

     |SI #abom0514#27 = "S";
         #abxz0050#17 = #abom0001#60;
         #abxz0050#18 = #abom0001#61;
         #abxz0050#19 = #abom0001#62;
         #abxz0050#20 = #abom0001#63;
         #abxz0050#21 = #abom0001#64;
         #abxz0050#22 = #abom0001#65;
         #abxz0050#23 = #abom0001#66;
         #abxz0050#24 = #abom0001#67;
         #abxz0050#25 = #abom0001#68;
         #abxz0050#26 = #abom0001#69;

         |PINTA #abxz0050#17;
     |FINSI;

     |PINTA #abxz0050#0;
     |PINTA #abxz0050#2;
     |PINTA #abxz0050#4;
     |PINTA #abxz0050#6;
     |PINTA #abxz0050#8;
     |PINTA #abxz0050#11;
     |PINTA #abxz0050#13;
     |PINTA #abxz0050#9;
     |PINTA #abxz0050#14;
     |PINTA #abxz0050#27;

     |PULSATECLA;
|FPRC;

|PROCESO CargaArbol;
     eaAlfa = eaAlfa + &13 + &10;

     |XGRABA nHandle, eaAlfa;
|FPRC;

|PROCESO MontaArbol;
     |DBASE aBase;  |QBF aBase;
     aAlfa = aBase + "documentos";      |MKDIR aAlfa;
     aAlfa = aBase + "documentos/tmp";  |MKDIR aAlfa;

     eaRutaOrigen  = aBase + "documentos/tmp/";
     eaRutaDestino = eaUnidadBasico + "\documentos";           |RMKDIR eaRutaDestino;
     eaRutaDestino = eaUnidadBasico + "\documentos\tmp";       |RMKDIR eaRutaDestino;
     eaRutaDestino = eaUnidadBasico + "\documentos\tmp\";
     eaFicheroTxt  = "abxz005001" + Usuario + ".txt";
     eaFicheroTgz  = "abxz005001" + Usuario + ".tgz";
     eaFicheroTar  = "abxz005001" + Usuario + ".tar";

     aAbre = eaRutaOrigen + eaFicheroTxt;

     |XABRE "WB", aAbre, nHandle;

     nConta1 = 1;
     eaAlfa  = nConta1 + ":Datos del expediente";  |HAZ CargaArbol;

     nConta2 = 1;
     eaAlfa  = nConta1 + "," + nConta2 + ":Datos generales {{DatosGenerales}}";  |HAZ CargaArbol;

     nConta2 = nConta2 + 1;
     eaAlfa  = nConta1 + "," + nConta2 + ":Letrados {{Letrados}}";         |HAZ CargaArbol;

     |SI #abom0514#18 = "S";
         nConta2 = nConta2 + 1;
         eaAlfa  = nConta1 + "," + nConta2 + ":Corredur¡a de Seguros {{Seguros}}";  |HAZ CargaArbol;
     |FINSI;

     |SI #abom0514#13 = "S";
         nConta2 = nConta2 + 1;
         eaAlfa  = nConta1 + "," + nConta2 + ":Clientes {{Clientes}}";  |HAZ CargaArbol;
     |FINSI;

     nConta2 = nConta2 + 1;
     eaAlfa  = nConta1 + "," + nConta2 + ":Contrarios  {{Contrarios}}";  |HAZ CargaArbol;


     nConta1 = nConta1 + 1;
     eaAlfa  = nConta1 + ":Seguimiento e importes";   |HAZ CargaArbol;
     eaAlfa  = nConta1 + ",1:Seguimiento expediente {{Seguimientos}}";  |HAZ CargaArbol;
     eaAlfa  = nConta1 + ",2:Importes expediente {{Importes}}";  |HAZ CargaArbol;

     nConta1 = nConta1 + 1;
     eaAlfa  = nConta1 + ":Agenda  {{Agenda}}";  |HAZ CargaArbol;

     |SI #abom0514#1 = "S";
         nConta1 = nConta1 + 1;
         eaAlfa  = nConta1 + ":Correos";  |HAZ CargaArbol;
         eaAlfa  = nConta1 + ",1:Entradas {{CorreoEntrada}}";  |HAZ CargaArbol;
         eaAlfa  = nConta1 + ",2:Salidas {{CorreoSalida}}";  |HAZ CargaArbol;
     |FINSI;

     nConta1 = nConta1 + 1;
     eaAlfa  = nConta1 + ":Crear factura directa  {{Factura}}";  |HAZ CargaArbol;

     |XCIERRA nHandle;

     |HAZ TraeTxtComprimido;
     aAlfa = eaRutaDestino + eaFicheroTxt;
|FPRC;

|PROCESO PintaLogo;
     |XABRE "E", aFotoOrigen, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     aLong  = aFotoOrigen % 0;
     nLong  = aLong;
     aLogo  = "";
     |PARA nCaracter = 1;  |SI nCaracter [ nLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPos      = (100 * nCaracter) + 1;
           aCaracter = aFotoOrigen % nPos;
           |SI aCaracter = "/";  |O aCaracter = "\";
               aLogo = "";
           |SINO;
               aLogo = aLogo + aCaracter;
           |FINSI;
     |SIGUE;

     aDirLocal    = eaUnidadBasico + "\DOCUMENTOS";                     |RMKDIR aDirLocal;
     aDirLocal    = eaUnidadBasico + "\DOCUMENTOS\IPABOGAD";            |RMKDIR aDirLocal;
     aDirLocal    = eaUnidadBasico + "\DOCUMENTOS\IPABOGAD\LOGOS";      |RMKDIR aDirLocal;
     aFotoDestino = aDirLocal + "/" + aLogo;

     aContiene1 = aFotoDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = aFotoOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aFotoOrigen, aFotoDestino;
         |SINO;
             |COPIA_FICHERO aFotoOrigen, aFotoDestino;
         |FINSI;
     |FINSI;

     aFoto = "IMAGEN,"  + aFotoDestino;
     |CONTROL_SIMPLE enPanta0, aFoto, 0501, 0923, NULL;
     nBotonFoto = FSalida;

     |PULSATECLA;
|FPRC;

|PROCESO BotonesPanta0;
     aFotoOrigen = #abom0514#28;  |QBF aFotoOrigen;

     |SI aFotoOrigen = "";
        aFotoOrigen = "/u/dsprofes/facturar/plantillas/insertar.bmp";
     |FINSI;

     |SI aFotoOrigen ! "";  |HAZ PintaLogo;  |FINSI;

     |CONTROL_SIMPLE enPanta0, "BOTON,Todos", 0886, 0898, Todos;
     nBoton6  = FSalida;

     |CONTROL_SIMPLE enPanta0, "BOTON, Abiertos", 0986, 0998, Abiertos;
     nBoton7  = FSalida;

     |SI #abom0514#27 = "S";
         |CONTROL_SIMPLE enPanta0, "BOTON,{{204}}Busqueda", 2802, 2815, Busqueda;
         nBoton9  = FSalida;

         |CONTROL_SIMPLE enPanta0, "BOTON,{{207}}Borrar busqueda", 2817, 2835, BorrarBusqueda;
         nBoton10  = FSalida;

         |CONTROL_SIMPLE enPanta0, "BOTON,{{197}}Cambio c¢digo expediente", 2875, 2898, CambioCodigo;
         nBoton13  = FSalida;

         |CONTROL_SIMPLE enPanta0, "BOTON,{{202}}", 1665, 1668, ActualizarTexto;
         nBoton11  = FSalida;

         |CONTROL_SIMPLE enPanta0, "LABEL,{{0}}Actualizar texto", 1670, 1685, NULL;
     |SINO;
         |CONTROL_SIMPLE enPanta0, "BOTON,{{204}}Busqueda", 1820, 1833, Busqueda;
         nBoton9  = FSalida;

         |CONTROL_SIMPLE enPanta0, "BOTON,{{207}}Borrar busqueda", 1835, 1852, BorrarBusqueda;
         nBoton10  = FSalida;

         |CONTROL_SIMPLE enPanta0, "BOTON,{{197}}Cambio c¢digo expediente", 1875, 1898, CambioCodigo;
         nBoton13  = FSalida;
     |FINSI;

     |CONTROL_SIMPLE enPanta0, "BOTON,{{197}}", 1115, 1117, DesdeFecha;

     |ESTADO_CONTROL nBoton1, "DISABLE";
     |ESTADO_CONTROL nBoton10, "DISABLE";
     |FIN_CONTROL_WINDOWS nBotonLabel;
|FPRC;


|PROCESO Baja150;
     #abom0050#0 = aUsuario;
     #abom0050#1 = fHFecha;
     #abom0050#2 = "zzzzzzzz";
|FPRC;

|PROCESO Alta150;
     #abom0050#0 = aUsuario;
     #abom0050#1 = fDFecha;
     #abom0050#2 = "        ";
|FPRC;

|PROCESO Evento150;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#abom0050.c;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |SI nFichero = 801;
             |SELECT #1#abom0001@;
             #abom0001@#0 = #abom0050#3;
             |LEE 000#abom0001@.=;
             |SI FSalida ! 0;
                 |HAZ Todos;

                 #abom0001#0 = #abom0050#3;
                 |LEE 000#abom0001.=;
             |FINSI;

             |REFRESCACONTROL enGrid101;
             |ACABA;
         |FINSI;

         |SI nFichero = 101;
             #abom0001#0 = #abom0050#3;
             |LEE 000#abom0001.=;

             |REFRESCACONTROL enGrid101;
         |FINSI;
     |FINSI;
|FPRC;

|PROGRAMA;
     |HAZ LeeUnidadBasico;

     aUsuario      = Usuario % 810;
     aUsuario      = (aUsuario + "          ") % 110;
     aModoLineal   = "T";

     |CONTROL_SIMPLE 0, "BOTON,Mostrar Arbol", 3602, 3615, MostrarArbol;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Nuevo", 3620, 3630, Nuevo;
     nBoton2  = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{199}}Borrar", 3632, 3642, Borrar;
     nBoton3  = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Gesti¢n documental", 3644, 3662, GestionDocumental;
     nBoton5  = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Emisiones", 3664, 3674, Emisiones;
     nBoton12 = FSalida;


     |ESTADO_CONTROL nBoton1,  "DISABLE";
     |ESTADO_CONTROL nBoton3,  "DISABLE";
     |ESTADO_CONTROL nBoton13, "DISABLE";

     |PINPA #0#abxz0050;  enPanta0 = FSalida;

     |HAZ MontaArbol;
     |HAZ BotonesPanta0;

     |ESTADO_CONTROL nBoton6, "DISABLE";

     nFichero = 101;

     nPos1_150  = 1201;
     |SI #abom0514#27 = "S";
         |CONTROL_SIMPLE enPanta0, "LABEL,{{15}}Asunto ficha", 1687, 1699, NULL;
         nPos1_101  = 2902;
         nPos2_150  = 2717;
     |SINO;
         |C_V #abxz0050#17, 1, "N";
         nPos1_101  = 1902;
         nPos2_150  = 1717;
     |FINSI;
     nPos2_101 = 3798;

     nRango   = 4 + 8 + 16 + 32 + 128;
     |HAZ Abiertos;

     fDFecha = ~;
     fHFecha = ~;
     nRango = 4 + 8 + 16 + 32 + 128 + 256;
     |LINEAL_SIMPLE #1#abom0050, nRango, nPos1_150, nPos2_150, Baja150, Alta150, Evento150;
     enGrid150 = FSalida;

     FSalida = 1;  |HAZ Evento150;

     |REFRESCACONTROL enGrid101;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + enGrid101;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |PULSATECLA;

     |DESTRUYECONTROL enGrid101;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton5;
     |FIN_CONTROL_WINDOWS nBoton6;
     |FIN_CONTROL_WINDOWS nBoton7;
     |FIN_CONTROL_WINDOWS nBoton9;
     |FIN_CONTROL_WINDOWS nBoton10;
     |FIN_CONTROL_WINDOWS nBoton12;
     |FIN_CONTROL_WINDOWS nBoton13;
     |FIN_CONTROL_WINDOWS nBotonFoto;

     |SI #abom0514#27 = "S";  |FIN_CONTROL_WINDOWS nBoton11;  |FINSI;

     eaFicheroTxt  = "abxz005001" + Usuario + ".txt";
     aAlfa         = eaRutaDestino + eaFicheroTxt;
     |RFBORRA aAlfa;
|FPRO;

|PROCESO Tipo80Fz50; |TIPO 80;
     |ABRE #abom0500;
     #abom0500#0 = Usuario % 810;
     |LEE 000#abom0500.=;
     |SI FSalida ! 0;  |DDEFECTO #abom0500;  |FINSI;
     |CIERRA #abom0500;

     eaFicExp = "abom0001";
     |SI #abom0500#6 = "S";
         |SUB_EJECUTA_NP "abxz0004;PROPIOS";

         eaFicExp = "prps" + Usuario;
     |FINSI;

     |NOME_DAT #abom0001#eaFicExp#;

     |ABRE #abom0514;
     |LEE 000#abom0514.p;
     |SI FSalida ! 0;  |DDEFECTO #abom0514;  |FINSI;
     |CIERRA #abom0514;

     |DBASE aDef;  |QBF aDef;
     aMas = aDef + "def/abom0001.mas";
     |CARGA_DEF aMas, abom0001@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI eaFicExp ! "abom0001";
         |CARGA_DEF aMas, fichreal@;

         |ABRET #fichreal@;
     |FINSI;

     eaFichero = "abom0001" + Usuario;
     |NOME_DAT #abom0001@#eaFichero#;
     |ABRE #abom0001@;  |CIERRA #abom0001@;  |DELINDEX #abom0001@;

     |ABRET #abom0001;
     |ABRET #abom0050;

     FSalida = 3699;
|FPRC;

|PROCESO Tipo90Fz50; |TIPO 90;
     |CIERRAT #abom0001;
     |CIERRAT #abom0050;

     |ABRE #abom0001@;  |CIERRA #abom0001@;  |DELINDEX #abom0001@;
     |DESCARGA_DEF #abom0001@;

     |SI eaFicExp ! "abom0001";
         |NOME_DAT #abom0001#eaFicExp#;
         |ABRE #abom0001;  |CIERRA #abom0001;  |DELINDEX #abom0001;

         |CIERRAT #fichreal@;
         |DESCARGA_DEF #fichreal@;
     |FINSI;
|FPRC;
