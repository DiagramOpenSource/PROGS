|FICHEROS;
     abxz0003;
     abom0514;
     abom0508;
     abom0518;
     abom0519;
     abom0520;

     abxw0010,MANTE;
     abxw0011,MANTE;
     abxw0012,MANTE;
     abxw0013,MANTE;
     abxw0023,MANTE;
|FIN;

|VARIABLES;
     nNumero        = 0;
     aMensaje       = "";
     aMas           = "";

     aAbre          = "";
     aBase          = "";
     aAlfa          = "";
     aEsc1          = "";
     aEsc2          = "";
     aRetu          = "";
     aTecla         = "";
     aFichero       = "";
     aCarga         = "";
     aQueQuiero     = "";
     aTexto         = "";
     aLong          = "";
     aCarac         = "";
     aRefresca      = "";
     aBusca         = "";
     aContenido     = "";
     aDirec         = "";
     aLogo          = "";
     aCaracter      = "";
     aPathLogo      = "";
     aOrigen        = "";
     aDestino       = "";
     aIPRemoto      = "";

     nBotonLabel    = -1;
     nLabel         = -1;
     nHandle        = 0;
     nTree          = -1;
     nPanta         = 0;
     nSubPanta      = 0;
     nLong          = 0;
     nCargar        = 0;
     nPos           = 0;
     nPosi          = 0;
     nBoton1        = 0;
     nBoton2        = 0;
     nBoton3        = 0;
     nSubVent       = 0;
     nCampo         = 0;
     nTCampo        = 0;
     nCarpeta       = 0;
     nRango         = 0;
     nGrid          = 0;
     nCaracter      = 0;
     nConta1        = 0;
     nConta2        = 0;

     {-1}sTree      = 0;
     sT_nID         = 0;
     sT_nOper       = 0;
     sT_aData       = "";

     {-1}aVent      = "";
         aVent1     = 0;
         aVent2     = 0;
         aVent3     = 0;
         aVent4     = 0;
         aVent5     = "";

     &eaRutaOrigen  = "";
     &eaRutaDestino = "";
     &eaFicheroTxt  = "";
     &eaFicheroTgz  = "";
     &eaFicheroTar  = "";
     &eaAlfa        = "";
     &aPassword     = "";
     &aCadena       = "";
     &eaUnidadBasico = "";
     &eaDsOporte     = "";
     &enBtnHTM       = 0;
|FIN;

|PROCESO Documental;
     |VENTANA 1010, 1790, -1, 17, aTexto;
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#abom0514.p;
     |SI FSalida ! 0;
         |DDEFECTO #abom0514;
         |GRABA 020#abom0514.b;
     |FINSI;

     #abxw0010#0 = #abom0514#21;
     #abxw0010#1 = #abom0514#23;

     |SI #abxw0010#0 = "C";  |C_M #abxw0010#0, 1, "N";  |FINSI;

     |PINPA #0#abxw0010;
     |PINDA #0#abxw0010;

     |ENDATOS #1#abxw0010;
     |SI FSalida = 0;
         #abom0514#21 = #abxw0010#0;
         #abom0514#23 = #abxw0010#1;
         |GRABA 020#abom0514.a;
     |FINSI;
     |LIBERA #abom0514;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Browse;
     aDirec = "F";
     |BROWSE aDirec;
     aDirec = aDirec % 0299;  |QBF aDirec;
     |SI aDirec = "";  |ACABA;  |FINSI;

     aLong = aDirec % 0;
     nLong = aLong;
     aLogo = "";
     |PARA nCaracter = 1;  |SI nCaracter [ nLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPos      = (100 * nCaracter) + 1;
           aCaracter = aDirec % nPos;
           |SI aCaracter = "/";  |O aCaracter = "\";
               aLogo = "";
           |SINO;
               aLogo = aLogo + aCaracter;
           |FINSI;
     |SIGUE;

     |DBASE aBase;  |QBF aBase;
     aPathLogo = aBase + "logos";  |MKDIR aPathLogo;

     aOrigen  = aDirec;
     aDestino = aPathLogo + "/" + aLogo;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |RECIBE_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     #abxw0011#4 = aDestino;  |PINTA #abxw0011#4;
|FPRC;

|PROCESO Expediente;
     |VENTANA 1010, 2190, -1, 17, aTexto;
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#abom0514.p;
     |SI FSalida ! 0;
         |DDEFECTO #abom0514;
         |GRABA 020#abom0514.b;
     |FINSI;

     #abxw0011#0  = #abom0514#18;
     #abxw0011#1  = #abom0514#13;
     #abxw0011#2  = #abom0514#19;
     #abxw0011#3  = #abom0514#27;
     #abxw0011#4  = #abom0514#28;
     #abxw0011#5  = #abom0514#45;
     #abxw0011#6  = #abom0514#46;

     |PINPA #0#abxw0011;  nSubPanta = FSalida;
     |PINDA #0#abxw0011;

     |CONTROL_SIMPLE nSubPanta, "BOTON,{{136}}", 1410, 1412, Browse;

     |ENDATOS #1#abxw0011;
     |SI FSalida = 0;
         #abom0514#18 = #abxw0011#0;
         #abom0514#13 = #abxw0011#1;
         #abom0514#19 = #abxw0011#2;
         #abom0514#27 = #abxw0011#3;
         #abom0514#28 = #abxw0011#4;
         #abom0514#45 = #abxw0011#5;
         #abom0514#46 = #abxw0011#6;
         |GRABA 020#abom0514.a;
     |FINSI;
     |LIBERA #abom0514;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO PasswordNuevo;
     |CONTROL_SIMPLE 0, "LABEL,{{1}}Introduzca password nuevo", 1117, 1150, NULL;
     nLabel = FSalida;

     E_inf     = "";
     E_sup     = "10";
     aPassword = "";
     aPassword = 1325 ? -1;
     |SI aPassword ! "          ";
         |HAZ PonPassword;
         aPassword = aCadena;
     |FINSI;

     |FIN_CONTROL_WINDOWS nLabel;
|FPRC;

|PROCESO VerificaPassword;
     |CONTROL_SIMPLE 0, "LABEL,{{1}}Introduzca password actual", 1117, 1150, NULL;
     nLabel = FSalida;

     E_inf     = "";
     E_sup     = "10";
     aPassword = "";
     aPassword = 1325 ? -1;
     |HAZ PonPassword;
     |SI aCadena ! #abom0508#nCampo#;
         |MENAV "0000 Password incorrecto, proceso cancelado";
         aPassword = #abom0508#nCampo#;

         |FIN_CONTROL_WINDOWS nLabel;
         |ACABA;
     |FINSI;

     |FIN_CONTROL_WINDOWS nLabel;

     |HAZ PasswordNuevo;
|FPRC;

|PROCESO ExpedCerrado;
     |VENTANA 1010, 1450, -1, 17, aTexto;
     nSubVent = FSalida;

     nLabel = -1;
     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#abom0508.p;
     |SI FSalida ! 0;
         |DDEFECTO #abom0508;
         |GRABA 020#abom0508.b;
     |FINSI;

     nCampo = 1;

     |SI #abom0508#1 = "          ";
         |HAZ PasswordNuevo;
         #abom0508#1 = aPassword;
     |SINO;
         |HAZ VerificaPassword;
         #abom0508#1 = aPassword;
     |FINSI;

     |GRABA 020#abom0508.a;
     |LIBERA #abom0508;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO ExpedConfidencial;
     |VENTANA 1010, 1450, -1, 17, aTexto;
     nSubVent = FSalida;

     nLabel = -1;
     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#abom0508.p;
     |SI FSalida ! 0;
         |DDEFECTO #abom0508;
         |GRABA 020#abom0508.b;
     |FINSI;

     nCampo = 2;

     |SI #abom0508#2 = "          ";
         |HAZ PasswordNuevo;
         #abom0508#2 = aPassword;
     |SINO;
         |HAZ VerificaPassword;
         #abom0508#2 = aPassword;
     |FINSI;

     |GRABA 020#abom0508.a;
     |LIBERA #abom0508;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Administrador;
     |VENTANA 1010, 1450, -1, 17, aTexto;
     nSubVent = FSalida;

     nLabel = -1;
     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#abom0508.p;
     |SI FSalida ! 0;
         |DDEFECTO #abom0508;
         |GRABA 020#abom0508.b;
     |FINSI;

     nCampo = 5;

     |SI #abom0508#5 = "          ";
         |HAZ PasswordNuevo;
         #abom0508#5 = aPassword;
     |SINO;
         |HAZ VerificaPassword;
         #abom0508#5 = aPassword;
     |FINSI;

     |GRABA 020#abom0508.a;
     |LIBERA #abom0508;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO BrowseHTM;
     aDirec = "F*.htm";
     |BROWSE aDirec;
     aDirec = aDirec % 0299;  |QBF aDirec;
     |SI aDirec = "";  |ACABA;  |FINSI;

     aLong = aDirec % 0;
     nLong = aLong;
     aAlfa = "";
     |PARA nCaracter = 1;  |SI nCaracter [ nLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPos      = (100 * nCaracter) + 1;
           aCaracter = aDirec % nPos;
           |SI aCaracter = "/";  |O aCaracter = "\";
               aAlfa = "";
           |SINO;
               aAlfa = aAlfa + aCaracter;
           |FINSI;
     |SIGUE;

     |DBASE aBase;  |QBF aBase;
     aBase    = aBase + "dscorreo";           |MKDIR aBase;
     aDestino = aBase + "/" + aAlfa;
     aOrigen  = aDirec;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |RECIBE_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     #abxw0012#11 = aAlfa;  |PINTA #abxw0012#11;
|FPRC;

|PROCESO Correo;
     |VENTANA 0501, 2782, -1, 16, aTexto;
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#abom0514.p;
     |SI FSalida ! 0;
         |DDEFECTO #abom0514;
         |GRABA 020#abom0514.b;
     |FINSI;

     #abxw0012#0  = #abom0514#1;
     #abxw0012#1  = #abom0514#24;
     #abxw0012#2  = #abom0514#25;
     #abxw0012#3  = #abom0514#26;
     #abxw0012#4  = #abom0514#9;
     #abxw0012#5  = #abom0514#14;
     #abxw0012#6  = #abom0514#17;
     #abxw0012#7  = #abom0514#29;
     #abxw0012#8  = #abom0514#30;
     #abxw0012#9  = #abom0514#31;
     #abxw0012#10 = #abom0514#47;
     #abxw0012#11 = #abom0514#48;

     |PINPA #0#abxw0012;  nSubPanta = FSalida;
     |PINDA #0#abxw0012;

     |CONTROL_SIMPLE nSubPanta, "BOTON,{{136}}", 1527, 1529, BrowseHTM;
     enBtnHTM = FSalida;

     |ESTADO_CONTROL enBtnHTM, "ENABLE";
     |SI #abxw0012#10 = "N";
         |ESTADO_CONTROL enBtnHTM, "DISABLE";
     |FINSI;

     |ENDATOS #1#abxw0012;
     |SI FSalida = 0;
         #abom0514#1  = #abxw0012#0;
         #abom0514#24 = #abxw0012#1;
         #abom0514#25 = #abxw0012#2;
         #abom0514#26 = #abxw0012#3;
         #abom0514#9  = #abxw0012#4;
         #abom0514#14 = #abxw0012#5;
         #abom0514#17 = #abxw0012#6;
         |SI #abom0514#1 = "N";
             #abom0514#14 = "N";
             #abom0514#17 = "N";
         |FINSI;
         #abom0514#15 = 0;
         #abom0514#16 = 0;
         #abom0514#11 = "";
         #abom0514#29 = #abxw0012#7;
         #abom0514#30 = #abxw0012#8;
         #abom0514#31 = #abxw0012#9;
         #abom0514#47 = #abxw0012#10;
         #abom0514#48 = #abxw0012#11;
         |GRABA 020#abom0514.a;
     |FINSI;
     |LIBERA #abom0514;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;

     aBusca = aContenido;
     |HAZ MontaArbol;
|FPRC;

|PROCESO Evento519;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#abom0519.=;
     |FINSI;
|FPRC;

|PROCESO Referencia;
     |VENTANA 0702, 2297, -1, 17, aTexto;
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     nRango = 1 + 4 + 8 + 16 + 32 + 128;

     |LINEAL_SIMPLE #1#abom0519, nRango, 0703, 2096, NULL, NULL, Evento519;
     nGrid  = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nGrid;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Evento520;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#abom0520.=;
     |FINSI;
|FPRC;

|PROCESO CodExpe;
     |VENTANA 0702, 2297, -1, 17, aTexto;
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     nRango = 1 + 4 + 8 + 16 + 32 + 128;

     |LINEAL_SIMPLE #1#abom0520, nRango, 0703, 2096, NULL, NULL, Evento520;
     nGrid  = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nGrid;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Outlook;
     |VENTANA 1010, 1790, -1, 17, aTexto;
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#abom0514.p;
     |SI FSalida ! 0;
         |DDEFECTO #abom0514;
         |GRABA 020#abom0514.b;
     |FINSI;

     #abxw0013#0 = #abom0514#2;
     #abxw0013#1 = #abom0514#12;

     |PINPA #0#abxw0013;
     |PINDA #0#abxw0013;

     |ENDATOS #1#abxw0013;
     |SI FSalida = 0;
         #abom0514#2  = #abxw0013#0;
         #abom0514#12 = #abxw0013#1;
         |GRABA 020#abom0514.a;
     |FINSI;
     |LIBERA #abom0514;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Procuradores;
     |VENTANA 0501, 2375, -1, 16, aTexto;
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#abom0514.p;
     |SI FSalida ! 0;
         |DDEFECTO #abom0514;
         |GRABA 020#abom0514.b;
     |FINSI;

     #abom0514#32 = 99;
     #abxw0023#0  = #abom0514#32;
     #abxw0023#2  = #abom0514#33;
     #abxw0023#4  = #abom0514#34;
     #abxw0023#5  = #abom0514#35;
     #abxw0023#6  = #abom0514#36;
     #abxw0023#7  = #abom0514#37;
     #abxw0023#8  = #abom0514#38;
     #abxw0023#9  = #abom0514#39;
     #abxw0023#10 = #abom0514#40;
     #abxw0023#11 = #abom0514#41;
     #abxw0023#12 = #abom0514#42;
     #abxw0023#13 = #abom0514#43;
     #abxw0023#15 = #abom0514#44;

     |PINPA #0#abxw0023;

     |SI eaDsOporte = "G";
                                #abxw0023#0  = 0;
                                #abxw0023#1  = "";
         |C_M #abxw0023#2, 1, "N";   #abxw0023#2  = 0;
                                #abxw0023#3  = "";

         |SI #abxw0023#13 = 0;  #abxw0023#13 = 9001;  |FINSI;

         |C_M #abxw0023#13, 1, "S";
     |FINSI;

     |SI eaDsOporte = "A";
         |C_M #abxw0023#13, 1, "N";  #abxw0023#13 = 0;
         |C_M #abxw0023#2,  1, "S";
     |FINSI;

     |PINDA #0#abxw0023;

     |ENDATOS #2#abxw0023;
     |SI FSalida = 0;
         #abom0514#32 = #abxw0023#0;
         #abom0514#33 = #abxw0023#2;
         #abom0514#34 = #abxw0023#4;
         #abom0514#35 = #abxw0023#5;
         #abom0514#36 = #abxw0023#6;
         #abom0514#37 = #abxw0023#7;
         #abom0514#38 = #abxw0023#8;
         #abom0514#39 = #abxw0023#9;
         #abom0514#40 = #abxw0023#10;
         #abom0514#41 = #abxw0023#11;
         #abom0514#42 = #abxw0023#12;
         #abom0514#43 = #abxw0023#13;
         #abom0514#44 = #abxw0023#15;

         |GRABA 020#abom0514.a;
     |FINSI;
     |LIBERA #abom0514;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;

     aBusca = aContenido;
     |HAZ MontaArbol;
|FPRC;

|PROCESO EventoTree;
     |SI FEntrada = 0;
         aAlfa = "";
         aLong = Contenido % 0;
         nLong = aLong;
         |PARA nPosi = 1;  |SI nPosi [ nLong;  |HACIENDO nPosi = nPosi + 1;
               nPos = (nPosi * 100) + 1;
               aCarac = Contenido % nPos;
               |SI aCarac = ":";  |SAL;  |FINSI;
               aAlfa  = aAlfa + aCarac;
         |SIGUE;

         |QBT aAlfa;

         sT_nID   = nTree;
         sT_nOper = 4;
         sT_aData = ":" + aAlfa;

         |ESPECIFICA "COMMANDCONTROL", sTree;
         aTexto = Contenido;

         |ACABA;
     |FINSI;

     aContenido = Contenido;

     |SI Contenido = "Documental";         |HAZ Documental;         |FINSI;
     |SI Contenido = "Expediente";         |HAZ Expediente;         |FINSI;
     |SI Contenido = "ExpedCerrado";       |HAZ ExpedCerrado;       |FINSI;
     |SI Contenido = "ExpedConfidencial";  |HAZ ExpedConfidencial;  |FINSI;
     |SI Contenido = "Administrador";      |HAZ Administrador;      |FINSI;
     |SI Contenido = "Correo";             |HAZ Correo;             |FINSI;
     |SI Contenido = "Referencia";         |HAZ Referencia;         |FINSI;
     |SI Contenido = "CodExpe";            |HAZ CodExpe;            |FINSI;
     |SI Contenido = "Outlook";            |HAZ Outlook;            |FINSI;
     |SI Contenido = "Procuradores";       |HAZ Procuradores;       |FINSI;
|FPRC;

|PROCESO CargaArbol;
     |QBF aAlfa;
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO MontaArbol;
     |HAZ LeeUnidadBasico;

     |SI nTree ! -1;
         |FIN_CONTROL_WINDOWS nTree;
         nTree = -1;
     |FINSI;

     |CONTROL_SIMPLE 0, "LABEL,{{5}}Cargando informaci¢n ...", 1315, 1680, NULL;
     nBotonLabel = FSalida;

     |PTEC 802;  |PAUSA;

     |DBASE aBase;  |QBF aBase;
     aAlfa = aBase + "basura";          |MKDIR aAlfa;

     eaRutaOrigen  = aBase + "basura/";
     eaRutaDestino = eaUnidadBasico + "\documentos";           |RMKDIR eaRutaDestino;
     eaRutaDestino = eaUnidadBasico + "\documentos\tmp";       |RMKDIR eaRutaDestino;
     eaRutaDestino = eaUnidadBasico + "\documentos\tmp\";
     eaFicheroTxt  = "abxz000301" + Usuario + ".txt";
     eaFicheroTgz  = "abxz000301" + Usuario + ".tgz";
     eaFicheroTar  = "abxz000301" + Usuario + ".tar";

     aAbre = eaRutaOrigen + eaFicheroTxt;

     sT_nID   = nTree;
     sT_nOper = 0;

     |XABRE "WB", aAbre, nHandle;

     nConta1 = 1;
     nConta2 = 0;

     aAlfa   = nConta1 + ":Configuraci¢n gesti¢n documental";
     |HAZ CargaArbol;

     nConta2 = nConta2 + 1;
     aAlfa   = nConta1 + "," + nConta2 + ":Configuraci¢n gesti¢n documental {{Documental}}";
     |HAZ CargaArbol;

     nConta1 = nConta1 + 1;
     nConta2 = 0;

     aAlfa   = nConta1 + ":Configuraci¢n gesti¢n expedientes";
     |HAZ CargaArbol;

     nConta2 = nConta2 + 1;
     aAlfa   = nConta1 + "," + nConta2 + ":Configuraci¢n gesti¢n expedientes {{Expediente}}";
     |HAZ CargaArbol;

     nConta2 = nConta2 + 1;
     aAlfa   = nConta1 + "," + nConta2 + ":Password entrada expedientes cerrados {{ExpedCerrado}}";
     |HAZ CargaArbol;

     nConta2 = nConta2 + 1;
     aAlfa   = nConta1 + "," + nConta2 + ":Password entrada expedientes confidenciales {{ExpedConfidencial}}";
     |HAZ CargaArbol;

     nConta2 = nConta2 + 1;
     aAlfa   = nConta1 + "," + nConta2 + ":Password administrador {{Administrador}}";
     |HAZ CargaArbol;

     |SI #abom0514#1 = "N";
         #abom0514#14 = "N";
         #abom0514#17 = "N";
     |FINSI;

     nConta1 = nConta1 + 1;
     nConta2 = 0;

     aAlfa   = nConta1 + ":Configuraci¢n correo electr¢nico";
     |HAZ CargaArbol;

     nConta2 = nConta2 + 1;
     aAlfa   = nConta1 + "," + nConta2 + ":Configuraci¢n correo electr¢nico {{Correo}}";
     |HAZ CargaArbol;

     |SI #abom0514#14 = "S";  |Y #abom0514#17 = "S";
         nConta2 = nConta2 + 1;
         aAlfa   = nConta1 + "," + nConta2 + ":Configuraci¢n entrada de un correo con referencia del cliente {{Referencia}}";
         |HAZ CargaArbol;

         nConta2 = nConta2 + 1;
         aAlfa   = nConta1 + "," + nConta2 + ":Configuraci¢n entrada de un correo con c¢digo de expediente {{CodExpe}}";
         |HAZ CargaArbol;
     |SINO;
         |SI #abom0514#14 = "S";
             nConta2 = nConta2 + 1;
             aAlfa   = nConta1 + "," + nConta2 + ":Configuraci¢n entrada de un correo con referencia del cliente {{Referencia}}";
             |HAZ CargaArbol;
         |FINSI;

         |SI #abom0514#17 = "S";
             nConta2 = nConta2 + 1;
             aAlfa   = nConta1 + "," + nConta2 + ":Configuraci¢n entrada de un correo con c¢digo de expediente {{CodExpe}}";
             |HAZ CargaArbol;
         |FINSI;
     |FINSI;

     nConta2 = nConta2 + 1;
     aAlfa   = nConta1 + "," + nConta2 + ":Configuraci¢n outlook  {{Outlook}}";
     |HAZ CargaArbol;

     nConta1 = nConta1 + 1;
     nConta2 = 0;

     |SI eaDsOporte ! "N";
         aAlfa   = nConta1 + ":Configuraci¢n entrada de procuradores";
         |HAZ CargaArbol;

         nConta2 = nConta2 + 1;
         aAlfa   = nConta1 + "," + nConta2 + ":Configuraci¢n entrada de procuradores {{Procuradores}}";
         |HAZ CargaArbol;
     |FINSI;

     |XCIERRA nHandle;

     |HAZ TraeTxtComprimido;
     aAlfa = eaRutaDestino + eaFicheroTxt;

     eaAlfa = "TREECTRL,Par metros de la aplicaci¢n {{" + aAlfa + "}}";
     |CONTROL_SIMPLE nPanta, eaAlfa, 0702, 2598, EventoTree;
     nTree = FSalida;

     eaFicheroTxt  = "abxz000301" + Usuario + ".txt";
     aAlfa         = eaRutaDestino + eaFicheroTxt;
     |RFBORRA aAlfa;

     |FIN_CONTROL_WINDOWS nBotonLabel;

     |SI aBusca ! "";
         sT_nID   = nTree;
         sT_nOper = 3;
         sT_aData = "[" + aBusca;
         |ESPECIFICA "COMMANDCONTROL", sTree;
         aRefresca = ":" + FSalida;
     |FINSI;

     sT_nID   = nTree;
     sT_nOper = 2;
     |SI aRefresca = "";
         sT_aData = "1:";
     |SINO;
         sT_aData = aRefresca;
     |FINSI;

     |ESPECIFICA "COMMANDCONTROL", sTree;
     |PULSATECLA;

     |FOCOTECLADO nTree;
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     FSalida = 2799;
|FPRC;

|PROGRAMA;
     |HAZ CompruebaDSOPORTE;

     |ABRET #abom0514;
     |ABRET #abom0508;
     |ABRET #abom0519;
     |ABRET #abom0520;

     |LEE 000#abom0514.p;
     |SI FSalida ! 0;    |DDEFECTO #abom0514;  |FINSI;

     |CLS;
     |CABEZA "Par metros Generales";

     |PINPA #0#abxz0003;
     nPanta = FSalida;

     |HAZ MontaArbol;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nTree;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nTree;

     |CIERRAT #abom0514;
     |CIERRAT #abom0508;
     |CIERRAT #abom0519;
     |CIERRAT #abom0520;
|FPRO;
