|FICHEROS;
     abom0001 #0;             || Entrada de Asuntos
     abom0002 #1;             || Entrada de Documentos
     abom0003 #33,MANTE;      || Entrada de Clientes
     abom0004 #2,MANTE;       || Entrada de Contrarios
     abom0005 #3;             || Entrada de Seguimientos Expedientes
     abom0006 #4,MANTE;       || Agenda
     abom0007 #7;             || Seguimientos
     abom0013 #13;            || Bandeja de Correos Entrantes
     abom0015 #15;            || Bandeja de Correos Enviados
     abom0508 #5;             || Password
     abom0514 #514;           || Correos
     asclient #6;
     abow0002 #99,MANTE;      || Procuradores y Abogados
     abow0022 #98,MANTE;      || Procuradores, Abogados y Corredurias Seguros
     abow0023 #97;            || Pantalla de Fechas
     abow0024 #96;            || Pantalla de Cuantias
     asconcep #21;            || Conceptos
     abom0503 #503;           || Procuradores
     abom0502 #502;           || Abogados

     abom0001@ #999;          ||Para el CARGA_DEF
|FIN;

|VARIABLES;
     aMas = "";
     aParametro = "";
     aComodin = "";
     aSQL = "";
     aUsuario = "";

     nSwAborto       = 0;
     nSwEdita        = 0;
     nCanal          = 0;
     aHora           = "";

     &eaTipoEnvio = "";
     &enNumExp = 0;
     &efFechaMov = @;
     &enCodDestino = 0;
     &enCodDesDos = 0;

     aMensaje = "";
     nSwFecCierre = 0;
     nCont        = 0;
     Handle       = 0;
     nNume1       = 0;
     SwSalir      = 0;
     nUltRegistro = 0;
     nSwOpcion    = 0;
     nCampo       = 0;
     nSwCerrado   = 0;
     nSwTopSecret = 0;
     nModoLineal  = 0;
     nTipoCarpeta = 0;
     nVariable    = 0;
     nSwDentro    = 0;
     nHandle      = 0;
     aRutaAcceso  = "";
     aFicheroActu = "";
     aAbre        = "";

     &nOpcion     = -1;

     aOpcion      = "1";
     aAlfa        = "";
     aNombreMenu  = "";
     aNumero      = "";
     Persona      = "";
     aF2          = "";
     aF3          = "";
     aF4          = "";
     aF5          = "";
     aF6          = "";
     aF7          = "";
     aEsc         = "";
     aTecla       = "";

     nCopia       = 0;
     nCop         = 0;
     nBarra       = 0;
     aBarraMenu   =  "";
     aBase        =  "";
     Direct       =  "";
     Comodin      =  "";
     Cadena       =  "";
     Usr          =  "";

     &nPestanya       = 0;
     &enExped         = 0;           || Variables Externa de un cal a otro.
     &enModo          = 0;
     &enDentro        = 0;
     &enCodExpe       = 0;
     &eaNombreCli     = "";
     &eaNombreAsu     = "";
     &enVersion       = 9;
     &enCodUbica      = 0;
     &efFechaDocu     = @;
     &eaFicheroEdita  = "";
     &eaRutaDocumento = "";
     &eaPiePagina     = "";
     &aCadena         = "";
     &aPassword       = "";
     &que_progra      = "abom0001";
     &enDesdeRenta    = 0;

     &eaNombreList  = "";
     &enCuadroIni   = 0;
     &enCuadroFin   = 0;
     &enCampoAncho  = 0;
     &enModoEdita   = 0;
     &enTotalVaria  = 0;
{100}&epPuntEdita   = "";

     {-1}aUtil  = "";
         aUtil1 = "2400";
         aUtil2 = "1";
         aUtil3 = "EMISIONES : ";
         aUtil4 = "FMCBH";
         aUtil5 = " Ficha ";
         aUtil6 = " Mailing ";
         aUtil7 = " Carpetas ";
         aUtil8 = " cod.de Barras ";
         aUtil9 = " cargar cacHe ";

   nBoton1 = 0;
   nBoton2 = 0;
   nBoton3 = 0;
   nBoton4 = 0;
   nBoton5 = 0;
   nBoton6 = 0;
   nBoton7 = 0;
   nBoton8 = 0;
   nBoton9 = 0;
   nBoton10 = 0;
   nBoton11 = 0;
   nBoton12 = 0;

   OcxHandle = -1;
   ParserOcx  = 0;
   tRetorno  = 0; vRetorno  = 0;
   tPar1 = 1; vPar1 = "";
   tPar2 = 1; vPar2 = "";
   tPar3 = 1; vPar3 = "";
   tPar4 = 1; vPar4 = "";
   tPar5 = 1; vPar5 = "";
   tPar6 = 1; vPar6 = "";
|FIN;

|PROCESO Cont;  |TIPO 7;
     enModo = (FEntrada / 100) ! 0;

     |ESTADO_CONTROL nBoton1,"ENABLE";
     |ESTADO_CONTROL nBoton2,"DISABLE";
     |ESTADO_CONTROL nBoton3,"DISABLE";
     |ESTADO_CONTROL nBoton4,"DISABLE";
     |ESTADO_CONTROL nBoton5,"DISABLE";
     |ESTADO_CONTROL nBoton6,"DISABLE";
     |SI #514#1 = "S";  |ESTADO_CONTROL nBoton7,"DISABLE";  |FINSI;
     |SI #514#2 = "S";  |ESTADO_CONTROL nBoton11,"ENABLE";  |FINSI;

     |SI enModo ! 1;  |ACABA;  |FINSI;


     |SALVA_DATOS #0;
     |LEE 040#0u;
     |SI FSalida ! 0;  #0#0 = 0;  |FINSI;
     nUltRegistro = #0#0 + 1;

     |REPON_DATOS #0;

     |SI aParametro = "ABIERTOS";
          |DBASE aAlfa; |QBF aAlfa;
          aMas = aAlfa + "def/abom0001.mas";
          |CARGA_DEF aMas, abom0001@;
          |SI FSalida ! 0;  |ACABA;  |FINSI;

          |ABRE #abom0001@;
          |LEE 040#abom0001@.u;
          |SI #abom0001@#0 ] nUltRegistro;
               nUltRegistro = #abom0001@#0 + 1;
          |FINSI;

          |CIERRA #abom0001@;
          |DESCARGA_DEF #abom0001@;
     |FINSI;

     #0#0 = nUltRegistro;  |PINTA #0#0;
|FPRC;

|PROCESO NoCodigo;
     |SI #0#0 = 0;  |ERROR;  |FINSI;

     enExped = #0#0;
|FPRC;

|PROCESO Mayus;
     #0Campo = #0Campo > #0Campo;  |PINTA #0Campo;
|FPRC;

|PROCESO Cerrado;
     |SI enModo = 4;  |ACABA;  |FINSI;

     |CONFI "2400NExpediente Cerrado- Desea Modificarlo : ";
     |SI FSalida ! 0;
         |SI aOpcion ! "1";  |PTEC 807;  |FINSI;
         |PTEC 807;
         |ACABA;
     |FINSI;

     |ABRE #5;
     |LEE 040#5p;
     |SI FSalida ! 0;
         |MENAV "2300 Passwords sin configurar, no puedo dejarle pasar.";
         |CIERRA #5;
         |PTEC 807;
     |FINSI;
     |CIERRA #5;

     |PUSHV 0501 2380;
     |D_CUADRO 0760, 1079;
     |BLANCO 0861 0978

     |ATRI R;  |PINTA 0861, "     PASSWORD     ";  |ATRI r;

     E_inf     = "";
     E_sup     = 10;
     aPassword = "";
     aPassword = 0966 ? -1;
     |HAZ PonPassword;

     |POPV;

     |SI aCadena ! #5#1;
         |MENAV "2300 Password Incorrecto. No le puedo dejar pasar.";
         |PTEC 807;
         |ACABA;
     |FINSI;

     nSwCerrado = 1;
|FPRC;

|PROCESO TopSecret;
     nSwTopSecret = 1;
     |SI enModo = 4;  |ACABA;  |FINSI;

     |CONFI "2400NExpediente Confidencial, Desea Modificarlo : ";
     |SI FSalida ! 0;  |PTEC 807;  |ACABA;   |FINSI;

     |ABRE #5;
     |LEE 040#5p;
     |SI FSalida ! 0;
         |MENAV "2300 Passwords sin configurar, no puedo dejarle pasar.";
         |CIERRA #5;
         |PTEC 807;
     |FINSI;
     |CIERRA #5;

     |PUSHV 0501 2380;
     |D_CUADRO 0760, 1079;
     |BLANCO 0861 0978

     |ATRI R;  |PINTA 0861, "     PASSWORD     ";  |ATRI r;

     E_inf     = "";
     E_sup     = 10;
     aPassword = "";
     aPassword = 0966 ? -1;
     |HAZ PonPassword;

     |POPV;

     |SI aCadena ! #5#2;
         |MENAV "2300 Password Incorrecto. No le puedo dejar pasar.";
         |PTEC 807;
         |ACABA;
     |FINSI;

     nSwTopSecret = 0;
|FPRC;

|PROCESO ModoEntrada;  |TIPO 7;
     |SI FEntrada ] 100;
         enModo  = (FEntrada / 100) ! 0;
     |SINO;
         enModo  = FEntrada;
     |FINSI;

     aOpcion = "1";
     |HAZ Opcion1;
|FPRC;

|PROCESO PideFechas;  |TIPO 0;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     |ESTADO_CONTROL nBoton1,"HIDE";
     |ESTADO_CONTROL nBoton2,"HIDE";
     |ESTADO_CONTROL nBoton3,"HIDE";
     |ESTADO_CONTROL nBoton4,"HIDE";
     |ESTADO_CONTROL nBoton5,"HIDE";
     |ESTADO_CONTROL nBoton6,"HIDE";
     |ESTADO_CONTROL nBoton12,"HIDE";
     |SI #514#1 = "S";  |ESTADO_CONTROL nBoton7,"HIDE";  |FINSI;
     |SI #514#2 = "S";  |ESTADO_CONTROL nBoton11,"HIDE";  |FINSI;

     |PUSHV 0501 2380;
     |PINPA #0#97;
     #97#0 = #0#1;
     #97#1 = #0#43;
     #97#2 = #0#44;
     #97#3 = #0#45;
     #97#4 = #0#46;
     #97#5 = #0#47;
     #97#6 = #0#2;
     |PINDA #0#97;
     |ENDATOS #1#97;
     |SI FSalida = 0;
         #0#1  = #97#0;
         #0#43 = #97#1;
         #0#44 = #97#2;
         #0#45 = #97#3;
         #0#46 = #97#4;
         #0#47 = #97#5;
         #0#2  = #97#6;
     |FINSI;
     |POPV;

     |SI #514#1 = "S";  |ESTADO_CONTROL nBoton7,"SHOW";  |FINSI;
     |ESTADO_CONTROL nBoton12,"SHOW";
     |ESTADO_CONTROL nBoton6,"SHOW";
     |ESTADO_CONTROL nBoton5,"SHOW";
     |ESTADO_CONTROL nBoton4,"SHOW";
     |ESTADO_CONTROL nBoton3,"SHOW";
     |ESTADO_CONTROL nBoton2,"SHOW";
     |ESTADO_CONTROL nBoton1,"SHOW";
     |SI #514#2 = "S";  |ESTADO_CONTROL nBoton11,"SHOW";  |FINSI;

     |PINTA #0#1;
     |PINTA #0#2;
|FPRC;

|PROCESO PideCuantias;  |TIPO 0;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     |ESTADO_CONTROL nBoton1,"HIDE";
     |ESTADO_CONTROL nBoton2,"HIDE";
     |ESTADO_CONTROL nBoton3,"HIDE";
     |ESTADO_CONTROL nBoton4,"HIDE";
     |ESTADO_CONTROL nBoton5,"HIDE";
     |ESTADO_CONTROL nBoton6,"HIDE";
     |ESTADO_CONTROL nBoton12,"HIDE";
     |SI #514#1 = "S";  |ESTADO_CONTROL nBoton7,"HIDE";  |FINSI;
     |SI #514#2 = "S";  |ESTADO_CONTROL nBoton11,"HIDE";  |FINSI;

     |PUSHV 0501 2380;
     |PINPA #0#96;
     #96#0 = #0#48;
     #96#1 = #0#49;
     #96#2 = #0#50;
     #96#3 = #0#51;
     #96#4 = #0#12;
     #96#5 = #0#52;
     #96#6 = #0#53;
     |PINDA #0#96;
     |ENDATOS #1#96;
     |SI FSalida = 0;
         #0#48 = #96#0;
         #0#49 = #96#1;
         #0#50 = #96#2;
         #0#51 = #96#3;
         #0#12 = #96#4;
         #0#52 = #96#5;
         #0#53 = #96#6;
     |FINSI;
     |POPV;

     |SI #514#1 = "S";  |ESTADO_CONTROL nBoton7,"SHOW";  |FINSI;
     |ESTADO_CONTROL nBoton12,"SHOW";
     |ESTADO_CONTROL nBoton6,"SHOW";
     |ESTADO_CONTROL nBoton5,"SHOW";
     |ESTADO_CONTROL nBoton4,"SHOW";
     |ESTADO_CONTROL nBoton3,"SHOW";
     |ESTADO_CONTROL nBoton2,"SHOW";
     |ESTADO_CONTROL nBoton1,"SHOW";
     |SI #514#2 = "S";  |ESTADO_CONTROL nBoton11,"SHOW";  |FINSI;

     |PINTA #0#12;
|FPRC;

|PROCESO BuscaCliente;  |TIPO 6;
     |SI #48#3   ! "S";  |ACABA;  |FINSI;

     |ABRE #6;
     #6#0 = #0#3;
     |LEE 040#6=;
     |SI FSalida ! 0;
         |CONFI "0000 El Cliente NO EXISTE desea crearlo.";
         |SI FSalida ! 0;  |CIERRA #6;  |ACABA;  |FINSI;
     |SINO;
         |CIERRA #6;
         |ACABA;
     |FINSI;
     |CIERRA #6;

     enDesdeRenta = #0#3;
     |SUB_EJECUTA ":integral/dsam0000";
|FPRC;

|PROCESO PecadoMortal;  |TIPO 7;
     nSwTopSecret = 0;
     |SI #0#2  ! "01.01.0000";   |Y nSwCerrado = 0;  |HAZ Cerrado;    |FINSI;
     |SI #0#27 = "S";            |HAZ TopSecret;  |FINSI;
|FPRC;

|PROCESO BuscaNombre;
     |PUSHV 0501 2380;
     |D_CUADRO 0725, 1267;
     |BLANCO 0826 1166;
     |ATRI R;  |PINTA 0826, "INTRODUZCA EL NOMBRE DEL CLIENTE A BUSCAR"; |ATRI 0;

     aAlfa      = eaNombreCli;
     E_sup      = "40"
     E_inf      = ""
     eaNombreCli = 0926 ? 1;
     |POPV;

     eaNombreCli = eaNombreCli > eaNombreCli;  |QBF eaNombreCli;

     |SI aAlfa = eaNombreCli;
         enCodExpe   = #0#0;
     |SINO;
         enCodExpe   = 0;
     |FINSI;

     |SUB_EJECUTA "aboz0003";

     |SI #0#0 ! enCodExpe; |Y #0#0 ! 99999999;
         #0#0 = enCodExpe;  |PINTA #0#0;
         |PTEC 802;
     |FINSI;
|FPRC;

|PROCESO BuscaAsunto;
     |PUSHV 0501 2380;
     |D_CUADRO 0701, 1280;
     |BLANCO 0802 1179;
     |ATRI S;  |PINTA 0820, "INTRODUZCA LA DESCRIPCION DEL ASUNTO A BUSCAR"; |ATRI s;

     aAlfa       = eaNombreAsu;
     E_sup       = "78"
     E_inf       = ""
     eaNombreAsu = 0902 ? 1;
     |POPV;

     eaNombreAsu = eaNombreAsu > eaNombreAsu;  |QBF eaNombreAsu;

     |SI aAlfa = eaNombreAsu;
         enCodExpe   = #0#0;
     |SINO;
         enCodExpe   = 0;
     |FINSI;

     |SUB_EJECUTA "aboz0003";

     |SI #0#0 ! enCodExpe; |Y #0#0 ! 99999999;
         #0#0 = enCodExpe;  |PINTA #0#0;
         |PTEC 802;
     |FINSI;

     eaNombreAsu = "";
|FPRC;

|PROCESO BuscaTodo;
     eaNombreCli = "";
     enCodExpe   = #0#0;

     |SUB_EJECUTA "aboz0003";

     |SI #0#0 ! enCodExpe; |Y #0#0 ! 99999999;
         #0#0 = enCodExpe;  |PINTA #0#0;
         |PTEC 802;
     |FINSI;
|FPRC;

|PROCESO BuscaExpe;  |TIPO 0;
     |SI FSalida = 10;  |HAZ BuscaNombre;  |FINSI;
     |SI FSalida = 11;  |HAZ BuscaTodo;    |FINSI;
     |SI FSalida = 12;  |HAZ BuscaAsunto;  |FINSI;
|FPRC;

|PROCESO EditaAsunto;  |TIPO 7;
     |ACABA;

     enTotalVaria  = 3;
     eaNombreList  = "";
     enCuadroIni   = 1002;
     enCuadroFin   = 1279;
     enCampoAncho  = 78;
     enModoEdita   = 0;

     IepPuntEdita  = epPuntEdita1 <-;
     |PARA nVariable = 7;  |SI nVariable [ 9;  |HACIENDO nVariable = nVariable + 1;
          epPuntEdita  = #0nVariable;
          IepPuntEdita = IepPuntEdita + 1;
     |SIGUE;

     |HAZ Edita;

     IepPuntEdita  = epPuntEdita1 <-;
     |PARA nVariable = 7;  |SI nVariable [ 9;  |HACIENDO nVariable = nVariable + 1;
          #0nVariable  = epPuntEdita;             |PINTA #0nVariable
          IepPuntEdita = IepPuntEdita + 1;
     |SIGUE;
|FPRC;

|PROCESO Opcion1;
     nSwOpcion = 1;
     |ESTADO_CONTROL nBoton1,"DISABLE";
     |ESTADO_CONTROL nBoton2,"ENABLE";
     |ESTADO_CONTROL nBoton3,"ENABLE";
     |ESTADO_CONTROL nBoton4,"ENABLE";
     |ESTADO_CONTROL nBoton5,"ENABLE";
     |ESTADO_CONTROL nBoton6,"ENABLE";
     |SI #514#1 = "S";  |ESTADO_CONTROL nBoton7,"ENABLE";  |FINSI;
     |SI #514#2 = "S";  |ESTADO_CONTROL nBoton11,"ENABLE";  |FINSI;

     |PINPA #0#0;

     |PINTA #0#0;   |PINTA #0#1;   |PINTA #0#2;   |PINTA #0#3;
     |PINTA #0#4;   |PINTA #0#5;   |PINTA #0#6;   |PINTA #0#7;
     |PINTA #0#8;   |PINTA #0#9;   |PINTA #0#10;  |PINTA #0#11;
     |PINTA #0#12;  |PINTA #0#13;  |PINTA #0#14;  |PINTA #0#15;
     |PINTA #0#16;  |PINTA #0#17;  |PINTA #0#26;  |PINTA #0#27;
     |PINTA #0#28;  |PINTA #0#29;  |PINTA #0#30;  |PINTA #0#31;
     |PINTA #0#32;  |PINTA #0#33;  |PINTA #0#34;  |PINTA #0#35;
     |PINTA #0#36;  |PINTA #0#37;  |PINTA #0#38;

     ||ARA
/*
     |PINTA #0#54;  |PINTA #0#55;  |PINTA #0#56;  |PINTA #0#57;
     |PINTA #0#18;  |PINTA #0#19;  |PINTA #0#24;  |PINTA #0#25;
     |PINTA #0#58;  |PINTA #0#59;
*/
|FPRC;

|PROCESO EntraDatos99;
  SwSalir = 0;
  |PARA; |SI; |HACIENDO;
     |ET Campo99_0;
         FSalida = 0;
         |ENCAMPO #0#99;
         |SI FSalida = 7;  |SAL;             |FINSI;
         |SI FSalida = 1;  SwSalir = 1;      |FINSI;
         |SI FSalida = 2;  |VETE Campo99_0;  |FINSI;
         |SI FSalida = 10; SwSalir = 1;      |FINSI;
         |SI FSalida = 12; SwSalir = 1;      |FINSI;
         |SI FSalida = 13; SwSalir = 1;      |FINSI;
         |SI FSalida = 14; SwSalir = 1;      |FINSI;
         |SI FSalida = 15; SwSalir = 1;      |FINSI;
         |SI FSalida = 16; SwSalir = 1;      |FINSI;

         |SI SwSalir = 1;  |VETE Iguala99;   |FINSI;

     |ET Campo99_2;
         FSalida = 0;
         |ENCAMPO #2#99;
         |SI FSalida = 7;  |SAL;             |FINSI;
         |SI FSalida = 1;  SwSalir = 1;      |FINSI;
         |SI FSalida = 2;  |VETE Campo99_0;  |FINSI;
         |SI FSalida = 10; SwSalir = 1;      |FINSI;
         |SI FSalida = 12; SwSalir = 1;      |FINSI;
         |SI FSalida = 13; SwSalir = 1;      |FINSI;
         |SI FSalida = 14; SwSalir = 1;      |FINSI;
         |SI FSalida = 15; SwSalir = 1;      |FINSI;
         |SI FSalida = 16; SwSalir = 1;      |FINSI;

         |SI SwSalir = 1;  |VETE Iguala99;   |FINSI;

     |ET Campo99_4;
         FSalida = 0;
         |ENCAMPO #4#99;
         |SI FSalida = 7;  |SAL;             |FINSI;
         |SI FSalida = 1;  SwSalir = 1;      |FINSI;
         |SI FSalida = 2;  |VETE Campo99_2;  |FINSI;
         |SI FSalida = 10; SwSalir = 1;      |FINSI;
         |SI FSalida = 12; SwSalir = 1;      |FINSI;
         |SI FSalida = 13; SwSalir = 1;      |FINSI;
         |SI FSalida = 14; SwSalir = 1;      |FINSI;
         |SI FSalida = 15; SwSalir = 1;      |FINSI;
         |SI FSalida = 16; SwSalir = 1;      |FINSI;

         |SI SwSalir = 1;  |VETE Iguala99;   |FINSI;

     |ET Campo99_6;
         FSalida = 0;
         |ENCAMPO #6#99;
         |SI FSalida = 7;  |SAL;             |FINSI;
         |SI FSalida = 1;  SwSalir = 1;      |FINSI;
         |SI FSalida = 2;  |VETE Campo99_4;  |FINSI;
         |SI FSalida = 10; SwSalir = 1;      |FINSI;
         |SI FSalida = 12; SwSalir = 1;      |FINSI;
         |SI FSalida = 13; SwSalir = 1;      |FINSI;
         |SI FSalida = 14; SwSalir = 1;      |FINSI;
         |SI FSalida = 15; SwSalir = 1;      |FINSI;
         |SI FSalida = 16; SwSalir = 1;      |FINSI;

         |SI SwSalir = 1;  |VETE Iguala99;   |FINSI;

     |ET Iguala99;
         |SI FSalida = 1;  nOpcion = 1;      |FINSI;
         |SI FSalida = 7;  nOpcion = 1;      |FINSI;
         |SI FSalida = 10; nOpcion = 1;      |FINSI;
         |SI FSalida = 12; nOpcion = 3;      |FINSI;
         |SI FSalida = 13; nOpcion = 4;      |FINSI;
         |SI FSalida = 14; nOpcion = 5;      |FINSI;
         |SI FSalida = 15; nOpcion = 6;      |FINSI;
         |SI FSalida = 16; nOpcion = 7;      |FINSI;

         |LIBERA #0;
         |LEE 101#0=;
         #0#18 = #99#0;  #0#19 = #99#1;
         #0#20 = #99#2;  #0#21 = #99#3;
         #0#22 = #99#4;  #0#23 = #99#5;
         #0#24 = #99#6;  #0#25 = #99#7;

         |HAZ Telefonos;

         |GRABA 020#0a;
         |SI SwSalir = 1;  |SAL;     |FINSI;
   |SIGUE;
|FPRC;

|PROCESO EntraDatos98;
  SwSalir = 0;
  |PARA; |SI; |HACIENDO;
     |ET Campo98_0;
         FSalida = 0;
         |ENCAMPO #0#98;
         |SI FSalida = 7;  |SAL;             |FINSI;
         |SI FSalida = 1;  SwSalir = 1;      |FINSI;
         |SI FSalida = 2;  |VETE Campo98_0;  |FINSI;
         |SI FSalida = 10; SwSalir = 1;      |FINSI;
         |SI FSalida = 12; SwSalir = 1;      |FINSI;
         |SI FSalida = 13; SwSalir = 1;      |FINSI;
         |SI FSalida = 14; SwSalir = 1;      |FINSI;
         |SI FSalida = 15; SwSalir = 1;      |FINSI;
         |SI FSalida = 16; SwSalir = 1;      |FINSI;

         |SI SwSalir = 1;  |VETE Iguala98;   |FINSI;

     |ET Campo98_2;
         FSalida = 0;
         |ENCAMPO #2#98;
         |SI FSalida = 7;  |SAL;             |FINSI;
         |SI FSalida = 1;  SwSalir = 1;      |FINSI;
         |SI FSalida = 2;  |VETE Campo98_0;  |FINSI;
         |SI FSalida = 10; SwSalir = 1;      |FINSI;
         |SI FSalida = 12; SwSalir = 1;      |FINSI;
         |SI FSalida = 13; SwSalir = 1;      |FINSI;
         |SI FSalida = 14; SwSalir = 1;      |FINSI;
         |SI FSalida = 15; SwSalir = 1;      |FINSI;
         |SI FSalida = 16; SwSalir = 1;      |FINSI;

         |SI SwSalir = 1;  |VETE Iguala98;   |FINSI;

     |ET Campo98_4;
         FSalida = 0;
         |ENCAMPO #4#98;
         |SI FSalida = 7;  |SAL;             |FINSI;
         |SI FSalida = 1;  SwSalir = 1;      |FINSI;
         |SI FSalida = 2;  |VETE Campo98_2;  |FINSI;
         |SI FSalida = 10; SwSalir = 1;      |FINSI;
         |SI FSalida = 12; SwSalir = 1;      |FINSI;
         |SI FSalida = 13; SwSalir = 1;      |FINSI;
         |SI FSalida = 14; SwSalir = 1;      |FINSI;
         |SI FSalida = 15; SwSalir = 1;      |FINSI;
         |SI FSalida = 16; SwSalir = 1;      |FINSI;

         |SI SwSalir = 1;  |VETE Iguala98;   |FINSI;

     |ET Campo98_6;
         FSalida = 0;
         |ENCAMPO #6#98;
         |SI FSalida = 7;  |SAL;             |FINSI;
         |SI FSalida = 1;  SwSalir = 1;      |FINSI;
         |SI FSalida = 2;  |VETE Campo98_4;  |FINSI;
         |SI FSalida = 10; SwSalir = 1;      |FINSI;
         |SI FSalida = 12; SwSalir = 1;      |FINSI;
         |SI FSalida = 13; SwSalir = 1;      |FINSI;
         |SI FSalida = 14; SwSalir = 1;      |FINSI;
         |SI FSalida = 15; SwSalir = 1;      |FINSI;
         |SI FSalida = 16; SwSalir = 1;      |FINSI;

         |SI SwSalir = 1;  |VETE Iguala98;   |FINSI;

     |ET Campo98_8;
         FSalida = 0;
         |ENCAMPO #8#98;
         |SI FSalida = 7;  |SAL;             |FINSI;
         |SI FSalida = 1;  SwSalir = 1;      |FINSI;
         |SI FSalida = 2;  |VETE Campo98_6;  |FINSI;
         |SI FSalida = 10; SwSalir = 1;      |FINSI;
         |SI FSalida = 12; SwSalir = 1;      |FINSI;
         |SI FSalida = 13; SwSalir = 1;      |FINSI;
         |SI FSalida = 14; SwSalir = 1;      |FINSI;
         |SI FSalida = 15; SwSalir = 1;      |FINSI;
         |SI FSalida = 16; SwSalir = 1;      |FINSI;

         |SI SwSalir = 1;  |VETE Iguala98;   |FINSI;

     |ET Campo98_10;
         FSalida = 0;
         |ENCAMPO #10#98;
         |SI FSalida = 7;  |SAL;             |FINSI;
         |SI FSalida = 1;  SwSalir = 1;      |FINSI;
         |SI FSalida = 2;  |VETE Campo98_8;  |FINSI;
         |SI FSalida = 10; SwSalir = 1;      |FINSI;
         |SI FSalida = 12; SwSalir = 1;      |FINSI;
         |SI FSalida = 13; SwSalir = 1;      |FINSI;
         |SI FSalida = 14; SwSalir = 1;      |FINSI;
         |SI FSalida = 15; SwSalir = 1;      |FINSI;
         |SI FSalida = 16; SwSalir = 1;      |FINSI;

         |SI SwSalir = 1;  |VETE Iguala98;   |FINSI;

     |ET Iguala98;
         |SI FSalida = 1;  nOpcion = 1;      |FINSI;
         |SI FSalida = 7;  nOpcion = 1;      |FINSI;
         |SI FSalida = 10; nOpcion = 1;      |FINSI;
         |SI FSalida = 12; nOpcion = 3;      |FINSI;
         |SI FSalida = 13; nOpcion = 4;      |FINSI;
         |SI FSalida = 14; nOpcion = 5;      |FINSI;
         |SI FSalida = 15; nOpcion = 6;      |FINSI;
         |SI FSalida = 16; nOpcion = 7;      |FINSI;

         |LIBERA #0;
         |LEE 101#0=;
         #0#18 = #98#0;  #0#19 = #98#1;
         #0#20 = #98#2;  #0#21 = #98#3;
         #0#22 = #98#4;  #0#23 = #98#5;
         #0#24 = #98#6;  #0#25 = #98#7;
         #0#39 = #98#8;  #0#40 = #98#9;
         #0#41 = #98#10; #0#42 = #98#11;
         |HAZ Telefonos;
         |GRABA 020#0a;
         |SI SwSalir = 1;  |SAL;     |FINSI;
   |SIGUE;
|FPRC;

|PROCESO Opcion2;
     nSwOpcion = 2;
     |ESTADO_CONTROL nBoton1,"ENABLE";
     |ESTADO_CONTROL nBoton2,"DISABLE";
     |ESTADO_CONTROL nBoton3,"ENABLE";
     |ESTADO_CONTROL nBoton4,"ENABLE";
     |ESTADO_CONTROL nBoton5,"ENABLE";
     |ESTADO_CONTROL nBoton6,"ENABLE";
     |ESTADO_CONTROL nBoton12,"HIDE";
     |SI #514#1 = "S";  |ESTADO_CONTROL nBoton7,"ENABLE";  |FINSI;
     |SI #514#2 = "S";  |ESTADO_CONTROL nBoton11,"DISABLE";  |FINSI;

     |SI nSwTopSecret = 1; |ACABA; |FINSI;

     |SI #514#18 = "N";
         |PINPA #0#99;
         #99#0 = #0#18;  #99#1 = #0#19;
         #99#2 = #0#20;  #99#3 = #0#21;
         #99#4 = #0#22;  #99#5 = #0#23;
         #99#6 = #0#24;  #99#7 = #0#25;

         |PINDA #0#99;
         |SI enModo ! 4;  |HAZ EntraDatos99; |FINSI;
     |SINO;
         |PINPA #0#98;
         #98#0  = #0#18;  #98#1  = #0#19;
         #98#2  = #0#20;  #98#3  = #0#21;
         #98#4  = #0#22;  #98#5  = #0#23;
         #98#6  = #0#24;  #98#7  = #0#25;
         #98#8  = #0#39;  #98#9  = #0#40;
         #98#10 = #0#41;  #98#11 = #0#42;

         |PINDA #0#98;
         |SI enModo ! 4;  |HAZ EntraDatos98; |FINSI;
     |FINSI;

     |SI enModo = 4;
        aEsc   = &255 + "806";
        aF2    = &255 + "824";
        aF3    = &255 + "825";
        aF4    = &255 + "826";
        aF5    = &255 + "827";
        aF6    = &255 + "828";
        aF7    = &255 + "829";

        |SI #514#18 = "N";
            #99#0 = #0#18;  #99#1 = #0#19;
            #99#2 = #0#20;  #99#3 = #0#21;
            #99#4 = #0#22;  #99#5 = #0#23;
            #99#6 = #0#24;  #99#7 = #0#25;
            |PINDA #0#99;
        |SINO;
            #98#0  = #0#18;  #98#1  = #0#19;
            #98#2  = #0#20;  #98#3  = #0#21;
            #98#4  = #0#22;  #98#5  = #0#23;
            #98#6  = #0#24;  #98#7  = #0#25;
            #98#8  = #0#39;  #98#9  = #0#40;
            #98#10 = #0#41;  #98#11 = #0#42;
        |FINSI;
        |LEETECLA aTecla;
        aTecla = aTecla > aTecla;

        |SI aTecla = aEsc;   nOpcion = 1;  |FINSI;
        |SI aTecla = aF2;    nOpcion = 1;  |FINSI;
        |SI aTecla = aF3;    nOpcion = 2;  |FINSI;
        |SI aTecla = aF4;    nOpcion = 3;  |FINSI;
        |SI aTecla = aF5;    nOpcion = 4;  |FINSI;
        |SI aTecla = aF6;    nOpcion = 5;  |FINSI;
        |SI aTecla = aF7;    nOpcion = 6;  |FINSI;
     |FINSI;

     SwSalir = 0;
     |ESTADO_CONTROL nBoton12,"SHOW";
|FPRC;

|RUTINA ClaveBaja2;
     #2#0 = #0#0;
     #2#1 = 1;
|FRUT;

|RUTINA ClaveAlta2;
     #2#0 = #0#0;
     #2#1 = 999999;
|FRUT;

|RUTINA ClaveBaja33;
     #33#0 = #0#0;
     #33#1 = 1;
|FRUT;

|RUTINA ClaveAlta33;
     #33#0 = #0#0;
     #33#1 = 99999;
|FRUT;

|PROCESO Contrarios;
     |ESTADO_CONTROL nBoton8,  "HIDE";
     |ESTADO_CONTROL nBoton9,  "HIDE";
     |ESTADO_CONTROL nBoton10, "HIDE";

     |PUSHV 0501 2380;
     |ENTLINEAL #1#2, -2, enModo, 22, 1, ClaveBaja2, ClaveAlta2;
     |POPV;

     |ESTADO_CONTROL nBoton8,  "SHOW";
     |ESTADO_CONTROL nBoton9,  "SHOW";
     |ESTADO_CONTROL nBoton10, "SHOW";
|FPRC;

|PROCESO Clientes;
     |ESTADO_CONTROL nBoton8,  "HIDE";
     |ESTADO_CONTROL nBoton9,  "HIDE";
     |ESTADO_CONTROL nBoton10, "HIDE";

     |PUSHV 0501 2380;
     |ENTLINEAL #1#33, -2, enModo, 22, 1, ClaveBaja33, ClaveAlta33;
     |POPV;

     |ESTADO_CONTROL nBoton8,  "SHOW";
     |ESTADO_CONTROL nBoton9,  "SHOW";
     |ESTADO_CONTROL nBoton10, "SHOW";
|FPRC;

|PROCESO TambienClientes;
     |ESTADO_CONTROL nBoton1,"HIDE";
     |ESTADO_CONTROL nBoton2,"HIDE";
     |ESTADO_CONTROL nBoton3,"HIDE";
     |ESTADO_CONTROL nBoton4,"HIDE";
     |ESTADO_CONTROL nBoton5,"HIDE";
     |ESTADO_CONTROL nBoton6,"HIDE";
     |ESTADO_CONTROL nBoton12,"HIDE";
     |SI #514#1 = "S";  |ESTADO_CONTROL nBoton7,"HIDE";  |FINSI;
     |SI #514#2 = "S";  |ESTADO_CONTROL nBoton11,"HIDE";  |FINSI;

     |BLANCO 1502 2379;
     |CONTROL_SIMPLE 0,"LBOTON, F2  Entrada de Contrarios      ", 1620, 1751, Opc8;  nBoton8  = FSalida;
     |CONTROL_SIMPLE 0,"LBOTON, F3  Entrada de Clientes        ", 1820, 1951, Opc9;  nBoton9  = FSalida;
     |CONTROL_SIMPLE 0,"LBOTON, Esc Salir                      ", 2020, 2151, Opc10; nBoton10 = FSalida;

     aEsc    = &255 + "806";
     aF2     = &255 + "824";
     aF3     = &255 + "825";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aEsc; |SAL;  |FINSI;

         aTecla = aTecla > aTecla;
         |SI aTecla = aF2;  |HAZ Contrarios;   |FINSI;
         |SI aTecla = aF3;  |HAZ Clientes;     |FINSI;
         |SI aTecla = aEsc; |SAL;              |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton8;
     |FIN_CONTROL_WINDOWS nBoton9;
     |FIN_CONTROL_WINDOWS nBoton10;

     |SI #514#1 = "S";  |ESTADO_CONTROL nBoton7,"SHOW";  |FINSI;
     |ESTADO_CONTROL nBoton12,"SHOW";
     |ESTADO_CONTROL nBoton6,"SHOW";
     |ESTADO_CONTROL nBoton5,"SHOW";
     |ESTADO_CONTROL nBoton4,"SHOW";
     |ESTADO_CONTROL nBoton3,"SHOW";
     |ESTADO_CONTROL nBoton2,"SHOW";
     |ESTADO_CONTROL nBoton1,"SHOW";
     |SI #514#2 = "S";  |ESTADO_CONTROL nBoton11,"SHOW";  |FINSI;
|FPRC;

|PROCESO Opcion3;
     |SI nSwTopSecret = 1; |ACABA; |FINSI;
     nSwOpcion = 3;

     nOpcion = 1;

     |SI #514#13 = "S";
         |HAZ TambienClientes;
         |ACABA;
     |FINSI;

     |ESTADO_CONTROL nBoton1,"ENABLE";
     |ESTADO_CONTROL nBoton2,"ENABLE";
     |ESTADO_CONTROL nBoton3,"DISABLE";
     |ESTADO_CONTROL nBoton4,"ENABLE";
     |ESTADO_CONTROL nBoton5,"ENABLE";
     |ESTADO_CONTROL nBoton6,"ENABLE";
     |ESTADO_CONTROL nBoton12,"HIDE";
     |SI #514#1 = "S";  |ESTADO_CONTROL nBoton7,"ENABLE";  |FINSI;
     |SI #514#2 = "S";  |ESTADO_CONTROL nBoton11,"DISABLE";  |FINSI;

     nOpcion    = 1;
     |PUSHV 0501 2380;
     |ENTLINEAL #1#2, -2, enModo, 22, 1, ClaveBaja2, ClaveAlta2;
     |POPV;

     |ESTADO_CONTROL nBoton3,"ENABLE";
     |ESTADO_CONTROL nBoton12,"SHOW";
|FPRC;

|RUTINA ClaveBaja3;
     #3#0 = #0#0;
     #3#1 = 1;
|FRUT;

|RUTINA ClaveAlta3;
     #3#0 = #0#0;
     #3#1 = 999;
|FRUT;

|PROCESO CalcuM0005;
     #21#0 = #3#5;
     #21#1 = #3#6;
     |LEE 040#21=;
     |SI FSalida ! 0;  |DDEFECTO #21;  |FINSI;

     |SI #21#3 = "H";  |O #21#3 = "S";
         #0#33 = #0#33 + #3#18;
         |SI #3#19 = "S";
             #0#31 = #0#31 + #3#24;
         |FINSI;
         |SI #3#20 = "S";
             #0#10 = #0#10 + #3#25;
             #0#36 = #0#36 + #3#26;
         |FINSI;

         #0#11 = #0#31 - (#0#10 + #0#36);
         #0#32 = #0#10 - #0#33;
     |FINSI;

     |SI #21#3 = "A";
         |SI #3#20 ! "S";
             #0#37 = #0#37 + #3#18;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE abom0005G;
     #3#1;
     ;
     #0#0, 000;
     #0#0, 999;
     ;
     NULL, CalcuM0005;
|FIN;

|PROCESO Opcion4;
     |SI nSwTopSecret = 1; |ACABA; |FINSI;
     nSwOpcion = 4;

     |ESTADO_CONTROL nBoton1,"HIDE";
     |ESTADO_CONTROL nBoton2,"HIDE";
     |ESTADO_CONTROL nBoton3,"HIDE";
     |ESTADO_CONTROL nBoton4,"HIDE";
     |ESTADO_CONTROL nBoton5,"HIDE";
     |ESTADO_CONTROL nBoton6,"HIDE";
     |ESTADO_CONTROL nBoton12,"HIDE";
     |SI #514#1 = "S";  |ESTADO_CONTROL nBoton7,"HIDE";  |FINSI;
     |SI #514#2 = "S";  |ESTADO_CONTROL nBoton11,"HIDE";  |FINSI;

     |C_P #0#4, 1, 2127;
     |C_P #0#0, 1, 2172;
     |C_P #0#7, 1, 2202;
     |C_P #0#8, 1, 2302;

     nModoLineal = enModo;
     |SI nModoLineal ! 4;  nModoLineal = 1;  |FINSI;
     |PINPA #0#3;

     |PINTA #0#0; |PINTA #0#4;
     |PINTA #0#7; |PINTA #0#8;

     nOpcion    = 1;
     |PUSHV 0501 2380;
     |ENTLINEAL #1#3, -2, nModoLineal, 19, 0, ClaveBaja3, ClaveAlta3;
     |POPV;

     |LIBERA #0;
     |LEE 101#0=;

     #0#10 = 0;
     #0#31 = 0;
     #0#32 = 0;
     #0#33 = 0;
     #0#36 = 0;
     #0#37 = 0;

     |ABRE #21;
     |BUCLE abom0005G;
     |CIERRA #21;

     |SI #514#19 = "S";
         #0#33 = #0#33 - #0#37;
         #0#32 = #0#10 - #0#33;
     |FINSI;

     |GRABA 020#0a;

     |PINTA #0#32;
     |PINTA #0#33;
     |PINTA #0#37;

     |C_P #0#4, 1, 0725;
     |C_P #0#0, 1, 0618;
     |C_P #0#7, 1, 1002;
     |C_P #0#8, 1, 1102;

     |SI #514#1 = "S";  |ESTADO_CONTROL nBoton7,"SHOW";  |FINSI;
     |ESTADO_CONTROL nBoton12,"SHOW";
     |ESTADO_CONTROL nBoton6,"SHOW";
     |ESTADO_CONTROL nBoton5,"SHOW";
     |ESTADO_CONTROL nBoton4,"SHOW";
     |ESTADO_CONTROL nBoton3,"SHOW";
     |ESTADO_CONTROL nBoton2,"SHOW";
     |ESTADO_CONTROL nBoton1,"SHOW";
     |SI #514#2 = "S";  |ESTADO_CONTROL nBoton11,"SHOW";  |FINSI;
|FPRC;

|RUTINA ClaveBaja4;
     |SI FSalida = "POSICION";
         #4#0  = #0#0;
         #4#1  = ~;
         #4#2  = 00;
         #4#3  = 00;
         #4#18 = 00;
         |ACABA;
     |FINSI;

     #4#0  = #0#0;
     #4#1  = "01.01.0000";
     #4#2  = 00;
     #4#3  = 00;
     #4#18 = 00;
|FRUT;

|RUTINA ClaveAlta4;
     #4#0  = #0#0;
     #4#1  = "31.12.2999";
     #4#2  = 23;
     #4#3  = 59;
     #4#18 = 59;
|FRUT;

|PROCESO Opcion5;
     |SI nSwTopSecret = 1; |ACABA; |FINSI;
     nSwOpcion = 5;

     |ESTADO_CONTROL nBoton1,"ENABLE";
     |ESTADO_CONTROL nBoton2,"ENABLE";
     |ESTADO_CONTROL nBoton3,"ENABLE";
     |ESTADO_CONTROL nBoton4,"ENABLE";
     |ESTADO_CONTROL nBoton5,"DISABLE";
     |ESTADO_CONTROL nBoton6,"ENABLE";
     |ESTADO_CONTROL nBoton12,"HIDE";
     |SI #514#1 = "S";  |ESTADO_CONTROL nBoton7,"ENABLE";  |FINSI;
     |SI #514#2 = "S";  |ESTADO_CONTROL nBoton11,"DISABLE";  |FINSI;

     |PUSHV 0501 2380;

     nOpcion    = 1;
     |ENTLINEAL #1#4, -2, enModo, 22, 1, ClaveBaja4, ClaveAlta4;

     |HAZ Outlook;

     |POPV;

     |ESTADO_CONTROL nBoton5,"ENABLE";
     |ESTADO_CONTROL nBoton12,"SHOW";
|FPRC;

|PROCESO Opcion6;
     |SI nSwTopSecret = 1; |ACABA; |FINSI;
     nSwOpcion = 6;

     |ESTADO_CONTROL nBoton1,"HIDE";
     |ESTADO_CONTROL nBoton2,"HIDE";
     |ESTADO_CONTROL nBoton3,"HIDE";
     |ESTADO_CONTROL nBoton4,"HIDE";
     |ESTADO_CONTROL nBoton5,"HIDE";
     |ESTADO_CONTROL nBoton6,"HIDE";
     |ESTADO_CONTROL nBoton12,"HIDE";
     |SI #514#1 = "S";  |ESTADO_CONTROL nBoton7,"HIDE";  |FINSI;
     |SI #514#2 = "S";  |ESTADO_CONTROL nBoton11,"HIDE";  |FINSI;

     nOpcion    = 1;
     enExped    = #0#0;
     |SUB_EJECUTA "abom0002";

     |SI #514#1 = "S";  |ESTADO_CONTROL nBoton7,"SHOW";  |FINSI;
     |ESTADO_CONTROL nBoton12,"SHOW";
     |ESTADO_CONTROL nBoton6,"SHOW";
     |ESTADO_CONTROL nBoton5,"SHOW";
     |ESTADO_CONTROL nBoton4,"SHOW";
     |ESTADO_CONTROL nBoton3,"SHOW";
     |ESTADO_CONTROL nBoton2,"SHOW";
     |ESTADO_CONTROL nBoton1,"SHOW";
     |SI #514#2 = "S";  |ESTADO_CONTROL nBoton11,"SHOW";  |FINSI;
|FPRC;

|PROCESO Opc8;
     |PTEC 824;
|FPRC;

|PROCESO Opc9;
     |PTEC 825;
|FPRC;

|PROCESO Opc10;
     |PTEC 806;
|FPRC;

|PROCESO Entrantes;
     |ESTADO_CONTROL nBoton8,  "HIDE";
     |ESTADO_CONTROL nBoton9,  "HIDE";
     |ESTADO_CONTROL nBoton10, "HIDE";

     enExped    = #0#0;
     |SUB_EJECUTA_NP "abom0013";

     |ESTADO_CONTROL nBoton8,  "SHOW";
     |ESTADO_CONTROL nBoton9,  "SHOW";
     |ESTADO_CONTROL nBoton10, "SHOW";
|FPRC;

|PROCESO Salientes;
     |ESTADO_CONTROL nBoton8,  "HIDE";
     |ESTADO_CONTROL nBoton9,  "HIDE";
     |ESTADO_CONTROL nBoton10, "HIDE";

     enExped    = #0#0;
     |SUB_EJECUTA_NP "abom0015";

     |ESTADO_CONTROL nBoton8,  "SHOW";
     |ESTADO_CONTROL nBoton9,  "SHOW";
     |ESTADO_CONTROL nBoton10, "SHOW";
|FPRC;

|PROCESO Opcion7;
     |SI nSwTopSecret = 1; |ACABA; |FINSI;
     nSwOpcion = 7;

     |ESTADO_CONTROL nBoton1,"HIDE";
     |ESTADO_CONTROL nBoton2,"HIDE";
     |ESTADO_CONTROL nBoton3,"HIDE";
     |ESTADO_CONTROL nBoton4,"HIDE";
     |ESTADO_CONTROL nBoton5,"HIDE";
     |ESTADO_CONTROL nBoton6,"HIDE";
     |ESTADO_CONTROL nBoton12,"HIDE";
     |SI #514#1 = "S";  |ESTADO_CONTROL nBoton7,"HIDE";  |FINSI;
     |SI #514#2 = "S";  |ESTADO_CONTROL nBoton11,"HIDE";  |FINSI;

     |BLANCO 1502 2379;
     |CONTROL_SIMPLE 0,"LBOTON, F2  Bandeja de Correos Entrantes", 1620, 1751, Opc8;  nBoton8  = FSalida;
     |CONTROL_SIMPLE 0,"LBOTON, F3  Bandeja de Correos Enviados ", 1820, 1951, Opc9;  nBoton9  = FSalida;
     |CONTROL_SIMPLE 0,"LBOTON, Esc Salir                       ", 2020, 2151, Opc10; nBoton10 = FSalida;

     nOpcion = 1;
     aEsc    = &255 + "806";
     aF2     = &255 + "824";
     aF3     = &255 + "825";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aEsc; |SAL;  |FINSI;

         aTecla = aTecla > aTecla;
         |SI aTecla = aF2;  |HAZ Entrantes;   |FINSI;
         |SI aTecla = aF3;  |HAZ Salientes;   |FINSI;
         |SI aTecla = aEsc; |SAL;             |FINSI;

         |LIBERA #0;
         |LEE 101#0=;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton8;
     |FIN_CONTROL_WINDOWS nBoton9;
     |FIN_CONTROL_WINDOWS nBoton10;

     |SI #514#1 = "S";  |ESTADO_CONTROL nBoton7,"SHOW";  |FINSI;
     |ESTADO_CONTROL nBoton12,"SHOW";
     |ESTADO_CONTROL nBoton6,"SHOW";
     |ESTADO_CONTROL nBoton5,"SHOW";
     |ESTADO_CONTROL nBoton4,"SHOW";
     |ESTADO_CONTROL nBoton3,"SHOW";
     |ESTADO_CONTROL nBoton2,"SHOW";
     |ESTADO_CONTROL nBoton1,"SHOW";
     |SI #514#2 = "S";  |ESTADO_CONTROL nBoton11,"SHOW";  |FINSI;
|FPRC;

|PROCESO Tipo13;  |TIPO 13;
     |SI #0#0 = 0;  |ACABA;  |FINSI;

     |ESTADO_CONTROL nBoton1,"DISABLE";
     |ESTADO_CONTROL nBoton2,"ENABLE";
     |ESTADO_CONTROL nBoton3,"ENABLE";
     |ESTADO_CONTROL nBoton4,"ENABLE";
     |ESTADO_CONTROL nBoton5,"ENABLE";
     |ESTADO_CONTROL nBoton6,"ENABLE";
     |SI #514#1 = "S";  |ESTADO_CONTROL nBoton7,"ENABLE";  |FINSI;
     |SI #514#1 = "S";  |ESTADO_CONTROL nBoton11,"ENABLE";  |FINSI;

     nOpcion = 1;
     enModo  = 4;
     |HAZ PecadoMortal;

     |PARA nCampo = 1;  |SI nCampo ] 27;  |HACIENDO nCampo = nCampo + 1;
           |PINTA #0nCampo;
     |SIGUE;

     enExped = #0#0;

     |HAZ Telefonos;
     |HAZ FecUltMov;
|FPRC;

|PROCESO Tipo12;  |TIPO 12;
     enExped    = #0#0;
     nSwCerrado = 0;
|FPRC;

|PROCESO BorraM0002;
     FEntrada = 301;
     |BORRA 020#1a;
     |LIBERA #1;

     efFechaDocu      = #1#4;
     enCodUbica       = #1#10;  |HAZ LeeUbicaciones;
     eaFicheroEdita   = #1#3;   |QBF eaFicheroEdita;
     aFicheroActu     = eaRutaDocumento + "/" + eaFicheroEdita;

     |SI #514#21 ! "C";
         |RFBORRA aFicheroActu;
     |SINO;
         |FBORRA aFicheroActu;
     |FINSI;
|FPRC;

|DEFBUCLE abom0002B;
     #1#1;
     ;
     #0#0, 00000;
     #0#0, 99999;
     be;
     NULL, BorraM0002;
|FIN;

|PROCESO BorraM0003;
     |BORRA 020#33a;
     |LIBERA #33;
|FPRC;

|DEFBUCLE abom0003B;
     #33#1;
     ;
     #0#0, 00000;
     #0#0, 99999;
     be;
     NULL, BorraM0003;
|FIN;

|PROCESO BorraM0004;
     |BORRA 020#2a;
     |LIBERA #2;
|FPRC;

|DEFBUCLE abom0004B;
     #2#1;
     ;
     #0#0, 000000;
     #0#0, 999999;
     be;
     NULL, BorraM0004;
|FIN;

|PROCESO BorraM0005;
     |BORRA 020#3a;
     |LIBERA #3;
|FPRC;

|DEFBUCLE abom0005B;
     #3#1;
     ;
     #0#0, 000;
     #0#0, 999;
     be;
     NULL, BorraM0005;
|FIN;

|PROCESO BorraM0006;
     |BORRA 020#4a;
     |LIBERA #4;
|FPRC;

|DEFBUCLE abom0006B;
     #4#1;
     ;
     #0#0, "01.01.0000", 00, 00, 00;
     #0#0, "31.12.9999", 99, 99, 99;
     be;
     NULL, BorraM0006;
|FIN;

|PROCESO BorraM0007;
     |BORRA 020#7a;
     |LIBERA #7;
|FPRC;

|DEFBUCLE abom0007B;
     #7#1;
     ;
     #0#0, 000, 00;
     #0#0, 999, 99;
     be;
     NULL, BorraM0007;
|FIN;

|PROCESO BorraM0013;
     FEntrada = 301;
     |BORRA 020#13a;
     |LIBERA #13;

     efFechaDocu  = #13#6;
     enCodUbica   = #514#9;  |HAZ LeeUbicaciones;

     aFicheroActu = eaRutaDocumento + "/" + (("00000000" + #13#0) % -108) + (("0000" + #13#1) % -104) + ".eml";
     |SI #514#21 ! "C";
         |RFBORRA aFicheroActu;
     |SINO;
         |FBORRA aFicheroActu;
     |FINSI;
|FPRC;

|DEFBUCLE abom0013B;
     #13#1;
     ;
     #0#0, 0000;
     #0#0, 9999;
     be;
     NULL, BorraM0013;
|FIN;

|PROCESO BorraM0015;
     FEntrada = 301;
     |BORRA 020#15a;
     |LIBERA #15;

     efFechaDocu = #15#7;
     enCodUbica  = #514#9;  |HAZ LeeUbicaciones;
     aAlfa       = eaRutaDocumento + "/" + (("00000000" + #15#0) % -108) + (("0000" + #15#1) % -104) + ".txt";
     |SI #514#21 ! "C";
         |RFBORRA aAlfa;
     |SINO;
         |FBORRA aAlfa;
     |FINSI;
|FPRC;

|DEFBUCLE abom0015B;
     #15#1;
     ;
     #0#0, 0000;
     #0#0, 9999;
     be;
     NULL, BorraM0015;
|FIN;

|PROCESO Tipo2M0001;  |TIPO 2;
     |SI FEntrada ] 100;
         enModo  = (FEntrada / 100) ! 0;
     |SINO;
         enModo  = FEntrada;
     |FINSI;

     |SI enModo ! 3;  |ACABA;  |FINSI;

     |BUCLE abom0002B;
     |BUCLE abom0003B;
     |BUCLE abom0004B;
     |BUCLE abom0005B;
     |BUCLE abom0006B;
     |BUCLE abom0007B;
     |BUCLE abom0013B;
     |BUCLE abom0015B;
|FPRC;

|PROCESO Tipo20;  |TIPO 20;
     aAlfa = FSalida;

     |SI aAlfa = "OPCION";
         FSalida = " EMISIONES";
         |ACABA;
     |FINSI;

     |LEE 000#0=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     enExped = #0#0;

     |SI #514#21 = "C";  |Y #514#23 = "S";
         aUtil4 = "FMCBH";
     |SINO;
         aUtil4 = "FMCB";
     |FINSI;

     |MENU aUtil;
     aUtil2 = FSalida;
     |SI aUtil2 = "1";  |SUB_EJECUTA "aboy0001"; |FINSI;
     |SI aUtil2 = "2";  |SUB_EJECUTA "aboy0004"; |FINSI;

     |SI aUtil2 = "3";
         nTipoCarpeta = #0#34;
         |SI #0#2 ! "01.01.0000";  nTipoCarpeta = 3;  |FINSI;
         aAlfa = "aboy0004;CARPETA" + nTipoCarpeta;
         |SUB_EJECUTA aAlfa;
     |FINSI;

     |SI aUtil2 = "4";
         |PUSHV 0501 2380;
         |BLANCO 1925 2250;
         |CUADRO 1925 2250;
         |PINTA 2026, "Numero de Copias : ";

         E_inf = 1;
         E_sup = 99;
         nCopia = 1;
         nCopia = 2045 ? 1;

         |POPV;

         aBase = "\BARRAS\";
         aAbre = aBase + "BARRAS.TXT";
         |XABRE "CW", aAbre, nHandle;
         |SI FSalida < 0;  |ACABA;  |FINSI;

         nBarra = #0#38;
         |PARA nCop = 1;  |SI nCop [ nCopia;  |HACIENDO nCop = nCop + 1;
               aAlfa = (("000000000000" + nBarra) % -112) + "#" + " " + &13 + &10;
               |XGRABA nHandle, aAlfa;
         |SIGUE;

         |XCIERRA nHandle;

         aAbre = aBase + "IMPRIME.BAT";
         |XABRE "CW", aAbre, nHandle;
         |SI FSalida < 0;  |ACABA;  |FINSI;

         aAlfa = "CD \" + &13 + &10;
         |XGRABA nHandle, aAlfa;

         aAlfa = "CD BARRAS" + &13 + &10;
         |XGRABA nHandle, aAlfa;

         aAlfa = aBase + "barcods0 " + "BARRAS.TXT";
         |XGRABA nHandle, aAlfa;

         |XCIERRA nHandle;

         aAlfa = "\BARRAS\IMPRIME.BAT";

         |RSYSTEM aAlfa;
         |RFBORRA aAbre;
     |FINSI;

     |SI aUtil2 = "5";
         |SUB_EJECUTA "aboz0015";
     |FINSI;
|FPRC;

|PROCESO Tipo8m01; |TIPO 8;
     |ABRE #514;
     |LEE 040#514p;
     |SI FSalida ! 0;  |DDEFECTO #514;  |FINSI;
     |CIERRA #514;

     |SI #514#1 = "S";
         |CONTROL_SIMPLE 0,"BOTON, F2 D.Generales ",  1302,1414,Opc1;
         nBoton1 = FSalida;

         |SI #514#18 = "S";
             |CONTROL_SIMPLE 0,"BOTON,F3 Letrados / Agente",  1315,1424,Opc2;
             nBoton2 = FSalida;
         |SINO;
             |CONTROL_SIMPLE 0,"BOTON, F3 Letrados ",     1315,1424,Opc2;
             nBoton2 = FSalida;
         |FINSI;

         |SI #514#13 = "S";
             |CONTROL_SIMPLE 0,"BOTON, F4 Clientes y Contrarios ",   1325,1436,Opc3;
             nBoton3 = FSalida;
         |SINO;
             |CONTROL_SIMPLE 0,"BOTON, F4 Contrarios ",   1325,1436,Opc3; nBoton3 = FSalida;
         |FINSI;
         |CONTROL_SIMPLE 0,"BOTON, F5 Seguimientos ", 1337,1450,Opc4; nBoton4 = FSalida;
         |CONTROL_SIMPLE 0,"BOTON, F6 Agenda ",       1351,1458,Opc5; nBoton5 = FSalida;
         |CONTROL_SIMPLE 0,"BOTON, F7 Documentos ",   1359,1470,Opc6; nBoton6 = FSalida;
         |CONTROL_SIMPLE 0,"BOTON, F8 Correos ",      1371,1479,Opc7; nBoton7 = FSalida;

     |SINO;
         |CONTROL_SIMPLE 0,"BOTON, F2 D.Generales ",  1303,1414,Opc1; nBoton1 = FSalida;
         |SI #514#18 = "S";
             |CONTROL_SIMPLE 0,"BOTON,F3 Letrados / Agente",  1315,1424,Opc2; nBoton2 = FSalida;
         |SINO;
             |CONTROL_SIMPLE 0,"BOTON, F3 Letrados ",     1316,1424,Opc2; nBoton2 = FSalida;
         |FINSI;
         |SI #514#13 = "S";
             |CONTROL_SIMPLE 0,"BOTON, F4 Clientes y Contrarios ",   1328,1439,Opc3; nBoton3 = FSalida;
         |SINO;
             |CONTROL_SIMPLE 0,"BOTON, F4 Contrarios ",   1328,1439,Opc3; nBoton3 = FSalida;
         |FINSI;
         |CONTROL_SIMPLE 0,"BOTON, F5 Seguimientos ", 1341,1454,Opc4; nBoton4 = FSalida;
         |CONTROL_SIMPLE 0,"BOTON, F6 Agenda ",       1356,1463,Opc5; nBoton5 = FSalida;
         |CONTROL_SIMPLE 0,"BOTON, F7 Documentos ",   1365,1476,Opc6; nBoton6 = FSalida;
     |FINSI;

||     |CONTROL_SIMPLE 0,"BOTON, Ficha ", 2037, 2047, Boton12;
||     nBoton12 = FSalida;
|FPRC;

|PROCESO Tipo9;  |TIPO 9;
     |SI #514#1 = "S";  |FIN_CONTROL_WINDOWS nBoton7;  |FINSI;
     |SI #514#2 = "S";  |FIN_CONTROL_WINDOWS nBoton11;  |FINSI;
     |FIN_CONTROL_WINDOWS nBoton12;
     |FIN_CONTROL_WINDOWS nBoton6;
     |FIN_CONTROL_WINDOWS nBoton5;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton1;
     |PULSATECLA;
     ||FIN_CONTROL_WINDOWS nPestanya;
|FPRC;

|PROCESO Opc1;
     nOpcion = 1;
     |PTEC 824;
|FPRC;

|PROCESO Opc2;
     |SI enModo = 4;  |Y nOpcion = 1;
         nOpcion = 2;
         |HAZ CtrlP;
         |ACABA;
     |FINSI;

     nOpcion = 2;
     |PTEC 825;
|FPRC;

|PROCESO Opc3;
     |SI enModo = 4;  |Y nOpcion = 1;
         nOpcion = 3;
         |HAZ CtrlP;
         |ACABA;
     |FINSI;

     nOpcion = 3;
     |PTEC 826;
|FPRC;

|PROCESO Opc4;
     |SI enModo = 4;  |Y nOpcion = 1;
         nOpcion = 4;
         |HAZ CtrlP;
         |ACABA;
     |FINSI;

     nOpcion = 4;
     |PTEC 827;
|FPRC;

|PROCESO Opc5;
     |SI enModo = 4;  |Y nOpcion = 1;
         nOpcion = 5;
         |HAZ CtrlP;
         |ACABA;
     |FINSI;

     nOpcion = 5;
     |PTEC 828;
|FPRC;

|PROCESO Opc6;
     |SI enModo = 4;  |Y nOpcion = 1;
         nOpcion = 6;
         |HAZ CtrlP;
         |ACABA;
     |FINSI;

     nOpcion = 6;
     |PTEC 829;
|FPRC;

|PROCESO Opc7;
     |SI enModo = 4;  |Y nOpcion = 1;
         nOpcion = 7;
         |HAZ CtrlP;
         |ACABA;
     |FINSI;

     nOpcion = 7;
     |PTEC 830;
|FPRC;

|PROCESO Boton12;        ||Ficha
     |SI #abom0001#0 ! 0;

          |ABRE #1;
          |DDEFECTO #1;
          #1#0 = #abom0001#0;
          #1#1 = 1;
          |LEE 000#1=;
          |SI FSalida ! 0;
               aMensaje = "0000No existe Ficha. Documento 0001";
               |MENAV aMensaje;
               |ACABA;
          |FINSI;
          |CIERRA #1;
     ||ARA
          aAlfa       = #1#3;  |QBF aAlfa;
          |SI aAlfa   = "";
               aMensaje = "0000No existe Nombre de Fichero. Documento 0001";
               |MENAV aMensaje;
               |ACABA;
          |FINSI;

          efFechaDocu    = #1#4;
          enCodUbica     = #1#10;  |HAZ LeeUbicaciones;
          eaFicheroEdita = #1#3;   |QBF eaFicheroEdita;
          aFicheroActu   = eaRutaDocumento + "/" + eaFicheroEdita;

          nSwAborto = 0;
          nSwEdita  = 0;
          Pos       = -1;

          |SI #514#21 ! "C";
              |XABRE "EC", aFicheroActu, nCanal;
          |SINO;
              |XABRE "E", aFicheroActu, nCanal;
          |FINSI;

          |SI FSalida < 0;
               |MENAV "0000 No encuentro el documento en el directorio origen";
               |ACABA;
          |FINSI;

          |SI nSwEdita = 0;
              |QBF aFicheroActu;
              efFechaDocu    = #1#4;
              enCodUbica     = #1#10;  |HAZ LeeUbicaciones;
              eaFicheroEdita = #1#3;   |QBF eaFicheroEdita;
              |HAZ AbreDocumento;
          |FINSI;

          |ABRE #1;
          |LEE 101#1=;
          |SI FSalida ! 0;  |ACABA;  |FINSI;

          |HORA aHora;
          aAlfa = aHora % 102;  #1#8 = aAlfa;
          aAlfa = aHora % 402;  #1#9 = aAlfa;
                                #1#7 = ~;
          |GRABA 120#1a;
          |CIERRA #1;

          |HAZ FecUltMov;

/*
          #abom0001#55 = #1#7;
          #abom0001#56 = #1#8;
          #abom0001#57 = #1#9;
          |PINTA #abom0001#55;
          |PINTA #abom0001#56;
          |PINTA #abom0001#57;
*/
     |FINSI;
|FPRC;

|PROCESO Tipo66C1Fm3; |TIPO 66;
|FPRC;

|PROCESO Tipo6C1Fm3; |TIPO 6;
|FPRC;

|PROCESO Tipo66C1Fm4; |TIPO 66;
|FPRC;

|PROCESO Tipo6C1Fm4; |TIPO 6;
|FPRC;

|PROCESO MiraTeclam04; |TIPO 11;
   |SI FSalida ] 10; |Y FSalida [ 15;
       |ERROR;
       |PTEC 807;
       |SI FSalida = 10; nOpcion = 1; |FINSI;
       |SI FSalida = 11; nOpcion = 2; |FINSI;
       |SI FSalida = 12; nOpcion = 3; |FINSI;
       |SI FSalida = 13; nOpcion = 4; |FINSI;
       |SI FSalida = 14; nOpcion = 5; |FINSI;
       |SI FSalida = 15; nOpcion = 6; |FINSI;
       |SI FSalida = 16; nOpcion = 7; |FINSI;
   |FINSI;
|FPRC;

|PROCESO CierraExp; |TIPO 0;
     |SI #abom0001#2 ! Contenido;
          nSwFecCierre = 1;
     |FINSI;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |SI FSalida = 1;         ||ACEPTAR
          |SI nSwFecCierre = 1;
               aAlfa = #abom0001#2;
               |QBF aAlfa;
               |SI aAlfa ! "01.01.0000";
                    efFechaMov = #abom0001#2;
                    enNumExp = #abom0001#0;
                    enCodDestino = #abom0001#5;
                    enCodDesDos = #abom0001#28;
                    eaTipoEnvio = "CIERRE";
                    |HAZ EnviaAlarma;
               |FINSI;
          |FINSI;
     |SINO;                   ||CANCELAR
          nSwFecCierre = 0;
     |FINSI;
|FPRC;

|PROCESO FecUltMov;
     |ABRE #1;
     |DDEFECTO #1;
     #1#0 = #abom0001#0;
     #1#1 = 1;
     |LEE 000#1=;
     |SI FSalida = 0;
          #abom0001#55 = #1#7;
          #abom0001#56 = #1#8;
          #abom0001#57 = #1#9;
||          |PINTA #abom0001#55;
||          |PINTA #abom0001#56;
||          |PINTA #abom0001#57;
     |FINSI;
     |CIERRA #1;
|FPRC;

|PROCESO Telefonos;
     |HAZ ActTelPro;
     |HAZ ActTelLet;
|FPRC;

|PROCESO ActTelPro; |TIPO 0;
     |ABRE #503;
     |DDEFECTO #503;
     #503#0 = #abom0001#18;
     |LEE 000#503=;
     #abom0001#58 = #503#10;
     |CIERRA #503;
|FPRC;

|PROCESO ActTelLet; |TIPO 0;
     |ABRE #502;
     |DDEFECTO #502;
     #502#0 = #abom0001#24;
     |LEE 000#502=;
     #abom0001#59 = #502#10;
     |CIERRA #502;
|FPRC;


|PROCESO CtrlP;
     |PUSHV 0501 2380;

     |SI FSalida = 10;  nOpcion = 1;  |FINSI;
     |SI FSalida = 11;  nOpcion = 2;  |FINSI;
     |SI FSalida = 12;  nOpcion = 3;  |FINSI;
     |SI FSalida = 13;  nOpcion = 4;  |FINSI;
     |SI FSalida = 14;  nOpcion = 5;  |FINSI;
     |SI FSalida = 15;  nOpcion = 6;  |FINSI;
     |SI FSalida = 16;  nOpcion = 7;  |FINSI;

     |SI nOpcion ] 2;  |Y enModo ! 4;
         |SALVA_DATOS #0;
         |LIBERA #0;
         |LEE 101#0=;
         |SI FSalida ! 0;
             |REPON_DATOS #0;
             |GRABA 020#0n;
         |SINO;
             |REPON_DATOS #0;
             |GRABA 020#0a;
         |FINSI;

         |ESTADO_CONTROL nBoton1, "ENABLE";
     |SINO;
         |ESTADO_CONTROL nBoton1, "DISABLE";
     |FINSI;

     |SI nOpcion = 0;  nOpcion = 1;  |FINSI;

     nSwDentro = 0;
     |SI nOpcion ] 2;
        nSwDentro = 1;
     |FINSI;

     |PARA;  |SI nOpcion ] 2;  |HACIENDO;
          |SI nOpcion = 2;  |HAZ Opcion2;  |FINSI;
          |SI nOpcion = 3;  |HAZ Opcion3;  |FINSI;
          |SI nOpcion = 4;  |HAZ Opcion4;  |FINSI;
          |SI nOpcion = 5;  |HAZ Opcion5;  |FINSI;
          |SI nOpcion = 6;  |HAZ Opcion6;  |FINSI;
          |SI nOpcion = 7;  |HAZ Opcion7;  |FINSI;

          |SI enModo ! 4;
              |LIBERA #0;
              |LEE 101#0=;
          |FINSI;
     |SIGUE;

     |POPV;

     |SI nSwDentro = 1;
         |HAZ Opcion1;
         |SI enModo ! 4;  |PTEC 808; |FINSI;
     |FINSI;

     |ESTADO_CONTROL nBoton1, "DISABLE";
|FPRC;


|PROCESO Tipo80_1; |TIPO 80;
     aParametro = PARAMETRO;
     |QBF aParametro;
     |SI aParametro = "ABIERTOS";
          aUsuario = ("a1" + Usuario + "zzzzzzzz") % 108;
          |QBF aUsuario;

          |ABRE #abom0001;
          aComodin = "2 == " + &34 + "01.01.0000" + &34;
          aSQL = "SELECT * FROM abom0001 INTO " + aUsuario + " WHERE " + aComodin;
          |SQL aSQL;
          |CIERRA #abom0001;

          aComodin = ("a1" + Usuario + "zzzzzzzz") % 108; |NOME_DAT #0 aComodin;
     |FINSI;
|FPRC;

|PROCESO Tipo90_1; |TIPO 90;
     |SI aParametro = "ABIERTOS";
         |DELINDEX #0;
     |FINSI;
|FPRC;

|PROCESO Tipo15; |TIPO 15;
     |SI aParametro = "ABIERTOS";
          |DBASE aAlfa; |QBF aAlfa;
          aMas = aAlfa + "def/abom0001.mas";
          |CARGA_DEF aMas, abom0001@;
          |SI FSalida ! 0;  |ACABA;  |FINSI;

          |ABRE #abom0001@;

          |DDEFECTO #abom0001@;
          #abom0001@#0 = #0#0;
          |LEE 101#abom0001@.=;
          |SI FSalida ! 0; |GRABA 020#abom0001@.b; |FINSI;

          |PARA nCampo = 1; |SI nCampo [ 59; |HACIENDO nCampo = nCampo + 1;
               #abom0001@#nCampo# = #0#nCampo#;
          |SIGUE;

          |GRABA 020#abom0001@.a;
          |LIBERA #abom0001@;

          |CIERRA #abom0001@;
          |DESCARGA_DEF #abom0001@;
     |FINSI;
|FPRC;

|PROCESO Tipo16; |TIPO 16;
     |SI aParametro = "ABIERTOS";
          |DBASE aAlfa; |QBF aAlfa;
          aMas = aAlfa + "def/abom0001.mas";
          |CARGA_DEF aMas, abom0001@;
          |SI FSalida ! 0;  |ACABA;  |FINSI;

          |ABRE #abom0001@;

          |DDEFECTO #abom0001@;
          #abom0001@#0 = #0#0;
          |LEE 101#abom0001@.=;
          |SI FSalida ! 0; |GRABA 020#abom0001@.b; |FINSI;

          |PARA nCampo = 1; |SI nCampo [ 59; |HACIENDO nCampo = nCampo + 1;
               #abom0001@#nCampo# = #0#nCampo#;
          |SIGUE;

          |GRABA 020#abom0001@.a;
          |LIBERA #abom0001@;

          |CIERRA #abom0001@;
          |DESCARGA_DEF #abom0001@;
     |FINSI;
|FPRC;

|PROCESO Tipo17; |TIPO 17;
     |SI aParametro = "ABIERTOS";
          |DBASE aAlfa; |QBF aAlfa;
          aMas = aAlfa + "def/abom0001.mas";
          |CARGA_DEF aMas, abom0001@;
          |SI FSalida ! 0;  |ACABA;  |FINSI;

          |ABRE #abom0001@;

          |DDEFECTO #abom0001@;
          #abom0001@#0 = #0#0;
          |LEE 101#abom0001@.=;
          |SI FSalida = 0;
              |BORRA 020#abom0001@.a;
          |FINSI;
          |LIBERA #abom0001@;

          |CIERRA #abom0001@;
          |DESCARGA_DEF #abom0001@;
     |FINSI;
|FPRC;
