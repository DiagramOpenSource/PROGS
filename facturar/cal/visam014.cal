|FICHEROS;
     visam014 #0;
     visam015 #6,MANTE;       || Matriculas remolques

     visam004 #4;             || Delegaciones Cliente
|FIN;

|VARIABLES;
     aMensaje = "";
     nModo = 0;
     nError = 0;
     aAux = "";

     aAlfa  = "";
     aMarca = "";
|FIN;

|PROCESO Inferior;
     #visam015#0 = #visam014#0;
     #visam015#1 = 0001;
|FPRC;

|PROCESO Superior;
     #visam015#0 = #visam014#0;
     #visam015#1 = 9999;
|FPRC;

|PROCESO Tipo7; |TIPO 7;
     |ENTLINEAL #1#visam015, -2, 7, 21, 0, Inferior, Superior;
|FPRC;

|PROCESO Tipo13; |TIPO 13;
     |ENTLINEAL #1#visam015, -2, 7, 21, 0, Inferior, Superior;
|FPRC;

|PROCESO Tipo12; |TIPO 12;
|FPRC;

|PROCESO Tipo0C3_m014; |TIPO 0;
     |HAZ Lineas;
|FPRC;

|PROCESO LineasDel;
   #visam015#0 = #visam004#0;
   #visam015#1 = #visam004#1;
   |LEE 000#visam015.=;
   |SI FSalida ! 0;
      #visam015#0  = #visam004#0;
      #visam015#1  = #visam004#1;
      #visam015#2  = #visam004#2;
      #visam015#3 = #visam004#14;
      |GRABA 020#visam015.n;
   |SINO;
      |SI #visam004#14 ! #visam015#3;
         #visam004#14 = #visam015#3;
         |GRABA 020#visam004.a;
      |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE LineasDel;
#visam004#1;
;
#visam014#0, 0001;
#visam014#0, 9999;
be;
NULL, LineasDel;
|FIN;

|PROCESO Lineas; |TIPO 3;
     |ABRE #visam015;
     |BUCLE LineasDel;
     |CIERRA #visam015;

     nModo = (FEntrada / 100) ! 0;
     |ENTLINEAL #1#visam015, -2, nModo, 21, 0, Inferior, Superior;
|FPRC;

|PROCESO Tipo7C1_m015; |TIPO 7;
     #visam015#0 = #visam014#0;
     ||PINTA #visam015#0;
|FPRC;

|PROCESO Baja004;
     #visam004#0 = #0#0;
     #visam004#1 = 0001;
|FPRC;

|PROCESO Alta004;
     #visam004#0 = #0#0;
     #visam004#1 = 9999;
|FPRC;

|PROCESO MarcaTodos;
     #visam015#3 = aMarca;
     |GRABA 020#visam015.a;

     #visam004#0 = #visam015#0;
     #visam004#1 = #visam015#1;
     |LEE 101#visam004.=;
     |SI FSalida = 0;
        #visam004#14 = #visam015#3;
        |GRABA 020#visam004.a; |LIBERA #visam004;
     |FINSI;
|FPRC;

|DEFBUCLE MarcaTodos;
#visam015#1;
;
#visam014#0, 0001;
#visam014#0, 9999;
be;
NULL, MarcaTodos;
|FIN;

|PROCESO Tipo11C1_m015; |TIPO 11;
   |SI FSalida = 10; || Marca / Desmarca
      |SI #visam015#3 = "S";
         #visam015#3 = "N";
      |SINO;
         #visam015#3 = "S";
      |FINSI;
      |GRABA 020#visam015.a;
      |PTEC 808; |PONCONTROL 23,"si";
      #visam004#0 = #visam015#0;
      #visam004#1 = #visam015#1;
      |LEE 101#visam004.=;
      |SI FSalida = 0;
         #visam004#14 = #visam015#3;
         |GRABA 020#visam004.a; |LIBERA #visam004;
      |FINSI;
   |FINSI;

   |SI FSalida = 12; || Desmarca todo
      aAlfa = "    NMarcará todos las delegaciones del cliente. " + &191 + " Continuar ?";
      |CONFI aAlfa;
      |SI FSalida = 0;
         aMarca = "S"; |BUCLE MarcaTodos;
      |FINSI;
      |PTEC 808; |PONCONTROL 23,"si";
   |FINSI;

   |SI FSalida = 13; || Marca todo
      aAlfa = "    NDesmarcará todos las delegaciones del cliente. " + &191 + " Continuar ?";
      |CONFI aAlfa;
      |SI FSalida = 0;
         aMarca = "N"; |BUCLE MarcaTodos;
      |FINSI;
      |PTEC 808; |PONCONTROL 23,"si";
   |FINSI;
|FPRC;

|PROCESO Tipo66_m015; |TIPO 66;
     |CONSULTA_F_CLAVE #1#visam004, Baja004, Alta004;
     |SI FSalida = 0;
          |ERROR;
          #visam015#1 = #visam004#1;
          #visam015#2 = #visam004#2;
          |PINTA #visam015#1;
          |PINTA #visam015#2;
          |PTEC 802;
     |FINSI;
|FPRC;

|PROCESO Tipo0C1_m015; |TIPO 0;
     |DDEFECTO #visam004;
     #visam004#0 = #visam015#0;
     #visam004#1 = #visam015#1;
     |LEE 000#visam004.=;
     |SI FSalida ! 0;
          aAux = ("0000" + #visam015#1) % -104;
          aMensaje = "0000No existe Delegacion [" + aAux + "] para este cliente";
          |MENAV aMensaje;
          |ERROR;
     |SINO;
          #visam015#2 = #visam004#2;  |PINTA #visam015#2;
          #visam015#3 = #visam004#14; |PINTA #visam015#3;
     |FINSI;
|FPRC;

|PROCESO min;
     #0#0 = 00001;
|FPRC;

|PROCESO max;
     #0#0 = 99999;
|FPRC;

|PROGRAMA;
     |CLS;
     |ABRE #0;
     |ABRE #4;
     |ENTLINEAL #1#0, -1, 2, 12, 1, min, max;
     |CIERRA #4;
     |CIERRA #0;
|FPRO;
