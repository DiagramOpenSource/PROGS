|FICHEROS;
     asconcl2 #0,MANTE;
     asclient #1;
     asconcep #2;
     asconlin #7;
|FIN;

|VARIABLES;
      nVariable     = 0;
      nModo         = 0;
      aAlfa         = "";
      nEstado       = 0;

     &enDentro      = 0;
     &eaNombreList  = "";
     &enCuadroIni   = 0;
     &enCuadroFin   = 0;
     &enCampoAncho  = 0;
     &enModoEdita   = 0;
     &enTotalVaria  = 0;
{101}&epPuntEdita   = "";
|FIN;

|PROCESO Cliente; |TIPO 0;
     |ABRE #1;
     |ABRE #2;

     #1#0 = #0#0;
     |LEE 040#1=;
     |SI FSalida = 0;
         #2#0 = #0#1;
         #2#1 = #0#2;
         |LEE 040#2=;
         |SI FSalida = 0;
             |SI #2#3 = "N";
                 |MENAV "    Es una Nota de Expedientes";
                 |ERROR;
             |SINO;
                 |SI #1#22 = 1; #0#10 = #2#4;  #0#5 = #2#5;  |FINSI;
                 |SI #1#22 = 2; #0#10 = #2#8;  #0#5 = #2#9;  |FINSI;
                 |SI #1#22 = 3; #0#10 = #2#10; #0#5 = #2#11; |FINSI;
                 |SI #1#22 = 4; #0#10 = #2#12; #0#5 = #2#13; |FINSI;
                 |SI #1#22 = 5; #0#10 = #2#14; #0#5 = #2#15; |FINSI;
             |FINSI;
         |SINO;
            |MENAV "    No Existe Concepto";
          |FINSI;
     |SINO;
          |MENAV "     No existe Cliente";
     |FINSI;
     |CIERRA #1;
     |CIERRA #2;
|FPRC;

|PROCESO RecogeTexto;  |TIPO 7;
     |PINTA #0#3;
     |PINTA #0#11;

     |ABRE #7;
     #7#0 = 2;
     #7#1 = #0#0;
     #7#2 = #0#1;
     #7#3 = #0#2;
     #7#4 = 1;
     |LEE 040#7=;
     |SI FSalida ! 0;
         |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
               #7#0 = 1;
               #7#1 = 0;
               #7#2 = #0#1;
               #7#3 = #0#2;
               #7#4 = nVariable;
               |LEE 040#7=;
               nEstado = FSalida;
               |SI nEstado ! 0; |Y nVariable [ 3;
                   #7#0 = 1;
                   #7#1 = 0;
                   #7#2 = #0#1;
                   #7#3 = #0#2;
                   #7#4 = nVariable;
                   |SI nVariable = 1; #7#5 = #2#16; |FINSI;
                   |SI nVariable = 2; #7#5 = #2#17; |FINSI;
                   |SI nVariable = 3; #7#5 = #2#18; |FINSI;
                   |GRABA 020#7n;
                   nEstado = 0;
               |FINSI;
               |SI nEstado = 0;
                   #7#0 = 2;
                   #7#1 = #0#0;
                   #7#2 = #0#1;
                   #7#3 = #0#2;
                   #7#4 = nVariable;
                   |GRABA 020#7n;
                   |LIBERA #7;

                   |SI nVariable = 1;  #0#7 = #7#5;  |FINSI;
                   |SI nVariable = 2;  #0#8 = #7#5;  |FINSI;
                   |SI nVariable = 3;  #0#9 = #7#5;  |FINSI;
               |FINSI;

         |SIGUE;
     |FINSI;

     |PINTA #0#7;
     |PINTA #0#8;
     |PINTA #0#9;

     |CIERRA #7;
|FPRC;

|PROCESO EditaTexto2;  |TIPO 7;
     enTotalVaria  = 99;
     eaNombreList  = "";
     enCuadroIni   = 1017;
     enCuadroFin   = 1866;
     enCampoAncho  = 50;
     enModoEdita   = 0;

     |ABRE #7;

     #7#0 = 2;
     #7#1 = #0#0;
     #7#2 = #0#1;
     #7#3 = #0#2;
     #7#4 = 1;
     |LEE 101#7=;
     |SI FSalida ! 0;
         #7#5 = #0#7;
         |GRABA 020#7n;
     |FINSI;
     |LIBERA #7;

     #7#0 = 2;
     #7#1 = #0#0;
     #7#2 = #0#1;
     #7#3 = #0#2;
     #7#4 = 2;
     |LEE 101#7=;
     |SI FSalida ! 0;
         #7#5 = #0#8;
         |GRABA 020#7n;
     |FINSI;
     |LIBERA #7;

     #7#0 = 2;
     #7#1 = #0#0;
     #7#2 = #0#1;
     #7#3 = #0#2;
     #7#4 = 3;
     |LEE 101#7=;
     |SI FSalida ! 0;
         #7#5 = #0#9;
         |GRABA 020#7n;
     |FINSI;
     |LIBERA #7;

     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita  = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           #7#0 = 2;
           #7#1 = #0#0;
           #7#2 = #0#1;
           #7#3 = #0#2;
           #7#4 = nVariable;
           |LEE 101#7=;
           |SI FSalida ! 0;
               epPuntEdita  = "";
           |SINO;
               epPuntEdita  = #7#5;
               |BORRA 020#7a;
           |FINSI;
           |LIBERA #7;
     |SIGUE;

     |PUSHV  0501 2380;
     |CUADRO 0816 2067;
     |BLANCO 0917 1966;
     |ATRI S;  |PINTA 0920, "Introduzca el Texto del Servicio Personalizado";  |ATRI s;

     |HAZ Edita;
     |POPV;

     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           |DDEFECTO #7;
           #7#0 = 2;
           #7#1 = #0#0;
           #7#2 = #0#1;
           #7#3 = #0#2;
           #7#4 = nVariable;
           |LEE 1010#7=;
           |SI FSalida ! 0;  |GRABA 020#7b;  |FINSI;
           #7#5 = epPuntEdita;
           |GRABA 020#7a;
           |LIBERA #7;

           |SI nVariable = 1;  #0#7 = #7#5;  |FINSI;
           |SI nVariable = 2;  #0#8 = #7#5;  |FINSI;
           |SI nVariable = 3;  #0#9 = #7#5;  |FINSI;
     |SIGUE;

     |PARA nVariable = 100;  |SI nVariable ] 1;  |HACIENDO nVariable = nVariable - 1;
           #7#0 = 2;
           #7#1 = #0#0;
           #7#2 = #0#1;
           #7#3 = #0#2;
           #7#4 = nVariable;
           |LEE 101#7=;
           aAlfa = #7#5;  |QBF aAlfa;

           |LIBERA #7;

           |SI aAlfa ! "";  |SAL;  |FINSI;

           |BORRA 020#7a;
     |SIGUE;

     |CIERRA #7;

     |PINTA #0#7;
     |PINTA #0#8;
     |PINTA #0#9;
|FPRC;

|PROCESO BajaTexto2;  |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 3;  |ACABA;  |FINSI;

     |ABRE #7;
     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
          #7#0 = 2;
          #7#1 = #0#0;
          #7#2 = #0#1;
          #7#3 = #0#2;
          #7#4 = nVariable;
          |LEE 101#7=;
          |SI FSalida = 0;
              |BORRA 020#7a;
          |FINSI;
          |LIBERA #7;
     |SIGUE;
     |CIERRA #7;
|FPRC;
