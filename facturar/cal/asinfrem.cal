|FICHEROS;
     asinfrem;
     ascabrem;
     aslinrem;
     asclient;

     &bancosp@ #706;
|FIN;

|VARIABLES;
     informe = "asinfrem";
     men1    = "    NO EXISTE INFORME.";
     men2    = "    NO EXISTE IMPRESORA.";
     &vacio  = "                                        ";
     sw1     = 0;
     sw2     = 0;
     &swlin  = 1;
     &sumcal = 0;
     fFech   = @;
     qFech   = "";
     dFech   = "";
     hFech   = "";
     aAlfa   = "";
     aIban   = "";

     &eaIBANPropio = "";
     &enCodBanco   = 0;
|FIN;

|CALCULO imprelin;
   |DDEFECTO #asclient;
   #asclient#0 = #aslinrem#4;
   |LEE 040#asclient.=;

   aAlfa = #aslinrem#10; |QBF aAlfa;
   |SI aAlfa = "";
       #aslinrem#10 = #asclient#77;
       #aslinrem#11 = #asclient#84;
       #aslinrem#12 = #asclient#76;
       #aslinrem#13 = #asclient#85;
       #aslinrem#14 = #asclient#83;
   |FINSI;

   sumcal = sumcal + #aslinrem#7;
   |PRINT;
|FCAL;

|CALCULO fechafac;

  aIban = #ascabrem#7; |QBF aIban;
  |SI aIban = "";
      enCodBanco = #ascabrem#1;
      |HAZ LeeBancoPropio;
      #ascabrem#7 = eaIBANPropio;
  |FINSI;

  swlin = 1;
  |BUCLELIN 0imprelin#ascabrem;
|FCAL;

|DEFBUCLE cainfrem0;
  #ascabrem#1;
  3,1;
  #asinfrem#0 , #asinfrem#2 , #asinfrem#4;
  #asinfrem#1 , #asinfrem#3 , #asinfrem#5;
  e;
  NULL,fechafac;
|FIN;

|CALCULO impre;|TIPO 3;
  |IMPRE 0;
  |SI FSalida = 0;
      |INFOR informe;
      |SI FSalida = 0;
          |ABRE #ascabrem;
          |ABRE #asclient;
          |BUCLE cainfrem0;
          |CIERRA #asclient;
          |CIERRA #ascabrem;
          |PIEINF;
          |FININF;
      |SINO;
         |MENAV men1;
     |FINSI;
     |FINIMP;
  |SINO;
     |MENAV men2;
  |FINSI;
|FCAL;

|PROCESO sacaano; |TIPO 7;
     fFech = ~;
     qFech = fFech % -104;
     dFech = "01.01." + qFech;
     hFech = "31.12." + qFech;
     #asinfrem#2  = dFech;
     #asinfrem#3  = hFech;
     |PINTA #asinfrem#2;
     |PINTA #asinfrem#3;
|FPRC;
