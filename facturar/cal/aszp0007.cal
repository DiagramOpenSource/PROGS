|FICHEROS;
     aszp0007 #0;             || Este Def
     asconcep #1;             || Conceptos
     asw00013 #99,MANTE;      || Temporal
|FIN;

|VARIABLES;
     Fichero = "";
     Tecla   = 0;
     SwGraba = 0;
     XPara   = 0;
     YPara   = 0;
     ZPara   = 0;
|FIN;

|PROCESO Mayuscula;
  #0Campo = #0Campo > #0Campo;
  |PINTA #0Campo;
|FPRC;

|PROCESO Seleccion;  |TIPO 0;
  |SI #0#0 = "S";
      |PARA XPara = 5; |SI XPara [ 44;  |HACIENDO XPara = XPara + 1;
            |C_M #0XPara, 1, "S";
      |SIGUE;
      |C_M #0#1, 1, "N";  #0#1 = "";          |PINTA #0#1;
      |C_M #0#2, 1, "N";  #0#2 = "";          |PINTA #0#2;
      |C_M #0#3, 1, "N";  #0#3 = "zzzz";      |PINTA #0#3;
      |C_M #0#4, 1, "N";  #0#4 = "zz";        |PINTA #0#4;
  |SINO;
      |PARA XPara = 5; |SI XPara [ 44;  |HACIENDO XPara = XPara + 1;
            |C_M #0XPara, 1, "N";
            #0XPara = "zzzz";  |PINTA #0XPara;
      |SIGUE;
      |C_M #0#1, 1, "S";
      |C_M #0#2, 1, "S";
      |C_M #0#3, 1, "S";
      |C_M #0#4, 1, "S";
  |FINSI;
|FPRC;

|PROCESO GrabaTempo;
  #99#0  = #1#0;
  #99#1  = #1#1;
  #99#2  = #1#2;
  #99#3  = #1#3;
  #99#4  = #1#4;
  #99#6  = #1#8;
  #99#8  = #1#10;
  #99#10 = #1#12;
  #99#12 = #1#14;

  |SI #0#45 = "+";  #99#5  = #99#4  > #0#46;  |FINSI;
  |SI #0#45 = "-";  #99#5  = #99#4  < #0#46;  |FINSI;

  |SI #0#47 = "+";  #99#7  = #99#6  > #0#48;  |FINSI;
  |SI #0#47 = "-";  #99#7  = #99#6  < #0#48;  |FINSI;

  |SI #0#49 = "+";  #99#9  = #99#8  > #0#50;  |FINSI;
  |SI #0#49 = "-";  #99#9  = #99#8  < #0#50;  |FINSI;

  |SI #0#51 = "+";  #99#11 = #99#10 > #0#52;  |FINSI;
  |SI #0#51 = "-";  #99#11 = #99#10 < #0#52;  |FINSI;

  |SI #0#53 = "+";  #99#13 = #99#12 > #0#54;  |FINSI;
  |SI #0#53 = "-";  #99#13 = #99#12 < #0#54;  |FINSI;

  #99#14 = "S";
  |GRABA 140#99n;
  |LIBERA #99;

  SwGraba = 1;
|FPRC;

|DEFBUCLE asconcep;
  #1#1;
  ;
  #0#1, #0#2;
  #0#3, #0#4;
  ;
  NULL, GrabaTempo;
|FIN;

|PROCESO GrabaConcepto;
  #1#0 = #99#0;
  #1#1 = #99#1;
  |LIBERA #1;
  |LEE 140#1=;
  |SI FSalida = 0;
      #1#4  = #99#5;
      #1#8  = #99#7;
      #1#10 = #99#9;
      #1#12 = #99#11;
      #1#14 = #99#13;
      |GRABA 140#1a;
  |FINSI;
|FPRC;

|DEFBUCLE asw00013;
  #99#1;
  14;
  "    ", "  ", "S";
  "zzzz", "zz", "S";
  ;
  NULL, GrabaConcepto;
|FIN;

|RUTINA ClaveBaja;
  #99#0 = "    ";
  #99#1 = "  ";
|FRUT;

|RUTINA ClaveAlta;
  #99#0 = "zzzz";
  #99#1 = "zz";
|FRUT;

|PROCESO Tipo3;  |TIPO 3;
  Fichero = Usuario % 808;  |QBT Fichero;
  Fichero = ("P7" + Fichero + "zzzzzzzz") % 108;
  |NOME_DAT #99 Fichero;
  |ABRE #99;  |CIERRA #99;  |DELINDEX #99;

  |ABRE #99;
  |SI #0#0 = "S";
      |PARA YPara = 5; |SI YPara [ 43;  |HACIENDO YPara = YPara + 2;
            ZPara = YPara + 1;
            |SI #0YPara ! "    "; |O #0ZPara ! "  ";
                #0#1 = #0YPara;
                #0#2 = #0ZPara;
                #0#3 = #0YPara;
                #0#4 = #0ZPara;
                |BUCLE asconcep;
            |FINSI;
       |SIGUE;
  |SINO;
       |BUCLE asconcep;
  |FINSI;
  |CIERRA #99;

  |SI SwGraba = 0;  |DELINDEX #99;  |ACABA;  |FINSI;

  |ENTLINEAL #1#99, 2, 4, 19, 1, ClaveBaja, ClaveAlta;

  |ABRE #1;
  |BUCLE asw00013;
  |CIERRA #1;

  |DELINDEX #99;
|FPRC;

|PROCESO Tipo11;  |TIPO 11;
  |SI FSalida ! 9;  |Y FSalida ! 10;  |ACABA;  |FINSI;

  Tecla = FSalida;

  |LIBERA #99;
  |LEE 140#99=;

  |SI Tecla = 9;
        |SI #99#14 = "N";
            #99#14 = "S";
        |SINO;
            #99#14 = "N";
        |FINSI;
  |FINSI;

  |SI Tecla = 10;
      #99#14 = "S";
      |C_M #99#5,  1, "S";
      |C_M #99#7,  1, "S";
      |C_M #99#9,  1, "S";
      |C_M #99#11, 1, "S";
      |C_M #99#13, 1, "S";

      |ENCAMPO #5#99;
      |ENCAMPO #7#99;
      |ENCAMPO #9#99;
      |ENCAMPO #11#99;
      |ENCAMPO #13#99;
  |FINSI;

  |PINTA #99#5;
  |PINTA #99#7;
  |PINTA #99#9;
  |PINTA #99#11;
  |PINTA #99#13;
  |PINTA #99#14;

  |GRABA 140#99a;

  |C_M #99#7, 1, "N";
|FPRC;
