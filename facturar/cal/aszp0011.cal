|FICHEROS;
     aszp0011 #0;
     ashismic #1;
     ashismil #2;
     ashiscon #3;
     asclient #4;
|FIN;

|VARIABLES;
     nCampo19 = 0;
     nCampo20 = 0;
     nCampo21 = 0;
     nCampo23 = 0;
     nCampo24 = 0;
     nCampo25 = 0;
     nCampo26 = 0;
     nCampo27 = 0;
     nCampo28 = 0;
     nIva     = 0;

     aAlfa    = "";
|FIN;

|CALCULO serieh;
    |SI FSalida = 2; |ACABA; |FINSI;

    |SI #0#1 > #0#2;
        |MENAV "0000Error, Serie hasta menor que Serie desde";
        |ERROR;
    |FINSI;
|FCAL;

|CALCULO facturah;
    |SI FSalida = 2; |ACABA; |FINSI;

    |SI #0#3 > #0#4;
        |MENAV "0000Error, Factura hasta menor que Factura desde";
        |ERROR;
    |FINSI;
|FCAL;

|CALCULO clienteh;
    |SI FSalida = 2; |ACABA; |FINSI;

    |SI #0#5 > #0#6;
        |MENAV "0000Error, Cliente hasta menor que Cliente desde";
        |ERROR;
    |FINSI;
|FCAL;

|CALCULO fechah;
    |SI FSalida = 2; |ACABA; |FINSI;

    |SI #0#7 > #0#8;
        |MENAV "0000Error, Fecha hasta menor que Fecha desde";
        |ERROR;
    |FINSI;
|FCAL;

|PROCESO ashismilB;
     #1#0 = #2#0;
     #1#1 = #2#1;
     |LEE 101#1=;
     |SI FSalida ! 0;
         |BORRA 020#2a;
     |FINSI;
     |LIBERA #2;
|FPRC;

|DEFBUCLE ashismilB;
     #2#1;
     ;
     #0#1, #0#3, 000;
     #0#2, #0#4, 999;
     b;
     NULL, ashismilB;
|FIN;

|PROCESO ashisconCheq;
     #2#0 = #3#0;
     #2#1 = #3#1;
     #2#2 = #3#2;
     |LEE 101#2=;
     |SI FSalida ! 0;
         |DDEFECTO #2;
         #2#0  = #3#0;
         #2#1  = #3#1;
         #2#2  = #3#2;
         #2#3  = #3#3;
         #2#4  = #3#5;
         #2#5  = #3#6;
         #2#6  = #3#7;
         #2#7  = #3#7;
         #2#8  = #3#10;
         #2#9  = #3#11;
         #2#10 = #3#8;
         #2#11 = 1;
         #2#12 = #3#9;
         #2#13 = #3#9;
         #2#14 = "U";
         |GRABA 020#2n;
         |LIBERA #2;
         |ACABA;
     |FINSI;

     |SI #3#9 ! #2#13;
         #2#3  = #3#3;
         #2#4  = #3#5;
         #2#5  = #3#6;
         #2#6  = #3#7;
         #2#7  = #3#7;
         #2#8  = #3#10;
         #2#9  = #3#11;
         #2#10 = #3#8;
         #2#11 = 1;
         #2#12 = #3#9;
         #2#13 = #3#9;
         |GRABA 020#2a;
     |FINSI;
     |LIBERA #2;
|FPRC;

|DEFBUCLE ashisconCheq;
     #3#1;
     ;
     #1#0, #1#1, 000;
     #1#0, #1#1, 999;
     ;
     NULL, ashisconCheq;
|FIN;

|PROCESO ashismilCheq;
     #3#0 = #2#0;
     #3#1 = #2#1;
     #3#2 = #2#2;
     |LEE 101#3=;
     |SI FSalida ! 0;
         |BORRA 020#2a;
         |LIBERA #2;
     |FINSI;
|FPRC;

|DEFBUCLE ashismilCheq;
     #2#1;
     ;
     #1#0, #1#1, 000;
     #1#0, #1#1, 999;
     ;
     NULL, ashismilCheq;
|FIN;

|PROCESO ashismil;
     |SI #2#10 = "H"; #1#19 = #1#19 + #2#13; |FINSI;
     |SI #2#10 = "S"; #1#20 = #1#20 + #2#13; |FINSI;
     |SI #2#10 = "A"; #1#21 = #1#21 + #2#13; |FINSI;

     #1#23 = #1#19 % #2#22;
     #1#24 = #1#19 - #1#23;
     #1#25 = #1#24 % #1#45;
     #1#26 = #1#24 + #1#25 + #1#20;
     |SI #1#14 = "S";
         #1#27 = #1#24 % #1#46;
     |SINO;
         #1#27 = 0;
     |FINSI;
     #1#28 = #1#26 - #1#27 - #1#21;
|FPRC;

|DEFBUCLE ashismil;
     #2#1;
     ;
     #1#0, #1#1, 000;
     #1#0, #1#1, 999;
     ;
     NULL, ashismil;
|FIN;

|PROCESO ashismic;
     |ABRE #2;
     |BUCLE ashisconCheq;
     |CIERRA #2;

     |ABRE #3;
     |BUCLE ashismilCheq;
     |CIERRA #3;

     nCampo19 = #1#19;
     nCampo20 = #1#20;
     nCampo21 = #1#21;
     nCampo23 = #1#23;
     nCampo24 = #1#24;
     nCampo25 = #1#25;
     nCampo26 = #1#26;
     nCampo27 = #1#27;
     nCampo28 = #1#28;

     #1#19 = 0;
     #1#20 = 0;
     #1#21 = 0;
     #1#23 = 0;
     #1#24 = 0;
     #1#25 = 0;
     #1#26 = 0;
     #1#27 = 0;
     #1#28 = 0;

     |BUCLE ashismil;

     |SI nCampo19 ! #1#19;  |O nCampo20 ! #1#20;  |O nCampo21 ! #1#21;
      |O nCampo23 ! #1#23;  |O nCampo24 ! #1#24;  |O nCampo25 ! #1#25;
      |O nCampo26 ! #1#26;  |O nCampo27 ! #1#27;  |O nCampo28 ! #1#28;
         aAlfa = "Revisar Factura: " + #1#0 + " / " + #1#1;
         |IMPRIME aAlfa;

         |GRABA 020#1a;
         |LIBERA #1;
     |FINSI;

     #4#0 = #1#3;
     |LEE 101#4=;
     |SI FSalida = 0;
         #4#24 = #1#28;
         |GRABA 020#4a;
         |LIBERA #4;
     |FINSI;
|FPRC;

|DEFBUCLE ashismic;
     #1#2;
     3;
     #0#7, #0#1, #0#3, #0#5;
     #0#8, #0#2, #0#4, #0#6;
     be;
     NULL, ashismic;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |SI #0#0 ! "SI";  |ACABA;  |FINSI;

     |IMPRE 0;

     |ABRE #1;
     |BUCLE ashismilB;
     |CIERRA #1;

     |ABRE #4;
     |BUCLE ashismic;
     |CIERRA #4;

     |FINIMP;
|FPRC;
