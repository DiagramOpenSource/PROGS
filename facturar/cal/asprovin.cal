|FICHEROS;
     asprovin #0;                           || CALCULO PARA OPCION DE IM-   ;
|FIN;

|VARIABLES;
     informe = "asprovin";                  || CAMBIAR VARIABLE `informe',  ;
     men1 = "    NO EXISTE INFORME.";       || FICHERO Y NOMBRE DE CALCULO. ;
     men2 = "    NO EXISTE IMPRESORA.";
|FIN;

|CALCULO ttprovin;|TIPO 4;
|IMPRE 0;                                   ||Abre impresora.                ;
|SI FSalida = 0;                            ||? existe impresora.            ;
    |INFOR informe;                         ||Abre informe.                  ;
    |SI FSalida = 0;                        ||? existe informe               ;
        |LEE 040#0p;                        ||Lee el primer registro.        ;
        |SI FSalida = 0;
            |PRINT;                         ||Comienza informe.              ;
        |FINSI;
        |ET leer;                           ||Bucle de lectura e impresion.  ;
        |LEE 040#0s;
        |SI FSalida = 0;
            |PRINT;
            |VETE leer;
        |FINSI;                             ||Fin de fichero.                ;
        |PIEINF;                            ||Impresion final.               ;
        |FININF;                            ||Cierra informe.                ;
        |FINIMP;                            ||Cierra impresora.              ;
    |SINO;
        |MENAV men1;                        ||No informe.                    ;
    |FINSI;
|SINO;
    |MENAV men2;                            ||No impresora.                  ;
|FINSI;
|FCAL;
