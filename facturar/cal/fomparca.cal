|FICHEROS;
    fomparca #0;
    fomparli #1;
    fomw0001 #2;

    fomhparc #3;

    fomcontr #10;

    asempres;

    :/laboral/def/labtraba #12;

     &usuarios@ #718;
|FIN;

|VARIABLES;
   &eaCodUsu = "";

   menu_a     = 0;
   cont       = 0;
   path_fich  = "";
   vacio      = "                                        ";
   aAlfa      = "";
   aHora      = "";

  {-1}automat   = ""
      automat1  = "2400";
      automat2  = "1";
      automat3  = "Elija opcion : ";
      automat4  = "AM";
      automat5  = "  Automatico  ";
      automat6  = "  Manual  ";
|FIN;

|PROCESO automat; |TIPO 7;
menu_a = 0;
cont = (FEntrada / 100) ! 0;
|SI cont ! 1; |ACABA; |FINSI;

|MENU automat;
automat2 = FSalida;
|SI FSalida = 1;
    menu_a = 1;
    |ABRE #10;
    |LIBERA #10;
    |LEE 140#10p;
    |SI FSalida = 0;
        #0#0 = #10#1 + 1;
    |SINO;
        #10#0 = 1;
        #10#1 = 0;
        |GRABA 140#10n;
        #0#0 = 1;
    |FINSI;
    |CIERRA #10;
    |PINTA #0#0;
|FINSI;
|FPRC;

|PROCESO graba_con; |TIPO 0;
|ABRE #3;
#3#0 = #0#0;
|LEE 040#3=;
|SI FSalida = 0;
    |MENAV "      El numero de parte ya existe en el historico";
    |ERROR;
    |CIERRA #3;
    |ACABA;
|FINSI;
|CIERRA #3;

|SI menu_a = 0; |ACABA; |FINSI;
menu_a = 0;

|ABRE #10;
|LIBERA #10;
|LEE 140#10p;
|SI FSalida = 0;
    #10#1 = #0#0;
    |GRABA 140#10a;
|FINSI;
|CIERRA #10;
|FPRC;

|PROCESO defFact; |TIPO 7;
    cont = (FEntrada / 100) ! 0;
    |SI cont ! 1; |ACABA; |FINSI;
    |ABRE #asempres;
    |DDEFECTO #asempres;
    |LEE 041#asempres.p;
    |CIERRA #asempres;

    #0#12 = #asempres#14;
    |PINTA #0#12;
|FPRC;


|PROCESO labo_gen; |TIPO 0;
|SI #0#3 = "G";
    |CAMPO_MODIFICA #0#4, 1, "N";
|SINO;
    |CAMPO_MODIFICA #0#4, 1, "S";
|FINSI;

|SI #0#3 = "G"; |ACABA; |FINSI;
|FPRC;

|PROCESO Baja12;
     #labtraba#0 = #fomparca#1;
     #labtraba#1 = 1;
|FPRC;

|PROCESO Alta12;
     #labtraba#0 = #fomparca#1;
     #labtraba#1 = 99999;
|FPRC;


|PROCESO m_trabaj; |TIPO 0;
     |SI #0#3 = "G";
         #0#4 = 0;
         #0#5 = "";
         |PINTA #0#4;
         |PINTA #0#5;
         |ACABA;
     |FINSI;

     |ABRE #12;
     #12#0 = #0#1;
     #12#1 = #0#4;
     |LEE 040#12=;
     |SI FSalida ! 0;
         |MENAV "       No existe TRABAJADOR.";
         |ERROR;
     |SINO;
         #0#5 = #12#2;
         |PINTA #0#5;
     |FINSI;
     |CIERRA #12;
|FPRC;

|PROCESO usuario; |TIPO 0;
     |SI cont ! 1; |ACABA; |FINSI;

     eaCodUsu = Usuario % 810; |QBF eaCodUsu;
     |HAZ LeeUsuario;

     #0#10 = #718#1;   |PINTA #0#10;
|FPRC;

|PROCESO ampliada; |TIPO 7;
|PUSHV 0501 2380;
cont = (FEntrada / 100) ! 0;

|SI cont = 1;
    |SI #1#6 = vacio;
        |SI #0#3 = "L"; #1#6 = #0#5; |FINSI;
    |SINO;
        |SI #1#7 = vacio;
            |SI #0#3 = "L"; #1#7 = #0#5; |FINSI;
        |FINSI;
    |FINSI;
|FINSI;

|PINPA #0#2;
#2#0 = #1#5;
#2#1 = #1#6;
#2#2 = #1#7;
|PINDA #0#2;

|ENDATOS #1#2;
|SI FSalida = 0;
    #1#5 = #2#0;
    #1#6 = #2#1;
    #1#7 = #2#2;
|FINSI;
|POPV;
|FPRC;

|PROCESO Tipo66C4; |TIPO 66;
     |ABRE #labtraba;
     |CONSULTA_F_CLAVE #1#labtraba, Baja12, Alta12;
     |SI FSalida = 0;
         #fomparca#4 = #labtraba#1;  |PINTA #fomparca#4;
         #fomparca#5 = #labtraba#2;  |PINTA #fomparca#5;
     |FINSI;
     |CIERRA #labtraba;
|FPRC;

|PROCESO Tipo0C7;  |TIPO 0;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     |HORA aHora;

     #fomparca#7 = ~;  |PINTA #fomparca#7;

     aAlfa = aHora % 102;  #fomparca#8 = aAlfa;  |PINTA #fomparca#8;
     aAlfa = aHora % 402;  #fomparca#9 = aAlfa;  |PINTA #fomparca#9;
|FPRC;
