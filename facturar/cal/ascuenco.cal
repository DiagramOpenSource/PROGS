|FICHEROS;
    ascuenco #0;
    asconcep #1;

    asempcon #31;

   :/contagen/def/canempre #330;
   :/contagen/def/cacuenta #304;
|FIN;

|VARIABLES;
 nSinConta    = 0;
 nInkey       = 0;
 nSwError     = 0;
 &eaPathContagen = "";
|FIN;

|INCLUYE i_varcof;

|CALCULO Tipo8_cuen; |TIPO 88;

   |ABRE #31;
   |DDEFECTO #31;
   |LEE 001#31p;
   |CIERRA #31;
   nSinConta = 0;

   |HAZ BusquedaApli;
   |SI eaPathContagen ! "";
       enEmpresa  = #31#1;
       enPerConta = #31#2;
       enSwSinMen = 1;
       |HAZ LeeEmpConta;
       |SI swerror = 1;
           |MENAV "     Empresa Contable Mal Informada";
           nSinConta = 1;
       |SINO;
           |PATH_DAT #304 aPathConta;
       |FINSI;
   |SINO;
       nSinConta = 1;
   |FINSI;
|FCAL;
|| ********************************************************

|CALCULO concepto; |TIPO 0;
 |ABRE #1;
 #1#0 = #0#0;
 #1#1 = #0#1;
 |LEE 040#1=;
 |SI FSalida = 0;
     #0#2 = #1#2;
 |SINO;
     |MENAV "    No Existe Conceptos.";
 |FINSI;
 |CIERRA #1;
|FCAL;

|| :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

|RUTINA nInf2;
 |SI FSalida = "POSICION";
     #304#0 = #0#3;
 |SINO;
     #304#0 = "";
 |FINSI;
 #304#3 = "S";
|FRUT;

|RUTINA nSup2;
 #304#0 = "zzzzzzzzzzz";
 #304#3 = "S";
|FRUT;

|PROCESO LaConsCue;
  |ABRE #304;
  #304#0 = #0#3;
  |CONSULTA_F_CLAVE #6#304, nInf2, nSup2;
  #0#3 = #304#0; |PINTA #0#3;
  |CIERRA #304;
|FPRC;

|CALCULO MiraCuenta; |TIPO 0;
   |SI nSinConta = 1; |ACABA; |FINSI;

   |SI FSalida = 2; |ACABA; |FINSI;
   nInkey = FSalida;

   eaCuenta = #0Campo; |QBF eaCuenta;
   |SI eaCuenta = ""; |Y nInkey ! 10;
       |MENAV "    Introduzca una Cuenta";
       |ERROR;
       |ACABA;
   |FINSI;

   |SI nInkey = 10;  |HAZ LaConsCue; |FINSI;

   |SI #0Campo = "DESGLOSE    ";
       |HAZ ComprobarDes;
       |SI nSwError = 1;
           |ERROR;
       |FINSI;
       |ACABA;
   |FINSI;

   emCta = 0;
   eaCuenta = #0Campo;
   |HAZ LeeCuenta;
   |SI eswCta = 1;
        |ERROR;
        |CONFI "    SError.! No existe Cuenta. Desea darla de alta ";
        |SI FSalida = 0;
            |SUB_EJECUTA_NP "aszc0001";
            #0Campo = eaCuenta;
            |PINTA #0Campo;
        |FINSI;
   |SINO;
        |SI eswCta = 2;
            |MENAV "0000Esta Cuenta NO tiene Pase Directo.";
            |ERROR;
        |FINSI;
   |FINSI;
|FCAL;

|CALCULO Cuenta; |TIPO 6;
     |SI nSinConta = 1; |ACABA; |FINSI;

     emCta = 1;        || Dar mensajes de error
     eaCuenta = #0Campo;
     salidas  = FSalida;
     |HAZ FiltraPuntos;
     #0Campo = eaCuenta;
     |PINTA #0Campo;
     FSalida = salidas;

     |SI eaCuenta = "DESGLOSE    "; |ACABA; |FINSI;
     |HAZ SacaNivel;
|FCAL;

|PROCESO ComprobarDes;
|FPRC;
