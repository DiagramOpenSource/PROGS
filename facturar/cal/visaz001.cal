|FICHEROS;
     visaz001 #0;

     visam001 #1;        ||Expedientes CAB
     visam002 #2;        ||Expedientes LIN
     visam004 #4;
     visam011 #11;       ||Provincias-Etiquetas
     visaz002 #502,MANTE;
     asclient #500;
|FIN;

|VARIABLES;
     nSwPie = 0;
     esc = "";
     para1 = 0;

     aUsuario = "";
     nExiste = 0;
     aMensaje = "";
     aInforme = "";
     nSwPais = 0;
|FIN;

|PROCESO visam002;
     |SI #visam002#4 ] #visaz001#10; |Y #visam002#4 [ #visaz001#11;
          nSwPais = 1;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE visam002;
 #visam002#1;
 ;
 #visam001#0, #visam001#14, 001;
 #visam001#0, #visam001#14, 999;
 ;
 NULL, visam002;
|FIN;

|PROCESO visam001;
     nSwPais = 0;
     |SI #visaz001#10 = "    "; |Y #visaz001#10 = "zzzz";
          nSwPais = 1;
     |SINO;
          |BUCLE visam002;
     |FINSI;


     |SI nSwPais = 1;

          |DDEFECTO #visaz002;
          #visaz002#0 = #visam001#0;
          #visaz002#1 = #visam001#14;
          |LEE 101#visaz002.=;
          |SI FSalida ! 0; |GRABA 020#visaz002.b; |FINSI;

          |SI #visam001#19 = 0;
               #asclient#0 = #visam001#1;
               |LEE 000#asclient.=;
               |SI FSalida = 0;
                    #visaz002#2 = #asclient#1;
                    #visaz002#3 = #asclient#3;
                    #visaz002#4 = #asclient#4;
                    #visaz002#5 = #asclient#5;
                    #visaz002#6 = (("00" + #asclient#4) % -102) + (("000" + #asclient#5) % -103);
                    #visaz002#7 = #asclient#6;
                    #visaz002#8 = #asclient#7;
                    #visaz002#9 = #asclient#9;
                    #visaz002#10 = "S";

                    #visam011#0 = #visaz002#4;
                    |LEE 000#visam011.=;
                    |SI FSalida = 0;
                         #visaz002#11 = #visam011#2;
                    |SINO;
                         #visaz002#11 = #visaz001#9;
                    |FINSI;
                    #visaz002#12 = #visam001#3;
                    #visaz002#13 = #asclient#57;
               |SINO;
                    #visaz002#10 = "N";
                    #visam011#0 = #visaz002#4;
                    |LEE 000#visam011.=;
                    |SI FSalida = 0;
                         #visaz002#11 = #visam011#2;
                    |SINO;
                         #visaz002#11 = #visaz001#9;
                    |FINSI;
               |FINSI;
          |SINO;
               |DDEFECTO #visam004;
               #visam004#0 = #visam001#1;
               #visam004#1 = #visam001#19;
               |LEE 000#visam004.=;
               |SI FSalida = 0;
                    #asclient#0 = #visam001#1;
                    |LEE 000#asclient.=;
                    |SI FSalida = 0;
                         #visaz002#2 = #asclient#1;
                    |FINSI;
                    #visaz002#3 = #visam004#3;
                    #visaz002#4 = #visam004#4;
                    #visaz002#5 = #visam004#5;
                    #visaz002#6 = (("00" + #visam004#4) % -102) + (("000" + #visam004#5) % -103);
                    #visaz002#7 = #visam004#6;
                    #visaz002#8 = #visam004#7;
                    #visaz002#9 = #visam004#8;
                    #visaz002#10 = "S";
                    #visam011#0 = #visaz002#4;
                    |LEE 000#visam011.=;
                    |SI FSalida = 0;
                         #visaz002#11 = #visam011#2;
                    |SINO;
                         #visaz002#11 = #visaz001#9;
                    |FINSI;
                    #visaz002#12 = #visam001#3;
                    #visaz002#13 = #visam004#11;
               |SINO;
                    #visaz002#10 = "N";
                    #visam011#0 = #visaz002#4;
                    |LEE 000#visam011.=;
                    |SI FSalida = 0;
                         #visaz002#11 = #visam011#2;
                    |SINO;
                         #visaz002#11 = #visaz001#9;
                    |FINSI;
               |FINSI;
          |FINSI;

          |GRABA 020#visaz002.a;
          |LIBERA #visaz002;
     |FINSI;
|FPRC;

|DEFBUCLE visam001;
 #visam001#1;
 3,1,20;
 #visaz001#1, #visaz001#3, #visaz001#5, #visaz001#7, #visaz001#12;
 #visaz001#2, #visaz001#4, #visaz001#6, #visaz001#8, #visaz001#13;
 ;
 NULL, visam001;
|FIN;

|PROCESO Principal;
     aUsuario = ("f5" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #502 aUsuario;
     |DELINDEX #502;

     |ABRE #visam011;
     |ABRE #asclient;
     |ABRE #visaz002;
     |ABRE #visam004;
     |BUCLE visam001;
     |CIERRA #visam004;
     |CIERRA #asclient;
     |CIERRA #visam011;

|FPRC;

|PROCESO Imprime;
     |PRINT;
     nSwPie = 1;
|FPRC;

|PROCESO visaz002;
     |SI #visaz002#10 = "S";
          |PARA para1 = 1; |SI para1 [ #visaz002#11; |HACIENDO para1 = para1 + 1;
               |HAZ Imprime;
          |SIGUE;
     |FINSI;
|FPRC;

|DEFBUCLE visaz002;
 #visaz002#1;
 ;
 INICIO;
 FINAL;
 ;
 NULL, visaz002;
|FIN;

|PROCESO mini;
     #502#0 = 00;
     #502#1 = 000000;
|FPRC;

|PROCESO maxi;
     #502#0 = 99;
     #502#1 = 999999;
|FPRC;


|PROGRAMA;
     |CLS;
     |ABRE #0;
     |DDEFECTO #0;
     nExiste = FSalida;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |HAZ Principal;

          |CLS;
          |PINPA #0#502;
          |ENTLINEAL #1#502,-1,2,22,0,mini,maxi;
          |CONFI "2400SImprimir Etiquetas";
          |SI FSalida = 0;
               |CIERRA #visaz002;

               |IMPRE 0;
               |SI FSalida = 0;
                    aInforme = "visaz002";
                    |INFOR aInforme;
                    |SI FSalida = 0;
                         esc = &027 + "027";
                         |BUCLE visaz002;
                         |SI nSwPie = 1;
                              |PIEINF;
                         |FINSI;
                         |FININF;
                    |SINO;
                         aMensaje = "0000Informe " + aInforme + " inaccesible.";
                         |MENAV aMensaje;
                    |FINSI;
                    |FINIMP;
               |SINO;
                    |MENAV "0000Proceso cancelado.";
               |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #0;

     |ABRE #502;  |CIERRA #502;  |DELINDEX #502;
|FPRO;
