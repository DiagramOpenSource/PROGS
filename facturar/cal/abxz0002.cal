|FICHEROS;
     abxz0002 #0;
     abor0001 #1;
|FIN;

|VARIABLES;
     nCampo       = 0;
     nRango       = 0;

     aAlfa        = "";
     aAlfa1       = "";
     aAlfa2       = "";

     &enCodExpe   = 0;
     &enCodPers   = 0;
     &eaNombreCli = "";
     &eaNombreAsu = "";
|FIN;

|PROCESO Tipo12Fxz2;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;
|FPRC;

|PROCESO Tipo0C14Fxz2;  |TIPO 0;
     |SI #0#14 = 0;
         |PARA nCampo = 0;  |SI nCampo [ 11;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
         |C_M #0#14, 1, "N";  #0#14 = 0;  |PINTA #0#14;
     |SINO;
         |PDEFECTO #0, 0, 13;
         |PARA nCampo = 0;  |SI nCampo [ 11;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";    |PINTA #0nCampo;
         |SIGUE;
     |FINSI;

     |SI #0#14 = 0;    |ACABA;  |FINSI;

     |ABRE #1;
     #1#0 = #0#14;
     |LEE 040#1=;
     |SI FSalida ! 0;
         |MENAV "2300 Expediente Inexistente.";
         |ERROR;
     |FINSI;
     |CIERRA #1;
|FPRC;

|PROCESO Evento;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#1=;
         |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |FINSI;

     |SI FSalida = 4;
         enCodExpe = #1#0;
         enCodPers = #1#5;

         |PTEC 806;
     |FINSI;
|FPRC;

|PROCESO Baja3;
     #1#0  = #0#0;
     #1#3  = #0#2;
     #1#15 = #0#6;
     #1#5  = #0#8;
     #1#4  = #0#4;
     #1#6  = #0#10;
|FPRC;

|PROCESO Alta3;
     #1#0  = #0#1;
     #1#3  = #0#3;
     #1#15 = #0#7;
     #1#5  = #0#9;
     #1#4  = #0#5;
     #1#6  = #0#11;
|FPRC;

|RUTINA ClaveBaja3;
     |SI FSalida = "POSICION";  |Y enCodExpe ! 0;
         |ABRE #1;
         |SELECT #1#1;
         #1#0  = enCodExpe;
         |LEE 040#1];
         |SI FSalida = 0;
             aAlfa1 = #1#7;    |QBF aAlfa1;
             aAlfa2 = #0#15;   |QBF aAlfa2;
             aAlfa  = aAlfa1 - aAlfa2;
             |SI aAlfa = aAlfa1;
                 |SELECT #6#1;
                 #1#7 = #0#15;
                 #1#0 = 0;
                 |LEE 040#1];
             |FINSI;
         |FINSI;
         |CIERRA #1;
         |ACABA;
     |FINSI;

     #1#0  = #0#1;
     #1#7  = #0#15;
|FRUT;

|RUTINA ClaveAlta3;
     #1#0  = #0#0;
     #1#7  = #0#16;
|FRUT;

|PROCESO Tipo80Fxz2;  |TIPO 80;
     FSalida = 2699;
|FPRC;

|PROGRAMA;
     |C_M #1#1,  1, "N";
     |C_M #1#3,  1, "N";
     |C_M #1#15, 1, "N";

     |DDEFECTO #0;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #0#14 = 0;
         nRango = 4 + 8 + 16 + 128;
         |ABRE #1;
         |LINEAL_SIMPLE #3#1, nRango, 0502, 1998, Baja3, Alta3, Evento;
         |CIERRA #1;
     |SINO;
        enCodExpe = #0#14;
        enCodPers = #1#5;
     |FINSI;
|FPRO;
