|FICHEROS;
    astecocl #0;
    asconcli #1;
    asconcep #2;
|FIN;

|VARIABLES;
    mensaje = "";
    aviso1 = "     *** ATENCION *** Error al Regrabar  ";
    aviso2 = "     *** ATENCION *** Error al Grabar  ";
    campo = 0;
    FSestado = 0;
|FIN;

|CALCULO proceso;
   #1#0 = #0#0;
   #1#1 = "FISC";
   #1#2 = #0#2;
   |LIBERA #1;
   |LEE 110#1=;
   |SI FSalida = 0;
       |HAZ pasecocl;
       |HAZ paseconc;
       |GRABA 020#1a;
       |LIBERA #1;
       |SI FSalida ! 0;
           mensaje = aviso1 + #1#0;
           |MENAV mensaje;
       |FINSI;
   |SINO;
       |DDEFECTO #1;
       |HAZ pasecocl;
       |HAZ paseconc;
       |GRABA 020#1n;
       |LIBERA #1;
       |SI FSalida ! 0;
           mensaje = aviso2 + #1#0;
           |MENAV mensaje;
       |FINSI;
   |FINSI;
|FCAL;

|CALCULO pasecocl;
    #1#00 = #0#00;
    #1#01 = "FISC";
    #1#02 = #0#02;
    #1#03 = "H";
    #1#04 = #0#01;
    #1#05 = "G";
    #1#06 = #0#03;
    #1#07 = "                                        ";
    #1#08 = "                                        ";
    #1#09 = "                                        ";
    #1#10 = #0#04;
|FCAL;

|CALCULO paseconc;
    #2#00 = "FISC";
    #2#01 = #0#02;
|LEE 040#2=;
|SI FSalida ! 0;
    #2#00 = "FISC";
    #2#01 = #0#02;
    #2#02 = #0#03;
    #2#03 = "H";
    #2#04 = #0#04;
    #2#05 = "G";
    #2#06 = 0;
    #2#07 = 0;
    |GRABA 040#2n;
|FINSI;
|FCAL;

|CALCULO leesec;|TIPO 3;
|ABRET #0;
|ABRET #1;
|ABRET #2;
|LEE 040#0p;
|SI FSalida = 0;
    |ET bucle1;
    |HAZ proceso;
    |LEE 040#0s;
    |SI FSalida = 0;
        |VETE bucle1;
    |FINSI;
|FINSI;
|CIERRAT #0;
|CIERRAT #1;
|CIERRAT #2;
|FCAL;
