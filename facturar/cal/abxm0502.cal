|FICHEROS;
     abxm0502 #502;
     abxm0020 #520;
     abxm0021 #521;
     abom0514 #514;
     abxm0515 #515,MANTE;
|FIN;

|VARIABLES;
     nVariable  = 0;
     nMail      = 0;
     nContenido = 0;
     nSubVent   = 0;

     {-1}aVent      = "";
         aVent1     = 0;
         aVent2     = 0;
         aVent3     = 0;
         aVent4     = 0;
         aVent5     = "";

     aAlfa = "";

     &aNif = "";

     &enCalcCif     = 0;
     &eaVarDni      = "";
|FIN;

|PROCESO Tipo3Fxm502;  |TIPO 3;
     |ABRE #514;
     |LEE 040#514p;
     |SI FSalida ! 0;  |DDEFECTO #514;  |FINSI;
     |CIERRA #514;

     |SI #514#1 ! "S";  |ACABA;  |FINSI;

     |ABRE #515;
     |SELECT #2#515;
     #515#1 = #502#1;
     |LEE 040#515=;
     |SI FSalida = 0;  |CIERRA #515;  |ACABA;  |FINSI;
     |CONFI "     Desea crearlo en la Libreta de Direcciones";
     |SI FSalida ! 0;  |CIERRA #515;  |ACABA;  |FINSI;

     |SELECT #1#515;
     |LEE 040#515u;

     nMail = #515#0 + 1;

     |DDEFECTO #515;
     #515#0 = nMail;
     |GRABA 020#515b;

     #515#1  = #502#1;
     #515#4  = #502#5;
     #515#6  = #502#6;
     #515#7  = #502#7;
     #515#8  = #502#8;
     #515#9  = #502#9;
     #515#10 = "TELEFONO PRINCIPAL";
     #515#11 = #502#10;
     #515#12 = "MOVIL";
     #515#13 = #502#12;
     #515#14 = "FAX";
     #515#15 = #502#11;
     #515#16 = #502#13;
     #515#18 = #502#14;

     |VENTANA 0501, 2799, -1, 16, "Libreta de direcciones";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PINPA #0#515;
     |PINDA #0#515;
     |ENDATOS #1#515;
     |SI FSalida = 0;
         |GRABA 020#515a;
     |SINO;
         |BORRA 020#515a;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO LetraAut502;  |TIPO 6;
     |SI FSalida = 10;
         enCalcCif = 1;
         eaVarDni  =  #502Campo;
         |HAZ CalculoDNI;
         #502Campo = eaVarDni;
         |PINTA #502Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #502Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 112;
     |SI #502Campo ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #502Campo = eaVarDni;  |PINTA #502Campo;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0C6Fxm502;
     nContenido = Contenido;
     |SI #502#6 = nContenido;  |ACABA;  |FINSI;

     |ABRE #520;
     #520#0 = #502#6;
     |LEE 000#520=;
     |SI FSalida ! 0;  |DDEFECTO #520;  |FINSI;
     |CIERRA #520;

     #502#9 = #520#1;  |PINTA #502#9;
|FPRC;

|PROCESO Tipo0C7Fxm502;
     nContenido = Contenido;
     |SI #502#7 = nContenido;  |ACABA;  |FINSI;

     |ABRE #521;
     #521#0 = #502#6;
     #521#1 = #502#7;
     |LEE 000#521=;
     |SI FSalida ! 0;  |DDEFECTO #521;  |FINSI;
     |CIERRA #521;

     #502#8 = #521#3;  |PINTA #502#8;
|FPRC;

|PROCESO Tipo80Fxm502;  |TIPO 80;
     FSalida = 2799;
     |HAZ DesactivaTipo80;
|FPRC;
