|FICHEROS;
     aboz0001 #0;
     asclient #100;
     abom0001 #101;
     abom0004 #104;
     abom0005 #105;
     abom0006 #106;
     abom0007 #107;
     abom0505 #505;
|FIN;

|VARIABLES;
     aAlfa       = "";
     aAlfa1      = "";
     aAlfa2      = "";
     aAlfa3      = "";
     aAlfa4      = "";
     aField      = "";
     aFabre      = "";
     aHandle     = "";
     aCadena     = "";
     aCaracter   = "";
     aPersona    = "";

     nCaracter   = 0;
     nPosi       = 0;
     nNume       = 0;
     nAsunto     = 0;
     nCampo      = 0;
     nLinea      = 0;
     nLinVar     = 0;
     nPersona    = 0;
     nHora       = 0;
     nMinu       = 0;
     nHoraAviso  = 0;
     nMinuAviso  = 0;

     fFecha      = @;
     fFechaHoy   = @;
     fFechaAviso = @;
|FIN;

|PROCESO PasaCliente;
     |ABRE #100;  |CIERRA #100;  |DELINDEX #100;

     |ABRET #100;

     #0#26 = 0;
     Pos   = -1;
     aFabre = "r   " + aAlfa;
     |FABRE aFabre;
     aHandle = FSalida;
     |SI FSalida ] 0;
        |PARA; |SI; |HACIENDO;
               aField = aHandle + " 254";
               |FLEE aField;
               |SI FSalida < 0;   |SAL;  |FINSI;

               aAlfa  = aField % 1605;
               nNume  = aAlfa;
               |SI nNume > 0;  |Y nNume [ 99999;
                                             |DDEFECTO #100;
                                             #100#0 = nNume;
                                             #100#1 = aField % 2235;
                                             #100#2 = #100#1;
                                             #100#3 = aField % 5835;
                   aAlfa  = aField % 9402;   #100#4 = aAlfa;
                   aAlfa  = aField % 9603;   #100#5 = aAlfa;
                                             #100#6 = aField % 10010;
                                             #100#8 = aField % 11112;
                                             #100#9 = aField % 12415;
                                             |GRABA 120#100n;
                                             |LIBERA #100;

                   #0#26 = #0#26 + 1;  |PINTA #0#26;
               |FINSI;
        |SIGUE;
    |FINSI;
    |FCIERRA aHandle;

    |CIERRAT #100;
|FPRC;

|PROCESO PonCliente;
     #101#3 = 0;
     |SELECT #2#100;
     #100#1 = #101#4;
     |LEE 040#100];
     |SI FSalida = 0;
         aAlfa1 = #100#1 % 122;
         aAlfa2 = #101#4 % 122;
         |SI aAlfa1 = aAlfa2;
             #101#3 = #100#0;
             #101#4 = #100#1;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO PasaAsuntos1;
     |ABRE #101;  |CIERRA #101;  |DELINDEX #101;

     |ABRET #101;
     |ABRE  #100;

     #0#26      = 0;
     Pos        = -1;
     aFabre     = "rt  " + aAlfa;
     |FABRE aFabre;
     aHandle = FSalida;
     |SI FSalida ] 0;
        |PARA; |SI; |HACIENDO;
               aField = aHandle + " 250";
               |FLEE aField;
               |SI FSalida < 0;   |SAL;  |FINSI;

               aAlfa  = aField % 4307;
               nNume  = aAlfa;
               |SI nNume > 0;  |Y nNume [ 9999999;
                   |DDEFECTO #101;
                   #101#0 = nNume;
                   #101#4 = aField % 5122;
                   |HAZ PonCliente;

                   aAlfa  = aField % 1802;
                   |SI aAlfa ! "  ";
                       aAlfa1 = aField % 1802;
                       aAlfa2 = aField % 2102;
                       aAlfa3 = aField % 2402;
                       aAlfa  = aAlfa1 + "." + aAlfa2 + ".19" + aAlfa3;
                       #101#1   = aAlfa;
                   |FINSI;

                   aAlfa  = aField % 3102;
                   |SI aAlfa ! "  ";
                       aAlfa1 = aField % 3102;
                       aAlfa2 = aField % 3402;
                       aAlfa3 = aField % 3702;
                       aAlfa  = aAlfa1 + "." + aAlfa2 + ".19" + aAlfa3;
                       #101#2   = aAlfa;
                   |FINSI;

                   |GRABA 120#101n;
                   |LIBERA #101;

                   #0#26 = #0#26 + 1;  |PINTA #0#26;
               |FINSI;
        |SIGUE;
    |FINSI;
    |FCIERRA aHandle;

    |CIERRA  #100;
    |CIERRAT #101;
|FPRC;

|PROCESO GrabaExpe;
     #101#0 = nAsunto;
     |LEE 101#101=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     #101nCampo = aAlfa;

     |SI nCampo = 6;
         |SELECT #2#505;
         #505#1 = #101nCampo;
         |LEE 040#505=;
         |SI FSalida = 0;
             #101#5  = #505#0;
             #101#28 = #505#0;
         |FINSI;
     |FINSI;

     |GRABA 020#101a;
     |LIBERA #101;
|FPRC;

|PROCESO CargaLinea;
     |SI aAlfa = ":";
         |DDEFECTO #105;
         nLinea = nLinea + 1;

         #105#0  = nAsunto;
         #105#1  = nLinea;

         aAlfa = aField % 4602;  #105#2  = aAlfa;

         |SELECT #2#505;
         #505#1 = #105#2;
         |LEE 040#505=;
         |SI FSalida = 0;
             #105#3  = #505#0;
         |FINSI;

         aAlfa  = aField % 3102;
         |SI aAlfa ! "  ";
             aAlfa1 = aField % 3102;
             aAlfa2 = aField % 3402;
             aAlfa3 = aField % 3702;
             aAlfa  = aAlfa1 + "." + aAlfa2 + ".19" + aAlfa3;
             #105#4   = aAlfa;
        |FINSI;

        aAlfa  = aField % 4904;  #105#5 = aAlfa;

        #105#19 = "S";
        #105#20 = "S";

        |GRABA 020#105n;
        |LIBERA #105;

        nLinVar = 0;
     |FINSI;

     #105#0  = nAsunto;
     #105#1  = nLinea;
     |LEE 101#105=;
     nLinVar = nLinVar + 1;
     #107#0 = #105#0;
     #107#1 = #105#1;
     #107#2 = nLinVar;
     aAlfa  = aField % 5543;
     #107#3 = aAlfa;
     |GRABA 020#107n;
     |LIBERA #107;

     |SI nLinVar = 1;  #105#7 = #107#3;  |FINSI;
     |SI nLinVar = 2;  #105#8 = #107#3;  |FINSI;
     |SI nLinVar = 3;  #105#9 = #107#3;  |FINSI;

     |SI nLinVar [ 3;
         |GRABA 020#105a;
         |LIBERA #105;
     |FINSI;
|FPRC;

|PROCESO Seguimientos;
     |ABRE #105;
     |ABRE #107;
     |HAZ CargaLinea;
     |PARA; |SI; |HACIENDO;
            aField = aHandle + " 250";
            |FLEE aField;
            |SI FSalida < 0;   |SAL;  |FINSI;

            aAlfa  = aField % 4201;
            aAlfa1 = &196;
            |SI aAlfa = aAlfa1;
                |SAL;
           |FINSI;
           |HAZ CargaLinea;
     |SIGUE;
     |CIERRA #105;
     |CIERRA #107;
|FPRC;

|PROCESO Contrarios;
     |ABRE #104;
     #104#0 = nAsunto;
     #104#1 = 1;
     #104#2 = aAlfa;
     |GRABA 020#104n;
     |LIBERA #104;
     |CIERRA #104;
|FPRC;

|PROCESO QuitaSignos;
     aCadena = "";
     |PARA nCaracter = 1;  |SI nCaracter [ 13;  |HACIENDO nCaracter = nCaracter + 1;
           nPosi = (nCaracter * 100) + 1;
           aCaracter = aAlfa % nPosi;
           |SI aCaracter = "0";  |O aCaracter = "1";  |O aCaracter = "2";
           |O aCaracter = "3";  |O aCaracter = "4";  |O aCaracter = "5";
           |O aCaracter = "6";  |O aCaracter = "7";  |O aCaracter = "8";
           |O aCaracter = "9";
               aCadena = aCadena + aCaracter;
           |FINSI;
     |SIGUE;
     aAlfa = aCadena;
|FPRC;

|PROCESO PasaAsuntos2;
     |ABRE #104;  |CIERRA #104;  |DELINDEX #104;
     |ABRE #105;  |CIERRA #105;  |DELINDEX #105;
     |ABRE #107;  |CIERRA #107;  |DELINDEX #107;

     |ABRET #101;
     |ABRET #105;
     |ABRET #107;
     |ABRE  #100;
     |ABRE  #505;

     #0#26      = 0;
     Pos        = -1;
     aFabre     = "rt  " + aAlfa;
     |FABRE aFabre;
     aHandle    = FSalida;
     |SI FSalida ] 0;
        |PARA; |SI; |HACIENDO;
               aField = aHandle + " 250";
               |FLEE aField;
               |SI FSalida < 0;   |SAL;  |FINSI;

               aAlfa = aField % 1607;
               |SI aAlfa = "Asunto:";
                   aAlfa   = aField % 2308;
                   nLinea  = 0;
                   nAsunto = aAlfa;

                   aAlfa = aField % 4330;

                   nCampo = 6;   |HAZ GrabaExpe;
                   nCampo = 29;  |HAZ GrabaExpe;

                   #0#26   = #0#26 + 1;  |PINTA #0#26;
               |FINSI;

               aAlfa = aField % 1607;
               |SI aAlfa = "unto..:";
                   aAlfa = aField % 2465;

                   nCampo = 7;  |HAZ GrabaExpe;
               |FINSI;

               aAlfa = aField % 1606;
               |SI aAlfa = "Autos:";
                   aAlfa = aField % 2311;

                   nCampo = 15;  |HAZ GrabaExpe;

                   aAlfa = aField % 3920;  |QBF aAlfa;
                   |SI aAlfa ! "";
                       aAlfa1 = aField % 6207;  |QBF aAlfa1;
                       |SI aAlfa1 ! "";
                           aAlfa = aAlfa + " Numero : " + aAlfa1;
                       |FINSI;
                       aAlfa1 = aField % 7317;  |QBF aAlfa1;
                       |SI aAlfa1 ! "";
                           aAlfa  = aAlfa + " de : " + aAlfa1;
                       |FINSI;

                       nCampo = 17;  |HAZ GrabaExpe;
                   |FINSI;
               |FINSI;

               aAlfa = aField % 1606;
               |SI aAlfa = "ocur.:";
                   aAlfa = aField % 2335

                   nCampo = 19;  |HAZ GrabaExpe;
               |FINSI;

               aAlfa = aField % 1606;
               |SI aAlfa = "ant¡a:";
                   aAlfa = aField % 2313;
                   |HAZ QuitaSignos;

                   nCampo = 12;  |HAZ GrabaExpe;
               |FINSI;

               aAlfa = aField % 2102;
               |SI aAlfa = "3:";
                   aAlfa = aField % 2313;
                   |HAZ QuitaSignos;

                   nCampo = 30;  |HAZ GrabaExpe;
               |FINSI;

               aAlfa = aField % 2102;
               |SI aAlfa = "1:";
                   aAlfa = aField % 2335
                   nCampo = 14;  |HAZ GrabaExpe;
               |FINSI;

               aAlfa = aField % 6702;
               |SI aAlfa = "2:";
                   aAlfa = aField % 7013
                   |HAZ QuitaSignos;

                   nCampo = 33;  |HAZ GrabaExpe;
               |FINSI;

               aAlfa = aField % 6702;
               |SI aAlfa = "4:";
                   aAlfa = aField % 7013
                   |HAZ QuitaSignos;

                   nCampo = 10;  |HAZ GrabaExpe;
                   nCampo = 31;  |HAZ GrabaExpe;
               |FINSI;

               aAlfa1 = &179 + " " + &179;
               aAlfa = aField % 5103;
               |SI aAlfa = aAlfa1;
                   aAlfa1 = &179 + " " + &179 + " Contrarios:";
                   aAlfa  = aField % 5115;
                   |SI aAlfa ! aAlfa1;
                       aAlfa = aField % 5634;

                       |HAZ Contrarios;
                   |FINSI;
               |FINSI;

               aAlfa = aField % 1407;
               |SI aAlfa = "Organo:";
                   aAlfa = aField % 2240;

                   nCampo = 17;  |HAZ GrabaExpe;
               |FINSI;

               aAlfa = aField % 1407;
               |SI aAlfa = "Origen:";
                   aAlfa = aField % 2240;

                   nCampo = 8;  |HAZ GrabaExpe;
               |FINSI;

               aAlfa = aField % 1414;
               |SI aAlfa = "Procura.Cont.:";
                   aAlfa = aField % 2935;

                   nCampo = 23;  |HAZ GrabaExpe;
               |FINSI;

               aAlfa = aField % 1414;
               |SI aAlfa = "Abogado Cont.:";
                   aAlfa = aField % 2935;

                   nCampo = 25;  |HAZ GrabaExpe;
               |FINSI;

               aAlfa = aField % 4201;
               |SI aAlfa = ":";
                   |HAZ Seguimientos;
               |FINSI;
        |SIGUE;
    |FINSI;
    |FCIERRA aHandle;

    |CIERRA  #100;
    |CIERRA  #505;
    |CIERRAT #101;
    |CIERRAT #105;
    |CIERRAT #107;
|FPRC;

|PROCESO GrabaPersona;
     |DDEFECTO #505;
     #505#0 = nPersona;
     #505#1 = aPersona;
     |LIBERA #505;
     |LEE 101#505=;
     |SI FSalida ! 0;
         #505#1 = aPersona;
         |GRABA 020#505n;
     |FINSI;
|FPRC;

|PROCESO GrabaAgenda;
     |DDEFECTO #106;

     #106#0 = nAsunto;
     #106#1 = fFecha;
     #106#2 = nHora;
     #106#3 = nMinu;
     |LEE 101#106=;
     |SI FSalida ! 0;
         #106#4  = "N";
         #106#16 = "S";
         #106#5  = "01.01.0000";
         #106#6  = 0;
         #106#7  = 0;
         |GRABA 020#106b;
     |FINSI;

     |SI fFechaAviso ! "00.00.0000";
         #106#4 = "S";
         #106#5 = fFechaAviso;
         #106#6 = nHoraAviso;
         #106#7 = nMinuAviso;
         |SI #106#5 ] fFechaHoy;
             #106#16 = "N";
         |FINSI;
     |FINSI;

     #106#8 = #505#0;
     #106#9 = #505#1;

     aAlfa1 = #106#10;  |QBT aAlfa1;
     |SI aAlfa1 = "";
         #106#10 = aAlfa;
     |SINO;
         aAlfa1 = #106#11;  |QBT aAlfa1;
         |SI aAlfa1 = "";
             #106#11 = aAlfa;
         |SINO;
             aAlfa1 = #106#12;  |QBT aAlfa1;
             |SI aAlfa1 = "";
                 #106#12 = aAlfa;
             |SINO;
                 aAlfa1 = #106#13;  |QBT aAlfa1;
                 |SI aAlfa1 = "";
                     #106#13 = aAlfa;
                 |SINO;
                     aAlfa1 = #106#14;  |QBT aAlfa1;
                     |SI aAlfa1 = "";
                         #106#14 = aAlfa;
                     |SINO;
                         aAlfa1 = #106#15;  |QBT aAlfa1;
                         |SI aAlfa1 = "";
                             #106#15 = aAlfa;
                         |SINO;
                             aAlfa1 = #106#16;  |QBT aAlfa1;
                             |SI aAlfa1 = "";
                                 #106#16 = aAlfa;
                             |FINSI;
                         |FINSI;
                     |FINSI;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |GRABA 020#106a;
     |LIBERA #106;
|FPRC;

|PROCESO FechaAviso;
     aAlfa = aField % 5330;
     aCadena = "";
     |PARA nCaracter = 1;  |SI nCaracter [ 30;  |HACIENDO nCaracter = nCaracter + 1;
           nPosi = (nCaracter * 100) + 1;
           aCaracter = aAlfa % nPosi;
           |SI aCaracter = "0";  |O aCaracter = "1";  |O aCaracter = "2";
           |O aCaracter = "3";  |O aCaracter = "4";  |O aCaracter = "5";
           |O aCaracter = "6";  |O aCaracter = "7";  |O aCaracter = "8";
           |O aCaracter = "9";
               |SAL;
           |FINSI;
     |SIGUE;

     fFechaAviso = "00.00.0000";
     nHoraAviso  = 0;
     nMinuAviso  = 0;

     |SI nCaracter > 20;  |ACABA; |FINSI;

     nPosi  = (nCaracter * 100) + 2;        aAlfa1 = aAlfa % nPosi;
     nPosi  = ((nCaracter + 3) * 100) + 2;  aAlfa2 = aAlfa % nPosi;
     nPosi  = ((nCaracter + 6) * 100) + 2;  aAlfa3 = aAlfa % nPosi;
     aAlfa4 = aAlfa1 + "." + aAlfa2 + ".19" + aAlfa3;
     fFechaAviso = aAlfa4;

     nPosi = ((nCaracter + 9)  * 100) + 2;  aAlfa1 = aAlfa % nPosi;
     nPosi = ((nCaracter + 12) * 100) + 2;  aAlfa2 = aAlfa % nPosi;

     nHoraAviso = aAlfa1;
     nMinuAviso = aAlfa2;
     aAlfa      = "";
|FPRC;

|PROCESO PasaAgenda;
     |ABRE #505;  |CIERRA #505;  |DELINDEX #505;
     |ABRE #106;  |CIERRA #106;  |DELINDEX #106;

     |ABRET #106;
     |ABRE  #101;
     |ABRE  #505;

     #0#26      = 0;
     Pos        = -1;
     aFabre     = "rt  " + aAlfa;
     |FABRE aFabre;
     aHandle    = FSalida;
     |SI FSalida ] 0;
        |PARA; |SI; |HACIENDO;
               aField = aHandle + " 250";
               |FLEE aField;
               |SI FSalida < 0;   |SAL;  |FINSI;

               aAlfa = aField % 4809;
               |SI aAlfa = "Usuario :";
                   aAlfa = aField % 6203;  nPersona = aAlfa;
                   aAlfa = aField % 7330;  aPersona = aAlfa;
                   |HAZ GrabaPersona;

                   aAlfa  = aField % 2608;
                   aAlfa1 = aAlfa  % 0102;
                   aAlfa2 = aAlfa  % 0402;
                   aAlfa3 = aAlfa  % 0702;
                   aAlfa  = aAlfa1 + "." + aAlfa2 + ".19" + aAlfa3;
                   fFecha = aAlfa;

                   aAlfa  = aField  % 3602;  nHora  = aAlfa;
                   aAlfa  = aField  % 3902;  nMinu  = aAlfa;

                   #0#26   = #0#26 + 1;  |PINTA #0#26;
               |FINSI;

               aAlfa = aField % 1711;
               |SI aAlfa = "N§ Asunto :";
                   aAlfa = aField % 2908;
                   nAsunto = aAlfa;

                   aAlfa  = aField % 5305;
                   aAlfa  = aAlfa > aAlfa;
                   |SI aAlfa = "LUNES";  |O aAlfa = "MARTE";  |O aAlfa = "MIERC";
                    |O aAlfa = "JUEVE";  |O aAlfa = "VIERN";  |O aAlfa = "SABAB";
                    |O aAlfa = "DOMIN";
                       |HAZ FechaAviso;
                   |SINO;
                       aAlfa = aField % 5345;
                   |FINSI;

                   |HAZ GrabaAgenda;

                   fFechaAviso = "00.00.0000";
                   nHoraAviso  = 0;
                   nMinuAviso  = 0;
              |FINSI;

              aAlfa = aField  % 1730;  |QBT aAlfa;
              aAlfa1 = aField % -101;
              aAlfa2 = &179;
              |SI aAlfa = "";  |Y aAlfa1 = aAlfa2;
                  aAlfa  = aField % 5360;  |QBT aAlfa;
                  aAlfa1 = aAlfa % 0108;
                  |SI aAlfa1 ! "Cliente:";
                      aAlfa1 = aAlfa % 0107;
                      |SI aAlfa1 ! "Asunto:";
                          aAlfa  = aField % 5345;
                          |HAZ GrabaAgenda;
                      |FINSI;
                  |FINSI;
              |FINSI;
        |SIGUE;
    |FINSI;
    |FCIERRA aHandle;

    |CIERRA  #101;
    |CIERRA  #505;
    |CIERRAT #106;
|FPRC;

|PROCESO PonNombre;  |TIPO 7;
     |DBASE aAlfa;
     aAlfa = aAlfa + "guarda/moya/";
     |SI Campo = 0;  #0Campo = aAlfa + "referen";  |FINSI;
     |SI Campo = 1;  #0Campo = aAlfa + "asuntos";  |FINSI;
     |SI Campo = 2;  #0Campo = aAlfa + "asun1";    |FINSI;
     |SI Campo = 3;  #0Campo = aAlfa + "agenda";   |FINSI;
     |PINTA #0Campo;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;
     fFechaHoy = ~;

     |C_P #0#26, 1, 0969;  aAlfa = #0#0;  |QBT aAlfa;  |SI aAlfa ! "";  |HAZ PasaCliente;  |FINSI;
     |C_P #0#26, 1, 1069;  aAlfa = #0#1;  |QBT aAlfa;  |SI aAlfa ! "";  |HAZ PasaAsuntos1; |FINSI;
     |C_P #0#26, 1, 1169;  aAlfa = #0#3;  |QBT aAlfa;  |SI aAlfa ! "";  |HAZ PasaAgenda;   |FINSI;
     |C_P #0#26, 1, 1269;  aAlfa = #0#2;  |QBT aAlfa;  |SI aAlfa ! "";  |HAZ PasaAsuntos2; |FINSI;
|FPRC;
