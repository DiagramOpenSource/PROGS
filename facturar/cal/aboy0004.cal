|FICHEROS;
     aboy0004 #0;
     asclient #1;
     asempres #2;
     abom0001 #100;
     abom0002 #102;
     abom0003 #103;
     abom0004 #104;

     abom0501 #501;
     abom0502 #502;
     abom0503 #503;
     abom0504 #504;
     abom0505 #505;
     abom0506 #506;
     abom0514 #514;

     abom0602 #602;
     abom0603 #603;
     abom0604 #604;
     abom0605 #605;
     abom0606 #606;

     abow0014 #99,MANTE;
     abow0017 #999;
|FIN;

|VARIABLES;
     nMailing       = 0;
     nCampo         = 0;
     aDCerrado      = @;
     aHCerrado      = @;
     aDConfid       = "";
     aHConfid       = "";
     aParametro     = "";

     nDCliente    = 0;
     nHCliente    = 0;
     nPosi        = 0;
     nContador    = 0;
     nRegistro    = 0;
     nWord        = 0;
     nLinea       = 0;
     nSwDialogo   = 0;
     nCopia       = 0;
     nDCodigo     = 0;
     nHCodigo     = 0;
     nCodigo      = 0;
     nLen         = 0;

     aAlfa         = "";
     aAlfa1        = "";
     aAlfa2        = "";
     aCaracter     = "";
     aFichero      = "";
     aCampo        = "";
     aAsigna       = "";
     aOrigen       = "";
     aDestino      = "";
     aAbre         = "";
     aCadena       = "";
     aLen          = "";

     &enCodExpe        = 0;
     &eaNombreCli      = "";
     &enExped          = 0;
     &enFSalida        = 0;
     &enCodUbica       = 0;
     &efFechaDocu      = @;
     &enTipoDocumento  = 0;
     &eaRutaDocumento  = "";
     &eaNombrePrograma = "";
     &eaNombreRuta     = "";
     &eaRutaPlanilla   = "";
     &eaExtension      = "";
     &eaFicheroEdita   = "";
     &eaPiePagina      = "";
     &enMailing        = 0;
     &eaUnidadBasico   = "";
|FIN;

 ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
 **************** PROCESOS PARA PEDIR DATOS POR PANTALLAS
 ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

|PROCESO SacaHistorico;  |TIPO 66;
     |PUSHV 0501 2380;
     |ABRE #604;
     |LEE 040#604p;
     |CONSULTA_CLAVE #2#604;
     |CIERRA #604;
     |POPV;

     #0#0 = #604#0;  |PINTA #0#0;
|FPRC;

|PROCESO MiraHistorico;
     |SI #0#0 = 0;  |ACABA;  |FINSI;

     |ABRE #604;
     #604#0 = #0#0;
     |LEE 040#604=;
     |SI FSalida ! 0;
         |MENAV "      No existe el Registro en el Historico.";
         |ERROR;
         |CIERRA #604;
         |ACABA;
     |FINSI;
     |CIERRA #604;

     |PARA nCampo = 1;  |SI nCampo [ 38;  |HACIENDO nCampo = nCampo + 1;
           |C_M #0nCampo, 1, "N";
     |SIGUE;

     #0#1  = #604#4;      |PINTA #0#1;
     #0#2  = #604#5;      |PINTA #0#2;
     #0#39 = #604#9;      |PINTA #0#39;
|FPRC;

|PROCESO SacaMailing;  |TIPO 66;
     |SI #0#0 ! 0;  |ACABA;  |FINSI;

     |PUSHV 0501 2380;
     |ABRE #602;
     |LEE 040#602p;
     |CONSULTA_CLAVE #1#602;
     |CIERRA #602;
     |POPV;

     #0#1 = #602#0;  |PINTA #0#1;
     #0#2 = #602#1;  |PINTA #0#2;
|FPRC;

|PROCESO EstaElMailing;
     |ABRE #602;
     #602#0 = #0#1;
     |LEE 040#602=;
     |SI FSalida ! 0;
         |MENAV "     No existe el Mailing";
         |ERROR;
     |FINSI;
     |CIERRA #602;

     #0#2 = #602#1;  |PINTA #0#2;

     |SI #0#0 = 0;
         |SI #602#5 = "C";
             |PDEFECTO #0, 3, 39;
             |PARA nCampo = 3;  |SI nCampo [ 41;  |HACIENDO nCampo = nCampo + 1;
                   |C_M #0nCampo, 1, "N";
                   |PINTA #0nCampo;
             |SIGUE;
             |C_M #0#23, 1, "S";
             |C_M #0#24, 1, "S";
             |C_M #0#39, 1, "S";
         |SINO;
             |SI enExped = 0;
                 |PARA nCampo = 3;  |SI nCampo [ 38;  |HACIENDO nCampo = nCampo + 1;
                       |C_M #0nCampo, 1, "S";
                 |SIGUE;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #602#5 = "E";
         |C_M #0#40, 1, "S";
         |C_M #0#41, 1, "S";
     |FINSI;
|FPRC;

|PROCESO Parrilla;
     |SI enExped ! 0;    |ACABA;  |FINSI;
     |SI #0#0    ! 0;    |ACABA;  |FINSI;
     |SI #602#5  = "C";  |ACABA;  |FINSI;

     |SI #0#3 = 0;
         #0#3 = 0;  |PINTA #0#3;
         #0#4 = 0;  |PINTA #0#4;  |C_M #0#4, 1, "N";
         |PARA nCampo = 5;  |SI nCampo [ 22;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
         |PARA nCampo = 23;  |SI nCampo [ 38;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |C_M #0#3, 1, "S";
         |C_M #0#4, 1, "S";
         |PARA nCampo = 5;  |SI nCampo [ 22;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
               #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
         |PARA nCampo = 23;  |SI nCampo [ 38;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasExped;
     |SI enExped ! 0;  |ACABA;  |FINSI;
     |SI #0#0    ! 0;  |ACABA;  |FINSI;

     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 22;  |HACIENDO nCampo = nCampo + 1;
               #0Campo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 22;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO BuscaNombre;
     |PUSHV 0501 2380;
     |D_CUADRO 0725, 1067;
     |BLANCO 0826 0966;
     |ATRI R;  |PINTA 0826, "INTRODUZCA EL NOMBRE DEL CLIENTE A BUSCAR"; |ATRI 0;

     E_sup      = "40"
     E_inf      = ""
     eaNombreCli = 0926 ? 1;
     |POPV;

     eaNombreCli = eaNombreCli > eaNombreCli;
     enCodExpe   = #0Campo;

     |SUB_EJECUTA "aboz0003";

     |SI #0Campo ! enCodExpe; |Y #0Campo ! 99999999;
         #0Campo = enCodExpe;  |PINTA #0Campo;
         |PTEC 802;
     |FINSI;
|FPRC;

|PROCESO BuscaTodo;
     eaNombreCli = "";
     enCodExpe   = #0Campo;

     |SUB_EJECUTA "aboz0003";

     |SI #0Campo ! enCodExpe; |Y #0Campo ! 99999999;
         #0Campo = enCodExpe;  |PINTA #0Campo;
         |PTEC 802;
     |FINSI;
|FPRC;

|PROCESO BuscaExpe;  |TIPO 0;
     |SI FSalida = 10;  |HAZ BuscaNombre;  |ERROR;  |FINSI;
     |SI FSalida = 11;  |HAZ BuscaTodo;    |ERROR;  |FINSI;
|FPRC;

|PROCESO Visualizar;
     |C_M #0#40, 1, "S";
     |SI #0#42 = "S";
         |C_M #0#40, 1, "N";
         #0#40 = 0;  |PINTA #0#40;
     |FINSI;
|FPRC;

 ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
 **************** PROCESOS DEL MAILING
 ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

|PROCESO QuitaRaros;
     |QBF aAlfa;
     aCadena = "";
     aLen    = aAlfa % 0;
     nLen    = aLen;
     |PARA nCampo = 1;  |SI nCampo [ nLen;  |HACIENDO nCampo = nCampo + 1;
           nPosi = (100 * nCampo) + 1;
           aCaracter = aAlfa % nPosi;
           |SI aCaracter = "¥";  aCaracter = &209; |FINSI;
           |SI aCaracter = "¤";  aCaracter = &241; |FINSI;
           |SI aCaracter = " ";  aCaracter = &225; |FINSI;
           |SI aCaracter = "‚";  aCaracter = &233; |FINSI;
           |SI aCaracter = "¡";  aCaracter = &237; |FINSI;
           |SI aCaracter = "¢";  aCaracter = &243; |FINSI;
           |SI aCaracter = "£";  aCaracter = &250; |FINSI;
           |SI aCaracter = "§";  aCaracter = &176; |FINSI;
           |SI aCaracter = "¦";  aCaracter = &170; |FINSI;
           aCadena = aCadena + aCaracter;
     |SIGUE;
     aAlfa = aCadena;
|FPRC;

|PROCESO Asigna;
     FSalida = 0;
     aAlfa   = #999#2;   |HAZ QuitaRaros;
     |PARA; |SI FSalida = 0;  |HACIENDO;
            aAsigna   = "!" + #999#1;
            |WORD_ASIGNA_TEXTO nWord, aAsigna, aAlfa;
     |SIGUE;
|FPRC;

|DEFBUCLE abow0017;
     #999#1;
     ;
     00000, "        ";
     99999, "zzzzzzzz";
     ;
     NULL, Asigna;
|FIN;

|PROCESO TemporalImpresion;
     nContador = nContador + 1;
     aAlfa     = ("00000" + #603#1) % -105;

     #999#0 = #603#1;
     #999#1 = "#" + (aAlfa % 102) + "#" + "0" + (aAlfa % 303);
     #999#2 = "";
     #999#3 = 0;
     #999#4 = #603#6;
     #999#5 = #603#8;
     #999#6 = #603#7;
     |GRABA 020#999n;
|FPRC;

|DEFBUCLE abom0603;
     #603#1;
     ;
     #0#1, nDCodigo;
     #0#1, nHCodigo;
     ;
     NULL, TemporalImpresion;
|FIN;

|PROCESO Carga1;
     aCampo = (("00000" + #999#0) % -105) % 303;
     nCampo = aCampo;
     |SI #999#5 = "N";
         aCaracter = " ";
         |SI #999#4 [ 5;  aCaracter = "0";  |FINSI;
         nPosi  = -(100 + #999#4)
         #999#2 = ((aCaracter * #999#4) + #100nCampo) % nPosi;
     |SINO;
         #999#2 = #100nCampo;
     |FINSI;
     |GRABA 020#999a;
|FPRC;

|PROCESO Carga2;
     |ABRE #1;
     #1#0 = #100#3;
     |LEE 040#1=;
     |SI FSalida ! 0;  |CIERRA #1;  |ACABA;  |FINSI;
     |CIERRA #1;

     aCampo = (("00000" + #999#0) % -105) % 303;
     nCampo = aCampo;
     |SI #999#5 = "N";
         aCaracter = " ";
         |SI #999#4 [ 5;  aCaracter = "0";  |FINSI;
         nPosi  = -(100 + #999#4)
         #999#2 = ((aCaracter * #999#4) + #1nCampo) % nPosi;
     |SINO;
         #999#2 = #1nCampo;
     |FINSI;
     |GRABA 020#999a;
|FPRC;

|PROCESO Carga3;
     |ABRE #501;
     #501#0 = #100#16;
     |LEE 040#501=;
     |SI FSalida ! 0;  |CIERRA #501;  |ACABA;  |FINSI;
     |CIERRA #501;

     aCampo = (("00000" + #999#0) % -105) % 303;
     nCampo = aCampo;
     |SI #999#5 = "N";
         aCaracter = " ";
         |SI #999#4 [ 5;  aCaracter = "0";  |FINSI;
         nPosi  = -(100 + #999#4)
         #999#2 = ((aCaracter * #999#4) + #501nCampo) % nPosi;
     |SINO;
         #999#2 = #501nCampo;
     |FINSI;
     |GRABA 020#999a;
|FPRC;

|PROCESO Carga4;
     |ABRE #502;
     #502#0 = #100#20;
     |LEE 040#502=;
     |SI FSalida ! 0;  |CIERRA #502;  |ACABA;  |FINSI;
     |CIERRA #502;

     aCampo = (("00000" + #999#0) % -105) % 303;
     nCampo = aCampo;
     |SI #999#5 = "N";
         aCaracter = " ";
         |SI #999#4 [ 5;  aCaracter = "0";  |FINSI;
         nPosi  = -(100 + #999#4)
         #999#2 = ((aCaracter * #999#4) + #502nCampo) % nPosi;
     |SINO;
         #999#2 = #502nCampo;
     |FINSI;
     |GRABA 020#999a;
|FPRC;

|PROCESO Carga5;
     |ABRE #502;
     #502#0 = #100#24;
     |LEE 040#502=;
     |SI FSalida ! 0;  |CIERRA #502;  |ACABA;  |FINSI;
     |CIERRA #502;

     aCampo = (("00000" + #999#0) % -105) % 303;
     nCampo = aCampo;
     |SI #999#5 = "N";
         aCaracter = " ";
         |SI #999#4 [ 5;  aCaracter = "0";  |FINSI;
         nPosi  = -(100 + #999#4)
         #999#2 = ((aCaracter * #999#4) + #502nCampo) % nPosi;
     |SINO;
         #999#2 = #502nCampo;
     |FINSI;
     |GRABA 020#999a;
|FPRC;

|PROCESO Carga6;
     |ABRE #503;
     #503#0 = #100#18;
     |LEE 040#503=;
     |SI FSalida ! 0;  |CIERRA #503;  |ACABA;  |FINSI;
     |CIERRA #503;

     aCampo = (("00000" + #999#0) % -105) % 303;
     nCampo = aCampo;
     |SI #999#5 = "N";
         aCaracter = " ";
         |SI #999#4 [ 5;  aCaracter = "0";  |FINSI;
         nPosi  = -(100 + #999#4)
         #999#2 = ((aCaracter * #999#4) + #503nCampo) % nPosi;
     |SINO;
         #999#2 = #503nCampo;
     |FINSI;
     |GRABA 020#999a;
|FPRC;

|PROCESO Carga7;
     |ABRE #503;
     #503#0 = #100#22;
     |LEE 040#503=;
     |SI FSalida ! 0;  |CIERRA #503;  |ACABA;  |FINSI;
     |CIERRA #503;

     aCampo = (("00000" + #999#0) % -105) % 303;
     nCampo = aCampo;
     |SI #999#5 = "N";
         aCaracter = " ";
         |SI #999#4 [ 5;  aCaracter = "0";  |FINSI;
         nPosi  = -(100 + #999#4)
         #999#2 = ((aCaracter * #999#4) + #503nCampo) % nPosi;
     |SINO;
         #999#2 = #503nCampo;
     |FINSI;
     |GRABA 020#999a;
|FPRC;

|PROCESO Carga8;
     |ABRE #505;
     #505#0 = #100#5;
     |LEE 040#505=;
     |SI FSalida ! 0;  |CIERRA #505;  |ACABA;  |FINSI;
     |CIERRA #505;

     aCampo = (("00000" + #999#0) % -105) % 303;
     nCampo = aCampo;
     |SI #999#5 = "N";
         aCaracter = " ";
         |SI #999#4 [ 5;  aCaracter = "0";  |FINSI;
         nPosi  = -(100 + #999#4)
         #999#2 = ((aCaracter * #999#4) + #505nCampo) % nPosi;
     |SINO;
         #999#2 = #505nCampo;
     |FINSI;
     |GRABA 020#999a;
|FPRC;

|PROCESO Carga9;
     |ABRE #505;
     #505#0 = #100#28;
     |LEE 040#505=;
     |SI FSalida ! 0;  |CIERRA #505;  |ACABA;  |FINSI;
     |CIERRA #505;

     aCampo = (("00000" + #999#0) % -105) % 303;
     nCampo = aCampo;
     |SI #999#5 = "N";
         aCaracter = " ";
         |SI #999#4 [ 5;  aCaracter = "0";  |FINSI;
         nPosi  = -(100 + #999#4)
         #999#2 = ((aCaracter * #999#4) + #505nCampo) % nPosi;
     |SINO;
         #999#2 = #505nCampo;
     |FINSI;
     |GRABA 020#999a;
|FPRC;

|PROCESO Carga10;
     |ABRE #104;
     #104#0 = #100#0;
     #104#1 = 1;
     |LEE 040#104];
     |SI FSalida ! 0;      |ACABA;  |FINSI;
     |SI #104#0 ! #100#0;  |ACABA;  |FINSI;
     |CIERRA #104;

     |ABRE #504;
     #504#0 = #104#1;
     |LEE 040#504=;
     |SI FSalida ! 0;  |CIERRA #504;  |ACABA;  |FINSI;
     |CIERRA #504;

     aCampo = (("00000" + #999#0) % -105) % 303;
     nCampo = aCampo;
     |SI #999#5 = "N";
         aCaracter = " ";
         |SI #999#4 [ 5;  aCaracter = "0";  |FINSI;
         nPosi  = -(100 + #999#4)
         #999#2 = ((aCaracter * #999#4) + #504nCampo) % nPosi;
     |SINO;
         #999#2 = #504nCampo;
     |FINSI;
     |GRABA 020#999a;
|FPRC;

|PROCESO Carga11;
     |ABRE #506;
     #506#0 = #100#13;
     |LEE 040#506=;
     |SI FSalida ! 0;  |CIERRA #506;  |ACABA;  |FINSI;
     |CIERRA #506;

     aCampo = (("00000" + #999#0) % -105) % 303;
     nCampo = aCampo;
     |SI #999#5 = "N";
         aCaracter = " ";
         |SI #999#4 [ 5;  aCaracter = "0";  |FINSI;
         nPosi  = -(100 + #999#4)
         #999#2 = ((aCaracter * #999#4) + #506nCampo) % nPosi;
     |SINO;
         #999#2 = #506nCampo;
     |FINSI;
     |GRABA 020#999a;
|FPRC;

|PROCESO Carga12;
     |ABRE #2;
     #2#0 = #100#26;
     |LEE 040#2=;
     |SI FSalida ! 0;  |CIERRA #2;  |ACABA;  |FINSI;
     |CIERRA #2;

     aCampo = (("00000" + #999#0) % -105) % 303;
     nCampo = aCampo;
     |SI #999#5 = "N";
         aCaracter = " ";
         |SI #999#4 [ 5;  aCaracter = "0";  |FINSI;
         nPosi  = -(100 + #999#4)
         #999#2 = ((aCaracter * #999#4) + #2nCampo) % nPosi;
     |SINO;
         #999#2 = #2nCampo;
     |FINSI;
     |GRABA 020#999a;
|FPRC;

|PROCESO abom0003;
     aCampo = (("00000" + #999#0) % -105) % 303;
     nCampo = aCampo;
     |SI #999#5 = "N";
         aCaracter = " ";
         |SI #999#4 [ 5;  aCaracter = "0";  |FINSI;
         nPosi  = -(100 + #999#4)
         aAlfa = ((aCaracter * #999#4) + #103nCampo) % nPosi;
     |SINO;
         aAlfa = #103nCampo;
     |FINSI;

                       |QBF aAlfa;
     aAlfa1 = #999#2;  |QBF aAlfa1;
     |SI aAlfa1 = "";
         #999#2 = aAlfa + &10;
     |SINO;
         #999#2 = aAlfa1 + " " + aAlfa + &10;
     |FINSI;
|FPRC;

|DEFBUCLE abom0003;
     #103#1;
     ;
     #100#0, 00001;
     #100#0, 99999;
     ;
     NULL, abom0003;
|FIN;

|PROCESO Carga14;
     |BUCLE abom0003;

     |GRABA 020#999a;
     |LIBERA #999;
|FPRC;

|PROCESO abom0004;
     aCampo = (("00000" + #999#0) % -105) % 303;
     nCampo = aCampo;
     |SI #999#5 = "N";
         aCaracter = " ";
         |SI #999#4 [ 5;  aCaracter = "0";  |FINSI;
         nPosi  = -(100 + #999#4)
         aAlfa = ((aCaracter * #999#4) + #104nCampo) % nPosi;
     |SINO;
         aAlfa = #104nCampo;
     |FINSI;

                       |QBF aAlfa;
     aAlfa1 = #999#2;  |QBF aAlfa1;
     |SI aAlfa1 = "";
         #999#2 = aAlfa + &10;
     |SINO;
         #999#2 = aAlfa1 + " " + aAlfa + &10;
     |FINSI;
|FPRC;

|DEFBUCLE abom0004;
     #104#1;
     ;
     #100#0, 00001;
     #100#0, 99999;
     ;
     NULL, abom0004;
|FIN;

|PROCESO Carga15;
     |BUCLE abom0004;

     |GRABA 020#999a;
     |LIBERA #999;
|FPRC;

|PROCESO abom0001;
     #100#0 = #99#0;
     |LEE 040#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;

     #999#0 = 01000;
     #999#1 = "      ";
     |LEE 101#999];
     |PARA;  |SI; |HACIENDO;
             aAlfa = (("00000" + #999#0) % -105) % 102;
             |SI FSalida ! 0;     |LIBERA #999;  |SAL;  |FINSI;
             |SI #999#0 > 15999;  |LIBERA #999;  |SAL;  |FINSI;

             |SI #999#0 ] 01000;  |Y #999#0 [ 01999;  |HAZ Carga1;   |FINSI;
             |SI #999#0 ] 02000;  |Y #999#0 [ 02999;  |HAZ Carga2;   |FINSI;
             |SI #999#0 ] 03000;  |Y #999#0 [ 03999;  |HAZ Carga3;   |FINSI;
             |SI #999#0 ] 04000;  |Y #999#0 [ 04999;  |HAZ Carga4;   |FINSI;
             |SI #999#0 ] 05000;  |Y #999#0 [ 05999;  |HAZ Carga5;   |FINSI;
             |SI #999#0 ] 06000;  |Y #999#0 [ 06999;  |HAZ Carga6;   |FINSI;
             |SI #999#0 ] 07000;  |Y #999#0 [ 07999;  |HAZ Carga7;   |FINSI;
             |SI #999#0 ] 08000;  |Y #999#0 [ 08999;  |HAZ Carga8;   |FINSI;
             |SI #999#0 ] 09000;  |Y #999#0 [ 09999;  |HAZ Carga9;   |FINSI;
             |SI #999#0 ] 10000;  |Y #999#0 [ 10999;  |HAZ Carga10;  |FINSI;
             |SI #999#0 ] 11000;  |Y #999#0 [ 11999;  |HAZ Carga11;  |FINSI;
             |SI #999#0 ] 12000;  |Y #999#0 [ 12999;  |HAZ Carga12;  |FINSI;
             |SI #999#0 ] 14000;  |Y #999#0 [ 14999;  |HAZ Carga14;  |FINSI;
             |SI #999#0 ] 15000;  |Y #999#0 [ 15999;  |HAZ Carga15;  |FINSI;

             |LIBERA #999;
             |LEE 101#999s;
     |SIGUE;
|FPRC;

|PROCESO aboy0004;
     #999#0 = 13000;
     #999#1 = "      ";
     |LEE 101#999];
     |PARA;  |SI; |HACIENDO;
             aAlfa = (("00000" + #999#0) % -105) % 102;
             |SI FSalida ! 0;     |LIBERA #999;  |SAL;  |FINSI;
             |SI aAlfa   ! "13";  |LIBERA #999;  |SAL;  |FINSI;

             aCampo = (("00000" + #999#0) % -105) % 303;
             nCampo = aCampo;
             |SI #999#5 = "N";
                 aCaracter = " ";
                 |SI #999#4 [ 5;  aCaracter = "0";  |FINSI;
                 nPosi  = -(100 + #999#4)
                  #999#2 = ((aCaracter * #999#4) + #0nCampo) % nPosi;
             |SINO;
                  #999#2 = #0nCampo;
             |FINSI;
             #999#3 = 1;
             |GRABA 020#999a;
             |LIBERA #999;

             |LEE 101#999s;
     |SIGUE;
|FPRC;

|PROCESO asclient;
     |ABRE #1;
     #1#0 = #99#1;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     #999#0 = 02000;
     #999#1 = "      ";
     |LEE 101#999];
     |PARA;  |SI; |HACIENDO;
             aAlfa = (("00000" + #999#0) % -105) % 102;
             |SI FSalida ! 0;     |LIBERA #999;  |SAL;  |FINSI;
             |SI aAlfa   ! "02";  |LIBERA #999;  |SAL;  |FINSI;

             aCampo = (("00000" + #999#0) % -105) % 303;
             nCampo = aCampo;
             |SI #999#5 = "N";
                 aCaracter = " ";
                 |SI #999#4 [ 5;  aCaracter = "0";  |FINSI;
                 nPosi  = -(100 + #999#4)
                  #999#2 = ((aCaracter * #999#4) + #1nCampo) % nPosi;
             |SINO;
                  #999#2 = #1nCampo;
             |FINSI;
             #999#3 = 1;
             |GRABA 020#999a;
             |LIBERA #999;

             |LEE 101#999s;
     |SIGUE;
|FPRC;

|PROCESO CreaDocumento;
     |ABRE #102;
     #102#0  = #99#0;
     #102#1  = 99999;
     |LEE 040#102];
     |SI FSalida = 0;
         |LEE 040#102a;
     |SINO;
         |LEE 040#102u;
     |FINSI;
     |SI FSalida = 0;  |Y #102#0 = #99#0;
         nLinea = #102#1 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #102;
     |HORA aAlfa;
     aAlfa1 = aAlfa % 102;
     aAlfa2 = aAlfa % 402;

     #102#0  = #99#0;
     #102#1  = nLinea;
     #102#2  = #602#1;
     |SI #102#1 [ 999;
         #102#3  = "w" + (("00000000" + #102#0) % -108) + (("000" + #102#1) % -103) + ".doc";
     |SINO;
         #102#3  = "w" + (("00000000" + #102#0) % -108) + (("00000" + #102#1) % -105) + ".doc";
     |FINSI;
     #102#4  = ~;
     #102#5  = aAlfa1;
     #102#6  = aAlfa2;
     #102#7  = ~;
     #102#8  = aAlfa1;
     #102#9  = aAlfa2;
     #102#10 = enCodUbica;
     |GRABA 020#102n;
     |LIBERA #102;
     |CIERRA #102;

     efFechaDocu = #102#4;
     enCodUbica  = #102#10;   |HAZ LeeUbicaciones;
     eaExtension = eaExtension < "";

     aOrigen  = eaUnidadBasico + "\DOCUMENTOS\IPABOGAD\" + #602#4;   |QBF aOrigen;
     aOrigen  = aOrigen + "." + eaExtension;          |QBF aDestino;
     |SI #102#1 [ 999;
         aDestino = eaRutaDocumento + "/" + "w" + (("00000000" + #102#0) % -108) + (("000" + #102#1) % -103) + ".doc";
     |SINO;
         aDestino = eaRutaDocumento + "/" + "w" + (("00000000" + #102#0) % -108) + (("00000" + #102#1) % -105) + ".doc";
     |FINSI;
     |QBF aOrigen;
     |QBF aDestino;

     |SI #514#21 ! "C";
         |RCOPIA_FICHERO aOrigen, aDestino;
     |SINO;
         |RECIBE_FICHERO aOrigen, aDestino;
     |FINSI;

     |SI FSalida ! 0;
         |MENAV "     No se ha podido copiar el Documento al Cliente.";
     |FINSI;
|FPRC;

|PROCESO AbreWord;
     aAlfa = eaUnidadBasico + "\DOCUMENTOS";                   |RMKDIR aAlfa;
     aAlfa = eaUnidadBasico + "\DOCUMENTOS\IPABOGAD";          |RMKDIR aAlfa;

     nRegistro = 0;
     aOrigen   = eaRutaDocumento + "/" + #602#4;      |QBF aOrigen;
     aOrigen   = aOrigen + "." + eaExtension;         |QBF aOrigen;
     aDestino  = eaUnidadBasico + "\DOCUMENTOS\IPABOGAD\" + #602#4;  |QBF aDestino;
     aDestino  = aDestino + "." + eaExtension;        |QBF aDestino;

     |SI #514#21 ! "C";
         |RCOPIA_FICHERO aOrigen, aDestino;
     |SINO;
         |ENVIA_FICHERO aOrigen, aDestino;
     |FINSI;

     |SI FSalida ! 0;
         |MENAV "      No se ha podido copiar el Documento al Directorio de Trabajo";
         |ACABA;
     |FINSI;

     nWord = 1;
     aAbre = aDestino;

     |MENSA "      Abriendo el Documento, espere un Momento.";

     |WORD_ABRE nWord, aAbre;
     |WORD_PROPIEDADES nWord, "Visible", "NO";
|FPRC;

|PROCESO CreaFichero;
     aFichero = ("b4" + Usuario + "zzzzzzzz") % 108;  |NOME_DAT #999 aFichero;
     |ABRE #999;  |CIERRA #999;  |DELINDEX #999;

     |ABRE #999;
     nContador   = 0;
     nDCodigo    = 01000;  nHCodigo  = 01999;  |BUCLE abom0603;
     nDCodigo    = 02000;  nHCodigo  = 02999;  |BUCLE abom0603;
     nDCodigo    = 03000;  nHCodigo  = 03999;  |BUCLE abom0603;
     nDCodigo    = 04000;  nHCodigo  = 04999;  |BUCLE abom0603;
     nDCodigo    = 05000;  nHCodigo  = 05999;  |BUCLE abom0603;
     nDCodigo    = 06000;  nHCodigo  = 06999;  |BUCLE abom0603;
     nDCodigo    = 07000;  nHCodigo  = 07999;  |BUCLE abom0603;
     nDCodigo    = 08000;  nHCodigo  = 08999;  |BUCLE abom0603;
     nDCodigo    = 09000;  nHCodigo  = 09999;  |BUCLE abom0603;
     nDCodigo    = 10000;  nHCodigo  = 10999;  |BUCLE abom0603;
     nDCodigo    = 11000;  nHCodigo  = 11999;  |BUCLE abom0603;
     nDCodigo    = 12000;  nHCodigo  = 12999;  |BUCLE abom0603;
     nDCodigo    = 13000;  nHCodigo  = 13999;  |BUCLE abom0603;
     nDCodigo    = 14000;  nHCodigo  = 14999;  |BUCLE abom0603;
     nDCodigo    = 15000;  nHCodigo  = 15999;  |BUCLE abom0603;

     efFechaDocu = "00.00.0000";
     enCodUbica  = #602#2;  |HAZ LeeUbicaciones;
     eaExtension = eaExtension < "";
     |HAZ AbreWord;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |MENSA "      Asignando Campos";

     |SI #602#5 = "E";
         |HAZ abom0001;
         |HAZ aboy0004;
     |SINO;
         |HAZ asclient;
     |FINSI;

     |CIERRA #99;

     |BUCLE abow0017;

     |SI #602#5 = "E";
         #605#0 = #604#0;
         #605#1 = #99#0;
         #605#2 = #99#1;
         #605#3 = #99#2;
     |SINO;
         #605#0 = #604#0;
         #605#1 = #99#1;
         #605#2 = #99#1;
         #605#3 = #99#2;
     |FINSI;

     |GRABA 020#605n;
     |LIBERA #605;

     |MENSA "      Imprimiendo Documento";

     |SI #0#42 = "N";
         |PARA nCopia = 1;  |SI nCopia [ #0#40;  |HACIENDO nCopia = nCopia + 1;
               |SI nSwDialogo = "0";  |WORD_IMPRIME nWord, "Dialogo";  |FINSI;
               |SI nSwDialogo = "1";  |WORD_IMPRIME nWord, "";         |FINSI;
               |WORD_PROPIEDADES nWord, "Visible", "NO";
         |SIGUE;
         |SLEEP 10;
         nSwDialogo = 1;
         |WORD_SALVA nWord, "";
         |MENSA "      Cerrando Documento";
     |SINO;
         |WORD_PROPIEDADES nWord, "Visible", "SI";

         |MENSA "      Documento Abierto.";

         FSalida = "NO";
         |PARA;  |SI FSalida = "NO";  |HACIENDO;
                 |PULSATECLA;
                 |WORD_PROPIEDADES nWord, "Quit", "";
         |SIGUE;

         |MENSA "      Cerrando en Documento espere un Momento";
     |FINSI;

     |SI #0#41 = "S";   |HAZ CreaDocumento;   |FINSI;

     |SI #514#21 ! "C";
         |RFBORRA aAbre;
     |SINO;
         |FBORRA aAbre;
     |FINSI;

     |DELINDEX #999;
|FPRC;

|DEFBUCLE abow0014;
     #99#1;
     ;
     00000000, 00001;
     99999999, 99999;
     ;
     NULL, CreaFichero;
|FIN;

|PROCESO GrabaTempoHisto;
     #100#0 = #605#1;
     |LEE 040#100=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #602#5 = "E";
         #99#0 = #605#1;
         #99#1 = #605#2;
         #99#2 = #605#3;
         #99#3 = #100#7;
         #99#4 = #100#8;
         #99#5 = #100#9;
     |SINO;
         #99#0 = 0;
         #99#1 = #605#2;
         #99#2 = #605#3;
         #99#3 = "";
         #99#4 = "";
         #99#5 = "";
     |FINSI;
     |GRABA 020#99n;
     |LIBERA #99;
|FPRC;

|DEFBUCLE abom0605;
     #605#1;
     ;
     #0#0,        1;
     #0#0, 99999999;
     ;
     NULL, GrabaTempoHisto;
|FIN;

|PROCESO GrabaTempo;
     |SI #602#5 = "E";
         #99#0 = #100#0;
         #99#1 = #100#3;
         #99#2 = #100#4;
         #99#3 = #100#7;
         #99#4 = #100#8;
         #99#5 = #100#9;
     |SINO;
         #99#0 = 0;
         #99#1 = #1#0;
         #99#2 = #1#1;
         #99#3 = "";
         #99#4 = "";
         #99#5 = "";
     |FINSI;
     |GRABA 020#99n;
     |LIBERA #99;
|FPRC;

|DEFBUCLE abom0001_1;
     #100#1;
     3, 13, 26, 5, 28, 16, 34, 2, 27;
     #0#3, #0#23, #0#25, #0#27, #0#29, #0#31, #0#33, #0#35, aDCerrado, aDConfid;
     #0#4, #0#24, #0#26, #0#28, #0#30, #0#32, #0#34, #0#36, aHCerrado, aHConfid;
     ;
     NULL, GrabaTempo;
|FIN;

|DEFBUCLE abom0001_2;
     #100#1;
     ;
     #0#3;
     #0#4;
     ;
     NULL, GrabaTempo;
|FIN;

|DEFBUCLE asclient;
     #1#1;
     ;
     #0#23;
     #0#24;
     ;
     NULL, GrabaTempo;
|FIN;

|RUTINA ClaveBaja99_1;
     #99#0 = 0;
     #99#1 = 1;
|FRUT;

|RUTINA ClaveAlta99_1;
     #99#0 = 0;
     #99#1 = 99999;
|FRUT;

|RUTINA ClaveBaja99_2;
     #99#0 = 1;
     #99#1 = 1;
|FRUT;

|RUTINA ClaveAlta99_2;
     #99#0 = 99999999;
     #99#1 = 99999;
|FRUT;

|PROCESO Tipo3;
     |ABRE #602;
     #602#0 = #0#1;
     |LEE 040#602=;
     |SI FSalida ! 0;   |CIERRA #602;  |ACABA;  |FINSI;
     |CIERRA #602;

     aDCerrado = "01.01.0000";
     aHCerrado = "31.12.2999";
     aDConfid  = "N";
     aHConfid  = "S";
     |SI #0#3 ! 0;
         |SI #0#37 = "S";
             aDCerrado = "01.01.1900";
             aHCerrado = "31.12.2999";
         |FINSI;
         |SI #0#38 = "N";
             aDConfid  = "N";
             aHConfid  = "N";
         |FINSI;
     |FINSI;

     |ABRE #604;
     |LEE 040#604u;
     |SI FSalida ! 0;  |DDEFECTO #604;  |FINSI;

     |HORA aAlfa;
     aAlfa1 = aAlfa % 102;
     aAlfa2 = aAlfa % 402;

     #604#0  = #604#0 + 1;
     #604#1  = ~;
     #604#2  = aAlfa1;
     #604#3  = aAlfa2;
     #604#4  = #0#1;
     #604#5  = #0#2;
     #604#6  = #602#4;
     #604#10 = #602#5;

     |GRABA 020#604n;
     |LIBERA #604;
     |CIERRA #604;

     aFichero = ("b3" + Usuario + "zzzzzzzz") % 108;  |NOME_DAT #99 aFichero;
     |ABRE #99;  |CIERRA #99;  |DELINDEX #99;

     |ABRE #99;
     |SI #0#0 ! 0;
         |ABRE #100;
         |BUCLE abom0605;
         |CIERRA #100;
     |SINO;
         |SI #602#5 = "C";
             |BUCLE asclient;
         |SINO;
             |SI #0#3 ! 0;
                 |BUCLE abom0001_1;
             |SINO;
                 |PARA nCampo = 5;  |SI nCampo [ 22;  |HACIENDO nCampo = nCampo + 1;
                       |SI #0nCampo ! 0;
                           #0#3 = #0nCampo;
                           #0#4 = #0nCampo;
                           |BUCLE abom0001_2;
                       |FINSI;
                 |SIGUE;
             |FINSI;
         |FINSI;
     |FINSI;
     |CIERRA #99;

     |SI aParametro ! "DIRECTO";
         |SI #602#5 = "C";
             |C_M #99#0, 1, "N";
             |ENTLINEAL #1#99, -2, 2, 22, 1, ClaveBaja99_1, ClaveAlta99_1;
         |SINO;
             |C_M #99#1, 1, "N";
             |ENTLINEAL #1#99, -1, 2, 22, 1, ClaveBaja99_2, ClaveAlta99_2;
         |FINSI;
     |FINSI;

     |ABRE #100;
     |ABRE #605;
     |BUCLE abow0014;
     |CIERRA #100;
     |CIERRA #605;

     |DELINDEX #99;
|FPRC;

|PROGRAMA;
     |HAZ LeeUnidadBasico;

     |ABRE #514;
     |LEE 040#514p;
     |SI FSalida ! 0;  |DDEFECTO #514;  |FINSI;
     |CIERRA #514;

     aParametro = PARAMETRO;

     |SI aParametro = "DIRECTO";
         #0#0  = 0;
         #0#1  = enMailing;
         #0#3  = 0;
         #0#5  = enExped;
         #0#41 = "S";
         #0#42 = "S";
         |HAZ Tipo3;

         |ACABA;
     |FINSI;

     |SI aParametro = "CARPETA1"; |O aParametro = "CARPETA2";
      |O aParametro = "CARPETA3";
         |ABRE #606;
         |LEE 040#606p;
         |SI FSalida ! 0;
             |CIERRA #606;
             |SUB_EJECUTA "abom0606";

             |ABRE #606;
             |LEE 040#606p;
             |SI FSalida ! 0;  |CIERRA #606;  |ACABA;  |FINSI;
         |FINSI;
         |CIERRA #606;

         nMailing = 0;
         |SI aParametro = "CARPETA1";  nMailing = #606#1;  |FINSI;
         |SI aParametro = "CARPETA2";  nMailing = #606#3;  |FINSI;
         |SI aParametro = "CARPETA3";  nMailing = #606#5;  |FINSI;

         |SI nMailing = 0;  |ACABA;  |FINSI;
     |FINSI;

     |CLS;
     |PINPA #0#0;

     |SI enExped ! 0;
         |PARA nCampo = 0;  |SI nCampo [ 38;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
         |SIGUE;
         #0#0 = 0;
         #0#3 = 0;
         #0#5 = enExped;
         |SI nMailing ! 0;
             #0#1 = nMailing;  |PINTA #0#1;
             |HAZ EstaElMailing;
         |SINO;
             |C_M #0#1, 1, "S";
         |FINSI;
     |FINSI;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;  |HAZ Tipo3;  |FINSI;
|FPRO;
