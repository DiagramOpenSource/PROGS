|FICHEROS;
     asparcia #0;
|FIN;

|VARIABLES;
     &enSwEstaPlan = 0;
     aMensaje = "";

 {-1}menu = "";
     menu1 = "2400";
     menu2 = "1";
     menu3 = "";
     menu4 = "CSAPUM";
     menu5 = "   Clave   ";
     menu6 = " Siguiente ";
     menu7 = " Anterior ";
     menu8 = " Primera ";
     menu9 = "  Ultima  ";
     menu10 = " Modificar ";

     nHayReg = 0;

     &eaCta = "";
|FIN;

|PROGRAMA;
   |C_M #0#0, 1, "N";
   |C_M #0#1, 1, "N";
   |C_M #0#2, 1, "N";
   |C_M #0#3, 1, "N";
   |C_M #0#4, 1, "N";
   |C_M #0#5, 1, "N";
   |C_M #0#6, 1, "N";
   |C_M #0#7, 1, "N";
   |C_M #0#8, 1, "N";
   |C_M #0#9, 1, "N";
   |C_M #0#10, 1, "N";
   |C_M #0#11, 1, "N";
   |C_M #0#12, 1, "N";
   |C_M #0#13, 1, "N";
   |C_M #0#14, 1, "N";
   |C_M #0#15, 1, "N";
   |CLS; nHayReg = 0;
   |PINPA #0#0; |PINDA #0#0;
   |CABEZA "Consulta Cobros";
   |ABRE #0;
   FSalida = 999;
   |PARA ; |SI FSalida > 0; |HACIENDO;
        |MENU menu;
        menu2 = FSalida;
        |SI FSalida = 0; |O FSalida = -1; |SAL; |FINSI;
        |SI FSalida = 1;    ||Clave
             |HAZ clave;
             |LEE 001#0];
             |SI FSalida = 0; nHayReg = 1; |FINSI;
        |FINSI;
        |SI FSalida = 2;    ||Siguiente
             |LEE 001#0s;
             |SI FSalida ! 0;
                  |MENAV "0000Ultima Ficha";
                  |LEE 001#0=;
             |FINSI;
             |SI FSalida = 0; nHayReg = 1; |FINSI;
        |FINSI;
        |SI FSalida = 3;    ||Anterior
             |LEE 001#0a;
             |SI FSalida ! 0;
                  |MENAV "0000Primera Ficha";
                  |LEE 001#0=;
             |FINSI;
             |SI FSalida = 0; nHayReg = 1; |FINSI;
        |FINSI;
        |SI FSalida = 4;    ||Primera
             |LEE 001#0p;
             |SI FSalida = 0; nHayReg = 1; |FINSI;
        |FINSI;
        |SI FSalida = 5;    ||Ultima
             |LEE 001#0u;
             |SI FSalida = 0; nHayReg = 1; |FINSI;
        |FINSI;
        |SI FSalida = 6;    ||Modificar
             |SI nHayReg = 1;
               |LEE 101#0c;
               |SI #0#10 = "S";
                  |MENAV "0000No se puede modificar este cobro, Esta Contabilizado";
               |SINO;
                  |CAMPO_MODIFICA #0#13 , 1 , "S";
                  |ENCAMPO #13#0;
                  |CAMPO_MODIFICA #0#13 , 1 , "N";
                  |SI FSalida = 0;
                       |GRABA 021#0a;
                  |SINO;
                       |LEE 001#0c;
                  |FINSI;
               |FINSI;
               |LIBERA #0;
             |FINSI;
        |FINSI;
        |PINDA #0#0;
        FSalida = 999;
   |SIGUE;
   |CIERRA #0;
|FPRO;

|PROCESO clave;
     |CAMPO_MODIFICA #0#0 , 1 , "S";
     |CAMPO_MODIFICA #0#1 , 1 , "S";
     |CAMPO_MODIFICA #0#2 , 1 , "S";
     |ET campo0;
     |ENCAMPO #0#0;
     |ENCAMPO #1#0;
     |SI FSalida = 2; |VETE campo0; |FINSI;
     |ET campo1;
     |ENCAMPO #2#0;
     |SI FSalida = 2; |VETE campo1; |FINSI;
     |CAMPO_MODIFICA #0#0 , 1 , "N";
     |CAMPO_MODIFICA #0#1 , 1 , "N";
     |CAMPO_MODIFICA #0#2 , 1 , "N";
|FPRC;

|PROCESO MCtaCob; |TIPO 0;
     eaCta = #0Campo;
     |HAZ MFiltraPtos;
     #0Campo = eaCta; |PINTA #0Campo;

     |HAZ EsVisados;
     |SI FSalida = 0;
          |HAZ EstaPlanContable;
          |SI enSwEstaPlan = 0;
               aMensaje = "0000Cuenta no definida en Plan Contable";
               |MENAV aMensaje; |ERROR;
          |FINSI;
     |FINSI;
|FPRC;
