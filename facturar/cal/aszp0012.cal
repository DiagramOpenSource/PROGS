|FICHEROS;
     aszp0012 #0;
     ascuocab #1;
     asconcli #2;
     asconlin #3;
     asexpeli #4;
     ashiscon #5;
     ashismic #6;
     ashismil #7;
     aslinmin #8;
     asm00013 #9;
     asmovtos #10;
     abom0001 #11;
     abom0005 #12;
     abom0008 #13;
     abom0010 #14;
     asconcep #15;
     abom0509 #16;
     abom0510 #17;
     asconmen #18;
     ascuenco #19;
     asenlcon #20;
     asm00001 #21;

     asclient #99;
|FIN;

|VARIABLES;
     aFichero      = "";
     aParametro    = "";
     aAlfa         = "";
     aSeccio       = "";

     nSwHay        = 0;
     nPerio1       = 0;
     nPerio2       = 0;
     nGraba        = 0;
|FIN;

|PROCESO asconlin_2;
     |BORRA 020#3a;

     |SI nGraba = 0;  |ACABA;  |FINSI;

     #3#1 = #1#0;
     #3#2 = #0#3;
     #3#3 = "";
     |GRABA 020#3n;
     |LIBERA #3;
|FPRC;

|DEFBUCLE asconlin_2;
     #3#1;
     ;
     2, #2#0, #2#1, #2#2, 000;
     2, #2#0, #2#1, #2#2, 999;
     be;
     NULL, asconlin_2;
|FIN;

|PROCESO asconcli;
     |BORRA 020#2a;

     |SALVA_DATOS #2;

     #2#0 = #1#0;
     #2#1 = #0#3;
     #2#2 = "";
     |LEE 101#2=;
     |SI FSalida ! 0;
         |REPON_DATOS #2;

         nGraba = 1;
         |BUCLE asconlin_2;

         #2#1 = #0#3;
         #2#2 = "";
         |GRABA 020#2n;
     |SINO;
         nPerio1 = #2#4;
         |REPON_DATOS #2;
         nPerio2 = #2#4;

         nGraba = 0;
         |BUCLE asconlin_2;

         |SI nPerio1 = 0;  |Y nPerio2 ! 0;
             #2#0 = #1#0;
             #2#1 = #0#3;
             #2#2 = "";
             |LEE 101#2=;
             |SI FSalida = 0;
                 #2#4 = nPerio2;
                 |GRABA 020#2a;
             |FINSI;
         |FINSI;
     |FINSI;
     |LIBERA #2;
|FPRC;

|DEFBUCLE asconcli;
     #2#1;
     ;
     #1#0, #1#3, "    ";
     #1#0, #1#3, "zzzz";
     be;
     NULL, asconcli;
|FIN;

|PROCESO ascuocabP;
     #0#0 = #1#3;
     #0#1 = #1#4;
     #0#2 = #1#2;
     |LEE 000#0=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BUCLE asconcli;

     #99#0 = #1#0;
     |LEE 000#99=;
     |SI FSalida ! 0;  |DDEFECTO #99;  |FINSI;

     #1#1 = #99#1;
     #1#3 = #0#3;
     #1#4 = "";
     |GRABA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE ascuocabP;
     #1#2;
     ;
     00000, 9999;
     99999, 0001;
     be;
     NULL, ascuocabP;
|FIN;

|PROCESO asexpeli;
     #0#0 = #4#4;
     #0#1 = #4#5;
     |LEE 000#0=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aAlfa = #4#3 % -104;

     #1#0  = #4#1;
     #1#8  = aAlfa;
     |LEE 000#1=;
     |SI FSalida = 0;
         #4#4 = #1#3;
     |SINO;
         #1#0  = #4#1;
         #1#8  = 0000;
         |LEE 000#1];
         |SI FSalida = 0;  |Y #1#0 = #4#1;
             #4#4 = #1#3;
         |SINO;
             |SI #4#5 = "01";     #4#4 = "CU01";  |FINSI;
             |SI #4#5 = "03";     #4#4 = "CU04";  |FINSI;
             |SI #4#5 = "06";     #4#4 = "CU06";  |FINSI;
             |SI #4#5 = "12";     #4#4 = "CU12";  |FINSI;
             |SI #4#5 = "  ";     #4#4 = "CU01";  |FINSI;
             |SI #4#4 = "CUOT";
                 #4#4 = "CU" + #4#5;
             |FINSI;
         |FINSI;
     |FINSI;

     #4#5 = "";
     |GRABA 020#4a;
     |LIBERA #4;
|FPRC;

|DEFBUCLE asexpeli;
     #4#2;
     ;
     "CUOT", "  ", 00000;
     "CUOT", "zz", 99999;
     be;
     NULL, asexpeli;
|FIN;

|PROCESO ashiscon;
     #0#0 = #5#5;
     #0#1 = #5#6;
     |LEE 000#0=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aAlfa = #5#3 % -104;

     #1#0  = #5#4;
     #1#8  = aAlfa;
     |LEE 000#1=;
     |SI FSalida = 0;
         #5#5 = #1#3;
     |SINO;
         #1#0  = #5#4;
         #1#8  = 0000;
         |LEE 000#1];
         |SI FSalida = 0;  |Y #1#0 = #5#4;
             #5#5 = #1#3;
         |SINO;
             |SI #5#6 = "01";   #5#5 = "CU01";  |FINSI;
             |SI #5#6 = "03";   #5#5 = "CU04";  |FINSI;
             |SI #5#6 = "06";   #5#5 = "CU06";  |FINSI;
             |SI #5#6 = "12";   #5#5 = "CU12";  |FINSI;
             |SI #5#6 = "  ";   #5#5 = "CU01";  |FINSI;
             |SI #5#5 = "CUOT";
                 #5#5 = "CU" + #5#6;
             |FINSI;
         |FINSI;
     |FINSI;

     #5#6 = "";
     |GRABA 020#5a;
     |LIBERA #5;
|FPRC;

|DEFBUCLE ashiscon;
     #5#5;
     ;
     "CUOT", "  ", "  ", 00000, 000;
     "CUOT", "zz", "zz", 99999, 999;
     be;
     NULL, ashiscon;
|FIN;

|PROCESO ashismil;
     #0#0 = #7#4;
     #0#1 = #7#5;
     |LEE 000#0=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     #6#0 = #7#0;
     #6#1 = #7#1;
     |LEE 000#6=;
     |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;

     aAlfa = #7#3 % -104;

     #1#0  = #6#3;
     #1#8  = aAlfa;
     |LEE 000#1=;
     |SI FSalida = 0;
         #7#4 = #1#3;
     |SINO;
         #1#0  = #6#3;
         #1#8  = 0000;
         |LEE 000#1];
         |SI FSalida = 0;  |Y #1#0 = #6#3;
             #7#4 = #1#3;
         |SINO;
             |SI #7#5 = "01";   #7#4 = "CU01";  |FINSI;
             |SI #7#5 = "03";   #7#4 = "CU04";  |FINSI;
             |SI #7#5 = "06";   #7#4 = "CU06";  |FINSI;
             |SI #7#5 = "12";   #7#4 = "CU12";  |FINSI;
             |SI #7#5 = "  ";   #7#4 = "CU01";  |FINSI;
             |SI #7#4 = "CUOT";
                 #7#4 = "CU" + #7#5;
             |FINSI;
         |FINSI;
     |FINSI;

     #7#5 = "";
     |GRABA 020#7a;
     |LIBERA #7;
|FPRC;

|DEFBUCLE ashismil;
     #7#3;
     ;
     "CUOT", "  ";
     "CUOT", "zz";
     be;
     NULL, ashismil;
|FIN;

|PROCESO aslinmin;
     #0#0 = #8#4;
     #0#1 = #8#5;
     |LEE 000#0=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aAlfa = #8#15 % -104;

     #1#0  = #8#1;
     #1#8  = aAlfa;
     |LEE 000#1=;
     |SI FSalida = 0;
         #8#4 = #1#3;
     |SINO;
         #1#0  = #8#1;
         #1#8  = 0000;
         |LEE 000#1];
         |SI FSalida = 0;  |Y #1#0 = #8#1;
             #8#4 = #1#3;
         |SINO;
             |SI #8#5 = "01";   #8#4 = "CU01";  |FINSI;
             |SI #8#5 = "03";   #8#4 = "CU04";  |FINSI;
             |SI #8#5 = "06";   #8#4 = "CU06";  |FINSI;
             |SI #8#5 = "12";   #8#4 = "CU12";  |FINSI;
             |SI #8#5 = "  ";   #8#4 = "CU01";  |FINSI;
             |SI #8#4 = "CUOT";
                 #8#4 = "CU" + #8#5;
             |FINSI;
         |FINSI;
     |FINSI;

     #8#5 = "";
     |GRABA 020#8a;
     |LIBERA #8;
|FPRC;

|DEFBUCLE aslinmin;
     #8#3;
     ;
     "CUOT", "  ", 00000;
     "CUOT", "zz", 99999;
     be;
     NULL, aslinmin;
|FIN;

|PROCESO asm00013;
     #0#0 = #9#6;
     #0#1 = #9#7;
     |LEE 000#0=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #9#10 = "N";
         #8#0 = #9#0;
         #8#1 = #9#1;
         #8#2 = #9#4;
         |LEE 000#8=;
         |SI FSalida ! 0;  |DDEFECTO #8;  |FINSI;

         aAlfa = #8#15 % -104;
     |SINO;
         #7#0 = #9#2;
         #7#1 = #9#3;
         #7#2 = #9#4;
         |LEE 000#7=;
         |SI FSalida ! 0;  |DDEFECTO #7;  |FINSI;

         aAlfa = #7#3 % -104;
     |FINSI;

     #1#0  = #9#1;
     #1#8  = aAlfa;
     |LEE 000#1=;
     |SI FSalida = 0;
         #9#6 = #1#3;
     |SINO;
         #1#0  = #9#1;
         #1#8  = 0000;
         |LEE 000#1];
         |SI FSalida = 0;  |Y #1#0 = #9#1;
             #9#6 = #1#3;
         |SINO;
             |SI #9#7 = "01";   #9#6 = "CU01";  |FINSI;
             |SI #9#7 = "03";   #9#6 = "CU04";  |FINSI;
             |SI #9#7 = "06";   #9#6 = "CU06";  |FINSI;
             |SI #9#7 = "12";   #9#6 = "CU12";  |FINSI;
             |SI #9#7 = "  ";   #9#6 = "CU01";  |FINSI;
             |SI #9#6 = "CUOT";
                 #9#6 = "CU" + #9#7;
             |FINSI;
         |FINSI;
     |FINSI;

     #9#7 = "";
     |GRABA 020#9a;
     |LIBERA #9;
|FPRC;

|DEFBUCLE asm00013;
     #9#2;
     ;
     "CUOT", "  ", 00000;
     "CUOT", "zz", 99999;
     be;
     NULL, asm00013;
|FIN;

|PROCESO asmovtos;
     #0#0 = #10#4;
     #0#1 = #10#5;
     |LEE 000#0=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aAlfa = #10#1 % -104;

     #1#0  = #10#9;
     #1#8  = aAlfa;
     |LEE 000#1=;
     |SI FSalida = 0;
         #10#4 = #1#3;
     |SINO;
         #1#0  = #10#9;
         #1#8  = 0000;
         |LEE 000#1];
         |SI FSalida = 0;  |Y #1#0 = #10#9;
             #10#4 = #1#3;
         |SINO;
             |SI #10#5 = "01";   #10#4 = "CU01";  |FINSI;
             |SI #10#5 = "03";   #10#4 = "CU04";  |FINSI;
             |SI #10#5 = "06";   #10#4 = "CU06";  |FINSI;
             |SI #10#5 = "12";   #10#4 = "CU12";  |FINSI;
             |SI #10#5 = "  ";   #10#4 = "CU01";  |FINSI;
             |SI #10#4 = "CUOT";
                 #10#4 = "CU" + #10#5;
             |FINSI;
         |FINSI;
     |FINSI;

     #10#5 = "";
     |GRABA 020#10a;
     |LIBERA #10;
|FPRC;

|DEFBUCLE asmovtos;
     #10#2;
     ;
     "CUOT", "  ", 00000;
     "CUOT", "zz", 99999;
     be;
     NULL, asmovtos;
|FIN;

|PROCESO abom0005;
     #0#0 = #12#5;
     #0#1 = #12#6;
     |LEE 000#0=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aAlfa = #12#4 % -104;

     #11#0 = #12#0;
     |LEE 000#11=;
     |SI FSalida ! 0;  |DDEFECTO #11;  |FINSI;

     #1#0  = #11#3;
     #1#8  = aAlfa;
     |LEE 000#1=;
     |SI FSalida = 0;
         #12#5 = #1#3;
     |SINO;
         #1#0  = #11#3;
         #1#8  = 0000;
         |LEE 000#1];
         |SI FSalida = 0;  |Y #1#0 = #11#3;
             #12#5 = #1#3;
         |SINO;
             |SI #12#6 = "01";   #12#5 = "CU01";  |FINSI;
             |SI #12#6 = "03";   #12#5 = "CU04";  |FINSI;
             |SI #12#6 = "06";   #12#5 = "CU06";  |FINSI;
             |SI #12#6 = "12";   #12#5 = "CU12";  |FINSI;
             |SI #12#6 = "  ";   #12#5 = "CU01";  |FINSI;
             |SI #12#5 = "CUOT";
                 #12#5 = "CU" + #12#6;
             |FINSI;
         |FINSI;
     |FINSI;

     #12#6 = "";
     |GRABA 020#12a;
     |LIBERA #12;
|FPRC;

|DEFBUCLE abom0005;
     #12#3;
     ;
     "CUOT", "  ";
     "CUOT", "zz";
     be;
     NULL, abom0005;
|FIN;

|PROCESO abom0008;
     #0#0 = #13#5;
     #0#1 = #13#6;
     |LEE 000#0=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aAlfa = #13#4 % -104;

     #1#0  = #13#0;
     #1#8  = aAlfa;
     |LEE 000#1=;
     |SI FSalida = 0;
         #13#5 = #1#3;
     |SINO;
         #1#0  = #13#0;
         #1#8  = 0000;
         |LEE 000#1];
         |SI FSalida = 0;  |Y #1#0 = #13#0;
             #13#5 = #1#3;
         |SINO;
             |SI #13#6 = "01";   #13#5 = "CU01";  |FINSI;
             |SI #13#6 = "03";   #13#5 = "CU04";  |FINSI;
             |SI #13#6 = "06";   #13#5 = "CU06";  |FINSI;
             |SI #13#6 = "12";   #13#5 = "CU12";  |FINSI;
             |SI #13#6 = "  ";   #13#5 = "CU01";  |FINSI;
             |SI #13#5 = "CUOT";
                 #13#5 = "CU" + #13#6;
             |FINSI;
         |FINSI;
     |FINSI;

     #13#6 = "";
     |GRABA 020#13a;
     |LIBERA #13;
|FPRC;

|DEFBUCLE abom0008;
     #13#3;
     ;
     "CUOT", "  ", 00000;
     "CUOT", "zz", 99999;
     be;
     NULL, abom0008;
|FIN;

|PROCESO abom0010;
     #0#0 = #14#6;
     #0#1 = #14#7;
     |LEE 000#0=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aAlfa = #14#2 % -104;

     #1#0  = #14#1;
     #1#8  = aAlfa;
     |LEE 000#1=;
     |SI FSalida = 0;
         #14#6 = #1#3;
     |SINO;
         #1#0  = #14#1;
         #1#8  = 0000;
         |LEE 000#1];
         |SI FSalida = 0;  |Y #1#0 = #14#1;
             #14#6 = #1#3;
         |SINO;
             |SI #14#7 = "01";   #14#6 = "CU01";  |FINSI;
             |SI #14#7 = "03";   #14#6 = "CU04";  |FINSI;
             |SI #14#7 = "06";   #14#6 = "CU06";  |FINSI;
             |SI #14#7 = "12";   #14#6 = "CU12";  |FINSI;
             |SI #14#7 = "  ";   #14#6 = "CU01";  |FINSI;
             |SI #14#6 = "CUOT";
                 #14#6 = "CU" + #14#7;
             |FINSI;
         |FINSI;
     |FINSI;

     #14#7 = "";
     |GRABA 020#14a;
     |LIBERA #14;
|FPRC;

|DEFBUCLE abom0010;
     #14#4;
     ;
     "CUOT", "  ", 00000;
     "CUOT", "zz", 99999;
     be;
     NULL, abom0010;
|FIN;

|PROCESO asconlin_3;
     |BORRA 020#3a;
     |SI nGraba = 0;  |ACABA;  |FINSI;

     #3#2 = #0#3;
     #3#3 = "";
     |GRABA 020#3n;
     |LIBERA #3;
|FPRC;

|DEFBUCLE asconlin_3;
     #3#1;
     ;
     3, 0, #18#0, #18#1, 000;
     3, 0, #18#0, #18#1, 999;
     be;
     NULL, asconlin_3;
|FIN;

|PROCESO asconmen;
     #0#0 = #18#0;
     #0#1 = #18#1;
     |LEE 000#0=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nGraba = 1;
     |SALVA_DATOS #18;

     aSeccio = #18#0;
     |SI #18#1 = "01";   aSeccio  = "CU01";  |FINSI;
     |SI #18#1 = "03";   aSeccio  = "CU04";  |FINSI;
     |SI #18#1 = "06";   aSeccio  = "CU06";  |FINSI;
     |SI #18#1 = "12";   aSeccio  = "CU12";  |FINSI;
     |SI #18#1 = "  ";   aSeccio  = "CU01";  |FINSI;
     |SI aSeccio = "CUOT";
         aSeccio = "CU" + #18#1;
     |FINSI;

     #18#0 = aSeccio;
     #18#1 = "";
     |LEE 101#18=;
     |SI FSalida ! 0;
         |REPON_DATOS #18;
         |LEE 101#18=;
         |SI FSalida = 0;
             |BUCLE asconlin_3;
             |BORRA 020#18a;
             |LIBERA #18;
         |FINSI;

         #18#0 = aSeccio;
         #18#1 = "";
         |GRABA 020#18n;
         |LIBERA #18;
     |SINO;
         nGraba = 0;
         |REPON_DATOS #18;

         |LEE 101#18=;
         |SI FSalida = 0;
             |BUCLE asconlin_3;
             |BORRA 020#18a;
             |LIBERA #18;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE asconmen;
     #18#1;
     ;
     "CUOT", "  ";
     "CUOT", "zz";
     be;
     NULL, asconmen;
|FIN;

|PROCESO ascuenco;
     #0#0 = #19#0;
     #0#1 = #19#1;
     |LEE 000#0=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SALVA_DATOS #19;

     aSeccio = #19#0;
     |SI #19#1 = "01";   aSeccio  = "CU01";  |FINSI;
     |SI #19#1 = "03";   aSeccio  = "CU04";  |FINSI;
     |SI #19#1 = "06";   aSeccio  = "CU06";  |FINSI;
     |SI #19#1 = "12";   aSeccio  = "CU12";  |FINSI;
     |SI #19#1 = "  ";   aSeccio  = "CU01";  |FINSI;
     |SI aSeccio = "CUOT";
         aSeccio = "CU" + #19#1;
     |FINSI;

     #19#0 = aSeccio;
     #19#1 = "";
     |LEE 101#19=;
     |SI FSalida ! 0;
         |REPON_DATOS #19;
         |LEE 101#19=;
         |SI FSalida = 0;
             |BORRA 020#19a;
             |LIBERA #19;
         |FINSI;

         #19#0 = aSeccio;
         #19#1 = "";
         |GRABA 020#19n;
         |LIBERA #19;
     |SINO;
         |REPON_DATOS #19;
         |LEE 101#19=;
         |SI FSalida = 0;
             |BORRA 020#19a;
             |LIBERA #19;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE ascuenco;
     #19#1;
     ;
     "CUOT", "  ";
     "CUOT", "zz";
     be;
     NULL, ascuenco;
|FIN;

|PROCESO asenlcon;
     #0#0 = #20#0;
     #0#1 = #20#1;
     |LEE 000#0=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SALVA_DATOS #20;

     aSeccio = #20#0;
     |SI #20#1 = "01";   aSeccio  = "CU01";  |FINSI;
     |SI #20#1 = "03";   aSeccio  = "CU04";  |FINSI;
     |SI #20#1 = "06";   aSeccio  = "CU06";  |FINSI;
     |SI #20#1 = "12";   aSeccio  = "CU12";  |FINSI;
     |SI #20#1 = "  ";   aSeccio  = "CU01";  |FINSI;
     |SI aSeccio = "CUOT";
         aSeccio = "CU" + #20#1;
     |FINSI;

     #20#0 = aSeccio;
     #20#1 = "";
     |LEE 101#20=;
     |SI FSalida ! 0;
         |REPON_DATOS #20;
         |LEE 101#20=;
         |SI FSalida = 0;
             |BORRA 020#20a;
             |LIBERA #20;
         |FINSI;

         #20#0 = aSeccio;
         #20#1 = "";
         |GRABA 020#20n;
         |LIBERA #20;
     |SINO;
         |REPON_DATOS #20;
         |LEE 101#20=;
         |SI FSalida = 0;
             |BORRA 020#20a;
             |LIBERA #20;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE asenlcon;
     #20#1;
     ;
     "CUOT", "  ";
     "CUOT", "zz";
     be;
     NULL, asenlcon;
|FIN;

|PROCESO asm00001;
     #0#0 = #21#0;
     #0#1 = #21#1;
     |LEE 000#0=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SALVA_DATOS #21;

     aSeccio = #21#0;
     |SI #21#1 = "01";   aSeccio  = "CU01";  |FINSI;
     |SI #21#1 = "03";   aSeccio  = "CU04";  |FINSI;
     |SI #21#1 = "06";   aSeccio  = "CU06";  |FINSI;
     |SI #21#1 = "12";   aSeccio  = "CU12";  |FINSI;
     |SI #21#1 = "  ";   aSeccio  = "CU01";  |FINSI;
     |SI aSeccio = "CUOT";
         aSeccio = "CU" + #21#1;
     |FINSI;

     #21#0 = aSeccio;
     #21#1 = "";
     |LEE 101#21=;
     |SI FSalida ! 0;
         |REPON_DATOS #21;
         |LEE 101#21=;
         |SI FSalida = 0;
             |BORRA 020#21a;
             |LIBERA #21;
         |FINSI;

         #21#0 = aSeccio;
         #21#1 = "";
         |GRABA 020#21n;
         |LIBERA #21;
     |SINO;
         |REPON_DATOS #21;
         |LEE 101#21=;
         |SI FSalida = 0;
             |BORRA 020#21a;
             |LIBERA #21;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE asm00001;
     #21#1;
     ;
     "CUOT", "  ";
     "CUOT", "zz";
     be;
     NULL, asm00001;
|FIN;

|PROCESO asconlin_1;
     |BORRA 020#3a;
     |SI nGraba = 0;  |ACABA;  |FINSI;

     #3#2 = #0#3;
     #3#3 = "";
     |GRABA 020#3n;
     |LIBERA #3;
|FPRC;

|DEFBUCLE asconlin_1;
     #3#1;
     ;
     1, 0, #15#0, #15#1, 000;
     1, 0, #15#0, #15#1, 999;
     be;
     NULL, asconlin_1;
|FIN;

|PROCESO abom0510;
     |BORRA 020#17a;
     |LIBERA #17;
|FPRC;

|DEFBUCLE abom0510;
     #17#1;
     ;
     #16#0, 001;
     #16#0, 999;
     be;
     NULL, abom0510;
|FIN;

|PROCESO abom0509;
     #1#3 = #16#0;
     |LEE 000#1=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     |BUCLE abom0510;

     |BORRA 020#16a;
     |LIBERA #16;

     #15#0 = #16#0;
     #15#1 = "";
     |LEE 101#15=;
     |SI FSalida = 0;
         nGraba = 0;
         |BUCLE asconlin_1;
         |BORRA 020#15a;
     |FINSI;
|FPRC;

|DEFBUCLE abom0509;
     #16#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, abom0509;
|FIN;

|PROCESO asconcep;
     nGraba = 1;
     #15#0 = #0#0;
     #15#1 = #0#1;
     |LEE 000#15=;
     |SI FSalida = 0;
         |SALVA_DATOS #15;

         #15#0 = #0#3;
         #15#1 = "";
         |LEE 101#15=;
         |SI FSalida ! 0;
             |REPON_DATOS #15;
             #15#0 = #0#3;
             #15#1 = "";
             |GRABA 020#15n;
             |LIBERA #15;
         |SINO;
             nGraba = 0;
             |REPON_DATOS #15;
         |FINSI;

         #15#0 = #0#0;
         #15#1 = #0#1;
         |LEE 101#15=;
         |SI FSalida = 0;
             |BUCLE asconlin_1;
             |BORRA 020#15a;
             |LIBERA #15;
         |FINSI;
     |FINSI;

     #15#0 = #0#3;
     #15#1 = "";
     |LEE 101#15=;
     |SI FSalida ! 0;
         |DDEFECTO #15;
         #15#0 = #0#3;
         #15#1 = "";
         |GRABA 020#15b;
     |FINSI;

     aAlfa = #15#0 % -102;

     |SI aAlfa = "01";  #15#2 = "SERVICIOS MENSUALES";     |FINSI;
     |SI aAlfa = "04";  #15#2 = "SERVICIOS TRIMESTRALES";  |FINSI;
     |SI aAlfa = "06";  #15#2 = "SERVICIOS SEMESTRALES";   |FINSI;
     |SI aAlfa = "12";  #15#2 = "SERVICIOS ANUALES";       |FINSI;

     #15#16 = #15#2;

     |GRABA 020#15a;
     |LIBERA #15;

     |ABRE #3;
     #3#0 = 1;
     #3#1 = 0;
     #3#2 = #15#0;
     #3#3 = #15#1;
     #3#4 = 1;
     |LEE 101#3=;
     |SI FSalida ! 0;
         |DDEFECTO #3;
         #3#0 = 1;
         #3#1 = 0;
         #3#2 = #15#0;
         #3#3 = #15#1;
         #3#4 = 1;
         |GRABA 020#3b;
     |FINSI;
     #3#5 = #15#16;
     |GRABA 020#3a;
     |LIBERA #3;

     #16#0 = #15#0;
     |LEE 101#16=;
     |SI FSalida ! 0;
         |DDEFECTO #16;
         #16#0 = #15#0;
         #16#1 = #15#2;
         |SI aAlfa = "01";  #16#2 = "M";  |FINSI;
         |SI aAlfa = "04";  #16#2 = "T";  |FINSI;
         |SI aAlfa = "06";  #16#2 = "S";  |FINSI;
         |SI aAlfa = "12";  #16#2 = "A";  |FINSI;
         |GRABA 020#16n;

         |DDEFECTO #17;
         #17#0 = #16#0;
         #17#1 = 1;
         |GRABA 020#17n;
     |FINSI;
     |LIBERA #16;
|FPRC;

|PROCESO aszp0012;
     |HAZ asconcep;
|FPRC;

|DEFBUCLE aszp0012;
     #0#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, aszp0012;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |ABRE #0;
     |ABRE #2;
     |ABRE #99;
     |BUCLE ascuocabP;

     |ABRE #1;

     |SELECT #2#0;
     |BUCLE asexpeli;

     |BUCLE ashiscon;

     |ABRE #6;
     |BUCLE ashismil;
     |CIERRA #6;

     |BUCLE aslinmin;

     |ABRE #7;
     |ABRE #8;
     |BUCLE asm00013;
     |CIERRA #7;
     |CIERRA #8;

     |BUCLE asmovtos;

     |ABRE #11;
     |BUCLE abom0005;
     |CIERRA #11;

     |BUCLE abom0008;

     |BUCLE abom0010;

     |BUCLE asconmen;

     |BUCLE ascuenco;

     |BUCLE asenlcon;

     |BUCLE asm00001;

     |SELECT #3#1;

     |ABRE #15;
     |BUCLE abom0509;

     |ABRE #16;
     |ABRE #17;
     |BUCLE aszp0012;
     |CIERRA #15;
     |CIERRA #16;
     |CIERRA #17;

     |CIERRA #1;
     |CIERRA #0;
     |CIERRA #2;
     |CIERRA #99;
|FPRC;

|PROCESO Baja0;
     #0#0 = "";
     #0#1 = "";
     #0#2 = "";
|FPRC;

|PROCESO Alta0;
     #0#0 = "zzzz";
     #0#1 = "zz";
     #0#2 = "z";
|FPRC;

|PROCESO ascuocab;
     |SI #1#3 ! "CUOT";  |ACABA;  |FINSI;

     #0#0 = #1#3;
     #0#1 = #1#4;
     #0#2 = #1#2;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = #1#3;
         #0#1 = #1#4;
         #0#2 = #1#2;

         |SI #1#4 = "01";  |O #1#4 = "03";  |O #1#4 = "06";  |O #1#4 = "12";
             |SI #1#4 = "01"
                 #0#3 = "CU01";
                 |SI #1#2 = "T";  #0#3 = "CU04";  |FINSI;
                 |SI #1#2 = "S";  #0#3 = "CU06";  |FINSI;
                 |SI #1#2 = "A";  #0#3 = "CU12";  |FINSI;
             |FINSI;

             |SI #1#4 = "03"
                 #0#3 = "CU04";
                 |SI #1#2 = "M";  #0#3 = "CU01";  |FINSI;
                 |SI #1#2 = "S";  #0#3 = "CU06";  |FINSI;
                 |SI #1#2 = "A";  #0#3 = "CU12";  |FINSI;
             |FINSI;

             |SI #1#4 = "06"
                 #0#3 = "CU06";
                 |SI #1#2 = "M";  #0#3 = "CU01";  |FINSI;
                 |SI #1#2 = "T";  #0#3 = "CU04";  |FINSI;
                 |SI #1#2 = "A";  #0#3 = "CU12";  |FINSI;
             |FINSI;

             |SI #1#4 = "12"
                 #0#3 = "CU12";
                 |SI #1#2 = "M";  #0#3 = "CU01";  |FINSI;
                 |SI #1#2 = "T";  #0#3 = "CU04";  |FINSI;
                 |SI #1#2 = "S";  #0#3 = "CU06";  |FINSI;
             |FINSI;
         |SINO;
             #0#3 = #1#3;
             |SI #1#4 = "  ";
                 |SI #1#2 = "M";  #0#3 = "CU01";  |FINSI;
                 |SI #1#2 = "T";  #0#3 = "CU04";  |FINSI;
                 |SI #1#2 = "S";  #0#3 = "CU06";  |FINSI;
                 |SI #1#2 = "A";  #0#3 = "CU12";  |FINSI;
             |FINSI;
             |SI #0#3 = "CUOT";
                 #0#3 = "CU" + #1#4;
             |FINSI;
         |FINSI;

         |GRABA 020#0n;
         nSwHay = 1;
     |FINSI;
     |LIBERA #0;
|FPRC;

|DEFBUCLE ascuocab;
     #1#1;
     ;
     00000, 0000;
     99999, 9999;
     ;
     NULL, ascuocab;
|FIN;

|PROGRAMA;
    aParametro = PARAMETRO;  |QBF aParametro;

    aFichero = ("w12" + Usuario + "zzzzzzzz") % 108;
    |NOME_DAT #0 aFichero;
    |ABRE #0;  |CIERRA #0;  |DELINDEX #0;

    nSwHay = 0;
    |ABRE #0;
    |BUCLE ascuocab;
    |CIERRA #0;

    |SI nSwHay = 0;
        |ABRE #0;  |CIERRA #0;  |DELINDEX #0;
        |SI aParametro = "";
            |MENAV "0000 No hay Productos para cambiar.";
        |FINSI;
        |ACABA;
    |FINSI;

    |SI aParametro = "";
        |ENTLINEAL #1#0, 1, 4, 22, 1, Baja0, Alta0;
        |CONFI "0000NDesea hacer el pase en estos momentos.";
        |SI FSalida = 0;
            |HAZ Tipo3;
        |FINSI;
    |SINO;
        |HAZ Tipo3;
    |FINSI;

    |ABRE #0;  |CIERRA #0;  |DELINDEX #0;
|FPRO;
