|FICHEROS;
     asexpimp #0;
     asexpeca #1;
     asexpeli #2;
     asclient #3;
     asempres #4;
|FIN;

|VARIABLES;
     &vacio    = "                                        ";
     &pobla    = "";
     &fecha_p  = "";
     &importe  = 0;

     mensaje   = "";
     sw        = 0;
     fecha     = @;
     informe   = "";

     aAlfa  = "";
     aAlfa1 = "";
|FIN;

|PROCESO imp_exp;
     importe = 0;
     |HAZ pobla;
     sw = 0;
     mensaje = "Imprimiendo Expediente : " + #1#0 + "/" + #1#14;
     |PINTA 2420 , mensaje;
     #3#0 = #1#1;
     |LEE 001#3=;
     |SI FSalida ! 0; |DDEFECTO #3; |FINSI;
|FPRC;

|PROCESO lin_exp;
|SI #0#4 = #2#15; |O #0#4 = "T";
    |SI #2#10 = "H"; importe = importe + #2#13; |FINSI;
    |SI #2#10 = "S"; importe = importe + #2#13; |FINSI;
    |SI #2#10 = "A"; importe = importe - #2#13; |FINSI;

    sw = 1;
    |PRINT;
|FINSI;
|FPRC;

|PROCESO fin_exp;
|SI sw = 1; |PIEINF; |FINSI;
|FPRC;

|DEFBUCLE lee_exp;
#1#1;
;
#0#0 , #0#2;
#0#1 , #0#3;
e;
NULL , imp_exp , lin_exp , fin_exp;
|FIN;

|PROCESO inicio;
|IMPRE 0;
|SI FSalida ! 0; |ACABA; |FINSI;

informe = #0#6;  |QBF informe;
|INFOR informe;
|SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;

|ABRE #3;
|BUCLE lee_exp;
|CIERRA #3;
|FININF;
|FINIMP;
|FPRC;

|PROCESO pobla;
|ABRE #4;
#4#0 = #0#5;
|LEE 040#4=;
|SI FSalida ! 0; |DDEFECTO #4; |FINSI;
|CIERRA #4;

fecha   = #1#3;
fecha   = fecha % 2;
fecha_p = fecha % 1130;
pobla   = #4#3; |QBF pobla;

fecha_p = pobla + ",  " + fecha_p;
|FPRC;

|PROGRAMA;
   |ABRE #asexpimp;
   |LEE 000#asexpimp.p;
   |SI FSalida ! 0;
      |DDEFECTO #asexpimp;
      |GRABA 020#asexpimp.c;
   |FINSI;
   |SI PARAMETRO = "";
      |CLS;
      |CABEZA " Informe expedientes";
      |PINPA #0#0; |PINDA #0#0;
      |ENDATOS #1#0;
      |SI FSalida = 0; |HAZ inicio; |FINSI;
   |SINO;
      aAlfa = PARAMETRO;
      aAlfa1 = aAlfa % 0102; #0#0 = aAlfa1;
      aAlfa1 = aAlfa % 0302; #0#1 = aAlfa1;
      aAlfa1 = aAlfa % 0506; #0#2 = aAlfa1;
      aAlfa1 = aAlfa % 1106; #0#3 = aAlfa1;
      #0#4 = "T";
      aAlfa1 = aAlfa % 1702; #0#5 = aAlfa1;
      |HAZ inicio;
   |FINSI;
   |GRABA 020#asexpimp.a;
   |CIERRA #asexpimp;
|FPRO;
