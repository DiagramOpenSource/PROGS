|FICHEROS;
     aboz0004 #0;
     abom0001 #1;
     asclient #2;
     abom0005 #3;
     abom0008 #4;
|FIN;

|VARIABLES;
     &enCodExpe     = 0;
     &eaNombreCli   = "";
|FIN;

|PROCESO Mayus;
     #0Campo = #0Campo > #0Campo;
     |PINTA #0Campo;

     |SI Campo = 0;
         |SI #0Campo = "E";
             |C_M #0#3, 1, "S";  |C_M #0#1, 1, "N";
         |SINO;
             |C_M #0#3, 1, "N";  |C_M #0#1, 1, "S";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO LeeCliente;
     |SI #0#0 = "E";  |ACABA;  |FINSI;

     |SI #0#1 = 0;  |ACABA;  |FINSI;

     |ABRE #2;
     #2#0 = #0#1;
     |LEE 040#2=;
     |SI FSalida ! 0;
         |MENAV "      Cliente Inexistente";
         |ERROR;
     |FINSI;
     |CIERRA #2;
|FPRC;


|PROCESO BuscaExpe;  |TIPO 0;
     |PUSHV 0501 2380;
     |D_CUADRO 0725, 1068;
     |ATRI R;  |PINTA 0826, "INTRODUZCA EL NOMBRE DEL CLIENTE A BUSCAR"; |ATRI 0;

     E_sup      = "40"
     E_inf      = ""
     eaNombreCli = 0926 ? 1;
     |POPV;

     eaNombreCli = eaNombreCli > eaNombreCli;
     enCodExpe   = #0#3;

     |SUB_EJECUTA "aboz0003";

     |SI #0#3 ! enCodExpe; |Y #0#3 ! 99999999;
         #0#3 = enCodExpe;  |PINTA #0#3;
     |FINSI;
|FPRC;

|PROCESO LeeExpe;
     |SI #0#0    = "C"; |ACABA;          |FINSI;
     |SI FSalida = 10;  |HAZ BuscaExpe;  |FINSI;

     |ABRE #1;
     #1#0 = #0#3;
     |LEE 040#1=;
     |SI FSalida ! 0;
         |MENAV "      Expediente inexistente";
         |ERROR;
     |SINO;
         #0#1 = #1#3;  |PINTA #0#1;
         #0#2 = #1#4;  |PINTA #0#2;
         #0#4 = #1#7;  |PINTA #0#4;
         #0#5 = #1#8;  |PINTA #0#5;
         #0#6 = #1#9;  |PINTA #0#6;
     |FINSI;
     |CIERRA #1;
|FPRC;

|RUTINA ClaveBaja4;
     #4#0 = #0#1;
     #4#1 = 1;
|FRUT;

|RUTINA ClaveAlta4;
     #4#0 = #0#1;
     #4#1 = 99999;
|FRUT;

|PROCESO Opcion1;
     |PUSHV 0501 2380;
     |PINPA #0#4;

     |C_P #0#1, 1, 2173;  |PINTA #0#1;
     |C_P #0#2, 1, 2202;  |PINTA #0#2;

     |ENTLINEAL #1#4, -2, 1, 19, 0, ClaveBaja4, ClaveAlta4;
     |POPV;
|FPRC;

|RUTINA ClaveBaja3;
     #3#0 = #1#0;
     #3#1 = 1;
|FRUT;

|RUTINA ClaveAlta3;
     #3#0 = #1#0;
     #3#1 = 999;
|FRUT;

|PROCESO CalcuM0005;
     #1#33 = #1#33 + #3#18;
|FPRC;

|DEFBUCLE abom0005G;
     #3#1;
     ;
     #1#0, 000;
     #1#0, 999;
     ;
     NULL, CalcuM0005;
|FIN;

|PROCESO Opcion2;
     #1#0 = #0#3;
     |LEE 101#1=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PUSHV 0501 2380;
     |PINPA #0#3;

     |C_P #0#2, 1, 2127;  |PINTA #0#2;
     |C_P #0#3, 1, 2172;  |PINTA #0#3;
     |C_P #0#4, 1, 2202;  |PINTA #0#4;
     |C_P #0#5, 1, 2302;  |PINTA #0#5;

     |ENTLINEAL #1#3, -2, 1, 19, 0, ClaveBaja3, ClaveAlta3;
     |POPV;

     #1#33 = 0;
     |BUCLE abom0005G;

     |GRABA 020#1a;
     |LIBERA #1;
|FPRC;

|PROCESO Tipo3;
     |SI #0#0 = "C";             |HAZ Opcion1;               |FINSI;
     |SI #0#0 = "E";  |ABRE #1;  |HAZ Opcion2;  |CIERRA #1;  |FINSI;
|FPRC;

|PROGRAMA;

     |CLS;
     |CABEZA "Partes de Trabajo";
     |DDEFECTO #0;
     |PARA; |SI;  |HACIENDO;
            |C_P #0#1, 1, 0768;  |PINTA #0#1;
            |C_P #0#2, 1, 0825;  |PINTA #0#2;
            |C_P #0#3, 1, 0745;  |PINTA #0#3;
            |C_P #0#4, 1, 1002;  |PINTA #0#4;
            |C_P #0#5, 1, 1102;  |PINTA #0#5;
            |C_P #0#6, 1, 1202;  |PINTA #0#6;

            |PINPA #0#0;
            |PINDA #0#0;
            |ENDATOS #1#0;
            |SI FSalida = 0;
                |HAZ Tipo3;
            |SINO;
                |SAL;
            |FINSI;
     |SIGUE;
|FPRO;
