|FICHEROS;
     asconcli #0;                         ||CALCULO DESDE-HASTA PARA INFORMES;
     asinfccl #1;
     asconlin #7;

     asclient #3;
|FIN;

|VARIABLES;
     &ordena = " ";

     nSwPrint  = 0;
|FIN;

|PROCESO Imprime;
     nSwPrint  = 1;
     |PRINT;
|FPRC;

|DEFBUCLE asconlin;
     #7#1;
     ;
     2, #0#0, #0#1, #0#2, 000;
     2, #0#0, #0#1, #0#2, 999;
     ;
     NULL, Imprime;
|FIN;

|CALCULO imprimir;
     |DDEFECTO #3;
     #3#0 = #0#0;
     |LEE 041#3=;
     |SI #1#8 = "N"; |Y #3#66 > "01.01.1900"; |ACABA; |FINSI;

     |BUCLE asconlin;
|FCAL;

|DEFBUCLE cainfccl0;
     #0#1;
     ;
     #1#0, #1#2, #1#4;
     #1#1, #1#3, #1#5;
     e;
     NULL, imprimir;
|FIN;

|DEFBUCLE cainfccl1;
     #0#2;
     ;
     #1#2, #1#4, #1#0;
     #1#3, #1#5, #1#1;
     e;
     NULL, imprimir;
|FIN;

|CALCULO impre;|TIPO 3;
     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;   |FINSI;

     |INFOR "asinfccl";
     |SI FSalida ! 0;   |FINIMP;   |ACABA;   |FINSI;

     |ABRE #3;
     |SI #1#6 = 1;
         ordena = "Cliente";
         |BUCLE cainfccl0;
     |FINSI;
     |SI #1#6 = 2;
         ordena = "Servicios";
         |BUCLE cainfccl1;
     |FINSI;
     |CIERRA #3;

     |SI nSwPrint = 1;  |PIEINF;  |FINSI;
     |FININF;
     |FINIMP;
|FCAL;
