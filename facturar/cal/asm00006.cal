|FICHEROS;
   asm00006 #0;
   asm00007 #1,MANTE;
   asm00008 #2,MANTE;
   asw00018 #4,MANTE;
   asw00019 #5,MANTE;

   asm00005 #6;
   asm00003 #7;

   asm00009 #8,MANTE;
   referen@ #10;
   caconce@ #11;

   canempr@ #12;
   asw00020 #13;

   :/modelos/def/dsmom030 #15;
|FIN;

|VARIABLES;
   aAlfa = "";

   ConcepAntes = 0;
   Cont        = 0;
   ComodNum    = 0;
   Comodin     = "";
   Comodin1    = "";
   Comodin2    = "";
   Salir       = 0;
   NumCampos   = 0;
   DefCargado  = "";
   Direc       = "";

   ModoEntrada = 0;
   TipoDato    = "";
   LongDato    = 0;

   Linea       = 0;
   LinCmps     = 0;
   TipoCampo1  = "";
   TipoCampo2  = "";
   Fich        = "";
   NumCampo    = 0;
   Cmp         = "";
   NomFich     = "";

   aLong       = "";
   nLong       = 0;
   Calc        = 0;
   nPosic      = 0;
   Tecla       = 0;
   acota       = 0;
   LinAcot     = 0;
   Parte1      = "";
   Parte2      = "";

   MaxDig      = 0;
   Nivel       = 0;

{-1}menu = "";
    menu1 = "1400";
    menu2 = "1";
    menu3 = "4"
    menu4 = "          ";
    menu5 = "Honorarios";
    menu6 = "Suplidos  ";
    menu7 = "A cuenta  ";
|FIN;

|INCLUYE i_varcof;

|PROCESO PintaTipo;
   |SI #asm00006#2 = "FC"; #asm00006#3 = "FACTURAS"; |FINSI;
   |SI #asm00006#2 = "CB"; #asm00006#3 = "COBROS  "; |FINSI;
   |PINTA #asm00006#3;
|FPRC;

|RUTINA inf;
   #asm00007#0 = #asm00006#0;
   #asm00007#2 = 000001;
|FRUT;

|RUTINA sup;
   #asm00007#0 = #asm00006#0;
   #asm00007#2 = 999999;
|FRUT;

|PROCESO EntraLineas;
   |ENTLINEAL #1#asm00007,-2,2,15,1,inf,sup;
   |PUSHV 0501 2380;
   |ENTLINEAL #1#asm00009,-2,1,22,1,inf4,sup4;
   |POPV;
|FPRC;

|RUTINA inf1;
   #asm00008#0 = #asm00006#0;
   #asm00008#1 = #asm00007#2;
   #asm00008#2 = 0001;
|FRUT;

|RUTINA sup1;
   #asm00008#0 = #asm00006#0;
   #asm00008#1 = #asm00007#2;
   #asm00008#2 = 9999;
|FRUT;

|RUTINA inf2;
   #asw00018#0 = 001;
   #asw00018#6 = TipoCampo1;
|FRUT;

|RUTINA sup2;
   #asw00018#0 = 999;
   #asw00018#6 = TipoCampo2;
|FRUT;

|RUTINA inf3;
   #asw00019#3 = #asm00006#0;
   #asw00019#4 = #asm00007#2;
   #asw00019#5 = #asm00008#2;
   #asw00019#6 = TipoCampo1;
   #asw00019#0 = 1;
|FRUT;

|RUTINA sup3;
   #asw00019#3 = #asm00006#0;
   #asw00019#4 = #asm00007#2;
   #asw00019#5 = #asm00008#2;
   #asw00019#6 = TipoCampo2;
   #asw00019#0 = 999;
|FRUT;

|RUTINA inf4;
   #asm00009#0 = 001;
   #asm00009#15 = #asm00006#0;
|FRUT;

|RUTINA sup4;
   #asm00009#0 = 999;
   #asm00009#15 = #asm00006#0;
|FRUT;

|RUTINA InfAcota;
   #asw00019#3 = #asm00006#0;
   #asw00019#4 = #asm00007#2;
   #asw00019#5 = #asm00008#2;
   #asw00019#6 = "A";
   #asw00019#0 = 1;
|FRUT;

|RUTINA SupAcota;
   #asw00019#3 = #asm00006#0;
   #asw00019#4 = #asm00007#2;
   #asw00019#5 = #asm00008#2;
   #asw00019#6 = "A";
   #asw00019#0 = 999;
|FRUT;

|PROCESO DefineLinea; |TIPO 3;
   #asm00007#1 = #asm00008#2;
   |ENTLINEAL #1#asm00008,-3,1,22,1,inf1,sup1;
|FPRC;

|PROCESO PresentaLineas; |TIPO 13;

   Comodin = #asm00006#6; |QBF Comodin;
   |SI Comodin ! "";
      Comodin1 = Comodin + "def/canempre.mas";
      |CARGA_DEF Comodin1 , canempr@;
      |SI FSalida = 0;
         Comodin1 = Comodin + "fich/";
         |PATH_DAT #12 Comodin1;
         |ABRE #canempr@;
         #canempr@#2 = #asm00006#4;
         #canempr@#3 = #asm00006#5;
         |LEE 000#canempr@.=;
         |SI FSalida = 0;
            |PINTA 0820, #canempr@#1;
         |SINO;
            |PINTA 0820, "                                         ";
         |FINSI;
         |CIERRA #canempr@;
         |DESCARGA_DEF #canempr@;
      |FINSI;
   |FINSI;

   |ENTLINEAL #1#asm00007,-2,7,15,1,inf,sup;
   |ENTLINEAL #1#asm00008,-3,7,22,1,inf1,sup1;
|FPRC;

|PROCESO Borra3;
   |BORRA 020#asm00009.a;
|FPRC;

|DEFBUCLE Borra3;
   #asm00009#1;
   ;
   #asm00006#0,001;
   #asm00006#0,999;
   ;
   NULL,Borra3;
|FIN;

|PROCESO BorraLins;
   |BORRA 020#asw00019.a;
|FPRC;

|DEFBUCLE BorraLins;
   #asw00019#1;
   ;
   #asm00006#0,#asm00007#2,#asm00008#2," ",001;
   #asm00006#0,#asm00007#2,#asm00008#2,"z",999;
   ;
   NULL,BorraLins;
|FIN

|PROCESO Borra2;
   |ABRE #asw00019;
   |BUCLE BorraLins;
   |CIERRA #asw00019;
   |BORRA 020#asm00008.a;
|FPRC;

|DEFBUCLE Borra2;
   #asm00008#1;
   ;
   #asm00006#0,000001,0001;
   #asm00006#0,999999,9999;
   ;
   NULL,Borra2;
|FIN;

|PROCESO Borra1;
   |BORRA 020#asm00007.a;
|FPRC;

|DEFBUCLE Borra1;
   #asm00007#1;
   ;
   #asm00006#0,000001;
   #asm00006#0,999999;
   ;
   NULL,Borra1;
|FIN;

|PROCESO BorraLineas; |TIPO 1;
   ModoEntrada = (FEntrada / 100) ! 0;
   |SI ModoEntrada = 3;
      |ABRE #asm00007;
      |ABRE #asm00008;
      |BUCLE Borra3;
      |BUCLE Borra2;
      |BUCLE Borra1;
      |CIERRA #asm00008;
      |CIERRA #asm00007;
   |SINO;
      Comodin = #asm00006#6; |QBF Comodin;
      |SI Comodin ! "";
         Comodin1 = Comodin + "def/canempre.mas";
         |CARGA_DEF Comodin1 , canempr@;
         |SI FSalida = 0;
            Comodin1 = Comodin + "fich/";
            |PATH_DAT #12 Comodin1;
            |ABRE #canempr@;
            #canempr@#2 = #asm00006#4;
            #canempr@#3 = #asm00006#5;
            |LEE 010#canempr@.=;
            |SI FSalida = 0;
               |PINTA 0820, #canempr@#1;
            |FINSI;
            |CIERRA #canempr@;
            |DESCARGA_DEF #canempr@;
         |FINSI;
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO Campos;

   #asm00003#0 = #asm00005#1;
   |LEE 000#asm00003.=;

   |DDEFECTO #asw00018;

   #asw00018#0 = Linea;  Linea = Linea + 1;
   #asw00018#1 = #asm00005#1;
   #asw00018#2 = #asm00003#1;
   #asw00018#3 = #asm00005#4;
   #asw00018#4 = #asm00005#2;
   #asw00018#5 = #asm00005#3;
   #asw00018#6 = #asm00005#5;
   |GRABA 020#asw00018.n;
|FPRC;

|DEFBUCLE Ficheros;
#asm00005#1;
4,5;
001,#asm00006#2,TipoCampo1;
999,#asm00006#2,TipoCampo2;
;
NULL,Campos;
|FIN;

|PROCESO Interpreta;
   Comodin1 = #asw00019#1 % 0102;
   |SI Comodin1 = "[%";
      Comodin1 = #asw00019#1 % 0105; |QBF Comodin1;
   |SINO;
      Comodin1 = #asw00019#2 % 0101;
   |FINSI;

   Comodin2 = #asw00019#2 % 0299; |QBF Comodin2;
   Comodin1 = Comodin1 + Comodin2; |QBF Comodin1;
   |SI Comodin1 = "";
      Comodin1 = #asw00019#1; |QBF Comodin1;
   |FINSI;
   Comodin = Comodin + Comodin1;
|FPRC;

|DEFBUCLE Interpreta;
#asw00019#1;
;
#asm00006#0,#asm00007#2,#asm00008#2,TipoCampo1,001;
#asm00006#0,#asm00007#2,#asm00008#2,TipoCampo1,999;
;
NULL,Interpreta;
|FIN;

|PROCESO EditaLineas; |TIPO 13;
   |SI FSalida = 10;
      |SI acota = 0;
         |ENTLINEAL #1#asw00019,-5,1,22,1,inf3,sup3;
         |ENTLINEAL #1#asw00019,5,7,22,1,inf3,sup3;
      |SINO;
         |ENTLINEAL #1#asw00019,-5,1,22,1,InfAcota,SupAcota;
         |ENTLINEAL #1#asw00019,5,7,22,1,InfAcota,SupAcota;
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO LinFichero; |TIPO 0;
   LinCmps = 0;
   |SALVA_FICHA #asw00019;
   #asw00019#3 = #asm00006#0;
   #asw00019#4 = #asm00007#2;
   #asw00019#5 = #asm00008#2;
   |SI acota = 1;
      #asw00019#6 = "A";
   |SINO;
      #asw00019#6 = TipoCampo1;
   |FINSI;
   #asw00019#0 = 1;
   |LEE 010#asw00019.];
   |SI FSalida ! 0; LinCmps = 10; |FINSI;
   |PARA; |SI FSalida = 0; |HACIENDO;
      |SI acota = 0;
         |SI #asw00019#3 = #asm00006#0; |Y #asw00019#4 = #asm00007#2;
         |Y #asw00019#5 = #asm00008#2;  |Y #asw00019#6 = TipoCampo1;
            LinCmps = #asw00019#0 + 10;
            |LEE 010#asw00019.s;
         |SINO;
            |SI LinCmps = 0; LinCmps = 10; |FINSI;
            |SAL;
         |FINSI;
      |SINO;
         |SI #asw00019#3 = #asm00006#0; |Y #asw00019#4 = #asm00007#2;
         |Y #asw00019#5 = #asm00008#2;  |Y #asw00019#6 = "A";
            LinCmps = #asw00019#0 + 10;
            |LEE 010#asw00019.s;
         |SINO;
            |SI LinCmps = 0; LinCmps = 10; |FINSI;
            |SAL;
         |FINSI;
      |FINSI;
   |SIGUE;
   |REPON_FICHA #asw00019;

   |DDEFECTO #asw00019;
   #asw00019#0 = LinCmps;
   Comodin = "[" + #asw00018#2; |QBF Comodin;
   Comodin = Comodin + "][" + #asw00018#5; |QBF Comodin;
   Comodin = Comodin + "]";
   #asw00019#1 = Comodin;
   Comodin = "[" + #asw00018#1; |QBF Comodin;
   Comodin1 = ("000" + #asw00018#4) % -103;
   Comodin = Comodin + "][" + Comodin1 + "]";
   #asw00019#2 = Comodin;
   #asw00019#3 = #asm00006#0;
   #asw00019#4 = #asm00007#2;
   #asw00019#5 = #asm00008#2;
   |SI acota = 0;
      #asw00019#6 = TipoCampo1;
   |SINO;
      #asw00019#6 = "A";
   |FINSI;

   |GRABA 020#asw00019.n;
   |SI acota = 0;
      |ENTLINEAL #1#asw00019,-5,7,22,1,inf3,sup3;
   |SINO;
      |ENTLINEAL #1#asw00019,-5,7,22,1,InfAcota,SupAcota;
   |FINSI;
|FPRC;

|PROCESO Selec;

   |PONCONTROL 23, "si";
   |SI FSalida ! 10; |ACABA; |FINSI;

   |DELINDEX #asw00018;

   |ABRE #asm00003;
   |ABRE #asm00005;
   |ABRE #asw00018;
   |ABRE #asw00019;

   |SI Campo = 3; TipoCampo1 = "C"; TipoCampo2 = "C"; |FINSI;
   |SI Campo = 6; TipoCampo1 = "D"; TipoCampo2 = "D"; |FINSI;
   |SI Campo = 8; TipoCampo1 = "I"; TipoCampo2 = "I"; |FINSI;
   Linea = 1;
   |BUCLE Ficheros;

   |PUSHV 0501 2380;
   |PINPA #0#0;
   |PINPA #0#1;
   Salir = 0;
   |ENTLINEAL #1#asw00019,-5,7,22,1,inf3,sup3;
   |ENTLINEAL #2#asw00018,-1,4,13,1,inf2,sup2;

   |POPV;
   |PINDA #0#asm00008;

   |CIERRA #asw00019;
   |CIERRA #asw00018;
   |CIERRA #asm00005;
   |CIERRA #asm00003;

   Comodin = "";
   |BUCLE Interpreta;
   |SI TipoCampo1 = "C"; #asm00008#3 = Comodin; |PINTA #asm00008#3; |FINSI;
   |SI TipoCampo1 = "D"; #asm00008#6 = Comodin; |PINTA #asm00008#6; |FINSI;
   |SI TipoCampo1 = "I"; #asm00008#8 = Comodin; |PINTA #asm00008#8; |FINSI;

   |SI Comodin = ""; |ERROR; |FINSI;

|FPRC;

|PROCESO Acotacion;
   Comodin = #asw00019#2; |QBF Comodin;
   |SI Comodin ! "";
      Comodin1 = #asw00019#2; |QBF Comodin1;
      Comodin1 = Comodin1 - "][";
      |SI FSalida ! 0;
         nPosic = FSalida;
         #asm00009#15 = #asm00006#0;
         #asm00009#0  = 1;
         |LEE 010#asm00009.=;
         |SI FSalida ! 0;
            LinAcot = 1;
         |SINO;
            |PARA; |SI FSalida = 0; |Y #asm00009#15 = #asm00006#0; |HACIENDO;
               LinAcot = #asm00009#0 + 1;
               |LEE 010#asm00009.s;
            |SIGUE;
         |FINSI;

         |DDEFECTO #asm00009;
         #asm00009#15 = #asm00006#0;
         #asm00009#16 = #asw00019#0;
         #asm00009#0 = LinAcot;
         Calc = ((nPosic / 100) ! 0) + 99;
         Comodin2 = Comodin1 % Calc; Comodin2 = Comodin2 - "[";
         #asm00009#13 = Comodin2; Comodin1 = Comodin1 - Comodin2;
         Comodin2 = Comodin1 - "[";
         Comodin2 = Comodin2 - "]";
         #asm00009#14 = Comodin2;

         |DBASE Direc; |QBF Direc;
         Direc = Direc + "def/" + #asm00009#13; |QBF Direc;
         Direc = Direc + ".mas"; |QBF Direc;
         |CARGA_DEF Direc, referen@;
         |SI FSalida = 0;
            |ABRE #referen@;
            Comodin1 = "|TITULO";
            #asm00009#1 = #referen@#Comodin1#;
            Comodin1 = #asm00009#14; |QBF Comodin1;
            Comodin1 = ("000" + Comodin1) % -103;
            Comodin2 = "|C" + Comodin1 + "TIPO";
            #asm00009#11 = #referen@#Comodin2#;
            Comodin2 = "|C" + Comodin1 + "LONGITUD";
            #asm00009#12 = #referen@#Comodin2#;
            Comodin2 = "|C" + Comodin1 + "NOMBRE";
            #asm00009#2 = #referen@#Comodin2#;
            Comodin2 = "|C" + Comodin1 + "MINIMO";
            |SI #asm00009#11 = "A"; #asm00009#3 = #referen@#Comodin2#; |FINSI;
            |SI #asm00009#11 = "N"; #asm00009#5 = #referen@#Comodin2#; |FINSI;
            |SI #asm00009#11 = "F"; #asm00009#7 = "01.01.1900";        |FINSI;
            Comodin2 = "|C" + Comodin1 + "MAXIMO";
            |SI #asm00009#11 = "A"; #asm00009#4 = #referen@#Comodin2#; |FINSI;
            |SI #asm00009#11 = "N"; #asm00009#6 = #referen@#Comodin2#; |FINSI;
            |SI #asm00009#11 = "F"; #asm00009#8 = "31.12.2999";        |FINSI;

            |SI #asm00009#11 = "A";
               Comodin = " " * #asm00009#12;
               Comodin1 = #asm00009#3; |QBF Comodin1;
               Comodin2 = #asm00009#4; |QBF Comodin2;
            |FINSI;

            |SI #asm00009#11 = "N";
               Comodin = "";
               Comodin1 = #asm00009#5; |QBF Comodin1;
               Comodin2 = #asm00009#6; |QBF Comodin2;
            |FINSI;

            |SI #asm00009#11 = "F";
               Comodin = "";
               Comodin1 = #asm00009#7; |QBF Comodin1;
               Comodin2 = #asm00009#8; |QBF Comodin2;
            |FINSI;

            Calc = 0 - (#asm00009#12 + 100);
            Comodin1 = (Comodin + Comodin1) % Calc;
            Comodin2 = (Comodin + Comodin2) % Calc;
            #asm00009#9  = Comodin1;
            #asm00009#10 = Comodin2;

            |GRABA 020#asm00009.n;
            |CIERRA #referen@;
            |DESCARGA_DEF #referen@;
         |FINSI;
      |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE Acotacion;
#asw00019#1;
;
#asm00006#0,#asm00007#2,#asm00008#2,"A",001;
#asm00006#0,#asm00007#2,#asm00008#2,"A",999;
;
NULL,Acotacion;
|FIN;

|PROCESO EscogeFich;

      ModoEntrada = (FEntrada / 100) ! 0;
      |SI ModoEntrada = 1;

         |DELINDEX #asw00018;

         |ABRE #asw00019;
         |ABRE #asm00003;
         |ABRE #asm00005;
         |ABRE #asw00018;

         Linea = 1;
         TipoCampo1 = " "; TipoCampo2 = "z";
         |BUCLE Ficheros;
         acota = 1; TipoCampo1 = "A"; TipoCampo2 = "A";
         #asm00007#2 = 1; #asm00008#2 = 1;

         |PUSHV 0501 2380;
         |PINPA #0#0;
         |PINPA #0#1;
         |ENTLINEAL #1#asw00019,-5,7,22,1,InfAcota,SupAcota;
         |ENTLINEAL #2#asw00018,-1,4,13,1,inf2,sup2;

         acota = 0;
         |PINDA #0#asm00009;
         |POPV;

         |CIERRA #asw00018;
         |CIERRA #asm00003;
         |CIERRA #asw00019;

         |BUCLE Borra3;
         |BUCLE Acotacion; |LEE 000#asm00009.p;

      |SINO;
         TipoDato = #asm00009#11; LongDato = #asm00009#12;
         |SI TipoDato = "A";
            |CAMPO_ANCHO #asm00009#3,1,LongDato; ||CAMPO_MAXIMO #asm00009#3,1,"\ +#";
            |CAMPO_ANCHO #asm00009#4,1,LongDato; ||CAMPO_MAXIMO #asm00009#4,1,"\ +#";
            |C_M #asm00009#3,1,"S"; |C_V #asm00009#3,1,"S"; |PINTA #asm00009#3;
            |C_M #asm00009#4,1,"S"; |C_V #asm00009#4,1,"S"; |PINTA #asm00009#4;
            |C_M #asm00009#5,1,"N"; |C_V #asm00009#5,1,"N";
            |C_M #asm00009#6,1,"N"; |C_V #asm00009#6,1,"N";
            |C_M #asm00009#7,1,"N"; |C_V #asm00009#7,1,"N";
            |C_M #asm00009#8,1,"N"; |C_V #asm00009#8,1,"N";
         |FINSI;
         |SI TipoDato = "N";
            |C_M #asm00009#3,1,"N"; |C_V #asm00009#3,1,"N";
            |C_M #asm00009#4,1,"N"; |C_V #asm00009#4,1,"N";
            |C_M #asm00009#5,1,"S"; |C_V #asm00009#5,1,"S"; |PINTA #asm00009#5;
            |C_M #asm00009#6,1,"S"; |C_V #asm00009#6,1,"S"; |PINTA #asm00009#6;
            |C_M #asm00009#7,1,"N"; |C_V #asm00009#7,1,"N";
            |C_M #asm00009#8,1,"N"; |C_V #asm00009#8,1,"N";
         |FINSI;
         |SI TipoDato = "F";
            |C_M #asm00009#3,1,"N"; |C_V #asm00009#3,1,"N";
            |C_M #asm00009#4,1,"N"; |C_V #asm00009#4,1,"N";
            |C_M #asm00009#5,1,"N"; |C_V #asm00009#5,1,"N";
            |C_M #asm00009#6,1,"N"; |C_V #asm00009#6,1,"N";
            |C_M #asm00009#7,1,"S"; |C_V #asm00009#7,1,"S"; |PINTA #asm00009#7;
            |C_M #asm00009#8,1,"S"; |C_V #asm00009#8,1,"S"; |PINTA #asm00009#8;
         |FINSI;
      |FINSI;
|FPRC;

|PROCESO TomaValor;
   |SI TipoDato = "A"; #asm00009#9 = #asm00009#3; #asm00009#10 = #asm00009#4; |FINSI;
   |SI TipoDato = "N"; #asm00009#9 = #asm00009#5; #asm00009#10 = #asm00009#6; |FINSI;
   |SI TipoDato = "F"; #asm00009#9 = "   " + #asm00009#7; #asm00009#10 = "   "+ #asm00009#8; |FINSI;

   |SI Campo = 4; |O Campo = 6; |O Campo = 8;
      |C_M #asm00009#3,1,"N"; |C_V #asm00009#3,1,"N";
      |C_M #asm00009#4,1,"N"; |C_V #asm00009#4,1,"N";
      |C_M #asm00009#5,1,"N"; |C_V #asm00009#5,1,"N";
      |C_M #asm00009#6,1,"N"; |C_V #asm00009#6,1,"N";
      |C_M #asm00009#7,1,"N"; |C_V #asm00009#7,1,"N";
      |C_M #asm00009#8,1,"N"; |C_V #asm00009#8,1,"N";
                              |C_V #asm00009#9,1,"S";
                              |C_V #asm00009#10,1,"S";
   |FINSI;
|FPRC;

|PROCESO MiraPath;

   |SI FSalida = 10;
      |DBASS Comodin; |QBF Comodin;
      Comodin = Comodin + "contagen/";
      #asm00006#6 = Comodin;
      |PINTA #asm00006#6;
   |FINSI;

   Comodin = #asm00006#6; |QBF Comodin;
   aLong = Comodin % 0; nLong = aLong;
   Calc = (nLong * 100) + 1;
   Comodin1 = Comodin % Calc;
   |SI Comodin1 ! "/";
      Comodin = Comodin + "/";
      #asm00006#6 = Comodin; |PINTA #asm00006#6;
   |FINSI;
|FPRC;

|PROCESO MiraEmpresas;
   Tecla = FSalida;
   |SI Tecla = 2; |ACABA; |FINSI;

   |SI #asm00006#8 = "S";
       enSwSinMen = 1;
       |HAZ SituaMaestra;
       |SI swerror = 0;
           MaxDig = MaximoDigitos;
           Nivel  = dig3;
       |SINO;
           MaxDig  = 12;
           Nivel   = 5;
       |FINSI;
       enSwSinMen = 0;
       |ACABA;
   |FINSI;

   Comodin1 = Comodin + "def/canempre.mas";
   |CARGA_DEF Comodin1 , canempr@;
   |SI FSalida = 0;
      Comodin1 = Comodin + "fich/";
      |PATH_DAT #12 Comodin1;
      |ABRE #canempr@;
      |SI Tecla = 10;
         |CONSULTA_CLAVE #1#canempr@;
         |SI FSalida ] 0;
            #asm00006#4 = #canempr@#2; |PINTA #asm00006#4;
            #asm00006#5 = #canempr@#3; |PINTA #asm00006#5;
            MaxDig = 0;
            |SI MaxDig < #canempr@#14; MaxDig = #canempr@#14; Nivel = 1; |FINSI;
            |SI MaxDig < #canempr@#15; MaxDig = #canempr@#15; Nivel = 2; |FINSI;
            |SI MaxDig < #canempr@#16; MaxDig = #canempr@#16; Nivel = 3; |FINSI;
            |SI MaxDig < #canempr@#17; MaxDig = #canempr@#17; Nivel = 4; |FINSI;
            |SI MaxDig < #canempr@#18; MaxDig = #canempr@#18; Nivel = 5; |FINSI;
            |SI MaxDig < #canempr@#19; MaxDig = #canempr@#19; Nivel = 6; |FINSI;
         |FINSI;
      |SINO;
         #canempr@#2 = #asm00006#4;
         #canempr@#3 = #asm00006#5;
         |LEE 010#canempr@.=;
         |SI FSalida ! 0;
            |MENAV "    No existe empresa";
            |ERROR;
         |FINSI;
      |FINSI;
      |PINTA 0820, #canempr@#1;
      MaxDig = 0;
      |SI MaxDig < #canempr@#14; MaxDig = #canempr@#14; Nivel = 1; |FINSI;
      |SI MaxDig < #canempr@#15; MaxDig = #canempr@#15; Nivel = 2; |FINSI;
      |SI MaxDig < #canempr@#16; MaxDig = #canempr@#16; Nivel = 3; |FINSI;
      |SI MaxDig < #canempr@#17; MaxDig = #canempr@#17; Nivel = 4; |FINSI;
      |SI MaxDig < #canempr@#18; MaxDig = #canempr@#18; Nivel = 5; |FINSI;
      |SI MaxDig < #canempr@#19; MaxDig = #canempr@#19; Nivel = 6; |FINSI;
      |CIERRA #canempr@;
      |DESCARGA_DEF #canempr@;
   |SINO;
      |MENAV "    No puedo abrir el fichero de empresas";
      |ERROR;
   |FINSI;
|FPRC;

|PROCESO Comprueba;
   |SI FSalida = 0;
      |HAZ EntraLineas;
   |FINSI;
|FPRC;

|PROCESO Mayus; |TIPO 0;
    #Fichero@#Campo# = #Fichero@#Campo# > #Fichero@#Campo#;
    |PINTA #Fichero@#Campo#;
|FPRC;

|PROCESO BajaL;
   |BORRA 020#asm00008.a;
|FPRC;

|DEFBUCLE BajaL;
#asm00008#1;
;
#asm00006#0,#asm00007#2,0001;
#asm00006#0,#asm00007#2,9999;
;
NULL,BajaL;
|FIN;

|PROCESO BajaLin; |TIPO 1;
   ModoEntrada = (FEntrada / 100) ! 0;
   |SI ModoEntrada = 3; |BUCLE BajaL; |FINSI;
|FPRC;

|PROCESO BajaAcota; |TIPO 1;
   ModoEntrada = (FEntrada / 100) ! 0;
   |SI ModoEntrada = 3;
      |ABRE #asw00019;
      #asw00019#3 = #asm00009#15;
      #asw00019#4 = 1;
      #asw00019#5 = 1;
      #asw00019#6 = "A";
      #asw00019#0 = #asm00009#16;
      |LEE 010#asw00019.=;
      |SI FSalida = 0;
         |BORRA 020#asw00019.a;
      |FINSI;
      |CIERRA #asw00019;
   |FINSI;
|FPRC;

|PROCESO MontaCuenta;
   Comodin = #asm00008#3; |QBF Comodin;
   Comodin = Comodin - ".";
   |SI FSalida ! 0;
      aLong = Comodin % 0; nLong = aLong;
      Calc = ((FSalida / 100) ! 0) + 99;
      Parte1 = Comodin % Calc;
      Parte2 = Comodin - Parte1;
      Calc = MaxDig - nLong;
      Comodin = "0" * Calc;
      #asm00008#3 = Parte1 + Comodin + Parte2;
      |PINTA #asm00008#3;
   |FINSI;
|FPRC;

|PROCESO asw00019;
   |SALVA_FICHA #asw00019;
   #asw00019#3 = #asw00020#0;
   |GRABA 020#asw00019.n;
   |REPON_FICHA #asw00019;
|FPRC;

|DEFBUCLE asw00019;
#asw00019#1;
;
#asm00006#0,000001,0001," ",001;
#asm00006#0,999999,9999,"z",999;
;
NULL,asw00019;
|FIN;

|PROCESO asm00009;
   |SALVA_FICHA #asm00009;
   #asm00009#15 = #asw00020#0;
   |GRABA 020#asm00009.n;
   |REPON_FICHA #asm00009;
|FPRC;

|DEFBUCLE asm00009;
#asm00009#1;
;
#asm00006#0,001;
#asm00006#0,999;
;
NULL,asm00009;
|FIN;

|PROCESO asm00008;
   |SALVA_FICHA #asm00008;
   #asm00008#0 = #asw00020#0;
   |GRABA 020#asm00008.n;
   |REPON_FICHA #asm00008;
|FPRC;

|DEFBUCLE asm00008;
#asm00008#1;
;
#asm00006#0,#asm00007#2,0001;
#asm00006#0,#asm00007#2,9999;
;
NULL,asm00008;
|FIN;

|PROCESO asm00007;
   |SALVA_FICHA #asm00007;
   #asm00007#0 = #asw00020#0;
   |GRABA 020#asm00007.n;
   |REPON_FICHA #asm00007;
   |BUCLE asm00008;
|FPRC;

|DEFBUCLE asm00007;
#asm00007#1;
;
#asm00006#0,000001;
#asm00006#0,999999;
;
NULL,asm00007;
|FIN;

|PROCESO Copia;
   |SALVA_FICHA #asm00006;
   #asm00006#0 = #asw00020#0;
   #asm00006#1 = #asw00020#1;
   |GRABA 020#asm00006.n;
   |REPON_FICHA #asm00006;
   |BUCLE asm00007;
   |BUCLE asm00009;
   |BUCLE asw00019;
|FPRC;

|PROCESO MiraCopia;
   |SI FSalida = 10;
      |PUSHV 1032 1360;
      |PINPA #0#asw00020;
      |PINDA #0#asw00020;
      |ENDATOS #1#asw00020;
      |SI FSalida = 0;
         |HAZ Copia;
         #asm00006#0 = #asw00020#0;
         |LEE 010#asm00006.=;
         |SI FSalida = 0;
            |PINPA #0#0;
            |PINDA #0#0;
         |FINSI;
      |FINSI;
      |POPV;
   |FINSI;
|FPRC;

|PROCESO PintaApu; |TIPO 13;
   |ENTLINEAL #1#asm00008,-3,7,22,1,inf1,sup1;
|FPRC;

|PROCESO PintaMarca; |TIPO 13;
   aAlfa = #asm00008#3; |QBF aAlfa;
   aAlfa = aAlfa - "[ascuenco][003]";
   |SI FSalida ! 0;
      |SI #asm00008#14 = " "; |PINTA 1760, "様様様様様様様様様"; |FINSI;
      |SI #asm00008#14 = "H"; |ATRI I; |PINTA 1760, " Honorarios "; |ATRI N; |FINSI;
      |SI #asm00008#14 = "S"; |ATRI I; |PINTA 1760, " Suplidos ";   |ATRI N; |PINTA 1770, "様"; |FINSI;
      |SI #asm00008#14 = "A"; |ATRI I; |PINTA 1760, " A cuenta ";   |ATRI N; |PINTA 1770, "様"; |FINSI;
   |SINO;
      |PINTA 1760, "様様様様様様様様様";
   |FINSI;
|FPRC;

|PROCESO AntesTipo; |TIPO 7;
   |PUSHV 0932 1775;
   |CUADRO 0932 1775;
   |ATRI R;
   |PINTA 1033, " B - Base              P - Cuota de IRPF  ";
   |PINTA 1133, " I - Cuota de Iva      D - Descuento      ";
   |PINTA 1233, " R - Cuota de Recargo  F - Total Registro ";
   |PINTA 1333, " X - Otros apuntes                        ";
   |ATRI I;
   |PINTA 1433, " Para los enlaces de IVA es INDISPENSABLE ";
   |PINTA 1533, " que  la primera  linea  sea  la del Total";
   |PINTA 1633, " registro para su correcto funcionamiento ";
   |ATRI N;
|FPRC;

|PROCESO TrasTipo;
   |POPV;
   aAlfa = #asm00008#3; |QBF aAlfa;
   aAlfa = aAlfa - "[ascuenco][003]";
   |SI FSalida ! 0;
      |SI #asm00008#14 = " "; menu2 = "1"; |FINSI;
      |SI #asm00008#14 = "H"; menu2 = "2"; |FINSI;
      |SI #asm00008#14 = "S"; menu2 = "3"; |FINSI;
      |SI #asm00008#14 = "A"; menu2 = "4"; |FINSI;
      |PUSHV 1220 1960;
      |MENUG menu;
      |SI FSalida > 0; |Y FSalida < 5;
         |SI FSalida = 1; #asm00008#14 = " "; |FINSI;
         |SI FSalida = 2; #asm00008#14 = "H"; |FINSI;
         |SI FSalida = 3; #asm00008#14 = "S"; |FINSI;
         |SI FSalida = 4; #asm00008#14 = "A"; |FINSI;
      |FINSI;
      |POPV;
   |SINO;
      #asm00008#14 = " ";
   |FINSI;
|FPRC;

|PROCESO EnlaceCli;
   |SI #asm00006#8 = "S";
       #asm00006#7 = "N"; |PINTA #asm00006#7;
       #asm00006#4 = 0;   |PINTA #asm00006#4;
       #asm00006#5 = 0;   |PINTA #asm00006#5;
       |C_M #asm00006#4,1,"N";
       |C_M #asm00006#5,1,"N";
       |C_M #asm00006#7,1,"N";
       |C_M #asm00006#10,1,"S";
       |C_M #asm00006#12,1,"S";
   |SINO;
       |C_M #asm00006#4,1,"S";
       |C_M #asm00006#5,1,"S";
       |C_M #asm00006#7,1,"S";
       |C_M #asm00006#10,1,"N";
       |C_M #asm00006#12,1,"N";
        #asm00006#10 = "N"; |PINTA #asm00006#10;
        #asm00006#12 = "A"; |PINTA #asm00006#12;
   |FINSI;
|FPRC;

|PROCESO AntesConcepto; |TIPO 7;
   ConcepAntes = #asm00008#5;
|FPRC;

|PROCESO BorraTempo;
   |BORRA 020#asw00019.a;
|FPRC;

|DEFBUCLE BorraTempo;
#asw00019#1;
;
#asm00008#0,#asm00008#1,#asm00008#2,"D",001;
#asm00008#0,#asm00008#1,#asm00008#2,"D",999;
;
NULL,BorraTempo;
|FIN;

|PROCESO TrasConcepto;
   |SI ConcepAntes ! #asm00008#5;
      ConcepAntes = #asm00008#5;
      |ABRE #asw00019;
      |BUCLE BorraTempo;
      Comodin = #asm00006#6; |QBF Comodin;
      Comodin1 = Comodin - "contagen/";
      |SI FSalida ! 0;
         Comodin = Comodin1 + "modelos/";
         Comodin1 = Comodin + "def/dsmom030.mas";
         Comodin2 = Comodin + "fich/";
      |SINO;
         Comodin1 = Comodin + "def/caconcep.mas";
         Comodin2 = Comodin + "fich/" + (("00000" + #asm00006#4) % -105) + #asm00006#5 + "/";
      |FINSI;
      |CARGA_DEF Comodin1, caconce@;
      |SI FSalida = 0;
         |PATH_DAT #11 Comodin2;
         |ABRE #caconce@;
         #caconce@#0 = #asm00008#5;
         |LEE 000#caconce@.=;
         |SI FSalida = 0;
            #asm00008#6 = #caconce@#1; |PINTA #asm00008#6;
         |FINSI;
         |CIERRA #caconce@; |DESCARGA_DEF #caconce@;
      |FINSI;
      |DDEFECTO #asw00019;
      #asw00019#0 = 10;
      #asw00019#1 = #asm00008#6;
      #asw00019#2 = #asm00008#6;
      #asw00019#3 = #asm00008#0;
      #asw00019#4 = #asm00008#1;
      #asw00019#5 = #asm00008#2;
      #asw00019#6 = "D";
      |GRABA 020#asw00019.n;
      |CIERRA #asw00019;
   |FINSI;
|FPRC;

|PROCESO CompCampo; |TIPO 7;
   |SI #asm00006#2 = "FC";
      #asm00007#5 = "N"; |PINTA #asm00007#5;
      |C_M #asm00007#5, 1, "N";
   |SINO;
      |C_M #asm00007#5, 1, "S";
   |FINSI;
|FPRC;
