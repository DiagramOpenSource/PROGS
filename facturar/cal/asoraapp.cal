|FICHEROS;
     asoraapp;
     asclient;
|FIN;

|VARIABLES;
     nBoton              = 0;
     nSalida             = 0;

     aEjecuta            = "";
     aClienteFacE        = "";
     aMensaje            = "";

     &enEmpresa          = 0;
     &enSwWebServiceFace = 0;
     &enAprobacion       = 0;
     &eaPrograma         = "";
|FIN;

|PROCESO webFace;
     aEjecuta = "start https://face.gob.es/es/directorio";
     |RSYSTEM aEjecuta;
|FPRC;

|PROCESO ControWSFace;
     |SI enSwWebServiceFace = 1;
          |ATRI 0;
          |PINTA 2305, "Enviar facturaE al WebService de FACE: ";
          |ATRI I;

          |C_V #asoraapp#44, 1, "S";
          |C_M #asoraapp#44, 1, "S";
     |SINO;
          |C_V #asoraapp#44, 1, "N";
          |C_M #asoraapp#44, 1, "N";
     |FINSI;
|FPRC;

|PROCESO PonDatosAAPP;
     |SI #asclient#0 = 0;
          aMensaje = "0000Debe seleccionar un Cliente para introducir los datos AAPP";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     |CLS;
     |ABRE #asoraapp;

     |DDEFECTO #asoraapp;
     #asoraapp#0 = #asclient#0;
     |LEE 101#asoraapp.=;
     nSalida = FSalida;

     |SI nSalida ! 0;
          #asoraapp#1 = #asclient#1;

          |PINPA #0#asoraapp;
          |HAZ ControWSFace;
          |PINDA #0#asoraapp;

          aMensaje = "0000SDesea copiar las direcciones de la ficha del cliente?";
          |CONFI aMensaje;
          |SI FSalida = 0;
               #asoraapp#5 = #asclient#3;
               #asoraapp#6 = #asclient#4;
               #asoraapp#7 = #asclient#5;
               #asoraapp#8 = (("00" + #asoraapp#6) % -102) + (("000" + #asoraapp#7) % -103);
               #asoraapp#9 = #asclient#6;
               #asoraapp#10 = #asclient#7;

               #asoraapp#15 = #asoraapp#5;
               #asoraapp#16 = #asoraapp#6;
               #asoraapp#17 = #asoraapp#7;
               #asoraapp#18 = #asoraapp#8;
               #asoraapp#19 = #asoraapp#9;
               #asoraapp#20 = #asoraapp#10;

               #asoraapp#25 = #asoraapp#5;
               #asoraapp#26 = #asoraapp#6;
               #asoraapp#27 = #asoraapp#7;
               #asoraapp#28 = #asoraapp#8;
               #asoraapp#29 = #asoraapp#9;
               #asoraapp#30 = #asoraapp#10;

               #asoraapp#35 = #asoraapp#5;
               #asoraapp#36 = #asoraapp#6;
               #asoraapp#37 = #asoraapp#7;
               #asoraapp#38 = #asoraapp#8;
               #asoraapp#39 = #asoraapp#9;
               #asoraapp#40 = #asoraapp#10;
          |FINSI;
     |FINSI;

     |PINPA #0#asoraapp;
     |HAZ ControWSFace;
     |PINDA #0#asoraapp;

     |CONTROL_SIMPLE 0, "BOTON,Web FACe", 0770, 0780, webFace;
     nBoton = FSalida;

     |ENDATOS #2#asoraapp;
     |SI FSalida = 0;
          |SI nSalida = 0;
               |GRABA 020#asoraapp.a;
          |SINO;
               |GRABA 020#asoraapp.n;
          |FINSI;
     |FINSI;
     |LIBERA #asoraapp;

     |FIN_CONTROL_WINDOWS nBoton;

     |CIERRA #asoraapp;
|FPRC;

|PROCESO cp1FacE;
     #asoraapp#8 = (("00" + #asoraapp#6) % -102) + (("000" + #asoraapp#7) % -103);
|FPRC;

|PROCESO cp2FacE;
     #asoraapp#18 = (("00" + #asoraapp#16) % -102) + (("000" + #asoraapp#17) % -103);
|FPRC;

|PROCESO cp3FacE;
     #asoraapp#28 = (("00" + #asoraapp#26) % -102) + (("000" + #asoraapp#27) % -103);
|FPRC;

|PROCESO cp4FacE;
     #asoraapp#38 = (("00" + #asoraapp#36) % -102) + (("000" + #asoraapp#37) % -103);
|FPRC;

|PROGRAMA;
     enAprobacion = 0;
     eaPrograma = "WEBSERVICEFACE";
     |HAZ DSARCHI_INI;
     enSwWebServiceFace = enAprobacion;

     |ABRE #asclient;
     #asclient#0 = enEmpresa;
     |LEE 101#asclient.=;
     |SI FSalida = 0;
         |HAZ PonDatosAAPP;
     |FINSI;
     |CIERRA #asclient;
|FPRO;
