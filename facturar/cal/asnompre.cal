|FICHEROS;
     asnompre #0;
     asnomdat #1;
     asconcep #2;
     asclient #3;
     asnomenl #4;
     asnomtar #5;
     asconmen #6;

     asnompas #999; ||ultima seleccion en pantalla del pase
|FIN;

|VARIABLES;
  fecha      = @;
  varalf     = "";
  h_nomin    = 0;
  h_pagas    = 0;
  h_finiq    = 0;
  h_fijas    = 0;
  h_tc1      = 0;
  h_tc2      = 0;
  h_tc21     = 0;
  h_contr    = 0;
  h_prorr    = 0;
  h_sutc1    = 0;

  sw          = 0;
  &h_comun    = 0;
  &nSwSoloImp = 0;
  &empre_n    = 0;
  nTotalNominas = 0;

  &honorario = 0;
  &suplido   = 0;
  &seccion   = "";
  &concepto  = "";
  &nombre    = "";
  &canti     = 0;
  &import    = 0;
  &tlinea    = 0;

  &aCampo8   = "";
  &aCampo9   = "";

   &empre_f  = 0;
   &mes_p    = 0;
   &anyo_p   = 0;
   &anyo_n   = 0;
   &tarifa   = 0;
   nTipoFactG= 0;

  {-1}menu   = ""
      menu1  = "2400";
      menu2  = "1";
      menu3  = " Elija opcion: ";
      menu4  = "DR";
      menu5  = " Detallado ";
      menu6  = " Resumido ";
|FIN;

|PROCESO pinta; |TIPO 7;
   fecha = ~;
   varalf = fecha % 402;
   #0#2 = varalf;
   varalf = fecha % 902;
   #0#3 = varalf;
  |PINTA #0#2;
  |PINTA #0#3;
|FPRC;

||/////////////////////////////////////////////////
|PROCESO leeconc;
    #6#0 = seccion; #6#1 = concepto;
    |LEE 040#6=;
    |SI FSalida = 0;
        nombre = #6#2;
    |SINO;
        #2#0 = seccion; #2#1 = concepto;
        |LEE 040#2=;
        |SI FSalida ! 0; |DDEFECTO #2; |FINSI;
        nombre = #2#2;
    |FINSI;
|FPRC;

|PROCESO impresio;
    |SI #1#6 = 0;|Y #1#8  = 0;|Y #1#10 = 0;|Y #1#12 = 0;   || si todo es cero
                 |Y #1#14 = 0;|Y #1#16 = 0;|Y #1#18 = 0;   ||/se lo salta
                 |Y #1#20 = 0;
        |ACABA;
    |FINSI;

    |SI menu2 = 1;
        honorario = 0;
        suplido   = 0;
    |FINSI;

    #4#0 = #1#0;
    |LEE 040#4=;
    |SI FSalida ! 0; |ACABA; |FINSI;
    empre_f = #4#2;
    tarifa  = #4#4;

    #3#0 = #4#2;
    |LEE 040#3=;
    |SI FSalida ! 0; |DDEFECTO #3; |FINSI;

    #5#0 = #4#4;
    |LEE 040#5=;
    |SI FSalida ! 0; |ACABA; |FINSI;

    |SI menu2 = 2;
        honorario = honorario + h_fijas + h_nomin + h_pagas + h_tc1 + h_tc2;
        honorario = honorario + h_contr + h_prorr + h_tc21 + h_finiq + h_comun;
        suplido   = suplido + h_sutc1;
    |FINSI;

    h_finiq = 0;
    h_nomin = 0;
    h_pagas = 0;
    h_fijas = 0;
    h_tc1   = 0;
    h_tc2   = 0;
    h_tc21  = 0;
    h_contr = 0;
    h_prorr = 0;
    h_sutc1 = 0;
    h_comun = 0;

    |SI aCampo8 = "S";
        nTotalNominas = #1#6;
    |SINO;
        nTotalNominas = #1#6 + #1#20;
    |FINSI;

    |SI #5#9 = "S";|Y nTotalNominas ! 0;                     || nominas
        |SI nTotalNominas ] #5#12; |Y nTotalNominas [ #5#13; import = #5#14; |FINSI;
        |SI nTotalNominas ] #5#16; |Y nTotalNominas [ #5#17; import = #5#18; |FINSI;
        |SI nTotalNominas ] #5#20; |Y nTotalNominas [ #5#21; import = #5#22; |FINSI;
        |SI nTotalNominas ] #5#24; |Y nTotalNominas [ #5#25; import = #5#26; |FINSI;
        |SI nTotalNominas ] #5#28; |Y nTotalNominas [ #5#29; import = #5#30; |FINSI;
        |SI nTotalNominas ] #5#32; |Y nTotalNominas [ #5#33; import = #5#34; |FINSI;

        canti = nTotalNominas;
        h_nomin = canti * import;
        tlinea  = canti * import;

        |SI #5#2 = "N";
            seccion  = #5#10;
            concepto = #5#11;
            |HAZ leeconc;
            |PRINT; sw = 1;
       |FINSI;
    |FINSI;

    |SI #5#9 = "S";|Y #1#8 ! 0;                     || pagas
        |SI #1#8 ] #5#12; |Y #1#8 [ #5#13; import = #5#15; |FINSI;
        |SI #1#8 ] #5#16; |Y #1#8 [ #5#17; import = #5#19; |FINSI;
        |SI #1#8 ] #5#20; |Y #1#8 [ #5#21; import = #5#23; |FINSI;
        |SI #1#8 ] #5#24; |Y #1#8 [ #5#25; import = #5#27; |FINSI;
        |SI #1#8 ] #5#28; |Y #1#8 [ #5#29; import = #5#31; |FINSI;
        |SI #1#8 ] #5#32; |Y #1#8 [ #5#33; import = #5#35; |FINSI;

        canti = #1#8;
        h_pagas = canti * import;
        tlinea = canti * import;
        |SI #5#2 = "N";
            seccion  = #5#10;
            concepto = #5#11;
            |HAZ leeconc;
            |PRINT; sw = 1;
        |FINSI;
    |FINSI;

    |SI aCampo8 = "S"; |Y aCampo9 = "S";
        |SI #5#9 = "S"; |Y #1#20 ! 0;                     || finiquitos
            |SI #1#20 ] #5#12; |Y #1#20 [ #5#13; import = #5#59; |FINSI;
            |SI #1#20 ] #5#16; |Y #1#20 [ #5#17; import = #5#60; |FINSI;
            |SI #1#20 ] #5#20; |Y #1#20 [ #5#21; import = #5#61; |FINSI;
            |SI #1#20 ] #5#24; |Y #1#20 [ #5#25; import = #5#62; |FINSI;
            |SI #1#20 ] #5#28; |Y #1#20 [ #5#29; import = #5#63; |FINSI;
            |SI #1#20 ] #5#32; |Y #1#20 [ #5#33; import = #5#64; |FINSI;

            canti = #1#20;
            h_finiq = canti * import;
            tlinea  = canti * import;
            |SI #5#2 = "N";
                seccion  = #5#10;
                concepto = #5#11;
                |HAZ leeconc;
                |PRINT; sw = 1;
            |FINSI;
        |FINSI;
    |FINSI;

    |SI #5#5  = "S";                                   || fijas
        canti = 1;
        import = #5#6;
        h_fijas = canti * import;
        tlinea = canti * import;
        |SI #5#2 = "N";
            seccion  = #5#7;
            concepto = #5#8;
            |HAZ leeconc;
            |PRINT; sw = 1;
        |FINSI;
    |FINSI;

    |SI #5#5 = "S";|Y #5#9 = "S";|Y h_nomin = 0;
        h_fijas = 0;
    |FINSI;

    |SI #5#36 = "S";                                   || TC1
        canti = 1;
        import = #5#37;
        h_tc1 = canti * import;
        tlinea = canti * import;
        |SI #5#2 = "N";
            seccion  = #5#38;
            concepto = #5#39;
            |HAZ leeconc;
            |PRINT; sw = 1;
        |FINSI;
    |FINSI;

    |SI #5#40 = "S"; |Y #1#10 ! 0;         || TC2
        canti = #1#10;
        import = #5#41;
        h_tc2 = canti * import;
        tlinea = canti * import;
        |SI #5#2 = "N";
            seccion  = #5#42;
            concepto = #5#43;
            |HAZ leeconc;
            |PRINT; sw = 1;
        |FINSI;
    |FINSI;

    |SI #5#44 = "S"; |Y #1#12 ! 0;                   || TC2/1
        canti = #1#12;
        import = #5#45;
        h_tc21 = canti * import;
        tlinea = canti * import;
        |SI #5#2 = "N";
            seccion  = #5#46;
            concepto = #5#47;
            |HAZ leeconc;
            |PRINT; sw = 1;
        |FINSI;
    |FINSI;

    |SI #5#48 = "S"; |Y #1#14 ! 0;                    || contratos
        canti = #1#14;
        import = #5#49;
        h_contr = canti * import;
        tlinea = canti * import;
        |SI #5#2 = "N";
            seccion  = #5#50;
            concepto = #5#51;
            |HAZ leeconc;
            |PRINT; sw = 1;
        |FINSI;
    |FINSI;

    |SI #5#52 = "S"; |Y #1#16 ! 0;                     || prorrogas
        canti = #1#16;
        import = #5#53;
        h_prorr = canti * import;
        tlinea = canti * import;
        |SI #5#2 = "N";
            seccion  = #5#54;
            concepto = #5#55;
            |HAZ leeconc;
            |PRINT; sw = 1;
       |FINSI;
    |FINSI;

    |SI #5#65 = "S";                              || Comunicaciones
        nSwSoloImp = 2;
        empre_n    = #1#0;
        mes_p      = #0#2;
        |SI #0#3 > 80;
            anyo_n = 1900 + #0#3;
        |SINO;
            anyo_n = 2000 + #0#3;
        |FINSI;
        |SUB_EJECUTA_NP "asnompa2";
        nSwSoloImp = 0;
        |SI h_comun ! 0;
            canti  = 1;
            import = h_comun;
            tlinea = canti * import;
            |SI #5#2 = "N";
                seccion  = #5#67;
                concepto = #5#68;
                |HAZ leeconc;
                |PRINT; sw = 1;
            |FINSI;
        |FINSI;
   |FINSI;

   |SI #5#2 = "S";                              || globaliza
        seccion  = #5#3;
        concepto = #5#4;
        canti = 1;
        import = h_fijas + h_nomin + h_finiq + h_pagas + h_tc1 + h_tc2 + h_tc21 + h_contr + h_prorr + h_comun;
        tlinea = import;
        |HAZ leeconc;
        |PRINT; sw = 1;
   |FINSI;

   |SI #5#56 = "S";
       seccion  = #5#57;
       concepto = #5#58;       || suplidos TC1
        canti   = 1;
        import  = #1#18;
        tlinea  = import;
        h_sutc1 = import;
        |HAZ leeconc;
        |PRINT; sw = 1;
   |FINSI;

   |SI menu2 = 1;
       honorario = h_fijas + h_nomin + h_pagas + h_tc1 + h_tc2 +h_tc21+ h_contr + h_prorr + h_finiq + h_comun;
       suplido   = h_sutc1;
       |SI honorario ! 0; |O suplido ! 0;
           |PIEINF;
       |FINSI;
   |FINSI;
|FPRC;

|CALCULO ordena;
    |DDEFECTO #4;
    #4#0 = #1#0;
    |LEE 000#4=;
|FCAL;

|DEFBUCLE asnomdat;
   #1#1;
   ;
   #0#0, #0#2, #0#3;
   #0#1, #0#2, #0#3;
   e;
   NULL, ordena, NULL, NULL, NULL, impresio;
   #4#2, #4#0, #1#2, #1#1;
|FIN;

|PROCESO impre; |TIPO 3;
    |MENU menu;
    menu2 = FSalida;
    |SI menu2 ! 1; |Y menu2 ! 2; |ACABA; |FINSI;

    |IMPRE 0;
    |SI FSalida ! 0; |ACABA; |FINSI;

    |SI menu2 = 1; |INFOR "asnompre"; |FINSI;
    |SI menu2 = 2; |INFOR "asnompr2"; |FINSI;
    |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;

    |ABRE #999;
    |LEE 000#999p;
    |SI FSalida ! 0;
        |DDEFECTO #999;
        |GRABA 020#999c;
    |FINSI;
    |CIERRA #999;
    aCampo8 = #999#8;
    aCampo9 = #999#9;
    |SI aCampo9 = "N";
        aCampo8 = "S";
    |FINSI;

    sw = 0;
    |ABRE #2;
    |ABRE #3;
    |ABRE #4;
    |ABRE #5;
    |ABRE #6;

    |BUCLE asnomdat;
    |SI menu2 = 2;
        |SI sw = 1;
           honorario = honorario + h_fijas + h_nomin + h_pagas + h_tc1 + h_tc2;
           honorario = honorario + h_contr + h_prorr + h_tc21 + h_finiq + h_comun;
           suplido   = suplido + h_sutc1;
           |PIEINF;
        |FINSI;
    |FINSI;

    |FININF;
    |FINIMP;

    |CIERRA #2;
    |CIERRA #3;
    |CIERRA #4;
    |CIERRA #5;
    |CIERRA #6;
|FPRC;
