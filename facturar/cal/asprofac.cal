|FICHEROS;
     asprofac;
|FIN;

|VARIABLES;
     aAlfa         = "";

     &enErrorFac   = 0;
     &d_viene      = 0;
     &enTipo       = 0;
     &enTipoFac    = 0;
     &enCliente    = 0;
     &enModVisados = 0;
     &eaParaConta  = "";
|FIN;

|PROCESO Tipo0C4; |TIPO 0;
     aAlfa = #asprofac#4;
     |SI aAlfa = "N";
         #asprofac#5 = "N"; |PINTA #asprofac#5;
     |FINSI;
     |C_M #asprofac#5, 1, aAlfa;
|FPRC;

|PROCESO Tipo12;  |TIPO 12;
     |SI #asprofac#1 = "N"; |Y #asprofac#2 = "N"; |Y #asprofac#3 = "N";
         |Y #asprofac#4 = "N";

         |MENAV "0000No se ha realizado ningun proceso";
         |ACABA;
     |FINSI;

     |SI #asprofac#1 = "S";
         enTipoFac  = enTipo;
         enErrorFac = 1;
         |SUB_EJECUTA "asprepar";

         |SI enErrorFac = 1;
             |MENAV "0000Proceso facturacion completa CANCELADO.";
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #asprofac#2 = "S";
         d_viene    = 0;
         enErrorFac = 1;
         enTipoFac  = enTipo;
         |SI enCliente = 0;  |SUB_EJECUTA "asfacges";                |FINSI;
         |SI enCliente ! 0;  |SUB_EJECUTA "asfacges;SOLOUNAMINUTA";  |FINSI;

         |SI enErrorFac = 1;
             |MENAV "0000Proceso emision y actualizacion  CANCELADO.";
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #asprofac#3 = "S";
         d_viene    = 0;
         enErrorFac = 1;
         enTipoFac  = enTipo;
         |SI enCliente = 0;  |SUB_EJECUTA "asrecges";                |FINSI;
         |SI enCliente ! 0;  |SUB_EJECUTA "asrecges;SOLOUNAMINUTA";  |FINSI;

         |SI enErrorFac = 1;
             |MENAV "0000Proceso emision y actualizacion  CANCELADO.";
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #asprofac#4 = "S";
         eaParaConta  = #asprofac#5;
         enErrorFac   = 1;
         enTipoFac    = enTipo;
         enModVisados = 1;
         |SI enCliente = 0;  |SUB_EJECUTA "asactual;TODAS";          |FINSI;
         |SI enCliente ! 0;  |SUB_EJECUTA "asactual;SOLOUNAMINUTA";  |FINSI;

         |SI enErrorFac = 1;
             |MENAV "0000Proceso actualizacion  CANCELADO.";
             |ACABA;
         |FINSI;
     |FINSI;

     |MENAV "0000Proceso facturacion completa TERMINADA.";
|FPRC;

|PROGRAMA;
     |PUSHV 0501 2380;
     |ABRE #asprofac;
     |LEE 101#asprofac.p;
     |SI FSalida ! 0;
         |DDEFECTO #asprofac;
         |GRABA 020#asprofac.b;
     |FINSI;

     |PINPA #0#asprofac;
     |PINDA #0#asprofac;
     |ENDATOS #1#asprofac;
     |SI FSalida = 0;
         |GRABA 020#asprofac.a;
     |FINSI;
     |LIBERA #asprofac;
     |CIERRA #asprofac;
     |POPV;
|FPRO;
