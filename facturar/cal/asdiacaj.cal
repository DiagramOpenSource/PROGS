|FICHEROS;
   asdiacaj #0;

   asmovtos #1;
   asdiapan #2;
   asmancaj #3;
|FIN;

|VARIABLES;
   &SwIniCaja  = 0;
   &SwFinCaja  = 0;
   &SwIniFecha = 0;
   &SwFinFecha = 0;
   &SwLinea    = 0;
   &TotDeFecha = 0;
   &TotHaFecha = 0;
   &TotDeCaja  = 0;
   &TotHaCaja  = 0;
   PuntLin     = 0;
   CajaAnt     = 0;
   Calc        = 0;
   PrimCaja    = 0;
   PrimFecha   = 0;

   Comodin     = "";
   Comodin1    = "";
   Comodin2    = "";
   &FechAnt    = "";
   &CuentaMov  = "";
   &enSig      = 0;
   informe     = "";
|FIN;

/*
|PROCESO PintaDato;
   Calc = (PuntLin * 100) + 1;
   |C_P #asdiapan#0,1,Calc; |PINDA #0#asdiapan;
   PuntLin = PuntLin + 1;
   |SI PuntLin > 23;
      |PAUSA; |CLS; |PINPA #0#asdiapan;
      PuntLin = 7;
   |FINSI;
|FPRC;

|PROCESO Impresora;
  |SI CajaAnt ! #1#0;
      |SI PrimCaja = 0;
         SwFinCaja = 1; |PRINT; SwFinCaja = 0;
         TotalCaja = 0;
      |SINO;
         PrimCaja = 0;
      |FINSI;
      #3#0 = #1#0;
      |LEE 000#3.=;
      SwIniCaja = 1; |PRINT; SwIniCaja = 0;
      CajaAnt = #1#0;
   |FINSI;
   |SI FechAnt ! #1#1;
      |SI PrimFecha = 0;
         SwFinFecha = 1; |PRINT; SwFinFecha = 0;
         TotalFecha = 0;
      |SINO;
         PrimFecha = 0;
      |FINSI;
      SwIniFecha = 1; |PRINT; SwIniFecha = 0;
      FechAnt = #1#1;
   |FINSI;
   |SI #1#6 = "            ";
      CuentaMov  = #1#7 + "  H ";
      TotalCaja  = TotalCaja  - #1#8;
      TotalFecha = TotalFecha - #1#8;
   |SINO;
      CuentaMov  = #1#6 + "  D ";
      TotalCaja  = TotalCaja  + #1#8;
      TotalFecha = TotalFecha + #1#8;
   |FINSI;
   SwLinea = 1; |PRINT; SwLinea = 0;
|FPRC;

|PROCESO Pantalla;
   |SI CajaAnt ! #1#0;
      |SI PrimCaja = 0;
         #asdiapan#0 = "";      |HAZ PintaDato;
         Comodin = "             =======================================";
         #asdiapan#0 = Comodin; |HAZ PintaDato;
         Comodin = "             TOTAL CAJA .............. " + (("             " + TotalCaja) % -113);
         #asdiapan#0 = Comodin; |HAZ PintaDato;
         TotalCaja = 0;
      |SINO;
         PrimCaja = 0;
      |FINSI;
      |SI PuntLin > 15;
         |PARA; |SI PuntLin ! 7; |HACIENDO;
            #asdiapan#0 = ""; |HAZ PintaDato;
         |SIGUE;
      |FINSI;
      #3#0 = #1#0;
      |LEE 000#3.=;
      #asdiapan#0 = "";      |HAZ PintaDato;
      Comodin = ("00" + #1#0) % -102;
      Comodin1 = #3#1; |QBF Comodin1;
      Comodin = " CAJA " + Comodin + " (" + Comodin1 + ")";
      #asdiapan#0 = Comodin; |HAZ PintaDato;
      |QBF Comodin; Comodin = Comodin % 0; Calc = Comodin; Calc = Calc - 1;
      Comodin = "=" * Calc;
      #asdiapan#0 = " " + Comodin; |HAZ PintaDato;
      #asdiapan#0 = "";      |HAZ PintaDato;
      CajaAnt = #1#0;
   |FINSI;
   |SI FechAnt ! #1#1;
      |SI PrimFecha = 0;
         #asdiapan#0 = "";      |HAZ PintaDato;
         Comodin = "             =======================================";
         #asdiapan#0 = Comodin; |HAZ PintaDato;
         Comodin = "             Total fecha " + FechAnt + " .. " + (("             " + TotalFecha) % -113);
         #asdiapan#0 = Comodin; |HAZ PintaDato;
         TotalFecha = 0;
      |SINO;
         PrimFecha = 0;
      |FINSI;
      |SI PuntLin > 17;
         |PARA; |SI PuntLin ! 7; |HACIENDO;
            #asdiapan#0 = ""; |HAZ PintaDato;
         |SIGUE;
      |FINSI;
      #asdiapan#0 = "";      |HAZ PintaDato;
      Comodin = " Fecha : " + #1#1;
      #asdiapan#0 = Comodin; |HAZ PintaDato;
      #asdiapan#0 = "";      |HAZ PintaDato;
      Comodin = "      Linea Tipo Secc Cp Cuenta Cont. Sg   Importe   Cliente  Expediente ";
      #asdiapan#0 = Comodin; |HAZ PintaDato;
      Comodin = "-" * 66;
      #asdiapan#0 = "      " + Comodin; |HAZ PintaDato;
      FechAnt = #1#1;
  |FINSI;
   Comodin = ("0000" + #1#2) % -104;
   Comodin1 = ("00" + #1#3) % -102;
   Comodin = "       " + Comodin + "  " + Comodin1 + "  " + #1#4;
   Comodin = Comodin + " " + #1#5 + " ";
   |SI #1#6 = "            ";
      Comodin = Comodin + #1#7 + "  H ";
      TotalCaja  = TotalCaja  + #1#8;
      TotalFecha = TotalFecha + #1#8;
   |SINO;
      Comodin = Comodin + #1#6 + "  D ";
      TotalCaja  = TotalCaja  - #1#8;
      TotalFecha = TotalFecha - #1#8;
   |FINSI;
   Comodin1 = ("           " + #1#8) % -111;
   Comodin = Comodin + Comodin1 + "  ";
   Comodin1 = ("00000" + #1#9) % -105;
   Comodin = Comodin + Comodin1 + "   ";
   Comodin1 = (("00" + #1#10) % -102) + "/" + (("000000" + #1#11) % -106);
   Comodin = Comodin + Comodin1;
   #asdiapan#0 = Comodin; |HAZ PintaDato;
|FPRC;

|PROCESO Diario;
   |SI #0#4 = "S";
       |HAZ Pantalla;
   |SINO;
       |HAZ Impresora;
   |FINSI;
|FPRC;

|DEFBUCLE Diario;
 #1#1;
 ;
 #0#0,#0#2,0001;
 #0#1,#0#3,9999;
 ;
 NULL,Diario;
|FIN;

|CALCULO ElInforme; |TIPO 3;

     |SI #0#4 = "N";
         |IMPRE 0;
         |SI FSalida ! 0;
             |MENAV "    Proceso abortado ";
             |ACABA;
         |FINSI;
         |INFOR "asdiacaj";
         |SI FSalida ! 0;
             |MENAV "    No Existe Informe ";
             |FINIMP;
             |ACABA;
         |FINSI;
      |SINO;
         |CLS;
         |PINPA #0#2;
      |FINSI;

      |ABRE #3;
      PuntLin    = 6;
      PrimCaja   = 1;
      PrimFecha  = 1;
      TotalCaja  = 0;
      TotalFecha = 0;

      |BUCLE Diario;
      |SI TotalFecha ! 0;
          |SI #0#4 = "S";
              #asdiapan#0 = "";      |HAZ PintaDato;
              Comodin = "             =======================================";
              #asdiapan#0 = Comodin; |HAZ PintaDato;
              Comodin = "             Total fecha " + FechAnt + " .. " + (("             " + TotalFecha) % -113);
              TotalFecha = 0;
              #asdiapan#0 = Comodin; |HAZ PintaDato;
         |SINO;
              SwFinFecha = 1; |PRINT; SwFinFecha = 0;
         |FINSI;
      |FINSI;
      |SI TotalCaja ! 0;
         |SI #0#4 = "S";
            #asdiapan#0 = "";      |HAZ PintaDato;
            Comodin = "             =======================================";
            #asdiapan#0 = Comodin; |HAZ PintaDato;
            Comodin = "             TOTAL CAJA .............. " + (("             " + TotalCaja) % -113);
            #asdiapan#0 = Comodin; |HAZ PintaDato;
         |SINO;
            SwFinCaja = 1; |PRINT; SwFinCaja = 0;
         |FINSI;
      |FINSI;
      |CIERRA #3;

      |SI PuntLin > 7; |PAUSA;  |FINSI;

      |SI #0#4 = "N";
         |PIEINF;
         |FININF;
         |FINIMP;
      |FINSI;
|FCAL;
*/

|PROCESO PintaDato;
   PuntLin = PuntLin + 1;
   |SI PuntLin > 23;
       |PAUSA;
       |CLS;
       |PINPA #0#2;
       |PINTA #2#1;
       |PINTA #2#2;
       PuntLin = 6;
   |FINSI;

   Calc = (PuntLin * 100) + 1;
   |C_P #2#0,1,Calc;
   |PINTA #2#0;
|FPRC;

|PROCESO FinalCaja;
   |SI #0#4 = "N";
       |PIEINF;
   |SINO;
        #asdiapan#0 = "";      |HAZ PintaDato;
        Comodin = "             =======================================";
        #asdiapan#0 = Comodin; |HAZ PintaDato;
        Comodin  = "  TOTAL CAJA .............. ";
        Comodin1 = (("             " + TotDeCaja) % -113);
        Comodin2 = (("             " + TotHaCaja) % -113);
        Comodin = Comodin + Comodin1 + Comodin2;
        #2#0 = Comodin; |HAZ PintaDato;
        |PAUSA;
   |FINSI;
|FPRC;

|PROCESO FinalFecha;
   SwFinFecha = 1;
   |SI #0#4 = "N";
       |PRINT;
   |SINO;
        #asdiapan#0 = "";      |HAZ PintaDato;
        Comodin     = "            =======================================";
        #asdiapan#0 = Comodin; |HAZ PintaDato;
        Comodin     = " Total fecha " + FechAnt + " .. ";
        Comodin1    = (("             " + TotDeFecha) % -113);
        Comodin2    = (("             " + TotHaFecha) % -113);
        Comodin     = Comodin + Comodin1 + Comodin2;
        #asdiapan#0 = Comodin; |HAZ PintaDato;
   |FINSI;
   SwFinFecha = 0;
   TotDeFecha = 0;
   TotHaFecha = 0;
|FPRC;

|PROCESO InicioFecha;
      SwIniFecha = 1;
      |SI #0#4 = "N";
          |PRINT;
      |SINO;
           |SI PuntLin > 18;
               |PARA; |SI PuntLin ! 6; |HACIENDO;
                      #asdiapan#0 = ""; |HAZ PintaDato;
               |SIGUE;
            |FINSI;
            Comodin     = " Fecha : " + #1#1;
            #asdiapan#0 = Comodin; |HAZ PintaDato;
            #asdiapan#0 = "";      |HAZ PintaDato;
            Comodin = "Linea Tipo Secc Cp Cuenta Importe Debe  Importe Haber  Cliente  Expediente ";
            #asdiapan#0 = Comodin; |HAZ PintaDato;
            Comodin = "-" * 78;
            #asdiapan#0 = " " + Comodin; |HAZ PintaDato;
      |FINSI;
      SwIniFecha = 0;
      FechAnt    = #1#1;
|FPRC;

|PROCESO Diario;

   |SI FechAnt ! #1#1;
       |SI PrimFecha = 0;
           |HAZ FinalFecha;
      |SINO;
           PrimFecha = 0;
      |FINSI;
      |HAZ InicioFecha;
   |FINSI;

   |SI #1#6 = "            ";
       enSig      = 1;
       CuentaMov  = #1#7;
       TotHaCaja  = TotHaCaja  + #1#8;
       TotHaFecha = TotHaFecha + #1#8;
   |SINO;
       enSig      = 0;
       CuentaMov  = #1#6;
       TotDeCaja  = TotDeCaja  + #1#8;
       TotDeFecha = TotDeFecha + #1#8;
   |FINSI;
   SwLinea = 1;
   |SI #0#4 = "N";
       |PRINT;
   |SINO;
       |HAZ Pantalla;
   |FINSI;
   SwLinea = 0;
|FPRC;

|PROCESO Pantalla;
   Comodin = ("0000" + #1#2) % -104;
   Comodin1 = ("00"  + #1#3) % -102;
   Comodin = "       " + Comodin + "  " + Comodin1 + "  " + #1#4;
   Comodin = Comodin + " " + #1#5 + " ";
   |SI #1#6 = "            ";
       Comodin = Comodin + #1#7 + "  H ";
   |SINO;
       Comodin = Comodin + #1#6 + "  D ";
   |FINSI;
   Comodin1 = ("           " + #1#8) % -111;
   Comodin = Comodin + Comodin1 + "  ";
   Comodin1 = ("00000" + #1#9) % -105;
   Comodin = Comodin + Comodin1 + "   ";
   Comodin1 = (("00" + #1#10) % -102) + "/" + (("000000" + #1#11) % -106);
   Comodin = Comodin + Comodin1;
   #asdiapan#0 = Comodin; |HAZ PintaDato;
|FPRC;

|DEFBUCLE Diario;
 #1#1;
 ;
 #3#0, #0#2, 0001;
 #3#0, #0#3, 9999;
 ;
 NULL,Diario;
|FIN;

|PROCESO LeeMvtos;
    PuntLin    = 6;
    |SI #0#4 = "S";
        #2#1 = #3#0; |PINTA #2#1;
        #2#2 = #3#1; |PINTA #2#2;
    |FINSI;
    PrimFecha  = 1;
    TotDeCaja  = 0;
    TotHaCaja  = 0;
    TotDeFecha = 0;
    TotHaFecha = 0;
    |BUCLE Diario;
    |SI PrimFecha = 0;
        |HAZ FinalFecha;
        |HAZ FinalCaja;
    |FINSI;
|FPRC;

|DEFBUCLE LeeCajas;
 #3#1;
 ;
 #0#0;
 #0#1;
 e;
 NULL, LeeMvtos;
|FIN;

|CALCULO ElInforme; |TIPO 3;

     |SI #0#4 = "N";
         |IMPRE 0;
         |SI FSalida ! 0;
             |MENAV "    Proceso abortado ";
             |ACABA;
         |FINSI;
         |INFOR "asdiacaj";
         |SI FSalida ! 0;
             |MENAV "    No Existe Informe ";
             |FINIMP;
             |ACABA;
         |FINSI;
      |SINO;
         |CLS;
         |PINPA #0#2;
      |FINSI;

      |BUCLE LeeCajas;

      |SI #0#4 = "N";
         |FININF;
         |FINIMP;
      |FINSI;
|FCAL;
