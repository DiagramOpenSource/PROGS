|FICHEROS;
     abom0002 #2;
     dsam0121 #121;
     abom0514 #514;
|FIN;

|VARIABLES;
     nHandle          = 0;

     aRutaOrigen      = "";
     aRutaDestino     = "";
     aAlfa            = "";
     aAlfa1           = "";
     aFichero         = "";
     aAbre            = "";
     aOri             = "";
     aDes             = "";
     &eaRutaLocal     = "";

     &enEsped         = 0;
     &efFechaDocu     = @;
     &enCodUbica      = 0;
     &eaRutaDocumento = "";
     &eaCache         = "";
     &eaUnidadBasico = "";
|FIN;

|PROCESO abom0002;
     efFechaDocu    = #2#4;
     enCodUbica     = #2#10;
     |HAZ LeeUbicaciones;

     aAlfa = eaUnidadBasico + "\DOCUMENTOS";                   |RMKDIR aAlfa;
     aAlfa = aAlfa + "\IPABOGAD";               |RMKDIR aAlfa;
     |SI eaCache = "S";
         aAlfa = aAlfa + "\" + ((  "00" + #48#0)  % -102);  |RMKDIR aAlfa;
         aAlfa = aAlfa + "\" + (("0000" + #121#0) % -104);   |RMKDIR aAlfa;

         |SI #121#4 = "S";
             |SI efFechaDocu ! "00.00.0000";
                 aAlfa = aAlfa + "\" + (efFechaDocu % -104) + (efFechaDocu % 402);
                 |RMKDIR aAlfa;
             |FINSI;
         |FINSI;
     |FINSI;

     eaRutaLocal = aAlfa + "\";

     aOri  = eaRutaDocumento + "/" + #2#3;   |QBF aOri;
     aDes  = eaRutaLocal + #2#3;             |QBF aDes;
     |ENVIA_FICHERO aOri, aDes;
|FPRC;

|DEFBUCLE abom0002;
     #2#1;
     ;
     enEsped, 00001;
     enEsped, 99999;
     ;
     NULL, abom0002;
|FIN;

|PROGRAMA;
     |HAZ LeeUnidadBasico;

     |BLANCO 0601 2380;
     |CUADRO 0601 2380;

     |ATRI I;
     |PINTA 1220, "P A S A N D O   D O C U M E N T O S";
     |ATRI i;

     |ATRI S;
     |PINTA 1420, "Espere por favor ...";
     |ATRI s;

     |BUCLE abom0002;
|FPRO;
