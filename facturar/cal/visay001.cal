|FICHEROS;
     visay001 #0;

     visam001 #1;
|FIN;

|VARIABLES;
     nExiste = 0;
     aMensaje = "";
     aAux = "";
     aInforme = "";
     nSwPie = 0;
|FIN;

|PROGRAMA;
     |CLS;
     |ABRE #0;
     |DDEFECTO #0;
     |LEE 101#0p;
     nExiste = FSalida;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |SI nExiste = 0;
               |GRABA 020#0a;
          |SINO;
               |GRABA 020#0n;
          |FINSI;
          |HAZ Principal;
     |FINSI;
     |LIBERA #0;
     |CIERRA #0;
|FPRO;

|PROCESO visam001;
     |SI #visay001#11 = "R"; |Y #visam001#21 ! "R";
          |ACABA;
     |FINSI;
     |SI #visay001#11 = "E"; |Y #visam001#21 ! "E";
          |ACABA;
     |FINSI;
     |SI #visay001#11 = "P"; |Y #visam001#21 ! " ";
          |ACABA;
     |FINSI;

     |SI #visay001#12 = "S"; |Y #visam001#22 ! "S";
          |ACABA;
     |FINSI;
     |SI #visay001#12 = "N"; |Y #visam001#22 ! "N";
          |ACABA;
     |FINSI;

     |SI #visay001#13 = "S"; |Y #visam001#12 ! "S";
          |ACABA;
     |FINSI;
     |SI #visay001#13 = "N"; |Y #visam001#22 ! "N";
          |ACABA;
     |FINSI;

     nSwPie = 1;
     |PRINT;
|FPRC;



|DEFBUCLE visam001;
 #visam001#1;
 1, 5, 16;
 #visay001#1, #visay001#3, #visay001#5, #visay001#9 , #visay001#7;
 #visay001#2, #visay001#4, #visay001#6, #visay001#10, #visay001#8;
 ;
 NULL, visam001;
|FIN;

|PROCESO Principal;
     |IMPRE 0;
     |SI FSalida = 0;
          aInforme = "visay001";
          |INFOR aInforme;
          |SI FSalida = 0;
               |BUCLE visam001;
               |SI nSwPie = 1;
                    |PIEINF;
               |FINSI;
               |FININF;
          |SINO;
               aMensaje = "0000Informe " + aInforme + " inaccesible.";
               |MENAV aMensaje;
          |FINSI;
          |FINIMP;
     |SINO;
          |MENAV "0000Proceso cancelado.";
     |FINSI;
|FPRC;
