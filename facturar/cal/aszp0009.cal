|FICHEROS;
     aszp0006 #0;             || Este Def
     asconcli #1;             || Conceptos Clientes
     asclient #2;             || Clientes
     ashiscon #100;

    :/basica/def/agitab03 #3;
    :/integral/def/dsam0008 #44;
|FIN;

|VARIABLES;
     nIva         = 0;
     nConcepto    = 0;
     nTotalHis    = 0;

     &enCodCli    = 0;
     &enSwDeDonde = 0;
|FIN;

|PROCESO BuscaConcepto;
     |SI #3#2 = "    "; |Y #3#3 = "  "; |ACABA; |FINSI;
     |SI #3#5 ! #48#0;  |Y #3#5 ! 0;    |ACABA; |FINSI;
     |SI #3#2 ! #1#1;   |O #3#3 ! #1#2; |ACABA; |FINSI;

     nConcepto = #3#0;
     |ERROR10;
|FPRC;

|DEFBUCLE agitab03;
     #3#1;
     ;
     00;
     99;
     ;
     NULL, BuscaConcepto;
|FIN;

|PROCESO GrabaContratacionI;
     |SI #44#5 ! #1#10;
         #44#5 = #1#10;
         |SI #44#8 = "S";
             nIva   = #44#5 % #44#9;
             #44#10 = #44#5 + nIva;
         |FINSI;
         |GRABA 020#44a;
         |LIBERA #44;
     |FINSI;
|FPRC;

|DEFBUCLE dsam0008;
     #44#1;
     2;
     #1#0, 00, nConcepto;
     #1#0, 99, nConcepto;
     be;
     NULL, GrabaContratacionI;
|FIN;

|PROCESO ConsultaHistorico;
     nTotalHis = #100#9;
|FPRC;

|DEFBUCLE ashiscon;
     #100#4;
     3, 5, 6;
     #1#0, "  ", 00000, 000, "01.01.2002", #1#1, #1#2;
     #1#0, "zz", 99999, 999, "31.12.2002", #1#1, #1#2;
     ;
     NULL, ConsultaHistorico;
|FIN;

|PROCESO GrabaContratacion;
     nTotalHis = 0;
     |BUCLE ashiscon;

     |SI nTotalHis ! #1#10;  |Y nTotalHis ! 0;
         #1#10 = nTotalHis;
     |FINSI;

     nConcepto = 0;
     |BUCLE agitab03;
     |SI nConcepto = 0;  |ACABA;  |FINSI;

     |SI enSwDeDonde = 1;
         |BUCLE dsam0008;
     |FINSI;
|FPRC;

|DEFBUCLE asconcli;
     #1#1;
     ;
     00000, "     ", "  ";
     99999, "zzzzz", "zz";
     be;
     NULL, GrabaContratacion;
|FIN;

|PROGRAMA;
     enCodCli = 0;
     |HAZ LeePersona;

     |BUCLE asconcli;
|FPRO;
