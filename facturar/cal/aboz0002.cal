|FICHEROS;
     aboz0002 #0;
     abom0006 #6;
     abow0001 #99,MANTE;
|FIN;

|VARIABLES;
     nFecha   = 0;
     nSwGraba = 0;

     aFichero = "";
     aQueDia  = "";
     aAlfa    = "";
     aDPlazo  = "";
     aHPlazo  = "";

     fFecha   = @;

     &vacio37 = "                                                  ";
|FIN;

|PROCESO ImprimeAviso;
     |PRINT;
|FPRC;

|DEFBUCLE abow0001I;
     #99#1;
     14, 16;
     "00.00.0000", 00, 00, 00000000, "00.00.0000", 00, 00, 00, "N", aDPlazo;
     "31.12.9999", 99, 99, 99999999, "31.12.2999", 99, 99, 99, "N", aHPlazo;
     ;
     NULL, ImprimeAviso;
|FIN;

|PROCESO Tipo11W001;  |TIPO 11;
     |SI FSalida ! 10;  |Y FSalida ! 11;  |ACABA; |FINSI;

     |SI FSalida = 10;
         |LEE 101#99=;

         |SI #99#14 = "S";
             #99#14 = "N";
         |SINO;
             #99#14 = "S";
         |FINSI;
         |PINTA #99#14;

         |GRABA 020#99a;
         |LIBERA #99;
     |FINSI;

     |SI FSalida = 11;
         |SALVA_DATOS #99;
         |IMPRE 0;
         |SI FSalida = 0;
             |INFOR "aboz0002";
             |SI FSalida = 0;
                 aDPlazo = "N";
                 aHPlazo = "S";
                 |CONFI "2400NEmitir solo los Plazos : ";
                 |SI FSalida = 0;
                     aDPlazo = "S";
                     aHPlazo = "S";
                 |FINSI;
                 |BUCLE abow0001I;
                 |PIEINF;
                 |FININF;
             |FINSI;
             |FINIMP;
         |FINSI;
         |REPON_DATOS #99;
         |LEE 101#99=;
     |FINSI;

     |ERROR;
|FPRC;

|PROCESO GrabaTempo;
                              || -T- Todos los Dias

     fFecha  = #0#0 % 1;
     aQueDia = fFecha % 11;  |QBT aQueDia;  aQueDia = aQueDia > aQueDia;

     |SI #6#17 = "0";         || Solo el Dia del Aviso
         |SI #6#5 > #0#0;  |ACABA;  |FINSI;
     |FINSI;

     |SI #6#17 = "2";
         nFecha  = #6#5 - #0#0;
         |SI nFecha > 14;  |ACABA;  |FINSI;
         |SI nFecha < 0;   |ACABA;  |FINSI;
     |FINSI;

     |SI #6#17 = "1";
         nFecha  = #6#5 - #0#0;
         |SI nFecha > 7;   |ACABA;  |FINSI;
         |SI nFecha < 0;   |ACABA;  |FINSI;
     |FINSI;

     |SI #6#17 = "L";  aAlfa = "LUNES";      |FINSI;
     |SI #6#17 = "M";  aAlfa = "MARTES";     |FINSI;
     |SI #6#17 = "X";  aAlfa = "MIERCOLES";  |FINSI;
     |SI #6#17 = "J";  aAlfa = "JUEVES";     |FINSI;
     |SI #6#17 = "V";  aAlfa = "VIERNES";    |FINSI;
     |SI #6#17 = "S";  aAlfa = "SABADO";     |FINSI;
     |SI #6#17 = "D";  aAlfa = "DOMINGO";    |FINSI;

     |SI #6#17 ! "0";  |Y #6#17 ! "T"; |Y #6#17 ! "1"; |Y #6#17 ! "2";
         |SI aQueDia ! aAlfa;  |ACABA;  |FINSI;
     |FINSI;

     nSwGraba = 1;

     #99#14 = "N";
     |SI #6#5 < #0#0;  #99#14 = "S";  |FINSI;

     #99#0  = #6#5;
     #99#1  = #6#6;
     #99#2  = #6#7;
     #99#3  = #6#17;
     #99#4  = #6#1;
     #99#5  = #6#2;
     #99#6  = #6#3;
     #99#7  = #6#0;
     #99#8  = #6#10;
     #99#9  = #6#11;
     #99#10 = #6#12;
     #99#11 = #6#13;
     #99#12 = #6#14;
     #99#13 = #6#15;
     #99#15 = #6#18;
     #99#15 = #6#18;
     #99#16 = #6#19;

     |GRABA 020#99n;
|FPRC;

|DEFBUCLE abom0006;
     #6#3;
     ;
     #0#1, "N";
     #0#1, "N";
     ;
     NULL, GrabaTempo;
|FIN;

|RUTINA ClaveBaja;
     #99#0  = "01.01.0000";
     #99#1  = 00;
     #99#2  = 00;
     #99#7  = 0;
     #99#4  = "01.01.0000";
     #99#5  = 00;
     #99#6  = 00;
     #99#15 = 00;
|FRUT;

|RUTINA ClaveAlta;
     #99#0  = "3.12.2999";
     #99#1  = 99;
     #99#2  = 99;
     #99#7  = 99999999;
     #99#4  = "31.12.2999";
     #99#5  = 99;
     #99#6  = 99;
     #99#15 = 99;
|FRUT;

|PROCESO GrabaAviso;
     #6#0  = #99#7;
     #6#1  = #99#4;
     #6#2  = #99#5;
     #6#3  = #99#6;
     #6#18 = #99#15;
     |LEE 101#6=;
     |SI FSalida = 0;
         #6#16 = "S";
         |GRABA 020#6a;
         |LIBERA #6;
     |FINSI;
|FPRC;

|DEFBUCLE abow0001G;
     #99#1;
     14;
     "00.00.0000", 00, 00, 00000000, "00.00.0000", 00, 00, 00, "S";
     "31.12.9999", 99, 99, 99999999, "31.12.2999", 99, 99, 99, "S";
     ;
     NULL, GrabaAviso;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     aFichero = ("b5" + Usuario + "zzzzzzzz") % 108;  |NOME_DAT #99 aFichero;
     |ABRE #99;  |CIERRA #99;  |DELINDEX #99;

     nSwGraba = 0;
     |ABRE #99;
     |BUCLE abom0006;
     |CIERRA #99;

     |SI nSwGraba = 0;
         |MENAV "       Seleccion Vacia.";
         |ACABA;
     |FINSI;

     |ENTLINEAL #1#99, -3, 4, 21, 0, ClaveBaja, ClaveAlta;

     |ABRE #6;
     |BUCLE abow0001G;
     |CIERRA #6;

     |DELINDEX #99;
|FPRC;
