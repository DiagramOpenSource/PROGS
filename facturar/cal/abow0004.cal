|FICHEROS;
     aboy0002 #0;
     abom0007 #7;
     abom0009 #9;
     abom0505 #505;
     abow0004 #100,MANTE;
     abow0009 #101;
     asempres #102;
|FIN;

|VARIABLES;
     nVariable      = 0;
     nPersona       = 0;
     aFichero       = "";
     aAlfa          = "";
     fFecha         = @;

     &enSw          = 0;
     &eaDescri      = "";
     &eaNombreList  = "";
     &enCuadroIni   = 0;
     &enCuadroFin   = 0;
     &enCampoAncho  = 0;
     &enModoEdita   = 0;
     &enTotalVaria  = 0;
{101}&epPuntEdita   = "";
|FIN;

|PROCESO EditaAsunto1;
     enTotalVaria  = 99;
     eaNombreList  = "";
     enCuadroIni   = 1030;
     enCuadroFin   = 1879;
     enCampoAncho  = 50;
     enModoEdita   = 1;

     |ABRE #7;
     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita  = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           #7#0 = #100#4;
           #7#1 = #100#5;
           #7#2 = nVariable;
           |LIBERA #7;
           |LEE 101#7=;
           |SI FSalida ! 0;
               epPuntEdita  = "";
           |SINO;
               epPuntEdita  = #7#3;
           |FINSI;
     |SIGUE;
     |CIERRA #7;

     |PUSHV  0501 2380;
     |CUADRO 0829 2080;
     |BLANCO 0930 1979;
     |ATRI S;  |PINTA 0936, "Texto";  |ATRI s;

     |HAZ Edita;
     |POPV;
|FPRC;

|PROCESO EditaAsunto2;
     enTotalVaria  = 99;
     eaNombreList  = "";
     enCuadroIni   = 1030;
     enCuadroFin   = 1879;
     enCampoAncho  = 50;
     enModoEdita   = 1;

     |ABRE #9;
     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita  = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           #9#0 = #100#2;
           #9#1 = #100#5;
           #9#2 = nVariable;
           |LIBERA #9;
           |LEE 101#9=;
           |SI FSalida ! 0;
               epPuntEdita  = "";
           |SINO;
               epPuntEdita  = #9#3;
           |FINSI;
     |SIGUE;
     |CIERRA #9;

     |PUSHV  0501 2380;
     |CUADRO 0829 2080;
     |BLANCO 0930 1979;
     |ATRI S;  |PINTA 0936, "Texto";  |ATRI s;

     |HAZ Edita;
     |POPV;
|FPRC;

|PROCESO Imprime;
     |SI nPersona ! #100#1;  |Y nPersona ! 0;  |Y #0#14 = 0;
         |PIEINF;
     |FINSI;

     nPersona = #100#1;

     |SI #100#4 ! 0;
         |ABRE #7;
         #7#0 = #100#4;
         #7#1 = #100#5;
         #7#2 = 1;
         |LEE 040#7=;
         |SI FSalida ! 0;  |DDEFECTO #7;  |FINSI;

         eaDescri = #7#3;
         enSw     = 0;  |PRINT;

         |PARA nVariable = 2;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
               #7#0 = #100#4;
               #7#1 = #100#5;
               #7#2 = nVariable;
               |LEE 040#7=;
               |SI FSalida = 0;
                   eaDescri = #7#3;
                   enSw = 1;  |PRINT;
               |SINO;
                   |SAL;
               |FINSI;
         |SIGUE;
         |CIERRA #7;
     |SINO;
         |ABRE #9;
         #9#0 = #100#2;
         #9#1 = #100#5;
         #9#2 = 1;
         |LEE 040#9=;
         |SI FSalida ! 0;  |DDEFECTO #9;  |FINSI;

         eaDescri = #9#3;
         enSw     = 0;  |PRINT;

         |PARA nVariable = 2;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
               #9#0 = #100#2;
               #9#1 = #100#5;
               #9#2 = nVariable;
               |LEE 040#9=;
               |SI FSalida = 0;
                   eaDescri = #9#3;
                   enSw = 1;  |PRINT;
               |SINO;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;
|FPRC;

|DEFBUCLE abow0004_2;
     #100#2;
     ;
     00, "01.01.0000", 00000, 00000;
     99, "31.12.9999", 99999, 99999;
     ;
     NULL, Imprime;
|FIN;

|DEFBUCLE abow0004_3;
     #100#3;
     ;
     00, 00000, "01.01.0000", 00000;
     99, 99999, "31.12.9999", 99999;
     ;
     NULL, Imprime;
|FIN;

|DEFBUCLE abow0004_4;
     #100#4;
     ;
     00000, "01.01.0000", 00, 00000;
     99999, "31.12.9999", 99, 99999;
     ;
     NULL, Imprime;
|FIN;

|DEFBUCLE abow0004_5;
     #100#5;
     ;
     00000, 00, "01.01.0000", 00000;
     99999, 99, "31.12.9999", 99999;
     ;
     NULL, Imprime;
|FIN;

|PROCESO CargaResumen;
     #505#0 = #100#1;
     |LEE 040#505=;
     |SI FSalida ! 0;  |DDEFECTO #505;  |FINSI;

     |SI #0#28 = 0;
         #102#1 = "TODAS LAS EMPRESAS"
     |SINO;
         #102#0 = #0#28;
         |LEE 040#102=;
         |SI FSalida ! 0;  |DDEFECTO #102;  |FINSI;
     |FINSI;

     #101#0 = #100#1;
     #101#1 = #100#9;
     |LEE 101#101=;
     |SI FSalida ! 0;
         |DDEFECTO #101;
         #101#0 = #100#1;
         #101#1 = #100#9;
         #101#2 = #505#1;
         |GRABA 020#101b;
     |FINSI;
     #101#3 = #101#3 + #100#12;
     #101#4 = (#101#3 * #505#20) / 60;
     #101#5 = #101#5 + #100#13;
     #101#6 = #0#28;
     #101#7 = #102#1;
     |GRABA 020#101a;
     |LIBERA #101;

     #101#0 = #100#1;
     #101#1 = "zz";
     |LEE 101#101=;
     |SI FSalida ! 0;
         |DDEFECTO #101;
         #101#0 = #100#1;
         #101#1 = "zz";
         #101#2 = "  TOTAL " + #505#1;
         |GRABA 020#101b;
     |FINSI;
     #101#3 = #101#3 + #100#12;
     #101#4 = (#101#3 * #505#20) / 60;
     #101#5 = #101#5 + #100#13;
     #101#6 = #0#28;
     #101#7 = #102#1;
     |GRABA 020#101a;
     |LIBERA #101;
|FPRC;

|DEFBUCLE abow0004_1;
     #100#1;
     ;
     00000;
     99999;
     ;
     NULL, CargaResumen;
|FIN;

|PROCESO Imprime9;
     |PRINT;
|FPRC;

|PROCESO Pie9;
     |PIEINF;
|FPRC;

|DEFBUCLE abow0009;
     #101#1;
     ;
     00, "  ";
     99, "zz";
     ;
     NULL, Imprime9, NULL, NULL, Pie9;
|FIN;

|RUTINA ClaveBaja101;
     #101#0 = 01;
     #101#1 = "  ";
|FRUT;

|RUTINA ClaveAlta101;
     #101#0 = 99;
     #101#1 = "zz";
|FRUT;

|PROCESO Tipo11W0004;  |TIPO 11;
     |SI FSalida = 10;
         |SI #100#4 ! 0;  |HAZ EditaAsunto1;  |FINSI;
         |SI #100#4 = 0;  |HAZ EditaAsunto2;  |FINSI;
     |FINSI;

     |SI FSalida = 11;
         |IMPRE 0;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |SI #0#29 ! "T";
             |SI #0#14 = 0;  |INFOR "aboy0002";  |FINSI;
             |SI #0#14 = 1;  |INFOR "aboy1002";  |FINSI;
             |SI #0#14 = 2;  |INFOR "aboy2002";  |FINSI;
             |SI #0#14 = 3;  |INFOR "aboy3002";  |FINSI;
             |SI #0#14 = 4;  |INFOR "aboy4002";  |FINSI;
         |SINO;
             |SI #0#14 = 0;  |INFOR "aboy2102";  |FINSI;
             |SI #0#14 = 1;  |INFOR "aboy2202";  |FINSI;
             |SI #0#14 = 2;  |INFOR "aboy2302";  |FINSI;
             |SI #0#14 = 3;  |INFOR "aboy2402";  |FINSI;
             |SI #0#14 = 4;  |INFOR "aboy2502";  |FINSI;
         |FINSI;

         |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

         |SI #0#14 = 0;  |BUCLE abow0004_2;  |FINSI;
         |SI #0#14 = 1;  |BUCLE abow0004_2;  |FINSI;
         |SI #0#14 = 2;  |BUCLE abow0004_3;  |FINSI;
         |SI #0#14 = 3;  |BUCLE abow0004_4;  |FINSI;
         |SI #0#14 = 4;  |BUCLE abow0004_5;  |FINSI;

         |PIEINF;
         |FININF;
         |FINIMP;

         |PTEC 812;
     |FINSI;

     |SI FSalida = 12;
         aFichero = ("a6" + Usuario + "zzzzzzzz") % 108;  |NOME_DAT #101 aFichero;
         |ABRE #101;  |CIERRA #101;  |DELINDEX #101;
         |ABRE #101;
         |ABRE #505;
         |ABRE #102;
         |BUCLE abow0004_1;
         |CIERRA #101;
         |CIERRA #505;
         |CIERRA #102;

         |PUSHV 0501 2380;
         |ENTLINEAL #1#101, -1, 4, 20, 1, ClaveBaja101, ClaveAlta101;
         |POPV;
         |PTEC 812;
         |ABRE #101;  |CIERRA #101;  |DELINDEX #101;
     |FINSI;

     |SI FSalida = 13;
         aFichero = ("a6" + Usuario + "zzzzzzzz") % 108;  |NOME_DAT #101 aFichero;
         |ABRE #101;  |CIERRA #101;  |DELINDEX #101;
         |ABRE #101;
         |ABRE #102;
         |ABRE #505;
         |BUCLE abow0004_1;
         |CIERRA #101;
         |CIERRA #102;
         |CIERRA #505;

         |IMPRE 0;
         |SI FSalida = 0;
             |INFOR "aboy5002";
             |SI FSalida = 0;
                 fFecha   = #0#4 % 2;  aAlfa = fFecha % 1125;  |QBF aAlfa;
                 aAlfa    = aAlfa > aAlfa;
                 eaDescri = "DEL " + aAlfa;
                 fFecha   = #0#5 % 2;  aAlfa = fFecha % 1125;  |QBF aAlfa;
                 aAlfa    = aAlfa > aAlfa;
                 eaDescri = eaDescri + " AL " + aAlfa;

                 |BUCLE abow0009;
                 |FININF;
                 eaDescri = "";
             |FINSI;
             |FINIMP;
         |FINSI;

         |PTEC 812;
         |ABRE #101;  |CIERRA #101;  |DELINDEX #101;
     |FINSI;
|FPRC;
