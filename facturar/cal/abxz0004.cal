|FICHEROS;
     abxz0004;

     abom0001;
     abom0002;
     abom0003;
     abom0004;
     abom0005;
     abom0006;
     abom0007;
     abom0013;
     abom0015;
     abom0511;

     abom0001@;
     abom0002@;
     abom0003@;
     abom0004@;
     abom0005@;
     abom0006@;
     abom0007@;
     abom0013@;
     abom0015@;
|FIN;

|VARIABLES;
     nPanta0      = 0;
     nCampo       = 0;
     nHandle      = 0;
     nNume        = 0;
     nVentz2      = 0;
     nBotonLabel  = 0;
     nHay801      = 0;

     aAlfa        = "";
     aAlfa1       = "";
     aMas         = "";
     aFicheroSql  = "";
     aCadena      = "";
     aBase        = "";
     aOrigen      = "";
     aDestino     = "";
     aFichOri     = "";
     aFichDes     = "";
     aUsu         = "";

     {-1}aVent      = "";
         aVent1     = 0;
         aVent2     = 0;
         aVent3     = 0;
         aVent4     = 0;
         aVent5     = "";

     &enDocumento = 0;
     &eaFichero01 = "";
     &eaFichero02 = "";
     &eaFichero03 = "";
     &eaFichero04 = "";
     &eaFichero05 = "";
     &eaFichero06 = "";
     &eaFichero07 = "";
     &eaFichero13 = "";
     &eaFichero15 = "";
     &eaFicExp    = "";
     &enError     = 0;
|FIN;

|PROCESO abom0003;
      |SI nHay801 = 0;
          #abom0001@#0 = #abom0003@#0;
          |LEE 000#abom0001@.=;
          |SI FSalida = 0;  |ACABA;  |FINSI;

          #abom0001#0 = #abom0003@#0;
          |LEE 000#abom0001.=;
          |SI FSalida ! 0;  |ACABA;  |FINSI;
     |SINO;
          #abom0001@#0 = #abom0003@#0;
          |LEE 000#abom0001@.=;
          |SI FSalida ! 0;
              |BORRA 020#abom0003@.a;
              |LIBERA #abom0003@;
          |FINSI;
          |ACABA;
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ 69;  |HACIENDO nCampo = nCampo + 1;
           #abom0001@#nCampo# = #abom0001#nCampo#;
     |SIGUE;

     |GRABA 020#abom0001@.n;
     |LIBERA #abom0001@;
|FPRC;

|DEFBUCLE abom0003;
     #abom0003@#1002;
     ;
     00000001, 00001;
     99999999, 99999;
     be;
     NULL, abom0003;
|FIN;

|PROCESO Fichero01Fijo;
     aFichOri = eaFicExp;
     aFichDes = eaFichero01;

     |NOME_DAT #abom0001@#eaFichero01#;

     |ABRE #abom0001@;
     |LEE 000#abom0001@.p;
     |SI FSalida = 0;
         |CIERRA #abom0001@;

         aFichOri = eaFichero01;
         |NOME_DAT #abom0001#aFichOri#;

         aFichDes = "sqlm0001" + Usuario;
         |NOME_DAT #abom0001@#aFichDes#;
     |FINSI;
     |CIERRA #abom0001@;

     |DBASE aBase;
     aAlfa = aBase + "basura";  |MKDIR aAlfa;
     aFicheroSql = aAlfa  + "/sql" + Usuario + ".txt";
     |XABRE "WB", aFicheroSql, nHandle;

     aCadena = #abxz0004#0;  |QBF aCadena;
     aCadena = "'" + aCadena + "'";  |QBF aCadena;

     aAlfa = "* FROM " + aFichOri + " INTO " + aFichDes + " WHERE ";
     |XGRABA nHandle, aAlfa;

     |SI #abxz0004#1 = "1";  aAlfa = "4 LIKE "  + aCadena;  |FINSI;
     |SI #abxz0004#1 = "2";  aAlfa = "15 LIKE " + aCadena;  |FINSI;

     |XGRABA nHandle, aAlfa;
     |XCIERRA nHandle;

     |ABRE #abom0001;
     aAlfa = "SELECT @" + aFicheroSql;
     |SQL aAlfa;
     |CIERRA #abom0001;

     |FBORRA aFicheroSql;
     |CIERRA #abom0001@;

     |SI aFichDes ! eaFichero01;
         |ABRE #abom0001; |CIERRA #abom0001;  |DELINDEX #abom0001;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".dat";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero01 + ".dat";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ddx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero01 + ".ddx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ixx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero01 + ".ixx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         |NOME_DAT #abom0001@#eaFichero01#;
     |FINSI;
|FPRC;

|PROCESO Fichero03Fijo;
     aFichOri = "abom0003";
     aFichDes = eaFichero03;

     |NOME_DAT #abom0003@#eaFichero03#;

     |ABRE #abom0003@;
     |LEE 000#abom0003@.p;
     |SI FSalida = 0;
         |CIERRA #abom0003@;

         aFichOri = eaFichero03;
         |NOME_DAT #abom0003#aFichOri#;

         aFichDes = "sqlm0003" + Usuario;
         |NOME_DAT #abom0003@#aFichDes#;
     |FINSI;
     |CIERRA #abom0003@;

     |DBASE aBase;
     aAlfa = aBase + "basura";  |MKDIR aAlfa;
     aFicheroSql = aAlfa  + "/sql" + Usuario + ".txt";
     |XABRE "WB", aFicheroSql, nHandle;

     aCadena = #abxz0004#0;  |QBF aCadena;
     aCadena = "'" + aCadena + "'";  |QBF aCadena;

     aAlfa = "* FROM " + aFichOri + " INTO " + aFichDes + " WHERE ";
     |XGRABA nHandle, aAlfa;

     aAlfa = "2 LIKE "  + aCadena;
     |XGRABA nHandle, aAlfa;

     |XCIERRA nHandle;

     |ABRE #abom0003;
     aAlfa = "SELECT @" + aFicheroSql;
     |SQL aAlfa;
     |CIERRA #abom0003;

     |FBORRA aFicheroSql;
     |CIERRA #abom0003@;

     |SI aFichDes ! eaFichero03;
         |ABRE #abom0003; |CIERRA #abom0003;  |DELINDEX #abom0003;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".dat";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero03 + ".dat";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ddx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero03 + ".ddx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ixx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero03 + ".ixx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         |NOME_DAT #abom0003@#eaFichero03#;
     |FINSI;

     |ABRE #abom0001@;
     |ABRE #abom0001;
     |BUCLE abom0003;
     |CIERRA #abom0001@;
     |CIERRA #abom0001;
|FPRC;

|PROCESO PorCampoFijo;
     |SI nHay801 = 0;
         |HAZ Fichero01Fijo;

         |SI #abxz0004#1 = "1";  |HAZ Fichero03Fijo;  |FINSI;
     |SINO;
         |SI #abxz0004#1 = "1";
             |HAZ Fichero03Fijo;
         |FINSI;

         |HAZ Fichero01Fijo;

         |SI #abxz0004#1 = "1";
             aFichOri = eaFicExp;
             |NOME_DAT #abom0001#aFichOri#;

             nHay801 = 0;
             |ABRE #abom0001@;
             |ABRE #abom0001;
             |BUCLE abom0003;
             |CIERRA #abom0001@;
             |CIERRA #abom0001;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Fichero01;
     aFichOri = eaFicExp;
     aFichDes = eaFichero01;

     |NOME_DAT #abom0001@#eaFichero01#;

     |ABRE #abom0001@;
     |LEE 000#abom0001@.p;
     |SI FSalida = 0;
         |CIERRA #abom0001@;

         aFichOri = eaFichero01;
         |NOME_DAT #abom0001#aFichOri#;

         aFichDes = "sqlm0001" + Usuario;
         |NOME_DAT #abom0001@#aFichDes#;
     |FINSI;
     |CIERRA #abom0001@;

     |DBASE aBase;
     aAlfa = aBase + "basura";  |MKDIR aAlfa;
     aFicheroSql = aAlfa  + "/sql" + Usuario + ".txt";
     |XABRE "WB", aFicheroSql, nHandle;

     aCadena = #abxz0004#0;  |QBF aCadena;
     aCadena = "'" + aCadena + "'";  |QBF aCadena;

     aAlfa = "* FROM " + aFichOri + " INTO " + aFichDes + " WHERE ";
     |XGRABA nHandle, aAlfa;

     |PARA nCampo = 0;  |SI nCampo [ 69;  |HACIENDO nCampo = nCampo + 1;
           |SI nCampo = 0;
               aAlfa = nCampo + " LIKE " + aCadena;
           |SINO;
               aAlfa = " OR " + nCampo + " LIKE " + aCadena;
           |FINSI;
           |XGRABA nHandle, aAlfa;
     |SIGUE;

     |XCIERRA nHandle;

     |ABRE #abom0001;
     aAlfa = "SELECT @" + aFicheroSql;
     |SQL aAlfa;
     |CIERRA #abom0001;

     |FBORRA aFicheroSql;
     |CIERRA #abom0001@;

     |SI aFichDes ! eaFichero01;
         |ABRE #abom0001; |CIERRA #abom0001;  |DELINDEX #abom0001;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".dat";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero01 + ".dat";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ddx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero01 + ".ddx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ixx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero01 + ".ixx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         |NOME_DAT #abom0001@#eaFichero01#;
     |FINSI;
|FPRC;

|PROCESO abom0002;
      |SI nHay801 = 0;
          #abom0001@#0 = #abom0002@#0;
          |LEE 000#abom0001@.=;
          |SI FSalida = 0;  |ACABA;  |FINSI;

          #abom0001#0 = #abom0002@#0;
          |LEE 000#abom0001.=;
          |SI FSalida ! 0;  |ACABA;  |FINSI;
     |SINO;
          #abom0001@#0 = #abom0002@#0;
          |LEE 000#abom0001@.=;
          |SI FSalida ! 0;
              |BORRA 020#abom0002@.a;
          |FINSI;
          |ACABA;
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ 69;  |HACIENDO nCampo = nCampo + 1;
           #abom0001@#nCampo# = #abom0001#nCampo#;
     |SIGUE;

     |GRABA 020#abom0001@.n;
     |LIBERA #abom0001@;
     |LIBERA #abom0002@;
|FPRC;

|DEFBUCLE abom0002;
     #abom0002@#1002;
     ;
     00000001, 00001;
     99999999, 99999;
     be;
     NULL, abom0002;
|FIN;

|PROCESO Fichero02;
     aFichOri = "abom0002";
     aFichDes = eaFichero02;

     |NOME_DAT #abom0002@#eaFichero02#;

     |ABRE #abom0002@;
     |LEE 000#abom0002@.p;
     |SI FSalida = 0;
         |CIERRA #abom0002@;

         aFichOri = eaFichero02;
         |NOME_DAT #abom0002#aFichOri#;

         aFichDes = "sqlm0002" + Usuario;
         |NOME_DAT #abom0002@#aFichDes#;
     |FINSI;
     |CIERRA #abom0002@;

     |DBASE aBase;
     aAlfa = aBase + "basura";  |MKDIR aAlfa;
     aFicheroSql = aAlfa  + "/sql" + Usuario + ".txt";
     |XABRE "WB", aFicheroSql, nHandle;

     aCadena = #abxz0004#0;  |QBF aCadena;
     aCadena = "'" + aCadena + "'";  |QBF aCadena;

     aAlfa = "* FROM " + aFichOri + " INTO " + aFichDes + " WHERE ";
     |XGRABA nHandle, aAlfa;

     |PARA nCampo = 0;  |SI nCampo [ 11;  |HACIENDO nCampo = nCampo + 1;
           |SI nCampo = 0;
               aAlfa = nCampo + " LIKE " + aCadena;
           |SINO;
               aAlfa = " OR " + nCampo + " LIKE " + aCadena;
           |FINSI;
           |XGRABA nHandle, aAlfa;
     |SIGUE;

     |XCIERRA nHandle;

     |ABRE #abom0002;
     aAlfa = "SELECT @" + aFicheroSql;
     |SQL aAlfa;
     |CIERRA #abom0002;

     |FBORRA aFicheroSql;
     |CIERRA #abom0002@;

     |SI aFichDes ! eaFichero02;
         |ABRE #abom0002; |CIERRA #abom0002;  |DELINDEX #abom0002;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".dat";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero02 + ".dat";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ddx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero02 + ".ddx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ixx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero02 + ".ixx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         |NOME_DAT #abom0002@#eaFichero02#;
     |FINSI;

     |ABRE #abom0001@;
     |ABRE #abom0001;
     |BUCLE abom0002;
     |CIERRA #abom0001@;
     |CIERRA #abom0001;
|FPRC;

|PROCESO Fichero03;
     aFichOri = "abom0003";
     aFichDes = eaFichero03;

     |NOME_DAT #abom0003@#eaFichero03#;

     |ABRE #abom0003@;
     |LEE 000#abom0003@.p;
     |SI FSalida = 0;
         |CIERRA #abom0003@;

         aFichOri = eaFichero03;
         |NOME_DAT #abom0003#aFichOri#;

         aFichDes = "sqlm0003" + Usuario;
         |NOME_DAT #abom0003@#aFichDes#;
     |FINSI;
     |CIERRA #abom0003@;

     |DBASE aBase;
     aAlfa = aBase + "basura";  |MKDIR aAlfa;
     aFicheroSql = aAlfa  + "/sql" + Usuario + ".txt";
     |XABRE "WB", aFicheroSql, nHandle;

     aCadena = #abxz0004#0;  |QBF aCadena;
     aCadena = "'" + aCadena + "'";  |QBF aCadena;

     aAlfa = "* FROM " + aFichOri + " INTO " + aFichDes + " WHERE ";
     |XGRABA nHandle, aAlfa;

     |PARA nCampo = 0;  |SI nCampo [ 2;  |HACIENDO nCampo = nCampo + 1;
           |SI nCampo = 0;
               aAlfa = nCampo + " LIKE " + aCadena;
           |SINO;
               aAlfa = " OR " + nCampo + " LIKE " + aCadena;
           |FINSI;
           |XGRABA nHandle, aAlfa;
     |SIGUE;

     |XCIERRA nHandle;

     |ABRE #abom0003;
     aAlfa = "SELECT @" + aFicheroSql;
     |SQL aAlfa;
     |CIERRA #abom0003;

     |FBORRA aFicheroSql;
     |CIERRA #abom0003@;

     |SI aFichDes ! eaFichero03;
         |ABRE #abom0003; |CIERRA #abom0003;  |DELINDEX #abom0003;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".dat";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero03 + ".dat";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ddx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero03 + ".ddx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ixx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero03 + ".ixx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         |NOME_DAT #abom0003@#eaFichero03#;
     |FINSI;

     |ABRE #abom0001@;
     |ABRE #abom0001;
     |BUCLE abom0003;
     |CIERRA #abom0001@;
     |CIERRA #abom0001;
|FPRC;

|PROCESO abom0004;
      |SI nHay801 = 0;
          #abom0001@#0 = #abom0004@#0;
          |LEE 000#abom0001@.=;
          |SI FSalida = 0;  |ACABA;  |FINSI;

          #abom0001#0 = #abom0004@#0;
          |LEE 000#abom0001.=;
          |SI FSalida ! 0;  |ACABA;  |FINSI;
     |SINO;
          #abom0001@#0 = #abom0004@#0;
          |LEE 000#abom0001@.=;
          |SI FSalida ! 0;
              |BORRA 020#abom0004@.a;
              |LIBERA #abom0004@;
          |FINSI;
          |ACABA;
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ 69;  |HACIENDO nCampo = nCampo + 1;
           #abom0001@#nCampo# = #abom0001#nCampo#;
     |SIGUE;

     |GRABA 020#abom0001@.n;
     |LIBERA #abom0001@;
|FPRC;

|DEFBUCLE abom0004;
     #abom0004@#1002;
     ;
     00000001, 00001;
     99999999, 99999;
     be;
     NULL, abom0004;
|FIN;

|PROCESO Fichero04;
     aFichOri = "abom0004";
     aFichDes = eaFichero04;

     |NOME_DAT #abom0004@#eaFichero04#;

     |ABRE #abom0004@;
     |LEE 000#abom0004@.p;
     |SI FSalida = 0;
         |CIERRA #abom0004@;

         aFichOri = eaFichero04;
         |NOME_DAT #abom0004#aFichOri#;

         aFichDes = "sqlm0004" + Usuario;
         |NOME_DAT #abom0004@#aFichDes#;
     |FINSI;
     |CIERRA #abom0004@;

     |DBASE aBase;
     aAlfa = aBase + "basura";  |MKDIR aAlfa;
     aFicheroSql = aAlfa  + "/sql" + Usuario + ".txt";
     |XABRE "WB", aFicheroSql, nHandle;

     aCadena = #abxz0004#0;  |QBF aCadena;
     aCadena = "'" + aCadena + "'";  |QBF aCadena;

     aAlfa = "* FROM " + aFichOri + " INTO " + aFichDes + " WHERE ";
     |XGRABA nHandle, aAlfa;

     |PARA nCampo = 0;  |SI nCampo [ 2;  |HACIENDO nCampo = nCampo + 1;
           |SI nCampo = 0;
               aAlfa = nCampo + " LIKE " + aCadena;
           |SINO;
               aAlfa = " OR " + nCampo + " LIKE " + aCadena;
           |FINSI;
           |XGRABA nHandle, aAlfa;
     |SIGUE;

     |XCIERRA nHandle;

     |ABRE #abom0004;
     aAlfa = "SELECT @" + aFicheroSql;
     |SQL aAlfa;
     |CIERRA #abom0004;

     |FBORRA aFicheroSql;
     |CIERRA #abom0004@;

     |SI aFichDes ! eaFichero04;
         |ABRE #abom0004; |CIERRA #abom0004;  |DELINDEX #abom0004;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".dat";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero04 + ".dat";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ddx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero04 + ".ddx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ixx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero04 + ".ixx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         |NOME_DAT #abom0004@#eaFichero04#;
     |FINSI;

     |ABRE #abom0001@;
     |ABRE #abom0001;
     |BUCLE abom0004;
     |CIERRA #abom0001@;
     |CIERRA #abom0001;
|FPRC;

|PROCESO abom0005;
      |SI nHay801 = 0;
          #abom0001@#0 = #abom0005@#0;
          |LEE 000#abom0001@.=;
          |SI FSalida = 0;  |ACABA;  |FINSI;

          #abom0001#0 = #abom0005@#0;
          |LEE 000#abom0001.=;
          |SI FSalida ! 0;  |ACABA;  |FINSI;
     |SINO;
          #abom0001@#0 = #abom0005@#0;
          |LEE 000#abom0001@.=;
          |SI FSalida ! 0;
              |BORRA 020#abom0005@.a;
              |LIBERA #abom0005@;
          |FINSI;
          |ACABA;
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ 69;  |HACIENDO nCampo = nCampo + 1;
           #abom0001@#nCampo# = #abom0001#nCampo#;
     |SIGUE;

     |GRABA 020#abom0001@.n;
     |LIBERA #abom0001@;
|FPRC;

|DEFBUCLE abom0005;
     #abom0005@#1002;
     ;
     00000001, 001;
     99999999, 999;
     be;
     NULL, abom0005;
|FIN;

|PROCESO Fichero05;
     aFichOri = "abom0005";
     aFichDes = eaFichero05;

     |NOME_DAT #abom0005@#eaFichero05#;

     |ABRE #abom0005@;
     |LEE 000#abom0005@.p;
     |SI FSalida = 0;
         |CIERRA #abom0005@;

         aFichOri = eaFichero05;
         |NOME_DAT #abom0005#aFichOri#;

         aFichDes = "sqlm0005" + Usuario;
         |NOME_DAT #abom0005@#aFichDes#;
     |FINSI;
     |CIERRA #abom0005@;

     |DBASE aBase;
     aAlfa = aBase + "basura";  |MKDIR aAlfa;
     aFicheroSql = aAlfa  + "/sql" + Usuario + ".txt";
     |XABRE "WB", aFicheroSql, nHandle;

     aCadena = #abxz0004#0;  |QBF aCadena;
     aCadena = "'" + aCadena + "'";  |QBF aCadena;

     aAlfa = "* FROM " + aFichOri + " INTO " + aFichDes + " WHERE ";
     |XGRABA nHandle, aAlfa;

     |PARA nCampo = 0;  |SI nCampo [ 27;  |HACIENDO nCampo = nCampo + 1;
           |SI nCampo = 0;
               aAlfa = nCampo + " LIKE " + aCadena;
           |SINO;
               aAlfa = " OR " + nCampo + " LIKE " + aCadena;
           |FINSI;
           |XGRABA nHandle, aAlfa;
     |SIGUE;

     |XCIERRA nHandle;

     |ABRE #abom0005;
     aAlfa = "SELECT @" + aFicheroSql;
     |SQL aAlfa;
     |CIERRA #abom0005;

     |FBORRA aFicheroSql;
     |CIERRA #abom0005@;

     |SI aFichDes ! eaFichero05;
         |ABRE #abom0005; |CIERRA #abom0005;  |DELINDEX #abom0005;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".dat";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero05 + ".dat";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ddx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero05 + ".ddx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ixx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero05 + ".ixx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         |NOME_DAT #abom0005@#eaFichero05#;
     |FINSI;

     |ABRE #abom0001@;
     |ABRE #abom0001;
     |BUCLE abom0005;
     |CIERRA #abom0001@;
     |CIERRA #abom0001;
|FPRC;

|PROCESO abom0006;
      |SI nHay801 = 0;
          #abom0001@#0 = #abom0006@#0;
          |LEE 000#abom0001@.=;
          |SI FSalida = 0;  |ACABA;  |FINSI;

          #abom0001#0 = #abom0006@#0;
          |LEE 000#abom0001.=;
          |SI FSalida ! 0;  |ACABA;  |FINSI;
     |SINO;
          #abom0001@#0 = #abom0006@#0;
          |LEE 000#abom0001@.=;
          |SI FSalida ! 0;
              |BORRA 020#abom0006@.a;
              |LIBERA #abom0006@;
          |FINSI;
          |ACABA;
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ 69;  |HACIENDO nCampo = nCampo + 1;
           #abom0001@#nCampo# = #abom0001#nCampo#;
     |SIGUE;

     |GRABA 020#abom0001@.n;
     |LIBERA #abom0001@;
|FPRC;

|DEFBUCLE abom0006;
     #abom0006@#1005;
     ;
     00000001, "01.01.0000", 00, 00, 00;
     99999999, "31.12.9999", 99, 99, 99;
     be;
     NULL, abom0006;
|FIN;

|PROCESO Fichero06;
     aFichOri = "abom0006";
     aFichDes = eaFichero06;

     |NOME_DAT #abom0006@#eaFichero06#;

     |ABRE #abom0006@;
     |LEE 000#abom0006@.p;
     |SI FSalida = 0;
         |CIERRA #abom0006@;

         aFichOri = eaFichero06;
         |NOME_DAT #abom0006# aFichOri#;

         aFichDes = "sqlm0006" + Usuario;
         |NOME_DAT #abom0006@#aFichDes#;
     |FINSI;
     |CIERRA #abom0006@;

     |DBASE aBase;
     aAlfa = aBase + "basura";  |MKDIR aAlfa;
     aFicheroSql = aAlfa  + "/sql" + Usuario + ".txt";
     |XABRE "WB", aFicheroSql, nHandle;

     aCadena = #abxz0004#0;  |QBF aCadena;
     aCadena = "'" + aCadena + "'";  |QBF aCadena;

     aAlfa = "* FROM " + aFichOri + " INTO " + aFichDes + " WHERE ";
     |XGRABA nHandle, aAlfa;

     |PARA nCampo = 0;  |SI nCampo [ 20;  |HACIENDO nCampo = nCampo + 1;
           |SI nCampo = 0;
               aAlfa = nCampo + " LIKE " + aCadena;
           |SINO;
               aAlfa = " OR " + nCampo + " LIKE " + aCadena;
           |FINSI;
           |XGRABA nHandle, aAlfa;
     |SIGUE;

     |XCIERRA nHandle;

     |ABRE #abom0006;
     aAlfa = "SELECT @" + aFicheroSql;
     |SQL aAlfa;
     |CIERRA #abom0006;

     |FBORRA aFicheroSql;
     |CIERRA #abom0006@;

     |SI aFichDes ! eaFichero06;
         |ABRE #abom0006; |CIERRA #abom0006;  |DELINDEX #abom0006;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".dat";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero06 + ".dat";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ddx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero06 + ".ddx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ixx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero06 + ".ixx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         |NOME_DAT #abom0006@#eaFichero06#;
     |FINSI;

     |ABRE #abom0001@;
     |ABRE #abom0001;
     |BUCLE abom0006;
     |CIERRA #abom0001@;
     |CIERRA #abom0001;
|FPRC;

|PROCESO abom0007;
      |SI nHay801 = 0;
          #abom0001@#0 = #abom0007@#0;
          |LEE 000#abom0001@.=;
          |SI FSalida = 0;  |ACABA;  |FINSI;

          #abom0001#0 = #abom0007@#0;
          |LEE 000#abom0001.=;
          |SI FSalida ! 0;  |ACABA;  |FINSI;
     |SINO;
          #abom0001@#0 = #abom0007@#0;
          |LEE 000#abom0001@.=;
          |SI FSalida ! 0;
              |BORRA 020#abom0007@.a;
              |LIBERA #abom0007@;
          |FINSI;
          |ACABA;
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ 79;  |HACIENDO nCampo = nCampo + 1;
           #abom0001@#nCampo# = #abom0001#nCampo#;
     |SIGUE;

     |GRABA 020#abom0001@.n;
     |LIBERA #abom0001@;
|FPRC;

|DEFBUCLE abom0007;
     #abom0007@#1003;
     ;
     00000001, 000, 00;
     99999999, 999, 99;
     be;
     NULL, abom0007;
|FIN;

|PROCESO Fichero07;
     aFichOri = "abom0007";
     aFichDes = eaFichero07;

     |NOME_DAT #abom0007@#eaFichero07#;

     |ABRE #abom0007@;
     |LEE 000#abom0007@.p;
     |SI FSalida = 0;
         |CIERRA #abom0007@;

         aFichOri = eaFichero07;
         |NOME_DAT #abom0007#aFichOri#;

         aFichDes = "sqlm0007" + Usuario;
         |NOME_DAT #abom0007@#aFichDes#;
     |FINSI;
     |CIERRA #abom0007@;

     |DBASE aBase;
     aAlfa = aBase + "basura";  |MKDIR aAlfa;
     aFicheroSql = aAlfa  + "/sql" + Usuario + ".txt";
     |XABRE "WB", aFicheroSql, nHandle;

     aCadena = #abxz0004#0;  |QBF aCadena;
     aCadena = "'" + aCadena + "'";  |QBF aCadena;

     aAlfa = "* FROM " + aFichOri + " INTO " + aFichDes + " WHERE ";
     |XGRABA nHandle, aAlfa;

     |PARA nCampo = 0;  |SI nCampo [ 3;  |HACIENDO nCampo = nCampo + 1;
           |SI nCampo = 0;
               aAlfa = nCampo + " LIKE " + aCadena;
           |SINO;
               aAlfa = " OR " + nCampo + " LIKE " + aCadena;
           |FINSI;
           |XGRABA nHandle, aAlfa;
     |SIGUE;

     |XCIERRA nHandle;

     |ABRE #abom0007;
     aAlfa = "SELECT @" + aFicheroSql;
     |SQL aAlfa;
     |CIERRA #abom0007;

     |FBORRA aFicheroSql;
     |CIERRA #abom0007@;

     |SI aFichDes ! eaFichero07;
         |ABRE #abom0007; |CIERRA #abom0007;  |DELINDEX #abom0007;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".dat";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero07 + ".dat";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ddx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero07 + ".ddx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ixx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero07 + ".ixx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         |NOME_DAT #abom0007@#eaFichero07#;
     |FINSI;

     |ABRE #abom0001@;
     |ABRE #abom0001;
     |BUCLE abom0007;
     |CIERRA #abom0001@;
     |CIERRA #abom0001;
|FPRC;

|PROCESO abom0013;
      |SI nHay801 = 0;
          #abom0001@#0 = #abom0013@#0;
          |LEE 000#abom0001@.=;
          |SI FSalida = 0;  |ACABA;  |FINSI;

          #abom0001#0 = #abom0013@#0;
          |LEE 000#abom0001.=;
          |SI FSalida ! 0;  |ACABA;  |FINSI;
     |SINO;
          #abom0001@#0 = #abom0013@#0;
          |LEE 000#abom0001@.=;
          |SI FSalida ! 0;
              |BORRA 020#abom0013@.a;
              |LIBERA #abom0013@;
          |FINSI;
          |ACABA;
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ 69;  |HACIENDO nCampo = nCampo + 1;
           #abom0001@#nCampo# = #abom0001#nCampo#;
     |SIGUE;

     |GRABA 020#abom0001@.n;
     |LIBERA #abom0001@;
|FPRC;

|DEFBUCLE abom0013;
     #abom0013@#1002;
     ;
     00000001, 0000;
     99999999, 9999;
     be;
     NULL, abom0013;
|FIN;

|PROCESO Fichero13;
     aFichOri = "abom0013";
     aFichDes = eaFichero13;

     |NOME_DAT #abom0013@#eaFichero13#;

     |ABRE #abom0013@;
     |LEE 000#abom0013@.p;
     |SI FSalida = 0;
         |CIERRA #abom0013@;

         aFichOri = eaFichero13;
         |NOME_DAT #abom0013#aFichOri#;

         aFichDes = "sqlm0013" + Usuario;
         |NOME_DAT #abom0013@#aFichDes#;
     |FINSI;
     |CIERRA #abom0013@;

     |DBASE aBase;
     aAlfa = aBase + "basura";  |MKDIR aAlfa;
     aFicheroSql = aAlfa  + "/sql" + Usuario + ".txt";
     |XABRE "WB", aFicheroSql, nHandle;

     aCadena = #abxz0004#0;  |QBF aCadena;
     aCadena = "'" + aCadena + "'";  |QBF aCadena;

     aAlfa = "* FROM " + aFichOri + " INTO " + aFichDes + " WHERE ";
     |XGRABA nHandle, aAlfa;

     |PARA nCampo = 0;  |SI nCampo [ 7;  |HACIENDO nCampo = nCampo + 1;
           |SI nCampo = 0;
               aAlfa = nCampo + " LIKE " + aCadena;
           |SINO;
               aAlfa = " OR " + nCampo + " LIKE " + aCadena;
           |FINSI;
           |XGRABA nHandle, aAlfa;
     |SIGUE;

     |XCIERRA nHandle;

     |ABRE #abom0013;
     aAlfa = "SELECT @" + aFicheroSql;
     |SQL aAlfa;
     |CIERRA #abom0013;

     |FBORRA aFicheroSql;
     |CIERRA #abom0013@;

     |SI aFichDes ! eaFichero13;
         |ABRE #abom0013; |CIERRA #abom0013;  |DELINDEX #abom0013;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".dat";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero13 + ".dat";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ddx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero13 + ".ddx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ixx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero13 + ".ixx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         |NOME_DAT #abom0013@#eaFichero13#;
     |FINSI;

     |ABRE #abom0001@;
     |ABRE #abom0001;
     |BUCLE abom0013;
     |CIERRA #abom0001@;
     |CIERRA #abom0001;
|FPRC;

|PROCESO abom0015;
      |SI nHay801 = 0;
          #abom0001@#0 = #abom0015@#0;
          |LEE 000#abom0001@.=;
          |SI FSalida = 0;  |ACABA;  |FINSI;

          #abom0001#0 = #abom0015@#0;
          |LEE 000#abom0001.=;
          |SI FSalida ! 0;  |ACABA;  |FINSI;
     |SINO;
          #abom0001@#0 = #abom0015@#0;
          |LEE 000#abom0001@.=;
          |SI FSalida ! 0;
              |BORRA 020#abom0015@.a;
              |LIBERA #abom0015@;
          |FINSI;
          |ACABA;
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ 69;  |HACIENDO nCampo = nCampo + 1;
           #abom0001@#nCampo# = #abom0001#nCampo#;
     |SIGUE;

     |GRABA 020#abom0001@.n;
     |LIBERA #abom0001@;
|FPRC;

|DEFBUCLE abom0015;
     #abom0015@#1002;
     ;
     00000001, 0000;
     99999999, 9999;
     be;
     NULL, abom0015;
|FIN;

|PROCESO Fichero15;
     aFichOri = "abom0015";
     aFichDes = eaFichero15;

     |NOME_DAT #abom0015@#eaFichero15#;

     |ABRE #abom0015@;
     |LEE 000#abom0015@.p;
     |SI FSalida = 0;
         |CIERRA #abom0015@;

         aFichOri = eaFichero15;
         |NOME_DAT #abom0015#aFichOri#;

         aFichDes = "sqlm0015" + Usuario;
         |NOME_DAT #abom0015@#aFichDes#;
     |FINSI;
     |CIERRA #abom0015@;

     |DBASE aBase;
     aAlfa = aBase + "basura";  |MKDIR aAlfa;
     aFicheroSql = aAlfa  + "/sql" + Usuario + ".txt";
     |XABRE "WB", aFicheroSql, nHandle;

     aCadena = #abxz0004#0;  |QBF aCadena;
     aCadena = "'" + aCadena + "'";  |QBF aCadena;

     aAlfa = "* FROM " + aFichOri + " INTO " + aFichDes + " WHERE ";
     |XGRABA nHandle, aAlfa;

     |PARA nCampo = 0;  |SI nCampo [ 10;  |HACIENDO nCampo = nCampo + 1;
           |SI nCampo = 0;
               aAlfa = nCampo + " LIKE " + aCadena;
           |SINO;
               aAlfa = " OR " + nCampo + " LIKE " + aCadena;
           |FINSI;
           |XGRABA nHandle, aAlfa;
     |SIGUE;

     |XCIERRA nHandle;

     |ABRE #abom0015;
     aAlfa = "SELECT @" + aFicheroSql;
     |SQL aAlfa;
     |CIERRA #abom0015;

     |FBORRA aFicheroSql;
     |CIERRA #abom0015@;

     |SI aFichDes ! eaFichero15;
         |ABRE #abom0015; |CIERRA #abom0015;  |DELINDEX #abom0015;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".dat";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero15 + ".dat";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ddx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero15 + ".ddx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ixx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero15 + ".ixx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         |NOME_DAT #abom0015@#eaFichero15#;
     |FINSI;

     |ABRE #abom0001@;
     |ABRE #abom0001;
     |BUCLE abom0015;
     |CIERRA #abom0001@;
     |CIERRA #abom0001;
|FPRC;

|PROCESO Tipo12Fxz4;  |TIPO 12;
     |SI FSalida = 7;  enError = 1;   |ACABA;   |FINSI;

     aAlfa = #abxz0004#0;  |QBF aAlfa;
     |SI aAlfa = "";   enError = 1;   |ACABA;  |FINSI;

     |VENTANA 0501, 2699, -1, 16, "Buscando registros ...";
     nVentz2  = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentz2;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |CONTROL_SIMPLE 0, "LABEL,{{5}}Buscando registros ...", 1315, 1680, NULL;
     nBotonLabel = FSalida;

     |PTEC 802;   |PAUSA;
     |PULSATECLA;

     nHay801 = 0;
     |ABRE #abom0001@;
     |LEE 000#abom0001@.p;
     |SI FSalida = 0;  nHay801 = 1;  |FINSI;
     |CIERRA #abom0001@;

     |SI nHay801 = 0;
         |SI #abxz0004#1 = "3";
             |HAZ Fichero01;
             |HAZ Fichero02;
             |HAZ Fichero03;
             |HAZ Fichero04;
             |HAZ Fichero05;
             |HAZ Fichero06;
             |HAZ Fichero07;
             |HAZ Fichero13;
             |HAZ Fichero15;
         |SINO;
             |HAZ PorCampoFijo;
         |FINSI;
     |SINO;
         |SI #abxz0004#1 = "3";
             |HAZ Fichero02;
             |HAZ Fichero03;
             |HAZ Fichero04;
             |HAZ Fichero05;
             |HAZ Fichero06;
             |HAZ Fichero07;
             |HAZ Fichero13;
             |HAZ Fichero15;
             |HAZ Fichero01;

             aFichOri = eaFicExp;
             |NOME_DAT #abom0001#aFichOri#;

             nHay801 = 0;
             |ABRE #abom0001@;
             |ABRE #abom0001;
             |BUCLE abom0002;
             |BUCLE abom0003;
             |BUCLE abom0004;
             |BUCLE abom0005;
             |BUCLE abom0006;
             |BUCLE abom0007;
             |BUCLE abom0013;
             |BUCLE abom0015;
             |CIERRA #abom0001@;
             |CIERRA #abom0001;
         |SINO;
             |HAZ PorCampoFijo;
         |FINSI;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentz2;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentz2;
|FPRC;


|PROCESO Abiertos;
     |VENTANA 0501, 2699, -1, 16, "Buscando registros ...";
     nVentz2  = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentz2;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |CONTROL_SIMPLE 0, "LABEL,{{5}}Buscando registros ...", 1315, 1680, NULL;
     nBotonLabel = FSalida;

     |PTEC 802;   |PAUSA;
     |PULSATECLA;

     aFichOri = eaFicExp;
     aFichDes = eaFichero01;

     |NOME_DAT #abom0001@#eaFichero01#;

     |ABRE #abom0001@;
     |LEE 000#abom0001@.p;
     |SI FSalida = 0;
         |CIERRA #abom0001@;

         aFichOri = eaFichero01;
         |NOME_DAT #abom0001#aFichOri#;

         aFichDes = "sqlm0001" + Usuario;
         |NOME_DAT #abom0001@#aFichDes#;
     |FINSI;
     |CIERRA #abom0001@;

     |DBASE aBase;
     aAlfa = aBase + "basura";  |MKDIR aAlfa;
     aFicheroSql = aAlfa  + "/sql" + Usuario + ".txt";
     |XABRE "WB", aFicheroSql, nHandle;

     aAlfa = "* FROM " + aFichOri + " INTO " + aFichDes + " WHERE ";
     |XGRABA nHandle, aAlfa;

     aAlfa = "2" + " LIKE 01.01.0000";
     |XGRABA nHandle, aAlfa;

     |XCIERRA nHandle;

     |ABRE #abom0001;
     aAlfa = "SELECT @" + aFicheroSql;
     |SQL aAlfa;
     |CIERRA #abom0001;

     |FBORRA aFicheroSql;
     |CIERRA #abom0001@;

     |SI aFichDes ! eaFichero01;
         |ABRE #abom0001; |CIERRA #abom0001;  |DELINDEX #abom0001;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".dat";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero01 + ".dat";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ddx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero01 + ".ddx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         aOrigen  = aBase + "fich/" + #48#0 + "/" + aFichDes    + ".ixx";
         aDestino = aBase + "fich/" + #48#0 + "/" + eaFichero01 + ".ixx";
         |RENOMBRA_FICHERO aOrigen, aDestino;

         |NOME_DAT #abom0001@#eaFichero01#;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentz2;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentz2;
|FPRC;

|PROCESO abom0511;
     |SI aAlfa = "";
         aAlfa = "5" + " == " +  #abom0511#0;
     |SINO;
         aAlfa = aAlfa + " OR 5 == " + #abom0511#0;
     |FINSI;
|FPRC;

|DEFBUCLE abom0511;
     #abom0511#2;
     ;
     aUsu, 01;
     aUsu, 99;
     ;
     NULL, abom0511;
|FIN;

|PROCESO SQLPropios;
     aFichOri = eaFicExp;
     aFichDes = "prps" + Usuario;

     |NOME_DAT #abom0001@#aFichDes#;

     |ABRE #abom0001@;  |CIERRA #abom0001@;  |DELINDEX #abom0001@;

     |DBASE aBase;
     aAlfa = aBase + "basura";  |MKDIR aAlfa;
     aFicheroSql = aAlfa  + "/sql" + Usuario + ".txt";
     |XABRE "WB", aFicheroSql, nHandle;

     aAlfa = "* FROM " + aFichOri + " INTO " + aFichDes + " WHERE ";
     |XGRABA nHandle, aAlfa;

     aAlfa = "";
     |BUCLE abom0511;

     |XGRABA nHandle, aAlfa;

     |XCIERRA nHandle;

     |SI aAlfa = "";  |ACABA;  |FINSI;

     |ABRE #abom0001;
     aAlfa = "SELECT @" + aFicheroSql;
     |SQL aAlfa;
     |CIERRA #abom0001;

     |FBORRA aFicheroSql;
|FPRC;

|PROCESO Propios;
     |VENTANA 0501, 2699, -1, 16, "Buscando registros ...";
     nVentz2  = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentz2;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |CONTROL_SIMPLE 0, "LABEL,{{5}}Buscando registros ...", 1315, 1680, NULL;
     nBotonLabel = FSalida;

     |PTEC 802;   |PAUSA;
     |PULSATECLA;

     |HAZ SQLPropios;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentz2;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentz2;
|FPRC;

|PROGRAMA;
     |SI PARAMETRO = "PROPIOS";
         |HAZ Propios;
         |ACABA;
     |FINSI;

     |SI PARAMETRO = "ABIERTOS";
         |HAZ Abiertos;
         |ACABA;
     |FINSI;

     |DDEFECTO #abxz0004;
     |PINPA #0#abxz0004;  nPanta0 = FSalida;
     |PINDA #0#abxz0004;

     |ENDATOS #1#abxz0004;

     |PULSATECLA;
|FPRO;

|PROCESO Tipo80Fxz4;  |TIPO 80;
     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/abom0001.mas";  |CARGA_DEF aMas, abom0001@;
     aMas = aBase + "def/abom0002.mas";  |CARGA_DEF aMas, abom0002@;
     aMas = aBase + "def/abom0003.mas";  |CARGA_DEF aMas, abom0003@;
     aMas = aBase + "def/abom0004.mas";  |CARGA_DEF aMas, abom0004@;
     aMas = aBase + "def/abom0005.mas";  |CARGA_DEF aMas, abom0005@;
     aMas = aBase + "def/abom0006.mas";  |CARGA_DEF aMas, abom0006@;
     aMas = aBase + "def/abom0007.mas";  |CARGA_DEF aMas, abom0007@;
     aMas = aBase + "def/abom0013.mas";  |CARGA_DEF aMas, abom0013@;
     aMas = aBase + "def/abom0015.mas";  |CARGA_DEF aMas, abom0015@;

     eaFichero01 = "abom0001" + Usuario;  |NOME_DAT #abom0001@#eaFichero01#;
     eaFichero02 = "abom0002" + Usuario;  |NOME_DAT #abom0002@#eaFichero02#;
     eaFichero03 = "abom0003" + Usuario;  |NOME_DAT #abom0003@#eaFichero03#;
     eaFichero04 = "abom0004" + Usuario;  |NOME_DAT #abom0004@#eaFichero04#;
     eaFichero05 = "abom0005" + Usuario;  |NOME_DAT #abom0005@#eaFichero05#;
     eaFichero06 = "abom0006" + Usuario;  |NOME_DAT #abom0006@#eaFichero06#;
     eaFichero07 = "abom0007" + Usuario;  |NOME_DAT #abom0007@#eaFichero07#;
     eaFichero13 = "abom0013" + Usuario;  |NOME_DAT #abom0013@#eaFichero13#;
     eaFichero15 = "abom0015" + Usuario;  |NOME_DAT #abom0015@#eaFichero15#;

     aUsu = Usuario % 810;

     |NOME_DAT #abom0001#eaFicExp#;

     FSalida = 2699;
|FPRC;

|PROCESO Tipo90Fxz4;  |TIPO 90;
     |CIERRA #abom0002@;  |DELINDEX #abom0002@;
     |CIERRA #abom0003@;  |DELINDEX #abom0003@;
     |CIERRA #abom0004@;  |DELINDEX #abom0004@;
     |CIERRA #abom0005@;  |DELINDEX #abom0005@;
     |CIERRA #abom0006@;  |DELINDEX #abom0006@;
     |CIERRA #abom0007@;  |DELINDEX #abom0007@;
     |CIERRA #abom0013@;  |DELINDEX #abom0013@;
     |CIERRA #abom0015@;  |DELINDEX #abom0015@;

     |DESCARGA_DEF #abom0015@;
     |DESCARGA_DEF #abom0013@;
     |DESCARGA_DEF #abom0007@;
     |DESCARGA_DEF #abom0006@;
     |DESCARGA_DEF #abom0005@;
     |DESCARGA_DEF #abom0004@;
     |DESCARGA_DEF #abom0003@;
     |DESCARGA_DEF #abom0002@;
     |DESCARGA_DEF #abom0001@;
|FPRC;
