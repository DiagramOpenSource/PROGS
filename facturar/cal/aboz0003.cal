|FICHEROS;
     aboz0003 #0;
     abor0001 #1,MANTE;
|FIN;

|VARIABLES;
     nCampo       = 0;
     aAlfa        = "";
     aAlfa1       = "";
     aAlfa2       = "";

     &enCodExpe   = 0;
     &enCodPers   = 0;
     &eaNombreCli = "";
     &eaNombreAsu = "";
|FIN;

|PROCESO EstaExpe;
     |SI #0#14 = 0;
         |PARA nCampo = 0;  |SI nCampo [ 12;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
         |C_M #0#14, 1, "N";  #0#14 = 0;  |PINTA #0#14;
     |SINO;
         |PDEFECTO #0, 0, 13;
         |PARA nCampo = 0;  |SI nCampo [ 12;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";    |PINTA #0nCampo;
         |SIGUE;
     |FINSI;

     |SI #0#14 = 0;    |ACABA;  |FINSI;

     |ABRE #1;
     #1#0 = #0#14;
     |LEE 040#1=;
     |SI FSalida ! 0;
         |MENAV "2300 Expediente Inexistente.";
         |ERROR;
     |FINSI;
     |CIERRA #1;
|FPRC;

|PROCESO Seleccion;
     |SI #0#12 = 1; |Y Campo ! 0;   |ACABA;  |FINSI;
     |SI #0#12 = 2; |Y Campo ! 3;   |ACABA;  |FINSI;
     |SI #0#12 = 3; |Y Campo ! 15;  |ACABA;  |FINSI;

     enCodExpe = #1#0;
     enCodPers = #1#5;
     |PTEC 807;
|FPRC;

|RUTINA ClaveBaja;
     #1#0  = #0#0;
     #1#3  = #0#2;
     #1#15 = #0#6;
     #1#5  = #0#8;
     #1#4  = #0#4;
     #1#6  = #0#10;
|FRUT;

|RUTINA ClaveAlta;
     #1#0  = #0#1;
     #1#3  = #0#3;
     #1#15 = #0#7;
     #1#5  = #0#9;
     #1#4  = #0#5;
     #1#6  = #0#11;
|FRUT;

|RUTINA ClaveBaja1;
     #1#0  = #0#1;
     #1#3  = #0#2;
     #1#15 = #0#6;
     #1#5  = #0#8;
     #1#4  = #0#4;
     #1#6  = #0#10;
|FRUT;

|RUTINA ClaveAlta1;
     #1#0  = #0#0;
     #1#3  = #0#3;
     #1#15 = #0#7;
     #1#5  = #0#9;
     #1#4  = #0#5;
     #1#6  = #0#11;
|FRUT;

|RUTINA ClaveBaja2;
     |SI FSalida = "POSICION";  |Y enCodExpe ! 0;
         |ABRE #1;
         |SELECT #1#1;
         #1#0  = enCodExpe;
         |LEE 040#1];
         |SI FSalida = 0;
             aAlfa1 = #1#4;   |QBF aAlfa1;
             aAlfa2 = #0#4;   |QBF aAlfa2;
             aAlfa  = aAlfa1 - aAlfa2;
             |SI aAlfa = aAlfa1;
                 |SELECT #5#1;
                 #1#4 = #0#4;
                 #1#3 = 0;
                 #1#0 = 0;
                 |LEE 040#1];
             |FINSI;
         |FINSI;
         |CIERRA #1;
         |ACABA;
     |FINSI;

     #1#0  = #0#1;
     #1#3  = #0#2;
     #1#4  = #0#4;
|FRUT;

|RUTINA ClaveAlta2;
     #1#0  = #0#0;
     #1#3  = #0#3;
     #1#4  = #0#5;
|FRUT;

|RUTINA ClaveBaja3;
     |SI FSalida = "POSICION";  |Y enCodExpe ! 0;
         |ABRE #1;
         |SELECT #1#1;
         #1#0  = enCodExpe;
         |LEE 040#1];
         |SI FSalida = 0;
             aAlfa1 = #1#7;    |QBF aAlfa1;
             aAlfa2 = #0#15;   |QBF aAlfa2;
             aAlfa  = aAlfa1 - aAlfa2;
             |SI aAlfa = aAlfa1;
                 |SELECT #6#1;
                 #1#7 = #0#15;
                 #1#0 = 0;
                 |LEE 040#1];
             |FINSI;
         |FINSI;
         |CIERRA #1;
         |ACABA;
     |FINSI;

     #1#0  = #0#1;
     #1#7  = #0#15;
|FRUT;

|RUTINA ClaveAlta3;
     #1#0  = #0#0;
     #1#7  = #0#16;
|FRUT;

|PROGRAMA;
     |SI eaNombreAsu ! "";
         |DDEFECTO #0;
         |QBF eaNombreAsu;

         #0#15 = (eaNombreAsu + (" " * 40)) % 140;
         #0#16 = (eaNombreAsu + ("z" * 40)) % 140;

         |ENTLINEAL #6#1, -2, 4, 21, 1, ClaveBaja3, ClaveAlta3;
         |ACABA;
     |FINSI;

     |SI eaNombreCli ! "";
         |DDEFECTO #0;
         |QBF eaNombreCli;

         #0#4 = (eaNombreCli + (" " * 40)) % 140;
         #0#5 = (eaNombreCli + ("z" * 40)) % 140;

         |C_M #1#3,  1, "N";
         |ENTLINEAL #5#1, -3, 4, 21, 1, ClaveBaja2, ClaveAlta2;
         |ACABA;
     |FINSI;

     |C_M #1#1,  1, "N";
     |C_M #1#3,  1, "N";
     |C_M #1#15, 1, "N";

     |DDEFECTO #0;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #0#14 = 0;
         |SI #0#12 = 1;
             |C_M #1#1,  1, "S";
             |ENTLINEAL #3#1, -1, 4, 21, 1, ClaveBaja, ClaveAlta;
         |FINSI;

         |SI #0#12 = 2;
             |C_M #1#3,  1, "S";
             |ENTLINEAL #4#1, -1, 4, 21, 1, ClaveBaja1, ClaveAlta1;
         |FINSI;
     |SINO;
        enCodExpe = #0#14;
        enCodPers = #1#5;
     |FINSI;
|FPRO;
