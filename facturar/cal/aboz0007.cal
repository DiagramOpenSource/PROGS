|FICHEROS;
     abom0001 #0;
     abom0005 #5;
     asconcep #21;
     abom0514 #514;
|FIN;

|VARIABLES;
     nConta = 0;
|FIN;

|PROCESO CalcuM0005;
     #21#0 = #5#5;
     #21#1 = #5#6;
     |LEE 040#21=;
     |SI FSalida ! 0;  |DDEFECTO #21;  |FINSI;

     |SI #21#3 = "H";  |O #21#3 = "S";
         #0#33 = #0#33 + #5#18;
         |SI #5#19 = "S";
             #0#31 = #0#31 + #5#24;
         |FINSI;
         |SI #5#20 = "S";
             #0#10 = #0#10 + #5#25;
             #0#36 = #0#36 + #5#26;
         |FINSI;

         #0#11 = #0#31 - (#0#10 + #0#36);
         #0#32 = #0#10 - #0#33;
     |FINSI;

     |SI #21#3 = "A";
         |SI #5#20 ! "S";
             #0#37 = #0#37 + #5#18;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE abom0005;
     #5#1;
     ;
     #0#0, 000;
     #0#0, 999;
     be;
     NULL, CalcuM0005;
|FIN;

|PROCESO Recalcula;
     #0#10 = 0;
     #0#11 = 0;
     #0#31 = 0;
     #0#32 = 0;
     #0#33 = 0;
     #0#36 = 0;
     #0#37 = 0;

     |ABRE #21;
     |BUCLE abom0005;
     |CIERRA #21;

     |SI #514#19 = "S";
         #0#33 = #0#33 - #0#37;
         #0#32 = #0#10 - #0#33;
     |FINSI;

     |GRABA 020#0a;
     |LIBERA #0;
|FPRC;

|DEFBUCLE abom0001;
     #0#1;
     ;
     00000000;
     99999999;
     be;
     NULL, Recalcula;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |ABRE #514;
     |LEE 000#514p;
     |SI FSalida ! 0;  |DDEFECTO #514;  |FINSI;
     |CIERRA #514;

     |BUCLE abom0001;
|FPRC;
