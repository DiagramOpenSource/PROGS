|FICHEROS;
     asconcob #0;

     :/modelos/def/dsmom030 #2;
     :/contagen/def/canempre #1;
     :/contagen/def/calibros #3;
|FIN;

|VARIABLES;
 nada   = " ";
 campo1 = 0;
 campo2 = 0;
 campo3 = 0;
 campo4 = 0;
 campo5 = 0;
 campo6 = 0;
 campo7 = 0;
 campo8 = 0;
 swnomo = 0;
 camtipo = 0;
 contador = 0;
 conta = 0;
 x = 0;
 campito = 0;
 digito = 0;
 sw = 0;
 camsigno = 0;
 camcon = 0;
 camfec = 0;
 xxxxfiac = "  ";
 xxaponer = "  ";
 xrelleno = "                              ";
 dir_fich = "";
 path = "";
 pant = "";
 cuenta = "";
 empresa = "";
 anyo = "";
 arte = "";
 long = "  ";
 coge = 0;
 dig1 = 0;
 dig3 = 0;
 dig4 = 0;
 dig5 = 0;
 dig6 = 0;
 dig7 = 0;
 dig8 = 0;
 dig9 = 0;

 &eaPathContagen = "";
|FIN;

|PROCESO acceder; |TIPO 0;
|HAZ BusquedaApli;

path = eaPathContagen;  |QBF path;
path = path + "fich/";
pant = path;
long = pant % 0;
coge = 100 + (long - 6);
pant = pant % coge;
pant = pant + "/pan/";

empresa = #0#0;
empresa = ("00000" + empresa) % -105;

anyo = #0#1;
anyo = "0" + anyo;
anyo = anyo % -101;
empresa = empresa + anyo;

|ABRE #1;
#1#2 = #0#0;
#1#3 = #0#1;
|LEE 040#1=;
|SI FSalida ! 0;
   |MENAV "      No existe Empresa Contable";
   |ERROR;
|SINO;
   path = path + empresa +  "/";

   |PATH_DAT #2path;
   |PATH_PAN #2pant;
   |PATH_DAT #3path;
   |PATH_PAN #3pant;
   dig1 = #1#11;
   dig3 = #1#13;
   dig4 = #1#14;
   dig5 = #1#15;
   dig6 = #1#16;
   dig7 = #1#17;
   dig8 = #1#18;
   dig9 = #1#19;
|FINSI;
|CIERRA #1;
|FPRC;

|PROCESO libros; |TIPO 0;
|ABRE #3;
#3#0 = #0#2;
|LEE 040#3=;
|SI FSalida = 0;
    #0#3 = #3#1;
    |PINTA #0#3;
|FINSI;
|CIERRA #3;
|FPRC;

|PROCESO ayuda1; |TIPO 7;
|PUSHV 0546 2277;
|ATRI I;
|CUADRO 0546 2277;
|ATRI R;

    |PINTA 0647, " ---- POSIBLES APUNTES -Pag.1 ";
    |PINTA 0747, " (01) Honorarios sin DTO.     ";
    |PINTA 0847, " (02) Honorarios con DTO.     ";
    |PINTA 0947, " (03) Total Descuento         ";
    |PINTA 1047, " (04) Bruto Factura           ";
    |PINTA 1147, " (05) Base Imponible          ";
    |PINTA 1247, " (06) Base Imponible + IVA    ";
    |PINTA 1347, " (07) Base + IVA - IRPF       ";
    |PINTA 1447, " (08) Importe IVA             ";
    |PINTA 1547, " (09) Importe IRPF            ";
    |PINTA 1647, " (10) Importe a Cuenta        ";
    |PINTA 1747, " (11) Importe Suplidos        ";
    |PINTA 1847, " (12) Importe total Factura   ";
    |PINTA 1947, " (13) Importe total Recibo    ";
    |PINTA 2047, " (14) Honor.y Suplidos sin DTO";
    |PINTA 2147, " (15) Honor.y Suplidos con DTO";

    |PAUSA;

    |PINTA 0647, " ---- POSIBLES APUNTES -Pag.2 ";
    |PINTA 0747, " (16) Pdte.Cobro *Act Cob+Cont";
    |PINTA 0847, " (17) Pdte Contab.*Act Contab.";
    |PINTA 0947, " (18) Pdte.Cobro *No Actualiza";
    |PINTA 1047, "==============================";
    |PINTA 1147, "                              ";
    |PINTA 1247, "                              ";
    |PINTA 1347, "                              ";
    |PINTA 1447, "                              ";
    |PINTA 1547, "                              ";
    |PINTA 1647, "                              ";
    |PINTA 1747, "                              ";
    |PINTA 1847, "                              ";
    |PINTA 1947, "                              ";
    |PINTA 2047, "                              ";
    |PINTA 2147, "                              ";

    |ATRI 0;
|FPRC;

|PROCESO ayuda3; |TIPO 7;
|SI #0#4 ! 1;
   |PUSHV 0505 2236;
   |ATRI I;
   |CUADRO 0505 2236;
   |ATRI R;

   |PINTA 0606, " ---- POSIBLES APUNTES -Pag.1 ";
   |PINTA 0706, " (01) Honorarios sin DTO.     ";
   |PINTA 0806, " (02) Honorarios con DTO.     ";
   |PINTA 0906, " (03) Total Descuento         ";
   |PINTA 1006, " (04) Bruto Factura           ";
   |PINTA 1106, " (05) Base Imponible          ";
   |PINTA 1206, " (06) Base Imponible + IVA    ";
   |PINTA 1306, " (07) Base + IVA - IRPF       ";
   |PINTA 1406, " (08) Importe IVA             ";
   |PINTA 1506, " (09) Importe IRPF            ";
   |PINTA 1606, " (10) Importe a Cuenta        ";
   |PINTA 1706, " (11) Importe Suplidos        ";
   |PINTA 1806, " (12) Importe total Factura   ";
   |PINTA 1906, " (13) Importe total Recibo    ";
   |PINTA 2006, " (14) Honor.y Suplidos sin DTO";
   |PINTA 2106, " (15) Honor.y Suplidos con DTO";

    |PAUSA;

    |PINTA 0647, " ---- POSIBLES APUNTES -Pag.2 ";
    |PINTA 0747, " (16) Pdte.Cobro *Act Cob+Cont";
    |PINTA 0847, " (17) Pdte Contab.*Act Contab.";
    |PINTA 0947, " (18) Pdte.Cobro *No Actualiza";
    |PINTA 1047, "==============================";
    |PINTA 1147, "                              ";
    |PINTA 1247, "                              ";
    |PINTA 1347, "                              ";
    |PINTA 1447, "                              ";
    |PINTA 1547, "                              ";
    |PINTA 1647, "                              ";
    |PINTA 1747, "                              ";
    |PINTA 1847, "                              ";
    |PINTA 1947, "                              ";
    |PINTA 2047, "                              ";
    |PINTA 2147, "                              ";

|ATRI 0;
|FINSI;
|FPRC;

|PROCESO ayuda2; |TIPO 0;
|POPV;
|SI #0Campo = 0;
    campo1 = Campo + 8;
    campo2 = Campo + 16;
    campo3 = Campo + 24;
    campo4 = Campo + 32;
    campo5 = Campo + 40;
    campo6 = Campo + 48;
    campo7 = Campo + 119;
    campo8 = Campo + 127;
    #0campo1 = "            "; |PINTA #0campo1;
    #0campo2 = 0;              |PINTA #0campo2;
    #0campo3 = " ";            |PINTA #0campo3;
    #0campo4 = 0;              |PINTA #0campo4;
    #0campo5 = "N";            |PINTA #0campo5;
    #0campo6 = "N";            |PINTA #0campo6;
    #0campo7 = " ";            |PINTA #0campo7;
    #0campo8 = 0;              |PINTA #0campo8;
|FINSI;
|FPRC;

|PROCESO ayuda4; |TIPO 0;
|SI #0#4 ! 1; |POPV; |FINSI;
|SI #0Campo = 0;
    campo1 = Campo + 8;
    campo2 = Campo + 16;
    campo3 = Campo + 24;
    campo4 = Campo + 32;
    campo5 = Campo + 40;
    campo6 = Campo + 48;
    #0campo1 = "            "; |PINTA #0campo1;
    #0campo2 = 0;              |PINTA #0campo2;
    #0campo3 = " ";            |PINTA #0campo3;
    #0campo4 = 0;              |PINTA #0campo4;
    #0campo5 = "N";            |PINTA #0campo5;
    #0campo6 = "N";            |PINTA #0campo6;
|FINSI;
|FPRC;

|PROCESO contador; |TIPO 0;
swnomo = 0;
camtipo = Campo - 8;
|SI #0Campo ! "            ";
   contador = 0;
   conta = 0;
   cuenta = #0Campo;
   |PARA x = 1; |SI x [ 12; |HACIENDO x = x + 1;
      conta = (x * 100) + 1;
      arte = cuenta % conta;
      |SI arte = "*"; contador = x; |FINSI;
   |SIGUE;
   |SI contador = 0;
      swnomo = 0;
      |HAZ pintaniv;
   |SINO;
      swnomo = 1;
      conta = 100 + (contador - 1);
      cuenta = cuenta % conta;
      long = cuenta % 0;
   |FINSI;
|SINO;
  |SI #0camtipo ! 0;
      |MENAV "      Introduzca cuenta por favor, o ponga tipo <00>";
      |ERROR;
  |FINSI;
  swnomo = 0;
|FINSI;
|FPRC;

|PROCESO contado2; |TIPO 0;
swnomo = 0;
|SI #0Campo ! "            ";
   contador = 0;
   conta = 0;
   cuenta = #0Campo;
   |PARA x = 1; |SI x [ 12; |HACIENDO x = x + 1;
      conta = (x * 100) + 1;
      arte = cuenta % conta;
      |SI arte = "*"; contador = x; |FINSI;
   |SIGUE;
   |SI contador = 0;
      swnomo = 0;
      |HAZ pintaniv;
   |SINO;
      swnomo = 1;
      conta = 100 + (contador - 1);
      cuenta = cuenta % conta;
      long = cuenta % 0;
   |FINSI;
|SINO;
  |MENAV "      Introduzca cuenta por favor";
  |ERROR;
  swnomo = 0;
|FINSI;
|FPRC;

|PROCESO contado1; |TIPO 0;
campito = Campo - 8;
camtipo = Campo - 16;
|SI #0campito ! "            ";
   contador = 0;
   conta = 0;
   cuenta = #0campito;
   |PARA x = 1; |SI x [ 12; |HACIENDO x = x + 1;
      conta = (x * 100) + 1;
      arte = cuenta % conta;
      |SI arte = "*"; contador = x; |FINSI;
   |SIGUE;
   |SI contador ! 0;
      swnomo = 1;
      conta = 100 + (contador - 1);
      cuenta = cuenta % conta;
      long = cuenta % 0;
   |SINO;
      swnomo = 0;
   |FINSI;
|SINO;
   |SI #0camtipo ! 0;
      |MENAV "      Introduzca cuenta por favor, o ponga tipo <00>";
      |ERROR;
   |FINSI;
   swnomo = 0;
|FINSI;
|FPRC;

|PROCESO contado3; |TIPO 0;
campito = Campo - 1;
|SI #0campito ! "            ";
   contador = 0;
   conta = 0;
   cuenta = #0campito;
   |PARA x = 1; |SI x [ 12; |HACIENDO x = x + 1;
      conta = (x * 100) + 1;
      arte = cuenta % conta;
      |SI arte = "*"; contador = x; |FINSI;
   |SIGUE;
   |SI contador ! 0;
      swnomo = 1;
      conta = 100 + (contador - 1);
      cuenta = cuenta % conta;
      long = cuenta % 0;
   |SINO;
      swnomo = 0;
   |FINSI;
|SINO;
   |MENAV "      Introduzca cuenta por favor";
   swnomo = 0;
|FINSI;
|FPRC;

|PROCESO nivelcli;|TIPO 0;
|SI swnomo = 1;
   |SI #0Campo [ dig3;
      digito = 0;
      |SI #0Campo = 1; digito = dig4; |FINSI;
      |SI #0Campo = 2; digito = dig5; |FINSI;
      |SI #0Campo = 3; digito = dig6; |FINSI;
      |SI #0Campo = 4; digito = dig7; |FINSI;
      |SI #0Campo = 5; digito = dig8; |FINSI;
      |SI #0Campo = 6; digito = dig9; |FINSI;

      |SI long ] digito;
         |MENAV "       Longitud de cuenta fuera de Nivel";
         |ERROR;
      |FINSI;
   |SINO;
      |MENAV "     No existe Nivel";
      |ERROR;
   |FINSI;
|FINSI;
|FPRC;

|PROCESO pintaniv; |TIPO 0;
campito = Campo + 1;
cuenta = #0Campo;
|QBF cuenta;
long = cuenta % 0;
|SI long ! 0;
   sw = 0;
   |SI long = dig4; sw = 1; |FINSI;
   |SI long = dig5; sw = 1; |FINSI;
   |SI long = dig6; sw = 1; |FINSI;
   |SI long = dig7; sw = 1; |FINSI;
   |SI long = dig8; sw = 1; |FINSI;
   |SI long = dig9; sw = 1; |FINSI;
   |SI sw = 0;
      |MENAV "       Longitud de cuenta fuera de Nivel";
      |ERROR;
   |FINSI;
|FINSI;
|FPRC;

|PROCESO signo; |TIPO 0;
camsigno = Campo - 24;
|SI #0camsigno ! 0;
   |SI #0Campo ! "D"; |Y #0Campo ! "H";
        |MENAV "      Introduzca <D> para el Debe o <H> para Haber";
        |ERROR;
   |FINSI;
|FINSI;
|FPRC;

|PROCESO pintacon; |TIPO 0;
camcon = Campo - 32;
|SI #0camcon ! 0;
   |ABRE #2;
    #2#0 = #0Campo;
    |LEE 040#2=;
    |SI FSalida ! 0;
       |MENAV "     No existe Concepto";
       |ERROR;
    |FINSI;
    |CIERRA #2;
|FINSI;
|FPRC;

|PROCESO pintaco1; |TIPO 0;
|ABRE #2;
#2#0 = #0Campo;
|LEE 040#2=;
|SI FSalida ! 0;
   |MENAV "     No existe Concepto";
   |ERROR;
|FINSI;
|CIERRA #2;
|FPRC;

|PROCESO nomo; |TIPO 7;
|SI Campo = 118;
    |HAZ contado3;
|SINO;
    |HAZ contado1;
|FINSI;
|SI swnomo = 0;
   #0Campo = 0;
   |PINTA #0Campo;
   |HAZ nomodifi;
|FINSI;
|FPRC;

|PROCESO asie2; |TIPO 7;
|SI #0#4 = 1;
    |HAZ nomodifi;
|SINO;
   |SI Campo = 69; |O Campo = 77; |O Campo = 85; |O Campo = 93;
    |O Campo = 101; |O Campo = 109;
       |SI #0#61 = 0; |HAZ nomodifi; |FINSI;
   |FINSI;
   |SI Campo = 70; |O Campo = 78; |O Campo = 86; |O Campo = 94;
    |O Campo = 102; |O Campo = 110;
       |SI #0#62 = 0; |HAZ nomodifi; |FINSI;
   |FINSI;
   |SI Campo = 71; |O Campo = 79; |O Campo = 87; |O Campo = 95;
    |O Campo = 103; |O Campo = 111;
       |SI #0#63 = 0; |HAZ nomodifi; |FINSI;
   |FINSI;
   |SI Campo = 72; |O Campo = 80; |O Campo = 88; |O Campo = 96;
    |O Campo = 104; |O Campo = 112;
       |SI #0#64 = 0; |HAZ nomodifi; |FINSI;
   |FINSI;
   |SI Campo = 73; |O Campo = 81; |O Campo = 89; |O Campo = 97;
    |O Campo = 105; |O Campo = 113;
       |SI #0#65 = 0; |HAZ nomodifi; |FINSI;
   |FINSI;
   |SI Campo = 74; |O Campo = 82; |O Campo = 90; |O Campo = 98;
    |O Campo = 106; |O Campo = 114;
       |SI #0#66 = 0; |HAZ nomodifi; |FINSI;
   |FINSI;
   |SI Campo = 75; |O Campo = 83; |O Campo = 91; |O Campo = 99;
    |O Campo = 107; |O Campo = 115;
       |SI #0#67 = 0; |HAZ nomodifi; |FINSI;
   |FINSI;
   |SI Campo = 76; |O Campo = 84; |O Campo = 92; |O Campo = 100;
    |O Campo = 108; |O Campo = 116;
       |SI #0#68 = 0; |HAZ nomodifi; |FINSI;
   |FINSI;
|FINSI;
|FPRC;

|PROCESO tipono; |TIPO 7;
|SI Campo = 13; |O Campo = 21; |O Campo = 29; |O Campo = 37;
 |O Campo = 45; |O Campo = 53; |O Campo = 124; |O Campo = 132;
    |SI #0#5 = 0; |HAZ nomodifi; |FINSI;
|FINSI;
|SI Campo = 14; |O Campo = 22; |O Campo = 30; |O Campo = 38;
 |O Campo = 46; |O Campo = 54; |O Campo = 125; |O Campo =133;
    |SI #0#6 = 0; |HAZ nomodifi; |FINSI;
|FINSI;
|SI Campo = 15; |O Campo = 23; |O Campo = 31; |O Campo = 39;
 |O Campo = 47; |O Campo = 55; |O Campo = 126; |O Campo = 134;
    |SI #0#7 = 0; |HAZ nomodifi; |FINSI;
|FINSI;
|SI Campo = 16; |O Campo = 24; |O Campo = 32; |O Campo = 40;
 |O Campo = 48; |O Campo = 56; |O Campo = 127; |O Campo = 135;
    |SI #0#8 = 0; |HAZ nomodifi; |FINSI;
|FINSI;
|SI Campo = 17; |O Campo = 25; |O Campo = 33; |O Campo = 41;
 |O Campo = 49; |O Campo = 57; |O Campo = 128; |O Campo = 136;
    |SI #0#9 = 0; |HAZ nomodifi; |FINSI;
|FINSI;
|SI Campo = 18; |O Campo = 26; |O Campo = 34; |O Campo = 42;
 |O Campo = 50; |O Campo = 58; |O Campo = 129; |O Campo = 137;
    |SI #0#10 = 0; |HAZ nomodifi; |FINSI;
|FINSI;
|SI Campo = 19; |O Campo = 27; |O Campo = 35; |O Campo = 43;
 |O Campo = 51; |O Campo = 59; |O Campo = 130; |O Campo = 138;
    |SI #0#11 = 0; |HAZ nomodifi; |FINSI;
|FINSI;
|SI Campo = 20; |O Campo = 28; |O Campo = 36; |O Campo = 44;
 |O Campo = 52; |O Campo = 60; |O Campo = 131; |O Campo = 139;
    |SI #0#12 = 0; |HAZ nomodifi; |FINSI;
|FINSI;
|FPRC;

|PROCESO fechno; |TIPO 7;
camfec = Campo - 8;
|SI #0camfec = "S";
    #0Campo = "N";
    |PINTA #0Campo;
    |HAZ nomodifi;
|FINSI;
|FPRC;

|PROCESO nomodifi;             || RUTINA DE CONVERSION A NO MODIFICABLES
                               || VARIABLES: A_
    xxaponer = Anono;
    xxxxfiac = Control % A1001;
    Control = Control + xxxxfiac;
    Control = Control + xrelleno;
    Control = Control % A120;
    Control = Control + xxaponer;
|FPRC;
