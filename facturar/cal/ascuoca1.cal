|FICHEROS;
    ascuoca1 #0;
    ascuoli1 #3;
    asconcli #1;
    asconmen #2;
    asconcep #4;
    asclient #5;
    asconlin #7;
    ascontrt #450;
    abom0509 #509;
    abom0510 #510;
|FIN;

|VARIABLES;
     nModo     = 0;
     nVariable = 0;
     nDeDonde  = 0;

     aParam    = "";
     aDescri1  = "";
     aDescri2  = "";
     aDescri3  = "";
     aDescri4  = "";

     &enEmpresa = 0;
     &eaPath    = "";
|FIN;

|PROCESO ascuolin;
     #0#6 = #0#6 + #3#7;
|FPRC;

|DEFBUCLE ascuoli1;
     #3#1;
     ;
     #0#0, #0#8, 001;
     #0#0, #0#8, 999;
     ;
     NULL, ascuolin;
|FIN;

|PROCESO Tipo30B;  |TIPO 30;
     |ABRE #5;
     #5#0 = #0#0;
     |LEE 040#5=;
     |SI FSalida ! 0; |DDEFECTO #5; |FINSI;
     |CIERRA #5;

     |ABRE #4;
     #4#0 = #0#3;
     #4#1 = #0#4;
     |LEE 040#4=;
     |SI FSalida ! 0; |DDEFECTO #4; |FINSI;
     |CIERRA #4;

     |ABRE #2;    ||Conceptos Variables;
     #2#0 = #0#3;
     #2#1 = #0#4;
     |LEE 040#2=;
     |SI FSalida = 0;
         aDescri1 = #2#2;
         aDescri2 = #2#2;
         aDescri3 = #2#3;
         aDescri4 = #2#4;
         nDeDonde = 1;
     |SINO;
         aDescri1 = #4#2;
         aDescri2 = #4#16;
         aDescri3 = #4#17;
         aDescri4 = #4#18;
         nDeDonde = 2;
     |FINSI;
     |CIERRA #2;

     |ABRE #1;    ||Conceptos Clientes;
     #1#0 = #0#0; ||Cliente;
     #1#1 = #0#3; ||Seccion;
     #1#2 = #0#4; ||Concepto;
     |LEE 101#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         #1#0 = #0#0; ||Cliente;
         #1#1 = #0#3; ||Seccion;
         #1#2 = #0#4; ||Concepto;
         #1#4  = #4#33;
         #1#5  = "G";
         |GRABA 020#1b;
     |FINSI;

     #1#3  = "H";
     #1#6  = aDescri1;
     #1#7  = aDescri2;
     #1#8  = aDescri3;
     #1#9  = aDescri4;
     #1#10 = #0#7;
     #1#11 = #0#9;
     |GRABA 020#1a;
     |LIBERA #1;
     |CIERRA #1;

     |ABRE #7;
     |SI nDeDonde = 2;
         #7#0 = 2;
         #7#1 = #1#0;
         #7#2 = #1#1;
         #7#3 = #1#2;
         #7#4 = 1;
         |LEE 040#7=;
         |SI FSalida ! 0;
             |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
                   #7#0 = 1;
                   #7#1 = 0;
                   #7#2 = #1#1;
                   #7#3 = #1#2;
                   #7#4 = nVariable;
                   |LEE 040#7=;
                   |SI FSalida = 0;
                       #7#0 = 2;
                       #7#1 = #1#0;
                       #7#2 = #1#1;
                       #7#3 = #1#2;
                       #7#4 = nVariable;
                       |GRABA 020#7n;
                       |LIBERA #7;
                   |FINSI;
             |SIGUE;
         |FINSI;
     |SINO;
         #7#0 = 2;
         #7#1 = #1#0;
         #7#2 = #1#1;
         #7#3 = #1#2;
         #7#4 = 1;
         |LEE 040#7=;
         |SI FSalida ! 0;
             |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
                   #7#0 = 3;
                   #7#1 = 0;
                   #7#2 = #1#1;
                   #7#3 = #1#2;
                   #7#4 = nVariable;
                   |LEE 040#7=;
                   |SI FSalida = 0;
                       #7#0 = 2;
                       #7#1 = #1#0;
                       #7#2 = #1#1;
                       #7#3 = #1#2;
                       #7#4 = nVariable;
                       |GRABA 020#7n;
                       |LIBERA #7;
                   |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
     |CIERRA #7;
|FPRC;

|RUTINA ClaveBaja3;
     #3#0 = #0#0;
     #3#9 = #0#8;
     #3#1 = 001;
|FRUT;

|RUTINA ClaveAlta3;
     #3#0 = #0#0;
     #3#9 = #0#8;
     #3#1 = 999;
|FRUT;

|PROCESO Tipo3B; |TIPO 3;
     |ENTLINEAL #1#3, -3, 2, 22, 0, ClaveBaja3, ClaveAlta3;

     |ABRE #5;
     #5#0 = #0#0;
     |LEE 040#5=;
     |SI FSalida ! 0; |DDEFECTO #5; |FINSI;
     |CIERRA #5;

     #0#1 = #5#1;

     |CONFI "2400NDesea recalcular los importes de la cabecera : ";
     |SI FSalida ! 0; |ACABA; |FINSI;
     #0#6 = 0;
     #0#7 = 0;

     |BUCLE ascuoli1;

     |SI #0#2 = "M"; #0#7 = #0#6 / 12; |FINSI;
     |SI #0#2 = "T"; #0#7 = #0#6 / 4;  |FINSI;
     |SI #0#2 = "S"; #0#7 = #0#6 / 2;  |FINSI;
     |SI #0#2 = "A"; #0#7 = #0#6 / 1;  |FINSI;

     |PINTA #0#6;
     |PINTA #0#7;
|FPRC;

|PROCESO ascuoli1B;
     |BORRA 020#3a;
     |LIBERA #3;
|FPRC;

|DEFBUCLE ascuoli1B;
     #3#1;
     ;
     #0#0, #0#8, 001;
     #0#0, #0#8, 999;
     be;
     NULL, ascuoli1B;
|FIN;

|PROCESO Tipo2A; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 3; |ACABA; |FINSI;

     |ABRE #1;
     #1#0 = #0#0;
     #1#1 = #0#3;
     #1#2 = #0#4;
     |LEE 101#1=;
     |SI FSalida = 0;  |BORRA 040#1a;  |FINSI;
     |CIERRA #1;

     |ABRE #7;
     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
          #7#0 = 2;
          #7#1 = #1#0;
          #7#2 = #1#1;
          #7#3 = #1#2;
          #7#4 = nVariable;
          |LEE 101#7=;
          |SI FSalida = 0;
              |BORRA 020#7a;
          |FINSI;
          |LIBERA #7;
     |SIGUE;
     |CIERRA #7;

     |BUCLE ascuoli1B;
|FPRC;

|PROCESO Tipo7;  |TIPO 7;
     |ENTLINEAL #1#3, -3, 7, 22, 0, ClaveBaja3, ClaveAlta3;
|FPRC;

|RUTINA ClaveBaja0;
     #0#0 = enEmpresa;
     #0#8 = 1900;
|FRUT;

|RUTINA ClaveAlta0;
     #0#0 = enEmpresa;
     #0#8 = 2999;
|FRUT;

|RUTINA ClaveBaja2;
     #0#0 = enEmpresa;
     #0#8 = 2999;
|FRUT;

|RUTINA ClaveAlta2;
     #0#0 = enEmpresa;
     #0#8 = 1900;
|FRUT;


|PROGRAMA;
    aParam = PARAMETRO; |QBF aParam;

    |PATH_DAT #0   eaPath;
    |PATH_DAT #1   eaPath;
    |PATH_DAT #2   eaPath;
    |PATH_DAT #3   eaPath;
    |PATH_DAT #4   eaPath;
    |PATH_DAT #5   eaPath;
    |PATH_DAT #7   eaPath;
    |PATH_DAT #509 eaPath;
    |PATH_DAT #510 eaPath;
    |PATH_DAT #450 eaPath;

    |SI aParam ! "menor";
        |ENTLINEAL #1#0, -2, 2, 22, 1, ClaveBaja0, ClaveAlta0;
    |SINO;
        |ENTLINEAL #2#0, -2, 2, 22, 1, ClaveBaja2, ClaveAlta2;
    |FINSI;

    |ABRE #0;
    #0#0 = enEmpresa;
    #0#8 = 2999;
    |LEE 040#0];
    |SI FSalida = 0;
        |LEE 040#0a;
    |SINO;
        |LEE 040#0u;
    |FINSI;
    |SI FSalida = 0;  |Y #0#0 = enEmpresa;
        |HAZ Tipo30B;
    |FINSI;
    |CIERRA #0;
|FPRO;
