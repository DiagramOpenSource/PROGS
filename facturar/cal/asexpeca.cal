|FICHEROS;
   asexpeca #0;
   asclient #1;
   asexcont #2;
   ascnsexp #3,MANTE;
|FIN;

|VARIABLES;
    entrada = 0;
    cont    = 0;
    Linea   = 0;
    Cliente = 0;
    &enSw     = 0;
    &enAnyo   = 0;
    &enNumExp = 0;

    Comodin = "";
    aAlfa  = "";
    aAlfa1 = "";
|FIN;

|PROCESO anyo; |TIPO 7;
entrada = (FEntrada / 100) ! 0;
|SI entrada = 4;
   |MENSA "    Introduzca el a¤o; <F2> Consulta de expedientes";
|SINO;
   |MENSA "    Introduzca el a¤o";
|FINSI;
|SI entrada ! 1; |ACABA; |FINSI;

|ABRE #2;
|LEE 110#2u;
|SI FSalida ! 0; |ACABA; |FINSI;
#0#0 = #2#0;
|CIERRA #2;
|FPRC;

|PROCESO lee_conta; |TIPO 7;
|SI entrada ! 1; |ACABA; |FINSI;

|ABRE #2;
#2#0 = #0#0;
|LEE 040#2=;
|SI FSalida ! 0;
    #0#14 = 1; |PINTA #0#14;

    #2#0 = #0#0;
    #2#1 = 0;
    |GRABA 020#2b;
|SINO;
    #0#14 = #2#1 + 1; |PINTA #0#14;
|FINSI;
|CIERRA #2;
|FPRC;

|PROCESO contador; |TIPO 0;
|SI entrada ! 1; |ACABA; |FINSI;

|ABRE #2;
#2#0 = #0#0;
|LIBERA #2;
|LEE 140#2=;
|SI FSalida = 0;
    #2#1  = #0#14;
    |GRABA 140#2a;
|FINSI;
|CIERRA #2;
|FPRC;

|PROCESO cliente;|TIPO 0;
cont = (FEntrada / 100) ! 0;
|SI cont ! 1; |ACABA; |FINSI;

#1#0 = #0#1;
|LEE 040#1=;
|SI FSalida = 0;
    #0#2 = #1#2;
    |SI #0#2 = "                                        ";
        #0#2 = #1#1;
    |FINSI;
    |PINTA #0#2;
|FINSI;
|FPRC;

|PROCESO cerrado; |TIPO 0;
cont = (FEntrada / 100) ! 0;
|SI cont ! 2; |ACABA; |FINSI;

|SI #0#12 = "S";
    |MENAV "    El expediente ya esta cerrado. No se puede modificar.";
    |PTEC 807;
|FINSI;
|FPRC;

|RUTINA inf;
   #ascnsexp#1  = Cliente;
   #ascnsexp#0  = 00;
   #ascnsexp#14 = 000001;
|FRUT;

|RUTINA sup;
   #ascnsexp#1  = Cliente;
   #ascnsexp#0  = 99;
   #ascnsexp#14 = 999999;
|FRUT;

|PROCESO Consulta;
   |PINTA 0420, "                                              ";
   entrada = (FEntrada / 100) ! 0;
   |SI FSalida = 10; |Y entrada = 4;
      |ENCAMPO #1#asexpeca;
      |SI FSalida = 0;
         |PUSHV 0501 2380;
         enSw = -1; Cliente = #asexpeca#1;
         |ENTLINEAL #3#ascnsexp,-3,4,19,1,inf,sup;
         |SI enSw = 0;
            #asexpeca#0  = enAnyo;
            #asexpeca#14 = enNumExp;
            |CIERRA #ascnsexp;
            |ERROR; |PTEC 801; |PTEC 801;
         |SINO;
            |CIERRA #ascnsexp;
            |ERROR;
         |FINSI;
         |POPV;
      |SINO;
         |ERROR;
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO Impresion; |TIPO 4;
   aAlfa1 = ("00" + #asexpeca#0) % -102;      aAlfa = aAlfa1 + aAlfa1;
   aAlfa1 = ("000000" + #asexpeca#14) % -106; aAlfa = aAlfa + (aAlfa1 + aAlfa1);
   aAlfa1 = ("00" + #48#0) % -102;            aAlfa = aAlfa + aAlfa1;
   aAlfa  = "asexpimp.tab;" + aAlfa;
   |SUB_EJECUTA_NP aAlfa;
|FPRC;
