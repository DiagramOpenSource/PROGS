|FICHEROS;
     asempres #0;                           || CALCULO PARA OPCION DE IM-   ;
     Ref0001@ #1000;                        || PRESION EN MANTENIMIENTOS    ;

|FIN;

|VARIABLES;
     nSwControl = 0;
     nume1 = 0;
     nume2 = 0;
     lugar = 0;
     nifnum = 0;
     resto = 0;

     &eaVarDni     = "";
     &enCalcCif    = 0;

     nSwVisados = 0;
     aMensaje = "";

     aAlfa = "";
     nHandle = 0;
|FIN;

|PROCESO LetraDni0;  |TIPO 6;
     |SI FSalida = 10;
         enCalcCif = 1;
         eaVarDni  =  #0Campo;
         |HAZ CalculoDNI;
         #0Campo = eaVarDni;
         |PINTA #0Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #0Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 112;
     |SI #0Campo ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #0Campo = eaVarDni;  |PINTA #0Campo;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo80; |TIPO 80;
     |HAZ EsVisados;
     nSwVisados = FSalida;

|FPRC;


|PROCESO Tipo13asempres; |TIPO 13;
     |SI nSwControl = 0;

          |C_M #asempres#16, 1, "N";
          |PINTA #asempres#16;

          |C_M #asempres#17, 1, "N";
          |PINTA #asempres#17;

          |C_M #asempres#18, 1, "N";
          |PINTA #asempres#18;

          |DBASS aAlfa; |QBF aAlfa;
          aAlfa = aAlfa + "dsarchi/def/dsarm001.mas";
          |XABRE "E", aAlfa, nHandle;
          |SI FSalida ] 0;
             |CARGA_DEF aAlfa, Ref0001@;
             |SI FSalida = 0;
                |DBASS aAlfa; |QBF aAlfa;
                aAlfa = aAlfa + "dsarchi/fich/"; |PATH_DAT #1000 aAlfa;
                |ABRE #Ref0001@;
                |DDEFECTO #Ref0001@;
                |LEE 000#Ref0001@.p;
                |SI FSalida ! 0; |DDEFECTO #Ref0001@; |FINSI;

                |SI #Ref0001@#3 = "S";
                     |C_M #asempres#16, 1, "S";
                     |PINTA #asempres#16;

                     |C_M #asempres#17, 1, "S";
                     |PINTA #asempres#17;

                     |C_M #asempres#18, 1, "S";
                     |PINTA #asempres#18;
                |FINSI;
                |CIERRA #Ref0001@; |DESCARGA_DEF #Ref0001@;
             |FINSI;
          |FINSI;

          nSwControl = 1;

     |FINSI;
|FPRC;
