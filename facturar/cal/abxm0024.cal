|FICHEROS;
     facemp   #10;
     abxm0024 #524;
     abxm0020 #520;
     abxm0021 #521;
     abxm0515 #515,MANTE;
     abom0514 #514;
     &clientes@ #715;
|FIN;

|VARIABLES;
     nVariable  = 0;
     nMail      = 0;
     nContenido = 0;
     nSubVent   = 0;

     aAlfa      = "";

     {-1}aVent      = "";
         aVent1     = 0;
         aVent2     = 0;
         aVent3     = 0;
         aVent4     = 0;
         aVent5     = "";

     &aNif = "";

     &enCodCli      = 0;
     &enCalcCif     = 0;
     &eaVarDni      = "";
     &eaPathIntegral = "";
|FIN;

|PROCESO AltaIntegral;
     #715#0 = #524#0;
     |LEE 101#715=;
     |SI FSalida ! 0;
         |DDEFECTO #715;
         #715#0 = #524#0;
         |GRABA 020#715b;
     |FINSI;

     #715#2  = #524#1;
     #715#1  = #524#2;
     #715#20 = #524#3;
     #715#25 = #524#4;
     #715#26 = #524#5;
     #715#27 = #524#6;
     #715#28 = #524#7;
     #715#3  = #524#8;
     #715#54 = #524#9;
     #715#55 = #524#10;
     #715#88 = #524#53;
     #715#89 = #524#11;

     |GRABA 020#715a;
     |LIBERA #715;

     enCodCli = #715#0;
     |SUB_EJECUTA_NP ":integral/dsaz0003;SOLOUNCLIENTE";
|FPRC;

|PROCESO AltaBasica;
     #715#0 = #524#0;
     |LEE 101#715=;
     |SI FSalida ! 0;
         |DDEFECTO #715;
         #715#0 = #524#0;
         |GRABA 020#715b;
     |FINSI;

     #715#1  =  #524#1;
     #715#2  =  #524#2;
     #715#3  =  #524#3;
     #715#9  =  #524#4;
     #715#10 =  #524#5;
     #715#11 =  #524#6;
     #715#12 =  #524#7;
     #715#13 =  #524#8;
     #715#14 =  #524#9;
     #715#15 =  #524#10;
     #715#79 =  #524#53;
     #715#80 =  #524#11;
     #715#84 =  #524#14;

     |GRABA 020#715a;
     |LIBERA #715;
|FPRC;

|PROCESO Tipo3Fxm24;  |TIPO 3;
     |MENAV "0000 Recuerde que es un alta r pida, no se olvide de completar el resto de datos en su mantenimiento.";

     |HAZ BusquedaApli;

     |DFICE aAlfa;  |QBF aAlfa;
     aAlfa = aAlfa % -202;

     |ABRE #10;
     #10#0 = aAlfa;
     |LEE 040#10=;
     |SI FSalida ! 0;  |DDEFECTO #10;  |FINSI;
     |CIERRA #10;

     enCodCli = #524#0;
     |HAZ LeePersona;

     |ABRE #715;
     |SI eaPathIntegral ! "";  |Y #10#3 = "S";
         |HAZ AltaIntegral;
     |SINO;
         |HAZ AltaBasica;
         |GRABA 020#524n;
         |LIBERA #524;
     |FINSI;
     |CIERRA #715;

     |ABRE #514;
     |LEE 040#514p;
     |SI FSalida ! 0;  |DDEFECTO #514;  |FINSI;
     |CIERRA #514;

     |SI #514#1 ! "S";  |ACABA;  |FINSI;

     |ABRE #515;
     |SELECT #2#515;
     #515#1 = #524#1;
     |LEE 040#515=;
     |SI FSalida = 0;  |CIERRA #515;  |ACABA;  |FINSI;
     |CONFI "     Desea crearlo en la Libreta de Direcciones";
     |SI FSalida ! 0;  |CIERRA #515;  |ACABA;  |FINSI;

     |SELECT #1#515;
     |LEE 040#515u;

     nMail = #515#0 + 1;

     |DDEFECTO #515;
     #515#0 = nMail;
     |GRABA 020#515b;

     #515#1  = #524#1;
     #515#4  = #524#3;
     #515#6  = #524#4;
     #515#7  = #524#5;
     #515#8  = #524#6;
     #515#9  = #524#7;
     #515#10 = "TELEFONO PRINCIPAL";
     #515#11 = #524#9;
     #515#12 = "MOVIL";
     #515#13 = #524#56;
     #515#14 = "FAX";
     #515#15 = #524#10;
     #515#20 = #524#57;

     |VENTANA 0501, 2799, -1, 16, "Libreta de direcciones";
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PINPA #0#515;
     |PINDA #0#515;
     |ENDATOS #1#515;
     |SI FSalida = 0;
         |GRABA 020#515a;
     |SINO;
         |BORRA 020#515a;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO Tipo6C8Fxm24;  |TIPO 6;
     |SI FSalida = 10;
         enCalcCif = 1;
         eaVarDni  =  #524Campo;
         |HAZ CalculoDNI;
         #524Campo = eaVarDni;
         |PINTA #524Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #524Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 112;
     |SI #524Campo ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #524Campo = eaVarDni;  |PINTA #524Campo;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0C4Fxm24;
     nContenido = Contenido;
     |SI #524#4 = nContenido;  |ACABA;  |FINSI;

     |ABRE #520;
     #520#0 = #524#4;
     |LEE 000#520=;
     |SI FSalida ! 0;  |DDEFECTO #520;  |FINSI;
     |CIERRA #520;

     #524#7 = #520#1;  |PINTA #524#7;
|FPRC;

|PROCESO Tipo0C5Fxm24;
     nContenido = Contenido;
     |SI #524#5 = nContenido;  |ACABA;  |FINSI;

     |ABRE #521;
     #521#0 = #524#4;
     #521#1 = #524#5;
     |LEE 000#521=;
     |SI FSalida ! 0;  |DDEFECTO #521;  |FINSI;
     |CIERRA #521;

     #524#6 = #521#3;  |PINTA #524#6;
|FPRC;

|PROCESO Tipo7C2Fxm24;  |TIPO 7;
     aAlfa = #524#2;  |QBF aAlfa;
     |SI aAlfa = "";
         #524#2 = #524#1;  |PINTA #524#2;
     |FINSI;
|FPRC;

|PROCESO Tipo80Fxm24;  |TIPO 80;
     FSalida = 2799;
     |HAZ DesactivaTipo80;
|FPRC;
