|FICHEROS;
     dsam0108 #0;
     dsaw0017 #1;
|FIN;

|VARIABLES;
     aFichero = "";
     aAlfa1   = "";
     aDBase   = "";

     nSwDes   = 0;
     nCampo   = 0;
     nBufMen  = 0;
     nBufUsr  = 0;
     nEleUsr  = 0;
|FIN;

|PROCESO CargaUsr;  |TIPO 88;
     aFichero = ("16" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #1 aFichero;
     |ABRE #1; |CIERRA #1; |DELINDEX #1;

     |ABRE #1;
     |DIMENSIONA 1000, nBufMen, 0;
     aDBase = "";
     |DIRECTORIO aDBase;
     aAlfa1 = aDBase + "dev/usr/ds_sys.psw"
     |LEESECUENCIAL aAlfa1, nBufUsr, nEleUsr, 0, 0;
     |PARA nCampo = 0; |SI nCampo < nEleUsr; |HACIENDO nCampo = nCampo + 1;
           |DEL_BUF nBufUsr, nCampo, aAlfa1;
           |DDEFECTO #1;
           #1#0 = aAlfa1 % 103;             || nro.opcion
           #1#1 = aAlfa1 % 410;             || nombre
           |GRABA 020#1n;
      |SIGUE;
      |CIERRA #1;
      |FINDIM nBufMen;
|FPRC;

|PROCESO MiraUsr; |TIPO 7;
     |SI #0#0 = "          "; |ACABA; |FINSI;

     nSwDes = 0;
     |SI aFichero = ""; |HAZ CargaUsr;  nSwDes = 1;  |FINSI;

     |ABRE #1;
     |SELECT #2#1;
     #1#1 = #0#0;
     |LEE 040#1=;
     |SI FSalida ! 0;
         |MENAV "      No Existe el codigo en el Registro de Usuarios";
         |PTEC 807;
     |FINSI;
     #0#2 = #1#0;  |PINTA #0#2;

     |CIERRA #1;

     |SI nSwDes = 1; |HAZ DescargaUsr;  |FINSI;
|FPRC;

|PROCESO GrabaUsr;
     #0#0 = #1#1;
     |LIBERA #0;
     |LEE 140#0=;
     |SI FSalida ! 0;
         |CDEFECTO #0, 1;
         #0#1 = "";
         #0#2 = #1#0;
         |GRABA 140#0n;
     |SINO;
         #0#2 = #1#0;
         |GRABA 140#0a;
     |FINSI;
|FPRC;

|DEFBUCLE dsaw0017;
     #1#1;
     ;
     000;
     999;
     ;
     NULL, GrabaUsr;
|FIN;

|PROCESO CogeUsr; |TIPO 0;
     |SI FSalida ! 9; |ACABA; |FINSI;

     |BUCLE dsaw0017;
|FPRC;

|PROCESO DescargaUsr; |TIPO 9;
     |ABRE #1; |CIERRA #1; |DELINDEX #1;
|FPRC;
