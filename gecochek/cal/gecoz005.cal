|FICHEROS;
     gecom011 #11;
     gecom014 #14;

     :/dsoporte/def/dsprem03 #103;
     :/dsoporte/def/dsprem04 #104;
|FIN;

|VARIABLES;
     nGrupo        = 0;

     aDateSistema  = "";
     aDateUsuario  = "";
     aBase         = "";
     aPathDSoporte = "";
     aHora         = "";
     aAlfa         = "";
     aGrupo        = "";

     fFecha        = @;
|FIN;

|PROCESO dsprem04;
     |BORRA 020#104a;
|FPRC;

|DEFBUCLE dsprem04;
     #104#1;
     ;
     #103#0, #103#1, #103#2, #103#3, #103#4, "          ";
     #103#0, #103#1, #103#2, #103#3, #103#4, "zzzzzzzzzz";
     be;
     NULL, dsprem04;
|FIN;

|PROCESO dsprem03;
     |BUCLE dsprem04;
|FPRC;

|DEFBUCLE dsprem03;
     #103#1;
     ;
     nGrupo, 01, 01, 01, 01;
     nGrupo, 99, 99, 99, 99;
     be;
     NULL, dsprem03;
|FIN;

|PROCESO gecom014;
     aDateUsuario = (#14#7  % -104) + (#14#7  % 402) + (#14#7  % 102) + (("00" + #14#8) % -102) + (("00" + #14#9) % -102);
     |SI aDateSistema > aDateUsuario;  |ACABA;  |FINSI;

     #11#0  = #14#0;
     |LEE 000#11=;
     |SI FSalida ! 0;  |DDEFECTO #11;  |FINSI;

     #104#0 = nGrupo;
     #104#1 = #11#1;
     #104#2 = #14#14;
     #104#3 = #14#10;
     #104#4 = #14#11;
     #104#5 = #14#1;
     |LEE 101#104=;
     |SI FSalida ! 0;
         |DDEFECTO #104;
         #104#0  = nGrupo;
         #104#1  = #11#1;
         #104#2  = #14#14;
         #104#3  = #14#10;
         #104#4  = #14#11;
         #104#5  = #14#1;
         #104#9  = "N";
         #104#10 = "N";
         |GRABA 020#104b;
     |FINSI;
     #104#6  = #14#2;
     #104#7  = #14#3;
     #104#11 = #14#4;
     #104#12 = #14#5;
     #104#15 = #14#6;
     #104#18 = #14#15;
     |GRABA 020#104a;
     |LIBERA #104;
|FPRC;

|DEFBUCLE gecom014;
     #14#1;
     ;
     00001, 01, "          ";
     99999, 99, "zzzzzzzzzz";
     ;
     NULL, gecom014;
|FIN;

|PROCESO CargaUsuarios;
     |BUCLE dsprem03;

     |ABRE #104;
     |ABRE #11;
     |BUCLE gecom014;
     |CIERRA #104;
     |CIERRA #11;
|FPRC;

|PROGRAMA;
     |DBASS aBase;  |QBF aBase;
     aGrupo  = aBase % -201;
     nGrupo  = aGrupo;
     |SI nGrupo = 0;
         nGrupo = 1;
     |FINSI;

     aPathDSoporte = aBase + "dsoporte/fich/";

     |PATH_DAT #103 aPathDSoporte;
     |PATH_DAT #104 aPathDSoporte;

     fFecha = ~;
     |HORA aHora;

     aDateSistema = (fFecha % -104) + (fFecha % 402) + (fFecha % 102) + (aHora % 102) + (aHora % 402);

     |HAZ CargaUsuarios;

     |SUB_EJECUTA ":dsoporte/dsprez01;AUTO";
|FPRO;
