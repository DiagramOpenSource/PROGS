|FICHEROS;
     gecom002 #2;
     gecom003 #3;
     gecom004 #4,MANTE;
     gecom009 #9,MANTE;

     :/dscomer9/def/agifa041 #900;
|FIN;

|VARIABLES;
     aPath     = "";
     aAlfa1    = "";
     aAlfa2    = "";

     nModo     = 0;
|FIN;

|PROCESO Baja3;
     #3#0 = 00001;
|FPRC;

|PROCESO Alta3;
     #3#0 = 99999;
|FPRC;

|PROCESO Baja4;
     #4#0 = #3#0;
     #4#1 = 00001;
|FPRC;

|PROCESO Alta4;
     #4#0 = #3#0;
     #4#1 = 99999;
|FPRC;

|PROCESO Baja9;
     #9#0 = #3#0;
     #9#1 = #4#1;
     #9#2 = 001;
|FPRC;

|PROCESO Alta9;
     #9#0 = #3#0;
     #9#1 = #4#1;
     #9#2 = 999;
|FPRC;

|PROCESO gecom009B;
     |BORRA 020#9a;
     |LIBERA #9;
|FPRC;

|DEFBUCLE gecom009B;
     #9#1;
     ;
     #4#0, #4#1, 000;
     #4#0, #4#1, 999;
     be;
     NULL, gecom009B;
|FIN;

|PROCESO gecom004B;
     |BUCLE gecom009B;

     |BORRA 020#4a;
     |LIBERA #4;
|FPRC;

|DEFBUCLE gecom004B;
     #4#1;
     ;
     #3#0, 00000;
     #3#0, 99999;
     be;
     NULL, gecom004B;
|FIN;

|| -----------------------------------------------------------------------
|| Procesos del gecom009
|| -----------------------------------------------------------------------

|PROCESO Tipo7C3m9; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 2;
          |MENAV "0000Opcion no permitida.";
          |PTEC 807;
     |FINSI;

     |C_M #9#4, 1, "S";
     |SI #2#2 ! "S";
         |C_M #9#4, 1, "N";
         #9#4 = 1;
         |PINTA #9#4;
     |FINSI;
|FPRC;

|PROCESO Tipo7C2m9; |TIPO 7;
     |ABRE #2;
     #2#0 = #9#2;
     |LEE 000#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     |ATRI I;
     aAlfa1 = #2#1 % 130;
     aAlfa2 = #2#1 % 3130;
     |PINTA 0950, aAlfa1;
     |PINTA 1050, aAlfa2;
     |ATRI i;
|FPRC;

|| -----------------------------------------------------------------------
|| Procesos del gecom004
|| -----------------------------------------------------------------------

|PROCESO Tipo7C2m4;  |TIPO 7;
     |ENTLINEAL #1#9, -3, 7, 22, 0, Baja9, Alta9;

     |ABRE #900;
     #900#0 = #4#1;
     |LEE 000#900=;
     |SI FSalida ! 0;  |DDEFECTO #900;  |FINSI;
     |CIERRA #900;

     #4#2 = #900#1;
     |PINTA #4#2;
|FPRC;

|PROCESO Tipo7C1m4;  |TIPO 7;
     |ENTLINEAL #1#9, -3, 7, 22, 0, Baja9, Alta9;
|FPRC;

|PROCESO gecom002;
     #9#0 = #4#0;
     #9#1 = #4#1;
     #9#2 = #2#0;
     |LEE 101#9=;
     |SI FSalida ! 0;
         |DDEFECTO #9;
         #9#0 = #4#0;
         #9#1 = #4#1;
         #9#2 = #2#0;
         #9#3 = #2#3;
         #9#4 = #2#4;
         |GRABA 020#9n;
     |FINSI;
     |LIBERA #9;
|FPRC;

|DEFBUCLE gecom002;
     #2#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, gecom002;
|FIN;

|PROCESO Tipo3m4;  |TIPO 3;
     |ABRE #9;
     |BUCLE gecom002;
     |CIERRA #9;

     |ENTLINEAL #1#9, -3, 2, 22, 0, Baja9, Alta9;
|FPRC;

|PROCESO Tipo2m4;  |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 3;  |ACABA;  |FINSI;

     |BUCLE gecom009B;
|FPRC;

|| -----------------------------------------------------------------------
|| Procesos del gecom003
|| -----------------------------------------------------------------------

|PROCESO Tipo7C0m3;  |TIPO 7;
     |ABRE #4;
     #4#0 = #3#0;
     #4#1 = 1;
     |LEE 000#4];
     |SI FSalida ! 0;  |O #4#0 ! #3#0;
         #4#1 = 1;
     |FINSI;
     |CIERRA #4;

     |ENTLINEAL #1#9, -3, 7, 22, 0, Baja9, Alta9;
     |ENTLINEAL #1#4, -2, 7, 22, 0, Baja4, Alta4;
|FPRC;

|PROCESO Tipo3m3;  |TIPO 3;
     |ENTLINEAL #1#4, -2, 2, 22, 0, Baja4, Alta4;
|FPRC;

|PROCESO Tipo2m3;  |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 3;  |ACABA;  |FINSI;

     |BUCLE gecom004B;
|FPRC;

|PROGRAMA;
     |DBASS aPath;  |QBF aPath;
     aPath = aPath + "dscomer9/fich/";
     |PATH_DAT #900 aPath;

     |CLS;
     |CABEZA "Comprobaciones";
     |ENTLINEAL #1#3, -1, 2, 10, 1, Baja3, Alta3;
|FPRO;
