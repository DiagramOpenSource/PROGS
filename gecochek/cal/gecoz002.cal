|FICHEROS;
     gecoz002 #0;
     empresa@ #1;
|FIN;

|VARIABLES;
     aPathDes = "";
     aParam = "";
     aFic = "";
     aDat = "";
     aBase = "";
     aEmp = "";
     aDef = "";
     aAlfa = "";
     aFecha = "";
     fFecha = @;
     aDes = "";
     aOrg = "";
|FIN;

|PROCESO ElGz;
     aAlfa = aFic + " .";
     |FBORRA aFic;       ||Por si existe
     |ATAR aAlfa, aOrg;  ||Crea el tar
     |COMPRIME aFic;     ||Pasa a tgz
     |FBORRA aFic;       ||Borra el tgz
|FPRC;

|PROCESO dstem000;
     aEmp = ("00000" + #1#0) % -105;

     |DFICE aPathDes;
     aFic = aPathDes + "dstesor" + aEmp + aFecha + ".tar";
     aOrg = aBase + "dstesor/fich/" + aEmp + "/";

     |HAZ ElGz;
|FPRC;

|PROCESO dscam000;
     aEmp = ("00000" + #1#0) % -105;

     |DFICE aPathDes;
     aFic = aPathDes + "dscarter" + aEmp + aFecha + ".tar";
     aOrg = aBase + "dscarter/fich/" + aEmp + "/";

     |HAZ ElGz;
|FPRC;

|PROCESO canempre;
     aEmp = (("00000" + #1#2) % -105) + #1#3;

     |DFICE aPathDes;
     aFic = aPathDes + "contagen" + aEmp + aFecha + ".tar";
     aOrg = aBase + "contagen/fich/" + aEmp + "/";

     |HAZ ElGz;
|FPRC;

|PROCESO agifa041;
     aEmp = ("00000" + #1#0) % -105;

     |DFICE aPathDes;
     aFic = aPathDes + "dscomer9" + aEmp + aFecha + ".tar";
     aOrg = aBase + "dscomer9/fich/" + aEmp + "/";

     |HAZ ElGz;
|FPRC;

|DEFBUCLE dstem000;
     #1#1001;
     ;
     00001;
     99999;
     ;
     NULL, dstem000;
|FIN;

|DEFBUCLE dscam000;
     #1#1001;
     ;
     0001;
     9999;
     ;
     NULL, dscam000;
|FIN;

|DEFBUCLE canempre;
     #1#1002;
     ;
     00001, 0;
     99999, 9;
     ;
     NULL, canempre;
|FIN;

|DEFBUCLE agifa041;
     #1#1001;
     ;
     00001;
     99999;
     ;
     NULL, agifa041;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |SI #0#0 ! "SI"; |ACABA; |FINSI;

     |DBASS aBase;

     aDat = aBase + "dscomer9/fich/";
     aDef = aBase + "dscomer9/def/agifa041";
     |CARGA_DEF aDef, empresa@;
     |SI FSalida ! 0;
          |SI aParam = ""; |MENAV "0000Error al cargar 'agifa041'"; |FINSI;
     |SINO;
          |PATH_DAT #1 aDat;
          |BUCLE agifa041;
          |DESCARGA_DEF #empresa@;
     |FINSI;

     aDat = aBase + "contagen/fich/";
     aDef = aBase + "contagen/def/canempre";
     |CARGA_DEF aDef, empresa@;
     |SI FSalida ! 0;
          |SI aParam = ""; |MENAV "0000Error al cargar 'canempre'"; |FINSI;
     |SINO;
          |PATH_DAT #1 aDat;
          |BUCLE canempre;
          |DESCARGA_DEF #empresa@;
     |FINSI;

     aDat = aBase + "dscarter/fich/";
     aDef = aBase + "dscarter/def/dscam000";
     |CARGA_DEF aDef, empresa@;
     |SI FSalida ! 0;
          |SI aParam = ""; |MENAV "0000Error al cargar 'dscam000'"; |FINSI;
     |SINO;
          |PATH_DAT #1 aDat;
          |BUCLE dscam000;
          |DESCARGA_DEF #empresa@;
     |FINSI;

     aDat = aBase + "dstesor/fich/";
     aDef = aBase + "dstesor/def/dstem000";
     |CARGA_DEF aDef, empresa@;
     |SI FSalida ! 0;
          |SI aParam = ""; |MENAV "0000Error al cargar 'dstem000'"; |FINSI;
     |SINO;
          |PATH_DAT #1 aDat;
          |BUCLE dstem000;
          |DESCARGA_DEF #empresa@;
     |FINSI;
|FPRC;

|PROGRAMA;
     aParam = PARAMETRO;
     fFecha = ~;
     aFecha = fFecha;
     aFecha = (aFecha % 102) +  (aFecha % 402) + (aFecha % -104);

     |SI aParam = "";
          |MANTE #0;
     |SINO;
          #0#0 = "SI";
          |HAZ Tipo3;
     |FINSI;
|FPRO;
