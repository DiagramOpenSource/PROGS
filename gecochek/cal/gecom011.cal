|FICHEROS;
     gecom001 #1;
     gecom003 #3;
     gecom004 #4;
     gecom009 #9;
     gecom010 #10;
     gecom011 #11;
     gecom012 #12;
     gecom013 #13;
     gecom014 #14;
     gecom018 #18;

     gecow007 #907;

     :/dsoporte/def/dsprem01 #101;
     :/dsoporte/def/dsprem02 #102;
     :/dsoporte/def/dsprem03 #103;
     :/dsoporte/def/dsprem04 #104;
     :/dsoporte/def/dsprem05 #105;
     :/dsoporte/def/dsprem06 #106;
     :/dsoporte/def/dsprem07 #107;
     :/dsoporte/def/dsprem08 #108;
     :/dsoporte/def/dsprem99 #99;
     :/dsoporte/def/dsorm001 #201;

     referen1@ #900;
     referen2@ #901;
     EmprCont@ #902;
|FIN;

|VARIABLES;
     aEsc1          = "";
     aEsc2          = "";
     aRetu          = "";
     aTecla         = "";
     aTeclaSub      = "";
     aBase          = "";
     aPathDSoporte  = "";
     aAlfa          = "";
     aAlfa1         = "";
     aUsuario       = "";
     aOperacion     = "";
     aSitAnt        = "";
     aSitAct        = "";
     aHora          = "";
     aGrupo         = "";
     aMas           = "";
     aFic           = "";
     aFich          = "";
     aEjercicio     = "";
     aOrigen        = "";
     aDestino       = "";
     aDOperacion    = "";
     aDirec         = "";
     aDateUsuario   = "";
     aDateSistema   = "";
     aAbre          = "";
     aCadena        = "";
     aCaracter      = "";
     aLong          = "";
     aCod           = "";
     aCodCli        = "";

     nReg           = 0;
     nSitAnt        = 0;
     nSitAct        = 0;
     nCampoD        = 0;
     nCampoH        = 0;
     nPanta0        = 0;
     nPanta1        = 0;
     nPanta2        = 0;
     nVentana       = 0;
     nTipoDoc       = 0;
     nCodDoc        = 0;
     nCod           = 0;
     nGrupo         = 0;
     nCampo         = 0;
     nNume          = 0;
     nEmpresa       = 0;
     nPregunta      = 0;
     nPregunta1     = 0;
     nPregunta2     = 0;
     nPregunta3     = 0;
     nPregunta4     = 0;
     nPregunta5     = 0;
     nPregunta6     = 0;
     nPregunta7     = 0;
     nEstoy         = 0;
     nBorrar        = 0;
     nHandle        = 0;
     nLong          = 0;
     nCaracter      = 0;
     nPos           = 0;
     nFoco1         = 0;
     nFoco2         = 0;
     nConta         = 0;
     nAnyo          = 0;
     nPeriodo       = 0;

     nBoton0_1      = 0;
     nBoton0_2      = 0;
     nBoton0_3      = 0;
     nBoton0_4      = 0;
     nBoton1_1      = 0;
     nBoton1_2      = 0;
     nBoton2_1      = 0;
     nBoton2_2      = 0;
     nBoton2_3      = 0;
     nBoton2_4      = 0;
     nBoton2_5      = -1;

     nGrid1         = 0;
     nGrid2         = 0;

     nDTipoPanta1    = 0;
     nHTipoPanta1    = 0;
     nDTipoPanta2    = 0;
     nHTipoPanta2    = 0;
     nRango          = 0;
     nPos1           = 0;
     nPos2           = 0;

     fFecha         = @;

     &enCliente     = 0;
     &eaNomClie     = "";
     &enEstado      = 0;
     &enModo        = 0;
     &enDocumento   = 0;
     &enError       = 0;

     &enEmpresa     = 0;
     &enPeriodo     = 0;
     &any_pos       = 0;
     &swOperacion   = 0;
     &eaExterno     = "";
     &enEmpreOri    = 0;
     &enPerioOri    = 0;
     &eaCopiar      = "";
     &eaCeros       = "";
     &eaOtras       = "";
     &eaEmpresa     = "";
     &eaMoneda      = "";
     &fich_alta     = "";
     &enImportados  = 0;
     &enInstalar    = 0;

     &eaApli        = "";
     &eaEmpPat      = "";
     &eaEmpDes      = "";
     &enHay         = 0;
|FIN;

|PROCESO BajaPanta1;
     #11#0  = 00001;
     #11#1  = nDTipoPanta1;
|FPRC;

|PROCESO AltaPanta1;
     #11#0  = 99999;
     #11#1  = nHTipoPanta1;
|FPRC;

|PROCESO BajaPanta2;
     #11#0  = 00001;
     #11#1  = nDTipoPanta2;
|FPRC;

|PROCESO AltaPanta2;
     #11#0  = 99999;
     #11#1  = nHTipoPanta2;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 0_1
|| ------------------------------------------------------

|PROCESO gecom010;
     #11#0 = #10#0;
     |LEE 101#11=;
     |SI FSalida ! 0;
         |DDEFECTO #11;
         #11#0  = #10#0;
         #11#1  = 0;
         #11#18 = "S";
         |GRABA 020#11b;
     |FINSI;

     |SI #11#18 = "N";
         aAlfa = "0000 De la importacion viene codigo " + #11#0;
         aAlfa = aAlfa + " que esta dado de alta manual por la aplicacion. Revisen datos.";
         |MENAV aAlfa;

         |LIBERA #11;
         |ACABA;
     |FINSI;

     |PARA nCampoD = 1;  |SI nCampoD [ 16;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 1;
           #11nCampoH = #10nCampoD;
     |SIGUE;

     #11#18 = "S";

     |GRABA 020#11a;
     |LIBERA #11;
|FPRC;

|DEFBUCLE gecom010;
     #10#1;
     ;
     00001;
     99999;
     ;
     NULL, gecom010;
|FIN;

|PROCESO Boton0_1;
     |SI nEstoy = 1;
         |BORRA_HIJOS_PAN #1#11;
         |SUB_PINPA #0#907, nPanta1;
     |FINSI;

     |SI nEstoy = 2;
         |BORRA_HIJOS_PAN #2#11;
         |SUB_PINPA #0#907, nPanta2;
     |FINSI;

     |SELECT #1#11;
     |BUCLE gecom010;
     |SELECT #2#11;

     |SI nEstoy = 1;
         |BORRA_HIJOS_PAN #1#11;
     |FINSI;

     |SI nEstoy = 2;
         |BORRA_HIJOS_PAN #2#11;
     |FINSI;

     |REFRESCACONTROL nGrid1;
     |REFRESCACONTROL nGrid2;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 0_2
|| ------------------------------------------------------

|PROCESO Boton0_2;
     |VENTANA 0501, 2799, -1, -1, "";
     nVentana = FSalida;

     enModo    = 1;
     enEstado  = 0;
     enCliente = 0;
     |SUB_EJECUTA_NP "gecow002";

     |FINVENTANA nVentana;

     |SI enCliente ! 0;
         #11#0 = enCliente;
         #11#1 = 0;
         |LEE 000#11=;

         |REFRESCACONTROL nGrid1;
         |REFRESCACONTROL nGrid2;
     |FINSI;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 0_3
|| ------------------------------------------------------

|PROCESO canempreA;
     #900#1  = #11#2;
     #900#4  = #11#2;

     aAlfa   = #11#4;  |QBF aAlfa;
     aAlfa   = aAlfa + " " + #11#5;  |QBF aAlfa;
     aAlfa   = aAlfa + " " + #11#6;  |QBF aAlfa;
     #900#5  = aAlfa;

     aAlfa   = (("00" + #11#10) % -102) + (("000" + #11#11) % -103);
     #900#6  = aAlfa;
     #900#7  = #11#12;
     #900#8  = #11#3;
     #900#9  = #11#15;

     aAlfa   =  "[" + (("00000" + #900#2) % -105) + "/" + nNume + "] " + #900#1;
     #900#29 = aAlfa;
     |GRABA 020#900a;
     |LIBERA #900;
|FPRC;

|DEFBUCLE canempreA;
     #900#1002;
     ;
     nCod, 0;
     nCod, 9;
     be;
     NULL, canempreA;
|FIN;

|PROCESO Canempre;
     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "contagen/def/canempre.mas";
     aFic = aBase + "contagen/fich/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PATH_DAT #900 aFic;

     nCod = aCod;
     |BUCLE canempreA;

     |DESCARGA_DEF #referen1@;
|FPRC;

|PROCESO Boton0_3;
     |VENTANA 0501, 2799, -1, -1, "";
     nVentana = FSalida;

     enModo    = 2;
     enCliente = #11#0;
     enEstado  = #11#1;
     |SUB_EJECUTA_NP "gecow002";

     #11#0 = enCliente;
     #11#1 = enEstado;
     |LEE 000#11=;

     |SI #11#1 ! 0;  |Y #11#19 = "N";
         aCod   = nGrupo + (("00"  + #11#1) % -102) + "01";
         |HAZ Canempre;
         |HAZ Agifa041;
         |HAZ Dscam000;
         |HAZ Dstem000;
         |HAZ Visalm00;
         |HAZ AltaClientePI;
         |HAZ AltaClienteBasica;
     |FINSI;

     |FINVENTANA nVentana;

     |REFRESCACONTROL nGrid1;
     |REFRESCACONTROL nGrid2;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 0_4
|| ------------------------------------------------------

|PROCESO Boton0_4;
     |LEE 101#11=;
     |SI FSalida = 0;
         aAlfa = "0000NSeguro de dar de baja a " + #11#2;
         |CONFI aAlfa;
         |SI FSalida = 0;
             |BORRA 020#11a;

             |ABRE #10;
             #10#0 = #11#0;
             |LEE 101#10=;
             |SI FSalida = 0;
                 |BORRA 020#10a;
                 |LIBERA #10;
             |FINSI;
             |CIERRA #10;

             |REFRESCACONTROL nGrid1;
         |FINSI;
         |LIBERA #11;
     |FINSI;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 1_1
|| ------------------------------------------------------

|PROCESO AltaContabilidad;
     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "contagen/def/canempre.mas";
     aFic = aBase + "contagen/fich/";

     |CARGA_DEF aMas, referen1@;
     |CARGA_DEF aMas, referen2@;

     |PATH_DAT #900 aFic;
     |PATH_DAT #901 aFic;

     |ABRE #900;
     |ABRE #901;

     aAlfa  = "99999";
     #901#2 = aAlfa;
     #901#3 = 9;

     |LEE 000#901=;
     |SI FSalida = 0;
         |PARA nCampo = 0;  |SI nCampo [ 29;  |HACIENDO nCampo = nCampo + 1;
               #900nCampo = #901nCampo;
         |SIGUE;

         #900#2  = #102#12;
         #900#3  = aEjercicio;
         aAlfa1  = (("00000" + #900#2) % -105) + #900#3;
         #900#0  = aAlfa1;
         #900#1  = #11#2;
         #900#4  = #11#2;

         aAlfa   = #11#4;  |QBF aAlfa;
         aAlfa   = aAlfa + " " + #11#5;  |QBF aAlfa;
         aAlfa   = aAlfa + " " + #11#6;  |QBF aAlfa;
         #900#5  = aAlfa;

         aAlfa   = (("00" + #11#10) % -102) + (("000" + #11#11) % -103);
         #900#6  = aAlfa;
         #900#7  = #11#12;
         #900#8  = #11#3;
         #900#9  = #11#15;
         #900#11 = "";
         #900#22 = "O";
         #900#26 = aEjercicio;
         #900#28 = "E";

         |SI #900#26 ] 80;
             nNume = 1900 + #900#26;
         |SINO;
             nNume = 2000 + #900#26;
         |FINSI;
         aAlfa   =  "[" + (("00000" + #900#2) % -105) + "/" + nNume + "] " + #900#1;
         #900#29 = aAlfa;
         |GRABA 020#900n;
         |LIBERA #900;
         |CIERRA #900;

         aAlfa = aBase + "contagen/fich/" + (("000000" + #900#0) % -106);
         |MKDIR aAlfa;

         enEmpresa   = #900#2;
         enPeriodo   = #900#3;
         eaMoneda    = #900#28;
         swOperacion = 3;
         |SUB_EJECUTA_NP ":contagen/camoneda";
         swOperacion = 0;

         fich_alta  = aAlfa + "/";
         any_pos    = #900#26;
         eaExterno  = fich_alta;
         enEmpreOri = #901#2;
         enPerioOri = #901#3;
         eaCopiar   = "T";
         eaCeros    = "S";
         eaOtras    = "N";
         |SUB_EJECUTA_NP ":contagen/cacrebal";
     |SINO;
         aAlfa1 = "0000Empresa [" + #901#2 + "." + #901#3 + "] inaccesible.";
         |MENAV aAlfa1;
     |FINSI;

     |DESCARGA_DEF #referen2@;
     |DESCARGA_DEF #referen1@;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "contagen/def/camandep.mas";
     aFic = aBase + "contagen/fich/000000/";

     |CARGA_DEF aMas, referen1@;
     |PATH_DAT #900 aFic;

     |ABRE #900;
     #900#0 = #102#12;
     #900#1 = #102#13;
     |LEE 101#900=;
     |SI FSalida ! 0;
         |DDEFECTO #900;
         #900#0 = #102#12;
         #900#1 = #102#13;
         aAlfa  = #102#10;  |QBF aAlfa;
         |SI aAlfa = "";  aAlfa = #108#2;  |FINSI;
         #900#2 = aAlfa;
         |GRABA 020#900n;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #referen1@;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "contagen/def/camansde.mas";
     aFic = aBase + "contagen/fich/000000/";

     |CARGA_DEF aMas, referen1@;
     |PATH_DAT #900 aFic;

     |ABRE #900;
     #900#0 = #102#12;
     #900#1 = #102#13;
     #900#2 = #102#14;
     |LEE 101#900=;
     |SI FSalida ! 0;
         |DDEFECTO #900;
         #900#0 = #102#12;
         #900#1 = #102#13;
         #900#2 = #102#14;

         aAlfa  = #102#10;  |QBF aAlfa;
         |SI aAlfa = "";  aAlfa = #108#2;  |FINSI;
         #900#3 = aAlfa;

         aAlfa  = #102#11;  |QBF aAlfa;
         |SI aAlfa = "";  aAlfa = #11#2;  |FINSI;
         |GRABA 020#900n;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #referen1@;
|FPRC;

|PROCESO DefAsiento;
     aAlfa  = aBase + "contagen/";
     #900#6 = aAlfa;
     #900#4 = #102#12;
     #900#5 = aEjercicio;

     |GRABA 020#900a;
     |LIBERA #900;
|FPRC;

|DEFBUCLE DefAsiento;
     #900#1001;
     ;
     "    ";
     "zzzz";
     be;
     NULL, DefAsiento;
|FIN;

|PROCESO AstosSeries;
     aAlfa  = ("00000" + nEmpresa) % -105;
     #900#2 = aAlfa;
     #900#3 = nPeriodo;
     |GRABA 020#900a; |LIBERA #900;
|FPRC;

|DEFBUCLE AstosSeries;
     #900#1003;
     ;
     "     ", " ", " ";
     "zzzzz", "z", "z";
     be;
     NULL, AstosSeries;
|FIN;

|PROCESO AltaControlGestion;
     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscomer9/def/agifa142.mas";
     aFic = aBase + "dscomer9/fich/" + (("00000" + nEmpresa) % -105) + "/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

         |ABRE #900;
         |LEE 101#900p;
         |SI FSalida ! 0;
             |DDEFECTO #900;
             |GRABA 020#900b;
         |FINSI;
         aAlfa    = aBase + "contagen/";
         #900#151 = aAlfa;
         aAlfa    = (("00000" + #102#12) % -105) + aEjercicio;
         #900#152 = aAlfa;

         |GRABA 020#900a;
         |LIBERA #900;
         |CIERRA #900;

         |DESCARGA_DEF #referen1@;
     |FINSI;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscomer9/def/agifa141.mas";
     aFic = aBase + "dscomer9/fich/" + (("00000" + nEmpresa) % -105) + "/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

         |ABRE #900;
         |LEE 101#900p;
         |SI FSalida ! 0;
             |DDEFECTO #900;
             |GRABA 020#900b;
         |FINSI;
         aAlfa    = aBase + "contagen/";

         #900#11  = aAlfa;
         #900#0   = #102#12;
         #900#8   = aEjercicio;

         |GRABA 020#900a;
         |LIBERA #900;
         |CIERRA #900;

         |DESCARGA_DEF #referen1@;
     |FINSI;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscomer9/def/agifa704.mas";
     aFic = aBase + "dscomer9/fich/" + (("00000" + nEmpresa) % -105) + "/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

         |BUCLE DefAsiento;

         |DESCARGA_DEF #referen1@;
     |FINSI;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscomer9/def/malpe115.mas";
     aFic = aBase + "dscomer9/fich/" + (("00000" + nEmpresa) % -105) + "/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;
         nConta = 0;
         |DBASS aBase;  |QBF aBase;
         aMas = aBase + "agicont/def/canempre.mas";
         |XABRE "E", aMas, nHandle;
         |SI FSalida ] 0; nConta = 2; |FINSI;
         |XCIERRA nHandle;

         |DBASS aBase;  |QBF aBase;
         aMas = aBase + "contagen/def/canempre.mas";
         |XABRE "E", aMas, nHandle;
         |SI FSalida ] 0; nConta = 1; |FINSI;
         |XCIERRA nHandle;

         nPeriodo = 9;
         |SI nConta ! 0;
            |SI nConta = 1;
               |DBASS aBase;  |QBF aBase;
               aMas = aBase + "contagen/def/canempre.mas";
               || aFic = aBase + "contagen/fich/" + (("00000" + nEmpresa) % -105) + "/";
               aFic = aBase + "contagen/fich/";
            |SINO;
               |SI nConta = 2;
                  |DBASS aBase;  |QBF aBase;
                  aMas = aBase + "agicont/def/canempre.mas";
                  || aFic = aBase + "agicont/fich/" + (("00000" + nEmpresa) % -105) + "/";
                  aFic = aBase + "contagen/fich/";
               |FINSI;
            |FINSI;
            |CARGA_DEF aMas, EmprCont@;
            |SI FSalida = 0;
               fFecha = ~;
               aAlfa = fFecha % -102; nAnyo = aAlfa;
               |PATH_DAT #902 aFic;
               |ABRE #EmprCont@;
               #EmprCont@#2 = nEmpresa;
               #EmprCont@#3 = 0;
               |LEE 000#EmprCont@.];
               |PARA; |SI FSalida = 0; |Y #EmprCont@#2 = nEmpresa; |HACIENDO;
                   |SI #EmprCont@#26 = nAnyo;
                       nPeriodo = #EmprCont@#3;
                       |SAL;
                   |FINSI;
                   |LEE 000#EmprCont@.s;
               |SIGUE;
               |CIERRA #EmprCont@;
               |DESCARGA_DEF #EmprCont@;
            |FINSI;
         |FINSI;
         |BUCLE AstosSeries;

         |ABRE #900;
         #900#0  = nEmpresa;
         #900#9  = "+";
         #900#10 = "V";
         |LEE 000#900.=;
         |SI FSalida ! 0;
            #900#0  = "";
            #900#9  = "+";
            #900#10 = "V";
            |LEE 000#900.=;
            |SI FSalida ! 0;
               |DDEFECTO #900;
               #900#9  = "+";
               #900#10 = "V";
            |FINSI;
            #900#0  = nEmpresa;
            |GRABA 000#900n;
         |FINSI;

         |CIERRA #referen1@; |DESCARGA_DEF #referen1@;
     |FINSI;
|FPRC;

|PROCESO Agifa041;
     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscomer9/def/agifa041.mas";
     aFic = aBase + "dscomer9/fich/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PATH_DAT #900 aFic;

     |ABRE #900;
     #900#0  = aCod;
     |LEE 101#900=;
     |SI FSalida ! 0;
         |DDEFECTO #900;
         #900#0  = aCod;
         #900#8  = "~~~~~~~~~~";
         |GRABA 020#900b;
     |FINSI;

     #900#1  = #11#2;

     aAlfa   = #11#4;  |QBF aAlfa;
     aAlfa   = aAlfa + " " + #11#5;  |QBF aAlfa;
     aAlfa   = aAlfa + " " + #11#6;  |QBF aAlfa;
     #900#2  = aAlfa;

     aAlfa   = (("00" + #11#10) % -102) + (("000" + #11#11) % -103);
     aAlfa   = aAlfa + " " + #11#12;  |QBF aAlfa;
     #900#3  = aAlfa;

     #900#4  = #11#13;
     #900#5  = #11#3;
     #900#6  = #11#15;
     #900#7  = #11#16;
     #900#15 = #11#16;
     |GRABA 020#900a;
     |LIBERA #900;
     |CIERRA #900;

     |SI enModo = 2;
         |DESCARGA_DEF #referen1@;
     |FINSI;
|FPRC;

|PROCESO AltaGestion;
     enModo = 1;
     aCod   = #102#16;
     |HAZ Agifa041;

     aAlfa = aBase + "dscomer9/fich/" + (("00000" + #900#0) % -105); aFic = aAlfa + "/";
     |MKDIR aAlfa;

     eaApli   = "dscomer9";
     eaEmpPat = "99999";
     eaEmpDes = (("00000" + #900#0) % -105);
     enHay    = 0;
     |SUB_EJECUTA_NP ":dsoporte/dsorz013";

     |SI enHay = 0;
          |MENAV "0000 La empresa [99999-Patrones de la Gestion] inaccesible.";
     |FINSI;

     nEmpresa  = #900#0;
     eaEmpresa = ("00000" + #102#16) % -105;

     |DESCARGA_DEF #referen1@;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscomer9/def/agenm081.mas";
     |XABRE "E", aMas, nHandle;
     |SI FSalida ] 0;
         |CARGA_DEF aMas, referen1@;

         |PATH_DAT #900 aFic;

         |ABRE #900;
         |DDEFECTO #900;
         #900#0 = nGrupo + (("00" + #11#1) % -102) + "01";
         #900#1 = #11#2;
         aAlfa  = #11#4;  |QBF aAlfa;
         aAlfa  = aAlfa + " " + #11#5;  |QBF aAlfa;
         aAlfa  = aAlfa + " " + #11#6;  |QBF aAlfa;
         #900#2 = aAlfa;
         #900#3 = #11#12;
         #900#4 = #11#13;
         #900#5 = #11#3;
         #900#6 = #11#15;
         #900#7 = #11#16;
         #900#8 = #11#17;
         |GRABA 020#900n;
         |LIBERA #900;
         |CIERRA #900;

         |DESCARGA_DEF #referen1@;
     |FINSI;

     |SUB_EJECUTA_NP ":dscomer9/agifa041;PATRONES";

     |HAZ AltaControlGestion;
|FPRC;

|PROCESO AltaControlCartera;
     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscarter/def/dscam044.mas";
     aFic = aBase + "dscarter/fich/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

         |ABRE #900;
         #900#0 = #102#15;
         |LEE 101#900=;
         |SI FSalida ! 0;
             |DDEFECTO #900;
             #900#0 = #102#15;
             |GRABA 020#900b;
         |FINSI;
         aAlfa  = aBase + "dscomer9/";
         #900#1 = aAlfa;
         |GRABA 020#900a;
         |LIBERA #900;
         |CIERRA #900;

         |DESCARGA_DEF #referen1@;
     |FINSI;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscarter/def/dscam045.mas";
     aFic = aBase + "dscarter/fich/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

         |ABRE #900;
         #900#0 = #102#15;
         #900#1 = 1;
         |LEE 101#900=;
         |SI FSalida ! 0;
             #900#0 = #102#15;
             #900#1 = 1;
             #900#2 = "V";
             #900#3 = "VENTAS";
             #900#4 = "";
             #900#5 = "zzzzz";
             #900#6 = #102#15;
             |GRABA 020#900n;
         |SINO;
             #900#6 = #102#15;
             |GRABA 020#900a;
         |FINSI;
         |LIBERA #900;

         #900#0 = #102#15;
         #900#1 = 2;
         |LEE 101#900=;
         |SI FSalida ! 0;
             #900#0 = #102#15;
             #900#1 = 2;
             #900#2 = "C";
             #900#3 = "COMPRAS";
             #900#4 = "";
             #900#5 = "zzzzz";
             #900#6 = #102#15;
             |GRABA 020#900n;
         |SINO;
             #900#6 = #102#15;
             |GRABA 020#900a;
         |FINSI;
         |LIBERA #900;
         |CIERRA #900;

         |DESCARGA_DEF #referen1@;
     |FINSI;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscarter/def/dscam037.mas";
     aFic = aBase + "dscarter/fich/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

         |ABRE #900;
         #900#0 = #102#15;
         |LEE 101#900=;
         |SI FSalida ! 0;
             |DDEFECTO #900;
             #900#0 = #102#15;
             |GRABA 020#900b;
         |FINSI;
         aAlfa  = aBase + "dscomer9/";
         #900#2 = aAlfa;
         |GRABA 020#900a;
         |LIBERA #900;
         |CIERRA #900;

         |DESCARGA_DEF #referen1@;
     |FINSI;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscarter/def/dscam038.mas";
     aFic = aBase + "dscarter/fich/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

          |ABRE #900;

          #900#0 = #102#15;
          #900#1 = 1;
          |LEE 101#900=;
          |SI FSalida ! 0;
              #900#0 = #102#15;
              #900#1 = 1;
              #900#2 = "F";
              #900#7 = "Facturas";
              #900#3 = "";
              #900#4 = "zzzzz";
              #900#5 = #102#15;
              #900#6 = 01;
              #900#8 = "R";
              |GRABA 020#900n;
          |SINO;
              #900#5 = #102#15;
              |GRABA 020#900a;
          |FINSI;
          |LIBERA #900;

          #900#0 = #102#15;
          #900#1 = 2;
          |LEE 101#900=;
          |SI FSalida ! 0;
              #900#0 = #102#15;
              #900#1 = 2;
              #900#2 = "A";
              #900#7 = "Albaranes";
              #900#3 = "";
              #900#4 = "zzzzz";
              #900#5 = #102#15;
              #900#6 = 01;
              #900#8 = "R";
              |GRABA 020#900n;
          |SINO;
              #900#5 = #102#15;
              |GRABA 020#900a;
          |FINSI;
          |LIBERA #900;

          #900#0 = #102#15;
          #900#1 = 3;
          |LEE 101#900=;
          |SI FSalida ! 0;
              #900#0 = #102#15;
              #900#1 = 3;
              #900#2 = "P";
              #900#7 = "Pedido";
              #900#3 = "";
              #900#4 = "zzzzz";
              #900#5 = #102#15;
              #900#6 = 01;
              #900#8 = "R";
              |GRABA 020#900n;
          |SINO;
              #900#5 = #102#15;
              |GRABA 020#900a;
          |FINSI;
          |LIBERA #900;

          |DESCARGA_DEF #referen1@;
     |FINSI;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscarter/def/dscam042.mas";
     aFic = aBase + "dscarter/fich/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

         |ABRE #900;
         #900#0 = #102#12;
         #900#1 = aEjercicio;
         |LEE 101#900=;
         |SI FSalida ! 0;
             |DDEFECTO #900;
             #900#0 = #102#12;
             #900#1 = aEjercicio;
             |GRABA 020#900b;
         |FINSI;
         aAlfa  = aBase + "contagen/";
         #900#2 = aAlfa;
         |GRABA 020#900a;
         |LIBERA #900;
         |CIERRA #900;

         |DESCARGA_DEF #referen1@;
     |FINSI;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscarter/def/dscam043.mas";
     aFic = aBase + "dscarter/fich/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

         |ABRE #900;

         #900#0 = #102#12;
         #900#1 = aEjercicio;
         #900#2 = 1;
         |LEE 101#900=;
         |SI FSalida ! 0;
             #900#0 = #102#12;
             #900#1 = aEjercicio;
             #900#2 = 1;
             #900#3 = "V";
             #900#4 = "VENTAS";
             #900#5 = 0;
             #900#6 = 99;
             #900#7 = "";
             #900#8 = "zzzzz";
             #900#9 = #102#15;
             |GRABA 020#900n;
         |SINO;
             #900#9 = #102#15;
             |GRABA 020#900a;
         |FINSI;
         |LIBERA #900;

         #900#0 = #102#12;
         #900#1 = aEjercicio;
         #900#2 = 2;
         |LEE 101#900=;
         |SI FSalida ! 0;
             #900#0 = #102#12;
             #900#1 = aEjercicio;
             #900#2 = 2;
             #900#3 = "C";
             #900#4 = "COMPRAS";
             #900#5 = 0;
             #900#6 = 99;
             #900#7 = "";
             #900#8 = "zzzzz";
             #900#9 = #102#15;
             |GRABA 020#900n;
         |SINO;
             #900#9 = #102#15;
             |GRABA 020#900a;
         |FINSI;
         |LIBERA #900;

         |CIERRA #900;

         |DESCARGA_DEF #referen1@;
     |FINSI;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscarter/def/dscam030.mas";
     aFic = aBase + "dscarter/fich/" + (("00000" + #102#15) % -105) + "/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

         |BUCLE DefAsiento;

         |DESCARGA_DEF #referen1@;
     |FINSI;
|FPRC;

|PROCESO Dscam000;
     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscarter/def/dscam000.mas";
     aFic = aBase + "dscarter/fich/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PATH_DAT #900 aFic;

     |ABRE #900;
     #900#0  = aCod;
     |LEE 101#900=;
     |SI FSalida ! 0;
         |DDEFECTO #900;
         #900#0  = aCod;
         #900#14 = #102#12;
         #900#15 = #102#16;
         aAlfa   = aBase + "contagen/";
         #900#16 = aAlfa;
         aAlfa   = aBase + "dscomer9/";
         #900#17 = aAlfa;
         #900#18 = "~~~~~~~~~~";
         #900#19 = aEjercicio;
         |GRABA 020#900b;
     |FINSI;

     #900#1  = #11#2;
     #900#2  = #11#3;
     aAlfa   = #11#4;  |QBF aAlfa;
     aAlfa   = aAlfa + " " + #11#5;  |QBF aAlfa;
     #900#3  = aAlfa;
     #900#4  = #11#6;
     #900#5  = #11#7;
     #900#6  = #11#8;
     #900#7  = #11#9;
     #900#8  = #11#10;
     #900#9  = #11#11;
     #900#10 = #11#12;
     #900#11 = #11#13;
     #900#12 = #11#15;
     #900#13 = #11#16;
     |GRABA 020#900a;

     |LIBERA #900;
     |CIERRA #900;

     |SI enModo = 2;
         |DESCARGA_DEF #referen1@;
     |FINSI;
|FPRC;

|PROCESO AltaCartera;
     enModo = 1;
     aCod   = #102#15;
     |HAZ Dscam000;

     aAlfa = aBase + "dscarter/fich/" + (("00000" + #900#0) % -105);
     |MKDIR aAlfa;

     eaApli   = "dscarter";
     eaEmpPat = "99999";
     eaEmpDes = (("00000" + #900#0) % -105);
     |SUB_EJECUTA_NP ":dsoporte/dsorz013";

     |SI enHay = 0;
          |MENAV "0000 La empresa [99999-Patrones de Cartera ] inaccesible.";
     |FINSI;

     |DESCARGA_DEF #referen1@;

     |HAZ AltaControlCartera;
|FPRC;

|PROCESO Dstem000;
     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dstesor/def/dstem000.mas";
     aFic = aBase + "dstesor/fich/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PATH_DAT #900 aFic;

     |ABRE #900;
     #900#0  = aCod;
     |LEE 101#900=;
     |SI FSalida ! 0;
         |DDEFECTO #900;
         #900#0  = aCod;
         #900#2  = #102#12;
         #900#3  = aEjercicio;
         #900#4  = #102#16;
         #900#5  = "S";
         #900#6  = "~~~~~~~~~~";
         |GRABA 020#900b;
     |FINSI;

     #900#1  = #11#2;

     |GRABA 020#900a;
     |LIBERA #900;
     |CIERRA #900;

     |SI enModo = 2;
         |DESCARGA_DEF #referen1@;
     |FINSI;
|FPRC;

|PROCESO AltaTesoreria;
     enModo = 1;
     aCod   = #102#15;
     |HAZ Dstem000;

     aAlfa = aBase + "dstesor/fich/" + (("00000" + #900#0) % -105);
     |MKDIR aAlfa;

     eaApli   = "dstesor";
     eaEmpPat = "99999";
     eaEmpDes = (("00000" + #900#0) % -105);
     enHay    = 0;
     |SUB_EJECUTA_NP ":dsoporte/dsorz013";

     |SI enHay = 0;
          |MENAV "0000 La empresa [99999-Patrones de la Gestion de Tesoreria] inaccesible.";
     |FINSI;

     |DESCARGA_DEF #referen1@;
|FPRC;

|PROCESO Visalm00;
     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dspreven/def/visalm00.mas";
     aFic = aBase + "dspreven/fich/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PATH_DAT #900 aFic;

     |ABRE #900;
     #900#0  = aCod;
     |LEE 101#900=;
     |SI FSalida ! 0;
         |DDEFECTO #900;
         #900#0  = aCod;
         #900#2  = "~~~~~~~~~~";
         |GRABA 020#900b;
     |FINSI;
     #900#1  = #11#2;
     |GRABA 020#900a;
     |LIBERA #900;
     |CIERRA #900;

     |SI enModo = 2;
         |DESCARGA_DEF #referen1@;
     |FINSI;
|FPRC;

|PROCESO AltaPrevencion;
     enModo = 1;
     aCod   = #102#16;
     |HAZ Visalm00;

     aAlfa = aBase + "dspreven/fich/" + (("00000" + #900#0) % -105); aFic = aAlfa + "/";
     |MKDIR aAlfa;

     eaApli   = "dspreven";
     eaEmpPat = "99999";
     eaEmpDes = (("00000" + #900#0) % -105);
     enHay    = 0;
     |SUB_EJECUTA_NP ":dsoporte/dsorz013";

     |SI enHay = 0;
          |MENAV "0000 La empresa [99999-Patrones de la Prevencion] inaccesible.";
     |FINSI;

     nEmpresa  = #900#0;
     eaEmpresa = ("00000" + #102#16) % -105;

     |DESCARGA_DEF #referen1@;

     aMas = aBase + "dspreven/def/maesm001.mas";
     aFic = aBase + "dspreven/fich/";

     |CARGA_DEF aMas, referen1@;

     |PATH_DAT #900 aFic;

     |ABRE #900;
     |DDEFECTO #900;
     #900#0  = #102#16;
     |LEE 101#900=;
     |SI FSalida ! 0;
         |DDEFECTO #900;
         #900#0  = #102#16;
         |GRABA 020#900b;
     |FINSI;

     #900#1  = #101#1;
     #900#2  = #108#2;
     |GRABA 020#900a;
     |LIBERA #900;
     |CIERRA #900;

     |DESCARGA_DEF #referen1@;
|FPRC;

|PROCESO AltaClientePI;
     |SI enModo = 1;
         aCod = #102#16;
     |FINSI;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "integral/def/dsam0000.mas";
     aFic = aBase + "integral/fich/";
     |CARGA_DEF aMas, referen1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PATH_DAT #900 aFic;

     |ABRE #900;
     #900#0 = aCod;
     |LEE 101#900=;
     |SI FSalida ! 0;
         |DDEFECTO #900;
         #900#0 = aCod;
         |GRABA 020#900b;
     |FINSI;

     #900#1  = #11#2;
     #900#2  = #11#2;
     #900#3  = #11#3;
     #900#19 = #11#4;
     #900#20 = #11#5;
     #900#21 = #11#6;
     #900#22 = #11#7;
     #900#23 = #11#8;
     #900#24 = #11#9;
     #900#25 = #11#10;
     #900#26 = #11#11;
     #900#27 = #11#12;
     #900#28 = #11#13;
     #900#29 = #11#4;
     #900#30 = #11#5;
     #900#31 = #11#6;
     #900#32 = #11#7;
     #900#33 = #11#8;
     #900#34 = #11#9;
     #900#35 = #11#10;
     #900#36 = #11#11;
     #900#37 = #11#12;
     #900#38 = #11#13;
     #900#39 = #11#4;
     #900#40 = #11#5;
     #900#41 = #11#6;
     #900#42 = #11#7;
     #900#43 = #11#8;
     #900#44 = #11#9;
     #900#45 = #11#10;
     #900#46 = #11#11;
     #900#47 = #11#12;
     #900#48 = #11#13;
     #900#53 = #11#14;
     #900#54 = #11#15;
     #900#55 = #11#16;
     #900#71 = #11#17;

     |GRABA 020#900a;
     |LIBERA #900;
     |CIERRA #900;

     |DESCARGA_DEF #referen1@;

     |SUB_EJECUTA_NP ":integral/dsaz0003;AUTO";
|FPRC;

|PROCESO AltaClienteBasica;
     |SI enModo = 1;
         aCod = #102#16;
     |FINSI;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "basica/def/agifigen.mas";
     aFic = aBase + "basica/fich/";
     |CARGA_DEF aMas, referen1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PATH_DAT #900 aFic;

     |ABRE #900;
     #900#0 = aCod;
     |LEE 101#900=;
     |SI FSalida ! 0;
         |DDEFECTO #900;
         #900#0 = aCod;
         |GRABA 020#900b;
     |FINSI;

     #900#1  = #11#2;
     #900#2  = #11#2;
     #900#3  = #11#4;
     #900#4  = #11#5;
     #900#5  = #11#6;
     #900#6  = #11#7;
     #900#7  = #11#8;
     #900#8  = #11#9;
     #900#9  = #11#10;
     #900#10 = #11#11;
     #900#11 = #11#12;
     #900#12 = #11#13;
     #900#13 = #11#3;
     #900#41 = #11#4;
     #900#42 = #11#5;
     #900#43 = #11#6;
     #900#44 = #11#7;
     #900#45 = #11#8;
     #900#46 = #11#9;
     #900#47 = #11#10;
     #900#48 = #11#11;
     #900#49 = #11#12;
     #900#50 = #11#13;
     #900#51 = #11#4;
     #900#52 = #11#5;
     #900#53 = #11#6;
     #900#54 = #11#7;
     #900#55 = #11#8;
     #900#56 = #11#9;
     #900#57 = #11#10;
     #900#58 = #11#11;
     #900#59 = #11#12;
     #900#60 = #11#13;
     #900#14 = #11#15;
     #900#15 = #11#16;

     |GRABA 020#900a;
     |LIBERA #900;
     |CIERRA #900;

     |DESCARGA_DEF #referen1@;
|FPRC;

|PROCESO AltaLaboral;
     |DBASS aBase;  |QBF aBase;

     aAlfa = aBase + "laboral/fich/" + (("00000" + #102#20) % -105);
     |MKDIR aAlfa;

     aMas = aBase + "laboral/def/nomempre.mas";
     aFic = aBase + "laboral/fich/";
     |CARGA_DEF aMas, referen1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PATH_DAT #900 aFic;

     |ABRE #900;
     #900#0 = #102#20;
     |LEE 101#900=;
     |SI FSalida ! 0;
         |DDEFECTO #900;
         #900#0 = #102#20;
         #900#1 = #11#2;
         #900#2 = "~~~~~~~~~~";
         |GRABA 020#900b;
     |FINSI;

     |DESCARGA_DEF #referen1@;
|FPRC;

|PROCESO Crealos;
     |SI #11#19 = "S";  |ACABA;  |FINSI;

     enModo = 1;

     |SI nPregunta1 = 1;  |HAZ AltaContabilidad;   |FINSI;
     |SI nPregunta2 = 1;  |HAZ AltaGestion;        |FINSI;
     |SI nPregunta3 = 1;  |HAZ AltaCartera;        |FINSI;
     |SI nPregunta4 = 1;  |HAZ AltaTesoreria;      |FINSI;
     |SI nPregunta5 = 1;  |HAZ AltaPrevencion;     |FINSI;
     |SI nPregunta6 = 1;  |HAZ AltaClientePI;      |FINSI;
     |SI nPregunta6 = 2;  |HAZ AltaClienteBasica;  |FINSI;
     |SI nPregunta7 = 1;  |HAZ AltaLaboral;        |FINSI;
|FPRC;

|PROCESO CreaPaquetes;
|| xxxxxxxxxxx
     fFecha     = ~;
     aEjercicio = fFecha % -101;
     nPregunta1 = 0;
     nPregunta2 = 0;
     nPregunta3 = 0;
     nPregunta4 = 0;
     nPregunta5 = 0;
     nPregunta6 = 0;
     nPregunta7 = 0;

     |SI #102#5 = "S";
         |DBASS aBase;  |QBF aBase;
         aMas = aBase + "contagen/def/canempre.mas";
         aFic = aBase + "contagen/fich/";
         |CARGA_DEF aMas, referen1@;
         |SI FSalida = 0;
             |PATH_DAT #900 aFic;

             |ABRE #900;
             #900#2 = #102#12;
             #900#3 = aEjercicio;
             |LEE 000#900=;
             |SI FSalida ! 0;  nPregunta1 = 1;  |FINSI;
             |CIERRA #900;

             |DESCARGA_DEF #referen1@;
         |FINSI;

         |DBASS aBase;  |QBF aBase;
         aMas = aBase + "dscomer9/def/agifa041.mas";
         aFic = aBase + "dscomer9/fich/";
         |CARGA_DEF aMas, referen1@;
         |SI FSalida = 0;
             |PATH_DAT #900 aFic;

             |ABRE #900;
             #900#0 = #102#16;
             |LEE 000#900=;
             |SI FSalida ! 0;  nPregunta2 = 1;  |FINSI;
             |CIERRA #900;

             |DESCARGA_DEF #referen1@;
         |FINSI;

         |DBASS aBase;  |QBF aBase;
         aMas = aBase + "dscarter/def/dscam000.mas";
         aFic = aBase + "dscarter/fich/";
         |CARGA_DEF aMas, referen1@;
         |SI FSalida = 0;
             |PATH_DAT #900 aFic;

             |ABRE #900;
             #900#0 = #102#15;
             |LEE 000#900=;
             |SI FSalida ! 0;  nPregunta3 = 1;  |FINSI;
             |CIERRA #900;

             |DESCARGA_DEF #referen1@;
         |FINSI;

         |DBASS aBase;  |QBF aBase;
         aMas = aBase + "dstesor/def/dstem000.mas";
         aFic = aBase + "dstesor/fich/";
         |CARGA_DEF aMas, referen1@;
         |SI FSalida = 0;
             |PATH_DAT #900 aFic;

             |ABRE #900;
             #900#0 = #102#15;
             |LEE 000#900=;
             |SI FSalida ! 0;  nPregunta4 = 1;  |FINSI;
             |CIERRA #900;

             |DESCARGA_DEF #referen1@;
         |FINSI;

         |DBASS aBase;  |QBF aBase;
         aMas = aBase + "dspreven/def/visalm00.mas";
         aFic = aBase + "dspreven/fich/";
         |CARGA_DEF aMas, referen1@;
         |SI FSalida = 0;
             |PATH_DAT #900 aFic;

             |ABRE #900;
             #900#0 = #102#16;
             |LEE 000#900=;
             |SI FSalida ! 0;  nPregunta5 = 1;  |FINSI;
             |CIERRA #900;

             |DESCARGA_DEF #referen1@;
         |FINSI;

         |DBASS aBase;  |QBF aBase;
         aMas = aBase + "laboral/def/nomempre.mas";
         aFic = aBase + "laboral/fich/";
         |CARGA_DEF aMas, referen1@;
         |SI FSalida = 0;
             |PATH_DAT #900 aFic;
             |ABRE #900;
             #900#0 = #102#20;
             |LEE 000#900=;
             |SI FSalida ! 0;
                  nPregunta7 = 1;
             |FINSI;
             |CIERRA #900;

             |DESCARGA_DEF #referen1@;
         |FINSI;

         |DBASS aBase;  |QBF aBase;
         aMas = aBase + "integral/def/dsam0000.mas";
         aFic = aBase + "integral/fich/";
         |CARGA_DEF aMas, referen1@;
         |SI FSalida = 0;
             |PATH_DAT #900 aFic;

             |ABRE #900;
             #900#0 = #102#16;
             |LEE 000#900=;
             |SI FSalida ! 0;  nPregunta6 = 1;  |FINSI;
             |CIERRA #900;
             |DESCARGA_DEF #referen1@;
         |SINO;
             |DBASS aBase;  |QBF aBase;
             aMas = aBase + "basica/def/agifigen.mas";
             aFic = aBase + "basica/fich/";
             |CARGA_DEF aMas, referen1@;
             |SI FSalida = 0;
                 |PATH_DAT #900 aFic;

                 |ABRE #900;
                 #900#0 = #102#16;
                 |LEE 000#900=;
                 |SI FSalida ! 0;  nPregunta6 = 2;  |FINSI;
                 |CIERRA #900;

                 |DESCARGA_DEF #referen1@;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nPregunta1 = 1;  |O nPregunta2 = 1;  |O nPregunta3 = 1;
      |O nPregunta4 = 1;  |O nPregunta5 = 1;  |O nPregunta6 = 1;
      |O nPregunta6 = 2;
         |HAZ Crealos;
     |FINSI;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscomer9/def/agifa041.mas";
     aFic = aBase + "dscomer9/fich/";
     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

         |ABRE #900;
         #900#0 = #102#16;
         |LEE 000#900=;
         |SI FSalida = 0;
             aMas = aBase + "dscomer9/def/agifa007.mas";
             |CARGA_DEF aMas, referen2@;
             |SI FSalida = 0;
                 aFic = aBase + "dscomer9/fich/" + (("00000" + #102#16) % -105) + "/";
                 |PATH_DAT #901 aFic;
                 |ABRE #901;
                 #901#26 = #102#17;
                 |LEE 101#901=;
                 |SI FSalida ! 0;
                     #901#26 = "     ";
                     |LEE 000#901=;
                     |SI FSalida ! 0; |DDEFECTO #901; |FINSI;
                     #901#26 = #102#17;
                                      aAlfa = #102#11;  |QBF aAlfa;
                     |SI aAlfa = "";  aAlfa = #11#2;  |FINSI;
                     #901#27 = aAlfa;
                     |GRABA 020#901n;
                 |FINSI;
                 |CIERRA #901;
                 |DESCARGA_DEF #referen2@;
             |FINSI;

             aMas = aBase + "dscomer9/def/agifa029.mas";
             |CARGA_DEF aMas, referen2@;
             |SI FSalida = 0;
                 aFic = aBase + "dscomer9/fich/" + (("00000" + #102#16) % -105) + "/";
                 |PATH_DAT #901 aFic;
                 |ABRE #901;
                 #901#0 = #102#18;
                 |LEE 101#901=;
                 |SI FSalida ! 0;
                     |DDEFECTO #901;
                     #901#0 = #102#18;
                                      aAlfa = #102#11;  |QBF aAlfa;
                     |SI aAlfa = "";  aAlfa = #11#2;  |FINSI;
                     #901#1 = aAlfa;
                     |GRABA 020#901n;
                 |FINSI;
                 |CIERRA #901;
                 |DESCARGA_DEF #referen2@;
             |FINSI;
         |FINSI;

        |DESCARGA_DEF #referen1@;
     |FINSI;
|FPRC;

|PROCESO dsprem07;
     #103#0 = #102#0;
     #103#1 = #102#1;
     #103#2 = #102#2;
     #103#3 = #107#0;
     #103#4 = #107#1;
     |LEE 101#103=;
     |SI FSalida ! 0;
         |DDEFECTO #103;
         #103#0 = #102#0;
         #103#1 = #102#1;
         #103#2 = #102#2;
         #103#3 = #107#0;
         #103#4 = #107#1;
         |GRABA 020#103b;
     |FINSI;

     |SI #103#11 = 0;
         |DBASS aBase;  |QBF aBase;
         aMas = aBase + "dsoporte/def/dsprem03.mas";
         |CARGA_DEF aMas, referen1@;
         |SI FSalida = 0;
             |PATH_DAT #900 aPathDSoporte;
             |ABRE #900;
             |SELECT #2#900;
             |LEE 040#900u;
             |SI FSalida ! 0;  |DDEFECTO #900;  |FINSI;
             |CIERRA #900;

             #103#11 = #900#11 + 1;
             |SI #103#11 = 8888;  #103#11 = #103#11 + 1;  |FINSI;

             |DESCARGA_DEF #referen1@;
         |FINSI;
     |FINSI;

     #103#5  = #101#1;
     #103#6  = #108#2;
     #103#7  = #102#3;
     #103#8  = #107#2;
     #103#9  = #107#3;
     aAlfa   = #103#8; |QBF aAlfa;
     aAlfa   = aAlfa + "-" + #103#9;
     #103#10 = #102#0 + (("00" + #102#1) % -102) + (("000" + #102#2) % -102) + " " + aAlfa;
     |GRABA 020#103a;
     |LIBERA #103;

     #201#0 = #103#11;
     |LEE 101#201=;
     |SI FSalida ! 0;
         |DDEFECTO #201;
         #201#0 = #103#11;
         |GRABA 020#201b;
     |FINSI;
     #201#1 = #103#10;
     |GRABA 020#201a;
     |LIBERA #201;
|FPRC;

|DEFBUCLE dsprem07;
     #107#1;
     ;
     00, 00;
     99, 99;
     ;
     NULL, dsprem07;
|FIN;

|PROCESO dsprem02;
     #101#0 = #102#0;
     |LEE 000#101=;
     |SI FSalida ! 0;  |DDEFECTO #101;  |FINSI;

     #108#0 = #102#0;
     #108#1 = #102#1;
     |LEE 000#108=;
     |SI FSalida ! 0;  |DDEFECTO #108;  |FINSI;

     |BUCLE dsprem07;
|FPRC;

|DEFBUCLE dsprem02;
     #102#1;
     ;
     0, 00, 00;
     9, 99, 99;
     ;
     NULL, dsprem02;
|FIN;

|PROCESO CargaPerfiles;
     |ABRE #101;
     |ABRE #108;
     |ABRE #103;
     |ABRE #201;
     |BUCLE dsprem02;
     |CIERRA #101;
     |CIERRA #108;
     |CIERRA #103;
     |CIERRA #201;
|FPRC;

|PROCESO Boton1_1;
     |SI #11#1 ! 0;  |ACABA;  |FINSI;

     aAlfa = "0000NEsta Seguro de pasar a " + #11#2;  |QBF aAlfa;
     aAlfa = aAlfa + " " + "a GECONET";
     |CONFI aAlfa;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aCodCli = "N";
     aAlfa   = "0000NUsar el c¢digo cliente en el ERP, si respondemos que SI no se crearan ";
     aAlfa   = aAlfa + " autom ticamente las carpetas para el ERP ya deben existir.";
     |CONFI aAlfa;
     |SI FSalida = 0;  aCodCli = "S";  |FINSI;


     |BORRA_HIJOS_PAN #1#11;
     |SUB_PINPA #0#907, nPanta1;

     |ABRE #108;
     nReg = 1;
     |PARA;  |SI;  |HACIENDO;
         #108#0 = nGrupo;
         #108#1 = nReg;
         |LEE 000#108=;
         |SI FSalida ! 0;  |SAL;  |FINSI;
         |SI nReg    > 99; |SAL;  |FINSI;

         nReg = nReg + 1;
     |SIGUE;
     |CIERRA #108;

     |SI nReg > 99;
         |MENAV "0000 Tenemos mas de 99 Clientes, Operacion Abortada.";
         |BORRA_HIJOS_PAN #1#11;
         |ACABA;
     |FINSI;

     |LEE 101#11=;
     |SI FSalida = 0;
         #11#1  = nReg;
         #11#19 = aCodCli;
         |GRABA 020#11a;
         |LIBERA #11;
     |FINSI;

|DEBUG;
     |ABRE #18;
     #18#0 = #11#0;
     #18#1 = 1;
     #18#2 = #11#2;
     |GRABA 020#18n;
     |LIBERA #18;
     |CIERRA #18;

     |ABRE #101;
     #101#0 = nGrupo;
     |LEE 101#101=;
     |SI FSalida ! 0;
         #101#0 = nGrupo;
         #101#1 = aGrupo;
         |GRABA 020#101n;
     |FINSI;
     |LIBERA #101;
     |CIERRA #101;

     |ABRE #108;
     #108#0 = nGrupo;
     #108#1 = #11#1;
     |LEE 101#108=;
     |SI FSalida ! 0;
         #108#0 = nGrupo;
         #108#1 = #11#1;
         #108#2 = #11#2;
         |GRABA 020#108n;
     |FINSI;
     |LIBERA #108;
     |CIERRA #108;

     |ABRE #102;
     #102#0 = nGrupo;
     #102#1 = #11#1;
     #102#2 = #18#1;
     |LEE 101#102=;
     |SI FSalida ! 0;
         |DDEFECTO #102;
         #102#0  = nGrupo;
         #102#1  = #11#1;
         #102#2  = #18#1;
         #102#3  = #18#2;
         #102#5  = "S";
         aAlfa   = #102#0 + (("00"  + #102#1) % -102) + (("00" + #102#2) % -102);
         #102#12 = aAlfa;
         #102#13  = ("00"  + #102#1) % -102;
         #102#14  = ("000" + #102#2) % -103;
         #102#15 = aAlfa;
         #102#16 = aAlfa;
         #102#17 = aAlfa;
         #102#18 = aAlfa;
         #102#19 = aAlfa;
         || laboral
         #102#20 = aAlfa;
         |GRABA 020#102n;
     |FINSI;
     |LIBERA #102;
     |CIERRA #102;

     |HAZ CreaPaquetes;
     |HAZ CargaPerfiles;

     |BORRA_HIJOS_PAN #1#11;

     |REFRESCACONTROL nGrid1;
     |REFRESCACONTROL nGrid2;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 1_2
|| ------------------------------------------------------

|PROCESO Boton1_2;
     enImportados = 0;
     |SUB_EJECUTA_NP "gecoz004";

     |SI enImportados = 1;
         nEstoy = 1;
         |HAZ Boton0_1;
     |FINSI;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 2_1
|| ------------------------------------------------------

|PROCESO gecom009B;
     |BORRA 020#9a;
     |LIBERA #9;
|FPRC;

|DEFBUCLE gecom009B;
     #9#1;
     ;
     #4#0, #4#1, 000;
     #4#0, #4#1, 999;
     be;
     NULL, gecom009B;
|FIN;

|PROCESO gecom004B;
     |BUCLE gecom009B;

     |BORRA 020#4a;
     |LIBERA #4;
|FPRC;

|DEFBUCLE gecom004B;
     #4#1;
     ;
     00000, #11#0;
     99999, #11#0;
     be;
     NULL, gecom004B;
|FIN;

|PROCESO gecom013B;
     |BORRA 020#13a;
     |LIBERA #13;
|FPRC;

|DEFBUCLE gecom013B;
     #13#1;
     ;
     #12#0, #12#1, 000;
     #12#0, #12#1, 999;
     be;
     NULL, gecom013B;
|FIN;

|PROCESO gecom012B;
     |BUCLE gecom013B;

     |BORRA 020#12a;
     |LIBERA #12;
|FPRC;

|DEFBUCLE gecom012B;
     #12#1;
     ;
     #11#0, 00000;
     #11#0, 99999;
     be;
     NULL, gecom012B;
|FIN;

|PROCESO gecom014B;
     |BORRA 020#14a;
     |LIBERA #14;
|FPRC;

|DEFBUCLE gecom014B;
     #14#1;
     ;
     #11#0, 01, "          ";
     #11#0, 99, "zzzzzzzzzz";
     be;
     NULL, gecom014B;
|FIN;

|PROCESO dsprem04B;
     |BORRA 020#104a;
     |LIBERA #104;

     #105#0 = 1;
     |LEE 000#105=;
     |SI FSalida ! 0;  |DDEFECTO #105;  |FINSI;

     #106#0 = 1;
     |LEE 000#106=;
     |SI FSalida ! 0;  |DDEFECTO #106;  |FINSI;

     aOperacion  = "B";
     aDOperacion = "BAJA DEL USUARIO";
     |HORA aHora;

     nReg = 1;
     |LEE 000#99u;
     |SI FSalida = 0;
         nReg = #99#0 + 1;
     |FINSI;

     #99#0  = nReg;
     |GRABA 020#99b;

     #99#1  = #104#5;
     #99#2  = ~;
     #99#3  = aHora;
     #99#4  = aOperacion;
     #99#5  = aDOperacion;
     #99#6  = nGrupo + (("00" + #103#1) % -102) + (("00" + #103#2) % -102);
     #99#7  = #103#3;
     #99#8  = #103#4;
     #99#9  = aGrupo;
     #99#10 = #11#2;
     #99#11 = #103#7;
     #99#12 = #105#1;
     #99#13 = #106#1;
     aAlfa  = #105#1; |QBF aAlfa;
     aAlfa  = aAlfa + "-" + #106#1;
     #99#14 = nGrupo + (("00" + #103#1) % -102) + (("00" + #103#2) % -102) + " " + aAlfa;
     #99#15 = "N";
     #99#16 = "N";
     #99#17 = #104#11;
     #99#18 = #103#11;
     #99#19 = #104#8;
     #99#20 = Usuario % 810;
     |GRABA 020#99a;
     |LIBERA #99;
|FPRC;

|DEFBUCLE dsprem04B;
     #104#1;
     ;
     #103#0, #103#1, #103#2, #103#3, #103#4, "          ";
     #103#0, #103#1, #103#2, #103#3, #103#4, "zzzzzzzzzz";
     be;
     NULL, dsprem04B;
|FIN;

|PROCESO dsprem03B;
     |BUCLE dsprem04B;

     |BORRA 020#103a;
     |LIBERA #103;
|FPRC;

|DEFBUCLE dsprem03B;
     #103#1;
     ;
     nGrupo, #11#1, 01, 01, 01;
     nGrupo, #11#1, 99, 99, 99;
     be;
     NULL, dsprem03B;
|FIN;

|PROCESO BorraGestion;
     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscomer9/def/agifa041.mas";
     aFic = aBase + "dscomer9/fich/";
     |CARGA_DEF aMas, referen1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PATH_DAT #900 aFic;

     |ABRE #900;
     #900#0 = #102#16;
     |LEE 000#900=;
     |SI FSalida = 0;
         aAlfa  = aFic + (("00000" + #900#0) % -105);
         aDirec = "";
         |DIRECTORIO aDirec; |QBF aDirec;
         aAlfa = aDirec + "bin/agirm -r " + aAlfa;
         |SYSTEM aAlfa;

         |BORRA 020#900a;
         |LIBERA #900;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #referen1@;
|FPRC;

|PROCESO canempreB;
     aAlfa  = aFic + (("00000" + #900#2) % -105) + #900#3;
     aDirec = "";
     |DIRECTORIO aDirec; |QBF aDirec;
     aAlfa = aDirec + "bin/agirm -r " + aAlfa;
     |SYSTEM aAlfa;

     |BORRA 020#900a;
     |LIBERA #900;
|FPRC;

|DEFBUCLE canempreB;
     #900#1002;
     ;
     #102#12, 0;
     #102#12, 9;
     be;
     NULL, canempreB;
|FIN;

|PROCESO BorraContabilidad;
     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "contagen/def/canempre.mas";
     aFic = aBase + "contagen/fich/";
     |CARGA_DEF aMas, referen1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PATH_DAT #900 aFic;

     |BUCLE canempreB;

     |DESCARGA_DEF #referen1@;
|FPRC;

|PROCESO BorraCartera;
     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscarter/def/dscam000.mas";
     aFic = aBase + "dscarter/fich/";
     |CARGA_DEF aMas, referen1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PATH_DAT #900 aFic;

     |ABRE #900;
     #900#0 = #102#15;
     |LEE 000#900=;
     |SI FSalida = 0;
         aAlfa  = aFic + (("00000" + #900#0) % -105);
         aDirec = "";
         |DIRECTORIO aDirec; |QBF aDirec;
         aAlfa = aDirec + "bin/agirm -r " + aAlfa;
         |SYSTEM aAlfa;

         |BORRA 020#900a;
         |LIBERA #900;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #referen1@;
|FPRC;

|PROCESO BorraLaboral;
     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "laboral/def/nomempre.mas";
     aFic = aBase + "laboral/fich/";
     |CARGA_DEF aMas, referen1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PATH_DAT #900 aFic;

     |ABRE #900;
     #900#0 = #102#20;
     |LEE 000#900=;
     |SI FSalida = 0;
         aAlfa  = aFic + (("00000" + #900#0) % -105);
         aDirec = "";
         |DIRECTORIO aDirec; |QBF aDirec;
         aAlfa = aDirec + "bin/agirm -r " + aAlfa;
         |SYSTEM aAlfa;

         |BORRA 020#900a;
         |LIBERA #900;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #referen1@;
|FPRC;

|PROCESO BorraTesoreria;
     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dstesor/def/dstem000.mas";
     aFic = aBase + "dstesor/fich/";
     |CARGA_DEF aMas, referen1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PATH_DAT #900 aFic;

     |ABRE #900;
     aAlfa  = nGrupo + (("00"  + #11#1) % -102) + (("00" + #18#1) % -102);
     #900#0 = aAlfa;
     |LEE 000#900=;
     |SI FSalida = 0;
         aAlfa  = aFic + (("00000" + #900#0) % -105);
         aDirec = "";
         |DIRECTORIO aDirec; |QBF aDirec;
         aAlfa = aDirec + "bin/agirm -r " + aAlfa;
         |SYSTEM aAlfa;

         |BORRA 020#900a;
         |LIBERA #900;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #referen1@;
|FPRC;

|PROCESO gecom018B;
     |HAZ BorraTesoreria;

     |BORRA 020#18a;
     |LIBERA #18;
|FPRC;

|DEFBUCLE gecom018B;
     #18#1;
     ;
     #11#0, 01;
     #11#0, 99;
     be;
     NULL, gecom018B;
|FIN;

|PROCESO dsprem02B;
     |BORRA 020#102a;
     |LIBERA #102;
|FPRC;

|DEFBUCLE dsprem02B;
     #102#1;
     ;
     nGrupo, #11#1, 01;
     nGrupo, #11#1, 99;
     be;
     NULL, dsprem02B;
|FIN;

|PROCESO BorraPrevencion;
     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dspreven/def/visalm00.mas";
     aFic = aBase + "dspreven/fich/";
     |CARGA_DEF aMas, referen1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PATH_DAT #900 aFic;

     |ABRE #900;
     #900#0 = #102#16;
     |LEE 000#900=;
     |SI FSalida = 0;
         aAlfa  = aFic + (("00000" + #900#0) % -105);
         aDirec = "";
         |DIRECTORIO aDirec; |QBF aDirec;
         aAlfa = aDirec + "bin/agirm -r " + aAlfa;
         |SYSTEM aAlfa;

         |BORRA 020#900a;
         |LIBERA #900;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #referen1@;
|FPRC;

|PROCESO Boton2_1;
     aAlfa = "0000NEsta Seguro de QUITAR a " + #11#2;  |QBF aAlfa;
     aAlfa = aAlfa + " " + "de GECONET";
     |CONFI aAlfa;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aAlfa = "0000NSe borrara la Gestion, la Contabilidad, la Cartera y el Laboral. Esta Seguro de QUITAR";
     |CONFI aAlfa;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BUCLE gecom004B;
     |BUCLE gecom012B;
     |BUCLE gecom018B;
     |BUCLE gecom014B;

     |ABRE #102;
     #102#0 = nGrupo;
     #102#1 = #11#1;
     #102#2 = 1;
     |LEE 000#102=;
     |CIERRA #102;

     |ABRE #99;
     |ABRE #105;
     |ABRE #106;
     |BUCLE dsprem03B;
     |CIERRA #99;
     |CIERRA #105;
     |CIERRA #106;

     |HAZ BorraGestion;
     |HAZ BorraContabilidad;
     |HAZ BorraCartera;
     |HAZ BorraPrevencion;
     |HAZ BorraLaboral;

     |ABRE #108;
     #108#0 = nGrupo;
     #108#1 = #11#1;
     |LEE 101#108=;
     |SI FSalida = 0;
         |BORRA 020#108a;
         |LIBERA #108;
     |FINSI;
     |CIERRA #108;

     |BUCLE dsprem02B;

     |LEE 101#11=;
     |SI FSalida = 0;
         #11#1 = 0;
         |GRABA 020#11a;
         |LIBERA #11;
     |FINSI;

     |REFRESCACONTROL nGrid1;
     |REFRESCACONTROL nGrid2;

     enInstalar = 1;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 2_2
|| ------------------------------------------------------

|PROCESO gecom013;
     #9#0 = #13#1;
     #9#1 = #13#0;
     #9#2 = #13#2;
     |LEE 101#9=;
     |SI FSalida ! 0;
         |DDEFECTO #9;
         #9#0 = #13#1;
         #9#1 = #13#0;
         #9#2 = #13#2;
         |GRABA 020#9b;
     |FINSI;
     #9#3 = #13#4;
     #9#4 = #13#5;
     |GRABA 020#9a;
     |LIBERA #9;
|FPRC;

|DEFBUCLE gecom013;
     #13#1;
     ;
     #12#0, #12#1, 000;
     #12#0, #12#1, 999;
     ;
     NULL, gecom013;
|FIN;

|PROCESO gecom012;
     #3#0 = #12#1;
     |LEE 101#3=;
     |SI FSalida ! 0;
         #3#0 = #12#1;
         #3#1 = #12#2;
         |GRABA 020#3n;
     |FINSI;
     |LIBERA #3;

     #4#0 = #12#1;
     #4#1 = #12#0;
     |LEE 101#4=;
     |SI FSalida ! 0;
         #4#0 = #12#1;
         #4#1 = #12#0;
         #4#2 = #11#2;
         |GRABA 020#4n;
     |FINSI;
     |LIBERA #4;

     |BUCLE gecom013;
|FPRC;

|DEFBUCLE gecom012;
     #12#1;
     ;
     #11#0, 00000;
     #11#0, 99999;
     ;
     NULL, gecom012;
|FIN;

|PROCESO CargaAdministradores;
     |ABRE #3;
     |ABRE #4;
     |ABRE #9;

     |BUCLE gecom004B;
     |BUCLE gecom012;

     |CIERRA #3;
     |CIERRA #4;
     |CIERRA #9;
|FPRC;

|PROCESO Boton2_2;
     |VENTANA 0501, 2799, -1, -1, "";
     nVentana = FSalida;

     enCliente = #11#0;
     |SUB_EJECUTA_NP "gecow003";

     |HAZ CargaAdministradores;

     |FINVENTANA nVentana;

     enInstalar = 1;
|FPRC;

|PROCESO Boton2_3;
     |VENTANA 0501, 2799, -1, -1, "";
     nVentana = FSalida;

     enCliente = #11#0;
     |SUB_EJECUTA_NP "gecow008";

     |FINVENTANA nVentana;
|FPRC;

|PROCESO Boton2_4;
     || aqui los procesos del boton de empresas de laboral
     |VENTANA 0501, 2799, -1, -1, "";
     nVentana = FSalida;

     enCliente = #11#0;
     |SUB_EJECUTA_NP "gecow010";

     |FINVENTANA nVentana;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Inicio del Programa
|| ------------------------------------------------------

|PROCESO EventoPanta1;
     nEstoy = 1;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#11=;
         |SI FSalida ! 0;
             #11#18 = "S";

             |ESTADO_CONTROL nBoton1_1, "DISABLE";
         |SINO;
             |ESTADO_CONTROL nBoton1_1, "ENABLE";
         |FINSI;

         |SI #11#18 = "S";
             |ESTADO_CONTROL nBoton0_3, "DISABLE";
         |SINO;
             |ESTADO_CONTROL nBoton0_3, "ENABLE";
         |FINSI;

         |SI #11#1 ! 0;
             |ESTADO_CONTROL nBoton0_4, "DISABLE";
         |SINO;
             |ESTADO_CONTROL nBoton0_4, "ENABLE";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO EventoPanta2;
     nEstoy = 2;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#11=;
         |SI FSalida ! 0;
             #11#18 = "S";

             |ESTADO_CONTROL nBoton2_1, "DISABLE";
             |ESTADO_CONTROL nBoton2_2, "DISABLE";
         |SINO;
             |ESTADO_CONTROL nBoton2_1, "ENABLE";
             |ESTADO_CONTROL nBoton2_2, "ENABLE";
         |FINSI;

         |SI nBoton2_5 ! -1;
             |FIN_CONTROL_WINDOWS nBoton2_5;
         |FINSI;

         aAlfa = "LABEL,{{1}}CARPETA: " + nGrupo + (("00" + #11#1) % -102) + "01";
         |CONTROL_SIMPLE nPanta2, aAlfa, 0680, 0698, NULL;
         nBoton2_5 = FSalida;

         aAlfa = "LABEL,{{0}}Se usa c¢digo carpeta";
         |SI #11#19 = "S";
             aAlfa = "LABEL,{{0}}Se usa c¢digo cliente";
         |FINSI;
         |CONTROL_SIMPLE nPanta2, aAlfa, 0780, 0798, NULL;

         |SI #11#18 = "S";
             |ESTADO_CONTROL nBoton0_3, "DISABLE";
         |SINO;
             |ESTADO_CONTROL nBoton0_3, "ENABLE";
         |FINSI;

         |SI #11#1 ! 0;
             |ESTADO_CONTROL nBoton0_4, "DISABLE";
         |SINO;
             |ESTADO_CONTROL nBoton0_4, "ENABLE";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO BotonesPanta0;
     |CONTROL_SIMPLE nPanta0, "BOTON,{{135}}Actualizar Datos ", 0556, 0575, Boton0_1;
     nBoton0_1 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{193}} Cliente Nuevo", 0656, 0675, Boton0_2;
     nBoton0_2 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{197}} Modificar Cliente", 0580, 0598, Boton0_3;
     nBoton0_3 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{207}} Baja Cliente", 0680, 0698, Boton0_4;
     nBoton0_4 = FSalida;

     |ESTADO_CONTROL nBoton0_3, "DISABLE";
|FPRC;

|PROCESO BotonesPanta1;
     |CONTROL_SIMPLE nPanta1, "BOTON,{{230}} A GECONET", 0877, 0998, Boton1_1;
     nBoton1_1 = FSalida;

     |CONTROL_SIMPLE nPanta1, "BOTON,IMPORTACION DATOS CLIENTE", 2077, 2198, Boton1_2;
     nBoton1_2 = FSalida;
|FPRC;

|PROCESO BotonesPanta2;
     |CONTROL_SIMPLE nPanta2, "LBOTON,{{229}} QUITAR DE GECONET ", 0877, 0998, Boton2_1;
     nBoton2_1 = FSalida;

     |CONTROL_SIMPLE nPanta2, "BOTON, ADMINISTRADORES ", 1177, 1298, Boton2_2;
     nBoton2_2 = FSalida;

     |CONTROL_SIMPLE nPanta2, "BOTON, DELEGACIONES ", 1477, 1598, Boton2_3;
     nBoton2_3 = FSalida;

     |CONTROL_SIMPLE nPanta2, "BOTON, EMPRESAS LABORAL ", 1777, 1898, Boton2_4;
     nBoton2_4 = FSalida;
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     |ABRET #11;

     |DBASS aBase;  |QBF aBase;
     aGrupo  = aBase % -201;
     nGrupo  = aGrupo;
     |SI nGrupo = 0;
         nGrupo = 1;
     |FINSI;

     aGrupo  = aBase % -205;

     aPathDSoporte = aBase + "dsoporte/fich/";

     |PATH_DAT #99  aPathDSoporte;
     |PATH_DAT #101 aPathDSoporte;
     |PATH_DAT #102 aPathDSoporte;
     |PATH_DAT #103 aPathDSoporte;
     |PATH_DAT #104 aPathDSoporte;
     |PATH_DAT #105 aPathDSoporte;
     |PATH_DAT #106 aPathDSoporte;
     |PATH_DAT #107 aPathDSoporte;
     |PATH_DAT #108 aPathDSoporte;
     |PATH_DAT #201 aPathDSoporte;

     FSalida = 2799;
|FPRC;

|PROCESO Tipo90;  |TIPO 90;
     |CIERRAT #11;

/*
     || Quitado tiquet 000577/1245

     |SI enInstalar = 0;  |ACABA;  |FINSI;

     |CONFI "0000SAl manipular Administradores y Usuarios, debera actualizar los perfiles. Realizar Ahora.";
     |SI FSalida = 0;
         |HAZ CargaPerfiles;
         |SUB_EJECUTA_NP ":dsoporte/dsprez02;AUTO";
     |FINSI;
*/
|FPRC;

|PROCESO gecom011;
     #18#0 = #11#0;
     #18#1 = 1;
     #18#2 = #11#2;
     |GRABA 020#18n;
     |LIBERA #18;

     #102#0 = nGrupo;
     #102#1 = #11#1;
     #102#2 = 1;
     |LEE 101#102=;
     |SI FSalida = 0;
         #102#3 = #18#2;
         |GRABA 020#102a;
         |LIBERA #102;
     |FINSI;
|FPRC;

|DEFBUCLE gecom011;
     #11#2;
     ;
     01, 00000;
     99, 99999;
     ;
     NULL, gecom011;
|FIN;

|PROCESO EventoFocoGrid1;
     |REFRESCACONTROL nGrid1;
     |FOCOTECLADO nGrid1;
|FPRC;

|PROCESO EventoFocoGrid2;
     |REFRESCACONTROL nGrid2;
     |FOCOTECLADO nGrid2;
|FPRC;

|PROGRAMA;
     |HAZ RevisaUsuarios;

     |ABRE #18;
     |LEE 000#18p;
     |SI FSalida ! 0;
         |ABRE #102;
         |BUCLE gecom011;
         |CIERRA #102;
     |FINSI;
     |CIERRA #18;

     enInstalar = 0;

     |LEE 000#11p;
     |SI FSalida ! 0;
         |HAZ Boton0_1;
     |FINSI;

     |LEE 000#11p;
     |PINPA #0#11;  nPanta0 = FSalida;

     |PINPA #1#11;  nPanta1 = FSalida;

     nRango = 4 + 8 + 16 + 32 + 128;
     nPos1  = 0602;
     nPos2  = 2375;

     nEstoy        = 1;
     nDTipoPanta1  = 0;
     nHTipoPanta1  = 0;
     |LINEAL_SIMPLE #2#11, nRango, nPos1, nPos2, BajaPanta1, AltaPanta1, EventoPanta1;
     nGrid1 = FSalida;

     |PINPA #2#11;  nPanta2 = FSalida;

     nDTipoPanta2 = 01;
     nHTipoPanta2 = 99;
     |LINEAL_SIMPLE #2#11, nRango, nPos1, nPos2, BajaPanta2, AltaPanta2, EventoPanta2;
     nGrid2 = FSalida;

     |HAZ BotonesPanta0;
     |HAZ BotonesPanta1;
     |HAZ BotonesPanta2;

     |CONTROL_SIMPLE nPanta1, "EVENTOPAN", 0000, 0000, EventoFocoGrid1;
     nFoco1 = FSalida;

     |CONTROL_SIMPLE nPanta2, "EVENTOPAN", 0000, 0000, EventoFocoGrid2;
     nFoco2 = FSalida;

     |FOCOTECLADO nGrid1;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::Salir," + nGrid1;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton0_1;
     |FIN_CONTROL_WINDOWS nBoton0_2;
     |FIN_CONTROL_WINDOWS nBoton0_3;
     |FIN_CONTROL_WINDOWS nBoton0_4;

     |FIN_CONTROL_WINDOWS nBoton1_1;
     |FIN_CONTROL_WINDOWS nBoton1_2;

     |FIN_CONTROL_WINDOWS nBoton2_1;
     |FIN_CONTROL_WINDOWS nBoton2_2;
     |FIN_CONTROL_WINDOWS nBoton2_3;
     |FIN_CONTROL_WINDOWS nBoton2_4;

     |SI nBoton2_5 ! -1;  |FIN_CONTROL_WINDOWS nBoton2_5;  |FINSI;

     |DESTRUYECONTROL nGrid1;
     |DESTRUYECONTROL nGrid2;
     |DESTRUYECONTROL nFoco1;
     |DESTRUYECONTROL nFoco2;

     |PULSATECLA;
|FPRO;
