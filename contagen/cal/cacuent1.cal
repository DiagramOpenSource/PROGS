|FICHEROS;
   cacuent1 #0;
   cacuenta #10,MANTE;
   cacuebal #11;
   caparbal #12;
   caagrupa #13;
   caepigra #14;
   canempre #30;
|FIN;

|VARIABLES;
   &eaCuenta  = "";
   &eaNombre  = "";
   &enEmpresa = 0;
   &enPeriodo = 0;
   &fich_alta = "";

   Calc      = 0;
   nCont     = 0;

   Comodin   = "";
   aAlfa     = "";
|FIN;

|PROGRAMA;
   |DFICB aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + ((("00000" + enEmpresa) % -105) + enPeriodo) + "/";
   |PATH_DAT #cacuenta#aAlfa#; |PATH_DAT #cacuebal#aAlfa#; |PATH_DAT #caparbal#aAlfa#;
   |PATH_DAT #caagrupa#aAlfa#; |PATH_DAT #caepigra#aAlfa#;
   fich_alta = aAlfa; |HAZ inicio;


   |ABRE #cacuenta; |ABRE #cacuebal; |ABRE #caparbal;

   #cacuenta#0 = eaCuenta;
   |LEE 101#cacuenta.=;
   |SI FSalida ! 0;
      |DDEFECTO #cacuenta;
      #cacuenta#0 = eaCuenta;
      #cacuenta#2 = eaNombre;
      |GRABA 020#cacuenta.b;

      |PARA nCont = 6; |SI nCont ] 1; |HACIENDO nCont = nCont - 1;
         Calc = 13 + nCont;
         |SI #canempre#Calc# ! 0;
            Calc = 100 + #canempre#Calc#;
            Comodin = eaCuenta % Calc;
            #cacuebal#0 = Comodin
            |LEE 000#cacuebal.=;
            |SI FSalida = 0;
               #caparbal#0 = #cacuebal#2;
               #caparbal#1 = #cacuebal#3;
               #caparbal#3 = #cacuebal#4;
               #caparbal#5 = #cacuebal#5;
               |LEE 000#caparbal.=;
               |SI FSalida ! 0; |DDEFECTO #caparbal; |FINSI;

               #cacuenta#4 = #cacuebal#1;
               #cacuenta#5 = #cacuebal#2;
               #cacuenta#6 = #cacuebal#3;
               #cacuenta#7 = #cacuebal#4;
               #cacuenta#8 = #cacuebal#5;
               |SAL;
            |FINSI;
         |FINSI;
      |SIGUE;
      |CIERRA #cacuebal; |CIERRA #caparbal;

      #cacuenta#2 = eaNombre;
      |PUSHV 0501 2380; #cacuenta#3 = "S";
      |PINPA #0#cacuenta; |PINDA #0#cacuenta;
      |SI #cacuebal#2 = "A";
         |PINTA 1221, " ACTIVO        ";
      |SINO;
         |PINTA 1221, " PASIVO        ";
      |FINSI;
      |PINTA 1321, #caparbal#2;
      |PINTA 1421, #caparbal#4;
      |PINTA 1521, #caparbal#6;
      |ENDATOS #1#cacuenta;
      |SI FSalida = 0;
         |GRABA 020#cacuenta.a;
      |FINSI;
      |LIBERA #cacuenta;
      |POPV;
   |FINSI;
   |CIERRA #cacuenta;
|FPRO;
