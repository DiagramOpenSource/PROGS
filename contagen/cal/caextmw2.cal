|FICHEROS;
   caextmz1 #0;

   caextmw2 #2,MANTE;
   caextmw3 #3;
   caexttip #10;

   caextm01 #11;
   caextm02 #12;
|FIN;

|VARIABLES;
     &entrada = 1;
     nModo    = 0;
     inkey    = 0;
     inkeyc   = 0;
     totallin = 0;
     aAlfa    = "";
     aAlfa1   = "";
     aAlfa2   = "";
     aAlfa3   = "";
     aAlfa4   = "";
     nNume1   = 0;
     nNumero  = 0;
     nError   = 0;
     aFichero  = "";

     nVariable      = 0;
     &enDentro      = 0;
     &eaNombreList  = "";
     &enCuadroIni   = 0;
     &enCuadroFin   = 0;
     &enCampoAncho  = 0;
     &enModoEdita   = 0;
     &enTotalVaria  = 0;
{101}&epPuntEdita   = "";
|FIN;

|INCLUYE dscont_i;

||  ***********************************************************

|| /////////////////////////////////////////////////////////////////////////
|PROCESO RecogeDelFichero;
     #3#0 = #2#0;
     #3#1 = 1;
     |LEE 040#3=;
     |SI FSalida ! 0;
         |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
               #3#0 = #2#0;
               #3#1 = nVariable;
               |LEE 040#3=;
               |SI FSalida = 0;
                   #3#0 = #2#0;
                   #3#1 = nVariable;
                   |GRABA 020#3n;
                   |LIBERA #3;
               |FINSI;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO BorroLineas;
   |BORRA 020#3a;
   |LIBERA #3;
|FPRC;

|DEFBUCLE BorroLineas;
   #3#1;
   ;
   #2#0, 0001;
   #2#0, 9999;
   e;
   NULL, BorroLineas;
|FIN;

|PROCESO BorroTexto;
   |BORRA 020#12a;
   |LIBERA #12;
|FPRC;

|DEFBUCLE BorroTexto;
   #12#1;
   ;
   #11#13, #11#0, 0001;
   #11#13, #11#0, 9999;
   be;
   NULL, BorroTexto;
|FIN;

|CALCULO Tipo1; |TIPO 1;
   nModo = (FEntrada / 100) ! 0;

   |SI nModo = 3;
       |BUCLE BorroLineas;

       |SI #2#13 ! 0;
           |ABRE #11;
           #11#13 = enEmpresa;
           #11#0  = #2#13;
           |LEE 141#11=;
           |SI FSalida = 0;
               |BUCLE BorroTexto;
               |BORRA 020#11a;
               |LIBERA #11;
           |FINSI;
           |CIERRA #11;
       |FINSI;
   |FINSI;
|FCAL;

|PROCESO AltaLinea;
   #3#0 = #2#0;
   #3#1 = 0001;
|FPRC;

|PROCESO BajaLinea;
   #3#0 = #2#0;
   #3#1 = 9999
|FPRC;

|CALCULO Tipo3; |TIPO 3;

   enTotalVaria  = 99;
   eaNombreList  = "";
   enCuadroIni   = 1423;
   enCuadroFin   = 2174;
   enCampoAncho  = 50;
   enModoEdita   = 0;

   |ABRE #3;
   |HAZ RecogeDelFichero;
   |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
         IepPuntEdita  = epPuntEdita1 <-;
         IepPuntEdita = IepPuntEdita + (nVariable - 1);

         #3#0 = #2#0;
         #3#1 = nVariable;
         |LEE 101#3=;
         |SI FSalida ! 0;
             epPuntEdita  = "";
         |SINO;
             epPuntEdita  = #3#2;
             |BORRA 020#3a;
         |FINSI;
         |LIBERA #3;
     |SIGUE;

     |PUSHV  0501 2380;
     |CUADRO 1321 2277;
     |BLANCO 1422 2176;
     |SI #2#8 ! "X";
         |ATRI S;  |PINTA 1323, "Introduzca el Texto ";  |ATRI 0;
     |SINO;
         |ATRI P;  |PINTA 1323, "SOLO CONSULTA. PARA MODIFICAR EN EJERCICIO POSTERIOR"; |ATRI 0;
     |FINSI;

     |HAZ Edita;
     |POPV;

 |SI #2#8 ! "X";
     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           |DDEFECTO #3;
           #3#0 = #2#0;
           #3#1 = nVariable;
           |LEE 1010#3=;
           |SI FSalida ! 0;  |GRABA 020#3b;  |FINSI;
           #3#2 = epPuntEdita;
           |GRABA 020#3a;
           |LIBERA #3;
     |SIGUE;

     |PARA nVariable = 100;  |SI nVariable ] 1;  |HACIENDO nVariable = nVariable - 1;
           #3#0 = #3#0;
           #3#1 = nVariable;
           |LEE 101#3=;
           aAlfa = #3#2;  |QBF aAlfa;

           |LIBERA #3;

           |SI aAlfa ! "";  |SAL;  |FINSI;

           |BORRA 020#3a;
     |SIGUE;
 |FINSI;

 |CIERRA #3;

 |ENTLINEAL #1#3, -2, 7, 21, 0, AltaLinea, BajaLinea;
|FCAL;

|CALCULO ElTipo; |TIPO 0;
   nModo = (FEntrada / 100) ! 0;
   nError = 0;

   |ABRE #10;
   #10#0 = #2#1;
   |LEE 041#10=;
   |SI FSalida ! 0;
       nError = 1;
   |FINSI;
   |CIERRA #10;

   |SI nError = 0;
       |PINTA 1232, #10#1;
       |SI nModo = 1;
           #2#2 = #10#2; |PINTA #2#2;
       |FINSI;
   |FINSI;

   |SI #2#2 = 1; aAlfa1 = "General"; |FINSI;
   |SI #2#2 = 2; aAlfa1 = "Cuenta "; |FINSI;
   |SI #2#2 = 3; aAlfa1 = "Asiento"; |FINSI;

   |ATRI P;
   |PINTA 1266, aAlfa1;
   |ATRI 0;

   |SI #10#3 = "S"; aAlfa1 = "Publico   "; |FINSI;
   |SI #10#3 = "N"; aAlfa1 = "NO Publico"; |FINSI;

   |ATRI P;
   |PINTA 1366, aAlfa1;
   |ATRI 0;

   |SI nModo = 1;
      |SI #2#2 = 1;
          #2#3 = 0;
          #2#4 = "01.01.0000";
          #2#5 = 0;
          #2#6 = "";
          #2#7 = "";
          #2#10 = 000;
          #2#11 = "";
      |FINSI;

      |SI #2#2 = 2;
          #2#3  = 0;
          #2#4  = "01.01.0000";
          #2#5  = 0;
          #2#10 = 000;
          #2#11 = "";
          #2#6  = #0#4;
          #2#7  = #0#5;
      |FINSI;

      |SI #2#2 = 3;
          #2#3 = #0#0;
          #2#4 = #0#1;
          #2#5 = #0#2;
          #2#6 = "";
          #2#7 = "";
          #2#10 = #0#5;
          #2#11 = #0#6;
          #2#12 = #0#7;
      |FINSI;
   |FINSI;

   |SI #2#2 = 1;
       |PINTA 0705, "Asiento:";
       |PINTA 0905, "Cuenta :";
   |FINSI;
   |SI #2#2 = 2;
       |PINTA 0705, "Asiento:";
       |ATRI S; |PINTA 0905, "Cuenta :"; |ATRI 0;
   |FINSI;
   |SI #2#2 = 3;
       |ATRI S; |PINTA 0705, "Asiento:"; |ATRI 0;
                |PINTA 0905, "Cuenta :";
   |FINSI;
|FCAL;

|CALCULO SegunTipo;

   nModo  = (FEntrada / 100) ! 0;
   |SI nModo = 1;
       aAlfa4 = "S";
       aAlfa3 = "S";
   |SINO;
       aAlfa3 = "N";
       aAlfa4 = "S";
       |SI #2#8 = "X"; aAlfa4 = "N"; |FINSI;
   |FINSI;

   |C_M #2#1,1, aAlfa3;
   |C_M #2#8,1, aAlfa4;

   |PINTA 1232, "                              ";
   |PINTA 1266, "          ";
   |PINTA 1366, "          ";

   |PINTA 0705, "Asiento:";
   |PINTA 0905, "Cuenta :";
   |SI nModo ! 1;
       |HAZ ElTipo;
   |FINSI;
|FCAL;

|PROCESO Tipo5;  |TIPO 5;
       |LEE 040#2p;
       #2#8 = "R";
       |LINEAS_BI_ATRI #2#8, S, N, -1;
|FPRC;

|CALCULO Tipo7C00; |TIPO 7;

   |HAZ SegunTipo;

   |ENTLINEAL #1#3, -2, 7, 21, 0, AltaLinea, BajaLinea;
|FCAL;

|CALCULO Tipo11; |TIPO 11;
   inkey = FSalida;
   nModo = (FEntrada / 100) ! 0;

   |SI inkey ] 10; |Y inkey [ 12; |Y #2#8 ! "X"; |Y nModo ! 1;
       aAlfa = "C";
       |SI FSalida = 10; aAlfa = "R"; |FINSI;
       |SI FSalida = 11; aAlfa = "P"; |FINSI;

       |LEE 141#2=;
       #2#8 = aAlfa;
       |GRABA 020#2a;
       |LIBERA #2;
       |PONCONTROL 23, "SI";
   |FINSI;
|FCAL;

|CALCULO Tipo0; |TIPO 0;
|FCAL;
