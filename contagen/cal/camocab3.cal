|FICHEROS;
   camocab3 #0;
   cacuenta #5;
   canempre #30;

   :/modelos/def/dsmom040 #40;
|FIN;

|VARIABLES;
   &c_ctana = "";
   &enGrupo = 0;

   nEstado = 0;
   aAlfa1 = "";
   nNume1 = 0;
   nPara1 = 0;
   inkey  = 0;
   ModoEntrLin = 0;
|FIN;

|INCLUYE dscont_i;
|INCLUYE dscoan_i;

|| *************************************************************
|| .... Calculos de los campos por pantalla.
|CALCULO cuentag; |TIPO 6;
     eaCuenta = #0Campo;
     salidas  = FSalida;

     |HAZ FiltraPuntos;
     #0Campo = eaCuenta;
     |PINTA #0Campo;

     nNume1 = Campo + 1;
     eaCuenta = #0Campo; |HAZ SacaNivel;
     #0nNume1 = enNivel;
|FCAL;

|CALCULO refrescag; |TIPO 0;
   |SI #0Campo ! doce;
      |SI #cacuenta#3 = "N";
          |MENAV "    Esta Cuenta NO tiene Pase Directo ";
          |ERROR;
      |FINSI;
   |FINSI;
|FCAL;


|| ----- Cuentas analiticas
|CALCULO AntesAnaG; |TIPO 7;
 ModoEntrLin = (FEntrada / 100) ! 0;
 |SI enSwAna = 1;
     eaCuenta = #0#3;
     |HAZ LeeTablaAna;
     |SI swRelac = 0;
         #0#9 = eaCtaAna;
         |C_M #0#9,1,eaAnaMod;
     |SINO;
         |SI ModoEntrLin = 1; #0#9 = ""; |FINSI;
         |SI eaPAna = "S";
             |C_M #0#9,1,"N";
         |SINO;
             |C_M #0#9,1,"S";
         |FINSI;
     |FINSI;
     |PINTA #0#9;
 |FINSI;
|FCAL;

|CALCULO anactaG; |TIPO 0;
  inkey = FSalida;
  |SI enSwAna = 0; |ACABA; |FINSI;

    salidas = FSalida; |HAZ FPuntosAna;
    eOpAna = 0; || 1 = Consulta pantalla
    |SI inkey = 10; eOpAna = 1;  |FINSI;
    eaCtaAna = #0#9;
    |HAZ LeeCtaAna;
    |SI eswLect = 1;
        |MENAV "    Error.! No Existe Cuenta Analitica";
        |ERROR;
    |SINO;
        #0#9 = eaCtaAna;
        |PINTA #0#9;
   |FINSI;
|FCAL;

|| ======================================================================
|PROCESO actualiza;

   |DDEFECTO #40;

   |DDEFECTO #40;
   #40#0 = #0#0;
   #40#2 = #0#2;
   |LEE 011#40=;
   nEstado = FSalida;

   #40#0 = #0#0; #40#1 = #0#1; #40#2 = #0#2;
   #40#7 = #0#7; #40#8 = #0#8; #40#9 = #0#9;
   #40#10 = #0#3; #40#11 = #0#4;
   #40#12 = #0#5; #40#13 = #0#6;

   c_ctana = #0#9;

   |SI nEstado = 0; |GRABA 011#40a; |FINSI;
   |SI nEstado ! 0; |GRABA 011#40n; |FINSI;
   |LIBERA #40;
   enGrupo = #0#2;
|FPRC;

|| ======================================================================

|PROGRAMA;
  |HAZ inicio;
  aAlfa1 = aPModelo + "fich/";
  |PATH_DAT #40 aAlfa1;

  |ABRE #40;
  |PINPA #0#0;
  |SI enSwAna = 1;
      |ATRI P; |PINTA 1635, "Cta. Analitica: "; |ATRI 0;
      |C_M #0#9,1,"S";
      |C_V #0#9,1,"S";
  |SINO;
      |PINTA 1635, "                        "; |ATRI 0;
      |C_M #0#9,1,"N";
      |C_V #0#9,1,"N";
  |FINSI;

   |DDEFECTO #0;
   |DDEFECTO #40;
   #40#0 = enEmpresa;
   #40#2 = enGrupo;
   |LEE 011#40=;
   nEstado = FSalida;

   |PARA nPara1 = 0; |SI nPara1 [ 9; |HACIENDO nPara1 = nPara1 + 1;
         #0nPara1 = #40nPara1;
   |SIGUE;
   #0#3 = #40#10; #0#4 = #40#11;
   #0#5 = #40#12; #0#6 = #40#13;

   #0#0 = enEmpresa;
   #0#2 = enGrupo;
   #0#8 = eaNombreEmp;
   #0#9 = c_ctana;

   |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;
       |HAZ actualiza;
   |FINSI;
   |CIERRA #40;
|FPRO;

|| ************************************************************************
