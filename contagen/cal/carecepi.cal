|FICHEROS;
   cacuenta #0;
   cacuebal #5;
   carecepi #10;
   canempre #30;

   ca8cumay #410;
|FIN;

|VARIABLES;
   &sw_conase4 = 0;
   &entrada = 1;
   uno    = "";
   desde  = "1";
   hasta  = "zzzzzzzzzzzz";
   dos    = " ";
   tres   = "";
   alfa1  = "";
   aParam = "";
   nNoBalX = 0;
|FIN;

|INCLUYE dscont_i;

|PROCESO conase4; |TIPO 7;
   |SI sw_conase4 = 1;
      #carecepi#0 = "S";     |PINTA #carecepi#0;
      |PTEC 802;
      |PTEC 802;
   |FINSI;
|FPRC;

|PROCESO meses;
   |SI #canempre#11 = 1;     #cacuenta#56 = "Enero";         |FINSI;
   |SI #canempre#11 = 2;     #cacuenta#56 = "Febrero";       |FINSI;
   |SI #canempre#11 = 3;     #cacuenta#56 = "Marzo";         |FINSI;
   |SI #canempre#11 = 4;     #cacuenta#56 = "Abril";         |FINSI;
   |SI #canempre#11 = 5;     #cacuenta#56 = "Mayo";          |FINSI;
   |SI #canempre#11 = 6;     #cacuenta#56 = "Junio";         |FINSI;
   |SI #canempre#11 = 7;     #cacuenta#56 = "Julio";         |FINSI;
   |SI #canempre#11 = 8;     #cacuenta#56 = "Agosto";        |FINSI;
   |SI #canempre#11 = 9;     #cacuenta#56 = "Septiembre";    |FINSI;
   |SI #canempre#11 = 10;    #cacuenta#56 = "Octubre";       |FINSI;
   |SI #canempre#11 = 11;    #cacuenta#56 = "Noviembre";     |FINSI;
   |SI #canempre#11 = 12;    #cacuenta#56 = "Diciembre";     |FINSI;

   |SI #canempre#12 = 1;     #cacuenta#57 = "Enero";         |FINSI;
   |SI #canempre#12 = 2;     #cacuenta#57 = "Febrero";       |FINSI;
   |SI #canempre#12 = 3;     #cacuenta#57 = "Marzo";         |FINSI;
   |SI #canempre#12 = 4;     #cacuenta#57 = "Abril";         |FINSI;
   |SI #canempre#12 = 5;     #cacuenta#57 = "Mayo";          |FINSI;
   |SI #canempre#12 = 6;     #cacuenta#57 = "Junio";         |FINSI;
   |SI #canempre#12 = 7;     #cacuenta#57 = "Julio";         |FINSI;
   |SI #canempre#12 = 8;     #cacuenta#57 = "Agosto";        |FINSI;
   |SI #canempre#12 = 9;     #cacuenta#57 = "Septiembre";    |FINSI;
   |SI #canempre#12 = 10;    #cacuenta#57 = "Octubre";       |FINSI;
   |SI #canempre#12 = 11;    #cacuenta#57 = "Noviembre";     |FINSI;
   |SI #canempre#12 = 12;    #cacuenta#57 = "Diciembre";     |FINSI;
|FPRC;

|PROCESO clave_3;
   alfa1 = #cacuenta#0;
   |QBF alfa1;
   alfa1 = alfa1 + "zzzzzzzzzzzz";
   alfa1 = alfa1 % 112;
   #cacuenta#54 = alfa1;  || cuenta tercera clave
   #cacuenta#55 = #cacuenta#1;   || digito tercera clave
|FPRC;

|PROCESO saca;
   #cacuenta#4 = #cacuebal#1;    || bloque
   #cacuenta#5 = #cacuebal#2;    || tipo
   #cacuenta#6 = #cacuebal#3;    || agrupacion
   #cacuenta#7 = #cacuebal#4;    || epigrafe
   #cacuenta#8 = #cacuebal#5;    || partida
   |HAZ clave_3;
   |HAZ meses;

   |GRABA 020#0a;
|FPRC;

|PROCESO LeoCa8cumay;
   |SI nNoBalX = 1;
       #ca8cumay#12 = enEjerBal;
       #ca8cumay#0  = uno;
       #ca8cumay#10 = eNum2008;
       |LEE 001#ca8cumay.=;
       |SI FSalida = 0;
           nNoBalX = 0;
       |FINSI;
   |FINSI;
|FPRC;

|PROCESO BuscaCa8;
   #cacuenta#4 = #ca8cumay#2;    || bloque
   #cacuenta#5 = #ca8cumay#3;    || tipo
   #cacuenta#6 = #ca8cumay#5;    || agrupacion
   |HAZ clave_3;
   |HAZ meses;

   |GRABA 020#0a;
|FPRC;

|PROCESO cuenta;
 nNoBalX = 1;
 |SI enEjercicio < 2008;
     uno = #cacuenta#0; |QBF uno; tres = uno;
     dos = uno + "000000000000";
     uno = dos % A101;
     #cacuebal#0 = uno;
     |LEE 040#cacuebal.=;
     |SI FSalida = 0;  |HAZ saca;  |ACABA;  |FINSI;
     uno = dos % A102;
     #cacuebal#0 = uno;
     |LEE 040#cacuebal.=;
     |SI FSalida = 0;  |HAZ saca;  |ACABA;  |FINSI;
     uno = dos % A103;
     #cacuebal#0 = uno;
     |LEE 040#cacuebal.=;
     |SI FSalida = 0;  |HAZ saca;  |ACABA;  |FINSI;
     uno = dos % A104;
     #cacuebal#0 = uno;
     |LEE 040#cacuebal.=;
     |SI FSalida = 0;
         |HAZ saca;
     |FINSI;
 |SINO;
     uno = #cacuenta#0; |QBF uno; tres = uno;
     dos = uno + "000000000000";
     uno = dos % A105;               ||a partir del 2008 empezar por 5 digitos
     #cacuebal#0 = uno;
     |LEE 040#cacuebal.=;
     |SI FSalida = 0;  |HAZ saca;  |ACABA;  |FINSI;
     |HAZ LeoCa8cumay;

     uno = dos % A104;
     #cacuebal#0 = uno;
     |LEE 040#cacuebal.=;
     |SI FSalida = 0;  |HAZ saca;  |ACABA;  |FINSI;
     |HAZ LeoCa8cumay;

     uno = dos % A103;
     #cacuebal#0 = uno;
     |LEE 040#cacuebal.=;
     |SI FSalida = 0;  |HAZ saca;  |ACABA;  |FINSI;
     |HAZ LeoCa8cumay;

     uno = dos % A102;
     #cacuebal#0 = uno;
     |LEE 040#cacuebal.=;
     |SI FSalida = 0;  |HAZ saca;  |ACABA;  |FINSI;
     |HAZ LeoCa8cumay;

     uno = dos % A101;
     #cacuebal#0 = uno;
     |LEE 040#cacuebal.=;
     |SI FSalida = 0;
         |HAZ saca;
     |SINO;
         |HAZ BuscaCa8;
     |FINSI;
 |FINSI;
 |LIBERA #0;
|FPRC;

|DEFBUCLE cambia;
   #0#1;
   ;
   desde;
   hasta;
   be;
   NULL, cuenta;
|FIN;

|PROCESO carecepi; |TIPO 3;
   |SI #carecepi#0 = "S";
      |ABRE #5;
      |ABRE #410;
      |BUCLE cambia;
      |CIERRA #410;
      |CIERRA #5;
   |FINSI;
|FPRC;

|PROGRAMA;
   aParam = PARAMETRO; |QBF aParam;
   |HAZ inicio;
   |SI aParam = "";
       |MANTE #10;
   |SINO;
       #10#0 = "S";
       |HAZ carecepi;
   |FINSI;
|FPRO;
