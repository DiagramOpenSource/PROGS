|FICHEROS;
     gadw0008,MANTE;

     calibros;
     caivases;

     :modelos/dsmom030;

     gadm0005@;
|FIN;

|VARIABLES;
     n0Vtn               = -1;
     nAnyo               = 0;
     nPorUno             = 0;
     nPorDos             = 0;

     aMas                = "";
     aAlfa               = "";
     aMensaje            = "";
     aFechaIVA           = "";
     aFij                = "";

     &efFechaIVA         = @;
     &enLineaIVA         = 0;
     &enPorcIVA          = 0;
     &eaCuenta           = "";
     &enEjercicio        = 0;
     &eOpSub             = 0;
     &enConcepto         = 0;
     &eaSubde            = "";
     &eaCodSubdep        = "";
     &eaNomSubdep        = "";
     &enQue              = 0;
     &enActividad        = 0;
     &aTipoIVA           = "";
     &eaSer              = "";
|FIN;

|PROCESO FinVnt0;
     |SI n0Vtn = -1;
         |ACABA;
     |FINSI;

     |FINVENTANA n0Vtn;
     n0Vtn = -1;
|FPRC;

|PROCESO T12w8;  |TIPO 12;
     |SI FSalida = 7;
         |HAZ FinVnt0;

         |ACABA;
     |FINSI;

     |SI FSalida = 1;
         |HAZ FinVnt0;

         aAlfa = #gadw0008#1;  |QBF aAlfa;
         |SI aAlfa = "";
             |MENAV "0000Serie vac¡a";
             |POSICIONATE #gadw0008#1;
             |ERROR;
             |ACABA;
         |FINSI;

         aAlfa = #gadw0008#2;  |QBF aAlfa;
         |SI aAlfa = "";
             |MENAV "0000Descripci¢n serie vac¡a";
             |POSICIONATE #gadw0008#2;
             |ERROR;
             |ACABA;
         |FINSI;

         aAlfa = #gadw0008#6;  |QBF aAlfa;
         |SI aAlfa = "";
             |MENAV "0000Contrapartida vac¡a";
             |POSICIONATE #gadw0008#6;
             |ERROR;
             |ACABA;
         |FINSI;

         |ACABA;
     |FINSI;

     |HAZ FinVnt0;
     |POSICIONATE #gadw0008#6;
|FPRC;

|PROCESO T66C14w8;  |TIPO 66;
     |ABRE #dsmom030;
     #dsmom030#0 = #gadw0008#14;
     |LEE 000#dsmom030.=;

     |CONSULTA_CLAVE #1#dsmom030;
     |SI FSalida = 0;
         #gadw0008#14 = #dsmom030#0;    |PINTA #gadw0008#14;
         #gadw0008#15 = #dsmom030#1;    |PINTA #gadw0008#15;
     |FINSI;
     |CIERRA #dsmom030;
|FPRC;

|PROCESO T0C14w8;  |TIPO 0;
     |SI #gadw0008#14 = 0;
         #gadw0008#15 = "";  |PINTA #gadw0008#15;
         |ACABA;
     |FINSI;

     |ABRE #dsmom030;
     #dsmom030#0 = #gadw0008#14;
     |LEE 000#dsmom030.=;
     |SI FSalida = 0;
         #gadw0008#14 = #dsmom030#0;    |PINTA #gadw0008#14;
         #gadw0008#15 = #dsmom030#1;    |PINTA #gadw0008#15;
     |SINO;
         |MENAV "0000El concepto no existe.";
         |ERROR;
     |FINSI;
     |CIERRA #dsmom030;
|FPRC;

|PROCESO T0C12w8;  |TIPO 0;
     |C_M #gadw0008#12, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |SI #gadw0008#12 = "000";  |O  #gadw0008#12 = "   ";
         |ACABA;
     |FINSI;

     eOpSub      = 0;
     enActividad = #gadw0008#3;
     enConcepto  = #gadw0008#8;
     eaCodSubdep = #gadw0008#12;
     |HAZ SubActividad;
     |SI enQue = 0;
         enQue = 1;
     |FINSI;
     |HAZ SubActividad;
     enQue = 0;

     #gadw0008#12 = eaCodSubdep;  |PINTA #gadw0008#12;
     #gadw0008#13 = eaNomSubdep;  |PINTA #gadw0008#13;
|FPRC;

|PROCESO T66C12w8;  |TIPO 66;
     |SI eaSubde = "N"; |ACABA; |FINSI;

     eOpSub      = 1;                            || 1 = Consulta pantalla
     enActividad = #gadw0008#3;
     enConcepto  = #gadw0008#8;
     eaCodSubdep = #gadw0008#12;
     |HAZ SubActividad;

     #gadw0008#12 = eaCodSubdep;  |PINTA #gadw0008#12;
     #gadw0008#13 = eaNomSubdep;  |PINTA #gadw0008#13;
|FPRC;

|PROCESO T0C11w8;  |TIPO 0;
     |SI #gadw0008#11 = 0;
         |POSICIONATE #gadw0008#6;

         |ACABA;
     |FINSI;

     |ABRE #calibros;
     |DDEFECTO #calibros;
     #calibros#0 = #gadw0008#2;
     |LEE 000#calibros.=;
     |CIERRA #calibros;
     |SI #calibros#2 = "N"; |ACABA; |FINSI;

     aTipoIVA    = #calibros#2;
     nAnyo       = 2000 + #48#26;
     enEjercicio = nAnyo;
     aFechaIVA   = "01.01." + nAnyo;
     efFechaIVA  = aFechaIVA;

     enLineaIVA = #gadw0008#11;
     |SI enLineaIVA ! 0;
         |HAZ SacaIVA;
         nPorDos = enPorcIVA;
     |FINSI;

     |SI enLineaIVA < 0;
          |MENAV "    Control de cuentas no definido";

          #gadw0008#11 = 0;  |PINTA #gadw0008#11;
          |ERROR;
          |ACABA;
     |FINSI;

     |SI #gadw0008#10 = 0; |ACABA; |FINSI;

     |SI #gadw0008#10 = #gadw0008#11;
         |MENAV "0000No es posible indicar el mismo tipo de IVA";

         #gadw0008#11 = 0;  |PINTA #gadw0008#11;
         |ERROR;
         |ACABA;
     |FINSI;

     enLineaIVA = #gadw0008#10;
     |HAZ SacaIVA;
     nPorUno = enPorcIVA;
     |SI nPorUno = nPorDos;
         aMensaje = "0000Ambos tipos de IVA tiene el mismo porcentaje : " + nPorUno + "%";
         |MENAV aMensaje;

         #gadw0008#11 = 0;  |PINTA #gadw0008#11;
         |ERROR;
         |ACABA;
     |FINSI;

     |POSICIONATE #gadw0008#6;
|FPRC;

|PROCESO T66C11w8;  |TIPO 66;
     |ABRE #calibros;
     |DDEFECTO #calibros;
     #calibros#0 = #gadw0008#2;
     |LEE 000#calibros.=;
     |CIERRA #calibros;
     aTipoIVA    = #calibros#2;

     |SI #calibros#2 = "N"; |ACABA; |FINSI;

     nAnyo       = 2000 + #48#26;
     enEjercicio = nAnyo;
     aFechaIVA   = "01.01." + nAnyo;
     efFechaIVA  = aFechaIVA;

     |HAZ SelecTipoIVA;
     #gadw0008#11 = enLineaIVA;
     |PINTA #gadw0008#11;
|FPRC;

|PROCESO T0C10w8;  |TIPO 0;
     |SI #gadw0008#10 = 0;
         |ACABA;
     |FINSI;

     |ABRE #calibros;
     |DDEFECTO #calibros;
     #calibros#0 = #gadw0008#0;
     |LEE 000#calibros.=;
     |CIERRA #calibros;

     |SI #calibros#2 = "N"; |ACABA; |FINSI;

     aTipoIVA    = #calibros#2;
     nAnyo       = 2000 + #48#26;
     enEjercicio = nAnyo;
     aFechaIVA   = "01.01." + nAnyo;
     efFechaIVA  = aFechaIVA;

     enLineaIVA = #gadw0008#10;
     |SI enLineaIVA = 0;
         |ACABA;
     |FINSI;

     |HAZ SacaIVA;
     nPorUno = enPorcIVA;

     |SI enLineaIVA < 0;
         |MENAV "    Control de cuentas no definido";

         #gadw0008#10 = 0;  |PINTA #gadw0008#10;

         |ERROR;
         |ACABA;
     |FINSI;

     |SI #gadw0008#11 = 0; |ACABA; |FINSI;

     |SI #gadw0008#10 = #gadw0008#11;
         |MENAV "0000No es posible indicar el mismo tipo de IVA";

         #gadw0008#10 = 0;  |PINTA #gadw0008#10;
         |ERROR;
         |ACABA;
     |FINSI;

     enLineaIVA = #gadw0008#11;
     |HAZ SacaIVA;
     nPorDos = enPorcIVA;
     |SI nPorUno = nPorDos;
         aMensaje = "0000Ambos tipos de IVA tiene el mismo porcentaje : " + nPorUno + "%";
         |MENAV aMensaje;
         #gadw0008#10 = 0;  |PINTA #gadw0008#10;
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO T66C10w8;  |TIPO 66;
     |ABRE #calibros;
     |DDEFECTO #calibros;
     #calibros#0 = #gadw0008#0;
     |LEE 000#calibros.=;
     |CIERRA #calibros;

     |SI #calibros#2 = "N"; |ACABA; |FINSI;

     aTipoIVA    = #calibros#2;
     nAnyo       = 2000 + #48#26;
     enEjercicio = nAnyo;
     aFechaIVA   = "01.01." + nAnyo;
     efFechaIVA  = aFechaIVA;

     |HAZ SelecTipoIVA;
     #gadw0008#10 = enLineaIVA;
     |PINTA #gadw0008#10;
|FPRC;

|PROCESO T66C8w8;  |TIPO 66;
     |ABRE #dsmom030;
     #dsmom030#0 = #gadw0008#8;
     |LEE 000#dsmom030.=;

     |CONSULTA_CLAVE #1#dsmom030;
     |SI FSalida = 0;
         #gadw0008#8 = #dsmom030#0;    |PINTA #gadw0008#8;
         #gadw0008#9 = #dsmom030#1;    |PINTA #gadw0008#9;
     |FINSI;
     |CIERRA #dsmom030;
|FPRC;

|PROCESO T0C8w8;  |TIPO 0;
     |ABRE #dsmom030;
     #dsmom030#0 = #gadw0008#8;
     |LEE 000#dsmom030.=;
     |SI FSalida = 0;
         #gadw0008#8 = #dsmom030#0;    |PINTA #gadw0008#8;
         #gadw0008#9 = #dsmom030#1;    |PINTA #gadw0008#9;
     |SINO;
         |MENAV "0000El concepto no existe.";
         |ERROR;
     |FINSI;
     |CIERRA #dsmom030;
|FPRC;

|PROCESO T6C6w8;  |TIPO 6;
     eaCuenta = #gadw0008#6;
     |HAZ FiltraPuntos;
     #gadw0008#6 = eaCuenta;    |PINTA #gadw0008#6;

     |SI #gadw0008#6 = "            ";
         |MENAV "0000Introduzca una cuenta";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO T7C4w8;  |TIPO 7;
     |ABRE #calibros;
     #calibros#0 = #gadw0008#0;
     |LEE 000#calibros.=;
     |SI FSalida ! 0;  |DDEFECTO #calibros;  |FINSI;
     |CIERRA #calibros;

     aTipoIVA    = #calibros#2;
     #gadw0008#4 = #calibros#1;   |PINTA #gadw0008#4;
     #gadw0008#5 = #calibros#2;   |PINTA #gadw0008#5;
|FPRC;

|PROCESO T7C2w8;  |TIPO 7;
     eaSer = #gadw0008#1;
     |HAZ ConstruyeSerie;

     |ABRE #caivases;
     #caivases#0 = eaSer;
     #caivases#1 = #gadw0008#5;
     |LEE 000#caivases.=;
     |SI FSalida ! 0;  |DDEFECTO #caivases;  |FINSI;
     |CIERRA #caivases;

     aAlfa = #caivases#2;  |QBF aAlfa;
     |SI aAlfa = "";
         |ACABA;
     |FINSI;

     #gadw0008#2 = #caivases#2;    |PINTA #gadw0008#2;
|FPRC;

|PROCESO T0C1w8;  |TIPO 0;
     |HAZ FinVnt0;

     |C_M #gadw0008#1, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |DDEF aMas;
     aMas = aMas + "gadm0005.mas";
     |CARGA_DEF aMas, gadm0005@;

     |ABRE #gadm0005@;
     |SELECT #1#gadm0005@;
     #gadm0005@#0 = #gadw0008#0;
     #gadm0005@#1 = #gadw0008#1;
     |LEE 000#gadm0005@.=;
     |SI FSalida = 0;
         |MENAV "0000La serie ya est  introducida en este tipo de libro";
         |ERROR;
     |FINSI;
     |CIERRA #gadm0005@;
     |DESCARGA_DEF #gadm0005@;
|FPRC;

|PROCESO T66C1w8;  |TIPO 66;
     |ABRE #caivases;
     |CONSULTA_CLAVE #1#caivases;
     |SI FSalida = 0;
         #gadw0008#1 = #caivases#0;    |PINTA #gadw0008#1;
     |FINSI;
     |CIERRA #caivases;
|FPRC;

|PROCESO T7C1w8;  |TIPO 7;
     |VENTANA 1226, 2177, -1, 1, "";
     n0Vtn = FSalida;

     |CONTROL_SIMPLE 0, "LABEL,{{15}}                   Series acabadas en XX                ", 1330, 1397, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{11}}- Se crear  autom ticamente en gesti¢n y contabilidad   ", 1530, 1597, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{11}}sustituyendo el XX por el ejercicio en curso            ", 1630, 1697, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{11}}- En la creaci¢n de un nuevo periodo de contabilidad se ", 1830, 1897, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{11}}crear  las series en gesti¢n y en contabilidad con el   ", 1930, 1997, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{11}}nuevo ejercicio.                                        ", 2030, 2097, NULL;

     |PTEC 802;  |PAUSA;
|FPRC;
