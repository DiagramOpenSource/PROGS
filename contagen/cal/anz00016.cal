|FICHEROS;
   anz00016 #0;
   cacuenta #1;

   canempre #30;
   caselemz #911;

   anz00015 #99;
|FIN;

|VARIABLES;
   nInkey = 0;
   cta = 0;
   long = "";
   sw = 0;
   aAlfa1 = "";


   &ext1 = "";
   &ext2 = "";
   &runnom = "anz00016";
   &espe1 = @;
   &espe2 = @;
   &espe3 = 0;
   &espe4 = 0;
   &espe5 = "";
   &espe6 = "";
   &espe7 = 0;
   &espe8 = 0;
   &espe9 = 0;
   alfa1 = "";
   &sino = "",
   &espe10 = "";
   &espe11 = "";
   &espe15 = "";
   &espe16 = 0;
   &espe18 = "";
   &espe19 = "";
   &espe20 = 0;
   &espe21 = 0;
   &espe22 = "";

   &enEmpOrg = 0;
   &enPerOrg = 0;
   &eaFEmp   = "";
   &swVarios = 0;
   &eaMonOrg = "";
|FIN;

|INCLUYE dscont_i;
|INCLUYE dscoan_i;
|INCLUYE digana_i;

|CALCULO recoge; |TIPO 7;
   |SI #0#14 = "N";
       #0#2 = fec1;
   |SINO;
       #0#2 = "01.01.2000";
   |FINSI;
   |PINTA #0#2;
   #0#3 = fec2; |PINTA #0#3;
|FCAL;

|CALCULO cuenta; |TIPO 6;
     eaCuenta = #0Campo;
     salidas  = FSalida;
     |HAZ FiltraPuntos;
     #0Campo = eaCuenta;
     |PINTA #0Campo;
|FCAL;

|CALCULO cuefin; |TIPO 0;
   eaCuenta = #0Campo;
   |SI eaCuenta = "            ";
       |ERROR;
       |ACABA;
   |FINSI;
   emCta    = 1;
   eaCuenta = #0Campo;
   |HAZ SacaNivel;
   |SI eswCta ! 0;  |ACABA; |FINSI;  ||Cuenta erronea
   |HAZ LeeCuenta;
   |SI eswCta = 0;
       #0#1 = #cacuenta#2; |PINTA #0#1;
   |FINSI;
|FCAL;

|CALCULO fechas; |TIPO 0;
   |SI #0#14 = "N";
       |SI #0Campo > fec2;|O #0Campo < fec1;
           |MENAV "    Fecha fuera de Periodo ...";
           |ERROR;
           |ACABA;
       |FINSI;
   |FINSI;
   |SI Campo = 3;
       |SI #0#2 > #0#3;
           |MENAV "    Fechas erroneas";
           |ERROR;
       |FINSI;
   |FINSI;
|FCAL;

|CALCULO no_dep; |TIPO 7;
   |CAMPO_MODIFICA #0#6, 1, eaDepar;
   |CAMPO_MODIFICA #0#7, 1, eaDepar;
|FCAL;

|CALCULO nosubde; |TIPO 7;
   |CAMPO_MODIFICA #0#12, 1, eaSubde;
   |CAMPO_MODIFICA #0#13, 1, eaSubde;
|FCAL;

|CALCULO SalAnt; |TIPO 7;
||    |SI #0#14 = "S"; |O #0#15 ! 0;
||        |C_M #0#11,1,"N";
||        #0#11 = "N";
||        |PINTA #0#11;
||    |SINO;
||        |C_M #0#11,1,"S";
||    |FINSI;
|FCAL;

|CALCULO engancha; |TIPO 3;
   sino = "S"; |SI #0#11 = "N"; sino = "N"; |FINSI;

   ext1  = #0#0;         || cuenta
   ext2  = #0#1;         || digito
   espe1 = #0#2;        || desde fecha
   espe2 = #0#3;        || hasta fecha
   espe3 = #0#4;        || desde concepto
   espe4 = #0#5;        || hasta concepto
   espe5 = #0#6;        || desde departamento
   espe6 = #0#7;        || hasta departamento
   espe7 = #0#8;        || tipo de Informe
   espe8 = #0#9;        || desde Diario
   espe9 = #0#10;       || hasta Diario
   espe10 = #0#12;      || desde subdepartamento
   espe11 = #0#13;      || hasta subdepartamento
   espe15 = #0#14;
   espe16 = #0#15;
   espe18 = #0#16;
   espe19 = #0#17;
   espe20 = #0#18;
   espe21 = #0#19;
   espe22 = #0#20;

   |SUB_EJECUTA_NP "anz00015;NOMEQUITESQUETECORTOLOSGUEVOS";

   |PULSATECLA;
|FCAL;

|CALCULO LeePlanilla; |TIPO 6;
 |ABRE #911;
 #911#0 = #0#15;
 |LEE 001#911=;
 |SI FSalida ! 0; |Y #0#15 = 0;
     |DDEFECTO #911;
     #911#0 = 0;
     #911#1 = "Empresa Actual";
     |GRABA 020#911n;
 |FINSI;
 |CIERRA #911;
|FCAL;

|PROGRAMA;

 |CLS;
 |CABEZA "Extractos Contables Analitica";

 |HAZ DirAplicSt;
 |HAZ inicio;
 |HAZ Analitica;
 |SI  enSwAna = 0;
      aAlfa1 = "    CONTABILIDAD NO ANALITICA ";
      |SI eaAnNiv = "E";
          aAlfa1 = "    EMPRESA NO ANALITICA ";
      |FINSI;
      |MENAV aAlfa1;
      |ACABA;
 |FINSI;

 enEmpOrg = enEmpresa;
 enPerOrg = enPeriodo;
 |DFICE eaFEmp;
 eaMonOrg = eaMoneda;

 |DDEFECTO #0;
 |ABRE #99;
 |DDEFECTO #99;
 |LEE 041#99p;
 |CIERRA #99;

 |DDEFECTO #0;
 #0#8 = #99#9;
 FSalida = 0;
 |PARA;|SI FSalida = 0; |HACIENDO;
        sw = 0;
        |CLS;
        |PINPA #0#0;
        |PINDA #0#0;                    || Pinta los datos por defecto
        |ENDATOS #1#0;                  || Seleccion informe
        nInkey = FSalida;

        cod1 = enEmpOrg;
        cod2 = enPerOrg;
        emEmp = 1;  || Sin mensaje
        |HAZ leelo;

        |PATH_DAT #1 eaFEmp;
        #0#2 = espe1;
        #0#3 = espe2;
        FSalida = nInkey;
 |SIGUE;
|FPRO;
