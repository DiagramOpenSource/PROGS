|FICHEROS;
     capcez03 #0;
     capcem01 #1;
     camaasil #2;
     camaniva #3;
     cacuenta #4;
     caclipro #5;
|FIN;

|VARIABLES;
     aAlfa = "";
     aCta = "";
|FIN;

|PROCESO capcem01;
     aAlfa = #1#10; |QBF aAlfa;
     aAlfa = aAlfa % 103;
     |SI aAlfa = "430";
          aCta = "430" + #1#0;
          #1#10 = aCta;
          |GRABA 020#1a;
     |FINSI;
|FPRC;

|DEFBUCLE capcem01;
     #1#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, capcem01;
|FIN;

|PROCESO cacuenta;
     #1#10 = #4#0;
     |LEE 000#1=;
     |SI FSalida = 0;
          aCta = "430" + #1#0;

          |BORRA 020#4a;
          #4#0 = aCta;
          |GRABA 000#4n;
          |SI FSalida ! 0;
               |BORRA 020#4c;
               |GRABA 020#4n;
          |FINSI;
          |SI FSalida = 0;
               #5#23 = "C";
               #5#10 = #1#10;
               |LEE 101#5=;
               |SI FSalida = 0;
                    |BORRA 020#5a;
                    #5#10 = aCta;
                    |GRABA 000#5n;
                    |SI FSalida ! 0;
                         |BORRA 020#5c;
                         |GRABA 020#5n;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE cacuenta;
     #4#1;
     ;
     "430         ";
     "430zzzzzzzzz";
     be;
     NULL, cacuenta;
|FIN;

|PROCESO camaasil;
     aAlfa = #2#16; |QBF aAlfa;
     aAlfa = aAlfa % 103;
     |SI aAlfa = "430";
          #1#10 = #2#16;
          |LEE 000#1=;
          |SI FSalida = 0;
               aCta = "430" + #1#0;

               #2#16 = aCta;
               |GRABA 020#2a;


               #3#7 = #2#0;
               #3#8 = #2#1;
               #3#9 = #2#2;
               |LEE 101#3=;
               |SI FSalida = 0;
                    #3#12 = aCta;
                    |GRABA 020#3a;
                    |LIBERA #3;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE camaasil;
     #2#1;
     ;
     00, "01.01.0000", 000001, 0001;
     99, "31.12.9999", 999999, 9999;
     be;
     NULL, camaasil;
|FIN;

|PROCESO T3; |TIPO 3;
     |SI #0#0 = "S";
          |ABRE #1;
          |ABRE #3;
          |SELECT #2#1;
          |SELECT #2#3;
          |BUCLE camaasil;
          |CIERRA #3;
          |CIERRA #1;
     |FINSI;
     |SI #0#1 = "S";
          |ABRE #1;
          |ABRE #5;
          |SELECT #2#1;
          |BUCLE cacuenta;
          |CIERRA #5;
          |CIERRA #1;
     |FINSI;
     |SI #0#2 = "S";
          |BUCLE capcem01;
     |FINSI;
|FPRC;
