|FICHEROS;
  ca8m0000 #0;
  ca8m0021 #1,MANTE;
  ca8m0022 #2,MANTE;
  ca8z0009 #10;

  ca8cumay #20;
  caagrupa #21;
  cacuenta #22;
  cacuebal #23;

  ca8m0001 #421;
  ca8m0002 #422;
|FIN;

|VARIABLES;
  &entrada  = 1;
  &nBalance = 0;
  &aLucrat  = "";
  nModo     = 0;
  nCopia    = 0;
  inkey     = 0;
  esalta    = 0;
  esaltaL   = 0;
  nSwSal    = 0;

  aAlfa1    = "";
  aAlfa2    = "";
  nNume1    = 0;
  nNume2    = 0;
  nBorro    = 0;
  aDesde    = "";
  aHasta    = "";
  nDesde    = 0;
  nHasta    = 0;
  nInkey    = 0;
  aAlfa     = "";
|FIN;

|INCLUYE dscont_i;

**************************************************************************
|RUTINA ClaveBajaL;
     #2#14 = #1#14;
     #2#0  = #1#0;
     #2#1  = #1#1;
     #2#2  = #1#2;
     #2#3  = #1#3;
     #2#4  = #1#4;
     #2#5  = #1#5;
     #2#6  = #1#6;
     #2#7  = #1#7;
     #2#12 = #1#10;
     #2#8  = 001;
|FRUT;

|RUTINA ClaveAltaL;
     #2#14 = #1#14;
     #2#0  = #1#0;
     #2#1  = #1#1;
     #2#2  = #1#2;
     #2#3  = #1#3;
     #2#4  = #1#4;
     #2#5  = #1#5;
     #2#6  = #1#6;
     #2#7  = #1#7;
     #2#12 = #1#10;
     #2#8  = 999;
|FRUT;

|RUTINA min9;
  |SI FSalida = "POSICION";
      #421#0  = #1#0;
      #421#1  = #1#1;
      #421#2  = #1#2;
      #421#3  = #1#3;
      #421#4  = #1#4;
      #421#5  = #1#5;
      #421#6  = #1#6;
      #421#7  = #1#7;
      #421#10 = #1#10;
      #421#14 = #1#14;
  |SINO;
     #421#14 = #10#4;
     #421#0  = #10#2;
     #421#1  = #10#0;
     #421#2  = 0;
     #421#3  = " ";
     #421#4  = 00;
     #421#5  = 0;
     #421#6  = 00;
     #421#7  = 00;
     #421#10  = 0;
     |SI nBalance = 0;
         #421#2 = 0;
         #421#3 = "A";
     |FINSI;
     |SI nBalance = 1;
         #421#2 = 1;
         #421#3 = "R";
     |FINSI;
     |SI nBalance = 2;
         #421#2 = 6;
         #421#3 = "E";
     |FINSI;
 |FINSI;
|FRUT;

|RUTINA max9;
  #421#14 = #10#4;
  #421#0  = #10#2;
  #421#1  = #10#0;
  #421#2  = 9;
  #421#3  = "z";
  #421#4  = 99;
  #421#5  = 9;
  #421#6  = 99;
  #421#7  = 99;
  #421#10 = 9;
  |SI nBalance = 0;
      #421#2 = 0;
      #421#3 = "P";
  |FINSI;
  |SI nBalance = 1;
      #421#2 = 5;
      #421#3 = "R";
  |FINSI;
  |SI nBalance = 2;
      #421#2 = 6;
      #421#3 = "E";
  |FINSI;
|FRUT;

**************************************************************************
|PROCESO CopioCtas;
 #2#14= #422#14;
 #2#0 = #422#0;
 #2#1 = #422#1;
 #2#2 = #422#2;
 #2#3 = #422#3;
 #2#4 = #422#4;
 #2#5 = #422#5;
 #2#6 = #422#6;
 #2#7 = #422#7;
 #2#8 = #422#8;
 #2#9 = #422#9;
 #2#10 = #422#10;
 #2#11 = #422#11;
 #2#12 = #422#12;
 #2#13 = #422#13;
 |GRABA 040#2n;
|FPRC;

|DEFBUCLE Copiom002;
 #422#1;
 ;
 #1#14, #1#0, #1#1, #1#2, #1#3, #1#4, #1#5, #1#6, #1#7, #1#10, 001;
 #1#14, #1#0, #1#1, #1#2, #1#3, #1#4, #1#5, #1#6, #1#7, #1#10, 999;
 e;
 NULL, CopioCtas;
|FIN;


**************************************************************************
|CALCULO Defectos; |TIPO 7;
   |SI nBalance = 0;
       aAlfa = "0000(T) Total Grupo, (C) Cuentas, (A) Linea de Texto ";
   |FINSI;
   |SI nBalance = 1;
       aAlfa = "0000(T) Total Grupo, (S) Suma, (C) Cuentas, (A) Linea de Texto ";
   |FINSI;
   |SI nBalance > 1;
       aAlfa = "0000(T) Total Grupo, (S) Suma, (C) Cuentas, (A) Linea de Texto ";
   |FINSI;
   |MENSA aAlfa;

 nModo = (FEntrada / 100) ! 0;
 |SI nModo = 1;
     |ABRE #421;
     #421#14= #1#4;
     #421#0 = #1#0;
     #421#1 = #1#1;
     #421#2 = #1#2;
     #421#3 = #1#3;
     #421#4 = #1#4;
     #421#5 = #1#5;
     #421#6 = #1#6;
     #421#7 = #1#7;
     #421#10 = #1#10;
     |LEE 001#421=;
     |SI FSalida = 0;
         #1#8  = #421#8;  |PINTA #1#8;
         #1#9  = #421#9;  |PINTA #1#9;
         #1#11 = #421#11; |PINTA #1#11;
         #1#12 = #421#12; |PINTA #1#12;
     |FINSI;
     |CIERRA #421;
 |FINSI;
|FCAL;

|CALCULO LosDef2; |TIPO 0;
  |BLIN 4;
  |SI nBalance = 0; |Y #1#8 = "S";
      |ERROR;
  |FINSI;
  |SI #1#8 = "C"; |Y nModo = 1;
      |ABRE #2;
      |BUCLE Copiom002;
      |CIERRA #2;
  |FINSI;
|FCAL;

|CALCULO descri1; |TIPO 0;
    |HAZ PresentaLinea;
|FCAL;

|PROCESO BorraLineas;
     |BORRA 140#2a;
     |LIBERA #2;
|FPRC;

|DEFBUCLE ca8m0022;
     #2#1;
     ;
     #1#14, #1#0, #1#1, #1#2, #1#3, #1#4, #1#5, #1#6, #1#7, #1#10, 000;
     #1#14, #1#0, #1#1, #1#2, #1#3, #1#4, #1#5, #1#6, #1#7, #1#10, 999;
     be;
     NULL, BorraLineas;
|FIN;

|CALCULO Tipo2_1;  |TIPO 2;
     esalta  = (FEntrada / 100) ! 0;
     |SI esalta ! 3;  |ACABA;  |FINSI;
     |BUCLE ca8m0022;
|FCAL;

||************************************************************************
|CALCULO elTipo3; |TIPO 3;
  |SI nBalance = 0; #1#2 = 0;   |FINSI;
  |SI nBalance = 1; #1#3 = "R"; |FINSI;
  |SI nBalance = 2; #1#2 = 6; #1#3 = "E";  #1#10 = 0; |FINSI;
  |SI nBalance = 4; #1#2 = 7;   |FINSI;
  #1#0 = #10#2;
  #1#1 = #10#0;
  #1#14 = #10#4;
  esalta  = (FEntrada / 100) ! 0;
  |SI FSalida = 0;
     |SI #1#8 = "C";
         nSwSal = 0;
         |ENTLINEAL #1#2, -11, 2, 15, 0, ClaveBajaL, ClaveAltaL;
     |SINO;
         nBorro = 0;
         |ABRE #2;
         #2#0  = #1#0; #2#1 = #1#1;
         #2#2  = #1#2; #2#3 = #1#3;
         #2#4  = #1#4; #2#5 = #1#5;
         #2#6  = #1#6; #2#7 = #1#7;
         #2#12 = #1#10; #2#14 = #1#14;
         #2#8  = 001;
         |LEE 041#2];
         |SI FSalida = 0; |Y #2#0 = #1#0; |Y #2#1 = #1#1; |Y #2#2 = #1#2; |Y #2#3 = #1#3;
             |Y #2#4 = #1#4; |Y #2#5 = #1#5; |Y #2#6 = #1#6; |Y #2#7 = #1#7; |Y #2#12 = #1#10;
                |Y #2#14 = #1#14;
             |CONFI "    SBorro Relacion de Ctas posibles ";
             |SI FSalida = 0;
                 nBorro = 1;
             |FINSI;
         |FINSI;
         |CIERRA #2;
         |SI nBorro = 1;
             |BUCLE ca8m0022;
         |FINSI;
     |FINSI;
 |FINSI;
|FCAL;

|CALCULO PresentaLinea;  |TIPO 7;
    |SI Campo = 2; |Y nBalance ! 1; |ACABA; |FINSI;
    |SI Campo = 3;
        |SI nBalance ! 0; |Y nBalance ! 4; |ACABA; |FINSI;
        |SI nBalance = 0;
            |MENSA "    Tipo Cta: A = Activo, P = Pasivo";
        |SINO;
            |MENSA "    Apartado A, B, C, D, E";
        |FINSI;
    |FINSI;
    |SI Campo = 4; |Y nBalance ! 2; |ACABA; |FINSI;
    nSwSal = 1;
    |ENTLINEAL #1#2, -11, 7, 15, 0, ClaveBajaL, ClaveAltaL;

    |SI nBalance = 0;
        |ENTLINEAL #1#421, -5, 7, 22, 0, min9, max9;
    |FINSI;
    |SI nBalance = 1;
        |ENTLINEAL #1#421, -4, 7, 22, 0, min9, max9;
    |FINSI;
    |SI nBalance = 2;
        |ENTLINEAL #1#421, -6, 7, 22, 0, min9, max9;
    |FINSI;
|FCAL;

|CALCULO elTipo11; |TIPO 11;
  nInkey = FSalida;
  |SI nInkey = 10;
      |SI nBalance = 0;
          |ENTLINEAL #1#421, -5, 4, 22, 0, min9, max9;
      |FINSI;
      |SI nBalance = 1;
          |ENTLINEAL #1#421, -4, 4, 22, 0, min9, max9;
      |FINSI;
      |SI nBalance = 2;
          |ENTLINEAL #1#421, -6, 4, 22, 0, min9, max9;
      |FINSI;
      nCopia = 1;
      |PTEC 825;
      |ERROR;
      |ACABA;
  |FINSI;
  |SI nInkey = 11; |Y nCopia = 1;
      nCopia = 0;
      #1#14= #421#14;
      #1#2 = #421#2; |PINTA #1#2;
      #1#3 = #421#3; |PINTA #1#3; |C_M #1#3, 0, aAlfa1; |SI aAlfa1 = "S"; |PTEC 802; |FINSI;
      #1#4 = #421#4; |PINTA #1#4; |C_M #1#4, 0, aAlfa1; |SI aAlfa1 = "S"; |PTEC 802; |FINSI;
      #1#5 = #421#5; |PINTA #1#5; |C_M #1#5, 0, aAlfa1; |SI aAlfa1 = "S"; |PTEC 802; |FINSI;
      #1#6 = #421#6; |PINTA #1#6; |C_M #1#6, 0, aAlfa1; |SI aAlfa1 = "S"; |PTEC 802; |FINSI;
      #1#7 = #421#7; |PINTA #1#7; |C_M #1#7, 0, aAlfa1; |SI aAlfa1 = "S"; |PTEC 802; |FINSI;
      #1#10 = #421#10; |PINTA #1#10; |C_M #1#10, 0, aAlfa1;
      #1#11 = #421#11; |PINTA #1#11;
  |FINSI;
|FCAL;


|CALCULO Campo3_0; |TIPO 0;
  |C_M #1#3, 0, aAlfa1;
  |SI aAlfa1 = "N"; |ACABA; |FINSI;

  |SI #1#1 = 0;
      |SI #1#3 ! "A"; |Y #1#3 ! "P"; |ERROR; |FINSI;
  |FINSI;
  |SI #1#1 = 4;
      |SI #1#3 ! "A"; |Y #1#3 ! "B"; |Y #1#3 ! "C";
        |Y #1#3 ! "D"; |Y #1#3 ! "E";
        |ERROR;
      |FINSI;
  |FINSI;
|FCAL;

|CALCULO elTipo13; |TIPO 13;
   aAlfa1 = "          ";
   |SI #1#1 = 0; |Y #1#3 = "A"; aAlfa1 = "(ACTIVO)  "; |FINSI;
   |SI #1#1 = 0; |Y #1#3 = "P"; aAlfa1 = "(PASIVO)  "; |FINSI;
   |SI #1#1 = 2;                aAlfa1 = "ESTADO    "; |FINSI;
   |SI #1#1 = 1;                aAlfa1 = "RESULTADO "; |FINSI;
   |ATRI I; |PINTA 0726,aAlfa1; |ATRI 0;
|FCAL;

|| ************************************************************************
|CALCULO SalgoYa;  |TIPO 7;
   |SI nSwSal = 1;  |PTEC 807;  |FINSI;
|FCAL;

|RUTINA min20;
  #20#12 = #10#4;
  #20#10 = 0;
  #20#0  = "     ";
  #20#2 = nDesde;
  #20#3 = aDesde;
  #20#5 = 00;
|FRUT;

|RUTINA max20;
  #20#12 = #10#4;
  #20#10 = 0;
  #20#0 = "zzzzz";
  #20#2 = nHasta;
  #20#3 = aHasta;
  #20#5 = 99;
|FRUT;

|CALCULO Tipo0_L; |TIPO 0;
  inkey = FSalida;
  |SI inkey = 10;
      aDesde = #1#3; aHasta = #1#3;
      nDesde = 0;    nHasta = 0;
      |SI nBalance = 1; aDesde = "D"; aHasta = "P"; nDesde = 1; nHasta = 5; |FINSI;
      |SI nBalance = 2; aDesde = "G"; aHasta = "I"; nDesde = 6; nHasta = 6; |FINSI;
      |SI aLucrat = "S";
          aDesde = " "; aHasta = "Z"; nDesde = 0; nHasta = 9;
      |FINSI;
      |ABRE #20;
      |CONSULTA_F_CLAVE #4#20, min20, max20;
      |CIERRA #20;
      #2#9  = #20#0;  |PINTA #2#9;
      #2#10 = #20#11; |PINTA #2#10;
  |FINSI;

  aAlfa1 = #2#9; |QBF aAlfa1;
  |SI aAlfa1 = ""; |ERROR; |FINSI;

  aAlfa1 = #2#9 % A101;
  |SI nBalance ! 4; |Y aLucrat ! "S";
      |SI aAlfa1 = "6"; |O aAlfa1 = "7";
           |SI #1#2 < 1; |O #1#2 > 5;
              |AVISO;
              |ERROR;
           |FINSI;
       |SINO;
           |SI aAlfa1 = "8"; |O aAlfa1 = "9";
               |SI #1#2 ! 6;
                   |AVISO; |ERROR;
               |FINSI;
           |SINO;
               |SI #1#2 ! 0; |Y #1#3 ! "A"; |Y #1#3 ! "P";
                   |AVISO; |ERROR;
              |FINSI;
           |FINSI;
       |FINSI;
   |FINSI;

   esaltaL = (FEntrada / 100) ! 0;
   |SI esaltaL = 1;
       |SI #1#3 = "A"; #2#10 = "+"; |FINSI;
       |SI #1#3 = "P"; #2#10 = "-"; |FINSI;
       |PINTA #2#10;
   |FINSI;
|FCAL;
