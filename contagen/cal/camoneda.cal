|FICHEROS;
 camoneda #130;
|FIN;

|VARIABLES;
 &EURO = 1;
 &EURODB = 0;
 &EURODV = 0;
 &EUROTEXTO = "Cambio de Moneda";
 &swOperacion = 0;  || 0 = Lectura / 1 = Alta / 2 = Baja / 3 = Regrabar
 &enEmpresa = 0;
 &enPeriodo = 0;
 &eaMoneda  = "";
 estado = 0;
|FIN;

|PROCESO tipo12; |TIPO 12;
 || para que no pida conforme
|FPRC;

|PROGRAMA;
 |ABRE #camoneda;
 #camoneda#0 = enEmpresa;
 #camoneda#1 = enPeriodo;
 |LEE 101#camoneda.=;
 estado = FSalida;
                                                 || Lectura
 |SI swOperacion = 0;
     |SI estado ! 0;       || ... No existe registro, graba defecto 'Euros'
         #camoneda#0 = enEmpresa;
         #camoneda#1 = enPeriodo;
         #camoneda#2 = "E";  ||Defecto Pesetas
         |GRABA 020#camoneda.n;
     |FINSI;
 |FINSI;
                                     || Grabar registro
 |SI swOperacion = 1;
     |PINPA #0#camoneda;
     |PINDA #0#camoneda;
     |SI estado = 0;       || Si existe ya, solo Pinta en Pantalla
        |PINTA #camoneda#2;
        |MENAV "    La Empresa Ya tiene la Moneda Base Definida !";
     |SINO;
        #camoneda#0 = enEmpresa;
        #camoneda#1 = enPeriodo;
        |ENDATOS #1#camoneda;
        #camoneda#0 = enEmpresa;
        #camoneda#1 = enPeriodo;
        |GRABA 020#camoneda.n;
     |FINSI;
 |FINSI;
                                      ||Borrar
 |SI swOperacion = 2;
    |SI estado = 0;       || Si existe ya
        |BORRA 020#camoneda.a;
    |FINSI;
 |FINSI;

 |SI swOperacion = 3;      ||Regrabar o Grabar
     #camoneda#2 = eaMoneda;
     |SI estado = 0;       || Si existe ya
        |GRABA 020#camoneda.a;
     |SINO;
        #camoneda#0 = enEmpresa;
        #camoneda#1 = enPeriodo;
        |GRABA 020#camoneda.n;
     |FINSI;
 |FINSI;

 |SI swOperacion = 4;
     |PINPA #0#camoneda;
     |PINDA #0#camoneda;
     |SI estado = 0;       || Si existe ya, solo Pinta en Pantalla
        |PINTA #camoneda#2;
        |MENSA "    La Empresa Ya tiene la Moneda Base Definida !";
        |ENDATOS #2#camoneda;
        |GRABA 020#camoneda.a;
     |SINO;
        #camoneda#0 = enEmpresa;
        #camoneda#1 = enPeriodo;
        |ENDATOS #1#camoneda;
        #camoneda#0 = enEmpresa;
        #camoneda#1 = enPeriodo;
        |GRABA 020#camoneda.n;
     |FINSI;
 |FINSI;


 eaMoneda = #camoneda#2;
     |SI eaMoneda = "P";                  || pesetas
          EURO = 1 / 166.386;
          EURODB = 0;
          EURODV = 2;
     |FINSI;
     |SI eaMoneda = "E";                  || euros
          EURO = 166.386;
          EURODB = 2;
          EURODV = 0;
     |FINSI;
 |LIBERA #camoneda;
 |CIERRA #camoneda;
|FPRO;
