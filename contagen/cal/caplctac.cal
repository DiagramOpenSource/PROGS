|INCLUYE dscont_i;
|FICHEROS;
   caplctac #0;
   caplctal #1;
   caconlib #2;
|FIN;;

|VARIABLES;
   &entrada = 1;
   alfa1 = "";
   alfa2 = ""
   alfa3 = ""
   modo = 0;
   salida = 0;
   p = 0;
   x = 0;
   y = 0;
   z = 0;
   as = "*";
   linea = 0;
   &lib = 0;
   &descripcion = "";
|FIN;

|PROCESO baja; |TIPO 1;
   modo = (FEntrada / 100) ! 0;
   |SI modo = 3;
      |ABRE #2;
      #caconlib#0 = #caplctac#0;
      |BORRA 040#2c;
      |CIERRA #2;
   |FINSI;
|FPRC;

|PROCESO leecol; |TIPO 0;
   lib= #caplctac#0;
   descripcion= #caplctac#1;
   salida = FSalida;
   modo = (FEntrada / 100) ! 0;
   |SI modo = 1; |O salida = 9;
      |SUB_EJECUTA "caconlib";
   |FINSI;
   |ABRE #2;
   |DDEFECTO #2;
   #caconlib#0 = #caplctac#0;
   |LEE 040#2=;
   |CIERRA #2;
|FPRC;

|| ************************ Campos de las L¡neas.

|PROCESO defec1; |TIPO 0;
   salida = FSalida;
   |SI salida = 9;
      |HAZ leecol_li;
      |ERROR;
      |ACABA;
   |FINSI;
   modo = (FEntrada / 100) ! 0;
   |SI modo ! 1; |ACABA; |FINSI;
   alfa2 = #caplctal#2 % 101;
   #caplctal#3 = "R";
   #caplctal#7 = "D";
   |SI alfa2 = "6";  #caplctal#3 = "G"; #caplctal#7 = "D"; #caplctal#4 = "S"; |FINSI;
   |SI alfa2 = "7";  #caplctal#3 = "I"; #caplctal#7 = "H"; #caplctal#4 = "S"; |FINSI;
   |SI alfa2 = "2";  #caplctal#3 = "V"; #caplctal#7 = "D"; #caplctal#4 = as; |FINSI;
   |SI alfa2 = "4";  #caplctal#3 = "R"; #caplctal#7 = as; #caplctal#4 = "D"; |FINSI;
   |PINTA #caplctal#3;
   |HAZ descri;
   |PINTA #caplctal#7;
|FPRC;

|PROCESO mayus;
   alfa1 = #caplctal#Campo# > " ";
   #caplctal#Campo# = alfa1;
   |PINTA #caplctal#Campo#;
|FPRC;

|PROCESO descri;
   salida = FSalida;
   |SI salida = 9;
      |HAZ leecol_li;
      |ERROR;
      |ACABA;
   |FINSI;
   |HAZ mayus;
   |SI #caplctal#3 = "I"; #caplctal#5 = "(Ingresos)   "; |FINSI;
   |SI #caplctal#3 = "G"; #caplctal#5 = "(Gastos)     "; |FINSI;
   |SI #caplctal#3 = "V"; #caplctal#5 = "(Inversion)  "; |FINSI;
   |SI #caplctal#3 = "R"; #caplctal#5 = "(Retenciones)"; |FINSI;
   |SI #caplctal#3 = "S"; #caplctal#5 = "(Suplidos)   "; |FINSI;
   |PINTA #caplctal#5;
   
   |CAMPO_MODIFICA #caplctal#4,1,"S";
   |CAMPO_MODIFICA #caplctal#6,1,"S";
   |CAMPO_MODIFICA #caplctal#7,1,"S";

   |SI #caplctal#3 = "V";
      |CAMPO_MODIFICA #caplctal#4,1,"N";
      |CAMPO_MODIFICA #caplctal#6,1,"N";
      #caplctal#4 = as; |PINTA #caplctal#4;
      #caplctal#6 = 1;  |PINTA #caplctal#6;
   |FINSI;
   |SI #caplctal#3 = "R";
      |CAMPO_MODIFICA #caplctal#6,1,"N";
      |CAMPO_MODIFICA #caplctal#7,1,"N";
      #caplctal#7 = as; |PINTA #caplctal#7;
      #caplctal#6 = 1;  |PINTA #caplctal#6;
   |FINSI;
   |SI #caplctal#3 = "S";
      |CAMPO_MODIFICA #caplctal#4,1,"N";
      #caplctal#4 = as; |PINTA #caplctal#4;
   |FINSI;
|FPRC;

|PROCESO mayus1;
   salida = FSalida;
   |SI salida = 9;
      |HAZ leecol_li;
      |ERROR;
      |ACABA;
   |FINSI;
   |HAZ mayus;
|FPRC;


|PROCESO versegundo; |TIPO 0;
   salida = FSalida;
   |SI salida = 9;
      |HAZ leecol_li;
      |ERROR;
      |ACABA;
   |FINSI;
   
   |SI salida ! 10; |ACABA; |FINSI;
   |SI #caplctal#3 ! "I"; |Y #caplctal#3 ! "G"; |Y #caplctal#3 ! "S"; |ACABA; |FINSI;
   |PUSHV 06411763;
   |CUADRO 06 41 17 63;
   |ATRI R;
   |SI #caplctal#3 = "I";
      |PINTA 0742 , "--COLUMNAS INGRESOS--";
   |SINO;
      |SI #caplctal#3 = "G";
         |PINTA 0742 , "---COLUMNAS GASTOS---";
      |SINO;
         |PINTA 0742 , "--COLUMNAS SUPLIDOS--";
      |FINSI;
   |FINSI;
   || |PINTA 0739 , "---------------------";
   |PINTA 0842 , " 1 ";
   |PINTA 0942 , " 2 ";
   |PINTA 1042 , " 3 ";
   |PINTA 1142 , " 4 ";
   |PINTA 1242 , " 5 ";
   |PINTA 1342 , " 6 ";
   |PINTA 1442 , " 7 ";
   |PINTA 1542 , " 8 ";
   |PINTA 1642 , " 9 ";
   |SI #caplctal#3 = "I"; y = 1;  |FINSI;
   |SI #caplctal#3 = "G"; y = 19; |FINSI;
   |SI #caplctal#3 = "S"; y = 37; |FINSI;
   p = 745;
   |PARA x = 1; |SI x [ 9; |HACIENDO x = x + 1;
      z = (x - 1) * 2 + y;
      alfa1 = #caconlib#z#;
      z = z + 1;
      alfa1 = alfa1 + "/" + #caconlib#z# + " ";
      p = p + 100;
      |PINTA p, alfa1;
   |SIGUE;
   |ATRI 0;
   |PAUSA;
   |POPV;
   |ERROR;
|FPRC;

|PROCESO leecol_li;
   lib= #caplctac#0;
   descripcion= #caplctac#1;
   |SUB_EJECUTA "caconlib";
   |ABRE #2;
   |DDEFECTO #2;
   #caconlib#0 = #caplctac#0;
   |LEE 040#2=;
   |CIERRA #2;
|FPRC;
