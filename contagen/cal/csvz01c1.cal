|FICHEROS;
     dscsvm01;
     dscsvm02;
     dscsvm03;
     dscsvm04;
     dscsvm05;

     dscsvw04;
     dscsvw05,MANTE;
|FIN;

|VARIABLES;
     n0Vent          = -1;
     n1Vent          = -1;
     n2Vent          = -1;
     n3Vent          = -1;
     nGrid1          = -1;
     nGrid2          = -1;
     nGrid4          = -1;
     nGrid5          = -1;
     nTree           = -1;
     nBtnBor         = -1;
     nBtnAut         = -1;
     nBtnNCo         = -1;
     nBtnBCo         = -1;
     nBtnBTo         = -1;
     nBtnNCa         = -1;
     nBtnBCa         = -1;
     nBtnCar1        = -1;
     nBtnCar2        = -1;
     nBtnCrg         = -1;

     nRango          = 0;
     nHandle         = 0;
     nIde            = 0;
     nCampo          = 0;
     nPanta          = 0;
     nLong           = 0;
     nCarac          = 0;
     nPos            = 0;
     nFSalida        = 0;
     nColum          = 0;
     nNume1          = 0;
     nNume2          = 0;
     nRam1           = 0;
     nRam2           = 0;
     nPide           = 0;
     nFila           = 0;
     nCargar         = 0;
     nPosi           = 0;
     nModo           = 0;

     aAlfa           = "";
     aEsc1           = "";
     aEsc2           = "";
     aRetu           = "";
     aTecla          = "";
     aBase           = "";
     aPathLocal      = "";
     aPathCSV        = "";
     aFicTree        = "";
     aAbre           = "";
     aTabla          = "";
     aTablaTree      = "";
     aFilaTree       = "";
     aDescri         = "";
     aRuta           = "";
     aLong           = "";
     aCadena         = "";
     aOrigen         = "";
     aDestino        = "";
     aDTabla         = "";
     aHTabla         = "";
     aBuscar         = "";
     aRefresca       = "";
     aCarac          = "";
     aContenido      = "";
     a100            = "";
     aHasta          = "";
     aVerde          = "0,185,0;255,255,255";

     {-1}sTree       = 0;
         sT_nID      = 0;
         sT_nOper    = 0;
         sT_aData    = "";

     {-1}aVent       = "";
         aVent1      = 0;
         aVent2      = 0;
         aVent3      = 0;
         aVent4      = 0;
         aVent5      = "";

     &eaUnidadBasico = "";
     &eaIP           = "";
|FIN;

|PROCESO dscsvm05BorC1;
     |BORRA 020#dscsvm05.a;
     |LIBERA #dscsvm05;

     |PULSATECLA;
|FPRC;

|DEFBUCLE dscsvm05BorC1;
     #dscsvm05#1;
     ;
     #dscsvm04#0, #dscsvm04#1, #dscsvm04#2, #dscsvm04#3, #dscsvm04#4,   0;
     #dscsvm04#0, #dscsvm04#1, #dscsvm04#2, #dscsvm04#3, #dscsvm04#4, 999;
     be;
     NULL, dscsvm05BorC1;
|FIN;

|PROCESO dscsvm04BorC1;
     |BORRA 020#dscsvm04.a;
     |LIBERA #dscsvm04;

     |BUCLE dscsvm05BorC1;

     |PULSATECLA;
|FPRC;

|DEFBUCLE dscsvm04BorC1;
     #dscsvm04#1;
     ;
     #dscsvm03#0, #dscsvm03#1, #dscsvm03#2, #dscsvm03#3, "";
     #dscsvm03#0, #dscsvm03#1, #dscsvm03#2, #dscsvm03#3, a100;
     be;
     NULL, dscsvm04BorC1;
|FIN;

|PROCESO Baja5;
     #dscsvm05#0 = #dscsvm04#0;
     #dscsvm05#1 = #dscsvm04#1;
     #dscsvm05#2 = #dscsvm04#2;
     #dscsvm05#3 = #dscsvm04#3;
     #dscsvm05#4 = #dscsvm04#4;
     #dscsvm05#5 = 000;
|FPRC;

|PROCESO Alta5;
     #dscsvm05#0 = #dscsvm04#0;
     #dscsvm05#1 = #dscsvm04#1;
     #dscsvm05#2 = #dscsvm04#2;
     #dscsvm05#3 = #dscsvm04#3;
     #dscsvm05#4 = #dscsvm04#4;
     #dscsvm05#5 = 999;
|FPRC;

|PROCESO PantaW05;
     |VENTANA 0501, 1185, -1, 16, "Configuraci¢n campo";
     n3Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n3Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |DDEFECTO #dscsvw05;

     |C_M #dscsvw05#0, 1, "S";
     |SI nModo = 2;
         #dscsvw05#0 = #dscsvm05#6;
         #dscsvw05#1 = #dscsvm05#5;
         #dscsvw05#2 = #dscsvm05#7;

         |C_M #dscsvw05#0, 1, "N";
     |FINSI;

     |PINPA #0#dscsvw05;
     |PINDA #0#dscsvw05;

     |ENDATOS #1#dscsvw05;
     |SI FSalida = 0;
         #dscsvm05#0 = #dscsvm04#0;
         #dscsvm05#1 = #dscsvm04#1;
         #dscsvm05#2 = #dscsvm04#2;
         #dscsvm05#3 = #dscsvm04#3;
         #dscsvm05#4 = #dscsvm04#4;
         #dscsvm05#5 = #dscsvw05#1;
         |LEE 101#dscsvm05.=;
         |SI FSalida ! 0;
             |DDEFECTO #dscsvm05;
             #dscsvm05#0 = #dscsvm04#0;
             #dscsvm05#1 = #dscsvm04#1;
             #dscsvm05#2 = #dscsvm04#2;
             #dscsvm05#3 = #dscsvm04#3;
             #dscsvm05#4 = #dscsvm04#4;
             #dscsvm05#5 = #dscsvw05#1;
             |GRABA 020#dscsvm05.b;
         |FINSI;

         #dscsvm05#6 = #dscsvw05#0;
         #dscsvm05#7 = #dscsvw05#2;

         |GRABA 020#dscsvm05.a;
         |LIBERA #dscsvm05;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n3Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n3Vent;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |REFRESCACONTROL nGrid5;
     |FOCOTECLADO nGrid5;

     |PULSATECLA;
|FPRC;

|PROCESO Evnt5;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#dscsvm05.=;

         |ESTADO_CONTROL nBtnBCa, "ENABLE";
     |FINSI;

     |SI FSalida = 4;
         nModo = 2;  |HAZ PantaW05;
     |FINSI;
|FPRC;

|PROCESO BtnNCaC1;
     nModo = 1;  |HAZ PantaW05;
|FPRC;

|PROCESO BtnBCaC1;
     |CONFI "0000NEst  seguro que quiere borrar el campo";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |LEE 101#dscsvm05.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |HAZ dscsvm05BorC1;

     |ESTADO_CONTROL nBtnBCa, "DISABLE";

     |REFRESCACONTROL nGrid5;
     |FOCOTECLADO nGrid5;
|FPRC;

|PROCESO EntraM05;
     aAlfa = "Campos a rellenar seg£n el contenido " + #dscsvm04#4;  |QBF aAlfa;
     |VENTANA 0501, 3599, -1, 16, aAlfa;
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |CONTROL_SIMPLE 0, "LABEL,{{11}}(Doble click entra en la configuraci¢n)", 0502, 0598, NULL;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Nuevo campo", 3302, 3318, BtnNCaC1;
     nBtnNCa = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Borrar campo", 3320, 3336, BtnBCaC1;
     nBtnBCa = FSalida;

     |ESTADO_CONTROL nBtnBCa, "DISABLE";

     nRango   = 2 + 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#dscsvm05, nRango, 601, 3298, Baja5, Alta5, Evnt5;
     nGrid5 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::{{001}}Salir," + nGrid5;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;
          |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;

     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;
|FPRC;

|PROCESO RellenaAut;
     |VENTANA 0501, 0540, -1, 16, "Procesando datos";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |HAZ RellenaCondicion;

     aDescri     = " *GENERICO";
     #dscsvm04#0 = #dscsvm03#0;
     #dscsvm04#1 = #dscsvm03#1;
     #dscsvm04#2 = #dscsvm03#2;
     #dscsvm04#3 = #dscsvm03#3;
     #dscsvm04#4 = aDescri;
     |LEE 000#dscsvm04.=;
     |SI FSalida ! 0;
         #dscsvm04#0 = #dscsvm03#0;
         #dscsvm04#1 = #dscsvm03#1;
         #dscsvm04#2 = #dscsvm03#2;
         #dscsvm04#3 = #dscsvm03#3;
         #dscsvm04#4 = aDescri;
         |GRABA 020#dscsvm04.n;
         |LIBERA #dscsvm04;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;

     |REFRESCACONTROL nGrid4;
     |FOCOTECLADO nGrid4;
|FPRC;

|PROCESO Baja4;
     #dscsvm04#0 = #dscsvm03#0;
     #dscsvm04#1 = #dscsvm03#1;
     #dscsvm04#2 = #dscsvm03#2;
     #dscsvm04#3 = #dscsvm03#3;
     #dscsvm04#4 = "";
|FPRC;

|PROCESO Alta4;
     #dscsvm04#0 = #dscsvm03#0;
     #dscsvm04#1 = #dscsvm03#1;
     #dscsvm04#2 = #dscsvm03#2;
     #dscsvm04#3 = #dscsvm03#3;
     #dscsvm04#4 = "z" * 100;
|FPRC;

|PROCESO Evnt4;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#dscsvm04.=;
         |SI FSalida ! 0;               |ACABA;  |FINSI;
         |SI #dscsvm04#0 ! #dscsvm03#0; |ACABA;  |FINSI;
         |SI #dscsvm04#1 ! #dscsvm03#1; |ACABA;  |FINSI;
         |SI #dscsvm04#2 ! #dscsvm03#2; |ACABA;  |FINSI;
         |SI #dscsvm04#3 ! #dscsvm03#3; |ACABA;  |FINSI;

         |ESTADO_CONTROL nBtnCrg, "DISABLE";
         |ESTADO_CONTROL nBtnBCo, "ENABLE";
         |ESTADO_CONTROL nBtnBTo, "ENABLE";
     |FINSI;

     |SI FSalida = 4;
         |LEE 101#dscsvm04.=;
         |SI FSalida = 0;
             |HAZ EntraM05;

             |LEE 101#dscsvm04.=;
             |SI FSalida = 0;
                 #dscsvm04#5 = "";

                 #dscsvm05#0 = #dscsvm04#0;
                 #dscsvm05#1 = #dscsvm04#1;
                 #dscsvm05#2 = #dscsvm04#2;
                 #dscsvm05#3 = #dscsvm04#3;
                 #dscsvm05#4 = #dscsvm04#4;
                 #dscsvm05#5 = "";
                 |LEE 000#dscsvm05.];
                 |SI FSalida = 0; |Y #dscsvm05#0 = #dscsvm04#0;
                                  |Y #dscsvm05#1 = #dscsvm04#1;
                                  |Y #dscsvm05#2 = #dscsvm04#2;
                                  |Y #dscsvm05#3 = #dscsvm04#3;
                                  |Y #dscsvm05#4 = #dscsvm04#4;
                     #dscsvm04#5 = aVerde;
                 |FINSI;

                 |GRABA 020#dscsvm04.a;
                 |LIBERA #dscsvm04;

                 |REFRESCACONTROL nGrid4;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO BtnBToC1;
     |CONFI "0000NEst  seguro que quiere borrar todas las condiciones";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BUCLE dscsvm04BorC1;

     |ESTADO_CONTROL nBtnCrg, "ENABLE";
     |ESTADO_CONTROL nBtnBCo, "DISABLE";
     |ESTADO_CONTROL nBtnBTo, "DISABLE";

     |REFRESCACONTROL nGrid4;
     |FOCOTECLADO nGrid4;
|FPRC;

|PROCESO BtnBCoC1;
     |CONFI "0000NEst  seguro que quiere borrar el contenido seleccionada";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |LEE 101#dscsvm04.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |HAZ dscsvm04BorC1;

     |ESTADO_CONTROL nBtnCrg, "ENABLE";
     |ESTADO_CONTROL nBtnBCo, "DISABLE";
     |ESTADO_CONTROL nBtnBTo, "DISABLE";

     |REFRESCACONTROL nGrid4;
     |FOCOTECLADO nGrid4;
|FPRC;

|DEFBUCLE dscsvm04R;
     #dscsvm04#1;
     ;
     #dscsvm03#0, #dscsvm03#1, #dscsvm03#2, #dscsvm03#3, aDescri;
     #dscsvm03#0, #dscsvm03#1, #dscsvm03#2, #dscsvm03#3, aHasta;
     be;
     NULL, dscsvm04BorC1;
|FIN;

|PROCESO BtnNCoC1;
     |VENTANA 0501, 0782, -1, 16, "Introduzca el contenido o parte del contenido";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     aDescri = "";
     E_inf   = "";
     E_sup   = "80";
     aDescri = 0602 ? 1;  |QBF aDescri;

     |SI aDescri ! "";
         |CONFI "0000SBorramos todos los contenidos del lineal que contenga el mismo patr¢n?";
         |SI FSalida = 0;
             aHasta = (aDescri + ("z" * 100)) % 199;
             aHasta = aHasta + "z";
             |BUCLE dscsvm04R;
         |FINSI;

         |DDEFECTO #dscsvm04;
         #dscsvm04#0 = #dscsvm03#0;
         #dscsvm04#1 = #dscsvm03#1;
         #dscsvm04#2 = #dscsvm03#2;
         #dscsvm04#3 = #dscsvm03#3;
         #dscsvm04#4 = aDescri;
         |LEE 000#dscsvm04.=;
         |SI FSalida ! 0;
             #dscsvm04#0 = #dscsvm03#0;
             #dscsvm04#1 = #dscsvm03#1;
             #dscsvm04#2 = #dscsvm03#2;
             #dscsvm04#3 = #dscsvm03#3;
             #dscsvm04#4 = aDescri;
             |GRABA 020#dscsvm04.n;
             |LIBERA #dscsvm04;

             aDescri     = " *GENERICO";
             #dscsvm04#0 = #dscsvm03#0;
             #dscsvm04#1 = #dscsvm03#1;
             #dscsvm04#2 = #dscsvm03#2;
             #dscsvm04#3 = #dscsvm03#3;
             #dscsvm04#4 = aDescri;
             |LEE 000#dscsvm04.=;
             |SI FSalida ! 0;
                 #dscsvm04#0 = #dscsvm03#0;
                 #dscsvm04#1 = #dscsvm03#1;
                 #dscsvm04#2 = #dscsvm03#2;
                 #dscsvm04#3 = #dscsvm03#3;
                 #dscsvm04#4 = aDescri;
                 |GRABA 020#dscsvm04.n;
                 |LIBERA #dscsvm04;
             |FINSI;
         |FINSI;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;

     |REFRESCACONTROL nGrid4;
     |FOCOTECLADO nGrid4;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
|FPRC;

|PROCESO EntraM04;
     aAlfa = "Condiciones de la columna " + #dscsvm03#4;  |QBF aAlfa;
     |VENTANA 0501, 3599, -1, 16, aAlfa;
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |LEE 101#dscsvm03.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     a100 = "z" * 100;

     #dscsvw04#0  = #dscsvm03#6;
     #dscsvw04#1  = #dscsvm03#7;
     #dscsvw04#2  = #dscsvm03#8;
     #dscsvw04#3  = #dscsvm03#9;
     #dscsvw04#4  = #dscsvm03#10;
     #dscsvw04#5  = #dscsvm03#11;
     #dscsvw04#6  = #dscsvm03#12;
     #dscsvw04#7  = #dscsvm03#13;
     #dscsvw04#8  = #dscsvm03#14;
     #dscsvw04#9  = #dscsvm03#15;
     #dscsvw04#10 = #dscsvm03#16;
     #dscsvw04#11 = #dscsvm03#17;

     |PINPA #0#dscsvw04;  nPanta = FSalida;
     |PINDA #0#dscsvw04;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Carga autom tica", 3680, 3698, RellenaAut;
     nBtnCrg = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Nuevo contenido", 3602, 3618, BtnNCoC1;
     nBtnNCo = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Borrar contenido", 3620, 3636, BtnBCoC1;
     nBtnBCo = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Borrar todas", 3638, 3654, BtnBToC1;
     nBtnBTo = FSalida;

     |ESTADO_CONTROL nBtnBCo, "DISABLE";
     |ESTADO_CONTROL nBtnBTo, "DISABLE";

     nRango   = 2 + 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#dscsvm04, nRango, 2501, 3598, Baja4, Alta4, Evnt4;
     nGrid4 = FSalida;

     |PULSATECLA;

     |ENDATOS #1#dscsvw04;
     |SI FSalida = 0;
         #dscsvm03#6  = #dscsvw04#0;
         #dscsvm03#7  = #dscsvw04#1;
         #dscsvm03#8  = #dscsvw04#2;
         #dscsvm03#9  = #dscsvw04#3;
         #dscsvm03#10 = #dscsvw04#4;
         #dscsvm03#11 = #dscsvw04#5;
         #dscsvm03#12 = #dscsvw04#6;
         #dscsvm03#13 = #dscsvw04#7;
         #dscsvm03#14 = #dscsvw04#8;
         #dscsvm03#15 = #dscsvw04#9;
         #dscsvm03#16 = #dscsvw04#10;
         #dscsvm03#17 = #dscsvw04#11;

         |GRABA 020#dscsvm03.a;
     |FINSI;
     |LIBERA #dscsvm03;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;

     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;
|FPRC;
