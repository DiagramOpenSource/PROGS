|FICHEROS;
   camocab4 #0;

   :/modelos/def/dsmom042 #42;
   :/modelos/def/dsmom041 #41;
   :/modelos/def/dsmom040 #40;
   :/modelos/def/dsmom049 #49;

   cacuenta #5;
   camoauxc #6;

   :/modelos/def/dsmom030 #300;
   :/basica/def/agicen14 #114;
|FIN;

|VARIABLES;
   &entrada = 1;

   &enModAmor  = 0;
   &eaCam2     = "";
   &eaElemento = "";
   &enElemeNum = 0;
   &eaElemeNom = "";
   &enElemeCom = 0;

   &eaCam4     = "";
   &eaCam5     = "";
   &eaCam8     = "";
   &enCam10    = 0;
   &efCam27    = @;
   &eaCam33    = "";
   &enCam43    = 0;
   &enCam46    = 0;
   &eaCtana    = "";
   &enOperFin  = 0;

   &c_ctana = "";
   &enGrupo = 0;

   nume1      = 0;
   aAlfa      = "";
   aAlfa1     = "";
   swModulo   = 0;
   sw_er      = 0;
   nFactor    = 0;
   nContenido = "";
   nPorceMin  = 0;
   nPorceMax  = 0;
   nEstado    = 0;
   alfa1      = "";
   any        = "";
   linea      = 0;
   estado     = 0;

   xx = 0;
   yy = 0;

   &eaGrAna  = "";
   &enImAna  = 0;
   &enQueAna = 0;
   &nSwGrupo = 0;
   &nSwFra   = 0;

  {30}aPopup        = "";
     aContenido     = "";
     aID            = "";
     nID            = 0;
   nOk      = 0;
   nCampo55 = 0;
|FIN;

|INCLUYE dscont_i;
|INCLUYE dscoan_i;

|PROCESO Elinicio;
 |HAZ inicio;
 |HAZ DirAplicSt;
 |SI Haymodelo = 0;
     |MENAV "    Error.! No Existe Aplicacion MODELOS.";
     |PTEC 807;
 |SINO;
     || ... Activado Acceso
     |MODO_RELACION #0, 0, "dsmom040", "X", "X";
     |MODO_RELACION #0, 1, "dsmom040", "N", "S";

     aMonedaA = eaMoneda;
     aMonedaC = aMonedaA;
     |HAZ LeeConversor;
     |SI enConverModelo ! 0;   ||Hay diferencia de Monedas
         |SI enRedonPaYaModelo ! 0;
             aMonedaC = "E";
         |SINO;
             aMonedaC = "P";
         |FINSI;
     |FINSI;
 |FINSI;
|FPRC;

|| *************************************************************
|| .... Calculos de los campos por pantalla.
|CALCULO cuenta; |TIPO 6;
     eaCuenta = #0Campo;
     salidas  = FSalida;
     |HAZ FiltraPuntos;
     #0Campo = eaCuenta;
     |PINTA #0Campo;

     nume1 = Campo + 1;
     eaCuenta = #0Campo; |HAZ SacaNivel;
     #0nume1 = enNivel;
|FCAL;

|CALCULO refresca; |TIPO 0;
   |SI #0Campo ! doce;
      |SI #cacuenta#3 = "N";
         |MENAV "    Esta Cuenta NO tiene Pase Directo ";
         |ERROR;
         |ACABA;
      |FINSI;
   |FINSI;
|FCAL;

|CALCULO comp;
   |ABRE #6;
   aAlfa1 = #0#31; |QBF aAlfa1;
   aAlfa1 = ("00" + aAlfa1) % -102;
   #camoauxc#6 = aAlfa1;
   #camoauxc#0 = #0#3;
   #camoauxc#1 = #0#4;
   |LEE 001#6=;
   |SI FSalida = 0;
      |MENAV "0000Esta Cuenta YA existe en el Desglose";
      |ERROR;
   |FINSI;
   |CIERRA #6;
|FCAL;

|CALCULO tipamo7; |TIPO 7;
 |SI swModulo = 1;
     #0#52 = 1; |PINTA #0#52;
     |C_M #0#16, 1, "N";
     |C_M #0#17, 1, "N"; #0#17 = #0#34; |PINTA #0#17;
     |C_M #0#20, 1, "N"; #0#20 = 0; |PINTA #0#20;
 |SINO;
     |C_M #0#16, 1, "S";
     |C_M #0#17, 1, "S";
     |C_M #0#20, 1, "S";
 |FINSI;
|FCAL;

|CALCULO Ellim; |TIPO 7;
 |SI #0#10 = "F"; |Y #41#36 ! 0;
     |C_M #0#42,1,"S";
 |SINO;
     |C_M #0#42,1,"N";
 |FINSI;
|FCAL;

|CALCULO tipamo; |TIPO 0;
/*
   |SI #0#8 = "U"; |Y #0Campo ! "N";
      |MENAV "     En un Bien Usado NO se admite este tipo de Amortizacion";
      |ERROR;
      |ACABA;
   |FINSI;
   |SI #0Campo = "R";
       |SI #0#6 ] "01.01.2015";
           |MENAV "     Fecha de Compra igual o superior a 01.01.2015, Tipo amortizacion Incorrecto";
           |ERROR;
       |SINO;
           |SI swModulo  ! 0;
               |MENAV "     Actividad de Modulos, Tipo amortizacion Incorrecto";
           |FINSI;
       |FINSI;
   |FINSI;
   nume1 = Campo + 4;
   |SI #0Campo = "N";
      #0nume1 = 0;
      |CAMPO_MODIFICA #0nume1, 1, "N";
      |PINTA #0nume1;
   |SINO;
      |CAMPO_MODIFICA #0nume1, 1, "S";
   |FINSI;
*/
|FCAL;


|CALCULO noimporte;
   |SI #0Campo = 0;
      |MENAV "      El importe debe ser diferente de CERO.";
      |ERROR;
      |ACABA;
   |FINSI;
|FCAL;

|CALCULO EnCurso0; |TIPO 0;
   |C_M #0#38,1,"S";
   |SI #0#40 = "S";
       #0#38 = "01.01.0000"; |PINTA #0#38;
       |C_M #0#38,1,"N";
   |FINSI;
|FCAL;

|CALCULO FInicio7;  |TIPO 7;
     |SI #0Campo [ "01.01.1900"; |Y #0#40 = "N";
         #0Campo = #0#6;
         |PINTA #0Campo;
     |FINSI;
|FCAL;

|CALCULO FInicio0;  |TIPO 0;
     |SI #0#38 < #0#6; |Y #0#40 = "N";
         |C_M #0#38,1,"S";
         |MENAV "    La Fecha Inicio debe ser igual o mayor a la de Compra";
         |ERROR;
     |FINSI;
|FCAL;

|CALCULO NuevoUsado;
 nFactor = 1;
 |SI #0Campo = "U";  nFactor = 2;  |FINSI;

 |SI swModulo = 1;
     |SI #0#33 = 0;
            |SI #0#32 = 0;  #0#33 = 100;           |FINSI;
            |SI #0#32 = 1;  #0#33 = 5  * nFactor;  |FINSI;
            |SI #0#32 = 2;  #0#33 = 40 * nFactor;  |FINSI;
            |SI #0#32 = 3;  #0#33 = 25 * nFactor;  |FINSI;
            |SI #0#32 = 4;  #0#33 = 15 * nFactor;  |FINSI;
            |SI #0#32 = 5;  #0#33 = 22 * nFactor;  |FINSI;
            |SI #0#32 = 6;  #0#33 = 10 * nFactor;  |FINSI;
            |SI #0#32 = 7;  #0#33 = 5  * nFactor;  |FINSI;
            |SI #0#32 = 8;  #0#33 = 3  * nFactor;  |FINSI;
        |FINSI;

        |SI #0#34 = 0;
            |SI #0#32 = 0;  #0#34 = 100;           |FINSI;
            |SI #0#32 = 1;  #0#34 =  2.5  * nFactor;  |FINSI;
            |SI #0#32 = 2;  #0#34 = 20    * nFactor;  |FINSI;
            |SI #0#32 = 3;  #0#34 = 12.5  * nFactor;  |FINSI;
            |SI #0#32 = 4;  #0#34 = 10    * nFactor;  |FINSI;
            |SI #0#32 = 5;  #0#34 = 12.5  * nFactor;  |FINSI;
            |SI #0#32 = 6;  #0#34 =  5.88 * nFactor;  |FINSI;
            |SI #0#32 = 7;  #0#34 =  2.22 * nFactor;  |FINSI;
            |SI #0#32 = 8;  #0#34 =  1.25 * nFactor;  |FINSI;
       |FINSI;

       |SI #0#35 = 0; #0#35 = #0#34;  |FINSI;

       |PINTA #0#33;
       |PINTA #0#34;
       |PINTA #0#35;
  |FINSI;
|FCAL;

|CALCULO LeeGrupo; |TIPO 6;
  |C_M #0Campo, 0, aAlfa1;
  |SI aAlfa1 = "N"; |ACABA; |FINSI;

  |SI Campo = 41;
      |SI #0Campo = 0; |ACABA; |FINSI;
  |FINSI;

  |ABRE #40;
  #40#0 = enEmpresa;
  #40#2 = #0Campo;
  |LEE 000#40=;
  nEstado = FSalida;
  |CIERRA #40;

  |SI nEstado ! 0;
      |ERROR;
      |CONFI "    SError.! No existe Grupo de Amortizacion. Desea darlo de alta ";
      |SI FSalida = 0;
          enGrupo = #0Campo;
          |SUB_EJECUTA_NP "camocab3";
          #0Campo = enGrupo; |PINTA #0Campo;
      |FINSI;
  |SINO;
      |SI Campo = 15;
          #0#39 = #dsmom040#9;
          |SI enSwAna = 1;  |PINTA #0#39; |FINSI;
      |FINSI;
  |FINSI;
  #41#0 = enEmpresa;
|FCAL;

|RUTINA inf2camocab4;
   #40#0 = enEmpresa;
   #40#2 = 0001;
|FRUT;

|RUTINA sup2camocab4;
   #40#0 = enEmpresa;
   #40#2 = 9999;
|FRUT;

|CALCULO ElsGrups; |TIPO 6;
   |SI FSalida = 10;
      |ABRE #40;
      #40#2 = #0Campo;
      |CONSULTA_F_CLAVE #1#40,inf2camocab4,sup2camocab4;
      #0Campo = #40#2; |PINTA #0Campo;
      |ERROR;
      |CIERRA #40;
   |FINSI;
   |SI Campo = 41;
       |SI #41#38 = 0;
           |ABRE #40;
           #40#0 = enEmpresa;
           #40#2 = 0;
           |LEE 041#40=;
           |SI FSalida ! 0;
               |DDEFECTO #40;
               #40#0 = enEmpresa;
               #40#2 = 0;
               |GRABA 020#40n;
           |FINSI;
           |CIERRA #40;
       |FINSI;
   |FINSI;
|FCAL;

|CALCULO LeeLaActividad; |TIPO 0;
  swModulo = 0;
  || Lee Actividad
  |ABRE #114;
  #114#0 = enEmpresa;
  #114#1 = #0#31;
  |LEE 041#114=;
  |SI FSalida ! 0;
      |CIERRA #114;
      |ERROR;
      |ACABA;
  |FINSI;
  |CIERRA #114;
  eaNombreAct = #114#4;

  swModulo = 0;
  |SI #114#9  = 5; |O #114#9  = 10;
      swModulo = 1;
  |FINSI;
  |SI #114#9 = 6; |O #114#9 = 7; |O #114#9 = 11; |O #114#9 = 12;
      swModulo = 1;   ||Agricolas  (Paco 30.05.2001)
  |FINSI;
|FCAL;

|CALCULO TModulo7; |TIPO 7;
  |SI swModulo = 0;
      |C_M #0#32,1,"N"; #0#32 = 0; |PINTA #0#32;
      |C_M #0#33,1,"N"; #0#33 = 0; |PINTA #0#33;
      |C_M #0#34,1,"N"; #0#34 = 0; |PINTA #0#34;
      |C_M #0#35,1,"N"; #0#35 = 0; |PINTA #0#35;
  |SINO;
      |C_M #0#32,1,"S";
      |C_M #0#33,1,"S";
      |C_M #0#34,1,"S";
      |C_M #0#35,1,"S";

      |PUSHV 0523 1680;
      |ATRI R;
      |PINTA 0523, " 0 Inmovilizado material nuevos 100% mismo a. y <100.001 ";
      |PINTA 0623, " 1 Edificios y otras construcciones ( 2,5%  al  5%) 40 a ";
      |PINTA 0723, " 2 Utiles, herramientas, equipos.   (20  %  al 40%)  5 a ";
      |PINTA 0823, " 3 Elementos de transportes y resto (12,5%  al 25%)  8 a ";
      |PINTA 0923, " 4 Inmovilizado inmaterial          (10  %  al 15%) 10 a ";
      |PINTA 1023, " ------------------------------------------------------- ";
      |PINTA 1123, " 5 Vacuno, porcino, ovino y caprino (12,5%  al 22%)  8 a ";
      |PINTA 1223, " 6 Equino y frutales no citricos    ( 5,88% al 10%) 17 a ";
      |PINTA 1323, " 7 Frutales citricos y vi¤edos      ( 2,22% al  5%) 45 a ";
      |PINTA 1423, " 8 Olivar                           ( 1,25% al  3%) 80 a " ;

      |ATRI r;
  |FINSI;
|FCAL;

|CALCULO TModulo0;  |TIPO 0;
    |POPV;
    nContenido = Contenido;
    |SI nContenido ! #0Campo;
        #0#33 = 0;
        #0#34  = 0;
        #0#35  = 0;
        |HAZ NuevoUsado;
    |FINSI;

    |SI #0Campo = 5;
        |C_M #0#33,  1, "N";
        |C_M #0#34,  1, "N";
        |C_M #0#35, 1, "N";
    |FINSI;
|FCAL;

|CALCULO FiltroPorce;  |TIPO 0;
     |C_M #0Campo,0,alfa1;
     |SI alfa1 = "N"; |ACABA; |FINSI;

     |SI #0#8 = "N"; nFactor = 1;  |FINSI;
     |SI #0#8 = "U"; nFactor = 2;  |FINSI;
     |SI #0#32 = 0;
           nPorceMin = 100;
           nPorceMax = 100;
     |FINSI;
     |SI #0#32 = 1;
           nPorceMin = 2.5 * nFactor;
           nPorceMax = 5   * nFactor;
     |FINSI;
     |SI #0#32 = 2;
           nPorceMin = 20  * nFactor;
           nPorceMax = 40  * nFactor;
     |FINSI;
     |SI #0#32 = 3;
           nPorceMin = 12.5 * nFactor;
           nPorceMax = 25   * nFactor;
     |FINSI;
     |SI #0#32 = 4;
           nPorceMin = 10   * nFactor;
           nPorceMax = 15   * nFactor;
     |FINSI;
     |SI #0#32 = 5;
           nPorceMin = 12.5 * nFactor;
           nPorceMax = 22   * nFactor;
     |FINSI;
     |SI #0#32 = 6;
           nPorceMin = 5.88  * nFactor;
           nPorceMax = 10    * nFactor;
     |FINSI;
     |SI #0#32 = 7;
           nPorceMin = 2.22 * nFactor;
           nPorceMax = 5    * nFactor;
     |FINSI;
     |SI #0#32 = 8;
           nPorceMin = 1.25 * nFactor;
           nPorceMax = 3    * nFactor;
     |FINSI;
     |SI #0Campo < nPorceMin;  |O #0Campo > nPorceMax;
         |MENAV "        Porcentaje fuera de limites.";
         |ERROR;
     |FINSI;
|FCAL;

|CALCULO ElsAnys07; |TIPO 7;
 nume1 = Campo - 4;
 |SI #0nume1 = "R";
     |MENSA "0000Introduzca los a¤os que restan de vida util ";
 |FINSI;
|FCAL;

|CALCULO ElsAnys; |TIPO 0;
 |SI FSalida = 2; |ACABA; |FINSI;
 |C_M #0Campo,0,aAlfa1;
 |SI aAlfa1 = "N"; |ACABA; |FINSI;

 |SI #0Campo = 0;
     |MENAV "    Introduzca el datos de los A¤os ";
     |ERROR;
 |FINSI;
|FCAL;

|CALCULO Para340;
 aAlfa1 = #0Campo;
 |C_M #0#47, 1, aAlfa1;
 |C_M #0#49, 1, aAlfa1;
|FCAL;

|CALCULO esinmueble;
  |SI #0#47 = "S"; #0#48 = 9; |FINSI;
  |SI #0#47 = "N"; #0#48 = 4; |FINSI;
  |PINTA #0#48;

|FCAL;

|| ======================================================================
||   Calculos de las Lineas de Amortizacion

|CALCULO Ptec816; |TIPO 7;
       |SI eaSobreEs ! "S";
           |PTEC 816;
       |FINSI;
|FCAL;

|CALCULO concepto; |TIPO 0;  || desde Campos conceptos
   enFilConc = 0;
   eaCuenta   = #0#3;
   enConcepto = #0#36;
   |HAZ FiltroConcepto;  |SI eswLect ! 0; |ACABA; |FINSI;
   alfa1 = #dsmom030#1; |QBF alfa1;
   |SI alfa1 ! "";
       #0#28 = #dsmom030#1; |PINTA #0#28;
   |FINSI;
|FCAL;

|PROCESO CalTipoBien;
       nCampo55  = 0;
       eaCuenta  = #camocab4#3;
       aAlfa1    = #camocab4#6; aAlfa1 = aAlfa1 % -104;
       aAlfa = eaCuenta % 103;
       |SI aAlfa = "210";                      nCampo55 = 11; |FINSI;
       |SI aAlfa = "211"; |O #camocab4#32 = 1; nCampo55 = 12; |FINSI;
       |SI aAlfa = "213";                      nCampo55 = 21; |FINSI;
       |SI aAlfa = "218"; |O #camocab4#32 = 3; nCampo55 = 22; |FINSI;
       |SI aAlfa = "217";                      nCampo55 = 23; |FINSI;
       |SI aAlfa = "216";                      nCampo55 = 24; |FINSI;
       |SI aAlfa = "212"; |O aAlfa = "215";    nCampo55 = 25; |FINSI;
       |SI aAlfa = "214";                      nCampo55 = 28; |FINSI;
       |SI aAlfa = "219"; |O #camocab4#32 = 2; nCampo55 = 29; |FINSI;
       |SI aAlfa = "203"; |O aAlfa = "204";    nCampo55 = 31; |FINSI;
       |SI aAlfa = "205";                      nCampo55 = 32; |FINSI;
       |SI aAlfa = "206";                      nCampo55 = 33; |FINSI;
       |SI aAlfa = "200"; |O aAlfa = "201";
        |O aAlfa = "202"; |O #camocab4#32 = 4; nCampo55 = 39; |FINSI;
       |SI #camocab4#32 = 5;                   nCampo55 = 41; |FINSI;
       |SI #camocab4#32 = 6;                   nCampo55 = 42; |FINSI;
       |SI #camocab4#32 = 7;                   nCampo55 = 43; |FINSI;
       |SI #camocab4#32 = 8;                   nCampo55 = 44; |FINSI;
|FPRC;

|CALCULO Tipo7C50; |TIPO 7;
   |SI #camocab4#50 = 0;
       #camocab4#50 = 49;
       |HAZ CalTipoBien;
       |SI nCampo55 ! 0;
           #camocab4#50 = nCampo55;
       |FINSI;
       |PINTA #camocab4#50;
   |FINSI;
|FCAL;

|CALCULO Tipo66C50; |TIPO 66;
     aAlfa = "|C055WID";
     aID   = #camocab4#aAlfa#;
     nID   = aID;

     aPopup1  = nID;  || Si fuera -1 en la posicion
     aPopup2  = 20;
     aPopup3  = "11. Terrenos dedicados exclusivamente a excombreras";
     aPopup4  = "12. Edificaciones y Construcciones";
     aPopup5  = "21. Maquinaria";
     aPopup6  = "22. Elementos de Transportes";
     aPopup7  = "23. Ordenadores y otros equipos informáticos";
     aPopup8  = "24. Mobiliario";
     aPopup9  = "25. Instalaciones";
     aPopup10 = "26. Barcos y Aeronaves";
     aPopup11 = "27. Batea";
     aPopup12 = "28. Utiles y Herramientas";
     aPopup13 = "29. Otro Inmovilizado Material";
     aPopup14 = "31. Patentes y Marcas";
     aPopup15 = "32. Derechos de Traspaso";
     aPopup16 = "33. Aplicaciones Informáticas";
     aPopup17 = "39. Otro Inmovilizado Intangible";
     aPopup18 = "41. Ganado vacuno, porcino, ovino y caprino";
     aPopup19 = "42. Ganado equino y frutales no cítricos";
     aPopup20 = "43. Frutales cítricos y vi¤edos";
     aPopup21 = "44. Olivar";
     aPopup22 = "49. Otros Bienes Semovientes y Agrícolas";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 102;  #camocab4#50 = aAlfa;
         aAlfa = aPopup % 580;
     |FINSI;

     |PINTA #camocab4#50;
|FCAL;

|CALCULO Tipo0C50; |TIPO 0;
     nOk = 0;

     |SI #camocab4#50 = 11; nOk = 1; |FINSI;
     |SI #camocab4#50 = 12; nOk = 1; |FINSI;
     |SI #camocab4#50 = 21; nOk = 1; |FINSI;
     |SI #camocab4#50 = 22; nOk = 1; |FINSI;
     |SI #camocab4#50 = 23; nOk = 1; |FINSI;
     |SI #camocab4#50 = 24; nOk = 1; |FINSI;
     |SI #camocab4#50 = 25; nOk = 1; |FINSI;
     |SI #camocab4#50 = 26; nOk = 1; |FINSI;
     |SI #camocab4#50 = 27; nOk = 1; |FINSI;
     |SI #camocab4#50 = 28; nOk = 1; |FINSI;
     |SI #camocab4#50 = 29; nOk = 1; |FINSI;
     |SI #camocab4#50 = 31; nOk = 1; |FINSI;
     |SI #camocab4#50 = 32; nOk = 1; |FINSI;
     |SI #camocab4#50 = 33; nOk = 1; |FINSI;
     |SI #camocab4#50 = 39; nOk = 1; |FINSI;
     |SI #camocab4#50 = 41; nOk = 1; |FINSI;
     |SI #camocab4#50 = 42; nOk = 1; |FINSI;
     |SI #camocab4#50 = 43; nOk = 1; |FINSI;
     |SI #camocab4#50 = 44; nOk = 1; |FINSI;
     |SI #camocab4#50 = 49; nOk = 1; |FINSI;

     |SI nOk = 0;
         |MENAV "0000 Tipo de Bien incorrecto";
         |ERROR;
         |ACABA;
     |FINSI;

     |HAZ CalTipoBien;
     |SI nCampo55 ! 0;
         |SI #camocab4#50 ! nCampo55;
             |CONFI "0000SNo corresponde Tipo Bien y Cuenta Contable, continuar";
             |SI FSalida ! 0;
                 #camocab4#50 = nCampo55;
                 |PINTA #camocab4#50;
                 |ERROR;
             |FINSI;
         |FINSI;
     |FINSI;
|FCAL;

|CALCULO Tipo7C51; |TIPO 7;
  aAlfa1 = "S";
  |SI #camocab4#50 ! 11; |Y #camocab4#50 ! 12; |Y #camocab4#50 ! 22;
      aAlfa1 = "N";
      #camocab4#51 = "";
      |PINTA #camocab4#51;
  |FINSI;

  |C_M #camocab4#51, 1, aAlfa1;
  |SI aAlfa1 = "S";
      aAlfa = "0000Introduzca la Referencia Catastral";
      |SI #camocab4#50 = 22;
          aAlfa = "0000Introduzca la Matrícula del vehículo";
      |FINSI;
      |MENSA aAlfa;
  |FINSI;
|FCAL;

|CALCULO Tipo0C51; |TIPO 0;
  |BLIN 4;
|FCAL;

|CALCULO Tipo66C52; |TIPO 66;
     aAlfa = "|C057WID";
     aID   = #camocab4#aAlfa#;
     nID   = aID;

     aPopup1  = nID;  || Si fuera -1 en la posicion
     aPopup2  = 11;
     aPopup3  = "01. Amortización lineal según tablas (cálculo automático)";
     aPopup4  = "02. Amor. según porcentaje constante sobre el imp. pendiente de amor. (cálculo automático)";
     aPopup5  = "03. Amortización según números dígitos - creciente (cálculo automático)";
     aPopup6  = "04. Planes de amortización (cálculo automático)";
     aPopup7  = "05. Depreciación efectiva probada fehacientemente (cálculo manual)";
     aPopup8  = "06. Libertad de Amortización (cálculo manual)";
     aPopup9  = "07. Amortización Acelerada (cálculo automático)";
     aPopup10 = "08. Amortización de Elementos Adquiridos Usados (cálculo automático)";
     aPopup11 = "09. Amortización de Elementos Patrimoniales Objeto de Reinversión - DT 28º LIS (cálculo manual)";
     aPopup12 = "10. Amortización de Activos Nuevos Adquiridos en 2003 y 2004 - DT 13º LIS (cálculo manual)";
     aPopup13 = "80. Amortización según valor residual a 2015 (cálculo automático)";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 102;  #camocab4#52= aAlfa;
     |FINSI;

     |PINTA #camocab4#52;
|FCAL;

|CALCULO Tipo0C52; |TIPO 0;
   |BLIN 4;

   nOk = 0;
   |SI #camocab4#52 ] 1; |Y #camocab4#52 [ 10; nOk = 1; |FINSI;
   |SI #camocab4#52 = 80;                      nOk = 1; |FINSI;
   |SI nOk = 0;
       |MENAV "0000 Tipo de Amortización incorrecto";
       |ERROR;
       |ACABA;
   |FINSI;

   |SI #camocab4#8 = "U"; |Y #camocab4#52 ! 1; |Y #camocab4#52 ! 80;
      |MENAV "     En un Bien Usado NO se admite este tipo de Amortizacion";
      |ERROR;
      |ACABA;
   |FINSI;

   |SI #camocab4#52 = 80;
       |SI #camocab4#6 ] "01.01.2015";
           |MENAV "     Fecha de Compra igual o superior a 01.01.2015, Tipo amortizacion Incorrecto";
           |ERROR;
           |ACABA;
       |FINSI;
       |SI swModulo ! 0;
           |MENAV "     Actividad de Modulos, Tipo amortizacion Incorrecto";
           |ERROR;
           |ACABA;
       |FINSI;
   |FINSI;

   nume1 = Campo + 4;
   |SI #camocab4#52 = 1;
       #camocab4#14 = 0;
       #camocab4#20 = 0;
       |CAMPO_MODIFICA #camocab4#14, 1, "N";
       |CAMPO_MODIFICA #camocab4#20, 1, "N";
       |PINTA #camocab4#14;
       |PINTA #camocab4#20;
   |SINO;
       |CAMPO_MODIFICA #camocab4#14, 1, "S";
       |CAMPO_MODIFICA #camocab4#20, 1, "S";
   |FINSI;

   |SI swModulo = 2; |Y Campo = 10;
       #camocab4#16 = #camocab4#10; |PINTA #camocab4#16;
       #camocab4#17 = #camocab4#11; |PINTA #camocab4#17;
       #camocab4#20 = #camocab4#14; |PINTA #camocab4#20;
   |FINSI;
   aAlfa = "M";
   |SI #camocab4#52 = 1; aAlfa = "N"; |FINSI;
   |SI #camocab4#52 = 2; aAlfa = "D"; |FINSI;
   |SI #camocab4#52 = 3; aAlfa = "A"; |FINSI;
   |SI #camocab4#52 = 80; aAlfa = "R"; |FINSI;
   |SI #camocab4#52 = 7; aAlfa = "N"; |FINSI;
   |SI #camocab4#52 = 8; aAlfa = "N"; |FINSI;
   #camocab4#10 = aAlfa; #camocab4#16 = aAlfa;
|FCAL;
|| ****************************************************************************
|| ======================================================================
|PROCESO def_campos;
   sw_er  = 0;
   linea  = 1;

   |DDEFECTO #0;
   #0#37 = enEmpresa;
   #0#0  = eaElemento;
   #0#1  = enElemeNum;

   #41#0 = enEmpresa;
   #41#2 = #0#0;
   #41#3 = #0#1;
   |LEE 011#41=;
   estado = FSalida;
   |SI estado = 0;
       sw_er = 1;
       |ACABA;
   |FINSI;

   #0#31 = eaCam2;
   #0#0  = eaElemento; || Elemento
   #0#1  = enElemeNum; || Numero
   #0#2  = eaCam4;     || Descripcion
   #0#3  = eaCam5;     || Cuenta Contable
   eaCuenta = #0#3; |HAZ SacaNivel; #0#4 = enNivel;
   #0#5  = eaCam8;     || Proveedor de Compra
   #0#6  = efCam27;    || Fecha Compra
   #0#7  = enCam10;    || Importe Nominal
   eaCtana    = "";
   #0#13 = #0#13 + enCam10;
   #0#19 = #0#19 + enCam10;
   #0#23 = "01.01.0000";
   |SI #0#40 = "N";
       #0#38 = #0#6;
   |FINSI;
   #0#24 = linea;
   any   =  #0#6 % -104;
   #0#25 = any;
   #0#26 = "C";
   #0#27 = enCam10;
   #0#28 = "COMPRA POR LEASING";
   #0#29 = efCam27;
   #0#30 = "S";
   #0#36 = 1;
   #0#39 = c_ctana;

   #0#43 = #41#40;
   #0#46 = enCam43;
   #0#49 = enCam46;
   #0#50 = #41#55;
   #0#51 = #41#56;
   #0#52 = #41#57;
|FPRC;

|PROCESO actualiza;
   |DDEFECTO #41;

   |SI enConverModelo ! 0;
       eaMoneda = aMonedaC; |HAZ Monedas;
       #0#07 = (#0#07 / enConverModelo ) ! enRedonPaYaModelo;
       #0#12 = (#0#12 / enConverModelo ) ! enRedonPaYaModelo;
       #0#13 = (#0#13 / enConverModelo ) ! enRedonPaYaModelo;
       #0#18 = (#0#18 / enConverModelo ) ! enRedonPaYaModelo;
       #0#19 = (#0#19 / enConverModelo ) ! enRedonPaYaModelo;
       #0#27 = (#0#27 / enConverModelo ) ! enRedonPaYaModelo;
   |FINSI;

   #41#0 = enEmpresa;
   #41#1 = #0#31;
   #41#2 = #0#0;
   #41#3 = #0#1;
   #41#4 = #0#2;
   #41#5 = #0#3;
   #41#6 = #0#4;

   |PARA xx = 5; |SI xx [ 23; |HACIENDO xx = xx + 1;
         yy = xx + 3;
         #41yy = #0xx;
   |SIGUE;

   #41#9  = #0#38;
   #41#1  = #0#31;
   #41#27 = #0#6;
   #41#28 = #0#32;
   #41#29 = #0#33;
   #41#30 = #0#34;
   #41#31 = #0#35;
   #41#32 = eaNombreEmp;
   #41#33 = eaNombreAct;
   #41#34 = #0#39;
   #41#35 = #0#40;
   #41#38 = #0#41;
   #41#39 = #0#42;
   #41#40 = #0#43;
   #41#41 = #0#44;
   #41#42 = #0#45;
   #41#43 = #0#46;
   #41#44 = #0#47;
   #41#45 = #0#48;
   #41#46 = #0#49;
   #41#55 = #0#50;
   #41#56 = #0#51;
   #41#57 = #0#52;

   |GRABA 011#41n;
   |LIBERA #41;

   |ABRE #42;
   #42#0 = #41#0;
   #42#2 = #41#2;
   #42#3 = #41#3;
   #42#4 = #0#24;
   |LEE 000#42=;
   estado = FSalida;
   #42#0 = #41#0; #42#2 = #41#2;
   #42#3 = #41#3; #42#4 = #0#24;

   #42#5 = #0#25; #42#6 = #0#26; #42#7 = #0#27;
   #42#8 = #0#30; #42#9 = #0#29; #42#10 = #0#28;
   #42#11 = #0#27; #42#12 = #0#36;
   #42#13 = 0;
   #42#14 = 0;
   #42#15 = "";
   #42#16 = enOperFin;
   #42#17 = "S";
   |SI estado = 0;
      |GRABA 011#42a;
   |SINO;
      |GRABA 011#42n;
   |FINSI;
   |LIBERA #42;
   |CIERRA #42;
   eaMoneda = aMonedaA; |HAZ Monedas;

   |SI #41#41 = "S";
       |ABRE #49;
       #49#0 = #41#0;
       #49#2 = #41#2;
       #49#3 = #41#3;
       #49#4 = 1;
       |LEE 101#49=;
       estado = FSalida;
       #49#0 = #41#0;
       #49#1 = #41#1;
       #49#2 = #41#2;
       #49#3 = #41#3;
       #49#4 = 1;
       #49#5 = enEjercicio;
       #49#6 = #41#27;
       #49#7 = #0#36;
       #49#8 = #0#28;
       |SI estado ! 0; #49#9 = 100; |FINSI;
       #49#11 = "C";
       #49#12 = "N";

      |SI estado = 0; |GRABA 020#49a; |FINSI;
      |SI estado ! 0; |GRABA 020#49b; |FINSI;
      |LIBERA #49;
      |CIERRA #49;
   |FINSI;
|FPRC;

|| *******************************************************************
|PROGRAMA;

 |ABRE #41;
 |DDEFECTO #41;

 |PINPA #0#0;
 |SI enSwAna = 1;
     |ATRI P; |PINTA 1341, "Cta. Analitica: "; |ATRI 0;
     |C_M #0#39,1,"N";
     |C_V #0#39,1,"S";
 |SINO;
     |PINTA 1341, "                        "; |ATRI 0;
     |C_M #0#39,1,"N";
     |C_V #0#39,1,"N";
 |FINSI;

 |HAZ def_campos;
 |SI sw_er = 1;
     |CIERRA #41;
     |ACABA;
 |FINSI;

 |PINDA #0#0;

 |ENDATOS #1#0;
 |SI FSalida = 0;
     |HAZ actualiza;
     |HAZ anacta;
 |FINSI;
 |CIERRA #41;
|FPRO;
|| *******************************************************************

|PROCESO anacta;
    |SI enSwAna = 0; |ACABA; |FINSI;
    |SI eaGAna = "S"; |ACABA; |FINSI; ||No existe reparto especifico

    enQueAna = 1;
    nSwGrupo = 0;
    eaElemento = #0#0;
    enElemeNum = #0#1;
    eaElemeNom = #0#2;
    enElemeCom = #0#7;
    eaGrAna    = #0#39;
    |PUSHV 0622 2380;
    |SUB_EJECUTA_NP "anm00014";
    |POPV;
|FPRC;
