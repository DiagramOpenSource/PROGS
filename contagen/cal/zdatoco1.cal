||... Consulta Clientes

|FICHEROS;
     &program@ #0;

     caestasi #27;
     caselemp #10;
     cam00002 #12;
     caz00018 #13;
     caz00019 #14;
     anm00016 #15;
     caz00029 #16;
     cacamcts #17;
     caz00042 #18;
     cay00011 #19;
     cacterem #20;
     cactepre #21;
     caut0016 #22;
     caz00044 #23;
     casopliz #24;
     caarz003 #25;
     caary001 #26;

     :/basica/def/agifigen #1000;

     :/integral/def/pntm0001;
     :/integral/def/pntm0002;
|FIN;

|VARIABLES;
     &aPrograma     = "";
     nCampoCliente  = 0;

     aUsuario       = "";
     aAlfa          = "";
     nCanal         = 0;
|FIN;

|INCLUYE dscont_i;
|INCLUYE dscopi_i;

/******************** RESTRICCIONES PINET *****************/

|PROCESO RestriccionPINET;
     enErrorPINET = 0;
     enModoPINET1 = 0;
     enModoPINET2 = 0;
     enModoPINET3 = 0;
     enModoPINET4 = 0;

     |DBASS aBase;  |QBF aBase;
     aAlfa = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     aUsuario = Usuario % 810;

     |ABRE #pntm0001;
     |SELECT #2#pntm0001;
     #pntm0001#1 = aUsuario;
     |LEE 000#pntm0001.=;
     |SI FSalida ! 0;
         |CIERRA #pntm0001;
         |ACABA;
     |FINSI;
     |CIERRA #pntm0001;

     |ABRE #pntm0002;
     #pntm0002#0 = #pntm0001#0;
     #pntm0002#1 = enEmpresaPINET;
     |LEE 000#pntm0002.=;
     |SI FSalida ! 0;
         enErrorPINET = 1;

         #pntm0002#0 = #pntm0001#0;
         #pntm0002#1 = 1;
         |LEE 000#pntm0002.];

         enEmpresaPINET = #pntm0002#1;
     |SINO;
         |SI #pntm0002#3 = "N"; enModoPINET1 = 1; |FINSI;
         |SI #pntm0002#4 = "N"; enModoPINET2 = 1; |FINSI;
         |SI #pntm0002#5 = "N"; enModoPINET3 = 1; |FINSI;
         |SI #pntm0002#6 = "N"; enModoPINET4 = 1; |FINSI;
     |FINSI;

     |CIERRA #pntm0002;
|FPRC;
||////////////////////////////////////////////////////////////////////

|PROCESO MensaCliente; |TIPO 7;
     |MENSA "      <F2> Consulta Clientes ";
|FPRC;

|PROCESO ConsuCliente; |TIPO 0;
     |SI aPrograma = "";
         aPrograma = Control;  |QBF aPrograma;
     |FINSI;

     enSw = 0;
     |SI aPrograma = "caselemp"; |REFERENCIA_DEF program@, #10; enSw = 1; |FINSI;
     |SI aPrograma = "caz00010"; |REFERENCIA_DEF program@, #12; enSw = 1; |FINSI;
     |SI aPrograma = "cam00002"; |REFERENCIA_DEF program@, #12; enSw = 1; |FINSI;
     |SI aPrograma = "caz00018"; |REFERENCIA_DEF program@, #13; enSw = 1; |FINSI;
     |SI aPrograma = "caz00019"; |REFERENCIA_DEF program@, #14; enSw = 1; |FINSI;
     |SI aPrograma = "anm00016"; |REFERENCIA_DEF program@, #15; enSw = 1; |FINSI;
     |SI aPrograma = "caz00029"; |REFERENCIA_DEF program@, #16; enSw = 1; |FINSI;
     |SI aPrograma = "cacamcts"; |REFERENCIA_DEF program@, #17; enSw = 1; |FINSI;
     |SI aPrograma = "caz00042"; |REFERENCIA_DEF program@, #18; enSw = 1; |FINSI;
     |SI aPrograma = "cay00011"; |REFERENCIA_DEF program@, #19; enSw = 1; |FINSI;
     |SI aPrograma = "cacterem"; |REFERENCIA_DEF program@, #20; enSw = 1; |FINSI;
     |SI aPrograma = "cactepre"; |REFERENCIA_DEF program@, #21; enSw = 1; |FINSI;
     |SI aPrograma = "caut0016"; |REFERENCIA_DEF program@, #22; enSw = 1; |FINSI;
     |SI aPrograma = "caz00044"; |REFERENCIA_DEF program@, #23; enSw = 1; |FINSI;
     |SI aPrograma = "casopliz"; |REFERENCIA_DEF program@, #24; enSw = 1; |FINSI;
     |SI aPrograma = "caarz003"; |REFERENCIA_DEF program@, #25; enSw = 1; |FINSI;
     |SI aPrograma = "caary001"; |REFERENCIA_DEF program@, #26; enSw = 1; |FINSI;
     |SI aPrograma = "caestasi"; |REFERENCIA_DEF program@, #27; enSw = 1; |FINSI;

     |SI enSw = 0; |ACABA; |FINSI;

     |ATRI R; |BLIN 04; |ATRI 0;

     |SI FSalida ! 10; |ACABA; |FINSI;

     |PUSHV 0501 2380;
     nCampoCliente  = Campo;

     |ABRE #1000;
     #1000#0 = #0nCampoCliente;
     |LEE 040#1000=;

     |CONSULTA_CLAVE #2#1000;
     |CIERRA #1000;
     #0nCampoCliente = #1000#0;

     |POPV;
     |PINTA #0nCampoCliente;
|FPRC;
