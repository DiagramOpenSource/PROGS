|FICHEROS;
  caparsim #0,MANTE;
  caparsil #1,MANTE;
  caz00022 #10;

  cacuenta #2;
  cacuebal #3;
  caparbal #4;
  caparexp #5;
  caagrupa #11;
  caepigra #12;

  &caparsi@ #900;
|FIN;

|VARIABLES;
  &entrada  = 1;
  &nBloque  = 0;
  inkey     = 0;
  esalta    = 0;
  esaltaL   = 0;
  nSwSal    = 0;

  aAlfa1    = "";
  aAlfa2    = "";
  nNume1    = 0;
  nNume2    = 0;
  nSw1      = 0;
  nSw2      = 0;
  nSw3      = 0;
  nLinea    = 0;
|FIN;

|INCLUYE dscont_i;

**************************************************************************
|RUTINA ClaveBajaL;
     #1#0  = #0#0;
     #1#1  = #0#1;
     #1#2  = #0#2;
     #1#3  = #0#3;
     #1#4  = #0#4;
     #1#5  = 001;
|FRUT;

|RUTINA ClaveAltaL;
     #1#0  = #0#0;
     #1#1  = #0#1;
     #1#2  = #0#2;
     #1#3  = #0#3;
     #1#4  = #0#4;
     #1#5  = 999;
|FRUT;

**************************************************************************
|CALCULO descri1; |TIPO 0;
  |PINTA #10#0;
  |PINTA #10#1;
  |HAZ PresentaLinea;
|FCAL;

|PROCESO BorraLineas;
     |BORRA 140#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE caparsil;
     #1#1;
     ;
     #0#0, #0#1, #0#2, #0#3, #0#4, 001;
     #0#0, #0#1, #0#2, #0#3, #0#4, 999;
     be;
     NULL, BorraLineas;
|FIN;

|CALCULO Tipo2_1;  |TIPO 2;
     esalta  = (FEntrada / 100) ! 0;
     |SI esalta ! 3;  |ACABA;  |FINSI;
     |BUCLE caparsil;
|FCAL;

||************************************************************************
|CALCULO elTipo3; |TIPO 3;
    esalta  = (FEntrada / 100) ! 0;
    nSwSal = 0;
    |ENTLINEAL #1#1, -6, 2, 21, 0, ClaveBajaL, ClaveAltaL;
|FCAL;

|CALCULO PresentaLinea;  |TIPO 7;
    |PINTA #10#0;
    |PINTA #10#1;
    nSwSal = 1;
    |ENTLINEAL #1#1, -6, 7, 21, 0, ClaveBajaL, ClaveAltaL;
|FCAL;

|CALCULO elTipo13; |TIPO 13;
   |SI #0#1 = "A"; aAlfa1 = "(ACTIVO)"; |FINSI;
   |SI #0#1 = "P"; aAlfa1 = "(PASIVO)"; |FINSI;
   |SI #0#1 = "D"; aAlfa1 = "  (DEBE)"; |FINSI;
   |SI #0#1 = "H"; aAlfa1 = " (HABER)"; |FINSI;
   |ATRI I; |PINTA 0762,aAlfa1; |ATRI 0;
|FCAL;

|PROCESO LeeEspejo;
 |SI #0#0 = #900#0; |Y #0#1 = #900#1; |Y #0#2 = #900#2; |Y #0#3 = #900#3;
     |Y #0#4 = #900#4;
        |ACABA;
 |FINSI;
 |SI nSw1 = 0;
     #0#5 = #900#5;
     nSw1 = 1;
 |FINSI;
 |SI nSw2 = 0; |Y #900#3 = #0#3;
     #0#6 = #900#6;
     nSw2 = 1;
 |FINSI;
 |SI nSw1 = 1; |Y nSw2 = 1;
     |ERROR10;
 |FINSI;
|FPRC;

|DEFBUCLE LeeEspejo;
 #900#1005;
 ;
 #0#0, #0#1, #0#2,   01, 00;
 #0#0, #0#1, #0#2, #0#3, 99;
 e;
 NULL, LeeEspejo;
|FIN;


|CALCULO VerDescripcion; |TIPO 0;

   esalta  = (FEntrada / 100) ! 0;
   |SI esalta ! 1; |ACABA; |FINSI;

   nSw1 = 0; |C_M #0#5,1,"N";
   nSw2 = 0; |C_M #0#6,1,"N";
   |BUCLE LeeEspejo;
   |SI nSw1 = 0;
       |HAZ LeeAgrupa;
       |C_M #0#5,1,"S";
   |FINSI;
   |SI nSw2 = 0;
       |HAZ LeeEpigra;
       |C_M #0#6,1,"S";
   |FINSI;
   |HAZ LeePartida;
   |C_M #0#7,1,"S";

   |PINTA #0#5;
   |PINTA #0#6;
   |PINTA #0#7;
|FCAL;

|| ************************************************************************
|CALCULO SalgoYa;  |TIPO 7;
     |SI nSwSal = 1;  |PTEC 807;  |FINSI;
|FCAL;

|CALCULO Tipo0_L; |TIPO 0;
   aAlfa1 = #1Campo % A101;
   |SI aAlfa1 = "6"; |O aAlfa1 = "7";
      |SI #1#1 ! "D"; |Y #1#1 ! "H";
         |AVISO;
         |ERROR;
      |FINSI;
   |SINO;
      |SI #1#1 ! "A"; |Y #1#1 ! "P";
         |AVISO;
         |ERROR;
      |FINSI;
   |FINSI;
|FCAL;

|| ====================== Lee los primeros
|PROCESO LeeAgrupa;
   |ABRE #11;
   #11#0 = #0#1;
   #11#1 = #0#2;
   |LEE 001#11=;
   |SI FSalida = 0;
       #0#5 = #11#2;
   |FINSI;
   |CIERRA #11;
|FPRC;

|PROCESO LeeEpigra;
   |ABRE #12;
   #12#0 = #0#1
   #12#1 = #0#2;
   #12#3 = #0#3;
   |LEE 001#2=;
   |SI FSalida = 0;
       #0#6 = #12#4;
   |FINSI;
   |CIERRA #12;
|FPRC;

|PROCESO LeeExplota;
 #0#7 = #5#7;
|FPRC;

|DEFBUCLE LeeExplota;
 #5#1;
 ;
 1, #0#1, #0#2, #0#3, #0#4;
 4, #0#1, #0#2, #0#3, #0#4;
 ;
 NULL, LeeExplota;
|FIN;

|PROCESO LeeCuentas;
 nLinea = nLinea + 1;
 #1#0 = #0#0;
 #1#1 = #0#1;
 #1#2 = #0#2;
 #1#3 = #0#3;
 #1#4 = #0#4;
 #1#5 = nLinea;
 |LEE 101#1=;
 |SI FSalida ! 0;
      #1#0 = #0#0;
      #1#1 = #0#1;
      #1#2 = #0#2;
      #1#3 = #0#3;
      #1#4 = #0#4;
      #1#5 = nLinea;
      |GRABA 020#1b;
 |FINSI;
 #1#6 = #3#0;
 |GRABA 020#1a;
 |LIBERA #1;
|FPRC;

|DEFBUCLE LeeCuentas;
 #3#1;
 2,3,4,5;
 "            ", #0#1, #0#2, #0#3, #0#4;
 "zzzzzzzzzzzz", #0#1, #0#2, #0#3, #0#4;
 ;
 NULL, LeeCuentas;
|FIN;

|PROCESO RecogeLineas;
   nLinea = 0;
   |ABRE #1;
   |BUCLE LeeCuentas;
   |CIERRA #1;
|FPRC;

|PROCESO LeePartida;
   |SI #0#0 = 0;
       |ABRE #4;
       #4#0 = #0#1;
       #4#1 = #0#2;
       #4#3 = #0#3;
       #4#5 = #0#4;
       |LEE 001#4=;
       |SI FSalida = 0;
           #0#7 = #4#6;
       |FINSI;
       |CIERRA #4;
   |SINO;
       |BUCLE LeeExplota;
   |FINSI;
   |HAZ RecogeLineas;
|FPRC;
