|FICHEROS;
   caz00010 #0;
   cam00001 #1;
   cam00002 #2,MANTE;
   cam00003 #3,MANTE;
   cam00004 #4,MANTE;
   cam00005 #5,MANTE;

   canempre #30;
|FIN;

|VARIABLES;
 &enPor = 0;
 nTecla = 0;
 nModo = 0;
 nModoEntrada = 0;
 nInkey = 0;

 &nMaxDes  = 0;
 &nMaxOri  = 0;
 {-1}punt1 = 0;
 ddig3 = 0;
 ddig4 = 0;
 ddig5 = 0;
 ddig6 = 0;
 ddig7 = 0;
 ddig8 = 0;
 ddig9 = 0;

 &eaDirDestino = "";
 &eaDirOrigen  = "";
 aAlfa1 = "";
 aAlfa2 = "";
|FIN;

|INCLUYE dscont_i;

|| **********************************************************
|CALCULO LeeEmp; |TIPO 0;
  nModoEntrada = (FEntrada / 100) ! 0;

  |SI #2#1 = #0#0;
      |MENAV "    Error!. Introducida Empresa Destino ";
      |ERROR;
      |ACABA;
  |FINSI;


  |ABRE #30;
  |SELECT #4#30;
  #30#2  = #2#1;
  #30#26 = #0#10;
  |LEE 010#30=;
  |SI FSalida ! 0;
      |MENAV "    No existe la empresa ";
      |CIERRA #30;
      |SI nModoEntrada = 1;
          |ERROR;
          |ACABA;
      |FINSI;
  |FINSI;
  |CIERRA #30;
  |SELECT #1#30;

  ddig3 = #30#13;
  ddig4 = #30#14;       || 1 nivel
  ddig5 = #30#15;       || 2 nivel
  ddig6 = #30#16;       || 3 nivel
  ddig7 = #30#17;       || 4 nivel
  ddig8 = #30#18;       || 5 nivel
  ddig9 = #30#19;       || 6 nivel

  || Recoger informacion sobre los niveles ...
  Ipunt1 = ddig3<-;
  Ipunt1 = Ipunt1 + ddig3;
  nMaxOri = punt1;

  |SI MaximoDigitos ! nMaxOri;
      |MENAV "    No corresponde Nivel Cuentas ";
      |ERROR;
      |ACABA;
  |FINSI;

  #2#0 = #0#0;
  #2#2 = #30#1; |PINTA #2#2;

  |DFICB aAlfa1;
  aAlfa2 = #30#0; |QBF aAlfa2;
  aAlfa2 = ("000000" + #30#0) % -106;
  eaDirOrigen = aAlfa1 + aAlfa2 + "/";
|FCAL;

|CALCULO AntesDepar; |TIPO 7;
  |SI #30#24 = "N";
      |C_M #2#12, 1, "N"; #2#12 = "00";
  |SINO;
      |C_M #2#12, 1, "S";
  |FINSI;
|FCAL;

|CALCULO AntesDig; |TIPO 7;
  |SI #0#6 = 0; |Y #0#7 = 0;
      |C_M #2#3,  1, "N"; #2#3 = "000";
      |C_M #2#19, 1, "N";
      |C_M #2#21, 1, "N";
  |SINO;
      |C_M #2#3,  1, "S";
      |C_M #2#19, 1, "S";
      |C_M #2#21, 1, "S";
  |FINSI;
|FCAL;

|CALCULO AbansDig; |TIPO 7;
  |SI #2#19 = 1;
      aAlfa1 = "    Introduzca el Digito diferenciador 0-9";
  |SINO;
      |SI #2#19 = 2;
          aAlfa1 = "    Introduzca el Digito diferenciador 00-99";
      |SINO;
          aAlfa1 = "    Introduzca el Digito diferenciador 000-999";
      |FINSI;
  |FINSI;
  |MENSA aAlfa1;
|FCAL;

|CALCULO DespuDig; |TIPO 0;

  |BLIN 4;
  |SI FSalida = 2; |ACABA; |FINSI;

  |C_M #2#3, 0, aAlfa1;
  |SI aAlfa1 = "N"; |ACABA; |FINSI;

  |SI #2#19 = 1; |Y #2#3 > 9;
      |ERROR;
  |SINO;
      |SI #2#19 = 2; |Y #2#3 > 99;
          |ERROR;
      |FINSI;
  |FINSI;
|FCAL;

|CALCULO ConcepH; |TIPO 0;
  |SI #2#14 < #2#13;
      |ERROR;
  |FINSI;
|FCAL;

|CALCULO AntesDiario; |TIPO 7;
  |SI #0#5 ! 3;
      |C_M #2#4, 1, "S";
      |C_M #2#7, 1, "S";
  |SINO;
      |C_M #2#4, 1, "N"; #2#4 = "S"; |PINTA #2#4;
      |C_M #2#5, 1, "N"; #2#5 = 00; |PINTA #2#5;
      |C_M #2#6, 1, "N"; #2#6 = 99; |PINTA #2#6;
      |C_M #2#7, 1, "N"; #2#7 = 0;  |PINTA #2#7;
  |FINSI;
|FCAL;

|CALCULO losDiarios; |TIPO 0;
  |C_M #2#4, 0, aAlfa1;
  |SI aAlfa1 = "N"; |ACABA; |FINSI;

  |SI #2#4 = "S";
      |C_M #2#5, 1, "S";
      |C_M #2#6, 1, "S";
  |SINO;
      |C_M #2#5, 1, "N"; #2#5 = 00; |PINTA #2#5;
      |C_M #2#6, 1, "N"; #2#6 = 99; |PINTA #2#6;
  |FINSI;
|FCAL;

|CALCULO AntesLibro; |TIPO 7;
  |SI enPor ! 0; |ACABA; |FINSI;
  |SI #0#5 ] 3;
      |C_M #2#8,  1, "S";
      |C_M #2#11, 1, "S";
      |C_M #2#20, 1, "S";
  |SINO;
      |C_M #2#8,  1, "N"; #2#8  = "S"; |PINTA #2#8;
      |C_M #2#9,  1, "N"; #2#9  = 01;  |PINTA #2#9;
      |C_M #2#10, 1, "N"; #2#10 = 99;  |PINTA #2#10;
      |C_M #2#11, 1, "N"; #2#11 = 0;   |PINTA #2#11;
      |C_M #2#20, 1, "N"; #2#20 = "N"; |PINTA #2#20;
  |FINSI;
|FCAL;

|CALCULO losLibros; |TIPO 0;
  |SI enPor ! 0; |ACABA; |FINSI;

  |C_M #2#8, 0, aAlfa1;
  |SI aAlfa1 = "N"; |ACABA; |FINSI;

  |SI #2#8 = "S";
      |C_M #2#9,  1, "S";
      |C_M #2#10, 1, "S";
  |SINO;
      |C_M #2#9,  1, "N"; #2#9  = 01; |PINTA #2#9;
      |C_M #2#10, 1, "N"; #2#10 = 99; |PINTA #2#10;
  |FINSI;
|FCAL;


|| ------------------------------------
|PROCESO BorraLin30;
 |BORRA 020#3a;
 |LIBERA #3;
|FPRC;

|DEFBUCLE borrarLin3;
 #3#1;
 ;
 #2#0, #2#1, 00;
 #2#0, #2#1, 99;
 be;
 NULL, BorraLin30;
|FIN;

|PROCESO BorraLin40;
 |BORRA 020#4a;
 |LIBERA #4;
|FPRC;

|DEFBUCLE borrarLin4;
 #4#1;
 ;
 #2#0, #2#1, 00;
 #2#0, #2#1, 99;
 be;
 NULL, BorraLin40;
|FIN;

|PROCESO BorraLin50;
 |BORRA 020#5a;
 |LIBERA #5;
|FPRC;

|DEFBUCLE borrarLin5;
 #5#1;
 ;
 #2#0, #2#1, 000;
 #2#0, #2#1, 999;
 be;
 NULL, BorraLin50;
|FIN;

|CALCULO Tipo1; |TIPO 1;
 nModoEntrada = (FEntrada / 100) ! 0;

 |SI nModoEntrada = 3;
     |BUCLE borrarLin3;
     |BUCLE borrarLin4;
     |BUCLE borrarLin5;
 |FINSI;

|FCAL;

|| **********************************************************************
|RUTINA ClaveBaja3;
     #3#0 = #2#0;
     #3#1 = #2#1;
     #3#2 = 01;
|FRUT;

|RUTINA ClaveAlta3;
     #3#0 = #2#0;
     #3#1 = #2#1;
     #3#2 = 99;
|FRUT;

|RUTINA ClaveBaja4;
     #4#0 = #2#0;
     #4#1 = #2#1;
     #4#2 = 01;
|FRUT;

|RUTINA ClaveAlta4;
     #4#0 = #2#0;
     #4#1 = #2#1;
     #4#2 = 99;
|FRUT;

|RUTINA ClaveBaja5;
     #5#0 = #2#0;
     #5#1 = #2#1;
     #5#2 = 001;
|FRUT;

|RUTINA ClaveAlta5;
     #5#0 = #2#0;
     #5#1 = #2#1;
     #5#2 = 999;
|FRUT;


|PROCESO Tipo13;  |TIPO 13;
     nModo = 7;
     |ENTLINEAL #1#3, -3, 7, 22, 0, ClaveBaja3, ClaveAlta3;
     |SI enPor = 0;
         |ENTLINEAL #1#4, -3, 7, 22, 0, ClaveBaja4, ClaveAlta4;
     |FINSI;
|FPRC;

|PROCESO Tipo11;  |TIPO 11;
  nInkey = FSalida;
  |SI nInkey = 10;
      |HAZ ConsuCliente;
      |ERROR;
      |PTEC 802;
  |FINSI;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
 |SI #2#4 = "N";
     |ENTLINEAL #1#3, -3, 2, 22, 0, ClaveBaja3, ClaveAlta3;
 |SINO;
     |BUCLE borrarLin3;
     |ENTLINEAL #1#3, -3, 7, 22, 0, ClaveBaja3, ClaveAlta3;
 |FINSI;
 |SI enPor = 0;
     |SI #2#8 = "N";
         |ENTLINEAL #1#4, -3, 2, 22, 0, ClaveBaja4, ClaveAlta4;
     |SINO;
         |BUCLE borrarLin4;
         |ENTLINEAL #1#4, -3, 7, 22, 0, ClaveBaja4, ClaveAlta4;
     |FINSI;
 |FINSI;
 |SI #2#15 = "N";
     |BUCLE borrarLin5;
 |FINSI;
|FPRC;

|CALCULO Excluir; |TIPO 0;
 |PUSHV 1301 2380;
 |SI #2#15 = "S";
      |ENTLINEAL #1#5, -3, 2, 22, 1, ClaveBaja5, ClaveAlta5;
 |SINO;
     |BUCLE borrarLin5;
     |ENTLINEAL #1#5, -3, 7, 22, 1, ClaveBaja5, ClaveAlta5;
 |FINSI;
 |POPV;
|FCAL;

|CALCULO Antes17; |TIPO 7;
 aAlfa1 = #2#15;
 |C_M #2#17,1,aAlfa1;
 |SI #0#5 ! 1;
     #2#17 = "S";
     |PINTA #2#17;
     |C_M #2#17,1,"N";
 |FINSI;
|FCAL;
