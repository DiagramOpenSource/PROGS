|FICHEROS;
     caconiso #0;
     :/modelos/def/dsmom030 #2;
     cacuenta #4;
|FIN;

|VARIABLES;
     aAlfa   = "";
     aCuenta = "";
     aLong   = "";
     aCaracter = "";

     nSw     = 0;
     nCampo1 = 0;
     nCampo2 = 0;
     nPosi   = 0;
     nCampo  = 0;
     p_alfa1 = "";
|FIN;

|INCLUYE dscont_i;

|PROCESO Punto;
     aAlfa   = "";
     |PARA nCampo = 1;  |SI nCampo [ 12;  |HACIENDO nCampo = nCampo + 1;
           nPosi = (nCampo * 100) + 1;
           aCaracter = #0#4 % nPosi;
           |SI aCaracter = "0"; |O aCaracter = "1"; |O aCaracter = "2";
            |O aCaracter = "3"; |O aCaracter = "4"; |O aCaracter = "5";
            |O aCaracter = "6"; |O aCaracter = "7"; |O aCaracter = "8";
            |O aCaracter = "9";
                   aAlfa = aAlfa + aCaracter;
          |FINSI;
     |SIGUE;
     aAlfa = aAlfa + ".a";
     #0#4 = aAlfa;  |PINTA #0#4;
|FPRC;


|PROCESO Cuenta;   |TIPO 6;
      aAlfa   = #0Campo;
      p_alfa1 = #0Campo;

      eaCuenta = #0Campo;
      salidas  = FSalida;
      |HAZ FiltraPuntos;
      #0Campo = eaCuenta;
      |PINTA #0Campo;

      |SI #0Campo = "            ";  |ACABA;  |FINSI;

      aCuenta = #0Campo;   |QBT aCuenta;
      aLong   = aCuenta % A0;
      nSw     = 0;
      nCampo1 = Campo + 1;

      aAlfa   = aCuenta % -101;
      |SI aAlfa = "*";  #0nCampo1 = 0;  |ACABA;  |FINSI;

      |SI aLong = dig4; nSw = 1; #0nCampo1 = 1; |FINSI;
      |SI aLong = dig5; nSw = 1; #0nCampo1 = 2; |FINSI;
      |SI aLong = dig6; nSw = 1; #0nCampo1 = 3; |FINSI;
      |SI aLong = dig7; nSw = 1; #0nCampo1 = 4; |FINSI;
      |SI aLong = dig8; nSw = 1; #0nCampo1 = 5; |FINSI;
      |SI aLong = dig9; nSw = 1; #0nCampo1 = 6; |FINSI;

      |SI nSw = 0;
          |MENAV  "     Longitud de Cuenta Fuera de Nivel !";
          |ERROR;
      |FINSI;
|FPRC;


|PROCESO NombreCuenta;  |TIPO 0;
     |SI #0Campo = "            ";  |ACABA;  |FINSI;

     nCampo1 = Campo + 1;
     nCampo2 = Campo + 2;

     aCuenta = #0Campo;   |QBT aCuenta;
     aAlfa   = aCuenta % -101;
     |SI aAlfa = "*";  #0nCampo1 = 0;  |ACABA;  |FINSI;

     |ABRE #4;
     |SELECT #1#4;
     #4#0 = #0Campo;
     #4#1 = #0nCampo1;
     |LEE 000#4=;
     |SI FSalida ! 0;
         |MENAV "      No existe Cuenta ";
         |CIERRA #4;
         |ERROR;
         |ACABA;
     |FINSI;

     |SI #4#3 = "N";
         |MENAV "      Esta Cuenta NO tiene Pase directo";
         |CIERRA #4;
         |ERROR;
         |ACABA;
     |FINSI;
     |CIERRA #4;

     #0nCampo2 = #4#2;
     |PINTA #nCampo2;
|FPRC;

|PROGRAMA;
    |HAZ inicio;

    |CLS;
    |CABEZA "Asiento Impuesto Sociedades";
    |ABRET #0;
    |LEE 101#0p;
    |SI FSalida ! 0;
       |DDEFECTO #0;
       |GRABA 020#0b;
    |FINSI;

    |PINPA #0#0;
    |PINDA #0#0;
    |ENDATOS #1#0;
    |SI FSalida = 0;  |GRABA 020#0a;  |FINSI;
    |LIBERA #0;
    |CIERRA #0;
|FPRO;
