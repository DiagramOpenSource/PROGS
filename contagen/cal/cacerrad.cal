|FICHEROS;
   cacerrad #0;
   camandia #39;
|FIN;

|VARIABLES;
   &v_codigo = 0;
   &v_period = 0;
   &v_nombre = "";
   &enganche = 0;
   &r_emp = 0;
   &r_per = 0;
   v_path = "";
   alfa1 = "";

   nHay99 = 0;
   nCanal = 0;
   fFecha = @;
   aAlfa1 = "";
|FIN;

|INCLUYE dscont_i;
|INCLUYE impdat_i;

|PROCESO PantaImp;
       aTexImp = " - " + aTexImp + "                                                    ";
       aTexImp = aTexImp % 0152;
       |SI nHay01 = 1; |Y nHay04 = 1; |D_CUADRO 1513,1966; |FINSI;
       |SI nHay01 = 0; |O nHay04 = 0; |D_CUADRO 1513,1866; |FINSI;
       |ATRI R;
       |PINTA 1614," ATENCION:  Esta Empresa tiene datos informados en  ";
       |SI nHay01 = 1;
           |PINTA 1714," - Entrada General de Datos Contables afectos al IS ";
       |FINSI;
       |SI nHay04 = 1;
           |SI nHay01 = 0; |PINTA 1714, aTexImp; |FINSI;
           |SI nHay01 = 1; |PINTA 1814, aTexImp; |FINSI;
       |FINSI;
       |ATRI r;
|FPRC;

|PROGRAMA;
|| .... Nuevo Control de Impuesto de Sociedades
   |DBASS aBase; |QBT aBase;  || Directorio Base de las Aplaciones
   aPContas = aBase + "contasoc/"; || contasoc   Contabilidad Sociedades
   aElProgr = aPContas + "def/isacceso.mas";
   |XABRE "E", aElProgr, nCanal;
   |SI FSalida < 0;
       aPContas = "";
   |FINSI;
   |XCIERRA nCanal;

   |DFICE v_path;
   alfa1 = v_codigo;  alfa1 = "000000" + alfa1;  alfa1 = alfa1 % -105;
   alfa1 = alfa1 + v_period;
   v_path = v_path + alfa1 + "/";
   |PATH_DAT #camandia #v_path#;

   nHay01 = 0; nHay02 = 0;
   nHay03 = 0; nHay04 = 0;
   nHay99 = 0;

   |ABRE #39;
   #camandia#0 = 99;
   |LEE 040#39=;
   |SI FSalida = 0;  |Y #camandia#2 ! 0;  |Y #camandia#3 ! 0;
       nHay99 = 1;
   |FINSI;
   |CIERRA #39;

   nEmpImp = #48#2;
   nEjeImp = #48#26;
   |SI nEjeImp > 80;
       nEjeImp = 1900 + nEjeImp;
   |SINO;
       nEjeImp = 2000 + nEjeImp;
   |FINSI;
   fFecha = #48#34;
   alfa1  = nEjeImp; alfa1 = "31.12."+alfa1; fec2   = alfa1;

   |SI aPContas ! "";
       |HAZ MiroImpuesto;
   |FINSI;

   |SI nHay99 = 1; |O nHay01 = 1; |O nHay04 = 1;
       |AVISO;
       |SI nHay99 = 1; |PINPA #0#0; |FINSI;
       |SI nHay01 = 1; |O nHay04 = 1; |HAZ PantaImp; |FINSI;
       |AVISO;
       |PAUSA;

       |SI fFecha < fec2; |O fFecha = "01.01.0000";
           |SI nHay01 = 1;
               aAlfa1 = "    NBorrar la Entrada de Datos Contables afectos al IS.";
               |CONFI aAlfa1;
               |SI FSalida = 0;
                   |HAZ BSodacoca;
               |FINSI;
           |FINSI;
       |FINSI;
   |FINSI;
|FPRO;
