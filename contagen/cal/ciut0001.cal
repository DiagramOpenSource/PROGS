|FICHEROS;
   ciut0001 #0;

   cacuenta #4;
   :/modelos/def/dsmom030 #1;
   cisalant #10;

   canempre #30;
   caselem1 #998;
|FIN;

|VARIABLES;
   &entrada  = 1;
   aAlfa1    = "";
   aAlfa2    = "";
   aAlfa3    = "";
   aAlfa4    = "";
   ConcepAnt = 0;
|FIN;

|INCLUYE dscont_i;

____________________________________/ CALCULOS DESDE PANTALLA

|CALCULO AntConcep; |TIPO 7;
 ConcepAnt = #0Campo;
|FCAL;

|CALCULO concepto;  |TIPO 0;
|FCAL;

|CALCULO recoge; |TIPO 7;
  |C_M #0Campo,0,aAlfa1;
  |SI aAlfa1 = "N"; |ACABA; |FINSI;

       |ABRE #dsmom030;
       #dsmom030#0 = #0#0;
       |LEE 021#dsmom030.=;
       |SI FSalida ! 0;  |DDEFECTO #dsmom030;  |FINSI;
       #0Campo = #dsmom030#1;
       |PINTA #0Campo;
       |CIERRA #dsmom030;
       |PTEC 816;
|FCAL;

|CALCULO cuenta; |TIPO 6;
  eaCuenta = #0Campo;
  salidas  = FSalida;
  |HAZ FiltraPuntos;
  #0Campo = eaCuenta;
  |PINTA #0Campo;
|FCAL;

|CALCULO QueHago; |TIPO 0;
  aAlfa1 = #0Campo;
  |SI Campo = 4;
      |C_M #0#0, 1, aAlfa1;
      |C_M #0#1, 1, aAlfa1;
      |C_M #0#2, 1, aAlfa1;
      |C_M #0#3, 1, aAlfa1;
  |FINSI;

  |SI Campo = 7;
      |C_M #0#5, 1, aAlfa1;
      |C_M #0#6, 1, aAlfa1;
  |FINSI;

  |SI Campo = 9;
      |C_M #0#8,  1, aAlfa1;
  |FINSI;
|FCAL;

|| ***********************************************************************
|PROCESO LeoSaldoAnt;
   aAlfa1 = #10#0; |QBF aAlfa1;
   |SI aAlfa1 = ""; |ACABA; |FINSI;

   |SI #0#4 = "S";
       #10#8  = #0#0;
       #10#9  = #0#1;
       #10#10 = #0#2;
       #10#11 = #0#3;
   |FINSI;

   |SI #0#7 = "S";
       #10#12 = #0#5;
       #10#13 = #0#6;
   |FINSI;

   |SI #0#9 = "S";
       #10#14 = #0#8;
   |FINSI;

   |GRABA 020#10a;
   |LIBERA #10;
|FPRC;

|DEFBUCLE LeoSaldoAnt;
 #10#1;
 ;
 #0#10;
 #0#11;
 be;
 NULL, LeoSaldoAnt;
|FIN;

|PROCESO HazTodo;
   |PATH_DAT #10 dirfich0;

   |BUCLE LeoSaldoAnt;
|FPRC;


|PROCESO MultiEmp1;
   cod1 = #caselem1#1;
   cod2 = #caselem1#2;
   emEmp = 1;  || Sin mensaje
   |HAZ leelo;
   |SI swerror ! 0;  |ACABA;   |FINSI;

   |PINTA 2222, #30#2;
   |PINTA 2228, #30#3;
   |PINTA 2230, #30#1;

   dirfich0  = #caselem1#3;
   |QBF dirfich0;

   |HAZ HazTodo;
|FPRC;


|DEFBUCLE MultiEmp0;
 #caselem1#1;
 ;
 001;
 999;
 ;
 NULL,MultiEmp1;
|FIN;


|CALCULO recupera; |TIPO 3;

   |SI #0#4 = "N"; |Y #0#7 = "N"; |Y #0#9 = "N";
       |MENAV "    NO MODIFICA NINGUN DATO DE LOS DEFECTOS ";
       |ACABA;
   |FINSI;

   |SUB_EJECUTA "caselemp";
   |NOME_DAT #998 eaFichsel;
   |ATRI R; |PINTA 2202, "Procesando Empresa: "; |ATRI 0;
   |BUCLE MultiEmp0;
   |DELINDEX #998;
|FCAL;
