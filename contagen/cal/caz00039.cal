|FICHEROS;
   caz00039 #0;

   camaniva #11;
   caivalin #12;
   caivaasi #200;
   caivam03 #223;

  :/modelos/def/dsmom030 #330;

   canempre #30;
|FIN;

|VARIABLES;
    aParam     = "";
    nEjer      = 0;
    &eaTip349  = "";
    nSwNoDir   = 0;

    aAlfa1     = "";
    aAlfa2     = "";
    nNume1     = 0;
    nNume2     = 0;
    nPara1     = 0;
    nSw        = 0;
    nExis      = 0;
|FIN;

|INCLUYE dscont_i;

|| ***************** Calculos de Pantalla

|CALCULO defecto; |TIPO 7;
  #0#0 = enEjercicio; |PINTA #0#0;
|FCAL;

|| *************************************************************************
|| **************************   MEOLLO   ***********************************
|| *************************************************************************
|PROCESO CalDirectorio;
  |DBASE dir_fich; |QBF dir_fich;
  dir_fich = dir_fich + "fich/";
  aAlfa1 = #30#2; |QBF aAlfa1;
  aAlfa2 = #30#3; |QBF aAlfa2;
  aAlfa1 = "00000" + aAlfa1;   aAlfa1 = aAlfa1 % -105;
  aAlfa2 = "0"     + aAlfa2;   aAlfa2 = aAlfa2 % -101;
  dirfich0 = dir_fich + aAlfa1 + aAlfa2 + "/";

  nSwNoDir = 0;
  |MKDIR dirfich0;
  |SI FSalida = 0;
      nSwNoDir = 1;
      |RMDIR dirfich0;
  |FINSI;
|FPRC;

|PROCESO PrimerIVA;
  #223#10 = #12#7;
  #223#11 = (#223#9 % #223#10);
  |ERROR10;
|FPRC;

|DEFBUCLE PrimerIVA;
  #12#1;
  ;
  #11#0, #11#1, 01;
  #11#0, #11#1, 99;
  e;
  NULL, PrimerIVA;
|FIN;

|PROCESO LeeConcepto;
  eaTip349 = "";
  |DDEFECTO #330;
  #330#0 = #11#27;
  |LEE 001#330=;
  |SI FSalida = 0; |Y #330#72 = "S";
      |SI #dsmom030#26 = 5; eaTip349 = "AR";  |FINSI;
      |SI #dsmom030#26 = 6; eaTip349 = "IR";  |FINSI;
      |SI #dsmom030#30 = 2; eaTip349 = "AR";  |FINSI;
      |SI #dsmom030#30 = 3; eaTip349 = "IR";  |FINSI;
      |SI #dsmom030#34 = 9; eaTip349 = "ER";  |FINSI;
      |SI #dsmom030#34 = 4; eaTip349 = "SR";  |FINSI;
  |FINSI;
|FPRC;

|PROCESO Actual;
      nExis    = 0;
      #11#0 = #223#0;
      #11#1 = #223#1;
      |LEE 041#11=;
      |SI FSalida = 0;
          |HAZ LeeConcepto;
          |SI eaTip349 ! ""; nExis = 1; |FINSI;
      |FINSI;

      |SI nExis = 1;
          nSw = 0;
          |PARA nPara1 = 9; |SI nPara1 [ 29; |HACIENDO  nPara1 = nPara1 + 1;
                |SI #223nPara1 ! 0; nSw = 1; |SAL; |FINSI;
          |SIGUE;

          |SI nSw = 0;
              #223#9 = #223#6;
              |SI eaTip349 = "AR"; |O eaTip349 = "IR";
                  |BUCLE PrimerIVA;
              |FINSI;

              |GRABA 020#223a;
           |FINSI;
      |SINO;
           |BORRA 040#223a;
      |FINSI;
      |LIBERA #223;
|FPRC;

|DEFBUCLE caivam03;
    #223#1;
    ;
    01, 0000000001;
    99, 9999999999;
    be;
    NULL, Actual;
|FIN;

|PROCESO HazTodo;

   |HAZ CalDirectorio;
   |SI nSwNoDir = 0;

       enEmpresa = #30#2;
       |PATH_DAT #11  dirfich0;
       |PATH_DAT #12  dirfich0;
       |PATH_DAT #200 dirfich0;
       |PATH_DAT #223 dirfich0;

       |ABRE #200;
       |DDEFECTO #200;
       |LEE 000#200p;
       |CIERRA #200;

       |ABRE #11;
       |ABRE #330;
       |BUCLE caivam03;
       |CIERRA #11;
       |CIERRA #330;
  |FINSI;
|FPRC;

|DEFBUCLE PorEmpresas;
    #30#1;
    26;
    00001, 0, nEjer;
    99999, 9, nEjer;
    ;
    NULL, HazTodo;
|FIN;

|CALCULO impre; |TIPO 3;

   aAlfa1 = #0#0;
   aAlfa1 = aAlfa1 % -102;
   nEjer  = aAlfa1;

   |BUCLE PorEmpresas;
|FCAL;


|PROGRAMA;
  aParam = PARAMETRO; |QBF aParam;
  |SI aParam = "";
      |MANTE #0;
  |SINO;
      #0#0 = enEjercicio;
      |HAZ impre;
  |FINSI;
|FPRO;
