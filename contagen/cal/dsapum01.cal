|FICHEROS;
     dsapum01 #0;
     reflejo@  #20;
|FIN;

|VARIABLES;
     nTecla    = 0;
     aAlfa     = "";
     aDef      = "";
     aPath     = "";
     nDEmpresa = 0;
     nHEmpresa = 0;
     nCampo1   = 0;
|FIN;

|INCLUYE dscont_i;

|RUTINA ClaveBaja20;
     #20#0 = nDEmpresa;
     #20#5 = "        ";
     #20#7 = "01.01.0000";
     #20#8 = "    ";
|FRUT;

|RUTINA ClaveAlta20;
     #20#0 = nHEmpresa;
     #20#5 = "zzzzzzzz";
     #20#7 = "31.12.2099";
     #20#8 = "zzzz";
|FRUT;

|PROCESO Tipo11;  |TIPO 11;
     nTecla = FSalida;

     |SI nTecla ! 10; |Y nTecla ! 11; |Y nTecla! 12;  |ACABA;  |FINSI;

     |DBASE aPath;  |QBT aPath;
     aDef = aPath + "def/dsapum01.mas";
     |CARGA_DEF aDef, reflejo@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def dsapum01.mas";
         |MENAV aAlfa;
         |ERROR;
     |FINSI;

     |PUSHV 0501 2380;
     nDEmpresa = enEmpresa;
     nHEmpresa = enEmpresa;
     |SI nTecla = 10;
         |ATRI P;
         |PINTA 0703, "MODO CONSULTA  <ORDENADO POR FECHA>";
         |ATRI p;

         |ENTLINEAL #2#20, -3, 4, 22, 0, ClaveBaja20, ClaveAlta20;
     |FINSI;
     |SI nTecla = 11;
         |ATRI P;
         |PINTA 0703, "MODO CONSULTA  <ORDENADO POR USUARIO>";
         |ATRI p;

         |ENTLINEAL #3#20, -2, 4, 22, 0, ClaveBaja20, ClaveAlta20;
     |FINSI;
     |SI nTecla = 12;
         nCampo1   = #0#1;
         nDEmpresa = 00001;
         nHEmpresa = 99999;
         |ABRE #20;
         |CONSULTA_F_CLAVE #2#20, ClaveBaja20, ClaveAlta20;
         |SI FSalida = 0; |Y #20#0 = enEmpresa;
             nCampo1 = #20#1;
         |FINSI;
         |CIERRA #20;

         #0#0 = enEmpresa;
         #0#1 = nCampo1;
         |LEE 000#0=;
     |FINSI;

     |ERROR;
     |POPV;
     |DESCARGA_DEF #reflejo@;
|FPRC;

|RUTINA ClaveBaja0;
     #0#0 = enEmpresa;
     #0#1 = 000001;
|FRUT;

|RUTINA ClaveAlta0;
     #0#0 = enEmpresa;
     #0#1 = 999999;
|FRUT;

|PROGRAMA;
     |HAZ inicio;
     |ABRE #0;
     #0#0 = enEmpresa;
     #0#1 = 1;
     |LEE 041#0];
     |SI FSalida ! 0; |O #0#0 ! enEmpresa;
         |MENAV "0000No hay Historico de Importacion en esta Empresa";
         |CIERRA #0;
         |ACABA;
     |FINSI;
     |CIERRA #0;

     |ENTLINEAL #1#0, -2, 2, 22, 1, ClaveBaja0, ClaveAlta0;
|FPRO;
