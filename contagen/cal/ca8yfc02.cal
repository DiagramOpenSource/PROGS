|FICHEROS;
   ca8yfc02 #0;

   ca8m0031 #4;
   ca8m0033 #5;

   canempre #30;
   caconimp #8;
   cawdatos #900;
   caselem1 #998;

   &ficher06@ #442;  || Def Balance Estado
   &ficher07@ #443;  || Lineas
   &ficher12@ #444;  || Columnas
   &ficher13@ #445;  || Lineas Texto
|FIN;

|VARIABLES;
     ||DSARCHI
     &nArchi = 0;
 {-1}aMenu  = "";
     aMenu1 = "2400";
     aMenu2 = "1";
     aMenu3 = "Archivo documental activado. Elija opci¢n: ";
     aMenu4 = "IAB";
     aMenu5 = "Imprimir";
     aMenu6 = "Archivar";
     aMenu7 = "amBos";
     &nOpcion = 0;
     &aImpresora = "";
     &swPasada = 0;
     &swErrorDSArchi = 0;
     &eaInforme = "";
     &eaVengoDe = "";
     &enSwDesde9 = 1;
     &enSwMeteGrupoSubTipo = 0;
     &eaObservaciones = "";
     nOpSegur = 0;
     nSalir   = 0;
  &nCamp0  = 0;     ||desde mes
  &nCamp1  = 0;     ||hasta mes
  &aCamp2  = "";    ||nombre Mes
  &aCamp3  = "";    ||Nombre mes
  &fCamp12 = @;     ||fecha
  &aCamp13 = "";    ||comparativo
  &aCamp18 = "";    ||Datos empresa
  &nBalNum = 0;     ||Numero Balance
  &nBalace = 0;     ||Numero Balance
  &aCamp29 = "";    ||Titulo Balance
  &nCamp30 = 0;     ||Pagina inicial
  &aNomPri = "";
  &enSwComp = 0;

  &aDef06  = "";
  &aDef07  = "";
  &aDef12  = "";
  &aDef13  = "";
  inform1  = "";
  inform2  = "";
  &anyo2   = 0;
  &anyo1   = 0;

  &eaTitol  = "";
  &ejer1    = "";
  &ejer2    = "";
  &enejer1    = 0;
  &enejer2    = 0;

   aAlfa     = "";
   aAlfa1    = "";
   aAlfa2    = "";
   aAlfa3    = "";
   sw        = 0;
   tipo      = "";
   nImprimir = 0;

   &doh      = "";
   &sw_inf  = 0;
   &swImp     = 0;
   aCasilla = "";
   nCol       = 0;
   nCol1      = 0;
   nCol2      = 0;
   nCol3      = 0;
   nNume1     = 0;
   nNume2     = 0;
   nNume3     = 0;
   nNume4     = 0;
   &swImp1    = 0;
   &swImp2    = 0;
   &swImp3    = 0;
   &eaRaya    = "";

   aParam1     = "";
   aParam      = "";
   &nPagDup    = 0;
   &nSwPagDup  = 0;
   &pagina     = 0;
   sw_pagina   = 0;

   aMas        = "";
   &nBalance   = 0;
   nSwMen      = 0;
   nSwLegalia  = 0;
   nSwLInv     = 0;
   &eaUnidadBasico = "";
   &eaUnidadBTmp   = "";
|FIN;

|INCLUYE dscont_i;

|PROCESO &c_pagina;
   |SI sw_pagina = 0;
      pagina = nCamp30;
      sw_pagina = 1;

      nPagDup = nCamp30;
      nSwPagDup = 1;
   |SINO;
      pagina = pagina + 1;

      |HAZ PDuplex;
   |FINSI;
|FPRC;

|PROCESO Leem805;

  |PDEFECTO #0,10,21;
  aCasilla = "";
  |SI #5#16 ! 0;
      aCasilla = #5#16;
      aCasilla = ("000000" + aCasilla) % -106;
  |FINSI;
  #0#16 = #5#3;
  #0#17 = aCasilla;
  #0#18 = #5#7;
  #0#19 = #5#6;
  #0#24 = #5#5;
  |SI #5#8 ! "A"; nImprimir = 0; |FINSI;

  |SI #5#7 = 0; |Y #5#6 = 0; |Y #5#8 ! "A";
      |SI #0#2 = "N"; |ACABA; |FINSI;
  |FINSI;

  |SI sw = 0;
      sw = 1;
  |FINSI;

  sw_inf = 0;
  |SI #5#4 = "G"; sw_inf = 1; |FINSI;
  |SI #5#8 = "A"; sw_inf = 7; |FINSI;
  |SI #5#16 = 0; sw_inf = 7; |FINSI;
  |SI #5#8 ! "A"; |O nImprimir = 1;
      |PRINT;
      nImprimir = 1;
  |FINSI;
|FPRC;

|DEFBUCLE Leem805;
 #5#1;
 ;
 enEmpresa, enEjercicio, 0001;
 enEmpresa, enEjercicio, 9999;
 e;
 NULL,Leem805;
|FIN;

|PROCESO Imprimir_5;
 doh = "";
 eaTitol = aCamp29;
 sw      = 0;
 |BUCLE Leem805;
 |SI sw = 1;
     |PIEINF;
 |FINSI;
|FPRC;

|PROCESO Leem804;

  |PDEFECTO #0,16,21;
  aCasilla = "";
  |SI #4#4 ! 0;
      aCasilla = #4#4;
      aCasilla = ("000" + aCasilla) % -103;
  |FINSI;
  #0#16  = #4#5;
  #0#17 = aCasilla;

  |SI sw = 0;
      tipo = #4#3;
      sw = 1;
      sw_inf = 1;
  |SINO;
      |SI tipo ! #4#3;
          sw_inf = 5; |PRINT;
          tipo = #4#3;
          sw_inf = 1;
      |FINSI;
  |FINSI;

  |SI nCol < 13;
      nCol1 = nCol;     nNume1 = nCol1 + 5;
      nCol2 = nCol + 1; nNume2 = nCol2 + 5;
      nCol3 = nCol + 2; nNume3 = nCol3 + 5;
      #0#18 = #4nNume1;
      #0#19 = #4nNume2;
      #0#20 = #4nNume3;
  |SINO;
      nCol1 = nCol;     nNume1 = nCol1 + 5;
      nCol2 = 0;
      nCol3 = 0;
      #0#18 = #4nNume1;
      #0#19 = 0;
      #0#20 = 0;
  |FINSI;

  swImp1 = 1; swImp2 = 1; swImp3 = 1;
  #442#34 = enEjerBal;
  #442#0  = nBalNum;
  #442#1  = #4#2;
  |LEE 001#442=;
  |SI nCol1 < 13;
      nNume1 = nCol1 + 6; |SI #442nNume1 ! "X";  swImp1 = 0; |FINSI;
      nNume1 = nCol2 + 6; |SI #442nNume1 ! "X";  swImp2 = 0; |FINSI;
      nNume1 = nCol3 + 6; |SI #442nNume1 ! "X";  swImp3 = 0; |FINSI;
  |SINO;
      swImp1 = 0;
  |FINSI;

  |PRINT;
  sw_inf = 0;
  sw = 1;
|FPRC;

|DEFBUCLE Leem804;
 #4#1;
 ;
 enEmpresa, enEjercicio, 001;
 enEmpresa, enEjercicio, 999;
 e;
 NULL,Leem804;
|FIN;

|PROCESO Recorta;
 |QBF aAlfa1;
 aAlfa2 = aAlfa1 % 0;
 nNume4 = aAlfa2;
 nNume4 = ((15 - nNume4) / 2) ! 0;
 aAlfa1 =(( " " * nNume4) + aAlfa1) % 115;
|FPRC;


|PROCESO Imprimir_4;
 eaTitol  = aCamp29;

 |ABRE #444;
 |ABRE #442;
 |PARA nCol = 1; |SI nCol [ 13; |HACIENDO nCol = nCol + 3;
       sw      = 0;
       |PDEFECTO #0,10,16;
       #0#21 = ""; #0#22 = ""; #0#23 = "";
       |SI nCol < 13;
          eaRaya = "=" * 52;
          |DDEFECTO #444;
          #444#5 = enEjerBal;
          #444#0 = nBalNum;
          #444#1 = nCol;
          |LEE 001#444=;
          #0#10 = #444#3; #0#11 = #444#4;
          #0#21 = ("00" + #444#1) % -102;

          |DDEFECTO #444;
          #444#5 = enEjerBal;
          #444#0 = nBalNum;
          #444#1 = nCol + 1;
          |LEE 001#444=;
          #0#12 = #444#3; #0#13 = #444#4;
          #0#22 = ("00" + #444#1) % -102;

          |DDEFECTO #444;
          #444#5 = enEjerBal;
          #444#0 = nBalNum;
          #444#1 = nCol + 2;
          |LEE 001#444=;
          #0#14 = #444#3; #0#15 = #444#4;
          #0#23 = ("00" + #444#1) % -102;
      |SINO;
          #0#10 = ""; #0#11 = "   T O T A L   ";
          #0#21 = "13";
      |FINSI;
      aAlfa1 = #0#10; |HAZ Recorta; #0#10 = aAlfa1;
      aAlfa1 = #0#11; |HAZ Recorta; #0#11 = aAlfa1;
      aAlfa1 = #0#12; |HAZ Recorta; #0#12 = aAlfa1;
      aAlfa1 = #0#13; |HAZ Recorta; #0#13 = aAlfa1;
      aAlfa1 = #0#14; |HAZ Recorta; #0#14 = aAlfa1;
      aAlfa1 = #0#15; |HAZ Recorta; #0#15 = aAlfa1;
      |BUCLE Leem804;
      |SI sw = 1; |PIEINF; |FINSI;
 |SIGUE;
 |CIERRA #442;
 |CIERRA #444;
|FPRC;


|PROCESO lectura;

 enDatos = 0; |SI aCamp18 = "S"; enDatos = 1; |FINSI;
 eaIa = #canempre#21;
 enM1 = nCamp0;
 enM2 = nCamp1;
 |HAZ LeeDatosEmpresa;
 |SI enMAper ! dig1;
     |SI nCamp1 < enMAper; |Y nCamp1 ! 0;
         |ACABA;
     |FINSI;
 |FINSI;

|| ... Observaciones DsArchi
       eaObservaciones = "";
       |SI nCamp0 = nCamp1;
           eaObservaciones = "DE " + aCamp2;
       |SINO;
           NombreMes = aCamp2; |QBF NombreMes;
           eaObservaciones = "DE " + NombreMes + " A ";
           NombreMes = aCamp3; |QBF NombreMes;
           eaObservaciones = eaObservaciones + NombreMes;
       |FINSI;
       eaObservaciones = eaObservaciones > " ";

 |SI aParam ! "";
     |SI nBalance = 3;
         |NOME_DAT #4 aNomPri;
     |FINSI;
     |SI nBalance = 4;
         |NOME_DAT #5 aNomPri;
     |FINSI;
 |FINSI;

 ejer1     = anyo1;
 ejer2     = anyo2;
 enejer1    = anyo1;
 enejer2    = anyo2;

 |SI #8#4 = "S";
     inform1 = "ca8yf001";
     |SI aCamp13 = "S"; inform1 = "ca8yfc01"; |FINSI;
     inform2 = "ca8yc001";
 |SINO;
     inform1 = "cr8yf001";
     |SI aCamp13 = "S"; inform1 = "cr8yfc01"; |FINSI;
     inform2 = "cr8yc001";
 |FINSI;

 aAlfa = Impresora;
 aAlfa = aAlfa % 113;
 |SI nBalance = 3;
     |SI aAlfa = "CrystalReport";
        enSwComp = 0;
        inform2 = "cc8yg001";

        |SI nArchi = 0;
            |CONFI "0000NOrientacion horizontal";
            |SI FSalida = 0;
               inform2 = (inform2 % 0103) + "x" + (inform2 % 504);
            |FINSI;
        |FINSI;
     |FINSI;

     |SI nOpcion = 1;
         |INFOR inform2;
         |SI FSalida ! 0;
             |SI nSwMen = 0; |MENAV "    No existe Informe"; |FINSI;
             |ACABA;
         |FINSI;
     |FINSI;
     |SI nOpcion = 2;
         eaInforme = inform2;
         |HAZ ElIMPREArchi;
         |SI swErrorDSArchi = 1;
             nSalir = 1;
             |ACABA;
         |FINSI;
     |FINSI;
     |HAZ Imprimir_4;
     |FININF;
     |SI nOpcion = 2;
         |FINIMP;
         |SI swErrorDSArchi = 0;
             |HAZ Archivando;
         |FINSI;
         Impresora = "CrystalReport";
     |FINSI;
 |FINSI;

 |SI nBalance = 4;
     |SI aAlfa = "CrystalReport";
        enSwComp = 0;
        inform1 = "cc" + (inform1 % 0306);
        aAlfa = inform1 % -301;
        |SI aAlfa = "c";
           enSwComp = 1;
           inform1 = (inform1 % 0105) + "0" + (inform1 % 702);
        |FINSI;

        |SI nArchi = 0;
            |CONFI "0000NOrientacion horizontal";
            |SI FSalida = 0;
                inform1 = (inform1 % 0103) + "x" + (inform1 % 504);
            |FINSI;
        |FINSI;
     |FINSI;

     |SI nOpcion = 1;
         |INFOR inform1;
         |SI FSalida ! 0;
             |SI nSwMen = 0; |MENAV "    No existe Informe"; |FINSI;
             nSalir = 1;
             |ACABA;
         |FINSI;
     |FINSI;
     |SI nOpcion = 2;
         eaInforme = inform1;
         |HAZ ElIMPREArchi;
         |SI swErrorDSArchi = 1;
             nSalir = 1;
             |ACABA;
         |FINSI;
     |FINSI;
     |HAZ Imprimir_5;
     |FININF;
     |SI nOpcion = 2;
         |FINIMP;
         |SI swErrorDSArchi = 0;
             |HAZ Archivando;
         |FINSI;
         Impresora = "CrystalReport";
     |FINSI;
 |FINSI;
|FPRC;
|*******************************************************************

|PROCESO impresio;
  |SI nArchi = 1;
      |MENU aMenu;
      nOpcion = FSalida;
      |SI nOpcion = 0;
          |ACABA;
      |FINSI;
  |SINO;
       nOpcion = 1;
  |FINSI;

  |SI nOpcion = 3;  |SALVA_DATOS #0;  |FINSI;

   nOpSegur = nOpcion;
   |SI nOpSegur = 1; |O nOpSegur = 3;
       nOpcion = 1;
       |HAZ impre_Uno;
       |SI nOpSegur = 3;  |REPON_DATOS #0;  |FINSI;
       |SI nSalir = 1; |ACABA; |FINSI;
   |FINSI;

   |SI nOpSegur = 2; |O nOpSegur = 3;
       nOpcion = 2;
       |HAZ impre_Uno;
   |FINSI;
|FPRC;

|PROCESO impre_Uno;
  |SI nSwLegalia = 1;
     |SI nSwLInv = 0;
         Impresora = eaNomImp + "?"+ eaUnidadBTmp + "\tmp1,,,?";
         |SI aCamp13 = "S";
             |SI nBalance = 3; Impresora = Impresora + "Bal.ECPN"; |FINSI;
             |SI nBalance = 4; Impresora = Impresora + "Bal.EFE.Comp"; |FINSI;
         |SINO;
             |SI nBalance = 3; Impresora = Impresora + "Bal.ECPN"; |FINSI;
             |SI nBalance = 4; Impresora = Impresora + "Bal.EFE";  |FINSI;
         |FINSI;
         |SI enBasImp ! 0;
             |IMPRE -1;
         |SINO;
             |IMPRE 0;
         |FINSI;
         |SI FSalida ! 0; |ACABA; |FINSI;
     |FINSI;
  |SINO;
      |SI nOpcion = 2;
          Impresora = "CrystalReport";
      |FINSI;
      |SI nOpcion = 1;
          Impresora = "Crystal Reports";
          |IMPRE 0;
          |SI FSalida ! 0;
              |SI nSwMen = 0; |MENAV "      Proceso Interrumpido"; |FINSI;
              nSalir = 1;
              |ACABA;
          |FINSI;
      |FINSI;
  |FINSI;
  |HAZ lectura;
  |SI nOpcion = 1;
      |SI nSwLInv = 0; |FINIMP; |FINSI;
  |FINSI;
|FPRC;

|| *******************************************************************
|PROGRAMA;
   nSwMen = 1;
   aParam = PARAMETRO; |QBF aParam;
   |SI aParam = "";
       |HAZ inicio;
       aParam = "3";
       nBalance = 3;
       |HAZ DirAplicSt;
       nSwMen = 0;
   |FINSI;
   |SI enEjercicio < 2008;
       |SI nSwMen = 0; |MENAV "    Informe para la Estructuras del 2008, no factible en este Ejercicio"; |FINSI;
       |ACABA;
   |FINSI;

   nArchi = 0;
   nSwLegalia = 0;
   aParam1 = aParam % 210; |QBF aParam1;
   |SI aParam1 ! "";
      nSwLInv    = 0;
      nSwLegalia = 1;
      |SI aParam1 = "Libro"; nSwLInv = 1; |FINSI;
      aParam = aParam % 101;
      |PATH_DAT #4 dirfich0;
      |PATH_DAT #5 dirfich0;
      |PATH_DAT #8 dirfich0;
   |FINSI;

   |SI aParam1 = ""; |Y nSwLInv = 0;
       |HAZ ActivaPLB_arc1;
       |SI aParam = "3"; eaVengoDe = "ca8yc001"; |FINSI;
       |SI aParam = "4"; eaVengoDe = "ca8yf001"; |FINSI;
       |HAZ MiraSiArchiva;
   |FINSI;

   |HAZ eCargaECPN;

   |SI aDef12 ! ""; |Y aDef06 ! "";

       |ABRE #8;
       |DDEFECTO #8;
       |LEE 041#8p;
       |CIERRA #8;
       eaValeCero = #caconimp#9;

       |HAZ impresio;
   |FINSI;

   |HAZ eDesCargaECPN;
|FPRO;
