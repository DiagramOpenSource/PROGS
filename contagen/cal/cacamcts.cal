|FICHEROS;
   cacamcts #0,MANTE;
   canempre #2;

   :/basica/def/agifigen #100;
|FIN;

|VARIABLES;
   nPara1   = 0;
   nNume1   = 0;
   nNume2   = 0;
   nNume3   = 0;
   nNume4   = 0;
   nPer     = 0;
   nEmp     = 0;
   nCampo   = 0;
   nInkey   = 0;
   aAlfa1   = "";
   aAlfa2   = "";
   aMensa   = "";
   nPin1      = 0;
   nSelError  = 0;
   &nLaEmpresa = 0;
   &nSwTipo    = 0;

   nSwNoDir = 0;
   aPath    = "";
   aPathE   = "";
   aDire    = "";
|FIN;

|INCLUYE dscont_i;
|| *******************************************************************

|PROCESO SeldeEmpresa;

     |ABRE #canempre;
     aMensa    = "";
     nSelError = 0;
     #canempre#2 = nEmp;
     #canempre#3 = nPer;
     |LEE 010#canempre.=;
     |SI FSalida = 0;
         |SI #0#79 ! "T";
             |SI #canempre#21 ! #0#79;
                 |SI #canempre#21 = "I";
                     aMensa = "    Empresa Inactiva";
                 |SINO;
                     aMensa = "    Empresa Activa";
                 |FINSI;
                 nSelError = 1;
                 |VETE Cierra;
             |FINSI;
         |FINSI;
         nLaEmpresa = #canempre#2;
         |HAZ ElTipoEmpresa;
         |SI nSwTipo = 1;
             aMensa = "    Tipo de Empresa No Seleccionado";
             nSelError  = 1;
             |VETE Cierra;
         |FINSI;
     |SINO;
         nSelError  = 1;
         aMensa = "    No Existe Empresa ";
     |FINSI;

|ET Cierra;
    |CIERRA #canempre;
|FPRC;

|PROCESO Select; |TIPO 0;
  |SI #0#0 = "S";
      |C_M #0#1,1,"S"; |C_M #0#2,1,"S";
      |C_M #0#3,1,"S"; |C_M #0#4,1,"S";
      |PARA nPara1 = 5; |SI nPara1 [ 62; |HACIENDO nPara1 = nPara1 + 3;
            nNume1 = nPara1 + 1;
            nNume2 = nPara1 + 2;
            |C_M #0nPara1,1,"N"; #0nPara1 = 0;  |PINTA #0nPara1;
            |C_M #0nNume1,1,"N"; #0nNume1 = 0;  |PINTA #0nNume1;
                                 #0nNume2 = ""; |PINTA #0nNume2;
      |SIGUE;
   |SINO;
      |C_M #0#1,1,"N"; #0#1 = 1; |PINTA #0#1;
      |C_M #0#2,1,"N"; #0#2 = 0; |PINTA #0#2;
      |C_M #0#3,1,"N"; #0#3 = 99999; |PINTA #0#3;
      |C_M #0#4,1,"N"; #0#4 = 9;     |PINTA #0#4;
      |PARA nPara1 = 5; |SI nPara1 [ 62; |HACIENDO nPara1 = nPara1 + 3;
            nNume1 = nPara1 + 1;
            |C_M #0nPara1,1,"S";
            |C_M #0nNume1,1,"S";
      |SIGUE;
   |FINSI;
|FPRC;

|CALCULO MiraEmpresa; |TIPO 0;
   nInkey = FSalida;
   |SI nInkey = 2; |ACABA; |FINSI;

   nCampo = Campo - 1;
   |SI #0nCampo = 0; |Y #0Campo = 0; |ACABA; |FINSI;

   |SI #0#0 = "N";
       nEmp = #0nCampo;
       nPer = #0Campo;
       |HAZ SeldeEmpresa;
       |SI nSelError ! 0;
           |MENAV aMensa;
           |ERROR;
           |ACABA;
       |FINSI;
       nCampo = Campo + 1;
       #0nCampo = #canempre#1;  |PINTA #0nCampo;
   |FINSI;
|FCAL;

|CALCULO NoMasEmp; |TIPO 0;
     |SI #0Campo = 0;
         nNume1   = Campo + 1;
         #0nNume1 = 0;  |C_M #0nNume1, 1, "N";
         |PARA nCampo = Campo + 3;  |SI nCampo [ 62;  |HACIENDO nCampo = nCampo + 3;
               nNume1 = nCampo + 1;
               #0nCampo = 0;  |C_M #0nCampo, 1, "N";
               #0nNume1 = 0;  |C_M #0nNume1, 1, "N";
         |SIGUE;
     |SINO;
         nNume1   = Campo + 1;
         |C_M #0nNume1, 1, "S";
         |PARA nCampo = Campo + 3;  |SI nCampo [ 62;  |HACIENDO nCampo = nCampo + 3;
               nNume1 = nCampo + 1;
               |C_M #0nCampo, 1, "S";
               |C_M #0nNume1, 1, "S";
         |SIGUE;
     |FINSI;
|FCAL;

|CALCULO SelTipo0;
     |SI #0#78 = "N";
         #0#66 = 0;  |PINTA #0#66;  |C_M #0#66, 1, "N";
         #0#67 = 99; |PINTA #0#67;  |C_M #0#67, 1, "N";
         |PARA nCampo = 68;  |SI nCampo [ 77;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |SINO;
         |C_M #0#66, 1, "S";
         |C_M #0#67, 1, "S";
         |PARA nCampo = 68;  |SI nCampo [ 77;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
               #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |FINSI;
|FCAL;

|CALCULO SelTipo1;
     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 77;  |HACIENDO nCampo = nCampo + 1;
               #0Campo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 77;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FCAL;

||*********************************************************************
||------- Proceso para seleccionar por tipo de Empresa
|PROCESO ElTipoEmpresa;
    nSwTipo = 1;
    |SI Haybasica = 0; nSwTipo = 0; |ACABA; |FINSI;

    |ABRE #agifigen;
    #agifigen#0 = nLaEmpresa; || Empresa
    |LEE 041#agifigen.=;
    |SI FSalida ! 0;
        |DDEFECTO #agifigen;
        #agifigen#87 = 1;
    |FINSI;
    |CIERRA #agifigen;
    nPin1 = #agifigen#87;

    |SI #0#78 = "S";
        |SI nPin1 ] #0#66; |Y nPin1 [ #0#67;
            nSwTipo = 0;
        |FINSI;
    |SINO;
        |SI nPin1 = #0#68;
            nSwTipo = 0;
        |SINO;
            |PARA nCampo = 69;  |SI nCampo [ 77;  |HACIENDO nCampo = nCampo + 1;
                  |SI nPin1 = #0nCampo; |Y nPin1 ! 0;
                      nSwTipo = 0;
                     |SAL;
                  |FINSI;
            |SIGUE;
        |FINSI;
    |FINSI;
|FPRC;

|PROCESO LaRelacion; |TIPO 88;
     |HAZ DirAplicSt;
     |SI Haybasica = 1;         || Existe Acceso;
         || ... Activado Basica
         |MODO_RELACION #0, 0, "agitab04", "X", "X";
         |MODO_RELACION #0, 1, "agitab04", "N", "N";
     |SINO;
         || No existe Basica
         |MODO_RELACION #0, 1, "agitab04", "N", "N";
         |MODO_RELACION #0, 1, "agitab04", "X", "X";
         |C_M #0#66,1,"N"; |C_M #0#67,1,"N";
         |C_M #0#68,1,"N"; |C_M #0#69,1,"N";
         |C_M #0#70,1,"N"; |C_M #0#71,1,"N";
         |C_M #0#72,1,"N"; |C_M #0#73,1,"N";
         |C_M #0#74,1,"N"; |C_M #0#75,1,"N";
         |C_M #0#76,1,"N"; |C_M #0#77,1,"N";
         |C_M #0#78,1,"N";
    |FINSI;
|FPRC;
|| *********************************************************************

|PROCESO Tipo12cts;  |TIPO 12;
|FPRC;
