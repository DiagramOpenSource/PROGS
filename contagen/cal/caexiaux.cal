|INCLUYE dscont_i;
|FICHEROS;
   caexiaux #0;
   caexistl #1;
|FIN;

|VARIABLES;
   &r_emp= 0;
   &r_per= 0;
   &r_eje= 0;
   &r_nom="";
   &r_depar = "";
   depar  = 0;
   dir_fich1 = "";
   alfa1 = "";
   alfa2 = "";

   lineas = 0;
   &cue_exis = "";
   &dig_exis = 0;
   &des_exis = "";
   &imp_exis = 0;
|FIN;

|| ******************************************************************

|PROCESO lee_existenci1;
   |DDEFECTO #0;
   lineas = lineas + 1;
   #caexiaux#0 = #caexistl#0;
   #caexiaux#1 = #caexistl#1;
   #caexiaux#2 = #caexistl#2;
   #caexiaux#3 = #caexistl#3;
   #caexiaux#4 = #caexistl#4;
   #caexiaux#5 = #caexistl#23;
   |GRABA 020#0n;
|FPRC;

|DEFBUCLE lee_existencia;
   #1#1;
   ;
   depar,00;
   depar,99;
   be;
   NULL,lee_existenci1;
|FIN;

|RUTINA min;
   #caexiaux#0 = 1;
   #caexiaux#1 = 1;
|FRUT;

|RUTINA max;
   #caexiaux#0 = 99;
   #caexiaux#1 = 99;
|FRUT;

|PROCESO dirfich0; || calcular el directorio base de los ficheros
   |DBASE dir_fich1;
   dirfich0 = dir_fich1 + "fich/";
   alfa1 = r_emp;
   alfa2 = r_per;
   alfa1 = "00000" + alfa1;   alfa1 = alfa1 % -105;
   alfa2 = "0"   + alfa2;   alfa2 = alfa2 % -101;
   dirfich0 = dirfich0 + alfa1 + alfa2 + "/";

   |PATH_DAT #caexistl #dirfich0#;
|FPRC;


|PROGRAMA;
   |ATRI P;  |MENSA "    Cargando Opcion ...";  |ATRI 0;

   |HAZ nom_usu;
   alfa1 = "m" + nom_tmp;
   |NOME_DAT #caexiaux #alfa1#;

   |HAZ dirfich0;

   |ABRE #0;
   |CIERRA #0;
   |DELINDEX #0;

   depar = r_depar;
   |ABRE #0;
   |BUCLE lee_existencia;
   |CIERRA #0;
   |BLIN 4;
   |PINPA #0#0;
   |ENTLINEAL #1#0, -2, 5, 20, 0, min, max;
   |DELINDEX #0;
|FPRO;

|PROCESO recoge; |TIPO 0;
   |SI FSalida = 0;
      cue_exis = #caexiaux#2;
      dig_exis = #caexiaux#3;
      des_exis = #caexiaux#4;
      imp_exis = #caexiaux#5;
   |FINSI;
|FPRC;
