|FICHEROS;
     cacopemp #0;
     canempre #30;
     cacambiw #90;
     cacambix #91;
     catesfin #170;
     :/basica/def/agicen14  #114;
     :/modelos/def/dsmom100 #100;
     referen@ #950;

     camoneda #88;
     ca8ctrle #400;  ||Control Empresa
     ca8comay #401;  ||Control Cuentas de mayor

     Referen@ #5000;
     ReferLi@ #5001;
|FIN;

|VARIABLES;
   &entrada = 1;
   swExisEmp = 0;
   numero = 0;
   avisillo = "";
   cuenta = "";
   men1   = "    NO EXISTE EMPRESA";
   desde = "            ";
   hasta = "zzzzzzzzzzzz";
   rafa = 0;
   jose = 0;
   r_emp = 0;
   r_per = 0;
   sw = 0;

   fich = "";

   nNume   = 0;
   aAlfa   = "";
   aAlfa1  = "";
   aAlfa2  = "";
   aAlfa3  = "";
   nSwNivel = 0;
   nNivel   = 0;
   nNivel1  = 0;
   nNivel2  = 0;
   nNivel3  = 0;
   nNivel4  = 0;
   nNivel5  = 0;
   nNivel6  = 0;

   aBass        = "";
   aPathEmpOri  = "";
   aPathEmpDes  = "";
   aOrigen      = "";
   aDestino     = "";
   aDefContagen = "";
   aFichero     = "";
   aDef         = "";
   aDirecBuscar = "";
   aEjecuta     = "";

  alfa1 = "";
  alfa2 = "";
  alfa3 = "";
  alfa5 = "";
  nume1 = 0;
  nume2 = 0;
  nume3 = 0;
  nume4 = 0;
  nume5 = 0;
  cuentaNueva = "";
  longi = 0;
  listo = 0;
  a_cuentas = 0;
  d_cuentas = 0;
  a_nivels = 0;
  d_nivels = 0;

  aLong = "";
  nLong = 0;
  &aLaEmpresa = "";
   &any_pos = 0;
   &num_per = 0;
   nEjerActual = 0;
   &enPerioOri = 0;

   nCopia = 0;
   fFecha = @;

   &eaPathO = "";
   &eaPathI = "";
|FIN;

|INCLUYE dscont_i;
|INCLUYE copian_i;
|INCLUYE copia1_i;

|| **************************************************************************

|PROCESO deentrada;  |TIPO 7;
  |SI sw   = 0;
      #0#0 = empre;
      #0#1 = ejerc + 1; |SI #0#1 = 10; #0#1 = 0; |FINSI;
      #0#2 = eaNombreEmp;
      #0#4 = enEjercicio + 1;
      |PINTA #0#0;
      |PINTA #0#1;
      |PINTA #0#2;
      |PINTA #0#4;

      |C_M #0#9, 1, "N"; #0#9 = 0;
      |SI #0#4 ] 2008;
          #0#9 = eNum2008;
          |ABRE #401;
          #401#0 = #0#9;
          |LEE 001#401=;
          |SI FSalida ! 0;
               |C_M #0#9, 1, "S";
          |SINO;
               |C_A #401#1,1,30; |PINTA 1542, #401#1;
          |FINSI;
          |CIERRA #401;
      |FINSI;
      |PINTA #0#9;

      || |SI #0#4 ] 2008;
      ||    |C_M #0#9, 1, "S";
      || |SINO;
      ||    |C_M #0#9, 1, "N";
      ||    #0#9 = 0; |PINTA #0#9;
      || |FINSI;
      sw = 1;
  |FINSI;
|FPRC;

|PROCESO CodCta0; |TIPO 0;
  |C_M #0#9, 0, aAlfa1;
  |SI aAlfa1 = "N"; |ACABA; |FINSI;

  |ABRE #401;
  #401#0 = #0#9;
  |LEE 001#401=;
  |SI FSalida ! 0;
      |MENAV "    Error, no existe Codigo de Cuentas de Mayor";
      |ERROR;
  |SINO;
      |C_A #401#1,1,30; |PINTA 1542, #401#1;
  |FINSI;
  |CIERRA #401;
|FPRC;

|PROCESO Maestra;
     nSwNivel    = 1;

     |ABRE #100;
     |LEE 040#100p;
     |SI FSalida ! 0;  #0#5 = "N";  |FINSI;
     |CIERRA #100;

     |SI #0#5 = "N";
         #0#6 = 0;   |PINTA #0#6;
         #0#7 = 0;   |PINTA #0#7;
         #0#8 = "";  |PINTA #0#8;
         |ACABA;
     |FINSI;

     |ABRE #114;
     #114#0 = #0#0;
     #114#1 = 1;
     |LEE 040#114];
     |SI FSalida ! 0;  |O #114#0 ! #0#0;
         |DDEFECTO #114;
     |FINSI;
     |CIERRA #114;

     |SI #114#9 = 2;
         #0#6 = #100#4;
         #0#7 = #100#5;
         #0#8 = #100#6;
     |FINSI;

     |SI #114#9 = 3;  |O #114#9 = 8;  |O #114#9 = 13;
         #0#6 = #100#7;
         #0#7 = #100#8;
         #0#8 = #100#9;
     |FINSI;

     |SI #114#9 = 4;  |O #114#9 = 9;  |O #114#9 = 14;
      |O #114#9 = 18; |O #114#9 = 19;
         #0#6 = #100#10;
         #0#7 = #100#11;
         #0#8 = #100#12;
     |FINSI;

     |SI #114#9 = 5;  |O #114#9 = 10;  |O #114#9 = 15;
         #0#6 = #100#13;
         #0#7 = #100#14;
         #0#8 = #100#15;
     |FINSI;

     |SI #114#9 = 6;  |O #114#9 = 11;  |O #114#9 = 16;
         #0#6 = #100#16;
         #0#7 = #100#17;
         #0#8 = #100#18;
     |FINSI;

     |SI #114#9 = 7;  |O #114#9 = 12;  |O #114#9 = 17;
         #0#6 = #100#19;
         #0#7 = #100#20;
         #0#8 = #100#21;
     |FINSI;

     |PINTA #0#6;
     |PINTA #0#7;
     |PINTA #0#8;

     |ABRE #30;
     #canempre#2 = #cacopemp#6;
     #canempre#3 = #cacopemp#7;
     |LEE 040#30=;
     |SI FSalida = 0;
         |SI #30#13 ! dig3;  |O #30#14 ! dig4;  |O #30#15 ! dig5;
                             |O #30#16 ! dig6;  |O #30#17 ! dig7;
                             |O #30#18 ! dig8;  |O #30#19 ! dig9;

             |MENAV "      Lo Niveles cambia de la Empresa Actual a la Empresa Maestra";
             |CONFI "0000SDesea dejar los Niveles de la Empresa Maestra ";
             |SI FSalida ! 0;
                 |ERROR;
             |FINSI;
         |FINSI;
     |SINO;
         |MENAV "     No existe Empresa Maestra";
         |ERROR;
     |FINSI;
     |CIERRA #30;
|FPRC;

|PROCESO consulta;
  |SI FSalida ! 9;  |ACABA;  |FINSI;
  |CIERRAT #30;
  r_emp = 0;
  |SUB_EJECUTA "caconemp.run";
  |ABRET #30;
  |ERROR;
  #0#0 = r_emp;
  #0#1 = r_per;
  |PTEC 802;
|FPRC;

|PROCESO esbuena1;
  |SI FSalida = 2; |ACABA; |FINSI;
  |SI #cacopemp#0 = empre; |Y #cacopemp#1 = ejerc;
      |MENAV "    La Empresa y periodo seleccionados son los ACTUALES ";
      |ERROR;
      |ACABA;
  |FINSI;

  |ABRE #30;
  #canempre#2 = #cacopemp#0;
  #canempre#3 = #cacopemp#1;
  |LEE 011#30=;
  |SI FSalida = 0;
      |MENAV "      La Empresa de Contabilidad ya Existe.";
      |ERROR;
  |FINSI;
  |CIERRA #30;
|FPRC;

|PROCESO TraeMaestra;
     |DBASS aBass;  |QBT aBass;
     aDefContagen = aBass + "contagen/def/";
     aPathEmpOri  = aBass + "contagen/fich/" + (("00000" + #0#6) % -105) + #0#7 + "/";
     aPathEmpDes  = aBass + "contagen/fich/" + (("00000" + #0#0) % -105) + #0#1 + "/";
     aDirecBuscar = aPathEmpOri + "*.dat";
     |_PDIR aDirecBuscar;
     |PARA; |SI FSalida = 0; |HACIENDO;
            aFichero  = aDirecBuscar - aPathEmpOri;
            aFichero  = aFichero - ".dat";

            nCopia = 0;
            |SI aFichero = "cacuenta";  |O aFichero = "caclipro";
                                        |O aFichero = "caivases";
                nCopia = 1;
            |FINSI;

            |SI eSwC2008 = 1;
                |SI aFichero = "caagrupa"; |O aFichero = "cacuebal";
                    |O aFichero = "caepigra"; |O aFichero = "caparbal";
                      |O aFichero = "caparexp";
                    nCopia = 1;
                |FINSI;
            |FINSI;

            |SI nCopia = 0;
                aOrigen  = aPathEmpOri + aFichero + ".dat";
                aDestino = aPathEmpDes + aFichero + ".dat";
                |COPIA_FICHERO aOrigen, aDestino;

                aOrigen  = aPathEmpOri + aFichero + ".ddx";
                aDestino = aPathEmpDes + aFichero + ".ddx";
                |COPIA_FICHERO aOrigen, aDestino;

                aOrigen  = aPathEmpOri + aFichero + ".ixx";
                aDestino = aPathEmpDes + aFichero + ".ixx";
                |COPIA_FICHERO aOrigen, aDestino;

                aDef      = aDefContagen + aFichero + ".mas";
                |CARGA_DEF aDef, referen@;
                |SI FSalida = 0;
                    |PATH_DAT #950 aPathEmpDes;
                    |ABRE #950;
                    |CIERRA #950;
                    |DESCARGA_DEF #referen@;
                |FINSI;
            |FINSI;

            |_SDIR aDirecBuscar;
     |SIGUE;
|FPRC;

||*****************************************************************************
|| ... Cambio de Niveles
||*****************************************************************************
|PROCESO cacuenta1;

   alfa1 = #cacuenta#0;  |QBF alfa1;
   alfa2 = alfa1 % 0;
   longi = alfa2;
   listo = 0;      || switch para saber si la cuenta esta cambiada

                             || #cacuenta#1 = Nivel segun la Vieja
                             || enNivel = Nivel segun la Nueva
   eaCuenta = #cacuenta#0;  |HAZ sacanivel;

   |SI enNivel = #cacuenta#1; ||/no cambia nivel, no cambia longitud
       |LIBERA #cacuenta;
       |ACABA;
   |FINSI;

   |SI enNivel ! 0;
       |DDEFECTO #91;
       #cacambix#0 = #cacuenta#0;          || cuenta actual
       #cacambix#1 = #cacuenta#1;          || nivel actual
       #cacambix#2 = #cacuenta#0;          || cuenta destino
       #cacambix#3 = enNivel;              || nivel destino
       d_cuentas   = d_cuentas + 1;
       #cacambix#4 = d_cuentas;
       #cacambix#5 = #cacuenta#2;          || nombre cuenta
       |GRABA 020#91n;
   |SINO;
       |SI #cacuenta#1 = #90#0;  || Es el ultimo nivel de esta
                                       || cambia nivel, cambia longitud
                                       || o  no cambia nivel, cambia longitud

           nume1 = #cacuenta#1;
           |SI #90nume1 < #90d_nivels;  || a¤adir 0
               nume3 = #cacuenta#1 - 1;    || el nivel anterior
               nume2 = #90d_nivels - #90nume1;                        ||/ultimo nivel destino
               alfa1 = "0" * nume2;                         || diferencia en 0;

               alfa2 = #cacuenta#0; |QBF alfa2;
               nume4 = #90nume3;  || el nivel anterior
               nume4 = 100 + nume4;
               alfa3 = nume4; |QBF alfa3;
               nume4 = #90nume3;         || el nivel anterior
               nume4 = #90nume1 - nume4;  ||Diferencia entre anterior y este
               nume4 = 0 - (100 + nume4);
               alfa4 = nume4;

               cuentaNueva = (alfa2 % alfa3) + alfa1 + (alfa2 % alfa4);
          |SINO;
               || Corto ???
               nume2 = #90nume1 - #90d_nivels;
               nume2 = 0 - (100 + nume2);
               alfa1 = nume2; |QBF alfa1;

               nume3 = d_nivels - 1;    || el nivel anterior  nuevo
               alfa2 = #cacuenta#0; |QBF alfa2;
               nume4 = #90nume3;  || el nivel anterior  nuevo
               nume4 = 100 + nume4;
               alfa3 = nume4; |QBF alfa3;

              nume4 = #90nume3;         || el nivel anterior
              nume4 = #90nume1 - nume4;  ||Diferencia entre anterior y este
              nume4 = 0 - (100 + nume4);
              alfa4 = nume4; |QBF alfa4;

              alfa5 = (alfa2 % alfa4);
              alfa5 = (alfa5 % alfa1);
              cuentaNueva = (alfa2 % alfa3) + alfa5;
          |FINSI;

          |DDEFECTO #91;
          #cacambix#0 = #cacuenta#0;         || cuenta actual
          #cacambix#1 = #cacuenta#1;         || nivel actual
          #cacambix#2 = cuentaNueva;         || cuenta destino
          #cacambix#3 = #90#10;              || ultimo nivel Destino
          d_cuentas = d_cuentas + 1;
          #cacambix#4 = d_cuentas + 10000;
          #cacambix#5 = #cacuenta#2;         || nombre cuenta
          |GRABA 020#91n;
          listo = 1;
       |SINO;
          || No paso esta Cuenta
          |BORRA 020#cacuenta.a;   ||voy limpiando niveles errores
       |FINSI;
   |FINSI;
   |LIBERA #cacuenta;
|FPRC;

|DEFBUCLE cacuenta;
   #cacuenta#1;
   ;
   "            ";
   "zzzzzzzzzzzz";
   e;
   NULL, cacuenta1;
|FIN;

|PROCESO TraeNiveles;
     |ABRE #30;
     #canempre#2 = #cacopemp#6;
     #canempre#3 = #cacopemp#7;
     |LEE 040#30=;
     |SI FSalida ! 0;  |DDEFECTO #30;  |FINSI;
     nNivel  = #30#13;
     nNivel1 = #30#14;
     nNivel2 = #30#15;
     nNivel3 = #30#16;
     nNivel4 = #30#17;
     nNivel5 = #30#18;
     nNivel6 = #30#19;

     #canempre#2 = #cacopemp#0;
     #canempre#3 = #cacopemp#1;
     |LEE 101#30=;
     |SI FSalida = 0;
         #30#13 = nNivel;
         #30#14 = nNivel1;
         #30#15 = nNivel2;
         #30#16 = nNivel3;
         #30#17 = nNivel4;
         #30#18 = nNivel5;
         #30#19 = nNivel6;
         |GRABA 020#30a;
     |SINO;
         |DDEFECTO #30;
     |FINSI;
     |LIBERA #30;
     |CIERRA #30;

     |HAZ TraeMaestra;

     #90#0  = dig3;
     #90#1  = dig4;
     #90#2  = dig5;
     #90#3  = dig6;
     #90#4  = dig7;
     #90#5  = dig8;
     #90#6  = dig9;
     #90#10 = #30#13;
     #90#11 = #30#14;
     #90#12 = #30#15;
     #90#13 = #30#16;
     #90#14 = #30#17;
     #90#15 = #30#18;
     #90#16 = #30#19;

     |SI #90#0 = #90#10; |Y #90#1 = #90#11; |Y #90#2 = #90#12;
      |Y #90#3 = #90#13; |Y #90#4 = #90#14; |Y #90#5 = #90#15; |Y #90#6 = #90#16;
        |ACABA;
     |FINSI;


     |PATH_DAT #91 fich_alta;
     |ABRE #91; |CIERRA #91; |DELINDEX #91;
     a_nivels = #90#0;       ||Origen
     d_nivels = 10 + #90#10; ||Destino

     |ABRE #91;
     |BUCLE cacuenta;
     alfa1 = "    Cuentas Origen: " + a_cuentas + " <> Cuentas Destino: " + d_cuentas;
     |CIERRA #91;

     aLaEmpresa = (("00000" + #30#2) % -105) + #30#3;
     aEjecuta   = ":contagen/cacambi2 canempr1 " + aLaEmpresa;
     |SUB_EJECUTA aEjecuta;
|FPRC;

|| *********************************************************************
||                             COMIENZO
|| *********************************************************************

|PROCESO catesfin;
 #170#3 = 0;
 #170#4 = "01.01.1900";
 |GRABA 020#170a;
 |LIBERA #170;
|FPRC;

|DEFBUCLE catesfin;
  #170#1;
  ;
  "            ";
  "zzzzzzzzzzzz";
  be;
  NULL, catesfin;
|FIN;

|PROCESO pone0_tesfin;
   |PATH_DAT #170 fich_alta;
   |BUCLE catesfin;
|FPRC;

|PROCESO tipo3; |TIPO 12;
  |SI #cacopemp#3 = "N"; |ACABA; |FINSI;

  |HAZ Analitica;  || Comprobar para copiar ficheros Analitica
  |HAZ DirAplicSt;

|| --------------------- Empresa Actual
   eSwC2008    = 0;
   nEjerActual = #0#4;
   |SI nEjerActual ] 2008; |Y enEjercicio < 2008;  eSwC2008 = 1; |FINSI;

  |ABRE #30;
  #canempre#2 = empre;
  #canempre#3 = ejerc;
  |LEE 011#30=;
  |SALVA_DATOS #30;
  num_por1 = #canempre#2;
  any_por1 = #canempre#26; || Datos para la Portada

|| --------------------- Empresa Destino por si Ya Existe
  #canempre#2 = #cacopemp#0;
  #canempre#3 = #cacopemp#1;
  |LEE 011#30=;
  |SI FSalida = 0;
      |CONFI "2400SLa Empresa Ya Existe, ¨Desea Continuar? ";
      |SI FSalida ! 0;
          |CIERRA #30;
          |ACABA;
      |FINSI;
      swExisEmp = 1;
  |SINO;
      |REPON_DATOS #30;
      #canempre#0  = (#cacopemp#0 * 10) + #cacopemp#1;
      #canempre#2  = #cacopemp#0;
      #canempre#3  = #cacopemp#1;
      #canempre#26 = #canempre#26 + 1;
      |SI #canempre#26 > 99; #canempre#26 = 0; |FINSI;
      swOperacion = 3;
      eaMoneda = #canempre#28;
      enEmpresa = #canempre#2;
      enPeriodo = #canempre#3;
      |SUB_EJECUTA_NP "camoneda";
      #canempre#28 = eaMoneda;

      |ABRE #114;
      #114#0 = #canempre#2;
      #114#1 = 1;
      |LEE 040#114];
      |SI FSalida ! 0;  |O #114#0 ! #canempre#2;
          |DDEFECTO #114;
      |FINSI;
      |CIERRA #114;

      |SI #canempre#26 ] 80;
          nNume = 1900 + #canempre#26;
      |SINO;
          nNume = 2000 + #canempre#26;
      |FINSI;

      aAlfa1 = #canempre#1;     |QBF aAlfa1;
      aAlfa2 = #114#8;   |QBF aAlfa2;
      aAlfa3 = #114#10;  |QBF aAlfa3;
      aAlfa =  "[" + (("00000" + #canempre#2) % -105) + "/" + nNume + "] " + aAlfa1 + " " + aAlfa2 + " " + aAlfa3;

      #canempre#29 = aAlfa;

      |GRABA 020#canempre.n;
  |FINSI;

  nEjerActual = #0#4;
  num_por = #canempre#2;
  num_per = #canempre#3;
  any_por = #canempre#26; || Datos para la Portada

||  ------ CALCULOS DE CREACION DE LA EMPRESA

   |SI swExisEmp = 0;    ||Si ya Existe, no crea directorio
       |DBASE alfa1;
       alfa2 = #canempre#0;  alfa2 = "000000" + alfa2;  alfa2 = alfa2 % -106;
       alfa1 = alfa1 + "fich/" + alfa2;
       |MKDIR alfa1;
  |FINSI;

   |DFICE dir_fich;
   |DBASE fich;
   alfa2 = #canempre#0;
   alfa2 = "000000" + alfa2;
   alfa2 = alfa2 % -106;
   fich = fich + "fich/" + alfa2 + "/";

   fich_copi = dir_fich;  eaPathI = fich_copi;
   fich_alta = fich;      eaPathO = fich_alta;

   |PUSHV 2101 2380;
   |HAZ copia_maes;
   |SI eSwC2008 = 1;
       nCamp5 = 1; |SI #0#9 = 1; nCamp5 = 2; |FINSI;
       |HAZ creacion_m;   || .... Copia las estructuras
   |FINSI;

   |HAZ acerar4;
   |HAZ pone0_maes;
   |HAZ pone0_tesfin;

   alfa1 = fich_alta % -107; alfa1 = alfa1 % 105;
   enEmpreDes  = alfa1;
   eaNombreEmp = #cacopemp#2;
   |SI #0#5 = "S";
       eaCopiar    = "M";
       enEmpreOri  = #0#6;
       |HAZ copia_otros;
   |SINO;
       |SI swExisEmp = 0; |Y #cacopemp#0 ! empre;
           eaCopiar   = "T";
           enEmpreOri = empre;
           |HAZ copia_otros;
       |FINSI;
   |FINSI;

   |HAZ ActDefecto;

   |SI #0#5 = "S";  |HAZ TraeNiveles;  |FINSI;

   |POPV;
   |SI eSwC2008 = 1;
       eNum2008   = #0#9;
       enEmpreOri = empre;
       enPerioOri = ejerc;
       |PINTA 2211, " ADAPTANDO PLAN CONTABLE 2008. Cuenta:                 ";
       |SUB_EJECUTA_NP "ca8zcamb";
   |SINO;
       |ABRE #400;
       |DDEFECTO #400;
       #400#0 = #canempre#2;
       #400#1 = #canempre#3;
       |LEE 101#400=;
       |SI FSalida = 0;
           #400#2 = eNum2008;
           fFecha = ~;
           aAlfa1 = Usuario % 810;
           #400#6 = fFecha;
           #400#7 = aAlfa1;
           |GRABA 020#400a;
      |SINO;
           #400#0 = #canempre#2;
           #400#1 = #canempre#3;
           #400#2 = eNum2008;
           #400#3 = empre;
           #400#4 = ejerc;
           fFecha = ~;
           aAlfa1 = Usuario % 810;
           #400#6 = fFecha;
           #400#7 = aAlfa1;
           |GRABA 020#400n;
       |FINSI;
       |LIBERA #400;
       |CIERRA #400;
  |FINSI;
   enEjercicio = #0#4;
   |SUB_EJECUTA "caw00010;crea";

   || Compruebo si hay cartera y si la hay compruebo que el ejercicio
   ||    anterior estaba en el control de recibos de contabilidad. Si es
   ||    asi, creo el registro del nuevo periodo en el control
   |DBASS aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "dscarter/def/dscam042.mas";
   |CARGA_DEF aAlfa, Referen@;
   |SI FSalida = 0;
      |DBASS aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + "dscarter/def/dscam043.mas";
      |CARGA_DEF aAlfa, ReferLi@;

      |DBASS aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + "dscarter/fich/";
      |PATH_DAT #Referen@#aAlfa#; |PATH_DAT #ReferLi@#aAlfa#;
      |ABRE #Referen@; |ABRE #ReferLi@;
      #Referen@#0 = #cacopemp#0;
      #Referen@#1 = #cacopemp#1;
      |LEE 000#Referen@.=;
      |SI FSalida ! 0;
         #Referen@#0 = #cacopemp#0;
         |SI #cacopemp#1 = 0;
            #Referen@#1 = 9;
         |SINO;
            #Referen@#1 = #cacopemp#1 - 1;
         |FINSI;
         |LEE 000#Referen@.=;
         |SI FSalida = 0;
            #ReferLi@#0 = #Referen@#0;
            #ReferLi@#1 = #Referen@#1;
            #ReferLi@#2 = 1;
            |LEE 000#ReferLi@.];
            |PARA; |SI FSalida = 0; |Y #ReferLi@#0 = #Referen@#0; |Y #ReferLi@#1 = #Referen@#1; |HACIENDO;
               |SALVA_FICHA #ReferLi@;
               #ReferLi@#1 = #cacopemp#1;
               |GRABA 020#ReferLi@.n;
               |REPON_FICHA #ReferLi@;
               |LEE 000#ReferLi@.s;
            |SIGUE;
            #Referen@#1 = #cacopemp#1;
            |GRABA 020#Referen@.n
         |FINSI;
      |FINSI;
      |CIERRA #Referen@; |CIERRA #ReferLi@;
      |DESCARGA_DEF #Referen@; |DESCARGA_DEF #ReferLi@;
   |FINSI;
|FPRC;

|| ------------------------------------------------------

|PROCESO sacanivel;
   aLong = eaCuenta;
   |QBF aLong;
   aLong = aLong % 0;
   nLong = aLong;
   enNivel = 0;
   |SI nLong = #90#11; |Y #90#11 ! 0; enNivel = 1; |FINSI;
   |SI nLong = #90#12; |Y #90#12 ! 0; enNivel = 2; |FINSI;
   |SI nLong = #90#13; |Y #90#13 ! 0; enNivel = 3; |FINSI;
   |SI nLong = #90#14; |Y #90#14 ! 0; enNivel = 4; |FINSI;
   |SI nLong = #90#15; |Y #90#15 ! 0; enNivel = 5; |FINSI;
   |SI nLong = #90#16; |Y #90#16 ! 0; enNivel = 6; |FINSI;
|FPRC;
