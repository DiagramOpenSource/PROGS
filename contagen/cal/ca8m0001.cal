|FICHEROS;
  ca8m0000 #0;
  ca8m0001 #1,MANTE;
  ca8m0002 #2,MANTE;
  ca8z0001 #10;

  ca8cumay #20;
  caagrupa #21;
  cacuenta #22;
  cacuebal #23;

  &ca8m002@ #900;
|FIN;

|VARIABLES;
  &entrada  = 1;
  &nBalance = 0;
  &aLucrat  = "";

  inkey     = 0;
  esalta    = 0;
  esaltaL   = 0;
  nSwSal    = 0;

  aAlfa     = "";
  aAlfa1    = "";
  aAlfa2    = "";
  nNume1    = 0;
  nNume2    = 0;
  nBorro    = 0;
  aDesde    = "";
  aHasta    = "";
  nDesde    = 0;
  nHasta    = 0;
|FIN;

|INCLUYE dscont_i;

**************************************************************************
|RUTINA ClaveBajaL;
     #2#14 = #1#14;
     #2#0  = #1#0;
     #2#1  = #1#1;
     #2#2  = #1#2;
     #2#3  = #1#3;
     #2#4  = #1#4;
     #2#5  = #1#5;
     #2#6  = #1#6;
     #2#7  = #1#7;
     #2#12 = #1#10;
     #2#8  = 001;
|FRUT;

|RUTINA ClaveAltaL;
     #2#14 = #1#14;
     #2#0  = #1#0;
     #2#1  = #1#1;
     #2#2  = #1#2;
     #2#3  = #1#3;
     #2#4  = #1#4;
     #2#5  = #1#5;
     #2#6  = #1#6;
     #2#7  = #1#7;
     #2#12 = #1#10;
     #2#8  = 999;
|FRUT;

**************************************************************************
|CALCULO descri1; |TIPO 0;
    |HAZ PresentaLinea;
|FCAL;

|PROCESO BorraLineas;
     |BORRA 140#2a;
     |LIBERA #2;
|FPRC;

|DEFBUCLE ca8m0002;
     #2#1;
     ;
     #1#14, #1#0, #1#1, #1#2, #1#3, #1#4, #1#5, #1#6, #1#7, #1#10, 000;
     #1#14, #1#0, #1#1, #1#2, #1#3, #1#4, #1#5, #1#6, #1#7, #1#10, 999;
     be;
     NULL, BorraLineas;
|FIN;

|CALCULO Tipo2_1;  |TIPO 2;
     esalta  = (FEntrada / 100) ! 0;
     |SI esalta ! 3;  |ACABA;  |FINSI;
     |BUCLE ca8m0002;
|FCAL;

||************************************************************************
|CALCULO elTipo3; |TIPO 3;
  |SI nBalance = 0; #1#2 = 0;   |FINSI;
  |SI nBalance = 1; #1#3 = "R"; |FINSI;
  |SI nBalance = 2; #1#2 = 6; #1#3 = "E";  #1#10 = 0; |FINSI;
  |SI nBalance = 4; #1#2 = 7;   |FINSI;
  #1#0 = #10#2;
  #1#1 = #10#0;

  esalta  = (FEntrada / 100) ! 0;
  |SI FSalida = 0;
     |SI #1#8 = "C";
         nSwSal = 0;
         |ENTLINEAL #1#2, -11, 2, 22, 0, ClaveBajaL, ClaveAltaL;
     |SINO;
         nBorro = 0;
         |ABRE #2;
         #2#14 = #1#14;
         #2#0  = #1#0; #2#1 = #1#1;
         #2#2  = #1#2; #2#3 = #1#3;
         #2#4  = #1#4; #2#5 = #1#5;
         #2#6  = #1#6; #2#7 = #1#7;
         #2#12 = #1#10;
         #2#8  = 001;
         |LEE 041#2];
         |SI FSalida = 0; |Y #2#0 = #1#0; |Y #2#1 = #1#1; |Y #2#2 = #1#2; |Y #2#3 = #1#3;
             |Y #2#4 = #1#4; |Y #2#5 = #1#5; |Y #2#6 = #1#6; |Y #2#7 = #1#7; |Y #2#12 = #1#10;
               |Y #2#14 = #1#14;
             |CONFI "    SBorro Relacion de Ctas posibles ";
             |SI FSalida = 0;
                 nBorro = 1;
             |FINSI;
         |FINSI;
         |CIERRA #2;
         |SI nBorro = 1;
             |BUCLE ca8m0002;
         |FINSI;
     |FINSI;
 |FINSI;
|FCAL;

|CALCULO PresentaLinea;  |TIPO 7;
    |SI Campo = 2; |Y nBalance ! 1; |ACABA; |FINSI;
    |SI Campo = 3;
        |SI nBalance ! 0; |Y nBalance ! 4; |ACABA; |FINSI;
        |SI nBalance = 0;
            |MENSA "    Tipo Cta: A = Activo, P = Pasivo";
        |SINO;
            |MENSA "    Apartado A, B, C, D, E";
        |FINSI;
    |FINSI;
    |SI Campo = 4; |Y nBalance ! 2; |ACABA; |FINSI;
    nSwSal = 1;
    |ENTLINEAL #1#2, -11, 7, 22, 0, ClaveBajaL, ClaveAltaL;
|FCAL;

|CALCULO Campo3_0; |TIPO 0;
  |C_M #1#3, 0, aAlfa1;
  |SI aAlfa1 = "N"; |ACABA; |FINSI;

  |SI #1#1 = 0;
      |SI #1#3 ! "A"; |Y #1#3 ! "P"; |ERROR; |FINSI;
  |FINSI;
  |SI #1#1 = 4;
      |SI #1#3 ! "A"; |Y #1#3 ! "B"; |Y #1#3 ! "C";
        |Y #1#3 ! "D"; |Y #1#3 ! "E";
        |ERROR;
      |FINSI;
  |FINSI;
|FCAL;

|CALCULO elTipo13; |TIPO 13;
   aAlfa1 = "          ";
   |SI #1#1 = 0; |Y #1#3 = "A"; aAlfa1 = "(ACTIVO)  "; |FINSI;
   |SI #1#1 = 0; |Y #1#3 = "P"; aAlfa1 = "(PASIVO)  "; |FINSI;
   |SI #1#1 = 2;                aAlfa1 = "ESTADO    "; |FINSI;
   |SI #1#1 = 1;                aAlfa1 = "RESULTADO "; |FINSI;
   |SI #1#1 = 4;                aAlfa1 = "컴컴컴컴컴"; |FINSI;
   |ATRI I; |PINTA 0726,aAlfa1; |ATRI 0;
|FCAL;

|CALCULO TipLin7; |TIPO 7;
   |SI nBalance = 0;
       aAlfa = "0000(T) Total Grupo, (C) Cuentas, (A) Linea de Texto ";
   |FINSI;
   |SI nBalance = 1;
       aAlfa = "0000(T) Total Grupo, (S) Suma, (C) Cuentas, (A) Linea de Texto ";
   |FINSI;
   |SI nBalance > 1;
       aAlfa = "0000(T) Total Grupo, (S) Suma, (C) Cuentas, (A) Linea de Texto ";
   |FINSI;
   |MENSA aAlfa;
|FCAL;

|CALCULO TipLin0; |TIPO 0;
   |BLIN 4;
   |SI nBalance = 0; |Y #1#8 = "S";
       |ERROR;
   |FINSI;
|FCAL;

|| ************************************************************************
|CALCULO SalgoYa;  |TIPO 7;
   |SI nSwSal = 1;  |PTEC 807;  |FINSI;
|FCAL;

|RUTINA min20;
  #20#12 = enEjerBal;
  #20#10 = 0;
  #20#0  = "     ";
  #20#2 = nDesde;
  #20#3 = aDesde;
  #20#5 = 00;
|FRUT;

|RUTINA max20;
  #20#12 = enEjerBal;
  #20#10 = 0;
  #20#0 = "zzzzz";
  #20#2 = nHasta;
  #20#3 = aHasta;
  #20#5 = 99;
|FRUT;

|CALCULO Tipo0_L; |TIPO 0;
  inkey = FSalida;
  |SI inkey = 10;
      aDesde = #1#3; aHasta = #1#3;
      nDesde = 0;    nHasta = 0;
      |SI nBalance = 1; aDesde = "D"; aHasta = "P"; nDesde = 1; nHasta = 5; |FINSI;
      |SI nBalance = 2; aDesde = "G"; aHasta = "I"; nDesde = 6; nHasta = 6; |FINSI;
      |SI nBalance = 4; aDesde = " "; aHasta = "Z"; nDesde = 0; nHasta = 9; |FINSI;
      |SI aLucrat = "S";
          aDesde = " "; aHasta = "Z"; nDesde = 0; nHasta = 9;
      |FINSI;
      |ABRE #20;
      |CONSULTA_F_CLAVE #4#20, min20, max20;
      |CIERRA #20;
      #2#9  = #20#0;  |PINTA #2#9;
      #2#10 = #20#11; |PINTA #2#10;
  |FINSI;

  aAlfa1 = #2#9; |QBF aAlfa1;
  |SI aAlfa1 = ""; |ERROR; |FINSI;

  aAlfa1 = #2#9 % A101;
  |SI nBalance ! 4; |Y aLucrat ! "S";
      |SI aAlfa1 = "6"; |O aAlfa1 = "7";
           |SI #1#2 < 1; |O #1#2 > 5;
              |AVISO;
              |ERROR;
           |FINSI;
       |SINO;
           |SI aAlfa1 = "8"; |O aAlfa1 = "9";
               |SI #1#2 < 1;
                   |AVISO; |ERROR;
               |FINSI;
           |SINO;
               |SI #1#2 ! 0; |Y #1#3 ! "A"; |Y #1#3 ! "P";
                   |AVISO; |ERROR;
              |FINSI;
           |FINSI;
       |FINSI;
   |FINSI;

   esaltaL = (FEntrada / 100) ! 0;
   |SI esaltaL = 1;
       |SI #1#3 = "A"; #2#10 = "+"; |FINSI;
       |SI #1#3 = "P"; #2#10 = "-"; |FINSI;
       |PINTA #2#10;
   |FINSI;
|FCAL;
