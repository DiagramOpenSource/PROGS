|FICHEROS;
   cacfgimp #0;

   :/modelos/def/dsmom030 #1000;
|FIN;

|VARIABLES;
   aAlfa   = "";
   aParte1 = "";
   aParte2 = "";

   nCont   = 0;
   nCalc   = 0;
   nParte1 = 0;
   nParte2 = 0;
   nMaxDig = 0;
|FIN;

|PROCESO CogeConcepto; |TIPO 66;
   |ABRE #dsmom030;
   #dsmom030#0 = #cacfgimp#Campo#;
   |LEE 000#dsmom030.];

   |CONSULTA_CLAVE #1#dsmom030;
   |SI FSalida = 0;
      #cacfgimp#Campo# = #dsmom030#0; |PINTA #cacfgimp#Campo#;
      |C_P #cacfgimp#Campo#, 0, nCalc;
      nCalc = nCalc + 4;
      |PINTA nCalc, #dsmom030#1;
   |FINSI;
   |CIERRA #dsmom030;
|FPRC;

|PROCESO PintaConcepto;
   |ABRE #dsmom030;
   #dsmom030#0 = #cacfgimp#Campo#;
   |LEE 000#dsmom030.=;
   |SI FSalida = 0;
      |C_P #cacfgimp#Campo#, 0, nCalc;
      nCalc = nCalc + 4;
      |PINTA nCalc, #dsmom030#1;
   |SINO;
      |MENAV "    Concepto inexistente";
   |FINSI;
   |CIERRA #dsmom030;
|FPRC;

|PROCESO PuntoCuenta; |TIPO 6;
   aAlfa = #cacfgimp#Campo#; |QBF aAlfa;
   aAlfa = aAlfa - ".";
   |PARA; |SI FSalida ! 0; |HACIENDO;
      nParte1 = ((FSalida / 100) ! 0) + 99; aParte1 = aAlfa % nParte1;
      nParte2 = FSalida + 98;               aParte2 = aAlfa % nParte2;
      aAlfa = aParte1 + aParte2; |QBF aAlfa;
      aAlfa = aAlfa % 0; nCalc = aAlfa;
      nCalc = nMaxDig - nCalc;
      aAlfa = "0" * nCalc; |QBF aAlfa;
      aAlfa = aParte1 + aAlfa + aParte2; |QBF aAlfa;
      #cacfgimp#Campo# = aAlfa;
      aAlfa = aAlfa - ".";
   |SIGUE;
   |PINTA #cacfgimp#Campo#;
|FPRC;

|PROGRAMA;
   |ABRE #cacfgimp;
   |LEE 101#cacfgimp.p;
   |SI FSalida ! 0;
      |DDEFECTO #cacfgimp;
      |GRABA 020#cacfgimp.b;
   |FINSI;

   nMaxDig = 0;
   |PARA nCont = 14; |SI nCont [ 19; |HACIENDO nCont = nCont + 1;
     |SI nMaxDig ] #48nCont; nMaxDig = #48nCont; |FINSI;
   |SIGUE;

   |CLS;
   |CABEZA "Configuracion importacion IN-LINE";

   |PINPA #0#0; |PINDA #0#0;
   Campo = 3;  |HAZ PintaConcepto; Campo = 8;  |HAZ PintaConcepto;
   Campo = 13; |HAZ PintaConcepto; Campo = 15; |HAZ PintaConcepto;

   |ENDATOS #1#0;
   |SI FSalida = 0;
      |GRABA 020#cacfgimp.a;
   |FINSI;

   |LIBERA #cacfgimp; |CIERRA #cacfgimp;
|FPRO;
