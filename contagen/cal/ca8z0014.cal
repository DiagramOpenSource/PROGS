|FICHEROS;
   ca8z0014;
   cacuenta;
   espejoa@ #999;
|FIN;

|VARIABLES;
   nNivel  = 0;
   aMas    = "";
   aDef    = "";
   FEstado = 0;
   pepe    = 0;
   nPara1  = 0;
   aQueQuiero = "";
   aNumCampos = "";
   nNumCampos = 0;
   alfa1      = "";
   alfa2      = "";
   alfa3      = "";
   nume1      = 0;
   nume2      = 0;
   nume3      = 0;
   vale       = 0;
   nLong      = 0;
   aCuenta    = "";
|FIN;

|INCLUYE dscont_i;

|PROCESO Alta;
   alfa2 = aCuenta; |QBF alfa2;
   alfa2 = (alfa2 + "zzzzzzzzzzzz") % 112;
   #espejoa@#54 = alfa2;

   |DDEFECTO #cacuenta;
   #cacuenta#0 = aCuenta;    || cuenta
   |LEE 101#cacuenta.=;
   FEstado = FSalida;
   #cacuenta#0  = aCuenta;    || cuenta
   |PARA nPara1 = 1; |SI nPara1 [ nNumCampos; |HACIENDO nPara1 = nPara1 + 1;
         #cacuenta#nPara1# = #espejoa@#nPara1#;
   |SIGUE;
   #cacuenta#3  = "N";    || cuenta
   |SI FEstado = 0;  |GRABA 020#cacuenta.a;  |FINSI;
   |SI FEstado ! 0;  |GRABA 020#cacuenta.n;  |FINSI;
   |LIBERA #cacuenta;
   #ca8z0014#1 = #cacuenta#0;
   |PINTA #ca8z0014#1;
|FPRC;

|PROCESO MontaNueva;
       alfa2 = #espejoa@#0 % 104; |QBF alfa2;

       nume1 = nLong - 4;
       nume2 = -(100 + nume1);
       alfa3 = #espejoa@#0 % nume2;

       alfa2 = alfa2 + alfa3;
       aCuenta = alfa2;
       |HAZ Alta;
|FPRC;

|PROCESO cacuenta;
   #ca8z0014#0 = #espejoa@#0;
   |PINTA #ca8z0014#0;

   aCuenta = #espejoa@#0;

   vale  = 0;
   alfa1 = #espejoa@#0;
   |QBF alfa1;
   alfa1 = alfa1 % 0;
   nLong = alfa1;

   |SI nLong = 4;   vale = 1; |FINSI;
   |SI nLong = 12;  vale = 1; |FINSI;
   |SI vale ! 1;  |ACABA;  |FINSI;

   |SI nLong = 4;
       alfa2 = #espejoa@#0; |QBF alfa2;
       alfa2 = alfa2 + "0";
       aCuenta = alfa2;

       |HAZ Alta;
   |FINSI;

   |SI nLong = 12;
       nLong = 8;  |HAZ MontaNueva;
       nLong = 9;  |HAZ MontaNueva;
       nLong = 10; |HAZ MontaNueva;
   |FINSI;
|FPRC;

|DEFBUCLE cacuenta;
   #espejoa@#1001;
   1;
   "            ", nNivel;
   "zzzzzzzzzzzz", nNivel;
   e;
   NULL, cacuenta;
|FIN;

|PROGRAMA;
   |CLS;
   |PINPA #0#ca8z0014;

   aQueQuiero = "|NC";
   aNumCampos = #cacuenta#aQueQuiero#;
   nNumCampos = aNumCampos;
   nNumCampos = nNumCampos - 1;

   |DBASE aMas;
   aDef = aMas + "def/cacuenta";
   |CARGA_DEF aDef, espejoa@;
   |SI FSalida ! 0;
       |ACABA;
   |FINSI;

   |ABRE #cacuenta;
   nNivel = 4; |BUCLE cacuenta;
   nNivel = 5; |BUCLE cacuenta;
   |CIERRA #cacuenta;

   |DESCARGA_DEF #espejoa@;
|FPRO;
