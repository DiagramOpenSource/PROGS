|FICHEROS;
   caextrim #0;
   camaasil #1;
   camaasic #2;
   cacuenta #3;
   caclipro #5;
   calicont #31;

   caconimp #8;
   ca8m0003 #403;
   ca8m0004 #404;

   canempre #30;
   caselem1 #998;
   caw00023 #999;
|FIN;

|VARIABLES;
     ||DSARCHI
     &nArchi = 0;
 {-1}aMenu  = "";
     aMenu1 = "2400";
     aMenu2 = "1";
     aMenu3 = "Archivo documental activado. Elija opciขn: ";
     aMenu4 = "IAB";
     aMenu5 = "Imprimir";
     aMenu6 = "Archivar";
     aMenu7 = "amBos";
     &nOpcion = 0;
     &aImpresora = "";
     &swPasada = 0;
     &swErrorDSArchi = 0;
     &eaInforme = "";
     &eaVengoDe = "";
     &enSwDesde9 = 1;
     &enSwMeteGrupoSubTipo = 0;
     &eaObservaciones = "";
     nOpSegur = 0;
     SwCierre = 0;
     SwApertura = 0;

   nSalir   = 0;
   aAlfa    = "";
   aAlfa1   = "";
   aAlfa2   = "";

   swCliPro = 0;
   nCampo   = 0;

   &entrada = 1;
   mesnum = 0;
   columna = 0;
   sw_con = 0;          || 1 = EL CONCEPTO ES BUENO
   x = 0;
   sw_saldo = 0;        || 1 = EL SALDO DE LA CUENTA ES CERO
   t_debe = 0;
   t_haber = 0;
   t_saldo = 0;
   campo = 0;
   d = 0;
   h = 0;
   sw_print = 0;        || 1 = NO DEBO ESCRIBIR
   sw_prim = 0;         || 0 = PRIMERA VEZ
   mesh = "";
   diah = "";
   anyoh = "";
   &cuenta = "";
   cuen = "";
   xxxxfiac = "  ";
   xxaponer = "  ";
   xrelleno = "                              ";
   fecalf = "";
   mensa1 = "    ERROR ESTA FECHA NO CORRESPONDE AL EJERCICIO";
   traba1 = "";
   varalf = "";
   &swant = 0;
   &s_debe = 0;
   &s_haber = 0;
   &s_saldo = 0;
   &debe = 0;
   &haber = 0;
   &direc = "";
   &codpos = "";
   &pobla = "";
   &provi = "";
   &cif = "";
   &telef = "";
   &contra = "";
   &contra_t = "";
   contra_td = "";
   contra_th = "";
   contra_d = "";
   contra_h = "";
   swex_con = 0;
   informe = "";
   digito = 0;
   &sw_inf = 0;
   &sw_cab = 0;
   &y = 0;
   xy = 0;
   alfa1 = "";
   alfa2 = "";
   alfa3 = "";
   alfa4 = "";
   sw_pagina = 0;
   &pagina = 0;
   sw_cuen = 0;          ||1 = Hemos Leido la cuenta
   swtotal = 0;

   &nSwPagDup = 0;
   &nPagDup = 0;

   nDia8      = 0;
   fFec8      = @;
   nDoc8      = 0;
   nIgual     = 0;
   nAsto8     = 0;
   nDiaAper   = 0;
   contra_ad  = "";
   contra_tad = "";
   contra_ah  = "";
   contra_tah = "";
   nSwAper    = 0;

    nEjerCam = 0;
    nEjer    = 0;
    nPeriodo = 0;
    aFichero = "";
    dirfichO = "";
    aPath08  = "";
    nCambio  = 0;
    aCta08   = "";
    aCta90   = "";
    nSwOp    = 0;
    nume1    = 0;
    nHay     = 0;
    aDCuenta = "";
    aHCuenta = "";
    nSw_A    = 0;
    aHora    = "";
    &eaHora  = "";

   nPara1        = 0;
   nPara2        = 0;
   &efFecLeg     = @;
   aNombrePDF    = "";
   nSwError      = 0;
   nCalc         = 0;
   aIP           = "";
   &enHayInforme = 0;
{1}aContiene     = "";
|FIN;

|INCLUYE dscont_i;
|INCLUYE masivo_i;
|INCLUYE promas_i;
|| *********************************************************************
||                             COMIENZO
|| *********************************************************************
|PROCESO recoge;
   #0#2 = fec1;
   |SI #0#75 = "S"; #0#2 = "01.01.2000"; |FINSI;
   |PINTA #0#2;
   #0#3 = fec2; |PINTA #0#3;
|FPRC;

|PROCESO &c_pagina;
   |SI sw_pagina = 0;
      pagina = #caextrim#38;
      sw_pagina = 1;

      nPagDup = #caextrim#38;
      nSwPagDup = 1;
   |SINO;
      pagina = pagina + 1;

      |HAZ PDuplex;
   |FINSI;
   sw_cab = 1;
|FPRC;

|PROCESO lacontra; |TIPO 0;
   aAlfa1 = "S";
   |SI #caextrim#72 ! "S";
       aAlfa1 = "N";
       #caextrim#78 = "N"; |PINTA #caextrim#78;
   |FINSI;
   |C_M #caextrim#78,1,aAlfa1;
|FPRC;

|PROCESO seleccio; |TIPO 0;
   |SI #caextrim#4 = "N";
      |C_M #caextrim#05, 1, "S"; |C_M #caextrim#06, 1, "S";
      |C_M #caextrim#07, 1, "S"; |C_M #caextrim#08, 1, "S";
      |C_M #caextrim#09, 1, "S"; |C_M #caextrim#10, 1, "S";
      |C_M #caextrim#11, 1, "S"; |C_M #caextrim#12, 1, "S";
      |C_M #caextrim#13, 1, "S"; |C_M #caextrim#14, 1, "S";
      |C_M #caextrim#15, 1, "S"; |C_M #caextrim#16, 1, "S";
      |C_M #caextrim#17, 1, "S"; |C_M #caextrim#18, 1, "S";
      |C_M #caextrim#19, 1, "S"; |C_M #caextrim#20, 1, "S";
      |C_M #caextrim#21, 1, "S"; |C_M #caextrim#22, 1, "S";
      |C_M #caextrim#23, 1, "S"; |C_M #caextrim#24, 1, "S";
      |C_M #caextrim#25, 1, "S"; |C_M #caextrim#26, 1, "S";
      |C_M #caextrim#27, 1, "S"; |C_M #caextrim#28, 1, "S";
      |C_M #caextrim#33, 1, "N"; |C_M #caextrim#34, 1, "N";
      #caextrim#33 = 1;       |PINTA #caextrim#33;
      #caextrim#34 = 999;     |PINTA #caextrim#34;
   |SINO;
      |C_M #caextrim#05, 1, "N"; |C_M #caextrim#06, 1, "N";
      |C_M #caextrim#07, 1, "N"; |C_M #caextrim#08, 1, "N";
      |C_M #caextrim#09, 1, "N"; |C_M #caextrim#10, 1, "N";
      |C_M #caextrim#11, 1, "N"; |C_M #caextrim#12, 1, "N";
      |C_M #caextrim#13, 1, "N"; |C_M #caextrim#14, 1, "N";
      |C_M #caextrim#15, 1, "N"; |C_M #caextrim#16, 1, "N";
      |C_M #caextrim#17, 1, "N"; |C_M #caextrim#18, 1, "N";
      |C_M #caextrim#19, 1, "N"; |C_M #caextrim#20, 1, "N";
      |C_M #caextrim#21, 1, "N"; |C_M #caextrim#22, 1, "N";
      |C_M #caextrim#23, 1, "N"; |C_M #caextrim#24, 1, "N";
      |C_M #caextrim#25, 1, "N"; |C_M #caextrim#26, 1, "N";
      |C_M #caextrim#27, 1, "N"; |C_M #caextrim#28, 1, "N";
      |C_M #caextrim#33, 1, "S"; |C_M #caextrim#34, 1, "S";
   |FINSI;
|FPRC;

|PROCESO seleccio2; |TIPO 0;
   |SI #caextrim#41 = "N";
      |C_M #caextrim#42, 1, "S"; |C_M #caextrim#43, 1, "S";
      |C_M #caextrim#44, 1, "S"; |C_M #caextrim#45, 1, "S";
      |C_M #caextrim#46, 1, "S"; |C_M #caextrim#47, 1, "S";
      |C_M #caextrim#48, 1, "S"; |C_M #caextrim#49, 1, "S";
      |C_M #caextrim#50, 1, "S"; |C_M #caextrim#51, 1, "S";
      |C_M #caextrim#52, 1, "S"; |C_M #caextrim#53, 1, "S";
      |C_M #caextrim#54, 1, "S"; |C_M #caextrim#55, 1, "S";
      |C_M #caextrim#56, 1, "S";
      |C_M #caextrim#0, 1, "N"; |C_M #caextrim#1, 1, "N";
      #caextrim#0 = "            "; #caextrim#31 = 0; |PINTA #caextrim#0;
      #caextrim#1 = "            "; #caextrim#32 = 9; |PINTA #caextrim#1;
   |SINO;
      |C_M #caextrim#0, 1, "S"; |C_M #caextrim#1, 1, "S";
      |C_M #caextrim#42, 1, "N"; |C_M #caextrim#43, 1, "N";
      |C_M #caextrim#44, 1, "N"; |C_M #caextrim#45, 1, "N";
      |C_M #caextrim#46, 1, "N"; |C_M #caextrim#47, 1, "N";
      |C_M #caextrim#48, 1, "N"; |C_M #caextrim#49, 1, "N";
      |C_M #caextrim#50, 1, "N"; |C_M #caextrim#51, 1, "N";
      |C_M #caextrim#52, 1, "N"; |C_M #caextrim#53, 1, "N";
      |C_M #caextrim#54, 1, "N"; |C_M #caextrim#55, 1, "N";
      |C_M #caextrim#56, 1, "N";
   |FINSI;
|FPRC;

|PROCESO cuenta; |TIPO 6;
   eaCuenta = #0Campo;
   salidas  = FSalida;
   |HAZ FiltraPuntos;
   #0Campo = eaCuenta;
   |PINTA #0Campo;
   |SI #0Campo = "            "; |ACABA; |FINSI;

   digito = Campo + 15;
   |SI Campo [ 1;
       digito = Campo + 31;
   |FINSI;

   |HAZ SacaNivel;
   #0digito = enNivel;
|FPRC;

|PROCESO fechas;
  |SI #0#75 = "N";
      |SI #0Campo < fec1; |O #0Campo > fec2;
          |MENAV mensa1;
          |ERROR;
          |ACABA;
      |FINSI;
  |FINSI;
  |SI Campo = 3; |Y #0#3 < #0#2;
      |MENAV mensa1;
      |ERROR;
  |FINSI;
|FPRC;

|PROCESO nomodifi;             || RUTINA DE CONVERSION A NO MODIFICABLES
|| VARIABLES: A_
   xxaponer = Anono;
   xxxxfiac = Control % A1001;
   Control = Control + xxxxfiac;
   Control = Control + xrelleno;
   Control = Control % A120;
   Control = Control + xxaponer;
|FPRC;

|PROCESO colummes; |TIPO 7;
|| Calculo para saber en que columna del plan contable
|| se encuentra el mes hasta, y hacer no modificable
|| el campo de (Con saldo S/N)
   diah = #caextrim#3 % 102;
   mesh = #caextrim#3 % 402;
   anyoh = #caextrim#3 % 902;
   mesnum = mesh;

  |SI #canempre#11 ! 1;
      |SI mesnum ] #canempre#11;
          columna = mesnum - #canempre#11 + 1;
      |SINO;
          columna = (12 - #canempre#11) + (mesnum + 1);
      |FINSI;
      |SI columna > 12; columna = columna - 12; |FINSI;
  |SINO;
      columna = mesnum;
  |FINSI;

   |SI diah = "31"; |O diah = "30"; |O diah = "28"; |O diah = "29";
      |SI diah = "30";
         |SI mesh = "01"; |O mesh = "03"; |O mesh = "05"; |O mesh = "07";
            |O mesh = "08"; |O mesh = "10"; |O mesh = "12";
            |HAZ nomodifi;
         |FINSI;
      |FINSI;
      |SI diah = "28"; |O diah = "29";
         |SI mesh ! "02";
            |HAZ nomodifi;
         |SINO;
            |SI diah = "28"
               |SI anyoh = "88"; |O anyoh = "92"; |O anyoh = "96";
                  |O anyoh = "00"; |O anyoh = "04"; |O anyoh = "08";
                    |O anyoh = "12"; |O anyoh = "16"; |O anyoh = "20";
                  |HAZ nomodifi;
               |FINSI;
            |SINO;
               |SI anyoh ! "88"; |Y anyoh ! "92"; |Y anyoh ! "96";
                  |Y anyoh ! "00"; |Y anyoh ! "04"; |Y anyoh ! "08";
                    |Y anyoh ! "12"; |Y anyoh ! "16"; |Y anyoh ! "20";
                  |HAZ nomodifi;
               |FINSI;
            |FINSI;
         |FINSI;
      |FINSI;
   |SINO;
      |HAZ nomodifi;
   |FINSI;
|FPRC;

|PROCESO no_dep; |TIPO 7;
   |C_M #caextrim#36, 1, eaDepar;
   |C_M #caextrim#37, 1, eaDepar;
|FPRC;

|PROCESO nosubde; |TIPO 7;
   |C_M #caextrim#73, 1, eaSubde;
   |C_M #caextrim#74, 1, eaSubde;
|FPRC;

|PROCESO DatosEmp; |TIPO 7;
 |ABRE #8;
 |DDEFECTO #8;
 #8#0 = 1;
 |LEE 011#8=;
 |CIERRA #8;

 aAlfa1 = "S";
 |SI #8#18 = "N"; |O #8#19 = "N"; aAlfa1 = "N"; |FINSI;
 |C_M #0#76, 1, aAlfa1;
 |C_M #0#77, 1, aAlfa1;
 |SI #8#18 = "N";
     |C_V #0#76, 1, aAlfa1;
     |C_V #0#77, 1, aAlfa1;
     |PINTA 2246, "             ";
     |PINTA 2346, "อออออออออออออ";
 |SINO;
     |HAZ PonHora;
 |FINSI;
|FPRC;

|PROCESO PonHora; |TIPO 7;
     |C_M #0#76, 0 , aAlfa1;
     |SI aHora = ""; |O aAlfa1 = "N";
         |HORA aHora;
         aAlfa1 = aHora % 102;  #0#76 = aAlfa1;  |PINTA #0#76;
         aAlfa1 = aHora % 402;  #0#77 = aAlfa1;  |PINTA #0#77;
     |FINSI;
|FPRC;

|| **********************************************************************
|PROCESO InformePDF;
   nSwError = 0;

   aIP = ""; |IP_REMOTO aIP;
   aContiene = "";
   |ESPECIFICA "RBASS", aContiene;
   aAlfa = aContiene1;
   aAlfa = aAlfa - "\";
   |SI FSalida ! 0;
      nCalc = ((FSalida / 100) ! 0) + 99;
      aAlfa = aAlfa % nCalc;
   |SINO;
      aAlfa = aAlfa - "/";
      |SI FSalida ! 0;
         nCalc = ((FSalida / 100) ! 0) + 99;
         aAlfa = aAlfa % nCalc;
      |FINSI;
   |FINSI;

   aAlfa = eaPathTemporal;
   aNombrePDF = (("00" + enOrMvo) % - 102) + aNombrePDF;

   |SI aIP ! "";
       |RMKDIR aAlfa;
   |SINO;
       |MKDIR aAlfa;
   |FINSI;

   Impresora = "CrystalReport;" + aAlfa + aNombrePDF;
   |IMPRE -1;
   |SI FSalida = 0;
       |INFOR informe;
       |SI FSalida ! 0;
          || |SI nSwMen = 0; |MENAV "     Error en informe."; |FINSI;
          nSwError = 1;
       |FINSI;
   |FINSI;
   enHayInforme = 1;
|FPRC;
|| **********************************************************************
|PROGRAMA;
   || si en "PARAMETRO" viene "WEB" no vuelve a la pantalla, sale al menu

   nArchi = 0;
   |SI enSwMvo = 0;
       |CLS;
       |CABEZA "Extractos por Impresora";
   |FINSI;

   |HAZ inicio;
   aPath08 = "";
   |DFICE dirfichO; |QBF dirfichO;
   |SI enEjercicio = 2008; aPath08 = dirfichO; |FINSI;
   nEjer    = enEjercicio;
   nPeriodo = enPeriodo;
   |SI aPath08 = "";
       |SALVA_DATOS #30;
       |ABRE #30;
       |SELECT #4#30;
       #30#2 = enEmpresa;
       #30#26 = 8;
       |LEE 001#30=;
       |SI FSalida = 0;
           aAlfa1 = #30#2; |QBF aAlfa1; aAlfa1 = ("00000" + aAlfa1) % -105;
           aAlfa2 = #30#3; |QBF aAlfa2; aAlfa2 = ("0"     + aAlfa2) % -101;
           |DFICB aPath08;
           aPath08 = aPath08 + aAlfa1 + aAlfa2 + "/";
       |FINSI;
       |SELECT #1#30;
       |CIERRA #30;
       |REPON_DATOS #30;
   |FINSI;

   |SI PARAMETRO = ""; |Y enSwMvo = 0;
      |HAZ ActivaPLB_arc1;
      eaVengoDe = "caextrim";
      |HAZ MiraSiArchiva;
   |FINSI;

   FSalida = 1;
   |PARA;|SI FSalida = 1; |HACIENDO;
         sw_pagina = 0;
         sw_prim = 0;
         sw_saldo = 0;
         sw_print = 0;
         sw_inf = 0;
         sw_cuen = 0;
         swtotal = 0;

         |SI enSwMvo = 2;
             |HAZ eLosInfBasica;

             |DDEFECTO #0;
             #0#0 = #dsinfcoc#60;
             #0#1 = #dsinfcoc#61;
             #0#2 = efDFecM;
             #0#3 = efHFecM;
             |PARA nPara1 = 4; |SI nPara1 [ 28; |HACIENDO nPara1 = nPara1 + 1;
                   nPara2 = nPara1 + 58;
                   #0nPara1 = #dsinfcoc#nPara2#;
             |SIGUE;
             #0#29 = #dsinfcoc#89; |HAZ colummes;
             #0#30 = efFecLeg;
             #0#33 = #dsinfcoc#87;
             #0#34 = #dsinfcoc#88;

             #0#35 = #dsinfcoc#90;
             #0#35 = "S";
             #0#36 = #dsinfcoc#91;
             #0#37 = #dsinfcoc#92;
             |PARA nPara1 = 39; |SI nPara1 [ 53; |HACIENDO nPara1 = nPara1 + 1;
                   nPara2 = nPara1 + 54;
                   #0nPara1 = #dsinfcoc#nPara2#;
             |SIGUE;
             #0#73 = #dsinfcoc#108;
             #0#74 = #dsinfcoc#109;

             FSalida = 0;
         |SINO;
             || ... |DDEFECTO #0;
             |PINPA #0#0;
             |PINDA #0#0;                    || Pinta los datos por defecto
             |ENDATOS #1#0;                  || Seleccion informe
         |FINSI;

         |SI FSalida = 0;                || Si el conforme es igua a S

             |HAZ Imprimir;
             |SI PARAMETRO ! "WEB"; |Y enSwMvo ! 2; |Y nSalir = 0;
                 FSalida = 1;
             |SINO;
                 FSalida = 0;
             |FINSI;
             |SI nArchi = 1; FSalida = 0; |FINSI;
        |SINO;
             FSalida = 0;
        |FINSI;
   |SIGUE;
|FPRO;

|PROCESO Imprimir;
    |SI nArchi = 1; |Y #0#75 = "N";
        |MENU aMenu;
        nOpcion = FSalida;
        |SI nOpcion = 0;
            |ACABA;
        |FINSI;
    |SINO;
         nOpcion = 1;
    |FINSI;
    nOpSegur = nOpcion

    |SI nOpSegur = 3;  |SALVA_DATOS #caextrim;  |FINSI;

    |SI nOpSegur = 1; |O nOpSegur = 3;
        nOpcion = 1;
        |HAZ impre_Uno;
        |SI nOpSegur = 3;  |REPON_DATOS #caextrim;  |FINSI;
        |SI nSalir = 1; |ACABA; |FINSI;
    |FINSI;

    |SI nOpSegur = 2; |O nOpSegur = 3;
        nOpcion = 2;
        |HAZ impre_Uno;
    |FINSI;
|FPRC;

|PROCESO impre_Uno;
   nSalir = 0;
   |SI nOpcion = 2;
        Impresora = "CrystalReport";
   |FINSI;
   |SI nOpcion = 1;
        |SI enSwMvo ! 2;
            |SI PARAMETRO = "AGENCIA"; |O #0#78 = "S";
                Impresora = "CrystalReport";
                |IMPRE -1;
            |SINO;
                |IMPRE 0;
            |FINSI;
        |FINSI;
        |SI FSalida ! 0;
            |MENAV "    Proceso abortado ...";
            nSalir  = 1;
            |ACABA;
        |FINSI;
   |FINSI;

   eaHora = (("00" + #0#76) % -102) + ":" + (("00" + #0#77) % -102):
   eaHora = "Hora: " + eaHora;
   |SI #8#18 = "N"; eaHora = ""; |FINSI;

   |HAZ los_informes;
   alfa4 = que_i1 % 201;

   |SI #0#72 = "N";
       |SI #0#35 = "S";
           informe = que_i1;
       |SINO;
           informe = que_i2;
       |FINSI;
   |SINO;
      |SI #0#72 = "S";
          |SI #0#35 = "S";
              informe = "caextrin";
          |SINO;
              informe = "caextrit";
          |FINSI;
          |SI #0#78 = "S"; informe = "caextrir"; |FINSI;
      |SINO;
          |SI #0#35 = "S";
              informe = "caextrid";
          |SINO;
              informe = "caextrsd";
          |FINSI;
      |FINSI;
      |SI alfa4 = "r"; |Y #0#78 ! "S";
          informe = "cr" + (informe % 306);
      |FINSI;
   |FINSI;
   |SI alfa4 = "l"; eaHora = eaHora > " "; |FINSI;
   alfa4 = informe % - 0101;
   |SI alfa4 = "d"; eaHora = eaHora > " "; |FINSI;

   aAlfa = Impresora;
   aAlfa = aAlfa % 113;
   |SI PARAMETRO = "AGENCIA";
       informe = "c1extrim";
   |FINSI;
   |SI informe = "caextrim"; |Y aAlfa ! "CrystalReport"; |Y enSwMvo ! 2;
       informe = "ccextrim";
   |FINSI;

   |SI aAlfa = "CrystalReport"; |Y enSwMvo ! 2;
       |SI informe = "caextrim"; |O informe = "crextrim"; |O informe = "clextrim";
           |SI nArchi = 0;
               |CONFI "0000NOrientacion horizontal";
           |SINO;
                FSalida = 1;
           |FINSI;
           |SI FSalida = 0;
               informe = "caextrih";
           |SINO;
               informe = "caextrim";
           |FINSI;
       |FINSI;
   |FINSI;
   |SI enSwMvo = 2; informe = "caextrim"; |FINSI;

   |SI enSwMvo ! 2;
       |SI nOpcion = 1;
           |INFOR informe;
           |SI FSalida ! 0; |ACABA; |FINSI;
       |FINSI;
   |SINO;
       aNombrePDF = "Extracto.pdf";
       |HAZ InformePDF;
       |SI nSwError = 1; |ACABA; |FINSI;
   |FINSI;

   |CIERRA #3;
   |CIERRA #5;

   |SI #0#75 = "N";
       |SI #48#27 = "S"; |Y enSwMvo ! 2;
           |HAZ MultiEmpresa;
       |SINO;
           |DFICE dirfich0; |QBF dirfich0;
           |HAZ HazTodo_Ant;
       |FINSI;
   |SINO;
       |HAZ MultiEjercicio;
   |FINSI;

   |SI nOpcion = 1;
       |FININF;
       |FINIMP;
   |FINSI;
|FPRC;

|| *************************************************************************
||                               MEOLLO
|| *************************************************************************

|PROCESO cabecera;

   #camaasic#0 = #camaasil#0;
   #camaasic#1 = #camaasil#1;
   #camaasic#2 = #camaasil#2;
   |LEE 040#2=;
   |SI FSalida ! 0;
      |DDEFECTO #2;
   |FINSI;

   |SI nSwAper ! 0;
       |SI nSwAper = 1;
           nAsto8 = #2#3 - 1; |SI nAsto8 [ 0; nAsto8 = 1; |FINSI;
           #2#3 = nAsto8;
       |SINO;
           #2#3 = nAsto8 + 1;
       |FINSI;
   |FINSI;
|FPRC;

|PROCESO concepto;
   sw_con = 0;
   |PARA x = 5; |SI x [ 28; |HACIENDO x = x + 1;
      |SI #caextrim#x#  = #camaasil#6;
         sw_con = 1;
         |SAL;
      |FINSI;
   |SIGUE;
|FPRC;

|PROCESO leecuen;

   sw_cuen  = 1;
   sw_saldo = 0;
   #cacuenta#0 = #camaasil#4;
   #cacuenta#1 = #camaasil#5;
   |LEE 040#3=;
   |SI FSalida ! 0; |DDEFECTO #3; |FINSI;
   t_debe = 0;
   t_haber = 0;
   t_saldo = 0;
   |SI #caextrim#29 = "N";
      campo = 12 + ((columna -1) * 3);
      |SI columna = 12; |Y #0#40 = 99;   campo = campo + 3;  |FINSI;

      |PARA d = 9; |SI d [ campo; |HACIENDO d = d + 3;
         h = d + 1;
         t_debe  = t_debe + #cacuenta#d#;
         t_haber = t_haber + #cacuenta#h#;
      |SIGUE;
      t_saldo = (t_debe - t_haber) ! EURODB;

      aAlfa1 = t_saldo; |QBF aAlfa1;
      |SI aAlfa1 = "0"; |O aAlfa1 = "-0";  t_saldo = 0;  |FINSI;

      |SI t_saldo = 0;  sw_saldo = 1; sw_print = 1; sw_cuen = 0;  |FINSI;
   |FINSI;

   direc = ""; codpos = ""; pobla = ""; provi = ""; cif = ""; telef = "";

   cuen = #camaasil#4 % 102;

   swCliPro = 0;
   #caclipro#23 = "C";
   #caclipro#10 = #camaasil#4;
   #caclipro#11 = #camaasil#5;
   |LEE 040#5=;
   |SI FSalida = 0;
      swCliPro = 1;
      direc = #caclipro#2;
      varalf = #caclipro#3;
      varalf = "0" + varalf;
      varalf = varalf % -102;
      codpos = varalf;
      varalf = #caclipro#4;
      varalf = "00" + varalf;
      varalf = varalf % -103;
      codpos = codpos + varalf;
      pobla = #caclipro#6;
      provi = #caclipro#5;
      cif = #caclipro#9;
      telef = #caclipro#7;
   |SINO;

      #caclipro#23 = "P";
      #caclipro#10 = #camaasil#4;
      #caclipro#11 = #camaasil#5;
      |LEE 040#5=;
      |SI FSalida = 0;
          swCliPro = 1;
          direc = #caclipro#2;
          varalf = #caclipro#3;
          varalf = "00" + varalf;
          varalf = varalf % -102;
          codpos = varalf;
          varalf = #caclipro#4;
          varalf = "000" + varalf;
          varalf = varalf % -103;
          codpos = codpos + varalf;
          pobla = #caclipro#6;
          provi = #caclipro#5;
          cif = #caclipro#9;
          telef = #caclipro#7;
        |FINSI;
   |FINSI;

   |SI swCliPro = 0;
   |FINSI;
|FPRC;

|| *************************************************************************
|PROCESO Apertura2008;
   |SALVA_DATOS #1;

   |ABRE #404;
   |DDEFECTO #404;
   #404#10 = nDia8;
   #404#11 = fFec8;
   #404#12 = nDoc8;
   #404#0  = #1#3;
   |LEE 041#404=;
   |SI FSalida ! 0; |O #404#8 ! #1#4; || no existe o no son iguales
       |CIERRA #404;
       |REPON_DATOS #1;
       |SI nSw_A = 0;
           |HAZ ParaImprimir;
       |SINO;
           |HAZ ParaImprimir_M;
       |FINSI;
       |ACABA;
   |FINSI;
   || .... Primer Asiento Apertura 2007
   nSwAper   = 1;
   contra_d  = contra_ad;
   contra_td = contra_tad;
   contra_h  = contra_ah;
   contra_th = contra_tah;
   #1#4 = #404#1;
   #1#5 = #404#7;
   |SI nSw_A = 0;
       |HAZ ParaImprimir;
   |SINO;
       |HAZ ParaImprimir_M;
   |FINSI;
   |SI #404#8 ! #404#1;
       nSwAper = 2;
       contra_d  = #404#8; contra_td = #404#2;
       contra_h  = #404#8; contra_th = #404#2;
       #1#4 = #404#1;   || 2ง asiento
       #1#5 = #404#7;
       #1#7 = #8#13;
       |SI #404#3 = "D";
           #1#8 = "H";
       |SINO;
           #1#8 = "D";
       |FINSI;
       #1#9 = #404#4 + #404#5;
       |SI nSw_A = 0;
           |HAZ ParaImprimir;
       |SINO;
           |HAZ ParaImprimir_M;
       |FINSI;

       contra_d  = #404#1; contra_td = #404#2;
       contra_h  = #404#1; contra_th = #404#2;
       #1#4 = #404#8;   || 2ง asiento
       #1#5 = #404#9;
       #1#7 = #8#13;
       #1#8 = #404#3;
       #1#9 = #404#4 + #404#5;
       |SI nSw_A = 0;
           |HAZ ParaImprimir;
       |SINO;
           |HAZ ParaImprimir_M;
       |FINSI;
   |FINSI;
   |CIERRA #404;
   |REPON_DATOS #1;
|FPRC;

|PROCESO buclepan;
   sw_con = 1;
   |SI #caextrim#4 = "N"; |HAZ concepto;  |FINSI;
   |SI sw_con = 0; |ACABA;  |FINSI;

   |SI sw_prim = 0;
      cuenta = #camaasil#4;
      sw_prim  = 1;
      |HAZ leecuen;
      |SI sw_saldo = 1; |ACABA; |FINSI;
   |FINSI;
   |SI cuenta ! #camaasil#4;
      |SI sw_print = 0;
         |SI #caextrim#35 = "N";
            sw_cab = 0;
            sw_inf = 2;
            |PRINT; swtotal = 1;
            sw_cab = 0;
         |SINO;
            |PIEINF;
         |FINSI;
      |FINSI;
      |HAZ borrar;
      cuenta = #camaasil#4;
      |HAZ leecuen;
   |FINSI;
   |SI sw_saldo = 1; |ACABA; |FINSI;

   nSwAper = 0;
   |SI nDia8 ! -1;
       |SI #1#0 = nDia8; |Y #1#1 = fFec8; |Y #1#2 = nDoc8;
           |HAZ Apertura2008;
           nDiaAper = 1;
           |ACABA;           ||este asiento se trata de forma diferente
       |FINSI;
   |FINSI;

   |HAZ ParaImprimir;
|FPRC;

|PROCESO ParaImprimir;
   |SI #camaasil#8 = "D";
      debe = #camaasil#9;
      haber = 0;
   |SINO;
      debe = 0;
      haber = #camaasil#9;
   |FINSI;
   |SI #camaasil#1 ] #caextrim#2; |Y #camaasil#1 [ #caextrim#3;
      |SI nSwOp = 0;
          |HAZ cabecera;
          |HAZ leocontra;
      |FINSI;
      || ........................ no pregunto linea |SI #camaasil#3 [ 30; |O swex_con = 1;
          |SI #camaasil#8 = "D";  contra = contra_d; contra_t = contra_td; |FINSI;
          |SI #camaasil#8 = "H";  contra = contra_h; contra_t = contra_th; |FINSI;
      ||                                            |SINO;
      ||                                                contra = "";
      ||                                            |FINSI;
      |SI #caextrim#35 = "N";  |Y sw_cuen = 1;
         sw_cab = 1;
         sw_inf = 0;
         |PRINT; swtotal = 1;
         sw_cab = 0;
         sw_cuen = 0;
      |FINSI;
      sw_inf = 1;
      sw_cab = 0;
      |PRINT; swtotal = 1;
      sw_cab = 0;
      sw_print = 0;
      swant = 1;
   |FINSI;
   |SI #camaasil#1 < #caextrim#2;
      |SI #camaasil#8 = "D";
         s_debe = s_debe  + #camaasil#9;
      |SINO;
         s_haber = s_haber + #camaasil#9;
      |FINSI;
      s_saldo = s_debe - s_haber;
      sw_print = 1;
      swant = 1;
   |FINSI;
|FPRC;

|PROCESO leocontra;
  |SI nSwAper = 0;
    contra = "";
    contra_t = "";
    contra_td = "";
    contra_th = "";

    contra_d = #2#10;
    |SALVA_DATOS #3;  |DDEFECTO #3;  #3#0 = #2#10;  #3#1 = #2#11;  |LEE 000#3=;
    contra_td = #3#2;
    |REPON_DATOS #3;

    contra_h = #2#8;
    |SALVA_DATOS #3;  |DDEFECTO #3;  #3#0 = #2#8;   #3#1 = #2#9;   |LEE 000#3=;
    contra_th = #3#2;
    |REPON_DATOS #3;

    swex_con = 0;
    #31#0 = #1#0;
    #31#1 = #1#1;
    #31#2 = #1#2;
    #31#3 = #1#3;
    |LEE 001#31=;
    |SI FSalida = 0;
        swex_con = 1;
        contra_h = #31#4;
        contra_d = #31#4;
        |SALVA_DATOS #3;
        |DDEFECTO #3;
        #3#0 = #31#4;
        #3#1 = #31#5;
        |LEE 000#3=;
        contra_td = #3#2;
        contra_th = #3#2;
        |REPON_DATOS #3;
    |FINSI;
 |FINSI;
|FPRC;

|DEFBUCLE caextrim0;
   #1#3;
   0, 6, 21,28;
   #0#0,  fec1, 000000, 0000, #0#39, #0#33, #0#36, #0#73;
   #0#1,  #0#3, 999999, 9999, #0#40, #0#34, #0#37, #0#74;
   e;
   NULL, NULL, NULL, NULL, NULL, buclepan;
   #1#4, #1#1, #1#2, #1#0, #1#3;
|FIN;

|| **********************************************************************
|PROCESO ParaApertura;
   nDia8  = -1;
   nAsto8 = 0;
   contra_ad  = ""; contra_tad = "";
   contra_ah  = ""; contra_tah = "";

   |SI enEjercicio = 2008;
       |ABRE #8;
       |DDEFECTO #8;
       #8#0 = 1;
       |LEE 001#8=;
       |CIERRA #8;

       |SI #8#11 = "S";
           |ABRE #404;
           |LEE 001#404p;
           |SI FSalida = 0;
               nDia8 = #404#10;
               fFec8 = #404#11;
               nDoc8 = #404#12;
           |FINSI;
           |CIERRA #404;
           |ABRE #2;
           #2#0 = nDia8;
           #2#1 = fFec8;
           #2#2 = nDoc8;
           |LEE 001#2=;
           |SI FSalida = 0;
               contra_ad  = #2#10; contra_tad = "";
               contra_ah  = #2#8;  contra_tah = "";
               |HAZ LeeContra;
           |FINSI;
           |CIERRA #2;
       |FINSI;
   |FINSI;
|FPRC;

|PROCESO LeeContra;
  |ABRE #3;
  |DDEFECTO #3;
  #3#0 = contra_ad;
  |LEE 000#3=;
  contra_tad = #3#2;

  |DDEFECTO #3;
  #3#0 = contra_ah;
  |LEE 000#3=;
  contra_tah = #3#2;

  |CIERRA #3;
|FPRC;

|| **********************************************************************
|| =========================================================================
|PROCESO LeeAuxiliar;
  nSwOp = 1;
  |DDEFECTO #1;
  |DDEFECTO #2;
  #1#0 = #999#0;
  #1#1 = #999#1;
  #1#2 = #999#2;
  #1#3 = #999#3;
  #1#4 = #999#4;
  #1#5 = #999#5;
  #1#6 = #999#6;
  #1#7 = #999#7;
  #1#8 = #999#8;
  #1#9 = #999#9;
  |SI #1#8 = "D";
      #1#16 = #1#4;
      #1#17 = #1#5;
  |SINO;
      #1#10 = #1#4;
      #1#11 = #1#5;
  |FINSI;
  #1#12 = #999#12;
  #1#13 = #999#13;
  #1#14 = #999#14;
  #1#15 = #999#15;
  #1#21 = #999#18;
  #1#28 = #999#19;
  #1#29 = #999#21;
  #2#0  = #1#0;
  #2#1  = #1#1;
  #2#2  = #1#2;
  #2#3  = #999#20;
  contra_h = #999#10; contra_th = #999#22;
  contra_d = #999#10; contra_td = #999#22;
  swex_con = 1;

  |HAZ buclepan;
|FPRC;

|DEFBUCLE ElAuxiliar;
 #999#1;
 ;
 "            ", #0#2, 000000, 00, 0001;
 "zzzzzzzzzzzz", #0#3, 999999, 99, 9999;
 e;
 NULL, LeeAuxiliar;
|FIN;

|PROCESO caextrim_M;
  sw_con = 1;
  |SI #0#4 = "N"; |HAZ concepto;  |FINSI;
  |SI sw_con = 0; |ACABA;  |FINSI;

  |SI #0#41 = "S";
      eaCuenta = #1#4;
      |SI nCambio ! 0;
          nEjerCam = enEjercicio;
          |HAZ CamCuenta;
          |SI nEjer ] 2008;
              eaCuenta = aCta08;
          |SINO;
              eaCuenta = aCta90;
          |FINSI;
      |FINSI;
      |SI eaCuenta < #0#0; |O eaCuenta > #0#1;
          |ACABA; ||no entra en la seleccion
      |FINSI;
      |HAZ SacaNivel;
  |FINSI;

  |SI sw_prim = 0;
      cuenta   = eaCuenta;
      sw_prim  = 1;
      |HAZ leecuen;
      |SI sw_saldo = 1; |ACABA; |FINSI;
  |FINSI;
  |SI cuenta ! eaCuenta;
      cuenta = eaCuenta;
      |HAZ leecuen;
  |FINSI;
  |SI sw_saldo = 1;   |ACABA;   |FINSI;

  nSwAper = 0;
  |SI nDia8 ! -1;
      |SI #1#0 = nDia8; |Y #1#1 = fFec8; |Y #1#2 = nDoc8;
          nSw_A = 1;
          |HAZ Apertura2008;
          nSw_A = 0;
          nDiaAper = 1;
          |ACABA;           ||este asiento se trata de forma diferente
      |FINSI;
  |FINSI;

  |HAZ ParaImprimir_M;
|FPRC;

|PROCESO ParaImprimir_M;
   |HAZ cabecera;
   |HAZ leocontra;
   |SI #camaasil#8 = "D";  contra = contra_d; contra_t = contra_td; |FINSI;
   |SI #camaasil#8 = "H";  contra = contra_h; contra_t = contra_th; |FINSI;

   #999#0 = #1#0;
   #999#1 = #1#1;
   #999#2 = #1#2;
   #999#3 = #1#3;
   #999#4 = eaCuenta;
   #999#5 = enNivel;
   #999#6 = #1#6;
   #999#7 = #1#7;
   #999#8 = #1#8;
   #999#9 = #1#9;
   #999#10 = contra;
   #999#11 = enNivel;
   #999#12 = #1#12;
   #999#13 = #1#13;
   #999#14 = #1#14;
   #999#15 = #1#15;
   #999#18 = #1#21;
   #999#19 = #1#28;
   #999#20 = #2#3;
   #999#21 = #1#29;
   #999#22 = contra_t;
   |GRABA 040#999n;
   nHay = 1;
|FPRC;

|DEFBUCLE caextrim0_M;
 #1#3;
 0, 6, 21, 28;
 aDCuenta, #0#2, 000000, 0001, #0#39, #0#33, #0#36, #0#73;
 aHCuenta, #0#3, 999999, 9999, #0#40, #0#34, #0#37, #0#74;
 e;
 NULL, caextrim_M;
|FIN;

|PROCESO HazTodo;
      nCambio = 0;
      sw_prim = 0;
      |SI enEjercicio < 2008; |Y nEjer ] 2008; nCambio = 1; |FINSI;
      |SI enEjercicio ] 2008; |Y nEjer < 2008; nCambio = 1; |FINSI;

      |HAZ ParaApertura;

      |ABRE #2;
      |ABRE #3;
      |ABRE #5;
      |ABRE #31;
      |SI #0#41 = "N";
          swtotal = 0;
          |PARA nCampo = 42; |SI nCampo [ 56; |HACIENDO nCampo = nCampo + 1;
                eaCuenta = #0nCampo;
                x        = nCampo + 15;
                enNivel  = #0x;
                |SI eaCuenta ! "            ";
                    aDCuenta = eaCuenta;
                    aHCuenta = eaCuenta;
                    |SI nCambio ! 0;
                        nEjerCam = nEjer;  ||la cuenta es la del ejercicio actual
                        |HAZ CamCuenta;
                        |SI enEjercicio < 2008;  || para buscar en el bucle
                            aDCuenta = aCta90;
                            aHCuenta = aCta90;
                        |SINO;
                            aDCuenta = aCta08;
                            aHCuenta = aCta08;
                        |FINSI;
                    |FINSI;
                    |BUCLE caextrim0_M;
                |FINSI;
          |SIGUE;
      |SINO;
          swtotal = 0;
          aDCuenta = #0#0;
          aHCuenta = #0#1;
          |SI nCambio ! 0; aDCuenta = ""; aHCuenta = "zzzzzzzzzzzzz"; |FINSI;
          |BUCLE caextrim0_M;
      |FINSI;
      |CIERRA #2;
      |CIERRA #3;
      |CIERRA #5;
      |CIERRA #31;
|FPRC;

|PROCESO MultiEmpM1;

   |HAZ CalFechas;
   |SI #0#2 > fec2; |O #0#3 < fec1;
       |ACABA;  || Fuera de la seleccion
   |FINSI;

   |DBASE dir_fich; |QBF dir_fich;
   dir_fich = dir_fich + "fich/";
   alfa1 = #30#2; |QBF alfa1;
   alfa2 = #30#3; |QBF alfa2;
   alfa1 = "00000" + alfa1;   alfa1 = alfa1 % -105;
   alfa2 = "0"     + alfa2;   alfa2 = alfa2 % -101;
   dirfich0 = dir_fich + alfa1 + alfa2 + "/";
   |QBF dirfich0;

   |PATH_DAT #1 dirfich0;
   |PATH_DAT #2 dirfich0;
   |PATH_DAT #3 dirfich0;
   |PATH_DAT #5 dirfich0;
   |PATH_DAT #8 dirfich0;
   |PATH_DAT #31 dirfich0;
   |PATH_DAT #404 dirfich0;
   |HAZ HazTodo;
|FPRC;


|DEFBUCLE MultiEmpM0;
 #30#1;
 ;
 enEmpresa, 0;
 enEmpresa, 9;
 ;
 NULL,MultiEmpM1;
|FIN;

|PROCESO MultiEjercicio;

   aFichero = "0w" + Usuario;
   |NOME_DAT #999 aFichero;
   nHay = 0;
   |DELINDEX #999;
   nSwOp = 0;
   |ABRE #999;
   |BUCLE MultiEmpM0;
   |CIERRA #999;

   cod1 = enEmpresa;
   cod2 = nPeriodo;
   emEmp = 1;  || Sin mensaje
   |HAZ leelo;
   |SI swerror ! 0;  |ACABA;   |FINSI;

   |DBASE dir_fich; |QBF dir_fich;
   dir_fich = dir_fich + "fich/";
   alfa1 = enEmpresa; |QBF alfa1;
   alfa2 = nPeriodo; |QBF alfa2;
   alfa1 = "00000" + alfa1;   alfa1 = alfa1 % -105;
   alfa2 = "0"     + alfa2;   alfa2 = alfa2 % -101;
   dirfich0 = dir_fich + alfa1 + alfa2 + "/";
   |PATH_DAT #3 dirfichO;
   |PATH_DAT #5 dirfichO;

   |SI nHay ! 0;
       |HAZ borrar;
       nSwOp     = 1;
       sw_prim   = 0;
       sw_pagina = 0;
       sw_prim   = 0;
       sw_saldo  = 0;
       sw_print  = 0;
       sw_inf    = 0;
       sw_cuen   = 0;
       swtotal   = 0;
       nDia8 = -1;
       |ABRE #3;
       |ABRE #5;
       |BUCLE ElAuxiliar;
       |CIERRA #5;
       |CIERRA #3;
       |SI #caextrim#35 = "N"; |Y sw_print = 0;
          sw_cab = 0;
          sw_inf = 2;
          |SI swtotal = 1; |PRINT; |FINSI;
          sw_cab = 0;
       |FINSI;
       |SI sw_print = 0; |Y swtotal = 1;
          |PIEINF;
       |FINSI;
   |FINSI;

   |DELINDEX #999;

   |PATH_DAT #1 dirfichO;
   |PATH_DAT #2 dirfichO;
   |PATH_DAT #3 dirfichO;
   |PATH_DAT #5 dirfichO;
   |PATH_DAT #8 dirfichO;
   |PATH_DAT #31 dirfichO;
   |PATH_DAT #404 dirfichO;
   enEjercicio = nEjer;
   enPeriodo   = nPeriodo;
|FPRC;

|| //////////////////////////////////////////////////////////////////////

|PROCESO HazTodo_Ant;  || Solo un ejercicio
|| ... Observaciones DsArchi
       alfa1 = #0#2; alfa1 = alfa1 % 0402; enM1 = alfa1;
       alfa1 = #0#3; alfa1 = alfa1 % 0402; enM2 = alfa1;
       eaObservaciones = "";
       |SI #0#39 = #0#40;
           |SI #0#39 = 00; eaObservaciones = "DE APERTURA"; |FINSI;
           |SI #0#39 = 99; eaObservaciones = "DE CIERRE";   |FINSI;
       |FINSI;
       |SI eaObservaciones = "";
           SwApertura = 0;
           SwCierre   = 0;
           NumMes = enM1; |HAZ NombreMes; NombreMes = " " + NombreMes; |QBF NombreMes;
           |SI #0#2 = fec1; |Y #0#39 = 00; NombreMes = " LA APERTURA"; SwApertura = 1; |FINSI;
           eaObservaciones = "DE" + NombreMes + " ";

           NumMes = enM2; |HAZ NombreMes; NombreMes = " " + NombreMes;
           |SI #0#3 = fec2; |Y #0#40 = 99; NombreMes = "L CIERRE"; SwCierre = 1; |FINSI;
           |SI enM1 ! enM2; |O SwApertura = 1; |O SwCierre = 1;
               eaObservaciones = eaObservaciones + "A" + NombreMes;
           |FINSI;
       |FINSI;
       eaObservaciones = eaObservaciones > " ";

   |HAZ borrar;
   nSwOp     = 0;
   sw_pagina = 0;
   sw_prim   = 0;
   sw_saldo  = 0;
   sw_print  = 0;
   sw_inf    = 0;
   sw_cuen   = 0;
   swtotal   = 0;

   |SI nOpcion = 2;
       eaInforme = informe;
       |HAZ ElIMPREArchi;
       |SI swErrorDSArchi = 1;
           nSalir = 1;
           |ACABA;
        |FINSI;
   |FINSI;

   |HAZ ParaApertura;

   |ABRE #2;
   |ABRE #3;
   |ABRE #5;
   |ABRE #31;
   |SI #caextrim#41 = "N";
       swtotal = 0;
       |PARA nCampo = 42; |SI nCampo [ 56; |HACIENDO nCampo = nCampo + 1;
             alfa1 = #caextrim#nCampo#; |QBF alfa1;
             |SI alfa1 ! "";
                 #caextrim#0 = #caextrim#nCampo#;
                 #caextrim#1 = #caextrim#nCampo#;
                 |BUCLE caextrim0;
             |FINSI;
       |SIGUE;
   |SINO;
       swtotal = 0;
       |BUCLE caextrim0;
   |FINSI;
   |CIERRA #2;
   |CIERRA #3;
   |CIERRA #5;
   |CIERRA #31;
   |SI #caextrim#35 = "N"; |Y sw_print = 0;
      sw_cab = 0;
      sw_inf = 2;
      |SI swtotal = 1; |PRINT; |FINSI;
      sw_cab = 0;
   |FINSI;
   |SI sw_print = 0; |Y swtotal = 1;
      |PIEINF;
   |FINSI;

   |SI nOpcion = 2;
      |FININF;
      |FINIMP;
      |SI swErrorDSArchi = 0;
          |HAZ Archivando;
      |FINSI;
      Impresora = "CrystalReport";
   |FINSI;
|FPRC;

|PROCESO borrar;
   s_debe = 0;
   s_haber = 0;
   s_saldo = 0;
   swant = 0;
   nDiaAper = 0;
|FPRC;

|| **********************************************************************
|PROCESO MultiEmp1;
   cod1 = #caselem1#1;
   cod2 = #caselem1#2;
   emEmp = 1;  || Sin mensaje
   |HAZ leelo;
   |SI swerror ! 0;  |ACABA;   |FINSI;

   dirfich0 = #caselem1#3;
   |QBF dirfich0;

   |PATH_DAT #1 dirfich0;
   |PATH_DAT #2 dirfich0;
   |PATH_DAT #3 dirfich0;
   |PATH_DAT #5 dirfich0;
   |PATH_DAT #8 dirfich0;
   |PATH_DAT #31 dirfich0;
   |PATH_DAT #404 dirfich0;

   |HAZ HazTodo_Ant;
|FPRC;

|DEFBUCLE MultiEmp0;
   #caselem1#1;
   ;
   000001;
   999999;
   ;
   NULL,MultiEmp1;
|FIN;

|PROCESO MultiEmpresa;
  |SI nOpSegur ! 3; |O nOpcion = 1;
      |SUB_EJECUTA "caselemp";
      |NOME_DAT #998 eaFichsel;
  |FINSI;
  |BUCLE MultiEmp0;
  |SI nOpSegur ! 3; |O nOpcion = 2;
      |DELINDEX #998;
  |FINSI;
|FPRC;

|PROCESO CamCuenta;
   aCta08 = eaCuenta;
   aCta90 = eaCuenta;
   |SI aPath08 ! "";
       |PATH_DAT #403 aPath08;
       |ABRE #403;
       |DDEFECTO #403;
       |SI nEjerCam ] 2008;
           |SELECT #2#403;
           #403#2 = eaCuenta;
           |LEE 041#403];
           |SI FSalida = 0; |Y #403#2 = eaCuenta;
               aCta08 = #403#2;
               aCta90 = #403#0;
           |FINSI;
           |SELECT #1#403;
       |SINO;
           #403#0 = eaCuenta;
           |LEE 041#403=;
           |SI FSalida = 0;
               aCta08 = #403#2;
               aCta90 = #403#0;
           |FINSI;
       |FINSI;
       |CIERRA #403;
   |FINSI;
|FPRC;

|PROCESO CalFechas;
   |SI #30#26 < 80;
       enEjercicio = #30#26 + 2000;
   |SINO;
       enEjercicio = #30#26 + 1900;
   |FINSI;

   cod2 = #30#26;
   tra1 = 100 + cod2;
   clave2 = tra1 % -102;
   tra1 = 100 + #30#11;
   mes1 = tra1 % -102;
   |SI cod2 < 80;
      work1 = "01." + mes1 + ".20" + clave2;
   |SINO;
      work1 = "01." + mes1 + ".19" + clave2;
   |FINSI;
   fec1 = work1;
   tra1 = 100 + #30#12;
   mes1 = tra1 % -102;
   |SI #30#11 > #30#12;
      cod2 = cod2 + 1;
      |SI cod2 > 99; cod2 = cod2 - 100;    |FINSI;
   |FINSI;
   dia1 = "31";
   |SI #30#12 = 4; |O #30#12 = 6; |O #30#12 = 9; |O #30#12 = 11;
      dia1 = "30";
   |FINSI;
   |SI #30#12 = 2;
      dia1 = "28";
      |SI cod2 = 88; |O cod2 = 92; |O cod2 = 96; |O cod2 = 0; |O cod2 = 4; |O cod2 = 8;
          |O cod2 = 12; |O cod2 = 16; |O cod2 = 20; |O cod2 = 24;
         dia1 = "29";
      |FINSI;
   |FINSI;
   tra1 = 100 + cod2;
   clave2 = tra1 % -102;
   |SI cod2 < 80;
      work1 = dia1 + "." + mes1 + ".20" + clave2;
   |SINO;
      work1 = dia1 + "." + mes1 + ".19" + clave2;
   |FINSI;
   fec2 = work1;
|FPRC;
