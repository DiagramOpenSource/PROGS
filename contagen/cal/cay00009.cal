|FICHEROS;
   cay00009 #0;
   cacuenta #1;
   caparexp #2;
   cabaexp0 #3;
   cabaexp1 #4;
   cabaexp2 #5;
   caexistc #6;
   caexistl #7;
   caconimp #8;
   cacuesub #11;

   canempre #30;
   caselem1 #998;
   cawdatos #900;
|FIN;

|VARIABLES;
  &eSwSelec  = 1;
  &eaDDepar  = "";
  &eaHDepar  = "";
  &eaDSubde  = "";
  &eaHSubde  = "";
  &enCNivel  = 0;   || 0 = dep y subd, 1 = un solo dep, 2 = un total por cta
  &efDFecha  = @;
  &efHFecha  = @;
  &eaNomFSub = "";  ||Nombre del Fichero Creado
  &eaSubDe0  = "";

  nLaActividad = 0;
  aDActividad  = "";
  aHActividad  = "";

  nDEst    = 0;
  nHEst    = 0;
  nInkey   = 0;
  aAlfa    = "";
  aAlfa1   = "";
  aAlfa2   = "";
  nNume1   = 0;
  nivel    = 0;
  aFichero = "";
  nPara1   = 0;
  nPara2   = 0;

  &pathbal = "";
  &balance = 1;
  &entrada = 0;

  FEstado = 0;
  sw_pasa = 0;
  linea = 0;
   debe1 = 0;
   x = 0;
   &eldesde = 0;
   &elhasta = 0;
   sw_d1 = 0;
   debe2 = 0;
   sw_d2 = 0;
   debe3 = 0;
   sw_d3 = 0;
   debe4 = 0;
   sw_d4 = 0;
   haber1 = 0;
   sw_h1 = 0;
   haber2 = 0;
   sw_h2 = 0;
   haber3 = 0;
   sw_h3 = 0;
   sw = 0;
   bloque = 0;
   agrupaci = 0;
   epigrafe = 0;
   partida = 0;
   bloque1 = 0;
   H = 0;
   sw_epi = 0;
   sw_d21 = 0;
   sw_d31 = 0;
   sw_h21 = 0;
   sw_h31 = 0;
   sw_h32 = 0;
   punto_h1 = 0;
   punto_d1 = 0;
   punto_h2 = 0;
   punto_d2 = 0;
   punto_h3 = 0;
   punto_d3 = 0;
   punto_h4 = 0;
   punto_d4 = 0;
   punto_h5 = 0;
   punto_d5 = 0;
   punto_h6 = 0;
   punto_d6 = 0;
   punto_h12 = 0;
   punto_d12 = 0;
   punto_h22 = 0;
   punto_d22 = 0;
   punto_h32 = 0;
   punto_d32 = 0;
   punto_h42 = 0;
   punto_d42 = 0;
   punto_h52 = 0;
   punto_d52 = 0;
   punto_h61 = 0;
   punto_d61 = 0;

   d = "D";
   h = "H";
   tipo = "";
   tipo1 = "";
   &sw_inf = 0;
   &cantidad = 0;
   &cantidad2 = 0;
   &variable = "";
   &canti = 0;
   &canti2 = 0;
   &doh = "";
   mes_fin = 0;
   descar = 0;
   traraf = 0;
   informe = "cay00009";
   alfa1 = "";
   &r_emp = 0;
   &r_per = 0;
   &anu = 0;
   &anu1 = 0;
   &cta = "";
   &nom = "";
   alfa2 = "";
   alfa3 = "";
   debe11 = 0;
   debe21 = 0;
   debe31 = 0;
   debe41 = 0;
   haber11 = 0;
   haber21 = 0;
   haber31 = 0;
   tracan5 = 0;
   &d_mes = 0;
   &h_mes = 0;
   &estru = 0;
   &r_eje = 0;
   &r_nom = "";
   &aparam = "";

  &eaNomFEst  = "";  ||Nombre del Fichero Creado
  &eaEstruc   = "";
  &eaEstrucN  = "";
  &enCam1     = 0;
  &enCam2     = 0;
  aNomCta     = "";
  aNomCta1    = "";

  aDCuenta    = "";
  aHCuenta    = "";
|FIN;

|INCLUYE dscont_i;
|INCLUYE digito_i;

|| ========================================================================
||                        CALCULOS PANTALLA
|| ========================================================================
|CALCULO inicio_b; |TIPO 8;
  |HAZ inicial;
  |SI swerror = 2; |PTEC 807; |ACABA; |FINSI;
  |SI swerror = 3; |PTEC 831; |PTEC 807; |ACABA; |FINSI;
  |HAZ DirAplicSt;
|FCAL;

|PROCESO deentrada;  |TIPO 7;
 |SI eaDepar = "N"; |Y eaSubde = "N";
     |MENAV "    No utiliza Departamentos ni subdepartamentos ";
     |PTEC 807;
     |ACABA;
 |FINSI;

 aAlfa1 = eaDepar; aAlfa2 = eaSubde;
 |SI eaDepar = "N"; |PDEFECTO #0, 15, 23; #0#31 = "S"; |FINSI;
 |SI eaSubde = "N"; |PDEFECTO #0, 23, 31; #0#32 = "S"; |FINSI;
 |C_M #0#15, 1, aAlfa1; |C_M #0#16, 1, aAlfa1;
 |C_M #0#17, 1, aAlfa1; |C_M #0#18, 1, aAlfa1;
 |C_M #0#19, 1, aAlfa1; |C_M #0#20, 1, aAlfa1;
 |C_M #0#21, 1, aAlfa1; |C_M #0#22, 1, aAlfa1;
 |C_M #0#23, 1, aAlfa2; |C_M #0#24, 1, aAlfa2;
 |C_M #0#25, 1, aAlfa2; |C_M #0#26, 1, aAlfa2;
 |C_M #0#27, 1, aAlfa2; |C_M #0#28, 1, aAlfa2;
 |C_M #0#29, 1, aAlfa2; |C_M #0#30, 1, aAlfa2;
 |C_M #0#31, 1, aAlfa1; |C_M #0#32, 1, aAlfa2;
 |HAZ DatosEmp;
 |PINDA #0#0;
|FPRC;

|PROCESO pintames; |TIPO 0;
  nNume1 = Campo + 2;
  |SI #0Campo ! 0; |Y #0Campo ! 13;
       NumMes = dig1 + (#0Campo - 1);
       |SI NumMes > 12;
           NumMes = NumMes - 12;
       |FINSI;
  |SINO;
       NumMes = #0Campo;
  |FINSI;
  |HAZ NombreMes;
  #0nNume1 = NombreMes; |PINTA #0nNume1;

   |SI Campo = 1;  |Y #0#0 > #0#1;
       |MENAV "    Error de Entrada ...";
       |ERROR;
   |FINSI;
|FPRC;

|PROCESO pintames2; |TIPO 0;
  |SI #0Campo ! 0; |Y #0Campo ! 13;
      NumMes = dig1 + (#0Campo - 1);
      |SI NumMes > 12;   NumMes = NumMes - 12;  |FINSI;
  |SINO;
      NumMes = #0Campo;
  |FINSI;
  |HAZ NombreMes;

  |ATRI I;
  |SI Campo = 7;  |PINTA 1161, NombreMes;  |FINSI;
  |SI Campo = 8;  |PINTA 1261, NombreMes;  |FINSI;
  |ATRI 0;
  |SI Campo = 8;  |Y #0#7 > #0#8;
      |MENAV "    Error de Entrada ...";
      |ERROR;
   |FINSI;
|FPRC;

|PROCESO nivel; |TIPO 7;
   |SI #0#4 = "N";
       |CAMPO_MODIFICA #0#5,1,"N";
   |SINO;
       |CAMPO_MODIFICA #0#5,1,"S";
   |FINSI;
|FPRC;

|PROCESO miraniv; |TIPO 0;
   nivel = #0#5;
   |SI nivel = 1;|Y dig4 = 0;  |AVISO;  |ERROR;  |FINSI;
   |SI nivel = 2;|Y dig5 = 0;  |AVISO;  |ERROR;  |FINSI;
   |SI nivel = 3;|Y dig6 = 0;  |AVISO;  |ERROR;  |FINSI;
   |SI nivel = 4;|Y dig7 = 0;  |AVISO;  |ERROR;  |FINSI;
   |SI nivel = 5;|Y dig8 = 0;  |AVISO;  |ERROR;  |FINSI;
   |SI nivel = 6;|Y dig9 = 0;  |AVISO;  |ERROR;  |FINSI;
|FPRC;

|PROCESO DatosEmp; |TIPO 7;
 |ABRE #8;
 |DDEFECTO #8;
 #8#0 = 1;
 |LEE 011#8=;
 |CIERRA #8;
 #0#14 = #8#7; |PINTA #0#14;
 alfa1 = #8#8; |C_M #0#14,1,alfa1;
|FPRC;

|PROCESO SelDepar; |TIPO 0;
 |C_M #0Campo, 0, aAlfa1;
 |SI aAlfa1 = "N"; |ACABA; |FINSI;

 aAlfa1 = #0Campo;
 aAlfa2 = "S";
 |SI aAlfa1 = "S";
     aAlfa2 = "N";
     #0#18 = ""; |PINTA #0#18;
     #0#19 = ""; |PINTA #0#19;
     #0#20 = ""; |PINTA #0#20;
     #0#21 = ""; |PINTA #0#21;
     #0#22 = ""; |PINTA #0#22;
 |SINO;
     #0#16 = "  "; |PINTA #0#16;
     #0#17 = "99"; |PINTA #0#17;
 |FINSI;
 |C_M #0#16, 1, aAlfa1;
 |C_M #0#17, 1, aAlfa1;
 |C_M #0#18, 1, aAlfa2;
 |C_M #0#19, 1, aAlfa2;
 |C_M #0#20, 1, aAlfa2;
 |C_M #0#21, 1, aAlfa2;
 |C_M #0#22, 1, aAlfa2;
|FPRC;

|PROCESO SelSubDe; |TIPO 0;
 |C_M #0Campo, 0, aAlfa1;
 |SI aAlfa1 = "N"; |ACABA; |FINSI;

 aAlfa1 = #0Campo;
 aAlfa2 = "S";
 |SI aAlfa1 = "S";
     aAlfa2 = "N";
     #0#26 = ""; |PINTA #0#26;
     #0#27 = ""; |PINTA #0#27;
     #0#28 = ""; |PINTA #0#28;
     #0#29 = ""; |PINTA #0#29;
     #0#30 = ""; |PINTA #0#30;
 |SINO;
     #0#24 = "";    |PINTA #0#24;
     #0#25 = "zzz"; |PINTA #0#25;
 |FINSI;
 |C_M #0#24, 1, aAlfa1;
 |C_M #0#25, 1, aAlfa1;
 |C_M #0#26, 1, aAlfa2;
 |C_M #0#27, 1, aAlfa2;
 |C_M #0#28, 1, aAlfa2;
 |C_M #0#29, 1, aAlfa2;
 |C_M #0#30, 1, aAlfa2;
|FPRC;

|CALCULO AntesDepar; |TIPO 7;
   |C_M #0Campo, 0, aAlfa1;
   |SI aAlfa1 = "S"
       |SI Haybasica = 1;
           |MENSA "    <F2> Consultar Actividades";
       |SINO;
           |MENSA "    <F2> Consultar Departamentos";
       |FINSI;
   |FINSI;
|FCAL;

|CALCULO AntesSubde; |TIPO 7;
   |C_M #0Campo, 0, aAlfa1;
   |SI aAlfa1  = "S";
      |SI Haybasica = 1;
          |SI enArrend ! 2;
              |MENSA "    Subdepartamento. <F2> Consultar Referencias Catastrales";
          |SINO;
              |MENSA "    Subdepartamento. <F2> Consultar Cultivos";
          |FINSI;
      |FINSI;
   |FINSI;
|FCAL;

|CALCULO TrasDepar; |TIPO 0;
   nInkey = FSalida;
   |C_M #0Campo, 0, aAlfa1;
   |SI aAlfa = "N"; |ACABA; |FINSI;

   eOpDep = 0; || 1 = Consulta pantalla
   |SI nInkey = 10;eOpDep = 1; |FINSI;
       enActividad = #0Campo;
       eaCodDep    = #0Campo;
       |HAZ Actividad;
   |SI eOpDep = 1;  #0Campo = eaCodDep; |PINTA #0Campo; |FINSI;
|FCAL;

|CALCULO TrasSubde; |TIPO 0;
   nInkey = FSalida;
   |C_M #0Campo, 0, aAlfa1;
   |SI aAlfa = "N"; |ACABA; |FINSI;

   eOpSub = 0; || 1 = Consulta pantalla
   |SI nInkey = 10;
       eOpSub = 1;
       enConcepto  = 700;
       eaCodSubdep = #0Campo;
       enQue = 2;
       |HAZ SubActividad;
       enQue = 0;
       #0Campo = eaCodSubdep; |PINTA #0Campo;
   |FINSI;
|FCAL;

|| ----------------------------------------------------------------------
|PROCESO ModExistencias;
   estru = #6#0;
   |SUB_EJECUTA "caexicon.run";
|FPRC;

|DEFBUCLE ModExistencias;
      #6#1;
      ;
      nDEst;
      nHEst;
      e;
      NULL, ModExistencias;
|FIN;

|PROCESO conexi;
   enTExi = 1;
   d_mes = #0#7;
   h_mes = #0#8;
   r_emp = empre;
   r_per = ejerc;
   r_eje = #canempre#26;
   r_nom = #canempre#1;
   |SI #0#15 = "S";
       nDEst = #0#16;
       nHEst = #0#17;
       |BUCLE ModExistencias;
   |SINO;
       |PARA nPara1 = 18; |SI nPara1 [ 22; |HACIENDO nPara1 = nPara1 + 1;
             |SI #0nPara1 > "  ";
                 nDEst = #0nPara1;
                 nHEst = #0nPara1;
                 |BUCLE ModExistencias;
             |FINSI;
       |SIGUE;
   |FINSI;
|FPRC;

|| ========================================================================
||                        CALCULOS INFORME
|| ========================================================================
|PROCESO acortacuen;
   |SI nivel < #1#1;
      |SI nivel = 1;  traraf = 100 + dig4;  |FINSI;
      |SI nivel = 2;  traraf = 100 + dig5;  |FINSI;
      |SI nivel = 3;  traraf = 100 + dig6;  |FINSI;
      |SI nivel = 4;  traraf = 100 + dig7;  |FINSI;
      |SI nivel = 5;  traraf = 100 + dig8;  |FINSI;
      #1#0 = #1#0 % traraf;
      #1#1 = #0#5;
      #1#0 = #1#0 + "              ";
      #1#0 = #1#0 % 112;
   |FINSI;
|FPRC;

|PROCESO cargatra;
   #5#0 = #1#5;
   #5#1 = #1#4;
   #5#2 = #1#6;
   #5#3 = #1#7;
   #5#4 = #1#8;
   |HAZ acortacuen;
   #5#5 = #1#0;
   #5#6 = #1#1;
   #5#7 = #1#2;
   |LEE 000#5=;
   |SI FSalida ! 0;
      |DDEFECTO #5;
      #5#0 = #1#5;
      #5#1 = #1#4;
      #5#2 = #1#6;
      #5#3 = #1#7;
      #5#4 = #1#8;
      |HAZ acortacuen;
      #5#5 = #1#0;
      #5#6 = #1#1;
      #5#7 = #1#2;
      #5#11 = 0;
      #5#12 = 0;
      |GRABA 020#5c;
   |FINSI;
   |DDEFECTO #2;
   #caparexp#0 = #1#5;
   #caparexp#1 = #1#6;
   #caparexp#3 = #1#7;
   #caparexp#5 = #1#8;
   |LEE 000#2=;
   |SI FSalida ! 0;
      #caparexp#2 = "";
      #caparexp#4 = "";
      #caparexp#6 = "";
   |FINSI;
   #5#8 = #caparexp#2;
   #5#9 = #caparexp#4;
   #5#10 = #caparexp#6;
|FPRC;

|| ... Descarga de Existencias
|PROCESO sumasal;    || Calculamos cada cuenta
   |SI #1#5 = "D"; |Y #1#4 = 1;
      debe1 = debe1 + descar;
   |FINSI;

   |SI #1#5 = "D"; |Y #1#4 = 2;
      debe2 = debe2 + descar;
   |FINSI;

   |SI #1#5 = "D"; |Y #1#4 = 3;
      debe3 = debe3 + descar;
   |FINSI;

   |SI #1#5 = "D"; |Y #1#4 = 4;
      debe4 = debe4 + descar;
   |FINSI;

   |SI #1#5 = "H"; |Y #1#4 = 1;
      haber1 = haber1 + descar;
   |FINSI;

   |SI #1#5 = "H"; |Y #1#4 = 2;
      haber2 = haber2 + descar;
   |FINSI;

   |SI #1#5 = "H"; |Y #1#4 = 3;
      haber3 = haber3 + descar;
   |FINSI;
|FPRC;

|PROCESO grabatr1;
   #1#0 = #4#6;
   |LEE 040#1=;
   |SI FSalida ! 0; |ACABA;  |FINSI;
   #3#0 = #1#5;
   #3#1 = #1#4;
   #3#2 = #1#6;
   #3#3 = #1#7;
   #3#4 = #1#8;
   |LEE 101#3=;
   FEstado = FSalida;
   |SI FEstado ! 0;
       |DDEFECTO #3;
       #3#0 = #1#5;
       #3#1 = #1#4;
       #3#2 = #1#6;
       #3#3 = #1#7;
       #3#4 = #1#8;
       |HAZ leexplot;
       #3#5 = #caparexp#3;
       #3#6 = #caparexp#5;
       #3#7 = #caparexp#7;
   |FINSI;
   |SI #1#5 = "H"; descar = -descar; |FINSI;
   #3#8 = #3#8 + descar;
   #3#9 = 1;
   |SI #3#8 ! 0;
      |SI FEstado = 0; |GRABA 020#3a; |SINO; |GRABA 020#3n; |FINSI;
   |FINSI;
   |LIBERA #3;
   |HAZ sumasal;
|FPRC;

|PROCESO descarg;
   |HAZ digitos2;
   |SI d_error ! 0;  |ACABA;  |FINSI;

   linea = linea + 1;
   #4#0 = linea;
   #4#8 = #0#6;
   |LEE 001#4=;
   |SI FSalida = 0;  |BORRA 020#4a;  |FINSI;
   |DDEFECTO #4;
   #4#0 = linea;    || linea
   #4#8 = #6#0;     || estructura
   #4#1 = #1#0;     || cuenta
   #4#2 = #1#1;     || digito
   #4#3 = #1#2;     || descripcion

   mes_fin = #0#7 + 11;
   #4#4 = #7mes_fin;      || exist. iniciales

   mes_fin = #0#8 + 11;
   #4#5 = #7mes_fin;      || exist. finales

   descar = #4#4 - #4#5;
   tracan5 = descar; || diferencia entre iniciales y finales
   |SI descar ] 0;
       #4#6 = #7#5;     || cuenta descarga D
       #4#7 = #7#6;     || digito descarga D
   |SINO;
       #4#6 = #7#8;     || cuenta descarga H
       #4#7 = #7#9;     || digito descarga H
   |FINSI;
   |SI #0#4 = "N";  nivel = #4#7;  |FINSI;
   |SI nivel < #4#7;
      |SI nivel = 1;  traraf = 100 + dig4;  |FINSI;
      |SI nivel = 2;  traraf = 100 + dig5;  |FINSI;
      |SI nivel = 3;  traraf = 100 + dig6;  |FINSI; || trata cta. descarga
      |SI nivel = 4;  traraf = 100 + dig7;  |FINSI;
      |SI nivel = 5;  traraf = 100 + dig8;  |FINSI;
      #4#6 = #4#6 % traraf;
      #4#7 = nivel;
      #4#6 = #4#6 + "              ";
      #4#6 = #4#6 % 112;
   |FINSI;
   |GRABA 020#4n;
   |HAZ grabatr1;

   |SI #0#4 = "N";  |ACABA; |FINSI;
   |HAZ cargatra;
   |SI #1#5 = "H"; tracan5 = -tracan5; |FINSI;
   #5#11 = #5#11 + tracan5;
   |GRABA 020#5a;
   |LIBERA #5;
|FPRC;

|PROCESO lineades;
   #1#0 = #7#2;
   #1#1 = #7#3;
   |LEE 000#1=;
   |SI FSalida = 0; |Y #1#0 > doce;
       |HAZ descarg;
   |FINSI;
|FPRC;

|PROCESO LeoExistencias;
   |BUCLELIN 0lineades#6;
|FPRC;

|DEFBUCLE LeoExistencias;
   #6#1;
   ;
   nDEst;
   nHEst;
   e;
   NULL, LeoExistencias;
|FIN;

|PROCESO pidepan;
   |SI #0#15 = "S";
       nDEst = #0#16;
       nHEst = #0#17;
       |BUCLE LeoExistencias;
   |SINO;
       |PARA nPara1 = 18; |SI nPara1 [ 22; |HACIENDO nPara1 = nPara1 + 1;
             |SI #0nPara1 > "  ";
                 nDEst = #0nPara1;
                 nHEst = #0nPara1;
                 |BUCLE LeoExistencias;
             |FINSI;
       |SIGUE;
   |FINSI;
|FPRC;

|PROCESO miracuen;
   |SI #4#6 = #1#0;
       descar = #4#4 - #4#5;
       |SI #1#5 = "H"; descar = -descar; |FINSI;
       cantidad = cantidad + descar;
       sw_pasa = 1;
   |FINSI;
|FPRC;

|DEFBUCLE cabaexpl4;
   #4#1;
   ;
   00, 001;
   99, 999;
   ;
   NULL, miracuen;
|FIN;

|PROCESO calculit;
   |HAZ digitos2;
   |SI d_error ! 0;  |ACABA;  |FINSI;
   |SI #0#4 = "N";  |Y #1#3 = "N";                     |ACABA;  |FINSI;
   |SI #0#4 = "S";  |Y #1#55 > nivel;                  |ACABA;  |FINSI;
   |SI #0#4 = "S";  |Y #1#3 = "N";  |Y #1#55 ! nivel;  |ACABA;  |FINSI;
   |HAZ grabatra;
|FPRC;

|DEFBUCLE cabaexpl0;
   #1#4;
   ;
   "D", 1, 01, 00, 00;
   "H", 4, 99, 99, 99;
   e;
   NULL, calculit;
|FIN;

|PROCESO grabatra;
   #3#0 = #1#5;
   #3#1 = #1#4;
   #3#2 = #1#6;
   #3#3 = #1#7;
   #3#4 = #1#8;
   |LEE 101#3=;
   FEstado = FSalida;
   |SI FEstado ! 0;
      |DDEFECTO #3;
      #3#0 = #1#5;
      #3#1 = #1#4;
      #3#2 = #1#6;
      #3#3 = #1#7;
      #3#4 = #1#8;
      |HAZ leexplot;
      #3#5 = #caparexp#3;
      #3#6 = #caparexp#5;
      #3#7 = #caparexp#7;
   |FINSI;
   sw_pasa  = 0;
   cantidad = 0;
   |BUCLE cabaexpl4;
   |SI sw_pasa = 0;
      |HAZ resulta;
      #3#9 = 0;
      |SI #3#8 ! 0;
          |SI FEstado = 0;
              |GRABA 020#3a;
          |SINO;
              |GRABA 020#3n;
          |FINSI;
      |SINO;
         |SI FEstado = 0;
             |GRABA 020#3a;
         |FINSI;
      |FINSI;
      |SI #0#4 = "S";
          |HAZ grabatr4;
      |FINSI;
   |FINSI;
   |LIBERA #3;
|FPRC;

|PROCESO LeoCtaSubd;
 |SI #0#31 = "S";
     |SI #0#15 = "N";
         |SI #11#57 ! #0#18; |Y #11#57 ! #0#19; |Y #11#57 ! #0#20;
             |Y #11#57 ! #0#21; |Y #11#57 ! #0#22;
                |ACABA;
         |FINSI;
     |FINSI;
 |FINSI;
 |SI #0#23 = "N";
     |SI #11#72 ! #0#24; |Y #11#72 ! #0#25; |Y #11#72 ! #0#26;
         |Y #11#72 ! #0#27; |Y #11#72 ! #0#28;
            |ACABA;
     |FINSI;
 |FINSI;

 |PARA nPara1 = 9; |SI nPara1 [ 53; |HACIENDO nPara1 = nPara1 + 1;
       #1nPara1 = #1nPara1 + #11nPara1;
 |SIGUE;
|FPRC;

|DEFBUCLE LeoCtaSubd;
 #11#1;
 ;
 eaDDepar,eaDSubde, aDCuenta;
 eaHDepar,eaHSubde, aHCuenta;
 ;
 NULL, LeoCtaSubd;
|FIN;

|PROCESO resulta;    || Calculamos cada cuenta
   |SI #0#31 = "N";
       eaDDepar = eaCodDep;
       eaHDepar = eaCodDep;
   |SINO;
       eaDDepar = #0#16;
       eaHDepar = #0#17;
   |FINSI;
   aDCuenta = #1#0;
   aHCuenta = #1#0; |QBF aHCuenta;
   aHCuenta = (aHCuenta + "zzzzzzzzzzzz") % 112;
   |PDEFECTO #1, 9, 54;
   |BUCLE LeoCtaSubd;

   |SI #3#0 = "D"; |Y #3#1 = 1;
      |PARA x = eldesde; |SI x [ elhasta; |HACIENDO x = x + 3;
             #3#8 = #3#8   + #1x;
             debe1 = debe1 + #1x;
      |SIGUE;
       sw_d1 = 1;
   |FINSI;

   |SI #3#0 = "D"; |Y #3#1 = 2;
       |PARA x = eldesde; |SI x [ elhasta; |HACIENDO x = x + 3;
             #3#8 = #3#8   + #1x;
             debe2 = debe2 + #1x;
      |SIGUE;
      sw_d2 = 1;
   |FINSI;

   |SI #3#0 = "D"; |Y #3#1 = 3;
      |PARA x = eldesde; |SI x [ elhasta; |HACIENDO x = x + 3;
             #3#8 = #3#8   + #1x;
             debe3 = debe3 + #1x;
      |SIGUE;
      sw_d3 = 1;
   |FINSI;

   |SI #3#0 = "D"; |Y #3#1 = 4;
      |PARA x = eldesde; |SI x [ elhasta; |HACIENDO x = x + 3;
             #3#8 = #3#8   + #1x;
             debe4 = debe4 + #1x;
      |SIGUE;
       sw_d4 = 0;
   |FINSI;

   |SI #3#0 = "H"; |Y #3#1 = 1;
       |PARA x = eldesde; |SI x [ elhasta; |HACIENDO x = x + 3;
            #3#8   = #3#8   + (#1x * -1);
            haber1 = haber1 + (#1x * -1);
      |SIGUE;
      sw_h1 = 1;
   |FINSI;

   |SI #3#0 = "H"; |Y #3#1 = 2;
      |PARA x = eldesde; |SI x [ elhasta; |HACIENDO x = x + 3;
            #3#8   = #3#8   + (#1x * -1);
            haber2 = haber2 + (#1x * -1);
      |SIGUE;
      sw_h2 = 1;
   |FINSI;

   |SI #3#0 = "H"; |Y #3#1 = 3;
      |PARA x = eldesde; |SI x [ elhasta; |HACIENDO x = x + 3;
            #3#8   = #3#8   + (#1x * -1);
            haber3 = haber3 + (#1x * -1);
      |SIGUE;
      sw_h3 = 1;
   |FINSI;
|FPRC;

|PROCESO grabatr4; || graba cuenta de trabajo exp2
   |HAZ cargatra;
   #5#11 = 0;
   |SI #1#5 = "D";
       |PARA x = eldesde; |SI x [ elhasta; |HACIENDO x = x + 3;
             #5#11 = #5#11 + #1x;
       |SIGUE;
   |SINO;
       |PARA x = eldesde; |SI x [ elhasta; |HACIENDO x = x + 3;
             #5#11 = #5#11 + (#1x * -1);
       |SIGUE;
   |FINSI;
   |GRABA 020#5a;
   |LIBERA #5;
|FPRC;

|PROCESO CalculaTotal;
   punto_d1 = 0;   punto_h1 = 0;
   punto_d2 = 0;   punto_h2 = 0;
   punto_d3 = 0;   punto_h3 = 0;
   punto_d4 = 0;   punto_h4 = 0;
   punto_d5 = 0;   punto_h5 = 0;
   punto_d6 = 0;   punto_h6 = 0;

   canti = haber1 - debe1;
   |SI canti < 0;
       punto_h1 = - canti;
   |SINO;
       punto_d1 = canti;
   |FINSI;
   canti = haber2 - debe2;
   |SI canti < 0;
       punto_h2 = - canti;
   |SINO;
       punto_d2 = canti;
   |FINSI;
   canti = punto_d1 + punto_d2 - punto_h1 - punto_h2;
   |SI canti < 0;
       punto_h3 = - canti;
   |SINO;
       punto_d3 = canti;
   |FINSI;
   canti = haber3 - debe3;
   |SI canti < 0;
       punto_h4 = - canti;
   |SINO;
       punto_d4 = canti;
   |FINSI;

   canti = punto_d3 + punto_d4 - punto_h3 - punto_h4;
   |SI canti < 0;
       punto_h5 = - canti;
   |SINO;
       punto_d5 = canti;
   |FINSI;

   punto_h6 = punto_h5;
   |SI punto_h5 > 0;
       punto_h6 = punto_h6 + debe4;
   |FINSI;
   |SI punto_h6 < 0; punto_h6 = 0; |FINSI;

   punto_d6 = punto_d5;
   |SI punto_d6 > 0;
       punto_d6 = punto_d6 - debe4;
   |SINO;
       |SI debe4 > 0;                       || R.PRIEGO (24.03.99) impuesto neg.
           punto_d6 = punto_d6 - debe4;
       |FINSI;
   |FINSI;
   |SI punto_d6 < 0;
       |SI punto_h6 = 0;  punto_h6 = - punto_d6; |FINSI;
       punto_d6 = 0;
   |FINSI;
   punto_d1 = 0;   punto_h1 = 0;
   punto_d2 = 0;   punto_h2 = 0;
   punto_d3 = 0;   punto_h3 = 0;
   punto_d4 = 0;   punto_h4 = 0;
   punto_d5 = 0;   punto_h5 = 0;
|FPRC;
|| ------------------------------------------------------------------------
|| ----Calculos de Impresion

|PROCESO SinDebe;
    tipo ="D";
    bloque = 4;
    |HAZ mirablo;
    |PIEINF;
|FPRC;

|PROCESO SinHaber;
    tipo ="H";
    bloque = 3;
    |HAZ mirablo;
|FPRC;

|PROCESO impresio;
   |SI sw = 0;
      |SI #3#0 = "H";
          |HAZ SinDebe;
          doh = "HABER";
      |FINSI;
      |SI #3#0 = "D"; doh = "DEBE";  |FINSI;
      bloque   = #3#1;
      tipo     = #3#0;
      agrupaci = #3#2;
      epigrafe = #3#3;
      partida  = #3#4;
      sw_inf = 0;
      |PRINT;
      sw = 1;
   |FINSI;

   |SI bloque = #3#1; |Y tipo = #3#0;
      |HAZ epigraf;
   |SINO;
      |SI tipo ! #3#0;                    || ruptura por tipo
         bloque1 = bloque;
         bloque = 4;
         |HAZ mirablo;
         |PIEINF;
         sw_inf = 0;
         doh = "HABER";
         |PRINT;
         |HAZ epigraf;
         bloque = bloque1;
      |SINO;                              || ruptura por bloque
         |HAZ mirablo;
         |HAZ epigraf;
      |FINSI;
      bloque = #3#1;
      tipo = #3#0;
   |FINSI;
|FPRC;

|DEFBUCLE cabaexpl1;
   #3#1;
   ;
   "D", 1, 01, 00, 00;
   "H", 4, 99, 99, 99;
   e;
   NULL, impresio;
|FIN;

|PROCESO cuenta1;
   sw_inf = 6;
   cantidad = 0;
   cta       = #5#5;
   nom       = #5#7;
   cantidad  = #5#11;

   |SI cantidad ! 0;
       |PRINT;
   |FINSI;
|FPRC;

|DEFBUCLE cabaexpl5;
   #5#1;
   ;
   #3#0, #3#1, #3#2, #3#3, #3#4, "            ", 0;
   #3#0, #3#1, #3#2, #3#3, #3#4, "zzzzzzzzzzzz", 9;
   e;
   NULL, NULL, NULL, NULL, NULL, cuenta1;
   #5#5, #5#6;
|FIN;

|PROCESO epigraf;
   |SI epigrafe ! #3#3;
       sw_epi = 0;
   |FINSI;
   |HAZ rotura;
   epigrafe = #3#3;
|FPRC;

|PROCESO rotura;
   |SI #3#4 = 0;
      sw_inf = 2;
      |PRINT;
      |SI #0#4 = "S";
         |BUCLE cabaexpl5;
         sw_inf = 5;
         |PRINT;
      |FINSI;
   |SINO;
      |SI sw_epi = 0;
         sw_inf = 3;       || epigrafe
         |PRINT;
         sw_epi = 1;       || variables
      |FINSI;
      sw_inf = 4;           || partida
      |PRINT;
      |SI #0#4 = "S";
         |BUCLE cabaexpl5;
         sw_inf = 5;
         |PRINT;          || linea en blanco
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO final;    || Para cuando acaba el defbucle
  |SI tipo = "D";
       bloque = 4;
       |HAZ mirablo;
       |HAZ SinHaber;
  |FINSI;
  |SI tipo = "H";
       bloque = 3;
      |HAZ mirablo;
  |FINSI;
|FPRC;

|PROCESO mirablo;
   sw_inf = 1;
   |SI tipo = "D";
      |HAZ bloqued1;
      |SI bloque = 1;  |Y #3#1 [ 2;  |ACABA;  |FINSI;
      |HAZ bloqued2;
      |SI bloque [ 2;  |Y #3#1 [ 3;  |ACABA;  |FINSI;
      |HAZ bloqued3;
      |SI bloque [ 3;  |ACABA;  |FINSI;
      |HAZ bloqued4;
   |FINSI;
   |SI tipo = "H";
      |HAZ bloqueh1;
      |SI bloque = 1;  |Y #3#1 [ 2;  |ACABA;  |FINSI;
      |HAZ bloqueh2;
      |SI bloque [ 2;  |ACABA;  |FINSI;
      |HAZ bloqueh3;
   |FINSI;
|FPRC;

|PROCESO bloqued1;
   |SI sw_d1 = 1; |O sw_h1 = 1; |HAZ tipod1;  |FINSI;      || I
|FPRC;

|PROCESO bloqued2;
   |SI sw_d2 = 1; |O sw_h2 = 1; |HAZ tipod2;  |FINSI;      || II
   |SI sw_d21 = 0;              |HAZ tipod21; |FINSI;      || III
|FPRC;

|PROCESO bloqued3;
   |SI sw_d3 = 1; |O sw_h3 = 1; |HAZ tipod3;  |FINSI;      || IV
   |SI sw_d31 = 0;              |HAZ tipod31; |FINSI;      || V
|FPRC;

|PROCESO bloqued4;
   |SI sw_d4 = 0;               |HAZ tipod4;  |FINSI;      || VI
|FPRC;

|PROCESO bloqueh1;
   |SI sw_d1 = 1; |O sw_h1 = 1; |HAZ tipoh1;  |FINSI;      || I
|FPRC;

|PROCESO bloqueh2;
   |SI sw_d2 = 1; |O sw_h2 = 1; |HAZ tipoh2;  |FINSI;      || II
   |SI sw_h21 = 0;              |HAZ tipoh21; |FINSI;      || III
|FPRC;

|PROCESO bloqueh3;
   |SI sw_d3 = 1; |O sw_h3 = 1; |HAZ tipoh3;  |FINSI;      || IV
   |SI sw_h31 = 0;              |HAZ tipoh31; |FINSI;      || V
   |SI sw_h32 = 0;              |HAZ tipoh32; |FINSI;      || VI
|FPRC;

|PROCESO tipod1;
   variable = "  I. BENEFICIOS DE EXPLOTACION ..........................";
   canti  = haber11 - debe11;
   canti2 = haber1 - debe1;
   ||------------------------------------- Solo una empresa
      |SI canti < 0;
         punto_h1 = canti * -1;
         canti = 0;
      |SINO;
         sw_inf = 5; |PRINT;
         sw_inf = 1; |PRINT;
         sw_inf = 5; |PRINT;
         sw_d1 = 0;
         sw_h1 = 0;
         punto_d1 = canti;
      |FINSI;
|FPRC;

|PROCESO tipoh1;
   variable = "  I. PERDIDAS DE EXPLOTACION ............................";
   canti = debe11 - haber11;
   canti2 = debe1 - haber1;
   ||------------------------------------- Solo una empresa
      |SI canti [ 0;
         punto_d1 = canti * -1;
         canti = 0;
      |SINO;
         sw_inf = 5; |PRINT;
         sw_inf = 1; |PRINT;
         sw_inf = 5; |PRINT;
         sw_d1 = 0;
         sw_h1 = 0;
         punto_h1 = canti;
      |FINSI;
|FPRC;

|PROCESO tipod2;
   variable = " II. RESULTADOS FINANCIEROS POSITIVOS ...................";
   canti = haber21 - debe21;
   canti2 = haber2 - debe2;
   ||------------------------------------- Solo una empresa
      |SI canti < 0;
         punto_h2 = canti * -1;
         canti = 0;
      |SINO;
         sw_inf = 5; |PRINT;
         sw_inf = 1; |PRINT;
         sw_inf = 5; |PRINT;
         sw_d2 = 0;
         sw_h2 = 0;
         punto_d2 = canti;
      |FINSI;
|FPRC;

|PROCESO tipod21;
   variable = "III. BENEFICIOS DE LAS ACTIVIDADES ORDINARIAS ...........";
   canti = punto_d1 + punto_d2 - punto_h1 - punto_h2;
   canti2 = punto_d12 + punto_d22 - punto_h12 - punto_h22;
   ||------------------------------------- Solo una empresa
      |SI canti < 0;
         punto_h3 = canti * -1;
         canti = 0;
      |SINO;
         sw_inf = 5; |PRINT;
         sw_inf = 1; |PRINT;
         sw_inf = 5; |PRINT;
         sw_d21 = 1;
         punto_d3 = canti;
      |FINSI;
|FPRC;

|PROCESO tipoh2;
   variable = " II. RESULTADOS FINANCIEROS NEGATIVOS ...................";
   canti = debe21 - haber21;
   canti2 = debe2 - haber2;
   ||------------------------------------- Solo una empresa
      |SI canti [ 0;
         punto_d2 = canti * -1;
         canti = 0;
      |SINO;
         sw_inf = 5; |PRINT;
         sw_inf = 1; |PRINT;
         sw_inf = 5; |PRINT;
         sw_d2 = 0;
         sw_h2 = 0;
         punto_h2 = canti;
      |FINSI;
|FPRC;

|PROCESO tipoh21;
   variable = "III. PERDIDAS DE LAS ACTIVIDADES ORDINARIAS .............";
   canti = punto_h1 + punto_h2 - punto_d1 - punto_d2;
   canti2 = punto_h12 + punto_h22 - punto_d12 - punto_d22;
   ||------------------------------------- Solo una empresa
      |SI canti [ 0;
         punto_d3 = canti * -1;
         canti = 0;
      |SINO;
         sw_inf = 5; |PRINT;
         sw_inf = 1; |PRINT;
         sw_inf = 5; |PRINT;
         sw_h21 = 1;
         punto_h3 = canti;
      |FINSI;
|FPRC;

|PROCESO tipod3;
   variable = " IV. RESULTADOS EXTRAORDINARIOS POSITIVOS ...............";
   canti = haber31 - debe31;
   canti2 = haber3 - debe3;
   ||------------------------------------- Solo una empresa
      |SI canti < 0;
         punto_h4 = canti * -1;
         canti = 0;
      |SINO;
         sw_inf = 5; |PRINT;
         sw_inf = 1; |PRINT;
         sw_inf = 5; |PRINT;
         sw_d3 = 0;
         sw_h3 = 0;
         punto_d4 = canti;
      |FINSI;
|FPRC;

|PROCESO tipod31;
   variable = "  V. BENEFICIO ANTES DE IMPUESTOS .......................";
   canti = punto_d3 + punto_d4 - punto_h3 - punto_h4;
   canti2 = punto_d32 + punto_d42 - punto_h32 - punto_h42;
   ||------------------------------------- Solo una empresa
      |SI canti < 0;
         punto_h5 = canti * -1;
         canti = 0;
      |SINO;
         sw_inf = 5; |PRINT;
         sw_inf = 1; |PRINT;
         sw_inf = 5; |PRINT;
         sw_d31 = 1;
         punto_d5 = canti;
      |FINSI;
|FPRC;

|PROCESO tipoh3;
   variable = " IV. RESULTADOS EXTRAORDINARIOS NEGATIVOS ...............";
   canti = debe31 - haber31;
   canti2 = debe3 - haber3;
   ||------------------------------------- Solo una empresa
      |SI canti [ 0;
         punto_d5 = canti * -1;
         canti = 0;
      |SINO;
         sw_inf = 5; |PRINT;
         sw_inf = 1; |PRINT;
         sw_inf = 5; |PRINT;
         sw_d3 = 0;
         sw_h3 = 0;
         punto_h4 = canti;
      |FINSI;
|FPRC;

|PROCESO tipoh31;
   variable = "  V. PERDIDAS ANTES DE IMPUESTOS ........................";
   canti = punto_h3 + punto_h4 - punto_d3 - punto_d4;
   canti2 = punto_h32 + punto_h42 - punto_d32 - punto_d42;
   ||------------------------------------- Solo una empresa
      |SI canti [ 0;
         punto_d5 = canti * -1;
         canti = 0;
      |SINO;
         sw_inf = 5; |PRINT;
         sw_inf = 1; |PRINT;
         sw_inf = 5; |PRINT;
         sw_h31 = 1;
         punto_h5 = canti;
      |FINSI;
|FPRC;

|PROCESO tipoh32;
   variable = " VI. RESULTADO DEL EJERCICO (PERDIDAS) ..................";
   canti = punto_h61;
   canti2 = punto_h6;
   ||------------------------------------- Solo una empresa
      |SI canti > 0;
         sw_inf = 5; |PRINT;
         sw_inf = 1; |PRINT;
         sw_inf = 5; |PRINT;
         sw_h32 = 1;
      |FINSI;
|FPRC;

|PROCESO tipod4;
   variable = " VI. RESULTADO DEL EJERCICIO (BENEFICIOS) ...............";
   canti = punto_d61;
   canti2 = punto_d6;
   ||------------------------------------- Solo una empresa
      |SI canti > 0;
         sw_inf = 5; |PRINT;
         sw_inf = 1; |PRINT;
         sw_inf = 5; |PRINT;
         sw_d4 = 1;
      |FINSI;
|FPRC;

|PROCESO LeeElAuxiliar;
    |SI nLaActividad = -1;
        nLaActividad = #cacuesub#57;
        eaCodSubdep  = #cacuesub#72;
        eaSubDe0     = eaCodSubdep; |QBF eaCodSubdep;
        #900#15 = nLaActividad;
        |HAZ  LeeDatosSubdepar;
        #900#15 = enActividad;
    |FINSI;
    |SI eaCodSubdep ! #cacuesub#72;
        eaSubDe0 = "";
        #900#28 = "";
        #900#29 = "";
        #900#30 = "";
        |ERROR10;
    |FINSI;
|FPRC;

|DEFBUCLE LeeElAuxiliar;
  #cacuesub#1;
  ;
  aDActividad, "   ", "             ";
  aHActividad, "zzz", "zzzzzzzzzzzzz";
  e;
  NULL, LeeElAuxiliar;
|FIN;

|PROCESO MiroActividad;
    #900#28 = "";
    #900#29 = "";
    #900#30 = "";
    aDActividad = ("00" + enActividad) % -102;
    aHActividad = aHActividad;
    |SI enActividad = 0;
        aDActividad = "  ";
        aHActividad = "zz";
    |FINSI;
    nLaActividad = -1;
    |HAZ LeeDatosActividad;
    |SI swNoExis = 0;
        eaCodDep = ("00" + enActividad) % -102;
        |SI eaSubde ! "N";
            |BUCLE LeeElAuxiliar;
        |FINSI;
    |FINSI;
|FPRC;

|PROCESO HazTodo;

   eaIa = #canempre#21;
   enM1 = #0#0;
   enM2 = #0#1;
   |HAZ LeeDatosEmpresa;
   |SI enMAper ! dig1;
       |SI #0#1 < enMAper; |Y #0#1 ! 0;
           |ACABA;
       |FINSI;
   |FINSI;

   |SI #0#17 = "S";  |HAZ conexi;  |FINSI;

   eSwSelec  = 2;
   efDFecha  = fec1;
   efHFecha  = fec2;
   eaDDepar  = #0#16;
   eaHDepar  = #0#17;
   eaDSubde  = #0#24;
   eaHSubde  = #0#25;
   enCNivel  = 0;
   |ATRI I;
   |PINTA 2302, "Procesando Cuentas por Departamentos y Subdepartamentos. ... Espere ";
   |ATRI 0;
   |SUB_EJECUTA_NP "cacuesub";
   |PINTA 2302, "                                                                    ";
   |NOME_DAT #11 eaNomFSub;
   |PATH_DAT #11 dirfich0;

   |SI #0#31 = "S";
       enActividad = 0;
       |HAZ MiroActividad;
       |HAZ Listado;
   |SINO;
       |SI #0#15 = "S";
           |PARA nPara2 = #0#16; |SI nPara2 [ #0#17; |HACIENDO nPara2 = nPara2 + 1;
                 enActividad = nPara2;
                 |HAZ MiroActividad;
                 |SI swNoExis = 0;
                     eaCodDep = ("00" + enActividad) % -102;
                     |HAZ Listado;
                 |FINSI;
           |SIGUE;
       |SINO;
           |PARA nPara2 = 18; |SI nPara2 [ 22; |HACIENDO nPara2 = nPara2 + 1;
                 enActividad = #0nPara2;
                 |SI enActividad ! 0;
                     |HAZ MiroActividad;
                     |SI swNoExis = 0;
                         eaCodDep = ("00" + enActividad) % -102;
                         |HAZ Listado;
                     |FINSI;
                 |FINSI;
           |SIGUE;
       |FINSI;
   |FINSI;
|FPRC;

|PROCESO Listado;
   sw_d1 = 0; sw_d2 = 0;
   sw_d3 = 0; sw_d4 = 0;
   sw_h1 = 0; sw_h2 = 0;
   sw_h3 = 0;
   sw = 0;

   |DELINDEX #3;
   |DELINDEX #4;
   |DELINDEX #5;

   |ABRE #1;
   |ABRE #2;
   |ABRE #3;
   |ABRE #4;
   |ABRE #5;
   |HAZ pidepan;          || graba descarga de existencias
   |CIERRA #1;

   |BUCLE cabaexpl0;      || Bucle de Calculos - resto cuentas
   |HAZ CalculaTotal;
   |CIERRA #2;
   |CIERRA #3;
   |CIERRA #4;
   |CIERRA #5;

   || para aprovechar el calculo del balance normal
          debe11  = debe1;  debe1  = 0;
          debe21  = debe2;  debe2  = 0;
          debe31  = debe3;  debe3  = 0;
          debe41  = debe4;  debe4  = 0;
          haber11 = haber1; haber1 = 0;
          haber21 = haber2; haber2 = 0;
          haber31 = haber3; haber3 = 0;

          punto_d61 = punto_d6;  punto_d6 = 0;
          punto_h61 = punto_h6;  punto_h6 = 0;
   || ------------------------------------------------
   |ABRE #2;
   |BUCLE cabaexpl1;      || Bucle de impresion
   |HAZ final;
   |SI sw = 1; |PIEINF; |FINSI;
   |CIERRA  #2;
|FPRC;


|PROCESO impre; |TIPO 3;
   aFichero = ("3c" + Usuario) % 108;
   |NOME_DAT #3 aFichero; |DELINDEX #3;

   aFichero = ("4c" + Usuario) % 108;
   |NOME_DAT #4 aFichero; |DELINDEX #4;

   aFichero = ("5c" + Usuario) % 108;
   |NOME_DAT #5 aFichero; |DELINDEX #5;

   |IMPRE 0;
   |SI FSalida ! 0;  |ACABA;  |FINSI;
   enDatos = 0; |SI #0#14 = "S"; enDatos = 1; |FINSI;

   |INFOR informe;
   |SI FSalida ! 0;
      |MENAV "     Error en informe.";
      |FINIMP;
      |ACABA;
   |FINSI;

   eldesde = (#0#0 * 3) + 11;
   elhasta = (#0#1 * 3) + 11;

   |SI #48#27 = "S";
       |HAZ MultiEmpresa;
   |SINO;
       |DFICE dirfich0;
       |HAZ HazTodo;
   |FINSI;

   |FININF;
   |FINIMP;
   |DELINDEX #3;
   |DELINDEX #4;
   |DELINDEX #5;
|FPRC;

|PROCESO MultiEmp1;
   cod1 = #caselem1#1;
   cod2 = #caselem1#2;
   emEmp = 1;  || Sin mensaje
   |HAZ leelo;
   |SI swerror ! 0;  |ACABA;   |FINSI;

   dirfich0 = #caselem1#3;
   |QBF dirfich0;

   nYaLoHeDicho = 0;
   |PATH_DAT #1 dirfich0;
   |PATH_DAT #2 dirfich0;
   |PATH_DAT #6 dirfich0;
   |PATH_DAT #7 dirfich0;
   |PATH_DAT #8 dirfich0;
   |HAZ HazTodo;
|FPRC;

|DEFBUCLE MultiEmp0;
 #caselem1#1;
 ;
 001;
 999;
 ;
 NULL,MultiEmp1;
|FIN;

|PROCESO MultiEmpresa;
  |SUB_EJECUTA "caselemp";
  |NOME_DAT #998 eaFichsel;
  |BUCLE MultiEmp0;
  |DELINDEX #998;
|FPRC;

|PROCESO leexplot;  || Lee el fichero de explotacion
   #caparexp#0 = #3#1;
   #caparexp#1 = #3#0;
   #caparexp#2 = #3#2;
   #caparexp#4 = #3#3;
   #caparexp#6 = #3#4;
   |LEE 040#2=; |SI FSalida ! 0; |DDEFECTO #2; |FINSI;
|FPRC;
