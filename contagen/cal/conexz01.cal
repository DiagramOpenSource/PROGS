|FICHEROS;
conexz01 #0;
analiti1@#1;
analiti2@#2;
analiti3@#3;
analiti4@#4;
analiti5@#5;
analiti6@#6;
analiti7@#7;
analiti8@#8;
analiti9@#9;
analiti0@#10;
conexcel #20;
|FIN;

|VARIABLES;
aAlfa = "";

adirdef = "";
adirfich = "";
dato = "";
dato1 = "";
dato2 = "";
dato3 = "";
dato4 = "";
dato5 = "";
analitica = "";
alfa1 = "";
alfa2 = "";
alfa3 = "";
alfa4 = "";
alfa5 = "";
alfa6 = "";
alfa7 = "";
alfa8 = "";
alfa9 = "";
alfa0 = "";
nivel = "";
|FIN;

|PROCESO tipo3; |TIPO 3;
|SI FSalida = 0;
     |ABRE #20;
     #20#33 = #0#0;
     |LEE 000#20=;
     |SI FSalida = 0;
     |CARGADLL "agixl97.dll";
     |SI FSalida <  0;
          |ERROR;
          |ACABA;
     |FINSI;
    || dato = "c:\masters\prueba\obra.xls";
    dato = #20#0;
    dato1 = dato; |QBF dato;
     |ALFACALLDLL "agixl97.dll" , "carga_book" , dato;
     ||dato1 = "c:\masters\prueba\prueba1.xls";
     dato1 = #20#1; |QBF dato1;
     |ALFACALLDLL "agixl97.dll" , "fichero_destino" , dato1;
     dato2 = "";
     |ALFACALLDLL "agixl97.dll" , "selecciona_hoja" , dato2;
     |DBASS adirdef;
     alfa1 = adirdef + "contagen/def/anw00005";
     adirfich = adirdef + "contagen/fich/";
     |CARGA_DEF alfa1,analiti1@;
     |CARGA_DEF alfa1,analiti2@;
     |CARGA_DEF alfa1,analiti3@;
     |CARGA_DEF alfa1,analiti4@;
     |CARGA_DEF alfa1,analiti5@;
     |CARGA_DEF alfa1,analiti6@;
     |CARGA_DEF alfa1,analiti7@;
     |CARGA_DEF alfa1,analiti8@;
     |CARGA_DEF alfa1,analiti9@;
     |CARGA_DEF alfa1,analiti0@;
     |SI #conexcel#3 ! 0;
          alfa1 = adirfich + (("000000" + #conexcel#3 + #conexcel#4)%-106)+"/";
          |PATH_DAT #analiti1@#alfa1#;
          ||aAlfa = "y5" + Usuario; |NOME_DAT #analiti1@#aAlfa#;
          |ABRET #1;
     |FINSI;
     |SI #conexcel#6 ! 0;
          alfa1 = adirfich + (("000000" + #conexcel#6 + #conexcel#7)%-106)+"/";
          |PATH_DAT #analiti2@#alfa1#;
          ||aAlfa = "y5" + Usuario; |NOME_DAT #analiti2@#aAlfa#;
          |ABRET #analiti2@;
     |FINSI;
     |SI #conexcel#9 ! 0;
          alfa1 = adirfich + (("000000" + #conexcel#9 + #conexcel#10)%-106)+"/";
          |PATH_DAT #analiti3@#alfa1#;
          ||aAlfa = "y5" + Usuario; |NOME_DAT #analiti3@#aAlfa#;
          |ABRET #analiti3@;
     |FINSI;
     |SI #conexcel#12 ! 0;
          alfa1 = adirfich + (("000000" + #conexcel#12 + #conexcel#13)%-106)+"/";
          |PATH_DAT #analiti4@#alfa1#;
          ||aAlfa = "y5" + Usuario; |NOME_DAT #analiti4@#aAlfa#;
          |ABRET #analiti4@;
     |FINSI;
     |SI #conexcel#15 ! 0;
          alfa1 = adirfich + (("000000" + #conexcel#15 + #conexcel#16)%-106)+"/";
          |PATH_DAT #analiti5@#alfa1#;
          ||aAlfa = "y5" + Usuario; |NOME_DAT #analiti5@#aAlfa#;
          |ABRET #analiti5@;
     |FINSI;
     |SI #conexcel#18 ! 0;
          alfa1 = adirfich + (("000000" + #conexcel#18 + #conexcel#19)%-106)+"/";
          |PATH_DAT #analiti6@#alfa1#;
          ||aAlfa = "y5" + Usuario; |NOME_DAT #analiti6@#aAlfa#;
          |ABRET #analiti6@;
     |FINSI;
     |SI #conexcel#21 ! 0;
          alfa1 = adirfich + (("000000" + #conexcel#21 + #conexcel#22)%-106)+"/";
          |PATH_DAT #analiti7@#alfa1#;
          ||aAlfa = "y5" + Usuario; |NOME_DAT #analiti7@#aAlfa#;
          |ABRET #analiti7@;
     |FINSI;
     |SI #conexcel#24 ! 0;
          alfa1 = adirfich + (("000000" + #conexcel#24 + #conexcel#25)%-106)+"/";
          |PATH_DAT #analiti8@#alfa1#;
          ||aAlfa = "y5" + Usuario; |NOME_DAT #analiti8@#aAlfa#;
          |ABRET #analiti8@;
     |FINSI;
     |SI #conexcel#27 ! 0;
          alfa1 = adirfich + (("000000" + #conexcel#27 + #conexcel#28)%-106)+"/";
          |PATH_DAT #analiti9@#alfa1#;
          ||aAlfa = "y5" + Usuario; |NOME_DAT #analiti9@#aAlfa#;
          |ABRET #analiti9@;
     |FINSI;
     |SI #conexcel#30 ! 0;
          alfa1 = adirfich + (("000000" + #conexcel#30 + #conexcel#31)%-106)+"/";
          |PATH_DAT #analiti0@#alfa1#;
          ||aAlfa = "y5" + Usuario; |NOME_DAT #analiti0@#aAlfa#;
          |ABRET #analiti0@;
     |FINSI;
     |PARA;|SI;|HACIENDO;
          dato4 = "&*";
          |ALFACALLDLL "agixl97.dll","busca_dato",dato4;
          |SI dato4 = "";
               |SAL;
          |FINSI;
          dato5 = dato4 % 201;
          analitica = dato4 % 407;
          nivel = dato4 %1201;
          |SI dato5 = "1";
               #1#0 = analitica;
               #1#1 = nivel;
               |LEE 001#1=;
               |SI FSalida = 0;
                    analitica = #1#4;
               |SINO;
                    analitica = "";
               |FINSI;
               |ALFACALLDLL "agixl97.dll" , "reemplaza_dato" , analitica;
          |FINSI;
          |SI dato5 = "2";
               #2#0 = analitica;
               #2#1 = nivel;
               |LEE 001#2=;
               |SI FSalida = 0;
                    analitica = #2#4;
               |SINO;
                    analitica = "";
               |FINSI;
               |ALFACALLDLL "agixl97.dll" , "reemplaza_dato" , analitica;
          |FINSI;
          |SI dato5 = "3";
               #3#0 = analitica;
               #3#1 = nivel;
               |LEE 001#3=;
               |SI FSalida = 0;
                    analitica = #3#4;
               |SINO;
                    analitica = "";
               |FINSI;
               |ALFACALLDLL "agixl97.dll" , "reemplaza_dato" , analitica;
          |FINSI;
          |SI dato5 = "4";
               #4#0 = analitica;
               #4#1 = nivel;
               |LEE 001#4=;
               |SI FSalida = 0;
                    analitica = #4#4;
               |SINO;
                    analitica = "";
               |FINSI;
               |ALFACALLDLL "agixl97.dll" , "reemplaza_dato" , analitica;
          |FINSI;
          |SI dato5 = "5";
               #5#0 = analitica;
               #5#1 = nivel;
               |LEE 001#5=;
               |SI FSalida = 0;
                    analitica = #5#4;
               |SINO;
                    analitica = "";
               |FINSI;
               |ALFACALLDLL "agixl97.dll" , "reemplaza_dato" , analitica;
          |FINSI;
          |SI dato5 = "6";
               #6#0 = analitica;
               #6#1 = nivel;
               |LEE 001#6=;
               |SI FSalida = 0;
                    analitica = #6#4;
               |SINO;
                    analitica = "";
               |FINSI;
               |ALFACALLDLL "agixl97.dll" , "reemplaza_dato" , analitica;
          |FINSI;
          |SI dato5 = "7";
               #7#0 = analitica;
               #7#1 = nivel;
               |LEE 001#7=;
               |SI FSalida = 0;
                    analitica = #7#4;
               |SINO;
                    analitica = "";
               |FINSI;
               |ALFACALLDLL "agixl97.dll" , "reemplaza_dato" , analitica;
          |FINSI;
          |SI dato5 = "8";
               #8#0 = analitica;
               #8#1 = nivel;
               |LEE 001#8=;
               |SI FSalida = 0;
                    analitica = #8#4;
               |SINO;
                    analitica = "";
               |FINSI;
               |ALFACALLDLL "agixl97.dll" , "reemplaza_dato" , analitica;
          |FINSI;
          |SI dato5 = "9";
               #9#0 = analitica;
               #9#1 = nivel;
               |LEE 001#9=;
               |SI FSalida = 0;
                    analitica = #9#4;
               |SINO;
                    analitica = "";
               |FINSI;
               |ALFACALLDLL "agixl97.dll" , "reemplaza_dato" , analitica;
          |FINSI;
          |SI dato5 = "0";
               #10#0 = analitica;
               #10#1 = nivel;
               |LEE 001#10=;
               |SI FSalida = 0;
                    analitica = #10#4;
               |SINO;
                    analitica = "";
               |FINSI;
               |ALFACALLDLL "agixl97.dll" , "reemplaza_dato" , analitica;
          |FINSI;
     |SIGUE;
     |SI #20#2 = "N";
          alfa4 = "";
     |SINO;
          alfa4 = "imprime";
     |FINSI;
     |ALFACALLDLL "agixl97.dll" , "fin_book" , alfa4;
     |DESCARGADLL "agixl97.dll";
     |FINSI;
     |LIBERA #20;
     |CIERRA #20;
     |CIERRAT #1;
     |CIERRAT #2;
     |CIERRAT #3;
     |CIERRAT #4;
     |CIERRAT #5;
     |CIERRAT #6;
     |CIERRAT #7;
     |CIERRAT #8;
     |CIERRAT #9;
     |CIERRAT #10;

     |DESCARGA_DEF #analiti0@;
     |DESCARGA_DEF #analiti9@;
     |DESCARGA_DEF #analiti8@;
     |DESCARGA_DEF #analiti7@;
     |DESCARGA_DEF #analiti6@;
     |DESCARGA_DEF #analiti5@;
     |DESCARGA_DEF #analiti4@;
     |DESCARGA_DEF #analiti3@;
     |DESCARGA_DEF #analiti2@;
     |DESCARGA_DEF #analiti1@;
|FINSI;

|FPRC;

|PROGRAMA;
   |SI PARAMETRO ! "";
      #0#0 = PARAMETRO; FSalida = 0; |HAZ tipo3;
   |SINO;
      |MANTE #conexz01;
   |FINSI;
|FPRO;
