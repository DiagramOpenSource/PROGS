|FICHEROS;
  capcew01 #0;
  cacuenta #1;
  capcem03 #3;

  ca8cumay #410;
  ca8m0002 #422;
  cacuent@ #999;
|FIN;

|VARIABLES;
  &entrada   = 1;
  &eSwSelec  = 0;
  &eaNFChile = "";  ||Nombre del Fichero Creado

  nEstado    = 0;
  nNumero    = 0;
  aAlfa      = "";
  nPara1     = 0;
  aMas       = "";
  nError     = 0;
  aNueva     = "";
  aNuev1     = "";
  aCuenta    = "";
  nNivel     = 0;
|FIN;

|INCLUYE  dscont_i;

|| =======================================================================
|PROCESO MiraCuenta;

  nNumero = 1;
  |SI eSwSelec ! 2;
      #0#62 = aNueva;
      #0#64 = 9;
      |LEE 041#0];
      |SI FSalida = 0;
         |LEE 041#0a;
      |SINO;
         |LEE 041#0u;
      |FINSI;
      |SI FSalida = 0; |Y #0#62 = aNueva;
          nNumero = #0#64 + 1;
      |FINSI;
  |FINSI;

  #999#0 = aCuenta;
  |LEE 001#999=;
  |SI FSalida ! 0;
      |DDEFECTO #999;
      eaCuenta = #1#0;
      |HAZ eLeeCtaMayor;
      #999#2 = #1#2;
      |SI eaNomCtaSup ! "";
          #999#2 = eaNomCtaSup;
      |FINSI;
  |FINSI;

  #0#2  = #999#2;
  #0#3  = "S";
  #0#4  = #1#4;
  #0#5  = #1#5;
  #0#6  = #1#6;
  #0#7  = #1#7;
  #0#8  = #1#8;

  aAlfa = #0#62; |QBF aAlfa;
  #0#54 = aAlfa + "zzzzzzzzzzzz";
  #0#55 = nNivel;
|FPRC;

|PROCESO LeeNueva;

   aNueva = "";
   aNuev1 = "";

   |DDEFECTO #3;
   #3#0 = aCuenta;
   |LEE 041#3=;
   |SI FSalida ! 0;
       |PARA nPara1 = 9; |SI nPara1 [ 53; |HACIENDO nPara1 = nPara1 + 1;
             |SI #1nPara1 ! 0;
                 nError = 1;
             |FINSI;
       |SIGUE;
   |FINSI;
   aNueva = #3#2;
   aNuev1 = #3#3;
|FPRC;
|| ========================================================================

|PROCESO Acumular;
 aAlfa     = #1#0; |QBF aAlfa;
 |SI aAlfa = ""; |ACABA; |FINSI;

 aCuenta = #1#0 % 104;
 |HAZ LeeNueva;
 |SI aNueva = "    "; |ACABA; |FINSI;

 |SI eSwSelec = 2;
     |SELECT #1#0;
     #0#62 = aNueva;
     #0#64 = 1;
     |LEE 141#0=;
     nEstado = FSalida;
 |SINO;
     |SELECT #2#0;
     #0#0  = aCuenta;
     #0#62 = aNueva;
     |LEE 141#0=;
     nEstado = FSalida;
     |SELECT #1#0;
 |FINSI;

 |SI nEstado = 0;
     nNumero = #0#64;
     |SI eSwSelec ! 2;
         |LIBERA #0;
         #0#62 = aNueva;
         #0#64 = nNumero;
         |LEE 141#0=;
     |FINSI;
 |SINO;
     |LIBERA #0;
     |DDEFECTO #0;
     |HAZ MiraCuenta;
     #0#0  = aCuenta;
     #0#1  = nNivel;
     #0#3  = "S";
     #0#62 = aNueva;
     #0#63 = aNuev1;
     #0#64 = nNumero;
     |GRABA 020#0b;
 |FINSI;


 |SI #1#56 > #0#56;  #0#56 = #1#56; |FINSI;   ||Fecha Ultima Operacion

|| .... La Suma

  |PARA nPara1 = 9; |SI nPara1 [ 53; |HACIENDO nPara1 = nPara1 + 1;
        #0nPara1 = #0nPara1 + #1nPara1;
  |SIGUE;

  |GRABA 020#0a;
  |LIBERA #0;
|FPRC;

|DEFBUCLE LeeCuentas;
  #1#1;
  3;
  "            ", "S";
  "zzzzzzzzzzzz", "S";
  e;
  NULL, Acumular;
|FIN;


|PROCESO ClaveAlta;
  #0#62 = "    ";
  #0#64 = 0;
|FPRC;

|PROCESO ClaveBaja;
  #0#62 = "9999";
  #0#64 = 9;
|FPRC;

|PROGRAMA;

  |DBASE aBase; |QBF aBase;
  aMas = aBase + "def/cacuenta";
  |CARGA_DEF aMas, cacuent@;
  |SI FSalida ! 0;
      |MENAV "0000Error al cargar el Def cacuenta";
      |ACABA;
  |FINSI;

  |SI eSwSelec = 2;
      |PATH_DAT #0 dirfich0;
      |PATH_DAT #1 dirfich0;
      |PATH_DAT #999 dirfich0;
  |SINO;
      |HAZ inicio;
  |FINSI;

  nNivel = 4;
  |SI dig4 = 4; nNivel = 1; |FINSI;
  |SI dig5 = 4; nNivel = 2; |FINSI;
  |SI dig6 = 4; nNivel = 3; |FINSI;
  |SI dig7 = 4; nNivel = 4; |FINSI;
  |SI dig8 = 4; nNivel = 5; |FINSI;
  |SI dig9 = 4; nNivel = 6; |FINSI;

  nError = 0;
  eaNFChile = ("zch" + Usuario) % 108;
  |NOME_DAT #0 eaNFChile;
  |DELINDEX #0;

  |ABRE #999;
  |ABRE #0;
  |ABRE #3;
  |BUCLE LeeCuentas;
  |CIERRA #3;
  |CIERRA #0;
  |CIERRA #999;

  |SI nError ! 0;
      |MENAV "    Error. Existe Cuentas Contables sin Conversion";
      |MENAV "    Seran Omitidas en el informe";
  |FINSI;

  |SI eSwSelec = 0;
      |ENTLINEAL #1#0, -1, 4, 22, 1, ClaveAlta,ClaveBaja;
  |FINSI;

  |DESCARGA_DEF #cacuent@;
|FPRO;
