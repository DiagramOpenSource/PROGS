|FICHEROS;
    caybal00 #0;       || Informe suma y saldos Analitica

    cacuenta #1;
    caconimp #8;
    camaasil #10;
    calicont #31;  ||nuevo
    camaasic #32;  ||nuevos 32 31

    caw00024 #906;         || trabajo Cuentas

    canempre #30;
    caselem1 #998;
    cawdatos #900;
|FIN;

|VARIABLES;
  &entrada = 1;
  &pagina = 0;
  sw_pagina = 0;

  mensa1 = "    ERROR ESTA FECHA NO CORRESPONDE AL EJERCICIO";
  mensa2 = "    FECHA ERRONEA !!!";

  error1 = "0000Nivel repetido";

  aTCuenta = "";
  aTContra = "";

  informe = "";
  alfa1  = "";
  alfa2  = "";
  alfa3  = "";
  nume1  = 0;
  nume2  = 0;
  para1  = 0;
  desfec = @;
  hasfec = @;
  incta  = "";
  ficta  = "";

  nivel    = 0;
  nrot = 0;
  nr1 = 0;
  nr2 = 0;
  nr3 = 0;
  nr4 = 0;
  nr5 = 0;
  nr6 = 0;

  ctanueva = "";
  ctaana   = "";
  digana   = 0;
  idig     = 0;
  nSwOp    = 0;
  swalgun  = 0;
  debe     = 0;
  haber    = 0;
  anacta   = "";
  sw       = 0;
  sw_con   = 0;

  &icta = "";
  &idesc = "";
  &idebe = 0;
  &ihaber = 0;
  &isaldo = 0;
  &ideudor = 0;
  &iacreedor = 0;
  &xdeudor = 0;
  &xacreedor = 0;
  &tdebe = 0;
  &thaber = 0;
  &tsaldo = 0;
  &tdeudor = 0;
  &tacreedor = 0;
  &swlinea = 0;
  &swcomen = 0;
  &swtipo = 0;
  &swesplin = 0;

  {-1}form  = "";           || Variables menu impresora o pantalla
  form1 = "2400";
  form2 = "1";
  form3 = "Elija formato: ";
  form4 = "12";
  form5 = " < 1 > ";
  form6 = " < 2 > ";
  op_form = 0;
  opanterior = 0;

  nSw        = 0;
  aContra    = "";
  nSwContra  = 0;
  aDCuenta   = "";
  aHCuenta   = "";
  antnivel   = 0;
  aFichero   = "";
  nmensa     = 0;
|FIN;

|INCLUYE dscont_i;
|INCLUYE digito_i;

|| ***********************************************************************
||                       CALCULOS DE PANTALLA
|| ***********************************************************************
|PROCESO DatosEmp;
 |ABRE #8;
 |DDEFECTO #8;
 #8#0 = 1;
 |LEE 011#8=;
 |CIERRA #8;
 #0#39 = #8#7;
 alfa1 = #8#8;
 |C_M #0#39,1,alfa1;
|FPRC;

|CALCULO fecha; |TIPO 0;
  |SI #0Campo < fec1; |O #0Campo > fec2;
      |MENAV mensa1;
      |ERROR;
      |ACABA;
  |FINSI;
  |SI Campo = 1;
      |SI #0#0 > #0#1;
          |MENAV mensa2;
          |ERROR;
      |FINSI;
  |FINSI;
|FCAL;

|PROCESO numnivel;|TIPO 0;
   nume1 = dig3 - 1;
   |SI #0#4 > nume1;
      |MENAV "    El numero de nivel no coincide con el numero de nivel de la empresa";
      |ERROR;
   |FINSI;
|FPRC;

|PROCESO nivel;|TIPO 7;  || Calculo para hacer no modificable
   |C_M #0Campo, 1,"S";
   |SI Campo = 5; |Y #0#4 < 1; || Si solo hemos seleccionado
      #0Campo = 0; |PINTA #0Campo;
      |C_M #0Campo, 1,"N";
   |FINSI;
   |SI Campo = 6; |Y #0#4 < 2; || Si solo hemos seleccionado
      #0Campo = 0; |PINTA #0Campo;
      |C_M #0Campo, 1,"N";
   |FINSI;
   |SI Campo = 7; |Y #0#4 < 3; || Si solo hemos seleccionado
      #0Campo = 0; |PINTA #0Campo;
      |C_M #0Campo, 1,"N";
   |FINSI;
   |SI Campo = 8; |Y #0#4 < 4; || Si solo hemos seleccionado
      #0Campo = 0; |PINTA #0Campo;
      |C_M #0Campo, 1,"N";
   |FINSI;
   |SI Campo = 9; |Y #0#4 < 5; || Si solo hemos seleccionado
      #0Campo = 0; |PINTA #0Campo;
      |C_M #0Campo, 1,"N";
   |FINSI;
   |SI Campo = 10; |Y #0#4 < 6; || Si solo hemos seleccionado
      #0Campo = 0; |PINTA #0Campo;
      |C_M #0Campo, 1,"N";
   |FINSI;
|FPRC;

|PROCESO nivelrep;|TIPO 0;  || Para comprobar que no repetimos los niveles

   nume1 = dig3 - 1;
   |SI #0Campo > nume1;
       |MENAV "    Nivel Erroneo";
       |ERROR;
       |ACABA;
   |FINSI;

   |SI nivel = 0;        || Buscamo el nivel mas alto;
       nivel = #0#5;
   |FINSI;

   |SI Campo = 6;
      |SI #0#6 = #0#5;|Y #0#6 ! 0;    || Si hay dos niveles iguales error
         |MENAV error1;
         |ERROR;  |ACABA;
      |SINO;
         |SI #0#6 > #0#5;  || Busca el nivel mas alto
            nivel = #0#6;
         |SINO;
            nivel = #0#5;
         |FINSI;
      |FINSI;
   |FINSI;

   |SI Campo = 7; |Y #0#7 ! 0;
      |SI #0#7 = #0#5; |O #0#7 = #0#6; || Si hay dos niveles iguales error
         |MENAV error1;
         |ERROR;  |ACABA;
      |FINSI;
      |SI #0#7 > nivel;  || Busca el nivel mas alto
         nivel = #0#7;
      |FINSI;
   |FINSI;

   |SI Campo = 8; |Y #0#8 ! 0;      || Si hay dos niveles iguales error
      |SI #0#8 = #0#5; |O #0#8 = #0#6; |O #0#8 = #0#7;
         |MENAV error1;
         |ERROR; |ACABA;
      |FINSI;
      |SI #0#8 > nivel;  || Busca el nivel mas alto
         nivel = #0#8;
      |FINSI;
   |FINSI;

   |SI Campo = 9; |Y #0#9 ! 0;     || Si hay dos niveles iguales error
      |SI #0#9 = #0#5; |O #0#9 = #0#6; |O #0#9 = #0#7; |O #0#9 = #0#8;
         |MENAV error1;
         |ERROR; |ACABA;
      |FINSI;
      |SI #0#9 > nivel;  || Busca el nivel mas alto
         nivel = #0#9;
      |FINSI;
   |FINSI;

   |SI Campo = 10; |Y #0#10 ! 0;    || Si hay dos niveles iguales error
      |SI #0#10 = #0#5; |O #0#10 = #0#6; |O #0#10 = #0#7; |O #0#10 = #0#8; |O #0#10 = #0#9;
         |MENAV error1;
         |ERROR;  |ACABA;
      |FINSI;
      |SI #0#10 > nivel;  || Busca el nivel mas alto
         nivel = #0#10;
      |FINSI;
   |FINSI;
|FPRC;

|CALCULO h_concepto;
 |SI #0#17 > #0#18;
     |MENAV "    ERROR EN SELECCION DE CONCEPTOS";
     |ERROR;
 |FINSI;
|FCAL;

|CALCULO nomodi; |TIPO 0;
 |C_M #0Campo,0,alfa1;
 |SI alfa1 = "N"; |ACABA; |FINSI;
 |SI #0Campo = 0; alfa2 = "N"; |FINSI;
 |SI #0Campo ! 0; alfa2 = "S"; |FINSI;

 |PARA nume1 = Campo + 1;  |SI nume1 [ 28;  |HACIENDO nume1 = nume1 + 1;
       #0nume1 = 0;
       |C_M #0nume1, 1, alfa2;
 |SIGUE;
|FCAL;

|CALCULO seleccio_c; |TIPO 0;
 |SI #0#16 = "N";
     |PARA nume1 = 19; |SI nume1 [ 28; |HACIENDO nume1 = nume1 + 1;
           |C_M #0nume1,1,"S";
     |SIGUE;
     |C_M #0#17, 1, "N";
     |C_M #0#18, 1, "N";
     #0#17 = 1;       |PINTA #0#17;
     #0#18 = 999;     |PINTA #0#18;
 |SINO;
     |PARA nume1 = 19; |SI nume1 [ 28; |HACIENDO nume1 = nume1 + 1;
           |C_M #0nume1,1,"N";
           #0nume1 = 0; |PINTA #0nume1;
     |SIGUE;
     |C_M #0#17, 1, "S";
     |C_M #0#18, 1, "S";
 |FINSI;
|FCAL;

|PROCESO seleccio2; |TIPO 0;
   alfa1 = "N"; alfa2 = "S";
   |SI #0#46 = "S";
       alfa1 = "S";
       alfa2 = "N";
   |FINSI;
   |C_M #0#47,1, alfa1; |C_M #0#48,1, alfa1;
   |C_M #0#49,1, alfa2; |C_M #0#50,1, alfa2;
   |C_M #0#51,1, alfa2; |C_M #0#52,1, alfa2;
   |C_M #0#53,1, alfa2; |C_M #0#54,1, alfa2;
   |C_M #0#55,1, alfa2; |C_M #0#56,1, alfa2;
   |C_M #0#57,1, alfa2; |C_M #0#58,1, alfa2;

   |SI #0#46 = "N";
       #0#47 = "            "; |PINTA #0#47;
       #0#48 = "            "; |PINTA #0#48;
   |SINO;
       #0#49 = ""; |PINTA #0#49;
       #0#50 = ""; |PINTA #0#50;
       #0#51 = ""; |PINTA #0#51;
       #0#52 = ""; |PINTA #0#52;
       #0#53 = ""; |PINTA #0#53;
       #0#54 = ""; |PINTA #0#54;
       #0#55 = ""; |PINTA #0#55;
       #0#56 = ""; |PINTA #0#56;
       #0#57 = ""; |PINTA #0#57;
       #0#58 = ""; |PINTA #0#58;
   |FINSI;
|FPRC;

|PROCESO cuenta; |TIPO 6;
   |C_M #0Campo, 0, alfa1;
   |SI alfa1 = "N"; |ACABA; |FINSI;

   eaCuenta = #0Campo;
   salidas  = FSalida;
   |HAZ FiltraPuntos;
   #0Campo = eaCuenta; |PINTA #0Campo;
   |SI #0Campo = "            "; |ACABA; |FINSI;
   |HAZ SacaNivel;
|FPRC;

|| **********************************************************************
||                       CALCULOS DE IMPRESION
|| **********************************************************************
|PROCESO &c_pagina;
  |SI sw_pagina = 0;
      pagina = #0#12;
      sw_pagina = 1;
  |SINO;
      pagina = pagina + 1;
  |FINSI;
|FPRC;
|| ------------------------------------------------

|PROCESO LeeTitulos;
 |DDEFECTO #1;
 #1#0 = #906#0;
 |LEE 000#1=;
 aTCuenta =  #1#2;
|FPRC;

|PROCESO creamayor;
    |SI digana = 1;  nume1 = dig4;  |FINSI;
    |SI digana = 2;  nume1 = dig5;  |FINSI;
    |SI digana = 3;  nume1 = dig6;  |FINSI;
    |SI digana = 4;  nume1 = dig7;  |FINSI;
    |SI digana = 5;  nume1 = dig8;  |FINSI;
    |SI digana = 6;  nume1 = dig9;  |FINSI;
    nume1 = 100 + nume1;
    alfa1 = ctaana % nume1;
    alfa2 = ctaana % nume1;
    alfa1 = alfa1 + "            ";
    alfa2 = alfa2 + "zzzzzzzzzzzz";
    ctaana = alfa1 % 112;
    anacta = alfa2 % 112;
|FPRC;

|PROCESO graba2;

 |SI ctaana = ctanueva;
     |ACABA;
 |FINSI;
 #906#0  = ctaana;
 #906#1  = digana;
 #906#24 = aContra;
 |LEE 101#906=;
 |SI FSalida ! 0;
     |DDEFECTO #906;
     #906#0 = ctaana;
     #906#1 = digana;
     #906#8 = anacta;
     #906#9 = digana;
     #906#24 = aContra;
     |HAZ LeeTitulos;
     #906#26 = aTCuenta;
     |GRABA 020#906c;
 |FINSI;
 #906#2 = #906#2 + debe;
 #906#3 = #906#3 + haber;
 #906#4 = #906#2 - #906#3;
 #906#10 = "M";
 |GRABA 020#906a;
 |LIBERA #906;
|FPRC;

|| ------------------------------------------------------------------------

|CALCULO concepto; || Para seleccionar el concepto de apuntes
  sw_con = 0;
  |PARA nume2 = 19; |SI nume2 [ 28; |HACIENDO nume2 = nume2 + 1;
        |SI #0nume2  = #10#6;
            sw_con = 1;
            |SAL;
        |FINSI;
  |SIGUE;
|FCAL;

|PROCESO leoContra;
   aContra   = doce;
   nSwContra = 0;
   |DDEFECTO #31;
   #31#0 = #10#0;
   #31#1 = #10#1;
   #31#2 = #10#2;
   #31#3 = #10#3;
   |LEE 001#31=;
   |SI FSalida = 0;
        aContra = #31#4;
   |FINSI;

   |SI aContra = doce;
       |DDEFECTO #32;
       #32#0 = #10#0;
       #32#1 = #10#1;
       #32#2 = #10#2;
       |LEE 040#32=;
       |SI #10#8 = "D";
           aContra = #32#10;
       |SINO;
           aContra = #32#8;
       |FINSI;
   |FINSI;

   nSwContra = 1;
   |SI aContra = doce; |ACABA; |FINSI;

   |SI #0#46 = "S";
       |SI aContra ] #0#47; |Y aContra [ #0#48;
           nSwContra = 0;
       |FINSI;
   |SINO;
       |PARA nume1 = 49; |SI nume1 [ 58; |HACIENDO nume1 = nume1 + 1;
             |SI #0nume1 = aContra;
                 nSwContra = 0;
                 |SAL;
             |FINSI;
       |SIGUE;
   |FINSI;
|FPRC;

|PROCESO ver_apunte;
 sw_con = 1;
 |SI #0#16 = "N"; |HAZ concepto; |FINSI;
 |SI sw_con = 0; |ACABA; |FINSI;

 |HAZ leoContra;
 |SI nSwContra = 1; |ACABA; |FINSI;  ||no esta seleccionado

 #1#0     = #10#4;
 |HAZ digitos2;
 |SI d_error ! 0;  |ACABA;  |FINSI;

 |ATRI R; |PINTA 2340, #10#1; |ATRI 0;

 |SI #10#9 = 0; |ACABA; |FINSI;
 |SI #10#8 = "H";
     debe = #10#9;
     haber = 0;
 |SINO;
     debe = 0;
     haber = #10#9;
 |FINSI;

 eaCuenta = #10#4; |HAZ SacaNivel;
 ctanueva = #10#4;

 #906#0  = ctanueva;
 #906#1  = enNivel;
 #906#24 = aContra;
 |LEE 101#906=;
 |SI FSalida ! 0;
     |DDEFECTO #906;
     #906#0 = ctanueva;
     #906#1 = enNivel;
     #906#8 = #906#0;
     #906#9 = #906#1;
     #906#24 = aContra;
     |HAZ LeeTitulos;
     #906#26 = aTCuenta;
     |GRABA 020#906c;
 |FINSI;

 #906#2 = #906#2 + debe;
 #906#3 = #906#3 + haber;
 #906#4 = #906#2 - #906#3;
 #906#10 = "C";
 |GRABA 020#906a;
 |LIBERA #906;
 swalgun = 1;
 || ... Graba Auxiliar de Cuentas.

 |SI nrot = 0; |ACABA; |FINSI;

 |SI nr1 ! 0;
     digana = nr1;
     ctaana = ctanueva;
     |HAZ creamayor;
     |HAZ graba2;
 |FINSI;

 |SI nr2 ! 0;
     digana = nr2;
     ctaana = ctanueva;
     |HAZ creamayor;
     |HAZ graba2;
 |FINSI;

 |SI nr3 ! 0;
     digana = nr3;
     ctaana = ctanueva;
     |HAZ creamayor;
     |HAZ graba2;
 |FINSI;

 |SI nr4 ! 0;
     digana = nr4;
     ctaana = ctanueva;
     |HAZ creamayor;
     |HAZ graba2;
 |FINSI;

 |SI nr5 ! 0;
     digana = nr5;
     ctaana = ctanueva;
     |HAZ creamayor;
     |HAZ graba2;
 |FINSI;
|FPRC;

|DEFBUCLE cargatra;
 #10#1;
 4,6;
 00, desfec, 000001, 0001, #0#2, #0#17;
 99, hasfec, 999999, 9999, #0#3, #0#18;
 e;
 NULL, ver_apunte;
|FIN;


|| *************************************
|PROCESO elprintcta;
 |SI nSwOp  = 0;
     sw = 1;
     |ERROR10;
     |ACABA;
 |FINSI;

 swesplin = 0;
 |SI sw = 0;
     sw = 1;
     antnivel = #906#1;
 |SINO;
     |SI #906#10 = "C";
         |SI #0#40 = "S"; |O #0#44 = "S";
             swesplin = 1;
         |FINSI;
     |FINSI;
 |FINSI;

 icta = #906#0;
 idig = #906#1;
 idesc = #906#26;
 idebe  = #906#2;
 ihaber = #906#3;
 isaldo = #906#4;
 ideudor   = 0;
 iacreedor = 0;
 |SI isaldo ] 0;
     ideudor = isaldo;
 |SINO;
     iacreedor = - isaldo;
 |FINSI;
 swlinea = 0;
 |SI nrot ! 0;
     |SI #906#1 ! antnivel;
         |SI #906#1 < antnivel;
             swlinea = 1;
         |FINSI;
         antnivel = #906#1;
     |FINSI;
 |FINSI;
||  |SI nrot = 0; |HAZ artenvas; |FINSI;

 swtipo = 0;
 |SI #906#10 = "C";  swtipo = 1; |FINSI;
 |SI #906#10 ! "C"; |Y #906#1 = nr6;  swtipo = 2; |FINSI;
 |PRINT;
 swcomen = 1;
 |SI #906#10 = "C";
      tdebe = tdebe + idebe;
      thaber = thaber + ihaber;
      tsaldo = tsaldo + isaldo;
      tdeudor = tdeudor + ideudor;
      tacreedor = tacreedor + iacreedor;
 |FINSI;
|FPRC;


|PROCESO finimpr;
 |SI sw = 1;
     |PIEINF;
 |FINSI;
 sw_pagina = 0;
 tdebe     = 0;
 thaber    = 0;
 tsaldo    = 0;
 tacreedor = 0;
 tdeudor   = 0;
 sw        = 0;
 swcomen   = 0;
|FPRC;

|DEFBUCLE imprctamy;
 #906#3;
 ;
 aContra, "            ";
 aContra, "zzzzzzzzzzzz";
 ;
 NULL, elprintcta;
|FIN;

|PROCESO Paraimprimir;
 aContra = #1#0;
 nSwOp = 0;
 sw    = 0;
 |BUCLE imprctamy;
 |SI sw = 1;
     sw    = 0;
     nSwOp = 1;
     |BUCLE imprctamy;
     |HAZ finimpr;
 |FINSI;
|FPRC;

|DEFBUCLE PorContra;
 #1#1;
 3;
 aDCuenta, "S";
 aHCuenta, "S";
 e;
 NULL, Paraimprimir;
|FIN;

|| *************************************************************************
|| ****************** COMIENZO CON TIPO 3 **********************************
|| *************************************************************************
|PROCESO relleno;
   nrot = #0#4;
    nr1 = #0#5;
    nr2 = #0#6;
    nr3 = #0#7;
    nr4 = #0#8;
    nr5 = #0#9;
  |SI nrot ! 0;
      nr6 = dig3;
      |SI nr1 ! 0; nr6 = nr1; |FINSI;
      |SI nr6 > nr2; |Y nr2 ! 0; nr6 = nr2; |FINSI;
      |SI nr6 > nr3; |Y nr3 ! 0; nr6 = nr3; |FINSI;
      |SI nr6 > nr4; |Y nr4 ! 0; nr6 = nr4; |FINSI;
      |SI nr6 > nr5; |Y nr5 ! 0; nr6 = nr4; |FINSI;
  |FINSI;
|FPRC;

|PROCESO HazTodo;

|| .... Crear los ficheros auxiliares
 |PINTA 2321, "                              ";
 |HAZ relleno;

 enDatos = 0;
 |SI #0#39 = "S";
     eaIa = #30#21; enDatos = 1;
     alfa1 = #0#0; alfa1 = alfa1 % 402; enM1 = alfa1;
     alfa1 = #0#1; alfa1 = alfa1 % 402; enM2 = alfa1;
     |HAZ LeeDatosEmpresa;
 |SINO;
     |HAZ FecApeCie;
 |FINSI;

 swalgun = 0;
 |ABRE #906;

 |ATRI R;
 |PINTA 2321, " Grabando temporal            ";
 |ATRI 0;

 |ABRE #1;
 |ABRE #31;
 |ABRE #32;
 |BUCLE cargatra;
 |CIERRA #32;
 |CIERRA #31;
 |CIERRA #1;

 |CIERRA #906;

 |SI swalgun = 0;
     |SI nmensa = 0; |MENAV "    Seleccion Vacia ..."; |FINSI;
 |SINO;
      |PINTA 2321, "                              ";

      |PINTA 2321, " Imprimiendo ...              ";

      |SI #0#46 = "S";
          aDCuenta = #0#47;
          aHCuenta = #0#48;
          |BUCLE PorContra;
      |SINO;
          |PARA nume1 = 49; |SI nume1 [ 58; |HACIENDO nume1 = nume1 + 1;
                |SI #0nume1 ! doce;
                    aDCuenta = #0nume1;
                    aHCuenta = #0nume1;
                    |BUCLE PorContra;
                |FINSI;
          |SIGUE;
      |FINSI;
 |FINSI;

 |DELINDEX #906;
|FPRC;

|CALCULO tipo3; |TIPO 3;

 aFichero = ("9y" + Usuario) % 108;
 |NOME_DAT #906 aFichero;
 |DELINDEX #906;

 informe = "caybal00";

 |IMPRE 0;
 |SI FSalida ! 0; |ACABA; |FINSI;

 |INFOR informe;
 |SI FSalida ! 0;
     |MENAV "    No existe Informe";
     |FINIMP;
     |ACABA;
 |FINSI;

 desfec = #0#0;
 hasfec = #0#1;
  incta = #0#2;
  ficta = #0#3;

 |SI #48#27 = "S";
     nmensa = 1;
     |HAZ MultiEmpresa;
 |SINO;
     nmensa = 0;
     |DFICE dirfich0;
     |HAZ HazTodo;
 |FINSI;

 |FININF;
 |FINIMP;
|FCAL;

|PROCESO MultiEmp1;
   cod1 = #caselem1#1;
   cod2 = #caselem1#2;
   emEmp = 1;  || Sin mensaje
   |HAZ leelo;
   |SI swerror ! 0;  |ACABA;   |FINSI;

   dirfich0 = #caselem1#3;
   |QBF dirfich0;

   nYaLoHeDicho = 0;
   |PATH_DAT #1 dirfich0;
   |PATH_DAT #10 dirfich0;
   |PATH_DAT #31 dirfich0;
   |PATH_DAT #32 dirfich0;
   |HAZ HazTodo;
|FPRC;

|DEFBUCLE MultiEmp0;
 #caselem1#1;
 ;
 001;
 999;
 ;
 NULL,MultiEmp1;
|FIN;

|PROCESO MultiEmpresa;
  |SUB_EJECUTA "caselemp";
  |NOME_DAT #998 eaFichsel;
  |BUCLE MultiEmp0;
  |DELINDEX #998;
|FPRC;

|PROGRAMA;

  |HAZ inicial;
  |SI swerror = 2; |ACABA; |FINSI;
  |SI swerror = 3; |PTEC 831; |ACABA; |FINSI;

  |CLS;
  |CABEZA "Balance Sumas y Saldos por Contrapartidas";

  |ABRE #0;
  |LEE 001#0p;
  |SI FSalida ! 0;
      |DDEFECTO #0;

      #0#0 = fec1;
      #0#1 = fec2;
      |GRABA 020#0c;
  |FINSI;
  |HAZ DatosEmp;

  |PINPA #0#0;
  |PINDA #0#0;                    || Pinta los datos por defecto
  |ENDATOS #1#0;                  || Seleccion informe
  |SI FSalida = 0;
      |GRABA 020#0a;
  |FINSI;
  |CIERRA #0;
|FPRO;
