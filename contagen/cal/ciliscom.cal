|FICHEROS;
   ciliscom #0;
   cientasc #1;
   cientasl #2;
   cientcon #3;
   cisalant #4;
   caivaasi #200;
|FIN;

|VARIABLES;
   &entrada = 1;
   informe = "ciliscom";

   men2   = "    Longitud de Cuenta Fuera de Nivel ";
   digito = 0;
   cta_t  = 0;
   cta    = "";
   long   = "";
   nume1  = 0;
   swdig  = 0;

   lacontra = "";

   &swprim  = 0;
   &inisal  = 0;
   &inifec  = @;
   &swlinea = 0;
   &a_debe  = 0;
   &a_haber = 0;
   &t_debe  = 0;
   &t_haber = 0;
   total   = 0;
   &texto   = "";
   swalgun = 0;
   &eaTexto = "";
|FIN;

|INCLUYE dscont_i;

|| *******************************************************************
|| **************** Campos Pantalla **********************************
|| *******************************************************************

|PROCESO cuenta; |TIPO 6;
   |SI FSalida = 2; |ACABA; |FINSI;

     eaCuenta = #ciliscom#Campo#;
     salidas  = FSalida;
     |HAZ FiltraPuntos;
     #ciliscom#Campo# = eaCuenta;
     |PINTA #ciliscom#Campo#;

   |SI #ciliscom#Campo# = "            ";  |ACABA;  |FINSI;
   digito = Campo + 1;
   cta  = #ciliscom#Campo#; |QBF cta;
   long = cta % 0; nume1 = long;
   swdig = 0;
   |SI nume1 = dig4; swdig = 1; #ciliscom#digito# = 1; |FINSI;
   |SI nume1 = dig5; swdig = 1; #ciliscom#digito# = 2; |FINSI;
   |SI nume1 = dig6; swdig = 1; #ciliscom#digito# = 3; |FINSI;
   |SI nume1 = dig7; swdig = 1; #ciliscom#digito# = 4; |FINSI;
   |SI nume1 = dig8; swdig = 1; #ciliscom#digito# = 5; |FINSI;
   |SI nume1 = dig9; swdig = 1; #ciliscom#digito# = 6; |FINSI;
   |SI swdig = 0;
      |MENAV men2;
      |ERROR;
   |FINSI;
|FPRC;

|PROCESO otravez;
   cta_t  = Campo - 1;
   digito = Campo;
   cta    = #ciliscom#cta_t#; |QBF cta;
   long   = cta % 0;
   swdig  = 0;
   |SI long = dig4; swdig = 1; #ciliscom#digito# = 1; |FINSI;
   |SI long = dig5; swdig = 1; #ciliscom#digito# = 2; |FINSI;
   |SI long = dig6; swdig = 1; #ciliscom#digito# = 3; |FINSI;
   |SI long = dig7; swdig = 1; #ciliscom#digito# = 4; |FINSI;
   |SI long = dig8; swdig = 1; #ciliscom#digito# = 5; |FINSI;
   |SI long = dig9; swdig = 1; #ciliscom#digito# = 6; |FINSI;
|FPRC;

|PROCESO ctah; | TIPO 0;   ||  hasta cuenta
   |SI #ciliscom#0 > #ciliscom#2;  |ERROR;  |FINSI;
|FPRC;

|| *************************************************************************
||                          MEOLLO
|| *************************************************************************
|PROCESO sumacontra0;
   swalgun = 1;
   total = total + #cientcon#8;
|FPRC;

|DEFBUCLE sumacontra;
   #3#1;
   ;
   #2#0, #2#2, 00001;
   #2#0, #2#2, 99999;
   e;
   NULL, sumacontra0;
|FIN;

|PROCESO imprcontra0;
   swlinea = 2;
   |PRINT;
|FPRC;

|DEFBUCLE imprcontra;
   #3#1;
   ;
   #2#0, #2#2, 00001;
   #2#0, #2#2, 99999;
   e;
   NULL, imprcontra0;
|FIN;

|PROCESO imprlineas;

   |SI #cientasl#6 = "D";
      a_debe = #cientasl#7;
      a_haber = 0;
   |SINO;
      a_debe = 0;
      a_haber = #cientasl#7;
   |FINSI;
   t_debe  = t_debe  + a_debe;
   t_haber = t_haber + a_haber;

   swlinea = 0;
   lacontra = #cientasl#8;
   |QBF lacontra;
   |SI lacontra ! "";
      |PRINT;
   |SINO;
      total   = 0;
      texto   = "";
      swalgun = 0;
      |BUCLE sumacontra;
      |SI swalgun = 0;
         texto = "ERROR. NO EXISTEN CONTRAPARTIDAS !";
      |SINO;
         |SI total ! #cientasl#7;
            texto = "ERROR. CONTRAPARTIDAS DESCUADRADAS !";
         |FINSI;
      |FINSI;
      swlinea = 1;
      |PRINT;
      |BUCLE imprcontra;
      |SI swlinea = 2;
         swlinea = 3;
         |PRINT;
      |FINSI;
   |FINSI;

   swprim = 1;
|FPRC;

|PROCESO bucleimp;
   |DDEFECTO #4;
   #cisalant#0 = #cientasc#0;
   #cisalant#1 = #cientasc#1;
   |LEE 040#4=;
   |SI FSalida ! 0;
       #cisalant#3 = 0;
   |FINSI;
   inisal  = #cisalant#3;
   inifec  = #cisalant#4;
   swprim  = 0;
   t_debe  = 0;
   t_haber = 0;

   |BUCLELIN 2imprlineas#1;
   |SI swprim = 1;
      |PIEINF;
   |FINSI;
|FPRC;

|DEFBUCLE ciliscom0;
   #1#1;
   ;
   #0#0;
   #0#2;
   e;
   NULL, bucleimp;
|FIN;

|| *********************************************************************
||                             COMIENZO
|| *********************************************************************
|PROCESO imprime; |TIPO 3;

   |ABRE #200;
   |DDEFECTO #200;
   |LEE 001#200p;
   |CIERRA #200;
   |SI #200#164 = "S";  eaTexto = "Ej.Op."; |FINSI;


   |DDEFECTO #3;
   swprim = 0;
   t_debe = 0;
   t_haber = 0;

   |IMPRE 0;
   |SI FSalida ! 0;  |ACABA;  |FINSI;

   |INFOR informe;
   |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

   |ABRE #4;
   |BUCLE ciliscom0;
   |CIERRA #4;
   |FININF;
   |FINIMP;
|FPRC;
