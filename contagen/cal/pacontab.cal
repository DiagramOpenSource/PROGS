|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    alfa5 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;

    fabre = "";
    fcanl = "";
    field = "";
    any = 0;
    mes = 0;
    dia = 0;
    bytes = 0;
    campo = 0;
    campoalf = "";
    pos_lee = 0;
    pos_gra = 0;
    pos_gra_ant = 0;
    fabre2 = "";
    fcanl2 = "";
    field2 = "";
    graba = 0;
    leido = 0;
    regis = 0;
    borra = 0;
    desde = "";
    hasta = "";
    sw_seleccio = 0;

    nhexa = "";
    ndeci = 0;
    nalfa1 = "";
    nalfa2 = "";
    nnume1 = 0;
    nnume2 = 0;
    npara1 = 0;
    npara2 = 0;
    npara3 = 0;
    nlongi = 0;

    vuelt0 = "";
    vuelt1 = "";
    vuelt2 = "";
    longa = "";
    longn = 0;
    vuelta = 0;
    coger = 0;
    flg_bor = 0;

    &eaFicBase =  "";   || Fichero DBASE para lee
    &enLongR    = 0;    || Longitud Registro
    &enCap      = 0;    || Longitud Cabecera
    &enCamps    = 0;    || Numero de Campos
    &enRegistre = 0;    || Total Registros
    &eswError   = 0;
|FIN;

|PROCESO deci_hexa;
    nhexa = "";
    |PARA npara1 = 2; |SI npara1 ] 1; |HACIENDO npara1 = npara1 - 1;
        |SI npara1 = 1; nnume1 = ndeci $ 16;          |FINSI;
        |SI npara1 = 2; nnume1 = (ndeci / 16) $ 16;   |FINSI;

        |SI nnume1 < 10;     nhexa = nhexa + nnume1;  |FINSI;
        |SI nnume1 = 10;     nhexa = nhexa + "A";     |FINSI;
        |SI nnume1 = 11;     nhexa = nhexa + "B";     |FINSI;
        |SI nnume1 = 12;     nhexa = nhexa + "C";     |FINSI;
        |SI nnume1 = 13;     nhexa = nhexa + "D";     |FINSI;
        |SI nnume1 = 14;     nhexa = nhexa + "E";     |FINSI;
        |SI nnume1 = 15;     nhexa = nhexa + "F";     |FINSI;
    |SIGUE;
|FPRC;

|PROCESO hexa_deci;
    nalfa1 = nhexa % 0;
    nlongi = nalfa1;
    ndeci = 0;
    |PARA npara1 = nlongi; |SI npara1 ] 1; |HACIENDO npara1 = npara1 - 1;

          nnume1 = (((nlongi - npara1) + 1) * 100) + 1; || pos.en la cadena
          nalfa2 = nhexa % nnume1;    || contenido de esa posicion
          nnume2 = nalfa2;            || contenido numerico
          |SI nalfa2 = "A";     nnume2 = 10;   |FINSI;
          |SI nalfa2 = "B";     nnume2 = 11;   |FINSI;
          |SI nalfa2 = "C";     nnume2 = 12;   |FINSI;
          |SI nalfa2 = "D";     nnume2 = 13;   |FINSI;
          |SI nalfa2 = "E";     nnume2 = 14;   |FINSI;
          |SI nalfa2 = "F";     nnume2 = 15;   |FINSI;

          nnume1 = 1;
          npara3 = npara1 - 1;
          |PARA npara2 = 1; |SI npara2 [ npara3; |HACIENDO npara2 = npara2 + 1;
                nnume1 = nnume1 * 16;
          |SIGUE;
          ndeci = ndeci + (nnume1 * nnume2);

    |SIGUE;
|FPRC;

|PROCESO da_vuelta;
    longa = vuelt1 % 0;   longn = longa;
    longn = longn - 1;
    vuelt2 = "";
    |PARA vuelta = longn; |SI vuelta ] 1; |HACIENDO vuelta = vuelta - 2;
          coger = (vuelta * 100) + 2;
          vuelt0 = vuelt1 % coger;
          vuelt2 = vuelt2 + vuelt0;
    |SIGUE;
|FPRC;

|PROCESO leyendo_hex;
   vuelt1 = "";
   |PARA para1 = 1; |SI para1 [ bytes; |HACIENDO para1 = para1 + 1;
         field = fcanl + " 1";
         |FLEE field;
         alfa5 = field % 0;
         nume1 = alfa5;
         |SI nume1 > 1;
             ndeci = 0;        || caracter cero (lo transforma a 2 bytes)
         |SINO;
             ndeci = &field;
         |FINSI;
         |HAZ deci_hexa;
         vuelt1 = vuelt1 + nhexa;
   |SIGUE;
   |HAZ da_vuelta;
   nhexa = vuelt2;
   |HAZ hexa_deci;
|FPRC;

|PROCESO lon_regis3;
    bytes = 2; |HAZ leyendo_hex;  enLongR = ndeci;
|FPRC;

|PROCESO lon_cabec3;
    bytes = 2; |HAZ leyendo_hex;  enCap = ndeci;

    enCamps = (enCap - 33) / 32;  || nro.campos
|FPRC;

|PROCESO nro_regis3;
    bytes = 4; |HAZ leyendo_hex;  enRegistre = ndeci;
|FPRC;

|PROCESO ult_acceso3;
    field = fcanl + " 1";     |FLEE field;   any = &field;  || lee a¤o
    field = fcanl + " 1";     |FLEE field;   mes = &field;  || lee mes
    field = fcanl + " 1";     |FLEE field;   dia = &field;  || lee dia

    alfa1 = dia;    alfa1 = ("00" + alfa1) % -102;
    alfa2 = mes;    alfa2 = ("00" + alfa2) % -102;
    |SI any < 80;
        any = any + 2000;
    |SINO;
        any = any + 1900;
    |FINSI;
    alfa3 = alfa1 + "." + alfa2 + "." + any;
    fech1 = alfa3;
|FPRC;

|| *******************************************************************
|PROCESO CalculDBF;
    eswError = 0;
    fabre = "rb  " + eaFicBase;
    |FABRE fabre;
    |SI FSalida ] 0;
        fcanl = FSalida;
|| .......... Version
        field = fcanl + " 1";     |FLEE field;        || lee version
        nume1 = &field;
|| ---------------------------------------------------
    |SI nume1 = 3;       || DBase III
        |HAZ ult_acceso3;
        |HAZ nro_regis3;
        |HAZ lon_cabec3;
        |HAZ lon_regis3;
    |SINO;
        eswError = 2;
    |FINSI;
    |FCIERRA fcanl;
    Pos = -1;
 |SINO;
    eswError = 1;
 |FINSI;
|FPRC;
|| *******************************************************************
