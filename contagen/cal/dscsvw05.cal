|FICHEROS;
     dscsvm04;
     dscsvm05;
     dscsvw05;

     :modelos/dsmom030;
|FIN;

|VARIABLES;
     nID            = 0;
     nError         = 0;
     nHasta         = 0;
     nCampo         = 0;

     aTexto         = "";
     aAlfa          = "";
     aID            = "";

     {30}&eaPopup   = "";
|FIN;

|PROCESO Tipo12Fw05;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     |SI FSalida ! 1;
         |ERROR;
         |POSICIONATE #dscsvw05#0;
     |FINSI;
|FPRC;

|PROCESO Tipo66C2Fw05;  |TIPO 66;
     |SI #dscsvw05#1 = 6;
         |ABRE #dsmom030;
         #dsmom030#0 = #dscsvw05#2;
         |LEE 000#dsmom030.=;
         |CONSULTA_CLAVE #1#dsmom030;
         |SI FSalida = 0;
             #dscsvw05#2 = #dsmom030#0;  |PINTA #dscsvw05#2;
         |FINSI;
         |CIERRA #dsmom030;
     |FINSI;
|FPRC;

|PROCESO PopupCamaasilFw5;
     aAlfa = "|C001WID";
     aID   = #dscsvw05#aAlfa#;
     nID   = aID;

     eaPopup1  = nID;  || Si fuera -1 en la posicion
     |HAZ CargaCamaasil;

     IeaPopup  = eaPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", eaPopup;
     |SI FSalida ! 0;
         IeaPopup  = eaPopup3  <-;
         IeaPopup  = IeaPopup + (FSalida - 1);

         aAlfa = eaPopup % 103;  #dscsvw05#1 = aAlfa;  |PINTA #dscsvw05#1;
         aAlfa = eaPopup % 540;  #dscsvw05#0 = aAlfa;  |PINTA #dscsvw05#0;
     |FINSI;
|FPRC;

|PROCESO PopupCacuentaFw5;
     aAlfa = "|C001WID";
     aID   = #dscsvw05#aAlfa#;
     nID   = aID;

     eaPopup1  = nID;  || Si fuera -1 en la posicion
     |HAZ CargaCacuenta;

     IeaPopup  = eaPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", eaPopup;
     |SI FSalida ! 0;
         IeaPopup  = eaPopup3  <-;
         IeaPopup  = IeaPopup + (FSalida - 1);

         aAlfa = eaPopup % 103;  #dscsvw05#1 = aAlfa;  |PINTA #dscsvw05#1;
         aAlfa = eaPopup % 540;  #dscsvw05#0 = aAlfa;  |PINTA #dscsvw05#0;
     |FINSI;
|FPRC;

|PROCESO Tipo66C0Fw05;  |TIPO 66;
     |SI #dscsvm04#1 = "cacuenta";  |HAZ PopupCacuentaFw5;  |FINSI;
     |SI #dscsvm04#1 = "camaasil";  |HAZ PopupCamaasilFw5;  |FINSI;
|FPRC;

|PROCESO Tipo0C0Fw05;  |TIPO 0;
     |C_M #dscsvw05#0, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |SI #dscsvm04#1 = "cacuenta";  |HAZ CargaCacuenta;  |FINSI;
     |SI #dscsvm04#1 = "camaasil";  |HAZ CargaCamaasil;  |FINSI;

     aAlfa = #dscsvw05#0;  |QBF aAlfa;
     |SI aAlfa ! "";
         nError   = 1;
         nHasta   = eaPopup2;
         aTexto   = (("000" + #dscsvw05#1) % -103) + "-" + #dscsvw05#0;  |QBF aTexto;

         IeaPopup  = eaPopup3 <-;
         |PARA nCampo = 1;  |SI nCampo [ nHasta;  |HACIENDO nCampo = nCampo + 1;
               |SI eaPopup = aTexto;
                   nError = 0;
                   |SAL;
               |FINSI;

               IeaPopup = IeaPopup + 1;
         |SIGUE;

         |SI nError = 1;
             |MENAV "0000Contenido incorrecto. Consulte la lista";
             |ERROR;
             |ACABA;
         |FINSI;
     |SINO;
         |MENAV "0000Contenido incorrecto. Consulte la lista";
         |ERROR;
         |ACABA;
     |FINSI;

     #dscsvm05#0 = #dscsvm04#0;
     #dscsvm05#1 = #dscsvm04#1;
     #dscsvm05#2 = #dscsvm04#2;
     #dscsvm05#3 = #dscsvm04#3;
     #dscsvm05#4 = #dscsvm04#4;
     #dscsvm05#5 = #dscsvw05#1;
     |LEE 000#dscsvm05.=;
     |SI FSalida = 0;
         |MENAV "0000El campo ya est  introducido";
         |ERROR;
     |FINSI;
|FPRC;
