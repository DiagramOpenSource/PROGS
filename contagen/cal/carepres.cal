|INCLUYE dscont_i;
|FICHEROS;
   carepres #0;

   &provinc@ #700;
   &poblaci@ #703;
   &regisnif@ #709;
   &clientes@ #715;
   &sgpaises@ #718;
|FIN;

|VARIABLES;
   letra = "";
   alfa1 = "";
   alfa2 = "";
   final = "";
   x = "";
   nume1 = 0;
   nume2 = 0;
   lugar = 0;
   nifnum = 0;
   resto = 0;
   aAntes = "";
   traba = "";
  &eaVarDni  = "";
  &enCalcCif = 0;
|FIN;

|PROCESO letra_0;  |TIPO 6;
   |SI FSalida = 10;
      enCalcCif = 1;
      eaVarDni  = #carepres#Campo#;
      |HAZ CalculoDNI;
      #carepres#Campo# = eaVarDni;
      |PINTA #carepres#Campo#;
      |ERROR;
      |ACABA;
   |FINSI;

     eaVarDni  = #0Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "                ") % 115;
     |SI #0Campo ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #0Campo = eaVarDni;  |PINTA #0Campo;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|CALCULO AreNifs; |TIPO 7;
 aAntes = #carepres#Campo#;
|FCAL;

|CALCULO ReNifs; |TIPO 0;
  |SI aAntes = #carepres#Campo#; |ACABA; |FINSI;

  traba = #carepres#Campo#;
  |QBF traba;
  |SI traba = "";  |ACABA;  |FINSI;

  |SI Haybasica = 0; |Y HayAcceso = 0; |ACABA; |FINSI;

  eaCodNif = #carepres#Campo#;
  |HAZ LeeNifs;
  |SI ewNif = 0;
      traba = #709#2; |QBF traba;
      #carepres#1 = #709#1;
      #carepres#2 = traba + "," + #709#3;   || Domicilio y Numero
      #carepres#3 =  #709#4;  || Cod. Provincia
      #carepres#4 =  #709#5;  || Cod. Poblacion
      #carepres#5 =  #709#6;  || Poblacion
      #carepres#6 =  #709#7;  || Provincia
      #carepres#8 =  #709#8;  || Telefono
      #carepres#9 =  #709#17; || Fax
      |PINDA #0#carepres;
  |FINSI;
|FCAL;

|CALCULO ReLocalidad; |TIPO 0;
 nume1 = Campo - 1;
 enCodPobl = #carepres#Campo#;
 enCodProv = #carepres#nume1#;
 |HAZ LeeLocalidad;
 #carepres#6 = eaProvincia; |PINTA #carepres#6;
 #carepres#5 = eaPoblacion; |PINTA #carepres#5;
|FCAL;
