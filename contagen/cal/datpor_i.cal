|FICHEROS;
   &provinc@ #700;
   &poblaci@ #703;
   &haciend@ #706;
   &regisnif@ #709;
   &clientes@ #715;
   &sgpaises@ #718;
   :/integral/def/dsam0114 #721; ||Comunidades

   :/basica/def/agim0004 #3; ||Representantes
   :/basica/def/agicen14 #5; ||Actividades
|FIN;

|VARIABLES;
  ContaRepre = 0;
  ContaActiv = 0;
|FIN;

||*********************************************
|| Proceso para Recoger los Datos de Otros Ficheros

|PROCESO desdecontab;           ||Desde Empresas Contables
  #caportad#2 = #canempre#1;
  #caportad#4 = #canempre#5;
  traba = #canempre#6 % 102;
  #caportad#9 = traba;
  traba = #canempre#6 % -103;
  #caportad#10 = traba;
  #caportad#11 = #canempre#7;

  enCodProv = #caportad#9;
  enCodPobl = #caportad#10;
  |HAZ LeeLocalidad;
  #caportad#12 = eaProvincia;

  #caportad#13 = #canempre#8;
  #caportad#14 = #canempre#9;
|FPRC;

|| ====================================================================
|PROCESO PasaRepre;
 ContaRepre = ContaRepre + 1;

 |SI ContaRepre = 1;
     #caportad#38 = #agim0004#2;  ||NIF
     #caportad#39 = #agim0004#3;  ||Nombre
     #caportad#40 = "";           ||SG
     #caportad#41 = #agim0004#6;  ||Direccion
     #caportad#42 = #agim0004#7;  ||Numero
     #caportad#43 = "";           ||Escalera
     #caportad#44 = "";           ||Piso
     #caportad#45 = "";           ||Puerta
     #caportad#46 = #agim0004#12; ||Telefono
     #caportad#47 = #agim0004#8;  ||Cod.Prov.
     #caportad#48 = #agim0004#9;  ||Cod.Pobl.
     #caportad#49 = #agim0004#10; ||Poblacion
     #caportad#50 = #agim0004#11; ||Provincia

     #caportad#51 = #agim0004#3 % 120;   ||Nombre 1
     #caportad#52 = #agim0004#3 % 2120;  ||Nombre 2
     #caportad#53 = #agim0004#2;         ||CIF
     #caportad#54 = #agim0004#4;         ||Fecha Poder
     #caportad#55 = #agim0004#5;         ||Notario
     |ACABA;
 |FINSI;

 |SI ContaRepre = 2;
     #caportad#56 = #agim0004#3 % 120;
     #caportad#57 = #agim0004#3 % 2120;
     #caportad#58 = #agim0004#2;
     #caportad#59 = #agim0004#4;
     #caportad#60 = #agim0004#5;
     |ACABA;
 |FINSI;

 |SI ContaRepre = 3;
     #caportad#61 = #agim0004#3 % 120;
     #caportad#62 = #agim0004#3 % 2120;
     #caportad#63 = #agim0004#2;
     #caportad#64 = #agim0004#4;
     #caportad#65 = #agim0004#5;
     |ACABA;
 |FINSI;

 |ERROR10;
|FPRC;

|DEFBUCLE agim0004;
 #agim0004#1;
 ;
 #caportad#0, 00;
 #caportad#0, 99;
 ;
 NULL, PasaRepre;
|FIN;

|CALCULO PasaActiv;
 ContaActiv = ContaActiv + 1;

 |SI ContaActiv = 1;
     #caportad#20 = #agicen14#4;
     #caportad#32 = #agicen14#2 + #agicen14#3;
     |ACABA;
 |FINSI;

|SI ContaActiv = 2;
    #caportad#21 = #agicen14#4;
    #caportad#33 = #agicen14#2 + #agicen14#3;
    |ACABA;
|FINSI;

|SI ContaActiv = 3;
    #caportad#22 = #agicen14#4;
    #caportad#34 = #agicen14#2 + #agicen14#3;
    |ACABA;
|FINSI;

|SI ContaActiv = 4;
    #caportad#23 = #agicen14#4;
    #caportad#35 = #agicen14#2 + #agicen14#3;
    |ACABA;
|FINSI;

|SI ContaActiv = 5;
    #caportad#24 = #agicen14#4;
    #caportad#36 = #agicen14#2 + #agicen14#3;
    |ACABA;
|FINSI;

|SI ContaActiv = 6;
    #caportad#25 = #agicen14#4;
    #caportad#37 = #agicen14#2 + #agicen14#3;
    |ACABA;
|FINSI;

|ERROR10;
|FCAL;

|DEFBUCLE agicen14;
 #agicen14#1;
 ;
 #caportad#0, 00;
 #caportad#0, 99;
 ;
 NULL, PasaActiv;
|FIN;

|PROCESO desdebasica;
  |SI HayAcceso = 1;
      |HAZ LosCamposAcceso;
  |SINO;
      |HAZ LosCamposbasica;
  |FINSI;
  |SI Haybasica = 1;
      ContaRepre = 0;  |BUCLE agim0004;  ||Representantes
      ContaActiv = 0;  |BUCLE agicen14;  ||Actividades
  |FINSI;
|FPRC;

|PROCESO LosCamposAcceso;
  #caportad#2  = #clientes@#2;   ||Nombre
  #caportad#3  = #clientes@#29;  ||Sg
  #caportad#4  = #clientes@#30;  ||Direccion
  #caportad#5  = #clientes@#31;  ||Numero
  #caportad#6  = #clientes@#32;  ||Escalera
  #caportad#7  = #clientes@#33;  ||Piso
  #caportad#8  = #clientes@#34;  ||Puerta
  #caportad#9  = #clientes@#35;  ||C.Prov
  #caportad#10 = #clientes@#36;  ||C.Pobl
  #caportad#11 = #clientes@#37;  ||Poblacion
  #caportad#12 = #clientes@#38;  ||Provincia
  #caportad#13 = #clientes@#3;   ||Cif
  #caportad#14 = #clientes@#54;  ||Telefono
  #caportad#15 = #clientes@#4;   ||Anagrama
  #caportad#16 = #clientes@#15;  ||C.Del.Hacienda
  #caportad#17 = #clientes@#16;  ||C.Adm.Hacienda
  #caportad#18 = #clientes@#17;  ||Del.Hacienda
  #caportad#19 = #clientes@#18;  ||Adm.Hacienda
                                             || ---> Actividad y Representantes
  #caportad#66 = #clientes@#90;  ||Entidad
  #caportad#67 = #clientes@#91;  ||Oficina
  #caportad#68 = #clientes@#92;  ||D.C.
  #caportad#69 = #clientes@#93;  ||Cuenta Corriente
  #caportad#70 = #clientes@#89;  ||Nombre Banco

  #caportad#94 = #clientes@#12;  ||Comunidad Bienes
  #caportad#95 = #clientes@#57;  ||Gran Empresa
  #caportad#96 = #clientes@#58;  ||Exportadores
  #caportad#97 = #clientes@#59;  ||Confeccion 347

  #caportad#101 = #clientes@#86;  ||Cod.Comunidad
  #caportad#102 = #clientes@#87;  ||Comunidad
  #caportad#103 = #clientes@#98;  ||Cod.Pais
  #caportad#104 = #clientes@#99;  ||Pais
|FPRC;

|PROCESO LosCamposbasica;
  #caportad#2  = #clientes@#2;   ||Nombre
  #caportad#3  = #clientes@#3;   ||Sg
  #caportad#4  = #clientes@#4;   ||Direccion
  #caportad#5  = #clientes@#5;   ||Numero
  #caportad#6  = #clientes@#6;   ||Escalera
  #caportad#7  = #clientes@#7;   ||Piso
  #caportad#8  = #clientes@#8;   ||Puerta
  #caportad#9  = #clientes@#9;   ||C.Prov
  #caportad#10 = #clientes@#10;  ||C.Pobl
  #caportad#11 = #clientes@#11;  ||Poblacion
  #caportad#12 = #clientes@#12;  ||Provincia
  #caportad#13 = #clientes@#13;  ||Cif
  #caportad#14 = #clientes@#14;  ||Telefono
  #caportad#15 = #clientes@#62;  ||Anagrama
  #caportad#16 = #clientes@#63;  ||C.Del.Hacienda
  #caportad#17 = #clientes@#64;  ||C.Adm.Hacienda
  #caportad#18 = #clientes@#91;  ||Del.Hacienda
  #caportad#19 = #clientes@#92;  ||Adm.Hacienda
                                             || ---> Actividad y Representantes
  #caportad#66 = #clientes@#81;  ||Entidad
  #caportad#67 = #clientes@#82;  ||Oficina
  #caportad#68 = #clientes@#83;  ||D.C.
  #caportad#69 = #clientes@#84;  ||Cuenta Corriente
  #caportad#70 = #clientes@#80;  ||Nombre Banco
                                             || ---> otros Datos
|FPRC;

|PROCESO AltaNif;
  eaCodNif = #caportad#13;
  |HAZ LeeNifs;
  |SI ewNif = 0; |ACABA; |FINSI; || Hay Existe

  |ABRE #709;
  #709#0 = #caportad#13;  || Nif
  #709#1 = #caportad#2;   || Apellidos y Nombre
  #709#2 = #caportad#4;   || Domicilio
  #709#3 = #caportad#5;   || Numero
  #709#4 = #caportad#9;   || Cod. Provincia
  #709#5 = #caportad#10;  || Cod. Poblacion
  #709#6 = #caportad#11;  || Poblacion
  #709#7 = #caportad#12;  || Provincia
  #709#8 = #caportad#14;  || Telefono
  #709#9 = #caportad#3;   || Sg
  #709#16 = #caportad#6;   || Escalera
  #709#10 = #caportad#7;   || Piso
  #709#11 = #caportad#8;   || Puerta
  #709#12 = #caportad#103;  || Codigo Pais
  #709#13 = #caportad#104;  || Nombre Pais
  #709#14 = #caportad#101;  || Codigo Comunidad
  #709#15 = #caportad#102;  || Nombre Comunidad

  |GRABA 020#709n;                 || Graba el basica
  |LIBERA #709;
|FPRC;
