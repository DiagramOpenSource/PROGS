|FICHEROS;
   cacrebal #00;   || def de datos
   caagrupa #01;   || agrupaciones
   cacuebal #02;   || cuentas de balance
   caepigra #03;   || epigrafes
   caparbal #04;   || partidas de balance
   caparexp #05;   || partidas de explotacion

   plancont #07;   || cuentas basico
   predecab #08;   || predef. cabs. basico
   predelin #09;   || predef. lins. basico

   casieaca #11;   || predef. cabs.
   casieali #12;   || predef. lins.
   predegru #14;   || grupos predef. basico
   predesub #15;   || subgrupos predef. basico
||   casiegru #16;   || grupos predef.
||   casiesub #17;   || subgrupos predef.

   cadeflal #22;   || Conceptos
   prdeflal #23;   || Conceptos basicos

   camauto0 #111;  || Automaticos cab esp.
                   ||  camauto1 #109 en el Incluye
   camautoc #113;  ||             cab
                   ||  camautol #108 en el Incluye
   camautti #115;
   caformul #116;  || Formulas Ratios

   prmauto0 #121;  || Automaticos cab esp.
   prmautoc #123;  ||             cab
                   || por cargadef en 999    prmauto1 #122;
                   || por cargadef en 999    prmautol #124;
                   || por cargadef en 999 -  prmautti #125;

   ca8ctrle #400;  ||Control Empresa
   ca8comay #401;  ||Control Cuentas de mayor

   canempre #30;
   espejoa@ #999;
|FIN;

|VARIABLES;
   &entrada = 1;

   Comodin  = "";
   Comodin1 = "";
   Comodin2 = "";
   vari1    = "rb  ";
   fiche    ="";
   handle   ="";
   canal    = "";
   espacio  =" ";
   saber    = "";
   menos    = -1;
   num = 0;
   field = 0;
   sw_vale = 0;
   FEstado = 0;
   nume1 = 0;
   nume2 = 0;
   nume3 = 0;
   nume4 = 0;
   alfa1 = "";
   alfa2 = "";
   alfa3 = "";
   alfa4 = "";
   aAlfa5 = "";
   para1 = 0;
   para2 = 0;
   para3 = 0;
   para4 = 0;
   pepe = 0;
   dire = "";
   buf_dir = 0;
   ele_dir = 0;
   &r_emp = 0;
   &r_per = 0;
   &any_pos = 0;
   &num_per = 0;
   ddig3 = 0;
   ddig4 = 0;
   ddig5 = 0;
   ddig6 = 0;
   ddig7 = 0;
   ddig8 = 0;
   ddig9 = 0;

   &eaExterno   = "";
   &enPerioOri  = 0;
   &eaCeros     = "";
   &eaOtras     = "";

   aQueQuiero = "";
   aNumCampos = "";
   nNumCampos = 0;
   nNumCamCab = 0;
   nEjerActual = 0;

   aAlfa1 = "";
   aDef   = "";
   aMas   = "";
   nNivelMD = 0;
   nNivelMO = 0;

   fFecha    = @;
   &enSw100  = 0;
   &enEmp100 = 0;
   &enPer100 = 0;
|FIN;

|INCLUYE dscont_i;
|INCLUYE copian_i;


|PROCESO empresa; |TIPO 0;
   |SI FSalida = 9; |ACABA; |FINSI;

   |SI #0#0 = 0;
       #0#1 = 0;
       #0#2 = "SIN COPIAR FICHEROS DE EMPRESAS";
       |C_M #0#1, 1,"N";
       |C_M #0#3, 1,"N";
       |C_M #0#4, 1,"N";
       |C_M #0#9, 1,"N";
       |C_M #0#10, 1,"N";
       |C_M #0#5, 1,"S";
       |C_M #0#6, 1,"S";
       |C_M #0#7, 1,"S";
       |C_M #0#8, 1,"S";
       |C_M #0#11, 1,"S";
       |C_M #0#13, 1,"S";
       |PINTA #0#1;
       |PINTA #0#2;
   |SINO;
||        |HAZ confirma;   La Confirmacion en el Ejercicio
       |C_M #0#1,  1,"S";
       |C_M #0#3,  1,"S";
       |C_M #0#4,  1,"S";
       |C_M #0#5,  1,"N";
       |C_M #0#6,  1,"N";
       |C_M #0#7,  1,"N";
       |C_M #0#8,  1,"N";
       |C_M #0#11, 1,"N";
       |C_M #0#13, 1,"N";
       |C_M #0#9,  1,"S";
       |C_M #0#10, 1,"S";
   |FINSI;
|FPRC;

|PROCESO confirma;
   |AVISO;
   |PUSHV 07301470;
   |CUADRO 07 30 14 70;
   |ATRI R;
   ||            1234567890123456789012345678901234567890
   |PINTA 0831, " ------------------------------------- ";
   |PINTA 0931, " ¨ESTA SEGURO DE MACHACAR LOS FICHEROS ";
   |PINTA 1031, " DE LA EMPRESA EN LA QUE SE ENCUENTRA? ";
   |PINTA 1131, " ------------------------------------- ";
   |PINTA 1231, "        Confirme (S/N):                ";
   |PINTA 1331, " ------------------------------------- ";
   E_inf = "SNsn";
   E_sup = 1;
   alfa1 = "N";
   alfa1 = 1255 ? 0;
   |SI alfa1 = "N";|O alfa1 = "n";
      |ERROR;
   |FINSI;
   |ATRI 0;
   |POPV;
|FPRC;

|PROCESO aviso2;
   |AVISO;
   |PUSHV 07301570;
   |CUADRO 07 30 15 70;
   |ATRI R;
   ||            1234567890123456789012345678901234567890
   |PINTA 0831, " ------------------------------------- ";
   |PINTA 0931, " EMPRESA ORIGEN CON PLAN CONTABLE 1990 ";
   |PINTA 1031, " AL COPIARLA SE ADAPTARA AL NUEVO PLAN ";
   |PINTA 1131, " 2008 SEGUN TABLA DE EQUIVALENCIAS.    ";
   |PINTA 1231, " ------------------------------------- ";
   |PINTA 1331, "       CONTINUAR (S/N):                ";
   |PINTA 1431, " ------------------------------------- ";
   E_inf = "SNsn";
   E_sup = 1;
   alfa1 = "N";
   alfa1 = 1355 ? 0;
   |SI alfa1 = "N";|O alfa1 = "n";
      |ERROR;
   |SINO;
      eSwC2008 = 1;
      |C_M #0#3,1,"N";  #0#3 = "M";  |PINTA #0#3;
      |C_M #0#4,1,"N";  #0#4 = "S";  |PINTA #0#4;
      |C_M #0#9,1,"N";  #0#9 = "N";  |PINTA #0#9;
      |C_M #0#10,1,"N"; #0#10 = "N"; |PINTA #0#10;
   |FINSI;
   |ATRI 0;
   |POPV;
|FPRC;

|PROCESO ejercicio;
   |SI FSalida = 2; |ACABA; |FINSI;

   eSwC2008 = 0;
   |SI #0#0 = 0;  |ACABA;  |FINSI;

   |SI #0#0 = num_por; |Y #0#1 = num_per;
       |MENAV "    Error, seleccionada Empresa Actual";
       |ERROR;
       |ACABA;
   |FINSI;

   |C_M #0#3,1,"S";
   |C_M #0#4,1,"S";
   |C_M #0#9,1,"S";
   |C_M #0#10,1,"S";

   cod1 = #0#0;
   cod2 = #0#1;

   |HAZ leelo;
   nNivelMO = MaximoDigitos
   aMonedaC = eaMoneda;
   |SI swerror = 1;
      #0#2 = "EMPRESA INEXISTENTE"; |PINTA #0#2;
      |ERROR;
      |ACABA;
   |SINO;
      |SI dig3 ! ddig3; |O dig4 ! ddig4; |O dig5 ! ddig5; |O dig6 ! ddig6; |O dig7 ! ddig7; |O dig8 ! ddig8; |O dig9 ! ddig9;
          |SI nNivelMO = nNivelMD; |Y nEjerActual ! enEjercicio; |Y nEjerActual = 2008;
              |CONFI "    SNO CORRESPONDEN LOS NIVELES, CONTINUAR ";
              |SI FSalida ! 0;
                  |ERROR;
                  |ACABA;
              |FINSI;
           |SINO;
              |MENAV "     NO CORRESPONDEN LOS NIVELES ";
              #0#2 = "NO CORRESPONDEN LOS NIVELES"; |PINTA #0#2;
              |ERROR;
              |ACABA;
            |FINSI;
      |FINSI;
   |FINSI;

   |SI enEjercicio ! nEjerActual;
       |SI nEjerActual < 2008; |Y enEjercicio ] 2008;
           |MENAV "    EMPRESA CON PLAN CONTABLE 2008, NO PUEDE COPIARLA A UN EJERCICIO ANTERIOR";
           |ERROR;
       |SINO;
            |SI nEjerActual ] 2008; |Y enEjercicio < 2008;
                |HAZ aviso2;
           |FINSI;
        |FINSI;
   |FINSI;
   #0#2     = #canempre#1; |PINTA #0#2;
   num_por1 = #canempre#2;
   any_por1 = #canempre#26;
|FPRC;


|PROCESO consulta;
   |SI FSalida ! 9;  |ACABA;  |FINSI;
   r_emp = 0;
   |SUB_EJECUTA "caconemp";
   |ERROR;
   |SI r_emp = 0; |ACABA; |FINSI;
   #0#0 = r_emp;
   #0#1 = r_per;
   |PTEC 802;
|FPRC;

|PROCESO MiroCopia;
   |C_M #0#3, 0, alfa1;
   |SI alfa1 = "N"; |ACABA; |FINSI;

   |SI FSalida = 2; |ACABA; |FINSI;

   |SI #0#3 = "T";
       |SI enEjercicio ! nEjerActual;
           enEmp100 = #0#0;
           enPer100 = #0#1;
           |HAZ eBuscoMaestra;
           |SI enSw100 = 0;
               alfa1 = "    NEmpresa Origen del " + enEjercicio + ". Pasar Movimientos de distinto Ejercicio ?";
               |CONFI alfa1;
               |SI FSalida ! 0;
                   |ERROR;
               |FINSI;
           |FINSI;
       |FINSI;
   |FINSI;
|FPRC;

|PROCESO CodCta7; |TIPO 7;

   |SI #0#0 = 0;
       |SI #0#6 ! "S";
           |C_M #0#12, 1, "N";
           #0#12 = 0; |PINTA #0#12;
       |FINSI;
       |ACABA;
   |FINSI;

   |SI nEjerActual < 2008;
       #0#12 = 0; |PINTA #0#12;
       |ACABA;
   |FINSI;

   |ABRE #400;
   |DDEFECTO #400;
   #400#0 = #0#0;
   #400#1 = #0#1;
   |LEE 000#400=;
   |CIERRA #400;

   |SI enEjercicio [ nEjerActual;  |Y enEjercicio ] 2008;
       #0#12 = #400#2;|PINTA #0#12;
       |C_M #0#12, 0, alfa1;
       |SI alfa1 = "S";
           |PTEC 802;
       |FINSI;
  |FINSI;
|FPRC;

|PROCESO CodCta0; |TIPO 0;
  |C_M #0#12, 0, alfa1;
  |SI alfa1 = "N"; |ACABA; |FINSI;
  |ABRE #401;
  #401#0 = #0#12;
  |LEE 001#401=;
  |SI FSalida ! 0;
      |MENAV "    Error, no existe Codigo de Cuentas de Mayor";
      |ERROR;
  |SINO;
      |C_A #401#1,1,35; |PINTA 1741, #401#1;
  |FINSI;
  |CIERRA #401;
|FPRC;


|PROCESO creacion;
   alfa4 = "agrupaci";
   |SI nEjerActual ] 2008; alfa4 = "agrupa08"; |FINSI;

   |DBASE dir_fich;
   dir_fich = dir_fich + "fich/";

   |PATH_DAT #1 fich_alta;
   |DELINDEX #1;

   |ABRE #1;
   fiche = vari1 + dir_fich + alfa4;
   |SI #0#5 = 1;
      fiche = fiche + ".amp";
   |SINO;
      fiche = fiche + ".abr";
   |FINSI;
   |QBF fiche;
   |FABRE fiche;
   |SI FSalida ] 0;
       handle = FSalida;
       |HAZ seagru;
       |PARA; |SI field > 0; |HACIENDO;
              |HAZ seagru;
       |SIGUE;
       |FCIERRA handle;
   |FINSI;
   |CIERRA #1;
   Pos = menos;

   alfa4 = "cuebalan";
   |SI nEjerActual ] 2008; alfa4 = "cuebal08"; |FINSI;

   |PATH_DAT #2 fich_alta;
   |DELINDEX #2;
   |ABRE #2;
   fiche=vari1 + dir_fich + alfa4;
   |SI #0#5 = 1;
      fiche = fiche + ".amp";
   |SINO;
      fiche = fiche + ".abr";
   |FINSI;
   |QBF fiche;
   |FABRE fiche;
   |SI FSalida ] 0;
       handle = FSalida;
       |HAZ secueb;
       |PARA; |SI field > 0; |HACIENDO;
              |HAZ secueb;
       |SIGUE;
       |FCIERRA handle;
   |FINSI;
   |CIERRA #2;
   Pos = menos;

   alfa4 = "epigrafe";
   |SI nEjerActual ] 2008; alfa4 = "epigra08"; |FINSI;
   |PATH_DAT #3 fich_alta;
   |DELINDEX #3;
   |ABRE #3;
   fiche=vari1 + dir_fich + alfa4;
   |SI #0#5 = 1;
      fiche = fiche + ".amp";
   |SINO;
      fiche = fiche + ".abr";
   |FINSI;
   |QBF fiche;
   |FABRE fiche;
   |SI FSalida ] 0;
       handle = FSalida;
       |HAZ seepig;
       |PARA; |SI field > 0; |HACIENDO;
              |HAZ seepig;
       |SIGUE;
       |FCIERRA handle;
   |FINSI;
   |CIERRA #3;
   Pos = menos;

   alfa4 = "parbalan";
   |SI nEjerActual ] 2008; alfa4 = "parbal08"; |FINSI;
   |PATH_DAT #4 fich_alta;
   |DELINDEX #4;
   |ABRE #4;
   fiche=vari1 + dir_fich + alfa4;
   |SI #0#5 = 1;
      fiche = fiche + ".amp";
   |SINO;
      fiche = fiche + ".abr";
   |FINSI;
   |QBF fiche;
   |FABRE fiche;
   |SI FSalida ] 0;
       handle = FSalida;
       |HAZ sebala;
       |PARA; |SI field > 0; |HACIENDO;
              |HAZ sebala;
       |SIGUE;
       |FCIERRA handle;
   |FINSI;
   |CIERRA #4;
   Pos = menos;

   alfa4 = "parexplo";
   |SI nEjerActual ] 2008; alfa4 = "parexp08"; |FINSI;
   |PATH_DAT #5 fich_alta;
   |DELINDEX #5;
   |ABRE #5;
   fiche=vari1 + dir_fich + alfa4;
   |SI #0#5 = 1;
      fiche = fiche + ".amp";
   |SINO;
      fiche = fiche + ".abr";
   |FINSI;
   |QBF fiche;
   |FABRE fiche;
   |SI FSalida ] 0;
       handle = FSalida;
       |HAZ seexpl;
       |PARA; |SI field > 0; |HACIENDO;
              |HAZ seexpl;
       |SIGUE;
       |FCIERRA handle;
   |FINSI;
   |CIERRA #5;
   Pos = menos;
|FPRC;

|PROCESO seagru;
   canal = handle + espacio;
   canal = canal + 44;
   |FLEE canal;
   field = FSalida;
   |SI field [ 0;  |ACABA;  |FINSI;
   traba = canal % 101;
   #caagrupa#0 = traba;
   traba = canal % 202;
   #caagrupa#1 = traba;
   |LEE 101#1=;
   |SI FSalida = 0;
      |HAZ seagru1;
      |GRABA 020#1a;
   |SINO;
      |DDEFECTO #1;
      |HAZ seagru1;
      |GRABA 020#1n;
   |FINSI;
   |LIBERA #1;
   saber = "Recuperando Agrupacion: " + #caagrupa#0 + " " + #caagrupa#1 + "         ";
   |PINTA 2211,saber;
|FPRC;

|PROCESO seagru1;
   traba = canal %101;
   #caagrupa#0 = traba;
   traba = canal %202;
   #caagrupa#1 = traba;
   traba = canal % 440;
   #caagrupa#2 = traba;
|FPRC;

|PROCESO secueb;
   canal = handle + espacio;
   canal = canal + 21;
   |FLEE canal;
   field = FSalida;
   |SI field [ 0;  |ACABA;  |FINSI;
   traba = canal % 112;
   #cacuebal#0 = traba;
   |LEE 101#2=;
   |SI FSalida = 0;
      |HAZ secueb1;

      |GRABA 020#2a;
   |SINO;
      |DDEFECTO #2;
      |HAZ secueb1;
      |GRABA 020#2n;
   |FINSI;
   |LIBERA #2;
   saber = "Recuperando Cuenta de Balance: " + #cacuebal#0 + "           ";
   |PINTA 2211,saber;
|FPRC;

|PROCESO secueb1;
   traba = canal %112;
   #cacuebal#0 = traba;
   traba = canal %1301;
   #cacuebal#1 = traba;
   traba = canal % 1401;
   #cacuebal#2 = traba;
   traba = canal %1502;
   #cacuebal#3 = traba;
   traba = canal %1702;
   #cacuebal#4 = traba;
   traba = canal % 1902;
   #cacuebal#5 = traba;
|FPRC;

|PROCESO seepig;
   canal = handle + espacio;
   canal = canal + 86;
   |FLEE canal;
   field = FSalida;
   |SI field [ 0;  |ACABA;  |FINSI;
   traba = canal % 101;
   #caepigra#0 = traba;
   traba = canal % 202;
   #caepigra#1 = traba;
   traba = canal % 4402;
   #caepigra#3 = traba;
   |LEE 101#3=;
   |SI FSalida = 0;
      |HAZ seepig1;
      |GRABA 020#3a;
   |SINO;
      |DDEFECTO #3;
      |HAZ seepig1;
      |GRABA 020#3n;
   |FINSI;
   |LIBERA #3;
   saber = "Recuperando Epigrafe: " + #caepigra#0 + "  " + #caepigra#1 + " " + #caepigra#3 + "        ";
   |PINTA 2211,saber;
|FPRC;

|PROCESO seepig1;
   traba = canal % 101;
   #caepigra#0 = traba;
   traba = canal % 202;
   #caepigra#1 = traba;
   traba = canal % 4402;
   #caepigra#3 = traba;
   traba = canal % 440;
   #caepigra#2 = traba;
   traba = canal % 4640;
   #caepigra#4 = traba;
|FPRC;

|PROCESO sebala;
   canal = handle + espacio;
   canal = canal + 128;
   |FLEE canal;
   field = FSalida;
   |SI field [ 0;  |ACABA;  |FINSI;
   traba = canal % 101;
   #caparbal#0 = traba;
   traba = canal % 202;
   #caparbal#1 = traba;
   traba = canal % 4402;
   #caparbal#3 = traba;
   traba = canal % 8602;
   #caparbal#5 = traba;
   |LEE 101#4=;
   |SI FSalida = 0;
      |HAZ sebala1;
      |GRABA 020#4a;
   |SINO;
      |DDEFECTO #4;
      |HAZ sebala1;
      |GRABA 020#4n;
   |FINSI;
   |LIBERA #4;
   saber = "Rec. Partidas Balance: " + #caparbal#0 + "  " + #caparbal#1 + " " + #caparbal#3 + " " + #caparbal#5 + "       ";
   |PINTA 2211,saber;
|FPRC;

|PROCESO sebala1;
   traba = canal % 101;
   #caparbal#0 = traba;
   traba = canal % 202;
   #caparbal#1 = traba;
   traba = canal % 4402;
   #caparbal#3 = traba;
   traba = canal % 8602;
   #caparbal#5 = traba;
   traba = canal % 440;
   #caparbal#2 = traba;
   traba = canal % 4640;
   #caparbal#4 = traba;
   traba = canal % 8840;
   #caparbal#6 = traba;
|FPRC;

|PROCESO seexpl;
   canal = handle + espacio;
   canal = canal + 129;
   |FLEE canal;
   field = FSalida;
   |SI field [ 0;  |ACABA;  |FINSI;
   traba = canal % 101;
   #caparexp#0 = traba;
   traba = canal % 201;
   #caparexp#1 = traba;
   traba = canal % 302;
   #caparexp#2 = traba;
   traba = canal % 4502;
   #caparexp#4 = traba;
   traba = canal % 8702;
   #caparexp#6 = traba;
   |LEE 101#5=;
   |SI FSalida = 0;
      |HAZ seexpl1;
      |GRABA 020#5a;
   |SINO;
      |DDEFECTO #5;
      |HAZ seexpl1;
      |GRABA 020#5n;
   |FINSI;
   |LIBERA #5;
   saber = "Rec. Partidas Explotacion: " + #caparexp#0 + "  " + #caparexp#1 + " " + #caparexp#2 + " " + #caparexp#4 + " " + #caparexp#6;
   |PINTA 2211,saber;
|FPRC;

|PROCESO seexpl1;
   traba = canal % 101;
   #caparexp#0 = traba;
   traba = canal % 201;
   #caparexp#1 = traba;
   traba = canal % 302;
   #caparexp#2 = traba;
   traba = canal % 4502;
   #caparexp#4 = traba;
   traba = canal % 8702;
   #caparexp#6 = traba;
   traba = canal % 540;
   #caparexp#3 = traba;
   traba = canal % 4740;
   #caparexp#5 = traba;
   traba = canal % 8940;
   #caparexp#7 = traba;
|FPRC;

***************************************************************************
CAPTURA DE FICHEROS BASICOS
***************************************************************************

||....... Plan Contable
|PROCESO creablanco;
      |DDEFECTO #6;
      #6#0 = "            ";
      #6#1 = 0;
      |LEE 101#6=;
      FEstado = FSalida;
      #6#3 = "S";
      |SI FEstado = 0;  |GRABA 020#6a;  |FINSI;
      |SI FEstado ! 0;  |GRABA 020#6n;  |FINSI;
      |LIBERA #6;
|FPRC;

|PROCESO plan_cont2;

   sw_vale = 0;
   alfa1 = #plancont#0;
   |QBF alfa1;
   alfa1 = alfa1 % 0;
   nume1 = alfa1;
   |SI nume1 = ddig4;  sw_vale = 1;  pepe = 1;  |FINSI;
   |SI nume1 = ddig5;  sw_vale = 1;  pepe = 2;  |FINSI;
   |SI nume1 = ddig6;  sw_vale = 1;  pepe = 3;  |FINSI;
   |SI nume1 = ddig7;  sw_vale = 1;  pepe = 4;  |FINSI;
   |SI nume1 = ddig8;  sw_vale = 1;  pepe = 5;  |FINSI;
   |SI nume1 = ddig9;  sw_vale = 1;  pepe = 6;  |FINSI;
   |SI sw_vale ! 1;  |ACABA;  |FINSI;
   #6#0 = #plancont#0;    || cuenta
   #6#1 = pepe;    || digito
   |LEE 101#6=;
   FEstado = FSalida;
   #6#2  = #plancont#2;   #6#3  = #plancont#3;   #6#4  = #plancont#4;   #6#5  = #plancont#5;   #6#6  = #plancont#6;
   #6#7  = #plancont#7;   #6#8  = #plancont#8;   #6#9  = #plancont#9;   #6#10 = #plancont#10;  #6#11 = #plancont#11;
   #6#12 = #plancont#12;  #6#13 = #plancont#13;  #6#14 = #plancont#14;  #6#15 = #plancont#15;  #6#16 = #plancont#16;
   #6#17 = #plancont#17;  #6#18 = #plancont#18;  #6#19 = #plancont#19;  #6#20 = #plancont#20;  #6#21 = #plancont#21;
   #6#22 = #plancont#22;  #6#23 = #plancont#23;  #6#24 = #plancont#24;  #6#25 = #plancont#25;  #6#26 = #plancont#26;
   #6#27 = #plancont#27;  #6#28 = #plancont#28;  #6#29 = #plancont#29;  #6#30 = #plancont#30;  #6#31 = #plancont#31;
   #6#32 = #plancont#32;  #6#33 = #plancont#33;  #6#34 = #plancont#34;  #6#35 = #plancont#35;  #6#36 = #plancont#36;
   #6#37 = #plancont#37;  #6#38 = #plancont#38;  #6#39 = #plancont#39;  #6#40 = #plancont#40;  #6#41 = #plancont#41;
   #6#42 = #plancont#42;  #6#43 = #plancont#43;  #6#44 = #plancont#44;  #6#45 = #plancont#45;  #6#46 = #plancont#46;
   #6#47 = #plancont#47;  #6#48 = #plancont#48;  #6#49 = #plancont#49;  #6#50 = #plancont#50;  #6#51 = #plancont#51;
   #6#52 = #plancont#52;  #6#53 = #plancont#53;  #6#54 = #plancont#54;  #6#55 = #6#1;          #6#56 = #plancont#56;
   #6#57 = #plancont#57;  #6#58 = #plancont#58;  #6#59 = #plancont#59;  #6#60 = #plancont#60;

   |SI pepe = ddig3;  #6#3 = "S"; |FINSI;

   |SI FEstado = 0;  |GRABA 020#6a;  |FINSI;
   |SI FEstado ! 0;  |GRABA 020#6n;  |FINSI;
   |LIBERA #6;
   saber = " Cuenta ...: " + #6#0 + " " + #6#1;
   |PINTA 2211, saber;
|FPRC;

|DEFBUCLE plan_cont1;
   #7#1;
   ;
   "            ";
   "zzzzzzzzzzzz";
   e;
   NULL, plan_cont2;
|FIN;

|PROCESO plan_cont;

   |PINTA 2211, "                                                              ";

   |SI #0#6 ! "S";  |ACABA;  |FINSI;

   eSwC2008 = 0;
   |DBASE dir_fich;
   dir_fich=dir_fich + "fich/";
   |PATH_DAT #plancont #dir_fich#;

   |SI nEjerActual ] 2008;
      alfa1 = "planco08";
      |SI #0#5 = 1; alfa1 = "planc108"; |FINSI;
      |NOME_DAT #7 alfa1;
      eSwC2008 = 2;
   |FINSI;

   |PATH_DAT #6 fich_alta;
   |ABRE #6;
   |HAZ creablanco;
   |BUCLE plan_cont1;
   |CIERRA #6;

|FPRC;

||//////////////////////////////// Asientos Predefinidos
||....... Predefinidos Lins.
|PROCESO prede_lin2_B;
  |BORRA 020#12a;
  |LIBERA #12;
|FPRC;

|DEFBUCLE prede_lin1_B;
   #12#1;
   ;
   #8#0,  0;
   #8#0, 99;
   be;
   NULL, prede_lin2_B;
|FIN;

|PROCESO prede_lin2;
   #casieali#0 = #predelin#0;   || nro. asiento predefinido
   #casieali#1 = #predelin#1;   || linea
   |LEE 101#12=;
   FEstado = FSalida;
   #casieali#0  = #predelin#0;   #casieali#1  = #predelin#1;   #casieali#2  = #predelin#2;   #casieali#3  = #predelin#3;   #casieali#4  = #predelin#4;
   #casieali#5  = #predelin#5;   #casieali#6  = #predelin#6;   #casieali#7  = #predelin#7;   #casieali#8  = #predelin#8;   #casieali#9  = #predelin#9;
   #casieali#10 = #predelin#10;  #casieali#11 = #predelin#11;  #casieali#12 = #predelin#12;  #casieali#13 = #predelin#13;  #casieali#14 = #predelin#14;
   #casieali#15 = #predelin#15;  #casieali#16 = #predelin#16;  #casieali#17 = #predelin#17;  #casieali#18 = #predelin#18;  #casieali#19 = #predelin#19;
   #casieali#20 = #predelin#20;  #casieali#21 = #predelin#21;  #casieali#22 = #predelin#22;  #casieali#23 = #predelin#23;  #casieali#24 = #predelin#24;
   #casieali#25 = #predelin#25;  #casieali#26 = #predelin#26;  #casieali#27 = #predelin#27;  #casieali#28 = #predelin#28;  #casieali#29 = #predelin#29;
   #casieali#30 = #predelin#30;  #casieali#31 = #predelin#31;  #casieali#32 = #predelin#32;  #casieali#33 = #predelin#33;  #casieali#34 = #predelin#34;
   #casieali#35 = #predelin#35;  #casieali#36 = #predelin#36;  #casieali#37 = #predelin#37;  #casieali#38 = #predelin#38;  #casieali#39 = #predelin#39;
   #casieali#40 = #predelin#40;  #casieali#41 = #predelin#41;  #casieali#42 = #predelin#42;  #casieali#43 = #predelin#43;  #casieali#44 = #predelin#44;
   #casieali#45 = #predelin#45;  #casieali#46 = #predelin#46;  #casieali#47 = #predelin#47;  #casieali#48 = #predelin#48;  #casieali#49 = #predelin#49;
   #casieali#50 = #predelin#50;  #casieali#51 = #predelin#51;  #casieali#52 = #predelin#52;  #casieali#53 = #predelin#53;  #casieali#54 = #predelin#54;
   #casieali#55 = #predelin#55;  #casieali#56 = #predelin#56;  #casieali#57 = #predelin#57;  #casieali#58 = #predelin#58;  #casieali#59 = #predelin#59;
   #casieali#60 = #predelin#60;  #casieali#61 = #predelin#61;  #casieali#62 = #predelin#62;
   #casieali#63 = #predelin#63;  #casieali#64 = #predelin#64;

   |SI FEstado = 0;  |GRABA 020#12a;  |FINSI;
   |SI FEstado ! 0;  |GRABA 020#12n;  |FINSI;
   |LIBERA #12;
   saber = " Predefinido Lin.: " + #casieali#0;
   saber = saber + " " + #casieali#1;
   |PINTA 2211, saber;
|FPRC;

|DEFBUCLE prede_lin1;
   #9#1;
   ;
   #8#0,  0;
   #8#0, 99;
   e;
   NULL, prede_lin2;
|FIN;

||....... Predefinidos Cabs.
|PROCESO prede_cab2;
   #casieaca#0 = #predecab#0;    || nro. asiento predefinido
   |LEE 101#11=;
   FEstado = FSalida;
   #casieaca#0  = #predecab#0;  #casieaca#1  = #predecab#1;  #casieaca#2  = #predecab#2;
   #casieaca#3  = #predecab#3;  #casieaca#4  = #predecab#4;  #casieaca#5  = #predecab#5;
   #casieaca#6  = #predecab#6;  #casieaca#7  = #predecab#7;  #casieaca#8  = #predecab#8;
   #casieaca#9  = #predecab#9;  #casieaca#10 = #predecab#10; #casieaca#11 = #predecab#11;
   #casieaca#12 = #predecab#12; #casieaca#13 = #predecab#13; #casieaca#14 = #predecab#14;
   #casieaca#15 = #predecab#15; #casieaca#16 = #predecab#16; #casieaca#17 = #predecab#17;
   #casieaca#18 = #predecab#18;

   |SI FEstado = 0;
      |GRABA 020#11a;
   |SINO;
      |GRABA 020#11n;
   |FINSI;
   |LIBERA #11;
   saber = " Predefinido Cab.: " + #casieaca#0;
   |PINTA 2211, saber;

   |BUCLE prede_lin1_B;

   |ABRE #12;
   |BUCLE prede_lin1;
   |CIERRA #12;
|FPRC;

|DEFBUCLE prede_cab1;
   #8#1;
   ;
   0;
   9999;
   e;
   NULL, prede_cab2;
|FIN;

|PROCESO prede_cab;
   |PINTA 2211, "                                                              ";
   |SI #0#7 ! "S";  |ACABA;  |FINSI;
   |DBASE dir_fich;
   dir_fich=dir_fich + "fich/";

   |PATH_DAT #predecab #dir_fich#;
   |PATH_DAT #predelin #dir_fich#;

   |PATH_DAT #casieaca #fich_alta#;
   |PATH_DAT #casieali #fich_alta#;

   |SI nEjerActual < 2008;
      alfa1 = "predec07"; |NOME_DAT #predecab #alfa1#;
      alfa1 = "predel07"; |NOME_DAT #predelin #alfa1#;
   |FINSI;

   |ABRE #11;
   |BUCLE prede_cab1;
   |CIERRA #11;
|FPRC;

||....... Grupos
|PROCESO prede_gru2;
   #999#0 = #predegru#0;   || grupo
   |LEE 101#999=;
   FEstado = FSalida;
   #999#0 = #predegru#0;
   #999#1 = #predegru#1;
   |SI FEstado = 0;  |GRABA 020#999a;  |FINSI;
   |SI FEstado ! 0;  |GRABA 020#999n;  |FINSI;
   |LIBERA #999;
   saber = " Grupos .........: " + #999#0;
   |PINTA 2211, saber;
|FPRC;

|DEFBUCLE prede_gru1;
   #14#1;
   ;
   "  ";
   "zz";
   e;
   NULL, prede_gru2;
|FIN;

|PROCESO prede_gru;

   |PINTA 2211, "                                                              ";
   |SI #0#7 ! "S";  |ACABA;  |FINSI;

   |DBASE aMas;
   dir_fich = aMas + "fich/";
   |PATH_DAT #predegru #dir_fich#;

   aDef     = aMas + "def/casiegru";
   |CARGA_DEF aDef, espejoa@;
   |SI FSalida ! 0;
       |ACABA;
   |FINSI;
   |PATH_DAT #999#fich_alta#;

   |ABRE #999;
   |BUCLE prede_gru1;
   |CIERRA #999;
   |DESCARGA_DEF #espejoa@;
|FPRC;

||....... Subgrupos
|PROCESO prede_sub2;
   #999#0 = #predesub#0;   || grupo
   |LEE 101#999=;
   FEstado = FSalida;
   #999#0 = #predesub#0;
   #999#1 = #predesub#1;
   |SI FEstado = 0;  |GRABA 020#999a;  |FINSI;
   |SI FEstado ! 0;  |GRABA 020#999n;  |FINSI;
   |LIBERA #999;
   saber = " Subgrupos ......: " + #999#0;
   |PINTA 2211, saber;
|FPRC;

|DEFBUCLE prede_sub1;
   #15#1;
   ;
   "    ";
   "zzzz";
   e;
   NULL, prede_sub2;
|FIN;

|PROCESO prede_sub;
   |PINTA 2211, "                                                              ";
   |SI #0#7 ! "S";  |ACABA;  |FINSI;

   |DBASE aMas;
   dir_fich = aMas + "fich/";
   |PATH_DAT #predesub #dir_fich#;

   aDef     = aMas + "def/casiesub";
   |CARGA_DEF aDef, espejoa@;
   |SI FSalida ! 0;
       |ACABA;
   |FINSI;
   |PATH_DAT #999#fich_alta#;

   |ABRE #999;
   |BUCLE prede_sub1;
   |CIERRA #999;
   |DESCARGA_DEF #espejoa@;
|FPRC;
|| ///////////////////////////////////////////////////////////////////////


|PROCESO prdeflal0;

   #cadeflal#0 = #prdeflal#0;
   |LEE 101#22=;
   FEstado = FSalida;
   #cadeflal#0  = #prdeflal#0;  #cadeflal#1  = #prdeflal#1;  #cadeflal#2  = #prdeflal#2;
   #cadeflal#3  = #prdeflal#3;  #cadeflal#4  = #prdeflal#4;  #cadeflal#5  = #prdeflal#5;
   #cadeflal#6  = #prdeflal#6;  #cadeflal#7  = #prdeflal#7;  #cadeflal#8  = #prdeflal#8;

   |SI FEstado = 0;
      |GRABA 020#22a;
   |SINO;
      |GRABA 020#22n;
   |FINSI;
   |LIBERA #22;
   saber = " Conceptos Laborales.: " + #cadeflal#0;
   |PINTA 2211, saber;
|FPRC;

|DEFBUCLE prdeflal;
   #23#1;
   ;
   001;
   999;
   e;
   NULL, prdeflal0;
|FIN;

|PROCESO conceptos;

   |PINTA 2211, "                                                              ";
   |SI #0#8 ! "S";  |ACABA;  |FINSI;
   |DBASE dir_fich;
   dir_fich=dir_fich + "fich/";

   |PATH_DAT #prdeflal #dir_fich#;
   |PATH_DAT #cadeflal #fich_alta#;
   |ABRE #22;
   |BUCLE prdeflal;
   |CIERRA #22;
|FPRC;

||///////////////////// Asientos Fijos
|PROCESO mautol_Borrar;
 |BORRA 020#108a;
 |LIBERA #108;
|FPRC;

|DEFBUCLE mautol_Borra;
   #108#1;
   ;
   #123#0, 0001;
   #123#0, 9999;
   be;
   NULL, mautol_Borrar;
|FIN;

|PROCESO mautol_lin2;
   #108#0 = #999#0;
   #108#1 = #999#1;
   |LEE 101#108=;
   FEstado = FSalida;
   |PARA para3 = 0; |SI para3 [ nNumCampos; |HACIENDO para3 = para3 + 1;
         #108para3  = #999para3;
   |SIGUE;

   |SI FEstado = 0;
      |GRABA 020#108a;
   |SINO;
      |GRABA 020#108n;
   |FINSI;
   |LIBERA #108;
   saber = " Fijos Lineas: " + #108#0+ " " + #108#1;
   |PINTA 2211, saber;
|FPRC;

|DEFBUCLE mautol_lin1;
   #999#1002;
   ;
   #123#0, 0001;
   #123#0, 9999;
   e;
   NULL, mautol_lin2;
|FIN;

||....... Fijos Cabecera
|PROCESO mautoc_cab2;

   #113#0 = #123#0;
   |LEE 101#113=;
   FEstado = FSalida;
   |PARA para3 = 0; |SI para3 [ nNumCamCab; |HACIENDO para3 = para3 + 1;
         #113para3  = #123para3;
   |SIGUE;

   |SI FEstado = 0;
      |GRABA 020#113a;
   |SINO;
      |GRABA 020#113n;
   |FINSI;
   |LIBERA #113;

   saber = " Fijos Cab.: " + #113#0;
   |PINTA 2211, saber;

   |BUCLE mautol_Borra;

   |ABRE #108;
   |BUCLE mautol_lin1;
   |CIERRA #108;
|FPRC;

|DEFBUCLE mautoc_cab1;
   #123#1;
   ;
   0;
   99999;
   e;
   NULL, mautoc_cab2;
|FIN;
|| //////////////////////////////
|PROCESO mauto1_Borrar;
 |BORRA 020#109a;
 |LIBERA #109;
|FPRC;

|DEFBUCLE mauto1_Borra;
   #109#1;
   ;
   #121#0, 0001;
   #121#0, 9999;
   be;
   NULL, mauto1_Borrar;
|FIN;

|PROCESO mauto1_lin2;

   #109#0 = #999#0;    || nro. asiento predefinido
   #109#1 = #999#1;    || nro. asiento predefinido
   |LEE 101#109=;
   FEstado = FSalida;
   |PARA para3 = 0; |SI para3 [ nNumCampos; |HACIENDO para3 = para3 + 1;
         #109para3  = #999para3;
   |SIGUE;

   |SI FEstado = 0;
      |GRABA 020#109a;
   |SINO;
      |GRABA 020#109n;
   |FINSI;
   |LIBERA #109;
   saber = " Fijos Especiales lineas: " + #109#0 + " "+ #109#1;
   |PINTA 2211, saber;
|FPRC;

|DEFBUCLE mauto1_lin1;
   #999#1002;
   ;
   #121#0, 0001;
   #121#0, 9999;
   e;
   NULL, mauto1_lin2;
|FIN;

|PROCESO mauto0_cab2;

   #111#0 = #121#0;    || nro. asiento predefinido
   |LEE 101#111=;
   FEstado = FSalida;
   |PARA para3 = 0; |SI para3 [ nNumCamCab; |HACIENDO para3 = para3 + 1;
         #111para3  = #121para3;
   |SIGUE;

   |SI FEstado = 0;
      |GRABA 020#111a;
   |SINO;
      |GRABA 020#111n;
   |FINSI;
   |LIBERA #111;
   saber = " Fijos Especiales Cab.: " + #111#0;
   |PINTA 2211, saber;

   |BUCLE mauto1_Borra;

   |ABRE #109;
   |BUCLE mauto1_lin1;
   |CIERRA #109;
|FPRC;

|DEFBUCLE mauto0_cab1;
   #121#1;
   ;
   0;
   99999;
   e;
   NULL, mauto0_cab2;
|FIN;


|PROCESO fijos_cab;
   |PINTA 2211, "                                                              ";
   |SI #0#11 ! "S";  |ACABA;  |FINSI;

   |DBASE dir_fich;
   dir_fich=dir_fich + "fich/";

   |PATH_DAT #prmauto0 #dir_fich#;
   |PATH_DAT #camauto0 #fich_alta#;
   |PATH_DAT #camauto1 #fich_alta#;

   aAlfa1 = "prmauto1";
   |SI nEjerActual < 2008;
       alfa1 = "prmau070"; |NOME_DAT #prmauto0 #alfa1#;
      aAlfa1 = "prmau071";
   |FINSI;

   |DBASE aMas;
   aDef = aMas + "def/camauto1";
   |CARGA_DEF aDef, espejoa@;
   |SI FSalida ! 0;
       |ACABA;
   |FINSI;
   |NOME_DAT #999 aAlfa1;
   |PATH_DAT #999 dir_fich;

   aQueQuiero = "|NC";
   aNumCampos = #camauto1#aQueQuiero#;
   nNumCampos = aNumCampos;
   nNumCampos = nNumCampos - 1;

   aQueQuiero = "|NC";
   aNumCampos = #camauto0#aQueQuiero#;
   nNumCamCab = aNumCampos;
   nNumCamCab = nNumCamCab - 1;

   |ABRE #111;
   |BUCLE mauto0_cab1;
   |CIERRA #111;

   |DESCARGA_DEF #999;

|| ... Fijos normal

   |PINTA 2211, "                                                              ";

   |DBASE dir_fich;
   dir_fich=dir_fich + "fich/";
   |PATH_DAT #prmautoc #dir_fich#;
   |PATH_DAT #camautoc #fich_alta#;
   |PATH_DAT #camautol #fich_alta#;

   aAlfa1 = "prmautol";
   |SI nEjerActual < 2008;
      alfa1 = "prmau07c"; |NOME_DAT #prmautoc #alfa1#;
     aAlfa1 = "prmau07l";
   |FINSI;

   |DBASE aMas;
   aDef = aMas + "def/camautol";
   |CARGA_DEF aDef, espejoa@;
   |SI FSalida ! 0;
       |ACABA;
   |FINSI;
   |NOME_DAT #999 aAlfa1;
   |PATH_DAT #999 dir_fich;

   aQueQuiero = "|NC";
   aNumCampos = #camautol#aQueQuiero#;
   nNumCampos = aNumCampos;
   nNumCampos = nNumCampos - 1;

   aQueQuiero = "|NC";
   aNumCampos = #camautoc#aQueQuiero#;
   nNumCamCab = aNumCampos;
   nNumCamCab = nNumCamCab - 1;

   |ABRE #113;
   |BUCLE mautoc_cab1;
   |CIERRA #113;

   |DESCARGA_DEF #999;
|FPRC;

|PROCESO mautotipo;
   #115#0 = #999#0;
   |LEE 101#115=;
   FEstado = FSalida;
   #115#0 = #999#0;
   #115#1 = #999#1;

   |SI FEstado = 0;
      |GRABA 020#115a;
   |SINO;
      |GRABA 020#115n;
   |FINSI;
   |LIBERA #115;
   saber = " Tipo de Asientos fijos: " + #115#0;
   |PINTA 2211, saber;
|FPRC;

|DEFBUCLE mautotipo;
   #999#1001;
   ;
   01;
   99;
   e;
   NULL, mautotipo;
|FIN;

|PROCESO fijos_tipo;
   |PINTA 2211, "                                                              ";
   |SI #0#11 ! "S";  |ACABA;  |FINSI;

   |DBASE dir_fich;
   dir_fich=dir_fich + "fich/";

   aAlfa1 = "prmautti";
   |DBASE aMas;
   aDef = aMas + "def/camautti";
   |CARGA_DEF aDef, espejoa@;
   |SI FSalida ! 0;
       |ACABA;
   |FINSI;
   |NOME_DAT #999 aAlfa1;
   |PATH_DAT #999 dir_fich;

   |PATH_DAT #camautti #fich_alta#;
   |ABRE #115;
   |BUCLE mautotipo;
   |CIERRA #115;

   |DESCARGA_DEF #999;
|FPRC;

|PROCESO ratios2;
   #110#0 = #999#0;
   |LEE 101#110=;
   FEstado = FSalida;
   |PARA para3 = 0; |SI para3 [ nNumCampos; |HACIENDO para3 = para3 + 1;
         #110para3  = #999para3;
   |SIGUE;

   |SI FEstado = 0;
      |GRABA 020#110a;
   |SINO;
      |GRABA 020#110n;
   |FINSI;
   |LIBERA #110;
   saber = " Calculo de Ratios: " + #110#0 + " "+ #110#1;
   |PINTA 2211, saber;
|FPRC;

|DEFBUCLE ratios1;
   #999#1001;
   ;
   0001;
   9999;
   e;
   NULL, ratios2;
|FIN;

|PROCESO formulas2;
   #116#0 = #999#0;
   |LEE 101#116=;
   FEstado = FSalida;
   |PARA para3 = 0; |SI para3 [ nNumCampos; |HACIENDO para3 = para3 + 1;
         #116para3  = #999para3;
   |SIGUE;

   |SI FEstado = 0;
      |GRABA 020#116a;
   |SINO;
      |GRABA 020#116n;
   |FINSI;
   |LIBERA #116;
   saber = " Formulas de Ratios: " + #116#0 + " "+ #116#1;
   |PINTA 2211, saber;
|FPRC;

|DEFBUCLE formulas1;
   #999#1001;
   ;
   0001;
   9999;
   e;
   NULL, formulas2;
|FIN;

|PROCESO ratios;

   |PINTA 2211, "                                                              ";
   |SI #0#13 ! "S";  |ACABA;  |FINSI;

   |DBASE dir_fich;
   dir_fich=dir_fich + "fich/";
   |PATH_DAT #116 fich_alta;
   |PATH_DAT #110 fich_alta;

   aAlfa1 = "prformul";
   |DBASE aMas;
   aDef = aMas + "def/caformul";
   |CARGA_DEF aDef, espejoa@;
   |SI FSalida ! 0;
       |ACABA;
   |FINSI;

   |NOME_DAT #999 aAlfa1;
   |PATH_DAT #999 dir_fich;
   |ABRE #116;
   aQueQuiero = "|NC";
   aNumCampos = #caformul#aQueQuiero#;
   nNumCampos = aNumCampos;
   nNumCampos = nNumCampos - 1;
   |BUCLE formulas1;
   |CIERRA #116;
   |DESCARGA_DEF #999;

   |PINTA 2211, "                                                              ";

   aAlfa1 = "prratios";
   aDef = aMas + "def/caratios";
   |CARGA_DEF aDef, espejoa@;
   |SI FSalida ! 0;
       |ACABA;
   |FINSI;
   |NOME_DAT  #999 aAlfa1;
   |PATH_DAT #999 dir_fich;
   |ABRE #110;
   aQueQuiero = "|NC";
   aNumCampos = #caratios#aQueQuiero#;
   nNumCampos = aNumCampos;
   nNumCampos = nNumCampos - 1;
   |BUCLE ratios1;
   |CIERRA #110;
   |DESCARGA_DEF #999;
|FPRC;


|PROCESO catesfin;
 #999#3 = 0;
 #999#4 = "01.01.1900";
 |GRABA 020#999a;
 |LIBERA #999;
|FPRC;

|DEFBUCLE catesfin;
  #999#1001;
  ;
  "            ";
  "zzzzzzzzzzzz";
  be;
  NULL, catesfin;
|FIN;

|PROCESO pone0_catesfin;
   |DBASE aMas;
   aDef = aMas + "def/catesfin";
   |CARGA_DEF aDef, espejoa@;
   |SI FSalida ! 0;
       |ACABA;
   |FINSI;
   |PATH_DAT #999 fich_alta;

   |BUCLE catesfin;
   |DESCARGA_DEF #999;
|FPRC;

|PROCESO Geconet;
     |DBASE aMas;
     aDef = aMas + "def/gadz0100.mas";
     |CARGA_DEF aDef, espejoa@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |PATH_DAT #espejoa@#fich_alta#;

     |ABRE #espejoa@;
     |LEE 000#espejoa@.=;
     |SI FSalida ! 0;
         |DDEFECTO #espejoa@;
         #espejoa@#1 = "dscomer9";
         #espejoa@#2 = #canempre#2;
         |GRABA 020#espejoa@.n;
         |LIBERA #espejoa@;
     |FINSI;
     |CIERRA #espejoa@;

     |DESCARGA_DEF #espejoa@;
|FPRC;

|PROGRAMA;
   |SI eaExterno ! "";
       fich_alta = eaExterno;
   |FINSI;

   |HAZ inicio;
   ddig3 = dig3;
   ddig4 = dig4;
   ddig5 = dig5;
   ddig6 = dig6;
   ddig7 = dig7;
   ddig8 = dig8;
   ddig9 = dig9;
   nNivelMD = MaximoDigitos;

   aAlfa5 = eaDepar;
   nEjerActual = enEjercicio;
   aMonedaA    = eaMoneda;

   num_por = #canempre#2;
   num_per = #canempre#3;
   |SI any_pos = 0; any_pos = #canempre#26; |FINSI;
   any_por  = any_pos;
   num_por1 = num_por;
   any_por1 = any_por;
   swprogra = 1;

   |HAZ Analitica;  || Comprobar para copiar ficheros Analitica

   |C_M #0#12, 1, "N";
   |SI nEjerActual ] 2008;
       |C_M #0#12, 1, "S";
       |ABRE #400;
       |DDEFECTO #400;
       #400#0 = num_por;
       #400#1 = num_per;
       |LEE 000#400=;
       |SI FSalida ! 0;
           #400#0 = num_por;
           #400#1 = num_per;
           |GRABA 020#400n;
       |FINSI;
       |CIERRA #400;
       #0#12 = #400#2;
   |FINSI;

   |SI eaExterno ! "";
       |SI eaOtras = "";  eaOtras   = "S"; |FINSI;
       fich_alta = eaExterno;
       #0#0      = enEmpreOri;
       #0#1      = enPerioOri;
       #0#3      = eaCopiar;
       #0#4      = eaCeros;
       #0#9      = eaOtras;
       #0#10     = eaDepar;
       |ABRE #400;
       |DDEFECTO #400;
       #400#0 = #0#0;
       #400#1 = #0#1;
       |LEE 000#400=;
       |SI FSalida = 0;
           #0#12 = #400#2;
       |FINSI;
       |CIERRA #400;

       |HAZ Geconet;        || Geconet
   |SINO;
       |CLS;
       |CABEZA "Pantalla Creacion";
       |PINPA #0#0;
       |PINDA #0#0;
       |ENDATOS #1#0;
       |SI FSalida ! 0;  |ACABA;  |FINSI;
   |FINSI;

   |SI #0#0 = 0;
      |QBF fich_alta;
      |SI fich_alta = "";
          |DFICE fich_alta;
      |FINSI;
      |SI #0#5 ! 0;
          |HAZ creacion;   || agrupaciones, epigrafes, partidas y cuentas bal.
      |FINSI;

      |HAZ plan_cont;      || plan contable

      |HAZ prede_cab;      || predefinidos cabs
      |HAZ prede_gru;      || grupos
      |HAZ prede_sub;      || subgrupos
      |HAZ conceptos;      || Conceptos Salariales
      |HAZ fijos_cab;      || asientos fijos cabs
      |HAZ fijos_tipo;     || tipo asientos fijos
      |HAZ ratios;         || Ratios
      |VETE Elfin;
   |FINSI;

|| =========================================================================
|| ====== Copiando de otra Empresa
|| =========================================================================
   cod1 = 1000000 + (#0#0 * 10) + #0#1;
   cod_emp1 = cod1;
   cod_emp2 = cod_emp1 % 206;
   |DBASE dir_fich;
   dir_fich = dir_fich + "fich/" + cod_emp2;
   |QBF fich_alta;
   |SI fich_alta = "";
       |DFICE fich_alta;
   |FINSI;
   fich_copi = dir_fich + "/";

   |SI #0#3 = "T";
       dire = "";
       |DBASS dir_fich;
       |DBASE aNOMAPLIC;
       aNOMAPLIC = aNOMAPLIC - dir_fich;
       aNOMAPLIC = aNOMAPLIC - "/";
       aNOMAPLIC = aNOMAPLIC + ".dir";
       |DFICB dire;
       fiche = dire + aNOMAPLIC;
       |LEESECUENCIAL fiche, buf_dir, ele_dir, 1, 0;
       |SI ele_dir > 0;
           |PARA para1 = 1; |SI para1 [ ele_dir; |HACIENDO para1 = para1 + 5;
                 para2 = para1 + 3;
                 |DEL_BUF buf_dir, para2, alfa1;
                 alfa1 = alfa1 % 101;
                 |SI alfa1 = "1";|O alfa1 = "2";
                     |DEL_BUF buf_dir, para1, alfa1;
                     traba1 = alfa1;    |HAZ copiando;
                 |FINSI;
           |SIGUE;
       |SINO;
           alfa1 = "    [" + fiche + "] NO accesible en lectura.";
           |MENAV alfa1;
       |FINSI;
       |FINDIM buf_dir;
   |FINSI;

   |SI #0#3 = "M";
       |HAZ copia_maes;
       |SI eSwC2008 = 1;
           |HAZ creacion;   || .... Copia las estructuras
       |FINSI;
   |FINSI;
                            || ..... atencion falta poner el directorio a los ficheros
   |HAZ acerar4;
   |SI #0#4 = "S";
       |HAZ pone0_maes;   ||Borrar acumulados
       |HAZ pone0_catesfin;
   |FINSI;

   |SI #0#3 = "M";
       |HAZ poneEP_maes;  || Cambiar moneda si procede
   |FINSI;

   |SI #0#9 = "S";
       eaCopiar    = #0#3;
       enEmpreOri  = #0#0;
       alfa1 = fich_alta % -107;
       alfa1 = alfa1 % 105;
       enEmpreDes  = alfa1;
       eaNombreEmp = #canempre#1;
       |HAZ copia_otros;
   |FINSI;

   |SI #0#10 = "S";
       eaDepar    = aAlfa5;
       alfa1      = fich_alta % -107;
       alfa1      = alfa1 % 105;
       enEmpresa  = alfa1;

       |PINTA 2211, " CREANDO ESTRUCTURA EXISTENCIAS POR CADA ACTIVIDAD ... ";
       |SUB_EJECUTA "caz00006";
   |FINSI;
   |HAZ ActDefecto;

|ET Elfin;

   |ABRE #400;
   |DDEFECTO #400;
   #400#0 = num_por;
   #400#1 = num_per;
   |LEE 101#400=;
   |SI FSalida = 0;
       #400#2 = #0#12;
       fFecha = ~;
       aAlfa1 = Usuario % 810;
       #400#6 = fFecha;
       #400#7 = aAlfa1;
       |GRABA 020#400a;
   |FINSI;
   |LIBERA #400;
   |CIERRA #400;

   |SI eSwC2008 ! 0;
       eNum2208   = 0;
       eNum2008   = #0#12;
       enEmpreOri = #0#0;
       enPerioOri = #0#1;
       |PINTA 2211, " ADAPTANDO PLAN CONTABLE 2008. Cuenta:                 ";
       |SUB_EJECUTA_NP "ca8zcamb";
   |FINSI;

   enEjercicio = nEjerActual;
   |SUB_EJECUTA "caw00010;crea";
|FPRO;
