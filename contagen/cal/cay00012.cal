|FICHEROS;
   cay00012 #0;
   camw0006 #6;
   canempre #30;
|FIN;

|VARIABLES;
   nInkey    = 0;
   aAlfa     = "";

   aBlancs   = "";
   aZetas    = "";
   nSwAlguna = 0;
   informe   = "cay00012";

   nDEjer    = 0;
   nHEjer    = 0;
   nDEmpresa = 0;
   nHEmpresa = 0;
   fDFecha   = @;
   fHFecha   = @;
   aDUsuar   = "";
   aHUsuar   = "";
   &enEjer   = 0;
|FIN;

|INCLUYE dscont_i;

|| ********************************************************************
|| **** DATOS PANTALLA
|| ********************************************************************

|PROCESO Defectos; |TIPO 7;
     |ABRE #6;
     |SELECT #3#6;
     |LEE 041#6p;
     |SI FSalida = 0;
         #0#6 = #6#37; |PINTA #0#6;
     |FINSI;
     |LEE 041#6u;
     |SI FSalida = 0;
         #0#7 = #6#37; |PINTA #0#7;
     |FINSI;
     |SELECT #1#6;
     |CIERRA #6;
|FPRC;

|PROCESO ElEjer;
   aAlfa = #0#0; aAlfa = aAlfa % -102; #0#4 = aAlfa;
   aAlfa = #0#1; aAlfa = aAlfa % -102; #0#5 = aAlfa;
|FPRC;

|PROCESO Inf6;
   #6#2  = nDEmpresa;
   #6#26 = nDEjer;
   #6#37 = fDFecha;
   #6#38 = aDUsuar;
|FPRC;

|PROCESO Sup6;
   #6#2  = nHEmpresa;
   #6#26 = nHEjer;
   #6#37 = fHFecha;
   #6#38 = aHUsuar;
|FPRC;

|PROCESO VeoEmpresa;
   nInkey = FSalida;

   |SI nInkey = 10;
       nDEjer    = 00;           nHEjer    = 99;
       nDEmpresa = 0;            nHEmpresa = 99999;
       fHFecha   = "01.01.0000"; fHFecha   = "31.12.2999";
       aDUsuar   = "        ";   aHUsuar   = "zzzzzzzz";
       |SI Campo ] 1; nDEjer = #0#4;    |FINSI;
       |SI Campo ] 2; nHEjer = #0#5;    |FINSI;
       |SI Campo ] 3; nDEmpresa = #0#2; |FINSI;
       |SI Campo ] 6; nHEmpresa = #0#3; |FINSI;

       |ABRE #6;
       |SI Campo = 0; |O Campo = 1;
           aAlfa = #0Campo; aAlfa = aAlfa % -102;
           #6#26 = aAlfa;
       |FINSI;
       |SI Campo = 2; |O Campo = 3;  #6#2  = #0Campo;  |FINSI;

       |CONSULTA_F_CLAVE #3#6,Inf6, Sup6;
       |SI Campo = 0; |O Campo = 1;  #0Campo = 2000 + #6#26;  |FINSI;
       |SI Campo = 2; |O Campo = 3;  #0Campo = #6#2;          |FINSI;
       |PINTA #0Campo;
       |CIERRA #6;
  |FINSI;
|FPRC;
|| ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

|PROCESO LasRecojo0;
  |SI #06#26 < 80;
      enEjer = 2000 + #6#26;
  |SINO;
      enEjer = 1900 + #6#26;
  |FINSI;
  |PRINT;
  nSwAlguna = 1;
|FPRC;

|DEFBUCLE camw0006_1;
   #6#1;
   37,38;
   #0#2, #0#4, #0#6, #0#8;
   #0#3, #0#5, #0#7, #0#9;
   e;
   NULL, LasRecojo0;
|FIN;

|DEFBUCLE camw0006_2;
   #6#2;
   2, 37,38;
   aBlancs, #0#4, #0#2, #0#6, #0#8;
   aZetas,  #0#5, #0#3, #0#7, #0#9;
   e;
   NULL, LasRecojo0;
|FIN;

|DEFBUCLE camw0006_3;
   #6#3;
   ;
   #0#6, #0#8, #0#2, #0#4;
   #0#7, #0#9, #0#3, #0#5;
   e;
   NULL, LasRecojo0;
|FIN;

|| ////////////////////////////////////////////////////////////////////////
|CALCULO VoyaListar; |TIPO 3;
  aBlancs = " " * 40;
  aZetas  = "z" * 40;

  |IMPRE 0;
  |SI FSalida ! 0;
      |MENAV "0000No existe Impresora";
      |ACABA;
  |FINSI;

  |INFOR informe;
  |SI FSalida ! 0;
      |MENAV "0000No existe Informe";
      |FINIMP;
      |ACABA;
  |FINSI;

  nSwAlguna = 0;
  |SI #0#12 = 1; |BUCLE camw0006_1; |FINSI;
  |SI #0#12 = 2; |BUCLE camw0006_2; |FINSI;
  |SI #0#12 = 3; |BUCLE camw0006_3; |FINSI;

  |SI nSwAlguna ! 0;
      |PIEINF;
  |FINSI;

  |FININF;
  |FINIMP;
|FCAL;
