|FICHEROS;
    cafanmas #86,MANTE;
|FIN;

|VARIABLES;
    d_desde = 0;
    d_hasta = 0;
    d_nume1 = 0;
    d_trozo = "";
    d_masca = "";
    d_masc1 = "";
    d_alfa1 = "";
    d_cuent = "";
    d_error = 0;
    d_inkey = 0;
    d_campo = 0;
    d_para1 = 0;
|FIN;

|PROCESO digitos1; |TIPO 0;             || carga variables
    d_inkey = FSalida;
    d_nume1 = Campo - 2;    d_desde = #0d_nume1;  || a partir de ...
    d_nume1 = Campo - 1;    d_hasta = #0d_nume1;  || nro. digitos

    |SI d_inkey = 13;
        |SI d_desde ! 0; |Y d_hasta ! 0;
            |HAZ digitos3;
        |SINO;
             |ERROR;
        |FINSI;
    |FINSI;

    d_masca = #0Campo;      |QBF d_masca;         || mascara
    d_nume1 = (d_desde * 100) + d_hasta;
    d_trozo = d_nume1;
|FPRC;

|PROCESO digitos2;

    eaCuenta = #1#0; |HAZ SacaNivel;
    |SI eaCuenta > "            ";
        |SI enNivel ! #1#1; |O enNivel = 0;
            |SI nYaLoHeDicho = 0;
                |MENAV "    Atencion. Existen Cuentas con Errores.!!!. Lance el Testear Plan Contable";
            |FINSI;
            nYaLoHeDicho = 1;
            #1#1 = enNivel;
        |FINSI;
    |FINSI;

    d_error = 0;                   || switch de error
    d_cuent = #1#0;                || cuenta
    d_alfa1 = d_cuent % d_trozo;   || mascara

    |SI d_desde ! 0;|Y d_hasta ! 0;

        d_error = 1;               || no es valida la cuenta

        |SI d_alfa1 = d_masca; d_error = 0; |FINSI;

        d_masc1 = #86#1; |QBF d_masc1;
        |SI d_masc1 ! ""; |Y d_alfa1 = d_masc1; d_error = 0; |FINSI;

        d_masc1 = #86#2; |QBF d_masc1;
        |SI d_masc1 ! ""; |Y d_alfa1 = d_masc1; d_error = 0; |FINSI;

        d_masc1 = #86#3; |QBF d_masc1;
        |SI d_masc1 ! ""; |Y d_alfa1 = d_masc1; d_error = 0; |FINSI;

        d_masc1 = #86#4; |QBF d_masc1;
        |SI d_masc1 ! ""; |Y d_alfa1 = d_masc1; d_error = 0; |FINSI;
    |FINSI;
|FPRC;

|PROCESO digitos3;

 d_campo = Campo;        #86#0 = #0d_campo;
 d_nume1 = d_campo - 2;  #86#5 = #0d_nume1;
 d_nume1 = d_campo - 1;  #86#6 = #0d_nume1;

 |PUSHV 13512380;
 |PINPA #0#cafanmas;
 |PINDA #0#cafanmas;
 |ENDATOS #1#86;

 Campo = d_campo; #0Campo = #86#0;
 |POPV;
 |PINTA #0Campo;
|FPRC;

|PROCESO masmascaras;
   |SI #86Campo = "            ";
       |PARA d_para1 = Campo + 1; |SI d_para1 [ 4; |HACIENDO d_para1 = d_para1 + 1;
             |C_M #86d_para1, 1, "N"; #86d_para1 = ""; |PINTA #86d_para1;
       |SIGUE;
   |SINO;
       |PARA d_para1 = Campo + 1; |SI d_para1 [ 4; |HACIENDO d_para1 = d_para1 + 1;
             |C_M #86d_para1, 1, "S";
       |SIGUE;
   |FINSI;
|FPRC;

|PROCESO digitos12; |TIPO 12;
|FPRC;
