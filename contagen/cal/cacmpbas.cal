|FICHEROS;
   cacmpbas #0;
   camaniva #1;
   caivalin #2;
   camaasil #3;

   canempre #30;
   caselem1 #998;
|FIN;

|VARIABLES;
  fDFecha = @;
  swAlgun = 0;
   &SwLin = 0;
   &SwCab = 0;
   &SwTot = 0;
|FIN;

|INCLUYE dscont_i;

|| *************************************************************************

|CALCULO Defectos; |TIPO 7;
    |HAZ eLeeParametro;
    fDFecha = fec1;
    |SI enSwSelFc = 1; fDFecha = "01.01.2000"; |FINSI;

    #0#4 = fDFecha; |PINTA #0#4;
    #0#5 = fec2;    |PINTA #0#5;
|FCAL;

|CALCULO fecha; |TIPO 0;

    fDFecha = fec1;
    |SI enSwSelFc = 1; fDFecha = "01.01.2000"; |FINSI;

    |SI #0Campo < fDFecha; |O #0Campo > fec2;
        |MENAV "    Fecha fuera del ejercicio";
        |ERROR;
        |ACABA;
    |FINSI;
    |SI Campo = 5;
        |SI #0#5 < #0#4;
            |MENAV "    Fecha Erronea.! ";
            |ERROR;
        |FINSI;
   |FINSI;
|FCAL;
|| *************************************************************************

|PROCESO Bases;
   SwLin = 1;
   |PRINT;
   SwLin = 0;
|FPRC;

|DEFBUCLE Bases;
 #camaasil#5;
 19;
 #1#0, #1#2, #1#3, "B";
 #1#0, #1#2, #1#3, "B";
 ;
 NULL,Bases;
|FIN;

|PROCESO Facturas;
   SwCab = 1;
   |PRINT;
   SwCab = 0;
   |BUCLE Bases;
   SwTot = 1;
   |PRINT;
   SwTot = 0;
   swAlgun = 1;
|FPRC;

|DEFBUCLE Facturas;
 #1#1;
 2,3,4;
 #0#0, 0000000001,#0#6,#0#2,#0#4;
 #0#0, 9999999999,#0#7,#0#3,#0#5;
 ;
 NULL,Facturas;
|FIN;

|PROCESO HazTodo;
  swAlgun = 0;
  |BUCLE Facturas;
  |SI swAlgun = 1;
      |PIEINF;
  |FINSI;
|FPRC;


|| *******************************************************************

|CALCULO impre; |TIPO 3;

   |IMPRE 0;
   |SI FSalida ! 0; |ACABA; |FINSI;

   |INFOR "cacmpbas";
   |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;

   |SI #48#27 = "S";
       |HAZ MultiEmpresa;
   |SINO;
       |DFICE dirfich0; |QBF dirfich0;
       |HAZ HazTodo;
   |FINSI;

   |FINIMP;
   |FININF;
|FCAL;

|| **********************************************************************

|PROCESO MultiEmp1;
   cod1 = #caselem1#1;
   cod2 = #caselem1#2;
   emEmp = 1;  || Sin mensaje
   |HAZ leelo;
   |SI swerror ! 0;  |ACABA;   |FINSI;

   dirfich0 = #caselem1#3;
   |QBF dirfich0;

   |PATH_DAT #1 dirfich0;
   |PATH_DAT #2 dirfich0;
   |PATH_DAT #3 dirfich0;
   |HAZ HazTodo;
|FPRC;

|DEFBUCLE MultiEmp0;
 #caselem1#1;
 ;
 000001;
 999999;
 ;
 NULL,MultiEmp1;
|FIN;

|PROCESO MultiEmpresa;
  |SUB_EJECUTA "caselemp";
  |NOME_DAT #998 eaFichsel;
  |BUCLE MultiEmp0;
  |DELINDEX #998;
|FPRC;
