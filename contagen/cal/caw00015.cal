|FICHEROS;
   caz00007 #0;
   caw00015 #900,MANTE;
   anm00001 #2;
|FIN;

|VARIABLES;
   aAlfa1    = "";
   aAlfa2    = "";
   nInkey    = 0;
   &snFiltr = "";
   &snFilAc = "";
   &snFilBa = "";
|FIN;

|INCLUYE dscont_i;
|INCLUYE dscoan_i;

____________________________________/ CALCULOS DESDE PANTALLA

|CALCULO c_departa; |TIPO 7;
   |CAMPO_MODIFICA #900#6, 1, eaDepar;
   |SI eaDepar  = "S";
      |SI Haybasica = 1;
          |MENSA "    <F2> Consultar Actividades; <F7> Recuperar Departamento Anterior";
      |SINO;
          |MENSA "    <F2> Consultar Departamentos; <F7> Recuperar Departamento Anterior";
      |FINSI;
   |FINSI;
|FCAL;

|CALCULO c_subdepar; |TIPO 7;
   |CAMPO_MODIFICA #900#7, 1, eaSubde;

   |SI eaSubde  = "S";
      |SI Haybasica = 1;
          |SI enArrend = 1;
              |MENSA "    <F2> Consultar Referencias Catastrales. <F7> Recuperar anterior";
          |SINO;
              |MENSA "    <F2> Consultar Cultivos. <F7> Recuperar Anterior";
          |FINSI;
      |FINSI;
   |FINSI;
|FCAL;

|CALCULO pActividad; |TIPO 0;
   nInkey = FSalida;
   |SI eaDepar = "N"; |ACABA; |FINSI;
   |SI nInkey = 15;
       |SI #0#11 = "A"; #900#6 = #900#19; |FINSI;
       |SI #0#11 = "F"; #900#6 = #900#24; |FINSI;
       |PINTA #900#6;
       |ACABA;
   |FINSI;

   eOpDep = 0; || 1 = Consulta pantalla
   |SI nInkey = 10;  eOpDep = 1; |FINSI;
   enActividad = #900#6;
   eaCodDep    = #900#6;
   |HAZ Actividad;
   |SI eaCodDep = ""; eswLect = 0; |FINSI;
   |SI eswLect = 1;
       |MENAV "    Error.! No Existe Actividad / Departamento";
       |ERROR;
   |SINO;
       #900#6 = eaCodDep; |PINTA #900#6;
       |SI efActFin > "01.01.1900"; |Y snFilBa ! "N";
           aAlfa1 = "    NAtencion!!!. Actividad con Fecha de BAJA " + efActFin + ", Desea introducir Facturas ? ";
           |CONFI aAlfa1;
           |SI FSalida ! 0;
               |ERROR;
               |ACABA;
           |FINSI;
       |FINSI;
       |SI eaEsCom = "S";
           |CONFI "    NAtencion!!!. Actividad Comunera, ¨ Desea introducir Facturas ? ";
           |SI FSalida ! 0;
               |ERROR;
               |ACABA;
           |FINSI;
       |FINSI;

   |FINSI;
|FCAL;

|CALCULO pSubActividad; |TIPO 0;
   nInkey = FSalida;
   |SI eaSubde = "N"; |ACABA; |FINSI;
   |SI nInkey = 15;
       |SI #0#11 = "A"; #900#7 = #900#20; |FINSI;
       |SI #0#11 = "F"; #900#7 = #900#25; |FINSI;
       |PINTA #900#7;
       |ACABA;
   |FINSI;

   eOpSub = 0; || 1 = Consulta pantalla
   |SI FSalida = 10; eOpSub = 1; |FINSI;

   enConcepto  = #900#11;
   eaCodSubdep = #900#7;
   enQue = 1;
   |HAZ SubActividad;
   enQue = 0;
   |SI eswLect = 1;
       |MENAV "    Error.! No Existe SubDepartamento";
       |ERROR;
   |SINO;
       #900#7 = eaCodSubdep; |PINTA #900#7;
   |FINSI;
|FCAL;

|CALCULO anacta; |TIPO 6;
  nInkey = FSalida;
  |SI nInkey = 15;
      |SI #0#11 = "A"; #900#8 = #900#21; |FINSI;
      |SI #0#11 = "F"; #900#8 = #900#26; |FINSI;
      |PINTA #900#8;
      |ACABA;
  |FINSI;

  salidas = FSalida;
  |HAZ FPuntosAna;
|FCAL;

|CALCULO ctaana; |TIPO 0;
 |C_M #900#8,0,aAlfa1;
 |SI aAlfa1 = "N"; |ACABA; |FINSI;

 |ABRE #2;
 #2#0 = #900#8;
 |LEE 001#2=;
 |SI FSalida ! 0;
     |MENAV "    Error. No existe cuenta analitica";
     |ERROR;
 |FINSI;
 |CIERRA #2;
|FCAL;

|CALCULO refer; |TIPO 0;
  nInkey = FSalida;
  |SI nInkey = 15;
      |SI #0#11 = "A"; #900#23 = #900#22; |FINSI;
      |SI #0#11 = "F"; #900#23 = #900#27; |FINSI;
      |PINTA #900#23;
  |FINSI;
|FCAL;

|PROCESO pidetecla; |TIPO 11;
 |SI FSalida ! 10; |ACABA; |FINSI;
 |LIBERA #900;
 |LEE 110#900=;
 |SI #900#9 = "N";
     #900#9 = "S";
 |SINO;
     #900#9 = "N";
 |FINSI;
 |PTEC 809;
 |PINTA #900#9;

 |GRABA 020#900a;
|FPRC;
