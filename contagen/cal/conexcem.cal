|FICHEROS;
   conexcem #0;
   conexcel #1;

   canempre #30;
   caselem1 #998;
|FIN;

|VARIABLES;
  aAlfa1 = "";
  aAlfa2 = "";
  aAlfa3 = "";
  aAlfa4 = "";
|FIN;

|INCLUYE dscont_i;

|PROCESO LeeCodigo; |TIPO 6;
 |ABRE #1;
 #1#33 = #0#0;
 |LEE 001#1=;
 |SI FSalida ! 0;
     |MENAV "    Error. No existe Definicion";
     |ERROR;
 |SINO;
     #0#1 = #1#34;
     |SI #1#35 = "N";
         |CONFI "0000SEsta definicion no es Multiempresa. Continuar S/N ";
         |SI FSalida ! 0;
             |ERROR;
         |FINSI;
     |FINSI;
 |FINSI;
 |CIERRA #1;
|FPRC;

|PROCESO HazTodo;
  aAlfa1 = #0#0; |QBF aAlfa1;
  aAlfa1 = ("0000" + aAlfa1 ) % -104;

  aAlfa2 = enEmpresa; |QBF aAlfa2; aAlfa2 = ("00000" + aAlfa2) % -105;
  aAlfa3 = enPeriodo; |QBF aAlfa3; aAlfa3 = ("0"     + aAlfa3) % -101;

  aAlfa4 = "conexcel;" + aAlfa1 + "E" + aAlfa2 + aAlfa3;

  |SUB_EJECUTA_NP aAlfa4;
|FPRC;

|PROCESO ElImprimir; |TIPO 12;
   |SI #0#2 = "N"; |ACABA; |FINSI;

   |SI #48#27 = "S";
      |HAZ MultiEmpresa;
   |SINO;
      |DFICE dirfich0;
      |HAZ HazTodo;
   |FINSI;
|FPRC;

|| ***********************************************************************
|PROCESO MultiEmp1;
   cod1 = #caselem1#1;
   cod2 = #caselem1#2;
   emEmp = 1;  || Sin mensaje
   |HAZ leelo;
   |SI swerror ! 0;  |ACABA;   |FINSI;

   dirfich0 = #caselem1#3; |QBF dirfich0;
   |HAZ HazTodo;
|FPRC;

|DEFBUCLE MultiEmp0;
 #caselem1#1;
 ;
 001;
 999;
 ;
 NULL,MultiEmp1;
|FIN;

|PROCESO MultiEmpresa;
  |SUB_EJECUTA "caselemp";
  |NOME_DAT #998 eaFichsel;
  |BUCLE MultiEmp0;
  |DELINDEX #998;
|FPRC;
