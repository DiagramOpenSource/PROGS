|FICHEROS;
   luxeg002 #0;

   calibros #10;

   :/modelos/def/dsmom030 #10;
|FIN;

|VARIABLES;
   nCalc   = 0;
   nCalc1  = 0;
   nCont   = 0;
   nMaxDig = 0;

   aAlfa  = "";
   aAlfa1 = "";
   aAlfa2 = "";
|FIN;

|PROCESO TrasLibro;
   |ABRE #calibros;
   #calibros#0 = #luxeg002#13;
   |LEE 000#calibros.=;
   |SI FSalida ! 0;
      |MENAV "    Error. Libro inexistente"; |ERROR;
   |SINO;
      |SI #calibros#2 ! "S";
         |MENAV "    Error. El libro seleccionado no es de soportado"; |ERROR;
      |FINSI;
   |FINSI;
   |CIERRA #calibros;
|FPRC;

|PROCESO FiltraPuntos; |TIPO 6;
   nMaxDig = 0;
   |PARA nCont = 14; |SI nCont [ 19; |HACIENDO nCont = nCont + 1;
      |SI #48nCont > nMaxDig; nMaxDig = #48nCont; |FINSI;
   |SIGUE;

   aAlfa = #luxeg002#Campo#; |QBF aAlfa;

   aAlfa = aAlfa - ".";
   |PARA; |SI FSalida ! 0; |HACIENDO;
      nCalc = FSalida + 98;               aAlfa2 = aAlfa % nCalc;
      nCalc = ((FSalida / 100) ! 0) + 99; aAlfa1 = aAlfa % nCalc;
      aAlfa = aAlfa1 + aAlfa2; |QBF aAlfa; aAlfa = aAlfa % 0; nCalc1 = aAlfa;
      nCalc1 = nMaxDig - nCalc1;
      aAlfa = aAlfa1 + ("0" * nCalc1) + aAlfa2;

      aAlfa = aAlfa - ".";
   |SIGUE;

   #luxeg002#Campo# = aAlfa; |PINTA #luxeg002#Campo#;
|FPRC;

|PROCESO ConsCptos; |TIPO 66;
   |ABRE #dsmom030;
   |CONSULTA_CLAVE #1#dsmom030;
   |SI FSalida = 0;
      #luxeg002#Campo# = #dsmom030#0; |PINTA #luxeg002#Campo#;
      nCalc = Campo + 1;
      #luxeg002#nCalc# = #dsmom030#1; |PINTA #luxeg002#nCalc#;
   |FINSI;
   |CIERRA #dsmom030;
   |ERROR;
|FPRC;

|PROCESO MiraCptos;
   |SI FSalida = 2; |ACABA; |FINSI;

   |ABRE #dsmom030;
   #dsmom030#0 = #luxeg002#Campo#;
   |LEE 000#dsmom030.=;
   |SI FSalida = 0;
      nCalc = Campo + 1;
      |SI #luxeg002#Campo# ! Contenido;
         #luxeg002#nCalc# = #dsmom030#1; |PINTA #luxeg002#nCalc#;
      |FINSI;
      |SI #luxeg002#Campo# = 1;
         |C_M #luxeg002#nCalc#, 1, "S";
      |SINO;
         |C_M #luxeg002#nCalc#, 1, "N";
      |FINSI;
   |SINO;
      |MENAV "    Concepto inexistente"; |ERROR;
   |FINSI;
   |CIERRA #dsmom030;
|FPRC;

|PROGRAMA;
   |ABRE #luxeg002;
   |LEE 000#luxeg002.p;
   |SI FSalida ! 0;
      |DDEFECTO #luxeg002;
      |GRABA 020#luxeg002.c;
   |FINSI;

   |CLS;
   |CABEZA " CUENTAS POR DEFECTO ";
   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      |GRABA 020#luxeg002.a;
   |FINSI;
   |CIERRA #luxeg002;
|FPRO;
