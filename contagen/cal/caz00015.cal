|FICHEROS;
  caz00015 #0;

  cam00010 #10,MANTE;
  cam00011 #11,MANTE;
  cam00012 #12,MANTE;
  cam00013 #13,MANTE;

  caz0015@ #915;
|FIN;

|VARIABLES;
 nDEmpresa = 0;
 nHEmpresa = 0;
 nDPeriodo = 0;
 nHPeriodo = 0;
 nDPer     = 0;
 nHPer     = 0;
 aDPer     = "";
 aHPer     = "";
 nSwGraba  = 0;

 nInkey   = 0;
 nSwSal   = 0;
 aFichero = "";
 aAlfUlt  = "";
 aAlfa1   = "";
 nModoEntrada = 0;

 aTipo   = "";
 nSwSOLO = 0;
 aParam  = "";
 nVale   = 0;
 inform1 = "caz00015";
 inform2 = "caz10015";
 informe = "";
 aDef    = "";
 aMas    = "";

 &nSwLinea = 0;
 &aTexto   = "";
 &nSwTit   = 0;

 &aCamp1 = "";
 &nCamp2 = 0;
 &nCamp3 = 0;
 &aCamp4 = "";
 nHay    = 0;
|FIN;

|INCLUYE dscont_i;

|| /////////////////////// PROCESOS DE TRABAJO \\\\\\\\\\\\\\\\\\\\
|| ******************************************** Calculos Pantalla
|CALCULO wTipo12; |TIPO 12;
|FCAL;

|RUTINA ClaveBajaAxC;
 #10#0 = #0#0;
 #10#1 = #0#1;
 #10#11 = 0;
 #10#13 = 00;
|FRUT;

|RUTINA ClaveAltaAxC;
 #10#0  = #0#0;
 #10#1  = #0#1;
 #10#11 = 9;
 #10#13 = 99;
|FRUT;

|PROCESO wTipo3; |TIPO 11;
 nInkey = FSalida;
 |SI nInkey = 10;
     nSwSal = 0;
     |ENTLINEAL #1#10, -4, 4, 22, 0, ClaveBajaAxC, ClaveAltaAxC;
     |ERROR;
 |FINSI;
 |SI nInkey = 12;
     |HAZ wTipo1;
 |FINSI;
 |SI nInkey = 13; |O nInkey = 14;
     |HAZ wTipo4;
     |ERROR;
 |FINSI;
|FPRC

|CALCULO PresentaLinea;  |TIPO 7;
 |ENTLINEAL #1#10, -4, 7, 22, 0, ClaveBajaAxC, ClaveAltaAxC;
|FCAL;

|| //////////////////////
|PROCESO Borrolin12;
 |BORRA 020#12a;
 |LIBERA #12;
|FPRC;

|DEFBUCLE borrarL12;
 #12#1;
 ;
 #10#0, #10#1, #10#13, 000001;
 #10#0, #10#1, #10#13, 999999;
 be;
 NULL, Borrolin12;
|FIN;

|PROCESO Borrolin11;
 |BORRA 020#11a;
 |LIBERA #11;
|FPRC;

|DEFBUCLE borrarL11;
 #11#1;
 ;
 #13#0, #13#1, #13#2, #13#3, #13#4, 01;
 #13#0, #13#1, #13#2, #13#3, #13#4, 99;
 be;
 NULL, Borrolin11;
|FIN;

|PROCESO Borrolin13;
 |BUCLE borrarL11;
 |BORRA 020#13a;
 |LIBERA #13;
|FPRC;

|DEFBUCLE borrarL13;
 #13#1;
 ;
 #10#0, #10#1, aTipo, #10#13, 000001;
 #10#0, #10#1, aTipo, #10#13, 999999;
 be;
 NULL, Borrolin13;
|FIN;

|PROCESO BorraElemento;
 |SI #10#11 = 1;  |BUCLE borrarL12; |FINSI;
 |SI #10#11 ! 1;
     aTipo = "R"; |SI #10#11 = 3; aTipo = "S"; |FINSI;
     |BUCLE borrarL13;
 |FINSI;

 |BORRA 020#10a;
 |LIBERA #10;
|FPRC;

|DEFBUCLE borrarElementos;
 #10#1;
 ;
 #0#0, #0#1, 0, 00;
 #0#0, #0#1, 9, 99;
 be;
 NULL, BorraElemento;
|FIN;

|CALCULO wTipo1;
     |CONFI "    NEsta Seguro de Borrar los Registros de esta Empresa ";
     |SI FSalida ! 0;
         |ERROR;
         |ACABA;
     |FINSI;
     |BUCLE borrarElementos;
|FCAL;

|| **************************************************************************
|PROCESO Leo12;
 nSwLinea=12;
 |PRINT;
 nSwTit = 1;
 nHay   = 1;
|FPRC;

|DEFBUCLE Leo12;
 #12#1;
 ;
 #10#0, #10#1, #10#13, 000001;
 #10#0, #10#1, #10#13, 999999;
 e;
 NULL, Leo12;
|FIN;

|PROCESO Leo11;
 |PRINT;
 nSwLinea=11;
 nSwTit = 1;
 nHay   = 1;
|FPRC;

|DEFBUCLE Leo11;
 #11#1;
 ;
 #13#0, #13#1, #13#2, #13#3, #13#4, 01;
 #13#0, #13#1, #13#2, #13#3, #13#4, 99;
 e;
 NULL, Leo11;
|FIN;

|PROCESO Leo13;
 nSwLinea=13;
 |BUCLE Leo11;
|FPRC;

|DEFBUCLE Leo13;
 #13#1;
 ;
 #10#0, #10#1, aTipo, #10#13, 000001;
 #10#0, #10#1, aTipo, #10#13, 999999;
 e;
 NULL, Leo13;
|FIN;

|PROCESO Leo10;
 nSwLinea=10;
 |PRINT;
 |SI nInkey = 13; |ACABA; |FINSI;

 nHay = 0;
 nSwTit = 0;
 |SI #10#11 = 1;
     |BUCLE Leo12;
     |SI nHay = 1; nSwLinea = 1; |PRINT; |FINSI;
 |FINSI;
 |SI #10#11 ! 1;
     aTipo = "R"; |SI #10#11 = 3; aTipo = "S"; |FINSI;
     |BUCLE Leo13;
     |SI nHay = 1; nSwLinea = 1; |PRINT; |FINSI;
 |FINSI;
|FPRC;

|DEFBUCLE Leo10;
 #10#1;
 ;
 nDEmpresa, nDPeriodo, 0, 00;
 nHEmpresa, nHPeriodo, 9, 99;
 e;
 NULL, Leo10;
|FIN;

|PROCESO LeoEspejo;
 aCamp1 = #915#0; |QBF aCamp1;
 aCamp1 = ("00000" + aCamp1) % -105;
 nCamp2 = #915#1;
 nCamp3 = #915#2;
 aCamp4 = #915#3;
 nDEmpresa = #915#0; nDPeriodo = #915#1;
 nHEmpresa = #915#0; nHPeriodo = #915#1;
 nSwLinea = 0;
 |PRINT;
 |BUCLE Leo10;
|FPRC;

|DEFBUCLE LeoEspejo;
 #915#1002;
 ;
 00001, nDPer;
 99999, nHPer;
 ;
 NULL, LeoEspejo;
|FIN;

|PROCESO wTipo4;
  ||.... Imprimir relacion
  |SI nInkey = 13;

      aTexto = "RELACION DE EMPRESAS CON REGISTRO DE PASE";
      |SI nSwSOLO = 1; aTexto = "RELACION DE EMPRESAS CON DIREFRENCIAS EN REGISTROS DE PASE"; |FINSI;
      informe = inform1;

      |PUSHV  0511 0934;
      |CUADRO 0511 0934;
      |ATRI R; |PINTA 0612, " Selecciones Periodos "; |ATRI 0;
      |PINTA 0712, " Desde Periodo:       ";
      |PINTA 0812, " Hasta Periodo;       ";
      |PINTA 0728, #0#1;
      |PINTA 0828, #0#1;
      E_sup  = 1;
      E_inf  = "0123456789";
      aDPer  = #0#1; aDPer  = 0728 ? 0;
      aHPer  = #0#1; aHPer  = 0828 ? 0;
      |POPV;
  |SINO;
      aTexto = "REGISTROS DE DIFERENCIAS DE LA EMPRESA";
      informe = inform2;
  |FINSI;

  |IMPRE 0;
  |SI FSalida ! 0; |ACABA; |FINSI;
  |INFOR informe;
  |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;

  |SI nInkey = 14;
      #915#0 = #0#0; #915#1 = #0#1;
      #915#2 = #0#2; #915#3 = #0#3;
      |HAZ LeoEspejo;
  |SINO;
       nDPer = aDPer; nHPer = aHPer;
      |BUCLE LeoEspejo;
  |FINSI;
  |PIEINF;
  |FININF;
  |FINIMP;
|FPRC;
|| **************************************************************************

|| *****************************************************************

|PROCESO GrabaTempo;
     nVale = 0;
     |SI nSwSOLO = 1; |Y #10#24 = " "; nVale = 1; |FINSI;
     |SI nVale = 0;
         #0#0 = #10#0;
         #0#1 = #10#1;
         |LEE 001#0=;
         |SI FSalida ! 0;
             #0#0 = #10#0;
             #0#1 = #10#1;
             |SI #10#3 < 80;
                 #0#2 = 2000 + #10#3;
             |SINO;
                 #0#2 = 1900 + #10#3;
             |FINSI;
             #0#3 = #10#2;
             |GRABA 020#0n;
             nSwGraba = 1;
         |FINSI;
    |FINSI;
|FPRC;

|DEFBUCLE cam00010;
    #10#1;
    ;
    nDEmpresa, nDPeriodo, 0, 00;
    nHEmpresa, nHPeriodo, 9, 99;
    ;
    NULL, GrabaTempo;
|FIN;

|| ----------------------------------------------------------------------
|RUTINA ClaveBajaC;
  |SI FSalida = "POSICION";
      #0#0 = enEmpresa;
      #0#1 = enPeriodo;
  |SINO;
      #0#0 = 1;
      #0#1 = 0;
  |FINSI;
|FRUT;

|RUTINA ClaveAltaC;
     #0#0 = 99999;
     #0#1 = 9;
|FRUT;

|PROGRAMA;
 nSwSOLO = 0;
 aParam = PARAMETRO; |QBF aParam;
 |SI aParam = "error"; nSwSOLO = 1; |FINSI;
 |HAZ inicio;

 aFichero = ("15z" + Usuario) % 108;
 |NOME_DAT #0 aFichero;
 |ABRE #0;  |CIERRA #0;  |DELINDEX #0;

 |DBASE aMas;
 aDef = aMas + "def/caz00015";
 |CARGA_DEF aDef, caz0015@;
 |SI FSalida ! 0;
     |ACABA;
 |FINSI;
 |NOME_DAT #915 aFichero;


 nSwGraba = 0;
 |ABRE #0;
 nDEmpresa = 00000; nDPeriodo = 0;
 nHEmpresa = 99999; nHPeriodo = 9;
 |BUCLE cam00010;
 |CIERRA #0;

 |CLS;
 |CABEZA "Registro de Diferencias";
 |PINPA #0#0;
 |SI nSwSOLO = 1;
     aAlfa1 = "Registro de Diferencias en el Pase a Contabilidad";
 |SINO;
     aAlfa1 = "Registro del Pase a Contabilidad                 ";
 |FINSI;
 |ATRI S; |PINTA 0904,aAlfa1; |ATRI 0;
 || **************************************************  Tipo3;
 |ENTLINEAL #1#0, -1, 4, 7, 0, ClaveBajaC, ClaveAltaC;

 |DESCARGA_DEF #915;
|FPRO;
