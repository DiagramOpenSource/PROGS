|FICHEROS;
 anz00001 #0;
 anm00001 #1;

 canempre #30;
 caselem1 #998;
|FIN;

|VARIABLES;
 aAlfa1 = "";
 aAlfa2 = "";
 nNume1 = 0;
 nNume2 = 0;
 cta = "";
|FIN;

|INCLUYE dscont_i;
|INCLUYE dscoan_i;

|| *********************************************************************

|CALCULO escero; |TIPO 7;
 nNume1 = Campo - 5;
 |SI #0nNume1 = 0;
      aAlfa1 = "N";
      #0Campo = 0;
      |PINTA #0Campo;
 |SINO;
      aAlfa1 = "S";
 |FINSI;
 |CAMPO_MODIFICA #0Campo,1,aAlfa1;
|FCAL;

|CALCULO lalongi; |TIPO 0;
 |CAMPO_MODIFICA #0Campo,0,aAlfa1;
 |SI aAlfa1 = "N"; |ACABA; |FINSI;
 nNume1 = Campo - 5;
 nNume2 = #0nNume1 + #0Campo - 1;
 |SI nNume2 > 7;
     |MENAV "    Longitud Erronea, sobrepasa la Cuenta Analitica";
     |ERROR;
 |FINSI;
 |SI #0nNume1 ! 0; |Y #0Campo = 0; |ERROR; |FINSI;
|FCAL;

|| **********************************************************************

|PROGRAMA;
  |CLS;
  |CABEZA "Calculo Grupos Roturas";
  |HAZ inicio;
  |HAZ Analitica;
  |SI  enSwAna = 0;
       aAlfa1 = "    CONTABILIDAD NO ANALITICA ";
       |SI eaAnNiv = "E";
           aAlfa1 = "    EMPRESA NO ANALITICA ";
       |FINSI;
       |MENAV aAlfa1;
       |ACABA;
  |FINSI;

  |ABRE #0;
  #0#0 = 1;
  |LEE 111#0=;
  |SI FSalida ! 0;
      |DDEFECTO #0;
      |GRABA 011#0b;
  |FINSI;

  |PINPA #0#0;
  |PINDA #0#0;
  |ENDATOS #1#0;
  |SI FSalida = 0;
      |GRABA 011#0a;
      |HAZ calculo_rot;
  |FINSI;

  |LIBERA #0;
  |CIERRA #0;
|FPRO;

|| ***********************************************************************

|PROCESO actualiza;
 |ATRI I;
 |PINTA 2018, #1#0;
 |ATRI 0;
 #1#2 = "";
 #1#3 = "";
 #1#4 = "";
 #1#5 = "";
 #1#6 = "";
 |SI #0#1 ! 0; |Y #0#6 ! 0;           || Campo 1
     nNume2 = #0#1 * 100 + #0#6;
     #1#2  = #1#0 % nNume2;
 |FINSI;
 |SI #0#2 ! 0; |Y #0#7 ! 0;           || Campo 2
     nNume2 = #0#2 * 100 + #0#7;
     #1#3  = #1#0 % nNume2;
 |FINSI;
 |SI #0#3 ! 0; |Y #0#8 ! 0;           || Campo 3
     nNume2 = #0#3 * 100 + #0#8;
     #1#4  = #1#0 % nNume2;
 |FINSI;
 |SI #0#4 ! 0; |Y #0#9 ! 0;           || Campo 4
     nNume2 = #0#4 * 100 + #0#9;
     #1#5  = #1#0 % nNume2;
 |FINSI;
 |SI #0#5 ! 0; |Y #0#10 ! 0;           || Campo 5
     nNume2 = #0#5 * 100 + #0#9;
     #1#6  = #1#0 % nNume2;
 |FINSI;
 |GRABA 020#1a;
 |LIBERA #1;
|FPRC;

|DEFBUCLE ctaana;
 #1#1;
 ;
 "       ";
 "zzzzzzz";
 e;
 NULL, actualiza;
|FIN;

|PROCESO HazTodo;
 |ATRI P; |PINTA 1804, "Empresa: "; |ATRI 0;
 |PINTA 1813, #30#2;
 |PINTA 1819, #30#1;
 |BUCLE ctaana;
|FPRC;

|PROCESO calculo_rot;
 |CUADRO 1904 2132;
 |PINTA 2005, " En Proceso:         ";

   |SI #48#27 = "S";
       |HAZ MultiEmpresa;
   |SINO;
       |DFICE dirfich0; |QBF dirfich0;
       |HAZ HazTodo;
   |FINSI;
|FPRC;

|| **********************************************************************

|PROCESO MultiEmp1;
   cod1 = #caselem1#1;
   cod2 = #caselem1#2;
   emEmp = 1;  || Sin mensaje
   |HAZ leelo;
   |SI swerror ! 0;  |ACABA;   |FINSI;

   dirfich0 = #caselem1#3;
   |QBF dirfich0;

   |PATH_DAT #1 dirfich0;
   |HAZ HazTodo;
|FPRC;

|DEFBUCLE MultiEmp0;
 #caselem1#1;
 ;
 000001;
 999999;
 ;
 NULL,MultiEmp1;
|FIN;

|PROCESO MultiEmpresa;
  |SUB_EJECUTA "caselemp";
  |NOME_DAT #998 eaFichsel;
  |BUCLE MultiEmp0;
  |DELINDEX #998;
|FPRC;
