|FICHEROS;
     catvim01;

     reflejo@  #20;
     catplw06;
|FIN;

|VARIABLES;
     nTecla     = 0;
     aAlfa      = "";
     aDef       = "";
     aPath      = "";
     aDExt      = "";
     aHExt      = "";
     nPara1     = 0;
     aQueQuiero = "";
     aNumCampos = "";
     nNumCampos = 0;
|FIN;

|RUTINA ClaveBaja20;
     #20#0 = aDExt;
     #20#1 = 01;
     #20#7 = "01.01.0000";
     #20#8 = "     ";
     #20#9 = "        ";
|FRUT;

|RUTINA ClaveAlta20;
     #20#0 = aHExt;
     #20#1 = 99;
     #20#7 = "31.12.2099";
     #20#8 = "zzzzz";
     #20#9 = "zzzzzzzz";
|FRUT;

|PROCESO Tipo11;  |TIPO 11;
     nTecla = FSalida;

     |SI nTecla < 10; |O nTecla > 13; |ACABA;  |FINSI;

     |DBASE aPath;  |QBT aPath;
     aDef = aPath + "def/catvim01.mas";
     |CARGA_DEF aDef, reflejo@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def catvim01.mas";
         |MENAV aAlfa;
         |ERROR;
     |FINSI;

     |PUSHV 0501 2380;
     |SI nTecla = 10;
         |ATRI P;
         |PINTA 0703, "MODO CONSULTA  <ORDENADO POR FECHA>";
         |ATRI p;

         |ENTLINEAL #2#20, -1, 4, 22, 0, ClaveBaja20, ClaveAlta20;
     |FINSI;
     |SI nTecla = 11;
         |ATRI P;
         |PINTA 0703, "MODO CONSULTA  <ORDENADO POR USUARIO>";
         |ATRI p;

         |ENTLINEAL #3#20, -1, 4, 22, 0, ClaveBaja20, ClaveAlta20;
     |FINSI;
     |SI nTecla = 12;
         |ABRE #20;
         |CONSULTA_F_CLAVE #2#20, ClaveBaja20, ClaveAlta20;
         |SI FSalida = 0;
             #catvim01#0 = #20#0;
             #catvim01#1 = #20#1;
             |LEE 000#catvim01.=;
         |FINSI;
         |CIERRA #20;
     |FINSI;

     |SI nTecla = 13;
         |LEE 000#catvim01.=;
         |PARA nPara1 = 0; |SI nPara1 [ nNumCampos; |HACIENDO nPara1 = nPara1 + 1;
               #catplw06#nPara1# = #catvim01#nPara1#;
         |SIGUE;
         |PINPA #0#catplw06;
         |PINDA #0#catplw06;
         |PAUSA;
     |FINSI;

     |ERROR;
     |POPV;
     |DESCARGA_DEF #reflejo@;
|FPRC;

|RUTINA ClaveBaja0;
     #catvim01#0 = aDExt;
     #catvim01#1 = 01;
|FRUT;

|RUTINA ClaveAlta0;
     #catvim01#0 = aHExt;
     #catvim01#1 = 99;
|FRUT;

|PROGRAMA;
     |ABRE #catvim01;
     |LEE 040#catvim01.p;
     |SI FSalida ! 0;
         |MENAV "0000No existen datos";
         |CIERRA #catvim01;
         |ACABA;
     |FINSI;
     |CIERRA #catvim01;

     aQueQuiero = "|NC";
     aNumCampos = #catvim01#aQueQuiero#;
     nNumCampos = aNumCampos;
     nNumCampos = nNumCampos - 1;

     aDExt = " " * 40;
     aHExt = "z" * 40;
     |ENTLINEAL #1#catvim01, -2, 4, 22, 1, ClaveBaja0, ClaveAlta0;
|FPRO;
