|FICHEROS;
   refer00@ #900;
   refer01@ #901;
|FIN;

|VARIABLES;
   aTexImp  = "";
   aPathImp = "";
   nHay01   = 0;
   nHay02   = 0;
   nHay03   = 0;
   nHay04   = 0;
   nEmpImp  = 0;
   nEjeImp  = 0;
|FIN;

|| ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::1
|PROCESO BSodacoli;
    |BORRA 020#901a;
    |LIBERA #901;
|FPRC;

|DEFBUCLE BSodacoli;
    #901#1003;
    ;
    #900#0, #900#1, 0001;
    #900#0, #900#1, 9999;
    be;
    NULL, BSodacoli;
|FIN;

|PROCESO BSodacoca;
    aPathImp = aPContas + "fich/";

    aElProgr = aPContas + "def/sodacoca.mas";
    |CARGA_DEF aElProgr, refer00@;
    |SI FSalida ! 0;
        |MENAV "    Error. No se ha podido cargar sodacoca";
        |ACABA;
    |FINSI;

    aElProgr = aPContas + "def/sodacoli.mas";
    |CARGA_DEF aElProgr, refer01@;
    |SI FSalida ! 0;
        |MENAV "    Error. No se ha podido cargar sodacoli";
        |DESCARGA_DEF #refer00@;
        |ACABA;
    |FINSI;

    |PATH_DAT #900 aPathImp;
    |PATH_DAT #901 aPathImp;

    |ABRE #900;
    #900#0 = nEmpImp;
    #900#1 = nEjeImp;
    |LEE 041#900=;
    |SI FSalida = 0;

        |BUCLE BSodacoli;
        |BORRA 020#900a;
        aTexImp = "    Registros de Entrada Gral de Datos Contables borrados. ";
        |SI nHay04 = 1;
            aTexImp = aTexImp + "Actualizar Datos Contables en CCAA y/o I.S.";
        |FINSI;
        |MENAV aTexImp;

    |FINSI;
    |LIBERA #900;
    |CIERRA #900;

    |DESCARGA_DEF #refer01@;
    |DESCARGA_DEF #refer00@;
|FPRC;

|| -----------------------------------------------------------------------
|PROCESO MiroImpuesto;
   aPathImp = aPContas + "fich/";
   aTexImp = "";

   aElProgr = aPContas + "def/sodacoca.mas";
   |CARGA_DEF aElProgr, refer00@;
   |SI FSalida = 0;
       |PATH_DAT #900 aPathImp;
       |ABRE #900;
       #900#0 = nEmpImp;
       #900#1 = nEjeImp;
       |LEE 041#900=;
       |SI FSalida = 0; nHay01 = 1; |FINSI;
       |CIERRA #900;
       |DESCARGA_DEF #900;
   |FINSI;

   aElProgr = aPContas + "def/isom0001.mas";
   |CARGA_DEF aElProgr, refer00@;
   |SI FSalida = 0;
       |PATH_DAT #900 aPathImp;
       |ABRE #900;
       #900#0 = nEmpImp;
       #900#1 = nEjeImp;
       #900#2 = 0;
       |LEE 041#900];
       |SI FSalida = 0; |Y nEmpImp = #900#0; |Y nEjeImp = #900#1;
           nHay02 = 1; nHay04 = 1;
           aTexImp = "Impuesto de Sociedades";
       |FINSI;
       |CIERRA #900;
       |DESCARGA_DEF #900;
   |FINSI;

   aElProgr = aPContas + "def/cuacceso.mas";
   |CARGA_DEF aElProgr, refer00@;
   |SI FSalida = 0;
       |PATH_DAT #900 aPathImp;
       |ABRE #900;
       #900#0 = nEmpImp;
       #900#1 = nEjeImp;
       |LEE 041#900=;
       |SI FSalida = 0;
           nHay03 = 1; nHay04 = 1;
           |SI nHay02 = 1; aTexImp = aTexImp + " y "; |FINSI;
           aTexImp = aTexImp + "Cuentas Anuales ";
       |FINSI;
       |CIERRA #900;
       |DESCARGA_DEF #900;
   |FINSI;
|FPRC;
