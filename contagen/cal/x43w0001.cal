|FICHEROS;
     x43w0001;
     cacuenta;

     :modelos/dsmom030;
|FIN;

|VARIABLES;
     nCmp1               = 0;

     aAlfa               = "";
     aAlfa1              = "";

     &ext1               = "";
     &ext2               = "";
     &snFilBa            = "";
|FIN;

|INCLUYE dscont_i;

|PROCESO T0C41; |TIPO 0;
     |SI eaSubde = "N"; |ACABA; |FINSI;

     enConcepto  = #x43w0001#40;
     eaCodSubdep = #x43w0001#41;
     enQue = 1;
     |HAZ SubActividad;
     enQue = 0;
     |SI eswLect = 1;
         |MENAV "    Error.! No Existe SubDepartamento";
         |ERROR;
     |SINO;
         #x43w0001#41 = eaCodSubdep;
         |PINTA #x43w0001#41;
     |FINSI;
|FPRC;

|PROCESO T0C40; |TIPO 0;
     |SI eaDepar = "N"; |ACABA; |FINSI;
     |SI FSalida = 2;   |ACABA; |FINSI;

     |HAZ DirAplicSt;

     eOpDep      = 0;                            || 1 = Consulta pantalla
     enActividad = #x43w0001#40;
     eaCodDep    = #x43w0001#40;
     |HAZ Actividad;
     |SI eswLect = 1;
         |MENAV "    Error.! No Existe Actividad / Departamento";
         |C_M #x43w0001#Campo#, 1, "S";
         |ERROR;
     |SINO;
         #x43w0001#40 = eaCodDep;
         |PINTA #x43w0001#40;
     |FINSI;
|FPRC;

|PROCESO T0Cpto;  |TIPO 0;
     |C_M #x43w0001#Campo#, 0, aAlfa;
     |SI aAlfa = "N"; |ACABA; |FINSI;

     |SI #x43w0001#Campo# = 0;
         |ACABA;
     |FINSI;

     |ABRE #dsmom030;
     #dsmom030#0 = #x43w0001#Campo#;
     |LEE 000#dsmom030.=;
     |SI FSalida ! 0;
         |MENAV "0000El concepto introducido no existe.";
         |ERROR;
     |FINSI;
     |CIERRA #dsmom030;

     nCmp1 = Campo + 1;
     #x43w0001#nCmp1# = #dsmom030#1;
     |PINTA #x43w0001#nCmp1#;
|FPRC;

|PROCESO T0Cuenta;  |TIPO 0;
     |C_M #x43w0001#Campo#, 0, aAlfa;
     |SI aAlfa = "N"; |ACABA; |FINSI;

     |SI #x43w0001#Campo# = "            ";
         |ACABA;
     |FINSI;

     |ABRE #cacuenta;
     #cacuenta#0 = #x43w0001#Campo#;
     |LEE 000#cacuenta.=;
     |SI FSalida ! 0;
         |MENAV "0000La cuenta introducida no existe.";
         |ERROR;
     |FINSI;
     |CIERRA #cacuenta;

     |SI Campo = 30;  |O Campo = 31;
         #x43w0001#32 = #cacuenta#2;
         |PINTA #x43w0001#32;
     |FINSI;

     |SI Campo = 35;  |O Campo = 36;
         #x43w0001#37 = #cacuenta#2;
         |PINTA #x43w0001#37;
     |FINSI;
|FPRC;

|PROCESO T6Cuenta;  |TIPO 6;
     |C_M #x43w0001#Campo#, 0, aAlfa;
     |SI aAlfa = "N"; |ACABA; |FINSI;

     eaCuenta = #x43w0001#Campo#;
     salidas  = FSalida;
     |HAZ FiltraPuntosX;
     #x43w0001#Campo# = eaCuenta;
     |PINTA #x43w0001#Campo#;
|FPRC;
