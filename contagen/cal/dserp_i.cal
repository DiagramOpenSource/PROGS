|FICHEROS;

     Referen@ #1000;

     camaniva #33;       ||Para obtener los campos que faltan.
|FIN;

|VARIABLES;
     aAlfaAux = "";
     nNumAux = 0;

     aSwMostrarAC = "";
     {4}aPopup = "";

     &enDesdeGrid = 0;

     aAplica = "";
     nEmpresa = 0;
     aEmpresa = "";

     aRels  = "";
     aAlfa6 = "";

     nNumRels = 0;
     nCont    = 0;
     nCalc    = 0;
     nCalc1   = 0;
     nOpcion  = 0;

     aParametro = "";
     aAlfa = "";
     nSalida = 0;
     aPrograma = "";
     aBase = "";
     aPathDef = "";
     aPathFic = "";
     aQueQuiero = "";
     aNomDef = "";
     aMensaje = "";
     aFichRel = "";

     aAlfa5 = "";
     aClaves = "";
     aTCompo = "";
     nTCompo = 0;
     aTCompo2 = "";
     nTCompo2 = 0;
     {16}clave = 0;      ||Array de 16 elementos para la clave.
     nCompo = 0;
     nPosi = 0;
     aTCampos = "";
     nTCampos = 0;
     nCampo = 0;
     aAlfa1 = "";
     aAlfa2 = "";
     aClave = "";
     nNumCam = 0;
     aFicERP = "";
     aFicDsarchi = "";
     aDSERP = "";

     &PRMNT_Def = "";
     aLong = "";
     nLong = 0;
     nPos  = 0;

     nNumCmps    = 0;
   {2}nPuntero   = 0;
     aSalida = "";

     nSwSaltaRel = 0;
     aEmpresaDoc  = "";
|FIN;

|PROCESO &EVENTOGRID;
     |SI Campo = -1;
          ||aMensaje = "0000Esta opcion solo funciona estando dentro del campo.";
          ||MENAV aMensaje;
          nSwSaltaRel = 1;
     |SINO;
          nSwSaltaRel = 0;
     |FINSI;

     ||No controlamos las relaciones.
     nSwSaltaRel = 1;

     aSalida = FSalida;
     |QBF aSalida;
     |SI aSalida = "1771";
          aMensaje = "0000Esta opcion solo funciona estando dentro del campo. Codigo 1771";
          |MENAV aMensaje;
     |SINO;
          aSalida = aSalida % 104;
          |SI aSalida = "1771";
               |HAZ BotonD;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO ControlGrid; |TIPO 77;
   enDesdeGrid = 1;
   nSalida = FSalida;
   |SI FSalida = 4;
     ||Primero miro si tengo instalado el dserp

     |DBASS aFicERP;
     |QBF aFicERP;
     aDSERP = aFicERP + "dserp/def/dserpm01.mas";
     |XABRE "E", aDSERP, 0;
     |SI FSalida ! 0; |ACABA; |FINSI;

     nCampo = Campo;

     |DBASE aBase;
     |QBF aBase;
     aPathDef = aBase + "def/";
     aQueQuiero = "|DEF";
     aNomDef = #Fichero@#aQueQuiero#;
     |QBF aNomDef;
     aNomDef = aNomDef - aPathDef;
     |QBF aNomDef;
     aNomDef = (aNomDef + "        ") % 108;
     |MODULO aPrograma;
     |QBF aPrograma;
     |DFICE aPathFic;
     |QBF aPathFic;

     |SI nSwSaltaRel = 0;
          aAlfa5 = "|NR"; aAlfa5 = #Fichero@#aAlfa5#;
          nNumRels = aAlfa5; nNumRels = nNumRels - 1;
          |PARA nCont = 0; |SI nCont [ nNumRels; |HACIENDO nCont = nCont + 1;
             aAlfa5 = "|R" + (("000" + nCont) % -103);
             aAlfa5 = #Fichero@#aAlfa5#;
             aAlfa5 = aAlfa5 - "|";
             |SI FSalida ! 0;
                nCalc = ((FSalida / 100) ! 0) + 99;
                aFichRel = aAlfa5 % nCalc;
                nCalc = FSalida + 98;
                aAlfa5 = aAlfa5 % nCalc; aAlfa5 = aAlfa5 % 0499; aRels = aAlfa5;
                |PARA; |SI aAlfa5 ! ""; |HACIENDO;
                   aAlfa6 = aAlfa5 % 0103; aAlfa5 = aAlfa5 % 0499;
                   nCalc = aAlfa6; nCalc = nCalc - 1;
                   |SI nCalc = nCampo; |SAL; |FINSI;
                |SIGUE;
                |SI nCalc = nCampo; |SAL; |FINSI;
             |FINSI;
          |SIGUE;
          |SI nCalc = nCampo;
             aAlfa5 = aPathDef + aAlfa5; |QBF aAlfa5;
             aAlfa5 = aAlfa5 + aFichRel + ".mas";
             |CARGA_DEF aAlfa5, Referen@;
             |SI FSalida = 0;
                |ENLAZA_PROCESO #Referen@#0,ControlGrid,77;
                |PATH_DAT #1000 aPathFic;
                |ABRE #Referen@;  aAlfa5 = "|K000";
                aAlfa5 = #Referen@#aAlfa5#; aAlfa5 = aAlfa5 % 0499;
                |PARA; |SI aAlfa5 ! ""; |HACIENDO;
                   aAlfa6 = aAlfa5 % 0103; aAlfa5 = aAlfa5 % 0499;
                   nCalc = aAlfa6;
                   aAlfa6 = aRels % 0103; aRels = aRels % 0499;
                   nCalc1 = aAlfa6; nCalc1 = nCalc1 - 1;
                   #Referen@#nCalc# = #Fichero@#nCalc1#;
                |SIGUE;
                |LEE 000#Referen@.];
                |PUSHV 0501 2380;
                |PINPA #0#Referen@; |PINDA #0#Referen@;
                |PUSHV 0501 2380;
                |HAZ Relacionado;
                |POPV;
                |POPV;
                ||CONSULTA_CLAVE #1#Referen@;
                |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
                |ACABA;
             |SINO;
                aAlfa5 = "    No encuentro el def a cargar. [" + aAlfa5 + "," + FSalida + "]";
                |MENAV aAlfa5;
             |FINSI;
          |FINSI;
     |FINSI;

     aAlfa5 = "|K000";
     aClaves = #Fichero@#aAlfa5#;
     aTCompo = aClaves % 103;
     nTCompo = aTCompo;
     Iclave = clave1<-;
     |PARA nCampo = 1;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
          clave = 0;
          Iclave = Iclave + 1;
     |SIGUE;

     Iclave = clave1<-;
     |PARA nCompo = 1;  |SI nCompo [ nTCompo;  |HACIENDO nCompo = nCompo + 1;
          nPosi = (nCompo * 300) + 103;
          aAlfa1 = aClaves % nPosi;
          clave = aAlfa1;
          Iclave = Iclave + 1;
     |SIGUE;

     aClave = "";
     Iclave = clave1<-;
     |PARA nCompo = 1;  |SI nCompo [ nTCompo;  |HACIENDO nCompo = nCompo + 1;
          nNumCam = clave;
          Iclave = Iclave + 1;
          aAlfa2 = #Fichero@#nNumCam#;

          aQueQuiero = "|C" + (("000" + nNumCam) % -103) + "TIPO";
          aAlfa      = #Fichero@#aQueQuiero#;
          |SI aAlfa = "N";
              aQueQuiero = "|C" + (("000" + nNumCam) % -103) + "LONGITUD";
              aAlfa      = #Fichero@#aQueQuiero#;
              nLong      = aAlfa;
              nPos       = -(100 + nLong);
              aAlfa2     = (("0" * aAlfa) + aAlfa2) % nPos;
          |FINSI;

          aClave = aClave + aAlfa2;
     |SIGUE;

     ||aMensaje = "0000Clave: " + aClave;

     aAlfa = (aClave + "                                                                                                    ") % 199;
     aClave = aAlfa;
     aAlfa = (aClave + "                                                                                                    ") % 10001;
     aClave = aClave + aAlfa;

     ||Tengo que a¤adir antes .. el nombre de la aplicacion y numero de empresa
     |NOMAP aAplica;
     |QBF aAplica

     nEmpresa = #48#0;
     aEmpresa = ("00000" + nEmpresa) % -105;

     aParametro = aAplica + aEmpresa + aNomDef + aClave + aPathDef + "@" + aPathFic;
     aAlfa      = ":dserp/dserpm08;" + aParametro;

     |SUB_EJECUTA aAlfa;
     |SI nSwSaltaRel = 1;
          ||PTEC 807;
     |FINSI;
  |FINSI;
|FPRC;

|PROCESO Relacionado;
     aAlfa5 = "|K000";
     aClaves = #Referen@#aAlfa5#;
     aTCompo = aClaves % 103;
     nTCompo = aTCompo;
     Iclave = clave1<-;
     |PARA nCampo = 1;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
          clave = 0;
          Iclave = Iclave + 1;
     |SIGUE;

     Iclave = clave1<-;
     |PARA nCompo = 1;  |SI nCompo [ nTCompo;  |HACIENDO nCompo = nCompo + 1;
          nPosi = (nCompo * 300) + 103;
          aAlfa1 = aClaves % nPosi;
          clave = aAlfa1;
          Iclave = Iclave + 1;
     |SIGUE;

     aClave = "";
     Iclave = clave1<-;
     |PARA nCompo = 1;  |SI nCompo [ nTCompo;  |HACIENDO nCompo = nCompo + 1;
          nNumCam = clave;
          Iclave = Iclave + 1;
          aAlfa2 = #Referen@#nNumCam#;

          aQueQuiero = "|C" + (("000" + nNumCam) % -103) + "TIPO";
          aAlfa      = #Referen@#aQueQuiero#;
          |SI aAlfa = "N";
              aQueQuiero = "|C" + (("000" + nNumCam) % -103) + "LONGITUD";
              aAlfa      = #Referen@#aQueQuiero#;
              nLong      = aAlfa;
              nPos       = -(100 + nLong);
              aAlfa2     = (("0" * aAlfa) + aAlfa2) % nPos;
          |FINSI;

          aClave = aClave + aAlfa2;
     |SIGUE;

     ||aMensaje = "0000Clave: " + aClave;

     aAlfa = (aClave + "                                                                                                    ") % 199;
     aClave = aAlfa;
     aAlfa = (aClave + "                                                                                                    ") % 10001;
     aClave = aClave + aAlfa;

     ||Tengo que a¤adir antes .. el nombre de la aplicacion y numero de empresa
     |NOMAP aAplica;
     |QBF aAplica
     aAplica = (aAplica + "        ") % 108;

     nEmpresa = #48#0;
     aEmpresa = ("00000" + nEmpresa) % -105;

     aParametro = aAplica + aEmpresa + aFichRel + aClave + aPathDef + "@" + aPathFic;
     aAlfa      = ":dserp/dserpm08;" + aParametro;

     |SUB_EJECUTA aAlfa;
     ||PTEC 807;
|FPRC;

|PROCESO BotonD;
     aEmpresaDoc  = "";

     |DBASS aFicDsarchi;
     |QBF aFicDsarchi;
     aDSERP = aFicDsarchi + "dsarchi/def/dsarm001.mas";
     |XABRE "E", aDSERP, 0;
     |SI FSalida ! 0; |ACABA; |FINSI;

     nCampo = Campo;

     |DBASE aBase;
     |QBF aBase;
     aPathDef = aBase + "def/";
     aQueQuiero = "|DEF";
     aNomDef = #Fichero@#aQueQuiero#;
     |QBF aNomDef;
     aNomDef = aNomDef - aPathDef;
     |QBF aNomDef;
     aNomDef = (aNomDef + "        ") % 108;

     |MODULO aPrograma;
     |QBF aPrograma;

     |SI aNomDef = "caivalin";
         aNomDef = "camaniva";
         |REFERENCIA_DEF Fichero@, #camaniva;
     |FINSI;

     |DFICE aPathFic;
     |QBF aPathFic;

     |SI nSwSaltaRel = 0;
          aAlfa5 = "|NR"; aAlfa5 = #Fichero@#aAlfa5#;
          nNumRels = aAlfa5; nNumRels = nNumRels - 1;
          |PARA nCont = 0; |SI nCont [ nNumRels; |HACIENDO nCont = nCont + 1;
             aAlfa5 = "|R" + (("000" + nCont) % -103);
             aAlfa5 = #Fichero@#aAlfa5#;
             aAlfa5 = aAlfa5 - "|";
             |SI FSalida ! 0;
                nCalc = ((FSalida / 100) ! 0) + 99;
                aFichRel = aAlfa5 % nCalc;
                nCalc = FSalida + 98;
                aAlfa5 = aAlfa5 % nCalc; aAlfa5 = aAlfa5 % 0499; aRels = aAlfa5;
                |PARA; |SI aAlfa5 ! ""; |HACIENDO;
                   aAlfa6 = aAlfa5 % 0103; aAlfa5 = aAlfa5 % 0499;
                   nCalc = aAlfa6; nCalc = nCalc - 1;
                   |SI nCalc = nCampo; |SAL; |FINSI;
                |SIGUE;
                |SI nCalc = nCampo; |SAL; |FINSI;
             |FINSI;
          |SIGUE;
          |SI nCalc = nCampo;
             aAlfa5 = aPathDef + aAlfa5; |QBF aAlfa5;
             aAlfa5 = aAlfa5 + aFichRel + ".mas";
             |CARGA_DEF aAlfa5, Referen@;
             |SI FSalida = 0;
                |ENLAZA_PROCESO #Referen@#0,ControlGrid,77;
                |PATH_DAT #1000 aPathFic;
                |ABRE #Referen@;  aAlfa5 = "|K000";
                aAlfa5 = #Referen@#aAlfa5#; aAlfa5 = aAlfa5 % 0499;
                |PARA; |SI aAlfa5 ! ""; |HACIENDO;
                   aAlfa6 = aAlfa5 % 0103; aAlfa5 = aAlfa5 % 0499;
                   nCalc = aAlfa6;
                   aAlfa6 = aRels % 0103; aRels = aRels % 0499;
                   nCalc1 = aAlfa6; nCalc1 = nCalc1 - 1;
                   #Referen@#nCalc# = #Fichero@#nCalc1#;
                |SIGUE;
                |LEE 000#Referen@.];
                |PUSHV 0501 2380;
                |PINPA #0#Referen@; |PINDA #0#Referen@;
                |PUSHV 0501 2380;
                |HAZ Relacionado;
                |POPV;
                |POPV;
                ||CONSULTA_CLAVE #1#Referen@;
                |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
                |ACABA;
             |SINO;
                aAlfa5 = "    No encuentro el def a cargar. [" + aAlfa5 + "," + FSalida + "]";
                |MENAV aAlfa5;
             |FINSI;
          |FINSI;
     |FINSI;

     aAlfa5 = "|K000";
     aClaves = #Fichero@#aAlfa5#;
     aTCompo = aClaves % 103;
     nTCompo = aTCompo;
     Iclave = clave1<-;
     |PARA nCampo = 1;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
          clave = 0;
          Iclave = Iclave + 1;
     |SIGUE;

     Iclave = clave1<-;
     |PARA nCompo = 1;  |SI nCompo [ nTCompo;  |HACIENDO nCompo = nCompo + 1;
          nPosi = (nCompo * 300) + 103;
          aAlfa1 = aClaves % nPosi;
          clave = aAlfa1;
          Iclave = Iclave + 1;
     |SIGUE;

     |SI aNomDef = "caextrp5"; |O aNomDef = "caextrp7";
          aSwMostrarAC = "A";

          aPopup1 = "-1";  || Si fuera -1 en la posicion

          aPopup2  = 2;
          aPopup3  = "Apuntes";
          aPopup4  = "Cta.Contables";

          IaPopup  = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 101;
              |SI aAlfa = "C";
                   aSwMostrarAC = "C";
              |SINO;
                   aSwMostrarAC = "A";
              |FINSI;
          |FINSI;

          ||Seleccion entre mostrar Apuntes relacionados o Cta. Contable.
          ||ARA.
     |FINSI;

     aClave = "";
     Iclave = clave1<-;
     |PARA nCompo = 1;  |SI nCompo [ nTCompo;  |HACIENDO nCompo = nCompo + 1;
          nNumCam = clave;
          Iclave = Iclave + 1;
          aAlfa2 = #Fichero@#nNumCam#;
          |SI aNomDef = "camaasic"; |O aNomDef = "anz00010";
               |SI nCompo = 1;
                    aAlfa2 = ("00" + aAlfa2) % -102;
               |FINSI;
               |SI nCompo = 3;
                    aAlfa2 = ("000000" + aAlfa2) % -106;
               |FINSI;
          |FINSI;
          |SI aNomDef = "camaasil"; |O aNomDef = "anz00011";
               |SI nCompo = 1;
                    aAlfa2 = ("00" + aAlfa2) % -102;
               |FINSI;
               |SI nCompo = 3;
                    aAlfa2 = ("000000" + aAlfa2) % -106;
               |FINSI;
               |SI nCompo = 4;
                    aAlfa2 = "";
               |FINSI;
          |FINSI;
          |SI aNomDef = "cainliva";
               |SI nCompo = 1;
                    aAlfa2 = ("00" + aAlfa2) % -102;
               |FINSI;
               |SI nCompo = 2;
                    aAlfa2 = ("000" + aAlfa2) % -103;
               |FINSI;
          |FINSI;
          |SI aNomDef = "catmpasi";
               |SI nCompo = 1;
                    aAlfa2 = ("00" + aAlfa2) % -102;
               |FINSI;
               |SI nCompo = 3;
                    aAlfa2 = ("000000" + aAlfa2) % -106;
               |FINSI;
               |SI nCompo = 4;
                    aAlfa2 = "";
               |FINSI;
               aNomDef = "camaasic";
          |FINSI;
          |SI aNomDef = "camaniva";
               |SI nCompo = 1;
                    aAlfa2 = ("00" + aAlfa2) % -102;
               |FINSI;
               |SI nCompo = 2;
                    aAlfa2 = ("0000000000" + aAlfa2) % -110;
               |FINSI;
          |FINSI;
          aClave = aClave + aAlfa2;
     |SIGUE;

     |SI aNomDef = "camaniva";
          ||Anyadimos los campos que faltan

          ||Diario
          aAlfa2 = ("00" + #Fichero@#7) % -102;
          aClave = aClave + aAlfa2;

          ||Fecha
          aAlfa2 = #Fichero@#8;
          aClave = aClave + aAlfa2;

          ||Documento
          aAlfa2 = ("000000" + #Fichero@#9) % -106;
          aClave = aClave + aAlfa2;

          ||Libro Factura
          aAlfa2 = ("00" + #Fichero@#0) % -102;
          aClave = aClave + aAlfa2;

          ||Cuenta contable
          aAlfa2 = #Fichero@#12;
          aClave = aClave + aAlfa2;
     |FINSI;

          ||ARA39
     |SI aNomDef = "camaasic"; |O aNomDef = "camaasil"; |O aNomDef = "anz00010"; |O aNomDef = "anz00011";
          |ABRE #camaniva;
          |DDEFECTO #camaniva;
          |SELECT #2#camaniva;
          #camaniva#7 = #Fichero@#0;
          #camaniva#8 = #Fichero@#1;
          #camaniva#9 = #Fichero@#2;
          |LEE 000#camaniva.=;

          ||Libro
          aAlfa2 = ("00" + #camaniva#0) % -102;
          aClave = aClave + aAlfa2;

          ||Registro
          aAlfa2 = ("0000000000" + #camaniva#1) % -110;
          aClave = aClave + aAlfa2;

          ||Cuenta contable
          aAlfa2 = #camaniva#12;
          aClave = aClave + aAlfa2;

          |CIERRA #camaniva;
     |FINSI;

     |SI aNomDef = "caextrp2"; |O aNomDef = "caextrp1"; |O aNomDef = "caextrp5"; |O aNomDef = "caextrp4"; |O aNomDef = "caextrp7";
          |SI aNomDef = "caextrp5"; |O aNomDef = "caextrp7";
               |SI aSwMostrarAC = "A";
                    aClave = "";
                    aAlfa2 = #Fichero@#18;
                    aAlfa2 = ("00" + aAlfa2) % -102;
                    aClave = aClave + aAlfa2;

                    aAlfa2 = #Fichero@#8;
                    aClave = aClave + aAlfa2;

                    aAlfa2 = #Fichero@#9;
                    aAlfa2 = ("000000" + aAlfa2) % -106;
                    aClave = aClave + aAlfa2;

                    aAlfa2 = #Fichero@#23;
                    aEmpresaDoc = aAlfa2;  |QBF aEmpresaDoc;
                    aEmpresaDoc = ("00000" + aEmpresaDoc) % -105;
                    aEmpresaDoc = aEmpresaDoc + #Fichero@#24;

                    aNomDef = "camaasic";
               |SINO;
                    aClave = "";
                    aAlfa2 = #Fichero@#1;
                    aClave = aClave + aAlfa2;
                    aNomDef = "cacuenta";
               |FINSI;
          |SINO;
               |SI aNomDef = "caextrp4";
                    aClave = "";
                    aAlfa2 = #Fichero@#13;
                    aAlfa2 = ("00" + aAlfa2) % -102;
                    aClave = aClave + aAlfa2;

                    aAlfa2 = #Fichero@#14;
                    aClave = aClave + aAlfa2;

                    aAlfa2 = #Fichero@#15;
                    aAlfa2 = ("000000" + aAlfa2) % -106;
                    aClave = aClave + aAlfa2;
                    aNomDef = "camaasic";
               |SINO;
                    aClave = "";
                    aAlfa2 = #Fichero@#18;
                    aAlfa2 = ("00" + aAlfa2) % -102;
                    aClave = aClave + aAlfa2;

                    aAlfa2 = #Fichero@#8;
                    aClave = aClave + aAlfa2;

                    aAlfa2 = #Fichero@#9;
                    aAlfa2 = ("000000" + aAlfa2) % -106;
                    aClave = aClave + aAlfa2;
                    aNomDef = "camaasic";
               |FINSI;
          |FINSI;
     |FINSI;

     |SI aNomDef ! "camaasic"; |Y aNomDef ! "camaasil"; |Y aNomDef ! "camaniva";
      |Y aNomDef ! "cacuenta"; |Y aNomDef ! "dsmom041"; |Y aNomDef ! "dsmom042";
      |Y aNomDef ! "caintiva"; |Y aNomDef ! "cainliva";
      |Y aNomDef ! "anz00010"; |Y aNomDef ! "anz00011";
          aMensaje = "0000Funcion no implementada";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     ||Tengo que a¤adir antes .. el nombre de la aplicacion y numero de empresa
     |NOMAP aAplica;
     |QBF aAplica

     nEmpresa = #48#0;
     aEmpresa = ("000000" + nEmpresa) % -106;

     |SI aEmpresaDoc ! "";
         aEmpresa = aEmpresaDoc;
     |FINSI;

     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;

     aParametro = "ADCONTD" + aEmpresa + aNomDef + aClave;
     |QBF aParametro;
     aAlfa      = "|:dsarchi/dsarm005;" + aParametro;
     |SUB_EJECUTA aAlfa;

     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;

     |ACABA;

     |SI nSwSaltaRel = 1;
          ||PTEC 807;
     |FINSI;
|FPRC;


|PROCESO &EVENTOPBX;
     |SI Campo = -1;
          nSwSaltaRel = 1;
     |SINO;
          nSwSaltaRel = 0;
     |FINSI;

     aSalida = FSalida;
     |QBF aSalida;
     |SI aSalida = "1771";
          aMensaje = "0000Esta opcion solo funciona estando dentro del campo. Codigo 1771";
          |MENAV aMensaje;
     |SINO;
          aSalida = aSalida % 104;
          |SI aSalida = "1771";
               |HAZ BotonPBX;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO BotonPBX;
     aMensaje = "0000EVENTOPBX. Boton Telefono";
     |MENAV aMensaje;
|FPRC;

|PROCESO &EVENTOCRM;
     |SI Campo = -1;
          nSwSaltaRel = 1;
     |SINO;
          nSwSaltaRel = 0;
     |FINSI;

     aSalida = FSalida;
     |QBF aSalida;
     |SI aSalida = "1771";
          aMensaje = "0000Esta opcion solo funciona estando dentro del campo. Codigo 1771";
          |MENAV aMensaje;
     |SINO;
          aSalida = aSalida % 104;
          |SI aSalida = "1771";
               |HAZ BotonCrm;
          |FINSI;
     |FINSI;

     |PULSATECLA;
|FPRC;

|PROCESO BotonCrm;
     aMensaje = "0000EVENTOCRM. Boton Libreta";
     |MENAV aMensaje;
|FPRC;
