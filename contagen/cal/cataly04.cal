|FICHEROS;
    cataly04 #0;
    catalm01 #1;
    catalw01 #4;

    canempre #30;
    caselem1 #998;
|FIN;

|VARIABLES;
    &entrada = 1;
    informe = "cataly04";
    banco   = "";
    vto     = @;
    sw      = 0;
    &sw1    = 0;
    &venci  = 0;
    &swtot  = 0;
    &tvenci = 0;
    &tbanco = 0;
    &nomban = "";
 {-1}elegir = "";
    elegir1 = "2400";
    elegir2 = "1";
    elegir3 = " Elija opcion .: ";
    elegir4 = "IP";
    elegir5 = " Impresora ";
    elegir6 = " Pantalla ";
    posic   = 0;
    mas     = 0;
    lin_pan = 0;
    alfa1   = "";
    sw_act  = 0;
    nSw     = 0;
    nModo   = 0;
|FIN;

|INCLUYE dscont_i;


|PROCESO juntos; |TIPO 0;
 |SI sw_act = 0;
     #0#10 = #0#13;
     |PINTA #0#10;
 |FINSI;
|FPRC;

|CALCULO cuenta; |TIPO 0;
     eaCuenta = #0Campo;
     salidas  = FSalida;
     |HAZ FiltraPuntos;
     #0Campo = eaCuenta;
     |PINTA #0Campo;
|FCAL;

|CALCULO nodepar; |TIPO 7;
   |C_M #0#16, 1, eaDepar;
   |C_M #0#17, 1, eaDepar;
|FCAL;

|| ****************************************************************
|PROCESO impre1;
  |SI #0#10 ! "A";
      |SI #0#10 ! #1#10;  |ACABA;  |FINSI;  || impresa carta
  |FINSI;
  |SI #0#13 ! "A";
      |SI #0#13 ! #1#12;  |ACABA;  |FINSI;  || impreso talon
  |FINSI;
  |SI #0#11 ! "A";
      |SI #0#11 ! #1#07;  |ACABA;  |FINSI;  || emision
  |FINSI;
  |SI #0#12 ! "A";
      |SI #0#12 ! #1#08;  |ACABA;  |FINSI;  || vencimiento
  |FINSI;

  |SI sw = 0;
      nomban = #1#22;
      banco = #1#3;
      vto   = #1#6;
      |PRINT;                   || imprime vto
      sw = 1;
      sw1 = 1;
  |FINSI;
  |SI vto ! #1#6;
      sw1   = 2;
      swtot = 1;
      venci = 1;
      |PRINT;                   || imprime total banco y vto.
      vto = #1#6;
      tvenci = 0;
      tbanco = 0;
      swtot = 0;
      venci = 0;
      sw1 = 0;
      |PRINT;                   || imprime vto.
      sw1 = 1;
  |FINSI;
  |SI banco ! #1#3;
      sw1   = 2;
      venci = 1;
      swtot = 0;
      |PRINT;                   || imprime total banco
      banco = #1#3;
      nomban = #1#22;
      tbanco = 0;
      venci = 0;
      sw1 = 1;
  |FINSI;
  tvenci  = tvenci + #1#9;
  tbanco  = tbanco + #1#9;
  |PRINT;

|FPRC;

|DEFBUCLE impre;
 #1#3;
 1, 5, 16, 20; || ..... ordenado por vto+banco, selec. prov y emision y recibo
 enEmpresa, #0#4, #0#2, #0#0, #0#6, #0#8, #0#14, #0#16;
 enEmpresa, #0#5, #0#3 ,#0#1, #0#7, #0#9, #0#15, #0#17;
 e;
 NULL, impre1;
|FIN;

|PROCESO impresora;

  |INFOR informe;
  |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;
  |BUCLE impre;
  sw1   = 2;
  venci = 1;
  swtot = 1;
  |PRINT;
  |PIEINF;
  |FININF;

|FPRC;

|PROCESO correte;

|CAMPO_POSICION #4#0,0,posic; posic=posic+mas; |CAMPO_POSICION #4#0,1,posic;
|CAMPO_POSICION #4#2,0,posic; posic=posic+mas; |CAMPO_POSICION #4#2,1,posic;
|CAMPO_POSICION #4#3,0,posic; posic=posic+mas; |CAMPO_POSICION #4#3,1,posic;
|CAMPO_POSICION #4#4,0,posic; posic=posic+mas; |CAMPO_POSICION #4#4,1,posic;
|CAMPO_POSICION #4#5,0,posic; posic=posic+mas; |CAMPO_POSICION #4#5,1,posic;
|CAMPO_POSICION #4#7,0,posic; posic=posic+mas; |CAMPO_POSICION #4#7,1,posic;
|CAMPO_POSICION #4#8,0,posic; posic=posic+mas; |CAMPO_POSICION #4#8,1,posic;
|FPRC;

|PROCESO empieza;
  |PINPA #2#4;
  |PINTA #4#26;|PINTA #4#27;
  |PINTA #4#28;|PINTA #4#29;
  |PINTA #4#6;
  mas = lin_pan * -100;
  lin_pan = 0;
  |HAZ correte;
|FPRC;

|PROCESO panta1;
  |SI #0#10 ! "A";
      |SI #0#10 ! #1#10;  |ACABA;  |FINSI;  || impresa
  |FINSI;
  |SI #0#13 ! "A";
      |SI #0#13 ! #1#12;  |ACABA;  |FINSI;  || impreso talon
  |FINSI;
  |SI #0#11 ! "A";
      |SI #0#11 ! #1#07;  |ACABA;  |FINSI;  || emision
  |FINSI;
  |SI #0#12 ! "A";
      |SI #0#12 ! #1#08;  |ACABA;  |FINSI;  || vencimiento
  |FINSI;

  nomban = #1#22;
  |SI sw = 0;
      vto = #1#6;
      sw  = 1;
  |FINSI;
  |SI vto ! #1#6;
      |PAUSA;
      vto    = #1#6;
      tvenci = 0;
      |HAZ empieza;
  |FINSI;
  tvenci  = tvenci + #1#9;
  lin_pan = lin_pan + 1;
  #4#0 = #1#3;    || cuenta banco
  #4#2 = #1#0;    || nro. talon
  #4#3 = #1#1;    || cuenta proveedor
  #4#4 = #1#14;   || nombre proveedor
  #4#5 = #1#5;    || fecha emision
  #4#6 = #1#6;    || fecha vencimiento
  #4#7 = #1#9;    || total talon
  #4#8 = #1#16;   || tipo recibo
  #4#10 = tvenci; || total talon
  |PINDA #0#4;
  |PINTA 2369,#4#10;
  |SI lin_pan < 11;
      mas = 100;
  |SINO;
      mas = -1000;
      lin_pan = 0;
      |PAUSA;
      |PINPA #2#4;
      |PINTA #4#26;|PINTA #4#27;
      |PINTA #4#28;|PINTA #4#29; |PINTA #4#6;
  |FINSI;
  |HAZ correte;
|FPRC;

|DEFBUCLE panta;
 #1#3;
 1, 5, 16, 20; || ..... ordenado por vto+banco, selec. prov y emision
 enEmpresa, #0#4, #0#2, #0#0, #0#6, #0#8, #0#14, #0#16;
 enEmpresa, #0#5, #0#3 ,#0#1, #0#7, #0#9, #0#15, #0#17;
 e;
 NULL, panta1;
|FIN;

|PROCESO pantalla;
  |SI nSw = 0;
      |PINPA #2#4;
      |PINTA #4#26;|PINTA #4#27;
      |PINTA #4#28;|PINTA #4#29; |PINTA #4#6;
      nSw = 1;
  |SINO;
      |HAZ empieza;
  |FINSI;
  |BUCLE panta;
  |PAUSA;
|FPRC;

|PROCESO HazTodo;
   #4#26 = enEmpresa;
   #4#27 = eaNombreEmp;
   #4#28 = "Informe Agenda Vtos. por Fechas";
   #4#29 = "Vencimiento ";

   sw = 0;
   |HAZ Borrar;
   |SI nModo = 1;
       |HAZ impresora;
   |SINO;
       |HAZ pantalla;
   |FINSI;
|FPRC;

|PROCESO impre; |TIPO 3;

  |C_P #4#6, 1, 0715;
  |C_P #4#8, 1, 1042;
  |C_P #4#5, 1, 1045;
  |C_P #4#0, 1, 1056;
  |C_A #4#4, 1, 19;
  |C_V #4#1, 1, "N";
  |HAZ DirAplicSt;
  |SI Haybasica = 1; |Y #0#17 = "zz"; #0#17 = "99"; |FINSI;

  |MENU elegir;
  nModo = FSalida;
  |SI nModo > 0;
      |SI nModo = 1;
          |IMPRE 0;
          |SI FSalida < 0; |ACABA; |FINSI;
      |FINSI;
      |SI #48#27 = "S";
          |HAZ MultiEmpresa;
      |SINO;
          |DFICE dirfich0; |QBF dirfich0;
          |HAZ HazTodo;
      |FINSI;
      |SI nModo = 1; |FINIMP; |FINSI;
  |FINSI;
|FPRC;
|| **********************************************************

|PROCESO MultiEmp1;
   cod1 = #caselem1#1;
   cod2 = #caselem1#2;
   emEmp = 1;  || Sin mensaje
   |HAZ leelo;
   |SI swerror ! 0;  |ACABA;   |FINSI;

   dirfich0 = #caselem1#3;
   |QBF dirfich0;

   |HAZ HazTodo;
|FPRC;

|DEFBUCLE MultiEmp0;
 #caselem1#1;
 ;
 001;
 999;
 ;
 NULL,MultiEmp1;
|FIN;

|PROCESO MultiEmpresa;
   |SUB_EJECUTA "caselemp";
   |NOME_DAT #998 eaFichsel;
   nSw = 0;
   |BUCLE MultiEmp0;
   |DELINDEX #998;
|FPRC;

|PROCESO Borrar;
    banco  = "";
    vto    = "01.01.0000";
    sw     = 0;
    sw1    = 0;
    venci  = 0;
    swtot  = 0;
    tvenci = 0;
    tbanco = 0;
    nomban = "";
|FPRC;
