|FICHEROS;
   cachenif #0;

   caclipro #1;
   cacuenta #2;

   canempre #30;
   caselem1 #998;
|FIN;

|VARIABLES;
   &entrada = 1;
   &tinforme = "";
   aAlfa1    = "";
   nNume1    = 0;

   informe   = "cachenif";
   desde = "";
   aDCuenta = "";
   aHCuenta = "";
   aDNombre = "";
   aHNombre = "";
   &swImprimir = 0;
   &aError  = "";
   swSelec  = 0;
   sw = 0;
|FIN;

|INCLUYE dscont_i;

|CALCULO LaSeleccion; |TIPO 0;
 |C_M #0#1, 1,"S"; |C_M #0#2, 1,"S";
 |C_M #0#3, 1,"S"; |C_M #0#4, 1,"S";
 |C_M #0#5, 1,"S"; |C_M #0#6, 1,"S";
 |C_M #0#7, 1,"S"; |C_M #0#8, 1,"S";
 |C_M #0#9, 1,"S"; |C_M #0#10,1,"S";
 |C_M #0#11,1,"S"; |C_M #0#12,1,"S";
 |C_M #0#13,1,"S"; |C_M #0#14,1,"S";
 |SI #0#0 = "C";
      |C_M #0#7, 1,"N"; |C_M #0#8, 1,"N";
      |C_M #0#9, 1,"N"; |C_M #0#10,1,"N";
      |C_M #0#11,1,"N"; |C_M #0#12,1,"N";
      |C_M #0#13,1,"N"; |C_M #0#14,1,"N";
 |FINSI;
 |SI #0#0 = "P";
      |C_M #0#1, 1,"N"; |C_M #0#2, 1,"N";
      |C_M #0#3, 1,"N"; |C_M #0#4, 1,"N";
      |C_M #0#5, 1,"N"; |C_M #0#6, 1,"N";
 |FINSI;
|FCAL;

|CALCULO ElPtec; |TIPO 7;
 |C_M #0Campo,0,aAlfa1;
 |SI aAlfa1 = "S";
     |PTEC 816;
 |FINSI;
|FCAL;

|CALCULO Hasta; |TIPO 0;
 |C_M #0Campo,0,aAlfa1;
 |SI aAlfa1 = "S";
     nNume1 = Campo - 1;
     |SI #0Campo < #0nNume1;
         |MENAV "    Error!. Cuenta Hasta Menor que la Cuenta Desde";
         |ERROR;
     |FINSI;
 |FINSI;
|FCAL;

|CALCULO cuenta;|TIPO 6;
     |C_M #0Campo, 0, aAlfa1;
     |SI aAlfa1 = "N"; |ACABA; |FINSI;

     eaCuenta = #0Campo;
     salidas  = FSalida;
     |HAZ FiltraPuntos;
     #0Campo = eaCuenta; |PINTA #0Campo;
|FCAL;
|| **********************************************************************

|CALCULO impre;|TIPO 3;
 |IMPRE 0;
 |SI FSalida ! 0;  |ACABA;  |FINSI;

 |INFOR informe;
 |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

 |SI #48#27 = "S";
     |HAZ MultiEmpresa;
 |SINO;
     |DFICE dirfich0; |QBF dirfich0;
     |HAZ HazTodo;
 |FINSI;
 |FININF;
 |FINIMP;
|FCAL;

||************************************************************************
|PROCESO Encontrado;
 |SI swImprimir = 0;
     swImprimir = 1;
     aError = "";
     aAlfa1 = #1#9; |QBF aAlfa1;
     |SI aAlfa1 = "";
         aError = "N.I.F. EN BLANCO";
         |PRINT;
         sw = 1;
     |FINSI;
 |SINO;
     aError = "CUENTA DUPLICADA";
     |PRINT; sw = 1;
 |FINSI;
|FPRC;

|DEFBUCLE LeeCliPro;
 #1#1;
 ;
 " ", #2#0;
 "z", #2#0;
 e;
 NULL, Encontrado;
|FIN;

|PROCESO porimpre;
   swSelec = 0;
   |SI desde = "C";
       |SI #0#2 ! doce;
           |SI #2#0 ] #0#1; |Y #2#0 [ #0#2; swSelec = 1; |FINSI;
       |FINSI;
       |SI #0#4 ! doce;
           |SI #2#0 ] #0#3; |Y #2#0 [ #0#4; swSelec = 1; |FINSI;
       |FINSI;
       |SI #0#6 ! doce;
           |SI #2#0 ] #0#5; |Y #2#0 [ #0#6; swSelec = 1; |FINSI;
       |FINSI;
   |FINSI;
   |SI desde = "P";
       |SI #0#8 ! doce;
           |SI #2#0 ] #0#7; |Y #2#0 [ #0#8; swSelec = 1; |FINSI;
       |FINSI;
       |SI #0#10 ! doce;
           |SI #2#0 ] #0#9; |Y #2#0 [ #0#10; swSelec = 1; |FINSI;
       |FINSI;
       |SI #0#12 ! doce;
           |SI #2#0 ] #0#11; |Y #2#0 [ #0#12; swSelec = 1; |FINSI;
       |FINSI;
       |SI #0#14 ! doce;
           |SI #2#0 ] #0#13; |Y #2#0 [ #0#14; swSelec = 1; |FINSI;
       |FINSI;
   |FINSI;
   |SI swSelec = 0; |ACABA; |FINSI;

   swImprimir = 0;
   |BUCLE LeeCliPro;
   |SI swImprimir = 0;
       aError = "FICHA NO ENCONTRADA";
       #1#9 = "";
       |PRINT; sw = 1;
   |FINSI;
|FPRC;

|DEFBUCLE Lee_codigo;
   #2#1;
   3;
   aDCuenta, "S";
   aHCuenta, "S";
   e;
   NULL, porimpre;
|FIN;

|PROCESO Leeimprime;
 sw = 0;

 tinforme = "PROVEEDORES";
 |SI desde = "C"; tinforme = "CLIENTES"; |FINSI;

 |BUCLE Lee_codigo;

 |SI sw = 1; |PIEINF; |FINSI;
|FPRC;


|PROCESO HazTodo;

 aDNombre = " " * 36; aHNombre = "z" * 36;

 |SI #0#0 ! "P";
     desde = "C";

     aDCuenta = #0#1;
     |SI aDCuenta > #0#3; |Y #0#4 ! doce; aDCuenta = #0#3; |FINSI;
     |SI aDCuenta > #0#5; |Y #0#6 ! doce; aDCuenta = #0#5; |FINSI;
     aHCuenta = #0#2;
     |SI aHCuenta < #0#4;                 aHCuenta = #0#4; |FINSI;
     |SI aHCuenta < #0#6;                 aHCuenta = #0#6; |FINSI;

     |HAZ Leeimprime;
 |FINSI;

 |SI #0#0 ! "C";
     desde = "P";

     aDCuenta = #0#7;
     |SI aDCuenta > #0#9;  |Y #0#10 ! doce; aDCuenta = #0#9;  |FINSI;
     |SI aDCuenta > #0#11; |Y #0#12 ! doce; aDCuenta = #0#11; |FINSI;
     |SI aDCuenta > #0#13; |Y #0#14 ! doce; aDCuenta = #0#13; |FINSI;
     aHCuenta = #0#8;
     |SI aHCuenta < #0#10;                 aHCuenta = #0#10; |FINSI;
     |SI aHCuenta < #0#12;                 aHCuenta = #0#12; |FINSI;
     |SI aHCuenta < #0#14;                 aHCuenta = #0#14; |FINSI;

     |HAZ Leeimprime;
 |FINSI;

|FPRC;


|| **********************************************************************
|PROCESO MultiEmp1;
   cod1 = #caselem1#1;
   cod2 = #caselem1#2;
   emEmp = 1;  || Sin mensaje
   |HAZ leelo;
   |SI swerror ! 0;  |ACABA;   |FINSI;

   dirfich0 = #caselem1#3;
   |QBF dirfich0;

   |PATH_DAT #1 dirfich0;
   |PATH_DAT #2 dirfich0;
   |HAZ HazTodo;
|FPRC;

|DEFBUCLE MultiEmp0;
 #caselem1#1;
 ;
 000001;
 999999;
 ;
 NULL,MultiEmp1;
|FIN;

|PROCESO MultiEmpresa;
  |SUB_EJECUTA "caselemp";
  |NOME_DAT #998 eaFichsel;
  |BUCLE MultiEmp0;
  |DELINDEX #998;
|FPRC;
