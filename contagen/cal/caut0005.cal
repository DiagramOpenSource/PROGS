|FICHEROS;
   caut0005 #0;

   cacuenta #4;
   :/modelos/def/dsmom030 #1;
   caivaasi #200;
   cadeflab #210;

   canempre #30;
   caselem1 #998;
|FIN;

|VARIABLES;
   &entrada  = 1;
   aFichero  = "";
   aAlfa1    = "";
   aAlfa2    = "";
   aAlfa3    = "";
   aAlfa4    = "";
   nSwError  = 0;
   aParam    = "";
   aConforme = "";
   aBlanc    = "";
   swS = 0;
   swF = 0;
   swC = 0;
   swN = 0;
   swR = 0;
   swT = 0;
   nSwP = 0;

   inkey     = 0;
   ConcepAnt = 0;
   long      = 0;
   nSwLaC    = 0;
   nNume1    = 0;
   nPara1    = 0;
|FIN;

|INCLUYE dscont_i;
|INCLUYE modulo_i;

____________________________________/ CALCULOS DESDE PANTALLA
|CALCULO cQuePongo7; |TIPO 7;
  nSwP = 0;
  |HAZ EsComersan;
  |SI FSalida = 0;  nSwP = 1; |FINSI;
  aAlfa1 = "    Astos Base/IVA: S-erie,F-actura, C-Cta Ctble.,N-ombre,R-ef., =Igual Cl/Pr ";
  |SI nSwP = 1;
      aAlfa1 = "    Astos Base/IVA: S-erie,F-Fra., C-Cta,N-ombre,R-ef.,P-Ref Prv, =Igual Cl/Pr";
  |FINSI;
  |MENSA aAlfa1;
|FCAL;

|CALCULO QuePongo; |TIPO 0;

 aAlfa1 = #0Campo; |QBF aAlfa1;
 |SI aAlfa1 = ""; |ACABA; |FINSI;

 |BLIN 4;
 swS = 0; swF = 0;
 swC = 0; swN = 0;
 swR = 0;

 aAlfa1 = #0Campo % 101;
 aAlfa2 = #0Campo % 201;
 aAlfa3 = #0Campo % 301;

 |SI #0Campo = "=  "; |ACABA; |FINSI;

 |SI aAlfa1 ! " ";
     swT = 0;
     |SI aAlfa1 = "S"; swS = 1; swT = 1; |FINSI;
     |SI aAlfa1 = "F"; swF = 1; swT = 1; |FINSI;
     |SI aAlfa1 = "C"; swC = 1; swT = 1; |FINSI;
     |SI aAlfa1 = "N"; swN = 1; swT = 1; |FINSI;
     |SI aAlfa1 = "R"; swR = 1; swT = 1; |FINSI;
     |SI aAlfa1 = "P"; |Y nSwP = 1;  swR = 1; swT = 1;  |FINSI;
     |SI swT ! 1; |ERROR; |ACABA; |FINSI;
 |FINSI;
 |SI aAlfa2 ! " ";
     swT = 0;
     |SI aAlfa2 = "S"; |Y swS = 0; swS = 1; swT = 1; |FINSI;
     |SI aAlfa2 = "F"; |Y swF = 0; swF = 1; swT = 1; |FINSI;
     |SI aAlfa2 = "C"; |Y swC = 0; swC = 1; swT = 1; |FINSI;
     |SI aAlfa2 = "N"; |Y swN = 0; swN = 1; swT = 1; |FINSI;
     |SI aAlfa2 = "R"; |Y swR = 0; swR = 1; swT = 1; |FINSI;
     |SI aAlfa2 = "P"; |Y nSwP = 1;  swR = 1; swT = 1;  |FINSI;
     |SI swT ! 1; |ERROR; |ACABA; |FINSI;
 |FINSI;
 |SI aAlfa3 ! " ";
     swT = 0;
     |SI aAlfa3 = "S"; |Y swS = 0; swS = 1; swT = 1; |FINSI;
     |SI aAlfa3 = "F"; |Y swF = 0; swF = 1; swT = 1; |FINSI;
     |SI aAlfa3 = "C"; |Y swC = 0; swC = 1; swT = 1; |FINSI;
     |SI aAlfa3 = "N"; |Y swN = 0; swN = 1; swT = 1; |FINSI;
     |SI aAlfa3 = "R"; |Y swR = 0; swR = 1; swT = 1; |FINSI;
     |SI aAlfa3 = "P"; |Y nSwP = 1;  swR = 1; swT = 1;  |FINSI;
     |SI swT ! 1; |ERROR; |ACABA; |FINSI;
 |FINSI;
|FCAL;

|CALCULO Antes112; |TIPO 7;
   |SI #0#2 = "S";
       |SI #0#0 = "N";
           |C_M #0#1,1,"N"; #0#1 = "S"; |PINTA #0#1;
       |SINO;
           |C_M #0#1,1,"S";
       |FINSI;
   |FINSI;
|FCAL;

|CALCULO Antes118; |TIPO 7;
  |SI #0#6 = "S";
      aAlfa1 = "S"; |SI #0#3 ! "S";  aAlfa1 = "N"; |FINSI;
      |C_M #0#4, 1, aAlfa1;
      #0#4 = aAlfa1; |PINTA #0#4;
  |FINSI;
|FCAL;

|PROCESO esauto;
 |C_M #0#25, 0, aAlfa1;
 |SI aAlfa1 = "N"; |ACABA; |FINSI;

 aAlfa1 = #0#25;
 |SI #0#25 = "S";
     aAlfa1 = "N"; #0#26 = "S";
                   #0#27 = "S";
 |SINO;
     aAlfa1 = "S";
 |FINSI;
 |C_M #0#26, 1, aAlfa1;
 |C_M #0#27, 1, aAlfa1;
 |PINTA #0#26;
 |PINTA #0#27;
|FPRC;

|CALCULO AntConcep; |TIPO 7;
  ConcepAnt = #0Campo;
|FCAL;

|CALCULO concepto;  |TIPO 0;
  inkey = FSalida;
  |C_M #0Campo, 0, aAlfa1;
  |SI aAlfa1 = "N"; |ACABA; |FINSI;

  |ABRE #dsmom030;
  #dsmom030#0 = #0Campo;
  |LEE 021#dsmom030.=;
  |SI FSalida ! 0;  |DDEFECTO #dsmom030;  |FINSI;
  |CIERRA #dsmom030;

  |SI #dsmom030#4 = "S"; |O #dsmom030#5 = "S";
      |MENAV "    Error. Concepto no Corresponde a Cobros/Pagos";
      |SI #caivaasi#95 = "S";
          |ERROR;
      |FINSI;
  |FINSI;
|FCAL;

|CALCULO recoge; |TIPO 7;
  |C_M #0Campo, 0, aAlfa1;
  |SI aAlfa1 = "N"; |ACABA; |FINSI;

   nNume1 = Campo - 1;
   |SI #0nNume1 ! ConcepAnt;
       |ABRE #dsmom030;
       #dsmom030#0 = #0nNume1;
       |LEE 021#dsmom030.=;
       |SI FSalida ! 0;  |DDEFECTO #dsmom030;  |FINSI;
       #0Campo = #dsmom030#1;
       |PINTA #0Campo;
       |CIERRA #dsmom030;
       |PTEC 816;
   |FINSI;
|FCAL;

|CALCULO cuenta; |TIPO 6;
  |C_M #0Campo,0,aAlfa1;
  |SI aAlfa1 = "N"; |ACABA; |FINSI;

  eaCuenta = #0Campo;
  salidas  = FSalida;
  |HAZ FiltraPuntos;
  #0Campo = eaCuenta;
  |PINTA #0Campo;

  emCta = 1;
  eaCuenta = #0Campo;
  |HAZ SacaNivel;
|FCAL;

|PROCESO inf4;
 #4#0 = "            ";
 #4#3 = "S";
|FPRC;

|PROCESO sup4;
 #4#0 = "zzzzzzzzzzzz";
 #4#3 = "S";
|FPRC;

|PROCESO cuenta_esp; |TIPO 6;
  inkey = FSalida;
  |C_M #0Campo,0,aAlfa1;
  |SI aAlfa1 = "N"; |ACABA; |FINSI;

  |SI inkey = 10;
      #4#0 = #0Campo;
      |ABRE #4;
      |CONSULTA_F_CLAVE #6#4, inf4,sup4;
      |CIERRA #4;
      #0Campo = #4#0; |PINTA #0Campo;
      |ERROR;
      |ACABA;
  |FINSI;

  aAlfa1 = #0Campo; |QBF aAlfa1;
  aAlfa2 = aAlfa1 % 0; long  = aAlfa2;

  aAlfa4 = "";
  nSwLaC = 0;
  nSwError = 0;
  |PARA nPara1 = 1; |SI nPara1 [ long; |HACIENDO nPara1 = nPara1 + 1;
        nNume1 = (nPara1 * 100) + 1;
        aAlfa3 = aAlfa1 % nNume1;

        |SI aAlfa3 = "c"; |O aAlfa3 = "C";  nSwLaC = 1; aAlfa3 = "C"; |FINSI;
        aAlfa4 = aAlfa4 + aAlfa3;

        |SI aAlfa3 = "*";
            |SAL;
        |SINO;
            |SI aAlfa3 < "0"; |O aAlfa3 > "9";
                |SI aAlfa3 ! "C"; |Y aAlfa3 ! ".";
                    nSwError = 1; |SAL;
                |FINSI;
            |FINSI;
        |FINSI;
  |SIGUE;
  |SI nSwError = 1;
      |MENAV "    Cuenta Mal Informada";
      |ERROR;
      |ACABA;
  |FINSI;
  #0Campo = aAlfa4; |PINTA #0Campo;

  nNume1 = (long * 100) + 1;
  aAlfa2 = aAlfa4 % nNume1;

  |SI aAlfa2 ! "*";
      || ......................... Calculo de Digito.
      eaCuenta = #0Campo;
      salidas  = FSalida;
      |HAZ FiltraPuntos;
      #0Campo = eaCuenta;
      |PINTA #0Campo;

      emCta = 1;
      eaCuenta = #0Campo;
      |HAZ SacaNivel;
      |SI eswCta = 0; |Y nSwLaC = 0;
          |HAZ LeeCuenta;
      |FINSI;
  |FINSI;
|FPRC;

|CALCULO losembargos;
  aAlfa1 = "S";
  |SI #0#98= "N"; |O #0#98 = "F";
      aAlfa1 = "N";
      #0#99 = 0; |PINTA #0#99;
  |FINSI;
  |C_M #0#99, 1, aAlfa1;
|FCAL;

|CALCULO conceptoE;  |TIPO 0;
      inkey = FSalida;
      |C_M #0Campo,0,aAlfa1;
      |SI aAlfa1 = "N"; |ACABA; |FINSI;

      |SI #0Campo = 0; |ACABA; |FINSI;

      |ABRE #dsmom030;
      #dsmom030#0 = #0Campo;
      |LEE 021#dsmom030.=;
      |SI FSalida ! 0;
          |MENAV "    No existe Concepto.";
          |ERROR;
          |ACABA;
      |FINSI;
      |CIERRA #dsmom030;

      |SI #dsmom030#4 = "S"; |O #dsmom030#5 = "S";
          |MENAV "    Error. Concepto no Corresponde a Cobros/Pagos";
      |FINSI;
|FCAL;


|CALCULO QueHago; |TIPO 0;
  aAlfa1 = #0Campo;
  |SI Campo = 2;
      |C_M #0#0, 1, aAlfa1;
      |C_M #0#1, 1, aAlfa1;
  |FINSI;

  |SI Campo = 6;
      |C_M #0#3, 1, aAlfa1;
      |C_M #0#4, 1, aAlfa1;
      |C_M #0#5, 1, aAlfa1;
  |FINSI;

  |SI Campo = 13;
      |C_M #0#7,   1, aAlfa1;
      |C_M #0#8,   1, aAlfa1;
      |C_M #0#9,   1, aAlfa1;
      |C_M #0#120, 1, aAlfa1;
      |C_M #0#10,  1, aAlfa1;
      |C_M #0#11,  1, aAlfa1;
      |C_M #0#12,  1, aAlfa1;
      |C_M #0#16,  1, aAlfa1;
  |FINSI;

  |SI Campo = 15;
      |C_M #0#14,  1, aAlfa1;
  |FINSI;

  |SI Campo = 19;
      |C_M #0#17,  1, aAlfa1;
      |C_M #0#18,  1, aAlfa1;
  |FINSI;

  |SI Campo = 22;
      |C_M #0#20,  1, aAlfa1;
      |C_M #0#21,  1, aAlfa1;
  |FINSI;

  |SI Campo = 24;
      |C_M #0#23,  1, aAlfa1;
  |FINSI;

  |SI Campo = 28;
      |C_M #0#25,  1, aAlfa1;
      |C_M #0#26,  1, aAlfa1;
      |C_M #0#27,  1, aAlfa1;
  |FINSI;

  |SI Campo = 31;
      |C_M #0#29,  1, aAlfa1;
      |C_M #0#30,  1, aAlfa1;
  |FINSI;

  |SI Campo = 34;
      |C_M #0#32,  1, aAlfa1;
      |C_M #0#33,  1, aAlfa1;
      |C_M #0#118, 1, aAlfa1;
  |FINSI;

  |SI Campo = 39;
      |C_M #0#35,  1, aAlfa1;
      |C_M #0#36,  1, aAlfa1;
      |C_M #0#37,  1, aAlfa1;
      |C_M #0#38,  1, aAlfa1;
  |FINSI;

  |SI Campo = 44;
      |C_M #0#40,  1, aAlfa1;
      |C_M #0#41,  1, aAlfa1;
      |C_M #0#42,  1, aAlfa1;
      |C_M #0#43,  1, aAlfa1;
      |C_M #0#58,  1, aAlfa1;
  |FINSI;

  |SI Campo = 47;
      |C_M #0#45,  1, aAlfa1;
      |C_M #0#46,  1, aAlfa1;
      |C_M #0#119, 1, aAlfa1;
  |FINSI;

  |SI Campo = 52;
      |C_M #0#48,  1, aAlfa1;
      |C_M #0#49,  1, aAlfa1;
      |C_M #0#50,  1, aAlfa1;
      |C_M #0#51,  1, aAlfa1;
  |FINSI;

  |SI Campo = 57;
      |C_M #0#53,  1, aAlfa1;
      |C_M #0#54,  1, aAlfa1;
      |C_M #0#55,  1, aAlfa1;
      |C_M #0#56,  1, aAlfa1;
      |C_M #0#59,  1, aAlfa1;
  |FINSI;

  |SI Campo = 61;
      |C_M #0#60,  1, aAlfa1;
  |FINSI;

  |SI Campo = 63;
      |C_M #0#62,  1, aAlfa1;
  |FINSI;

  |SI Campo = 66;
      |C_M #0#64,  1, aAlfa1;
      |C_M #0#65,  1, aAlfa1;
  |FINSI;

  |SI Campo = 69;
      |C_M #0#67,  1, aAlfa1;
      |C_M #0#68,  1, aAlfa1;
  |FINSI;

  |SI Campo = 72;
      |C_M #0#70,  1, aAlfa1;
      |C_M #0#71,  1, aAlfa1;
  |FINSI;

  |SI Campo = 75;
      |C_M #0#73,  1, aAlfa1;
      |C_M #0#74,  1, aAlfa1;
  |FINSI;

  |SI Campo = 78;
      |C_M #0#76,  1, aAlfa1;
      |C_M #0#77,  1, aAlfa1;
  |FINSI;

  |SI Campo = 80;
      |C_M #0#79,  1, aAlfa1;
  |FINSI;

  |SI Campo = 83;
      |C_M #0#81,  1, aAlfa1;
      |C_M #0#82,  1, aAlfa1;
  |FINSI;

  |SI Campo = 86;
      |C_M #0#84,  1, aAlfa1;
      |C_M #0#85,  1, aAlfa1;
  |FINSI;

  |SI Campo = 88;
      |C_M #0#87,  1, aAlfa1;
  |FINSI;

  |SI Campo = 90;
      |C_M #0#89,  1, aAlfa1;
  |FINSI;

  |SI Campo = 92;
      |C_M #0#91,  1, aAlfa1;
  |FINSI;

  |SI Campo = 95;
      |C_M #0#93,  1, aAlfa1;
      |C_M #0#94,  1, aAlfa1;
  |FINSI;

  |SI Campo = 97;
      |C_M #0#96,  1, aAlfa1;
  |FINSI;

  |SI Campo = 100;
      |C_M #0#98,  1, aAlfa1;
      |C_M #0#99,  1, aAlfa1;
  |FINSI;

  |SI Campo = 102;
      |C_M #0#101,  1, aAlfa1;
  |FINSI;

  |SI Campo = 104;
      |C_M #0#103,  1, aAlfa1;
  |FINSI;

  |SI Campo = 117;
      |C_M #0#105,  1, aAlfa1;
      |C_M #0#106,  1, aAlfa1;
      |C_M #0#107,  1, aAlfa1;
      |C_M #0#108,  1, aAlfa1;
      |C_M #0#109,  1, aAlfa1;
      |C_M #0#110,  1, aAlfa1;
      |C_M #0#111,  1, aAlfa1;
      |C_M #0#112,  1, aAlfa1;
      |C_M #0#113,  1, aAlfa1;
      |C_M #0#114,  1, aAlfa1;
      |C_M #0#115,  1, aAlfa1;
      |C_M #0#116,  1, aAlfa1;
  |FINSI;

  |SI Campo = 122;
      |C_M #0#121,  1, aAlfa1;
  |FINSI;

  |SI Campo = 124;
      |C_M #0#123,  1, aAlfa1;
  |FINSI;

  |SI Campo = 126;
      |C_M #0#125,  1, aAlfa1;
  |FINSI;

  |SI Campo = 128;
      |C_M #0#127,  1, aAlfa1;
      |C_M #0#129,  1, aAlfa1;
      |C_M #0#130,  1, aAlfa1;
  |FINSI;

  |SI Campo = 132;
      |C_M #0#131,  1, aAlfa1;
  |FINSI;

|FCAL;

|CALCULO ClCaja; |TIPO 0;
      |C_M #0Campo,0,aAlfa1;
      |SI aAlfa1 = "N"; |ACABA; |FINSI;

      nNume1 = Campo + 1;
      aAlfa1 = "S";
      |SI #0Campo = " ";
          aAlfa1 = "N";
          #0nNume1 = "S"; |PINTA #0nNume1;
      |FINSI;
      |C_M #0nNume1, 1, aAlfa1;
|FCAL;

|CALCULO conceptoCaja;  |TIPO 0;
      inkey = FSalida;
      |C_M #0Campo,0,aAlfa1;
      |SI aAlfa1 = "N"; |ACABA; |FINSI;

      |SI #0Campo = 0; |ACABA; |FINSI;

      |ABRE #dsmom030;
      #dsmom030#0 = #0Campo;
      |LEE 041#dsmom030.=;
      |SI FSalida ! 0;
          |MENAV "    No existe Concepto.";
          |ERROR;
          |ACABA;
      |FINSI;
      |CIERRA #dsmom030;

      nNume1 = 0;
      aAlfa1 = "";
      |SI Campo = 109; |O Campo = 111;
          |SI #dsmom030#7 = "N";
              aAlfa1 = "    Error. Concepto no Corresponde a Caja en Efectivo";
               nNume1 = 1;
          |FINSI;
      |SINO;
          |SI #dsmom030#4 = "S"; |O #dsmom030#5 = "S"; |O #dsmom030#8 = "S";
              aAlfa1 = "    Error. Concepto no Corresponde a Cobros/Pagos";
              nNume1 = 1;
          |FINSI;
      |FINSI;
      |SI nNume1 = 1;
          |SI #0#95 ! "X";
              |MENAV aAlfa1;
          |FINSI;
          |SI #0#95 = "S";
              |ERROR;
          |FINSI;
      |FINSI;
|FCAL;

|CALCULO CobroAM;
      |C_M #0Campo,0,aAlfa1;
      |SI aAlfa1 = "N"; |ACABA; |FINSI;

      aAlfa1 = "S";
      |SI #0Campo = "M"; aAlfa1 = "N"; |FINSI;
      nNume1 = Campo - 4;  |C_M #0nNume1, 1, aAlfa1;
      nNume1 = nNume1 + 1; |C_M #0nNume1, 1, aAlfa1;
|FCAL;

|CALCULO ladesv;
  |SI #0#13 = "S";
      aAlfa1 = #0Campo;
      |C_M #0#120,1,aAlfa1;
      |SI aAlfa1 = "N"; #0#120 = 0; |PINTA #0#120; |FINSI;
  |FINSI;
|FCAL;

|| ***********************************************************************

|PROCESO HazTodo;

   |PATH_DAT #200 dirfich0;
   |PATH_DAT #210 dirfich0;

   |ABRE #200;
   |LEE 141#200p;
   |SI FSalida ! 0;
       |DDEFECTO #200;
       |GRABA 020#200b;
   |FINSI;

   |SI #0#2 = "S";
       #200#111 = #0#0;
       #200#112 = #0#1;
   |FINSI;
   |SI #0#6 = "S";
       #200#95  = #0#3;
       #200#118 = #0#4;
       #200#119 = #0#5;
   |FINSI;
   |SI #0#13 = "S";
       #200#120 = #0#7;
       #200#121 = #0#8;
       #200#122 = #0#9;
       #200#183 = #0#120;
       #200#123 = #0#10;
       #200#124 = #0#11;
       #200#125 = #0#12;
       #200#127 = #0#16;
   |FINSI;
   |SI #0#15 = "S";
       #200#126 = #0#14;
   |FINSI;
   |SI #0#19 = "S";
       #200#128 = #0#17;
       #200#129 = #0#18;
   |FINSI;
   |SI #0#22 = "S";
       #200#130 = #0#20;
       #200#131 = #0#21;
   |FINSI;
   |SI #0#24 = "S";
       #200#132 = #0#23;
   |FINSI;
   |SI #0#28 = "S";
       #200#114 = #0#25;
       #200#133 = #0#26;
       #200#134 = #0#27
   |FINSI;
   |SI #0#31 = "S";
       #200#135 = #0#29;
       #200#136 = #0#30;
   |FINSI;
   |SI #0#34 = "S";
       #200#48  = #0#32;
       #200#103 = #0#33;

       #200#181 = #0#118;
   |FINSI;
   |SI #0#39 = "S";
       #200#49  = #0#35;
       #200#50  = #0#36;
       #200#51  = #0#37;
       #200#99  = #0#38;
   |FINSI;
   |SI #0#44 = "S";
       #200#138 = #0#40;
       #200#139 = #0#41;
       #200#140 = #0#42;
       #200#141 = #0#43;
       #200#146 = #0#58;
   |FINSI;
   |SI #0#47 = "S";
       #200#52  = #0#45;
       #200#137 = #0#46;
       #200#182 = #0#119;
   |FINSI;
   |SI #0#52 = "S";
       #200#53  = #0#48;
       #200#54  = #0#49;
       #200#55  = #0#50;
       #200#100 = #0#51;
   |FINSI;
   |SI #0#57 = "S";
       #200#142 = #0#53;
       #200#143 = #0#54;
       #200#144 = #0#55;
       #200#145 = #0#56;
       #200#147 = #0#59;
   |FINSI;

   |SI #0#61 = "S";
       #200#148 = #0#60;
   |FINSI;

   |SI #0#63 = "S";
       #200#149 = #0#62;
       |SI #0#62 = "I"; #200#149 = #200#46; |FINSI;
   |FINSI;

   |SI #0#66 = "S";
       #200#150 = #0#64;
       #200#151 = #0#65;
   |FINSI;

   |SI #0#69 = "S";
       #200#152 = #0#67;
       #200#153 = #0#68;
   |FINSI;

   |SI #0#72 = "S";
       #200#9  = #0#70;
       #200#10 = #0#71;
   |FINSI;

   |SI #0#75 = "S";
       #200#11 = #0#73;
       #200#12 = #0#74;
   |FINSI;

   |SI #0#78 = "S";
       #200#154 = #0#76;
       #200#155 = #0#77;
   |FINSI;

   |SI #0#80 = "S";
       #200#156 = #0#79;
   |FINSI;

   |SI #0#83 = "S";
       #200#157 = #0#81;
       #200#158 = #0#82;
   |FINSI;

   |SI #0#86 = "S";
       #200#159 = #0#84;
       #200#160 = #0#85;
   |FINSI;

   |SI #0#88 = "S";
       #200#161 = #0#87;
       |SI #200#1 = "S"; #200#161 = "N"; |FINSI;
   |FINSI;

   |SI #0#90 = "S";
       #200#162 = #0#89;
       |SI #200#1 = "N"; #200#162 = "N"; |FINSI;
   |FINSI;

   |SI #0#92 = "S";
       #200#163 = #0#91;
   |FINSI;

   |SI #0#95 = "S";
       #200#35 = #0#93;
       #200#36 = #0#94;
   |FINSI;

   |SI #0#97 = "S";
       #200#164 = #0#96;
   |FINSI;

   |SI #0#100 = "S";
       #200#165 = #0#98;
       #200#166 = #0#99;
   |FINSI;

   |SI #0#102 = "S";
       #200#167 = #0#101;
   |FINSI;

   |SI #0#104 = "S";
       #200#168 = #0#103;
   |FINSI;

   |SI #0#117 = "S";
       #200#169 = #0#105;
       #200#170 = #0#106;
       #200#171 = #0#107;
       #200#172 = #0#108;
       #200#173 = #0#109;
       #200#174 = #0#110;
       #200#175 = #0#111;
       #200#176 = #0#112;
       #200#177 = #0#113;
       #200#178 = #0#114;
       #200#179 = #0#115;
       #200#180 = #0#116;
   |FINSI;

   |SI #0#122 = "S";
       #200#184 = #0#121;
   |FINSI;

   |SI #0#124 = "S";
       #200#185 = #0#123;
   |FINSI;

   |SI #0#126 = "S";
       #200#186 = #0#125;
   |FINSI;

   |SI #0#128 = "S";
       #200#188 = #0#127;
       #200#189 = #0#129;
       #200#190 = #0#130;
   |FINSI;

   |SI #0#132 = "S";
       #200#187 = #0#131;
   |FINSI;

   |GRABA 020#200a;
   |LIBERA #200;
   |CIERRA #200;
|FPRC;

|PROCESO MultiEmp1;
   cod1 = #caselem1#1;
   cod2 = #caselem1#2;
   emEmp = 1;  || Sin mensaje
   |HAZ leelo;
   |SI swerror ! 0;  |ACABA;   |FINSI;

   |PINTA 2222, #30#2;
   |PINTA 2228, #30#3;
   |PINTA 2230, #30#1;

   dirfich0  = #caselem1#3;
   |QBF dirfich0;

   |HAZ HazTodo;
|FPRC;


|DEFBUCLE MultiEmp0;
 #caselem1#1;
 ;
 00001;
 99999;
 ;
 NULL,MultiEmp1;
|FIN;


|CALCULO recupera; |TIPO 3;

   |SI #0#2 = "N"; |Y #0#6 = "N"; |Y #0#13 = "N"; |Y #0#15 = "N";
       |Y #0#19 = "N"; |Y #0#22 = "N"; |Y #0#24 = "N"; |Y #0#28 = "N";
         |Y #0#31 = "N"; |Y #0#34 = "N"; |Y #0#39 = "N"; |Y #0#44 = "N";
          |Y #0#47 = "N"; |Y #0#52 = "N"; |Y #0#57 = "N"; |Y #0#61 = "N";
            |Y #0#63 = "N"; |Y #0#66 = "N"; |Y #0#69 = "N"; |Y #0#72 = "N";
              |Y #0#75 = "N"; |Y #0#78 = "N"; |Y #0#80 = "N"; |Y #0#83 = "N";
                |Y #0#86 = "N"; |Y #0#88 = "N"; |Y #0#90 = "N"; |Y #0#92 = "N";
                  |Y #0#95 = "N"; |Y #0#97 = "N"; |Y #0#100 = "N"; |Y #0#102 = "N";
                    |Y #0#104 = "N"; |Y #0#117 = "N"; |Y #0#122 = "N"; |Y #0#124 = "N";
                      |Y #0#126 = "N"; |Y #0#128 = "N"; |Y #0#132 = "N";
       |MENAV "    NO MODIFICA NINGUN DATO DE LOS DEFECTOS DE ENTRADA";
       |ACABA;
   |FINSI;

   |SUB_EJECUTA "caselemp";
   |NOME_DAT #998 eaFichsel;
   |ATRI R; |PINTA 2202, "Procesando Empresa: "; |ATRI 0;
   |BUCLE MultiEmp0;
   |DELINDEX #998;
|FCAL;

|PROCESO LosDefectos; |TIPO 7;
 |ABRE #caivaasi;
 |LEE 001#caivaasi.p;
 |CIERRA #caivaasi;

 #0#0 = #200#111;
 #0#1 = #200#112;

 #0#3 = #200#95;
 #0#4 = #200#118;
 #0#5 = #200#119;

 #0#7 = #200#120;
 #0#8 = #200#121;
 #0#9 = #200#122;
 #0#120 = #200#183;
 #0#10 = #200#123;
 #0#11 = #200#124;
 #0#12 = #200#125;
 #0#16 = #200#127;

 #0#14 = #200#126;

 #0#17 = #200#128;
 #0#18 = #200#129;

 #0#20 = #200#130;
 #0#21 = #200#131;

 #0#23 = #200#132;

 #0#25 = #200#114;
 #0#26 = #200#133;
 #0#27 = #200#134;

 #0#29 = #200#135;
 #0#30 = #200#136;

 #0#32 = #200#48;
 #0#33 = #200#103;
 #0#118 = #200#181;

 #0#35 = #200#49;
 #0#36 = #200#50;
 #0#37 = #200#51;
 #0#38 = #200#99;

 #0#40 = #200#138;
 #0#41 = #200#139;
 #0#42 = #200#140;
 #0#43 = #200#141;

 #0#45 = #200#52;
 #0#46 = #200#137;

 #0#48 = #200#53;
 #0#49 = #200#54;
 #0#50 = #200#55;
 #0#51 = #200#100;
 #0#58 = #200#146;

 #0#53 = #200#142;
 #0#54 = #200#143;
 #0#55 = #200#144;
 #0#56 = #200#145;
 #0#59 = #200#147;

 #0#60 = #200#148;
 #0#62 = #200#149;

 #0#64 = #200#150;
 #0#65 = #200#151;

 #0#67 = #200#152;
 #0#68 = #200#153;

 #0#70 = #200#9;
 #0#71 = #200#10;

 #0#73 = #200#11;
 #0#74 = #200#12;

 #0#76 = #200#154;
 #0#77 = #200#155;

 #0#79 = #200#156;

 #0#81 = #200#157;
 #0#82 = #200#158;

 #0#84 = #200#159;
 #0#85 = #200#160;

 |SI #0#1 = "S";
     #0#87 = "N";
     #0#89 = #200#162;
 |SINO;
     #0#87 = #200#161;
     #0#89 = "N";
 |FINSI;

 #0#91 = #200#163;
 #0#93 = #200#35;
 #0#94 = #200#36;
 #0#96 = #200#164;

 #0#98 = #200#165;
 #0#99 = #200#166;

 #0#101 = #200#167;
 #0#103 = #200#168;

 #0#105 = #200#169;
 #0#106 = #200#170;
 #0#107 = #200#171;
 #0#108 = #200#172;
 #0#109 = #200#173;
 #0#110 = #200#174;
 #0#111 = #200#175;
 #0#112 = #200#176;
 #0#113 = #200#177;
 #0#114 = #200#178;
 #0#115 = #200#179;
 #0#116 = #200#180;
 #0#118 = #200#181;
 #0#119 = #200#182;
 #0#121 = #200#184;
 #0#123 = #200#185;
 #0#125 = #200#186;
 #0#127 = #200#188;
 #0#129 = #200#189;
 #0#130 = #200#190;
 #0#131 = #200#187;
|FPRC;
