|FICHEROS;
 anm00000 #0;
 anm00016 #16;
 canempre #30;
|FIN;

|VARIABLES;
 aAlfa1 = "";
 nNume1 = 0;
 nPara1 = 0;
 error1 = "0000Error. ­ Nivel Incorrecto ! ";
 error2 = "0000Nivel Analitica repetido o valor mas bajo que los anteriores";
 nInkey = 0;
 nModo = 0;
 &eswPro = 0;
 &r_emp = 0;
|FIN;

|INCLUYE dscont_i;
|INCLUYE dscoan_i;

|| ********************************************************************
|PROCESO MensaCli; |TIPO 7;
     |MENSA "      <F2> Consulta Clientes, <F12> Consulta Empresas Contables";
     || ... |MENSA "      123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
|FPRC;

|PROCESO ConsuCli; |TIPO 11;
 nInkey = FSalida;
 |SI nInkey = 10; |O nInkey = 11;
     FSalida = nInkey;
     |HAZ ConsuCliente;
     |ERROR;
     |PTEC 802;
 |SINO;
     |SI nInkey =  9;
         r_emp = #16#0;
         |SUB_EJECUTA_NP "caconemp";
         |ERROR;
         #16#0 = r_emp;
         |PTEC 802;
     |FINSI;
 |FINSI;
|FPRC;

|PROCESO LeoEmp; |TIPO 0;
   nModo = (FEntrada / 100) ! 0;
||    |SI nModo = 3; |ACABA; |FINSI;

   |ABRE #30;
   #30#2 = #16#0;
   #30#3 = 0;
   |LEE 011#30];
   |SI FSalida ! 0;  |O #30#2 ! #16#0;
      |SI nModo = 2;
          |CONFI "    SNO Existe la empresa Contable, Dar de baja Ficha";
          |SI FSalida = 0;
              |PTEC 802;
              |PTEC 811;
          |SINO;
              |ERROR;
          |FINSI;
      |SINO;
          |MENAV "     NO Existe la empresa Contable";
          |ERROR;
      |FINSI;
      |CIERRA #30;
      |ACABA;
   |SINO;
      |CIERRA #30;
   |FINSI;
   #16#12 = #30#1; |PINTA #16#12;

   |SI nModo = 1;
       |PARA nPara1 = 2; |SI nPara1 [ 10; |HACIENDO nPara1 = nPara1 + 1;
             #16nPara1 = #0nPara1;
             |PINTA #16nPara1;
       |SIGUE;
       #16#13 = #0#12; |PINTA #16#13;
       #16#14 = #0#13; |PINTA #16#14;
   |FINSI;
|FPRC;

|CALCULO NSRef16; |TIPO 0;
  aAlfa1 = #16#8;
  |C_M #16#13, 1, aAlfa1;
  |SI aAlfa1 = "N"; #16#13 = 20; |PINTA #16#13; |FINSI;
|FCAL;

|CALCULO numnivana16; |TIPO 0;
  |SI FSalida = 2; |ACABA; |FINSI;

  |CAMPO_MODIFICA #16#3, 1,"S";
  |CAMPO_MODIFICA #16#4, 1,"S";
  |CAMPO_MODIFICA #16#5, 1,"S";
  |CAMPO_MODIFICA #16#6, 1,"S";
  |CAMPO_MODIFICA #16#7, 1,"S";

  |SI #16#2 < 5;
      |CAMPO_MODIFICA #16#6, 1,"N";
      |CAMPO_MODIFICA #16#7, 1,"N";
      #16#6 = 7;
      #16#7 = 0;
      |SI #16#2 < 4;
          |CAMPO_MODIFICA #16#5, 1,"N";
          |CAMPO_MODIFICA #16#6, 1,"N";
          #16#5 = 7;
          #16#6 = 0;
          |SI #16#2 < 3;
              |CAMPO_MODIFICA #16#4, 1,"N";
              |CAMPO_MODIFICA #16#5, 1,"N";
              #16#4 = 7;
              #16#5 = 0;
              |SI #16#2 < 2;
                  |CAMPO_MODIFICA #16#3, 1, "N";
                  |CAMPO_MODIFICA #16#4, 1, "N";
                  #16#3 = 7;
                  #16#4 = 0;
              |FINSI;
          |FINSI;
      |FINSI;
  |SINO;
      |CAMPO_MODIFICA #16#7, 1, "N";
      #16#7 = 7;
  |FINSI;
  |PINTA #16#3;
  |PINTA #16#4;
  |PINTA #16#5;
  |PINTA #16#6;
  |PINTA #16#7;
|FCAL;

|CALCULO nivelana16; |TIPO 0;
  nNume1 = #16#2 + 2;
  |SI Campo ! nNume1; |Y  #16Campo = 7;
      |MENAV error1;
      |ERROR;
      |ACABA;
  |FINSI;
  |SI Campo = nNume1; |Y  #16Campo ! 7;
      |MENAV error1;
      |ERROR;
      |ACABA;
  |FINSI;

  |SI Campo = 4;  |Y #16#4 = 0; |Y #16#2 ] 2;
      |MENAV error2;
      |ERROR;
      |ACABA;
  |FINSI;

  |SI Campo = 5;  |Y #16#5 = 0; |Y #16#2 ] 3;
      |MENAV error2;
      |ERROR;
      |ACABA;
  |FINSI;
  |SI Campo = 6;  |Y #16#6 = 0; |Y #16#2 ] 4;
      |MENAV error2;
      |ERROR;
      |ACABA;
  |FINSI;
  |SI Campo = 7;  |Y #16#7 = 0; |Y #16#2 ] 5;
      |MENAV error2;
      |ERROR;
      |ACABA;
  |FINSI;

  |SI Campo = 4; |Y #16#4 ! 0;    || Si hay dos niveles iguales o menor error
      |SI #16#4 [ #16#3;
          |MENAV error2;
          |ERROR;
          |ACABA;
      |FINSI;
  |FINSI;

  |SI Campo = 5; |Y #16#5 ! 0; || Si hay dos niveles iguales o menor error
      |SI #16#5 [ #16#3; |O #16#5 [ #16#4;
          |MENAV error2;
          |ERROR;
          |ACABA;
      |FINSI;
  |FINSI;

  |SI Campo = 6; |Y #16#6 ! 0; || Si hay dos niveles iguales o menor error
      |SI #16#6 [ #16#3; |O #16#6 [ #16#4; |O #16#6 [ #16#5;
         |MENAV error2;
         |ERROR;
         |ACABA;
      |FINSI;
  |FINSI;

  |SI Campo = 7; |Y #16#7 ! 0; || Si hay dos niveles iguales o menor error
      |SI #16#7 [ #16#3; |O #16#7 [ #16#4; |O #16#7 [ #16#5; |O #16#7 [ #16#6;
          |MENAV error2;
          |ERROR;
      |FINSI;
  |FINSI;
|FCAL;

|CALCULO cuadro16; |TIPO 7;
  |SI eswPro = 1;
      |PUSHV 1325 1868;
      |CUADRO 1325 1868;
      |ATRI R;
      |PINTA 1426, " -- PEDIR EL CAMPO DE CUENTA ANALITICA -- ";
      |PINTA 1526, " (S) SOLO en apuntes de Cuentas Contables ";
      |PINTA 1626, "     que existen en la tabla de Relacion  ";
      |PINTA 1726, " (N) en TODOS los apuntes.                ";
      |ATRI 0;
  |FINSI;
|FCAL;

|CALCULO cuadro116; |TIPO 7;
  |SI eswPro = 1;
      |PUSHV 1425 1964;
      |CUADRO 1425 1964;
      |ATRI R;
      |PINTA 1526, " -- REPARTO DE GRUPO DE ANALITICA --  ";
      |PINTA 1626, " (S) SIEMPRE fijo, en base al reparto ";
      |PINTA 1726, "     del mantenimiento del Grupo      ";
      |PINTA 1826, " (N) poder modificar en cada apunte   ";
      |ATRI 0;
  |FINSI;
|FCAL;

|CALCULO cuadro216; |TIPO 7;
  |SI eswPro = 1;
      |PUSHV 1425 1964;
      |CUADRO 1425 1964;
      |ATRI R;
      |PINTA 1526, " -- OBLIGACION PARA CUENTAS 6 Y 7 --  ";
      |PINTA 1626, " (S) Introducir SIEMPRE cta Analitica ";
      |PINTA 1726, "     en Apuntes de las Cuentas 6 y 7  ";
      |PINTA 1826, " (N) Opcional, poder dejarla en blanco";
      |ATRI 0;
  |FINSI;
|FCAL;

|CALCULO cuadro016; |TIPO 0;
   |SI eswPro = 1;
       |POPV;
   |FINSI;
|FCAL;
