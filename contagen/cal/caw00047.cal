|FICHEROS;
   caw00047 #0;
   caivaasi #200;
   :/modelos/def/dsmom030;
|FIN;

|VARIABLES;
   aAlfa = "";
  {40}aPopup        = "";
     nID            = 0;
     aID            = "";
     aTexto         = "";
   nNume1 = 0;
|FIN;

|INCLUYE dscont_i;
|INCLUYE dscoiv_i;
|INCLUYE cla340_i;

|| /////////////////////////////////////////////////////////////
|PROCESO TrasC6;
       |ABRE #200;
       |DDEFECTO #200;
       |LEE 041#200p;
       |CIERRA #200;

       Campo = 0; enConcepto = 0; |HAZ DefConcepto;
       #0#0 = enConcepto; |PINTA #0#0;

       Campo = 3; enConcepto = 0; |HAZ DefConcepto;
       #0#3 = enConcepto; |PINTA #0#3;

       Campo = 6;
|FPRC;

|PROCESO c_inf;
   #dsmom030#0 = 1;
|FPRC;

|PROCESO c_sup;
   #dsmom030#0 = 999;
|FPRC;

|PROCESO DefConcepto;
       |SI enConcepto = 0;
           |SI Campo = 0;
               |SI #0#6 = " "; |O #0#6 = "F"; #0#6 = "B";
                   enConcepto = #caivaasi#5;
               |FINSI;
               |SI #0#6 = "I"; |O #0#6 = "R";
                   enConcepto = #caivaasi#13;
               |FINSI;
               |SI #0#6 = "P";
                   enConcepto = #caivaasi#83;
               |FINSI;
           |FINSI;
           |SI Campo = 3;
               |SI #0#6 = " "; |O #0#6 = "F"; #0#6 = "B";
                   enConcepto = #caivaasi#31;
               |FINSI;
               |SI #0#6 = "I"; |O #0#6 = "R";
                   enConcepto = #caivaasi#57;
               |FINSI;
               |SI #0#6 = "P";
                   enConcepto = #caivaasi#85;
               |FINSI;
           |FINSI;
           |SI enConcepto = 0;
               |SI #0#6 ! "P";
                  |SI Campo = 0; enConcepto = 700;  |FINSI;
                  |SI Campo = 3; enConcepto = 600;  |FINSI;
               |SINO;
                  enConcepto = 401;
               |FINSI;
           |FINSI;
       |FINSI;
|FPRC;

|PROCESO Tipo0Concep;  |TIPO 0;
   enConcepto = #0Campo;

   |SI FSalida = 10;

       |HAZ DefConcepto;
       |ABRE #dsmom030;
       #dsmom030#0 = enConcepto;
       |CONSULTA_F_CLAVE #1#dsmom030,c_inf,c_sup;
       #0Campo = #dsmom030#0;
       |PINTA #0Campo;
       |CIERRA #dsmom030;

   |FINSI;

   enConcepto = #0Campo;
   |SI enConcepto = 0; |ACABA; |FINSI;

   |ABRE #dsmom030;
   #dsmom030#0 = enConcepto;
   |LEE 041#dsmom030.=;
   |SI FSalida ! 0;
       |MENAV "0000Error. No existe Concepto Contable";
       |ERROR;
   |SINO;
       |SI #0#6 ! "P";
           |SI #dsmom030#4 = "N";
               |CONFI "0000NEl concepto no es de IVA. Continuar ";
               |SI FSalida ! 0;
                   |ERROR;
                   |CIERRA #dsmom030;
                   |ACABA;
               |FINSI;
           |FINSI;
       |SINO;
           |SI #dsmom030#5 = "N";
               |CONFI "0000NEl concepto no es de I.R.P.F. Continuar ";
               |SI FSalida ! 0;
                   |ERROR;
                   |CIERRA #dsmom030;
                   |ACABA;
               |FINSI;
           |FINSI;
       |FINSI;
   |FINSI;
   |CIERRA #dsmom030;
   nNume1 = Campo + 1;
   #0nNume1 = #dsmom030#1; |PINTA #0nNume1;

   nNume1 = Campo + 2;
   |C_M #0nNume1, 1, "N";
   |SI #0#6 = "B";
       |C_M #0nNume1, 1, "S";
       aClau340 = #0nNume1;
       nNumFras = 1;
       aTipoIVA = "R"; |SI Campo = 4; aTipoIVA = "S"; |FINSI;
       |HAZ ClauDefecto;
       #0nNume1  = aClau340;
       |PINTA #0nNume1;
   |FINSI;
|FPRC;

|PROCESO Tipo66w47;  |TIPO 66;

     aAlfa = Campo;
     aAlfa = ("000" + aAlfa ) % -103;
     aAlfa = "|C"+ aAlfa+ "WID";
     aID   = #caw00047#aAlfa#;
     nID   = aID;

     aPopup1  = nID;  || Si fuera -1 en la posicion
     |SI Campo = 5;
         aPopup2  = 27;
         aPopup3  = "  Operación habitual";
         aPopup4  = "A Asiento resumen de facturas";
         aPopup5  = "B Asiento resumen de tiques";
         aPopup6  = "C Factura con varios asientos (varios tipo impositivos)";
         aPopup7  = "D Factura rectificativa";
         aPopup8  = "F Adquisiciones realizadas por las agencias de viajes directamente en interés del viajero ";
         aPopup9  = "G Régimen especial de grupo de entidades en IVA o IGIC";
         aPopup10 = "H Régimen especial de oro de inversión";
         aPopup11 = "I Inversión del Sujeto pasivo (ISP)";
         aPopup12 = "J Tiques";
         aPopup13 = "K Rectificación anotaciones registrales";
         aPopup14 = "L Adquisiciones a comerciantes minoristas del IGIC";
         aPopup15 = "P Adquisiciones intracomunitarias de bienes.";
         aPopup16 = "Q Operaciones a las que se aplique el régimen especial de bienes usados, ...";
         aPopup17 = "R Operación de arrendamiento de local de negocio.";
         aPopup18 = "S Subvenciones, auxilios o ayudas satisfechas o recibidas, tanto por parte de Administraciones públicas o entidades privadas.";
         aPopup19 = "W Operaciones sujetas al Impuesto sobre la Producción, los Servicios y la Importación en las Ciudades de Ceuta y Melilla.";
         aPopup20 = "X Operaciones por las que los empresarios o profesionales que satisfagan compensaciones agrícolas hayan expedido el recibo";
         aPopup21 = "Z Operaciones en Régimen especial de criterio de caja";
         aPopup22 = "1 IVA criterio de caja. Asiento resumen de facturas";
         aPopup23 = "2 IVA criterio de caja. Factura con varios asientos";
         aPopup24 = "3 IVA criterio de caja. Factura rectificativa";
         aPopup25 = "4 IVA criterio de caja. Adqusiciones realizadas por las agencias de viajes en interés del viajero";
         aPopup26 = "5 IVA criterio de caja. Factura simplificada";
         aPopup27 = "6 IVA criterio de caja. Rectificación de errores registrales";
         aPopup28 = "7 IVA criterio de caja. Facturación de las prestaciones de servicios de agencias de viajes";
         aPopup29 = "8 IVA criterio de caja. Operación de arrendamiento de local de negocio";

     |SINO;
         aPopup1  = nID;  || Si fuera -1 en la posicion
         aPopup2  = 30;
         aPopup3  = "  Operación habitual";
         aPopup4  = "A Asiento resumen de facturas";
         aPopup5  = "B Asiento resumen de tiques";
         aPopup6  = "C Factura con varios asientos (varios tipo impositivos)";
         aPopup7  = "D Factura rectificativa";
         aPopup8  = "E IVA devengado pendiente de emitir factura";
         aPopup9  = "G Régimen especial de grupo de entidades en IVA o IGIC";
         aPopup10 = "H Régimen especial de oro de inversión";
         aPopup11 = "I Inversión del Sujeto pasivo (ISP)";
         aPopup12 = "J Tiques";
         aPopup13 = "K Rectificación anotaciones registrales";
         aPopup14 = "M IVA facturado pendiente de devengar (emitida factura)";
         aPopup15 = "N Facturación de las prestaciones de servicios de agencias de viaje que actúan como mediadoras en nombre y por cuenta ajena";
         aPopup16 = "O Factura emitida en sustitución de tiques facturados y declarados.";
         aPopup17 = "Q Operaciones a las que se aplique el régimen especial de bienes usados, ...";
         aPopup18 = "R Operación de arrendamiento de local de negocio.";
         aPopup19 = "S Subvenciones, auxilios o ayudas satisfechas o recibidas, tanto por parte de Administraciones públicas o entidades privadas.";
         aPopup20 = "T Cobros por cuenta de terceros de honorarios profesionales o de derechos derivados ...";
         aPopup21 = "U Operación de seguros.";
         aPopup22 = "V Compras de Agencias viajes: operaciones de prestación de servicios de mediación en nombre y por cuenta ajena relativos ...";
         aPopup23 = "W Operaciones sujetas al Impuesto sobre la Producción, los Servicios y la Importación en las Ciudades de Ceuta y Melilla.";
         aPopup24 = "Z Operaciones en Régimen especial de criterio de caja";
         aPopup25 = "1 IVA criterio de caja. Asiento resumen de facturas";
         aPopup26 = "2 IVA criterio de caja. Factura con varios asientos";
         aPopup27 = "3 IVA criterio de caja. Factura rectificativa";
         aPopup28 = "4 IVA criterio de caja. Adqusiciones realizadas por las agencias de viajes en interés del viajero";
         aPopup29 = "5 IVA criterio de caja. Factura simplificada";
         aPopup30 = "6 IVA criterio de caja. Rectificación de errores registrales";
         aPopup31 = "7 IVA criterio de caja. Facturación de las prestaciones de servicios de agencias de viajes";
         aPopup32 = "8 IVA criterio de caja. Operación de arrendamiento de local de negocio";
     |FINSI;

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 101;  #0Campo = aAlfa;
     |FINSI;

     |PINTA #0Campo;
|FPRC;

|PROCESO Cl340; TIPO 0;

     aTexto = "";
     |SI #0Campo = " "; aTexto = "Operaci¢n habitual"; |FINSI;
     |SI #0Campo = "A"; aTexto = "Asiento resumen de facturas"; |FINSI;
     |SI #0Campo = "B"; aTexto = "Asiento resumen de tiques"; |FINSI;

     |SI Campo = 2;
         |SI #0Campo = "C"; aTexto = "Factura con varios asientos (varios tipo impositivos)"; |FINSI;
         |SI #0Campo = "D"; aTexto = "Factura rectificativa"; |FINSI;
         |SI #0Campo = "E"; aTexto = "IVA devengado pendiente de emitir factura"; |FINSI;
         |SI #0Campo = "G"; aTexto = "R‚gimen especial de grupo de entidades en IVA o IGIC"; |FINSI;
         |SI #0Campo = "H"; aTexto = "R‚gimen especial de oro de inversi¢n"; |FINSI;
         |SI #0Campo = "I"; aTexto = "Inversi¢n del Sujeto pasivo (ISP)";|FINSI;
         |SI #0Campo = "J"; aTexto = "Tiques"; |FINSI;
         |SI #0Campo = "K"; aTexto = "Rectificación anotaciones registrales"; |FINSI;
         |SI #0Campo = "M"; aTexto = "IVA facturado pendiente de devengar (emitida factura)"; |FINSI;
         |SI #0Campo = "N"; aTexto = "Facturaci¢n de las prestaciones de servicios de agencias de viaje que actúan como mediadoras en nombre y por cuenta ajena"; |FINSI;
         |SI #0Campo = "O"; aTexto = "Factura emitida en sustituci¢n de tiques facturados y declarados."; |FINSI;
         |SI #0Campo = "Q"; aTexto = "Operaciones a las que se aplique el r‚gimen especial de bienes usados, ..."; |FINSI;
         |SI #0Campo = "R"; aTexto = "Operaci¢n de arrendamiento de local de negocio."; |FINSI;
         |SI #0Campo = "S"; aTexto = "Subvenciones, auxilios o ayudas satisfechas o recibidas, tanto por parte de Administraciones públicas o entidades privadas."; |FINSI;
         |SI #0Campo = "T"; aTexto = "Cobros por cuenta de terceros de honorarios profesionales o de derechos derivados ..."; |FINSI;
         |SI #0Campo = "U"; aTexto = "Operación de seguros."; |FINSI;
         |SI #0Campo = "V"; aTexto = "Compras de Agencias viajes: operaciones de prestación de servicios de mediación en nombre y por cuenta ajena relativos ..."; |FINSI;
         |SI #0Campo = "W"; aTexto = "Operaciones sujetas al Impuesto sobre la Producción, los Servicios y la Importación en las Ciudades de Ceuta y Melilla."; |FINSI;
         |SI #0Campo = "Z"; aTexto = "Operaciones en Régimen especial de criterio de caja"; |FINSI;
         |SI #0Campo = "1"; aTexto = "IVA criterio de caja. Asiento resumen de facturas"; |FINSI;
         |SI #0Campo = "2"; aTexto = "IVA criterio de caja. Factura con varios asientos"; |FINSI;
         |SI #0Campo = "3"; aTexto = "IVA criterio de caja. Factura rectificativa"; |FINSI;
         |SI #0Campo = "4"; aTexto = "IVA criterio de caja. Adqusiciones realizadas por las agencias de viajes"; |FINSI;
         |SI #0Campo = "5"; aTexto = "IVA criterio de caja. Factura simplificada"; |FINSI;
         |SI #0Campo = "6"; aTexto = "IVA criterio de caja. Rectificaci¢n de errores registrales"; |FINSI;
         |SI #0Campo = "7"; aTexto = "IVA criterio de caja. Facturaci¢n de las prestaciones servicios agencias viajes"; |FINSI;
         |SI #0Campo = "8"; aTexto = "IVA criterio de caja. Operaci¢n de arrendamiento de local de negocio"; |FINSI;

     |SINO;

         |SI #0Campo = "C"; aTexto = "Factura con varios asientos (varios tipo impositivos)"; |FINSI;
         |SI #0Campo = "D"; aTexto = "Factura rectificativa";|FINSI;
         |SI #0Campo = "F"; aTexto = "Adquisiciones realizadas por las agencias de viajes directamente en inter‚s del viajero";|FINSI;
         |SI #0Campo = "G"; aTexto = "R‚gimen especial de grupo de entidades en IVA o IGIC"; |FINSI;
         |SI #0Campo = "H"; aTexto = "R‚gimen especial de oro de inversi¢n"; |FINSI;
         |SI #0Campo = "I"; aTexto = "Inversi¢n del Sujeto pasivo (ISP)"; |FINSI;
         |SI #0Campo = "J"; aTexto = "Tiques"; |FINSI;
         |SI #0Campo = "K"; aTexto = "Rectificación anotaciones registrales"; |FINSI;
         |SI #0Campo = "L"; aTexto = "Adquisiciones a comerciantes minoristas del IGIC"; |FINSI;
         |SI #0Campo = "P"; aTexto = "Adquisiciones intracomunitarias de bienes."; |FINSI;
         |SI #0Campo = "Q"; aTexto = "Operaciones a las que se aplique el r‚gimen especial de bienes usados, ..."; |FINSI;
         |SI #0Campo = "R"; aTexto = "Operaci¢n de arrendamiento de local de negocio."; |FINSI;
         |SI #0Campo = "S"; aTexto = "Subvenciones, auxilios o ayudas satisfechas o recibidas, tanto por parte de Administraciones públicas o entidades privadas."; |FINSI;
         |SI #0Campo = "W"; aTexto = "Operaciones sujetas al Impuesto sobre la Producción, los Servicios y la Importación en las Ciudades de Ceuta y Melilla."; |FINSI;
         |SI #0Campo = "X"; aTexto = "Operaciones por las que los empresarios o profesionales que satisfagan compensaciones agrícolas hayan expedido el recibo"; |FINSI;
         |SI #0Campo = "Z"; aTexto = "Operaciones en Régimen especial de criterio de caja"; |FINSI;
         |SI #0Campo = "1"; aTexto = "IVA criterio de caja. Asiento resumen de facturas"; |FINSI;
         |SI #0Campo = "2"; aTexto = "IVA criterio de caja. Factura con varios asientos"; |FINSI;
         |SI #0Campo = "3"; aTexto = "IVA criterio de caja. Factura rectificativa";|FINSI;
         |SI #0Campo = "4"; aTexto = "IVA criterio de caja. Adquisiciones realizadas por las agencias de viajes"; |FINSI;
         |SI #0Campo = "5"; aTexto = "IVA criterio de caja. Factura simplificada"; |FINSI;
         |SI #0Campo = "6"; aTexto = "IVA criterio de caja. Rectificaci¢n de errores registrales"; |FINSI;
         |SI #0Campo = "7"; aTexto = "IVA criterio de caja. Facturaci¢n de las prestaciones servicios agencias viajes"; |FINSI;
         |SI #0Campo = "8"; aTexto = "IVA criterio de caja. Operaci¢n de arrendamiento de local de negocio"; |FINSI;
     |FINSI;

     |SI #0Campo = "C"; aTexto = ""; |FINSI; || no puede elegir C, es automatico
     |SI #0Campo = "*"; aTexto = "No pasa al 340"; |FINSI;

     |SI aTexto = "";
         |MENAV "0000 Clave de operaci¢n incorrecta";
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;
