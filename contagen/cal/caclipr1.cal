|FICHEROS;
     caclipro,MANTE;
     canempre;

     cacuebal;
     cacuenta;

     &provinc@;
     &poblaci@;
     &regisnif@;
     &clientes@;
     &sgpaises@;

     Referenc@;
|FIN;

|VARIABLES;
     entrad1   = 0;
     tipotipo  = "";
     mens12    = "     Clave ya Existente !!!";
     alfa1     = "";
     aAlfa      = "";
     nCalc      = 0;
     nHayIntegrada = 0;
     nAltaSbctr = 0;

     &entrada  = 0;
     &raf_cue  = "";
     &raf_dig  = 0;
     &raf_des  = "";
     &raf_sw   = 0;
     &raf_nif  = "";
     &tipoalta = "";
|FIN;

|INCLUYE dscont_i;


|PROCESO altcuen;
     raf_sw = 0;
     #caclipro#23 = tipoalta;
     #caclipro#10 = raf_cue;
     #caclipro#11 = raf_dig;
     |LEE 040#caclipro.=;
     |SI FSalida = 0;  |MENAV mens12;  |ACABA;  |FINSI;
     |DDEFECTO #caclipro;
     #caclipro#23 = tipoalta;
     #caclipro#10 = raf_cue;
     #caclipro#11 = raf_dig;
     #caclipro#1  = raf_des; ||Descripcion;
     #caclipro#9  = raf_nif; ||NIF
     |PINPA #0#caclipro;
     |PINDA #0#caclipro;
     |ENDATOS #1#caclipro;
     |SI FSalida = 0;
        raf_nif = #caclipro#9;
        raf_des = #caclipro#1;
        raf_sw = 1;
        |GRABA 040#caclipro.n;
     |FINSI;
|FPRC;

|PROCESO modcuen;
     |PINPA #0#caclipro;
     |PINDA #0#caclipro;
     |ENDATOS #2#caclipro;

     |SI FSalida = 0;
        |GRABA 020#caclipro.a;
        raf_nif = #caclipro#9;
        raf_des = #caclipro#1;
        raf_sw = 1;
     |SINO;
        |SI alfa1 = "D";
            |BORRA 020#caclipro.a;
            raf_sw = 0;
        |FINSI;
     |FINSI;
     |LIBERA #caclipro;
|FPRC;

|PROGRAMA;
     entrad1 = entrada;
     entrada = 1;
     |SI dirfich0 = "";
         |HAZ inicio;
     |SINO;
         |PATH_DAT #caclipro #dirfich0#;
         |PATH_DAT #cacuenta #dirfich0#;
         |PATH_DAT #cacuebal #dirfich0#;
     |FINSI;

     raf_sw = 0;
     |ABRE #caclipro;
     |DDEFECTO #caclipro;
     |PINPA #0#caclipro;
     |SI tipoalta = "X";
        |MENSA "2425 Introduzca Cliente/Proveedor: ";
        E_inf = "CPcp";
        E_sup = 1;
        tipotipo = 2456 ? 0;
        tipoalta = tipotipo > " ";
     |FINSI;
     #caclipro#23 = tipoalta;
     alfa1 = tipoalta - #caclipro#23;
     #caclipro#10 = raf_cue;
     #caclipro#11 = raf_dig;
     |LEE 101#caclipro.=;
     |SI FSalida = 0;
        |HAZ modcuen;
     |SINO;
        |HAZ altcuen;
     |FINSI;
     |CIERRA #caclipro;
     entrada = entrad1;
|FPRO;
