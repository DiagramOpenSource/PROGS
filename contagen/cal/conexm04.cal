
|FICHEROS;
   conselec #0;
   conexcel #1;
|FIN;

|VARIABLES;
  i = 0;
  sub = "";
  auto = 0;
|FIN;

|PROCESO desdehasta;|TIPO 0;
    |SI #conselec#2 = "S";|O #conselec#2 = "s";
        |C_M #conselec#3,1,"S";
        |C_M #conselec#4,1,"S";
        |PARA i = 5;|SI i [ 40;|HACIENDO i = i + 1;
           |C_M #conselec#i#,1,"N";
        |SIGUE;
     |SINO;
         |C_M #conselec#3,1,"N";
         |C_M #conselec#4,1,"N";
         |PARA i = 5;|SI i [ 40;|HACIENDO i = i + 1;
            |C_M #conselec#i#,1,"S";
         |SIGUE;
    |FINSI;
|FPRC;

|PROCESO cons;|TIPO 66;
  |CONSULTA_CLAVE #2#conexcel;
  |SI FSalida ] 0;
      #conselec#Campo# = #conexcel#0;
      |PINTA #conselec#Campo#;
    |SINO;
       |ERROR;
  |FINSI;
|FPRC;

|PROGRAMA;
  |SI PARAMETRO = "MANTE";
      |MANTE #conselec;
    |SINO;
       |ABRET #conselec;
       |CLS;
       |CABEZA "Parrila de Seleccion";
       |PINPA #0#conselec;
       |SI PARAMETRO ] "0000";|Y PARAMETRO [ "9999";
           #conselec#0 = PARAMETRO;
           |LEE 010#conselec.=;
           |SI FSalida = 0;
               auto = 1;
           |FINSI;
       |FINSI;
       |SI auto ! 1; || en caso contrario FSalida valdra 0
           |LEE 010#conselec.p;
           |SI FSalida = 0;
               |CONSULTA_CLAVE #2#conselec;
             |SINO;
                FSalida = 0;
           |FINSI;
       |FINSI;
       |SI FSalida ] 0;
           |PINDA #0#conselec;
           |SI auto = 1;
               FSalida = 0;
             |SINO;
                |ENDATOS #1#conselec;
           |FINSI;
           |SI FSalida ] 0;
               |ABRE   #conexcel;
               |SI #conselec#2 = "S";|O #conselec#2 = "s";
                   #conexcel#0 = #conselec#3;
                   |LEE 010#conexcel.];
                   |PARA;|SI FSalida = 0;|Y #conexcel#0 [ #conselec#4;|HACIENDO;
                       sub = "conexcel.tab;"+(("0000"+#conexcel#0)%"-104");
                       |SUB_EJECUTA sub;
                       |LEE 010#conexcel.s;
                   |SIGUE;
                 |SINO;
                    |PARA i = 5;|SI i [ 40;|HACIENDO i = i + 1;
                        |SI #conselec#i# > 0;
                            #conexcel#0 = #conselec#i#;
                            |LEE 010#conexcel.=;
                            |SI FSalida = 0;
                                sub = "conexcel.tab;"+(("0000"+#conexcel#0)%"-104");
                                |SUB_EJECUTA sub;
                            |FINSI;
                        |FINSI;
                    |SIGUE;
               |FINSI;
               |CIERRA #conexcel;
       |FINSI;
    |FINSI;
    |CIERRAT #conselec;
  |FINSI;
|FPRO;
