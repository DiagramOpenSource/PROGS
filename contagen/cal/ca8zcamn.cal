|FICHEROS;
    ca8zcamn #0;
    cacuenta #1;    || plan contable                 ---> puntos_i
    cacuebal #5;    || cuentas de balance

    casieali #21;   || asientos predefinidos lins.
    camaasic #25;   || apuntes cabs.
    camaasil #26;   || apuntes lins.
    camaniva #28;   || Mantenimiento Iva/IRPF
    caivalin #29;   || Lineas mantenimiento iva/irpf
    cainliva #31;   || Introduccion facturas (LINEAS)
    caconcic #38;   || diferencias cabs.
    cacuepre #39;   || cuentas presupuestarias
    camoauxc #40;   || cuentas inventario
                    || en agicont si Amortizaciones
    :/modelos/def/dsmom041 #41;   || Elementos de Amortizacion
    :/modelos/def/dsmom040 #42;   || grupos amortizaciones

    caexistc #43;   || descarga existencias cabs.
    caexistl #44;   || descarga existencias lins.
    caconcil #45;   || diferencias lineas.
    camaylin #46;   || lineas mayor
    caclipro #50;   || Clientes Proveedores GENERAL
    capasven #51;   || asiento ventas automaticas.
    camoauxl #52;   || cuentas inventario lineas
    caivaasi #64;   || Ctrl Entrada IVA asientos.
    calicont #67;   || Contrapartidas Apuntes

    camautol #69;   || Asientos Automaticos Lineas
    cagruiva #70;   ||grupo de iva
    camauto1 #71;   || Asientos Automaticos Lineas esp

    caw00017 #76;   || Asientos de Facturas
    cadeflab #77;
    cadeflac #78;
    cadeflal #79;
    caplalab #80;   || Entrada Laboral
    caconvec #81;   || ventas al contado
    cadeflax #82;
    cadeflay #83;
    cadeflaz #84;

    ca8m0003 #403;
    ca8m0004 #404;
    ca8m0005 #405;
    ca8m0002 #422;
    ca8cumay #410;

    espejo1@ #900;
|FIN;

|VARIABLES;
    fDFecha = @;
    fHFecha = @;
    aAlfa1  = "";
    mens    = "";
    traba   = "";
    x       = 0;

    para3 = 0;
    para4 = 0;
    &aPathPlan = "";
    &num_por    = 0;
    &num_per    = 0;

    nGraba       = 0;
    nCambia      = 0;
    aCtaAnterior = "";
    aCtaNueva    = "";

    aMas      = "";
    aDef      = "";
    nError    = 0;
    aFichero  = "";
    traba1    = "";
    temporal1 = "";
    temporal2 = "";

    nPara1    = 0;
    aQueQuiero = "";
    aNumCampos = "";
    nNumCampos = 0;
    nOp        = 0;
    &nRecalculo = 0;
    nEjer       = 0;
|FIN;

|INCLUYE dscont_i;
|INCLUYE defec1_i;

|| **************************************************************
|PROCESO CargaDefs;
   nError = 0;
   |DBASE aMas;
   aDef = aMas + "def/" + traba1;
   |CARGA_DEF aDef, espejo1@;
   |SI FSalida !  0;
       aDef  = "";
       nError = 1;
   |FINSI;
|FPRC;

|PROCESO DesCargaDefs;
   |SI aDef ! ""; |DESCARGA_DEF #espejo1@; |FINSI;
|FPRC;

|PROCESO copiando;
  temporal1 = fich_alta + traba1   + ".ixx";
  temporal2 = fich_alta + aFichero + ".ixx";
  |COPIA_FICHERO temporal1,temporal2;
  |SI FSalida ! 0;  |ACABA;  |FINSI;
  temporal1 = fich_alta + traba1   + ".dat";
  temporal2 = fich_alta + aFichero + ".dat";
  |COPIA_FICHERO temporal1,temporal2;
  |SI FSalida ! 0;
      temporal2 = fich_alta + aFichero + ".ixx";
      |FBORRA temporal2;
      |ACABA;
  |FINSI;
  temporal1 = fich_alta + traba1   + ".ddx";
  temporal2 = fich_alta + aFichero + ".ddx";
  |COPIA_FICHERO temporal1,temporal2;
|FPRC;

|| **************************************************************
|PROCESO ca8m0004;
   mens = " Cambio de Asiento Apertura" + #ca8m0004#0;   #0#1 = mens;   |PINTA #0#1;
   eaCuenta = #404#1;
   |HAZ LeoTabla_Pr;
   |SI nCambia = 1;
       #404#8 = aCtaNueva;
       #404#14 = "*";
       |GRABA 020#404a;
   |FINSI;
   |LIBERA #404;
|FPRC;

|DEFBUCLE ca8m0004;
   #404#1;
   ;
   00, fDFecha, 000001, 0001;
   00, fHFecha, 999999, 9999;
   be;
   NULL, ca8m0004;
|FIN;

|PROCESO ca8m0003;
   mens = " Cambio de Tabla Equivalencias " + #ca8m0003#0;   #0#1 = mens;   |PINTA #0#1;
   eaCuenta = #403#0;
   |HAZ LeoTabla_Pr;
   |SI nCambia = 1;
       #403#4 = #403#2;
       #403#5 = #403#3;
       #403#2 = aCtaNueva;
       #403#6 = "*";
       |GRABA 020#403a;
   |FINSI;
   |LIBERA #403;
|FPRC;

|DEFBUCLE ca8m0003;
   #403#1;
   ;
   "            ";
   "zzzzzzzzzzzz";
   be;
   NULL, ca8m0003;
|FIN;

|| **************************************************************
|PROCESO Operacion_cta;
 |ABRE #1;
 |DDEFECTO #1;
 #1#0 = #405#4;
 |LEE 101#1=;
 |SI FSalida ! 0;
     #1#0 = #405#4;
     |GRABA 020#1b;
 |FINSI;
 |PARA nPara1 = 0; |SI nPara1 [ nNumCampos; |HACIENDO nPara1 = nPara1 + 1;
       #1nPara1 = #900nPara1;
 |SIGUE;

 #1#0   = #405#4;
 aAlfa1 = #1#0; |QBF aAlfa1;
 #1#54  = (aAlfa1 + "zzzzzzzzzzzzz") % 112;
 |GRABA 020#1a;
 |LIBERA #1;
 |CIERRA #1;
|FPRC;

|PROCESO ca8m0005_Cta;

  |SI #405#2 = #405#4; |ACABA; |FINSI;  ||No ya cambio

  |SI nOp = 0; |Y #405#6 ! "S"; |ACABA; |FINSI;

  |SI nOp = 0;
      |ABRE #1;
      #1#0 = #405#2;
      |LEE 101#1=;
      |SI FSalida = 0;
          |BORRA 020#1a;
      |FINSI;
      |LIBERA #1;
      |CIERRA #1;
  |FINSI;

  |SI nOp = 1;
      |ABRE #900;
      #900#0 = #405#2;
      |LEE 101#900=;
      |SI FSalida = 0;
          |HAZ Operacion_cta;
      |FINSI;
      |LIBERA #900;
      |CIERRA #900;
  |FINSI;
|FPRC;

|DEFBUCLE ca8m0005_Cta;
 #405#1;
 7;
 0001, "            ", "S";
 9999, "zzzzzzzzzzzz", "S";
 ;
 NULL, ca8m0005_Cta;
|FIN;

|PROCESO cacuenta;
 traba1 = "cacuenta";
 |HAZ CargaDefs;
 |SI nError = 1; |ACABA; |FINSI;

 aFichero = ("d" + Usuario) % 108;
 |NOME_DAT #900 aFichero;
 |PATH_DAT #900 fich_alta;

 |HAZ copiando;

 aQueQuiero = "|NC";
 aNumCampos = #1#aQueQuiero#;
 nNumCampos = aNumCampos;
 nNumCampos = nNumCampos - 1;

 nOp = 0; |BUCLE ca8m0005_Cta;
 nOp = 1; |BUCLE ca8m0005_Cta;

 |DELINDEX #900;
 |HAZ DesCargaDefs;
|FPRC;

|| --------- Clientes y Proveedores
|PROCESO caclipro1;
  mens = "Contrapartida Cli./Prov.> " + #50#10;   #0#1 = mens;   |PINTA #0#1;
  aCtaAnterior = #50#21;
  |HAZ LeoTabla;
  |SI nCambia = 1;
      #50#21 = aCtaNueva;
      |GRABA 020#50a;
  |FINSI;
  |LIBERA #50;
|FPRC;

|DEFBUCLE caclipro;
 #50#1;
 ;
 " ","            ";
 "z","zzzzzzzzzzzz";
 be;
 NULL, caclipro1;
|FIN;
|| ------------------------

|PROCESO Operacion;
 |ABRE #50;
 |DDEFECTO #50;
 #50#23 = #900#23;
 #50#10 = #405#4;
 |LEE 101#50=;
 |SI FSalida ! 0;
     #50#23 = #900#23;
     #50#10 = #405#4;
     |GRABA 020#50b;
 |FINSI;
 |PARA nPara1 = 0; |SI nPara1 [ nNumCampos; |HACIENDO nPara1 = nPara1 + 1;
       #50nPara1 = #900nPara1;
 |SIGUE;
 #50#10 = #405#4;
 |GRABA 020#50a;
 |LIBERA #50;
 |CIERRA #50;
|FPRC;

|PROCESO ca8m0005_CP;

  |SI #405#2 = #405#4; |ACABA; |FINSI;  ||No ya cambio

  |SI nOp = 0; |Y #405#6 ! "S"; |ACABA; |FINSI;

  |SI nOp = 0;
      |ABRE #50;
      #50#23 = "C";
      #50#10 = #405#2;
      |LEE 101#50=;
      |SI FSalida = 0;
          |BORRA 020#50a;
      |FINSI;
      |LIBERA #50;

      #50#23 = "P";
      #50#10 = #405#2;
      |LEE 101#50=;
      |SI FSalida = 0;
          |BORRA 020#50a;
      |FINSI;
      |LIBERA #50;
      |CIERRA #50;
  |FINSI;

  |SI nOp = 1;
      |ABRE #900;
      #900#23 = "C";
      #900#10 = #405#2;
      |LEE 101#900=;
      |SI FSalida = 0;
          |HAZ Operacion;
      |FINSI;
      |LIBERA #900;

      #900#23 = "P";
      #900#10 = #405#2;
      |LEE 101#900=;
      |SI FSalida = 0;
          |HAZ Operacion;
      |FINSI;
      |LIBERA #900;
      |CIERRA #900;
  |FINSI;
|FPRC;

|DEFBUCLE ca8m0005_CP;
 #405#1;
 7;
 0001, "            ", "S";
 9999, "zzzzzzzzzzzz", "S";
 ;
 NULL, ca8m0005_CP;
|FIN;

|PROCESO caclipro;
 traba1 = "caclipro";
 |HAZ CargaDefs;
 |SI nError = 1; |ACABA; |FINSI;

 aFichero = ("e" + Usuario) % 108;
 |NOME_DAT #900 aFichero;
 |PATH_DAT #900 fich_alta;

 |HAZ copiando;

 aQueQuiero = "|NC";
 aNumCampos = #50#aQueQuiero#;
 nNumCampos = aNumCampos;
 nNumCampos = nNumCampos - 1;

 nOp = 0; |BUCLE ca8m0005_CP;
 nOp = 1; |BUCLE ca8m0005_CP;

 |DELINDEX #900;
 |HAZ DesCargaDefs;


 |BUCLE caclipro;   ||las contrapartidas
|FPRC;

|PROCESO dsmom0401;
   mens = " Grupos Amortizacion> " + #42#2;   #0#1 = mens;   |PINTA #0#1;

   nGraba = 0;
   eaCuenta = #42#3;
   |HAZ LeoTabla_Pr;
   |SI nCambia = 1;
       #42#10 = aCtaNueva;
       nGraba = 1;
   |FINSI;

   eaCuenta = #42#5;
   |HAZ LeoTabla_Pr;
   |SI nCambia = 1;
       #42#12 = aCtaNueva;
       nGraba = 1;
   |FINSI;

   |SI nGraba = 1;
       |GRABA 020#42a;
   |FINSI;
   |LIBERA #42;
|FPRC;

|DEFBUCLE dsmom040;
   #42#1;
   ;
   enEmpresa,0;
   enEmpresa,9999;
   be;
   NULL, dsmom0401;
|FIN;

____________________________________/ dsmom041
|PROCESO dsmom0411;
   mens = " Elementos Amortizacion> " + #41#2;  #0#1 = mens; |PINTA #0#1;

   aAlfa1 = #41#27; aAlfa1 = aAlfa1 % -104;
   nEjer  = aAlfa1;
   |SI nEjer = 2008;
       aCtaAnterior = #41#5;
       |HAZ LeoTabla;
       |SI nCambia = 1;
           #41#5  = aCtaNueva;
           |GRABA 020#41a;
       |FINSI;
   |FINSI;
   |LIBERA #41;
|FPRC;

|DEFBUCLE dsmom041;
   #41#1;
   ;
   enEmpresa,"        ",00;
   enEmpresa,"zzzzzzzz",99;
   be;
   NULL, dsmom0411;
|FIN;
____________________________________/ caconvec
|| ------------------------- capasven1
|PROCESO capasven1;
   mens = " Control Pase Ventas Contado > " + #capasven#0; #0#1 = mens; |PINTA #0#1;

   nGraba = 0;
   aCtaAnterior = #51#9;  |HAZ LeoTabla; |SI nCambia = 1; #51#9  = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #51#10; |HAZ LeoTabla; |SI nCambia = 1; #51#10 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #51#11; |HAZ LeoTabla; |SI nCambia = 1; #51#11 = aCtaNueva; nGraba = 1; |FINSI;
   |SI nGraba = 1;
       |GRABA 020#51a;
   |FINSI;
   |LIBERA #51;
|FPRC;

|DEFBUCLE capasven;
   #51#1;
   ;
   "  ";
   "zz";
   be;
   NULL, capasven1;
|FIN;

____________________________________/ camaylin
|PROCESO camaylin;
   mens = " Diario Mayor-> " + #camaylin#3; #0#1 = mens; |PINTA #0#1;

   nGraba = 0;
   aCtaAnterior = #46#4;   |HAZ LeoTabla; |SI nCambia = 1; #46#4  = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #46#10;  |HAZ LeoTabla; |SI nCambia = 1; #46#10 = aCtaNueva; nGraba = 1; |FINSI;
   |SI nGraba = 1;
      |GRABA 020#46a;
   |FINSI;
   |LIBERA #46;
|FPRC;

|DEFBUCLE camaylin;
   #46#1;
   ;
   00, fDFecha, 000001, 0001;
   99, fHFecha, 999999, 9999;
   be;
   NULL, camaylin;
|FIN;

____________________________________/ caw00017;
|PROCESO caw00017;
   mens = " Otros apuntes en IVA -> " + #caw00017#1; #0#1 = mens; |PINTA #0#1;
   nGraba = 0;
   aCtaAnterior = #76#4;   |HAZ LeoTabla; |SI nCambia = 1; #76#4  = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #76#10;  |HAZ LeoTabla; |SI nCambia = 1; #76#10 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #76#16;  |HAZ LeoTabla; |SI nCambia = 1; #76#16 = aCtaNueva; nGraba = 1; |FINSI;
   |SI nGraba = 1;
      |GRABA 020#76a;
   |FINSI;
   |LIBERA #76;
|FPRC;

|DEFBUCLE caw00017;
   #76#1;
   ;
   00, fDFecha, 000001, 0001;
   99, fHFecha, 999999, 9999;
   be;
   NULL, caw00017;
|FIN;

|| ------------ caconvec
|PROCESO caconvec1;
   mens = " Ventas Contado -> " + #caconvec#0; #0#1 = mens; |PINTA #0#1;
   aCtaAnterior = #81#2;
   |HAZ LeoTabla;
   |SI nCambia = 1;
       #81#2 = aCtaNueva;
       |GRABA 020#81a;
   |FINSI;
   |LIBERA #81;
|FPRC;

|DEFBUCLE caconvec;
   #81#1;
   ;
   "  ";
   "zz";
   be;
   NULL, caconvec1;
|FIN;

|| -------------- Entrada Laboral
|PROCESO caplalab1;
   mens = " Entrada Laboral.> " + #80#0 + "-" + #80#1; #0#1 = mens; |PINTA #0#1;

   nGraba = 0;
   aCtaAnterior = #80#9;  |HAZ LeoTabla; |SI nCambia = 1; #80#9  = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #80#13; |HAZ LeoTabla; |SI nCambia = 1; #80#13 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #80#17; |HAZ LeoTabla; |SI nCambia = 1; #80#17 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #80#21; |HAZ LeoTabla; |SI nCambia = 1; #80#21 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #80#25; |HAZ LeoTabla; |SI nCambia = 1; #80#25 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #80#37; |HAZ LeoTabla; |SI nCambia = 1; #80#37 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #80#44; |HAZ LeoTabla; |SI nCambia = 1; #80#44 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #80#48; |HAZ LeoTabla; |SI nCambia = 1; #80#48 = aCtaNueva; nGraba = 1; |FINSI;

   |SI nGraba = 1;
       |GRABA 020#80a;
   |FINSI;
   |LIBERA #80;
|FPRC;

|DEFBUCLE caplalab;
   #80#1;
   2;
   0001, fDFecha;
   9999, fHFecha;
   be;
   NULL, caplalab1;
|FIN;

____________________________________/ cagruiva
|PROCESO cagruiva1;
   mens = " Grupos de IVA > " + #cagruiva#0; #0#1 = mens; |PINTA #0#1;

   nGraba = 0;

   |PARA para4 = 2; |SI para4 [ 16; |HACIENDO para4 = para4 + 1;
         para3 = para4 + 15;
         aCtaAnterior = #70para4;
         |HAZ LeoTabla;
         |SI nCambia = 1;
             #70para4 = aCtaNueva;
             nGraba = 1;
         |FINSI;
   |SIGUE;
   |SI nGraba = 1;
       |GRABA 020#70a;
   |FINSI;
   |LIBERA #70;
|FPRC;

|DEFBUCLE cagruiva;
   #70#1;
   ;
   00;
   99;
   be;
   NULL, cagruiva1;
|FIN;

____________________________________/ camautol
|PROCESO camautol1;
    mens = " Astos Automaticos > " + #camautol#0 + "-" + #camautol#1;   #0#1 = mens;   |PINTA #0#1;

    aCtaAnterior = #69#2;
    |HAZ LeoTabla;
    |SI nCambia = 1;
        #69#2 = aCtaNueva;
        |GRABA 020#69a;
    |FINSI;
    |LIBERA #69;
|FPRC;

|DEFBUCLE camautol;
   #69#1;
   ;
   00001,    0;
   99999, 9999;
   be;
   NULL, camautol1;
|FIN;

____________________________________/ camauto1
|PROCESO camauto11;
    mens = " Astos Automaticos > " + #camauto1#0 + "-" + #camauto1#1;   #0#1 = mens;   |PINTA #0#1;
    aCtaAnterior = #71#2;
    |HAZ LeoTabla;
    |SI nCambia = 1;
        #71#2 = aCtaNueva;
        |GRABA 020#71a;
    |FINSI;
    |LIBERA #71;
|FPRC;

|DEFBUCLE camauto1;
   #71#1;
   ;
   00001,    0;
   99999, 9999;
   be;
   NULL, camauto11;
|FIN;


|| *******************************************************
|| ------------------ caexistl
|PROCESO caexistl1;
    mens = " Descarga Existencias> " + #44#0;   #0#1 = mens;   |PINTA #0#1;

    nGraba = 0;
    aCtaAnterior = #44#2;  |HAZ LeoTabla; |SI nCambia = 1; #44#2 = aCtaNueva; nGraba = 1; |FINSI;
    aCtaAnterior = #44#5;  |HAZ LeoTabla; |SI nCambia = 1; #44#5 = aCtaNueva; nGraba = 1; |FINSI;
    aCtaAnterior = #44#8;  |HAZ LeoTabla; |SI nCambia = 1; #44#8 = aCtaNueva; nGraba = 1; |FINSI;

    |SI nGraba = 1;
        |GRABA 020#44a;
    |FINSI;
    |LIBERA #44;
|FPRC;

|DEFBUCLE caexistl;
 #44#1;
 ;
  0,  0;
 99, 99;
 be;
 NULL, caexistl1;
|FIN;

|| ----------------------------- caexistc
|PROCESO caexistc1;
    mens = " Descarga Existencias> " + #43#0;   #0#1 = mens;   |PINTA #0#1;

    aCtaAnterior = #43#2;
    |HAZ LeoTabla;
    |SI nCambia = 1;
        #43#2 = aCtaNueva;
        |GRABA 020#43a;
    |FINSI;
    |LIBERA #43;
|FPRC;

|DEFBUCLE caexistc;
 #43#1;
 ;
  0;
 99;
 be;
 NULL, caexistc1;
|FIN;

____________________________________/ caivaasi
|PROCESO caivaasi;

   |ABRE #64;
   #caivaasi#0 = 1;
   |LEE 000#64=;
   |SI FSalida ! 0;
      |CIERRA #64;
      |ACABA;
   |FINSI;

   mens = " Control Entrada Asientos IVA > ";  #0#1 = mens;   |PINTA #0#1;
   nGraba = 0;

   aCtaAnterior = #64#39;  |HAZ LeoTabla; |SI nCambia = 1; #64#39  = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #64#49;  |HAZ LeoTabla; |SI nCambia = 1; #64#49  = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #64#53;  |HAZ LeoTabla; |SI nCambia = 1; #64#53  = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #64#81;  |HAZ LeoTabla; |SI nCambia = 1; #64#81  = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #64#82;  |HAZ LeoTabla; |SI nCambia = 1; #64#82  = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #64#138; |HAZ LeoTabla; |SI nCambia = 1; #64#138 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #64#142; |HAZ LeoTabla; |SI nCambia = 1; #64#142 = aCtaNueva; nGraba = 1; |FINSI;

   |SI nGraba = 1;
       |GRABA 020#64a;
   |FINSI;
   |LIBERA #64;
   |CIERRA #64;
|FPRC;

____________________________________/ cadeflal;
|PROCESO cadeflal1;
   mens = " Desglose Laboral > " + #cadeflal#0;   #0#1 = mens;   |PINTA #0#1;

   nGraba = 0;
   aCtaAnterior = #79#2;
   |HAZ LeoTabla;
   |SI nCambia = 1;
      #79#2 = aCtaNueva;
      |GRABA 020#79a;
   |FINSI;
   |LIBERA #79;
|FPRC;

|DEFBUCLE cadeflal;
   #79#1;
   ;
   001;
   999;
   be;
   NULL, cadeflal1;
|FIN;


|PROCESO cadeflaz1;
   nGraba = 0;
   mens = " Desglose Laboral SS Areas / Secciones > " + #cadeflaz#0;   #0#1 = mens;   |PINTA #0#1;

   aCtaAnterior = #84#3;  |HAZ LeoTabla; |SI nCambia = 1; #84#3  = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #84#6;  |HAZ LeoTabla; |SI nCambia = 1; #84#6  = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #84#8;  |HAZ LeoTabla; |SI nCambia = 1; #84#8  = aCtaNueva; nGraba = 1; |FINSI;

   |SI nGraba = 1; |GRABA 020#84a; |FINSI;
   |LIBERA #84;
|FPRC;

|DEFBUCLE cadeflaz;
   #84#1;
   ;
   " ", " ";
   "z", "z";
   be;
   NULL, cadeflaz1;
|FIN;

|| _____________________/ cadeflax;
|PROCESO cadeflax1;
   mens = " Desglose Laboral Area/Secciones > " + #cadeflax#0;   #0#1 = mens;   |PINTA #0#1;

   aCtaAnterior = #82#3;
   |HAZ LeoTabla;
   |SI nCambia = 1;
       #82#3  = aCtaNueva;
       |GRABA 020#82a;
   |FINSI;
   |LIBERA #82;
|FPRC;

|DEFBUCLE cadeflax;
   #82#1;
   ;
   " ", " ";
   "z", "z";
   be;
   NULL, cadeflax1;
|FIN;

|| ---------------------
|PROCESO cadeflay1;
   mens = " Desglose Laboral SS Centros > " + #cadeflay#0;   #0#1 = mens;   |PINTA #0#1;

   nGraba = 0;
   aCtaAnterior = #83#2;  |HAZ LeoTabla; |SI nCambia = 1; #83#2  = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #83#5;  |HAZ LeoTabla; |SI nCambia = 1; #83#5  = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #83#7;  |HAZ LeoTabla; |SI nCambia = 1; #83#7  = aCtaNueva; nGraba = 1; |FINSI;

   |SI nGraba = 1; |GRABA 020#83a; |FINSI;
   |LIBERA #83;
|FPRC;

|DEFBUCLE cadeflay;
   #83#1;
   ;
   01;
   99;
   be;
   NULL, cadeflay1;
|FIN;

____________________________________/ cadeflac;
|PROCESO cadeflac1;
   nGraba = 0;
   mens = " Desglose Laboral Centros > " + #cadeflac#0;   #0#1 = mens;   |PINTA #0#1;

   aCtaAnterior = #78#2;
   |HAZ LeoTabla;
   |SI nCambia = 1;
       #78#2  = aCtaNueva;
       |GRABA 020#78a;
   |FINSI;
   |LIBERA #78;
|FPRC;

|DEFBUCLE cadeflac;
   #78#1;
   ;
   00;
   99;
   be;
   NULL, cadeflac1;
|FIN;

|| ---------------------- cadeflab
|PROCESO cadeflab;

   |ABRE #77;
   |LEE 000#77p;
   |SI FSalida ! 0;
      |CIERRA #77;
      |ACABA;
   |FINSI;
   mens = " Control Defectos Laboral >";   #0#1 = mens;   |PINTA #0#1;

   nGraba = 0;
   aCtaAnterior = #77#1;  |HAZ LeoTabla; |SI nCambia = 1; #77#1  = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #77#4;  |HAZ LeoTabla; |SI nCambia = 1; #77#4  = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #77#7;  |HAZ LeoTabla; |SI nCambia = 1; #77#7  = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #77#10; |HAZ LeoTabla; |SI nCambia = 1; #77#10 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #77#13; |HAZ LeoTabla; |SI nCambia = 1; #77#13 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #77#16; |HAZ LeoTabla; |SI nCambia = 1; #77#16 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #77#49; |HAZ LeoTabla; |SI nCambia = 1; #77#49 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #77#63; |HAZ LeoTabla; |SI nCambia = 1; #77#63 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #77#69; |HAZ LeoTabla; |SI nCambia = 1; #77#69 = aCtaNueva; nGraba = 1; |FINSI;
   |SI nGraba = 1;
       |GRABA 020#77a;
   |FINSI;
   |LIBERA #77;
   |CIERRA #77;
|FPRC;

|| -------------- Introduccion Facturas
|PROCESO cainliva1;
   mens = " Introduccion Facturas> " + #31#0 + "-" + #31#1; #0#1 = mens; |PINTA #0#1;

   nGraba = 0;
   aCtaAnterior = #31#5;  |HAZ LeoTabla; |SI nCambia = 1; #31#5 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #31#17; |HAZ LeoTabla; |SI nCambia = 1; #31#17 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #31#20; |HAZ LeoTabla; |SI nCambia = 1; #31#20 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #31#22; |HAZ LeoTabla; |SI nCambia = 1; #31#22 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #31#24; |HAZ LeoTabla; |SI nCambia = 1; #31#24 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #31#36; |HAZ LeoTabla; |SI nCambia = 1; #31#36 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #31#40; |HAZ LeoTabla; |SI nCambia = 1; #31#40 = aCtaNueva; nGraba = 1; |FINSI;

   |SI nGraba = 1;
       |GRABA 020#31a;
   |FINSI;
   |LIBERA #31;
|FPRC;

|DEFBUCLE cainliva;
   #31#1;
   4;
   00, 001, fDFecha;
   99, 999, fHFecha;
   be;
   NULL, cainliva1;
|FIN;

|| -------------- Registros de IVA/IRPF Lineas
|PROCESO caivalin1;
   mens = " Registros IVA/IRPF> " + #28#0 + "-" + #28#1 + "-" + #29#2; #0#1 = mens; |PINTA #0#1;

   nGraba = 0;
   aCtaAnterior = #29#12; |HAZ LeoTabla; |SI nCambia = 1; #29#12 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #29#13; |HAZ LeoTabla; |SI nCambia = 1; #29#13 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #29#14; |HAZ LeoTabla; |SI nCambia = 1; #29#14 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #29#15; |HAZ LeoTabla; |SI nCambia = 1; #29#15 = aCtaNueva; nGraba = 1; |FINSI;
   aCtaAnterior = #29#23; |HAZ LeoTabla; |SI nCambia = 1; #29#23 = aCtaNueva; nGraba = 1; |FINSI;

   |SI nGraba = 1;
       |GRABA 020#29a;
   |FINSI;
   |LIBERA #29;
|FPRC;

|DEFBUCLE caivalin;
   #29#1;
   ;
   #28#0, #28#1, 01;
   #28#0, #28#1, 99;
   be;
   NULL, caivalin1;
|FIN;
|| -------------- Registros de IVA/IRPF
|PROCESO camaniva1;
   mens = " Registros IVA/IRPF> " + #28#0 + "-" + #28#1; #0#1 = mens; |PINTA #0#1;

   aCtaAnterior = #28#12;
   |HAZ LeoTabla;
   |SI nCambia = 1;
       #28#12 = aCtaNueva;
       |GRABA 020#28a;
   |FINSI;

   |BUCLE caivalin;
   |LIBERA #28;
|FPRC;

|DEFBUCLE camaniva;
   #28#1;
   8;
   00, 0000000001, fDFecha;
   99, 9999999999, fHFecha;
   be;
   NULL, camaniva1;
|FIN;

|| -------------- Lineas Asientos contrapartida
|PROCESO calicont1;
   mens = " Contrapartidas Apuntes Lins.> " + #67#0 + "-" + #67#1 + "_" + #67#3 + "_" + #67#4; #0#1 = mens; |PINTA #0#1;

   aCtaAnterior = #67#4;
   |HAZ LeoTabla;
   |SI nCambia = 1;
       #67#4  = aCtaNueva;
       |GRABA 020#67a;
   |FINSI;
   |LIBERA #67;
|FPRC;

|DEFBUCLE calicont;
   #67#1;
   ;
   00, fDFecha,      0, 0001;
   99, fHFecha, 999999, 9999;
   be;
   NULL, calicont1;
|FIN;
|| -------------- Lineas Asientos
|PROCESO camaasil1;
   mens = " Apuntes Lins.> " + #26#0 + "-" + #26#1 + "_" + #26#3 + "_" + #26#4; #0#1 = mens; |PINTA #0#1;

   aCtaAnterior = #26#4;
   |HAZ LeoTabla;
   |SI nCambia = 1;
       #26#4  = aCtaNueva;
       |SI #26#8 = "H";
           #26#10 = #26#4;
           #26#11 = #26#5;
       |SINO;
           #26#16 = #26#4;
           #26#17 = #26#5;
       |FINSI;
       |GRABA 020#26a;
       nRecalculo = 1;
   |FINSI;
   |LIBERA #26;
|FPRC;

|DEFBUCLE camaasil;
   #26#1;
   ;
   00, fDFecha,      0, 0001;
   99, fHFecha, 999999, 9999;
   be;
   NULL, camaasil1;
|FIN;

|| -------------- Cabecera Asientos
|PROCESO camaasic1;
   mens = " Apuntes Cabs.> " + #25#0 + "-" + #25#1 + "_" + #25#3; #0#1 = mens; |PINTA #0#1;

   nGraba = 0;
   aCtaAnterior = #25#8;
   |HAZ LeoTabla;
   |SI nCambia = 1; #25#8  = aCtaNueva; nGraba = 1; |FINSI;

   aCtaAnterior = #25#10;
   |HAZ LeoTabla;
   |SI nCambia = 1; #25#10 = aCtaNueva; nGraba = 1; |FINSI;
   |SI nGraba = 1;
       |GRABA 020#25a;
   |FINSI;
   |LIBERA #25;
|FPRC;

|DEFBUCLE camaasic;
   #25#1;
   ;
   00, fDFecha,      0;
   99, fHFecha, 999999;
   be;
   NULL, camaasic1;
|FIN;

|| -------------- Linea Asientos Predefinidos
|PROCESO casieali1;
  mens = " Predefinidos> " + #21#0;   #0#1 = mens;   |PINTA #0#1;
  aCtaAnterior = #21#3;
  |HAZ LeoTabla;
  |SI nCambia = 1;
      #21#3 = aCtaNueva;
      |GRABA 020#21a;
  |FINSI;
  |LIBERA #21;
|FPRC;

|DEFBUCLE casieali;
 #21#1;
 ;
    1,  1;
 9999, 99;
 be;
 NULL, casieali1;
|FIN;

|| ************************************************************************
|PROCESO LeoTabla;
 aCtaNueva = aCtaAnterior;
 nCambia = 0;

 aAlfa1 = aCtaAnterior; |QBF aAlfa1;
 |SI aAlfa1 = ""; |O aAlfa1 = "PDTE"; |ACABA; |FINSI;

 |ABRE #405;
 |DDEFECTO #405;
 |SELECT #2#405;
 #405#2 = aCtaAnterior;
 #405#0 = "";
 #405#8 = 1;
 |LEE 001#405];
 |SI FSalida = 0; |Y #405#2 = aCtaAnterior;
      aCtaNueva = #405#4;
 |FINSI;
 |SELECT #1#405;
 |CIERRA #405;
 |SI aCtaAnterior ! aCtaNueva; |Y #405#7 = "S";
     aAlfa1 = aCtaNueva; |QBF aAlfa1;
     |SI aAlfa1 ! ""; |Y aAlfa1 ! "PDTE";
         nCambia = 1;
     |FINSI;
 |FINSI;
|FPRC;

|PROCESO LeoTabla_Pr;  ||por la Cuenta del A¤o pasado
 nCambia = 0;
 |ABRE #405;
 |DDEFECTO #405;
 #405#0 = eaCuenta;
 #405#8 = 1;
 |LEE 001#405];
 |SI FSalida = 0; |Y #405#0 = eaCuenta;
      |SI #405#7 = "S";
          aCtaNueva = #405#4;
          nCambia   = 1;
      |FINSI;
 |FINSI;
 |CIERRA #405;
 aAlfa1 = aCtaNueva; |QBF aAlfa1;
 |SI aAlfa1 = ""; |O aAlfa1 = "PDTE"; nCambia = 0; |FINSI;
|FPRC;

|PROCESO tipo3;

   |BUCLE casieali;  || xx
   |BUCLE camaasic;  || xx
   |BUCLE camaasil;  || xx
   |BUCLE calicont;  || xx
   |BUCLE camaniva;  || xx
   |BUCLE cainliva;  || xx

   |HAZ cadeflab;    || xx
   |BUCLE cadeflac;  || xx
   |BUCLE cadeflay;  || xx
   |BUCLE cadeflax;  || xx
   |BUCLE cadeflaz;  || xx
   |BUCLE cadeflal;  || xx

   |HAZ caivaasi;    || xx
   |BUCLE caexistc;  || xx
   |BUCLE caexistl;  || xx
   |BUCLE camautol;  || xx
   |BUCLE camauto1;  || xx
   |BUCLE cagruiva;  || xx

   |BUCLE caplalab;  || xx
   |BUCLE caconvec;  || xx
   |BUCLE caw00017;  || xx
   |BUCLE camaylin;  || xx
   |BUCLE capasven;  || xx

   |HAZ DirAplicSt;
   |SI Haymodelo ! 0;
       |BUCLE dsmom041;
       |BUCLE dsmom040;
   |FINSI;

   || No cambia catalm01 ni cafinanc, pues en el proceso de apertura
   || y cambio del plan estos ficheros no se cambia, dependen del ejercicio

   || ... Falta caconcic y caconcil / camoauxc y camoauxl / cacuepre

   |HAZ caclipro;

   |HAZ cacuenta;

   |BUCLE ca8m0003;
   |BUCLE ca8m0004;

   |DELINDEX #405;
|FPRC;

|| *******************************************************************
|PROGRAMA;

   |PINPA #0#0;

   |QBF fich_alta;
   |SI fich_alta = "";
       |DFICE fich_alta;
   |FINSI;

   fDFecha = fec1;
   fHFecha = fec2;

   |PATH_DAT #1   fich_alta;
   |PATH_DAT #5   fich_alta;
   |PATH_DAT #21  fich_alta;
   |PATH_DAT #25  fich_alta;
   |PATH_DAT #26  fich_alta;
   |PATH_DAT #28  fich_alta;
   |PATH_DAT #29  fich_alta;
   |PATH_DAT #31  fich_alta;
   |PATH_DAT #38  fich_alta;
   |PATH_DAT #39  fich_alta;
   |PATH_DAT #40  fich_alta;
                             || 41 y 42 amortizaciones
   |PATH_DAT #43  fich_alta;
   |PATH_DAT #44  fich_alta;
   |PATH_DAT #45  fich_alta;
   |PATH_DAT #46  fich_alta;
   |PATH_DAT #50  fich_alta;
   |PATH_DAT #51  fich_alta;
   |PATH_DAT #52  fich_alta;
   |PATH_DAT #64  fich_alta;
   |PATH_DAT #67  fich_alta;

   |PATH_DAT #69  fich_alta;
   |PATH_DAT #70  fich_alta;
   |PATH_DAT #71  fich_alta;

   |PATH_DAT #76  fich_alta;
   |PATH_DAT #77  fich_alta;
   |PATH_DAT #78  fich_alta;
   |PATH_DAT #79  fich_alta;
   |PATH_DAT #80  fich_alta;
   |PATH_DAT #81  fich_alta;
   |PATH_DAT #82  fich_alta;
   |PATH_DAT #83  fich_alta;
   |PATH_DAT #84  fich_alta;
   |PATH_DAT #403  fich_alta;
   |PATH_DAT #404  fich_alta;
   |PATH_DAT #405  fich_alta;

   |ABRE #405;
   |LEE 000#405p;
   |SI FSalida ! 0;
       |CIERRA #405;
       |ACABA;  ||no hay cambios
   |FINSI;
   |CIERRA #405;
   |HAZ tipo3;
|FPRO;
