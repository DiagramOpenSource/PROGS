|FICHEROS;
     camandia #0;
|FIN;

|VARIABLES;
     aMensaje = "";
     aAlfa1 = "";
     aModulo = "";
     nSuma = 0;
     aMascara = "";
     aLong = "";
     nLong = 0;
|FIN;

|PROCESO Filtro;
     |MODULO aModulo;
     |QBF aModulo;
     |SI aModulo ! "camandia";
          aMensaje = "0000Opcion no permitida";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     |LEE 101#camandia.=;
     |SI FSalida = 0;
          |C_V #camandia#4, 1, "S";
          |C_V #camandia#5, 1, "S";
          |C_V #camandia#6, 1, "S";
          |C_V #camandia#7, 1, "S";
          |C_M #camandia#4, 1, "S";
          |C_M #camandia#5, 1, "S";
          |C_M #camandia#6, 1, "S";
          |C_M #camandia#7, 1, "S";
          |PINTA #camandia#4;
          |PINTA #camandia#5;
          |PINTA #camandia#6;
          |PINTA #camandia#7;
          |PINTA 1816, "Control M scara (S/N):";
          |PINTA 1916, "A partir del d¡gito  :";
          |PINTA 2016, "N§ de d¡gitos  ......:";
          |PINTA 2116, "M scara .............:";

          |ENDATOS #1#camandia;
          |SI FSalida = 0;
               |GRABA 020#camandia.a;
          |FINSI;
          |LIBERA #camandia;
          |C_V #camandia#4, 1, "N";
          |C_V #camandia#5, 1, "N";
          |C_V #camandia#6, 1, "N";
          |C_V #camandia#7, 1, "N";
          |C_M #camandia#4, 1, "N";
          |C_M #camandia#5, 1, "N";
          |C_M #camandia#6, 1, "N";
          |C_M #camandia#7, 1, "N";
          |PINTA #camandia#4;
          |PINTA #camandia#5;
          |PINTA #camandia#6;
          |PINTA #camandia#7;
          |PINTA 1816, "                                      ";
          |PINTA 1916, "                                      ";
          |PINTA 2016, "                                      ";
          |PINTA 2116, "                                      ";
     |FINSI;
|FPRC;

|PROCESO Tipo20; |TIPO 20;
     aAlfa1 = FSalida;
     |SI aAlfa1 = "OPCION";
         FSalida = "Filtro";
         |ACABA;
     |FINSI;

     |LEE 101#0=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |HAZ Filtro;
|FPRC;


|PROCESO Tipo0C6; |TIPO 0;
     |SI #camandia#4 = "S";
          nSuma = #camandia#5 + #camandia#6;
          nSuma = nSuma - 1;
          |SI nSuma > 12;
               aMensaje = "0000Superado tope maximo 12 digitos para longitud cuenta";
               |MENAV aMensaje;
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0C7; |TIPO 0;
     aMascara = #camandia#7;
     |QBF aMascara;
     aLong = aMascara % A0;
     nLong = aLong;
     |SI nLong > #camandia#6;
          aMensaje = "0000La longitud de la mascara no puede ser superior a " + #camandia#6 + " digitos";
          |MENAV aMensaje;
          |ERROR;
     |FINSI;
|FPRC;
