|FICHEROS;
     otp00017 #0;
     caforpag #1;
     cafantas #2;
     cacuenta #5;
     cactrlal #11;
     caivaasi #200;

     cacugene;
     capaises;
     camaneof;

     canempre #30;
     &provinc@  #700;
     &poblaci@  #703;
     &regisnif@ #709;
     &clientes@ #715;
     &sgpaises@ #718;

     Referenc@ #1000;
     agifa112@;
|FIN;

|VARIABLES;
     &entrada = 0;
     antes = 0;
     salida = 0;
     cuenta = 0;
     digito = 0;
     pos1 = "";
     pos2 = "";
     cta = "";
     long1 = "";
     long = 0;
     pepe = 0;
     sw = 0;
     num = 0;
     men6      = "    SConfirma el Alta en Fichero General (S/N): ";
     men2  = "     Longitud de Cuenta Fuera de Nivel !";

     nEmpCart = 0;
     modo = 0;

     letra = "";
     alfa1 = "";
     alfa2 = "";
     final = "";
     x = "";
     pos3 = "";
     pos4 = "";
     nume1 = 0;
     nume2 = 0;
     cont = 0;
     lugar = 0;
     nifnum = 0;
     resto = 0;

     nSwErr = 0;
     aCliPro = "";

     aAlfa   = "";
     aPath   = "";
     aCuenta = "";
     esalta  = 0;
     directo = "";
     direct1 = "";
     traba   = "";
     longi   = "";
     swraf   = 0;
     swaltas = 0;
     &eaVarDni  = "";
     &enCalcCif = 0;

     aAlfa1 = "";
     aAlfa4 = "";
     aAlfa5 = "";
     nNume1 = 0;
     nInkey = 0;

     aDirec     = "";
     &eaDi0_n   = "";
     &eaDi1_n   = "";
     &eaDi2_n   = "";
     nSw        = 0;
     &eaNom_n   = "";
     &enCP1_n   = 0;
     &enCP2_n   = 0;
     &eaPob_n   = "";
     &eaPro_n   = "";
     &eaTel_n   = "";
     &eaFax_n   = "";
     &eaNomPais = "";

     &raf_oper = 0;
     &raf_clpr = "";
     &raf_cue = "";
     &raf_dig = 0;
     &raf_des = "";
     &raf_sw = 0;
     &raf_pase = "";
     &raf_blo = 0;
     &raf_tipo = "";
     &raf_agru = 0;
     &raf_epi = 0;
     &raf_par = 0;
     &raf_empresa = 0;
     &raf_periodo = 0;
     &raf_ejercic = 0;
     &raf_desde = 0;

     &enNoModDatosOTP = 0;

     aCampo1    = "";
     aCampo2    = "";
     aCampo9    = "";
     nCampo3    = 0;

     nModo      = 0;
     nCalc      = 0;
     nHayIntegrada = 0;
     nAltaSbctr = 0;

     nConsulta = 0;
     nCampo    = 0;
     nVent     = 0;

     aMas          = "";
     aPathComer    = "";

     {-1}aVent     = "";
         aVent1    = 0;
         aVent2    = 0;
         aVent3    = 0;
         aVent4    = 0;
         aVent5    = "";

     &eaCtaProv    = "";
     &enModo       = 0;
     &eaZona       = "";
     &enPerCta     = 0;
     &aDirFich     = "";
     &eaCodPro     = "";
|FIN;

|INCLUYE dscont_i;

|PROCESO Tipo12Aqui;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     |DBASS aAlfa; |QBF aAlfa;
     aMas = aAlfa + "dscomer9/def/agifa112.mas";
     |CARGA_DEF aMas, agifa112@;

     aPathComer = aAlfa + "dscomer9/fich/" + eaZona + "/";
     |PATH_DAT #agifa112@#aPathComer#;

     |ABRE #agifa112@;
     #agifa112@#0 = eaCodPro;
     |LEE 101#agifa112@.=;
     |SI FSalida = 0;
         #agifa112@#11  = #otp00017#13;
         #agifa112@#12  = #otp00017#32;
         #agifa112@#13  = #otp00017#31;
         #agifa112@#14  = #otp00017#29;
         #agifa112@#15  = #otp00017#30;
         #agifa112@#16  = #otp00017#14;
         #agifa112@#57  = #otp00017#19;
         #agifa112@#94  = #otp00017#38;
         #agifa112@#95  = #otp00017#39;
         #agifa112@#96  = #otp00017#40;
         #agifa112@#97  = #otp00017#41;

         #agifa112@#101 = #otp00017#44;
         #agifa112@#102 = #otp00017#45;
         #agifa112@#103 = #otp00017#46;
         #agifa112@#104 = #otp00017#47;
         #agifa112@#105 = #otp00017#48;
         #agifa112@#106 = #otp00017#49;

         |GRABA 020#agifa112@.a;
         |LIBERA #agifa112@;
     |FINSI;
     |CIERRA #agifa112@;

     |SI #otp00017#41 ! "           ";
         |ABRE #camaneof;
         #camaneof#0 = #otp00017#29;
         #camaneof#1 = #otp00017#30;
         |LEE 101#camaneof.=;
         |SI FSalida = 0;
             |SI #camaneof#9 = "           ";
                 #camaneof#9 = #otp00017#41;
                 |GRABA 020#camaneof.a;
             |FINSI;
             |LIBERA #camaneof;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo7C1Fgene;  |TIPO 7;
     |C_M #otp00017#0,  1, "N";
     |C_M #otp00017#1,  1, "N";
     |C_M #otp00017#2,  1, "N";
     |C_M #otp00017#3,  1, "N";
     |C_M #otp00017#4,  1, "N";
     |C_M #otp00017#7,  1, "N";
     |C_M #otp00017#8,  1, "N";
     |C_M #otp00017#9,  1, "N";
     |C_M #otp00017#33, 1, "N";
     |C_M #otp00017#51, 1, "N";
|FPRC;

|PROCESO LeoPara; |TIPO 0;
     |HAZ eLeeParametro;
|FPRC;

|PROCESO ClLocalidad; |TIPO 0;
     nume1 = Campo - 1;
     enCodPobl = #0Campo;
     enCodProv = #0nume1;
     |HAZ LeeLocalidad;
     |SI nume1 = 3;
         #0#5 = eaProvincia; |PINTA #0#5;
         #0#6 = eaPoblacion; |PINTA #0#6;
     |SINO;
         |SI nume1 = 15;
             #0#19 = eaPoblacion; |PINTA #0#19;
         |SINO;
             #0#47 = eaProvincia; |PINTA #0#47;
             #0#48 = eaPoblacion; |PINTA #0#48;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO cuenta; |TIPO 6;
   emCta   = 1;
   entrada = 2;
   digito = Campo + 1;

   eaCuenta = #0Campo;
   salidas  = FSalida;
   |HAZ FiltraPuntos;
   #0Campo = eaCuenta;
   |PINTA #0Campo;

   |HAZ SacaNivel;
   #0digito = enNivel;
   |SI eswCta = 1;
       |SI Campo = 21;
           #0digito = 1;
           |ACABA;
       |SINO;
           |MENAV men2;
           |ERROR;
           |ACABA;
        |FINSI;
   |FINSI;

   |SI Campo ! 10;  |ACABA;  |FINSI;
   alfa1 = #0Campo % 102;
   |SI alfa1 = "43";  |O alfa1 = "44";
      |SI #0#23 = "P";
         |MENAV "     ATENCION Esta Cuenta DEBERIA ser de Clientes";
      |FINSI;
   |FINSI;
   |SI alfa1 = "40";  |O alfa1 = "41";  |O alfa1 = "52";
      |SI #0#23 = "C";
         |MENAV "     ATENCION Esta Cuenta DEBERIA ser de Proveedores";
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO nocero; |TIPO 6;
     |SI #0#20 ! 0;  |ACABA;  |FINSI;

     |ABRE #caforpag;
     #caforpag#0 = #0#20;
     |LEE 001#caforpag.=;              || graba el codigo cero para que no
     |SI FSalida ! 0;          ||/salga la pantalla
         |DDEFECTO #caforpag;
         #caforpag#0 = #0#20;
         #caforpag#2 = 1;
         |GRABA 020#caforpag.n;
     |FINSI;
     |CIERRA #caforpag;
|FPRC;

|PROCESO AltaCertificados;
     aAlfa = "    N" + &191 + " Alta certificado subcontratista ? ";
     |CONFI aAlfa;
     |SI FSalida = 0;
         aAlfa = "|:basica/tadz0001.tab;" + (("00000" + #48#2) % -105) + "," + #48#8; |QBF aAlfa;
         aAlfa = aAlfa + "," + #48#1; |QBF aAlfa;
         aAlfa1 = #0#9; |QBT aAlfa1;
         aAlfa = aAlfa + "@NUEVO" + aAlfa1 + "," + #otp00017#1; |QBF aAlfa;
         |SUB_EJECUTA aAlfa;
     |FINSI;
|FPRC;

|PROCESO ConsultaCertific;
    aAlfa = "|:basica/tadz0001.tab;" + (("00000" + #48#2) % -105) + "," + #48#8; |QBF aAlfa;
    aAlfa = aAlfa + "," + #48#1; |QBF aAlfa;
    aAlfa = aAlfa + "|" + #0#9; |QBF aAlfa;
    |SUB_EJECUTA aAlfa;
|FPRC;

|PROCESO VerCertificados;
     nConsulta = 0;
     |DBASS aAlfa; |QBF aAlfa;
     aAlfa = aAlfa + "basica/def/tadm0001.mas";
     |CARGA_DEF aAlfa, Referenc@;
     |SI FSalida = 0;
         nConsulta = 1;
         |DBASS aAlfa; |QBF aAlfa;
         aAlfa = aAlfa + "basica/fich/";
         |PATH_DAT #Referenc@#aAlfa#;
         |ABRE #Referenc@;
         #Referenc@#0 = enEmpresa;
         #Referenc@#1 = #0#9;
         |LEE 000#Referenc@.=;
         |SI FSalida = 0;
             nConsulta = 4;
         |FINSI;
         |CIERRA #Referenc@;
         |DESCARGA_DEF #Referenc@;
      |FINSI;

      |SI nConsulta ! 0;
          |SI nConsulta = 1;
              |HAZ AltaCertificados;
          |SINO;
              |HAZ ConsultaCertific;
          |FINSI;
      |FINSI;
|FPRC;

|PROCESO LaDivision;
     eaDi0_n = "";
     eaDi1_n = aDirec;
     eaDi2_n = "";

     nSw    = 0;
     aAlfa1 = aDirec % 103;
     |SI aAlfa1 = "CL ";  nSw = 1; |FINSI;
     |SI aAlfa1 = "AV ";  nSw = 1; |FINSI;
     |SI aAlfa1 = "PA ";  nSw = 1; |FINSI;
     |SI aAlfa1 = "PZ ";  nSw = 1; |FINSI;
     |SI aAlfa1 = "PL ";  nSw = 1; |FINSI;
     |SI aAlfa1 = "CR ";  nSw = 1; |FINSI;
     |SI nSw = 1;
         eaDi0_n = aAlfa1;
         eaDi1_n = aDirec % 440;
     |FINSI;
|FPRC;

|PROCESO creacod2; |TIPO 0;
   pos1 = #0#15;
   pos2 = "000" + pos1;
   traba = pos2 % -102;
   pos1 = #0#16;
   pos2 = "0000" + pos1;
   pos1 = pos2 % -103;
   #0#26 = traba + pos1;
|FPRC;

|PROCESO creacod3; |TIPO 0;
     pos1 = #0#45;
     pos2 = "000" + pos1;
     traba = pos2 % -102;
     pos1 = #0#46;
     pos2 = "0000" + pos1;
     pos1 = pos2 % -103;
     #0#50 = traba + pos1;
|FPRC;

|PROCESO igualdad;
     #0#9 = #709#0;
     #0#1 = #709#1;

     traba = #709#9;
     |QBF traba;
     |SI traba = "";
         #0#2 = #709#2;
     |SINO;
         #0#2 = traba + " " + #709#2;
     |FINSI;
     traba = #0#2; |QBF traba;
     #0#2 = traba + ", " + #709#3;
     traba = #0#2; |QBF traba;
     #0#2 = traba + " " + #709#10;
     traba = #0#2; |QBF traba;
     #0#2 = traba + " " + #709#11;

     #0#3 = #709#4;
     #0#4 = #709#5;
     #0#5 = #709#7;
     #0#6 = #709#6;
     #0#7 = #709#8;
     #0#8 = #709#17;
     #0#24 = #709#12;

     |PINTA #0#1; |PINTA #0#2; |PINTA #0#3;
     |PINTA #0#4; |PINTA #0#5; |PINTA #0#6;
     |PINTA #0#7; |PINTA #0#9; |PINTA #0#24;
     |PINTA #0#8;

     |HAZ Envio7;
|FPRC;

|PROCESO IgualEnvio;
     #0#44 = #0#2;  |PINTA #0#44;
     #0#45 = #0#3;  |PINTA #0#45;
     #0#46 = #0#4;  |PINTA #0#46;
     #0#47 = #0#5;  |PINTA #0#47;
     #0#48 = #0#6;  |PINTA #0#48;
     #0#49 = #0#27; |PINTA #0#49;
     #0#50 = #0#25;
|FPRC;

|PROCESO Envio7; |TIPO 7;
     aAlfa = #otp00017#44;  |QBF aAlfa;
     |SI aAlfa ! "";  |ACABA;  |FINSI;

     |HAZ IgualEnvio;
|FPRC;

|PROCESO Envio0; |TIPO 0;
     nInkey = FSalida;
     |SI nInkey = 10; |HAZ IgualEnvio; |FINSI;
|FPRC;

|PROCESO cuapais;
     |PUSHV 1102 1850;
     |D_CUADRO 1102, 1850;
     |ATRI R;
     |PINTA 1203 , " ------------ PAISES COMUNITARIOS -------------";
     |ATRI N;
     |PINTA 1303 , " ES Espa¤a      FR Francia       IT Italia     ";
     |PINTA 1403 , " DE Alemania    EL Grecia        IE Irlanda    ";
     |PINTA 1503 , " BE Belgica     GB Gran Breta¤a  LU Luxemburgo ";
     |PINTA 1603 , " DK Dinamarca   NL Holanda       PT Portugal   ";
     |PINTA 1703 , " FI Finlandia   SE Suecia        AT Austria    ";
     |ATRI I;
     |PINTA 1304 , "ES"; |PINTA 1319 , "FR"; |PINTA 1336 , "IT";
     |PINTA 1404 , "DE"; |PINTA 1419 , "EL"; |PINTA 1436 , "IE";
     |PINTA 1504 , "BE"; |PINTA 1519 , "GB"; |PINTA 1536 , "LU";
     |PINTA 1604 , "DK"; |PINTA 1619 , "NL"; |PINTA 1636 , "PT";
     |PINTA 1704 , "FI"; |PINTA 1719 , "SE"; |PINTA 1736 , "AT";
     |ATRI 0;
     |PAUSA;
     |POPV;
|FPRC;

|PROCESO filtro; |TIPO 0;
     |SI FSalida = 9;
        |HAZ cuapais;
        |ERROR;
        |ACABA;
     |FINSI;
     pepe = 0;
     |SI #0#24 = "ES "; |O #0#24 = "DE "; |O #0#24 = "BE "; |O #0#24 = "DK ";
        pepe = 1;
     |FINSI;
     |SI #0#24 = "FR "; |O #0#24 = "EL "; |O #0#24 = "GB "; |O #0#24 = "NL ";
        pepe = 1;
     |FINSI;
     |SI #0#24 = "IT "; |O #0#24 = "IE "; |O #0#24 = "LU "; |O #0#24 = "PT ";
        pepe = 1;
     |FINSI;
     |SI #0#24 = "FI "; |O #0#24 = "SE "; |O #0#24 = "AT ";
        pepe = 1;
     |FINSI;
     |SI pepe = 0;
     || |MENAV "     Pais incorrecto.";
     |FINSI;
|FPRC;

|PROCESO AntesConf; |TIPO 7;
    |SI #0#23 = "P";
        |C_M #0Campo,1,"S";
    |SINO;
        |C_M #0Campo,1,"N";
    |FINSI;
|FPRC;

|PROCESO ElBanco7; |TIPO 7;
     |SI #0#23 =  "C"; eaVC = "V"; |FINSI;
     |SI #0#23 =  "P"; eaVC = "C"; |FINSI;
     enSwLoLeo = 0;
     |HAZ LeeBanco;
     |SI enElBanco = 1;
         |C_M #0Campo,1,"N";
         #0Campo = 999; |PINTA #0Campo;
     |SINO;
         |C_M #0Campo,1,"S";
     |FINSI;
|FPRC;

|PROCESO ElBanco0; |TIPO 0;
     nInkey = FSalida;
     |C_M #0Campo,0,aAlfa1;
     |SI aAlfa1 = "N"; |ACABA; |FINSI;

     |SI #0Campo = 999;
         #2#8 = "BANCO STANDAR";
         |PINTA 1724, #2#8;
         |ACABA;
     |FINSI;
     eOpBan = 0; || 1 = Consulta pantalla
     |SI nInkey = 10; eOpBan = 1;  |FINSI;

     enSwLoLeo = 1;
     enBanco = #0Campo;
     |HAZ LeeBanco;
     |SI eswLect = 0;
         #0Campo = enBanco; |PINTA #0Campo;
         #2#8    = eaNomBanco;
     |SINO;
         #2#8    = "NO EXISTE CODIGO DE BANCO PROPIO";
     |FINSI;
     |PINTA 1724, #2#8;
|FPRC;

||----------------------------------------------------

|PROCESO TrasIVACl; |TIPO 0;
     nInkey = FSalida;

     |SI #0#23 = "C";
         aTipoIVA = "R";
     |SINO;
         aTipoIVA = "S";
     |FINSI;

     |SI nInkey = 10;
        efFechaIVA = ~; enIvaTot = 1; |HAZ SelecTipoIVA; enIvaTot = 0;
        #0Campo = enLineaIVA; |PINTA #0Campo;
        |ERROR;
     |FINSI;

     |SI #0Campo ! 0;
        efFechaIVA = "31.12.2999";
        enLineaIVA = #0Campo;
        |HAZ SacaIVA;
        |SI enLineaIVA < 0;
           |MENAV "    Control de Tipo de IVA no definido";
           enLineaIVA = 0;
        |FINSI;
     |FINSI;
|FPRC;

|PROCESO NoBlanco; |TIPO 0;
   |SI Campo = 1; aAlfa1 = "Nombre en Blanco"; |FINSI;
   |SI Campo = 2; aAlfa1 = "Direccion en Blanco"; |FINSI;
   |SI Campo = 3; aAlfa1 = "Codigo Provincia"; |FINSI;
   traba = #0Campo;
   |SI Campo = 3; |Y #0Campo = 0; traba = ""; |FINSI;

   |QBF traba;
   |SI traba = ""; |Y eaPaNif2 ! "S";
       |SI eaPaNif2 = "N";
           aAlfa1 = "    Error. " + aAlfa1;
           |MENAV aAlfa1;
       |FINSI;
       |SI eaPaNif2 = "X";
           aAlfa1 = "    NError. " + aAlfa1 + ". Continuar";
           |CONFI aAlfa1;
       |FINSI;
       |SI FSalida ! 0; |O eaPaNif2 = "N";
           |ERROR;
       |FINSI;
   |FINSI;
|FPRC;

|PROCESO Tipo3clipro; |TIPO 3;
  |HAZ eLeeParametro;
  |SI eaPaNif2 ! "S";
      aCampo1 = #0#1; |QBF aCampo1;
      aCampo9 = #0#9; |QBF aCampo9;
      aCampo2 = #0#2; |QBF aCampo2;
      nCampo3 = #0#3;

      aAlfa1 = ""; nNume1 = 0;
      |SI aCampo1 = ""; aAlfa1 = "Nombre en Blanco";    nNume1 = nNume1 + 1; |FINSI;
      |SI aCampo2 = ""; aAlfa1 = "Direccion en Blanco"; nNume1 = nNume1 + 1; |FINSI;
      |SI aCampo9 = ""; aAlfa1 = "NIF en Blanco";       nNume1 = nNume1 + 1; |FINSI;
      |SI nCampo3 = 0;  aAlfa1 = "Codigo Provincia";    nNume1 = nNume1 + 1; |FINSI;

/*
      |SI aCampo1 = ""; |Y aCampo2 = ""; |Y aCampo9 = ""; |Y nCampo3 = 0; aAlfa1 = "Nombre, NIF, Direccion en Blanco y Cod.Provincia"; |FINSI;
      |SI aCampo1 = ""; |Y aCampo2 = ""; |Y aCampo9 = ""; |Y nCampo3 ! 0; aAlfa1 = "Nombre, NIF y Direccion en Blanco"; |FINSI;
      |SI aCampo1 = ""; |Y aCampo2 = ""; |Y aCampo9 ! ""; |Y nCampo3 = 0; aAlfa1 = "Nombre, Direccion y Cod.Provincia en Blanco"; |FINSI;
      |SI aCampo1 = ""; |Y aCampo2 ! ""; |Y aCampo9 = ""; |Y nCampo3 = 0; aAlfa1 = "Nombre y NIF en Blanco"; |FINSI;
      |SI aCampo1 ! ""; |Y aCampo2 = ""; |Y aCampo9 = ""; |Y nCampo3 = 0; aAlfa1 = "NIF, Direccion y Cod.Postal en Blanco"; |FINSI;
*/

      |SI nNume1 > 1;
          aAlfa4 = "";
          |SI aCampo1 = "";  aAlfa4 = "Nombre";  |FINSI;
          |SI aCampo2 = "";
              aAlfa5 = " y ";
              |SI aCampo9 = ""; |O nCampo3 = 0; aAlfa5 = ", "; |FINSI;
              |SI aAlfa4  = "";                 aAlfa5 = "";   |FINSI;
              aAlfa4 = aAlfa4 + aAlfa5 + "Direccion";
          |FINSI;
          |SI aCampo9 = "";
              aAlfa5 = " y ";
              |SI nCampo3 = 0;  aAlfa5 = ", "; |FINSI;
              |SI aAlfa4 = "";  aAlfa5 = "";   |FINSI;
              aAlfa4 = aAlfa4 + aAlfa5 + "DNI";
          |FINSI;
          |SI nCampo3 = 0;
              aAlfa5 = " y ";
              |SI aAlfa4 = "";  aAlfa5 = "";   |FINSI;
              aAlfa4 = aAlfa4 + aAlfa5 + "Cod.Provincia";
          |FINSI;
          aAlfa1 = aAlfa4 + " en Blanco";
      |FINSI;
      |SI aAlfa1 ! "";
          |SI eaPaNif2 = "N";
              aAlfa1 = "    Error. " + aAlfa1;
              |MENAV aAlfa1;
          |FINSI;
          |SI eaPaNif2 = "X";
              aAlfa1 = "    NError. " + aAlfa1 + ". Continuar";
              |CONFI aAlfa1;
          |FINSI;
          |SI FSalida ! 0; |O eaPaNif2 = "N";
              |ERROR;
          |FINSI;
      |FINSI;
  |FINSI;

  nModo = (FEntrada / 100) ! 0;
  |SI nModo = 1;
     |ABRE #caivaasi;
     |LEE 000#caivaasi.p;
     |SI FSalida ! 0; |DDEFECTO #caivaasi; |FINSI;
     |CIERRA #caivaasi;

     |SI #caivaasi#163 = "S";
         |HAZ AltaCertificados;
     |FINSI;
  |FINSI;
|FPRC;

|PROCESO AltaOtras; |TIPO 30;
     esalta = (FEntrada /100) !0;

     swaltas = 0;
     raf_empresa = enEmpresa;
     raf_periodo = enPeriodo;
     raf_ejercic = enAny;

     |ABRE #11;
     |DDEFECTO #11;
     |LEE 101#11p;
     |SI FSalida ! 0; swaltas = 1; |FINSI;
     |LIBERA #11;
     |CIERRA #11;
     |SI swaltas = 1; |ACABA; |FINSI;

     |SI #11#62 ! "S"; |Y esalta = 2; |ACABA; |FINSI;

     swraf = 1;
     alfa1 = #cactrlal#1; |QBF alfa1;
     alfa2 = #cactrlal#2; |QBF alfa2;
     |SI alfa1 ! ""; |O alfa2 ! ""; swraf = 0; |FINSI;
     alfa1 = #cactrlal#3; |QBF alfa1;
     alfa2 = #cactrlal#4; |QBF alfa2;
     |SI alfa1 ! ""; |O alfa2 ! ""; swraf = 0; |FINSI;
     alfa1 = #cactrlal#5; |QBF alfa1;
     alfa2 = #cactrlal#6; |QBF alfa2;
     |SI alfa1 ! ""; |O alfa2 ! ""; swraf = 0; |FINSI;
     |SI swraf = 1; |ACABA; |FINSI;

     swraf = 1;
     |SI #0#10 ] #cactrlal#1; |Y #0#10 [ #cactrlal#2; swraf = 0; |FINSI;
     |SI #0#10 ] #cactrlal#3; |Y #0#10 [ #cactrlal#4; swraf = 0; |FINSI;
     |SI #0#10 ] #cactrlal#5; |Y #0#10 [ #cactrlal#6; swraf = 0; |FINSI;

     |SI swraf = 1; |ACABA; |FINSI;

     raf_oper = esalta;
     raf_clpr = #0#23;
     raf_cue  = #0#10;
     raf_dig  = #0#11;
     raf_des  = #0#1;

     |ABRE #cacuenta;
     |DDEFECTO #cacuenta;
     #cacuenta#0 = #0#10;
     #cacuenta#1 = #0#11;
     |LEE 001#cacuenta.=;
     |CIERRA #cacuenta;

     raf_pase = #cacuenta#3;
     raf_blo  = #cacuenta#4;
     raf_tipo = #cacuenta#5;
     raf_agru = #cacuenta#6;
     raf_epi  = #cacuenta#7;
     raf_par  = #cacuenta#8;

     |CIERRAT #0;
     raf_desde = 1;
     |SUB_EJECUTA_NP "caltacta.tab";
     raf_desde = 0;
     |ABRET #0;
|FPRC;

|PROGRAMA;
     |ABRE #canempre;
     #canempre#2 = eaZona;
     #canempre#3 = enPerCta;
     |LEE 000#canempre.=;
     |CIERRA #canempre;

     |DBASE aBase;
     aDirFich = aBase + "fich/" + eaZona + enPerCta + "/";
     |PATH_DAT #cacugene#aDirFich#;
     |PATH_DAT #caforpag#aDirFich#;
     |PATH_DAT #cacuenta#aDirFich#;
     |PATH_DAT #cactrlal#aDirFich#;
     |PATH_DAT #caivaasi#aDirFich#;
     |PATH_DAT #capaises#aDirFich#;

     fich_alta = eaZona + enPerCta;
     |HAZ inicio;

     |ABRE #cacugene;
     #cacugene#23 = "P";
     #cacugene#10 = eaCtaProv;
     |LEE 101#cacugene.=;
     |SI FSalida ! 0;
         |MENAV "0000No existe el proveedore en la zona solicitada. Pongase en contacto con su administrador";
         |CIERRA #cacugene;
         |ACABA;
     |FINSI;

     |VENTANA 0501, 3199, -1, 16, "Datos proveedor";
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PARA nCampo = 0;  |SI nCampo [ 51;  |HACIENDO nCampo = nCampo + 1;
           #otp00017#nCampo# = #cacugene#nCampo#;
     |SIGUE;

     |PINPA #0#otp00017;
     |PINDA #0#otp00017;

     |SI enModo ! 4;
         |ENDATOS #2#otp00017;
         |SI FSalida = 0;
             |PARA nCampo = 0;  |SI nCampo [ 51;  |HACIENDO nCampo = nCampo + 1;
                   #cacugene#nCampo# = #otp00017#nCampo#;
             |SIGUE;

             |GRABA 020#cacugene.a;
         |FINSI;
     |SINO;
         |LEETECLA aAlfa;
     |FINSI;

     |LIBERA #cacugene;
     |CIERRA #cacugene;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVent;
|FPRO;
