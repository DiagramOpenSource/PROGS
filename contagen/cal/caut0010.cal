|FICHEROS;
   caut0010 #0;

   caconimp #8;

   canempre #30;
   caselem1 #998;
|FIN;

|VARIABLES;
   aAlfa1    = "";
   aAlfa2    = "";
   aAlfa3    = "";
|FIN;

|INCLUYE dscont_i;

____________________________________/ CALCULOS DESDE PANTALLA
|PROCESO SiLaser; |TIPO 7;
   |SI #0#0 = "L";
      |C_M #0#1, 1, "S";
   |SINO;
      |C_M #0#1, 1, "N";
      #0#1 = "N"; |PINTA #0#1;
   |FINSI;
|FPRC;

|PROCESO Sibloqueo; |TIPO 0;
 |C_M #0#4, 0, aAlfa1;
 |SI aAlfa1 = "N"; |ACABA; |FINSI;

 |C_M #0#5,1,"S";
 |SI #0#4 = "S";
     |C_M #0#5,1,"N";
     #0#5 = "S"; |PINTA #0#5;
 |FINSI;
|FPRC;

|PROCESO AsAper; |TIPO 0;
 |C_M #0#14, 0, aAlfa1;
 |SI aAlfa1 = "N"; |ACABA; |FINSI;

 aAlfa1 = #0#14;
 |C_M #0#16, 1, aAlfa1;
|FPRC;

|PROCESO Sihago; |TIPO 0;
 |C_M #0#11, 0, aAlfa1;
 |SI aAlfa1 = "N"; |ACABA; |FINSI;

 aAlfa1 = #0#11;
 |C_M #0#12,1,aAlfa1;
 |SI aAlfa1 = "N";
     #0#12 = "S"; |PINTA #0#12;
 |FINSI;
|FPRC;

|PROCESO Sihora; |TIPO 0;
 |C_M #0#22, 0, aAlfa1;
 |SI aAlfa1 = "N"; |ACABA; |FINSI;

 aAlfa1 = #0#22;
 |C_M #0#23,1,aAlfa1;
|FPRC;

|CALCULO QueHago; |TIPO 0;
  aAlfa1 = #0Campo;
  |SI Campo = 3;
      |C_M #0#0, 1, aAlfa1;
      |C_M #0#1, 1, aAlfa1;
      |C_M #0#2, 1, aAlfa1;
  |FINSI;

  |SI Campo = 6;
      |C_M #0#4, 1, aAlfa1;
      |C_M #0#5, 1, aAlfa1;
  |FINSI;

  |SI Campo = 10;
      |C_M #0#7,  1, aAlfa1;
      |C_M #0#8,  1, aAlfa1;
      |C_M #0#9,  1, aAlfa1;
  |FINSI;

  |SI Campo = 13;
      |C_M #0#11, 1, aAlfa1;
      |C_M #0#12, 1, aAlfa1;
  |FINSI;

  |SI Campo = 17;
      |C_M #0#14,  1, aAlfa1;
      |C_M #0#15,  1, aAlfa1;
      |C_M #0#16,  1, aAlfa1;
  |FINSI;

  |SI Campo = 19;
      |C_M #0#18,  1, aAlfa1;
  |FINSI;

  |SI Campo = 21;
      |C_M #0#20,  1, aAlfa1;
  |FINSI;

  |SI Campo = 24;
      |C_M #0#22,  1, aAlfa1;
      |C_M #0#23,  1, aAlfa1;
  |FINSI;
|FCAL;

|| ***********************************************************************

|PROCESO HazTodo;

   |PATH_DAT #8 dirfich0;

   |ABRE #8;
   |LEE 141#8p;
   |SI FSalida ! 0;
       |DDEFECTO #8;
       |GRABA 020#8b;
   |FINSI;

   |SI #0#3 = "S";
       #8#1  = #0#0;
       #8#5  = #0#1;
       #8#4  = #0#2;
   |FINSI;

   |SI #0#6 = "S";
       #8#10 = #0#4;
       #8#2  = #0#5;
   |FINSI;

   |SI #0#10 = "S";
       #8#7  = #0#7;
       #8#8  = #0#8;
       #8#9  = #0#9;
   |FINSI;

   |SI #0#13 = "S";
       #8#14 = #0#11;
       #8#15 = #0#12;
   |FINSI;

   |SI #0#17 = "S"; |Y enEjercicio = 2008;
       #8#11 = #0#14;
       #8#12 = #0#15;
       #8#13 = #0#16;
   |FINSI;

   |SI #0#19 = "S";
       #8#16 = #0#18;
   |FINSI;

   |SI #0#21 = "S";
       #8#17 = #0#20;
   |FINSI;

   |SI #0#24 = "S";
       #8#18 = #0#22;
       #8#19 = #0#23;
   |FINSI;

   |GRABA 020#8a;
   |LIBERA #8;
   |CIERRA #8;
|FPRC;

|PROCESO MultiEmp1;
   cod1 = #caselem1#1;
   cod2 = #caselem1#2;
   emEmp = 1;  || Sin mensaje
   |HAZ leelo;
   |SI swerror ! 0;  |ACABA;   |FINSI;

   |PINTA 2222, #30#2;
   |PINTA 2228, #30#3;
   |PINTA 2230, #30#1;

   dirfich0  = #caselem1#3;
   |QBF dirfich0;

   |HAZ HazTodo;
|FPRC;


|DEFBUCLE MultiEmp0;
 #caselem1#1;
 ;
 000001;
 999999;
 ;
 NULL,MultiEmp1;
|FIN;


|CALCULO recupera; |TIPO 3;

   |SI #0#3 = "N"; |Y #0#6 = "N"; |Y #0#10 = "N";
      |Y #0#13 = "N"; |Y #0#17 = "N"; |Y #0#19 = "N"; |Y #0#21 = "N";
        |Y #0#24 = "N";
       |MENAV "    NO MODIFICA NINGUN DATO DE LA CONFIGURACION DE IMPRESION";
       |ACABA;
   |FINSI;

   |SUB_EJECUTA "caselemp";
   |NOME_DAT #998 eaFichsel;
   |ATRI R; |PINTA 2202, "Procesando Empresa: "; |ATRI 0;
   |BUCLE MultiEmp0;
   |DELINDEX #998;
|FCAL;
