|FICHEROS;
   caextraj #0;
   camaasil #1;
   cacuenta #3;
   caextrp2 #4;
|FIN;

|VARIABLES;
   &entrada = 1;
   &ext1   = "";
   &ext2   = "";
   &impord = 0;
   &imporh = 0;
   &varald = "";
   &varalh = "";

   &nDiaE = 0;
   &fFecE = @;
   &nDocE = 0;
   &nApuE = 0;

    &swprog  = 0;
    sw_pinta = 0;
    sw = 0;
    sw_acum = 0;
    sw_print = 0;
    sw_error = 0;
    lin = 0;
    cuenta = "";
    men1   = "    NO EXISTE EMPRESA";
    mensa1 = "    ERROR ESTA FECHA NO CORRESPONDE AL EJERCICIO";
    traba1 = "";
    fec11 = @;
|FIN;

|INCLUYE dscont_i;

|| *********************************************************************
|PROGRAMA;
   |HAZ inicio;

   |DDEFECTO #0;
   #0#0 = ext1;

   |ABRE #3;
   #3#0 = #0#0;
   |LEE 040#3=;
   |SI FSalida ! 0;
       |CIERRA #3;
       |ACABA;
   |FINSI;

   #0#4 = #3#2;
   |PINPA #0#0;
   |PINDA #0#0;
   |ENDATOS #1#0;

   |SI FSalida = 0;
         impord = #0#2 - #0#3;
         imporh = #0#2 + #0#3;
         varald = " ";
         varalh = &160;
         |SI #0#1 = "S";
             varald = "!";
         |SINO;
             |SI #0#1 = "N";
                 varalh = " ";
             |FINSI;
         |FINSI;
         |HAZ impre;
      |FINSI;
   |FINSI;
|FPRO;

|| .... Crear Auxiliares
|PROCESO buclepan;
   #caextrp2#00 = linea;            || linea
   |LEE 101#4=;
   FEstado = FSalida;
   #caextrp2#00 = linea;            || linea
   #caextrp2#01 = #caextrap#0;             || cuenta
   #caextrp2#02 = #caextrap#4;             || descripcion
   #caextrp2#03 = #caextrap#2;             || desde fecha
   #caextrp2#04 = #caextrap#3;             || hasta fecha
   #caextrp2#18 = #camaasil#0;             || diario
   #caextrp2#08 = #camaasil#1;             || fecha
   #caextrp2#09 = #camaasil#2;             || documento
   #caextrp2#19 = #camaasil#3;             || Apunte
   #caextrp2#10 = #camaasil#7;             || descripcion
   #caextrp2#20 = #camaasil#21;            || Departamento
   #caextrp2#21 = #camaasil#28;            || Subdepartamento
   #caextrp2#11 = #camaasil#8;             || signo (no en pantalla!!!)
   |SI #caextrp2#11 = "D";
      #caextrp2#05 = #caextrp2#05 + #camaasil#9; || total debe arriba
      #caextrp2#12 = #camaasil#9;                || importe debe
      #caextrp2#13 = #caextrp2#13 + #camaasil#9; || total saldo detalle
      #caextrp2#14 = #caextrp2#14 + #camaasil#9; || total debe abajo
      #caextrp2#17 = 0;                          || importe haber detalle
      d_abajo = d_abajo + #camaasil#9;           || ACUMULADO DEBE FINAL
   |SINO;
      #caextrp2#06 = #caextrp2#06 + #camaasil#9; || total haber arriba
      #caextrp2#12 = 0;            || importe debe
      #caextrp2#13 = #caextrp2#13 - #camaasil#9; || total saldo detalle
      #caextrp2#15 = #caextrp2#15 + #camaasil#9; || total haber abajo
      #caextrp2#17 = #camaasil#9;                || importe haber detalle
      h_abajo      = h_abajo + #camaasil#9;      || ACUMULADO HABER FINAL
   |FINSI;

   #caextrp2#07 = #caextrp2#05 - #caextrp2#06;    || saldo arriba
   s_abajo = d_abajo - h_abajo;        || SALDO FINAL
   |SI #camaasil#1 ] #caextrap#2;|Y #camaasil#1 [ #caextrap#3;
      hay_alguno = 1;
   |FINSI;
   |SI #camaasil#1 [ #caextrap#3;              || fecha dentro del limite hasta
      |SI FEstado = 0;
         |GRABA 020#4a;
      |SINO;
         |GRABA 020#4n;
      |FINSI;
      |LIBERA #4;
      |SI #camaasil#1 ] #caextrap#2;              || fecha dentro del limite desde
         linea = linea + 1;
      |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE caextrp00;
   #1#3;
   0, 6, 21, 28;
   #0#0, fe1,      1, 0001, #0#10, #0#5, #0#7,#0#13;
   #0#0, fe2, 999999, 9999, #0#11, #0#6, #0#8,#0#14;
   ;
   NULL, buclepan;
|FIN;
_____________________________________________________________________________

|RUTINA min;
   #caextrp2#0 = 1;
|FRUT;

|RUTINA max;
   #caextrp2#0 = 999999;
|FRUT;

|PROCESO impre1;

   linea = 1;
   hay_alguno = 0;
   |HAZ nom_usu;
   alfa1 = "o" + nom_tmp;
   |NOME_DAT #caextrp2 #alfa1#;
   aFitxer = alfa1;

   |DELINDEX #4;
   |ABRE #4;
   |BUCLE caextrp00;
   |CIERRA #4;

   |SI #caextrap#12 = "N";
       d_abajo = #cacuenta#51;
       h_abajo = #cacuenta#52;
       s_abajo = #cacuenta#53;
   |FINSI;
   |SI hay_alguno ! 0;
       |ENTLINEAL #1#4, -1, 4, 20, 1, min, max;
   |SINO;
       |MENAV "    Seleccion vacia ...";
   |FINSI;
   |DELINDEX #4;
|FPRC;
