|FICHEROS;
   anz00018 #0;       || Informe comprobacion suma y saldos
   anm00005 #4;
   anm00006 #5;
   anm00018 #18;
|FIN;

|VARIABLES;

   nInkey  = 0;
   alfa1   = "";
   mensa3  = "    CUENTA ANALITICA ERRONEA !!!";

   selec  = 0;
   swsel  = 0;
   nSw    = 0;
   incta  = "";
   ficta  = "";
   aDCuenta = "";
   aHCuenta = "";
|FIN;

|INCLUYE dscont_i;
|INCLUYE dscoan_i;

|| ***********************************************************************
||                       CALCULOS DE PANTALLA
|| ***********************************************************************
|CALCULO LeeSelec; |TIPO 6;
 |SI #0Campo = 0;
     #0#5 = "SIN SELECTOR DE CUENTAS";
     |C_M #0#6, 1, "S";
     |C_M #0#7, 1, "S";
 |SINO;
     |C_M #0#6, 1, "N"; #0#6 = "            "; |PINTA #0#6;
     |C_M #0#7, 1, "N"; #0#7 = "zzzzzzzzzzzz"; |PINTA #0#7;
     |ABRE #4;
     #4#0 = #0Campo;
     |LEE 001#4=;
     |SI FSalida ! 0;
         #4#1 = "ERROR SELECTOR NO EXISTE";
         |ERROR;
     |FINSI;
     #0#5 = #4#1;
     |CIERRA #4;
 |FINSI;
 |PINTA #0#5;
|FCAL;

|CALCULO cuenta; |TIPO 0;
   nInkey = FSalida;
   |SI nInkey = 2;   |ACABA; |FINSI;

   |C_M #0Campo,0,alfa1;
   |SI alfa1 = "N"; |ACABA; |FINSI;

   eaCuenta = #0Campo;
   salidas  = FSalida;
   |HAZ FiltraPuntos;
   #0Campo = eaCuenta;
   |PINTA #0Campo;
|FCAL;

|CALCULO anacta; |TIPO 6;
  salidas = FSalida;
  |HAZ FPuntosAna;
  |SI Campo = 1;
      |SI #0#0 > #0#1;
          |MENAV mensa3;
          |ERROR;
      |FINSI;
  |FINSI;
|FCAL;

|| **********************************************************************
||                       CALCULOS DE IMPRESION
|| **********************************************************************
|PROCESO ver_selec;
 |SI eaCuenta ] #5#2; |Y eaCuenta [ #5#3;
     swsel = 1;
     |ERROR10;
 |FINSI;
|FPRC;

|DEFBUCLE seleccion;
 #5#1;
 ;
 selec, 000;
 selec, 999;
 e;
 NULL, ver_selec;
|FIN;

|PROCESO BorrarRegistro;
 eaCuenta = #18#20;
 |SI selec ! 0;
     swsel = 0;
     |BUCLE seleccion;
     |SI swsel = 0; |ACABA; |FINSI;
 |FINSI;

 |BORRA 020#18a;
 |LIBERA #18;
|FPRC;

|DEFBUCLE any00008B;
 #18#1;
 ;
 #0#2, aDCuenta, incta;
 #0#3, aHCuenta, ficta;
 be;
 NULL, BorrarRegistro;
|FIN;

|| ************************************************************
|PROCESO borrar; |TIPO 3;

   |SI #0#8 ! "SI"; |ACABA; |FINSI;

   incta = #0#0;
   ficta = #0#1;
   selec = #0#4;
   aDCuenta = "            ";
   aHCuenta = "zzzzzzzzzzzz";
   |SI selec = 0; aDCuenta = #0#6; aHCuenta = #0#7; |FINSI;

   |BUCLE any00008B;
|FPRC;
