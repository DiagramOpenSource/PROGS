|FICHEROS;
    cavengin #0;
    cavengli #1;
    cavengca #2;
    caivaasi #12;
|FIN;

|VARIABLES;
    &entrada = 1;
    sw = 0;
    informe = "cavengin";
    men1   = "    NO EXISTE EMPRESA";
    mensa1 = "    ERROR ESTA FECHA NO CORRESPONDE AL EJERCICIO";

    &s_wl = 0;
    &swlin = 0;
    &tpiva = 0;
    &tprec = 0;
    &impbase = 0;
    &impiva  = 0;
    &imprec  = 0;
    &totlin = 0;
    &topecant = 0;
    &timpbase = 0;
    &timpiva  = 0;
    &timprec  = 0;
    &ttotlin = 0;

  totfac = 0;
  sihay = 1;
  num = 0;
  num21 = 0;
  num22 = 0;
  num23 = 0;
  num24 = 0;
  num25 = 0;
|FIN;

|INCLUYE dscont_i;

|PROCESO control; |TIPO 8;
 |HAZ inicio;
 |ABRE #12;
 |DDEFECTO #12;
 |LEE 001#12p;
 topecant = #12#38;     || cantidad tope de facturas englobadas
 |CIERRA #12;
|FPRC;

|PROCESO def_fechas; |TIPO 7;
 #0#0 = fec1; |PINTA #0#0;
 #0#1 = fec2; |PINTA #0#1;
|FPRC;

|PROCESO fecha; |TIPO 0;
  |SI #0Campo < fec1; |O #0Campo > fec2;
      |MENAV "     Fecha ERRONEA ";
      |ERROR;
      |ACABA;
  |FINSI;
  |SI #0Campo = 1;
      |SI #0#1 > #0#0;
          |MENAV "     Fecha ERRONEA ";
          |ERROR;
          |ACABA;
      |FINSI;
  |FINSI;
|FPRC;

|| *************************************************************************
|| **************************   MEOLLO   ***********************************
|| *************************************************************************

|PROCESO lineas;
|SI sw = 0;
    swlin = 1; || cabecera fecha;
    |PRINT;
    sw = 1;
|FINSI;

sihay= 0; s_wl = 0; totlin = 0;
|PARA num = 1; |SI num [ 5; |HACIENDO num = num + 1;
  |HAZ sumanume;
  |SI #1num21 ! 0;   || Existe Importe de Base.
      |SI sihay = 1;
          swlin = 0;
          |PRINT;
          s_wl = 1;
      |FINSI;
      sihay = 1;
      tpiva = #1num22;     || % iva
      tprec = #1num24;     || % rec.
      impbase = #1num21; timpbase = timpbase + impbase;
      impiva  = #1num23; timpiva  = timpiva  + impiva;
      imprec  = #1num25; timprec  = timprec  + imprec;
      totfac  = totfac  + #1num21 + #1num23 + #1num25;
      ttotlin = ttotlin + #1num21 + #1num23 + #1num25;
  |FINSI;
|SIGUE;
   totlin = totfac;
   |SI sihay = 1; swlin = 0; |PRINT; |FINSI;
|FPRC;

|PROCESO hacer;
  sw = 0;
  totfac = 0;
  |BUCLELIN 0lineas#2;
|FPRC;

|DEFBUCLE cavengin0;
#2#1;
1;
#0#0, #0#2;
#0#1, #0#3;
be;
NULL,hacer;
|FIN;

|PROCESO impre; |TIPO 3;
  |IMPRE 0;
  |SI FSalida ! 0;  |ACABA;  |FINSI;
  |INFOR informe;
  |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;
  |BUCLE cavengin0;
  |PIEINF;
  |FININF;
  |FINIMP;
|FPRC;

|| ************************************************************************

|| ..... AUXILIARES
|PROCESO sumanume;
  num21 = num + 3;
  num22 = num21 + 15; || % IVA
  num23 = num21 +  5; || Cuota IVA
  num24 = num21 + 20; || % Recargo
  num25 = num21 + 10; || Cuota Recargo
|FPRC;
