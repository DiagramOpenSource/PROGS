|FICHEROS;
  capcem03 #0;

  cacuenta #3;
  capcem04 #4;

  capcew02 #900,MANTE;

  capcem3@ #999;
|FIN;

|VARIABLES;
  &entrada = 1;

  nInkey    = 0;

  aAlfa1    = "";
  aAlfa2    = "";
  nNume1    = 0;
  nNume2    = 0;
  nPara1    = 0;

  nGraba    = 0;
  nNivel    = 0;

  nModo    = 0;
  cuatro   = "    ";
  aMas     = "";
|FIN;

|INCLUYE dscont_i;

|PROCESO cacuenta;
  #999#0 = #3#0;
  |LEE 141#999=;
  |SI FSalida ! 0;
      #999#0 = #3#0;
      #999#1 = #3#2;
      #999#2 = "PDTE";
      #999#3 = #3#2;
      nGraba = 1;
      |SI #900#2 = "S";
          nGraba = 0;
          |PARA nPara1 = 9; |SI nPara1 [ 53; |HACIENDO nPara1 = nPara1 + 1;
                |SI #3nPara1 ! 0;
                    nGraba = 1;
                    |SAL;
                |FINSI;
          |SIGUE;
      |FINSI;
      |SI nGraba = 1;
          |GRABA 020#999b;
      |FINSI;
  |FINSI;
  |LIBERA #999;
|FPRC;

|DEFBUCLE cacuenta;
  #3#1;
  1;
  #900#0, nNivel;
  #900#1, nNivel;
  ;
  NULL, cacuenta;
|FIN;

|PROCESO CargaAutomatica;

   |PUSHV 0644 1672;

   |PINPA #0#900;
   |PINDA #0#900;

   |ENDATOS #2#900;
   |SI FSalida = 0; |Y #900#3 = "S";

       |DBASE aBase;
       aMas = aBase + "def/capcem03";
       |CARGA_DEF aMas, capcem3@;
       |SI FSalida = 0;
           |ABRE #999;
           |BUCLE cacuenta;
           |CIERRA #999;
       |FINSI;
   |FINSI;

   |POPV;
   |PONCONTROL 23, "SI";
|FPRC;


|PROCESO inf;
 #3#0 = "            ";
 #3#1 = nNivel;
|FPRC;

|PROCESO sup;
 #3#0 = "zzzzzzzzzzzz";
 #3#1 = nNivel;
|FPRC;

|PROCESO inf0;
 #4#0 = "    ";
|FPRC;

|PROCESO sup0;
 #4#0 = "zzzz";
|FPRC;

|PROCESO nivel_11; |TIPO 11;
 nInkey = FSalida;
 |SI nInkey = 10;
     |ABRE #3;
     #3#0 = #0#1;
     |CONSULTA_F_CLAVE #5#3, inf, sup;
     #0#0 = #3#0; |PINTA #0#0;
     |CIERRA #3;
 |FINSI;
 |SI nInkey = 11;
     |HAZ CargaAutomatica;
 |FINSI;
|FPRC;

|PROCESO nivel_a; |TIPO 7;
  aAlfa1 = #0#2; |QBF aAlfa1;
  |SI aAlfa1 = "";
      #0#2 = #0#0; |PINTA #0#2;
  |FINSI;
|FPRC;

|PROCESO nivel_m; |TIPO 0;

   nInkey = FSalida;
   |SI nInkey = 10; |Y Campo = 2;
       |ABRE #4;
       #4#0 = #0#2;
       |CONSULTA_F_CLAVE #1#4, inf0, sup0;
       #0#2 = #4#0; |PINTA #0#2;
       |CIERRA #4;
   |FINSI;

   nModo = (FEntrada / 100) ! 0;
   |SI #0Campo = cuatro;
       |SI nModo = 4; |ACABA; |FINSI;
   |FINSI;

   |SI nInkey = 11; |Y Campo = 2;
       #0#2 = #0#0; |PINTA #0#2;
       #0#3 = #0#1; |PINTA #0#3;
   |FINSI;
   |SI nInkey = 12; |Y Campo = 2;
       #0#2 = "PDTE "; |PINTA #0#2;
   |FINSI;

   aAlfa1 = #0Campo; |QBF aAlfa1;
   aAlfa2 = aAlfa1 % 0;
   nNume1 = aAlfa2;
   |SI nNume1 ! 4;
       |MENAV "    Longitud de Cuenta Erronea";
       |ERROR;
       |ACABA;
   |FINSI;

   |SI Campo = 0;
       |ABRE #3;
       #3#0 = #0#0;
       |LEE 001#3=;
       |SI FSalida ! 0;
           |MENAV "    No existe Cuenta en el Plan Contable Espa¤ol";
           |ERROR;
       |SINO;
           #0#1 = #3#2; |PINTA #0#1;
       |FINSI;
       |CIERRA #3;
   |FINSI;

   |SI Campo = 2
       |ABRE #4
       #4#0  = #0#2;
       |LEE 001#4=;
       |SI FSalida = 0;
           aAlfa1 = #0#3; |QBF aAlfa1;
           |SI aAlfa1 = "";
               #0#3 = #4#1; |PINTA #0#3;
           |FINSI;
       |FINSI;
       |CIERRA #4;
   |FINSI;
|FPRC;

|PROCESO Titulo;
       |SI #0#2 ! "PDTE";
           |ABRE #4
           #4#0  = #0#2;
           |LEE 141#4=;
           |SI FSalida ! 0;
               #4#0 = #0#2;
               |GRABA 020#4b;
           |FINSI;
           #4#1 = #0#3;
           |GRABA 020#4a;
           |LIBERA #4;
           |CIERRA #4;
      |FINSI;
|FPRC;

|| **************************************************************************
|RUTINA min;
  #0#0  = "    ";
|FRUT;

|RUTINA max;
  #0#0 = "zzzz";
|FRUT;

|PROGRAMA;

   |HAZ inicio;
   nNivel = 4;
   |SI dig4 = 4; nNivel = 1; |FINSI;
   |SI dig5 = 4; nNivel = 2; |FINSI;
   |SI dig6 = 4; nNivel = 3; |FINSI;
   |SI dig7 = 4; nNivel = 4; |FINSI;
   |SI dig8 = 4; nNivel = 5; |FINSI;
   |SI dig9 = 4; nNivel = 6; |FINSI;

   |CLS;
   |CABEZA "Tabla Conversion Plan Contable";

   |PINPA #0#0;
   |ENTLINEAL #1#0, -1, 2, 21, 0, min, max;
|FPRO;
