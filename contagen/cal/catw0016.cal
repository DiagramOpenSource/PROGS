|FICHEROS;
     catw0016 #905,MANTE;

     :/contasoc/def/maempr11 #801;
|FIN;

|VARIABLES;
     &aDni      = "";
     &nCampo3   = 0;
     &nSuma6300 = 0;
     aAlfa      = "";
     nTecla     = 0;


     nSuma1  = 0;
     nSuma2  = 0;
     n19     = 0;
     nTope   = 0;
     nPorce2 = 0;

     &enEmpresa = 0;
     &enAnyo    = 0;

     &aPContas  = "";
     &HaySociedad = 0;

     nNume1     = 0;
     nNume2     = 0;
     nNume3     = 0;
|FIN;

|PROCESO Tipo12w11;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     nSuma1 = (#catw0016#1 - #catw0016#2) ! 2;
     nSuma2 = (#catw0016#11 + #catw0016#22 - #catw0016#12 - #catw0016#23) ! 2;
     |SI nSuma1 ! nSuma2;
         |MENAV "0000 Descuadrado. Aumentos - Disminuciones distinto (C7 + E7 - C8 - E8)";
         |ERROR;
         |ACABA;
     |FINSI;

     nSuma1 = (#catw0016#16 + #catw0016#26) ! 2;
     nSuma2 = #catw0016#6 ! 2;
     |SI nSuma1 ! nSuma2;
         |MENAV "0000 Descuadrado. 553 + 554 = 552";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Totalw11;  |TIPO 0;
     |HAZ ElCuadre;
     n19   = 0;

     |SI HaySociedad = 1;
         aAlfa = aPContas + "fich/";

         |PATH_DAT #801 aAlfa;

         |ABRE #maempr11;
         #maempr11#0 = enEmpresa;
         #maempr11#1 = enAnyo;
         #maempr11#2 = 19;
         |LEE 000#maempr11.=;
         |SI FSalida = 0;  n19 = 1;  |FINSI;
         |CIERRA #maempr11;
     |FINSI;

     #catw0016#10 = #catw0016#7  - #catw0016#8  - #catw0016#9  - #catw0016#31;
     #catw0016#21 = #catw0016#17 - #catw0016#18 - #catw0016#19 - #catw0016#32 + #catw0016#20;

     |SI #catw0016#11 = 0; |Y #catw0016#22 = 0;  |Y Campo ! 11;
         #catw0016#11 = #catw0016#1;
     |FINSI;

     |SI #catw0016#12 = 0; |Y #catw0016#23 = 0;  |Y Campo ! 12;
         #catw0016#12 = #catw0016#2;
     |FINSI;

     |SI #catw0016#13 = 0; |Y #catw0016#24 = 0;  |Y Campo ! 13;
         #catw0016#13 = #catw0016#3;
     |FINSI;

     #catw0016#14 = #catw0016#4;

     |SI #catw0016#15 = 0; |Y #catw0016#25 = 0;  |Y Campo ! 15;
         #catw0016#15 = #catw0016#5;
     |FINSI;

     #catw0016#24 = #catw0016#3 - #catw0016#13;
     #catw0016#25 = #catw0016#5 - #catw0016#15;

     #catw0016#16 = #catw0016#10 + #catw0016#11 - #catw0016#12 - #catw0016#13 + #catw0016#14 + #catw0016#15;
     #catw0016#26 = #catw0016#21 + #catw0016#22 - #catw0016#23 - #catw0016#24 + #catw0016#25;

     |SI n19 = 0;
         #catw0016#28 = #catw0016#16 % #catw0016#27;
     |SINO;
         nTope = 120202.41;
         |SI #catw0016#16 [ nTope;
             #catw0016#28 = #catw0016#16 % #catw0016#27;
         |SINO;
                                nPorce2 = 0;
             |SI #catw0016#27 = 20;  nPorce2 = 25;  |FINSI;
             |SI #catw0016#27 = 25;  nPorce2 = 30;  |FINSI;
             |SI #catw0016#27 = 30;  nPorce2 = 30;  |FINSI;

             |SI nPorce2 ! 0;
                 #catw0016#28 = ((nTope % #catw0016#27) + ((#catw0016#16 - nTope) % nPorce2)) ! 2;
             |SINO;
                 #catw0016#28 = #catw0016#16 % #catw0016#27;
             |FINSI;
         |FINSI;
     |FINSI;

     #catw0016#30 = #catw0016#26 % #catw0016#29;

     |PINTA #catw0016#10;
     |PINTA #catw0016#11;
     |PINTA #catw0016#12;
     |PINTA #catw0016#13;
     |PINTA #catw0016#15;
     |PINTA #catw0016#21;
     |PINTA #catw0016#22;
     |PINTA #catw0016#23;
     |PINTA #catw0016#24;
     |PINTA #catw0016#25;
     |PINTA #catw0016#16;
     |PINTA #catw0016#26;
     |PINTA #catw0016#28;
     |PINTA #catw0016#30;
|FPRC;

|PROCESO ElCuadre;
     |C_M #905Campo,0,aAlfa;
     |SI aAlfa = "N"; |ACABA; |FINSI;

     |SI Campo = 7;  |O Campo = 17; nNume1 = 34; nNume2 = 7;  nNume3 = 17; |FINSI;
     |SI Campo = 8;  |O Campo = 18; nNume1 = 35; nNume2 = 8;  nNume3 = 18; |FINSI;
     |SI Campo = 9;  |O Campo = 19; nNume1 = 36; nNume2 = 9;  nNume3 = 19; |FINSI;
     |SI Campo = 31; |O Campo = 32; nNume1 = 37; nNume2 = 31; nNume3 = 32; |FINSI;
     |SI Campo = 20;                nNume1 = 38; nNume2 = -1; nNume3 = 20; |FINSI;
     |SI Campo = 10; |O Campo = 21; nNume1 = 0;  nNume2 = 10; nNume3 = 21; |FINSI;
     |SI Campo = 11; |O Campo = 22; nNume1 = 1;  nNume2 = 11; nNume3 = 22; |FINSI;
     |SI Campo = 12; |O Campo = 23; nNume1 = 2;  nNume2 = 12; nNume3 = 23; |FINSI;
     |SI Campo = 13; |O Campo = 24; nNume1 = 3;  nNume2 = 13; nNume3 = 24; |FINSI;
     |SI Campo = 14;                nNume1 = 4;  nNume2 = 14; nNume3 = -1; |FINSI;
     |SI Campo = 15; |O Campo = 25; nNume1 = 5;  nNume2 = 15; nNume3 = 25; |FINSI;
     |SI Campo = 16; |O Campo = 26; nNume1 = 6;  nNume2 = 16; nNume3 = 26; |FINSI;

     |SI Campo = nNume2;
         |SI nNume3 ! -1;
             #905nNume3 = 0;
             #905nNume3 = #905nNume1 - #905nNume2;
             |PINTA #905nNume3;
         |SINO;
             #905nNume2 = #905nNume1;
             |PINTA #905nNume2;
         |FINSI;
     |FINSI;
     |SI Campo = nNume3;
         |SI nNume2 ! -1;
             #905nNume2 = 0;
             #905nNume2 = #905nNume1 - #905nNume3;
             |PINTA #905nNume2;
         |SINO;
             #905nNume3 = #905nNume1;
             |PINTA #905nNume3;
         |FINSI;
     |FINSI;
|FPRC;
