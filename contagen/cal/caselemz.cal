|FICHEROS;
   caselemz #0;
   canempre #30;
|FIN;

|VARIABLES;
   &r_emp = 0;
   &r_per = 0;
   alfa1 = "";
   alfa2  = "";
   nume1  = 0;
   nume2  = 0;
   nCampo = 0;
|FIN;

|INCLUYE dscont_i;

|| *************************************************************************
||                        CALCULOS DE PANTALLA
|| *************************************************************************
|CALCULO El8Z; |TIPO 8;
     |HAZ inicio;
     |HAZ DirAplicSt;
     |SI Haybasica = 1;         || Existe Acceso;
         || ... Activado Basica
         |MODO_RELACION #0, 0, "agitab04", "X", "X";
         |MODO_RELACION #0, 1, "agitab04", "N", "N";
     |SINO;
         || No existe Basica
         |MODO_RELACION #0, 1, "agitab04", "N", "N";
         |MODO_RELACION #0, 1, "agitab04", "X", "X";
         |C_M #0#48,1,"N"; |C_M #0#49,1,"N";
         |C_M #0#50,1,"N"; |C_M #0#51,1,"N";
         |C_M #0#52,1,"N"; |C_M #0#53,1,"N";
         |C_M #0#54,1,"N"; |C_M #0#55,1,"N";
         |C_M #0#56,1,"N"; |C_M #0#57,1,"N";
         |C_M #0#58,1,"N"; |C_M #0#59,1,"N";
         |C_M #0#47,1,"N";
    |FINSI;
|FCAL;

|CALCULO SelectZ;
   |SI #0#2 = "S";
      |C_M #0#3,1,"S";
      |C_M #0#4,1,"S";
      |PARA nume1 = 5; |SI nume1 [ 24; |HACIENDO nume1 = nume1 + 1;
           |C_M #0nume1,1,"N"; #0nume1 = 0;      |PINTA #0nume1;
           nume2 = nume1 + 20;    #0nume2 = "";  |PINTA #0nume2;
      |SIGUE;
   |SINO;
      |C_M #0#3,1,"N"; #0#3 = 0;  |PINTA #0#3;
      |C_M #0#4,1,"N"; #0#4 = 0;  |PINTA #0#4;
      |PARA nume1 = 5; |SI nume1 [ 24; |HACIENDO nume1 = nume1 + 1;
            |C_M #0nume1,1,"S";
      |SIGUE;
   |FINSI;
|FCAL;

|CALCULO esbuenaZ; || desde campo de empresas seleccion
  |SI FSalida = 9;
      |ERROR;
      |SUB_EJECUTA_NP "caconemp";
      |SI r_emp ! 0;
          #0Campo = r_emp;
          |PINTA #0Campo;
          |PTEC 802;
      |FINSI;
      |ACABA;
  |FINSI;

  |SI #0Campo = 0;
       nume2 = Campo + 20; #0nume2 = ""; |PINTA #0nume2;
       |PARA nCampo = Campo + 1;  |SI nCampo [ 24;  |HACIENDO nCampo = nCampo + 1;
             #0nCampo = 0; |PINTA #0nCampo;
             |C_M #0nCampo, 1, "N";
             nume2 = nCampo + 20;
             #0nume2 = ""; |PINTA #0nume2;
       |SIGUE;
       |ACABA;
  |SINO;
       |PARA nCampo = Campo + 1;  |SI nCampo [ 24;  |HACIENDO nCampo = nCampo + 1;
             |C_M #0nCampo, 1, "S";
       |SIGUE;
  |FINSI;

  |ABRE #30;
  #30#2 = #0Campo;
  #30#3 = 0;
  |LEE 011#30];
  |SI FSalida ! 0;  |O #30#2 ! #0Campo;
      |MENAV "     NO Existe la empresa Contable";
      |ERROR;
  |SINO;
      nume1 = Campo + 20;
      #0nume1 = #30#1;
      |PINTA #0nume1;
  |FINSI;
  |CIERRA #30;
|FCAL;

|CALCULO SelTip0Z;
 |SI Haybasica = 0; |ACABA; |FINSI;

     |SI #0#47 = "N";
         #0#48 = 0;  |PINTA #0#48;  |C_M #0#48, 1, "N";
         #0#49 = 99; |PINTA #0#49;  |C_M #0#49, 1, "N";
         |PARA nCampo = 50;  |SI nCampo [ 59;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |SINO;
         |C_M #0#48, 1, "S";
         |C_M #0#49, 1, "S";
         |PARA nCampo = 50;  |SI nCampo [ 59;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
               #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |FINSI;

|FCAL;

|CALCULO SelTipo1Z;
 |SI Haybasica = 0; |ACABA; |FINSI;
     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 59;  |HACIENDO nCampo = nCampo + 1;
               #0Campo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 59;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FCAL;
|| *************************************************************************
