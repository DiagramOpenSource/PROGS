|FICHEROS;
   cacontra #0;
   camaasil #1;
   caconcic #2;
   caconcil #3;
   cacuenta #10;
|FIN;

|VARIABLES;
   &entrada = 1;
   sw     = 0;
   cuenta = "";
   digito = 0;
   linea  = 0;
   feini = @;
   fefin = @;
|FIN;

|INCLUYE dscont_i;

||**************************** Procesos de Pantalla

|CALCULO cuenta; |TIPO 0;
     eaCuenta = #cacontra#Campo#;
     salidas  = FSalida;
     |HAZ FiltraPuntos;
     #cacontra#Campo# = eaCuenta;
     |PINTA #cacontra#Campo#;
|FCAL;

|CALCULO Tipo7; |TIPO 7;
 #0#5 = fec1; |PINTA #0#5;
 #0#6 = fec2; |PINTA #0#6;
|FCAL;

|CALCULO fechad; |TIPO 0;
  |SI #0#5 < fec1; |O #0#5 > fec2;
      |MENAV "    ERROR! Fecha Fuera de Periodo";
      |ERROR;
  |FINSI;
|FCAL;

|CALCULO fechah; |TIPO 0;
  |SI #0#6 < fec1; |O #0#6 > fec2; |O #0#6 < #0#5;
      |MENAV "    ERROR! Fecha Fuera de Periodo";
      |ERROR;
  |FINSI;
|FCAL;

|| ***********************************************
|PROCESO grabali;
   |ABRE #3;
   linea = linea + 1;
   #caconcil#0 = #camaasil#4;
   eaCuenta = #camaasil#4;
   |HAZ SacaNivel;
   #caconcil#1 = enNivel;
   #caconcil#2 = linea;
   #caconcil#3 = 2;
   #caconcil#4 = #cacontra#2;
   #caconcil#5 = #camaasil#7;
   |SI #camaasil#8 = "D";
      #caconcil#6 = #camaasil#9;
      #caconcil#7 = 0;
   |SINO;
      #caconcil#7 = #camaasil#9;
      #caconcil#6 = 0;
   |FINSI;
   #caconcil#8 = " ";
   |GRABA 040#3n;
   |CIERRA #3;
|FPRC;

|PROCESO linea;
   linea = #caconcil#2;
|FPRC;

|DEFBUCLE mirali;
   #3#1;
   ;
   #1#4, 001;
   #1#4, 999;
   e;
   NULL, linea;
|FIN;

|PROCESO pasalo;
   |SI sw = 0;
      cuenta = #camaasil#4; eaCuenta = cuenta; |HAZ SacaNivel;
      digito = enNivel;
      linea  = 0;
      |BUCLE mirali;
      sw     = 1;
   |FINSI;

   #caconcic#0 = #camaasil#4;
   eaCuenta = #camaasil#4;
   |HAZ SacaNivel;
   #caconcic#1 = enNivel;
   |LIBERA #2;
   |LEE 110#2=;
   |SI FSalida ! 0;
      |DDEFECTO #2;
      #caconcic#0 = #camaasil#4;
      #caconcic#1 = enNivel;
      |HAZ miracuen;
      #caconcic#3 = #cacontra#2;
      |GRABA 020#2n;
      linea = 0;
   |FINSI;

   |SI cuenta ! #camaasil#4;
      cuenta = #camaasil#4; eaCuenta = cuenta; |HAZ SacaNivel;
      digito = enNivel;
      linea  = 0;
      |BUCLE mirali;
   |FINSI;

   |HAZ grabali;
   #camaasil#18 = "û";
   |GRABA 020#1a;
   |LIBERA #1;
|FPRC;

|PROCESO miracuen;
   |ABRE #10;
   #cacuenta#0 = #caconcic#0;
   #cacuenta#1 = #caconcic#1;
   |LEE 040#10=;
   |SI FSalida ! 0; |DDEFECTO #10; |FINSI;
   #caconcic#2 = #cacuenta#2;
   |CIERRA #10;
|FPRC;

|DEFBUCLE camaasil;
   #1#3;
   0, 18;
   #0#0, feini, 000000, 0001, #0#3, " ";
   #0#1, fefin, 999999, 9999, #0#4, " ";
   be;
   NULL, pasalo;
|FIN;

|PROCESO pase; |TIPO 3;
   |ABRE #2;
   feini = #0#5;
   fefin = #0#6;
   |BUCLE camaasil;
   |CIERRA #2;
|FPRC;
