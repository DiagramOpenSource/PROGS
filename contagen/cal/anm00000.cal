|FICHEROS;
   anm00000 #0;
   anm00016 #16,MANTE;
|FIN;

|VARIABLES;
 nNume1 = 0;
 nPara1 = 0;
 error1 = "0000Error. ­ Nivel Incorrecto ! ";
 error2 = "0000Nivel Analitica repetido o valor mas bajo que los anteriores";
 nInkey = 0;
 &eswPro = 0;
 nSwMod  = 0;
 aAlfa1  = "";
|FIN;

|INCLUYE dscont_i;

|PROCESO LosCambio;
 #16#9  = #0#9;
 #16#10 = #0#10;
 #16#14 = #0#13;
 |GRABA 020#16a;
 |LIBERA #16;
|FPRC;

|DEFBUCLE LosCambio;
 #16#1;
 ;
 00001;
 99999;
 be;
 NULL, LosCambio;
|FIN;

|PROGRAMA;
   eswPro = 0;
   nSwMod = 0;
   |CLS;
   |CABEZA "Control Contabilidad";
   |PINPA #0#0;

   |ABRE #0;
   |DDEFECTO #0;
   |LEE 101#0p;
   |SI FSalida ! 0;
       |GRABA 020#0b;
   |FINSI;
   |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      |GRABA 020#0a;
      |SI nSwMod = 1; |Y #0#11 = "E";
          |CONFI "    SCambiar Parametros de Analitica en Todas las Empresas";
          |SI FSalida = 0;
              |BUCLE LosCambio;
          |FINSI;
      |FINSI;
   |FINSI;
   |LIBERA #0;
   |CIERRA #0;
|FPRO;

|| ********************************************************************

|CALCULO SiAnalitica; |TIPO 0;
 |SI #0Campo = "S";
     |CAMPO_MODIFICA #0#2,1,"S";
     |CAMPO_MODIFICA #0#3,1,"S";
     |CAMPO_MODIFICA #0#4,1,"S";
     |CAMPO_MODIFICA #0#5,1,"S";
     |CAMPO_MODIFICA #0#6,1,"S";
     |CAMPO_MODIFICA #0#7,1,"S";
     |CAMPO_MODIFICA #0#8,1,"S";
     |CAMPO_MODIFICA #0#9,1,"S";
     |CAMPO_MODIFICA #0#10,1,"S";
     |CAMPO_MODIFICA #0#11,1,"S";
     |CAMPO_MODIFICA #0#13,1,"S";
     |CAMPO_MODIFICA #0#14,1,"S";
 |SINO;
     eaRefer = #0#8;
     |PDEFECTO #0,2,12; #0#13 = "N"; #0#14 = "N";
     |PARA nPara1 = 2; |SI nPara1 [ 14; |HACIENDO nPara1 = nPara1 + 1;
          |PINTA #0nPara1;
          |CAMPO_MODIFICA #0nPara1,1,"N";
     |SIGUE;
     |CAMPO_MODIFICA #0#8, 1,"S";
     |CAMPO_MODIFICA #0#12,1,"S";
     #0#8 = eaRefer; |PINTA #0#8;
 |FINSI;
|FCAL;

|CALCULO NSRef; |TIPO 0;
  eaRefer = #0#8;
  |C_M #0#12, 1, eaRefer;
  |SI eaRefer = "N"; #0#12 = 20; |PINTA #0#12; |FINSI;
|FCAL;

|CALCULO numnivana; |TIPO 0;
  |SI FSalida = 2; |ACABA; |FINSI;

  |CAMPO_MODIFICA #0#3, 1,"S";
  |CAMPO_MODIFICA #0#4, 1,"S";
  |CAMPO_MODIFICA #0#5, 1,"S";
  |CAMPO_MODIFICA #0#6, 1,"S";
  |CAMPO_MODIFICA #0#7, 1,"S";

  |SI #0#2 < 5;
      |CAMPO_MODIFICA #0#6, 1,"N";
      |CAMPO_MODIFICA #0#7, 1,"N";
      #0#6 = 7;
      #0#7 = 0;
      |SI #0#2 < 4;
          |CAMPO_MODIFICA #0#5, 1,"N";
          |CAMPO_MODIFICA #0#6, 1,"N";
          #0#5 = 7;
          #0#6 = 0;
          |SI #0#2 < 3;
              |CAMPO_MODIFICA #0#4, 1,"N";
              |CAMPO_MODIFICA #0#5, 1,"N";
              #0#4 = 7;
              #0#5 = 0;
              |SI #0#2 < 2;
                  |CAMPO_MODIFICA #0#3, 1, "N";
                  |CAMPO_MODIFICA #0#4, 1, "N";
                  #0#3 = 7;
                  #0#4 = 0;
              |FINSI;
          |FINSI;
      |FINSI;
  |SINO;
      |CAMPO_MODIFICA #0#7, 1, "N";
      #0#7 = 7;
  |FINSI;
  |PINTA #0#3;
  |PINTA #0#4;
  |PINTA #0#5;
  |PINTA #0#6;
  |PINTA #0#7;
|FCAL;

|CALCULO nivelana; |TIPO 0;
  nNume1 = #0#2 + 2;
  |SI Campo ! nNume1; |Y  #0Campo = 7;
      |MENAV error1;
      |ERROR;
      |ACABA;
  |FINSI;
  |SI Campo = nNume1; |Y  #0Campo ! 7;
      |MENAV error1;
      |ERROR;
      |ACABA;
  |FINSI;

  |SI Campo = 4;  |Y #0#4 = 0; |Y #0#2 ] 2;
      |MENAV error2;
      |ERROR;
      |ACABA;
  |FINSI;

  |SI Campo = 5;  |Y #0#5 = 0; |Y #0#2 ] 3;
      |MENAV error2;
      |ERROR;
      |ACABA;
  |FINSI;
  |SI Campo = 6;  |Y #0#6 = 0; |Y #0#2 ] 4;
      |MENAV error2;
      |ERROR;
      |ACABA;
  |FINSI;
  |SI Campo = 7;  |Y #0#7 = 0; |Y #0#2 ] 5;
      |MENAV error2;
      |ERROR;
      |ACABA;
  |FINSI;

  |SI Campo = 4; |Y #0#4 ! 0;    || Si hay dos niveles iguales o menor error
      |SI #0#4 [ #0#3;
          |MENAV error2;
          |ERROR;
          |ACABA;
      |FINSI;
  |FINSI;

  |SI Campo = 5; |Y #0#5 ! 0; || Si hay dos niveles iguales o menor error
      |SI #0#5 [ #0#3; |O #0#5 [ #0#4;
          |MENAV error2;
          |ERROR;
          |ACABA;
      |FINSI;
  |FINSI;

  |SI Campo = 6; |Y #0#6 ! 0; || Si hay dos niveles iguales o menor error
      |SI #0#6 [ #0#3; |O #0#6 [ #0#4; |O #0#6 [ #0#5;
         |MENAV error2;
         |ERROR;
         |ACABA;
      |FINSI;
  |FINSI;

  |SI Campo = 7; |Y #0#7 ! 0; || Si hay dos niveles iguales o menor error
      |SI #0#7 [ #0#3; |O #0#7 [ #0#4; |O #0#7 [ #0#5; |O #0#7 [ #0#6;
          |MENAV error2;
          |ERROR;
          |ACABA;
      |FINSI;
  |FINSI;
|FCAL;
|| ********************************************************************

|CALCULO cuadro; |TIPO 7;
  |PUSHV 1425 1968;
  |CUADRO 1425 1968;
  |ATRI R;
  |PINTA 1526, " -- PEDIR EL CAMPO DE CUENTA ANALITICA -- ";
  |PINTA 1626, " (S) SOLO en apuntes de Cuentas Contables ";
  |PINTA 1726, "     que existen en la tabla de Relacion  ";
  |PINTA 1826, " (N) en TODOS los apuntes.                ";
  |ATRI 0;
|FCAL;

|CALCULO cuadro1; |TIPO 7;
  |PUSHV 1625 2164;
  |CUADRO 1625 2164;
  |ATRI R;
  |PINTA 1726, " -- REPARTO DE GRUPO DE ANALITICA --  ";
  |PINTA 1826, " (S) SIEMPRE fijo, en base al reparto ";
  |PINTA 1926, "     del mantenimiento del Grupo      ";
  |PINTA 2026, " (N) poder modificar en cada apunte   ";
  |ATRI 0;
|FCAL;

|CALCULO cuadro2; |TIPO 7;
  |PUSHV 1525 2064;
  |CUADRO 1525 2064;
  |ATRI R;
  |PINTA 1626, " -- OBLIGACION PARA CUENTAS 6 Y 7 --  ";
  |PINTA 1726, " (S) Introducir SIEMPRE cta Analitica ";
  |PINTA 1826, "     en Apuntes de las Cuentas 6 y 7  ";
  |PINTA 1926, " (N) Opcional, poder dejarla en blanco";
  |ATRI 0;
|FCAL;

|CALCULO cuadro3; |TIPO 7;
  |PUSHV 1825 2364;
  |CUADRO 1825 2364;
  |ATRI R;
  |PINTA 1926, " ACCESO CTAS ANALITICAS POR USUARIOS  ";
  |PINTA 2026, " (S) Limitar el acceso a las cuentas  ";
  |PINTA 2126, "     por Usuarios                     ";
  |PINTA 2226, " (N) Sin limitar                      ";
  |ATRI 0;
|FCAL;

|CALCULO cuadro0; |TIPO 0;
   aAlfa1 = Contenido;
   |SI aAlfa1 ! #0Campo; nSwMod = 1; |FINSI;
   |POPV;
   |PINTA #0Campo;
|FCAL;

|CALCULO inf16;
 #16#0 = 00001;
|FCAL;

|CALCULO sup16;
 #16#0 = 99999;
|FCAL;

|CALCULO ConsAnalic; |TIPO 0;
  nInkey = FSalida;
  |SI #0#11 = "E";
      |SI nInkey = 10; |O Campo = 11;
          |PUSHV 0504 2380;
          |PINPA #0#16;
          |ENTLINEAL #1#16, -1, 2, 21, 0, inf16, sup16;
          |POPV;
      |FINSI;
  |FINSI;
|FCAL;
