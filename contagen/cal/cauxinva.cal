|FICHEROS;
   cauxinva #0;
   cauxinv2 #1;

   canempre #30;
|FIN;

|VARIABLES;
   informe = "cauxinva";
   &doh = "";
   &aux_letra = 0;
   &aux_desc  = "";
   &aux_imp   = 0;
   &variable  = "";
   &cantidad  = 0;
   &canti     = 0;

   num_linea = 0;

   &enNumPag = 0;
   nSwLInv   = 0;
   aParam    = "";
   aFichero  = "";
   &efFecLeg = @;
   &eaDatLeg = "";
   &eaFormato = "";
   &eaUnidadBasico = "";
   &eaUnidadBTmp   = "";
   aAlfa  = "";
|FIN;

|INCLUYE dscont_i;

|PROCESO Legalia;
    cod1 = eaLegEmp;
    cod2 = eaLegPer;
    emEmp = 1;  || Sin mensaje
    |HAZ leelo;
    |SI swerror ! 0;  |ACABA;   |FINSI;

    |DBASE fich_alta;
    |QBF fich_alta;
    fich_alta = fich_alta + "fich/" + eaLegEmp + eaLegPer + "/";
    |PATH_DAT #0 fich_alta;
    |PATH_DAT #1 fich_alta;
    |HAZ impresion;
|FPRC;

|PROGRAMA;
      aParam = PARAMETRO; |QBF aParam;
      |HAZ DirAplicSt;
      |SI aParam = "";
          |CLS;
          |CABEZA "Listado Inventario";
          |PINPA #0#0;
          |ENTLINEAL #1#0 , -1 , 2 , 22 , 1 , pro1 , pro2;
          |AVISO;
          |CONFI "2400NDesea Imprimir el Inventario : ";
          |SI FSalida = 0;
              |CIERRA #0;
              |HAZ impresion;
          |FINSI;
     |SINO;
          nSwLInv = 0; |SI aParam = "L"; nSwLInv = 1; |FINSI;
          |HAZ Legalia;

||          |SI aParam = "PDF";   por ahora solo para excel
||              |HAZ HagoPdf;
||              |ACABA;
||          |FINSI;
||          #0#11 = efFecLeg;
||          #0#23 = eaDatLeg;

     |FINSI;
|FPRO;

|PROCESO pro1;
   #cauxinva#0 = 1;
|FPRC;

|PROCESO pro2;
   #cauxinva#0 = 999999;
|FPRC;

|PROCESO linea11; |TIPO 11;
   |HAZ linea;
|FPRC;

|PROCESO linea;
   |SI FSalida ! 9;  |ACABA;  |FINSI;
   |PUSHV 0815 1845;
   |ATRI N;
   |CUADRO 8 15 18 45;
   |PINTA 0916 ,  "1-LINEA SUBCABECERA          ";
   |PINTA 1016 ,  "2-LINEA NORMAL SIN IMPORTE   ";
   |PINTA 1116 ,  "3-LINEA NORMAL CON IMPORTE   ";
   |PINTA 1216 ,  "4-LINEA EN BLANCO            ";
   |PINTA 1316 ,  "5-LINEA AMORTIZACION         ";
   |PINTA 1416 ,  "6-ROTURA NIVEL GENERAL       ";
   |PINTA 1516 ,  "7-SALTO DE PAGINA            ";
   |PINTA 1616 ,  "8-ROTURA NIVEL CUENTAS       ";
   |PINTA 1716 ,  "9-LINEA CABECERA             ";
   |ATRI 0;
   |PAUSA;
   |POPV;
   |ERROR;
|FPRC;

|PROCESO impr;
   |SI #cauxinva#1 = 0;
      doh = #cauxinva#2;
      |ACABA;
   |FINSI;

   aux_letra = #cauxinva#1;
   aux_desc  = #cauxinva#2;
   aux_imp   = #cauxinva#3;

   |SI #cauxinva#1 = 8; |O #cauxinva#1 = 7;
      |ACABA;
   |FINSI;

   |SI #cauxinva#1 = 6;
      variable  = aux_desc;
      canti     = aux_imp;
      |PIEINF;
      |ACABA;
   |FINSI;

   |PRINT;
|FPRC;

|DEFBUCLE imprime;
   #0#1;
   ;
   0;
   999999;
   e;
   NULL , impr;
|FIN;

|PROCESO impresion;

  |SI aParam ! "PDF";
     |SI aParam ! "";
           |SI nSwLInv = 0;
               Impresora = eaNomImp + "?"+ eaUnidadBTmp + "\tmp1,,,?Inventario";
               |SI enBasImp ! 0;
                   |IMPRE -1;
               |SINO;
                   |IMPRE 0;
               |FINSI;
               |SI FSalida ! 0; |ACABA; |FINSI;
           |FINSI;
      |SINO;
           Impresora = "Crystal Reports";
           |IMPRE 0;
           |SI FSalida ! 0; |ACABA; |FINSI;
      |FINSI;
   |FINSI;

   |SI aParam ! "PDF";
       aAlfa = Impresora;
       aAlfa = aAlfa % 113;
       |SI aAlfa = "CrystalReport";
           informe = "cc" + (informe % 0306);
       |FINSI;

       |INFOR informe;
       |SI FSalida ! 0;
           |MENAV "0000No existe informe";
           |SI nSwLInv = 0; |FINIMP; |FINSI;
           |ACABA;
       |FINSI;
   |FINSI;

   num_linea = 0;
   |ABRE #1;
   |DDEFECTO #1;
   |LEE 001#1=;

   |BUCLE imprime;

   |PIEINF;
   |SI aParam ! "PDF";
       |FININF;
       |SI nSwLInv = 0; |FINIMP; |FINSI;
   |FINSI;
   |CIERRA #1;
|FPRC;
