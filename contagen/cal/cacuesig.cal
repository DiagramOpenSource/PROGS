|FICHEROS;
   cacuesig #0;         || cuentas balance
   caagrupa #1;         || agrupaciones
   caepigra #2;         || epigrafes
   caparbal #3;         || partidas balance
   caparexp #4;         || partidas explotacion
   cacuebal #5;         || para facilitar creacion
|FIN;

|VARIABLES;
   &entrada = 1;
   uno = "";
   text = "";
   xx = 0;
   nn = 0;
   mm = 0;
   blanco = " ";
|FIN;

|INCLUYE dscont_i;

|PROCESO Prim_sig;  |TIPO 8;
   |HAZ inicio;
 ||  |SI enEjercicio ] 2008;
 ||      |MENAV "    Estructuras Plan Contable 1990. No modificables en este Ejercicio";
 ||      |PTEC 807;
 ||  |FINSI;
|FPRC;

|PROCESO bloque;
   uno = #cacuesig#0 % A101;
   |SI uno = "6"; |O uno = "7";
      |SI #cacuesig#Campo# < 1;
         |AVISO;
         |ERROR;
      |FINSI;
      text = "                          ";
      |SI #cacuesig#Campo# = 1;  text = "RESULTADOS EXPLOTACION    "; |FINSI;
      |SI #cacuesig#Campo# = 2;  text = "RESULTADOS FINANCIEROS    "; |FINSI;
      |SI #cacuesig#Campo# = 3;  text = "RESULTADOS EXTRAORDINARIOS"; |FINSI;
      |SI #cacuesig#Campo# = 4;  text = "IMPUESTOS";                  |FINSI;
      |SI Campo = 1;
         |PINTA 1135, text;
      |SINO;
         |PINTA 1735, text;
      |FINSI;
   |SINO;
      |SI #cacuesig#Campo# ! 0;
         |AVISO;
         |ERROR;
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO tipo;
   #cacuesig#Campo# = #cacuesig#Campo# > " ";
   |PINTA #cacuesig#Campo#;
   uno = #cacuesig#0 % A101;
   text  = "      ";
   |SI uno = "6"; |O uno = "7";
      |SI #cacuesig#Campo# ! "D"; |Y #cacuesig#Campo# ! "H";
         |AVISO;
         |ERROR;
      |FINSI;
      |SI #cacuesig#Campo# = "D";  text = "DEBE  "; |FINSI;
      |SI #cacuesig#Campo# = "H";  text = "HABER "; |FINSI;
   |SINO;
      |SI #cacuesig#Campo# ! "A"; |Y #cacuesig#Campo# ! "P";
         |AVISO;
         |ERROR;
      |FINSI;
      |SI #cacuesig#Campo# = "A";  text = "ACTIVO"; |FINSI;
      |SI #cacuesig#Campo# = "P";  text = "PASIVO"; |FINSI;
   |FINSI;
   |SI Campo = 2;
      |PINTA 1235, text;
   |SINO;
      |PINTA 1835, text;
   |FINSI;
|FPRC;

|PROCESO agrupa;
   |ABRE #1;
   nn = Campo - 1;
   #caagrupa#0 = #cacuesig#nn#;
   #caagrupa#1 = #cacuesig#Campo#;
   
   |LEE 001#1=;
   |SI FSalida = 0;
      |SI Campo = 3;
         |PINTA 1335, #caagrupa#2;
      |SINO;
         |PINTA 1935, #caagrupa#2;
      |FINSI;
   |SINO;
      |ERROR;
   |FINSI;
   |CIERRA #1;
|FPRC;

|PROCESO epigra;
   |ABRE #2;
   nn = Campo - 1;
   mm = Campo - 2;
   #caepigra#0 = #cacuesig#mm#;
   #caepigra#1 = #cacuesig#nn#;
   #caepigra#3 = #cacuesig#Campo#;
   |LEE 001#2=;
   |SI FSalida = 0;
      |SI Campo = 4;
         |PINTA 1435, #caepigra#4;
      |SINO;
         |PINTA 2035, #caepigra#4;
      |FINSI;
   |SINO;
      |ERROR;
   |FINSI;
   |CIERRA #2;
|FPRC;

|PROCESO part_Deu;
   uno = #cacuesig#0 % A101;
   |SI uno = "6"; |O uno = "7";
      |ABRE #4;
      #caparexp#0 = #cacuesig#1;
      #caparexp#1 = #cacuesig#2;
      #caparexp#2 = #cacuesig#3;
      #caparexp#4 = #cacuesig#4;
      #caparexp#6 = #cacuesig#5;
      |LEE 001#4=;
      |SI FSalida = 0;
         |PINTA 1535, #caparexp#7;
      |SINO;
         |AVISO;
         |ERROR;
      |FINSI;
      |CIERRA #4;
   |SINO;
      |ABRE #3;
      #caparbal#0 = #cacuesig#2;
      #caparbal#1 = #cacuesig#3;
      #caparbal#3 = #cacuesig#4;
      #caparbal#5 = #cacuesig#5;
      |LEE 001#3=;
      |SI FSalida = 0;
         |PINTA 1535, #caparbal#6;
      |SINO;
         |AVISO;
         |ERROR;
      |FINSI;
      |CIERRA #3;
   |FINSI;
|FPRC;
|PROCESO part_Acr;
   uno = #cacuesig#0 % A101;
   |SI uno = "6"; |O uno = "7";
      |ABRE #4;
      #caparexp#0 = #cacuesig#6;
      #caparexp#1 = #cacuesig#7;
      #caparexp#2 = #cacuesig#8;
      #caparexp#4 = #cacuesig#9;
      #caparexp#6 = #cacuesig#10;
      |LEE 001#4=;
      |SI FSalida = 0;
         |PINTA 2135, #caparexp#7;
      |SINO;
         |AVISO;
         |ERROR;
      |FINSI;
      |CIERRA #4;
   |SINO;
      |ABRE #3;
      #caparbal#0 = #cacuesig#7;
      #caparbal#1 = #cacuesig#8;
      #caparbal#3 = #cacuesig#9;
      #caparbal#5 = #cacuesig#10;
      |LEE 001#3=;
      |SI FSalida = 0;
         |PINTA 2135, #caparbal#6;
      |SINO;
         |AVISO;
         |ERROR;
      |FINSI;
      |CIERRA #3;
   |FINSI;
|FPRC;

|PROCESO deudor;
   text = "                          ";
   |SI #cacuesig#1 = 0;  text = "                          "; |FINSI;
   |SI #cacuesig#1 = 1;  text = "RESULTADOS EXPLOTACION    "; |FINSI;
   |SI #cacuesig#1 = 2;  text = "RESULTADOS FINANCIEROS    "; |FINSI;
   |SI #cacuesig#1 = 3;  text = "RESULTADOS EXTRAORDINARIOS"; |FINSI;
   |SI #cacuesig#1 = 4;  text = "IMPUESTOS                 "; |FINSI;
   |PINTA 1135, text;
   
   text = "      ";
   |SI #cacuesig#2 = "D";  text = "DEBE  "; |FINSI;
   |SI #cacuesig#2 = "H";  text = "HABER "; |FINSI;
   |SI #cacuesig#2 = "A";  text = "ACTIVO"; |FINSI;
   |SI #cacuesig#2 = "P";  text = "PASIVO"; |FINSI;
   |PINTA 1235, text;
   
   |ABRE #1;
   #caagrupa#0 = #cacuesig#2;
   #caagrupa#1 = #cacuesig#3;
   |LEE 001#1=;
   |SI FSalida = 0;
      |PINTA 1335, #caagrupa#2;
   |FINSI;
   |CIERRA #1;
   
   |ABRE #2;
   #caepigra#0 = #cacuesig#2;
   #caepigra#1 = #cacuesig#3;
   #caepigra#3 = #cacuesig#4;
   |LEE 001#2=;
   |SI FSalida = 0;
      |PINTA 1435, #caepigra#4;
   |FINSI;
   |CIERRA #2;
   
   |HAZ part_Deu;
|FPRC;

|PROCESO acreedor;
   text = "                          ";
   |SI #cacuesig#6 = 0;  text = "                          "; |FINSI;
   |SI #cacuesig#6 = 1;  text = "RESULTADOS EXPLOTACION    "; |FINSI;
   |SI #cacuesig#6 = 2;  text = "RESULTADOS FINANCIEROS    "; |FINSI;
   |SI #cacuesig#6 = 3;  text = "RESULTADOS EXTRAORDINARIOS"; |FINSI;
   |SI #cacuesig#6 = 4;  text = "IMPUESTOS                 "; |FINSI;
   |PINTA 1735, text;
   
   text = "      ";
   |SI #cacuesig#7 = "D";  text = "DEBE  "; |FINSI;
   |SI #cacuesig#7 = "H";  text = "HABER "; |FINSI;
   |SI #cacuesig#7 = "A";  text = "ACTIVO"; |FINSI;
   |SI #cacuesig#7 = "P";  text = "PASIVO"; |FINSI;
   |PINTA 1835, text;
   
   |ABRE #1;
   #caagrupa#0 = #cacuesig#7;
   #caagrupa#1 = #cacuesig#8;
   |LEE 001#1=;
   |SI FSalida = 0;
      |PINTA 1935, #caagrupa#2;
   |FINSI;
   |CIERRA #1;
   
   |ABRE #2;
   #caepigra#0 = #cacuesig#7;
   #caepigra#1 = #cacuesig#8;
   #caepigra#3 = #cacuesig#9;
   |LEE 001#2=;
   |SI FSalida = 0;
      |PINTA 2035, #caepigra#4;
   |FINSI;
   |CIERRA #2;
   
   |HAZ part_Acr;
|FPRC;

|PROCESO pintas; |TIPO 13;
   uno = #cacuesig#0 % A101;
   |SI uno [ blanco;
      |ACABA;
   |FINSI;
   |HAZ deudor;
   |HAZ acreedor;
|FPRC;

|| cuando da alta saca lo que existe en Cuentas Balance
|PROCESO ver_bal; |TIPO 0;
   xx = (FEntrada / 100) ! 0;
   |SI xx ! 1; |ACABA; |FINSI;
   |SI #cacuesig#0 = doce;
      |AVISO;
      |ERROR;
      |ACABA;
   |FINSI;
   |ABRET #5;
   #cacuebal#0 = #cacuesig#0;
   |LEE 001#5=;
   |SI FSalida = 0;
      #cacuesig#0 = #cacuebal#0;
      #cacuesig#1 = #cacuebal#1;
      #cacuesig#2 = #cacuebal#2;
      #cacuesig#3 = #cacuebal#3;
      #cacuesig#4 = #cacuebal#4;
      #cacuesig#5 = #cacuebal#5;
      #cacuesig#6 = #cacuebal#1;
      #cacuesig#7 = #cacuebal#2;
      #cacuesig#8 = #cacuebal#3;
      #cacuesig#9 = #cacuebal#4;
      #cacuesig#10= #cacuebal#5;
      |PINDA #0#0;
      |HAZ deudor;
      |HAZ acreedor;
   |FINSI;
   |CIERRAT #5;
|FPRC;
