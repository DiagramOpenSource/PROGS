|INCLUYE dscont_i;
|FICHEROS;
   camaylin #0;
   camaycab #1;
   cafantas #2;
   :/modelos/def/dsmom030 #3;
   cacuenta #4;
|FIN;

|VARIABLES;
   &entrada = 1;
   saldo = 0;
   men2  = "     Longitud de Cuenta Fuera de Nivel !";
   cont = 0;
   long = "  ";
   cta  = 0;
   num   = 0;
   sw = 0;
   ctanum = 0;
   ctaalf = "";
   longnum = "";
   vacio = "            ";
   ini = 0;
   fecalf = "";
   mes = "";
   mesfec = 0;
   mesac = 0;
   a = 0;
   b = 0;
   c = 0;
   cuant = "";
   diant = 0;
   coant = 0;
   deant = "";
   dhant = "";
   imant = 0;
   trant = "";
   drant = 0;
   fiac = "  ";
   guarda = "  ";
   relleno = "                                       ";
   aponer = "  ";
   auto = 0;
   opera = "";
   nada = "";
   nada1 = 0;
|FIN;



|PROCESO deha;
   |SI #camaylin#Campo# = "0";  |O #camaylin#Campo# = "d";
      #camaylin#Campo# = "D";
   |FINSI;
   |SI #camaylin#Campo# = "1";  |O #camaylin#Campo# = "h";
      #camaylin#Campo# = "H";
   |FINSI;
   |PINTA #camaylin#Campo#;
|FPRC;

|PROCESO refresca; |TIPO 2;
   |SI #camaylin#8 = "D";
      #camaycab#4 = #camaycab#4 +. #0#9;
   |SINO;
      #camaycab#5 = #camaycab#5 +. #0#9;
   |FINSI;
   #cafantas#0 = #camaycab#4 -#camaycab#5;
   |PINTA #camaycab#4;
   |PINTA #camaycab#5;
   |PINTA 0967, #cafantas#0;
   |ABRE #4;
   #cacuenta#0 = #camaylin#4;
   #cacuenta#1 = #camaylin#5;
   |LEE 101#4=;
   |CIERRA #4;
|FPRC;

|PROCESO nocero;
   |SI #camaylin#Campo# = 0;
      |ERROR;
      |ACABA;
   |FINSI;
|FPRC;

|PROCESO concepto;
   |ABRE #3;
   #dsmom030#0 = #camaylin#6;
   |LEE 040#3=;
   |SI FEntrada = 101;
      |SI #camaylin#6 = coant; |Y #camaycab#4 ! #camaycab#5;
         #camaylin#7 = deant;
      |SINO;
         #camaylin#7 = #dsmom030#1;
      |FINSI;
   |SINO;
      |SI #camaylin#6 = coant;
         #camaylin#7 = deant;
      |SINO;
         #camaylin#7 = #dsmom030#1;
      |FINSI;
   |FINSI;
   |PINTA #camaylin#7;
   |CIERRA #3;
|FPRC;

|PROCESO cuefin;
   |ABRE #4;
   #cacuenta#0 = #camaylin#4;
   #cacuenta#1 = #camaylin#5;
   |LEE 040#4=;
   |SI FSalida ! 0;
      |CIERRA #4;
      |ERROR;
      |ACABA;
   |FINSI;
   |CIERRA #4;
   |PINTA 0739, #cacuenta#2;
|FPRC;

|PROCESO cuenta;|TIPO 6;
     eaCuenta = #camaylin#Campo#;
     salidas  = FSalida;
     |HAZ FiltraPuntos;
     #camaylin#Campo# = eaCuenta;
     |PINTA #camaylin#Campo#;

   cta  = #camaylin#4;
   nada = #camaylin#4 % A101;
   |SI nada ! "0";
      long = cta % A0;
   |SINO;
      long = cta % A0;
      nada1 = long;
      nada1 = nada1 + 1;
      long = nada1;
   |FINSI;
   cont = 0;
   sw = 0;
   |SI long = dig4; sw = 1; #camaylin#5 = 1; |FINSI;
   |SI long = dig5; sw = 1; #camaylin#5 = 2; |FINSI;
   |SI long = dig6; sw = 1; #camaylin#5 = 3; |FINSI;
   |SI long = dig7; sw = 1; #camaylin#5 = 4; |FINSI;
   |SI long = dig8; sw = 1; #camaylin#5 = 5; |FINSI;
   |SI long = dig9; sw = 1; #camaylin#5 = 6; |FINSI;
   |SI sw = 0;
      |MENAV men2;
      |ERROR;
      |ACABA;
   |FINSI;
|FPRC;

|PROCESO contra;
   |SI FSalida = 9;
      auto = 1;
   |SINO;
      auto = 0;
   |FINSI;
   cta  = #camaylin#10;
   long = cta % A0;
   cont = 0;
   sw = 0;
   |SI long = dig4; sw = 1; #camaylin#11 = 1; |FINSI;
   |SI long = dig5; sw = 1; #camaylin#11 = 2; |FINSI;
   |SI long = dig6; sw = 1; #camaylin#11 = 3; |FINSI;
   |SI long = dig7; sw = 1; #camaylin#11 = 4; |FINSI;
   |SI long = dig8; sw = 1; #camaylin#11 = 5; |FINSI;
   |SI long = dig9; sw = 1; #camaylin#11 = 6; |FINSI;
   |SI sw = 0;
      #camaylin#11 = 9;
   |FINSI;
   |ET fincontra;
   |ABRE #4;
   #cacuenta#0 = #camaylin#10;
   #cacuenta#1 = #camaylin#11;
   |LEE 040#4= ;
   |SI FSalida ! 0; |O #cacuenta#3 = "N";
      #camaylin#11 = 9;
   |FINSI;
   |CIERRA #4;
|FPRC;


|PROCESO saalta;
   |SI FEntrada = 101; |Y #camaylin#3 ! 1;
      #camaylin#4 = cuant;
      #camaylin#5 = diant;
      #camaylin#6 = coant;
      #camaylin#7 = deant;
      #camaylin#8 = dhant;
      #camaylin#9 = imant;
      #camaylin#10 = trant;
      #camaylin#11 = drant;
      |PINTA #camaylin#4;
      |PINTA #camaylin#6;
      |PINTA #camaylin#7;
      |PINTA #camaylin#8;
      |PINTA #camaylin#9;
      |PINTA #camaylin#10;
   |FINSI;
|FPRC;


|PROCESO guarda; |TIPO 3;
   cuant = #camaylin#4;
   diant = #camaylin#5;
   coant = #camaylin#6;
   deant = #camaylin#7;
   dhant = #camaylin#8;
   imant = #camaylin#9;
   trant = #camaylin#10;
   drant = #camaylin#11;
   |SI auto = 1; |Y #camaylin#11 ! 9;
      |GRABA 040#0n;
      #camaylin#3 = #camaylin#3 + 1;
      #camaylin#4 = trant;
      #camaylin#5 = drant;
      #camaylin#6 = coant;
      #camaylin#7 = deant;
      saldo = #camaycab#4 - #camaycab#5;
      |SI dhant = "D";
         saldo = saldo + imant;
      |SINO;
         saldo = saldo - imant;
      |FINSI;
      |SI saldo = 0;
         |VETE nograbo;
      |FINSI;
      |SI saldo < 0;
         #camaylin#8 = "D";
         #camaylin#9 = - saldo;
      |SINO;
         #camaylin#8 = "H";
         #camaylin#9 = saldo;
      |FINSI;
      #camaylin#10 = cuant;
      #camaylin#11 = diant;
      |GRABA 021#0n;
      |HAZ refresca;
      |ET nograbo;
      #camaylin#4 = cuant;
      #camaylin#5 = diant;
      #camaylin#6 = coant;
      #camaylin#7 = deant;
      #camaylin#8 = dhant;
      #camaylin#9 = imant;
      #camaylin#10 = trant;
      #camaylin#11 = drant;
      aponer = Akksi;
      |HAZ poncontr;
      Pos = -1;
   |FINSI;
|FPRC;

|PROCESO poncontr;
   fiac = Control % A109;
   fiac = fiac + relleno;
   guarda = fiac % A109;
   fiac = Control % A1001;
   Control = Control + fiac;
   Control = Control + relleno;
   Control = Control % A120;
   Control = Control + aponer;
|FPRC;


|PROCESO descripc;
   |SI FSalida = 9;
      #camaylin#7 = deant;
      |PINTA #camaylin#7;
   |FINSI;
|FPRC;
