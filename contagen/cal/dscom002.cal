|FICHEROS;
   dscom002 #0;
|FIN;

|VARIABLES;
   nCalc    = 0;
   nCont    = 0;
   nNumChar = 0;
   nPos     = 0;

   aAlfa  = "";
   aAlfa1 = "";
   aAlfa2 = "";
|FIN;

|PROCESO Encripta;
   |QBF aAlfa; aAlfa2 = "";
   aAlfa1 = aAlfa % 0; nNumChar = aAlfa1;
   |PARA nCont = 1; |SI nCont [ nNumChar; |HACIENDO nCont = nCont + 1;
      nCalc = (nCont * 100) + 1; aAlfa1 = aAlfa % nCalc;
      nCalc = &aAlfa1;
      |SI nCalc > 79;
         nCalc = 79 - (nCalc - 79);
      |SINO;
         nCalc = 79 + (79 - nCalc);
      |FINSI;
      aAlfa2 = aAlfa2 + &nCalc;
   |SIGUE;
   aAlfa = aAlfa2;
|FPRC;

|PROCESO MiraCuentas;
   |SI #dscom002#1 = "N";
      #dscom002#2 = ""; |C_M #dscom002#2, 1, "N";
      #dscom002#3 = ""; |C_M #dscom002#3, 1, "N";
      #dscom002#4 = ""; |C_M #dscom002#4, 1, "N";
      #dscom002#5 = ""; |C_M #dscom002#5, 1, "N";
      #dscom002#6 = ""; |C_M #dscom002#6, 1, "N";
   |SINO;
      |C_M #dscom002#2, 1, "S"; |C_M #dscom002#3, 1, "S";
      |C_M #dscom002#4, 1, "S"; |C_M #dscom002#5, 1, "S";
      |C_M #dscom002#6, 1, "S";
   |FINSI;
|FPRC;

|PROCESO MiraAuth;
   |SI #dscom002#11 = "N";
      #dscom002#12 = ""; |C_M #dscom002#12, 1, "N";
      #dscom002#13 = ""; #dscom002#14 = "";
   |SINO;
      |C_M #dscom002#12, 1, "S";
   |FINSI;
|FPRC;

|PROCESO PideClave;
   |SI #dscom002#11 = "N"; |ACABA; |FINSI;

   aAlfa = #dscom002#14; |HAZ Encripta;
   |C_P #dscom002#13,0,nPos;

   E_sup = 20;
   E_inf = "";
   aAlfa = nPos ? -1;

   aAlfa1 = aAlfa; |QBF aAlfa1;
   aAlfa1 = aAlfa1 % 0; nCalc = aAlfa1;
   aAlfa1 = "*" * nCalc;
   #dscom002#13 = aAlfa1; |PINTA #dscom002#13;
   |HAZ Encripta; #dscom002#14 = aAlfa;
|FPRC;

|PROGRAMA;
   |ABRE #dscom002;
   |LEE 101#dscom002.p;
   |SI FSalida ! 0;
      |DDEFECTO #dscom002;
      |GRABA 020#dscom002.b;
   |FINSI;

   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      |GRABA 020#dscom002.a;
   |FINSI;

   |LIBERA #dscom002; |CIERRA #dscom002;
|FPRO;
