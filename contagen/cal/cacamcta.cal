|FICHEROS;
   cacamcta #0;    || pantalla

   cacuebal #5;    || cuentas de balance

   camaasic #25;   || apuntes cabs.
   camaasil #26;   || apuntes lins.
   camaniva #28;   || Mantenimiento Iva/IRPF
   caivalin #29;   || Lineas mantenimiento iva/irpf
   cainliva #31;   || Introduccion facturas (LINEAS)

   caivaasi #64;   || Ctrl Entrada IVA asientos.
   cagruiva #70;    || Grupos de IVA Englobadas

   cacuenta #69;   || plan contable                 ---> puntos_i
   caclipro #71;   || Clientes Proveedores GENERAL
   cacuepre #39;   || cuentas presupuestarias
   caexistc #43;   || descarga existencias cabs.
   caexistl #44;   || descarga existencias lins.

   caconcic #38;   || diferencias cabs.
   caconcil #45;   || diferencias lineas.

   camoauxc #40;   || cuentas inventario
   camoauxl #52;   || cuentas inventario
   capasven #51;   || asiento ventas automaticas.
   camaylin #46;   || lineas mayor
   calicont #67;   || Contrapartidas Apuntes
   caliconb #68;   || Contrapartidas Bloques

   casieali #21;   || asientos predefinidos lins.
   camautol #72;   || Asientos Automaticos
   camauto1 #73;   || Asientos Automaticos Especial

   catalm01 #74;   || Vencimientos
   cafinanc #75;   || Operaciones financieras
   caw00017 #76;   || Asientos de Facturas
   cadeflab #77;   || defectos de entrada Laboral
   cadefxab #177;  || defectos de entrada Laboral
   cadeflac #78;   || defectos entrada lab. por centros
   cadeflal #79;   || defectos entrada lab. lineas
   cadefxal #179;  || defectos entrada lab. lineas
   caplalab #80;   || Entrada Laboral
   caconvec #81;   || ventas al contado
   cadeflax #82;
   cadeflay #83;
   cadeflaz #84;

   ca8m0003 #403;
   ca8m0004 #404;
   ca8cumay #410;
   ca8m0002 #422;
   n43saldo #504;

   :/modelos/def/dsmom040 #140;
   :/modelos/def/dsmom041 #141;
   :/modelos/def/dsmom044 #144;
   :/modelos/def/dsmom045 #145;

|FIN;


|VARIABLES;
   nSw      = 0;
   aAlfa    = "";
   aAlfa1   = "";
   nPara1   = 0;
   nNume1   = 0;
   alfa1    = "";
   alfa2    = "";
   alfa3    = "";
   nume1    = 0;
   nume2    = 0;
   nume3    = 0;
   nume4    = 0;
   para1    = 0;
   para2    = 0;
   para3    = 0;
   para4    = 0;

   mens     = "";
   cuenta   = "";
   fini     = @;
   ffin     = @;
   nDdia    = 0;
   nHdia    = 0;
   nDdoc    = 0;
   nHdoc    = 0;
   nDcon    = 0;
   nHcon    = 0;
   traba    = "";
   x        = 0;
   mascara  = "";
   sw_ya0   = 0;
   sw_ya    = 0;
   sw_baja  = 0;
   clipro   = 0;
   {53}cant = 0;
   cta      = 0;
   sw       = 0;
   nEjer    = 0;
   nCompara = 0;
   nSwTipo  = 0;

   &pathbal = "";
   &balance = 1;
   &swTabla = 0;
   &aCampo0 = "";
   &nCampo1 = 0;
   &aCampo2 = "";
   &aCampo3 = "";
   &nCampo4 = 0;
   &aCampo5 = "";
   &aCampo6 = "";
   &aCampo9  = "";
   &nCampo10 = 0;
   &nCampo11 = 0;
   &fCampo12 = @;
   &fCampo13 = @;
   &nCampo14 = 0;
   &nCampo15 = 0;
   &nCampo16 = 0;
   &nCampo17 = 0;
|FIN;

|INCLUYE dscont_i;
|INCLUYE defect_i;
____________________________________/ CALCULOS DE PANTALLA

|PROCESO Defectos; |TIPO 7;
    #0#12 = fec1; |PINTA #0#12;
    #0#13 = fec2; |PINTA #0#13;
|FPRC;

|PROCESO cuenta; |TIPO 6;
     |SI FSalida = 2; |ACABA; |FINSI;

     eaCuenta = #0Campo;
     salidas  = FSalida;
     |HAZ FiltraPuntos;
     #0Campo = eaCuenta;
     |PINTA #0Campo;

     |SI #0Campo = doce; |ERROR; |ACABA; |FINSI;

     x = Campo + 1;
     emCta = 1; |SI Campo = 0; emCta = 0; |FINSI;
     eaCuenta = #0Campo;
     |HAZ SacaNivel;
     |SI eswCta = 1;
         |SI Campo = 0;
             |CONFI "    SLONGITUD DE CUENTA FUERA DE NIVEL! Continuar S/N";
             |SI FSalida ! 0;
                 |ERROR;
                 |ACABA;
             |FINSI;
         |SINO;
             |ACABA;
         |FINSI;
     |FINSI;
     emCta = 0;
     #0x = enNivel;

     |SI Campo = 0; sw_ya0 = 0; |FINSI;
     |SI Campo = 3; sw_ya  = 0; |FINSI;
     |ABRE #69;
     #cacuenta#0 = #0Campo;
     |LEE 001#69=;
     |SI Campo = 0;
         |SI FSalida ! 0;
             sw_ya0 = 1;
             |CONFI "    NNo existe la Cuenta ... Continuar S/N";
             |SI FSalida ! 0;
                 sw_ya0 = 0;
                 |ERROR;
             |FINSI;
         |FINSI;
     |SINO;
          sw_ya = 0;
          |SI FSalida = 0;
              sw_ya = 1;
              |CONFI "0000NLa cuenta Ya existe. ¨Aceptarla S/N? ";
              |SI FSalida ! 0;
                  |ERROR;
              |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #69;
|FPRC;

|PROCESO cuefin; |TIPO 0;
   x = Campo + 2;
   |SI Campo = 3; |Y sw_ya  = 0; |ACABA; |FINSI;
   |SI Campo = 0; |Y sw_ya0 = 1; |ACABA; |FINSI;

   |SI #cacuenta#3 = "N";|Y FSalida = 0;
      |MENAV "    Cuenta sin Pase Directo ...";
      |ERROR;
      |ACABA;
   |FINSI;
   #0x = #cacuenta#2;
   |PINTA #0x;
|FPRC;

|PROCESO desant; |TIPO 7;
   |C_M #0#5,1,"N";
   |SI sw_ya = 0;
       #0#5 = #0#2; |PINTA #0#5;
       |SI sw_ya0 = 1;
           |C_M #0#5,1,"S";
       |FINSI;
   |FINSI;
|FPRC;

|PROCESO Seleccion;
  aAlfa1 = #0#9;
  |C_M #0#10, 1, aAlfa1; |C_M #0#11, 1, aAlfa1;
  |C_M #0#12, 1, aAlfa1; |C_M #0#13, 1, aAlfa1;
  |C_M #0#14, 1, aAlfa1; |C_M #0#15, 1, aAlfa1;
  |C_M #0#16, 1, aAlfa1; |C_M #0#17, 1, aAlfa1;
  |SI aAlfa1 = "N";
      #0#10 = 00; |PINTA #0#10;
      #0#11 = 99; |PINTA #0#11;
      #0#12 = fec1; |PINTA #0#12;
      #0#13 = fec2; |PINTA #0#13;
      #0#14 = 000001; |PINTA #0#14;
      #0#15 = 999999; |PINTA #0#15;
      #0#16 = 001; |PINTA #0#16;
      #0#17 = 999; |PINTA #0#17;
      |C_M #0#6, 1, "S";
 |SINO;
      |C_M #0#6, 1, "N";
      #0#6 = "N"; |PINTA #0#6
 |FINSI;
|FPRC;

______________________________/ CAMBIO DE CUENTAS

|PROCESO defectos;
|| la 3a clave esta formada por la cta + zzzz y el campo fantasma del nivel;
   mascara = #cacuenta#0;
   |QBF mascara;
   mascara = mascara +"zzzzzzzzzzzz";
   mascara = mascara % 112;
   #cacuenta#54    = mascara;
   eaCuenta = #cacuenta#0;
   |HAZ SacaNivel;
   #cacuenta#1  = enNivel;
   #cacuenta#55 = #cacuenta#1;

   |SI enNivel = dig3; #cacuenta#3 = "S"; |FINSI;

   nMensa  = 1;
   nMensa9 = 1;
   |HAZ defect;
|FPRC;

|PROCESO lee_clipro; || leer los datos del nuevo cliente o proveedor.

   |ABRE #71;
   clipro = 0;
   #caclipro#10 = #0#3; eaCuenta = #0#3; |HAZ SacaNivel;
   #caclipro#11 = enNivel;
   traba = #caclipro#10 % 102;
   |SI traba = "43"; |O traba = "44";
      #caclipro#23 = "C";
   |SINO;
      #caclipro#23 = "P";
   |FINSI;
   alfa2 = #caclipro#23;

   |LEE 000#71=;
   |SI FSalida ! 0;  |DDEFECTO #71; clipro = 1; |FINSI;
   |CIERRA #71;
|FPRC;
|| ************************************************************************

|PROCESO n43saldo;
   mens = " Cambio de Auxiliar Ctas Banco norma 43 " + #n43saldo#0;   #0#7 = mens;   |PINTA #0#7;
   |SI #0#0 = #504#6;
       #504#6 = #0#3;
       #504#7 = #0#4;
       #504#1 = #0#5;
       |GRABA 020#504a;
   |FINSI;
   |LIBERA #504;
|FPRC;

|DEFBUCLE n43saldo;
   #504#1;
   ;
   001;
   999;
   be;
   NULL, n43saldo;
|FIN;

|PROCESO ca8m0004;
   mens = " Cambio de Asiento Apertura" + #ca8m0004#0;   #0#7 = mens;   |PINTA #0#7;
   |SI #0#0 = #404#8;
       #404#8 = #0#3;
       #404#9 = #0#4;
       #404#14 = "*";
       |GRABA 020#404a;
   |FINSI;
   |LIBERA #404;
|FPRC;

|DEFBUCLE ca8m0004;
   #404#1;
   ;
   nDdia, fini, nDdoc, 0001;
   nHdia, ffin, nHdoc, 9999;
   be;
   NULL, ca8m0004;
|FIN;

|PROCESO ca8m0003;
   mens = " Cambio de Tabla Equivalencias " + #ca8m0003#0;   #0#7 = mens;   |PINTA #0#7;
   |SI #0#0 = #ca8m0003#2;
       #403#4 = #403#2;
       #403#5 = #403#3;
       #403#2 = #0#3;
       #403#3 = #0#5;
       #403#6 = "*";
       |GRABA 020#403a;
   |FINSI;
   |LIBERA #403;
|FPRC;

|DEFBUCLE ca8m0003;
   #403#1;
   ;
   "            ";
   "zzzzzzzzzzzz";
   be;
   NULL, ca8m0003;
|FIN;
|| ***************************************************
____________________________________/ dsmom045
|PROCESO dsmom0451;

   |SI #0#9 = "S";
       |SI #dsmom045#12 < nDdia; |O #dsmom045#12> nHdia; |ACABA; |FINSI;
       |SI #dsmom045#13 < fini;  |O #dsmom045#13> ffin;  |ACABA; |FINSI;
       |SI #dsmom045#14 < nDdoc; |O #dsmom045#14> nHdoc; |ACABA; |FINSI;
   |FINSI;

   mens = " Historico Amortizacion> " + #dsmom045#2;   #0#7 = mens; |PINTA #0#7;

   nSw = 0;
   |SI #0#0 = #dsmom045#5;
       #dsmom045#5 = #0#3;
       #dsmom045#6 = #0#7;
       nSw = 1;
   |FINSI;
   |SI #0#0 = #dsmom045#9;
       #dsmom045#9 = #0#3;
       nSw = 1;
   |FINSI;

   |SI nSw = 1; |GRABA 020#145a; |FINSI;
   |LIBERA #145;
|FPRC;

|DEFBUCLE dsmom045;
   #145#1;
   ;
   enEmpresa,"        ",00;
   enEmpresa,"zzzzzzzz",99;
   be;
   NULL, dsmom0451;
|FIN;


____________________________________/ dsmom044
|PROCESO dsmom0441;
   |SI #0#9 = "S";
       |SI #dsmom044#12 < nDdia; |O #dsmom044#12> nHdia; |ACABA; |FINSI;
       |SI #dsmom044#13 < fini;  |O #dsmom044#13> ffin;  |ACABA; |FINSI;
       |SI #dsmom044#14 < nDdoc; |O #dsmom044#14> nHdoc; |ACABA; |FINSI;
   |FINSI;

   mens = " Historico Amortizacion> " + #dsmom044#2;   #0#7 = mens; |PINTA #0#7;

   nSw = 0;
   |SI #0#0 = #dsmom044#5;
       #dsmom044#5 = #0#3;
       #dsmom044#6 = #0#7;
       nSw = 1;
   |FINSI;
   |SI #0#0 = #dsmom044#9;
       #dsmom044#9 = #0#3;
       nSw = 1;
   |FINSI;

   |SI nSw = 1; |GRABA 020#144a; |FINSI;
   |LIBERA #144;
|FPRC;

|DEFBUCLE dsmom044;
   #144#1;
   ;
   enEmpresa,"        ",00;
   enEmpresa,"zzzzzzzz",99;
   be;
   NULL, dsmom0441;
|FIN;
____________________________________/ dsmom040
|PROCESO dsmom0401;
   mens = " Grupos Amortizacion> " + #dsmom040#2;   #0#7 = mens; |PINTA #0#7;

   nSw = 0;
   |SI enEjercicio < 2008;
       |SI #0#0 = #dsmom040#3;
           #dsmom040#3 = #0#3;
           #dsmom040#4 = #0#4;
           nSw = 1;
       |FINSI;
       |SI #0#0 = #dsmom040#5;
           #dsmom040#5 = #0#3;
           #dsmom040#6 = #0#4;
           nSw = 1;
       |FINSI;
   |SINO;
       |SI #0#0 = #dsmom040#10;
           #dsmom040#10 = #0#3;
           #dsmom040#11 = #0#4;
           nSw = 1;
       |FINSI;
       |SI #0#0 = #dsmom040#12;
           #dsmom040#12 = #0#3;
           #dsmom040#13 = #0#4;
           nSw = 1;
       |FINSI;
   |FINSI;
   |SI nSw = 1; |GRABA 020#140a; |FINSI;
   |LIBERA #140;
|FPRC;

|DEFBUCLE dsmom040;
   #140#1;
   ;
   enEmpresa,0;
   enEmpresa,9999;
   be;
   NULL, dsmom0401;
|FIN;

____________________________________/ dsmom041
|PROCESO dsmom0411;
   mens = " Elementos Amortizacion> " + #dsmom041#2;   #0#7 = mens;   |PINTA #0#7;
   aAlfa1  = #dsmom041#27; aAlfa1 = aAlfa1 % -104;
   nEjer    = aAlfa1;
   nCompara = 0;
   |SI enEjercicio < 2008; |Y nEjer < 2008;
       nCompara = 1;
   |FINSI;
   |SI nEjer = enEjercicio;
       nCompara = 1;
   |FINSI;
   |SI nCompara = 1;
       |SI #0#0 = #dsmom041#5;
           #dsmom041#5 = #0#3;
           #dsmom041#6 = #0#4;
           |GRABA 020#141a;
       |FINSI;
   |FINSI;
   |LIBERA #141;
|FPRC;

|DEFBUCLE dsmom041;
   #141#1;
   ;
   enEmpresa,"        ",00;
   enEmpresa,"zzzzzzzz",99;
   be;
   NULL, dsmom0411;
|FIN;
____________________________________/ caconvec
|PROCESO caconvec;

   mens = " Ventas Contado -> " + #caconvec#0; #0#7 = mens; |PINTA #0#7;

   |SI #caconvec#2  = #0#0;
       #caconvec#2  = #0#3;
       |GRABA 020#81a;
   |FINSI;
   |LIBERA #81;
|FPRC;

|DEFBUCLE caconvec;
   #81#1;
   ;
   "  ";
   "zz";
   be;
   NULL, caconvec;
|FIN;

____________________________________/ caw00017;
|PROCESO caw00017;

   mens = " Otros apuntes en IVA -> " + #caw00017#1; #0#7 = mens; |PINTA #0#7;

   nSw = 0;
   |SI #caw00017#4  = #0#0; #caw00017#4  = #0#3; #caw00017#5  = #0#4; nSw = 1; |FINSI;
   |SI #caw00017#10 = #0#0; #caw00017#10 = #0#3; #caw00017#11 = #0#4; nSw = 1; |FINSI;
   |SI #caw00017#16 = #0#0; #caw00017#16 = #0#3; #caw00017#17 = #0#4; nSw = 1; |FINSI;

   |SI nSw = 1;
      |GRABA 020#76a;
   |FINSI;
   |LIBERA #76;
|FPRC;

|DEFBUCLE caw00017;
   #76#1;
   6;
   nDdia, fini, nDdoc, 0001, nDcon;
   nHdia, ffin, nHdoc, 9999, nHcon;
   be;
   NULL, caw00017;
|FIN;

____________________________________/ cafinanc
|PROCESO cafinanc1;

   mens = " Operaciones Financieras -> " + #cafinanc#1; #0#7 = mens; |PINTA #0#7;

   nSw = 0;
   |SI #cafinanc#7  = #0#0; #cafinanc#7  = #0#3; #cafinanc#12 = #0#5; nSw = 1; |FINSI;
   |SI #cafinanc#8  = #0#0; #cafinanc#8  = #0#3; #cafinanc#13 = #0#5; nSw = 1; |FINSI;
   |SI #cafinanc#9  = #0#0; #cafinanc#9  = #0#3; #cafinanc#14 = #0#5; nSw = 1; |FINSI;
   |SI #cafinanc#10 = #0#0; #cafinanc#10 = #0#3; #cafinanc#15 = #0#5; nSw = 1; |FINSI;
   |SI #cafinanc#11 = #0#0; #cafinanc#11 = #0#3; #cafinanc#16 = #0#5; nSw = 1; |FINSI;
   |SI #cafinanc#35 = #0#0; #cafinanc#35 = #0#3; #cafinanc#36 = #0#5; nSw = 1; |FINSI;
   |SI #cafinanc#41 = #0#0; #cafinanc#41 = #0#3; #cafinanc#42 = #0#5; nSw = 1; |FINSI;

   |SI nSw = 1;
      |GRABA 020#75a;
   |FINSI;
   |LIBERA #75;
|FPRC;

|DEFBUCLE cafinanc;
   #75#1;
   ;
   enEmpresa, 00001;
   enEmpresa, 99999;
   be;
   NULL, cafinanc1;
|FIN;
____________________________________/ catalm01
|PROCESO catalm01;

   |SI #0#9 = "S";
       |SI #catalm01#5 < fini; |O #catalm01#5> ffin; |ACABA; |FINSI;
   |FINSI;

   mens = " Agenda de Vencimientos -> " + #catalm01#0; #0#7 = mens; |PINTA #0#7;

   nSw = 0;
   |SI #catalm01#1 = #0#0;
       #catalm01#1  = #0#3;
       #catalm01#2  = #0#4;
       #catalm01#14 = #0#5;
       nSw = 1;
   |FINSI;
   |SI #catalm01#3 = #0#0;
       #catalm01#3  = #0#3;
       #catalm01#4  = #0#4;
       #catalm01#22 = #0#5;
       nSw = 1;
   |FINSI;

   |SI nSw = 1;
      |GRABA 020#74a;
   |FINSI;
   |LIBERA #74;
|FPRC;

|DEFBUCLE catalm01;
   #74#1;
   ;
   enEmpresa, 000001;
   enEmpresa, 999999;
   be;
   NULL, catalm01;
|FIN;

____________________________________/ cagruiva
|PROCESO cagruiva1;
   mens = " Grupos de IVA > " + #cagruiva#0; #0#7 = mens; |PINTA #0#7;

   nSw = 0;
   |PARA para4 = 2; |SI para4 [ 16; |HACIENDO para4 = para4 + 1;
         para3 = para4 + 15;
         |SI #0#0 = #cagruiva#para4#;
             #cagruiva#para4# = #0#3;
             #cagruiva#para3# = #0#4;
             nSw = 1;
         |FINSI;
   |SIGUE;
   |SI nSw = 1;
       |GRABA 020#70a;
   |FINSI;
   |LIBERA #70;
|FPRC;

|DEFBUCLE cagruiva;
   #70#1;
   ;
   00;
   99;
   be;
   NULL, cagruiva1;
|FIN;

____________________________________/ camautol
|PROCESO camautol1;
   mens = " Asientos Automaticos.> " + #camautol#0 + "-" + #camautol#1; #0#7 = mens; |PINTA #0#7;

   |SI #0#0 = #camautol#2;
       #camautol#2 = #0#3;
       #camautol#3 = #0#4;
       |GRABA 020#72a;
   |FINSI;
   |LIBERA #72;
|FPRC;

|DEFBUCLE camautol;
   #72#1;
   ;
   0,    0;
   99999, 9999;
   be;
   NULL, camautol1;
|FIN;

____________________________________/ camauto1
|PROCESO camauto11;
   mens = " Asientos Automaticos.> " + #camauto1#0 + "-" + #camauto1#1; #0#7 = mens; |PINTA #0#7;

   |SI #0#0 = #camauto1#2;
       #camauto1#2 = #0#3;
       #camauto1#3 = #0#4;
       |GRABA 020#73a;
   |FINSI;
   |LIBERA #73;
|FPRC;

|DEFBUCLE camauto1;
   #73#1;
   ;
   0,    0;
   99999, 9999;
   be;
   NULL, camauto11;
|FIN;

____________________________________/ caliconb
|PROCESO caliconb1;
   mens = " Contrapartidas> " + #caliconb#0 + "-" + #caliconb#1; #0#7 = mens; |PINTA #0#7;
   |SI #0#0 = #caliconb#2;
       #caliconb#2 = #0#3;
       #caliconb#3 = #0#4;
       |GRABA 020#68a;
   |FINSI;
   |LIBERA #68;
|FPRC;

|DEFBUCLE caliconb;
   #68#1;
   ;
   "        ",     0;
   "zzzzzzzz", 99999;
   be;
   NULL, caliconb1;
|FIN;
____________________________________/ calicont
|PROCESO calicont1;
   mens = " Contrapartidas> " + #calicont#0 + "-" + #calicont#1 + "-" + #calicont#2; #0#7 = mens; |PINTA #0#7;
   |SI #0#0 = #calicont#4;
       nSw = 1;
       |SI nDcon ! 1; |Y nHcon ! 999;
           #camaasil#0 = #calicont#0;
           #camaasil#1 = #calicont#1;
           #camaasil#2 = #calicont#2;
           #camaasil#3 = #calicont#3;
           |SI FSalida = 0;
               |SI #camaasil#6 < nDcon; |O #camaasil#6 > nHcon;
                   nSw = 0;
               |FINSI;
           |FINSI;
       |FINSI;
       |SI nSw = 1;
           #calicont#4 = #0#3;
           #calicont#5 = #0#4;
          |GRABA 020#67a;
       |FINSI;
   |FINSI;
   |LIBERA #67;
|FPRC;

|DEFBUCLE calicont;
   #67#1;
   ;
   nDdia, fini, nDdoc,    0;
   nHdia, ffin, nHdoc, 9999;
   be;
   NULL, calicont1;
|FIN;
____________________________________/ camaylin
|PROCESO camaylin1;
   mens = " Diario Mayor> " + #camaylin#0 + "-" + #camaylin#1; #0#7 = mens; |PINTA #0#7;

   nSw = 0;
   |SI #0#0 = #camaylin#4;
       #camaylin#4 = #0#3;
       #camaylin#5 = #0#4;
       nSw = 1;
   |FINSI;
   |SI #0#0 = #camaylin#10;
       #camaylin#10 = #0#3;
       #camaylin#11 = #0#4;
       nSw = 1;
   |FINSI;

   |SI nSw = 1;
       |GRABA 020#46a;
   |FINSI;
   |LIBERA #46;
|FPRC;

|DEFBUCLE camaylin;
   #46#1;
   6;
   nDdia, fini, nDdoc,    0, nDcon;
   nHdia, ffin, nHdoc, 9999, nHcon;
   be;
   NULL, camaylin1;
|FIN;
____________________________________/ caexistl
|PROCESO caexistl1;
   mens = " Descarga Existencias> " + #caexistl#0 + "-" + #caexistl#1; #0#7 = mens; |PINTA #0#7;

   nSw = 0;
   |SI #0#0 = #caexistl#2;
       #caexistl#2 = #0#3;
       #caexistl#3 = #0#4;
       nSw = 1;
   |FINSI;
   |SI #0#0 = #caexistl#5;
       #caexistl#5 = #0#3;
       #caexistl#6 = #0#4;
       nSw = 1;
   |FINSI;
   |SI #0#0 = #caexistl#8;
       #caexistl#8 = #0#3;
       #caexistl#9 = #0#4;
       nSw = 1;
   |FINSI;

   |SI nSw = 1;
      |GRABA 020#44a;
   |FINSI;
   |LIBERA #44;
|FPRC;

|DEFBUCLE caexistl;
   #44#1;
   ;
   0,  0;
   99, 99;
   be;
   NULL, caexistl1;
|FIN;
____________________________________/ caexistc
|PROCESO caexistc1;
   mens = " Descarga Existencias> " + #caexistc#0; #0#7 = mens; |PINTA #0#7;
   |SI #0#0 = #caexistc#2;
       #caexistc#2 = #0#3;
       #caexistc#3 = #0#4;
       |GRABA 020#43a;
   |FINSI;
   |LIBERA #43;
|FPRC;

|DEFBUCLE caexistc;
   #43#1;
   ;
   0;
   99;
   be;
   NULL, caexistc1;
|FIN;

____________________________________/ camoauxl
|PROCESO camoauxl;

  |ABRE #52;
  |PARA nPara1 = 1; |SI nPara1 [ 99; |HACIENDO nPara1 = nPara1 + 1;
        aAlfa1 = nPara1; |QBF aAlfa1;
        aAlfa1 = ("00" + aAlfa1) % -102;

        |PARA para3 = 1; |SI para3 [ 999; |HACIENDO para3 = para3 + 1;
              #camoauxl#7 = aAlfa1;
              #camoauxl#0 = #0#0;
              #camoauxl#2 = para3;
              |LEE 000#52];
              |SI FSalida ! 0;
                  |SAL;
              |SINO;
                  |SI #camoauxl#0 = #0#0;
                      sw_ya = 0;
                      #camoauxl#7 = aAlfa1;
                      #camoauxl#0 = #0#3;
                      #camoauxl#1 = #0#4;
                      para3 = #camoauxl#2;
                      |LEE 000#52=;
                      |SI FSalida = 0; sw_ya = 1; |FINSI;
                      #camoauxl#7 = aAlfa1;
                      #camoauxl#0 = #0#0;
                      #camoauxl#1 = #0#1;
                      #camoauxl#2 = para3;
                      |LEE 000#52=;
                      |SI FSalida = 0;
                          |SI sw_baja = 0; |BORRA 020#52a; |FINSI;
                          mens = " Ctas. Inventario> " + #camoauxl#0 + "-" + #camoauxl#2; #0#7 = mens; |PINTA #0#7;
                          |SI sw_ya = 0;
                              #camoauxl#7 = aAlfa1;
                              #camoauxl#0 = #0#3;
                              #camoauxl#1 = #0#4;
                              #camoauxl#2 = para3;
                              |GRABA 020#52n;
                          |FINSI;
                      |FINSI;
                  |SINO;
                      |SAL;
                  |FINSI;
              |FINSI;
        |SIGUE;
   |SIGUE;
   |CIERRA #52;
|FPRC;
____________________________________/ camoauxc
|PROCESO camoauxc;
   |ABRE #40;

   |PARA nPara1 = 1; |SI nPara1 [ 99; |HACIENDO nPara1 = nPara1 + 1;
         aAlfa1 = nPara1; |QBF aAlfa1;
         aAlfa1 = ("00" + aAlfa1) % -102;

         #camoauxc#6 = aAlfa1;
         #camoauxc#0 = #0#3;
         #camoauxc#1 = #0#4;
         |LEE 000#40=;
         sw_ya = 0; |SI FSalida = 0; sw_ya = 1; |FINSI;

         #camoauxc#6 = aAlfa1;
         #camoauxc#0 = #0#0;
         #camoauxc#1 = #0#1;
         |LEE 000#40=;
         |SI FSalida = 0;
             mens = " Ctas.Inventario> " + #0#0;   #0#7 = mens;   |PINTA #0#7;
             |SI sw_baja = 0; |BORRA 020#40a; |FINSI;
             |SI sw_ya = 0;
                 #camoauxc#6 = aAlfa1;
                 #camoauxc#0 = #0#3;
                 #camoauxc#1 = #0#4;
                 |GRABA 020#40n;
             |FINSI;
         |FINSI;
   |SIGUE;
   |CIERRA #40;
|FPRC;
____________________________________/ cacuepre
|PROCESO cacuepre;
   |ABRE #39;
   #cacuepre#0 = #0#3;
   #cacuepre#1 = #0#4;
   |LEE 000#39=;
   sw_ya = 0; |SI FSalida = 0; sw_ya = 1; |FINSI;
   #cacuepre#0 = #0#0;
   #cacuepre#1 = #0#1;
   |LEE 000#39=;
   |SI FSalida = 0;
      |SI sw_baja = 0; |BORRA 020#39a; |FINSI;
      mens = " Ctas.Presup.> " + #0#0;   #0#7 = mens;   |PINTA #0#7;
      |SI sw_ya = 0;
         #cacuepre#0 = #0#3;
         #cacuepre#1 = #0#4;
         |GRABA 000#39n;
      |FINSI;
   |FINSI;
   |CIERRA #39;
|FPRC;
____________________________________/ caconcic
|PROCESO caconcic;
   |ABRE #38;
   #caconcic#0 = #0#3;
   #caconcic#1 = #0#4;
   |LEE 000#38=;
   sw_ya = 0; |SI FSalida = 0; sw_ya = 1; |FINSI;
   #caconcic#0 = #0#0;
   #caconcic#1 = #0#1;
   |LEE 000#38=;
   |SI FSalida = 0;
      |SI sw_baja = 0; |BORRA 020#38a; |FINSI;
      mens = " Diferencias> " + #0#0;   #0#7 = mens;   |PINTA #0#7;
      |SI sw_ya = 0;
         #caconcic#0 = #0#3;
         #caconcic#1 = #0#4;
         |GRABA 020#38n;
      |FINSI;
   |FINSI;
   |CIERRA #38;
|FPRC;
____________________________________/ caconcil
|PROCESO caconcil;
   |ABRE #45;
   |PARA para3 = 1; |SI para3 [ 999; |HACIENDO para3 = para3 + 1;
      #caconcil#0 = #0#0;
      #caconcil#1 = #0#1;
      #caconcil#2 = para3;
      |LEE 000#45];
      |SI FSalida ! 0;
         |SAL;
      |SINO;
         |SI #caconcil#0 = #0#0; |Y #caconcil#1 = #0#1;
            #caconcil#0 = #0#3;
            #caconcil#1 = #0#4;
            para3 = #caconcil#2;
            |LEE 000#45=;
            sw_ya = 0; |SI FSalida = 0; sw_ya = 1; |FINSI;
            #caconcil#0 = #0#0;
            #caconcil#1 = #0#1;
            #caconcil#2 = para3;
            |LEE 000#45=;
            |SI FSalida = 0;
               mens = " Diferencias Lineas> " + #caconcil#0 + "-"+#caconcil#2; #0#7 = mens;   |PINTA #0#7;
               |SI sw_baja = 0; |BORRA 020#45a; |FINSI;
               |SI sw_ya = 0;
                  #caconcil#0 = #0#3;
                  #caconcil#1 = #0#4;
                  #caconcil#2 = para3;
                  |GRABA 020#45n;
               |FINSI;
            |FINSI;
         |SINO;
            |SAL;
         |FINSI;
      |FINSI;
   |SIGUE;
   |CIERRA #45;
|FPRC;

____________________________________/ capasven

|PROCESO capasven1;
   mens = " Control Pase Ventas Contado > " + #capasven#0; #0#7 = mens; |PINTA #0#7;

   nSw = 0;
   |SI #0#0 = #capasven#9;
       #capasven#9  = #0#3;
       #capasven#12 = #0#4;
       nSw = 1;
   |FINSI;
   |SI #0#0 = #capasven#10;
       #capasven#10 = #0#3;
       #capasven#13 = #0#4;
       nSw = 1;
   |FINSI;
   |SI #0#0 = #capasven#11;
       #capasven#11 = #0#3;
       #capasven#14 = #0#4;
       nSw = 1;
   |FINSI;

   |SI nSw = 1;
       |GRABA 020#51a;
   |FINSI;
   |LIBERA #51;
|FPRC;

|DEFBUCLE capasven;
   #51#1;
   ;
   "  ";
   "zz";
   be;
   NULL, capasven1;
|FIN;

____________________________________/ caplalab
|PROCESO caplalab;

   mens = " Entrda Laboral -> " + #caplalab#1; #0#7 = mens; |PINTA #0#7;

   nSw = 0;
   |SI #caplalab#9  = #0#0; #caplalab#9  = #0#3; nSw = 1; |FINSI;
   |SI #caplalab#13 = #0#0; #caplalab#13 = #0#3; nSw = 1; |FINSI;
   |SI #caplalab#17 = #0#0; #caplalab#17 = #0#3; nSw = 1; |FINSI;
   |SI #caplalab#21 = #0#0; #caplalab#21 = #0#3; nSw = 1; |FINSI;
   |SI #caplalab#25 = #0#0; #caplalab#25 = #0#3; nSw = 1; |FINSI;
   |SI #caplalab#37 = #0#0; #caplalab#37 = #0#3; nSw = 1; |FINSI;
   |SI #caplalab#44 = #0#0; #caplalab#44 = #0#3; nSw = 1; |FINSI;
   |SI #caplalab#48 = #0#0; #caplalab#48 = #0#3; nSw = 1; |FINSI;

   |SI nSw = 1;
      |GRABA 020#80a;
   |FINSI;
   |LIBERA #80;
|FPRC;

|DEFBUCLE caplalab;
   #80#1;
   ;
   0001;
   9999;
   be;
   NULL, caplalab;
|FIN;

____________________________________/ cadeflab/ ac / al / ay / ax
/*
|PROCESO cadefxaz;
   mens = " Control Entrada Laboral Areas y Secciones Centro>"; #0#7 = mens; |PINTA #0#7;
   nSw = 0;
   |SI #0#0 = #184#3;
       #184#3 = #0#3;
       #184#4 = #0#5;
       nSw = 1;
   |FINSI;
   |SI #0#0 = #184#6;
       #184#6 = #0#3;
       #184#7 = #0#5;
       nSw = 1;
   |FINSI;
   |SI #0#0 = #184#8;
       #184#8 = #0#3;
       #184#9 = #0#5;
       nSw = 1;
   |FINSI;
   |SI nSw = 1;
       |GRABA 020#184a;
   |FINSI;
   |LIBERA #184;
|FPRC;

|DEFBUCLE cadefxaz;
 #184#1;
 ;
 00, " ", " ";
 99, "z", "z";
 be;
 NULL, cadefxaz;
|FIN;
*/

|PROCESO cadeflaz;
   mens = " Control Entrada Laboral Areas y Secciones> "; #0#7 = mens; |PINTA #0#7;
   nSw = 0;
   |SI #0#0 = #84#3;
       #84#3 = #0#3;
       #84#4 = #0#5;
       nSw = 1;
   |FINSI;
   |SI #0#0 = #84#6;
       #84#6 = #0#3;
       #84#7 = #0#5;
       nSw = 1;
   |FINSI;
   |SI #0#0 = #84#8;
       #84#8 = #0#3;
       #84#9 = #0#5;
       nSw = 1;
   |FINSI;
   |SI nSw = 1;
       |GRABA 020#84a;
   |FINSI;
   |LIBERA #84;
|FPRC;

|DEFBUCLE cadeflaz;
 #84#1;
 ;
 " ", " ";
 "z", "z";
 be;
 NULL, cadeflaz;
|FIN;

/*
|PROCESO cadefxax;
   mens = " Control Entrada Laboral Areas y Secciones> "; #0#7 = mens; |PINTA #0#7;
   |SI #0#0 = #182#3;
       #182#3 = #0#3;
       #182#4 = #0#5;
       |GRABA 020#182a;
   |FINSI;
   |LIBERA #182;
|FPRC;

|DEFBUCLE cadefxax;
 #182#1;
 ;
 00, " ", " ";
 99, "z", "z";
 be;
 NULL, cadefxax;
|FIN;
*/

|PROCESO cadeflax;
   mens = " Control Entrada Laboral Areas y Secciones> "; #0#7 = mens; |PINTA #0#7;
   |SI #0#0 = #82#3;
       #82#3 = #0#3;
       #82#4 = #0#5;
       |GRABA 020#82a;
   |FINSI;
   |LIBERA #82;
|FPRC;

|DEFBUCLE cadeflax;
 #82#1;
 ;
 " ", " ";
 "z", "z";
 be;
 NULL, cadeflax;
|FIN;

|PROCESO cadeflay;
   mens = " Control Entrada Laboral Centros> "; #0#7 = mens; |PINTA #0#7;
   nSw = 0;
   |SI #0#0 = #83#2;
       #83#2 = #0#3;
       #83#3 = #0#5;
       nSw = 1;
   |FINSI;
   |SI #0#0 = #83#5;
       #83#5 = #0#3;
       #83#6 = #0#5;
       nSw = 1;
   |FINSI;
   |SI #0#0 = #83#7;
       #83#7 = #0#3;
       #83#8 = #0#5;
       nSw = 1;
   |FINSI;
   |SI nSw = 1;
       |GRABA 020#83a;
   |FINSI;
   |LIBERA #83;
|FPRC;

|DEFBUCLE cadeflay;
 #83#1;
 ;
 01;
 99;
 be;
 NULL, cadeflay;
|FIN;

|PROCESO cadefxal;
   mens = " Control Entrada Laboral Conceptos-Centros> "; #0#7 = mens; |PINTA #0#7;
   |SI #0#0 = #179#2;
       #179#2 = #0#3;
       |GRABA 020#179a;
   |FINSI;
   |LIBERA #179;
|FPRC;

|DEFBUCLE cadefxal;
 #179#1;
 ;
 00, 001;
 99, 999;
 be;
 NULL, cadefxal;
|FIN;

|PROCESO cadeflal;
   mens = " Control Entrada Laboral Conceptos> "; #0#7 = mens; |PINTA #0#7;
   |SI #0#0 = #79#2;
       #79#2 = #0#3;
       |GRABA 020#79a;
   |FINSI;
   |LIBERA #79;
|FPRC;

|DEFBUCLE cadeflal;
 #79#1;
 ;
 001;
 999;
 be;
 NULL, cadeflal;
|FIN;

|PROCESO cadeflac;
   mens = " Control Entrada Laboral Centros> "; #0#7 = mens; |PINTA #0#7;
   |SI #0#0 = #78#2;
       #78#2 = #0#3;
       #78#3 = #0#5;
       |GRABA 020#78a;
   |FINSI;
   |LIBERA #78;
|FPRC;

|DEFBUCLE cadeflac;
 #78#1;
 ;
 01;
 99;
 be;
 NULL, cadeflac;
|FIN;

|PROCESO cadefxab1;
   mens = " Control Entrada Laboral Centros> "; #0#7 = mens; |PINTA #0#7;
   nSw = 0;
   |SI #0#0 = #177#1;  #177#1  = #0#3; nSw = 1; |FINSI;
   |SI #0#0 = #177#4;  #177#4  = #0#3; nSw = 1; |FINSI;
   |SI #0#0 = #177#7;  #177#7  = #0#3; nSw = 1; |FINSI;
   |SI #0#0 = #177#10; #177#10 = #0#3; nSw = 1; |FINSI;
   |SI #0#0 = #177#13; #177#13 = #0#3; nSw = 1; |FINSI;
   |SI #0#0 = #177#16; #177#16 = #0#3; nSw = 1; |FINSI;
   |SI #0#0 = #177#49; #177#49 = #0#3; nSw = 1; |FINSI;
   |SI #0#0 = #177#63; #177#63 = #0#3; nSw = 1; |FINSI;
   |SI #0#0 = #177#69; #177#69 = #0#3; nSw = 1; |FINSI;

   |SI nSw = 1;
       |GRABA 020#177a;
   |FINSI;
   |LIBERA #177;
|FPRC;

|DEFBUCLE cadefxab;
 #177#1;
 ;
 00;
 99;
 be;
 NULL, cadefxab1;
|FIN;

|PROCESO cadeflab;

   |ABRE #77;
   |LEE 000#77p;
   |SI FSalida ! 0;
      |CIERRA #77;
      |ACABA;
   |FINSI;

   mens = " Control Entrada Laboral> "; #0#7 = mens; |PINTA #0#7;
   nSw = 0;
   |SI #0#0 = #77#1;  #77#1  = #0#3; nSw = 1; |FINSI;
   |SI #0#0 = #77#4;  #77#4  = #0#3; nSw = 1; |FINSI;
   |SI #0#0 = #77#7;  #77#7  = #0#3; nSw = 1; |FINSI;
   |SI #0#0 = #77#10; #77#10 = #0#3; nSw = 1; |FINSI;
   |SI #0#0 = #77#13; #77#13 = #0#3; nSw = 1; |FINSI;
   |SI #0#0 = #77#16; #77#16 = #0#3; nSw = 1; |FINSI;
   |SI #0#0 = #77#49; #77#49 = #0#3; nSw = 1; |FINSI;
   |SI #0#0 = #77#63; #77#63 = #0#3; nSw = 1; |FINSI;
   |SI #0#0 = #77#69; #77#69 = #0#3; nSw = 1; |FINSI;

   |SI nSw = 1;
       |GRABA 020#77a;
   |FINSI;
   |LIBERA #77;
   |CIERRA #77;

   |BUCLE cadefxab;
   |BUCLE cadeflac;
   |BUCLE cadeflal; |BUCLE cadefxal;
   |BUCLE cadeflax; ||  |BUCLE cadefxax;
   |BUCLE cadeflay;
   |BUCLE cadeflaz; |||BUCLE cadefxaz;
|FPRC;

____________________________________/ caivaasi

|PROCESO caivaasi;

   |ABRE #64;
   |LEE 000#64p;
   |SI FSalida ! 0;
      |CIERRA #64;
      |ACABA;
   |FINSI;

   mens = " Control Entrada Apuntes IVA> "; #0#7 = mens; |PINTA #0#7;
   nSw = 0;

   |SI #0#0 = #caivaasi#39; #caivaasi#39 = #0#3; #caivaasi#40 = #0#4; nSw = 1; |FINSI;
   |SI #0#0 = #caivaasi#49; #caivaasi#49 = #0#3; nSw = 1; |FINSI;
   |SI #0#0 = #caivaasi#53; #caivaasi#53 = #0#3; nSw = 1; |FINSI;
   |SI #0#0 = #caivaasi#81; #caivaasi#81 = #0#3; nSw = 1; |FINSI;
   |SI #0#0 = #caivaasi#82; #caivaasi#82 = #0#3; nSw = 1; |FINSI;
   |SI #0#0 = #caivaasi#138; #caivaasi#138 = #0#3; nSw = 1; |FINSI;
   |SI #0#0 = #caivaasi#142; #caivaasi#142 = #0#3; nSw = 1; |FINSI;

   |SI nSw = 1;
       |GRABA 020#64a;
   |FINSI;
   |LIBERA #64;
   |CIERRA #64;
|FPRC;

____________________________________/ Introduccion lineas Iva
|PROCESO cainliva;
   |SI #0#9 = "S";
       |SI #cainliva#4 < fini;  |O #cainliva#4 > ffin;  |ACABA; |FINSI;
   |FINSI;
   mens = " Introduccion Facturas> " + #cainliva#0 + "-" + #cainliva#1; #0#7 = mens; |PINTA #0#7;

   nSw = 0;
   |SI #cainliva#7 ] nDcon; |Y #cainliva#7 [ nHcon;
       |SI #0#0 = #cainliva#5;
           #cainliva#5 = #0#3; eaCuenta = #0#3; |HAZ SacaNivel;
           #cainliva#6 = enNivel;
           #cainliva#27 = #0#5;
           |HAZ lee_clipro;
           |SI clipro = 0; #cainliva#30 = #caclipro#9; |FINSI;
           nSw = 1;
       |FINSI;
   |FINSI;

   |SI #cainliva#7 ] nDcon; |Y #cainliva#7 [ nHcon;
       |SI #0#0 = #cainliva#17; #cainliva#17 = #0#3; #cainliva#28 = #0#5; nSw = 1; |FINSI;
       |SI #0#0 = #cainliva#20; #cainliva#20 = #0#3; #cainliva#21 = #0#4; nSw = 1; |FINSI;
       |SI #0#0 = #cainliva#22; #cainliva#22 = #0#3; #cainliva#23 = #0#4; nSw = 1; |FINSI;
       |SI #0#0 = #cainliva#24; #cainliva#24 = #0#3; #cainliva#25 = #0#4; nSw = 1; |FINSI;
   |FINSI;

   |SI #cainliva#51 ] nDcon; |Y #cainliva#51 [ nHcon;
       |SI #0#0 = #cainliva#36; #cainliva#36 = #0#3; #cainliva#37 = #0#4; nSw = 1; |FINSI;
   |FINSI;
   |SI #cainliva#43 ] nDcon; |Y #cainliva#43 [ nHcon;
       |SI #0#0 = #cainliva#40; #cainliva#40 = #0#3; #cainliva#41 = #0#4; #cainliva#42 = #0#5; nSw = 1; |FINSI;
   |FINSI;

   |SI nSw = 1;
       |GRABA 020#cainliva.a;
   |FINSI;
   |LIBERA #cainliva;
|FPRC;

|DEFBUCLE cainliva;
   #cainliva#1;
   ;
    0,   0;
   99, 999;
   be;
   NULL, cainliva;
|FIN;

____________________________________/ Mantenimiento IVA
|PROCESO caivalin;
   mens = " Mantenimiento Lineas Iva> " + #caivalin#0 + "-" + #caivalin#1; #0#7 = mens; |PINTA #0#7;

   nSw = 0;
   |SI #caivalin#3 ] nDcon; |Y #caivalin#3 [ nHcon;  ||concepto IVA
       |SI #0#0 = #caivalin#12; #caivalin#12 = #0#3; nSw = 1; |FINSI;
       |SI #0#0 = #caivalin#13; #caivalin#13 = #0#3; nSw = 1; |FINSI;
       |SI #0#0 = #caivalin#14; #caivalin#14 = #0#3; nSw = 1; |FINSI;
       |SI #0#0 = #caivalin#15; #caivalin#15 = #0#3; nSw = 1; |FINSI;
   |FINSI;
   |SI #caivalin#18 ] nDcon; |Y #caivalin#18 [ nHcon; ||concepto IRPF
        |SI #0#0 = #caivalin#23; #caivalin#23 = #0#3; nSw = 1; |FINSI;
   |FINSI;

   |SI nSw = 1;
       |GRABA 020#caivalin.a;
   |FINSI;

   |LIBERA #caivalin;

|FPRC;

|DEFBUCLE caivalin;
 #caivalin#1;
 ;
 #camaniva#0, #camaniva#1, 01;
 #camaniva#0, #camaniva#1, 99;
 be;
 NULL,caivalin;
|FIN;

|PROCESO camaniva;
   |SI #0#9 = "S";
       |SI #camaniva#7 < nDdia; |O #camaniva#7 > nHdia; |ACABA; |FINSI;
       |SI #camaniva#8 < fini;  |O #camaniva#8 > ffin;  |ACABA; |FINSI;
       |SI #camaniva#9 < nDdoc; |O #camaniva#9 > nHdoc; |ACABA; |FINSI;
  |FINSI;

   mens = " Mantenimiento Iva> " + #camaniva#0 + "-" + #camaniva#2; #0#7 = mens; |PINTA #0#7;
   |SI #camaniva#27 ] nDcon; |Y #camaniva#27 [ nHcon;
       |SI #0#0 = #camaniva#12;
           #camaniva#12 = #0#3;
           #camaniva#13 = #0#5;
           |HAZ lee_clipro;
           |SI clipro = 0; #camaniva#14 = #caclipro#9; |FINSI;
           |GRABA 020#camaniva.a;
       |FINSI;
   |FINSI;
   |LIBERA #camaniva;

   |BUCLE caivalin; || Lineas de IVA
|FPRC;

|DEFBUCLE camaniva;
   #camaniva#1;
   ;
   00, 0000000001;
   99, 9999999999;
   be;
   NULL, camaniva;
|FIN;

____________________________________/ camaasil
|PROCESO camaasil1;
   mens = " Apuntes Lins.> " + #camaasil#0 + "-" + #camaasil#1 + "-" + #camaasil#2 + "-" + #camaasil#3; #0#7 = mens; |PINTA #0#7;

   |SI #0#0 = #camaasil#4;
        #camaasil#4 = #0#3;
        #camaasil#5 = #0#4;
        |SI #camaasil#8 = "H";
            #camaasil#10 = #0#3;
            #camaasil#11 = #0#4;
        |SINO;
            #camaasil#16 = #0#3;
            #camaasil#17 = #0#4;
        |FINSI;
        |GRABA 020#26a;
   |FINSI;
   |LIBERA #26;
|FPRC;

|DEFBUCLE camaasil;
   #26#1;
   6;
   nDdia, fini, nDdoc,    0, nDcon;
   nHdia, ffin, nHdoc, 9999, nHcon;
   be;
   NULL, camaasil1;
|FIN;
____________________________________/ camaasic - contrapartida
|PROCESO MiroConcepto;
 nSw = 1;
 |ERROR10;
|FPRC;

|DEFBUCLE MiroConcepto;
   #26#1;
   6;
   #25#0, #25#1, #25#2, 0001, nDcon;
   #25#0, #25#1, #25#2, 9999, nHcon;
   e;
   NULL, MiroConcepto;
|FIN;

|PROCESO camaasic1;

   mens = " Apuntes Cabs.> " + #camaasic#0 + "-" + #camaasic#1 + "_" + #camaasic#3; #0#7 = mens; |PINTA #0#7;

   |SI #0#9 = "S";
       |SI nDcon ! 1; |O nHcon ! 999;   || hay alguna seleccion de conceptos
           nSw = 0;
           |BUCLE MiroConcepto;
           |SI nSw = 0; |LIBERA #25; |ACABA; |FINSI;
       |FINSI;
   |FINSI;
   nSw = 0;
   |SI #0#0 = #camaasic#8;
       #camaasic#8 = #0#3;
       #camaasic#9 = #0#4;
       nSw = 1;
   |FINSI;
   |SI #0#0 = #camaasic#10;
       #camaasic#10 = #0#3;
       #camaasic#11 = #0#4;
       nSw = 1;
   |FINSI;
   |SI nSw = 1;
       |GRABA 020#25a;
   |FINSI;
   |LIBERA #25;
|FPRC;

|DEFBUCLE camaasic;
   #25#1;
   ;
   nDdia, fini, nDdoc;
   nHdia, ffin, nHdoc;
   be;
   NULL, camaasic1;
|FIN;

____________________________________/ casieali
|PROCESO casieali1;

   mens = " Predefinidos> " + #casieali#0 + " " + #casieali#1; #0#7 = mens; |PINTA #0#7;
   |SI #casieali#3 = #0#0;
       #casieali#3 = #0#3;
       |GRABA 020#21a;
   |FINSI;
   |LIBERA #21;
|FPRC;

|DEFBUCLE casieali;
   #21#1;
   ;
   1,     1;
   9999, 99;
   be;
   NULL, casieali1;
|FIN;
____________________________________/ Contrapartida en CLIENTES Y PROVEEDORES
|PROCESO clienpro1;
   mens = "Contrapartida Cli./Prov.> " + #caclipro#10; #0#7 = mens; |PINTA #0#7;
   |SI #0#0 = #caclipro#21;
       #caclipro#21 = #0#3;
       #caclipro#22 = #0#4;
       |GRABA 020#71a;
   |FINSI;
   |LIBERA #71;
|FPRC;

|DEFBUCLE clienpro;
   #71#1;
   ;
   " ","            ";
   "z","zzzzzzzzzzzz";
   be;
   NULL, clienpro1;
|FIN;

____________________________________/ caclipro
|PROCESO caclipro;
   nNume1 = #0#0;
   |ABRE #71;
   #caclipro#10 = #0#3;
   #caclipro#11 = #0#4;
   traba = #caclipro#10 % 102;
   |SI traba = "43"; |O traba = "44";
      #caclipro#23 = "C";
   |SINO;
      #caclipro#23 = "P";
   |FINSI;
   alfa2 = #caclipro#23;

   |LEE 000#71=;
   sw_ya = 0; |SI FSalida = 0;  sw_ya = 1; |FINSI;
   #caclipro#10 = #0#0;
   #caclipro#11 = #0#1;
   traba = #caclipro#10 % 102;
   |SI traba = "43";  |O traba = "44";
      #caclipro#23 = "C";
   |SINO;
      #caclipro#23 = "P";
   |FINSI;
   |LEE 000#71=;
   |SI FSalida = 0;
      mens = " CLIENTE/PROVEEDOR > " + #0#0; #0#7 = mens; |PINTA #0#7;
      |SI sw_baja = 0; |BORRA 020#71a; |FINSI;
      |SI sw_ya = 0;
         #caclipro#23 = alfa2;
         #caclipro#10 = #0#3;
         #caclipro#11 = #0#4;
         |SI nNume1 = #caclipro#0;
             #caclipro#0 = #caclipro#10;
         |FINSI;
         |GRABA 020#71n;
      |FINSI;
   |FINSI;
   |LIBERA #71;
   |CIERRA #71;
|FPRC;
____________________________________/ cacuenta
|PROCESO cacuenta;
   mens = " Plan Contable> " + #0#0;   #0#7 = mens;   |PINTA #0#7;

   sw_ya0 = 0;
   |DDEFECTO #69;
   |ABRE #69;
   #cacuenta#0 = #0#0;
   #cacuenta#1 = #0#1;
   |LEE 101#69=;
   |SI FSalida ! 0;
       |DDEFECTO #69;
       #cacuenta#0 = #0#0;
       #cacuenta#1 = #0#1;
       #cacuenta#2 = #0#5;
       #cacuenta#3 = "S";
       sw_ya0 = 1;
    |FINSI;

   Icant = cant1 <-;
   |PARA nume1 = 9; |SI nume1 [ 53; |HACIENDO nume1 = nume1+ 1;
      cant = #cacuenta#nume1#;
      Icant = Icant + 1;
   |SIGUE;
   || ------------------------------ Crea o actualiza cuenta ---------------
   #cacuenta#0 = #0#3;
   #cacuenta#1 = #0#4;
   |LEE 100#69=;
   |SI FSalida ! 0;
      #cacuenta#0 = #0#3;
      #cacuenta#1 = #0#4;
      #cacuenta#2 = #0#5;
      |HAZ defectos;
      |GRABA 020#69n;
   |SINO;
      Icant = cant1 <-;
      |PARA nume1 = 9; |SI nume1 [ 53; |HACIENDO nume1 = nume1+ 1;
         #cacuenta#nume1# = cant + #cacuenta#nume1#;
         Icant = Icant + 1;
      |SIGUE;
      |GRABA 020#69a;
   |FINSI;
   |LIBERA #69;


   #cacuenta#0 = #0#0;
   #cacuenta#1 = #0#1;
   |LEE 100#69=;
   |SI FSalida = 0;
       |SI #0#6 = "S";
           |BORRA 020#69a;
       |SINO;
           |PDEFECTO #69,9,54;
           |PDEFECTO #69,56,60;
           |GRABA 020#69a;
       |FINSI;
   |FINSI;
   |LIBERA #69;
   |CIERRA #69;
|FPRC;

||**************************************************************************
|PROCESO ElBloqueo;
  nSwTipo = 0;
  |SI fec3 > "01.01.0000";
      |SI fec3 ] fec2;  nSwTipo = 1;  |FINSI;
      |SI fec3 < fec2;
          |SI #cacamcta#9 = "N";
              nSwTipo = 2;
          |SINO;
              |SI fec3 ] #cacamcta#12; nSwTipo = 2; |FINSI;
          |FINSI;
      |FINSI;
  |FINSI;

  |SI nSwTipo = 1;
      aAlfa  = "0000Empresa bloqueada a fecha Fin de Ejercicio. Proceso no permitido";
      |MENAV aAlfa;
  |FINSI;

  |SI nSwTipo = 2;
      nSwTipo = 1;
      aAlfa = "0000NEmpresa bloqueada a " + fec3 + ". Desea continuar con el cambio";
      |CONFI aAlfa;
      |SI FSalida = 0; nSwTipo = 0; |FINSI;
  |FINSI;
|FPRC;
||**************************************************************************

|PROCESO camcta; |TIPO 3;

   |SI #0#8 ! "SI";  |ACABA;  |FINSI;

   sw_baja = 0; |SI #0#6 = "N"; sw_baja = 1; |FINSI;
   fini = "01.01.1900"; nDdoc = 000001; nDdia = 00; nDcon = 001;
   ffin = "31.12.9999"; nHdoc = 999999; nHdia = 99; nHcon = 999;
   |SI #0#9 = "S";
       nDdia = #0#10; fini = #0#12; nDdoc = #0#14; nDcon = #0#16;
       nHdia = #0#11; ffin = #0#13; nHdoc = #0#15; nHcon = #0#17;
   |FINSI;

   |SI swTabla = 0;
       |HAZ ElBloqueo;
       |SI nSwTipo = 1; |ACABA; |FINSI;
   |FINSI;

   |HAZ cacuenta;   || PLAN CONTABLE
   |HAZ caclipro;   || Cliente / Proveedor.

   |BUCLE camaasic; || Contrapartidas en Apuntes
   |BUCLE camaasil; || Cuentas en Lineas Apuntes
   |BUCLE camaniva; || Cuentas en Mantenimiento de IVA.
   |BUCLE cainliva; || Introduccion Registros Iva
   |BUCLE camaylin;
   |ABRE #camaasil; |BUCLE calicont; |CIERRA #camaasil;
   |BUCLE catalm01;
   |BUCLE caw00017;

   |SI #0#9 = "N";
       |BUCLE clienpro; || Contrapartida en Cliente - Proveedor
       |BUCLE casieali; || Cuentas en Lineas Predefinidos
       |HAZ caivaasi;   || Control Entrada Asientos IVA.
       |HAZ cadeflab;   || Control Entrada Laboral
       |BUCLE caplalab;
       |BUCLE capasven; || Control pase ventas automaticas.

       |HAZ caconcic; || Conciliar cuentas cab.
       |HAZ caconcil; || Conciliar cuentas lins.
       |HAZ cacuepre; || Cuenta Presupuestada.
       |HAZ camoauxc; || Desglose de Cuentas
       |HAZ camoauxl; || Desglose de Cuentas

       |BUCLE caexistc;
       |BUCLE caexistl;
       |BUCLE camautol;
       |BUCLE camauto1;
       |BUCLE cagruiva;
       |BUCLE caconvec;
       |BUCLE cafinanc;
       |BUCLE caliconb;
       |BUCLE n43saldo;
   |FINSI;

   |SI enEjercicio = 2008;
       |SI #0#9 = "N"; |BUCLE ca8m0003; |FINSI;
       |BUCLE ca8m0004;
   |FINSI;

   || ----------------- Proceso Amortizaciones
   |HAZ DirAplicSt;
   |SI Haymodelo ! 0;
       |SI #0#9 = "N";
           |BUCLE dsmom041;
           |BUCLE dsmom040;
       |FINSI;
       |BUCLE dsmom044;
       |BUCLE dsmom045;
   |FINSI;

   |SI #0#9 = "N";
       aCampo0 = #0#0;
       nCampo1 = #0#1;
       aCampo2 = #0#2;
       aCampo3 = #0#3;
       nCampo4 = #0#4;
       aCampo5 = #0#5;
       aCampo6 = #0#6;
       aCampo9 = #0#9;
       nCampo10 = #0#10;
       nCampo11 = #0#11;
       fCampo12 = #0#12;
       fCampo13 = #0#13;
       nCampo14 = #0#14;
       nCampo15 = #0#15;
       nCampo16 = #0#16;
       nCampo17 = #0#17;
       |SUB_EJECUTA_NP "cacamctb";
   |FINSI;

   |SI swTabla = 1; |ACABA; |FINSI;

   |DFICE pathbal;
   |CONFI "2410SDesea Realizar el Recalculo de Saldos: ";
   |SI FSalida = 0;
       balance = 1;
       |SUB_EJECUTA "careccue";
   |FINSI;

|FPRC;


|PROGRAMA;
 |HAZ inicio;

 |SI swTabla = 0;
     |MANTE #0;
 |SINO;
     |CLS;
     |PINPA #0#0;
     #0#0  = aCampo0;
     #0#1  = nCampo1;
     #0#2  = aCampo2;
     #0#3  = aCampo3;
     #0#4  = nCampo4;
     #0#5  = aCampo5;
     #0#6  = aCampo6;
     #0#8  = "SI";
     #0#9  = aCampo9;
     #0#10 = nCampo10;
     #0#11 = nCampo11;
     #0#12 = fCampo12;
     #0#13 = fCampo13;
     #0#14 = nCampo14;
     #0#15 = nCampo15;
     #0#16 = nCampo16;
     #0#17 = nCampo17;
     |PINDA #0#0;
     |HAZ camcta;
 |FINSI;
|FPRO;
