|FICHEROS;
   conselec #0;
   conexcel #1;
|FIN;

|VARIABLES;
  i      = 0;
  sub    = "";
  auto   = 0;
  aParam = "";
|FIN;

|PROCESO desdehasta;|TIPO 0;
    |SI #0#2 = "S";
        |C_M #0#3,1,"S";
        |C_M #0#4,1,"S";
        |PARA i = 5;|SI i [ 40;|HACIENDO i = i + 1;
              |C_M #0i,1,"N";
        |SIGUE;
    |SINO;
        |C_M #0#3,1,"N";
        |C_M #0#4,1,"N";
        |PARA i = 5;|SI i [ 40;|HACIENDO i = i + 1;
              |C_M #0i,1,"S";
        |SIGUE;
    |FINSI;
|FPRC;


|PROCESO cons;|TIPO 66;
  |CONSULTA_CLAVE #2#conexcel;
  |SI FSalida ] 0;
        #0Campo = #1#0;
        |PINTA #0Campo;
  |SINO;
        |ERROR;
  |FINSI;
|FPRC;

|PROCESO ImpParrilla;

   |ABRE #1;
   |SI #0#2 = "S";
       #1#0 = #0#3;
       |LEE 010#1];
       |PARA; |SI FSalida = 0;|Y #1#0 [ #0#4; |HACIENDO;
              sub = "conexcel;" + (("0000"+#1#0) % "-104" );
              |SUB_EJECUTA sub;
              |LEE 010#1s;
       |SIGUE;
   |SINO;
        |PARA i = 5; |SI i [ 40; |HACIENDO i = i + 1;
              |SI #0i ! 0;
                  #1#0 = #0i;
                  |LEE 010#1=;
                  |SI FSalida = 0;
                      sub = "conexcel;" + (("0000"+#1#0) % "-104" );
                      |SUB_EJECUTA sub;
                  |FINSI;
              |FINSI;
        |SIGUE;
   |FINSI;
   |CIERRA #1;
|FPRC;


|PROGRAMA;

   aParam = PARAMETRO;
   |SI aParam = "MANTE";
       |MANTE #0;
   |SINO;

       |ABRET #0;
       |CLS;
       |CABEZA "Parrila de Seleccion";
       |PINPA #0#0;
       |PINTA 0603, "                                                               ";
       |ATRI R;
       |PINTA 0603, "Obtener Hoja Excell por parrilla de Seleccion";
       |ATRI 0;

       |SI aParam ] "0000"; |Y aParam [ "9999";
           #0#0 = aParam;
           |LEE 010#0=;
           |SI FSalida = 0;
               auto = 1;
           |FINSI;
       |FINSI;
       |SI auto ! 1; || en caso contrario FSalida valdra 0
           |LEE 010#0p;
           |SI FSalida = 0;
               |CONSULTA_CLAVE #2#0;
           |SINO;
                FSalida = 0;
           |FINSI;
       |FINSI;
       |SI FSalida ] 0;
           |PINDA #0#0;
           |SI auto = 1;
               FSalida = 0;
           |SINO;
               |ENDATOS #1#0;
           |FINSI;
           |SI FSalida ] 0;
               |HAZ ImpParrilla;
           |FINSI;
       |FINSI;
       |CIERRAT #conselec;
   |FINSI;
|FPRO;
