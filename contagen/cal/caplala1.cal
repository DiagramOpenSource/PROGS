|FICHEROS;
   caplala1 #0;
   caplala2 #1,MANTE;
   caplala3 #9,MANTE;

   camaniva #2;
   caivalin #3;
   caclipro #4;

   :/modelos/def/dsmom030 #5;
   calibros #7;
   cafantas #13;

   cadeflac #211;
   cadeflay #213;

   cadeflal@ #10;
   cadeflal #1010;
   cadefxal #1011;

   cadeflab@ #210;
   cadeflab #1210;
   cadefxab #1220;

   cadeflax@ #212;
   cadeflax #1212;
   cadefxax #1222;

   cadeflaz@ #214;
   cadeflaz #1214;
   cadefxaz #1224;
|FIN;

|INCLUYE dscont_i;
|INCLUYE dscoiv_i;
|INCLUYE dscola_i;

|VARIABLES;
   mensa1   = "    ERROR ESTA FECHA NO CORRESPONDE AL EJERCICIO";
   mensa2   = "    ERROR FECHA INFERIOR O IGUAL AL BLOQUEO DE DATOS";
   &entrada    = 1;
   &NombreCif  = "";
   &UltPeriodo = "";
   &UltFecha   = @;
   nTotal      = 0;

   Cont        = 0;
   Calc        = 0;
   Calc1       = 0;
   nume1       = 0;
   nTecla      = 0;
   Campo1      = 0;
   Comodin     = "";
   Comodin1    = "";
   aLong       = "";
   nLong       = 0;
   Caracter    = "";
   ConceptAnt  = 0;
   DescAnt     = "";
   &ModoEntrada = 0;
   alfa1       = "";
   aFich1      = "";

   DiasMes     = 0;
   FechaHoy    = @;
   nYaCrea     = 0;

   SwError     = 0;

   aDirec = "";
   Tecla = 0;
   Handle = 0;
   aCtaCentro = "";
   aCtaCentr1 = "";
   aAnaCentro   = "";
   aAlfa1       = "";
   aCtaAreaSec  = "";
   aCtaAreaSe1  = "";
   aAnaAreaSec  = "";
   nRef         = 0;
   &enSinCentro = 0;
|FIN;

|| *********************************** Calculos caplala1
|CALCULO AntesCampo; |TIPO 7;
|FCAL;

|CALCULO ElCentro0;
  nTecla = FSalida;
  nRef = 0;
  |SI #0#40 ! 0; |Y enSinCentro = 1;
      |ABRE #1220;
      |DDEFECTO #1220;
      #1220#0 = #0#40;
      |LEE 001#1220=;
      |SI FSalida = 0;  nRef = 1; |FINSI;
      |CIERRA #1220;
  |FINSI;

  |SI nRef = 0;
      |ABRE #1210;
      |LEE 001#1210p;
      |CIERRA #1210;

      |REFERENCIA_DEF cadeflal@, #1010;
      |REFERENCIA_DEF cadeflab@, #1210;
      |REFERENCIA_DEF cadeflax@, #1212;
      |REFERENCIA_DEF cadeflaz@, #1214;
  |SINO;
      |REFERENCIA_DEF cadeflal@, #1011;
      |REFERENCIA_DEF cadeflab@, #1220;
      |REFERENCIA_DEF cadeflax@, #1222;
      |REFERENCIA_DEF cadeflaz@, #1224;
  |FINSI;

  |SI ModoEntrada = 1;
      |HAZ TomaDef_Centro;
  |FINSI;
  |SI ModoEntrada = 2;
      |HAZ TomaDefMod_Centro;
  |FINSI;
|FCAL;

|CALCULO ElCentro;
  aCtaCentro = "";
  aAnaCentro = "";
  |SI #0#40 ! 0;
      eOpCen = 0;
      |SI nTecla  = 10; eOpCen = 1; |FINSI;
      enCentro = #0#40;
      |HAZ CentroTrabajo;
      |SI eswLect = 1;
          |ERROR;
      |SINO;
          aCtaCentro = "";
          aAnaCentro = "";
          |ABRE #211;
          #211#0 = enCentro;
          |LEE 001#211=;
          |SI FSalida ! 0;
              #211#2 = #210#1;
              #211#4 = "";
          |FINSI;
          |CIERRA #211;
          aCtaCentro = #211#2;
          aAnaCentro = #211#4;
          |ABRE #213;
          #213#0 = enCentro;
          |LEE 001#213=;
          |SI FSalida ! 0;
              #213#2 = #210#4;
          |FINSI;
          |CIERRA #213;
          aCtaCentr1 = #213#2;
          |SI #210#42  = "C"; #0#9  = aCtaCentro; |PINTA #0#9; |FINSI;
          |SI #210#106 = "C"; #0#13 = aCtaCentr1; |PINTA #0#13; |FINSI;
      |FINSI;
  |FINSI;
|FCAL;

|CALCULO TrasLibro; |TIPO 0;
  ||  ModoEntrada  = (FEntrada / 100) ! 0;
   |ABRE #calibros;
   #calibros#0 = #0#32;
   |LEE 010#calibros.=;
   |SI FSalida ! 0;
       |MENAV "      No existe libro";
       |CIERRA #calibros;
       |C_M #0#32,1,"S";
       |ERROR;
       |ACABA;
   |FINSI;
   |CIERRA #calibros;

   |SI #calibros#2 ! "N";
       |MENAV "     Libro No Correcto";
       |C_M #0#32,1,"S";
       |ERROR;
       |ACABA;
   |FINSI;

   aTipoIVA = #calibros#2;
||  |HAZ LeeDefIVA;

   |SI nYaCrea = 0; |O enLibIVA ! #0#32;
      enLibIVA  = #0#32;
      enFilConc = 1;          || Conceptos de NO IVA
      |HAZ CreaConcepto;
      aFich1 = eaFiCon;
      nYaCrea = 1;
   |FINSI;
|FCAL;

|CALCULO laFecha; |TIPO 0;
   |SI FSalida = 2; |ACABA; |FINSI;
   |SI #0Campo < fec1; |O #0Campo > fec2;
      |MENAV mensa1;
      |ERROR;
   |SINO;
      |SI #0Campo [ fec3;
          |MENAV mensa2;
          |ERROR;
      |FINSI;
   |FINSI;
   |SI snFiMod = "S";
       enConcepto = 0;
       eaFecMod   = #0Campo;
       enPanMod   = 0;
       |HAZ ConsulPlan;
       |SI enExiMod = 0; |Y snSeMod = "N";
           |ERROR;
           |ACABA;
       |FINSI;
   |FINSI;
|FCAL;

|CALCULO TrasPeriodo; |TIPO 0;
   FechaHoy = ~;
   Comodin  = #0#3; |QBF Comodin;

   aLong = Comodin % 0; nLong = aLong;
   |SI nLong = 0; |ACABA; |FINSI;

   |PARA Cont = 1; |SI Cont [ nLong; |HACIENDO Cont = Cont + 1;
         Calc = 0;
         Calc = (Cont * 100) + 1;
         Caracter = Comodin % Calc;
         |SI Caracter < "0"; |O Caracter > "9";
             |ERROR;
             |ACABA;
         |FINSI;
   |SIGUE;

   |SI nLong ! 4; |Y nLong ! 0;
       NumMes = Comodin;
   |SINO;
       Comodin = FechaHoy % 0402; NumMes = Comodin;
   |FINSI;

   |SI NumMes = 1;  |O NumMes = 3;  |O NumMes = 5; |O NumMes = 7; |O NumMes = 8;
       |O NumMes = 10; |O NumMes = 12;
           DiasMes = 31;
   |SINO;
       |SI NumMes = 2;
           DiasMes = 28;
       |SINO;
           DiasMes = 30;
       |FINSI;
   |FINSI;

   Comodin = #0#3; |QBF Comodin;
   aLong = Comodin % 0; nLong = aLong;
   |SI nLong = 4;
       Comodin = (("00" + DiasMes) % -102) + "." + (("00" + NumMes) % -102) + "." + Comodin;
   |SINO;
       Comodin = enEjercicio;  |QBF Comodin;
       Comodin = (("00" + DiasMes) % -102) + "." + (("00" + NumMes) % -102) + "." + Comodin;
       |HAZ NombreMes; NombreMes = NombreMes > NombreMes;
       Comodin1 = #210#21; |QBF Comodin1;
       #0#31 = Comodin1 + " " + NombreMes;
       |PINTA #0#31;
   |FINSI;

   #0#2 = Comodin; |PINTA #0#2;
|FCAL;

|CALCULO Tipo7C55; |TIPO 7;
   efRNomina  = #0#2;
   enRLaboral = #0#55;
   eaTrans    = #0#56;
   |SI HayLaboral = 1;
       eaCodNif = #0#1;
       |HAZ eBuscaRLaboral;
       |SI ModoEntrada = 1;
           #0#55 = enRLaboral; |PINTA #0#55;
           #0#56 = eaTrans;    |PINTA #0#56;
       |FINSI;
   |FINSI;
|FCAL;

|CALCULO AntesDesc; |TIPO 7;
   DescAnt = #0#31;
|FCAL;

|CALCULO RellenaCptos; |TIPO 0;

   || ModoEntrada = (FEntrada / 100) ! 0;

   |SI ModoEntrada ! 1; |Y #0#31 = DescAnt; |ACABA; |FINSI;
   aAlfa1 = #0#31 % 101;
   |QBF DescAnt;
   |PARA Cont = 7; |SI Cont [ 46; |HACIENDO Cont = Cont + 4;
         |SI Cont = 27; Cont = 35; |FINSI;
         |SI Cont = 39; Cont = 42; |FINSI;
         Calc = Cont + 1;
         Comodin = #0Calc;
         Comodin = Comodin - DescAnt; |QBF Comodin;
         |SI aAlfa1 = " ";
             Comodin = Comodin + #0#31;
         |SINO;
             Comodin = Comodin + " " + #0#31;
         |FINSI;
         #0Calc  = Comodin; |PINTA #0Calc;
   |SIGUE;
   DescAnt = "";
|FCAL;

|CALCULO Cuenta; |TIPO 6;
     |C_M #0Campo,0,alfa1;
     |SI alfa1 = "N"; |ACABA; |FINSI;

     eaCuenta = #0Campo;
     salidas  = FSalida;
     |HAZ FiltraPuntos;
     #0Campo = eaCuenta;
     |PINTA #0Campo;
|FCAL;

|CALCULO CueFin; |TIPO 0;
     |C_M #0Campo,0,alfa1;
     |SI alfa1 = "N"; |ACABA; |FINSI;

     emCta    = 1;
     eaCuenta = #0Campo;
     |HAZ SacaNivel;
     |SI eswCta ! 0;  |ACABA; |FINSI;  ||Cuenta erronea

     |HAZ LeeCuenta;
|FCAL;

|| -------------------------------------------------------------------
|PROCESO MiraActDep; |TIPO 7;
   |C_M #0Campo, 0, alfa1;
   |SI alfa1 = "S"
      |SI Haybasica = 1;
          |MENSA "    <F2> Consultar Actividades";
      |SINO;
          |MENSA "    <F2> Consultar Departamentos";
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO MiraActiv;
   |SI eaDepar = "N"; |ACABA; |FINSI;
   eOpDep = 0; || 1 = Consulta pantalla
   |SI FSalida = 10; eOpDep = 1;  |FINSI;
   enActividad = #0#27;
   eaCodDep    = #0#27;
   |HAZ Actividad;
   |SI eswLect = 1;
       |MENAV "    Error.! No Existe Actividad / Departamento";
       |ERROR;
   |SINO;
       #0#27 = eaCodDep; |PINTA #0#27;
       #0#28 = eaNombreAct; |PINTA #0#28;

       |HAZ PintaFecha;
       |SI efActFin > "01.01.1900"; |Y snFilBa = "S";
          aAlfa1 = "    NAtencion!!!. Actividad con Fecha de BAJA " + efActFin + ", Desea introducir Facturas ? ";
          |CONFI aAlfa1;
          |SI FSalida ! 0;
              |ERROR;
              |ACABA;
          |FINSI;
      |FINSI;
      |SI eaEsCom = "S";
          |CONFI "    NAtencion!!!. Actividad Comunera, ¨ Desea introducir Movimientos ? ";
          |SI FSalida ! 0;
              |ERROR;
              |ACABA;
          |FINSI;
      |FINSI;
   |FINSI;
   |MENSA "                             ";
|FPRC;

|PROCESO PintaFecha;
    alfa1 = &205; alfa1 = alfa1 * 40;
    |PINTA 0526, alfa1;
    #cafantas#10 = efActIni;
    #cafantas#11 = efActFin;
    |SI efActIni > "01.01.1900";
        |ATRI S; |PINTA 0526, "F.Inicio: "; |ATRI 0;
        |PINTA 0536, #cafantas#10;
    |FINSI;
    |SI efActFin > "01.01.1900";
        |ATRI S; |PINTA 0547, "F.Fin: "; |ATRI 0;
                 |PINTA 0554, #cafantas#11;
    |FINSI;
|FPRC;

|CALCULO El13;
    alfa1 = &205; alfa1 = alfa1 * 40;
    |PINTA 0526, alfa1;
    ||  ModoEntrada = (FEntrada / 100) ! 0;
    |SI ModoEntrada  [ 1; |ACABA; |FINSI;
    |SI eaDepar = "S";
       eOpDep = 0;
       enActividad = #0#27;
       eaCodDep    = #0#27;
       |HAZ Actividad;
       |HAZ PintaFecha;
   |FINSI;
|FCAL;

|CALCULO AntesSubde; |TIPO 7;
   |C_M #0Campo, 0, alfa1;
   |SI alfa1  = "S";
      |SI Haybasica = 1;
          |SI enArrend = 1;
              |MENSA "    Subdepartamento. <F2> Consultar Referencias Catastrales";
          |SINO;
              |MENSA "    Subdepartamento. <F2> Consultar Cultivos";
          |FINSI;
      |FINSI;
   |FINSI;
|FCAL;

|CALCULO TrasSubde; |TIPO 0;
   |SI eaSubde = "N"; |ACABA; |FINSI;

   eOpSub = 0; || 1 = Consulta pantalla
   |SI FSalida = 10; eOpSub = 1;  |FINSI;
   enConcepto  = #0#7;
   eaCodSubdep = #0#29;
   enQue = 1;
   |HAZ SubActividad;
   enQue = 0;
   |SI eswLect = 1;
       |MENAV "    Error.! No Existe SubDepartamento";
       |ERROR;
   |SINO;
       #0#29 = eaCodSubdep; |PINTA #0#29;
       #0#30 = eaNomSubdep; |PINTA #0#30;
   |FINSI;
|FCAL;


||-------------------------------------------------------------------------

|CALCULO AntesConcepto; |TIPO 7;
   ConceptAnt = #0Campo;
|FCAL;

|CALCULO TrasConcepto; |TIPO 0;

   |C_M #0Campo, 0, alfa1;
   || ModoEntrada = (FEntrada / 100 ) ! 0;

   |SI FSalida = 10;
       eaFiCon = aFich1;
       enConcepto = #0Campo;
       |HAZ VerConcepto;
       #0Campo = enConcepto; |PINTA #0Campo;
   |FINSI;
   eaCuenta   = "";
   enLibIVA   = #0#32;
   enFilConc  = 1;          || Concepto de NO IVA
   enConcepto = #0Campo;
   |HAZ FiltroConcepto;  |SI eswLect ! 0; |ACABA; |FINSI;
   nume1 = Campo + 1;
   |SI #0Campo ! ConceptAnt;
       #0nume1 = #dsmom030#1; |PINTA #0nume1;
   |FINSI;
|FCAL;

|| ............................................
|PROCESO LineasIRPF;
   #0#38 = #0#38 + #caplala2#8;
   #0#39 = #0#39 + #caplala2#6;
   |SI #caplala2#4 = "S"; #0#18 = #0#18 + #caplala2#6; |FINSI;  || la base
|FPRC;

|DEFBUCLE LineasIRPF;
 #caplala2#1;
 ;
 #0#0,001;
 #0#0,999;
 ;
 NULL,LineasIRPF;
|FIN;

|PROCESO Calcula;
   #0#6 = #0#6 + #caplala3#7;
   |SI #caplala3#9 = "E"; #0#18 = #0#18 + #caplala3#7; |FINSI;
|FPRC;

|DEFBUCLE Calcula;
 #caplala3#1;
 ;
 #0#0,#0#1,001;
 #0#0,#0#1,999;
 ;
 NULL,Calcula;
|FIN;

|CALCULO CalculaTotales; |TIPO 0;

   nTecla = FSalida;
   |SI #210#42 = "S";
       #0#18 = 0;
       #0#6  = 0;
       |BUCLE Calcula;
       nTotal = #0#6;
       |PINTA #0#6;
       |PINTA #0#18;
   |FINSI;

   |SI Campo = 6;
       |SI #210#42 = "S";
           |HAZ DesgDevengos;
       |FINSI;
   |FINSI;

   #0#38 = 0; #0#22 = #0#6; #0#18 = 0;
   #0#39 = 0;
   |BUCLE LineasIRPF;

   #0#22 = #0#6  - (#0#18 + #0#41 + #0#45)  - #0#10;
   #0#22 = #0#22 - #0#34 - #0#14 - #0#38;

   |PINTA #0#6;  |PINTA #0#18; |PINTA #0#41;
   |PINTA #0#45; |PINTA #0#22; |PINTA #0#38;
|FCAL;

|PROCESO MiraNoCero;
   |SI nTecla = 2; |ACABA; |FINSI;
   |SI #0Campo = 0;
      |MENAV "    Introduzca un importe";
      |ERROR;
   |FINSI;
|FPRC;

|PROCESO AntesDevengado; |TIPO 7;
   |MENSA "                          ";
   |SI #210#42 = "S";
       |C_M #0#6,1,"N";
   |SINO;
       |C_M #0#6,1,"S";
       |SI #210#42 = "C"; |Y #0#40 ! 0;
           #0#9 = aCtaCentro; |PINTA #0#9;
       |FINSI;
       |SI #210#42 = "A";
           #0#9 = aCtaAreaSec; |PINTA #0#9;
       |FINSI;
   |FINSI;
   aAlfa1 = #0#9; |QBF aAlfa1;
   |SI aAlfa1 = ""; |C_M #0#9,1,"S"; |FINSI;
|FPRC;


|CALCULO DespuesArea; |TIPO 0;
      |C_M #0Campo,0,aAlfa1;
      |SI aAlfa1 = "N"; |ACABA; |FINSI;

      nTecla = FSalida;
      eOpCen = 0;
      |SI nTecla  = 10; eOpCen = 1; |FINSI;
      eaArea = #0#50;
      |HAZ AreaTrabajo;
      |SI eswLect = 1;
          |ERROR;
      |SINO;
          #0#50 = eaArea; |PINTA #0#50;
      |FINSI;
|FCAL;

|CALCULO DespuesSeccion;

      nTecla = FSalida;
      eOpCen = 0;
      |SI nTecla  = 10; eOpCen = 1; |FINSI;
      aCtaAreaSec = "";
      aAnaAreaSec = "";
      eaArea    = #0#50;
      eaSeccion = #0#51;
      |HAZ SecTrabajo;
      |SI eswLect = 1;
          |ERROR;
      |SINO;
          #0#50 = eaArea;    |PINTA #0#50;
          #0#51 = eaSeccion; |PINTA #0#51;
      |FINSI;
      |ABRE #212;
      #212#0 = eaArea;
      #212#1 = eaSeccion;
      |SI nRef = 1; #212#6 = #0#40; |FINSI;
      |LEE 001#212=;
      |SI FSalida ! 0;
          #212#3 = #210#1;
          #212#5 = "";
       |FINSI;
       |CIERRA #212;
       aCtaAreaSec = #212#3;
       aAnaAreaSec = #212#5;
      |ABRE #214;
      #214#0 = eaArea;
      #214#1 = eaSeccion;
      |SI nRef = 1; #214#10 = #0#40; |FINSI;
      |LEE 001#214=;
      |SI FSalida ! 0;
          #214#3 = #210#4;
       |FINSI;
       |CIERRA #214;
       aCtaAreaSe1 = #214#3;
       |SI #210#42  = "A";  #0#9 = aCtaAreaSec; |PINTA #0#9; |FINSI;
       |SI #210#106 = "A";  #0#13 = aCtaAreaSe1; |PINTA #0#13; |FINSI;
|FCAL;

|| -------------------------------------------------------------

|PROCESO ActLineas; |TIPO 2;
   #0#39 = #0#39 +. #caplala2#6;     |PINTA 2235, #0#39;
   #0#38 = #0#38 +. #caplala2#8;     |PINTA 2266, #0#38;
   |SI #caplala2#4 = "S"; #0#18 = #0#18 +. #caplala2#6; |FINSI;
|FPRC;

|PROCESO CalculoLineas;
   #caplala2#8  = #caplala2#6 % #caplala2#7;       |PINTA #caplala2#8;
|FPRC;

|PROCESO RellenaConc;
   #caplala3#0 = #0#0;
   #caplala3#1 = #0#1;
   #caplala3#2 = #10#0;
   |LEE 000#caplala3.=;
   |SI FSalida ! 0;
      |DDEFECTO #caplala3;
      #caplala3#0 = #0#0;
      #caplala3#1 = #0#1;
      #caplala3#2 = #10#0;
      #caplala3#3 = #10#1;
      #caplala3#4 = #10#3;
      #caplala3#5 = #10#4;
      #caplala3#6 = #10#2;
      #caplala3#8 = #10#5;
      #caplala3#9 = #10#6;
      #caplala3#10 = #10#8;
      |GRABA 020#caplala3.n;
   |FINSI;
|FPRC;

|DEFBUCLE RellenaConc;
 #10#1001;
 ;
 001;
 999;
 ;
 NULL,RellenaConc;
|FIN;

|DEFBUCLE RellenaConcC;
 #10#1002;
 ;
 #0#40, 001;
 #0#40, 999;
 ;
 NULL,RellenaConc;
|FIN;

|PROCESO Tipo2; |TIPO 2;
   nTotal = nTotal +. #caplala3#7;
   #13#0 = nTotal; |PINTA 2264, #13#0;
|FPRC;

|PROCESO Tipo13; |TIPO 13;
   #13#0 = nTotal; |PINTA 2264, #13#0;
|FPRC;

|RUTINA infla3;
   #caplala3#0 = #0#0;
   #caplala3#1 = #0#1;
   #caplala3#2 = 001;
|FRUT;

|RUTINA supla3;
   #caplala3#0 = #0#0;
   #caplala3#1 = #0#1;
   #caplala3#2 = 999;
|FRUT;

|PROCESO DesgDevengos;
   |ABRE #caplala3;
   |SI nRef = 0;
       |BUCLE RellenaConc;
   |SINO;
       |BUCLE RellenaConcC;
   |FINSI;
   |CIERRA #caplala3;

   Comodin = #210#44; |C_M #caplala3#6,1,Comodin;
   Comodin = #210#45; |C_M #caplala3#4,1,Comodin;

   |PUSHV 05012380;
   |ENTLINEAL #1#caplala3, -3, 2, 19, 1, infla3, supla3;
   |POPV;
   #0#18 = 0;
   #0#6  = 0;
   |BUCLE Calcula;
   |PINTA #0#6;
   |PINTA #0#18;
|FPRC;

|RUTINA infla1;
   #caplala2#0 = #0#0;
   #caplala2#1 = 1;
|FRUT;

|RUTINA supla1;
   #caplala2#0 = #0#0;
   #caplala2#1 = 999;
|FRUT;

|PROCESO TotalIRPF;
   |SI FSalida = 10;
      |PUSHV 1122 2279;
      #0#38 = 0; #0#22 = #0#6; #0#18 = 0;
      #0#39 = 0;
      |BUCLE LineasIRPF;
      |ENTLINEAL #1#caplala2,-2,2,20,1,infla1,supla1;
      |POPV;
      #0#38 = 0; #0#22 = #0#6; #0#18 = 0;
      #0#39 = 0;
      |BUCLE LineasIRPF;
   |FINSI;
|FPRC;

|PROCESO PintaDatos; |TIPO 13;
   |PINTA 2235, #0#39;
   |PINTA 2266, #0#38;
   |HAZ El13;
|FPRC;


|PROCESO AntesConc; |TIPO 7;
   ConceptAnt = #caplala3#4;
|FPRC;

|PROCESO TrasConc;
   |C_M #caplala3#4,0,alfa1;

   || ModoEntrada = (FEntrada / 100 ) ! 0;

   |SI FSalida = 10;
       eaFiCon = aFich1;
       enConcepto = #caplala3#4;
       |HAZ VerConcepto;
       #caplala3#4 = enConcepto; |PINTA #caplala3#4;
   |FINSI;
   eaCuenta   = "";
   enLibIVA   = #0#32;
   enFilConc  = 1;          || Concepto de NO IVA
   enConcepto = #caplala3#4;
   |HAZ FiltroConcepto;  |SI eswLect ! 0; |ACABA; |FINSI;
   |SI ModoEntrada = 1; |O #caplala3#4 ! Contenido;
       #caplala3#5 = #dsmom030#1; |PINTA #caplala3#5;
   |FINSI;
|FPRC;

|CALCULO Cuenta_1; |TIPO 6;
     |C_M #1Campo, 0, alfa1;
     |SI alfa1 = "N"; |ACABA; |FINSI;
     eaCuenta = #1Campo;
     salidas  = FSalida;
     |HAZ FiltraPuntos;
     #1Campo = eaCuenta;
     |PINTA #1Campo;
|FCAL;

|CALCULO CueFin_1; |TIPO 0;
     |C_M #1Campo, 0, alfa1;
     |SI alfa1 = "N"; |ACABA; |FINSI;
     emCta    = 1;
     eaCuenta = #1Campo;
     |HAZ SacaNivel;
     |SI eswCta ! 0;  |ACABA; |FINSI;  ||Cuenta erronea

     |HAZ LeeCuenta;
|FCAL;

|PROCESO Repercute; |TIPO 7;
     |SI #caplala2#4 = "S";
          |C_M #caplala2#5, 1, "S";
     |SINO;
          #caplala2#5 = "N";
          |PINTA #caplala2#5;
          |C_M #caplala2#5, 1, "N";
     |FINSI;
|FPRC;

|PROCESO DefectoLinea;
||   |HAZ LeeDefLab;

   |SI #caplala2#1 ! 2; |O #210#111 = doce;
       #caplala2#2 = #210#17;                     || Concepto IRPF
       Comodin = #210#18; |QBF Comodin;
       Comodin = Comodin + #caplala1#31; |QBF Comodin;
       #caplala2#3 = Comodin;                     || Descripcion IRPF
       #caplala2#9 = #210#16;                     || Cuenta IRPF
       |PINTA #caplala2#2; |PINTA #caplala2#3; |PINTA #caplala2#9;

       Comodin = #210#39; |QBF Comodin; |C_M #caplala2#9,1,Comodin;
       Comodin = #210#40; |QBF Comodin; |C_M #caplala2#2,1,Comodin;
       Comodin = #210#41; |QBF Comodin; |C_M #caplala2#3,1,Comodin;
   |SINO;
       #caplala2#2 = #210#112;                     || Concepto IRPF
       Comodin = #210#113; |QBF Comodin;
       Comodin = Comodin + #caplala1#31; |QBF Comodin;
       #caplala2#3 = Comodin;                     || Descripcion IRPF
       #caplala2#9 = #210#111;                     || Cuenta IRPF
       |PINTA #caplala2#2; |PINTA #caplala2#3; |PINTA #caplala2#9;

       Comodin = #210#114; |QBF Comodin; |C_M #caplala2#9,1,Comodin;
       Comodin = #210#115; |QBF Comodin; |C_M #caplala2#2,1,Comodin;
       Comodin = #210#116; |QBF Comodin; |C_M #caplala2#3,1,Comodin;
   |FINSI;
|FPRC;

|CALCULO Cuenta_2; |TIPO 6;
     |C_M #9Campo, 0, alfa1;
     |SI alfa1 = "N"; |ACABA; |FINSI;
     eaCuenta = #9Campo;
     salidas  = FSalida;
     |HAZ FiltraPuntos;
     #9Campo = eaCuenta;
     |PINTA #9Campo;
|FCAL;

|CALCULO CueFin_2; |TIPO 0;
     |C_M #9Campo, 0, alfa1;
     |SI alfa1 = "N"; |ACABA; |FINSI;
     emCta    = 1;
     eaCuenta = #9Campo;
     |HAZ SacaNivel;
     |SI eswCta ! 0;  |ACABA; |FINSI;  ||Cuenta erronea

     |HAZ LeeCuenta;
|FCAL;

|PROCESO TomaDef_Centro;
   #0#7  = #210#2;  || Concepto Total Devengado
   #0#8  = #210#3;  || Descripcion Total Devengado
   #0#9  = #210#1;  || Cuenta Total Devengado

   #0#11 = #210#5;  || Concepto Aportacion S.S.
   #0#12 = #210#6;  || Descripcion Aportacion S.S.
   #0#13 = #210#4;  || Cuenta Aportacion S.S.

   #0#15 = #210#8;  || Concepto Anticipos
   #0#16 = #210#9;  || Descripcion Anticipos
   #0#17 = #210#7;  || Cuenta Anticipos

   #0#19 = #210#11; || Concepto En especie 908
   #0#20 = #210#12; || Descr. En especie
   #0#21 = #210#10; || Cuenta En especie

   #0#19 = #210#11; || Concepto En especie 908
   #0#20 = #210#12; || Descr. En especie
   #0#21 = #210#10; || Cuenta En especie

   #0#42 = #210#64; || Concepto En especie 922
   #0#43 = #210#65; || Descr. En especie
   #0#44 = #210#63; || Cuenta En especie

   #0#46 = #210#70; || Concepto En especie 923
   #0#47 = #210#71; || Descr. En especie
   #0#48 = #210#69; || Cuenta En especie

   #0#23 = #210#14; || Concepto Liquido
   #0#24 = #210#15; || Descr. Liquido
   #0#25 = #210#13; || Cuenta Liquido

   #0#35 = #210#50; || Concepto Otras deducciones
   #0#36 = #210#51; || Descr. Otras deducciones
   #0#37 = #210#49; || Cuenta Otras Deducciones

   #0#32 = #210#19; || Libro
   #0#33 = #210#54; || Diario

   #0#31 = #210#21; || Descripcion general

   #0#27 = #210#22; || Departamento
   #0#28 = #210#23; || Nombre Departamento
   #0#29 = #210#57; || subdepartamento
   #0#30 = #210#58; || Nombre suddepartamento

   #0#3  = UltPeriodo; |PINTA #0#3;
   #0#50 = #210#102;
   #0#51 = #210#104;

   |PINDA #0#0;

   |HAZ TomaDefMod_Centro;
|FPRC;

|PROCESO TomaDefMod_Centro;

   |SI eaDepar = "N"; #210#52 = "N"; |FINSI;
   |SI eaSubde = "N"; #210#59 = "N"; |FINSI;

   Comodin = #210#24; |C_M #0#9 ,1,Comodin;
   Comodin = #210#25; |C_M #0#7 ,1,Comodin;
   Comodin = #210#26; |C_M #0#8 ,1,Comodin;

   Comodin = #210#27; |C_M #0#13,1,Comodin;
   Comodin = #210#28; |C_M #0#11,1,Comodin;
   Comodin = #210#29; |C_M #0#12,1,Comodin;

   Comodin = #210#30; |C_M #0#17,1,Comodin;
   Comodin = #210#31; |C_M #0#15,1,Comodin;
   Comodin = #210#32; |C_M #0#16,1,Comodin;

   Comodin = #210#33; |C_M #0#21,1,Comodin;
   Comodin = #210#34; |C_M #0#19,1,Comodin;
   Comodin = #210#35; |C_M #0#20,1,Comodin;

   Comodin = #210#36; |C_M #0#25,1,Comodin;
   Comodin = #210#37; |C_M #0#23,1,Comodin;
   Comodin = #210#38; |C_M #0#24,1,Comodin;

   Comodin = #210#46; |C_M #0#35,1,Comodin;
   Comodin = #210#47; |C_M #0#36,1,Comodin;
   Comodin = #210#48; |C_M #0#37,1,Comodin;

   Comodin = #210#61; |C_M #0#40,1,Comodin;
   Comodin = #210#43; |C_M #0#32,1,Comodin;
   Comodin = #210#56; |C_M #0#33,1,Comodin;
   Comodin = #210#53; |C_M #0#26,1,Comodin;
   Comodin = #210#52; |C_M #0#27,1,Comodin;
   Comodin = #210#59; |C_M #0#29,1,Comodin;

   Comodin = #210#67; |C_M #0#42,1,Comodin;
   Comodin = #210#68; |C_M #0#43,1,Comodin;
   Comodin = #210#66; |C_M #0#44,1,Comodin;

   Comodin = #210#73; |C_M #0#46,1,Comodin;
   Comodin = #210#74; |C_M #0#47,1,Comodin;
   Comodin = #210#72; |C_M #0#48,1,Comodin;

   Comodin = #210#103;
   |SI Comodin = "X";
       Comodin = "N";
       #0#50 = ""; |PINTA #0#50;
       #0#51 = ""; |PINTA #0#51;
  |FINSI;
  |C_M #0#50,1,Comodin;
  |C_M #0#51,1,Comodin;
|FPRC;
