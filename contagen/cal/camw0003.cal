|FICHEROS;
   camw0001 #0;
   camw0003 #3,MANTE;
   camw0004 #4,MANTE;

   :/modelos/def/dsmom030 #130;

   canempre #30;
|FIN;

|VARIABLES;
   aAlfa1 = "";
   aAlfa2 = "";
   aAlfa3 = "";
   nPara1 = 0;
   nPara2 = 0;
   nNume1 = 0;
   nNume2 = 0;
   nNume3 = 0;
   nNume4 = 0;
   nCampo = 0;
   &nSw4  = 0;
   nModoEntrada = 0;
|FIN;

|INCLUYE dscont_i;

|| ******************************************** Calculos Pantalla
|| ******* Calculos mw0004
|CALCULO losdefectos; |TIPO 0;
 nModoEntrada = (FEntrada / 100) ! 0;
 |SI nModoEntrada = 1;
     #4#4 = 600;
     |SI #4#1 = "R";  #4#4 = 700; |FINSI;
     |PINTA #4#4;
 |FINSI;
|FCAL;


|CALCULO TrasConcepto4;  |TIPO 0;
   |SI FSalida = 10;
       enConcepto = #4Campo;
       |HAZ VerConcepto30;
       #4Campo = enConcepto; |PINTA #4Campo;
   |FINSI;
   eaCuenta  = "";
   enFilConc = 0;
   enConcepto = #4Campo;
   |HAZ FiltroConcepto;  |SI eswLect ! 0; |ACABA; |FINSI;
   |SI Campo = 14;
       #4#15 = #dsmom030#1; |PINTA #4#15;
   |FINSI;
|FCAL;

|CALCULO LaXRet; |TIPO 0;
 aAlfa1 = #4Campo;
 |SI aAlfa1 = "X";
     #4#8   = 0;   |PINTA #4#8;
     #4#9   = "X"; |PINTA #4#9;
     #4#16  = "="; |PINTA #4#16;
     aAlfa1 = "N";
 |FINSI;
 |C_M #4#8,1,aAlfa1;
 |C_M #4#9,1,aAlfa1;
 |C_M #4#16,1,aAlfa1;
|FCAL;

|CALCULO LaXCan; |TIPO 0;
 aAlfa1 = #4Campo;
 |SI aAlfa1 = "X";
     #4#11 = 0;  |PINTA #4#11;
     aAlfa1 = "N";
 |SINO;
     aAlfa1 = "S";
 |FINSI;
 |C_M #4#11,1,aAlfa1;
|FCAL;

|CALCULO LaXCta; |TIPO 0;
 aAlfa1 = #4Campo;
 |SI aAlfa1 = "X";
     #4#13 = "";  |PINTA #4#13;
     aAlfa1 = "N";
 |SINO;
     aAlfa1 = "S";
 |FINSI;
 |C_M #4#13,1,aAlfa1;
|FCAL;

|CALCULO LaXIVA; |TIPO 0;
 aAlfa1 = #4Campo;
 |SI aAlfa1 = "X";
     #4#18 = 0;  |PINTA #4#18;
     aAlfa1 = "N";
 |SINO;
     aAlfa1 = "S";
 |FINSI;
 |C_M #4#18,1,aAlfa1;
|FCAL;

|| //////////////////// Calculos de Pantalla \\\\\\\\\\\\\\\\\\\\\\\\\\
|RUTINA ClaveBajaAxE;
 #4#0 = #3#0;
 #4#1 = #3#1;
 #4#2 = #3#2;
 #4#3 = 01;
|FRUT;

|RUTINA ClaveAltaAxE;
 #4#0 = #3#0;
 #4#1 = #3#1;
 #4#2 = #3#2;
 #4#3 = 99;
|FRUT;

|CALCULO elTipo3W3; |TIPO 3;
  |ENTLINEAL #1#4, -4, 2, 22, 0, ClaveBajaAxE, ClaveAltaAxE;
|FCAL;

|CALCULO Mirootro; |TIPO 7;
 |SI nSw4 = 1;
     nModoEntrada = (FEntrada / 100) ! 0;
     |SI nModoEntrada > 1;
         |ENTLINEAL #1#4, -4, 7, 22, 0, ClaveBajaAxE, ClaveAltaAxE;
     |SINO;
         |PINPA #0#4;
     |FINSI;
 |FINSI;
|FCAL;


|PROCESO BorroW04;
 |BORRA 020#4a;
 |LIBERA #4;
|FPRC;

|DEFBUCLE BorroW04;
 #4#1;
 ;
 #3#0,#3#1,#3#2,001;
 #3#0,#3#1,#3#2,999;
 be;
 NULL, BorroW04;
|FIN;

|CALCULO elTipo1W3; |TIPO 1;
 nModoEntrada = (FEntrada / 100) ! 0;
 |SI nModoEntrada = 3;

     |BUCLE BorroW04;

 |FINSI;
|FCAL;

|CALCULO eltipo; |TIPO 0;
 |SI #3#1 = "R"; #3#4 = "REPERCUTIDO"; |FINSI;
 |SI #3#1 = "S"; #3#4 = "SOPORTADO"; |FINSI;
 |PINTA #3#4;
|FCAL;

|CALCULO Parrilla; |TIPO 0;
     |SI #3#5 = 0;
         #3#5 = 0;  |PINTA #3#5;
         #3#6 = 0;  |PINTA #3#6;  |C_M #3#6, 1, "N";
         |PARA nCampo = 7;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
               |C_M #3nCampo, 1, "S";
         |SIGUE;
     |SINO;
         |SI enEmpresa = 0;
             |C_M #3#5, 1, "S";
             |C_M #3#6, 1, "S";
         |FINSI;

         |PARA nCampo = 7;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
               |C_M #3nCampo, 1, "N";
               #3nCampo = 0;  |PINTA #3nCampo;
         |SIGUE;
     |FINSI;
|FCAL;

|CALCULO NoMasEmpresas; |TIPO 0;
     |SI #3Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
               #3nCampo = 0;  |C_M #3nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
               |C_M #3nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FCAL;

|CALCULO SelTipo0; |TIPO 0;
 |SI #3#40 = "N";
     #3#28 = 0;  |PINTA #3#28;  |C_M #3#28, 1, "N";
     #3#29 = 99; |PINTA #3#29;  |C_M #3#29, 1, "N";
     |PARA nCampo = 30;  |SI nCampo [ 39;  |HACIENDO nCampo = nCampo + 1;
           |C_M #3nCampo, 1, "S";
     |SIGUE;
 |SINO;
     |C_M #3#28, 1, "S";
     |C_M #3#29, 1, "S";
     |PARA nCampo = 30;  |SI nCampo [ 39;  |HACIENDO nCampo = nCampo + 1;
           |C_M #3nCampo, 1, "N";
           #3nCampo = 0;  |PINTA #3nCampo;
     |SIGUE;
 |FINSI;
|FCAL;

|CALCULO SelTipo1;
 |SI #3Campo = 0;
     |PARA nCampo = Campo + 1;  |SI nCampo [ 39;  |HACIENDO nCampo = nCampo + 1;
           #3nCampo = 0;  |C_M #3nCampo, 1, "N";
     |SIGUE;
 |SINO;
     |PARA nCampo = Campo + 1;  |SI nCampo [ 39;  |HACIENDO nCampo = nCampo + 1;
           |C_M #3nCampo, 1, "S";
     |SIGUE;
 |FINSI;
|FCAL;
