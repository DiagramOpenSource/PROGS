|| ///// Carga de Auxiliar de Modelos
||... Incorporado de forma especial el modelo 202, hasta que este en la
||    aplicacion de modelos
|| ======================================
|FICHEROS;
     caw00098 #901;
     caw00099 #902;
     referen@ #1000;
|FIN;

|VARIABLES;
     &eaTabMod  = "";
     aQueQuiero = "";
     aTitulo    = "";
     aNumCampos = "";
     nNumCampos = 0;
     nCampos    = 0;
     aNombCampo = "";
     aTipoCampo = "";
     aLongCampo = "";
     nSwNuest   = 0;
     nNoClave   = 0;
     nSumoLiq   = 0;

     aAlfa     = "";
     aCadena   = "";
     aAlfa1    = "";
     aAlfa2    = "";
     aDirBase  = "";
     aDirInicio = "";
     aFichero  = "";
     aMas      = "";
     nContador = 0;
     nLong     = 0;
     nCaracter = 0;
     nPosi     = 0;
     nPtec     = 0;
     nSwSalir  = 0;
     nCodig    = 0;
     &enwModAu = 0;
     &enQueRen = 0;
     &enQueSoc = 0;
     aRenta    = "";
     aFich     = "";
     nEjercicio = 0;
|FIN;

|| *************************************************************************
|PROCESO CargaTemporal;
     aMas  = aDirInicio + "modelos/def/" + aFichero;
     |SI nContador = 202; |O nContador = 200; |O nContador = 225;
         aMas  = aDirInicio + "contasoc/def/" + aFichero;
     |FINSI;

     |CARGA_DEF aMas, referen@;
     |SI FSalida ! 0;
         ||  ... |MENAV  "         Error en cargar el Def ";
         |ACABA;  || No existen modelos o contasoc
     |FINSI;

     aQueQuiero = "|TITULO";
     aTitulo    = #referen@#aQueQuiero#;  |QBF aTitulo;

     nNoClave  = 6;
     |SI nContador = 202; |O nContador = 200; |O nContador = 225; nNoClave = 2; |FINSI;
     |SI nContador = 202; |Y nEjercicio ] 2010; nNoClave = 4; |FINSI;

     #901#0    = nContador;
     #901#4    = aFichero;
     #901#5    = "modelos";
     |SI nContador = 202; |O nContador = 200; |O nContador = 225; #901#5 = "contasoc"; |FINSI;
     #901#6    = aTitulo;

     aQueQuiero = "|NC";
     aNumCampos = #referen@#aQueQuiero#;
     nNumCampos = aNumCampos;
     nNumCampos = nNumCampos - 1;
     |PARA nCampos = nNoClave;  |SI nCampos [ nNumCampos;  |HACIENDO nCampos = nCampos + 1;
           aQueQuiero = "|C" + (("000" + nCampos) % -103) + "NOMBRE";
           aNombCampo = #referen@#aQueQuiero#;

           aQueQuiero = "|C" + (("000" + nCampos) % -103) + "TIPO";
           aTipoCampo = #referen@#aQueQuiero#;

           |SI aTipoCampo = "N";
               aQueQuiero = "|C" + (("000" + nCampos) % -103) + "LONGITUD";
               aLongCampo = #referen@#aQueQuiero#;

               #901#1 = nCampos + nSumoLiq;
               #901#2 = aNombCampo;
               #901#3 = aLongCampo;
               |GRABA 020#901n;
               |LIBERA #901;
           |FINSI;
     |SIGUE;
     |DESCARGA_DEF #referen@;
|FPRC;
|| **************************************************************************

|PROCESO LasCasillas0;
 #902#0 = nContador;
 #902#1 = #referen@#0;
 #902#2 = #referen@#2;
 |LEE 101#902=;
 |SI FSalida ! 0;
     |DDEFECTO #902;
     #902#0 = nContador;
     #902#1 = #referen@#0;
     #902#2 = #referen@#2;
     |GRABA 020#902b;
 |FINSI;
 #902#3 = #referen@#3;
 #902#4 = 6;                    || campo numero de las lineas
 #902#5 = aFichero;
 #902#6 = aRenta;
 #902#7 = aTitulo;
 #902#8 = "rem01001";  ||Cabecera ... Atencion a¤os siguientes
 #902#9 = "rem01002";  ||Lineas ..... Atencion a¤os siguientes
 |GRABA 020#902a;
 |LIBERA #902;
|FPRC;

|DEFBUCLE LasCasillas;
 #referen@#1002;
 ;
 00, 000;
 99, 999;
 e;
 NULL, LasCasillas0;
|FIN;

|PROCESO CargaOtroTemp;
     aRenta = "";
     |SI enQueRen = 2000;
         aRenta = "ren2000";
         aMas  = aDirInicio + "ren2000/def/" + aFichero;
         aFich = aDirInicio + "ren2000/fich/";
     |FINSI;

     |SI enQueRen = 2001;
         aRenta = "ren2001";
         aMas  = aDirInicio + "ren2001/def/" + aFichero;
         aFich = aDirInicio + "ren2001/fich/";
     |FINSI;

     |SI enQueRen = 2002;
          aRenta = "ren2002";
          aMas  = aDirInicio + "ren2002/def/" + aFichero;
          aFich = aDirInicio + "ren2002/fich/";
     |FINSI;

     |SI enQueRen = 2003;
          aRenta = "ren2003";
          aMas  = aDirInicio + "ren2003/def/" + aFichero;
          aFich = aDirInicio + "ren2003/fich/";
     |FINSI;

     |SI enQueRen = 2004;
          aRenta = "ren2004";
          aMas  = aDirInicio + "ren2004/def/" + aFichero;
          aFich = aDirInicio + "ren2004/fich/";
     |FINSI;

     |SI enQueRen = 2005;
          aRenta = "ren2005";
          aMas  = aDirInicio + "ren2005/def/" + aFichero;
          aFich = aDirInicio + "ren2005/fich/";
     |FINSI;

     |SI enQueRen = 2006;
          aRenta = "ren2006";
          aMas  = aDirInicio + "ren2006/def/" + aFichero;
          aFich = aDirInicio + "ren2006/fich/";
     |FINSI;

     |SI enQueRen = 2007;
          aRenta = "ren2007";
          aMas  = aDirInicio + "ren2007/def/" + aFichero;
          aFich = aDirInicio + "ren2007/fich/";
     |FINSI;

     |SI enQueRen = 2008;
          aRenta = "ren2008";
          aMas  = aDirInicio + "ren2008/def/" + aFichero;
          aFich = aDirInicio + "ren2008/fich/";
     |FINSI;

     |SI enQueRen = 2009;
          aRenta = "ren2009";
          aMas  = aDirInicio + "ren2009/def/" + aFichero;
          aFich = aDirInicio + "ren2009/fich/";
     |FINSI;

     |SI enQueRen = 2010;
          aRenta = "ren2010";
          aMas  = aDirInicio + "ren2010/def/" + aFichero;
          aFich = aDirInicio + "ren2010/fich/";
     |FINSI;

     |SI enQueRen = 2011;
          aRenta = "ren2011";
          aMas  = aDirInicio + "ren2011/def/" + aFichero;
          aFich = aDirInicio + "ren2011/fich/";
     |FINSI;

     |SI enQueRen = 2012;
          aRenta = "ren2012";
          aMas  = aDirInicio + "ren2012/def/" + aFichero;
          aFich = aDirInicio + "ren2012/fich/";
     |FINSI;

     |SI enQueRen = 2013;
          aRenta = "ren2013";
          aMas  = aDirInicio + "ren2013/def/" + aFichero;
          aFich = aDirInicio + "ren2013/fich/";
     |FINSI;

     |SI enQueRen = 2014;
          aRenta = "ren2014";
          aMas  = aDirInicio + "ren2014/def/" + aFichero;
          aFich = aDirInicio + "ren2014/fich/";
     |FINSI;

     |SI enQueRen = 2015;
          aRenta = "ren2015";
          aMas  = aDirInicio + "ren2015/def/" + aFichero;
          aFich = aDirInicio + "ren2015/fich/";
     |FINSI;

     |SI enQueRen = 2016;
          aRenta = "ren2016";
          aMas  = aDirInicio + "ren2016/def/" + aFichero;
          aFich = aDirInicio + "ren2016/fich/";
     |FINSI;

     |SI enQueRen = 2017;
          aRenta = "ren2017";
          aMas  = aDirInicio + "ren2017/def/" + aFichero;
          aFich = aDirInicio + "ren2017/fich/";
     |FINSI;

     |SI aRenta = "";  |ACABA;  |FINSI;

     |CARGA_DEF aMas, referen@;
     |SI FSalida ! 0;
         || ...  |MENAV  "         Error en cargar el Def ... Proceso Abortado.";
         |ACABA;      ||No existe Renta
     |FINSI;

     aQueQuiero = "|TITULO";
     aTitulo    = #referen@#aQueQuiero#;  |QBF aTitulo;

     |PATH_DAT #referen@#aFich#;
     |BUCLE LasCasillas;

     |DESCARGA_DEF #referen@;
|FPRC;

|| **************************************************************************
|PROCESO CargaAuxModelo;

 |SI enwModAu  = 0;
     eaTabMod = ("zm" + Usuario + "zzzzzzzzz") % 108;
     |NOME_DAT #901 eaTabMod;
     |ABRE #901;  |CIERRA #901;  |DELINDEX #901;

     |DBASS aDirInicio;
     |DBASE aDirBase;

     |ABRE #901;

  nSumoLiq = 0;
     nEjercicio = enQueSoc + 1;

     aFichero = "dsmod110";  nContador = 110; |HAZ CargaTemporal;
     aFichero = "dsmod115";  nContador = 115; |HAZ CargaTemporal;
     aFichero = "dsmod123";  nContador = 123; |HAZ CargaTemporal;
     aFichero = "dsmod130";  nContador = 130; |HAZ CargaTemporal;
     aFichero = "dsmod131";  nContador = 131; |HAZ CargaTemporal;
     aFichero = "dsmod300";  nContador = 300; |HAZ CargaTemporal;
     aFichero = "dsmod309";  nContador = 309; |HAZ CargaTemporal;
     aFichero = "dsmod310";  nContador = 310; |HAZ CargaTemporal;
     aFichero = "dsmod320";  nContador = 320; |HAZ CargaTemporal;
     aFichero = "dsmod330";  nContador = 330; |HAZ CargaTemporal;
     aFichero = "dsmod332";  nContador = 332; |HAZ CargaTemporal;

     nEjercicio = enQueSoc + 1;
     |SI nEjercicio < 2014;
         aFichero = "dsmod303";  nContador = 303; |HAZ CargaTemporal;
     |SINO;
         aFichero = "dsm30301";  nContador = 303; |HAZ CargaTemporal;
     |FINSI;

     aFichero = "dsmod370";  nContador = 370; |HAZ CargaTemporal;

     |SI nEjercicio < 2010;
          aFichero = "isocie29";  nContador = 202; |HAZ CargaTemporal;
     |SINO;
          aFichero = "isom9000";  nContador = 202; |HAZ CargaTemporal;
     |FINSI;

     |SI enQueSoc < 2008;
               aFichero = "isocie58";  nContador = 200; |HAZ CargaTemporal;
         nSumoLiq = 100;
              aFichero = "isocie59";  nContador = 200; |HAZ CargaTemporal;
         nSumoLiq = 100;
              aFichero = "isocie91";  nContador = 225; |HAZ CargaTemporal;
         nSumoLiq = 0;
     |SINO;
          aFichero = "isom0000";  nContador = 200; |HAZ CargaTemporal;
     |FINSI;
     |CIERRA #901;

  |SINO;

     eaTabMod = ("zn" + Usuario + "zzzzzzzzz") % 108;
     |NOME_DAT #902 eaTabMod;
     |ABRE #902;  |CIERRA #902;  |DELINDEX #902;

     |DBASS aDirInicio;
     |DBASE aDirBase;

     |ABRE #902;
     aFichero = "rem00999";  nContador = 714; |HAZ CargaOtroTemp;
     aFichero = "rem01000";  nContador = 100; |HAZ CargaOtroTemp;
     |CIERRA #902;

  |FINSI;
|FPRC;
