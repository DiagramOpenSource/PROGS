|FICHEROS;
   dscom001 #0;
|FIN;

|VARIABLES;
   aAlfa   = "";
   aAlfa1  = "";
   aAlfa2  = "";
   nHandle = 0;
|FIN;

|PROCESO infm001;
   #dscom001#0 = 1;
|FPRC;

|PROCESO supm001;
   #dscom001#0 = 9999999;
|FPRC;

|PROCESO VerNotif; |TIPO 11;
   |SI FSalida = 10;
      aAlfa = #dscom001#4; |QBF aAlfa;
      |XABRE "E", aAlfa, nHandle;
      |SI FSalida ] 0;
         aAlfa1 = ""; |IP_REMOTO aAlfa1; |QBF aAlfa1;
         |SI aAlfa1 ! "";
            aAlfa1 = "c:\DOCUMENTOS\TMP\"; |RMKDIR aAlfa1;
         |SINO;
            aAlfa1 = "c:\DOCUMENTOS\TMP\"; |MKDIR aAlfa1;
         |FINSI;
         aAlfa1 = "";
         |PARA; |SI aAlfa ! ""; |HACIENDO;
            aAlfa2 = aAlfa % -101;
            |SI aAlfa2 = "/"; |O aAlfa2 = "\"; |SAL; |FINSI;
            aAlfa1 = aAlfa2 + aAlfa1;
            aAlfa = aAlfa % -299;
         |SIGUE;
         aAlfa = aAlfa1 - ".txt";
         |SI FSalida = 0; |QBF aAlfa1; aAlfa1 = aAlfa1 + ".txt"; |FINSI;

         aAlfa1 = "c:\DOCUMENTOS\TMP\" + aAlfa1;
         aAlfa  = #dscom001#4; |QBF aAlfa;
         aAlfa2 = ""; |IP_REMOTO aAlfa2; |QBF aAlfa2;
         |SI aAlfa2 ! "";
            |ENVIA_FICHERO aAlfa, aAlfa1;
         |SINO;
            |COPIA_FICHERO aAlfa, aAlfa1;
         |FINSI;
         aAlfa = "cmd " + &34 + "/c START " + aAlfa1 + &34; |RSYSTEM aAlfa;
      |SINO;
         |MENAV "    Ubicaci¢n inexistente";
      |FINSI;
   |FINSI;
|FPRC;

|PROGRAMA;
   |ABRE #dscom001;
   |CLS;
   |CABEZA "Bandeja de salida";

   |PINPA #0#0;
   |ENTLINEAL #1#dscom001, -1, 4, 21, 1, infm001, supm001;
   |CIERRA #dscom001;
|FPRO;
