|FICHEROS;
   cafantas #2;
   caw00044 #998,MANTE;

   &imagen@ #999;
|FIN;

|VARIABLES;
   aFichero   = "";
   &enNumero  = 0;
   &eaEldef   = "";
   &aFitxer   = "";

   &efCamp8   = @;
   &enCamp18  = 0;
   &enCamp9   = 0;
   &enCamp19  = 0;
   &enCamp23  = 0;

   aMas       = "";
   nConNum    = 0;
   nDImporte  = 0;
   nHImporte  = 0;
   aAlfa1     = "";
   aDSigno    = "";
   aHSigno    = "";
|FIN;

|INCLUYE dscont_i;

|PROCESO LeoEspejo;
  enNumero = #999#0;
  nConNum = nConNum + 1;
  #998#0  = #999#0;
  #998#1  = #999#18;   ||Diario
  #998#2  = #999#8;    ||Fecha
  #998#3  = #999#9;    ||Documento
  #998#4  = #999#19;   ||Apuntes

  #998#6  = #999#10;    ||Descripcion
  #998#7  = #999#11;    ||Signo
  #998#9  = #999#20;    ||Departamento
  #998#10 = #999#21;    ||Subdepartamento

  |SI eaEldef = "caextrp2";
      #998#5  = #999#29;    ||Concepto
      |SI #998#7 = "D"; #998#8  = #999#12; |FINSI; || Importe
      |SI #998#7 = "H"; #998#8  = #999#17; |FINSI; || Importe
      #998#11 = #999#46;    ||Contrapartida
      #998#12 = #999#47;    ||Titulo Contrapartida
  |FINSI;
  |SI eaEldef = "caextrp5"; |O eaEldef = "caextrp7";
      #998#5  = #999#30;    ||Concepto
      #998#8  = #999#12;    || Importe
      #998#11 = #999#48;    ||Contrapartida
      #998#12 = #999#49;    ||Titulo Contrapartida
  |FINSI;
  |SI eaEldef = "caextrp8";
      #998#9  = #999#21;    ||Departamento
      #998#10 = #999#40;    ||Subdepartamento
      #998#5  = #999#29;    ||Concepto
      #998#8  = #999#12;    || Importe
      #998#11 = #999#46;    ||Contrapartida
      #998#12 = #999#47;    ||Titulo Contrapartida
  |FINSI;

  |SI eaEldef = "caextrpa";
      enNumero = #999#48;
      #998#0  = #999#48;
      #998#5  = #999#29;
      |SI #998#7 = "D"; #998#8  = #999#12; |FINSI; || Importe
      |SI #998#7 = "H"; #998#8  = #999#13; |FINSI; || Importe
      #998#11 = #999#46;    ||Contrapartida
      #998#12 = #999#47;    ||Titulo Contrapartida
  |FINSI;

  |GRABA 020#998n;
|FPRC;

|DEFBUCLE LeoEspejo_D;
  #999#1001;
  12,11;
  000001, nDImporte,aDSigno;
  999999, nHImporte,aHSigno;
  ;
  NULL, LeoEspejo;
|FIN;

|DEFBUCLE LeoEspejo_H;
  #999#1001;
  17,11;
  000001, nDImporte,aDSigno;
  999999, nHImporte,aHSigno;
  ;
  NULL, LeoEspejo;
|FIN;

|DEFBUCLE LeoEspejo_13;
  #999#1001;
  13,11;
  000001, nDImporte,aDSigno;
  999999, nHImporte,aHSigno;
  ;
  NULL, LeoEspejo;
|FIN;


||*******************************************************
|PROCESO Tipo11W44; |TIPO 11;
   enNumero = #998#0;
   efCamp8  = #998#2;
   enCamp18 = #998#1;
   enCamp9  = #998#3;
   enCamp19 = #998#4;
   enCamp23 = enEmpresa;
|FPRC;

||*******************************************************
|PROCESO Alta998;
   #998#0 = 000001;
|FPRC;

|PROCESO Baja998;
   #998#0 = 999999;
|FPRC;

|PROGRAMA;
       |PUSHV 1022 2353;
       |PINTA 1023, "                              ";
       |PINTA 1123, " Del importe:                 ";
       |PINTA 1223, " Al importe :                 ";
       |PINTA 1323, "                              ";
       |PINTA 1423, " Apuntes Signo (D/H/A):       ";
       |CUADRO 1022 1552;
       |C_P #2#12, 1, 1137; |PINTA 1137, #2#12;
       |C_P #2#13, 1, 1237; |PINTA 1237, #2#13;
       |C_P #2#21, 1, 1447; #2#21 = "A"; |PINTA 1447, #2#21;

    |ET Camp10;
       |ENCAMPO #12#2;
       |SI FSalida = 1; |VETE  Campo0; |FINSI;
       #2#13 = #2#12; |PINTA #2#13;

    |ET Camp11;
       |ENCAMPO #13#2;
       |SI FSalida = 2; |VETE Camp10; |FINSI;
       |SI #2#13 < #2#12;
           |MENAV "    Error. Importe inferior al desde";
           |VETE Camp11;
       |FINSI;

    |ET Camp21;
       |ENCAMPO #21#2;
       |SI FSalida = 2; |VETE Camp11; |FINSI;
       |SI #2#21 ! "D"; |Y #2#21 ! "H"; |Y #2#21 ! "A";
           |VETE Camp21;
       |FINSI;

    |ET Campo0;
       |POPV;

       nDImporte = #2#12;
       nHImporte = #2#13;

       enNumero = 0;
       nConNum  = 0;
       |PUSHV 0801 2080;
       |DBASE aAlfa1;
       aMas = aAlfa1 + "def/" + eaEldef;
       |CARGA_DEF aMas, imagen@;
       |SI FSalida ! 0;
           |MENAV "    Error al Carga fichero " + eaEldef;
           |POPV;
           |ACABA;
       |FINSI;
       |NOME_DAT #999 aFitxer;

       aFichero = "6x" + Usuario;
       |NOME_DAT #998 aFichero;
       |DELINDEX #998;

       aDSigno = " ";
       aHSigno = "z";
       |SI #2#21 ! "A";
           aDSigno = #2#21;
           aHSigno = #2#21;
       |FINSI;

       |ABRE #998;
       |SI eaEldef = "caextrp2"; |O eaEldef = "caextrpa";
           |SI #2#21 ! "H";
               aDSigno = "D"; aHSigno = "D";
               |BUCLE LeoEspejo_D;
           |FINSI;
           |SI #2#21 ! "D";
               aDSigno = "H"; aHSigno = "H";
               |SI eaEldef = "caextrp2"; |BUCLE LeoEspejo_H;  |FINSI;
               |SI eaEldef = "caextrpa"; |BUCLE LeoEspejo_13; |FINSI;
           |FINSI;
       |SINO;
           |BUCLE LeoEspejo_D;
       |FINSI;
       |CIERRA #998;

       |SI nConNum = 0;
           |MENAV "    No Existe Apuntes dentro de la Seleccion";
       |SINO;
            |PINPA #0#998;
            |ATRI R; |PINTA 0943, #2#12;
                     |PINTA 0964, #2#13; |ATRI 0;
            |ENTLINEAL #1#998, -1, 4, 20, 0, Alta998, Baja998;
       |FINSI;

       |DESCARGA_DEF #imagen@;
       |POPV;
|FPRO;
