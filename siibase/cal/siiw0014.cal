|FICHEROS;
     siiw0014;
|FIN;

|VARIABLES;
     nCmpGet             = 0;
     nID                 = 0;

     aAlfa               = "";
     aID                 = "";
     aMes                = "";

     fFecha              = @;


 {20}aPopup              = "";

 {-1}aGet                = 0;
     aGet1               = 0;
     aGet2               = 0;
|FIN;

|PROCESO T12w14;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     |REFERENCIA_DEF aGet1, #siiw0014;
     |PARA nCmpGet = 0;  |SI nCmpGet [ 8;  |HACIENDO nCmpGet = nCmpGet + 1;
           aGet2 = nCmpGet;
           IaGet = aGet1<-;
           |ESPECIFICA "GETDATACONTROL", aGet;
           #siiw0014#nCmpGet# = FSalida;
     |SIGUE;
|FPRC;

|PROCESO T0C4w14;  |TIPO 0;
     |SI #siiw0014#3 = "N";
         |ACABA;
     |FINSI;

                              aMes = "";
     |SI #siiw0014#4 = "01";  aMes = "ENERO";       |FINSI;
     |SI #siiw0014#4 = "02";  aMes = "FEBRERO";     |FINSI;
     |SI #siiw0014#4 = "03";  aMes = "MARZO";       |FINSI;
     |SI #siiw0014#4 = "04";  aMes = "ABRIL";       |FINSI;
     |SI #siiw0014#4 = "05";  aMes = "MAYO";        |FINSI;
     |SI #siiw0014#4 = "06";  aMes = "JUNIO";       |FINSI;
     |SI #siiw0014#4 = "07";  aMes = "JULIO";       |FINSI;
     |SI #siiw0014#4 = "08";  aMes = "AGOSTO";      |FINSI;
     |SI #siiw0014#4 = "09";  aMes = "SEPTIEMBRE";  |FINSI;
     |SI #siiw0014#4 = "10";  aMes = "OCTUBRE";     |FINSI;
     |SI #siiw0014#4 = "11";  aMes = "NOVIEMBRE";   |FINSI;
     |SI #siiw0014#4 = "12";  aMes = "DICIEMBRE";   |FINSI;
     |SI #siiw0014#4 = "1T";  aMes = "1 TRIMSTRE";  |FINSI;
     |SI #siiw0014#4 = "2T";  aMes = "2 TRIMSTRE";  |FINSI;
     |SI #siiw0014#4 = "3T";  aMes = "3 TRIMSTRE";  |FINSI;
     |SI #siiw0014#4 = "4T";  aMes = "4 TRIMSTRE";  |FINSI;

     |SI aMes = "";
         |MENAV "0000Periodo incorrecto. ";
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO T66C4w14;  |TIPO 66;
     aAlfa = "|C004WID";
     aID   = #siiw0014#aAlfa#;
     nID   = aID;

     aPopup1  = nID;
     aPopup2  = 16;
     aPopup3  = "01-ENERO";
     aPopup4  = "02-FEBRERO";
     aPopup5  = "03-MARZO";
     aPopup6  = "04-ABRIL";
     aPopup7  = "05-MAYO";
     aPopup8  = "06-JUNIO";
     aPopup9  = "07-JULIO";
     aPopup10 = "08-AGOSTO";
     aPopup11 = "09-SEPTIEMBRE";
     aPopup12 = "10-OCTUBRE";
     aPopup13 = "11-NOVIEMBRE";
     aPopup14 = "12-DICIEMBRE";
     aPopup15 = "1T-1 TRIMESTRE";
     aPopup16 = "2T-2 TRIMESTRE";
     aPopup17 = "3T-3 TRIMESTRE";
     aPopup18 = "4T-4 TRIMESTRE";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 102;  #siiw0014#4 = aAlfa;
     |FINSI;

     |PINTA #siiw0014#4;
|FPRC;

|PROCESO T7C4w14;  |TIPO 7;
     |C_M #siiw0014#4, 1, "S";
     |SI #siiw0014#3 = "N";
         |C_M #siiw0014#4, 1, "N";  #siiw0014#4 = "";
     |SINO;
         |SI #siiw0014#4 = "  ";
             fFecha = ~;
             #siiw0014#4 = fFecha % 402;
         |FINSI;
     |FINSI;

     |PINTA #siiw0014#4;
|FPRC;

|PROCESO T7C2w14;  |TIPO 7;
     |C_M #siiw0014#2, 1, "S";
     |SI #siiw0014#1 = "N";
         |C_M #siiw0014#2, 1, "N";  #siiw0014#2 = 0;
     |SINO;
         |SI #siiw0014#2 = 0;
             fFecha = ~;
             aAlfa  = fFecha % -104;
             #siiw0014#2 = aAlfa;
         |FINSI;
     |FINSI;

     |PINTA #siiw0014#2;
|FPRC;
