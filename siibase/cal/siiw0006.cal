|FICHEROS;
     siiw0006,MANTE;
     siiw0002;
     siiw0003;
     siiw0015;
     siiw0017;

     siim0002;
     siim0003;
     siim0004;
     siim0007;
     siim0008;
     siim0009;
     siim0010;

     siiw0012;
     siiw0013;
     siiw0016;
     siiw0018;
|FIN;

|VARIABLES;
     nOk                 = 0;
     nLot                = 0;
     nReg                = 0;
     nCampo              = 0;
     nCmp                = 0;

     aAlfa               = "";
     aFicTmp             = "";

     &enTCampo           = 0;
     &eaH60              = "";
|FIN;

|PROCESO siim0003;
     |SI #siim0003#1 ] #siim0002#1;
         |ACABA;
     |FINSI;

     |SI #siim0003#103 = "P";  nOk = 0;  |ACABA;  |FINSI;
     |SI #siim0003#103 = "I";  nOk = 0;  |ACABA;  |FINSI;

     |SI #siim0002#2 = "12";
         |SI #siim0003#7 = "05";  |ACABA;  |FINSI;
         |SI #siim0003#8 = "05";  |ACABA;  |FINSI;
         |SI #siim0003#9 = "05";  |ACABA;  |FINSI;
     |FINSI;

     |SI #siim0003#111 = "S";
         nLot = 0;
         nReg = 0;
         nOk  = 0;

         |ACABA;
     |FINSI;

     nLot = #siim0003#1;
     nReg = #siim0003#2;

     nOk = 1;
|FPRC;

|DEFBUCLE siim0003;
     #siim0003#2;
     ;
     #siim0002#0, #siiw0006#0,          0,      0;
     #siim0002#0, #siiw0006#0, 9999999999, 999999;
     ;
     NULL, siim0003;
|FIN;

|PROCESO LeeFacExp;
     nOk = 0;
     |BUCLE siim0003;
|FPRC;

|PROCESO siim0004;
     |SI #siim0004#1 ] #siim0002#1;
         |ACABA;
     |FINSI;

     |SI #siim0004#78 = "I";  nOk = 0;  |ACABA;  |FINSI;
     |SI #siim0004#78 = "P";  nOk = 0;  |ACABA;  |FINSI;

     |SI #siim0002#2 = "22";
         |SI #siim0004#7 = "05";  |ACABA;  |FINSI;
         |SI #siim0004#8 = "05";  |ACABA;  |FINSI;
         |SI #siim0004#9 = "05";  |ACABA;  |FINSI;
     |FINSI;

     |SI #siim0004#86 = "S";
         nLot = 0;
         nReg = 0;
         nOk  = 0;

         |ACABA;
     |FINSI;

     nLot = #siim0004#1;
     nReg = #siim0004#2;

     nOk = 1;
|FPRC;

|DEFBUCLE siim0004;
     #siim0004#2;
     ;
     #siim0002#0, #siiw0006#1, #siiw0006#0,          0,      0;
     #siim0002#0, #siiw0006#1, #siiw0006#0, 9999999999, 999999;
     ;
     NULL, siim0004;
|FIN;

|PROCESO LeeFacRec;
     nOk = 0;
     |BUCLE siim0004;
|FPRC;

|PROCESO siim0009;
     |SI #siim0009#1 ] #siim0002#1;
         |ACABA;
     |FINSI;

     |SI #siim0009#21 = "P";  nOk = 0;  |ACABA;  |FINSI;
     |SI #siim0009#21 = "I";  nOk = 0;  |ACABA;  |FINSI;

     |SI #siim0009#26 = "S";
         nLot = 0;
         nReg = 0;
         nOk  = 0;

         |ACABA;
     |FINSI;

     nLot = #siim0009#1;
     nReg = #siim0009#2;

     nOk = 1;
|FPRC;

|DEFBUCLE siim0009;
     #siim0009#2;
     ;
     #siim0002#0, #siiw0006#0,          0,      0;
     #siim0002#0, #siiw0006#0, 9999999999, 999999;
     ;
     NULL, siim0009;
|FIN;

|PROCESO LeeInversion;
     nOk = 0;
     |BUCLE siim0009;
|FPRC;

|PROCESO siim0010;
     |SI #siim0010#1 ] #siim0002#1;
         |ACABA;
     |FINSI;

     |SI #siim0010#14 = "P";  nOk = 0;  |ACABA;  |FINSI;
     |SI #siim0010#14 = "I";  nOk = 0;  |ACABA;  |FINSI;

     |SI #siim0010#18 = "S";
         nLot = 0;
         nReg = 0;
         nOk  = 0;

         |ACABA;
     |FINSI;

     nLot = #siim0010#1;
     nReg = #siim0010#2;

     nOk = 1;
|FPRC;

|DEFBUCLE siim0010;
     #siim0010#2;
     ;
     #siim0002#0,          0, #siiw0006#1,      0;
     #siim0002#0, 9999999999, #siiw0006#1, 999999;
     ;
     NULL, siim0010;
|FIN;

|PROCESO LeeCobrosMetalico;
     nOk = 0;
     |BUCLE siim0010;
|FPRC;

|PROCESO siim0007Act;
     |SALVA_DATOS #siim0007;

     #siim0007#0 = #siiw0002#0;
     #siim0007#1 = #siiw0002#1;
     #siim0007#2 = #siiw0002#2;
     |GRABA 020#siim0007.n;
     |LIBERA #siim0007;

     |REPON_DATOS #siim0007;
     |LEE 000#siim0007.=;
|FPRC;

|DEFBUCLE siim0007Act;
     #siim0007#1;
     ;
     #siim0003#0, #siim0003#1, #siim0003#2, "";
     #siim0003#0, #siim0003#1, #siim0003#2, eaH60;
     ;
     NULL, siim0007Act;
|FIN;

|PROCESO siim0008Act;
     |SALVA_DATOS #siim0008;

     #siim0008#0 = #siiw0003#0;
     #siim0008#1 = #siiw0003#1;
     #siim0008#2 = #siiw0003#2;
     |GRABA 020#siim0008.n;
     |LIBERA #siim0008;

     |REPON_DATOS #siim0008;
     |LEE 000#siim0008.=;
|FPRC;

|DEFBUCLE siim0008Act;
     #siim0008#1;
     ;
     #siim0004#0, #siim0004#1, #siim0004#2, "";
     #siim0004#0, #siim0004#1, #siim0004#2, eaH60;
     ;
     NULL, siim0008Act;
|FIN;

|PROCESO T12w6;   |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     |SI #siim0002#2 ! "42";  |Y #siim0002#2 ! "45";
         aAlfa = #siiw0006#0;  |QBF aAlfa;
         |SI aAlfa = "";
             |MENAV "0000Introduzca el identificador de la factura a modificar";
             |ERROR;
             |ACABA;
         |FINSI;
     |SINO;
         aAlfa = #siiw0006#1;  |QBF aAlfa;
         |SI aAlfa = "";
             |MENAV "0000Introduzca el NIF del registro a modificar";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #siim0002#2 = "12";  |O #siim0002#2 = "15";
         |HAZ LeeFacExp;

         |SI nOk = 0;
             aAlfa = "0000Esta factura no ha sido introducida en facturas expedidas, ";
             aAlfa = aAlfa + "est  de baja, ";
             aAlfa = aAlfa + "el tipo de operaci¢n no corresponde ";
             aAlfa = aAlfa + "o no ha sido enviada.";
             |MENAV aAlfa;

             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #siim0002#2 = "22";  |O #siim0002#2 = "25";
         |HAZ LeeFacRec;

         |SI nOk = 0;
             aAlfa = "0000Esta factura no ha sido introducida en facturas recibidas, ";
             aAlfa = aAlfa + "est  de baja, ";
             aAlfa = aAlfa + "el tipo de operaci¢n no corresponde ";
             aAlfa = aAlfa + "o no ha sido enviada.";
             |MENAV aAlfa;

             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #siim0002#2 = "32";  |O #siim0002#2 = "35";
         |HAZ LeeInversion;

         |SI nOk = 0;
             aAlfa = "0000Esta factura no ha sido introducida en bienes de inversi¢n, ";
             aAlfa = aAlfa + "est  de baja ";
             aAlfa = aAlfa + "o no ha sido enviada.";
             |MENAV aAlfa;

             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #siim0002#2 = "42";  |O #siim0002#2 = "45";
         |HAZ LeeCobrosMetalico;

         |SI nOk = 0;
             aAlfa = "0000Este NIF no ha sido introducido en operaciones en met lico, ";
             aAlfa = aAlfa + "est  de baja ";
             aAlfa = aAlfa + "o no ha sido enviado.";
             |MENAV aAlfa;

             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #siim0002#2 = "12";  |O #siim0002#2 = "22";
      |O #siim0002#2 = "32";
         |CONFI "0000SSeguro que quiere modificar la factura introducida";
     |FINSI;

     |SI #siim0002#2 = "42";
         |CONFI "0000SSeguro que quiere modificar el registro introducido";
     |FINSI;

     |SI #siim0002#2 = "15";  |O #siim0002#2 = "25";
      |O #siim0002#2 = "35";
         |CONFI "0000SSeguro que quiere dar de baja la factura introducida";
     |FINSI;

     |SI #siim0002#2 = "45";
         |CONFI "0000SSeguro que quiere dar de baja el registro introducido";
     |FINSI;

     |SI FSalida ! 0;
         |ERROR;
         |ACABA;
     |FINSI;

     |SI #siim0002#2 = "12";  |O #siim0002#2 = "15";
         #siim0003#0 = #siim0002#0;
         #siim0003#1 = nLot;
         #siim0003#2 = nReg;
         |LEE 000#siim0003.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |PARA nCampo = 3;  |SI nCampo [ enTCampo;  |HACIENDO nCampo = nCampo + 1;
               #siiw0002#nCampo# = #siim0003#nCampo#;
         |SIGUE;

         #siiw0002#100 = "";
         #siiw0002#101 = "01.01.0000";
         #siiw0002#102 = "";
         #siiw0002#103 = "P";
         #siiw0002#104 = "";
         #siiw0002#105 = "";
         #siiw0002#106 = "";
         #siiw0002#107 = "";

         #siim0003#100 = "";
         #siim0003#101 = "01.01.0000";
         #siim0003#102 = "";
         #siim0003#103 = "P";
         #siim0003#104 = "";
         #siim0003#105 = "";
         #siim0003#106 = "";
         #siim0003#107 = "";

         |BUCLE siim0007Act;
     |FINSI;

     |SI #siim0002#2 = "22";  |O #siim0002#2 = "25";
         #siim0004#0 = #siim0002#0;
         #siim0004#1 = nLot;
         #siim0004#2 = nReg;
         |LEE 000#siim0004.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |PARA nCampo = 3;  |SI nCampo [ enTCampo;  |HACIENDO nCampo = nCampo + 1;
               #siiw0003#nCampo# = #siim0004#nCampo#;
         |SIGUE;

         #siiw0003#75  = "";
         #siiw0003#76  = "01.01.0000";
         #siiw0003#77  = "";
         #siiw0003#78  = "P";
         #siiw0003#79  = "";
         #siiw0003#80  = "";
         #siiw0003#81  = "";
         #siiw0003#82  = "";

         #siim0004#75  = "";
         #siim0004#76  = "01.01.0000";
         #siim0004#77  = "";
         #siim0004#78  = "P";
         #siim0004#79  = "";
         #siim0004#80  = "";
         #siim0004#81  = "";
         #siim0004#82  = "";

         |BUCLE siim0008Act;
     |FINSI;

     |SI #siim0002#2 = "32";  |O #siim0002#2 = "35";
         #siim0009#0 = #siim0002#0;
         #siim0009#1 = nLot;
         #siim0009#2 = nReg;
         |LEE 000#siim0009.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |PARA nCampo = 3;  |SI nCampo [ enTCampo;  |HACIENDO nCampo = nCampo + 1;
               #siiw0015#nCampo# = #siim0009#nCampo#;
         |SIGUE;

         #siiw0015#18 = "";
         #siiw0015#19 = "01.01.0000";
         #siiw0015#20 = "";
         #siiw0015#21 = "P";
         #siiw0015#22 = "";
         #siiw0015#23 = "";
         #siiw0015#24 = "";
         #siiw0015#25 = "";
         #siiw0015#26 = "N";

         #siim0009#18 = "";
         #siim0009#19 = "01.01.0000";
         #siim0009#20 = "";
         #siim0009#21 = "P";
         #siim0009#22 = "";
         #siim0009#23 = "";
         #siim0009#24 = "";
         #siim0009#25 = "";
         #siim0009#26 = "N";
     |FINSI;

     |SI #siim0002#2 = "42";  |O #siim0002#2 = "45";
         #siim0010#0 = #siim0002#0;
         #siim0010#1 = nLot;
         #siim0010#2 = nReg;
         |LEE 000#siim0010.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |PARA nCampo = 3;  |SI nCampo [ enTCampo;  |HACIENDO nCampo = nCampo + 1;
               #siiw0017#nCampo# = #siim0010#nCampo#;
         |SIGUE;

         #siiw0017#11 = "";
         #siiw0017#12 = "01.01.0000";
         #siiw0017#13 = "";
         #siiw0017#14 = "P";
         #siiw0017#15 = "";
         #siiw0017#16 = "";
         #siiw0017#17 = "";

         #siim0010#11 = "";
         #siim0010#12 = "01.01.0000";
         #siim0010#13 = "";
         #siim0010#14 = "P";
         #siim0010#15 = "";
         #siim0010#16 = "";
         #siim0010#17 = "";
     |FINSI;
|FPRC;

|PROCESO siim0003Busca;
     |SI #siim0003#1 > #siim0002#1;
         |ACABA;
     |FINSI;

     |SI #siim0003#103 = "P";  |ACABA;  |FINSI;
     |SI #siim0003#103 = "I";  |ACABA;  |FINSI;

     |SI #siim0002#2 = "12";
         |SI #siim0003#7 = "05";  |ACABA;  |FINSI;
         |SI #siim0003#8 = "05";  |ACABA;  |FINSI;
         |SI #siim0003#9 = "05";  |ACABA;  |FINSI;
     |FINSI;

     |SI #siim0003#111 = "S";  |O #siim0003#1 = #siim0002#1;
         #siiw0012#0 = #siim0003#19;
         |LEE 000#siiw0012.=;
         |SI FSalida = 0;
             |BORRA 020#siiw0012.a;
             |LIBERA #siiw0012;
         |FINSI;

         |ACABA;
      |FINSI;

     #siiw0012#0 = #siim0003#19;
     |LEE 000#siiw0012.=;
     |SI FSalida ! 0;
         |DDEFECTO #siiw0012;
         #siiw0012#0 = #siim0003#19;
         |GRABA 020#siiw0012.b;
     |FINSI;

     #siiw0012#1  = #siim0003#1;
     #siiw0012#2  = #siim0003#2;
     #siiw0012#3  = #siim0003#3;
     #siiw0012#4  = #siim0003#4;
     #siiw0012#5  = #siim0003#5;
     #siiw0012#6  = #siim0003#6;
     #siiw0012#7  = #siim0003#7;
     #siiw0012#8  = #siim0003#8;
     #siiw0012#9  = #siim0003#9;
     #siiw0012#10 = #siim0003#13;
     #siiw0012#11 = #siim0003#14;
     #siiw0012#12 = #siim0003#15;
     #siiw0012#13 = #siim0003#16;
     #siiw0012#14 = #siim0003#17;
     #siiw0012#15 = #siim0003#18;
     #siiw0012#16 = #siim0003#21;
     #siiw0012#17 = #siim0003#22;
     #siiw0012#18 = #siim0003#59;

     |GRABA 020#siiw0012.a;
     |LIBERA #siiw0012;
|FPRC;

|DEFBUCLE siim0003Busca;
     #siim0003#4;
     ;
     #siim0002#0, #siim0002#4, #siim0002#5,  0,          0, "  ",          0,      0;
     #siim0002#0, #siim0002#4, #siim0002#5, 99, 9999999999, "zz", 9999999999, 999999;
     ;
     NULL, siim0003Busca;
|FIN;

|PROCESO siim0004Busca;
     |SI #siim0004#1 > #siim0002#1;
         |ACABA;
     |FINSI;

     |SI #siim0004#78 = "I";  nOk = 0;  |ACABA;  |FINSI;
     |SI #siim0004#78 = "P";  nOk = 0;  |ACABA;  |FINSI;

     |SI #siim0002#2 = "22";
         |SI #siim0004#7 = "05";  |ACABA;  |FINSI;
         |SI #siim0004#8 = "05";  |ACABA;  |FINSI;
         |SI #siim0004#9 = "05";  |ACABA;  |FINSI;
     |FINSI;

     |SI #siim0004#86 = "S";  |O #siim0004#1 = #siim0002#1;
         #siiw0013#0 = #siim0004#10;
         #siiw0013#1 = #siim0004#14;
         |LEE 000#siiw0013.=;
         |SI FSalida = 0;
             |BORRA 020#siiw0013.a;
             |LIBERA #siiw0013;
         |FINSI;

         |ACABA;
      |FINSI;

     #siiw0013#0 = #siim0004#10;
     #siiw0013#1 = #siim0004#14;
     |LEE 000#siiw0013.=;
     |SI FSalida ! 0;
         |DDEFECTO #siiw0013;
         #siiw0013#0 = #siim0004#10;
         #siiw0013#1 = #siim0004#14;
         |GRABA 020#siiw0013.b;
     |FINSI;

     #siiw0013#2  = #siim0004#1;
     #siiw0013#3  = #siim0004#2;
     #siiw0013#4  = #siim0004#3;
     #siiw0013#5  = #siim0004#4;
     #siiw0013#6  = #siim0004#5;
     #siiw0013#7  = #siim0004#6;
     #siiw0013#8  = #siim0004#7;
     #siiw0013#9  = #siim0004#8;
     #siiw0013#10 = #siim0004#9;
     #siiw0013#11 = #siim0004#11;
     #siiw0013#12 = #siim0004#12;
     #siiw0013#13 = #siim0004#13;
     #siiw0013#14 = #siim0004#16;
     #siiw0013#15 = #siim0004#17;
     #siiw0013#16 = #siim0004#18;
     #siiw0013#17 = #siim0004#64;

     |GRABA 020#siiw0013.a;
     |LIBERA #siiw0013;
|FPRC;

|DEFBUCLE siim0004Busca;
     #siim0004#5;
     ;
     #siim0002#0, #siim0002#4, #siim0002#5,  0,          0, "  ",          0,      0;
     #siim0002#0, #siim0002#4, #siim0002#5, 99, 9999999999, "zz", 9999999999, 999999;
     ;
     NULL, siim0004Busca;
|FIN;

|PROCESO siim0009Busca;
     |SI #siim0009#1 > #siim0002#1;
         |ACABA;
     |FINSI;

     |SI #siim0009#21 = "P";  |ACABA;  |FINSI;
     |SI #siim0009#21 = "I";  |ACABA;  |FINSI;

     |SI #siim0009#26 = "S";  |O #siim0009#1 = #siim0002#1;
         #siiw0016#0 = #siim0009#5;
         |LEE 000#siiw0016.=;
         |SI FSalida = 0;
             |BORRA 020#siiw0016.a;
             |LIBERA #siiw0016;
         |FINSI;

         |ACABA;
      |FINSI;

     #siiw0016#0 = #siim0009#5;
     |LEE 000#siiw0016.=;
     |SI FSalida ! 0;
         |DDEFECTO #siiw0016;
         #siiw0016#0 = #siim0009#5;
         |GRABA 020#siiw0016.b;
     |FINSI;

     #siiw0016#1  = #siim0009#1;
     #siiw0016#2  = #siim0009#2;
     #siiw0016#3  = #siim0009#3;
     #siiw0016#4  = #siim0009#4;
     #siiw0016#5  = #siim0009#6;
     #siiw0016#6  = #siim0009#7;
     #siiw0016#7  = #siim0009#8;
     #siiw0016#8  = #siim0009#9;
     #siiw0016#9  = #siim0009#10;
     #siiw0016#10 = #siim0009#11;
     #siiw0016#11 = #siim0009#12;
     #siiw0016#12 = #siim0009#13;
     #siiw0016#13 = #siim0009#14;
     #siiw0016#14 = #siim0009#15;
     #siiw0016#15 = #siim0009#16;
     #siiw0016#16 = #siim0009#17;

     |GRABA 020#siiw0016.a;
     |LIBERA #siiw0016;
|FPRC;

|DEFBUCLE siim0009Busca;
     #siim0009#3;
     ;
     #siim0002#0, #siim0002#4, #siim0002#5,         "",  0,  0,          0,      0;
     #siim0002#0, #siim0002#4, #siim0002#5, "zzzzzzzz", 99, 99, 9999999999, 999999;
     ;
     NULL, siim0009Busca;
|FIN;

|PROCESO siim0010Busca;
     |SI #siim0010#1 > #siim0002#1;
         |ACABA;
     |FINSI;


     |SI #siim0010#14 = "P";  |ACABA;  |FINSI;
     |SI #siim0010#14 = "I";  |ACABA;  |FINSI;

     |SI #siim0010#18 = "S";  |O #siim0010#1 = #siim0002#1;
         #siiw0018#0 = #siim0010#6;
         |LEE 000#siiw0018.=;
         |SI FSalida = 0;
             |BORRA 020#siiw0018.a;
             |LIBERA #siiw0018;
         |FINSI;

         |ACABA;
      |FINSI;

     #siiw0018#0 = #siim0010#6;
     |LEE 000#siiw0018.=;
     |SI FSalida ! 0;
         |DDEFECTO #siiw0018;
         #siiw0018#0 = #siim0010#6;
         |GRABA 020#siiw0018.b;
     |FINSI;

     #siiw0018#1  = #siim0010#1;
     #siiw0018#2  = #siim0010#2;
     #siiw0018#3  = #siim0010#3;
     #siiw0018#4  = #siim0010#4;
     #siiw0018#5  = #siim0010#5;
     #siiw0018#6  = #siim0010#7;
     #siiw0018#7  = #siim0010#8;
     #siiw0018#8  = #siim0010#9;
     #siiw0018#9  = #siim0010#10;

     |GRABA 020#siiw0018.a;
     |LIBERA #siiw0018;
|FPRC;

|DEFBUCLE siim0010Busca;
     #siim0010#3;
     ;
     #siim0002#0, #siim0002#4, #siim0002#5,             "",          0,      0;
     #siim0002#0, #siim0002#4, #siim0002#5, "zzzzzzzzzzzz", 9999999999, 999999;
     ;
     NULL, siim0010Busca;
|FIN;

|PROCESO Busqueda;
     |SI #siim0002#2 = "12";  |O #siim0002#2 = "15";
         aFicTmp = "siiw0012" + Usuario;
         |NOME_DAT #siiw0012#aFicTmp#;
         |ABRE #siiw0012;  |CIERRA #siiw0012;  |DELINDEX #siiw0012;

         |ABRE #siiw0012;
         |BUCLE siim0003Busca;

         |LEE 000#siiw0012.p;
         |CONSULTA_CLAVE #1#siiw0012;
         |SI FSalida = 0;
             #siiw0006#0 = #siiw0012#0;

             |PINTA #siiw0006#0;
         |FINSI;

         |CIERRA #siiw0012;
         |DELINDEX #siiw0012;
     |FINSI;

     |SI #siim0002#2 = "22";  |O #siim0002#2 = "25";
         aFicTmp = "siiw0013" + Usuario;
         |NOME_DAT #siiw0013#aFicTmp#;
         |ABRE #siiw0013;  |CIERRA #siiw0013;  |DELINDEX #siiw0013;

         |ABRE #siiw0013;
         |BUCLE siim0004Busca;

         |LEE 000#siiw0013.p;
         |CONSULTA_CLAVE #1#siiw0013;
         |SI FSalida = 0;
             #siiw0006#0 = #siiw0013#1;
             #siiw0006#1 = #siiw0013#0;

             |PINTA #siiw0006#0;
             |PINTA #siiw0006#1;
         |FINSI;

         |CIERRA #siiw0013;
         |DELINDEX #siiw0013;
     |FINSI;

     |SI #siim0002#2 = "32";  |O #siim0002#2 = "35";
         aFicTmp = "siiw0016" + Usuario;
         |NOME_DAT #siiw0016#aFicTmp#;
         |ABRE #siiw0016;  |CIERRA #siiw0016;  |DELINDEX #siiw0016;

         |ABRE #siiw0016;
         |BUCLE siim0009Busca;

         |LEE 000#siiw0016.p;
         |CONSULTA_CLAVE #1#siiw0016;
         |SI FSalida = 0;
             #siiw0006#0 = #siiw0016#0;

             |PINTA #siiw0006#0;
         |FINSI;

         |CIERRA #siiw0016;
         |DELINDEX #siiw0016;
     |FINSI;

     |SI #siim0002#2 = "42";  |O #siim0002#2 = "45";
         aFicTmp = "siiw0018" + Usuario;
         |NOME_DAT #siiw0018#aFicTmp#;
         |ABRE #siiw0018;  |CIERRA #siiw0018;  |DELINDEX #siiw0018;

         |ABRE #siiw0018;
         |BUCLE siim0010Busca;

         |LEE 000#siiw0018.p;
         |CONSULTA_CLAVE #1#siiw0018;
         |SI FSalida = 0;
             #siiw0006#1 = #siiw0018#0;

             |PINTA #siiw0006#1;
         |FINSI;

         |CIERRA #siiw0018;
         |DELINDEX #siiw0018;
     |FINSI;
|FPRC;
