|FICHEROS;
     siim0502;
|FIN;

|VARIABLES;
     n0Vent              = 0;
     nGrid502            = -1;
     nRango              = 0;
     nOk                 = 0;

     aEsc1               = "";
     aEsc2               = "";
     aRetu               = "";
     aTecla              = "";
     aAlfa               = "";
     aID                 = "";

 {10}aPopup              = "";

     {-1}aVent           = "";
         aVent1          = 0;
         aVent2          = 0;
         aVent3          = 0;
         aVent4          = 0;
         aVent5          = "";
|FIN;

|PROCESO T66C3m502;  |TIPO 66;
     aPopup1  = 0;
     aPopup2  = 4;
     aPopup3  = "1 Alta/modificacion";
     aPopup4  = "2 Listados";
     aPopup5  = "3 Anulacion";
     aPopup6  = "4 Cobro/Pago";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 101;  #siim0502#3 = aAlfa;
     |FINSI;

     |PINTA #siim0502#3;

     |ERROR;
|FPRC;

|PROCESO T0C2m502;  |TIPO 0;
     nOk = 0;
     |SI #siim0502#2 = "FE";  nOk = 1;  |FINSI;
     |SI #siim0502#2 = "FR";  nOk = 1;  |FINSI;
     |SI #siim0502#2 = "OI";  nOk = 1;  |FINSI;
     |SI #siim0502#2 = "BI";  nOk = 1;  |FINSI;
     |SI #siim0502#2 = "SB";  nOk = 1;  |FINSI;
     |SI #siim0502#2 = "PM";  nOk = 1;  |FINSI;
     |SI #siim0502#2 = "";    nOk = 1;  |FINSI;

     |C_M #siim0502#3, 1, "S";
     |SI #siim0502#2 = "SB";
         |C_M #siim0502#3, 1, "N";  #siim0502#3 = "0";
     |FINSI;

     |SI nOk = 1;  |ACABA;  |FINSI;

     |MENAV "0000Tipo url incorrecto";
     |ERROR;
|FPRC;

|PROCESO T66C2m502;  |TIPO 66;
     aPopup1  = 0;
     aPopup2  = 6;
     aPopup3  = "FE Facturas expedidas";
     aPopup4  = "FR Facturas recibidas";
     aPopup5  = "OI Facturas operaciones intracomunitarias";
     aPopup6  = "BI Facturas bienes de inversion";
     aPopup7  = "PM Operaciones trascendencia tributaria anual";
     aPopup8  = "SB Url para el SIIBOX";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 102;  #siim0502#2 = aAlfa;
     |FINSI;

     |PINTA #siim0502#2;

     |ERROR;
|FPRC;

|PROCESO T66C1m502;  |TIPO 66;
     aPopup1  = 0;
     aPopup2  = 2;
     aPopup3  = "P. Servidor de pruebas";
     aPopup4  = "R. Servidor real";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 101;  #siim0502#1 = aAlfa;
     |FINSI;

     |PINTA #siim0502#1;
     |ERROR;
|FPRC;

|PROGRAMA;
     |VENTANA 0501, 3599, -1, 16, "Direcciones URL";
     n0Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     nRango   = 1 + 2 + 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#siim0502, nRango, 0502, 3498, NULL, NULL, NULL;
     nGrid502 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::{{001}}Salir," + nGrid502;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;
          |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n0Vent;
|FPRO;

|PROCESO T80;  |TIPO 80;
     |ABRET #siim0502;
|FPRC;

|PROCESO T90;  |TIPO 90;
     |CIERRAT #siim0502;
|FPRC;
