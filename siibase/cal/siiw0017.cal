|FICHEROS;
     siiw0017,MANTE;
|FIN;

|VARIABLES;
     nOk                 = 0;
     nCobro              = 0;
     nLotA               = 0;
     nPas                = 0;
     nID                 = 0;

     aAlfa               = "";
     aFicTmp             = "";
     aID                 = "";
     aContenido          = "";

 {40}aPopup              = "";

     &eaVarDni           = "";
     &enCalcCif          = 0;
     &eaCodNif           = "";
     &eaNomNif           = "";
     &eaPaiNif           = "";
|FIN;

|PROCESO T12w17;   |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     |SI FSalida ! 1;
         |POSICIONATE #siiw0017#10;
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO T0C10w17;  |TIPO 0;
     |SI #siiw0017#10 < 6000;
         |MENAV "0000El importe en met lico debe ser igual o superior a 6000 Euros.";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO T0C8w17;  |TIPO 0;
     |C_M #siiw0017#8, 0, aAlfa;
     |SI aAlfa = "N"; |ACABA;  |FINSI;

     |SI #siiw0017#8 = "   ";
         #siiw0017#8 = "ES";
     |FINSI;

     |SI #siiw0017#8 = "ESP";
         #siiw0017#8 = "ES";
     |FINSI;

     |SI #siiw0017#5 ! "01";  |Y #siiw0017#5 ! "07";
         |SI #siiw0017#8 = "ES ";
             |MENAV "0000Pais incorrecto";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #siiw0017#5 = "01";  |O #siiw0017#5 = "07";
         |SI #siiw0017#8 ! "ES ";
             |MENAV "0000Pais incorrecto";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |C_M #siiw0017#9, 1, "S";
     |SI #siiw0017#8 = "ES ";
         |C_M #siiw0017#9, 1, "N"; #siiw0017#9 = "";
     |FINSI;

     aAlfa = #siiw0017#9;  |QBF aAlfa;
     |SI #siiw0017#5 = "02";  |Y aAlfa = "";
         aAlfa = #siiw0017#8;  |QBF aAlfa;
         #siiw0017#9 = aAlfa + #siiw0017#6;
     |FINSI;

     |PINTA #siiw0017#9;
|FPRC;

|PROCESO T0C5w17;   |TIPO 0;
     |C_M #siiw0017#5, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     nOk = 0;

     |SI #siiw0017#5 = "01";  nOk = 1;  |FINSI;
     |SI #siiw0017#5 = "02";  nOk = 1;  |FINSI;
     |SI #siiw0017#5 = "03";  nOk = 1;  |FINSI;
     |SI #siiw0017#5 = "04";  nOk = 1;  |FINSI;
     |SI #siiw0017#5 = "05";  nOk = 1;  |FINSI;
     |SI #siiw0017#5 = "06";  nOk = 1;  |FINSI;
     |SI #siiw0017#5 = "07";  nOk = 1;  |FINSI;

     |SI nOk = 0;
         |MENAV "0000 Clave identificaci¢n pais de residencia incorrecto";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO T66C5w17;  |TIPO 66;
     aAlfa = "|C005WID";
     aID   = #siiw0017#aAlfa#;
     nID   = aID;

     aPopup1  = nID;
     aPopup2  = 7;
     aPopup3  = "01 NIF";
     aPopup4  = "02 NIF/IVA (NIF operador intracomunitario)";
     aPopup5  = "03 Pasaporte";
     aPopup6  = "04 Documento Oficial de identificacion expedido por el pais o territorio de residencia";
     aPopup7  = "05 Certificado de residencia fiscal";
     aPopup8  = "06 Otro documento probatorio";
     aPopup9  = "07 No censado";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 102;  #siiw0017#5 = aAlfa;
     |FINSI;

     |PINTA #siiw0017#5;
|FPRC;

|PROCESO T0C6w17;  |TIPO 0;
     eaVarDni  = #siiw0017#Campo#;
     enCalcCif = 0;
     |HAZ LetraNif;
     eaVarDni = (eaVarDni + "             ") % 112;
     |SI #siiw0017#Campo# ! eaVarDni;
         |CONFI "0000SEl NIF puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #siiw0017#Campo# = eaVarDni;  |PINTA #siiw0017#Campo#;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     aContenido = Contenido;
     |SI #siiw0017#6 ! aContenido;
         eaCodNif = #siiw0017#6;
         |HAZ LeeNif;

         #siiw0017#7  = eaNomNif;
         #siiw0017#8  = eaPaiNif;
     |FINSI;

     aAlfa = #siiw0017#6 % 101;
     |SI aAlfa = "X";  |O aAlfa = "Y";
         #siiw0017#5 = "01";
     |FINSI;

     |PINTA #siiw0017#5;
     |PINTA #siiw0017#7;
     |PINTA #siiw0017#8;
|FPRC;
