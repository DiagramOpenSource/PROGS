|FICHEROS;
     siim0001;

     siiw0001,MANTE;
|FIN;

|VARIABLES;
     nEje          = 0;
     nAnyo         = 0;
     nDAnyo        = 0;
     nHAnyo        = 0;
     nID           = 0;
     nCmp          = 0;
     nCmp1         = 0;
     nCmp2         = 0;
     nCmp3         = 0;
     nCmp4         = 0;
     nCmp5         = 0;
     nCmp6         = 0;
     nCmp7         = 0;
     nCmp8         = 0;
     nCmp9         = 0;
     nCmp10        = 0;
     nCmp11        = 0;
     nCmp12        = 0;
     nCmp13        = 0;
     nCmp14        = 0;
     nCmp15        = 0;
     nCmp16        = 0;

     aID           = "";
     aAlfa         = "";

     fFecha        = @;

 {20}aPopup        = "";
|FIN;

|PROCESO T12w1;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     |SI FSalida ! 1;
         |POSICIONATE #siiw0001#0;
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO T0Elige;  |TIPO 0;
     nCmp1  = 3;
     nCmp2  = 4;
     nCmp3  = 5;
     nCmp4  = 6;
     nCmp5  = 7;
     nCmp6  = 8;
     nCmp7  = 9;
     nCmp8  = 10;
     nCmp9  = 11;
     nCmp10 = 12;
     nCmp11 = 13;
     nCmp12 = 14;
     nCmp13 = 15;
     nCmp14 = 16;
     nCmp15 = 17;
     nCmp16 = 18;

     |SI #siiw0001#Campo# = "S";
         |PARA nCmp = nCmp1;  |SI nCmp [ nCmp16;  |HACIENDO nCmp = nCmp + 1;
               |SI Campo ! nCmp;
                   #siiw0001#nCmp# = "N";
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI #siiw0001#nCmp1#  = "N";  |Y #siiw0001#nCmp2#  = "N";
      |Y #siiw0001#nCmp3#  = "N";  |Y #siiw0001#nCmp4#  = "N";
      |Y #siiw0001#nCmp5#  = "N";  |Y #siiw0001#nCmp6#  = "N";
      |Y #siiw0001#nCmp7#  = "N";  |Y #siiw0001#nCmp8#  = "N";
      |Y #siiw0001#nCmp9#  = "N";  |Y #siiw0001#nCmp10# = "N";
      |Y #siiw0001#nCmp11# = "N";  |Y #siiw0001#nCmp12# = "N";
      |Y #siiw0001#nCmp13# = "N";  |Y #siiw0001#nCmp14# = "N";
      |Y #siiw0001#nCmp15# = "N";  |Y #siiw0001#nCmp16# = "N";
         #siiw0001#nCmp1# = "S";
     |FINSI;

     |PINTA #siiw0001#nCmp1#;
     |PINTA #siiw0001#nCmp2#;
     |PINTA #siiw0001#nCmp4#;
     |PINTA #siiw0001#nCmp5#;
     |PINTA #siiw0001#nCmp6#;
     |PINTA #siiw0001#nCmp7#;
     |PINTA #siiw0001#nCmp9#;
     |PINTA #siiw0001#nCmp10#;
     |PINTA #siiw0001#nCmp11#;
     |PINTA #siiw0001#nCmp12#;
     |PINTA #siiw0001#nCmp13#;
     |PINTA #siiw0001#nCmp14#;
     |PINTA #siiw0001#nCmp15#;
     |PINTA #siiw0001#nCmp16#;
|FPRC;

|PROCESO PonMes;
                              #siiw0001#2 = "";
     |SI #siiw0001#1 = "01";  #siiw0001#2 = "ENERO";       |FINSI;
     |SI #siiw0001#1 = "02";  #siiw0001#2 = "FEBRERO";     |FINSI;
     |SI #siiw0001#1 = "03";  #siiw0001#2 = "MARZO";       |FINSI;
     |SI #siiw0001#1 = "04";  #siiw0001#2 = "ABRIL";       |FINSI;
     |SI #siiw0001#1 = "05";  #siiw0001#2 = "MAYO";        |FINSI;
     |SI #siiw0001#1 = "06";  #siiw0001#2 = "JUNIO";       |FINSI;
     |SI #siiw0001#1 = "07";  #siiw0001#2 = "JULIO";       |FINSI;
     |SI #siiw0001#1 = "08";  #siiw0001#2 = "AGOSTO";      |FINSI;
     |SI #siiw0001#1 = "09";  #siiw0001#2 = "SEPTIEMBRE";  |FINSI;
     |SI #siiw0001#1 = "10";  #siiw0001#2 = "OCTUBRE";     |FINSI;
     |SI #siiw0001#1 = "11";  #siiw0001#2 = "NOVIEMBRE";   |FINSI;
     |SI #siiw0001#1 = "12";  #siiw0001#2 = "DICIEMBRE";   |FINSI;
     |SI #siiw0001#1 = "1T";  #siiw0001#2 = "1 TRIMSTRE";  |FINSI;
     |SI #siiw0001#1 = "2T";  #siiw0001#2 = "2 TRIMSTRE";  |FINSI;
     |SI #siiw0001#1 = "3T";  #siiw0001#2 = "3 TRIMSTRE";  |FINSI;
     |SI #siiw0001#1 = "4T";  #siiw0001#2 = "4 TRIMSTRE";  |FINSI;

     |SI #siim0001#5 = "M";
         |SI #siiw0001#1 = "1T";  #siiw0001#2 = "";  |FINSI;
         |SI #siiw0001#1 = "2T";  #siiw0001#2 = "";  |FINSI;
         |SI #siiw0001#1 = "3T";  #siiw0001#2 = "";  |FINSI;
         |SI #siiw0001#1 = "4T";  #siiw0001#2 = "";  |FINSI;
     |FINSI;

     |SI #siim0001#5 = "T";
         |SI #siiw0001#1 = "01";  #siiw0001#2 = "";  |FINSI;
         |SI #siiw0001#1 = "02";  #siiw0001#2 = "";  |FINSI;
         |SI #siiw0001#1 = "03";  #siiw0001#2 = "";  |FINSI;
         |SI #siiw0001#1 = "04";  #siiw0001#2 = "";  |FINSI;
         |SI #siiw0001#1 = "05";  #siiw0001#2 = "";  |FINSI;
         |SI #siiw0001#1 = "06";  #siiw0001#2 = "";  |FINSI;
         |SI #siiw0001#1 = "07";  #siiw0001#2 = "";  |FINSI;
         |SI #siiw0001#1 = "08";  #siiw0001#2 = "";  |FINSI;
         |SI #siiw0001#1 = "09";  #siiw0001#2 = "";  |FINSI;
         |SI #siiw0001#1 = "10";  #siiw0001#2 = "";  |FINSI;
         |SI #siiw0001#1 = "11";  #siiw0001#2 = "";  |FINSI;
         |SI #siiw0001#1 = "12";  #siiw0001#2 = "";  |FINSI;
     |FINSI;

     |PINTA #siiw0001#2;
|FPRC;

|PROCESO T0C1w1;  |TIPO 0;
     |HAZ PonMes;

     |SI #siiw0001#2 = "          ";
         |MENAV "0000Periodo incorrecto. ";
         |ERROR;
         |ACABA;
     |FINSI;

     |C_M #siiw0001#13, 1, "N";
     |C_M #siiw0001#14, 1, "N";
     |C_M #siiw0001#15, 1, "N";
     |C_M #siiw0001#16, 1, "N";
     |C_M #siiw0001#17, 1, "N";
     |C_M #siiw0001#18, 1, "N";

     |SI #siiw0001#1 = "12";  |O  #siiw0001#1 = "4T";
         |C_M #siiw0001#13, 1, "S";
         |C_M #siiw0001#14, 1, "S";
         |C_M #siiw0001#15, 1, "S";
         |C_M #siiw0001#16, 1, "S";
         |C_M #siiw0001#17, 1, "S";
         |C_M #siiw0001#18, 1, "S";
     |FINSI;

     |PINTA #siiw0001#13;
     |PINTA #siiw0001#14;
     |PINTA #siiw0001#15;
     |PINTA #siiw0001#16;
     |PINTA #siiw0001#17;
     |PINTA #siiw0001#18;
|FPRC;

|PROCESO T66C1w1;  |TIPO 66;
     aAlfa = "|C001WID";
     aID   = #siiw0001#aAlfa#;
     nID   = aID;

     |SI #siim0001#5 = "M";
         aPopup1  = nID;
         aPopup2  = 12;
         aPopup3  = "01-ENERO";
         aPopup4  = "02-FEBRERO";
         aPopup5  = "03-MARZO";
         aPopup6  = "04-ABRIL";
         aPopup7  = "05-MAYO";
         aPopup8  = "06-JUNIO";
         aPopup9  = "07-JULIO";
         aPopup10 = "08-AGOSTO";
         aPopup11 = "09-SEPTIEMBRE";
         aPopup12 = "10-OCTUBRE";
         aPopup13 = "11-NOVIEMBRE";
         aPopup14 = "12-DICIEMBRE";
     |FINSI;

     |SI #siim0001#5 = "T";
         aPopup1  = nID;
         aPopup2  = 4;
         aPopup3  = "1T-1 TRIMESTRE";
         aPopup4  = "2T-2 TRIMESTRE";
         aPopup5  = "3T-3 TRIMESTRE";
         aPopup6  = "4T-4 TRIMESTRE";
     |FINSI;

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 102;  #siiw0001#1 = aAlfa;
     |FINSI;

     |PINTA #siiw0001#1;

     |HAZ PonMes;
|FPRC;

|PROCESO T0C0w1;  |TIPO 0;
     fFecha = ~;
     aAlfa  = fFecha % -104;  nEje = aAlfa;

     |SI nEje = 2017;
         nDAnyo = nEje;
         nHAnyo = nEje + 1;
     |SINO;
         nDAnyo = nEje - 1;
         nHAnyo = nEje + 1;
     |FINSI;

     |SI #siiw0001#0 < nDAnyo;  |O #siiw0001#0 > nHAnyo;
         aAlfa = "0000El a¤o debe ser mayor o igual a " + nDAnyo;
         aAlfa = aAlfa + " y menor o igual a " + nHAnyo;
         |MENAV aAlfa;
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO T66C0w1;  |TIPO 66;
     fFecha = ~;
     aAlfa  = fFecha % -104;  nEje = aAlfa;

     aAlfa = "|C000WID";
     aID   = #siiw0001#aAlfa#;
     nID   = aID;

     aPopup1  = nID;  || Si fuera -1 en la posicion

     |SI nEje = 2017;
         aPopup2  = 2;
         nAnyo = nEje;      aPopup3  = nAnyo;
         nAnyo = nEje + 1;  aPopup4  = nAnyo;
     |SINO;
         aPopup2  = 3;
         nAnyo = nEje - 1;  aPopup3  = nAnyo;
         nAnyo = nEje;      aPopup4  = nAnyo;
         nAnyo = nEje + 1;  aPopup5  = nAnyo;
     |FINSI;

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         #siiw0001#0 = aPopup;
     |FINSI;

     |PINTA #siiw0001#0;
|FPRC;
