|FICHEROS;
     siim0007;
     siim1000;

     siiw0002,MANTE;
|FIN;

|VARIABLES;
     n0Vent              = 0;
     nOk                 = 0;
     nID                 = 0;
     nCmp1               = 0;
     nCmp2               = 0;
     nCmp3               = 0;
     nCmp4               = 0;
     nCmp5               = 0;
     nCmp6               = 0;
     nContenido          = 0;
     nConta              = 0;
     nContaBE            = 0;
     nContaPE            = 0;
     nContaEE            = 0;

     nContaBS1           = 0;
     nContaBS2           = 0;
     nContaBS3           = 0;
     nContaPS1           = 0;
     nContaPS2           = 0;
     nContaPS3           = 0;
     nContaES1           = 0;
     nContaES2           = 0;
     nContaES3           = 0;

     nContaBN1           = 0;
     nContaBN2           = 0;
     nContaPN1           = 0;
     nContaPN2           = 0;
     nContaEN1           = 0;
     nContaEN2           = 0;

     aAlfa               = "";
     aAlfa1              = "";
     aAlfa2              = "";
     aID                 = "";
     aContenido          = "";

     {-1}aVent           = "";
         aVent1          = 0;
         aVent2          = 0;
         aVent3          = 0;
         aVent4          = 0;
         aVent5          = "";

 {40}aPopup              = "";

     &eaVarDni           = "";
     &enCalcCif          = 0;
     &enBtnIde           = 0;
     &enBtnRec           = 0;
     &enBtnInm           = 0;
     &enBtnEnt           = 0;
     &eaH60              = "";
     &eaCodNif           = "";
     &eaNomNif           = "";
     &eaPaiNif           = "";
     &enID               = 0;
|FIN;

|PROCESO Chequeo;
     nOk = 0;

     |SI #siiw0002#21 < "01.01.2000";
         |MENAV "0000Contenido incorrecto en fecha de expedici¢n";

         nOk = 0;  |ACABA;
     |FINSI;

     |SI #siiw0002#5 = "01";  |O #siiw0002#5 = "07";
         |SI #siiw0002#6 ! "F2";  |Y #siiw0002#6 ! "F4";
          |Y #siiw0002#6 ! "R5";
             aAlfa = #siiw0002#15;  |QBF aAlfa;
             |SI aAlfa = "";
                 |MENAV "0000Contenido incorrecto NIF, debe tener contenido";

                 nOk = 0;  |ACABA;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #siiw0002#5 = "02";  |O #siiw0002#5 = "03"; |O #siiw0002#5 = "04";
      |O #siiw0002#5 = "05";  |O #siiw0002#5 = "06";
         aAlfa = #siiw0002#18;  |QBF aAlfa;
         |SI aAlfa = "";
             |MENAV "0000Contenido incorrecto NIF pais residencia, debe tener contenido";
             nOk = 0;  |ACABA;
         |FINSI;
     |FINSI;

     aAlfa = #siiw0002#17;  |QBF aAlfa;
     |SI aAlfa = "";
         #siiw0002#17 = "ES";
     |FINSI;

     |SI aAlfa = "ESP";
         #siiw0002#17 = "ES";
     |FINSI;

     aAlfa = #siiw0002#20;  |QBF aAlfa;
     |SI aAlfa ! "";
         |SI #siiw0002#20 = #siiw0002#19;
             |MENAV "0000Contenido incorrecto en £ltimo n£mero factura, debe ser distnto a n£mero factura";
             nOk = 0;  |ACABA;
         |FINSI;

         |SI #siiw0002#6 ! "F4";
             |MENAV "0000Contenido incorrecto en £ltimo n£mero factura, tiene contenido y el tipo de factura no es F4";
             nOk = 0;  |ACABA;
         |FINSI;
     |FINSI;


     aAlfa = #siiw0002#62 + #siiw0002#63 + #siiw0002#64;  |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000Sin contenido en descripci¢n de la operaci¢n";
         nOk = 0;  |ACABA;
     |FINSI;

     nOk = 0;
     |SI #siiw0002#6 = "R1";  nOk = 1;  |FINSI;
     |SI #siiw0002#6 = "R2";  nOk = 1;  |FINSI;
     |SI #siiw0002#6 = "R3";  nOk = 1;  |FINSI;
     |SI #siiw0002#6 = "R4";  nOk = 1;  |FINSI;
     |SI #siiw0002#6 = "R5";  nOk = 1;  |FINSI;

     |SI nOk = 0;
         |SI #siiw0002#65 ! " ";
             |MENAV "0000No procede contenido en tipo rectificativa";
             nOk = 0;  |ACABA;
         |FINSI;
     |FINSI;

     nOk = 0;
     |SI #siiw0002#7 = "12";  nOk = 1;  |FINSI;
     |SI #siiw0002#7 = "13";  nOk = 1;  |FINSI;
     |SI #siiw0002#8 = "12";  nOk = 1;  |FINSI;
     |SI #siiw0002#8 = "13";  nOk = 1;  |FINSI;
     |SI #siiw0002#9 = "12";  nOk = 1;  |FINSI;
     |SI #siiw0002#9 = "13";  nOk = 1;  |FINSI;

     |SI nOk = 1;
         nOk = 0;
         |PARA nCmp1 = 69;  |SI nCmp1 [ 97;  |HACIENDO nCmp1 = nCmp1 + 2;
               |SI #siiw0002#nCmp1# ! " ";
                   nOk = 1;  |SAL;
               |FINSI;
         |SIGUE;

         |SI nOk = 0;
             |MENAV "0000Es obligatorio informar del detalle de los inmuebles";
             nOk = 0;  |ACABA;
         |FINSI;
     |FINSI;

     nOk = 1;
|FPRC;

|PROCESO ControlaBtnw2;
     |ESTADO_CONTROL enBtnIde, "DISABLE";
     |ESTADO_CONTROL enBtnRec, "DISABLE";
     |ESTADO_CONTROL enBtnInm, "DISABLE";
     |ESTADO_CONTROL enBtnEnt, "ENABLE";

     |SI #siiw0002#6 = "F3";
         |ESTADO_CONTROL enBtnIde, "ENABLE";
     |FINSI;

     |SI #siiw0002#6 = "R1";  |O #siiw0002#6 = "R2";
      |O #siiw0002#6 = "R3";  |O #siiw0002#6 = "R4";
      |O #siiw0002#6 = "R5";
         |ESTADO_CONTROL enBtnRec, "ENABLE";
         |ESTADO_CONTROL enBtnIde, "ENABLE";
     |SINO;
         #siiw0002#65 = " ";
         #siiw0002#66 = 0;
         #siiw0002#67 = 0;
         #siiw0002#68 = 0;
     |FINSI;

     nOk = 0;
     |SI #siiw0002#7 = "11";  nOk = 1;  |FINSI;
     |SI #siiw0002#7 = "12";  nOk = 1;  |FINSI;
     |SI #siiw0002#7 = "13";  nOk = 1;  |FINSI;
     |SI #siiw0002#8 = "11";  nOk = 1;  |FINSI;
     |SI #siiw0002#8 = "12";  nOk = 1;  |FINSI;
     |SI #siiw0002#8 = "13";  nOk = 1;  |FINSI;
     |SI #siiw0002#9 = "11";  nOk = 1;  |FINSI;
     |SI #siiw0002#9 = "12";  nOk = 1;  |FINSI;
     |SI #siiw0002#9 = "13";  nOk = 1;  |FINSI;

     |SI nOk = 1;
         |ESTADO_CONTROL enBtnInm, "ENABLE";
     |SINO;
         |PDEFECTO #siiw0002, 69, 99;
     |FINSI;

     |C_M #siiw0002#20, 1, "S";
     |SI #siiw0002#6 ! "F4";
         |C_M #siiw0002#20, 1, "N";
     |FINSI;

     |C_M #siiw0002#61, 1, "S";
     |SI #siiw0002#7 ! "06";  |Y #siiw0002#8 ! "06";  |Y #siiw0002#9 ! "06";
         |C_M #siiw0002#61, 1, "N";  #siiw0002#61 = 0;
     |FINSI;

     |C_M #siiw0002#112, 1, "S";
     |SI #siiw0002#6 = "F2";
         |C_M #siiw0002#112, 1, "N";  #siiw0002#112 = "S";
     |FINSI;

     |PINTA #siiw0002#20;
     |PINTA #siiw0002#61;
     |PINTA #siiw0002#112;
|FPRC;

|PROCESO siim0007Bor;
     |BORRA 020#siim0007.a;
     |LIBERA #siim0007;
|FPRC;

|DEFBUCLE siim0007Bor;
     #siim0007#1;
     ;
     #siiw0002#0, #siiw0002#1, #siiw0002#2, "";
     #siiw0002#0, #siiw0002#1, #siiw0002#2, eaH60;
     be;
     NULL, siim0007Bor;
|FIN;

|PROCESO T12w2;   |TIPO 12;
     |SI FSalida = 7;
         |ESTADO_CONTROL enBtnIde, "DISABLE";
         |ESTADO_CONTROL enBtnRec, "DISABLE";
         |ESTADO_CONTROL enBtnInm, "DISABLE";
         |ESTADO_CONTROL enBtnEnt, "DISABLE";

         |ACABA;
     |FINSI;

     |SI FSalida ! 1;
         |POSICIONATE #siiw0002#5;
         |ERROR;
         |ACABA;
     |FINSI;

     |HAZ Chequeo;
     |SI nOk = 0;
         |ERROR;
         |POSICIONATE #siiw0002#5;
         |ACABA;
     |FINSI;

     |SI #siiw0002#6 ! "R1";  |Y #siiw0002#6 ! "R2";
      |Y #siiw0002#6 ! "R3";  |Y #siiw0002#6 ! "R4";
      |Y #siiw0002#6 ! "R5";  |Y #siiw0002#6 ! "F3";
         |BUCLE siim0007Bor;
     |FINSI;

     |ESTADO_CONTROL enBtnIde, "DISABLE";
     |ESTADO_CONTROL enBtnRec, "DISABLE";
     |ESTADO_CONTROL enBtnInm, "DISABLE";
     |ESTADO_CONTROL enBtnEnt, "DISABLE";
|FPRC;

|PROCESO T0Totalw2;  |TIPO 0;
     #siiw0002#28 = #siiw0002#23 + #siiw0002#25 + #siiw0002#27;
     #siiw0002#34 = #siiw0002#29 + #siiw0002#31 + #siiw0002#33;
     #siiw0002#40 = #siiw0002#35 + #siiw0002#37 + #siiw0002#39;
     #siiw0002#46 = #siiw0002#41 + #siiw0002#43 + #siiw0002#45;
     #siiw0002#52 = #siiw0002#47 + #siiw0002#49 + #siiw0002#51;
     #siiw0002#58 = #siiw0002#53 + #siiw0002#55 + #siiw0002#57;

     #siiw0002#59 = #siiw0002#28 + #siiw0002#34 + #siiw0002#40;
     #siiw0002#59 = #siiw0002#59 + #siiw0002#46 + #siiw0002#52;
     #siiw0002#59 = #siiw0002#59 + #siiw0002#58;

     |PINTA #siiw0002#28;
     |PINTA #siiw0002#34;
     |PINTA #siiw0002#40;
     |PINTA #siiw0002#46;
     |PINTA #siiw0002#52;
     |PINTA #siiw0002#58;
     |PINTA #siiw0002#59;
|FPRC;

|PROCESO T0Porcw2;  |TIPO 0;
     |SI #siiw0002#Campo# = nContenido;
         |ACABA;
     |FINSI;

     nCmp2 = Campo;
     |SI nCmp2 = 24; nCmp1 = 23;  |FINSI;
     |SI nCmp2 = 26; nCmp1 = 23;  |FINSI;

     |SI nCmp2 = 30; nCmp1 = 29;  |FINSI;
     |SI nCmp2 = 32; nCmp1 = 29;  |FINSI;

     |SI nCmp2 = 36; nCmp1 = 35;  |FINSI;
     |SI nCmp2 = 38; nCmp1 = 35;  |FINSI;

     |SI nCmp2 = 42; nCmp1 = 41;  |FINSI;
     |SI nCmp2 = 44; nCmp1 = 41;  |FINSI;

     |SI nCmp2 = 48; nCmp1 = 47;  |FINSI;
     |SI nCmp2 = 50; nCmp1 = 47;  |FINSI;

     |SI nCmp2 = 54; nCmp1 = 53;  |FINSI;
     |SI nCmp2 = 56; nCmp1 = 53;  |FINSI;

     nCmp3 = nCmp2 + 1;

     #siiw0002#nCmp3# = #siiw0002#nCmp1# % #siiw0002#nCmp2#;

     |PINTA #siiw0002#nCmp3#;
|FPRC;

|PROCESO T7Porcw2;  |TIPO 7;
     nContenido = #siiw0002#Campo#;
|FPRC;

|PROCESO T0C18w2;  |TIPO 0;
     |C_M #siiw0002#18, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     aAlfa = #siiw0002#18;  |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000Debe tener contenido.";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO T0C17w2;  |TIPO 0;
     |SI #siiw0002#17 = "   ";
         #siiw0002#17 = "ES";
     |FINSI;

     |SI #siiw0002#17 = "ESP";
         #siiw0002#17 = "ES";
     |FINSI;

     |SI #siiw0002#5 ! "01";  |Y #siiw0002#5 ! "07";
         |SI #siiw0002#17 = "ES ";
             |MENAV "0000Pais incorrecto";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #siiw0002#5 = "01";  |O #siiw0002#5 = "07";
         |SI #siiw0002#17 ! "ES ";
             |MENAV "0000Pais incorrecto";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |C_M #siiw0002#18, 1, "S";
     |SI #siiw0002#17 = "ES ";
         |C_M #siiw0002#18, 1, "N"; #siiw0002#18 = "";
     |FINSI;

     aAlfa = #siiw0002#18;  |QBF aAlfa;
     |SI #siiw0002#5 = "02";  |Y aAlfa = "";
         aAlfa = #siiw0002#17;  |QBF aAlfa;

         |SI aAlfa = "GR";  aAlfa = "EL";  |FINSI;

         #siiw0002#18 = aAlfa + #siiw0002#15;
     |FINSI;

     |PINTA #siiw0002#18;
|FPRC;

|PROCESO T0C15w2;  |TIPO 0;
     eaVarDni  = #siiw0002#Campo#;
     enCalcCif = 0;
     |HAZ LetraNif;
     eaVarDni = (eaVarDni + "             ") % 112;
     |SI #siiw0002#Campo# ! eaVarDni;
         |CONFI "0000SEl NIF puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #siiw0002#Campo# = eaVarDni;  |PINTA #siiw0002#Campo#;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     aContenido = Contenido;
     |SI #siiw0002#15 ! aContenido;
         eaCodNif = #siiw0002#15;
         |HAZ LeeNif;

         #siiw0002#16 = eaNomNif;
         #siiw0002#17 = eaPaiNif;
     |FINSI;

     aAlfa = #siiw0002#15 % 101;
     |SI aAlfa = "X";  |O aAlfa = "Y";
         #siiw0002#5 = "01";
     |FINSI;

     |PINTA #siiw0002#5;
     |PINTA #siiw0002#16;
     |PINTA #siiw0002#17;
     |PINTA #siiw0002#18;
|FPRC;

|PROCESO T0Niv;  |TIPO 0;
     nContaBE  = 0;
     nContaPE  = 0;
     nContaEE  = 0;

     nContaBS1 = 0;
     nContaBS2 = 0;
     nContaBS3 = 0;
     nContaPS1 = 0;
     nContaPS2 = 0;
     nContaPS3 = 0;
     nContaES1 = 0;
     nContaES2 = 0;
     nContaES3 = 0;

     nContaBN1 = 0;
     nContaBN2 = 0;
     nContaPN1 = 0;
     nContaPN2 = 0;
     nContaEN1 = 0;
     nContaEN2 = 0;

     |PARA nCmp1 = 213;  |SI nCmp1 [ 223;  |HACIENDO nCmp1 = nCmp1 + 2;
           nCmp2 = nCmp1 - 1;

           |SI #siiw0002#nCmp2# = " ";
               aAlfa1 = #siiw0002#nCmp1# % 101;
               |SI aAlfa1 = "E";
                   nContaBE = nContaBE + 1;
               |FINSI;

               |SI #siiw0002#nCmp1# = "S1";
                   nContaBS1 = nContaBS1 + 1;
               |FINSI;

               |SI #siiw0002#nCmp1# = "S2";
                   nContaBS2 = nContaBS2 + 1;
               |FINSI;

               |SI #siiw0002#nCmp1# = "S3";
                   nContaBS3 = nContaBS3 + 1;
               |FINSI;

               |SI #siiw0002#nCmp1# = "N1";
                   nContaBN1 = nContaBN1 + 1;
               |FINSI;

               |SI #siiw0002#nCmp1# = "N2";
                   nContaBN2 = nContaBN2 + 1;
               |FINSI;
           |FINSI;

           |SI #siiw0002#nCmp2# = "P";
               aAlfa1 = #siiw0002#nCmp1# % 101;
               |SI aAlfa1 = "E";
                   nContaPE = nContaPE + 1;
               |FINSI;

               |SI #siiw0002#nCmp1# = "S1";
                   nContaPS1 = nContaPS1 + 1;
               |FINSI;

               |SI #siiw0002#nCmp1# = "S2";
                   nContaPS2 = nContaPS2 + 1;
               |FINSI;

               |SI #siiw0002#nCmp1# = "S3";
                   nContaPS3 = nContaPS3 + 1;
               |FINSI;

               |SI #siiw0002#nCmp1# = "N1";
                   nContaPN1 = nContaPN1 + 1;
               |FINSI;

               |SI #siiw0002#nCmp1# = "N2";
                   nContaPN2 = nContaPN2 + 1;
               |FINSI;
           |FINSI;

           |SI #siiw0002#nCmp2# = "E";
               aAlfa1 = #siiw0002#nCmp1# % 101;
               |SI aAlfa1 = "E";
                   nContaEE = nContaEE + 1;
               |FINSI;

               |SI #siiw0002#nCmp1# = "S1";
                   nContaES1 = nContaES1 + 1;
               |FINSI;

               |SI #siiw0002#nCmp1# = "S2";
                   nContaES2 = nContaES2 + 1;
               |FINSI;

               |SI #siiw0002#nCmp1# = "S3";
                   nContaES3 = nContaES3 + 1;
               |FINSI;

               |SI #siiw0002#nCmp1# = "N1";
                   nContaEN1 = nContaEN1 + 1;
               |FINSI;

               |SI #siiw0002#nCmp1# = "N2";
                   nContaEN2 = nContaEN2 + 1;
               |FINSI;
           |FINSI;

     |SIGUE;

     nOk = 1;
     ||   |SI nContaBE > 1;  nOk = 0;  |FINSI;
     ||   |SI nContaPE > 1;  nOk = 0;  |FINSI;
     ||   |SI nContaEE > 1;  nOk = 0;  |FINSI;

     nConta = 0;
     |SI nContaBS1 ! 0;  nConta = nConta + 1;  |FINSI;
     |SI nContaBS2 ! 0;  nConta = nConta + 1;  |FINSI;
     |SI nContaBS3 ! 0;  nConta = nConta + 1;  |FINSI;

     |SI nConta > 1;  nOk = 0;   |FINSI;

     nConta = 0;
     |SI nContaPS1 ! 0;  nConta = nConta + 1;  |FINSI;
     |SI nContaPS2 ! 0;  nConta = nConta + 1;  |FINSI;
     |SI nContaPS3 ! 0;  nConta = nConta + 1;  |FINSI;

     |SI nConta > 1;  nOk = 0;   |FINSI;

     nConta = 0;
     |SI nContaES1 ! 0;  nConta = nConta + 1;  |FINSI;
     |SI nContaES2 ! 0;  nConta = nConta + 1;  |FINSI;
     |SI nContaES3 ! 0;  nConta = nConta + 1;  |FINSI;

     |SI nConta > 1;  nOk = 0;   |FINSI;

     |SI nContaBN1 > 1;  nOk = 0;   |FINSI;
     |SI nContaBN2 > 1;  nOk = 0;   |FINSI;

     |SI nContaPN1 > 1;  nOk = 0;   |FINSI;
     |SI nContaPN2 > 1;  nOk = 0;   |FINSI;

     |SI nContaEN1 > 1;  nOk = 0;   |FINSI;
     |SI nContaEN2 > 1;  nOk = 0;   |FINSI;

     |SI nOk = 0;
         aAlfa1 = #siiw0002#Campo# % 101;

         |SI aAlfa1 = "E";
||             |MENAV "0000Los tipos E no se pueden repetir.";
         |FINSI;

         |SI aAlfa1 = "S";
             |MENAV "0000Los tipos S no pueden ser distintos.";
         |FINSI;

         |SI #siiw0002#Campo# = "N1";
             |MENAV "0000Los tipos N1 no pueden repetir.";
         |FINSI;

         |SI #siiw0002#Campo# = "N2";
             |MENAV "0000Los tipos N2 no pueden repetir.";
         |FINSI;

         |ERROR;
         |ACABA;
     |FINSI;

     nOk = 0;

     |SI Campo = 213;  nCmp1 = 23;  |FINSI;
     |SI Campo = 215;  nCmp1 = 29;  |FINSI;
     |SI Campo = 217;  nCmp1 = 35;  |FINSI;
     |SI Campo = 219;  nCmp1 = 41;  |FINSI;
     |SI Campo = 221;  nCmp1 = 47;  |FINSI;
     |SI Campo = 223;  nCmp1 = 53;  |FINSI;

     nCmp2 = nCmp1 + 1;
     nCmp3 = nCmp1 + 2;
     nCmp4 = nCmp1 + 3;
     nCmp5 = nCmp1 + 4;

                                   nOk = 0;
     |SI #siiw0002#Campo# = "E1";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "E2";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "E3";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "E4";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "E5";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "E6";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "S1";  nOk = 2;  |FINSI;
     |SI #siiw0002#Campo# = "S2";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "S3";  nOk = 2;  |FINSI;
     |SI #siiw0002#Campo# = "N1";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "N2";  nOk = 1;  |FINSI;

     aAlfa1 = "S";
     aAlfa2 = "S";

     |SI nOk = 1;
         aAlfa1 = "S";
         aAlfa2 = "N";
     |FINSI;

     |SI nOk = 0;
         |SI #siiw0002#Campo# ! "  ";
             |MENAV "0000Contenido incorrecto.";
             |ERROR;
             |ACABA;
         |FINSI;

         #siiw0002#nCmp1# = 0;
         #siiw0002#nCmp2# = 0;
         #siiw0002#nCmp3# = 0;
         #siiw0002#nCmp4# = 0;
         #siiw0002#nCmp5# = 0;

         aAlfa1 = "N";
         aAlfa2 = "N";
     |FINSI;

     |SI aAlfa2 = "N";
         #siiw0002#nCmp2# = 0;
         #siiw0002#nCmp3# = 0;
         #siiw0002#nCmp4# = 0;
         #siiw0002#nCmp5# = 0;
     |FINSI;

     |C_M #siiw0002#nCmp1#, 1, aAlfa1;
     |C_M #siiw0002#nCmp2#, 1, aAlfa2;
     |C_M #siiw0002#nCmp3#, 1, aAlfa2;
     |C_M #siiw0002#nCmp4#, 1, aAlfa2;
     |C_M #siiw0002#nCmp5#, 1, aAlfa2;

     |PINTA #siiw0002#nCmp1#;
     |PINTA #siiw0002#nCmp2#;
     |PINTA #siiw0002#nCmp3#;
     |PINTA #siiw0002#nCmp4#;
     |PINTA #siiw0002#nCmp5#;
|FPRC;

|PROCESO T66Niv;  |TIPO 66;
     aAlfa = "|C014WID";
     aID   = #siiw0002#aAlfa#;
     nID   = aID;

     aPopup1  = nID;  || Si fuera -1 en la posicion

     aPopup2  = 11;
     aPopup3  = "E1. Sujeta y exenta. Articulo 20 (por operaciones interiores, sanidad, educacion, etc).";
     aPopup4  = "E2. Sujeta y exenta. Articulo 21 (por exportaciones).";
     aPopup5  = "E3. Sujeta y exenta. Articulo 22 (operaciones asimiladas a las exportaciones).";
     aPopup6  = "E4. Sujeta y exenta. Articulo 24 (régimen aduanero y fiscal, como mercancias de zonas francas)";
     aPopup7  = "E5. Sujeta y exenta. Articulo 25 (entregas a un estado miembro).";
     aPopup8  = "E6. Sujeta y exenta. Otros. ";
     aPopup9  = "S1. Sujeta y no exenta. Normal.";
     aPopup10 = "S2. Sujeta y no exenta. Inversión del sujeto pasivo.";
     aPopup11 = "S3. Sujeta y no exenta. Normal e Inversión del sujeto pasivo.";
     aPopup12 = "N1. No sujeta articulo 7, 14, otros.";
     aPopup13 = "N2. No sujeta por reglas de localizacion. ";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 102;  #siiw0002#Campo# = aAlfa;
     |FINSI;

     |PINTA #siiw0002#Campo#;
|FPRC;

|PROCESO T0Tip;  |TIPO 0;
     |C_M #siiw0002#Campo#, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     aAlfa = #siiw0002#15 % 101;

                               nOk = 1;
     |SI #siiw0002#5 = "01"; |Y aAlfa ! "N"; nOk = 0;  |FINSI;
     |SI #siiw0002#5 = "07"; |Y aAlfa ! "N"; nOk = 0;  |FINSI;
     |SI #siiw0002#6 = "F2";                 nOk = 0;  |FINSI;
     |SI #siiw0002#6 = "F4";                 nOk = 0;  |FINSI;
     |SI #siiw0002#6 = "R5";                 nOk = 0;  |FINSI;

     |SI nOk = 0;
         |SI #siiw0002#Campo# ! " ";
             |MENAV "0000Contenido incorrecto. En blanco";
         |FINSI;

         |ACABA;
     |FINSI;

     nOk = 0;
     |SI #siiw0002#Campo# = "P";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "E";  nOk = 1;  |FINSI;

     |SI Campo = 212;  nCmp1 = 23;  |FINSI;
     |SI Campo = 214;  nCmp1 = 29;  |FINSI;
     |SI Campo = 216;  nCmp1 = 35;  |FINSI;
     |SI Campo = 218;  nCmp1 = 41;  |FINSI;
     |SI Campo = 220;  nCmp1 = 47;  |FINSI;
     |SI Campo = 222;  nCmp1 = 53;  |FINSI;

     nCmp2 = nCmp1 + 1;
     nCmp3 = nCmp1 + 2;
     nCmp4 = nCmp1 + 3;
     nCmp5 = nCmp1 + 4;
     nCmp6 = Campo + 1;
     aAlfa = "S";

     |SI nOk = 0;
         |SI #siiw0002#Campo# = " ";
             aAlfa = "N";
             #siiw0002#nCmp1# = 0;
             #siiw0002#nCmp2# = 0;
             #siiw0002#nCmp3# = 0;
             #siiw0002#nCmp4# = 0;
             #siiw0002#nCmp5# = 0;
             #siiw0002#nCmp6# = "";
         |SINO;
             |MENAV "0000Contenido incorrecto. <P> o <E>";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |C_M #siiw0002#nCmp1#, 1, aAlfa;
     |C_M #siiw0002#nCmp2#, 1, aAlfa;
     |C_M #siiw0002#nCmp3#, 1, aAlfa;
     |C_M #siiw0002#nCmp4#, 1, aAlfa;
     |C_M #siiw0002#nCmp5#, 1, aAlfa;
     |C_M #siiw0002#nCmp6#, 1, aAlfa;

     |PINTA #siiw0002#nCmp1#;
     |PINTA #siiw0002#nCmp2#;
     |PINTA #siiw0002#nCmp3#;
     |PINTA #siiw0002#nCmp4#;
     |PINTA #siiw0002#nCmp5#;
     |PINTA #siiw0002#nCmp6#;
|FPRC;

|PROCESO T66Tip;  |TIPO 66;
     aAlfa = "|C013WID";
     aID   = #siiw0002#aAlfa#;
     nID   = aID;

     aPopup1  = nID;  || Si fuera -1 en la posicion
     aPopup2  = 2;
     aPopup3  = "P. Prestacion de servicios";
     aPopup4  = "E. Entrega de bienes";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 101;  #siiw0002#Campo# = aAlfa;
     |FINSI;

     |PINTA #siiw0002#Campo#;
|FPRC;

|PROCESO T7Tip;  |TIPO 7;
     aAlfa = #siiw0002#15 % 101;

                                             nOk = 1;
     |SI #siiw0002#5 = "01"; |Y aAlfa ! "N"; nOk = 0;  |FINSI;
     |SI #siiw0002#5 = "07"; |Y aAlfa ! "N"; nOk = 0;  |FINSI;
     |SI #siiw0002#6 = "F2";                 nOk = 0;  |FINSI;
     |SI #siiw0002#6 = "F4";                 nOk = 0;  |FINSI;
     |SI #siiw0002#6 = "R5";                 nOk = 0;  |FINSI;

     |SI nOk = 0;
         |C_M #siiw0002#212, 1, "N";  #siiw0002#212 = "";
         |C_M #siiw0002#214, 1, "N";  #siiw0002#214 = "";
         |C_M #siiw0002#216, 1, "N";  #siiw0002#216 = "";
         |C_M #siiw0002#218, 1, "N";  #siiw0002#218 = "";
         |C_M #siiw0002#220, 1, "N";  #siiw0002#220 = "";
         |C_M #siiw0002#222, 1, "N";  #siiw0002#222 = "";

         |PINTA #siiw0002#212;
         |PINTA #siiw0002#214;
         |PINTA #siiw0002#216;
         |PINTA #siiw0002#218;
         |PINTA #siiw0002#220;
         |PINTA #siiw0002#222;

         |ACABA;
     |FINSI;

     |C_M #siiw0002#212, 1, "S";
     |C_M #siiw0002#214, 1, "S";
     |C_M #siiw0002#216, 1, "S";
     |C_M #siiw0002#218, 1, "S";
     |C_M #siiw0002#220, 1, "S";
     |C_M #siiw0002#222, 1, "S";

     |PINTA #siiw0002#212;
     |PINTA #siiw0002#214;
     |PINTA #siiw0002#216;
     |PINTA #siiw0002#218;
     |PINTA #siiw0002#220;
     |PINTA #siiw0002#222;
|FPRC;

|PROCESO T0C7w2;   |TIPO 0;
     nOk = 0;

     |SI Campo ! 7;
         |SI #siiw0002#Campo# = "  ";  nOk = 1;  |FINSI;
     |FINSI;

     |SI #siiw0002#Campo# = "01";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "02";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "03";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "04";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "05";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "06";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "07";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "08";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "09";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "10";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "11";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "12";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "13";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "14";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "15";  nOk = 1;  |FINSI;
     |SI #siiw0002#Campo# = "16";  nOk = 1;  |FINSI;

     |SI nOk = 0;
         |MENAV "0000Contenido incorrecto. Pulse F11 para ver tabla de contenido";
         |ERROR;
         |ACABA;
     |FINSI;

     |SI Campo = 7;
         |C_M #siiw0002#8, 1, "S";
         |C_M #siiw0002#9, 1, "S";

         |SI #siiw0002#7 ! "05";  |Y #siiw0002#7 ! "06";
          |Y #siiw0002#7 ! "07";  |Y #siiw0002#7 ! "11";
          |Y #siiw0002#7 ! "12";  |Y #siiw0002#7 ! "13";
             |C_M #siiw0002#8, 1, "N";  #siiw0002#8 = "";
             |C_M #siiw0002#9, 1, "N";  #siiw0002#9 = "";
         |FINSI;

         |PINTA #siiw0002#8;
         |PINTA #siiw0002#9;

         |ACABA;
     |FINSI;

     |SI #siiw0002#Campo# = "  ";
         |ACABA;
     |FINSI;

     nOk = 0;
     |SI #siiw0002#7 = "05";
         |SI #siiw0002#Campo# = "01";  nOk = 1;  |FINSI;
         |SI #siiw0002#Campo# = "07";  nOk = 1;  |FINSI;
         |SI #siiw0002#Campo# = "11";  nOk = 1;  |FINSI;
         |SI #siiw0002#Campo# = "12";  nOk = 1;  |FINSI;
         |SI #siiw0002#Campo# = "13";  nOk = 1;  |FINSI;
     |FINSI;

     |SI #siiw0002#7 = "06";
         |SI #siiw0002#Campo# = "11";  nOk = 1;  |FINSI;
         |SI #siiw0002#Campo# = "12";  nOk = 1;  |FINSI;
         |SI #siiw0002#Campo# = "13";  nOk = 1;  |FINSI;
         |SI #siiw0002#Campo# = "14";  nOk = 1;  |FINSI;
         |SI #siiw0002#Campo# = "15";  nOk = 1;  |FINSI;
     |FINSI;

     |SI #siiw0002#7 = "07";
         |SI #siiw0002#Campo# = "01";  nOk = 1;  |FINSI;
         |SI #siiw0002#Campo# = "03";  nOk = 1;  |FINSI;
         |SI #siiw0002#Campo# = "05";  nOk = 1;  |FINSI;
         |SI #siiw0002#Campo# = "09";  nOk = 1;  |FINSI;
         |SI #siiw0002#Campo# = "11";  nOk = 1;  |FINSI;
         |SI #siiw0002#Campo# = "12";  nOk = 1;  |FINSI;
         |SI #siiw0002#Campo# = "13";  nOk = 1;  |FINSI;
         |SI #siiw0002#Campo# = "14";  nOk = 1;  |FINSI;
         |SI #siiw0002#Campo# = "15";  nOk = 1;  |FINSI;
     |FINSI;

     |SI #siiw0002#7 = "11";  |O #siiw0002#7 = "12";  |O #siiw0002#7 = "13";
         |SI #siiw0002#Campo# = "06";  nOk = 1;  |FINSI;
         |SI #siiw0002#Campo# = "07";  nOk = 1;  |FINSI;
         |SI #siiw0002#Campo# = "08";  nOk = 1;  |FINSI;
         |SI #siiw0002#Campo# = "15";  nOk = 1;  |FINSI;
     |FINSI;

     |SI nOk = 0;
         |MENAV "0000Contenido incorrecto. Pulse F11 para ver tabla de contenido";
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO T66C7w2;  |TIPO 66;
     aAlfa = "|C" + (("000" + Campo) % -103) + "WID";
     aID   = #siiw0002#aAlfa#;
     nID   = aID;

     aPopup1  = nID;  || Si fuera -1 en la posicion

     |SI Campo = 7;
         aPopup2  = 16;
         aPopup3  = "01. Operaciones de régimen general";
         aPopup4  = "02. Exportacion";
         aPopup5  = "03. Operaciones de R.E.B.U.";
         aPopup6  = "04. Operaciones régimen especial oro de inversión";
         aPopup7  = "05. Operaciones régimen especial agencias de viajes.";
         aPopup8  = "06. Operaciones régimen especial grupo de entidades en iva (nivel avanzado)";
         aPopup9  = "07. Operaciones de R.E.C.C.";
         aPopup10 = "08. Operaciones sujetas al IPSI/IGIC";
         aPopup11 = "09. Operaciones de facturación de las prestaciones de servicios de agencias de viaje";
         aPopup12 = "10. Cobros por cuenta de terceros de honorarios profesionales";
         aPopup13 = "11. Operaciones de arrendamiento de local de negocio sujetas a retención";
         aPopup14 = "12. Operaciones de arrendamiento de local de negocio no sujetos a retención";
         aPopup15 = "13. Operaciones de arrendamiento de local de negocio sujetas y no sujetas a retención";
         aPopup16 = "14. Factura con IVA pendiente de devengo (certificaciones de obra cuyo destinatario sea una Administración Pública)";
         aPopup17 = "15. Factura con IVA pendiente de devengo - operaciones de tracto sucesivo";
         aPopup18 = "16. Primer semestre 2017 y otras facturas anteriores a la inclusión del SII";
     |FINSI;

     |SI Campo ! 7;
         aPopup2  = "";

         |SI #siiw0002#7 = "05";
             aPopup2  = "6";
             aPopup3  = "    No procede clave de operación";
             aPopup4  = "01. Operaciones de régimen general";
             aPopup5  = "07. Operaciones de R.E.C.C.";
             aPopup6  = "11. Operaciones de arrendamiento de local de negocio sujetas a retención";
             aPopup7  = "12. Operaciones de arrendamiento de local de negocio no sujetos a retención";
             aPopup8  = "13. Operaciones de arrendamiento de local de negocio sujetas y no sujetas a retención";
         |FINSI;

         |SI #siiw0002#7 = "06";
             aPopup2  = "6";
             aPopup3  = "    No procede clave de operación";
             aPopup4  = "11. Operaciones de arrendamiento de local de negocio sujetas a retención";
             aPopup5  = "12. Operaciones de arrendamiento de local de negocio no sujetos a retención";
             aPopup6  = "13. Operaciones de arrendamiento de local de negocio sujetas y no sujetas a retención";
             aPopup7  = "14. Factura con IVA pendiente de devengo (certificaciones de obra cuyo destinatario sea una Administración Pública)";
             aPopup8  = "15. Factura con IVA pendiente de devengo - operaciones de tracto sucesivo";
         |FINSI;

         |SI #siiw0002#7 = "07";
             aPopup2  = "10";
             aPopup3  = "    No procede clave de operación";
             aPopup4  = "01. Operaciones de régimen general";
             aPopup5  = "03. Operaciones de R.E.B.U.";
             aPopup6  = "05. Operaciones régimen especial agencias de viajes.";
             aPopup7  = "09. Operaciones de facturación de las prestaciones de servicios de agencias de viaje";
             aPopup8  = "11. Operaciones de arrendamiento de local de negocio sujetas a retención";
             aPopup9  = "12. Operaciones de arrendamiento de local de negocio no sujetos a retención";
             aPopup10 = "13. Operaciones de arrendamiento de local de negocio sujetas y no sujetas a retención";
             aPopup11 = "14. Factura con IVA pendiente de devengo (certificaciones de obra cuyo destinatario sea una Administración Pública)";
             aPopup12 = "15. Factura con IVA pendiente de devengo - operaciones de tracto sucesivo";
         |FINSI;

         |SI #siiw0002#7 = "11";  |O #siiw0002#7 = "12";  |O #siiw0002#7 = "13";
             aPopup2  = "05";
             aPopup3  = "    No procede clave de operación";
             aPopup4  = "06. Operaciones régimen especial grupo de entidades en iva (nivel avanzado)";
             aPopup5  = "07. Operaciones de R.E.C.C.";
             aPopup6  = "08. Operaciones sujetas al IPSI/IGIC";
             aPopup7  = "15. Factura con IVA pendiente de devengo - operaciones de tracto sucesivo";
         |FINSI;
     |FINSI;

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 102;  #siiw0002#Campo# = aAlfa;
     |FINSI;

     |PINTA #siiw0002#Campo#;

     |HAZ ControlaBtnw2;
|FPRC;

|PROCESO T0C6w2;  |TIPO 0;
     nOk = 0;

     |SI #siiw0002#6 = "F1";  nOk = 1;  |FINSI;
     |SI #siiw0002#6 = "F2";  nOk = 1;  |FINSI;
     |SI #siiw0002#6 = "F3";  nOk = 1;  |FINSI;
     |SI #siiw0002#6 = "F4";  nOk = 1;  |FINSI;
     |SI #siiw0002#6 = "R1";  nOk = 1;  |FINSI;
     |SI #siiw0002#6 = "R2";  nOk = 1;  |FINSI;
     |SI #siiw0002#6 = "R3";  nOk = 1;  |FINSI;
     |SI #siiw0002#6 = "R4";  nOk = 1;  |FINSI;
     |SI #siiw0002#6 = "R5";  nOk = 1;  |FINSI;

     |SI nOk = 0;
         |MENAV "0000Contenido incorrecto. Pulse F11 para ver tabla de contenido";
         |ERROR;
         |ACABA;
     |FINSI;

     |HAZ ControlaBtnw2;
|FPRC;

|PROCESO T66C6w2;  |TIPO 66;
     aAlfa = "|C006WID";
     aID   = #siiw0002#aAlfa#;
     nID   = aID;

     aPopup1  = nID;  || Si fuera -1 en la posicion
     aPopup2  = 9;
     aPopup3  = "F1. Factura completa o simplificada cualificada del art.7.2 y 7.3";
     aPopup4  = "F2. Factura simplificada o sin identificacion del destinatario art.6.1.d";
     aPopup5  = "F3. Factura emitida en sustitucion de facturas simplificadas";
     aPopup6  = "F4. Asiento resumen de facturas.";
     aPopup7  = "R1. Factura rectificativa. Error fundado y Articulo 80 uno y dos LIVA.";
     aPopup8  = "R2. Factura rectificativa. Articulo 80 tres LIVA - concurso acreedores";
     aPopup9  = "R3. Articulo 80 cuatro LIVA - deuda incobrable.";
     aPopup10 = "R4. Resto";
     aPopup11 = "R5. Rectificativa en facturas simplificadas.";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 102;  #siiw0002#6 = aAlfa;
     |FINSI;

     |PINTA #siiw0002#6;
|FPRC;

|PROCESO T0C5w2;   |TIPO 0;
     nOk = 0;

     |SI #siiw0002#5 = "01";  nOk = 1;  |FINSI;
     |SI #siiw0002#5 = "02";  nOk = 1;  |FINSI;
     |SI #siiw0002#5 = "03";  nOk = 1;  |FINSI;
     |SI #siiw0002#5 = "04";  nOk = 1;  |FINSI;
     |SI #siiw0002#5 = "05";  nOk = 1;  |FINSI;
     |SI #siiw0002#5 = "06";  nOk = 1;  |FINSI;
     |SI #siiw0002#5 = "07";  nOk = 1;  |FINSI;

     |SI nOk = 0;
         |MENAV "0000 Clave identificaci¢n pais de residencia incorrecto";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO T66C5w2;  |TIPO 66;
     aAlfa = "|C005WID";
     aID   = #siiw0002#aAlfa#;
     nID   = aID;

     aPopup1  = nID;
     aPopup2  = 7;
     aPopup3  = "01 NIF";
     aPopup4  = "02 NIF/IVA (NIF operador intracomunitario)";
     aPopup5  = "03 Pasaporte";
     aPopup6  = "04 Documento Oficial de identificacion expedido por el pais o territorio de residencia";
     aPopup7  = "05 Certificado de residencia fiscal";
     aPopup8  = "06 Otro documento probatorio";
     aPopup9  = "07 No censado";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 102;  #siiw0002#5 = aAlfa;
     |FINSI;

     |PINTA #siiw0002#5;
|FPRC;

|PROCESO BtnBus;
     |ABRE #siim1000;
     |CONSULTA_CLAVE #2#siim1000;
     |SI FSalida = 0;
         #siiw0002#62 = #siim1000#1 % 180;
         #siiw0002#63 = #siim1000#1 % 8180;
         #siiw0002#64 = #siim1000#1 % 16180;

         |PINTA #siiw0002#62;
     |FINSI;
     |CIERRA #siim1000;

     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;

     |PTEC 808;
     |POSICIONATE #siiw0002#62;
|FPRC;

|PROCESO BtnMas;
     |VENTANA 0501, 0501, -1, 16, "";
     n0Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |SUB_EJECUTA "siim1000;MAS";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n0Vent;

     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;

     |SI enID ! 0;
         |ABRE #siim1000;
         #siim1000#0 = enID;
         |LEE 000#siim1000.=;
         |SI FSalida = 0;
             #siiw0002#62 = #siim1000#1 % 180;
             #siiw0002#63 = #siim1000#1 % 8180;
             #siiw0002#64 = #siim1000#1 % 16180;

             |PINTA #siiw0002#62;
         |FINSI;
         |CIERRA #siim1000;
     |FINSI;

     |PTEC 808;
     |POSICIONATE #siiw0002#62;
|FPRC;

|PROCESO BtnMen;
     |VENTANA 0501, 0501, -1, 16, "";
     n0Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |SUB_EJECUTA "siim1000;MENOS";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n0Vent;

     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;

     |PTEC 808;
|FPRC;
