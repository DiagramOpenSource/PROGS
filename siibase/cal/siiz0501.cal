|FICHEROS;
     siim0501;
     siiw0104;
     siiw0105;

     siiw0106;
     siiw0107;

     siiw0104@;
     trabajo@;
|FIN;

|VARIABLES;
     n0Vent              = 0;
     n1Vent              = 0;
     nTree               = -1;
     nHandle             = 0;
     nClave              = 0;
     nLong               = 0;
     nPos                = 0;
     nPosi               = 0;
     nCampo              = 0;
     nCargar             = 0;
     nEtiqueta           = 0;
     nEtiqueta0          = 0;
     nEtiqueta1          = 0;
     nEtiqueta2          = 0;
     nEtiqueta3          = 0;
     nEtiqueta4          = 0;
     nEtiqueta5          = 0;
     nEtiqueta6          = 0;
     nEtiqueta7          = 0;
     nEtiqueta8          = 0;
     nEtiqueta9          = 0;
     nCarp0              = 0;
     nCarp1              = 0;
     nCarp2              = 0;
     nCarp3              = 0;
     nCarp4              = 0;
     nCarp5              = 0;
     nCarp6              = 0;
     nCarp7              = 0;
     nCarp8              = 0;
     nCarp9              = 0;
     nDE0                = 0;
     nDE1                = 0;
     nDE2                = 0;
     nDE3                = 0;
     nDE4                = 0;
     nDE5                = 0;
     nDE6                = 0;
     nDE7                = 0;
     nDE8                = 0;
     nDE9                = 0;
     nHE0                = 0;
     nHE1                = 0;
     nHE2                = 0;
     nHE3                = 0;
     nHE4                = 0;
     nHE5                = 0;
     nHE6                = 0;
     nHE7                = 0;
     nHE8                = 0;
     nHE9                = 0;
     nNivel              = 0;
     nSit0               = 0;
     nSit1               = 0;
     nSit2               = 0;
     nSit3               = 0;
     nSit4               = 0;
     nSit5               = 0;
     nSit6               = 0;
     nSit7               = 0;
     nSit8               = 0;
     nSit9               = 0;
     nSitua              = 0;
     nOtro               = 0;
     nFSalida            = 0;
     nTCampo             = 0;
     nCmp                = 0;

     aFic                = "";
     aPath               = "";
     aAbreTxt            = "";
     aAbreXml            = "";

     aDef                = "";
     aEsc1               = "";
     aEsc2               = "";
     aRetu               = "";
     aTecla              = "";
     aContenido          = "";
     aTexto              = "";
     aAlfa               = "";
     aAlfa1              = "";
     aLong               = "";
     aCarac              = "";
     aFicTmp             = "";
     aEtiqueta           = "";
     aBusca              = "";
     aRefresca           = "";
     aBase               = "";
     aMas                = "";
     aQQ                 = "";

  {10} aPopup            = "";

     {-1}sTree           = 0;
     sT_nID              = 0;
     sT_nOper            = 0;
     sT_aData            = "";

     {-1}aVent           = "";
         aVent1          = 0;
         aVent2          = 0;
         aVent3          = 0;
         aVent4          = 0;
         aVent5          = "";

     &eaVer              = "";
     &eaEsq              = "";
     &eaAlfa             = "";
|FIN;

|PROCESO GrabaTree;
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO siiw0104Txt;
     aAlfa = #siiw0104#0;

     |SI #siiw0104#1  ! 0;  aAlfa = aAlfa + "," + #siiw0104#1;  |FINSI;
     |SI #siiw0104#2  ! 0;  aAlfa = aAlfa + "," + #siiw0104#2;  |FINSI;
     |SI #siiw0104#3  ! 0;  aAlfa = aAlfa + "," + #siiw0104#3;  |FINSI;
     |SI #siiw0104#4  ! 0;  aAlfa = aAlfa + "," + #siiw0104#4;  |FINSI;
     |SI #siiw0104#5  ! 0;  aAlfa = aAlfa + "," + #siiw0104#5;  |FINSI;
     |SI #siiw0104#6  ! 0;  aAlfa = aAlfa + "," + #siiw0104#6;  |FINSI;
     |SI #siiw0104#7  ! 0;  aAlfa = aAlfa + "," + #siiw0104#7;  |FINSI;
     |SI #siiw0104#8  ! 0;  aAlfa = aAlfa + "," + #siiw0104#8;  |FINSI;
     |SI #siiw0104#9  ! 0;  aAlfa = aAlfa + "," + #siiw0104#9;  |FINSI;

     aAlfa = aAlfa + ":" + #siiw0104#11;  |QBF aAlfa;

     aAlfa1  = #siiw0104#13;  |QBF aAlfa1;
     |SI aAlfa1 ! "";
         aAlfa = aAlfa + " " + #siiw0104#13 + " " + #siiw0104#14;  |QBF aAlfa;
     |FINSI;

     aAlfa1  = #siiw0104#12;  |QBF aAlfa1;
     |SI aAlfa1 ! "";
         aAlfa = aAlfa + " " + #siiw0104#12;  |QBF aAlfa;
     |FINSI;

     |SI #siiw0104#15 = "1";  aAlfa = aAlfa + " (Obligatorio)";  |FINSI;
     |SI #siiw0104#15 = "2";  aAlfa = aAlfa + " (Opcional)";     |FINSI;
     |SI #siiw0104#15 = "3";  aAlfa = aAlfa + " (Selecci¢n)";    |FINSI;

     aAlfa = aAlfa + "{{";
     aAlfa = aAlfa + (("00"  + #siiw0104#0) % -102);
     aAlfa = aAlfa + (("00"  + #siiw0104#1) % -102);
     aAlfa = aAlfa + (("00"  + #siiw0104#2) % -102);
     aAlfa = aAlfa + (("00"  + #siiw0104#3) % -102);
     aAlfa = aAlfa + (("00"  + #siiw0104#4) % -102);
     aAlfa = aAlfa + (("00"  + #siiw0104#5) % -102);
     aAlfa = aAlfa + (("00"  + #siiw0104#6) % -102);
     aAlfa = aAlfa + (("00"  + #siiw0104#7) % -102);
     aAlfa = aAlfa + (("00"  + #siiw0104#8) % -102);
     aAlfa = aAlfa + (("00"  + #siiw0104#9) % -102);
     aAlfa = aAlfa + "}}";
     |HAZ GrabaTree;
|FPRC;

|DEFBUCLE siiw0104Txt;
     #siiw0104#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, siiw0104Txt;
|FIN;

|PROCESO CreaTree;
     |SI nTree ! -1;
         aBusca =          (("00"  + #siiw0104#0) % -102);
         aBusca = aBusca + (("00"  + #siiw0104#1) % -102);
         aBusca = aBusca + (("00"  + #siiw0104#2) % -102);
         aBusca = aBusca + (("00"  + #siiw0104#3) % -102);
         aBusca = aBusca + (("00"  + #siiw0104#4) % -102);
         aBusca = aBusca + (("00"  + #siiw0104#5) % -102);
         aBusca = aBusca + (("00"  + #siiw0104#6) % -102);
         aBusca = aBusca + (("00"  + #siiw0104#7) % -102);
         aBusca = aBusca + (("00"  + #siiw0104#8) % -102);
         aBusca = aBusca + (("00"  + #siiw0104#9) % -102);

         |FIN_CONTROL_WINDOWS nTree;
     |FINSI;

     sT_nID   = nTree;
     sT_nOper = 0;

     |XABRE "WBC", aAbreTxt, nHandle;
     |BUCLE siiw0104Txt;
     |XCIERRA nHandle;

     aAlfa = "TREECTRL,Esquema {{" + aAbreTxt + "}}";
     |CONTROL_SIMPLE 0, aAlfa, 0502, 3598, EvntTree;
     nTree = FSalida;

     |SI aBusca ! "";
         sT_nID   = nTree;
         sT_nOper = 3;
         sT_aData = "[" + aBusca;
         |ESPECIFICA "COMMANDCONTROL", sTree;
         aRefresca = ":" + FSalida;
     |FINSI;

     sT_nID   = nTree;
     sT_nOper = 2;
     |SI aRefresca = "";
         sT_aData = "1:";
     |SINO;
         sT_aData = aRefresca;
     |FINSI;

     |ESPECIFICA "COMMANDCONTROL", sTree;
     |PULSATECLA;

     |FOCOTECLADO nTree;
|FPRC;

|PROCESO RecogeDeContenido;
     aAlfa = aContenido % 102;  nEtiqueta0 = aAlfa;
     aAlfa = aContenido % 302;  nEtiqueta1 = aAlfa;
     aAlfa = aContenido % 502;  nEtiqueta2 = aAlfa;
     aAlfa = aContenido % 702;  nEtiqueta3 = aAlfa;
     aAlfa = aContenido % 902;  nEtiqueta4 = aAlfa;
     aAlfa = aContenido % 1102; nEtiqueta5 = aAlfa;
     aAlfa = aContenido % 1302; nEtiqueta6 = aAlfa;
     aAlfa = aContenido % 1502; nEtiqueta7 = aAlfa;
     aAlfa = aContenido % 1702; nEtiqueta8 = aAlfa;
     aAlfa = aContenido % 1902; nEtiqueta9 = aAlfa;
|FPRC;

|PROCESO siiw0104Renumera;
     |SI nCarp0 ! #siiw0104#0;
         nEtiqueta0 = nEtiqueta0 + 1;

         nEtiqueta1 = 0;
         nEtiqueta2 = 0;
         nEtiqueta3 = 0;
         nEtiqueta4 = 0;
         nEtiqueta5 = 0;
         nEtiqueta6 = 0;
         nEtiqueta7 = 0;
         nEtiqueta8 = 0;
         nEtiqueta9 = 0;

         nCarp0    = #siiw0104#0;
         nCarp1    = #siiw0104#1;
         nCarp2    = #siiw0104#2;
         nCarp3    = #siiw0104#3;
         nCarp4    = #siiw0104#4;
         nCarp5    = #siiw0104#5;
         nCarp6    = #siiw0104#6;
         nCarp7    = #siiw0104#7;
         nCarp8    = #siiw0104#8;
         nCarp9    = #siiw0104#9;
     |FINSI;

     |SI nCarp1 ! #siiw0104#1;
         nEtiqueta1 = nEtiqueta1 + 1;

         nEtiqueta2 = 0;
         nEtiqueta3 = 0;
         nEtiqueta4 = 0;
         nEtiqueta5 = 0;
         nEtiqueta6 = 0;
         nEtiqueta7 = 0;
         nEtiqueta8 = 0;
         nEtiqueta9 = 0;

         nCarp1    = #siiw0104#1;
         nCarp2    = #siiw0104#2;
         nCarp3    = #siiw0104#3;
         nCarp4    = #siiw0104#4;
         nCarp5    = #siiw0104#5;
         nCarp6    = #siiw0104#6;
         nCarp7    = #siiw0104#7;
         nCarp8    = #siiw0104#8;
         nCarp9    = #siiw0104#9;
     |FINSI;

     |SI nCarp2 ! #siiw0104#2;
         nEtiqueta2 = nEtiqueta2 + 1;

         nEtiqueta3 = 0;
         nEtiqueta4 = 0;
         nEtiqueta5 = 0;
         nEtiqueta6 = 0;
         nEtiqueta7 = 0;
         nEtiqueta8 = 0;
         nEtiqueta9 = 0;

         nCarp2    = #siiw0104#2;
         nCarp3    = #siiw0104#3;
         nCarp4    = #siiw0104#4;
         nCarp5    = #siiw0104#5;
         nCarp6    = #siiw0104#6;
         nCarp7    = #siiw0104#7;
         nCarp8    = #siiw0104#8;
         nCarp9    = #siiw0104#9;
     |FINSI;

     |SI nCarp3 ! #siiw0104#3;
         nEtiqueta3 = nEtiqueta3 + 1;

         nEtiqueta4 = 0;
         nEtiqueta5 = 0;
         nEtiqueta6 = 0;
         nEtiqueta7 = 0;
         nEtiqueta8 = 0;
         nEtiqueta9 = 0;

         nCarp3    = #siiw0104#3;
         nCarp4    = #siiw0104#4;
         nCarp5    = #siiw0104#5;
         nCarp6    = #siiw0104#6;
         nCarp7    = #siiw0104#7;
         nCarp8    = #siiw0104#8;
         nCarp9    = #siiw0104#9;
     |FINSI;

     |SI nCarp4 ! #siiw0104#4;
         nEtiqueta4 = nEtiqueta4 + 1;

         nEtiqueta5 = 0;
         nEtiqueta6 = 0;
         nEtiqueta7 = 0;
         nEtiqueta8 = 0;
         nEtiqueta9 = 0;

         nCarp4    = #siiw0104#4;
         nCarp5    = #siiw0104#5;
         nCarp6    = #siiw0104#6;
         nCarp7    = #siiw0104#7;
         nCarp8    = #siiw0104#8;
         nCarp9    = #siiw0104#9;
     |FINSI;

     |SI nCarp5 ! #siiw0104#5;
         nEtiqueta5 = nEtiqueta5 + 1;

         nEtiqueta6 = 0;
         nEtiqueta7 = 0;
         nEtiqueta8 = 0;
         nEtiqueta9 = 0;

         nCarp5    = #siiw0104#5;
         nCarp6    = #siiw0104#6;
         nCarp7    = #siiw0104#7;
         nCarp8    = #siiw0104#8;
         nCarp9    = #siiw0104#9;
     |FINSI;

     |SI nCarp6 ! #siiw0104#6;
         nEtiqueta6 = nEtiqueta6 + 1;

         nEtiqueta7 = 0;
         nEtiqueta8 = 0;
         nEtiqueta9 = 0;

         nCarp6    = #siiw0104#6;
         nCarp7    = #siiw0104#7;
         nCarp8    = #siiw0104#8;
         nCarp9    = #siiw0104#9;
     |FINSI;

     |SI nCarp7 ! #siiw0104#7;
         nEtiqueta7 = nEtiqueta7 + 1;

         nEtiqueta8 = 0;
         nEtiqueta9 = 0;

         nCarp7    = #siiw0104#7;
         nCarp8    = #siiw0104#8;
         nCarp9    = #siiw0104#9;
     |FINSI;

     |SI nCarp8 ! #siiw0104#8;
         nEtiqueta8 = nEtiqueta8 + 1;

         nEtiqueta9 = 0;

         nCarp8    = #siiw0104#8;
         nCarp9    = #siiw0104#9;
     |FINSI;

     |SI nCarp9 ! #siiw0104#9;
         nEtiqueta9 = nEtiqueta9 + 1;

         nCarp9    = #siiw0104#9;
     |FINSI;

     #siiw0104@#0  = nEtiqueta0;
     #siiw0104@#1  = nEtiqueta1;
     #siiw0104@#2  = nEtiqueta2;
     #siiw0104@#3  = nEtiqueta3;
     #siiw0104@#4  = nEtiqueta4;
     #siiw0104@#5  = nEtiqueta5;
     #siiw0104@#6  = nEtiqueta6;
     #siiw0104@#7  = nEtiqueta7;
     #siiw0104@#8  = nEtiqueta8;
     #siiw0104@#9  = nEtiqueta9;
     #siiw0104@#10 = #siiw0104#10;
     #siiw0104@#11 = #siiw0104#11;
     #siiw0104@#12 = #siiw0104#12;
     #siiw0104@#13 = #siiw0104#13;
     #siiw0104@#14 = #siiw0104#14;
     #siiw0104@#15 = #siiw0104#15;

     |GRABA 020#siiw0104@.n;
     |LIBERA #siiw0104@;

     |SI  #siiw0104#0 = nSit0;  |Y  #siiw0104#1 = nSit1;  |Y  #siiw0104#2 = nSit2;
      |Y  #siiw0104#3 = nSit3;  |Y  #siiw0104#4 = nSit4;  |Y  #siiw0104#5 = nSit5;
      |Y  #siiw0104#6 = nSit6;  |Y  #siiw0104#7 = nSit7;  |Y  #siiw0104#8 = nSit8;
      |Y  #siiw0104#9 = nSit9;
          nSit0 = #siiw0104@#0;
          nSit1 = #siiw0104@#1;
          nSit2 = #siiw0104@#2;
          nSit3 = #siiw0104@#3;
          nSit4 = #siiw0104@#4;
          nSit5 = #siiw0104@#5;
          nSit6 = #siiw0104@#6;
          nSit7 = #siiw0104@#7;
          nSit8 = #siiw0104@#8;
          nSit9 = #siiw0104@#9;
     |FINSI;
|FPRC;

|DEFBUCLE siiw0104Renumera;
     #siiw0104#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, siiw0104Renumera;
|FIN;

|PROCESO reflejo;
     #siiw0104#0  = #siiw0104@#0;
     #siiw0104#1  = #siiw0104@#1;
     #siiw0104#2  = #siiw0104@#2;
     #siiw0104#3  = #siiw0104@#3;
     #siiw0104#4  = #siiw0104@#4;
     #siiw0104#5  = #siiw0104@#5;
     #siiw0104#6  = #siiw0104@#6;
     #siiw0104#7  = #siiw0104@#7;
     #siiw0104#8  = #siiw0104@#8;
     #siiw0104#9  = #siiw0104@#9;
     #siiw0104#10 = #siiw0104@#10;
     #siiw0104#11 = #siiw0104@#11;
     #siiw0104#12 = #siiw0104@#12;
     #siiw0104#13 = #siiw0104@#13;
     #siiw0104#14 = #siiw0104@#14;
     #siiw0104#15 = #siiw0104@#15;

     |GRABA 020#siiw0104.n;
     |LIBERA #siiw0104;
|FPRC;

|DEFBUCLE reflejo;
     #siiw0104@#1010;
     ;
     00, 00, 00, 00, 00, 00, 00, 00, 00, 00;
     99, 99, 99, 99, 99, 99, 99, 99, 99, 99;
     be;
     NULL, reflejo;
|FIN;

|PROCESO Renumeracion;
     nEtiqueta0 = 0;
     nEtiqueta1 = 0;
     nEtiqueta2 = 0;
     nEtiqueta3 = 0;
     nEtiqueta4 = 0;
     nEtiqueta5 = 0;
     nEtiqueta6 = 0;
     nEtiqueta7 = 0;
     nEtiqueta8 = 0;
     nEtiqueta9 = 0;

     |DDEF aDef;  |QBF aDef;
     aDef = aDef + "siiw0104.mas";
     |CARGA_DEF aDef, siiw0104@;

     aFicTmp = "tmpw0104" + Usuario;
     |NOME_DAT #siiw0104@#aFicTmp#;
     |ABRE #siiw0104@;  |CIERRA #siiw0104@;  |DELINDEX #siiw0104@;

     |ABRE #siiw0104@;
     |BUCLE siiw0104Renumera;
     |CIERRA #siiw0104@;

     |CIERRAT #siiw0104;
     |DELINDEX #siiw0104;

     |ABRET #siiw0104;
     |BUCLE reflejo;

     |DELINDEX #siiw0104@;
     |DESCARGA_DEF #siiw0104@;
|FPRC;

|PROCESO siiw0104SubeLista;
     #siiw0104@#0 = #siiw0104#0;
     #siiw0104@#1 = #siiw0104#1;
     #siiw0104@#2 = #siiw0104#2;
     #siiw0104@#3 = #siiw0104#3;
     #siiw0104@#4 = #siiw0104#4;
     #siiw0104@#5 = #siiw0104#5;
     #siiw0104@#6 = #siiw0104#6;
     #siiw0104@#7 = #siiw0104#7;
     #siiw0104@#8 = #siiw0104#8;
     #siiw0104@#9 = #siiw0104#9;

     |SI nNivel = 1;
         nOtro = nEtiqueta0 - 1;

         |SI #siiw0104#0 = nEtiqueta0;
             #siiw0104@#0 = #siiw0104#0 - 1;
         |FINSI;

         |SI #siiw0104#0 = nOtro;
             #siiw0104@#0 = #siiw0104#0 + 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 2;
         nOtro = nEtiqueta1 - 1;

         |SI #siiw0104#1 = nEtiqueta1;
             #siiw0104@#1 = #siiw0104#1 - 1;
         |FINSI;

         |SI #siiw0104#1 = nOtro;
             #siiw0104@#1 = #siiw0104#1 + 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 3;
         nOtro = nEtiqueta2 - 1;

         |SI #siiw0104#2 = nEtiqueta2;
             #siiw0104@#2 = #siiw0104#2 - 1;
         |FINSI;

         |SI #siiw0104#2 = nOtro;
             #siiw0104@#2 = #siiw0104#2 + 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 4;
         nOtro = nEtiqueta3 - 1;

         |SI #siiw0104#3 = nEtiqueta3;
             #siiw0104@#3 = #siiw0104#3 - 1;
         |FINSI;

         |SI #siiw0104#3 = nOtro;
             #siiw0104@#3 = #siiw0104#3 + 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 5;
         nOtro = nEtiqueta4 - 1;

         |SI #siiw0104#4 = nEtiqueta4;
             #siiw0104@#4 = #siiw0104#4 - 1;
         |FINSI;

         |SI #siiw0104#4 = nOtro;
             #siiw0104@#4 = #siiw0104#4 + 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 6;
         nOtro = nEtiqueta5 - 1;

         |SI #siiw0104#5 = nEtiqueta5;
             #siiw0104@#5 = #siiw0104#5 - 1;
         |FINSI;

         |SI #siiw0104#5 = nOtro;
             #siiw0104@#5 = #siiw0104#5 + 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 7;
         nOtro = nEtiqueta6 - 1;

         |SI #siiw0104#6 = nEtiqueta6;
             #siiw0104@#6 = #siiw0104#6 - 1;
         |FINSI;

         |SI #siiw0104#6 = nOtro;
             #siiw0104@#6 = #siiw0104#6 + 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 8;
         nOtro = nEtiqueta7 - 1;

         |SI #siiw0104#7 = nEtiqueta7;
             #siiw0104@#7 = #siiw0104#7 - 1;
         |FINSI;

         |SI #siiw0104#7 = nOtro;
             #siiw0104@#7 = #siiw0104#7 + 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 9;
         nOtro = nEtiqueta8 - 1;

         |SI #siiw0104#8 = nEtiqueta8;
             #siiw0104@#8 = #siiw0104#8 - 1;
         |FINSI;

         |SI #siiw0104#8 = nOtro;
             #siiw0104@#8 = #siiw0104#8 + 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 10;
         nOtro = nEtiqueta9 - 1;

         |SI #siiw0104#9 = nEtiqueta9;
             #siiw0104@#9 = #siiw0104#9 - 1;
         |FINSI;

         |SI #siiw0104#9 = nOtro;
             #siiw0104@#9 = #siiw0104#9 + 1;
         |FINSI;
     |FINSI;

     #siiw0104@#10 = #siiw0104#10;
     #siiw0104@#11 = #siiw0104#11;
     #siiw0104@#12 = #siiw0104#12;
     #siiw0104@#13 = #siiw0104#13;
     #siiw0104@#14 = #siiw0104#14;
     #siiw0104@#15 = #siiw0104#15;

     |GRABA 020#siiw0104@.n;
     |LIBERA #siiw0104@;

     |SI nSitua = 0;
         nSit0  = #siiw0104@#0;
         nSit1  = #siiw0104@#1;
         nSit2  = #siiw0104@#2;
         nSit3  = #siiw0104@#3;
         nSit4  = #siiw0104@#4;
         nSit5  = #siiw0104@#5;
         nSit6  = #siiw0104@#6;
         nSit7  = #siiw0104@#7;
         nSit8  = #siiw0104@#8;
         nSit9  = #siiw0104@#9;
         nSitua = 1;
     |FINSI;

     |BORRA 020#siiw0104.a;
     |LIBERA #siiw0104;
|FPRC;

|DEFBUCLE siiw0104SubeLista;
     #siiw0104#1;
     ;
     nDE0, nDE1, nDE2, nDE3, nDE4, nDE5, nDE6, nDE7, nDE8, nDE9;
     nHE0, nHE1, nHE2, nHE3, nHE4, nHE5, nHE6, nHE7, nHE8, nHE9;
     be;
     NULL, siiw0104SubeLista;
|FIN;

|PROCESO DHSubirLista;
     |SI nEtiqueta1 = 0;
         |SI nEtiqueta0 = 1;  |ACABA;  |FINSI;

         nNivel = 1;
         nDE0   = nEtiqueta0 - 1;
         nHE0   = 99;

         nDE1   = 0; nHE1   = 99;
         nDE2   = 0; nHE2   = 99;
         nDE3   = 0; nHE3   = 99;
         nDE4   = 0; nHE4   = 99;
         nDE5   = 0; nHE5   = 99;
         nDE6   = 0; nHE6   = 99;
         nDE7   = 0; nHE7   = 99;
         nDE8   = 0; nHE8   = 99;
         nDE9   = 0; nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta2 = 0;
         |SI nEtiqueta1 = 1;  |ACABA;  |FINSI;

         nNivel = 2;
         nDE1   = nEtiqueta1 - 1;
         nHE1   = 99;

         nDE2   = 0; nHE2   = 99;
         nDE3   = 0; nHE3   = 99;
         nDE4   = 0; nHE4   = 99;
         nDE5   = 0; nHE5   = 99;
         nDE6   = 0; nHE6   = 99;
         nDE7   = 0; nHE7   = 99;
         nDE8   = 0; nHE8   = 99;
         nDE9   = 0; nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta3 = 0;
         |SI nEtiqueta2 = 1;  |ACABA;  |FINSI;

         nNivel = 3;
         nDE2   = nEtiqueta2 - 1;
         nHE2   = 99;

         nDE3   = 0; nHE3   = 99;
         nDE4   = 0; nHE4   = 99;
         nDE5   = 0; nHE5   = 99;
         nDE6   = 0; nHE6   = 99;
         nDE7   = 0; nHE7   = 99;
         nDE8   = 0; nHE8   = 99;
         nDE9   = 0; nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta4 = 0;
         |SI nEtiqueta3 = 1;  |ACABA;  |FINSI;

         nNivel = 4;
         nDE3   = nEtiqueta3 - 1;
         nHE3   = 99;

         nDE4   = 0; nHE4   = 99;
         nDE5   = 0; nHE5   = 99;
         nDE6   = 0; nHE6   = 99;
         nDE7   = 0; nHE7   = 99;
         nDE8   = 0; nHE8   = 99;
         nDE9   = 0; nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta5 = 0;
         |SI nEtiqueta4 = 1;  |ACABA;  |FINSI;

         nNivel = 5;
         nDE4   = nEtiqueta4 - 1;
         nHE4   = 99;

         nDE5   = 0; nHE5   = 99;
         nDE6   = 0; nHE6   = 99;
         nDE7   = 0; nHE7   = 99;
         nDE8   = 0; nHE8   = 99;
         nDE9   = 0; nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta6 = 0;
         |SI nEtiqueta5 = 1;  |ACABA;  |FINSI;

         nNivel = 6;
         nDE5   = nEtiqueta5 - 1;
         nHE5   = 99;

         nDE6   = 0; nHE6   = 99;
         nDE7   = 0; nHE7   = 99;
         nDE8   = 0; nHE8   = 99;
         nDE9   = 0; nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta7 = 0;
         |SI nEtiqueta6 = 1;  |ACABA;  |FINSI;

         nNivel = 7;
         nDE6   = nEtiqueta6 - 1;
         nHE6   = 99;

         nDE7   = 0; nHE7   = 99;
         nDE8   = 0; nHE8   = 99;
         nDE9   = 0; nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta8 = 0;
         |SI nEtiqueta7 = 1;  |ACABA;  |FINSI;

         nNivel = 8;
         nDE7   = nEtiqueta7 - 1;
         nHE7   = 99;

         nDE8   = 0; nHE8   = 99;
         nDE9   = 0; nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta9 = 0;
         |SI nEtiqueta8 = 1;  |ACABA;  |FINSI;

         nNivel = 9;
         nDE8   = nEtiqueta8 - 1;
         nHE8   = 99;

         nDE9   = 0; nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta9 = 1;  |ACABA;  |FINSI;

     nNivel = 10;
     nDE9   = nEtiqueta9 - 1;
     nHE9   = 99;
|FPRC;

|PROCESO SubirLista;
     |SI aContenido = "";  |ACABA;  |FINSI;

     |HAZ RecogeDeContenido;

     #siiw0104#0 = nEtiqueta0;
     #siiw0104#1 = nEtiqueta1;
     #siiw0104#2 = nEtiqueta2;
     #siiw0104#3 = nEtiqueta3;
     #siiw0104#4 = nEtiqueta4;
     #siiw0104#5 = nEtiqueta5;
     #siiw0104#6 = nEtiqueta6;
     #siiw0104#7 = nEtiqueta7;
     #siiw0104#8 = nEtiqueta8;
     #siiw0104#9 = nEtiqueta9;
     |LEE 000#siiw0104.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nDE0 = nEtiqueta0;  nHE0 = nEtiqueta0;
     nDE1 = nEtiqueta1;  nHE1 = nEtiqueta1;
     nDE2 = nEtiqueta2;  nHE2 = nEtiqueta2;
     nDE3 = nEtiqueta3;  nHE3 = nEtiqueta3;
     nDE4 = nEtiqueta4;  nHE4 = nEtiqueta4;
     nDE5 = nEtiqueta5;  nHE5 = nEtiqueta5;
     nDE6 = nEtiqueta6;  nHE6 = nEtiqueta6;
     nDE7 = nEtiqueta7;  nHE7 = nEtiqueta7;
     nDE8 = nEtiqueta8;  nHE8 = nEtiqueta8;
     nDE9 = nEtiqueta9;  nHE9 = nEtiqueta9;

     |HAZ DHSubirLista;

     |DDEF aDef;  |QBF aDef;
     aDef = aDef + "siiw0104.mas";
     |CARGA_DEF aDef, siiw0104@;

     aFicTmp = "tmpw0104" + Usuario;
     |NOME_DAT #siiw0104@#aFicTmp#;
     |ABRE #siiw0104@;  |CIERRA #siiw0104@;  |DELINDEX #siiw0104@;

     nSitua = 0;
     |ABRE #siiw0104@;
     |BUCLE siiw0104SubeLista;
     |CIERRA #siiw0104@;

     |SI nSitua = 0;
         |DELINDEX #siiw0104@;
         |DESCARGA_DEF #siiw0104@;
         |ACABA;
     |FINSI;

     |BUCLE reflejo;
     |DELINDEX #siiw0104@;
     |DESCARGA_DEF #siiw0104@;

     |HAZ Renumeracion;

     #siiw0104#0 = nSit0;
     #siiw0104#1 = nSit1;
     #siiw0104#2 = nSit2;
     #siiw0104#3 = nSit3;
     #siiw0104#4 = nSit4;
     #siiw0104#5 = nSit5;
     #siiw0104#6 = nSit6;
     #siiw0104#7 = nSit7;
     #siiw0104#8 = nSit8;
     #siiw0104#9 = nSit9;
     |LEE 000#siiw0104.=;

     |HAZ CreaTree;
|FPRC;

|PROCESO siiw0104BajaLista;
     #siiw0104@#0 = #siiw0104#0;
     #siiw0104@#1 = #siiw0104#1;
     #siiw0104@#2 = #siiw0104#2;
     #siiw0104@#3 = #siiw0104#3;
     #siiw0104@#4 = #siiw0104#4;
     #siiw0104@#5 = #siiw0104#5;
     #siiw0104@#6 = #siiw0104#6;
     #siiw0104@#7 = #siiw0104#7;
     #siiw0104@#8 = #siiw0104#8;
     #siiw0104@#9 = #siiw0104#9;

     |SI nNivel = 1;
         nOtro = nEtiqueta0 + 1;

         |SI #siiw0104#0 = nEtiqueta0;
             #siiw0104@#0 = #siiw0104#0 + 1;
         |FINSI;

         |SI #siiw0104#0 = nOtro;
             #siiw0104@#0 = #siiw0104#0 - 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 2;
         nOtro = nEtiqueta1 + 1;

         |SI #siiw0104#1 = nEtiqueta1;
             #siiw0104@#1 = #siiw0104#1 + 1;
         |FINSI;

         |SI #siiw0104#1 = nOtro;
             #siiw0104@#1 = #siiw0104#1 - 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 3;
         nOtro = nEtiqueta2 + 1;

         |SI #siiw0104#2 = nEtiqueta2;
             #siiw0104@#2 = #siiw0104#2 + 1;
         |FINSI;

         |SI #siiw0104#2 = nOtro;
             #siiw0104@#2 = #siiw0104#2 - 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 4;
         nOtro = nEtiqueta3 + 1;

         |SI #siiw0104#3 = nEtiqueta3;
             #siiw0104@#3 = #siiw0104#3 + 1;
         |FINSI;

         |SI #siiw0104#3 = nOtro;
             #siiw0104@#3 = #siiw0104#3 - 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 5;
         nOtro = nEtiqueta4 + 1;

         |SI #siiw0104#4 = nEtiqueta4;
             #siiw0104@#4 = #siiw0104#4 + 1;
         |FINSI;

         |SI #siiw0104#4 = nOtro;
             #siiw0104@#4 = #siiw0104#4 - 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 6;
         nOtro = nEtiqueta5 + 1;

         |SI #siiw0104#5 = nEtiqueta5;
             #siiw0104@#5 = #siiw0104#5 + 1;
         |FINSI;

         |SI #siiw0104#5 = nOtro;
             #siiw0104@#5 = #siiw0104#5 - 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 7;
         nOtro = nEtiqueta6 + 1;

         |SI #siiw0104#6 = nEtiqueta6;
             #siiw0104@#6 = #siiw0104#6 + 1;
         |FINSI;

         |SI #siiw0104#6 = nOtro;
             #siiw0104@#6 = #siiw0104#6 - 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 8;
         nOtro = nEtiqueta7 + 1;

         |SI #siiw0104#7 = nEtiqueta7;
             #siiw0104@#7 = #siiw0104#7 + 1;
         |FINSI;

         |SI #siiw0104#7 = nOtro;
             #siiw0104@#7 = #siiw0104#7 - 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 9;
         nOtro = nEtiqueta8 + 1;

         |SI #siiw0104#8 = nEtiqueta8;
             #siiw0104@#8 = #siiw0104#8 + 1;
         |FINSI;

         |SI #siiw0104#8 = nOtro;
             #siiw0104@#8 = #siiw0104#8 - 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 10;
         nOtro = nEtiqueta9 + 1;

         |SI #siiw0104#9 = nEtiqueta9;
             #siiw0104@#9 = #siiw0104#9 + 1;
         |FINSI;

         |SI #siiw0104#9 = nOtro;
             #siiw0104@#9 = #siiw0104#9 - 1;
         |FINSI;
     |FINSI;

     #siiw0104@#10 = #siiw0104#10;
     #siiw0104@#11 = #siiw0104#11;
     #siiw0104@#12 = #siiw0104#12;
     #siiw0104@#13 = #siiw0104#13;
     #siiw0104@#14 = #siiw0104#14;
     #siiw0104@#15 = #siiw0104#15;

     |GRABA 020#siiw0104@.n;
     |LIBERA #siiw0104@;

     |SI nSitua = 0;
         nSit0  = #siiw0104@#0;
         nSit1  = #siiw0104@#1;
         nSit2  = #siiw0104@#2;
         nSit3  = #siiw0104@#3;
         nSit4  = #siiw0104@#4;
         nSit5  = #siiw0104@#5;
         nSit6  = #siiw0104@#6;
         nSit7  = #siiw0104@#7;
         nSit8  = #siiw0104@#8;
         nSit9  = #siiw0104@#9;
         nSitua = 1;
     |FINSI;

     |BORRA 020#siiw0104.a;
     |LIBERA #siiw0104;
|FPRC;

|DEFBUCLE siiw0104BajaLista;
     #siiw0104#1;
     ;
     nDE0, nDE1, nDE2, nDE3, nDE4, nDE5, nDE6, nDE7, nDE8, nDE9;
     nHE0, nHE1, nHE2, nHE3, nHE4, nHE5, nHE6, nHE7, nHE8, nHE9;
     be;
     NULL, siiw0104BajaLista;
|FIN;

|PROCESO DHBajarLista;
     |SI nEtiqueta1 = 0;
         nNivel = 1;
         nDE0   = nEtiqueta0;
         nHE0   = 99;

         nDE1   = 0;  nHE1   = 99;
         nDE2   = 0;  nHE2   = 99;
         nDE3   = 0;  nHE3   = 99;
         nDE4   = 0;  nHE4   = 99;
         nDE5   = 0;  nHE5   = 99;
         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta2 = 0;
         nNivel = 2;
         nDE1   = nEtiqueta1;
         nHE1   = 99;

         nDE2   = 0;  nHE2   = 99;
         nDE3   = 0;  nHE3   = 99;
         nDE4   = 0;  nHE4   = 99;
         nDE5   = 0;  nHE5   = 99;
         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta3 = 0;
         nNivel = 3;
         nDE2   = nEtiqueta2;
         nHE2   = 99;

         nDE3   = 0;  nHE3   = 99;
         nDE4   = 0;  nHE4   = 99;
         nDE5   = 0;  nHE5   = 99;
         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta4 = 0;
         nNivel = 4;
         nDE3   = nEtiqueta3;
         nHE3   = 99;

         nDE4   = 0;  nHE4   = 99;
         nDE5   = 0;  nHE5   = 99;
         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta5 = 0;
         nNivel = 5;
         nDE4   = nEtiqueta4;
         nHE4   = 99;

         nDE5   = 0;  nHE5   = 99;
         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta6 = 0;
         nNivel = 6;
         nDE5   = nEtiqueta5;
         nHE5   = 99;

         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta7 = 0;
         nNivel = 7;
         nDE6   = nEtiqueta6;
         nHE6   = 99;

         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta8 = 0;
         nNivel = 8;
         nDE7   = nEtiqueta7;
         nHE7   = 99;

         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta9 = 0;
         nNivel = 9;
         nDE8   = nEtiqueta8;
         nHE8   = 99;

         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     nNivel = 10;
     nDE9   = nEtiqueta9;
     nHE9   = 99;
|FPRC;

|PROCESO BajarLista;
     |SI aContenido = "";  |ACABA;  |FINSI;

     |HAZ RecogeDeContenido;

     #siiw0104#0 = nEtiqueta0;
     #siiw0104#1 = nEtiqueta1;
     #siiw0104#2 = nEtiqueta2;
     #siiw0104#3 = nEtiqueta3;
     #siiw0104#4 = nEtiqueta4;
     #siiw0104#5 = nEtiqueta5;
     #siiw0104#6 = nEtiqueta6;
     #siiw0104#7 = nEtiqueta7;
     #siiw0104#8 = nEtiqueta8;
     #siiw0104#9 = nEtiqueta9;
     |LEE 000#siiw0104.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nDE0 = nEtiqueta0;  nHE0 = nEtiqueta0;
     nDE1 = nEtiqueta1;  nHE1 = nEtiqueta1;
     nDE2 = nEtiqueta2;  nHE2 = nEtiqueta2;
     nDE3 = nEtiqueta3;  nHE3 = nEtiqueta3;
     nDE4 = nEtiqueta4;  nHE4 = nEtiqueta4;
     nDE5 = nEtiqueta5;  nHE5 = nEtiqueta5;
     nDE6 = nEtiqueta6;  nHE6 = nEtiqueta6;
     nDE7 = nEtiqueta7;  nHE7 = nEtiqueta7;
     nDE8 = nEtiqueta8;  nHE8 = nEtiqueta8;
     nDE9 = nEtiqueta9;  nHE9 = nEtiqueta9;

     |HAZ DHBajarLista;

     |DDEF aDef;  |QBF aDef;
     aDef = aDef + "siiw0104.mas";
     |CARGA_DEF aDef, siiw0104@;

     aFicTmp = "tmpw0104" + Usuario;
     |NOME_DAT #siiw0104@#aFicTmp#;
     |ABRE #siiw0104@;  |CIERRA #siiw0104@;  |DELINDEX #siiw0104@;

     nSitua = 0;
     |ABRE #siiw0104@;
     |BUCLE siiw0104BajaLista;
     |CIERRA #siiw0104@;

     |SI nSitua = 0;
         |DELINDEX #siiw0104@;
         |DESCARGA_DEF #siiw0104@;
         |ACABA;
     |FINSI;

     |BUCLE reflejo;
     |DELINDEX #siiw0104@;
     |DESCARGA_DEF #siiw0104@;

     |HAZ Renumeracion;

     #siiw0104#0 = nSit0;
     #siiw0104#1 = nSit1;
     #siiw0104#2 = nSit2;
     #siiw0104#3 = nSit3;
     #siiw0104#4 = nSit4;
     #siiw0104#5 = nSit5;
     #siiw0104#6 = nSit6;
     #siiw0104#7 = nSit7;
     #siiw0104#8 = nSit8;
     #siiw0104#9 = nSit9;
     |LEE 000#siiw0104.=;

     |HAZ CreaTree;
|FPRC;

|PROCESO siiw0104Busca;
     |SI #siiw0104#1 = 0;
         nEtiqueta0 = #siiw0104#0 + 1;
         |ACABA;
     |FINSI;

     |SI #siiw0104#2 = 0;
         nEtiqueta1 = #siiw0104#1 + 1;
         |ACABA;
     |FINSI;

     |SI #siiw0104#3 = 0;
         nEtiqueta2 = #siiw0104#2 + 1;
         |ACABA;
     |FINSI;

     |SI #siiw0104#4 = 0;
         nEtiqueta3 = #siiw0104#3 + 1;
         |ACABA;
     |FINSI;

     |SI #siiw0104#5 = 0;
         nEtiqueta4 = #siiw0104#4 + 1;
         |ACABA;
     |FINSI;

     |SI #siiw0104#6 = 0;
         nEtiqueta5 = #siiw0104#5 + 1;
         |ACABA;
     |FINSI;

     |SI #siiw0104#7 = 0;
         nEtiqueta6 = #siiw0104#6 + 1;
         |ACABA;
     |FINSI;

     |SI #siiw0104#8 = 0;
         nEtiqueta7 = #siiw0104#7 + 1;
         |ACABA;
     |FINSI;

     |SI #siiw0104#9 = 0;
         nEtiqueta8 = #siiw0104#8 + 1;
         |ACABA;
     |FINSI;

     nEtiqueta9 = #siiw0104#9 + 1;
|FPRC;

|DEFBUCLE siiw0104Busca;
     #siiw0104#1;
     ;
     nDE0, nDE1, nDE2, nDE3, nDE4, nDE5, nDE6, nDE7, nDE8, nDE9;
     nHE0, nHE1, nHE2, nHE3, nHE4, nHE5, nHE6, nHE7, nHE8, nHE9;
     ;
     NULL, siiw0104Busca;
|FIN;

|PROCESO DHCrea;
     |SI nEtiqueta1 = 0;
         nDE1   = 1;
         nHE1   = 99;
         nEtiqueta1 = 1;
         |ACABA;
     |FINSI;

     |SI nEtiqueta2 = 0;
         nDE2   = 1;
         nHE2   = 99;
         nEtiqueta2 = 1;
         |ACABA;
     |FINSI;

     |SI nEtiqueta3 = 0;
         nDE3   = 1;
         nHE3   = 99;
         nEtiqueta3 = 1;
         |ACABA;
     |FINSI;

     |SI nEtiqueta4 = 0;
         nDE4   = 1;
         nHE4   = 99;
         nEtiqueta4 = 1;
         |ACABA;
     |FINSI;

     |SI nEtiqueta5 = 0;
         nDE5   = 1;
         nHE5   = 99;
         nEtiqueta5 = 1;
         |ACABA;
     |FINSI;

     |SI nEtiqueta6 = 0;
         nDE6   = 1;
         nHE6   = 99;
         nEtiqueta6 = 1;
         |ACABA;
     |FINSI;

     |SI nEtiqueta7 = 0;
         nDE7   = 1;
         nHE7   = 99;
         nEtiqueta7 = 1;
         |ACABA;
     |FINSI;

     |SI nEtiqueta8 = 0;
         nDE8   = 1;
         nHE8   = 99;
         nEtiqueta8 = 1;
         |ACABA;
     |FINSI;

     |SI nEtiqueta9 = 0;
         nDE9   = 1;
         nHE9   = 99;
         nEtiqueta9 = 1;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO CreaEtiqueta;
     |LEE 000#siiw0104.p;
     |SI FSalida ! 0;
         #siiw0104#0  = 1;
         #siiw0104#1  = 0;
         #siiw0104#2  = 0;
         #siiw0104#3  = 0;
         #siiw0104#4  = 0;
         #siiw0104#5  = 0;
         #siiw0104#6  = 0;
         #siiw0104#7  = 0;
         #siiw0104#8  = 0;
         #siiw0104#9  = 0;
         #siiw0104#10 = #siiw0105#0;
         #siiw0104#11 = #siiw0105#1;
         #siiw0104#12 = #siiw0105#2;
         #siiw0104#13 = #siiw0105#3;
         #siiw0104#14 = #siiw0105#4;
         #siiw0104#15 = #siiw0105#5;

         |GRABA 020#siiw0104.n;
         |LIBERA #siiw0104;

         |HAZ CreaTree;
         |ACABA;
     |FINSI;

     |SI aContenido = "";
         |PARA nEtiqueta = 1;  |SI nEtiqueta [ 100;  |HACIENDO nEtiqueta = nEtiqueta + 1;
               #siiw0104#0 = nEtiqueta;
               #siiw0104#1 = 0;
               #siiw0104#2 = 0;
               #siiw0104#3 = 0;
               #siiw0104#4 = 0;
               #siiw0104#5 = 0;
               #siiw0104#6 = 0;
               #siiw0104#7 = 0;
               #siiw0104#8 = 0;
               #siiw0104#9 = 0;
               |LEE 000#siiw0104.=;
               |SI FSalida ! 0;  |SAL;  |FINSI;
         |SIGUE;

         |SI nEtiqueta ] 100;  |ACABA;  |FINSI;

         #siiw0104#0 = nEtiqueta;
         #siiw0104#1  = 0;
         #siiw0104#2  = 0;
         #siiw0104#3  = 0;
         #siiw0104#4  = 0;
         #siiw0104#5  = 0;
         #siiw0104#6  = 0;
         #siiw0104#7  = 0;
         #siiw0104#8  = 0;
         #siiw0104#9  = 0;
         #siiw0104#10 = #siiw0105#0;
         #siiw0104#11 = #siiw0105#1;
         #siiw0104#12 = #siiw0105#2;
         #siiw0104#13 = #siiw0105#3;
         #siiw0104#14 = #siiw0105#4;
         #siiw0104#15 = #siiw0105#5;

         |GRABA 020#siiw0104.n;
         |LIBERA #siiw0104;

         |HAZ CreaTree;

         |ACABA;
     |FINSI;

     nDE0 = nEtiqueta0;  nHE0 = nEtiqueta0;
     nDE1 = nEtiqueta1;  nHE1 = nEtiqueta1;
     nDE2 = nEtiqueta2;  nHE2 = nEtiqueta2;
     nDE3 = nEtiqueta3;  nHE3 = nEtiqueta3;
     nDE4 = nEtiqueta4;  nHE4 = nEtiqueta4;
     nDE5 = nEtiqueta5;  nHE5 = nEtiqueta5;
     nDE6 = nEtiqueta6;  nHE6 = nEtiqueta6;
     nDE7 = nEtiqueta7;  nHE7 = nEtiqueta7;
     nDE8 = nEtiqueta8;  nHE8 = nEtiqueta8;
     nDE9 = nEtiqueta9;  nHE9 = nEtiqueta9;

     |HAZ DHCrea;

     |BUCLE siiw0104Busca;

     #siiw0104#0  = nEtiqueta0;
     #siiw0104#1  = nEtiqueta1;
     #siiw0104#2  = nEtiqueta2;
     #siiw0104#3  = nEtiqueta3;
     #siiw0104#4  = nEtiqueta4;
     #siiw0104#5  = nEtiqueta5;
     #siiw0104#6  = nEtiqueta6;
     #siiw0104#7  = nEtiqueta7;
     #siiw0104#8  = nEtiqueta8;
     #siiw0104#9  = nEtiqueta9;
     #siiw0104#10 = #siiw0105#0;
     #siiw0104#11 = #siiw0105#1;
     #siiw0104#12 = #siiw0105#2;
     #siiw0104#13 = #siiw0105#3;
     #siiw0104#14 = #siiw0105#4;
     #siiw0104#15 = #siiw0105#5;

     |GRABA 020#siiw0104.n;
     |LIBERA #siiw0104;

     |HAZ CreaTree;
|FPRC;

|PROCESO NuevaEtiqueta;
     |HAZ RecogeDeContenido;

     |SI nEtiqueta9 ! 0;
         |MENAV "0000Superado m ximo de agrupaciones";
         |ACABA;
     |FINSI;

     |VENTANA 0501, 2399, -1, 16, "Nueva Etiqueta";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DDEFECTO #siiw0105;
     |PINPA #0#siiw0105;
     |PINDA #0#siiw0105;
     |ENDATOS #1#siiw0105;
     nFSalida = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;

     |SI nFSalida = 0;
         |HAZ CreaEtiqueta;
     |FINSI;
|FPRC;

|PROCESO ModificarEtiqueta;
     |SI aContenido = "";  |ACABA;  |FINSI;

     |HAZ RecogeDeContenido;

     #siiw0104#0 = nEtiqueta0;
     #siiw0104#1 = nEtiqueta1;
     #siiw0104#2 = nEtiqueta2;
     #siiw0104#3 = nEtiqueta3;
     #siiw0104#4 = nEtiqueta4;
     #siiw0104#5 = nEtiqueta5;
     #siiw0104#6 = nEtiqueta6;
     #siiw0104#7 = nEtiqueta7;
     #siiw0104#8 = nEtiqueta8;
     #siiw0104#9 = nEtiqueta9;
     |LEE 101#siiw0104.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |VENTANA 0501, 2399, -1, 16, "Modificar etiqueta";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     #siiw0105#0 = #siiw0104#10;
     #siiw0105#1 = #siiw0104#11;
     #siiw0105#2 = #siiw0104#12;
     #siiw0105#3 = #siiw0104#13;
     #siiw0105#4 = #siiw0104#14;
     #siiw0105#5 = #siiw0104#15;

     |PINPA #0#siiw0105;
     |PINDA #0#siiw0105;
     |ENDATOS #1#siiw0105;
     nFSalida = FSalida;
     ||GRABA 020#siiw0104.a;
     ||LIBERA #siiw0104;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;

     |SI nFSalida = 0;
         #siiw0104#10 = #siiw0105#0;
         #siiw0104#11 = #siiw0105#1;
         #siiw0104#12 = #siiw0105#2;
         #siiw0104#13 = #siiw0105#3;
         #siiw0104#14 = #siiw0105#4;
         #siiw0104#15 = #siiw0105#5;

        |GRABA 020#siiw0104.a;
        |LIBERA #siiw0104;

        |HAZ CreaTree;
     |FINSI;
|FPRC;

|PROCESO siiw0104B;
     |BORRA 020#siiw0104.a;
     |LIBERA #siiw0104;
|FPRC;

|DEFBUCLE siiw0104B;
     #siiw0104#1;
     ;
     nDE0, nDE1, nDE2, nDE3, nDE4, nDE5, nDE6, nDE7, nDE8, nDE9;
     nHE0, nHE1, nHE2, nHE3, nHE4, nHE5, nHE6, nHE7, nHE8, nHE9;
     be;
     NULL, siiw0104B;
|FIN;

|PROCESO DHQuitar;
     |SI nEtiqueta1 = 0;
         nDE1   = 0;  nHE1   = 99;
         nDE2   = 0;  nHE2   = 99;
         nDE3   = 0;  nHE3   = 99;
         nDE4   = 0;  nHE4   = 99;
         nDE5   = 0;  nHE5   = 99;
         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta2 = 0;
         nDE2   = 0;  nHE2   = 99;
         nDE3   = 0;  nHE3   = 99;
         nDE4   = 0;  nHE4   = 99;
         nDE5   = 0;  nHE5   = 99;
         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta3 = 0;
         nDE3   = 0;  nHE3   = 99;
         nDE4   = 0;  nHE4   = 99;
         nDE5   = 0;  nHE5   = 99;
         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta4 = 0;
         nDE4   = 0;  nHE4   = 99;
         nDE5   = 0;  nHE5   = 99;
         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta5 = 0;
         nDE5   = 0;  nHE5   = 99;
         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta6 = 0;
         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta7 = 0;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta8 = 0;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta9 = 0;
         nDE9   = 0;  nHE9   = 99;
     |FINSI;
|FPRC;

|PROCESO QuitarEtiqueta;
     |SI aContenido = "";  |ACABA;  |FINSI;

     |HAZ RecogeDeContenido;

     #siiw0104#0 = nEtiqueta0;
     #siiw0104#1 = nEtiqueta1;
     #siiw0104#2 = nEtiqueta2;
     #siiw0104#3 = nEtiqueta3;
     #siiw0104#4 = nEtiqueta4;
     #siiw0104#5 = nEtiqueta5;
     #siiw0104#6 = nEtiqueta6;
     #siiw0104#7 = nEtiqueta7;
     #siiw0104#8 = nEtiqueta8;
     #siiw0104#9 = nEtiqueta9;
     |LEE 101#siiw0104.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nDE0 = nEtiqueta0;  nHE0 = nEtiqueta0;
     nDE1 = nEtiqueta1;  nHE1 = nEtiqueta1;
     nDE2 = nEtiqueta2;  nHE2 = nEtiqueta2;
     nDE3 = nEtiqueta3;  nHE3 = nEtiqueta3;
     nDE4 = nEtiqueta4;  nHE4 = nEtiqueta4;
     nDE5 = nEtiqueta5;  nHE5 = nEtiqueta5;
     nDE6 = nEtiqueta6;  nHE6 = nEtiqueta6;
     nDE7 = nEtiqueta7;  nHE7 = nEtiqueta7;
     nDE8 = nEtiqueta8;  nHE8 = nEtiqueta8;
     nDE9 = nEtiqueta9;  nHE9 = nEtiqueta9;

     |HAZ DHQuitar;

     |BUCLE siiw0104B;

     |HAZ Renumeracion;

     |HAZ CreaTree;
|FPRC;

|PROCESO MontaContenido;
     aAlfa       = Contenido;  |QBF aAlfa;
     aContenido  = "";
     aLong       = aAlfa % 0;
     nLong       = aLong;
     nCargar     = 0;
     |PARA nPosi = 1;  |SI nPosi [ nLong;  |HACIENDO nPosi = nPosi + 1;
           nPos = (nPosi * 100) + 1;
           aCarac = aAlfa % nPos;

           |SI nCargar = 1;
               aContenido  = aContenido + aCarac;
           |FINSI;

           |SI aCarac = ":";  nCargar = 1; |FINSI;
     |SIGUE;
|FPRC;

|PROCESO EvntTree;
     |SI FEntrada = 0;
         |HAZ MontaContenido;

         aAlfa = "";
         aLong = Contenido % 0;
         nLong = aLong;
         |PARA nPosi = 1;  |SI nPosi [ nLong;  |HACIENDO nPosi = nPosi + 1;
               nPos = (nPosi * 100) + 1;
               aCarac = Contenido % nPos;
               |SI aCarac = ":";  |SAL;  |FINSI;
               aAlfa  = aAlfa + aCarac;
         |SIGUE;

         |QBT aAlfa;

         sT_nID   = nTree;
         sT_nOper = 4;
         sT_aData = ":" + aAlfa;

         |ESPECIFICA "COMMANDCONTROL", sTree;
         aTexto = Contenido;

         |ACABA;
     |FINSI;

     aPopup1  = nTree;  || Si fuera -1 en la posicion
     aPopup2  = 6;
     aPopup3  = "Agregar nueva etiqueta";
     aPopup4  = "Modificacion etiqueta";
     aPopup5  = "Quitar etiqueta";
     aPopup6  = "----------------------";
     aPopup7  = "Subir lista";
     aPopup8  = "Bajar lista";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         |SI FSalida = 1;  |HAZ NuevaEtiqueta;     |FINSI;
         |SI FSalida = 2;  |HAZ ModificarEtiqueta; |FINSI;
         |SI FSalida = 3;  |HAZ QuitarEtiqueta;    |FINSI;
         |SI FSalida = 5;  |HAZ SubirLista;        |FINSI;
         |SI FSalida = 6;  |HAZ BajarLista;        |FINSI;
     |FINSI;
|FPRC;

|PROCESO siiw0104Xml;
     aAlfa = "      ";

     |SI #siiw0104#1  ! 0;  aAlfa = aAlfa + "   ";  |FINSI;
     |SI #siiw0104#2  ! 0;  aAlfa = aAlfa + "   ";  |FINSI;
     |SI #siiw0104#3  ! 0;  aAlfa = aAlfa + "   ";  |FINSI;
     |SI #siiw0104#4  ! 0;  aAlfa = aAlfa + "   ";  |FINSI;
     |SI #siiw0104#5  ! 0;  aAlfa = aAlfa + "   ";  |FINSI;
     |SI #siiw0104#6  ! 0;  aAlfa = aAlfa + "   ";  |FINSI;
     |SI #siiw0104#7  ! 0;  aAlfa = aAlfa + "   ";  |FINSI;
     |SI #siiw0104#8  ! 0;  aAlfa = aAlfa + "   ";  |FINSI;
     |SI #siiw0104#9  ! 0;  aAlfa = aAlfa + "   ";  |FINSI;

     aAlfa1 = #siiw0104#11 % 201;
     |SI aAlfa1 = "/";
         aAlfa = aAlfa - "   ";
     |FINSI;

     aAlfa = aAlfa + #siiw0104#11;  |QBF aAlfa;

     eaAlfa  = #siiw0104#14;  |HAZ QuitaRarosXml;
     aAlfa1  = #siiw0104#13;  |QBF aAlfa1;
     |SI aAlfa1 ! "";
         aAlfa = aAlfa + " " + #siiw0104#13 + " " + eaAlfa;  |QBF aAlfa;
     |FINSI;

     aAlfa1  = #siiw0104#12;  |QBF aAlfa1;
     |SI aAlfa1 ! "";
         aAlfa = aAlfa + " " + #siiw0104#12;  |QBF aAlfa;
     |FINSI;

     |HAZ GrabaTree;
|FPRC;

|DEFBUCLE siiw0104Xml;
     #siiw0104#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, siiw0104Xml;
|FIN;

|PROCESO CabXml;
     aAlfa = "<?xml version=" + &34 + "1.0" + &34 + " encoding=" + &34 + "UTF-8" + &34 + "?>";
     |HAZ GrabaTree;

     aAlfa = "<soapenv:Envelope xmlns:soapenv=" + &34;
     aAlfa = aAlfa + "http://schemas.xmlsoap.org/soap/envelope/" + &34;
     |HAZ GrabaTree;

     aAlfa = "xmlns:siiLR=" + &34 + "https://www2.agenciatributaria.gob.es/";
     aAlfa = aAlfa + "static_files/common/internet/dep/aplicaciones/es/aeat/ssii/fact/ws/SuministroLR.xsd" + &34;
     |HAZ GrabaTree;

     aAlfa = "xmlns:sii=" + &34 + "https://www2.agenciatributaria.gob.es/static_files/";
     aAlfa = aAlfa + "common/internet/dep/aplicaciones/es/aeat/ssii/fact/ws/SuministroInformacion.xsd" + &34 + ">";
     |HAZ GrabaTree;

     aAlfa = "<soapenv:Header/>";
     |HAZ GrabaTree;

     aAlfa = "   <soapenv:Body>";
     |HAZ GrabaTree;
|FPRC;

|PROCESO PieXml;
     aAlfa = "   </soapenv:Body>";
     |HAZ GrabaTree;

     aAlfa = "</soapenv:Envelope>";
     |HAZ GrabaTree;
|FPRC;

|PROCESO Verifica;
     |XABRE "WBC", aAbreXml, nHandle;
     |HAZ CabXml;
     |BUCLE siiw0104Xml;
     |HAZ PieXml;
     |XCIERRA nHandle;

     aAlfa = "0000Edita con el chrome el fichero " + aAbreXml;
     |MENAV aAlfa;

     |FOCOTECLADO nTree;
|FPRC;

|PROCESO Baja501;
     #siim0501#0  = eaVer;
     #siim0501#1  = eaEsq;
     #siim0501#2  = 0;
     #siim0501#3  = 0;
     #siim0501#4  = 0;
     #siim0501#5  = 0;
     #siim0501#6  = 0;
     #siim0501#7  = 0;
     #siim0501#8  = 0;
     #siim0501#9  = 0;
     #siim0501#10 = 0;
     #siim0501#11 = 0;
|FPRC;

|PROCESO Alta501;
     #siim0501#0  = eaVer;
     #siim0501#1  = eaEsq;
     #siim0501#2  = 99;
     #siim0501#3  = 99;
     #siim0501#4  = 99;
     #siim0501#5  = 99;
     #siim0501#6  = 99;
     #siim0501#7  = 99;
     #siim0501#8  = 99;
     #siim0501#9  = 99;
     #siim0501#10 = 99;
     #siim0501#11 = 99;
|FPRC;

|PROGRAMA;
     |SI eaEsq = "11";  aAlfa = "Esquema Alta/Modificaci¢n facturas expedidas";  |FINSI;
     |SI eaEsq = "12";  aAlfa = "Esquema Suministro de cobros facturas expedidas";  |FINSI;
     |SI eaEsq = "13";  aAlfa = "Esquema Baja de facturas expedidas";  |FINSI;
     |SI eaEsq = "21";  aAlfa = "Esquema Alta/Modificaci¢n facturas recibidas";  |FINSI;
     |SI eaEsq = "22";  aAlfa = "Esquema Suministro de pagos facturas recibidas";  |FINSI;
     |SI eaEsq = "23";  aAlfa = "Esquema Baja de facturas recibidas";  |FINSI;
     |SI eaEsq = "31";  aAlfa = "Esquema Alta/Modificaci¢n facturas bienes inversi¢n";  |FINSI;
     |SI eaEsq = "33";  aAlfa = "Esquema Baja facturas bienes inversi¢n";  |FINSI;
     |SI eaEsq = "41";  aAlfa = "Esquema Alta/Modificaci¢n operaciones en met lico";  |FINSI;
     |SI eaEsq = "43";  aAlfa = "Esquema Baja operaciones en met lico";  |FINSI;

/*
     |ABRE #siim0501;
     |CONSULTA_F_CLAVE #1#siim0501, Baja501, Alta501;
     |CIERRA #siim0501;
*/

     |VENTANA 0501, 3799, -1, 16, aAlfa;
     n0Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 807;  |PAUSA;

     |HAZ CreaTree;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Verifica XML", 3602, 3615, Verifica;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nTree;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nTree;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n0Vent;

     |PULSATECLA;
|FPRO;

|PROCESO CreaLista;
     |DBASE aBase;
     aMas = aBase + "def/" + #siiw0106#0 + ".mas";
     |CARGA_DEF aMas, trabajo@;

     aQQ      = "|NC";
     aAlfa    = #trabajo@#aQQ#;
     nTCampo  = aAlfa;
     nTCampo  = nTCampo - 1;

     |PARA nCampo = 0;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
           aQQ   = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           aAlfa = (#trabajo@#aQQ# + (" " * 20)) % 120;  |QBF aAlfa;

           |SI aAlfa ! "Inhibido";
               #siiw0107#0 = #siiw0106#0;
               #siiw0107#1 = ("000" + nCampo) % -103;
               #siiw0107#2 = aAlfa;
               |GRABA 000#siiw0107.n;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO CreaCmpFE;
     #siiw0106#0 = "siim0001";
     #siiw0106#1 = "Empresas";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;

     #siiw0106#0 = "siim0002";
     #siiw0106#1 = "Lotes";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;

     #siiw0106#0 = "siim0003";
     #siiw0106#1 = "Facturas expedidas";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;

     #siiw0106#0 = "siim0500";
     #siiw0106#1 = "Versiones SII";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;
|FPRC;

|PROCESO CreaCmpCobros;
     #siiw0106#0 = "siim0001";
     #siiw0106#1 = "Empresas";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;

     #siiw0106#0 = "siim0002";
     #siiw0106#1 = "Lotes";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;

     #siiw0106#0 = "siim0005";
     #siiw0106#1 = "Cobros";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;

     #siiw0106#0 = "siim0500";
     #siiw0106#1 = "Versiones SII";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;
|FPRC;

|PROCESO CreaCmpFR;
     #siiw0106#0 = "siim0001";
     #siiw0106#1 = "Empresas";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;

     #siiw0106#0 = "siim0002";
     #siiw0106#1 = "Lotes";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;

     #siiw0106#0 = "siim0004";
     #siiw0106#1 = "Facturas recibidas";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;

     #siiw0106#0 = "siim0500";
     #siiw0106#1 = "Versiones SII";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;
|FPRC;

|PROCESO CreaCmpPagos;
     #siiw0106#0 = "siim0001";
     #siiw0106#1 = "Empresas";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;

     #siiw0106#0 = "siim0002";
     #siiw0106#1 = "Lotes";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;

     #siiw0106#0 = "siim0006";
     #siiw0106#1 = "Pagos";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;

     #siiw0106#0 = "siim0500";
     #siiw0106#1 = "Versiones SII";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;
|FPRC;

|PROCESO CreaCmpInv;
     #siiw0106#0 = "siim0001";
     #siiw0106#1 = "Empresas";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;

     #siiw0106#0 = "siim0002";
     #siiw0106#1 = "Lotes";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;

     #siiw0106#0 = "siim0009";
     #siiw0106#1 = "Facturas bienes inversi¢n";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;

     #siiw0106#0 = "siim0500";
     #siiw0106#1 = "Versiones SII";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;
|FPRC;

|PROCESO CreaCmpCobMet;
     #siiw0106#0 = "siim0001";
     #siiw0106#1 = "Empresas";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;

     #siiw0106#0 = "siim0002";
     #siiw0106#1 = "Lotes";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;

     #siiw0106#0 = "siim0010";
     #siiw0106#1 = "Operaciones en met lico";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;

     #siiw0106#0 = "siim0500";
     #siiw0106#1 = "Versiones SII";
     |GRABA 000#siiw0106.n;
     |HAZ CreaLista;
|FPRC;

|PROCESO CreaCmp;
     aFicTmp = "siiw0106" + Usuario;
     |NOME_DAT #siiw0106#aFicTmp#;
     |ABRE #siiw0106;  |CIERRA #siiw0106;  |DELINDEX #siiw0106;

     aFicTmp = "siiw0107" + Usuario;
     |NOME_DAT #siiw0107#aFicTmp#;
     |ABRE #siiw0107;  |CIERRA #siiw0107;  |DELINDEX #siiw0107;

     |ABRET #siiw0106;
     |ABRET #siiw0107;

     |SI eaEsq = "11";  |O eaEsq = "13";
         |HAZ CreaCmpFE;
     |FINSI;

     |SI eaEsq = "12";
         |HAZ CreaCmpCobros;
     |FINSI;

     |SI eaEsq = "21";  |O eaEsq = "23";
         |HAZ CreaCmpFR;
     |FINSI;

     |SI eaEsq = "22";
         |HAZ CreaCmpPagos;
     |FINSI;

     |SI eaEsq = "31";  |O eaEsq = "33";
         |HAZ CreaCmpInv;
     |FINSI;

     |SI eaEsq = "41";  |O eaEsq = "43";
         |HAZ CreaCmpCobMet;
     |FINSI;
|FPRC;

|VARIABLES;
     aEsqO = "";
     aEsqD = "";
|FIN;

|PROCESO siim0501;
     |PARA nCmp = 0;  |SI nCmp [ 18;  |HACIENDO nCmp = nCmp + 1;
           #trabajo@#nCmp# = #siim0501#nCmp#;
     |SIGUE;

     #trabajo@#1# = aEsqD;

     |GRABA 020#trabajo@.n;
     |LIBERA #trabajo@;
|FPRC;

|DEFBUCLE siim0501;
     #siim0501#3;
     ;
     eaVer, aEsqO, "";
     eaVer, aEsqO, "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, siim0501;
|FIN;

|PROCESO T80;  |TIPO 80;
/*
     |DBASE aBase;
     aMas = aBase + "def/siim0501.mas";
     |CARGA_DEF aMas, trabajo@;

     |ABRE #trabajo@;
     aEsqO = "41";  aEsqD = "43";  |BUCLE siim0501;
     |CIERRA #trabajo@;

     |DESCARGA_DEF #trabajo@;
*/

     aFicTmp = "siiw0104" + Usuario;
     |NOME_DAT #siiw0104#aFicTmp#;
     |ABRE #siiw0104;  |CIERRA #siiw0104;  |DELINDEX #siiw0104;

     |ABRET #siiw0104;

     |ABRE #siim0501;

     |DDEFECTO #siim0501;
     #siim0501#0  = eaVer;
     #siim0501#1  = eaEsq;
     |LEE 000#siim0501.];
     |PARA;  |SI FSalida = 0;  |HACIENDO;
          |SI #siim0501#0 ! eaVer;  |SAL;  |FINSI;
          |SI #siim0501#1 ! eaEsq;  |SAL;  |FINSI;

          #siiw0104#0  = #siim0501#2;
          #siiw0104#1  = #siim0501#3;
          #siiw0104#2  = #siim0501#4;
          #siiw0104#3  = #siim0501#5;
          #siiw0104#4  = #siim0501#6;
          #siiw0104#5  = #siim0501#7;
          #siiw0104#6  = #siim0501#8;
          #siiw0104#7  = #siim0501#9;
          #siiw0104#8  = #siim0501#10;
          #siiw0104#9  = #siim0501#11;
          #siiw0104#10 = #siim0501#12;
          #siiw0104#11 = #siim0501#13;
          #siiw0104#12 = #siim0501#14;
          #siiw0104#13 = #siim0501#15;
          #siiw0104#14 = #siim0501#16;
          #siiw0104#15 = #siim0501#17;

          |GRABA 020#siiw0104.n;
          |LIBERA #siiw0104;

          |LEE 000#siim0501.s;
     |SIGUE;

     |CIERRA #siim0501;

     |HAZ CreaCmp;

     aPath = "C:\documentos";     |RMKDIR aPath;
     aPath = "C:\documentos\tmp"; |RMKDIR aPath;
     aPath = "C:\documentos\tmp\";

     aFic  = "siiz0501" + Usuario + ".txt";
     aAbreTxt = aPath + aFic;

     aFic  = "siiz0501" + Usuario + ".xml";
     aAbreXml = aPath + aFic;
|FPRC;

|PROCESO siiw0104Graba;
     #siim0501#0  = eaVer;
     #siim0501#1  = eaEsq;
     #siim0501#2  = #siiw0104#0;
     #siim0501#3  = #siiw0104#1;
     #siim0501#4  = #siiw0104#2;
     #siim0501#5  = #siiw0104#3;
     #siim0501#6  = #siiw0104#4;
     #siim0501#7  = #siiw0104#5;
     #siim0501#8  = #siiw0104#6;
     #siim0501#9  = #siiw0104#7;
     #siim0501#10 = #siiw0104#8;
     #siim0501#11 = #siiw0104#9;
     #siim0501#12 = #siiw0104#10;
     #siim0501#13 = #siiw0104#11;
     #siim0501#14 = #siiw0104#12;
     #siim0501#15 = #siiw0104#13;
     #siim0501#16 = #siiw0104#14;
     #siim0501#17 = #siiw0104#15;

     aAlfa = (("00" + #siim0501#2) % -102);
     aAlfa = aAlfa + (("00" + #siim0501#3) % -102);
     aAlfa = aAlfa + (("00" + #siim0501#4) % -102);
     aAlfa = aAlfa + (("00" + #siim0501#5) % -102);
     aAlfa = aAlfa + (("00" + #siim0501#6) % -102);
     aAlfa = aAlfa + (("00" + #siim0501#7) % -102);
     aAlfa = aAlfa + (("00" + #siim0501#8) % -102);
     aAlfa = aAlfa + (("00" + #siim0501#9) % -102);
     aAlfa = aAlfa + (("00" + #siim0501#10) % -102);
     aAlfa = aAlfa + (("00" + #siim0501#11) % -102);

     #siim0501#18 = aAlfa;

     |GRABA 020#siim0501.n;
     |LIBERA #siim0501;
|FPRC;

|DEFBUCLE siiw0104Graba;
     #siiw0104#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, siiw0104Graba;
|FIN;

|PROCESO GeneraEsquema;
     |ABRE #siim0501;
     |DDEFECTO #siim0501;
     #siim0501#0  = eaVer;
     #siim0501#1  = eaEsq;
     |LEE 101#siim0501.];
     |PARA;  |SI FSalida = 0;  |HACIENDO;
          |SI #siim0501#0 ! eaVer;  |SAL;  |FINSI;
          |SI #siim0501#1 ! eaEsq;  |SAL;  |FINSI;

          |BORRA 020#siim0501.a;
          |LIBERA #siim0501;

          |LEE 101#siim0501.s;
     |SIGUE;
     |LIBERA #siim0501;

     |BUCLE siiw0104Graba;

     |CIERRA #siim0501;
|FPRC;

|PROCESO T90;  |TIPO 90;
     |CONFI "0000SEsta seguro de grabar el esquema generado";
     |SI FSalida = 0;
         |HAZ GeneraEsquema;
     |FINSI;

     |CIERRAT #siiw0104;  |DELINDEX #siiw0104;
     |CIERRAT #siiw0106;  |DELINDEX #siiw0106;
     |CIERRAT #siiw0107;  |DELINDEX #siiw0107;

     |RFBORRA aAbreTxt;
     |RFBORRA aAbreXml;
|FPRC;
