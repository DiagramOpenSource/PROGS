|| Para el 2015 el rem00056 se cambio el tipo por casilla tenerlo en cuenta
|| en todos los defbucle del rem00056 cambiarlo


|FICHEROS;
     rezcap99 #0;
     repobibi #1;
     rem02000 #2;
     retabla1 #401;

     aficahor1@ #1001;
     aficahor2@ #1002;

     aficante1@ #991;
     aficante2@ #992;
     aficante3@ #993;
     aficante4@ #994;
     aficante5@ #995;

     rem01001@ #998;
     rem01011@ #999;

     rem00042 #42;
     rem00048;
     rem00056;
     rem00060 #60;
     rem02002;
|FIN;

|VARIABLES;
     aAlfa          = "";
     aAlfa1         = "";
     aAlfa2         = "";
     aDef           = "";
     aFichero       = "";
     aBaseRenta2014 = "";
     aFich          = "";
     aContri        = "";
     aRefCast       = "";
     aRaiz          = "";
     aListados      = "";
     aQueBoton      = "";
     aID            = "";

     nBoton         = 0;
     nBtnCancelar   = 0;
     nCampo         = 0;
     nCampo1        = 0;
     nCampo2        = 0;
     nCampoPase     = 0;
     nSuma          = 0;
     nSuma1         = 0;
     nAcciones      = 0;
     nAgru          = 0;
     nCasi          = 0;
     nImporte       = 0;
     nImpGraba      = 0;
     nImpo          = 0;
     nCompara       = 0;
     nPatrones      = 0;
     nDEjer         = 0;
     nHEjer         = 0;
     nTipo          = 0;
     nQueHago       = 0;
     nAnyo          = 0;
     nLinea         = 0;
     nDobleImpo     = 0;
     nDias          = 0;
     nEmpresa       = 0;
     nPendiente     = 0;
     nComple        = 0;
     nGastos        = 0;
     nGrabo         = 0;
     nPaso          = 0;
     nHandle        = 0;
     nMensaDupli    = 0;
     nAntes         = 0;
     nPorce         = 0;

     &enCodCli      = 0;
     &enEmpresa     = 0;
     &eaPrograma    = "";
     &eaPunto       = "";
     &eaLetra       = "";

     &eaAzul        = "";
     &eaVerde       = "";
     &eaRojo        = "";
     &eaRosa        = "";
     &eaCta         = "";
     &eaIBAN        = "";
|FIN;

|PROCESO Ptec807;
     |PTEC 807;
|FPRC;

|PROCESO Directorios; |TIPO 7;
     |SI nBtnCancelar = 1;  |ACABA;  |FINSI;

     nBtnCancelar = 1;

     aQueBoton = "|X000";
     aID       = #0#aQueBoton#;
     nBoton    = aID;
     |ESTADO_CONTROL nBoton, "HIDE";

     aQueBoton = "|X001";
     aID       = #0#aQueBoton#;
     nBoton    = aID;
     |ESTADO_CONTROL nBoton, "HIDE";

     |SI enCodCli ! 0;
         |CONTROL_SIMPLE 0, "BOTON,{{197}}Importar", 3488, 3498, Ptec806;
         |CONTROL_SIMPLE 0, "BOTON,{{001}}Salir", 3475, 3485, Ptec807;
     |SINO;
         |CONTROL_SIMPLE 0, "BOTON,{{197}}Importar", 3688, 3698, Ptec806;
         |CONTROL_SIMPLE 0, "BOTON,{{001}}Salir", 3675, 3685, Ptec807;
     |FINSI;

     |DBASS aAlfa;
     #0#0  = aAlfa + "ren2013";
     #0#1  = "fich";
     #0#44 = aListados;

     |PINTA #0#0;
     |PINTA #0#1;
     |PINTA #0#44;
|FPRC;

|PROCESO Parrilla;
     |SI enCodCli ! 0;  |ACABA;  |FINSI;

     |SI #0#2 = 0;
         #0#2 = 0;  |PINTA #0#2;
         #0#3 = 0;  |PINTA #0#3;  |C_M #0#3, 1, "N";
         |PARA nCampo = 4;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |SINO;
         |C_M #0#2, 1, "S";
         |C_M #0#3, 1, "S";
         |PARA nCampo = 4;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
               #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasContri;
     |SI enCodCli ! 0;  |ACABA;  |FINSI;

     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               #0Campo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO ModInmuebles;
     |C_M #0#29, 1, "S";
     |C_M #0#30, 1, "S";
     |C_M #0#32, 1, "S";
     |SI #0#25 = "N";  |O #0#32 = "N";
         |C_M #0#29, 1, "N";  #0#29 = "N";  |PINTA #0#29;
         |C_M #0#30, 1, "N";  #0#30 = "N";  |PINTA #0#30;
         |SI #0#25 = "N";
             |C_M #0#32, 1, "N";  #0#32 = "N";  |PINTA #0#32;
         |FINSI;
     |FINSI;

     |C_M #0#31, 1, "S";
     |SI #0#30 = "N";
         |C_M #0#31, 1, "N";  #0#31 = 0;    |PINTA #0#31;
     |FINSI;
|FPRC;

|PROCESO ModMobiliario;
     |C_M #0#33, 1, "S";
     |SI #0#26 = "N";
         |C_M #0#33, 1, "N";  #0#33 = "N";  |PINTA #0#33;
     |FINSI;
|FPRC;

|PROCESO ModPatrimonio;
     |C_M #0#34, 1, "S";
     |SI #0#28 = "N";
         |C_M #0#34, 1, "N";  #0#34 = "N";  |PINTA #0#34;
     |FINSI;
|FPRC;

||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| COPIA FICHEROS
||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO CopiaFichero;
     aAlfa1 = #0#0 + "/" + #0#1 + "/"  + aFichero + ".dat";  |QBT aAlfa1;
     aAlfa2 = aBaseRenta2014 + "fich/" + aFichero + ".dat";
     |COPIA_FICHERO aAlfa1, aAlfa2;

     aAlfa1 = #0#0 + "/" + #0#1 + "/"  + aFichero + ".ddx";  |QBT aAlfa1;
     aAlfa2 = aBaseRenta2014 + "fich/" + aFichero + ".ddx";
     |COPIA_FICHERO aAlfa1, aAlfa2;

     aAlfa1 = #0#0 + "/" + #0#1 + "/"  + aFichero + ".ixx";  |QBT aAlfa1;
     aAlfa2 = aBaseRenta2014 + "fich/" + aFichero + ".ixx";
     |COPIA_FICHERO aAlfa1, aAlfa2;
|FPRC;

|PROCESO Auxiliares;
     aDef = aBaseRenta2014 + "def/" + aFichero + ".mas";
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aFichero + " A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |ABRE #1001;
     |LEE 040#1001p;
     |SI FSalida ! 0;
         |CIERRA #1001;
         |HAZ CopiaFichero;
     |FINSI;
     |CIERRA #1001;
     |DESCARGA_DEF #aficahor1@;
|FPRC;

||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| TRAERSE RENTA
||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO Pasa101;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida ! 0;
         |DDEFECTO #1001;
         #1001#0 = #992#0;
         #1001#1 = #992#1;
         |GRABA 020#1001b;
     |FINSI;

     |PARA nCampoPase = 0;  |SI nCampoPase [ 22;  |HACIENDO nCampoPase = nCampoPase + 1;
           #1001nCampoPase = #992nCampoPase;
     |SIGUE;

     eaCta = #1001#10;  |HAZ CalcuIBAN;  #1001#25 = eaIBAN;

     |GRABA 020#1001a;
     |LIBERA #1001;
|FPRC;

|DEFBUCLE rem00101_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa101;
|FIN;

|PROCESO Pasa102;
     #993#0  = #992#0;
     #993#1  = #992#12;
     |LEE 000#993=;
     |SI FSalida = 0;
         |SI #993#24 = "S";  |ACABA;  |FINSI;
     |FINSI;

     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida ! 0;
         |DDEFECTO #1001;
         #1001#0 = #992#0;
         #1001#1 = #992#1;
         |GRABA 020#1001b;
     |FINSI;

     |PARA nCampoPase = 0;  |SI nCampoPase [ 14;  |HACIENDO nCampoPase = nCampoPase + 1;
           #1001nCampoPase = #992nCampoPase;
     |SIGUE;

     |GRABA 020#1001a;
     |LIBERA #1001;
|FPRC;

|DEFBUCLE rem00102_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa102;
|FIN;

|PROCESO DatosPersonales;
     aDef = #0#0 + "/def/rem00100.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00100 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #992;
     #992#0 = #991#0;
     |LEE 040#992=;
     |SI FSalida = 0;
         aDef = aBaseRenta2014 + "/def/rem00100.mas";  |QBT aDef;
         |CARGA_DEF aDef, aficahor1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def rem00100 A쨚 2014 ";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |ABRE #1001;
         #1001#0 = #992#0;
         |LEE 101#1001=;
         |SI FSalida ! 0;
             |DDEFECTO #1001;
             #1001#0 = #992#0;
             |GRABA 020#1001b;
         |FINSI;

         |PARA nCampoPase = 0;  |SI nCampoPase [ 146;  |HACIENDO nCampoPase = nCampoPase + 1;
               #1001nCampoPase = #992nCampoPase;
         |SIGUE;

         eaCta = #1001#53;  |HAZ CalcuIBAN;  #1001#147 = eaIBAN;
         eaCta = #1001#54;  |HAZ CalcuIBAN;  #1001#148 = eaIBAN;
         eaCta = #1001#55;  |HAZ CalcuIBAN;  #1001#149 = eaIBAN;

         |GRABA 020#1001a;
         |LIBERA #1001;
         |CIERRA #1001;

         |DESCARGA_DEF #aficahor1@;
     |FINSI;
     |CIERRA #992;

     |DESCARGA_DEF #aficante2@;

     aDef = #0#0 + "/def/rem00101.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00101 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00101.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00101 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00101_2013;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;

     eaPrograma = "rem00100";
     eaPunto    = "";
     |HAZ ProgramaActivo;

     aDef = #0#0 + "/def/rem00102.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00102 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem00021.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00021 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00102.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00101 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;
     |PATH_DAT #993 aFich;

     |ABRE #1001;
     |ABRE #993;
     |BUCLE rem00102_2013;
     |CIERRA #1001;
     |CIERRA #993;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante3@;
     |DESCARGA_DEF #aficante2@;

     eaPrograma = "rem00102";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO Pasa020;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida ! 0;
         |DDEFECTO #1001;
         #1001#0 = #992#0;
         #1001#1 = #992#1;
         |GRABA 020#1001b;
     |FINSI;

     #1001#2  = #992#2;
     #1001#3  = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4  = 0;
     #1001#5  = #992#5;
     #1001#8  = #992#8;
     #1001#13 = #992#13;
     #1001#17 = #992#17;
     #1001#27 = #992#27;
     #1001#29 = #992#29;
     #1001#30 = #992#30;

                          #1001#38 = "";
     |SI #1001#31 = "S";  #1001#38 = eaAzul;  |FINSI;
     |SI #1001#3  = "X";  #1001#38 = eaRojo;        |FINSI;

     |GRABA 020#1001a;
     |LIBERA #1001;
|FPRC;

|DEFBUCLE rem00020_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa020;
|FIN;

|PROCESO Pasa019;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida ! 0;
         |DDEFECTO #1001;
         #1001#0 = #992#0;
         #1001#1 = #992#1;
         |GRABA 020#1001b;
     |FINSI;

     #1001#2  = #992#2;
     #1001#3  = #992#3;
     #1001#4  = #992#4;
     |GRABA 020#1001a;
     |LIBERA #1001;
|FPRC;

|DEFBUCLE rem00019_2013;
     #992#1002;
     3, 4;
     #991#0, "          ", "S", 2013;
     #991#0, "zzzzzzzzzz", "S", 2013;
     ;
     NULL, Pasa019;
|FIN;

|PROCESO Trabajo;
     aDef = #0#0 + "/def/rem00020.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00020 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00020.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00020 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00020_2013;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;

     eaPrograma = "rem00020";
     eaPunto    = "";
     |HAZ ProgramaActivo;

     aDef = #0#0 + "/def/rem00019.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00019 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00019.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00019 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00019_2013;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO El42;
     |ABRE #42;
     |SELECT #1#42;
     #42#0 = #992#0;
     #42#1 = 99;
     |LEE 040#42];
     |SI FSalida = 0;
         |LEE 040#42a;
     |SINO;
         |LEE 040#42u;
     |FINSI;

     |SI FSalida = 0; |Y #42#0 = #992#0;
         nLinea = #42#1 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #42;

     #42#0   = #992#0;
     #42#1   = nLinea;
     #42#2   = #992#2;
                       #42#3 = "X";
     |SI #0#37 = "N";  #42#3 = #992#3;  |FINSI;
     |SI #42#3 = "A";  #42#3 = "R";     |FINSI;

     #42#4   = 0;
     #42#5   = #992#5;
     #42#6   = #992#6;
     #42#7   = #992#7;
     #42#8   = #992#8;
     #42#9   = #992#9;
     #42#10  = #992#10;
     #42#11  = "G";
     #42#14  = #992#68;
     #42#15  = #992#13;
     #42#16  = #992#69;
     #42#17  = #992#75;
     #42#18  = #992#75 - #992#76;
     #42#19  = #992#108;
     #42#20  = 0;
     #42#13  = 0;
     #42#21  = 1;
     #42#22  = "T";

                        #42#23 = "";
     |SI #42#3  = "X";  #42#23 = eaRojo;        |FINSI;

     |GRABA 020#42n;
     |LIBERA #42;

     eaPrograma = "rem00042";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO rem01011;
     nGastos = nGastos + #999#15;
|FPRC;

|DEFBUCLE rem01011;
     #999#1004;
     9;
     enEmpresa, nComple, aContri, 001, aRefCast;
     enEmpresa, nComple, aContri, 999, aRefCast;
     ;
     NULL, rem01011;
|FIN;

|PROCESO rem01001;
     nComple  = #998#1;
     aContri  = #998#2;
     |BUCLE rem01011;
|FPRC;

|DEFBUCLE rem01001;
     #998#1003;
     5;
     enEmpresa, 00, "          ", "100";
     enEmpresa, 99, "zzzzzzzzzz", "101";
     ;
     NULL, rem01001;
|FIN;

|PROCESO RecogeGastos;
     aDef = #0#0 + "/def/rem01001.mas";  |QBT aDef;
     |CARGA_DEF aDef, rem01001@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = #0#0 + "/def/rem01011.mas";  |QBT aDef;
     |CARGA_DEF aDef, rem01011@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PATH_DAT #998 aFich;
     |PATH_DAT #999 aFich;

     nGastos = 0;
     |BUCLE rem01001;

     |DESCARGA_DEF #rem01011@;
     |DESCARGA_DEF #rem01001@;
|FPRC;

|PROCESO Pasa021;
     |SI #992#24 = "S";  |Y #0#39 = "S";
         |SI #992#75 = 0;        |ACABA;  |FINSI;
         |SI #992#76 ] #992#75;  |ACABA;  |FINSI;

         |HAZ El42;

         |ACABA;
     |FINSI;

     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1;
     |FINSI;

     |DDEFECTO #1001;
     |SI #0#32 = "N";
         #1001#0   = #992#0;
         #1001#1   = #992#1;
         #1001#2   = #992#2;
         #1001#3   = "X";
         |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
         #1001#4   = 0;
         #1001#5   = #992#5;
         #1001#6   = #992#6;
         #1001#7   = #992#7;
         #1001#8   = #992#8;
         #1001#9   = #992#9;
         #1001#10  = #992#10;
         #1001#13  = #992#13;
         #1001#14  = #992#14;
         #1001#16  = #992#16;
         #1001#17  = #992#17;
         #1001#18  = #992#18;
         #1001#19  = #992#19;
         #1001#20  = #992#20;
         #1001#25  = #992#25;
         #1001#26  = #992#26;
         #1001#29  = #992#29;
         #1001#30  = #992#30;
         #1001#31  = #992#31;
         #1001#32  = #992#32;
         #1001#33  = #992#33;
         #1001#34  = #992#34;
         #1001#35  = #992#35;
         #1001#36  = #992#36;
         #1001#104 = #992#104;
         #1001#105 = #992#105;
         #1001#106 = #992#106;
         #1001#117 = #992#117;
         #1001#118 = #992#118;
         #1001#119 = #992#119;
         #1001#120 = #992#120;
         #1001#121 = #992#121;
         #1001#122 = #992#122;
         #1001#123 = #992#123;
         #1001#124 = #992#124;
         #1001#125 = #992#125;
         #1001#127 = #992#127;
         #1001#128 = #992#128;
         #1001#132 = #992#132;
         #1001#133 = #992#133;
         #1001#134 = #992#134;
         #1001#116 = #992#116;
     |SINO;
         #1001#0   = #992#0;
         #1001#1   = #992#1;
         #1001#2   = #992#2;
         #1001#3   = "X";
         |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
         #1001#4   = 0;
         #1001#5   = #992#5;
         #1001#6   = #992#6;
         #1001#7   = #992#7;
         #1001#8   = #992#8;
         #1001#9   = #992#9;
         #1001#10  = #992#10;
         #1001#13  = #992#13;
         #1001#14  = #992#14;
         #1001#15  = #992#15;
         #1001#16  = #992#16;
         #1001#17  = #992#17;
         #1001#18  = #992#18;
         #1001#19  = #992#19;
         #1001#20  = #992#20;
         #1001#21  = #992#21;
         #1001#22  = #992#22;
         #1001#23  = #992#23;
         #1001#25  = #992#25;
         #1001#26  = #992#26;
         #1001#27  = #992#27;
         #1001#28  = #992#28;
         #1001#29  = #992#29;
         #1001#95  = #992#95;
         #1001#96  = #992#96;
         #1001#97  = #992#97;
         #1001#98  = #992#98;
         #1001#99  = #992#99;
         #1001#100 = #992#100;
         #1001#101 = #992#101;
         #1001#102 = #992#102;
         #1001#103 = #992#103;

         #1001#104 = #992#104;
         #1001#105 = #992#105;
         #1001#106 = #992#106;
         #1001#117 = #992#117;
         #1001#118 = #992#118;
         #1001#119 = #992#119;
         #1001#120 = #992#120;
         #1001#121 = #992#121;
         #1001#122 = #992#122;
         #1001#123 = #992#123;
         #1001#124 = #992#124;

         |PARA nCampoPase = 30;  |SI nCampoPase [ 61;  |HACIENDO nCampoPase = nCampoPase + 1;
               #1001nCampoPase = #992nCampoPase;
         |SIGUE;

         #1001#38  = #992#38;
         #1001#40  = #992#40;
         #1001#42  = #992#42;
         #1001#44  = #992#44;
         #1001#45  = #992#45;
         #1001#45  = #992#45;
         #1001#47  = #992#47;
         #1001#45  = #992#45;
         #1001#51  = #992#51;
         #1001#51  = #992#51;
         #1001#53  = #992#53;
         #1001#55  = #992#55;
         #1001#57  = #992#57;
         #1001#60  = #992#60;
         #1001#61  = #992#61;
         #1001#116 = #992#116;
         #1001#134 = #992#134;
         #1001#125 = #992#125;
         #1001#126 = #992#126;
         #1001#127 = #992#127;
         #1001#128 = #992#128;
         #1001#129 = #992#129;
         #1001#130 = #992#130;
         #1001#131 = #992#131;
         #1001#132 = #992#132;
         #1001#133 = #992#133;

         |SI #1001#30 ! 0;  |Y  #1001#33 ! 0;
             nSuma = #1001#30 + #1001#33;
             #1001#30 = nSuma;
             #1001#33 = 0;
         |FINSI;

         |SI #1001#31 ! 0;  |Y  #1001#34 ! 0;
             nSuma = #1001#31 + #1001#34;
             #1001#31 = nSuma;
             #1001#34 = 0;
         |FINSI;

         |SI #1001#32 ! 0;  |Y  #1001#35 ! 0;
             nSuma = #1001#32 + #1001#35;
             #1001#32 = nSuma;
             #1001#35 = 0;
         |FINSI;

         |SI #0#30 = "S";
             #1001#15 = (N\ #1001#15 + (#1001#15 % #0#31));
         |FINSI;

         |SI #0#29 = "S";
             |ABRE #1;
             #1#0 = #1001#105;
             #1#1 = #1001#106;
             |LEE 040#1=;
             |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
             |CIERRA #1;

             nSuma  = ((#1001#21 / #1#2) * #1#3);
             nSuma1 = ((#1001#21 / #1#2) * #1#3) % #0#31;

             |SI #1#3 ] #1#2;
                 #1001#21 = (N\ nSuma + nSuma1);
             |SINO;
                 #1001#21 = (N\ nSuma - nSuma1);
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1001#30 ] 365;  #1001#30 = 365;  |FINSI;
     |SI #1001#31 ] 365;  #1001#31 = 365;  |FINSI;
     |SI #1001#32 ] 365;  #1001#32 = 365;  |FINSI;
     |SI #1001#33 ] 365;  #1001#33 = 365;  |FINSI;
     |SI #1001#34 ] 365;  #1001#34 = 365;  |FINSI;
     |SI #1001#35 ] 365;  #1001#35 = 365;  |FINSI;

     enEmpresa = #1001#0;
     aRefCast  = #1001#14;
     |HAZ RecogeGastos;

     #1001#140 = nGastos;

                           #1001#143 = "";
     |SI #1001#117 = "S";  #1001#143 = eaAzul;  |FINSI;
     |SI #1001#3   = "X";  #1001#143 = eaRojo;  |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00021";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00021_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa021;
|FIN;

|PROCESO Pasa049;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;

                          #1001#24 = "";
     |SI #1001#3  = "X";  #1001#24 = eaRojo;        |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00049";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00049_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa049;
|FIN;

|PROCESO Inmuebles;
     aDef = #0#0 + "/def/rem00021.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00021 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00021.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00021 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00021_2013;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;

     aDef = #0#0 + "/def/rem00049.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00049 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00049.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00049 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00049_2013;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa022;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#13  = #992#13;
     #1001#14  = #992#14;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;
     #1001#25  = 0;
     #1001#26  = 0;
     #1001#29  = #992#29;

     |SI #0#33 = "S";
         #1001#15  = #992#15;
     |FINSI;

                          #1001#30 = "";
     |SI #1001#3  = "X";  #1001#30 = eaRojo;        |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00022";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00022_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa022;
|FIN;

|PROCESO Pasa043C;
     |SI #992#4 = "V";  |ACABA;  |FINSI;

     #1001#0 = #992#0;
     #1001#1 = #992#1;
     #1001#2 = #992#2;
     #1001#3 = #992#3;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = #992#3;
     #1001#4   = #992#4;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#13  = #992#13;
     #1001#14  = #992#14;
     |GRABA 020#1001n;
     |LIBERA #1001;
|FPRC;

|DEFBUCLE rem00043C_2013;
     #992#1004;
     ;
     #991#0, 01, "01.01.0000", 01;
     #991#0, 99, "31.12.2999", 99;
     ;
     NULL, Pasa043C;
|FIN;

|PROCESO RegrabaCompra;
     |SI nAcciones = 0;  |ACABA;  |FINSI;

     |SI #992#6 = #1001#6;  |Y #992#7 = #1001#7;
         |SI nAcciones = #1001#5;
             |BORRA 020#1001a;
             nAcciones = 0;
             |ACABA;
         |FINSI;
         |SI nAcciones < #1001#5;
             #1001#5 = (N\ #1001#5 - nAcciones);
             #1001#8 = (N\ #1001#5 * #1001#7);
             |GRABA 020#1001a;
             nAcciones = 0;
             |ACABA;
         |FINSI;
         |SI nAcciones > #1001#5;
             nAcciones = nAcciones - #1001#5;
             |BORRA 020#1001a;
             |ACABA;
         |FINSI;
     |FINSI;

     |LIBERA #1001;
|FPRC;

|DEFBUCLE rem00043_2013;
     #1001#1004;
     ;
     #992#0, #992#1, "01.01.0000", 01;
     #992#0, #992#1, "31.12.2999", 99;
     be;
     NULL, RegrabaCompra;
|FIN;

|PROCESO Pasa043V;
     |SI #992#4 = "C";  |ACABA;  |FINSI;

     nAcciones = #992#5;
     |BUCLE rem00043_2013;
|FPRC;

|DEFBUCLE rem00043V_2013;
     #992#1004;
     ;
     #991#0, 01, "01.01.0000", 01;
     #991#0, 99, "31.12.2999", 99;
     ;
     NULL, Pasa043V;
|FIN;

|PROCESO Pasa023;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#13  = #992#13;
     #1001#14  = #992#14;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#24  = #992#24;
     #1001#33  = #992#33;

     |SI #0#33 = "S";
         #1001#15  = #992#15;
     |FINSI;

                          #1001#37 = "";
     |SI #1001#3  = "X";  #1001#37 = eaRojo;        |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00023";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00023_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa023;
|FIN;

|PROCESO Mobiliario2;
     aDef = #0#0 + "/def/rem00023.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00023 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00023.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00023 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00023_2013;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa050;
     #1002#0 = #993#0;
     #1002#1 = #993#1;
     #1002#2 = #993#2;
     |LEE 101#1002=;
     |SI FSalida = 0;
         |BORRA 020#1002a;
         |LIBERA #1002;
     |FINSI;

     |DDEFECTO #1002;
     #1002#0   = #993#0;
     #1002#1   = #993#1;
     #1002#2   = #993#2;
     #1002#3   = #993#3;
     #1002#4   = #993#4;
     #1002#5   = #993#5;
     #1002#6   = #993#6;
     #1002#7   = #993#7;
     #1002#8   = #993#8;
     #1002#9   = #993#9;

     |GRABA 020#1002n;
     |LIBERA #1002;
|FPRC;

|DEFBUCLE rem00050_2013;
     #993#1003;
     ;
     #992#0, #992#1, 1900;
     #992#0, #992#1, 2999;
     ;
     NULL, Pasa050;
|FIN;

|PROCESO Pasa024;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#13  = #992#13;
     #1001#14  = #992#14;
     #1001#15  = #992#15;
     |SI #1001#12 ! 0;
         #1001#12 = (N\ #1001#12 + 1);
     |FINSI;

     #1001#26 = #992#26;

     |SI #992#27 ! 0;
         #1001#27 = (N\ #992#27 + 1);
     |FINSI;

     |SI #0#33 = "S";
         #1001#25  = #992#25;
     |FINSI;

                          #1001#28 = "";
     |SI #1001#3  = "X";  #1001#28 = eaRojo;        |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00024";
     eaPunto    = "";
     |HAZ ProgramaActivo;

     |SI #1001#12 ] 1;  |Y #1001#12 [ 12;
         |BUCLE rem00050_2013;
     |FINSI;
|FPRC;

|DEFBUCLE rem00024_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa024;
|FIN;

|PROCESO Mobiliario3;
     aDef = #0#0 + "/def/rem00024.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00024 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem00050.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00050 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00024.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00024 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00050.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00050 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;
     |PATH_DAT #993 aFich;

     |ABRE #1001;
     |ABRE #1002;
     |BUCLE rem00024_2013;
     |CIERRA #1001;
     |CIERRA #1002;

     |DESCARGA_DEF #aficahor2@;
     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante3@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa051;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#13  = #992#13;
     #1001#14  = #992#14;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#20  = #992#20;
     |SI #1001#20 > 0;  #1001#20 = (N\ #1001#20 + 1);  |FINSI;

     |SI #0#33 = "S";
         #1001#15  = #992#15;
     |FINSI;

                          #1001#30 = "";
     |SI #1001#3  = "X";  #1001#30 = eaRojo;        |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00051";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00051_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa051;
|FIN;

|PROCESO Mobiliario4;
     aDef = #0#0 + "/def/rem00051.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00051 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00051.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00051 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00051_2013;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO rem00060;
     |BORRA 020#60a;
     |LIBERA #60;
|FPRC;

|DEFBUCLE rem00060;
     #60#1;
     ;
     nEmpresa, nLinea, 01;
     nEmpresa, nLinea, 99;
     be;
     NULL, rem00060;
|FIN;

|PROCESO Pasa055;
     nEmpresa = #992#0;
     nLinea   = #992#1;
     |BUCLE rem00060;

     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#13  = #992#13;
     #1001#14  = #992#14;
     #1001#16  = #992#16;
     #1001#17  = #992#17;

     |SI #0#33 = "S";
         #1001#15  = #992#15;
     |FINSI;

                          #1001#27 = "";
     |SI #1001#3  = "X";  #1001#27 = eaRojo;        |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00055";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00055_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa055;
|FIN;

|PROCESO Mobiliario6;
     aDef = #0#0 + "/def/rem00055.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00055 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00055.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00055 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00055_2013;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa025;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#14  = #992#14;
     #1001#15  = #992#15;
     #1001#16  = #992#16;

     |SI #992#18 = "P"; #1001#17 = "5";  |FINSI;
     |SI #992#18 = "A"; #1001#17 = "4";  |FINSI;
     |SI #992#18 = "E";
         #992#17 = "1";
         |SI #992#17  = "N";  #1001#17 = "3";  |FINSI;
         |SI #992#20  = "S";  #1001#17 = "2";  |FINSI;
     |FINSI;

     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#21  = #992#21;
     #1001#22  = #992#22;
     #1001#23  = #992#23;
     #1001#24  = #992#24;
     #1001#25  = #992#25;
     #1001#54  = #992#54;

                          #1001#57 = "";
     |SI #1001#3  = "X";  #1001#57 = eaRojo;        |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00025";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00025_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa025;
|FIN;

|PROCESO Actividad1;
     aDef = #0#0 + "/def/rem00025.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00025 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00025.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00025 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00025_2013;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa026;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#14  = #992#14;
     #1001#15  = #992#15;
     #1001#16  = #992#16;

     |SI #992#18 = "P"; #1001#17 = "5";  |FINSI;
     |SI #992#18 = "A"; #1001#17 = "4";  |FINSI;
     |SI #992#18 = "E";
         #992#17 = "1";
         |SI #992#17  = "N";  #1001#17 = "3";  |FINSI;
         |SI #992#20  = "S";  #1001#17 = "2";  |FINSI;
     |FINSI;

     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#21  = #992#21;
     #1001#22  = #992#22;
     #1001#23  = #992#23;
     #1001#24  = #992#24;
     #1001#25  = #992#25;
     #1001#56  = #992#56;

                          #1001#59 = "";
     |SI #1001#3  = "X";  #1001#59 = eaRojo;        |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00026";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00026_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa026;
|FIN;

|PROCESO Actividad2;
     aDef = #0#0 + "/def/rem00026.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00026 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00026.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00026 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00026_2013;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa027;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#14  = #992#14;
     #1001#15  = #992#15;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#20  = #992#20;
     #1001#21  = #992#21;
     #1001#22  = #992#22;
     #1001#23  = #992#23;

                          #1001#123 = "";
     |SI #1001#3  = "X";  #1001#123 = eaRojo;        |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00027";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00027_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa027;
|FIN;

|PROCESO Actividad3;
     aDef = #0#0 + "/def/rem00027.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00027 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00027.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00027 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00027_2013;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa028;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#14  = #992#14;
     #1001#15  = #992#15;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#20  = #992#20;
     #1001#21  = #992#21;
     #1001#22  = #992#22;
     #1001#23  = #992#23;
     #1001#24  = #992#24;

                          #1001#68 = "";
     |SI #1001#3  = "X";  #1001#68 = eaRojo;        |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00028";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00028_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa028;
|FIN;

|PROCESO Actividad4;
     aDef = #0#0 + "/def/rem00028.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00028 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00028.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00028 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00028_2013;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa058;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#13  = #992#13;
     #1001#14  = #992#14;
     #1001#15  = #992#15;

                          #1001#33 = "";
     |SI #1001#3  = "X";  #1001#33 = eaRojo;        |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00058";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00058_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa058;
|FIN;

|PROCESO AtribRenta;
     aDef = #0#0 + "/def/rem00058.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00058 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00058.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00058 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00058_2013;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa053;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#13  = #992#13;
     #1001#17  = #992#17;
     #1001#21  = #992#21;
     #1001#22  = #992#22;
     #1001#23  = #992#23;
     #1001#24  = #992#24;
     #1001#25  = #992#25;
     #1001#26  = #992#26;
     #1001#29  = #992#29;

                          #1001#28 = "";
     |SI #1001#21 = "S";  #1001#28 = eaAzul;  |FINSI;
     |SI #1001#3  = "X";  #1001#28 = eaRojo;  |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00053";
     eaPunto    = "";
     |HAZ ProgramaActivo;

     |SI #1001#21 = "S";
         #1002#0 = #992#0;
         #1002#1 = #1001#22;
         |LEE 101#1002=;
         |SI FSalida ! 0;
             |DDEFECTO #1002;
             #1002#0  = #992#0;
             #1002#1  = #1001#22;
             #1002#13 = #1001#11;
             |GRABA 020#1002n;
             |LIBERA #1002;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE rem00053_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa053;
|FIN;

|PROCESO Pasa061;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;

                        #1001#14 = "";
     |SI #1001#3  = "X";  #1001#14 = eaRojo;        |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00061";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00061_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa061;
|FIN;

|PROCESO Pensiones;
     aDef = #0#0 + "/def/rem00053.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00053 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00053.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00053 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00020.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00020 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |ABRE #1002;
     |BUCLE rem00053_2013;
     |CIERRA #1001;
     |CIERRA #1002;

     |DESCARGA_DEF #aficahor2@;
     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;

     aDef = #0#0 + "/def/rem00061.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00061 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00061.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00061 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00061_2013;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa054;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#14  = #992#14;

                          #1001#16 = "";
     |SI #1001#3  = "X";  #1001#16 = eaRojo;        |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00054";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00054_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa054;
|FIN;

|PROCESO Anualidades;
     aDef = #0#0 + "/def/rem00054.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00054 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00054.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00054 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00054_2013;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa032;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#13  = #992#13;

                          #1001#27 = "";
     |SI #1001#3  = "X";  #1001#27 = eaRojo;        |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00032";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00032_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa032;
|FIN;

|PROCESO TFiscal;
     aDef = #0#0 + "/def/rem00032.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00032 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00032.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00032 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00032_2013;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa046;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#14  = #992#14;

                          #1001#16 = "";
     |SI #1001#3  = "X";  #1001#16 = eaRojo;        |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00046";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00046_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa046;
|FIN;

|PROCESO Donativos;
     aDef = #0#0 + "/def/rem00046.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00046 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00046.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00046 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00046_2013;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO GrabaDedu;
     |SI nImporte = 0;  |ACABA;  |FINSI;

     |SELECT #3#2;
     #2#7 = #994#11;
     #2#8 = #994#13;
     |LEE 040#2=;
     |SI FSalida ! 0;
         #2#9  = 0;
         #2#10 = 0;

         |SI #994#11 = 1;
                               #2#9  = 1;  #2#10 = 2;
             |SI #994#13 = 1;  #2#9  = 1;  #2#10 = 1;  |FINSI;
             |SI #994#13 = 2;  #2#9  = 1;  #2#10 = 1;  |FINSI;
             |SI #994#13 = 3;  #2#9  = 1;  #2#10 = 1;  |FINSI;
             |SI #994#13 = 4;  #2#9  = 1;  #2#10 = 1;  |FINSI;
             |SI #994#13 = 5;  #2#9  = 1;  #2#10 = 1;  |FINSI;
         |FINSI;

         |SI #994#11 = 2;
             #2#9  = 1;  #2#10 = 5;
         |FINSI;

         |SI #994#11 = 3;
             #2#9 = 3;  #2#10 = 5;
         |FINSI;

         |SI #994#11 = 4;
             #2#9 = 4;  #2#10 = 5;
         |FINSI;

         |SI #2#9 = 0;  |Y #2#10 = 0;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #992#2 = "TITULAR   ";
         |SI #994#2 = "CONYUGE   ";  |ACABA;  |FINSI;
         |SI #994#2 = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "4 FAMILIAR";  |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "CONYUGE   ";
         |SI #994#2 = "TITULAR   ";  |ACABA;  |FINSI;
         |SI #994#2 = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "4 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "GANANCIAL ";  |ACABA;  |FINSI;
         |SI #994#2 = "VARIOS    ";  |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "1 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "2 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "3 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "4 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #994#17 = 0;
         nCompara = #994#18;
     |SINO;
         nCompara = #994#19;
     |FINSI;

     |SELECT #1#2;
     #2#0 = #2#9;
     #2#1 = #2#10;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

     |SI nImporte = nCompara;
         #1001#0 = #994#0;
         #1001#1 = #994#1;
         |LEE 101#1001=;
         |SI FSalida = 0;
             |BORRA 020#1001a;
             |LIBERA #1001;
         |FINSI;

         |PARA nCampoPase = 0;  |SI nCampoPase [ 21;  |HACIENDO nCampoPase = nCampoPase + 1;
               #1001nCampoPase = #994nCampoPase;
         |SIGUE;
         #1001#3  = "X";
         |SI #0#37 = "N";  #1001#3 = #994#3;  |FINSI;

         #1001#11 = #2#0;
         #1001#12 = #2#2;
         #1001#13 = #2#1;
         #1001#14 = #2#3;
         #1001#15 = #2#4;
         #1001#16 = #2#5;
         #1001#17 = #2#6;

         nImpo    = nImporte;

         |SI #1001#17 ! 0;
             #1001#18 = (N\ ((nImpo * 100) / #1001#17) ! 2);
             #1001#19 = nImpo;
         |SINO;
             #1001#18 = nImpo;
             #1001#19 = nImpo;
         |FINSI;

                              #1001#22 = "";
         |SI #1001#3  = "X";  #1001#22 = eaRojo;        |FINSI;

         |GRABA 020#1001n;
         |LIBERA #1001;

         eaPrograma = "rem00045";
         eaPunto    = "";
         |HAZ ProgramaActivo;

         nImporte = 0;

         |ACABA;
     |FINSI;

     |SI nImporte < nCompara;
         #1001#0 = #994#0;
         #1001#1 = #994#1;
         |LEE 101#1001=;
         |SI FSalida = 0;
             |BORRA 020#1001a;
             |LIBERA #1001;
         |FINSI;

         |PARA nCampoPase = 0;  |SI nCampoPase [ 21;  |HACIENDO nCampoPase = nCampoPase + 1;
               #1001nCampoPase = #994nCampoPase;
         |SIGUE;
         #1001#3  = "X";
         |SI #0#37 = "N";  #1001#3 = #994#3;  |FINSI;
         #1001#11 = #2#0;
         #1001#12 = #2#2;
         #1001#13 = #2#1;
         #1001#14 = #2#3;
         #1001#15 = #2#4;
         #1001#16 = #2#5;
         #1001#17 = #2#6;

         nImpo    = nImporte;

         |SI #1001#17 ! 0;
             #1001#18 = (N\ ((nImpo * 100) / #1001#17) ! 2);
             #1001#19 = nImpo;
         |SINO;
             #1001#18 = nImpo;
             #1001#19 = nImpo;
         |FINSI;

                              #1001#22 = "";
         |SI #1001#3  = "X";  #1001#22 = eaRojo;        |FINSI;

         |GRABA 020#1001n;

         eaPrograma = "rem00045";
         eaPunto    = "";
         |HAZ ProgramaActivo;

         nImporte = 0;

         |ACABA;
     |FINSI;

     |SI nImporte > nCompara;
         #1001#0 = #994#0;
         #1001#1 = #994#1;
         |LEE 101#1001=;
         |SI FSalida = 0;
             |BORRA 020#1001a;
             |LIBERA #1001;
         |FINSI;

         |PARA nCampoPase = 0;  |SI nCampoPase [ 21;  |HACIENDO nCampoPase = nCampoPase + 1;
               #1001nCampoPase = #994nCampoPase;
         |SIGUE;
         #1001#3  = "X";
         |SI #0#37 = "N";  #1001#3 = #994#3;  |FINSI;
         #1001#11 = #2#0;
         #1001#12 = #2#2;
         #1001#13 = #2#1;
         #1001#14 = #2#3;
         #1001#15 = #2#4;
         #1001#16 = #2#5;
         #1001#17 = #2#6;

         nImpo    = nCompara;

         |SI #1001#17 ! 0;
             #1001#18 = (N\ ((nImpo * 100) / #1001#17) ! 2);
             #1001#19 = nImpo;
         |SINO;
             #1001#18 = nImpo;
             #1001#19 = nImpo;
         |FINSI;

                              #1001#22 = "";
         |SI #1001#3  = "X";  #1001#22 = eaRojo;        |FINSI;

         |GRABA 020#1001n;

         eaPrograma = "rem00045";
         eaPunto    = "";
         |HAZ ProgramaActivo;

         nImporte = nImporte - nCompara;
         |ACABA;
     |FINSI;
|FPRC;

|DEFBUCLE rem00045_2013;
     #994#1002;
     11, 13;
     #993#0, 01, nAgru, nCasi;
     #993#0, 99, nAgru, nCasi;
     ;
     NULL, GrabaDedu;
|FIN;

|PROCESO PonDedu;
     |ABRE #2;
     |BUCLE rem00045_2013;
     |CIERRA #2;
|FPRC;

|PROCESO InvEmpresariales;
     #993#0 = #992#0;
     #993#1 = #992#1;
     #993#2 = #992#2;
     |LEE 040#993=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nImporte = 0;
     |SI #993#5   ! 0;  nImporte = #993#5;   nAgru = 1;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 1;  nCasi = 3;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 1;  nCasi = 4;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 1;  nCasi = 5;  |HAZ PonDedu;  |FINSI;

     nImporte = 0;
     |SI #993#8   ! 0;  nImporte = #993#8;   nAgru = 1;  nCasi = 6;  |HAZ PonDedu;  |FINSI;

     nImporte = 0;
     |SI #993#11  ! 0;  nImporte = #993#11;  nAgru = 2;  nCasi = 1;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 2;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 2;  nCasi = 3;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 2;  nCasi = 4;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 2;  nCasi = 5;  |HAZ PonDedu;  |FINSI;

     |SI #993#14  ! 0;  nImporte = #993#14;  nAgru = 2;  nCasi = 6;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 2;  nCasi = 7;  |HAZ PonDedu;  |FINSI;

     |SI #993#17  ! 0;  nImporte = #993#17;  nAgru = 2;  nCasi =  8; |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 2;  nCasi =  9; |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 2;  nCasi = 10; |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 2;  nCasi = 11; |HAZ PonDedu;  |FINSI;

     |SI #993#20  ! 0;  nImporte = #993#20;  nAgru = 2;  nCasi = 12; |HAZ PonDedu;  |FINSI;
     |SI #993#23  ! 0;  nImporte = #993#23;  nAgru = 2;  nCasi = 13; |HAZ PonDedu;  |FINSI;
     |SI #993#26  ! 0;  nImporte = #993#26;  nAgru = 2;  nCasi = 14; |HAZ PonDedu;  |FINSI;
     |SI #993#29  ! 0;  nImporte = #993#29;  nAgru = 2;  nCasi = 15; |HAZ PonDedu;  |FINSI;

     |SI #993#32  ! 0;  nImporte = #993#32;  nAgru = 2;  nCasi = 16; |HAZ PonDedu;  |FINSI;
     |SI #993#35  ! 0;  nImporte = #993#35;  nAgru = 2;  nCasi = 17; |HAZ PonDedu;  |FINSI;
     |SI #993#38  ! 0;  nImporte = #993#38;  nAgru = 2;  nCasi = 18; |HAZ PonDedu;  |FINSI;
     |SI #993#41  ! 0;  nImporte = #993#41;  nAgru = 2;  nCasi = 19; |HAZ PonDedu;  |FINSI;
     |SI #993#44  ! 0;  nImporte = #993#44;  nAgru = 2;  nCasi = 20; |HAZ PonDedu;  |FINSI;
     |SI #993#47  ! 0;  nImporte = #993#47;  nAgru = 2;  nCasi = 21; |HAZ PonDedu;  |FINSI;
     |SI #993#50  ! 0;  nImporte = #993#50;  nAgru = 2;  nCasi = 22; |HAZ PonDedu;  |FINSI;
     |SI #993#53  ! 0;  nImporte = #993#53;  nAgru = 2;  nCasi = 23; |HAZ PonDedu;  |FINSI;
     |SI #993#56  ! 0;  nImporte = #993#56;  nAgru = 2;  nCasi = 24; |HAZ PonDedu;  |FINSI;
     |SI #993#59  ! 0;  nImporte = #993#59;  nAgru = 2;  nCasi = 25; |HAZ PonDedu;  |FINSI;
     |SI #993#62  ! 0;  nImporte = #993#62;  nAgru = 2;  nCasi = 26; |HAZ PonDedu;  |FINSI;
     |SI #993#65  ! 0;  nImporte = #993#65;  nAgru = 2;  nCasi = 27; |HAZ PonDedu;  |FINSI;
     |SI #993#68  ! 0;  nImporte = #993#68;  nAgru = 2;  nCasi = 28; |HAZ PonDedu;  |FINSI;
     |SI #993#71  ! 0;  nImporte = #993#71;  nAgru = 2;  nCasi = 29; |HAZ PonDedu;  |FINSI;
     |SI #993#74  ! 0;  nImporte = #993#74;  nAgru = 2;  nCasi = 30; |HAZ PonDedu;  |FINSI;
     |SI #993#77  ! 0;  nImporte = #993#77;  nAgru = 2;  nCasi = 31; |HAZ PonDedu;  |FINSI;
     |SI #993#80  ! 0;  nImporte = #993#80;  nAgru = 2;  nCasi = 32; |HAZ PonDedu;  |FINSI;
     |SI #993#83  ! 0;  nImporte = #993#83;  nAgru = 2;  nCasi = 33; |HAZ PonDedu;  |FINSI;
     |SI #993#86  ! 0;  nImporte = #993#86;  nAgru = 2;  nCasi = 34; |HAZ PonDedu;  |FINSI;
     |SI #993#89  ! 0;  nImporte = #993#89;  nAgru = 2;  nCasi = 35; |HAZ PonDedu;  |FINSI;
     |SI #993#92  ! 0;  nImporte = #993#92;  nAgru = 2;  nCasi = 36; |HAZ PonDedu;  |FINSI;
     |SI #993#95  ! 0;  nImporte = #993#95;  nAgru = 2;  nCasi = 37; |HAZ PonDedu;  |FINSI;
     |SI #993#98  ! 0;  nImporte = #993#98;  nAgru = 2;  nCasi = 38; |HAZ PonDedu;  |FINSI;
     |SI #993#101 ! 0;  nImporte = #993#101; nAgru = 2;  nCasi = 39; |HAZ PonDedu;  |FINSI;
     |SI #993#104 ! 0;  nImporte = #993#104; nAgru = 2;  nCasi = 40; |HAZ PonDedu;  |FINSI;
     |SI #993#107 ! 0;  nImporte = #993#107; nAgru = 2;  nCasi = 41; |HAZ PonDedu;  |FINSI;

     nImporte = 0;
     |SI #993#110 ! 0;  nImporte = #993#110; nAgru = 3;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 3;  nCasi = 3;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 3;  nCasi = 4;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 3;  nCasi = 5;  |HAZ PonDedu;  |FINSI;

     nImporte = 0;
     |SI #993#113 ! 0;  nImporte = #993#113; nAgru = 4;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 4;  nCasi = 3;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 4;  nCasi = 4;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 4;  nCasi = 5;  |HAZ PonDedu;  |FINSI;

     nImporte = 0;
     |SI #993#116 ! 0;  nImporte = #993#116; nAgru = 5;  nCasi = 1;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 5;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 5;  nCasi = 3;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 5;  nCasi = 4;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 5;  nCasi = 5;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 5;  nCasi = 6;  |HAZ PonDedu;  |FINSI;

     nImporte = 0;
     |SI #993#119 ! 0;  nImporte = #993#119; nAgru = 5;  nCasi = 7;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 5;  nCasi = 8;  |HAZ PonDedu;  |FINSI;

     |SI #993#122 ! 0;  nImporte = #993#122; nAgru = 5;  nCasi =  9; |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 5;  nCasi = 10; |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 5;  nCasi = 11; |HAZ PonDedu;  |FINSI;

     |SI #993#125 ! 0;  nImporte = #993#125; nAgru = 5;  nCasi = 13; |HAZ PonDedu;  |FINSI;
     |SI #993#128 ! 0;  nImporte = #993#128; nAgru = 5;  nCasi = 14; |HAZ PonDedu;  |FINSI;

     |SI #993#131 ! 0;  nImporte = #993#131; nAgru = 6;  nCasi = 1;  |HAZ PonDedu;  |FINSI;

     nImporte = 0;
     |SI #993#141 ! 0;  nImporte = #993#141; nAgru = 7;  nCasi = 3;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 7;  nCasi = 4;  |HAZ PonDedu;  |FINSI;

     nImporte = 0;
     |SI #993#145 ! 0;  nImporte = #993#145; nAgru = 7;  nCasi = 5;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 7;  nCasi = 6;  |HAZ PonDedu;  |FINSI;

     nImporte = 0;
     |SI #993#149 ! 0;  nImporte = #993#149; nAgru = 7;  nCasi = 7;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 7;  nCasi = 8;  |HAZ PonDedu;  |FINSI;

     nImporte = 0;
     |SI #993#153 ! 0;  nImporte = #993#153; nAgru = 7;  nCasi = 9;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 7;  nCasi = 10; |HAZ PonDedu;  |FINSI;
|FPRC;

|PROCESO GrabaOtras;
     |SI #992#2 = "TITULAR   ";
         |SI #994#2 = "CONYUGE   ";  |ACABA;  |FINSI;
         |SI #994#2 = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "4 FAMILIAR";  |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "CONYUGE   ";
         |SI #994#2 = "TITULAR   ";  |ACABA;  |FINSI;
         |SI #994#2 = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "4 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "GANANCIAL ";  |ACABA;  |FINSI;
         |SI #994#2 = "VARIOS    ";  |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "1 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "2 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "3 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "4 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     #1001#0  = #994#0;
     #1001#1  = 99;
     |LEE 000#1001];
     |SI FSalida = 0;
         |LEE 000#1001a;
     |SINO;
         |LEE 000#1001u;
     |FINSI;

     nLinea = 1;
     |SI FSalida = 0;  |Y #1001#0 = #994#0;
         nLinea = #1001#1 + 1;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0  = #994#0;
     #1001#1  = nLinea;
     |PARA nCampoPase = 2;  |SI nCampoPase [ 15;  |HACIENDO nCampoPase = nCampoPase + 1;
           #1001nCampoPase = #994nCampoPase;
     |SIGUE;

     |SI #994#14 [ nImporte;
         nImporte = nImporte - #994#14;
         |ACABA;
     |SINO;
         #1001#14 = (N\ #994#14 - nImporte);
         nImporte = 0;
     |FINSI;

     |SELECT #2#rem02002;
     #rem02002#3 = #994#11;
     |LEE 000#rem02002.=;

     #1001#11 = #rem02002#0;

     |SI #rem02002#2 = "S";
         nAnyo = #994#13;
     |SINO;
         |SI nAnyo = 0;  nAnyo = #994#13;  |FINSI;

         |SI nAnyo = 0;  |ACABA;  |FINSI;
     |FINSI;

     #1001#13  = nAnyo;
                       #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #994#3;  |FINSI;

                          #1001#16 = "";
     |SI #1001#3  = "X";  #1001#16 = eaRojo;        |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00056";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00056_2013;
     #994#1002;
     11, 13;
     #992#0, 01, nTipo, nDEjer;
     #992#0, 99, nTipo, nHEjer;
     ;
     NULL, GrabaOtras;
|FIN;

|PROCESO PonOtras;
     |ABRE #rem02002;
     |BUCLE rem00056_2013;
     |CIERRA #rem02002;
|FPRC;

|PROCESO BuscaSiEsta;
     nGrabo   = 1;

     |PARA nLinea = 1;  |SI nLinea [ 99;  |HACIENDO nLinea = nLinea + 1;
           #1001#0  = #995#0;
           #1001#1  = nLinea;
           |LEE 000#1001=;
           |SI FSalida = 0;
               |SI #1001#2  = aContri;  |Y #1001#14 = nImporte;  |Y #1001#11 = nTipo;
                   nGrabo = 0;
                   |SAL;
               |FINSI;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO OtrasDeducciones;
     #995#0 = #992#0;
     #995#1 = #992#1;
     #995#2 = #992#2;
     |LEE 040#995=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     || Tipo 10;
     nImporte = #995#76;
     nDEjer   = 2010;
     nHEjer   = 2013;
     nAnyo    = 0;
     nTipo    = 10;
     |HAZ PonOtras;

     || Al a쨚 que viene uno mas en el desde / hasta a쨚

     || Tipo 0;
     nImporte = #995#40 + #995#42;
     nDEjer   = 2010;  || Al a쨚 que viene uno mas
     nHEjer   = 2013;
     nAnyo    = 0;
     nTipo    = 0;
     |HAZ PonOtras;

     || Tipo 11;
     nImporte = #995#47;
     nDEjer   = 2010;
     nHEjer   = 2013;
     nAnyo    = 0;
     nTipo    = 11;
     |HAZ PonOtras;

     || Tipo 2;
     nImporte = #995#111;
     nDEjer   = 2010;
     nHEjer   = 2013;
     nAnyo    = 0;
     nTipo    = 2;
     |HAZ PonOtras;

     nImporte = #995#34 - #995#43;
     |SI nImporte > 0;
         aContri = #992#2;
         |SI #992#2 = "CONJUNTA  ";  aContri = "GANANCIAL ";   |FINSI;
         |SI #992#2 = "CONJUNTAE ";  aContri = "TITULAR   ";  |FINSI;

         nTipo    = 0;
         nImporte = #995#34 - #995#43;
         |HAZ BuscaSiEsta;

         |SI nGrabo = 1;
             #1001#0  = #992#0;
             #1001#1  = 99;
             |LEE 000#1001];
             |SI FSalida = 0;
                 |LEE 000#1001a;
             |SINO;
                 |LEE 000#1001u;
             |FINSI;

             nLinea = 1;
             |SI FSalida = 0;  |Y #1001#0 = #992#0;
                 nLinea = #1001#1 + 1;
             |FINSI;

             |DDEFECTO #1001;
             #1001#0  = #992#0;
             #1001#1  = nLinea;
             #1001#2  = aContri;
             #1001#11 = "423";
             #1001#12 = "PASADO A짵 ANTERIOR CASILLA 367";
             |SI aContri = "GANANCIAL ";
                 #1001#12 = "A짵 ANTERIOR CASILLA 367 DE LA CONJUNTA";
             |FINSI;
             #1001#13 = 2013;
             #1001#14 = nImporte;
                               #1001#3 = "X";
             |SI #0#37 = "N";  #1001#3 = "R";  |FINSI;

                                  #1001#16 = "";
             |SI #1001#3  = "X";  #1001#16 = eaRojo;        |FINSI;

             |GRABA 020#1001n;
             |LIBERA #1001;

             eaPrograma = "rem00056";
             eaPunto    = "";
             |HAZ ProgramaActivo;
         |FINSI;
     |FINSI;

     |SI #995#48 > 0;
         aContri = #992#2;
         |SI #992#2 = "CONJUNTA  ";  aContri = "GANANCIAL ";  |FINSI;
         |SI #992#2 = "CONJUNTAE ";  aContri = "TITULAR   ";  |FINSI;

         nImporte = #995#48;
         nTipo    = 2;
         |HAZ BuscaSiEsta;

         |SI nGrabo = 1;
             #1001#0  = #992#0;
             #1001#1  = 99;
             |LEE 000#1001];
             |SI FSalida = 0;
                 |LEE 000#1001a;
             |SINO;
                 |LEE 000#1001u;
             |FINSI;

             nLinea = 1;
             |SI FSalida = 0;  |Y #1001#0 = #992#0;
                 nLinea = #1001#1 + 1;
             |FINSI;


             |DDEFECTO #1001;
             #1001#0  = #992#0;
             #1001#1  = nLinea;
             #1001#2  = aContri;
             #1001#11 = "437";
             #1001#12 = "PASADO A짵 ANTERIOR CASILLA 370";
             |SI aContri = "GANANCIAL ";
                 #1001#12 = "A짵 ANTERIOR CASILLA 370 DE LA CONJUNTA";
             |FINSI;
             #1001#13 = 2013;
             #1001#14 = nImporte;
                               #1001#3 = "X";
             |SI #0#37 = "N";  #1001#3 = "R";  |FINSI;

                                  #1001#16 = "";
             |SI #1001#3  = "X";  #1001#16 = eaRojo;        |FINSI;

             |GRABA 020#1001n;
             |LIBERA #1001;

             eaPrograma = "rem00056";
             eaPunto    = "";
             |HAZ ProgramaActivo;
         |FINSI;
     |FINSI;

     |SI #995#38 > 0;
         aContri = #992#2;
         |SI #992#2 = "CONJUNTA  ";  aContri = "GANANCIAL ";  |FINSI;
         |SI #992#2 = "CONJUNTAE ";  aContri = "TITULAR   ";  |FINSI;

         nImporte = #995#38;
         nTipo    = 11;
         |HAZ BuscaSiEsta;

         |SI nGrabo = 1;
             #1001#0  = #995#0;
             #1001#1  = 99;
             |LEE 000#1001];
             |SI FSalida = 0;
                 |LEE 000#1001a;
             |SINO;
                 |LEE 000#1001u;
             |FINSI;

             nLinea = 1;
             |SI FSalida = 0;  |Y #1001#0 = #995#0;
                 nLinea = #1001#1 + 1;
             |FINSI;

             |DDEFECTO #1001;
             #1001#0  = #995#0;
             #1001#1  = nLinea;
             #1001#2  = aContri;
             #1001#11 = "432";
             #1001#12 = "PASADO A짵 ANTERIOR CASILLA 360";
             |SI aContri = "GANANCIAL ";
                 #1001#12 = "A짵 ANTERIOR CASILLA 360 DE LA CONJUNTA";
             |FINSI;
             #1001#13 = 2013;
             #1001#14 = nImporte;
                               #1001#3 = "X";
             |SI #0#37 = "N";  #1001#3 = "R";  |FINSI;

                                  #1001#16 = "";
             |SI #1001#3  = "X";  #1001#16 = eaRojo;        |FINSI;

             |GRABA 020#1001n;
             |LIBERA #1001;

             eaPrograma = "rem00056";
             eaPunto    = "";
             |HAZ ProgramaActivo;
         |FINSI;
     |FINSI;

     |SI #995#44 < 0;  #995#75 = #995#44;  |FINSI;

     |SI #995#75 < 0;
         aContri = #992#2;
         |SI #992#2 = "CONJUNTA  ";  aContri = "GANANCIAL ";  |FINSI;
         |SI #992#2 = "CONJUNTAE ";  aContri = "TITULAR   ";  |FINSI;

         nImporte = -#995#75;
         nTipo    = 10;
         |HAZ BuscaSiEsta;

         |SI nGrabo = 1;
             #1001#0  = #992#0;
             #1001#1  = 99;
             |LEE 000#1001];
             |SI FSalida = 0;
                 |LEE 000#1001a;
             |SINO;
                 |LEE 000#1001u;
             |FINSI;

             nLinea = 1;
             |SI FSalida = 0;  |Y #1001#0 = #992#0;
                 nLinea = #1001#1 + 1;
             |FINSI;

             |DDEFECTO #1001;
             #1001#0  = #992#0;
             #1001#1  = nLinea;
             #1001#2  = aContri;
             #1001#11 = "489";
             #1001#12 = "PASADO A짵 ANTERIOR CASILLA 411";
             |SI aContri = "GANANCIAL ";
                 #1001#12 = "A짵 ANTERIOR CASILLA 411 DE LA CONJUNTA";
             |FINSI;
             #1001#13 = 2013;
             #1001#14 = nImporte;
                               #1001#3 = "X";
             |SI #0#37 = "N";  #1001#3 = "R";  |FINSI;

                                  #1001#16 = "";
             |SI #1001#3  = "X";  #1001#16 = eaRojo;        |FINSI;

             |GRABA 020#1001n;
             |LIBERA #1001;

             eaPrograma = "rem00056";
             eaPunto    = "";
             |HAZ ProgramaActivo;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO BuscaPension;
     |SI #1001#2 ! aContri;  |ACABA;  |FINSI;

     |SI nTipo = 1;
         |SI #1001#12 = "S";  |ACABA;  |FINSI;
         |SI #1001#23 = "S";  |ACABA;  |FINSI;
         |SI #1001#29 = "S";  |ACABA;  |FINSI;
     |FINSI;

     |SI nTipo = 2;
         |SI #1001#12 ! "S";  |ACABA;  |FINSI;
     |FINSI;

     |SI nTipo = 3;
         |SI #1001#23 ! "S";  |ACABA;  |FINSI;
     |FINSI;

     |SI nTipo = 4;
         |SI #1001#12 = "S";  |ACABA;  |FINSI;
         |SI #1001#23 = "S";  |ACABA;  |FINSI;
         |SI #1001#29 ! "S";  |ACABA;  |FINSI;
     |FINSI;

     |SI nTipo ! 2;
         #1001#27 = nImporte;
     |SINO;
         #1001#26 = nImporte;
     |FINSI;

     |GRABA 020#1001a;
     |LIBERA #1001;
     |ERROR10;
|FPRC;

|DEFBUCLE rem00053_2014;
     #1001#1002;
     ;
     #993#0, 01;
     #993#0, 99;
     be;
     NULL, BuscaPension;
|FIN;

|PROCESO GrabaPension;
     |BUCLE rem00053_2014;
|FPRC;

|PROCESO BuscaDiscapacidad;
     |SI #1002#2 ! aContri;  |ACABA;  |FINSI;

     #1002#13 = nImporte;
     |GRABA 020#1002a;
     |LIBERA #1002;
     |ERROR10;
|FPRC;

|DEFBUCLE rem00061_2014;
     #1002#1002;
     ;
     #993#0, 01;
     #993#0, 99;
     be;
     NULL, BuscaDiscapacidad;
|FIN;

|PROCESO GrabaDiscapacidad;
     |BUCLE rem00061_2014;
|FPRC;

|PROCESO ExcesoPens;
     #993#0 = #992#0;
     #993#1 = #992#1;
     #993#2 = #992#2;
     |LEE 040#993=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #992#2 = "CONJUNTA  ";  |O #992#2 = "CONJUNTAE ";
         nImporte = #993#83;
         |SI nImporte > 0;
              nTipo   = 1;
              aContri = #993#82;
              |HAZ GrabaPension;
         |FINSI;

         nImporte = #993#85;
         |SI nImporte > 0;
              nTipo   = 1;
              aContri = #993#84;
              |HAZ GrabaPension;
         |FINSI;

         nImporte = #993#133;
         |SI nImporte > 0;
              nTipo   = 4;
              aContri = #993#82;
              |HAZ GrabaPension;
         |FINSI;

         nImporte = #993#134;
         |SI nImporte > 0;
              nTipo   = 4;
              aContri = #993#84;
              |HAZ GrabaPension;
         |FINSI;

         nImporte = #993#87;
         |SI nImporte > 0;
             nTipo   = 2;
             aContri = #993#86;
             |HAZ GrabaPension;
         |FINSI;

         nImporte = #993#89;
         |SI nImporte > 0;
             nTipo   = 2;
             aContri = #993#88;
             |HAZ GrabaPension;
         |FINSI;

         nImporte = #993#91;
         |SI nImporte > 0;
             aContri = #993#90;
             |HAZ GrabaDiscapacidad;
         |FINSI;

         nImporte = #993#93;
         |SI nImporte > 0;
             aContri = #993#92;
             |HAZ GrabaDiscapacidad;
         |FINSI;

         nImporte = #993#95;
         |SI nImporte > 0;
             nTipo   = 3;
             aContri = #993#94;
             |HAZ GrabaPension;
         |FINSI;

         nImporte = #993#97;
         |SI nImporte > 0;
             nTipo   = 3;
             aContri = #993#96;
             |HAZ GrabaPension;
         |FINSI;
     |SINO;
         nImporte = #993#83;
         |SI nImporte > 0;
             nTipo   = 1;
             aContri = #993#2;
             |HAZ GrabaPension;
         |FINSI;

         nImporte = #993#133;
         |SI nImporte > 0;
              nTipo   = 4;
              aContri = #993#2;
              |HAZ GrabaPension;
         |FINSI;

         nImporte = #993#87;
         |SI nImporte > 0;
             nTipo   = 2;
             aContri = #993#2;
             |HAZ GrabaPension;
         |FINSI;

         nImporte = #993#91;
         |SI nImporte > 0;
              aContri = #993#2;
              |HAZ GrabaDiscapacidad;
         |FINSI;

         nImporte = #993#95;
         |SI nImporte > 0;
             nTipo   = 3;
             aContri = #993#2;
             |HAZ GrabaPension;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO GrabaDobleImpo;
     |SI nDobleImpo [ 0;  |ACABA;  |FINSI;

                                 aContri = #993#2;
     |SI #993#2 = "CONJUNTA  ";  aContri = "TITULAR   ";  |FINSI;
     |SI #993#2 = "CONJUNTAE ";  aContri = "TITULAR   ";  |FINSI;

     #1002#0  = #993#0;
     #1002#1  = 99;
     |LEE 000#1002];
     |SI FSalida = 0;
         |LEE 000#1002a;
     |SINO;
         |LEE 000#1002u;
     |FINSI;

     nLinea = 1;
     |SI FSalida = 0;  |Y #1002#0 = #993#0;
         nLinea = #1002#1 + 1;
     |FINSI;

     |DDEFECTO #1002;
     #1002#0  = #993#0;
     #1002#1  = nLinea;
     #1002#2  = aContri;
     #1002#11 = 24;
     #1002#12 = "CASILLA 733";
     #1002#13 = nAnyo;
     #1002#14 = nDobleImpo;

                       #1002#3 = "X";
     |SI #0#37 = "N";  #1002#3 = #993#3;  |FINSI;

     |GRABA 020#1002n;
     |LIBERA #1002;
|FPRC;

|PROCESO MiraDI;
     |SI nImporte = 0;  |ERROR10;  |ACABA;  |FINSI;

     |SI #994#2 = "TITULAR   ";
         |SI #995#2 = "CONYUGE   ";  |ACABA;  |FINSI;
         |SI #995#2 = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #995#2 = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #995#2 = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #995#2 = "4 FAMILIAR";  |ACABA;  |FINSI;
     |FINSI;

     |SI #994#2 = "CONYUGE   ";
         |SI #995#2 = "TITULAR   ";  |ACABA;  |FINSI;
         |SI #995#2 = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #995#2 = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #995#2 = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #995#2 = "4 FAMILIAR";  |ACABA;  |FINSI;
         |SI #995#2 = "GANANCIAL ";  |ACABA;  |FINSI;
         |SI #995#2 = "VARIOS    ";  |ACABA;  |FINSI;
     |FINSI;

     |SI #994#2 = "1 FAMILIAR";
         |SI #995#2 ! #994#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #994#2 = "2 FAMILIAR";
         |SI #995#2 ! #994#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #994#2 = "3 FAMILIAR";
         |SI #995#2 ! #994#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #994#2 = "4 FAMILIAR";
         |SI #995#2 ! #994#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #995#14 [ nImporte;
         nDobleImpo = #995#14;

         nImporte = nImporte - #995#14;
     |SINO;
         nDobleImpo = nImporte;
         nImporte   = 0;
     |FINSI;

     nAnyo      = #995#13;
     |HAZ GrabaDobleImpo;
|FPRC;

|DEFBUCLE rem00056_2013DI;
     #995#1002;
     11, 13;
     #993#0, 01, 24, nDEjer;
     #993#0, 99, 24, nHEjer;
     ;
     NULL, MiraDI;
|FIN;

|PROCESO DobleImposicion;
     #993#0 = #994#0;
     #993#1 = #994#1;
     #993#2 = #994#2;
     |LEE 040#993=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nDobleImpo = #993#74;
     |SI nDobleImpo ! 0;
         aDef = #0#0 + "/def/rem00056.mas";  |QBT aDef;
         |CARGA_DEF aDef, aficante5@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def rem00056 A쨚 2013 ";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |PATH_DAT #995 aFich;

         nImporte = nDobleImpo;
         nDEjer   = 2006;
         nHEjer   = 2006;
         |BUCLE rem00056_2013DI;

         |DESCARGA_DEF #aficante5@;
     |FINSI;
|FPRC;

|PROCESO GrabaREM00048;
     |SI nImpGraba [ 0;  |ACABA;  |FINSI;

                                 aContri = #993#2;
     |SI #993#2 = "CONJUNTA  ";  aContri = "GANANCIAL ";  |FINSI;
     |SI #993#2 = "CONJUNTAE ";  aContri = "TITULAR   ";  |FINSI;

     #1001#0  = #993#0;
     #1001#1  = 99;
     |LEE 000#1001];
     |SI FSalida = 0;
         |LEE 000#1001a;
     |SINO;
         |LEE 000#1001u;
     |FINSI;

     nLinea = 1;
     |SI FSalida = 0;  |Y #1001#0 = #993#0;
         nLinea = #1001#1 + 1;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0  = #993#0;
     #1001#1  = nLinea;
     #1001#2  = aContri;
     aAlfa    = #992#11;  |QBF aAlfa;
     aAlfa    = aAlfa + " DEL 2013";
     #1001#11 = aAlfa;
     #1001#12 = nImpGraba;
     #1001#13 = nPorce;
     #1001#14 = (N\ #1001#12 % nPorce);
     #1001#15 = #992#15;
     #1001#16 = #992#16;
     #1001#18 = #992#18;
     #1001#19 = #992#19;
     #1001#20 = #992#20;
     #1001#21 = #992#21;

                       #1001#3 = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;

                          #1001#17 = "";
     |SI #1001#3  = "X";  #1001#17 = eaRojo;  |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;
|FPRC;

|PROCESO rem00048_2013;
     |SI nImporte = 0;  |ERROR10;  |ACABA;  |FINSI;

     |SI nAntes = 1;
         |SI #992#18 < "07.05.2011";  |ACABA;  |FINSI;
         |SI #992#18 > "31.12.2011";  |ACABA;  |FINSI;
     |FINSI;

     |SI nAntes = 2;
         |SI #992#18 < "01.01.2012";  |ACABA;  |FINSI;
         |SI #992#18 > "31.12.2012";  |ACABA;  |FINSI;
     |FINSI;

     |SI nAntes = 3;
         |SI #992#18 < "14.04.2010";  |ACABA;  |FINSI;
         |SI #992#18 > "31.12.2010";  |ACABA;  |FINSI;
     |FINSI;

     |SI nAntes = 4;
         |SI #992#18 < "01.01.2011";  |ACABA;  |FINSI;
         |SI #992#18 > "06.05.2011";  |ACABA;  |FINSI;
     |FINSI;

     |SI #994#2 = "TITULAR   ";
         |SI #992#2 = "CONYUGE   ";  |ACABA;  |FINSI;
         |SI #992#2 = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #992#2 = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #992#2 = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #992#2 = "4 FAMILIAR";  |ACABA;  |FINSI;
     |FINSI;

     |SI #994#2 = "CONYUGE   ";
         |SI #992#2 = "TITULAR   ";  |ACABA;  |FINSI;
         |SI #992#2 = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #992#2 = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #992#2 = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #992#2 = "4 FAMILIAR";  |ACABA;  |FINSI;
         |SI #992#2 = "GANANCIAL ";  |ACABA;  |FINSI;
         |SI #992#2 = "VARIOS    ";  |ACABA;  |FINSI;
     |FINSI;

     |SI #994#2 = "1 FAMILIAR";
         |SI #992#2 ! #994#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #994#2 = "2 FAMILIAR";
         |SI #992#2 ! #994#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #994#2 = "3 FAMILIAR";
         |SI #992#2 ! #994#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #994#2 = "4 FAMILIAR";
         |SI #992#2 ! #994#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #992#12 [ nImporte;
         nImpGraba = #992#12;

         nImporte  = nImporte - #992#12;
     |SINO;
         nImpGraba  = nImporte;
         nImporte   = 0;
     |FINSI;

     |HAZ GrabaREM00048;
|FPRC;

|DEFBUCLE rem00048_2013;
     #992#1002;
     16;
     #993#0, 01, 2;
     #993#0, 99, 2;
     ;
     NULL, rem00048_2013;
|FIN;

|PROCESO ViviendaHabitual;
     #993#0 = #994#0;
     #993#1 = #994#1;
     #993#2 = #994#2;
     |LEE 040#993=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nImporte = (#993#66 - #993#67);
     |SI nImporte > 0;
         nPorce   = 20;

         nAntes   = 1;  |BUCLE rem00048_2013;
     |FINSI;

     nImporte = (#993#69 - #993#70);
     |SI nImporte > 0;
         nPorce   = 20;

         nAntes   = 2;  |BUCLE rem00048_2013;
     |FINSI;

     nImporte = #993#73 + #993#74;
     |SI nImporte > 0;
         nPorce   = 10;

         nAntes   = 3;  |BUCLE rem00048_2013;
     |FINSI;

     nImporte = #993#76 + #993#77;
     |SI nImporte > 0;
         nPorce   = 10;

         nAntes   = 4;  |BUCLE rem00048_2013;
     |FINSI;
|FPRC;

|PROCESO MiraLiquidacion;
     |SI nQueHago = 1;  |HAZ InvEmpresariales;  |FINSI;
     |SI nQueHago = 2;  |HAZ OtrasDeducciones;  |FINSI;
     |SI nQueHago = 3;  |HAZ ExcesoPens;        |FINSI;
     |SI nQueHago = 4;  |HAZ DobleImposicion;   |FINSI;
     |SI nQueHago = 5;  |HAZ ViviendaHabitual;  |FINSI;
|FPRC;

|DEFBUCLE rem01001_2013;
     #992#1003;
     5;
     #991#0, 00, "          ", "100";
     #991#0, 99, "zzzzzzzzzz", "101";
     ;
     NULL, MiraLiquidacion;
|FIN;

|DEFBUCLE rem01001_2013_2;
     #994#1003;
     5;
     #991#0, 00, "          ", "100";
     #991#0, 99, "zzzzzzzzzz", "101";
     ;
     NULL, MiraLiquidacion;
|FIN;

|PROCESO Mobiliario1;
     aDef = #0#0 + "/def/rem00022.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00022 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem01041.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01041 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem01001.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01001 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00022.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00022 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00056.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00056 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;
     |PATH_DAT #993 aFich;
     |PATH_DAT #994 aFich;

     nQueHago   = 4;
     nDobleImpo = 0;
     |ABRE #1002;
     |ABRE #993;
     |BUCLE rem01001_2013_2;
     |CIERRA #993;
     |CIERRA #1002;

     |ABRE #1001;
     |BUCLE rem00022_2013;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor2@;
     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante4@;
     |DESCARGA_DEF #aficante3@;
     |DESCARGA_DEF #aficante2@;

     aDef = #0#0 + "/def/rem00043.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00043 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00043.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00043 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00043C_2013;
     |CIERRA #1001;

     |BUCLE rem00043V_2013;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Deducciones;
     aDef = #0#0 + "/def/rem01001.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01001 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem01042.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01042 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem00045.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00045 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00045.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00045 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;
     |PATH_DAT #993 aFich;
     |PATH_DAT #994 aFich;

     nQueHago = 1;

     |ABRE #993;
     |ABRE #1001;
     |BUCLE rem01001_2013;
     |CIERRA #993;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante4@;
     |DESCARGA_DEF #aficante3@;
     |DESCARGA_DEF #aficante2@;

     aDef = #0#0 + "/def/rem00048.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00048 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem01041.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01041 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem01001.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01001 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00048.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00048 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;
     |PATH_DAT #993 aFich;
     |PATH_DAT #994 aFich;

     nQueHago   = 5;
     |ABRE #993;
     |ABRE #1001;
     |BUCLE rem01001_2013_2;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante4@;
     |DESCARGA_DEF #aficante3@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO BasesNegativas;
     aDef = #0#0 + "/def/rem01001.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01001 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem00056.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00056 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem01033.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante5@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01033 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00056.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00056 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;
     |PATH_DAT #994 aFich;
     |PATH_DAT #995 aFich;

     nQueHago = 2;

     |ABRE #995;
     |ABRE #1001;
     |BUCLE rem01001_2013;
     |CIERRA #995;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante5@;
     |DESCARGA_DEF #aficante4@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO ExcesoPensiones;
     aDef = #0#0 + "/def/rem01001.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01001 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem01033.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01033 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem00053.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00053 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem00061.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante5@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00061 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00053.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00053 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00061.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00061 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;
     |PATH_DAT #993 aFich;
     |PATH_DAT #994 aFich;
     |PATH_DAT #995 aFich;

     nQueHago = 3;

     |ABRE #993;
     |BUCLE rem01001_2013;
     |CIERRA #993;

     |DESCARGA_DEF #aficahor2@;
     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante5@;
     |DESCARGA_DEF #aficante4@;
     |DESCARGA_DEF #aficante3@;
     |DESCARGA_DEF #aficante2@;
|FPRC;


|PROCESO Pasa090;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     #1001#2 = #992#2;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;

     |PARA nCampoPase = 0;  |SI nCampoPase [ 23;  |HACIENDO nCampoPase = nCampoPase + 1;
           #1001nCampoPase = #992nCampoPase;
     |SIGUE;

     |SI #0#34 = "N";
         #1001#10 = 0;
         #1001#14 = 0;
         #1001#23 = 0;
         #1001#24 = 0;
     |FINSI;

     |SI #1001#1 = "V0";
         #1001#10 = 0;
         #1001#14 = 0;
         #1001#23 = 0;
         #1001#24 = 0;
     |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00099";
     eaLetra    = #1001#1;
     eaPunto    = #1001#1;
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00099_2013;
     #992#1003;
     4, 5;
     #991#0, "  ", 001, "  ", 00;
     #991#0, "zz", 999, "  ", 00;
     ;
     NULL, Pasa090;
|FIN;

|PROCESO Patrimonio;
     aDef = #0#0 + "/def/rem00099.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00099 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00099.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00099 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00099_2013;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO El42T;
     |ABRE #42;
     |SELECT #1#42;
     #42#0 = #992#0;
     #42#1 = 99;
     |LEE 040#42];
     |SI FSalida = 0;
         |LEE 040#42a;
     |SINO;
         |LEE 040#42u;
     |FINSI;

     |SI FSalida = 0; |Y #42#0 = #992#0;
         nLinea = #42#1 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     #42#0   = #992#0;
     #42#1   = nLinea;
     #42#2   = #992#2;
                       #42#3   = "X";
     |SI #0#37 = "N";  #42#3 = #992#3;  |FINSI;
     |SI #42#3 = "A";  #42#3 = "R";     |FINSI;

     #42#4   = 0;
     #42#5   = #992#5;
     #42#6   = #992#6;
     #42#7   = #992#7;
     #42#8   = #992#8;
     #42#9   = #992#9;
     #42#10  = #992#10;
     #42#11  = #992#11;
     #42#12  = #992#12;
     #42#14  = #992#14;
     #42#15  = #992#15;
     #42#16  = #992#16;
     #42#17  = #992#17;
     #42#18  = #992#18 - #992#13;
     #42#19  = #992#19 + #992#20;
     #42#20  = 0;
     #42#13  = 0;
     #42#21  = 1;
     #42#22  = "T";

                        #42#23 = "";
     |SI #42#3  = "X";  #42#23 = eaRojo;        |FINSI;

     |GRABA 020#42n;
     |LIBERA #42;

     eaPrograma = "rem00042";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO El42Pdtes;
     |ABRE #42;
     |SELECT #1#42;
     #42#0 = #992#0;
     #42#1 = 99;
     |LEE 040#42];
     |SI FSalida = 0;
         |LEE 040#42a;
     |SINO;
         |LEE 040#42u;
     |FINSI;

     |SI FSalida = 0; |Y #42#0 = #992#0;
         nLinea = #42#1 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     #42#0   = #992#0;
     #42#1   = nLinea;
     #42#2   = #992#2;
                       #42#3   = "X";
     |SI #0#37 = "N";  #42#3 = #992#3;  |FINSI;
     |SI #42#3 = "A";  #42#3 = "R";     |FINSI;

     #42#4   = 0;
     #42#5   = #992#5;
     #42#6   = #992#6;
     #42#7   = #992#7;
     #42#8   = #992#8;
     #42#9   = #992#9;
     #42#10  = #992#10;
     #42#14  = "01.01.0000";
     #42#15  = "PENDIENTE EJERCICIO 2013";
     #42#16  = 0;
     #42#17  = 0;
     #42#18  = nPendiente;
     #42#19  = 0;
     #42#20  = 0;
     #42#13  = 0;
     #42#21  = 1;
     #42#22  = "M";

                        #42#23 = "";
     |SI #42#3  = "X";  #42#23 = eaRojo;        |FINSI;

     |GRABA 020#42n;
     |LIBERA #42;

     eaPrograma = "rem00042";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO Pasa041;
     |SI #992#34 = "C1";  |O #992#34 = "B1";
         |ACABA;
     |FINSI;

     nPendiente = #992#28 - #992#29;
     |SI nPendiente ! 0;
         |HAZ El42Pdtes;
         |ACABA;
     |FINSI;

     nPendiente = #992#31 - #992#33;
     |SI nPendiente ! 0;
         |HAZ El42Pdtes;
     |FINSI;
|FPRC;

|DEFBUCLE rem00041_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa041;
|FIN;

|PROCESO Pasa042;
     |SI #992#22 = "T";
         nPendiente = #992#16 - (#992#19 + #992#20);
         |SI nPendiente > 0;  |HAZ El42T;  |FINSI;
     |SINO;
         nPendiente = #992#18 - #992#13;
         |SI nPendiente > 0;  |HAZ El42Pdtes;  |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE rem00042_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa042;
|FIN;

|PROCESO Incrementos;
     aDef = #0#0 + "/def/rem00041.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00041 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |BUCLE rem00041_2013;

     |DESCARGA_DEF #aficante2@;

     aDef = #0#0 + "/def/rem00042.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00042 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |BUCLE rem00042_2013;

     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa030;
     nPaso = 0;
     |SI #992#15 ] 2014;  |Y #992#16 ! 0;  nPaso = 1;  |FINSI;
     |SI #992#17 ] 2014;  |Y #992#18 ! 0;  nPaso = 1;  |FINSI;
     |SI #992#19 ] 2014;  |Y #992#20 ! 0;  nPaso = 1;  |FINSI;
     |SI #992#21 ] 2014;  |Y #992#22 ! 0;  nPaso = 1;  |FINSI;

     |SI nPaso = 0;  |ACABA;  |FINSI;

     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;

     |SI #992#15 ] 2014;
          #1001#15 = #992#15;
          #1001#16 = #992#16;
     |FINSI;

     |SI #992#17 ] 2014;
         |SI #1001#15 = 0;
             #1001#15 = #992#17;
             #1001#16 = #992#18;
         |SINO;
             #1001#17 = #992#17;
             #1001#18 = #992#18;
         |FINSI;
     |FINSI;

     |SI #992#19 ] 2014;
         |SI #1001#15 = 0;
             #1001#15 = #992#19;
             #1001#16 = #992#20;
         |SINO;
             |SI #1001#17 = 0;
                 #1001#17 = #992#19;
                 #1001#18 = #992#20;
             |SINO;
                 #1001#19 = #992#19;
                 #1001#20 = #992#20;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #992#21 ] 2014;
         |SI #1001#15 = 0;
             #1001#15 = #992#21;
             #1001#16 = #992#22;
         |SINO;
             |SI #1001#17 = 0;
                 #1001#17 = #992#21;
                 #1001#18 = #992#22;
             |SINO;
                 |SI #1001#19 = 0;
                     #1001#19 = #992#21;
                     #1001#20 = #992#22;
                 |SINO;
                     #1001#21 = #992#21;
                     #1001#22 = #992#22;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1001#15 = 2014;  #1001#11 = #1001#16;  |FINSI;
     |SI #1001#17 = 2014;  #1001#11 = #1001#18;  |FINSI;
     |SI #1001#19 = 2014;  #1001#11 = #1001#20;  |FINSI;
     |SI #1001#21 = 2014;  #1001#11 = #1001#22;  |FINSI;

                          #1001#24 = "";
     |SI #1001#3  = "X";  #1001#24 = eaRojo;        |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;
|FPRC;

|DEFBUCLE rem00030_2013;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa030;
|FIN;

|PROCESO Subvenciones;
     aDef = #0#0 + "/def/rem00030.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00030 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2014 + "/def/rem00030.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00030 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00030_2013;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;

     eaPrograma = "rem00030";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO rem00042B;
     |BORRA 020#42a;
     |LIBERA #42;
|FPRC;

|DEFBUCLE rem00042B;
     #42#1;
     21;
     enEmpresa, 01, 01;
     enEmpresa, 99, 99;
     be;
     NULL, rem00042B;
|FIN;

|PROCESO rem00056B;
     |BORRA 020#rem00056.a;
     |LIBERA #rem00056;
|FPRC;

|DEFBUCLE rem00056B;
     #rem00056#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     be;
     NULL, rem00056B;
|FIN;

|PROCESO rem00048B;
     |BORRA 020#rem00048.a;
     |LIBERA #rem00048;
|FPRC;

|DEFBUCLE rem00048B;
     #rem00048#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     be;
     NULL, rem00048B;
|FIN;

|PROCESO Anotaciones;
     aDef = #0#0 + "/def/rem01005.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01005 A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #992;
     #992#0 = #991#0;
     |LEE 000#992=;
     |SI FSalida ! 0;
         |CIERRA #992;
         |DESCARGA_DEF #aficante2@;
         |ACABA;
     |FINSI;
     |CIERRA #992;

     aDef = aBaseRenta2014 + "/def/rem01005.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01005 A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |ABRE #1001;
     #1001#0 = #991#0;
     |LEE 101#1001=;
     |SI FSalida ! 0;
         |DDEFECTO #1001;
         #1001#0 = #991#0;
         |GRABA 020#1001b;
     |FINSI;

     #1001#1 = "ANOTACIONES PASADAS DESDE LA RENTA 2013";
     |PARA nCampo1 = 1;  |SI nCampo1 [ 99;  |HACIENDO nCampo1 = nCampo1 + 1;
           nCampo2      = nCampo1 + 1;
           #1001nCampo2 = #992nCampo1;
     |SIGUE;

     |GRABA 020#1001a;
     |LIBERA #1001;

     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa2014;
     |SI #991#19 = "S";   |ACABA;  |FINSI;

     |SI #0#42 = "C";
         |SI #991#12 ! "*";  |ACABA;  |FINSI;
     |FINSI;

     enEmpresa = #991#0;

     aDef = aBaseRenta2014 + "/def/reacceso.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def reacceso  A쨚 2014 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aAlfa1 = #991#1;  |QBF aAlfa1;
     aAlfa  = "     Recogiendo Contribuyente [" + (("00000" + #991#0) % -105) + " " + aAlfa1 + "]";

     |ABRE #1001;
     #1001#0 = #991#0;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |SI enCodCli = 0;
             |SI #0#41 = "S";
                 aAlfa  = "0000NYa existe Contribuyente [" + (("00000" + #991#0) % -105) + " " + aAlfa1 + "] Desea pasar los datos de nuevo : ";
                 |CONFI aAlfa;
             |SINO;
                 |SI #1001#12 = "*";
                     FSalida = 1;
                 |FINSI;
             |FINSI;

             |SI FSalida ! 0;
                 |LIBERA #1001;
                 |CIERRA #1001;
                 |DESCARGA_DEF #aficahor1@;
                 |ACABA;
             |FINSI;
         |FINSI;

         |SI #1001#2 ! #991#2;  |Y #1001#2 ! "            ";
             |SI enCodCli ! 0;
                 |MENAV "0000El NIF del contribuyente del ejercicio anterior no coincide con el actual. Revise el dato";
             |SINO;
                 nMensaDupli = 1;
             |FINSI;

             |LIBERA #1001;
             |CIERRA #1001;
             |DESCARGA_DEF #aficahor1@;
             |ACABA;
         |FINSI;

         #1001#0 = #991#0;
         #1001#1 = #991#1;
         #1001#2 = #991#2;
         |GRABA 020#1001a;
     |SINO;
         #1001#0 = #991#0;
         #1001#1 = #991#1;
         #1001#2 = #991#2;
         |GRABA 020#1001n;
     |FINSI;
     |LIBERA #1001;
     |CIERRA #1001;
     |DESCARGA_DEF #aficahor1@;

     aAlfa1 = #991#1;  |QBF aAlfa1;
     aAlfa  = "     Recogiendo Contribuyente [" + (("00000" + #991#0) % -105) + " " + aAlfa1 + "]";
     |MENSA aAlfa;

     |SI #0#39 = "S";
         |BUCLE rem00056B;
         |BUCLE rem00042B;
         |BUCLE rem00048B;
     |FINSI;

     |SI #0#38 = "S";  |HAZ DatosPersonales;  |FINSI;
     |SI #0#24 = "S";  |HAZ Trabajo;          |FINSI;
     |SI #0#25 = "S";  |HAZ Inmuebles;        |FINSI;
     |SI #0#26 = "S";  |HAZ Mobiliario1;      |FINSI;
     |SI #0#26 = "S";  |HAZ Mobiliario2;      |FINSI;
     |SI #0#26 = "S";  |HAZ Mobiliario3;      |FINSI;
     |SI #0#26 = "S";  |HAZ Mobiliario4;      |FINSI;
     |SI #0#26 = "S";  |HAZ Mobiliario6;      |FINSI;
     |SI #0#35 = "S";  |HAZ Actividad1;       |FINSI;
     |SI #0#35 = "S";  |HAZ Actividad2;       |FINSI;
     |SI #0#35 = "S";  |HAZ Actividad3;       |FINSI;
     |SI #0#35 = "S";  |HAZ Actividad4;       |FINSI;
     |SI #0#35 = "S";  |HAZ AtribRenta;       |FINSI;
     |SI #0#36 = "S";  |HAZ Anualidades;      |FINSI;
     |SI #0#36 = "S";  |HAZ TFiscal;          |FINSI;
     |SI #0#36 = "S";  |HAZ Donativos;        |FINSI;
     |SI #0#27 = "S";  |HAZ Deducciones;      |FINSI;
     |SI #0#28 = "S";  |HAZ Patrimonio;       |FINSI;
     |SI #0#39 = "S";  |HAZ BasesNegativas;   |FINSI;
     |SI #0#39 = "S";  |HAZ Pensiones;        |FINSI;
     |SI #0#39 = "S";  |HAZ ExcesoPensiones;  |FINSI;
     |SI #0#39 = "S";  |HAZ Incrementos;      |FINSI;
     |SI #0#39 = "S";  |HAZ Subvenciones;     |FINSI;
     |SI #0#43 = "S";  |HAZ Anotaciones;      |FINSI;
|FPRC;

|DEFBUCLE reacceso_2013;
     #991#1001;
     ;
     #0#2;
     #0#3;
     ;
     NULL, Pasa2014;
|FIN;

|PROCESO ListadosDefinibles;
     aAlfa1 = aBaseRenta2014 + "fich/lis*.*";
     |_PDIR aAlfa1;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
             |FBORRA aAlfa1;

             |_SDIR aAlfa1;
     |SIGUE;

     aRaiz  =  #0#0 + "/" + #0#1 + "/";  |QBT aRaiz;
     aAlfa1 =  aRaiz + "lis*.*";
     |_PDIR aAlfa1;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
             aAlfa = aAlfa1 - aRaiz;
             aAlfa2 = aBaseRenta2014 + "fich/" + aAlfa;
             |COPIA_FICHERO aAlfa1, aAlfa2;

             |_SDIR aAlfa1;
     |SIGUE;

     |DFICE aAlfa;  |QBF aAlfa;
     aAlfa = aAlfa + "listados.dir";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida ] 0;  |ACABA;  |FINSI;

     |XABRE "WB", aAlfa, nHandle;

     aAlfa = "LOCK00" + &13 + &10;  |XGRABA nHandle, aAlfa;

     |XCIERRA nHandle;
|FPRC;

|PROCESO Tipo12;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     |CONFI "0000SDesea hacer la importaci줻 en estos momentos.";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     #0#41 = #0#41 > "";

     |DBASE aBaseRenta2014;  |QBT aBaseRenta2014;

     |SI #0#44 = "S";
         |HAZ ListadosDefinibles;
     |FINSI;

     |ABRE #401;
     |LEE 040#401p;
     nPatrones = FSalida;
     |CIERRA #401;

     |SI nPatrones ! 0;
         |DELINDEX #401;
         aAlfa = "*:ren2014/zacceso9;" + "00000PATRONES";
     |FINSI;

     aFichero = "repoblac";  |HAZ Auxiliares;
     aFichero = "reauxpai";  |HAZ Auxiliares;
     aFichero = "rerenpre";  |HAZ Auxiliares;
     aFichero = "reauxdiv";  |HAZ Auxiliares;
     aFichero = "reauxval";  |HAZ Auxiliares;
     aFichero = "rebancos";  |HAZ Auxiliares;

     aDef = #0#0 + "/def/reacceso.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def reacceso A쨚 2013 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aFich = #0#0 + "/" + #0#1 + "/";  |QBT aFich;
     |PATH_DAT #991 aFich;

     |SI #0#2 ! 0;
         |BUCLE reacceso_2013;
     |SINO;
         |PARA nCampo = 4;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo ! 0;
                   #0#2 = #0nCampo;
                   #0#3 = #0nCampo;
                   |BUCLE reacceso_2013;
               |FINSI;
         |SIGUE;
     |FINSI;

     |DESCARGA_DEF #aficante1@;
|FPRC;

|PROCESO CompruebaListados;
     aListados = "N";

     |DFICE aAlfa;  |QBF aAlfa;
     aAlfa = aAlfa + "listados.dir";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         aListados = "S";
     |FINSI;
|FPRC;

|PROGRAMA;
     |HAZ CargaColores;

     nMensaDupli = 0;

     |HAZ  CompruebaListados;

     |SI enCodCli ! 0;
         |PARA nCampo = 2;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
         |SIGUE;
         |C_M #0#41, 1, "N";
         |C_M #0#42, 1, "N";

         #0#2  = enCodCli;  |PINTA #0#2;
         #0#3  = enCodCli;  |PINTA #0#3;
         #0#41 = "n";
         #0#42 = "T";

         |PINPA #0#0;
         |PINDA #0#0;
         |ENDATOS #1#0;
     |SINO;
         |DDEFECTO #0;
         |PINPA #0#0;
         |PINDA #0#0;
         |ENDATOS #1#0;
     |FINSI;

     |SI nMensaDupli = 1;
         |MENAV "0000Han habido renta que no se han pasado.";
         |MENAV "0000Porque los contribuyente ya existian y los NIF eran diferentes";
     |FINSI;
|FPRO;

|PROCESO Tipo80;  |TIPO 80;
     FSalida = 3699;

     |SI enCodCli ! 0;
         FSalida = 3499;
     |FINSI;
|FPRC;
