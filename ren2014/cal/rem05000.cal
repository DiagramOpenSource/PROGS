|FICHEROS;
     rem05000;

     reacceso;
     rem00100;
     rem00101;
|FIN;

|VARIABLES;
     &Cadena     = "";
     &Cadena1    = "";
|FIN;

|INCLUYE m05000c9;

|| -----------------------------------------------------------------------

|PROCESO Salir;
     |PTEC 806;
|FPRC;

|PROCESO Tipo7;  |TIPO 7;
     |SI nBotonCancelar = 0;  |ACABA;  |FINSI;

     aQueBoton = "|X000";
     aID       = #rem05000#aQueBoton#;
     nBoton    = aID;
     |ESTADO_CONTROL nBoton, "HIDE";

     aQueBoton = "|X001";
     aID       = #rem05000#aQueBoton#;
     nBoton    = aID;
     |ESTADO_CONTROL nBoton, "HIDE";

     |CONTROL_SIMPLE 0, "BOTON,{{001}}Salir", 3585, 3594, Salir;
     |CONTROL_SIMPLE 0, "BOTON,{{197}}Configurar explorador web", 3502, 3525, BotonExplora;
|FPRC;

|| -----------------------------------------------------------------------

|PROCESO Consulta1;
     nCampo = 1;  |HAZ PaginaConsulta;
|FPRC;

|PROCESO Descarga1;
     nContri = 1;
     nCampo  = 1;
     |HAZ Descarga;
|FPRC;

|PROCESO Procesar1;
     nCampo  = 1;
     nContri = 1;
     aContri = "TITULAR";

     |HAZ Procesar;
|FPRC;

|PROCESO Consulta2;
     nCampo = 5;  |HAZ PaginaConsulta;
|FPRC;

|PROCESO Descarga2;
     nContri = 2;
     nCampo  = 5;
     |HAZ Descarga;
|FPRC;

|PROCESO Procesar2;
     nCampo  = 5;
     nContri = 2;
     aContri = "CONYUGE";

     |HAZ Procesar;
|FPRC;

|PROCESO Consulta3;
     nCampo = 9;  |HAZ PaginaConsulta;
|FPRC;

|PROCESO Descarga3;
     nContri = 3;
     nCampo  = 9;
     |HAZ Descarga;
|FPRC;

|PROCESO Procesar3;
     nCampo  = 9;
     nContri = 3;
     aContri = "1 FAMILIAR";

     |HAZ Procesar;
|FPRC;

|PROCESO Consulta4;
     nCampo = 13;  |HAZ PaginaConsulta;
|FPRC;

|PROCESO Descarga4;
     nContri = 4;
     nCampo  = 13;
     |HAZ Descarga;
|FPRC;

|PROCESO Procesar4;
     nCampo  = 13;
     nContri = 4;
     aContri = "2 FAMILIAR";

     |HAZ Procesar;
|FPRC;

|PROCESO Consulta5;
     nCampo = 17;  |HAZ PaginaConsulta;
|FPRC;

|PROCESO Descarga5;
     nContri = 5;
     nCampo  = 17;
     |HAZ Descarga;
|FPRC;

|PROCESO Procesar5;
     nCampo  = 17;
     nContri = 5;
     aContri = "3 FAMILIAR";

     |HAZ Procesar;
|FPRC;

|PROCESO Consulta6;
     nCampo = 21;  |HAZ PaginaConsulta;
|FPRC;

|PROCESO Descarga6;
     nContri = 6;
     nCampo  = 21;
     |HAZ Descarga;
|FPRC;

|PROCESO Procesar6;
     nCampo  = 21;
     nContri = 6;
     aContri = "4 FAMILIAR";

     |HAZ Procesar;
|FPRC;

|PROCESO  rem00101;
     nConta    = nConta + 1;
     |SI nConta > 4;  |ERROR10;  |ACABA;  |FINSI;

     Cadena   = #rem00101#3;   |HAZ SeparaNombre;

     nCampo   = nConta + (5 + (nConta * 3));
     #rem05000#nCampo# = #rem00101#2;

     nCampo   = nCampo + 1;
     #rem05000#nCampo# = Cadena1;
|FPRC;

|DEFBUCLE rem00101;
     #rem00101#1;
     13;
     #rem00100#0,  1, "S";
     #rem00100#0, 99, "S";
     ;
     NULL, rem00101;
|FIN;


|PROCESO CargaCampos;
     |ABRE #rem00100;
     #rem00100#0 = #rem05000#0;
     |LEE 000#rem00100.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00100;  |FINSI;
     |CIERRA #rem00100;

     #rem05000#1  = #rem00100#1;
     #rem05000#2  = #rem00100#2;

     #rem05000#5  = #rem00100#35;
     #rem05000#6  = #rem00100#36;

     #rem05000#10 = "";
     #rem05000#11 = "";
     #rem05000#14 = "";
     #rem05000#15 = "";
     #rem05000#18 = "";
     #rem05000#19 = "";
     #rem05000#22 = "";
     #rem05000#23 = "";

     nConta = 0;
     |BUCLE rem00101;

     |PARA nCampo = 2;  |SI nCampo [ 22;  |HACIENDO nCampo = nCampo + 4;
           nCampo1 = nCampo + 1;
           |C_M #rem05000#nCampo1#, 1, "S";

           aAlfa = #rem05000#nCampo#;  |QBF aAlfa;
           |SI aAlfa = "";
               |C_M #rem05000#nCampo1#, 1, "N";

               nCampo1   = nCampo + 2;
               #rem05000#nCampo1# = "No existe";
           |FINSI;
     |SIGUE;

     |HAZ EnciendeBotones;
|FPRC;

|PROCESO Tipo12;   |TIPO 12;
|FPRC;

|PROCESO LeeUnidadAEAT;
     eaUnidadBasico = "";

     |PARA nCaracter = 67;  |SI nCaracter [ 90;  |HACIENDO nCaracter = nCaracter + 1;
           aUnidadSistema = &nCaracter + ":";
           aAbre   = aUnidadSistema + "\AEAT\PRUEBA.TXT";
           |XABRE "WC", aAbre, nHandle;
           |SI FSalida ] 0;
               aAlfa = "Prueba correcta.";
               |XGRABA nHandle, aAlfa;
           |FINSI;
           |XCIERRA nHandle;

           |XABRE "EC", aAbre, nHandle;
           |SI FSalida ] 0;
               |RFBORRA aAbre;
               eaUnidadBasico = aUnidadSistema;
               |SAL;
           |FINSI;
     |SIGUE;

     |SI eaUnidadBasico = "";
         |HAZ LeeUnidadBasico;
     |FINSI;
|FPRC;

|PROGRAMA;
     |HAZ CargaColores;

     |VENTANA 0501, 3599, -1, 16, "Recogida datos fiscales";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     aAlfa    = PARAMETRO % 105;
     nEmpresa = aAlfa;
     aAlfa    = PARAMETRO % 601;
     nModo    = aAlfa;

     |HAZ LeeUnidadAEAT;
     aDirLocal = eaUnidadBasico + "\AEAT";   |RMKDIR  aDirLocal;
     aDirLocal = aDirLocal + "\Renta2014";   |RMKDIR  aDirLocal;
     aDirLocal = aDirLocal + "\";

     |DBASE aBase;
     aDirServidor = aBase + "web";  |MKDIR aDirServidor;
     aDirServidor = aDirServidor + "/";

     |ABRE #rem05000;
     #rem05000#0 = nEmpresa;
     |LEE 101#rem05000.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem05000;
         #rem05000#0 = nEmpresa;
         |GRABA 020#rem05000.b;
     |FINSI;

     |PINPA #0#rem05000;    nPanta = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Consulta en web", 1002, 1017, Consulta1;
     nBoton1_1 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{228}}Descarga", 1019, 1032, Descarga1;
     nBoton1_2 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Procesar", 1034, 1047, Procesar1;
     nBoton1_3 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Consulta en web", 1050, 1065, Consulta2;
     nBoton2_1 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{228}}Descargar", 1067, 1080, Descarga2;
     nBoton2_2 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Procesar", 1082, 1095, Procesar2;
     nBoton2_3 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Consulta en web", 1702, 1717, Consulta3;
     nBoton3_1 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{228}}Descarga", 1719, 1732, Descarga3;
     nBoton3_2 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Procesar", 1734, 1747, Procesar3;
     nBoton3_3 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Consulta en web", 1750, 1765, Consulta4;
     nBoton4_1 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{228}}Descargar", 1767, 1780, Descarga4;
     nBoton4_2 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Procesar", 1782, 1795, Procesar4;
     nBoton4_3 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Consulta en web", 2402, 2417, Consulta5;
     nBoton5_1 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{228}}Descarga", 2419, 2432, Descarga5;
     nBoton5_2 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Procesar", 2434, 2447, Procesar5;
     nBoton5_3 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Consulta en web", 2450, 2465, Consulta6;
     nBoton6_1 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{228}}Descargar", 2467, 2480, Descarga6;
     nBoton6_2 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Procesar", 2482, 2495, Procesar6;
     nBoton6_3 = FSalida;

     |ESTADO_CONTROL nBoton1_1, "DISABLE";
     |ESTADO_CONTROL nBoton1_2, "DISABLE";
     |ESTADO_CONTROL nBoton1_3, "DISABLE";

     |ESTADO_CONTROL nBoton2_1, "DISABLE";
     |ESTADO_CONTROL nBoton2_2, "DISABLE";
     |ESTADO_CONTROL nBoton2_3, "DISABLE";

     |ESTADO_CONTROL nBoton3_1, "DISABLE";
     |ESTADO_CONTROL nBoton3_2, "DISABLE";
     |ESTADO_CONTROL nBoton3_3, "DISABLE";

     |ESTADO_CONTROL nBoton4_1, "DISABLE";
     |ESTADO_CONTROL nBoton4_2, "DISABLE";
     |ESTADO_CONTROL nBoton4_3, "DISABLE";

     |ESTADO_CONTROL nBoton5_1, "DISABLE";
     |ESTADO_CONTROL nBoton5_2, "DISABLE";
     |ESTADO_CONTROL nBoton5_3, "DISABLE";

     |ESTADO_CONTROL nBoton6_1, "DISABLE";
     |ESTADO_CONTROL nBoton6_2, "DISABLE";
     |ESTADO_CONTROL nBoton6_3, "DISABLE";

     |HAZ CargaCampos;
     |PINDA #0#rem05000;

     |ENDATOS #1#rem05000;

     |GRABA 020#rem05000.a;
     |LIBERA #rem05000;
     |CIERRA #rem05000;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     |ABRE #rem00100;
     #rem00100#0 = #rem05000#0;
     |LEE 000#rem00100.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00100;  |FINSI;
     |CIERRA #rem00100;

     |ABRE #reacceso;
     #reacceso#0 = #rem05000#0;
     |LEE 000#reacceso.=;
     |SI FSalida ! 0;  |DDEFECTO #reacceso;  |FINSI;
     |CIERRA #reacceso;

     enEmpresa = #reacceso#0;
     eaNombre  = #reacceso#1;
     eaNif     = #reacceso#2;
     eaLetra   = "CO";
     enModo    = 1;
     |SUB_EJECUTA "rew00200";
|FPRO;
