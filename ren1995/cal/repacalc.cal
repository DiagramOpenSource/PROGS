|FICHEROS
   retotren #0;
   repacalc #1;
   redatcon #3;
   reparame #4;
   retotpat #6;
   reincide #7;
   repartid #8;
   reliquid #10;
   retotrea #11;
   reprogra #12;
|FIN;

|INCLUYE i_varcal;

|PROCESO sacaimpo;
  |ABRE #8;
  #8#0 = #1#0;
  |LEE 010#8=;
  |SI FSalida ! 0;
      |MENAV "      Error no Existe el Codigo Especificado";
      |CIERRA #8;
      |ERROR;
      |ACABA;
  |FINSI;
  tippar  = #8#3;
  muerto  = #8#5;
  |SI #8#3 = 2;
      fecpar = #8#4;
  |SINO;
      fecpar = #8#6;
  |FINSI;
  |SI #8#3 ! 2;
      |CAMPO_MODIFICA #1#9, 1, "N"
  |FINSI;
  |CIERRA #8;

  |ABRE #0;
  #0#0 = #1#0;
  #0#141 = "T";
  |LEE 010#0=;
  |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
  #1#3 = #0#5;
  #1#5 = #0#32 + #0#54;
  |LIBERA #0;

  #0#0 = #1#0;
  #0#141 = "C";
  |LEE 010#0=;
  |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
  #1#4 = #0#5;
  #1#6 = #0#32 + #0#54;

  #0#0 = #1#0;
  #0#141 = "A";
  |LEE 010#0=;
  |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
  #1#7 = #0#5;
  #1#8 = #0#32 + #0#54;

  ||PINTA #1#3;
  ||PINTA #1#4;
  ||PINTA #1#5;
  ||PINTA #1#6;
  ||PINTA #1#7;
  ||PINTA #1#8;
  |LIBERA #0;
  |CIERRA #0;
|FPRC;

|PROCESO liqborra;
 |BORRA 020#0a;
|FPRC;

|PROCESO patborra;
 |BORRA 020#6a;
 |LIBERA #6;
|FPRC;

|PROCESO adjborra;
  |BORRA 020#11a;
  |LIBERA #11;
|FPRC;

|PROCESO borrainci;
  |BORRA 020#7a;
  |LIBERA #7;
|FPRC;

|PROCESO borrapant;
  |BORRA 020#10a;
  |LIBERA #10;
|FPRC;

|DEFBUCLE borraliq;
#0#1;
;
empresa," ";
emprefi,"z";
be;
NULL,liqborra;
|FIN;

|DEFBUCLE borrapat;
#6#1;
;
empresa," ";
emprefi,"z";
be;
NULL,patborra;
|FIN;

|DEFBUCLE borraadj;
#11#1;
;
empresa," ";
emprefi,"z";
be;
NULL,adjborra;
|FIN;

|DEFBUCLE borrainc;
#7#1;
3;
empresa, 0001, "S";
emprefi, 9999, "S";
be;
NULL,borrainci;
|FIN;

|DEFBUCLE borrapan;
#10#1;
;
empresa;
emprefi;
be;
NULL,borrapant;
|FIN;

|PROCESO acalcula;  |TIPO 3;
|ABRE #4;
|LEE 040#4p;
|SI FSalida = 0; incisino = #4#10; |FINSI;
|CIERRA #4;

|ATRI P;
|CUADRO 1926 2150;
|PINTA 2027, " ESTOY CALCULANDO .... ";
|ATRI 0;

empresa = #1#0;
emprefi = #1#0;
obitus  = #1#9;
feini   = "01.01.1995";
fefin   = fecpar;
dias    = fefin - feini + 1;
parte1  = (( 100 * dias ) / 36500) ! 4;
parte2  = 1 - parte1;
swcalcu = 0;
lininci = 0;
recalcu = 2;

|ABRE #12;
#12#0 = empresa;
|LEE 040#12=;
|SI FSalida ! 0; |DDEFECTO #12; |FINSI;
|CIERRA #12;

|HAZ programas;

|BUCLE borraliq;  || Borra la liquidacion si ya la hubiera
|BUCLE borrapat;  || Borra patrimonio
|BUCLE borraadj;  || Borra liquidacion adjunta
|BUCLE borrainc;  || Borra incidencias
|BUCLE borrapan;  || Borra Pantalla Liquidacion;

||ATENCION !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

|ABRE #3;
#3#0 = empresa;
|LEE 040#3=;
|SI FSalida ! 0; |DDEFECTO #3; |FINSI;
|CIERRA #3;

minusva1 = #3#5;
minusva2 = #3#31;
minusva3 = #3#88;
minusva4 = #3#89;
minusva5 = #3#90;
minusva6 = #3#91;
netot    = #1#3;
netoc    = #1#4;
netoa    = #1#7;
trabac   = #1#6;
trabat   = #1#5;
trabaa   = #1#8;
individu = 0;
|SI #3#34 = "X";  individu = 1;  |FINSI;

|SI #12#01=1;|O #12#02=1;|O #12#03=1;|O #12#04=1;|O #12#05=1; |HAZ recalpa1; |FINSI;
|SI #12#06=1;|O #12#07=1;|O #12#08=1;|O #12#09=1;
 |O #12#10=1;|O #12#51=1;                                     |HAZ recalpa2; |FINSI;
|SI #12#11=1;|O #12#12=1;|O #12#13=1;|O #12#14=1;|O #12#15=1;
 |O #12#52=1;                                                 |HAZ recalpa3; |FINSI;
|SI #12#16=1;|O #12#17=1;|O #12#18=1;|O #12#19=1;|O #12#20=1; |HAZ recalpa4; |FINSI;
|SI #12#21=1;|O #12#22=1;|O #12#23=1;|O #12#24=1;|O #12#25=1; |HAZ recalpa5; |FINSI;
|SI #12#26=1;|O #12#27=1;|O #12#28=1;|O #12#29=1;             |HAZ recalpa6; |FINSI;
                                                              |HAZ recalpa8;
|SI #12#30=1;                                                 |HAZ recalpa7; |FINSI;

|SUB_EJECUTA "reliquip";
|FPRC;

|PROCESO programas;
progra_1  = #12#1;
progra_2  = #12#2;
progra_3  = #12#3;
progra_4  = #12#4;
progra_5  = #12#5;
progra_6  = #12#6;
progra_7  = #12#7;
progra_8  = #12#8;
progra_9  = #12#9;
progra_10 = #12#10;
progra_11 = #12#11;
progra_12 = #12#12;
progra_13 = #12#13;
progra_14 = #12#14;
progra_15 = #12#15;
progra_16 = #12#16;
progra_17 = #12#17;
progra_18 = #12#18;
progra_19 = #12#19;
progra_20 = #12#20;
progra_21 = #12#21;
progra_22 = #12#22;
progra_23 = #12#23;
progra_24 = #12#24;
progra_25 = #12#25;
progra_26 = #12#26;
progra_27 = #12#27;
progra_28 = #12#28;
progra_29 = #12#29;
progra_30 = #12#30;
progra_51 = #12#51;
progra_52 = #12#52;
|FPRC;
