|FICHEROS;
   reempagr #1;
   reempmod #5;
   rerendtr #7;
   rectacor #8;
   rew00001 #99;
|FIN;

|INCLUYE i_varadj;

|| **************************************************************************
||                           PROCESOS IMPRESION
|| **************************************************************************

|PROCESO impre_04;
|SI swporta = 0; |HAZ cabecera; |FINSI;
|IMPRIME varalf; linea = linea + 1; |HAZ linea;
|FPRC;

|| ********************** Empresariales Modulos ****************************

|PROCESO carga_04_3;
|SI conta = 999;
    conta1 = conta1 + 1;
    |ACABA;
|FINSI;

conta  = conta + 1;
|SI conta < 3; |ACABA; |FINSI;

sw_fich = 5;
varalf = "";                                    |HAZ impre_04;
varalf = "";                                    |HAZ impre_04;
varalf = "Epigrafe I.A.E. : "  + #5#13 + #5#14; |HAZ impre_04;
varalf = "Titular ........: "  + perce;          |HAZ impre_04;
varalf = "";                                    |HAZ impre_04;

|PARA x = 16; |SI x [ 22; |HACIENDO x = x + 1;
    a      = x + 7;
    b      = a + 7;
    impor  = #5a % coefi;
    var1   = impor;
    var1   = ("          " + var1) % -110;
    impor  = (#5a % coefi) * (#5b % coefi);
    var2   = impor;
    var2   = ("           " + var2) % -111;
    varalf = #5x + " " + var1 + " " + var2;       |HAZ impre_04;
|SIGUE;
varalf = "";                                        |HAZ impre_04;

impor   = #5#37 % coefi;
importe = impor; |HAZ importe;
varalf = " Rendimiento neto previo ............: " + importe; |HAZ impre_04;
varalf = "";                                        |HAZ impre_04;

a      = #5#38 - 1;
varalf = a;
varalf = ("     " + varalf) % -105;
varalf = " Por caracteristicas de la actividad : " + varalf; |HAZ impre_04;

varalf = #5#40;
varalf = ("     " + varalf) % -105;
varalf = " Actividades temporada ..............: " + varalf; |HAZ impre_04;

varalf = #5#42;
varalf = ("     " + varalf) % -105;
varalf = " Por cuantia del rendimiento ........: " + varalf; |HAZ impre_04;

impor   = #5#44 % coefi;
importe = impor; |HAZ importe;
varalf = " Rendimiento neto corregido .........: " + importe; |HAZ impre_04;
varalf = "";                                        |HAZ impre_04;

|FPRC;

|PROCESO modulos;
|SI #5#4 = "X"; |O #5#4 = "P"; |ACABA; |FINSI;

|SI #99#1 = "A"; perce = #5#3; |SINO; perce = "TITULAR"; |FINSI;

|SI #99#1 = "A";
    |SI #5#2 = "V";
        coefi = #5#7 + #5#8 + #5#9 + #5#10 + #5#11 + #5#12;
        |HAZ carga_04_3;
        |ACABA;
    |FINSI;
    coefi = 100; |HAZ carga_04_3;
    |ACABA;
|FINSI;

|SI #99#1 = "T";
   |SI #5#2 = "G"; coefi = 50;   |HAZ carga_04_3; |ACABA; |FINSI;
   |SI #5#2 = "T"; coefi = 100;  |HAZ carga_04_3; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#7; |HAZ carga_04_3; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI #99#1 = "C";
   |SI #5#2 = "G"; coefi = 50;   |HAZ carga_04_3; |ACABA; |FINSI;
   |SI #5#2 = "C"; coefi = 100;  |HAZ carga_04_3; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#8; |HAZ carga_04_3; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI #99#1 = "1";
   |SI #5#2 = "1"; coefi = 100;  |HAZ carga_04_3; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#9; |HAZ carga_04_3; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI #99#1 = "2";
   |SI #5#2 = "2"; coefi = 100;   |HAZ carga_04_3; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#10; |HAZ carga_04_3; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI #99#1 = "3";
   |SI #5#2 = "3"; coefi = 100;   |HAZ carga_04_3; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#11; |HAZ carga_04_3; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI #99#1 = "4";
   |SI #5#2 = "4"; coefi = 100;   |HAZ carga_04_3; |ACABA; |FINSI;
   |SI #5#2 = "V"; coefi = #5#12; |HAZ carga_04_3; |ACABA; |FINSI;
   |ACABA;
|FINSI;
|FPRC;

|DEFBUCLE reempmod;
#5#1;
;
#99#0, 01;
#99#0, 99;
e;
NULL, modulos;
|FIN;

|| ********************** Empresariales Agricolas ****************************

|PROCESO carga_04_8;
|SI conta = 999;
    conta1 = conta1 + 1;
    |ACABA;
|FINSI;

conta  = conta + 1;
|SI conta < 2; |ACABA; |FINSI;

sw_fich = 5;
|HAZ impre_04;
varalf = "Declaracion : " + #1#4;                                |HAZ impre_04;
varalf = "Titular ....: " + #1#3;                                |HAZ impre_04;
varalf = "Descripcion : " + #1#15;                               |HAZ impre_04;
varalf = "";                                                     |HAZ impre_04;

impor = #1#53 % coefi; importe = impor;                                          |HAZ importe;
varalf = "En tierras propias ..............................: " + importe;
                                                                 |HAZ impre_04;

varalf = "Indice ..........................................: " + #1#56;
                                                                 |HAZ impre_04;

impor = #1#59 % coefi; importe = impor;                                          |HAZ importe;
varalf = "Rendimiento base producto .......................: " + importe;
                                                                 |HAZ impre_04;

impor = #1#54 % coefi; importe = impor;                                          |HAZ importe;
varalf = "En tierras arrendadas ...........................: " + importe;
                                                                 |HAZ impre_04;

varalf = "Indice ..........................................: " + #1#57;
                                                                 |HAZ impre_04;

impor = #1#60 % coefi; importe = impor;                                          |HAZ importe;
varalf = "Rendimiento base producto .......................: " + importe;
                                                                 |HAZ impre_04;

impor = #1#55 % coefi;  importe = impor;                                          |HAZ importe;
varalf = "Otros ...........................................: " + importe;
                                                                 |HAZ impre_04;

varalf = "Indice ..........................................: " + #1#58;
                                                                 |HAZ impre_04;

impor = #1#61 % coefi; importe = impor;                                          |HAZ importe;
varalf = "Rendimiento base producto .......................: " + importe;
                                                                 |HAZ impre_04;

varalf = "";                                                     |HAZ impre_04;

impor = #1#51 % coefi; importe = impor;                                          |HAZ importe;
varalf = "Rendimiento base actividad ......................: " + importe;
                                                                 |HAZ impre_04;

varalf = "Medio produccion ajenos .........................: " + #1#28;
                                                                 |HAZ impre_04;

varalf = "Personal asalariados ............................: " + #1#29;
                                                                 |HAZ impre_04;

varalf = "Por piensos adquiridos a terceros ...............: " + #1#26;
                                                                 |HAZ impre_04;

impor = #1#37 % coefi; importe = impor;                                         |HAZ importe;
varalf = "Rendimiento neto corregido ......................: " + importe;
                                                                 |HAZ impre_04;

varalf = "";                                                     |HAZ impre_04;

impor = #1#38 % coefi; importe = impor;                                         |HAZ importe;
varalf = "Disminuciones de patrimonio por causas excep. ...: " + importe;
                                                                 |HAZ impre_04;

impor = #1#39 % coefi; importe = impor;                                         |HAZ importe;
varalf = "Gastos extraordinarios por circuntacias excep. ..: " + importe;
                                                                 |HAZ impre_04;


varalf = "Ley 42/94 .......................................: " + #1#31;
                                                                 |HAZ impre_04;

varalf = "Nueva creacion ..................................: " + #1#30;
                                                                 |HAZ impre_04;

varalf = "Ley 19/95 .......................................: " + #1#27;
                                                                 |HAZ impre_04;

varalf = "";                                                     |HAZ impre_04;

impor = #1#40 % coefi; importe = impor;                                         |HAZ importe;
varalf = "Incrementos de patrimonio ......................: " + importe;
                                                                 |HAZ impre_04;

impor = #1#41 % coefi; importe = impor;                                         |HAZ importe;
varalf = "Disminuciones patrimonio .......................: " + importe;
                                                                 |HAZ impre_04;

impor = #1#42 % coefi; importe = impor;                                         |HAZ importe;
varalf = "Prestaciones ...................................: " + importe;
                                                                 |HAZ impre_04;

impor = #1#32 % coefi; importe = impor;                                          |HAZ importe;
varalf = "Rendimineto Neto ................................: " + importe;
                                                                 |HAZ impre_04;
|FPRC;

|PROCESO agricolas;
|SI #1#4 = "X"; |O #1#4 = "P"; |ACABA; |FINSI;

|SI #99#1 = "A"; perce = #1#3; |SINO; perce = "TITULAR"; |FINSI;

|SI #99#1 = "A";
    |SI #1#2 = "V";
        coefi = #1#7 + #1#8 + #1#9 + #1#10 + #1#11 + #1#12;
        |HAZ carga_04_8;
        |ACABA;
    |FINSI;
    coefi = 100; |HAZ carga_04_8;
    |ACABA;
|FINSI;

|SI #99#1 = "T";
   |SI #1#2 = "G"; coefi = 50;   |HAZ carga_04_8; |ACABA; |FINSI;
   |SI #1#2 = "T"; coefi = 100;  |HAZ carga_04_8; |ACABA; |FINSI;
   |SI #1#2 = "V"; coefi = #1#7; |HAZ carga_04_8; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI #99#1 = "C";
   |SI #1#2 = "G"; coefi = 50;   |HAZ carga_04_8; |ACABA; |FINSI;
   |SI #1#2 = "C"; coefi = 100;  |HAZ carga_04_8; |ACABA; |FINSI;
   |SI #1#2 = "V"; coefi = #1#8; |HAZ carga_04_8; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI #99#1 = "1";
   |SI #1#2 = "1"; coefi = 100;  |HAZ carga_04_8; |ACABA; |FINSI;
   |SI #1#2 = "V"; coefi = #1#9; |HAZ carga_04_8; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI #99#1 = "2";
   |SI #1#2 = "2"; coefi = 100;   |HAZ carga_04_8; |ACABA; |FINSI;
   |SI #1#2 = "V"; coefi = #1#10; |HAZ carga_04_8; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI #99#1 = "3";
   |SI #1#2 = "3"; coefi = 100;   |HAZ carga_04_8; |ACABA; |FINSI;
   |SI #1#2 = "V"; coefi = #1#11; |HAZ carga_04_8; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI #99#1 = "4";
   |SI #1#2 = "4"; coefi = 100;   |HAZ carga_04_8; |ACABA; |FINSI;
   |SI #1#2 = "V"; coefi = #1#12; |HAZ carga_04_8; |ACABA; |FINSI;
   |ACABA;
|FINSI;
|FPRC;

|DEFBUCLE reempagr;
#1#1;
;
#99#0, 01;
#99#0, 99;
e;
NULL, agricolas;
|FIN;

|| ********************** Irregulares Trabajo ***********************************

|PROCESO carga_04_20;
conta = conta + 1;
|SI conta > 3; swprof = 1; |FINSI;
|FPRC;

|PROCESO carga_04_6;
conta = conta + 1;
|SI conta < 3; |ACABA; |FINSI;
varalf = "";                                                     |HAZ impre_04;
varalf = "";                                                     |HAZ impre_04;
|SI caciclo = 0;
    varalf = "F) RENDIMIENTOS IRREGULARES O DE CICLO SUPERIOR A UN A¥O"; |HAZ impre_04;
    varalf = "";                                                 |HAZ impre_04;
    |SI  sw_fich = 7;
         varalf = "Del Trabajo";                                 |HAZ impre_04;
    |SINO;
         |SI swrrr1 = 0;
             varalf = "Del Capital";                             |HAZ impre_04;
             swrrr1 = 1;
         |FINSI;
    |FINSI;
    varalf = "";                                                 |HAZ impre_04;
    caciclo = 1;
|SINO;
     |SI sw_fich = 8; |Y swrrr1 = 0;
         varalf = "Del Capital";                                 |HAZ impre_04;
         varalf = "";                                            |HAZ impre_04;
         swrrr1 = 0;
     |FINSI;
|FINSI;

varalf = "Descripcion : " + var1;                                |HAZ impre_04;
varalf = "Perceptor ..: " + var2;                                |HAZ impre_04;
varalf = "";                                                     |HAZ impre_04;
a = var3 % coefi; importe = impor;                                  |HAZ importe;
varalf = "Retencion / Ingreso a cuenta ....................: " + importe;
                                                                 |HAZ impre_04;
a = var4 % coefi; importe = impor;                                  |HAZ importe;
varalf = "Ingresos integros ...............................: " + importe;
                                                                 |HAZ impre_04;
a = var5 % coefi; importe = impor;                                   |HAZ importe;
varalf = "Gastos deducibles / Reduccion Legal .............: " + importe;
                                                                 |HAZ impre_04;
a = var6 % coefi; importe = impor;                                   |HAZ importe;
varalf = "Rendimiento Neto ................................: " + importe;
                                                                 |HAZ impre_04;
a = var7 % coefi; importe = impor;                                   |HAZ importe;
varalf = "Periodo de generacion (A¥OS) ....................: " + importe;
                                                                 |HAZ impre_04;
a = var8 % coefi; importe = impor;                                   |HAZ importe;
varalf = "Cociente ........................................: " + importe;
                                                                 |HAZ impre_04;
a = var9 % coefi; importe = impor;                                   |HAZ importe;
varalf = "Resto del rendimiento neto ......................: " + importe;
                                                                 |HAZ impre_04;
|FPRC;

|PROCESO trabajo1;
sw_fich = 7;

|SI #99#1 = "A"; perce = #7#3; |SINO; perce = "TITULAR"; |FINSI;

var1 = #7#4;
var2 = perce;
var3 = #7#23;
var4 = #7#22;
var5 = #7#24;
var6 = #7#26;
var7 = #7#25;
var8 = #7#27;
var9 = #7#26 - #7#27;

var6 = #7#26;
|SI #7#28 = "X"; |ACABA; |FINSI;
|SI #7#22 = 0;   |ACABA; |FINSI;

coefi = 100;

|SI #99#1 = "A"; |HAZ carga_04_6; |ACABA; |FINSI;
|SI #99#1 = "T"; |Y #7#2 = "T"; |HAZ carga_04_6; |ACABA; |FINSI;
|SI #99#1 = "C"; |Y #7#2 = "C"; |HAZ carga_04_6; |ACABA; |FINSI;
|SI #99#1 = "1"; |Y #7#2 = "1"; |HAZ carga_04_6; |ACABA; |FINSI;
|SI #99#1 = "2"; |Y #7#2 = "2"; |HAZ carga_04_6; |ACABA; |FINSI;
|SI #99#1 = "3"; |Y #7#2 = "3"; |HAZ carga_04_6; |ACABA; |FINSI;
|SI #99#1 = "4"; |Y #7#2 = "4"; |HAZ carga_04_6; |ACABA; |FINSI;
|FPRC;

|PROCESO trabajo2;
|SI #7#28 = "X"; |ACABA; |FINSI;
|SI #7#22 = 0;   |ACABA; |FINSI;

coefi = 100;

|SI #99#1 = "A"; perce = #7#3; |SINO; perce = "TITULAR"; |FINSI;

|SI #99#1 = "A"; |HAZ carga_04_20; |ACABA; |FINSI;
|SI #99#1 = "T"; |Y #7#2 = "T"; |HAZ carga_04_20; |ACABA; |FINSI;
|SI #99#1 = "C"; |Y #7#2 = "C"; |HAZ carga_04_20; |ACABA; |FINSI;
|SI #99#1 = "1"; |Y #7#2 = "1"; |HAZ carga_04_20; |ACABA; |FINSI;
|SI #99#1 = "2"; |Y #7#2 = "2"; |HAZ carga_04_20; |ACABA; |FINSI;
|SI #99#1 = "3"; |Y #7#2 = "3"; |HAZ carga_04_20; |ACABA; |FINSI;
|SI #99#1 = "4"; |Y #7#2 = "4"; |HAZ carga_04_20; |ACABA; |FINSI;
|FPRC;

|DEFBUCLE rerendt1;
#7#1;
;
#99#0, 01;
#99#0, 99;
e;
NULL, trabajo1;
|FIN;

|DEFBUCLE rerendt2;
#7#1;
;
#99#0, 01;
#99#0, 99;
e;
NULL, trabajo2;
|FIN;

|| ********************** Irregulares Capital ***********************************

|PROCESO capital1;
sw_fich = 8;

|SI #8#4 = "X"; |O #8#4 = "P"; |ACABA; |FINSI;
|SI #8#26 ! "I"; |ACABA; |FINSI;
|SI #8#5 = "N";  |ACABA; |FINSI;

|SI #99#1 = "A"; perce = #8#3; |SINO; perce = "TITULAR"; |FINSI;

var1 = #8#14;
var2 = perce;
var3 = #8#18;
var4 = #8#17;
var5 = #8#21 + #8#22;
var6 = var4 - var5;
var7 = #8#27;
var8 = var6 / var7;
var9 = var6 - var8;

|SI #99#1 = "A";
    |SI #8#2 = "V";
        coefi = #8#7 + #8#8 + #8#9 + #8#10 + #8#11 + #8#12;
        |HAZ carga_04_6;
        |ACABA;
    |FINSI;
    coefi = 100; |HAZ carga_04_6;
    |ACABA;
|FINSI;

|SI #99#1 = "T";
   |SI #8#2 = "G"; coefi = 50;   |HAZ carga_04_6; |ACABA; |FINSI;
   |SI #8#2 = "T"; coefi = 100;  |HAZ carga_04_6; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#7; |HAZ carga_04_6; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI #99#1 = "C";
   |SI #8#2 = "G"; coefi = 50;   |HAZ carga_04_6; |ACABA; |FINSI;
   |SI #8#2 = "C"; coefi = 100;  |HAZ carga_04_6; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#8; |HAZ carga_04_6; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI #99#1 = "1";
   |SI #8#2 = "1"; coefi = 100;  |HAZ carga_04_6; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#9; |HAZ carga_04_6; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI #99#1 = "2";
   |SI #8#2 = "2"; coefi = 100;   |HAZ carga_04_6; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#10; |HAZ carga_04_6; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI #99#1 = "3";
   |SI #8#2 = "3"; coefi = 100;   |HAZ carga_04_6; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#11; |HAZ carga_04_6; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI #99#1 = "4";
   |SI #8#2 = "4"; coefi = 100;   |HAZ carga_04_6; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#12; |HAZ carga_04_6; |ACABA; |FINSI;
   |ACABA;
|FINSI;
|FPRC;

|PROCESO capital2;
|SI #8#4 = "X"; |O #8#4 = "P"; |ACABA; |FINSI;
|SI #8#26 ! "I"; |ACABA; |FINSI;
|SI #8#5 = "N";  |ACABA; |FINSI;

|SI #99#1 = "A"; perce = #8#3; |SINO; perce = "TITULAR"; |FINSI;

|SI #99#1 = "A";
    |SI #8#2 = "V";
        coefi = #8#7 + #8#8 + #8#9 + #8#10 + #8#11 + #8#12;
        |HAZ carga_04_20;
        |ACABA;
    |FINSI;
    coefi = 100; |HAZ carga_04_20;
    |ACABA;
|FINSI;

|SI #99#1 = "T";
   |SI #8#2 = "G"; coefi = 50;   |HAZ carga_04_20; |ACABA; |FINSI;
   |SI #8#2 = "T"; coefi = 100;  |HAZ carga_04_20; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#7; |HAZ carga_04_20; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI #99#1 = "C";
   |SI #8#2 = "G"; coefi = 50;   |HAZ carga_04_20; |ACABA; |FINSI;
   |SI #8#2 = "C"; coefi = 100;  |HAZ carga_04_20; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#8; |HAZ carga_04_20; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI #99#1 = "1";
   |SI #8#2 = "1"; coefi = 100;  |HAZ carga_04_20; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#9; |HAZ carga_04_20; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI #99#1 = "2";
   |SI #8#2 = "2"; coefi = 100;   |HAZ carga_04_20; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#10; |HAZ carga_04_20; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI #99#1 = "3";
   |SI #8#2 = "3"; coefi = 100;   |HAZ carga_04_20; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#11; |HAZ carga_04_20; |ACABA; |FINSI;
   |ACABA;
|FINSI;

|SI #99#1 = "4";
   |SI #8#2 = "4"; coefi = 100;   |HAZ carga_04_20; |ACABA; |FINSI;
   |SI #8#2 = "V"; coefi = #8#12; |HAZ carga_04_20; |ACABA; |FINSI;
   |ACABA;
|FINSI;
|FPRC;

|DEFBUCLE rectaco1;
#8#1;
;
#99#0, 01;
#99#0, 99;
e;
NULL, capital1;
|FIN;

|DEFBUCLE rectaco2;
#8#1;
;
#99#0, 01;
#99#0, 99;
e;
NULL, capital2;
|FIN;

|PROCESO readjor4;
swmod   = 0;
swprof  = 0;
swrrr1  = 0;

conta  = 999;   conta1 = 0; |BUCLE reempagr;
|SI conta1 > 2; conta  = 0; |BUCLE reempagr; |FINSI;

conta  = 999;   conta1 = 0; |BUCLE reempmod;
|SI conta1 > 3; conta  = 0; |BUCLE reempmod; |FINSI;

swprof  = 0;
conta = 0; |BUCLE rerendt2;
           |BUCLE rectaco2;
|SI swprof = 1;
     conta = 0; |BUCLE rerendt1;
                |BUCLE rectaco1;
|FINSI;
|FPRC;
