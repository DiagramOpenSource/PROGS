|FICHEROS;
    reinfimp #0;
    redatcon #1;
    recapinm #3;
    reliquid #4;
    reacceso #5;
    reven210 #6;
    realc210 #7;
    reall210 #8;
    retabla3 #9;
    rey00100 #99;
|FIN;

|VARIABLES;
    SwInf       = 0;
    SwEstar     = 0;
    Parrilla    = 0;
    Casilla     = 0;
    Casilla1    = 0;
    Casilla2    = 0;
    Casilla3    = 0;
    FEstado     = 0;
    Porce       = 0;
    Para1       = 0;
    DClien      = 0;
    HClien      = 0;
    Fecha       = "";
    FechaInicio = @;
    SwHacer     = 0;
    Conta       = 0;
    Coefi       = 0;
    Cuota       = 0;
    Cuot2       = 0;
    Resto       = 0;
    Nume1       = 0;
    Base        = 0;
    Hasta       = 0;
    Recuadro01  = 0;
    Recuadro02  = 0;
    Recuadro03  = 0;
    Recuadro04  = 0;
    Recuadro05  = 0;
    Recuadro06  = 0;
    Recuadro07  = 0;
|FIN;

|PROCESO Parrilla; |TIPO 0;
|SI #0#18 = "N";
    |PARA Casilla = 19; |SI Casilla [ 36; |HACIENDO Casilla = Casilla + 1;
          #0Casilla = 0; |PINTA #0Casilla;
          |CAMPO_MODIFICA #0Casilla, 1, "N";
    |SIGUE;
    |CAMPO_MODIFICA #0#00, 1, "S";
    |CAMPO_MODIFICA #0#01, 1, "S";
|SINO;
    #0#0 = 1;     |PINTA #0#0;
    #0#1 = 99999; |PINTA #0#1;
    |PARA Casilla = 19; |SI Casilla [ 36; |HACIENDO Casilla = Casilla + 1;
          |CAMPO_MODIFICA #0Casilla, 1, "S";
    |SIGUE;
    |CAMPO_MODIFICA #0#00, 1, "N";
    |CAMPO_MODIFICA #0#01, 1, "N";
|FINSI;
|FPRC;

|PROCESO LeeLiqui;
|DDEFECTO #4;
|ABRE #4;
#4#0 = #1#0;
|LEE 040#4=;
|SI FSalida ! 0; |DDEFECTO #4; |FINSI;
|CIERRA #4;

|DDEFECTO #5;
|ABRE #5;
    #5#0 = #1#0;
|LEE 0401#5=;
|SI FSalida ! 0; |DDEFECTO #5; |FINSI;
|CIERRA #5;
|FPRC;

|PROCESO CargaSpanis;
|SI #0#2 = "S";
    |SI #1#103 = "O"; #99#0 = #4#8;  |FINSI;
    |SI #1#103 = "o"; #99#0 = #4#8;  |FINSI;
    |SI #1#104 = "O"; #99#1 = #4#9;  |FINSI;
    |SI #1#104 = "o"; #99#1 = #4#9;  |FINSI;
    |SI #1#105 = "O"; #99#2 = #4#10; |FINSI;
    |SI #1#105 = "o"; #99#2 = #4#10; |FINSI;
    |SI #1#106 = "O"; #99#3 = #4#11; |FINSI;
    |SI #1#106 = "o"; #99#3 = #4#11; |FINSI;
    |SI #1#107 = "O"; #99#4 = #4#12; |FINSI;
    |SI #1#107 = "o"; #99#4 = #4#12; |FINSI;
    |SI #1#108 = "O"; #99#5 = #4#13; |FINSI;
    |SI #1#108 = "o"; #99#5 = #4#13; |FINSI;
    |SI #1#109 = "O"; #99#6 = #4#14; |FINSI;
    |SI #1#109 = "o"; #99#6 = #4#14; |FINSI;
|FINSI;

|SI #0#3 = "S";
    |SI #1#103 = "S"; #99#0 = #4#8;  |FINSI;
    |SI #1#104 = "S"; #99#1 = #4#9;  |FINSI;
    |SI #1#105 = "S"; #99#2 = #4#10; |FINSI;
    |SI #1#106 = "S"; #99#3 = #4#11; |FINSI;
    |SI #1#107 = "S"; #99#4 = #4#12; |FINSI;
    |SI #1#108 = "S"; #99#5 = #4#13; |FINSI;
    |SI #1#109 = "S"; #99#6 = #4#14; |FINSI;
|FINSI;

|SI #0#4 = "S";
    |SI #1#103 = "A"; #99#0 = #4#8;  |FINSI;
    |SI #1#104 = "A"; #99#1 = #4#9;  |FINSI;
    |SI #1#105 = "A"; #99#2 = #4#10; |FINSI;
    |SI #1#106 = "A"; #99#3 = #4#11; |FINSI;
    |SI #1#107 = "A"; #99#4 = #4#12; |FINSI;
    |SI #1#108 = "A"; #99#5 = #4#13; |FINSI;
    |SI #1#109 = "A"; #99#6 = #4#14; |FINSI;
|FINSI;

|SI #0#5 ! "N";
    |SI #0#5 = 1; Porce = 60; |FINSI;
    |SI #0#5 = 2; Porce = 40; |FINSI;

    |PARA Casilla = 110; |SI Casilla [ 116; |HACIENDO Casilla = Casilla + 1;
          Casilla1 = Casilla - 110;

          |SI #1Casilla ! "N";
              |SI  #99Casilla1 > 0;
                   #99Casilla1 = #99Casilla1 % Porce;
              |FINSI;
          |FINSI;
    |SIGUE;
|FINSI;

|SI #0#8 = "S";
    |SI #1#140 = "S"; #99#7  = #4#35; |FINSI;
    |SI #1#141 = "S"; #99#8  = #4#36; |FINSI;
    |SI #1#194 = "S"; #99#9  = #4#37; |FINSI;
    |SI #1#195 = "S"; #99#10 = #4#38; |FINSI;
    |SI #1#196 = "S"; #99#11 = #4#39; |FINSI;
    |SI #1#197 = "S"; #99#12 = #4#40; |FINSI;
|FINSI;

|SI #0#9 ! "T";
    |SI #0#5 = "S";
        |SI #99#0 > 0;
            |SI #0#9 ! #1#131; #99#0  = 0; |FINSI;
        |SINO;
            |SI #0#9 ! #1#124; #99#0  = 0; |FINSI;
        |FINSI;

        |SI #99#1 > 0;
           |SI #0#9 ! #1#132; #99#1  = 0; |FINSI;
        |SINO;
           |SI #0#9 ! #1#125; #99#1  = 0; |FINSI;
        |FINSI;

        |SI #99#2 > 0;
            |SI #0#9 ! #1#133; #99#2  = 0; |FINSI;
        |SINO;
            |SI #0#9 ! #1#126; #99#2  = 0; |FINSI;
        |FINSI;

        |SI #99#3 > 0;
            |SI #0#9 ! #1#134; #99#3  = 0; |FINSI;
        |SINO;
            |SI #0#9 ! #1#127; #99#3  = 0; |FINSI;
        |FINSI;

        |SI #99#4 > 0;
            |SI #0#9 ! #1#135; #99#4  = 0; |FINSI;
        |SINO;
            |SI #0#9 ! #1#128; #99#4  = 0; |FINSI;
        |FINSI;

        |SI #99#5 > 0;
            |SI #0#9 ! #1#136; #99#5  = 0; |FINSI;
        |SINO;
            |SI #0#9 ! #1#129; #99#5  = 0; |FINSI;
        |FINSI;

        |SI #99#6 > 0;
            |SI #0#9 ! #1#137; #99#6  = 0; |FINSI;
        |SINO;
            |SI #0#9 ! #1#130; #99#6  = 0; |FINSI;
        |FINSI;
    |SINO;
        |SI #0#9 ! #1#124; #99#0  = 0; |FINSI;
        |SI #0#9 ! #1#125; #99#1  = 0; |FINSI;
        |SI #0#9 ! #1#126; #99#2  = 0; |FINSI;
        |SI #0#9 ! #1#127; #99#3  = 0; |FINSI;
        |SI #0#9 ! #1#128; #99#4  = 0; |FINSI;
        |SI #0#9 ! #1#129; #99#5  = 0; |FINSI;
        |SI #0#9 ! #1#130; #99#6  = 0; |FINSI;
    |FINSI;

    |SI #0#9 ! #1#138; #99#7  = 0; |FINSI;
    |SI #0#9 ! #1#139; #99#8  = 0; |FINSI;
    |SI #0#9 ! #1#198; #99#9  = 0; |FINSI;
    |SI #0#9 ! #1#199; #99#10 = 0; |FINSI;
    |SI #0#9 ! #1#200; #99#11 = 0; |FINSI;
    |SI #0#9 ! #1#201; #99#12 = 0; |FINSI;
|FINSI;
|FPRC;

|PROCESO Ventas;
|ABRE #6;
#6#0 = #1#0;
|LEE 040#6=;
|SI FSalida ! 0; |CIERRA #6; |ACABA; |FINSI;
|CIERRA #6;

SwHacer = 1;
|SI #6#56 = "S";
    |SI #6#54 > 0; #99#1 = #6#54; |FINSI;
|FINSI;
|FPRC;

|PROCESO MiraCab;
#7#0 = #8#0;
|LEE 040#7=;
|SI FSalida ! 0; |DDEFECTO #7; |FINSI;

SwHacer = 1;

|SI #8#20 > 0;
    #99#1 = #99#1 + #8#20;
|FINSI;
|FPRC;

|DEFBUCLE reall210;
#8#1;
2;
000, 000, #1#0;
999, 999, #1#0;
e;
NULL, MiraCab;
|FIN;

|PROCESO Alquiler;
|ABRE #7;
|BUCLE reall210;
|CIERRA #7;
|FPRC;

|PROCESO El210;
|SI #3#2 = "G";
    Conta = Conta + 1;
    |SI Conta > 6; |ACABA; |FINSI;

    #99#1 = #99#1 + ((#3#47 % 50) % 25);

    Conta = Conta + 1;
    |SI Conta > 6; |ACABA; |FINSI;

    #99#2 = #99#2 + ((#3#47 % 50) % 25);
|SINO;
    Conta = Conta + 1;
    |SI Conta > 6; |ACABA; |FINSI;

    #99#1  = #99#1 + (#3#47 % 25);
|FINSI;
|FPRC;

|DEFBUCLE recapinm1;
#3#1;
;
#1#0, 00;
#1#0, 99;
e;
NULL, El210;
|FIN;

|PROCESO Modelo210;
Conta = 0;
|BUCLE recapinm1;
|FPRC;

|PROCESO El214;
Coefi = 100;
|SI #1#36 = "X"; |Y #3#2 = "G";  Coefi = 50;  |FINSI;

#3#8  = #3#8  % Coefi;
#3#9  = #3#9  % Coefi;
#3#10 = #3#10 % Coefi;
#3#14 = #3#14 % Coefi;
#3#17 = #3#17 % Coefi;
#3#18 = #3#18 % Coefi;
#3#19 = #3#19 % Coefi;
#3#20 = #3#20 % Coefi;

Recuadro01 = #3#8;
|SI Recuadro01 < #3#17; Recuadro01 = #3#17; |FINSI;
|SI Recuadro01 < #3#19; Recuadro01 = #3#19; |FINSI;

|SI Recuadro01 = 0; |ACABA; |FINSI;

|ABRE #9;
|LEE 040#9p;
|SI FSalida ! 0; |DDEFECTO #9; |FINSI;
|CIERRA #9;

Recuadro02 = #3#9 + #3#10 + #3#14 + #3#20;     || deudas [02]
Recuadro03 = Recuadro01 - Recuadro02;          || base liquidable

|PARA Casilla1 = 8; |SI Casilla1 ] 1; |HACIENDO Casilla1 = Casilla1 - 1;
      Casilla2 = Casilla1 + 8;
      Casilla3 = Casilla1 + 16;
      |SI Recuadro03 > #9Casilla1;
          Hasta = #9Casilla1;

          Cuota = #9Casilla2;
          Porce = #9Casilla3;
          Resto = Recuadro03 - Hasta;
          Cuot2 = (Resto % Porce) ! 0;
          Recuadro04 = Cuota + Cuot2;       || Cuota integra
          |SAL;
      |FINSI;
|SIGUE;

|SI FechaInicio < #3#18;
     Nume1 = 365 - (#3#18 - FechaInicio);
     Base = (Nume1 * #3#8) / 365;
|SINO;
     Base = #3#8;
|FINSI;

|SI #3#71 = "N";
    Recuadro05 = Base % 2;
|SINO;
    Recuadro05 = Base % 1.1;
|FINSI;

Recuadro06 = Recuadro05 % 25;
Recuadro07 = Recuadro04 + Recuadro06;

|SI Coefi = 50;
    |SI #0#7 = "S";
        #99#1 = #99#1 + Recuadro06;
        #99#2 = #99#2 + Recuadro06;
    |FINSI;

    |SI #0#8 = "S";
        #99#7 = #99#7 + Recuadro04;
        #99#8 = #99#8 + Recuadro04;
    |FINSI;
|SINO;
    |SI #0#7 = "S"; #99#1 = #99#1 + Recuadro06; |FINSI;
    |SI #0#8 = "S"; #99#7 = #99#7 + Recuadro04; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE recapinm2;
#3#1;
;
#1#0, 00;
#1#0, 99;
e;
NULL, El214;
|FIN;

|PROCESO Modelo214;
Conta = 0;
|BUCLE recapinm2;
|FPRC;

|PROCESO CargaGuiris;
Recuadro01 = 0;  Recuadro02 = 0;  Recuadro03 = 0;
Recuadro04 = 0;  Recuadro05 = 0;  Recuadro06 = 0;
Recuadro07 = 0;
SwHacer    = 0;

|SI #1#138 = "S";
    |SI #0#6 = "S";     |HAZ Ventas;    |FINSI;
    |SI #0#6 = "S";     |HAZ Alquiler;  |FINSI;
    |SI SwHacer = 0;
        |SI #0#6 = "S"; |HAZ Modelo210; |FINSI;
    |FINSI;
    |SI #0#8 = "S";
        |SI #1#140 = "S"; #99#7  = #4#35; |FINSI;
        |SI #1#141 = "S"; #99#8  = #4#36; |FINSI;
    |FINSI;
|SINO;
    |SI #0#6 = "S"; |HAZ Ventas;     |FINSI;
    |SI #0#6 = "S"; |HAZ Alquiler;   |FINSI;
    |SI SwHacer = 0; |HAZ Modelo214; |FINSI;
|FINSI;
|FPRC;

|PROCESO MiraRenta;
|HAZ LeeLiqui;

|DDEFECTO #99;

|SI #1#4 = "S"; |HAZ CargaSpanis; |FINSI;
|SI #1#4 = "N"; |HAZ CargaGuiris; |FINSI;

|SI #0#15 ! "T";
    |PARA Casilla = 0; |SI Casilla [ 12; |HACIENDO Casilla = Casilla + 1;
          |SI #0#15 = "P"; |Y #99Casilla < 0; #99Casilla = 0; |FINSI;
          |SI #0#15 = "D"; |Y #99Casilla > 0; #99Casilla = 0; |FINSI;
    |SIGUE;
|FINSI;

SwEstar = 0;
|PARA Casilla = 0; |SI Casilla [ 12; |HACIENDO Casilla = Casilla + 1;
      |SI #99Casilla ! 0; SwEstar = 1; |FINSI;
      |SI Casilla [ 6; |Y #99Casilla ! 0; #99#13 = 1; |FINSI;
      |SI Casilla > 6; |Y #99Casilla ! 0; #99#14 = 1; |FINSI;
|SIGUE;

|SI SwEstar = 0; |ACABA; |FINSI;

SwInf = 1; |PRINT;
|FPRC;

|CALCULO Ordena;
|DDEFECTO #5;
|ABRE #5;
    #5#0 = #1#0;
|LEE 000#5=;
|CIERRA #5;
|FCAL;

|DEFBUCLE redatcon2;
 #1#1;
 102;
 DClien, #0#12;
 HClien, #0#13;
 e;
 NULL, Ordena, NULL, NULL, NULL, MiraRenta;
 #5#1, #5#0;
|FIN;

|DEFBUCLE redatcon1;
 #1#1;
 102;
 DClien, #0#12;
 HClien, #0#13;
 e;
 NULL, MiraRenta;
|FIN;

|PROCESO Tipo3; |TIPO 3;
FechaInicio  = ~;
Fecha        = "01.01." + (FechaInicio % -104);
FechaInicio  = Fecha;

|IMPRE 0;
|SI FSalida ! 0; |ACABA; |FINSI;

|INFOR "reinfimp";
|SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;

|SI #0#18 = "N";
    DClien = #0#0;
    HClien = #0#1;
    |SI #0#17 = 1;  |BUCLE redatcon1;  |FINSI;
    |SI #0#17 = 2;  |BUCLE redatcon2;  |FINSI;
|SINO;
    |PARA Parrilla = 19; |SI Parrilla [ 36; |HACIENDO Parrilla = Parrilla + 1;
          |SI #0Parrilla ! 0;
              DClien = #0Parrilla;
              HClien = #0Parrilla;
              |SI #0#17 = 1;  |BUCLE redatcon1;  |FINSI;
              |SI #0#17 = 2;  |BUCLE redatcon2;  |FINSI;
          |FINSI;
    |SIGUE;
|FINSI;

|SI SwInf = 1; |PIEINF; |FINSI;

|FININF;
|FINIMP;
|FPRC;
