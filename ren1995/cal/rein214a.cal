|FICHEROS;
    rein214a #0;
    recapinm #1;         || capital inmobiliario
    redatcon #2;         || datos contribuyentes
    rerenpre #4;         || representantes
    rehacien #5;         || datos hacienda
    retabla3 #6;         || tarifa patrimonio
    repoblac #7;         || poblaciones
|FIN;

|VARIABLES;
    informe  = "";
    x        = 0;

    &diap    = "";
    &mespl   = "";
    &anyop   = "";
    &pobla   = "";
    mesp     = "";

    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";


    &el_01 = 0;
    &el_02 = 0;
    &el_03 = 0;
    &el_04 = 0;
    &el_05 = 0;
    &el_06 = 0;
    &el_07 = 0;
    &hasta = 0;
    &resto = 0;
    &cuota = 0;
    &cuot2 = 0;
    &porce = 0;

    &nif_i       = "";
    &nombre_i    = "";
    &sg_i        = "";
    &calle_i     = "";
    &numero_i    = "";
    &escalera_i  = "";
    &piso_i      = "";
    &puerta_i    = "";
    &telefono_i  = "";
    &cod_prov_i  = 0;
    &cod_pobl_i  = 0;
    &poblacion_i = "";
    &provincia_i = "";

    coefi = 0;
    base2 = 0;
    inicio = @;
    hay = 0;
|FIN;
____________________________________/ CALCULOS DE PANTALLA
|CALCULO defecto; |TIPO 7;
    fech1 = ~;
    alfa1 = fech1;
    alfa1 = alfa1 % -104;
    nume1 = alfa1;
    nume1 = nume1 - 1;
    #0Campo = nume1;
|PINTA #0Campo;
|FCAL;
____________________________________/
|PROCESO hoja;
|SI coefi = 100;
    nif_i    = #2#2;
    nombre_i = #2#1;

    |INFOR "rein214a";
    |SI FSalida = 0;
        |PRINT;
        |PIEINF;
        |FININF;
    |FINSI;
|SINO;
    nif_i    = #2#2;
    nombre_i = #2#1;

    |INFOR "rein214a";
    |SI FSalida = 0;
        |PRINT;
        |PIEINF;
        |FININF;
    |FINSI;

    nif_i    = #2#29;
    nombre_i = #2#28;

    |INFOR "rein214a";
    |SI FSalida = 0;
        |PRINT;
        |PIEINF;
        |FININF;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO limpia;
    el_01 = 0;
    el_02 = 0;
    el_03 = 0;
    el_04 = 0;
    el_05 = 0;
    el_06 = 0;
    el_07 = 0;
    hasta = 0;
    resto = 0;
    cuota = 0;
    porce = 0;
    base2 = 0;

    coefi = 0;
|FPRC;

|PROCESO calculo;
|SI #2#36 = "X"; |Y #1#2 = "G";
    coefi = 50;
|SINO;
    coefi = 100;
|FINSI;

#1#8  = #1#8  % coefi;
#1#9  = #1#9  % coefi;
#1#10 = #1#10 % coefi;
#1#14 = #1#14 % coefi;
#1#17 = #1#17 % coefi;
#1#18 = #1#18 % coefi;
#1#19 = #1#19 % coefi;
#1#20 = #1#20 % coefi;

el_01 = #1#8;         || valor catastral
|SI el_01 < #1#17;  el_01 = #1#17; |FINSI;
|SI el_01 < #1#19;  el_01 = #1#19; |FINSI;
|SI el_01 = 0; |ACABA; |FINSI;

el_02 = #1#9 + #1#10 + #1#14 + #1#20;     || deudas [02]
el_03 = el_01 - el_02;                    || base liquidable
|PARA para1 = 8; |SI para1 ] 1; |HACIENDO para1 = para1 - 1;
      para2 = para1 + 8;
      para3 = para1 + 16;
      |SI el_03 > #6para1;
          hasta = #6para1;
          cuota = #6para2;
          porce = #6para3;
          resto = el_03 - hasta;
          cuot2 = (resto % porce) ! 0;
          el_04 = cuota + cuot2;       || cuota integra
         |SAL;
      |FINSI;
|SIGUE;

|SI inicio < #1#18;
    nume1 = 365 - (#1#18 - inicio);
    base2 = (nume1 * #1#8) / 365;
|SINO;
    base2 = #1#8;
|FINSI;

|SI #1#71 = "N";
    el_05 = base2 % 2;
|SINO;
    el_05 = base2 % 1.1;
|FINSI;

el_06 = el_05 % 25;
el_07 = el_04 + el_06;
|HAZ hoja;
|FPRC;

|PROCESO lee_capital1;
    hay = 1;
|ERROR10;
|FPRC;

|PROCESO lee_capital0;
    hay = 0;
|FPRC;

|DEFBUCLE lee_capital;
 #1#1;
 13;
 nume1,  1, "H";
 nume1, 99, "H";
 e;
 lee_capital0, lee_capital1;
|FIN;

|CALCULO impresio1;
#2#0 = #0x;
|LEE 040#2=;
|SI FSalida ! 0; |ACABA; |FINSI;
|SI #2#4 = "S";  |ACABA; |FINSI;          || residente

#5#0 = #2#40;
#5#1 = #2#41;
|LEE 040#5=;
|SI FSalida ! 0; |DDEFECTO #5; |FINSI;    || datos hacienda

    nume1 = #0x;
|BUCLE lee_capital;                       || lee capital inmobiliario
|SI hay = 0;     |ACABA;   |FINSI;

#4#0 = #2#44;
|LEE 040#4=;
|SI FSalida ! 0; |DDEFECTO #4; |FINSI;    || lee representante

calle_i = #4#3; |QBF calle_i;
|SI calle_i ! "";
    |DDEFECTO #7;
    #7#0 = #4#5;
    #7#1 = #4#6;
    |LEE 000#7=;                              || poblacion/provincia
        pobla = #7#3;
    |QBF pobla;
        pobla = ("                         " + pobla) % -125;

    sg_i        = "";
    calle_i     = #4#3;
    numero_i    = #4#4;
    escalera_i  = "";
    piso_i      = "";
    puerta_i    = "";
    telefono_i  = #4#9;
    cod_prov_i  = #4#5;
    cod_pobl_i  = #4#6;
    poblacion_i = #7#3;
    provincia_i = #7#2;
|SINO;
    |DDEFECTO #7;
    #7#0 = #2#12;
    #7#1 = #2#13;
    |LEE 000#7=;                              || poblacion/provincia
        pobla = #7#3;
    |QBF pobla;
        pobla = ("                         " + pobla) % -125;

    sg_i        = #2#6;
    calle_i     = #2#7;
    numero_i    = #2#8;
    escalera_i  = #2#9;
    piso_i      = #2#10;
    puerta_i    = #2#11;
    telefono_i  = #2#15;
    cod_prov_i  = #2#12;
    cod_pobl_i  = #2#13;
    poblacion_i = #7#3;
    provincia_i = #7#2;
|FINSI;

|HAZ limpia;
|HAZ calculo;
|FCAL;


|PROCESO impre; |TIPO 3;
  |HAZ fechapre;
  |ABRE #6;
  |LEE 000#6p;
  |SI FSalida ! 0;
      |MENAV "    ATENCION!!! Tarifas Patrimonio vacias ...";
      |CIERRA #6;
      |ACABA;
  |FINSI;
  |IMPRE 0;
  |SI FSalida ! 0;  |CIERRA #6;  |ACABA;  |FINSI;
  |ABRE #2;
  |ABRE #4;
  |ABRE #5;
  |ABRE #7;
  |PARA x = 0; |SI x [ 17; |HACIENDO x = x + 1;
        |SI #0x ! 0;
            |HAZ impresio1;
        |FINSI;
  |SIGUE;
  |CIERRA #2;
  |CIERRA #4;
  |CIERRA #5;
  |CIERRA #6;
  |CIERRA #7;
  |FINIMP;
|FPRC;

|PROCESO fechapre;
    diap  = #0#18 % 102;
    anyop = #0#18 % -102;
    mesp  = #0#18 % 402;
|SI mesp = "01"; mespl = "Enero     "; |FINSI;
|SI mesp = "02"; mespl = "Febrero   "; |FINSI;
|SI mesp = "03"; mespl = "Marzo     "; |FINSI;
|SI mesp = "04"; mespl = "Abril     "; |FINSI;
|SI mesp = "05"; mespl = "Mayo      "; |FINSI;
|SI mesp = "06"; mespl = "Junio     "; |FINSI;
|SI mesp = "07"; mespl = "Julio     "; |FINSI;
|SI mesp = "08"; mespl = "Agosto    "; |FINSI;
|SI mesp = "09"; mespl = "Septiembre"; |FINSI;
|SI mesp = "10"; mespl = "Octubre   "; |FINSI;
|SI mesp = "11"; mespl = "Noviembre "; |FINSI;
|SI mesp = "12"; mespl = "Diciembre "; |FINSI;

    alfa1 = "01.01." + #0#19;
    inicio = alfa1;
|FPRC;
