|FICHEROS;
      rew99999 #999;

     &refere1@ #1001;
     &refere2@ #1002;
     &referr3@ #1003;

      refere3@ #0;
      refere4@ #1;
      refere5@ #2;
      refere6@ #3;
      refere7@ #4;
|FIN;

|VARIABLES;
      aDef             = "";
      aAlfa            = "";
      aFichero         = "";

      nCoefi           = 0;
      nSwFich          = 0;
      nLinea           = 0;
      nCampo           = 0;
      nCampo1          = 0;
      nCampo2          = 0;

     &enEmpresa        = 0;
     &enComplementaria = 0;
     &eaPathDef        = "";
     &eaContri         = "";
     &enMinusvalia     = 0;
     &eaMinuAyuda      = "";
     &enBloque         = 0;
     &eaCasilla        = "";
     &enImporte        = 0;
     &enSwAcum         = 0;
     &enNomeDat        = 0;
     &enNomeAgr        = 0;
     &eaMuerto         = "";
     &efFechaMuerto    = @;
     &enCalcuMuerto    = 0;
     &eaPrograma       = "";
     &enLinea          = 0;
     &eaObserva        = "";
|FIN;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
||                        PUNTO E1
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO NormalE1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     #1#3 = 99;
     |LEE 040#1];
     |SI FSalida = 0;
         |LEE 040#1a;
     |SINO;
         |LEE 040#1u;
     |FINSI;

     |SI FSalida = 0; |Y #1#0 = #1001#0; |Y #1#1 = #1001#1; |Y #1#2 = #1001#2;
         nLinea = #1#3 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #1;
     #1#0  = #1001#0;
     #1#1  = #1001#1;
     #1#2  = #1001#2;
     #1#3  = nLinea;
     #1#4  = eaContri;
     |SI #1#2 = "CONJUNTA  ";
         #1#4 = #0#2;
         |SI #1#4 = "VARIOS    ";  #1#4 = "COMUNES";  |FINSI;
         |SI #1#4 = "GANANCIAL ";  #1#4 = "COMUNES";  |FINSI;
     |FINSI;

                       #1#5 = #0#17;
     |SI #0#16 = "S";  #1#6 = "X";  |FINSI;
                       #1#7  = #0#19;

     #1#10 = (N\ #0#26 % nCoefi);
     #1#11 = (N\ #0#27 % nCoefi);
     #1#12 = (N\ #0#28 % nCoefi);
     #1#13 = (N\ #0#29 % nCoefi);
     #1#14 = (N\ #0#30 % nCoefi);
     #1#15 = (N\ #0#31 % nCoefi);
     #1#16 = (N\ #0#32 % nCoefi);
     #1#17 = (N\ #0#33 % nCoefi);
     #1#18 = (N\ #0#34 % nCoefi);
     #1#19 = (N\ #0#35 % nCoefi);
     #1#20 = (N\ #0#36 % nCoefi);
     #1#21 = (N\ #0#37 % nCoefi);
     #1#22 = (N\ #0#38 % nCoefi);
     #1#23 = (N\ #0#39 % nCoefi);
     #1#24 = (N\ #0#40 % nCoefi);
     #1#25 = (N\ #0#41 % nCoefi);
     #1#26 = (N\ #0#42 % nCoefi);
     #1#27 = (N\ #0#43 % nCoefi);
     #1#28 = (N\ #0#44 % nCoefi);
     #1#29 = (N\ #0#45 % nCoefi);
     #1#30 = (N\ #0#47 % nCoefi);
     #1#31 = (N\ #0#48 % nCoefi);

     |GRABA 020#1n;
     |LIBERA #1;

     enBloque  = 5;
     enSwAcum  = 1;
     eaCasilla = " 18";  enImporte = #1#31;   |HAZ GrabaLineal;

     |DDEFECTO #3;
     #3#0  = #1001#0;
     #3#1  = #1001#1;
     #3#2  = #1001#2;
     |LEE 101#3=;
     |SI FSalida ! 0;
         |DDEFECTO #3;
         #3#0  = #1001#0;
         #3#1  = #1001#1;
         #3#2  = #1001#2;
         |GRABA 020#3b;
     |FINSI;

     #3#7 = (N\ #3#7 + #1#29);

     |GRABA 020#3a;
     |LIBERA #3;
|FPRC;

|PROCESO ComuneE1;
     #2#0 = #1001#0;
     #2#1 = #1001#1;
     #2#2 = #1001#2;
     #2#3 = 99;
     |LEE 040#2];
     |SI FSalida = 0;
         |LEE 040#2a;
     |SINO;
         |LEE 040#2u;
     |FINSI;

     |SI FSalida = 0; |Y #2#0 = #1001#0; |Y #2#1 = #1001#1; |Y #2#2 = #1001#2;
         nLinea = #2#3 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #2;
     #2#0  = #1001#0;
     #2#1  = #1001#1;
     #2#2  = #1001#2;
     #2#3  = nLinea;
     #2#4  = eaContri;
     |SI #2#2 = "CONJUNTA  ";
         #2#4 = #0#2;
         |SI #2#4 = "VARIOS    ";  #2#4 = "COMUNES";  |FINSI;
         |SI #2#4 = "GANANCIAL ";  #2#4 = "COMUNES";  |FINSI;
     |FINSI;

     #2#5 = #0#17;
     #2#6 = #0#21;
     #2#7 = #0#19;

     #2#10 = #0#15;
     #2#11 = (N\ (#0#45 % nCoefi) % #0#15);
     #2#12 = (N\ (#0#48 % nCoefi) % #0#15);
     #2#13 = (N\ (#0#47 % nCoefi) % #0#15);

     |GRABA 020#2n;
     |LIBERA #2;

     enBloque  = 5;
     enSwAcum  = 1;
     eaCasilla = " 18";  enImporte = #2#12;   |HAZ GrabaLineal;

     |DDEFECTO #3;
     #3#0  = #1001#0;
     #3#1  = #1001#1;
     #3#2  = #1001#2;
     |LEE 101#3=;
     |SI FSalida ! 0;
         |DDEFECTO #3;
         #3#0  = #1001#0;
         #3#1  = #1001#1;
         #3#2  = #1001#2;
         |GRABA 020#3b;
     |FINSI;

     #3#8 = (N\ #3#8 + #2#11);

     |GRABA 020#3a;
     |LIBERA #3;
|FPRC;

|PROCESO LiquidaE1;
     |SI #0#14 = "N";  |HAZ NormalE1;  |FINSI;
     |SI #0#14 = "S";  |HAZ ComuneE1;  |FINSI;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
||                        PUNTO E2
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO NormalE2;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     #1#3 = 99;
     |LEE 040#1];
     |SI FSalida = 0;
         |LEE 040#1a;
     |SINO;
         |LEE 040#1u;
     |FINSI;

     |SI FSalida = 0; |Y #1#0 = #1001#0; |Y #1#1 = #1001#1; |Y #1#2 = #1001#2;
         nLinea = #1#3 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #1;
     #1#0  = #1001#0;
     #1#1  = #1001#1;
     #1#2  = #1001#2;
     #1#3  = nLinea;
     #1#4  = eaContri;
     |SI #1#2 = "CONJUNTA  ";
         #1#4 = #0#2;
         |SI #1#4 = "VARIOS    ";  #1#4 = "COMUNES";  |FINSI;
         |SI #1#4 = "GANANCIAL ";  #1#4 = "COMUNES";  |FINSI;
     |FINSI;

                       #1#5 = #0#17;
     |SI #0#16 = "S";  #1#6 = "X";  |FINSI;
                       #1#7 = #0#19;

     #1#10 = (N\ #0#26 % nCoefi);
     #1#11 = (N\ #0#27 % nCoefi);
     #1#12 = (N\ #0#28 % nCoefi);
     #1#13 = (N\ #0#29 % nCoefi);
     #1#14 = (N\ #0#30 % nCoefi);
     #1#15 = (N\ #0#31 % nCoefi);
     #1#16 = (N\ #0#32 % nCoefi);
     #1#17 = (N\ #0#33 % nCoefi);
     #1#18 = (N\ #0#34 % nCoefi);
     #1#19 = (N\ #0#35 % nCoefi);
     #1#20 = (N\ #0#36 % nCoefi);
     #1#21 = (N\ #0#37 % nCoefi);
     #1#22 = (N\ #0#38 % nCoefi);
     #1#23 = (N\ #0#39 % nCoefi);
     #1#24 = (N\ #0#40 % nCoefi);
     #1#25 = (N\ #0#41 % nCoefi);
     #1#26 = (N\ #0#42 % nCoefi);
     #1#27 = (N\ #0#43 % nCoefi);
     #1#28 = (N\ #0#44 % nCoefi);
     #1#29 = (N\ #0#45 % nCoefi);
     #1#30 = (N\ #0#47 % nCoefi);
     #1#31 = (N\ #0#48 % nCoefi);

     |GRABA 020#1n;
     |LIBERA #1;

     enBloque  = 5;
     enSwAcum  = 1;
     eaCasilla = " 19";  enImporte = #1#31;   |HAZ GrabaLineal;

     |DDEFECTO #3;
     #3#0  = #1001#0;
     #3#1  = #1001#1;
     #3#2  = #1001#2;
     |LEE 101#3=;
     |SI FSalida ! 0;
         |DDEFECTO #3;
         #3#0  = #1001#0;
         #3#1  = #1001#1;
         #3#2  = #1001#2;
         |GRABA 020#3b;
     |FINSI;

     #3#9 = (N\ #3#9 + #1#29);

     |GRABA 020#3a;
     |LIBERA #3;
|FPRC;

|PROCESO ComuneE2;
     #2#0 = #1001#0;
     #2#1 = #1001#1;
     #2#2 = #1001#2;
     #2#3 = 99;
     |LEE 040#2];
     |SI FSalida = 0;
         |LEE 040#2a;
     |SINO;
         |LEE 040#2u;
     |FINSI;

     |SI FSalida = 0; |Y #2#0 = #1001#0; |Y #2#1 = #1001#1; |Y #2#2 = #1001#2;
         nLinea = #2#3 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #2;
     #2#0  = #1001#0;
     #2#1  = #1001#1;
     #2#2  = #1001#2;
     #2#3  = nLinea;
     #2#9  = eaContri;
     |SI #2#2 = "CONJUNTA  ";
         #2#9 = #0#2;
         |SI #2#9 = "VARIOS    ";  #2#9 = "COMUNES";  |FINSI;
         |SI #2#9 = "GANANCIAL ";  #2#9 = "COMUNES";  |FINSI;
     |FINSI;

     #2#4  = #0#17;
     #2#5  = #0#21;
     #2#6  = #0#19;
     #2#10 = #0#15;

     #2#11 = (N\ (#0#45 % nCoefi) % #0#15);
     #2#12 = (N\ (#0#48 % nCoefi) % #0#15);
     #2#13 = (N\ (#0#47 % nCoefi) % #0#15);

     |GRABA 020#2n;
     |LIBERA #2;

     enBloque  = 5;
     enSwAcum  = 1;
     eaCasilla = " 19";  enImporte = #2#12;   |HAZ GrabaLineal;

     |DDEFECTO #3;
     #3#0  = #1001#0;
     #3#1  = #1001#1;
     #3#2  = #1001#2;
     |LEE 101#3=;
     |SI FSalida ! 0;
         |DDEFECTO #3;
         #3#0  = #1001#0;
         #3#1  = #1001#1;
         #3#2  = #1001#2;
         |GRABA 020#3b;
     |FINSI;

     #3#10 = (N\ #3#10 + #2#11);

     |GRABA 020#3a;
|FPRC;

|PROCESO LiquidaE2;
     |SI #0#14 = "N";  |HAZ NormalE2;  |FINSI;
     |SI #0#14 = "S";  |HAZ ComuneE2;  |FINSI;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
||                        PUNTO E3
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO LiquidaE3;
     |DDEFECTO #1;
     #1#0  = #1001#0;
     #1#1  = #1001#1;
     #1#2  = #1001#2;
     |LEE 101#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         #1#0  = #1001#0;
         #1#1  = #1001#1;
         #1#2  = #1001#2;
         |GRABA 020#1b;
     |FINSI;

     #1#3  = (N\ #1#3 + (#0#11 % nCoefi));
     #1#4  = (N\ #1#4 + (#0#12 % nCoefi));
     #1#5  = (N\ #1#5 + (#0#13 % nCoefi));
     #1#6  = (N\ #1#6 + (#0#14 % nCoefi));

     |GRABA 020#1a;
     |LIBERA #1;

     enBloque  = 5;
     enSwAcum  = 0;
     eaCasilla = " 20";  enImporte = #1#6;   |HAZ GrabaLineal;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
||                        PUNTO E4
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO NormalE4;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     #1#3 = 99;
     |LEE 040#1];
     |SI FSalida = 0;
         |LEE 040#1a;
     |SINO;
         |LEE 040#1u;
     |FINSI;

     |SI FSalida = 0; |Y #1#0 = #1001#0; |Y #1#1 = #1001#1; |Y #1#2 = #1001#2;
         nLinea = #1#3 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #1;
     #1#0  = #1001#0;
     #1#1  = #1001#1;
     #1#2  = #1001#2;
     #1#3  = nLinea;
     #1#4  = #0#17;
     #1#5  = eaContri;
     |SI #1#2 = "CONJUNTA  ";
         #1#5 = #0#2;
         |SI #1#5 = "VARIOS    ";  #1#5 = "COMUNES";  |FINSI;
         |SI #1#5 = "GANANCIAL ";  #1#5 = "COMUNES";  |FINSI;
     |FINSI;

     #1#6  = #0#24;  #1#7  = (N\ #0#31 % nCoefi);  #1#8  = (N\ #0#45 % nCoefi);
     #1#9  = #0#25;  #1#10 = (N\ #0#32 % nCoefi);  #1#11 = (N\ #0#46 % nCoefi);
     #1#12 = #0#26;  #1#13 = (N\ #0#33 % nCoefi);  #1#14 = (N\ #0#47 % nCoefi);
     #1#15 = #0#27;  #1#16 = (N\ #0#34 % nCoefi);  #1#17 = (N\ #0#48 % nCoefi);
     #1#18 = #0#28;  #1#19 = (N\ #0#35 % nCoefi);  #1#20 = (N\ #0#49 % nCoefi);
     #1#21 = #0#29;  #1#22 = (N\ #0#36 % nCoefi);  #1#23 = (N\ #0#50 % nCoefi);
     #1#24 = #0#30;  #1#25 = (N\ #0#37 % nCoefi);  #1#26 = (N\ #0#51 % nCoefi);

     #1#27 = (N\ #0#52 % nCoefi);
     #1#28 = (N\ #0#64 % nCoefi);
     #1#29 = (N\ #0#78 % nCoefi);
     #1#30 = (N\ #0#79 % nCoefi);
     |SI #0#80 ! 0;  #1#31 = #0#80;  |FINSI;
     |SI #0#82 ! 0;  #1#31 = #0#82;  |FINSI;
     |SI #0#84 ! 0;  #1#31 = #0#84;  |FINSI;
     |SI #0#86 ! 0;  #1#31 = #0#86;  |FINSI;
     #1#32 = #0#88;
     #1#33 = #0#91;
     #1#34 = 0;
     |SI #0#94 ! 0;  #1#34 = 1.30;  |FINSI;
     #1#35 = #0#96;
     #1#36 = (N\ #0#98  % nCoefi);
     #1#37 = (N\ #0#109 % nCoefi);
     #1#38 = (N\ #0#110 % nCoefi);
     #1#40 = (N\ #0#113 % nCoefi);
     #1#41 = (N\ #0#114 % nCoefi);
     #1#42 = (N\ #0#116 % nCoefi);
     #1#43 = (N\ #0#117 % nCoefi);

     |GRABA 020#1n;
     |LIBERA #1;

     enBloque  = 5;
     enSwAcum  = 1;
     eaCasilla = " 21";  enImporte = #1#43;   |HAZ GrabaLineal;

     |DDEFECTO #3;
     #3#0  = #1001#0;
     #3#1  = #1001#1;
     #3#2  = #1001#2;
     |LEE 101#3=;
     |SI FSalida ! 0;
         |DDEFECTO #3;
         #3#0  = #1001#0;
         #3#1  = #1001#1;
         #3#2  = #1001#2;
         |GRABA 020#3b;
     |FINSI;

     #3#11 = (N\ #3#11 + #1#41);

     |GRABA 020#3a;
|FPRC;

|PROCESO ComuneE4;
     #2#0 = #1001#0;
     #2#1 = #1001#1;
     #2#2 = #1001#2;
     #2#3 = 99;
     |LEE 040#2];
     |SI FSalida = 0;
         |LEE 040#2a;
     |SINO;
         |LEE 040#2u;
     |FINSI;

     |SI FSalida = 0; |Y #2#0 = #1001#0; |Y #2#1 = #1001#1; |Y #2#2 = #1001#2;
         nLinea = #2#3 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #2;
     #2#0  = #1001#0;
     #2#1  = #1001#1;
     #2#2  = #1001#2;
     #2#3  = nLinea;
     #2#4  = eaContri;
     |SI #2#2 = "CONJUNTA  ";
         #2#4 = #0#2;
         |SI #2#4 = "VARIOS    ";  #2#4 = "COMUNES";  |FINSI;
         |SI #2#4 = "GANANCIAL ";  #2#4 = "COMUNES";  |FINSI;
     |FINSI;
     #2#5  = #0#19;
     #2#6  = #0#17;
     #2#7  = #0#15;
     #2#8  = (N\ (#0#114 % nCoefi) % #0#15);
     #2#9  = (N\ (#0#117 % nCoefi) % #0#15);

     |GRABA 020#2n;
     |LIBERA #2;

     enBloque  = 5;
     enSwAcum  = 1;
     eaCasilla = " 21";  enImporte = #2#9;   |HAZ GrabaLineal;

     |DDEFECTO #3;
     #3#0  = #1001#0;
     #3#1  = #1001#1;
     #3#2  = #1001#2;
     |LEE 101#3=;
     |SI FSalida ! 0;
         |DDEFECTO #3;
         #3#0  = #1001#0;
         #3#1  = #1001#1;
         #3#2  = #1001#2;
         |GRABA 020#3b;
     |FINSI;

     #3#12 = (N\ #3#12 + #2#8);

     |GRABA 020#3a;
|FPRC;

|PROCESO LiquidaE4;
     |SI #0#14 = "N";  |HAZ NormalE4;  |FINSI;
     |SI #0#14 = "S";  |HAZ ComuneE4;  |FINSI;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
||                        PUNTO E5
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO PonProductos;
     nCampo   = ((#3#3 - 1) * 3) + 7;
     nCampo1  = nCampo + 1;
     nCampo2  = nCampo + 2;

     #1nCampo  = (N\ (#1nCampo  + (#3#6 % nCoefi)));
     #1nCampo2 = (N\ (#1nCampo2 + (#3#7 % nCoefi)));
     #1nCampo1 = (N\ (#1nCampo2 / #1nCampo));
|FPRC;

|PROCESO NormalE5;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     #1#3 = 99;
     |LEE 040#1];
     |SI FSalida = 0;
         |LEE 040#1a;
     |SINO;
         |LEE 040#1u;
     |FINSI;

     |SI FSalida = 0; |Y #1#0 = #1001#0; |Y #1#1 = #1001#1; |Y #1#2 = #1001#2;
         nLinea = #1#3 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #1;
     #1#0  = #1001#0;
     #1#1  = #1001#1;
     #1#2  = #1001#2;
     #1#3  = nLinea;
     |SI #0#16 = "S";  #1#4 = "X";  |FINSI;
     #1#5  = #0#17;
     #1#6  = eaContri;
     |SI #1#2 = "CONJUNTA  ";
         #1#6 = #0#2;
         |SI #1#6 = "VARIOS    ";  #1#6 = "COMUNES";  |FINSI;
         |SI #1#6 = "GANANCIAL ";  #1#6 = "COMUNES";  |FINSI;
     |FINSI;

     #3#0 = #0#0;
     #3#1 = #0#1;
     #3#2 = 1;
     |LEE 040#3];
     |PARA; |SI FSalida = 0;  |Y #3#0 = #0#0; |Y #3#1 = #0#1;  |HACIENDO;
            |HAZ PonProductos;
            |LEE 040#3s;
     |SIGUE;

     #1#46 = (N\ #0#25 % nCoefi);
     #1#47 = (N\ #0#30 % nCoefi);
     #1#58 = (N\ #0#58 % nCoefi);
     #1#48 = (N\ #0#33 % nCoefi);
     #1#49 = (N\ #0#34 % nCoefi);
     #1#50 = (N\ #0#35 % nCoefi);
     #1#51 = (N\ #0#36 % nCoefi);
     #1#52 = (N\ #0#37 % nCoefi);
     #1#53 = (N\ #0#38 % nCoefi);
     #1#54 = (N\ #0#54 % nCoefi);
     #1#55 = (N\ #0#39 % nCoefi);
     #1#56 = (N\ #0#55 % nCoefi);
     #1#57 = (N\ #0#40 % nCoefi);
     #1#59 = (N\ #0#43 % nCoefi);
     #1#60 = (N\ #0#44 % nCoefi);
     #1#62 = (N\ #0#48 % nCoefi);
     #1#63 = (N\ #0#49 % nCoefi);
     #1#64 = (N\ #0#51 % nCoefi);
     #1#65 = (N\ #0#52 % nCoefi);

     |GRABA 020#1n;
     |LIBERA #1;

     enBloque  = 5;
     enSwAcum  = 1;
     eaCasilla = " 22";  enImporte = #1#46;   |HAZ GrabaLineal;
     eaCasilla = " 23";  enImporte = #1#65;   |HAZ GrabaLineal;

     |DDEFECTO #4;
     #4#0  = #1001#0;
     #4#1  = #1001#1;
     #4#2  = #1001#2;
     |LEE 101#4=;
     |SI FSalida ! 0;
         |DDEFECTO #4;
         #4#0  = #1001#0;
         #4#1  = #1001#1;
         #4#2  = #1001#2;
         |GRABA 020#4b;
     |FINSI;

     #4#13 = (N\ #4#13 + #1#63);

     |GRABA 020#4a;
|FPRC;

|PROCESO ComuneE5;
     #2#0 = #1001#0;
     #2#1 = #1001#1;
     #2#2 = #1001#2;
     #2#3 = 99;
     |LEE 040#2];
     |SI FSalida = 0;
         |LEE 040#2a;
     |SINO;
         |LEE 040#2u;
     |FINSI;

     |SI FSalida = 0; |Y #2#0 = #1001#0; |Y #2#1 = #1001#1; |Y #2#2 = #1001#2;
         nLinea = #2#3 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #2;
     #2#0  = #1001#0;
     #2#1  = #1001#1;
     #2#2  = #1001#2;
     #2#3  = nLinea;
     #2#4  = #0#20;
     #2#5  = eaContri;
     |SI #2#2 = "CONJUNTA  ";
         #2#5 = #0#2;
         |SI #2#5 = "VARIOS    ";  #2#5 = "COMUNES";  |FINSI;
         |SI #2#5 = "GANANCIAL ";  #2#5 = "COMUNES";  |FINSI;
     |FINSI;
     #2#6  = #0#15;
     #2#7  = (N\ (#0#49 % nCoefi) % #0#15);
     #2#8  = (N\ (#0#52 % nCoefi) % #0#15);

     |GRABA 020#2n;
     |LIBERA #2;

     enBloque  = 5;
     enSwAcum  = 1;
     eaCasilla = " 23";  enImporte = #2#8;  |HAZ GrabaLineal;

     |DDEFECTO #4;
     #4#0  = #1001#0;
     #4#1  = #1001#1;
     #4#2  = #1001#2;
     |LEE 101#4=;
     |SI FSalida ! 0;
         |DDEFECTO #4;
         #4#0  = #1001#0;
         #4#1  = #1001#1;
         #4#2  = #1001#2;
         |GRABA 020#4b;
     |FINSI;

     #4#14 = (N\ #4#14 + #2#7);

     |GRABA 020#4a;
|FPRC;

|PROCESO LiquidaE5;
     |SI #0#14 = "N";  |HAZ NormalE5;  |FINSI;
     |SI #0#14 = "S";  |HAZ ComuneE5;  |FINSI;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
||                        PUNTO E6
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO LiquidaE6;
     enSwAcum  = 1;
     enBloque  = 24;
     eaCasilla = " 95";  enImporte = #0#15 % nCoefi;   |HAZ GrabaLineal;
     eaCasilla = " 96";  enImporte = (#0#11 + #0#12 + #0#13 + #0#14) % nCoefi;
     |HAZ GrabaLineal;
|FPRC;

|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
||                   PROCESOS DE SELECCION
|| 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO Liquida2;
     |HAZ CreaLiquida;               || En el rezcalut

     |SI nSwFich = 1;  |HAZ LiquidaE1;  |FINSI;
     |SI nSwFich = 2;  |HAZ LiquidaE2;  |FINSI;
     |SI nSwFich = 3;  |HAZ LiquidaE3;  |FINSI;
     |SI nSwFich = 4;  |HAZ LiquidaE4;  |FINSI;
     |SI nSwFich = 5;  |HAZ LiquidaE5;  |FINSI;
     |SI nSwFich = 6;  |HAZ LiquidaE6;  |FINSI;
|FPRC;

|PROCESO Seleccion2;
     |SI #0#2 = "GANANCIAL ";                || Si es Ganancial
         nCoefi = 50;  eaContri = "TITULAR   ";   |HAZ Liquida2;
         nCoefi = 50;  eaContri = "CONYUGE   ";   |HAZ Liquida2;
         nCoefi = 100; eaContri = "CONJUNTA  ";   |HAZ Liquida2;

         |SI eaMuerto ! "";
             nCoefi = 50;  eaContri = "CONJUNTAE ";   |HAZ Liquida2;
         |FINSI;

         |ACABA;
     |FINSI;

     |SI #0#2 ! "VARIOS    ";                || SI es TITULAR O CONYUGE;
         nCoefi = 100;  eaContri = #0#2;          |HAZ Liquida2;
         nCoefi = 100;  eaContri = "CONJUNTA  ";  |HAZ Liquida2;

         |SI eaMuerto = "T";  |Y #0#2 ! "TITULAR   ";
             nCoefi = 100;  eaContri = "CONJUNTAE ";   |HAZ Liquida2;
         |FINSI;

         |SI eaMuerto = "C";  |Y #0#2 ! "CONYUGE   ";
             nCoefi = 100;  eaContri = "CONJUNTAE ";   |HAZ Liquida2;
         |FINSI;
         |ACABA;
     |FINSI;
                                             || SI es Varios

     |SI #0#5  ! 0; nCoefi = #0#5;   eaContri = "TITULAR   ";  |HAZ Liquida2;  |FINSI;
     |SI #0#6  ! 0; nCoefi = #0#6;   eaContri = "CONYUGE   ";  |HAZ Liquida2;  |FINSI;
     |SI #0#7  ! 0; nCoefi = #0#7;   eaContri = "1 FAMILIAR";  |HAZ Liquida2;  |FINSI;
     |SI #0#8  ! 0; nCoefi = #0#8;   eaContri = "2 FAMILIAR";  |HAZ Liquida2;  |FINSI;
     |SI #0#9  ! 0; nCoefi = #0#9;   eaContri = "3 FAMILIAR";  |HAZ Liquida2;  |FINSI;
     |SI #0#10 ! 0; nCoefi = #0#10;  eaContri = "4 FAMILIAR";  |HAZ Liquida2;  |FINSI;

     nCoefi  = #0#5 + #0#6 + #0#7 + #0#8 + #0#9 + #0#10;
     eaContri = "CONJUNTA  "; |HAZ Liquida2;

     |SI eaMuerto = "T";
         nCoefi  = #0#6 + #0#7 + #0#8 + #0#9 + #0#10;
         eaContri = "CONJUNTAE "; |HAZ Liquida2;
     |FINSI;

     |SI eaMuerto = "C";
         nCoefi  = #0#5 + #0#7 + #0#8 + #0#9 + #0#10;
         eaContri = "CONJUNTAE "; |HAZ Liquida2;
     |FINSI;
|FPRC;

|PROCESO PuntoE1;
     nSwFich = 1;
     aDef    = eaPathDef + "rem00025.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01014.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere4@#"zdat1014"#;  |FINSI;

     aDef    = eaPathDef + "rem01015.mas";
     |CARGA_DEF aDef, refere5@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere5@#"zdat1015"#;  |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, refere6@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere6@#"zdat1018"#;  |FINSI;

     |ABRE #1;
     |ABRE #2;
     |ABRE #3;
     |ABRE #0;
     |DDEFECTO #0;
     #0#0 = enEmpresa;
     #0#1 = 1;
     |LEE 040#0];
     |PARA; |SI FSalida = 0;  |Y #0#0 = enEmpresa;  |HACIENDO;
            |SI #0#3 = "R";  |O #0#3 = "A";   |HAZ Seleccion2;  |FINSI;
            |SI #0#3 = "X";
                eaPrograma = "rem00025";
                enLinea    = #0#1;
                eaObserva  = "(E1) ACTIVIDADES EN MODALIDAD NORMAL";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#0s;
     |SIGUE;
     |CIERRA #0;
     |CIERRA #1;
     |CIERRA #2;
     |CIERRA #3;

     |DESCARGA_DEF #refere6@;
     |DESCARGA_DEF #refere5@;
     |DESCARGA_DEF #refere4@;
     |DESCARGA_DEF #refere3@;
|FPRC;

|PROCESO PuntoE2;
     nSwFich = 2;
     aDef    = eaPathDef + "rem00026.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01016.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere4@#"zdat1016"#;  |FINSI;

     aDef    = eaPathDef + "rem01017.mas";
     |CARGA_DEF aDef, refere5@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere5@#"zdat1017"#;  |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, refere6@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere6@#"zdat1018"#;  |FINSI;

     |ABRE #1;
     |ABRE #2;
     |ABRE #3;
     |ABRE #0;
     |DDEFECTO #0;
     #0#0 = enEmpresa;
     #0#1 = 1;
     |LEE 040#0];
     |PARA; |SI FSalida = 0;  |Y #0#0 = enEmpresa;  |HACIENDO;
            |SI #0#3 = "R";  |O #0#3 = "A";   |HAZ Seleccion2;  |FINSI;
            |SI #0#3 = "X";
                eaPrograma = "rem00026";
                enLinea    = #0#1;
                eaObserva  = "(E2) ACTIVIDADES EN MODALIDAD SIMPLIFICADA";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#0s;
     |SIGUE;
     |CIERRA #0;
     |CIERRA #1;
     |CIERRA #2;
     |CIERRA #3;

     |DESCARGA_DEF #refere6@;
     |DESCARGA_DEF #refere5@;
     |DESCARGA_DEF #refere4@;
     |DESCARGA_DEF #refere3@;
|FPRC;

|PROCESO PuntoE3;
     nSwFich = 3;
     aDef    = eaPathDef + "rem00030.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere4@#"zdat1018"#;  |FINSI;

     |ABRE #1;
     |ABRE #0;
     |DDEFECTO #0;
     #0#0 = enEmpresa;
     #0#1 = 1;
     |LEE 040#0];
     |PARA; |SI FSalida = 0;  |Y #0#0 = enEmpresa;  |HACIENDO;
            |SI #0#3 = "R";  |O #0#3 = "A";   |HAZ Seleccion2;  |FINSI;
            |SI #0#3 = "X";
                eaPrograma = "rem00030";
                enLinea    = #0#1;
                eaObserva  = "(E3) ACTIVIDADES INCENTIVO AL MECENAZGO";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#0s;
     |SIGUE;
     |CIERRA #0;
     |CIERRA #1;

     |DESCARGA_DEF #refere4@;
     |DESCARGA_DEF #refere3@;
|FPRC;

|PROCESO PuntoE4;
     nSwFich = 4;
     aDef    = eaPathDef + "rem00027.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01019.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere4@#"zdat1019"#;  |FINSI;

     aDef    = eaPathDef + "rem01020.mas";
     |CARGA_DEF aDef, refere5@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere5@#"zdat1020"#;  |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, refere6@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere6@#"zdat1018"#;  |FINSI;

     |ABRE #1;
     |ABRE #2;
     |ABRE #3;
     |ABRE #0;
     |DDEFECTO #0;
     #0#0 = enEmpresa;
     #0#1 = 1;
     |LEE 040#0];
     |PARA; |SI FSalida = 0;  |Y #0#0 = enEmpresa;  |HACIENDO;
            |SI #0#3 = "R";  |O #0#3 = "A";   |HAZ Seleccion2;  |FINSI;
            |SI #0#3 = "X";
                eaPrograma = "rem00027";
                enLinea    = #0#1;
                eaObserva  = "(E4) ACTIVIDADES EN MODULOS";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#0s;
     |SIGUE;
     |CIERRA #0;
     |CIERRA #1;
     |CIERRA #2;
     |CIERRA #3;

     |DESCARGA_DEF #refere6@;
     |DESCARGA_DEF #refere5@;
     |DESCARGA_DEF #refere4@;
     |DESCARGA_DEF #refere3@;
|FPRC;

|PROCESO PuntoE5;
     nSwFich = 5;

     aDef    = eaPathDef + "rem00028.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeAgr = 1;
         |NOME_DAT #refere3@#"zzm00028"#;
     |FINSI;

     aDef    = eaPathDef + "rem01021.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere4@#"zdat1021"#;  |FINSI;

     aDef    = eaPathDef + "rem01022.mas";
     |CARGA_DEF aDef, refere5@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere5@#"zdat1022"#;  |FINSI;

     aDef    = eaPathDef + "rem00029.mas";
     |CARGA_DEF aDef, refere6@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeAgr = 1;
         |NOME_DAT #refere6@#"zzm00029"#;
     |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, refere7@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere7@#"zdat1018"#;  |FINSI;

     |ABRE #0;
     |ABRE #1;
     |ABRE #2;
     |ABRE #3;
     |ABRE #4;
     |DDEFECTO #0;
     #0#0 = enEmpresa;
     #0#1 = 1;
     |LEE 040#0];
     |PARA; |SI FSalida = 0;  |Y #0#0 = enEmpresa;  |HACIENDO;
            |SI #0#3 = "R";  |O #0#3 = "A";   |HAZ Seleccion2;  |FINSI;
            |SI #0#3 = "X";
                eaPrograma = "rem00028";
                enLinea    = #0#1;
                eaObserva  = "(E5) ACTIVIDADES EN MODALIDAD AGRICOLA";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#0s;
     |SIGUE;
     |CIERRA #0;
     |CIERRA #1;
     |CIERRA #2;
     |CIERRA #3;
     |CIERRA #4;

     |DESCARGA_DEF #refere7@;
     |DESCARGA_DEF #refere6@;
     |DESCARGA_DEF #refere5@;
     |DESCARGA_DEF #refere4@;
     |DESCARGA_DEF #refere3@;
|FPRC;

|PROCESO PuntoE6;
     nSwFich = 6;
     aDef    = eaPathDef + "rem00031.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |ABRE #0;
     |DDEFECTO #0;
     #0#0 = enEmpresa;
     #0#1 = 1;
     |LEE 040#0];
     |PARA; |SI FSalida = 0;  |Y #0#0 = enEmpresa;  |HACIENDO;
            |SI #0#3 = "R";  |O #0#3 = "A";   |HAZ Seleccion2;  |FINSI;
            |SI #0#3 = "X";
                eaPrograma = "rem00031";
                enLinea    = #0#1;
                eaObserva  = "(E) PAGOS A CUENTA ACTIVIDADES ECONOMICAS";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#0s;
     |SIGUE;
     |CIERRA #0;

     |DESCARGA_DEF #refere3@;
|FPRC;

|PROCESO Bloque2;
     |HAZ PuntoE1;
     |HAZ PuntoE2;
     |HAZ PuntoE3;
     |HAZ PuntoE4;
     |HAZ PuntoE5;
     |HAZ PuntoE6;
|FPRC;
