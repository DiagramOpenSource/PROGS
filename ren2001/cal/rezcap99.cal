|FICHEROS;
     rezcap99 #0;
     repobibi #1;
     rem02000 #2;
     retabla1 #401;
     aficahor1@ #1001;
     aficahor2@ #1002;
     aficante1@ #991;
     aficante2@ #992;
     aficante3@ #993;
     aficante4@ #994;
|FIN;

|VARIABLES;
     aAlfa          = "";
     aAlfa1         = "";
     aAlfa2         = "";
     aDef           = "";
     aFichero       = "";
     aBaseRenta2001 = "";
     aFich          = "";

     nCampo         = 0;
     nCampoPase     = 0;
     nSuma          = 0;
     nSuma1         = 0;
     nAcciones      = 0;
     nAgru          = 0;
     nCasi          = 0;
     nImporte       = 0;
     nImpo          = 0;
     nCompara       = 0;
     nPatrones      = 0;

     &enCodCli      = 0;
     &enEmpresa     = 0;
     &eaPrograma    = "";
     &eaPunto       = "";
     &eaLetra       = "";
|FIN;

|PROCESO Directorios; |TIPO 7;
     |DBASS aAlfa;
     #0#0 = aAlfa + "ren2000";
     #0#1 = "fich";
     |PINTA #0#0;
     |PINTA #0#1;
|FPRC;

|PROCESO Parrilla;
     |SI enCodCli ! 0;  |ACABA;  |FINSI;

     |SI #0#2 = 0;
         #0#2 = 0;  |PINTA #0#2;
         #0#3 = 0;  |PINTA #0#3;  |C_M #0#3, 1, "N";
         |PARA nCampo = 4;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |SINO;
         |C_M #0#2, 1, "S";
         |C_M #0#3, 1, "S";
         |PARA nCampo = 4;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
               #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasContri;
     |SI enCodCli ! 0;  |ACABA;  |FINSI;

     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               #0Campo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO ModInmuebles;
     |C_M #0#29, 1, "S";
     |C_M #0#30, 1, "S";
     |C_M #0#32, 1, "S";
     |SI #0#25 = "N";  |O #0#32 = "N";
         |C_M #0#29, 1, "N";  #0#29 = "N";  |PINTA #0#29;
         |C_M #0#30, 1, "N";  #0#30 = "N";  |PINTA #0#30;
         |SI #0#25 = "N";
             |C_M #0#32, 1, "N";  #0#32 = "N";  |PINTA #0#32;
         |FINSI;
     |FINSI;

     |C_M #0#31, 1, "S";
     |SI #0#30 = "N";
         |C_M #0#31, 1, "N";  #0#31 = 0;    |PINTA #0#31;
     |FINSI;
|FPRC;

|PROCESO ModMobiliario;
     |C_M #0#33, 1, "S";
     |SI #0#26 = "N";
         |C_M #0#33, 1, "N";  #0#33 = "N";  |PINTA #0#33;
     |FINSI;
|FPRC;

|PROCESO ModPatrimonio;
     |C_M #0#34, 1, "S";
     |SI #0#28 = "N";
         |C_M #0#34, 1, "N";  #0#34 = "N";  |PINTA #0#34;
     |FINSI;
|FPRC;

||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| COPIA FICHEROS
||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO CopiaFichero;
     aAlfa1 = #0#0 + "/" + #0#1 + "/"  + aFichero + ".dat";  |QBT aAlfa1;
     aAlfa2 = aBaseRenta2001 + "fich/" + aFichero + ".dat";
     |COPIA_FICHERO aAlfa1, aAlfa2;

     aAlfa1 = #0#0 + "/" + #0#1 + "/"  + aFichero + ".ddx";  |QBT aAlfa1;
     aAlfa2 = aBaseRenta2001 + "fich/" + aFichero + ".ddx";
     |COPIA_FICHERO aAlfa1, aAlfa2;

     aAlfa1 = #0#0 + "/" + #0#1 + "/"  + aFichero + ".ixx";  |QBT aAlfa1;
     aAlfa2 = aBaseRenta2001 + "fich/" + aFichero + ".ixx";
     |COPIA_FICHERO aAlfa1, aAlfa2;
|FPRC;

|PROCESO Auxiliares;
     aDef = aBaseRenta2001 + "def/" + aFichero + ".mas";
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aFichero + " A쨚 2001 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |ABRE #1001;
     |LEE 040#1001p;
     |SI FSalida ! 0;
         |CIERRA #1001;
         |HAZ CopiaFichero;
     |FINSI;
     |CIERRA #1001;
     |DESCARGA_DEF #aficahor1@;
|FPRC;

||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|| TRAERSE RENTA
||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO Pasa101;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida ! 0;
         |PARA nCampoPase = 0;  |SI nCampoPase [ 15;  |HACIENDO nCampoPase = nCampoPase + 1;
               #1001nCampoPase = #992nCampoPase;
         |SIGUE;
         |GRABA 020#1001n;
     |SINO;
         |PARA nCampoPase = 0;  |SI nCampoPase [ 15;  |HACIENDO nCampoPase = nCampoPase + 1;
               #1001nCampoPase = #992nCampoPase;
         |SIGUE;
         |GRABA 020#1001a;
     |FINSI;
     |LIBERA #1001;
|FPRC;

|DEFBUCLE rem0010100;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa101;
|FIN;

|PROCESO DatosPersonales;
     aDef = #0#0 + "/def/rem00100.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00100 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #992;
     #992#0 = #991#0;
     |LEE 040#992=;
     |SI FSalida = 0;
         aDef = aBaseRenta2001 + "/def/rem00100.mas";  |QBT aDef;
         |CARGA_DEF aDef, aficahor1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def rem00100 A쨚 2001 ";
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |ABRE #1001;
         #1001#0 = #992#0;
         |LEE 101#1001=;
         |SI FSalida ! 0;
             |PARA nCampoPase = 0;  |SI nCampoPase [ 99;  |HACIENDO nCampoPase = nCampoPase + 1;
                   #1001nCampoPase = #992nCampoPase;
             |SIGUE;
             |GRABA 020#1001n;
         |SINO;
             |PARA nCampoPase = 0;  |SI nCampoPase [ 99;  |HACIENDO nCampoPase = nCampoPase + 1;
                   #1001nCampoPase = #992nCampoPase;
             |SIGUE;
             |GRABA 020#1001a;
         |FINSI;
         |LIBERA #1001;
         |CIERRA #1001;

         |DESCARGA_DEF #aficahor1@;
     |FINSI;
     |CIERRA #992;

     |DESCARGA_DEF #aficante2@;

     aDef = #0#0 + "/def/rem00101.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00101 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2001 + "/def/rem00101.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00101 A쨚 2001 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0010100;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;

     eaPrograma = "rem00100";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO Pasa020;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida ! 0;
         |DDEFECTO #1001;
         #1001#0 = #992#0;
         #1001#1 = #992#1;
         |GRABA 020#1001b;
     |FINSI;

     #1001#2  = #992#2;
     #1001#3  = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4  = 0;
     #1001#5  = #992#5;
     #1001#8  = #992#8;
     #1001#13 = #992#13;
     #1001#17 = #992#17;
     #1001#27 = #992#27;
     #1001#29 = #992#29;
     #1001#30 = #992#30;
     |GRABA 020#1001a;
     |LIBERA #1001;
|FPRC;

|DEFBUCLE rem0002000;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa020;
|FIN;

|PROCESO Trabajo;
     aDef = #0#0 + "/def/rem00020.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00020 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2001 + "/def/rem00020.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00020 A쨚 2001 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0002000;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;

     eaPrograma = "rem00020";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO Pasa021;
     |SI #992#24 = "S";  |ACABA;  |FINSI;

     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1;
     |FINSI;

     |DDEFECTO #1001;
     |SI #0#32 = "N";
         #1001#0   = #992#0;
         #1001#1   = #992#1;
         #1001#2   = #992#2;
         #1001#3   = "X";
         |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
         #1001#4   = 0;
         #1001#5   = #992#5;
         #1001#6   = #992#6;
         #1001#7   = #992#7;
         #1001#8   = #992#8;
         #1001#9   = #992#9;
         #1001#10  = #992#10;
         #1001#13  = #992#13;
         #1001#14  = #992#14;
         #1001#16  = #992#16;
         #1001#17  = #992#17;
         #1001#18  = #992#18;
         #1001#19  = #992#19;
         #1001#20  = #992#20;
         #1001#25  = #992#25;
         #1001#26  = (#992#26 / 166.386) ! 2;
         #1001#29  = (#992#29 / 166.386) ! 2;
         #1001#30  = #992#30;
         #1001#31  = #992#31;
         #1001#32  = #992#32;
         #1001#33  = #992#33;
         #1001#34  = #992#34;
         #1001#35  = #992#35;
         #1001#36  = #992#36;
         #1001#104 = #992#104;
         #1001#105 = #992#105;
         #1001#106 = #992#106;
     |SINO;
         #1001#0   = #992#0;
         #1001#1   = #992#1;
         #1001#2   = #992#2;
         #1001#3   = "X";
         |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
         #1001#4   = 0;
         #1001#5   = #992#5;
         #1001#6   = #992#6;
         #1001#7   = #992#7;
         #1001#8   = #992#8;
         #1001#9   = #992#9;
         #1001#10  = #992#10;
         #1001#13  = #992#13;
         #1001#14  = #992#14;
         #1001#15  = (#992#15 / 166.386) ! 2;
         #1001#16  = #992#16;
         #1001#17  = #992#17;
         #1001#18  = #992#18;
         #1001#19  = #992#19;
         #1001#20  = #992#20;
         #1001#21  = (#992#21  / 166.386) ! 2;
         #1001#22  = (#992#22  / 166.386) ! 2;
         #1001#23  = (#992#23  / 166.386) ! 2;
         #1001#25  = #992#25;
         #1001#26  = (#992#26  / 166.386) ! 2;
         #1001#27  = (#992#27  / 166.386) ! 2;
         #1001#28  = (#992#28  / 166.386) ! 2;
         #1001#29  = (#992#29  / 166.386) ! 2;
         #1001#95  = (#992#95  / 166.386) ! 2;
         #1001#96  = (#992#96  / 166.386) ! 2;
         #1001#97  = (#992#97  / 166.386) ! 2;
         #1001#98  = (#992#98  / 166.386) ! 2;
         #1001#99  = (#992#99  / 166.386) ! 2;
         #1001#100 = (#992#100 / 166.386) ! 2;
         #1001#101 = (#992#101 / 166.386) ! 2;
         #1001#102 = (#992#102 / 166.386) ! 2;
         #1001#103 = (#992#103 / 166.386) ! 2;

         #1001#104 = #992#104;
         #1001#105 = #992#105;
         #1001#106 = #992#106;
         |PARA nCampoPase = 30;  |SI nCampoPase [ 61;  |HACIENDO nCampoPase = nCampoPase + 1;
               #1001nCampoPase = #992nCampoPase;
         |SIGUE;

         #1001#38  = (#992#38  / 166.386) ! 2;
         #1001#40  = (#992#40  / 166.386) ! 2;
         #1001#42  = (#992#42  / 166.386) ! 2;
         #1001#44  = (#992#44  / 166.386) ! 2;
         #1001#45  = (#992#45  / 166.386) ! 2;
         #1001#45  = (#992#45  / 166.386) ! 2;
         #1001#47  = (#992#47  / 166.386) ! 2;
         #1001#45  = (#992#45  / 166.386) ! 2;
         #1001#51  = (#992#51  / 166.386) ! 2;
         #1001#51  = (#992#51  / 166.386) ! 2;
         #1001#53  = (#992#53  / 166.386) ! 2;
         #1001#55  = (#992#55  / 166.386) ! 2;
         #1001#57  = (#992#57  / 166.386) ! 2;
         #1001#60  = (#992#60  / 166.386) ! 2;
         #1001#61  = (#992#61  / 166.386) ! 2;

         |SI #1001#30 ! 0;  |Y  #1001#33 ! 0;
             nSuma = #1001#30 + #1001#33;
             #1001#30 = nSuma;
             #1001#33 = 0;
         |FINSI;

         |SI #1001#31 ! 0;  |Y  #1001#34 ! 0;
             nSuma = #1001#31 + #1001#34;
             #1001#31 = nSuma;
             #1001#34 = 0;
         |FINSI;

         |SI #1001#32 ! 0;  |Y  #1001#35 ! 0;
             nSuma = #1001#32 + #1001#35;
             #1001#32 = nSuma;
             #1001#35 = 0;
         |FINSI;

         |SI #1001#30 ! 0;
             #1001#30 = (N\ #1001#30 - 1);
         |SINO;
             |SI #1001#31 ! 0;
                 #1001#31 = (N\ #1001#31 - 1);
             |SINO;
                 |SI #1001#32 ! 0;
                     #1001#32 = (N\ #1001#32 - 1);
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI #0#30 = "S";
             #1001#15 = (N\ #1001#15 + (#1001#15 % #0#31));
         |FINSI;

         |SI #0#29 = "S";
             |ABRE #1;
             #1#0 = #1001#105;
             #1#1 = #1001#106;
             |LEE 040#1=;
             |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
             |CIERRA #1;

             nSuma  = ((#1001#21 / #1#2) * #1#3);
             nSuma1 = ((#1001#21 / #1#2) * #1#3) % #0#31;

             |SI #1#3 ] #1#2;
                 #1001#21 = (N\ nSuma + nSuma1);
             |SINO;
                 #1001#21 = (N\ nSuma - nSuma1);
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1001#30 > 365;  #1001#30 = 365;  |FINSI;
     |SI #1001#31 > 365;  #1001#31 = 365;  |FINSI;
     |SI #1001#32 > 365;  #1001#32 = 365;  |FINSI;
     |SI #1001#33 > 365;  #1001#33 = 365;  |FINSI;
     |SI #1001#34 > 365;  #1001#34 = 365;  |FINSI;
     |SI #1001#35 > 365;  #1001#35 = 365;  |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00021";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0002100;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa021;
|FIN;

|PROCESO Inmuebles;
     aDef = #0#0 + "/def/rem00021.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00021 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2001 + "/def/rem00021.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00021 A쨚 2001 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0002100;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa022;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#13  = #992#13;
     #1001#14  = #992#14;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;
     #1001#28  = #992#28;

     |SI #0#33 = "S";
         #1001#15  = (#992#15 / 166.386) ! 2;
     |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00022";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0002200;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa022;
|FIN;

|PROCESO Pasa043C;
     |SI #992#4 = "V";  |ACABA;  |FINSI;

     #1001#0 = #992#0;
     #1001#1 = #992#1;
     #1001#2 = #992#2;
     #1001#3 = #992#3;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = #992#3;
     #1001#4   = #992#4;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = (#992#7  / 166.386) ! 2;
     #1001#8   = (#992#8  / 166.386) ! 2;
     #1001#9   = #992#9;
     #1001#10  = (#992#10 / 166.386) ! 2;
     #1001#11  = (#992#11 / 166.386) ! 2;
     #1001#12  = (#992#12 / 166.386) ! 2;
     #1001#13  = (#992#13 / 166.386) ! 2;
     |GRABA 020#1001n;
     |LIBERA #1001;
|FPRC;

|DEFBUCLE rem00043C00;
     #992#1004;
     ;
     #991#0, 01, "01.01.0000", 01;
     #991#0, 99, "31.12.2999", 99;
     ;
     NULL, Pasa043C;
|FIN;

|PROCESO RegrabaCompra;
     |SI nAcciones = 0;  |ACABA;  |FINSI;

     |SI #992#6 = #1001#6;  |Y #992#7 = #1001#7;
         |SI nAcciones = #1001#5;
             |BORRA 020#1001a;
             nAcciones = 0;
             |ACABA;
         |FINSI;
         |SI nAcciones < #1001#5;
             #1001#5 = (N\ #1001#5 - nAcciones);
             #1001#8 = (N\ #1001#5 * #1001#7);
             |GRABA 020#1001a;
             nAcciones = 0;
             |ACABA;
         |FINSI;
         |SI nAcciones > #1001#5;
             nAcciones = nAcciones - #1001#5;
             |BORRA 020#1001a;
             |ACABA;
         |FINSI;
     |FINSI;

     |LIBERA #1001;
|FPRC;

|DEFBUCLE rem0004300;
     #1001#1004;
     ;
     #992#0, #992#1, "01.01.0000", 01;
     #992#0, #992#1, "31.12.2999", 99;
     be;
     NULL, RegrabaCompra;
|FIN;

|PROCESO Pasa043V;
     |SI #992#4 = "C";  |ACABA;  |FINSI;

     nAcciones = #992#5;
     |BUCLE rem0004300;
|FPRC;

|DEFBUCLE rem00043V00;
     #992#1004;
     ;
     #991#0, 01, "01.01.0000", 01;
     #991#0, 99, "31.12.2999", 99;
     ;
     NULL, Pasa043V;
|FIN;

|PROCESO Mobiliario1;
     aDef = #0#0 + "/def/rem00022.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00022 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2001 + "/def/rem00022.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00022 A쨚 2001 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0002200;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;

     aDef = #0#0 + "/def/rem00043.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00043 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2001 + "/def/rem00043.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00043 A쨚 2001 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem00043C00;
     |CIERRA #1001;

     |BUCLE rem00043V00;

     |DESCARGA_DEF #aficahor1@;

     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa023;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#13  = #992#13;
     #1001#14  = #992#14;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#24  = #992#24;
     #1001#33  = #992#33;

     |SI #0#33 = "S";
         #1001#15  = (#992#15 / 166.386) ! 2;
     |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00023";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0002300;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa023;
|FIN;

|PROCESO Mobiliario2;
     aDef = #0#0 + "/def/rem00023.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00023 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2001 + "/def/rem00023.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00023 A쨚 2001 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0002300;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa050;
     #1002#0 = #993#0;
     #1002#1 = #993#1;
     #1002#2 = #993#2;
     |LEE 101#1002=;
     |SI FSalida = 0;
         |BORRA 020#1002a;
         |LIBERA #1002;
     |FINSI;

     |DDEFECTO #1002;
     #1002#0   = #993#0;
     #1002#1   = #993#1;
     #1002#2   = #993#2;
     #1002#3   = (#993#3 / 166.386) ! 2;
     #1002#4   = (#993#4 / 166.386) ! 2;
     #1002#5   = (#993#5 / 166.386) ! 2;
     #1002#6   = #993#6;
     #1002#7   = (#993#7 / 166.386) ! 2;
     #1002#8   = #993#8;
     #1002#9   = (#993#9 / 166.386) ! 2;

     |GRABA 020#1002n;
     |LIBERA #1002;
|FPRC;

|DEFBUCLE rem0005000;
     #993#1003;
     ;
     #992#0, #992#1, 1900;
     #992#0, #992#1, 2999;
     ;
     NULL, Pasa050;
|FIN;

|PROCESO Pasa024;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#13  = #992#13;
     #1001#14  = #992#14;
     #1001#15  = #992#15;
     |SI #1001#12 ! 0;
         #1001#12 = (N\ #1001#12 + 1);
     |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00024";
     eaPunto    = "";
     |HAZ ProgramaActivo;

     |SI #1001#12 ] 1;  |Y #1001#12 [ 12;
         |BUCLE rem0005000;
     |FINSI;
|FPRC;

|DEFBUCLE rem0002400;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa024;
|FIN;

|PROCESO Mobiliario3;
     aDef = #0#0 + "/def/rem00024.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00024 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem00050.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00050 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2001 + "/def/rem00024.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00024 A쨚 2001 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2001 + "/def/rem00050.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00050 A쨚 2001 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;
     |PATH_DAT #993 aFich;

     |ABRE #1001;
     |ABRE #1002;
     |BUCLE rem0002400;
     |CIERRA #1001;
     |CIERRA #1002;

     |DESCARGA_DEF #aficahor2@;
     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante3@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa051;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#13  = #992#13;
     #1001#14  = #992#14;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#20  = #992#20;
     |SI #1001#20 > 0;  #1001#20 = (N\ #1001#20 + 1);  |FINSI;

     |SI #0#33 = "S";
         #1001#15  = (#992#15 / 166.386) ! 2;
     |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00051";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0005100;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa051;
|FIN;

|PROCESO Mobiliario4;
     aDef = #0#0 + "/def/rem00051.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00051 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2001 + "/def/rem00051.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00051 A쨚 2001 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0005100;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa025;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#14  = #992#14;
     #1001#15  = #992#15;
     #1001#16  = #992#16;

     |SI #992#18 = "P"; #1001#17 = "5";  |FINSI;
     |SI #992#18 = "A"; #1001#17 = "4";  |FINSI;
     |SI #992#18 = "E";
         #992#17 = "1";
         |SI #992#17  = "N";  #1001#17 = "3";  |FINSI;
         |SI #992#20  = "S";  #1001#17 = "2";  |FINSI;
     |FINSI;

     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#21  = #992#21;
     #1001#22  = #992#22;
     #1001#23  = #992#23;
     #1001#24  = #992#24;
     #1001#25  = #992#25;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00025";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0002500;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa025;
|FIN;

|PROCESO Actividad1;
     aDef = #0#0 + "/def/rem00025.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00025 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2001 + "/def/rem00025.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00025 A쨚 2001 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0002500;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa026;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#14  = #992#14;
     #1001#15  = #992#15;
     #1001#16  = #992#16;

     |SI #992#18 = "P"; #1001#17 = "5";  |FINSI;
     |SI #992#18 = "A"; #1001#17 = "4";  |FINSI;
     |SI #992#18 = "E";
         #992#17 = "1";
         |SI #992#17  = "N";  #1001#17 = "3";  |FINSI;
         |SI #992#20  = "S";  #1001#17 = "2";  |FINSI;
     |FINSI;

     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#21  = #992#21;
     #1001#22  = #992#22;
     #1001#23  = #992#23;
     #1001#24  = #992#24;
     #1001#25  = #992#25;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00026";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0002600;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa026;
|FIN;

|PROCESO Actividad2;
     aDef = #0#0 + "/def/rem00026.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00026 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2001 + "/def/rem00026.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00026 A쨚 2001 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0002600;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa027;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#14  = #992#14;
     #1001#15  = #992#15;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#20  = #992#20;
     #1001#21  = #992#21;
     #1001#22  = #992#22;
     #1001#23  = #992#23;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00027";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0002700;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa027;
|FIN;

|PROCESO Actividad3;
     aDef = #0#0 + "/def/rem00027.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00027 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2001 + "/def/rem00027.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00027 A쨚 2001 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0002700;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa028;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#14  = #992#14;
     #1001#15  = #992#15;
     #1001#16  = #992#16;
     #1001#17  = #992#17;
     #1001#18  = #992#18;
     #1001#19  = #992#19;
     #1001#20  = #992#20;
     #1001#21  = #992#21;
     #1001#22  = #992#22;
     #1001#23  = #992#23;
     #1001#24  = #992#24;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00028";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0002800;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa028;
|FIN;

|PROCESO Actividad4;
     aDef = #0#0 + "/def/rem00028.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00028 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2001 + "/def/rem00028.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00028 A쨚 2001 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0002800;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa053;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#13  = #992#13;
     #1001#17  = #992#17;
     #1001#21  = #992#21;
     #1001#22  = #992#22;
     #1001#23  = #992#23;
     #1001#24  = #992#24;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00053";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0005300;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa053;
|FIN;

|PROCESO Pensiones;
     aDef = #0#0 + "/def/rem00053.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00053 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2001 + "/def/rem00053.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00053 A쨚 2001 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0005300;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa054;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#14  = #992#14;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00054";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0005400;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa054;
|FIN;

|PROCESO Anualidades;
     aDef = #0#0 + "/def/rem00054.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00054 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2001 + "/def/rem00054.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00054 A쨚 2001 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0005400;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa032;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#13  = #992#13;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00032";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0003200;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa032;
|FIN;

|PROCESO TFiscal;
     aDef = #0#0 + "/def/rem00032.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00032 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2001 + "/def/rem00032.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00032 A쨚 2001 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0003200;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa046;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;
     #1001#0   = #992#0;
     #1001#1   = #992#1;
     #1001#2   = #992#2;
     #1001#3   = "X";
     |SI #0#37 = "N";  #1001#3 = #992#3;  |FINSI;
     #1001#4   = 0;
     #1001#5   = #992#5;
     #1001#6   = #992#6;
     #1001#7   = #992#7;
     #1001#8   = #992#8;
     #1001#9   = #992#9;
     #1001#10  = #992#10;
     #1001#11  = #992#11;
     #1001#12  = #992#12;
     #1001#14  = #992#14;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00046";
     eaPunto    = "";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0004600;
     #992#1002;
     ;
     #991#0, 01;
     #991#0, 99;
     ;
     NULL, Pasa046;
|FIN;

|PROCESO Donativos;
     aDef = #0#0 + "/def/rem00046.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00046 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2001 + "/def/rem00046.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00046 A쨚 2001 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0004600;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO GrabaDedu;
     |SI nImporte = 0;  |ACABA;  |FINSI;

     |SELECT #3#2;
     #2#7 = #994#11;
     #2#8 = #994#13;
     |LEE 040#2=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #992#2 = "TITULAR   ";
         |SI #994#2 = "CONYUGE   ";  |ACABA;  |FINSI;
         |SI #994#2 = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "4 FAMILIAR";  |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "CONYUGE   ";
         |SI #994#2 = "TITULAR   ";  |ACABA;  |FINSI;
         |SI #994#2 = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "4 FAMILIAR";  |ACABA;  |FINSI;
         |SI #994#2 = "GANANCIAL ";  |ACABA;  |FINSI;
         |SI #994#2 = "VARIOS    ";  |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "1 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "2 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "3 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #992#2 = "4 FAMILIAR";
         |SI #994#2 ! #992#2;        |ACABA;  |FINSI;
     |FINSI;

     |SI #994#17 = 0;
         nCompara = #994#18;
     |SINO;
         nCompara = #994#19;
     |FINSI;

     |SI #2#9 = 3;  |Y #2#10 = 15;
         #2#9  = 2;
         #2#10 = 6;
     |FINSI;

     |SELECT #1#2;
     #2#0 = #2#9;
     #2#1 = #2#10;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

     |SI nImporte = nCompara;
         #1001#0 = #994#0;
         #1001#1 = #994#1;
         |LEE 101#1001=;
         |SI FSalida = 0;
             |BORRA 020#1001a;
             |LIBERA #1001;
         |FINSI;

         |PARA nCampoPase = 0;  |SI nCampoPase [ 21;  |HACIENDO nCampoPase = nCampoPase + 1;
               #1001nCampoPase = #994nCampoPase;
         |SIGUE;
         #1001#3  = "X";
         |SI #0#37 = "N";  #1001#3 = #994#3;  |FINSI;

         #1001#11 = #2#0;
         #1001#12 = #2#2;
         #1001#13 = #2#1;
         #1001#14 = #2#3;
         #1001#15 = #2#4;
         #1001#16 = #2#5;
         #1001#17 = #2#6;

         nImpo    = (nImporte / 166.386) ! 2;

         |SI #1001#17 ! 0;
             #1001#18 = (N\ ((nImpo * 100) / #1001#17) ! 2);
             #1001#19 = nImpo;
         |SINO;
             #1001#18 = nImpo;
             #1001#19 = nImpo;
         |FINSI;

         |GRABA 020#1001n;
         |LIBERA #1001;

         eaPrograma = "rem00045";
         eaPunto    = "";
         |HAZ ProgramaActivo;

         nImporte = 0;

         |ACABA;
     |FINSI;

     |SI nImporte < nCompara;
         #1001#0 = #994#0;
         #1001#1 = #994#1;
         |LEE 101#1001=;
         |SI FSalida = 0;
             |BORRA 020#1001a;
             |LIBERA #1001;
         |FINSI;

         |PARA nCampoPase = 0;  |SI nCampoPase [ 21;  |HACIENDO nCampoPase = nCampoPase + 1;
               #1001nCampoPase = #994nCampoPase;
         |SIGUE;
         #1001#3  = "X";
         |SI #0#37 = "N";  #1001#3 = #994#3;  |FINSI;
         #1001#11 = #2#0;
         #1001#12 = #2#2;
         #1001#13 = #2#1;
         #1001#14 = #2#3;
         #1001#15 = #2#4;
         #1001#16 = #2#5;
         #1001#17 = #2#6;

         nImpo    = (nImporte / 166.386) ! 2;

         |SI #1001#17 ! 0;
             #1001#18 = (N\ ((nImpo * 100) / #1001#17) ! 2);
             #1001#19 = nImpo;
         |SINO;
             #1001#18 = nImpo;
             #1001#19 = nImpo;
         |FINSI;
         |GRABA 020#1001n;

         eaPrograma = "rem00045";
         eaPunto    = "";
         |HAZ ProgramaActivo;

         nImporte = 0;

         |ACABA;
     |FINSI;

     |SI nImporte > nCompara;
         #1001#0 = #994#0;
         #1001#1 = #994#1;
         |LEE 101#1001=;
         |SI FSalida = 0;
             |BORRA 020#1001a;
             |LIBERA #1001;
         |FINSI;

         |PARA nCampoPase = 0;  |SI nCampoPase [ 21;  |HACIENDO nCampoPase = nCampoPase + 1;
               #1001nCampoPase = #994nCampoPase;
         |SIGUE;
         #1001#3  = "X";
         |SI #0#37 = "N";  #1001#3 = #994#3;  |FINSI;
         #1001#11 = #2#0;
         #1001#12 = #2#2;
         #1001#13 = #2#1;
         #1001#14 = #2#3;
         #1001#15 = #2#4;
         #1001#16 = #2#5;
         #1001#17 = #2#6;

         nImpo    = (nCompara / 166.386) ! 2;

         |SI #1001#17 ! 0;
             #1001#18 = (N\ ((nImpo * 100) / #1001#17) ! 2);
             #1001#19 = nImpo;
         |SINO;
             #1001#18 = nImpo;
             #1001#19 = nImpo;
         |FINSI;
         |GRABA 020#1001n;

         eaPrograma = "rem00045";
         eaPunto    = "";
         |HAZ ProgramaActivo;

         nImporte = nImporte - nCompara;
     |FINSI;
|FPRC;

|DEFBUCLE rem0004500;
     #994#1002;
     11, 13;
     #993#0, 01, nAgru, nCasi;
     #993#0, 99, nAgru, nCasi;
     ;
     NULL, GrabaDedu;
|FIN;

|PROCESO PonDedu;
     |ABRE #2;
     |BUCLE rem0004500;
     |CIERRA #2;
|FPRC;

|PROCESO MiraLiquidacion;
     #993#0 = #992#0;
     #993#1 = #992#1;
     #993#2 = #992#2;
     |LEE 040#993=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #993#7   ! 0;  nImporte = #993#7;   nAgru = 1;  nCasi = 2;  |HAZ PonDedu;  |FINSI;

     |SI #993#10  ! 0;  nImporte = #993#10;  nAgru = 2;  nCasi = 1;  |HAZ PonDedu;  |FINSI;

     |SI #993#13  ! 0;  nImporte = #993#13;  nAgru = 2;  nCasi = 1;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 2;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 2;  nCasi = 3;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 2;  nCasi = 4;  |HAZ PonDedu;  |FINSI;

     |SI #993#16  ! 0;  nImporte = #993#16;  nAgru = 2;  nCasi = 5;  |HAZ PonDedu;  |FINSI;
     |SI #993#19  ! 0;  nImporte = #993#19;  nAgru = 2;  nCasi = 6;  |HAZ PonDedu;  |FINSI;

     |SI #993#22  ! 0;  nImporte = #993#22;  nAgru = 3;  nCasi = 1;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 3;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 3;  nCasi = 3;  |HAZ PonDedu;  |FINSI;

     |SI #993#25  ! 0;  nImporte = #993#25;  nAgru = 3;  nCasi = 4;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 3;  nCasi = 5;  |HAZ PonDedu;  |FINSI;

     |SI #993#28  ! 0;  nImporte = #993#28;  nAgru = 3;  nCasi = 6;  |HAZ PonDedu;  |FINSI;

     |SI #993#31  ! 0;  nImporte = #993#28;  nAgru = 3;  nCasi = 7;  |HAZ PonDedu;  |FINSI;

     |SI #993#34  ! 0;  nImporte = #993#34;  nAgru = 3;  nCasi = 8;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 3;  nCasi = 9;  |HAZ PonDedu;  |FINSI;

     |SI #993#37  ! 0;  nImporte = #993#37;  nAgru = 3;  nCasi = 10; |HAZ PonDedu;  |FINSI;

     |SI #993#40  ! 0;  nImporte = #993#40;  nAgru = 3;  nCasi = 11; |HAZ PonDedu;  |FINSI;

     |SI #993#43  ! 0;  nImporte = #993#43;  nAgru = 3;  nCasi = 12; |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 3;  nCasi = 13; |HAZ PonDedu;  |FINSI;

     |SI #993#46  ! 0;  nImporte = #993#46;  nAgru = 3;  nCasi = 14; |HAZ PonDedu;  |FINSI;

     |SI #993#49  ! 0;  nImporte = #993#49;  nAgru = 3;  nCasi = 15; |HAZ PonDedu;  |FINSI;

     |SI #993#52  ! 0;  nImporte = #993#52;  nAgru = 3;  nCasi = 16; |HAZ PonDedu;  |FINSI;

     |SI #993#57  ! 0;  nImporte = #993#57;  nAgru = 4;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 4;  nCasi = 3;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 4;  nCasi = 4;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 4;  nCasi = 5;  |HAZ PonDedu;  |FINSI;

     |SI #993#60  ! 0;  nImporte = #993#60;  nAgru = 5;  nCasi = 1;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 5;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 5;  nCasi = 3;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 5;  nCasi = 4;  |HAZ PonDedu;  |FINSI;

     |SI #993#63  ! 0;  nImporte = #993#63;  nAgru = 6;  nCasi = 1;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 6;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 6;  nCasi = 3;  |HAZ PonDedu;  |FINSI;

     |SI #993#66  ! 0;  nImporte = #993#66;  nAgru = 6;  nCasi = 4;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 6;  nCasi = 5;  |HAZ PonDedu;  |FINSI;

     |SI #993#69  ! 0;  nImporte = #993#69;  nAgru = 6;  nCasi = 6;  |HAZ PonDedu;  |FINSI;

     |SI #993#72  ! 0;  nImporte = #993#72;  nAgru = 6;  nCasi = 7;  |HAZ PonDedu;  |FINSI;

     |SI #993#75  ! 0;  nImporte = #993#75;  nAgru = 6;  nCasi = 8;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 6;  nCasi = 9;  |HAZ PonDedu;  |FINSI;

     |SI #993#78  ! 0;  nImporte = #993#78;  nAgru = 6;  nCasi = 10; |HAZ PonDedu;  |FINSI;

     |SI #993#81  ! 0;  nImporte = #993#81;  nAgru = 6;  nCasi = 11; |HAZ PonDedu;  |FINSI;

     |SI #993#84  ! 0;  nImporte = #993#84;  nAgru = 6;  nCasi = 12; |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 6;  nCasi = 13; |HAZ PonDedu;  |FINSI;

     |SI #993#87  ! 0;  nImporte = #993#87;  nAgru = 7;  nCasi = 1;  |HAZ PonDedu;  |FINSI;

     |SI #993#92  ! 0;  nImporte = #993#92;  nAgru = 8;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 8;  nCasi = 3;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 8;  nCasi = 4;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 8;  nCasi = 5;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 8;  nCasi = 6;  |HAZ PonDedu;  |FINSI;

     |SI #993#95  ! 0;  nImporte = #993#95;  nAgru = 8;  nCasi = 7;  |HAZ PonDedu;  |FINSI;

     |SI #993#100 ! 0;  nImporte = #993#100; nAgru = 9;  nCasi = 2;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 9;  nCasi = 3;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 9;  nCasi = 4;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 9;  nCasi = 6;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 9;  nCasi = 7;  |HAZ PonDedu;  |FINSI;
     |SI nImporte ! 0;                       nAgru = 9;  nCasi = 8;  |HAZ PonDedu;  |FINSI;

     |SI #993#103 ! 0;  nImporte = #993#103; nAgru = 9;  nCasi = 9;  |HAZ PonDedu;  |FINSI;

     |SI #993#106 ! 0;  nImporte = #993#106; nAgru = 9;  nCasi = 10; |HAZ PonDedu;  |FINSI;

     |SI #993#109 ! 0;  nImporte = #993#109; nAgru = 9;  nCasi = 11; |HAZ PonDedu;  |FINSI;

     |SI #993#119 ! 0;  nImporte = #993#119; nAgru = 11; nCasi = 2;  |HAZ PonDedu;  |FINSI;

     |SI #993#123 ! 0;  nImporte = #993#123; nAgru = 11; nCasi = 3;  |HAZ PonDedu;  |FINSI;

                        nImporte = 0;        nAgru = 11; nCasi = 4;  |HAZ PonDedu;
|FPRC;

|DEFBUCLE rem0100100;
     #992#1003;
     5;
     #991#0, 00, "          ", "100";
     #991#0, 99, "zzzzzzzzzz", "101";
     ;
     NULL, MiraLiquidacion;
|FIN;

|PROCESO Deducciones;
     aDef = #0#0 + "/def/rem01001.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01001 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem01042.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem01042 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = #0#0 + "/def/rem00045.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00045 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2001 + "/def/rem00045.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00045 A쨚 2001 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;
     |PATH_DAT #993 aFich;
     |PATH_DAT #994 aFich;

     |ABRE #993;
     |ABRE #1001;
     |BUCLE rem0100100;
     |CIERRA #993;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante4@;
     |DESCARGA_DEF #aficante3@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa090;
     #1001#0 = #992#0;
     #1001#1 = #992#1;
     #1001#2 = #992#2;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |BORRA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |DDEFECTO #1001;

     |PARA nCampoPase = 0;  |SI nCampoPase [ 23;  |HACIENDO nCampoPase = nCampoPase + 1;
           #1001nCampoPase = #992nCampoPase;
     |SIGUE;

     |SI #0#34 = "N";
         #1001#10 = 0;
         #1001#14 = 0;
         #1001#23 = 0;
     |SINO;
         #1001#10 = (#1001#10 / 166.386) ! 2;
         #1001#14 = (#1001#14 / 166.386) ! 2;
         #1001#23 = (#1001#23 / 166.386) ! 2;
     |FINSI;

     |GRABA 020#1001n;
     |LIBERA #1001;

     eaPrograma = "rem00099";
     eaLetra    = #1001#1;
     eaPunto    = #1001#1;
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem0009900;
     #992#1003;
     4, 5;
     #991#0, "  ", 001, "  ", 00;
     #991#0, "zz", 999, "  ", 00;
     ;
     NULL, Pasa090;
|FIN;

|PROCESO Patrimonio;
     aDef = #0#0 + "/def/rem00099.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00099 A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef = aBaseRenta2001 + "/def/rem00099.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00099 A쨚 2001 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #992 aFich;

     |ABRE #1001;
     |BUCLE rem0009900;
     |CIERRA #1001;

     |DESCARGA_DEF #aficahor1@;
     |DESCARGA_DEF #aficante2@;
|FPRC;

|PROCESO Pasa2001;
     enEmpresa = #991#0;

     aDef = aBaseRenta2001 + "/def/reacceso.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficahor1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def reacceso  A쨚 2001 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aAlfa1 = #991#1;  |QBF aAlfa1;
     aAlfa  = "     Recogiendo Contribuyente [" + (("00000" + #991#0) % -105) + " " + aAlfa1 + "]";

     |ABRE #1001;
     #1001#0 = #991#0;
     |LEE 101#1001=;
     |SI FSalida = 0;
         |SI enCodCli = 0;
             aAlfa  = "0000NYa existe Contribuyente [" + (("00000" + #991#0) % -105) + " " + aAlfa1 + "] Desea pasar los datos de nuevo : ";
             |CONFI aAlfa;
             |SI FSalida ! 0;
                 |CIERRA #1001;
                 |DESCARGA_DEF #aficahor1@;
                 |ACABA;
             |FINSI;
         |FINSI;

         #1001#0 = #991#0;
         #1001#1 = #991#1;
         #1001#2 = #991#2;
         |GRABA 020#1001a;
     |SINO;
         #1001#0 = #991#0;
         #1001#1 = #991#1;
         #1001#2 = #991#2;
         |GRABA 020#1001n;
     |FINSI;
     |LIBERA #1001;
     |CIERRA #1001;
     |DESCARGA_DEF #aficahor1@;

     aAlfa1 = #991#1;  |QBF aAlfa1;
     aAlfa  = "     Recogiendo Contribuyente [" + (("00000" + #991#0) % -105) + " " + aAlfa1 + "]";
     |MENSA aAlfa;

     |SI #0#38 = "S";  |HAZ DatosPersonales;  |FINSI;
     |SI #0#24 = "S";  |HAZ Trabajo;          |FINSI;
     |SI #0#25 = "S";  |HAZ Inmuebles;        |FINSI;
     |SI #0#26 = "S";  |HAZ Mobiliario1;      |FINSI;
     |SI #0#26 = "S";  |HAZ Mobiliario2;      |FINSI;
     |SI #0#26 = "S";  |HAZ Mobiliario3;      |FINSI;
     |SI #0#26 = "S";  |HAZ Mobiliario4;      |FINSI;
     |SI #0#35 = "S";  |HAZ Actividad1;       |FINSI;
     |SI #0#35 = "S";  |HAZ Actividad2;       |FINSI;
     |SI #0#35 = "S";  |HAZ Actividad3;       |FINSI;
     |SI #0#35 = "S";  |HAZ Actividad4;       |FINSI;
     |SI #0#36 = "S";  |HAZ Pensiones;        |FINSI;
     |SI #0#36 = "S";  |HAZ Anualidades;      |FINSI;
     |SI #0#36 = "S";  |HAZ TFiscal;          |FINSI;
     |SI #0#36 = "S";  |HAZ Donativos;        |FINSI;
     |SI #0#27 = "S";  |HAZ Deducciones;      |FINSI;
     |SI #0#28 = "S";  |HAZ Patrimonio;       |FINSI;
|FPRC;

|DEFBUCLE reacceso00;
     #991#1001;
     ;
     #0#2;
     #0#3;
     ;
     NULL, Pasa2001;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |ABRE #401;
     |LEE 040#401p;
     nPatrones = FSalida;
     |CIERRA #401;

     |SI nPatrones ! 0;
         |SUB_EJECUTA_NP "rez00001;INSTALAR";
     |FINSI;

     |DBASE aBaseRenta2001;  |QBT aBaseRenta2001;

     aFichero = "repoblac";  |HAZ Auxiliares;
     aFichero = "reauxpai";  |HAZ Auxiliares;
     aFichero = "rerenpre";  |HAZ Auxiliares;
     aFichero = "reauxdiv";  |HAZ Auxiliares;
     aFichero = "reauxval";  |HAZ Auxiliares;
     aFichero = "rebancos";  |HAZ Auxiliares;

     aDef = #0#0 + "/def/reacceso.mas";  |QBT aDef;
     |CARGA_DEF aDef, aficante1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def reacceso A쨚 2000 ";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aFich = #0#0 + "/" + #0#1 + "/";  |QBT aFich;
     |PATH_DAT #991 aFich;

     |SI #0#2 ! 0;
         |BUCLE reacceso00;
     |SINO;
         |PARA nCampo = 4;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo ! 0;
                   #0#2 = #0nCampo;
                   #0#3 = #0nCampo;
                   |BUCLE reacceso00;
               |FINSI;
         |SIGUE;
     |FINSI;

     |DESCARGA_DEF #aficante1@;
|FPRC;

|PROGRAMA;
     |SI enCodCli ! 0;
         |PARA nCampo = 2;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
         |SIGUE;
         #0#2 = enCodCli;  |PINTA #0#2;
         #0#3 = enCodCli;  |PINTA #0#3;
         |PINPA #0#0;
         |PINDA #0#0;
         |ENDATOS #1#0;
     |SINO;
         |MANTE #0;
     |FINSI;
|FPRO;
