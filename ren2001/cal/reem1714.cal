|| CUIDADO !!!!! El fichero 'rem00099' engloba los capitulos 'A1' y 'A2' en
|| el capitulo 'A1' pero distingue entre uno y otro por el campo 22 que valdr 
|| 'S' si el apartado es el 'A1' y valdr  'N' si el apartado es el 'A2'

|| La emision se apoya sobre un temporal que, ordenado por p ginas, indica
|| los registros a escribir y donde est  cada registro.
|| El campo 4 del temporal 'rew00056' nos indica el n§ de linea que debemos
|| leer del 'rem00099' para saber que linea nos toca escribir. Si este campo
|| es cero, el registro es vacio (escribir un registro en blanco) y si es -1
|| nos indica que no es una linea de patrimonio, sino un total de capitulo
|| lo que debemos escribir y ese total viene reflejado en el campo 6.
|| El campo 5 indica el n§ de paginas anexo que vienen con la principal.

|| En la rutina 'LeeTempo' est  la escritura de la estructura actual de cada
|| capitulo dentro del secuencial

|| Para cambios en sucesivos a¤os s¢lo cambiaremos la rutina 'LeeTempo' (la
|| estructura del secuencial, vigilaremos los limites de lineas de cada
|| capitulo (nLimA1, nLimA2, etc ....) y si incluyen o eliminan algun capitulo
|| adem s de incorporarlo/eliminarlo en las rutinas anteriores hacerlo en las
|| rutinas 'CreaTempo' y 'CreaLineas'

|FICHEROS;
   reemi714 #0;
   rem01001 #1;
   rem01002 #2;

   rem00100 #91;
   rem00101 #92;
   rem01002 #93;
   rerenpre #96;

   rew00001 #99,MANTE;

   rem00099 #100;

   rew00056 #500;

   &poblaci@ #703;
|FIN;

|VARIABLES;

     &EURO   = 0;
     &EURODB = 0;
     &EURODV = 0;
     &enEmpresa     = 0;
     &enTipoEntrada = 0;

     &eaTipoEmi = "";
     &aIP = "";

     FEstado = 0;
     xxx = 0;
     alfa1 = "";

     aDHabitual = "";
     aHHabitual = "";

     nCampo  = 0;
     nPorc   = 0;
     nSwLee = 0;
     SwCambio = 0;
     nTotal  = 0;
     nLong   = 0;
     nCanal  = 0;
     nCont   = 0;
     nCont1  = 0;
     nCont2  = 0;
     nCont3  = 0;
     nCont4  = 0;
     nCont5  = 0;
     nCalc   = 0;
     nCalc1  = 0;
     nCalc2  = 0;
     nCalc3  = 0;
     Calc    = 0;
     Calc1   = 0;
     Calc2   = 0;
     Long    = 0;
     LongDec = 0;
     nConver = 0;
     SwDatos = 0;
     nSwDatos = 0;
     XCampos = 0;

     aContr = "";

     Casilla = "";
     Bloque  = 0;

     Modifica = "";
     &DiaInf  = "";
     MesNum   = "";
     &MesInf  = "";
     &EjerInf = "";
     DReimp   = "";
     HReimp   = "";

     aNombre  = "";
     aNombre1 = "";
     aNombre2 = "";
     aDTipo   = "";
     aHTipo   = "";
     aTipo    = "";

     DEmpre   = 0;
     HEmpre   = 0;
     SwEstar  = 0;
     SwError  = 0;

     aOrigen  = "";
     aDestino = "";
     aFichero = "";
     aLong    = "";
     TipoDato = "";
     aAlfa    = "";
     aAlfa1   = "";
     aAlfa2   = "";
     Cadena   = "";
     Cadena1  = "";
     Cadena2  = "";
     Cadena3  = "";
     Comodin  = "";
     Comodin1 = "";
     Comodin2 = "";
     Vacio1   = "";
     Vacio2   = "";

     nLinG = 0; nLinP = 0;
     nNumPag = 0;
     nPagina = 0;
     nLinea  = 0;
     nLimite = 0;

     nLimA1  = 2;
     nLimA2  = 20;
     nLimB1  = 20;

     nLimC1  = 13;
     nLimC2  = 12;
     nLimD1  = 13;

     nLimE1  = 15;
     nLimF1  = 15;
     nLimF2  = 14;

     nLimG1  = 12;
     nLimG2  = 18;
     nLimG3  = 13;

     nLimG4  = 10;
     nLimH1  = 5;
     nLimH2  = 5;
     nLimI1  = 5;
     nLimJ1  = 5;

     nLimK1  = 13;
     nLimL1  = 9;
     nLimM1  = 8;
     nLimN1  = 6;

     nLimO1  = 5;
     nLimP1  = 5;
     nLimQ1  = 12;
     nLimU1  = 13;

     Handle   = 0;
     &VEmpresa = 0;
     &VTipo    = "";
     nNoHay   = 0;
     nNoHay1  = 0;
     nNoHay2  = 0;
     nNoHay3  = 0;
     nNoHay4  = 0;
     Nombre   = "";
     aNif1      = ""; aNif2      = "";
     aApell11   = ""; aApell12   = "";
     aApell21   = ""; aApell22   = "";
     aC1        = ""; aC2        = "";
     aSg1       = ""; aSg2       = "";
     aCalle1    = ""; aCalle2    = "";
     aNumero1   = ""; aNumero2   = "";
     aEscalera1 = ""; aEscalera2 = "";
     aPiso1     = ""; aPiso2     = "";
     aPuerta1   = ""; aPuerta2   = "";
     aLocali1   = ""; aLocali2   = "";
     aCP1       = ""; aCP2       = "";
     aProvin1   = ""; aProvin2   = "";
     aEC1       = ""; aEC2       = "";
     aAnyoN1    = ""; aAnyoN2    = "";
     aMinusval1 = ""; aMinusval2 = "";
     aTelef1    = ""; aTelef2    = "";
     aIglesia1  = ""; aIglesia2  = "";
     aEntidad1  = ""; aEntidad2  = "";
     aSucursal1 = ""; aSucursal2 = "";
     aDC1       = ""; aDC2       = "";
     aCuenta1   = ""; aCuenta2   = "";
     aDom2P     = ""; aFra2P     = "";
     aRen2P     = ""; aSeparada = "";

     aNifH  = ""; aNombH = "";
     aAnyoH = ""; aMinuH = "";
     aVincH = ""; aOtroH = "";

     aNom   = "";
     aApel1 = "";
     aApel2 = "";
     aTipoContr = "";
     nInd   = 0;
     nNegativo = 0;

     nSalir  = 0;
     nPasada = 0;
     nPos    = 0;

     nNumero = 0;
     nImporte = 0;
     nNumComp = 0;
     nTotal1 = 0; nTotal2 = 0; nTotal3 = 0; nTotal4 = 0;

     &enCodProv = 0;
     &enCodPobl = 0;
     &eaTipoSec = "";

{12}nDescend = 0;
{4}nAscend   = 0;

{200}&NEmpresas = "";
|FIN;

|PROCESO CargaDatos;
   aAlfa = VTipo; |QBF aAlfa;

   aNif1      = ""; aNif2      = "";
   aApell11   = ""; aApell12   = "";
   aApell21   = ""; aApell22   = "";
   aC1        = ""; aC2        = "";
   aSg1       = ""; aSg2       = "";
   aCalle1    = ""; aCalle2    = "";
   aNumero1   = ""; aNumero2   = "";
   aEscalera1 = ""; aEscalera2 = "";
   aPiso1     = ""; aPiso2     = "";
   aPuerta1   = ""; aPuerta2   = "";
   aLocali1   = ""; aLocali2   = "";
   aCP1       = ""; aCP2       = "";
   aProvin1   = ""; aProvin2   = "";
   aEC1       = ""; aEC2       = "";
   aAnyoN1    = ""; aAnyoN2    = "";
   aMinusval1 = ""; aMinusval2 = "";
   aTelef1    = ""; aTelef2    = "";
   aIglesia1  = ""; aIglesia2  = "";

   |SI aAlfa = "ZPATRITIT";
      enCodProv = #rem00100#20;
      enCodPobl = #rem00100#21;
      |HAZ LeePoblacion;

      aNif1      = #rem00100#1;    aNombre1 = #rem00100#4;
      aApell11   = #rem00100#2;    aApell12 = #rem00100#3;
      aC1        = #rem00100#100;  aSg1     = #rem00100#14;
      aCalle1    = #rem00100#15;   aNumero1 = #rem00100#16;
      aEscalera1 = #rem00100#17;   aPiso1   = #rem00100#18;
      aPuerta1   = #rem00100#19;   aLocali1 = #rem00100#22;
      aAlfa = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103);
      aCP1       = aAlfa;          aProvin1 = #703#2;
      aEC1       = #rem00100#6;    aAnyoN1  = #rem00100#7;
      aMinusval1 = #rem00100#8;    aTelef1  = #rem00100#12;
      aIglesia1  = #rem00100#59;
      aCuenta1  = #rem00100#53;

      enCodProv = #rem00100#50;
      enCodPobl = #rem00100#51;
      |HAZ LeePoblacion;

      aNif2      = #rem00100#35;   aNombre2 = #rem00100#38;
      aApell21   = #rem00100#36;   aApell22 = #rem00100#37;
      aC2        = #rem00100#101;  aSg2     = #rem00100#44;
      aCalle2    = #rem00100#45;   aNumero2 = #rem00100#46;
      aEscalera2 = #rem00100#47;   aPiso2   = #rem00100#48;
      aPuerta2   = #rem00100#49;   aLocali2 = #rem00100#52;
      aCP2       = (("00" + #rem00100#50) % -102) + (("000" + #rem00100#51) % -103);
      aProvin2   = #703#2;         aAnyoN2  = #rem00100#40;
      aMinusval2 = #rem00100#41;   aTelef2  = #rem00100#13;
      aIglesia2  = #rem00100#60;
      aCuenta2  = #rem00100#54;
   |FINSI;

   |SI aAlfa = "ZPATRICON";
      enCodProv = #rem00100#50;
      enCodPobl = #rem00100#51;
      |HAZ LeePoblacion;

      aNif1      = #rem00100#35;   aNombre1 = #rem00100#38;
      aApell11   = #rem00100#36;   aApell12 = #rem00100#37;
      aC1        = #rem00100#101;  aSg1     = #rem00100#44;
      aCalle1    = #rem00100#45;   aNumero1 = #rem00100#46;
      aEscalera1 = #rem00100#47;   aPiso1   = #rem00100#48;
      aPuerta1   = #rem00100#49;   aLocali1 = #rem00100#52;
      aCP1       = (("00" + #rem00100#50) % -102) + (("000" + #rem00100#51) % -103);
      aEC1       = #rem00100#6;
      aProvin1   = #703#2;         aAnyoN1  = #rem00100#40;
      aMinusval1 = #rem00100#41;   aTelef1  = #rem00100#13;
      aIglesia1  = #rem00100#60;   aCuenta1   = #rem00100#54;

      enCodProv = #rem00100#20;
      enCodPobl = #rem00100#21;
      |HAZ LeePoblacion;

      aNif2      = #rem00100#1;    aNombre2 = #rem00100#4;
      aApell21   = #rem00100#2;    aApell22 = #rem00100#3;
      aC2        = #rem00100#100;  aSg2     = #rem00100#14;
      aCalle2    = #rem00100#15;   aNumero2 = #rem00100#16;
      aEscalera2 = #rem00100#17;   aPiso2   = #rem00100#18;
      aPuerta2   = #rem00100#19;   aLocali2 = #rem00100#22;
      aAlfa = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103);
      aCP2       = aAlfa;          aProvin2 = #703#2;
      aAnyoN2    = #rem00100#7;
      aMinusval2 = #rem00100#8;    aTelef2  = #rem00100#12;
      aIglesia2  = #rem00100#59;   aCuenta2 = #rem00100#53;
   |FINSI;

   aAlfa = aCuenta1; |QBF aAlfa; |SI aAlfa = ""; aCuenta1 = "0" * 20; |FINSI;
   aAlfa = aCuenta2; |QBF aAlfa; |SI aAlfa = ""; aCuenta2 = "0" * 20; |FINSI;
|FPRC;

|PROCESO Hoja01;
   Cadena = "";
   |ABRE #rem00100;
   #rem00100#0 = VEmpresa;
   |LEE 000#rem00100.=;
   |SI FSalida = 0; |HAZ CargaDatos; |FINSI;
   |CIERRA #rem00100;

   LongDec = 0;
   Cadena = "71401 ";
   || Residencia habitual durante 2001 en extranjero y tributa por oblig.real
   |SI #rem00100#94 = "S";
      |SI #rem00100#99 = "N";        || Tributacion por obligacion real
         aAlfa = "X"; #rem00100#11 = 0;
      |SINO;
         aAlfa = " ";
      |FINSI;
   |SINO;
      aAlfa = " ";
   |FINSI;
   Cadena = Cadena + aAlfa;
   || Codigo identificativo del pais de residencia
   TipoDato = "N"; Long = 3;
   |SI #rem00100#94 = "S"; aAlfa = #rem00100#77; |SINO; aAlfa = "0"; |FINSI;
   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Durante 2001 no es residente en Espa¤a pero opta por seguir tributando por obl.personal
   |SI #rem00100#94 = "S";
      |SI #rem00100#99 = "S";        || Tributacion por obligacion personal
         aAlfa = "X";
      |SINO;
         aAlfa = " ";
      |FINSI;
   |SINO;
      aAlfa = " ";
   |FINSI;
   Cadena = Cadena + aAlfa;

   || DATOS TITULAR
   || Nif del primer declarante
   TipoDato = "An"; Long = 9;  aAlfa = aNif1;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Apellido 1 del primer declarante
   TipoDato = "A";  Long = 15; aAlfa = aApell11;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Apellido 2 del primer declarante
   TipoDato = "A";  Long = 15; aAlfa = aApell12;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Nombre del primer declarante
   TipoDato = "A";  Long = 15; aAlfa = aNombre1;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cambio de domicilio o 1¦ declaracion
   TipoDato = "A";  Long = 1;  aAlfa = aC1;       |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Siglas de la via del primer declarante
   TipoDato = "A";  Long = 2;  aAlfa = aSg1;      |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Nombre de la via del primer declarante
   TipoDato = "A";  Long = 20; aAlfa = aCalle1;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Numero del primer declarante
   TipoDato = "An"; Long = 5;  aAlfa = aNumero1;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Escalera del primer declarante
   TipoDato = "An"; Long = 2;  aAlfa = aEscalera1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Piso del primer declarante
   TipoDato = "An"; Long = 2;  aAlfa = aPiso1;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Puerta del primer declarante
   TipoDato = "An"; Long = 2;  aAlfa = aPuerta1;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Telefono de contacto del declarante
   TipoDato = "N";  Long = 9;  aAlfa = aTelef1;    |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Municipio del primer declarante
   TipoDato = "An"; Long = 25; aAlfa = aLocali1;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Codigo provincial del primer declarante
   aAlfa = aCP1; aAlfa = aAlfa % 0102; |QBF aAlfa;
   aAlfa = ("00" + aAlfa) % -102;                   Cadena = Cadena + aAlfa;
   || Codigo postal del primer declarante
   aAlfa = aCP1; |QBF aAlfa; |SI aAlfa = ""; aAlfa = "00000"; |FINSI; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   |ABRE #rerenpre;
   #rerenpre#0 = #rem00100#65;
   |LEE 000#rerenpre.=;
   |SI FSalida = 0;
      || Representante : Nif
      TipoDato = "An"; Long = 9;  aAlfa = #rerenpre#2;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Representante : Primer apellido
      aAlfa = #rerenpre#1; |HAZ SeparaNombre;
      aApell11 = aApel1;   aApell12 = aApel2;   aNombre1  = aNom;
      TipoDato = "An"; Long = 15; aAlfa = aApel1;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Representante : Segundo apellido
      TipoDato = "An"; Long = 15; aAlfa = aApel2;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Representante : Nombre
      TipoDato = "An"; Long = 15; aAlfa = aNom;    |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Representante : Sigla de la via publica
      aAlfa = #rerenpre#3; |QBF aAlfa; aAlfa = aAlfa % 0103;
      |SI aAlfa ! "CL "; |Y aAlfa ! "PB "; |Y aAlfa ! "AV "; |Y aAlfa ! "C/ ";
         aAlfa = "  ";
      |SINO;
         aAlfa = aAlfa % 0102;
      |FINSI;
      TipoDato = "A";  Long = 2;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Representante : Nombre de la via publica
      TipoDato = "An"; Long = 20; aAlfa = #rerenpre#3;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Representante : Numero de la via publica
      TipoDato = "An"; Long = 5;  aAlfa = #rerenpre#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Representante : Escalera, piso y puerta
      TipoDato = "An"; Long = 6;  aAlfa = "";           |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Representante : Telefono
      TipoDato = "N";  Long = 9;  aAlfa = #rerenpre#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Representante : Municipio
      TipoDato = "An"; Long = 25; aAlfa = #rerenpre#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Representante : Codigo provincial
      TipoDato = "N";  Long = 2;  aAlfa = #rerenpre#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Representante : Codigo postal
      aAlfa = (("00" + #rerenpre#5) % -102) + (("000" + #rerenpre#6) % -103);
      Cadena = Cadena + aAlfa;
   |SINO;
      Cadena = Cadena + (" " * 87) + ("0" * 9) + (" " * 25) + ("0" * 7);
   |FINSI;
   |CIERRA #rerenpre;

   || Regimen economico
   aAlfa = " ";
   |SI #rem00100#93 = "G"; aAlfa = "3"; |FINSI;
   |SI #rem00100#93 = "S"; aAlfa = "4"; |FINSI;
   |SI #rem00100#93 = "O"; aAlfa = "5"; |FINSI;
   TipoDato = "An"; Long = 1;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Comunidad autonoma de residencia
   TipoDato = "N";  Long = 2;  aAlfa = #rem00100#11;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Decl.Complementaria a otra del mismo ejercicio o por atrasos de rend.trabajo
   aAlfa = "X";
   |SI #rem00100#97 = "N"; aAlfa = " "; |FINSI;
   TipoDato = "A";  Long = 1;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Fecha y firma de la declaracion : Localidad
   TipoDato = "An"; Long = 20; aAlfa = aLocali1;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ CargaFecha;
   || Fecha y firma de la declaracion : Dia Fecha
   TipoDato = "N";  Long = 2;  aAlfa = DiaInf;       |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Fecha y firma de la declaracion : Mes Fecha
   TipoDato = "A";  Long = 10; aAlfa = MesInf;       |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Fecha y firma de la declaracion : A¤o Fecha
   TipoDato = "N";  Long = 4;  aAlfa = EjerInf;      |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Reservado para la AEAT
   Cadena = Cadena + ("0" * 21);
   || Referencia
   |SI #reemi714#51 = "S";
      aAlfa = VTipo; |QBF aAlfa;
      |SI aAlfa = "ZPATRITIT"; aAlfa = "TITULAR"; |FINSI;
      |SI aAlfa = "ZPATRICON"; aAlfa = "CONYUGE"; |FINSI;
      aAlfa = VEmpresa + " " + aAlfa;
      TipoDato = "An";  Long = 20;                   |HAZ Formateo; Cadena = Cadena + aAlfa;
   |SINO;
      Cadena = Cadena + (" " * 20);
   |FINSI;
   || Sello electronico (reservado a la AEAT)
   Cadena = Cadena + (" " * 13);
   Cadena = Cadena + &13 + &10; |HAZ GrabaCad;
|FPRC;

|PROCESO Lineas;
   |SI #rem00099#3 = "VARIOS    ";
      |SI aContr = "TITULAR   "; |Y #rem00099#20 = 0; |ACABA; |FINSI;
      |SI aContr = "CONYUGE   "; |Y #rem00099#21 = 0; |ACABA; |FINSI;
   |FINSI;

   |SI #rem00099#3 ! aContr;
    |Y #rem00099#3 ! "GANANCIAL ";
    |Y #rem00099#3 ! "VARIOS    ";
      |ACABA;
   |FINSI;

   |SI nCont [ nLimite;
      |SELECT #2#rew00056;
      #rew00056#0 = #rem00099#0;
      |SI #rem00099#1 = "A1";
         |SI #rem00099#22 = "S";
            #rew00056#3 = "A1";
         |SINO;
            #rew00056#3 = "A2";
         |FINSI;
      |SINO;
         #rew00056#3 = #rem00099#1;
      |FINSI;
      #rew00056#4 = #rem00099#2;
      |LEE 000#rew00056.=;
      FEstado = FSalida;
      |SELECT #1#rew00056;
      |SI FEstado ! 0;
         |DDEFECTO #rew00056;
         #rew00056#0 = #rem00099#0;
         #rew00056#1 = nPagina;
         #rew00056#2 = nLinea; nLinea = nLinea + 1;
         |SI #rem00099#1 = "A1";
            |SI #rem00099#22 = "S";
               #rew00056#3 = "A1";
            |SINO;
               #rew00056#3 = "A2";
            |FINSI;
         |SINO;
            #rew00056#3 = #rem00099#1;
         |FINSI;
         #rew00056#4 = #rem00099#2;
         #rew00056#5 = nNumPag - 1;
         #rew00056#6 = 0;
         #rew00056#7 = nPasada;
         |GRABA 020#rew00056.n;
         nCont = nCont + 1;
         nSwDatos = 1;
      |FINSI;
   |SINO;
      |ERROR10;
   |FINSI;
|FPRC;

|DEFBUCLE Lineas;
#rem00099#1;
3,22;
VEmpresa,aTipo,001,"          ",aDHabitual;
VEmpresa,aTipo,999,"zzzzzzzzzz",aHHabitual;
;
NULL,Lineas;
|FIN;

|PROCESO CuentaLin;
   nPorc = 0;
   |SI #rem00099#3 = aContr;       nPorc = 100; |FINSI;
   |SI #rem00099#3 = "GANANCIAL "; nPorc = 50;  |FINSI;
   |SI #rem00099#3 = "VARIOS    ";
      |SI aContr = "TITULAR   "; nPorc = #rem00099#20; |SINO; nPorc = #rem00099#21; |FINSI;
   |FINSI;
   |SI nPorc = 0; |ACABA; |FINSI;

   |SI nPagina = "02";
      |SI #rem00099#1 = "A1"; |Y #rem00099#22 = "S";
         nCont1 = nCont1 + 1; nCalc = (((nCont1 / nLimA1) - 0.51) ! 0) + 1;
         nTotal1 = nTotal1 + ((#rem00099#10 % nPorc) ! 2);
         nTotal2 = nTotal2 + ((#rem00099#23 % nPorc) ! 2);
         nTotal3 = nTotal1 - nTotal2;
      |FINSI;
      |SI #rem00099#1 = "A1"; |Y #rem00099#22 = "N";
         nCont2 = nCont2 + 1; nCalc = (((nCont2 / nLimA2) - 0.51) ! 0) + 1;
         nTotal4 = nTotal4 + ((#rem00099#10 % nPorc) ! 2);
      |FINSI;
      |SI #rem00099#1 = "B1";
         nCont3 = nCont3 + 1; nCalc = (((nCont3 / nLimB1) - 0.51) ! 0) + 1;
      |FINSI;
   |FINSI;
   |SI nPagina = "03";
      |SI #rem00099#1 = "C1";
         nCont1 = nCont1 + 1; nCalc = (((nCont1 / nLimC1) - 0.51) ! 0) + 1;
         nTotal1 = nTotal1 + ((#rem00099#10 % nPorc) ! 2);
      |FINSI;
      |SI #rem00099#1 = "C2";
         nCont2 = nCont2 + 1; nCalc = (((nCont2 / nLimC2) - 0.51) ! 0) + 1;
         nTotal2 = nTotal2 + ((#rem00099#10 % nPorc) ! 2);
      |FINSI;
      |SI #rem00099#1 = "D1";
         nCont3 = nCont3 + 1; nCalc = (((nCont3 / nLimD1) - 0.51) ! 0) + 1;
      |FINSI;
   |FINSI;
   |SI nPagina = "04";
      |SI #rem00099#1 = "E1";
         nCont1 = nCont1 + 1; nCalc = (((nCont1 / nLimE1) - 0.51) ! 0) + 1;
      |FINSI;
      |SI #rem00099#1 = "F1";
         nCont2 = nCont2 + 1; nCalc = (((nCont2 / nLimF1) - 0.51) ! 0) + 1;
      |FINSI;
      |SI #rem00099#1 = "F2";
         nCont3 = nCont3 + 1; nCalc = (((nCont3 / nLimF2) - 0.51) ! 0) + 1;
      |FINSI;
   |FINSI;
   |SI nPagina = "05";
      |SI #rem00099#1 = "G1";
         nCont1 = nCont1 + 1; nCalc = (((nCont1 / nLimG1) - 0.51) ! 0) + 1;
      |FINSI;
      |SI #rem00099#1 = "G2";
         nCont2 = nCont2 + 1; nCalc = (((nCont2 / nLimG2) - 0.51) ! 0) + 1;
      |FINSI;
      |SI #rem00099#1 = "G3";
         nCont3 = nCont3 + 1; nCalc = (((nCont3 / nLimG3) - 0.51) ! 0) + 1;
      |FINSI;
   |FINSI;
   |SI nPagina = "06";
      |SI #rem00099#1 = "G4";
         nCont1 = nCont1 + 1; nCalc = (((nCont1 / nLimG4) - 0.51) ! 0) + 1;
      |FINSI;
      |SI #rem00099#1 = "H1";
         nCont2 = nCont2 + 1; nCalc = (((nCont2 / nLimH1) - 0.51) ! 0) + 1;
      |FINSI;
      |SI #rem00099#1 = "H2";
         nCont3 = nCont3 + 1; nCalc = (((nCont3 / nLimH2) - 0.51) ! 0) + 1;
      |FINSI;
      |SI #rem00099#1 = "I1";
         nCont4 = nCont4 + 1; nCalc = (((nCont4 / nLimI1) - 0.51) ! 0) + 1;
      |FINSI;
      |SI #rem00099#1 = "J1";
         nCont5 = nCont5 + 1; nCalc = (((nCont5 / nLimJ1) - 0.51) ! 0) + 1;
      |FINSI;
   |FINSI;
   |SI nPagina = "07";
      |SI #rem00099#1 = "K1";
         nCont1 = nCont1 + 1; nCalc = (((nCont1 / nLimK1) - 0.51) ! 0) + 1;
      |FINSI;
      |SI #rem00099#1 = "L1";
         nCont2 = nCont2 + 1; nCalc = (((nCont2 / nLimL1) - 0.51) ! 0) + 1;
      |FINSI;
      |SI #rem00099#1 = "M1";
         nCont3 = nCont3 + 1; nCalc = (((nCont3 / nLimM1) - 0.51) ! 0) + 1;
      |FINSI;
      |SI #rem00099#1 = "N1";
         nCont4 = nCont4 + 1; nCalc = (((nCont4 / nLimN1) - 0.51) ! 0) + 1;
      |FINSI;
   |FINSI;
   |SI nPagina = "08";
      |SI #rem00099#1 = "O1";
         nCont1 = nCont1 + 1; nCalc = (((nCont1 / nLimO1) - 0.51) ! 0) + 1;
      |FINSI;
      |SI #rem00099#1 = "P1";
         nCont2 = nCont2 + 1; nCalc = (((nCont2 / nLimP1) - 0.51) ! 0) + 1;
      |FINSI;
      |SI #rem00099#1 = "Q1";
         nCont3 = nCont3 + 1; nCalc = (((nCont3 / nLimQ1) - 0.51) ! 0) + 1;
      |FINSI;
      |SI #rem00099#1 = "U1";
         nCont4 = nCont4 + 1; nCalc = (((nCont4 / nLimU1) - 0.51) ! 0) + 1;
      |FINSI;
   |FINSI;
   |SI nNumPag < nCalc; nNumPag = nCalc; |FINSI;
|FPRC;

|DEFBUCLE CuentaLin;
#rem00099#1;
3;
VEmpresa,aDTipo,001,"          ";
VEmpresa,aHTipo,999,"zzzzzzzzzz";
;
NULL,CuentaLin;
|FIN;

|PROCESO CreaLineas;
   nNumPag = 0; nCont1 = 0; nCont2 = 0; nCont3 = 0; nCont4 = 0; nCont5 = 0;
   |SI nPagina = "02"; aDTipo = "A1"; aHTipo = "B1"; |FINSI;
   |SI nPagina = "03"; aDTipo = "C1"; aHTipo = "D1"; |FINSI;
   |SI nPagina = "04"; aDTipo = "E1"; aHTipo = "F2"; |FINSI;
   |SI nPagina = "05"; aDTipo = "G1"; aHTipo = "G3"; |FINSI;
   |SI nPagina = "06"; aDTipo = "G4"; aHTipo = "J1"; |FINSI;
   |SI nPagina = "07"; aDTipo = "K1"; aHTipo = "N1"; |FINSI;
   |SI nPagina = "08"; aDTipo = "O1"; aHTipo = "U1"; |FINSI;
   |BUCLE CuentaLin;

   |SI nPasada [ nNumPag;
      nCont = 1;
      aDHabitual = " "; aHHabitual = "z";
      |SI aTipo = "A1";               aDHabitual = "S"; aHHabitual = "S"; |FINSI;
      |SI aTipo = "A2"; aTipo = "A1"; aDHabitual = "N"; aHHabitual = "N"; |FINSI;
      |BUCLE Lineas;
      |SI aTipo = "A1"; |Y aDHabitual = "N"; |Y aHHabitual = "N"; aTipo = "A2"; |FINSI;
      |PARA; |SI nCont [ nLimite; |HACIENDO nCont = nCont + 1;
         |DDEFECTO #rew00056;
         #rew00056#0 = VEmpresa;
         #rew00056#1 = nPagina;
         #rew00056#2 = nLinea; nLinea = nLinea + 1;
         #rew00056#3 = aTipo;
         #rew00056#4 = 0;
         |SI nPasada = 1; #rew00056#5 = nNumPag - 1; |FINSI;
         #rew00056#6 = 0;
         #rew00056#7 = nPasada;
         |GRABA 020#rew00056.n;
      |SIGUE;
      |SI aTipo = "A1";
         nImporte = nTotal1; |HAZ GrabaTotal;
         nImporte = nTotal2; |HAZ GrabaTotal;
         nImporte = nTotal3; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "A2";
         nImporte = nTotal4; |HAZ GrabaTotal;
         Bloque = 1; Casilla = " 01"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "B1";
         Bloque = 2; Casilla = " 02"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "C1";
         nImporte = nTotal1; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "C2";
         nImporte = nTotal2; |HAZ GrabaTotal;
         Bloque = 3; Casilla = " 03"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "D1";
         Bloque = 21; Casilla = " 04"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "E1";
         Bloque = 4; Casilla = " 05"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "F1";
         Bloque = 5; Casilla = " 06"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "F2";
         Bloque = 5; Casilla = " 07"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "G1";
         Bloque = 6; Casilla = " 08"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "G2";
         Bloque = 6; Casilla = " 09"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "G3";
         Bloque = 6; Casilla = " 10"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "G4";
         Bloque = 6; Casilla = " 11"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "H1";
         Bloque = 21; Casilla = " 12"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "H2";
         Bloque = 21; Casilla = " 13"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "I1";
         Bloque = 7; Casilla = " 14"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "J1";
         Bloque = 8; Casilla = " 15"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "K1";
         Bloque = 9; Casilla = " 16"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "L1";
         Bloque = 10; Casilla = " 17"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "M1";
         Bloque = 11; Casilla = " 18"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "N1";
         Bloque = 12; Casilla = " 19"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "O1";
         Bloque = 13; Casilla = " 20"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "P1";
         Bloque = 14; Casilla = " 21"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "Q1";
         Bloque = 15; Casilla = " 22"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
      |SI aTipo = "U1";
         Bloque = 17; Casilla = " 24"; |HAZ BuscaCasilla;
         nImporte = Casilla; |HAZ GrabaTotal;
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO GrabaTotal;

   || Graba los totales de los capitulos

   || Si es un total de una hoja anexo, se pone a cero
   |SI nPasada ! 1; nImporte = 0; |FINSI;

   |DDEFECTO #rew00056;
   #rew00056#0 = VEmpresa;
   #rew00056#1 = nPagina;
   #rew00056#2 = nLinea;   nLinea = nLinea + 1;
   #rew00056#3 = aTipo;
   #rew00056#4 = -1;
   #rew00056#5 = nNumPag - 1;
   #rew00056#6 = nImporte;
   #rew00056#7 = nPasada;
   |GRABA 020#rew00056.n;
|FPRC;

|PROCESO CreaTempo;
   || Creamos el temporal indice que luego me indicara que lineas y en
   ||     que orden debo escribirlas en el secuencial

   |SI VTipo = "ZPATRITIT    "; aContr = "TITULAR   "; |FINSI;
   |SI VTipo = "ZPATRICON    "; aContr = "CONYUGE   "; |FINSI;

   aAlfa = "zz" + Usuario; |NOME_DAT #500 aAlfa;
   |DELINDEX #rew00056; |ABRE #rew00056;

   nLinea = 1;
   nPagina = "02"; nSwDatos = 1; nPasada = 1;
   |PARA; |SI nSwDatos ! 0; |HACIENDO;
      nSwDatos = 0;
      || Capitulo A-1 : Bienes inmuebles naturaleza urbana : Vivienda habitual
      nTotal1 = 0; nTotal2 = 0; nTotal3 = 0; nTotal4 = 0;
      nLimite = nLimA1; aTipo  = "A1"; |HAZ CreaLineas;
      || Capitulo A-2 : Bienes inmuebles naturaleza urbana : Otros inmuebles
      nTotal1 = 0; nTotal2 = 0; nTotal3 = 0; nTotal4 = 0;
      nLimite = nLimA2; aTipo  = "A2"; |HAZ CreaLineas;
      Bloque = 1; Casilla = " 01"; |HAZ BuscaCasilla;
      || Capitulo B : Bienes inmuebles naturaleza rustica
      nTotal1 = 0; nTotal2 = 0; nTotal3 = 0;
      nLimite = nLimB1; aTipo  = "B1"; |HAZ CreaLineas;
      nPasada = nPasada + 1;
   |SIGUE;

   nLinea = 1;
   nPagina = "03"; nSwDatos = 1; nPasada = 1;
   |PARA; |SI nSwDatos ! 0; |HACIENDO;
      nSwDatos = 0;
      || Capitulo C-1 : Bienes y derechos emp./prof. no exentos y afectos (excepto inmuebles)
      nTotal1 = 0; nTotal2 = 0; nTotal3 = 0;
      nLimite = nLimC1; aTipo  = "C1"; |HAZ CreaLineas;
      || Capitulo C-2 :Bienes y derechos emp./prof.no exentos y afectos: Inmuebles
      nTotal1 = 0; nTotal2 = 0; nTotal3 = 0;
      nLimite = nLimC2; aTipo  = "C2"; |HAZ CreaLineas;
      || Capitulo D : Bienes y derechos emp./prof.exentos y afectos
      nTotal1 = 0; nTotal2 = 0; nTotal3 = 0;
      nLimite = nLimD1; aTipo  = "D1"; |HAZ CreaLineas;
      nPasada = nPasada + 1;
   |SIGUE;

   nLinea = 1;
   nPagina = "04"; nSwDatos = 1; nPasada = 1;
   |PARA; |SI nSwDatos ! 0; |HACIENDO;
      nSwDatos = 0;
      || Capitulo E-1 : Bienes y derechos : Depositos en cuenta corriente
      nLimite = nLimE1; aTipo  = "E1"; |HAZ CreaLineas;
      || Capitulo F-1 : Bienes y derechos : Valores cesion a terceros : Deuda publica, Obligaciones
      nLimite = nLimF1; aTipo  = "F1"; |HAZ CreaLineas;
      || Capitulo F-2 : Bienes y derechos : Valores cesion a terceros : Certificados, depositos, pagares
      nLimite = nLimF2; aTipo  = "F2"; |HAZ CreaLineas;
      nPasada = nPasada + 1;
   |SIGUE;

   nLinea = 1;
   nPagina = "05"; nSwDatos = 1; nPasada = 1;
   |PARA; |SI nSwDatos ! 0; |HACIENDO;
      nSwDatos = 0;
      || Capitulo G-1 : Bienes y derechos : Valores no exentos : Acciones u partic. fondos Socied./Inversion
      nLimite = nLimG1; aTipo  = "G1"; |HAZ CreaLineas;
      || Capitulo G-2 : Bienes y derechos : Valores no exentos : Acciones u partic. fondos otras entid.
      nLimite = nLimG2; aTipo  = "G2"; |HAZ CreaLineas;
      || Capitulo G-3 : Bienes y derechos : Valores no exentos : Accion./Partic. fondos otras entid.no negoc.
      nLimite = nLimG3; aTipo  = "G3"; |HAZ CreaLineas;
      nPasada = nPasada + 1;
   |SIGUE;

   nLinea = 1;
   nPagina = "06"; nSwDatos = 1; nPasada = 1;
   |PARA; |SI nSwDatos ! 0; |HACIENDO;
      nSwDatos = 0;
      || Capitulo G-4 : Bienes y derechos : Valores no exentos : Acciones y part.no negociadas
      nLimite = nLimG4; aTipo  = "G4"; |HAZ CreaLineas;
      || Capitulo H-1 : Bienes y derechos : Valores partic.fondos : Acciones y part.exentas negociadas
      nLimite = nLimH1; aTipo  = "H1"; |HAZ CreaLineas;
      || Capitulo H-2 : Bienes y derechos : Valores partic.fondos : Acciones y part.exentas no negociadas
      nLimite = nLimH2; aTipo  = "H2"; |HAZ CreaLineas;
      || Capitulo I-1 : Bienes y derechos : Seguros de vida
      nLimite = nLimI1; aTipo  = "I1"; |HAZ CreaLineas;
      || Capitulo J-1 : Bienes y derechos : Rentas temporales y vitalicias
      nLimite = nLimJ1; aTipo  = "J1"; |HAZ CreaLineas;
      nPasada = nPasada + 1;
   |SIGUE;

   nLinea = 1;
   nPagina = "07"; nSwDatos = 1; nPasada = 1;
   |PARA; |SI nSwDatos ! 0; |HACIENDO;
      nSwDatos = 0;
      || Capitulo K-1 : Bienes y derechos : Joyas, pieles caracter suntuario, vehiculos
      nLimite = nLimK1; aTipo  = "K1"; |HAZ CreaLineas;
      || Capitulo L-1 : Bienes y derechos : Objetos de arte y antiguedades
      nLimite = nLimL1; aTipo  = "L1"; |HAZ CreaLineas;
      || Capitulo M-1 : Bienes y derechos : Derechos reales de uso y disfrute
      nLimite = nLimM1; aTipo  = "M1"; |HAZ CreaLineas;
      || Capitulo N-1 : Bienes y derechos : Concesiones administrativas
      nLimite = nLimN1; aTipo  = "N1"; |HAZ CreaLineas;
      nPasada = nPasada + 1;
   |SIGUE;

   nLinea = 1;
   nPagina = "08"; nSwDatos = 1; nPasada = 1;
   |PARA; |SI nSwDatos ! 0; |HACIENDO;
      nSwDatos = 0;
      || Capitulo O-1 : Bienes y derechos : Derechos derivados de la propiedad intelectual e industrial
      nLimite = nLimO1; aTipo  = "O1"; |HAZ CreaLineas;
      || Capitulo P-1 : Bienes y derechos : Opciones contractuales
      nLimite = nLimP1; aTipo  = "P1"; |HAZ CreaLineas;
      || Capitulo Q-1 : Bienes y derechos : Demas bienes y derechos de contenido economico
      nLimite = nLimQ1; aTipo  = "Q1"; |HAZ CreaLineas;
      || Capitulo U-1 : Deudas deducibles
      nLimite = nLimU1; aTipo  = "U1"; |HAZ CreaLineas;
      nPasada = nPasada + 1;
   |SIGUE;

   |CIERRA #rew00056;
|FPRC;

|PROCESO LeeTempo;

   nSwLee = 1;

   |SI nNumPag ! #rew00056#1;
      |SI nNumPag ! 0; Cadena = &13 + &10; |HAZ GrabaCad; |FINSI;
      Cadena = "714" + (("00" + #rew00056#1) % -102);
      |SI #rew00056#7 > 1;
         Cadena = Cadena + "C0";
      |SINO;
         Cadena = Cadena + " " + #rew00056#5;
      |FINSI;
      |HAZ GrabaCad;
      nNumPag = #rew00056#1;
      nNumComp = 1;
   |SINO;
      |SI nNumComp ! #rew00056#7;
         Cadena = &13 + &10;
         Cadena = Cadena + "714" + (("00" + #rew00056#1) % -102);
         |SI #rew00056#7 > 1;
            Cadena = Cadena + "C0";
         |SINO;
            Cadena = Cadena + " " + #rew00056#5;
         |FINSI;
         |HAZ GrabaCad;
         nNumComp = #rew00056#7;
      |FINSI;
   |FINSI;

   #rem00099#0 = #rew00056#0;
   |SI #rew00056#3 = "A2";
      #rem00099#1 = "A1";
   |SINO;
      #rem00099#1 = #rew00056#3;
   |FINSI;
   #rem00099#2 = #rew00056#4;
   |LEE 000#rem00099.=;
   |SI FSalida = 0;

      nPorc = 0;
      |SI #rem00099#3 = aContr;       nPorc = 100; |FINSI;
      |SI #rem00099#3 = "GANANCIAL "; nPorc = 50;  |FINSI;
      |SI #rem00099#3 = "VARIOS    ";
         |SI aContr = "TITULAR   "; nPorc = #rem00099#20; |SINO; nPorc = #rem00099#21; |FINSI;
      |FINSI;
      |SI nPorc = 0; |ACABA; |FINSI;

      || Busco el registro correspondiente y lo escribo en el secuencial ...
      |SI #rew00056#3 = "A1";
         nLimite = nLimA1; TipoDato = "A";  Long = 1;   LongDec = 0;
         aAlfa = #rem00099#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 20;   LongDec = 0;
         aAlfa = #rem00099#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 33;   LongDec = 0;
         aAlfa = #rem00099#6;         |QBF aAlfa; aAlfa = aAlfa + ",";
         aAlfa = aAlfa + #rem00099#7; |QBF aAlfa;
         aAlfa1 = #rem00099#7; |QBF aAlfa1;
         |SI aAlfa1 ! ""; aAlfa = aAlfa + ","; |FINSI;
         enCodProv = #rem00099#8; enCodPobl = #rem00099#9;
         |HAZ LeePoblacion;
         |SI #703#0 ! 0;  |O #703#1 ! 0;
             aAlfa = aAlfa + #703#3; |QBF aAlfa; aAlfa = aAlfa + ", ";
             aAlfa = aAlfa + #703#2;
         |FINSI;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "A2";
         nLimite = nLimA2; TipoDato = "A";  Long = 1;   LongDec = 0;
         aAlfa = #rem00099#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
         aAlfa = #rem00099#19; |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 20;   LongDec = 0;
         aAlfa = #rem00099#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 33;   LongDec = 0;
         aAlfa = #rem00099#6;         |QBF aAlfa; aAlfa = aAlfa + ",";
         aAlfa = aAlfa + #rem00099#7; |QBF aAlfa;
         aAlfa1 = #rem00099#7; |QBF aAlfa1;
         |SI aAlfa1 ! ""; aAlfa = aAlfa + ","; |FINSI;
         enCodProv = #rem00099#8; enCodPobl = #rem00099#9;
         |HAZ LeePoblacion;
         |SI #703#0 ! 0;  |O #703#1 ! 0;
             aAlfa = aAlfa + #703#3; |QBF aAlfa; aAlfa = aAlfa + ", ";
             aAlfa = aAlfa + #703#2;
         |FINSI;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "B1";
         nLimite = nLimB1; TipoDato = "A";  Long = 1;   LongDec = 0;
         aAlfa = #rem00099#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 20;   LongDec = 0;
         aAlfa = #rem00099#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 37;   LongDec = 0;

         enCodProv = #rem00099#8;
         enCodPobl = #rem00099#9;
         |HAZ LeePoblacion;
         |SI #703#0 ! 0;  |O #703#1 ! 0;
             aAlfa = #703#3; |QBF aAlfa; aAlfa = aAlfa + ", ";
             aAlfa = aAlfa + #703#2;
         |SINO;
            aAlfa = "";
         |FINSI;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "C1";
         nLimite = nLimC1; TipoDato = "An";  Long = 5;   LongDec = 0;
         aAlfa = #rem00099#18; |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 28;   LongDec = 0;
         aAlfa = #rem00099#6;         |QBF aAlfa; aAlfa = aAlfa + " ";
         aAlfa = aAlfa + #rem00099#7; |QBF aAlfa; aAlfa = aAlfa + " ";
         aAlfa = aAlfa + (("00" + #rem00099#8) % -102) + (("000" + #rem00099#9) % -103); |QBF aAlfa;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 26;   LongDec = 0;
         aAlfa = #rem00099#15;        |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "C2";
         nLimite = nLimC1; TipoDato = "An";  Long = 5;   LongDec = 0;
         aAlfa = #rem00099#18; |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;   LongDec = 0;
         aAlfa = #rem00099#19; |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 20;   LongDec = 0;
         aAlfa = #rem00099#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 29;   LongDec = 0;
         aAlfa = #rem00099#6;         |QBF aAlfa; aAlfa = aAlfa + " ";
         aAlfa = aAlfa + #rem00099#7; |QBF aAlfa; aAlfa = aAlfa + " ";
         aAlfa = aAlfa + (("00" + #rem00099#8) % -102) + (("000" + #rem00099#9) % -103); |QBF aAlfa;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "D1";
         nLimite = nLimD1; TipoDato = "An";  Long = 5;   LongDec = 0;
         aAlfa = #rem00099#18; |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;   LongDec = 0;
         aAlfa = #rem00099#19; |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 20;   LongDec = 0;
         aAlfa = #rem00099#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 29;   LongDec = 0;
         aAlfa = #rem00099#6;         |QBF aAlfa; aAlfa = aAlfa + " ";
         aAlfa = aAlfa + (("00" + #rem00099#8) % -102) + (("000" + #rem00099#9) % -103); |QBF aAlfa;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "E1";
         nLimite = nLimE1; TipoDato = "An";  Long = 41;   LongDec = 0;
         aAlfa = #rem00099#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 20;   LongDec = 0;
         aAlfa = #rem00099#13; |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "F1";
         nLimite = nLimF1; TipoDato = "An";  Long = 62;   LongDec = 0;
         aAlfa = #rem00099#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "F2";
         nLimite = nLimF2; TipoDato = "An";  Long = 62;   LongDec = 0;
         aAlfa = #rem00099#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "G1";
         nLimite = nLimG1; TipoDato = "An";  Long = 62;   LongDec = 0;
         aAlfa = #rem00099#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "G2";
         nLimite = nLimG2; TipoDato = "An";  Long = 62;   LongDec = 0;
         aAlfa = #rem00099#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "G3";
         nLimite = nLimG3; TipoDato = "An";  Long = 62;   LongDec = 0;
         aAlfa = #rem00099#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "G4";
         nLimite = nLimG4; TipoDato = "An";  Long = 62;   LongDec = 0;
         aAlfa = #rem00099#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "H1";
         nLimite = nLimH1; TipoDato = "An";  Long = 62;   LongDec = 0;
         aAlfa = #rem00099#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "H2";
         nLimite = nLimH2; TipoDato = "An";  Long = 62;   LongDec = 0;
         aAlfa = #rem00099#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "I1";
         nLimite = nLimI1; TipoDato = "An";  Long = 62;   LongDec = 0;
         aAlfa = #rem00099#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "J1";
         nLimite = nLimJ1; TipoDato = "An";  Long = 41;   LongDec = 0;
         aAlfa = #rem00099#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An";  Long = 1;   LongDec = 0;
         aAlfa = #rem00099#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#14 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "K1";
         nLimite = nLimK1; TipoDato = "An";  Long = 62;   LongDec = 0;
         aAlfa = #rem00099#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "L1";
         nLimite = nLimL1; TipoDato = "An";  Long = 62;   LongDec = 0;
         aAlfa = #rem00099#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "M1";
         nLimite = nLimM1; TipoDato = "An";  Long = 1;   LongDec = 0;
         aAlfa = #rem00099#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An";  Long = 20;   LongDec = 0;
         aAlfa = #rem00099#17;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "An";  Long = 21;   LongDec = 0;
         aAlfa = #rem00099#6; |QBF aAlfa;
         |SI aAlfa = ""; aAlfa = #rem00099#15; |FINSI;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#14 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "N1";
         nLimite = nLimN1; TipoDato = "An";  Long = 62;   LongDec = 0;
         aAlfa = #rem00099#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "O1";
         nLimite = nLimO1; TipoDato = "An";  Long = 62;   LongDec = 0;
         aAlfa = #rem00099#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "P1";
         nLimite = nLimP1; TipoDato = "An";  Long = 62;   LongDec = 0;
         aAlfa = #rem00099#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "Q1";
         nLimite = nLimQ1; TipoDato = "An";  Long = 62;   LongDec = 0;
         aAlfa = #rem00099#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |SI #rew00056#3 = "U1";
         nLimite = nLimU1; TipoDato = "An";  Long = 62;   LongDec = 0;
         aAlfa = #rem00099#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;   LongDec = 2;
         nCalc = (#rem00099#10 % nPorc) ! 2; aAlfa = nCalc;
         |HAZ Formateo; Cadena = Cadena + aAlfa;
         nNumero = nNumero + 1;
      |FINSI;
      |HAZ GrabaCad;
   |SINO;
      |SI #rew00056#4 = 0;
         || Relleno de blancos porque no hay registro ...
         |SI #rew00056#3 = "A1";
            nLimite = nLimA1;
            aAlfa = (" " * 54) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "A2";
            nLimite = nLimA2;
            aAlfa = (" " * 55) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "B1";
            nLimite = nLimB1;
            aAlfa = (" " * 58) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "C1";
            nLimite = nLimC1;
            aAlfa = (" " * 59) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "C2";
            nLimite = nLimC2;
            aAlfa = (" " * 55) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "D1";
            nLimite = nLimD1;
            aAlfa = (" " * 55) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "E1";
            nLimite = nLimE1;
            aAlfa = (" " * 61) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "F1";
            nLimite = nLimF1;
            aAlfa = (" " * 62) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "F2";
            nLimite = nLimF2;
            aAlfa = (" " * 62) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "G1";
            nLimite = nLimG1;
            aAlfa = (" " * 62) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "G2";
            nLimite = nLimG2;
            aAlfa = (" " * 62) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "G3";
            nLimite = nLimG3;
            aAlfa = (" " * 62) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "G4";
            nLimite = nLimG4;
            aAlfa = (" " * 62) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "H1";
            nLimite = nLimH1;
            aAlfa = (" " * 62) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "H2";
            nLimite = nLimH2;
            aAlfa = (" " * 62) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "I1";
            nLimite = nLimI1;
            aAlfa = (" " * 62) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "J1";
            nLimite = nLimJ1;
            aAlfa = (" " * 42) + ("0" * 26); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "K1";
            nLimite = nLimK1;
            aAlfa = (" " * 62) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "L1";
            nLimite = nLimL1;
            aAlfa = (" " * 62) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "M1";
            nLimite = nLimM1;
            aAlfa = (" " * 42) + ("0" * 26); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "N1";
            nLimite = nLimN1;
            aAlfa = (" " * 62) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "O1";
            nLimite = nLimO1;
            aAlfa = (" " * 62) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "P1";
            nLimite = nLimP1;
            aAlfa = (" " * 62) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "Q1";
            nLimite = nLimQ1;
            aAlfa = (" " * 62) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |SI #rew00056#3 = "U1";
            nLimite = nLimU1;
            aAlfa = (" " * 62) + ("0" * 13); Cadena = aAlfa; |HAZ GrabaCad;
            nNumero = nNumero + 1;
         |FINSI;
         |HAZ GrabaCad;
      |SINO;
         |SI #rew00056#4 = -1;
            || Es un total de capitulo ...
            TipoDato = "N"; Long = 11;   LongDec = 2;
            aAlfa = #rew00056#6; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
         |SINO;
            || Algo anda mal ...
            |MENAV "    Problemas. Faltan lineas de patrimonio";
            |ERROR; |ACABA;
         |FINSI;
      |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE LeeTempo;
#rew00056#1;
;
INICIO;
FINAL;
;
NULL,LeeTempo;
|FIN;

|PROCESO Hojas_02_a_08;
   nNumPag = 0; nNumComp = 1; nSwLee = 0;
   |BUCLE LeeTempo;
   |SI nSwLee = 1; Cadena = &13 + &10; |HAZ GrabaCad; |FINSI;
|FPRC;

|PROCESO Hoja09;
   Cadena = ""; LongDec = 0;
   Cadena = "71409 ";

   || Liquidacion : (A)  Bienes inmuebles de naturaleza urbana
   TipoDato = "N"; Long = 11; LongDec = 2;
   Bloque = 1; Casilla = " 01"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : (B)  Bienes inmuebles de naturaleza rustica
   Bloque = 2; Casilla = " 02"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : (C)  Bienes y derechos.no exentos afectos a activ.empr./prof.
   Bloque = 3; Casilla = " 03"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : (E)  Depositos en c/c o de ahorro, ctas.financieras y otros tipos
   Bloque = 4; Casilla = " 05"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : (F1) Deuda publica, obligaciones, bonos y dem s valores negociados
   Bloque = 5; Casilla = " 06"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : (F2) Certificados, Depositos, Pagares, Obligaciones, Bonos y dem s
   Bloque = 5; Casilla = " 07"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : (G1) Acciones y partic.capit.social o fondos socdes. Invers.negoc.
   Bloque = 6; Casilla = " 08"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : (G2) Acciones y partic.capit.social o fondos otras entids. Invers.negoc.
   Bloque = 6; Casilla = " 09"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : (G3) Acciones y partic.capit.social o fondos socdes. Invers.no negoc.
   Bloque = 6; Casilla = " 10"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : (G4) Acciones y partic.capit.social o fondos otras entids. Invers.no negoc.
   Bloque = 6; Casilla = " 11"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : (I)  Seguros de vida
   Bloque = 7; Casilla = " 14"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : (J)  Rentas temporales o vitalicias
   Bloque = 8; Casilla = " 15"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : (K)  Joyas, pieles de caracter suntuario, vehiculos, embarcaciones y aeronaves
   Bloque = 9; Casilla = " 16"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : (L)  Objetos de arte y antiguedades
   Bloque = 10; Casilla = " 17"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : (M)  Derechos reales de uso y disfrute
   Bloque = 11; Casilla = " 18"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : (N)  Concesiones administrativas
   Bloque = 12; Casilla = " 19"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Liquidacion : (O)  Derechos derivados de la propiedad intelectual e industrial
   Bloque = 13; Casilla = " 20"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : (P)  Opciones contractuales
   Bloque = 14; Casilla = " 21"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : (Q)  Dem s bienes y derechos de contenido econ¢mico
   Bloque = 15; Casilla = " 22"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Total bienes y derechos no exentos
   Bloque = 16; Casilla = " 23"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Deudas deducibles
   Bloque = 17; Casilla = " 24"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Base imponible
   Bloque = 18; Casilla = " 25"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Reducci¢n para sujetos pasivos por obligaci¢n personal
   Bloque = 19; Casilla = " 26"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Base liquidable
   Bloque = 20; Casilla = " 27"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : (D)  Bienes y derechos exentos
   Bloque = 21; Casilla = " 04"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : (H1) Acciones y participaciones negociadas exentas
   Bloque = 21; Casilla = " 12"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : (H2) Acciones y participaciones no negociadas exentas
   Bloque = 21; Casilla = " 13"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   Cadena = Cadena + &13 + &10;  |HAZ GrabaCad;
|FPRC;

|PROCESO Hoja10;
   Cadena = ""; LongDec = 0;
   Cadena = "71410 ";

   || Liquidacion : Cuota integra : Base liquidable
   TipoDato = "N"; Long = 11; LongDec = 2;
   Bloque = 22; Casilla = " 01"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Cuota integra : Hasta
   Bloque = 22; Casilla = " 02"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Cuota integra : Resultado hasta
   Bloque = 22; Casilla = " 03"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Cuota integra : Resto
   Bloque = 22; Casilla = " 04"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Cuota integra : Al % Parte entera + Al % parte decimal
   Long = 2; LongDec = 2;
   Bloque = 22; Casilla = " 05"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Cuota integra : Resultado resto
   Long = 11; LongDec = 2;
   Bloque = 22; Casilla = " 06"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Cuota integra : Suma
   Bloque = 22; Casilla = " 07"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Cuota integra : Cuota integra
   Bloque = 22; Casilla = " 28"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Limite cuota integra : Cuota integra del I.R.P.F.
   Bloque = 23; Casilla = " 29"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Limite cuota integra : Parte cuota integra de Imp.Patrim. susceptible de limitacion
   Bloque = 23; Casilla = " 30"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Limite cuota integra : Suma de cuotas
   Bloque = 23; Casilla = " 31"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Limite cuota integra : Limite conjunto de cuotas
   Bloque = 23; Casilla = " 32"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Limite cuota integra : a) Exceso
   Bloque = 23; Casilla = " 33"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Limite cuota integra : b) 80% de la cuota integra del Imp.Patrim.
   Bloque = 23; Casilla = " 34"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Total cuota integra : Total cuota integra
   Bloque = 24; Casilla = " 35"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Liquidacion : Deducc.impuestos extranjero : Tipo medio efectivo gravamen (TM)
   Long = 2; LongDec = 2;
   Bloque = 25; Casilla = "TM "; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Deducc.impuestos extranjero : Impuestos efectivamente satisfechos en el extranjero
   Long = 11; LongDec = 2;
   Bloque = 25; Casilla = "a  "; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Deducc.impuestos extranjero : Parte base liquidable grabada en el extranjero
   Bloque = 25; Casilla = "b  "; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Deducc.impuestos extranjero : Importe de la deduccion
   Bloque = 25; Casilla = "z36"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Bonificacion de la cuota en Ceuta y Melilla : Valor neto bienes y derechos Ceuta y Melilla
   Bloque = 26; Casilla = " 37"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Bonificacion de la cuota en Ceuta y Melilla : Parte cuota propor.corresponde a dichos bienes y dchos.
   Bloque = 26; Casilla = " 38"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Bonificacion de la cuota en Ceuta y Melilla : Bonificacion
   Bloque = 26; Casilla = " 39"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Liquidacion : Cuota a ingresar : Cuota a ingresar
   Bloque = 27; Casilla = " 40"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   Cadena = Cadena + &13 + &10; |HAZ GrabaCad;
|FPRC;

|PROCESO Hoja11;
   nSwDatos = 0; nCalc1 = 0;
   aTipo = VTipo % 0110;

   Cadena = "71411 ";

   TipoDato = "N"; Long = 11; LongDec = 2;
   |SI #rem00100#94 = "S"; aAlfa = "X"; |SINO; aAlfa = " "; |FINSI;
   Cadena = Cadena + aAlfa;
   || Liquidacion : Cuota a ingresar
   Bloque = 27;     Casilla = " 40"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa; nTotal = Casilla;
   || Declaracion complementaria : Cuota ingresar resultante declaracion complementaria
   aAlfa = 0; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Declaracion complementaria : Resultado a ingresar de anteriores liq.
   aAlfa = 0; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Declaracion complementaria : Diferencia a ingresar resultado de declaracion complementaria
   aAlfa = 0; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |SI nTotal > 0;
      || Negativa : Declaracion negativa
      aAlfa = " "; Cadena = Cadena + aAlfa;
      || Ingreso : Forma de pago
      |SI #reemi714#50 = "N"; aAlfa = "X "; |SINO; aAlfa = " X"; |FINSI;
      Cadena = Cadena + aAlfa;
      || Ingreso : Importe
      aAlfa = nTotal; |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Ingreso : Codigo cuenta
      |SI #reemi714#50 = "N";
         aAlfa = "0" * 20;
      |SINO;
         aAlfa = aCuenta1;
      |FINSI;
      Cadena = Cadena + aAlfa;
   |SINO;
      aAlfa = "X  " + ("0" * 13);
      Cadena = Cadena + aAlfa;
      |SI #reemi714#50 = "N";
         aAlfa = "0" * 20;
      |SINO;
         aAlfa = aCuenta1;
      |FINSI;
      Cadena = Cadena + aAlfa;
   |FINSI;
   Cadena = Cadena + &13 + &10; |HAZ GrabaCad;
|FPRC;

|PROCESO GrabaCad;
   |SI aIP ! "";
      |XGRABA Handle, Cadena; Cadena = "";
   |SINO;
      Cadena = Handle + " " + Cadena; |FGRABA Cadena; Cadena = "";
   |FINSI;
|FPRC;

***************************************************************************
**** PROCESOS DE IMPRESION ************************************************
***************************************************************************

|PROCESO ImprimeLos;

   aIP = ""; |IP_REMOTO aIP;

   VEmpresa = #99#0; VTipo    = #99#2;
   |HAZ CreaTempo;

   Nombre = ("00000" + VEmpresa) % -105;
   || Nombre = "or" + Nombre; PEPE
   Nombre = "pa" + Nombre;
   |QBF Nombre;
   Comodin = VTipo; |QBF Comodin;
   ||SI Comodin = "ZPATRICON"; Comodin = "P"; |FINSI; PEPE
   ||SI Comodin = "ZPATRITIT"; Comodin = "O"; |FINSI; PEPE
   |SI Comodin = "ZPATRICON"; Comodin = "C"; |FINSI;
   |SI Comodin = "ZPATRITIT"; Comodin = "T"; |FINSI;
   Nombre = Nombre + Comodin;
   |QBF Nombre;

   NEmpresas  = Nombre;
   INEmpresas = INEmpresas + 1;

   ||DBASE Comodin; |QBF Comodin;
   ||Comodin = Comodin + "hacienda/";
   ||Comodin = Comodin + Nombre;
   Comodin = "\MODELOS"; |SI aIP ! ""; |RMKDIR Comodin; |SINO; |MKDIR Comodin; |FINSI;
   Comodin = "\MODELOS\RENTA";         |SI aIP ! ""; |RMKDIR Comodin; |SINO; |MKDIR Comodin; |FINSI;
   |SI #0#49 = "L";
      Comodin = "\MODELOS\RENTA\714"; |SI aIP ! ""; |RMKDIR Comodin; |SINO; |MKDIR Comodin; |FINSI;
      Comodin = "\MODELOS\RENTA\714\" + Nombre;
   |SINO;
      Comodin = "\MODELOS\RENTA\INTERNET";     |SI aIP ! ""; |RMKDIR Comodin; |SINO; |MKDIR Comodin; |FINSI;
      Comodin = "\MODELOS\RENTA\INTERNET\714"; |SI aIP ! ""; |RMKDIR Comodin; |SINO; |MKDIR Comodin; |FINSI;
      Comodin = "\MODELOS\RENTA\INTERNET\714\" + Nombre;
   |FINSI;

   |SI aIP ! "";
      |XABRE "CWB", Comodin, Handle;
   |SINO;
      Comodin = "wb  " + Comodin; |FABRE Comodin;
   |FINSI;
   Handle = FSalida;
   |SI FSalida < 0; |MENSA "    Problemas al abrir el fichero ascii"; |ACABA; |FINSI;
   |HAZ Hoja01;

   |HAZ Hojas_02_a_08;
   |HAZ Hoja09;
   |HAZ Hoja10;
   |HAZ Hoja11;

   |SI aIP ! "";
      |XCIERRA Handle;
   |SINO;
      FSalida = Handle; |FCIERRA FSalida;
   |FINSI;

   SwDatos = 1;

|FPRC;

|PROCESO CopiaFich;
   aIP = ""; |IP_REMOTO aIP;

   |DBASE aAlfa; |QBF aAlfa; aAlfa = aAlfa + "hacienda/";
   aOrigen  = aAlfa + "ir01lase.exe";
   aDestino = "/MODELOS/RENTA/714/ir01lase.exe";
   |SI aIP ! "";
      |ENVIA_FICHERO aOrigen, aDestino;
      aAlfa = "/MODELOS/RENTA/714/imprime.bat";
      |XABRE "CW", aAlfa, Handle;
   |SINO;
      |COPIA_FICHERO aOrigen, aDestino;
      aAlfa = "wt  /MODELOS/RENTA/714/imprime.bat";
      |FABRE aAlfa; Handle = FSalida;
   |FINSI;

   |SI FSalida ] 0;
      Cadena = Cadena + "";
      aAlfa = "CD \MODELOS\RENTA\714";
      |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

      aAlfa = "DEL PA*.TXT";
      |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

      aAlfa = "ir01lase -y";
      |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

      INEmpresas = NEmpresas1<-;
      Nombre = NEmpresas;
      |PARA; |SI Nombre ! ""; |HACIENDO;
         aAlfa = "WAIT R01PDF /E:" + Nombre + " /R:" + Nombre + ".txt /C:" + #reemi714#37;
         |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;
         INEmpresas = INEmpresas + 1;
         Nombre = NEmpresas;
      |SIGUE;

      aAlfa = "del *.WMF";
      |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

      aAlfa = "del *.TAB";
      |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

      aAlfa = "del *.DLL";
      |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

      aAlfa = "del SIGLAS.TXT";
      |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

      aAlfa = "del ERR10001.TXT";
      |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

      aAlfa = "del PAISES.TXT";
      |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

      aAlfa = "del PROVINCI.TXT";
      |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

      aAlfa = "del R01PDF.EXE";
      |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

      aAlfa = "del WAIT.EXE";
      |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

      aAlfa = "del pa*.";
      |SI aIP ! ""; |XGRABA Handle, aAlfa; |SINO; aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa; |FINSI;

      aAlfa = "del ir01lase.exe";
      |SI aIP ! "";
         |XGRABA Handle, aAlfa; |XCIERRA Handle;
      |SINO;
         aAlfa = Handle + " " + aAlfa; |FGRABA aAlfa;
         FSalida = Handle; |FCIERRA FSalida;
      |FINSI;

      aAlfa = "/MODELOS/RENTA/714/imprime.bat";
      |SI aIP ! ""; |RSYSTEM aAlfa; |SINO; |SYSTEM aAlfa; |FINSI;
   |SINO;
      |MENAV "    Problemas para crear el proceso por lotes que ejecuta el programa";
      |ERROR;
   |FINSI;
|FPRC;

|RUTINA inferior;
  #99#0 = 1;
  #99#1 = " ";
|FRUT;

|RUTINA superior;
  #99#0 = 99999;
  #99#1 = "z";
|FRUT;

|DEFBUCLE rew00001;
  #99#1;
  5;
  00000, " ", "S";
  99999, "z", "S";
  ;
  NULL, ImprimeLos;
|FIN;

******************** Tipo de Impresion

|PROCESO funcion1; |TIPO 11;
  |SI FSalida ! 9; |ACABA; |FINSI;

  |LIBERA #99;
  |LEE 140#99=;

  |SI #99#5 = "S"; #99#5 = "N"; |SINO; #99#5 = "S"; |FINSI;
  |PINTA #99#5;
  |GRABA 140#99a;
|FPRC;

|PROCESO MiraLiqui;
     |SI #1#5 ! "714";  |ACABA; |FINSI;

     |SI eaTipoEmi = "I";
         #1#6 = "S";
     |SINO;
         #1#6 = "N";
     |FINSI;

     aAlfa = #99#2; |QBF aAlfa;
     ||SI aAlfa = "ZPATRICON"; aAlfa = "P"; |FINSI; PEPE
     ||SI aAlfa = "ZPATRITIT"; aAlfa = "O"; |FINSI; PEPE
     |SI aAlfa = "ZPATRICON"; aAlfa = "C"; |FINSI;
     |SI aAlfa = "ZPATRITIT"; aAlfa = "T"; |FINSI;
     aAlfa     = aAlfa % 101;
     || aFichero  = "or" + (("00000" + #1#0) % -105) + aAlfa + ".txt"; PEPE
     aFichero  = "pa" + (("00000" + #1#0) % -105) + aAlfa + ".txt";
     aFichero  = "C:/MODELOS/RENTA/714/" + aFichero;
     |XABRE "EC", aFichero, nCanal;
     |SI FSalida < 0;
         #1#6 = "S";
     |FINSI;
     |GRABA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE rem01001;
     #1#1;
     ;
     #99#0, 00, "          ";
     #99#0, 99, "zzzzzzzzzz";
     be;
     NULL, MiraLiqui;
|FIN;

|PROCESO GrabaTempo;
   #99#0 = #rem01001#0;
   #99#1 = "";
   #99#2 = #rem01001#2;
   Comodin = #99#2; |QBF Comodin;
   |SI Comodin = "ZPATRITIT"; Comodin = "T"; |FINSI;
   |SI Comodin = "ZPATRICON"; Comodin = "C"; |FINSI;
   #99#1 = Comodin;
   #99#3 = #rem01001#7;
   #99#4 = 1;
   #99#5 = "S";
   #99#6 = 1;
   #99#7 = "";
   |GRABA 000#99n;
   |SI FSalida = 0;
        SwEstar = 1;
   |FINSI;
|FPRC;

|DEFBUCLE DatosContrib;
  #rem01001#1;
  5,6;
  DEmpre,00,"          ","714",DReimp;
  HEmpre,99,"zzzzzzzzzz","714",HReimp;
  ;
  NULL, GrabaTempo;
|FIN;

|PROCESO CargaTempo;
  |DELINDEX #99;

  SwEstar = 0;

  |ABRE #99;

  |SI #0#36 = "S";
     DReimp = "N"; HReimp = "S";
  |SINO;
     DReimp = "N"; HReimp = "N";
  |FINSI;

  |SI #0#0 = "S";
      DEmpre = #0#1;
      HEmpre = #0#2;
      |BUCLE DatosContrib;
  |SINO;
      |PARA XCampos = 3; |SI XCampos [ 32; |HACIENDO XCampos = XCampos + 1;
            |SI #0XCampos ! 0;
                DEmpre = #0XCampos;
                HEmpre = #0XCampos;
                |BUCLE DatosContrib;
            |FINSI;
      |SIGUE;
  |FINSI;
  |CIERRA #99;

  |SI SwEstar = 0; |ACABA; |FINSI;

  |SI #0#35 = "N"; |ACABA; |FINSI;

  |ENTLINEAL #1#99, -1, 4, 19, 1, inferior, superior;
|FPRC;

|PROCESO Grabalos;
     |BUCLE rem01001;

     enEmpresa     = #99#0;
     enTipoEntrada = 99;
     |SUB_EJECUTA_NP "reacceso";
|FPRC;

|DEFBUCLE rew00001G;
     #99#1;
     5;
     00000, " ", "S";
     99999, "z", "S";
     ;
     NULL, Grabalos;
|FIN;

|PROCESO Emision;
|FPRC;

|PROCESO tipo3; |TIPO 3;
  aAlfa1 = "/MODELOS/RENTA/714/*";
  |R_PDIR aAlfa1;
  |PARA; |SI FSalida = 0; |HACIENDO;
     |RFBORRA aAlfa1; |R_SDIR aAlfa1;
  |SIGUE;

  || Nombre = "or" + Usuario; PEPE
  Nombre = "pa" + Usuario;
  |NOME_DAT #99 Nombre;

  |ABRE #rem01001; |ABRE #rem01002; |ABRE #rem00099;
  |HAZ CargaFecha;
  |HAZ CargaTempo;

  INEmpresas = NEmpresas1<-;
  SwDatos = 0;
  |BUCLE rew00001;
  |SI #0#49 = "L";
     |HAZ CopiaFich;
     eaTipoSec = "714"; |HAZ Errores;
  |FINSI;

  |HAZ Emision;

  |SI #0#49 = "I"; |Y SwDatos = 1;
     |CONFI "    NDesea copiar los ficheros a diskette ?";
     |SI FSalida = 0;
        |MENAV "    Introduzca un diskette vacio en su PC";
        Comodin = "/MODELOS/RENTA/INTERNET/714/";
        INEmpresas = NEmpresas1<-;
        Comodin2 = Comodin + NEmpresas;
        |SI NEmpresas ! "";
           |PARA; |SI NEmpresas ! ""; |HACIENDO;
              aDestino = "a:/" + NEmpresas;
              Comodin1 = "COPY " + Comodin2 + " " + aDestino;
              |RSYSTEM Comodin1;
              |RFBORRA Comodin1;
              INEmpresas = INEmpresas + 1;
              Comodin2 = Comodin + NEmpresas;
           |SIGUE;
        |FINSI;
     |FINSI;
  |FINSI;
  |CIERRA #rem00099; |CIERRA #rem01002; |CIERRA #rem01001;

  |BUCLE rew00001G;
|FPRC;

|PROCESO SeparaNombre;
   aNom = ""; aApel1 = ""; aApel2 = "";
   nInd = 1;
   aLong = aAlfa % 0; nLong = aLong;
   aAlfa1 = "";
   |PARA nCalc = 1; |SI nCalc [ nLong; |HACIENDO nCalc = nCalc + 1;
      nPos = (nCalc * 100) + 1;
      aAlfa2 = aAlfa % nPos;
      |SI aAlfa2 = " "; |O aAlfa2 = ",";
         |SI aAlfa1 ! "DE";
          |Y aAlfa1 ! "LA";
          |Y aAlfa1 ! "LAS";
          |Y aAlfa1 ! "LOS";
          |Y aAlfa1 ! "DEL";
            |SI nInd = 1; aApel1 = aApel1 + aAlfa1 + " "; |FINSI;
            |SI nInd = 2; aApel2 = aApel2 + aAlfa1 + " "; |FINSI;
            |SI nInd ] 3; aNom   = aNom   + aAlfa1 + " "; |FINSI;
             nInd = nInd + 1;
         |SINO;
            |SI nInd > 1; nInd = nInd - 1; |FINSI;
            |SI nInd = 1; aApel1 = aApel1 + aAlfa1 + " "; |FINSI;
            |SI nInd = 2; aApel2 = aApel2 + aAlfa1 + " "; |FINSI;
            |SI nInd ] 3; aNom   = aNom   + aAlfa1 + " "; |FINSI;
         |FINSI;
         aAlfa1 = "";
      |SINO;
         aAlfa1 = aAlfa1 + aAlfa2;
      |FINSI;
   |SIGUE;
|FPRC;

|PROCESO BuscaCasilla;
   #rem01002#0 = VEmpresa;
   #rem01002#1 = " ";
   #rem01002#2 = VTipo;
   #rem01002#3 = Bloque;
   #rem01002#4 = Casilla;
   |LEE 010#rem01002.=;
   |SI FSalida = 0;
       |SI #rem01002#4 = "TME"; |O  #rem01002#4 = "TMA"; |O  #rem01002#4 = "TM ";
           Casilla = #rem01002#8;
       |SINO;
           Casilla = #rem01002#6;
       |FINSI;
       SwError = 0;
       |SI Casilla = 0; |Y #rem01002#8 ! 0;
          Casilla = #rem01002#8;
       |FINSI;
   |SINO;
       Casilla = 0;
       SwError = 1;
   |FINSI;
|FPRC;

|PROCESO CargaFecha;
  DiaInf   = #0#33 % 102;
  MesNum   = #0#33 % 402;
  MesInf   = #0#33 % 402;
  EjerInf  = #0#33 % -104;

  |SI MesNum = "01"; MesInf = "Enero     "; |FINSI;
  |SI MesNum = "02"; MesInf = "Febrero   "; |FINSI;
  |SI MesNum = "03"; MesInf = "Marzo     "; |FINSI;
  |SI MesNum = "04"; MesInf = "Abril     "; |FINSI;
  |SI MesNum = "05"; MesInf = "Mayo      "; |FINSI;
  |SI MesNum = "06"; MesInf = "Junio     "; |FINSI;
  |SI MesNum = "07"; MesInf = "Julio     "; |FINSI;
  |SI MesNum = "08"; MesInf = "Agosto    "; |FINSI;
  |SI MesNum = "09"; MesInf = "Septiembre"; |FINSI;
  |SI MesNum = "10"; MesInf = "Octubre   "; |FINSI;
  |SI MesNum = "11"; MesInf = "Noviembre "; |FINSI;
  |SI MesNum = "12"; MesInf = "Diciembre "; |FINSI;

  MesInf = MesInf > MesInf;
|FPRC;

|PROCESO Formateo;
   |QBF aAlfa;
   |SI TipoDato = "F";
      aAlfa = aAlfa - "."; aAlfa = aAlfa - ".";
      |ACABA;
   |FINSI;
   |SI TipoDato = "N";
      Vacio1 = "0" * Long;
      Vacio2 = "0" * LongDec;
      aAlfa = aAlfa - "-";
      |SI FSalida ! 0;
         nNegativo = 1;
      |SINO;
         nNegativo = 0;
      |FINSI;
   |SINO;
      Vacio1 = " " * Long;
   |FINSI;

   |SI TipoDato ! "N";
      Calc1 = 100 + Long; aAlfa = (aAlfa + Vacio1) % Calc1;
   |SINO;
      |SI LongDec = 0;
         Calc1 = 0 - (100 + Long);
         aAlfa = (Vacio1 + aAlfa) % Calc1;
      |SINO;
         aAlfa = aAlfa - ".";
         |SI FSalida = 0;
            Calc1 = 0 - (100 + Long);
            aAlfa = (Vacio1 + aAlfa) % Calc1;
            aAlfa1 = "0" * LongDec;
         |SINO;
            Calc1 = (((FSalida / 100) ! 0) - 1) + 100;
            Calc2 = (((FSalida / 100) ! 0) * 100) + 99;
            aAlfa1 = aAlfa % Calc2;
            aAlfa = aAlfa % Calc1;
            Calc1 = 0 - (100 + Long);
            aAlfa = (Vacio1 + aAlfa)  % Calc1;
            Calc1 = 100 + LongDec;
            aAlfa1 = (aAlfa1 + Vacio2) % Calc1;
         |FINSI;
         aAlfa = aAlfa + aAlfa1;
      |FINSI;
      |SI nNegativo = 1;
         Calc1 = 0 - (100 + (Long + LongDec)); Calc1 = Calc1 + 1;
         aAlfa = aAlfa % Calc1;
         aAlfa = "N" + aAlfa;
      |FINSI;
   |FINSI;

   aAlfa2 = "";

   |SI TipoDato = "A"; |O TipoDato = "An";
      aLong = aAlfa % 0; nLong = aLong;
      |PARA nCont1 = 1; |SI nCont1 [ nLong; |HACIENDO nCont1 = nCont1 + 1;
         Calc1 = (nCont1 * 100) + 1; aAlfa1  = aAlfa % Calc1;
         aAlfa1 = aAlfa1 > aAlfa1;
         |SI aAlfa1 = " ";                  |VETE Sigue1; |FINSI;
         |SI aAlfa1 ] "A"; |Y aAlfa1 [ "Z"; |VETE Sigue1; |FINSI;
         |SI aAlfa1 ] "0"; |Y aAlfa1 [ "9"; |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "¥"; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "¤"; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "ç"; aAlfa1 = &199;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "Ç"; aAlfa1 = &199;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "-"; aAlfa1 = &45;    |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "'"; aAlfa1 = &49;    |VETE Sigue1; |FINSI;
         |SI TipoDato = "An";
            |SI aAlfa1 = "&"; aAlfa1 = &38;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = ","; aAlfa1 = &44;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = "."; aAlfa1 = &46;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = ":"; aAlfa1 = &58;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = ";"; aAlfa1 = &59;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = "_"; aAlfa1 = &95;    |VETE Sigue1; |FINSI;
         |FINSI;
         aAlfa1 = " ";
|ET Sigue1;
         aAlfa2 = aAlfa2 + aAlfa1;
      |SIGUE;
      aAlfa = aAlfa2;
   |FINSI;
   Calc1 = aAlfa;
   |SI nSwDatos = 0; |Y Calc1 ! 0; nSwDatos = 1; |FINSI;
|FPRC;

|PROCESO TipoContr;
   |QBF aAlfa;
   |SI aSeparada = "S";
     aTipoContr = "2";
   |SINO;
     aTipoContr = "0";
      |SI aAlfa = "TITULAR";   aTipoContr = "2"; |FINSI;
      |SI aAlfa = "CONYUGE";
         |SI VTipo = "CONYUGE      ";aTipoContr = "2"; |SINO;aTipoContr = "3"; |FINSI;
      |FINSI;
      |SI aAlfa = "COMUNES";   aTipoContr = "1"; |FINSI;
      |SI aAlfa = "CONJUNTA";  aTipoContr = "1"; |FINSI;
      |SI aAlfa = "CONJUNTAE"; aTipoContr = "1"; |FINSI;
      |SI aAlfa = "GANANCIAL"; aTipoContr = "1"; |FINSI;
      |SI aAlfa = "1 FAMILIAR";aTipoContr = "4"; |FINSI;
      |SI aAlfa = "2 FAMILIAR";aTipoContr = "5"; |FINSI;
      |SI aAlfa = "3 FAMILIAR";aTipoContr = "6"; |FINSI;
      |SI aAlfa = "4 FAMILIAR";aTipoContr = "7"; |FINSI;
      |SI aAlfa = "VARIOS";    aTipoContr = "2"; |FINSI;
   |FINSI;

|FPRC;

|PROCESO seleccion; |TIPO 0;
|SI enEmpresa ! 0;  |ACABA;  |FINSI;

|SI #0#0 = "S";
    |CAMPO_MODIFICA #0#01, 1, "S";
    |CAMPO_MODIFICA #0#02, 1, "S";

    |PARA xxx = 3; |SI xxx [ 32; |HACIENDO xxx = xxx + 1;
            #0xxx = 0; |PINTA #0xxx;
        |CAMPO_MODIFICA #0xxx, 1, "N";
    |SIGUE;
|SINO;
        #0#1 = 00001;    |PINTA #0#1;   |CAMPO_MODIFICA #0#01, 1, "N";
        #0#2 = 99999;    |PINTA #0#2;   |CAMPO_MODIFICA #0#02, 1, "N";

    |PARA xxx = 3; |SI xxx [ 32; |HACIENDO xxx = xxx + 1;
        |CAMPO_MODIFICA #0xxx, 1, "S";
    |SIGUE;
|FINSI;
|FPRC;

|PROCESO tipo_imp; |TIPO 0;
|SI #0#49 = "O";    alfa1 = "S";   |FINSI;
|SI #0#49 = "L";    alfa1 = "N";   |FINSI;

|C_M #0#33, 1, alfa1;    || fecha de presentacion
|C_M #0#34, 1, alfa1;    || primera hoja en blanco
|C_M #0#37, 1, alfa1;    || nro. de copias
|C_M #0#38, 1, alfa1;    || hoja 1
|C_M #0#39, 1, alfa1;    || hoja 2
|C_M #0#40, 1, alfa1;    || hoja 3
|C_M #0#41, 1, alfa1;    || hoja 4
|C_M #0#42, 1, alfa1;    || hoja 5
|C_M #0#43, 1, alfa1;    || hoja 6
|C_M #0#44, 1, alfa1;    || hoja 7
|C_M #0#45, 1, alfa1;    || hoja 8
|C_M #0#46, 1, alfa1;    || hoja 9
|C_M #0#47, 1, alfa1;    || hoja 10
|C_M #0#48, 1, alfa1;    || hoja Ing./Dev.
|FPRC;

|PROCESO SelecTipo;  |TIPO 0;
  eaTipoEmi = #0#49;
|FPRC;

|PROCESO Tipo8; |TIPO 8;
   ||MENAV "    En espera de los modulos de impresion"; |PTEC 807; |ACABA;
|FPRC;

|PROGRAMA;
     |SI enEmpresa ! 0;
         #0#0 = "S";
         |PARA nCampo = 0;  |SI nCampo [ 32;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
         |SIGUE;
         #0#1 = enEmpresa;  |PINTA #0#1;
         #0#2 = enEmpresa;  |PINTA #0#2;
         |PINPA #0#0;
         |PINDA #0#0;
         |ENDATOS #1#0;
     |SINO;
         |MANTE #0;
     |FINSI;
|FPRO;
