|FICHEROS;
     rezcaptu #0;
     reacceso #1;

     :/integral/def/dsam0000 #2;
     :/modelos/def/dsmom104  #3;
     :/integral/def/dsam0003 #4;
     :/modelos/def/dsmod130  #5;
     :/modelos/def/dsmod131  #6;
     :/modelos/def/dsmom014  #7;
     :/contagen/def/camaasil #8;
     :/contagen/def/canempre #9;
     :/basica/def/agicen14   #10;
     :/modelos/def/dsmom001  #11;
     :/integral/def/dsam0005 #12;
     :/modelos/def/dsmom018  #13;
     :/modelos/def/dsmom017  #14;
     :/modelos/def/dsmom033  #15;
     :/modelos/def/dsmom022  #16;
     :/basica/def/agicen17   #17;
     :/modelos/def/dsmom105  #18;
     :/modelos/def/dsmom051  #19;
     :/modelos/def/dsmom052  #20;
     :/modelos/def/dsmom053  #21;
     :/modelos/def/dsmom010  #22;
     :/modelos/def/dsmom011  #32;
     :/modelos/def/dsmom012  #23;
     :/modelos/def/dsmom013  #24;
     :/modelos/def/dsmom055  #25;
     :/contagen/def/caivalin #26;
     :/contagen/def/camaniva #27;
     :/basica/def/zmonedas   #28;
     :/modelos/def/dsm190ca  #29;
     :/modelos/def/dsm190li  #30;
     :/contagen/def/camoneda #31;

     rem00100 #200;
     reeleact #100;
     rem00506 #101;
     rem00020 #120;
     rem00021 #121;
     rem00025 #125;
     rem00026 #126;
     rem00027 #127;
     rem00028 #128;
     rem00029 #129;
     rem00031 #131;
     rem00032 #132;
     rem00099 #199;
     retabla1 #401;
|FIN;

|VARIABLES;
      aPathFich     = "";
      aAlfa         = "";
      aAlfa1        = "";
      aAlfa2        = "";
      aBase         = "";
      aNif          = "";

      nSwPatrimonio = 0;
      nSwPasa       = 0;
      nPorce        = 0;
      nDepar        = 0;
      nEmpresa      = 0;
      nActividad    = 0;
      nCampo        = 0;
      nFactor       = 0;
      nCampo1       = 0;
      nCampo2       = 0;
      nPorce1       = 0;
      nPorce2       = 0;
      nResto        = 0;
      nDifer        = 0;
      nCampoRdto    = 0;
      nSwAsala2     = 0;
      nLinea        = 0;
      nRefer        = 0;
      nCanti1       = 0;
      nCanti2       = 0;
      nContaAct     = 0;
      nError        = 0;
      nImporte      = 0;
      nEmpresaAnt   = 0;
      nCasilla      = 0;
      nLimite       = 0;
      nSwInMobi     = 0;
      nTotal        = 0;
      nUni          = 0;
      nRetencion    = 0;
      nHayTrabaj    = 0;
      nComprueba    = 0;
      nDComple      = 0;
      nHComple      = 0;
      nConversor    = 0;
      nOpera        = 0;
      nPlanilla     = 0;
      nEnExi        = 0;
      nNume         = 0;
      nRetencion1   = 0;
      nRetencion2   = 0;
      nGananPerd    = 0;

     &eaLetra      = "";
     &eaDeclarante = "";
     &eaDeDonde    = "";
     &eaLinDonde   = "";
     &eaAnyoUsu    = "";
     &eaPatr06     = "";
     &eaPatr07     = "";
     &eaPatr08     = "";
     &eaPatr09     = "";
     &eaPatr10     = "";
     &eaPatr11     = "";
     &eaPatr12     = "";
     &eaPatr13     = "";
     &eaPatr14     = "";
     &eaPatr15     = "";
     &eaPatr16     = "";
     &eaPatr16_1   = "";
     &eaPatr17     = "";
     &eaPatr18     = "";
     &eaPatr19     = "";
     &eaPatr20     = "";
     &eaPatr21     = "";
     &eaPatr22     = "";
     &eaPatr23     = "";
     &enAmortiza   = 0;
     &enActividad  = 0;
     &enSwPasa     = 0;
     &enTipoGanan  = 0;
     &eaPerceptor   = "";

     &enEmpresa  = 0;
     &eaPrograma = "";
     &eaPunto    = "";
|FIN;

|| \_________________________________ Recogida desde Modulos

|PROCESO Incentivo2001;
     nPorce1 = 0;
     |SI nDifer > 0;  nPorce1 = nDifer * .40;  |FINSI;

     nPorce2 = 0;
     |SI #127#53 = "I";
         |SI nResto > 8;
             nPorce  = nResto - 8;
             nPorce2 = nPorce2 + (nPorce * 0.30);
             nResto  = 8;
         |FINSI;

         |SI nResto > 5;
             nPorce  = nResto - 5;
             nPorce2 = nPorce2 + (nPorce * 0.25);
             nResto  = 5;
         |FINSI;

         |SI nResto > 3;
             nPorce  = nResto - 3;
             nPorce2 = nPorce2 + (nPorce * 0.20);
             nResto  = 3;
         |FINSI;

         |SI nResto > 1;
             nPorce  = nResto - 1;
             nPorce2 = nPorce2 + (nPorce * 0.15);
             nResto  = 1;
         |FINSI;

         |SI nResto > 0;
             nPorce2 = nPorce2 + (nResto * 0.10);
         |FINSI;
     |FINSI;

     |SI #127#53 = "P";
         |SI nResto > 0;    |Y nResto [ 1;  nPorce2 = 0.10;  |FINSI;
         |SI nResto ] 1.01; |Y nResto [ 3;  nPorce2 = 0.15;  |FINSI;
         |SI nResto ] 3.01; |Y nResto [ 5;  nPorce2 = 0.20;  |FINSI;
         |SI nResto ] 5.01; |Y nResto [ 8;  nPorce2 = 0.25;  |FINSI;
         |SI nResto > 8;                    nPorce2 = 0.30;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO TotalModulo;
     |ABRE #100;
     #100#0 = #127#16;
     #100#1 = #127#17;
     #100#2 = #127#18;
     |LEE 040#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;
     |CIERRA #100;

     nSwAsala2 = 0;
     aAlfa     = #100#1 % 103;
     |SI aAlfa = "644";  nSwAsala2 = 1;  |FINSI;

     #127#55 = #127#31;
     #127#57 = #127#38;
     #127#60 = 0;
     #127#62 = 0;
     |SI nSwAsala2 = 1;  #127#60 = #127#32;  #127#62 = #127#39;  |FINSI;

     || Minoracion de Empleo

     nResto   = #127#54 + #127#59;
     #127#56  = 0;
     #127#61  = 0;
     #127#58  = 0;
     #127#63  = 0;
     nPorce1  = 0;
     nPorce2  = 0;
     nDifer   = (#127#55 + #127#60) - (#127#54 + #127#59);
     |SI nDifer < 0;  nResto = #127#55 + #127#60;  |FINSI;
     |HAZ Incentivo2001;
     #127#56   = 0;
     #127#61   = 0;
     |SI #127#55 ! 0;
         #127#56   = nPorce1 + (nPorce2 * (#127#55 / (#127#55 + #127#60)));
     |FINSI;
     |SI #127#60 ! 0;
         #127#61   = nPorce1 + (nPorce2 * (#127#60 / (#127#55 + #127#60)));
     |FINSI;
     #127#58   = #127#57 * #127#56;
     #127#63   = #127#62 * #127#61;
     #127#64   = #127#58 + #127#63;

     || Minoracion Inversion

     #127#78 = #127#65 + #127#68 + #127#71 + #127#74 + #127#77;

     ||  Rdto Neto Minorado

     #127#79 = #127#52 - #127#64 - #127#78;

     ||  Quioscos

     #127#81  = #127#79 * #127#80;
     |SI #100#32 = "N";  #127#81 = 0;  |FINSI;
     |SI #127#81 < 0;    #127#81 = 0;  |FINSI;

     ||  Taxis

     #127#83  = #127#79 * #127#82;
     |SI #100#33 = "N";  #127#83 = 0;  |FINSI;
     |SI #127#83 < 0;    #127#83 = 0;  |FINSI;

     ||  Urbanos

     #127#85  = #127#79 * #127#84;
     |SI #100#35 = "N";  #127#85 = 0;  |FINSI;
     |SI #127#85 < 0;    #127#85 = 0;  |FINSI;

     ||  Mercancias

     #127#87  = #127#79 * #127#86;
     |SI #100#34 = "N";  #127#87 = 0;  |FINSI;
     |SI #127#55 ! 0;    #127#87 = 0;  |FINSI;
     |SI #127#60 ! 0;    #127#87 = 0;  |FINSI;
     |SI #127#87 < 0;    #127#87 = 0;  |FINSI;

     ||  Empresas Peque¤as dimensiones

     nCampoRdto = 79;
     |SI #127#81 ! 0;  nCampoRdto = 81;  |FINSI;

     #127#89 = #127nCampoRdto * #127#88;
     |SI #127#83 ! 0; |O #127#85 ! 0; |O #127#87 ! 0;
         #127#89 = 0;
     |FINSI;

     |SI #127#89 < 0;  #127#89 = 0;  |FINSI;

     ||  Temporada

     nCampoRdto = 79;
     |SI #127#81 ! 0;  nCampoRdto = 81;  |FINSI;
     |SI #127#83 ! 0;  nCampoRdto = 83;  |FINSI;
     |SI #127#85 ! 0;  nCampoRdto = 85;  |FINSI;
     |SI #127#87 ! 0;  nCampoRdto = 87;  |FINSI;
     |SI #127#89 ! 0;  nCampoRdto = 89;  |FINSI;

     #127#92 = #127nCampoRdto * #127#91;
     |SI #127#92 < 0;  #127#92 = 0;  |FINSI;

     || Exceso

     nCampoRdto = 79;
     |SI #127#81 ! 0;  nCampoRdto = 81;  |FINSI;
     |SI #127#83 ! 0;  nCampoRdto = 83;  |FINSI;
     |SI #127#85 ! 0;  nCampoRdto = 85;  |FINSI;
     |SI #127#87 ! 0;  nCampoRdto = 87;  |FINSI;
     |SI #127#89 ! 0;  nCampoRdto = 89;  |FINSI;
     |SI #127#92 ! 0;  nCampoRdto = 92;  |FINSI;

     #127#95  = #100#31;
     #127#93  = #127nCampoRdto - #127#95;
     #127#94  = #127#95 + (#127#93 * 1.30);
     |SI #127#93 < 0;  #127#94 = 0;  |FINSI;
     |SI #100#31 = 0;  #127#94 = 0;  |FINSI;
     |SI #127#89 ! 0;  #127#94 = 0;  |FINSI;

     || Nueva Actividad

     nCampoRdto = 79;
     |SI #127#81 ! 0;  nCampoRdto = 81;  |FINSI;
     |SI #127#83 ! 0;  nCampoRdto = 83;  |FINSI;
     |SI #127#85 ! 0;  nCampoRdto = 85;  |FINSI;
     |SI #127#87 ! 0;  nCampoRdto = 87;  |FINSI;
     |SI #127#89 ! 0;  nCampoRdto = 89;  |FINSI;
     |SI #127#92 ! 0;  nCampoRdto = 92;  |FINSI;
     |SI #127#94 ! 0;  nCampoRdto = 94;  |FINSI;

     #127#97 = #127nCampoRdto * #127#96;
     |SI #127#92 ! 0;  #127#97 = 0;  |FINSI;
     |SI #127#97 < 0;  #127#97 = 0;  |FINSI;

     || Rendimiento Neto Modulos Ajustado

     nCampoRdto = 79;
     |SI #127#81 ! 0;  nCampoRdto = 81;  |FINSI;
     |SI #127#83 ! 0;  nCampoRdto = 83;  |FINSI;
     |SI #127#85 ! 0;  nCampoRdto = 85;  |FINSI;
     |SI #127#87 ! 0;  nCampoRdto = 87;  |FINSI;
     |SI #127#89 ! 0;  nCampoRdto = 89;  |FINSI;
     |SI #127#92 ! 0;  nCampoRdto = 92;  |FINSI;
     |SI #127#94 ! 0;  nCampoRdto = 94;  |FINSI;
     |SI #127#97 ! 0;  nCampoRdto = 97;  |FINSI;

     #127#98  = #127nCampoRdto;

     || Rendimiento Neto Calculado

     #127#110 = #127#98 - #127#109;

     || Rdto Neto

     #127#114 = #127#110 - #127#112 + #127#113;

     || Reduccion Articulo 30 Ley 40/1998

     #127#116 = 0;
     |SI #127#115 = "S";
          #127#116 = #127#114 % 30;
     |FINSI;

     || Rdto Neto Reducido

     #127#117 = #127#114 - #127#116;
|FPRC;

|PROCESO ModModulo;
     #14#0  = #13#0;
     #14#1  = #13#1;
     #14#2  = #13#2;
     #14#3  = #13#3;
     |LEE 040#14=;
     |SI FSalida ! 0;  |DDEFECTO #14;  |FINSI;

     #100#0 = #14#4;
     #100#1 = #14#5;
     #100#2 = #14#6;
     |LEE 040#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;

     |ABRE #12;
     #12#0 = #10#0;
     #12#1 = #10#1;
     |LEE 040#12=;
     |SI FSalida ! 0;  |DDEFECTO #12;  |FINSI;
     |CIERRA #12;

     #127#0 = #10#18;
     #127#1 = nContaAct;
     |LEE 101#127=;
     |SI FSalida ! 0;
         |DDEFECTO #127;
         #127#0 = #10#18;
         #127#1 = nContaAct;
         |GRABA 020#127b;
     |FINSI;

     #127#2  = eaPerceptor;
     #127#3  = "A";
     #127#4  = 0;
     |SI nPorce ! 100;
         #127#14 = "S";
         #127#19 = #2#3;
     |FINSI;
     #127#15 = nPorce;
     #127#16 = #14#4;
     #127#17 = #14#5;
     #127#18 = #14#6;
     #127#20 = #100#3;
     #127#21 = #12#9;
     #127#22 = #12#10;
     aAlfa   = #12#3 + " " + #12#4;  |QBF aAlfa;
     aAlfa   = aAlfa + " " + #12#5;
     #127#23 = aAlfa;

     #127#24 = #100#5;
     #127#25 = #100#8;
     #127#26 = #100#11;
     #127#27 = #100#14;
     #127#28 = #100#17;
     #127#29 = #100#20;
     #127#30 = #100#23;

     #127#38 = #100#6;
     #127#39 = #100#9;
     #127#40 = #100#12;
     #127#41 = #100#15;
     #127#42 = #100#18;
     #127#43 = #100#21;
     #127#44 = #100#24;

     nUni    = #13#48;
     nTotal  = #13#15 * #13#48;
     |SI nTotal ! #13#59;
         nUni = #13#59 / #13#15;
     |FINSI;
     #127#31 = nUni;

     nUni    = #13#49;
     nTotal  = #13#16 * #13#49;
     |SI nTotal ! #13#60;
         nUni = #13#60 / #13#16;
     |FINSI;
     #127#32 = nUni;

     nUni    = #13#50;
     nTotal  = #13#17 * #13#50;
     |SI nTotal ! #13#61;
         nUni = #13#61 / #13#17;
     |FINSI;
     #127#33 = nUni;

     nUni    = #13#51;
     nTotal  = #13#18 * #13#51;
     |SI nTotal ! #13#62;
         nUni = #13#62 / #13#18;
     |FINSI;
     #127#34 = nUni;

     nUni    = #13#52;
     nTotal  = #13#19 * #13#52;
     |SI nTotal ! #13#63;
         nUni = #13#63 / #13#19;
     |FINSI;
     #127#35 = nUni;

     nUni    = #13#53;
     nTotal  = #13#20 * #13#53;
     |SI nTotal ! #13#64;
         nUni = #13#64 / #13#20;
     |FINSI;
     #127#36 = nUni;

     nUni    = #13#54;
     nTotal  = #13#21 * #13#54;
     |SI nTotal ! #13#65;
         nUni = #13#65 / #13#21;
     |FINSI;
     #127#37 = nUni;

     aAlfa = #100#36;  |QBT aAlfa;
     |SI aAlfa ! "";
         aAlfa1 = aAlfa % 101;
         aAlfa2 = aAlfa % 215;
         nOpera = aAlfa2;
         |SI aAlfa1 = "/";  #127#31 = #127#31 / nOpera;  |FINSI;
         |SI aAlfa1 = "*";  #127#31 = #127#31 * nOpera;  |FINSI;
     |FINSI;

     aAlfa = #100#37;  |QBT aAlfa;
     |SI aAlfa ! "";
         aAlfa1 = aAlfa % 101;
         aAlfa2 = aAlfa % 215;
         nOpera = aAlfa2;
         |SI aAlfa1 = "/";  #127#32 = #127#32 / nOpera;  |FINSI;
         |SI aAlfa1 = "*";  #127#32 = #127#32 * nOpera;  |FINSI;
     |FINSI;

     aAlfa = #100#38;  |QBT aAlfa;
     |SI aAlfa ! "";
         aAlfa1 = aAlfa % 101;
         aAlfa2 = aAlfa % 215;
         nOpera = aAlfa2;
         |SI aAlfa1 = "/";  #127#33 = #127#33 / nOpera;  |FINSI;
         |SI aAlfa1 = "*";  #127#33 = #127#33 * nOpera;  |FINSI;
     |FINSI;

     aAlfa = #100#39;  |QBT aAlfa;
     |SI aAlfa ! "";
         aAlfa1 = aAlfa % 101;
         aAlfa2 = aAlfa % 215;
         nOpera = aAlfa2;
         |SI aAlfa1 = "/";  #127#34 = #127#34 / nOpera;  |FINSI;
         |SI aAlfa1 = "*";  #127#34 = #127#34 * nOpera;  |FINSI;
     |FINSI;

     aAlfa = #100#40;  |QBT aAlfa;
     |SI aAlfa ! "";
         aAlfa1 = aAlfa % 101;
         aAlfa2 = aAlfa % 215;
         nOpera = aAlfa2;
         |SI aAlfa1 = "/";  #127#35 = #127#35 / nOpera;  |FINSI;
         |SI aAlfa1 = "*";  #127#35 = #127#35 * nOpera;  |FINSI;
     |FINSI;

     aAlfa = #100#41;  |QBT aAlfa;
     |SI aAlfa ! "";
         aAlfa1 = aAlfa % 101;
         aAlfa2 = aAlfa % 215;
         nOpera = aAlfa2;
         |SI aAlfa1 = "/";  #127#36 = #127#36 / nOpera;  |FINSI;
         |SI aAlfa1 = "*";  #127#36 = #127#36 * nOpera;  |FINSI;
     |FINSI;

     aAlfa = #100#42;  |QBT aAlfa;
     |SI aAlfa ! "";
         aAlfa1 = aAlfa % 101;
         aAlfa2 = aAlfa % 215;
         nOpera = aAlfa2;
         |SI aAlfa1 = "/";  #127#37 = #127#37 / nOpera;  |FINSI;
         |SI aAlfa1 = "*";  #127#37 = #127#37 * nOpera;  |FINSI;
     |FINSI;

     #127#52 = 0;
     |PARA nCampo = 45;  |SI nCampo [ 51;  |HACIENDO nCampo = nCampo + 1;
           nCampo1 = nCampo - 14;
           nCampo2 = nCampo - 7;
           #127nCampo = #127nCampo1 * #127nCampo2;
           #127#52 = #127#52 + #127nCampo;
     |SIGUE;

     #127#53  = #13#133;

     #127#54  = #13#194;
     #127#55  = #13#98;
     #127#56  = #13#195;
     #127#57  = #127#38;
     #127#58  = #13#196;

     #127#59  = #13#197;
     #127#60  = #13#100;
     #127#61  = #13#198;
     #127#62  = #127#39;
     #127#63  = #13#199;

     #127#65  = #13#201;
     #127#66  = #13#202;
     #127#67  = #13#203;
     #127#68  = #13#204;
     #127#69  = #13#205;
     #127#70  = #13#206;
     #127#71  = #13#207;
     #127#72  = #13#208;
     #127#73  = #13#209;
     #127#74  = #13#210;
     #127#75  = #13#211;
     #127#76  = #13#212;
     #127#77  = #13#213;
     #127#80  = #13#216;
     #127#82  = #13#218;
     #127#84  = #13#220;
     #127#86  = #13#222;
     #127#88  = #13#224;
     #127#90  = #13#226;
     #127#91  = #13#227;
     #127#92  = #13#228;
     #127#93  = #13#229;
     #127#94  = #13#230;
     #127#95  = #13#231;
     #127#96  = #13#232;
     #127#109 = #13#245;
     #127#113 = #13#249;
     #127#115 = #13#251;

     |HAZ TotalModulo;

     |GRABA 020#127a;
     |LIBERA #127;

     eaPrograma   = "rem00027";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE dsmom018;
     #13#1;
     ;
     nEmpresa, 2001, 00, nActividad;
     nEmpresa, 2001, 99, nActividad;
     ;
     NULL, ModModulo;
|FIN;

|PROCESO Modulos;
     |PINPA #0#0;
     |ATRI S;   |PINTA 1257, "*";  |ATRI s;

     |ABRE #100;
     |ABRE #127;
     |ABRE #14;
     |BUCLE dsmom018;
     |CIERRA #100;
     |CIERRA #127;
     |CIERRA #14;
|FPRC;

|| \_________________________________ Recogida desde Contabilidad

|PROCESO ModNormal;
     |ABRE #12;
     #12#0 = #10#0;
     #12#1 = #10#1;
     |LEE 040#12=;
     |SI FSalida ! 0;  |DDEFECTO #12;  |FINSI;
     |CIERRA #12;

     |ABRE #125;
     #125#0 = #10#18;
     #125#1 = nContaAct;
     |LEE 101#125=;
     |SI FSalida ! 0;
         |DDEFECTO #125;
         #125#0 = #10#18;
         #125#1 = nContaAct;
         |GRABA 020#125b;
     |FINSI;

     #125#2  = eaPerceptor;
     #125#3  = "A";
     #125#4  = 0;
     |SI nPorce ! 100;
         #125#14 = "S";
         #125#21 = #2#3;
     |FINSI;
     #125#15 = nPorce;

                      #125#17 = "1";
     |SI #10#16 = 1;  #125#17 = "1";  |FINSI;
     |SI #10#16 = 2;  #125#17 = "3";  |FINSI;
     |SI #10#16 = 3;  #125#17 = "2";  |FINSI;
     |SI #10#16 = 5;  #125#17 = "4";  |FINSI;
     |SI #10#16 = 4;  #125#17 = "5";  |FINSI;

     #125#18 = #10#2;
     #125#19 = #10#3;
     |SI #125#19 = "9999";  #125#19 = "    ";  |FINSI;
     #125#22 = #10#4;
     #125#23 = #12#9;
     #125#24 = #12#10;
     aAlfa  = #12#3 + " " + #12#4;  |QBF aAlfa;
     aAlfa  = aAlfa + " " + #12#5;
     #125#25 = aAlfa;

     |SI #7#7 = 01;  #125#26 = #125#26 + nImporte;  |FINSI;
     |SI #7#7 = 02;  #125#27 = #125#27 + nImporte;  |FINSI;
     |SI #7#7 = 03;  #125#28 = #125#28 + nImporte;  |FINSI;
     |SI #7#7 = 04;  #125#30 = #125#30 + nImporte;  |FINSI;
     |SI #7#7 = 05;  #125#31 = #125#31 + nImporte;  |FINSI;
     |SI #7#7 = 06;  #125#32 = #125#32 + nImporte;  |FINSI;
     |SI #7#7 = 07;  #125#33 = #125#33 + nImporte;  |FINSI;
     |SI #7#7 = 08;  #125#34 = #125#34 + nImporte;  |FINSI;
     |SI #7#7 = 09;  #125#35 = #125#35 + nImporte;  |FINSI;
     |SI #7#7 = 10;  #125#36 = #125#36 + nImporte;  |FINSI;
     |SI #7#7 = 11;  #125#37 = #125#37 + nImporte;  |FINSI;
     |SI #7#7 = 12;  #125#38 = #125#38 + nImporte;  |FINSI;
     |SI #7#7 = 13;  #125#39 = #125#39 + nImporte;  |FINSI;
     |SI #7#7 = 14;  #125#40 = #125#40 + nImporte;  |FINSI;
     |SI #7#7 = 15;  #125#41 = #125#41 + nImporte;  |FINSI;
     |SI #7#7 = 16;  #125#42 = #125#42 + nImporte;  |FINSI;
     |SI #7#7 = 17;  #125#43 = #125#43 + nImporte;  |FINSI;

     #125#29 = #125#26 + #125#27 + #125#28;
     #125#44 = 0;
     |PARA nCampo = 30;  |SI nCampo [ 43;  |HACIENDO nCampo = nCampo + 1;
           #125#44 = #125#44 + #125nCampo;
     |SIGUE;

     #125#45 = #125#29 - #125#44;
     #125#47 = 0;
     |SI #125#46 = "S";  #125#47 = #125#45 % 30;  |FINSI;
     |SI #125#47 < 0;    #125#47 = 0;             |FINSI;
     #125#48 = #125#45 - #125#47;

     |GRABA 020#125a;
     |LIBERA #125;
     |CIERRA #125;

     eaPrograma   = "rem00025";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO ModSimpli;
     |ABRE #12;
     #12#0 = #10#0;
     #12#1 = #10#1;
     |LEE 040#12=;
     |SI FSalida ! 0;  |DDEFECTO #12;  |FINSI;
     |CIERRA #12;

     |ABRE #126;
     #126#0 = #10#18;
     #126#1 = nContaAct;
     |LEE 101#126=;
     |SI FSalida ! 0;
         |DDEFECTO #126;
         #126#0 = #10#18;
         #126#1 = nContaAct;
         |GRABA 020#126b;
     |FINSI;

     #126#2  = eaPerceptor;
     #126#3  = "A";
     #126#4  = 0;
     |SI nPorce ! 100;
         #126#14 = "S";
         #126#21 = #2#3;
     |FINSI;
     #126#15 = nPorce;

                      #126#17 = "1";
     |SI #10#16 = 1;  #126#17 = "1";  |FINSI;
     |SI #10#16 = 2;  #126#17 = "3";  |FINSI;
     |SI #10#16 = 3;  #126#17 = "2";  |FINSI;
     |SI #10#16 = 5;  #126#17 = "4";  |FINSI;
     |SI #10#16 = 4;  #126#17 = "5";  |FINSI;

     #126#18 = #10#2;
     #126#19 = #10#3;
     |SI #126#19 = "9999";  #126#19 = "    ";  |FINSI;
     #126#22 = #10#4;
     #126#23 = #12#9;
     #126#24 = #12#10;
     aAlfa  = #12#3 + " " + #12#4;  |QBF aAlfa;
     aAlfa  = aAlfa + " " + #12#5;
     #126#25 = aAlfa;

     |SI #7#8 = 01;  #126#26 = #126#26 + nImporte;  |FINSI;
     |SI #7#8 = 02;  #126#27 = #126#27 + nImporte;  |FINSI;
     |SI #7#8 = 03;  #126#28 = #126#28 + nImporte;  |FINSI;
     |SI #7#8 = 04;  #126#30 = #126#30 + nImporte;  |FINSI;
     |SI #7#8 = 05;  #126#31 = #126#31 + nImporte;  |FINSI;
     |SI #7#8 = 06;  #126#32 = #126#32 + nImporte;  |FINSI;
     |SI #7#8 = 07;  #126#33 = #126#33 + nImporte;  |FINSI;
     |SI #7#8 = 08;  #126#34 = #126#34 + nImporte;  |FINSI;
     |SI #7#8 = 09;  #126#35 = #126#35 + nImporte;  |FINSI;
     |SI #7#8 = 10;  #126#36 = #126#36 + nImporte;  |FINSI;
     |SI #7#8 = 11;  #126#37 = #126#37 + nImporte;  |FINSI;
     |SI #7#8 = 12;  #126#38 = #126#38 + nImporte;  |FINSI;
     |SI #7#8 = 13;  #126#39 = #126#39 + nImporte;  |FINSI;
     |SI #7#8 = 14;  #126#40 = #126#40 + nImporte;  |FINSI;
     |SI #7#8 = 15;  #126#41 = #126#41 + nImporte;  |FINSI;
     |SI #7#8 = 16;  #126#49 = #126#49 + nImporte;  |FINSI;

     #126#29 = #126#26 + #126#27 + #126#28;
     #126#42 = 0;
     |PARA nCampo = 30;  |SI nCampo [ 41;  |HACIENDO nCampo = nCampo + 1;
           #126#42 = #126#42 + #126nCampo;
     |SIGUE;

     #126#43 = #126#29 - #126#42;

     #126#44 = #126#49;
     |SI #126#17 ! "2";
         |SI #126#43 > 0;  #126#44 = #126#44 + (#126#43 % 5);   |FINSI;
     |SINO;
         |SI #126#43 > 0;  #126#44 = #126#44 + (#126#43 % 10);  |FINSI;
     |FINSI;

     #126#45 = #126#43 - #126#44;
     #126#47 = 0;
     |SI #126#46 = "S";  #126#47 = #126#45 % 30;  |FINSI;
     |SI #126#47 < 0;    #126#47 = 0;             |FINSI;
     #126#48 = #126#45 - #126#47;

     |GRABA 020#126a;
     |LIBERA #126;
     |CIERRA #126;

     eaPrograma   = "rem00026";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO BuscaCodigo;
     |SI #101#3 = #15#5;
         nLinea = #101#1;
         |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE rem00506;
     #101#1;
     ;
     #15#3, 1;
     #15#3, 4;
     ;
     NULL, BuscaCodigo;
|FIN;

|PROCESO CogeLineal;
     #128#25 = #128#25 + #129#6;

     |SI #129#8 = "N";
         #128#26 = #128#26 + #129#7;
     |SINO;
         #128#27 = #128#27 + #129#7;
     |FINSI;
|FPRC;

|DEFBUCLE rem00029;
     #129#1;
     ;
     #128#0, #128#1, 00;
     #128#0, #128#1, 99;
     be;
     NULL, CogeLineal;
|FIN;

|PROCESO TotalAgricultura;
     #128#25 = 0;
     #128#26 = 0;
     #128#27 = 0;
     |BUCLE rem00029;


     #128#30 = #128#26 + #128#27;
     #128#33 = #128#31 + #128#32;
     #128#34 = #128#30 - #128#58 - #128#33;

     |SI #128#34 [ #401#38;
         #128#39 = 0.9;
     |FINSI;

     nCanti1 = #128#26 - #128#59 - #128#31;
     |SI #128#35 ! 0;  nCanti1 = nCanti1 * #128#35;  |FINSI;
     |SI #128#36 ! 0;  nCanti1 = nCanti1 * #128#36;  |FINSI;
     |SI #128#38 ! 0;  nCanti1 = nCanti1 * #128#38;  |FINSI;
     |SI #128#54 ! 0;  nCanti1 = nCanti1 * #128#54;  |FINSI;
     |SI #128#39 ! 0;  nCanti1 = nCanti1 * #128#39;  |FINSI;
     |SI #128#55 ! 0;  nCanti1 = nCanti1 * #128#55;  |FINSI;

     nCanti2 = #128#27 - #128#60 - #128#32;
     |SI #128#35 ! 0;  nCanti2 = nCanti2 * #128#35;  |FINSI;
     |SI #128#36 ! 0;  nCanti2 = nCanti2 * #128#36;  |FINSI;
     |SI #128#37 ! 0;  nCanti2 = nCanti2 * #128#37;  |FINSI;
     |SI #128#38 ! 0;  nCanti2 = nCanti2 * #128#38;  |FINSI;
     |SI #128#54 ! 0;  nCanti2 = nCanti2 * #128#54;  |FINSI;
     |SI #128#39 ! 0;  nCanti2 = nCanti2 * #128#39;  |FINSI;
     |SI #128#55 ! 0;  nCanti2 = nCanti2 * #128#55;  |FINSI;

     #128#40 = nCanti1 + nCanti2;

     #128#44 = #128#40 - #128#43;
     #128#48 = #128#44 % #128#47;
     #128#49 = #128#44 - #128#48;
     |SI #128#49 < 0;
         |SI #128#35 ! 0;  |O #128#36 ! 0;  |O #128#37 ! 0;  |O #128#38 ! 0;
          |O #128#39 ! 0;  |O #128#54 ! 0;
          |O #128#55 ! 0;
             #128#49 = 0;
         |FINSI;
     |FINSI;

     #128#51 = 0;
     |SI #128#50 = "S";
         #128#51 = #128#49 % 30;
     |FINSI;

     #128#52 = #128#49 - #128#51;
|FPRC;

|PROCESO ModAgraria;
     |ABRE #12;
     #12#0 = #10#0;
     #12#1 = #10#1;
     |LEE 040#12=;
     |SI FSalida ! 0;  |DDEFECTO #12;  |FINSI;
     |CIERRA #12;

     |ABRE #15;
     #15#0 = #8#28;
     |LEE 040#15=;
     |SI FSalida ! 0;  |CIERRA #15;  |ACABA; |FINSI;
     |CIERRA #15;

     |SI #15#5 = 0;  |ACABA;  |FINSI;

     |ABRE #128;
     #128#0 = #10#18;
     #128#1 = nContaAct;
     |LEE 101#128=;
     |SI FSalida ! 0;
         |DDEFECTO #128;
         #128#0 = #10#18;
         #128#1 = nContaAct;

         enActividad = nActividad;
         |HAZ AmortizaAgricola;
         #128#31 = enAmortiza;

         |GRABA 020#128b;
     |FINSI;

     #128#2  = eaPerceptor;
     #128#3  = "X";
     #128#4  = 0;
     |SI nPorce ! 100;
         #128#14 = "S";
         #128#20 = #2#3;
     |FINSI;
     #128#15 = nPorce;
     #128#18 = #10#2;
     #128#19 = #10#3;
     #128#21 = #10#4;
     #128#22 = #12#9;
     #128#23 = #12#10;
     aAlfa   = #12#3 + " " + #12#4;  |QBF aAlfa;
     aAlfa   = aAlfa + " " + #12#5;
     #128#24 = aAlfa;

     nLinea = 1;
     |BUCLE rem00506;

     |ABRE #129;
     |SELECT #2#129;
     #129#0 = #128#0;
     #129#1 = #128#1;
     #129#3 = #15#3;
     #129#4 = nLinea;
     |LEE 040#129=;
     |SI FSalida = 0;
         nRefer = #129#2;
     |SINO;
         nRefer = 1;
         |SELECT #1#129;
         #129#0 = #128#0;
         #129#1 = #128#1;
         #129#2 = 99;
         |LEE 040#129];
         |SI FSalida = 0;
             |LEE 040#129a;
         |SINO;
             |LEE 040#129u;
         |FINSI;
         |SI FSalida = 0;  |Y #129#0 = #128#0; |Y #129#1 = #128#1;
             nRefer = #129#2 + 1;
        |FINSI;
     |FINSI;

     |SELECT #1#129;
     #129#0 = #128#0;
     #129#1 = #128#1;
     #129#2 = nRefer;
     |LEE 101#129=;
     |SI FSalida ! 0;
         |DDEFECTO #129;
         #129#0 = #128#0;
         #129#1 = #128#1;
         #129#2 = nRefer;
         #129#3 = #15#3;
         #129#4 = nLinea;
         #129#5 = #101#3;
         |GRABA 020#129b;
     |FINSI;

     nFactor = 1;
     |SI #7#2 = "I";
         |SI #8#8 = "D"; nFactor = -1; |FINSI;
     |SINO;
         |SI #8#8 = "H"; nFactor = -1; |FINSI;
     |FINSI;

     #129#6 = #129#6 + (((#8#9 / nConversor) * nFactor)) ! 2;
     #129#7 = #129#6 * #129#5;
     #129#8 = #101#4;
     #129#9 = #101#5;

     |GRABA 101#129a;
     |LIBERA #129;
     |CIERRA #129;

     |HAZ TotalAgricultura;

     |GRABA 020#128a;
     |LIBERA #128;
     |CIERRA #128;

     eaPrograma   = "rem00028";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO Arrendamientos;
     nCasilla = 0;
     nImporte = 0;

     |ABRE #16;
     #16#0 = #8#4;
     |LEE 040#16=;
     |SI FSalida = 0;
         |SI #8#0 = 99;
             nImporte = (#8#9 / nConversor) ! 2;
             nCasilla = 5;
         |FINSI;
     |SINO;
         |SI #8#0 = 99;  |ACABA;  |FINSI;

         nCasilla = #7#9;
     |FINSI;
     |CIERRA #16;

     |SI nError = 1;  |Y nImporte = 0;  |ACABA;  |FINSI;

     |ABRE #17;
     #17#0 = #10#0;
     #17#1 = #10#1;
     #17#2 = #8#28;
     |LEE 040#17=;
     |SI FSalida ! 0;  |CIERRA #17;  |ACABA;  |FINSI;
     |CIERRA #17;

     |SI nImporte = 0;
         nFactor = 1;
         |SI #7#2 = "I";
             |SI #8#8 = "D"; nFactor = -1; |FINSI;
         |SINO;
             |SI #8#8 = "H"; nFactor = -1; |FINSI;
         |FINSI;

         nImporte = ((#8#9 / nConversor) * nFactor) ! 2;
     |FINSI;

     |SI nImporte = 0;  |ACABA;  |FINSI;

     |ABRE #121;
     |SELECT #2#121;
     #121#0   = #10#18;
     nNume    = #8#28;
     #121#117 = nNume;
     |LEE 040#121=;
     |SI FSalida = 0;
         nLinea = #121#1;
     |SINO;
         nLinea = 1;
         |SELECT #1#121;
         #121#0 = #10#18;
         #121#1 = 99;
         |LEE 040#121];
         |SI FSalida = 0;
             |LEE 040#121a;
         |SINO;
             |LEE 040#121u;
         |FINSI;
         |SI FSalida = 0;  |Y #121#0 = #10#18;
             nLinea = #121#1 + 1;
             |SI nLinea ] 99;
                 |PARA nLinea = 99; |SI nLinea ] 0; |HACIENDO nLinea = nLinea - 1;
                       #121#0 = #10#18;
                       #121#1 = nLinea;
                       |LEE 040#121=;
                       |SI FSalida ! 0;  |SAL;  |FINSI;
                 |SIGUE;
             |FINSI;
        |FINSI;
     |FINSI;

     |SI nLinea = 0;  |ACABA;  |FINSI;

     |SELECT #1#121;
     #121#0 = #10#18;
     #121#1 = nLinea;
     |LEE 101#121=;
     |SI FSalida ! 0;
         |DDEFECTO #121;
         #121#0 = #10#18;
         #121#1 = nLinea;
         #121#3  = "X";
         |GRABA 020#121b;
     |FINSI;

     |SI #121#3 ! "X";  |ACABA;  |FINSI;

     #121#2   = eaPerceptor;
     #121#3   = "X";
     #121#4   = 0;
     aAlfa    = #17#10 + " " + #17#11;  |QBF aAlfa;
     aAlfa    = aAlfa + " " + #17#12;
     #121#13  = aAlfa;
     #121#14  = #17#3;
     #121#31  = 365;
     #121#105 = #17#6;
     #121#106 = #17#7;

     |SI nCasilla = 1;   #121#38 = #121#38 + nImporte;  |FINSI;
     |SI nCasilla = 2;   #121#40 = #121#40 + nImporte;  |FINSI;
     |SI nCasilla = 3;   #121#42 = #121#42 + nImporte;  |FINSI;
     |SI nCasilla = 4;   #121#44 = #121#44 + nImporte;  |FINSI;
     |SI nCasilla = 5;   #121#47 = #121#47 + nImporte;  |FINSI;
     |SI nCasilla = 6;   #121#22 = #121#22 + nImporte;  |FINSI;
     |SI nCasilla = 7;   #121#21 = #121#21 + nImporte;  |FINSI;
     |SI nCasilla = 8;   #121#51 = #121#51 + nImporte;  |FINSI;
     |SI nCasilla = 9;   #121#53 = #121#53 + nImporte;  |FINSI;
     |SI nCasilla = 10;  #121#57 = #121#57 + nImporte;  |FINSI;
     |SI nCasilla = 11;  #121#60 = #121#60 + nImporte;  |FINSI;
     |SI nCasilla = 12;  #121#55 = #121#55 + nImporte;  |FINSI;

     |SI #121#60 ! 0;  #121#58 = 0;  |FINSI;

     #121#116 = "S";
     nNume    = #8#28;
     #121#117 = nNume;

     |GRABA 020#121a;
     |LIBERA #121;

     nSwInMobi    = 1;
     eaPrograma   = "rem00021";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO MiraCuentas;
     nError = 0;
     aAlfa  = #8#4 % 104;
     #7#10  = 1990;
     #7#0   = aAlfa;
     |LEE 040#7=;
     |SI FSalida ! 0;  nError = 1;  |FINSI;

     |SI #8#28 ! "   ";
         |SI #10#3 = "8612";
             |HAZ Arrendamientos;
         |FINSI;
     |FINSI;

     |SI #8#0 = 99;  |ACABA;  |FINSI;

     nDepar = #8#21;
     |SI nDepar = 0;  nDepar = nActividad;  |FINSI;

     |SI nDepar ! nActividad;  |ACABA;      |FINSI;

     |SI nError = 1;  |ACABA;  |FINSI;

     |SI #10#9 = 3;  |O #10#9 = 8;  |O #10#9 = 13;
          nFactor = 1;
          |SI #7#2 = "I";
              |SI #8#8 = "D"; nFactor = -1; |FINSI;
          |SINO;
              |SI #8#8 = "H"; nFactor = -1; |FINSI;
          |FINSI;

          nImporte =  ((#8#9 / nConversor) * nFactor) ! 2;
          |SI nImporte ! 0;  |HAZ ModNormal;  |FINSI;
     |FINSI;

     |SI #10#9 = 4;  |O #10#9 = 9;  |O #10#9 = 14;
      |O #10#9 = 18; |O #10#9 = 19;
          nFactor = 1;
          |SI #7#2 = "I";
              |SI #8#8 = "D"; nFactor = -1; |FINSI;
          |SINO;
              |SI #8#8 = "H"; nFactor = -1; |FINSI;
          |FINSI;

          nImporte =  ((#8#9 / nConversor) * nFactor) ! 2;
          |SI nImporte ! 0;  |HAZ ModSimpli;  |FINSI;
     |FINSI;

     |SI #10#9 = 7;  |O #10#9 = 12;  |O #10#9 = 17;
      |O #10#9 = 6;  |O #10#9 = 11;  |O #10#9 = 16;
         |SI #8#28 ! "   ";
             |HAZ ModAgraria;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE camaasil;
     #8#3;
     0;
     "            ", "01.01.2001", 000001, 0001, 00;
     "zzzzzzzzzzzz", "31.12.2001", 999999, 9999, 99;
     ;
     NULL, MiraCuentas;
|FIN;

|PROCESO LeeRetencion;
     #27#0 = #26#0;
     #27#1 = #26#1;
     |LEE 040#27=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nDepar = #27#10;
     |SI nDepar = 0;  nDepar = nActividad;  |FINSI;
     |SI nDepar ! nActividad;  |ACABA;      |FINSI;

     nRetencion = nRetencion + ((#26#22 / nConversor) ! 2);
|FPRC;

|DEFBUCLE caivalin;
     #26#1;
     ;
     01, 0000000001, 01;
     01, 9999999999, 99;
     ;
     NULL, LeeRetencion;
|FIN;

|PROCESO Contabilidad;
     |PINPA #0#0;
     |ATRI S;   |PINTA 1157, "*";  |ATRI s;

     |ABRE #9;
     |SELECT #4#9;
     #9#2  = nEmpresa;
     #9#26 = 1;
     |LEE 040#9=;
     |SI FSalida ! 0;
         |CIERRA #9;
         |ACABA;
     |FINSI;

     |ABRE #31;
     #31#0 = #9#2;
     #31#1 = #9#3;
     |LEE 040#31=;
     |SI FSalida ! 0;  |DDEFECTO #31;  |FINSI;
     |CIERRA #31;

     nConversor = 1;
     |SI #31#2 ! "E";  nConversor = 166.386;  |FINSI;

     |DBASS aBase;  |QBF aBase;
     aPathFich = aBase + "contagen/fich/" + (("00000" + #9#2) % -105) + #9#3 + "/";

     |PATH_DAT #8 aPathFich;

     |ABRE #7;
     |BUCLE camaasil;
     |CIERRA #7;

     |SI #10#9 = 7;  |O #10#9 = 12;  |O #10#9 = 17;
      |O #10#9 = 6;  |O #10#9 = 11;  |O #10#9 = 16;
         |PATH_DAT #26 aPathFich;
         |PATH_DAT #27 aPathFich;
         nRetencion = 0;
         |ABRE #27;
         |BUCLE caivalin;
         |CIERRA #27;
         |SI nRetencion ! 0;
             nRetencion = nRetencion % nPorce;
             |ABRE #131;
             |HAZ GrabaPagos;
             |CIERRA #131;
         |FINSI;
         nRetencion = 0;
     |FINSI;
|FPRC;

|| \_________________________________ Recogida desde Planillas

|PROCESO Ingresos;
     nPlanilla = 1;

     #7#10  = 1990;
     #7#0   = #22#5;
     |LEE 040#7=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nDepar = #22#4;

     nFactor = 1;
     |SI #22#7 = "-";  nFactor = -1;  |FINSI;

     nImporte =  #22#8 * nFactor;
     |SI nImporte = 0;  |ACABA;  |FINSI;


     |SI #10#9 = 3;  |O #10#9 = 8;  |O #10#9 = 13;
         |HAZ ModNormal;
     |FINSI;

     |SI #10#9 = 4;  |O #10#9 = 9;  |O #10#9 = 14;
      |O #10#9 = 18; |O #10#9 = 19;
         |HAZ ModSimpli;
     |FINSI;
|FPRC;

|DEFBUCLE dsmom010;
     #22#1;
     ;
     nEmpresa, 2001, 00, 00, nActividad, "    ";
     nEmpresa, 2001, 99, 99, nActividad, "zzzz";
     ;
     NULL, Ingresos;
|FIN;

|PROCESO PonExistencias;
     nImporte = nImporte + (#32#8 - #32#9);
     nEnExi = 1;
|FPRC;

|DEFBUCLE dsmom011;
     #32#2;
     ;
     #23#0, #23#1, #23#2, #23#3, #23#4, #23#5, "    ";
     #23#0, #23#1, #23#2, #23#3, #23#4, #23#5, "zzzz";
     ;
     NULL, PonExistencias;
|FIN;

|PROCESO Consumo;
     nPlanilla = 1;

     #7#10  = 1990;
     #7#0   = #23#5;
     |LEE 040#7=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nDepar = #23#4;

     nFactor = 1;
     |SI #23#7 = "-";  nFactor = -1;  |FINSI;

     nEnExi   = 0;
     nImporte = 0;
     |BUCLE dsmom011;
     |SI nEnExi = 0;
          nImporte = #23#8 * nFactor;
     |SINO;
          |SI #23#2 ] 10;  |Y  nEnExi = 1;
              nImporte = nImporte * nFactor;
          |SINO;
              nImporte = 0;
          |FINSI;
     |FINSI;

     |SI nImporte = 0;  |ACABA;  |FINSI;

/*
     nImporte =  #23#8 * nFactor;
     |SI nImporte = 0;  |ACABA;  |FINSI;
*/

     |SI #10#9 = 3;  |O #10#9 = 8;  |O #10#9 = 13;
         |HAZ ModNormal;
     |FINSI;

     |SI #10#9 = 4;  |O #10#9 = 9;  |O #10#9 = 14;
      |O #10#9 = 18; |O #10#9 = 19;
         |HAZ ModSimpli;
     |FINSI;
|FPRC;

|DEFBUCLE dsmom012;
     #23#1;
     ;
     nEmpresa, 2001, 00, 00, nActividad, "    ";
     nEmpresa, 2001, 99, 99, nActividad, "zzzz";
     ;
     NULL, Consumo;
|FIN;

|PROCESO Gastos;
     nPlanilla = 1;

     #7#10  = 1990;
     #7#0   = #24#5;
     |LEE 040#7=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nDepar = #24#4;

     nFactor = 1;
     |SI #24#7 = "-";  nFactor = -1;  |FINSI;

     nImporte =  #24#8 * nFactor;
     |SI nImporte = 0;  |ACABA;  |FINSI;

     |SI #10#9 = 3;  |O #10#9 = 8;  |O #10#9 = 13;
         |HAZ ModNormal;
     |FINSI;

     |SI #10#9 = 4;  |O #10#9 = 9;  |O #10#9 = 14;
      |O #10#9 = 18; |O #10#9 = 19;
         |HAZ ModSimpli;
     |FINSI;
|FPRC;

|DEFBUCLE dsmom013;
     #24#1;
     ;
     nEmpresa, 2001, 00, 00, nActividad, "    ";
     nEmpresa, 2001, 99, 99, nActividad, "zzzz";
     ;
     NULL, Gastos;
|FIN;

|PROCESO Planilla;
     |ABRE #7;
     |BUCLE dsmom010;
     |BUCLE dsmom012;
     |BUCLE dsmom013;
     |CIERRA #7;
|FPRC;

|| \_________________________________ Recogida de Pagos Fraccionados

|PROCESO GrabaPagos;
     |SI nRetencion ! 0;
         #3#4      = 0;             || Biene de los pagos de agricultura
         #3#5      = nRetencion;    || las cargo para aprovechar la rutina
         nContaAct = nActividad;
     |FINSI;

     #131#0 = #10#18;
     #131#1 = nContaAct;
     |LEE 101#131=;
     |SI FSalida ! 0;
         |DDEFECTO #131;
         #131#0 = #10#18;
         #131#1 = nContaAct;
         |GRABA 020#131b;
     |FINSI;

     #131#2 = eaPerceptor;
     #131#3 = "A";
     #131#4 = 0;

     |SI #3#3 = 3;   #131#11 = #131#11 + #3#4;  |FINSI;
     |SI #3#3 = 6;   #131#12 = #131#12 + #3#4;  |FINSI;
     |SI #3#3 = 9;   #131#13 = #131#13 + #3#4;  |FINSI;
     |SI #3#3 = 12;  #131#14 = #131#14 + #3#4;  |FINSI;

     #131#15 = #131#15 + #3#5;

     |GRABA 020#131a;
     |LIBERA #131;

     eaPrograma   = "rem00031";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE dsmom104;
     #3#1;
     ;
     130, #10#0, 2001, 01;
     131, #10#0, 2001, 99;
     ;
     NULL, GrabaPagos;
|FIN;

|PROCESO GrabaPagos130;
     |SI #5#17 [ 0;  |Y #5#11 = 0;  |Y #5#15 = 0;
         |ACABA;
     |FINSI;

     #131#0 = #10#18;
     #131#1 = nContaAct;
     |LEE 101#131=;
     |SI FSalida ! 0;
         |DDEFECTO #131;
         #131#0 = #10#18;
         #131#1 = nContaAct;
         |GRABA 020#131b;
     |FINSI;

     #131#2 = eaPerceptor;
     #131#3 = "A";
     #131#4 = 0;

     |SI #5#17 > 0;
         |SI #5#2 = 3;   #131#11 = #131#11 + #5#17;   |FINSI;
         |SI #5#2 = 6;   #131#12 = #131#12 + #5#17;   |FINSI;
         |SI #5#2 = 9;   #131#13 = #131#13 + #5#17;   |FINSI;
         |SI #5#2 = 12;  #131#14 = #131#14 + #5#17;   |FINSI;
     |FINSI;

     nRetencion1 = #5#11;
     nRetencion2 = nRetencion2 + #5#15;

     #131#15     = nRetencion1 + nRetencion2;

     |GRABA 020#131a;
     |LIBERA #131;

     eaPrograma   = "rem00031";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE dsmod130;
     #5#1;
     ;
     #10#0, 2001, 00, 130, 00, 00;
     #10#0, 2001, 99, 130, 00, 00;
     ;
     NULL, GrabaPagos130;
|FIN;

|PROCESO GrabaPagos131;
     |SI #6#33 [ 0;  |Y #6#27 = 0;  |Y #6#31 = 0;
         |ACABA;
     |FINSI;

     #131#0 = #10#18;
     #131#1 = nContaAct;
     |LEE 101#131=;
     |SI FSalida ! 0;
         |DDEFECTO #131;
         #131#0 = #10#18;
         #131#1 = nContaAct;
         |GRABA 020#131b;
     |FINSI;

     #131#2 = eaPerceptor;
     #131#3 = "A";
     #131#4 = 0;

     |SI #6#33 > 0;
         |SI #6#2 = 3;   #131#11 = #131#11 + #6#33;   |FINSI;
         |SI #6#2 = 6;   #131#12 = #131#12 + #6#33;   |FINSI;
         |SI #6#2 = 9;   #131#13 = #131#13 + #6#33;   |FINSI;
         |SI #6#2 = 12;  #131#14 = #131#14 + #6#33;   |FINSI;
     |FINSI;

     #131#15 = #131#15 + #6#27 + #6#31;

     |GRABA 020#131a;
     |LIBERA #131;

     eaPrograma   = "rem00031";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE dsmod131;
     #6#1;
     ;
     #10#0, 2001, 00, 131, 00, 00;
     #10#0, 2001, 99, 131, 00, 00;
     ;
     NULL, GrabaPagos131;
|FIN;

|PROCESO PagosFraccionados;
     |PINPA #0#0;
     |ATRI S;   |PINTA 1357, "*";  |ATRI s;

     |ABRE #131;
     |BUCLE dsmom104;

     nRetencion1 = 0;
     nRetencion2 = 0;
     |BUCLE dsmod130;

     nRetencion1 = 0;
     nRetencion2 = 0;
     |BUCLE dsmod131;
     |CIERRA #131;
|FPRC;

|PROCESO MiraComunero;
     |SI #11#8 ! "01.01.0000";
         |SI #11#8 > "31.12.2001";  |ACABA;  |FINSI;
     |FINSI;

     |SI #11#9 ! "01.01.0000";
         |SI #11#9 < "01.01.2001";  |ACABA;  |FINSI;
     |FINSI;

     |ABRE #2;
     #2#0 = #11#0;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     |SI #10#9  = 13;  |O #10#9 = 14;  |O #10#9 = 16;  |O #10#9 = 17;
      |O #10#9  = 19;  |O #10#3 = "8612";
         nPorce        = #11#7;
         nEmpresa      = #11#0;
         nActividad    = #11#1;
         nPlanilla     = 0;
         |HAZ Planilla;
         |SI nPlanilla = 0;
             |HAZ Contabilidad;
         |FINSI;
     |FINSI;

     |SI #10#9  = 15;
         nPorce        = #11#7;
         nEmpresa      = #11#0;
         nActividad    = #11#1;
         |HAZ Modulos;
     |FINSI;
|FPRC;

|DEFBUCLE dsmom001;
     #11#2;
     ;
     #10#0, #10#1;
     #10#0, #10#1;
     ;
     NULL, MiraComunero;
|FIN;

|PROCESO Renta;
     nContaAct = nContaAct + 1;

     nEmpresa   = #10#0;
     nActividad = #10#1;

     |SI #10#9  = 3;  |O #10#9 = 4;  |O #10#9 = 6;  |O #10#9 = 7;
      |O #10#3 = "8612";
         nPorce        = 100;
         nPlanilla     = 0;
         |HAZ Planilla;
         |SI nPlanilla = 0;
             |HAZ Contabilidad;
         |FINSI;
     |FINSI;

     |SI #10#9  = 5;
         nPorce  = 100;
         |HAZ Modulos;
     |FINSI;

     |SI #10#9  = 13;  |O #10#9 = 14;  |O #10#9 = 15;
      |O #10#9  = 16;  |O #10#9 = 17;  |O #10#9 = 19;
         |BUCLE dsmom001;
     |FINSI;

     |SI nEmpresaAnt ! #10#0;
         |HAZ PagosFraccionados;
         nEmpresaAnt = #10#0;
     |FINSI;
|FPRC;

|PROCESO Patrimonio;
     |SI nEmpresa ! #10#0;
         nEmpresa = #10#0;
     |SINO;
         |ACABA;
     |FINSI;

     |PINPA #0#0;
     |ATRI S;   |PINTA 1757, "*";  |ATRI s;

     |ABRE #12;
     #12#0 = #10#0;
     #12#1 = #10#1;
     |LEE 040#12=;
     |SI FSalida ! 0;  |DDEFECTO #12;  |FINSI;
     |CIERRA #12;

     |ABRE #19;
     #19#0 = #10#0;
     #19#1 = 2001;
     |LEE 040#19=;
     |SI FSalida = 0;
         |SI #19#6 = 3;  |O #19#6 = 4;  |O #19#6 = 5;
          |O #19#6 = 6;  |O #19#6 = 7;
             |SI #19#33 = 1;
                 |SI #19#30 > 0;
                     |HAZ LimpiaPatrim;
                     eaLetra      = "C1";
                     eaDeclarante = eaPerceptor;
                     eaDeDonde    = "PA";
                     eaLinDonde   = "";
                     eaPatr15     = #10#4;
                     eaPatr18     = #10#3;
                     eaPatr19     = "";
                     eaPatr06     = #12#3    + " " + #12#4;  |QBF eaPatr06;
                     eaPatr06     = eaPatr06 + " " + #12#5;
                     eaPatr08     = #12#9;
                     eaPatr09     = #12#10;
                     eaPatr10     = #19#30;
                     |HAZ GrabaPatrimonio;
                 |FINSI;

                 |SI #19#31 > 0;
                     |HAZ LimpiaPatrim;
                     eaLetra      = "C2";
                     eaDeclarante = eaPerceptor;
                     eaDeDonde    = "PA";
                     eaLinDonde   = "";
                     eaPatr15     = #10#4;
                     eaPatr18     = #10#3;
                     eaPatr19     = "";
                     eaPatr06     = #12#3    + " " + #12#4;  |QBF eaPatr06;
                     eaPatr06     = eaPatr06 + " " + #12#5;
                     eaPatr08     = #12#9;
                     eaPatr09     = #12#10;
                     eaPatr10     = #19#31;
                     |HAZ GrabaPatrimonio;
                 |FINSI;
             |SINO;
                 |SI #19#32 > 0;
                     |HAZ LimpiaPatrim;
                     eaLetra      = "D1";
                     eaDeclarante = eaPerceptor;
                     eaDeDonde    = "PA";
                     eaLinDonde   = "";
                     eaPatr15     = #10#4;
                     eaPatr18     = #10#3;
                     eaPatr19     = "";
                     eaPatr06     = #10#4;
                     eaPatr08     = #12#9;
                     eaPatr09     = #12#10;
                     eaPatr10     = #19#32;
                     |HAZ GrabaPatrimonio;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;
     |CIERRA #19;
|FPRC;

|PROCESO MiraActividad;
     |SI #10#19 = "T";  eaPerceptor = "TITULAR   ";  |FINSI;
     |SI #10#19 = "C";  eaPerceptor = "CONYUGE   ";  |FINSI;
     |SI #10#19 = "1";  eaPerceptor = "1 FAMILIAR";  |FINSI;
     |SI #10#19 = "2";  eaPerceptor = "2 FAMILIAR";  |FINSI;
     |SI #10#19 = "3";  eaPerceptor = "3 FAMILIAR";  |FINSI;
     |SI #10#19 = "4";  eaPerceptor = "4 FAMILIAR";  |FINSI;

     |SI nGananPerd = 1;
         |HAZ GananciasYPerdidas;
         |ACABA;
     |FINSI;

     |SI nSwPatrimonio = 0;
         |HAZ Renta;
     |SINO;
         |HAZ Patrimonio;
     |FINSI;
|FPRC;

|DEFBUCLE agicen14;
     #10#3;
     ;
     enEmpresa, 00001;
     enEmpresa, 99999;
     ;
     NULL, MiraActividad;
|FIN;

|PROCESO Borra121;
     |SI #121#116 = "S";  |Y #121#3 = "X";  |Y nSwInMobi = 0;
         |BORRA 020#121a;
         eaPrograma   = "rem00021";
         eaPunto      = "  ";
         |HAZ ProgramaActivo;
     |FINSI;

     |SI #121#116 = "N";  |Y nSwInMobi = 1;
         |SI #121#31 ! 0;  |Y #121#3 = "X";
             |BORRA 020#121a;
             eaPrograma   = "rem00021";
             eaPunto      = "  ";
             |HAZ ProgramaActivo;
         |FINSI;
     |FINSI;

     |LIBERA #121;
|FPRC;

|DEFBUCLE rem00021;
     #121#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     be;
     NULL, Borra121;
|FIN;

|PROCESO Borra120;
     |SI #120#31 = "S";  |Y #120#3 = "X";
         |BORRA 020#120a;
         eaPrograma   = "rem00020";
         eaPunto      = "  ";
         |HAZ ProgramaActivo;
     |FINSI;
     |LIBERA #120;
|FPRC;

|DEFBUCLE rem00020;
     #120#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     be;
     NULL, Borra120;
|FIN;

|PROCESO PasaTrabaBueno;
     |SI nComprueba = 0;
         |SI #30#4 ! 0;
             |ABRE #29;
             #29#0 = #30#0;
             #29#1 = #30#1;
             #29#2 = #30#2;
             #29#3 = #30#3;
             #29#4 = #30#4;
             #29#5 = #30#5;
             |LEE 040#29=;
             |SI FSalida ! 0;  |DDEFECTO #29;  |FINSI;
             |CIERRA #29;

             |SI #29#10 = "S";
                 nDComple = #30#4;
                 nHComple = #30#4;
             |SINO;
                 nHComple = #30#4;
             |FINSI;
         |SINO;
             nDComple = #30#4;
             nHComple = #30#4;
         |FINSI;
         nHayTrabaj = 1;
         |ACABA;
     |FINSI;

     |ABRE #120;
     |SELECT #2#120;
     #120#0   = enEmpresa;
     #120#32  = #30#0;
     aAlfa    = #30#6 % 108;
     nNume    = aAlfa;
     nNume    = nNume + #30#7;
     #120#33  = nNume;
     |LEE 040#120=;
     |SI FSalida = 0;
         nLinea = #120#1;
     |SINO;
         nLinea = 1;
         |SELECT #1#120;
         #120#0 = enEmpresa;
         #120#1 = 99;
         |LEE 040#120];
         |SI FSalida = 0;
             |LEE 040#120a;
         |SINO;
             |LEE 040#120u;
         |FINSI;
         |SI FSalida = 0;  |Y #120#0 = enEmpresa;
             nLinea = #120#1 + 1;
             |SI nLinea ] 99;
                 |PARA nLinea = 99; |SI nLinea ] 0; |HACIENDO nLinea = nLinea - 1;
                       #120#0 = enEmpresa;
                       #120#1 = nLinea;
                       |LEE 040#120=;
                       |SI FSalida ! 0;  |SAL;  |FINSI;
                 |SIGUE;
             |FINSI;
        |FINSI;
     |FINSI;

     |SI nLinea = 0;  |ACABA;  |FINSI;

     |SELECT #1#120;
     #120#0 = enEmpresa;
     #120#1 = nLinea;
     |LEE 101#120=;
     |SI FSalida ! 0;
         |DDEFECTO #120;
         #120#0 = enEmpresa;
         #120#1 = nLinea;
         #120#3  = "X";
         |GRABA 020#120b;
     |FINSI;

     |SI #120#3 ! "X";  |ACABA;  |FINSI;

     |PINPA #0#0;
     |ATRI S;   |PINTA 1557, "*";  |ATRI s;

     |ABRE #2;
     #2#0 = #30#0;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     #120#2  = eaPerceptor;
     #120#5  = #2#1;
     #120#6  = #120#6  + #30#17;
     #120#7  = #120#7  + #30#16;
     #120#9  = #120#9  + #30#18;
     #120#10 = #120#10 + #30#19;
     #120#11 = #120#11 + #30#20;
     #120#19 = #120#19 + #30#22;

     #120#12 = #120#9  + #120#10 - #120#11;
     #120#18 = #120#28 % #120#17;
     |SI #120#27 ! -1;
         nLimite  = (#401#1 * #120#27) % 30;
         |SI #120#18 > nLimite;  #120#18 = nLimite;  |FINSI;
     |FINSI;

     |SI #120#21 > #401#2;  #120#21 = #401#2;  |FINSI;
     |SI #120#22 > #401#3;  #120#22 = #401#3;  |FINSI;

     #120#23 = #120#19 + #120#20 + #120#21 + #120#22;
     #120#24 = #120#7  + #120#12 + #120#16 - #120#18 - #120#23;

     #120#31 = "S";
     #120#32 = #30#0;

     aAlfa    = #30#6 % 108;
     nNume    = aAlfa;
     nNume    = nNume + #30#7;
     #120#33  = nNume;

     |GRABA 020#120a;
     |LIBERA #120;

     eaPrograma   = "rem00020";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;

     |REPON_DATOS #2;
|FPRC;

|DEFBUCLE dsm190li;
     #30#2;
     ;
     aNif, 2001, nDComple, "A", "  ";
     aNif, 2001, nHComple, "A", "  ";
     ;
     NULL, PasaTrabaBueno;
|FIN;

|PROCESO PasaTrabajador;
     |ABRE #120;
     |SELECT #2#120;
     #120#0   = #18#9;
     #120#32  = #18#1;
     #120#33  = #18#2;
     |LEE 040#120=;
     |SI FSalida = 0;
         nLinea = #120#1;
     |SINO;
         nLinea = 1;
         |SELECT #1#120;
         #120#0 = #18#9;
         #120#1 = 99;
         |LEE 040#120];
         |SI FSalida = 0;
             |LEE 040#120a;
         |SINO;
             |LEE 040#120u;
         |FINSI;
         |SI FSalida = 0;  |Y #120#0 = #18#9;
             nLinea = #120#1 + 1;
             |SI nLinea ] 99;
                 |PARA nLinea = 99; |SI nLinea ] 0; |HACIENDO nLinea = nLinea - 1;
                       #120#0 = #18#9;
                       #120#1 = nLinea;
                       |LEE 040#120=;
                       |SI FSalida ! 0;  |SAL;  |FINSI;
                 |SIGUE;
             |FINSI;
        |FINSI;
     |FINSI;

     |SI nLinea = 0;  |ACABA;  |FINSI;

     |SELECT #1#120;
     #120#0 = #18#9;
     #120#1 = nLinea;
     |LEE 101#120=;
     |SI FSalida ! 0;
         |DDEFECTO #120;
         #120#0 = #18#9;
         #120#1 = nLinea;
         #120#3  = "X";
         |GRABA 020#120b;
     |FINSI;

     |SI #120#3 ! "X";  |ACABA;  |FINSI;

     |PINPA #0#0;
     |ATRI S;   |PINTA 1557, "*";  |ATRI s;

     |SI #18#10 = "T";    #120#2 = "TITULAR";       |FINSI;
     |SI #18#10 = "C";    #120#2 = "CONYUGE";       |FINSI;
     |SI #18#10 = "1";    #120#2 = "1 FAMILIAR";    |FINSI;
     |SI #18#10 = "2";    #120#2 = "2 FAMILIAR";    |FINSI;
     |SI #18#10 = "3";    #120#2 = "3 FAMILIAR";    |FINSI;
     |SI #18#10 = "4";    #120#2 = "4 FAMILIAR";    |FINSI;

     #120#5  = #18#13;
     #120#6  = #18#4;
     #120#7  = #18#3;
     #120#9  = #18#6;
     #120#10 = #18#7;
     #120#11 = #18#11;
     #120#19 = #18#5;

     #120#12 = #120#9  + #120#10 - #120#11;
     #120#18 = #120#28 % #120#17;
     |SI #120#27 ! -1;
         nLimite  = (#401#1 * #120#27) % 30;
         |SI #120#18 > nLimite;  #120#18 = nLimite;  |FINSI;
     |FINSI;

     |SI #120#21 > #401#2;  #120#21 = #401#2;  |FINSI;
     |SI #120#22 > #401#3;  #120#22 = #401#3;  |FINSI;

     #120#23 = #120#19 + #120#20 + #120#21 + #120#22;
     #120#24 = #120#7  + #120#12 + #120#16 - #120#18 - #120#23;

     #120#31 = "S";
     #120#32 = #18#1;
     #120#33 = #18#2;

     |GRABA 020#120a;
     |LIBERA #120;

     eaPrograma   = "rem00020";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE dsmom105;
     #18#2;
     14;
     enEmpresa, "            ", 2001;
     enEmpresa, "zzzzzzzzzzzz", 2001;
     ;
     NULL, PasaTrabajador;
|FIN;

|PROCESO Borra132;
     |SI #132#3 = "X";
         |BORRA 020#132a;
         eaPrograma   = "rem00032";
         eaPunto      = "  ";
         |HAZ ProgramaActivo;
     |SINO;
         nSwPasa = 0;
     |FINSI;
     |LIBERA #132;
|FPRC;

|DEFBUCLE rem00032;
     #132#1;
     26;
     enEmpresa, 01, "S";
     enEmpresa, 99, "S";
     be;
     NULL, Borra132;
|FIN;

|PROCESO Transparencia;
     |PINPA #0#0;
     |ATRI S;   |PINTA 1657, "*";  |ATRI s;

     nLinea = 1;
     |ABRE #132;
     #132#0 = enEmpresa;
     #132#1 = 99;
     |LEE 040#132];
     |SI FSalida = 0;
         |LEE 040#132a;
     |SINO;
         |LEE 040#132u;
     |FINSI;
     |SI FSalida = 0;  |Y #132#0 = enEmpresa;
         nLinea = #132#1 + 1;
         |SI nLinea ] 99;
             |PARA nLinea = 99; |SI nLinea ] 0; |HACIENDO nLinea = nLinea - 1;
                   #132#0 = enEmpresa;
                   #132#1 = nLinea;
                   |LEE 040#132=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;

     |ABRE #2;
     #2#0 = #25#0;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     #132#0 = enEmpresa;
     #132#1 = nLinea;
     |LEE 101#132=;
     |SI FSalida ! 0;
         |DDEFECTO #132;
         #132#0  = enEmpresa;
         #132#1  = nLinea;
         #132#3  = "X";
         |GRABA 020#132b;
     |FINSI;

     #132#2  = eaPerceptor;
     #132#11 = #2#3;
     #132#12 = 2;
     #132#13 = "C";
     #132#23 = "S";

     #132#14 = #25#7;
     #132#15 = #25#8;
     #132#16 = #25#9;
     #132#17 = #25#10;
     #132#18 = #25#11;
     #132#19 = #25#12;
     #132#20 = #25#13 + #25#14 + #25#15 + #25#16;
     #132#21 = #25#17;
     #132#22 = #132#20 + #132#21;
     #132#24 = #25#13 + #25#14 + #25#15 + #25#16 + #25#17;
     #132#26 = "S";

     |GRABA 020#132a;
     |LIBERA #132;

     eaPrograma   = "rem00032";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE dsmom055;
     #25#3;
     ;
     aNif, 00001, 2001;
     aNif, 99999, 2001;
     ;
     NULL, Transparencia;
|FIN;

|PROCESO Borra199;
     |BORRA 020#199a;
     |LIBERA #199;

     eaPrograma   = "rem00099";
     eaPunto      = #199#1;
     eaLetra      = #199#1;
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00099;
     #199#1;
     4;
     enEmpresa, "  ", 001, "PA";
     enEmpresa, "zz", 999, "PA";
     be;
     NULL, Borra199;
|FIN;

|PROCESO Socios;
     |ABRE #19;
     #19#0 = #20#0;
     #19#1 = #20#1;
     |LEE 040#19=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #19;

     |SI #20#9 [ 0;  |ACABA;  |FINSI;

     |PINPA #0#0;
     |ATRI S;   |PINTA 1757, "*";  |ATRI s;

     |SI #20#11 = 1;
         |HAZ LimpiaPatrim;
         eaLetra      = "G4";
         eaDeclarante = eaPerceptor;
         eaDeDonde    = "PA";
         eaLinDonde   = "";
         eaPatr06     = #19#3;
         eaPatr10     = #20#9;
         |HAZ GrabaPatrimonio;
     |FINSI;

     |SI #20#11 = 2;
         |HAZ LimpiaPatrim;
         eaLetra      = "H1";
         eaDeclarante = eaPerceptor;
         eaDeDonde    = "PA";
         eaLinDonde   = "";
         eaPatr06     = #19#3;
         eaPatr10     = #20#9;
         |HAZ GrabaPatrimonio;
     |FINSI;

     |SI #20#11 = 3;
         |HAZ LimpiaPatrim;
         eaLetra      = "H2";
         eaDeclarante = eaPerceptor;
         eaDeDonde    = "PA";
         eaLinDonde   = "";
         eaPatr06     = #19#3;
         eaPatr10     = #20#9;
         |HAZ GrabaPatrimonio;
     |FINSI;
|FPRC;

|DEFBUCLE dsmom052;
     #20#3;
     ;
     aNif, 00001, 2001;
     aNif, 99999, 2001;
     ;
     NULL, Socios;
|FIN;

|PROCESO Comuneros;
     |ABRE #19;
     #19#0 = #21#0;
     #19#1 = #21#1;
     |LEE 040#19=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #19;

     |PINPA #0#0;
     |ATRI S;   |PINTA 1757, "*";  |ATRI s;

     |ABRE #12;
     #12#0 = #19#0;
     #12#1 = 1;
     |LEE 040#12];
     |SI FSalida ! 0;    |DDEFECTO #12;  |FINSI;
     |SI #12#0 ! #19#0;  |DDEFECTO #12;  |FINSI;
     |CIERRA #12;

     |ABRE #10;
     #10#0 = #19#0;
     #10#1 = 1;
     |LEE 040#10];
     |SI FSalida ! 0;    |DDEFECTO #10;  |FINSI;
     |SI #10#0 ! #19#0;  |DDEFECTO #10;  |FINSI;
     |CIERRA #10;

     |SI #19#33 = 1;
         |SI #21#7 > 0;
             |HAZ LimpiaPatrim;
             eaLetra      = "C1";
             eaDeclarante = eaPerceptor;
             eaDeDonde    = "PA";
             eaLinDonde   = "";
             eaPatr15     = #10#4;
             eaPatr18     = #10#3;
             eaPatr19     = "";
             eaPatr06     = #12#3    + " " + #12#4;  |QBF eaPatr06;
             eaPatr06     = eaPatr06 + " " + #12#5;
             eaPatr08     = #12#9;
             eaPatr09     = #12#10;
             eaPatr10     = #21#7;
             |HAZ GrabaPatrimonio;
         |FINSI;

         |SI #21#8 > 0;
             |HAZ LimpiaPatrim;
             eaLetra      = "C2";
             eaDeclarante = eaPerceptor;
             eaDeDonde    = "PA";
             eaLinDonde   = "";
             eaPatr15     = #10#4;
             eaPatr18     = #10#3;
             eaPatr19     = "";
             eaPatr06     = #12#3    + " " + #12#4;  |QBF eaPatr06;
             eaPatr06     = eaPatr06 + " " + #12#5;
             eaPatr08     = #12#9;
             eaPatr09     = #12#10;
             eaPatr10     = #21#8;
             |HAZ GrabaPatrimonio;
         |FINSI;
     |SINO;
         |SI #21#7 > 0;
             |HAZ LimpiaPatrim;
             eaLetra      = "D1";
             eaDeclarante = eaPerceptor;
             eaDeDonde    = "PA";
             eaLinDonde   = "";
             eaPatr15     = #10#4;
             eaPatr18     = #10#3;
             eaPatr19     = "";
             eaPatr06     = #10#4;
             eaPatr06     = eaPatr06 + " " + #12#5;
             eaPatr08     = #12#9;
             eaPatr09     = #12#10;
             eaPatr10     = #21#7;
             |HAZ GrabaPatrimonio;
        |FINSI;
    |FINSI;
|FPRC;

|DEFBUCLE dsmom053;
     #21#3;
     ;
     aNif, 00001, 2001;
     aNif, 99999, 2001;
     ;
     NULL, Comuneros;
|FIN;

|PROGRAMA;
     |ABRE #401;
     |LEE 040#401p;
     |SI FSalida ! 0;  |DDEFECTO #401;  |FINSI;
     |CIERRA #401;

     |ABRE #28;
     |LEE 040#28p;
     |SI FSalida ! 0;  |DDEFECTO #28;  |FINSI;
     |CIERRA #28;

     |SI #28#1 = "P";
         |MENAV "     Moneda incorrecta en la Aplicacion Integra";
         |ACABA;
     |FINSI;

     |SI #28#3 = "P";
         |MENAV "     Moneda incorrecta en la Aplicacion Modulo Integrador";
         |ACABA;
     |FINSI;

     |SI #28#9 = "P";
         |MENAV "     Moneda incorrecta en la Aplicacion Modelos";
         |ACABA;
     |FINSI;

     |SI #28#5 = "P";
         |MENAV "     Moneda incorrecta en la Aplicacion Laboral";
         |ACABA;
     |FINSI;

     |ABRE #2;
     #2#0 = enEmpresa;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     |ABRE #1;
     #1#0 = enEmpresa;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |ABRE #4;
     #4#0 = enEmpresa;
     |LEE 040#4=;
     |SI FSalida ! 0;  |DDEFECTO #4;  |FINSI;
     |CIERRA #4;

     nGananPerd = 0;

     |SI #1#7 = " ";
         nSwInMobi   = 0;
         |BUCLE rem00021;

         nEmpresaAnt   = 0;
         nContaAct     = 0;
         nSwPatrimonio = 0;
         |BUCLE agicen14;

         |SI nSwInMobi = 1;
             |BUCLE rem00021;
         |FINSI;
     |FINSI;

     |BUCLE rem00020;        || Pasando Trabajo

     nHayTrabaj = 0;

     aNif       = #4#1;   |QBT aNif;
     eaPerceptor = "TITULAR";
     nDComple   = 0;
     nHComple   = 99;
     nComprueba = 0;  |BUCLE dsm190li;
     nComprueba = 1;  |BUCLE dsm190li;

     aNif       = #4#35;   |QBT aNif;
     eaPerceptor = "CONYUGE";
     nDComple   = 0;
     nHComple   = 99;
     nComprueba = 0;  |BUCLE dsm190li;
     nComprueba = 1;  |BUCLE dsm190li;

     |SI nHayTrabaj = 0;  |BUCLE dsmom105;  |FINSI;

     |ABRE #2;
     #2#0 = enEmpresa;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     nSwPasa = 1;
     |BUCLE rem00032;        || Pasando Transparencia Fiscal
     |SI nSwPasa = 1;
         eaPerceptor = "TITULAR";
         aNif       = #4#1;   |QBT aNif;
         |SI aNif ! "";
             aNif = #4#1;
             |BUCLE dsmom055;
         |FINSI;

         eaPerceptor = "CONYUGE";
         aNif       = #4#35;  |QBT aNif;
         |SI aNif ! "";
             aNif = #4#35;
             |BUCLE dsmom055;
         |FINSI;
     |FINSI;

     nGananPerd = 1;
     enSwPasa   = 1;
     |HAZ Borra38;
     |SI enSwPasa = 1;
         enTipoGanan = 1;
         |BUCLE agicen14;
     |FINSI;

     nGananPerd = 1;
     enSwPasa   = 1;
     |HAZ Borra41;
     |SI enSwPasa = 1;
         enTipoGanan = 2;
         |BUCLE agicen14;
     |FINSI;

     nGananPerd = 0;
     |BUCLE rem00099;        || Pasando Patrimonio

     nSwPatrimonio = 1;
     nEmpresa      = 0;
     |BUCLE agicen14;

     eaPerceptor = "TITULAR";
     aNif       = #4#1;   |QBT aNif;
     |SI aNif ! "";
         aNif = #4#1;
         |BUCLE dsmom052;
     |FINSI;

     eaPerceptor = "CONYUGE";
     aNif       = #4#35;  |QBT aNif;
     |SI aNif ! "";
         aNif = #4#35;
         |BUCLE dsmom052;
     |FINSI;

     eaPerceptor = "TITULAR";
     aNif       = #4#1;   |QBT aNif;
     |SI aNif ! "";
         aNif = #4#1;
         |BUCLE dsmom053;
     |FINSI;

     eaPerceptor = "CONYUGE";
     aNif       = #4#35;  |QBT aNif;
     |SI aNif ! "";
         aNif = #4#35;
         |BUCLE dsmom053;
     |FINSI;
|FPRO;
