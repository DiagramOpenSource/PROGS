|FICHEROS;
     gatofe01 #0;
     gatofe02 #2;
|FIN;

|VARIABLES;
     &Tempo = "";
     &enSwVerifica = 0;
     aRuta = "";
     aAlfa = "";
     nBtnCarpeta = 0;
|FIN;

|PROCESO T3; |TIPO 3;
     |HAZ DecimalesBase;
     |SI #0#1 = "SI";
          |HAZ CreaTempo; |NOME_DAT #2 Tempo; |DELINDEX #2;
          |ABRE #2;
          |HAZ LeeCsv;
          enSwVerifica = 1; |HAZ LeeTiquets;
          |HAZ FechaSin;
  ||CONSULTA_CLAVE #1#2;
          |HAZ Recalcula;
          enSwVerifica = 2; |HAZ LeeTiquets;
   ||CONSULTA_CLAVE #1#2;
          |CIERRA #2;
          |DELINDEX #2;
     |FINSI;
|FPRC;

|PROCESO BtnCarpeta;
     aRuta = "D*.*";

     |BROWSE aRuta;

     aRuta = aRuta % 2; |QBF aRuta;
     |SI aRuta = "D"; aRuta = ""; |FINSI;

     |QBF aRuta;
     |SI aRuta = "";
          |ERROR;
     |SINO;
          #0#2 = aRuta;
          |PINTA #0#2;
     |FINSI;
|FPRC;

|PROCESO Tecla; |TIPO 0;
     |SI FSalida = 13;
          |HAZ BtnCarpeta;
     |FINSI;
|FPRC;

|PROGRAMA;
     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
     #0#1 = "NO";
     |PINPA #0#0;
     ||CONTROL_SIMPLE 0, "BOTON, Carpeta", 1102, 1110, BtnCarpeta;
     nBtnCarpeta = FSalida;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0; |GRABA 020#0a; |FINSI;
     ||FIN_CONTROL_WINDOWS nBtnCarpeta;
     |CIERRA #0;
|FPRO;
