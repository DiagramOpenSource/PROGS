|FICHEROS;
     golis028 #0;
     gopartia #1;
     gomantho #2;
     goptrbli #3;
     guerm017 #4;
     guerm018 #5;
     guerm030 #6;
     guerm031 #7;
     agifa077 #8;
     agifa080 #9;
     gosubcoc #10;
     gosubpar #11;
     guerm019 #12;
     guerm043 #13;
     gocerlin #14;
     gopre003 #15;
     gocerhis #16;
     go000023 #23;

     golis029 #29;  || Tmp Impresion

     agifa019 #19;
     agifa065 #65;
     agifa069 #69;
     agifa079 #79;
     agifa084 #84;
     goparame #100;
     gomantl1 #101;
     gocerrec #114;

     agifa007 #70;
     referen@;
|FIN;

|VARIABLES;
     nHay = 0;
     aConta = "";
     &Tempo = "";
     nTipo = 0;
     aTmp29 = "";
     aTmp30 = "";
     aTipo = "";
     aAlfa = "";
     nExiste = 0;
     aObra = "";
     aSer = "";
     aNum = "";
     nNum = 0;
     nTotal = 0;
     nSwSum = 0;
     nBaseFac = 0;
|FIN;

|PROCESO Tipo66; |TIPO 66;
     |DDEF aAlfa;
     aAlfa = aAlfa + "agifa007";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |HAZ CreaTempo; |NOME_DAT #referen@#Tempo#; |DELINDEX #referen@;
          |ABRE #referen@;
          |ABRE #2;
          |ABRE #70;
          |LEE 000#2p;
          |PARA; |SI FSalida = 0; |HACIENDO;
               #70#26 = #2#0;
               |LEE 000#70=;
               |SI FSalida = 0;
                    |SALVA_DATOS #70;
                    |REPON_DATOS #referen@;
                    |GRABA 020#referen@.n;
               |FINSI;
               |LEE 000#2s;
          |SIGUE;
          |CIERRA #70;
          |CIERRA #2;
          #referen@#26 = #0Campo;
          |LEE 000#referen@.];
          |CONSULTA_CLAVE #1#referen@;
          |SI FSalida = 0;
               #0Campo = #referen@#26;
               |PINTA #0Campo;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #referen@;

          |HAZ BoraTempo; |DELINDEX #referen@;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO Tmp;
     aSer = #29#44 % 105;
     aNum = #29#44 % -106;
     |DDEFECTO #2;
     #2#0 = aSer;
     #2#1 = aNum;
     |LEE 000#2=;

     #29#46 = #2#29;

     |PRINT;
|FPRC;

|DEFBUCLE Tmp;
     #29#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp;
|FIN;

|PROCESO gocerhis;
     |DDEFECTO #15;
     |SELECT #2#15;
     #15#0 = #16#0;
     #15#1 = #16#1;
     #15#2 = #16#14;
     #15#4 = #16#4;
     |LEE 000#15=;

     |SI nSwSum = 0;
          nTotal = nTotal + ((#29#38 * #29#39) ! 2);
     |SINO;
          nTipo = 8;
          |DDEFECTO #29;
          #29#44 = aObra;
          #29#0 = nTipo;
          #29#36 = #16#4;
          |LEE 101#29=;
          |SI FSalida ! 0; |GRABA 020#29b; |FINSI;
          #29#37 = #15#5;
          #29#38 = #29#38 + #16#7;
          #29#39 = #16#8;
          #29#40 = #29#38 * #29#39;
          #29#42 = #84#48;
          #29#43 = #84#0;
          #29#45 = #69#4;
          |GRABA 020#29a;
          |LIBERA #29;
     |FINSI;
|FPRC;

|DEFBUCLE gocerhis;
     #16#1;
     ;
     #14#0, #14#1, #14#2, 001;
     #14#0, #14#1, #14#2, 999;
     ;
     NULL, gocerhis;
|FIN;

|PROCESO EstadoObra;
     |SI #0#5 = "C";
          |SI #101#10 ! "C"; |ACABA; |FINSI;
     |FINSI;
     |SI #0#5 = "F";
          |SI #101#10 ! "T"; |ACABA; |FINSI;
     |FINSI;
     nHay = 1;
|FPRC;

|DEFBUCLE EstadoObra;
     #101#1;
     ;
     aObra, 000001, 001;
     aObra, 999999, 001;
     ;
     NULL, EstadoObra;
|FIN;

|PROCESO Factura;
     aObra = #84#87 % 105;
     |SI aObra < #0#0; |O aObra > #0#1; |ACABA; |FINSI;


     |SI #0#6 ! "T";
          #23#0 = aObra;
          #23#1 = "";
          |LEE 000#23];
          |SI #23#0 ! aObra; FSalida = "1";|FINSI;

          |SI FSalida ! 0; |Y #0#6 = "S"; |ACABA; |FINSI;
          |SI FSalida = 0; |Y #0#6 = "N"; |ACABA; |FINSI;
     |FINSI;

     aNum = #84#87 % 706;
     nNum = aNum;
     aObra = aObra + "/" + (("000000" + nNum) % -106);

     #69#20 = #84#48;
     #69#0 = #84#0;
     #69#1 = 1;
     |LEE 000#69];
     |SI FSalida ! 0; |O #69#20 ! #84#48; |O #69#0 ! #84#0;
          |DDEFECTO #69;
     |FINSI;

     #13#0 = #84#48;
     #13#1 = #84#0;
     |LEE 000#13=;
     |SI FSalida = 0;
          |SELECT #3#101;
          #101#3 = #13#11;
          #101#4 = #13#12;
          |LEE 000#101=;
          |SI FSalida = 0;
               |SI #0#5 = "C";
                    |SI #101#10 ! "C"; |ACABA; |FINSI;
               |FINSI;
               |SI #0#5 = "F";
                    |SI #101#10 ! "T"; |ACABA; |FINSI;
               |FINSI;
          |FINSI;

          |DDEFECTO #15;
          |SELECT #2#15;
          #15#0 = #13#11;
          #15#1 = #13#12;
          #15#2 = #13#13;
          #15#4 = #13#14;
          |LEE 000#15=;

          nTipo = 8;
          |DDEFECTO #29;
          #29#44 = aObra;
          #29#0 = nTipo;
          #29#36 = #15#4;
          |LEE 101#29=;
          |SI FSalida ! 0; |GRABA 020#29b; |FINSI;
          #29#37 = #15#5;
          #29#38 = #29#38 + #13#7;
          #29#39 = #13#8;
          #29#40 = #84#16 + #84#19 + #84#22 + #84#28 + #84#42 + #84#45;
          #29#42 = #84#48;
          #29#43 = #84#0;
          |GRABA 020#29a;
          #29#45 = #69#4;
          |LIBERA #29;
     |SINO;
          |SELECT #2#14;
          #14#4 = #84#48;
          #14#5 = #84#0;
          |LEE 000#14=;
          |SI FSalida = 0;
               |SELECT #3#101;
               #101#3 = #14#0;
               #101#4 = #14#1;
               |LEE 000#101=;
               |SI FSalida ! 0;
                    #101#4 = #14#1 + #100#54;
                    |LEE 000#101=;
               |FINSI;
               |SI FSalida = 0;
                    |SI #0#5 = "C";
                         |SI #101#10 ! "C"; |ACABA; |FINSI;
                    |FINSI;
                    |SI #0#5 = "F";
                         |SI #101#10 ! "T"; |ACABA; |FINSI;
                    |FINSI;
               |SINO;
                    aAlfa = "0000Error certificacion:" + #14#0 + "/" + #14#1 + " no pertenece a ningun expediente...";
                    |MENAV aAlfa;
               |FINSI;
               |SI #14#7 = "S";
          ||          nTotal = 0;
          ||          nSwSum = 0;
          ||          |BUCLE gocerhis;
          ||          nBaseFac = (#84#16 + #84#19 + #84#22 + #84#28 + #84#42 + #84#45) ! 2;
                    nTotal = #14#6 ! 2;     || Bruto
                    nBaseFac = #84#15 ! 2;  || Bruto
                    |SI nTotal ! nBaseFac;
                         nTipo = 8;
                         |DDEFECTO #29;
                         #29#44 = aObra;
                         #29#0 = nTipo;
                         #29#36 = #15#4;
                         |LEE 101#29=;
                         |SI FSalida ! 0; |GRABA 020#29b; |FINSI;
                         #29#37 = "";
                         #29#38 = #29#38 + #13#7;
                         #29#39 = #13#8;
                         #29#40 = #84#16 + #84#19 + #84#22 + #84#28 + #84#42 + #84#45;
                         #29#42 = #84#48;
                         #29#43 = #84#0;
                         #29#45 = #69#4;
                         |GRABA 020#29a;
                         |LIBERA #29;
                    |SINO;
                         nSwSum = 1;
                         |BUCLE gocerhis;
                    |FINSI;
               |FINSI;
          |SINO;
               nHay = 0;
               |BUCLE EstadoObra;
               |SI nHay = 0; |ACABA; |FINSI;

               nTipo = 9;
               |DDEFECTO #29;
               #29#44 = aObra;
               #29#0 = nTipo;
               #29#42 = #13#0;
               #29#43 = #13#1;
               |LEE 101#29=;
               |SI FSalida ! 0; |GRABA 020#29b; |FINSI;
               #29#37 = #13#6;
               #29#40 = #84#16 + #84#19 + #84#22 + #84#28 + #84#42 + #84#45;
               #29#45 = #69#4;
               |GRABA 020#29a;
               |LIBERA #29;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE Factura;
     #84#1;
     1;
     "     ", 000001, #0#2;
     "zzzzz", 999999, #0#3;
     ;
     NULL, Factura;
|FIN;

|PROCESO agifa065;
     #29#32 = #29#32 + #65#6;
     |SI #65#2 = "SS";
          #29#33 = #29#33 + #65#6;
     |FINSI;
     #29#34 = #29#30 / #29#31;
     #29#35 = #29#33 * #29#34;
|FPRC;

|DEFBUCLE agifa065;
     #65#5;
     ;
     #29#26, #2#11, #0#2;
     #29#26, #2#11, #0#3;
     ;
     NULL, agifa065;
|FIN;

|PROCESO Materiales;
     |SI #29#0 = 6;
          aSer = #29#44 % 105;
          aNum = #29#44 % -106;

          #2#0 = aSer;
          #2#1 = aNum;
          |LEE 000#2=;
          |SI FSalida = 0;
               |SELECT #1#101;
               #101#0 = #2#0;
               #101#1 = #2#1;
               #101#2 = 1;
               |LEE 000#101];
               |PARA; |SI FSalida = 0; |Y #101#0 = #2#0; |Y #101#1 = #2#1; |HACIENDO;
                    |SI #0#5 = "C";
                         |SI #101#10 ! "C"; |ACABA; |FINSI;
                    |FINSI;
                    |SI #0#5 = "F";
                         |SI #101#10 ! "T"; |ACABA; |FINSI;
                    |FINSI;
                    |LEE 000#101s;
               |SIGUE;

               |SI #0#6 ! "T";
                    #23#0 = #2#0;
                    #23#1 = "";
                    |LEE 000#23];
                    |SI #23#0 ! #2#0; FSalida = "1";|FINSI;

                    |SI FSalida ! 0; |Y #0#6 = "S"; |ACABA; |FINSI;
                    |SI FSalida = 0; |Y #0#6 = "N"; |ACABA; |FINSI;
               |FINSI;

               |BUCLE agifa065;
          |FINSI;
          |GRABA 020#29a;
     |FINSI;
     |LIBERA #29;
|FPRC;

|DEFBUCLE Materiales;
     #29#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, Materiales;
|FIN;

|PROCESO DesArti;
     |SI #7#7 = "D.COMPLETA          ";
          aAlfa = "DIETA COMPLETA";
     |FINSI;
     |SI #7#7 = "D.MEDIA             ";
          aAlfa = "MEDIA DIETA";
     |FINSI;
     |SI #7#7 = "S.SOCIAL            ";
          aAlfa = "SEGURIDAD SOCIAL TRABAJADOR";
     |FINSI;
|FPRC;

|PROCESO DescriTipo2;
     |ABRE #11;
     #11#0 = #6#2;
     #11#1 = #7#3;
     #11#2 = #7#13;
     |LEE 000#11=;
     |SI FSalida ! 0;
          |SELECT #3#11;
          #11#0 = #6#2;
          #11#1 = #7#3;
          #11#3 = #7#4;
          |LEE 000#11];
          |SI FSalida ! 0; |O #11#0 ! #6#2; |O #11#1 ! #7#3; |O #11#3 ! #7#4;
               |DDEFECTO #11;
               nExiste = 1;
          |FINSI;
     |FINSI;
     |CIERRA #11;
     |SI nExiste = 0;
          aAlfa = #11#4;
     |SINO;
          |DDEFECTO #19;
          #19#0 = #7#7;
          |LEE 000#19=;
          aAlfa = #19#1; |HAZ DesArti;
     |FINSI;
|FPRC;

|PROCESO EstaConta;
     aConta = "N";
     |DDEFECTO #8;
     #8#50 = #1#4;
     #8#0 = #1#5;
     |LEE 000#8=;
     |SI FSalida = 0; |Y #8#38 = "S";
          #79#66 = #8#51;
          #79#0 = #8#39;
          |LEE 000#79=;
          |SI FSalida = 0; |Y #79#48 = "S";
               |SI #0#3 < #79#1;
                    aConta = "N";
               |SINO;
                    aConta = "S";
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO gopartia;
     |SI #1#34 = "M"; |O #1#34 = "C"; |O #1#34 = "S";
          |DDEFECTO #8;
          #8#50 = #1#4;
          #8#0 = #1#5;
          |LEE 000#8=;
          |SI FSalida = 0;    || Debe de existir siempre
               |SI #8#77 > "01.01.1900";     || Facturado
                    |SI #8#77 < #0#2; |O #8#77 > #0#3; |ACABA; |FINSI;
               |SINO;
                    |SI #8#1 < #0#2; |O #8#1 > #0#3; |ACABA; |FINSI;
               |FINSI;
          |SINO;
               |SI #1#28 < #0#2; |O #1#28 > #0#3; |ACABA; |FINSI;
          |FINSI;
     |SINO;
          |SI #1#28 < #0#2; |O #1#28 > #0#3; |ACABA; |FINSI;
     |FINSI;

     |SI #0#6 ! "T";
          #23#0 = #1#2;
          #23#1 = #1#3;
          |LEE 000#23=;
          |SI FSalida ! 0; |Y #0#6 = "S"; |ACABA; |FINSI;
          |SI FSalida = 0; |Y #0#6 = "N"; |ACABA; |FINSI;
     |FINSI;

     |SELECT #3#101;
     #101#3 = #1#0;
     #101#4 = #1#1;
     |LEE 000#101=;
     |SI FSalida = 0;
          |SI #0#5 = "C";
               |SI #101#10 ! "C"; |ACABA; |FINSI;
          |FINSI;
          |SI #0#5 = "F";
               |SI #101#10 ! "T"; |ACABA; |FINSI;
          |FINSI;
     |FINSI;

     |DDEFECTO #19;
     #19#0 = #1#20;
     |LEE 000#19=;

     aObra = #1#2 + "/" + (("000000" + #1#3) % -106);

     nTipo = 0;
     |SI #1#34 = "T";
          nTipo = 1;    || Mano Obra
          |DDEFECTO #3;
          #3#20 = #1#0;
          #3#21 = #1#1;
          #3#2 = #1#28;
          #3#3 = #1#6;
          |LEE 000#3=;

          |DDEFECTO #29;
          #29#44 = aObra;
          #29#0 = nTipo;
          #29#1 = #3#4;
          |LEE 101#29=;
          |SI FSalida ! 0; |GRABA 020#29b; |FINSI;
          #29#2 = #3#5;
          |SI #3#26 = 0;
               #29#3 = #29#3 + #3#11;
               #29#5 = #29#5 + #3#17;
               #29#4 = #29#5 / #29#3;
          |FINSI;
          |SI #3#26 = 1;
               #29#6 = #29#6 + #3#11;
               #29#8 = #29#8 + #3#17;
               #29#7 = #29#8 / #29#6;
          |FINSI;
          |SI #3#26 = 2;
               #29#9 = #29#9 + #3#11;
               #29#11 = #29#11 + #3#17;
               #29#10 = #29#11 / #29#9;
          |FINSI;
          |GRABA 020#29a;
          |LIBERA #29;
     |FINSI;

     |SI #1#34 = "S";
          nTipo = 2;    || Destajo/subcontrata
          |DDEFECTO #7;
          #7#0 = #1#4;
          #7#1 = #1#5;
          #7#2 = #1#6;
          |LEE 000#7=;
          |DDEFECTO #6;
          #6#0 = #7#0;
          #6#1 = #7#1;
          |LEE 000#6=;
          |DDEFECTO #10;
          #10#0 = #6#2;
          |LEE 000#10=;

          |DDEFECTO #29;
          #29#44 = aObra;
          #29#0 = nTipo;
          #29#12 = #10#2;
          #29#14 = #1#20; || #7#7;
          #29#42 = #1#4;
          #29#43 = #1#5;
          #29#41 = #1#6;
          |LEE 101#29=;
          |SI FSalida ! 0; |GRABA 020#29b; |FINSI;
          |||HAZ DescriTipo2;
          #29#15 = #1#30; || aAlfa;
          #29#16 = #7#5;
          #29#17 = #7#6;
          #29#18 = #7#14;
          |GRABA 020#29a;
          |LIBERA #29;
     |FINSI;

     |SI #1#7 = 1;
          |SELECT #2#5;
          #5#26 = #1#34;
          #5#27 = #1#4;
          #5#28 = #1#5;
          #5#29 = #1#6;
          |LEE 000#5=;
          |SI FSalida = 0;
               #4#0 = #5#0;
               #4#1 = #5#1;
               #4#2 = #5#2;
               |LEE 000#5=;
               |SI FSalida = 0;
                    nTipo = 3;    ||  partes maquina

                    |DDEFECTO #12;
                    #12#0 = #4#0;
                    |LEE 000#12=;

                    |DDEFECTO #29;
                    #29#44 = aObra;
                    #29#0 = nTipo;
                    #29#19 = #12#0;
                    |LEE 101#29=;
                    |SI FSalida ! 0; |GRABA 020#29b; |FINSI;
                    #29#20 = #12#1;
                    #29#21 = #29#21 + #5#5;
                    #29#22 = #5#16;
                    #29#23 = #29#23 + #5#7;
                    |GRABA 020#29a;
                    |LIBERA #29;
               |FINSI;
          |FINSI;
     |FINSI;

     |SI #1#34 = "M"; |O #1#34 = "A";
          |SI #19#126 = #100#8; |Y #19#125 = "G ";
               ||nTipo = 4;         || consumo combustible
               nTipo = 6;
               |SI #1#34 = "M";
                    |DDEFECTO #9;
                    #9#27 = #1#4;
                    #9#0 = #1#5;
                    #9#1 = #1#6;
                    |LEE 000#9=;
                    |DDEFECTO #8;
                    #8#50 = #1#4;
                    #8#0 = #1#5;
                    |LEE 000#8=;

                    |HAZ EstaConta;
                    |DDEFECTO #29;
                    #29#44 = aObra;
                    #29#0 = nTipo;
                    #29#24 = #8#3;
                    #29#26 = #1#20;
                    #29#51 = aConta;
                    |LEE 101#29=;
                    |SI FSalida ! 0; |GRABA 020#29b; |FINSI;
                    #29#25 = #8#4;
                    #29#27 = #1#30;
                    #29#28 = #29#28 + #1#10;
                    #29#30 = #29#30 + #1#14;
                    #29#29 = #29#30 / #29#28;
                    |GRABA 020#29a;
                    |LIBERA #29;
               |SINO;
                    aConta = "S";
                    |SI #1#34 = "C";
                  ||       |HAZ EstaConta;
                    |FINSI;

                    |DDEFECTO #29;
                    #29#44 = aObra;
                    #29#0 = nTipo;
                    #29#24 = "";
                    #29#26 = "ALMACEN CENTRAL";
                    |LEE 101#29=;
                    |SI FSalida ! 0; |GRABA 020#29b; |FINSI;
                    #29#25 = #8#4;
                    #29#27 = #1#30;
                    #29#28 = #29#28 + #1#10;
                    #29#30 = #29#30 + #1#14;
                    #29#29 = #29#30 / #29#28;
                    |GRABA 020#29a;
                    |LIBERA #29;
               |FINSI;
          |FINSI;
     |FINSI;

     |SI #1#34 = "M"; |Y #19#126 = #100#6; |Y #19#125 = "U ";
          nTipo = 5;              || hormigon
          |DDEFECTO #9;
          #9#27 = #1#4;
          #9#0 = #1#5;
          #9#1 = #1#6;
          |LEE 000#9=;
          |DDEFECTO #8;
          #8#50 = #1#4;
          #8#0 = #1#5;
          |LEE 000#8=;

          |DDEFECTO #29;
          #29#44 = aObra;
          #29#0 = nTipo;
          #29#24 = #8#3;
          #29#26 = #1#20;
          |LEE 101#29=;
          |SI FSalida ! 0; |GRABA 020#29b; |FINSI;
          #29#25 = #8#4;
          #29#27 = #1#30;
          #29#28 = #29#28 + #1#10;
          #29#30 = #29#30 + #1#14;
          #29#29 = #29#30 / #29#28;
          |GRABA 020#29a;
          |LIBERA #29;
     |FINSI;

     |SI #1#34 = "M"; |O #1#34 = "A";
          |SI nTipo = 0; |Y #19#137 = "S";
               nTipo = 6;
               |SI #1#34 = "M";
                    |DDEFECTO #9;
                    #9#27 = #1#4;
                    #9#0 = #1#5;
                    #9#1 = #1#6;
                    |LEE 000#9=;

                    |HAZ EstaConta;

                    |DDEFECTO #29;
                    #29#44 = aObra;
                    #29#0 = nTipo;
                    #29#26 = #1#20;
                    #29#51 = aConta;
                    |LEE 101#29=;
                    |SI FSalida ! 0; |GRABA 020#29b; |FINSI;
                    #29#27 = #1#30;
                    #29#30 = #29#30 + #1#14;
                    #29#31 = #29#31 + #1#10;
                    #29#32 = 0;
                    #29#33 = 0;
                    #29#34 = 0;
                    #29#35 = 0;
                    |GRABA 020#29a;
                    |LIBERA #29;
               |SINO;
                    aConta = "S";
                    |SI #1#34 = "C";
                  ||       |HAZ EstaConta;
                    |FINSI;

                    |DDEFECTO #29;
                    #29#44 = aObra;
                    #29#0 = nTipo;
                    #29#26 = #1#20;
                    #29#51 = aConta;
                    |LEE 101#29=;
                    |SI FSalida ! 0; |GRABA 020#29b; |FINSI;
                    #29#27 = #1#30;
                    #29#30 = #29#30 + #1#14;
                    #29#31 = #29#31 + #1#10;
                    #29#32 = 0;
                    #29#33 = 0;
                    #29#34 = 0;
                    #29#35 = 0;
                    |GRABA 020#29a;
                    |LIBERA #29;
               |FINSI;
          |FINSI;
     |FINSI;

     |SI nTipo = 0;
          nTipo = 7;    || Varios
          |DDEFECTO #9;
          #9#27 = #1#4;
          #9#0 = #1#5;
          #9#1 = #1#6;
          |LEE 000#9=;
          |HAZ EstaConta;

          |DDEFECTO #29;
          #29#44 = aObra;
          #29#0 = nTipo;
          #29#24 = #8#3;
          #29#26 = #1#20;
          #29#51 = aConta;
          |LEE 101#29=;
          |SI FSalida ! 0; |GRABA 020#29b; |FINSI;
          #29#25 = #8#4;
          #29#27 = #1#30;
          #29#28 = #29#28 + #1#10;
          #29#30 = #29#30 + #1#14;
          #29#29 = #29#30 / #29#28;
          |GRABA 020#29a;
          |LIBERA #29;
     |FINSI;
/*
     #14#0 = #1#0;
     #14#1 = #1#1;
     #14#2 = 0;
     |LEE 000#14];
     |PARA; |SI FSalida = 0; |Y #14#0 = #1#0; |Y #14#1 = #1#1; |HACIENDO;
          |SI #14#7 = "N"; |Y #14#3 ] #0#2; |Y #14#3 [ #0#3;
               |DDEFECTO #29;
               #29#44 = aObra;
               #29#0 = 10;
               ||#29#26 = #1#20;
               #29#47 = #14#2;
               |LEE 101#29=;
               |SI FSalida ! 0; |GRABA 020#29b; |FINSI;
               #29#48 = #14#3;
               #29#49 = #14#10;
               #29#50 = #14#6;
               |GRABA 020#29a;
               |LIBERA #29;
          |FINSI;
          |LEE 000#14s;
     |SIGUE;
     |LIBERA #29;
*/
|FPRC;

|DEFBUCLE gopartia;
     #1#3;
     ;
     #0#0, 000000, "     ", 000000, "                    ", "                    ";
     #0#1, 999999, "zzzzz", 999999, "zzzzzzzzzzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, gopartia;
|FIN;

|PROCESO gocerrec;
     |SELECT #3#101;
     #101#3 = #114#0;
     #101#4 = #114#1;
     |LEE 000#101=;
     |SI FSalida = 0;
          |SI #0#5 = "C";
               |SI #101#10 ! "C"; |ACABA; |FINSI;
          |FINSI;
          |SI #0#5 = "F";
               |SI #101#10 ! "T"; |ACABA; |FINSI;
          |FINSI;
     |FINSI;

     |SI #0#6 ! "T";
          #23#0 = #114#3;
          #23#1 = #114#4;
          |LEE 000#23=;
          |SI FSalida ! 0; |Y #0#6 = "S"; |ACABA; |FINSI;
          |SI FSalida = 0; |Y #0#6 = "N"; |ACABA; |FINSI;
     |FINSI;

     aObra = #114#3 + "/" + (("000000" + #114#4) % -106);

     nTipo = 10;
     |DDEFECTO #29;
     #29#44 = aObra;
     #29#0 = nTipo;
     #29#47 = #114#2;
     #29#41 = #114#2;
     #29#42 = #114#0;
     #29#43 = #114#1;
     |LEE 101#29=;
     |SI FSalida ! 0; |GRABA 020#29b; |FINSI;
     #29#48 = #114#5;
     #29#49 = #114#6;
     #29#50 = #114#7;
     |GRABA 020#29a;
     |LIBERA #29;
|FPRC;

|DEFBUCLE gocerrec;
     #114#2;
     8;
     #0#0, 000001, "     ", 000001, "N";
     #0#1, 999999, "zzzzz", 999999, "N";
     ;
     NULL, gocerrec;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;

     |HAZ CreaTempo; |NOME_DAT #29 Tempo; |DELINDEX #29; aTmp29 = Tempo;

     Impresora = "CrystalReport";
     |IMPRE -1;
     |SI FSalida = 0;
          |SI #0#4 = "S";
               |INFOR "golir028";
          |SINO;
               |INFOR "golid028";
          |FINSI;
          |SI FSalida = 0;
               |ABRET #101;
               |ABRE #23;
               |ABRE #29;
               |ABRE #19;
               |ABRE #3;
               |ABRE #4;
               |ABRE #5;
               |ABRE #6;
               |ABRE #7;
               |ABRE #8;
               |ABRE #9;
               |ABRE #10;
               |ABRE #12;
               |ABRE #14;
               |ABRE #79;
               |ABRE #114;
               |BUCLE gopartia;
               |CIERRA #114;
               |CIERRA #79;
               |CIERRA #14;
               |CIERRA #12;
               |CIERRA #10;
               |CIERRA #9;
               |CIERRA #8;
               |CIERRA #7;
               |CIERRA #6;
               |CIERRA #5;
               |CIERRA #4;
               |CIERRA #3;
               |CIERRA #19;
               |ABRE #13;
               |ABRE #14;
               |ABRE #15;
               |ABRE #69;
               |BUCLE Factura;
               |CIERRA #69;
               |CIERRA #15;
               |CIERRA #14;
               |CIERRA #13;
               |BUCLE gocerrec;
               |CIERRA #29;

               |ABRE #2;
               |BUCLE Materiales;

               |BUCLE Tmp;
               |CIERRA #2;
               |CIERRA #23;
               |CIERRAT #101;

               |PIEINF;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;

     Tempo = aTmp29; |HAZ BoraTempo; |DELINDEX #29;
|FPRC;

|PROGRAMA;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     |CLS;
     |PINPA #0#0;
     |PINDA #0#0;
     |SI #100#141 = "O";
          |PINTA 1825, "O.T.'s Internas S/N/T......";
          |ATRI I;
          |PINTA 1841, "S";
          |PINTA 1843, "N";
          |PINTA 1845, "T";
          |ATRI 0;
     |FINSI;
     |ENDATOS #1#0;
|FPRO;
