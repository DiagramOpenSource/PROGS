|FICHEROS;
     sctrz090 #0;
     sctrw014 #14;  || Servicios
|FIN;

|VARIABLES;
     &Tempo = "";
     aTmp14 = "";
     aParam = "";
     fHoy = @;
     nNume = 0;
     aPath = "";
     aDes = "";
     aDato = "";
     nHandle = 0;
     i = 0;
     aLon = "";
     nPos = 0;
     aLetra = "";
     aReg = "";
     aTab = "";
 {99}Valor = "";
     nCampo = 0;
     aNomFic = "";
     aAlfa = "";
     &enTotBillete = 0;
     &enIncBillete = 0;
     nImpDtoAuto = 0;
     nSuplePax = 0;
     nTotal = 0;
|FIN;

|PROCESO Dato;
     nCampo = 1;
     IValor = Valor1<-;
     aLon = aDato % A0;
     aReg = "";
     |PARA i = 1; |SI i [ aLon; |HACIENDO i = i + 1;
          nPos = i * 100 + 1;
          aLetra = aDato % nPos;
          |SI aLetra = aTab;
               Valor = aReg;
               aReg = "";
               nCampo = nCampo + 1;
               IValor = IValor + 1;
          |SINO;
               aReg = aReg + aLetra;
          |FINSI;
          |SI nCampo > 90; |SAL; |FINSI;     || Por si.... :)
     |SIGUE;
     Valor = aReg;
|FPRC;

|PROCESO Inicio; |TIPO 3;
     |HAZ CargaTari;
|FPRC;

|PROCESO Min14;
     #14#0 = "       ";
|FPRC;

|PROCESO Max14;
     #14#0 = "zzzzzzz";
|FPRC;

|PROCESO TipoViaje; |TIPO 0;
     |SI #0#0 = 1;
          |C_M #0#2, 1, "N";
          |C_M #0#5, 1, "N";
          |C_M #0#7, 1, "N";
     |SINO;
          |C_M #0#2, 1, "S";
          |C_M #0#5, 1, "S";
          |C_M #0#7, 1, "S";
     |FINSI;
|FPRC;

|PROCESO LeePeticion;
     |DFICE aPath;
     aDes = aPath + aNomFic + ".ent";
     |XABRE "", aDes, nHandle;
     |SI FSalida ] 0;
          |XLEE nHandle, 250, aDato;    || los nombres
          |XLEE nHandle, 250, aDato;
          |HAZ Dato;
          |XCIERRA nHandle;

          #0#0 = Valor1;
          #0#1 = Valor2;
          #0#2 = Valor3;
          #0#3 = Valor4;
          #0#4 = Valor5;
          #0#5 = Valor6;
          #0#6 = Valor7;
          #0#7 = Valor8;
          #0#8 = Valor9;
          #0#9 = Valor10;
          #0#10 = Valor11;
          #0#11 = Valor12;
          #0#12 = Valor13;
          #0#13 = Valor14;
          #0#14 = Valor15;
          #0#15 = Valor16;
     |FINSI;
|FPRC;

|PROCESO GrabaResultado;
     |DFICE aPath;
     aDes = aPath + aNomFic + ".sal";
     |XABRE "W", aDes, nHandle;
     |SI FSalida = 0;
          aDato = "tarifa" + aTab;
          aDato = aDato + "descripcion" + aTab;
          aDato = aDato + "billete" + aTab;
          aDato = aDato + "tasa" + aTab;
          aDato = aDato + "suplemento_ida" + aTab;
          aDato = aDato + "suplemento_vuelta" + aTab;
          aDato = aDato + "dto_auto" + aTab;
          aDato = aDato + "suplemento_pax" + aTab;
          aDato = aDato + "total" + aTab;
          |XGRABA nHandle, aDato;
          |LEE 000#14p;
          |PARA; |SI FSalida = 0; |HACIENDO;
               enTotBillete = #14#5 + #14#6; |HAZ IncDisBillete;
               nImpDtoAuto = #14#5 * #14#8 / 100;
               nSuplePax = enIncBillete - nImpDtoAuto;
               nTotal = #14#5 + #14#6 + nSuplePax;

               aDato = #14#0 + aTab;
               aDato = aDato + #14#1 + aTab;
               aDato = aDato + #14#5 + aTab;
               aDato = aDato + #14#6 + aTab;
               aDato = aDato + #14#3 + aTab;
               aDato = aDato + #14#4 + aTab;
               aDato = aDato + #14#8 + aTab;
               aDato = aDato + nSuplePax +  aTab;
               aDato = aDato + nTotal +  aTab;

               |XGRABA nHandle, aDato;
               |LEE 000#14s;
          |SIGUE;
          |XCIERRA nHandle;
     |FINSI;
|FPRC;

|PROGRAMA;
     aParam = PARAMETRO;

     aTab = &9;
     |HAZ CreaTempo; |NOME_DAT #14 Tempo; |DELINDEX #14; aTmp14 = Tempo; |ABRE #14;
     |SI aParam = "menu";
          |PINPA #0#0;
          |PARA; |SI; |HACIENDO;
               |PINDA #0#0;
               |ENTLINEAL #1#14, 1, 7, 20, 0, Min14, Max14;
               |ENDATOS #1#0;
               |SI FSalida ! 0; |SAL; |FINSI;
               |LEE 000#14p;
               |SI FSalida = 0;
                    |ENTLINEAL #1#14, 1, 4, 20, 0, Min14, Max14;
                    |HAZ GrabaResultado;
                    |LEE 000#14p;
                    |PARA; |SI FSalida = 0; |HACIENDO;
                         |BORRA 020#14a;
                         |LEE 000#14s;
                    |SIGUE;
               |SINO;
                    |MENAV "0000No hay tarifas...";
               |FINSI;
          |SIGUE;
     |SINO;
          aNomFic = aParam;
          |HAZ LeePeticion;
          |HAZ Inicio;
          |HAZ GrabaResultado;
     |FINSI;
     |CIERRA #14; |DELINDEX #14; Tempo = aTmp14; |HAZ BoraTempo;
|FPRO;
