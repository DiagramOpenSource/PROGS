|FICHEROS;
     tlfm0001 #0;
     tlfm0002 #2;
     agifa017 #17;
     agifa019 #19;
     dsm00043 #43;
     dsm00044 #44;
     agifa065 #65;
     dsm00003,MANTE;
|FIN;

|INCLUYE i_varart;

|VARIABLES;
     aTexto    = "";
     aMes      = "";
     aAlfa     = "";
     nModo     = 0;
     nMes      = 0;
     nForma    = 0;
|FIN;

|PROCESO Usado0; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI #0#55 ! "U"; |Y #0#55 ! "P"; |Y nModo = 1;
          |MENAV "0000Alta IMEI ERRONEA...";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Modi7; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          #0#55 = "U"; |PINTA #0#55;
     |FINSI;
     |SI #0#55 = "N";
          |C_M #0#1, 1, "N";
          |C_M #0#3, 1, "N";
          |C_M #0#4, 1, "N";
          |C_M #0#11, 1, "N";
          |C_M #0#55, 1, "N";
     |SINO;
          |C_M #0#1, 1, "S";
          |C_M #0#3, 1, "S";
          |C_M #0#4, 1, "S";
          |C_M #0#11, 1, "S";
          |C_M #0#55, 1, "S";
     |FINSI;
|FPRC;

|PROCESO ArtiAlma;
     |ABRE #17;
     |ABRE #19;

     |DDEFECTO #19;
     #19#0 = #0#1;
     |LEE 121#19=;
     |SI FSalida ! 0; |GRABA 020#19b; |FINSI;
     #19#6 = #19#6 + nForma;
     #19#104 = #19#104 + nForma;
     aMes = (#43#1 % 402);
     nMes = aMes;
     nMes = ((nMes - 1) * 5) + 32;
     #19nMes = #19nMes + nForma;

     |DDEFECTO #17;
     #17#0 = #0#1;
     #17#1 = #0#11;
     |LEE 121#17=;
     |SI FSalida ! 0; |GRABA 020#17b; |FINSI;
     #17#5 = #17#5 + nForma;
     #17#39 = #17#39 + nForma;
     aMes = (#43#1 % 402);
     nMes = aMes;
     nMes = ((nMes - 1) * 3) + 11;
     #17nMes = #17nMes + nForma;

     |HAZ ValoraStock;
     |GRABA 020#17a;
     |GRABA 020#19a;

     |CIERRA #17;
     |CIERRA #19;
|FPRC;

|PROCESO Historico;
     |ABRE #65;
     |SI nForma = 1;
          |DDEFECTO #65;
          #65#0 = #0#1;
          #65#1 = #43#1;
          #65#2 = "ES";
          #65#3 = #0#42;
          #65#4 = #0#43;
          #65#5 = #0#11;
          #65#6 = 1;
          #65#7 = #19#6;
          #65#8 = #19#9;
          #65#10 = #0#5;
          |GRABA 020#65n;
     |SINO;
          #65#0 = #0#1;
          #65#1 = #43#1;
          #65#2 = "ES";
          #65#3 = #0#42;
          #65#4 = #0#43;
          #65#11 = "";
          |BORRA 020#65c;
     |FINSI;
     |CIERRA #65;
|FPRC;

|PROCESO EntradaStock;
     |ABRE #43;
     |ABRE #44;
     |SI nForma = 1;
          |LEE 000#43u;
          #0#42 = #43#0 + 1;
          #0#43 = 1;
          |DDEFECTO #43;
          #43#0 = #0#42;
          #43#1 = ~;
          #43#2 = aTexto;
          #44#18 = #0#42;
          #44#8 = #0#43;
          #44#7 = "E";
          #44#0 = #0#1;
          #44#1 = #0#11;
          #44#2 = #19#1;
          #44#4 = 1;
          #44#9 = #0#0; ||IMEI
          #44#10 = #0#3;||ABO
          #44#11 = #0#4;||ICC
          |GRABA 020#43n;
          |GRABA 020#44n;
     |SINO;
          #43#0 = #0#42;
          |LEE 101#43=;
          #44#18 = #0#42;
          #44#8 = #0#43;
          |LEE 101#44=;
          |SI FSalida = 0;
               |BORRA 020#44a;
               #44#0 = 1;
               |LEE 000#44];
               |SI FSalida ! 0; |LEE 000#44u; |FINSI;
               |SI #44#18 ! #0#43;
                    |BORRA 020#43a;
               |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #43;
     |CIERRA #44;
|FPRC;

|PROCESO Tipo2; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     nForma = 0 +. 1;
     |SI #0#52 ! 0;
          |SI nModo = 3;
               |MENAV "0000IMEI introducido por Compras, modifique el Albaran...";
               |ERROR;
          |FINSI;
          |ACABA;
     |FINSI;
/*
     |SI nModo = 3;
          |ABRE #2;
          #2#3 = #0#3;
          |BORRA 000#2c;
          |CIERRA #2;
          |HAZ EntradaStock;
          |HAZ ArtiAlma;
          |HAZ Historico;
     |SINO;
          |SI #0#55 = "U";
               aTexto = "Entrada IMEI (usado)";
          |SINO;
               aTexto = "Entrada IMEI";
          |FINSI;
          |HAZ EntradaStock;
          |HAZ ArtiAlma;
          |HAZ Historico;
     |FINSI;
*/
     aAlfa = #0#3; |QBF aAlfa;
     |SI nModo = 2; |Y #0#55 = "N"; |Y aAlfa ! "";
          |ABRE #2;
          #2#3 = #0#3;
          |LEE 101#2=;
          |SI FSalida = 0;
               #2#39 = #0#44;
               #2#40 = #0#45;
               #2#41 = #0#46;
               #2#42 = #0#47;
               #2#43 = #0#48;
               |GRABA 020#2a;
          |FINSI;
          |CIERRA #2;
     |FINSI;
|FPRC;

|PROCESO LlenaArti; |TIPO 6;
     enAlta = 1;
     eaArticulo = #0Campo;
     |HAZ LlenaArticulo;
     |SI FSalida = 0;
          #0Campo = eaArticulo;
          |PINTA #0Campo;
     |SINO;
          |ERROR; |ACABA;
     |FINSI;
|FPRC;
