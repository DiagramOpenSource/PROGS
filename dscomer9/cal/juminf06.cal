|FICHEROS;
     juminf06 #0;
     juminf29 #29,MANTE; || Bancos
     agifa112 #112;
     agifa184 #184;
     agifa142 #142;
|FIN;

|VARIABLES;
     &eaPais = "";
     &eaVarDni = "";
     aNifQbf1 = "";
     aNifQbf2 = "";
     aAlfa = "";
     nModo = 0;
     nForma = 0;
     cuen = "";
     quitar = 0;
     cod = 0;
     {-1}aVent = "";
         aVent1 = 0;
         aVent2 = 0;
         aVent3 = 0;
         aVent4 = 0;
         aVent5 = "";
     nVentana = 0;
     i = 0;
|FIN;

|PROCESO Tipo80_6; |TIPO 80;
     FSalida = 2991;
|FPRC;


|PROCESO MontaCP06; |TIPO 0;
     #0#6 = (("00" + #0#4) % -102) + (("000" + #0#5) % -103);
|FPRC;

|PROCESO LetraNif06; |TIPO 6;
     eaPais = "";

     |SI FSalida = 9;
          eaVarDni  = #0Campo;
          |HAZ CalculoNIFCIF;
          #0Campo = eaVarDni;
          |PINTA #0Campo;
          |ERROR; |ACABA;
     |FINSI;

     eaVarDni  = #0Campo;
     |HAZ CalculoNIFCIF;

     aNifQbf1 = #0Campo;   |QBF aNifQbf1;
     aNifQbf2 = eaVarDni;  |QBF aNifQbf2;

     |SI aNifQbf1 ! aNifQbf2; |Y aNifQbf1 ! "";
          aAlfa = "0000NEl NIF puede ser erróneo."+&13+"¿Desea calcularlo?";
          |CONFI aAlfa;
          |SI FSalida = 0;
               #0Campo = eaVarDni; |PINTA #0Campo;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo2_6; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     nForma = 0 +. 1;

     |ABRE #112;
     |SI nModo = 3;
          #112#0 = #0#0;
          |BORRA 000#112c;
     |SINO;
          |SI nForma = 1;
               |DDEFECTO #112;
               #112#0 = #0#0;
               |LEE 101#112=;
               |SI FSalida ! 0; |GRABA 020#112b; |FINSI;
               #112#1 = #0#1;
               #112#3 = #0#2;
               #112#4 = #0#3;
               #112#74 = #0#4;
               #112#75 = #0#5;
               #112#5 = #0#7;
               #112#9 = #0#8;
               #112#6 = #0#9;
               #112#7 = #0#10;
               #112#83 = #0#11;
               #112#84 = #0#12;
               #112#109 = #0#13;
               #112#10 = #0#14;
               #112#23 = #0#15;
               #112#26 = #0#16;
               #112#88 = #0#17;
               #112#14 = #0#18;
               #112#11 = #0#19
               #112#14 = ("0000" + #0#20) % -104;
               #112#15 = ("0000" + #0#21) % -104;
               #112#13 = ("00" + #0#22) % -102;
               #112#12 = ("0000000000" + #0#23) % -110;
               #112#57 = #0#24;
               #112#98 = #0#25;
               #112#17 = #0#26;
               |GRABA 020#112a;
          |FINSI;
     |FINSI;
     |CIERRA #112;
|FPRC;

|PROCESO Tipo0_6; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     cuen = #0#10; |QBF cuen;
     |SI nModo = 1; |Y cuen = "";
         |ABRE #142; |LEE 000#142p;  |CIERRA #142;
         cod = #0#0;
         |SI cod ! 0;
              cuen = "000000000000" + cod; || #0#0;
              |QBT cuen;
              quitar = -(100 + (#142#11 - 2));
              cuen = cuen % quitar;
              cuen = "40" + cuen;
              #0#14 = cuen;
              |PINTA #0#14;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO BancoAsocia; |TIPO 6;
     |ABRE #184;
     #184#0 = #0#25;
     |LEE 000#184=;
     |SI FSalida ! 0;
          |HAZ NuevoBanco;
     |FINSI;
     |CIERRA #184;
     #0#24 = #184#6; |PINTA #0#24;
     |PINTA 2142, #184#1;
     |PINTA 2214, #184#8;
     |PINTA 2237, #184#9;
|FPRC;

|PROCESO NuevoBanco;
     |VENTANA 0503, 2789, -1, 17, "Alta Banco";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DDEFECTO #29;
     #29#0 = #0#25;
     |PINPA #0#29;
     |PINDA #0#29;
     |ENDATOS #1#29;
     |SI FSalida = 0;
          |PARA i = 0; |SI i [ 33; |HACIENDO i = i + 1;
               #184i = #29i;
          |SIGUE;
          |GRABA 020#184n;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;
     |PULSATECLA;
|FPRC;

|PROCESO Tipo13_6; |TIPO 13;
     |ABRE #184;
     #184#0 = #0#25;
     |LEE 000#184=;
     |SI FSalida = 0;
        #0#24 = #184#6; |PINTA #0#24;
        |PINTA 2142, #184#1;
        |PINTA 2214, #184#8;
        |PINTA 2237, #184#9;
     |FINSI;
     |CIERRA #184;
|FPRC;

|PROCESO T6_12; |TIPO 12;
|FPRC;
