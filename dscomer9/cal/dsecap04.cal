|FICHEROS;
     dsecap04 #0;
     dsm00225 #225;
|FIN;

|PROCESO Tipo80_4; |TIPO 80;
     FSalida = 2380;
|FPRC;

|VARIABLES;
     &eaIBANant = "";
     &eaIBAN = "";
     &eaPais = "";
     &eaCta = "";
     &eaSucursal = "";
     &eaEntidad = "";
     &eaCuenta = "";
     &eaDC = "";
     nCuenta = 0;
     aConte = "";
     aAlfa = "";
|FIN;

|PROCESO Conte; |TIPO 7;
     aConte = #0Campo;
|FPRC;

|PROCESO Digito2;
     |SI aConte ! #0Campo;
          eaEntidad = #0#2; |QBF eaEntidad; eaEntidad = eaEntidad % 104;
          eaSucursal = #0#3; |QBF eaSucursal; eaSucursal = eaSucursal % 104;
          eaCuenta = #0#5; |QBF eaCuenta; eaCuenta = eaCuenta % 110;

          nCuenta = #0#5;
          |SI nCuenta ! 0;
               eaDC = "";
               |HAZ CalculoDC;
               #0#4 = eaDC;
               |PINTA #0#4;
          |FINSI;
          eaIBANant = "";
          eaCta = (("0000"+#0#2)%-104)+(("00000"+#0#3)%-104)+(("00"+#0#4)%-102)+(("0000000000"+#0#5)%-110)
          eaPais = #0#7;
          |HAZ CalcuIBAN;
          #0#6 = eaIBAN; |PINTA #0#6;
     |FINSI;
|FPRC;

|PROCESO Iban7; |TIPO 7;
     aAlfa = #0#6; |QBF aAlfa;
     |SI aAlfa = "";
          eaIBANant = "";
          eaCta = (("0000"+#0#2)%-104)+(("00000"+#0#3)%-104)+(("00"+#0#4)%-102)+(("0000000000"+#0#5)%-110)
          eaPais = #0#7;
          |HAZ CalcuIBAN;
          #0#6 = eaIBAN; |PINTA #0#6;
     |FINSI;
|FPRC;

|PROCESO Iban0; |TIPO 0;
     |SI FSalida = 2; |ACABA; |FINSI;

     eaCta     = (("0000"+#0#2)%-104)+(("00000"+#0#3)%-104)+(("00"+#0#4)%-102)+(("0000000000"+#0#5)%-110)
     eaPais    = #0#7;
     eaIBANant = #0#6;
     |HAZ CalcuIBAN;
     aAlfa = eaIBANant; |QBF aAlfa;
     |SI aAlfa ! eaIBAN;
         |SI aAlfa = "";
             #0#6 = eaIBAN;
             |PINTA #0#6;
         |SINO;
             |CONFI "0000Error. Código IBAN incorrecto, quiere calcularlo.";
             |SI FSalida = 0;
                 #0#6 = eaIBAN;
                 |ERROR;
             |FINSI;
         |FINSI;
     |FINSI;
     eaIBANant = "";
|FPRC;

|PROCESO T13; |TIPO 13;
     |ABRE #225;
     #225#0 = #0#7;
     |LEE 000#225=;
     |SI FSalida ! 0; |DDEFECTO #225; |FINSI;
     |CIERRA #225;
     |PINTA 1232, #225#1;
|FPRC;

|PROCESO Pais; |TIPO 0;
     |ABRE #225;
     #225#0 = #0#7;
     |LEE 000#225=;
     |SI FSalida = 0;
          |PINTA 1232, #225#1;
     |SINO;
          |MENAV "0000No existe c¢digo de pa¡s...";
          |ERROR;
     |FINSI;
     |CIERRA #225;
|FPRC;

|PROCESO T4_12; |TIPO 12;
|FPRC;
