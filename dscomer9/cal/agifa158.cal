                    ||CAMBIO CODIGOS REPRESENTANTE
|FICHEROS;
     agifa158 #0;
     agifa154 #1;
     agifa025 #2;        ||Representantes
     agifa024 #3;        ||Clientes
     agifa036 #5;        ||Depositos
     agifa104 #6;        ||Pedidos
     agifa073 #7;        ||Lineas de Pedidos
     agifa010 #8;        ||Albaranes
     agifa084 #9;        ||Facturas Contado
     agifa134 #10;       ||Facturas
     agifa146 #11;       ||Facturas Proforma
     referen@;
|FIN;


|VARIABLES;
     &eaFic = "";
     &eaOrg = "";
     &eaDes = "";
     &enErr = 0;
     &CambDesc = "";
     &AltaArt  = "";

     &tabla = 0;
     &sust = " ";
     &stock = " ";
     &tipo = " ";
     i = 0;
     rep1 = "";
     rep = "";
     desde = "                              ";
     hasta = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     aDef = "";
     aAlfa = "";
|FIN;

|PROCESO pcegm004;
     #referen@#7 = rep1;
     |GRABA 020#referen@.a;
     |LIBERA #referen@;
|FPRC;

|DEFBUCLE pcegm004;
     #referen@#1002;
     7;
     "     ", 000001, rep;
     "zzzzz", 999999, rep;
     be;
     NULL, pcegm004;
|FIN;

|PROCESO pcegm002;
     #referen@#6 = rep1;
     |GRABA 020#referen@.a;
     |LIBERA #referen@;
|FPRC;

|DEFBUCLE pcegm002;
     #referen@#1002;
     6;
     "     ", 000001, rep;
     "zzzzz", 999999, rep;
     be;
     NULL, pcegm002;
|FIN;

|PROCESO mirarepre;
     |ABRE #2;
     #2#0 = rep;
     |LEE 001#2=;
     |SI FSalida = 0;
          |SI sust = "S";
               |BORRA 021#2a;
          |FINSI;
          |SI sust = "D"; |Y stock = "S";
               |PARA i = 11; |SI i [ 38; |HACIENDO i = i + 1;
                    #2i = 0;
               |SIGUE;
               |PARA i = 40; |SI i [ 53; |HACIENDO i = i + 1;
                    #2i = 0;
               |SIGUE;
          |FINSI;
          #2#0 = rep1;
          |SI CambDesc = "S"; #2#1 = #1#5; |FINSI;
          |SI AltaArt = "S";
               |GRABA 000#2n;
               |SI FSalida ! 0;
                    enErr = FSalida;
                    eaFic = "agifa025";
                    eaOrg = rep;
                    eaDes = rep1;
                    |HAZ Print;
               |FINSI;
          |FINSI;
          |LIBERA #2;
     |FINSI;
     |CIERRA #2;
|FPRC;

||===================== CAMBIO DE CODIGO EN CLIENTES ======================

|PROCESO clien;
     #3#25 = rep1;
     |GRABA 021#3a;
     |LIBERA #3;
|FPRC;

|DEFBUCLE clientes;
#3#1;
25;
"      " , rep;
"zzzzzz" , rep;
be;
NULL , clien;
|FIN;

|PROCESO clien1;
     #3#26 = rep1;
     |GRABA 021#3a;
     |LIBERA #3;
|FPRC;

|DEFBUCLE clientes1;
#3#1;
26;
"      " , rep;
"zzzzzz" , rep;
be;
NULL , clien1;
|FIN;

||===================== CAMBIO CODIGOS PEDIDOS ============================

|PROCESO cabdepo;
     #5#6 = rep1;
     |GRABA 021#5a;
     |LIBERA #5;
|FPRC;

|DEFBUCLE deposito;
#5#1;
6;
"  " ,       0 , rep;
"zz" ,  999999 , rep;
be;
NULL , cabdepo;
|FIN;

||========================= CAMBIO CODIGO EN PEDIDOS ======================

|PROCESO cabpedi;
     #6#7 = rep1;
     |GRABA 021#6a;
     |LIBERA #6;
|FPRC;

|PROCESO linpedi;
     |LEE 101#7=;
     #7#16 = rep1;
     |GRABA 021#7a;
     |LIBERA #7;
|FPRC;

|DEFBUCLE pedidos;
#6#1;
7;
"     " ,       0 , rep;
"zzzzz" ,  999999 , rep;
be;
NULL , cabpedi , linpedi;
|FIN;

||========================= CAMBIO CODIGO EN PEDIDOS ======================

|PROCESO cabalba;
     #8#6 = rep1;
     |GRABA 021#8a;
     |LIBERA #8;
|FPRC;

|DEFBUCLE albaran;
#8#1;
6;
"     " ,       0 , rep;
"zzzzz" ,  999999 , rep;
be;
NULL , cabalba;
|FIN;

||========================= CAMBIO CODIGO EN FACTURAS CONTADO =============

|PROCESO cabcont;
     #9#6 = rep1;
     |GRABA 021#9a;
     |LIBERA #9;
|FPRC;

|DEFBUCLE contado;
#9#1;
6;
"     " ,       0 , rep;
"zzzzz" ,  999999 , rep;
be;
NULL , cabcont;
|FIN;

||========================= CAMBIO CODIGO EN FACTURAS =====================

|PROCESO cabfact;
     #10#7 = rep1;
     |GRABA 021#10a;
     |LIBERA #10;
|FPRC;

|DEFBUCLE facturas;
#10#1;
7;
"     " ,       0 , rep;
"zzzzz" ,  999999 , rep;
be;
NULL , cabfact;
|FIN;


||========================= CAMBIO CODIGO EN FACTURAS PROFORMA ============

|PROCESO cabprof;
     #11#6 = rep1;
     |GRABA 021#11a;
     |LIBERA #11;
|FPRC;

|DEFBUCLE proforma;
#11#1;
6;
"     " ,       0 , rep;
"zzzzz" ,  999999 , rep;
be;
NULL , cabprof;
|FIN;


|PROCESO empieza;
     rep = #1#2 % 102;
     rep1 = #1#3 % 102;
     #0#0 = rep;
     #0#1 = rep1;
     |PINTA #0#0;   |PINTA #0#1;
     |HAZ mirarepre;
     |SI sust = "S";
          |BUCLE clientes;
          |BUCLE clientes1;
          |BUCLE deposito;
          |BUCLE pedidos;
          |BUCLE albaran;
          |BUCLE contado;
          |BUCLE facturas;
          |BUCLE proforma;

          |HAZ EsPCEGroup;
          |SI FSalida = 0;
               |DDEF aDef;

               aAlfa = aDef + "pcegm002";
               |CARGA_DEF aAlfa, referen@;
               |SI FSalida = 0;
                    |BUCLE pcegm002;
                    |DESCARGA_DEF #referen@;
               |FINSI;
               aAlfa = aDef + "pcegm004";
               |CARGA_DEF aAlfa, referen@;
               |SI FSalida = 0;
                    |BUCLE pcegm004;
                    |DESCARGA_DEF #referen@;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE primero;
#1#1;
6;
tabla ,     0 , tipo;
tabla , 99999 , tipo;
e;
NULL , empieza;
|FIN;

|PROGRAMA;
     |PINPA #0#0;
     |BUCLE primero;
     |HAZ EnviaMail;
|FPRO;
