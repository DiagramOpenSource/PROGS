|FICHEROS;
     golis002 #0;
     gomantho #10;       ||Expedientes CAB.
     gomantl1 #11;       ||Expedientes LIN.
     gopre001 #21;       ||Presupuestos
     gopartia #22;
     gocercab #23;
     gocerlin #24;
     guerm043 #43;
     agifa084 #84;
     go000023 #230;
     goparame;
|FIN;

|VARIABLES;
     aInforme  = "";
     aInformes = "golis0s2"
     aInformec = "golis0c2";
     aInformeo = "golis0o2";
     nEje      = 0;
     &enEje    = 0;
     &enGGBI   = 0;
     &enSub    = 0;
     &enCer    = 0;
     nHay      = 0;
     nPor      = 0;
     nSw0      = 0;
     nSw1      = 0;
     nTotal    = 0;
     n31       = 0;
     n32       = 0;
     n33       = 0;
     nDescuen  = 0;
     nDto = 0;
     nGG = 0;
     nBI = 0;
     nBaja = 0;
     nFacDir = 0;
|FIN;

|PROCESO Facturas;
     #84#48 = #43#0;
     #84#0 = #43#1;
     |LEE 000#84=;
     |SI FSalida = 0;
          nFacDir = nFacDir + (#84#16+#84#19+#84#22+#84#28+#84#42+#84#45);
     |FINSI;
|FPRC;

|DEFBUCLE Facturas;
     #43#2;
     ;
     #10#0, #10#1;
     #10#0, #10#1;
     ;
     NULL, Facturas;
|FIN;

|PROCESO FactDir;
     nFacDir = 0;
     |ABRE #84;
     |BUCLE Facturas;
     |CIERRA #84;
|FPRC;

|PROCESO CalcuTot;
/*  QUITADO  Thu May 27 13:48:14 CEST 2004
     nDescuen = enCer % #21#43;
     enCer = enCer - nDescuen;
     n31 = enCer % #21#26;
     n32 = enCer % #21#27;
     enCer = enCer + n31 + n32;
     n33 = enCer % #21#28;
     enCer = enCer - n33;
*/
|FPRC;

|PROCESO NuevoTot; /* A¤adido Tue Jul 13 14:03:17 CEST 2004 */
     nDto = (enCer * #21#43 / 100) ! 2;
     nGG = ((enCer - nDto) * #21#26 / 100) ! 2;
     nBI = ((enCer - nDto) * #21#27 / 100) ! 2;
     nBaja = ((enCer + nGG + nBI - nDto) * #21#28 / 100) ! 2;

     enCer = enCer - nDto + nGG + nBI - nBaja;
|FPRC;

|PROCESO gopartia;
||     enEje = enEje + (#22#23 * #22#10);   ESTE se comento despues
||     nEje = nEje + (#22#23 * #22#10);     que el golis011

     enEje = enEje + #22#14;
     nEje = nEje + #22#14;
|FPRC;

|DEFBUCLE gopartia;
     #22#3;
     ;
     #10#0, #10#1, #11#3, #11#4, "                    ", "                    ";
     #10#0, #10#1, #11#3, #11#4, "zzzzzzzzzzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, gopartia;
|FIN;

|PROCESO gocerlin;
     |SI #24#15 ! 0;
          enCer = enCer + #24#15;
     |SINO;
          enCer = enCer + #24#6;
     |FINSI;
|FPRC;

|PROCESO gomantl1;
     nSw1 = 1;

     #gocercab#0 = #gomantl1#3;
     #gocercab#1 = #gomantl1#4;
     |LEE 000#gocercab.=;
     |SI FSalida = 0;
          |BUCLELIN 2 gocerlin #23;
     |SINO;
          |SI #goparame#52 = "S";
              #gocercab#1 = #gocercab#1 + #goparame#54;
              |LEE 000#gocercab.=;
              |SI FSalida = 0;
                  |BUCLELIN 2 gocerlin #23;
              |SINO;
                  #gocercab#1 = #gocercab#1 - #goparame#54 - #goparame#54;
                  |LEE 000#gocercab.=;
                  |SI FSalida = 0;
                      |BUCLELIN 2 gocerlin #23;
                  |SINO;
                      #gocercab#1 = #gocercab#1 + #goparame#56;
                      |LEE 000#gocercab.=;
                      |SI FSalida = 0;
                          |BUCLELIN 2 gocerlin #23;
                      |SINO;
                          #gocercab#1 = #gocercab#1 - #goparame#56 - #goparame#56;
                          |LEE 000#gocercab.=;
                          |SI FSalida = 0;
                              |BUCLELIN 2 gocerlin #23;
                          |FINSI;
                      |FINSI;
                  |FINSI;
              |FINSI;
          |FINSI;
      |FINSI;

     |DDEFECTO #gopre001;
     #gopre001#0 = #gomantl1#3;
     #gopre001#1 = #gomantl1#4;
     |LEE 000#gopre001.=;
     |SI FSalida = 0;
          nPor = #gopre001#26 + #gopre001#27;
          |SI nPor = 0;
               nPor = 19;
          |FINSI;

          |HAZ CalcuTot;
     |SINO;
          nPor = 19;
     |FINSI;


     nEje = 0;
     |BUCLE gopartia;

     enGGBI = enGGBI + (nEje % nPor);

     |HAZ NuevoTot;
|FPRC;

|PROCESO gomantho;
     |SI #0#18 ! "T";
          #230#0 = #gomantho#0;
          #230#1 = #gomantho#1;
          |LEE 000#230=;
          |SI FSalida = 0; |Y #0#18 = "N"; |ERROR; |ACABA; |FINSI;
          |SI FSalida ! 0; |Y #0#18 = "S"; |ERROR; |ACABA; |FINSI;
     |FINSI;

     nSw0 = 0;
     |SI #0#14 = "S"; |Y #10#9 = "C"; nSw0 = 1; |FINSI;
     |SI #0#15 = "S"; |Y #10#9 = "P"; nSw0 = 1; |FINSI;
     |SI #0#16 = "S"; |Y #10#9 = "T"; nSw0 = 1; |FINSI;
     |SI #0#17 = "S"; |Y #10#9 = "E"; nSw0 = 1; |FINSI;
     |SI nSw0 = 0;
          |ERROR;
          |ACABA;
     |FINSI;

     enEje = 0; enGGBI = 0; enSub = 0; enCer = 0; nSw1 = 0;
     |HAZ FactDir

     |BUCLELIN 2 gomantl1 #10;
     enCer = enCer + nFacDir;
     |SI nSw1 ! 0;
          ||este SI  tampoco estaba, se puso despues que el de golis011
          |SI enEje ! 0; |O enGGBI ! 0; |O enSub ! 0; |O enCer ! 0;
               enSub = enEje + enGGBI;
               |PRINT;
               nHay = 1;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE gomantho_s;
     #gomantho#1;
     2, 30, 24, 25;
     #golis002#1, #golis002#3, #golis002#5, #golis002#7, #golis002#9, #golis002#11;
     #golis002#2, #golis002#4, #golis002#6, #golis002#8, #golis002#10, #golis002#12;
     ;
     NULL, gomantho;
|FIN;

|DEFBUCLE gomantho_c;
     #gomantho#1;
     2, 30, 24, 25;
     #golis002#1, #golis002#3, #golis002#5, #golis002#7, #golis002#9, #golis002#11;
     #golis002#2, #golis002#4, #golis002#6, #golis002#8, #golis002#10, #golis002#12;
     ;
     NULL, NULL, NULL, NULL, NULL, gomantho;
     #gomantho#2;
|FIN;

|DEFBUCLE gomantho_o;
     #gomantho#1;
     2, 30, 24, 25;
     #golis002#1, #golis002#3, #golis002#5, #golis002#7, #golis002#9, #golis002#11;
     #golis002#2, #golis002#4, #golis002#6, #golis002#8, #golis002#10, #golis002#12;
     ;
     NULL, NULL, NULL, NULL, NULL, gomantho;
     #gomantho#30;
|FIN;

|PROCESO Inicio;
     |SI #0#13 = "S"; aInforme = aInformes; |FINSI;
     |SI #0#13 = "C"; aInforme = aInformec; |FINSI;
     |SI #0#13 = "O"; aInforme = aInformeo; |FINSI;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR aInforme;
          |SI FSalida ! 0;
               aInforme = "0000No existe informe:" + aInforme;
               |MENAV aInforme;
          |SINO;
               |ABRE #21;
               |ABRE #23;
               |ABRE #230;
               |SI #0#13 = "S"; |BUCLE gomantho_s; |FINSI;
               |SI #0#13 = "C"; |BUCLE gomantho_c; |FINSI;
               |SI #0#13 = "O"; |BUCLE gomantho_o; |FINSI;
               |CIERRA #230;
               |CIERRA #23;
               |CIERRA #21;
               |SI nHay ! 0; |PIEINF; |FINSI;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROGRAMA;
     |HAZ MiraLogos; || Copia Logos para el Crystal
     |ABRE #goparame; |LEE 000#goparame.p; |CIERRA #goparame;
     |CLS;
     |ABRE #0;
     |DDEFECTO #0;
     |LEE 101#0p;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |GRABA 020#0a;
          |HAZ Inicio;
     |FINSI;
     |LIBERA #0;
     |CIERRA #0;
|FPRO;
