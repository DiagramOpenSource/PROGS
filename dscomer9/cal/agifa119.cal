                   Lineas de Ordenes de fabricacion

|FICHEROS;
      agifa074#1;
      agifa019#2;
      agifa017 #3;
      agifa048#4;
      agifa049#5;
      agifa119#6;
      agifa090#7;
|FIN;
|VARIABLES;
 cantidad = 0;
 diferencia = 0;
 conta1 = 0;
 conta2 = 0;
|FIN;

|CAMPOS;
      #1#2   ordesca    ;      #1#7   ordalma2   ;
      #1#4   ordcanti   ;

      #2#0   artcodig   ;      #2#13  artfabri   ;
      #2#15  artpeser   ;      #2#12  artreser   ;
      #2#17  artpeval   ;      #2#104 artdispo   ;
      #2#7   artminim   ;      #2#11  artneces   ;
      #2#6   arttotal   ;

      #3#0   artilin    ;      #3#1   almalin    ;
      #3#8   reselin    ;      #3#9   sfablin    ;
      #3#39  displin    ;      #3#5   stokalm    ;

      #4#0   escodigo   ;      #4#10  escalma    ;

      #5#0   linesca    ;      #5#2   linartic   ;
      #5#4   lincanti   ;      #5#9   linalmac   ;

|FIN;

|INCLUYE i_kitfab;

|CALCULO linescan;
         artcodig = linartic;
         |LEE 101#2=;
         |SI 0 = FSalida;
            artilin = linartic;
            almalin = linalmac;
            |LEE 101#3=;
            |SI 0 = FSalida;
                   cantidad = diferencia * lincanti;
                   artreser = artreser - cantidad;
                   artpeser = artpeser - cantidad;
                   reselin  = reselin  - cantidad;
                   stokalm  = stokalm  - cantidad;
                   arttotal = arttotal - cantidad;
                   |GRABA 101#3a;
                   |GRABA 101#2a;
            |FINSI;
            |LIBERA #3;
         |FINSI;
         |LIBERA #2;
|FCAL;






|CALCULO ordartic;
|ABRE #2;
|ABRE #3;
|ABRE #4;
escodigo = ordesca;
|LEE 101#4=;
|SI 0 = FSalida;
    artcodig = escodigo;
    |LEE 101#2=;
      |SI FSalida = 0;
         artilin = artcodig; almalin = ordalma2;
         |LEE 101#3=;
            |SI FSalida = 0;
                diferencia = #1#4 - #1#5;
                artfabri = artfabri - diferencia;
                artneces = artneces + diferencia;
                sfablin = sfablin - diferencia;
                |GRABA 101#2a;
                |GRABA 101#3a;
            |FINSI;
      |FINSI;
      |BUCLELIN 0linescan#4;
      |BORRA 040#1a;
|FINSI;
|CIERRA #2;
|CIERRA #3;
|CIERRA #4;
|FCAL;



|CALCULO borrar; |TIPO 3;
|ABRE #7;
conta1 = 0;
conta2 = 0;
#7#0 = #6#0;
|LEE 040#7=;
    |SI FSalida = 0;
        |BUCLELIN 0 ordartic #7;
    |FINSI;
    |BORRA 040#7a;
|CIERRA #7;
|FCAL;
