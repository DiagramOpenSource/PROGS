|FICHEROS;
     goma0007 #0;
     goma0004 #4;
     goma0005 #5;
     goma0006 #6;
     referen@;
|FIN;

|VARIABLES;
     &enNum = 0;
     &eaSer = "";
     aAlfa = "";
     aParam = "";
|FIN;

|PROCESO goma0004;
     |SI aParam = "GES";
          |SI #4#2 ! "S"; |Y #4#2 ! "A"; |ACABA; |FINSI;
     |SINO;
          |SI #4#2 ! "M"; |Y #4#2 ! "A"; |ACABA; |FINSI;
     |FINSI;

     #referen@#0 = #4#0;
     #referen@#1 = #4#1;
     #referen@#2 = #4#2;
     |GRABA 020#referen@.n;
|FPRC;

|DEFBUCLE goma0004;
     #4#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, goma0004;
|FIN;

|PROCESO goma0005;
     |SI aParam = "GES";
          |SI #5#3 ! "S"; |Y #5#3 ! "A"; |ACABA; |FINSI;
     |SINO;
          |SI #5#3 ! "M"; |Y #5#3 ! "A"; |ACABA; |FINSI;
     |FINSI;

     #referen@#0 = #5#0;
     #referen@#1 = #5#1;
     #referen@#2 = #5#2;
     #referen@#3 = #5#3;
     |GRABA 020#referen@.n;
|FPRC;

|DEFBUCLE goma0005;
     #5#1;
     ;
     #0#0, "  ";
     #0#0, "zz";
     ;
     NULL, goma0005;
|FIN;

|PROCESO Consu66; |TIPO 66;
     |SI Campo = 0;
          |DDEF aAlfa;
          aAlfa = aAlfa + "goma0004";
          |CARGA_DEF aAlfa, referen@;
          |SI FSalida = 0;
               aAlfa = Usuario;
               |NOME_DAT #referen@#aAlfa#;
               |DELINDEX #referen@;
               |ABRE #referen@;
               |BUCLE goma0004;
               #referen@#0 = #0#0;
               |LEE 000#referen@.];
               |CONSULTA_CLAVE #1#referen@;
               |SI FSalida = 0;
                    #0#0 = #referen@#0; |PINTA #0#0;
               |SINO;
                    |ERROR;
               |FINSI;
               |CIERRA #referen@;
               |DESCARGA_DEF #referen@;
          |FINSI;
     |FINSI;
     |SI Campo = 1;
          |DDEF aAlfa;
          aAlfa = aAlfa + "goma0005";
          |CARGA_DEF aAlfa, referen@;
          |SI FSalida = 0;
               aAlfa = Usuario;
               |NOME_DAT #referen@#aAlfa#;
               |DELINDEX #referen@;
               |ABRE #referen@;
               |BUCLE goma0005;
               #referen@#0 = #0#0;
               #referen@#1 = #0#1;
               |LEE 000#referen@.];
               |CONSULTA_CLAVE #1#referen@;
               |SI FSalida = 0;
                    #0#0 = #referen@#0; |PINTA #0#0;
                    #0#1 = #referen@#1; |PINTA #0#1;
               |SINO;
                    |ERROR;
               |FINSI;
               |CIERRA #referen@;
               |DESCARGA_DEF #referen@;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Cheq; |TIPO 0;
     |SI FSalida = 2; |ACABA; |FINSI;

     |SI Campo = 0;
          |ABRE #4;
          #4#0 = #0#0;
          |LEE 000#4=;
          |SI FSalida ! 0;
               |MENAV "0000No exite negocio...";
               |ERROR;
          |SINO;
               |SI aParam = "GES";
                    |SI #4#2 ! "S"; |Y #4#2 ! "A";
                         |MENAV "0000Negocio no permitido...";
                         |ERROR;
                    |FINSI;
               |SINO;
                    |SI #4#2 ! "M"; |Y #4#2 ! "A";
                         |MENAV "0000Negocio no permitido...";
                         |ERROR;
                    |FINSI;
               |FINSI;
          |FINSI;
          |CIERRA #4;
     |FINSI;
     |SI Campo = 1;
          |ABRE #5;
          #5#0 = #0#0;
          #5#1 = #0#1;
          |LEE 000#5=;
          |SI FSalida ! 0;
               |MENAV "0000No exite negocio...";
               |ERROR;
          |SINO;
               |SI aParam = "GES";
                    |SI #5#3 ! "S"; |Y #5#3 ! "A";
                         |MENAV "0000Negocio no permitido...";
                         |ERROR;
                    |FINSI;
               |SINO;
                    |SI #5#3 ! "M"; |Y #5#3 ! "A";
                         |MENAV "0000Negocio no permitido...";
                         |ERROR;
                    |FINSI;
               |FINSI;
          |FINSI;
          |CIERRA #5;
     |FINSI;
     |SI Campo = 2;
          |ABRE #6;
          #6#0 = #0#2;
          |LEE 000#6=;
          |SI FSalida ! 0;
               |MENAV "0000No exite ejercicio...";
               |ERROR;
          |FINSI;
          |CIERRA #6;
     |FINSI;
|FPRC;

|PROCESO Na; |TIPO 12;
|FPRC;

|PROGRAMA;
     |PINPA #0#0;

     aParam = PARAMETRO;

     |C_P #0#0, 1, enNum;
     enNum = enNum + 1;
     |C_P #0#1, 1, enNum;
     enNum = enNum + 2;
     |C_P #0#2, 1, enNum;

     |ENDATOS #1#0;
     |SI FSalida = 0;
          eaSer = #0#0 + #0#1 + #0#2;
     |SINO;
          eaSer = "";
     |FINSI;
|FPRO;
