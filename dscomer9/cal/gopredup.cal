|FICHEROS;
     gopredup #0;
     gopre001 #1;
     gopre002 #2;
     gopre003 #3; ||,MANTE;
     gopre004 #4; ||,MANTE;
     agifa027 #8;
     agifa324 #9;
     gomedici #10; ||,MANTE;

     gopredu1 #11;

     gopredu2 #12;
     gopredu3 #13;
     gopredu4 #14;
     godupmed #15;
     goduprec #16;
     goduprel #17;
     godeprec #18;
     godeprel #19;
     gopre021 #21;
     gopre022 #22;
     gopre024 #24;
     gopre025 #25;
     guerm039 #39;       ||Historico Cambios
     goparame #100;
|FIN;
-----------------------------------------------------------------------------
|VARIABLES;
     nError = 0;
     nCamposTmp = 0;
     nCamposOrg = 0;
     &Tempo = "";
     aTmp11 = "";
     aTmp12 = "";
     aTmp13 = "";
     aTmp14 = "";
     aTmp16 = "";
     aTmp17 = "";

     {-1}Menu = "";
     Menu1 = "2400";
     Menu2 = "1";
     Menu3 = "Contador:  ";
     Menu4 = "AM";
     Menu5 = " Automatico ";
     Menu6 = " Manual ";

     &enCambiArti = 0;
     &eaSerOrg = "";
     &enNumOrg = 0;
     &eaSerDes = "";
     &enNumDes = 0;

     aAlfa          = "";
     nCampo         = 0;
     &enModo        = 0;
     &eaTipoD       = "";
     dVacio         = "                    ";
     hVacio         = "zzzzzzzzzzzzzzzzzzzz";
     aSer           = "";
     aNum           = "";
     nNume          = 0;
     nCopia         = 0;
     &cCodMonBase   = "";
     &cCodMonTrab   = "";
     &cCodMonDe     = "";
     &cCodMonA      = "";
     &cCodMonConv   = "";
     &cCodMonActu   = "";
     &cDesMonBase   = "";
     &cDesMonTrab   = "";

     &nDeci_PBase   = 0;
     &nDeci_TBase   = 0;
     &nDeci_PTrab   = 0;
     &nDeci_TTrab   = 0;
     &nDeci_TotVis  = 0;
     &nEurComTrab   = 0;
     &nEurComBase   = 0;
     &nEurVenTrab   = 0;
     &nEurVenBase   = 0;
     &nPreComTrab   = 0;
     &nPreComBase   = 0;
     &nPreVenTrab   = 0;
     &nPreVenBase   = 0;
     &nPrecioComp   = 0;
     &nPrecioVent   = 0;
     &nDeci_Medi    = 0;
     &nDeci_Meda    = 0;
     &nDeci_Incr    = 0;


     nEuroExis      = 0;
     nEuroNuev      = 0;
     nPrecio        = 0;
     nImporte       = 0;
     nConta         = 0;

     cConta         = "";
|FIN;
-----------------------------------------------------------------------------
|PROCESO Copia25;
     #25#21 = #0#3;
     #25#22 = #0#4;
     |GRABA 020#25n;
|FPRC;

|DEFBUCLE Copia25;
     #25#1;
     ;
     #0#1, #0#2, dVacio, dVacio, 000, dVacio, 001;
     #0#1, #0#2, hVacio, hVacio, 999, hVacio, 999;
     ;
     NULL, Copia25;
|FIN;

|PROCESO Copia24;
     #24#35 = #0#3;
     #24#36 = #0#4;
     |GRABA 020#24n;
|FPRC;

|DEFBUCLE Copia24;
     #24#1;
     ;
     #0#1, #0#2, dVacio, dVacio, 000, dVacio;
     #0#1, #0#2, hVacio, hVacio, 999, hVacio;
     ;
     NULL, Copia24;
|FIN;

|PROCESO Copia22;
     #22#0 = #0#3;
     #22#1 = #0#4;
     |GRABA 020#22n;
|FPRC;

|DEFBUCLE Copia22;
     #22#1;
     ;
     #0#1, #0#2, 001, 001;
     #0#1, #0#2, 999, 999;
     ;
     NULL, Copia22;
|FIN;

|PROCESO Copia21;
     #21#0 = #0#3;
     #21#1 = #0#4;
     |GRABA 020#21n;
|FPRC;

|DEFBUCLE Copia21;
     #21#1;
     ;
     #0#1, #0#2, 001;
     #0#1, #0#2, 999;
     ;
     NULL, Copia21;
|FIN;

|PROCESO NoRepe; |TIPO 0;
     |ABRE #1;
     #1#0 = #0#3;
     #1#1 = #0#4;
     |LEE 000#1=;
     |SI FSalida = 0;
          |MENAV "0000Presupuesto existente...";
          |ERROR;
     |FINSI;
     |CIERRA #1;
|FPRC;

|PROCESO ConDup; |TIPO 7;
     |C_M #0#4, 1, "S";
     |MENU Menu;
     |SI FSalida = 1;
          |C_M #0#4, 1, "N";
          |ABRE #8;
          #8#0 = "vfacprof";
          #8#2 = #0#3;
          |LEE 101#8=;

          |SI FSalida = 0;
               #8#1 = #8#1 + 1;
               nConta = #8#1;
               |GRABA 021#8a;
          |SINO;
               nConta = 1;
               #8#1 = 1;
               |GRABA 021#8n;
          |FINSI;

          cConta = nConta;
          cConta = ("000000" + cConta) % -106;
          #0#4 = cConta;
          |PINTA #0#4;
          |LIBERA #8;
          |CIERRA #8;
     |FINSI;
|FPRC;
------------------------------------------------------------------------------
|PROCESO GrabDesc;
     #14#0 = #0#3;
     #14#1 = #0#4;

     aAlfa = "|NC";
     aAlfa = #4#aAlfa#;
     nCampo = aAlfa;
     nCampo = nCampo - 1;
     |PARA nConta = 2; |SI nConta [ nCampo; |HACIENDO nConta= nConta+1;
          #14nConta = #4nConta;
     |SIGUE;

     |GRABA 020#14c;
     #0#9 = "COPIANDO DESCOMPOSICION";
     |PINTA #0#9;
|FPRC;
------------------------------------------------------------------------------
|PROCESO CambiaArti;
     |ABRE #39;
     #39#0 = #4#5;
     |LEE 000#39=;
     |SI FSalida = 0;
          #4#5 = #39#1;
          #4#6 = #39#2;
     |FINSI;
     |CIERRA #39;
|FPRC;

|PROCESO GrabDupDesc;
     nPrecio = #14#9 / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #14#9 = nPrecio;                   ||PRECIO VENTA.
     nPrecio = #14#10 / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #14#10 = nPrecio;                  ||PRECIO COSTE.
     nPrecio = #14#11 / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #14#11 = nPrecio;                  ||IMPORTE VENTA.
     nPrecio = #14#12 / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #14#12 = nPrecio;                  ||IMPORTE COSTE.

     aAlfa = "|NC";
     aAlfa = #14#aAlfa#;
     nCampo = aAlfa;
     nCampo = nCampo - 1;
     |PARA nConta = 0; |SI nConta [ nCampo; |HACIENDO nConta= nConta+1;
          #4nConta = #14nConta;
     |SIGUE;
     |SI enCambiArti = 1; || Lo envia el goprepec
          |HAZ CambiaArti;
     |FINSI;
     |GRABA 020#4c;
     #0#9 = "GRABANDO DESCOMPOSICION";
     |PINTA #0#9;
|FPRC;
------------------------------------------------------------------------------
|DEFBUCLE EjecDesc;
     #4#1;
     ;
     #3#0, #3#1, #3#2, #3#4,   1;
     #3#0, #3#1, #3#2, #3#4, 999;
     ;
     NULL, GrabDesc;
|FIN;
------------------------------------------------------------------------------
|DEFBUCLE EjecDupDesc;
     #14#1;
     ;
     #13#0, #13#1, #13#2, #13#4,   1;
     #13#0, #13#1, #13#2, #13#4, 999;
     ;
     NULL, GrabDupDesc;
|FIN;
------------------------------------------------------------------------------
|PROCESO GrabPart;
     |BUCLE EjecDesc;
     #13#0 = #0#3;
     #13#1 = #0#4;

     aAlfa = "|NC";
     aAlfa = #3#aAlfa#;
     nCampo = aAlfa;
     nCampo = nCampo - 1;
     |PARA nConta = 2; |SI nConta [ nCampo; |HACIENDO nConta= nConta+1;
          #13nConta = #3nConta;
     |SIGUE;
     |GRABA 020#13c;
     #0#9 = "COPIANDO PARTIDA";
     |PINTA #0#9;
|FPRC;
------------------------------------------------------------------------------
|PROCESO DupliMedi;
     |DDEFECTO #15;
     #15#0 = #0#3;            || Serie presupuesto nuevo
     #15#1 = #0#4;            || Numero presupuesto nuevo
     #15#2 = #10#2;           || Capitulo
     #15#3 = #10#3;           || Partida
     #15#4 = #10#4;           || Linea
     |LEE 101#15=;

     |SI FSalida ! 0;
          #15#5 = #10#5;      || Unidades
          #15#6 = #10#6;      || Largo
          #15#7 = #10#7;      || Ancho
          #15#8 = #10#8;      || Alto
          #15#9 = #10#9;      || Parcial
          |GRABA 020#15n;

          aAlfa = "|NC";
          aAlfa = #15#aAlfa#;
          nCampo = aAlfa;
          nCampo = nCampo - 1;
          |PARA nConta = 0; |SI nConta [ nCampo; |HACIENDO nConta = nConta + 1;
               #10nConta = #15nConta;
          |SIGUE;

          |GRABA 020#10n;
          |LIBERA #10;
     |FINSI;
     |LIBERA #15;
|FPRC;
------------------------------------------------------------------------------
|DEFBUCLE Mediciones;
     #10#1;
     ;
     #0#1,#0#2,#3#2,#3#4,1;
     #0#1,#0#2,#3#2,#3#4,999;
     be;
     NULL,DupliMedi;
|FIN;
------------------------------------------------------------------------------
|PROCESO GrabDupPart;
     |BUCLE EjecDupDesc;
     nPrecio = #13#8 / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #13#8 = nPrecio;                   ||PRECIO VENTA.
     nPrecio = #13#9  / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #13#9  = nPrecio;                  ||PRECIO COSTE.
     nPrecio = #13#10 / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #13#10 = nPrecio;                  ||IMPORTE VENTA.
     nPrecio = #13#11 / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #13#11 = nPrecio;                  ||IMPORTE COSTE.

     aAlfa = "|NC";
     aAlfa = #13#aAlfa#;
     nCampo = aAlfa;
     nCampo = nCampo - 1;
     |PARA nConta = 0; |SI nConta [ nCampo; |HACIENDO nConta= nConta+1;
          #3nConta = #13nConta;
     |SIGUE;
     |GRABA 020#3c;
     #0#9 = "GRABANDO PARTIDA";
     |PINTA #0#9;
     |BUCLE Mediciones;
|FPRC;
------------------------------------------------------------------------------
|DEFBUCLE EjecPart;
     #3#1;
     ;
     #2#0, #2#1, #2#12,   1;
     #2#0, #2#1, #2#12, 999;
     ;
     NULL, GrabPart;
|FIN;
------------------------------------------------------------------------------
|DEFBUCLE EjecDupPart;
     #13#1;
     ;
     #12#0, #12#1, #12#12,   1;
     #12#0, #12#1, #12#12, 999;
     ;
     NULL, GrabDupPart;
|FIN;
------------------------------------------------------------------------------
|PROCESO GrabCapi;
     |BUCLE EjecPart;
     #12#0 = #0#3;
     #12#1 = #0#4;

     aAlfa = "|NC";
     aAlfa = #2#aAlfa#;
     nCampo = aAlfa;
     nCampo = nCampo - 1;
     |PARA nConta = 2; |SI nConta [ nCampo; |HACIENDO nConta= nConta+1;
          #12nConta = #2nConta;
     |SIGUE;
     |GRABA 020#12c;
     #0#9 = "COPIANDO CAPITULO";
     |PINTA #0#9;
|FPRC;
------------------------------------------------------------------------------
|PROCESO GrabDupCapi;
     |BUCLE EjecDupPart;
     nPrecio = #12#7 / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #12#7 = nPrecio;                   ||PRECIO VENTA.
     nPrecio = #12#8  / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #12#8  = nPrecio;                  ||PRECIO COSTE.
     nPrecio = #12#9  / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #12#9  = nPrecio;                  ||IMPORTE VENTA.
     nPrecio = #12#10 / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #12#10 = nPrecio;                  ||IMPORTE COSTE.

     aAlfa = "|NC";
     aAlfa = #12#aAlfa#;
     nCampo = aAlfa;
     nCampo = nCampo - 1;
     |PARA nConta = 0; |SI nConta [ nCampo; |HACIENDO nConta= nConta+1;
          #2nConta = #12nConta;
     |SIGUE;
     |GRABA 020#2c;
     #0#9 = "GRABANDO CAPITULO";
     |PINTA #0#9;
|FPRC;
------------------------------------------------------------------------------
|DEFBUCLE EjecDupCapi;
     #12#1;
     ;
     #11#0, #11#1,   1;
     #11#0, #11#1, 999;
     ;
     NULL, GrabDupCapi;
|FIN;
------------------------------------------------------------------------------
|PROCESO GrabDupPres;
     |BUCLE EjecDupCapi;
     |DDEFECTO #1;
     nPrecio = #11#5 / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #11#5 = nPrecio;                   ||PRECIO VENTA.
     nPrecio = #11#6  / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #11#6  = nPrecio;                  ||PRECIO COSTE.

     aAlfa = "|NC";
     aAlfa = #11#aAlfa#;
     nCampo = aAlfa;
     nCampo = nCampo - 1;
     |PARA nConta = 0; |SI nConta [ nCampo; |HACIENDO nConta= nConta+1;
          #1nConta = #11nConta;
          |SI nConta = 4;
               #1nConta = #0#13;
          |FINSI;
          |SI nConta = 7;
               #1nConta = #0#11;
          |FINSI;
          |SI nConta = 8;
               #1nConta = #0#14;
          |FINSI;
          |SI nConta = 15; |O nConta = 17;
               #1nConta = "       "
          |FINSI;
          |SI nConta = 16;
               #1nConta = 0
          |FINSI;
     |SIGUE;

     |SI #goparame#52 = "S";
        |SI #goparame#55 = "S"; |Y #0#4 ] #goparame#54; |Y #0#4 < #goparame#56;
           #1#15 = #11#15;
           #1#16 = #11#16;
           #1#17 = #11#17;
        |FINSI;
     |FINSI;
     #1#42 = #11#42;
     #1#43 = #11#43;
     #1#44 = #11#44;
     #1#45 = #11#45;
     #1#46 = #11#46;

     |GRABA 020#1c;
     #0#9 = "GRABANDO PRESUPUESTO";
     |PINTA #0#9;
|FPRC;
------------------------------------------------------------------------------
|DEFBUCLE EjecDupPres;
     #11#1;
     ;
     #0#3, #0#4;
     #0#3, #0#4;
     ;
     NULL, GrabDupPres;
|FIN;
------------------------------------------------------------------------------
|PROCESO DesAmpLin;
     #19#1 = #0#3;
     #19#2 = #0#4;
     |GRABA 020#19n;
|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE DesAmpLin;
     #19#1;
     ;                                          ||Campos Extras.
     #18#0, #18#1, #18#2, #18#4,   1;
     #18#0, #18#1, #18#2, #18#4, 999;
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, DesAmpLin;
|FIN;
-------------------------------------------------------------------------------
|PROCESO DescAmpCab;
     |BUCLE DesAmpLin;
     #18#1 = #0#3;
     #18#2 = #0#4;
     |GRABA 020#18n;
|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE DescAmpCab;
     #18#1;
     ;                                          ||Campos Extras.
     "                    ", #0#1, #0#2, "                    ";
     "zzzzzzzzzzzzzzzzzzzz", #0#1, #0#2, "zzzzzzzzzzzzzzzzzzzz";
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, DescAmpCab;
|FIN;
-------------------------------------------------------------------------------
|PROCESO Duplica; |TIPO 3;
     |HAZ CreaTempo; aTmp11 = Tempo;
     |HAZ CreaTempo; aTmp12 = Tempo;
     |HAZ CreaTempo; aTmp13 = Tempo;
     |HAZ CreaTempo; aTmp14 = Tempo;
     |HAZ CreaTempo; aTmp16 = Tempo;
     |HAZ CreaTempo; aTmp17 = Tempo;

     |NOME_DAT #11 aTmp11; |DELINDEX #11;
     |NOME_DAT #12 aTmp12; |DELINDEX #12;
     |NOME_DAT #13 aTmp13; |DELINDEX #13;
     |NOME_DAT #14 aTmp14; |DELINDEX #14;
     |NOME_DAT #16 aTmp16; |DELINDEX #16;
     |NOME_DAT #17 aTmp17; |DELINDEX #17;

     |ABRE #1;
     |ABRE #2;
     |ABRE #3;
     |ABRE #4;
     |ABRE #10;
     |ABRE #11;
     |ABRE #12;
     |ABRE #13;
     |ABRE #14;
     |ABRE #15;
     |ABRE #16;
     |ABRE #17;
     #1#0 = #0#1;        ||Serie.
     #1#1 = #0#2;        ||Numero.
     |LEE 000#1=;
     |SI FSalida = 0;
          nDeci_Medi = #1#24;
          nDeci_Incr = #1#25;
          |BUCLELIN 0 GrabCapi #1;
          #11#0 = #0#3;
          #11#1 = #0#4;
          #11#2 = #0#5;
          #11#3 = #0#6;

          aAlfa = "|NC";
          aAlfa = #1#aAlfa#;
          nCampo = aAlfa;
          nCampo = nCampo - 1;
          |PARA nConta = 4; |SI nConta [ nCampo; |HACIENDO nConta= nConta+1;
               #11nConta = #1nConta;
          |SIGUE;
          |GRABA 020#11c;
          |BUCLE Copia21;
          |BUCLE Copia22;
          |BUCLE Copia24;
          |BUCLE Copia25;
     |FINSI;

     |BUCLE EjecDupPres;
     |BUCLE DescAmpCab;
     |CIERRA #1;
     |CIERRA #2;
     |CIERRA #3;
     |CIERRA #4;
     |CIERRA #11;
     |CIERRA #12;
     |CIERRA #13;
     |CIERRA #14;
     |CIERRA #15;
     |CIERRA #16;
     |CIERRA #17;

     |DELINDEX #11;
     |DELINDEX #12;
     |DELINDEX #13;
     |DELINDEX #14;
     |DELINDEX #16;
     |DELINDEX #17;
     Tempo = aTmp11; |HAZ BoraTempo;
     Tempo = aTmp12; |HAZ BoraTempo;
     Tempo = aTmp13; |HAZ BoraTempo;
     Tempo = aTmp14; |HAZ BoraTempo;
     Tempo = aTmp16; |HAZ BoraTempo;
     Tempo = aTmp17; |HAZ BoraTempo;
|FPRC;
------------------------------------------------------------------------------
|PROCESO MonedaS; |TIPO 0;
     |ABRE #9;
     #9#0 = #0#10;
     |LEE 000#9=;

     |SI FSalida = 0;
          nEuroExis = #9#2;        ||Valor Euro Existente.
     |FINSI;

     #9#0 = #0#11;
     |LEE 000#9=;

     |SI FSalida = 0;
          nEuroNuev = #9#2;        ||Valor Euro Nuevo.
          cCodMonTrab = #0#11;
          |HAZ MonBas;
     |FINSI;

     |SI #0#10 ! #0#11;
          |CONFI "0000SLA MONEDA DE TRABAJO ES DISTINTA.쮀EALIZAR CONVERSION?";

          |SI FSalida = -1;
               |PTEC 807;
          |FINSI;

     |FINSI;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Borra25;
     |BORRA 020#25a;
|FPRC;

|DEFBUCLE Borra25;
     #25#1;
     ;
     #0#3, #0#4, dVacio, dVacio, 000, dVacio, 001;
     #0#3, #0#4, hVacio, hVacio, 999, hVacio, 999;
     be;
     NULL, Borra25;
|FIN;

|PROCESO Borra24;
     |BORRA 020#24a;
|FPRC;

|DEFBUCLE Borra24;
     #24#1;
     ;
     #0#3, #0#4, dVacio, dVacio, 000, dVacio;
     #0#3, #0#4, hVacio, hVacio, 999, hVacio;
     be;
     NULL, Borra24;
|FIN;

|PROCESO Borra22;
     |BORRA 020#22a;
|FPRC;

|DEFBUCLE Borra22;
     #22#1;
     ;
     #0#3, #0#4, 001, 001;
     #0#3, #0#4, 999, 999;
     be;
     NULL, Borra22;
|FIN;

|PROCESO Borra21;
     |BORRA 020#21a;
|FPRC;

|DEFBUCLE Borra21;
     #21#1;
     ;
     #0#3, #0#4, 001;
     #0#3, #0#4, 999;
     be;
     NULL, Borra21;
|FIN;

|PROCESO Borra19;
     |BORRA 020#19a;
|FPRC;

|DEFBUCLE Borra19;
     #19#1;
     ;
     dVacio, #0#3, #0#4, dVacio, 001;
     hVacio, #0#3, #0#4, hVacio, 999;
     be;
     NULL, Borra19;
|FIN;

|PROCESO Borra18;
     |BORRA 020#18a;
|FPRC;

|DEFBUCLE Borra18;
     #18#1;
     ;
     dVacio, #0#3, #0#4, dVacio;
     hVacio, #0#3, #0#4, hVacio;
     be;
     NULL, Borra18;
|FIN;

|PROCESO Borra4;
     |BORRA 020#4a;
|FPRC;

|DEFBUCLE Borra4;
     #4#1;
     ;
     #0#3, #0#4, dVacio, dVacio, 001;
     #0#3, #0#4, hVacio, hVacio, 999;
     be;
     NULL, Borra4;
|FIN;

|PROCESO Borra3;
     |BORRA 020#3a;
|FPRC;

|DEFBUCLE Borra3;
     #3#1;
     ;
     #0#3, #0#4, dVacio, 001;
     #0#3, #0#4, hVacio, 999;
     be;
     NULL, Borra3;
|FIN;

|PROCESO Borra2;
     |BORRA 020#2a;
|FPRC;

|PROCESO Borra;
     |ABRE #1;
     #1#0 = #0#3;
     #1#1 = #0#4;
     |LEE 101#1=;
     |SI FSalida = 0;
          |BUCLELIN 0 Borra2 #1;
          |BORRA 020#1a;
     |FINSI;
     |CIERRA #1;

     |BUCLE Borra3;
     |BUCLE Borra4;
     |BUCLE Borra18;
     |BUCLE Borra19;
     |BUCLE Borra21;
     |BUCLE Borra22;
     |BUCLE Borra24;
     |BUCLE Borra25;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Tipo13; |TIPO 13;
     |SI #100#141 = "O";
          |ATRI R; |PINTA 622, "ORDEN ENTRADA "; |ATRI 0;
          |PINTA 812, "O.E............:";
     |FINSI;
|FPRC;

|PROGRAMA;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     aAlfa = "|NC";
     nCamposTmp = (A\(#14#aAlfa#)); nCamposOrg = (A\(#4#aAlfa#));
     |SI nCamposTmp ! nCamposOrg; nError = 1; |FINSI;
     nCamposTmp = (A\(#13#aAlfa#)); nCamposOrg = (A\(#3#aAlfa#));
     |SI nCamposTmp ! nCamposOrg; nError = 1; |FINSI;
     nCamposTmp = (A\(#10#aAlfa#)); nCamposOrg = (A\(#15#aAlfa#));
     |SI nCamposTmp ! nCamposOrg; nError = 1; |FINSI;
     nCamposTmp = (A\(#12#aAlfa#)); nCamposOrg = (A\(#2#aAlfa#));
     |SI nCamposTmp ! nCamposOrg; nError = 1; |FINSI;
     nCamposTmp = (A\(#11#aAlfa#)); nCamposOrg = (A\(#1#aAlfa#));
     |SI nCamposTmp ! nCamposOrg; nError = 1; |FINSI;

     |SI nError ! 0;
          |MENAV "0000Error estructura campos presupuesto, consulte con su distribuidor";
          |MENAV "0000NO SE PUEDE COPIAR EL PRESUPUESTO";
          |ACABA;
     |FINSI;

     |SI PARAMETRO = "";
          |MANTE #0;
          |ACABA;
     |FINSI;
     |SI eaSerOrg ! "";     || LLAMADO POR 'guerz039'
          |ABRE #1;
          #1#0 = eaSerOrg;
          #1#1 = enNumOrg;
          |LEE 020#1=;
          |SI FSalida = 0;
               #0#1 = eaSerOrg;
               #0#2 = enNumOrg;
               #0#3 = eaSerDes;
               #0#4 = enNumDes;
               #0#7 = #1#2; #0#5 = #0#7;
               #0#8 = #1#3; #0#6 = #0#8;
               #0#12 = #1#4; #0#13 = #0#12;
               #0#10 = #1#7; #0#11 = #0#10;
               #0#15 = #1#8; #0#14 = #0#15;
               |HAZ Duplica;
          |FINSI;
          |CIERRA #1;
          |ACABA;
     |FINSI;

                         || LLAMADO POR 'gomantho'
     |HAZ MonedaS;
     nDeci_Meda = #100#115;

     aSer = PARAMETRO % 105;
     aNum = PARAMETRO % -106;
     nNume = aNum;
     |SI #100#55 = "S"; |Y eaTipoD = "E";
          nNume = aNum;
          nNume = nNume + #100#54;
          #0#1 = aSer; #0#2 = aNum;

          |ABRE #1;
          #1#0 = aSer;
          #1#1 = aNum;
          |LEE 000#1=;
          |CIERRA #1;

          #0#7 = #1#2;   #0#8 = #1#3;
          #0#12 = #1#4;  #0#10 = #1#7;
          #0#15 = #1#8;

          #0#3 = #0#1;   #0#4 = nNume;
          #0#5 = #0#7;   #0#6 = #0#8;
          #0#13 = #0#12; #0#11 = #0#10;
          #0#14 = #0#15; #0#5 = #0#7;

          |HAZ Borra;
          |SI enModo = 1; |HAZ Duplica; |FINSI;
     |FINSI;

     |SI #100#57 = "S"; |Y eaTipoD = "C";
          nNume = aNum; nNume = nNume + #100#56;
          #0#1 = aSer; #0#2 = aNum;

          |ABRE #1;
          #1#0 = aSer;
          #1#1 = aNum;
          |LEE 000#1=;
          |CIERRA #1;

          #0#7 = #1#2;   #0#8 = #1#3;
          #0#12 = #1#4;  #0#10 = #1#7;
          #0#15 = #1#8;

          #0#3 = #0#1;   #0#4 = nNume;
          #0#5 = #0#7;   #0#6 = #0#8;
          #0#13 = #0#12; #0#11 = #0#10;
          #0#14 = #0#15; #0#5 = #0#7;

          |HAZ Borra;
          |SI enModo = 1; |HAZ Duplica; |FINSI;
     |FINSI;
|FPRO;
