|FICHEROS;
     golis023 #0;
     gopartia #1;
     gomantho #2;
     goparame #10;
     agifa019 #19;
     guerw047 #47; || Tmp
     guerw050 #50; || Tmp.Detalle
     agifa069 #69; || F.Directas Lin
     agifa077 #77; || Alb Com
     agifa079 #79; || Fac Com
     agifa084 #84; || F.Directas
     agifa724 #724;|| Ctas
|FIN;

|CAMPOS;
     #10#64 GASTOS;
     #10#65 INGRESOS;
|FIN;

|VARIABLES;
     &enSw = 0;
     &eaTitulo = "";

     nContador = 0;

     aColAnt  = "";
     fFecha = @;
     nHay = 0;
     nPrimero = 0;
     aColumna = "";
     aAlfa  = "";
     aAlfa1 = "";
     aConta = "";
     aCta = "";
     nVale = 0;
     aIniArti = "";
|FIN;

|PROCESO Detalle;
     aAlfa = "     Imprimiendo detalle (" + #50#0 + "." + #50#1 + "." + #50#2 + "." + #50#3 + "." + #50#19 + ")";
     |MENSA aAlfa;
/*
     |SI nPrimero = 1;
        enSw = 2; |PRINT; nPrimero = 0;
     |FINSI;

     enSw = 1; |PRINT; enSw = 0;
*/
     |SI aColAnt ! #50#19;
        |SI #50#19 = "1"; eaTitulo = "Materiales y Gastos Contabilizados"; |FINSI;
        |SI #50#19 = "2"; eaTitulo = "Partes de trabajo                 "; |FINSI;
        |SI #50#19 = "3"; eaTitulo = "Materiales por contabilizar       "; |FINSI;
        |SI #50#19 = "4"; eaTitulo = "Ingresos contabilizados           "; |FINSI;
        |SI #50#19 = "5"; eaTitulo = "Ingresos sin contabilizar         "; |FINSI;
        |SI #50#19 = "6"; eaTitulo = "Ingresos anteriores               "; |FINSI;
        |SI #50#19 = "7"; eaTitulo = "Gastos anteriores                 "; |FINSI;
        enSw = 2; |PRINT;
        aColAnt = #50#19;
     |FINSI;
     enSw = 1; |PRINT; enSw = 0;
|FPRC;

|DEFBUCLE Detalle;
#50#1;
;
#47#0, #47#2, #47#4, " ", 0000000000;
#47#0, #47#2, #47#4, "z", 9999999999;
;
NULL,Detalle;
|FIN;

|PROCESO Tmp;
     aAlfa = "     Imprimiendo subcabecera (" + #47#0 + "." + #47#2 + "." + #47#4 + ")";
     |MENSA aAlfa;

     |PRINT; nHay = 1;
/*
     nPrimero = 1;
     aColumna = "1"; eaTitulo = "Materiales y Gastos Contabilizados"; |BUCLE Detalle;
     nPrimero = 1;
     aColumna = "2"; eaTitulo = "Partes de trabajo                 "; |BUCLE Detalle;
     nPrimero = 1;
     aColumna = "3"; eaTitulo = "Materiales por contabilizar       "; |BUCLE Detalle;
     nPrimero = 1;
     aColumna = "4"; eaTitulo = "Ingresos contabilizados           "; |BUCLE Detalle;
     nPrimero = 1;
     aColumna = "5"; eaTitulo = "Ingresos sin contabilizar         "; |BUCLE Detalle;
     nPrimero = 1;
     aColumna = "6"; eaTitulo = "Ingresos anteriores               "; |BUCLE Detalle;
     nPrimero = 1;
     aColumna = "7"; eaTitulo = "Gastos anteriores                 "; |BUCLE Detalle;
*/
     aColAnt = "";
     |BUCLE Detalle;
|FPRC;

|DEFBUCLE Tmp;
     #47#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp;
|FIN;
/********************************
|PROCESO agifa059;
     aCta = INGRESOS;
     #724#0 = #69#2;
     |LEE 000#724=;
     |SI FSalida = 0;
          aCta = #724#2; |QBF aCta;
     |FINSI;
     |SI aCta = ""; aCta = INGRESOS; |FINSI;

     |DDEFECTO #19;
     #19#0 = #69#2;
     |LEE 000#19=;

     |DDEFECTO #47;
     |SI #0#6 = "D";
          #47#0 = #2#0;
          #47#1 = #2#29;
          #47#2 = #2#30;
          #47#3 = #2#31;
     |FINSI;
     #47#4 = aCta;
     #47#5 = #19#1;
     |LEE 101#47=;
     |SI FSalida ! 0; |GRABA 020#47b; |FINSI;
     |SI #84#39 = "S";
          aColumna = "4";
          #47#9 = #47#9 + #69#9;
     |SINO;
          aColumna = "5";
          #47#10 = #47#10 + #69#9;
     |FINSI;
     |GRABA 020#47a;
     |LIBERA #47;
|FPRC;
*****************************************/

|PROCESO agifa084;
     aAlfa = "    Procesando factura directa " + #agifa084#48 + "/" #agifa084#0;
     |MENSA aAlfa;

     aAlfa = #84#87;
     aAlfa = aAlfa % 105;
     |SI aAlfa < #0#0; |O aAlfa > #0#1;
          |ERROR; |ACABA;
     |FINSI;

     |SI #0#6 = "D";
          #2#0 = aAlfa;
          |LEE 000#2];
          |SI FSalida ! 0; |O #2#0 ! aAlfa;
                    |O #2#1 < #0#2; |O #2#1 > #0#3;
               |ERROR; |ACABA;
          |FINSI;
     |FINSI;

     aCta = INGRESOS;
     |DDEFECTO #47;
     |SI #0#6 = "D";
          #47#0 = #2#0;
          #47#1 = #2#29;
          #47#2 = #2#30;
          #47#3 = #2#31;
     |FINSI;
     #47#4 = aCta;
     #47#5 = "";
     |LEE 101#47=;
     |SI FSalida ! 0; |GRABA 020#47b; |FINSI;
     |SI #84#39 = "S";
          aColumna = "4";
          #47#9 = #47#9 + #84#16 + #84#19 + #84#22 + #84#42 + #84#45 + #84#28;
     |SINO;
          aColumna = "5";
          #47#10 = #47#10 + #84#16 + #84#19 + #84#22 + #84#42 + #84#45 + #84#28;
     |FINSI;
     |GRABA 020#47a;
     |LIBERA #47;

     nContador = 1;
     |DDEFECTO #50;
     #50#0  = #47#0;
     #50#1  = #47#2;
     #50#2  = #47#4;
     #50#19 = aColumna;
     #50#3  = 9999999999;
     |LEE 000#50];
     |SI FSalida = 0;
        |SI #50#0 = #47#0; |Y #50#1 = #47#2; |Y #50#2 = #47#4; |Y #50#19 = aColumna;
           nContador = 1;
        |SINO;
           |LEE 000#50a;
           |SI FSalida = 0;
              |SI #50#0 = #47#0; |Y #50#1 = #47#2; |Y #50#2 = #47#4; |Y #50#19 = aColumna;
                 nContador = #50#3 + 1;
              |SINO;
                 nContador = 1;
              |FINSI;
           |SINO;
              nContador = 1;
           |FINSI;
        |FINSI;
     |SINO;
        |LEE 000#50u;
        |SI FSalida = 0;
           |SI #50#0 = #47#0; |Y #50#1 = #47#2; |Y #50#2 = #47#4; |Y #50#19 = aColumna;
              nContador = #50#3 + 1;
           |SINO;
              nContador = 1;
           |FINSI;
        |SINO;
           nContador = 1;
        |FINSI;
     |FINSI;

     |DDEFECTO #50;
     #50#0  = #47#0;
     #50#1  = #47#2;
     #50#2  = #47#4;
     #50#3  = nContador;
     #50#19 = aColumna;
     #50#20 = #agifa084#48;
     #50#21 = #agifa084#0;
     #50#22 = #agifa084#1;
     #50#23 = #agifa084#87;
     #50#24 = #agifa084#3;
     #50#25 = #agifa084#4;
     #50#26 = #84#16 + #84#19 + #84#22 + #84#42 + #84#45 + #84#28;
     |GRABA 020#50n;
|FPRC;

|DEFBUCLE agifa084;
     #84#4;
     ;
     "     ", #0#4, 000001;
     "zzzzz", #0#5, 999999;
     ;
     NULL, agifa084;
|FIN;

|PROCESO gopartia;
     aAlfa = "    Procesando fichero 'gopartia' (" + #gopartia#34 + "." + #gopartia#4 + ".";
     aAlfa = aAlfa + #gopartia#5 + "." + #gopartia#6 + "." + #gopartia#7 + ")";
     |MENSA aAlfa;

     aCta = GASTOS;
     #724#0 = #1#20;
     |LEE 000#724=;
     |SI FSalida = 0;
          aCta = #724#3;
     |FINSI;
     |SI aCta = ""; aCta = GASTOS; |FINSI;

     |DDEFECTO #19;
     #19#0 = #1#20;
     |LEE 000#19=;

     |DDEFECTO #2;
     #2#0 = #1#2;
     #2#1 = #1#3;
     |LEE 000#2=;

     nVale = 0;
     aConta = "N";
     fFecha = #1#28;
     |SI #1#34 = "M" ; |O #1#34 = "C"; |O #1#34 = "S";
          nVale = 1;
          |DDEFECTO #77;
          #77#50 = #1#4;
          #77#0 = #1#5;
          |LEE 000#77=;
          |SI FSalida = 0; |Y #77#38 = "S";
               |DDEFECTO #79;
               #79#66 = #77#51;
               #79#0 = #77#39;
               |LEE 000#79=;
               |SI FSalida = 0;
                    aConta = #79#48;
                    fFecha = #79#1;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI #1#34 = "A";
          nVale = 1;
          |DDEFECTO #77;
          #77#50 = #1#53;
          #77#0 = #1#54;
          |LEE 000#77=;
          |SI FSalida = 0; |Y #77#38 = "S";
               |DDEFECTO #79;
               #79#66 = #77#51;
               #79#0 = #77#39;
               |LEE 000#79=;
               |SI FSalida = 0;
                    fFecha = #79#1;
                    |SI fFecha < #0#4; |O fFecha > #0#5;
                       aConta = "N";
                    |SINO;
                       aConta = #79#48;
                    |FINSI;
               |FINSI;
          |SINO;
             |SI #1#53 = "     "; |Y #1#54 = 000000;
                fFecha = #1#28; aConta = "S";
             |FINSI;
          |FINSI;
     |FINSI;
     |SI #1#34 = "T"; nVale = 1; |FINSI;

     |SI fFecha < #0#4; |O fFecha > #0#5;
          |ACABA;
     |FINSI;

     aIniArti = #1#20 % 101;
     |SI #1#34 = "R";
          |SI aIniArti = "6"; |O aIniArti = "7";
               nVale = 1;
          |FINSI;
     |FINSI;

     |SI nVale = 0; |ACABA; |FINSI;

     |DDEFECTO #47;
     |SI #0#6 = "D";
          #47#0 = #2#0;
          #47#1 = #2#29;
          #47#2 = #2#30;
          #47#3 = #2#31;
     |FINSI;
     #47#4 = aCta;
     #47#5 = #19#1;
     |LEE 101#47=;
     |SI FSalida ! 0; |GRABA 020#47b; |FINSI;

     |SI #1#34 = "R";
          |SI aIniArti = "7";
               aColumna = "6";
               #47#11 = #47#11 + #1#14;
          |SINO;
               aColumna = "7";
               #47#12 = #47#12 + #1#14;
          |FINSI;
     |SINO;
          |SI #1#34 = "T";
               aColumna = "2";
               #47#7 = #47#7 + #1#14;
          |SINO;
               |SI aConta = "S";
                    aColumna = "1";
                    #47#6 = #47#6 + #1#14;
               |SINO;
                    aColumna = "3";
                    #47#8 = #47#8 + #1#14;
               |FINSI;
          |FINSI;
     |FINSI;

     |GRABA 020#47a;
     |LIBERA #47;

     nContador = 1;
     |DDEFECTO #50;
     #50#0  = #47#0;
     #50#1  = #47#2;
     #50#2  = #47#4;
     #50#19 = aColumna;
     #50#3  = 9999999999;
     |LEE 000#50];
     |SI FSalida = 0;
        |SI #50#0 = #47#0; |Y #50#1 = #47#2; |Y #50#2 = #47#4; |Y #50#19 = aColumna;
           nContador = 1;
        |SINO;
           |LEE 000#50a;
           |SI FSalida = 0;
              |SI #50#0 = #47#0; |Y #50#1 = #47#2; |Y #50#2 = #47#4; |Y #50#19 = aColumna;
                 nContador = #50#3 + 1;
              |SINO;
                 nContador = 1;
              |FINSI;
           |SINO;
              nContador = 1;
           |FINSI;
        |FINSI;
     |SINO;
        |LEE 000#50u;
        |SI FSalida = 0;
           |SI #50#0 = #47#0; |Y #50#1 = #47#2; |Y #50#2 = #47#4; |Y #50#19 = aColumna;
              nContador = #50#3 + 1;
           |SINO;
              nContador = 1;
           |FINSI;
        |SINO;
           nContador = 1;
        |FINSI;
     |FINSI;

     |DDEFECTO #50;
     #50#0  = #47#0;
     #50#1  = #47#2;
     #50#2  = #47#4;
     #50#3  = nContador;
     #50#4  = #gopartia#2;
     #50#5  = #gopartia#3;
     #50#6  = #gopartia#34;
     #50#7  = #gopartia#4;
     #50#8  = #gopartia#5;
     #50#9  = #gopartia#6;
     #50#10 = #gopartia#28;
     #50#11 = #gopartia#20;
     #50#12 = #gopartia#30;
     #50#13 = #gopartia#10;
     #50#14 = #gopartia#41;
     #50#15 = #gopartia#14;
     #50#16 = #gopartia#53;
     #50#17 = #gopartia#54;
     #50#18 = #gopartia#55;
     #50#19 = aColumna;
     |GRABA 020#50n;
|FPRC;

|DEFBUCLE gopartia;
     #1#3;
     ;
     #0#0, #0#2, "     ", 000001, " ", "                    ";
     #0#1, #0#3, "zzzzz", 999999, "z", "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, gopartia;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     aAlfa = Usuario;
     aAlfa1 = "tm" + aAlfa; |NOME_DAT #47 aAlfa1;
     aAlfa1 = "td" + aAlfa; |NOME_DAT #50 aAlfa1;
     |DELINDEX #47; |DELINDEX #50;

     |ABRE #10; |LEE 000#10p; |CIERRA #10;

     |SI PARAMETRO = "";
        |IMPRE 0;
     |SINO;
        Impresora = "ibm80"; |IMPRE -1;
     |FINSI;
     |SI FSalida = 0;
          |SI #0#6 = "R";
               |INFOR "golisr23";
          |SINO;
               |INFOR "golisd23";
          |FINSI;
          |SI FSalida ! 0;
               |MENAV "0000No existe informe golisr23/golisd23";
          |SINO;
               |ABRE #19;
               |ABRE #47;
               |ABRE #50;
               |ABRE #724;
               |ABRE #77;
               |ABRE #79;
               |ABRE #2;
               |BUCLE gopartia;
               |BUCLE agifa084;
               |CIERRA #2;
               |CIERRA #79;
               |CIERRA #77;
               |CIERRA #724;
               |CIERRA #50;
               |CIERRA #47;
               |CIERRA #19;

               |BUCLE Tmp;
               |SI nHay ! 0; |PIEINF; |FINSI;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;

     |DELINDEX #47; |DELINDEX #50;
|FPRC;

|PROGRAMA;
  |SI PARAMETRO = "";
     |MANTE #0;
  |SINO;
     #0#4 = "01.01.1900"; #0#5 = "01.01.2999";
     |HAZ Tipo3;
  |FINSI;
|FPRO;
