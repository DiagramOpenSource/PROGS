|FICHEROS;
     abym0001 #0;
     abym0002 #2;
     dsm00003 #3,MANTE;
     abyw0005 #5,MANTE;
     agifa019 #19;
     agifa024 #24;
|FIN;

|VARIABLES;
     nInc = 0;
     &eaSerie = "";
     &enNumero = 0;
     nHay = 0;
     i = 0;
     aTipo = "";
     aAlfa = "";
     aMes = "";
     nConta = 0;
     nModo = 0;
     aSer = "";
     nCampo = 0;
 {-1}aUtil  = "";
     aUtil1 = "2400";
     aUtil2 = "1";
     aUtil3 = "";
     aUtil4 = "ARO";
     aUtil5 = "P.Asistencia";
     aUtil6 = "P.Revison";
     aUtil7 = "Observaciones";
|FIN;

|PROCESO ContaCont; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          aSer = #0#0;
          #0#1 = 999999;
          |LEE 000#0];
          |SI FSalida = 0;
               |LEE 000#0a;
          |SINO;
               |LEE 000#0u;
          |FINSI;
          |SI FSalida = 0; |Y #0#0 = aSer;
               nConta = #0#1+ 1;
          |SINO;
               nConta = 1;
          |FINSI;
          |DDEFECTO #0;
          #0#0 = aSer;
          #0#1 = nConta;
     |FINSI;
|FPRC;

|PROCESO MinD;
     #3#0 = #0nCampo;
     #3#1 = 1;
|FPRC;

|PROCESO MaxD;
     #3#0 = #0nCampo;
     #3#1 = 9999;
|FPRC;

|PROCESO DirEntr66; |TIPO 66;
     nCampo = Campo - 1;
     |ABRE #3;
     #3#0 = #0nCampo;
     #3#1 = #0Campo;
     |LEE 000#3];
     |CONSULTA_F_CLAVE #1#3, MinD, MaxD;
     |SI FSalida = 0;
          #0Campo = #3#1;
          |PINTA #0Campo;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO DirEntr0; |TIPO 0;
     |SI FSalida = 2; |ACABA; |FINSI;
     nCampo = Campo - 1;
     |ABRE #3;
     #3#0 = #0nCampo;
     #3#1 = #0Campo;
     |LEE 000#3=;
     |SI FSalida ! 0;
          |MENAV "0000No existe Direccion entrega...";
          |ERROR;
     |SINO;
          |HAZ PintaDirEntr;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO MesCalcu0; |TIPO 0;
     |HAZ MesCalcu7;
     |HAZ PintaMes;
|FPRC;

|PROCESO MesCalcu7; |TIPO 7;
     |SI #0#11 = "A";
          |C_M #0#12, 1, "N";
          #0#12 = 0; |PINTA #0#12;
     |SINO;
          |C_M #0#12, 1, "S";
     |FINSI;
|FPRC;


|PROCESO PintaMes; |TIPO 13;
     aMes = "          ";
     |SI #0#12 = 1; aMes = "Enero     "; |FINSI;
     |SI #0#12 = 2; aMes = "Febrero   "; |FINSI;
     |SI #0#12 = 3; aMes = "Marzo     "; |FINSI;
     |SI #0#12 = 4; aMes = "Abril     "; |FINSI;
     |SI #0#12 = 5; aMes = "Mayo      "; |FINSI;
     |SI #0#12 = 6; aMes = "Junio     "; |FINSI;
     |SI #0#12 = 7; aMes = "Julio     "; |FINSI;
     |SI #0#12 = 8; aMes = "Agosto    "; |FINSI;
     |SI #0#12 = 9; aMes = "Septiembre"; |FINSI;
     |SI #0#12 = 10;aMes = "Octubre   "; |FINSI;
     |SI #0#12 = 11;aMes = "Noviembre "; |FINSI;
     |SI #0#12 = 12;aMes = "Diciembre "; |FINSI;
     |ATRI I; |PINTA 1928, aMes; |ATRI 0;
     |HAZ PintaDirEntr;
     |C_A #19#1, 1, 37;
|FPRC;

|PROCESO PintaDirEntr;
     |DDEFECTO #3;
     |ABRE #3;
     #3#0 = #0#2;
     #3#1 = #0#3;
     |LEE 000#3=;
     |CIERRA #3;

     |PINTA 1015, #3#2;
     |PINTA 1115, #3#3;
     |PINTA 1215, #3#4; |PINTA 1217, #3#5; |PINTA 1234, #3#7;
|FPRC;

|PROCESO Partes;
     |PARA i = 0; |SI i [ 20; |HACIENDO i = i + 1;
          #5i = #2i;
     |SIGUE;
     |GRABA 020#5n;
     nHay = nHay + 1;
|FPRC;

|DEFBUCLE Partes;
     #2#1;
     ;
     #0#0, #0#1, aTipo, 0001;
     #0#0, #0#1, aTipo, 9999;
     ;
     NULL, Partes;
|FIN;

|PROCESO Min5;
     #5#0 = #0#0;
     #5#1 = #0#1;
     #5#2 = " ";
     #5#3 = 1;
|FPRC;

|PROCESO Max5;
     #5#0 = #0#0;
     #5#1 = #0#1;
     #5#2 = "z";
     #5#3 = 9999;
|FPRC;

|PROCESO TeclaF5; |TIPO 11;
     |SI FSalida = 13;
          |PUSHV 0501 2380;
          |ABRE #2;
          #2#0 = #5#0;
          #2#1 = #5#1;
          #2#2 = #5#2;
          #2#3 = #5#3;
          |LEE 020#2=;
          |SI FSalida = 0;
               |PINPA #0#2;
               |PINDA #0#2;
               |ENDATOS #4#2;
          |FINSI;
          |CIERRA #2;
          |POPV;
     |FINSI;
|FPRC;

|PROCESO Opcion; |TIPO 20;
     |SI FSalida = "OPCION";
          FSalida = "Opciones";
          |ACABA;
     |FINSI;
     |LEE 000#0=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |MENU aUtil;
     aUtil2 = FSalida;

     |SI aUtil2 = 3;
          FSalida = 13;
          |HAZ Observa;
          |ACABA;
     |FINSI;

     nHay = 0;
     aAlfa = Usuario;
     |NOME_DAT #5 aAlfa; |DELINDEX #5;
     |ABRE #5;
     |SI aUtil2 = 1;
          aTipo = "A";
          |BUCLE Partes;
          |SI nHay = 0;
               |MENAV "0000No hay registros...";
          |SINO;
               |PUSHV 0501 2380;
               |PINPA #0#5;
               |ATRI I; |PINTA 905, "PARTES ASISTENCIA"; |ATRI 0;
               |ENTLINEAL #1#5, 4, 4, 22, 0, Min5, Max5;
               |POPV;
          |FINSI;
     |FINSI;
     |SI aUtil2 = 2;
          aTipo = "R";
          |BUCLE Partes;
          |SI nHay = 0;
               |MENAV "0000No hay registros...";
          |SINO;
               |PUSHV 0501 2380;
               |PINPA #0#5;
               |ATRI I; |PINTA 905, "PARTES REVISION  "; |ATRI 0;
               |ENTLINEAL #1#5, 4, 4, 22, 0, Min5, Max5;
               |POPV;
          |FINSI;
     |FINSI;
     |CIERRA #5;
     |DELINDEX #5;
|FPRC;

|PROCESO Observa1;
     FSalida = 13;
     |HAZ Observa;
|FPRC;

|PROCESO Observa;
     |SI FSalida = 13;
          eaSerie = #0#0;
          enNumero = #0#1;
          |HAZ Observaciones;
     |FINSI;
|FPRC;

|PROCESO CalImporte; |TIPO 0;
     |SI #0Campo ! Contenido;
          |SI #0#11 = "M"; nInc = 12; |FINSI;
          |SI #0#11 = "B"; nInc = 6; |FINSI;
          |SI #0#11 = "T"; nInc = 4; |FINSI;
          |SI #0#11 = "S"; nInc = 2; |FINSI;
          |SI #0#11 = "A"; nInc = 1; |FINSI;
          #0#10 = #0#13 / nInc;
          |PINTA #0#10;
     |FINSI;
|FPRC;
