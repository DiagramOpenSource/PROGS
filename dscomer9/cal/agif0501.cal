          || EntregaCta

|FICHEROS;
     agis0002;
     agifa010;
     agifa324;
     agifa024 #24;
     dscamrec@ #600;
     agifa142;
     dsm00219 #219;
     dsm00289 #289;
|FIN;

|VARIABLES;
     aAlfa = "";
     &eaDivisa = "";
     aPath = "";
     aDef00 = "";
     aMensa = "";
     aTempo600 = "";
     &Tempo = "";
     &aCPath = "";
     &aCNome = "";
     Comodin = "";
     Divisa = "";
     CambioBase = "";
     CambioDiv = "";
     aSubProg = ":dscarter/dsrecibo";

     &TipoCta = "";
     &doc = 0;
     &ser = "";
|FIN;

|PROCESO EntregaCta501;
     |ABRE #agis0002;
     |DDEFECTO #agis0002;
     #agis0002#30 = "A";
     #agis0002#20 = #agifa010#52;
     #agis0002#17 = #agifa010#0;
     #agis0002#18 = 01;
     |LEE 000#agis0002.=;
     |SI FSalida ! 0;
        |DDEFECTO #agis0002;
        #agis0002#30 = "A";
        #agis0002#20 = #agifa010#52;
        #agis0002#17 = #agifa010#0;
        #agis0002#18 = 1;
        #agis0002#1  = 1;
        #agis0002#2  = #agifa010#3;
        #agis0002#3  = #agifa010#4;
        #agis0002#4  = #agifa024#29;
        #agis0002#7  = #agifa010#1;
        #agis0002#8  = #agifa010#1;
        #agis0002#9  = #agifa010#61;
        #agis0002#19 = #agifa010#52;
        #agis0002#24 = #agifa010#8;
        #agis0002#28 = #agifa024#16;
        |GRABA 020#agis0002.c;
     |FINSI;
     |CIERRA #agis0002;

     |DBASS aPath;
     aPath = aPath + "dscarter/";
     aDef00 = aPath + "def/dscamrec";
     |CARGA_DEF aDef00, dscamrec@;
     |SI FSalida ! 0;
        aMensa = "0000Error al cargar:" + aDef00;
        |MENAV aMensa;
        aDef00 = "";
     |SINO;
        |HAZ CreaTempo; aTempo600 = Tempo;
        |PATH_DAT #600 aPath; |NOME_DAT #600 aTempo600; |DELINDEX #600;
        |ABRE #600;
        aCPath = aPath; aCNome = aTempo600;
     |FINSI;
     |DFICE Comodin;
     Comodin = Comodin % -106;
     Comodin = Comodin % 0105;
     Divisa     = #agifa010#68;
     CambioBase = #agifa010#69;
     CambioDiv  = #agifa010#74;

     |ABRE #agifa324;
     #agifa324#0 = Divisa;
     |LEE 000#agifa324.=;
     |SI FSalida ! 0; |DDEFECTO #agifa324; |FINSI;
     |CIERRA #agifa324;

     |DDEFECTO #dscamrec@;
     #600#1  = #agifa010#52;||Serie
     #600#2  = #agifa010#0; ||Fact
     #600#3  = #agis0002#18;||N§ Rec
     #600#4  = #agis0002#8; ||F.V
     #600#5  = #agis0002#7; ||F.E
     #600#6  = #agis0002#12;||Cuenta Cli
     #600#7  = #agis0002#3; ||Nom Cli
     #600#8  = #agis0002#4; ||Nom Banco
     #600#9  = #agifa024#32;      ||Entidad
     #600#10 = #agifa024#33;      ||Sucursal
     #600#11 = #agifa024#31;      ||DC
     #600#12 = #agifa024#30;      ||Cuenta
     #600#13 = #agis0002#22;||Tipo Rec
     #600#15 = #agis0002#9; ||Importe
     #600#16 = #agis0002#15;||A aceptar
     #600#17 = #agis0002#6; ||Aceptado
     #600#18 = #agis0002#2; ||Cliente
     #600#21 = #agifa024#3; ||Zona
     #600#22 = 1;           ||Documento
     #600#25 = Comodin;     ||Empresa ges
     #600#27 = "V";         ||Tipo
     #600#28 = "A";         ||Ope
     #600#29 = #agifa324#0; ||Divisa
     #600#30 = #agifa324#1; ||Nombre
     #600#31 = CambioDiv;   ||Cambio Divisa
     #600#32 = CambioBase;  ||Cambio Base
     #600#33 = #agifa024#203;
     #600#34 = 0;
     #600#35 = "A";
     #600#36 = #agis0002#28;
     #600#38 = #agis0002#16;
     #600#39 = #agis0002#10;

     aAlfa = "|NC"; aAlfa = #600#aAlfa#;
     |SI aAlfa > 48;
          #600#48 = #agifa024#215;
          #600#49 = #agifa024#216;
     |FINSI;
     |SI aAlfa > 50;
          #600#50 = #agifa024#217;
          |ABRE #289;
          #289#0 = #agifa024#0;
          |LEE 000#289=;
          |SI FSalida ! 0; |DDEFECTO #289; |FINSI;
          |CIERRA #289;
          #600#51 = #289#1;
     |FINSI;

     |GRABA 020#600n;

     |SUB_EJECUTA_NP aSubProg;

     |SI aDef00 ! "";
          |CIERRA #600;
          |DELINDEX #600;
          |DESCARGA_DEF #dscamrec@;
     |FINSI;

     |SI #agifa142#86 ! "X";
         |CONFI "0000NDesea imprimir el recibo? ";
         |SI FSalida = 0;
              ser = #agifa010#52;
              doc = #agifa010#0;
              TipoCta = "A";
              eaDivisa = "";
              |HAZ ImpreACta;
         |FINSI;
     |FINSI;
|FPRC;
