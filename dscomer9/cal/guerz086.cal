Calculo llamado por aojentr3, aojentr5 del modulo 003774 de laboral

|FICHEROS;
     gomantho #0;
     gomantl1 #1;
     gosubcoc #2;
     gopre001 #6;
     goparame #10;
     guerm017 #17,MANTE;
     guerm018 #18;
|FIN;

|VARIABLES;
     &enSubCon = 0;
     &eaSerExp1 = "";
     &enNumExp1 = 0;
     &eaSerPre1 = "";
     &enNumPre1 = 0;

     aAlfa = "";
     aSerExp = "";
     nNumExp = "";
     aSerPre = "";
     nNumPre = "";
     fFec = @;
     aSub = "";
     nError = 0;
     aEstado = "";

     aSerEx = "";
     nNumEx = 0;
|FIN;

|PROCESO BuscaExpeLin;
     aSerEx = #18#10;
     nNumEx = #18#11;
     |ERROR10;
|FPRC;

|PROCESO LinExpe;
     aSerPre = #1#3;
     nNumPre = #1#4;
     aEstado = #1#10;
     |SI #1#10 = "C"; |ERROR10; |FINSI;
|FPRC;

|PROGRAMA;
     aAlfa = PARAMETRO % 105; aSerExp = aAlfa;
     aAlfa = PARAMETRO % 606; nNumExp = aAlfa;
     aAlfa = PARAMETRO % 1210; fFec = aAlfa;
     aAlfa = PARAMETRO % 2206; aSub = aAlfa;

     enSubCon = aSub;

     |ABRE #10; |LEE 000#10p; |CIERRA #10;

     |ABRE #0;
     #0#0 = aSerExp;
     #0#1 = nNumExp;
     |LEE 020#0=;
     |SI FSalida = 0;
          |BUCLELIN 2 LinExpe #0;
          |SI aEstado = "E";
               |MENAV "0000Obra en estado de ESPERA...";
               nError = 1;
          |FINSI;
          |SI aEstado = "P";
               |SI #10#72 = "S"; |MENAV "0000Obra en estado PARADA..."; |FINSI;
               |SI #10#73 = "N"; nError = 1; |FINSI;
          |FINSI;
          |SI aEstado = "T";
               |SI #10#74 = "S"; |MENAV "0000Obra en estado TERMINADA..."; |FINSI;
               |SI #10#75 = "N"; nError = 1; |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #0;

     |SI nError ! 0; |ACABA; |FINSI;

     |ABRE #2;
     #2#0 = aSub;
     |SI #2#0 ! 0;
          |LEE 020#2=;
          |SI FSalida ! 0;
               aSerPre = #2#4;
               nNumPre = #2#5;
          |FINSI;
     |FINSI;
     |CIERRA #2;

     |ABRE #6;
     #6#0 = aSerPre;
     #6#1 = nNumPre;
     |LEE 020#6=;
     |CIERRA #6;

     |CLS;
     #17#1 = fFec;
     |PINPA #0#17;
     |PINDA #0#17;
     |ABRET #17;
     |ENCAMPO #0#17;
     |SI FSalida = 0; |O FSalida = 6; ||Enter o F11
          |LEE 000#17=;
          |SI FSalida = 0;
               |BUCLELIN 2 BuscaExpeLin #17;
               aAlfa = "0000Ya existe parte asignado al expediente:"+&13+aSerEx +"/"+(("000000" + nNumEx)%-106);
               |MENAV aAlfa;
          |SINO;
               eaSerExp1 = #0#0;
               enNumExp1 = #0#1;
               eaSerPre1 = #6#0;
               enNumPre1 = #6#1;
               |GRABA 020#17b;

               |C_M #17#10, 1, "N";
               |C_M #17#11, 1, "N";
               |C_M #17#12, 1, "N";
               |C_M #17#4, 1, "N";
               |C_M #17#5, 1, "N";
               |C_M #17#16, 1, "N";


               |ENDATOS #1#17;
               |SI FSalida = 0;
                    |GRABA 020#17a;
               |SINO;
                    |BORRA 020#17c;
               |FINSI;
          |FINSI;
     |FINSI;
     |CIERRAT #17;
|FPRO;
