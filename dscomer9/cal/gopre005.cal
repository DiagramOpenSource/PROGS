|FICHEROS;
     gopre005 #0;
     gopre001 #1;
     gopre002 #2;
     gopre003 #3;
     gopre004 #4;
     goparame #5;
|FIN;
------------------------------------------------------------------------------
|VARIABLES;
     &cCodMonBase   = "";
     &cDesMonBase   = "";
     &cCodMonTrab   = "";
     &cDesMonTrab   = "";

     &nDeci_PBase   = 0;
     &nDeci_TBase   = 0;
     &nDeci_PTrab   = 0;
     &nDeci_TTrab   = 0;
     &nDeci_TotVis  = 0;
     &nEurComTrab   = 0;
     &nEurComBase   = 0;
     &nEurVenTrab   = 0;
     &nEurVenBase   = 0;

     &cNivel        = "";
     &cSerie        = "";
     &cCapitulo     = "";
     &cPartida      = "";
     &cDesCapit     = "";
     &cDesParti     = "";
     &cEstado       = "";

     &nNumero       = 0;
     &nImporte      = 0;
     &nCantidad     = 0;
     &nErrorInf     = 0;

     {-1}aUtil      = "";
     aUtil1         = "2400";
     aUtil2         = "1";
     aUtil3         = "Opciones : ";
     aUtil4         = "IS";
     aUtil5         = " Imprimir ";
     aUtil6         = " Salir ";

     cFichero       = "";
     cConcepto      = "";

     nHay           = 0;
     nPor           = 0;
     nModo          = 0;
|FIN;
------------------------------------------------------------------------------
|PROCESO MiraConc;
     |SI #5#5 = #4#14;
          |SI cEstado = "Venta";
               #0#5 = #0#5 + (#4#11 * nCantidad); ||Mano de Obra.
          |SINO;
               #0#5 = #0#5 + (#4#12 * nCantidad); ||Mano de Obra.
          |FINSI;
     |FINSI;
     |SI #5#6 = #4#14;
          |SI cEstado = "Venta";
               #0#6 = #0#6 + (#4#11 * nCantidad); ||Materiales.
          |SINO;
               #0#6 = #0#6 + (#4#12 * nCantidad); ||Materiales.
          |FINSI;
     |FINSI;
     |SI #5#7 = #4#14;
          |SI cEstado = "Venta";
               #0#7 = #0#7 + (#4#11 * nCantidad); ||Maquinaria.
          |SINO;
               #0#7 = #0#7 + (#4#12 * nCantidad); ||Maquinaria.
          |FINSI;
     |FINSI;
     |SI #5#8 = #4#14;
          |SI cEstado = "Venta";
               #0#8 = #0#8 + (#4#11 * nCantidad); ||Auxiliares.
          |SINO;
               #0#8 = #0#8 + (#4#12 * nCantidad); ||Auxiliares.
          |FINSI;
     |FINSI;
     |SI #5#25 = #4#14;
          |SI cEstado = "Venta";
               #0#18 = #0#18 + (#4#11 * nCantidad); ||Sin clasificar.
          |SINO;
               #0#18 = #0#18 + (#4#12 * nCantidad); ||Sin clasificar.
          |FINSI;
     |FINSI;
     |GRABA 020#0a;
     nHay = 1;
|FPRC;
------------------------------------------------------------------------------
|DEFBUCLE MiraPorcPar;
     #4#1;
     ;
     cSerie, nNumero, cCapitulo, cPartida,   1;
     cSerie, nNumero, cCapitulo, cPartida, 999;
     ;
     NULL, MiraConc;
|FIN;
------------------------------------------------------------------------------
|PROCESO MiraPorcPar;
     cPartida = #3#4;
     nCantidad = #3#7;
     |BUCLE MiraPorcPar;
|FPRC;
------------------------------------------------------------------------------
|DEFBUCLE MiraPorcCap;
     #3#1;
     ;
     cSerie, nNumero, cCapitulo,   1;
     cSerie, nNumero, cCapitulo, 999;
     ;
     NULL, MiraPorcPar;
|FIN;
------------------------------------------------------------------------------
|PROCESO MiraPorcCap;
     cCapitulo = #2#12;        ||Capitulo.
     |BUCLE MiraPorcCap;
|FPRC;
------------------------------------------------------------------------------
|DEFBUCLE MiraPorcPre;
     #2#1;
     ;
     cSerie, nNumero,   1;
     cSerie, nNumero, 999;
     ;
     NULL, MiraPorcCap;
|FIN;
------------------------------------------------------------------------------
|PROGRAMA;
     |CLS;
     |ABRE #5;
     #5#0 = "A";
     |LEE 000#5=;
     |SI FSalida ! 0;
          |MENAV "0000TIENE QUE DEFINIR LOS PARAMETROS DE OBRAS";
          |ACABA;
     |FINSI;
     cFichero = Usuario; |NOME_DAT #0 cFichero;
     |DELINDEX #0;
     |ABRE #0;
     #0#0 = cSerie;
     #0#1 = nNumero;
     |LEE 000#0=;
     |SI FSalida ! 0;
          |GRABA 020#0c;
     |FINSI;
     |SI cNivel = "PRE";
          #0#2 = cSerie+nNumero;        ||Presupuesto.
          #0#3 = "PRESUPUESTO";         ||Descricpcion Concepto.
          #0#4 = nImporte;              ||Importe Venta Pre.
          |BUCLE MiraPorcPre;
     |FINSI;
     |SI cNivel = "CAP";
          #0#2 = cCapitulo;             ||Capitulo.
          #0#3 = cDesCapit;             ||Descripcion Concepto.
          #0#4 = nImporte;              ||Importe Venta Cap.
          |BUCLE MiraPorcCap;
     |FINSI;
     |SI cNivel = "PAR";
          #0#2 = cPartida;              ||Partida.
          #0#3 = cDesParti;             ||Descricpcion Concepto.
          #0#4 = nImporte;              ||Importe Venta Par.
          |BUCLE MiraPorcPar;
     |FINSI;
     |SI nHay = 1;
          |HAZ CalPor;
          |PINPA #0#0;
          |PINDA #0#0;
          |PINTA #0#13;
          |PINTA #0#14;
          |PINTA #0#15;
          |PINTA #0#16;
          |PINTA #0#20;
          |PINTA #0#19;
          |MENU aUtil;
          |SI FSalida [ 0;
               |ACABA;
          |FINSI;
          |SI FSalida = 1;
               |HAZ ImpPorc;
          |FINSI;
     |FINSI;
     |CIERRA #0;
     |CIERRA #5;
     |DELINDEX #0;
     |FBORRA cFichero;
|FPROG;
------------------------------------------------------------------------------
|PROCESO CalPor;
     #0#9  = (#0#5*100)/#0#4;                     ||% Mano Obra.
     #0#10 = (#0#6*100)/#0#4;                     ||% Materiales.
     #0#11 = (#0#7*100)/#0#4;                     ||% Maquinaria.
     #0#12 = (#0#8*100)/#0#4;                     ||% Auxiliares.
     #0#19 = (#0#18*100)/#0#4;                    ||% Sin Clasificar.
     #0#17 = #0#9+#0#10+#0#11+#0#12+#0#19;        ||% Total.

     nPor  = ((#0#9*40)/100);                   ||Barra Mano Obra.

     |SI nPor > 0; |Y nPor < 1;
          nPor = 1;
     |FINSI;

     #0#13 = "Þ"*nPor;

     nPor  = ((#0#10*40)/100);                  ||Barra Materiales.

     |SI nPor > 0; |Y nPor < 1;
          nPor = 1;
     |FINSI;

     #0#14 = "Þ"*nPor;

     nPor  = ((#0#11*40)/100);                  ||Barra Maquinaria.

     |SI nPor > 0; |Y nPor < 1;
          nPor = 1;
     |FINSI;

     #0#15 = "Þ"*nPor;

     nPor  = ((#0#12*40)/100);                  ||Barra Auxiliares.

     |SI nPor > 0; |Y nPor < 1;
          nPor = 1;
     |FINSI;

     #0#16 = "Þ"*nPor;

     nPor  = ((#0#19*40)/100);                  ||Barra Sin Clasificar.

     |SI nPor > 0; |Y nPor < 1;
          nPor = 1;
     |FINSI;

     #0#20 = "Þ"*nPor;
|FPRC;
------------------------------------------------------------------------------
|PROCESO ImpPorc;
     |SUB_EJECUTA_NP "goinform;IMPgoporcie";
     |SI nErrorInf = 1; |ACABA; |FINSI;
     |INFOR "goporcie";
     |PRINT;|PIEINF;|FININF;
     |SUB_EJECUTA_NP "goinform;ENVgoporcie";
     |SUB_EJECUTA_NP "goinform;RUNGRAFICOS";
|FPRC;
------------------------------------------------------------------------------
