|FICHEROS;
     goprep2c #0,MANTE;
     goprep2l #1;
|FIN;

|VARIABLES;
     aParam = "";
     aAlfa = "";
     nUlt = 0;
     nPrepe = 0;
|FIN;

|PROCESO CopiaLin;
     #1#0 = nUlt;
     #1#10 = "N";
     |GRABA 020#1n;
|FPRC;

|DEFBUCLE CopiaLin;
     #1#1;
     ;
     nPrepe, 001;
     nPrepe, 999;
     ;
     NULL, CopiaLin;
|FIN;

|PROCESO BorraLin;
     |BORRA 020#1a;
|FPRC;

|DEFBUCLE BorraLin;
     #1#1;
     ;
     nUlt, 001;
     nUlt, 999;
     be;
     NULL, BorraLin;
|FIN;

|PROCESO Min;
     #1#0 = nUlt;
     #1#1 = 1;
|FPRC;

|PROCESO Max;
     #1#0 = nUlt;
     #1#1 = 999;
|FPRC;

|PROGRAMA;
     aParam = PARAMETRO;
     |ABRE #0;
     |LEE 000#0u;
     nUlt = #0#0 + 1;
     #0#0 = aParam;
     |LEE 020#0=;
     |SI FSalida = 0;
          nPrepe = #0#0;
          |BUCLE CopiaLin;
          |DDEFECTO #0;
          #0#0 = nUlt;
          #0#15 = "S";
          |GRABA 020#0b;
          |PINPA #0#0;
          |PINDA #0#0;
          |C_M #0#7, 1, "N";
          |C_M #0#14, 1, "N";
          |C_M #0#13, 1, "N";
          |ENDATOS #1#0;
          |SI FSalida = 0;
               |SI #0#8 = 0; |O #0#3 = "     ";
                    |MENAV "0000No se ha indicado la serie/jefe obra...";
                    |BUCLE BorraLin;
                    |BORRA 020#0c;
               |SINO;
                    |GRABA 020#0a;
               |FINSI;
          |SINO;
               |BUCLE BorraLin;
               |BORRA 020#0c;
          |FINSI;
     |FINSI;
     |CIERRA #0;
|FPRO;
