|FICHEROS;
     dsz00007 #0;
     agifa067 #73;
     agifa081 #104;
     dsm00005 #905;
     agifa019 #19;
     agifa017 #17;
     dsm00004 #904;
     dsm00024 #24;

     dsw00026 #26,MANTE;
     dsw00012 #1012,MANTE;
     agifa142 #142;
     albm0003@;
|FIN;

|INCLUYE i_varart;

|VARIABLES;
      aEsElemento = "N";
      &nPed_baja  = 0;
      &aSer_baja  = "";
      &nLin_baja  = 0;
      nPen1 = 0;
      nPen2 = 0;
      aDef        = "";
      nLinV       = 0;
      &Tempo      = "";
      aTempo1012  = "";
      aTempo26    = "";
      aAlfa       = "";
      aAlfa1      = "";
      nPasada     = 0;
      nCampo      = 0;
      nLinea      = 0;
      nSwPasaPie  = 0;
      nImporte    = 0;
      aMarca      = "";
      nPen        = 0;
      nSal        = 0;
      nTecla      = 0;
      nUni        = 0;
      nUni2       = 0;
      nSwElemento = 0;
|FIN;

|PROCESO DespreciaAlbero;
     |HAZ EsAlbero;
     |SI FSalida ! 0; |ACABA; |FINSI;
     |DDEF aDef;
     aDef = aDef + "albm0003";
     |CARGA_DEF aDef, albm0003@;
     |SI FSalida = 0;
          |ABRE #albm0003@;
          #albm0003@#0 = #104#25;
          #albm0003@#1 = #104#0;
          |BORRA 000#albm0003@.c;
          |CIERRA #albm0003@;
          |DESCARGA_DEF #albm0003@;
     |SINO;
          |MENAV "0000ERROR al carga albm0003";
     |FINSI;
|FPRC;

|PROCESO Despreciar;
     |SI nSwElemento = 0;
          #104#25 = #26#0;
          #104#0  = #26#1;
          |LEE 101#104=;
          |SI FSalida ! 0;  |ACABA;  |FINSI;

          #73#28 = #26#0;
          #73#0  = #26#1;
          #73#1  = #26#2;
          |LEE 101#73=;
          |SI FSalida ! 0;  |ACABA;  |FINSI;
          nUni = #26#10;
          nUni2 = #26#15;
     |SINO;
          #104#25 = #1012#0;
          #104#0  = #1012#1;
          |LEE 101#104=;
          |SI FSalida ! 0;  |ACABA;  |FINSI;

          #73#28 = #1012#0;
          #73#0  = #1012#1;
          #73#1  = #1012#2;
          |LEE 101#73=;
          |SI FSalida ! 0;  |ACABA;  |FINSI;
          nUni = #1012#13;
          nUni2 = 0;
     |FINSI;

     #73#12 = #73#12 - nUni;
     #73#44 = #73#44 - nUni2;
     #73#5   = #73#37 +  #73#12;
     #73#41  = #73#44 + #73#45;

     |GRABA 020#73a;

     |HAZ EsAlbadis;
     |SI FSalida = 0;
          eaSeriePedido = #73#28;
          enCodigPedido = #73#0;
          enLineaPedido = #73#1;
          |HAZ BseAdjUniC3;
     |FINSI;


     |SALVA_DATOS #73;

     |HAZ AceraPedCom;
     |BUCLELIN 0 RecalPedCom #104;

     |LIBERA #73;
     |LIBERA #104;

     |REPON_DATOS #73;

     |SI nSwElemento = 1;
          #905#0 = "PC";
          #905#1 = #1012#0;
          #905#2 = #1012#1;
          #905#3 = #1012#2;
          #905#4 = #1012#4;
          |LEE 101#905=;
          |SI FSalida = 0;
              #905#9 = #905#9 + (-#1012#13);
              #905#6 = #905#11 + #905#9;
              #905#8 = #905#6 * #905#7;
              |GRABA 020#905a;
              |LIBERA #905;
          |FINSI;
          #904#0 = #73#2;
          #904#1 = #73#3;
          #904#2 = #905#4;
          |LEE 101#904=;
          |SI FSalida = 0;
              #904#5  = #904#5 - #1012#13;
              |GRABA 020#904a;
              |LIBERA #904;
          |FINSI;
     |FINSI;

     #19#0 = #73#2;
     |LEE 101#19=;
     |SI FSalida = 0;
         #19#16  = #19#16 - nUni;
         #19#183 = #19#183 - nUni2;
         |HAZ ValoraStock;
         |GRABA 020#19a;
         |LIBERA #19;
     |FINSI;

     #17#0 = #73#2;
     #17#1 = #73#3;
     |LEE 101#17=;
     |SI FSalida = 0;
         #17#43 = #17#43 - nUni;
         #17#45 = #17#45 - nUni2;
         |HAZ ValoraStock;
         |GRABA 020#17a;
         |LIBERA #17;
     |FINSI;

     #24#0 = #73#2;
     #24#1 = #73#3;
     #24#2 = #73#45;
     |LEE 101#24=;
     |SI FSalida = 0;
         #24#11 = #24#11 - nUni;
         #24#12 = #24#12 - nUni2;
         |HAZ ValoraStock;
         |GRABA 020#24a;
     |FINSI;

     |HAZ DespreciaAlbero;
|FPRC;

|DEFBUCLE dsw00012;
     #1012#1;
     14;
     "      ", "     ",      1,   1, "                    ", "      ", "*";
     "zzzzzz", "zzzzz", 999999, 999, "zzzzzzzzzzzzzzzzzzzz", "zzzzzz", "*";
     ;
     NULL, Despreciar;
|FIN;

|DEFBUCLE dsz00026;
     #26#1;
     16;
     "     ",      1,   1, "                    ", "*";
     "zzzzz", 999999, 999, "zzzzzzzzzzzzzzzzzzzz", "*";
     ;
     NULL, Despreciar;
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO dsz00026Marca;
     #26#16 = aMarca;
     |GRABA 020#26a;
|FPRC;

|DEFBUCLE dsz00026Marca;
     #26#1;
     ;
     INICIO;
     FINAL;
     b;
     NULL, dsz00026Marca;
|FIN;

|PROCESO Tecla; |TIPO 11;
     |SI #26#16 = "*";
          aMarca = "";
     |SINO;
          aMarca = "*";
     |FINSI;
     |SI FSalida = 10;
          #26#16 = aMarca;
          |GRABA 020#26a;
          |PINTA #26#16;
     |FINSI;
     |SI FSalida = 11;
          nTecla = 1;
          |PTEC 806;
     |FINSI;
|FPRC;

|RUTINA ClaveBaja1012;
     #1012#0 = "  ";
     #1012#1 = 1;
     #1012#2 = 1;
     #1012#3 = "                    ";
     #1012#4 = "      ";
     #1012#9 = "      ";
|FRUT;

|RUTINA ClaveAlta1012;
     #1012#0 = "zz";
     #1012#1 = 999999;
     #1012#2 = 999;
     #1012#3 = "zzzzzzzzzzzzzzzzzzzz";
     #1012#4 = "zzzzzz";
     #1012#9 = "zzzzzz";
|FRUT;

|RUTINA ClaveBaja26;
     #26#0 = "  ";
     #26#1 = 1;
     #26#2 = 1;
     #26#4 = "                    ";
|FRUT;

|RUTINA ClaveAlta26;
     #26#0 = "zz";
     #26#1 = 999999;
     #26#2 = 999;
     #26#4 = "zzzzzzzzzzzzzzzzzzzz";
|FRUT;

|PROCESO CargaTempo;
     aEsElemento = "S";

     nPen = #905#6 - #905#12;
     |SI nPen = 0;  |ACABA;  |FINSI;

     #1012#0  = #73#28;
     #1012#1  = #73#0;
     #1012#2  = #73#1;
     #1012#3  = #73#2;
     #1012#4  = #905#4;
     #1012#9  = #104#4;
     |LEE 101#1012=;
     |SI FSalida ! 0;
         |DDEFECTO #1012;
         #1012#0  = #73#28;
         #1012#1  = #73#0;
         #1012#2  = #73#1;
         #1012#3  = #73#2;
         #1012#4  = #905#4;
         #1012#9  = #104#4;
         #1012#5  = #905#6;
         #1012#6  = #905#7;
         #1012#7  = #73#4;
         #1012#10 = #905#11;
         #1012#11 = #905#9;
         #1012#12 = #905#12;
         #1012#13 = #1012#5 - #1012#12;
         #1012#8  = #905#5;
         |GRABA 020#1012n;
         |LIBERA #1012;
     |FINSI;
|FPRC;

|DEFBUCLE dsm00005;
     #905#1;
     ;
     "PC", #73#28, #73#0, nLinV, "      ";
     "PC", #73#28, #73#0, nLinV, "zzzzzz";
     ;
     NULL, CargaTempo;
|FIN;

|PROCESO LineasPed;
||nuevo Wed Oct 20 11:50:27 CEST 2004
     nPen1 = #73#5 - #73#38;
     nPen2 = #73#41 - #73#46;
     |SI #73#45 = 0;          ||Pedidas2
          |SI nPen1 = 0; |ACABA; |FINSI;
     |SINO;
          ||SI #142#225 = "B";  NO SE MIRA EL PARAMETRO
               |SI nPen1 = 0; |Y nPen2 = 0; |ACABA; |FINSI;
          ||SINO;
          ||     |SI nPen1 = 0; |ACABA; |FINSI;
          ||     |SI nPen2 = 0; |ACABA; |FINSI;
          ||FINSI;
     |FINSI;
/* viejo
     nPen = #73#5 - #73#38;
     |SI nPen = 0;
          |SI #73#48 = 0;
               |ACABA;
          |SINO;
               nPen = #73#41 - #73#46;
               |SI nPen = 0; |ACABA; |FINSI;
          |FINSI;
     |FINSI;
*/
     aEsElemento = "N";
     nSwPasaPie = 1;
     nLinV = #73#1;
     |BUCLE dsm00005;

     |SI aEsElemento = "N";
          |DDEFECTO #26;
          #26#0 = #73#28;
          #26#1 = #73#0;
          #26#2 = #73#1;
          #26#3 = #104#1;
          #26#4 = #73#2;
          #26#5 = #73#4;
          #26#6 = #73#37;       || Pedidas
          #26#7 = #73#12;       || Varia
          #26#8 = #73#5;        || Total
          #26#9 = #73#38;       || Rec
          #26#10 = #26#8 - #26#9; || Pend
          #26#11= #73#45;       || Pedidas 2
          #26#12= #73#44;       || Varia 2
          #26#13= #73#41;       || Total 2
          #26#14= #73#46;       || Rec 2
          #26#15 = #26#13 - #26#14;|| Pend 2
          #26#16 = aMarca;
          |GRABA 020#26n;
     |FINSI;
|FPRC;

|DEFBUCLE agifa081;
     #104#1;
     4, 1;
     #0#6, #0#2, #0#0, #0#4;
     #0#7, #0#3, #0#1, #0#5;
     ;
     NULL, NULL, LineasPed;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;

     |SI #142#117 = "S";
          |C_V #26#11, 1, "S";
          |C_V #26#12, 1, "S";
          |C_V #26#13, 1, "S";
          |C_V #26#14, 1, "S";
          |C_V #26#15, 1, "S";
     |FINSI;

     |HAZ CreaTempo; aTempo1012 = Tempo;
     |NOME_DAT #1012 aTempo1012; |DELINDEX #1012;
     |HAZ CreaTempo; aTempo26   = Tempo;
     |NOME_DAT #26 aTempo26;     |DELINDEX #26;

     |ABRE #26;
     |ABRE #1012;
     |BUCLE agifa081;

     |SI nSwPasaPie = 1;
          |LEE 000#26p;
          |SI FSalida = 0;
               nSwElemento = 0;
               |SI nPed_baja = 0;
                    |PINPA #0#26;
                    |PARA nTecla = 1; |SI nTecla ! 0; |HACIENDO;
                         nTecla = 0;
                         |ENTLINEAL #1#26, -4, 4, 22, 0, ClaveBaja26, ClaveAlta26;
                         |SI nTecla ! 0;
                              |BUCLE dsz00026Marca;
                         |FINSI;
                    |SIGUE;
                    |CONFI "2400NConforme con lo Seleccionado : ";
               |SINO;
                    FSalida = 0;
               |FINSI;
               |SI FSalida = 0;
                    |ABRE #104;
                    |ABRE #73;
                    |ABRE #19;
                    |ABRE #17;
                    |ABRE #24;
                    |BUCLE dsz00026;
                    |CIERRA #24;
                    |CIERRA #104;
                    |CIERRA #73;
                    |CIERRA #19;
                    |CIERRA #17;
               |FINSI;
          |FINSI;

          |LEE 000#1012p;
          |SI FSalida = 0;
              nSwElemento = 1;
              |C_V #1012#14, 1, "S";
              |C_M #1012#14, 1, "S";
              |C_L #1012#14, 1, "S";
              |CLS;
              |ENTLINEAL #1#1012, 6, 4, 22, 1, ClaveBaja1012, ClaveAlta1012;
              |CONFI "2400NConforme con lo Seleccionado : ";
              |SI FSalida = 0;
                  |ABRE #104;
                  |ABRE #73;
                  |ABRE #905;
                  |ABRE #19;
                  |ABRE #17;
                  |ABRE #904;
                  |ABRE #24;
                  |BUCLE dsw00012;
                  |CIERRA #24;
                  |CIERRA #104;
                  |CIERRA #73;
                  |CIERRA #905;
                  |CIERRA #19;
                  |CIERRA #17;
                  |CIERRA #904;
              |FINSI;
          |FINSI;
     |SINO;
         |MENAV "     No quedan unidades Pendientes de Recibir";
     |FINSI;

     |CIERRA #1012;  |DELINDEX #1012; Tempo = aTempo1012; |HAZ BoraTempo;
     |CIERRA #26;    |DELINDEX #26;   Tempo = aTempo26;   |HAZ BoraTempo;
|FPRC;

|PROGRAMA;
     |SI nPed_baja = 0;
          |MANTE #0;
     |SINO;
          #0#6 = aSer_baja;
          #0#7 = aSer_baja;
          #0#2 = nPed_baja;
          #0#3 = nPed_baja;
          aMarca = "*";
          |HAZ Tipo3;
     |FINSI;
|FPRO;
