||Sirve para controlar las facturas de Compra. Si estan o no contabilizadas.
||Se utiliza por ejemplo en Luxe Perfil. (a traves de un sub_ejecuta)
||Se basa en el Tipo2, del agifa079

|FICHEROS;
     agifa079 #0;
     agifa142 #41;

     agifa743 #1002;
     Referen@ #1000;

     agifa722 #200;
     agifa704 #100;
     agifa716 #101;
     tempfafa #43; || Entrada Importes Regularizados por Factura / Famil

/*
     dsm00124 #124;
     agis0002 #20;
*/
|FIN;

|VARIABLES;
     &efFechaForm = @;
     aAlfaX  = "";

     ||IN
    &PRMNT_eaSerieFC = "";
    &PRMNT_enNumFacFC = 0;
    &PRMNT_enModoCtrlFC = 0;
    &PRMNT_enFormaCtrlFC = 0;

     ||OUT
     &enSwDejaModBaja = 1;
     &PRMNT_enSwReContabi = 0;

     ||IN & OUT
     &PRMNT_eaContab = "";

     nSwCerr = 0;
     nSwSal = 0;
     ModoEntrada = 0;
     Flag = 0;
     Modo = 0;

     aPath = "";
     aPathDatos = "";
     con = 0;
     nForma = 0;
     nSwFlag = 0;
     fFechaAnt = @;
     fFechaBloq = @;
     aAlfa2 = "";
     aAlfa3 = "";
     aAlfa = "";
     nSw = 0;
     &eaProg = "";
     &enErrCarte = 0;
     nSal = 0;
     &enErr = 0;
     nSwErr = 0;
     nSwNolog = 0;

     nModo = 0;
     aAlfa1 = "";
     nSwHay = 0;
     FEstado = 0;
     nCalc = 0;
     aFichAnt = "";
     nCmpAnt = 0;
     aSerie = "";
     nContador = 0;
     Comodin = "";
     Comodin1 = "";
     &PRMNT_enError = 0;
|FIN;

|PROCESO BorFanFact;
     |BORRA 020#43a;
|FPRC;

|DEFBUCLE BorFanFact;
     #43#1;
     ;
     #0#66, #0#0, "   ";
     #0#66, #0#0, "zzz";
     be;
     NULL, BorFanFact;
|FIN;

|PROCESO BorraAsto;
   |ABRE #agifa743;
   #agifa743#0 = "FC";
   #agifa743#1 = #agifa079#66;
   #agifa743#2 = #agifa079#0;
   aAlfaX = #agifa079#1; |QBF aAlfaX; aAlfaX = aAlfaX % -104;
   #agifa743#3 = aAlfaX;
   |LEE 000#agifa743.=;
   |SI FSalida = 0; efFechaForm = #agifa743#5; |FINSI;
   |CIERRA #agifa743;

   aAlfa1 = #agifa079#1; |QBF aAlfa1; aAlfa1 = aAlfa1 % -104; nSw = 0;
   |ABRE #agifa722;
   #agifa722#0  = "FC";
   #agifa722#1  = #agifa079#66;
   #agifa722#2  = #agifa079#0;
   #agifa722#3  = "";
   #agifa722#11 = 1;
   |LEE 000#agifa722.];
   FEstado = FSalida; aAlfa  = #agifa722#1; aAlfa = aAlfa % 0105; nCalc = #agifa722#2; FSalida = FEstado;
   |PARA; |SI FSalida = 0; |Y #agifa722#0 = "FC"; |Y aAlfa = #agifa079#66;
    |Y nCalc = #agifa079#0; |HACIENDO;
      aAlfa = #agifa722#3; |QBF aAlfa;
      |SI aAlfa = aAlfa1; nSw = 1; |SAL; |FINSI;
      |LEE 000#agifa722.s;
      FEstado = FSalida; aAlfa  = #agifa722#1; aAlfa = aAlfa % 0105; nCalc = #agifa722#2; FSalida = FEstado;
   |SIGUE;

   |SI nSw = 1;
      aAlfa = "ac" + Usuario; |NOME_DAT #agifa716#aAlfa#;
      |DELINDEX #agifa716; |ABRE #agifa716;

      |ABRE #agifa704;
      #agifa704#0 = #agifa722#10;
      |LEE 101#agifa704.=;
      |SI FSalida = 0;
         aFichAnt = #agifa704#16; nCmpAnt = #agifa704#17;
         |SI #agifa704#8 = "S";
            |DDEFECTO #agifa716;
            #agifa716#15 = #agifa722#10;  #agifa716#0  = 1;
            #agifa716#13 = "agifa080";    #agifa716#14 = 28;
            #agifa716#11 = "A";           #agifa716#12 = 5;
            #agifa716#3  = #agifa079#66;  #agifa716#4  = #agifa079#66;
            |GRABA 020#agifa716.n;

            |DDEFECTO #agifa716;
            #agifa716#15 = #agifa722#10;  #agifa716#0  = 2;
            #agifa716#13 = "agifa080";    #agifa716#14 = 25;
            #agifa716#11 = "N";           #agifa716#12 = 6;
            #agifa716#5  = #agifa079#0;   #agifa716#6  = #agifa079#0;
            |GRABA 020#agifa716.n;
            |LIBERA #agifa716; |CIERRA #agifa716;

            #agifa704#16 = "agifa080";    #agifa704#17 = 25;
            |GRABA 020#agifa704.a;
         |SINO;
            |DDEFECTO #agifa716;
            #agifa716#15 = #agifa722#10;  #agifa716#0  = 1;
            #agifa716#13 = "agifa079";    #agifa716#14 = 66;
            #agifa716#11 = "A";           #agifa716#12 = 5;
            #agifa716#3  = #agifa079#66;  #agifa716#4  = #agifa079#66;
            |GRABA 020#agifa716.n;

            |DDEFECTO #agifa716;
            #agifa716#15 = #agifa722#10;  #agifa716#0  = 2;
            #agifa716#13 = "agifa079";    #agifa716#14 = 0;
            #agifa716#11 = "N";           #agifa716#12 = 6;
            #agifa716#5  = #agifa079#0;   #agifa716#6  = #agifa079#0;
            |GRABA 020#agifa716.n;
            |LIBERA #agifa716; |CIERRA #agifa716;
            #agifa704#16 = "agifa079";    #agifa704#17 = 0;
            |GRABA 020#agifa704.a;
         |FINSI;
      |FINSI;
      |LIBERA #agifa704; |CIERRA #agifa704;

      aSerie = #agifa079#66; nContador = #agifa079#0;
      |LIBERA #agifa079; |CIERRAT #agifa079;

      Comodin1 = #agifa079#1; |QBF Comodin1; Comodin1 = Comodin1 % -104;
      Comodin = #agifa722#10; |QBF Comodin;
      Comodin = "agifa711.tab;" + Comodin + ",B*" + Comodin1;
      |SUB_EJECUTA_NP Comodin;

      |ABRE #agifa704;
      #agifa704#0 = #agifa722#10;
      |LEE 101#agifa704.=;
      |SI FSalida = 0;
         #agifa704#16 = aFichAnt; #agifa704#17 = nCmpAnt;
         |GRABA 020#agifa704.a;
      |FINSI;
      |LIBERA #agifa704; |CIERRA #agifa704;

      |ABRET #agifa079;
      #agifa079#66 = aSerie; #agifa079#0 = nContador;
      |LEE 121#agifa079.=;

      |SI PRMNT_enError = 0;
          #agifa079#48 = "N";   |PINTA #0#48;
          |GRABA 020#agifa079.a;
          ||BORRA 020#agifa722.a;
      |FINSI;
   |FINSI;

   nSw = PRMNT_enError;
   |CIERRA #agifa722;
|FPRC;

|PROGRAMA;
     enSwDejaModBaja = 1;

     |ABRE #41; |LEE 000#41p; |CIERRA #41;

     |ABRE #0;
     #0#66 = PRMNT_eaSerieFC;
     #0#0 = PRMNT_enNumFacFC;
     |LEE 000#0=;
     |SI FSalida ! 0;
          |ACABA;
     |FINSI;

     con = PRMNT_enModoCtrlFC;
     nForma = PRMNT_enFormaCtrlFC;

     |SI nForma < 0;
        PRMNT_eaContab = "N";
        |SI #agifa079#48 = "S";
           fFechaBloq = "01.01.0000"; nSwCerr = 0;
           |ABRE #agifa722;
           #agifa722#0 = "FC";
           #agifa722#1 = #agifa079#66;
           #agifa722#2 = #agifa079#0;
           #agifa722#11 = 1;
           |LEE 000#agifa722.];
           aAlfa2 = #agifa722#1;  |QBF aAlfa2;
           aAlfa3 = #agifa079#66; |QBF aAlfa3;
           |PARA; |SI FSalida = 0; |Y #agifa722#0 = "FC"; |Y aAlfa2 = aAlfa3; |Y #agifa722#2 = #agifa079#0; |HACIENDO;
              |ABRE #agifa704;
              #agifa704#0 = #agifa722#10;
              |LEE 000#agifa704.=;
              |SI FSalida ! 0; |DDEFECTO #agifa704; |FINSI;
              |CIERRA #agifa704;
              aAlfa = #agifa704#6; |QBF aAlfa;
              aAlfa = aAlfa - "contagen";
              |SI FSalida ! 0;
                 aAlfa = #agifa704#6; |QBF aAlfa;
                 aAlfa = aAlfa + "def/canempre.mas";
                 |CARGA_DEF aAlfa, Referen@;
                 |SI FSalida = 0;
                    aAlfa = #agifa704#6; |QBF aAlfa;
                    aAlfa = aAlfa + "fich/";
                    |PATH_DAT #Referen@#aAlfa#;
                    |ABRE #Referen@;
                    #Referen@#2 = #agifa722#8;
                    #Referen@#3 = #agifa722#9;
                    |LEE 000#Referen@.=;
                    |SI FSalida ! 0; |DDEFECTO #Referen@; |FINSI;
                    |SI #Referen@#34 ! "01.01.0000";
                       fFechaBloq = #Referen@#34; |SAL;
                    |FINSI;
                    |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
                 |FINSI;
                 aAlfa = #agifa704#6; |QBF aAlfa;
                 aAlfa = aAlfa + "def/camaasic.mas";
                 |CARGA_DEF aAlfa, Referen@;
                 |SI FSalida = 0;
                    aAlfa = #agifa704#6; |QBF aAlfa;
                    aAlfa = aAlfa + "fich/" + (("00000" + #agifa722#8) % -105) + #agifa722#9 + "/";
                    |PATH_DAT #Referen@#aAlfa#;
                    |ABRE #Referen@;
                    #Referen@#0 = 99;
                    #Referen@#1 = "01.01.0000";
                    #Referen@#2 = 1;
                    |LEE 000#Referen@.];
                    |SI FSalida = 0; |Y #Referen@#0 = 99;
                       nSwCerr = 1; |SAL;
                    |FINSI;
                    |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
                 |FINSI;
              |FINSI;
              |LEE 000#agifa722.s;
              aAlfa2 = #agifa722#1;  |QBF aAlfa2;
              aAlfa3 = #agifa079#66; |QBF aAlfa3;
           |SIGUE;
           |CIERRA #agifa722;
           |SI fFechaBloq ! "01.01.0000";
              |SI #agifa079#1 [ fFechaBloq;
                 aAlfa = "    Factura contabilizada y con fecha anterior a bloqueo contabilidad [" + fFechaBloq + "]";
                 |MENAV aAlfa;
                 enSwDejaModBaja = 0;
                 nSwFlag = 1; nSwSal = 1; |ERROR; |ACABA;
              |FINSI;
           |FINSI;
           |SI nSwCerr = 1;
              aAlfa = "    Contabilidad cerrada. No se puede modificar el asiento";
              |MENAV aAlfa;
              nSwFlag = 1; enSwDejaModBaja = 0; nSwSal = 1; |ERROR; |ACABA;
           |FINSI;
        |FINSI;
     |FINSI;

     |SI con = 1; nSwFlag = 0; |FINSI;
     |SI nSwFlag = 1; |ACABA; |FINSI;

     |SI #0#48 = "S";
        |AVISO;
        |CONFI "0000NEsta Factura Esta Contabilizada: Desea Continuar? ";
        |SI FSalida = 0;
           PRMNT_eaContab = "S";
           |HAZ BorraAsto;
           |SI nSw < 0;
              nSwFlag = 1; enSwDejaModBaja = 0; nSwSal = 1; |ERROR; |ACABA;
           |FINSI;
        |SINO;
           nSwFlag = 1; enSwDejaModBaja = 0; nSwSal = 1;|ERROR; |ACABA;
        |FINSI;
     |FINSI;

     |SI #0#45 = "S";
          |SI con ] 2; |Y nForma ! 1;

               |HAZ MiraRecCompra;
               |SI enErrCarte ! 0;
                  |MENAV "0000Recibos con movimientos, NO SE DARA DE BAJA...";
                  nSwFlag = 1; enSwDejaModBaja = 0; nSwSal = 1; |ERROR; |ACABA;
               |FINSI;

               |HAZ MiraRecCompra;
               |SI enErrCarte ! 0;
                  |MENAV "0000Recibos con movimientos, NO SE DARA DE BAJA...";
                  nSwFlag = 1; enSwDejaModBaja = 0; nSwSal = 1; |ERROR; |ACABA;
               |FINSI;

               |AVISO;
               |CONFI "0000NDesea dejar la factura como NO impresa y anular los recibos?  ";
               |SI FSalida ! 0;
                    nSwFlag = 1; enSwDejaModBaja = 0; nSwSal = 1; |ERROR; |ACABA;
               |SINO;
                    |HAZ borrareci;
                    |SI nSwErr ! 0;
                         nSwFlag = 1;
                         enSwDejaModBaja = 0;
                         |ERROR; |ACABA;
                    |FINSI;
                    #0#45 = "N";
                    |GRABA 020#0a;
               |FINSI;
          |FINSI;
     |FINSI;

     |SI con = 3;
          |HAZ borrareci;
          |SI nSwErr ! 0;
               enSwDejaModBaja = 0;
               |ERROR;
               |ACABA;
          |FINSI;
          |BUCLE BorFanFact;
          aAlfa1 = #agifa079#1; |QBF aAlfa1; aAlfa1 = aAlfa1 % -104; nSw = 0;
          |ABRE #agifa722;
          #agifa722#0 = "FC";
          #agifa722#1 = #agifa079#66;
          #agifa722#2 = #agifa079#0;
          #agifa722#11 = 1;
          |LEE 000#agifa722.];
          FEstado = FSalida; aAlfa  = #agifa722#1; aAlfa = aAlfa % 0105; nCalc = #agifa722#2; FSalida = FEstado;
          |PARA; |SI FSalida = 0; |Y #agifa722#0 = "FC"; |Y aAlfa = #agifa079#49;
           |Y nCalc = #agifa079#0; |HACIENDO;
             aAlfa = #agifa722#3; |QBF aAlfa;
             |SI aAlfa = aAlfa1; nSwHay = 1; |SAL; |FINSI;
             |LEE 000#agifa722.s;
             FEstado = FSalida; aAlfa  = #agifa722#1; aAlfa = aAlfa % 0105; nCalc = #agifa722#2; FSalida = FEstado;
          |SIGUE;
          |SI nSwHay = 1; |BORRA 020#agifa722.a; |FINSI;
          |CIERRA #agifa722;
     |FINSI;

     |SI nForma > 0; |Y PRMNT_eaContab = "S";
        ||CONFI "N    Volver a dejar contabilizada la factura ? ";
        || ABDON 30/06/2011  Tiquet 001483/01577
        ||    Seg£n el tiquet, no quieren que se pueda dejar de nuevo
        ||    contabilizada la factura.
        FSalida = 1;
        |SI FSalida = 0;
           nSw = 2; |HAZ Asiento;
           |SI nSw = 0;
               ||TODO CCC
               ||ARA
               ||Poner como contabilizada.
               PRMNT_enSwReContabi = 1;
               /*
               ||Lo tengo que poner en compaq, sino al regenerar la factura
               ||lo vuelve a dejar como no contabilizado
               #0#48 = "S";
               |GRABA 020#0a;
               |LIBERA #0;
               */
           |FINSI;
        |SINO;
           |HAZ BorraHisEnlace;
           PRMNT_eaContab = "N";

           #0#48 = "N"; |GRABA 020#0a;
           |LIBERA #0;
        |FINSI;
        PRMNT_eaContab = "N";
     |FINSI;

     ModoEntrada = (FEntrada / 100) ! 0; Flag = 0 +. 1;
     |SI #agifa079#137 ! 0;
        |SI ModoEntrada = 2; |Y Flag < 0; |ACABA; |FINSI;
        aAlfa = "ac" + Usuario; |NOME_DAT #agifa716#aAlfa#;
        |DELINDEX #agifa716; |ABRE #agifa716;
        |DDEFECTO #agifa716;
        #agifa716#15 = #agifa079#141; #agifa716#0 = 1;
        #agifa716#13 = "agifa079";    #agifa716#14 = 66;
        #agifa716#11 = "A";
        #agifa716#3 = #agifa079#66; #agifa716#4 = #agifa079#66;
        |GRABA 020#agifa716.n;

        |DDEFECTO #agifa716;
        #agifa716#15 = #agifa079#141; #agifa716#0 = 2;
        #agifa716#13 = "agifa079"; #agifa716#14 = 0;
        #agifa716#11 = "N";
        #agifa716#5 = #agifa079#0; #agifa716#6 = #agifa079#0;
        |GRABA 020#agifa716.n;

        |LIBERA #agifa716;
        |CIERRA #agifa716;
        |SI ModoEntrada = 3; Modo = ",B"; |SINO; Modo = ""; |FINSI;
        Comodin = #agifa079#141; |QBF Comodin;
        Comodin = "agifa711.tab;" + Comodin + Modo + ",SINPRELV";
        |SUB_EJECUTA_NP Comodin;
     |FINSI;
|FPRO;

|PROCESO Asiento;
   nModo = (FEntrada / 100) ! 0;

   efFechaForm = "01.01.0000";
   |ABRE #agifa743;
   #agifa743#0 = "FC";
   #agifa743#1 = #agifa079#66;
   #agifa743#2 = #agifa079#0;
   aAlfaX = #agifa079#1; |QBF aAlfaX; aAlfaX = aAlfaX % -104;
   #agifa743#3 = aAlfaX;
   |LEE 000#agifa743.=;
   |SI FSalida = 0; efFechaForm = #agifa743#5; |FINSI;
   |CIERRA #agifa743;

   aAlfa1 = #agifa079#1; |QBF aAlfa1; aAlfa1 = aAlfa1 % -104; nSwHay = 0;
   |ABRE #agifa722;
   #agifa722#0 = "FC";
   #agifa722#1 = #agifa079#66;
   #agifa722#2 = #agifa079#0;
   #agifa722#11 = 1;
   |LEE 000#agifa722.];
   FEstado = FSalida; aAlfa  = #agifa722#1; aAlfa = aAlfa % 0105; nCalc = #agifa722#2; FSalida = FEstado;
   |PARA; |SI FSalida = 0; |Y #agifa722#0 = "FC"; |Y aAlfa = #agifa079#66;
    |Y nCalc = #agifa079#0; |HACIENDO;
      aAlfa = #agifa722#3; |QBF aAlfa;
      |SI aAlfa = aAlfa1; nSwHay = 1; |SAL; |FINSI;
      |LEE 000#agifa722.s;
      FEstado = FSalida; aAlfa  = #agifa722#1; aAlfa = aAlfa % 0105; nCalc = #agifa722#2; FSalida = FEstado;
   |SIGUE;
   |CIERRA #agifa722;

   aAlfa1 = "N";
   |SI nSwHay = 1;
      aAlfa = "ac" + Usuario; |NOME_DAT #agifa716#aAlfa#;
      |DELINDEX #agifa716; |ABRE #agifa716;

      |ABRE #agifa704;
      #agifa704#0 = #agifa722#10;
      |LEE 101#agifa704.=;
      |SI FSalida = 0;
         aFichAnt = #agifa704#16; nCmpAnt = #agifa704#17;
         |SI #agifa704#8 = "S";
            |DDEFECTO #agifa716;
            #agifa716#15 = #agifa722#10;  #agifa716#0  = 1;
            #agifa716#13 = "agifa080";    #agifa716#14 = 28;
            #agifa716#11 = "A";           #agifa716#12 = 5;
            #agifa716#3  = #agifa079#66;  #agifa716#4  = #agifa079#66;
            |GRABA 020#agifa716.n;

            |DDEFECTO #agifa716;
            #agifa716#15 = #agifa722#10;  #agifa716#0  = 2;
            #agifa716#13 = "agifa080";    #agifa716#14 = 25;
            #agifa716#11 = "N";           #agifa716#12 = 6;
            #agifa716#5  = #agifa079#0;   #agifa716#6  = #agifa079#0;
            |GRABA 020#agifa716.n;
            |LIBERA #agifa716; |CIERRA #agifa716;

            #agifa704#16 = "agifa080"; #agifa704#17 = 25;
            |GRABA 020#agifa704.a;
         |SINO;
            |DDEFECTO #agifa716;
            #agifa716#15 = #agifa722#10;  #agifa716#0  = 1;
            #agifa716#13 = "agifa079";    #agifa716#14 = 66;
            #agifa716#11 = "A";           #agifa716#12 = 5;
            #agifa716#3  = #agifa079#66;  #agifa716#4  = #agifa079#66;
            |GRABA 020#agifa716.n;

            |DDEFECTO #agifa716;
            #agifa716#15 = #agifa722#10;  #agifa716#0  = 2;
            #agifa716#13 = "agifa079";    #agifa716#14 = 0;
            #agifa716#11 = "N";           #agifa716#12 = 6;
            #agifa716#5  = #agifa079#0;   #agifa716#6  = #agifa079#0;
            |GRABA 020#agifa716.n;
            |LIBERA #agifa716; |CIERRA #agifa716;
            #agifa704#16 = "agifa079"; #agifa704#17 = 0;
            |GRABA 020#agifa704.a;
         |FINSI;
      |FINSI;
      |LIBERA #agifa704; |CIERRA #agifa704;

      aSerie = #agifa079#66; nContador = #agifa079#0;
      |GRABA 020#agifa079.a;
      |LIBERA #agifa079; |CIERRAT #agifa079;

      Comodin1 = #agifa079#1; |QBF Comodin1; Comodin1 = Comodin1 % -104;
      Comodin = #agifa722#10; |QBF Comodin;
      |SI nSw = 1; || BORRA
         Comodin = "agifa711.tab;" + Comodin + ",B*" + Comodin1;
         aAlfa1 = "N";
      |FINSI;
      |SI nSw = 2; || ENLAZA
         Comodin = "agifa711.tab;" + Comodin;
         aAlfa1 = "S";
      |FINSI;
      |SUB_EJECUTA_NP Comodin;

      |ABRE #agifa704;
      #agifa704#0 = #agifa722#10;
      |LEE 101#agifa704.=;
      |SI FSalida = 0;
         #agifa704#16 = aFichAnt; #agifa704#17 = nCmpAnt;
         |GRABA 020#agifa704.a;
      |FINSI;
      |LIBERA #agifa704; |CIERRA #agifa704;

      |ABRET #agifa079;
      #agifa079#66 = aSerie; #agifa079#0 = nContador;
      |LEE 121#agifa079.=;
   |FINSI;
   |SI PRMNT_enError = 0;
      #agifa079#48 = aAlfa1; |GRABA 020#agifa079.a;
   |FINSI;
   nSw = PRMNT_enError;
|FPRC;

|PROCESO BorraHisEnlace;
     aAlfa1 = #agifa079#1; |QBF aAlfa1; aAlfa1 = aAlfa1 % -104; nSw = 0;
     |ABRE #agifa722;
     #agifa722#0 = "FC";
     #agifa722#1 = #agifa079#66;
     #agifa722#2 = #agifa079#0;
     #agifa722#11 = 1;
     |LEE 000#agifa722.];
     FEstado = FSalida; aAlfa  = #agifa722#1; aAlfa = aAlfa % 0105; nCalc = #agifa722#2; FSalida = FEstado;
     |PARA; |SI FSalida = 0; |Y #agifa722#0 = "FC"; |Y aAlfa = #agifa079#66;
      |Y nCalc = #agifa079#0; |HACIENDO;
        aAlfa = #agifa722#3; |QBF aAlfa;
        |SI aAlfa = aAlfa1; nSwHay = 1; |SAL; |FINSI;
        |LEE 000#agifa722.s;
        FEstado = FSalida; aAlfa  = #agifa722#1; aAlfa = aAlfa % 0105; nCalc = #agifa722#2; FSalida = FEstado;
      |SIGUE;
     |SI nSwHay = 1; |BORRA 020#agifa722.a; |FINSI;
     |CIERRA #agifa722;
|FPRC;


|CALCULO borrareci;
     |HAZ MiraRecCompra;
     |SI enErrCarte ! 0;
          |MENAV "0000Recibos con movimientos, NO SE DARA DE BAJA...";
          nSwErr = 1; |ACABA;
     |FINSI;
     |HAZ BorraRecCompra;
|FCAL;
