|FICHEROS;
     gocermed #0;
     gocerhip #1;
     gomedive #2;
     goparame #3;
     gopre002 #4;
     agifa019 #19;
     agifa060 #60;
     agifa120 #120;
     guerw069 #69;
     gocerlip@;
     gocerhip@;
     gocermed@;
|FIN;
-------------------------------------------------------------------------------
|VARIABLES;
     nSw = 0;
     nUltima = 0;
     nLinea = 0;
     nHastaLinea = 0;
     aCamp0         = "";
     aCamp1         = "";
     aCamp2         = "";
     aCamp3         = "";
     &nDeci_Medi    = 0;
     &nDeci_Meda    = 0;
     &Tempo         = "";
     &enSwCopia     = 0;
     &eaSer         = "";
     &eaCapi        = "";
     &eaSerPre = "";
     &enNumPre = 0;
     &eaParti = "";
     &enNum         = 0;
     &eaRefe        = "";
     &enPresu       = 0;
     i              = 0;
     nHay           = 0;
     aDef           = "";
     aPath          = "";
     cDesc          = "";
     cEstado        = "";
     cCampo         = "";
     nLin           = 0;
     nCampos        = 0;
     aAlfa          = "";
     nUlt           = 0;
|FIN;
-------------------------------------------------------------------------------
|PROCESO Entra; |TIPO 7;
     |ABRE #3;
     #3#0 = "A";
     |LEE 000#3=;
     |SI FSalida = 0;
          |SI #3#41 = "S";
               |ABRE #2;
               #2#0 = #1#6;
               |LEE 000#2=;
               |SI FSalida = 0;
                    |SI #2#3 = "S";
                         |C_M #0#6, 1, "S";
                    |SINO;
                         |C_M #0#6, 1, "N";
                    |FINSI;
                    |SI #2#4 = "S";
                         |C_M #0#7, 1, "S";
                    |SINO;
                         |C_M #0#7, 1, "N";
                    |FINSI;
                    |SI #2#5 = "S";
                         |C_M #0#8, 1, "S";
                    |SINO;
                         |C_M #0#8, 1, "N";
                    |FINSI;
               |FINSI;
               |CIERRA #2;
          |SINO;
               |C_M #0#6, 1, "S";|C_M #0#7, 1, "S";|C_M #0#8, 1, "S";
          |FINSI;
     |FINSI;
     |CIERRA #3;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO Cambios; |TIPO 2;
     #1#20 = #1#20 +. #0#9;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO CalLinMed; |TIPO 0;

     ||Laro,Ancho y Alto.

     |SI #0#6 = 0; |Y #0#7 = 0;|Y #0#8 = 0;
          #0#9 = #0#5;
     |FINSI;

     |SI #0#6 ! 0; |Y #0#7 ! 0;|Y #0#8 ! 0;
          #0#9 = #0#5 * #0#6 * #0#7 * #0#8;
     |FINSI;

     ||Largo y Ancho;

     |SI #0#6 ! 0; |Y #0#7 ! 0;|Y #0#8 = 0;
          #0#9 = #0#5 * #0#6 * #0#7;
     |FINSI;

     ||Largo y Alto.

     |SI #0#6 ! 0; |Y #0#7 = 0;|Y #0#8 ! 0;
          #0#9 = #0#5 * #0#6 * #0#8;
     |FINSI;

     ||Largo;

     |SI #0#6 ! 0; |Y #0#7 = 0;|Y #0#8 = 0;
          #0#9 = #0#5 * #0#6;
     |FINSI;

     ||Ancho y Alto.

     |SI #0#6 = 0; |Y #0#7 ! 0;|Y #0#8 ! 0;
          #0#9 = #0#5 * #0#7 * #0#8;
     |FINSI;

     ||Ancho.

     |SI #0#6 = 0; |Y #0#7 ! 0;|Y #0#8 = 0;
          #0#9 = #0#5 * #0#7;
     |FINSI;

     ||Alto.

     |SI #0#6 = 0; |Y #0#7 = 0;|Y #0#8 ! 0;
          #0#9 = #0#5 * #0#8;
     |FINSI;

     |PINTA #0#9;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO TerProMed; |TIPO 3;
     |SI #0#9 = 0;
          |MENAV "0000EXISTE ALGUN OPERANDO SIN VALOR O ESTA A 0";
     |FINSI;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO Mira0; |TIPO 0;
     |SI #3#41 = "S";
          |C_M #0Campo, 0, cCampo;
          |SI #0Campo = 0; |Y cCampo = "S";
               |MENAV "0000TIENE QUE ASIGNAR LA MEDIDA EN ESTE CAMPO";
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO CopiaMedicion;
     |SI nSw = 1;
          nUltima = #gocermed@#4;
     |SINO;
          nLinea = nLinea + 1;
          #gocermed@#0 = #0#0;
          #gocermed@#1 = #0#1;
          #gocermed@#2 = #0#2;
          #gocermed@#3 = #0#3;
          #gocermed@#4 = nLinea;
          |GRABA 020#gocermed@.n;
     |FINSI;
|FPRC;

|DEFBUCLE CopiaMedicion;
     #gocermed@#1005;
     ;
     #69#0, #69#1, #69#5, #69#6, 001;
     #69#0, #69#1, #69#5, #69#6, nHastaLinea;
     ;
     NULL, CopiaMedicion;
|FIN;

|PROCESO CopiaLinea;
     |ABRE #gocermed@;
     #gocermed@#0 = #0#0;
     #gocermed@#1 = #0#1;
     #gocermed@#2 = #0#2;
     #gocermed@#3 = #0#3;
     #gocermed@#4 = 999;
     |LEE 101#gocermed@.];
     |SI FSalida = 0;
          |LEE 101#gocermed@.a;
     |SINO;
          |LEE 101#gocermed@.u;
     |FINSI;
     |SI FSalida = 0; |Y #gocermed@#0 = #0#0; |Y #gocermed@#1 = #0#1;
               |Y #gocermed@#2 = #0#2; |Y #gocermed@#3 = #0#3;
          nLinea = #gocermed@#4;
     |SINO;
          nLinea = 0;
     |FINSI;

     nSw = 1;
     nHastaLinea = 999;
     nUltima = 0;
     |BUCLE CopiaMedicion;

     nSw = 0;
     nHastaLinea = nUltima;
     |BUCLE CopiaMedicion;
     |CIERRA #gocermed@;
|FPRC;

|PROCESO MinMed;
     #4#0 = #0#0;
     #4#1 = #0#1;
     #4#2 = 1;
|FPRC;

|PROCESO MaxMed;
     #4#0 = #0#0;
     #4#1 = #0#1;
     #4#2 = 999;
|FPRC;

|PROCESO Partidas;
     |DDEFECTO #19;
     #19#0 = #gocerhip@#4;
     |LEE 000#19=;

     |SI #19#2 ! #60#0; |ACABA; |FINSI;
     |SI #19#3 ! #120#0; |ACABA; |FINSI;

     #gocermed@#0 = #gocerhip@#0;
     #gocermed@#1 = #gocerhip@#1;
     #gocermed@#2 = #gocerhip@#2;
     #gocermed@#3 = #gocerhip@#3;
     #gocermed@#4 = 999;
     |LEE 000#gocermed@.];
     |SI FSalida = 0;
          |LEE 000#gocermed@.a;
     |SINO;
          |LEE 000#gocermed@.u;
     |FINSI;
     |SI FSalida ! 0; |O #gocermed#0 ! #gocerhip#0; |O #gocermed#1 ! #gocerhip#1;
          |O #gocermed#2 ! #gocerhip#2; |O #gocermed#3 ! #gocerhip#3;
          |ACABA;
     |FINSI;

     #gocerlip@#0 = #gocerhip@#0;
     #gocerlip@#1 = #gocerhip@#1;
     #gocerlip@#2 = #gocerhip@#2;
     |LEE 020#gocerlip@.=;

     #69#0 = #gocerlip@#0;
     #69#1 = #gocerlip@#1;
     #69#2 = #gocerlip@#8;
     #69#3 = #gocerlip@#9;
     #69#4 = #gocerlip@#3;
     #69#5 = #gocerhip@#2;
     #69#6 = #gocerhip@#3;
     #69#7 = #gocerhip@#4;
     #69#8 = #gocerhip@#5;
     #69#9 = #gocerhip@#18;
     #69#10 = #gocerhip@#20;
     #69#11 = #gocerhip@#7;
     #69#12 = #gocerhip@#12;
     |GRABA 020#69n;
     nHay = 1;
|FPRC;

|DEFBUCLE Partidas;
     #gocerhip@#2005;
     ;
     #0#0, #0#1, 001, eaParti, eaCapi;
     #0#0, #0#1, 999, eaParti, eaCapi;
     ;
     NULL, Partidas;
|FIN;

|PROCESO EligeLinea;
     |HAZ CreaTempo; |NOME_DAT #69 Tempo; |DELINDEX #69;
     |ABRE #69;
     |ABRE #60;
     |ABRE #120;
     |ABRE #19;
     |DDEF aDef;
     aAlfa = aDef + "gocerlip";
     |CARGA_DEF aAlfa, gocerlip@;
     |SI FSalida = 0;
          aAlfa = aDef + "gocerhip";
          |CARGA_DEF aAlfa, gocerhip@;
          |SI FSalida = 0;
               aAlfa = aDef + "gocermed";
               |CARGA_DEF aAlfa, gocermed@;
               |SI FSalida = 0;
                    nHay = 0;
                    |ABRE #gocerlip@;
                    |ABRE #gocermed@;
                    |BUCLE Partidas;
                    |CIERRA #gocermed@;
                    |CIERRA #gocerlip@;
                    |SI nHay = 0;
                         |MENAV "0000No hay registros...";
                    |SINO;
                         |ABRE #69;
                         |LEE 000#69p;
                         |CONSULTA_CLAVE #1#69;
                         |SI FSalida = 0;
                              |HAZ CopiaLinea;
                         |FINSI;
                         |CIERRA #69;
                    |FINSI;
                    |DESCARGA_DEF #gocermed@;
               |SINO;
                    |MENAV "0000Error al cargar gocermed";
               |FINSI;
               |DESCARGA_DEF #gocerhip@;
          |SINO;
               |MENAV "0000Error al cargar gocerhip";
          |FINSI;
          |DESCARGA_DEF #gocerlip@;
     |SINO;
          |MENAV "0000Error al cargar gocerlip";
     |FINSI;
     |CIERRA #19;
     |CIERRA #120;
     |CIERRA #60;
     |CIERRA #69;
     |HAZ BoraTempo; |DELINDEX #69;
|FPRC;

|PROCESO CopiaMedi; |TIPO 11;
     |SI FSalida = 14; || F6;
          FSalida = 10;
          eaSerPre = #0#0;
          enNumPre = #0#1;
          eaCapi = "";
          eaParti = "";
          |HAZ GuerPartid;
          nLinea = 0;
          |SI eaParti ! "";
               |HAZ EligeLinea;
          |FINSI;
          |SI nLinea = 0;
               |ERROR;
          |SINO;
               |PONCONTROL 23, "SI";
          |FINSI;
     |FINSI;
|FPRC;
