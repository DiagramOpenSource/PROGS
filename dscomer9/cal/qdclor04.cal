|FICHEROS;
     qdclor04 #0;
     qdclor06 #6;
     qdclor07 #7;
     qdclor08 #8;
     qdclor10 #9;
     agifa010 #10;
     agifa024 #24;
     agifa007 #70;
     agifa071 #71;
     agifa073 #73;
     agifa104 #104;
     tmp00000 #300;
     agifa071@;
|FIN;

|VARIABLES;
     &eaImpre014 = "";
     aInf = "";
     aAlfa = "";
     i = 0;
|FIN;

|PROCESO Imprime;
     |PRINT;
|FPRC;

|DEFBUCLE Boletin;
     #9#1;
     ;
     "V", #71#29, #71#0, #71#1, 001;
     "V", #71#29, #71#0, #71#1, 999;
     ;
     NULL, Imprime;
|FIN;

|PROCESO Lineas;
     |DDEFECTO #8;
     #8#0 = #71#29;
     #8#1 = #71#0;
     #8#2 = #71#1;
     |LEE 000#8=;
     |SI #8#5 = "N"; |ACABA; |FINSI;

     |DDEFECTO #104;
     #104#25 = #71#31;
     #104#0 = #71#12;
     |LEE 000#104=;

     |DDEFECTO #73;
     #73#28 = #71#31;
     #73#0 = #71#12;
     #73#1 = #71#21;
     |LEE 000#73=;

     |DDEFECTO #6;
     #6#0 = #71#31;
     #6#1 = #71#12;
     #6#2 = #71#21;
     |LEE 000#6=;

     |SI #71#2 ] #0#2; |Y #71#2 [ #0#3;
          |PARA i = 0; |SI i [ #24#51; |HACIENDO i = i + 1;
               |BUCLE Boletin;
               |PIEINF;
          |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Llena71;
     |DDEFECTO #8;
     #8#0 = #71#29;
     #8#1 = #71#0;
     #8#2 = #71#1;
     |LEE 000#8=;
     |SI #8#5 = "S";
          |SALVA_DATOS #71;
          |REPON_DATOS #agifa071@;
          |GRABA 020#agifa071@.n;
     |FINSI;
|FPRC;

|DEFBUCLE Llena71;
     #71#1;
     ;
     #0#0, #0#1, 001;
     #0#0, #0#1, 999;
     ;
     NULL, Llena71;
|FIN;

|PROCESO Tipo66; |TIPO 66;
     |DDEF aAlfa;
     aAlfa = aAlfa + "agifa071";
     |CARGA_DEF aAlfa, agifa071@;
     |SI FSalida = 0;
          aAlfa = Usuario;
          |NOME_DAT #agifa071@#aAlfa#; |DELINDEX #agifa071@;
          |ABRE #agifa071@;
          |ABRE #8;
          |BUCLE Llena71;
          |CIERRA #8;
          |LEE 000#agifa071@.p;
          |SI FSalida = 0;
               |CONSULTA_CLAVE #1#agifa071@;
               |SI FSalida = 0;
                    #0Campo = #agifa071@#2; |PINTA #0Campo;
               |SINO;
                    |ERROR;
               |FINSI;
          |SINO;
               |MENAV "0000No hay registros...";
               |ERROR;
          |FINSI;
          |CIERRA #agifa071@;
          |DESCARGA_DEF #agifa071@;
     |FINSI;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |ABRE #70;
     #70#26 = #0#0;
     |LEE 000#70=;
     |CIERRA #70;
     aInf = #70#22; |QBF aInf;
     |SI aInf = ""; aInf = "boletin"; |FINSI;

     |ABRE #10;
     #10#52 = #0#0;
     #10#0 = #0#1;
     |LEE 020#10=;
     |SI FSalida = 0;
          |ABRE #24;
          #24#0 = #10#3;
          |LEE 020#24=;
          |CIERRA #24;
          |SI #24#113 = "N";
               |SI PARAMETRO = ""
                    |CONFI "0000NEl cliente no tiene activo la emisión de análisis. ¿Continuar?";
                    |SI FSalida ! 0; |ACABA; |FINSI;
               |SINO;
                    |ACABA;
               |FINSI;
          |FINSI;

          |SI PARAMETRO = "";
               |IMPRE 0;
          |SINO;
               Impresora = eaImpre014;
               |IMPRE -1;
          |FINSI;
          |SI FSalida = 0;
               |INFOR aInf;
               |SI FSalida = 0;
                    |ABRE #6;
                    |ABRE #7;
                    |ABRE #8;
                    |ABRE #73;
                    |ABRE #104;
                    |BUCLELIN 2 Lineas #10;
                    |CIERRA #104;
                    |CIERRA #73;
                    |CIERRA #8;
                    |CIERRA #7;
                    |CIERRA #6;
                    |FININF;
               |SINO;
                    aAlfa = "0000Error en informe:" + aInf;
                    |MENAV aAlfa;
               |FINSI;
               |FINIMP;
          |FINSI;
     |FINSI;
     |CIERRA #10;
|FPRC;

|PROCESO Temporal;
     |DDEFECTO #0;
     #0#0 = #300#0;
     #0#1 = #300#1;
     |HAZ Tipo3;
|FPRC;

|DEFBUCLE Temporal;
     #300#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Temporal;
|FIN;

|PROGRAMA;
     |SI PARAMETRO = "";
          |MANTE #0;
     |SINO;
          aAlfa = PARAMETRO;
          |NOME_DAT #300 aAlfa;
          |BUCLE Temporal;
     |FINSI;
|FPRO;
