|FICHEROS;
     vipez009 #0;
     vipem018 #18;
     agifa019 #19;
     agifa060 #60;
     dsm00239 #239;
     agifa553 #553;
     agifa065 #65;
|FIN;

|PROCESO PCM;
     |DDEFECTO #65;
     #65#0 = #18#4;
     #65#1 = #18#2;
     #65#2 = "AC";
     |LEE 000#65];
     |SI FSalida = 0; |Y #65#0 = #18#4;
          |PARA; |SI FSalida = 0; |Y #65#0 = #18#4; |HACIENDO;
               |LEE 000#65a;
               |SI FSalida = 0; #65#2 = "AC"; |Y #65#0 = #18#4;
                    #19#9 = #65#8;
                    |SAL;
               |FINSI;
          |SIGUE;
     |FINSI;
|FPRC;

|PROCESO vipem018;
     #19#0 = #18#4;
     |LEE 000#19=;
     |SI #19#125 ] #0#1; |O #19#125 [ #0#2;
          |SI #19#137 = "S";
               |DDEFECTO #239;
               #239#0 = #19#5;
               |LEE 000#239=;

               |DDEFECTO #60;
               #60#0 = #19#2;
               |LEE 000#60=;

               |DDEFECTO #553;
               #553#0 = #19#125;
               |LEE 000#553=;

               #19#9 = 0;     || sustituye el pcm del articulo por el calculado
               |HAZ PCM;

               |PRINT;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE vipem018;
     #18#1;
     3;
     00000001, #0#0;
     99999999, #0#0;
     ;
     NULL, vipem018;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     Impresora = "Crystal Reports";
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "vipez009";
          |SI FSalida = 0;
               |ABRE #19;
               |ABRE #60;
               |ABRE #239;
               |ABRE #553;
               |ABRE #65;
               |BUCLE vipem018;
               |CIERRA #65;
               |CIERRA #553;
               |CIERRA #239;
               |CIERRA #60;
               |CIERRA #19;
               |PIEINF;
               |FININF;
          |SINO;
               |MENAV "0000Error en informe 'vipez009'";
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
