|FICHEROS;
     agifa091;

     ialbm025@;
     gadm0006@;
     caforpag@;
|FIN;

|VARIABLES;
     aAlfa               = "";
     aDef                = "";
     aMas                = "";

     nModo               = 0;
     fin                 = 0;
     i                   = 0;
     cv                  = 0;
     venci               = 0;
     nFor                = 0;
     nNume               = 0;

     &enOk               = 0;
     &eaPathConta        = "";
     &eaFichConta        = "";
|FIN;

|PROCESO vencfpag;|TIPO 0;
     |SI #agifa091#Campo# ! Contenido;
          fin = #agifa091#3 + 1;
          |PARA i = 1;|SI i < fin;|HACIENDO i = i + 1;
               cv = i + 5;
               |SI #agifa091#75 = "S"; |Y i > 1;
                    #agifa091#cv# = #agifa091#6 + #agifa091#4;
               |SINO;
                    venci = i * #agifa091#4;
                    #agifa091#cv# = venci + #agifa091#2;
               |FINSI;
               |PINTA #agifa091#cv#;
          |SIGUE;

          |PARA fin = fin + 5;  |SI fin < 59;|HACIENDO fin = fin + 1;
               #agifa091#fin# = 0;
               |PINTA #agifa091#fin#;
          |SIGUE;
     |FINSI;
|FPRC;

|PROCESO controlv;  |TIPO 0;
     cv = #agifa091#3 + 5;
     |SI Campo > cv;  |Y #agifa091#Campo# ! 0;
         #agifa091#3 = Campo - 5;
         |PINTA #agifa091#3;
     |FINSI;
|FPRC;

|PROCESO UneContagen;
     |SI nModo = 2;
         nFor = +. 1;
         |SI nFor < 0;  |ACABA;  |FINSI;
     |FINSI;

     nNume = #agifa091#0;
     |SI nNume = 0;
         |SI nModo = 1;
             aAlfa = "0000Para unir automaticamente la forma de pago con la ";
             aAlfa = aAlfa + "contabilidad  el codigo a usar deberia ser numerico";
             |MENAV aAlfa;

             |ACABA;
         |FINSI;
     |FINSI;

     aMas = eaPathConta + "def/gadm0006";
     |CARGA_DEF aMas, gadm0006@;
     |SI FSalida ! 0;
         |ACABA;
     |FINSI;

     aMas = eaPathConta + "def/caforpag";
     |CARGA_DEF aMas, caforpag@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #gadm0006@;
         |ACABA;
     |FINSI;

     |PATH_DAT #gadm0006@#eaFichConta#;
     |PATH_DAT #caforpag@#eaFichConta#;

     |ABRE #gadm0006@;
     |ABRE #caforpag@;

     |SI nModo = 1;
         #caforpag@#0 = #agifa091#0;
         |LEE 101#caforpag@.=;
         |SI FSalida ! 0;
             |DDEFECTO #caforpag@;
             #caforpag@#0 = #agifa091#0;
             #caforpag@#1 = #agifa091#1;
             #caforpag@#2 = #agifa091#3;
             #caforpag@#3 = #agifa091#2 + #agifa091#4;
             #caforpag@#4 = #agifa091#4;
             #caforpag@#5 = #agifa091#69;

             |GRABA 020#caforpag@.n;
             |LIBERA #caforpag@;

             #gadm0006@#0 = #agifa091#0;
             |LEE 101#gadm0006@.=;
             |SI FSalida ! 0;
                 |DDEFECTO #gadm0006@;
                 #gadm0006@#0 = #agifa091#0;
                 #gadm0006@#1 = #agifa091#1;
                 #gadm0006@#2 = #agifa091#0;
                 #gadm0006@#3 = #agifa091#1;

                 |GRABA 020#gadm0006@.n;
                 |LIBERA #gadm0006@;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nModo = 2;
         #gadm0006@#0 = #agifa091#0;
         |LEE 101#gadm0006@.=;
         |SI FSalida = 0;
             #caforpag@#0 = #gadm0006@#2;
             |LEE 101#caforpag@.=;
             |SI FSalida = 0;
                 #caforpag@#1 = #agifa091#1;
                 #caforpag@#2 = #agifa091#3;
                 #caforpag@#3 = #agifa091#2 + #agifa091#4;
                 #caforpag@#4 = #agifa091#4;
                 #caforpag@#5 = #agifa091#69;
                 |GRABA 020#caforpag@.a;
                 |LIBERA #caforpag@;
             |FINSI;

             #gadm0006@#1 = #agifa091#1;
             #gadm0006@#3 = #agifa091#1;
             |GRABA 020#gadm0006@.a;
             |LIBERA #gadm0006@;
         |FINSI;
     |FINSI;

     |SI nModo = 3;
         #gadm0006@#0 = #agifa091#0;
         |LEE 101#gadm0006@.=;
         |SI FSalida = 0;
             |BORRA 020#gadm0006@.a;
             |LIBERA #gadm0006@;

             #caforpag@#0 = #gadm0006@#2;
             |LEE 101#caforpag@.=;
             |SI FSalida = 0;
                 |BORRA 020#caforpag@.a;
                 |LIBERA #caforpag@;
             |FINSI;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #caforpag@;
     |DESCARGA_DEF #gadm0006@;
|FPRC;

|PROCESO Tipo91_2; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
          |HAZ EsInforAlba;
          |SI FSalida = 0;
               aAlfa = "ialbm025;" + #agifa091#0 + "BAJA";
               |SUB_EJECUTA_NP aAlfa;
          |FINSI;
     |FINSI;

     |HAZ CargaContagen;
     |SI enOk = 1;
         |HAZ UneContagen;
     |FINSI;
|FPRC;

|PROCESO Tipo91_13; |TIPO 13;
     |HAZ EsInforAlba;
     |SI FSalida = 0;
          |HAZ PinInforAlba;
     |FINSI;

     |HAZ EsOTP;
     |SI FSalida = 0;
          |HAZ PinOTP;
     |FINSI;
|FPRC;

|PROCESO Tipo7C74;  |TIPO 7;
     |HAZ EsOTP;
     |SI FSalida = 0;
         |MENSA "0000Se emite el anexo IV en contratos: <S> SI  <N>  NO";
     |SINO;
         |MENSA "0000Fecha vencimientos: <F> Fecha factura,    <A> Fecha media de los albaranes";
     |FINSI;
|FPRC;

|PROCESO Tipo0C74;  |TIPO 0;
     |HAZ EsOTP;
     |SI FSalida = 0;
         |SI #agifa091#74 = "F";  |O #agifa091#74 = "A";
             |ERROR;
         |FINSI;
     |SINO;
         |SI #agifa091#74 = "S";  |O #agifa091#74 = "N";
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO MesDias; |TIPO 0;
     |HAZ EsInforAlba;
     |SI FSalida = 0;
          aAlfa = "ialbm025;" + #agifa091#0 + "ALTA";
          |SUB_EJECUTA_NP aAlfa;
          |HAZ PinInforAlba;
     |FINSI;
|FPRC;

|PROCESO PinInforAlba;
     |PINTA 757, "Reembolso S/N...:";
     |ATRI I;
     |PINTA 767, "S";
     |PINTA 769, "N";
     |ATRI 0;
     |DDEF aDef;
     aMas = aDef + "ialbm025";
     |CARGA_DEF aMas, ialbm025@;
     |SI FSalida = 0;
          |DDEFECTO #ialbm025@;
          |ABRE #ialbm025@;
          #ialbm025@#0 = #agifa091#0;
          |LEE 000#ialbm025@.=;
          |CIERRA #ialbm025@;
          |ATRI I;
          |PINTA 775, #ialbm025@#1;
          |ATRI 0;
          |DESCARGA_DEF #ialbm025@;
     |FINSI;
|FPRC;

|PROCESO PinOTP;
     |PINTA 757,  "Anexo IV ctos. .:";
     |PINTA 1306, "                                           ";

     |SI #agifa091#74 = "F";  |O #agifa091#74 = "A";
         #agifa091#74 = "N";
     |FINSI;

     |C_P #agifa091#74, 1, 775;   |PINTA #agifa091#74;
|FPRC;
