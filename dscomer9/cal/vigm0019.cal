|FICHEROS;
     vigm0019 #0;
     vigm0020 #1;
     vigm0002 #2;
     vigm0001 #10;
     vigm0028 #28;
     agifa017 #17;
     agifa019 #19;
|FIN;

|VARIABLES;
     &eaSer = "";
     &enOrd = 0;
     aAlfa = "";
     nModo = 0;
     aSer = "";
     nConta = 0;
     nForma = 0;
     nHayEntra = 0;
|FIN;

|PROCESO Contador; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          aSer = #0#20;
          #0#0 = 999999;
          |LEE 000#0];
          |SI FSalida = 0;
               |LEE 000#0a;
          |SINO;
               |LEE 000#0u;
          |FINSI;
          |SI FSalida = 0; |Y aSer = #0#20;
               nConta = #0#0 + 1;
          |SINO;
               nConta = 1;
          |FINSI;
          |DDEFECTO #0;
          #0#20 = aSer;
          #0#0 = nConta;
     |FINSI;
|FPRC;

|PROCESO Terminado; |TIPO 0;
     |ABRE #10;
     #10#0 = #1#2;
     |LEE 000#10=;
     |SI FSalida ! 0;
          |MENAV "0000Auxiliar Articulo inexistente...";
          |ERROR; |ACABA;
     |FINSI;
     |CIERRA #10;

     |ABRE #2;
     #2#0 = #10#3;
     |LEE 000#2=;
     |SI FSalida ! 0;
          aAlfa = "0000Formula Inexistente. Pienso:" + #10#3;
          |MENAV aAlfa;
          |ERROR; |ACABA;
     |FINSI;
     |CIERRA #2;

     |SI #10#6 = "N";
          #1#9 = "S";
     |SINO;
          #1#9 = "N";
     |FINSI;
     |PINTA #1#9;

     #1#10 = #2#1; |PINTA #1#10;

     aAlfa = #1#10; |QBF aAlfa;
     |SI aAlfa = "";
          |MENAV "0000Pienso no indicado en la formula...";
          |ERROR; |ACABA;
     |FINSI;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |CONFI "0000NImprimir Orden?";
     |SI FSalida = 0;
          |HAZ Tipo4;
     |FINSI;
|FPRC;

|PROCESO T19_4; |TIPO 4;
     |SELECT #1#0;
     |LEE 000#0=;
     |SI FSalida ! 0;
          |MENAV "0000Por favor, consulte el registro correcto antes de imprimir.";
          |ACABA;
     |SINO;
          |PINDA #0#0;
          FEntrada = 402;
     |FINSI;
     |HAZ Tipo4;
|FPRC;

|PROCESO Tipo4;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1; |O nModo = 2;
          |GRABA 020#0a;
          |LIBERA #0;
     |FINSI;
     |CIERRAT #0;
     eaSer = #0#20;
     enOrd = #0#0;
     |SUB_EJECUTA_NP "vigz0026";
     |ABRET #0;
     |LEE 000#0=;
|FPRC;

|PROCESO Min28;
     #28#0 = #1#7;
     #28#1 = #1#0;
     #28#2 = #1#1;
     #28#3 = 1;
|FPRC;

|PROCESO Max28;
     #28#0 = #1#7;
     #28#1 = #1#0;
     #28#2 = #1#1;
     #28#3 = 999;
|FPRC;

|PROCESO Tipo11; |TIPO 11;
     |SI FSalida = 13;
          |PUSHV 0501 2380;
          |ENTLINEAL #1#28, 4, 4, 22, 1, Min28, Max28;
          |POPV;
     |FINSI;
|FPRC;

|PROCESO MiraEntra;
     |SI #1#11 = "S"; |O #1#5 ! 0;
          nHayEntra = 1;
     |FINSI;
|FPRC;

|PROCESO Tipo2; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
          nHayEntra = 0;
          |BUCLELIN 2MiraEntra#0;
          |SI nHayEntra ! 0;
               |MENAV "0000Hay entradas de producto...";
               |ERROR; |ACABA;
          |FINSI;
     |FINSI;

|FPRC;

|PROCESO Tipo2Lin; |TIPO 2;
     nForma = 0 +. 1;
     |SI #1#11 = "S"; |O #1#5 ! 0;
          |SI nForma = -1;
               |MENAV "0000Hay entradas de producto...";
          |FINSI;
          |ERROR; |ACABA;
     |FINSI;
     |ABRE #19;
     |ABRE #17;
     |DDEFECTO #17;
     |DDEFECTO #19;
     #19#0 = #1#2;
     |LEE 101#19=;
     |SI FSalida ! 0; |GRABA 020#19b; |FINSI;
     #17#0 = #1#2;
     #17#1 = #1#6;
     |LEE 101#17=;
     |SI FSalida ! 0; |GRABA 020#17b; |FINSI;
     #19#13 = #19#13 +. #1#4;
     #17#9 = #17#9 +. #1#4;
     |HAZ ValoraStock;
     |GRABA 020#17a;
     |GRABA 020#19a;
     |CIERRA #17;
     |CIERRA #19;
|FPRC;
