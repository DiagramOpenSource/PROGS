|FICHEROS;
     goclipon #0;
     agifa142 #1;
     agifa027 #2;
     agifa024 #12;
|FIN;
----------------------------------------------------------------------
|VARIABLES;
     &eaPais = "";
     modo      = 0;
     contador  = 0;

     cont      = "";
     alfa      = "";

     {-1}menu  = "";
     menu1     = "2400";
     menu2     = "1";
     menu3     = "Contador:  ";
     menu4     = "AM";
     menu5     = " Automatico ";
     menu6     = " Manual ";
     CampoDni   = "";
     Letra1     = "";
     Letra2     = "";
     Letra3     = "";
     Letra4     = "";
     Letra5     = "";
     Letra6     = "";
     Letra7     = "";
     Letra8     = "";
     Caracter   = "";
     Carac1     = 0;
     Carac2     = 0;
     Carac3     = 0;
     Carac4     = 0;
     Carac5     = 0;
     XPara      = 0;

     aNifQbf1   = "";
     aNifQbf2   = "";

     &eaVarDni  = "";
     &enCalcCif = 0;
|FIN;
----------------------------------------------------------------------
|PROCESO Alta; |TIPO 7;
     |ABRE #agifa142; |LEE 001#agifa142.p; |CIERRA #agifa142;
     modo = (FEntrada / 100) ! 0;
     |SI modo = 1;
          |HAZ Menus;
     |FINSI;
|FPRC;
----------------------------------------------------------------------
|RUTINA Menus;
     |MENU menu;
     |SI FSalida = 1;    ||Automatico
          |ABRE #2;
          #2#0 = "cliepote";
          |LEE 101#2=;
          |SI FSalida = 0;
               #2#1 = #2#1 + 1;
               contador = #2#1;
               |GRABA 021#2a;
          |SINO;
               contador = 1;
               #2#1 = 1;
               |GRABA 021#2n;
          |FINSI;
          cont = contador;
          cont = ("000000" + cont) % -106;
          #0#0 = cont;
          |PINTA #0#0;
          |LIBERA #2;
          |CIERRA #2;
     |FINSI;
|FRUT;
----------------------------------------------------------------------
|PROCESO Duplicar; |TIPO 0;
     |SI #1#160 ! "S"; |ACABA; |FINSI;
     |ABRE #12;
     |SELECT #4#12;
     #12#15 = #0#1;
     |LEE 000#12=;
     |SI FSalida = 0; |Y #12#0 ! #0#0;
          |PUSHV 0501 2380;
          |AVISO;
          |COLOR 0, 0; |ATRI r;
          |BLANCO 0810 1270;
          |COLOR 4, 0; |ATRI R;
          |D_CUADRO 0810,1270;
          |PINTA 0925, alfa;
           alfa = "Existe Con Codigo "+#12#0 + " en clientes Generales";
          |PINTA 1018, alfa;
          |ATRI 0;
          |PAUSA;
          |POPV;
     |FINSI;
     |CIERRA #12;
|FPRC;
----------------------------------------------------------------------
|PROCESO letra;
     eaPais = #0#14;
     |SI FSalida = 9;
         eaVarDni   = #0Campo;
         enCalcCif  = 1;
         |HAZ CalculoNIFCIF;
         #0Campo = eaVarDni;
         |PINTA #0Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #0Campo;
     enCalcCif = 0;
     |HAZ CalculoNIFCIF;
     aNifQbf1 = #0Campo;   |QBF aNifQbf1;
     aNifQbf2 = eaVarDni;  |QBF aNifQbf2;

     |SI aNifQbf1 ! aNifQbf2; |Y aNifQbf1 ! "";
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #0Campo = eaVarDni;  |PINTA #0Campo;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;
