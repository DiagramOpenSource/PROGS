|FICHEROS;
     con0g003 #0;
     agifa007 #7;
     agifa027 #27;
     con00601 #601; ||Vehiculos
     con00606 #606;
     con00625 #625;
     con00626 #626;
|FIN;

|VARIABLES;
     nPendiente = 0;
     aMensaje = "";
     &eaSerGarantia = "";
     &enNumGarantia = 0;

     {-1}Menu = "";
     Menu1 = "2400";
     Menu2 = "1";
     Menu3 = "Contador:  ";
     Menu4 = "AM";
     Menu5 = " Automatico ";
     Menu6 = " Manual ";
     nConta = 0;
     nModo = 0;

     aAlfa1 = "";

     {-1}aDato = "";
     aDato1 = "2400";
     aDato2 = "1";
     aDato3 = "Seleccion: ";
     aDato4 = "EI";
     aDato5 = "Exportacion";
     aDato6 = "Imprimir";
|FIN;

|PROCESO Tipo13; |TIPO 13;
     |HAZ TallerDeci;
     |ABRE #7;
     #7#26 = #0#37;
     |LEE 000#7=;
     |SI FSalida = 0; |Y #7#48 = "S";
          |C_V #0#12, 1, "S"; |PINTA #0#12;
          |C_V #0#38, 1, "S"; |PINTA #0#38;
          |C_V #0#43, 1, "S"; |PINTA #0#43;
          |C_V #0#44, 1, "S"; |PINTA #0#44;
          |PINTA 1007, "Exportado:              ";
          |PINTA 1037, "Factura IVECO:          Cobrada S/N:";
     |SINO;
          |C_V #0#12, 1, "N";
          |C_V #0#38, 1, "N";
          |C_V #0#43, 1, "N";
          |C_V #0#44, 1, "N";
          |PINTA 1007, "                                                                    ";
     |FINSI;
     |PINTA 1106, "ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´";
     |CIERRA #7;
|FPRC;

|PROCESO Conta; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |MENU Menu;
          |SI FSalida = 1;
               |ABRE #27;
               #27#2 = #0#37;
               #27#0 = "garantia";
               |LEE 101#27=;
               |SI FSalida = 0;
                    nConta = #27#1;
                    #27#1 = #27#1 + 1;
                    |GRABA 020#27a;
               |SINO;
                    nConta = 1;
                    #27#1 = 2;
                    |GRABA 020#27n;
               |FINSI;
               |CIERRA #27;
               #0#0 = nConta;
               |PTEC 802;
          |FINSI;
          |HAZ Tipo13;
     |FINSI;
|FPRC;

|PROCESO Orden; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;

          |ABRE #625;
          #625#0 = #0#2;
          #625#1 = #0#3;
          |LEE 020#625=;
          |CIERRA #625;

          #0#4 = #625#3; |PINTA #0#4;
          #0#7 = #625#2; |PINTA #0#7;
          #0#8 = #625#40; |PINTA #0#40;
          #0#39 = #625#41; |PINTA #0#39;
          #0#40 = #625#42; |PINTA #0#40;
          #0#41 = #625#43; |PINTA #0#41;
          #0#42 = #625#44; |PINTA #0#42;
          #0#6 = #625#5; |PINTA #0#6;

          |ABRE #601;
          #601#0 = #0#4;
          |LEE 000#601=;
          |CIERRA #601;
          #0#5 = #601#11; |PINTA #0#5;
     |FINSI;
|FPRC;

|PROCESO ModiOrd; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 2;
          |C_M #0#2, 1, "N";
          |C_M #0#3, 1, "N";
     |SINO;
          |C_M #0#2, 1, "S";
          |C_M #0#3, 1, "S";
     |FINSI;
|FPRC,

|PROCESO Tipo20; |TIPO 20;
     aAlfa1 = FSalida;
     |SI aAlfa1 = "OPCION";
         FSalida = "Opciones";
         |ACABA;
     |FINSI;

     |SELECT #1#0;
     |LEE 101#0=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PARA;  |SI;  |HACIENDO;
          |MENU aDato;
          aDato2 = FSalida;
          |SI aDato2 = "1";  |HAZ menuexportar;  |FINSI;
          |SI aDato2 = "2";  |HAZ menuimpre;  |FINSI;
          |SI aDato2 < "1"; |O aDato2 > "2";  |SAL;  |FINSI;
     |SIGUE;
     |LIBERA #0;
|FPRC;

|PROCESO menuexportar;
     |ABRE #7;
     #7#26 = #0#37;
     |LEE 020#7=;
     |SI FSalida = 0; |Y #7#48 = "S";
          |SI #0#12 = "SI";
               |MENAV "0000Garantia ya exportada...";
          |SINO;
               |HAZ Exporta;
          |FINSI;
     |SINO;
          |MENAV "0000La serie no es de exportacion..";
     |FINSI;
     |CIERRA #7;
|FPRC;

|PROCESO Chequea;
     |SI #626#28 = -1;   || Linea Canon
          |ACABA;
     |FINSI;

     |SI #626#14 ! "G";  || No es Garantia
          |ACABA;
     |FINSI;

     |SI #626#30 = "S";  || Desprecia
          |ACABA;
     |FINSI;

     |SI #626#11 ] 1; |Y #626#11 [ 999;     ||Mano Obra
          |SI #626#33 = 0;
               nPendiente = 1;
          |FINSI;
     |FINSI;
     |SI #626#11 ] 1000; |Y #626#11 [ 1999;     ||Materiales (pieza)
          |SI #626#33 = 0;
               nPendiente = 1;
          |FINSI;
     |FINSI;
     |SI #626#11 ] 3000; |Y #626#11 [ 3999;     ||Materiales (lubri)
          |SI #626#33 = 0;
               nPendiente = 1;
          |FINSI;
     |FINSI;
     |SI #626#11 ] 2000; |Y #626#11 [ 2999;     ||Externo
          |SI #626#33 = 0;
               nPendiente = 1;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE Chequea;
     #626#1;
     ;
     #0#2, #0#3, 0001;
     #0#2, #0#3, 9999;
     ;
     NULL, Chequea;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     nPendiente = 0;
     |BUCLE Chequea;
     |SI nPendiente ! 0;
          |MENAV "0000Quedan líneas pendientes de asignar en Garantía...";
     |FINSI;

     |HAZ menuimpre;
|FPRC,

|PROCESO menuimpre;
     |CONFI "0000N¿Imprimir garantia?";
     |SI FSalida = 0;
          eaSerGarantia = #con0g003#37;
          enNumGarantia = #con0g003#0;
          |SUB_EJECUTA_NP "conz0009;AUTO";
     |FINSI;
|FPRC;
