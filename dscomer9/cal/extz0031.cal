|FICHEROS;
     agifa010 #10;
     extw0008 #8;   ||Tmp Alb agrupa
     extm0013 #13;
     agifa071 #71;
|FIN;

|VARIABLES;
     &eaTmpExtintor = "";
     &Tempo = "";
     aTmp8 = "";
     aAlfa = "";
     aParam = "";
     aSer = "";
     aNum = "";
     nSwBorra = 0;
     i = 0;
|FIN;

|PROCESO LinAlb;
     #8#29 = #71#29;
     #8#0 = #71#0;
     #8#2 = #71#2;
     #8#6 = #71#6;
     #8#8 = #71#8;
     #8#33 = #71#33;
     |LEE 101#8=;
     |SI FSalida = 0;
          #8#5 = #8#5 + #71#5;
          #8#7 = #8#7 + #71#7;
          #8#9 = #8#9 + #71#9;
          #8#14 = #8#14 + #71#14;
          #8#37 = #8#37 + #71#37;
          #8#39 = #8#39 + #71#39;
          |GRABA 020#8a;
          |LIBERA #8;
     |SINO;
          |PARA i = 0; |SI i [ 66; |HACIENDO i = i + 1;
               #8i = #71i;
          |SIGUE;
          |GRABA 020#8n;
     |FINSI;
|FPRC;

|DEFBUCLE LinAlb;
     #71#1;
     ;
     #13#14, #13#15, 001;
     #13#14, #13#15, 999;
     ;
     NULL, LinAlb;
|FIN;

|PROCESO Tmp;
     |PARA i = 0; |SI i [ 66; |HACIENDO i = i + 1;
          #71i = #8i;
     |SIGUE;
     |GRABA 020#71n;
|FPRC

|DEFBUCLE Tmp;
     #8#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp;
|FIN;

|PROGRAMA;
     aParam = PARAMETRO;
     aAlfa = aParam % 105;
     |SI aAlfa = "BORRA";
          nSwBorra = 1;
          aSer = aParam % 605;
          aNum = aParam % 1106;
          Tempo = aParam % 17;
     |SINO;
          nSwBorra = 0;
          aSer = aParam % 105;
          aNum = aParam % 6;
     |FINSI;

     |ABRE #13;
     |SELECT #4#13;
     #13#14 = aSer;
     #13#15 = aNum;
     |LEE 000#13=;
     |SI FSalida = 0;
          |SI nSwBorra = 1;
               |HAZ BoraTempo;
               |NOME_DAT #71 eaTmpExtintor; |DELINDEX #71;
          |SINO;
               |HAZ CreaTempo; eaTmpExtintor = Tempo;
               |HAZ CreaTempo; aTmp8 = Tempo;
               |NOME_DAT #8 Tempo; |DELINDEX #8;

               |ABRE #8;
               |BUCLE LinAlb;
               |CIERRA #8;

               |NOME_DAT #71 eaTmpExtintor;
               |ABRE #71;
               |BUCLE Tmp;
               |CIERRA #71;

               Tempo = aTmp8; |HAZ BoraTempo; |DELINDEX #8;
          |FINSI;
     |SINO;
          eaTmpExtintor = "agifa071";
     |FINSI;
     |CIERRA #13;
|FPRO;
