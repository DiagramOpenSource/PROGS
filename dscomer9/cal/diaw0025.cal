|FICHEROS;
     diaw0025 #0;
     agifa146 #146,MANTE;
     diaw0025@;
|FIN;

|VARIABLES;
     &eaSerie = "";
     &enCodigo = 0;
     aAlfa = "";
     nHay = 0;
     nPrime = 0;
|FIN;

|PROCESO Tecla; |TIPO 0;
     |SI #0Campo = Contenido; |Y FSalida = 0;
          |ABRE #146;
          #146#48 = #0#0;
          #146#0 = #0#1;
          |LEE 020#146=;
          |SI FSalida = 0;
               |PUSHV 0501 2380;
               |PINPA #0#146;
               |PINDA #0#146;
               |ENDATOS #4#146;
               |POPV;
          |FINSI;
          |CIERRA #146;
     |FINSI;
|FPRC;

|PROCESO LlenaTmp;
     #0#0 = #146#48;
     #0#1 = #146#0;
     #0#2 = #146#1;
     #0#3 = #146#3;
     #0#4 = #146#4;
     #0#5 = "N";
     |GRABA 000#0n;
     |SI FSalida = 0;
          nHay = 1;
          nPrime = 1;
     |FINSI;
|FPRC;

|DEFBUCLE Llena4;
     #146#4;
     ;
     eaSerie, enCodigo;
     eaSerie, enCodigo;
     ;
     NULL, LlenaTmp;
|FIN;

|PROCESO Tmp;
     eaSerie = #0#0;
     enCodigo = #0#1;
     #0#5 = "S";
     |GRABA 020#0a;

     |SALVA_FICHA #0;
     #146#48 = #0#0;
     #146#0 = #0#1;
     |LEE 000#146=;
     |SI FSalida = 0;
          eaSerie = #146#48;
          enCodigo = #146#0;
          |SALVA_FICHA #146;
          |BUCLE Llena4;
          |REPON_FICHA #146;
          eaSerie = #146#89;
          enCodigo = #146#90;
          |SI #146#90 ! 0;
               #146#48 = #146#89;
               #146#0 = #146#90;
               |LEE 000#146=;
               |SI FSalida = 0;
                    |HAZ LlenaTmp;
               |FINSI;
               |BUCLE Llena4;
          |FINSI;
     |FINSI;
     |REPON_FICHA #0;
|FPRC;

|DEFBUCLE Tmp;
     #0#1;
     5;
     "     ", 000001, "N";
     "zzzzz", 999999, "N";
     ;
     NULL, Tmp;
|FIN;

|PROCESO Min;
     #0#0 = "     ";
     #0#1 = 1;
|FPRC;

|PROCESO Max;
     #0#0 = "zzzzz";
     #0#1 = 999999;
|FPRC;

|PROGRAMA;
     aAlfa = Usuario;
     |NOME_DAT #0 aAlfa; |DELINDEX #0;
     |ABRET #0;
     |ABRET #146;

     #146#48 = eaSerie;
     #146#0 = enCodigo;
     |LEE 000#146=;
     |SI FSalida = 0;
          |HAZ LlenaTmp;
          |SI #146#90 ! 0;
               #146#48 = #146#89;
               #146#0 = #146#90;
               |LEE 000#146=;
               |SI FSalida = 0;
                    |HAZ LlenaTmp;
               |FINSI;
          |FINSI;
     |FINSI;

     |DDEF aAlfa;
     aAlfa = aAlfa + "agifa146";
     |CARGA_DEF aAlfa, diaw0025@;
     |SI FSalida = 0;
          aAlfa = Usuario; |NOME_DAT #diaw0025@#aAlfa#;
          |PARA; |SI nHay ! 0; |HACIENDO;
               nHay = 0;
               |BUCLE Tmp;
          |SIGUE;
          |DESCARGA_DEF #diaw0025@;
     |FINSI;

     |CIERRAT #0;
     |CIERRAT #146;

     |SI nPrime = 0;
          |MENAV "0000No existen proformas...";
     |SINO;
          |ENTLINEAL #1#0, 1, 4, 22, 1, Min, Max;
     |FINSI;
     |DELINDEX #0;
|FPRO;
