|FICHEROS;
     con00906 #0;
     agifa019 #19;
|FIN;

|VARIABLES;
     &eaFichero = "";
     &eaTag = "";
     &eaVal = "";
     &eaGrupo = "";
     aFecha = "";
     aRuta = "";
     aAlfa = "";
     nHandle = 0;
     nLin = 0;
     aLon = "";
     aCar = "";
     aPath = "";
     nPos = 0;
     i = 0;
|FIN;

|PROCESO CambiaBarra;
     aAlfa = "";
     aLon = aPath % A0;
     |PARA i = 1; |SI i [ aLon; |HACIENDO i = i + 1;
          nPos = i * 100 + 1;
          aCar = aPath % nPos;
          |SI aCar = "/"; aCar = "\"; |FINSI;
          aAlfa = aAlfa + aCar;
     |SIGUE;
     aPath = aAlfa;
|FPRC;

|PROCESO Articulos;
     |SI #19#6 > 0;
          nLin = nLin + 1;
          eaTag = "Item line=" + &34 + (("0000"+nLin)%-104) + &34; eaGrupo = "S"; |HAZ XmlTag;
          eaTag = "Code"; eaVal = #19#0; |HAZ XmlTag;
          eaTag = "QuantityAvailable date=" + &34 + aFecha + &34; eaVal = #19#6; |HAZ XmlTag;
          eaTag = "QuantityTodDeliver"; eaVal = ""; |HAZ XmlTag;
          eaTag = "Comment"; eaVal = ""; |HAZ XmlTag;
          eaGrupo = "N"; |HAZ XmlTag;
     |FINSI;
|FPRC;

|DEFBUCLE Articulos;
     #19#1;
     27;
     "                    ", #0#4;
     "zzzzzzzzzzzzzzzzzzzz", #0#4;
     ;
     NULL, Articulos;
|FIN;

|PROCESO T3; |TIPO 3;
     aFecha = (#0#3%704)+(#0#3%402)+(#0#3%102);

     |DFICE aAlfa;
     eaFichero = aAlfa + Usuario;
     |HAZ XmlIni;
     eaTag = "Isearch version=" + &34 + "2.0" + &34; eaGrupo = "S"; |HAZ XmlTag;
     eaTag = "PartnerLogin"; eaVal = #0#6; |HAZ XmlTag;
     eaTag = "PartnerPassword"; eaVal = #0#7; |HAZ XmlTag;
     eaTag = "ContactName"; eaVal = #0#8; |HAZ XmlTag;
     eaTag = "ContactPhone"; eaVal = #0#9; |HAZ XmlTag;
     eaTag = "ContactFax"; eaVal = #0#10; |HAZ XmlTag;
     eaTag = "ContactEmail confirm=" + &34 + "true" + &34; eaVal = #0#11; |HAZ XmlTag;
     eaTag = "Items"; eaGrupo = "S"; |HAZ XmlTag;
     |BUCLE Articulos;
     |HAZ XmlFin;

     aPath = #0#1; |QBF aPath;
     aPath = aPath + "/" + #0#2; |QBF aPath;
     |ENVIA_FICHERO eaFichero, aPath;

     |HAZ CambiaBarra;

     aAlfa = "cmd " + &34 + " /c START /WAIT " + aPath + &34;
     ||RSYSTEM aAlfa;
|FPRC;

|PROCESO Browse; |TIPO 0;
     |SI FSalida ! 13; |ACABA; |FINSI;

     aRuta = "D*.*";

     |BROWSE aRuta;

     aRuta = aRuta % 2; |QBF aRuta;
     |SI aRuta = "D"; aRuta = ""; |FINSI;

     |QBF aRuta;
     |SI aRuta = "";
          |ERROR;
     |SINO;
          #0Campo = aRuta;
          |PINTA #0Campo;
     |FINSI;
|FPRC;

|PROGRAMA;
     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
     #0#3 = ~;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0; |GRABA 020#0a; |FINSI;
     |CIERRA #0;
|FPRO;
