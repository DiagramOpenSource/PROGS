|FICHEROS;
     juminf19 #0;
     juminf09 #9;
     juminf13 #13;
|FIN;

|VARIABLES;
     &enPinta = 0;
     &enTipo = 0;
     &eaM1 = "";
     &eaM2 = "";
     &eaM3 = "";
     &enD11 = 0;
     &enD12 = 0;
     &enD13 = 0;
     &enD14 = 0;
     &enD15 = 0;
     &enD16 = 0;
     &enD17 = 0;
     &enD21 = 0;
     &enD22 = 0;
     &enD23 = 0;
     &enD24 = 0;
     &enD25 = 0;
     &enD26 = 0;
     &enD27 = 0;
     &enD31 = 0;
     &enD32 = 0;
     &enD33 = 0;
     &enD34 = 0;
     &enD35 = 0;
     &enD36 = 0;
     &enD37 = 0;
     &enC11 = 0;
     &enC12 = 0;
     &enC13 = 0;
     &enC14 = 0;
     &enC15 = 0;
     &enC16 = 0;
     &enC17 = 0;
     &enC21 = 0;
     &enC22 = 0;
     &enC23 = 0;
     &enC24 = 0;
     &enC25 = 0;
     &enC26 = 0;
     &enC27 = 0;
     &enC31 = 0;
     &enC32 = 0;
     &enC33 = 0;
     &enC34 = 0;
     &enC35 = 0;
     &enC36 = 0;
     &enC37 = 0;
     nColor = 0;
     aAlfa = "";
     nNume = 0;
     ff = @;
     f = @;
     f1 = @;
     f2 = @;
     f3 = @;
     i = 0;
     j = 0;
     nMes1 = 0;
     nMes2 = 0;
     nMes3 = 0;
     nAno1 = 0;
     nAno2 = 0;
     nAno3 = 0;
     aMesI = "";
     aMesF = "";
     aAnoI = "";
     aAnoF = "";
     x1 = @;
     x2 = @;
     x3 = @;
     fa = @;
     fb = @;
     nDia = 0;
     aMes = "";
|FIN;

|PROCESO Color;
     nColor = 0;
     #13#0 = #0#0;
     #13#1 = #0#1;
     #13#5 = f;
     |LEE 000#13=;
     |SI FSalida = 0;
          nColor = 0;
          |PARA; |SI FSalida = 0; |Y #13#0 = #0#0; |Y #13#1 = #0#1;
                    |Y #13#5 = f; |HACIENDO;
               |SI #13#6 = "S";
                    |SI nColor = 0;
                         nColor = 2;
                    |SINO;
                         nColor = 3;
                    |FINSI;
               |FINSI;
               |LEE 000#13s;
          |SIGUE;
     |SINO;
          nColor = 1;
     |FINSI;
|FPRC;

|PROCESO DiaDelMes;
     f = fa % A0; aMes = f % 1103;
     f = fb % A0; aAlfa = f % 1103;
     |SI aAlfa = aMes;
          aAlfa = fa % 102
          nDia = aAlfa;
     |SINO;
          nDia = 0
     |FINSI;
|FPRC;

|PROCESO Lunes;
     |PARA; |SI; |HACIENDO;
          ff = f % A1;
          aAlfa = ff % 1101;
          |SI aAlfa = "L"; |SAL; |FINSI;
          nNume = f; nNume = nNume - 1; f = nNume;
     |SIGUE;
|FPRC;

|PROCESO Titulos;
     f = f1 % A0; eaM1 = (f % 1103) + "-" + (f1 % -102);
     f = f2 % A0; eaM2 = (f % 1103) + "-" + (f2 % -102);
     f = f3 % A0; eaM3 = (f % 1103) + "-" + (f3 % -102);
     enTipo = 0; |PRINT;
|FPRC;

|PROCESO Impre;
     aMesI = #9#10 % 402;
     aAnoI = #9#10 % 704;
     aMesF = #9#11 % 402;
     aAnoF = #9#11 % 704;

     nAno1 = aAnoI; nAno2 = aAnoI; nAno3 = aAnoI;
     nMes1 = aMesI;

     nMes2 = nMes1 + 1;
     |SI nMes2 > 12; nMes2 = 1; nAno2 = nAno1 + 1; nAno3 = nAno2; |FINSI;
     nMes3 = nMes2 + 1;
     |SI nMes3 > 12; nMes3 = 1; nAno3 = nAno3 + 1; |FINSI;

     |PARA; |SI; |HACIENDO;
          aAlfa = "01." + (("00" + nMes1) % -102) + "." + (("0000" + nAno1) % -104);
          f1 = aAlfa;
          aAlfa = "01." + (("00" + nMes2) % -102) + "." + (("0000" + nAno2) % -104);
          f2 = aAlfa;
          aAlfa = "01." + (("00" + nMes3) % -102) + "." + (("0000" + nAno3) % -104);
          f3 = aAlfa;
          |HAZ Titulos;
          f = f1; |HAZ Lunes; x1 = f;
          f = f2; |HAZ Lunes; x2 = f;
          f = f3; |HAZ Lunes; x3 = f;
          enPinta = 0;
          |SI x3 > #9#11; enPinta = 1; |FINSI;
          |SI x2 > #9#11; enPinta = 2; |FINSI;
          |PARA i = 1; |SI i [ 7; |HACIENDO i = i + 1;
               |PARA j = 1; |SI j [ 7; |HACIENDO j = j + 1;
                    |SI j = 1;
                         fa = x1; fb = f1; |HAZ DiaDelMes; enD11 = nDia;
                         fa = x2; fb = f2; |HAZ DiaDelMes; enD21 = nDia;
                         fa = x3; fb = f3; |HAZ DiaDelMes; enD31 = nDia;
                         f = x1; |HAZ Color; enC11 = nColor;
                         f = x2; |HAZ Color; enC21 = nColor;
                         f = x3; |HAZ Color; enC31 = nColor;
                    |FINSI;
                    |SI j = 2;
                         fa = x1; fb = f1; |HAZ DiaDelMes; enD12 = nDia;
                         fa = x2; fb = f2; |HAZ DiaDelMes; enD22 = nDia;
                         fa = x3; fb = f3; |HAZ DiaDelMes; enD32 = nDia;
                         f = x1; |HAZ Color; enC12 = nColor;
                         f = x2; |HAZ Color; enC22 = nColor;
                         f = x3; |HAZ Color; enC32 = nColor;
                    |FINSI;
                    |SI j = 3;
                         fa = x1; fb = f1; |HAZ DiaDelMes; enD13 = nDia;
                         fa = x2; fb = f2; |HAZ DiaDelMes; enD23 = nDia;
                         fa = x3; fb = f3; |HAZ DiaDelMes; enD33 = nDia;
                         f = x1; |HAZ Color; enC13 = nColor;
                         f = x2; |HAZ Color; enC23 = nColor;
                         f = x3; |HAZ Color; enC33 = nColor;
                    |FINSI;
                    |SI j = 4;
                         fa = x1; fb = f1; |HAZ DiaDelMes; enD14 = nDia;
                         fa = x2; fb = f2; |HAZ DiaDelMes; enD24 = nDia;
                         fa = x3; fb = f3; |HAZ DiaDelMes; enD34 = nDia;
                         f = x1; |HAZ Color; enC14 = nColor;
                         f = x2; |HAZ Color; enC24 = nColor;
                         f = x3; |HAZ Color; enC34 = nColor;
                    |FINSI;
                    |SI j = 5;
                         fa = x1; fb = f1; |HAZ DiaDelMes; enD15 = nDia;
                         fa = x2; fb = f2; |HAZ DiaDelMes; enD25 = nDia;
                         fa = x3; fb = f3; |HAZ DiaDelMes; enD35 = nDia;
                         f = x1; |HAZ Color; enC15 = nColor;
                         f = x2; |HAZ Color; enC25 = nColor;
                         f = x3; |HAZ Color; enC35 = nColor;
                    |FINSI;
                    |SI j = 6;
                         fa = x1; fb = f1; |HAZ DiaDelMes; enD16 = nDia;
                         fa = x2; fb = f2; |HAZ DiaDelMes; enD26 = nDia;
                         fa = x3; fb = f3; |HAZ DiaDelMes; enD36 = nDia;
                         f = x1; |HAZ Color; enC16 = nColor;
                         f = x2; |HAZ Color; enC26 = nColor;
                         f = x3; |HAZ Color; enC36 = nColor;
                    |FINSI;
                    |SI j = 7;
                         fa = x1; fb = f1; |HAZ DiaDelMes; enD17 = nDia;
                         fa = x2; fb = f2; |HAZ DiaDelMes; enD27 = nDia;
                         fa = x3; fb = f3; |HAZ DiaDelMes; enD37 = nDia;
                         f = x1; |HAZ Color; enC17 = nColor;
                         f = x2; |HAZ Color; enC27 = nColor;
                         f = x3; |HAZ Color; enC37 = nColor;
                    |FINSI;
                    x1 = x1 + 1; x2 = x2 + 1; x3 = x3 + 1;
               |SIGUE;
               enTipo = 1; |PRINT;
          |SIGUE;
          |SI nAno3 > aAnoF; |SAL; |FINSI;
          |SI nAno3 = aAnoF;
               |SI nMes3 ] aMesF; |SAL; |FINSI;
          |FINSI;

          nAno1 = nAno3; nAno2 = nAno3;

          nMes1 = nMes3 + 1;
          |SI nMes1 > 12; nMes1 = 1; nAno1 = nAno1 + 1; nAno2 = nAno1; nAno3 = nAno1; |FINSI;
          nMes2 = nMes1 + 1;
          |SI nMes2 > 12; nMes2 = 1; nAno2 = nAno1 + 1; nAno3 = nAno2; |FINSI;
          nMes3 = nMes2 + 1;
          |SI nMes3 > 12; nMes3 = 1; nAno3 = nAno3 + 1; |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |ABRE #9;
     #9#0 = #0#0;
     #9#1 = #0#1;
     |LEE 000#9=;
     |CIERRA #9;

     Impresora = "Crystal Reports";
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "juminf19";
          |SI FSalida = 0;
               |ABRE #13; |SELECT #2#13;
               |HAZ Impre;
               |CIERRA #13;
               |PIEINF;
               |FININF;
          |SINO;
               |MENAV "0000Error en 'juminf19'";
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
