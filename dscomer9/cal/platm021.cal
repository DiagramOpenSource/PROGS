|FICHEROS;
 platm021 #0;
 platm011 #1;
 platm020 #2;
 platm015 #3;
 platm012 #4;
|FIN;

|VARIABLES;
 linea = 0;
 ii = 0;
 aEstado = "";
|FIN;

|PROCESO tipo3021;| TIPO 3;
|SI FSalida = 0;
  |ABRE #1;
  #1#0 = #0#0;
  |LEE 010#1=;
  |SI FSalida = 0;
      aEstado = #1#7;
      #1#7 = "REPARADO";
      |GRABA 010#1a;
  |FINSI;
  |LIBERA #1;
  |CIERRA #1;
  |ABRE #2;
  #2#0 = #0#0;
  #2#3 = 001;
  |LEE 010#2=;
  |SI FSalida ! 0;
    linea = 1;
  |SINO;
    |PARA ii = 1;|SI ii [100;|HACIENDO;
      linea = #2#3;
      |LEE 010#2s;
      |SI #2#0 ! #0#0;|O FSalida ! 0;
        |SAL;
      |FINSI;
    |SIGUE;
  |FINSI;
  |LIBERA #2;
  #2#0 = #0#0;
  #2#3 = linea+1;
  #2#1 = "REPARACION";
  #2#2 = #0#3;
  |GRABA 010#2n;
  |LIBERA #2;
  |CIERRA #2;
|FINSI;
|FPRC;

|CALCULO MiraSiYa;
|ABRE #1;
#1#0 = #0#0;
|LEE 010#1=;
|SI FSalida = 0;
  |SI #1#7 ! "AVERIADO  ";
    |MENAV "0000 Mercancia NO averiada";
    |ERROR;
  |FINSI;
  |SI #1#8 = "O";
    |MENAV "0000 SOLO NUMEROS DE SERIE";
    |ERROR;
  |FINSI;
|FINSI;
|LIBERA #1;
|CIERRA #1;
|FCAL;

|PROCESO MiraEstado;
|ABRE #1;
#1#0 = #0#0;
|LEE 010#1=;
|SI FSalida ! 0;|DDEFECTO #1;|FINSI;
|LIBERA #1;
|CIERRA #1;
|FPRC;

|PROCESO SumaTip;
|HAZ MiraEstado;
|QBF aEstado;
|ABRE #platm012;
#platm012#0 = #platm011#2;
|LEE 010#platm012.=;
|SI FSalida = 0;
  |SI aEstado = "ALMACEN";
    #platm012#2 = #platm012#2 -. 1;
  |FINSI;
  |SI aEstado = "INSTALADO";
    #platm012#3 = #platm012#3 -. 1;
  |FINSI;
  |SI aEstado = "AVERIADO";
    #platm012#4 = #platm012#4 -. 1;
  |FINSI;
  |SI aEstado = "ENVIOPLATA"
    #platm012#7 = #platm012#7 -. 1;
  |FINSI;
  #platm012#5 = #platm012#5 +. 1;
  #platm012#6 = #platm012#2 + #platm012#3 + #platm012#4 + #platm012#5+#platm012#7;
  |GRABA 010#platm012.a;
|FINSI;
|LIBERA #platm012;
|CIERRA #platm012;
|FPRC;
|PROCESO Baja;
|FPRC;

|CALCULO tipo2021;|TIPO 2;
|HAZ SumaTip;
|HAZ Baja;
|FCAL;
