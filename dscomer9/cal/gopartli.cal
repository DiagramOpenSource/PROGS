|FICHEROS;
     gopartca #0;
     gopartli #1;
     gomantca #2;
     gomantli #3;
     goptrbca #4,MANTE;
     gopartll #5;
     goptrbli #6;
     gopre001 #7;
     gomantl1 #8;
     gopartia #9;
     goptrbca #10;
     gopartob #11;
     gopartdu #12;
     goparame #13;
     agifa027 #27;
     guerm053 #53;
     refere1@ #100; || gopartli
     refere3@ #102; || gopartll
|FIN;
-----------------------------------------------------------------------------
|VARIABLES;
     nForma = 0;
     aTipo = "";
     fFec = @;
     nError = 0;
     nBuffer = 0;
     nPuntero = 0;
     nLineas = 0;
     nCalc = 0;
     nCol = 0;
     nExiste = 0;
     aA쨚 = "";
     aMes = "";
     nPtec = 0;
     aPtec = "";
     &enRecalcular = 0;
     aDef = "";
     aSerPar = "";
     nNumPar = 0;
     aSerPre = "";
     aAlfa = "";
     nLin = 0;
     nLinPar = 0;
     &efFecha       = @;
     &cCodMonBase   = "";
     &cCodMonTrab   = "";
     &cDesMonBase   = "";
     &cDesMonTrab   = "";
     &cSerie        = "";
     &cSerExp       = "";
     &cSerPre       = "";
     &cTipo         = "";

     &nDeci_PBase   = 0;
     &nDeci_TBase   = 0;
     &nDeci_PTrab   = 0;
     &nDeci_TTrab   = 0;
     &nDeci_TotVis  = 0;
     &nEurMonTrab   = 0;
     &nEurMonBase   = 0;
     &nNumExp       = 0;
     &nNumPre       = 0;
     &nExped        = 0;
     nSumHor        = 0;
     nModo          = 0;
     nLinea         = 0;

     &fFechaIni     = @;
     nTecla         = 0;
     &nHayT         = 0;
|FIN;
-----------------------------------------------------------------------------
|PROCESO AltPar; |TIPO 0;
     nModo = (FEntrada/100)!0;
     nTecla = 0;
/*
     |SI FSalida = 10; |Y nModo = 1;
          nTecla = 10;
     |FINSI;
*/
     |SI FSalida = 13;
          |SI nModo ! 1;
               |MENAV "0000Opcion valida solo en alta...";
               |ERROR; |ACABA;
          |SINO;
               |HAZ CopiaDia;
               |SI nError = 1; |ERROR; |FINSI;
               |ACABA;
          |FINSI;
     |FINSI;

     |ABRE #53;
     aAlfa = #1#3 % 704; #53#0 = aAlfa;
     aAlfa = #1#3 % 402; #53#1 = aAlfa;
     |LEE 000#53=;
     |SI FSalida = 0;
          |MENAV "0000Periodo cerrado...";
          |ERROR; |ACABA;
     |FINSI;
     |CIERRA #53;

     |HAZ EsGuerola;
     |SI FSalida = 0;
          |HAZ CheckParteAct;
     |FINSI;

     |SI nModo = 4;
          |ABRE #4;
          |DDEFECTO #4;
          cTipo = #5#14;
          #4#0  = cSerExp;                        ||Serie.
          #4#1  = nNumExp;                        ||Expediente.
          #4#2  = #1#3;                           ||Fecha.
          #4#16 = cSerPre;                        ||Serie Presup.
          #4#17 = nNumPre;                        ||No. Presup.
          #4#20 = cTipo;                          ||Tipo Cargo.
          |LEE 000#4=;
          |SI FSalida = 0;
               |PUSHV 01012380;
               |CLS;
               #4#7  = #7#2;                      ||Codigo Cliente.
               #4#8  = #7#3;                      ||Nombre de Cliente.
               |PINPA #0#4;
               |PINDA #0#4;
               |ENDATOS #4#4;
               |POPV;
               |ACABA;
          |FINSI;
     |FINSI;

     cSerExp = #5#0;
     nNumExp = #5#1;
     cSerPre = #5#4;
     nNumPre = #5#5;

     ||컴컴컴컴컴컴컴횮ontrol Cierre
     efFecha = #1#3;
     |HAZ EstaCerrado;
     |SI FSalida = 0;
          |ERROR; |ACABA;
     |FINSI;

     |SI nModo ! 1; |Y #1#5 = 0;
          |ERROR;
          |ACABA;
     |FINSI;

     |ABRE #3;
     |SELECT #2#3;
     #3#0 = #0#0;                                 ||Serie Expediente.
     #3#1 = #0#1;                                 ||Numero Exediente.
     #3#3 = #1#0;                                 ||Serie Pres.
     #3#4 = #1#1;                                 ||Numero Pres.
     |LEE 000#3=;
     |SI FSalida = 0;
          |SI #1#3 < #3#7; |O #1#3 > #3#8;
               |MENAV "0000FECHA FUERA DE LOS MARGENES DE INICIO Y FIN DEL PRESUPUESTO";
          |FINSI;
     |FINSI;
     |CIERRA #3;

     |ABRE #7;
     #7#0 = cSerPre;
     #7#1 = nNumPre;
     |LEE 000#7=;
     |SI FSalida = 0;
          |HAZ ExisteFecha;
          |SI nExiste ! 0;
               |ERROR; |ACABA;
          |FINSI;

          |ABRE #4;
          |DDEFECTO #4;
          cTipo = #5#14;
          #4#0  = cSerExp;                        ||Serie.
          #4#1  = nNumExp;                        ||Expediente.
          #4#2  = #1#3;                           ||Fecha.
          #4#16 = cSerPre;                        ||Serie Presup.
          #4#17 = nNumPre;                        ||No. Presup.
          #4#20 = cTipo;                          ||Tipo Cargo.
          |LEE 000#4=;
          |SI FSalida = 0;
             ||  |SI nModo = 1;
             ||       |MENAV "0000EXISTE UN PARTE CON LA FECHA SELECCIONADA";
             ||       |ERROR;
             ||       |ACABA;
             ||  |FINSI;
               |PUSHV 01012380;
               |CLS;
               #4#7  = #7#2;                      ||Codigo Cliente.
               #4#8  = #7#3;                      ||Nombre de Cliente.
               |PINPA #0#4;
               |PINDA #0#4;
               |ENDATOS #2#4;
               |POPV;
               |SI FSalida = 0;
                    |GRABA 000#4a;
                    |HAZ ActLin;
               |FINSI;
          |SINO;
               #4#7  = #7#2;                      ||Codigo Cliente.
               #4#8  = #7#3;                      ||Nombre Cliente.
               #4#14 = #7#7;                      ||Moneda.
               |SI nTecla ! 10;
                    |PUSHV 01012380;
                    |CLS;
                    |PINPA #0#4;
                    |PINDA #0#4;
                    |ENDATOS #1#4;
                    |POPV;
                    |SI FSalida = 0;
                         |GRABA 000#4c;
                         |HAZ ActLin;
                    |SINO;
                         |ERROR;
                    |FINSI;
               |SINO;
/*
                    |ESTADO_CONTROL nBotRepar, "HIDE";
                    fFechaIni = #1#3;
                    |PINPA #0#8;
                    |PINDA #0#8;
                    |DDEFECTO #8;
                    |ENDATOS #1#8;
                    |POPV;

                    |SI nHayT = 0;
                         |ERROR10;
                         |ESTADO_CONTROL nBotRepar, "SHOW";
                    |FINSI;
                    |SI nHayT = 1;
                         |HAZ ActLin;
                    |SINO;
                         |ERROR10;
                         |ESTADO_CONTROL nBotRepar, "SHOW";
                    |FINSI;
*/
               |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #7;
     |CIERRA #0;
     |CIERRA #4;
|FPRC;
-----------------------------------------------------------------------------
|PROCESO ManPar; |TIPO 2;
     nModo = (FEntrada/100)!0;
     nForma = 0 +. 1;

     |ABRE #53;
     aAlfa = #1#3 % 704; #53#0 = aAlfa;
     aAlfa = #1#3 % 402; #53#1 = aAlfa;
     |LEE 000#53=;
     |SI FSalida = 0;
          |SI nForma = -1;
               |MENAV "0000Periodo cerrado...";
          |FINSI;
          |ERROR; |ACABA;
     |FINSI;
     |CIERRA #53;

     |SI nModo = 3;
          |ABRE #4;
          #4#0  = #0#0;            ||Serie Expediente.
          #4#1  = #0#1;            ||Expedinte.
          #4#2  = #1#3;            ||Fecha Expediente.
          #4#16 = #1#0;            ||Serie Presupuesto.
          #4#17 = #1#1;            ||Presupuesto.
          |LEE 000#4=;

          |SI FSalida = 0;
               |BUCLELIN 1 NULL #4;
               |BORRA 020#4a;
          |FINSI;

          |CIERRA #4;
     |FINSI;

     #5#6  = #5#6  +. #1#6;
     #5#7  = #5#7  +. #1#7;
     #5#8  = #5#8  +. #1#8;
     #5#13 = #5#13 +. #1#13;
     #5#9  = #5#9  +. #1#9;
     #5#10 = #5#10 +. #1#10;

|FPRC;
---------------------------------------------------------------------
|PROCESO ActLin;
     #1#4  = #4#15;                               ||Serie Parte.
     #1#5  = #4#3;                                ||N Parte.
     #1#6  = #4#4;                                ||T. Horas Pres.
     #1#7  = #4#5;                                ||T. Horas Admi.
     #1#8  = #4#6;                                ||T. Horas Extr.
     #1#9  = #4#10;                               ||Imp. Total Horas Venta.
     #1#10 = #4#11;                               ||Imp. Total Horas Costo.
     #1#13 = #4#9;                                ||Total Horas Parte.
     #1#14 = #5#0;
     #1#15 = #5#1;
     #1#16 = #5#14;                               ||Tipo Presupuesto.

     |PINDA #0#1;
|FPRC;
------------------------------------------------------------------------------
/*
|PROCESO cNombre; |TIPO nTipo;
     |SI nModo = 2;
          |C_M #1#3, 1, "N";
     |SINO;
          |C_M #1#3, 1, "S";
     |FINSI;
|FPRC;
*/
-------------------------------------------------------------------------------
|PROCESO Cambia9;
     nLinPar = nLinPar + 1;
     |BORRA 020#9a;
     #9#0 = #8#3;
     #9#1 = #8#4;
     #9#4 = aSerPar;
     #6#5 = nNumPar;
     #9#6 = nLin;
     #9#7 = nLinPar;
     |GRABA 020#9n;
|FPRC;

|DEFBUCLE Cambia9;
     #9#1;
     ;
     "T", #6#23, #6#24, #6#3, 001;
     "T", #6#23, #6#24, #6#3, 999;
     be;
     NULL, Cambia9;
|FIN;

|PROCESO Cambia6;
     nLin = nLin + 1;

     |ABRE #9;
     #9#34 = "T";
     #9#4 = #6#23;
     #9#5 = #6#24;
     #9#6 = nLin;
     #9#7 = 999;
     |LEE 101#9];
     |SI FSalida = 0;
          |LEE 000#9a;
     |SINO;
          |LEE 000#9u;
     |FINSI;
     |SI FSalida = 0; |Y #9#34 = "T"; |Y #9#4 = #6#23; |Y #9#5 = #6#24;
               |Y #9#6 = nLin;
          nLinPar = #9#8 + 1;
     |SINO;
          nLinPar = 1;
     |FINSI;

     |CIERRA #9;
     |BUCLE Cambia9;

     |BORRA 020#6a;
     #6#20 = #8#3;
     #6#21 = #8#4;
     #6#3 = nLin;
     #6#23 = aSerPar;
     #6#24 = nNumPar;
     |GRABA 020#6n;
|FPRC;

|DEFBUCLE Cambia6;
     #6#1;
     ;
     aSerPre, nNumPre, #1#3, 0001;
     aSerPre, nNumPre, #1#3, 9999;
     be;
     NULL, Cambia6;
|FIN;

|PROCESO Cambia102;
     |SELECT #2#102;
     #102#0 = #1#14;
     #102#1 = #1#15;
     #102#4 = #8#3;
     #102#5 = #8#4;
     |LEE 000#102=;
     |SI FSalida ! 0;
          |SELECT #1#102;
          #102#0 = #1#14;
          #102#1 = #1#15;
          #102#2 = 9999;
          |LEE 000#102=;
          |SI FSalida = 0;
               |LEE 000#102a;
          |SINO;
               |LEE 000#102u;
          |FINSI;
          |SI FSalida = 0; |Y #102#0 = #6#0; |Y #102#1 = #6#1;
               nLin = #102#2 + 1;
          |SINO;
               nLin = 1;
          |FINSI;
          |DDEFECTO #102;
          #102#0 = #6#0;
          #102#1 = #6#1;
          #102#2 = nLin;
          #102#3 = #7#4;
          #102#4 = #7#0;
          #102#5 = #7#1;
          #102#14 = #7#18;
          |GRABA 020#102n;
     |FINSI;
|FPRC;

|PROCESO ElCambio;
     #100#0 = #1#0;
     #100#1 = #1#1;
     #100#2 = #1#2;
     |LEE 000#100=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     aAlfa = "0000NCambiar: " + #1#0 + "/" + (("000000"+#1#1)%-106) + &13;
     aAlfa = aAlfa + "Por: " + #8#3 + "/" + (("000000"+#8#4)%-106);
     |CONFI aAlfa;
     |SI FSalida ! 0; |ACABA; |FINSI;

     enRecalcular = 1;

     |ABRE #7;
     #7#0 = #8#3;
     #7#1 = #8#4;
     |LEE 020#7=;
     |CIERRA #7;

     aSerPre = #1#0;
     nNumPre = #1#1;
     |HAZ Cambia102;

     nLin = 0;
     |SELECT #2#100;
     #100#0 = #8#3;
     #100#1 = #8#4;
     #100#3 = #1#3;
     |LEE 000#100=;
     |SI FSalida = 0;
          |BORRA 020#1a
          aSerPar = #100#4;
          nNumPar = #100#5;
     |SINO;
          |BORRA 020#1a;
          |SELECT #1#100;
          #100#0 = #8#3;
          #100#1 = #8#4;
          #100#2 = 9999;
          |LEE 000#100];
          |SI FSalida = 0;
               |LEE 000#100a;
          |SINO;
               |LEE 000#100u;
          |FINSI;
          |SI FSalida = 0; |Y #100#0 = #8#3; |Y #100#1 = #8#4;
               nLin = #100#2 + 1;
          |SINO;
               nLin = 1;
          |FINSI;
          #1#0 = #8#3;
          #1#1 = #8#4;
          #1#2 = nLin;
          |GRABA 020#1n;
          aSerPar = #1#4;
          nNumPar = #1#5;
     |FINSI;

     |ABRE #10;
     #10#0 = #1#14;
     #10#1 = #1#15;
     #10#2 = #1#3;
     #10#16 = aSerPre;
     #10#17 = nNumPre;
     |LEE 101#10=;
     |SI FSalida = 0;
          |BORRA 020#10a;
          #10#16 = #8#3;
          #10#17 = #8#4;
          |LEE 101#10=;
          #10#3 = nNumPar;
          #10#15 = aSerPar;
          |SI FSalida ! 0;
               |GRABA 020#10n;
          |SINO;
               |GRABA 020#10a;
          |FINSI;
     |FINSI;
     |CIERRA #10;

     |ABRE #6;
     #6#20 = #8#3;
     #6#21 = #8#4;
     #6#2 = #1#3;
     #6#3 = 9999;
     |LEE 000#6];
     |SI FSalida = 0;
          |LEE 000#6a;
     |SINO;
          |LEE 000#6u;
     |FINSI;
     |SI FSalida = 0; |Y #6#20 = #8#3;  |Y #6#21 = #8#4;  |Y #6#2 = #1#3;
          nLin = 0;
     |SINO;
          nLin = #6#3;
     |FINSI;
     |CIERRA #6;
     |BUCLE Cambia6;
|FPRC;

|PROCESO Min8;
     #8#0 = #1#14;
     #8#1 = #1#15;
     #8#2 = 1;
|FPRC;

|PROCESO Max8;
     #8#0 = #1#14;
     #8#1 = #1#15;
     #8#2 = 999;
|FPRC;

|PROCESO CambiaPres; |TIPO 11;
     |SI FSalida = 13; ||F5
          |HAZ ConsultaPre;
     |FINSI;
     |SI FSalida = 10;
          |DDEF aDef;
          aAlfa = aDef + "gopartli";
          |CARGA_DEF aAlfa, refere1@;
          aAlfa = aDef + "gopartll";
          |CARGA_DEF aAlfa, refere3@;
          |ABRE #8;
          #8#0 = #1#14;
          #8#1 = #1#15;
          |LEE 000#8];
          |CONSULTA_F_CLAVE #1#8, Min8, Max8;
          |SI FSalida ! 0;
               |ERROR;
          |SINO;
               |SI #1#0 ! #8#3; |O #1#1 ! #8#4;
                    |ABRE #7;
                    #7#0 = #8#3;
                    #7#1 = #8#4;
                    |LEE 020#7=;
                    aTipo = #7#18;
                    #7#0 = #1#0;
                    #7#1 = #1#1;
                    |LEE 020#7=;
                    |CIERRA #7;
                    |SI aTipo ! #7#18;
                         |MENAV "0000El presupuesto es de diferente tipo al actual...";
                         |ERROR;
                    |SINO;
                         |ABRE #100;
                         |ABRE #102;
                         |HAZ ElCambio;
                         |CIERRA #100;
                         |CIERRA #102;
                         |ERROR;
                         |PTEC 808;
                         |PTEC 809;
                         |PONCONTROL 23, "SI";
                    |FINSI;
               |SINO;
                    |ERROR;
               |FINSI;
          |FINSI;

          |DESCARGA_DEF #refere3@;
          |DESCARGA_DEF #refere1@;
          |CIERRA #8;
     |FINSI;
     |SI FSalida = 14;
          |HAZ Observaciones;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO MinRef;
     #refere1@#0 = #5#4;
     #refere1@#1 = #5#5;
     #refere1@#3 = "01.01.0000";
|FPRC;

|PROCESO MaxRef;
     #refere1@#0 = #5#4;
     #refere1@#1 = #5#5;
     #refere1@#3 = "31.12.9999";
|FPRC;

|PROCESO ConsultaPre;
     nLin = 0;
     |DDEF aAlfa;
     aAlfa = aAlfa + "gopartli";
     |CARGA_DEF aAlfa, refere1@;
     |SI FSalida = 0;
          |ABRE #refere1@;
          |CONSULTA_F_CLAVE #2#refere1@, MinRef, MaxRef;
          |SI FSalida = 0; nLin = #refere1@#2; |FINSI;
          |CIERRA #refere1@;
          |DESCARGA_DEF #refere1@;
     |FINSI;
     |ERROR;
     |SI nLin ! 0;
          |PTEC 802;
          aAlfa = ("0000" + nLin) % -104;
          aPtec = aAlfa % 401; nPtec = &aPtec; |PTEC nPtec;
          aPtec = aAlfa % 301; nPtec = &aPtec; |PTEC nPtec;
          aPtec = aAlfa % 201; nPtec = &aPtec; |PTEC nPtec;
          aPtec = aAlfa % 101; nPtec = &aPtec; |PTEC nPtec;
     |FINSI;
|FPRC;

|PROCESO CheckParteAct;
     aA쨚 = #1#3 % 704;
     aMes = #1#3 % 402;
     |ABRE #53;
     #53#0 = aA쨚;
     #53#1 = aMes;
     |LEE 000#53=;
     |SI FSalida = 0; |Y #53#5 = "S";
          |MENAV "0000Precio de coste actualizado...";
     |FINSI;
     |CIERRA #53;
|FPRC;

|PROCESO ExisteFecha;
     nExiste = 0;
     |DDEF aAlfa;
     aAlfa = aAlfa + "gopartli";
     |CARGA_DEF aAlfa, refere1@
     |SI FSalida ! 0; |ACABA; |FINSI;
     |ABRE #refere1@;
     |SELECT #2#refere1@;
     #refere1@#0 = #1#0;
     #refere1@#1 = #1#1;
     #refere1@#3 = #1#3;
     |LEE 000#refere1@.];
     |PARA; |SI FSalida = 0; |Y #refere1@#0 = #1#0; |Y #refere1@#1 = #1#1;
               |Y #refere1@#3 = #1#3; |HACIENDO;
          |SI #refere1@#2 ! #1#2;
               |MENAV "0000EXISTE UN PARTE CON LA FECHA SELECCIONADA";
               nExiste = 1;
          |FINSI;
          |LEE 000#refere1@.s;
     |SIGUE;
     |CIERRA #refere1@;
     |DESCARGA_DEF #refere1@;
|FPRC;

|PROCESO Ayuda; |TIPO 7;
     |HAZ EsMarcosJi;
     |SI FSalida = 0;
          aAlfa = "0000<F2>Cambiar entrada otro Presupuesto  <F5>Consulta fechas  <F6>Observaciones";
     |SINO;
          aAlfa = "0000<F2> Cambiar entrada a otro Presupuesto   <F5> Consulta por fechas";
     |FINSI;
     |MENSA aAlfa;
|FPRC;


|PROCESO CogeLineas;
     aAlfa = #11#4;
     |AL_BUF nBuffer, nPuntero, aAlfa;
     nPuntero = nPuntero + 1;
     |BORRA 020#11a;
|FPRC;

|DEFBUCLE CogeLineas;
     #11#1004;
     ;
     #1#0, #1#1, #1#3, 1;
     #1#0, #1#1, #1#3, 999;
     be;
     NULL, CogeLineas;
|FIN;

|PROCESO GrabaLineas;
     |PARA nCalc = 100; |SI nCalc ] 0; |HACIENDO nCalc = nCalc - 1;
          |DEL_BUF nBuffer, nCalc, aAlfa;
          |SI aAlfa ! ""; nLineas = nCalc; |SAL; |FINSI;
     |SIGUE;

     |ABRE #11;
     |PARA nCalc = 1; |SI nCalc [ nLineas; |HACIENDO nCalc = nCalc + 1;
          |DEL_BUF nBuffer, nCalc, aAlfa;
          |DDEFECTO #11;
          #11#0 = #1#0;
          #11#1 = #1#1;
          #11#2 = #1#3;
          #11#3 = nCalc;
          #11#4 = aAlfa;
          |GRABA 020#11n;
     |SIGUE;
     |CIERRA #11;
|FPRC;

|PROCESO Observaciones;
     |PUSHV 0501 2380;
     |BLANCO 1403 2374;
     |ATRI R; |PINTA 1404, " OBSERVACIONES "; |ATRI 0;
     |DIMENSIONA 200, nBuffer, 0;
     nPuntero = 1;
     |BUCLE CogeLineas;
     nModo = 100; nLin = 99; nCol = 90;
     |EDITA nBuffer, 1, 100, 1505, 2372, nModo, "", 0, nLin, nCol;
     |HAZ GrabaLineas;
     |FINDIM nBuffer;
     |POPV;
|FPRC;
-------------------------------------------------
|PROCESO Copia9;
     #9#4 = #4#0;
     #9#5 = nNumPar;
     #9#28 = #1#3;
     |GRABA 020#9n;
|FPRC;

|DEFBUCLE Copia9;
     #9#1;
     ;
     "T", #4#15, #4#3, #6#3, 001;
     "T", #4#15, #4#3, #6#3, 999;
     ;
     NULL, Copia9;
|FIN;

|PROCESO Copia6;
     |BUCLE Copia9;
     #6#2 = #1#3;
     |GRABA 020#6n;

     #4#2 = #1#3;
     #4#15 = #4#0;
     #4#3 = nNumPar;
     |HAZ ActuaParte;
|FPRC;

|DEFBUCLE Copia6;
     #6#1;
     ;
     #4#16, #4#17, #4#2, 0001;
     #4#16, #4#17, #4#2, 9999;
     ;
     NULL, Copia6;
|FIN;

|PROCESO NumParte;
     |ABRE #27;
     #27#0 = "partetrab";      ||Serie.
     #27#2  = #4#0;            ||Tipo documento.
     |LEE 000#27=;
     |SI FSalida = 0;
          #27#1 = #27#1 + 1;
          |GRABA 020#27a;
     |SINO;
          #27#1 = 1;
          |GRABA 020#27n;
     |FINSI;
     |CIERRA #27;
     nNumPar = #27#1;
|FPRC;

|PROCESO CopiaDia;
     nError = 1;
     |PUSHV 0501 2380;
     |BLANCO 1019 1759;
     |PINPA #0#12;
     |PINDA #0#12;
     |ENDATOS #1#12;
     |SI FSalida = 0;
          |DDEF aAlfa;
          aAlfa = aAlfa + "gopartli";
          |CARGA_DEF aAlfa, refere1@;
          |SI FSalida = 0;
               |ABRE #refere1@;
               |SELECT #2#refere1@;
               #refere1@#0 = #1#0;
               #refere1@#1 = #1#1;
               #refere1@#3 = #12#0;
               |LEE 000#refere1@.=;
               |SI FSalida = 0;
                    |ABRE #4;
                    #4#0 = #0#0;
                    #4#1 = #0#1;
                    #4#2 = #12#0;
                    #4#16 = #1#0;
                    #4#17 = #1#1;
                    |LEE 121#4=;
                    |SI FSalida = 0;
                         |HAZ NumParte;
                         |BUCLE Copia6;
                         #4#2 = #1#3;
                         #4#15 = #4#0;
                         #4#3 = nNumPar;
                         |GRABA 020#4n;

                         nLin = #1#2;
                         fFec = #1#3;
                         |SALVA_DATOS #refere1@;
                         |REPON_DATOS #1;
                         #1#2 = nLin;
                         #1#3 = fFec;
                         #1#4 = #4#15;
                         #1#5 = #4#3;
                         |PINDA #0#1;
                         nError = 0;
                    |FINSI;
                    |CIERRA #4;
               |SINO;
                    |MENAV "0000No existe partes de esta fecha...";
               |FINSI;
               |CIERRA #refere1@;
               |DESCARGA_DEF #refere1@;
          |FINSI;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO Linea7; |TIPO 7;
     |ABRE #13; |LEE 000#13p; |CIERRA #13;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1; #1#2 = #1#2 + #13#138 - 1; |FINSI;
|FPRC;
