|FICHEROS;
   con00703 #0;

   con00008 #10,MANTE;
   Referen@ #100;
|FIN;

|VARIABLES;
   aAlfa    = "";
   nSwNuevo = 0;
|FIN;

|PROCESO Comprueba;
   |ABRE #con00008;
   #con00008#5 = #con00703#0;
   #con00008#6 = 0;
   #con00008#0 = #con00703#2;
   |LEE 000#con00008.=;
   |SI FSalida ! 0;
      aAlfa = "    N¨ Dar de alta ? ";
      |CONFI aAlfa;
      |SI FSalida = 0;
         |PUSHV 0501 2380;
         |CLS;
         |PINPA #0#con00008; |PINDA #0#con00008;
         |ENDATOS #1#con00008;
         |SI FSalida = 0;
            |GRABA 020#con00008.n;
         |FINSI;
         |POPV;
      |SINO;
         |ERROR;
      |FINSI;
   |SINO;
      #con00703#3 = #con00008#1; |PINTA #con00703#3;
   |FINSI;
   |CIERRA #con00008;
|FPRC;

|PROCESO MiraRel; |TIPO 66;
   |CONSULTA_CLAVE #1#Referen@;
   |SI FSalida = 0;
      #con00703#2 = #Referen@#0; |PINTA #con00703#2;
      #con00703#3 = #Referen@#1; |PINTA #con00703#3;
   |FINSI;
   |ERROR;
|FPRC;

|PROGRAMA;
   |ABRE #con00703;

   nSwNuevo = 0
   aAlfa = PARAMETRO;
   aAlfa = aAlfa % 0105; #con00703#0 = aAlfa;
   aAlfa = PARAMETRO;
   aAlfa = aAlfa % 0606; #con00703#1 = aAlfa;
   |LEE 101#con00703.=;
   |SI FSalida ! 0;
      |DDEFECTO #con00703;
      aAlfa = PARAMETRO; aAlfa = aAlfa % 0105; #con00703#0 = aAlfa;
      aAlfa = PARAMETRO; aAlfa = aAlfa % 0606; #con00703#1 = aAlfa;
      |GRABA 020#con00703.b;
      nSwNuevo = 1;
   |FINSI;

   |DDEF aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "con00008.mas";
   |CARGA_DEF aAlfa, Referen@;
   |SI FSalida = 0;
      aAlfa = "SELECT * FROM con00008 INTO sc" + Usuario + " WHERE 6 == 0 AND 5 == '" + #con00703#0 + "'";
      |SQL aAlfa;
      |SI FSalida = 0;
         aAlfa = "sc" + Usuario; |NOME_DAT #Referen@#aAlfa#;
         |ABRE #Referen@;
      |FINSI;
   |SINO;
      |MENAV "    Problemas al abrir el fichero de secciones";
      |SI nSwNuevo = 1; |BORRA 020#con00703.a; |FINSI;
      |LIBERA #con00703; |CIERRA #con00703;
      |ACABA;
   |FINSI;

   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      |GRABA 020#con00703.a;
   |SINO;
      |SI nSwNuevo = 1; |BORRA 020#con00703.a; |FINSI;
   |FINSI;

   |LIBERA #con00703; |CIERRA #con00703;

   |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
|FPRO;
