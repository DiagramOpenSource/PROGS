     RecalTipoPed  (calcula el tipo y asigna fase=2 si tiene negativos)

|FICHEROS;
     pcegm004 #4;
     pcegm005@;
|FIN;

|VARIABLES;
     aNega = "";
     aRese = "N";
     aPend = "N";
     aCali = "N";
     aAlfa = "";
     nPendiente = 0;
|FIN;

|PROCESO RecalTipoPedLin;
     |SI #pcegm005@#60 ! 0; aRese = "S"; |FINSI;
     |SI #pcegm005@#5 < 0;
          nPendiente = -1 * (#pcegm005@#5 - #pcegm005@#43);
     |SINO;
          nPendiente = #pcegm005@#5 - #pcegm005@#43;
     |FINSI;

     |SI nPendiente > 0; aPend = "S"; |FINSI;

     aAlfa = #pcegm005@#2;
     aAlfa = aAlfa - "CAL";
     |SI FSalida > 0;
           |SI #pcegm005@#30 = 0; |Y #pcegm005@#60 = 0; |Y #pcegm005@#43 = 0;
               aCali = "S";
           |FINSI;
     |FINSI;
     |SI #pcegm005@#5 < 0; aNega = "S"; |FINSI;
|FPRC;

|DEFBUCLE RecalTipoPedLin;
     #pcegm005@#1003;
     ;
     #4#25, #4#0, 001;
     #4#25, #4#0, 999;
     ;
     NULL, RecalTipoPedLin;
|FIN;

|PROCESO RecalTipoPed;
     |DDEF aAlfa;
     aAlfa = aAlfa + "pcegm005";
     |CARGA_DEF aAlfa, pcegm005@;
     |SI FSalida ! 0;
          |MENAV "0000Error al cargar 'pcegm005'";
          |ACABA;
     |FINSI;

     aNega = "";
     aRese = "N";
     aPend = "N";
     aCali = "N";
     |BUCLE RecalTipoPedLin;
     #4#76 = 0;
     |SI #4#70 = "C";
          |SI aRese = "S"; |Y aCali = "S";
               #4#76 = 3;
          |SINO;
               |SI aRese = "S";
                    #4#76 = 2;
               |SINO;
                    |SI aPend = "S"; #4#76 = 1; |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;

     |SI aNega = "S"; #4#84 = 2; |FINSI; ||Servir todo

     |DESCARGA_DEF #pcegm005@;
|FPRC;
