|FICHEROS;
     dsw00070 #0;
     agifa024 #24;
     dsm00003 #3;
     dsm00122 #122;
|FIN;

|VARIABLES;
     nCampo = 0;
|FIN;

|PROCESO Min70;
     #3#0 = #0nCampo;
     #3#1 = 1;
|FPRC;

|PROCESO Max70;
     #3#0 = #0nCampo;
     #3#1 = 9999;
|FPRC;

|PROCESO Tipo70_66; |TIPO 66;
     |SI Campo = 0; |O Campo = 4;
          |ABRE #24;
          #24#0 = #0Campo;
          |LEE 000#24];
          |CONSULTA_CLAVE #1#24;
          |SI FSalida = 0;
               #0Campo = #24#0;
               nCampo = Campo + 1;
               #0nCampo = #24#1;
               |PINTA #0Campo;
               |PINTA #0nCampo;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #24;
     |FINSI;
     |SI Campo = 2; |O Campo = 6;
          nCampo = Campo - 2;
          |ABRE #3;
          #3#0 = #0nCampo;
          #3#1 = #0Campo;
          |LEE 000#3];
          |CONSULTA_F_CLAVE #1#3, Min70, Max70;
          |SI FSalida = 0;
               #0Campo = #3#1;
               nCampo = Campo + 1;
               #0nCampo = #3#2;
               |PINTA #0Campo;
               |PINTA #0nCampo;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #3;
     |FINSI;
|FPRC;

|PROCESO Tipo70_6; |TIPO 6;
     |SI Campo = 0; |O Campo = 4;
          |ABRE #24;
          #24#0 = #0Campo;
          |LEE 000#24=;
          |SI FSalida ! 0;
               |MENAV "0000No existe Cliente...";
               |ERROR;
          |SINO;
               nCampo = Campo + 1;
               #0nCampo = #24#1;
               |PINTA #0nCampo;
          |FINSI;
          |CIERRA #24;
     |FINSI;
     |SI Campo = 2; |O Campo = 6;
          nCampo = Campo - 2;
          |ABRE #3;
          #3#0 = #0nCampo;
          #3#1 = #0Campo;
          |LEE 000#3=;
          |SI FSalida ! 0;
               |MENAV "0000No existe Direccion...";
               |ERROR;
          |SINO;
               nCampo = Campo + 1;
               #0nCampo = #3#2;
               |PINTA #0nCampo;
          |FINSI;
          |CIERRA #3;
     |FINSI;
|FPRC;

|PROCESO Tipo70_7; |TIPO 7;
     |ABRE #24;
     #24#0 = #0#0;
     |LEE 000#24=;
     |SI FSalida = 0;
          #0#1 = #24#1;
          |PINTA #0#1;
     |FINSI;
     |CIERRA #24;

     |ABRE #3;
     #3#0 = #0#0;
     #3#2 = #0#1;
     |LEE 000#3=;
     |SI FSalida = 0;
          #0#3 = #3#2;
          |PINTA #0#3;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO Tipo70_0; |TIPO 0;
     nCampo = Campo - 2;
     |ABRE #122;
     #122#0 = #0nCampo;
     #122#1 = #0Campo;
     |LEE 000#122=;
     |SI Campo = 2;
          |SI FSalida ! 0;
               |MENAV "0000La Tarifa no existe...";
               |ERROR;
          |FINSI;
     |FINSI;
     |SI Campo = 6;
          |SI FSalida = 0;
               |MENAV "0000La Tarifa ya existe...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #122;
|FPRC;
