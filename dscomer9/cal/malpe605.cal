|FICHEROS;
malpe604#0;
malpe603#1;
malpe602#2;
malpe605#3;
malpe600#4;
malpe606#5;
malpe607#7;
|FIN;

|VARIABLES;
     &Tempo = "";
     aTmp0 = "";
     aTmp5 = "";
     aTmp7 = "";
resto = 0;
limite = 0;
dia = "";
dia_campo = 0;
primera = 0;
traba_act = 0;
mes = "";
a¤o = "";
texto_campo = 0;
dfmes = "";
dfayo = "";
hfmes = "";
hfayo = "";
dfmes1 = 0;
dfayo1 = 0;
hfmes1 = 0;
hfayo1 = 0;
|FIN;


|PROCESO lee2;
#0#0 = #2#0;
#0#1 = #2#1;
|LEE 040#0=;
 |SI FSalida ! 0;
  |DDEFECTO #0;
  #0#0 = #2#0;
  #0#1 = #2#1;
  |ABRE #4;
  |ABRE #1;
  #4#0 = #0#0;
  |LEE 040#4=;
  #1#0 = #4#6;
  #1#1 = #0#1;
  |LEE 040#1=;
  #0#6 = #1#0;
  #0#7 = #1#2;
  #0#8 = #1#3;
  #0#9 = #1#4;
  #0#10 = #2#5;
  |GRABA 001#0c;
  |LIBERA #4;
  |LIBERA #1;
  |CIERRA #4;
  |CIERRA #1;
 |FINSI;
 #0#2 = #0#2 + #2#3;
  |SI #2#5 ! "  ";
     #0#10=#2#5;
  |FINSI;
 |GRABA 001#0a;
|LIBERA #0;
|FPRC;

|PROCESO horas;
|SI #5#4 [ #5#6;
  #5#7 = #5#4;
  limite = #5#6 - #5#4;
  |SI #5#5 [ limite;
    #5#8 = #5#5;
  |SINO;
    #5#8 = limite;
    #5#10 = #5#5 - limite;
  |FINSI;
|SINO;
  #5#7 = #5#6;
  #5#9 = #5#4 - #5#6;
  #5#10 = #5#5;
|FINSI;
|GRABA 001#5a;
|FPRC;

|DEFBUCLE calhoras;
#5#1;
;
00000,0000,00;
99999,9999,99;
;
NULL,horas;
|FIN;

|PROCESO ponmes;
 #5#0 = #0#0;
 a¤o = #0#1 % A704;
 #5#1 = a¤o;
 mes = #0#1 % A402;
 #5#2 = mes;
 |LEE 040#5=;
  |SI FSalida ! 0;
   |DDEFECTO #5;
     #5#0 = #0#0;
     mes = #0#1 % A704;
     #5#1 = mes;
     a¤o = #0#1 % A402;
     #5#2 = a¤o;
    |GRABA 020#5c;
  |FINSI;
 #5#3 = #5#3 + #0#3;
 #5#4 = #5#4 + #0#4;
 #5#5 = #5#5 + #0#5;
 |ABRE #4;
 #4#0 = #5#0;
 |LEE 020#4=;
  #5#6 = #4#7;
 |CIERRA #4;
 |GRABA 020#5a;
|FPRC;

|PROCESO totales;
|SI primera = 0;
     traba_act = #0#0;
     #7#0 = #0#0;
     primera = 1;
|FINSI;
|SI traba_act ! #0#0;
     |PRINT;
     |DDEFECTO #7;
     #7#0 = #0#0;
     traba_act = #0#0;
|FINSI;

dia = #0#1 % A102;
dia_campo = dia;
#7dia_campo = #0#2;
texto_campo = dia_campo +  31;
#7texto_campo = #0#10;
|FPRC;

|DEFBUCLE fich5;
#0#1;
;
00000,"00.00.0000";
99999,"99.99.9999";
;
NULL,ponmes;
|FIN;

|DEFBUCLE mensual;
#0#1;
;
#3#0,#3#2;
#3#1,#3#3;
;
NULL,totales;
|FIN;

|DEFBUCLE lee_fich2;
#2#1;
;
#3#0,#3#2,00;
#3#1,#3#3,99;
;
NULL,lee2;
|FIN;


|PROCESO campos;
resto = 0;
|SI #0#2 [ #0#7;
 #0#3 = #0#2;
|SINO;
   #0#3 = #0#7;
   resto = #0#2 - #0#7;
   |SI resto [ #0#8;
     #0#4 = resto;
     |SINO;
       #0#4 = #0#8;
       #0#5 = resto - #0#8;
   |FINSI;
|FINSI;
|GRABA 001#0a;
|LIBERA #0;
|FPRC;

|DEFBUCLE completa;
#0#1;
;
00000,"00.00.0000";
99999,"99.99.9999";
;
NULL,campos;
|FIN;


|PROCESO borra_cinco;
|BORRA 001#5c;
|LIBERA #5;
|FPRC;

|DEFBUCLE borra_5;
#5#1;
;
000001 , dfayo1 , dfmes1;
999999 , hfayo1 , hfmes1;
;
NULL , borra_cinco;
|FIN;

|PROCESO tipo3;|TIPO 3;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "malpe607";
          |SI FSalida = 0;
               |HAZ CreaTempo; aTmp0 = Tempo;
               |NOME_DAT #0 aTmp0; |DELINDEX #0;
               |ABRE #0;
               |BUCLE lee_fich2;
               |BUCLE completa;
               |CIERRA #0;
               dfmes = #3#2 % A0402;
               hfmes = #3#3 % A0402;
               dfayo = #3#2 % A0704;
               hfayo = #3#3 % A0704;
               dfmes1 = dfmes;
               hfmes1 = hfmes;
               dfayo1 = dfayo;
               hfayo1 = hfayo;
               |BUCLE borra_5;

               |ABRE #5;
               |BUCLE fich5;
               |BUCLE calhoras;
               |CIERRA #5;

               |BUCLE mensual;
               |PRINT;

               |FININF;
               Tempo = aTmp0; |HAZ BoraTempo; |DELINDEX #0;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
