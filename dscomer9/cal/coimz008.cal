|FICHEROS
     agifa010 #10;
     agifa017 #17;
     agifa019 #19;
     dsm00043 #43;
     dsm00044 #44;
     agifa071 #71;
|FIN;

|VARIABLES;
     &enHandle = 0;
     &enForma  = 0;
     &enCodigo = 0;
     nCampo = 0;
     nLin = 0;
     i = 0;
     nHandle = 0;
     aLon = "";
     nPos = 0;
     aLetra = "";
     aReg = "";
     aTab = "";
 {99}Valor = "";
     aDato = "";
|FIN;

|PROCESO LeeAlbaran;
     #10#52 = Valor1;
     #10#0 = Valor2;
     |LEE 101#10=;
     |SI FSalida = 0;
          #71#29 = Valor1;
          #71#0 = Valor2;
          #71#1 = Valor3;
          |LEE 101#71=;
     |FINSI;
|FPRC;

|PROCESO SalidaAuto;
     |ABRE #10;
     |ABRE #71;
     |HAZ LeeAlbaran;
     |CIERRA #71;
     |CIERRA #10;

     |ABRE #43;
     |ABRE #44;
     #43#4 = "LT" + Valor1;
     #43#0 = Valor2;
     |LEE 101#43=;
     |SI FSalida ! 0; |GRABA 020#43b; |FINSI;
     #44#21 = #43#4;
     #44#18 = #43#0;
     #44#8 = 99999;
     |LEE 0000#44];
     |SI FSalida = 0;
          |LEE 000#44a;
     |SINO;
          |LEE 000#44u;
     |FINSI;
     |SI FSalida = 0; |Y #44#21 = #43#4; |Y #44#18 = #43#0;
          nLin = #44#8 + 1;
     |SINO;
          nLin = 1;
     |FINSI;
     |DDEFECTO #44;
     #44#21 = #43#4;
     #44#18 = #43#0;
     #44#8 = nLin;

     |ABRE #17;
     |ABRE #19;
     #19#0 = Valor5;
     |LEE 000#19=;
     #17#0 = #19#0;
     #17#1 = #71#3;
     |LEE 000#17=;
     |CIERRA #19;
     |CIERRA #17;

     #44#7 = "S";
     #44#0 = #17#0;
     #44#1 = #17#1;
     #44#4 = Valor6;
     #44#26 = #19#9;

     #44#3 = #17#39;
     #44#19 = #17#5;
     #44#6 = #19#6;
     #44#20 = #19#104;

     #44#22 = #19#185;
     #44#23 = #19#193;
     #44#24 = #17#47;
     #44#25 = #17#48;
     enForma = 1;
     enCodigo = #44#18;
     |HAZ AcumulaES_SS;
     #44#3 = #17#39;            || Disponible que queda
     #44#19 = #17#5;

     |GRABA 020#44n;

     |CIERRA #44;
     |CIERRA #43;
|FPRC;

||Serie
||Albaran
||Linea del albaran donde tiene desglose.
||Linea del lote
||Articulo incluido en el lote.
||Unidades adjudicadas

|PROCESO Dato;
     nCampo = 1;
     IValor = Valor1<-;
     aLon = aDato % A0;
     aReg = "";
     aTab = &9;
     |PARA i = 1; |SI i [ aLon; |HACIENDO i = i + 1;
          nPos = i * 100 + 1;
          aLetra = aDato % nPos;
          |SI aLetra = aTab;
               Valor = aReg;
               aReg = "";
               nCampo = nCampo + 1;
               IValor = IValor + 1;
          |SINO;
               aReg = aReg + aLetra;
          |FINSI;
          |SI nCampo > 90; |SAL; |FINSI;     || Por si.... :)
     |SIGUE;
     Valor = aReg;
|FPRC;

|PROGRAMA;
     |XLEE enHandle, 250, aDato;
     |PARA; |SI FSalida ] 0; |HACIENDO;
          |HAZ Dato;
          |HAZ SalidaAuto;
          |XLEE nHandle, 250, aDato;
     |SIGUE;
|FPRO;
