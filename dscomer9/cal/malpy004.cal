/*
|FICHEROS;
     malpy004 #0;
     malpe001 #1;
     :/dscarter/def/dscam003 #3;   || Recibos
     :/dscarter/def/dscam013 #13;  || Remesas Lin
     :/dscarter/def/dscam023 #23;  || Riesgos
     :/dscarter/def/dscam024 #24;  || Riesgos Lin
     :/dscarter/def/dscam038 #38;  || Ctrl
     :/dscarter/def/dscam045 #45;  || Ctrl
     :/dscarter/def/dscam000 #100; || Empresa
     malpe087 #87;
     malpe090 #90;
|FIN;

|VARIABLES;
     &eaAcepta = "";
     &eaCampo = "";
     &eaEstado = "";
     &enSw = 0;
     &enImpPed = 0;
     &enImpPDt = 0;
     &enImpAlb = 0;
     &enImpRec = 0;
     &enTotRec = 0;
     &eaNomEmp = "";
     &enNumEmp = 0;
     &enRieAlb = 0;
     &enRieFac = 0;
     &enRieBan = 0;
     &enRieImp = 0;
     &enRieCta = 0;
     &enRieCon = 0;
     &enRieUti = 0;
     &enRieDis = 0;
     &eaSerRec = "";
     &enNumRec = 0;
     &efFecRec = @;

     nHay = 0;
     aAlfa = "";
     aDefCar = "";
     aEmp = "";
     nEmpresa = 0;
     aCliente = "";
     aBase = "";
     nEmpCarte = 0;
|FIN;

|PROCESO RiesgoLin;
     enRieAlb = enRieAlb + #24#3;
     enRieFac = enRieFac + #24#4;
     enRieBan = enRieBan + #24#6;
     enRieImp = enRieImp + #24#7;
     enRieUti = enRieUti + #24#8;
     enRieDis = enRieDis + #24#9;
     enRieCta = enRieCta + #24#5;
|FPRC;

|DEFBUCLE RiesgoLin;
     #24#1;
     ;
     aCliente, 01;
     aCliente, 99;
     ;
     NULL, RiesgoLin;
|FIN;

|PROCESO Riesgos;
     enRieCon = enRieCon + #23#19;
     |BUCLE RiesgoLin;
|FPRC;

|DEFBUCLE Riesgos;
     #23#1;
     ;
     aCliente;
     aCliente;
     ;
     NULL, Riesgos;
|FIN;

|PROCESO dscam038;
     |SI nEmpCarte ! #38#5;
          nEmpCarte = #38#5;

          aEmp = ("00000" + #38#5) % -105;
          aAlfa = aBase + "dscarter/fich/" + aEmp + "/";
          |PATH_DAT #23#aAlfa#;
          |PATH_DAT #24#aAlfa#;

          aAlfa = aBase + "dscarter/fich/";
          |PATH_DAT #100#aAlfa#;
          |ABRE #100;
          #100#0 = aEmp;
          |LEE 020#100=;
          |CIERRA #100;
          eaNomEmp = #100#1;
          enNumEmp = #100#0;

          enRieAlb = 0;
          enRieFac = 0;
          enRieBan = 0;
          enRieImp = 0;
          enRieCta = 0;
          enRieCon = 0;
          enRieUti = 0;
          enRieDis = 0;
          |BUCLE Riesgos;

          enSw = 10; |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE dscam038;
     #38#1;
     ;
     nEmpresa, 001;
     nEmpresa, 999;
     ;
     NULL, NULL, NULL, NULL, NULL, dscam038;
     #38#5;
|FIN;

|PROCESO Remesas;
     |SI #13#15 = "N";
          #3#40 = #13#16;
          |LEE 020#3=;
          |SI FSalida = 0; |Y #3#32 = #1#0; |Y #3#91 = #1#1;
               |SI #0#2 = "S"; |Y nHay = 0; enSw = 14; |PRINT; |FINSI;
               nHay = 1;
               enSw = 7;
               eaSerRec = #3#0;
               enNumRec = #3#1;
               efFecRec = #13#6;
               enImpRec = #13#7;
               eaEstado = ("00000" + #3#17) % -105; || Remesa
               eaAcepta = #3#29;
               eaCampo = #3#75;
               enTotRec = enTotRec + #13#7;
               |SI #0#2 = "S"; |PRINT; |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE Remesas;
     #13#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Remesas;
|FIN;

|PROCESO Recibos;
||     |SI #3#14 ! "L"; |Y #3#14 ! "A"; |Y #3#14 ! "D";

     |SI #3#14 = "P"; |O #3#14 = "T"; |O #3#14 = "I"; |O #3#14 = "V";
          |SI #0#2 = "S"; |Y nHay = 0; enSw = 14; |PRINT; |FINSI;
          nHay = 1;
          enSw = 7;
          eaSerRec = #3#0;
          enNumRec = #3#1;
          efFecRec = #3#3;
          enImpRec = #3#65;
          eaEstado = #3#14;
          eaAcepta = #3#29;
          eaCampo = #3#75;
          enTotRec = enTotRec + #3#65;
          |SI #0#2 = "S"; |PRINT; |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE Recibos;
     #3#11;
     91;
     #1#0, "01.01.0000", "     ", #1#1;
     #1#0, "31.12.9999", "zzzzz", #1#1;
     ;
     NULL, Recibos;
|FIN;

|PROCESO dscam045;
     |SI nEmpCarte ! #45#6;
          nEmpCarte = #45#6;

          aEmp = ("00000" + #45#6) % -105;
          aAlfa = aBase + "dscarter/fich/" + aEmp + "/";
          |PATH_DAT #3#aAlfa#;
          |PATH_DAT #13#aAlfa#;
          |BUCLE Recibos;
          |ABRE #3;
          |BUCLE Remesas;
          |CIERRA #3;
     |FINSI;
|FPRC;

|DEFBUCLE dscam045;
     #45#1;
     ;
     nEmpresa, 001;
     nEmpresa, 999;
     ;
     NULL, NULL, NULL, NULL, NULL, dscam045;
     #45#6;
|FIN;

|PROCESO Albaranes;
     |SI #0#2 = "S"; |Y nHay = 0; enSw = 13; |PRINT; |FINSI;
     nHay = 1;
     enSw = 5;
     enImpAlb = enImpAlb + #90#67;
     |SI #0#2 = "S"; |PRINT; |FINSI;
|FPRC;

|DEFBUCLE Albaranes;
     #90#5;
     38;
     #1#0, #1#1, "N";
     #1#0, #1#1, "N";
     ;
     NULL, Albaranes;
|FIN;

|PROCESO PedPdte;
     |SI #87#12 ! 0;
          |SI #0#2 = "S"; |Y nHay = 0; enSw = 12; |PRINT; |FINSI;
          nHay = 1;
          enSw = 3;
          enImpPDt = enImpPDt + #87#12;
          |SI #0#2 = "S"; |PRINT; |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE PedPdte;
     #87#2;
     63;
     #1#0, "     ", 000001, #1#1;
     #1#0, "zzzzz", 999999, #1#1;
     ;
     NULL, PedPdte;
|FIN;

|PROCESO Pedidos;
     |SI #0#2 = "S"; |Y nHay = 0; enSw = 11; |PRINT; |FINSI;
     nHay = 1;
     enSw = 1;
     enImpPed = enImpPed + #87#11;
     |SI #0#2 = "S"; |PRINT; |FINSI;
|FPRC;

|DEFBUCLE Pedidos;
     #87#2;
     63;
     #1#0, "     ", 000001, #1#1;
     #1#0, "zzzzz", 999999, #1#1;
     ;
     NULL, Pedidos;
|FIN;

|PROCESO FinCliente;
     enSw = 9; |PRINT;
     nEmpCarte = 0;
     |BUCLE dscam038;

     |PIEINF;
|FPRC;

|PROCESO Obras;
     |SI aCliente ! #1#0; |Y aCliente ! "";
          |HAZ FinCliente;
     |FINSI;
     aCliente = #1#0;

     #0#4 = #1#0;
     #0#5 = #1#1;
     #0#6 = #1#2;
     #0#7 = #1#3;
     #0#8 = #1#4;
     #0#9 = #1#5;
     #0#10 = #1#15;

     |DFICE aAlfa;
     aAlfa = aAlfa % -205;
     nEmpresa = aAlfa;

     |SI #1#38 ! "T";
          nHay = 0;
          enImpPed = 0;
          |BUCLE Pedidos;
          |SI nHay ! 0; enSw = 2; |PRINT; |FINSI;

          nHay = 0;
          enImpPDt = 0;
          |BUCLE PedPdte;
          |SI nHay ! 0; enSw = 4; |PRINT; |FINSI;

          nHay = 0;
          enImpAlb = 0;
          |BUCLE Albaranes;
          |SI nHay ! 0; enSw = 6; |PRINT; |FINSI;
     |FINSI;

     nHay = 0;
     enTotRec = 0;
     nEmpCarte = 0;
     |BUCLE dscam045;
     |SI nHay ! 0; enSw = 8; |PRINT; |FINSI;
|FPRC;

|DEFBUCLE Obras;
     #1#1;
     ;
     #0#0, 0001;
     #0#1, 9999;
     ;
     NULL, Obras;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |DBASS aBase;
     aAlfa = aBase + "dscarter/fich/";
     |PATH_DAT #38 aAlfa;
     |PATH_DAT #45 aAlfa;

     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "malpy004";
          |SI FSalida = 0;
               |BUCLE Obras;
               |SI aCliente ! ""; |HAZ FinCliente; |FINSI;
               |FININF;
          |SINO;
               |MENAV "0000Error en informe 'malpy004'";
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
*/
