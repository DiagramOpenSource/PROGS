|FICHEROS;
     iberca01 #0;
     iberca02 #1;
|FIN;

|VARIABLES;
      nModo    = 0;
      nModoP   = 0;

      aDTipo   = "";
      aHTipo   = "";

     &eaTipo   = "";
     &enCodigo = 0;
|FIN;

|PROCESO Borralo;
     |BORRA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE iberca02;
     #1#1;
     ;
     #0#0, #0#1, 01;
     #0#0, #0#1, 99;
     be;
     NULL, Borralo;
|FIN;

|RUTINA ClaveBaja1;
     #1#0 = #0#0;
     #1#1 = #0#1;
     #1#2 = 01;
|FRUT;

|RUTINA ClaveAlta1;
     #1#0 = #0#0;
     #1#1 = #0#1;
     #1#2 = 99;
|FRUT;

|PROCESO Desglose;
     |SI #0#3 = "S";
         |ENTLINEAL #1#1, -3, nModo, 22, 0, ClaveBaja1, ClaveAlta1;
     |SINO;
         |BUCLE iberca02;
     |FINSI;
|FPRC;

|PROCESO Tipo11;  |TIPO 11;
     |SI FSalida ! 10;  |ACABA;  |FINSI;
     |SI eaTipo = "";   |ACABA;  |FINSI;

     enCodigo = #0#1;
     |PTEC 807;
|FPRC;

|PROCESO Tipo7;  |TIPO 7;
     |ENTLINEAL #1#1, -3, 7, 22, 0, ClaveBaja1, ClaveAlta1;

     |SI eaTipo ! "";
         |MENSA "     Pulse F2 para seleccionar el Codigo";
     |FINSI;
|FPRC;

|PROCESO Tipo2;  |TIPO 2;
     nModoP = (FEntrada / 100) ! 0;
     |SI nModoP ! 3;  |ACABA;  |FINSI;

     |BUCLE iberca02;
|FPRC;

|RUTINA ClaveBaja0;
     #0#0 = aDTipo;
     #0#1 = 01;
|FRUT;

|RUTINA ClaveAlta0;
     #0#0 = aHTipo;
     #0#1 = 99;
|FRUT;

|PROGRAMA;
      nModo = 2;
      |SI eaTipo ! "";
          aDTipo = eaTipo;
          aHTipo = eaTipo;
          nModo = 4;
          |C_M #0#0, 1, "N";
          |ENTLINEAL #1#0, -2, nModo, 22, 1, ClaveBaja0, ClaveAlta0;
      |SINO;
          aDTipo = "P";
          aHTipo = "S";
          |ENTLINEAL #1#0, -1, nModo, 22, 1, ClaveBaja0, ClaveAlta0;
      |FINSI;
|FPRO;
