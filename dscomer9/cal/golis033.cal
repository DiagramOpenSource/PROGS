|FICHEROS;
     golis033 #0;
     goptrbli #1;
     gotipoho #2;
     gocallac #3;
     gocallal #4;
     gotrabaj #5;
     golis034 #34;
|FIN;

|VARIABLES;
     &Tempo = "";
     nCale = 0;
     nTraba = 0;
     f = @;
     fFecha = @;
     aAlfa = "";
     aLaboral = "";
|FIN;

|PROCESO THoras;
     |PARA f = #0#6; |SI f [ #0#12; |HACIENDO f = f + 1;
          fFecha = f % A1;
          aAlfa = fFecha % 1102; aAlfa = aAlfa > "";
          |SI aAlfa = "LU"; aLaboral = #3#1; |FINSI;
          |SI aAlfa = "MA"; aLaboral = #3#2; |FINSI;
          |SI aAlfa = "MI"; aLaboral = #3#3; |FINSI;
          |SI aAlfa = "JU"; aLaboral = #3#4; |FINSI;
          |SI aAlfa = "VI"; aLaboral = #3#5; |FINSI;
          |SI aAlfa = "SA"; aLaboral = #3#6; |FINSI;
          |SI aAlfa = "DO"; aLaboral = #3#7; |FINSI;

          #4#0 = #3#0;
          #4#2 = f;
          |LEE 000#4=;
          |SI FSalida ! 0;
               |DDEFECTO #34;
               #34#0 = #1#4;
               #34#1 = f;
               #34#2 = #2#0;
               #34#3 = #2#1;
               #34#5 = #5#1;
               #34#6 = aLaboral;
               |GRABA 020#34n;
          |FINSI;
     |SIGUE;
|FPRC;

|DEFBUCLE THoras;
     #2#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, THoras;
|FIN;

|PROCESO Partes;
     |SI nTraba ! #1#4;
          nTraba = #1#4;
          |DDEFECTO #5;
          #5#0 = #1#4;
          |LEE 000#5=;
          |BUCLE THoras;
     |FINSI;
     |DDEFECTO #34;
     #34#0 = #1#4;
     #34#1 = #1#2;
     #34#2 = #1#26;
     |LEE 101#34=;
     |SI FSalida ! 0; |GRABA 020#34b; |FINSI;
     #34#4 = #34#4 + #1#11;
     |GRABA 020#34a;
     |LIBERA #34;
|FPRC;

|DEFBUCLE Partes;
     #1#1;
     0, 1, 26, 4;
     #0#3, #0#4,  #0#6 , 0001, #0#1, #0#2, #0#5,  #0#14;
     #0#9, #0#10, #0#12, 9999, #0#7, #0#8, #0#11, #0#15;
     ;
     NULL, NULL, NULL, NULL, NULL, Partes;
     #1#4;
|FIN;

|PROCESO Tmp;
     |SI #34#4 ! 0; |O #34#6 = "S";
          |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE Tmp;
     #34#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     Impresora = "Crystal Reports";
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "golis033";
          |SI FSalida = 0;
               |HAZ CreaTempo; |NOME_DAT #34 Tempo; |DELINDEX #34;
               |ABRE #3;
               #3#0 = #0#13;
               |LEE 020#3=;
               |CIERRA #3;

               |ABRE #34;
               |ABRE #5;
               |ABRE #4; |SELECT #2#4;
               |BUCLE Partes;
               |CIERRA #4;
               |CIERRA #5;
               |CIERRA #34;
               |BUCLE Tmp;
               |HAZ BoraTempo; |DELINDEX #34;
               |PIEINF;
               |FININF;
          |SINO;
               |MENAV "0000Error en informe 'golis033'";
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROGRAMA;
     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
     nCale = #0#13;
     |DDEFECTO #0;
     #0#13 = nCale;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0; |GRABA 020#0a; |FINSI;
     |CIERRA #0;
|FPRO;
