|FICHEROS;
     agifa061 #0;

     agifa501 #501;
     expor501@ #601;

     agifa502 #502;
     expor502@ #602;

     agifa513 #513;
     expor513@ #613;

     agifa512 #512;
     expor512@ #612;

     agifa516 #516;
     expor516@ #616;

     agifa509 #509;
     expor509@ #609;

     dsm00080 #580;
     expor580@ #680;

     agifa508;
|FIN;

|VARIABLES;
     aDef1     = "";
     aDef2     = "";
     aDef3     = "";
     aDef4     = "";
     aDef5     = "";
     aDef6     = "";
     aDef7     = "";
     aPath     = "";
     aDef      = "";
     aMensa    = "";
     aAlfa     = "";
     aOrg      = "";
     aDes      = "";
     aOrigen   = "";
     aDestino  = "";
     blanco    = "                    ";
     nErr      = 0;
     nCampos   = 0;
     i         = 0;
|FIN;

|PROCESO dsm00080;
     aAlfa = "|NC";
     aAlfa = #dsm00080#aAlfa#;
     nCampos = aAlfa; nCampos = nCampos - 1;

     |SI #680#1 ] #0#2; |Y #680#1# [ #0#3; |ERROR; |ACABA; |FINSI;

     |PINTA 2145 , blanco;
     aAlfa = #680#0 + "/" + #680#1;
     |PINTA 2145 , aAlfa;

     |PARA i = 0; |SI i [ nCampos; |HACIENDO i = i + 1;
          #580i = #680i;
     |SIGUE;
     |GRABA 021#580n;
|FPRC;

|DEFBUCLE dsm00080;
     #680#1003;
     ;
     00001, "01.01.0000", 001;
     99999, "31.12.9999", 999;
     ;
     NULL, dsm00080;
|FIN;

|PROCESO agifa509;
     aAlfa = "|NC";
     aAlfa = #agifa509#aAlfa#;
     nCampos = aAlfa; nCampos = nCampos - 1;

     |SI #609#1 ] #0#2; |Y #609#1# [ #0#3; |ERROR; |ACABA; |FINSI;

     |PINTA 2145 , blanco;
     aAlfa = #609#0 + "/" + #609#1;
     |PINTA 2145 , aAlfa;

     |PARA i = 0; |SI i [ nCampos; |HACIENDO i = i + 1;
          #509i = #609i;
     |SIGUE;
     |GRABA 021#509n;
|FPRC;

|DEFBUCLE agifa509;
     #609#1003;
     ;
     00001, 00001, "01.01.0000";
     99999, 99999, "31.12.9999";
     ;
     NULL, agifa509;
|FIN;

|PROCESO agifa516;
     aAlfa = "|NC";
     aAlfa = #agifa516#aAlfa#;
     nCampos = aAlfa; nCampos = nCampos - 1;

     |SI #616#1 ] #0#2; |Y #616#1# [ #0#3; |ERROR; |ACABA; |FINSI;

     |PINTA 2145 , blanco;
     aAlfa = #616#0 + "/" + #616#1;
     |PINTA 2145 , aAlfa;

     |PARA i = 0; |SI i [ nCampos; |HACIENDO i = i + 1;
          #516i = #616i;
     |SIGUE;
     |GRABA 021#516n;
|FPRC;

|DEFBUCLE agifa516;
     #616#1002;
     ;
     00, "01.01.0000";
     99, "31.12.9999";
     ;
     NULL, agifa516;
|FIN;

|PROCESO agifa513;
     aAlfa = "|NC";
     aAlfa = #agifa513#aAlfa#;
     nCampos = aAlfa; nCampos = nCampos - 1;

     |SI #613#11 ] #0#2; |Y #613#11# [ #0#3; |ERROR; |ACABA; |FINSI;

     |PINTA 2145 , blanco;
     aAlfa = #613#16 + "/" + #613#0;
     |PINTA 2145 , aAlfa;

     |PARA i = 0; |SI i [ nCampos; |HACIENDO i = i + 1;
          #513i = #613i;
     |SIGUE;
     |GRABA 021#513n;
|FPRC;

|DEFBUCLE agifa513;
     #613#1002;
     ;
     "     ", 000001;
     "zzzzz", 999999;
     ;
     NULL, agifa513;
|FIN;

|PROCESO agifa512;
     aAlfa = "|NC";
     aAlfa = #agifa512#aAlfa#;
     nCampos = aAlfa; nCampos = nCampos - 1;

     |SI #612#11 ] #0#2; |Y #612#11# [ #0#3; |ERROR; |ACABA; |FINSI;

     |PINTA 2145 , blanco;
     aAlfa = #612#12 + "/" + #612#0;
     |PINTA 2145 , aAlfa;

     |PARA i = 0; |SI i [ nCampos; |HACIENDO i = i + 1;
          #512i = #612i;
     |SIGUE;
     |GRABA 021#512n;
|FPRC;

|DEFBUCLE agifa512;
     #612#1002;
     ;
     "     ", 000001;
     "zzzzz", 999999;
     ;
     NULL, agifa512;
|FIN;

|PROCESO agifa502;
     aAlfa = "|NC";
     aAlfa = #agifa502#aAlfa#;
     nCampos = aAlfa; nCampos = nCampos - 1;

     |PARA i = 0; |SI i [ nCampos; |HACIENDO i = i + 1;
          #502i = #602i;
     |SIGUE;
     |GRABA 021#502n;
|FPRC;

|DEFBUCLE agifa502;
     #602#1003;
     ;
     #601#36, #601#0, 000;
     #601#36, #601#0, 999;
     ;
     NULL, agifa502;
|FIN;

|PROCESO agifa501;
     aAlfa = "|NC";
     aAlfa = #agifa501#aAlfa#;
     nCampos = aAlfa; nCampos = nCampos - 1;

     |SI #601#14 ] #0#2; |Y #601#14# [ #0#3; |ERROR; |ACABA; |FINSI;

     |PINTA 2145 , blanco;
     aAlfa = #601#36 + "/" + #601#0;
     |PINTA 2145 , aAlfa;

     |PARA i = 0; |SI i [ nCampos; |HACIENDO i = i + 1;
          #501i = #601i;
     |SIGUE;
     |GRABA 021#501n;
     |LIBERA #501;
     |BUCLE agifa502;
|FPRC;

|DEFBUCLE agifa501;
     #601#1002;
     ;
     "     " ,      0;
     "zzzzz" , 999999;
     ;
     NULL , agifa501;
|FIN;

|PROCESO NomeDatTpv;
     |NOME_DAT #613 "expor513";
     |NOME_DAT #612 "expor512";
     |NOME_DAT #616 "expor516";
     |NOME_DAT #609 "expor509";
     |NOME_DAT #680 "expor580";
     |NOME_DAT #601 "expor501";
     |NOME_DAT #602 "expor502";
|FPRC;

|PROCESO DesCargaDefTpv;
     |SI aDef7 ! ""; |DESCARGA_DEF #expor502@; |FINSI;
     |SI aDef6 ! ""; |DESCARGA_DEF #expor501@; |FINSI;
     |SI aDef5 ! ""; |DESCARGA_DEF #expor580@; |FINSI;
     |SI aDef4 ! ""; |DESCARGA_DEF #expor509@; |FINSI;
     |SI aDef3 ! ""; |DESCARGA_DEF #expor516@; |FINSI;
     |SI aDef2 ! ""; |DESCARGA_DEF #expor512@; |FINSI;
     |SI aDef1 ! ""; |DESCARGA_DEF #expor513@; |FINSI;
|FPRC;

|PROCESO CargaDefTpv;
     |DBASE aPath;

     aDef1 = aPath + "def/" + "agifa513"; aDef  = aDef1;
     |CARGA_DEF aDef, expor513@;
     |SI FSalida ! 0; nErr = 1; aDef1 = ""; |ACABA; |FINSI;

     aDef2 = aPath + "def/" + "agifa512"; aDef  = aDef2;
     |CARGA_DEF aDef, expor512@;
     |SI FSalida ! 0; nErr = 1; aDef2 = ""; |ACABA; |FINSI;

     aDef3 = aPath + "def/" + "agifa516"; aDef  = aDef3;
     |CARGA_DEF aDef, expor516@;
     |SI FSalida ! 0; nErr = 1; aDef3 = ""; |ACABA; |FINSI;

     aDef4 = aPath + "def/" + "agifa509"; aDef  = aDef4;
     |CARGA_DEF aDef, expor509@;
     |SI FSalida ! 0; nErr = 1; aDef4 = ""; |ACABA; |FINSI;

     aDef5 = aPath + "def/" + "dsm00080"; aDef  = aDef5;
     |CARGA_DEF aDef, expor580@;
     |SI FSalida ! 0; nErr = 1; aDef5 = ""; |ACABA; |FINSI;

     aDef6 = aPath + "def/" + "agifa501"; aDef  = aDef6;
     |CARGA_DEF aDef, expor501@;
     |SI FSalida ! 0; nErr = 1; aDef6 = ""; |ACABA; |FINSI;

     aDef7 = aPath + "def/" + "agifa502"; aDef  = aDef7;
     |CARGA_DEF aDef, expor502@;
     |SI FSalida ! 0; nErr = 1; aDef7 = ""; |ACABA; |FINSI;
|FPRC;

|PROCESO Mueve;
     |DFICE aPath;

     aOrigen = aPath + aOrg + ".ixx";
     aDestino = aPath + aDes + ".ixx";
     |COPIA_FICHERO aOrigen, aDestino;
     |FBORRA aOrigen;

     aOrigen = aPath + aOrg + ".ddx";
     aDestino = aPath + aDes + ".ddx";
     |COPIA_FICHERO aOrigen, aDestino;
     |FBORRA aOrigen;

     aOrigen = aPath + aOrg + ".dat";
     aDestino = aPath + aDes + ".dat";
     |COPIA_FICHERO aOrigen, aDestino;
     |FBORRA aOrigen;
|FPRC;

|PROCESO TPV;
     |DELINDEX #agifa508; ||Doc. Borrados

     |HAZ CargaDefTpv;
     |SI nErr ! 0;
          aMensa = "0000Error al cargar:" + aDef;
          |MENAV aMensa;
          |HAZ DesCargaDefTpv;
          |ACABA;
     |FINSI;
     |HAZ NomeDatTpv;
     aOrg = "agifa513"; aDes = "expor513"; |HAZ Mueve;
     aOrg = "agifa512"; aDes = "expor512"; |HAZ Mueve;
     aOrg = "agifa516"; aDes = "expor516"; |HAZ Mueve;
     aOrg = "agifa509"; aDes = "expor509"; |HAZ Mueve;
     aOrg = "dsm00080"; aDes = "expor580"; |HAZ Mueve;
     aOrg = "agifa501"; aDes = "expor501"; |HAZ Mueve;
     aOrg = "agifa502"; aDes = "expor502"; |HAZ Mueve;

||Tiquets
     |ABRE #501;
     |ABRE #502;
     |BUCLE agifa501;
     |CIERRA #501;
     |CIERRA #502;
     |DELINDEX #601;
     |DELINDEX #602;

||Cobros
     |ABRE #513;
     |BUCLE agifa513;
     |CIERRA #513;
     |DELINDEX #613;

||Pagos
     |ABRE #512;
     |BUCLE agifa512;
     |CIERRA #512;
     |DELINDEX #612;

||Diario Tarj.
     |ABRE #516;
     |BUCLE agifa516;
     |CIERRA #516;
     |DELINDEX #616;

||Resumen Caja
     |ABRE #509;
     |BUCLE agifa509;
     |CIERRA #509;
     |DELINDEX #609;

||Histo Efectivo
     |ABRE #580;
     |BUCLE dsm00080;
     |CIERRA #580;
     |DELINDEX #680;

     |HAZ DesCargaDefTpv;
|FPRC;
