|FICHEROS;
     rodm0001 #0;
|FIN;

|VARIABLES;
     aAlfa = "";
     aRuta = "";
     aBarra = "";
     aPath = "";
     aMsg = "";
     aLon = "";
     i = 0;
     nPos = 0;
     aCar = "";
|FINSI;

|PROCESO Browser;
     aRuta = "D" + #0#5;
     |QBF aRuta;
     |BROWSE aRuta;

     aRuta = aRuta % 299;
     |QBF aRuta;
     |SI aRuta ! "";
          #0#5 = aRuta;
          |PINTA #0#5;
     |FINSI;
|FPRC;

|PROCESO Directorio;
     |SI #0#4 = "S"; |ACABA; |FINSI;
     |SI FSalida = 10;
          |HAZ Browser;
          |ERROR; |ACABA;
     |FINSI;
     aAlfa = #0#5; |QBF aAlfa;
     aBarra = aAlfa % -101;
     |SI aBarra ! "/"; |Y aBarra ! "\";
          aAlfa = aAlfa + "\";
          #0#5 = aAlfa;
     |FINSI;
     aPath = aAlfa;
     aMsg = "";
     aAlfa = "";
     aLon = aPath % A0;
     |PARA i = 1; |SI aAlfa ! aPath; |HACIENDO i = i + 1;
          |PARA; |SI i [ aLon; |HACIENDO i = i + 1;
               nPos = i * 100 + 1;
               aCar = aPath % nPos;
               aAlfa = aAlfa + aCar;
               |SI aCar = "/"; |O aCar = "\";
                    |SI i > 1; |SAL; |FINSI;
               |FINSI;
          |SIGUE;
          |RMKDIR aAlfa;
          |SI FSalida = 0;
               |RRMDIR aAlfa;
               aMsg = "0000No existe directorio: [" + aAlfa + "]";
               |MENAV aMsg;
               aMsg = "0000SCrear directorio: [" + aAlfa + "]";
               |CONFI aMsg;
               |SI FSalida = 0;
                    |RMKDIR aAlfa;;
               |SINO;
                    |ERROR;|ACABA;
               |FINSI;
          |FINSI;
     |SIGUE;
     #0#5 = aAlfa;
     |PINTA #0#5;
     |SI aMsg ! ""; |ERROR; |FINSI;
|FPRC;

|PROCESO CheqDirecta; |TIPO 0;
     |DFICE aAlfa;
     aAlfa = aAlfa % -205;
     |SI aAlfa = #0#1; |Y #0#4 = "S";
          aAlfa = "0000Con Transaccion Directa no puede ser la empresa actual...";
          |MENAV aAlfa;
          |ERROR;
     |SINO;
          |C_M #0#5, 1, "S";
          |SI #0#4 = "S";
               #0#5 = ""; |PINTA #0#5;
               |C_M #0#5, 1, "N";
          |FINSI;
          aAlfa = "";
     |FINSI;
|FPRC;

|PROGRAMA;
     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
     |CLS;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |HAZ CheqDirecta;
          |SI aAlfa = "";
               |GRABA 020#0a;
          |FINSI;
     |FINSI;
     |CIERRA #0;
|FPRO;
