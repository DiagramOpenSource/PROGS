|FICHEROS;
     pcegz036 #0;
     pcegm020 #20;
     pcegm023 #23;
|FIN;

|VARIABLES;
     aFic = "";
     aIP = "";
     aRuta = "";
     aAlfa = "";
     aAlf1 = "";
     nBoton1 = 0;
     nBoton2 = 0;
     nHandle = 0;
     aFin = "";
     nSw = 0;
     aBlanco = "                                          ";

     aNume = "";
     aNume1 = "";
     nNume1 = 0;
     aCar = "";
     nSuma = 0;
     nSup = 0;
     nNum = 0;
     nDig = 0;
     nPos = 0;
     j = 0;
|FIN;

|PROCESO DigControl;     || entra=aNume, salida=nDig
     aAlfa = aNume;
     nSuma = 0;
     |PARA j = 1; |SI j [ 22; |HACIENDO j = j + 1;
          nPos = j * 100 + 1;
          aCar = aAlfa % nPos;
          nNum = j $ 2;
          |SI nNum = 0;
               nNum = aCar;
               nSuma = nSuma + (nNum * 3);
          |SINO;
               nNum = aCar;
               nSuma = nSuma + nNum;
          |FINSI;
     |SIGUE;
     |PARA nSup = nSuma; |SI; |HACIENDO nSup = nSup + 1;
          nNum = nSup $ 10;
          |SI nNum = 0; |SAL; |FINSI;
     |SIGUE;
     nDig = nSup - nSuma;
|FPRC;

|PROCESO CHRONOEXPRES;
     ||M_CODREM  C    9
     aAlfa = #20#9;
     |XGRABA nHandle, aAlfa;

     aAlfa = #20#8;
     ||M_NOMREM  C    40
     |XGRABA nHandle, aAlfa;

     ||M_BULTOIN N    23
     aNume = #23#34 % 122;
     |HAZ DigControl;
     aNume = aNume + nDig;

     aAlfa = aNume;
     |XGRABA nHandle, aAlfa;

     ||M_REFEREN C    20
     aAlfa = #23#17 % 120;
     |XGRABA nHandle, aAlfa;

     ||M_NOMBRES C    40
     aAlfa = #23#8 % 140;
     |XGRABA nHandle, aAlfa;

     ||M_DIRECCI C    40
     aAlfa = #23#9 % 140;
     |XGRABA nHandle, aAlfa;

     ||M_ATENCIO C    40
     aAlfa = (#23#15 + aBlanco) % 140;
     |XGRABA nHandle, aAlfa;

     ||M_COD_POS C    7
     aAlfa = #23#11 % 107;
     |XGRABA nHandle, aAlfa;

     ||M_TELEFON C    15
     aAlfa = (#23#14 + aBlanco) % 115;
     |XGRABA nHandle, aAlfa;

     ||M_POBLACI C    40
     aAlfa = (#23#10 + aBlanco) % 140;
     |XGRABA nHandle, aAlfa;

     ||M_TIPOPRT C    1
     aAlfa = #23#16;
     |XGRABA nHandle, aAlfa;

     ||M_TIPO_AL N    2
     aAlfa = #23#35;
     |XGRABA nHandle, aAlfa;

     ||M_NBULTOS N    6
     aAlfa = ("000000" + #23#18) % -106;
     |XGRABA nHandle, aAlfa;

     ||M_PESOKGS N    10
     aAlfa = ("0000000000" + #23#19) % -110;
     |XGRABA nHandle, aAlfa;

     ||M_IMPORTE N    12
     nNume1 = #23#20 * 100;
     aNume1 = ("000000000000" + nNume1) % -111;
     aNume1 = (aNume1 % 109) + "." + (aNume1 % 1002);
     aAlfa = aNume1;
     |||aAlfa = ("000000000000" + #23#20) % -112;
     |XGRABA nHandle, aAlfa;

     aNume = (#23#34 % 115) + (("00" + #23#18) % -102) + (#23#34 % 1805);
     |HAZ DigControl;
     ||M_NMENVIO N    16
     aAlfa =  (#23#34 % 115) + nDig;
     |XGRABA nHandle, aAlfa;

     ||M_CODPAIS C    4
     aAlfa = #23#6 % 104;
     |XGRABA nHandle, aAlfa;

     ||M_BULTOFN N    23
     aNume = (#23#34 % 115) + (("00" + #23#18) % -102) + (#23#34 % 1805);
     |HAZ DigControl;
     aNume = aNume + nDig;

     aAlfa = aNume;
     |XGRABA nHandle, aAlfa;

     ||M_OBSERVA C    40
     aAlfa = #23#25;
     |XGRABA nHandle, aAlfa;

     ||M_OBSERV2 C    40
     aAlfa = #23#26;
     |XGRABA nHandle, aAlfa;

     ||M_FECHA   C    8
     aAlfa = (#23#5 % 704) + (#23#5 % 402) + (#23#5 % 102);
     |XGRABA nHandle, aAlfa;

     ||M_SERIEOL C    30
     aAlfa = " " * 30;
     |XGRABA nHandle, aAlfa;

     ||M_MODELON C    20
     aAlfa = " " * 20;
     |XGRABA nHandle, aAlfa;

     ||M_MODELOL C    20
     aAlfa = " " * 20;
     |XGRABA nHandle, aAlfa;

     ||M_BULTORT N    16
     aAlfa = "0" * 16;
     |XGRABA nHandle, aAlfa;

     ||M_SERIENW C    30
     aAlfa = " " * 30;
     |XGRABA nHandle, aAlfa;

     ||M_VALSEMER N   12
     nNume1 = #23#22 * 100;
     aNume1 = ("000000000000" + nNume1) % -111;
     aNume1 = (aNume1 % 109) + "." + (aNume1 % 1002);
     aAlfa = aNume1;
     |XGRABA nHandle, aAlfa;

     |XGRABA nHandle, aFin;
|FPRC;

|PROCESO DHL;
     ||COCODCLI     6
     aAlfa = #20#4;
     |XGRABA nHandle, aAlfa;

     ||COA¤OD       1
     aAlfa = #23#5; aAlfa = aAlfa % -101;
     |XGRABA nHandle, aAlfa;

     ||COPADE       2
     aAlfa = #23#6; aAlfa = aAlfa % 102;
     |XGRABA nHandle, aAlfa;

     ||COEXPE       8
     aAlfa = ("00000000" + #23#4) % -108;
     |XGRABA nHandle, aAlfa;

     ||COCORRELA    1
     aAlfa = "0";
     |XGRABA nHandle, aAlfa;

     ||BLANCO       1
     aAlfa = " ";
     |XGRABA nHandle, aAlfa;

     ||COSERVICIO   1
     aAlfa = #23#7;
     |XGRABA nHandle, aAlfa;

     ||COCONSIG     40
     aAlfa = #23#8;
     |XGRABA nHandle, aAlfa;

     ||CODIRDES     40
     aAlfa = #23#9;
     |XGRABA nHandle, aAlfa;

     ||COPOBDES     20
     aAlfa = #23#10;
     |XGRABA nHandle, aAlfa;

     ||COCPDES      9
     aAlfa = #23#11;
     |XGRABA nHandle, aAlfa;

     ||COTLFDES     9
     aAlfa = #23#14;
     |XGRABA nHandle, aAlfa;

     ||COCLVPOR     1
     aAlfa = #23#16;
     |XGRABA nHandle, aAlfa;

     ||COREFCLI     35
     aAlfa = #23#17;
     |XGRABA nHandle, aAlfa;

     ||BLANCO       2
     aAlfa = "  ";
     |XGRABA nHandle, aAlfa;

     ||COBULTOS     3
     aAlfa = ("000" + #23#18) % -103;
     |XGRABA nHandle, aAlfa;

     ||COKILOS      5
     aAlfa = ("00000" + #23#19) % -105;
     |XGRABA nHandle, aAlfa;

     ||COKIVOL      5
     aAlfa = "00000";
     |XGRABA nHandle, aAlfa;

     ||CORREMBO     11
     nNume1 = #23#20 * 100;
     aNume1 = ("000000000000" + nNume1) % -110;
     aNume1 = (aNume1 % 108) + "." + (aNume1 % 902);
     aAlfa = aNume1;

     ||aAlfa = ("000000000000" + #23#20) % -111;
     |XGRABA nHandle, aAlfa;

     ||COMONRMEM    3
     aAlfa = "EUR";
     |XGRABA nHandle, aAlfa;

     ||COPREEMB     1
     aAlfa = #23#21;
     |XGRABA nHandle, aAlfa;

     ||COVASEG      9
     aAlfa = ("000000000000" + #23#22) % -109;
     |XGRABA nHandle, aAlfa;

     ||COMONVAL     3
     aAlfa = "EUR";
     |XGRABA nHandle, aAlfa;

     ||COPVASE      1
     aAlfa = #23#23;
     |XGRABA nHandle, aAlfa;

     ||COLABFIR     1
     aAlfa = #23#24;
     |XGRABA nHandle, aAlfa;

     ||BLANCO       1
     aAlfa = " ";
     |XGRABA nHandle, aAlfa;

     ||COOBSER1     40
     aAlfa = #23#25;
     |XGRABA nHandle, aAlfa;

     ||COOBSER2     40
     aAlfa = #23#26;
     |XGRABA nHandle, aAlfa;

     ||COCLVADU     1
     aAlfa = #23#27;
     |XGRABA nHandle, aAlfa;

     ||COFECSAL     8
     aAlfa = (#23#5 % 102) + (#23#5 % 402) + (#23#5 % 704);
     |XGRABA nHandle, aAlfa;

     ||BLANCO       40
     ||BLANCO       40
     ||BLANCO       20
     ||BLANCO       5
     ||BLANCO       5
     ||BLANCO       15
     aAlfa = " " * 125;
     |XGRABA nHandle, aAlfa;

     ||COCLPINT     3
     aAlfa = #23#28;
     |XGRABA nHandle, aAlfa;

     ||COPRODU      3
     aAlfa = #23#29;
     |XGRABA nHandle, aAlfa;

     ||CONOMCTO     25
     aAlfa = #23#15;
     |XGRABA nHandle, aAlfa;

     ||CODESBIE     70
     aAlfa = " " * 70;
     |XGRABA nHandle, aAlfa;

     |XGRABA nHandle, aFin;
|FPRC;

|PROCESO pcegm023;
     |SI nSw = 1; |HAZ DHL; |FINSI;
     |SI nSw = 2; |HAZ CHRONOEXPRES; |FINSI;
|FPRC;

|DEFBUCLE pcegm023;
     #23#2;
     ;
     #0#0, #0#2;
     #0#0, #0#2;
     ;
     NULL, pcegm023;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     aFin = &13;
     aFin = aFin + &10;

     |DFICE aAlfa;
     aFic = aAlfa + Usuario;
     |XABRE "BW", aFic, nHandle;
     |SI FSalida ! 0;
          |MENAV "0000Error al crear el fichero";
     |SINO;
          |BUCLE pcegm023;
          |XCIERRA nHandle;

          |SI nSw = 1;
               aAlfa = #0#3; |QBF aAlfa;
               |SI aAlf1 ! "/"; |Y aAlf1 ! "\"; aAlfa = aAlfa + "\"; |FINSI;
               aAlfa = aAlfa + #0#7; |QBF aAlfa;
          |SINO;
               aAlfa = #0#5; |QBF aAlfa;
               aAlf1 = aAlfa % -101;
               |SI aAlf1 ! "/"; |Y aAlf1 ! "\"; aAlfa = aAlfa + "\"; |FINSI;
               aAlfa = aAlfa + "MEC" + #20#9;
               aAlfa = aAlfa + (#0#2 % 102) + (#0#2 % 402) + (#0#2 % 902);
               aAlfa = aAlfa + (("00" + #0#6) % -102) + ".txt";
          |FINSI;

          aIP = "";
          |IP_REMOTO aIP;
          |SI aIP = "";
               |COPIA_FICHERO aFic, aAlfa;
          |SINO;
               |ENVIA_FICHERO aFic, aAlfa;
          |FINSI;
          |SI FSalida ! 0;
               |MENAV "0000Error al copiar el fichero...";
          |FINSI;
          |FBORRA aFic;
     |FINSI;
|FPRC;

|PROCESO Agencia; |TIPO 0;
     |ESTADO_CONTROL nBoton1, "DISABLE";
     |ESTADO_CONTROL nBoton2, "DISABLE";
     |C_M #0#3, 1, "N";
     |C_M #0#4, 1, "N";
     |C_M #0#5, 1, "N";
     |C_M #0#6, 1, "N";
     |C_M #0#7, 1, "N";
     |SI #0#0 = #20#1;
          nSw = 1; ||DHL
          |ESTADO_CONTROL nBoton1, "ENABLE";
          |C_M #0#3, 1, "S";
          |C_M #0#7, 1, "S";
     |SINO;
          |SI #0#0 = #20#2;
               nSw = 2; ||CHRONOEXPRES
               |ESTADO_CONTROL nBoton2, "ENABLE";
               |C_M #0#4, 1, "S";
               |C_M #0#5, 1, "S";
               |C_M #0#6, 1, "S";
          |SINO;
               |MENAV "0000Solo se permiten las agencias DHL y CHRONOEXPRES"
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Browser2; |TIPO 0;
     |SI FSalida ! 10; |ACABA; |FINSI;

     aRuta = "D*.*";

     |BROWSE aRuta;

     aRuta = aRuta % 2; |QBF aRuta;
     |SI aRuta = "D"; aRuta = ""; |FINSI;

     |QBF aRuta;
     |SI aRuta = "";
          |ERROR;
     |SINO;
          #0#5 = aRuta;
          |PINTA #0#5;
     |FINSI;
|FPRC;

|PROCESO Browser1; |TIPO 0;
     |SI FSalida ! 10; |ACABA; |FINSI;

     aRuta = "D*.*";

     |BROWSE aRuta;

     aRuta = aRuta % 2; |QBF aRuta;
     |SI aRuta = "D"; aRuta = ""; |FINSI;

     |QBF aRuta;
     |SI aRuta = "";
          |ERROR;
     |SINO;
          #0#3 = aRuta;
          |PINTA #0#3;
     |FINSI;
|FPRC;

|PROCESO Boton1;
     |PTEC 824;
|FPRC;

|PROGRAMA;
     |ABRE #20; |LEE 000#20p; |CIERRA #20;

     |CLS;
     |CONTROL_SIMPLE 0, "BOTON,  Carpeta ", 1317, 1325, Boton1;
     nBoton1 = FSalida;
     |CONTROL_SIMPLE 0, "BOTON,  Carpeta ", 1717, 1725, Boton1;
     nBoton2 = FSalida;

     |ESTADO_CONTROL nBoton1, "DISABLE";
     |ESTADO_CONTROL nBoton2, "DISABLE";

     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
     #0#0 = 0;
     #0#1 = "";
     #0#2 = ~;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |GRABA 020#0a;
     |FINSI;
     |CIERRA #0;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |PULSATECLA;
|FPRO;
