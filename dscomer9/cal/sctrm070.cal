|FICHEROS;
     sctrm070 #0;
     sctrm007 #7;
     sctrm023 #23;
     sctrm078 #78,MANTE; || Lineas
     sctrm001 #100;
|FIN;

|VARIABLES;
     &enPantaLogo = 0;
     &eaNomLogo = "";
     nPanta = 0;
     nConta = 0;
     nModo = 0;
     nGrid1 = -1;
     nRango = 0;
     nModoEntra = 0;
     nForma = 0;
     aAlfa = "";
|FIN;

|PROCESO Evento;
     |SI FSalida = 1; |O FSalida = 2;
          |SELECT #1#78;
          |LEE 000#78=;
     |FINSI;
     |SI FSalida = 4;
     |FINSI;
|FPRC;

|PROCESO Min;
     #78#0 = #0#0;
     #78#1 = 001;
     #78#2 = "    ";
     #78#5 = "          ";
     #78#6 = " ";
     #78#7 = 000000;
|FPRC;

|PROCESO Max;
     #78#0 = #0#0;
     #78#1 = 999;
     #78#2 = "zzzz";
     #78#5 = "zzzzzzzzzz";
     #78#6 = "z";
     #78#7 = 999999;
|FPRC;

|PROCESO T70_14; |TIPO 14;    ||(*)
     |SI nGrid1 = -1;
          nRango = 1 + 4 + 8 + 16 + 32;
          |LINEAL_SIMPLE #1#78, nRango, 1902, 2998, Min, Max, Evento;
          nGrid1 = FSalida;
     |FINSI;
|FPRC;

|PROCESO T70_8; |TIPO 8; ||(*)
     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     |ABRET #78;
|FPRC;

|PROCESO T70_9; |TIPO 9; ||(*)
     |CIERRAT #78;
|FPRC;

|PROCESO BorraLin;
     |BORRA 020#78a;
|FPRC;

|DEFBUCLE BorraLin;
     #78#1;
     ;
     #0#0, 000, 00, "          ", " ", 000000;
     #0#0, 999, 99, "zzzzzzzzzz", "z", 999999;
     ;
     NULL, BorraLin;
|FIN;

|PROCESO T70_2; |TIPO 2; ||(*)
     nModo = (FEntrada / 100) ! 0;
     nForma = 0 +. 1;
     |SI nModo = 3;
          |BUCLE BorraLin;
     |FINSI;
|FPRC;

|PROCESO T70_1_7; |TIPO 7;
     nModoEntra = (FEntrada / 100) ! 0;
     |SI nModoEntra = 1;
          |BUCLE BorraLin;
          |REFRESCACONTROL nGrid1;
     |FINSI;
|FPRC;

|PROCESO T70_12; |TIPO 12;    ||(*)
     |SI nModoEntra = 1; |Y FSalida = 7;
          |BUCLE BorraLin;
     |FINSI;
|FPRC;

|PROCESO T70_30; |TIPO 30;    ||(*)
     nModo = (FEntrada / 100) ! 0;

     #78#0 = #0#0;
     #78#2 = 0;
     #78#3 = 0;
     #78#5 = "";
     #78#6 = "";
     #78#7 = 0;
     |LEE 000#78];
     |SI FSalida ! 0; |O #78#0 ! #0#0;
          |SI nModo = 1;
               |MENAV "0000Se anulan los datos entrados.";
          |SINO;
               |MENAV "0000No existen lineas, se borra la cabecera.";
          |FINSI;
          |BORRA 020#0a;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO T70_13; |TIPO 13;
     |PINPA #0#0; nPanta = FSalida;
     eaNomLogo = #100#1;
     |HAZ TraeLogoPan;
     enPantaLogo = nPanta;
     |HAZ PintaLogoPan;
|FPRC;

|PROCESO T7; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |LEE 000#0u;
          |SI FSalida = 0;
               nConta = #0#0 + 1;
          |SINO;
               nConta = 1;
          |FINSI;
          |DDEFECTO #0;
          #0#0 = nConta;
     |FINSI;
|FPRC;

|PROCESO DesGrupo0; |TIPO 0;
     |ABRE #7;
     #7#0 = #78#2;
     |LEE 000#7=;
     |SI FSalida = 0;
          #78#4 = #7#1; |PINTA #78#4;
     |SINO;
          |SI #78#2 = 0;
               #78#4 = "Todos los grupos"; |PINTA #78#4;
          |SINO;
               |MENAV "0000No existe grupo...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #7;
|FPRC;

|PROCESO Min23;
     #23#0 = #78#5;
     #23#2 = #78#1;
     #23#4 = #78#6;
     #23#5 = 000000;
|FPRC;

|PROCESO Max23;
     #23#0 = #78#5;
     #23#2 = #78#1;
     #23#4 = #78#6;
     #23#5 = 999999;
|FPRC;

|PROCESO Servi66; |TIPO 66;
     |ABRE #23;
     #23#0 = #78#5;
     #23#2 = #78#1;
     #23#4 = #78#6;
     #23#5 = #78#7;
     |LEE 020#23];
     |CONSULTA_F_CLAVE #1#23, Min23, Max23;
     |SI FSalida = 0;
          #78#7 = #23#5; |PINTA #78#7;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #23;
|FPRC;

|PROCESO Servi0; |TIPO 0;
     |ABRE #23;
     #23#0 = #78#5;
     #23#2 = #78#1;
     #23#4 = #78#6;
     #23#5 = #78#7;
     |LEE 000#23=;
     |SI FSalida = 0;
          #78#8 = #23#6; |PINTA #78#8;
     |FINSI;
     |CIERRA #23;
|FPRC;

|PROCESO ModiCampo; |TIPO 0;
     |C_M #78#6, 1, "S";
     |C_M #78#7, 1, "S";

     aAlfa = #78Campo; |QBF aAlfa;
     |SI Campo = 5; |Y aAlfa = "";
          |C_M #78#6, 1, "N";
          |C_M #78#7, 1, "N";
     |FINSI;
     |SI Campo = 6; |Y aAlfa = "";
          |C_M #78#7, 1, "N";
     |FINSI;
|FPRC;
