               ||Cambio de codigos de Articulos

|FICHEROS;
     agifa159 #0;
     agifa060 #15;       ||Familias
     agifa019 #1;        ||Articulos
     agifa071 #3;        ||Lineas de Albaran
     agifa073 #4;        ||Lineas Pedidos
     agifa070 #5;        ||Lineas Depositos
     agifa067 #7;        ||Lineas Pedidos Compras
     agifa080 #8;        ||Lineas Albaranes Compras
     agifa069 #12;       ||Lineas de Facturas Contado
     agifa147 #13;       ||Lineas Facturas Proforma;
     agifa039 #14;       ||Precio clientes / Articulos
     agifa154 #20;       ||Linas Ajuste Articulos
     referen@;
|FIN;

|VARIABLES;
     &eaFic = "";
     &eaOrg = "";
     &eaDes = "";
     &enErr = 0;
     &CambDesc = "";
     &AltaArt  = "";

     i = 0;
     &tabla = 0;
     &sust = " ";
     &stock = " ";
     &tipo = " ";
     fam = "";
     fam1 = "";
     aDef = "";
     aAlfa = "";
|FIN;

|PROCESO pcegm005;
     #referen@#18 = fam1;
     |GRABA 020#referen@.a;
     |LIBERA #referen@;
|FPRC;

|DEFBUCLE pcegm005;
     #referen@#1003;
     18;
     "     ", 000001, 001, fam;
     "zzzzz", 999999, 999, fam;
     be;
     NULL, pcegm005;
|FIN;

|PROCESO pcegm003;
     #referen@#13 = fam1;
     |GRABA 020#referen@.a;
     |LIBERA #referen@;
|FPRC;

|DEFBUCLE pcegm003;
     #referen@#1003;
     13;
     "     ", 000001, 001, fam;
     "zzzzz", 999999, 999, fam;
     be;
     NULL, pcegm003;
|FIN;

|PROCESO copiafam;
     |ABRE #15;
     #15#0 = fam;
     |LEE  001#15=;
     |SI FSalida = 0;
          |SI sust = "S";
               |BORRA 021#15a;
          |FINSI;
     |FINSI;
     #15#0 = fam1;
     |SI CambDesc = "S"; #15#1 = #20#5; |FINSI;
     |SI AltaArt = "S";
          |GRABA 000#15n;
          |SI FSalida ! 0;
               enErr = FSalida;
               eaFic = "agifa060";
               eaOrg = fam;
               eaDes = fam1;
               |HAZ Print;
          |FINSI;
     |FINSI;
     |LIBERA #15;
     |CIERRA #15;
|FPRC;

|PROCESO arti;
     #1#2 = fam1;
     |GRABA 021#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE articulo;
#1#1;
2;
"                    " , fam;
"zzzzzzzzzzzzzzzzzzzz" , fam;
be;
NULL , arti;
|FIN;

||========================= CAMBIO CODIGO EN ALBARANES ====================

|PROCESO linalb;
     #3#13 = fam1;        ||Articulo nuevo
     |GRABA 021#3a;
     |LIBERA #3;
|FPRC;

|DEFBUCLE albaran;
#3#2;
;
"     " ,       0 , fam;
"zzzzz" ,  999999 , fam;
be;
NULL , linalb;
|FIN;

||========================= CAMBIO CODIGO EN PEDIDOS ======================

|PROCESO linpedi;
     #4#18 = fam1;
     |GRABA 021#4a;
     |LIBERA #4;
|FPRC;

|DEFBUCLE pedidos;
#4#3;
18;
"                    " , "     " ,       0 , "      " , fam;
"zzzzzzzzzzzzzzzzzzzz" , "zzzzz" ,  999999 , "zzzzzz" , fam;
be;
NULL , linpedi;
|FIN;

||========================= CAMBIO CODIGO EN DEPOSITOS ====================

|PROCESO lindepo;
     #5#13 = fam1;
     |GRABA 021#5a;
     |LIBERA #5;
|FPRC;

|DEFBUCLE deposito;
#5#1;
13;
"     " ,       0 ,   0 , fam;
"zzzzz" ,  999999 , 999 , fam;
be;
NULL , lindepo;
|FIN;

||========================= CAMBIO CODIGO EN PEDIDOS COMPRAS ==============

|PROCESO linpedcom;
     #7#18 = fam1;
     |GRABA 021#7a;
     |LIBERA #7;
|FPRC;

|DEFBUCLE pedcom;
#7#1;
18;
"     " ,       0 ,   0 , fam;
"zzzzz" ,  999999 , 999 , fam;
be;
NULL , linpedcom;
|FIN;

||========================= CAMBIO CODIGO EN ALBARANES COMPRAS ============

|PROCESO linalbcom;
     #8#13 = fam1;
     |GRABA 021#8a;
     |LIBERA #8;
|FPRC;

|DEFBUCLE albcom;
#8#2;
;
"     " ,       0 , fam;
"zzzzz" ,  999999 , fam;
be;
NULL , linalbcom;
|FIN;

||========================== CAMBIO DE CODIGO FACTURAS CONTADO ============

|PROCESO lincont;
     #12#13 = fam1;
     |GRABA 021#12a;
     |LIBERA #12;
|FPRC;

|DEFBUCLE contado;
#12#2;
;
"     " ,       0 , fam;
"zzzzz" ,  999999 , fam;
be;
NULL , lincont;
|FIN;

||========================== CAMBIO DE CODIGO FACTURAS PROFORMA ===========

|PROCESO linprof;
     #13#13 = fam1;
     |GRABA 021#13a;
     |LIBERA #13;
|FPRC;

|DEFBUCLE proforma;
#13#2;
;
"     " ,       0 , fam;
"zzzzz" ,  999999 , fam;
be;
NULL , linprof;
|FIN;

||======================== CAMBIO DE CODIGO CLIENTES / ARTICULOS ==========

|PROCESO cliart1;
     |BORRA 021#14a;
     #14#1 = fam1;
     |GRABA 000#14n;
     |SI FSalida ! 0;
          enErr = FSalida;
          eaFic = "agifa039";
          eaOrg = fam;
          eaDes = fam1;
          |HAZ Print;
     |FINSI;
     |LIBERA #14;
|FPRC;

|DEFBUCLE cliart;
#14#1;
;
"      " , fam;
"zzzzzz" , fam;
be;
NULL , cliart1;
|FIN;

|PROGRAMA;
|HAZ bucleini;
|FPRO;

|PROCESO empieza;
     fam = #20#2 % 103;  ||antiguo
     fam1 = #20#3 % 103; ||nuevo
     #0#0 = fam;
     #0#1 = fam1;
     |PINTA #0#0; |PINTA #0#1;
     |HAZ copiafam;
     |SI sust = "S";          ||Si es sustituir, debo hacerlo en donde haya
          |BUCLE articulo;    ||Articulos
          |BUCLE albaran;
          |BUCLE pedidos;
          |BUCLE deposito;
          |BUCLE pedcom;
          |BUCLE albcom;
          |BUCLE contado;
          |BUCLE proforma;
          |BUCLE cliart;

          |DDEF aDef;
          |HAZ EsPCEGroup;
          |SI FSalida = 0;
               aAlfa = aDef + "pcegm003";
               |CARGA_DEF aAlfa, referen@;
               |SI FSalida = 0;
                    |BUCLE pcegm003;
                    |DESCARGA_DEF #referen@;
               |FINSI;
               aAlfa = aDef + "pcegm005";
               |CARGA_DEF aAlfa, referen@;
               |SI FSalida = 0;
                    |BUCLE pcegm005;
                    |DESCARGA_DEF #referen@;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE primero;
#20#1;
6;
tabla ,     0, tipo;
tabla , 99999, tipo;
e;
NULL , empieza;
|FIN;

|PROCESO bucleini;
     |PINPA #0#0;
     |BUCLE primero;
     |HAZ EnviaMail;
|FPRC;
