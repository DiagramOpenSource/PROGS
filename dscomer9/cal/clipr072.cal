|FICHEROS;
     clipr072 #0;
     agifa084 #84;
     agifa069 #69;
     agifa129 #129;
     agifa019 #19;
     agifa142 #142;

     referen@;
|FIN;

|VARIABLES;
     &aDivisa  = "";
     &aMoneda  = "";
     &num_fac  = 0;
     &ser_fac  = "";
     nBase     = 0;
     nImpComi  = 0;
     nTotalComi= 0;
     nComi     = 0;

     aDef = "";
     aAlfa = "";
     aRepre = "";
     nEspe = 0;
     nTecnico = 0;
     j = 0;
|FIN;

|PROCESO Lin;
     nComi = 0;

     #129#0 = #84#34;
     |LEE 000#129=;
     |SI FSalida = 0;
          nComi = #129#2;
     |FINSI;

     |SI nComi ! 0;
          nBase = #69#5 * #69#6;
          nImpComi = nBase - (nBase / (1+ nComi / 100));
          nTotalComi = nTotalComi + nImpComi;
     |FINSI;
|FPRC;

|PROCESO FinCab;
     #84#26 = nTotalComi;

     |GRABA 020#84a;
     |LIBERA #84;
|FPRC;

|PROCESO Cab;
     nTotalComi = 0;
     aDivisa = #84#65;
     aMoneda = #84#67;
     |HAZ Divisas084;
|FPRC;

|DEFBUCLE agifa084;
     #84#3;
     ;
     #0#6, #0#4, #0#0, #0#2;
     #0#7, #0#5, #0#1, #0#3;
     be;
     NULL, Cab, Lin, FinCab;
|FIN;

|PROCESO Tipo3Cli; |TIPO 3;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;
     |ABRE #129;
     |BUCLE agifa084;
     |CIERRA #129;
|FPRC;

|PROCESO ClipreComi;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;
     |ABRE #129;
     |HAZ Cab;
     |BUCLELIN 0 Lin #84;
     |HAZ FinCab;
     |CIERRA #129;
|FPRC;

|PROCESO ClipreRepre;
     |DDEF aDef;
     aAlfa = aDef + "clipr078";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida ! 0;
          |MENAV "0000Error al cargar 'clipr078'";
     |SINO;
          |ABRE #referen@;
          |SELECT #2#referen@;
          #referen@#2 = #84#48;
          |LEE 000#referen@.=;
          nEspe = -1;
          |SI FSalida = 0; nEspe = #referen@#1; |FINSI;
          |CIERRA #referen@;
          |DESCARGA_DEF #referen@;
     |FINSI;

     aAlfa = aDef + "clipr001";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida ! 0;
          |MENAV "0000Error al cargar 'clipr001'";
     |SINO;
          |DDEFECTO #referen@;
          |ABRE #referen@;
          |SELECT #6#referen@;
          #referen@#58 = #84#3;
          |LEE 000#referen@.=;
          |CIERRA #referen@;
          aRepre = #referen@#69;
          nTecnico = 69;
          |PARA j = 144; |SI j [ 156; |HACIENDO j = j + 1;
               |SI #referen@#j# = nEspe;
                    |SI #referen@#nTecnico# ! "  ";
                       aRepre = #referen@#nTecnico#;
                       |SAL;
                    |FINSI;
               |FINSI;
               nTecnico = nTecnico + 5;
          |SIGUE;
          #84#6 = aRepre;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;
