|FICHEROS;
     collm001 #0;
     collm004 #4;
     collm005 #5;
     collm006 #6;
|FIN;

|VARIABLES;
     nFactor = 0;
     nValor = 0;
     nSw = 0;
|FIN;

|PROCESO collm006;
     #5#2 = #5#2 + #6#6;
|FPRC;

|PROCESO collm005b;
     #5#3 = #5#2 * #0#7;
     #5#4 = #5#3 * #0#8;
     |GRABA 020#5a;
     |LIBERA #5;
|FPRC;

|PROCESO collm005a;
     #5#2 = 0;
|FPRC;

|DEFBUCLE collm005;
     #5#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, collm005a, collm006, collm005b;
|FIN;

|PROCESO collm004;
     #4#3 = #4#2 * #0#7;
     |GRABA 020#4a;
     |LIBERA #4;
|FPRC;

|DEFBUCLE collm004;
     #4#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, collm004;
|FIN;

|PROCESO Recalcula;
     |BUCLE collm004;
     |BUCLE collm005;
|FPRC;

|PROGRAMA;
     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0; nSw = 1; |GRABA 020#0b; |FINSI;
     nFactor = #0#7;
     nValor = #0#8;
     |CLS;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |SI nSw = 0;
               |SI nFactor ! #0#7; |O nValor ! #0#8;
                    |CONFI "0000N¿Desea recalcular los resguardos?";
                    |SI FSalida = 0;
                         |HAZ Recalcula;
                    |FINSI;
               |FINSI;
          |FINSI;
          |GRABA 020#0a;
     |FINSI;
     |CIERRA #0;
|FPRO;
