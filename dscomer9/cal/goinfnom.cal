|FICHEROS;
     goinfnom #0;
     gotrabal #1;
     goptrcom #7;
     gohorno2 #8;
     gohorno1 #9;
     gohornom #10;
     gotrabaj #11;
     gocatcon #12;
     guerm017 #13;
     guerm018 #14;
     goptrbli #15;
     gocatcot #19;  ||
     gotmp001 #20;
     gotrabat #21; ||
     gotipoho #30;
|FIN;

|VARIABLES;
     fDesde = @;
     fHasta = @;
     nSwObserva = 0;
     nHayObs = 0;
     &enSwObs = 0;
     &enDetalle = 0;
     nEsta1 = 0;
     nEsta2 = 0;
     nEsta3 = 0;
     nEsta4 = 0;
     nSw = 0;
     nPrime = 0;
     fFechaAnt = @;
     nTrabaAnt = 0;
     nNume = 0;
     nHoraPrime1 = 0;
     nHoraPrime2 = 0;
     nHoraPrime3 = 0;
     nHoraPrime4 = 0;
     nGru1 = 0;
     nGru2 = 0;
     nGru3 = 0;
     nGru4 = 0;
     nHoraGruNor = 0;
     nImpoGruNor = 0;
     nHoraGruExt = 0;
     nImpoGruExt = 0;
     nHoraDieta = 0;
     nImpoDieta = 0;
     fFecha = @;
     nTipoDieta = 0;
     nCampo = 0;
     nHayPrecio = 0;
     nResto = 0;
     nLimite = 0;
     nPreGruNor = 0;
     nPreGruExt = 0;
     aDescri = "";
     nTipoHora = 0;
     nImpo = 0;
     nHora = 0;
     nExtra = 0;
     nImpoEx = 0;
     nHoraEx = 0;
     i = 0;
     nDieta = 0;
     nBueno = 0;
     nTraba = 0;

     aAlfa = "";
     fAntFecha = @;
     nAntTrab = 0;
     nPrimero = 0;
     nHoras = 0;
     nH6 = 0;
     nH21 = 0;
     nPrecio = 0;
     nTipo = 0;
     nTotal = 0;
     aSerPre = "";
     nNumPre = 0;
     nLinParte = 0;
     nLinea = 0;
|FIN;

|PROCESO BorraSin9;
     |BORRA 020#9a;
|FPRC;

|DEFBUCLE BorraSin9;
     #9#1;
     ;
     #10#0, #10#1, 01;
     #10#0, #10#1, 99;
     be;
     NULL, BorraSin9;
|FIN;

|PROCESO BorraSin8;
     |BORRA 020#8a;
|FPRC;

|DEFBUCLE BorraSin8;
     #8#1;
     ;
     #10#0, #10#1, 000;
     #10#0, #10#1, 999;
     be;
     NULL, BorraSin8;
|FIN;

|PROCESO BorraSin10;
     |BORRA 020#10a;
     |BUCLE BorraSin8;
     |BUCLE BorraSin9;
|FPRC;

|DEFBUCLE BorraSin10;
     #10#1;
     ;
     nTraba, fDesde;
     nTraba, fHasta;
     be;
     NULL, BorraSin10;
|FIN;

|PROCESO SinContrato;
     nTraba = #1#0;
     nNume = #1#2; nNume = nNume - 1;
     fHasta = nNume;
     |BUCLE BorraSin10;
     fDesde = #1#3 + 1;
|FPRC;

|DEFBUCLE SinContrato;
     #1#1;
     ;
     #0#6, 0001;
     #0#7, 9999;
     ;
     NULL, SinContrato;
|FIN;

|PROCESO ModiObse; |TIPO 7;
     |SI #0#4 = "D";
          |C_M #0#109, 1, "S";
     |SINO;
          |C_M #0#109, 1, "N";
     |FINSI;
|FPRC;

|PROCESO AcumuSelec;
     |PARA i = 9; |SI i [ 18; |HACIENDO i = i + 1;
          |SI #0i = nTipoHora; |Y #0i ! 0;
               nHora = (i - 9) * 2 + 23;
               nImpo = nHora + 1;
               #10nHora = #10nHora + nHoras + nExtra;
               #10nImpo = #10nImpo + (nHoras * nPrecio) + (nExtra * nPreGruExt);
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Graba10;
     |SI nPrime = 1;
          nSw = 0;
          |SI nGru1 = 1; |Y nSw = 0;
               #10#3 = nHoraGruNor;
               #10#4 = nImpoGruNor;
               #10#5 = nHoraGruExt;
               #10#6 = nImpoGruExt;
               nSw = 1;
          |FINSI;
          |SI nGru2 = 1; |Y nSw = 0;
               #10#7 = nHoraGruNor;
               #10#8 = nImpoGruNor;
               #10#9 = nHoraGruExt;
               #10#10 = nImpoGruExt;
               nSw = 1;
          |FINSI;
          |SI nGru3 = 1; |Y nSw = 0;
               #10#13 = nHoraGruNor;
               #10#14 = nImpoGruNor;
               #10#15 = nHoraGruExt;
               #10#16 = nImpoGruExt;
               nSw = 1;
          |FINSI;
          |SI nGru4 = 1; |Y nSw = 0;
               #10#17 = nHoraGruNor;
               #10#18 = nImpoGruNor;
               #10#19 = nHoraGruExt;
               #10#20 = nImpoGruExt;
               nSw = 1;
          |FINSI;
          |SI nSw = 0;
/*
               #10#3 = nHoraGruNor;
               #10#4 = nImpoGruNor;
               #10#5 = nHoraGruExt;
               #10#6 = nImpoGruExt;
*/
               |SI nEsta1 = 1; |Y nSw = 0;
                    #10#3 = nHoraGruNor;
                    #10#4 = nImpoGruNor;
                    #10#5 = nHoraGruExt;
                    #10#6 = nImpoGruExt;
                    nSw = 1;
               |FINSI;
               |SI nEsta2 = 1; |Y nSw = 0;
                    #10#7 = nHoraGruNor;
                    #10#8 = nImpoGruNor;
                    #10#9 = nHoraGruExt;
                    #10#10 = nImpoGruExt;
                    nSw = 1;
               |FINSI;
               |SI nEsta3 = 1; |Y nSw = 0;
                    #10#13 = nHoraGruNor;
                    #10#14 = nImpoGruNor;
                    #10#15 = nHoraGruExt;
                    #10#16 = nImpoGruExt;
                    nSw = 1;
               |FINSI;
               |SI nEsta4 = 1; |Y nSw = 0;
                    #10#17 = nHoraGruNor;
                    #10#18 = nImpoGruNor;
                    #10#19 = nHoraGruExt;
                    #10#20 = nImpoGruExt;
                    nSw = 1;
               |FINSI;
          |FINSI;
          #10#11 = nHoraDieta;
          #10#12 = nImpoDieta;
          |GRABA 020#10a;
          |LIBERA #10;
     |FINSI;
     nPrime = 1;
|FPRC;

|PROCESO gohorno1;
     nTraba = #9#0;
     nTipoHora = #9#2;
     |HAZ LeeValor;
     |HAZ QueTipo;

     nHoras = #9#4;
     |SI #9#0 ! nTrabaAnt; |O #9#1 ! fFechaAnt;
          |HAZ Graba10;
          nTrabaAnt = #9#0;
          fFechaAnt = #9#1;
          |DDEFECTO #10;
          #10#0 = #9#0;
          #10#1 = #9#1;
          #10#2 = #11#1;
          |LEE 101#10=;
          |SI FSalida ! 0; |GRABA 020#10b; |FINSI;
          nHoraGruNor = 0;nImpoGruNor = 0;nHoraGruExt = 0;nImpoGruExt = 0;
          nHoraDieta = 0;nImpoDieta = 0;
          nGru1 = 0;nGru2 = 0;nGru3 = 0;nGru4 = 0;
          nEsta1 = 0;nEsta2 = 0;nEsta3 = 0;nEsta4 = 0;
     |FINSI;
     |SI nTipo = 1;
          nEsta1 = 1;
          |SI nTipoHora = nHoraPrime1; nGru1 = 1; |FINSI;
     |FINSI;
     |SI nTipo = 2;
          nEsta2 = 1;
          |SI nTipoHora = nHoraPrime2; nGru2 = 1; |FINSI;
     |FINSI;
     |SI nTipo = 3;
          nEsta2 = 3;
          |SI nTipoHora = nHoraPrime3; nGru3 = 1; |FINSI;
     |FINSI;
     |SI nTipo = 4;
          nEsta2 = 4;
          |SI nTipoHora = nHoraPrime4; nGru4 = 1; |FINSI;
     |FINSI;

     nExtra = 0;
     |SI nTipoHora = nTipoDieta;
          nHoraDieta = nHoraDieta + nHoras;
          nImpoDieta = nImpoDieta + (nHoras * nPrecio);
     |SINO;
          nNume = nHoraGruNor + nHoras;
          |SI nNume > nLimite;
               nExtra = nNume - nLimite;
               nHoras = nHoras - nExtra;
          |FINSI;
          |SI nTipo > 0;
               nHoraGruNor = nHoraGruNor + nHoras;
               nImpoGruNor = nImpoGruNor + (nHoras * nPrecio);
               nHoraGruExt = nHoraGruExt + nExtra;
               nImpoGruExt = nImpoGruExt + (nExtra * nPreGruExt);
          |FINSI;
     |FINSI;
     |HAZ AcumuSelec;
|FPRC;

|DEFBUCLE gohorno1;
     #9#1;
     ;
     #0#6, #0#0, 01;
     #0#7, #0#1, 99;
     ;
     NULL, gohorno1;
|FIN;

|PROCESO &suma; |TIPO 0; || Resumido
     |SI enSwObs = 1;
          |ACABA;
     |FINSI;
     #0#29 = #0#29 + #20#3;
     #0#30 = #0#30 + #20#4;
     #0#31 = #0#31 + #20#5;
     #0#32 = #0#32 + #20#6;
     #0#33 = #0#33 + #20#7;
     #0#34 = #0#34 + #20#8;
     #0#35 = #0#35 + #20#9;
     #0#36 = #0#36 + #20#10;
     #0#37 = #0#37 + #20#11;
     #0#38 = #0#38 + #20#12;
     #0#39 = #0#39 + #20#13;
     #0#40 = #0#40 + #20#14;
     #0#41 = #0#41 + #20#15;
     #0#42 = #0#42 + #20#16;
     #0#43 = #0#43 + #20#17;
     #0#44 = #0#44 + #20#18;
     #0#45 = #0#45 + #20#19;
     #0#46 = #0#46 + #20#20;
     #0#47 = #0#47 + #20#21;
     #0#48 = #0#48 + #20#22;
     #0#49 = #0#49 + #20#23;
     #0#50 = #0#50 + #20#24;
     #0#51 = #0#51 + #20#25;
     #0#52 = #0#52 + #20#26;
     #0#53 = #0#53 + #20#27;
     #0#54 = #0#54 + #20#28;
     #0#55 = #0#55 + #20#29;
     #0#56 = #0#56 + #20#30;
     #0#57 = #0#57 + #20#31;
     #0#58 = #0#58 + #20#32;
     #0#59 = #0#59 + #20#33;
     #0#60 = #0#60 + #20#34;
     #0#61 = #0#61 + #20#35;
     #0#62 = #0#62 + #20#36;
     #0#63 = #0#63 + #20#37;
     #0#64 = #0#64 + #20#38;
     #0#65 = #0#65 + #20#39;
     #0#66 = #0#66 + #20#40;
     #0#67 = #0#67 + #20#41;
     #0#68 = #0#68 + #20#42;
|FPRC;

|PROCESO &acera; |TIPO 0;
     |PARA i = 69; |SI i [ 108; |HACIENDO i = i + 1;
          #0i = 0;
     |SIGUE;
|FPRC;

|PROCESO &suma1; |TIPO 0;
     #0#29 = #0#29 + #10#3;
     #0#30 = #0#30 + #10#4;
     #0#31 = #0#31 + #10#5;
     #0#32 = #0#32 + #10#6;
     #0#33 = #0#33 + #10#7;
     #0#34 = #0#34 + #10#8;
     #0#35 = #0#35 + #10#9;
     #0#36 = #0#36 + #10#10;
     #0#37 = #0#37 + #10#11;
     #0#38 = #0#38 + #10#12;
     #0#39 = #0#39 + #10#13;
     #0#40 = #0#40 + #10#14;
     #0#41 = #0#41 + #10#15;
     #0#42 = #0#42 + #10#16;
     #0#43 = #0#43 + #10#17;
     #0#44 = #0#44 + #10#18;
     #0#45 = #0#45 + #10#19;
     #0#46 = #0#46 + #10#20;
     #0#47 = #0#47 + #10#21;
     #0#48 = #0#48 + #10#22;
     #0#49 = #0#49 + #10#23;
     #0#50 = #0#50 + #10#24;
     #0#51 = #0#51 + #10#25;
     #0#52 = #0#52 + #10#26;
     #0#53 = #0#53 + #10#27;
     #0#54 = #0#54 + #10#28;
     #0#55 = #0#55 + #10#29;
     #0#56 = #0#56 + #10#30;
     #0#57 = #0#57 + #10#31;
     #0#58 = #0#58 + #10#32;
     #0#59 = #0#59 + #10#33;
     #0#60 = #0#60 + #10#34;
     #0#61 = #0#61 + #10#35;
     #0#62 = #0#62 + #10#36;
     #0#63 = #0#63 + #10#37;
     #0#64 = #0#64 + #10#38;
     #0#65 = #0#65 + #10#39;
     #0#66 = #0#66 + #10#40;
     #0#67 = #0#67 + #10#41;
     #0#68 = #0#68 + #10#42;

     #0#69 = #0#69 + #10#3;
     #0#70 = #0#70 + #10#4;
     #0#71 = #0#71 + #10#5;
     #0#72 = #0#72 + #10#6;
     #0#73 = #0#73 + #10#7;
     #0#74 = #0#74 + #10#8;
     #0#75 = #0#75 + #10#9;
     #0#76 = #0#76 + #10#10;
     #0#77 = #0#77 + #10#11;
     #0#78 = #0#78 + #10#12;
     #0#79 = #0#79 + #10#13;
     #0#80 = #0#80 + #10#14;
     #0#81 = #0#81 + #10#15;
     #0#82 = #0#82 + #10#16;
     #0#83 = #0#83 + #10#17;
     #0#84 = #0#84 + #10#18;
     #0#85 = #0#85 + #10#19;
     #0#86 = #0#86 + #10#20;
     #0#87 = #0#87 + #10#21;
     #0#88 = #0#88 + #10#22;
     #0#89 = #0#89 + #10#23;
     #0#90 = #0#90 + #10#24;
     #0#91 = #0#91 + #10#25;
     #0#92 = #0#92 + #10#26;
     #0#93 = #0#93 + #10#27;
     #0#94 = #0#94 + #10#28;
     #0#95 = #0#95 + #10#29;
     #0#96 = #0#96 + #10#30;
     #0#97 = #0#97 + #10#31;
     #0#98 = #0#98 + #10#32;
     #0#99 = #0#99 + #10#33;
     #0#100 = #0#100 + #10#34;
     #0#101 = #0#101 + #10#35;
     #0#102 = #0#102 + #10#36;
     #0#103 = #0#103 + #10#37;
     #0#104 = #0#104 + #10#38;
     #0#105 = #0#105 + #10#39;
     #0#106 = #0#106 + #10#40;
     #0#107 = #0#107 + #10#41;
     #0#108 = #0#108 + #10#42;
|FPRC;

|PROCESO FechaFin;
     |SI #1#3 > #0#8;
          nBueno = 0;
     |FINSI;
|FPRC;

|PROCESO FechaFin0;
     nBueno = 1;
|FPRC;

|DEFBUCLE FechaFin;
     #1#1;
     ;
     nTraba, 0001
     nTraba, 9999;
     ;
     FechaFin0, FechaFin;
|FIN;

|PROCESO QueTipo;
     nTipo = 0;
     |SI #11#28 = "N";
          nTipoDieta = #12#91;
          ||Dia Normal
          |PARA i = 27; |SI i [ 34; |Y nTipo = 0; |HACIENDO i = i + 1;
               nHora = 3; nImpo = 4; nHoraEx = 5; nImpoEx = 6;
               nHoraPrime1 = #12#27;
               nPreGruNor = #12#14;
               nPreGruExt = #12#15;
               nLimite = #12#92;
               |SI #12i = nTipoHora; nTipo = 1; |SAL; |FINSI;
          |SIGUE;

          ||Nocturna
          |PARA i = 43; |SI i [ 50; |Y nTipo = 0; |HACIENDO i = i + 1;
               nHora = 7; nImpo = 8; nHoraEx = 9; nImpoEx = 10;
               nHoraPrime2 = #12#43;
               nPreGruNor = #12#21;
               nPreGruExt = #12#22;
               nLimite = #12#93;
               |SI #12i = nTipoHora; nTipo = 2; |SAL; |FINSI;
          |SIGUE;
          ||Defi1
          |PARA i = 75; |SI i [ 82; |Y nTipo = 0; |HACIENDO i = i + 1;
               nHora = 13; nImpo = 14; nHoraEx = 15; nImpoEx = 16;
               nHoraPrime3 = #12#75;
               nPreGruNor = #12#23;
               nPreGruExt = #12#24;
               nLimite = #12#94;
               |SI #12i = nTipoHora; nTipo = 3;  |SAL; |FINSI;
          |SIGUE;
          ||Defi2
          |PARA i = 83; |SI i [ 90; |Y nTipo = 0; |HACIENDO i = i + 1;
               nHora = 17; nImpo = 18; nHoraEx = 19; nImpoEx = 20;
               nHoraPrime4 = #12#83;
               nPreGruNor = #12#25;
               nPreGruExt = #12#26;
               nLimite = #12#95;
               |SI #12i = nTipoHora; nTipo = 4; |SAL; |FINSI;
          |SIGUE;
     |SINO;
          nTipoDieta = #11#73;
          ||Dia Normal
          |PARA i = 32; |SI i [ 39; |Y nTipo = 0; |HACIENDO i = i + 1;
               nHora = 3; nImpo = 4; nHoraEx = 5; nImpoEx = 6;
               nHoraPrime1 = #11#32;
               nPreGruNor = #11#29;
               nPreGruExt = #11#31;
               nLimite = #11#30;
               |SI #11i = nTipoHora; nTipo = 1; |SAL; |FINSI;
          |SIGUE;

          ||Nocturna
          |PARA i = 43; |SI i [ 50; |Y nTipo = 0; |HACIENDO i = i + 1;
               nHora = 7; nImpo = 8; nHoraEx = 9; nImpoEx = 10;
               nHoraPrime2 = #11#43;
               nPreGruNor = #11#40;
               nPreGruExt = #11#42;
               nLimite = #11#41;
               |SI #11i = nTipoHora; nTipo = 2; |SAL; |FINSI;
          |SIGUE;
          ||Defi1
          |PARA i = 54; |SI i [ 61; |Y nTipo = 0; |HACIENDO i = i + 1;
               nHora = 13; nImpo = 14; nHoraEx = 15; nImpoEx = 16;
               nHoraPrime3 = #11#54;
               nPreGruNor = #11#51;
               nPreGruExt = #11#53;
               nLimite = #11#50;
               |SI #11i = nTipoHora; nTipo = 3;  |SAL; |FINSI;
          |SIGUE;
          ||Defi2
          |PARA i = 65; |SI i [ 72; |Y nTipo = 0; |HACIENDO i = i + 1;
               nHora = 17; nImpo = 18; nHoraEx = 19; nImpoEx = 20;
               nHoraPrime4 = #11#65;
               nPreGruNor = #11#62;
               nPreGruExt = #11#64;
               nLimite = #11#63;
               |SI #11i = nTipoHora; nTipo = 4; |SAL; |FINSI;
          |SIGUE;
     |FINSI;
     |SI nTipo = 0;
          nLimite = 9999999999;
     |FINSI;
|FPRC;

|PROCESO ObservaParte;
     aAlfa = #7#5; |QBF aAlfa;
     |SI aAlfa = "";
          |ACABA;
     |FINSI;

     #8#0 = #9#0;
     #8#1 = #9#1;
     #8#2 = 999;
     |LEE 000#8];
     |SI FSalida = 0;
          |LEE 000#8a;
     |SINO;
          |LEE 000#8u;
     |FINSI;
     |SI FSalida = 0; |Y #8#0 = #9#0;  |Y #8#1 = #9#1;
          nLinea = #8#2 + 1;
     |SINO;
          nLinea = 1;
     |FINSI;
     |DDEFECTO #8;
     #8#0 = #9#0;
     #8#1 = #9#1;
     #8#2 = nLinea;
     #8#3 = #7#5;
     |GRABA 020#8n;
|FPRC;

|DEFBUCLE ObservaParte;
     #7#1;
     ;
     aSerPre, nNumPre, fFecha, nLinParte, 001;
     aSerPre, nNumPre, fFecha, nLinParte, 999;
     ;
     NULL, ObservaParte;
|FIN;

|PROCESO Totales;
     |HAZ QueTipo;

     |SI nHayPrecio = 1;
          nPreGruNor = nPrecio;
     |FINSI;

     |SI nTipo ! 0;
          nPrecio = nPreGruNor;
     |FINSI;

     |DDEFECTO #9;
     #9#0 = nTraba;
     #9#1 = fFecha;
     #9#2 = nTipoHora;
     |LEE 101#9=;
     |SI FSalida ! 0; |GRABA 020#9b; |FINSI;
     #9#3 = aDescri;
     #9#4 = #9#4 + nHoras;
     #9#5 = nPrecio;
     #9#6 = nPreGruExt;
     |GRABA 020#9a;
     |LIBERA #9;

     |SI nDieta ! 0;
          nTipoHora = nTipoDieta;      || Dietas
          |HAZ LeeValor;
          |DDEFECTO #9;
          #9#0 = nTraba;
          #9#1 = fFecha;
          #9#2 = nTipoHora;
          |LEE 101#9=;
          |SI FSalida ! 0; |GRABA 020#9b; |FINSI;
          #9#3 = aDescri;
          #9#4 = #9#4 + nDieta;
          #9#5 = nPrecio;
          |GRABA 020#9a;
          |LIBERA #9;
     |FINSI;

     |SI nLinParte ! 0;
          |BUCLE ObservaParte;
     |FINSI;
|FPRC;

|PROCESO LeeValor;
     |ABRE #11;
     #11#0 = nTraba;
     |LEE 000#11=;
     |SI FSalida ! 0; |DDEFECTO #11; |FINSI;
     |CIERRA #11;

     |ABRE #12;
     #12#0 = #11#3;
     #12#1 = #11#2;                            ||Convenio.
     |LEE 000#12=;
     |SI FSalida ! 0; |DDEFECTO #12; |FINSI;
     |CIERRA #12;

     nHayPrecio = 0;
     |ABRE #19;
     |ABRE #21;
     #21#0 = #11#0;
     #21#2 = nTipoHora;
     |LEE 000#21=;
     |SI FSalida = 0;
          nPrecio = #21#23;
          aDescri = #21#3;
          nHayPrecio = 1;
     |SINO;
          #19#0 = #11#3;
          #19#1 = #11#2;
          #19#2 = nTipoHora;
          |LEE 000#19=;
          |SI FSalida = 0;
               nPrecio = #19#23;
               aDescri = #19#3;
               nHayPrecio = 1;
          |FINSI;
     |FINSI;
     |CIERRA #21;
     |CIERRA #19;
|FPRC;

|PROCESO PartesMaqu;
     |SI #guerm018#30 = -1;
          |ACABA;
     |FINSI;

     nTraba = #guerm017#3;
     |BUCLE FechaFin;
     |SI nBueno ! 0; |ACABA; |FINSI;

     nTipoHora = #guerm018#9;
     |HAZ LeeValor;

     fFecha = #guerm017#1;

     nDieta = 0;
     |SI #guerm017#12 = "S";
          |SI #guerm017#3 ! nAntTrab; |O #guerm017#1 ! fAntFecha;
               nDieta = 1;
               nAntTrab  = #guerm017#3; fAntFecha = #guerm017#1;
          |FINSI;
     |FINSI;

     nHoras = #guerm018#5;
     |SI #guerm018#22 = "S"; |Y #guerm018#25 ! "T";
          nHoras = 0; ||para que no acumle las horas y deje
     |FINSI;

     |HAZ Totales;
|FPRC;

|DEFBUCLE PartesMaqu;
     #guerm017#2;
     ;
     #0#0, #goinfnom#6;
     #0#1, #goinfnom#7;
     ;
     NULL, NULL, PartesMaqu;
|FIN;

|PROCESO PartesTrab;
     nTraba = #goptrbli#4;
     |BUCLE FechaFin;
     |SI nBueno ! 0; |ACABA; |FINSI;

     nTipoHora = #goptrbli#26;
     |HAZ LeeValor;

     fFecha = #goptrbli#2;
     nHoras = #goptrbli#11;

     aSerPre = #goptrbli#20;
     nNumPre = #goptrbli#21;
     nLinParte = #goptrbli#3;
     |HAZ Totales;
     nLinParte = 0;
|FPRC;

|DEFBUCLE PartesTrab;
     #goptrbli#2;
     ;
     "     ", 000000, #0#0, 0001, #goinfnom#6;
     "zzzzz", 999999, #0#1, 9999, #goinfnom#7;
     ;
     NULL, PartesTrab;
|FIN;

|PROCESO BorraObs;
     |BORRA 020#8a;
|FPRC;

|DEFBUCLE BorraObs;
     #8#1;
     ;
     #10#0, #10#1, 001;
     #10#0, #10#1, 999;
     be;
     NULL, BorraObs;
|FIN;

|PROCESO BorraHoras;
     nTraba = #gohornom#0;
     |BUCLE FechaFin;
     |SI nBueno ! 0; |ACABA; |FINSI;

     |BUCLELIN 1NULL#gohornom;
     |BORRA 020#gohornom.a;
     |BUCLE BorraObs;
|FPRC;

|DEFBUCLE BorraHoras;
   #gohornom#1;
   ;
   #goinfnom#6,#goinfnom#0;
   #goinfnom#7,#goinfnom#1;
   be;
   NULL,BorraHoras;
|FIN;

|PROCESO Recalculo;
     |ABRE #gohornom;
     |ABRE #gohorno1;
     |ABRE #gohorno2;
     |ATRI I; |PINTA 2310, " Borrando fichas de horas nominas     "; |ATRI N;
     |BUCLE BorraHoras;

     |ATRI I; |PINTA 2310, " Recalculando fichas de horas nominas "; |ATRI N;
     |BUCLE PartesTrab;
     |BUCLE PartesMaqu;

     |CIERRA #gohorno1;
     |CIERRA #gohorno2;

     |BUCLE gohorno1;
     |HAZ Graba10;

     |CIERRA #gohornom;

     ||--------Borra fechas sin contrato
     fDesde = "01.01.0000";
     |BUCLE SinContrato;
     fHasta = "31.12.9999";
     |BUCLE BorraSin10;

     |ATRI I; |PINTA 2310, "                                      "; |ATRI N;
|FPRC;

|PROCESO Impresion;
     |PRINT;
|FPRC;

|PROCESO Observacion;
     |SI nHayObs = 1;
          |PDEFECTO #10, 2, 63;
     |FINSI;
     enSwObs = 1;
     |PRINT;
     enSwObs = 0;

     nHayObs = 1;
|FPRC;

|DEFBUCLE Observacion;
     #8#1;
     ;
     #10#0, #10#1, 001;
     #10#0, #10#1,999;
     ;
     NULL, Observacion;
|FIN;

|PROCESO Impresion1;
     nHayObs = 0;
     |SI #0#109 = "S";
          |BUCLE Observacion;
     |FINSI;
     |SI nHayObs = 0;
          |DDEFECTO #8;
          |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE Impresion1;
     #gohornom#1;
     ;
     #0#6, #0#0;
     #0#7, #0#1;
     be;
     NULL,Impresion1;
|FIN;

|DEFBUCLE Impresion;
     #gotmp001#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL,Impresion;
|FIN;

|PROCESO Impresion22;
     enDetalle = nPrime;
     nPrime = nPrime + 1;
     |SI nPrime > 1;
          |PDEFECTO #gotmp001, 3, 42;
     |FINSI;
     |PRINT;
|FPRC;

|DEFBUCLE Impresion22;
     #gohornom#1;
     ;
     #gotmp001#0, #0#0;
     #gotmp001#0, #0#1;
     ;
     NULL, Impresion22;
|FIN;

|PROCESO Impresion2
     nPrime  = 0;
     |BUCLE Impresion22;
|FPRC;

|DEFBUCLE Impresion2;
     #gotmp001#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL,Impresion2;
|FIN;

|PROCESO RellenaTempo;
     nTraba = #gohornom#0;
     |BUCLE FechaFin;
     |SI nBueno ! 0; |ACABA; |FINSI;

     #gotmp001#0 = #gohornom#0;
     |LEE 000#gotmp001.=;
     |SI FSalida ! 0;
          |DDEFECTO #gotmp001;
          #gotmp001#0 = #gohornom#0;
          #gotmp001#2 = #gohornom#2;
          |GRABA 020#gotmp001.b;
     |FINSI;

     |PARA i = 3; |SI i [ 42; |HACIENDO i = i + 1;
          #gotmp001#i# = #gotmp001#i# + #gohornom#i#;
     |SIGUE;

     |GRABA 020#gotmp001.a;
     |LIBERA #gotmp001;
|FPRC;

|DEFBUCLE RellenaTempo;
     #gohornom#1;
     ;
     #0#6, #0#0;
     #0#7, #0#1;
     ;
     NULL,RellenaTempo;
|FIN;

|PROCESO LeeTipos;
     |ABRE #30;
     |PARA; i = 9; |SI i [ 18; |HACIENDO i = i + 1;
          nCampo = i + 10;
          |DDEFECTO #30;
          #30#0 = #0i;
          |LEE 000#30=;
          aAlfa = #30#1; |QBF aAlfa;
          |SI aAlfa = ""; aAlfa = "."; |FINSI;
          #0nCampo = aAlfa;
     |SIGUE;
     |CIERRA #30;
|FPRC;

|PROCESO RellenaTraba
     |SI #1#3 > #0#8;
          |DDEFECTO #20;
          #20#0 = #1#0;
          |LEE 000#20=;
          |SI FSalida ! 0;
               |DDEFECTO #11;
               #11#0 = #20#0;
               |LEE 000#11=;
               #20#2 = #11#1;
               |GRABA 020#20n;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE RellenaTraba;
     #1#1;
     ;
     #0#6, 0001;
     #0#7, 9999;
     ;
     NULL, RellenaTraba;
|FIN;

|PROGRAMA;
     |HAZ MiraLogos; || Copia Logos para el Crystal

     |ABRE #goinfnom;
     |LEE 000#goinfnom.p;
     |SI FSalida ! 0;
          |GRABA 020#goinfnom.n;
     |FINSI;

     aAlfa = Usuario;
     |NOME_DAT #20 aAlfa;
     |DELINDEX #gotmp001;
     |ABRE #gotmp001;

     |CLS;
     |CABEZA " Impresion informe nominas ";
     |PINPA #0#0; |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |GRABA 020#goinfnom.a;
          |HAZ LeeTipos;
          |SI #goinfnom#2 = "S"; |HAZ Recalculo; |FINSI;
          |SI #goinfnom#4 = "A";
               Impresora = "Crystal Reports";
          |FINSI;
          |IMPRE 0;
          |SI FSalida = 0;
               |SI #goinfnom#4 ! "D"; |BUCLE RellenaTempo; |FINSI;
               |ABRE #20;
               |ABRE #11;
               |SI #goinfnom#4 = "E"; |BUCLE RellenaTraba; |FINSI;
               |SI #goinfnom#4 = "A"; |BUCLE RellenaTraba; |FINSI;
               |CIERRA #20;
               |CIERRA #11;
               |SI #goinfnom#4 = "R"; |INFOR "goinfno1"; |FINSI;
               |SI #goinfnom#4 = "D";
                    |SI #0#109 = "N";
                         |INFOR "goinfno2";
                    |SINO;
                         |INFOR "goinfno7";
                    |FINSI;
               |FINSI;
               |SI #goinfnom#4 = "N"; |INFOR "goinfno3"; |FINSI;
               |SI #goinfnom#4 = "E"; |INFOR "goinfno4"; |FINSI;
               |SI #goinfnom#4 = " "; |INFOR "goinfno5"; |FINSI;
               |SI #goinfnom#4 = "A"; |INFOR "goinfno6"; |FINSI;
               |SI FSalida = 0;
                    |SI #goinfnom#4 = "D"; |BUCLE Impresion1; |FINSI;
                    |SI #goinfnom#4 = "R"; |BUCLE Impresion; |FINSI;
                    |SI #goinfnom#4 = "N"; |BUCLE Impresion; |FINSI;
                    |SI #goinfnom#4 = "E"; |BUCLE Impresion; |FINSI;
                    |SI #goinfnom#4 = "A"; |BUCLE Impresion2; |FINSI;
                    |PIEINF;
                    |FININF;
               |FINSI;
               |FINIMP;
          |FINSI;
     |FINSI;
     |CIERRA #gotmp001;
     |CIERRA #goinfnom;
|FPRO;
