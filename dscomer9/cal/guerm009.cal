|FICHEROS;
   guerm009 #0;

   guerm012 #1;
   guerm013 #2;

   agifa010 #10;
   agifa134 #11;
   goparame #15;

   Referen@ #20;
|FIN;

|VARIABLES;
   Flag = 0;
   nOpcion = 0;
   nTecla  = 0;

   aAlfa = "";
   nCont = 0;
   nNumCmp = 0;

{-1}Menu   = "";
    Menu1  = "1630";
    Menu2  = "1";
    Menu3  = "2";
    Menu4  = " Albaranes pdtes.facturar ";
    Menu5  = " Facturas                 ";

|FIN;

|PROCESO Tipo20009; |TIPO 20;
   |SI FSalida = "OPCION";
      FSalida = "Opciones";
   |SINO;
      |PUSHV 0501 2380;
      |HAZ HazMenu;
      |POPV;
   |FINSI;
|FPRC;

|PROCESO Albaranes;
   #agifa010#52 = #guerm012#0;
   #agifa010#0  = #guerm012#1;
   |LEE 000#agifa010.=;
   |SI FSalida = 0;
      |SI #agifa010#3 = #guerm009#0; |Y #agifa010#38 = "N";
         |DDEFECTO #Referen@;
         aAlfa = "|NC"; nNumCmp = #Referen@#aAlfa#; nNumCmp = nNumCmp - 1;
         |PARA nCont = 0; |SI nCont [ nNumCmp; |HACIENDO nCont = nCont + 1;
            #Referen@#nCont# = #agifa010#nCont#;
         |SIGUE;
         |GRABA 020#Referen@.n;
      |FINSI;
   |SINO;
      |BORRA 020#guerm012.a;
   |FINSI;
|FPRC;

|DEFBUCLE Albaranes;
#guerm012#1;
2;
"     ",000000,#guerm009#2;
"zzzzz",999999,#guerm009#2;
;
NULL,Albaranes;
|FIN;

|PROCESO Facturas;
   #agifa134#49 = #guerm013#0;
   #agifa134#0  = #guerm013#1;
   |LEE 000#agifa134.=;
   |SI FSalida = 0;
      |SI #agifa134#2 = #guerm009#0;
         |DDEFECTO #Referen@;
         aAlfa = "|NC"; nNumCmp = #Referen@#aAlfa#; nNumCmp = nNumCmp - 1;
         |PARA nCont = 0; |SI nCont [ nNumCmp; |HACIENDO nCont = nCont + 1;
            #Referen@#nCont# = #agifa134#nCont#;
         |SIGUE;
         |GRABA 020#Referen@.n;
      |FINSI;
   |SINO;
      |BORRA 020#guerm013.a;
   |FINSI;
|FPRC;

|DEFBUCLE Facturas;
#guerm013#1;
2;
"     ",000000,#guerm009#2;
"zzzzz",999999,#guerm009#2;
;
NULL,Facturas;
|FIN;

|PROCESO HazMenu;
   |PARA; |SI; |HACIENDO;
      |MENUG Menu; nOpcion = FSalida;
      |SI nOpcion < 1; |O nOpcion > 2; |SAL; |FINSI;
      |SI nOpcion = 1;
         |DBASE aAlfa; |QBF aAlfa; aAlfa = aAlfa + "def/agifa010.mas";
         |CARGA_DEF aAlfa, Referen@;
         |SI FSalida ! 0;
            |MENAV "    Problemas al acceder a los datos de albaranes";
            |SAL;
         |FINSI;
         aAlfa = "tm" + Usuario; |NOME_DAT #20 aAlfa;
         |DELINDEX #Referen@; |ABRE #Referen@;
         |ABRE #agifa010;
         |BUCLE Albaranes;
         |CONSULTA_CLAVE #1#Referen@;
         |CIERRA #agifa010;
         |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
      |FINSI;
      |SI nOpcion = 2;
         |DBASE aAlfa; |QBF aAlfa; aAlfa = aAlfa + "def/agifa134.mas";
         |CARGA_DEF aAlfa, Referen@;
         |SI FSalida ! 0;
            |MENAV "    Problemas al acceder a los datos de facturas";
            |SAL;
         |FINSI;
         aAlfa = "tm" + Usuario; |NOME_DAT #20 aAlfa;
         |DELINDEX #Referen@; |ABRE #Referen@;
         |ABRE #agifa134;
         |BUCLE Facturas;
         |CONSULTA_CLAVE #1#Referen@;
         |CIERRA #agifa134;
         |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
      |FINSI;
   |SIGUE;
|FPRC;
