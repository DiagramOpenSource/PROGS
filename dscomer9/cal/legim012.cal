|FICHEROS;
     legim012 #0;
     legim013 #1;

     legim009 #9;
     legim010 #10;
     legim018 #18;

     legim005 #5;
     legiz010 #100,MANTE;
|FIN;

|VARIABLES;
     aNom = "";
     nConta = 0;
     nError = 0;
     aParametro = "";
     &eaCliente = "";
     &enNumSolicitud = 0;

     nModo = 0;
     aCliente = "";
     nContador = 0;
     aInforme = "";
     nSwPie = 0;
     aMensaje = "";

     nDias = 0;
     fFecha = @;
     nFecha = 0;
     aFecha = "";

 {-1}menu           = "";
     menu1          = "2400";
     menu2          = "1";
     menu3          = "Contador:  ";
     menu4          = "AM";
     menu5          = " Automatico ";
     menu6          = " Manual ";

 {-1}aMenu = "";
     aMenu1 = "2400";
     aMenu2 = "1";
     aMenu3 = "Opciones: ";
     aMenu4 = "IC";
     aMenu5 = "  Imprimir ";
     aMenu6 = "  Copiar  ";
|FIN;

|PROCESO legim010;
     |DDEFECTO #18;
     #legim018#0 = #legim010#6;
     |LEE 000#legim018.=;

     |DDEFECTO #legim013;
     #legim013#0 = #legim012#0;
     #legim013#1 = #legim012#1;
     #legim013#2 = #legim010#1;
     |LEE 101#legim013.=;
     |SI FSalida ! 0; |GRABA 020#legim013.b; |FINSI;
     #legim013#3 = #legim010#2;
     #legim013#4 = #legim010#3;
     #legim013#5 = #legim010#4;
     #legim013#6 = #legim010#5;
     #legim013#10 = #legim018#0;
     #legim013#11 = #legim018#1;
     |GRABA 020#legim013.a;
     |LIBERA #legim013;
|FPRC;

|DEFBUCLE legim010;
 #legim010#1;
 ;
 #legim012#3, 0001;
 #legim012#3, 9999;
 ;
 NULL, legim010;
|FIN;

|PROCESO Tipo5legim013; |TIPO 5;
     nModo = (FEntrada/100) ! 0;
     |SI nModo = 1;
/*
          aMensaje = "0000Mete Lineas. ALTAS";
          |MENAV aMensaje;
*/
          |ABRE #legim018;
          |BUCLE legim010;
          |CIERRA #legim018;
     |FINSI;
|FPRC;

|PROCESO Tipo0C8m013; |TIPO 0;
     |SI #legim013#8 < #legim013#5; |O #legim013#8 > #legim013#3;
          #legim013#9 = "*";
     |SINO;
          #legim013#9 = " ";
     |FINSI;
     |PINTA #legim013#9;
|FPRC;

|PROCESO Tipo7C1_legim012; |TIPO 7;
     nModo = (FEntrada/100) ! 0;
     |SI nModo = 1;
          |MENU menu;
          |SI FSalida = 1;    ||Automatico
               aCliente = #legim012#0;
               aNom = #legim012#6;
               |DDEFECTO #legim012;
               #legim012#0 = aCliente;
               #legim012#1 = 9999;
               |LEE 000#legim012.];
               |SI FSalida = 0;
                    |LEE 000#legim012.a;
               |SINO;
                    |LEE 000#legim012.u;
               |FINSI;
               |SI FSalida = 0; |Y #legim012#0 = aCliente;
                    nContador = #legim012#1 + 1;
               |SINO;
                    nContador = 1;
               |FINSI;
               |DDEFECTO #legim012;
               #legim012#0 = aCliente;
               #legim012#1 = nContador;
               #legim012#6 = aNom;
               |PINTA #legim012#1;
          |FINSI;
     |FINSI;
|FPRC;


|PROCESO Tipo0C3m012; |TIPO 0;
     aFecha = #legim012#4;
     |SI aFecha = "01.01.0000";
          |ABRE #legim009;
          |DDEFECTO #legim009;
          #legim009#0 = #legim012#3;
          |LEE 000#legim009.=;
          nDias = #legim009#2;

          fFecha = #legim012#2;
          nFecha = fFecha;
          nFecha = nFecha + nDias;
          fFecha = nFecha;
          #legim012#4 = fFecha;
          |PINTA #legim012#4;

          |CIERRA #legim009;
     |FINSI;
|FPRC;

|PROCESO legim013;
     |PRINT;
     nSwPie = 1;
|FPRC;

|DEFBUCLE legim013;
 #legim013#1;
 ;
 #legim012#0, #legim012#1, 0001;
 #legim012#0, #legim012#1, 9999;
 ;
 NULL, legim013;
|FIN;

|PROCESO Imprimir;
     |LEE 000#0=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |IMPRE 0;
     |SI FSalida = 0;
          |ABRE #legim005;
          |DDEFECTO #legim005;
          #legim005#0 = #legim012#0;
          |LEE 000#legim005.=;
          aInforme = #legim005#5;
          |QBF aInforme;
          |CIERRA #legim005

          |INFOR aInforme;
          |SI FSalida = 0;
               |ABRE #legim009;
               #legim009#0 = #legim012#3;
               |LEE 000#legim009.=;

               |BUCLE legim013;
               |SI nSwPie = 1;
                    |PIEINF;
               |FINSI;
               |FININF;
               |CIERRA #legim009;
          |SINO;
               aMensaje = "0000Informe " + aInforme + " inaccesible.";
               |MENAV aMensaje;
          |FINSI;
          |FINIMP;
     |SINO;
          |MENAV "0000Proceso cancelado.";
     |FINSI;
|FPRC;

|PROGRAMA;
     aParametro = PARAMETRO;
     |QBF aParametro;

     |SI aParametro = "";
          |MANTE #legim012;
     |SINO;
          |SI aParametro = "MODI";
               |CLS;
               |ABRE #legim012;

               |DDEFECTO #legim012;
               #legim012#0 = eaCliente;
               #legim012#1 = enNumSolicitud;
               |LEE 000#legim012.=;

               |PINPA #0#legim012;
               |PINDA #0#legim012;
               |ENDATOS #2#legim012;
               |SI FSalida = 0;
                    |GRABA 020#legim012.a;
                    |LIBERA #legim012;
               |FINSI;

               |CIERRA #legim012;
          |SINO;
               |MANTE #legim012;
          |FINSI;
     |FINSI;
|FPRO;

|PROCESO T20m12; |TIPO 20;
     |SI FSalida = "OPCION";
          FSalida = "Opciones";
     |SINO;
          |MENU aMenu;
          |SI FSalida = 1; |HAZ Imprimir;  |FINSI;
          |SI FSalida = 2; |HAZ Copia; |FINSI;
     |FINSI;
|FPRC;

|PROCESO BorraLin;
     |BORRA 020#1a;
|FPRC;

|DEFBUCLE BorraLin;
     #1#1;
     ;
     #100#1, #100#5, 001;
     #100#1, #100#5, 999;
     be;
     NULL, BorraLin;
|FIN;

|PROCESO CopiaLin;
     #1#0 = #100#1;
     #1#1 = #100#5;
     |GRABA 020#1n;
|FPRC;

|PROCESO Min0;
     #0#0 = #100#0;
     #0#1 = 0000;
|FPRC;

|PROCESO Max0;
     #0#0 = #100#0;
     #0#1 = 9999;
|FPRC;

|PROCESO T66; |TIPO 66;
     #0#0 = #100#0;
     #0#1 = #100#4;
     |LEE 000#0];
     |CONSULTA_F_CLAVE #1#0, Min0, Max0;
     |SI FSalida = 0;
          #100#4 = #0#1;
     |SINO;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Defecto; |TIPO 7;
     #0#0 = #100#1;
     #0#1 = 9999;
     |LEE 000#0];
     |SI FSalida = 0;
          |LEE 000#0a;
     |SINO;
          |LEE 000#0u;
     |FINSI;
     |SI FSalida = 0; |Y #0#0 = #100#1;
          nConta = #0#1 + 1;
     |SINO;
          nConta = 1;
     |FINSI;
     #100#5 = nConta;
|FPRC;

|PROCESO Chequea; |TIPO 0;
     #0#0 = #100#1;
     #0#1 = #100#5;
     |LEE 000#0=;
     |SI FSalida = 0;
          |MENAV "0000Analisis existente...";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Copia;
     nError = 1;
     |ABRE #0;
     |SALVA_FICHA #0;
     |PUSHV 0501 2380;
     |BLANCO 1604 2377;
     |DDEFECTO #100;
     #100#0 = #0#0;
     #100#4 = #0#1;
     #100#2 = #0#6;
     |PINPA #0#100;
     |PINDA #0#100;
     |ENDATOS #1#100;
     |SI FSalida = 0;
          #0#0 = #100#0;
          #0#1 = #100#4;
          |LEE 020#0=;
          |SI FSalida = 0;
               #0#0 = #100#1;
               #0#1 = #100#5;
               #0#6 = #100#3;
               |GRABA 020#0n;
               |SI FSalida = 0;
                    |BUCLE BorraLin;
                    |BUCLELIN 2 CopiaLin #0;
                    nError = 0;
               |FINSI;
          |FINSI;
     |FINSI;
     |POPV;
     |REPON_FICHA #0;
     |SI nError = 0;
          #0#0 = #100#1;
          #0#1 = #100#5;
          |LEE 020#0=;
          |PINDA #0#0;
     |FINSI;
     |CIERRA #0;
|FPRC;
