|FICHEROS;
     fergam12 #12,MANTE;
     fergam13 #13,MANTE;
     fergam16 #16,MANTE;
     agifa019 #19;
     agifa060 #60;
     agifa048 #480;
     agifa049 #490;
|FIN;

|VARIABLES;
     &eaArticulo = "";
     &eaFergaFam = "";
     &eaFergaSub = "";
     &eaDes = "";
     &enUnidades = 0;
     &eaEscan = "";
     &Tempo = "";
     aTmp12 = "";
     aTmp13 = "";
     nUni1 = 0;
     nUni2 = 0;
     nUni3 = 0;
     nUni4 = 0;
     nUni5 = 0;
     nUni6 = 0;
     nUni7 = 0;
     nUni8 = 0;
     nUni9 = 0;
     nSw = 0;
     nLin = 0;
|FIN;

|PROCESO LineasEscan2;
     |BORRA 020#490a;
|FPRC;

|DEFBUCLE LineasEscan2;
     #490#1;
     ;
     #480#0, 001;
     #480#0, 999;
     be;
     NULL, LineasEscan2;
|FIN;

|PROCESO LineasEscan;
     |SI nSw = 0;
          |SI #490#2 = 6; nUni1 = #490#12; |FINSI;
          |SI #490#2 = 8; nUni2 = #490#12; |FINSI;
          |SI #490#2 = 10; nUni3 = #490#12; |FINSI;
          |SI #490#2 = 12; nUni4 = #490#12; |FINSI;
          |SI #490#2 = 16; nUni5 = #490#12; |FINSI;
          |SI #490#2 = 20; nUni6 = #490#12; |FINSI;
          |SI #490#2 = 25; nUni7 = #490#12; |FINSI;
          |SI #490#2 = 32; nUni8 = #490#12; |FINSI;
          |SI #490#2 = 40; nUni9 = #490#12; |FINSI;
     |FINSI;
     |SI nSw = 1;
          |SI #490#2 ! 6;
                    |Y #490#2 ! 8;
                    |Y #490#2 ! 10;
                    |Y #490#2 ! 12;
                    |Y #490#2 ! 16;
                    |Y #490#2 ! 20;
                    |Y #490#2 ! 25;
                    |Y #490#2 ! 32;
                    |Y #490#2 ! 40;
               nLin = nLin + 1;
               #13#0 = #12#0;
               #13#1 = nLin;
               #13#2 = #490#2;
               #13#3 = #490#12;
               #13#4 = #490#3;
               |GRABA 020#13n;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE LineasEscan;
     #490#1;
     ;
     #480#0, 001;
     #480#0, 999;
     ;
     NULL, LineasEscan;
|FIN;

|PROCESO Lineas;
     |SI #13#3 ! 0;
          #490#0 = #13#0;
          #490#1 = #13#1;
          #490#2 = #13#2;
          #490#4 = #13#3;     ||Uni
          #490#12 = #13#3;     ||Uni
          #490#3 = #13#4;
          #490#9 = #13#5;
          |GRABA 020#490n;
          enUnidades = enUnidades + #13#3;
     |FINSI;
|FPRC;

|DEFBUCLE Lineas;
     #13#1;
     ;
     #12#0, 001;
     #12#0, 999;
     ;
     NULL, Lineas;
|FIN;

|PROCESO Defectos;
     #13#0 = #12#0; #13#1 = 1; #13#2 = 6; #13#3 = nUni1; #13#4 = "CALIBRE 6"; |GRABA 020#13n;
     #13#0 = #12#0; #13#1 = 2; #13#2 = 8; #13#3 = nUni2; #13#4 = "CALIBRE 8"; |GRABA 020#13n;
     #13#0 = #12#0; #13#1 = 3; #13#2 = 10; #13#3 = nUni3; #13#4 = "CALIBRE 10"; |GRABA 020#13n;
     #13#0 = #12#0; #13#1 = 4; #13#2 = 12; #13#3 = nUni4; #13#4 = "CALIBRE 12"; |GRABA 020#13n;
     #13#0 = #12#0; #13#1 = 5; #13#2 = 16; #13#3 = nUni5; #13#4 = "CALIBRE 16"; |GRABA 020#13n;
     #13#0 = #12#0; #13#1 = 6; #13#2 = 20; #13#3 = nUni6; #13#4 = "CALIBRE 20"; |GRABA 020#13n;
     #13#0 = #12#0; #13#1 = 7; #13#2 = 25; #13#3 = nUni7; #13#4 = "CALIBRE 25"; |GRABA 020#13n;
     #13#0 = #12#0; #13#1 = 8; #13#2 = 32; #13#3 = nUni8; #13#4 = "CALIBRE 32"; |GRABA 020#13n;
     #13#0 = #12#0; #13#1 = 9; #13#2 = 40; #13#3 = nUni9; #13#4 = "CALIBRE 40"; |GRABA 020#13n;
     nLin = #13#1;
|FPRC;

|PROCESO Min;
     #13#0 = #12#0;
     #13#1 = 1;
|FPRC;

|PROCESO Max;
     #13#0 = #12#0;
     #13#1 = 999;
|FPRC;

|PROGRAMA;
     |SI PARAMETRO = "ALTA_ARTI";
          |ABRE #16;
          #16#0 = eaArticulo;
          |LEE 000#16=;
          |SI FSalida ! 0;
               #16#2 = eaFergaFam;
               #16#3 = eaFergaSub;
               |GRABA 020#16b;
               |PINPA #0#16;
               |PINDA #0#16;
               |ENDATOS #1#16;
               |SI FSalida = 0;
                    eaFergaFam = #16#2;
                    eaFergaSub = #16#3;
                    |GRABA 020#16a;
               |SINO;
                    |BORRA 020#16c;
                    eaArticulo = "";
               |FINSI;
          |FINSI;
          |CIERRA #16;
     |SINO;
          |HAZ CreaTempo; aTmp12 = Tempo; |NOME_DAT #12 aTmp12; |DELINDEX #12;
          |HAZ CreaTempo; aTmp13 = Tempo; |NOME_DAT #13 aTmp13; |DELINDEX #13;

          |ABRE #480;
          #480#0 = PARAMETRO;
          |LEE 101#480=;
          |SI FSalida ! 0;
               #12#0 = PARAMETRO;

               |ABRE #19;
               #19#0 = #12#0;
               |LEE 000#19=;
               |SI FSalida = 0;
                    #12#1 = #19#1;
               |FINSI;
               |CIERRA #19;

               |ABRE #12;
               |ABRE #13;
               |HAZ Defectos;
               |ABRE #490;
               |PINPA #0#12;
               |PINDA #0#12;
               |ENDATOS #2#12;
               |SI FSalida = 0;
                    #480#0 = #12#0;
                    #480#1 = #12#1;
                    #480#12 = #12#2;
                    #480#10 = #12#3;
                    #480#33 = "N";
                    |GRABA 020#480n;
                    enUnidades = 0;
                    |BUCLE Lineas;
/*
Tiquet: 5033/87
                    eaEscan = #480#0;
                    |SUB_EJECUTA_NP "agifa044;mecanogra";
*/
                    |ABRE #19;
                    #19#0 = #13#0;
                    |LEE 000#19=;
                    |CIERRA #19;
                    |ABRE #60;
                    #60#0 = #19#2;
                    |LEE 000#60=;
                    |CIERRA #60;
                    eaDes = #19#1; |QBF eaDes;
                    eaDes = eaDes + " " + #60#1;
               |FINSI;
               |CIERRA #490;
          |SINO;
               |ABRE #12;
               #12#0 = #480#0;
               #12#1 = #480#1;
               #12#2 = #480#12;
               #12#3 = #480#10;
               |GRABA 020#12n;
               |ABRE #13;
               nSw = 0; |BUCLE LineasEscan;
               |HAZ Defectos;
               nSw = 1; |BUCLE LineasEscan;
               |ABRE #490;
               |PINPA #0#12;
               |PINDA #0#12;
               |ENTLINEAL #1#13, 2, 2, 22, 0, Min, Max;
               nSw = 2; |BUCLE LineasEscan2;

               enUnidades = 0;
               |BUCLE Lineas;
               #480#12 = #12#2;
               |GRABA 020#480a;

               |LIBERA #480;
/*
Tiquet: 5033/87
               eaEscan = #480#0;
               |SUB_EJECUTA_NP "agifa044;mecanogra";
*/
               |ABRE #19;
               #19#0 = #13#0;
               |LEE 000#19=;
               |CIERRA #19;
               |ABRE #60;
               #60#0 = #19#2;
               |LEE 000#60=;
               |CIERRA #60;
               eaDes = #19#1; |QBF eaDes;
               eaDes = eaDes + " " + #60#1;

               |CIERRA #490;
          |FINSI;
          |CIERRA #480;

          |CIERRA #13;
          |CIERRA #12;
          |DELINDEX #12; Tempo = aTmp12; |HAZ BoraTempo;
          |DELINDEX #13; Tempo = aTmp13; |HAZ BoraTempo;
     |FINSI;
|FPRO;
