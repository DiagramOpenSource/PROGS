|FICHEROS;
 ortig006 #0;
 ortig001 #1;
 ortig002 #2;
 ortig005 #5;
 agifa019 #19;
 agifa017 #17;
 agifa065 #65;
|FIN;

|VARIABLES;
 medida = 0;
 largo = 0;
 ancho = 0;
 &nLargo = 0;
 &nAncho = 0;
 &aDescri_or = "";
 &nCantid_or = 0;
 &nAlmace_or = 0;
 &nPrecio_or = 0;
 &aPresup_or = "";
 unidades = 0;
 unidad1 = 0;
 linea = 0;
 numero = 0;
 &aModelo_ort = "";
 &nCantidad_ort = 0;
 ValorSt = 0;
 fecha = @00.00.0000;
 fecha1 = "";
 mes = 0;
|FIN;

|PROCESO Medidas_dbl; |TIPO 0;
     |SI #19#188 ] 1; medida = #19#189;         |FINSI;
     |SI #19#188 ] 2; medida = #19#189 * #19#190; |FINSI;
     |SI #19#188 = 3; medida = #19#189 * #19#190 * #19#191; |FINSI;
|FPRC;

|CALCULO mayus1;
 #0Campo = #0Campo > " ";
|FCAL;

|PROCESO EntraModelo;
|ABRE #19;
#19#0 = #0#0;
|LEE 010#19=;
|SI FSalida = 0;
 ValorSt = #19#10;
 ValorSt = ValorSt + (#0#2*#0#5); ||INCREMENTO VALOR EN UNID*COSTE
 #19#6 = #19#6 + #0#2;
 #19#104 = #19#104 + #0#2;
 #19#10 = #19#6 * #19#9; ||VALOR STOCK
 #19#11 = #19#11 - #0#2; ||NECESIDADES
 #19#9 = ValorSt / #19#6; ||PRECIO MEDIO
 |HAZ Medidas_dbl;
 #19#185 = #19#6*medida;
 #19#193 = #19#104*medida;
 ||#19#104 = #19#193 * medida;
 ||#19#6 = #19#185  * medida;
 |GRABA 010#19a;
|FINSI;
|LIBERA #19;
|CIERRA #19;
|ABRE #17;
#17#0 = #0#0
#17#1 = #0#4;
|LEE 010#17=;
|SI FSalida ! 0;
  |CDEFECTO #17,1;
  |GRABA 010#17b;
  |LIBERA #17;
|FINSI;
#17#5 = #17#5 + #0#2;
#17#39 = #17#39 + #0#2;
#17#3 = #17#5 * #19#9; ||VALOR STOCK;
fecha = #0#6;
fecha1 = fecha;
fecha1 = fecha % 402;
mes = fecha1;
mes = (mes*2)+10;
#17mes = #17mes + #0#2;
#17#36 = #17#36 + #0#2;
|HAZ Medidas_dbl;
#17#47 = #17#5 * medida;
|| #17#45 = #17#47 * medida;
#17#48 = #17#39 * medida;
|| #17#39 = #17#48 * medida;
|GRABA 010#17a;
|LIBERA #17;
|CIERRA #17;
|ABRE #65;
#65#0 = #0#0;
#65#1 = #0#6;
#65#2 = "FB";
#65#3 = #0#7;||DOCUMENTO
#65#4 = 1;
#65#5 = #0#4;
#65#6 = #0#2;
#65#9 = #0#5;
|HAZ Medidas_dbl;
#65#17 = #65#6*medida;
|| #65#6 = #65#17 * medida;
|GRABA 010#65n;
|LIBERA #65;
|CIERRA #65;
|FPRC;

|PROCESO calc_unidades;
 #2#10 = 0;
 |SI #2#9 = "2";
   #2#10 = largo + ancho;
 |FINSI;
 |SI #2#9 = "L";
   #2#10 = largo;
 |FINSI;
 |SI #2#9 = "A";
   #2#10 = ancho;
 |FINSI;
 |SI #2#9 = "N";
   #2#10 = 1;
 |FINSI;
 #2#10 = #2#10 * #2#2 * #2#3;
|FPRC;

|PROCESO linmaterial;
|ABRE #5;
#5#0 = #2#11;
|LEE 010#5=;
|SI FSalida ! 0;|DDEFECTO #5;|FINSI;
|LIBERA #5;
|CIERRA #5;
linea = linea + 1;
|ABRE #19;
#19#0 = #2#11;
|LEE 010#19=;
|SI aModelo_ort ! "";
 largo = nLargo;
 ancho = nAncho;
 |HAZ calc_unidades;
|FINSI;
|SI FSalida = 0;
 unidades = #0#2 * #2#10 / #5#1; ||(cant.fabri.*uds.por modelo / factor)
 |SI #5#3 = "S";
    unidad1 = unidades ! 0;
    |SI unidad1 < unidades;   || si se desprecian decimales, se sacan uds. completas
      unidades = unidad1 + 1;
    |SINO;
      unidades = unidad1;
    |FINSI;
 |FINSI;
 #19#6 = #19#6 - unidades;
 #19#104 = #19#104 - unidades;
 #19#10 = #19#6 * #19#9; ||VALOR STOCK
 #19#11 = #19#11 + unidades; ||NECESIDADES
 |HAZ Medidas_dbl;
 #19#185 = #19#6;
 #19#193 = #19#104;
  #19#185 = #19#6*medida;
  #19#193 = #19#104*medida;
  ||#19#104 = #19#193 * medida;
  ||#19#6 = #19#185  * medida;
 |GRABA 010#19a;
|FINSI;
|LIBERA #19;
|CIERRA #19;
|ABRE #17;
#17#0 = #2#11;
#17#1 = #0#4;
|LEE 010#17=;
|SI FSalida ! 0;
  |CDEFECTO #17,1;
  |GRABA 010#17b;
  |LIBERA #17;
|FINSI;
#17#5 = #17#5 - unidades;
#17#39 = #17#39 - unidades;
#17#3 = #17#5 * #19#9; ||VALOR STOCK;
fecha = #0#6;
fecha1 = fecha;
fecha1 = fecha % 402;
mes = fecha1;
mes = (mes*2)+9;
#17mes = #17mes + unidades;
#17#36 = #17#36 + unidades;
|HAZ Medidas_dbl;
#17#47 = #17#5*medida;
||#17#5 = #17#47 * medida;
#17#48 = #17#39*medida;
||#17#39 = #17#48 * medida;
|GRABA 010#17a;
|LIBERA #17;
|CIERRA #17;
|ABRE #65;
#65#0 = #2#11;
#65#1 = #0#6;
#65#2 = "SF";
#65#3 = #0#7;||DOCUMENTO
#65#4 = linea;
#65#5 = #0#4;
#65#6 = unidades*(-1);
|HAZ Medidas_dbl;
#65#17 = #65#6*medida;
||#65#6 = #65#17 * medida;
|GRABA 010#65n;
|LIBERA #65;
|CIERRA #65;
|FPRC;

|PROCESO SalMaterial;
|ABRE #1;
#1#0 = #0#0;
|LEE 010#1=;
|SI FSalida = 0;
 linea = 0;
 |BUCLELIN 0linmaterial#1;
|FINSI;
|LIBERA #1;
|CIERRA #1;
|FPRC;

|PROGRAMA;
|SI aModelo_ort = "";
  |ABRE #0;
  |PINPA #0#0;
  |DDEFECTO #0;
  |LEE 010#0u;
  |SI FSalida ! 0;
    numero = 1;
  |SINO;
    numero = #0#7 + 1;
  |FINSI;
  |CDEFECTO #0,1;
  |PINDA #0#0;
  |CABEZA "Proceso de Produccion";
  #0#7 = numero;
  |PINTA #0#7;
  |ENDATOS #1#0;
  |SI FSalida = 0;
    |SI #0#3 = "SI";
      |GRABA 010#0n;
      |HAZ EntraModelo;
      |HAZ SalMaterial;
    |FINSI;
  |FINSI;
|SINO;
     |ABRE #0;
     |DDEFECTO #0;
     |LEE 010#0u;
     |SI FSalida ! 0;
       numero = 1;
     |SINO;
       numero = #0#7 + 1;
     |FINSI;
     |CDEFECTO #0,1;
     #0#0 = aModelo_ort;
     #0#1 = aDescri_or;
     #0#2 = nCantid_or;
     #0#4 = nAlmace_or;
     #0#5 = nPrecio_or;
     #0#6 = ~;
     #0#7 = numero;
     #0#8 = "Presupuesto N§.: ";
     #0#8 = #0#8 + aPresup_or;
     |GRABA 010#0n;
     |LIBERA #0;
     |HAZ EntraModelo;
     |HAZ SalMaterial;
|FINSI;
|FPRO;
