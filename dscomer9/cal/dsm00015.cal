|FICHEROS;
     agifa321 #321;
     agifa324 #324;
     dsm00010 #910;
     dsm00011 #911;
     dsm00012 #912;
     dsm00013 #913;
     dsm00015 #915;
     dsm00016 #916;
     dsm00027 #927;
     dsw00101 #101; ||Tmp
     dsw00102 #102; ||Tmp
|FIN;

|VARIABLES;
     &Tempo = "";
     aDCod2 = "";
     aHCod2 = "";
     aAlfa          = "";
     aCod1          = "";
     aCod2          = "";
     aCod3          = "";
     aCod4          = "";
     aCod5          = "";

     nNume         = 0;
     nModo         = 0;
     nSwHay        = 0;
     nNivelMax     = 0;
     nNivelReal    = 0;
     nSwUsado      = 0;

     &nDeci_PreBase = 0;
     &nDeci_PreDiv  = 0;
|FIN;

|PROCESO Niveles;
     nNivelMax = 0;
     |SI #910#8  ! 0;  nNivelMax = 1;  |FINSI;
     |SI #910#12 ! 0;  nNivelMax = 2;  |FINSI;
     |SI #910#16 ! 0;  nNivelMax = 3;  |FINSI;

     nNivelReal = #910#26;
     |SI #910#26 ] nNivelMax;  nNivelReal = nNivelMax;  |FINSI;

     |ATRI S;
     |PINTA 1103, #910#20;
     |ATRI s;

     nSwUsado = 0;
     |SI nNivelReal ] 1;
         nNume = #910#4;
         aAlfa = "\" + #910#6 + "+#";
         |CAMPO_ANCHO  #915#0, 1, nNume;
         |CAMPO_MAXIMO #915#0, 1, aAlfa;
         |CAMPO_ANCHO  #912#0, 1, nNume;
         |CAMPO_MAXIMO #912#0, 1, aAlfa;
         |CAMPO_ANCHO  #913#0, 1, nNume;
         |CAMPO_MAXIMO #913#0, 1, aAlfa;
         |CAMPO_MAXIMO #916#0, 1, aAlfa;
         |ATRI S;  |PINTA 0703, #910#3;  |ATRI s;
         nSwUsado = 1;
     |FINSI;

     |SI nNivelReal ] 2;
         nNume = #910#8;
         aAlfa = "\" + #910#10 + "+#";
         |C_M          #915#1,   1, "S";
         |C_V          #915#1,   1, "S";
         |CAMPO_ANCHO  #915#1,   1, nNume;
         |CAMPO_MAXIMO #915#1,   1, aAlfa;
         |CAMPO_ANCHO  #912#1, 1, nNume;
         |CAMPO_MAXIMO #912#1, 1, aAlfa;
         |CAMPO_ANCHO  #913#1, 1, nNume;
         |CAMPO_MAXIMO #913#1, 1, aAlfa;
         |CAMPO_MAXIMO #916#1, 1, aAlfa;
         |ATRI S;  |PINTA 0803, #910#7;  |ATRI s;
         nSwUsado = 2;
     |FINSI;

     |SI nNivelReal = 3;
         nNume = #910#12;
         aAlfa = "\" + #910#14 + "+#";
         |C_M          #915#2,   1, "S";
         |C_V          #915#2,   1, "S";
         |CAMPO_ANCHO  #915#2,   1, nNume;
         |CAMPO_MAXIMO #915#2,   1, aAlfa;
         |CAMPO_ANCHO  #913#2, 1, nNume;
         |CAMPO_MAXIMO #913#2, 1, aAlfa;
         |CAMPO_MAXIMO #916#2, 1, aAlfa;
         |ATRI S;  |PINTA 0903, #910#11;  |ATRI s;
         nSwUsado = 3;
     |FINSI;

     |C_V #915#4, 1, "N";
     |C_M #915#4, 1, "N";

     |SI #910#26 > nNivelMax;
         |SI nSwUsado = 0;
             nNume = #910#4;
             aAlfa = "\" + #910#6 + "+#";
             |CAMPO_ANCHO  #915#0, 1, nNume;
             |CAMPO_MAXIMO #915#0, 1, aAlfa;
             |CAMPO_ANCHO  #927#0, 1, nNume;
             |CAMPO_MAXIMO #927#0, 1, aAlfa;
             |CAMPO_MAXIMO #916#0, 1, aAlfa;
             |ATRI S;  |PINTA 0703, #910#3;  |ATRI s;
         |FINSI;

         |SI nSwUsado = 1;
            nNume = #910#8;
            aAlfa = "\" + #910#10 + "+#";
            |C_M          #915#1, 1, "S";
            |C_V          #915#1, 1, "S";
            |CAMPO_ANCHO  #915#1, 1, nNume;
            |CAMPO_MAXIMO #915#1, 1, aAlfa;
            |CAMPO_ANCHO  #927#0, 1, nNume;
            |CAMPO_MAXIMO #927#0, 1, aAlfa;
            |CAMPO_MAXIMO #916#1, 1, aAlfa;
            |ATRI S;  |PINTA 0803, #910#7;  |ATRI s;
        |FINSI;

        |SI nSwUsado = 2;
            nNume = #910#12;
            aAlfa = "\" + #910#14 + "+#";
            |C_M          #915#2,   1, "S";
            |C_V          #915#2,   1, "S";
            |CAMPO_ANCHO  #915#2,   1, nNume;
            |CAMPO_MAXIMO #915#2,   1, aAlfa;
            |CAMPO_ANCHO  #927#0, 1, nNume;
            |CAMPO_MAXIMO #927#0, 1, aAlfa;
            |CAMPO_MAXIMO #916#2, 1, aAlfa;
            |ATRI S;  |PINTA 0903, #910#11;  |ATRI s;
        |FINSI;

        |SI nSwUsado = 3;
            nNume = #910#16;
            aAlfa = "\" + #910#18 + "+#";
            |C_M          #915#5,   1, "S";
            |C_V          #915#5,   1, "S";
            |CAMPO_ANCHO  #915#5,   1, nNume;
            |CAMPO_MAXIMO #915#5,   1, aAlfa;
            |CAMPO_ANCHO  #927#0,   1, nNume;
            |CAMPO_MAXIMO #927#0,   1, aAlfa;
            |CAMPO_MAXIMO #916#15,  1, aAlfa;
            |ATRI S;  |PINTA 1003, #910#15;  |ATRI s;
        |FINSI;
     |FINSI;

     |C_V #915#4, 1, "N";
     |C_M #915#4, 1, "N";
|FPRC;

|PROCESO Tablas;
     |ATRI R;
     |PINTA 0703, "TABLAS";
     |ATRI S;
     aAlfa = #910#20;
     |PINTA 1103, aAlfa;
     |ATRI s;
     |PINTA 1002, "쳐컴컴컴컴컴쩡컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴";
     |PINTA 1056, "컴컴컴컴컴컴컴컴컴컴컴컴";

     aAlfa = "\0+#";
     |CAMPO_MAXIMO #915#0, 1, aAlfa;
     |CAMPO_ANCHO  #915#0, 1, 3;

     |C_V #915#4, 1, "S";
     |C_M #915#4, 1, "S";
     |C_V #915#1, 1, "N";
     |C_M #915#1, 1, "N";
     |C_V #915#2, 1, "N";
     |C_M #915#2, 1, "N";
     |C_V #915#5, 1, "N";
     |C_M #915#5, 1, "N";
|FPRC;

|PROCESO Tipo13;   |TIPO 13;
     nModo = (FEntrada / 100) ! 0;

     |ABRE #910;
     |LEE 040#910p;
     |SI FSalida ! 0;  |DDEFECTO #910;  |FINSI;
     |CIERRA #910;

     |SI #910#44 = "N";  |HAZ Niveles;  |FINSI;
     |SI #910#44 = "T";  |HAZ Tablas;   |FINSI;

     |SI nModo < 1; |O nModo ] 4;
          nModo = 7;
          |HAZ Columna;
     |FINSI;
     |HAZ PinDes;
|FPRC;

|PROCESO Min912;
     #912#0 = #915#0;
     #912#1 = "                    ";
|FPRC;

|PROCESO Max912;
     #912#0 = #915#0;
     #912#1 = "zzzzzzzzzzzzzzzzzzzz";
|FPRC;

|PROCESO Min913;
     #913#0 = #915#0;
     #913#1 = #915#1;
     #913#2 = "                    ";
|FPRC;

|PROCESO Max913;
     #913#0 = #915#0;
     #913#1 = #915#1;
     #913#2 = "zzzzzzzzzzzzzzzzzzzz";
|FPRC;

|PROCESO Tipo6;  |TIPO 6;
     |SI FSalida ! 12;  |ACABA;  |FINSI;

     |SI Campo = 0;
          |ABRE #911;
          #911#0 = #915#0;
          |LEE 000#911];
          |CONSULTA_CLAVE #1#911;
          |SI FSalida = 0;
               #915#0 = #911#0; |PINTA #915#0;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #911;
     |FINSI;

     |SI Campo = 1;
         |SI nSwUsado ] 2;
             |ABRE #912;
             #912#0 = #915#0;
             #912#1 = #915#1;
             |LEE 000#912];
             |CONSULTA_F_CLAVE #1#912, Min912, Max912;
             |SI FSalida = 0;
                  #915#0 = #912#0;  |PINTA #915#0;
                  #915#1 = #912#1;  |PINTA #915#1;
             |SINO;
                  |ERROR;
             |FINSI;
             |CIERRA #912;
         |SINO;
             |SI #910#46 = "N";  |ERROR;  |ACABA;  |FINSI;
             |ABRE #927;
             #927#0 = #915#1;
             |LEE 000#927];
             |CONSULTA_CLAVE #1#927;
             |SI FSalida = 0;
                  #915#1 = #927#0;  |PINTA #915#1;
             |SINO;
                  |ERROR;
             |FINSI;
             |CIERRA #927;
         |FINSI;
     |FINSI;

     |SI Campo = 2;
         |SI nSwUsado ] 3;
             |ABRE #913;
             #913#0 = #915#0;
             #913#1 = #915#1;
             #913#2 = #915#2;
             |LEE 000#913];
             |CONSULTA_F_CLAVE #1#913, Min913, Max913;
             |SI FSalida = 0;
                   #915#0 = #913#0;  |PINTA #915#0;
                   #915#1 = #913#1;  |PINTA #915#1;
                   #915#2 = #913#2;  |PINTA #915#2;
             |SINO;
                   |ERROR;
             |FINSI;
             |CIERRA #913;
         |SINO;
             |SI #910#46 = "N";  |ERROR;  |ACABA;  |FINSI;
             |ABRE #927;
             #927#0 = #915#2;
             |LEE 000#927];
             |CONSULTA_CLAVE #1#927;
             |SI FSalida = 0;
                  #915#2 = #927#0;  |PINTA #915#2;
             |SINO;
                  |ERROR;
             |FINSI;
             |CIERRA #927;
         |FINSI;
     |FINSI;

     |SI Campo = 5;
         |SI #910#46 = "N";  |ERROR;  |ACABA;  |FINSI;
         |ABRE #927;
         #927#0 = #915#5;
         |LEE 000#927];
         |CONSULTA_CLAVE #1#927;
         |SI FSalida = 0;
              #915#5 = #927#0;  |PINTA #915#5;
         |SINO;
              |ERROR;
         |FINSI;
         |CIERRA #927;
     |FINSI;
|FPRC;

|PROCESO Relacion;  |TIPO 6;
     nModo = (FEntrada / 100) ! 0;

     |SI Campo = 0;
         |SI nSwUsado ] 2;
             aAlfa = #915Campo;  |QBT aAlfa;
             |SI aAlfa ! "";
                 |ABRE #911;
                 #911#0 = #915#0;
                 |LEE 040#911=;
                 |SI FSalida ! 0;
                     |MENAV "      Codigo Inxexistente.";
                     |ERROR;
                 |FINSI;
                 |CIERRA #911;

                 |ATRI I;  |PINTA 0737, #911#1;  |ATRI i;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI Campo = 1;
         |SI nSwUsado ] 2;
             aAlfa = #915Campo;  |QBT aAlfa;
             |SI aAlfa ! "";
                 |ABRE #912;
                 #912#0 = #915#0;
                 #912#1 = #915#1;
                 |LEE 040#912=;
                 |SI FSalida ! 0;
                     |MENAV "      Codigo Inxexistente.";
                     |ERROR;
                 |FINSI;
                 |CIERRA #912;

                 |ATRI I;  |PINTA 0837, #912#2;  |ATRI i;
             |FINSI;
         |SINO;
             |SI #910#46 = "N";  |ACABA;  |FINSI;

             aAlfa = #915Campo;  |QBT aAlfa;
             |SI aAlfa ! "";
                 |ABRE #927;
                 #927#0 = #915#1;
                 |LEE 040#927=;
                 |SI FSalida ! 0;
                     |MENAV "      Codigo Inxexistente.";
                     |ERROR;
                 |FINSI;
                 |CIERRA #927;
                 |ATRI I;  |PINTA 0837, #927#1;  |ATRI i;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI Campo = 2;
         |SI nSwUsado ] 3;
             aAlfa = #915Campo;  |QBT aAlfa;
             |SI aAlfa ! "";
                 |ABRE #913;
                 #913#0 = #915#0;
                 #913#1 = #915#1;
                 #913#2 = #915#2;
                 |LEE 040#913=;
                 |SI FSalida ! 0;
                     |MENAV "      Codigo Inxexistente.";
                     |ERROR;
                 |FINSI;
                 |CIERRA #913;
                 |ATRI I;  |PINTA 0937, #913#3;  |ATRI i;
             |FINSI;
         |SINO;
             |SI #910#46 = "N";  |ACABA;  |FINSI;

             aAlfa = #915Campo;  |QBT aAlfa;
             |SI aAlfa ! "";
                 |ABRE #927;
                 #927#0 = #915#2;
                 |LEE 040#927=;
                 |SI FSalida ! 0;
                     |MENAV "      Codigo Inxexistente.";
                     |ERROR;
                 |FINSI;
                 |CIERRA #927;
                 |ATRI I;  |PINTA 0937, #927#1;  |ATRI i;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI Campo = 5;
         |SI #910#46 = "N";  |ACABA;  |FINSI;

         aAlfa = #915Campo;  |QBT aAlfa;
         |SI aAlfa ! "";
             |ABRE #927;
             #927#0 = #915#5;
             |LEE 040#927=;
             |SI FSalida ! 0;
                 |MENAV "      Codigo Inxexistente.";
                 |ERROR;
             |FINSI;
             |CIERRA #927;
             |ATRI I;  |PINTA 1037, #927#1;  |ATRI i;
         |FINSI;
     |FINSI;
|FPRC;

|RUTINA ClaveBaja;
     #916#0  = #915#0;
     #916#1  = #915#1;
     #916#2  = #915#2;
     #916#15 = #915#5;
     #916#3  = "      ";
|FRUT;

|RUTINA ClaveAlta;
     #916#0  = #915#0;
     #916#1  = #915#1;
     #916#2  = #915#2;
     #916#15 = #915#5;
     #916#3  = "zzzzzz";
|FRUT;

|PROCESO Tipo12;   |TIPO 12;
     |SI FSalida ! 7;
          nModo = (FEntrada / 100) ! 0;
          |HAZ Columna;
     |FINSI;
|FPRC;

|PROCESO Columna;
     |ABRE #321;
     |LEE 040#321p;
     |SI FSalida ! 0;  |DDEFECTO #321;  |FINSI;
     |CIERRA #321;

     |ABRE #324;
     #324#0 = #321#9;
     |LEE 001#324=;
     |SI FSalida ! 0;  |DDEFECTO #324;  |FINSI;

     nDeci_PreBase = #324#9;

     #324#0 = #915#3;
     |LEE 001#324=;
     |SI FSalida ! 0;  |DDEFECTO #324;  |FINSI;
     |CIERRA #324;

     nDeci_PreDiv = #324#9;

     nNume         = #910#21;
     aAlfa         = "\" + #910#23 + "+#";
     |CAMPO_ANCHO  #916#3, 1, nNume;
     |CAMPO_MAXIMO #916#3, 1, aAlfa;

     |ENTCOLUMNA #1#916, 5, nModo, 5, 0, ClaveBaja, ClaveAlta;
|FPRC;

|PROCESO Borra916;
     |BORRA 020#916a;
     |LIBERA #916;
|FPRC;

|DEFBUCLE dsm00016;
     #916#1;
     ;

     #915#0, #915#1, #915#2, #915#5, "      ";
     #915#0, #915#1, #915#2, #915#5, "zzzzzz";
     be;
     NULL, Borra916;
|FIN;

|PROCESO Tipo2m15;  |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 3;  |ACABA;  |FINSI;
     |BUCLE dsm00016;
|FPRC;

|PROCESO Alta; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |ABRE #321; |LEE 000#321p; |CIERRA #321;
          #915#3 = #321#9; |PINTA #915#3;
     |FINSI;
|FPRC;


|PROCESO PinDes;
     |SI nSwUsado ] 2;
         aAlfa = #915#0;  |QBT aAlfa;
         |SI aAlfa ! "";
             |ABRE #911;
             #911#0 = #915#0;
             |LEE 000#911=;
             |SI FSalida ! 0;
                |DDEFECTO #911;
             |FINSI;
             |CIERRA #911;

             |ATRI I;  |PINTA 0737, #911#1;  |ATRI i;
         |FINSI;
     |FINSI;

     |SI nSwUsado ] 2;
         aAlfa = #915#1;  |QBT aAlfa;
         |SI aAlfa ! "";
             |ABRE #912;
             #912#0 = #915#0;
             #912#1 = #915#1;
             |LEE 000#912=;
             |SI FSalida ! 0;
                  |DDEFECTO #912;
             |FINSI;
             |CIERRA #912;

             |ATRI I;  |PINTA 0837, #912#2;  |ATRI i;
         |FINSI;
     |SINO;
         aAlfa = #915#1;  |QBT aAlfa;
         |SI aAlfa ! ""; |Y #910#46 ! "N";
             |ABRE #927;
             #927#0 = #915#1;
             |LEE 000#927=;
             |SI FSalida ! 0;
                  |DDEFECTO #927;
             |FINSI;
             |CIERRA #927;
             |ATRI I;  |PINTA 0837, #927#1;  |ATRI i;
         |FINSI;
     |FINSI;

     |SI nSwUsado ] 3;
         aAlfa = #915#2;  |QBT aAlfa;
         |SI aAlfa ! "";
             |ABRE #913;
             #913#0 = #915#0;
             #913#1 = #915#1;
             #913#2 = #915#2;
             |LEE 040#913=;
             |SI FSalida ! 0;
                  |DDEFECTO #913;
             |FINSI;
             |CIERRA #913;
             |ATRI I;  |PINTA 0937, #913#3;  |ATRI i;
         |FINSI;
     |SINO;
         aAlfa = #915#2;  |QBT aAlfa;
         |SI aAlfa ! ""; |Y #910#46 ! "N";
             |ABRE #927;
             #927#0 = #915#2;
             |LEE 000#927=;
             |SI FSalida ! 0;
                  |DDEFECTO #927;
             |FINSI;
             |CIERRA #927;
             |ATRI I;  |PINTA 0937, #927#1;  |ATRI i;
         |FINSI;
     |FINSI;

     aAlfa = #915#5;  |QBT aAlfa;
     |SI aAlfa ! ""; |Y #910#46 ! "N";
         |ABRE #927;
         #927#0 = #915#5;
         |LEE 040#927=;
         |SI FSalida ! 0;
             |MENAV "      Codigo Inxexistente.";
             |ERROR;
         |FINSI;
         |CIERRA #927;
         |ATRI I;  |PINTA 1037, #927#1;  |ATRI i;
     |FINSI;
|FPRC;
