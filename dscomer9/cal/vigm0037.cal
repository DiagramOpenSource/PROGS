|FICHEROS;
     vigm0037 #0;
     vigm0038 #1;
     vigm0002 #2;
     vigm0001 #10;
     vigm0019 #19;
     vigm0020 #20;
|FIN;

|VARIABLES;
     fNueva = @;
     fActual = @;
     nPos = 0;
     &eaLote = "";
     i = 0;
     nModo = 0;
     nKg = 0;
     nLin = 0;
     {-1}Menu = "";
     Menu1 = "2400";
     Menu2 = "1";
     Menu3 = "Opciones:  ";
     Menu4 = "CI";
     Menu5 = " Cambio Fecha ";
     Menu6 = " Impresion ";
|FIN;

|PROCESO vigm0020;
     |SI #20#9 = "N";
          nLin = nLin + 1;
          nKg = #20#4 / 1000;

          |DDEFECTO #1;
          #1#0 = #0#0;
          #1#1 = nLin;
          #1#2 = #20#7;
          #1#3 = #20#0;
          #1#4 = #20#1;
          #1#5 = #20#2;
          #1#6 = #20#3;
          #1#7 = nKg;
          |GRABA 020#1n;
          |SI FSalida = 0;
               #0#1 = #0#1 + nKg;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE vigm0019;
     #19#2;
     ;
     #0#0, "     ", 000001;
     #0#0, "zzzzz", 999999;
     ;
     NULL, NULL, vigm0020;
|FIN;

|PROCESO Tipo5; |TIPO 5;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 1; |ACABA; |FINSI;
     |ABRE #1;
     |BUCLE vigm0019;
     |CIERRA #1;
     |PINTA #0#1;
|FPRC;

|PROCESO Tipo2; |TIPO 2;
     #0#1 = #0#1 +. #1#7;
     |PINTA #0#1;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |CONFI "0000NImprimir parte ensaque";
     |SI FSalida = 0;
          |HAZ Tipo4;
     |FINSI;
|FPRC;

|PROCESO Imprime;
     |DDEFECTO #10;
     #10#0 = #1#5;
     |LEE 020#10=;

     |DDEFECTO #2;
     #2#0 = #10#3;
     |LEE 020#2=;

     eaLote = (#0#0 % 102) + (#0#0 % 402);
     |PRINT;
|FPRC;

|PROCESO Tipo4; |TIPO 4;
     Impresora = "Crystal Reports";
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "vigm0037";
          |SI FSalida = 0;
               |ABRE #2;
               |ABRE #10;
               |BUCLELIN 2Imprime#0;
               |CIERRA #10;
               |PIEINF;
               |FININF;
          |SINO;
               |MENAV "0000Error en informe 'vigm0037'";
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO Articulo; |TIPO 0;
     |ABRE #10;
     #10#0 = #1#5;
     |LEE 000#10=;
     |CIERRA #10;
     |SI #10#1 ! "T"; |Y #10#1 ! "M";
          |MENAV "0000No es un articulo terminado...";
          |ERROR;
     |FINSI;
|FPRC;
