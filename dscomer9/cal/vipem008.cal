||Obtienes un xls, con estos datos.
||http://www.ine.es/inebase2/leer.jsp?L=0&divi=IPC&his=0

||Este es el que les he mandado un correo, indicando el error.
||http://www.ine.es/cgi-bin/certi
||Dicen que los indices no se suman ... es el valor que sale cada mes.

|FICHEROS;
     vipem008 #0;
     vipem009 #909,MANTE;      ||% IPC por a¤o

     agifa007 #7;
     vipem027 #27,MANTE;
|FIN;

|VARIABLES;
     nGridSer = 0;
     aEsc1          = "";
     aEsc2          = "";
     aRetu          = "";
     aTecla         = "";


     nError = 0;
     aSerie = "";
     fSistema = @;
     aSistema = "";
     aLetra = "";
     aEjecuta = "";
     nExiste = 0;
     aMensaje = "";
     nPanta = 0;
     nRango = 0;
     nPos1 = 0;
     nPos2 = 0;
     nGrid = 0;

     aQueBoton = "";
     aID = "";
     nBotonAceptar = 0;
     nBotonCancelar = 0;

     nBoton = 0;
     nBotonP = 0;
     nBotonS = 0;
     fFecha = @;
     aFecha = "";
     aAnyo = "";
     nVentana = 0;

     {2}nNivel = 0;
     nIdSalir = 0;

     {-1}get        = "";
         get1       = 0;
         get2       = 0;
         get3       = 0;
         get4       = 0;
         get5       = "";
|FIN;

|PROCESO Tipo7C0_m009; |TIPO 7;
     fFecha = ~;
     aFecha = fFecha;
     aAnyo = aFecha % -104;
     #vipem009#0 = aAnyo;
     |PINTA #vipem009#0;
|FPRC;

|PROCESO Tipo80_m008; |TIPO 80;
     FSalida = 3299;
|FPRC;

|PROCESO Tipo12_m008; |TIPO 12;
|FPRC;

|PROCESO EventoPanta;

|FPRC;

|PROCESO PonLineal;
     nRango = 1 + 4 + 8 + 16 + 32;
     nPos1  = 1630;
     nPos2  = 2854;

     |LINEAL_SIMPLE #1#909, nRango, nPos1, nPos2, NULL, NULL, EventoPanta;
     nGrid = FSalida;
|FPRC;

|PROCESO Tipo7C17_m008;  |TIPO 7;
     aQueBoton     = "|X000";
     aID           = #0#aQueBoton#;
     nBotonAceptar = aID;
     |ESTADO_CONTROL nBotonAceptar, "HIDE";

     aQueBoton      = "|X001";
     aID            = #0#aQueBoton#;
     nBotonCancelar = aID;
     |ESTADO_CONTROL nBotonCancelar, "HIDE";
|FPRC;

|PROCESO ObtenIdSalir;
     InNivel = nNivel1<-;
     nNivel1 = 0;
     |ESPECIFICA "IDBOTONTECLA", nNivel;
     nIdSalir = nNivel2;
|FPRC;

|PROCESO Tipo0C12; |TIPO 0;
     |SI #0#12 = "N";
          |C_M #0#13, 1, "N";
          |C_M #0#14, 1, "N";
     |SINO;
          |C_M #0#13, 1, "S";
          |C_M #0#14, 1, "S";
     |FINSI;
     |PINTA #0#13;
     |PINTA #0#14;
|FPRC;

|PROCESO EventoSer;

|FPRC;

|PROCESO BotonS;
     |VENTANA 0852, 2798, -1, 1, "";
     nVentana = FSalida;

     get1 = -1;
     get2 = -1;
     get3 = 0;
     get4 = nVentana;
     get5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", get;

     |ABRE #vipem027;

||     |PINPA #0#vipem027;

     nRango = 1 + 4 + 8 + 16 + 32;
     nPos1 = 1053;
     nPos2 = 2595;

     |LINEAL_SIMPLE #1#vipem027, nRango, nPos1, nPos2, NULL, NULL, EventoSer;
     nGridSer = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nGridSer;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |CIERRA #vipem027;

     get1 = -1;
     get2 = -1;
     get3 = 0;
     get4 = nVentana;
     get5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", get;

     |FINVENTANA nVentana;
|FPRC;

|PROCESO BotonP;
     aEjecuta = "vipem015";
     |SUB_EJECUTA_NP aEjecuta;

     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;

     |FOCOTECLADO nBoton;
|FPRC;

|PROCESO Boton;
     |PTEC 806;
|FPRC;

|PROCESO ControlDigito; |TIPO 0;
     |SI #vipem008#12 = "S";
          aLetra = #vipem008#13;
          |SI aLetra < "0"; |O aLetra > "9";
               aMensaje = "0000Atencion: Solo permitidos digitos del 0 al 9";
               |MENAV aMensaje;
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0C18_m008; |TIPO 0;
     nError = 0;
     aSerie = #vipem008#18;
     |QBT aSerie;
     |SI aSerie ! "";
          fSistema = ~;
          aSistema = fSistema;
          aAnyo = aSistema % -102;
          aSerie = aSerie + aAnyo;

          |ABRE #agifa007;
          #agifa007#26 = aSerie;
          |LEE 000#agifa007.=;
          |SI FSalida ! 0;
               |VENTANA 0501, 3299, -1, 1, "";
               nVentana = FSalida;

               |PINPA #0#agifa007; nPanta = FSalida;
               |DDEFECTO #agifa007;
               #agifa007#26 = aSerie;
               |LEE 101#agifa007.=;
               |PINDA #0#agifa007;
               |ENDATOS #2#agifa007;
               |SI FSalida = 0;
                    |GRABA 020#agifa007.n;
               |SINO;
                    nError = 1;
               |FINSI;
               |LIBERA #agifa007;
               |FINVENTANA nVentana;
          |FINSI;
          |CIERRA #agifa007;
     |FINSI;

     |SI nError = 1;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tipo0C19_m008; |TIPO 0;
     nError = 0;
     aSerie = #vipem008#19;
     |QBT aSerie;
     |SI aSerie ! "";
          fSistema = ~;
          aSistema = fSistema;
          aAnyo = aSistema % -102;
          aSerie = aSerie + aAnyo;

          |ABRE #agifa007;
          #agifa007#26 = aSerie;
          |LEE 000#agifa007.=;
          |SI FSalida ! 0;
               |VENTANA 0501, 3299, -1, 1, "";
               nVentana = FSalida;

               |PINPA #0#agifa007; nPanta = FSalida;
               |DDEFECTO #agifa007;
               #agifa007#26 = aSerie;
               |LEE 101#agifa007.=;
               |PINDA #0#agifa007;
               |ENDATOS #2#agifa007;
               |SI FSalida = 0;
                    |GRABA 020#agifa007.n;
               |SINO;
                    nError = 1;
               |FINSI;
               |LIBERA #agifa007;
               |FINVENTANA nVentana;
          |FINSI;
          |CIERRA #agifa007;
     |FINSI;

     |SI nError = 1;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tipo0C17_m008; |TIPO 0;
     nError = 0;
     aSerie = #vipem008#17;
     |QBT aSerie;
     ||Estan usando la serie "08", por lo tanto la vamos a permitir tambien
||     |SI aSerie ! "";

          fSistema = ~;
          aSistema = fSistema;
          aAnyo = aSistema % -102;
/*
          ||Tiquet 2805|2180
          |SI #vipem008#16 = "S"; |Y aSerie = "SP";
               aSerie = aSerie;         ||Permitir la serie SP, pq. ya la estan usando.
          |SINO;
               aSerie = aSerie + aAnyo;
          |FINSI;
*/
           aSerie = aSerie + aAnyo;

          |ABRE #agifa007;
          #agifa007#26 = aSerie;
          |LEE 000#agifa007.=;
          |SI FSalida ! 0;
               |VENTANA 0501, 3299, -1, 1, "";
               nVentana = FSalida;

               |PINPA #0#agifa007; nPanta = FSalida;
               |DDEFECTO #agifa007;
               #agifa007#26 = aSerie;
               |LEE 101#agifa007.=;
               |PINDA #0#agifa007;
               |ENDATOS #2#agifa007;
               |SI FSalida = 0;
                    |GRABA 020#agifa007.n;
               |SINO;
                    nError = 1;
               |FINSI;
               |LIBERA #agifa007;
               |FINVENTANA nVentana;
          |FINSI;
          |CIERRA #agifa007;
||     |FINSI;

     |SI nError = 1;
          |ERROR;
     |FINSI;
|FPRC;

|PROGRAMA;
     |ABRE #909;
     |CLS;
     |ABRE #0;
     |DDEFECTO #0;
     |LEE 101#0p;
     nExiste = FSalida;

     |VENTANA 0501, 3299, -1, 1, "";
     nVentana = FSalida;

     |PINPA #0#0; nPanta = FSalida;
     |PINDA #0#0;

     nPos1 = 3285;  nPos2 = 3295;
     ||CONTROL_SIMPLE nPanta, "BOTON,{{001}}Salir", nPos1, nPos2, Boton;
     |CONTROL_SIMPLE 0, "BOTON,{{001}}Salir", nPos1, nPos2, Boton;
     nBoton = FSalida;

     nPos1 = 0675;  nPos2 = 0698;
     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Plantillas Documentos", nPos1, nPos2, BotonP;
     nBotonP = FSalida;

     nPos1 = 0775;  nPos2 = 0798;
     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Series desde Gesti¢n", nPos1, nPos2, BotonS;
     nBotonS = FSalida;

     |HAZ PonLineal;

     |ENDATOS #1#0;
     |SI FSalida = 0;
          |SI nExiste = 0;
               |GRABA 020#0a;
          |SINO;
               |GRABA 020#0n;
          |FINSI;
     |FINSI;
     |LIBERA #0;
     |CIERRA #0;
     |CIERRA #909;

     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;

     |DESTRUYECONTROL nGrid;
     |FIN_CONTROL_WINDOWS nBoton;
     |FIN_CONTROL_WINDOWS nBotonP;

     |FINVENTANA nVentana;
|FPRO;
