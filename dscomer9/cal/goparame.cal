|FICHEROS;
     goparame #0;
     goparam5 #5,MANTE;
     agifa029 #1;
     agifa724 #724;
     canempr@ #1000;
     gocerenc,MANTE;
|FIN;
-------------------------------------------------------------------------------
|VARIABLES;
     nHandle0 = 0;
     nHandle1 = 0;
     aOrg = "";
     aDes = "";
     aAlfa     = "";
     aAlfa1    = "";
     &cSerFmt  = "";

     cPath     = "";
     cDirBase  = "";
     cOrigen   = "";
     cDestino  = "";
     cIp       = "";

     nTecla    = 0;
     nConta    = 0;
     nBotPath  = 0;
     nBotEC    = 0;
     FEstado   = 0;
|FIN;
-------------------------------------------------------------------------------
|PROGRAMA;
     |CONTROL_SIMPLE 0, "BOTON,F2 - Path FIEBDC.", 2425, 2455, PathFie;
     nBotPath = FSalida;
     |ESTADO_CONTROL nBotPath, "HIDE";
     |CONTROL_SIMPLE 0, "BOTON,Definir Enlace Asociado", 1446, 1461, PulsaBotEC;
     nBotEC = FSalida;
     |ESTADO_CONTROL nBotEC, "HIDE";
     |ABRE #0;
     #0#0 = "A";
     |LEE 000#0=;

     |SI FSalida ! 0;
          |DDEFECTO #0;
          |GRABA 020#0c;
     |FINSI;

     |CLS;
     |CABEZA "PARAMETROS DE OBRAS";
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #2#0;

     |SI FSalida = 0;
          |GRABA 020#0a;
     |FINSI;

     |HAZ CambiaMenu;

     |PULSATECLA;
     |FIN_CONTROL_WINDOWS nBotPath;
     |PULSATECLA;
     |FIN_CONTROL_WINDOWS nBotEC;
     |PULSATECLA;
|FPROG;
-------------------------------------------------------------------------------
|PROCESO LmtSer; |TIPO 6;
     cSerFmt = #0Campo;
     |HAZ FmtSerie;
     #0Campo = cSerFmt;
     |PINTA #0Campo;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO Conf; |TIPO 0;
     |SI #0#19 = "S";
          |C_M #0#20, 1, "S";
          |C_M #0#33, 1, "S";
     |SINO;
          |C_M #0#20, 1, "N";
          |C_M #0#33, 1, "N";
          #0#33 = 1;
          #0#20 = "N";
          |PINTA #0#20;
          |PINTA #0#33;
     |FINSI;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO PathFie;
     |PTEC 824;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO Bgoparame; |TIPO  7;
     |ESTADO_CONTROL nBotPath, "SHOW"; ||"SHOW""HIDE""ENABLE""DISABLE".
|FPRC;
-------------------------------------------------------------------------------
|PROCESO PathBan; |TIPO 0;
     cPath = #0Campo;
     |QBF cPath;
     |SI cPath = ""; |O FSalida = 10;
          cPath = " ";
          |BROWSE cPath;
          cPath = cPath % 280;
          |QBT cPath;
          |SI cPath = "";
               |ERROR;
               |ACABA;
          |SINO;
               #0Campo = cPath;
               |PINTA #0Campo;
          |FINSI;
     |FINSI;
     |ESTADO_CONTROL nBotPath, "HIDE"; ||"SHOW""HIDE""ENABLE""DISABLE".
|FPRC;
-------------------------------------------------------------------------------
|PROCESO MiraAlma; |TIPO 0;
     |ABRE #1;
     |DDEFECTO #1;
     #1#0 = #0#22;                                ||Codigo Almacen;
     |LEE 000#1=;

     |SI FSalida ! 0;
          |PUSHV 01012380;
          |CLS;
          |PINPA #0#1;
          |PINDA #0#1;
          |ENDATOS #1#1;

          |SI FSalida = 0;
               |GRABA 020#1c;
          |SINO;
               |ERROR;
          |FINSI;

          |POPV;
     |FINSI;

     #0#23 = #1#1;
||     |PINTA #0#23;
     |CIERRA #1;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO serie; |TIPO 0;
     |SI #0#42 = "S";
          |C_M #0#43 , 1 , "S";
     |SINO;
          |C_M #0#43 , 1 , "N";
          #0#43 = "M";
          |PINTA #0#43;
     |FINSI;
|FPRC;

|PROCESO AlmaExpe7; |TIPO 7;
     aAlfa = #0#44;
     |SI #0#44 = "A";
          |C_M #0#50, 1 , "S";
     |SINO;
          |C_M #0#50, 1 , "N";
          #0#50 = "N";
          |PINTA #0#50;
     |FINSI;
|FPRC;

|PROCESO DuPre; |TIPO 0;
     |SI #0#52 = "N";
          #0#58 = 1;      |PINTA #0#58;
          #0#59 = 999999; |PINTA #0#59;
          #0#54 = 0;      |PINTA #0#54;
          #0#55 = "N";    |PINTA #0#55;
          #0#56 = 0;      |PINTA #0#56;
          #0#57 = "N";    |PINTA #0#57;
          #0#57 = "N";    |PINTA #0#60;
          |C_M #0#54, 1, "N"; |C_M #0#55, 1, "N";
          |C_M #0#56, 1, "N"; |C_M #0#57, 1, "N";
          |C_M #0#58, 1, "N"; |C_M #0#59, 1, "N";
          |C_M #0#60, 1, "N";
     |SINO;
          #0#55 = "S";    |PINTA #0#55;
          #0#57 = "S";    |PINTA #0#57;
          |C_M #0#54, 1, "S"; |C_M #0#55, 1, "S";
          |C_M #0#56, 1, "S"; |C_M #0#57, 1, "S";
          |C_M #0#58, 1, "S"; |C_M #0#59, 1, "S";
          |C_M #0#60, 1, "S";
     |FINSI;
|FPRC;

|PROCESO DuPreExp;
     |SI #0#55 = "N";
          #0#54 = 0; |PINTA #0#54; |C_M #0#54, 1, "N";
     |SINO;
          |C_M #0#54, 1, "S";
     |FINSI;
|FPRC;

|PROCESO IncExp;
     |SI #0#55 = "S";
        |SI #0#54 [ #0#59;
           |MENAV "    Debe indicar un valor fuera del rango de trabajo";
           |ERROR;
        |FINSI;
     |FINSI;
|FPRC;

|PROCESO DuPreCer;
     |SI #0#57 = "N";
          #0#56 = 0; |PINTA #0#56; |C_M #0#56, 1, "N";
     |SINO;
          |C_M #0#56, 1, "S";
     |FINSI;
|FPRC;

|PROCESO IncCer;
     |SI #0#57 = "S";
        |SI #0#56 [ #0#59;
           |MENAV "    Debe indicar un valor fuera del rango de trabajo";
           |ERROR;
        |FINSI;
     |FINSI;
|FPRC;

|PROCESO Min5;
     #5#0 = 1;
|FPRC;

|PROCESO Max5;
     #5#0 = 99999;
|FPRC;

|PROCESO MasAlmacen; |TIPO 0;
     |SI #0#76 = "S";
          |SI FSalida = 0;
               |PUSHV 0501 2380;
               |BLANCO 840 2368;
               |ENTLINEAL #1#5, 1, 2, 21, 1, Min5, Max5;
               |POPV;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO MiraSiConta;
   aAlfa = #0#84; |QBF aAlfa;
   |SI aAlfa = ""; |ACABA; |FINSI;
   aAlfa1 = aAlfa % -101;
   |SI aAlfa1 ! "/"; |Y aAlfa1 ! "\";
      aAlfa = aAlfa + "/";
      #0#84 = aAlfa; |PINTA #0#84;
   |FINSI;
   aAlfa = aAlfa + "fich/canempre.dat";
   |XABRE "E", aAlfa, 0;
   |SI FSalida ! 0;
      |MENAV "    No existe contabilidad. Revise el camino.";
      |ERROR;
   |FINSI;
|FPRC;

|PROCESO MiraEmpresa;
   nTecla = FSalida;

   aAlfa = #0#84; |QBF aAlfa;
   aAlfa = aAlfa + "def/canempre.mas";
   |CARGA_DEF aAlfa, canempr@;
   |SI FSalida = 0;
      aAlfa = #0#84; |QBF aAlfa;
      aAlfa = aAlfa + "fich/"; |PATH_DAT #canempr@#aAlfa#;
      |ABRE #canempr@;
      |SI nTecla = 10;
         |CONSULTA_CLAVE #1#canempr@;
         |SI FSalida = 0;
            #goparame#85 = #canempr@#2; |PINTA #goparame#85;
            #goparame#86 = #canempr@#3; |PINTA #goparame#86;
            #goparame#87 = #canempr@#1; |PINTA #goparame#87;
         |FINSI;
         |ERROR;
      |FINSI;
      |SI Campo = 86;
         #canempr@#2 = #goparame#85;
         #canempr@#3 = #goparame#86;
         |LEE 000#canempr@.=;
         |SI FSalida ! 0;
            |MENAV "    Empresa inexistente";
            |ERROR;
         |FINSI;
      |FINSI;
      |CIERRA #canempr@; |DESCARGA_DEF #canempr@;
   |FINSI;
|FPRC;

|PROCESO ArtCerSub; |TIPO 0;
     |ABRE #724;
     #724#0 = #0#89;
     |LEE 000#724=;
     |SI FSalida ! 0;
          aAlfa = "0000No existe articulo en"+&13+" 'Cuenta Gastos e Ingresos'";
          |MENAV aAlfa;
          |ERROR;
     |SINO;
          aAlfa = #724#3; |QBF aAlfa;
          |SI aAlfa = "";
               aAlfa = "0000Cta Gastos no informada en"+&13+" 'Cuenta Gastos e Ingresos'";
               |MENAV aAlfa;
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #724;
|FPRC;

|PROCESO PulsaBotEC;
     |ESTADO_CONTROL nBotEC, "HIDE";
     |PUSHV 05012380;
     |ABRE #gocerenc;
     |LEE 000#gocerenc.p;
     FEstado = FSalida;

     |PINPA #0#gocerenc;
     |PINDA #0#gocerenc;
     |SI FEstado ! 0;
          |ENDATOS #1#gocerenc;
          |SI FSalida = 0;
               |GRABA 020#gocerenc.n;
          |FINSI;
     |SINO;
          |ENDATOS #2#gocerenc;
          |SI FSalida = 0;
               |GRABA 020#gocerenc.a;
          |FINSI;
     |FINSI;
     |LIBERA #gocerenc;
     |CIERRA #gocerenc;
     |POPV;
     |ESTADO_CONTROL nBotEC, "SHOW";
|FPRC;

|PROCESO BotEC_Activa7; |TIPO 7;
     |HAZ BotEC_Activa0;
|FPRC;

|PROCESO BotEC_Activa0; |TIPO 0;
     |SI #0#88 = "S";
          |ESTADO_CONTROL nBotEC, "ENABLE";
     |SINO;
          |ESTADO_CONTROL nBotEC, "DISABLE";
     |FINSI;
     |ESTADO_CONTROL nBotEC, "SHOW";
|FPRC;

|PROCESO QuitaBoton; |TIPO 7; || Al pintar 1§ Campo de la 3, 5 pantalla
     |ESTADO_CONTROL nBotEC, "HIDE"
|FPRC;

|PROCESO GrupoGen; |TIPO 0;
     aAlfa = #0#119;
     |C_M #0#116, 1, aAlfa;
     |C_M #0#117, 1, aAlfa;
     |C_M #0#118, 1, aAlfa;
|FPRC;

|PROCESO CambiaMenu;
     |DBASE aAlfa;
     aDes = aAlfa + "dsmodulo.men";
     |SI #0#141 = "P";
          aOrg = aAlfa + "plugins/000con.men";
     |SINO;
          aOrg = aAlfa + "plugins/001con.men";
     |FINSI;
     |XABRE "", aDes, nHandle0;
     |SI FSalida ] 0;
          |XLEE nHandle0, 250, aAlfa;   || coge 1§ linea, la version actual
          |XCIERRA nHandle0;
          |XABRE "", aOrg, nHandle1;
          |SI FSalida ] 0;
               |XABRE "W", aDes, nHandle0;
               |SI FSalida ] 0;
                    |XGRABA nHandle0, aAlfa;    || graba la version
                    |XLEE nHandle1, 250, aAlfa; || desprecia la version del nuevo
                    |XLEE nHandle1, 250, aAlfa;
                    |PARA; |SI FSalida ] 0; |HACIENDO;
                         |XGRABA nHandle0, aAlfa;|| graba el nuevo
                         |XLEE nHandle1, 250, aAlfa;
                    |SIGUE;
                    |XCIERRA nHandle0;
                    |XCIERRA nHandle1;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;
