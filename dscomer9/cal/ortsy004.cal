|FICHEROS;
     ortsy004 #0;
     dsm00003 #3;
     ortsm006 #6;
     ortsm008 #8;
     ortsm017 #17;
     ortsm018 #18;
     agifa019 #19;
     agifa073 #73;
     agifa104 #104;
|FIN;

|VARIABLES;
     aAlfa = "";
     nPrime = 0;
|FIN;

|PROCESO CombinaUni;
     #6#0 = #18#5;
     |LEE 000#6=;
     |SI FSalida ! 0; |DDEFECTO #6; |FINSI;
     |PRINT;
|FPRC;

|DEFBUCLE CombinaUni;
     #18#1;
     ;
     #17#0, #17#1, #17#2, #17#3, 001;
     #17#0, #17#1, #17#2, #17#3, 999;
     ;
     NULL, CombinaUni;
|FIN;

|PROCESO Combina;
     #19#0 = #17#4;
     |LEE 000#19=;

     |SI #19#0 < #0#23; |O #19#0 > #0#24; |ACABA; |FINSI;
     |SI #19#127 < #0#25; |O #19#127 > #0#26; |ACABA; |FINSI;
     |SI #19#2 < #0#27; |O #19#2 > #0#28; |ACABA; |FINSI;
     |SI #19#3 < #0#12; |O #19#3 > #0#13; |ACABA; |FINSI;
     |SI #19#125 < #0#29; |O #19#125 > #0#30; |ACABA; |FINSI;

     |SI #17#7 = 1; |O #17#8 ! "S";
          #18#5 = #17#6;

          #6#0 = #18#5;
          |LEE 000#6=;
          |SI FSalida ! 0; |DDEFECTO #6; |FINSI;
          |PRINT;
     |SINO;
          |BUCLE CombinaUni;
     |FINSI;
|FPRC;

|DEFBUCLE Combina;
     #17#1;
     ;
     #73#28, #73#0, #73#1, 001;
     #73#28, #73#0, #73#1, 999;
     ;
     NULL, Combina;
|FIN;

|PROCESO LinPedi;
     |SI #73#2 < #0#15; |O #73#2 > #0#16; |ACABA; |FINSI;

     #19#0 = #73#2;
     |LEE 000#19=;
     |SI FSalida ! 0; |DDEFECTO #19; |FINSI;

     |SI #19#127 < #0#17; |O #19#127 > #0#18; |ACABA; |FINSI;
     |SI #19#2 < #0#19; |O #19#2 > #0#20; |ACABA; |FINSI;
     |SI #19#125 < #0#21; |O #19#125 > #0#22; |ACABA; |FINSI;

     #8#0 = #73#28;
     #8#1 = #73#0;
     #8#2 = #73#1;
     |LEE 000#8=;
     |SI FSalida ! 0; |DDEFECTO #8; |FINSI;
     |BUCLE Combina;
|FPRC;

|PROCESO CabPedi;
     #3#0 = #104#4;
     #3#1 = #104#57;
     |LEE 000#3=;
     |SI FSalida ! 0; |DDEFECTO #3; |FINSI;
     |SI #3#11 < #0#6; |O #3#11 > #0#7;
          |ERROR; |ACABA;
     |FINSI;
     |SI nPrime ! 0; |PIEINF; |FINSI;
     nPrime = 1;
|FPRC;

|DEFBUCLE Pedido;
     #104#1;
     4, 1, 2;
     #0#0, #0#2, #0#4, #0#8, #0#10;
     #0#1, #0#3, #0#5, #0#9, #0#11;
     ;
     NULL, CabPedi, LinPedi;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     Impresora = "Crystal Reports";
     |IMPRE 0;
     |SI FSalida = 0;
          aAlfa = #0#14; |QBF aAlfa;
          |INFOR aAlfa;
          |SI FSalida = 0;
               |ABRE #3;
               |ABRE #8;
               |ABRE #6;
               |ABRE #19;
               |BUCLE Pedido;
               |CIERRA #19;
               |CIERRA #6;
               |CIERRA #8;
               |CIERRA #3;
               |PIEINF;
               |FININF;
          |SINO;
               aAlfa = "0000Error en informe:" + aAlfa;
               |MENAV aAlfa;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
