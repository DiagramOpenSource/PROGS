|FICHEROS;
     guerm017 #0;
     guerm018 #1;

     gopartca #2;
     gopartll #3;
     gopartli #4;
     goptrbli #5;
     gopartia #6; ||=     goalbpa6
     goptrbca #7;
     gopre001 #8;
     gomantho #9;

     gopartid #12;
     gocatcon #13;
     gopre004 #15;
     gomantli #16;
     gomantca #18;
     gocatcot #19;
     agifa027 #27;
     goalbpa7 #14;
     gopre002 #26;
     gopre003 #30;
     gosubaux #31;

     gotrabaj #100;
     gocatcon #101;
|FIN;

|VARIABLES;
     &eaCerti = "";
     &eaPrograma = "";
     &enConductor = 0;
     &Tempo         = "";
     aTempo14       = "";
     i              = 0;
     nSwTodos       = 0;
     nLin           = 0;
     aTempo1        = "";
     &cCodMonTrab   = "";
     &cCodMonDe     = "";
     &cCodMonA      = "";
     &nPrecioVent   = 0;
     &nPrecioComp   = 0;
     nMoneCat       = "";
     nMoneExp       = "";
     nConta         = 0;
     nModo          = 0;
     nLinea         = 0;
     nHay           = 0;
     nSigno         = 0;
     nBotTipos      = 0;
     nSalida        = 0;

     cConta         = "";
     cTipo          = "";
     nHP            = 0;
     nHA            = 0;
     nHE            = 0;
     nBotF20        = 0;
     nBotF21        = 0;
     nBotF30        = 0;
|FIN;

|PROCESO EstaCerti;
     |ABRE #31;
     #31#0 = #6#34;
     #31#1 = #6#4;
     #31#2 = #6#5;
     #31#3 = #6#6;
     #31#4 = #6#7;
     |LEE 101#31=;
     |SI FSalida = 0; |Y #31#6 = "S";
          eaCerti = "S";
     |SINO;
          eaCerti = "N";
     |FINSI;
     |CIERRA #31;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Ultimo4;
     |SELECT #1#4;
     #4#2 = 9999;
     |LEE 000#4];
     |SI FSalida = 0;
          |LEE 000#4a;
     |SINO;
          |LEE 000#4u;
     |FINSI;
     |SI FSalida = 0; |Y #4#0 = #1#12; |Y #4#1 = #1#13;
          nLin = #4#2 + 1;
     |SINO;
          nLin = 1;
     |FINSI;

     |DDEFECTO #4;
     #4#0 = #1#12;
     #4#1 = #1#13;
     #4#2 = nLin;
     |GRABA 020#4b;
|FPRC;

|PROCESO ContaParte;
     |ABRE #27;
     #27#0 = "partetrab";
     #27#2  = #1#10;
     |LEE 000#27=;
     |SI FSalida = 0;
          #27#1 = #27#1 + 1;
          |GRABA 020#27a;
     |SINO;
          #27#1 = 1;
          |GRABA 020#27n;
     |FINSI;
     |CIERRA #27;

     #7#15 = #1#10;
     #7#3 = #27#1;
|FPRC;

|PROCESO Ultimo5;
     |SELECT #1#5;
     #5#3 = 9999;
     |LEE 000#5];
     |SI FSalida = 0;
          |LEE 000#5a;
     |SINO;
          |LEE 000#5u;
     |FINSI;
     |SI FSalida = 0; |Y #5#20 = #1#12; |Y #5#21 = #1#13; |Y #5#2 = #0#1;
          nLin = #5#3 + 1;
     |SINO;
          nLin = 1;
     |FINSI;

     |DDEFECTO #5;
     #5#20 = #1#12;  ||Se
     #5#21 = #1#13;  ||Pre
     #5#2 = #0#1;   ||Fecha
     #5#3 = nLin;
     |GRABA 020#5b;
|FPRC;

|PROCESO Ultimo6;
     |SELECT #1#6;
     #6#7 = 999;
     |LEE 000#6];
     |SI FSalida = 0;
          |LEE 000#6a;
     |SINO;
          |LEE 000#6u;
     |FINSI;
     |SI FSalida = 0; |Y #6#4 = #7#15 ; |Y #6#5 = #7#3; |Y #6#6 = #5#3;
          nLin = #6#7 + 1;
     |SINO;
          nLin = 1;
     |FINSI;
     |DDEFECTO #6;
     #6#34 = "T";
     #6#4 = #7#15; ||Se
     #6#5 = #7#3;  ||Alba
     #6#6 = #5#3;  ||Lin
     #6#7 = nLin;
     |GRABA 020#6b;
|FPRC;

|PROCESO CargaEl3;
     |DDEFECTO #3;
     #3#0 = #2#0;                                 ||Serie Expe.
     #3#1 = #2#1;                                 ||Num. Exped.
     #3#2 = #16#2;                                ||Linea.
     |LEE 000#3=;
     |SI FSalida ! 0;
          #3#3 = #16#6;                            ||Fecha Pres.
          #3#4 = #16#3;                            ||Serie Pres.
          #3#5 = #16#4;                            ||Num. Presu.
          #3#14 = #16#5;                           ||Tipo Presu.
          |GRABA 020#3n;
     |FINSI;
|FPRC;

|PROCESO ManoObra;
     |SI eaPrograma = "guerm017";  || No se puede leer porque en alta no
                                   || esta grabada la cabecera
          #0#0 = #1#0;
          #0#1 = #1#1;
          #0#2 = #1#2;
          #0#3 = enConductor;
     |SINO;
          |ABRE #0;
          #0#0 = #1#0;
          #0#1 = #1#1;
          #0#2 = #1#2;
          |LEE 020#0=;
          |CIERRA #0;
     |FINSI;

     |DDEFECTO #100;
     |ABRE #100;
     #100#0 = #0#3;
     |LEE 000#100=;
     |CIERRA #100;

     |DDEFECTO #101;
     |ABRE #101;
     #101#0 = #100#3;
     #101#1 = #100#2;
     |LEE 000#101=;
     |CIERRA #101;

     |ABRE #8;
     #8#0 = #1#12;
     #8#1 = #1#13;
     |LEE 020#8=;
     |CIERRA #8;

     ||컴컴컴컴컴컴컴컴컴컴컴컴
     |ABRE #2;
     |ABRE #3;
     |ABRE #18;
     #18#0 = #1#10;
     #18#1 = #1#11;
     |LEE 020#18=;
     |SI FSalida = 0;
          |DDEFECTO #2;
          #2#0 = #1#10;
          #2#1 = #1#11;
          |LEE 101#2=;
          |SI FSalida ! 0;
               #2#10 = #18#2;
               #2#11 = #18#6;
               #2#12 = #18#8;
               |GRABA 020#2b;
          |FINSI;
          |BUCLELIN 2 CargaEl3 #18;
     |FINSI;
     |CIERRA #18;

     |SELECT #2#3;
     #3#0 = #1#10; ||Se
     #3#1 = #1#11; ||Exp
     #3#4 = #1#12; ||Se
     #3#5 = #1#13; ||Pre
     |LEE 121#3=;

     |ABRE #4;  |SELECT #2#4;
     |ABRET #5; |SELECT #5#5;
     |ABRET #6; |SELECT #2#6;
     |ABRE #7;

     #4#0 = #1#12; ||Ser
     #4#1 = #1#13; ||Num Pre
     #4#3 = #0#1; ||F. Parte
     |LEE 101#4=;
     |SI FSalida ! 0; |HAZ Ultimo4; |FINSI;
     #4#0 = #1#12; ||Ser
     #4#1 = #1#13; ||Num Pre
     #4#3 = #0#1; ||F. Parte

     |DDEFECTO #7;
     #7#0 = #1#10;   ||Ser
     #7#1 = #1#11;   ||Exp.
     #7#2 = #0#1;   ||F.Parte
     #7#16 = #1#12;  ||Se
     #7#17 = #1#13;  ||Pres
     |LEE 101#7=;
     |SI FSalida ! 0; |HAZ ContaParte; |GRABA 020#7b; |FINSI;
     #7#0 = #1#10;   ||Ser
     #7#1 = #1#11;   ||Exp.
     #7#2 = #0#1;   ||F.Parte
     #7#7 = #9#2;
     #7#8 = #9#8;
     #7#14 = #9#6; ||Moneda
     #7#16 = #1#12;  ||Se
     #7#17 = #1#13;  ||Pres
     #7#20 = #8#18; ||Tipo Cargo

     #4#4 = #7#15;
     #4#5 = #7#3;
     #4#14 = #1#10;
     #4#15 = #1#11;
     #4#16 = #3#14;

     #5#20 = #1#12;  ||Se
     #5#21 = #1#13;  ||Pre
     #5#2 = #0#1;    ||Fecha
     #5#4 = #0#3;    ||Traba
     #5#26 = #1#9;   ||Tipo Hora
    || |LEE 101#5=;
    || |SI FSalida ! 0; |HAZ Ultimo5; |FINSI;

     |HAZ Ultimo5;

     #5#0 = #1#10;   ||Se
     #5#1 = #1#11;   ||Exp
     #5#2 = #0#1;   ||Fecha
     #5#4 = #0#3;   ||Traba
     #5#5 = #100#1;
     #5#6 = #101#0; ||Categoria
     #5#7 = #101#2; ||Des
     #5#20 = #1#12;  ||Se
     #5#21 = #1#13;  ||Pre
     #5#22 = #1#17;
     #5#23 = #7#15; || Se
     #5#24 = #7#3;  || Parte
 ||  #5#25 = ANULADO
     #5#26 = #1#9; ||Tipo Hora
  || #5#27 =       || Descripcion

     |DDEFECTO #6;
     #6#4 = #7#15; ||Se
     #6#5 = #7#3;  ||Alba
     #6#8 = #1#14;  ||Parti
     #6#6 = #5#3;  ||Lin
     |LEE 101#6=;
     |SI FSalida ! 0; |HAZ Ultimo6; |FINSI;
     #6#0 = #1#12;  ||Se
     #6#1 = #1#13;  ||Pres
     #6#2 = #1#10;  ||Se
     #6#3 = #1#11;  ||Exp
     #6#4 = #7#15; ||Se
     #6#5 = #7#3;  ||Alba
     #6#6 = #5#3;  ||Lin
     #6#8 = #1#14;  ||Parti
     #6#9 = #1#15;
     ||컴컴컴컴컴컴컴컴컴
     #6#15 = #8#2;
     #6#16 = #8#3;
||   #6#17 =        ||Alma
||   #6#18 =        ||Des. Alma
||   #6#19 =        ||Documento Traspaso
     #6#20 = #101#13;
     #6#21 = #8#7;
||   #6#26 =        ||Tipo Entra
||   #6#27 =
     #6#28 = #0#1;
     #6#29 = "T";
||   #6#30 =
||   #6#31 =
||   #6#32 =        ||Serie Traspaso
     #6#33 = #1#23;
     ||컴컴컴컴컴컴컴컴컴컴컴컴컴
     #6#10 = #1#5;           ||Uni
     #6#37 = #1#6;           ||Pv Tra
     #6#41 = #1#16;          ||Pc Tra
     #6#38 = 0;
     #6#39 = 0;
     #6#40 = 0;
     #6#42 = 0;
     #6#43 = 0;
     #6#44 = 0;

     |HAZ CalcuGopartia;

     nHP = 0; nHA = 0; nHE = 0;
     |SI #8#18 = "P"; nHP = #1#5; |FINSI;
     |SI #8#18 = "A"; nHA = #1#5; |FINSI;
     |SI #8#18 = "E"; nHE = #1#5; |FINSI;

     #5#8 = #5#8 +. nHP;
     #5#9 = #5#9 +. nHA;
     #5#10 = #5#10 +. nHE;
     #5#11 = #5#8 + #5#9 + #5#10;
     #5#12 = #1#6;
     #5#13 = #1#16;
     #5#14 = #5#12;
     #5#15 = #5#13;
     #5#16 = #5#11 * #5#12;
     #5#17 = #5#11 * #5#13;
     #5#18 = #5#16;
     #5#19 = #5#17;

     #7#4 = #7#4 +. nHP;
     #7#5 = #7#5 +. nHA;
     #7#6 = #7#6 +. nHE;
     #7#9 = #7#4 + #7#5 + #7#6;
     #7#10 = #7#10 +. (#1#16 * #1#5);
     #7#11 = #7#11 +. (#1#6 * #1#5)
     #7#12 = #7#12 +. (#1#16 * #1#5);
     #7#13 = #7#13 +. (#1#6 * #1#5);
     #7#18 = #7#9; ||???
     #7#19 = 0;    ||???

     #4#6 = #4#6 +. nHP;
     #4#7 = #4#7 +. nHA;
     #4#8 = #4#8 +. nHE;
     #4#9 = #4#9 +. (#1#16 * #1#5);
     #4#10 = #4#10 +.(#1#6 * #1#5);
     #4#11 = #4#9;
     #4#12 = #4#10;
     #4#13 = #4#6 + #4#7 + #4#8;

     #3#6 = #3#6 +. nHP;
     #3#7 = #3#7 +. nHA;
     #3#8 = #3#8 +. nHE;
     #3#9 = #3#9 +. (#1#16 * #1#5);
     #3#10 = #3#10 +. (#1#6 * #1#5);
     #3#11 = #3#9;
     #3#12 = #3#10;
     #3#13 = #3#6 + #3#7 + #3#8;

     |GRABA 020#2a;
     |GRABA 020#3a;
     |GRABA 020#4a;
     |GRABA 020#5a;
     |GRABA 020#6a;
     |GRABA 020#7a;

     |CIERRA #3;
     |CIERRA #2;
     |CIERRA #7;
     |CIERRAT #6;
     |CIERRAT #5;
     |CIERRA #4;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
