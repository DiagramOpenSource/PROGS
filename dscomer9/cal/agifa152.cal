               ||Cambio de codigos de Articulos

|FICHEROS;
     agifa152 #0;
     agifa019 #1;        ||Articulos
     agifa017 #2;        ||Stocks de Almacenes
     agifa073 #4;        ||Lineas Pedidos
     agifa065 #6;        ||Historico
     agifa067 #7;        ||Lineas Pedidos Compras
     agifa048 #9;        ||Escandallos
     agifa049 #10;       ||Lineas Escandallos
     agifa290 #15;       ||Promociones Articulo;
     agifa292 #16;       ||Cabecera Equivalencias;
     agifa293 #17;       ||Lineas Equivalencias;
     agifa154 #20;       ||Linas Ajuste Articulos
     agifa561 #561;
     agitp001;
     dsm00237;
     dsl00001 #100;
     dsm00006 #102;
     agifa502 #103;
     agifa219 #219;
     agifa220 #220;

     ma000001@ #1000;
     ma000017@ #1001;
     ma000018@ #1002;
     ma001001@ #1003;
     ma001008@ #1004;
     ma001009@ #1005;
     ma001010@ #1006;
     ma100032@ #1007;
     ma100033@ #1008;
     ma100107@ #1009;
     ma100119@ #1010;
     ma100319@ #1011;
     maf00001@ #1012;
     maf01001@ #1013;

     Ref00577@ #1020;
|FIN;

|VARIABLES;
     &eaFic = "";
     &eaOrg = "";
     &eaDes = "";
     &enErr = 0;
     &enSwAltaArt = 0; ||para la copia de empresas
     &CambDesc = "";
     &AltaArt  = "";

     aAlfa = "";
     aDef = "";
     aFic = "";

     i = 0;
     &tabla = 0;
     &sust = " ";
     &stock = " ";
     &tipo = " ";
     &barras = "";
     wdes = "";
|FIN;

|PROCESO agifa502;
     #103#2 = #20#3;
     #103#8 = #20#5;
     |GRABA 020#103a;
     |LIBERA #103;
|FPRC;

|DEFBUCLE agifa502;
     #103#4;
     ;
     #20#2, "     ", 000001, 001;
     #20#2, "zzzzz", 999999, 999;
     be;
     NULL, agifa502;
|FIN;

|PROCESO dsm00006;
     |BORRA 020#102a;
     #102#0 = #20#3;
     |GRABA 000#102n;
     |SI FSalida ! 0;
          enErr = FSalida;
          eaFic = "dsm00006";
          eaOrg = #20#2;
          eaDes = #20#3;
          |HAZ Print;
     |FINSI;
|FPRC;

|DEFBUCLE dsm00006;
     #102#1;
     ;
     #20#2, 01, "01.01.00000", "  ", "     ", 000001, 00001, "      ";
     #20#2, 99, "31.12.99999", "zz", "zzzzz", 999999, 99999, "zzzzzz";
     be;
     NULL, dsm00006;
|FIN;

|PROCESO dsl00001;
     #100#1 = #20#3;
     #100#2 = #20#5;
     |GRABA 020#100a;
     |LIBERA #100;
|FPRC;

|DEFBUCLE dsl00001;
     #100#3;
     ;
     #20#2, "             ";
     #20#2, "zzzzzzzzzzzzz";
     be;
     NULL, dsl00001;
|FINS;

|PROCESO copiaart;
     |ABRE #1;
     |DDEFECTO #1;
     #1#0 = #20#2;
     |LEE 001#1=;
     |SI FSalida = 0;
          |ABRE #2;
          #2#0 = #1#0;
          #2#1 = 0;
          |LEE 001#2];
          |PARA ; |SI FSalida = 0; |Y #2#0 = #1#0; |HACIENDO;
               |SI sust = "S";
                    |BORRA 020#2a;      ||Borro el almacen
               |FINSI;
               #2#0 = #20#3;
               |SI CambDesc = "S"; #2#40 = #20#5; |FINSI;
               |SI sust = "D"; |Y stock = "S";          ||Poner stock a 0
                    |PARA i = 3; |SI i [ 39; |HACIENDO i = i + 1;
                         #2i = 0;
                    |SIGUE;
                    #2#44 = 0;
                    #2#45 = 0;
                    #2#46 = 0;
                    #2#47 = 0;
                    #2#48 = 0;
               |FINSI;
               |GRABA 000#2n;           ||Grabo con el articulo nuevo
               |SI FSalida ! 0;
                    enErr = FSalida;
                    eaFic = "agifa017";
                    eaOrg = #20#2;
                    eaDes = #20#3;
                    |HAZ Print;
               |FINSI;
               |LIBERA #2;
               |LEE 101#2s;
          |SIGUE;
          |CIERRA #2;

          |SI sust = "S";
               |BORRA 020#1a;
               |LIBERA #1;
          |FINSI;

          #1#0 = #20#3;
          |SI CambDesc = "S"; #1#1 = #20#5; |FINSI;
||------------------------------------------------;
          |SI sust = "D"; |Y stock = "S";
               #1#6 = 0; #1#7 = 0; #1#8 = 0;
               #1#104 = 0;
               |PARA i = 10; |SI i [ 17; |HACIENDO i = i + 1;
                    #1i = 0;
               |SIGUE;
               |PARA i = 32; |SI i [ 101; |HACIENDO i = i + 1;
                    #1i = 0;
               |SIGUE;
               #1#193 = 0;
               #1#182 = 0;
               #1#183 = 0;
               #1#184 = 0;
               #1#185 = 0;
          |FINSI;
          |SI barras = "N";
               ||Valor por defecto.
          |SINO;
               #1#128 = #1#0;
          |FINSI;
          |SI AltaArt = "S";
               enSwAltaArt = 1; || Para la copia de empresas
               |GRABA 000#1b;
               |GRABA 000#1a;
          |FINSI;
          |LIBERA #1;
     |FINSI;
     |CIERRA #1;
|FPRC;

||========================= CAMBIO CODIGO EN PEDIDOS ======================

|PROCESO linpedi;
     #4#2 = #20#3;
     |SI CambDesc = "S"; #4#4 = #20#5; |FINSI;
     |GRABA 020#4a;
     |LIBERA #4;
|FPRC;

|DEFBUCLE pedidos;
#4#3;
;
#20#2 , "     " ,       0 , "      ";
#20#2 , "zzzzz" ,  999999 , "zzzzzz";
be;
NULL , linpedi;
|FIN;

||========================= CAMBIO CODIGO EN HISTORICO ====================

|PROCESO linhisto;
     |BORRA 020#6a;
     #6#0 = #20#3;
     |GRABA 000#6n;
     |SI FSalida ! 0;
          enErr = FSalida;
          eaFic = "agifa065";
          eaOrg = #20#2;
          eaDes = #20#3;
          |HAZ Print;
     |FINSI;
     |LIBERA #6;
|FPRC;

|DEFBUCLE historic;
#6#1;
;
#20#2 , "00.00.0000" , "  " ,       0 ,     0 , "     ";
#20#2 , "31.12.9999" , "zz" ,  999999 , 99999 , "zzzzz";
be;
NULL , linhisto;
|FIN;

||========================= CAMBIO CODIGO EN PEDIDOS COMPRAS ==============

|PROCESO linpedcom;
     #7#2 = #20#3;
     |SI CambDesc = "S"; #7#4 = #20#5; |FINSI;
     |GRABA 020#7a;
     |LIBERA #7;
|FPRC;

|DEFBUCLE pedcom;
#7#3;
;
#20#2, "     ", 000001, "      ";
#20#2, "zzzzz", 999999, "zzzzzz";
be;
NULL , linpedcom;
|FIN;

||========================= CAMBIO CODIGO EN ESCANDALLOS ==================

|PROCESO cabesc;
     |BORRA 020#9a;      ||Borro el escandallo
     #9#0 = #20#3;
     |SI CambDesc = "S"; #9#1 = #20#5; |FINSI;
     |GRABA 000#9n;
     |SI FSalida ! 0;
          enErr = FSalida;
          eaFic = "agifa048";
          eaOrg = #20#2;
          eaDes = #20#3;
          |HAZ Print;
     |FINSI;
     |LIBERA #9;
|FPRC;

|PROCESO linesc;
     |BORRA 020#10a;
     #10#0 = #20#3;
     |GRABA 000#10n;
     |SI FSalida ! 0;
          enErr = FSalida;
          eaFic = "agifa049";
          eaOrg = #20#2;
          eaDes = #20#3;
          |HAZ Print;
     |FINSI;
     |LIBERA #10;
|FPRC;

|DEFBUCLE escan;
     #9#1;
     ;
     #20#2;
     #20#2;
     be;
     NULL , NULL, linesc, cabesc;
|FIN;

|PROCESO lineaescan;
     #10#2 = #20#3;
     |SI CambDesc = "S"; #10#3 = #20#5; |FINSI;
     |GRABA 020#10a;
     |LIBERA #10;
|FPRC;

|DEFBUCLE linescan;
#10#2;
;
#20#2 , "                    ";
#20#2 , "zzzzzzzzzzzzzzzzzzzz";
be;
NULL , lineaescan;
|FIN;

||======================== CAMBIO DE PROMOCIONES ================

|PROCESO promo1;
     |BORRA 020#15a;
     #15#0 = #20#3;
     |GRABA 000#15n;
     |SI FSalida ! 0;
          enErr = FSalida;
          eaFic = "agifa290";
          eaOrg = #20#2;
          eaDes = #20#3;
          |HAZ Print;
     |FINSI;
     |LIBERA #15;
|FPRC;

|DEFBUCLE promocion;
#15#1;
;
#20#2 , "  ";
#20#2 , "zz";
be;
NULL , promo1;
|FIN;

|PROCESO agifa219;
     |SI sust = "S";
          |BORRA 020#219a;
     |FINSI;
     #219#0 = #20#3;
     |SI CambDesc = "S"; #219#1 = #20#5; |FINSI;
     |GRABA 000#219n;
     |SI FSalida ! 0;
          enErr = FSalida;
          eaFic = "agifa219";
          eaOrg = #20#2;
          eaDes = #20#3;
          |HAZ Print;
     |FINSI;
     |LIBERA #219;
|FPRC;

|PROCESO agifa220;
     |SI sust = "S";
          |BORRA 020#220a;
     |FINSI;
     #220#0 = #20#3;
     |GRABA 000#220n;
     |SI FSalida ! 0;
          enErr = FSalida;
          eaFic = "agifa220";
          eaOrg = #20#2;
          eaDes = #20#3;
          |HAZ Print;
     |FINSI;
     |LIBERA #220;
|FPRC;

|DEFBUCLE agifa220;
     #220#1;
     ;
     #20#2, 001;
     #20#2, 999;
     be;
     NULL, agifa220;
|FIN;

|DEFBUCLE agifa219;
     #219#1;
     ;
     #20#2;
     #20#2;
     be;
     NULL, agifa219;
|FIN;
||========================= CAMBIO CODIGO EN EQUIVALENCIAS ==================

|PROCESO cabequ;
     |BORRA 020#16a;      ||Borro el equivalencis
     #16#0 = #20#3;
     |SI CambDesc = "S"; #16#1 = #20#5; |FINSI;
     |GRABA 000#16n;
     |SI FSalida ! 0;
          enErr = FSalida;
          eaFic = "agifa292";
          eaOrg = #20#2;
          eaDes = #20#3;
          |HAZ Print;
     |FINSI;
     |LIBERA #16;
|FPRC;

|DEFBUCLE equivalen;
#16#1;
;
#20#2;
#20#2;
be;
NULL , cabequ;
|FIN;

|PROCESO linequ1;
     |BORRA 020#17a;
     #17#0 = #20#3;
     |GRABA 000#17n;
     |SI FSalida ! 0;
          enErr = FSalida;
          eaFic = "agifa293";
          eaOrg = #20#2;
          eaDes = #20#3;
          |HAZ Print;
     |FINSI;
     |LIBERA #17;
|FPRC;

|DEFBUCLE equivalen1;
#17#1;
;
#20#2 , 00;
#20#2 , 99;
be;
NULL , linequ1;
|FIN;


|PROCESO linequ2;
     #17#2 = #20#3;
     |SI CambDesc = "S"; #17#3 = #20#5; |FINSI;
     |GRABA 020#17a;
     |LIBERA #17;
|FPRC;

|DEFBUCLE equivalen2;
#17#2;
;
#20#2 , "                    ";
#20#2 , "zzzzzzzzzzzzzzzzzzzz";
be;
NULL , linequ2;
|FIN;

|PROCESO dsm00237;
     #dsm00237#2 = #20#3;
     |GRABA 020#dsm00237.a;
|FPRC;

|DEFBUCLE dsm00237;
     #dsm00237#3;
     ;
     #20#2, 000001, 0001;
     #20#2, 999999, 9999;
     be;
     NULL, dsm00237;
|FIN;

|PROCESO agitp001;
     |BORRA 020#agitp001.a;
     #agitp001#1 = #20#3;
     |GRABA 000#agitp001.n;
     |SI FSalida ! 0;
          enErr = FSalida;
          eaFic = "agitp001";
          eaOrg = #20#2;
          eaDes = #20#3;
          |HAZ Print;
     |FINSI;
|FPRC;

|DEFBUCLE agitp001;
     #agitp001#2;
     ;
     #20#2, "      ";
     #20#2, "zzzzzz";
     be;
     NULL, agitp001;
|FIN;

|PROCESO agifa561;
     |BORRA 020#561a;
     #561#0 = #20#3;
     |GRABA 000#561n;
     |SI FSalida ! 0;
          enErr = FSalida;
          eaFic = "agifa561";
          eaOrg = #20#2;
          eaDes = #20#3;
          |HAZ Print;
     |FINSI;
|FPRC;

|DEFBUCLE agifa561;
     #561#1;
     ;
     #20#2, "    ";
     #20#2, "zzzz";
     be;
     NULL, agifa561;
|FIN;

|| ****************************************************************************************************
|PROCESO ma000001;
   #ma000001@#19 = #20#3;
   |GRABA 020#ma000001@.a;
|FPRC;

|DEFBUCLE ma000001;
#ma000001@#1001;
19;
000001,#20#2;
999999,#20#2;
;
NULL,ma000001;
|FIN;

|PROCESO ma000017;
     |BORRA 020#ma000017@.a;
     #ma000017@#0 = #20#3;
     |GRABA 000#ma000017@.n;
     |SI FSalida ! 0;
          enErr = FSalida;
          eaFic = "ma000017";
          eaOrg = #20#2;
          eaDes = #20#3;
          |HAZ Print;
     |FINSI;
|FPRC;

|DEFBUCLE ma000017;
#ma000017@#1001;
;
#20#2;
#20#2;
;
NULL,ma000017;
|FIN;

|PROCESO ma000018;
     #ma000018@#19 = #20#3;
     |GRABA 020#ma000018@.a;
|FPRC;

|DEFBUCLE ma000018;
#ma000018@#1001;
19;
"      ",#20#2;
"zzzzzz",#20#2;
;
NULL,ma000018;
|FIN;

|PROCESO ma001001;
     #ma001001@#2 = #20#3;
     |SI CambDesc = "S"; #ma001001@#3 = #20#5; |FINSI;
     |GRABA 020#ma001001@.a;
|FPRC;

|DEFBUCLE ma001001;
#ma001001@#1002;
2;
000001,001,#20#2;
999999,999,#20#2;
;
NULL,ma001001;
|FIN;

|PROCESO ma001008;
     #ma001008@#3 = #20#3;
     |GRABA 020#ma001008@.a;
|FPRC;

|DEFBUCLE ma001008;
#ma001008@#1002;
3;
000001,0001,#20#2;
999999,9999,#20#2;
;
NULL,ma001008;
|FIN;

|PROCESO ma001009;
     #ma001009@#3 = #20#3;
     |SI CambDesc = "S"; #ma001009@#9 = #20#5; |FINSI;
     |GRABA 020#ma001009@.a;
|FPRC;

|DEFBUCLE ma001009;
#ma001009@#1002;
3;
"      ",0001,#20#2;
"zzzzzz",9999,#20#2;
;
NULL,ma001009;
|FIN;

|PROCESO ma001010;
     #ma001010@#4 = #20#3;
     |SI CambDesc = "S"; #ma001010@#5 = #20#5; |FINSI;
     |GRABA 020#ma001010@.a;
|FPRC;

|DEFBUCLE ma001010;
#ma001010@#1003;
4;
"                    "," ",001,#20#2;
"zzzzzzzzzzzzzzzzzzzz","z",999,#20#2;
;
NULL,ma001010;
|FIN;

|PROCESO ma100032;
     |LEE 000#ma100032@.p;
     |SI FSalida = 0;
          #ma100032@#1 = #20#3;
          #ma100032@#2 = #20#3;
          #ma100032@#3 = #20#3;
          #ma100032@#4 = #20#3;
          #ma100032@#5 = #20#3;
          #ma100032@#6 = #20#3;
          #ma100032@#7 = #20#3;
          #ma100032@#8 = #20#3;
          #ma100032@#9 = #20#3;
          #ma100032@#10 = #20#3;
          #ma100032@#18 = #20#3;
          #ma100032@#19 = #20#3;
          |GRABA 020#ma100032@.a;
     |FINSI;
|FPRC;

|PROCESO ma100033;
     |LEE 000#ma100033@.p;
     |SI FSalida = 0;
          #ma100033@#11 = #20#3;
          #ma100033@#12 = #20#3;
          #ma100033@#13 = #20#3;
          #ma100033@#14 = #20#3;
          #ma100033@#15 = #20#3;
          |GRABA 020#ma100033@.a;
     |FINSI;
|FPRC;

|PROCESO ma100107;
     #ma100107@#3 = #20#3;
     |SI CambDesc = "S"; #ma100107@#9 = #20#5; |FINSI;
     |GRABA 020#ma100107@.a;
|FPRC;

|DEFBUCLE ma100107;
#ma100107@#1002;
3;
"      ",0001,#20#2;
"zzzzzz",9999,#20#2;
;
NULL,ma100107;
|FIN;

|PROCESO ma100119;
     #ma100119@#2 = #20#3;
     |SI CambDesc = "S"; #ma100119@#3 = #20#5; |FINSI;
     |GRABA 020#ma100119@.a;
|FPRC;

|DEFBUCLE ma100119;
#ma100119@#1002;
2;
000001,001,#20#2;
999999,999,#20#2;
;
NULL,ma100119;
|FIN;

|PROCESO ma100319;
     #ma100319@#19 = #20#3;
     |GRABA 020#ma100319@.a;
|FPRC;

|DEFBUCLE ma100319;
#ma100319@#1001;
2;
000001,#20#2;
999999,#20#2;
;
NULL,ma100319;
|FIN;

|PROCESO maf00001;
     #maf00001@#19 = #20#3;
     |GRABA 020#maf00001@.a;
|FPRC;

|DEFBUCLE maf00001;
#maf00001@#1001;
2;
000001,#20#2;
999999,#20#2;
;
NULL,maf00001;
|FIN;

|PROCESO maf01001;
     #maf01001@#2 = #20#3;
     |SI CambDesc = "S"; #maf01001@#3 = #20#5; |FINSI;
     |GRABA 020#maf01001@.a;
|FPRC;

|DEFBUCLE maf01001;
#maf01001@#1002;
2;
000001,001,#20#2;
999999,999,#20#2;
;
NULL,maf01001;
|FIN;

|PROCESO diam0002;
     #Ref00577@#4 = #20#3;
     |SI CambDesc = "S"; #Ref00577@#5 = #20#5; |FINSI;
     |GRABA 020#Ref00577@.a;
|FPRC;

|DEFBUCLE diam0002;
#Ref00577@#1004;
4;
"      ","01.01.0000","        ",001,#20#2;
"zzzzzz","31.12.9999","zzzzzzzz",999,#20#2;
;
NULL,diam0002;
|FIN;

|PROCESO diam0004;
     |LEE 000#Ref00577@.p;
     |SI FSalida = 0;
          #Ref00577@#1 = #20#3;
          #Ref00577@#2 = #20#3;
          |GRABA 020#Ref00577@.a;
     |FINSI;
|FPRC;

|PROCESO CambiaDsMan;
   |DBASS aAlfa; |QBF aAlfa;
   aDef = aAlfa + "dsman9/def/";
   aFic = aAlfa + "dsman9/fich/84/";

   aAlfa = aDef + "ma000001.mas";
   |CARGA_DEF aAlfa, ma000001@;
   |SI FSalida = 0;
      |PATH_DAT #1000 aFic; |ABRE #ma000001@;
      |BUCLE ma000001;
      |CIERRA #ma000001@; |DESCARGA_DEF #ma000001@;
   |FINSI;

   aAlfa = aDef + "ma000017.mas";
   |CARGA_DEF aAlfa, ma000017@;
   |SI FSalida = 0;
      |PATH_DAT #1001 aFic; |ABRE #ma000017@;
      |BUCLE ma000017;
      |CIERRA #ma000017@; |DESCARGA_DEF #ma000017@;
   |FINSI;

   aAlfa = aDef + "ma000018.mas";
   |CARGA_DEF aAlfa, ma000018@;
   |SI FSalida = 0;
      |PATH_DAT #1002 aFic; |ABRE #ma000018@;
      |BUCLE ma000018;
      |CIERRA #ma000018@; |DESCARGA_DEF #ma000018@;
   |FINSI;

   aAlfa = aDef + "ma001001.mas";
   |CARGA_DEF aAlfa, ma001001@;
   |SI FSalida = 0;
      |PATH_DAT #1003 aFic; |ABRE #ma001001@;
      |BUCLE ma001001;
      |CIERRA #ma001001@; |DESCARGA_DEF #ma001001@;
   |FINSI;

   aAlfa = aDef + "ma001008.mas";
   |CARGA_DEF aAlfa, ma001008@;
   |SI FSalida = 0;
      |PATH_DAT #1004 aFic; |ABRE #ma001008@;
      |BUCLE ma001008;
      |CIERRA #ma001008@; |DESCARGA_DEF #ma001008@;
   |FINSI;

   aAlfa = aDef + "ma001009.mas";
   |CARGA_DEF aAlfa, ma001009@;
   |SI FSalida = 0;
      |PATH_DAT #1005 aFic; |ABRE #ma001009@;
      |BUCLE ma001009;
      |CIERRA #ma001009@; |DESCARGA_DEF #ma001009@;
   |FINSI;

   aAlfa = aDef + "ma001010.mas";
   |CARGA_DEF aAlfa, ma001010@;
   |SI FSalida = 0;
      |PATH_DAT #1006 aFic; |ABRE #ma001010@;
      |BUCLE ma001010;
      |CIERRA #ma001010@; |DESCARGA_DEF #ma001010@;
   |FINSI;

   aAlfa = aDef + "ma100032.mas";
   |CARGA_DEF aAlfa, ma100032@;
   |SI FSalida = 0;
      |PATH_DAT #1007 aFic; |ABRE #ma100032@;
      |HAZ ma100032;
      |CIERRA #ma100032@; |DESCARGA_DEF #ma100032@;
   |FINSI;

   aAlfa = aDef + "ma100033.mas";
   |CARGA_DEF aAlfa, ma100033@;
   |SI FSalida = 0;
      |PATH_DAT #1008 aFic; |ABRE #ma100033@;
      |HAZ ma100033;
      |CIERRA #ma100033@; |DESCARGA_DEF #ma100033@;
   |FINSI;

   aAlfa = aDef + "ma100107.mas";
   |CARGA_DEF aAlfa, ma100107@;
   |SI FSalida = 0;
      |PATH_DAT #1009 aFic; |ABRE #ma100107@;
      |BUCLE ma100107;
      |CIERRA #ma100107@; |DESCARGA_DEF #ma100107@;
   |FINSI;

   aAlfa = aDef + "ma100119.mas";
   |CARGA_DEF aAlfa, ma100119@;
   |SI FSalida = 0;
      |PATH_DAT #1010 aFic; |ABRE #ma100119@;
      |BUCLE ma100119;
      |CIERRA #ma100119@; |DESCARGA_DEF #ma100119@;
   |FINSI;

   aAlfa = aDef + "ma100319.mas";
   |CARGA_DEF aAlfa, ma100319@;
   |SI FSalida = 0;
      |PATH_DAT #1011 aFic; |ABRE #ma100319@;
      |BUCLE ma100319;
      |CIERRA #ma100319@; |DESCARGA_DEF #ma100319@;
   |FINSI;

   aAlfa = aDef + "maf00001.mas";
   |CARGA_DEF aAlfa, maf00001@;
   |SI FSalida = 0;
      |PATH_DAT #1012 aFic; |ABRE #maf00001@;
      |BUCLE maf00001;
      |CIERRA #maf00001@; |DESCARGA_DEF #maf00001@;
   |FINSI;

   aAlfa = aDef + "maf01001.mas";
   |CARGA_DEF aAlfa, maf01001@;
   |SI FSalida = 0;
      |PATH_DAT #1013 aFic; |ABRE #maf01001@;
      |BUCLE maf01001;
      |CIERRA #maf01001@; |DESCARGA_DEF #maf01001@;
   |FINSI;

   |DBASE aAlfa; |QBF aAlfa;
   aDef = aAlfa + "def/";
   |DFICE aFic; |QBF aFic;

   aAlfa = aDef + "diam0002.mas";
   |CARGA_DEF aAlfa, Ref00577@;
   |SI FSalida = 0;
      |PATH_DAT #1020 aFic; |ABRE #Ref00577@;
      |BUCLE diam0002;
      |CIERRA #Ref00577@; |DESCARGA_DEF #Ref00577@;
   |FINSI;

   aAlfa = aDef + "diam0004.mas";
   |CARGA_DEF aAlfa, Ref00577@;
   |SI FSalida = 0;
      |PATH_DAT #1020 aFic; |ABRE #Ref00577@;
      |HAZ diam0004;
      |CIERRA #Ref00577@; |DESCARGA_DEF #Ref00577@;
   |FINSI;

|FPRC;
|| ****************************************************************************************************

|PROCESO empieza;
     #0#2 = #20#3;
     #0#5 = #20#2;
     |PINTA #0#2; |PINTA #0#5;
     |HAZ copiaart;
     |SI sust = "S";          ||Si es sustituir, debo hacerlo en donde haya
          |BUCLE pedidos;
          |BUCLE historic;
          |BUCLE pedcom;
          |BUCLE escan;
          |BUCLE linescan;
          |BUCLE promocion;
          |BUCLE equivalen;
          |BUCLE equivalen1;
          |BUCLE equivalen2;
          |BUCLE agifa561;
          |BUCLE agitp001;
          |BUCLE dsm00237;
          |BUCLE dsl00001;
          |BUCLE dsm00006;
          |BUCLE agifa502;

          |HAZ EsDiagram;
          |SI FSalida = 0;
               |HAZ CambiaDsMan;
          |FINSI;
          |HAZ EsGuerola;
          |SI FSalida = 0;
               |HAZ CambiaOtros;
          |FINSI;
          |HAZ EsAlbero;
          |SI FSalida = 0;
               |HAZ CambiaAlbero;
          |FINSI;
          |HAZ EsConstru;
          |SI FSalida = 0;
               |HAZ CambiaConstru;
          |FINSI;
     |FINSI;
     |BUCLE agifa219;
     |BUCLE agifa220;
|FPRC;

|DEFBUCLE primero;
#20#1;
6;
tabla ,     0, tipo;
tabla , 99999, tipo;
;
NULL , empieza;
|FIN;

|PROCESO bucleini;
     |PINPA #0#0;
     |BUCLE primero;
|FPRC;

|PROGRAMA;
     |HAZ bucleini;
     |HAZ LoNuevo;
     |HAZ Modulos;

     |HAZ EnviaMail;
|FPRO;
