|FICHEROS;
     dsm00040 #0;
     agifa019 #2;
     dsm00010 #910;
     dsm00016 #916;
     dsz00045 #45;
|FIN;

|VARIABLES;
     aArtAct   = "";
     aEleAct   = "";
     aBarAct   = "";
     alfa      = "";
     alf1      = "";
     nNume     = 0;
     aAlfa     = "";
     aDCodF1   = "";
     aDCodF2   = "";
     aDCodF3   = "";
     aDCodF4   = "";
     aHCodF1   = "";
     aHCodF2   = "";
     aHCodF3   = "";
     aHCodF4   = "";
|FIN;

|INCLUYE i_varart;

|PROCESO ControlBarra; |TIPO 0;
     aAlfa = #0#2; |QBF aAlfa;
     |SI aAlfa = ""; |ACABA; |FINSI;
     aArtAct = #0#0;
     aEleAct = #0#1;
     aBarAct = #0#2;
     |SALVA_FICHA #0;
     |SELECT #2#0;
     |LEE 000#0];
     |PARA; |SI FSalida = 0; |Y #0#2 = aBarAct; |HACIENDO;
          |SI #0#0 = aArtAct; |Y #0#1 = aEleAct;
          |SINO;
               aAlfa = "0000Codigo existente en Articulo:" + #0#0 + " " + #0#1;
               |MENAV aAlfa;
               |ERROR;
          |FINSI;
          |LEE 000#0s;
     |SIGUE;
     |SELECT #1#0;
     |REPON_FICHA #0;
|FPRC;


|PROCESO ErrChequea;
     |MENAV "     Elemento no configurado en el Fichero de Defectos.";
     |ERROR;
|FPRC;

|PROCESO Chequea;
     eAlfa = #0#0;  |SUB_EJECUTA_NP "dsz99990;V";
     aDCodF1 = " " * 20;
     aDCodF2 = " " * 20;
     aDCodF3 = " " * 20;
     aDCodF4 = " " * 20;
     |SI #910#26 = 1;
         aDCodF1 = eAlfa1;
     |FINSI;
     |SI #910#26 = 2;
         aDCodF1 = eAlfa1;
         aDCodF2 = eAlfa2;
     |FINSI;
     |SI #910#26 = 3;
         aDCodF1 = eAlfa1;
         aDCodF2 = eAlfa2;
         aDCodF3 = eAlfa3;
     |FINSI;
     |SI #910#26 = 4;
         aDCodF1 = eAlfa1;
         aDCodF2 = eAlfa2;
         aDCodF3 = eAlfa3;
         aDCodF4 = eAlfa4;
     |FINSI;

     |SI #910#44 = "T";
         eAlfa1  = #2#177;  |QBF eAlfa1;
         eAlfa1  = eAlfa1 + ((" " * 20) % 120);

         aDCodF1 = eAlfa1;     aHCodF1 = eAlfa1;
         aDCodF2 = " " * 20;   aHCodF2 = " " * 20;
         aDCodF3 = " " * 20;   aHCodF3 = " " * 20;
         aDCodF4 = " " * 20;   aHCodF4 = " " * 20;
     |FINSI;

     |ABRE #916;
     #916#0  = aDCodF1;
     #916#1  = aDCodF2;
     #916#2  = aDCodF3;
     #916#15 = aDCodF4;
     #916#3 = #0#1;
     |LEE 040#916=;
     |SI FSalida ! 0;
          |SI #910#25 = "F"; |HAZ ErrChequea; |FINSI;
          |SI #910#25 = "S"; |Y #910#27 = "S"; |HAZ ErrChequea; |FINSI;
     |FINSI;
     |CIERRA #916;
|FPRC;

|PROCESO Elemento; |TIPO 6;
     alfa = #910#23 * #910#21;
     alf1 = #0#1; |QBF alf1;
     nNume = -(#910#21 + 100)
     alfa = ( alfa + alf1 ) % nNume;
     |HAZ Chequea;
|FPRC;

|PROCESO articulo6; |TIPO 6;
     |ABRE #2;
     #2#0 = #0#0;
     |LEE 000#2=;
     |CIERRA #2;

     |SI #2#176 = "S";
          |C_M #0#1, 1, "S";
     |SINO;
          |C_M #0#1, 1, "N";
     |FINSI;
|FPRC;

|PROCESO articulo7; |TIPO 7;
/*
     |SI #910#2 ] 3;
          eAlfa = #0#0;
          |SUB_EJECUTA_NP "dsz99990"; ||Pide articulo por pantalla
          |SI eAlfa = "-2"; |O eAlfa = "-1";
               |PTEC 807;
          |SINO;

               eaArticulo = eAlfa;      ||  700000-4215

               #0#0 = eAlfa;
               |PTEC 802;
         |FINSI;
     |FINSI;
*/
|FPRC;

|PROCESO Min;
     #0#0 = "                    ";
     #0#1 = "      ";
|FPRC;

|PROCESO Max;
     #0#0 = "zzzzzzzzzzzzzzzzzzzz";
     #0#1 = "zzzzzz";
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Borradsm00040;
     aAlfa = #0#2; |QBF aAlfa;
     |SI aAlfa = "";
          |BORRA 020#0a;
     |FINSI;
|FPRC;

|DEFBUCLE Borradsm00040;
     #0#1;
     ;
     "                    ", "      ";
     "zzzzzzzzzzzzzzzzzzzz", "zzzzzz";
     be;
     NULL, Borradsm00040;
|FIN;

|PROCESO GrabaFijos;
     #0#1 = #916#3;
     #0#4 = #916#4;
     |GRABA 000#0n;
|FPRC;

|DEFBUCLE dsm00016;
     #916#1;
     ;
     aDCodF1, aDCodF2, aDCodF3, aDCodF4, "      ";
     aHCodF1, aHCodF2, aHCodF3, aHCodF4, "zzzzzz";
     ;
     NULL, GrabaFijos;
|FIN;

|PROCESO agifa019;
     |DDEFECTO #0;
     #0#0 = #2#0;
     #0#3 = #2#1;

     eAlfa = #0#0;  |SUB_EJECUTA_NP "dsz99990;V";

     |SI #910#26 = 1;
         aDCodF1 = eAlfa1;     aHCodF1 = eAlfa1;
         aDCodF2 = " " * 20;   aHCodF2 = " " * 20;
         aDCodF3 = " " * 20;   aHCodF3 = " " * 20;
         aDCodF4 = " " * 20;   aHCodF4 = " " * 20;
     |FINSI;

     |SI #910#26 = 2;
         aDCodF1 = eAlfa1;     aHCodF1 = eAlfa1;
         aDCodF2 = eAlfa2;     aHCodF2 = eAlfa2;
         aDCodF3 = " " * 20;   aHCodF3 = " " * 20;
         aDCodF4 = " " * 20;   aHCodF4 = " " * 20;
     |FINSI;

     |SI #910#26 = 3;
         aDCodF1 = eAlfa1;     aHCodF1 = eAlfa1;
         aDCodF2 = eAlfa2;     aHCodF2 = eAlfa2;
         aDCodF3 = eAlfa3;     aHCodF3 = eAlfa3;
         aDCodF4 = " " * 20;   aHCodF4 = " " * 20;
     |FINSI;

     |SI #910#26 = 4;
         aDCodF1 = eAlfa1;     aHCodF1 = eAlfa1;
         aDCodF2 = eAlfa2;     aHCodF2 = eAlfa2;
         aDCodF3 = eAlfa3;     aHCodF3 = eAlfa3;
         aDCodF4 = eAlfa4;     aHCodF4 = eAlfa4;
     |FINSI;

     |SI #910#44 = "T";
         eAlfa1  = #2#177;  |QBF eAlfa1;
         eAlfa1  = eAlfa1 + ((" " * 20) % 120);

         aDCodF1 = eAlfa1;     aHCodF1 = eAlfa1;
         aDCodF2 = " " * 20;   aHCodF2 = " " * 20;
         aDCodF3 = " " * 20;   aHCodF3 = " " * 20;
         aDCodF4 = " " * 20;   aHCodF4 = " " * 20;
     |FINSI;

     |BUCLE dsm00016;
|FPRC;

|DEFBUCLE agifa019;
     #2#1;
     ;
     #45#0;
     #45#1;
     ;
     NULL, agifa019;
|FIN;

|PROGRAMA;
     |CLS;
     |CABEZA "Conversion Articulo Elemento CB";
     |ABRE #910; |LEE 000#910p; |CIERRA #910;
     |ENTLINEAL #1#0, -1, 7, 20, 1, Min, Max;
     |CONFI "0000SCargar Fichero S/N..:";
     |SI FSalida = 0;
          |PUSHV 0501 2380;
          |PINPA #0#45;
          |PINDA #0#45;
          |ENDATOS #2#45;
          |SI FSalida = 0;
               |ABRE #0;
               |BUCLE agifa019;
               |CIERRA #0;
          |FINSI;
          |POPV;
     |FINSI;

     nNume = #910#21;
     alfa = "\" + #910#23 + "+#";

     |CAMPO_ANCHO  #0#1, 1, nNume;
     |CAMPO_MAXIMO #0#1, 1, alfa;

     |ENTLINEAL #1#0, -1, 2, 20, 1, Min, Max;

     |MENSA "0000Borrando codigos en blanco...";
     |BUCLE Borradsm00040;
|FPRO;
