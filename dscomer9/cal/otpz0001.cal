|FICHEROS;
     otpz0001 #0;
     agifa084 #1;
     agifa069 #2;
     agifa133 #3;

     pycm0011@ #900;
     visal000@ #902;
|FIN;

|VARIABLES;
     &eaEmpresa = "";
     aBase           = "";
     aMas            = "";
     aQueQuiero      = "";
     aNumCampos      = "";
     aFich           = "";
     &aTipoDA        = "";
     &eaProg         = "";

     nNumCampos      = 0;
|FIN;

|PROCESO BajaDSpreven;
     |DBASS aBase;  |QBF aMas;
     aMas = aBase + "dspreven/def/pycm0011.mas";
     |XABRE "E", aMas, 0;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |HAZ EmpresaPrevencion;

     aMas = aBase + "dspreven/def/pycm0011.mas";
     |CARGA_DEF aMas, pycm0011@;
     aFich = aBase + "dspreven/fich/" + eaEmpresa + "/";
     |PATH_DAT #900 aFich;
     |ABRE #900;

     |SELECT #3#900;
     #900#9  = #1#48;
     #900#10 = #1#0;
     |LEE 101#900=;
     |SI FSalida = 0;
         #900#9  = "";
         #900#10 = 0;
         |GRABA 020#900a;
         |LIBERA #900;
     |FINSI;

     |SELECT #4#900;
     #900#11 = #1#48;
     #900#12 = #1#0;
     |LEE 101#900=;
     |SI FSalida = 0;
         #900#11 = "";
         #900#12 = 0;
         |GRABA 020#900a;
         |LIBERA #900;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #pycm0011@;
|FPRC;

|PROCESO agifa069;
     aTipoDA = "F"; |HAZ BajaDA;

     |BORRA 020#2a;
     |LIBERA #2;
|FPRC;

|PROCESO agifa133;
     |BORRA 020#3a;
     |LIBERA #3;
|FPRC;

|DEFBUCLE agifa133;
     #3#1;
     ;
     #1#48, #1#0, 001;
     #1#48, #1#0, 999;
     be;
     NULL, agifa133;
|FIN;

|PROCESO agifa084;
     eaProg = "agifa084";
     |HAZ BorraRecVenta;

     |BUCLE agifa133;

     |HAZ BajaDSpreven;

     |BORRA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE agifa084;
     #1#1;
     3, 1, 39;
     #0#6, #0#2, #0#0, #0#4, "N";
     #0#7, #0#3, #0#1, #0#5, "N";
     be;
     NULL, agifa084, agifa069;
|FIN;

|PROCESO Tipo3;   |TIPO 3;
     |SI #0#8 ! "SI";  |ACABA;  |FINSI;

     |BUCLE agifa084;
|FPRC;
