|FICHEROS;
     qdclor10 #0;
     qdclor01 #1;
     qdclor02 #2;
     qdclor03 #3;
     qdclor08 #8;
     dsm00024 #24;
|FIN;

|VARIABLES;
     &eaPartida = "";
     &eaArticulo = "";
     &eaTipo = "V";
     &eaSerie = "";
     &enCodigo = 0;
     &enLinea = 0;
     aParti = "";
|FIN;

|PROCESO Min;
     #0#0 = eaTipo;
     #0#1 = eaSerie;
     #0#2 = enCodigo;
     #0#3 = enLinea
     #0#4 = 01;
|FPRC;

|PROCESO Max;
     #0#0 = eaTipo;
     #0#1 = eaSerie;
     #0#2 = enCodigo;
     #0#3 = enLinea
     #0#4 = 99;
|FPRC;

|PROCESO Carga;
     #0#0 = eaTipo;
     #0#1 = eaSerie;
     #0#2 = enCodigo;
     #0#3 = enLinea
     #0#4 = #3#1;
     #0#5 = #3#2;
     #0#6 = #3#3;
     #0#7 = #3#4;
     #0#8 = #3#5;
     #0#9 = #3#6;
     |GRABA 020#0n;
|FPRC;

|DEFBUCLE Carga;
     #2#1;
     ;
     eaArticulo, eaPartida;
     eaArticulo, eaPartida;
     ;
     NULL, NULL, Carga;
|FIN;

|PROCESO Borra;
     |BORRA 020#0a;
|FPRC;

|DEFBUCLE Borra;
     #0#1;
     ;
     eaTipo, eaSerie, enCodigo, enLinea, 01;
     eaTipo, eaSerie, enCodigo, enLinea, 99;
     be;
     NULL, Borra;
|FIN;

|PROCESO CopiaLineas;
     #3#0 = #2#0;
     #3#1 = #0#4;
     #3#2 = #0#5;
     #3#3 = #0#6;
     #3#4 = #0#7;
     #3#5 = #0#8;
     #3#6 = #0#9;
     |GRABA 020#3n;
|FPRC;

|DEFBUCLE CopiaLineas;
     #0#1;
     ;
     eaTipo, eaSerie, enCodigo, enLinea, 01;
     eaTipo, eaSerie, enCodigo, enLinea, 99;
     be;
     NULL, CopiaLineas;
|FIN;

|PROCESO DefeAuxVta;
     |ABRE #1;
     #1#0 = eaArticulo;
     |LEE 000#1=;
     |CIERRA #1;
     |ABRE #8;
     #8#0 = eaSerie;
     #8#1 = enCodigo;
     #8#2 = enLinea;
     |LEE 101#8=;
     |SI FSalida ! 0; |GRABA 020#8b; |FINSI;
     #8#4 = #1#10;
     #8#5 = #1#2;
     |GRABA 020#8a;
     |CIERRA #8;
|FPRC;

|PROCESO BusPartUlt;
     aParti = #2#2;
|FPRC;

|PROCESO Partida;
     #24#0 = #2#0;
     #24#1 = 1;
     #24#2 = #2#2;
     |LEE 000#24=;
     |SI FSalida ! 0; |DDEFECTO #24; |FINSI;
|FPRC;

|DEFBUCLE BusParUlt;
     #2#1;
     ;
     eaArticulo, "                              ";
     eaArticulo, "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, Partida, NULL, NULL, NULL, BusPartUlt;
     #24#4;
|FIN;

|PROCESO CopiaLinBol;
     #3#7 = eaPartida;
     |GRABA 000#3n;
|FPRC;

|PROCESO CopiaBol;
     |ABRET #2;
     #2#0 = eaArticulo;
     #2#2 = eaPartida;
     |LEE 000#2=;
     |SI FSalida ! 0;
          |BUCLELIN 1 NULL #2;

          aParti = "";
          |ABRE #24;
          |BUCLE BusParUlt;
          |CIERRA #24;

          #2#2 = aParti;
          |LEE 000#2=;
          |SI FSalida = 0;
               |BUCLELIN 2 CopiaLinBol #2;
               #2#2 = eaPartida;
               |GRABA 000#2n;
          |FINSI;
     |FINSI;
     |CIERRAT #2;
|FPRC;

|PROGRAMA;
     |SI PARAMETRO = "ALTA";
          |||SI eaTipo = "C";
               |HAZ CopiaBol;
          |||FINSI;
          |SI eaTipo = "V";
               |HAZ DefeAuxVta;
          |FINSI;
          |SI eaTipo = "VA"; eaTipo = "V"; |FINSI;
          |BUCLE Borra;
          |ABRE #0;
          |BUCLE Carga;
          |CIERRA #0;
          |ABRE #1;
          #1#0 = eaArticulo;
          |LEE 000#1=;
          |CIERRA #1;
          eaTipo = #1#2;
     |FINSI;
     |SI PARAMETRO = "BAJA";
          |BUCLE Borra;
     |FINSI;
     |SI PARAMETRO = "VER";
          |ENTLINEAL #1#0, 5, 2, 13, 1, Min, Max;
          |ABRE #2;
          |ABRE #0;
          #0#0 = eaTipo;
          #0#1 = eaSerie;
          #0#2 = enCodigo;
          #0#3 = enLinea;
          #0#4 = 1;
          |LEE 000#0];
          |SI FSalida = 0; |Y #0#0 = eaTipo; |Y #0#1 = eaSerie;
                    |Y #0#2 = enCodigo;  |Y #0#3 = enLinea;
               #2#0 = eaArticulo;
               #2#2 = eaPartida;
               |LEE 101#2=;
               |SI FSalida ! 0; |GRABA 020#2b; |FINSI;
               |BUCLELIN 1 NULL #2;
               |ABRE #3;
               |BUCLE CopiaLineas;
               |CIERRA #3;
               eaTipo = "S";
          |SINO;
               #2#0 = eaArticulo;
               #2#2 = eaPartida;
               |LEE 101#2=;
               |SI FSalida = 0;
                    |BUCLELIN 0 NULL #2;
                    |BORRA 020#2a;
               |FINSI;
               eaTipo = "N";
          |FINSI;
          |CIERRA #0;
          |CIERRA #2;
     |FINSI;
                              || CON creado para el
     |SI PARAMETRO = "CON";   || Tiquet: 778/458
                              || comentados los VER y cambiado por CON
                              || en agifa071/agifa080/agifa211/agifa213
          |ENTLINEAL #1#0, 5, 2, 13, 1, Min, Max;
     |FINSI;
|FPRO;
