|FICHEROS;
     agifa321 #321;
     agifa324 #324;

     dsw00002 #102;
     dsw00003 #103,MANTE;
     dsw00004 #104,MANTE;
     dsw00005 #105,MANTE;
     dsw00021 #121,MANTE;

     dsm00010 #910;
     dsm00011 #911;
     dsm00012 #912;
     dsm00013 #913;
     dsm00015 #915;
     dsm00016 #916;
     dsm00027 #927;
     dsm00028 #928;
     dsm00029 #929;
|FIN;

|VARIABLES;
     aAlfa   = "";
     aDescr  = "";
     aDescr1 = "";
     aDescr2 = "";
     aDescr3 = "";
     aDescr4 = "";
     aDCod1  = "";
     aDCod2  = "";
     aDCod3  = "";
     aDCod4  = "";
     aHCod1  = "";
     aHCod2  = "";
     aHCod3  = "";
     aHCod4  = "";
     aDCodF1 = "";
     aDCodF2 = "";
     aDCodF3 = "";
     aDCodF4 = "";
     aHCodF1 = "";
     aHCodF2 = "";
     aHCodF3 = "";
     aHCodF4 = "";

     nSwPasa   = 0;
     nNume     = 0;
     nForma    = 0;
     nNivel    = 0;
     nNivelB   = 0;
     nModo     = 0;
     nSwDescri = 1;
     nCampo    = 0;
     nFichero  = 0;

     &nDeci_PreBase = 0;
     &nDeci_PreDiv  = 0;

     aHC1 = ""; aDC1 = "";
     aHC2 = ""; aDC2 = "";
     aHC3 = ""; aDC3 = "";
     aHC4 = ""; aDC4 = "";
     i         = 0;
 {20}Matriz    = "";
|FIN;

|PROCESO dsw00021;
     IMatriz = Matriz1<-;
     |PARA i = 0; |SI i [ 12; |HACIENDO i = i + 1;
          |SI i ] 4; |Y i ! 9; #121i = Matriz; |FINSI;
          IMatriz = IMatriz + 1;
     |SIGUE;
     |GRABA 020#121a;
|FPRC;

|DEFBUCLE dsw00021;
     #121#1;
     ;
     aDC1, aDC2, aDC3, aDC4;
     aHC1, aHC2, aHC3, aHC4;
     be;
     NULL, dsw00021;
|FIN;

|PROCESO Masivo;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |MENAV "0000Debe de dar de alta antes el registro...";
          |ERROR; |ACABA;
     |FINSI;
     |PUSHV 0501 2380;
     |C_V #121#9, 1, "N";
     |PINPA #0#121;
     |PINTA 2031, "                               ";
     |PINDA #0#121;
     |ENDATOS #1#121;
     |SI FSalida = 0;
          IMatriz = Matriz1<-;
          |PARA i = 0; |SI i [ 12; |HACIENDO i = i + 1;
               Matriz = #121i;
               IMatriz = IMatriz + 1;
          |SIGUE;
          |BUCLE dsw00021;
     |FINSI;
     |C_V #121#9, 1, "S";
     |POPV;
     |ERROR;
|FPRC;
|PROCESO Tipo11_02; |TIPO 11;
     aHC1 = #102#0;   aDC1 = #102#0;
     aHC2 = "z" * 20; aDC2 = " " * 20;
     aHC3 = "z" * 20; aDC3 = " " * 20;
     aHC4 = "z" * 20; aDC4 = " " * 20;
     |SI FSalida = 12; |HAZ Masivo; |FINSI;
|FPRC;
|PROCESO Tipo11_03; |TIPO 11;
     aHC1 = #103#0;   aDC2 = #103#0;
     aHC2 = #103#1;   aDC2 = #103#1;
     aHC3 = "z" * 20; aDC3 = " " * 20;
     aHC4 = "z" * 20; aDC4 = " " * 20;
     |SI FSalida = 12; |HAZ Masivo; |FINSI;
|FPRC;
|PROCESO Tipo11_04; |TIPO 11;
     aHC1 = #104#0;   aDC1 = #104#0;
     aHC2 = #104#1;   aDC2 = #104#1;
     aHC3 = #104#2;   aDC3 = #104#2;
     aHC4 = "z" * 20; aDC4 = " " * 20;
     |SI FSalida = 12; |HAZ Masivo; |FINSI;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Descripcion;
     |SI #910#28 ! "S";  |ACABA;  |FINSI;

     |QBF aDescr;
     |SI aDescr ! "";   |ACABA;  |FINSI;

     aDescr1 = "";  aDescr2 = "";  aDescr3 = "";  aDescr4 = "";
     |SI #910#29 = 1;  aDescr1 = #102#1;  |FINSI;
     |SI #910#29 = 2;  aDescr1 = #103#2;  |FINSI;
     |SI #910#29 = 3;  aDescr1 = #104#3;  |FINSI;
     |SI #910#29 = 4;  aDescr1 = #105#4;  |FINSI;

     |SI #910#30 = 1;  aDescr2 = #102#1;  |FINSI;
     |SI #910#30 = 2;  aDescr2 = #103#2;  |FINSI;
     |SI #910#30 = 3;  aDescr2 = #104#3;  |FINSI;
     |SI #910#30 = 4;  aDescr2 = #105#4;  |FINSI;

     |SI #910#31 = 1;  aDescr3 = #102#1;  |FINSI;
     |SI #910#31 = 2;  aDescr3 = #103#2;  |FINSI;
     |SI #910#31 = 3;  aDescr3 = #104#3;  |FINSI;
     |SI #910#31 = 4;  aDescr3 = #105#4;  |FINSI;

     |SI #910#32 = 1;  aDescr4 = #102#1;  |FINSI;
     |SI #910#32 = 2;  aDescr4 = #103#2;  |FINSI;
     |SI #910#32 = 3;  aDescr4 = #104#3;  |FINSI;
     |SI #910#32 = 4;  aDescr4 = #105#4;  |FINSI;

     |QBF aDescr1;  |QBF aDescr2;
     |QBF aDescr3;  |QBF aDescr4;

     aDescr = aDescr1 + " " + aDescr2 + " " + aDescr3 + " " + aDescr4;  |QBF aDescr;
|FPRC;

|PROCESO Descri2;  |TIPO 0;
     |SI #910#8 = 0;
         |SI Contenido ! #102#1;  #102#2 = "";  |FINSI;
         aDescr = #102#2;  |HAZ Descripcion;
         #102#2 = aDescr;  |PINTA #102#2;
     |FINSI;
|FPRC;

|PROCESO Descri3;  |TIPO 0;
     |SI #910#12 = 0;
         |SI Contenido ! #103#2;  #103#3 = "";  |FINSI;
         aDescr = #103#3;  |HAZ Descripcion;
         #103#3 = aDescr;  |PINTA #103#3;
     |FINSI;
|FPRC;

|PROCESO Descri4;  |TIPO 0;
     |SI #910#16 = 0;
         |SI Contenido ! #104#3;  #104#4 = "";  |FINSI;
         aDescr = #104#4;  |HAZ Descripcion;
         #104#4 = aDescr;  |PINTA #104#4;
         |C_M #104#4, 1, "S";
     |FINSI;
|FPRC;

|PROCESO Descri5;  |TIPO 0;
     |SI Contenido ! #105#4;  #105#5 = "";  |FINSI;

     aDescr = #105#5;  |HAZ Descripcion;
     #105#5 = aDescr;  |PINTA #105#5;
|FPRC;

|PROCESO DatosComplementarios;
     |PUSHV 0501 2380;
     |PINPA #0#121;
     |PINDA #0#121;
     |ENDATOS #1#121;
     |SI FSalida = 0;
         |GRABA 020#121a;
     |FINSI;
     |LIBERA #121;
     |POPV;
|FPRC;

|PROCESO DatosComp2;
     |SI #910#8 ! 0;  |ACABA;  |FINSI;

     |ABRE #121;
     #121#0 = #102#0;
     #121#1 = "";
     #121#2 = "";
     #121#3 = "";
     |LEE 101#121=;
     |SI FSalida ! 0;
         |DDEFECTO #121;
         #121#0 = #102#0;
         #121#1 = "";
         #121#2 = "";
         #121#3 = "";
         #121#4 = #102#2;
         |GRABA 020#121b;
         |HAZ dsw00021;
    |FINSI;
    |HAZ DatosComplementarios;
    |CIERRA #121;
|FPRC;

|PROCESO DatosComp3;
     |SI #910#12 ! 0;  |ACABA;  |FINSI;

     |ABRE #121;
     #121#0 = #103#0;
     #121#1 = #103#1;
     #121#2 = "";
     #121#3 = "";
     |LEE 101#121=;
     |SI FSalida ! 0;
         |DDEFECTO #121;
         #121#0 = #103#0;
         #121#1 = #103#1;
         #121#2 = "";
         #121#3 = "";
         #121#4 = #103#3;
         |GRABA 020#121b;
         |HAZ dsw00021;
    |FINSI;
    |HAZ DatosComplementarios;
    |CIERRA #121;
|FPRC;

|PROCESO DatosComp4;
     |SI #910#16 ! 0;  |ACABA;  |FINSI;

     |ABRE #121;
     #121#0 = #104#0;
     #121#1 = #104#1;
     #121#2 = #104#2;
     #121#3 = "";
     |LEE 101#121=;
     |SI FSalida ! 0;
         |DDEFECTO #121;
         #121#0 = #104#0;
         #121#1 = #104#1;
         #121#2 = #104#2;
         #121#3 = "";
         #121#4 = #104#4;
         |GRABA 020#121b;
         |HAZ dsw00021;
    |FINSI;
    |HAZ DatosComplementarios;
    |CIERRA #121;
|FPRC;

|PROCESO DatosComp5;
     |DDEFECTO #121;
     |ABRE #121;
     #121#0 = #105#0;
     #121#1 = #105#1;
     #121#2 = #105#2;
     #121#3 = #105#3;
     |LEE 101#121=;
     |SI FSalida ! 0;
         #121#0 = #105#0;
         #121#1 = #105#1;
         #121#2 = #105#2;
         #121#3 = #105#3;
         #121#4 = #105#5;
         |GRABA 020#121b;
         |HAZ dsw00021;
    |FINSI;
    |HAZ DatosComplementarios;
    |CIERRA #121;
|FPRC;

|PROCESO PasaUltimaDivi;
     |SI nFichero = 102;
         #102#0 = #929#1;
         #102#1 = #929#2;
         aDescr = "";  |HAZ Descripcion;
         #104#2 = aDescr;
         |GRABA 020#102n;
         |LIBERA #102;
     |FINSI;

     |SI nFichero = 103;
         #103#0 = #103#0;
         #103#1 = #929#1;
         #103#2 = #929#2;
         aDescr = "";  |HAZ Descripcion;
         #103#3 = aDescr;
         |GRABA 020#103n;
         |LIBERA #103;
     |FINSI;

     |SI nFichero = 104;
         #104#0 = #103#0;
         #104#1 = #103#1;
         #104#2 = #929#1;
         #104#3 = #929#2;
         aDescr = "";  |HAZ Descripcion;
         #104#4 = aDescr;
         |GRABA 020#104n;
         |LIBERA #104;

         |SI #910#26 = 3;
             aDCod1 = #104#0;    aHCod1 = #104#0;
             aDCod2 = #104#1;    aHCod2 = #104#1;
             aDCod3 = #104#2;    aHCod3 = #104#2;
             aDCod4 = " " * 20;  aHCod4 = "z" * 20;

             nSwPasa = 1;
             |HAZ Columna;
             nSwPasa = 0;
         |FINSI;
     |FINSI;

     |SI nFichero = 105;
          #105#0 = #104#0;
          #105#1 = #104#1;
          #105#2 = #104#2;
          #105#3 = #929#1;
          #105#4 = #929#2;
          aDescr = "";  |HAZ Descripcion;
          #105#5 = aDescr;

          #121#0 = #105#0;
          #121#1 = #105#1;
          #121#2 = #105#2;
          #121#3 = "";
          |LEE 000#121=;
          |SI FSalida ! 0;
               #121#2 = "";
               |SI FSalida ! 0;
                  #121#1 = "";
                  |LEE 000#121=;
               |FINSI;
          |FINSI;
          |SI FSalida = 0;
               #121#0 = #105#0;
               #121#1 = #105#1;
               #121#2 = #105#2;
               #121#3 = #105#3;
               |GRABA 000#121n;
          |SINO;
               #121#0 = #105#0;
               #121#1 = #105#1;
               #121#2 = #105#2;
               #121#3 = #105#3;
               |GRABA 000#121n;
          |FINSI;
          |GRABA 020#105n;
          |LIBERA #105;
     |FINSI;
|FPRC;

|DEFBUCLE dsm00029;
     #929#1;
     ;
     #928#0, "                    ";
     #928#0, "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, PasaUltimaDivi;
|FIN;

|PROCESO Carta;
     |ABRE #928;
     |LEE 040#928p;
     |SI FSalida = 0;
         |CONSULTA_CLAVE #1#928;
         |ABRE #121;
         |BUCLE dsm00029;
         |CIERRA #121;
     |SINO;
         |MENAV aAlfa;
     |FINSI;
     |CIERRA #928;
|FPRC;

|PROCESO Borra103;
     |BORRA 020#103a;
     |LIBERA #103;
|FPRC;

|DEFBUCLE dsw00003;
     #103#1;
     ;
     aDCod1, aDCod2;
     aHCod1, aHCod2;
     be;
     NULL, Borra103;
|FIN;

|PROCESO Borra104;
     |BORRA 020#104a;
     |LIBERA #104;
|FPRC;

|DEFBUCLE dsw00004;
     #104#1;
     ;
     aDCod1, aDCod2, aDCod3;
     aHCod1, aHCod2, aHCod3;
     be;
     NULL, Borra104;
|FIN;

|PROCESO Borra105;
     |BORRA 020#105a;
     |LIBERA #105;
|FPRC;

|DEFBUCLE dsw00005;
     #105#1;
     ;
     aDCod1, aDCod2, aDCod3, aDCod4;
     aHCod1, aHCod2, aHCod3, aHCod4;
     be;
     NULL, Borra105;
|FIN;

|PROCESO Baja;
     |SI nNivelB = 1;
         aDCod1 = #102#0;    aHCod1 = #102#0;
         aDCod2 = " " * 20;  aHCod2 = "z" * 20;
         aDCod3 = " " * 20;  aHCod3 = "z" * 20;
         aDCod4 = " " * 20;  aHCod4 = "z" * 20;

         |BUCLE dsw00003;
         |BUCLE dsw00004;
         |BUCLE dsw00005;
     |FINSI;

     |SI nNivelB = 2;
         aDCod1 = #103#0;    aHCod1 = #103#0;
         aDCod2 = #103#1;    aHCod2 = #103#1;
         aDCod3 = " " * 20;  aHCod3 = "z" * 20;
         aDCod4 = " " * 20;  aHCod4 = "z" * 20;

         |BUCLE dsw00004;
         |BUCLE dsw00005;
     |FINSI;

     |SI nNivelB = 3;
         aDCod1 = #104#0;    aHCod1 = #104#0;
         aDCod2 = #104#1;    aHCod2 = #104#1;
         aDCod3 = #104#2;    aHCod3 = #104#2;
         aDCod4 = " " * 20;  aHCod4 = "z" * 20;

         |BUCLE dsw00005;
     |FINSI;
|FPRC;


|RUTINA ClaveBaja102;
     #102#0 = "                    ";
|FRUT;

|RUTINA ClaveAlta102;
     #102#0 = "zzzzzzzzzzzzzzzzzzzz";
|FRUT;

|RUTINA ClaveBaja103;
     #103#0 = #102#0;
     #103#1 = "                    ";
|FRUT;

|RUTINA ClaveAlta103;
     #103#1 = #102#0;
     #103#1 = "zzzzzzzzzzzzzzzzzzzz";
|FRUT;

|RUTINA ClaveBaja104;
     #104#0 = #103#0;
     #104#1 = #103#1;
     #104#2 = "                    ";
|FRUT;

|RUTINA ClaveAlta104;
     #104#0 = #103#0;
     #104#1 = #103#1;
     #104#2 = "zzzzzzzzzzzzzzzzzzzz";
|FRUT;

|RUTINA ClaveBaja105;
     #105#0 = #104#0;
     #105#1 = #104#1;
     #105#2 = #104#2;
     #105#3 = "                    ";
|FRUT;

|RUTINA ClaveAlta105;
     #105#0 = #104#0;
     #105#1 = #104#1;
     #105#2 = #104#2;
     #105#3 = "zzzzzzzzzzzzzzzzzzzz";
|FRUT;

|RUTINA ClaveBaja916;
     #916#0  = aDCodF1;
     #916#1  = aDCodF2;
     #916#2  = aDCodF3;
     #916#15 = aDCodF4;
     #916#3 = "      ";
|FRUT;

|RUTINA ClaveAlta916;
     #916#0  = aHCodF1;
     #916#1  = aHCodF2;
     #916#2  = aHCodF3;
     #916#15 = aHCodF4;
     #916#3 = "zzzzzz";
|FRUT;

|PROCESO Columna;
     |SI #910#26 = 1;
         aDCodF1 = aDCod1;     aHCodF1 = aHCod1;
         aDCodF2 = " " * 20;   aHCodF2 = " " * 20;
         aDCodF3 = " " * 20;   aHCodF3 = " " * 20;
     |FINSI;

     |SI #910#26 = 2;
         aDCodF1 = aDCod1;     aHCodF1 = aHCod1;
         aDCodF2 = aDCod2;     aHCodF2 = aHCod2;
         aDCodF3 = " " * 20;   aHCodF3 = " " * 20;
     |FINSI;

     |SI #910#26 = 3;
         aDCodF1 = aDCod1;     aHCodF1 = aHCod1;
         aDCodF2 = aDCod2;     aHCodF2 = aHCod2;
         aDCodF3 = aDCod3;     aHCodF3 = aHCod3;
     |FINSI;

     |SI #910#26 = 4;
         aDCodF1 = aDCod1;     aHCodF1 = aHCod1;
         aDCodF2 = aDCod2;     aHCodF2 = aHCod2;
         aDCodF3 = aDCod3;     aHCodF3 = aHCod3;
         aDCodF4 = aDCod4;     aHCodF4 = aHCod4;
     |FINSI;

     |ABRE #915;
     #915#0 = aDCodF1;
     #915#1 = aDCodF2;
     #915#2 = aDCodF3;
     #915#5 = aDCodF4;
     |LEE 040#915=;
     |SI FSalida = 0;  |Y nSwPasa = 0;  |CIERRA #915; |ACABA;  |FINSI;

     |SI FSalida ! 0;
         |DDEFECTO #915;
         #915#0 = aDCodF1;
         #915#1 = aDCodF2;
         #915#2 = aDCodF3;
         #915#5 = aDCodF4;
         |GRABA 020#915n;
         |LIBERA #915;
     |FINSI;
     |CIERRA #915;

     |ABRE #321;
     |LEE 040#321p;
     |SI FSalida ! 0;  |DDEFECTO #321;  |FINSI;
     |CIERRA #321;

     |ABRE #324;
     #324#0 = #321#9;
     |LEE 001#324=;
     |SI FSalida ! 0;  |DDEFECTO #324;  |FINSI;

     nDeci_PreBase = #324#9;

     #324#0 = #915#3;
     |LEE 001#324=;
     |SI FSalida ! 0;  |DDEFECTO #324;  |FINSI;
     |CIERRA #324;

     nDeci_PreDiv = #324#9;

     |PUSHV 0501 2380;

     |PINPA #0#915;

     |SI #915#0 ! "                    ";
         |C_V #915#0, 1, "S";
         |ATRI S;  |PINTA 0703, #910#3;  |ATRI s;
         |PINTA 0737, #102#1;
     |FINSI;
     |SI #915#1 ! "                    ";
         |C_V #915#1, 1, "S";
         |ATRI S;  |PINTA 0803, #910#7;  |ATRI s;
         |PINTA 0837, #103#2;
     |FINSI;
     |SI #915#2 ! "                    ";
         |C_V #915#2, 1, "S";
         |ATRI S;  |PINTA 0903, #910#11;  |ATRI s;
         |PINTA 0937, #104#3;
     |FINSI;
     |SI #915#5 ! "                    ";
         |C_V #915#5, 1, "S";
         |ATRI S;  |PINTA 1003, #910#15;  |ATRI s;
         |PINTA 1037, #105#4;
     |FINSI;

     |PINDA #0#915;
     |ATRI S;  |PINTA 1103, #910#20;  |ATRI s;

     nSwDescri = 1;
     |ENTCOLUMNA #1#916, 5, 2, 6, 0, ClaveBaja916, ClaveAlta916;
     |POPV;

     |SI nNivel = 1;  #102#2 = aDescr;  |FINSI;
     |SI nNivel = 2;  #103#3 = aDescr;  |FINSI;
     |SI nNivel = 3;  #104#4 = aDescr;  |FINSI;
     |SI nNivel = 4;  #105#5 = aDescr;  |FINSI;
|FPRC;

|PROCESO Tipo66102;  |TIPO 66;
     |SI #910#26 = 1;
         aDCod1 = #102#0;    aHCod1 = #102#0;
         aDCod2 = " " * 20;  aHCod2 = "z" * 20;
         aDCod3 = " " * 20;  aHCod3 = "z" * 20;
         aDCod4 = " " * 20;  aHCod4 = "z" * 20;

         nSwPasa = 1;
         |HAZ Columna;
         nSwPasa = 0;
         |ACABA;
     |FINSI;

     |SI #910#8 = 0;  |Y #910#46 = "S";
         |ABRE #927;
         #927#0 = #102#0;
         |LEE 040#927=;
         |CONSULTA_CLAVE #1#927;
         |CIERRA #927;
         #102#0 = #927#0;  |PINTA #102#0;
         |ERROR;
         |PTEC 802;
     |FINSI;
|FPRC;

|PROCESO Tipo66103;  |TIPO 66;
     |SI #910#26 = 2;
         aDCod1 = #103#0;    aHCod1 = #103#0;
         aDCod2 = #103#1;    aHCod2 = #103#1;
         aDCod3 = " " * 20;  aHCod3 = "z" * 20;
         aDCod4 = " " * 20;  aHCod4 = "z" * 20;
         nSwPasa = 1;
         |HAZ Columna;
         nSwPasa = 0;
         |ACABA;
     |FINSI;

     |SI #910#12 = 0;  |Y #910#46 = "S";
         |ABRE #927;
         #927#0 = #103#1;
         |LEE 040#927=;
         |CONSULTA_CLAVE #1#927;
         |CIERRA #927;

         #103#1 = #927#0;  |PINTA #103#1;
         |ERROR;
         |PTEC 802;
     |FINSI;
|FPRC;

|PROCESO Tipo66104;  |TIPO 66;
     |SI #910#26 = 3;
         aDCod1 = #104#0;    aHCod1 = #104#0;
         aDCod2 = #104#1;    aHCod2 = #104#1;
         aDCod3 = #104#2;    aHCod3 = #104#2;
         aDCod4 = " " * 20;  aHCod4 = "z" * 20;

         nSwPasa = 1;
         |HAZ Columna;
         nSwPasa = 0;
         |ACABA;
     |FINSI;

     |SI #910#16 = 0;  |Y #910#46 = "S";
         |PUSHV 0501 2380;
         |ABRE #927;
         #927#0 = #104#2;
         |LEE 040#927=;
         |CONSULTA_CLAVE #1#927;
         |CIERRA #927;
         |POPV;

         #104#2 = #927#0;  |PINTA #104#2;
         |ERROR;
         |PTEC 802;
     |FINSI;
|FPRC;

|PROCESO Tipo66105;  |TIPO 66;
     |SI #910#26 = 4;
         aDCod1 = #105#0;    aHCod1 = #105#0;
         aDCod2 = #105#1;    aHCod2 = #105#1;
         aDCod3 = #105#2;    aHCod3 = #105#2;
         aDCod4 = #105#3;    aHCod4 = #105#3;

         nSwPasa = 1;
         |HAZ Columna;
         nSwPasa = 0;
         |ACABA;
     |FINSI;

     |SI #910#16 ! 0;  |Y #910#46 = "S";
         |PUSHV 0501 2380;
         |ABRE #927;
         #927#0 = #104#2;
         |LEE 040#927=;
         |CONSULTA_CLAVE #1#927;
         |CIERRA #927;
         |POPV;

         #105#3 = #927#0;  |PINTA #105#3;
         |ERROR;
         |PTEC 802;
     |FINSI;
|FPRC;

|PROCESO Tipo2105;  |TIPO 2;
     nModo  = (FEntrada / 100) ! 0;
     |SI nModo = 3;  nNivelB = 4; |HAZ Baja;  |FINSI;

     nForma = 0 +. 1;
     |SI nForma ! 1;  |ACABA;  |FINSI;

     |ATRI R;
     |PINTA 0867, #105#4;
     |ATRI r;

     aDCod1 = #105#0;    aHCod1 = #105#0;
     aDCod2 = #105#1;    aHCod2 = #105#1;
     aDCod3 = #105#2;    aHCod3 = #105#2;
     aDCod4 = #105#3;    aHCod4 = #105#3;

     |SI #910#26 = 4;  |HAZ Columna;  |FINSI;
|FPRC;

|PROCESO Tipo2104;  |TIPO 2;
     nModo  = (FEntrada / 100) ! 0;
     |SI nModo = 3;  nNivelB = 3; |HAZ Baja;  |FINSI;

     nForma = 0 +. 1;
     |SI nForma ! 1;  |ACABA;  |FINSI;

     |ATRI R;
     |PINTA 0767, #104#3;
     |ATRI r;

     aDCod1 = #104#0;    aHCod1 = #104#0;
     aDCod2 = #104#1;    aHCod2 = #104#1;
     aDCod3 = #104#2;    aHCod3 = #104#2;
     aDCod4 = " " * 20;  aHCod4 = "z" * 20;
     aDescr = #104#4;

     |SI #910#26 = 3;  |HAZ Columna;  |FINSI;

     |PUSHV 0501 2380;
     |SI #910#16 ! 0;
         |ABRE #105;
         #105#0 = #104#0;
         #105#1 = #104#1;
         #105#2 = #104#2;
         #105#3 = " " * 20;
         |LEE 040#105];
         |SI FSalida ! 0;  |O #105#0 ! #104#0; |O #105#1 ! #104#1; |O #105#2 ! #104#2;
             aAlfa = "    No existe carta de " + #910#15;
             nFichero = 105;
             |HAZ Carta;
         |FINSI;
         |CIERRA #105;

         |PINPA #0#105;
         |ATRI R;  |PINTA 0807, #910#15;  |ATRI r;
         |ENTLINEAL #1#105, -4, 2, 15, 0, ClaveBaja105, ClaveAlta105;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO Tipo2103;  |TIPO 2;
     nModo  = (FEntrada / 100) ! 0;
     |SI nModo = 3;  nNivelB = 2; |HAZ Baja;  |FINSI;

     nForma = 0 +. 1;
     |SI nForma ! 1;  |ACABA;  |FINSI;

     |ATRI R;
     |PINTA 0667, #103#2;
     |ATRI r;

     aDCod1 = #103#0;    aHCod1 = #103#0;
     aDCod2 = #103#1;    aHCod2 = #103#1;
     aDCod3 = " " * 20;  aHCod3 = "z" * 20;
     aDCod4 = " " * 20;  aHCod4 = "z" * 20;
     aDescr = #103#3;

     |SI #910#26 = 2;  |HAZ Columna;  |FINSI;

     |PUSHV 0501 2380;
     |SI #910#12 ! 0;
         |SI #910#16 = 0;  |Y #910#47 = "S";
             |ABRE #104;
             #104#0 = #103#0;
             #104#1 = #103#1;
             #104#2 = " " * 20;
             |LEE 040#104];
             |SI FSalida ! 0;  |O #104#0 ! #103#0; |O #104#1 ! #103#1;
                 aAlfa = "    No existe carta de " + #910#11;
                 nFichero = 104;
                 |HAZ Carta;
             |FINSI;
             |CIERRA #104;
         |FINSI;

         |PINPA #0#104;
         |ATRI R;  |PINTA 0706, #910#11;  |ATRI r;
         |ENTLINEAL #1#104, -3, 2, 14, 0, ClaveBaja104, ClaveAlta104;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO Tipo2102;  |TIPO 2;
     nModo  = (FEntrada / 100) ! 0;
     |SI nModo = 3;  nNivelB = 1; |HAZ Baja;  |FINSI;

     nForma = 0 +. 1;
     |SI nForma ! 1;  |ACABA;  |FINSI;

     |ATRI R;
     |PINTA 0567, #102#1;
     |ATRI r;

     aDCod1 = #102#0;    aHCod1 = #102#0;
     aDCod2 = " " * 20;  aHCod2 = "z" * 20;
     aDCod3 = " " * 20;  aHCod3 = "z" * 20;
     aDCod4 = " " * 20;  aHCod4 = "z" * 20;
     aDescr = #102#2;

     |SI #910#26 = 1;  |HAZ Columna;  |FINSI;

     |PUSHV 0501 2380;
     |SI #910#8 ! 0;
         |SI #910#12 = 0;  |Y #910#47 = "S";
             |ABRE #103;
             #103#0 = #102#0;
             #103#1 = " " * 20;
             |LEE 040#103];
             |SI FSalida ! 0;  |O #103#0 ! #102#0;
                 aAlfa = "    No existe carta de " + #910#7;
                 nFichero = 103;
                 |HAZ Carta;
             |FINSI;
             |CIERRA #103;
         |FINSI;

         |PINPA #0#103;
         |ATRI R;  |PINTA 0605, #910#7;  |ATRI r;
         |ENTLINEAL #1#103, -2, 2, 13, 0, ClaveBaja103, ClaveAlta103;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO Tipo7102;  |TIPO 7;
     |MENSA "      ";
     |SI #910#26 = 1;
         aAlfa =  "    Pulse <F11> para consultar " + #910#20;
         |MENSA aAlfa;
     |FINSI;
     |ATRI R;
     |PINTA 0567, #102#1;
     |ATRI r;

     |SI #910#46 = "S";
         |SI #910#8 ! 0;
             |MODO_RELACION #102, 1, "dsm00027", "N", "N";
         |SINO;
             |MODO_RELACION #102, 1, "dsm00027", "S", "S";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0102;  |TIPO 0;
     |SI #910#8 ! 0;
         |ABRE #911;
         #911#0 = #102#0;
         |LEE 040#911=;
         |SI FSalida ! 0;
             |MENAV "     Codigo Inexistente.";
             |ERROR;
         |FINSI;
         |CIERRA #911;
         #102#1 = #911#1;  |PINTA #102#1;
         |C_M #102#1, 1, "N";
     |SINO;
         |C_M #102#1, 1, "S";
     |FINSI;
|FPRC;

|PROCESO Tipo7103;  |TIPO 7;
     |MENSA "      ";
     |SI #910#26 = 2;
         aAlfa =  "    Pulse <F11> para consultar " + #910#20;
         |MENSA aAlfa;
     |FINSI;

     |ATRI R;
     |PINTA 0667, #103#2;
     |ATRI r;

     |SI #910#46 = "S";
         |SI #910#12 ! 0;
             |MODO_RELACION #103, 1, "dsm00027", "N", "N";
         |SINO;
             |MODO_RELACION #103, 1, "dsm00027", "S", "S";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0103;  |TIPO 0;
     |SI #910#12 ! 0;
         |ABRE #912;
         #912#0 = #103#0;
         #912#1 = #103#1;
         |LEE 040#912=;
         |SI FSalida ! 0;
             |MENAV "     Codigo Inexistente.";
             |ERROR;
         |FINSI;
         |CIERRA #912;
         #103#2 = #912#2;  |PINTA #103#2;
         |C_M #103#2, 1, "N";
     |SINO;
         |C_M #103#2, 1, "S";
     |FINSI;
|FPRC;

|PROCESO Tipo7104;  |TIPO 7;
     |MENSA "      ";
     |SI #910#26 = 3;
         aAlfa =  "    Pulse <F11> para consultar " + #910#20;
         |MENSA aAlfa;
     |FINSI;

     |ATRI R;
     |PINTA 0767, #104#3;
     |ATRI r;

     |SI #910#46 = "S";
         |SI #910#16 ! 0;
             |MODO_RELACION #104, 1, "dsm00027", "N", "N";
         |SINO;
             |MODO_RELACION #104, 1, "dsm00027", "S", "S";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0104;  |TIPO 0;
     |SI #910#16 ! 0;
         |ABRE #913;
         #913#0 = #104#0;
         #913#1 = #104#1;
         #913#2 = #104#2;
         |LEE 040#913=;
         |SI FSalida ! 0;
             |MENAV "     Codigo Inexistente.";
             |ERROR;
         |FINSI;
         |CIERRA #913;
         #104#3 = #913#3;  |PINTA #104#3;
         |C_M #104#3, 1, "N";
     |SINO;
         |C_M #104#3, 1, "S";
     |FINSI;
|FPRC;

|PROCESO Tipo7105;  |TIPO 7;
     |MENSA "      ";
     |SI #910#26 = 4;
         aAlfa =  "    Pulse <F11> para consultar " + #910#20;
         |MENSA aAlfa;
     |FINSI;

     |ATRI R;
     |PINTA 0867, #105#4;
     |ATRI r;

     |SI #910#46 = "S";
         |MODO_RELACION #105, 1, "dsm00027", "N", "N";
         |SI #910#16 ! 0;
             |MODO_RELACION #105, 1, "dsm00027", "S", "S";
         |FINSI;
     |FINSI;
|FPRC;


|PROGRAMA;
     |ABRE #910;
     |LEE 040#910p;
     |SI FSalida ! 0;  |DDEFECTO #910;  |FINSI;
     |CIERRA #910;

     |SI #910#47 = "S";
         |ABRE #928;
         |LEE 040#928p;
         |SI FSalida ! 0;
             |MENAV "       No estan dadas de altas las Cartas ";
             |CIERRA #928;
             |ACABA;
         |FINSI;
         |CIERRA #928;
     |FINSI;

     |SI #910#44 ! "N";
         |MENAV "      Los Articulos deben ir por Niveles y no por Tablas.";
         |ACABA;
     |FINSI;

     nNume = #910#4;  aAlfa = "\" + #910#6 + "+#";
     |CAMPO_ANCHO  #102#0, 1, nNume;
     |CAMPO_ANCHO  #103#0, 1, nNume;
     |CAMPO_ANCHO  #104#0, 1, nNume;
     |CAMPO_ANCHO  #105#0, 1, nNume;
     |CAMPO_ANCHO  #915#0, 1, nNume;
     |CAMPO_ANCHO  #916#0, 1, nNume;
     |CAMPO_ANCHO  #927#0, 1, nNume;

     |CAMPO_MAXIMO #102#0, 1, aAlfa;
     |CAMPO_MAXIMO #103#0, 1, aAlfa;
     |CAMPO_MAXIMO #104#0, 1, aAlfa;
     |CAMPO_MAXIMO #105#0, 1, aAlfa;
     |CAMPO_MAXIMO #915#0, 1, aAlfa;
     |CAMPO_MAXIMO #916#0, 1, aAlfa;
     |CAMPO_MAXIMO #927#0, 1, aAlfa;

     |SI #910#8 ! 0;
         nNume = #910#8;  aAlfa = "\" + #910#10 + "+#";
         |CAMPO_ANCHO  #103#1, 1, nNume;
         |CAMPO_ANCHO  #104#1, 1, nNume;
         |CAMPO_ANCHO  #105#1, 1, nNume;
         |CAMPO_ANCHO  #915#1, 1, nNume;
         |CAMPO_ANCHO  #916#1, 1, nNume;
         |CAMPO_ANCHO  #927#0, 1, nNume;

         |CAMPO_MAXIMO #103#1, 1, aAlfa;
         |CAMPO_MAXIMO #104#1, 1, aAlfa;
         |CAMPO_MAXIMO #105#1, 1, aAlfa;
         |CAMPO_MAXIMO #915#1, 1, aAlfa;
         |CAMPO_MAXIMO #916#1, 1, aAlfa;
         |CAMPO_MAXIMO #927#0, 1, aAlfa;
     |FINSI;


     |SI #910#12 ! 0;
         nNume = #910#12;  aAlfa = "\" + #910#14 + "+#";
         |CAMPO_ANCHO  #104#2, 1, nNume;
         |CAMPO_ANCHO  #105#2, 1, nNume;
         |CAMPO_ANCHO  #915#2, 1, nNume;
         |CAMPO_ANCHO  #916#2, 1, nNume;
         |CAMPO_ANCHO  #927#0, 1, nNume;

         |CAMPO_MAXIMO #104#2, 1, aAlfa;
         |CAMPO_MAXIMO #105#2, 1, aAlfa;
         |CAMPO_MAXIMO #915#2, 1, aAlfa;
         |CAMPO_MAXIMO #916#2, 1, aAlfa;
         |CAMPO_MAXIMO #927#0, 1, aAlfa;
     |FINSI;

     |SI #910#16 ! 0;
         nNume = #910#16;  aAlfa = "\" + #910#18 + "+#";
         |CAMPO_ANCHO  #105#3,  1, nNume;
         |CAMPO_ANCHO  #927#0,  1, nNume;
         |CAMPO_ANCHO  #915#5,  1, nNume;
         |CAMPO_ANCHO  #916#15, 1, nNume;

         |CAMPO_MAXIMO #105#3,  1, aAlfa;
         |CAMPO_MAXIMO #915#5,  1, aAlfa;
         |CAMPO_MAXIMO #916#15, 1, aAlfa;
         |CAMPO_MAXIMO #927#0,  1, aAlfa;
     |FINSI;

     |C_M #102#2, 1, "N";
     |C_M #103#3, 1, "N";
     |C_M #104#4, 1, "N";
     |C_M #105#5, 1, "N";

     |C_V #102#2, 1, "N";
     |C_V #103#3, 1, "N";
     |C_V #104#4, 1, "N";
     |C_V #105#5, 1, "N";

     |SI #910#4 ! 0;
         |SI #910#8 = 0;  |Y #910#12 = 0;  |Y #910#16 = 0;
              |C_V #102#2, 1, "S";
              |C_M #102#2, 1, "S";
         |FINSI;
     |FINSI;

     |SI #910#8 ! 0;
         |SI #910#12 = 0;  |Y #910#16 = 0;
              |C_V #103#3, 1, "S";
              |C_M #103#3, 1, "S";
         |FINSI;
     |FINSI;

     |SI #910#12 ! 0;
         |SI #910#16 = 0;
              |C_V #104#4, 1, "S";
              |C_M #104#4, 1, "S";
         |FINSI;
     |FINSI;

     |SI #910#16 ! 0;
         |C_V #105#5, 1, "S";
         |C_M #105#5, 1, "S";
     |FINSI;

     |SI #910#4  = 0;  |Y #910#8  = 0;  |Y #910#12 = 0;  |Y #910#16 = 0;
         |ACABA;
     |FINSI;

     |SI #910#4  ! 0;  |Y #910#8  = 0;  |Y #910#12 = 0;  |Y #910#16 = 0;
         nNivel = 1;
     |FINSI;

     |SI #910#4  ! 0;  |Y #910#8  ! 0;  |Y #910#12 = 0;  |Y #910#16 = 0;
         nNivel = 2;
     |FINSI;

     |SI #910#4  ! 0;  |Y #910#8  ! 0;  |Y #910#12 ! 0;  |Y #910#16 = 0;
         nNivel = 3;
     |FINSI;

     |SI #910#4  ! 0;  |Y #910#8  ! 0;  |Y #910#12 ! 0;  |Y #910#16 ! 0;
         nNivel = 4;
     |FINSI;

     nNume = #910#21;  aAlfa = "\" + #910#23 + "+#";

     |CAMPO_ANCHO  #916#3, 1, nNume;
     |CAMPO_MAXIMO #916#3, 1, aAlfa;

     |SI #910#8 = 0;  |Y #910#47 = "S";
         |ABRE #102;
         #102#0 = " " * 20;
         |LEE 040#102];
         |SI FSalida ! 0;
             nFichero = 102;
             aAlfa = "    No existe carta de " + #910#3;
             |HAZ Carta;
         |FINSI;
         |CIERRA #102;
     |FINSI;

     |PINPA  #0#102;
     |ATRI R;  |PINTA 0504, #910#3;  |ATRI r;
     |ENTLINEAL #1#102, -1, 2, 12, 0, ClaveBaja102, ClaveAlta102;
|FPRO;
