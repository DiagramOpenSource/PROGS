|FICHEROS;
     coimy001 #0;
     coima003 #3;
     coimw005 #5;   ||Tmp
     agifa017 #17;
     agifa019 #19;
     agifa065 #65;
|FIN;

|VARIABLES;
     aAlfa = "";
|FIN;

|PROCESO HistoVta;
     |SI #65#2 = "AV"; |O #65#2 = "FD";
          |DDEFECTO #5;
          #5#0 = #17#0;
          #5#1 = #19#1;
          #5#2 = "V";
          #5#3 = -#65#6;
          #5#7 = #17#1;
          #5#8 = #65#11;
          #5#9 = #65#3;
          #5#10 = #65#4;
          |GRABA 020#5n;
     |FINSI;
|FPRC;

|DEFBUCLE HistoVta;
     #65#1;
     5;
     #17#0, #0#4, "  ", 000000, 00000, "     ", #17#1;
     #17#0, #0#5, "zz", 999999, 99999, "zzzzz", #17#1;
     ;
     NULL, HistoVta;
|FIN;

|PROCESO HistoPro;
     |DDEFECTO #5;
     #5#0 = #17#0;
     #5#1 = #19#1;
     #5#2 = #3#0;
     #5#3 = #3#8 - #3#7;
     #5#4 = #3#10;
     #5#5 = #3#11;
     #5#6 = #3#12;
     #5#7 = #17#1;
     #5#8 = #3#1;
     #5#9 = #3#2;
     #5#10 = #3#3;
     #5#11 = #3#4;
     #5#12 = #3#5;
     #5#13 = #3#6;
     |GRABA 020#5n;
|FPRC;

|DEFBUCLE HistoPro;
     #3#3;
     ;
     #17#0, #17#1, "N";
     #17#0, #17#1, "N";
     ;
     NULL, HistoPro;
|FIN;

|PROCESO AlmaStock;
     ||SI #17#42 ! 0;
          |DDEFECTO #19;
          #19#0 = #17#0;
          |LEE 000#19=;

          |DDEFECTO #5;
          #5#0 = #17#0;
          #5#1 = #19#1;
          #5#2 = "S";
          #5#3 = #17#5;
          #5#7 = #17#1;
          |GRABA 020#5n;

          |DDEFECTO #5;
          #5#0 = #17#0;
          #5#1 = #19#1;
          #5#2 = "P";
          #5#3 = #17#42;
          #5#7 = #17#1;
          |GRABA 020#5n;

          |BUCLE HistoPro;
          |BUCLE HistoVta;
     ||FINSI;
|FPRC;

|DEFBUCLE AlmaStock;
     #17#1;
     ;
     #0#0, #0#2;
     #0#1, #0#3;
     ;
     NULL, AlmaStock;
|FIN;

|PROCESO Tmp;
     |PRINT;
|FPRC;

|DEFBUCLE Tmp;
     #5#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     aAlfa = Usuario;
     |NOME_DAT #5 aAlfa; |DELINDEX #5;

     Impresora = "CrystalReport";
     |IMPRE -1;
     |SI FSalida = 0;
          |INFOR "coimy001";
          |SI FSalida = 0;
               |ABRE #5;
               |ABRE #19;
               |BUCLE AlmaStock;
               |CIERRA #19;
               |CIERRA #5;
               |BUCLE Tmp;
               |PIEINF;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;

     |DELINDEX #5;
|FPRC;
