|FICHEROS;
     solz0004 #0;
     solm0001 #1;
     solm0005 #5;
     solm0006 #6;
     solm0007 #7;
     agifa024 #24;
|FIN;

|VARIABLES;
     aAlfa = "";
     fFecha = @;
     aTab = "";
     aHora = "";
     aFic = "";
     nHandle = 0;
     aDato = "";
|FIN;

|PROCESO Tipo7; |TIPO 7;
     |SI #0#0 = 0;
          fFecha = ~;
          aAlfa = fFecha % 402;
          #0#0 = aAlfa; |PINTA #0#0;
          aAlfa = fFecha % -104;
          #0#1 = aAlfa; |PINTA #0#1;
     |FINSI;
|FPRC;

|PROCESO Auxiliar;
     |DDEFECTO #1;
     #1#0 = #5#0;
     |LEE 000#1=;

     |DDEFECTO #24;
     #24#0 = #5#5;
     |LEE 000#24=;

     aDato = #5#0 + aTab;
     aDato = aDato + #5#1 + aTab;
     aDato = aDato + #5#4 + aTab;
     aDato = aDato + #5#3 + aTab;
     aDato = aDato + #5#2 + aTab;
     aDato = aDato + #1#1 + aTab;
     aDato = aDato + #5#5 + aTab;
     aDato = aDato + #24#1;

     |XGRABA nHandle, aDato;

     #5#17 = "S";
     |GRABA 020#5a;
|FPRC;

|DEFBUCLE Auxiliar;
     #5#1;
     17;
     #7#1, 0000, 0000, #0#1, #0#0, "N";
     #7#1, 9999, 9999, #0#1, #0#0, "N";
     be;
     NULL, Auxiliar;
|FIN;

|PROCESO Huertos;
     |BUCLE Auxiliar;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     aTab = &9;

     |ABRE #6;
     #6#0 = #0#2;
     |LEE 000#6=;
     |SI FSalida = 0;
          fFecha = ~;
          |HORA aHora;
          aFic = "L" +(fFecha%102)+(fFecha%704)+(fFecha%402);
          aFic = aFic+(aHora%102)+(aHora%402)+(aHora%702);
          aAlfa = #6#2; |QBF aAlfa;
          aFic = aAlfa + aFic;
          |XABRE "CW", aFic, nHandle;
          |SI FSalida ] 0;
               |ABRE #1;
               |ABRE #24;
               |BUCLELIN 2 Huertos #6;
               |CIERRA #24;
               |CIERRA #1;
               |XCIERRA nHandle;
          |SINO;
               |MENAV "0000No puedo crear el fichero a exportar...";
          |FINSI;
     |FINSI;
     |CIERRA #6;
|FPRC;
