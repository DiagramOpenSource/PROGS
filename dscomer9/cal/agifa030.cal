|FICHEROS;
     agifa030 #0;
     agifa095 #1;
     agifa023 #2;
     agifa019 #3;
     agifa020 #20;
|FIN;

||INC-LUYE llena_c1;

|VARIABLES;
     fFecha    = @;
     aAlfa     = "";
     nEntra    = 0;
     nModo     = 0;
     nSalida   = 0;
|FIN;

|PROCESO DefFecha; |TIO 7;
     nEntra = (FEntrada / 100) ! 0;
     |SI nEntra = 1;
          fFecha = ~;
          |SI #1#6 = "01.01.0000";
               #1#6 = fFecha; |PINTA #1#6;
               aAlfa = fFecha % 0704;
               aAlfa = "31.12." + aAlfa;
               #1#7 = aAlfa; |PINTA #1#7;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO agifa019;
     |SI nModo = 1;
          |DDEFECTO #2;
          #2#0 = #1#0;
          #2#1 = #3#0;
          |LEE 101#2=;
          nSalida = FSalida;

          #2#2 = #1#4;        || Prec
          #2#32 = #1#5;       || Dto
          #2#28 = #1#6;       || D.F
          #2#29 = #1#7;       || H.F
          #2#35 = #3#1;

          |SI nSalida = 0;    |GRABA 020#2a; |FINSI;
          |SI nSalida ! 0;    |GRABA 020#2n; |FINSI;
          |LIBERA #2;

          #20#0 = #2#0;
          |LEE 000#20=;
          |SI FSalida ! 0; |GRABA 020#20n; |FINSI;

     |SINO;
          #2#0 = #1#0;
          #2#1 = #3#0;
          |LEE 101#2=;
          |SI FSalida = 0;
               |BORRA 020#2a;
          |FINSI;
          |LIBERA #2;
     |FINSI;
|FPRC;

|DEFBUCLE agifa019;
     #3#1;
     ;
     #1#2;
     #1#3;
     ;
     NULL, agifa019;
|FIN;

|PROCESO Tipo2; |TIPO 2;
     nModo = 0 +. 1;
     |ABRE #2;
     |ABRE #20;
     |BUCLE agifa019;
     |CIERRA #20;
|FPRC;
