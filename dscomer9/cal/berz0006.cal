|FICHEROS;
     berz0006 #0;
     agifa007 #7;
     agifa090 #90;
     agifa074 #74;
     agifa142 #142;
     dsm00052 #52;
|FIN;

|VARIABLES;
     &enOrden = 0;
     &eaSerie = "";
     aAlfa = "";
     aInforme = "berz0006";
|FIN;

|PROCESO dsm00052;
     |PRINT;
|FPRC;

|DEFBUCLE dsm00052;
     #52#1;
     ;
     #74#9, #74#0, #74#1, 001;
     #74#9, #74#0, #74#1, 999;
     ;
     NULL, dsm00052;
|FIN;

|PROCESO Lineas;
     |DDEFECTO #7;
     #7#26 = #90#20;
     |LEE 000#7=;

     aInforme = #7#51; |QBF aInforme;
     |INFOR aInforme;
     |SI FSalida ! 0;
          aAlfa = "0000Error informe:" + aInforme;
     |SINO;
          |BUCLE dsm00052;
          |PIEINF;
          |FININF;
     |FINSI;
|FPRC;

|PROCESO Cab;
     |SI #0#4 = "S"; |Y #90#9 ! "S"; |ERROR; |FINSI;
     |SI #0#4 = "N"; |Y #90#9 ! "N"; |ERROR; |FINSI;
|FPRC;

|PROCESO Fin;
     #90#9 = "S";
     |GRABA 020#90a;
|FPRC;

|DEFBUCLE agifa090;
     #90#2;
     ;
     #0#2, #0#6, #0#0;
     #0#3, #0#7, #0#1;
     be;
     NULL, Cab, Lineas, Fin;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;

     |IMPRE 0;
     |SI FSalida  = 0;
          |ABRE #7;
          |BUCLE agifa090;
          |CIERRA #7;
          |FINIMP;
     |FINSI;
|FPRC;

|PROGRAMA;
     |HAZ MiraLogos; || Copia Logos para el Crystal
     |SI enOrden = 0;
          |MANTE #0;
     |SINO;
          #0#6 = eaSerie;
          #0#7 = eaSerie;
          #0#0 = enOrden;
          #0#1 = enOrden;
          #0#2 = "01.01.0000";
          #0#3 = "31.12.9999";
          #0#4 = "T";
          |HAZ Tipo3;
     |FINSI;
|FPRO;
