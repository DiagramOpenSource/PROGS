|FICHEROS;
 platm032 #0;
 platm031 #1;
 platm018 #18;
|FIN;

|VARIABLES;
 nModo = 0;
 aPlata = "";
 ii = 0;
 jj = 0;
 nCampo = 0;
 nCampo1 = 0;
 nComis = 0;
 kk = 0;
 hh = 0;
|FIN;

|PROCESO inicio;
 #platm018#0 = "          ";
 #platm018#1 = 000;
 #platm018#150 = aPlata;
 #platm018#22 = "N";
|FPRC;

|PROCESO final;
 #platm018#0 = "zzzzzzzzzz";
 #platm018#1 = 999;
 #platm018#150 = aPlata;
 #platm018#22 = "N";
|FPRC;


|CALCULO MiraPendiente;|TIPO 11;
|SI FSalida = 10;
 aPlata = #1#2;
||  |CONSULTA_F_CLAVE #2#platm018,inicio,final;
|FINSI;
|FCAL;

|CALCULO MiraInst;
nModo = (FEntrada/100)!0;
|ABRE #platm018;
#platm018#0 = #platm032#2;
#platm018#1 = #platm032#3;
|LEE 010#platm018.=;
|SI FSalida ! 0;
  |MENAV "Esta Instalacion no existe";
  |ERROR;
|FINSI;
|SI #platm018#150 ! #platm031#2; ||plataforma
  |MENAV "Esta Instalacion no esta en la plataforma indicada";
  |ERROR;
|FINSI;
|SI #platm018#22 = "S";|Y nModo = 1;
  |MENAV "Esta Instalacion esta liquidada";
  |ERROR;
|FINSI;
|SI nModo = 1;
  |PARA ii = 48;|SI ii [ 63;|HACIENDO ii = ii + 1;
    jj = ii - 42;
    #0jj = #18ii;
  |SIGUE;
  |PARA ii = 80;|SI ii [ 95; |HACIENDO ii = ii + 1;
    jj = ii - 58;
    #0jj = #18ii;
  |SIGUE;
  |PARA ii = 112;|SI ii [ 127;|HACIENDO ii = ii + 1;
    jj = ii - 58;
    #0jj = #18ii;
  |SIGUE;
  |PARA ii = 4;|SI ii [ 69;|HACIENDO ii = ii + 1;
   |PINTA #0ii;
  |SIGUE;
  #platm032#4 = 0;
  |PARA ii = 22;|SI ii [ 37;|HACIENDO ii = ii + 1;
    #platm032#4 = #platm032#4 + #0ii;
  |SIGUE;
  #platm032#5 = 0;
  |PARA ii = 38;|SI ii [ 53;|HACIENDO ii = ii + 1;
     #platm032#5 = #platm032#5 + #0ii;
  |SIGUE;
  |PARA ii = 4;|SI ii [ 53;|HACIENDO ii = ii + 1;
    |PINTA #0ii;
  |SIGUE;
  #platm032#71 = #platm018#26;
  #platm032#72 = #platm018#27;
  #platm032#73 = #platm018#28;
  #platm032#74 = #platm018#29;
  |PINTA #platm032#71;
  |PINTA #platm032#72;
  |PINTA #platm032#73;
  |PINTA #platm032#74;
|FINSI;
|FCAL;

|CALCULO Liqui;
nCampo = Campo - 16;
nCampo1 = Campo + 16;
nComis = #0Campo + #0nCampo1;
|SI nComis > #0nCampo;
  |MENAV "0000 El importe es mayor que la comision";
||  |ERROR;
|FINSI;
#platm032#5 = 0;
|PARA ii = 38;|SI ii [ 53;|HACIENDO ii = ii + 1;
  #platm032#5 = #platm032#5 + #0ii;
|SIGUE;
|PINTA #0#5;
|FCAL;

|CALCULO Liqui1;
nCampo = Campo - 16;
nCampo1 = Campo - 32;
nComis = #0nCampo + #0nCampo1;
|SI nComis > #0nCampo;
  |MENAV "0000 El importe es mayor que la comision";
  |ERROR;
|FINSI;
#platm032#5 = 0;
|PARA ii = 54;|SI ii [ 69;|HACIENDO ii = ii + 1;
  #platm032#70 = #platm032#70 + #0ii;
|SIGUE;
|PINTA #0#70;
|FCAL;

|CALCULO Cuanto; |TIPO 7;
nModo = (FEntrada/100)!0;
|SI nModo = 1;
  |SI Campo ! 75;|Y Campo ! 76;
    kk = Campo - 16;  ||importe comision
    hh = Campo + 16;  ||importe ya liquidado
    #0Campo = #0kk - #0hh;
    |SI #0Campo [ 0;
      #0Campo = 0;
    |FINSI;
  |SINO;
    |SI Campo = 75;
      #0#75 = #0#71 - #0#73;
      |SI #0#75 < 0;
        #0#75 = 0;
      |FINSI;
      |PINTA #0#75;
    |SINO;
      #0#76 = #0#72 - #0#74;
      |SI #0#76 < 0;
        #0#76 = 0;
      |FINSI;
      |PINTA #0#76;
    |FINSI;
  |FINSI;
|FINSI;
|FCAL;
