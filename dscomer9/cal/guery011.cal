|FICHEROS;
     guery011 #0;
     guerm001 #1;
     guerm002 #2;
     guerw038 #38; ||Tmp
|FIN;

|VARIABLES;
     aDFecha = "";
     aHFecha = "";
     aAlfa = "";
     fFecha = @;
     aMes = "";
     nCampo = 0;
     nHay = 0;
|FIN;

|PROCESO Tmp;
     |PRINT;
|FPRC;

|DEFBUCLE Tmp;
     #38#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp;
|FIN;

|PROCESO guerm002;
     |SI #0#2 ! "T";
          |SI #0#2 ! #1#28; |ACABA; |FINSI;
     |FINSI;
     |SI #0#3 ! "T";
          |SI #0#3 ! #1#36; |ACABA; |FINSI;
     |FINSI;
     |SI #0#4 ! "T";
          |SI #0#4 ! #1#37; |ACABA; |FINSI;
     |FINSI;

     aMes = #1#1 % 402;
     nCampo = aMes;
     nCampo = nCampo + 1;

     #38#0 = #1#3;
     |LEE 101#38=;
     |SI FSalida ! 0; |GRABA 020#38b; |FINSI;
     #38nCampo = #38nCampo + #2#6;
     #38#14=#38#2+#38#3+#38#4+#38#5+#38#6+#38#7+#38#8+#38#9+#38#10+#38#11+#38#12+#38#13;
     |GRABA 020#38a;
     |LIBERA #38;

     nHay = 1;
|FPRC;

|DEFBUCLE guerm001;
     #1#7;
     1;
     #0#0, aDFecha;
     #0#1, aHFecha;
     ;
     NULL, NULL, guerm002;
|FIN;

|PROCESO DefAno; |TIPO 7;
     fFecha = ~;
     aAlfa = fFecha % -104;
     #0#5 = aAlfa;
     |PINTA #0#5;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     aAlfa = Usuario;
     |NOME_DAT #38 aAlfa;
     |DELINDEX #38;


     aDFecha = "01.01." + #0#5;
     aHFecha = "31.12." + #0#5;

     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "guery011";
          |SI FSalida ! 0;
               |MENAV "0000No existe informe 'guery011'...";
          |SINO;
               |ABRE #38;
               |BUCLE guerm001;
               |CIERRA #38;
               |SI nHay = 0;
                    |MENAV "0000Seleccion Vacia";
               |SINO;
                    |BUCLE Tmp;
                    |PIEINF;
               |FINSI;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;

     |DELINDEX #38;
|FPRC;
