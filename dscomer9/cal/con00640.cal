|FICHEROS;
     con00640 #0;
     con00639 #1,MANTE;
     con00625 #2; || partes
     con00626 #3; || lineas de partes
     con01625 #10; ||Datos iniciales OR
     con00634 #14; ||Explicacion OR
     con00682 #682; ||Explicacion OR
     con00680 #680;
|FIN;

|VARIABLES;
     &Tempo = "";
     aTmp1 = "";
     linea = 0;
     pon = "N";
     tipo = 0;
|FIN;

|PROCESO imprime;
   |PRINT;
|FPRC;

|DEFBUCLE rectemp;
     #1#1;
     ;
     1;
     99999;
     ;
     NULL , imprime;
|FIN;

|PROCESO tecla;|TIPO 11;
     |SI FSalida = 13;  ||IMPRESION <F5>
        |IMPRE 0;
        |SI FSalida = 0;
          |INFOR "con00640";
             |BUCLE rectemp;
             |PIEINF;
          |FININF;
        |FINSI;
        |FINIMP;
     |FINSI;

     |SI FSalida = 14;
          |ABRE #10;
          #10#0 = #1#8;
          #10#1 = #1#9;
          |LEE 001#10=;
          |SI FSalida = 0;
               |PUSHV 0501 2380;
               |BLANCO 0802 2079;
               |PINPA #0#10;
               |PINDA #0#10;
               |PAUSA;
               |POPV;
          |FINSI;
          |CIERRA #10;
     |FINSI;

     |SI FSalida = 15;
          |PUSHV 0501 2380;
          |BLANCO 0802 2179;
          |ENTLINEAL #1#14 , 3 , 1 , 22 , 1 , min_texto , max_texto;
          |POPV;
     |FINSI;

     |SI FSalida = 16;
          |PUSHV 0101 2380;
          |CLS;
          |ABRE #2;
          #2#0 = #1#8;
          #2#1 = #1#9;
          |LEE 020#2=;
          |SI FSalida = 0;
               |PINPA #0#2;
               |PINDA #0#2;
               |ENTLINEAL #1#3 , 3 , 4 , 22 , 0 ,  min3 , max3;
          |FINSI;
          |CIERRA #2;
          |POPV;
     |FINSI;
|FPRC;

|PROCESO min3;
     #3#0 = #2#0;
     #3#1 = #2#1;
     #3#11 = 1;
|FPRC;

|PROCESO max3;
     #3#0 = #2#0;
     #3#1 = #2#1;
     #3#11 = 9999;
|FPRC;

|PROCESO min_texto;
     #14#0 = #1#8;
     #14#1 = #1#9;
     #14#2 = 001;
|FPRC;

|PROCESO max_texto;
     #14#0 = #1#8;
     #14#1 = #1#9;
     #14#2 = 999;
|FPRC;


|PROCESO mira_li;
     pon = "N";
     |SI #3#11 ] 1; |Y #3#11 [ 999; |Y #0#5 = "S";  ||Acumula m.obra
          pon = "S";
     |FINSI;
     |SI #3#11 ] 1000; |Y #3#11 [ 1999; |Y #0#3 = "S";  ||Acumula piezas
          pon = "S";
     |FINSI;
     |SI #3#11 ] 2000; |Y #3#11 [ 2999; |Y #0#6 = "S";  ||Acumula acum.s.ext
          pon = "S";
     |FINSI;
     |SI #3#11 ] 3000; |Y #3#11 [ 3999; |Y #0#4 = "S";  ||Acumula m.obra
          pon = "S";
     |FINSI;
     |SI pon = "S";
          |DDEFECTO #1;
          linea = linea + 1;
          #1#0 = linea;
          #1#1 = #0#0;
          #1#2 = #3#22;
          #1#3 = #3#9;
          #1#4 = #3#2;
          #1#5 = #3#3;
          #1#6 = #3#4;
          #1#7 = #3#10;
          #1#8 = #3#0;
          #1#9 = #3#1;

          #1#10 = #3#5;
          #1#11 = #3#8;

          |DDEFECTO #680;
          #680#0 = #3#21;
          |LEE 000#680=;
          #1#12 = #680#0;
          #1#13 = #680#1;
/*
          |SI #1#3 = 1;
               #680#0 = #682#0;
               |LEE 000#680=;
               #1#12 = #680#0;
               #1#13 = #680#1;
          |FINSI;
*/
          |GRABA 020#1n;
          |LIBERA #1;
     |FINSI;
|FPRC;

|DEFBUCLE mirar_lineas;
     #3#1;
     ;
     #2#0 , #2#1 ,    1;
     #2#0 , #2#1 , 9999;
     ;
     NULL , mira_li;
|FIN;


|PROCESO mira_lineas;
     #682#4 = #2#0;
     #682#5 = #2#1;
     #682#11 = "";
     |LEE 000#682];
     |SI FSalida = 0;
          |SI #682#4 ! #2#0; |O #682#5 ! #2#1;
               |DDEFECTO #682;
          |FINSI;
     |FINSI;

     |BUCLE mirar_lineas;

|FPRC;

|DEFBUCLE lee_partes;
     #2#2;
     ;
     #0#0 , #0#1, "                              ";
     #0#0 , #0#2, "ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZ";
     ;
     NULL , mira_lineas;
|FIN;

|PROCESO min;
     #1#0 = 1;
     #1#1 = "          ";
     #1#2 = "01.01.1900";
     #1#3 = 0;
|FPRC;

|PROCESO max;
     #1#0 = 99999;
     #1#1 = "zzzzzzzzzz";
     #1#2 = "01.01.2200";
     #1#3 = 9;
|FPRC;

|PROGRAMA;
     |HAZ TallerDeci;
     |CLS;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENTLINEAL #2#1 , 2 , 7 , 19 , 1 , min , max;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |HAZ CreaTempo; aTmp1 = Tempo;
          |NOME_DAT #1 aTmp1; |DELINDEX #1;
          |ABRE #1;
          |ABRE #682; |SELECT #2#682;
          |ABRE #680;
          |BUCLE lee_partes;
          |CIERRA #680;
          |CIERRA #682;
          |CIERRA #1;
          |SI #0#7 = 1;
               |ENTLINEAL #2#1 , 2 , 4 , 19 , 0 , min , max;
          |SINO;
               |ENTLINEAL #3#1 , 2 , 4 , 19 , 0 , min , max;
          |FINSI;
          Tempo = aTmp1; |HAZ BoraTempo; |DELINDEX #1;
     |FINSI;
|FPRO;
