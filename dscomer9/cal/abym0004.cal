|FICHEROS;
     abym0004 #0;
     abym0005 #1;
     dsm00003 #3,MANTE;
     abyw0006 #6,MANTE;
     agifa084 #84;
|FIN;

|VARIABLES;
     aContrato = "";
     aMes = "";
     nConta = 0;
     nModo = 0;
     aSer = "";
     nInc = 0;
     nHay = 0;
     aAlfa = "";
 {-1}aUtil  = "";
     aUtil1 = "2400";
     aUtil2 = "1";
     aUtil3 = "";
     aUtil4 = "AR";
     aUtil5 = "Imprimir";
     aUtil6 = "Facturas";
|FIN;

|PROCESO ContaCont; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          aSer = #0#0;
          #0#1 = 999999;
          |LEE 000#0];
          |SI FSalida = 0;
               |LEE 000#0a;
          |SINO;
               |LEE 000#0u;
          |FINSI;
          |SI FSalida = 0; |Y #0#0 = aSer;
               nConta = #0#1+ 1;
          |SINO;
               nConta = 1;
          |FINSI;
          |DDEFECTO #0;
          #0#0 = aSer;
          #0#1 = nConta;
     |FINSI;
|FPRC;

|PROCESO MinD;
     #3#0 = #0#2;
     #3#1 = 1;
|FPRC;

|PROCESO MaxD;
     #3#0 = #0#2;
     #3#1 = 9999;
|FPRC;

|PROCESO DirEntr66; |TIPO 66;
     |ABRE #3;
     #3#0 = #0#2;
     #3#1 = #0#3;
     |LEE 000#3];
     |CONSULTA_F_CLAVE #1#3, MinD, MaxD;
     |SI FSalida = 0;
          #0#3 = #3#1;
          |PINTA #0#3;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO DirEntr0; |TIPO 0;
     |SI FSalida = 2; |ACABA; |FINSI;
     |ABRE #3;
     #3#0 = #0#2;
     #3#1 = #0#3;
     |LEE 000#3=;
     |SI FSalida ! 0;
          |MENAV "0000No existe Direccion entrega...";
          |ERROR;
     |SINO;
          |HAZ PintaDirEntr;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO MesCalcu0; |TIPO 0;
     |HAZ MesCalcu7;
|FPRC;

|PROCESO MesCalcu7; |TIPO 7;
     |SI #0#9 = "A";
          |C_M #0#10, 1, "N";
          #0#10 = 0; |PINTA #0#10;
     |SINO;
          |C_M #0#10, 1, "S";
     |FINSI;
|FPRC;

|PROCESO PintaMes; |TIPO 13;
     aMes = "          ";
     |SI #0#10 = 1; aMes = "Enero     "; |FINSI;
     |SI #0#10 = 2; aMes = "Febrero   "; |FINSI;
     |SI #0#10 = 3; aMes = "Marzo     "; |FINSI;
     |SI #0#10 = 4; aMes = "Abril     "; |FINSI;
     |SI #0#10 = 5; aMes = "Mayo      "; |FINSI;
     |SI #0#10 = 6; aMes = "Junio     "; |FINSI;
     |SI #0#10 = 7; aMes = "Julio     "; |FINSI;
     |SI #0#10 = 8; aMes = "Agosto    "; |FINSI;
     |SI #0#10 = 9; aMes = "Septiembre"; |FINSI;
     |SI #0#10 = 10;aMes = "Octubre   "; |FINSI;
     |SI #0#10 = 11;aMes = "Noviembre "; |FINSI;
     |SI #0#10 = 12;aMes = "Diciembre "; |FINSI;
     |ATRI I; |PINTA 1663, aMes; |ATRI 0;
     |HAZ PintaDirEntr;
|FPRC;

|PROCESO PintaDirEntr;
     |DDEFECTO #3;
     |ABRE #3;
     #3#0 = #0#2;
     #3#1 = #0#3;
     |LEE 000#3=;
     |CIERRA #3;

     |PINTA 1015, #3#2;
     |PINTA 1115, #3#3;
     |PINTA 1215, #3#4; |PINTA 1217, #3#5; |PINTA 1234, #3#7;
|FPRC;

|PROCESO ImpAlarmaLin;
     |PRINT;
|FPRC;

|PROCESO ImpAlarma; |TIPO 4;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "abym0004";
          |SI FSalida ! 0;
               |MENAV "0000No existe informe 'abym0004'";
          |SINO;
               |BUCLELIN 2 ImpAlarmaLin #0;
               |PIEINF;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO FinAlarma; |TIPO 3;
     |CONFI "0000NImprimir Documento";
     |SI FSalida = 0;
          |HAZ ImpAlarma;
     |FINSI;
|FPRC;

|PROCESO Tipo2Lin; |TIPO 2;
     #0#11 = #0#11 +. #1#5;
     |PINTA #0#11;
     |HAZ ImpMante;
|FPRC;

|PROCESO ImpMante; |TIPO 0;
     |SI #0#9 = "M"; nInc = 12; |FINSI;
     |SI #0#9 = "B"; nInc = 6; |FINSI;
     |SI #0#9 = "T"; nInc = 3; |FINSI;
     |SI #0#9 = "S"; nInc = 2; |FINSI;
     |SI #0#9 = "A"; nInc = 1; |FINSI;
     #0#8 = #0#11 * nInc;
     |PINTA #0#8;
|FPRC;

|PROCESO Facturas;
     aAlfa = #84#94; |QBF aAlfa;
     |SI aAlfa = aContrato;
          #6#0 = #84#48;
          #6#1 = #84#0;
          #6#2 = #84#3;
          #6#3 = #84#91;
          #6#4 = #84#1
          #6#5 = #84#73
          #6#6 = #84#29
          |GRABA 020#6n;
          nHay = 1;
     |FINSI;
|FPRC;

|DEFBUCLE Factura;
     #84#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Facturas;
|FIN;

|PROCESO Min6;
     #6#0 = "     ";
     #6#1 = 000001;
|FPRC;

|PROCESO Max6;
     #6#0 = "zzzzz";
     #6#1 = 999999;
|FPRC;

|PROCESO ConsuFac; |TIPO 11;
     |SI FSalida = 13;
          |PUSHV 0501 2380;
          |ABRE #84;
          #84#48 = #6#0;
          #84#0 = #6#1;
          |LEE 020#84=;
          |SI FSalida = 0;
               |PINPA #0#84;
               |PINDA #0#84;
               |PAUSA;
          |FINSI;
          |CIERRA #84;
          |POPV;
     |FINSI;
|FPRC;

|PROCESO Factura;
     nHay = 0;
     aAlfa = Usuario;
     |NOME_DAT #6 aAlfa; |DELINDEX #6;
     aContrato = #0#0 + "/" + (("000000" + #0#1) % -106);
     |ABRE #6;
     |BUCLE Factura;
     |CIERRA #6;
     |SI nHay = 0;
          |MENAV "0000No hay registros...";
     |SINO;
          |PUSHV 0501 2380;
          |ENTLINEAL #1#6, 1, 4, 22, 1, Min6, Max6;
          |POPV;
     |FINSI;
     |DELINDEX #6;
|FPRC;

|PROCESO Alarma20; |TIPO 20;
     |SI FSalida = "OPCION";
          FSalida = "Opciones";
          |ACABA;
     |FINSI;
     |LEE 000#0=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     |MENU aUtil;
     aUtil2 = FSalida;
     |SI aUtil2 = 1;
          |HAZ ImpAlarma;
     |FINSI;
     |SI aUtil2 = 2;
          |HAZ Factura;
     |FINSI;
|FPRC;

|PROCESO CalcuImpo; |TIPO 0;
     |SI #0#9 = "M"; nInc = 12; |FINSI;
     |SI #0#9 = "B"; nInc = 6; |FINSI;
     |SI #0#9 = "T"; nInc = 4; |FINSI;
     |SI #0#9 = "S"; nInc = 2; |FINSI;
     |SI #0#9 = "A"; nInc = 1; |FINSI;
     #1#5 = #1#6 / nInc;
     |PINTA #1#5;
|FPRC;
