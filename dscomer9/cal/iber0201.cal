|FICHEROS;
     iber0201 #0;        ||Este Def.
     iber0016 #1,MANTE;  ||Centros.
     agifa029 #2;        ||Almacenes.
     iberz201 #3,MANTE;  ||Temporal.
     dsm00233 #4;        ||Tipos Almacenes.
     iber0017 #5,MANTE;  ||Productos Por Centro (C).
     iber0018 #6,MANTE;  ||Productos Por Centro (L).
     iber0068 #7,MANTE;  ||Impresoras Secciones (C).
     iber0069 #8;        ||Impresoras Secciones (L).
     iber0202 #9,MANTE;  ||Puntos Venta.
     iber0019 #10,MANTE; ||Producto Por Centro/Punto Venta.
     iberz202 #11,MANTE; ||Usuarios.
     iberz203 #12,MANTE; ||Salas.
     iberz204 #13,MANTE; ||Impresion por Secciones.
     iber0070 #14;       ||Impresion por Secciones.
     iber0203 #15;||Cajas.
     agifa505 #16;       ||Cajas.
     iber0204 #17,MANTE; ||Terminales.
     iber0041 #18;       ||Terminales.
     iber0001 #19,MANTE; ||Proveedores H (C).
     iber0002 #20;       ||Proveedores H (L),
     iber0063 #21,MANTE; ||Proveedores V (C).
     iber0064 #22;       ||Proveedores V (L),
     iber0205 #23;       ||Este Fichero.
     iber0020 #24,MANTE; ||
     iber0043 #42,MANTE;
     iber0091 #91;       ||
|FIN;

|VARIABLES;
     &enAlta   = 0;
     &enCentro = 0;
     &enTipoNe = 0;
     &Tempo  = "";
     aTempo1 = "";
     nMod   = 0;
     nDes   = 0;
     nHas   = 0;
     nSal   = 0;
     menuf2 = 0;
  {-1}menuF = "";
     menuF1 = "1110";
     menuF2 = "1";
     menuF3 = "9";
     menuF4  = "Datos Generales        ";
     menuF5  = "Almacenes/Secciones    ";
     menuF6  = "Productos              ";
     menuF7  = "Impresoras Seccion     ";
     menuF8  = "Puntos de Venta        ";
     menuF9  = "Cajas                  ";
     menuF10 = "Terminales             ";
     menuF11 = "Terminales conexion remota (pda)";
     menuF12 = "Proveedores Homologados";
     menuF13 = "Proveedores Varios     ";
|FIN;

|PROGRAMA;
     |CLS;
     |CABEZA "Definicion Centros";
     |ABRE #23;
     |PARA; |SI; |HACIENDO;
     |PINPA #0#0;
     |PINDA #0#0;
     |C_M #0#0 , 1 , "S";
     |ENCAMPO #0#0;
     |SI #0#0 = 1; |SAL; |FINSI;
     |ABRE #1;
     #1#0 = #0#0;
     |LEE 000#1=;
     #0#1 = #1#1;
     |PINTA #0#1;
     |CIERRA #1;
     #23#0 = #0#0;
     |LEE 101#23=;
     |SI FSalida = 0;
          #0#2 = #23#2;
          #0#3 = #23#3;
          |PINTA #0#2;
          |PINTA #0#3;
     |SINO;
          |DDEFECTO #23;
          #23#0 = #0#0;
          |GRABA 020#23b;
     |FINSI;
     |C_M #0#0 , 1 , "N";
     |ENDATOS #1#0;
     |SI FSalida = 0;
          #23#0 = #0#0;
          #23#1 = #0#1;
          #23#2 = #0#2;
          #23#3 = #0#3;
          |GRABA 020#23a;
          |HAZ MenuF;
     |FINSI;
     |LIBERA #23;
     |DDEFECTO #0;
     |SIGUE;
     |CIERRA #23;
|FPRO;

|PROCESO Min42;
     #42#0 = #0#0;
     #42#1 = 3333;
|FPRC;

|PROCESO Max42;
     #42#0 = #0#0;
     #42#1 = 3344;
|FPRC;

|PROCESO Remoto;
     |PUSHV 0501 2380;
     |ENTLINEAL #1#42, 2, 2, 19, 1, Min42, Max42;
     |POPV;
|FPRC;

|PROCESO MenuF;
     |MENUG menuF; menuF2 = FSalida;
     |PARA; |SI menuF2 > 0; |HACIENDO;
          |SI menuF2 = 1; |HAZ datgene; |FINSI;
          |SI menuF2 = 2; |HAZ almacen; |FINSI;
          |SI menuF2 = 3; |HAZ product; |FINSI;
          |SI menuF2 = 4; |HAZ seccion; |FINSI;
          |SI menuF2 = 5; |HAZ puntosv; |FINSI;
          |SI menuF2 = 6; |HAZ cajasce; |FINSI;
          |SI menuF2 = 7; |HAZ termina; |FINSI;
          |SI menuF2 = 8; |HAZ Remoto; |FINSI;
          |SI menuF2 = 9; |HAZ proveeo; |FINSI;
          |SI menuF2 = 10; |HAZ proveev; |FINSI;
          |MENUG menuF; menuF2 = FSalida;
     |SIGUE;
|FPRC;


|PROCESO datgene;
     |PUSHV 0501 2380;
     |ABRE #1;
     |DDEFECTO #1;
     |PINPA #0#1;
     #1#0 = #0#0;
     |LEE 101#1=;

     nSal = FSalida;
     enAlta = 0;
     |SI FSalida = 0; enAlta = 1; |FINSI;

     #1#26 = #0#2;
     |PINDA #0#1;
     |PTEC 802;
     |ENDATOS #1#1;
     |SI FSalida = 0;
          |SI nSal = 0; |GRABA 020#1a; |FINSI;
          |SI nSal ! 0; |GRABA 020#1n; |FINSI;
     |FINSI;
     |LIBERA #1;
     |CIERRA #1;
     |POPV;
|FPRC;

|PROCESO agifa029;
     #3#0 = #2#0;
     #3#1 = #2#1;
     #3#2 = #2#2;
     #3#3 = #2#3;
     #3#4 = #2#4;
     #3#5 = #2#5;
     #3#6 = #2#6;
     |DDEFECTO #4;
     #4#0 = #3#6;
     |LEE 000#4=;
     #3#7 = #4#1;
     |GRABA 020#3n;
|FPRC;

|DEFBUCLE agifa029;
     #2#1;
     ;
     nDes;
     nHas;
     ;
     NULL,agifa029;
|FIN;

|PROCESO iberz201;
     #2#0 = #3#0;
     |LEE 101#2=;
     nSal = FSalida;
     #2#0 = #3#0;
     #2#1 = #3#1;
     #2#2 = #3#2;
     #2#3 = #3#3;
     #2#4 = #3#4;
     #2#5 = #3#5;
     #2#6 = #3#6;
     |SI nSal = 0; |GRABA 020#2a; |FINSI;
     |SI nSal ! 0; |GRABA 020#2n; |FINSI;
     |LIBERA #2;
|FPRC;

|DEFBUCLE iberz201;
     #3#1;
     ;
     nDes;
     nHas;
     ;
     NULL,iberz201;
|FIN;

|PROCESO almacen;
     |PUSHV 0501 2380;
     |HAZ CreaTempo; aTempo1 = Tempo;
     |NOME_DAT #3 aTempo1;
     |DELINDEX #3;
     nDes = #0#0 * 100;
     nHas = #0#0 * 100;
     nHas = nHas + 99;
     |ABRE #3;
     |ABRE #4;
     |BUCLE agifa029;
     |CIERRA #3;
     |CIERRA #4;
     |ENTLINEAL #1#3 , -1 , 2 , 19 , 1 , inf , sup;
     |ABRE #2;
     |BUCLE iberz201;
     |CIERRA #2;
     |DELINDEX #3;  Tempo = aTempo1; |HAZ BoraTempo;
     |POPV;
|FPRC;

|RUTINA inf;
     #3#0 = nDes;
|FRUT;

|RUTINA sup;
     #3#0 = nHas;
|FRUT;

|PROCESO tipo2_3; |TIPO 2;
     nMod = (FEntrada / 100) ! 0;
     |SI nMod = 3;
           |ERROR;
     |FINSI;
|FPRC;

|PROCESO product;
     |PUSHV 0501 2380;
     |ABRE #5;
     |DDEFECTO #5;
     |PINPA #0#5;
     #5#0 = #0#0;
     |LEE 101#5=;
     nSal = FSalida;
     #5#1 = #0#1;
     #5#2 = #0#2;
     #5#3 = #0#3;
     |PINDA #0#5;
     |C_M #5#2 ,1 , "N";
     |SI nSal ! 0;
          |ENDATOS #1#5;
     |SINO;
          |ENDATOS #2#5;
     |FINSI;
     |SI FSalida = 0;
          |SI nSal = 0; |GRABA 020#5a; |FINSI;
          |SI nSal ! 0; |GRABA 020#5n; |FINSI;
     |FINSI;
     |LIBERA #5;
     |CIERRA #5;
     |POPV;
|FPRC;

|PROCESO seccion;
     |PUSHV 0501 2380;
     |ABRE #7;
     |DDEFECTO #7;
     |PINPA #0#7;
     #7#0 = #0#0;
     |LEE 101#7=;
     nSal = FSalida;
     #7#1 = #0#1;
     |PINDA #0#7;
     |SI nSal ! 0;
          |ENDATOS #1#7;
     |SINO;
          |ENDATOS #2#7;
     |FINSI;
     |SI FSalida = 0;
          |SI nSal = 0; |GRABA 020#7a; |FINSI;
          |SI nSal ! 0; |GRABA 020#7n; |FINSI;
     |FINSI;
     |LIBERA #7;
     |CIERRA #7;
     |POPV;
|FPRC;

|PROCESO puntosv;
     |PUSHV 0501 2380;
     |ENTLINEAL #1#9 , -2 , 2 , 22 , 1 , infp , supp;
     |POPV;
|FPRC;

|RUTINA infp;
     #9#0 = #0#0;
     #9#1 = 1;
|FRUT;

|RUTINA supp;
     #9#0 = #0#0;
     #9#1 = 99;
|FRUT;

|PROCESO tecla; |TIPO 11;
     |SI FSalida = 10;     ||Productos.
          |SI #9#1 ! 0;
               |HAZ produp;
          |FINSI;
          |ERROR;
     |FINSI;
     |SI FSalida = 11;     ||Usuarios.
          |SI #9#1 ! 0;
               |HAZ usuari;
          |FINSI;
          |ERROR;
     |FINSI;
     |SI FSalida = 12;     ||Salas.
          |SI #9#1 ! 0;
               |HAZ salasp;
          |FINSI;
          |ERROR;
     |FINSI;
     |SI FSalida = 13;     ||Impresion Por Secciones.
          |SI #9#1 ! 0;
               |HAZ imprse;
          |FINSI;
          |ERROR;
     |FINSI;
|FPRC;


|PROCESO produp;

     |PUSHV 0501 2380;
     |ABRE #10;
     |DDEFECTO #10;
     |PINPA #0#10;
     #10#0 = #0#0;
     #10#1 = #9#1;
     |LEE 101#10=;
     nSal = FSalida;
     #10#2 = #9#3;
     #10#3 = #0#1;
     #10#4 = #9#2;
     |PINDA #0#10;
     |C_M #10#0 ,1 , "N";
     |C_M #10#1 ,1 , "N";
     |C_M #10#2 ,1 , "N";
     |C_M #10#3 ,1 , "N";
     |C_M #10#4 ,1 , "N";
     |SI nSal ! 0;
          |ENDATOS #1#10;
     |SINO;
          |ENDATOS #2#10;
     |FINSI;
     |SI FSalida = 0;
          |SI nSal = 0; |GRABA 020#10a; |FINSI;
          |SI nSal ! 0; |GRABA 020#10n; |FINSI;
     |FINSI;
     |LIBERA #10;
     |CIERRA #10;
     |POPV;
|FPRC;

|PROCESO usuari;
     |PUSHV 0501 2380;
     |ABRE #11;
     |C_M #11#0 , 1 , "N";
     |ENTLINEAL #1#11 , -2 , 1 , 21 , 1 , infu , supu;
     |POPV;
|FPRC;

|RUTINA infu;
     #11#0 = #0#0;
     #11#1 = "        ";
|FRUT;

|RUTINA supu;
     #11#0 = #0#0;
     #11#1 = "zzzzzzzz";
|FRUT;
|PROCESO Tipo13;  |TIPO 13;
     |C_V #11#3, 1, "N";
     |PINTA 2360, "********";
|FPRC;

|PROCESO VerPassword;  |TIPO 7;
     |C_V #11#3, 1, "S";
|FPRC;

|PROCESO BorraPassword;  |TIPO 0;
     |C_V #11#3, 1, "N";
     |PINTA 2360, "********";
|FPRC;

|PROCESO AltaPerfil0; |TIPO 7;
     |DDEFECTO #91;
     |ABRE #91;
     #91#0 = 0;
     |LEE 000#91=;
     |SI FSalida ! 0;
          #91#1 = "NULO";
          |GRABA 000#91n;
     |FINSI;
     |CIERRA #91;
|FPRC;


|PROCESO altaus; |TIPO 0;
     nMod = (FEntrada / 100) ! 0;
     |SI nMod = 1;
          #11#2 = #0#1;
          #11#4 = #9#1;
          #11#5 = #9#2;
     |FINSI;
|FPRC;

|PROCESO salasp;
     |PUSHV 0501 2380;
     |ABRE #12;
     |ENTLINEAL #1#12 , -3 , 1 , 22 , 1 , infs , sups;
     |POPV;
|FPRC;

|RUTINA infs;
     #12#0 = #0#0;
     #12#1 = #9#1;
     #12#2 = 1;
|FRUT;

|RUTINA sups;
     #12#0 = #0#0;
     #12#1 = #9#1;
     #12#2 = 99;
|FRUT;

|PROCESO Mesa2; |TIPO 0;
     |SI #12#4 = "S";
          |C_M #12#5, 1, "S";
          |C_M #12#6, 1, "S";
     |SINO;
          |C_M #12#5, 1, "N";
          |C_M #12#6, 1, "N";
     |FINSI;
|FPRC;

|PROCESO iber0070;
     #13#0 = #14#1;
     #13#1 = #14#5;
     #13#2 = #14#3;
     #13#3 = #14#6;
     |GRABA 020#13n;
|FPRC;

|DEFBUCLE iber0070;
     #14#1;
     ;
     #0#0,"     ",#9#1;
     #0#0,"zzzzz",#9#1;
     ;
     NULL,iber0070;
|FIN;

|PROCESO iberz204;
     #14#0 = #0#0;
     #14#1 = #13#0;
     #14#2 = #9#1;
     |LEE 101#14=;
     nSal = FSalida;
     #14#3 = #13#2;
     #14#4 = #0#1;
     #14#5 = #13#1;
     #14#6 = #13#3;
     |SI nSal = 0; |GRABA 020#14a; |FINSI;
     |SI nSal ! 0; |GRABA 020#14n; |FINSI;
     |LIBERA #14;
|FPRC;

|DEFBUCLE iberz204;
     #13#1;
     ;
     "     ";
     "zzzzz";
     ;
     NULL,iberz204;
|FIN;

|PROCESO imprse;
     |PUSHV 0501 2380;
     |HAZ CreaTempo; aTempo1 = Tempo;
     |NOME_DAT #13 aTempo1;
     |DELINDEX #13;
     |ABRE #13;
     |BUCLE iber0070;
     |CIERRA #13;
     |ENTLINEAL #1#13 , -1 , 2 , 21 , 1 , infe , supe;
     |ABRE #14;
     |BUCLE iberz204;
     |CIERRA #14;
     |DELINDEX #13;  Tempo = aTempo1; |HAZ BoraTempo;
     |POPV;
|FPRC;

|RUTINA infe;
     #13#0 = "     ";
|FRUT;

|RUTINA supe;
     #13#0 = "zzzzz";
|FRUT;

|PROCESO tipo2imp; |TIPO 2;
/*                                 JOSE Thu Feb 14 17:58:39 CET 2002
     nMod = (FEntrada / 100) ! 0;
     |SI nMod = 3; |ERROR; |FINSI;
*/
|FPRC;

|PROCESO cajasce;
     |PUSHV 0501 2380;
     ||||ENTLINEAL #1#15, -2 , 2 , 22 , 1 , infc , supc;
     enCentro = #0#0;
     |SUB_EJECUTA_NP "iber0203";
     |POPV;
|FPRC;
/************************************
|RUTINA infc;
     #15#0 = #0#0;
     #15#1 = 0;
|FRUT;

|RUTINA supc;
     #15#0 = #0#0;
     #15#1 = 99;
|FRUT;

|PROCESO cajasnu; |TIPO 3;
     |PUSHV 0501 2380;
     nDes = #15#0 * 100;
     nDes = nDes + #15#1;
     |ABRE #16;
     |PINPA #0#16;
     |DDEFECTO #16;
     #16#0 = nDes;
     |LEE 101#16=;
     nSal = FSalida;
     #16#1 = #15#2;
     |C_M #16#1 , 1 , "N";
     |PINDA #0#16;
     |ENDATOS #1#16;
     |SI FSalida = 0;
          |SI nSal = 0; |GRABA 020#16a; |FINSI;
          |SI nSal ! 0; |GRABA 020#16n; |FINSI;
     |FINSI;
     |LIBERA #16;
     |CIERRA #16;
     |POPV;
|FPRC;
**************************************/

|PROCESO termina;
     |PUSHV 0501 2380;
     |ENTLINEAL #1#17, -2 , 2 , 22 , 1 , inft , supt;
     |POPV;
|FPRC;

|RUTINA inft;
     #17#0 = #0#0;
     #17#1 = 1;
|FRUT;

|RUTINA supt;
     #17#0 = #0#0;
     #17#1 = 99;
|FRUT;

|PROCESO terminu; |TIPO 3;
     |PUSHV 0501 2380;
     |ABRE #18;
     |PINPA #0#18;
     |DDEFECTO #18;
     #18#0 = #0#0;
     #18#1 = #17#1;
     |LEE 101#18=;
     nSal = FSalida;
     #18#2 = #0#1;
     |PINDA #0#18;
     |ENDATOS #1#18;
     |SI FSalida = 0;
          |SI nSal = 0; |GRABA 020#18a; |FINSI;
          |SI nSal ! 0; |GRABA 020#18n; |FINSI;
     |FINSI;
     |LIBERA #18;
     |CIERRA #18;
     |POPV;
|FPRC;

|PROCESO proveeo;
     |PUSHV 0501 2380;
     |ABRE #19;
     |DDEFECTO #19;
     |PINPA #0#19;
     #19#0 = #0#0;
     |LEE 101#19=;
     nSal = FSalida;
     #19#1 = #0#1;
     |C_M #19#1 , 1 , "N";
     |PINDA #0#19;
     |SI nSal ! 0;
          |ENDATOS #1#19;
     |SINO;
          |ENDATOS #2#19;
     |FINSI;
     |SI FSalida = 0;
          |SI nSal = 0; |GRABA 020#19a; |FINSI;
          |SI nSal ! 0; |GRABA 020#19n; |FINSI;
     |FINSI;
     |LIBERA #19;
     |CIERRA #19;
     |POPV;
|FPRC;

|PROCESO proveev;
     |PUSHV 0501 2380;
     |ABRE #21;
     |DDEFECTO #21;
     |PINPA #0#21;
     #21#0 = #0#0;
     |LEE 101#21=;
     nSal = FSalida;
     #21#1 = #0#1;
     |C_M #21#1 , 1 , "N";
     |PINDA #0#21;
     |SI nSal ! 0;
          |ENDATOS #1#21;
     |SINO;
          |ENDATOS #2#21;
     |FINSI;
     |SI FSalida = 0;
          |SI nSal = 0; |GRABA 020#21a; |FINSI;
          |SI nSal ! 0; |GRABA 020#21n; |FINSI;
     |FINSI;
     |LIBERA #21;
     |CIERRA #21;
     |POPV;
|FPRC;

|PROCESO consul; |TIPO 66;
     |ABRE #1;
     |LEE 000#1p;
     |CONSULTA_CLAVE #1#1;
     |SI FSalida = 0;
          #0#0 = #1#0;
          |PINTA #0#0;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #1;
|FPRC;
