|FICHEROS;
     guerz015 #0;
     gomantho #1;
     gomantl1 #2;
     goparame #9;
     gopre001 #11;
     gopre002 #12;
     gopre003 #13;
     gopartia #22;
     gopartll #23;
     gopartli #24;
|FIN;

|VARIABLES;
     &eaSer     = "";
     &enNum     = 0;

     &nEurComTrab   = 0;
     &nEurComBase   = 0;
     &cCodMonTrab   = "";
     dVacio         = "                    ";
     hVacio         = "zzzzzzzzzzzzzzzzzzzz";
     aAlfa          = "";
|FIN;

|PROCESO SacaDias1;
     #2#24 = #2#24 + 1;                            ||Dias Trabajados.
|FPRC;

|PROCESO SacaMate1;
     #2#16 = #2#16 + #22#13;                      ||Imp. Venta Trabajo.
     #2#18 = #2#18 + #22#14;                      ||Imp. Coste Trabajo.
|FPRC;

|DEFBUCLE TomaDias1;
     #24#1;
     ;
     #2#3, #2#4,   1;
     #2#3, #2#4, 999;
     ;
     NULL, SacaDias1;
|FIN;

|DEFBUCLE TomaMate1;
     #22#3;
     ; ||29;
     #1#0, #1#1, #2#3, #2#4, dVacio, dVacio; ||, "M";
     #1#0, #1#1, #2#3, #2#4, hVacio, hVacio; ||, "M";
     ;
     NULL, SacaMate1;
|FIN;

|PROCESO gomantl1;
     #2#9 = 0;
     #2#12 = 0;
     #2#13 = 0;
     #2#14 = 0;
     #2#16 = 0;
     #2#17 = 0;
     #2#18 = 0;
     #2#19 = 0;
     #2#20 = 0;
     #2#21 = 0;
     #2#22 = 0;
     #2#23 = 0;
     #2#24 = 0;

     |DDEFECTO #11;
     #11#0 = #2#3;
     #11#1 = #2#4;
     |LEE 000#11=;

     |BUCLE TomaMate1;
     |BUCLE TomaDias1;

     #2#9 = #11#5;
     #2#13 = #11#6;

     #2#20 = #2#9 - #2#16;                        ||Total Desv. Ven. Pres.
     #2#22 = #2#13 - #2#18;                       ||Total Desv. Cos. Pres.

     #2#12 = #2#9 / nEurComTrab * nEurComBase;
     #2#14 = #2#13 / nEurComTrab * nEurComBase;
     #2#17 = #2#16 / nEurComTrab * nEurComBase;
     #2#19 = #2#18 / nEurComTrab * nEurComBase;
     #2#21 = #2#20 / nEurComTrab * nEurComBase;
     #2#23 = #2#22 / nEurComTrab * nEurComBase;

     #1#5 = #1#5 + #2#9;
     #1#7 = #1#7 + #2#12;
     #1#10 = #1#10 + #2#13;
     #1#14 = #1#14 + #2#18;                       ||Total Coste Ejecutado.
     #1#16 = #1#16 + #2#16;                       ||Total Venta Ejecutado.
||   #1#18 = #1#18 + #2#20;                       ||Total Venta Desviacio.
||   #1#20 = #1#20 + #2#22;                       ||Total Coste Desviacio.

     #1#18 = #1#5 - #1#16;
     #1#20 = #1#10 - #1#14;                       ||Desv. Global Coste Trab.
     #1#22 = #1#22 + #2#24;                       ||Dias Trabajados.

     #1#13 =  #1#10 / nEurComTrab * nEurComBase;
     #1#15 =  #1#14 / nEurComTrab * nEurComBase;
     #1#17 =  #1#16 / nEurComTrab * nEurComBase;
     #1#19 =  #1#18 / nEurComTrab * nEurComBase;
     #1#21 =  #1#20 / nEurComTrab * nEurComBase;

     |GRABA 020#2a;
     |LIBERA #2;
|FPRC;

|PROCESO gomantho;
     cCodMonTrab = #1#6;
     |HAZ MonBas;

     #1#5 = 0;
     #1#7 = 0;
     #1#10 = 0;
     #1#13 = 0;
     #1#14 = 0;
     #1#15 = 0;
     #1#16 = 0;
     #1#17 = 0;
     #1#18 = 0;
     #1#19 = 0;
     #1#20 = 0;
     #1#21 = 0;
     #1#22 = 0;
|FPRC;

|PROCESO Fin;
     |GRABA 020#1a;
|FPRC;

|DEFBUCLE gomantho;
     #1#1;
     ;
     #0#0, #0#2;
     #0#1, #0#3;
     be;
     NULL, gomantho, gomantl1, Fin;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |ABRE #11;
     |BUCLE gomantho;
     |CIERRA #11;
|FPRC;

|PROCESO RecalExpe; || (Plb)  Llamado por gomantho
     |ABRE #11;
     |ABRE #1;
     #1#0 = eaSer;
     #1#1 = enNum;
     |LEE 100#1=;        || Sin Espera
     |SI FSalida = 0;
          |HAZ gomantho;
          |BUCLELIN 2 gomantl1 #1;
          |HAZ Fin;
     |FINSI;
     |CIERRA #1;
     |CIERRA #11;
|FPRC;

|PROCESO Tipo13; |TIPO 13;
     |ABRE #9; |LEE 000#9p; |CIERRA #9;
     |SI #9#141 = "O";
          |ATRI R; |PINTA 823, " RECALCULO DE O.T.        "; |ATRI 0;
     |FINSI;
|FPRC;
