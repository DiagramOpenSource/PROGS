|FICHEROS;
     vipez005  #0;

     vipem007  #907;     ||Contratos
     vipem022  #922;     ||Mto. Avisos

     vipem005  #5;
|FIN;

|VARIABLES;
     aMensaje = "";
     nMes = 0;
     aMes = "";

     fSistema = @;
     aSistema = "";
     aAnyo = "";
     nAnyo = 0;

     aInforme = "";
     nSwPie = 0;

     aDesde = "";
     aHasta = "";
     nMesDos = 0;
     aMesDos = "";
     aAux = "";
     fAux = @;
     nAux = 0;
     fDesde = @;
     fHasta = @;

     fDesdeMenos5 = @;
     fHastaMenos5 = @;
     aAux1 = "";
     aAux2 = "";
     nAux2 = 0;
     aHastaMenos5 = "";
     aDesdeMenos5 = "";
|FIN;

|PROCESO Tipo0C2z005; |TIPO 0;
     nMes = #vipez005#2;
     |SI nMes = 1;  aMes = "Enero";      |FINSI;
     |SI nMes = 2;  aMes = "Febrero";    |FINSI;
     |SI nMes = 3;  aMes = "Marzo";      |FINSI;
     |SI nMes = 4;  aMes = "Abril";      |FINSI;
     |SI nMes = 5;  aMes = "Mayo";       |FINSI;
     |SI nMes = 6;  aMes = "Junio";      |FINSI;
     |SI nMes = 7;  aMes = "Julio";      |FINSI;
     |SI nMes = 8;  aMes = "Agosto";     |FINSI;
     |SI nMes = 9;  aMes = "Septiembre"; |FINSI;
     |SI nMes = 10;  aMes = "Octubre";    |FINSI;
     |SI nMes = 11;  aMes = "Noviembre";  |FINSI;
     |SI nMes = 12;  aMes = "Diciembre";  |FINSI;
     #vipez005#3 = aMes;
     |PINTA #vipez005#3;
|FPRC;

|PROCESO vipem007;
     ||Avisos Contrato con Fecha Cancelacion Contrato.
     |SI #vipem007#17 ] fDesde; |Y #vipem007#17 [ fHasta;

          #vipem022#0 = 0;
          #vipem022#3 = "";
          #vipem022#4 = #vipem007#17;
          #vipem022#5 = "";
          #vipem022#6 = "Fecha Cancelaci¢n Contrato";

          |PRINT;
          nSwPie = 1;
     |FINSI;

     ||Avisos de Contratos que cumplen 5 a¤os
     |SI #vipem007#17 ] fDesde;    ||Activos
          |SI #vipem007#16 ] fDesdeMenos5; |Y #vipem007#16 [ fHastaMenos5;
               #vipem022#0 = 0;
               #vipem022#3 = "";
               #vipem022#4 = fDesde;
               #vipem022#5 = "";
               #vipem022#6 = "Contrato cumple 5 A¤os proximamente";

               |PRINT;
               nSwPie = 1;
          |FINSI;
     |FINSI;

     ||Avisos Fin Carencia
     |SI #vipem007#55 = "S";
          |SI #vipem007#56 ] fDesde; |Y #vipem007#56 [ fHasta;
               #vipem022#0 = 0;
               #vipem022#3 = "";
               #vipem022#4 = #vipem007#56;
               #vipem022#5 = "";
               #vipem022#6 = "Fecha Fin Carencia Contrato";

               |PRINT;
               nSwPie = 1;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE vipem007;
 #vipem007#1;
 ;
 INICIO;
 FINAL;
 ;
 NULL, vipem007;
|FIN;

|PROCESO vipem022;
     |SI #vipem022#7 = 0;
          |DDEFECTO #vipem007;
          #vipem007#0 = 0;
     |SINO;
          |DDEFECTO #vipem007;
          #vipem007#0 = #vipem022#7;
          |LEE 000#vipem007.=;
     |FINSI;

     |PRINT;
     nSwPie = 1;
|FPRC;

|DEFBUCLE vipem022;
 #vipem022#2;
 ;
 #vipez005#1, #vipez005#2;
 #vipez005#1, #vipez005#2;
 ;
 NULL, vipem022;
|FIN;


|PROCESO vipem005;
     |SI #vipem005#9 ! "M";
          |SI #vipem005#9 = "U";
               |SI #vipem005#14 = #vipez005#2; |Y #vipem005#15 = #vipez005#1;
                    |DDEFECTO #vipem007;
                    |DDEFECTO #vipem022;
                    #vipem007#0 = 0;
                    #vipem022#0 = 0;
                    aAux = "01." + (("00" + #vipez005#2) % -102) + "." + #vipez005#1;
                    #vipem022#3 = "CONCEPTO " + #vipem005#9;
                    #vipem022#4 = aAux;
                    #vipem022#6 = #vipem005#1;
                    |PRINT;
                    nSwPie = 1;
               |FINSI;
          |SINO;
               |SI #vipem005#14 = #vipez005#2;
                    |DDEFECTO #vipem007;
                    |DDEFECTO #vipem022;
                    #vipem007#0 = 0;
                    #vipem022#0 = 0;
                    aAux = "01." + (("00" + #vipez005#2) % -102) + "." + #vipez005#1;
                    #vipem022#3 = "CONCEPTO " + #vipem005#9;
                    #vipem022#4 = aAux;
                    #vipem022#6 = #vipem005#1;
                    |PRINT;
                    nSwPie = 1;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE vipem005;
 #vipem005#1;
 ;
 INICIO;
 FINAL;
 ;
 NULL, vipem005;
|FIN;

|PROCESO Principal;
     |IMPRE 0;
     |SI FSalida = 0;
          aInforme = "vipez005";
          |INFOR aInforme;
          |SI FSalida = 0;
               nAnyo = #vipez005#1;
               aAnyo = nAnyo;
               nMes = #vipez005#2;
               aMes = ("00" + nMes) % -102;
               aDesde = "01." + aMes + "." + aAnyo;
               |SI nMes = 12;
                    nAnyo = nAnyo + 1;
                    aAnyo = nAnyo;
                    aHasta = "31.01." + aAnyo;
               |SINO;
                    |SI nMes = 11;
                         aHasta = "31.12." + aAnyo;
                    |FINSI;
                    nMesDos = nMes + 2;
                    aMesDos = ("00" + nMesDos) % -102;
                    aAux = "01." + aMesDos + "." + aAnyo;
                    fAux = aAux;
                    nAux = fAux;
                    nAux = nAux - 1;
                    fAux = nAux;
                    aHasta = fAux;
               |FINSI;
               fDesde = aDesde;
               fHasta = aHasta;

               aAux1 = aDesde % 106;
               aAux2 = aDesde % -104;
               nAux2 = aAux2;
               nAux2 = nAux2 - 5;
               aAux2 = nAux2;
               aDesdeMenos5 = aAux1 + aAux2;
               fDesdeMenos5 = aDesdeMenos5;

               aAux1 = aHasta % 106;
               aAux2 = aHasta % -104;
               nAux2 = aAux2;
               nAux2 = nAux2 - 5;
               aAux2 = nAux2;
               aHastaMenos5 = aAux1 + aAux2;
               fHastaMenos5 = aHastaMenos5;

               |BUCLE vipem007;
               |ABRE #vipem007;
               |BUCLE vipem022;
               |CIERRA #vipem007;
               |BUCLE vipem005;
               |SI nSwPie = 1;
                    |PIEINF;
               |FINSI;
               |FININF;
          |SINO;
               aMensaje = "0000Informe " + aInforme + " inaccesible.";
               |MENAV aMensaje;
          |FINSI;
          |FINIMP;
     |SINO;
          |MENAV "0000Proceso cancelado.";
     |FINSI;
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     FSalida = 3299;
|FPRC;

|PROGRAMA;
     |CLS;
     |ABRE #0;
     |DDEFECTO #0;

     fSistema = ~;
     aSistema = fSistema;
     aAnyo = aSistema % -104;
     nAnyo = aAnyo;
     aMes = aSistema % 402;
     nMes = aMes;
     nMes = nMes + 1;
     |SI nMes > 12;
          nAnyo = nAnyo + 1;
     |FINSI;

     #vipez005#1 = nAnyo;
     #vipez005#2 = nMes;
     |HAZ Tipo0C2z005;

     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |HAZ Principal;
     |FINSI;
     |LIBERA #0;
     |CIERRA #0;
|FPRO;
