|FICHEROS;
     agifa060 #0;        || Este def.
     agifa142 #1;        || Parametros generales.
     agi00016 #80,MANTE; || Textos de familias.
     agifa007 #7;
     referen@;
|FIN;

|VARIABLES;
     nSwCoimasa = 0;
     nModo = 0;
     aAlfa = "";
     alfa      = "";
     cuen      = "";
     modo      = 0;
     quitar    = 0;
     ind       = 0;
     letra     = "";
     codigo    = "";
     resulta   = "";
     vic       = 0;
     numero    = 0;
     aver      = 0;
     &endigC   = 0;
     &eaCta    = "";
     &eswCta   = 0;
|FIN;

|PROCESO cuent1s; |TIPO 0;
     modo = (FEntrada / 100) ! 0;
     |ABRE #1;
     |LEE 001#1p;
     |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
     |CIERRA #1;
     |SI modo = 1;
          |HAZ depura;
          cuen = "000000000000" + resulta;
          |QBT cuen;
          quitar = -(100 + (#1#11 - 2));
          cuen = cuen % quitar;
          |HAZ cuenta3;
          |HAZ cuenta4;
     |FINSI;
|FPRC;

|PROCESO cuenta3;
     #0#2 = "70" + cuen;
     |PINTA #0#2;
|FPRC;

|PROCESO cuenta4;
     #0#3 = "60" + cuen;
     |PINTA #0#3;
|FPRC;

|PROCESO cuenta2s; |TIPO 0;
  eaCta = #0Campo;
  |HAZ MFiltraPtos;
  #0Campo = eaCta; |PINTA #0Campo;

  |HAZ MCtaContable;
  |SI eswCta = 1;
      |MENAV "    Error. Longitud de Cuenta fuera de Nivel";
      |ERROR;
  |FINSI;

/*
     quitar = 100 + #1#11;
     #0Campo = #0Campo % quitar;
     |PINTA #0Campo;
*/
|FPRC;

________________________/ TEXTO LINEAS.......................................
|PROCESO minif;
     #80#0 = #0#0;
     #80#1 = 001;
|FPRC;

|PROCESO maxif;
     #80#0 = #0#0;
     #80#1 = 200;
|FPRC;

|PROCESO textof; TIPO 6;
     |SI FSalida = 10;
          |ABRET #80;
          |PUSHV 0501 2380;
          |PINPA #0#80;
          |PARA ind = 1; |SI ind [ 200; |HACIENDO ind = ind + 1;
               #80#0 = #0#0;
               #80#1 = ind;
               |LEE 141#80=;
               |SI FSalida ! 0;
                    #80#2 = "";
                    |GRABA 021#80n;
               |FINSI;
               |LIBERA #80;
          |SIGUE;
          |MENSA "0000< ESC > SALIR.";
          |ENTLINEAL #1#80,1,4,21,1,minif,maxif;
          |PARA ind = 200; |SI ind ] 1; |HACIENDO ind = ind - 1;
               #80#0 = #0#0;
               #80#1 = ind;
               |LEE 141#80=;
               |SI FSalida = 0;
                    alfa = #80#2;
                    |QBF alfa;
                    |SI alfa ! ""; |SAL; |FINSI;
                    |BORRA 021#80a;
               |FINSI;
               |LIBERA #80;
          |SIGUE;
          |POPV;
          |CIERRAT #80;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO depura;
     codigo = #0#0;
     resulta = "";
     |PARA vic = 1; |SI vic [ 3; |HACIENDO vic = vic +1;
     aver = (vic * 100) + 1;
     letra = codigo % aver;
     numero = &letra;
     |SI numero < 48; |O  numero > 59;
          resulta = resulta + "0";
     |SINO;
          resulta = resulta + letra;
     |FINSI;
     |SIGUE;
|FPRC;


|PROCESO Fam60_2; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |DBASS aAlfa;
          aAlfa = aAlfa + "condepo/def/condm000.mas";
          |XABRE "E", aAlfa, 0;
          |SI FSalida ] 0;
               |AVISO;
               |MENAV "0000Recuerde dar de alta la familia si corresponde en la aplicación Control Depósitos";
          |FINSI;
     |FINSI;
     |SI nModo = 3; |Y nSwCoimasa = 0;
          |DDEF aAlfa;
          aAlfa = aAlfa + "coima067";
          |CARGA_DEF aAlfa, referen@;
          |SI FSalida = 0;
               |ABRE #referen@;
               #referen@#0 = #0#0;
               |LEE 000#referen@.=;
               |SI FSalida = 0; |BORRA 020#referen@.a; |FINSI;
               |CIERRA #referen@;
               |DESCARGA_DEF #referen@;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO T60_13; |TIPO 13;
     |HAZ EsCoimasa;
     nSwCoimasa = FSalida;
     |HAZ Pin60Coimasa;
|FPRC;

|PROCESO Pin60Coimasa;
     |SI nSwCoimasa = 0;
          |DDEF aAlfa;
          aAlfa = aAlfa + "coima067";
          |CARGA_DEF aAlfa, referen@;
          |SI FSalida = 0;
               |ABRE #referen@;
               #referen@#0 = #0#0;
               |LEE 000#referen@.=;
               |SI FSalida ! 0; |DDEFECTO #referen@; |FINSI;
               |CIERRA #referen@;
               |ABRE #7;
               #7#26 = #referen@#1;
               |LEE 000#7=;
               |SI FSalida ! 0; |DDEFECTO #7; |FINSI;
               |CIERRA #7;

               |PINTA 1718, "ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´";
               |PINTA 1818, "³ Confeccion:                                 ³";
               |PINTA 1918, "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ";
               |ATRI I;
               |PINTA 1832, #referen@#1;
               |PINTA 1839, #7#27;
               |ATRI 0;
               |DESCARGA_DEF #referen@;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO CtaAna; |TIPO 0;
     |SI FSalida = 0; |Y nSwCoimasa = 0;
          aAlfa = "coima067;" + #0#0;
          |SUB_EJECUTA_NP aAlfa;
          |HAZ Pin60Coimasa;
     |FINSI;
|FPRC;
