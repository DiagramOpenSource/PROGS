|FICHEROS;
     coimz031 #0;
     coima050 #50;
     coima051 #51;
     coima054 #54;
     agifa019 #19;
|FIN;

|VARIABLES;
     &eInfClave = "";
     &eInfNombre = "";
     &enGrupo = 0;
     nTotal = 0;
     nSwResto = 0;
     aAlfa = "";
     aAlfa1 = "";
|FIN;

|PROCESO Linea;
     #19#0 = #51#2;
     |LEE 000#19=;
     |SI FSalida ! 0; |DDEFECTO #19; |FINSI;

     #54#0 = #51#28;
     |LEE 000#54=;
     |SI FSalida ! 0; |DDEFECTO #54; |FINSI;

     |SI nSwResto = 0;
          enGrupo = 1;
          |SI #19#135 = "N";
               #0#2 = "S";
          |SINO;
               #0#2 = "N";
          |FINSI;
          #0#3 = #19#4;
          #0#4 = #51#25;
          #0#5 = #51#26;
          #0#6 = #0#4 * #0#5 / #0#3;
          #0#7 = #51#12;
          #0#8 = #0#6 * #0#7;
          #0#9 = #0#8 * #51#13 / 100;
          #0#10 = #0#8 - #0#9;
          #0#11 = #51#15;
          #0#12 = #0#10 * #0#11;
          #0#13 = #51#13;
          nTotal = nTotal + #0#12;
     |SINO;
          enGrupo = #51#10 + 1;
          #0#12 = #51#6;
     |FINSI;

     #0#15 = #0#15 + (#19#9 * #51#12); || Coste

     |PRINT;
|FPRC;

|DEFBUCLE Lineas1;
     #51#1;
     10;
     #50#0, 001, 1;
     #50#0, 999, 1;
     ;
     NULL, NULL, NULL, NULL, NULL, Linea;
     #51#28, #51#2;
|FIN;

|DEFBUCLE LinResto;
     #51#1;
     10;
     #50#0, 001, 2;
     #50#0, 999, 9;
     ;
     NULL, NULL, NULL, NULL, NULL, Linea;
     #51#10, #51#2;
|FIN;

|PROCESO Escandallos;
     #19#0 = #50#0;
     |LEE 000#19=;
     |SI FSalida ! 0; |DDEFECTO #19; |FINSI;
     #0#14 = #19#18;
     #0#15 = 0;
     #0#16 = 0;
     #0#17 = 0;
     #0#18 = 0;

     nTotal = 0;
     nSwResto = 0; |BUCLE Lineas1;

     enGrupo = 2;
     #51#3 = "TOTAL TEJIDO";
     #0#12 = nTotal;
     |PRINT;

     nSwResto = 1; |BUCLE LinResto;

     #0#16 = #0#15 / #0#14;   || Por. Bruto

     |PIEINF;
|FPRC;

|DEFBUCLE Escandallos;
     #50#1;
     ;
     #0#0;
     #0#1;
     ;
     NULL, Escandallos;
|FIN;

|PROCESO T3; |TIPO 3;
     Impresora = "CrystalReport";
     |IMPRE -1;
     |SI FSalida = 0;
          aAlfa = #0#21; |QBF aAlfa;
          |INFOR aAlfa;
          |SI FSalida = 0;
               |ABRE #19;
               |ABRE #54;
               |BUCLE Escandallos;
               |CIERRA #54;
               |CIERRA #19;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO Escan;
     #0#1 = #0#0; |PINTA #0#1;
|FPRC;

|PROGRAMA;
     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;

     aAlfa = #0#19;
     aAlfa1 = #0#21; |QBF aAlfa1;

     |DDEFECTO #0;
     #0#19 = aAlfa;
     |SI aAlfa1 ! ""; #0#21 = aAlfa1; |FINSI;

     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0; |GRABA 020#0a; |FINSI;
     |CIERRA #0;
|FPRO;

|PROCESO NomInf0; |TIPO 0;
     eInfClave = "coimz031";
     eInfNombre = #0#21;
     |HAZ NomInf290_0
     #0#21 = eInfNombre; |PINTA #0#21;
|FPRC;

|PROCESO NomInf66; |TIPO 66;
     eInfClave = "coimz031";
     eInfNombre = #0#21;
     |HAZ NomInf290_66;
     #0#21 = eInfNombre; |PINTA #0#21;
|FPRC;
