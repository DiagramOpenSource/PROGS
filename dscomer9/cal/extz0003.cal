|FICHEROS;
     extz0003 #0;
     extm0001 #1;
     extm0003 #3;
     extm0004 #4;
     extm0005 #5;
     extm0006 #6;
     extm0007 #7;
     extm0008 #8;
     extm0009 #9;
     extm0010 #10;
     extm0011 #11;
     extm0012 #12;
     agifa019 #19;
     agifa024 #24;
     agifa025 #25;
     dsm00003 #30;
     extm0019 #119,MANTE;
     referen@;
|FIN;

|VARIABLES;
     &eaNumNuevo = "";
     &eaNumSerie = "";
     &eaCliente = "";
     &enDirEnt = 0;
     &eaCodEdi = "";
     &enModo = 0;
     nBloquea = 0;
     aConte = "";
     aAlfa = "";
     nConta = 0;
     i = 0;
     nSw = 0;
     nNume = 0;
     nId = 0;
     nPan2 = 0;
|FIN;

|PROCESO AltaNum;
     |VENTANA 0501, 3399, -1, 17, "Numeros de serie";
     |HAZ PushVenModal;

     |DDEFECTO #119;
     #119#0 = #0#4;
     #119#1 = #0#0;
     |GRABA 020#119b;

     |PINPA #0#119;
     |PINDA #0#119;
     |ENDATOS #1#119;
     aAlfa = FSalida;
     |SI FSalida = 0;
          |GRABA 020#119a;
     |SINO;
          |BORRA 020#119c;
     |FINSI;

     |HAZ PopVenModal;

     FSalida = aAlfa;
|FPRC;

|PROCESO CliComerFac;
     #0#39 = #referen@#39; |PINTA #0#39;
     #0#52 = #referen@#52; |PINTA #0#52;
     |ERROR10;
|FPRC;

|DEFBUCLE CliComerFac;
     #referen@#2005;
     ;
     #0#1, #0#2, #0#3, #0#5, "                    ";
     #0#1, #0#2, #0#3, #0#5, "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, CliComerFac;
|FIN;

|PROCESO PonCliComerFac;
     |DDEF aAlfa;
     aAlfa = aAlfa + "extm0011";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |BUCLE CliComerFac;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO CheqCli;
     |SI #referen@#0 ! #0#0;
          |SI #referen@#39 ! #0#39;
               aAlfa = "0000Cliente factura incorrecto...";
               |MENAV aAlfa;
          |FINSI;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE CheqCli;
     #referen@#2005;
     ;
     #0#1, #0#2, #0#3, #0#5, "                    ";
     #0#1, #0#2, #0#3, #0#5, "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, CheqCli;
|FIN;

|PROCESO CliFac0; |TIPO 0;
     |DDEF aAlfa;
     aAlfa = aAlfa + "extm0011";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          aAlfa = "";
          |BUCLE CheqCli;
          |DESCARGA_DEF #referen@;
          |SI aAlfa ! ""; |ERROR; |FINSI;
     |FINSI;
|FPRC;

|PROCESO Instala0; |TIPO 0;
     |ABRE #30;
     #30#0 = #0#1;
     #30#1 = #0#2;
     |LEE 000#30=;
     |SI FSalida = 0
          #0#57 = #30#25; |PINTA #0#57;
     |SINO;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #30;
|FPRC;

|PROCESO Min30;
     #30#0 = #0#1;
     #30#1 = 0001;
|FPRC;

|PROCESO Max30;
     #30#0 = #0#1;
     #30#1 = 9999;
|FPRC;

|PROCESO Instala66; |TIPO 66;
     |ABRE #30;
     #30#0 = #0#1;
     #30#1 = #0#2;
     |LEE 000#30=;
     |CONSULTA_F_CLAVE #1#30, Min30, Max30;
     |SI FSalida = 0
          #0#2 = #30#1; |PINTA #0#2;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #30;
|FPRC;

|PROCESO Edificio0; |TIPO 0;
     |ABRE #4;
     #4#0 = #0#1;
     #4#1 = #0#2;
     #4#2 = #0#3;
     |LEE 000#4=;
     |SI FSalida ! 0;
          |CONFI "0000NNo existe edificio. ¨Desea darlo de alta?";
          |SI FSalida = 0;
               |GRABA 020#4n;

               |ABRE #5;
               #5#0 = #4#0;
               #5#1 = #4#1;
               #5#2 = #4#2;
               #5#3 = "";
               |GRABA 000#5n;
               |CIERRA #5;

               |ABRE #6;
               #6#0 = #4#0;
               #6#1 = #4#1;
               #6#2 = #4#2;
               #6#3 = "";
               #6#4 = "";
               |GRABA 000#6n;
               |CIERRA #6;
          |SINO;
               |ERROR;
          |FINSI;
     |SINO;
          |HAZ PonCliComerFac;
          nSw = 1;
          |HAZ Comercial;
          nSw = 0;
     |FINSI;
     |CIERRA #4;
|FPRC;

|PROCESO Min4;
     #4#0 = #0#1;
     #4#1 = #0#2;
     #4#2 = "                    ";
|FPRC;

|PROCESO Max4;
     #4#0 = #0#1;
     #4#1 = #0#2;
     #4#2 = "zzzzzzzzzzzzzzzzzzzz";
|FPRC;

|PROCESO Edificio66; |TIPO 66;
     |ABRE #4;
     #4#0 = #0#1;
     #4#1 = #0#2;
     #4#2 = #0#3;
     |LEE 000#4];
     |CONSULTA_F_CLAVE #1#4, Min4, Max4;
     |SI FSalida = 0;
          #0#3 = #4#2; |PINTA #0#3;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #4;
|FPRC;

|PROCESO FProxRet;
     |SI #0#26 = "N";
          nNume = #0#35/1000000;
          #0#37 = #0#33 + nNume; |PINTA #0#37;
     |FINSI;
|FPRC;

|PROCESO FProxRev;
     |SI #0#36 = "N";
          |SI #0#25 = "A"; nNume = 1/1000000; |FINSI;
          |SI #0#25 = "S"; nNume = 1/1000 * 6; |FINSI;
          |SI #0#25 = "T"; nNume = 1/1000 * 3; |FINSI;
          |SI #0#25 = "M"; nNume = 1/1000 * 1; |FINSI;
          #0#27 = #0#23 + nNume; |PINTA #0#27;
     |FINSI;
|FPRC;

|PROCESO FCaduca;
     |ABRE #1;
     #1#0 = #0#4;
     |LEE 000#1=;
     |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
     |CIERRA #1;

     nNume = #1#7/1000000;
     #0#22 = #0#20 + nNume; |PINTA #0#22;
|FPRC;

|PROCESO FecuRet; |TIPO 0;
     |SI aConte ! #0Campo;
          |HAZ FProxRet;
     |FINSI;
|FPRC;

|PROCESO FUltRet; |TIPO 0;
     |SI aConte ! #0Campo;
          |HAZ FProxRet;
     |FINSI;
|FPRC;

|PROCESO FUltRev; |TIPO 0;
     |SI aConte ! #0Campo;
          |HAZ FProxRev;
     |FINSI;
|FPRC;

|PROCESO FecuRev; |TIPO 0;
     |SI aConte ! #0Campo;
          |HAZ FProxRev;
     |FINSI;
|FPRC;

|PROCESO FInstala; |TIPO 0;
/*
     |SI aConte ! #0Campo;
          |SI #0#21 = "01.01.0000";
               #0#23 = #0#21; |PINTA #0#23;
          |FINSI;
          |HAZ FProxRev;
     |FINSI;
*/
|FPRC;

|PROCESO FFabri; |TIPO 0;
     |SI aConte ! #0Campo;
          #0#23 = #0#20; |PINTA #0#23; |HAZ FProxRev;
          #0#33 = #0#20; |PINTA #0#33; |HAZ FProxRet;
          |HAZ FCaduca;
     |FINSI;
|FPRC;

|PROCESO Articulo; |TIPO 0;
     |ABRE #1;
     #1#0 = #0#4;
     |LEE 000#1=;
     |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
     |CIERRA #1;

     |ABRE #19;
     #19#0 = #0#4;
     |LEE 000#19=;
     |SI FSalida = 0
          #0#55 = #19#1; |PINTA #0#55;
          |SI enModo = 1;
               #0#29 = #1#1; |PINTA #0#29;
               #0#30 = #1#2; |PINTA #0#30;
               #0#31 = #1#4; |PINTA #0#31;
               #0#32 = #1#3; |PINTA #0#32;
               #0#5 = #1#5; |PINTA #0#5;
               #0#25 = #1#8; |PINTA #0#25;
               #0#35 = #1#9; |PINTA #0#35;
               |HAZ FCaduca;
               |SI nSw = 0; |Y #1#6 = "N";
                    |HAZ AsignaNum;
               |FINSI;
          |FINSI;
          |SI enModo = 2; |Y #0#4 ! aConte; |Y nSw = 0;
               #0#29 = #1#1; |PINTA #0#29;
               #0#30 = #1#2; |PINTA #0#30;
               #0#31 = #1#3; |PINTA #0#31;
               #0#33 = #1#4; |PINTA #0#32;
               #0#5 = #1#5; |PINTA #0#5;
               #0#25 = #1#8; |PINTA #0#25;
               |HAZ FCaduca;
          |FINSI;
     |SINO;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #19;
|FPRC;

|PROCESO Sistema; |TIPO 0;
     |ABRE #3;
     #3#0 = #0#5;
     |LEE 000#3=;
     |SI FSalida = 0
          #0#54 = #3#1; |PINTA #0#54;
     |SINO;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO Planta0; |TIPO 0;
     |ABRE #5;
     #5#0 = #0#1;
     #5#1 = #0#2;
     #5#2 = #0#3;
     #5#3 = #0#8;
     |LEE 000#5=;
     |SI FSalida ! 0;
          |CONFI "0000NNo existe planta. ¨Desea darla de alta?";
          |SI FSalida = 0;
               |GRABA 020#5n;
          |SINO;
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #5;
|FPRC;

|PROCESO Min5;
     #5#0 = #0#1;
     #5#1 = #0#2;
     #5#2 = #0#3;
     #5#3 = "                    ";
|FPRC;

|PROCESO Max5;
     #5#0 = #0#1;
     #5#1 = #0#2;
     #5#2 = #0#3;
     #5#2 = "zzzzzzzzzzzzzzzzzzzz";
|FPRC;

|PROCESO Planta66; |TIPO 66;
     |ABRE #5;
     #5#0 = #0#1;
     #5#1 = #0#2;
     #5#2 = #0#3;
     #5#3 = #0#8;
     |LEE 000#5];
     |CONSULTA_F_CLAVE #1#5, Min5, Max5;
     |SI FSalida = 0;
          #0#8 = #5#3; |PINTA #0#8;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #5;
|FPRC;

|PROCESO Sector0; |TIPO 0;
     |ABRE #6;
     #6#0 = #0#1;
     #6#1 = #0#2;
     #6#2 = #0#3;
     #6#3 = #0#8;
     #6#4 = #0#9;
     |LEE 000#6=;
     |SI FSalida ! 0;
          |CONFI "0000NNo existe sector. ¨Desea darlo de alta?";
          |SI FSalida = 0;
               |GRABA 020#6n;
          |SINO;
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #6;
|FPRC;

|PROCESO Min6;
     #6#0 = #0#1;
     #6#1 = #0#2;
     #6#2 = #0#3;
     #6#3 = #0#8;
     #6#4 = "                    ";
|FPRC;

|PROCESO Max6;
     #6#0 = #0#1;
     #6#1 = #0#2;
     #6#2 = #0#3;
     #6#3 = #0#8;
     #6#4 = "zzzzzzzzzzzzzzzzzzzz";
|FPRC;

|PROCESO Sector66; |TIPO 66;
     |ABRE #6;
     #6#0 = #0#1;
     #6#1 = #0#2;
     #6#2 = #0#3;
     #6#3 = #0#8;
     #6#4 = #0#9;
     |LEE 000#6];
     |CONSULTA_F_CLAVE #1#6, Min6, Max6;
     |SI FSalida = 0;
          #0#9 = #6#4; |PINTA #0#9;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #6;
|FPRC;

|PROCESO AreaEx0; |TIPO 0;
     |ABRE #7;
     #7#0 = #0#1;
     #7#1 = #0#2;
     #7#2 = #0#10;
     |LEE 000#7=;
     |SI FSalida ! 0;
          |CONFI "0000NNo existe  rea exterior. ¨Desea darla de alta?";
          |SI FSalida = 0;
               |GRABA 020#7n;
          |SINO;
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #7;
|FPRC;

|PROCESO Min7;
     #7#0 = #0#1;
     #7#1 = #0#2;
     #7#2 = "                    ";
|FPRC;

|PROCESO Max7;
     #7#0 = #0#1;
     #7#1 = #0#2;
     #7#2 = "zzzzzzzzzzzzzzzzzzzz";
|FPRC;

|PROCESO AreaEx66; |TIPO 66;
     |ABRE #7;
     #7#0 = #0#1;
     #7#1 = #0#2;
     #7#2 = #0#10;
     |LEE 000#7];
     |CONSULTA_F_CLAVE #1#7, Min7, Max7;
     |SI FSalida = 0;
          #0#10 = #7#2; |PINTA #0#10;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #7;
|FPRC;

|PROCESO SecArea0; |TIPO 0;
     |ABRE #8;
     #8#0 = #0#1;
     #8#1 = #0#2;
     #8#2 = #0#10;
     #8#3 = #0#11;
     |LEE 000#8=;
     |SI FSalida ! 0;
          |CONFI "0000NNo existe sector  rea exterior. ¨Desea darlo de alta?";
          |SI FSalida = 0;
               |GRABA 020#8n;
          |SINO;
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #8;
|FPRC;

|PROCESO Min8;
     #8#0 = #0#1;
     #8#1 = #0#2;
     #8#2 = #0#10;
     #8#3 = "                    ";
|FPRC;

|PROCESO Max8;
     #8#0 = #0#1;
     #8#1 = #0#2;
     #8#2 = #0#10;
     #8#3 = "zzzzzzzzzzzzzzzzzzzz";
|FPRC;

|PROCESO SecArea66; |TIPO 66;
     |ABRE #8;
     #8#0 = #0#1;
     #8#1 = #0#2;
     #8#2 = #0#10;
     #8#3 = #0#11;
     |LEE 000#8];
     |CONSULTA_F_CLAVE #1#8, Min8, Max8;
     |SI FSalida = 0;
          #0#11 = #8#3; |PINTA #0#11;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #8;
|FPRC;

|PROCESO CheqComer;
     |SI #referen@#0 ! #0#0;
          |SI #referen@#52 ! #0#52;
               aAlfa = "0000Comercial factura incorrecto, debe ser:" + #referen@#52;
               |MENAV aAlfa;
          |FINSI;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE CheqComer;
     #referen@#2005;
     ;
     #0#1, #0#2, #0#3, #0#5, "                    ";
     #0#1, #0#2, #0#3, #0#5, "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, CheqComer;
|FIN;

|PROCESO Comercial; |TIPO 0;
     |ABRE #25;
     #25#0 = #0#52;
     |LEE 000#25=;
     |SI FSalida = 0
          #0#56 = #25#1; |PINTA #0#56;
          |DDEF aAlfa;
          aAlfa = aAlfa + "extm0011";
          |CARGA_DEF aAlfa, referen@;
          |SI FSalida = 0;
               aAlfa = "";
               |BUCLE CheqComer;
               |DESCARGA_DEF #referen@;
               |SI aAlfa ! ""; |ERROR; |FINSI;
          |FINSI;
     |SINO;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #25;
|FPRC;

|PROCESO AgeExt; |TIPO 0;
     |ABRE #9;
     #9#0 = #0#50;
     |LEE 000#9=;
     |SI FSalida ! 0;
          |CONFI "0000NNo existe agente extintor. ¨Desea darlo de alta?";
          |SI FSalida = 0;
               |GRABA 020#9n;
          |SINO;
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #9;
|FPRC;

|PROCESO AgePro; |TIPO 0;
     |ABRE #10;
     #10#0 = #0#51;
     |LEE 000#10=;
     |SI FSalida ! 0;
          |CONFI "0000NNo existe agente propelente. ¨Desea darlo de alta?";
          |SI FSalida = 0;
               |GRABA 020#10n;
          |SINO;
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #10;
|FPRC;

|PROCESO Cliente; |TIPO 0;
     |ABRE #24;
     #24#0 = #0#1;
     |LEE 000#24=;
     |SI FSalida = 0;
          #0#53 = #24#1; |PINTA #0#53;
          |SI enModo = 1;
               #0#38 = #0#1; |PINTA #0#38;
          |FINSI;
          nSw = 1;
          |HAZ Instala0;
          nSw = 0;
     |SINO;
          |MENAV "0000No existe c¢digo cliente...";
          |ERROR;
     |FINSI;
     |CIERRA #24;
|FPRC;

|PROCESO AsignaNum;
     |ABRE #1;
     #1#0 = #0#4;
     |LEE 000#1=;
     |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
     |CIERRA #1;

     |ABRE #12;
     |LEE 101#12p;
     |SI FSalida ! 0; |GRABA 020#12b; |FINSI;
     nConta = #12#1;
     #12#1 = #12#1 + 1;
     |GRABA 020#12a;
     |CIERRA #12;
     |SI #1#6 = "S";
          aAlfa = "DESC" + #0#1 + (("0000000000" + nConta) % -110);
     |SINO;
          aAlfa = #0#5 + #0#1 + (("0000000000" + nConta) % -110);
     |FINSI;
     #0#0 = aAlfa;
     |PINTA #0#0;
|FPRC;

|PROCESO Min119;
     #119#0 = #0#4;
     #119#1 = "                    ";
|FPRC;

|PROCESO Max119;
     #119#0 = #0#4;
     #119#1 = "zzzzzzzzzzzzzzzzzzzz";
|FPRC;

|PROCESO Num66; |TIPO 66;
     |ABRE #119;
     #119#0 = #0#4;
     #119#1 = #0#0;
     |LEE 000#119];
     |CONSULTA_F_CLAVE #1#119, Min119, Max119;
     |SI FSalida = 0;
          |SI #1#6 = "N";
               |CONFI "0000NEl  rticulo no tiene n£mero serie real. ¨Continuar?";
          |SINO;
               FSalida = 0;
          |FINSI;
          |SI FSalida = 0;
               #0#4 = #119#0; |PINTA #0#4;
               #0#0 = #119#1; |PINTA #0#0;
          |SINO;
               |ERROR;
          |FINSI;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #19;
|FPRC;

|PROCESO Chequea; |TIPO 0;
     |SI FSalida = 2; |O FSalida = 3; |ACABA; |FINSI;
     |SI FSalida = 13;
          |SI #1#6 = "S";
               |CONFI "0000NEl  rticulo con n£mero serie real. ¨Continuar?";
               |SI FSalida ! 0; |ERROR; |ACABA; |FINSI;
          |FINSI;
          |HAZ AsignaNum;
     |FINSI;

     aAlfa = #0#0; |QBF aAlfa;
     |SI aAlfa = ""; |ERROR; |ACABA; |FINSI;

     |SI enModo = 1; |Y nBloquea = 0;
          aAlfa = #0#0 % 104;
          |SI aAlfa ! "DESC"; |Y #1#6 = "S";
               |ABRE #119;
               #119#0 = #0#4;
               #119#1 = #0#0;
               |LEE 000#119=;
               |SI FSalida ! 0;
                    |CONFI "0000NNo existe n§ serie. ¨Desea darlo de alta?";
                    |SI FSalida = 0;
                         |HAZ AltaNum;
                         |ERROR; |ACABA;
                    |SINO;
                         |ERROR; |ACABA;
                    |FINSI;
               |FINSI;
               |CIERRA #119;
          |FINSI;

          #11#0 = #0#0;
          |GRABA 000#11b;
          |SI FSalida ! 0;
               |MENAV "0000Registro existente....";
               |ERROR;
          |SINO;
               nBloquea = 1;
               |C_M #0#0, 1, "N"; |PINTA #0#0;
          |FINSI;
     |FINSI;
     |SI enModo = 2; |Y aConte ! #0#0; |Y nBloquea = 0;
          #11#0 = #0#0;
          |GRABA 000#11b;
          |SI FSalida ! 0;
               |MENAV "0000Registro existente...";
               |ERROR;
          |SINO;
               nBloquea = 1;
               |C_M #0#0, 1, "N"; |PINTA #0#0;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Conte; |TIPO 7;
     aConte = #0Campo;
|FPRC;

|PROCESO Evt2;
     aAlfa = "|C047WID";
     aAlfa = #0#aAlfa#;
     nId = aAlfa;
     |FOCOTECLADO nId;
|FPRC;

|PROCESO GrabaDesDir;
     |ABRE #30;
     #30#0 = #0#1;
     #30#1 = #0#2;
     |LEE 121#30=;
     |SI FSalida = 0;
          #30#25 = #0#57;
          |GRABA 020#30a;
     |FINSI;
     |CIERRA #30;
|FPRC;

|PROGRAMA;
     |DDEFECTO #0;
     |ABRE #11;
     |SI enModo = 1;
          #0#1 = eaCliente;
          |SI enDirEnt = 0;
               #0#2 = 1;
          |SINO;
               #0#2 = enDirEnt;
          |FINSI;
          #0#52 = #24#25;
          #0#3 = eaCodEdi;
     |SINO;
          #11#0 = eaNumSerie;
          |SI enModo = 2;
               |LEE 020#11=;
          |SINO;
               |LEE 121#11=;
          |FINSI;
          |PARA i = 0; |SI i [ 52; |HACIENDO i = i + 1;
               #0i = #11i;
          |SIGUE;
     |FINSI;
     |ABRE #24;
     #24#0 = #0#1;
     |LEE 020#24=;
     |CIERRA #24;
     #0#53 = #24#1;
     nSw = 1;
     |HAZ Sistema;
     |HAZ Articulo;
     |HAZ Comercial;
     |HAZ Instala0;
     nSw = 0;
     |PINPA #0#0;
     |PINPA #1#0;
     |PINPA #2#0; nPan2 = FSalida;

     |CONTROL_SIMPLE nPan2, "EVENTOPAN", 0000, 0000, Evt2;

     |PINDA #0#0;
     |PINDA #1#0;
     |PINDA #2#0;
     |SI enModo = 4;
          |PAUSA;
     |SINO;
          |SI enModo = 1;
               |ENDATOS #1#0;
               |SI FSalida = 0;
                    |PARA i = 0; |SI i [ 52; |HACIENDO i = i + 1;
                         #11i = #0i;
                         |GRABA 020#11a;
                    |SIGUE;
                    |GRABA 020#11a;
                    |HAZ GrabaDesDir;
                    eaNumNuevo = #11#0;
               |SINO;
                    eaNumNuevo = "";
                    |SI nBloquea = 1; |BORRA 020#11c; |FINSI;
               |FINSI;
          |SINO;
               |SI #0#46 ! 0;
                    |C_M #0#23, 1, "N"; |PINTA #0#23;
                    |C_M #0#24, 1, "N"; |PINTA #0#24;
                    |C_M #0#27, 1, "N"; |PINTA #0#27;
                    |C_M #0#33, 1, "N"; |PINTA #0#33;
                    |C_M #0#34, 1, "N"; |PINTA #0#34;
                    |C_M #0#37, 1, "N"; |PINTA #0#37;
                    |C_M #0#0, 1, "N"; |PINTA #0#0;
               |FINSI;

               |ENDATOS #2#0;
               |SI FSalida = 0;
                    |PARA i = 0; |SI i [ 52; |HACIENDO i = i + 1;
                         #11i = #0i;
                         |GRABA 020#11a;
                    |SIGUE;
                    |GRABA 020#11a;
                    |HAZ GrabaDesDir;
                    eaNumNuevo = #11#0;
               |SINO;
                    |SI nBloquea = 1; |BORRA 020#11c; |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #11;
|FPRO;
