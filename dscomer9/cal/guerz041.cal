|FICHEROS;
     guerz041 #0;
     gomatcab #1;
     gomatljn #2;
     agif0041 #41;
     agifa077 #77; ||Cab
     agifa080 #80; ||Lin
     agifa112 #112;
     agifa324 #324;
|FIN;

|VARIABLES;
     aSerFac = "";
     nNumFac = 0;
     nImpre = 0;
     aAlfa = "";
     aEmp = "";
     nHay = 0;
     &aDivisa = "";
     &aMoneda = "";
|FIN;

|PROCESO FinImpre;
     |SI nImpre > 0;
          |PIEINF;
          |FININF;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO Imprime;
     |SI nImpre = 0;
          |IMPRE 0;
          |SI FSalida ! 0;
               nImpre = -1;
          |SINO;
               |INFOR "guerz041";
               |SI FSalida ! 0;
                    |MENAV "0000No existe informe 'guerz041'";
                    |ERROR10;
                    nImpre = -1;
               |SINO;
                    nImpre = 1;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI nImpre = 1;
          |PRINT;
     |FINSI;
|FPRC;

|PROCESO CreaCab;
     |DDEFECTO #112;
     #112#0 = #2#7;
     |LEE 000#112=;

     #77#1 = #2#3;
     #77#3 = #2#7;
     #77#4 = #112#2;
     #77#54 = #2#4;   ||Curso
     #77#8 = #112#17; ||FP
     #77#58 = #112#82; || Mone Tra
     #77#56 = #112#81; || Divisa

     |DDEFECTO #324;
     #324#0 = #77#56;
     |LEE 000#324=;

     #77#57 = #324#3;||Cambio

     #77#29 = #41#1; ||Datos Emp
     #77#30 = #41#2;
     #77#31 = #41#3;
     #77#33 = #41#4;

     #77#51 = #80#28; ||Factura
     #77#39 = #80#25;
|FPRC;

|PROCESO gomatljn;
     #1#0 = #2#14;
     #1#1 = #2#15;
     |LEE 000#1=;
     |SI FSalida = 0;
          #80#27 = #2#5;
          #80#0 = #2#6;
          #80#1 = 1;
          |LEE 000#80];
          |SI FSalida = 0; |Y #80#27 = #2#5; |Y #80#0 = #2#6;
               |DDEFECTO #77;
               #77#50 = #2#5;
               #77#0 = #2#6;
               |LEE 000#77=;
               |SI FSalida ! 0;
                    |GRABA 020#77b;
                    |HAZ CreaCab;
                    aDivisa = #agifa077#56;
                    aMoneda = #agifa077#58;
                    |HAZ Divisas077;
                    |HAZ LimCabAgifa077;
                    |BUCLELIN 0 CalCabAgifa077 #77;
                    |GRABA 020#77a;
                    |LIBERA #77;
                    |HAZ Imprime;
                    nHay = nHay + 1;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE gomatljn;
     #2#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, gomatljn;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |SI #0#0 = "SI";
          |DFICE aAlfa;
          aEmp = aAlfa % -205;
          |DBASE aAlfa;
          aAlfa = aAlfa + "fich/";
          |PATH_DAT #41 aAlfa;
          |ABRE #41;
          #41#0 = aEmp;
          |LEE 020#41=;
          |SI FSalida = 0;
               |ABRE #1;
               |ABRE #80;
               |ABRE #77;
               |ABRE #112;
               |ABRE #324;
               |BUCLE gomatljn;
               |HAZ FinImpre;
               |CIERRA #324;
               |CIERRA #112;
               |CIERRA #77;
               |CIERRA #80;
               |CIERRA #1;
               aAlfa = "0000Creados " + nHay + " cabeceras...";
               |MENAV aAlfa;
          |FINSI;
          |CIERRA #41;
     |FINSI;
|FPRC;
