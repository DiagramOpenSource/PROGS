|FICHEROS;
     clipr073 #0;

     clipr001 #1;   ||Empresas
     clipr015 #15;  ||Centros
     clipr016 #16;  ||Visitas
     clipr025 #25;  ||Inspecciones (CAB)
     clipr026 #26;  ||Inspecciones (LIN)
     clipr063 #63;  ||Accidentes (CAB)
     clipr006 #6;   ||Presupuestos
     clipr007 #7;   ||Contratos
|FIN;

|VARIABLES;
     aEmpresa = "";
     aMensaje = "";
|FIN;

|PROGRAMA;
     |CLS;
     |ABRE #0;
     |DDEFECTO #0;
     |LEE 101#0p;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |SI #clipr073#1 = "SI";
               |HAZ Principal;
          |FINSI;
     |FINSI;
     |LIBERA #0;
     |CIERRA #0;
|FPRO;

|PROCESO clipr015_0;
     #clipr015#42 = 0;
     #clipr015#35 = 0;
     |GRABA 020#clipr015.a;
     |LIBERA #clipr015;
|FPRC;

|DEFBUCLE clipr015_0;
 #clipr015#1;
 ;
 INICIO;
 FINAL;
 be;
 NULL, clipr015_0;
|FIN;

|PROCESO clipr001_0;
     #clipr001#34 = 0;
     #clipr001#35 = 0;
     #clipr001#36 = 0;
     #clipr001#55 = 0;
     #clipr001#59 = 0;
     #clipr001#60 = 0;
     #clipr001#63 = 0;
     |GRABA 020#clipr001.a;
     |LIBERA #clipr001;
|FPRC;

|DEFBUCLE clipr001_0;
 #clipr001#1;
 ;
 INICIO;
 FINAL;
 be;
 NULL, clipr001_0;
|FIN;

|PROCESO Acerar;
     |BUCLE clipr001_0;
     |BUCLE clipr015_0;
|FPRC;

|PROCESO Principal;
     |HAZ Acerar;
     |HAZ Recalculo;
|FPRC;

|PROCESO clipr016;
     #clipr001#0 = #clipr016#9;
     |LEE 101#clipr001.=;
     |SI FSalida = 0;
          #clipr001#60 = #clipr001#60 + 1;
          |GRABA 020#clipr001.a;
          |LIBERA #clipr001;
     |FINSI;

     #clipr015#0 = #clipr016#9;
     #clipr015#1 = #clipr016#10;
     |LEE 101#clipr015.=;
     |SI FSalida = 0;
          #clipr015#35 = #clipr015#35 + 1;
          |GRABA 020#clipr015.a;
          |LIBERA #clipr015;
     |FINSI;
|FPRC;

|DEFBUCLE clipr016;
 #clipr016#1;
 ;
 INICIO;
 FINAL;
 ;
 NULL, clipr016;
|FIN;

|PROCESO clipr063;
     #clipr001#0 = #clipr063#1;
     |LEE 101#clipr001.=;
     |SI FSalida = 0;
          #clipr001#36 = #clipr001#36 + #clipr063#3;
          #clipr001#35 = #clipr001#35 + #clipr063#4;
          #clipr001#55 = #clipr001#55 + #clipr063#5;
          |GRABA 020#clipr001.a;
          |LIBERA #clipr001;
     |FINSI;
|FPRC;

|DEFBUCLE clipr063;
 #clipr063#1;
 ;
 INICIO;
 FINAL;
 ;
 NULL, clipr063;
|FIN;

|PROCESO clipr026;
     #clipr001#0 = aEmpresa;
     |LEE 101#clipr001.=;
     |SI FSalida = 0;
          #clipr001#63 = #clipr001#63 + 1;
          |GRABA 020#clipr001.a;
          |LIBERA #clipr001;
     |FINSI;
     #clipr015#0 = aEmpresa;
     #clipr015#1 = #clipr026#13;
     |LEE 101#clipr015.=;
     |SI FSalida = 0;
          #clipr015#42 = #clipr015#42 + 1;
          |GRABA 020#clipr015.a;
          |LIBERA #clipr015;
     |FINSI;
|FPRC;

|DEFBUCLE clipr026;
 #clipr026#1;
 ;
 #clipr025#0, #clipr025#1, 001;
 #clipr025#0, #clipr025#1, 999;
 ;
 NULL, clipr026;
|FIN;

|PROCESO clipr025;
     aEmpresa = #clipr025#2;
     |BUCLE clipr026;
|FPRC;

|DEFBUCLE clipr025;
 #clipr025#1;
 ;
 INICIO;
 FINAL;
 ;
 NULL, clipr025;
|FIN;

|PROCESO clipr006;
     #clipr001#0 = #clipr006#1;
     |LEE 101#clipr001.=;
     |SI FSalida = 0;
          #clipr001#34 = #clipr001#34 + 1;
          |GRABA 020#clipr001.a;
          |LIBERA #clipr001;
     |FINSI;
|FPRC;

|DEFBUCLE clipr006;
 #clipr006#1;
 ;
 INICIO;
 FINAL;
 ;
 NULL, clipr006;
|FIN;

|PROCESO clipr007;
     #clipr001#0 = #clipr007#3;
     |LEE 101#clipr001.=;
     |SI FSalida = 0;
          #clipr001#59 = #clipr001#59 + 1;
          |GRABA 020#clipr001.a;
          |LIBERA #clipr001;
     |FINSI;
|FPRC;

|DEFBUCLE clipr007;
 #clipr007#1;
 ;
 INICIO;
 FINAL;
 ;
 NULL, clipr007;
|FIN;


|PROCESO Recalculo;
     |ABRE #clipr001;
     |ABRE #clipr015;
     |BUCLE clipr016;         ||Visitas
     |BUCLE clipr063;         ||Accidentes
     |BUCLE clipr025;         ||Inspecciones
     |BUCLE clipr006;         ||Presupuestos
     |BUCLE clipr007;         ||Contratos
     |CIERRA #clipr001;
     |CIERRA #clipr015;
|FPRC;
