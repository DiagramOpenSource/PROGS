|FICHEROS;
   guerz300 #0;
   guerw300 #10;
   guerm001 #11;
   agifa722 #12;
   guerm009 #13;
   guerm300 #14;
   guerm205 #15;

   goparame #100;

   cacuent@ #1000;
   camandi@ #1001;
   caconce@ #1002;
   caconas@ #1003;
   canempr@ #1004;
   camasic@ #1005;
   caenlac@ #1006;

   goparti@ #5000;
|FIN;

|VARIABLES;
   &fich_alta = "";
   &enNoModif = 0;
   &PRMNT_enError = 0;
   &PRMNT_enVer   = 0;

   nBusca    = 0;
   nTecla    = 0;
   nMaxDigit = 0;
   nCalc     = 0;
   nCalc1    = 0;
   nSwHay    = 0;
   nDiario   = 0;
   nDocum    = 0;
   nDocgpt   = 0;
   nLinea    = 0;
   nPerAnt   = 0;
   FEstado   = 0;
   nSwErr    = 0;

   fFecha    = @;

   aAlfa     = "";
   aAlfa1    = "";
   aSerie    = "";
   aClase    = "";

   aCtaDEBE  = "";
   aCtaHABER = "";
   aCmp1     = "";
   aCmp2     = "";

   aAlfa1a   = "";
   aAlfa2a   = "";
   aAlfa3a   = "";
   aAlfa4a   = "";
   aAlfa1b   = "";
   aAlfa2b   = "";
   aAlfa3b   = "";
   aAlfa4b   = "";

   fDFecha   = @;
   fHFecha   = @;
|FIN;

|PROCESO MiraT66; |TIPO 66;
   nTecla = 10; |HAZ MiraCta;
|FPRC;

|PROCESO MiraCta;
   |SI FSalida = 2; |ACABA; |FINSI;
   ||nTecla = FSalida;

   aAlfa = #goparame#84; |QBF aAlfa;
   aAlfa1 = aAlfa + "def/cacuenta.mas";
   |CARGA_DEF aAlfa1, cacuent@;
   |SI FSalida ! 0;
      |MENAV "    No encuentro el fichero del plan contable";
      |ERROR; |ACABA;
   |SINO;
      aAlfa1 = aAlfa + "def/canempre.mas";
      |CARGA_DEF aAlfa1, canempr@;
      |SI FSalida ! 0;
         |DESCARGA_DEF #cacuent@;
         |MENAV "    No encuentro el fichero empresas";
         |ERROR; |ACABA;
      |FINSI;
    |FINSI;

    aAlfa1 = aAlfa + "fich/"; |PATH_DAT #canempr@#aAlfa1#;
    aAlfa1 = aAlfa + "fich/" + (("00000" + #goparame#85) % -105) + #goparame#86 + "/";
    |PATH_DAT #cacuent@#aAlfa1#;

    |ABRE #canempr@;
    #canempr@#2 = #goparame#85;
    #canempr@#3 = #goparame#86;
    |LEE 000#canempr@.=;
    |SI FSalida ! 0; |DDEFECTO #canempr@; |FINSI;
    |CIERRA #canempr@;

    nMaxDigit = 0;
    |SI #canempr@#14 ] nMaxDigit; nMaxDigit = #canempr@#14; |FINSI;
    |SI #canempr@#15 ] nMaxDigit; nMaxDigit = #canempr@#15; |FINSI;
    |SI #canempr@#16 ] nMaxDigit; nMaxDigit = #canempr@#16; |FINSI;
    |SI #canempr@#17 ] nMaxDigit; nMaxDigit = #canempr@#17; |FINSI;
    |SI #canempr@#18 ] nMaxDigit; nMaxDigit = #canempr@#18; |FINSI;
    |SI #canempr@#19 ] nMaxDigit; nMaxDigit = #canempr@#19; |FINSI;

    |ABRE #cacuent@;
    |SI nTecla = 10;
      #cacuent@#0 = #guerz300#Campo#;
      |LEE 000#cacuent@.];
      |CONSULTA_CLAVE #1#cacuent@;
      |SI FSalida = 0;
         #guerz300#Campo# = #cacuent@#0; |PINTA #guerz300#Campo#;
         nCalc = Campo + 4;
         #guerz300#nCalc# = #cacuent@#2; |PINTA #guerz300#nCalc#;
      |FINSI;
    |FINSI;

    aAlfa = #guerz300#Campo#; |QBF aAlfa;
    aAlfa = aAlfa - ".";
    |PARA; |SI FSalida !0; |HACIENDO;
       aAlfa1 = aAlfa % 0; nCalc = aAlfa1;
       nCalc = nMaxDigit - nCalc;
       aAlfa1 = "0" * nCalc;
       nCalc = FSalida + 98; aAlfa1 = aAlfa1 + (aAlfa % nCalc);
       nCalc = ((FSalida / 100) ! 0) + 99;
       aAlfa1 = (aAlfa % nCalc) + aAlfa1; aAlfa = aAlfa1;
       aAlfa = aAlfa - ".";
    |SIGUE;
    #guerz300#Campo# = aAlfa; |PINTA #guerz300#Campo#;

    aAlfa = #guerz300#Campo#; |QBF aAlfa;
    aAlfa = aAlfa % 0; nCalc = aAlfa;
    |SI nCalc = #canempr@#14; #cacuent@#1 = 1; |FINSI;
    |SI nCalc = #canempr@#15; #cacuent@#1 = 2; |FINSI;
    |SI nCalc = #canempr@#16; #cacuent@#1 = 3; |FINSI;
    |SI nCalc = #canempr@#17; #cacuent@#1 = 4; |FINSI;
    |SI nCalc = #canempr@#18; #cacuent@#1 = 5; |FINSI;
    |SI nCalc = #canempr@#19; #cacuent@#1 = 6; |FINSI;
    #cacuent@#0 = #guerz300#Campo#;
    |LEE 000#cacuent@.=;
    |SI FSalida ! 0;
       |MENAV "    Cuenta inexistente";
       |ERROR; |ACABA;
    |SINO;
       |SI #cacuent@#3 = "N";
         aAlfa = "    NEsta seleccionando una cuenta sin pase directo. " + &191 + " Continuar ? ";
         |CONFI aAlfa;
         |SI FSalida ! 0; |ERROR; |FINSI;
       |SINO;
         nCalc = Campo + 4;
         #guerz300#nCalc# = #cacuent@#2; |PINTA #guerz300#nCalc#;
       |FINSI;
    |FINSI;

    |CIERRA #canempr@; |DESCARGA_DEF #canempr@;
    |CIERRA #cacuent@; |DESCARGA_DEF #cacuent@;
    nTecla = 0;
|FPRC;

|PROCESO MiraDia;
   |SI FSalida = 2; |ACABA; |FINSI;
   nTecla = FSalida;

   aAlfa = #goparame#84; |QBF aAlfa;
   aAlfa1 = aAlfa + "def/camandia.mas";
   |CARGA_DEF aAlfa1, camandi@;
   |SI FSalida ! 0;
      |MENAV "    No encuentro el fichero de diarios";
      |ERROR; |ACABA;
   |FINSI;

   aAlfa1 = aAlfa + "fich/" + (("00000" + #goparame#85) % -105) + #goparame#86 + "/";
   |PATH_DAT #camandi@#aAlfa1#;

   |ABRE #camandi@;
   |SI nTecla = 10;
      #camandi@#0 = #guerz300#Campo#;
      |LEE 000#camandi@.];
      |CONSULTA_CLAVE #1#camandi@;
      |SI FSalida = 0;
         #guerz300#Campo# = #camandi@#0; |PINTA #guerz300#Campo#;
         #guerz300#8 = #camandi@#1; |PINTA #guerz300#8;
      |FINSI;
    |FINSI;

    #camandi@#0 = #guerz300#Campo#;
    |LEE 000#camandi@.=;
    |SI FSalida ! 0;
       |MENAV "    Diario inexistente";
       |ERROR; |ACABA;
    |SINO;
       #guerz300#8 = #camandi@#1; |PINTA #guerz300#8;
    |FINSI;

    |CIERRA #camandi@; |DESCARGA_DEF #camandi@;
|FPRC;

|PROCESO MiraCpt;
   |SI FSalida = 2; |ACABA; |FINSI;
   nTecla = FSalida;

   aAlfa = #goparame#84; |QBF aAlfa;
   aAlfa1 = aAlfa - "contagen/";
   |SI FSalida ! 0;
      aAlfa1 = aAlfa1 + "modelos/def/dsmom030.mas";
   |SINO;
      aAlfa1 = aAlfa + "def/caconcep.mas";
   |FINSI;

   |CARGA_DEF aAlfa1, caconce@;
   |SI FSalida ! 0;
      |MENAV "    No encuentro el fichero de conceptos automaticos";
      |ERROR; |ACABA;
   |FINSI;

   aAlfa = #goparame#84; |QBF aAlfa;
   aAlfa1 = aAlfa - "contagen/";
   |SI FSalida ! 0;
      aAlfa1 = aAlfa1 + "modelos/fich/";
   |SINO;
      aAlfa1 = aAlfa + "fich/" + (("00000" + #goparame#85) % -105) + #goparame#86 + "/";
   |FINSI;
   |PATH_DAT #camandi@#aAlfa1#;

   |ABRE #caconce@;
   |SI nTecla = 10;
      #caconce@#0 = #guerz300#Campo#;
      |LEE 000#caconce@.];
      |CONSULTA_CLAVE #1#caconce@;
      |SI FSalida = 0;
         #guerz300#Campo# = #caconce@#0; |PINTA #guerz300#Campo#;
         #guerz300#9 = #caconce@#1; |PINTA #guerz300#9;
      |FINSI;
    |FINSI;

    #caconce@#0 = #guerz300#Campo#;
    |LEE 000#caconce@.=;
    |SI FSalida ! 0;
       |MENAV "    Concepto inexistente";
       |ERROR; |ACABA;
    |SINO;
       #guerz300#9 = #caconce@#1; |PINTA #guerz300#9;
    |FINSI;

    |CIERRA #caconce@; |DESCARGA_DEF #caconce@;
|FPRC;

|PROCESO guerm001;
   aAlfa = #guerm001#1; |QBF aAlfa; aAlfa = aAlfa % 0402;
   #guerw300#0 = aAlfa;
   aAlfa = #guerm001#1; |QBF aAlfa; aAlfa = aAlfa % 0704;
   #guerw300#1 = aAlfa;
   #guerw300#2 = #guerm001#15;
   #guerw300#3 = #guerm001#3;
   #guerw300#4 = #guerm001#29;
   |LEE 000#guerw300.=;
   |SI FSalida ! 0;
      #guerm009#0 = #guerm001#3;
      #guerm009#2 = #guerm001#29;
      |LEE 000#guerm009.=;
      |SI FSalida ! 0;
         |DDEFECTO #guerm009;
      |SINO;
         |SI #guerm009#11 = "N"; |ACABA; |FINSI;
      |FINSI;

      #guerm300#0 = #guerm009#12;
      |LEE 000#guerm300.=;
      |SI FSalida ! 0; |DDEFECTO #guerm300; |FINSI;
      aCtaDEBE = #guerm300#2;

      #guerm300#0 = #guerm001#15;
      |LEE 000#guerm300.=;
      |SI FSalida ! 0; |DDEFECTO #guerm300; |FINSI;
      aCtaHABER = #guerm300#2;

      aAlfa = #guerm001#1; |QBF aAlfa; aAlfa = aAlfa % 0402;
      |DDEFECTO #guerw300;
      aAlfa = #guerm001#1; |QBF aAlfa; aAlfa = aAlfa % 0402;
      #guerw300#0 = aAlfa;
      aAlfa = #guerm001#1; |QBF aAlfa; aAlfa = aAlfa % 0704;
      #guerw300#1 = aAlfa;
      #guerw300#2 = #guerm001#15;
      #guerw300#3 = #guerm001#3;
      #guerw300#4 = #guerm001#29;
      #guerw300#5 = aCtaDEBE;
      #guerw300#6 = aCtaHABER;
      |GRABA 020#guerw300.c;
   |FINSI;
   #guerw300#7 = #guerw300#7 + #guerm001#22;
   |GRABA 020#guerw300.a;

   nSwHay = 1;
|FPRC;

|DEFBUCLE guerm001;
#guerm001#1;
;
INICIO;
FINAL;
;
NULL,guerm001;
|FIN;

|PROCESO guerm205;
   aAlfa = #guerm205#1; |QBF aAlfa; aAlfa = aAlfa % 0402;
   #guerw300#0 = aAlfa;
   aAlfa = #guerm205#1; |QBF aAlfa; aAlfa = aAlfa % 0704;
   #guerw300#1 = aAlfa;
   #guerw300#2 = #guerm205#15;
   #guerw300#3 = "000000";
   #guerw300#4 = 0;
   |LEE 000#guerw300.=;
   |SI FSalida ! 0;
      #guerm300#0 = #guerm205#53;
      |LEE 000#guerm300.=;
      |SI FSalida ! 0; |DDEFECTO #guerm300; |FINSI;
      aCtaDEBE = #guerm300#2;

      #guerm300#0 = "N";
      |LEE 000#guerm300.=;
      |SI FSalida ! 0; |DDEFECTO #guerm300; |FINSI;
      aCtaHABER = #guerm300#2;

      aAlfa = #guerm205#1; |QBF aAlfa; aAlfa = aAlfa % 0402;
      |DDEFECTO #guerw300;
      aAlfa = #guerm205#1; |QBF aAlfa; aAlfa = aAlfa % 0402;
      #guerw300#0 = aAlfa;
      aAlfa = #guerm205#1; |QBF aAlfa; aAlfa = aAlfa % 0704;
      #guerw300#1 = aAlfa;
      #guerw300#2 = #guerm205#15;
      #guerw300#3 = "000000";
      #guerw300#4 = 0;
      #guerw300#5 = aCtaDEBE;
      #guerw300#6 = aCtaHABER;
      |GRABA 020#guerw300.c;
   |FINSI;
   #guerw300#7 = #guerw300#7 + #guerm205#22;
   |GRABA 020#guerw300.a;

   nSwHay = 1;
|FPRC;

|DEFBUCLE guerm205;
#guerm205#1;
;
INICIO;
FINAL;
;
NULL,guerm205;
|FIN;

|PROCESO GrabaAsto;
   |SI #guerw300#7 = 0; |ACABA; |FINSI;

   fFecha = #guerz300#12;
   nDiario = #guerz300#4;

   #agifa722#0 = aClase;
   nCalc = #guerw300#0 + 1;
   aCmp1 = "01." + (("00" + nCalc) % -102) + "." + #guerw300#1; fFecha = aCmp1;
   nCalc = fFecha; nCalc = nCalc - 1; fFecha = nCalc; aCmp1 = fFecha;
   #agifa722#1 = aCmp1; aCmp1 = #agifa722#1;
   #agifa722#2 = #guerw300#2+#guerw300#3;
   aCmp2 = ("00000" + #guerw300#4) % -105;
   #agifa722#3 = aCmp2; aCmp2 = #agifa722#3;
   #agifa722#8 = #goparame#85;
   #agifa722#9 = #goparame#86;
   #agifa722#11 = 1;
   |LEE 000#agifa722.=;
   |SI FSalida ! 0;
      |LEE 101#caconas@.p;
      |SI FSalida ! 0;
         |DDEFECTO #caconas@;
         |GRABA 020#caconas@.n;
         |LEE 101#caconas@.p;
      |FINSI;

      #caconas@#1 = #caconas@#1 + 1;
      aAlfa = "|NC"; nCalc = #caconas@#aAlfa#;
      |SI nCalc > 2; #caconas@#2 = #caconas@#2 + 1; |FINSI;
      nDocum = #caconas@#1;
      |GRABA 020#caconas@.a;
      |LIBERA #caconas@;

      #camasic@#0 = nDiario;
      #camasic@#1 = fFecha;
      #camasic@#2 = nDocum;
      |LEE 000#camasic@.=;
      |SI FSalida = 0;
         #camasic@#0 = nDiario;
         #camasic@#1 = fFecha;
         #camasic@#2 = 999999;
         |LEE 000#camasic@.];
         |SI FSalida = 0;
            |SI #camasic@#0 = nDiario; |Y #camasic@#1 = fFecha;
               nDocum = 1;
            |SINO;
               |LEE 000#camasic@.a;
               |SI FSalida = 0;
                  |SI #camasic@#0 = nDiario; |Y #camasic@#1 = fFecha;
                      nDocum = #camasic@#2 + 1;
                  |SINO;
                     nDocum = 1;
                  |FINSI;
               |SINO;
                  nDocum = 1;
               |FINSI;
            |FINSI;
         |SINO;
            |LEE 000#camasic@.u;
            |SI FSalida = 0;
               |SI #camasic@#0 = nDiario; |Y #camasic@#1 = fFecha;
                  nDocum = #camasic@#2 + 1;
               |SINO;
                  nDocum = 1;
               |FINSI;
            |SINO;
               nDocum = 1;
            |FINSI;
         |FINSI;
      |FINSI;

      |DDEFECTO #agifa722;
      #agifa722#0 = aClase;
      #agifa722#1 = aCmp1;
      #agifa722#2 = #guerw300#2+#guerw300#3;
      #agifa722#3 = aCmp2;
      #agifa722#4 = nDiario;
      #agifa722#5 = fFecha;
      #agifa722#6 = nDocum;
      #agifa722#7 = 10;
      #agifa722#8 = #goparame#85;
      #agifa722#9 = #goparame#86;
      #agifa722#11 = 1;
      |GRABA 020#agifa722.n;
   |SINO;
      |DDEFECTO #caenlac@;
      #caenlac@#0 = nDiario;
      #caenlac@#1 = fFecha;
      #caenlac@#2 = #agifa722#6;
      #caenlac@#3 = 1;
      #caenlac@#25 = "S";
      #caenlac@#37 = #goparame#85;
      #caenlac@#38 = #goparame#86;
      |GRABA 020#caenlac@.n;
      nDocum = #agifa722#6;
   |FINSI;

   nLinea = 10;
   |DDEFECTO #caenlac@;
   #caenlac@#0 = nDiario;
   #caenlac@#1 = fFecha;
   #caenlac@#2 = nDocum;
   #caenlac@#3 = nLinea; nLinea = nLinea + 10;
   #caenlac@#4 = #guerz300#2;
   #caenlac@#5 = 0;
   #caenlac@#6 = #guerz300#5;

   aAlfa = #guerz300#9; |QBF aAlfa;
   aAlfa = aAlfa + " " + (("00" + #guerw300#0) % -102) + "/" + #guerw300#1;
   |SI PARAMETRO ! "TRANS";
      aAlfa = aAlfa + " " + #guerw300#2 + "/" + #guerw300#3 + "-" + #guerw300#4;
   |FINSI;
   #caenlac@#7  = aAlfa;
   |SI #guerw300#6 ] 0;
      #caenlac@#8 = "D";
      #caenlac@#9 = #guerw300#7;
   |SINO;
      #caenlac@#8 = "H";
      #caenlac@#9 = -#guerw300#7;
   |FINSI;
   #caenlac@#37 = #goparame#85;
   #caenlac@#38 = #goparame#86;
   #caenlac@#39 = #guerw300#5;
   |GRABA 020#caenlac@.n;

   |DDEFECTO #caenlac@;
   #caenlac@#0 = nDiario;
   #caenlac@#1 = fFecha;
   #caenlac@#2 = nDocum;
   #caenlac@#3 = nLinea; nLinea = nLinea + 10;
   #caenlac@#4 = #guerz300#3;
   #caenlac@#5 = 0;
   #caenlac@#6 = #guerz300#5;

   aAlfa = #guerz300#9; |QBF aAlfa;
   aAlfa = aAlfa + " " + (("00" + #guerw300#0) % -102) + "/" + #guerw300#1;
   aAlfa = aAlfa + " " + #guerw300#2 + "/" + #guerw300#3 + "-" + #guerw300#4;

   #caenlac@#7  = aAlfa;
   |SI #guerw300#6 ] 0;
      #caenlac@#8 = "H";
      #caenlac@#9 = #guerw300#7;
   |SINO;
      #caenlac@#8 = "D";
      #caenlac@#9 = -#guerw300#7;
   |FINSI;
   #caenlac@#37 = #goparame#85;
   #caenlac@#38 = #goparame#86;
   #caenlac@#39 = #guerw300#6;
   |GRABA 020#caenlac@.n;

   #goparame#86 = nPerAnt;
   nSwHay = 1;
|FPRC;

|DEFBUCLE Asientos;
#guerw300#1;
;
INICIO;
FINAL;
;
NULL, GrabaAsto;
|FIN;

|PROCESO MarcaFac2;
   #guerm001#41 = "S";
   |GRABA 020#guerm001.a;
|FPRC;

|DEFBUCLE MarcaFac2;
#guerm001#6;
;
fDFecha, 000001;
fHFecha, 999999;
be;
NULL, MarcaFac2;
|FIN;

|PROCESO MarcaFac1;
   #guerm205#55 = "S";
   |GRABA 020#guerm205.a;
|FPRC;

|DEFBUCLE MarcaFac1;
#guerm205#6;
;
fDFecha, 000001;
fHFecha, 999999;
be;
NULL, MarcaFac1;
|FIN;

|PROCESO MarcaCont;
   |SI #guerw300#7 ! 0;
      aAlfa = "01." + (("00" + #guerw300#0) % -102) + "." + #guerw300#1; fDFecha = aAlfa;
      aAlfa = "31." + (("00" + #guerw300#0) % -102) + "." + #guerw300#1; fHFecha = aAlfa;
      |SI PARAMETRO = "TRANS";
         |BUCLE MarcaFac1;
      |SINO;
         |BUCLE MarcaFac2;
      |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE MarcaCont;
#guerw300#1;
;
INICIO;
FINAL;
;
NULL, MarcaCont;
|FIN;

|PROCESO Asientos;
     |SI PARAMETRO = "TRANS";
        aAlfa = "SELECT * FROM guerm205 INTO go" + Usuario + " WHERE 53 == 'C' AND 51 == 'S' AND ";
        aAlfa = aAlfa + "1 BETWEEN '" + #guerz300#0 + "','" + #guerz300#1 + "'";
     |SINO;
        aAlfa = "SELECT * FROM guerm001 INTO go" + Usuario + " WHERE ";
        aAlfa = aAlfa + "1 BETWEEN '" + #guerz300#0 + "','" + #guerz300#1 + "' AND ";
        aAlfa = aAlfa + "36 == 'S'";
     |FINSI;
     |SQL aAlfa;

     |SI FSalida = 0;
        aAlfa = "go" + Usuario;
        |SI PARAMETRO = "TRANS";
           |NOME_DAT #guerm205#aAlfa#;
           nSwHay = 0; |BUCLE guerm205;
        |SINO;
           |NOME_DAT #guerm001#aAlfa#;
           nSwHay = 0; |BUCLE guerm001;
        |FINSI;
     |FINSI;

     |SI nSwHay = 0;
        |CIERRA #guerw300; |CIERRA #agifa722; |ACABA;
     |FINSI;

     aAlfa = #goparame#84; |QBF aAlfa;
     aAlfa = aAlfa + "def/caenlace.mas";
     |CARGA_DEF aAlfa, caenlac@;
     |SI FSalida = 0;
        aAlfa = #goparame#84; |QBF aAlfa;
        aAlfa = aAlfa + "def/caconasi.mas";
        |CARGA_DEF aAlfa, caconas@;
        |SI FSalida = 0;
           aAlfa = #goparame#84; |QBF aAlfa;
           aAlfa = aAlfa + "def/camaasic.mas";
           |CARGA_DEF aAlfa, camasic@;
           |SI FSalida = 0;
              aAlfa = #goparame#84; |QBF aAlfa;
              aAlfa = aAlfa + "def/canempre.mas";
              |CARGA_DEF aAlfa, canempr@;
              |SI FSalida = 0;

                 nPerAnt = #goparame#86;
                 #canempr@#2 = #goparame#85;
                 #canempr@#3 = #goparame#86;
                 |LEE 000#canempr@.=;
                 |SI FSalida = 0;
                    nBusca = 0;
                    aAlfa = #guerz300#11; |QBF aAlfa;
                    aAlfa = aAlfa % -102; nCalc = aAlfa;
                    |SI nCalc ! #canempr@#26;
                       |PARA; |SI FSalida = 0; |Y #canempr@#2 = #goparame#85; |HACIENDO;
                          |LEE 000#canempr@.s;
                          |SI nCalc = #canempr@#26; nBusca = 1; |SAL; |FINSI;
                       |SIGUE;
                       |SI nBusca = 1;
                          nPerAnt = #goparame#86;
                          #goparame#85 = #canempr@#2;
                          #goparame#86 = #canempr@#3;
                       |FINSI;
                    |FINSI;
                 |FINSI;

                 aAlfa = #goparame#84; |QBF aAlfa;
                 aAlfa = aAlfa + "fich/";
                 |PATH_DAT #canempr@#aAlfa#;
                 aAlfa = #goparame#84; |QBF aAlfa;
                 aAlfa = aAlfa + "fich/" + (("00000" + #goparame#85) % -105) + #goparame#86 + "/";
                 |PATH_DAT #caenlac@#aAlfa#; |PATH_DAT #camasic@#aAlfa#;
                 |PATH_DAT #caconas@#aAlfa#;
                 aAlfa = "pu" + Usuario; |QBF aAlfa; |NOME_DAT #caenlac@#aAlfa#;
                 |DELINDEX #caenlac@; |ABRE #caenlac@;
                 |ABRE #caconas@; |ABRE #camasic@; |ABRE #canempr@;
                 nSwHay = 0;

                 |BUCLE Asientos;

                 |SI nSwHay = 1;
                    |HAZ CogeVersion;
                    aAlfa = #goparame#84; |QBF aAlfa;
                    aAlfa = aAlfa + "fich/" + (("00000" + #goparame#85) % -105) + #goparame#86 + "/";
                    fich_alta = aAlfa;
                    aAlfa1 = #goparame#84; |QBF aAlfa1;
                    aAlfa1 = aAlfa1 - "contagen";
                    |SI FSalida ! 0;
                       aAlfa1 = ":contagen/dsapunte.tab;";
                    |SINO;
                       aAlfa1 = ":agicont/dsapunte.tab;";
                    |FINSI;
                    enNoModif = 100;
                    aAlfa = aAlfa1 + aAlfa + ",pu" + Usuario;
                    |CIERRA #caenlac@;
                    |SUB_EJECUTA_NP aAlfa;
                    |ABRE #caenlac@; |LEE 000#caenlac@.c;

                    |SI PRMNT_enError = 0;
                       |SI PARAMETRO = "TRANS";
                          aAlfa = "guerm205"; |NOME_DAT #guerm205#aAlfa#;
                       |SINO;
                          aAlfa = "guerm001"; |NOME_DAT #guerm001#aAlfa#;
                       |FINSI;
                       |BUCLE MarcaCont;
                    |FINSI;
                 |FINSI;
              |FINSI;
              |CIERRA #canempr@; |DESCARGA_DEF #canempr@;
              |CIERRA #camasic@; |DESCARGA_DEF #camasic@;
              |CIERRA #caconas@; |DESCARGA_DEF #caconas@;
              |CIERRA #caenlac@; |DELINDEX #caenlac@; |DESCARGA_DEF #caenlac@;
           |FINSI;
        |FINSI;
     |SINO;
        |CIERRA #guerw300; |ACABA;
     |FINSI;
     |CIERRA #agifa722;

     |CIERRA #guerw300; |DELINDEX #guerw300;
|FPRC;

|PROCESO MiraMes;
   |SI #guerz300#10 = 1;  |PINTA 1236, "ENERO     "; |FINSI;
   |SI #guerz300#10 = 2;  |PINTA 1236, "FEBRERO   "; |FINSI;
   |SI #guerz300#10 = 3;  |PINTA 1236, "MARZO     "; |FINSI;
   |SI #guerz300#10 = 4;  |PINTA 1236, "ABRIL     "; |FINSI;
   |SI #guerz300#10 = 5;  |PINTA 1236, "MAYO      "; |FINSI;
   |SI #guerz300#10 = 6;  |PINTA 1236, "JUNIO     "; |FINSI;
   |SI #guerz300#10 = 7;  |PINTA 1236, "JULIO     "; |FINSI;
   |SI #guerz300#10 = 8;  |PINTA 1236, "AGOSTO    "; |FINSI;
   |SI #guerz300#10 = 9;  |PINTA 1236, "SEPTIEMBRE"; |FINSI;
   |SI #guerz300#10 = 10; |PINTA 1236, "OCTUBRE   "; |FINSI;
   |SI #guerz300#10 = 11; |PINTA 1236, "NOVIEMBRE "; |FINSI;
   |SI #guerz300#10 = 12; |PINTA 1236, "DICIEMBRE "; |FINSI;
|FPRC;

|PROCESO MiraAnyo;
   |SI FSalida = 2; |ACABA; |FINSI;

   aAlfa = "01." + (("00" + #guerz300#10) % -102) + "." + #guerz300#11;
   #guerz300#0 = aAlfa;
   nCalc = #guerz300#10 + 1; nCalc1 = #guerz300#11;
   |SI nCalc > 12; nCalc = 1; nCalc1 = nCalc1 + 1; |FINSI;
   aAlfa = "01." + (("00" + nCalc) % -102) + "." + nCalc1; fFecha = aAlfa;
   nCalc = fFecha; nCalc = nCalc - 1; fFecha = nCalc;
   #guerz300#1 = fFecha;
   #guerz300#12 = fFecha; |PINTA #guerz300#12;

   #agifa722#0 = aClase;
   nCalc = #guerz300#10 + 1;
   aCmp1 = "01." + (("00" + nCalc) % -102) + "." + #guerz300#11; fFecha = aCmp1;
   nCalc = fFecha; nCalc = nCalc - 1; fFecha = nCalc; aCmp1 = fFecha;
   #agifa722#1 = aCmp1; aCmp1 = #agifa722#1;
   #agifa722#2 = "";
   #agifa722#3 = "";
   #agifa722#8 = #goparame#85;
   #agifa722#9 = #goparame#86;
   #agifa722#11 = 1;
   |LEE 000#agifa722.];
   |PARA; |SI FSalida = 0; |Y #agifa722#0 = aClase; |Y #agifa722#1 = aCmp1; |HACIENDO;
      |SI #agifa722#8 = #goparame#85; |Y #agifa722#9 = #goparame#86;
         aAlfa = "    NEl mes indicado ya ha sido enlazado. " + &191 + " Continuar eliminando el enlace anterior ?";
         |CONFI aAlfa;
         |SI FSalida = 0;
            nSwErr = 0;
         |SINO;
            nSwErr = 1;
         |FINSI;
         |SAL;
      |FINSI;
      |LEE 000#agifa722.s;
   |SIGUE;

   |SI nSwErr = 1; |ERROR; |FINSI;
|FPRC;

|PROGRAMA;
   |CLS;
   |CABEZA "ASIENTO CONTABLE MOVTOS.ENTRE LINEAS FABRICACION";
   fFecha = ~; aAlfa = fFecha; |QBF aAlfa;
   aAlfa = aAlfa % -104; #guerz300#11 = aAlfa;

   |ABRE #goparame;
   |DDEFECTO #goparame;
   |LEE 000#goparame.p;
   |SI FSalida ! 0;
      |MENAV "    No existe el control de parametros";
      |CIERRA #goparame;
      |ERROR; |ACABA;
   |FINSI;
   |CIERRA #goparame;

   |SI PARAMETRO = "TRANS";
      aClase = "TR";
   |SINO;
      aClase = "CA";
   |FINSI;

   |ABRE #agifa722;

   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0; |Y nSwErr = 0;

      aAlfa = "t1" + Usuario; |NOME_DAT #guerw300#aAlfa#;
      |DELINDEX #guerw300; |ABRE #guerw300;
      |ABRE #guerm009; |ABRE #guerm300;

      aAlfa = "01." + (("00" + #guerz300#10) % -102) + "." + #guerz300#11; fDFecha = aAlfa;
      nCalc = #guerz300#10; nCalc = nCalc + 1; aAlfa1 = nCalc;
      aAlfa = "01." + (("00" + aAlfa1) % -102) + "." + #guerz300#11;
      fHFecha = aAlfa; nCalc = fHFecha;
      nCalc = nCalc - 1; fHFecha = nCalc;

      |HAZ Asientos;

      |CIERRA #guerm009; |CIERRA #guerm300;
      |CIERRA #guerw300; |DELINDEX #guerw300;
   |FINSI;

   |CIERRA #agifa722;
|FPRO;
