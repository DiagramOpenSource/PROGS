|FICHEROS;
     ialbz020 #0;
     agifa010 #10;
     ialbm023 #23;
     agifa134 #134;
|FIN;

|VARIABLES;
     &Tempo = "";
     nHay = 0;
     aAlfa = "";
     aTipo = "";
     aSer = "";
     aNum = "";
     nNum = 0;
|FIN;

|PROCESO Tecla; |TIPO 0;
     |SI #0Campo = Contenido; |Y FSalida = 0;
          |SI aTipo = "A";
               aAlfa = "dszx0007;V" + #0#0 + (("000000"+ #0#1) % -106);
          |SINO;
               aAlfa = "dszx0005;V" + #0#0 + (("000000"+ #0#1) % -106);
          |FINSI;
          |SUB_EJECUTA_NP aAlfa;
     |FINSI;
|FPRC;

|PROCESO Min;
     #0#0 = "     ";
     #0#1 = 1;
|FPRC;

|PROCESO Max;
     #0#0 = "zzzzz";
     #0#1 = 999999;
|FPRC;

|PROCESO Relacion;
     #10#52 = #23#2;
     #10#0 = #23#3;
     |LEE 020#10=;
     |SI FSalida = 0;
          |SI aTipo = "A";
               #0#0 = #10#52;
               #0#1 = #10#0;
               #0#2 = #10#3;
               #0#3 = #10#4;
               |GRABA 020#0n;
               nHay = 1;
          |SINO;
               #0#0 = #10#53;
               #0#1 = #10#39;
               #0#2 = #10#3;
               #0#3 = #10#4;
               |SI #10#38 = "S";
                    #134#49 = #0#0;
                    #134#0 = #0#1;
                    |LEE 020#134=;
                    |SI FSalida = 0;
                         |GRABA 020#0n;
                         nHay = 1;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE Relacion;
     #23#1;
     ;
     aSer, nNum, 001;
     aSer, nNum, 999;
     ;
     NULL, Relacion;
|FIN;

|PROGRAMA;
     aTipo = PARAMETRO % 101;
     aSer = PARAMETRO % 205;
     aNum = PARAMETRO % 706;
     nNum = aNum;

     |HAZ CreaTempo; |NOME_DAT #0 Tempo; |DELINDEX #0;
     |ABRE #0;
     |ABRE #10;
     |ABRE #134;
     |BUCLE Relacion;
     |CIERRA #134;
     |CIERRA #10;
     |CIERRA #0;
     |SI nHay ! 0;
          |PINPA #0#0;
          |SI aTipo = "A";
               |ATRI R; |PINTA 0516, "ALBARANES"; |ATRI 0;
          |SINO;
               |ATRI R; |PINTA 0516, "FACTURAS "; |ATRI 0;
          |FINSI;
          |ENTLINEAL #1#0, 1, 4, 22, 0, Min, Max;
     |SINO;
          |MENAV "0000No hay registros...";
     |FINSI;
     |HAZ BoraTempo; |DELINDEX #0;
|FPRO;
