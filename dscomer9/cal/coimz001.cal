|FICHEROS;
     coimz001 #0;
     coimw001 #1,MANTE;
     coima002 #2;
     coima003 #3;
     coima004 #4;
     coima005 #5;
     coima001 #10;
     coima015 #15;
     agifa017 #17;
     agifa019 #19;
     dsm00020 #20;
     coima027 #27;
     agifa029 #29;
     agifa041 #41;
     dsm00054 #54;
     dsm00055 #55;
     agifa067 #67;
     agifa077 #77;
     agifa080 #80;
     agifa081 #81;
     agifa112 #112;
     agifa142 #142;
     agifa321 #321;
     agifa324 #324;
     tempo134 #134;
|FIN

|VARIABLES;
     &Tempo = "";
     aTmp134 = "";
     nSwMarca = 0;
 {-1}aMenu = "";
     aMenu1 = "2400";
     aMenu2 = "1";
     aMenu3 = "Opciones:";
     aMenu4 = "RAC";
     aMenu5 = " Repasar ";
     aMenu6 = " Aceptar ";
     aMenu7 = " Cancelar ";
     &eaProgVta = "";
     &enSwMenu = 0;
     &aMoneda = "";
     &aDivisa = "";
     &enPrecioB = 0;
     &precio_base = 0;
     &nDeci_PreBase = 0;
     &enDeciB = 0;
     &enForma = 1;
     &eaDocu = "";
     &enImpPrvCom = 0;
     &efFecha = @;
     &eaProve = "";

     nProFin = 0;
     nImpo = 0;
     aMes = "";
     nMes = 0;
     aDirEmp = "";
     aDatos = "";
     nCodEmp = 0;
     nLinea = 0;
     nForma = 0;
     aPed = "";
     aPrv = "";
     aPedido = "";
     aAlfa = "";
     nHay = 0;
     nProceso = 0;
     nFecha = 0;
     nPrime = 0;
     nLin = 0;
     nError = 0;
     nDespre = 0;
     aSerMov = "";
     nConta = 0;
     nLinMov = 0;
     i = 0;
     fHoy = @;
     nNum1 = 0;
     nNum2 = 0;
     nDias = 0;
|FIN;

|PROCESO FechaDispo;
     |HAZ ProFin;
     nFecha = #0#1;
     |ABRE #2;
     |PARA i = #0#3; |SI i [ nProFin; |HACIENDO i = i + 1;
          #2#0 = #0#2;
          #2#1 = i;
          |LEE 000#2=;
          |SI FSalida = 0;
               nFecha = nFecha + #2#3;
          |FINSI;
     |SIGUE;
     |CIERRA #2;
|FPRC;

|PROCESO Existe; |TIPO 0;
     |ABRE #4;
     #4#0 = #0#0;
     |LEE 000#4=;
     |SI FSalida = 0;
          |MENAV "0000Operación existente...";
          |ERROR;
     |FINSI;
     |CIERRA #4;
|FPRC;

|PROCESO Min2;
     #2#0 = #0#2;
     #2#1 = 0;
|FPRC;

|PROCESO Max2;
     #2#0 = #0#2;
     #2#1 = 99;
|FPRC;

|PROCESO Tipo66; |TIPO 66;
     |ABRE #2;
     #2#0 = #0#2;
     #2#1 = #0#3;
     |LEE 000#2];
     |CONSULTA_F_CLAVE #1#2, Min2, Max2;
     |SI FSalida = 0;
          #0#3 = #2#1; |PINTA #0#3;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #2;
|FPRC;

|PROCESO Contador; |TIPO 7;
     |SI #0#0 = 0;
          |ABRE #4;
          |LEE 000#4u;
          |SI FSalida = 0;
               #0#0 = #4#0 + 1;
          |SINO;
               #0#0 = 1;
          |FINSI;
          |CIERRA #4;
     |FINSI;
|FPRC;
-----------------------------------------------
|PROCESO MoviAlma;
     |ABRE #54;
     |ABRE #55;
     |SI aSerMov ! #77#50;
          #54#2 = #77#50;
          #54#0 = 999999;
          |LEE 000#54];
          |SI FSalida = 0;
               |LEE 000#54a;
          |SINO;
               |LEE 000#54u;
          |FINSI;
          |SI FSalida = 0; |Y #54#2 = #77#50;
               nConta = #54#0 + 1;
          |SINO;
               nConta = 1;
          |FINSI;
          |DDEFECTO #54;
          #54#2 = #77#50;
          #54#0 = nConta;
          |GRABA 020#54n;
          aSerMov = #77#50;
          nLinMov = 0;
     |FINSI;

     |ABRE #19;
     #19#0 = #1#9;
     |LEE 000#19=;
     |CIERRA #19;

     nLinMov = nLinMov + 1;
     |DDEFECTO #55;
     #55#28 = #54#2;
     #55#27 = #54#0;
     #55#11 = nLinMov;
     #55#0 = #1#9;
     #55#1 = #1#16;
     #55#5 = #10#3; ||Alma Saldo
     #55#4 = #1#13;
     #55#29  = #19#9;

     #55#7 = #19#6;
     |ABRE #17;
     #17#0 = #55#0;
     #17#1 = #55#1;
     |LEE 000#17=;
     |SI FSalida = 0;
          #55#3 = #17#5;
     |FINSI;
     #17#1 = #55#5;
     |LEE 000#17=;
     |SI FSalida = 0;
          #55#6 = #17#5;
     |FINSI;
     |CIERRA #17;
     |GRABA 020#55n;

     enForma = 1;
     eaProgVta = "dsm00054";
     |HAZ AcumulaME_MS;
     |CIERRA #55;
     |CIERRA #54;
|FPRC;
-----------------------------------------------
|PROCESO pcmlinea;
     enPrecioB = precio_base;
     enDeciB = nDeci_PreBase;
     enForma = 1;
     eaDocu = "agifa077";
     |HAZ StockEntra;

     nForma = 1;

     |ABRE #112;
     nImpo = (#80#9 < #77#5) < #77#32;
     |SI #142#114 = "S";
          nImpo = nImpo < #77#7;
     |FINSI;
     #112#0 = #77#3;
     |LEE 101#112=;
     |SI FSalida = 0;
         aMes = #77#1 % A402;
         nMes = aMes + 26;
         |SI #77#42 = "N";
             #112nMes = #112nMes + (nImpo * nForma);
             #112#39 = #112#39 + (nImpo * nForma);
         |SINO;
             #112nMes = #112nMes - (nImpo * nForma);
             #112#39 = #112#39 - (nImpo * nForma);
         |FINSI;
         |GRABA 020#112a;
         |LIBERA #112;
     |FINSI;
     |CIERRA #112;

     |SI #77#42 = "N";
          enImpPrvCom = nImpo * nForma;
     |SINO;
          enImpPrvCom = -nImpo * nForma;
     |FINSI;
     efFecha = #77#1;
     eaProve = #77#3;
     |HAZ AcumulaPrv;
|FPRC;

|PROCESO FinAlbaran;
     |BUCLELIN 0pcmlinea#77;

     |CIERRA #77;
     |CIERRA #80;
|FPRC;

|PROCESO ActPedido;
     |ABRE #81;
     |ABRE #67;
     #81#25 = #1#1;
     #81#0 = #1#2;
     |LEE 121#81=;
     |SI FSalida = 0;
          #67#28 = #1#1;
          #67#0 = #1#2;
          #67#1 = #1#3;
          |LEE 121#67=;
          |SI FSalida = 0;
               nDespre = 0;
               #67#38 = #67#38 + #80#5;
               |SI #1#17 = "S";    || Despreciar
                    nDespre = #67#38 - #67#5;
                    #67#12 = nDespre;
                    #67#5 = #67#5 + nDespre;
               |SINO;
                    |SI #67#38 > #67#5;
                         #67#12 = #67#38 - #67#5;
                         #67#5 = #67#38;
                         nDespre = #67#12;
                    |FINSI;
               |FINSI;
               |GRABA 020#67a;

               |ABRE #19;
               |ABRE #17;
               |DDEFECTO #19;
               #19#0 = #67#2;
               |LEE 101#19=;
               |SI FSalida ! 0; |GRABA 020#19b; |FINSI;
               #19#16 = #19#16 - #80#5 + nDespre;

               |DDEFECTO #17;
               #17#0 = #67#2;
               #17#1 = #67#3;
               |LEE 101#17=;
               |SI FSalida ! 0;
                    |DDEFECTO #29;
                    |ABRE #29;
                    #29#0 = #17#1;
                    |LEE 000#29=;
                    |CIERRA #29;
                    #17#40 = #19#1;
                    #17#41 = #29#1;
                    |GRABA 020#17b;
               |FINSI;
               #17#43 = #17#43 - #80#5 + nDespre;
               |HAZ ValoraStock;
               |GRABA 020#17a;
               |GRABA 020#19a;
               |CIERRA #17;
               |CIERRA #19;
          |FINSI;
          |HAZ CalCabAgifa081;
          |GRABA 020#81a;
     |FINSI;
     |CIERRA #67;
     |CIERRA #81;
|FPRC;

|PROCESO CabAlbaran;
     |ABRE #80;
     |ABRE #77;

     |ABRE #321; |LEE 000#321p; |CIERRA #321;

     |DDEFECTO #112;
     |ABRE #112;
     #112#0 = #1#6;
     |LEE 000#112=;
     |CIERRA #112;

     |DFICE aDirEmp;
     |DFICB aDatos;
     aDirEmp = aDirEmp % -205;
     nCodEmp = aDirEmp;
     |PATH_DAT #41 aDatos;
     |ABRE #41;
     #41#0 = nCodEmp;
     |LEE 020#41=;
     |CIERRA #41;

     |DDEFECTO #20;
     |ABRE #20;
     #20#0 = #112#87;
     |LEE 000#20=;
     |CIERRA #20;

     #77#50 = #1#1;
     enSwMenu = 1;
     |HAZ ContaAC7;
     |GRABA 020#77b;

     #77#3 = #112#0;
     #77#4 = #112#2;
     #77#5 = #112#24;
     #77#7 = #112#25;
     #77#8 = #112#17;
     #77#9 = #20#1;

     #77#29 = #41#1;        || nombre de la empresa
     #77#30 = #41#2;        || direccion de la empresa
     #77#31 = #41#3;        || poblacion de la empresa
     #77#33 = #41#4;        || provincia de la empresa

     #77#36 = #112#58;
     #77#52 = #112#78;

     |ABRE #324;
     #77#56 = #112#81;
     #324#0 = #77#56;
     |LEE 000#324=;
     #77#57 = #324#3;

     #77#61 = #321#9;
     #324#0 = #77#61;
     |LEE 000#324=;
     |LEE 000#324=;
     #77#62 = #324#3;

     #77#72 = #20#0;

     aMoneda = #77#58;
     aDivisa = #77#56;
     |HAZ Divisas077;

     |HAZ LimCabAgifa077;
|FPRC;

|PROCESO LinAlbaran;
     |DDEFECTO #19;
     |ABRE #19;
     #19#0 = #1#9;
     |LEE 000#19=;
     |CIERRA #19;

     |DDEFECTO #67;
     |ABRE #67;
     #67#28 = #1#1;
     #67#0 = #1#2;
     #67#1 = #1#3;
     |LEE 000#67=;
     |CIERRA #67;

     nLinea = nLinea + 1;
     |DDEFECTO #80;
     #80#27 = #77#50;
     #80#0 = #77#0;
     #80#1 = nLinea;
     #80#2 = #1#9;
     #80#3 = #1#16;
     #80#4 = #1#10;
     #80#5 = #1#12;
     #80#6 = #67#6; ||    Precio
     #80#11 = #67#14;
     #80#13 = #19#2;
     ||#80#14 =  ||Coste
     #80#15 = #77#3;
     #80#30 = #80#6;
     #80#43 = #19#205;
     #80#29 = #1#1;
     #80#12 = #1#2;
     #80#21 = #1#3;
     |HAZ ActPedido;
     |HAZ TotalLin80;
     |GRABA 020#80n;

     |HAZ CalCabAgifa077;
     #77#41 = #77#41 + 1;
     |GRABA 020#77a;

     eaDocu = "agifa080";
     |HAZ StockEntra;

     |SI #1#13 > 0;
          |HAZ MoviAlma;
     |FINSI;
|FPRC;

|PROCESO CreaAlbaran;
     |SI #1#15 ! "*";
          |ACABA;
     |FINSI;

    |SI #1#18 = "N"; |ACABA; |FINSI;

     aPedido = #1#1 + ((("000000")+#1#2)%-106);
     |SI #10#4 = "N"; aPed = aPedido; |FINSI;

     |SI aPrv ! #1#6; |O aPed ! aPedido;
          |SI nPrime = 1;
               |HAZ FinAlbaran;
          |FINSI;
          nPrime = 1;
          aPrv = #1#6;
          aPed = aPedido;
          nLinea = 0;
          |HAZ CabAlbaran;
     |FINSI;
     |HAZ LinAlbaran;
|FPRC;

|DEFBUCLE CreaAlbaran;
     #1#2;
     ;
     INICIO;
     FINAL;
     ;
     NULL, CreaAlbaran;
|FIN;
-----------------------------------------------
|PROCESO AltaHisto;
     |DDEFECTO #3;
     #3#0 = #1#0;
     #3#1 = #5#2;
     #3#2 = #5#3;
     #3#3 = #5#4;
     #3#4 = #5#0;
     #3#5 = #5#1;
     #3#6 = #4#1;
     #3#7 = #5#6;
     #3#8 = 0;
     #3#9 = #4#2;
     #3#10 = #5#7;
     |SI #4#3 = #1#6;
          #3#11 = #1#6;
          #3#12 = #1#7;
     |SINO;
          #3#11 = #4#3;
          |DDEFECTO #112;
          #112#0 = #3#11;
          |LEE 000#112=;
          #3#12 = #112#1;
     |FINSI;
     #3#13 = #1#9;
     #3#14 = #1#10;
     #3#15 = "N";
     |GRABA 020#3n;

     |DDEFECTO #27;
     #27#0 = #3#13;
     #27#1 = #3#16;
     |LEE 101#27=;
     |SI FSalida ! 0; |GRABA 020#27b; |FINSI;
     |SI #27#2 < #1#14;
          #27#2 = #1#14;
          #27#3 = #1#12;
     |FINSI;
     nNum1 = fHoy;
     nNum2 = #1#14;
     nDias = #1#14 - fHoy;
     |SI nDias < #10#5;
          |SI #1#17 = "S";
               #27#4 = #27#4 - #1#11;
          |SINO;
               #27#4 = #27#4 + #1#12;
          |FINSI;
     |SINO;
          |SI #1#17 = "S";
               #27#5 = #27#5 - #1#11;
          |SINO;
               #27#5 = #27#5 + #1#12;
          |FINSI;
     |FINSI;
     |GRABA 020#27a;
     |LIBERA #27;
|FPRC;

|PROCESO ActHisto;
     #3#0 = #1#0;
     #3#1 = #5#2;
     #3#2 = #5#3;
     #3#3 = #5#4;
     #3#4 = #5#8;
     #3#5 = #5#9;
     |LEE 121#3=;
     |SI FSalida = 0;
          #3#8 = #3#8 + #5#6;
          ||#3#10 = #5#7;
          |SI #3#7 = #3#8;
               #3#15 = "S";
          |SINO;
               #3#15 = "N";
          |FINSI;
          |SI #1#12 > #1#11; |O #1#17 = "S";
               #3#15 = "S";
          |FINSI;
          |GRABA 020#3a;
          |LIBERA #3;
     |FINSI;

     |DDEFECTO #27;
     #27#0 = #3#13;
     #27#1 = #3#16;
     |LEE 101#27=;
     |SI FSalida ! 0; |GRABA 020#27b; |FINSI;
     nNum1 = fHoy;
     nNum2 = #3#10;
     nDias = #3#10 - fHoy;
     |SI nDias < #10#5;
          |SI #1#17 = "S";
               #27#4 = #27#4 - #1#11;
          |SINO;
               #27#4 = #27#4 - #1#12;
          |FINSI;
     |SINO;
          |SI #1#17 = "S";
               #27#5 = #27#5 - #1#11;
          |SINO;
               #27#5 = #27#5 - #1#12;
          |FINSI;
     |FINSI;
     |GRABA 020#27a;
     |LIBERA #27;
|FPRC;

|PROCESO LinProceso;
     nLin = nLin + 1;
     |DDEFECTO #5;
     #5#0 = #4#0;
     #5#1 = nLin;
     #5#2 = #1#1;
     #5#3 = #1#2;
     #5#4 = #1#3;
     #5#5 = #1#11;
     #5#6 = #1#12;
     #5#7 = #1#14;
     #5#8 = #1#4;
     #5#9 = #1#5;
     |GRABA 020#5n;
|FPRC;

|PROCESO CabProceso;
     |DDEFECTO #4;
     #4#0 = #0#0;
     #4#1 = #0#3;
     #4#2 = #0#1;
     #4#3 = #1#6;
     #4#4 = #1#2;
     |GRABA 020#4n;

     #134#1 = #4#0;
     |GRABA 020#134n;
|FPRC;

|PROCESO Tmp;
     |SI #1#15 ! "*";
          |ACABA;
     |FINSI;
     |SI nPrime = 0;
          nPrime = 1;
          |HAZ CabProceso;
     |SINO;
          FSalida = 0;
     |FINSI;
     |SI FSalida = 0;
          |HAZ LinProceso;
          |HAZ ActHisto;
          |HAZ ProFin;
          |SI #1#18 = "N";
               |HAZ AltaHisto;
          |FINSI;
     |SINO;
          nError = 1;
          |MENAV "0000Proceso cancelado...";
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE Tmp;
     #1#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp;
|FIN;

|PROCESO ProFin;
     |ABRE #15;
     |ABRE #19;
     |DDEFECTO #19;
     #19#0 = #1#9;
     |LEE 000#19=;
     #15#0 = #19#2;
     |LEE 000#15=;
     |SI FSalida = 0;
          |SI #0#3 > #15#2;
               nProFin = #10#0;
          |SINO;
               nProFin = #15#2;
          |FINSI;
     |SINO;
          nProFin = #10#0;
     |FINSI;
     |CIERRA #19;
     |CIERRA #15;
|FPRC;

|PROCESO MaxUni; |TIPO 0;
     |SI #1#12 < #1#11;
          #1#17 = "N";
          |AVISO;
          |CONFI "0000NDespreciar unidades restantes?";
          |SI FSalida = 0;
               #1#17 = "S";
          |FINSI;
          |GRABA 020#1a;
     |FINSI;
|FPRC;

|PROCESO Tecla; |TIPO 11;
     |SI FSalida = 10;
          |SI #1#15 = "*";
               #1#12 = 0;
               #1#13 = 0;
               #1#14 = "01.01.0000";
               #1#15 = "";
               |GRABA 020#1a;
          |SINO;
            |ET E1;
               #1#12 = #1#11;
               |ENCAMPO #12#1;
               |SI FSalida ! 0; |Y FSalida ! 3; |VETE Fin; |FINSI;

            |ET E2;
               |ENCAMPO #18#1;
               |SI FSalida ! 0; |Y FSalida ! 3; |VETE Fin; |FINSI;

            |ET E3;
               |SI #1#18 = "S";
                    |ENCAMPO #13#1;
                    |SI FSalida = 2; |VETE E2; |FINSI;
                    |SI FSalida ! 0; |Y FSalida ! 3; |VETE Fin; |FINSI;
               |FINSI;
               |HAZ FechaDispo;
               #1#14 = nFecha;
               |ENCAMPO #14#1;
               |SI FSalida = 2;
                    |SI nProFin = #0#3; |VETE E2; |SINO; |VETE E1; |FINSI;
               |FINSI;
               |SI FSalida ! 0; |Y FSalida ! 3; |VETE Fin; |FINSI;
               #1#15 = "*";
               |GRABA 020#1a;
             |ET Fin;
          |FINSI;
          |LEE 000#1=;
          |PINTA #1#12;
          |PINTA #1#13;
          |PINTA #1#14;
          |PINTA #1#15;
     |FINSI;
     |SI FSalida = 13;
          nSwMarca = 1;
          |PTEC 807;
     |FINSI;
     |SI FSalida = 12;
          nSwMarca = 2;
          |PTEC 807;
     |FINSI;
|FPRC;

|PROCESO Historico;
     |SI #3#7 > #3#8;
          nHay = 1;
          #1#0 = #3#0;
          #1#1 = #3#1;
          #1#2 = #3#2;
          #1#3 = #3#3;
          #1#4 = #3#4;
          #1#5 = #3#5;
          |SI #0#4 ! "000000";
               #1#6 = #0#4;
               |DDEFECTO #112;
               #112#0 = #1#6;
               |LEE 000#112=;
               #1#7 = #112#1;
          |SINO;
               #1#6 = #3#11;
          |FINSI;
          #1#7 = #3#12;
          #1#8 = #3#9;
          #1#9 = #3#13;
          #1#10 = #3#14;
          #1#11 = #3#7 - #3#8;
          #1#12 = 0;
          #1#13 = 0;
          #1#14 = "01.01.0000";
          #1#15 = "";
          #1#16 = #3#16;
          #1#18 = "N";
          |HAZ ProFin;
          |SI #0#3 = nProFin;
               #1#18 = "S";
          |FINSI;
          |GRABA 020#1n;
     |FINSI;
|FPRC;

|DEFBUCLE Historico;
     #3#1;
     11, 15, 6, 13;
     "C", #0#11, #0#13, 001, #0#8, 000, #0#6, "N", nProceso, #0#15;
     "C", #0#12, #0#14, 999, #0#9, 999, #0#7, "N", nProceso, #0#16;
     ;
     NULL, Historico;
|FIN;

|PROCESO Min;
     #1#9 = " " * 20;
     #1#8 = "01.01.0000";
     #1#1 = "     ";
     #1#2 = 000000;
     #1#3 = 000;
|FPRC;

|PROCESO Max;
     #1#9 = "z" * 20;
     #1#8 = "31.12.9999";
     #1#1 = "zzzzz";
     #1#2 = 999999;
     #1#3 = 999;
|FPRC;

|PROCESO MarcaTodo;
     |SI nSwMarca = 1;
          |SI #1#15 ! "*";
               #1#12 = #1#11;
               |HAZ FechaDispo;
               #1#14 = nFecha;
               #1#15 = "*";
          |FINSI;
     |SINO;
          #1#12 = 0;
          #1#14 = "01.01.0000";
          #1#15 = "";
     |FINSI;
     |GRABA 020#1a;
|FPRC;

|DEFBUCLE MarcaTodo;
     #1#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, MarcaTodo;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     fHoy = ~;
     |ABRE #10; |LEE 000#10p; |CIERRA #10;

     nProceso = #0#3 - 1;
     aAlfa = Usuario;
     |NOME_DAT #1 aAlfa;
     |DELINDEX #1;
     |ABRE #1;
     |ABRE #112;
     |BUCLE Historico;
     |CIERRA #112;
     |CIERRA #1;
     |SI nHay ! 0;
          |PINPA #0#1;
          |PARA; |SI; |HACIENDO;
               |PARA nSwMarca = 1; |SI nSwMarca ! 0; |HACIENDO;
                    nSwMarca = 0;
                    |ENTLINEAL #3#1, 1, 4, 19, 0, Min, Max;
                    |SI nSwMarca ! 0;
                         |BUCLE MarcaTodo;
                    |FINSI;
               |SIGUE;
               |MENU aMenu;
               |SI FSalida ] 2; |SAL; |FINSI;
          |SIGUE;
          |SI FSalida = 2;
               |ABRE #3;
               |ABRE #4;
               |ABRE #5;
               |ABRE #27;
               |ABRE #112;
               |ABRE #134;
               |BUCLE Tmp;
               |CIERRA #134;
               |CIERRA #112;
               |CIERRA #27;
               |CIERRA #5;
               |CIERRA #4;
               |CIERRA #3;
               |SI nError = 0;
                    nPrime = 0;
                    |BUCLE CreaAlbaran;
                    |SI nPrime = 1;
                         |HAZ FinAlbaran;
                    |FINSI;
                    |CONFI "0000Imprimir operaciones procesos importación?";
                    |SI FSalida = 0;
                         |HAZ Imprime;
                    |FINSI;
               |FINSI;
          |FINSI;
     |SINO;
          |MENAV "0000No hay registros...";
     |FINSI;
     |DELINDEX #1;
|FPRC;

|PROGRAMA;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;

     |HAZ CreaTempo; |NOME_DAT #134 Tempo; aTmp134 = Tempo; |DELINDEX #134;

     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
     |DDEFECTO #0;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |CIERRA #0;

    Tempo = aTmp134; |HAZ BoraTempo; |DELINDEX #134;
|FPRO;

|PROCESO Print;
     |PRINT;
|FPRC;

|PROCESO tempo134;
     #4#0 = #134#1;
     |LEE 020#4=;
     |SI FSalida = 0;
          |BUCLELIN 2 Print #4;
          |PIEINF;
     |FINSI;
|FPRC;

|DEFBUCLE tempo134;
     #134#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, tempo134;
|FIN;

|PROCESO Imprime;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "coima004";
          |SI FSalida = 0;
               |ABRE #4;
               |BUCLE tempo134;
               |CIERRA #4;
               |FININF;
          |SINO;
               |MENAV "0000No existe informe 'coima004'";
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
