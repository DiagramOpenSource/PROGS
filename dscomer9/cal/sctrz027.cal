|FICHEROS;
     sctrz027 #0;
     agifm003 #3;
     sctrm005 #5;
     sctrm006 #6;
     agifa024 #24;
     sctrm032 #32;
     sctrm033 #33;
     sctrm035 #35;
     sctrm036 #36;  ||Cliente/Proveedores
     sctrm057 #57;
     sctrm001 #100;
     agifa112 #112;
     sctrz028 #128,MANTE;     || Pantalla
     agifa321 #321;
     referen@;
|FIN;

|VARIABLES;
     aInf = "";
     &eaDC = "";
     &eaEntidad = "";
     &eaSucursal = "";
     &eaCuenta = "";
     &eaIBAN = "";
     &eaPais = "";
     &eaCta = "";
     &eaVarDni = "";
     aNifQbf1 = "";
     aNifQbf2 = "";
     &eaCliente = "";
     &eaProg = "";
     &enFinVen = 0;
     &eaNomLogo = "";
     &enPantaLogo = 0;
     &enCtrFin = 0;
     aAlfa = "";
     nModo = 0;
     nPanta = 0;
     nPanGen = 0;
     nPanFac = 0;
     nPanCli = 0;
     nPanPrv = 0;
     nRango = 0;
     nGrid = 0;
     nBtnAlta = 0;
     nBtnModi = 0;
     nBtnBaja = 0;
     nBtnCons = 0;
     nBtnImpr = 0;
     nBtnContacto = 0;
     nBtnComision = 0;
     nBtnBono = 0;
     aReg1 = "";
     nBloquea = 0;
     i = 0;
     nId = 0;
     aConte = "";
     nNume = 0;
     aCod = "";
     nError = 0;
     nForma = 0;
|FIN;

|PROCESO CliAsociado0; |TIPO 0;
     aAlfa = #128#71; |QBF aAlfa;
     |SI aAlfa ! "";
          aAlfa = ("00000" + aAlfa) % -106;
          #128#71 = aAlfa; |PINTA #128#71;
          |DDEF aAlfa;
          aAlfa = aAlfa + "sctrm036";
          |CARGA_DEF aAlfa, referen@;
          |SI FSalida = 0;
               |ABRE #referen@;
               #referen@#1 = #128#71;
               |LEE 000#referen@.=;
               |SI FSalida ! 0;
                    |MENAV "0000No existe c¢digo cliente...";
                    |ERROR;
               |FINSI;
               |CIERRA #referen@;
               |DESCARGA_DEF #referen@;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO CliAsociado66; |TIPO 66;
     |DDEF aAlfa;
     aAlfa = aAlfa + "sctrm036";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |ABRE #referen@;
          #referen@#1 = #128#71;
          |LEE 000#referen@.];
          |CONSULTA_CLAVE #1#referen@;
          |SI FSalida = 0;
               #128#71 = #referen@#1; |PINTA #128#71;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #referen@;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO ActDcomer9;
     |SI #36#12 ! "N";   ||Cliente
          |ABRE #24;
          #24#0 = #36#1;
          |LEE 101#24=;
          |SI nForma = 1;
               |SI FSalida ! 0; |GRABA 020#24b; |FINSI;
               #24#1 = #36#2;
               aAlfa = #36#3; |QBF aAlfa;
               |SI aAlfa = "";
                    #24#2 = #36#2;
               |SINO;
                    #24#2 = #36#3;
               |FINSI;
               #24#5 = #36#4;
               #24#180 = #36#5;
               aAlfa = #36#5 % 102; #24#178 = aAlfa;
               aAlfa = #36#5 % 303; #24#179 = aAlfa;
               #24#6 = #36#6;
               #24#7 = #36#8;
               #24#15 = #36#11;
               #24#16 = #36#13;
               #24#17 = #36#20;
               #24#18 = #36#22;
               #24#196 = #36#23;
               #24#197 = #36#25;
               #24#3 = ("00" + #36#28) % -102;
               #24#158 = #36#30;

               #24#8 = #36#34; #24#11 = #36#34;
               #24#182 = #36#35; #24#185 = #36#35;
               aAlfa = #36#35 % 102; #24#181 = aAlfa; #24#184 = aAlfa;
               aAlfa = #36#35 % 303; #24#182 = aAlfa; #24#185 = aAlfa;
               #24#9 = #36#36; #24#12 = #36#36;
               #24#10 = #36#38; #24#13 = #36#38;

               #24#205 = #36#39;
               #24#14 = #36#40;
               #24#192 = #36#46;
               #24#44 = #36#47;
               #24#20 = #36#51;
               #24#32 = #36#53;
               #24#33 = #36#54;
               #24#30 = #36#55;
               #24#31 = #36#56;
               #24#29 = #36#57;
               #24#215 = #36#58;
               #24#216 = #36#59;
               |GRABA 020#24a;
          |SINO;
               |SI FSalida = 0;
                    |BORRA 020#24a;
               |FINSI;
          |FINSI;
          |CIERRA #24;
     |FINSI;
     |SI #36#18 ! "N";   ||Proveedor
          |ABRE #112;
          #112#0 = #36#1;
          |LEE 101#112=;
          |SI nForma = 1;
               |SI FSalida ! 0; |GRABA 020#112b; |FINSI;
               #112#1 = #36#2;
               aAlfa = #36#3; |QBF aAlfa;
               |SI aAlfa = "";
                    #112#2 = #36#2;
               |SINO;
                    #112#2 = #36#3;
               |FINSI;
               #112#3 = #36#4;
               #112#76 = #36#5;
               aAlfa = #36#5 % 102; #112#74 = aAlfa;
               aAlfa = #36#5 % 303; #112#75 = aAlfa;
               #112#4 = #36#6;
               #112#5 = #36#8;
               #112#9 = #36#11;
               #112#10 = #36#19;
               #112#6 = #36#20;
               #112#7 = #36#22;
               #112#83 = #36#23;
               #112#84 = #36#25;
               #112#92 = ("00" + #36#28) % -102;
               #112#42 = #36#30;
               #112#1 = #36#33;
               #112#101 = #36#34;
               #112#103 = #36#35;
               aAlfa = #36#35 % 102; #112#102 = aAlfa;
               aAlfa = #36#35 % 303; #112#103 = aAlfa;
               #112#105 = #36#36;
               #112#104 = #36#38;
               #112#89 = #36#39;
               #112#81 = #36#46;
               #112#17 = #36#60;
               #112#14 = #36#62;
               #112#15 = #36#63;
               #112#12 = #36#64;
               aAlfa = ("00" + #36#65) % -102;
               #112#13 = aAlfa;
               #112#11 = #36#66;
               #112#96 = #36#67;
               #112#97 = #36#68;
               |GRABA 020#112a;
          |SINO;
               |SI FSalida = 0;
                    |BORRA 020#112a;
               |FINSI;
          |FINSI;
          |CIERRA #112;
     |FINSI;
|FPRC;

|PROCESO BancoP; |TIPO 0;
     |SI aConte ! #128Campo;
          |SI Campo ! 65
               eaEntidad = #128#62; |QBF eaEntidad; eaEntidad = eaEntidad % 104;
               eaSucursal = #128#63; |QBF eaSucursal; eaSucursal = eaSucursal % 104;
               eaCuenta = #128#64; |QBF eaCuenta; eaCuenta = eaCuenta % 110;
               eaDC = "";
               |HAZ CalculoDC;
               #128#65 = eaDC; |PINTA #128#65;
          |FINSI;
          |HAZ CalculaIBANP;
     |FINSI;
|FPRC;

|PROCESO CalculaIBANP;
     eaCta = (#128#62 % 104) + (#128#63 % 104) + #128#65 + (#128#64 % 110);
     eaPais = #128#9;
     |HAZ CalcuIBAN;
     |QBF eaIBAN;
     |SI eaIBAN ! "";
          #128#67 = eaIBAN; |PINTA #128#67;
     |FINSI;
|FPRC;

|PROCESO IbanP7; |TIPO 7;
     aAlfa = #128#67; |QBF aAlfa;
     |SI aAlfa = "";
          |HAZ CalculaIBANP;
     |FINSI;
|FPRC;

|PROCESO IbanP0; |TIPO 0;
     eaCta = (#128#62 % 104) + (#128#63 % 104) + #128#65 + (#128#64 % 110);
     eaPais = #128#9;
     |HAZ CalcuIBAN;
     aAlfa = #128#67; |QBF aAlfa;
     |SI aAlfa ! eaIBAN; |Y aAlfa ! "";
          |MENAV "0000Error. C¢digo IBAN incorrecto...";
     |FINSI;
|FPRC;

|PROCESO BancoC; |TIPO 0;
     |SI aConte ! #128Campo;
          |SI Campo ! 56;
               eaEntidad = #128#53; |QBF eaEntidad; eaEntidad = eaEntidad % 104;
               eaSucursal = #128#54; |QBF eaSucursal; eaSucursal = eaSucursal % 104;
               eaCuenta = #128#55; |QBF eaCuenta; eaCuenta = eaCuenta % 110;
               eaDC = "";
               |HAZ CalculoDC;
               #128#56 = eaDC; |PINTA #128#56;
          |FINSI;
          |HAZ CalculaIBANC;
     |FINSI;
|FPRC;

|PROCESO CalculaIBANC;
     eaCta = (#128#53 % 104) + (#128#54 % 104) + #128#56 + (#128#55 % 110);
     eaPais = #128#9;
     |HAZ CalcuIBAN;
     |QBF eaIBAN;
     |SI eaIBAN ! "";
          #128#58 = eaIBAN; |PINTA #128#58;
     |FINSI;
|FPRC;

|PROCESO IbanC7; |TIPO 7;
     aAlfa = #128#58; |QBF aAlfa;
     |SI aAlfa = "";
          |HAZ CalculaIBANC;
     |FINSI;
|FPRC;

|PROCESO IbanC0; |TIPO 0;
     eaCta = (#128#53 % 104) + (#128#54 % 104) + #128#56 + (#128#55 % 110);
     eaPais = #128#9;
     |HAZ CalcuIBAN;
     aAlfa = #128#58; |QBF aAlfa;
     |SI aAlfa ! eaIBAN; |Y aAlfa ! "";
          |MENAV "0000Error. Código IBAN incorrecto...";
     |FINSI;
|FPRC;

|PROCESO PagoPro; |TIPO 0;
     |ABRE #35;
     #35#0 = #128#60;
     |LEE 000#35=;
     |SI FSalida = 0;
          #128#61 = #35#1; |PINTA #128#61;
     |SINO;
          |MENAV "0000No existe c¢digo forma pago...";
          |ERROR;
     |FINSI;
     |CIERRA #35;
|FPRC;

|PROCESO PagoCli; |TIPO 0;
     |ABRE #35;
     #35#0 = #128#51;
     |LEE 000#35=;
     |SI FSalida = 0;
          #128#52 = #35#1; |PINTA #128#52;
     |SINO;
          |MENAV "0000No existe c¢digo forma pago...";
          |ERROR;
     |FINSI;
     |CIERRA #35;
|FPRC;

|PROCESO PaisFiscal; |TIPO 0;
     |ABRE #5;
     #5#0 = #128#39;
     |LEE 000#5=;
     |SI FSalida = 0;
          #128#40 = #5#1; |PINTA #128#40;
     |SINO;
          |MENAV "0000No existe c¢digo pa¡s...";
          |ERROR;
     |FINSI;
     |CIERRA #5;
|FPRC;

|PROCESO ProviFiscal; |TIPO 0;
     |ABRE #6;
     #6#0 = #128#37;
     |LEE 000#6=;
     |SI FSalida = 0;
          #128#38 = #6#1; |PINTA #128#38;
     |SINO;
          |MENAV "0000No existe c¢digo provincia...";
          |ERROR;
     |FINSI;
     |CIERRA #6;
|FPRC;

|PROCESO CliFac0; |TIPO 0;
     |DDEF aAlfa;
     aAlfa = aAlfa + "sctrm036";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |ABRE #referen@;
          #referen@#1 = #128#32;
          |LEE 000#referen@.=;
          |SI FSalida = 0;
               #128#33 = #referen@#2; |PINTA #128#33;
          |SINO;
               |MENAV "0000No existe c¢digo cliente...";
               |ERROR;
          |FINSI;
          |CIERRA #referen@;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO CliFac66; |TIPO 66;
     |DDEF aAlfa;
     aAlfa = aAlfa + "sctrm036";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |ABRE #referen@;
          #referen@#1 = #128#32;
          |LEE 000#referen@.];
          |CONSULTA_CLAVE #1#referen@;
          |SI FSalida = 0;
               #128#32 = #referen@#1; |PINTA #128#32;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #referen@;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO Grupo; |TIPO 0;
     |ABRE #3;
     #3#0 = #128#30;
     |LEE 000#3=;
     |SI FSalida = 0;
          #128#31 = #3#1; |PINTA #128#31;
     |SINO;
          |MENAV "0000No existe c¢digo grupo...";
          |ERROR;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO Zona; |TIPO 0;
     |ABRE #33;
     #33#0 = #128#28;
     |LEE 000#33=;
     |SI FSalida = 0;
          #128#29 = #33#1; |PINTA #128#29;
     |SINO;
          |MENAV "0000No existe c¢digo zona comercial...";
          |ERROR;
     |FINSI;
     |CIERRA #33;
|FPRC;

|PROCESO Actividad; |TIPO 0;
     |ABRE #32;
     #32#0 = #128#26;
     |LEE 000#32=;
     |SI FSalida = 0;
          #128#27 = #32#1; |PINTA #128#27;
     |SINO;
          |MENAV "0000No existe c¢digo actividad...";
          |ERROR;
     |FINSI;
     |CIERRA #32;
|FPRC;

|PROCESO Nif; |TIPO 0;
     eaPais = #128#9;

     |SI FSalida = 9;
          eaVarDni  = #128Campo;
          |HAZ CalculoNIFCIF;
          #128Campo = eaVarDni;
          |PINTA #128Campo;
          |ERROR; |ACABA;
     |SINO;
           |SI aConte = #128Campo; |ACABA; |FINSI;
     |FINSI;

     eaVarDni = #128Campo;
     |HAZ CalculoNIFCIF;

     aNifQbf1 = #128Campo;   |QBF aNifQbf1;
     aNifQbf2 = eaVarDni;  |QBF aNifQbf2;

     |SI aNifQbf1 ! aNifQbf2; |Y aNifQbf1 ! "";
          aAlfa = "0000NEl NIF puede ser erróneo."+&13+"¿Desea calcularlo?";
          |CONFI aAlfa;
          |SI FSalida = 0;
               #128Campo = eaVarDni; |PINTA #128Campo;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Pais; |TIPO 0;
     |ABRE #5;
     #5#0 = #128#9;
     |LEE 000#5=;
     |SI FSalida = 0;
          #128#10 = #5#1; |PINTA #128#10;

          |SI nModo = 1; |Y #128Campo ! aConte;
               #128#39 = #128#9; |PINTA #128#39;
               #128#40 = #128#10; |PINTA #128#40;
          |FINSI;
     |SINO;
          |MENAV "0000No existe c¢digo pa¡s...";
          |ERROR;
     |FINSI;
     |CIERRA #5;
|FPRC;

|PROCESO Provincia; |TIPO 0;
     |ABRE #6;
     #6#0 = #128#7;
     |LEE 000#6=;
     |SI FSalida = 0;
          #128#8 = #6#1; |PINTA #128#8;

          |SI nModo = 1; |Y #128Campo ! aConte;
               #128#37 = #128#7; |PINTA #128#37;
               #128#38 = #128#8; |PINTA #128#38;
          |FINSI;
     |SINO;
          |MENAV "0000No existe c¢digo provincia...";
          |ERROR;
     |FINSI;
     |CIERRA #6;
|FPRC;

|PROCESO Pobla; |TIPO 0;
     |SI nModo = 1; |Y #128Campo ! aConte;
          #128#36 = #128#6; |PINTA #128#36;
     |FINSI;
|FPRC;

|PROCESO CP; |TIPO 0;
     |SI nModo = 1; |Y #128Campo ! aConte;
          #128#35 = #128#5; |PINTA #128#35;
     |FINSI;
|FPRC;

|PROCESO Direc; |TIPO 0;
     |SI nModo = 1; |Y #128Campo ! aConte;
          #128#34 = #128#4; |PINTA #128#34;
     |FINSI;
|FPRC;

|PROCESO Razon; |TIPO 0;
     |SI nModo = 1; |Y #128Campo ! aConte;
          #128#33 = #128#2; |PINTA #128#33;
     |FINSI;
|FPRC;

|PROCESO CodigoAuto;
     nError = 0;
     |SI #128#0 = "A"; aCod = "009999"; |FINSI;
     |SI #128#0 = "B"; aCod = "099999"; |FINSI;
     |SI #128#0 = "C"; aCod = "999999"; |FINSI;
     #36#1 = aCod;
     |LEE 000#36];
     |SI FSalida = 0;
          |LEE 000#36a;
     |SINO;
          |LEE 000#36u;
     |FINSI;
     |SI FSalida = 0;
          nNume = #36#1; nNume = nNume + 1;
          |SI aCod = "009999";
          |FINSI;
          |SI aCod = "099999";
               |SI nNume < 009999; nNume = 010000; |FINSI;
          |FINSI;
          |SI aCod = "999999";
               |SI nNume < 099999; nNume = 100000; |FINSI;
          |FINSI;
     |SINO;
          |SI aCod = "009999"; nNume = 000001; |FINSI;
          |SI aCod = "099999"; nNume = 010000; |FINSI;
          |SI aCod = "999999"; nNume = 100000; |FINSI;
     |FINSI;
     |SI nNume > aCod;
          aAlfa = "0000El c¢digo calculado:" + (("000000"+nNume)%-106) + " supera a:" + aCod + " ...";
          |MENAV aAlfa;
          nError = 1;
     |SINO;
          aCod = ("000000" + nNume) % -106;
          #128#1 = aCod; |PINTA #128#1;
     |FINSI;
|FPRC;

|PROCESO Chequea; |TIPO 0;
     |SI nModo = 1; |Y nBloquea = 0;
          |SI #128#1 = "000000";
               |HAZ CodigoAuto;
               |SI nError ! 0; |ERROR; |ACABA; |FINSI;
          |FINSI;
          |DDEFECTO #36;
          #36#1 = #128#1;
          |GRABA 000#36b;
          |SI FSalida ! 0;
               |MENAV "0000Registro existente...";
               |ERROR;
          |SINO;
               |C_M #128#0, 1, "N"; |PINTA #128#0;
               |C_M #128#1, 1, "N"; |PINTA #128#1;
               nBloquea = 1;

               aAlfa = "|X000"; aAlfa = #128aAlfa; nId = aAlfa;
               |ESTADO_CONTROL nId, "ENABLE";

               #128#32 = #128#1; |PINTA #128#32;
               #128#33 = #128#2; |PINTA #128#33;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Conte; |TIPO 7;
     aConte = #128Campo;
|FPRC;

|PROCESO Valida; |TIPO 7;
     |SI nModo = 1;
          aAlfa = "|X000"; aAlfa = #128aAlfa; nId = aAlfa;
          |ESTADO_CONTROL nId, "DISABLE";
     |FINSI;
|FPRC;

|PROCESO EvtGen;
     |SI nModo ! 4;
          aAlfa = "|C000WID";
          aAlfa = #128#aAlfa#;
          nId = aAlfa;
          |FOCOTECLADO nId;
     |FINSI;
|FPRC;

|PROCESO EvtFac;
     |SI nModo ! 4;
          aAlfa = "|C012WID";
          aAlfa = #128#aAlfa#;
          nId = aAlfa;
          |FOCOTECLADO nId;
     |FINSI;
|FPRC;

|PROCESO EvtCli;
     |SI nModo ! 4;
          aAlfa = "|C051WID";
          aAlfa = #128#aAlfa#;
          nId = aAlfa;
          |FOCOTECLADO nId;
     |FINSI;
|FPRC;

|PROCESO EvtPrv;
     |SI nModo ! 4;
          aAlfa = "|C060WID";
          aAlfa = #128#aAlfa#;
          nId = aAlfa;
          |FOCOTECLADO nId;
     |FINSI;
|FPRC;

|PROCESO Edita;
     aReg1 = #36#1;

     |SI nModo = 1; |VENTANA 0601, 2898, -1, 17, "Nuevo Cliente/Proveedor"; |FINSI;
     |SI nModo = 2; |VENTANA 0601, 2898, -1, 17, "Modifica Cliente/Proveedor"; |FINSI;
     |SI nModo = 4; |VENTANA 0601, 2898, -1, 17, "Consulta Cliente/Proveedor"; |FINSI;
     |HAZ PushVenModal;

     |SI nModo = 1;
          |ABRE #321; |LEE 000#321p; |CIERRA #321;
          |DDEFECTO #128;
          |C_M #128#0, 1, "S";
          |C_M #128#1, 1, "S";
          #128#41 = ~;
          #128#42 = Usuario % 810;
          #128#46 = #321#9;
     |SINO;
          |PARA i = 0; |SI i [ 75; |HACIENDO i = i + 1;
               #128i = #36i;
          |SIGUE;
          |C_M #128#0, 1, "N";
          |C_M #128#1, 1, "N";
     |FINSI;

     |PINPA #0#128;
     |PINDA #0#128;
     |PINPA #1#128; nPanGen = FSalida;
     |PINDA #1#128;
     |PINPA #2#128; nPanFac = FSalida;
     |PINDA #2#128;
     |PINPA #3#128; nPanCli = FSalida;
     |PINDA #3#128;
     |PINPA #4#128; nPanPrv = FSalida;
     |PINDA #4#128;
     |CONTROL_SIMPLE nPanGen, "EVENTOPAN", 0000, 0000, EvtGen;
     |CONTROL_SIMPLE nPanFac, "EVENTOPAN", 0000, 0000, EvtFac;
     |CONTROL_SIMPLE nPanCli, "EVENTOPAN", 0000, 0000, EvtCli;
     |CONTROL_SIMPLE nPanPrv, "EVENTOPAN", 0000, 0000, EvtPrv;

     nBloquea = 0;
     |SI nModo = 1; |ENDATOS #1#128; |FINSI;
     |SI nModo = 2; |ENDATOS #2#128; |FINSI;
     |SI nModo = 4; |PAUSA; |FINSI;
     |SI FSalida = 0; |Y nModo ! 4;
          #36#1 = #128#1;
          |LEE 121#36=;
          |PARA i = 0; |SI i [ 75; |HACIENDO i = i + 1;
               #36i = #128i;
          |SIGUE;
          |GRABA 020#36a;
          aReg1 = #36#1;
          nForma = 1; |HAZ ActDcomer9;
     |SINO;
          |SI nBloquea = 1;
               #36#1 = #128#1;
               |BORRA 020#36c;
          |FINSI;
     |FINSI;
     |LIBERA #36;

     |HAZ PopVenModal;

     #36#1 = aReg1;
     |LEE 000#36=;
     |REFRESCACONTROL nGrid;
|FPRC;

|PROCESO BtnAlta;
     nModo = 1; |HAZ Edita;
     |HAZ TieneLineas;
|FPRC;

|PROCESO BtnModi;
     |LEE 100#36=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     nModo = 2; |HAZ Edita;
|FPRC;

|PROCESO BtnBaja;
     |LEE 100#36=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     aAlfa = "0000N¨Borrar cliente: " + #36#1 + ".-" + #36#2;
     |QBF aAlfa;
     aAlfa = aAlfa + "?";
     |CONFI aAlfa;
     |SI FSalida = 0;
          |BORRA 020#36a;
          nForma = -1; |HAZ ActDcomer9;
          |HAZ TieneLineas;
          |REFRESCACONTROL nGrid;
     |FINSI;
     |LIBERA #36;
|FPRC;

|PROCESO BtnCons;
     |LEE 000#36=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     nModo = 4; |HAZ Edita;
|FPRC;

|PROCESO Imprime;
     Impresora = "CrystalReport";
     |IMPRE -1;
     |SI FSalida = 0;
          aInf = #57#4; |QBF aInf;
          |INFOR aInf;
          |SI FSalida = 0;
               |PRINT;
               |PIEINF;
               |FININF;
          |SINO;
               aInf = "0000Error en in forme:" + aInf;
               |MENAV aInf;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO BtnImpr;
     |LEE 000#36=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     |HAZ Imprime;
|FPRC;

|PROCESO Evento;
     |SI FSalida = 1; |O FSalida = 2;
          |SELECT #1#36;
          |LEE 000#36=;
          |HAZ TieneLineas;
     |FINSI;
     |SI FSalida = 4;
          |HAZ BtnCons;
     |FINSI;
|FPRC;

|PROCESO TieneLineas;
     |DDEF aAlfa;
     aAlfa = aAlfa + "sctrm036";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |ABRE #referen@;
          |LEE 000#referen@.p;
          |SI FSalida = 0;
               |ESTADO_CONTROL nBtnModi, "ENABLE";
               |ESTADO_CONTROL nBtnBaja, "ENABLE";
               |ESTADO_CONTROL nBtnCons, "ENABLE";
               |ESTADO_CONTROL nBtnImpr, "ENABLE";
               |ESTADO_CONTROL nBtnImpr, "ENABLE";
               |ESTADO_CONTROL nBtnContacto, "ENABLE";
               |ESTADO_CONTROL nBtnComision, "ENABLE";
               |SI #36#50 = "S";
                    |ESTADO_CONTROL nBtnBono, "ENABLE";
               |SINO;
                    |ESTADO_CONTROL nBtnBono, "DISABLE";
               |FINSI;
          |SINO;
               |ESTADO_CONTROL nBtnModi, "DISABLE";
               |ESTADO_CONTROL nBtnBaja, "DISABLE";
               |ESTADO_CONTROL nBtnCons, "DISABLE";
               |ESTADO_CONTROL nBtnImpr, "DISABLE";
               |ESTADO_CONTROL nBtnContacto, "DISABLE";
               |ESTADO_CONTROL nBtnComision, "DISABLE";
               |ESTADO_CONTROL nBtnBono, "DISABLE";
          |FINSI;
          |CIERRA #referen@;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO BtnBono;
     eaCliente = #36#1;
     eaProg = "sctrz033";
     enFinVen = 2899;
     |HAZ EjecutaProg;
|FPRC;

|PROCESO BtnComision;
     eaCliente = #36#1;
     eaProg = "sctrz031";
     enFinVen = 2899;
     |HAZ EjecutaProg;
|FPRC;

|PROCESO BtnContacto;
     eaCliente = #36#1;
     eaProg = "sctrz029";
     enFinVen = 2899;
     |HAZ EjecutaProg;
|FPRC;

|PROCESO LogoPanta;
     eaNomLogo = #100#1;
     |HAZ TraeLogoPan;
     enPantaLogo = nPanta;
     |HAZ PintaLogoPan;
|FPRC;

|PROGRAMA;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     |ABRE #57; |LEE 000#57p; |CIERRA #57;

     |PINPA #0#0; nPanta = FSalida;
     |PINDA #0#0;
     |HAZ LogoPanta;

     |CONTROL_SIMPLE nPanta, "BOTON,{{193}}Alta", 1002, 1012, BtnAlta;
     nBtnAlta = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Modificar", 1014, 1024, BtnModi;
     nBtnModi = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,{{199}}Baja", 1026, 1036, BtnBaja;
     nBtnBaja = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,{{155}}Consulta", 1038, 1048, BtnCons;
     nBtnCons = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,{{205}}Impresi¢n", 1050, 1060, BtnImpr;
     nBtnImpr = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{137}}Contactos", 2802, 2815, BtnContacto;
     nBtnContacto = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,{{137}}Comisiones L¡nea", 2817, 2833, BtnComision;
     nBtnComision = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,{{137}}Bonos Viajes", 2835, 2851, BtnBono;
     nBtnBono = FSalida;

     |HAZ TieneLineas;
     |ABRET #36;
     nRango = 4 + 8 + 16 + 32;
     |LINEAL_SIMPLE #1#36, nRango, 1102, 2799, NULL, NULL, Evento;
     nGrid = FSalida;
     enCtrFin = nGrid;
     |HAZ EsperaFin;
     |CIERRAT #36;
|FPRO;
