|FICHEROS;
     gesiz019 #0;
     gesim002 #2;
     gesim024 #24;
|FIN;

|VARIABLES;
     &eaSerie = "";
     &enDocu = 0;
     &enImpoDoc = 0;
     &enUnidades = 0;
     &eaCliente = "";
     &eaProve = "";
     &efFecha = @;
     &eaArticulo = "";
     &eaMatri = "";
     aAlfa = "";
     aParam = "";
     aDocu = "";
     aSer = "";
     aNum = "";
     aLin = "";
|FIN;

|PROCESO Tipo12; |TIPO 12;
|FPRC;

|PROCESO Min;
     #2#20 = eaArticulo;
     #2#0 = " " * 15;
|FPRC;

|PROCESO Max;
     #2#20 = eaArticulo;
     #2#0 = "z" * 15;
|FPRC;

|PROCESO Tipo66; |TIPO 66;
     |ABRE #2;
     |SELECT #3#2;
     #2#20 = eaArticulo;
     #2#0 = #0#0;
     |LEE 000#2];
     |CONSULTA_F_CLAVE #3#2, Min, Max;
     |SI FSalida = 0;
          #0#0 = #2#0; |PINTA #0#0;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #2;
|FPRC;

|PROCESO Chequea6; |TIPO 0;
     |ABRE #2;
     #2#0 = #0#0;
     |LEE 000#2=;
     |SI FSalida ! 0;
          |CONFI "0000SConfirma alta (S/N).:";
          |SI FSalida = 0;
               |SI aDocu = "PC";
                    aAlfa = aDocu + #0#0 + eaProve + efFecha + eaArticulo;
               |FINSI;
               |SI aDocu = "AV";
                    aAlfa = aDocu + #0#0 + eaCliente + efFecha + eaArticulo;
               |FINSI;
               |SI aDocu = "FD";
                    aAlfa = aDocu + #0#0 + eaCliente + efFecha + eaArticulo;
               |FINSI;
               |SI aDocu = "AC";
                    eaSerie = aSer;
                    enDocu = aNum;
                    aAlfa = aDocu + #0#0 + eaProve + efFecha + eaArticulo;
               |FINSI;
               |SI aDocu = "EV";
                    aAlfa = aDocu + #0#0 + eaProve + efFecha + eaArticulo;
               |FINSI;
               |SI aDocu = "RE";
                    aAlfa = aDocu + #0#0 + "000000" + efFecha + eaArticulo;
               |FINSI;

/*  Da ERROR 50000 en el agifa041 al dar varias altas
               aAlfa = "|gesiz021;" + aAlfa;
               |SUB_EJECUTA_NP aAlfa;
               |PULSATECLA;
*/
               aAlfa = "gesiz027;" + aAlfa;
               |SUB_EJECUTA_NP aAlfa;
               |PULSATECLA;

          |FINSI;
          |ERROR;
     |FINSI;
     |CIERRA #2;
|FPRC;

|PROCESO Chequea0; |TIPO 0;
     |ABRE #2;
     #2#0 = #0#0;
     |LEE 000#2=;
     |SI aDocu = "AV"; |O aDocu = "FD";
          |SI FSalida = 0; |Y #2#16 ! 0;
               |SI aDocu = "AV"; |Y enUnidades = -1; |Y eaCliente = #2#6;
                    aAlfa = "0000Matricula asignada en el albaran:" + &13 + #2#15 + "/" + (("000000" + #2#16) % -106);
                    |MENAV aAlfa;
                    aAlfa = "0000N¿Recoger la maquina del cliente:" + #2#6 + " y codigo:" + #2#0;
                    |QBF aAlfa;
                    aAlfa = aAlfa + "?";
                    |CONFI aAlfa;
               |SINO;
                    aAlfa = "0000Matricula asignada en el albaran:" + &13 + #2#15 + "/" + (("000000" + #2#16) % -106);
                    |MENAV aAlfa;
                    FSalida = "1";
               |FINSI;
               |SI FSalida ! 0;
                    |ERROR; |ACABA;
               |FINSI;
          |FINSI;
          |SI FSalida = 0; |Y #2#18 ! 0;
               aAlfa = "0000Matricula asignada en la factura:" + &13 + #2#17 + "/" + (("000000" + #2#18) % -106);
               |MENAV aAlfa;
               |ERROR; |ACABA;
          |FINSI;
     |FINSI;
     |SI aDocu = "AC";
          |SI FSalida = 0; |Y #2#19 ! 0;
               aAlfa = "0000Matricula asignada en el albaran: " + &13 + #2#25 + "/" + (("000000" + #2#19) % -106);
               |MENAV aAlfa;
               |ERROR; |ACABA;
          |FINSI;
     |FINSI;
     |SI FSalida = 0; |Y #2#20 ! eaArticulo;
          aAlfa = "0000Matricula con articulo: [" + #2#20 + "]";
          |MENAV aAlfa;
          |ERROR;
     |FINSI;
     |CIERRA #2;
|FPRC;

|PROGRAMA;
     aParam = PARAMETRO;
     aDocu = aParam % 102;
     aSer = aParam % 305;
     aNum = aParam % 806;
     aLin = aParam % 14;

     |DDEFECTO #24;
     |ABRE #24;
     #24#0 = aDocu;
     #24#1 = aSer;
     #24#2 = aNum;
     #24#3 = aLin;
     |LEE 101#24=;
     |SI FSalida ! 0; |GRABA 020#24b; |FINSI;
     #0#0 = #24#4;

     |SI aDocu = "PC"; |C_P #0#0, 1, 1009; |FINSI;
     |SI aDocu = "AV"; |C_P #0#0, 1, 1336; |FINSI;
     |SI aDocu = "AJ"; |C_P #0#0, 1, 1113; |FINSI;
     |SI aDocu = "FD"; |C_P #0#0, 1, 1335; |FINSI;
     |SI aDocu = "AC"; |C_P #0#0, 1, 1327; |FINSI;
     |SI aDocu = "EV"; |C_P #0#0, 1, 1962; |FINSI;
     |SI aDocu = "RE"; |C_P #0#0, 1, 1165; |FINSI;

     |SI aDocu = "AJ"; aDocu = "AV"; |FINSI;

     |ENDATOS #1#0;
     |SI FSalida = 0;
          eaMatri = #0#0;
     |SINO;
          eaMatri = "";
     |FINSI;

     |LEE 101#24=;
     #24#4 = eaMatri;

     |SI FSalida = 0;
          |GRABA 020#24a;
     |SINO;
          |GRABA 020#24n;
     |FINSI;
     |GRABA 020#24a;
     |CIERRA #24;
|FPRO;
