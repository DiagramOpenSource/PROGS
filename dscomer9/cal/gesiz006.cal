|FICHEROS;
     gesiz006 #0;
     gesim001 #6;
     gesim005 #17;
     gesim002 #21;
     gesim003 #22;
     agifa024 #24;
     agifa142 #142;
|FIN;

|VARIABLES;
     &Tempo = "";
     &nDeci_Base = 0; &nDeci_Div = 0;
     &enPestana = 0;
     &eaCarga7 = "";
     &eaTmp = "";
     &eaCliDoc = "";
     &enPosiciona = 0;
     &eaProg = "";
     &enModo = 0;
     &enError = 0;
 {-1}aGet = 0;
     aGet1 = 0;
     aGet2 = 0;
     nPanta = 0;
     nBtnActualiza = 0;
     nBtnNuevoAviso = 0;
     nBtnNuevaEntre = 0;
     nBtnDocumento = 0;
     aAlfa = "";
     aCli = "";
     aEmp = "";
     aCliente = "";
     aFich = "";
     aFichero = "";
     nHandle = 0;
     nVentana = 0;
 {-1}aVent = "";
     aVent1 = 0;
     aVent2 = 0;
     aVent3 = 0;
     aVent4 = 0;
     aVent5 = "";
     aParam = "";
     nSw = 0;
|FIN;

|PROCESO Posiciona;
     aAlfa = aCliente % 106; #0#0 = aAlfa;
     aAlfa = aCliente % 703; #0#1 = aAlfa;
     aAlfa = aCliente % 1105; #0#2 = aAlfa;
     |HAZ BtnActualiza;

     |ABRE #17;
     aAlfa = eaProg % 1005; #17#0 = aAlfa;
     aAlfa = eaProg % 1506; #17#1 = aAlfa;
     |LEE 020#17=;
     |CIERRA #17;

     enPosiciona = 1;
     |PULSATECLA;
     |HAZ Refresca4;
     enPosiciona = 0;
|FPRC;

|PROCESO BtnDocumento;
     |PULSATECLA;

     |VENTANA 0501, 3599, -1, 17, "Archivo Documental";
     nVentana = FSalida;
     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |ABRE #24;
     #24#0 = #0#0;
     |LEE 000#24=;
     |SI FSalida = 0;
          aAlfa = "|:dsarchi/dsarm005;" + #24#15;
          |SUB_EJECUTA_NP aAlfa;
     |SINO;
          |MENAV "0000No existe c¢digo de cliente...";
     |FINSI;
     |CIERRA #24;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |FINVENTANA nVentana;

     |PULSATECLA;
|FPRC;

|PROCESO BtnNuevaEntre;
     enModo = 1; |HAZ EditaEntrega;
     |SI enError = 0; |HAZ Refresca4; |FINSI;
|FPRC;

|PROCESO BtnNuevoAviso;
     enModo = 1; |HAZ EditaAviso;
     |SI enError = 0;
          |HAZ Refresca1;
          |HAZ Refresca4;
     |FINSI;
|FPRC;

|PROCESO BtnActualiza;
     |ESTADO_CONTROL nBtnNuevoAviso, "DISABLE";
     |ESTADO_CONTROL nBtnNuevaEntre, "DISABLE";
     |ESTADO_CONTROL nBtnDocumento, "DISABLE";
     nSw = 1;
     Campo = 0; |HAZ Tipo0;
     Campo = 1; |HAZ Tipo0;
     Campo = 2; |HAZ Tipo0;
     nSw = 0;

     |SI enPestana = 7; eaCarga7 = "S"; |SINO; eaCarga7 = "N"; |FINSI;
     |HAZ Actualiza1;
     |HAZ Actualiza2;
     |HAZ Actualiza3;
     |HAZ Actualiza4;
     |HAZ Actualiza6;
     |HAZ Actualiza7;
     ||...
     |ESTADO_CONTROL nBtnNuevoAviso, "ENABLE";
     |ESTADO_CONTROL nBtnNuevaEntre, "ENABLE";
     |ESTADO_CONTROL nBtnDocumento, "ENABLE";
|FPRC;

|PROCESO ValorCampo;
     |REFERENCIA_DEF aGet1, #0;
     aGet2  = 0;    || numero de campo
     IaGet = aGet1<-;
     |ESPECIFICA "GETDATACONTROL", aGet;
     aAlfa = FSalida; |QBT aAlfa;
     aAlfa = ("000000" + aAlfa) % -106;
     #0#0 = aAlfa; |PINTA #0#0;

     |REFERENCIA_DEF aGet1, #0;
     aGet2  = 1;    || numero de campo
     IaGet = aGet1<-;
     |ESPECIFICA "GETDATACONTROL", aGet;
     aAlfa = FSalida; |QBT aAlfa;
     #0#1 = aAlfa; |PINTA #0#1;

     |REFERENCIA_DEF aGet1, #0;
     aGet2  = 2;    || numero de campo
     IaGet = aGet1<-;
     |ESPECIFICA "GETDATACONTROL", aGet;
     aAlfa = FSalida; |QBT aAlfa;
     #0#2 = aAlfa; |PINTA #0#2;
|FPRC;

|PROCESO Tipo0; |TIPO 0;
     |SI aParam = ""; |HAZ ValorCampo; |FINSI;
     |SI Campo = 0;
          |DDEFECTO #24;
          |SI #0#0 = "000000";
               #0#3 = "< Todos los clientes >";
          |SINO;
               |ABRE #24;
               #24#0 = #0#0;
               |LEE 000#24=;
               |SI FSalida = 0;
                    #0#3 = #24#2;
               |SINO;
                    #0#3 = "< No existe el cliente >";
               |FINSI;
               |CIERRA #24;
          |FINSI;
          |PINTA #0#0;
          |PINTA #0#3;
     |FINSI;
     |SI Campo = 1;
          |SI #0#1 = "                              ";
               #0#4 = "< Todos las maquinas > ";
          |SINO;
               |ABRE #21;
               #21#0 = #0#1;
               |LEE 000#21=;
               |SI FSalida = 0;
                    #0#4 = #21#1;
                    |SI nSw = 0;
                         #0#0 = #21#6; |PINTA #0#0;
                         #0#2 = #21#28; |PINTA #0#2;
                    |FINSI;
               |SINO;
                    #0#4 = "< No existe la maquina >";
               |FINSI;
               |CIERRA #21;
          |FINSI;
          |PINTA #0#1;
          |PINTA #0#4;
     |FINSI;
     |SI Campo = 2;
          |SI #0#2 = 0;
               #0#5 = "< Todos los t‚cnicos > ";
          |SINO;
               |ABRE #22;
               #22#0 = #0#2;
               |LEE 000#22=;
               |SI FSalida = 0;
                    #0#5 = #22#1;
               |SINO;
                    #0#5 = "< No existe el t‚cnico >";
               |FINSI;
               |CIERRA #22;
          |FINSI;
          |PINTA #0#2;
          |PINTA #0#5;
     |FINSI;
|FPRC;

|PROCESO Tipo12; |TIPO 12;
|FPRC;

|PROCESO Tipo80; |TIPO 80;
     FSalida = 3699;
|FPRC;

|PROGRAMA;
     |HAZ CreaTempo; eaTmp = Tempo;

     |ABRE #6; |LEE 000#6p; |CIERRA #6;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;

     |HAZ DecimalesBase;
     nDeci_Div = nDeci_Base; || Para el importe de los recibos

     |CLS;
     |PINPA #0#0;  nPanta = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,Actualizar", 0584, 0599, BtnActualiza;
     nBtnActualiza = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Nuevo Aviso", 0684, 0699, BtnNuevoAviso;
     nBtnNuevoAviso = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Nueva Entrega", 0784, 0799, BtnNuevaEntre;
     nBtnNuevaEntre = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Archivo Doc.", 0884, 0899, BtnDocumento;
     nBtnDocumento = FSalida;
     |ESTADO_CONTROL nBtnActualiza, "DISABLE";
     |ESTADO_CONTROL nBtnNuevoAviso, "DISABLE";
     |ESTADO_CONTROL nBtnNuevaEntre, "DISABLE";
     |ESTADO_CONTROL nBtnDocumento, "DISABLE";

     |HAZ CargaCartera;
     |HAZ PintaPan1;
     |HAZ PintaPan2;
     |HAZ PintaPan3;
     |HAZ PintaPan4;
     |HAZ PintaPan6;
     |HAZ PintaPan7;
     ||...

     aParam = PARAMETRO;
     |SI aParam = "";
          |HAZ BtnActualiza;
     |SINO;
          #0#0 = aParam % 106;
          #0#1 = aParam % 730;
          |HAZ BtnActualiza;
     |FINSI;
     eaCliDoc = #0#0;

     |PINDA #0#0;
     |ESTADO_CONTROL nBtnActualiza, "ENABLE";
     |PARA; |SI; |HACIENDO;
          FSalida = "::ENDATOS::SINBOTONES::";
          |ENDATOS #1#0;
          |SI FSalida ! 0; |SAL; |FINSI;
     |SIGUE;

     |PULSATECLA;        || sin esto se cuelga
/*
     |FIN_CONTROL_WINDOWS nBtnActualiza;
     |FIN_CONTROL_WINDOWS nBtnNuevaEntre;
     |FIN_CONTROL_WINDOWS nBtnNuevoAviso;
     |FIN_CONTROL_WINDOWS nBtnDocumento;
*/
     |HAZ DescargaCartera;
     ||...     Ojo con el orden (por los cargadef) ...........||
     |HAZ DestruyePan7;
     |HAZ DestruyePan6;
     |HAZ DestruyePan4;
     |HAZ DestruyePan3;
     |HAZ DestruyePan2;
     |HAZ DestruyePan1;

     |PULSATECLA;
|FPRO;
