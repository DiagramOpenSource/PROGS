|FICHEROS;
     gopre024 #0;   || escandallo cabs.
     gopre025 #1;   || escandallo lins.
     agifa019 #2;   || articulo
     agifa142 #5;   || parametros
     agifa017 #17;
     agifa321;
     agifa324;
     agifa046 #46;  || Parametros
     agifa045 #45,MANTE;  || Calculo Comparativo
     referen@;
     agifa048 #480;
     agifa049 #490;
|FIN;

|VARIABLES;
     &enTiva = 0;
     &efFiva = @;
     &eaDiva = "";
     &enIva = 0;
     &enRec = 0;
     i = 0;
     aSer = "";
     nNum = 0;
     aCap = "";
     aPar = "";
     nLin = 0;
     aArt = "";
     aModo = "";
     aFilm = "";
     &enLinea = 0;
     nTari = 0;
     nModo = 0;
     &enAlta = 0;
     &eaArticulo = "";
     &nDeci_Base = 0;
     &nDeci_PreBase = 0;
     &nDeci_EsCab = 0;
     &nDeci_EsLin = 0;

     &Tempo    = "";
     &enErr          = 0;
     &nModcab       = 0;
     nim        = 0;
     &nDec      = 0;
     nNume    = 0;
     nNume1   = 0;
     aAlfa    = "";
     nMod     = 0;
     informe  = "gopre024";
     coste    = 0         ;
     nivel    = 0         ;
     maxnivel = 0         ;
     espacios = "                ";
     escandall= " ";
     nCalculo = 0;
     impcompone = 0;
     nForma     = 0;
     nContenido = 0;
     nPrecio    = 0;

     &wtip   = 0;
     nPvp = 0;
     nCampo = 0;
     nIVA  = 0;
     nPvpSin = 0;
|FIN;

|CAMPOS;
     ||Lineas Escandallo
     #1#0 linesca  ;
     #1#1 linlinea ;
     #1#2 linartic ;
     #1#8 linivel  ;

     ||Articulo
     #2#0  artic    ;
     #2#6  stocktot ;
     #2#9  preco    ;
     #2#10 vstock   ;

     ||Temporal
     #3#0 tmpescal ;
     #3#1 tmp1busc ;
     #3#2 tmp2busc ;

     ||Almacenes
     #4#0 almcodig ;
     #4#1 almalmac ;
     #4#5 almstock ;
     #4#3 almvastk ;
|FIN;

|PROCESO KitFab; |TIP O7;
     |SI #5#12 = "X";
          |C_M #0#33, 1, "S";
     |SINO;
          |C_M #0#33, 1, "N";
     |FINSI;
|FPRC;

|PROCESO Pack; |TIPO 7;
     |ABRE #5; |LEE 000#5p; |CIERRA #5;
     |SI #5#126 = 0;
          |C_M #0#15, 1, "N";
     |SINO;
          |C_M #0#15, 1, "S";
     |FINSI;
|FPRC;

|PROCESO Tipo6Cab; |TIPO 6;
     enAlta = 1;
     eaArticulo = #0Campo;
     |HAZ LlenaArticulo;
     |SI FSalida = 0;
          #0Campo = eaArticulo;
          |PINTA #0Campo;
     |SINO;
          |ERROR; |ACABA;
     |FINSI;
|FPRC;

|PROCESO Modifica;
     |C_M #0#16, 1, "S";
     |C_M #0#26, 1, "S";
     |C_M #0#23, 1, "S";
     |C_M #0#27, 1, "S";
     |C_M #0#24, 1, "S";
     |C_M #0#28, 1, "S";
     |C_M #0#25, 1, "S";
     |C_M #0#29, 1, "S";

     |SI #0#17 = "N";
         |C_M #0#16, 1, "N";  #0#16 = 0;   |PINTA #0#16;
         |C_M #0#26, 1, "N";  #0#26 = "I"; |PINTA #0#26;
     |FINSI;

     |SI #0#18 = "N";
         |C_M #0#23, 1, "N";  #0#23 = 0;   |PINTA #0#23;
         |C_M #0#27, 1, "N";  #0#27 = "I"; |PINTA #0#27;
     |FINSI;

     |SI #0#19 = "N";
         |C_M #0#24, 1, "N";  #0#24 = 0;   |PINTA #0#24;
         |C_M #0#28, 1, "N";  #0#28 = "I"; |PINTA #0#28;
     |FINSI;

     |SI #0#20 = "N";
         |C_M #0#25, 1, "N";  #0#25 = 0;   |PINTA #0#25;
         |C_M #0#29, 1, "N";  #0#29 = "I"; |PINTA #0#29;
     |FINSI;
|FPRC;

|PROCESO imprelia;
     |SI nCalculo = 1;

         impcompone = #1#6 / #0#6;
         |SI #1#10 = 1; #0#8 = #0#8 + impcompone;    |FINSI;   ||Componentes
         |SI #1#10 = 2; #0#2 = #0#2 + impcompone;    |FINSI;   ||Mano Obra
         |SI #1#10 = 3; #0#3 = #0#3 + impcompone;    |FINSI;   ||Maquinaria
         |SI #1#10 = 4; #0#4 = #0#4 + impcompone;    |FINSI;   ||Otros

         |SI #1#10 = 1;
             |SI #0#17 = "S";
                 |SI #0#26 = "D";
                     #0#21 = #0#21 + (#1#6 > #0#16);
                 |SINO;
                     #0#21 = #0#21 + (#1#6 / ((100 - #0#16) / 100));
                 |FINSI;
             |SINO;
                 #0#21 = #0#21 + #1#6;
             |FINSI;
         |FINSI;

         |SI #1#10 = 2;
             |SI #0#19 = "S";
                 |SI #0#28 = "D";
                     #0#21 = #0#21 + (#1#6 > #0#24);
                 |SINO;
                     #0#21 = #0#21 + (#1#6 / ((100 - #0#24) / 100));
                 |FINSI;
             |SINO;
                 #0#21 = #0#21 + #1#6;
             |FINSI;
         |FINSI;

         |SI #1#10 = 3;
             |SI #0#18 = "S";
                 |SI #0#27 = "D";
                     #0#21 = #0#21 + (#1#6 > #0#23);
                 |SINO;
                     #0#21 = #0#21 + (#1#6 / ((100 - #0#23) / 100));
                 |FINSI;
             |SINO;
                 #0#21 = #0#21 + #1#6;
             |FINSI;
         |FINSI;

         |SI #1#10 = 4;
             |SI #0#20 = "S";
                 |SI #0#29 = "D";
                     #0#21 = #0#21 + (#1#6 > #0#25);
                 |SINO;
                     #0#21 = #0#21 + (#1#6 / ((100 - #0#25) / 100));
                 |FINSI;
             |SINO;
                 #0#21 = #0#21 + #1#6;
             |FINSI;
         |FINSI;

         #0#5 = #0#2 + #0#3 + #0#4;         || total otros costes
         #0#11 = (#0#5 + #0#8) > #0#7;      || total serie
         #0#11 = #0#11 > #0#34;
         #0#9 = #0#11 / #0#12;              || total unitario
         |HAZ CosteModulo;

         |PINTA #0#2;
         |PINTA #0#3;
         |PINTA #0#4;
         |PINTA #0#5;
         |PINTA #0#8;
         |PINTA #0#9;
         |PINTA #0#11;
         |PINTA #0#21;
     |SINO;
         |PRINT;
     |FINSI;
|FPRC;

|PROCESO Tipo4; |TIPO 4;
     |IMPRE 1;
     |SI 0 = FSalida;
          |INFOR informe;
          |SI 0 = FSalida;
               wtip = 2;
               |BUCLELIN 2imprelia#0;
               |PIEINF;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO totcoste; |TIPO 0;
     #0#5 = #0#2 + #0#3 + #0#4;
     #0#11 = (#0#5 + #0#8) > #0#7;
     #0#11 = #0#11 > #0#34;
     #0#9 = #0#11 / #0#12;
     |HAZ CosteModulo;
     |PINTA #0#5;
     |PINTA #0#11;
     |PINTA #0#9;
|FPRC;

|PROCESO npiezas; |TIPO 0;
     |DDEFECTO #2;
     |ABRE #2;
     #2#0 = #0#0;
     |LEE 000#2=;
     |SI #2#13 > 0;|Y #0Campo ! Contenido;
         |MENAV "0000Existen ordenes de fabricacion del escandallo ...";
         #0Campo = Contenido;
         |PINTA #0Campo;
         |ERROR;
     |SINO;
         #0#9 = #0#11 / #0#12;
         |HAZ CosteModulo;
         |PINTA #0#9;
     |FINSI;
     |CIERRA #2;

     #0#22 = #2#18;   |PINTA #0#22;
|FPRC;

|PROCESO Tipo1; |TIPO 1;
     ||proceso para registros anteriores a a¤adir coste unitario
     |SI #0#12 = 1;
         |SI #0#11 ! #0#9;
            #0#12 = 1;
            #0#11 = #0#9;
            |PINTA #0#11;
            |PINTA #0#9;
            |GRABA 020#0a;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO EnEs; |TIPO 7;
     ||HAZ ControlUsuLL;
     |SI enErr ! 0; |PTEC 807; |ACABA; |FINSI;
|FPRC;

|PROCESO tipo7;     |TIPO 7;
     nMod = (FEntrada / 100 ) ! 0;
     |SI nMod = 2;
          |C_M #0#2, 1, "N";
          |C_M #0#3, 1, "N";
          |C_M #0#4, 1, "N";
          |C_M #0#7, 1, "N";
     |SINO;
          |C_M #0#2, 1, "S";
          |C_M #0#3, 1, "S";
          |C_M #0#4, 1, "S";
          |C_M #0#7, 1, "S";


          #0#17 = #46#1;  |PINTA #0#17;
          #0#16 = #46#5;  |PINTA #0#16;
          #0#26 = #46#9;  |PINTA #0#26;
          #0#18 = #46#2;  |PINTA #0#18;
          #0#23 = #46#6;  |PINTA #0#23;
          #0#27 = #46#10; |PINTA #0#27;
          #0#19 = #46#3;  |PINTA #0#19;
          #0#24 = #46#7;  |PINTA #0#24;
          #0#28 = #46#11; |PINTA #0#28;
          #0#20 = #46#4;  |PINTA #0#20;
          #0#25 = #46#8;  |PINTA #0#25;
          #0#29 = #46#12; |PINTA #0#29;
     |FINSI;
|FPRC;

|PROCESO Tipo14; |TIPO 14;
     |ABRE #5; |LEE 000#5p; |CIERRA #5;
     nDec = #5#8;
|FPRC;

|PROCESO baja; |TIPO 2;
     ||HAZ ControlUsuLL;
     |SI enErr ! 0; |ERROR; |ACABA; |FINSI;

     nModcab = (FEntrada / 100 ) ! 0;
     nForma  = 0 +. 1;
     |SI nForma = 1;
          nCalculo = 1;
          #0#2  = 0;
          #0#3  = 0;
          #0#4  = 0;
          #0#8  = 0;
          #0#21 = 0;
          #0#5  = 0;
          #0#11 = 0;
          #0#9  = 0;
          |BUCLELIN 2imprelia#0;
          nCalculo = 0;
          |ABRE #2;
          #2#0 = #0#0;
          |LEE 000#2=;
          |CIERRA #2;

          enTiva = #2#30;
          efFiva = ~;
          |HAZ SacaIVA;

          nPvp = #0#21;
          |SI #46#13 = "S";
               nPvp = nPvp > enIva;
          |FINSI;

          |SI #46#14 = "S";
               nNume = 1;
               |PARA nCampo = 1; |SI nCampo [ nDeci_EsCab; |HACIENDO nCampo = nCampo + 1;
                    nNume = nNume * 10;
               |SIGUE;
               nPvp = nPvp * nNume;

               |SI #2#109 > 0; nPvp = nPvp + (#2#109-1); |FINSI;
               nNume1 = (nPvp $ #2#109);
               |SI nNume1 ! 0;
                    nPvp = nPvp - nNume1;
               |FINSI;

               nPvp = nPvp / nNume;
          |FINSI;
          #0#21 = nPvp; |PINTA #0#21;
     |FINSI;
|FPRC;

|PROCESO CompaIVA;
     nContenido = Contenido;
     |SI nContenido = #45Campo;  |ACABA;  |FINSI;

     |HAZ LeeIVA;
||     |SI #46#13 = "N";
||          #45#4 = #45#8 / (1+ (enIva / 100));
||     |SINO;
          #45#4 = #45#8;
||     |FINSI;

     #45#3 = 100 - ((#45#0 / #45#4) * 100);
     |PINTA #45#3;
     |PINTA #45#4;
     |PINTA #45#8;
|FPRC;

|PROCESO Comparativo;
     nContenido = Contenido;
     |SI nContenido = #45Campo;  |ACABA;  |FINSI;

     |HAZ LeeIVA;

     |SI Campo = 3;
         #45#4 = #45#0 /  ((100 - #45#3) / 100);
         #45#4 = #45#4 > enIva; ||**
     |FINSI;

     |SI Campo = 4;
         nPvpSin = #45#4 / ( 1 + (enIva/100));   ||quito el iva **
         #45#3 = 100 - ((#45#0 / nPvpSin) * 100);|| **
||        #45#3 = 100 - ((#45#0 / #45#4) * 100); || **
     |FINSI;

     |HAZ CalcuIVA;
     #45#8 = nPvp;

     |PINTA #45#3;
     |PINTA #45#4;
     |PINTA #45#8;
|FPRC;

|PROCESO Tarifa;
/*
     |SI #45#6 = 1;  #45#7 = #2#130;  |FINSI;
     |SI #45#6 = 2;  #45#7 = #2#131;  |FINSI;
     |SI #45#6 = 3;  #45#7 = #2#132;  |FINSI;
     |SI #45#6 = 4;  #45#7 = #2#153;  |FINSI;
     |SI #45#6 = 5;  #45#7 = #2#154;  |FINSI;
     |SI #45#6 = 6;  #45#7 = #2#155;  |FINSI;
     |PINTA #45#7;
*/
|FPRC;

|PROCESO LeeIVA;
     |ABRE #2;
     #2#0 = #0#0;
     |LEE 000#2=;
     |CIERRA #2;

     enTiva = #2#30;
     efFiva = ~;
     |HAZ SacaIVA;
|FPRC;

|PROCESO CalcuIVA;
     |HAZ LeeIVA;
     nPvp = #45#4;
   ||  |SI #46#13 = "S";
          nPvp = nPvp > enIva;
   ||  |FINSI;

     |SI #46#14 = "S";
          nNume = 1;
          |PARA nCampo = 1; |SI nCampo [ nDeci_EsCab; |HACIENDO nCampo = nCampo + 1;
               nNume = nNume * 10;
          |SIGUE;
          nPvp = nPvp * nNume;

          |SI #2#109 > 0; nPvp = nPvp + (#2#109-1); |FINSI;
          nNume1 = (nPvp $ #2#109);
          |SI nNume1 ! 0;
               nPvp = nPvp - nNume1;
          |FINSI;

          nPvp = nPvp / nNume;
     |FINSI;
|FPRC;

|PROCESO Boton1;
     |PUSHV 0501 2380;
     |ATRI N; |BLANCO 717 2255;
     #45#0 = #0#11;
     #45#1 = #0#22;
     #45#2 = #0#21;
     #45#3 = #0#30;
     #45#4 = #0#31;
     #45#8 = #0#32;

     |SI #45#8 = 0;  |Y #45#4 = 0;
          |HAZ LeeIVA;
          nPvpSin = #45#2 / ( 1 + (enIva/100));   ||**
          #45#3 = 100 - ((#45#0 * 100) / nPvpSin);||**
          #45#4 = #45#0 /  ((100 - #45#3) / 100); ||**
          #45#4 = #45#4 > enIva;                  ||**

||          #45#3 = 100 - ((#45#0 * 100) / #45#2);
||          #45#4 = #45#0 /  ((100 - #45#3) / 100);

          |SI #46#13 = "N"
               |HAZ CalcuIVA;
               #45#8 = nPvp;
          |SINO;
               #45#8 = #45#4;
          |FINSI;
     |FINSI;

     |C_V #45#5, 1, "N";  |C_M #45#5, 1, "N";
     |C_V #45#6, 1, "N";  |C_M #45#6, 1, "N";
     |C_V #45#7, 1, "N";  |C_M #45#7, 1, "N";
     |C_M #45#3, 1, "S";
     |C_M #45#4, 1, "S";
     |C_M #45#8, 1, "S";

     |PINPA #0#45;
     |PINDA #0#45;
     |ENDATOS #1#45;
     |SI FSalida = 0;
         #0#30 = #45#3;
         #0#31 = #45#4;
         #0#32 = #45#8;
     |FINSI;
     |POPV;
     |PINTA #0#30;
     |PINTA #0#31;
|FPRC;

|PROCESO Boton2;
     |PUSHV 0501 2380;
     |ATRI N; |BLANCO 717 2255;
     #45#0 = #0#11;
     #45#1 = #0#22;
     #45#2 = #0#21;
     #45#3 = #0#30;
     #45#4 = #0#31;
     #45#7 = #46#13; ||IVA S/N
     #45#8 = #0#32;

     |C_V #45#5, 1, "S";  |C_M #45#5, 1, "S";
     |C_V #45#6, 1, "S";  |C_M #45#6, 1, "S";
     |C_V #45#7, 1, "S";
     |C_M #45#3, 1, "N";
     |C_M #45#4, 1, "N";
     |C_M #45#8, 1, "N";

     |ABRE #2;
     #2#0 = #0#0;
     |LEE 101#2=;
     |SI FSalida = 0;
         |PINPA #0#45;
         |ATRI R;
         |PINTA 1820,"PVP Calculado/Comparativo C/P :";
         |PINTA 1920,"Grabar en Tarifa .............:";
         |ATRI I;
         |PINTA 2020,"IVA incluido ... .............:";
         |ATRI 0;

         |PINDA #0#45;
         |ENDATOS #1#45;
         |SI FSalida = 0;
             nPrecio = #45#2;
             |SI #45#5 = "P";
/*
                 |SI #45#7 = "S";
                    nPrecio = #45#8;
                 |SINO;
                    nPrecio = #45#4;
                 |FINSI;
*/
                 nPrecio = #45#4;
             |FINSI;
             |SI #45#6 = 1;  #2#18  = nPrecio;  #2#130 = #45#7;  |FINSI;
             |SI #45#6 = 2;  #2#19  = nPrecio;  #2#131 = #45#7;  |FINSI;
             |SI #45#6 = 3;  #2#20  = nPrecio;  #2#132 = #45#7;  |FINSI;
             |SI #45#6 = 4;  #2#147 = nPrecio;  #2#153 = #45#7;  |FINSI;
             |SI #45#6 = 5;  #2#148 = nPrecio;  #2#154 = #45#7;  |FINSI;
             |SI #45#6 = 6;  #2#149 = nPrecio;  #2#155 = #45#7;  |FINSI;
             |GRABA 020#2a;
             |LIBERA #2;

             |SI #45#6 = 1;
                 #0#22 = nPrecio;
             |FINSI;
         |FINSI;
     |FINSI;

     |POPV;
     |PINTA #0#22;
|FPRC;

|PROCESO Tipo3m48;  |TIPO 3;
     |CONFI "0000N¿Actualizar precios según último precio compra?";
     |SI FSalida = 0;
          |HAZ ActPrecios;
     |FINSI;

     |CONFI "0000N¿Actualizar escandallo?";
     |SI FSalida = 0;
          |HAZ ActEscandallo;
     |FINSI;


     |CONFI "0000N¿Actualizar PCM del Articulo?";
     |SI FSalida = 0;
          |ABRE #2;
          #2#0 = #0#0;
          |LEE 101#2=;
          |SI FSalida = 0;
               #2#9 = #0#11;
               |GRABA 020#2a;
          |FINSI;
          |CIERRA #2;

          |ABRE #17;
          #17#0 = #0#0;
          #17#1 = #0#10;
          |LEE 101#17=;
          |SI FSalida = 0;
               #17#69 = #0#11;     || PCM
               |GRABA 020#17a;
          |FINSI;
          |CIERRA #17;
     |FINSI;
|FPRC;

|PROCESO Tipo8;  |TIPO 8;
     |ABRE #agifa324;
     |ABRE #agifa321;
     |LEE 001#agifa321.p;
     #agifa324#0 = #agifa321#9;    ||Igualo a moneda base
     |LEE 001#agifa324.=;
     nDeci_Base = #agifa324#7;     ||Decimales moneda base
     nDeci_PreBase = #agifa324#9;  ||Decimales precio de moneda base
     |CIERRA #agifa321;
     |CIERRA #agifa324;

     |ABRE #46;
     |LEE 040#46p;
     |SI FSalida ! 0;  |DDEFECTO #46;  |FINSI;
     |CIERRA #46;

     nDeci_EsCab = #46#15;
     nDeci_EsLin = #46#16;
|FPRC;

|PROCESO Tipo9;  |TIPO 9;
|FPRC;

|PROCESO Tipo30_48; |TIPO 30;
|FPRC;

|PROCESO CosteModulo;
|FPRC;

|PROCESO Tipo7_48; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          #0#34 = #46#17;
          |PINTA #0#34;
     |FINSI;
|FPRC;

|PROCESO Tipo13_48; |TIPO 13;
|FPRC;

|PROCESO EscanLin13; |TIPO 13;
|FPRC;

|PROCESO Observa49; |TIPO 0;
     |SI FSalida = 0; |O FSalida = 3;
     |FINSI;
|FPRC;

|PROCESO DefTipo; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |ABRE #5; |LEE 000#5p; |CIERRA #5;
          |SI #5#12 = "K";
               #0#33 = "K";
          |SINO;
               #0#33 = "N";
          |FINSI;
     |FINSI;
|FPRC;
-----------------------------------------------------------------------
|PROCESO ActPrecLin;
     #2#0 = #1#2;
     |LEE 000#2=;
     #1#5 = #2#133;
     #1#15 = #2#133;
     |GRABA 020#1a;
     |LIBERA #1;
     |HAZ RecalEscan;
|FPRC;

|PROCESO ActPrecios;
     #0#8 = 0;
     #0#2 = 0;
     #0#3 = 0;
     #0#4 = 0;
     #0#21 = 0;
     |ABRE #2;
     |BUCLELIN 0 ActPrecLin #0;
     |CIERRA #2;
|FPRC;

|PROCESO ActEscanLin;
     |PARA i = 0; |SI i [ 20; |HACIENDO i = i + 1;
          #490i = #1i;
     |SIGUE;
     |GRABA 020#490n;
|FPRC;

|PROCESO ActEscandallo;
     |ABRE #480;
     |ABRE #490;
     #480#0 = #0#0;
     |LEE 101#480=;
     |SI FSalida = 0;
          |BUCLELIN 1 NULL #480;
          |BUCLELIN 0 ActEscanLin #0;
          |PARA i = 0; |SI i [ 34; |HACIENDO i = i + 1;
               #480i = #0i;
          |SIGUE;
          |GRABA 020#480a;
     |FINSI;
     |CIERRA #490;
     |CIERRA #480;
|FPRC;

|PROCESO Min;
     #1#21 = #0#35;
     #1#22 = #0#36;
     #1#23 = #0#37;
     #1#24 = #0#38;
     #1#25 = #0#39;
     #1#0 = #0#0;
     #1#1 = 1;
|FPRC;

|PROCESO Max;
     #1#21 = #0#35;
     #1#22 = #0#36;
     #1#23 = #0#37;
     #1#24 = #0#38;
     #1#25 = #0#39;
     #1#0 = #0#0;
     #1#1 = 999;
|FPRC;

|PROGRAMA;
     aAlfa = PARAMETRO % 105; aSer = aAlfa;
     aAlfa = PARAMETRO % 606; nNum = aAlfa;
     aAlfa = PARAMETRO % 1220; aCap = aAlfa;
     aAlfa = PARAMETRO % 3220; aPar = aAlfa;
     aAlfa = PARAMETRO % 5203; nLin = aAlfa;
     aAlfa = PARAMETRO % 5520; aArt = aAlfa;
     aAlfa = PARAMETRO % 7501; aModo = aAlfa;
     |ABRE #0;
     #0#35 = aSer;
     #0#36 = nNum;
     #0#37 = aCap;
     #0#38 = aPar;
     #0#39 = nLin;
     #0#0 = aArt;
     |LEE 101#0=;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
     |PINPA #0#0;
     |PINDA #0#0;
     |SI aModo = "C";
          |ENTLINEAL #1#1, 7, 4, 22, 0, Min, Max;
     |SINO;
          |ENDATOS #1#0;
          |SI FSalida = 0;
               |GRABA 020#0a;
          |FINSI;
     |FINSI;
     |CIERRA #0;
|FPRO;
