|FICHEROS;
     fmart001 #0;
     dsm00003 #3;
     agifa010 #10;
     agifa019 #19;
     agifa024 #24;
     agifa038 #38;
     agifa069 #69;
     agifa071 #71;
     agifa084 #84;
     referen@;      ||Tmp clientes

     agifa071@;     ||Para buscar la linea promocion
     agifa069@;     ||Para buscar la linea promocion
|FIN;

|VARIABLES;
     aIP = "";
     &Tempo = "";
     &aDivisa = "";
     &aMoneda = "";
     &eaAlfa = "";
     nPanta = 0;
     nBtnPath = 0;
     aPath = "";
     fHoy = @;
     aAlfa = "";
     aDes = "";
     aOrg = "";
     aPathOrg = "";
     nHandle = 0;
     aFic = "";
     aNom = "";
     aLF = "";
     aTipo = "";
     nPos = 0;
     nLon = 0;
     aAlf1 = "";
     nDec = 0;
     nNu1 = 0;
     nNu2 = 0;
     nAbo = "";
     nNume = 0;
     nImpo = 0;
     nTotal = 0;
     nTipo = 0;
     nLinea = 0;
|FIN;

|PROCESO BuscaLineaFac;
     nLinea = #69#1;

     #agifa069@#20 = #69#20;
     #agifa069@#0 = #69#0;
     #agifa069@#1 = 1;
     |LEE 000#agifa069@.];
     |PARA; |SI FSalida = 0; |HACIENDO;
               |Y #agifa069@#20 = #69#20;
               |Y #agifa069@#0 = #69#0;

          |SI #agifa069@#45 = nLinea;
               nLinea = #agifa069@#1; |SAL;
          |FINSI;

          |LEE 000#agifa069@.s;
     |SIGUE;
|FPRC;

|PROCESO BuscaLineaAlb;
     nLinea = #71#1;

     #agifa071@#29 = #71#29;
     #agifa071@#0 = #71#0;
     #agifa071@#1 = 1;
     |LEE 000#agifa071@.];
     |PARA; |SI FSalida = 0; |HACIENDO;
               |Y #agifa071@#29 = #71#29;
               |Y #agifa071@#0 = #71#0;

          |SI #agifa071@#63 = nLinea;
               nLinea = #agifa071@#1; |SAL;
          |FINSI;

          |LEE 000#agifa071@.s;
     |SIGUE;
|FPRC;

|PROCESO Relleno;
     |SI aTipo = "F";
          nPos = nLon;
          |SI aAlfa ! "";
               aAlfa = (aAlfa % -104) + (aAlfa % 402) + (aAlfa % 102);
          |FINSI;
          aAlf1 = " " * nPos;
          aAlfa = aAlfa + aAlf1;
          nPos = nPos + 100;
          aAlfa = aAlfa % nPos;
     |FINSI;

     |SI aTipo = "A";
          eaAlfa = aAlfa; |HAZ QuitaRarosExp; aAlfa = eaAlfa;
          aAlf1 = " " * nLon;
          aAlfa = aAlfa + aAlf1;
          nPos = nLon + 100;
          aAlfa = aAlfa % nPos;
     |FINSI;

     |SI aTipo = "N";
          nNume = aAlfa;
          |SI nNume < 0; nAbo = -1; |SINO; nAbo = 1; |FINSI;
          |SI nNume < 0; nNume = nNume * - 1; |FINSI;
          nNu1 = nNume ! 0;
          |SI nNu1 > nNume; nNu1 = nNu1 - 1; |FINSI;
          nNu2 = nNume - nNu1;
          |SI nDec < 0;
               aAlfa = nNume;
          |SINO;
               |SI nDec = 0;
                    aAlfa = nNu1;
               |SINO;
                    aAlfa = nNu2;
                    aAlfa = aAlfa + "00000000000000000000000000";
                    nPos = nDec + 300;
                    aAlfa = aAlfa % nPos;

                    || CON PUNTO DECIMAL
                    ||aAlfa = nNu1 + "." + aAlfa;

                    || SIN PUNTO DECIMAL
                    aAlfa = nNu1 + aAlfa;
               |FINSI;
          |FINSI;
          aAlfa = "000000000000000000000000000000000000000000000" + aAlfa;
          |SI nAbo = 1;
               nPos = -1 * (nLon + 100);
               aAlfa = aAlfa % nPos;
          |SINO;
               nPos = -1 * (nLon + 99);
               aAlfa = "-" + aAlfa % nPos;
          |FINSI;
          nDec = 0;
     |FINSI;
     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO Clientes;
     |DDEFECTO #3;
     #3#0 = #referen@#0;
     #3#1 = #referen@#1;
     |LEE 000#3=;

     |DDEFECTO #24;
     #24#0 = #referen@#0;
     |LEE 000#24=;

||Cod. distribuidor   Num. 6    S    Código del distribuidor  Solicitado en pantalla
     aAlfa = #0#1;
     aTipo = "N"; nLon = 6; |HAZ Relleno;

||Cod. Establecimiento     Char 15   S    Código del establecimiento cliente Cod.cliente+código dirección entrega agifa010#3 +agifa010#84
||     aAlfa = #3#0 + (("0000" + #3#1) % -104);
     aAlfa = #3#0;
     aTipo = "A"; nLon = 15; |HAZ Relleno;

||Nombre establecimiento     Char 40   S    Nombre del establecimiento    Nombre comercial de la dirección entrega dsm0003#10
     aAlfa = #3#10;
     aTipo = "A"; nLon = 40; |HAZ Relleno;

||Nombre Titular Char 40   S    Titular del establecimiento   Nombre fiscal cliente agifa024#1
     aAlfa = #24#1;
     aTipo = "A"; nLon = 40; |HAZ Relleno;

||CIF  Char 9    S    CIF titular    agifa024#15
     aAlfa = #24#15;
     aTipo = "A"; nLon = 9; |HAZ Relleno;

||Dirección Char 40   S    Dirección dsm0003#2
     aAlfa = #3#2;
     aTipo = "A"; nLon = 40; |HAZ Relleno;

||Población Char 40   S    Población dsm0003#3
     aAlfa = #3#3;
     aTipo = "A"; nLon = 40; |HAZ Relleno;

||Provincia Char 40   S    Provincia dsm0003#7
     aAlfa = #3#7;
     aTipo = "A"; nLon = 40; |HAZ Relleno;

||Código postal  Char 5    S    Código postal  dsm0003#6
     aAlfa = #3#6;
     aTipo = "N"; nLon = 5; |HAZ Relleno;


     |XGRABA nHandle, aLF;
|FPRC;


|DEFBUCLE Clientes;
     #referen@#1002;
     ;
     "      ", 0001;
     "zzzzzz", 999;
     ;
     NULL, Clientes;
|FIN;


|PROCESO LinAlbaran;
||Cod. distribuidor Num. 6    S    Código del distribuidor  Solicitado en pantalla
     aAlfa = #0#1;
     aTipo = "N"; nLon = 6; |HAZ Relleno;

||Albaran Num  6    S    NºAlbaran #agifa010#0
     aAlfa = #10#0;
     aTipo = "N"; nLon = 6; |HAZ Relleno;

||Linea   Num  3    S    Nº línea dentro del albarán (*)    #agifa071#1
     |SI #71#63 = -1;
          |HAZ BuscaLineaAlb;
          aAlfa = nLinea;
     |SINO;
          aAlfa = #71#1;
     |FINSI;
     aTipo = "N"; nLon = 3; |HAZ Relleno;

||Cod. Establecimiento   Char 15   S    Código del establecimiento cliente Cod.cliente+ código dirección entrega  agifa010#3 +agifa010#84
||     aAlfa = #10#3 + (("0000" + #10#84) % -104);
     aAlfa = #10#3;
     aTipo = "A"; nLon = 15; |HAZ Relleno;

||Nom.Establecimiento
     aAlfa = #24#1;
     aTipo = "A"; nLon = 40; |HAZ Relleno;

||Fecha albaran     Num  8    S    Fecha albaran  agifa010#1 transformado a formato AAAAMMDD
     aAlfa = #10#1;
     aTipo = "F"; nLon = 8; |HAZ Relleno;

||Cod. Producto     Char 20   S    Producto  #agifa071#2
     aAlfa = #71#2;
     aTipo = "A"; nLon = 20; |HAZ Relleno;

||Descripcion  Char 40   S    Descripcion Producto     #agifa071#4
     aAlfa = #71#4;
     aTipo = "A"; nLon = 40; |HAZ Relleno;

||Tipo movimiento   Char 1    S    (C) Cargo o abono (A)    Si agifa071#5 >0 sera C y si agifa071#5<0 sera A
     |SI #71#5 > 0;
          aAlfa = "C";
     |SINO;
          aAlfa = "A";
     |FINSI;
     aTipo = "A"; nLon = 1; |HAZ Relleno;

||Tipo de línea
||(Si se producen varios casos hay que crear un registro para cada tipo)   Num  1    S    Valores:
||Venta (0), dto Mercancia(1), dto euros(2) y dto porcentaje (3)   Según:
||(0) agifa071#6 =agifa019#18 y agifa071#8=0
||(1) agifa071#8=100
||(2) agifa071#6<agifa019#18
||(3) 0<agifa071#8<100
     aAlfa = nTipo;
     aTipo = "N"; nLon = 1; |HAZ Relleno;

||Cantidad     Num  5,3  S    Unidades  agifa071#5
     |SI #71#5 < 0;
          nNume = -#71#5;
          aAlfa = nNume;
     |SINO;
          aAlfa = #71#5;
     |FINSI;

     aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;

||ImporteUnitario   Num  8,3  S    Precio o descuento  unitario de venta
||Según el valor del tipo de línea: (0 y 1) agifa019#18  (2)agifa019#18-agifa071#6 (3)agifa071#8
     |SI nImpo < 0;
          nNume = -nImpo;
          aAlfa = nNume;
     |SINO;
          aAlfa = nImpo;
     |FINSI;
     aTipo = "N"; nLon = 11; nDec = 3; |HAZ Relleno;

||Total   Num  8,3  S    Importe linea  Según el valor del tipo de línea:
||(0 y 1) agifa019#18 *agifa071#5
||(2)(agifa019#18-agifa071#6)*agifa071#5
||(3)(agifa071#6%agifa071#8)*agifa071#5
     |SI nTotal < 0;
          nNume = -nTotal;
          aAlfa = nNume;
     |SINO;
          |SI nTipo = 1;
               nTotal = #71#5 * #19#18;
          |FINSI;
          aAlfa = nTotal;
     |FINSI;
     aTipo = "N"; nLon = 11; nDec = 3; |HAZ Relleno;

||Nº Factura   Char 20   S    Nº Factura     agifa010#53+agifa010#39
     aAlfa = #10#53 + (("000000" + #10#39) % -106);
     aTipo = "A"; nLon = 20; |HAZ Relleno;

||Fecha factura     Num  8    S    Fecha factura  agifa010#60 adaptado AAAAMMDD
     aAlfa = #10#60;
     aTipo = "F"; nLon = 8; |HAZ Relleno;

||Observaciones     Char 30   N    Uso libre
     aAlfa = "";
     aTipo = "A"; nLon = 30; |HAZ Relleno;

||Promoción Multiple     Char 10   N    Codigo promo   Diez primeros caracteres del campo agifa038#1 (descripción ampliada), relacionado según el valor de agifa071#27, por si lo tuviesen que indicar.
     aAlfa = #38#1;
     aTipo = "A"; nLon = 10; |HAZ Relleno;

     |XGRABA nHandle, aLF;
|FPRC;

|PROCESO Albaranes;
     |SI #71#13 ] #0#5; |Y #71#13 [ #0#6; |Y #71#5 ! 0;
          #referen@#0 = #10#3;
          #referen@#1 = #10#84;
          |LEE 000#referen@.=;
          |SI FSalida ! 0;
               |GRABA 020#referen@.n;
          |FINSI;

          #19#0 = #71#2;
          |LEE 000#19=;
          |SI FSalida ! 0; |DDEFECTO #19; |FINSI;

          #38#0 = #71#27;
          |LEE 000#38=;
          |SI FSalida ! 0; |DDEFECTO #38; |FINSI;

          |SI #71#6 = 0;      || Sin cargo
               |SI #71#63 ! -1;    || linea promocion
                    nTipo = 0;
                    nImpo = #19#18;
                    nTotal = #71#5 * #19#18;
                    |HAZ LinAlbaran;
               |FINSI;

               nTipo = 1;
               nImpo = #19#18;
               nTotal = 0;
               |HAZ LinAlbaran;
          |SINO;
               |SI #71#8 = 100;    || Dto Mercancia
                    nTipo = 0;
                    nImpo = #19#18;
                    nTotal = #19#18 * #71#5;
                    |HAZ LinAlbaran;

                    nTipo = 1;
                    nImpo = #19#18;
                    nTotal = #19#18 * #71#5;
                    |HAZ LinAlbaran;
               |SINO;
                    |SI #71#6 ! #19#18; || Dto Euros
                         nTipo = 0;
                         nImpo = #19#18;
                         nTotal = #19#18 * #71#5;
                         |HAZ LinAlbaran;

                         nTipo = 2;
                         nImpo = #19#18 - #71#6;
                         nTotal = (#19#18 - #71#6) * #71#5;
                         |HAZ LinAlbaran;

                         |SI #71#8 > 0; |Y #71#8 < 100;     || Dto %
                              nTipo = 3;
                              nImpo = #71#8;
                              nTotal = (#71#6 % #71#8) * #71#5;
                              |HAZ LinAlbaran;
                         |FINSI;
                    |SINO;
                         |SI #71#8 > 0; |Y #71#8 < 100;     || Dto %
                              nTipo = 0;
                              nImpo = #71#6;
                              nTotal = #71#6 * #71#5;
                              |HAZ LinAlbaran;

                              nTipo = 3;
                              nImpo = #71#8;
                              nTotal = (#71#6 % #71#8) * #71#5;
                              |HAZ LinAlbaran;
                         |SINO;
                              nTipo = 0;
                              nImpo = #19#18;
                              nTotal = #19#18 * #71#5;
                              |HAZ LinAlbaran;
                         |FINSI;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO CabAlb;
     #24#0 = #10#3;
     |LEE 000#24=;
     |SI FSalida ! 0; |DDEFECTO #24; |FINSI;

     aDivisa = #10#68;
     aMoneda = #10#70;
     |HAZ Divisas010;
|FPRC;

|DEFBUCLE Albaranes;
     #10#7;
     ;
     #0#3, "     ", 000001;
     #0#4, "zzzzz", 999999;
     ;
     NULL, CabAlb, Albaranes;
|FIN;

|PROCESO LinFactura;
||Cod. distribuidor Num. 6    S    Código del distribuidor  Solicitado en pantalla
     aAlfa = #0#1;
     aTipo = "N"; nLon = 6; |HAZ Relleno;

||Albaran Num  6    S    NºAlbaran #agifa010#0
     aAlfa = #84#0;
     aTipo = "N"; nLon = 6; |HAZ Relleno;

||Linea   Num  3    S    Nº línea dentro del albarán (*)    #agifa071#1
     |SI #69#45 = -1;
          |HAZ BuscaLineaFac;
          aAlfa = nLinea;
     |SINO;
          aAlfa = #69#1;
     |FINSI;
     aTipo = "N"; nLon = 3; |HAZ Relleno;

||Cod. Establecimiento   Char 15   S    Código del establecimiento cliente Cod.cliente+ código dirección entrega  agifa010#3 +agifa010#84
||     aAlfa = #84#3 + (("0000" + #84#91) % -104);
     aAlfa = #84#3;
     aTipo = "A"; nLon = 15; |HAZ Relleno;

||Nom.Establecimiento
     aAlfa = #24#1;
     aTipo = "A"; nLon = 40; |HAZ Relleno;

||Fecha albaran     Num  8    S    Fecha albaran  agifa010#1 transformado a formato AAAAMMDD
     aAlfa = #84#1;
     aTipo = "F"; nLon = 8; |HAZ Relleno;

||Cod. Producto     Char 20   S    Producto  #agifa071#2
     aAlfa = #69#2;
     aTipo = "A"; nLon = 20; |HAZ Relleno;

||Descripcion  Char 40   S    Descripcion Producto     #agifa071#4
     aAlfa = #69#4;
     aTipo = "A"; nLon = 40; |HAZ Relleno;

||Tipo movimiento   Char 1    S    (C) Cargo o abono (A)    Si agifa071#5 >0 sera C y si agifa071#5<0 sera A
     |SI #69#5 > 0;
          aAlfa = "C";
     |SINO;
          aAlfa = "A";
     |FINSI;
     aTipo = "A"; nLon = 1; |HAZ Relleno;

||Tipo de línea
||(Si se producen varios casos hay que crear un registro para cada tipo)   Num  1    S    Valores:
||Venta (0), dto Mercancia(1), dto euros(2) y dto porcentaje (3)   Según:
||(0) agifa071#6 =agifa019#18 y agifa071#8=0
||(1) agifa071#8=100
||(2) agifa071#6<agifa019#18
||(3) 0<agifa071#8<100
     aAlfa = nTipo;
     aTipo = "N"; nLon = 1; |HAZ Relleno;

||Cantidad     Num  5,3  S    Unidades  agifa071#5
     |SI #69#5 < 0;
          nNume = -#69#5;
          aAlfa = nNume;
     |SINO;
          aAlfa = #69#5;
     |FINSI;

     aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;

||ImporteUnitario   Num  8,3  S    Precio o descuento  unitario de venta
||Según el valor del tipo de línea: (0 y 1) agifa019#18  (2)agifa019#18-agifa071#6 (3)agifa071#8
     |SI nImpo < 0;
          nNume = -nImpo;
          aAlfa = nNume;
     |SINO;
          aAlfa = nImpo;
     |FINSI;
     aTipo = "N"; nLon = 11; nDec = 3; |HAZ Relleno;

||Total   Num  8,3  S    Importe linea  Según el valor del tipo de línea:
||(0 y 1) agifa019#18 *agifa071#5
||(2)(agifa019#18-agifa071#6)*agifa071#5
||(3)(agifa071#6%agifa071#8)*agifa071#5
     |SI nTotal < 0;
          nNume = -nTotal;
          aAlfa = nNume;
     |SINO;
          |SI nTipo = 1;
               nTotal = #69#5 * #19#18;
          |FINSI;
          aAlfa = nTotal;
     |FINSI;
     aTipo = "N"; nLon = 11; nDec = 3; |HAZ Relleno;

||Nº Factura   Char 20   S    Nº Factura     agifa010#53+agifa010#39
     aAlfa = #84#48 + (("000000" + #84#0) % -106);
     aTipo = "A"; nLon = 20; |HAZ Relleno;

||Fecha factura     Num  8    S    Fecha factura  agifa010#60 adaptado AAAAMMDD
     aAlfa = #84#1;
     aTipo = "F"; nLon = 8; |HAZ Relleno;

||Observaciones     Char 30   N    Uso libre
     aAlfa = "";
     aTipo = "A"; nLon = 30; |HAZ Relleno;

||Promoción Multiple     Char 10   N    Codigo promo   Diez primeros caracteres del campo agifa038#1 (descripción ampliada), relacionado según el valor de agifa071#27, por si lo tuviesen que indicar.
     aAlfa = #38#1;
     aTipo = "A"; nLon = 10; |HAZ Relleno;

     |XGRABA nHandle, aLF;
|FPRC;

|PROCESO Facturas;
     |SI #69#13 ] #0#5; |Y #69#13 [ #0#6; |Y #69#5 ! 0;
          #referen@#0 = #84#3;
          #referen@#1 = #84#91;
          |LEE 000#referen@.=;
          |SI FSalida ! 0;
               |GRABA 020#referen@.n;
          |FINSI;

          #19#0 = #69#2;
          |LEE 000#19=;
          |SI FSalida ! 0; |DDEFECTO #19; |FINSI;

          #38#0 = #69#18;
          |LEE 000#38=;
          |SI FSalida ! 0; |DDEFECTO #38; |FINSI;

          |SI #69#6 = 0;      || Sin cargo
               |SI #69#45 ! -1;    || linea promocion
                    nTipo = 0;
                    nImpo = #19#18;
                    nTotal = #69#5 * #19#18;
                    |HAZ LinFactura;
               |FINSI;

               nTipo = 1;
               nImpo = #19#18;
               nTotal = 0;
               |HAZ LinFactura;
          |SINO;
               |SI #69#8 = 100;    || Dto Mercancia
                    nTipo = 0;
                    nImpo = #19#18;
                    nTotal = #19#18 * #69#5;
                    |HAZ LinFactura;

                    nTipo = 1;
                    nImpo = #19#18;
                    nTotal = #19#18 * #69#5;
                    |HAZ LinFactura;
               |SINO;
                    |SI #69#6 ! #19#18; || Dto Euros
                         nTipo = 0;
                         nImpo = #19#18;
                         nTotal = #19#18 * #69#5;
                         |HAZ LinFactura;

                         nTipo = 2;
                         nImpo = #19#18 - #69#6;
                         nTotal = (#19#18 - #69#6) * #69#5;
                         |HAZ LinFactura;

                         |SI #69#8 > 0; |Y #69#8 < 100;     || Dto %
                              nTipo = 3;
                              nImpo = #69#8;
                              nTotal = (#69#6 % #69#8) * #69#5;
                              |HAZ LinFactura;
                         |FINSI;
                    |SINO;
                         |SI #69#8 > 0; |Y #69#8 < 100;     || Dto %
                              nTipo = 0;
                              nImpo = #69#6;
                              nTotal = #69#6 * #69#5;
                              |HAZ LinFactura;

                              nTipo = 3;
                              nImpo = #69#8;
                              nTotal = (#69#6 % #69#8) * #69#5;
                              |HAZ LinFactura;
                         |SINO;
                              nTipo = 0;
                              nImpo = #19#18;
                              nTotal = #19#18 * #69#5;
                              |HAZ LinFactura;
                         |FINSI;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO CabFac;
     #24#0 = #84#3;
     |LEE 000#24=;
     |SI FSalida ! 0; |DDEFECTO #24; |FINSI;

     aDivisa = #84#65;
     aMoneda = #84#67;
     |HAZ Divisas084;
|FPRC;

|DEFBUCLE Facturas;
     #84#1;
     1;
     "     ", 000001, #0#3;
     "zzzzz", 999999, #0#4;
     ;
     NULL, CabFac, Facturas;
|FIN;

|PROCESO Copia;
     aPath = #0#2; |QBF aPath;
     aAlfa = aPath % -101;
     |SI aAlfa ! "/"; |Y aAlfa ! "\";
          aPath = aPath + "/";
     |FINSI;

     aDes = aPath + aFic;
     aIP = ""; |IP_REMOTO aIP;

     |SI aIP = "";
          |COPIA_FICHERO aOrg, aDes;
     |SINO;
          |ENVIA_FICHERO aOrg, aDes;
     |FINSI;

     |SI FSalida ! 0;
          |MENAV "0000Error al copiar al puesto...";
     |FINSI;
|FPRC;

|PROCESO T3; |TIPO 3;
     |DDEF aPath;
     aAlfa = aPath + "dsm00003";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          aAlfa = aPath + "agifa071";
          |CARGA_DEF aAlfa, agifa071@;
          |SI FSalida = 0;
               aAlfa = aPath + "agifa069";
               |CARGA_DEF aAlfa, agifa069@;
               |SI FSalida = 0;
                    |ABRE #agifa071@;
                    |ABRE #agifa069@;

                    |HAZ CreaTempo; |NOME_DAT #referen@#Tempo#;
                    |DELINDEX #referen@;
                    |ABRE #referen@;

                    |DFICE aPathOrg;
                    aNom = (fHoy % 704) + (fHoy % 402) + (fHoy % 102);

                    aFic = "A" + aNom + ".dat";
                    aOrg = aPathOrg + aFic;
                    |XABRE "WB", aOrg, nHandle;
                    |SI FSalida ] 0;
                         |ABRE #19;
                         |ABRE #38;
                         |ABRE #24;
                         |BUCLE Albaranes;
                         |BUCLE Facturas;
                         |CIERRA #24;
                         |CIERRA #38;
                         |CIERRA #19;
                         |XCIERRA nHandle;
                         |HAZ Copia;
                    |FINSI;


                    aFic = "C" + aNom + ".dat";
                    aOrg = aPathOrg + aFic;
                    |XABRE "WB", aOrg, nHandle;
                    |SI FSalida ] 0;
                         |ABRE #3;
                         |ABRE #24;
                         |BUCLE Clientes;
                         |CIERRA #24;
                         |CIERRA #3;
                         |XCIERRA nHandle;
                         |HAZ Copia;
                    |FINSI;

                    |CIERRA #agifa069@;
                    |CIERRA #agifa071@;

                    |DESCARGA_DEF #agifa069@;
               |FINSI;
               |DESCARGA_DEF #agifa071@;
          |FINSI;
          |CIERRA #referen@;
          |DELINDEX #referen@;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO BtnPath;
     aPath = "D*.*";
     |BROWSE aPath;
     aPath = aPath % 2; |QBF aPath;
     |SI aPath ! "D";
          #0#2 = aPath; |PINTA #0#2;
     |FINSI;
|FPRC;

|PROGRAMA;
     |HAZ DecimalesBase;
     fHoy = ~;
     aLF = &13; aLF = aLF + &10;

     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
     |PINPA #0#0; nPanta = FSalida;
     |PINDA #0#0;

     |CONTROL_SIMPLE nPanta, "BOTON,{{136}}...", 1117, 1121, BtnPath;
     nBtnPath = FSalida;

     |ENDATOS #1#0;
     |SI FSalida = 0; |GRABA 020#0a; |FINSI;
     |CIERRA #0;

     |FIN_CONTROL_WINDOWS nBtnPath;
|FPRO;
