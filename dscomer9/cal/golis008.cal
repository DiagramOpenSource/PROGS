|FICHEROS;
     golis008 #0;
     gopartia #1;
     gomantho #2;
     gotmp004 #3;
     agifa724 #724;
     cacuenta@ #10;
     agifa142 #142;
     agifa080 #80;
     guerm035 #35;
|FIN;

|VARIABLES;
     aInforme1 = "golis008";
     aInforme2 = "goli0008";
     aInforme  = "";
     dA        = "                    ";
     hA        = "zzzzzzzzzzzzzzzzzzzz";
     aDef      = "";
     aPath     = "";
     aAlfa     = "";
     nHay      = 0;
     aTipo     = "";
     acTipo    = "";
     aCta      = "";
|FIN;

|PROCESO Tmp;
     |SI aDef ! "";
          |DDEFECTO #10;
          #10#0 = #3#3;
          |LEE 000#10=;
          #3#6 = #10#2;
     |FINSI;
     |PRINT;
     nHay = 1;
|FPRC;

|DEFBUCLE Tmp;
     #3#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp;
|FIN;

|PROCESO gopartia;
     #2#0 = #1#2;
     #2#1 = #1#3;
     |LEE 000#2=;
     |SI FSalida = 0;
          |SI #2#30 < #0#4; |O #2#30 > #0#5;||Jefe
               |ACABA;
          |FINSI;
          #724#0 = #1#20;
          |LEE 000#724=;
          |SI FSalida ! 0; |DDEFECTO #724; |FINSI;
          |LIBERA #724;
          |SI #1#34 = "A"; |O #1#34 = "T";
               aTipo = "I";
          |SINO;
               aTipo = "C";
               #80#27 = #1#4;
               #80#0 = #1#5;
               #80#1 = #1#6;
               |LEE 000#80=;
               |SI FSalida = 0;
                    #35#0 = #80#15;
                    #35#2 = #80#2;
                    |LEE 000#35=;
                    |SI FSalida = 0;
                         aTipo = "M";
                    |FINSI;
                |FINSI;
          |FINSI;

          aCta = #724#3;
          acTipo = aTipo;
          |SI #0#8 = "C";   |Y acTipo ! "C";  |ACABA;  |FINSI;
          |SI #0#8 = "I";   |Y acTipo ! "I";  |ACABA;  |FINSI;
          |SI #0#8 = "M";   |Y acTipo ! "M";  |ACABA;  |FINSI;
          |SI #0#8 = "T"; acTipo = ""; |FINSI;

          |SI aCta < #0#10; |O aCta > #0#11; |ACABA; |FINSI;


          |DDEFECTO #3;
          |SI #0#9 = "N";
               #3#0 = #2#0;
               #3#1 = #2#1;
          |FINSI;
          #3#2 = acTipo;
          #3#3 = aCta;
          |SI #0#12 = "S";
               #3#4 = #3#4 + #1#25;
               nHay = 1;
               |PRINT;
          |SINO;
               |LEE 101#3=;
               |SI FSalida ! 0; |GRABA 020#3b; |FINSI;
               #3#4 = #3#4 + #1#25;
               |GRABA 020#3a;
               |LIBERA #3;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE gopartia;
     #1#3;
     28;
     #0#0, #0#2, "     ", 000000, dA, dA, #0#6;
     #0#1, #0#3, "zzzzz", 999999, hA, hA, #0#7;
     ;
     NULL, gopartia;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |HAZ MiraLogos; || Copia Logos para el Crystal
     |ABRE #142; |LEE 000#142p; |CIERRA #142;
     aDef = #142#151; |QBF aDef;
     aDef = aDef + "/def/cacuenta";
     |CARGA_DEF aDef, cacuenta@;
     |SI FSalida ! 0;
          aAlfa = "0000Error al cargar:" + aDef;
          aDef = "";
          |MENAV aAlfa;
     |SINO;
          aPath = #142#151; |QBF aPath;
          aPath = aPath + "/fich/" + (("000000" + #142#152) % -106) + "/";
          |PATH_DAT #10 aPath;
          |ABRE #10;
     |FINSI;

     |SI #0#9 = "N";
          aInforme = aInforme1;
     |SINO;
          aInforme = aInforme2;
     |FINSI;

     |SI #0#12 = "S";
          aInforme = "goli1008";
     |FINSI;

     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR aInforme;
          |SI FSalida = 0;
               aAlfa = Usuario; |QBF aAlfa;
               |NOME_DAT #3 aAlfa; |DELINDEX #3;

               |ABRE #2;
               |ABRE #724;
               |ABRE #3;
               |ABRE #80;
               |ABRE #35; |SELECT #2#35;
               |BUCLE gopartia;
               |CIERRA #35;
               |CIERRA #80;
               |CIERRA #3;
               |CIERRA #2;
               |SI #0#12 ! "S";
                    |BUCLE Tmp;
               |FINSI;
               |CIERRA #724;
               |DELINDEX #3;

               |SI nHay ! 0; |PIEINF; |FINSI;
               |FININF;
          |SINO;
               aInforme = "0000No existe informe " + aInforme;
               |MENAV aInforme;
          |FINSI;
          |FINIMP;
     |FINSI;

     |SI aDef ! "";
          |CIERRA #10;
          |DESCARGA_DEF #cacuenta@;
     |FINSI;
|FPRC;
