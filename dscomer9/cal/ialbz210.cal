     En Proceso

|FICHEROS;
     ialbz010 #0;
     ialbm017 #17;
     ialbm018 #18;

     &referb1@;
     &referb2@;
     &referb3@;
|FIN;

|VARIABLES;
     &enPestana = 0;
     &eaCliDoc = "";
     &enModo = 0;
     &enError = 0;
     &eaMatricula = "";
     &eaSerAviso = "";
     &enNumAviso = 0;
     v0 = "000000";
     v1 = "   ";
     v2 = 0;
     aPath = "";
     nPanta = 0;
     aAlfa = "";
     nRango = 0;
     nPos1 = 0;
     nPos2 = 0;

     nBtnSalir2 = 0;
     nBtnModifi2 = 0;
     nBtnImpre2 = 0;
     nBtnHisMaq2 = 0;
     nBtnAsgMat2 = 0;
     nBtnSMS2 = 0;

     nBtnNuevoPar2 = 0;
     nBtnModiPar2 = 0;
     nBtnCierPar2 = 0;
     nBtnImpPar2 = 0;
     nBtnReabPar2 = 0;
     nBtnHisMaqPar2 = 0;
     nBtnAsgMaqPar2 = 0;
     nEvtFoco = 0;
     &enGridb1 = 0;
     &enGridb2 = 0;
     &enGridb3 = 0;
|FIN;

|PROCESO EventoFoco2;
     enPestana = 2;
|FPRC;

|PROCESO BtnNuevoPar2;
     |SALVA_DATOS #referb1@;
     |REPON_DATOS #17;

     enModo = 1; |HAZ EditaParte;
     |SI enError = 0;
          #referb2@#1 = 0; |REFRESCACONTROL enGridb3;
          |SALVA_DATOS #18;
          |REPON_DATOS #referb2@;
          |LEE 000#referb2@.=;
          |REFRESCACONTROL enGridb2;
          |REFRESCACONTROL enGridb1;
     |FINSI;
|FPRC;

|PROCESO BtnModiPar2;
     |LEE 000#referb2@.=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SALVA_DATOS #referb1@;
     |REPON_DATOS #17;
     |SALVA_DATOS #referb2@;
     |REPON_DATOS #18;

     enModo = 2; |HAZ EditaParte;
|DEBUG;
|LEE 000#referb1@.=;
|LEE 000#referb2@.=;

     |SI enError = 0;
          #referb2@#1 = 0; |REFRESCACONTROL enGridb3;
          |SALVA_DATOS #18;
          |REPON_DATOS #referb2@;
          |LEE 000#referb2@.=;
          |REFRESCACONTROL enGridb2;
          |REFRESCACONTROL enGridb1;
     |FINSI;
|FPRC;

|PROCESO BtnCierPar2;
     |LEE 000#referb2@.=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     |SI #referb2@#3 = "C";
          |MENAV "0000Parte ya cerrado..."; |ACABA;
     |FINSI;

     |SALVA_DATOS #referb1@;
     |REPON_DATOS #17;
     |SALVA_DATOS #referb2@;
     |REPON_DATOS #18;

     |SI #17#63 = "S";
          |HAZ CierraEntrega;
          |SI enError = 0;
               |SALVA_DATOS #18;
               |REPON_DATOS #referb2@;
               |LEE 000#referb2@.=;
               |HAZ Refresca2;
               |HAZ Refresca4;
          |FINSI;
     |SINO;
          |HAZ CierraParte;
          |SI enError = 0;
               |SALVA_DATOS #18;
               |REPON_DATOS #referb2@;
               |LEE 000#referb2@.=;
               |HAZ Refresca2;
               |HAZ Refresca3;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO BtnImpPar2;
     |LEE 000#referb2@.=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SALVA_DATOS #referb1@;
     |REPON_DATOS #17;
     |SALVA_DATOS #referb2@;
     |REPON_DATOS #18;
     |HAZ ImpreParte;
|FPRC;

|PROCESO BtnReabPar2;
     |LEE 101#referb2@.=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     |SI #referb2@#3 = "A";
          |MENAV "0000Parte abierto..."; |ACABA;
     |FINSI;

     aAlfa = "0000NReabrir parte:" + #referb2@#0+"/"+(("000000"+#referb2@#1)%-106)+(("000"+#referb2@#2)%-103);
     |CONFI aAlfa;
     |SI FSalida = 0;
          #referb2@#3 = "A";
          |GRABA 020#referb2@.a;
          |REFRESCACONTROL enGridb2;
     |FINSI;
     |LIBERA #referb2@;
|FPRC;

|PROCESO BtnHisMaqPar2;
     |LEE 000#referb2@.=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     eaMatricula = #referb2@#41;
     eaSerAviso = #referb2@#0;
     enNumAviso = #referb2@#1;
     |HAZ HistoMaquina;
|FPRC;

|PROCESO BtnAsgMaqPar2;
     |LEE 000#referb2@.=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SALVA_DATOS #referb1@;
     |REPON_DATOS #17;
     |SALVA_DATOS #referb2@;
     |REPON_DATOS #18;
     |HAZ AsignaMatriPar;
     |SI enError = 0;
          |REFRESCACONTROL enGridb2;
          |REFRESCACONTROL enGridb1;
     |FINSI;
|FPRC;

|PROCESO BtnModifi2;
     |LEE 000#referb1@.=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SALVA_DATOS #referb1@;
     |REPON_DATOS #17;
     enModo = 2; |HAZ EditaAviso;
     |SI enError = 0; |HAZ Refresca2; |FINSI;
|FPRC;

|PROCESO BtnImpre2;
     |LEE 000#referb1@.=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SALVA_DATOS #referb1@;
     |REPON_DATOS #17;
     |HAZ ImpreAviso;
|FPRC;

|PROCESO BtnHisMaq2;
     |LEE 000#referb1@.=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     eaMatricula = #referb1@#22;
     eaSerAviso = #referb1@#0;
     enNumAviso = #referb1@#1;
     |HAZ HistoMaquina;
|FPRC;

|PROCESO BtnSMS2;
     |LEE 000#referb1@.=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |ABRE #17;
     #17#0 = #referb1@#0;
     #17#1 = #referb1@#1;
     |LEE 000#17=;
     |SI FSalida = 0;
          |HAZ EnvioSMS;
     |FINSI;
     |CIERRA #17;
|FPRC;

|PROCESO BtnAsgMat2;
     |LEE 000#referb1@.=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SALVA_DATOS #referb1@;
     |REPON_DATOS #17;
     |HAZ AsignaMatri;
     |SI enError = 0; |HAZ Refresca2; |FINSI;
|FPRC;

|PROCESO Evento21;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#referb1@.=;
          |SI FSalida = 0;
               eaCliDoc = #referb1@#5;
               #0#6 = #referb1@#7;
               #0#7 = #referb1@#8;
               #0#8 = #referb1@#9;
          |SINO;
               #0#6 = "";
               #0#7 = "";
               #0#8 = "";
          |FINSI;
          |PINPA #2#0;
          |PINTA 1609, #0#6;
          |PINTA 1709, #0#7;
          |PINTA 1809, #0#8;
          #referb2@#1 = 0; |REFRESCACONTROL enGridb3;
          |REFRESCACONTROL enGridb2;
     |FINSI;
|FPRC;

|PROCESO Evento22;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#referb2@.=;
          |REFRESCACONTROL enGridb3;
     |FINSI;
|FPRC;

|PROCESO Evento23;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#referb3@.=;
     |FINSI;
|FPRC;

|PROCESO Min21;
     #referb1@#0 = "     ";
     #referb1@#1 = 000000;
     #referb1@#5 = #0#0;
     #referb1@#18 = #0#1;
     #referb1@#19 = #0#2;
     #referb1@#24 = "T";
     |SI #0#0 = "000000"; #referb1@#5# = "      "; |FINSI;
     |SI #0#1 = "000"; #referb1@#18# = "   "; |FINSI;
|FPRC;

|PROCESO Max21;
     #referb1@#0 = "zzzzz";
     #referb1@#1 = 999999;
     #referb1@#5 = #0#0;
     #referb1@#18 = #0#1;
     #referb1@#19 = #0#2;
     #referb1@#24 = "T";
     |SI #0#0 = "000000"; #referb1@#5# = "zzzzzz"; |FINSI;
     |SI #0#1 = "   "; #referb1@#18# = "zzz"; |FINSI;
     |SI #0#1 = "000"; #referb1@#18# = "zzz"; |FINSI;
     |SI #0#2 = 0; #referb1@#19# = 99999; |FINSI;
|FPRC;

|PROCESO Min22;
     #referb2@#0 = #referb1@#0;
     #referb2@#1 = #referb1@#1;
     #referb2@#2 = 1;
|FPRC;

|PROCESO Max22;
     #referb2@#0 = #referb1@#0;
     #referb2@#1 = #referb1@#1;
     #referb2@#2 = 999;
|FPRC;

|PROCESO Min23;
     #referb3@#0 = #referb2@#0;
     #referb3@#1 = #referb2@#1;
     #referb3@#2 = #referb2@#2;
     #referb3@#3 = 1;
|FPRC;

|PROCESO Max23;
     #referb3@#0 = #referb2@#0;
     #referb3@#1 = #referb2@#1;
     #referb3@#2 = #referb2@#2;
     #referb3@#3 = 999;
|FPRC;

|PROCESO Actualiza2;
     |DESTRUYECONTROL enGridb1;

     |PINPA #2#0; nPanta = FSalida;
     nRango = 4 + 8 + 16 + 32;
     nPos1 = 0602;
     nPos2 = 1598;

     |SI #0#0 ! v0;
          |SI #0#1 ! v1;
               |LINEAL_SIMPLE #8#referb1@, nRango, nPos1, nPos2, Min21, Max21, Evento21;
          |SINO;
               |LINEAL_SIMPLE #9#referb1@, nRango, nPos1, nPos2, Min21, Max21, Evento21;
          |FINSI;
     |SINO;
          |SI #0#1 ! v1;
               |SI #0#0 ! v0;
                    |LINEAL_SIMPLE #10#referb1@, nRango, nPos1, nPos2, Min21, Max21, Evento21;
               |SINO;
                    |LINEAL_SIMPLE #11#referb1@, nRango, nPos1, nPos2, Min21, Max21, Evento21;
               |FINSI;
          |SINO;
               |SI #0#0 ! v0;
                    |LINEAL_SIMPLE #12#referb1@, nRango, nPos1, nPos2, Min21, Max21, Evento21;
               |SINO;
                    |LINEAL_SIMPLE #13#referb1@, nRango, nPos1, nPos2, Min21, Max21, Evento21;
               |FINSI;
          |FINSI;
     |FINSI;
     enGridb1 = FSalida;
     #referb2@#1 = 0; |REFRESCACONTROL enGridb3;
     #referb1@#1 = 0; |REFRESCACONTROL enGridb2;
     |REFRESCACONTROL enGridb1;
|FPRC;

|PROCESO PintaPan2;
     |DDEF aPath;
     aAlfa = aPath + "ialbm017"; |CARGA_DEF aAlfa, referb1@;
     aAlfa = aPath + "ialbm018"; |CARGA_DEF aAlfa, referb2@;
     aAlfa = aPath + "ialbm019"; |CARGA_DEF aAlfa, referb3@;
     |ABRET #referb1@;
     |ABRET #referb2@;
     |ABRET #referb3@;

     |PINPA #2#0; nPanta = FSalida;
     nRango = 4 + 8 + 16 + 32;
     nPos1 = 2802;
     nPos2 = 3398;
     |LINEAL_SIMPLE #1#referb3@, nRango, nPos1, nPos2, Min23, Max23, Evento23;
     enGridb3 = FSalida;

     nRango = 4 + 8 + 16 + 32;
     nPos1 = 2002;
     nPos2 = 2798;
     |LINEAL_SIMPLE #1#referb2@, nRango, nPos1, nPos2, Min22, Max22, Evento22;
     enGridb2 = FSalida;

     nRango = 4 + 8 + 16 + 32;
     nPos1 = 0602;
     nPos2 = 1598;
     |LINEAL_SIMPLE #1#referb1@, nRango, nPos1, nPos2, Max21, Min21, Evento21;
     enGridb1 = FSalida;

     |CONTROL_SIMPLE nPanta, "EVENTOPAN", 0000, 0000, EventoFoco2;
     nEvtFoco = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,Modificar", 0501, 0513, BtnModifi2;
     nBtnModifi2 = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Imprimir", 0514, 0526, BtnImpre2;
     nBtnImpre2 = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Histo. Maq.", 0527, 0539, BtnHisMaq2;
     nBtnHisMaq2 = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Asig. Mat.", 0540, 0552, BtnAsgMat2;
     nBtnAsgMat2 = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Envio SMS", 0553, 0565, BtnSMS2;
     nBtnSMS2 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,Nuevo", 1901, 1913, BtnNuevoPar2;
     nBtnNuevoPar2 = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Modificar", 1914, 1926, BtnModiPar2;
     nBtnModiPar2 = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Cerrar", 1927, 1939, BtnCierPar2;
     nBtnCierPar2 = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Imprimir", 1940, 1952, BtnImpPar2;
     nBtnImpPar2 = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Reabrir", 1953, 1965, BtnReabPar2;
     nBtnReabPar2 = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Histo. Maq", 1966, 1978, BtnHisMaqPar2;
     nBtnHisMaqPar2 = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Asig. Mat.", 1979, 1991, BtnAsgMaqPar2;
     nBtnAsgMaqPar2 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{207}} Salir", 3488, 3498, BtnSalir;
     nBtnSalir2 = FSalida;

     |PINTA 1609, #0#6;
     |PINTA 1709, #0#7;
     |PINTA 1809, #0#8;
|FPRC;

|PROCESO DestruyePan2;
/*
     |DESTRUYECONTROL enGridb1;
     |DESTRUYECONTROL enGridb2;
     |DESTRUYECONTROL enGridb3;

     |FIN_CONTROL_WINDOWS nEvtFoco;
     |FIN_CONTROL_WINDOWS nBtnModifi2;
     |FIN_CONTROL_WINDOWS nBtnImpre2;
     |FIN_CONTROL_WINDOWS nBtnHisMaq2;
     |FIN_CONTROL_WINDOWS nBtnAsgMat2;
     |FIN_CONTROL_WINDOWS nBtnSMS2;

     |FIN_CONTROL_WINDOWS nBtnNuevoPar2;
     |FIN_CONTROL_WINDOWS nBtnModiPar2;
     |FIN_CONTROL_WINDOWS nBtnCierPar2;
     |FIN_CONTROL_WINDOWS nBtnImpPar2;
     |FIN_CONTROL_WINDOWS nBtnReabPar2;
     |FIN_CONTROL_WINDOWS nBtnHisMaqPar2;
     |FIN_CONTROL_WINDOWS nBtnAsgMaqPar2;

     |FIN_CONTROL_WINDOWS nBtnSalir2;
*/

     |CIERRAT #referb3@;
     |CIERRAT #referb2@;
     |CIERRAT #referb1@;
     |DESCARGA_DEF #referb3@;
     |DESCARGA_DEF #referb2@;
     |DESCARGA_DEF #referb1@;
|FPRC;
