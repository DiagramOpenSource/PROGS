|FICHEROS;
     mecaz007 #0;
     mecam006 #6;
     mecam009 #9;
     mecaw012 #12,MANTE; ||Tmp
     agifa017 #17;
     agifa019 #19;
     agifa073 #73;
     agifa065 #65;
|FIN;

|VARIABLES;
     &eaEscan = "";
     &Tempo = "";
     aEscan = "";
     nHay = 0;
     nUni1 = 0;
     nUni2 = 0;
     nUniFab = 0;
     nForma = 0;
     {-1}Menu = "";
     Menu1 = "2400";
     Menu2 = "1";
     Menu3 = "Opciones:";
     Menu4 = "RAC";
     Menu5 = " Repasar ";
     Menu6 = " Aceptar ";
     Menu7 = " Cancelar ";
|FIN;

|PROCESO Historico;
     |DDEFECTO #65;
     #65#0 = #12#3;
     #65#1 = ~;
     #65#2 = "FB";
     #65#3 = #0#1;
     #65#4 = 1;
     #65#11 = #0#0;
     #65#9 = #19#9;
     #65#14 = #19#9;
     |GRABA 000#65b;
     |PARA; |SI FSalida ! 0; |HACIENDO;
          #65#4 = #65#4 + 1;
          |GRABA 000#65b;
     |SIGUE;

     #65#5 = #12#7;
     #65#6 = nUni1;
     #65#7 = #17#5;
     #65#8 = #19#9;
     #65#10 = "000000";
     #65#17 = nUni2;
     |GRABA 020#65a;
     |LIBERA #65;
|FPRC;

|PROCESO Stock;
     nUniFab = nUni1;
     |SI nUni2 ! 0; nUniFab = nUni2; |FINSI;

     #19#0 = #12#3;
     |LEE 101#19=;
     |SI FSalida = 0;
          #19#6 = #19#6 + nUni1;        || Total1
          #19#185 = #19#185 + nUni2;    || Totla2
          #19#104 = #19#104 + nUni1;    || Dispo1
          #19#193 = #19#193 + nUni2;    || Dispo2
          #19#13 = #19#13 - nUniFab;      || Fabri

          #17#0 = #12#3;
          #17#1 = #12#7;
          |LEE 101#17=;
          |SI FSalida = 0;
               #17#5 = #17#5 + nUni1;
               #17#47 = #17#47 + nUni2;
               #17#39 = #17#39 + nUni1;
               #17#48 = #17#48 + nUni2;
               #17#9 = #17#9 - nUniFab;
               |HAZ ValoraStock;
               |GRABA 020#17a;
          |SINO;
               |HAZ ValoraStock;
          |FINSI;
          |GRABA 020#19a;
     |FINSI;
|FPRC;

|PROCESO Tecla; |TIPO 0;
     |SI #12Campo = Contenido; |Y FSalida = 0;
          |SI #12#6 = "*";
               #12#6 = "";
          |SINO;
               #12#6 = "*";
          |FINSI;
          |GRABA 020#12a;
     |FINSI;
|FPRC;

|PROCESO mecam006;
     |DDEFECTO #73;
     #73#28 = #6#0;
     #73#0 = #6#1;
     #73#1 = #6#2;
     |LEE 000#73=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |DDEFECTO #12;
     #12#0 = #6#0;
     #12#1 = #6#1;
     #12#2 = #6#2;
     #12#3 = #73#2;
     #12#4 = #73#5;
     |SI #73#44 ! 0; #12#4 = #73#44; |FINSI;  || Muestra Medida si tiene
     #12#5 = #73#4;
     |SI #6#10 = "S";
          #12#6 = "*";
     |SINO;
          #12#6 = "";
     |FINSI;
     #12#7 = #73#3;

     #12#8 = #73#5;
     #12#9 = #73#44;
     |GRABA 020#12n;
     nHay = 1;
|FPRC;

|DEFBUCLE mecam006;
     #6#2;
     10;
     #0#0, #0#1, "N";
     #0#0, #0#1, "N";
     ;
     NULL, mecam006;
|FIN;

|PROCESO Min;
     #12#0 = "     ";
     #12#1 = 000001;
     #12#2 = 001;
|FPRC

|PROCESO Max;
     #12#0 = "zzzzz";
     #12#1 = 999999;
     #12#2 = 999;
|FPRC;

|PROCESO Tmp;
     |SI #12#6 ! "*";
          |ACABA;
     |FINSI;

     |DDEFECTO #73;
     #73#28 = #6#0;
     #73#0 = #6#1;
     #73#1 = #6#2;
     |LEE 000#73=;

     |DDEFECTO #6;
     #6#0 = #12#0;
     #6#1 = #12#1;
     #6#2 = #12#2;
     |LEE 101#6=;
     |SI FSalida ! 0; |GRABA 020#6b; |FINSI;

     #6#10 = "S";
     |GRABA 020#6a;
     |LIBERA #6;

     nUni1 = #12#8;
     nUni2 = #12#9;
     |HAZ Stock;

     |HAZ Historico;
|FPRC;

|DEFBUCLE Tmp;
     #12#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp;
|FIN;

|PROCESO Actualiza;
     |ABRE #73;
     |ABRE #19;
     |ABRE #17;
     |ABRE #6;
     |ABRE #65;
     |BUCLE Tmp;
     |CIERRA #65;
     |CIERRA #6;
     |CIERRA #17;
     |CIERRA #19;
     |CIERRA #73;
|FPRC;

|PROCESO RecalEsca;
     |SI aEscan ! #12#3; |Y #12#6 = "*";
          |SI aEscan ! "";
               eaEscan = aEscan;
               |SUB_EJECUTA_NP "agifa044;mecanogra";
          |FINSI;
          aEscan = #12#3;
     |FINSI;
|FPRC;

|DEFBUCLE RecalEsca;
     #12#2;
     ;
     INICIO;
     FINAL;
     ;
     NULL, RecalEsca;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |ABRE #9;
     #9#0 = #0#0;
     #9#1 = #0#1;
     |LEE 101#9=;
     |SI FSalida ! 0;
          |MENAV "0000No existe Orden...";
          |ACABA;
     |FINSI;

     |HAZ CreaTempo; |NOME_DAT #12 Tempo; |DELINDEX #12;
     |ABRE #12;
     |ABRE #73;
     |BUCLE mecam006;
     |CIERRA #73;
     |CIERRA #12;
     |SI nHay = 0;
          |MENAV "0000No hay registros";
     |SINO;
          |PARA; |SI; |HACIENDO;
               |ENTLINEAL #1#12, 1, 4, 22, 0, Min, Max;
               |MENU Menu;
               |SI FSalida = 0; |O FSalida = 3; |SAL; |FINSI;
               |SI FSalida = 2;
                    |BUCLE RecalEsca;
                    |SI aEscan ! "";
                         eaEscan = aEscan;
                         |SUB_EJECUTA_NP "agifa044;mecanogra";
                    |FINSI;

                    |HAZ Actualiza;
                    |SAL;
               |FINSI;
          |SIGUE;
     |FINSI;

     |HAZ BoraTempo; |DELINDEX #12;

     |CIERRA #9;
|FPRC;

|PROGRAMA;
     |CLS;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENTLINEAL #1#12, 1, 7, 22, 0, Min, Max;
     |ENDATOS #1#0;
|FPRO;
