|FICHEROS;
agifa232 #0;
agifa019 #1;
|FIN;

|VARIABLES;
     &eaArticulo = "";
codbar = "             ";
codba1 = "             ";
i1 = "";
i2 = "";
i3 = "";
i4 = "";
i5 = "";
i6 = "";
p1 = "";
p2 = "";
p3 = "";
p4 = "";
p5 = "";
p6 = "";
sumai = 0;
sumap = 0;
base = 0;
resto = 0;
total =  0;
digito = 0;
codigo = "";
|FIN;


|CALCULO barras;
  codba1 = #1#0;
  |QBF codba1;
  codbar = #1#128;
  |QBF codbar;
  i1 = #1#0 % 101;
  i2 = #1#0 % 301;
  i3 = #1#0 % 501;
  i4 = #1#0 % 701;
  i5 = #1#0 % 901;
  i6 = #1#0 % 1101;
  p1 = #1#0 % 201;
  p2 = #1#0 % 401;
  p3 = #1#0 % 601;
  p4 = #1#0 % 801;
  p5 = #1#0 % 1001;
  p6 = #1#0 % 1101;
  sumai = i1 + i2 + i3 + i4 + i5 + i6;
  sumap = p1 + p2 + p3 + p4 + p5 + p6;
  sumap = sumap * 3;
  total = sumai + sumap;
  base = total / 10;
  resto = total $ 10;
  |SI resto ! 0;
    resto = resto / 10;
    base = (base - resto) + 1;
    base = base * 10;
  |SINO;
    base = base * 10;
  |FINSI;
  digito = base - total;
  codigo = codba1 + "000000000000000";
  codigo = codigo % 0112;
  codigo = codigo + digito;
  |QBF codigo;
  #1#128 = codigo;
  |GRABA 121#1a;
  |LIBERA #1;
|FCAL;

|DEFBUCLE calculo;
#1#1;
128,2;
#0#0 , #0#3 , #0#5;
#0#1 , #0#4 , #0#6;
be;
NULL,barras;
|FIN;

|CALCULO calbarra;|TIPO 3;
|SI #0#2 = "SI";
  |ABRE #1;
  |BUCLE calculo;
  |LIBERA #1;
  |CIERRA #1;
|FINSI;
|FCAL;

|PROCESO Llena232; |TIPO 6;
     eaArticulo = #0Campo;
     |HAZ LlenaArticulo;
     |SI FSalida = 0;
          #0Campo = eaArticulo;
          |PINTA #0Campo;
     |SINO;
          |ERROR; |ACABA;
     |FINSI;
|FPRC;
