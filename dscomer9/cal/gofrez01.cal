|FICHEROS;
     gofrez01 #0;
     gofrem01 #1;
     gofrem03 #3;
     gofrem04 #4;
     agifa071 #71;
|FIN;

|VARIABLES;
     nModo = 0;
     &eaTempo = "";
     &eaSerie = "";
     &enCodigo = 0;
     &eaCliente = "";
     nSwNoExiste = 0;
     nSwCheq = 0;
|FIN;

|PROCESO T2; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
          |AVISO;
          |ERROR;
     |SINO;
          |DDEFECTO #4;
          #4#0 = eaSerie;
          #4#1 = enCodigo;
          #4#2 = #0#0;
          |LEE 101#4=;
          |SI FSalida ! 0; |GRABA 020#4b; |FINSI;
          #4#3 = #0#4;
          #4#4 = #0#5;
          #4#5 = #0#6;
          #4#6 = #0#7;
          |GRABA 020#4a;
          |LIBERA #4;
     |FINSI;
|FPRC;

|PROCESO LinAlba;
     |SI nSwCheq = 1;
          #4#0 = #71#29;
          #4#1 = #71#0;
          #4#2 = #71#1;
          |LEE 000#4=;
          |SI FSalida ! 0;
               nSwNoExiste = 1;
               |ERROR10;
          |FINSI;
     |SINO;
          |DDEFECTO #0;
          #0#0 = #71#1;
          #0#1 = #71#2;
          #0#2 = #71#4;
          #0#3 = #71#5;

          #4#0 = #71#29;
          #4#1 = #71#0;
          #4#2 = #71#1;
          |LEE 000#4=;
          |SI FSalida = 0;
               #0#4 = #4#3;
               #0#5 = #4#4;
               #0#6 = #4#5;
               #0#7 = #4#6;
          |SINO;
               #3#0 = eaCliente;
               #3#1 = #71#2;
               |LEE 000#3=;
               |SI FSalida ! 0;
                    #3#0 = #1#2;
                    |LEE 000#3=;
               |FINSI;
               |SI FSalida = 0;
                    #0#4 = #71#1;
                    #0#5 = #71#5 / (#3#2 * #3#3);
                    #0#6 = #71#5 / (#3#3 * #3#4);
                    #0#7 = #71#5 / #3#4;
               |FINSI;
          |FINSI;
          |GRABA 020#0n;
     |FINSI;
|FPRC;

|DEFBUCLE LinAlba;
     #71#1;
     ;
     eaSerie, enCodigo, 001;
     eaSerie, enCodigo, 999;
     ;
     NULL, LinAlba;
|FIN;
|PROCESO Min;
     #0#0 = 001;
|FPRC;

|PROCESO Max;
     #0#0 = 999;
|FPRC;

|PROGRAMA;
     |ABRE #1; |LEE 000#1p; |CIERRA #1;

     nSwCheq = 1;
     |ABRE #3;
     |ABRE #4;
     |BUCLE LinAlba;
     |SI nSwNoExiste = 1;
          |HAZ CreaTempo;
          |NOME_DAT #0 eaTempo; |DELINDEX #0; |ABRE #0;
          nSwCheq = 0;
          |BUCLE LinAlba;
          |ENTLINEAL #1#0, 1, 2, 21, 1, Min, Max;
          |CIERRA #0; |DELINDEX #0;
     |FINSI;
     |CIERRA #4;
     |CIERRA #3;
|FPRO;
