|FICHEROS;
   con00693 #0;

   canempr@ #100;
|FIN;

|VARIABLES;
   aAlfa   = "";
   aAlfa1  = "";
   nModo   = 0;
   nHandle = 0;
   nTecla  = 0;
|FIN;

|RUTINA Inf;
   #con00693#0 = "     ";
|FRUT;

|RUTINA Sup;
   #con00693#0 = "zzzzz";
|FRUT;

|PROCESO MiraEmpresas;
   |SI FSalida = 2; |ACABA; |FINSI;
   nTecla = FSalida;

   aAlfa = #con00693#1; |QBF aAlfa;
   aAlfa1 = aAlfa + "def/canempre.mas";
   |CARGA_DEF aAlfa1 , canempr@;
   |SI FSalida = 0;
      aAlfa1 = aAlfa + "fich/";
      |PATH_DAT #canempr@#aAlfa1#;
      |ABRE #canempr@;
      |SI nTecla = 10;
         |CONSULTA_CLAVE #1#canempr@;
         |SI FSalida ] 0;
            aAlfa = (("00000" + #canempr@#2) % -105) + #canempr@#3;
            #con00693#2 = aAlfa; |PINTA #con00693#2;
         |FINSI;
      |SINO;
         aAlfa = (("000000" + #con00693#2) % -106); |QBF aAlfa;
         aAlfa1 = aAlfa % 0105; #canempr@#2 = aAlfa1;
         aAlfa1 = aAlfa % 0601; #canempr@#3 = aAlfa1;
         |LEE 000#canempr@.=;
         |SI FSalida ! 0;
            |MENAV "    No existe empresa";
            |ERROR;
         |FINSI;
      |FINSI;
      |CIERRA #canempr@;
      |DESCARGA_DEF #canempr@;
   |SINO;
      |MENAV "    No puedo abrir el fichero de empresas";
      |ERROR;
   |FINSI;

   |PONCONTROL 23, "si";
|FPRC;

|PROCESO OfrecePath; |TIPO 7;
   nModo = (FEntrada / 100) ! 0;
   |SI nModo = 1;
      |DBASS aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + "contagen/def/canempre.mas";
      |XABRE "E", aAlfa, nHandle;
      |SI FSalida ] 0;
         |DBASS aAlfa; |QBF aAlfa;
         aAlfa = aAlfa + "contagen/";
         #con00693#1 = aAlfa; |PINTA #con00693#1; |ACABA;
      |FINSI;
      |DBASS aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + "agicont/def/canempre.mas";
      |XABRE "E", aAlfa, nHandle;
      |SI FSalida ] 0;
         |DBASE aAlfa; |QBF aAlfa;
         aAlfa = aAlfa + "agicont/";
         #con00693#1 = aAlfa; |PINTA #con00693#1; |ACABA;
      |FINSI;
      |DBASE aAlfa; |QBF aAlfa;
      #con00693#1 = aAlfa; |PINTA #con00693#1;
   |FINSI;
|FPRC;

|PROGRAMA;
   |ENTLINEAL #1#con00693, -1, 1, 21, 1, Inf, Sup;
|FPRO;
