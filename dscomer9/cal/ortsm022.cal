|FICHEROS;
     ortsm022 #0,MANTE;
     ortsm021 #21;
     agifa025 #25;
|FIN;

|VARIABLES;
     &enComision = 0;
     &eaTipo = "";
     &eaSerie = "";
     &enCodigo = 0;
     &enLinea = 0;
     &enModo = 0;
     nPos = 0;
     nSal = 0;
|FIN;

|PROCESO T12; |TIPO 12;
|FPRC;

|PROGRAMA;
     |SI PARAMETRO = "menu";
          |ABRE #0;
          |CONSULTA_CLAVE #1#0;
          |CIERRA #0;
          |ACABA;
     |FINSI;

     |DDEFECTO #0;
     |ABRE #0;
     #0#0 = eaTipo;
     #0#1 = eaSerie;
     #0#2 = enCodigo;
     #0#3 = enLinea;
     |LEE 101#0=;
     |SI PARAMETRO = "BAJA";
          |SI FSalida = 0;
               |BORRA 020#0a;
          |FINSI;
     |SINO;
          nSal = FSalida;
          |SI PARAMETRO = "DEFECTO";
               |ABRE #21;
               #21#0 = #0#0;
               #21#1 = #0#1;
               #21#2 = #0#2;
               |LEE 000#21=;
               |CIERRA #21;
               #0#4 = #21#3
               #0#5 = #21#4
               #0#6 = #21#5
               #0#7 = enComision;

               |ABRE #25;
               #25#0 = #0#5;
               |LEE 000#25=;
               |SI #25#57 = "N";
                    #0#7 = 0;
               |FINSI;
               |CIERRA #25;

               |SI nSal = 0;
                    |GRABA 020#0a;
               |SINO;
                    |GRABA 020#0b;
               |FINSI;
          |SINO;
               |SI eaTipo = "A"; nPos = 1123; |FINSI;
               |SI eaTipo = "P"; nPos = 1122; |FINSI;
               |SI eaTipo = "AD"; nPos = 1140; |FINSI;
               |C_P #0#7, 1, nPos;
               |SI nSal = 0;
                    |ENDATOS #2#0;
               |SINO;
                    |GRABA 020#0b;
                    |ENDATOS #1#0;
               |FINSI;
               |GRABA 020#0a;
          |FINSI;
     |FINSI;
     |CIERRA #0;
|FPRO;
