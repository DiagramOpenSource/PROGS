|FICHEROS;
     guerz040 #0;
     gopre001 #1;
     gopre004 #4;
     guerw037 #37,MANTE;
     guerm039 #39;
     goparame #100;
|FIN;

|VARIABLES;
     aAlfa = "";
     nHay = 0;
     nFalta = 0;
     aD = "";
     aH = "";
|FIN;

|PROCESO CamPresu;
     #4#5 = #39#1;
     |GRABA 020#4a;
     |LIBERA #4;
|FPRC;

|DEFBUCLE CamPresu;
     #4#3;
     ;
     #0#0, #0#1, aD, #39#0;
     #0#0, #0#1, aH, #39#0;
     be;
     NULL, CamPresu;
|FIN;

|PROCESO ActHistoCorre;
     |SI #37#4 = "*";
          |DDEFECTO #39;
          #39#0 = #37#0;
          |LEE 000#39=;
          |SI FSalida ! 0; |GRABA 020#39b; |FINSI;
          #39#1 = #37#2;
          #39#2 = #37#3;
          |GRABA 020#39a;
          |LIBERA #39;
          |BUCLE CamPresu;
     |FINSI;
|FPRC;

|DEFBUCLE ActHistoCorre;
     #37#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, ActHistoCorre;
|FIN;

|PROCESO CheqMarca;
     |SI #37#4 ! "*";
          nFalta = 1;
     |FINSI;
|FPRC;

|DEFBUCLE CheqMarca;
     #37#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, CheqMarca;
|FIN;

|PROCESO Pulsa0;
   |ET Otra;
     |ENCAMPO #2#37;
     |SI FSalida = 0;
          |ENCAMPO #3#37;
          |SI FSalida = 2; |VETE Otra; |FINSI;
     |FINSI;
     |SI FSalida = 0;
          #37#6 = #37#3;
          #37#4 = "*";
          |GRABA 020#37a;
     |SINO;
          |LEE 020#37=;
     |FINSI;
     |PINTA #37#3;
     |PINTA #37#4;
     |PINTA #37#6;
|FPRC;

|PROCESO Pulsa11; |TIPO 11;
     |SI FSalida = 10; ||F2;
          |SI #37#4 = "*";
               #37#4 = "";
          |SINO;
               aAlfa = #37#2; |QBF aAlfa;
               |SI aAlfa = "";
                    |MENAV "0000ATENCION, codigo blanco...";
               |FINSI;
               #37#4 = "*";
          |FINSI;
          |GRABA 020#37a;
          |PINTA #37#4;
     |FINSI;
|FPRC;

|PROCESO gopre004;
     #39#0 = #4#5;
     |LEE 000#39=;
     |SI FSalida ! 0; |DDEFECTO #39; |FINSI;

     |DDEFECTO #37;
     #37#0 = #4#5;
     |LEE 000#37=;
     |SI FSalida ! 0;
          #37#1 = #4#6;
          #37#2 = #39#1;
          #37#3 = #39#2;
          #37#4 = "";
          #37#5 = #37#1;
          #37#6 = #37#3;
          |GRABA 020#37n;
          nHay = 1;
     |FINSI;
|FPRC;

|DEFBUCLE gopre004;
     #4#1;
     ;
     #0#0, #0#1, "                    ", "                    ", 001;
     #0#0, #0#1, "zzzzzzzzzzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzz", 999;
     ;
     NULL, gopre004;
|FIN;

|PROCESO Min37;
     #37#0 = " " * 20;
|FPRC;

|PROCESO Max37;
     #37#0 = "z" * 20;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     aAlfa = Usuario;
     |NOME_DAT #37 aAlfa; |DELINDEX #37;

     aD = " " * 20;
     aH = "z" * 20;

     |ABRE #1;
     #1#0 = #0#0;
     #1#1 = #0#1;
     |LEE 000#1=;
     |SI FSalida ! 0;
          |MENAV "0000No existe presupuesto...";
     |SINO;
          |ABRE #37;
          |ABRE #39;
          |BUCLE gopre004;
          |CIERRA #39;
          |CIERRA #37;
          |SI nHay = 0;
               |MENAV "0000No hay articulos...";
          |SINO;
               |PINPA #0#37;
            |ET Marca;
               nFalta = 0;
               |ENTLINEAL #1#37, 1, 4, 19, 0, Min37, Max37;
               |BUCLE CheqMarca;
               |SI nFalta = 1;
                    |AVISO;
                    aAlfa = "0000NFaltan articulos por marcar" + &13+ "¿Continuar?";
                    |CONFI aAlfa;
                    |SI FSalida ! 0; |VETE Marca; |FINSI;
               |FINSI;
               |ABRE #39;
               |BUCLE ActHistoCorre;
               |CIERRA #39;
          |FINSI;
     |FINSI;
     |CIERRA #1;

     |DELINDEX #37;
|FPRC;

|PROCESO Tipo13; |TIPO 13;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     |SI #100#141 = "O";
          |PINTA 1123, "O.E........";
     |FINSI;
|FPRC;
