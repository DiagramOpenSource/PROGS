|FICHEROS;
     albz0023 #0;

     albm0037 #37;       ||Orden (C)
     albm0038 #38;       ||Orden (L)
     albm0039 #39;       ||Orden (Especifica)
|FIN;

|VARIABLES;
     nLinea = 0;
     aAlfa = "";
     &eaEsp1 = "";
     &eaEsp2 = "";
     &eaEsp3 = "";
     &eaEsp4 = "";
     &eaEsp5 = "";
     &eaEsp6 = "";
     &eaEsp7 = "";
     &eaEsp8 = "";

     nExiste = 0;
     aMensaje = "";
     aInforme = "";
     nSwPie = 0;
     &enNumOrden = 0;
     &eaSerOrden = "";
     aParametro = "";
     nDesde = 0;
     nHasta = 0;
     aDesSer = "";
     aHasSer = "";
|FIN;

|PROGRAMA;
     aParametro = PARAMETRO;
     |QBF aParametro;
     |SI aParametro = "";
          |CLS;
          |ABRE #0;
          |DDEFECTO #0;
          |LEE 101#0p;
          nExiste = FSalida;
          |PINPA #0#0;
          |PINDA #0#0;
          |ENDATOS #1#0;
          |SI FSalida = 0;
               |SI nExiste = 0;
                    |GRABA 020#0a;
               |SINO;
                    |GRABA 020#0n;
               |FINSI;
               nDesde = #albz0023#1;
               nHasta = #albz0023#2;
               aDesSer = #albz0023#3;
               aHasSer = #albz0023#4;
               |HAZ Principal;
          |FINSI;
          |LIBERA #0;
          |CIERRA #0;
     |SINO;
          |ABRE #0;
          |DDEFECTO #0;
          nDesde = enNumOrden;
          nHasta = enNumOrden;
          aDesSer = eaSerOrden;
          aHasSer = eaSerOrden;
          |HAZ Principal;
          |CIERRA #0;
     |FINSI;
|FPRO;

|PROCESO albm0038;
     nSwPie = 1;
     |PRINT;
|FPRC;

|DEFBUCLE albm0038;
 #albm0038#1;
 ;
 #albm0037#16, #albm0037#0, 01;
 #albm0037#16, #albm0037#0, 99;
 ;
 NULL, albm0038;
|FIN;

|PROCESO albm0037;
     |SI #albm0037#18 = 1;
          aInforme = "albz0023";
     |SINO;
          aInforme = "albz2023";
     |FINSI;
     |INFOR aInforme;
     |SI FSalida = 0;

          |PARA nLinea = 1;  |SI nLinea [ 8; |HACIENDO nLinea = nLinea + 1;
               |DDEFECTO #albm0039;
               #albm0039#3 = #albm0037#16;
               #albm0039#0 = #albm0037#0;
               #albm0039#1 = nLinea;
               |LEE 000#albm0039.=;
               aAlfa = #albm0039#2;
               |QBF aAlfa;
               |SI nLinea = 1;
                    eaEsp1 = aAlfa;
               |FINSI;
               |SI nLinea = 2;
                    eaEsp2 = aAlfa;
               |FINSI;
               |SI nLinea = 3;
                    eaEsp3 = aAlfa;
               |FINSI;
               |SI nLinea = 4;
                    eaEsp4 = aAlfa;
               |FINSI;
               |SI nLinea = 5;
                    eaEsp5 = aAlfa;
               |FINSI;
               |SI nLinea = 6;
                    eaEsp6 = aAlfa;
               |FINSI;
               |SI nLinea = 7;
                    eaEsp7 = aAlfa;
               |FINSI;
               |SI nLinea = 8;
                    eaEsp8 = aAlfa;
               |FINSI;
          |SIGUE;


          |BUCLE albm0038;
          |SI nSwPie = 1;
               |PIEINF;
          |FINSI;
          |FININF;
          |SI #albm0037#14 = "N";
               #albm0037#14 = "S";
               |GRABA 020#albm0037.a;
          |FINSI;
     |SINO;
          aMensaje = "0000Informe " + aInforme + " inaccesible.";
          |MENAV aMensaje;
     |FINSI;
|FPRC;

|DEFBUCLE albm0037;
 #albm0037#1;
 ;
 aDesSer, nDesde;
 aHasSer, nHasta;
 be;
 NULL, albm0037;
|FIN;

|PROCESO Principal;
     |IMPRE 0;
     |SI FSalida = 0;
          |ABRE #albm0039;
          |BUCLE albm0037;
          |CIERRA #albm0039;
          |FINIMP;
     |SINO;
          |MENAV "0000Proceso cancelado.";
     |FINSI;
|FPRC;
