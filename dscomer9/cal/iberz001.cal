|FICHEROS:
     iberz001 #0;
     iber0012 #12;
     iber0017 #17;
     iber0050 #50;
     iber0052 #52;
     iber0053 #53;
     iber0054 #54;
     iber0055 #55;
|FIN;

|VARIABLES;
     aDCliente  = "";
     aHCliente  = "";

     &eaCliente = "";
|FIN;

|PROCESO Borra52;
     |BORRA 020#52a;
     |LIBERA #52;
|FPRC;

|DEFBUCLE iber0052;
     #52#1;
     ;
     aDCliente, 0;
     aHCliente, 99;
     be;
     NULL, Borra52;
|FIN;

|PROCESO Graba52_1;
     #17#0 = #55#0;
     |LEE 040#17=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     #12#0 = #17#2;
     |LEE 040#12=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     #52#0 = #55#1;
     #52#1 = #12#0;
     |LEE 101#52=;
     |SI FSalida ! 0;
         |DDEFECTO #52;
         #52#0 = #55#1;
         #52#1 = #12#0;
         |GRABA 020#52b;
     |FINSI;

     #52#2 = #55#4;
     #52#3 = #12#1;
     |SI #55#5 ! 0;
         #52#4 = #52#4 + (#55#5 / #12#2);
     |SINO;
         #52#4 = #52#4 + (#55#6 / #12#3);
     |FINSI;
     #52#6  = #52#4 - #52#5;
     |GRABA 020#52a;
     |LIBERA #52;
|FPRC;

|DEFBUCLE iber0055;
     #55#1;
     ;
       0, aDCliente, "01.01.0000";
     999, aHCliente, "31.12.2999";
     ;
     NULL, Graba52_1;
|FIN;

|PROCESO PonRegalo;
     #52#5 = #52#5 + #54#5;
|FPRC;

|DEFBUCLE iber0054;
     #54#1;
     ;
     #53#0, #53#1, #53#2, 001;
     #53#0, #53#1, #53#2, 999;
     ;
     NULL, PonRegalo;
|FIN;

|PROCESO Graba52_2;
     #52#0 = #53#0;
     #52#1 = #53#1;
     |LEE 101#52=;
     |SI FSalida ! 0;
         |DDEFECTO #52;
         #52#0 = #53#0;
         #52#1 = #53#1;
         |GRABA 020#52b;
     |FINSI;

     #52#2 = #53#3;
     #52#3 = #53#4;

     |BUCLE iber0054;

     #52#6  = #52#4 - #52#5;
     |GRABA 020#52a;
     |LIBERA #52;
|FPRC;

|DEFBUCLE iber0053;
     #53#1;
     ;
     aDCliente,  1, "01.01.0000";
     aHCliente, 99, "31.12.2999";
     ;
     NULL, Graba52_2;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |SI #0#0 ! "SI";  |ACABA;  |FINSI;

     |SI eaCliente = "";
         |ABRE #52;  |CIERRA #52;  |DELINDEX #52;
     |SINO;
         |BUCLE iber0052;
     |FINSI;

     |ABRE #52;
     |ABRE #17;
     |ABRE #12;
     |BUCLE iber0055;
     |BUCLE iber0053;
     |CIERRA #17;
     |CIERRA #12;
     |CIERRA #52;
|FPRC;

|PROGRAMA;
     aDCliente = eaCliente;
     aHCliente = eaCliente;
     |QBF eaCliente;
     |SI eaCliente = "";
         aDCliente = "      ";
         aHCliente = "zzzzzz";
         |MANTE #0;
     |SINO;
         #0#0 = "SI";
         |HAZ Tipo3;
     |FINSI;
|FPRO;
