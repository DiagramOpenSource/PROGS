|FICHEROS;
     dsz00131 #0;
     agifa024 #24;
     agifa112 #112;
|FIN;

|VARIABLES;
     aAlfa = "";
     aCta = "";
     aIban = "";
     aLon = "";
     aPais = "";
     nNume = 0;
     &eaPais = "";
     &eaCta = "";
     &eaIBAN = "";
|FIN;

|PROCESO IBAN;
     |QBF aIban;
     |SI aIban ! ""; |Y #0#5 = "N"; |ACABA; |FINSI;

     |QBT aCta;
     nNume = aCta;
     aLon = aCta % A0;
     |SI aLon ! 20; |O  nNume = 0; |ACABA; |FINSI;

     |QBF aPais;
     |SI aPais ! "ES"; |ACABA; |FINSI;

     eaCta = aCta;
     eaPais = aPais;
     |HAZ CalcuIBAN;
     aIban = eaIBAN;
|FPRC;

|PROCESO agifa024;
     aCta = (#24#32 % 104) + (#24#33 % 104) + #24#31 + (#24#30 % 110);
     aIban = #24#215;
     aPais = #24#205 % 102;
     |HAZ IBAN;
     #24#215 = aIban;
     |GRABA 020#24a;
|FPRC;

|DEFBUCLE agifa024;
     #24#1;
     ;
     #0#1;
     #0#2;
     be;
     NULL, agifa024;
|FIN;

|PROCESO agifa112;
     aCta = (#112#14 % 104) + (#112#15 % 104) + #112#13 + (#112#12 % 110);
     aIban = #112#96;
     aPais = #112#89 % 102;
     |HAZ IBAN;
     #112#96 = aIban;
     |GRABA 020#112a;
|FPRC;

|DEFBUCLE agifa112;
     #112#1;
     ;
     #0#3;
     #0#4;
     be;
     NULL, agifa112;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |BUCLE agifa024;
     |BUCLE agifa112;
|FPRC;

|PROGRAMA;
     |SI PARAMETRO ! ""; || llama agif0041
          |DBASE aAlfa;
          aAlfa = aAlfa + "fich/" + PARAMETRO + "/";
          |PATH_DAT #0 aAlfa;
          |PATH_DAT #24 aAlfa;
          |PATH_DAT #112 aAlfa;
     |FINSI;

     |ABRE #0;
     |LEE 000#0p;
     |SI FSalida = 0;
          |SI PARAMETRO ! ""; |ACABA; |FINSI;
     |SINO;
          |GRABA 020#0b;
     |FINSI;
     |SI PARAMETRO ! "";
          |MENSA "0000Calculando IBAN...";
          |HAZ Tipo3;
     |SINO;
          |DDEFECTO #0;
          |PINPA #0#0;
          |PINDA #0#0;
          |ENDATOS #1#0;
     |FINSI;
     |GRABA 020#0a;
     |CIERRA #0;
|FPRO;
