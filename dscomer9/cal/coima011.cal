|FICHEROS;
     coima011 #0;
     coima002 #2;
     coima012 #12;
     agifa074 #74;
     agifa048 #148;
|FIN;

|VARIABLES;
     &enTipo = 0;
     nConta = 0;
     nModo = 0;
|FIN;

|PROCESO Contador; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |LEE 000#0u;
          |SI FSalida = 0;
               nConta = #0#0 + 1;
          |SINO;
               nConta = 1;
          |FINSI;
          |DDEFECTO #0;
          #0#0 = nConta;
     |FINSI;
|FPRC;

|PROCESO ImpreEsca;
     enTipo = 2;
     |PRINT;
|FPRC;

|PROCESO Imprime;
     enTipo = 1;
     |PRINT;

     #74#9 = #12#2;
     #74#0 = #12#3;
     #74#1 = #12#4;
     |LEE 000#74=;
     |SI FSalida = 0;
          #148#0 = #74#2;
          |LEE 000#148=;
          |SI FSalida = 0;
               |BUCLELIN 0 ImpreEsca #148;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo4; |TIPO 4;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "coima011";
          |SI FSalida = 0;
               |ABRE #74;
               |ABRE #148;
               |BUCLELIN 2 Imprime #0;
               |CIERRA #148;
               |CIERRA #74;
               |PIEINF;
               |FININF;
          |SINO;
               |MENAV "0000No existe informe 'coima004'";
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |CONFI "0000N¿Imprimir documento?";
     |SI FSalida = 0; |HAZ Tipo4; |FINSI;
|FPRC;

|PROCESO Min;
     #2#0 = #0#4;
     #2#1 = 00;
|FPRC;

|PROCESO Max;
     #2#0 = #0#4;
     #2#1 = 99;
|FPRC;

|PROCESO Tipo66; |TIPO 66;
     |ABRE #2;
     #2#0 = #0#4;
     #2#1 = #0#1;
     |LEE 000#2];
     |CONSULTA_F_CLAVE #1#2, Min, Max;
     |SI FSalida = 0;
          #2#1 = #0#1; |PINTA #2#1;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #2;
|FPRC;
