|FICHEROS;
     psioa006 #0;
     psioa004 #1;
     psioa005 #2;
     psioa013 #3;
     psioa015 #4;
     agifa142 #5;
     psioa019 #6;
     psioa021 #21;
     psioa022 #22;
     agifa024 #24;
     dsm00003 #30,MANTE;
     psioa080 #80;
     psioc001 #101;
     psioc002 #102;
|FIN;

|VARIABLES;
     &enBorraCobrosAlb = 0;
     nSwCepsax = 0;
     aParam = "";
     &enIncPre = 0;
     &enIncRedo = 0;
     nNume = 0;
     &efFecha = @;
     &eaCuenta = "";
     aAlfa = "";
     aCp1 = "";
     aCp2 = "";
     aEmp = "";
|FIN;

|PROCESO Borra6;
     |SI #6#9 = "S";
          |BORRA 020#6a;
     |FINSI;
|FPRC;

|DEFBUCLE Borra6;
     #6#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Borra6;
|FIN;

|PROCESO CliModi;
     #24#0 = #80#0;
     |LEE 101#24=;
     |SI FSalida = 0;
          #24#1 = #80#1;
          #24#2 = #80#2;
          #24#5 = #80#3; #24#8 = #80#3; #24#11 = #80#3;
          #24#6 = #80#4; #24#9 = #80#4; #24#12 = #80#4;
          #24#7 = #80#6; #24#10 = #80#6; #24#13 = #80#6;
          aAlfa = #80#5 % 102;
          #24#178 = aAlfa; #24#181 = aAlfa; #24#184 = aAlfa;
          aAlfa = #80#5 % 303;
          #24#179 = aAlfa; #24#182 = aAlfa; #24#185 = aAlfa;
          #24#180 = #80#5; #24#183 = #80#5; #24#186 = #80#5;
          #24#15 = #80#7;
          #24#17 = #80#8;
          #24#47 = #80#9;
          #24#20 = #80#10;
          #24#39 = #80#11;
          #24#3 = #80#12;
          #24#158 = #80#13;
          #24#37 = #80#14;
          #24#38 = #80#15;
          #24#156 = #80#16;
          #24#18 = #80#21;
          #24#196 = #80#22;
          #24#197 = #80#23;
          #24#25 = #80#24;
          #24#52 = #80#25;
          #24#36 = #80#26;
          #24#53 = #80#27;
          |GRABA 020#24a;
          |LIBERA #24;
     |FINSI;
|FPRC;

|DEFBUCLE CliModi;
     #80#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, CliModi;
|FIN;

|PROCESO DirEnt;
     |DDEFECTO #30;
     #30#0 = #22#11;
     #30#1 = #22#12;
     |LEE 101#30=;
     |SI FSalida ! 0; |GRABA 020#30b ; |FINSI;
     #30#10 = #22#2;
     #30#11 = #22#3;
     #30#2 = #22#4;
     #30#3 = #22#5;
     aCp1 = #22#6 % 102;
     aCp2 = #22#6 % -103;
     #30#4 = aCp1;
     #30#5 = aCp2;
     #30#6 = #22#6;
     #30#7 = #22#7;
     #30#13 = #22#8;
     |GRABA 020#30a;
|FPRC;

|DEFBUCLE DirEnt;
     #22#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, DirEnt;
|FIN;

--------------------------------------------------------------------

|CALCULO carga_def;
     #0#2 = #5#13;
     |PINTA #0#2;
     |SI #0#2 = "            ";
          #0#2 = "570000000";
     |FINSI;
|FCAL;

|PROGRAMA;
     aParam = PARAMETRO;
     |HAZ EsCepsax; nSwCepsax = FSalida;

     |ABRE #5; |LEE 000#5p; |CIERRA #5;

     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;

     |HAZ carga_def;

     |SI aParam = "";
          #0#0 = "NO";
          #0#1 = ~;
          |CLS;
          |PINPA #0#0
          |PINDA #0#0
          |ENDATOS #1#0;
          |SI FSalida = 0; |Y #0#0 = "SI";
               |GRABA 020#0a;

               |PINTA 1526 , "CLIENTES          ";
               |HAZ Clientes1;
               |SI FSalida ! 0; |ACABA; |FINSI;
               |HAZ CheqMovi;
               |SI FSalida ! 0; |ACABA; |FINSI;

               |HAZ EsRodacal;
               |SI FSalida = 0;
                    |HAZ CheqRodacal;
                    |SI FSalida ! 0; |ACABA; |FINSI;
               |FINSI;
               FSalida = 0;
          |SINO;
               FSalida = 1;
          |FINSI;
     |SINO;
          |SI aParam = "psioa003";
               |HAZ Clientes1;
               |SI FSalida ! 0; |ACABA; |FINSI;
               |HAZ CheqMovi;
               |SI FSalida ! 0; |ACABA; |FINSI;
          |FINSI;
          FSalida = 0;
     |FINSI;

     |SI FSalida = 0;
          |SI nSwCepsax = 0;
               |DFICE aEmp; aEmp = aEmp % -202;
               aAlfa = ":dscepsax/dsz00090 agif0041 " + aEmp;
               |SUB_EJECUTA aAlfa;
          |SINO;
               |PINTA 1526 , "ClIENTES MODI.    ";
               |ABRE #24;
               |BUCLE CliModi;
               |CIERRA #24;

               |PINTA 1526 , "DIR. ENTREGA      ";
               |ABRE #30;
               |BUCLE DirEnt;
               |CIERRA #30;

               efFecha = #0#1;
               eaCuenta = #0#2;
               enIncPre = 0;
               enIncRedo = 0;

               |PINTA 1526 , "CABECERA ALBARANES";
               |SUB_EJECUTA_NP "psioa007.run";
               |PINTA 1526 , "LINEAS ALBARANES  ";
               |SUB_EJECUTA_NP "psioa008.run";

               |PINTA 1526 , "CABECERA F.CONTADO";
               |SUB_EJECUTA_NP "psioa009.run";
               |PINTA 1526 , "LINEAS F.CONTADO  ";
               |SUB_EJECUTA_NP "psioa010.run";

               |PINTA 1526 , "CABECERA PEDIDOS  ";
               |SUB_EJECUTA_NP "psioa011.run";
               |PINTA 1526 , "LINEAS PEDIDOS    ";
               |SUB_EJECUTA_NP "psioa012.run";

               |PINTA 1526 , "COBROS FACTURAS   ";
               |SUB_EJECUTA_NP "psioa014.run";

               |PINTA 1526 , "COBROS ALBARANES  ";
               |SUB_EJECUTA_NP "psioa020.run";

               |PINTA 1526, "MOVIMENTOS ALMACEN ";
               |SUB_EJECUTA_NP "psioa016.run";

               |PINTA 1526, "PEDIDOS COMPRAS    ";
               |SUB_EJECUTA_NP "psioa037";
          |FINSI;

          |SI aParam = "";
               |PINTA 1526, "PROCESO  TERMINADO ";
               |PAUSA;
               |CONFI "2400SSe Borran Los Ficheros De Enlace: ";
          |SINO;
               FSalida = 0;
          |FINSI;
          |SI FSalida = 0;
               |DELINDEX #1;
               |DELINDEX #2;
               |DELINDEX #3;
               |DELINDEX #4;
               |SI enBorraCobrosAlb = 0
                    |DELINDEX #6;
               |SINO;
                    |BUCLE Borra6;
                    |MENAV "0000No se borran los cobros albaranes facturados...";
               |FINSI;
               |DELINDEX #21;
               |DELINDEX #22;
               |DELINDEX #80;
               |DELINDEX #101;
               |DELINDEX #102;
          |FINSI;
     |FINSI;
     |CIERRA #0;
|FPRO;
