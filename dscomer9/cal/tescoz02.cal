|FICHEROS;
     tescoz02 #0;
     agifm001 #1;
     tescom02 #2;
     dsm00003 #3;
     agifa091 #91;
     agifa019 #19;
     agifa024 #24;
     agifa321 #321;
     agifa025 #25;
     agifa023 #23;
|FIN;

|VARIABLES;
     aCodi     = "";
     aAlfa     = "";
     i         = 0;
     aPath     = "";
     nHandle   = 0;
     aErr      = "";

     aTipo     = "";
     aAlf1     = "";
     fFecha    = @;
     nPos      = 0;
     nLon      = 0;
     nNume     = 0;
     nAbo      = 0;
     nNu1      = 0;
     nNu2      = 0;
     nDec      = 0;

     aFichero  = "";
     aEmp      = "";
     aFin      = "";
     nTari     = 0;
     nPrecio   = 0;
|FIN;

|PROCESO Relleno;
     |SI aTipo = "F";
          aAlfa = fFecha;
          aAlfa = (aAlfa % 102) +"/"+ (aAlfa % 402) +"/"+ (aAlfa % -104);
     |FINSI;

     |SI aTipo = "A";
          aAlf1 = " " * nLon;
          aAlfa = aAlfa + aAlf1;
          nPos = nLon + 100;
          aAlfa = aAlfa % nPos;
     |FINSI;

     |SI aTipo = "N";
          |SI nNume < 0; nAbo = -1; |SINO; nAbo = 1; |FINSI;
          |SI nNume < 0; nNume = nNume * - 1; |FINSI;
          nNu1 = nNume ! 0;
          |SI nNu1 > nNume; nNu1 = nNu1 - 1; |FINSI;
          nNu2 = nNume - nNu1;
          |SI nDec < 0;
               aAlfa = nNume;
          |SINO;
               |SI nDec = 0;
                    aAlfa = nNu1;
               |SINO;
                    aAlfa = nNu2;
                    aAlfa = aAlfa + "00000000000000000000000000";
                    nPos = nDec + 300;
                    aAlfa = aAlfa % nPos;
                    aAlfa = nNu1 + "." + aAlfa;
               |FINSI;
          |FINSI;
          aAlfa = "000000000000000000000000000000000000000000000" + aAlfa;
          |SI nAbo = 1;
               nPos = -1 * (nLon + 100);
               aAlfa = aAlfa % nPos;
          |SINO;
               nPos = -1 * (nLon + 99);
               aAlfa = "-" + aAlfa % nPos;
          |FINSI;
     |FINSI;

     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO Servicio;
     nNume = aEmp;
     aTipo = "N"; nDec = 0; nLon = 4; |HAZ Relleno;

     aAlfa = aCodi;
     aTipo = "A"; nLon = 2; |HAZ Relleno;

     aAlfa = "Tarifa " + aCodi;
     aTipo = "A"; nLon = 50; |HAZ Relleno;

     |XGRABA nHandle, aFin;
|FPRC;

|PROCESO BServicio;
     |PARA i = 1; |SI i [ 6; |HACIENDO i = i +1;
          aCodi = ("00" + i) % -102;
          |HAZ Servicio;
     |SIGUE;
|FPRC;

|PROCESO ExServicio;
     aFichero = aPath + "servicio.txt";
     |XABRE "CBW", aFichero, nHandle;
     |SI FSalida ] 0;
          |HAZ BServicio;
          |XCIERRA nHandle;
          aErr = "OK";
     |SINO;
          aErr = "ERROR";
     |FINSI;
|FPRC;

|PROCESO Cliented;
     aAlfa = #3#0; |QBF aAlfa;
     |SI aAlfa = ""; |ACABA; |FINSI;

     nNume = aEmp;
     aTipo = "N"; nDec = 0; nLon = 4; |HAZ Relleno;

     aAlfa = #3#0;
     aTipo = "A"; nLon = 20; |HAZ Relleno;

     aAlfa = #3#2;
     aTipo = "A"; nLon = 50; |HAZ Relleno;

     aAlfa = #3#3;
     aTipo = "A"; nLon = 40; |HAZ Relleno;

     aAlfa = #3#7;
     aTipo = "A"; nLon = 40; |HAZ Relleno;

     aAlfa = #3#6;
     aTipo = "A"; nLon = 10; |HAZ Relleno;

     |XGRABA nHandle, aFin;
|FPRC;

|DEFBUCLE Cliented;
     #3#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Cliented;
|FIN;

|PROCESO ExCliented;
     aFichero = aPath + "cliented.txt";
     |XABRE "CBW", aFichero, nHandle;
     |SI FSalida ] 0;
          |BUCLE Cliented;
          |XCIERRA nHandle;
          aErr = "OK";
     |SINO;
          aErr = "ERROR";
     |FINSI;
|FPRC;

|PROCESO Zonas;
     aAlfa = #1#0; |QBF aAlfa;
     |SI aAlfa = ""; |ACABA; |FINSI;

     nNume = aEmp;
     aTipo = "N"; nDec = 0; nLon = 4; |HAZ Relleno;

     aAlfa = #1#0; aAlfa = "00" + aAlfa;
     aTipo = "A"; nLon = 5; |HAZ Relleno;

     aAlfa = #1#1;
     aTipo = "A"; nLon = 40; |HAZ Relleno;

     |XGRABA nHandle, aFin;
|FPRC;

|DEFBUCLE Zonas;
     #1#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Zonas;
|FIN;

|PROCESO ExZonas;
     aFichero = aPath + "zonas.txt";
     |XABRE "CBW", aFichero, nHandle;
     |SI FSalida ] 0;
          |BUCLE Zonas;
          |XCIERRA nHandle;
          aErr = "OK";
     |SINO;
          aErr = "ERROR";
     |FINSI;
|FPRC;

|PROCESO Monedas;
     nNume = aEmp;
     aTipo = "N"; nDec = 0; nLon = 4; |HAZ Relleno;

     aAlfa = #321#9;
     aTipo = "A"; nLon = 3; |HAZ Relleno;

     |XGRABA nHandle, aFin;
|FPRC;

|PROCESO ExMonedas;
     aFichero = aPath + "monedas.txt";
     |XABRE "CBW", aFichero, nHandle;
     |SI FSalida ] 0;
          |HAZ Monedas;
          |XCIERRA nHandle;
          aErr = "OK";
     |SINO;
          aErr = "ERROR";
     |FINSI;
|FPRC;

|PROCESO Tarifaes;
     nNume = aEmp;
     aTipo = "N"; nDec = 0; nLon = 4; |HAZ Relleno;

     aAlfa = #23#0;
     aTipo = "A"; nLon = 20; |HAZ Relleno;

     aAlfa = #23#1;
     aTipo = "A"; nLon = 50; |HAZ Relleno;

     aAlfa = aCodi;
     aTipo = "A"; nLon = 2; |HAZ Relleno;

     nNume = #23#2;
     aTipo = "N"; nDec = 4; nLon = 19; |HAZ Relleno;

     |XGRABA nHandle, aFin;
|FPRC;

|PROCESO BTarifaes;
     aAlfa = #23#0; |QBF aAlfa;
     |SI aAlfa = ""; |ACABA; |FINSI;
     aAlfa = #23#1; |QBF aAlfa;
     |SI aAlfa = ""; |ACABA; |FINSI;

     |SI #0#0 ! "00";
          |DDEFECTO #24;
          #24#0 = #23#0;
          |LEE 000#24=;
          |SI #24#25 ! #0#0; |ACABA; |FINSI;
     |FINSI;

     |PARA i = 1; |SI i [ 6; |HACIENDO i = i +1;
          aCodi = ("00" + i) % -102;
          |HAZ Tarifaes;
     |SIGUE;
|FPRC;

|DEFBUCLE Tarifaes;
     #23#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, BTarifaes;
|FIN;

|PROCESO ExTarifaes;
     aFichero = aPath + "tarifaes.txt";
     |XABRE "CBW", aFichero, nHandle;
     |SI FSalida ] 0;
          |ABRE #24;
          |BUCLE Tarifaes;
          |CIERRA #24;
          |XCIERRA nHandle;
          aErr = "OK";
     |SINO;
          aErr = "ERROR";
     |FINSI;
|FPRC;

|PROCESO Agentes;
     aAlfa = #25#0; |QBF aAlfa;
     |SI aAlfa = ""; |ACABA; |FINSI;

     |SI #0#0 ! "00";
          |SI #25#0 ! #0#0; |ACABA; |FINSI;
     |FINSI;

     nNume = aEmp;
     aTipo = "N"; nDec = 0; nLon = 4; |HAZ Relleno;

     aAlfa = #25#0;
     aTipo = "A"; nLon = 9; |HAZ Relleno;

     aAlfa = #25#0; ||Login
     aTipo = "A"; nLon = 20; |HAZ Relleno;

     aAlfa = #25#0; ||Pass
     aTipo = "A"; nLon = 20; |HAZ Relleno;

     aAlfa = #25#1;
     aTipo = "A"; nLon = 40; |HAZ Relleno;

     aAlfa = #25#2;
     aTipo = "A"; nLon = 50; |HAZ Relleno;

     aAlfa = #25#4;
     aTipo = "A"; nLon = 40; |HAZ Relleno;

     aAlfa = #25#60;
     aTipo = "A"; nLon = 10; |HAZ Relleno;

     aAlfa = #25#8;
     aTipo = "A"; nLon = 50; |HAZ Relleno;

     |XGRABA nHandle, aFin;
|FPRC;

|DEFBUCLE Agentes;
     #25#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Agentes;
|FIN;

|PROCESO ExAgentes;
     aFichero = aPath + "agentes.txt";
     |XABRE "CBW", aFichero, nHandle;
     |SI FSalida ] 0;
          |BUCLE Agentes;
          |XCIERRA nHandle;
          aErr = "OK";
     |SINO;
          aErr = "ERROR";
     |FINSI;
|FPRC;

|PROCESO Tarifage;
     aAlfa = #19#0; |QBF aAlfa;
     |SI aAlfa = ""; |ACABA; |FINSI;

     |PARA nTari = 1; |SI nTari [ 6; |HACIENDO nTari = nTari + 1;
          |SI nTari = 1; nPrecio = #19#18; |FINSI;
          |SI nTari = 2; nPrecio = #19#19; |FINSI;
          |SI nTari = 3; nPrecio = #19#20; |FINSI;
          |SI nTari = 4; nPrecio = #19#147; |FINSI;
          |SI nTari = 5; nPrecio = #19#148; |FINSI;
          |SI nTari = 6; nPrecio = #19#149; |FINSI;
          |SI nPrecio ! 0;
               nNume = aEmp;
               aTipo = "N"; nDec = 0; nLon = 4; |HAZ Relleno;

               aAlfa = #19#0;
               aTipo = "A"; nLon = 50; |HAZ Relleno;

               aAlfa = ("00" + nTari) % -102;
               aTipo = "A"; nLon = 2; |HAZ Relleno;

               aAlfa = "00000"; ||Zona
               aTipo = "A"; nLon = 5; |HAZ Relleno;

               aAlfa = #321#9;
               aTipo = "A"; nLon = 3; |HAZ Relleno;

               nNume = nPrecio;
               aTipo = "N"; nDec = 4; nLon = 19; |HAZ Relleno;

               |XGRABA nHandle, aFin;
          |FINSI;
     |SIGUE;

|FPRC;

|DEFBUCLE Tarifage;
     #19#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tarifage;
|FIN;

|PROCESO ExTarifage;
     aFichero = aPath + "tarifage.txt";
     |XABRE "CBW", aFichero, nHandle;
     |SI FSalida ] 0;
          |BUCLE Tarifage;
          |XCIERRA nHandle;
          aErr = "OK";
     |SINO;
          aErr = "ERROR";
     |FINSI;
|FPRC;

|PROCESO Articulo;
     aAlfa = #19#0; |QBF aAlfa;
     |SI aAlfa = ""; |ACABA; |FINSI;

     nNume = aEmp;
     aTipo = "N"; nDec = 0; nLon = 4; |HAZ Relleno;

     aAlfa = #19#0;
     aTipo = "A"; nLon = 50; |HAZ Relleno;

     aAlfa = #19#1;
     aTipo = "A"; nLon = 50; |HAZ Relleno;
     aAlfa = " " * 100;
     aTipo = "A"; nLon = 51; |HAZ Relleno;
     aTipo = "A"; nLon = 99; |HAZ Relleno;

     aAlfa = #19#128;
     aTipo = "A"; nLon = 13; |HAZ Relleno;

     nNume = #19#4; ||Unidades Base
     aTipo = "N"; nDec = 0; nLon = 4; |HAZ Relleno;

     nNume = #19#6;
     aTipo = "N"; nDec = 0; nLon = 8; |HAZ Relleno;

     |XGRABA nHandle, aFin;
|FPRC;

|DEFBUCLE Articulo;
     #19#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Articulo;
|FIN;

|PROCESO ExArticulo;
     aFichero = aPath + "articulo.txt";
     |XABRE "CBW", aFichero, nHandle;
     |SI FSalida ] 0;
          |BUCLE Articulo;
          |XCIERRA nHandle;
          aErr = "OK";
     |SINO;
          aErr = "ERROR";
     |FINSI;
|FPRC;

|PROCESO Clientel;
     aAlfa = #24#0; |QBF aAlfa;
     |SI aAlfa = ""; |ACABA; |FINSI;

     |SI #0#0 ! "00";
          |SI #0#0 ! #24#25; |ACABA; |FINSI;
     |FINSI;

     nNume = aEmp;
     aTipo = "N"; nDec = 0; nLon = 4; |HAZ Relleno;

     aAlfa = #24#0;
     aTipo = "A"; nLon = 20; |HAZ Relleno;

     aAlfa = #24#39; ||Serivio
     aAlfa = ("00" + aAlfa) % -102;
     aTipo = "A"; nLon = 2; |HAZ Relleno;

     aAlfa = #24#20; ||F.P.
     aTipo = "A"; nLon = 4; |HAZ Relleno;

     nNume = #24#37;
     aTipo = "N"; nDec = 2; nLon = 5; |HAZ Relleno;

     nNume = #24#204;
     aTipo = "N"; nDec = 2; nLon = 5; |HAZ Relleno;

     |XGRABA nHandle, aFin;
|FPRC;

|DEFBUCLE Clientel;
     #24#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Clientel;
|FIN;

|PROCESO ExClientel;
     aFichero = aPath + "clientel.txt";
     |XABRE "CBW", aFichero, nHandle;
     |SI FSalida ] 0;
          |BUCLE Clientel;
          |XCIERRA nHandle;
          aErr = "OK";
     |SINO;
          aErr = "ERROR";
     |FINSI;
|FPRC;

|PROCESO Clientes;
     aAlfa = #24#0; |QBF aAlfa;
     |SI aAlfa = ""; |ACABA; |FINSI;

     |SI #0#0 ! "00";
          |SI #0#0 ! #24#25; |ACABA; |FINSI;
     |FINSI;

     nNume = aEmp;
     aTipo = "N"; nDec = 0; nLon = 4; |HAZ Relleno;

     aAlfa = #24#0;
     aTipo = "A"; nLon = 20; |HAZ Relleno;

     aAlfa = #24#1;
     aTipo = "A"; nLon = 40; |HAZ Relleno;

     aAlfa = #24#15; ||DNI
     aTipo = "A"; nLon = 20; |HAZ Relleno;

     aAlfa = #24#5;
     aTipo = "A"; nLon = 50; |HAZ Relleno;

     aAlfa = #24#6;
     aTipo = "A"; nLon = 40; |HAZ Relleno;

     aAlfa = #24#7;
     aTipo = "A"; nLon = 40; |HAZ Relleno;

     aAlfa = #24#180;
     aTipo = "A"; nLon = 10; |HAZ Relleno;

     aAlfa = #24#205;
     aTipo = "A"; nLon = 40; |HAZ Relleno;

     ||aAlfa = #24#3;
     aAlfa = "00000";
     aTipo = "A"; nLon = 5; |HAZ Relleno;

     aAlfa = #24#192;
     aTipo = "A"; nLon = 3; |HAZ Relleno;

     aAlfa = "   ";
     aTipo = "A"; nLon = 3; |HAZ Relleno;

     |XGRABA nHandle, aFin;
|FPRC;

|DEFBUCLE Clientes;
     #24#1;
     25;
     INICIO;
     FINAL;
     ;
     NULL, Clientes;
|FIN;

|PROCESO ExClientes;
     aFichero = aPath + "clientes.txt";
     |XABRE "CBW", aFichero, nHandle;
     |SI FSalida ] 0;
          |BUCLE Clientes;
          |XCIERRA nHandle;
          aErr = "OK";
     |SINO;
          aErr = "ERROR";
     |FINSI;
|FPRC;

|PROCESO FormaPago;
     aAlfa = #91#0; |QBF aAlfa;
     |SI aAlfa = ""; |ACABA; |FINSI;

     nNume = aEmp;
     aTipo = "N"; nDec = 0; nLon = 4; |HAZ Relleno;

     aAlfa = #91#0;
     aTipo = "A"; nLon = 4; |HAZ Relleno;

     aAlfa = #91#1;
     aTipo = "A"; nLon = 52; |HAZ Relleno;
     aAlfa = " " * 100;
     aTipo = "A"; nLon = 99; |HAZ Relleno;
     aTipo = "A"; nLon = 99; |HAZ Relleno;

     |XGRABA nHandle, aFin;
|FPRC;

|DEFBUCLE FormaPago;
     #91#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, FormaPago;
|FIN;

|PROCESO ExFormaPago;
     aFichero = aPath + "formpago.txt";
     |XABRE "CBW", aFichero, nHandle;
     |SI FSalida ] 0;
          |BUCLE FormaPago;
          |XCIERRA nHandle;
          aErr = "OK";
     |SINO;
          aErr = "ERROR";
     |FINSI;
|FPRC;

|PROCESO Exporta;
     |ABRE #321; |LEE 000#321p; |CIERRA #321;

     aFin  = &13 + &10;
     aPath = #0#1; |QBF aPath;

     |DFICE aEmp;
     aEmp = aEmp % -205;
     |ATRI S;
     |PINTA 0673, #0#0;
     |HAZ ExFormaPago; |PINTA 0773, aErr;
     |HAZ ExClientes; |PINTA 0873, aErr;
     |HAZ ExClientel; |PINTA 0973, aErr;
     |HAZ ExArticulo; |PINTA 1073, aErr;
     |HAZ ExTarifage; |PINTA 1173, aErr;
     |HAZ ExAgentes; |PINTA 1273, aErr;

     |HAZ ExTarifaes; |PINTA 1373, aErr;
     |HAZ ExMonedas; |PINTA 1473, aErr;
     |HAZ ExZonas; |PINTA 1573, aErr;
     |HAZ ExCliented; |PINTA 1673, aErr;
     |HAZ ExServicio; |PINTA 1773, aErr;
     |ATRI 0;
     |BLANCO 0673 2380;
|FPRC;

|PROCESO tescom02;
     |DDEFECTO #25;
     #25#0 = #2#0;
     |LEE 000#25=;

     #0#0 = #2#0;
     #0#1 = #2#1;
     #0#2 = #25#1;
     |GRABA 020#0n;
|FPRC;

|DEFBUCLE tescom02;
     #2#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, tescom02;
|FIN;

|PROCESO Tecla; |TIPO 0;
     |SI #0Campo = Contenido;
          |SI #0#3 = "*";
               #0#3 = "";
          |SINO;
               #0#3 = "*";
          |FINSI;
          |GRABA 020#0a;
          |PINTA #0#3;
     |FINSI;
|FPRC;

|DEFBUCLE Exporta;
     #0#2;
     ;
     "*";
     "*";
     ;
     NULL, Exporta;
|FIN;

|PROCESO Min;
     #0#0 = "  ";
|FPRC;

|PROCESO Max;
     #0#0 = "zz";
|FPRC;

|PROGRAMA;
     |CLS;
     aAlfa = Usuario;
     |NOME_DAT #0 aAlfa;
     |DELINDEX #0;
     |ABRE #0;
     |ABRE #25;
     |BUCLE tescom02;
     |CIERRA #25;
     |CIERRA #0;

     |PINPA #0#0;
     |ENTLINEAL #1#0, 1, 4, 22, 0, Min, Max;
     |CONFI "0000NEs Correcto";
     |SI FSalida = 0;
          |BUCLE Exporta;
     |FINSI;
     |DELINDEX #0;
|FPRO;
