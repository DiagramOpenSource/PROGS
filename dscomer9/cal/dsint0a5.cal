          RellenaPCEG


|FICHEROS;
     dsint005 #0;
     dsint002 #2;
     dsm00003 #3;   ||Dir. Entrega
     pcegm004@;    || Pedidos
     agifa010 #10;
     agifa071 #71;
     agifa077 #77;
     agifa112 #112;
     dsm00225 #225; ||Paises
     agifa024 #24;
|FIN;

|VARIABLES;
     f = @;
     aAlfa = "";
     fDFecha = @;
     fHFecha = @;
|FIN;

|PROCESO Venta;
     #71#29 = #10#52;
     #71#0 = #10#0;
     #71#1 = 0;
     |LEE 000#71];

     |DDEFECTO #pcegm004@;
     #pcegm004@#25 = #71#31;
     #pcegm004@#0 = #71#12;
     |LEE 000#pcegm004@.=;

     |DDEFECTO #3;
     #3#0 = #10#3;
     #3#1 = #10#84;
     |LEE 000#3=;
/*                            Tiquet: 3308/1373
     |DDEFECTO #225;
||     #225#0 = #3#19;
     #225#0 = #pcegm004@#74;
     |LEE 000#225=;
*/
     #2#0 = "E";
     #2#8 = "A";
     #2#6 = #10#52;
     #2#7 = #10#0;
     |LEE 101#2=;
     |SI FSalida ! 0; |GRABA 020#2b; |FINSI;
     #2#1 = #10#3;
     #2#2 = #0#9;
     #2#3 = #0#10;
/*
     #2#4 = #pcegm004@#74;  || #225#1;  Tiquet: 3308/1373
*/
     #24#0 = #10#3;
     |LEE 000#24=;
     |SI FSalida ! 0; |DDEFECTO #24; |FINSI;
     #2#4 = #24#205;                    || Tiquet: 3308/1373

     #2#5 = "02";           || #10#33;
     |GRABA 020#2a;
     |LIBERA #2;
|FPRC;

|DEFBUCLE Venta;
     #10#1;
     1;
     #0#1, 000001, fDFecha;
     #0#1, 999999, fHFecha;
     ;
     NULL, Venta;
|FIN;

|PROCESO Compra;
     |DDEFECTO #112;
     #112#0 = #77#3;
     |LEE 000#112=;

     |DDEFECTO #225;
     #225#0 = #112#89;
     |LEE 000#225=;

     #2#0 = "I";
     #2#8 = "A";
     #2#6 = #77#50;
     #2#7 = #77#0;
     |LEE 101#2=;
     |SI FSalida ! 0; |GRABA 020#2b; |FINSI;
     #2#1 = #77#3;
     #2#2 = #0#9;
     #2#3 = #0#10;
     #2#4 = #112#89;     || #225#1;
     #2#5 = "02";        || #77#33;
     |GRABA 020#2a;
     |LIBERA #2;
|FPRC;

|DEFBUCLE Compra;
     #77#1;
     1;
     #0#1, 000001, fDFecha;
     #0#1, 999999, fHFecha;
     ;
     NULL, Compra;
|FIN;

|PROCESO RellenaPCEG;
     aAlfa = "01." + (("00" + #0#4) % -102) + "." + (("0000" + #0#3) % -104);
     fDFecha = aAlfa;
     |PARA f = fDFecha; |SI; |HACIENDO f = f + 1;
          aAlfa = f % 402;
          |SI aAlfa ! #0#4; |SAL; |FINSI;
          fHFecha = f;
     |SIGUE;

     |DDEF aAlfa;
     aAlfa = aAlfa + "pcegm004";
     |CARGA_DEF aAlfa, pcegm004@;
     |SI FSalida ! 0;
          |MENAV "0000Error al cargar 'pcegm004'";
          |ACABA;
     |FINSI;

     |ABRE #2;
     |ABRE #3;
     |ABRE #112;
     |ABRE #225;
     |ABRE #71;
     |ABRE #pcegm004@;
     |ABRE #24;
     |SI #0#2 = "I";
          |BUCLE Compra;
     |FINSI;
     |SI #0#2 = "E";
          |BUCLE Venta;
     |FINSI;
     |SI #0#2 = "A";
          |BUCLE Compra;
          |BUCLE Venta;
     |FINSI;
     |CIERRA #24;
     |CIERRA #pcegm004@;
     |CIERRA #71;
     |CIERRA #225;
     |CIERRA #112;
     |CIERRA #3;
     |CIERRA #2;

     |DESCARGA_DEF #pcegm004@;
|FPRC;
