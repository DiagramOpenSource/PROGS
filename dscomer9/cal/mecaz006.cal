|FICHEROS;
     mecaz006 #0;
     mecam006 #6;
     mecam007 #7;
     mecam008 #8;
     mecam009 #9;
     mecam010 #10;
     mecam011 #11;
     mecam012 #12;
     agifa019 #19;
     agifa073 #73;
     mecaw022 #22; ||Tmp2
     mecaw010 #101; ||Tmp1 Impresion
     mecaw025 #25; || Tmp3 lineas impresion
|FIN;

|VARIABLES;
     nClave = 0;
     nClaveLin = 0;
     nSwOrden = 0;
     nPrime = 0;
     nLinea = 0;
     nPaq = 0;
     nSwCuenta = 0;
     &enMetros = 0;
     nCheck = 0;
     &eaArti = "";
     &eaDesE = "";
     &eaDesI = "";
     &eaColorE = "";
     &eaColorI = "";
     &eaEspesorE = "";
     &eaEspesorI = "";
     aArti = "";
     &Tempo = "";
     aTmp22 = "";
     aTmp25 = "";
     aTmp101 = "";
     aInforme1 = "mecaz0a6";
     aInforme2 = "mecaz0b6";
     aInforme3 = "mecaz0c6";
     aInforme4 = "mecaz0d6";
     aInforme5 = "mecaz0e6";
{-1} Menu  = "";
     Menu1 = "1631";
     Menu2 = "1";
     Menu3 = "6";
     Menu4 = "Productos principales";
     Menu5 = "Tapajuntas";
     Menu6 = "Accesorios con medidas ";
     Menu7 = "Otros accesorios";
     Menu8 = "Informe de Bobinas";
     Menu9 = "Todos";
     nHay = 0;
     aAlfa = "";
     aTipo = "";
     aLinea = "";
     aArtiPro = "";
     aSer = "";
     nNum = 0;
     aArt = "";
     nLon = 0;
     nNumPaquete = 0;
|FIN;

|PROCESO PonClaveLin;
     nClaveLin = nClaveLin + 1;
     #25#6 = nClave;
     #25#7 = nClaveLin;
     |GRABA 020#25a;
     |LIBERA #25;
|FPRC;

|DEFBUCLE PonClaveLin;
     #25#1;
     9;
     #101#5, #101#0, #101#1, #101#9, #101#10, 0001, #101#3, #101#6;
     #101#5, #101#0, #101#1, #101#9, #101#10, 9999, #101#3, #101#6;
     be;
     NULL, PonClaveLin;
|FIN;

|PROCESO PonClave;
     nClave = nClave + 1;
     nClaveLin = 0;

     #101#7 = nClave;
     |BUCLE PonClaveLin;
     |SI nClaveLin ! 0;
          #101#2 = nClaveLin;
     |FINSI;

     |SI nClaveLin ! 0;
          #101#8 = "S";  ||Pinta o no las lineas
     |SINO;
          #101#8 = "N";
     |FINSI;
     |GRABA 020#101a;
     |LIBERA #101;
|FPRC;

|DEFBUCLE PonClave;
     #101#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, PonClave;
|FIN;

|PROCESO NumeraLin;
     #25#9 = nLinea;
     |GRABA 020#25a;
     |LIBERA #25;
|FPRC;

|DEFBUCLE NumeraLin;
     #25#1;
     ;
     #22#5, #22#0, #22#1, #22#7, #22#8, #22#2, #22#3;
     #22#5, #22#0, #22#1, #22#7, #22#8, #22#2, #22#3;
     be;
     NULL, NumeraLin;
|FIN;

|PROCESO Numera;
     |SI aSer ! #22#0; |O nNum ! #22#1; |O aArt ! #22#5; |O nPaq ! #22#2;
          nPrime = 1;
     |SINO;
          nPrime = 0;
     |FINSI;

     |SI aSer ! #22#0; |O nNum ! #22#1; |O aArt ! #22#5; |O nLon ! #22#3;
               |O #22#6 > 1;
          nLinea = nLinea + 1;
     |FINSI;
     aSer = #22#0;
     nNum = #22#1;
     nPaq = #22#2;
     nLon = #22#3;
     aArt = #22#5;

     |DDEFECTO #101;
     #101#5 = #22#5;
     #101#0 = #22#0;
     #101#1 = #22#1;
     #101#9 = #22#7;
     #101#10 = #22#8;
     #101#6 = nLinea;
     |LEE 101#101=;
     |SI FSalida ! 0; |GRABA 020#101b; |FINSI;
     |SI nPrime = 1;
         nNumPaquete = nNumPaquete + 1;
          #101#2 = nNumPaquete;
     |FINSI;
     #101#3 = #22#3;
     #101#4 = #101#4 + #22#4;
     #101#11 = #22#9;
     |GRABA 020#101a;
     |LIBERA #101;
     enMetros = enMetros + (#22#3 * #22#4);
     |BUCLE NumeraLin;
|FPRC;

|DEFBUCLE Numera;
     #22#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Numera;
|FIN;

|PROCESO Numeralo;
     enMetros = 0;
     aSer = "";
     nNum = 0;
     aArt = "";
     nLon = 0;
     nLinea = 0;
     |ABRE #101;
     |BUCLE Numera;
     |CIERRA #101;

     nClave = 0;
     |BUCLE PonClave;
/*
|ABRE #101;
|ABRE #25;
|CONSULTA_CLAVE #1#101;
|CONSULTA_CLAVE #1#25;
|CIERRA #101;
|CIERRA #25;
*/
|FPRC;

|PROCESO NecesidadesLote;
     |DDEFECTO #19;
     #19#0 = #12#3;
     |LEE 000#19=;
     |SI #12#5 = "I";
          eaColorI = #12#3;
          eaDesI = #19#1;
     |SINO;
          eaColorE = #12#3;
          eaDesE = #19#1;
     |FINSI;

     |DDEFECTO #19;
     #19#0 = #12#2;
     |LEE 000#19=;

     |SI nCheck = 0;
          |PRINT;
     |FINSI;
     |SI #12#8 = 0;
          nSwOrden = 1;
     |FINSI;

     nHay = 1;
|FPRC;

|DEFBUCLE NecesidadesLote;
     #12#1;
     ;
     #11#0, #11#1, #11#2, #11#3, "               ", #11#5;
     #11#0, #11#1, #11#2, #11#3, "zzzzzzzzzzzzzzz", #11#5;
     ;
     NULL, NULL, NULL, NULL, NULL, NecesidadesLote;
     #12#8;
|FIN;

|PROCESO Necesidades;
     |DDEFECTO #19;
     #19#0 = #11#3;
     |LEE 000#19=;
     aLinea = #19#125; |QBT aLinea;

     eaColorI = "";
     eaDesI = "";
     eaColorE = "";
     eaDesE = "";
     |SI #11#6 = "S"; |Y aLinea = "5";
          |BUCLE NecesidadesLote;
     |FINSI;
|FPRC;

|DEFBUCLE Necesidades;
     #11#1;
     ;
     #0#0, #0#1, "                    ", "                    ", " ";
     #0#0, #0#1, "zzzzzzzzzzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzz", "z";
     ;
     NULL, NULL, NULL, NULL, NULL, Necesidades;
     #11#0, #11#1, #11#3, #11#5;
|FIN;

|PROCESO TmpLineas;
     nHay = 1;
     |PRINT;
|FPRC;

|DEFBUCLE TmpLineas;
     #25#2;
     ;
     #101#7, 00001;
     #101#7, 99999;
     ;
     NULL, TmpLineas;
|FIN;

|PROCESO Print;
     |DDEFECTO #19;
     #19#0 = #101#5;
     |LEE 000#19=;

     nHay = 0;

     #25#8 = "S";
     |BUCLE TmpLineas;
     |SI nHay = 0;
          |DDEFECTO #25;
          #25#6 = #101#7;
          #25#8 = "N";
          |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE Otro;
     #101#2;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Print;
|FIN;

|DEFBUCLE Accesorio;
     #101#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Print;
|FIN;

|DEFBUCLE Tapajunta;
     #101#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Print;
|FIN;

|DEFBUCLE Principal;
     #101#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Print;
|FIN;

|PROCESO PaquetesLin;
     nHay = 1;
     |DDEFECTO #22;
     #22#5 = #73#2;
     #22#0 = #7#0;
     #22#1 = #7#1;
     #22#7 = #6#11;
     #22#8 = #6#12;
     #22#2 = #7#2;
     #22#3 = #8#4;
     |LEE 101#22=;
     |SI FSalida ! 0; |GRABA 020#22b; |LIBERA #22; |FINSI;
     #22#4 = #22#4 + #8#5;
     #22#6 = nLinea;
     #22#9 = #6#3;
     |GRABA 020#22a;
     |LIBERA #22;
     |SI nLinea = 1;
          |DDEFECTO #25;
          #25#0 = #73#2;
          #25#1 = #8#0;
          #25#2 = #8#1;
          #25#3 = #8#2;
          #25#4 = #8#4;
          #25#5 = #8#5;
          #25#10 = #22#7;
          #25#11 = #22#8;
          |GRABA 020#25n;
     |FINSI;
|FPRC;

|DEFBUCLE PaquetesLin;
     #8#1;
     ;
     #7#0, #7#1, #7#2, #10#4;
     #7#0, #7#1, #7#2, #10#4;
     ;
     NULL, PaquetesLin;
|FIN;

|PROCESO PaquetesCuenta;
     nLinea = nLinea + 1;
|FPRC;

|DEFBUCLE PaquetesCuenta;
     #8#1;
     ;
     #7#0, #7#1, #7#2, 001;
     #7#0, #7#1, #7#2, 999;
     ;
     NULL, PaquetesCuenta;
|FIN;

|PROCESO Paquetes;
     nLinea = 0;
     |BUCLE PaquetesCuenta;
     |BUCLE PaquetesLin;
|FPRC;

|DEFBUCLE Paquetes;
     #7#1;
     3;
     #73#28, #73#0, 0001, #73#2;
     #73#28, #73#0, 9999, #73#2;
     ;
     NULL, Paquetes;
|FIN;

|PROCESO OrdenLin;
     #6#0 = #10#2;
     #6#1 = #10#3;
     #6#2 = #10#4;
     |LEE 020#6=;

     #73#28 = #10#2;
     #73#0 = #10#3;
     #73#1 = #10#4;
     |LEE 000#73=;
     |SI FSalida = 0;
          |DDEFECTO #19;
          #19#0 = #73#2;
          |LEE 000#19=;
          aLinea = #19#125; |QBT aLinea;
          |SI aLinea = aTipo;
               |BUCLE Paquetes;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE OrdenLin;
     #10#1;
     ;
     #0#0, #0#1, "     ", 000001, 001;
     #0#0, #0#1, "zzzzz", 999999, 999;
     ;
     NULL, OrdenLin;
|FIN;

|PROCESO Principales;
     |HAZ CreaTempo; |NOME_DAT #22 Tempo; |DELINDEX #22; aTmp22 = Tempo;
     |HAZ CreaTempo; |NOME_DAT #25 Tempo; |DELINDEX #25; aTmp25 = Tempo;
     |HAZ CreaTempo; |NOME_DAT #101 Tempo; |DELINDEX #101; aTmp101 = Tempo;
     |ABRE #19;
     |ABRE #73;
     |ABRE #6;
     nHay = 0;
     |ABRE #22;
     |ABRE #25;
     aTipo = "1";
     |BUCLE OrdenLin;
     |CIERRA #22;
     |CIERRA #25;
     |SI nHay = 0;
          |SI Menu2 ! 6;
               |MENAV "0000No hay registros...";
          |FINSI;
     |SINO;
          |HAZ Numeralo;

          Impresora = "Crystal Reports";
          |IMPRE 0;
          |SI FSalida = 0;
               |INFOR aInforme1;
               |SI FSalida = 0;
                    eaArti = aArtiPro % 106;
                    eaColorE = aArtiPro % 602;
                    eaColorI = aArtiPro % 902;
                    eaEspesorE = aArtiPro % 801;
                    eaEspesorI = aArtiPro % 1101;
                    |BUCLE Principal;
                    |PIEINF;
                    |FININF;
               |SINO;
                    aAlfa = "0000Error en informe " + aInforme1;
                    |MENAV aAlfa;
               |FINSI;
               |FINIMP;
          |FINSI;
     |FINSI;
     |CIERRA #6;
     |CIERRA #73;
     |CIERRA #19;
     Tempo = aTmp22; |HAZ BoraTempo; |DELINDEX #22;
     Tempo = aTmp25; |HAZ BoraTempo; |DELINDEX #25;
     Tempo = aTmp101; |HAZ BoraTempo; |DELINDEX #101;
|FPRC;

|PROCESO Tapajuntas;
     |HAZ CreaTempo; |NOME_DAT #22 Tempo; |DELINDEX #22; aTmp22 = Tempo;
     |HAZ CreaTempo; |NOME_DAT #25 Tempo; |DELINDEX #25; aTmp25 = Tempo;
     |HAZ CreaTempo; |NOME_DAT #101 Tempo; |DELINDEX #101; aTmp101 = Tempo;
     |ABRE #19;
     |ABRE #73;
     |ABRE #6;
     nHay = 0;
     |ABRE #22;
     |ABRE #25;
     aTipo = "2";
     |BUCLE OrdenLin;
     |CIERRA #22;
     |CIERRA #25;
     |SI nHay = 0;
          |SI Menu2 ! 6;
               |MENAV "0000No hay registros...";
          |FINSI;
     |SINO;
          |HAZ Numeralo;

          Impresora = "Crystal Reports";
          |IMPRE 0;
          |SI FSalida = 0;
               |INFOR aInforme2;
               |SI FSalida = 0;
                    |BUCLE Tapajunta;
                    |PIEINF;
                    |FININF;
               |SINO;
                    aAlfa = "0000Error en informe " + aInforme2;
                    |MENAV aAlfa;
               |FINSI;
               |FINIMP;
          |FINSI;
     |FINSI;
     |CIERRA #6;
     |CIERRA #73;
     |CIERRA #19;
     Tempo = aTmp22; |HAZ BoraTempo; |DELINDEX #22;
     Tempo = aTmp25; |HAZ BoraTempo; |DELINDEX #25;
     Tempo = aTmp101; |HAZ BoraTempo; |DELINDEX #101;
|FPRC;

|PROCESO Accesorios;
     |HAZ CreaTempo; |NOME_DAT #22 Tempo; |DELINDEX #22; aTmp22 = Tempo;
     |HAZ CreaTempo; |NOME_DAT #25 Tempo; |DELINDEX #25; aTmp25 = Tempo;
     |HAZ CreaTempo; |NOME_DAT #101 Tempo; |DELINDEX #101; aTmp101 = Tempo;
     |ABRE #19;
     |ABRE #73;
     |ABRE #6;
     nHay = 0;
     |ABRE #22;
     |ABRE #25;
     aTipo = "3";
     |BUCLE OrdenLin;
     |CIERRA #22;
     |CIERRA #25;

     |SI nHay = 0;
          |SI Menu2 ! 6;
               |MENAV "0000No hay registros...";
          |FINSI;
     |SINO;
          |HAZ Numeralo;

          Impresora = "Crystal Reports";
          |IMPRE 0;
          |SI FSalida = 0;
               |INFOR aInforme3;
               |SI FSalida = 0;
                    |BUCLE Accesorio;
                    |PIEINF;
                    |FININF;
               |SINO;
                    aAlfa = "0000Error en informe " + aInforme3;
                    |MENAV aAlfa;
               |FINSI;
               |FINIMP;
          |FINSI;
     |FINSI;
     |CIERRA #6;
     |CIERRA #73;
     |CIERRA #19;
     Tempo = aTmp22; |HAZ BoraTempo; |DELINDEX #22;
     Tempo = aTmp25; |HAZ BoraTempo; |DELINDEX #25;
     Tempo = aTmp101; |HAZ BoraTempo; |DELINDEX #101;
|FPRC;

|PROCESO Otros;
     |HAZ CreaTempo; |NOME_DAT #22 Tempo; |DELINDEX #22; aTmp22 = Tempo;
     |HAZ CreaTempo; |NOME_DAT #25 Tempo; |DELINDEX #25; aTmp25 = Tempo;
     |HAZ CreaTempo; |NOME_DAT #101 Tempo; |DELINDEX #101; aTmp101 = Tempo;
     |ABRE #19;
     |ABRE #73;
     |ABRE #6;
     nHay = 0;
     |ABRE #22;
     |ABRE #25;
     aTipo = "4";
     |BUCLE OrdenLin;
     |CIERRA #22;
     |CIERRA #25;
     |SI nHay = 0;
          |SI Menu2 ! 6;
               |MENAV "0000No hay registros...";
          |FINSI;
     |SINO;
          |HAZ Numeralo;

          Impresora = "Crystal Reports";
          |IMPRE 0;
          |SI FSalida = 0;
               |INFOR aInforme4;
               |SI FSalida = 0;
                    |BUCLE Otro;
                    |PIEINF;
                    |FININF;
               |SINO;
                    aAlfa = "0000Error en informe " + aInforme4;
                    |MENAV aAlfa;
               |FINSI;
               |FINIMP;
          |FINSI;
     |FINSI;
     |CIERRA #6;
     |CIERRA #73;
     |CIERRA #19;
     Tempo = aTmp22; |HAZ BoraTempo; |DELINDEX #22;
     Tempo = aTmp25; |HAZ BoraTempo; |DELINDEX #25;
     Tempo = aTmp101; |HAZ BoraTempo; |DELINDEX #101;
|FPRC;

|PROCESO Bobinas;
     nSwOrden = 0;
     nHay = 0;
     nCheck = 1;
     |ABRE #19;
     |BUCLE Necesidades;
     |CIERRA #19;
     |SI nHay = 0;
          |SI Menu2 ! 6;
               |MENAV "0000No hay registros...";
          |FINSI;
          |ACABA;
     |FINSI;
     |SI nSwOrden ! 0;
          |MENAV "0000Existen partidas con orden '0'";
          |CONFI "0000NContinuar imprimiendo las bobinas?";
          |SI FSalida ! 0; |ACABA; |FINSI;
     |FINSI;

     Impresora = "Crystal Reports";
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR aInforme5;
          |SI FSalida = 0;
               aTipo = "5";
               |ABRE #19;
               nCheck = 0;
               |BUCLE Necesidades;
               |CIERRA #19;
               |PIEINF;
               |FININF;
          |SINO;
               aAlfa = "0000Error en informe " + aInforme5;
               |MENAV aAlfa;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |ABRE #9;
     #9#0 = #0#0;
     #9#1 = #0#1;
     |LEE 000#9=;
     |SI FSalida = 0;
          aArtiPro = #9#3;
          |MENUG Menu;
          |SI FSalida > 0;
               Menu2 = FSalida;
               |SI Menu2 = 1; |HAZ Principales; |FINSI;
               |SI Menu2 = 2; |HAZ Tapajuntas; |FINSI;
               |SI Menu2 = 3; |HAZ Accesorios; |FINSI;
               |SI Menu2 = 4; |HAZ Otros; |FINSI;
               |SI Menu2 = 5; |HAZ Bobinas; |FINSI;
               |SI Menu2 = 6;
                    |HAZ Principales;
                    |HAZ Tapajuntas;
                    |HAZ Accesorios;
                    |HAZ Otros;
                    |HAZ Bobinas;
               |FINSI;
          |FINSI;
     |SINO;
          |MENAV "0000No existe Orden de Fabricacion";
     |FINSI;
     |CIERRA #9;

|FPRC;
