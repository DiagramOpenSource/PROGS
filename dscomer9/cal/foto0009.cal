|FICHEROS;
     foto0009 #0;   || Pantalla
     foto0001 #1;   || Sobres
|FIN;

|VARIABLES;
     aBuclePrinSalir     = "";
     F2                  = 10;
     aTmp                = "";
|FIN;


|| Comprueba la salida y expulsa
|PROCESO CompruebaSalida;|TIPO 6;
     |SI FSalida = F2;
          aBuclePrinSalir = "S";
          |ERROR;
          |PTEC 807;
     |FINSI;
|FPRC;


|PROCESO ExisteSobre;
     #foto0001#0 = "E";            || Laboratorio externo
     #foto0001#1 = #foto0009#0;    || Numero de sobre
     |LEE 101#foto0001.=;
     |SI FSalida ! 0;
          |MENAV "0000El Numero de Sobre no existe."
          |ERROR;
     |SINO;
          |DEFECTO #foto0009#foto0001;
          |PINDA #0#foto0009;
     |FINSI;
|FPRC;

|PROCESO ActualizaSobre;

     #foto0001#34= #foto0009#5;    || Fecha de Reenvio
     |HORA aTmp;
     |QBF aTmp;
     #foto0001#35= aTmp;           || Hora de Reenvio
     #foto0001#36= #foto0009#6;    || Cajero de reenvio
     #foto0001#19= "R";            || Estado
     #foto0001#30= #foto0009#4;    || Observaciones

     |GRABA 021#foto0001.a;
     |LIBERA #foto0001;
|FPRC;

|| ************************** PROGRAMA PRINCIPAL ****************************
|PROGRAMA;
     |CLS;
     |CABEZA "Reenvios a Lab. Externos";

     |ABRE #foto0001;         || Sobres

     |PINPA #0#foto0009;
     aBuclePrinSalir= "N";
     |PARA;|SI aBuclePrinSalir ! "S";|HACIENDO;
          |ENDATOS #1#foto0009;

          || Si ha contestado Es correcto "S"
          |SI FSalida = 0;
               |HAZ ActualizaSobre;
          |FINSI;

          |DDEFECTO #foto0009;
          |PINPA #0#foto0009;
          |PINDA #0#foto0009;
     |SIGUE;

     |CIERRA #foto0001;
|FPRO;
