|FICHEROS;
     visez009 #0;
     visem001 #1;
     visem002 #2;
     visem003 #3;
     agifa081 #81;
     agifa067 #67;
|FIN;

|VARIABLES;
     nLin = 0;
     nUni = 0;
|FIN;

|PROCESO Pedidos;
     |DDEFECTO #81;
     #81#25 = #67#28;
     #81#0 = #67#0;
     |LEE 000#81=;

     nLin = nLin + 1;
     nUni = nUni + #67#5;
     |DDEFECTO #3;
     #3#0 = #2#0;
     #3#1 = #2#1;
     #3#2 = nLin;
     #3#3 = #2#2;
     #3#4 = #2#3;
     #3#5 = #67#20;
     #3#6 = #67#5;
     #3#7 = #67#6;
     #3#8 = #67#8;
     #3#10 = #1#1;
     #3#11 = "R";
     #3#12 = #81#27;
     #3#13 = #67#39;
     #3#14 = #67#40;
     #3#15 = #67#41;
     #3#16 = #67#42;
     #3#17 = #67#43;
     #3#18 = #67#47;
     #3#19 = #67#48;
     #3#20 = #67#49;
     #3#21 = #67#54;
     #3#22 = #67#13;
     #3#24 = #2#23;       || Almacen
     #3#25 = #67#28;
     #3#26 = #67#0;
     #3#27 = #67#1;
     |GRABA 020#3n;
|FPRC;

|DEFBUCLE Pedidos;
     #67#3;
     ;
     #2#2, #1#3, 000001, "      ";
     #2#2, #1#3, 999999, "zzzzzz";
     ;
     NULL, Pedidos;
|FIN;

|PROCESO visem003;
     |BORRA 020#3a;
|FPRC;

|DEFBUCLE visem003;
     #3#1;
     ;
     #2#0, #2#1, 001;
     #2#0, #2#1, 999;
     be;
     NULL, visem003;
|FIN;

|PROCESO visem002;
     |BUCLE visem003;
     nLin = 0;
     nUni = 0;
     |ABRE #3;
     |BUCLE Pedidos;
     #2#22 = #2#5 - nUni;
     |SI #2#22 > 0;
           nLin = nLin + 1;
          |DDEFECTO #3;
          #3#0 = #2#0;
          #3#1 = #2#1;
          #3#2 = nLin;
          #3#3 = #2#2;
          #3#4 = #2#3;
          #3#5 = #2#4;
          #3#6 = #2#22;
          #3#7 = #2#6;
          #3#8 = #2#7;
          #3#10 = #1#1;
          #3#11 = "P";
          #3#12 = #2#11;
          #3#13 = #2#12;
          #3#14 = #2#13;
          #3#15 = #2#14;
          #3#16 = #2#15;
          #3#17 = #2#16;
          #3#18 = #2#17;
          #3#19 = #2#18;
          #3#20 = #2#19;
          #3#21 = #2#20;
          #3#22 = #2#21;
          #3#24 = #2#23;
          |GRABA 020#3n;
     |FINSI;
     |CIERRA #3;
     |GRABA 020#2a;
     |LIBERA #2;
|FPRC;

|DEFBUCLE visem001;
     #1#1;
     ;
     #0#0;
     #0#0;
     be;
     NULL, NULL, visem002;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |SI #0#1 = "SI";
          |ABRE #81;
          |BUCLE visem001;
          |CIERRA #81;
     |FINSI;
|FPRC;
