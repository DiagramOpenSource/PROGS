|FICHEROS;
     obras011 #0;       ||Cobros.
     obras001 #1;       ||Obras.
     obras002 #2;       ||Bloques.
     obras003 #3;       ||Plantas.
     obras008 #4;       ||Mant.Pisos.
     obrasf09 #6,MANTE; ||Lineas Pisos. (FANTASMA).
     obras012 #7;       ||Historico Cobros Parciales.
|FIN;

|VARIABLES;
     &enSwConta = 0;
     inkey = 0;
     aa    = 0;
     sumareg=0;
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Tipo12_35;
|FPRC;
|PROCESO TotaHipo;
|FPRC;
|PROCESO Hipo2;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO Tipo12; |TIPO 12;
|FPRC;

|PROGRAMA;
     |CLS;
     |CABEZA "Cobros Parciales";
     |PARA FSalida = 0; |SI FSalida = 0; |HACIENDO;
          |DDEFECTO #0;
          |PINPA #0#0;
          |PINDA #0#0;
          |ENTLINEAL #1#6, 5 , 7 , 20 , 0, inf , sup;
          |ENDATOS #1#0;
     |SIGUE;
|FPRO;

|PROCESO leeob; |TIPO 0;
     |SI FSalida = 1;
          |PTEC 807;
          |ERROR; |ACABA;
     |FINSI;

     |ABRE #1;
     #1#0=#0#0;
     |LEE 000#1=;
     |SI FSalida ! 0;
        |MENAV "0000No Existe la Obra...";
          |ERROR;
     |FINSI;
     |ATRI I;
     |PINTA 0713, #1#1;
     |ATRI i;
     |CIERRA #1;
|FPRC;

|PROCESO leebl; |TIPO 0;
         |ABRE #2;
         #2#0=#0#0;
         #2#1=#0#1;
         |LEE 000#2=;
         |SI FSalida ! 0;
            |MENAV "0000No Existe el Bloque...";
              |ERROR;
         |FINSI;
         |ATRI I;
         |PINTA 0813, #2#2;
         |ATRI i;
         |CIERRA #2;
|FPRC;

|PROCESO leepl; |TIPO 0;
         |ABRE #3;
         #3#0=#0#0;
         #3#1=#0#1;
         #3#2=#0#2;
         |LEE 000#3=;
         |SI FSalida ! 0;
            |MENAV "0000No Existe la Planta...";
              |ERROR;
         |FINSI;
         |ATRI I;
         |PINTA 0913, #3#3;
         |ATRI i;
         |CIERRA #3;
|FPRC;

|PROCESO leepi; |TIPO 0;
         |ABRE #4;
         #4#0=#0#0;
         #4#1=#0#1;
         #4#2=#0#2;
         #4#3=#0#3;
         |LEE 000#4=;
         |SI FSalida ! 0;
            |MENAV "0000No Existe el Piso...";
              |ERROR;
         |FINSI;
         |ATRI I;
         |PINTA 0946, #4#4;
         |PINTA 1046, #4#5;
         |PINTA 1146, #4#6;
         |PINTA 1256, #4#11;
         |PINTA 1348, #4#14;
         |ATRI i;
         |CIERRA #4;
|FPRC;



|PROCESO sacalin; |TIPO 0;

    |ENTLINEAL #1#6, 5 , 4 , 20 , 0, inf , sup;

    |POPV;

     |CONFI "0000NEnlazar Cobros";
     |SI FSalida = 0;
          enSwConta = 1;
          |HAZ Contabiliza;
     |FINSI;
|FPRC;

|RUTINA inf;
    #6#0 = #0#0;
    #6#1 = #0#1;
    #6#2 = #0#2;
    #6#3 = #0#3;
    #6#4 = 1;
|FRUT;
|RUTINA sup;
    #6#0 = #0#0;
    #6#1 = #0#1;
    #6#2 = #0#2;
    #6#3 = #0#3;
    #6#4 = 999;
|FRUT;

|PROCESO cobro; |TIPO 11;

    inkey = FSalida;

       |SI inkey ! 9; |ACABA; |FINSI;

         |SI #6#10 = 0;
            |MENAV "0000No esta Pdte. Cobro..";
              |ACABA;
         |FINSI;
         |CAMPO_MODIFICA #0#4, 1 , "S";
         |CAMPO_VISUAL   #0#4, 1 , "S";
     |ET malo;
         |ENCAMPO #4#0;
           |SI #0#4 > #6#10;
            |MENAV "0000La Cantidad Pdte.Cobro es Menor...";
            |VETE malo;
           |FINSI;
         |CAMPO_MODIFICA #0#4, 1 , "N";
         |CAMPO_VISUAL   #0#4, 1 , "N";
         |CAMPO_MODIFICA #0#5, 1 , "S";
         |CAMPO_VISUAL   #0#5, 1 , "S";
         |ENCAMPO #5#0;
         |CAMPO_MODIFICA #0#5, 1 , "N";
         |CAMPO_VISUAL   #0#5, 1 , "N";
         |CAMPO_MODIFICA #0#6, 1 , "S";
         |CAMPO_VISUAL   #0#6, 1 , "S";
         |ENCAMPO #6#0;
         |CAMPO_MODIFICA #0#6, 1 , "N";
         |CAMPO_VISUAL   #0#6, 1 , "N";
         |CAMPO_MODIFICA #0#7, 1 , "S";
         |CAMPO_VISUAL   #0#7, 1 , "S";
         |ENCAMPO #7#0;
         |CAMPO_MODIFICA #0#7, 1 , "N";
         |CAMPO_VISUAL   #0#7, 1 , "N";

         |SI #0#7 = "S";
           |SI #0#4 = 0; |ACABA; |FINSI;
           |HAZ gracob;
         #6#9 = #6#9 + #0#4;
         #6#10 = #6#8 - #6#9;
         #6#7 = #0#6;
         |GRABA 020#6a;
         |FINSI;
         #0#4=0;
         #0#5="";
         #0#6="01.01.000";
         #0#7="S";
|FPRC;

|PROCESO proulco;
sumareg=#7#5;
|FPRC;

|DEFBUCLE ulco;
     #7#1;
;
#6#0,#6#1,#6#2,#6#3,#6#4,1;
#6#0,#6#1,#6#2,#6#3,#6#4,999;
;
NULL,proulco;
|FIN;


|PROCESO gracob;
       sumareg=0;
       |BUCLE ulco;
       |ABRE #7;
       |DDEFECTO #7;
       #7#0=#6#0;
       #7#1=#6#1;
       #7#2=#6#2;
       #7#3=#6#3;
       #7#4=#6#4;
       sumareg=sumareg+1;
       #7#5=sumareg;
            #7#6=#0#5;
            #7#7=#0#4;
            #7#8=#0#6;
       |GRABA 020#7n;
       |LIBERA #7;
       |CIERRA #7;
|FPRC;
