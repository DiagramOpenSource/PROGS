|FICHEROS;
     agis0005 #0;
     agifa073 #1;
     agis0004 #2;
|FIN;

|VARIABLES;
     &eaArticulo = "";
     entrar = 0;
     &nDeci_Base = 0;
     &nDeci_PreBase = 0;
|FIN;

|PROCESO Llena005; |TIPO 6;
     eaArticulo = #0Campo;
     |HAZ LlenaArticulo;
     |SI FSalida = 0;
          #0Campo = eaArticulo;
          |PINTA #0Campo;
     |SINO;
          |ERROR; |ACABA;
     |FINSI;
|FPRC;

|PROCESO pinta; |TIPO 0;
     entrar = (FEntrada / 100) !0;
     |SI entrar = 1;
          |ABRE #1;
          |DDEFECTO #1;
          #1#0 = #0#1;   ||n§ pedido;
          #1#1 = #0#4;   ||Linea pedido;
          #1#28= #0#0;   ||Serie;
          |LEE 101#1=;
          |SI FSalida = 0;
               |SI #1#33 ="S"; |Y #1#34 ] #1#5;
                    |MENAV "    Linea de pedido en lista !!";
                    |ERROR;
               |SINO;
                    #0#5 = #1#2;             ||articulo;
                    #0#6 = #1#4;             ||descripcion;
                    #0#7 = #1#5 - #1#34;     ||unidades - UND.EN LISTA.;
                    #0#8 = #1#6;             ||precio;
                    #0#9 = #1#9;             ||importe;
                    |PINTA #0#5;
                    |PINTA #0#6;
                    |PINTA #0#7;
                    |PINTA #0#8;
                    |PINTA #0#9;
               |FINSI;
          |SINO;
               |MENAV "    No existe linea de pedido !!";
               |ERROR;
          |FINSI;
          |CIERRA #1;
     |FINSI;
|FPRC;

|PROCESO actu; |TIPO 2;
     #0#9 = #0#7 * #0#8; |PINTA #0#9;
     #2#6 = #2#6 +. #0#9;|PINTA #2#6;
     entrar = (FEntrada / 100) !0;
     |ABRE #1;
     |DDEFECTO #1;
     #1#0 = #0#1; ||n§ pedido;
     #1#1 = #0#4; ||Linea pedido;
     #1#28= #0#0; ||Serie;
     |LEE 121#1=;
     |SI FSalida = 0;
          #1#34 = #1#34 +. #0#7;   || CANTIDAD EN LISTA.
          |SI entrar = 1; |Y #1#34 ! 0;
               #1#33 = "S";
          |FINSI;
          |SI entrar = 3; |Y #1#4 = 0;
               #1#33 = " ";
          |FINSI;
          |GRABA 020#1a;
          |LIBERA #1;
     |FINSI;
     |CIERRA #1;
|FPRC;


_________________/ R.AGUERA 11-06-98
_________________/ PERMITE INTRODUCIR EL IMPORTE ENTREGADO POR EL CLIENTE
_________________/ EN LA CABECERA.
|PROCESO importe; |TIPO 11;
     |SI FSalida = 9;
          |ENCAMPO #7#2;
          |ERROR;
     |FINSI;
|FPRC;
