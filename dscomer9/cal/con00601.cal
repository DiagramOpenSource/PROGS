|FICHEROS;
     con00601 #0;
     agifa142;
     agifa208;
     con00003;
     con00007 #7;
     agif0041 #41;
     con00601@ #1100;
|FIN;


|VARIABLES;
     &eaMatricula = "";
     nModo = 0;
     aAlfa = "";
     nCampo = 0;
     &EURODB = 0;
|FIN;

|PROCESO Campos;
     |SI nModo = 1; |Y #agifa208#3 = "S";
          nCampo = #agifa208#1;
          #con00601@#nCampo# = #con00601#nCampo#;
     |FINSI;
     |SI nModo = 2; |Y #agifa208#4 = "S";
          nCampo = #agifa208#1;
          #con00601@#nCampo# = #con00601#nCampo#;
     |FINSI;
|FPRC;

|DEFBUCLE Campos1;
     #agifa208#2;
     ;
     "con00601", 000, "S";
     "con00601", 999, "S";
     e;
     NULL,Campos;
|FIN;

|DEFBUCLE Campos2;
     #agifa208#3;
     ;
     "con00601", 000, "S";
     "con00601", 999, "S";
     e;
     NULL,Campos;
|FIN;

|PROCESO ControlEmp;
     |SI nModo = 1; |Y #con00003#13 ! "S"; |ACABA; |FINSI;
     |SI nModo = 2; |Y #con00003#14 ! "S"; |ACABA; |FINSI;
     |SI nModo = 3; |Y #con00003#15 ! "S"; |ACABA; |FINSI;

     |DFICB aAlfa; |QBF aAlfa; |PATH_DAT #agif0041#aAlfa#;
     |ABRE #agif0041; |SALVA_FICHA #agif0041;
     #agif0041#0 = #con00003#0;
     |LEE 000#agif0041.=;
     |SI FSalida = 0;
          |DBASE aAlfa; |QBF aAlfa;
          aAlfa = aAlfa + "def/con00601.mas";
          |CARGA_DEF aAlfa, con00601@;
          |SI FSalida = 0;
               |DFICB aAlfa; |QBF aAlfa;
               aAlfa = aAlfa + (("00000" + #con00003#0) % -105) + "/";
               |PATH_DAT #1100 aAlfa;
               |ABRE #con00601@;
               #con00601@#0 = #con00601#0;
               #con00601@#22 = #con00601#22;
               |LEE 101#con00601@.=;
               |SI nModo = 3;
                    |SI FSalida = 0;
                         |BORRA 020#con00601@.a; |LIBERA #con00601@;
                    |FINSI;
               |SINO;
                    |SI FSalida ! 0;
                         |DDEFECTO #con00601@;
                         #con00601@#0 = #con00601#0;
                         #con00601@#22 = #con00601#22;
                         |GRABA 020#con00601@.b;
                    |FINSI;
                    |SI nModo = 1; |BUCLE Campos1; |FINSI;
                    |SI nModo = 2; |BUCLE Campos2; |FINSI;
                    |GRABA 020#con00601@.a; |LIBERA #con00601@;
               |FINSI;
               |CIERRA #con00601@; |DESCARGA_DEF #con00601@;
          |FINSI;
     |FINSI;
     |REPON_FICHA #agif0041; |CIERRA #agif0041;
|FPRC;

|DEFBUCLE ControlEmp;
     #con00003#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, ControlEmp;
|FIN;

|PROCESO Matri16; |TIPO 16;
     nModo = (FEntrada / 100) ! 0;
     |ABRE #agifa142; |LEE 001#agifa142.p; |CIERRA #agifa142;

     |MENSA "    Actualizando vehiculos ... ";
     |SI #agifa142#28  = "S"; |BUCLE ControlEmp; |FINSI;
     |BLIN 4;
|FPRC;

|PROCESO Matri17; |TIPO 17;
     nModo = (FEntrada / 100) ! 0;
     |ABRE #agifa142; |LEE 001#agifa142.p; |CIERRA #agifa142;

     |MENSA "    Actualizando vehiculos ... ";
     |SI #agifa142#28  = "S"; |BUCLE ControlEmp; |FINSI;
     |BLIN 4;
|FPRC;

|PROCESO BorraObs;
     |BORRA 020#7a;
|FPRC;

|DEFBUCLE BorraObs;
     #7#1;
     ;
     #0#0, 001;
     #0#0, 999;
     ;
     NULL, BorraObs;
|FIN;

|PROCESO Vehiculo2; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
          |BUCLE BorraObs;
     |FINSI;
|FPRC;

|PROCESO Vehiculo20; |TIPO 20;
     |SI FSalida = "OPCION";
          FSalida = "Observa.";
     |SINO;
          eaMatricula = #0#0;
          |LIBERA #0;
          |SUB_EJECUTA_NP "con00007";
     |FINSI;
|FPRC;

|PROCESO Tipo13; |TIPO 13;
   |HAZ EsTallerSC;
   |SI FSalida = 0;
      |PINTA 1130, "N§ contrato : ";
      |C_M #con00601#29, 1, "S"; |C_V #con00601#29, 1, "S";
   |SINO;
      |C_M #con00601#29, 1, "N"; |C_V #con00601#29, 1, "N";
   |FINSI;
|FPRC;
