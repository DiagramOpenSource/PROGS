|FICHEROS;
     tagm0010 #0;
     tagm0011 #1,MANTE;
     agifa017 #17;
     agifa019 #19;
     agifa065 #65;
     dsm00043 #43;
     dsm00044 #44;
|FIN;

|VARIABLES;
     i         = 0;
     nHay      = 0;
     nTecla    = 0;
     aFic      = "";
     aMarca    = "";
     aPrime    = 0;
     nConta    = 0;
     nLin      = 0;
     nPrime    = 0;
     aAlfa     = "";
|FIN;

|INCLUYE i_varart;

|PROCESO LimParri; |TIPO 0;
     |PARA i = 1; |SI i [ 12; |HACIENDO i = i + 1;
          |C_M #0i, 1, "N";
     |SIGUE;
     |SI #0#0 = "L";
          |C_M #0#1, 1, "S";
          |C_M #0#2, 1, "S";
     |SINO;
          |PARA i = 3; |SI i [ 12; |HACIENDO i = i + 1;
               |C_M #0i, 1, "S";
          |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Tecla0; |TIPO 0;
     |SI FSalida = 0; |Y #1Campo = Contenido;
          |SI #1#5 = "*";
               #1#5 = "";
          |SINO;
               #1#5 = "*";
          |FINSI;
          |GRABA 020#1a;
          |PINTA #1#5;
     |FINSI;
|FPRC;

|PROCESO Tecla11; |TIPO 11;
     |SI FSalida = 10; |O FSalida = 11;
          nTecla = FSalida;
          |SI nTecla = 10;
               aMarca = "*";
          |SINO;
               aMarca = "";
          |FINSI;
          |PTEC 807;
     |FINSI;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO CabEntra;
     |LEE 000#43u;
     nConta = #43#0 + 1;
     |DDEFECTO #43;
     #43#0 = nConta;
     #43#1 = ~;
     #43#2 = "Puesta a 0 de Stock";
     |GRABA 020#43n;
|FPRC;

|PROCESO LinEntra;
     |SI nLin = 0; |O nLin > 999;
          nLin = 1;
          |HAZ CabEntra;
     |FINSI;
     |DDEFECTO #44;
     #44#18 = nConta;
     #44#8 = nLin;

     #44#0 = #1#0;
     #44#1 = #1#2;
     #44#2 = #1#1;
     #44#3 = #17#39;
     #44#4 = -#1#3;
     #44#5 = #43#1;
     #44#6 = #19#6;
     #44#7 = "E";
     #44#12 = -#1#4;
     #44#15 = #19#189;
     #44#16 = #19#190;
     #44#17 = #19#191;
     #44#19 = #17#48;
     #44#20 = #19#193;
     |GRABA 020#44n;
     nLin = nLin + 1;
|FPRC;

|PROCESO Actualiza;
     |SI nPrime = 0;
          nPrime = 1;
          |CONFI "S0000Conforme a lo seleccionado";
          |SI FSalida ! 0;
               |ERROR10; |ACABA;
          |FINSI;
     |FINSI;

     #17#0 = #1#0;
     #17#1 = #1#2;
     |LEE 000#17=;
     |SI FSalida ! 0; |DDEFECTO #17; |FINSI;

     #19#0 = #17#0;
     |LEE 000#19=;
     |SI FSalida ! 0; |DDEFECTO #19; |FINSI;

     |HAZ LinEntra;
     enForma = 1;
     enCodigo = #44#18;
     |HAZ AcumulaES_SS;
|FPRC;

|DEFBUCLE Actualiza;
     #1#1;
     5;
     "                    ", 01, "*";
     "zzzzzzzzzzzzzzzzzzzz", 99, "*";
     ;
     NULL, Actualiza;
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO agifa017;
     #19#0 = #17#0;
     |LEE 000#19=;
     |SI FSalida ! 0; |DDEFECTO #19; |FINSI;

     |SI #17#5 = 0; |Y #17#47 = 0; |ACABA; |FINSI;

     |DDEFECTO #1;
     #1#0 = #17#0;
     #1#1 = #19#1;
     |LEE 101#1=;
     |SI FSalida ! 0; |GRABA 020#1b; |FINSI;

     #1#2 = #17#1;
     #1#3 = #17#5;
     #1#4 = #17#47;
     #1#5 = "*";
     |GRABA 020#1a;
     |LIBERA #1;
     nHay = 1;
|FPRC;

|DEFBUCLE agifa017;
     #17#1;
     ;
     #0#1, 01;
     #0#2, 09;
     ;
     NULL, agifa017;
|FIN;

|PROCESO MarcaTodo;
     #1#5 = aMarca;
     |GRABA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE MarcaTodo;
     #1#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, MarcaTodo;
|FINSI;

|PROCESO Min;
     #1#0 = "";
     #1#1 = 1;
|FPRC;

|PROCESO Max;
     #1#0 = "z" * 20;
     #1#1 = 99;
|FPRC;

|PROCESO Tipo_3; |TIPO 3;
     aFic = Usuario; |QBF aFic;
     |NOME_DAT #1 aFic;
     |DELINDEX #1;

     |ABRE #19;
     |ABRE #1;
     |SI #0#0 = "P";
          |PARA i = 3; |SI i [ 12; |HACIENDO i = i + 1;
               aAlfa = #0i; |QBF aAlfa;
               |SI aAlfa ! "";
                    #0#1 = #0i;
                    #0#2 = #0i;
                    |BUCLE agifa017;
               |FINSI;
          |SIGUE;
     |SINO;
          |BUCLE agifa017;
     |FINSI;
     |CIERRA #1;
     |CIERRA #19;
     |SI nHay ! 0;
          |PARA nTecla = 1; |SI nTecla ! 0; |HACIENDO;
               |SI nTecla > 1;
                    |BUCLE MarcaTodo;
               |FINSI;
               nTecla = 0;
               |PINPA #0#1;
               |ENTLINEAL #1#1 , -1 , 4 , 22 , 0 , Min, Max;
          |SIGUE;
          |ABRET #17;
          |ABRET #19;
          |ABRE #43;
          |ABRE #44;
          |BUCLE Actualiza;
          |CIERRA #43;
          |CIERRA #44;
          |CIERRAT #17;
          |CIERRAT #19;
     |FINSI;

     |CIERRA #1;
     |DELINDEX #1;
|FPRC;
