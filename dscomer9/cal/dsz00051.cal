|FICHEROS;
     dsz00051;
     agifa059;
     agifa010;
     agifa134;
     agifa071;
|FIN;

|VARIABLES;
     aAlfa1 = "";
     aAlfa2 = "";
     aAlfa3 = "";
     aAlfa4 = "";
     nNume1 = 0;
     nNume2 = 0;
     nNume3 = 0;
     nNume4 = 0;
     nPara1 = 0;
     nPara2 = 0;
     nPara3 = 0;
     nPara4 = 0;
     fFech1 = @;
     fFech2 = @;
     fFech3 = @;
     fFech4 = @;
     nFEstado = 0;
     nSeleccio = 0;
     nEstaFacturado = 0;
|FIN;
____________________________________/
|PROCESO agifa071;
     #agifa071#30 = #agifa010#53;  || serie factura
     #agifa071#26 = #agifa010#39;  || nro. factura
     |GRABA 020#agifa071.a;
|FPRC;

|DEFBUCLE agifa071;
     #agifa071#1;
     ;
     #agifa010#52, #agifa010#0,   1;
     #agifa010#52, #agifa010#0, 999;
     be;
     NULL, agifa071;
|FIN;

|PROCESO agifa059_010;
     nEstaFacturado = 1;
|FPRC;

|DEFBUCLE agifa059_010;
     #agifa059#1;
     15, 2;
     "     ",      0,   0, #agifa010#52, #agifa010#0;
     "zzzzz", 999999, 999, #agifa010#52, #agifa010#0;
     ;
     NULL, agifa059_010;
|FIN;

|PROCESO agifa010;
     nEstaFacturado = 0;
     |BUCLE agifa059_010;
     |SI nEstaFacturado = 0;
          #agifa010#10 = "N";      || factura impresa S/N
          #agifa010#38 = "N";      || facturado S/N
          #agifa010#53 = "     ";  || serie fra.
          #agifa010#39 = 0;        || numero fra.
          |GRABA 020#agifa010.a;
          |BUCLE agifa071;
     |FINSI;
     |LIBERA #agifa010;
|FPRC;

|DEFBUCLE agifa010;
     #agifa010#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, agifa010;
|FIN;

|PROCESO agifa059;
     #agifa134#49 = #agifa059#14;
     #agifa134#0 = #agifa059#0;
     |LEE 000#agifa134.=;

     #agifa010#52 = #agifa059#15;
     #agifa010#0 = #agifa059#2;
     |LEE 101#agifa010.=;
     |SI FSalida = 0;
          #agifa010#10 = #agifa134#45;       || factura impresa S/N
          #agifa010#38 = "S";                || facturado S/N
          #agifa010#53 = #agifa059#14;       || serie fra.
          #agifa010#39 = #agifa059#0;        || numero fra.
          |GRABA 020#agifa010.a;
          |BUCLE agifa071;
     |SINO;
          aAlfa1 = "0000Albaran[" + #agifa010#52 + "." + #agifa010#0 + "] inaccesible. Factura [" + #agifa059#14 + "." + #agifa059#0 + "]";
          |MENAV aAlfa1;
     |FINSI;
     |LIBERA #agifa010;
|FPRC;

|DEFBUCLE agifa059;
     #agifa059#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, agifa059;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |SI #dsz00051#0 = "SI";

          |ABRE #agifa010;
          |ABRE #agifa134;
          |BUCLE agifa059;
          |CIERRA #agifa010;
          |CIERRA #agifa134;

          |BUCLE agifa010;
     |FINSI;
|FPRC;
