      Los procesos marcados con (*) son los necesarios para
      simular un cabeceras/lineas

|FICHEROS;
     extm0013 #0;
     extm0014 #1;
     extm0002 #2;
     extm0003 #3;
     extm0004 #4;
     extm0011 #11;
     extm0012 #12;
     extm0015 #15,MANTE;
     extm0016 #16,MANTE;
     extm0017 #17;
     agifa019 #19;
     agifa024 #24;
     extm0026 #26,MANTE;  || ambos tienen el mismo
     extm0027 #27,MANTE;  || fichero de datos
     dsm00003 #30;
     extm0001 #100;
     extm0024 #124;
     extz0004 #104,MANTE;     || Pan. Articulo Extras a Fact
     extz0005 #105,MANTE;     || Pan. Articulos Dejados Cli
     extz0006 #106,MANTE;     || Pan. Lineas
     extz0030 #300,MANTE;     || Pan. Agrupado
     referen@;
|FIN;

|VARIABLES;
     &eaPro = "";
     &enCod = 0;
     &eaVal = "";
     &enError = 0;
     &eaNumSerie = "";
     &eaNumNuevo = 0;
     &enModo = 0;
     &eaProg = "";
     &Tempo = "";
     aAlfa = "";
     nPanta = 0;
     nPanLin = 0;
     nGrid1 = -1;
     nBtnAlta = -1;
     nBtnModi = -1;
     nBtnBaja = -1;
     nBtnCons = -1;
     nBtnAgrupa = -1;
     nRango = 0;
     nModo = 0;
     nHay = 0;
     nModoLin = 0;
     aEstado = "";
     nSw = 0;
     i = 0;
     nBloquea = 0;

     &enCtrFin = 0;
     nBtnDejado = 0;
     nBtnExtra = 0;
     nBtnAltaD = 0;
     nBtnModiD = 0;
     nBtnBajaD = 0;
     nBtnConsD = 0;
     nBtnAltaE = 0;
     nBtnModiE = 0;
     nBtnBajaE = 0;
     nBtnConsE = 0;
     nGridArt = 0;
     nModoArt = 0;
     aConte = "";
     aSerie = "";
     nConta = 0;
     nLin = 0;
     aCliFa = "";
     aComer = "";
     nModoReg = 0;
|FIN;

|PROCESO BorraCara;
     |BORRA 020#26a;
     |LIBERA #26;
|FPRC;

|DEFBUCLE BorraCara;
     #26#1;
     ;
     #1#0, #1#1, #1#2, 00000;
     #1#0, #1#1, #1#2, 99999;
     be;
     NULL, BorraCara;
|FIN;

|PROCESO CreaCara;
     |DDEFECTO #26;
     #26#0 = #1#0;
     #26#1 = #1#1;
     #26#2 = #1#2;
     #26#3 = #124#0;
     |LEE 101#26=;
     #26#4 = #124#1;
     #26#5 = #124#3;
     |SI FSalida ! 0;
          #26#6 = #124#7;
          |GRABA 020#26b;
     |FINSI;
     |GRABA 020#26a;
     |LIBERA #26;
|FPRC;

|DEFBUCLE CreaCara;
     #124#2;
     ;
     #100#10;
     #100#10;
     ;
     NULL, CreaCara;
|FIN;

|PROCESO QuitaCara;
     #124#0 = #26#3;
     |LEE 000#124=;
     |SI FSalida ! 0;
          |BORRA 020#26a;
     |FINSI;
|FPRC;

|DEFBUCLE QuitaCara;
     #26#1;
     ;
     #1#0, #1#1, #1#2, 00000;
     #1#0, #1#1, #1#2, 99999;
     be;
     NULL, QuitaCara;
|FIN;

|PROCESO CreaCara0;
     |ABRE #100;
     #100#0 = #1#5;
     |LEE 000#100=;
     |SI FSalida = 0;
          |BUCLE CreaCara;
          |ABRE #124;
          |BUCLE QuitaCara;
          |CIERRA #124;
     |FINSI;
     |CIERRA #100;
|FPRC;

|PROCESO NoModiReg2; |TIPO 2;
     nModoReg = (FEntrada / 100) ! 0;
     |SI nModoReg = 3; |AVISO; |ERROR; |FINSI;
|FPRC;

|PROCESO NoModiReg0; |TIPO 0;
     nModoReg = (FEntrada / 100) ! 0;
     |SI nModoReg = 1; |AVISO; |ERROR; |FINSI;
|FPRC;

|PROCESO ValorR;
     eaPro = #26#2;
     enCod = #26#3;
     eaVal = #26#6;
     |HAZ ChequeaValor;
     |SI enError = 0;
          #26#6 = eaVal; |PINTA #27#6;
     |SINO;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO ValorT;
     eaPro = #27#2;
     enCod = #27#3;
     eaVal = #27#6;
     |HAZ ChequeaValor;
     |SI enError = 0;
          #27#6 = eaVal; |PINTA #27#6;
     |SINO;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO EvtT26;
     |SI FSalida = 1; |O FSalida = 2;
          |SELECT #2#27;
          |LEE 000#27=;
     |FINSI;
|FPRC;

|PROCESO EvtR26;
     |SI FSalida = 1; |O FSalida = 2;
          |SELECT #2#26;
          |LEE 000#26=;
     |FINSI;
|FPRC;

|PROCESO MinT;
     #27#0 = #1#0;
     #27#1 = #1#1;
     #27#2 = #1#2;
     #27#5 = "T";
     #27#3 = 0000;
|FPRC;

|PROCESO MaxT;
     #27#0 = #1#0;
     #27#1 = #1#1;
     #27#2 = #1#2;
     #27#5 = "T";
     #27#3 = 9999;
|FPRC;

|PROCESO MinR;
     #26#0 = #1#0;
     #26#1 = #1#1;
     #26#2 = #1#2;
     #26#5 = "R";
     #26#3 = 0000;
|FPRC;

|PROCESO MaxR;
     #26#0 = #1#0;
     #26#1 = #1#1;
     #26#2 = #1#2;
     #26#5 = "R";
     #26#3 = 9999;
|FPRC;

|PROCESO BtnCarac;
     |VENTANA 1201, 3199, -1, 17, "Caracteristicas";
     |HAZ PushVenModal;
     |SI nModoLin = 4;
          nRango = 4 + 8 + 16 + 32;
     |SINO;
          nRango = 1 + 4 + 8 + 16 + 32;
     |FINSI;
     |ABRE #26;
     |ABRE #27;
     |HAZ CreaCara0;
     |CONTROL_SIMPLE 0, "LABEL,{{003}}Caracteristicas de revisi¢n", 1202, 1298, NULL;
     |LINEAL_SIMPLE #2#26, nRango, 1302, 2098, MinR, MaxR, EvtR26;
     |CONTROL_SIMPLE 0, "LABEL,{{003}}Caracteristicas de trabajo", 2102, 2198, NULL;
     |LINEAL_SIMPLE #2#27, nRango, 2202, 2998, MinT, MaxT, EvtT26;
     |PAUSA;
     |CIERRA #27;
     |CIERRA #26;
     |HAZ PopVenModal;
|FPRC;

|PROCESO FecReal; |TIPO 0;
|FPRC;

|PROCESO CliComerFac;
     aCliFa = #11#39;
     aComer = #11#52;
     |ERROR10;
|FPRC;

|DEFBUCLE CliComerFac;
     #11#2;
     ;
     #0#4, 0001, "                    ", "                    ", "                    ";
     #0#4, 9999, "zzzzzzzzzzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, CliComerFac;
|FIN;

|PROCESO Ficticio; |TIPO 6;
     |SI FSalida = 13;
          |ABRE #12;
          |LEE 101#12p;
          |SI FSalida ! 0; |GRABA 020#12b; |FINSI;
          nConta = #12#1;
          #12#1 = #12#1 + 1;
          |GRABA 020#12a;
          |CIERRA #12;

          aAlfa = "DESC" + #0#4 + (("0000000000" + nConta) % -110);
          #106#2 = aAlfa; |PINTA #106#2;

          aCliFa = "";
          aComer = "";
          |BUCLE CliComerFac;
          |DDEFECTO #11;
          |ABRE #11;
          #11#0 = #106#2;
          #11#1 = #0#4;
          #11#2 = #0#6;
          #11#3 = #0#7;
          #11#4 = #106#5;
          #11#5 = #106#4;
          #11#39 = aCliFa;
          #11#52 = aComer;
          |GRABA 020#11n;
          |CIERRA #11;
          eaNumSerie = #11#0;
          eaNumNuevo = #11#0;
          enModo = 2;
          eaProg = "extz0003"; |HAZ EjecutaProg;
     |FINSI;
|FPRC;

|PROCESO Chequea; |TIPO 0;
     |SI nModoLin = 1; |Y nBloquea = 0;
          |ABRE #11;
          #11#0 = #106#2;
          |LEE 000#11=;
          |SI FSalida ! 0;
               |MENAV "0000No existe N§ serie art¡culo a revisar...";
               |ERROR;
          |SINO;
               aAlfa = "";
               |SI #0#4 ! #11#1; aAlfa = "0000Cliente incorrecto..."; |FINSI;
               |SI #0#6 ! #11#2; aAlfa = "0000Instalaci¢n incorrecta..."; |FINSI;
               |SI #0#7 ! #11#3; aAlfa = "0000Edificio incorrecto..."; |FINSI;
               |SI #0#8 ! #11#5; aAlfa = "0000Sistema incorrecto..."; |FINSI;
               |SI #11#46 ! 0; aAlfa = "0000N§ serie en parte:" + #11#45 + "/" + (("000000" + #11#46) % -106); |FINSI;
               |SI aAlfa ! "";
                    |MENAV aAlfa;
                    |ERROR;
               |SINO;
                    #1#0 = #106#0;
                    #1#1 = #106#1;
                    #1#2 = #106#2;
                    |GRABA 000#1b;
                    |SI FSalida ! 0;
                         |MENAV "0000Registro existente...";
                         |ERROR;
                    |SINO;
                         #106#3 = #11#7; |PINTA #106#3;
                         #106#4 = #11#5; |PINTA #106#4;
                         #106#5 = #11#4; |PINTA #106#5;
                         #106#7 = #11#38; |PINTA #106#7;
                         #106#8 = #11#24; |PINTA #106#8;
                         #106#9 = #11#23; |PINTA #106#9;
                         #106#10 = #11#27; |PINTA #106#10;
                         #106#11 = #11#34; |PINTA #106#11;
                         #106#12 = #11#33; |PINTA #106#12;
                         #106#13 = #11#37; |PINTA #106#13;
                         nSw = 1;
                         |HAZ SisteLin;
                         |HAZ ArtiLin;
                         |HAZ CliLin;
                         |HAZ ArtFac;
                         nSw = 0;

                         |C_M #106#2, 1, "N"; |PINTA #106#2;
                         |C_M #106#4, 1, "N"; |PINTA #106#4;
                         |C_M #106#5, 1, "N"; |PINTA #106#5;
                         nBloquea = 1;
                    |FINSI;
               |FINSI;
          |FINSI;
          |CIERRA #11;
     |FINSI;
|FPRC;

|PROCESO Edita;
     |SI nModoLin = 1; |VENTANA 1201, 3199, -1, 17, "Nuevo l¡nea revisi¢n"; |FINSI;
     |SI nModoLin = 2; |VENTANA 1201, 3199, -1, 17, "Modifica l¡nea revisi¢n"; |FINSI;
     |SI nModoLin = 4; |VENTANA 1201, 3199, -1, 17, "Consulta l¡nea revisi¢n"; |FINSI;
     |HAZ PushVenModal;

     |PINPA #0#106; nPanLin = FSalida;
     |CONTROL_SIMPLE nPanLin, "BOTON,{{137}}Caracteristicas", 0680, 0698, BtnCarac;
     |SI nModoLin = 1;
          |C_M #106#2, 1, "S";
          |C_M #106#4, 1, "N";
          |C_M #106#5, 1, "S";
          |DDEFECTO #106;
          #106#0 = #0#0;
          #106#1 = #0#1;
          #106#4 = #0#8;
     |SINO;
          |C_M #106#2, 1, "N";
          |C_M #106#5, 1, "N";
          |PARA i = 0; |SI i [ 26; |HACIENDO i = i + 1;
               #106i = #1i;
          |SIGUE;
          |SI nModoLin = 2;
               |ABRE #11;
               #11#0 = #106#2;
               |LEE 121#11=;
               |SI FSalida = 0;
                    #11#45 = "";
                    #11#46 = 0;
                    |GRABA 020#11a;
               |FINSI;
               |CIERRA #11;
          |FINSI;
     |FINSI;
     nSw = 1;
     |HAZ SisteLin;
     |HAZ ArtiLin;
     |HAZ CliLin;
     |HAZ ArtFac;
     nSw = 0;
     |PINDA #0#106;
     nBloquea = 0;
     |SI nModoLin = 1; |ENDATOS #1#106; |FINSI;
     |SI nModoLin = 2; |ENDATOS #2#106; |FINSI;
     |SI nModoLin = 4; |PAUSA; |FINSI;
     |SI FSalida = 0; |Y nModoLin ! 4;
          |ABRE #11;
          #11#0 = #106#2;
          |LEE 121#11=;
          |SI FSalida = 0;
               #11#45 = #0#0;
               #11#46 = #0#1;
               |GRABA 020#11a;
          |FINSI;
          |CIERRA #11;
          |PARA i = 0; |SI i [ 26; |HACIENDO i = i + 1;
               #1i = #106i;
          |SIGUE;
          |GRABA 020#1a;
          |HAZ CreaCara0;
          |REFRESCACONTROL nGrid1;
     |SINO;
          |SI nBloquea = 1;
               |BUCLE BorraCara;
               |BORRA 020#1c;
          |FINSI;
     |FINSI;
     |LIBERA #1;
     |HAZ PopVenModal;
|FPRC;

|PROCESO BtnAlta;
     nModoLin = 1;
     |HAZ Edita;
|FPRC;

|PROCESO BtnModi;
     |LEE 101#1=;
     |SI FSalida = 0;
          nModoLin = 2;
          |HAZ Edita;
          |LIBERA #1;
     |FINSI;
|FPRC;

|PROCESO BtnBaja;
     |LEE 101#1=;
     |SI FSalida = 0;
          aAlfa = "0000N¨Borrar art¡culo con n§ serie:" + #1#2;
          |QBF aAlfa;
          aAlfa = aAlfa + "?";
          |CONFI aAlfa;
          |SI FSalida = 0;
               |BUCLE BorraCara;
               |BORRA 020#1a;
               |REFRESCACONTROL nGrid1;
          |FINSI;
          |LIBERA #1;
     |FINSI;
|FPRC;

|PROCESO BtnCons;
     |LEE 000#1=;
     |SI FSalida = 0;
          nModoLin = 4;
          |HAZ Edita;
     |FINSI;
|FPRC;

|PROCESO Evt1;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#1=;
     |FINSI;
|FPRC;

|PROCESO Min;
     #1#0 = #0#0;
     #1#1 = #0#1;
     #1#2 = "                    ";
|FPRC;

|PROCESO Max;
     #1#0 = #0#0;
     #1#1 = #0#1;
     #1#2 = "zzzzzzzzzzzzzzzzzzzz";
|FPRC;

|PROCESO Tipo14; |TIPO 14;    ||(*)
     |SI nGrid1 = -1;
          |PINPA #0#0; nPanta = FSalida;
          |CONTROL_SIMPLE nPanta, "BOTON,...", 1757, 1760, BtnAgrupa;
          nBtnAgrupa = FSalida;
          |CONTROL_SIMPLE nPanta, "BOTON,{{193}}Alta", 2502, 2512, BtnAlta;
          nBtnAlta = FSalida;
          |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Modificar", 2514, 2524, BtnModi;
          nBtnModi = FSalida;
          |CONTROL_SIMPLE nPanta, "BOTON,{{199}}Baja", 2526, 2536, BtnBaja;
          nBtnBaja = FSalida;
          |CONTROL_SIMPLE nPanta, "BOTON,{{155}}Consulta", 2538, 2548, BtnCons;
          nBtnCons = FSalida;
          aEstado = "DIABLE";
          |HAZ EstadoBtn;

          |CONTROL_SIMPLE nPanta, "BOTON,{{137}}Articulos Extras", 0656, 0676, BtnExtra;
          nBtnDejado = FSalida;
          |CONTROL_SIMPLE nPanta, "BOTON,{{137}}Articulos Dejados", 0678, 0698, BtnDejado;
          nBtnExtra = FSalida;

          nRango = 4 + 8 + 16 + 32;
          |LINEAL_SIMPLE #1#1, nRango, 2602, 3298, Min, Max, Evt1;
          nGrid1 = FSalida;
     |SINO;
          ||REFRESCACONTROL nGrid1;
     |FINSI;
|FPRC;

|PROCESO BtnAgrupa;
     |VENTANA 1312, 1887, -1, 17, "Art¡culo agrupaci¢n l¡neas";
     |HAZ PushVenModal;

     #300#0 = #0#41;
     #300#1 = #0#42;
     |PINPA #0#300;
     |PINDA #0#300;
     |SI nModo = 1; |O nModo = 2;
          |C_M #300#1, 1, "S";
          |ENDATOS #1#300;
          |SI FSalida = 0;
               aAlfa = #300#0; |QBF aAlfa;
               |SI aAlfa = "";
                    #0#40 = "N"; |PINTA #0#40;
                    #0#41 = ""; |PINTA #0#41;
                    #0#42 = ""; |PINTA #0#42;
               |SINO;
                    #0#40 = "S"; |PINTA #0#40;
                    #0#41 = #300#0; |PINTA #0#41;
                    #0#42 = #300#1; |PINTA #0#42;
               |FINSI;
          |FINSI;
     |SINO;
          |PAUSA;
     |FINSI;

     |HAZ PopVenModal;
|FPRC;

|PROCESO Tipo8; |TIPO 8; ||(*)
     |ABRET #1;
|FPRC;

|PROCESO Tipo9; |TIPO 9; ||(*)
     |CIERRAT #1;
|FPRC;

|PROCESO BorraLin;
     |BUCLE BorraCara;
     |BORRA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE BorraLin;
     #1#1003;
     ;
     #0#0, #0#1, "                    ";
     #0#0, #0#1, "zzzzzzzzzzzzzzzzzzzz";
     be;
     NULL, BorraLin;
|FIN;

|PROCESO Tipo2; |TIPO 2; ||(*)
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
          |BUCLE BorraLin;
     |FINSI;
|FPRC;

|PROCESO Tipo0; |TIPO 0;     ||(*)
     |REFRESCACONTROL nGrid1;
|FPRC

|PROCESO Tipo12; |TIPO 12;    ||(*)
     || No quitar
|FPRC;

|PROCESO Tipo30; |TIPO 30;    ||(*)
     nModo = (FEntrada / 100) ! 0;

     #1#0 = #0#0;
     #1#1 = #0#1;
     #1#2 = "";
     |LEE 000#1];
     |SI FSalida ! 0; |O #1#0 ! #0#0; |O #1#1 ! #0#1;
          |SI nModo = 1;
               |MENAV "0000Se anulan los datos entrados.";
          |SINO;
               |MENAV "0000No existen lineas, se borra la cabecera.";
          |FINSI;
          |BORRA 020#0a;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO EstadoBtn;
     |ESTADO_CONTROL nBtnAlta, aEstado;
     |ESTADO_CONTROL nBtnModi, aEstado;
     |ESTADO_CONTROL nBtnBaja, aEstado;
||     |ESTADO_CONTROL nBtnCons, aEstado;
     |ESTADO_CONTROL nBtnAgrupa, aEstado;

     |SI aEstado = "ENABLE";
          |ESTADO_CONTROL nBtnExtra, "DISABLE";
          |ESTADO_CONTROL nBtnDejado, "DISABLE";
     |SINO;
          |ESTADO_CONTROL nBtnExtra, "ENABLE";
          |ESTADO_CONTROL nBtnDejado, "ENABLE";
     |FINSI;
|FPRC;

|PROCESO Tipo7; |TIPO 7;    ||(*)
     aEstado = "ENABLE";
     |HAZ EstadoBtn;
|FPRC;

|PROCESO Tipo20; |TIPO 20;    ||(*)
     |SI FSalida = "OPCION";
          aEstado = "DISABLE";
          |HAZ EstadoBtn;
          FSalida = "";
     |FINSI;
|FPRC;
--------------------Cabecera
|PROCESO Conta; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          aSerie = #0#0;
          #0#1 = 999999;
          |LEE 000#0];
          |SI FSalida = 0;
               |LEE 000#0a;
          |SINO;
               |LEE 000#0u;
          |FINSI;
          |SI FSalida = 0; |Y #0#0 = aSerie;
               nConta = #0#1 + 1;
          |SINO;
               nConta = 1;
          |FINSI;
          |DDEFECTO #0;
          #0#0 = aSerie;
          #0#1 = nConta;
     |FINSI;
|FPRC;

|PROCESO Cliente; TIPO 0;
     |ABRE #24;
     #24#0 = #0#4;
     |LEE 000#24=;
     |SI FSalida = 0;
          #0#5 = #24#2; |PINTA #0#5;
     |SINO;
          |MENAV "0000No existe c¢digo cliente...";
          |ERROR;
     |FINSI;
     |CIERRA #24;
|FPRC;

|PROCESO Sistema; |TIPO 0;
     |ABRE #3;
     #3#0 = #0#8;
     |LEE 000#3=;
     |SI FSalida = 0;
          #0#28 = #3#1; |PINTA #0#28;
     |SINO;
          |MENAV "0000No existe c¢digo sistema...";
          |ERROR;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO Tecnico; |TIPO 0;
     |ABRE #17;
     #17#0 = #0#10;
     |LEE 000#17=;
     |SI FSalida = 0;
          #0#29 = #17#1; |PINTA #0#29;
     |SINO;
          |MENAV "0000No existe c¢digo tcnico...";
          |ERROR;
     |FINSI;
     |CIERRA #17;
|FPRC;

|PROCESO Admin; |TIPO 0;
     |ABRE #24;
     #24#0 = #0#11;
     |LEE 000#24=;
     |SI FSalida = 0;
          #0#30 = #24#2; |PINTA #0#30;
     |SINO;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo administrador...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #24;
|FPRC;

|PROCESO Conte0; |TIPO 7;
     aConte = #0Campo;
|FPRC;

|PROCESO Dir0; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |ABRE #30;
     #30#0 = #0#4;
     #30#1 = #0#6;
     |LEE 000#30=;
     |SI FSalida = 0;
          |SI nModo = 1; |O aConte ! #0Campo;
               |ABRE #2;
               #2#0 = #30#0;
               #2#1 = #30#1;
               |LEE 000#2=;
               |SI FSalida ! 0; |DDEFECTO #2; |FINSI;
               |CIERRA #2;
               #0#11 = #2#2; |PINTA #0#11;
               nSw = 1;
               |HAZ Admin;
               nSw = 0;
               #0#18 = #2#4; |PINTA #0#18;
               #0#19 = #2#5;
               #0#20 = #2#6;
               #0#21 = #2#7;
               #0#22 = #2#8;
          |FINSI;
     |SINO;
          |MENAV "0000No existe direcci¢n de entrega...";
          |ERROR;
     |FINSI;
     |CIERRA #30;
|FPRC;

|PROCESO Min30;
     #30#0 = #0#4;
     #30#1 = 1;
|FPRC;

|PROCESO Max30;
     #30#0 = #0#4;
     #30#1 = 9999;
|FPRC;

|PROCESO Dir66; |TIPO 66;
     |ABRE #30;
     #30#0 = #0#4;
     #30#1 = #0#6;
     |LEE 000#30];
     |CONSULTA_F_CLAVE #1#30, Min30, Max30;
     |SI FSalida = 0;
          #0#6 = #30#1; |PINTA #0#6;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #30;
|FPRC;


|PROCESO Min4;
     #4#0 = #0#4;
     #4#1 = #0#6;
     #4#2 = "                    ";
|FPRC;

|PROCESO Max4;
     #4#0 = #0#4;
     #4#1 = #0#6;
     #4#2 = "zzzzzzzzzzzzzzzzzzzz";
|FPRC;

|PROCESO Edificio66; |TIPO 66;
     |ABRE #4;
     #4#0 = #0#4;
     #4#1 = #0#6;
     #4#2 = #0#7;
     |LEE 000#4];
     |CONSULTA_F_CLAVE #1#4, Min4, Max4;
     |SI FSalida = 0;
          #0#7 = #4#2; |PINTA #0#7;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #4;
|FPRC;
--------------------------    Lineas
|PROCESO SisteLin; |TIPO 0;
     |ABRE #3;
     #3#0 = #106#4;
     |LEE 000#3=;
     |SI FSalida = 0;
          #106#27 = #3#1; |PINTA #106#27;
     |SINO;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo sistema...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO ArtiLin; |TIPO 0;
     |ABRE #19;
     #19#0 = #106#5;
     |LEE 000#19=;
     |SI FSalida = 0;
          #106#28 = #19#1; |PINTA #106#28;
     |SINO;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo art¡culo...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #19;
|FPRC;

|PROCESO CliLin; |TIPO 0;
     |ABRE #24;
     #24#0 = #106#7;
     |LEE 000#24=;
     |SI FSalida = 0;
          #106#30 = #24#1; |PINTA #106#30;
     |SINO;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo cliente...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #24;
|FPRC;

|PROCESO ArtFac; |TIPO 0;
     |ABRE #19;
     #19#0 = #106#16;
     |LEE 000#19=;
     |SI FSalida = 0;
          #106#29 = #19#1; |PINTA #106#29;
     |SINO;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo art¡culo...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #19;
|FPRC;

|PROCESO Articulo;
     |SALVA_DATOS #11;
     |REPON_DATOS #referen@;
     |GRABA 020#referen@.n;
|FPRC;

|DEFBUCLE Articulo;
     #11#2;
     46;
     #0#4, #0#6, #0#7, #0#8, "                    ", 0;
     #0#4, #0#6, #0#7, #0#8, "zzzzzzzzzzzzzzzzzzzz", 0;
     ;
     NULL, Articulo;
|FIN;

|PROCESO NumSer66; |TIPO 66;
     |DDEF aAlfa;
     aAlfa = aAlfa + "extm0011";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |HAZ CreaTempo; |NOME_DAT #referen@#Tempo#; |DELINDEX #referen@;
          |ABRE #referen@;
          |BUCLE Articulo;
          |LEE 000#referen@.p;
          |SI FSalida = 0;
               |CONSULTA_CLAVE #1#referen@;
               |SI FSalida = 0;
                    #106#2 = #referen@#0; |PINTA #106#2;
               |SINO;
                    |ERROR;
               |FINSI;
          |SINO;
               |MENAV "0000No hay art¡culos para revisar...";
               |ERROR;
          |FINSI;
          |CIERRA #referen@;
          |HAZ BoraTempo; |DELINDEX #referen@;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;
----------------------------------------
|PROCESO Min15;
     #15#0 = #0#0;
     #15#1 = #0#1;
     #15#2 = 1;
|FPRC;

|PROCESO Max15;
     #15#0 = #0#0;
     #15#1 = #0#1;
     #15#2 = 999;
|FPRC;

|PROCESO Evt15;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#15=;
     |FINSI;
     |SI FSalida = 4;
          |HAZ BtnModiE;
     |FINSI;
|FPRC;

|PROCESO BtnExtra;
     |LEE 101#0=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |VENTANA 1001, 3198, -1, 17, "Art¡culos a facturar extra";
     |HAZ PushVenModal;

     |CONTROL_SIMPLE 0, "BOTON,{{193}}Alta", 1102, 1112, BtnAltaE;
     nBtnAltaE = FSalida;
     |CONTROL_SIMPLE 0, "BOTON,{{197}}Modificar", 1114, 1124, BtnModiE;
     nBtnModiE = FSalida;
     |CONTROL_SIMPLE 0, "BOTON,{{199}}Baja", 1126, 1136, BtnBajaE;
     nBtnBajaE = FSalida;
     |CONTROL_SIMPLE 0, "BOTON,{{155}}Consulta", 1138, 1148, BtnConsE;
     nBtnConsE = FSalida;

     |ABRE #15;
     nRango = 4 + 8 + 16 + 32;
     |LINEAL_SIMPLE #1#15, nRango, 1402, 2998, Min15, Max15, Evt15;
     nGridArt = FSalida;
     enCtrFin = nGridArt; |HAZ EsperaFin;
     |CIERRA #15;

     |LIBERA #0;
     |HAZ PopVenModal;
|FPRC;

|PROCESO Min16;
     #16#0 = #0#0;
     #16#1 = #0#1;
     #16#2 = 1;
|FPRC;

|PROCESO Max16;
     #16#0 = #0#0;
     #16#1 = #0#1;
     #16#2 = 999;
|FPRC;

|PROCESO Evt16;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#16=;
     |FINSI;
     |SI FSalida = 4;
          |HAZ BtnModiD;
     |FINSI;
|FPRC;

|PROCESO BtnDejado;
     |LEE 101#0=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |VENTANA 1001, 3198, -1, 17, "Art¡culos dejados en el cliente";
     |HAZ PushVenModal;

     |CONTROL_SIMPLE 0, "BOTON,{{193}}Alta", 1102, 1112, BtnAltaD;
     nBtnAltaD = FSalida;
     |CONTROL_SIMPLE 0, "BOTON,{{197}}Modificar", 1114, 1124, BtnModiD;
     nBtnModiD = FSalida;
     |CONTROL_SIMPLE 0, "BOTON,{{199}}Baja", 1126, 1136, BtnBajaD;
     nBtnBajaD = FSalida;
     |CONTROL_SIMPLE 0, "BOTON,{{155}}Consulta", 1138, 1148, BtnConsD;
     nBtnConsD = FSalida;

     |ABRE #16;
     nRango = 4 + 8 + 16 + 32;
     |LINEAL_SIMPLE #1#16, nRango, 1402, 2998, Min16, Max16, Evt16;
     nGridArt = FSalida;
     enCtrFin = nGridArt; |HAZ EsperaFin;
     |CIERRA #16;

     |LIBERA #0;
     |HAZ PopVenModal;
|FPRC;

|PROCESO BtnAltaE;
     nModoArt = 1;
     |HAZ EditaE;
|FPRC;

|PROCESO BtnModiE;
     |LEE 101#15=;
     |SI FSalida = 0; |Y #15#0 = #0#0; |Y #15#1 = #0#1;
          nModoArt = 2;
          |HAZ EditaE;
     |FINSI;
     |LIBERA #15;
|FPRC;

|PROCESO BtnBajaE;
     |LEE 101#15=;
     |SI FSalida = 0; |Y #15#0 = #0#0; |Y #15#1 = #0#1;
          aAlfa = "0000N¨Borrar linea:" + #15#2;
          |QBF aAlfa;
          aAlfa = aAlfa + "?";
          |CONFI aAlfa;
          |SI FSalida = 0;
               |BORRA 020#15a;
               |REFRESCACONTROL nGridArt;
          |FINSI;
     |FINSI;
     |LIBERA #15;
|FPRC;

|PROCESO BtnConsE;
     |LEE 000#15=;
     |SI FSalida = 0; |Y #15#0 = #0#0; |Y #15#1 = #0#1;
          nModoArt = 4;
          |HAZ EditaE;
     |FINSI;
|FPRC;

|PROCESO BtnAltaD;
     nModoArt = 1;
     |HAZ EditaD;
|FPRC;

|PROCESO BtnModiD;
     |LEE 101#16=;
     |SI FSalida = 0; |Y #16#0 = #0#0; |Y #16#1 = #0#1;
          nModoArt = 2;
          |HAZ EditaD;
     |FINSI;
     |LIBERA #16;
|FPRC;

|PROCESO BtnBajaD;
     |LEE 101#16=;
     |SI FSalida = 0; |Y #16#0 = #0#0; |Y #16#1 = #0#1;
          aAlfa = "0000N¨Borrar linea:" + #16#2;
          |QBF aAlfa;
          aAlfa = aAlfa + "?";
          |CONFI aAlfa;
          |SI FSalida = 0;
               |BORRA 020#16a;
               |REFRESCACONTROL nGridArt;
          |FINSI;
     |FINSI;
     |LIBERA #16;
|FPRC;

|PROCESO BtnConsD;
     |LEE 000#16=;
     |SI FSalida = 0; |Y #16#0 = #0#0; |Y #16#1 = #0#1;
          nModoArt = 4;
          |HAZ EditaD;
     |FINSI;
|FPRC;

|PROCESO Impo4; |TIPO 0;
     #104#6 = #104#4 * #104#5; |PINTA #104#6;
|FPRC;

|PROCESO Art4; |TIPO 0;
     |ABRE #19;
     #19#0 = #104#3;
     |LEE 000#19=;
     |SI FSalida = 0;
          #104#11 = #19#1; |PINTA #104#11;
     |SINO;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo de art¡culo...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #19;
|FPRC;

|PROCESO EditaE;
     |SI nModoArt = 1; |VENTANA 2601, 3198, -1, 17, "Nuevo l¡nea art¡culo extra"; |FINSI;
     |SI nModoArt = 2; |VENTANA 2601, 3198, -1, 17, "Modifica l¡nea art¡culo extra"; |FINSI;
     |SI nModoArt = 4; |VENTANA 2601, 3198, -1, 17, "Consulta l¡nea art¡culo extra"; |FINSI;
     |HAZ PushVenModal;

     |PINPA #0#104;
     |SI nModoArt = 1;
          #15#0 = #0#0;
          #15#1 = #0#1;
          #15#2 = 999;
          |LEE 000#15];
          |SI FSalida = 0;
               |LEE 000#15a;
          |SINO;
               |LEE 000#15u;
          |FINSI;
          |SI FSalida = 0; |Y #15#0 = #0#0; |Y #15#1 = #0#1;
               nLin = #15#2 + 1;
          |SINO;
               nLin = 1;
          |FINSI;
          #15#0 = #0#0;
          #15#1 = #0#1;
          #15#2 = nLin;
          |GRABA 020#15b;

          |DDEFECTO #104;
          #104#0 = #0#0;
          #104#1 = #0#1;
          #104#2 = nLin;
          #104#7 = #0#17;
     |SINO;
          |PARA i = 0; |SI i [ 10; |HACIENDO i = i + 1;
               #104i = #15i;
          |SIGUE;
     |FINSI;
     nSw = 1;
     |HAZ Art4;
     nSw = 0;
     |PINDA #0#104;
     |SI nModoArt = 1; |ENDATOS #1#104; |FINSI;
     |SI nModoArt = 2; |ENDATOS #2#104; |FINSI;
     |SI nModoArt = 4; |PAUSA; |FINSI;
     |SI FSalida = 0; |Y nModoArt ! 4;
          |PARA i = 0; |SI i [ 10; |HACIENDO i = i + 1;
               #15i = #104i;
          |SIGUE;
          |GRABA 020#15a;
          |REFRESCACONTROL nGridArt;
     |SINO;
          |SI nModoArt = 1;
               |BORRA 020#15c;
          |FINSI;
     |FINSI;
     |LIBERA #15;
     |HAZ PopVenModal;
|FPRC;

|PROCESO Art5; |TIPO 0;
     |ABRE #19;
     #19#0 = #105#3;
     |LEE 000#19=;
     |SI FSalida = 0;
          #105#8 = #19#1; |PINTA #105#8;
     |SINO;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo de art¡culo...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #19;
|FPRC;

|PROCESO EditaD;
     |SI nModoArt = 1; |VENTANA 2601, 3198, -1, 17, "Nuevo l¡nea art¡culo dejado al cliente"; |FINSI;
     |SI nModoArt = 2; |VENTANA 2601, 3198, -1, 17, "Modifica l¡nea art¡culo dejado al cliente"; |FINSI;
     |SI nModoArt = 4; |VENTANA 2601, 3198, -1, 17, "Consulta l¡nea art¡culo dejado al cliente"; |FINSI;
     |HAZ PushVenModal;

     |PINPA #0#105;
     |SI nModoArt = 1;
          #16#0 = #0#0;
          #16#1 = #0#1;
          #16#2 = 999;
          |LEE 000#16];
          |SI FSalida = 0;
               |LEE 000#16a;
          |SINO;
               |LEE 000#16u;
          |FINSI;
          |SI FSalida = 0; |Y #16#0 = #0#0; |Y #16#1 = #0#1;
               nLin = #16#2 + 1;
          |SINO;
               nLin = 1;
          |FINSI;
          #16#0 = #0#0;
          #16#1 = #0#1;
          #16#2 = nLin;
          |GRABA 020#16b;

          |DDEFECTO #105;
          #105#0 = #0#0;
          #105#1 = #0#1;
          #105#2 = nLin;
     |SINO;
          |PARA i = 0; |SI i [ 7; |HACIENDO i = i + 1;
               #105i = #16i;
          |SIGUE;
     |FINSI;
     nSw = 1;
     |HAZ Art5;
     nSw = 0;
     |PINDA #0#105;
     |SI nModoArt = 1; |ENDATOS #1#105; |FINSI;
     |SI nModoArt = 2; |ENDATOS #2#105; |FINSI;
     |SI nModoArt = 4; |PAUSA; |FINSI;
     |SI FSalida = 0; |Y nModoArt ! 4;
          |PARA i = 0; |SI i [ 7; |HACIENDO i = i + 1;
               #16i = #105i;
          |SIGUE;
          |GRABA 020#16a;
          |REFRESCACONTROL nGridArt;
     |SINO;
          |SI nModoArt = 1;
               |BORRA 020#16c;
          |FINSI;
     |FINSI;
     |LIBERA #16;
     |HAZ PopVenModal;
|FPRC;
