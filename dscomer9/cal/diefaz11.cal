|FICHEROS;
     diefaz11 #0;
     diefaz12 #1;
     dscamrec@ #600;     || Puente
     dscam044@ #644;     || Control C
     dscam045@ #645;     || Control L
     dscam003@ #603;     || Recibos Venta
     dscam004@ #604;     || Movimientos Recibos Venta
     dscamxx3@ #3;       || Recibos Venta
     dscamxx4@ #4;       || Movimientos Recibos Venta
     agifa134 #134;
     agifa084 #84;
|FIN;

|VARIABLES;
     nHay           = 0;
     nErr           = 0;
     aPath          = "";
     aPathFic       = "";
     aPathDef       = "";
     aMensa         = "";
     aDef00         = "";
     aDef44         = "";
     aDef45         = "";
     aDef03         = "";
     aDef04         = "";
     aDefx4         = "";
     aDefx3         = "";
     aSer           = "";
     aEmpre         = "";
     aAlfa          = "";
     aTipo          = "";
     Comodin        = "";
     aNumEmp        = "";
     nNumEmp        = 0;
|FIN;

|PROCESO NumEmp;
     |DFICE Comodin;
     Comodin = Comodin % -106;
     Comodin = Comodin % 0105;
     aNumEmp = Comodin;
     nNumEmp = aNumEmp;
|FPRC;

|PROCESO DescargaDef;
     |SI aDefx3 ! ""; |DESCARGA_DEF #dscamxx3@; |FINSI;
     |SI aDefx4 ! ""; |DESCARGA_DEF #dscamxx4@; |FINSI;
     |SI aDef04 ! ""; |DESCARGA_DEF #dscam004@; |FINSI;
     |SI aDef03 ! ""; |DESCARGA_DEF #dscam003@; |FINSI;
     |SI aDef45 ! ""; |DESCARGA_DEF #dscam045@; |FINSI;
     |SI aDef44 ! ""; |DESCARGA_DEF #dscam044@; |FINSI;
|FPRC;

|PROCESO CargaDef;
     nErr = 1;

     |DBASS aPath;
     aPath = aPath + "dscarter/";
     aPathDef = aPath + "def/";
     aPath = aPath + "fich/";

     aDef44 = aPathDef + "dscam044";
     |CARGA_DEF aDef44, dscam044@;
     |SI FSalida ! 0;
          aMensa = "0000Error al cargar:" + aDef44;
          |MENAV aMensa;
          aDef44 = ""; |HAZ DescargaDef;
          |ACABA;
     |FINSI;

     aDef45 = aPathDef + "dscam045";
     |CARGA_DEF aDef45, dscam045@;
     |SI FSalida ! 0;
          aMensa = "0000Error al cargar:" + aDef45;
          |MENAV aMensa;
          aDef45 = ""; |HAZ DescargaDef;
          |ACABA;
     |FINSI;

     aDef03 = aPathDef + "dscam003";
     |CARGA_DEF aDef03, dscam003@;
     |SI FSalida ! 0;
          aMensa = "0000Error al cargar:" + aDef03;
          |MENAV aMensa;
          aDef03 = ""; |HAZ DescargaDef;
          |ACABA;
     |FINSI;

     aDef04 = aPathDef + "dscam004";
     |CARGA_DEF aDef04, dscam004@;
     |SI FSalida ! 0;
          aMensa = "0000Error al cargar:" + aDef04;
          |MENAV aMensa;
          aDef04 = ""; |HAZ DescargaDef;
          |ACABA;
     |FINSI;

     aDefx4 = aPathDef + "dscam004";
     |CARGA_DEF aDefx4, dscamxx4@;
     |SI FSalida ! 0;
          aMensa = "0000Error al cargar:" + aDefx4;
          |MENAV aMensa;
          aDefx4 = ""; |HAZ DescargaDef;
          |ACABA;
     |FINSI;

     aDefx3 = aPathDef + "dscam003";
     |CARGA_DEF aDefx3, dscamxx3@;
     |SI FSalida ! 0;
          aMensa = "0000Error al cargar:" + aDefx3;
          |MENAV aMensa;
          aDefx3 = ""; |HAZ DescargaDef;
          |ACABA;
     |FINSI;

     |PATH_DAT #644 aPath;
     |PATH_DAT #645 aPath;

     nErr = 0;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Temporal;
     nHay = 1;

     #134#49 = #1#2;
     #134#0 = #1#3;
     |LEE 000#134=;
     |SI FSalida = 0;
          #1#4 = #134#2; ||Cliente
     |SINO;
          #84#48 = #1#2;
          #84#0 = #1#3;
          |LEE 000#84=;
          #1#4 = #84#3; ||Cliente
     |FINSI;

     |PRINT;
|FPRC;

|DEFBUCLE Temporal;
     #1#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Temporal;
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO dscam004;
     #1#0 = #3#40;
     #1#1 = #3#0;
     #1#2 = #3#1;
     #1#3 = #3#2;
     #1#4 = "";     ||Cli
     #1#5 = #3#6; ||Nom
     #1#6 = #3#5; ||Cta
     #1#7 = #3#64; ||Imp

     #1#8 = #4#6;||Fecha

     #603#40 = #3#41;
     |LEE 020#603=;

     #1#9 = #603#40;
     #1#10 = #603#72;
     #1#11 = #603#70;
     #1#12 = #603#71;
     #1#13 = #603#79;
     |GRABA 000#1n;
|FPRC;

|DEFBUCLE dscam004;
     #4#1002;
     6, 5;
     #3#41, 01, #0#0, "RPT";
     #3#41, 99, #0#1, "RPT";
     ;
     NULL, dscam004;
|FIN;

|PROCESO dscam003;
     |SI #3#41 ! 0;
          |BUCLE dscam004;
     |FINSI;
|FPRC;

|DEFBUCLE dscam003;
     #3#6005;
     ;
     00, #0#2, 000000, 000, " ";
     99, #0#2, 999999, 999, "z";
     ;
     NULL, dscam003;
|FIN;

|PROCESO dscam045;
     |SI #dscam045@#2 = "V";
          aEmpre = ("00000" + #dscam045@#6) % -105;
          aPathFic = aPath + aEmpre + "/";

          |PATH_DAT #603 aPathFic;
          |PATH_DAT #604 aPathFic;
          |PATH_DAT #4 aPathFic;
          |PATH_DAT #3 aPathFic;
          |ABRE #603;
          |BUCLE dscam003;
          |CIERRA #603;
     |FINSI;
|FPRC;

|DEFBUCLE dscam045;
     #dscam045@#1002;
     ;
     nNumEmp, 001;
     nNumEmp, 999;
     ;
     NULL, dscam045;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     aAlfa = Usuario; |QBF aAlfa;
     |NOME_DAT #1 aAlfa;
     |DELINDEX #1;

     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "diefaz11";
          |SI FSalida = 0;
               |HAZ NumEmp;
               |HAZ CargaDef;
               |SI nErr = 0;
                    |ABRE #1;
                    |BUCLE dscam045;
                    |CIERRA #1;

                    |ABRE #84;
                    |ABRE #134;
                    |BUCLE Temporal;
                    |CIERRA #134;
                    |CIERRA #84;

                    |HAZ DescargaDef;
               |FINSI;
               |SI nHay ! 0; |PIEINF; |FINSI;
               |FININF;
          |SINO;
               |MENAV "0000Falta informe 'diefaz11'";
          |FINSI;
          |FINIMP;
     |FINSI;

     |DELINDEX #1;
|FPRC;
