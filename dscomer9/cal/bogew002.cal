     || Impresion confirmacion recogida/entgrega

|FICHEROS;
     bogew023 #23,MANTE;
     bogew024 #24,MANTE;
     bogem030 #30;

     bogem005 #5;
     bogem009 #9;

     bogez006@;

     dsm00081 #81;
     dsm00082 #82;

     agifa219 #219;
     agifa220 #220;

     agifa112 #112;
|FIN;

|VARIABLES;
     &enReferencia = 0;
     &enTipo = 0;
     aInfConRec = "bconfrec";
     aInfConEnt = "bconfent";
     aAlfa = "";
     aTmp23 = "";
     aTmp24 = "";
     &eaTmp60 = "";
     &Tempo = "";
     nReferen = 0;
     nNume = 0;
     nMarca = 0;
     nPrime = 0;
     aDire = "";
     aProve = "";
     aClie = "";
|FIN;

|PROCESO DACom;
     enTipo = 3;
     |PRINT;
|FPRC;

|PROCESO Tmp23;
     |SI #23#6 ! "*";
          |ACABA;
     |FINSI;
     |SI nPrime = 0;
          nPrime = 1;
     |SINO;
          |SI aProve ! #23#4; |O aDire ! #23#7;
               |PIEINF;
          |FINSI;
     |FINSI;
     aProve = #23#4;
     aDire = #23#7;

     #5#0 = #23#0;
     #5#25 = #23#1;
     |LEE 020#5=;
     |SI FSalida = 0;
          |DDEFECTO #112;
          #112#0 = #5#5;
          |LEE 000#112.=;

          enTipo = 0; |PRINT;
          |SI #5#19 ! 0; enTipo = 1; |PRINT; |FINSI;
          |SI #5#20 ! 0; enTipo = 2; |PRINT; |FINSI;

          #81#0 = #5#15;
          |LEE 000#81=;
          |SI FSalida = 0; |Y #81#2 = "S";
               |BUCLELIN 2 DACom #81;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE Tmp23;
     #23#2;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp23;
|FIN;

|PROCESO LlenaTmp23;
     |DDEFECTO #23;
     #23#0 = #5#0;
     #23#1 = #5#25;
     #23#2 = #5#35;
     #23#3 = #5#36;
     #23#4 = #5#2;
     #23#5 = #5#3;
     #23#7 = #5#8;
     |GRABA 020#23n;
|FPRC;

|DEFBUCLE LlenaTmp23;
     #5#1;
     ;
     nReferen, nNume;
     nReferen, nNume;
     ;
     NULL, LlenaTmp23;
|FIN;

|PROCESO Referen60_1;
     nReferen = #bogez006@#0;
     nNume = #bogez006@#9;
     |BUCLE LlenaTmp23;
|FPRC;

|DEFBUCLE Referen60_1;
     #bogez006@#1002;
     ;
     enReferencia, 001;
     enReferencia, 999;
     ;
     NULL, Referen60_1;
|FIN;

|PROCESO Marca23; |TIPO 0;
     |SI #23Campo = Contenido; |Y FSalida = 0;
          |SI #23#6 = "*";
               #23#6 = "";
               nMarca = nMarca - 1;
          |SINO;
               #23#6 = "*";
               nMarca = nMarca + 1;
          |FINSI;
          |GRABA 020#23a;
     |FINSI;
|FPRC;

|PROCESO MinImp23;
     #23#0 = 0000000;
     #23#1 = 001;
|FPRC;

|PROCESO MaxImp23;
     #23#0 = 9999999;
     #23#1 = 999;
|FPRC;

|PROCESO ImpConRec;
     |HAZ CreaTempo; aTmp23 = Tempo;
     |NOME_DAT #23#aTmp23#; |DELINDEX #23;

     |DDEF aAlfa;
     aAlfa = aAlfa + "bogez006";
     |CARGA_DEF aAlfa, bogez006@;
     |SI FSalida = 0;
          |NOME_DAT #bogez006@#eaTmp60#;
          |ABRE #23;
          |BUCLE Referen60_1;
          |CIERRA #23;
          |DESCARGA_DEF #bogez006@;
     |FINSI;

     nMarca = 0;
     |ENTLINEAL #1#23, 1, 4, 22, 1, MinImp23, MaxImp23;

     |SI nMarca > 0;
          Impresora = "Crystal Reports";
          |IMPRE 0;
          |SI FSalida = 0;
               aInfConRec = #30#1; |QBF aInfConRec;
               |INFOR aInfConRec;
               |SI FSalida ! 0;
                    aAlfa = "0000Error en informe:" + aInfConRec;
                    |MENAV aAlfa;
               |SINO;
                    nPrime = 0;
                    |ABRE #81;
                    |ABRE #5;
                    |ABRE #112;
                    |BUCLE Tmp23;
                    |CIERRA #112;
                    |CIERRA #5;
                    |CIERRA #81;
                    |SI nPrime ! 0; |PIEINF; |FINSI;
                    |FININF;
               |FINSI;
               |FINIMP;
          |FINSI;
     |FINSI;

     Tempo = aTmp23; |HAZ BoraTempo;
     |DELINDEX #23;
|FPRC;
--------------------------------------------------------
|PROCESO DAVta;
     enTipo = 3;
     |PRINT;
|FPRC;

|PROCESO Tmp24;
     |SI #24#6 ! "*";
          |ACABA;
     |FINSI;

     |SI nPrime = 0;
          nPrime = 1;
     |SINO;
          |SI aClie ! #24#4; |O aDire ! #24#7;
               |PIEINF;
          |FINSI;
     |FINSI;
     aClie = #24#4;
     aDire = #24#7;

     #9#0 = #24#0;
     #9#25 = #24#1;
     |LEE 020#9=;
     |SI FSalida = 0;
          |DDEFECTO #112;
          #112#0 = #9#5;
          |LEE 000#112.=;

          enTipo = 0; |PRINT;
          |SI #9#19 ! 0; enTipo = 1; |PRINT; |FINSI;
          |SI #9#20 ! 0; enTipo = 2; |PRINT; |FINSI;

          #219#0 = #9#15;
          |LEE 000#219=;
          |SI FSalida = 0; |Y #219#2 = "S";
               |BUCLELIN 2 DAVta #219;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE Tmp24;
     #24#2;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp24;
|FIN;

|PROCESO LlenaTmp24;
     |DDEFECTO #24;
     #24#0 = #9#0;
     #24#1 = #9#25;
     #24#2 = #9#35;
     #24#3 = #9#36;
     #24#4 = #9#2;
     #24#5 = #9#3;
     #24#7 = #9#8;
     |GRABA 020#24n;
|FPRC;

|DEFBUCLE LlenaTmp24;
     #9#1;
     ;
     nReferen, nNume;
     nReferen, nNume;
     ;
     NULL, LlenaTmp24;
|FIN;

|PROCESO Referen60_2;
     nReferen = #bogez006@#0;
     nNume = #bogez006@#9;
     |BUCLE LlenaTmp24;
|FPRC;

|DEFBUCLE Referen60_2;
     #bogez006@#1002;
     ;
     enReferencia, 001;
     enReferencia, 999;
     ;
     NULL, Referen60_2;
|FIN;

|PROCESO Marca24; |TIPO 0;
     |SI #24Campo = Contenido; |Y FSalida = 0;
          |SI #24#6 = "*";
               #24#6 = "";
               nMarca = nMarca - 1;
          |SINO;
               #24#6 = "*";
               nMarca = nMarca + 1;
          |FINSI;
          |GRABA 020#24a;
     |FINSI;
|FPRC;

|PROCESO MinImp24;
     #24#0 = 0000000;
     #24#1 = 001;
|FPRC;

|PROCESO MaxImp24;
     #24#0 = 9999999;
     #24#1 = 999;
|FPRC;

|PROCESO ImpConEnt;
     |HAZ CreaTempo; aTmp24 = Tempo;
     |NOME_DAT #24#aTmp24#; |DELINDEX #24;

     |DDEF aAlfa;
     aAlfa = aAlfa + "bogez006";
     |CARGA_DEF aAlfa, bogez006@;
     |SI FSalida = 0;
          |NOME_DAT #bogez006@#eaTmp60#;
          |ABRE #24;
          |BUCLE Referen60_2;
          |CIERRA #24;
          |DESCARGA_DEF #bogez006@;
     |FINSI;

     nMarca = 0;
     |ENTLINEAL #1#24, 1, 4, 22, 1, MinImp24, MaxImp24;

     |SI nMarca > 0;
          Impresora = "Crystal Reports";
          |IMPRE 0;
          |SI FSalida = 0;
               aInfConEnt = #30#4; |QBF aInfConEnt;
               |INFOR aInfConEnt;
               |SI FSalida ! 0;
                    aAlfa = "0000Error en informe:" + aInfConEnt;
                    |MENAV aAlfa;
               |SINO;
                    nPrime = 0;
                    |ABRE #219;
                    |ABRE #9;
                    |ABRE #112;
                    |BUCLE Tmp24;
                    |CIERRA #112;
                    |CIERRA #9;
                    |CIERRA #219;
                    |SI nPrime ! 0; |PIEINF; |FINSI;
                    |FININF;
               |FINSI;
               |FINIMP;
          |FINSI;
     |FINSI;

     Tempo = aTmp24; |HAZ BoraTempo;
     |DELINDEX #24;
|FPRC;

|PROGRAMA;
     |ABRE #30; |LEE 000#30p; |CIERRA #30;
     |SI PARAMETRO = "RECOGE";
          |HAZ ImpConRec;
     |SINO;
          |HAZ ImpConEnt;
     |FINSI;
|FPRO;
