|FICHEROS;
     agifa014 #0;
     tmp00010 #1;
     tmp00071 #2;
     agifa024 #3;
     agifa104 #8;
     agifa010 #11;
     agifa071 #12;
     agifa038 #13;
     agifa048 #15;
     agifa049 #16;
     agifa019 #19;
     dsm00024 #24;
     agifa007 #40;
     agifa142 #41;
     agi00002 #43;  || Fichero de trabajos;
     agi00003 #44;
     dsm00047 #47;
     dsm00053 #53;
     agifa112 #112;
     agifa134 #134;
     agifa321 #321;
     agifa324 #324;
     agi00101 #100;
     dsm00109 #109;
     tmp00000 #300; || Temporal de albaranes que se imprimen
     dsm00010 #910;
     tmpdsm05 #905;
     dsm00005 #1905;

     malpe091@ #91;
     tagm0056@ #500;
     tlfm0001@ #101;
     tlfm0002@ #102;
     &marhu355@ #200;
     tmp00071@;
     aser0001@;
     refere1@;
     refere2@;
     refere3@;
     dsm00225 #225;
     dsm00156 #156;
|FIN;

|INCLUYE i_varart;

|VARIABLES;
     nSwFergaPrime = 0;
     nSwSanchez = 0;
     nSalida    = 0;

     &eaEnvaPdte = "";
     nSwChampiEmar = 0;
     &eaDefERP = "";
     &eaSerieDocERP = "";
     &eaNumDocERP = "";

     aMensaje = "";
     &enImpVallcorba = 0;     || a 1 cuando llama vallcm03
     &enSwVallcorba = 0;
     &eaTmpExtintor = "";
     nSwExtintor = 0;
     nSwFergalsan = 0;
     &enSwMatadero = 0;
     ||&enNumero = 0;
     &enPeso = 0;
     nSwMataMan = 0;
     nLin = 0;
     &enSwDes = 0;
     &enLin1 = 0;
     &enLin2 = 0;
     nSwLegiplag = 0;
     &eaSerAlbaCer = "";
     &enNumAlbaCer = 0;

     &enSwEvaDes = 0;
     &eaEvaCB = "";
     nSwEvaristo = 0;
     &eaImpElige = "";
     &enRucoLin = 0;
     nSwRucomar = 0;
     &PRMNT_Imp = "";
     &eaArtIdioma = "";
     &eaCodArtIdioma = "";

     &enPagina = 0; &eaItem = "";  ||Para Tagloma
     &eaImpre014 = "";
     &eaReimp = "";
     &enErrorImp = 0;
     &eaSerAviso = "";
     &enNumAviso = 0;
     &enInforpConfi = -1;   || 000gui
     &nSwInforAlba = "";
     &XVAR_DC_IMPRIME = 0;
     nCopias = 0;
     &eaMortero = ""; ||Modulo Malpesa
     aEsEstandar = "";
     nSwDiagram = 0;
     &enBulto = 0; || Modulo Orts
     &enCntrl = 0;
     nSwOrts = 0;

     nSwSebaLopez = 0; || Modulo 004032
     &eaSLenvase = ""; &eaSLdesenv = ""; &enSLbruto = 0;
     &enSLnumenv = 0; &enSLtara = 0; &enSLneto = 0;
     nSwSematel = 0;
     &eaIMEI      = "";
     &eaABO       = "";
     &eaICC       = "";
     &enSwIMEI    = 0;

     &enBogeRefe = 0;
     &enBogeAlba = 0;
     &enBogeLin = 0;

     nSwMecanogra = 0;
     nNume = 0;
     nSwFriesa = 0;
     nPrecio = 0;
     nPrecioD = 0;
     nTotal = 0;
     nTotalD = 0;
     aEsPostFormaso = "N";
     aPreguntaMenu = "";
     &eaSerieTa = "";
     &enCodigTa = 0;
     &eaMenuImpre = "";
     &enNumero = 0;

     &enAlbaUniBase = 0;
     &enAlbaUniPromo = 0;
     &enAlbaUniTotal = 0;
     &enAlbaImpDto = 0;
     &enAlbaPunVerde = 0;
     &eaAlbaEnvase = "";

     &eaFicTmpCab = "";
     &eaFicTmpLin = "";
     aDef = "";
     nSwBaeza = 0;
     nSwAlbadis = 0;
     nSwAsertis = 0;
     nSwPCEGroup = 0;
     &enSinMenuImpAV = 0;
     &enCliArt = 0;
     nSwTagloma = 0;
     &eaImpresora = "";
     &eaDefImpre = "";
     nLinV = 0;
     &eaDoc = "";
     nSwPackList = 0;
     aPath = "";
     nSwMarhuenda = 0;
     nEncuentra = 0;
     nCampos = 0;
     i = 0;
     nSwMalpesa   = 0;
     &eaDSer      = "";
     &eaASer      = "";
     &enDNum      = 0;
     &enANum      = 0;

     &eaLote      = "";
     &swmarhu062  = 0;
     &Tempo       = "";
     aTempo1      = "";
     aTempo2      = "";
     aTempo3      = "";
     aDRei        = "";
     aHRei        = "";
     aAlfa        = "";
     aAlf1        = "";
     &aDivisa     = "";
     &aMoneda     = "";
     &enEscan    = 0;
     &aQuelis     = "";
     &enImpo      = 0;
     nSwPasa      = 0;
     &enCodig     = 0;
     &eaNArticulo = "";
     &eaFichAlba  = "";
     &enPantalla  = 0;
     &enNPedido   = 0;

     &trabajo  = 0;
     &ser_alb  = "";
     &num_alb  = 0;
     &codigo   = "";
     &descrip  = "";
     &supedino = "";
     &bl       = "                              ";
     &abono    = "N";  || Viene de agifa010

     mes        = 0;
     margen     = 0;
     imneto     = 0;
     aAlfa1     = "";
     aAlfa2     = "";
     nCampo     = 0;
     nSw010     = 0;
     aFichero   = "";
     aParametro = "";

     nSwOpcion = 0;
     desde     = "                              ";
     hasta     = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     informe   = "";
     &informe1 = "";
     vacio     = "";
     digito    = "";

     &ascii    = 0;
     &impal    = 0;
     &impor    = 0;
     &iva1     = 0;
     &iva2     = 0;
     &iva3     = 0;
     &iva4     = 0;
     &iva5     = 0;
     &re1      = 0;
     &re2      = 0;
     &re3      = 0;
     &re4      = 0;
     &re5      = 0;
     &precio   = 0;
     &dto      = 0;
     &dto1     = 0;
     &unid     = 0;
     &imptot   = 0;
     &tiva     = 0;
     &linea    = 0;
     &palets   = 0;
     indtope   = 0;
     ind       = 0;
     &n_copia   = 0;

     &dtrab    = "";
     &swt      = 0;

{-1} MenuImpre   = "";
     MenuImpre1  = "1021";
     MenuImpre2  = "1";
     MenuImpre3  = "7";
     MenuImpre4  = "Salir                    ";
     MenuImpre5  = "Albaran                  ";
     MenuImpre6  = "Albaran Agencia          ";
     MenuImpre7  = "Etiquetas Agencia        ";
     MenuImpre8  = "Pdte.Servir Parcialmente ";
     MenuImpre9  = "Pdte.Servir Completamente";
     MenuImpre10 = "Pdte.Servir Ambos        ";
     MenuImpre11 = "";

     &sobre = "";

     &nSwDefecto  = 0; || Para Descripcion Ampli

     nImpDiv      = 0;
     nMult        = 0;

     &nDeci_Base     = 0;   || Decimales en Totales de la moneda base
     &nDeci_PreBase  = 0;   || Decimales en el Precio en moneda base
     &nDeci_BaseMx   = 0;   || Decimales en Totales de la moneda base (Maxima precision)
     &nDeci_PreBaseMx= 0;   || Decimales en el Precio en moneda base (Maxima precision)
     &nDeci_Div      = 0;   || Decimales en Totales de la divisa
     &nDeci_PreDiv   = 0;   || Decimales en el Precio en divisa
     &nDeci_TotVis   = 0;   || Decimales en Totales visibles (el de la moneda de trabajo)
     &nDeci_TotNoVis = 0;   || Decimales en Totales no visibles (el de la otra moneda)
     &nDeci_PreVis   = 0;   || Decimales en el Precio visual. (lineas)
     &nDeci_ImpVis   = 0;   || Decimales en el Importe visual. (lineas)
     &decim_divisa = 0;  || Decimales de la divisa
     &precio_divisa = 0; || Decimales del precio en divisa
     &decim_base = 0;    || Decimales de la moneda base
     &precio_base = 0;   || Decimales del precio en moneda base

     &enDesdeX    = 0;
     nPreTon = 0;
     aTmp300 = "";
     nSwVigor = 0;
     nSwAparecida = 0;
     nSwCoimasa = 0;
     nSwQDClor = 0;
     aArti = "";
     || grupo para crystal
     &enContaLin = 0;
     &enGrupo = 0;
     &enLineas = 0;
     nDiv = 0;
|FIN;
/*
 El proceso &Grupo se llama desde el informe, en este hay que definir
 las variables: &enContaLin, &enGrupo y &enLineas
 en la primera linea del inf en el F8 se asigna enLineas=10 (numero lineas por copia)
 y en el detalle se hace la llamada a Grupo, este retorna enGrupo que se
 asigna a una variable y se pinta en el inf, esta sera el campo a vincular el subinforme
 ver jduro.inf/rpt.
 Esto se ha realizado para el cliente 5541 comentarlo con Sergio
*/
|PROCESO &Grupo;
     nDiv = enContaLin / enLineas;
     enGrupo = nDiv ! 0;
     |SI enGrupo > nDiv;
          enGrupo = enGrupo - 1;
     |FINSI;
     enContaLin = enContaLin + 1;
|FPRC;


|PROCESO IdiomaArticulo;
     aAlfa = "";
     |ABRE #225;
     #225#0 = #3#205;
     |LEE 000#225=;
     |SI FSalida = 0;
          |ABRE #156;
          #156#0 = aArti;
          #156#1 = #225#5;
          |LEE 000#156=;
          |SI FSalida = 0;
               aAlfa = #156#2; |QBF aAlfa;
          |FINSI;
          |CIERRA #156;
     |FINSI;
     |CIERRA #225;
|FPRC;

|PROCESO LeePrv;
     |DDEFECTO #112;
     |ABRE #24;
     #24#0 = #2#2;
     #24#1 = #2#3;
     #24#2 = #2#49;
     |LEE 000#24=;
     |SI FSalida = 0;
          |ABRE #112;
          #112#0 = #24#3;
          |LEE 000#112=;
          |CIERRA #112;
     |FINSI;
     |CIERRA #24;
|FPRC;

|PROCESO AuxiMata;
     |DDEF aAlfa;
     aAlfa = aAlfa + "matade01";
     |CARGA_DEF aAlfa, refere1@;
     |SI FSalida = 0;
          enSwMatadero = 1;
          |ABRE #refere1@;
          #refere1@#0 = #2#29;
          #refere1@#1 = #2#0;
          #refere1@#2 = #2#1;
          #refere1@#3 = 0;
          |LEE 000#refere1@.];
          |PARA; |SI FSalida = 0; |Y #refere1@#0 = #2#29;
                    |Y #refere1@#1 = #2#0; |Y #refere1@#2 = #2#1; |HACIENDO;
               enNumero = #refere1@#3;
               enPeso = #refere1@#4;
               |PRINT;
               |LEE 000#refere1@.s;
          |SIGUE;
          enSwMatadero = 0;
          |CIERRA #refere1@;
          |DESCARGA_DEF #refere1@;
     |FINSI;
|FPRC;

|PROCESO EvaristoImp;
     |DDEF aAlfa;
     aAlfa = aAlfa + "evarm022";
     |CARGA_DEF aAlfa, refere1@;
     |SI FSalida = 0;
          enSwEvaDes = 1;
          |ABRE #refere1@;
          #refere1@#0 = #2#29;
          #refere1@#1 = #2#0;
          #refere1@#2 = #2#1;
          #refere1@#13 = "";
          |LEE 000#refere1@.];
          |PARA; |SI FSalida = 0; |Y #refere1@#0 = #2#29;
                    |Y #refere1@#1 = #2#0; |Y #refere1@#2 = #2#1; |HACIENDO;
               eaEvaCB = #refere1@#13;
               |PRINT;
               |LEE 000#refere1@.s;
          |SIGUE;
          enSwEvaDes = 0;
          |CIERRA #refere1@;
          |DESCARGA_DEF #refere1@;
     |FINSI;
|FPRC;

|PROCESO &SerItem; || Lo llama el informe de tagloma;
     |SI nSwTagloma = 0;
          aAlfa = ("00" + enPagina) % -102;
          aAlfa = "tagz0022;" + #1#52 + (("000000" + #1#0) % -106) + "DIGI" + enPagina;
          |SUB_EJECUTA_NP aAlfa; || retorna &eaItem
     |FINSI;
|FPRC;

|PROCESO SacaAviso;
     |DDEF aAlfa;
     aAlfa = aAlfa + "ialbm023";
     |CARGA_DEF aAlfa, refere1@;
     |SI FSalida = 0;
          |DDEFECTO #refere1@;
          |ABRE #refere1@;
          |SELECT #2#refere1@;
          #refere1@#2 = #1#52;
          #refere1@#3 = #1#0;
          |LEE 000#refere1@.=;
          |CIERRA #refere1@;

          eaSerAviso = #refere1@#0;
          enNumAviso = #refere1@#1;
          |DESCARGA_DEF #refere1@;
     |FINSI;
|FPRC;

|PROCESO EtiInforAlba;
     |PUSHV 0101 2380;
     |SUB_EJECUTA_NP "ialbz023";
     |POPV;
|FPRC;

|PROCESO BogeVariVta;     || Esto no vale, se imprime siempre por el modulo
     |DDEF aAlfa;
     aAlfa = aAlfa + "bogem027";
     |CARGA_DEF aAlfa, refere1@;
     |SI FSalida = 0;
          |ABRE #refere1@;
          |SELECT #2#refere1@;
          #refere1@#20 = #1#52;
          #refere1@#21 = #1#0;
          |LEE 000#refere1@.=;
          |SI FSalida = 0;
               enBogeRefe = #refere1@#0;
               enBogeAlba = #refere1@#19;
               enBogeLin = #2#1/3; || Multiplo de 3
               nNume = enBogeLin ! 0;
               |SI nNume ! enBogeLin; enBogeLin = enBogeLin + 1; |FINSI;
          |FINSI;
          |CIERRA #refere1@;

          |DESCARGA_DEF #refere1@;
     |FINSI;
|FPRC;

|PROCESO TagPostFormado;
     aEsPostFormaso = "N";
     |DDEF aAlfa;
     aAlfa = aAlfa + "tagm0056";
     |CARGA_DEF aAlfa, tagm0056@;
     |SI FSalida = 0;
          |ABRE #tagm0056@;
          |SI #2#12 ! 0;      ||De pedido
               #tagm0056@#0 = "PV";
               #tagm0056@#1 = #2#31;
               #tagm0056@#2 = #2#12;
               #tagm0056@#3 = #2#21;
               |LEE 000#tagm0056@.=;
               |SI FSalida = 0;
                    descrip = #2#4;
                    nTotal = #2#9;
                    nTotalD = #2#37;
                    |SALVA_FICHA #2;
                    |SELECT #4#2;
                    #2#31 = #tagm0056@#1;
                    #2#12 = #tagm0056@#2;
                    #2#21 = #tagm0056@#5;
                    |LEE 000#2=;
                    |SI FSalida = 0;
                         nTotal = nTotal + #2#9;
                         nTotalD = nTotalD + #2#37;
                         nPrecio = #2#6;
                         nPrecioD = #2#36;
                    |FINSI;
                    |SELECT #1#2;
                    |REPON_FICHA #2;
                    |SI #19#194 = 2;
                         nPrecio = nPrecio + (#2#6 * #2#48 / #2#5);
                         nPrecioD = nPrecioD + (#2#36 * #2#48 / #2#5);
                    |SINO;
                         nPrecio = nPrecio + #2#6;
                         nPrecioD = nPrecioD + #2#36;
                    |FINSI;
                    #2#4 = descrip;
                    #2#6 = nPrecio;
                    #2#36 = nPrecioD;
                    #2#9 = nTotal;
                    #2#37 = nTotalD;
                    precio = #2#6;

                    #12#6 = #2#6;
                    #12#36 = #2#36;
                    #12#9 = #2#9;
                    #12#37 = #2#37;
               |SINO;
                    |SELECT #2#tagm0056@;
                    #tagm0056@#5 = #2#21;
                    |LEE 000#tagm0056@.=;
                    |SI FSalida = 0;
                         aEsPostFormaso = "S";
                    |FINSI;
               |FINSI;
          |SINO;              ||Normal (sin pedido)
               #tagm0056@#0 = "AV";
               #tagm0056@#1 = #2#29;
               #tagm0056@#2 = #2#0;
               #tagm0056@#3 = #2#1;
               |LEE 000#tagm0056@.=;
               |SI FSalida = 0;
                    descrip = #2#4;
                    nTotal = #2#9;
                    nTotalD = #2#37;
                    |SALVA_FICHA #2;
                    #2#1 = #tagm0056@#5;
                    |LEE 000#2=;
                    |SI FSalida = 0;
                         nTotal = nTotal + #2#9;
                         nTotalD = nTotalD + #2#37;
                         nPrecio = #2#6;
                         nPrecioD = #2#36;
                    |FINSI;
                    |REPON_FICHA #2;
                    |SI #19#194 = 2;
                         nPrecio = nPrecio + (#2#6 * #2#48 / #2#5);
                         nPrecioD = nPrecioD + (#2#36 * #2#48 / #2#5);
                    |SINO;
                         nPrecio = nPrecio + #2#6;
                         nPrecioD = nPrecioD + #2#36;
                    |FINSI;
                    #2#4 = descrip;
                    #2#6 = nPrecio;
                    #2#36 = nPrecio;
                    #2#9 = nTotal;
                    #2#37 = nTotalD;
                    precio = #2#6;

                    #12#6 = #2#6;
                    #12#36 = #2#36;
                    #12#9 = #2#9;
                    #12#37 = #2#37;
               |SINO;
                    |SELECT #2#tagm0056@;
                    #tagm0056@#5 = #2#1;
                    |LEE 000#tagm0056@.=;
                    |SI FSalida = 0;
                         aEsPostFormaso = "S";
                    |FINSI;
               |FINSI;
          |FINSI;
          |CIERRA #tagm0056@;
          |DESCARGA_DEF #tagm0056@;
     |FINSI;
|FPRC;

|PROCESO AsertiMarca;
     |DDEF aDef;
     aDef = aDef + "aser0001";
     |CARGA_DEF aDef, aser0001@;
     |SI FSalida = 0;
          |ABRE #aser0001@;
          #aser0001@#0 = #1#52;
          #aser0001@#1 = #1#0;
          |LEE 000#aser0001@.=;
          |SI FSalida = 0;
               #aser0001@#44 = "S";
               |GRABA 020#aser0001@.a;
          |FINSI;
          |CIERRA #aser0001@;
          |DESCARGA_DEF #aser0001@;
     |FINSI;
|FPRC;

컴컴컴컴컴컴컴컴컴컴컴컴컴Agrupacion Articulos Malpesa
|PROCESO AgrupadorMalpe;
     #19#0 = #tmp00071@#2;
     |LEE 000#19=;
     |SI FSalida = 0; |Y #19#181 = "S";
          eaMortero = "S";
     |FINSI;

     |DDEFECTO #91;
     #91#29 = #tmp00071@#29;
     #91#0 = #tmp00071@#0;
     #91#1 = #tmp00071@#1;
     |LEE 000#91=;

     nEncuentra = 0;
     |LEE 101#2p;
     |PARA; |SI FSalida = 0; |HACIENDO;
           |SI #2#2=#tmp00071@#2; |Y #2#6=#tmp00071@#6; |Y #2#8=#tmp00071@#8;
               nEncuentra = 1; |SAL;
           |FINSI;
           |LEE 101#2s;
     |SIGUE;
     |SI nEncuentra = 1;
          #2#5 = #2#5 + #tmp00071@#5;   ||Unidades
          #2#7 = #2#7 + #tmp00071@#7;   ||Impo
          #2#9 = #2#9 + #tmp00071@#9;   ||Total
          #2#37 = #2#37 + #tmp00071@#37;||Total Div
          #2#35 = #2#35 + #91#62;       ||Palets = Unidades a Convertir
          |GRABA 020#2a;
     |SINO;
          aAlfa = "|NC"; aAlfa = #2#aAlfa#;
          nCampos = aAlfa; nCampos = nCampos - 1;
          |PARA i = 0; |SI i [ nCampos; |HACIENDO i = i + 1;
               #2i = #tmp00071@#i#;
          |SIGUE;
          #2#35 = #91#62;     ||Palets = Unidades a Convertir
          |GRABA 020#2n;
     |FINSI;
|FPRC;

|PROCESO AgrupadorSanchez;
     nSalida = 1;
     |LEE 000#2p;
     |PARA; |SI FSalida = 0; |HACIENDO;
          |SI #2#2 = #tmp00071@#2; |Y #2#51 = #tmp00071@#51; |Y #tmp00071@#51!0;
               nSalida = 0; |SAL;
          |FINSI;
          |LEE 000#2s;
     |SIGUE;
     |SI nSalida = 0;
          #2#6 = #2#6 + #tmp00071@#6;   ||Precio
          #2#7 = #2#7 + #tmp00071@#7;   ||Impo
          #2#9 = #2#9 + #tmp00071@#9;   ||Total
          #2#36 = #2#36 + #tmp00071@#36;||Precio Div
          #2#37 = #2#37 + #tmp00071@#37;||Total Div
          |GRABA 020#2a;
     |SINO;
          aAlfa = "|NC"; aAlfa = #2#aAlfa#;
          nCampos = aAlfa; nCampos = nCampos - 1;
          |PARA i = 0; |SI i [ nCampos; |HACIENDO i = i + 1;
               #2i = #tmp00071@#i#;
          |SIGUE;
          |GRABA 020#2n;
     |FINSI;
|FPRC;

|PROCESO Agrupador;
     |SI nSwMalpesa = 0;
         |HAZ AgrupadorMalpe;
     |FINSI;

     |SI nSwSanchez = 0;
         |HAZ AgrupadorSanchez;
     |FINSI;
|FPRC;

|DEFBUCLE Agrupador;
     #tmp00071@#1003;
     ;
     #1#52, #1#0, 001;
     #1#52, #1#0, 999;
     ;
     NULL, Agrupador;
|FIN;

|PROCESO AgruArtiIni;
     |DDEF aPath;
     aAlfa = aPath + "tmp00071";
     |CARGA_DEF aAlfa, tmp00071@;
     |SI nSwMalpesa = 0;  nSwMalpesa = FSalida;  |FINSI;
     |SI nSwSanchez = 0;  nSwSanchez = FSalida;  |FINSI;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SI nSwMalpesa = 0;
         aAlfa = aPath + "malpe091";
         |CARGA_DEF aAlfa, malpe091@;
         |SI FSalida = 0;
             aAlfa = Usuario;
             |NOME_DAT #2 aAlfa;
             |DELINDEX #2;

             eaMortero = "N";
             |ABRE #91;
             |ABRE #2;
             |ABRE #19;
             |BUCLE Agrupador;
             |CIERRA #19;
             |CIERRA #2;
             |CIERRA #91;
             |DESCARGA_DEF #malpe091@;
         |FINSI;
     |FINSI;

     |SI nSwSanchez = 0;
         aAlfa = Usuario;
         |NOME_DAT #2 aAlfa;
         |NOME_DAT #12 aAlfa;
         |DELINDEX #2;
         |ABRE #2;
         |BUCLE Agrupador;
         |CIERRA #2;
     |FINSI;
|FPRC;

|PROCESO AgruArtiFin;
     |DESCARGA_DEF #tmp00071@;
     |DELINDEX #2;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Param_Divisas14; |TIPO 0;
     |ABRE #agifa321;
     |LEE 001#agifa321.p;   || Leo la divisa
     |CIERRA #agifa321;

     |ABRE #agifa324;
     #agifa324#0 = #tmp00010#68;
     |LEE 001#agifa324.=;   || Leo la divisa
     |CIERRA #agifa324;

     decim_divisa = #agifa324#7;  || Decimales de la divisa
     precio_divisa = #agifa324#9;  || Decimales en el precio de la divisa
     nDeci_Div = decim_divisa;   || Decimales de la divisa
     nDeci_PreDiv = precio_divisa;  || Decimales en el precio de la divisa
     |SI #tmp00010#70 = "B";   || Si trabajo con la moneda base ...
          nDeci_PreVis   = precio_divisa;
          nDeci_ImpVis   = decim_divisa;
          nDeci_Base     = decim_base;
          nDeci_PreBase  = precio_base;
          nDeci_BaseMx  = decim_base;
          nDeci_PreBaseMx = precio_base;
          nDeci_TotVis   = decim_base;
          nDeci_TotNoVis = decim_divisa;
     |SINO;     || Si trabajo con la divisa ...
          nDeci_PreVis   = precio_base;
          nDeci_ImpVis   = decim_base;
          nDeci_Base     = decim_base; || Max. precision en los decimales de la moneda base
          nDeci_PreBase  = precio_base;  || Max. precision en los dec. del precio de la moneda base
          |SI #tmp00010#69 = 1;
               nDeci_BaseMx    = decim_base;    || sin triangulacion
               nDeci_PreBaseMx = precio_base;
          |SINO;
               nDeci_BaseMx    = #agifa321#10;  || con triangulacion
               nDeci_PreBaseMx = #agifa321#11;
          |FINSI;
          nDeci_TotVis   = decim_divisa;
          nDeci_TotNoVis = decim_base;
     |FINSI;
     |HAZ Deci_IVA;
|FPRC;

|PROCESO &Defecto;       || Lo llama el informe
     |SI nSwDefecto = 1;
          |PDEFECTO #12, 1, 4;
          |PDEFECTO #12, 5, 60;
     |FINSI;
|FPRC;

|| PROCESO DE SEPARACION DEL ABARAN CREADO AHORA EN SU HONONIMO EN NEGRO

|PROCESO TotalLin071_14;|TIPO 0;
     |ABRE #19;
     #19#0 = #2#2;
     |LEE 020#19=;
     |CIERRA #19;

     nPreTon = 1;
     |SI nSwVigor = 0;
          aAlfa = #19#110; |QBF aAlfa;   || Alfanumerico1
          aAlfa = aAlfa > "";
          |SI aAlfa = "S"; nPreTon = 1000; |FINSI;
     |FINSI;

     |SI #1#70 = "D";                    || Si mon. de trabajo es divisa ...
          #2#6  = #2#36 / #1#69 * #1#74; || Recalculo precio en mon. base
          #2#38 = #2#6;                  || Precio visual, en mon. base
     |SINO;                              || Si mon. de trabajo es mon. base
          #2#36 = #2#6 / #1#74 * #1#69;  || Recalculo precio en divisa
          #2#38 = #2#36;                 || Precio visual, en divisa
     |FINSI;

     |SI #19#194 = 2;
         #2#7    = #2#48 * #2#6 / nPreTon;
         nImpDiv = (#2#48 * #2#36 / nPreTon) ! nDeci_Div;
     |SINO;
          #2#7    = #2#5 * #2#6 / nPreTon;
          nImpDiv = (#2#5 * #2#36 / nPreTon) ! nDeci_Div;
     |FINSI;

     || nMult corrige el error del redondeo para negativos
     |SI #2#7 < 0; nMult = -1; |SINO; nMult = 1; |FINSI;
     #2#7    = #2#7    * nMult;
     nImpDiv = nImpDiv * nMult;

     #2#9  = (((#2#7 < #2#8) < #2#33));
     #2#37 = (((nImpDiv < #2#8) < #2#33));

     #2#7  = #2#7 * nMult;
     #2#9  = #2#9 * nMult;
     #2#37 = #2#37 * nMult;
     ||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

     |SI #1#70 = "D";     || Si la moneda de trabajo es la divisa ...
          #2#39 = #2#9;   || el campo visualiz. es el importe en moneda base
     |SINO;               || Si la moneda de trabajo es la moneda base ...
          #2#39 = #2#37;  || el campo visualiz. es el importe en divisa
     |FINSI;

     |GRABA 001#2a; ||Grabo lineas
|FPRC;

|PROCESO acttl;|TIPO 0;
     |HAZ TotalLin071_14;
     |HAZ CalCabTmp00010;
|FPRC;

|DEFBUCLE tmp00071Act;
     #2#1;
     ;
     #1#52, #1#0, 001;
     #1#52, #1#0, 999;
     ;
     NULL, acttl;
|FIN;

|PROCESO ActualizaFicha;
     |HAZ LimCabTmp00010;
     |BUCLE tmp00071Act;
|FPRC;

|PROCESO dsm00005;
     |PARA nCampo = 0;  |SI nCampo [ 10;  |HACIENDO nCampo = nCampo + 1;
           #905nCampo = #1905nCampo;
     |SIGUE;
     |GRABA 020#905n;
     |LIBERA #905;
|FPRC;

|DEFBUCLE dsm00005;
     #1905#1;
     ;
     "AV", #2#29, #2#0, nLinV, "      ";
     "AV", #2#29, #2#0, nLinV, "zzzzzz";
     be;
     NULL, dsm00005;
|FIN;


|PROCESO agifa071;
     |PARA nCampo = 0;  |SI nCampo [ 47;  |HACIENDO nCampo = nCampo + 1;
           #2nCampo = #12nCampo;
     |SIGUE;
     |GRABA 020#2n;
     |LIBERA #2;

     nLinV = #2#1;
     |BUCLE dsm00005;
|FPRC;

|PROCESO Pasalos;
     #1#68 = #11#68;
     #1#69 = #11#69;
     #1#70 = #11#70;
     |HAZ Param_Divisas14;
     |PARA nCampo = 0;  |SI nCampo [ 87;  |HACIENDO nCampo = nCampo + 1;
           #1nCampo = #11nCampo;
     |SIGUE;
     |GRABA 020#1n;
     |LIBERA #1;

     |BUCLELIN 0 agifa071 #11;
|FPRC;

|DEFBUCLE agifa010;
     #11#3;
     43;
     #0#0, #0#4, #0#9, #0#2, #0#8;
     #0#1, #0#5, #0#10,#0#3, #0#8;
     ;
     NULL, Pasalos;
|FIN;

|PROCESO Temporales;
     |HAZ CreaTempo; aTempo1 = Tempo;
     |NOME_DAT #1 aTempo1;

     |HAZ CreaTempo; aTempo2 = Tempo;
     |NOME_DAT #2 aTempo2;

     |HAZ CreaTempo; aTempo3 = Tempo;
     |NOME_DAT #905 aTempo3;

     |DELINDEX #1;
     |DELINDEX #2;
     |DELINDEX #905;

     |ABRE #1;
     |ABRE #2;
     |ABRE #905;
     |BUCLE agifa010;
     |CIERRA #1;
     |CIERRA #2;
     |CIERRA #905;
|FPRC;

|PROCESO VuelveAlSitioC;
     |SI aAlfa1 = "U";
         #905#6 = #905#10;
     |SINO;
         #905#7 = #905#10;
     |FINSI;

     #905#8 = #905#6 * #905#7;

     |GRABA 020#905a;
     |LIBERA #905;
|FPRC;

|DEFBUCLE tmpdsm05A;
     #905#1;
     ;
     "AV", #2#29, #2#0, #2#1, "      ";
     "AV", #2#29, #2#0, #2#1, "zzzzzz";
     be;
     NULL, VuelveAlSitioC;
|FIN;

|PROCESO VuelveAlSitio;
     aAlfa1 = #2#47 % 101;
     aAlfa2 = #2#47 % 615;
     |SI aAlfa1 = "U";
         #2#5 = aAlfa2;
     |SINO;
         #2#6 = aAlfa2;
     |FINSI;

     |BUCLE tmpdsm05A;

     |GRABA 020#2a;
     |LIBERA #2;
|FPRC;

|DEFBUCLE tmp00071S;
     #2#1;
     ;
     #1#52, #1#0, 001;
     #1#52, #1#0, 999;
     ;
     NULL, VuelveAlSitio;
|FIN;

|PROCESO BorraEl905;
     |BORRA 020#905a;
     |LIBERA #905;
|FPRC;

|DEFBUCLE tmpdsm05B;
     #905#1;
     ;
     "AV", #2#29, #2#0, #2#1, "      ";
     "AV", #2#29, #2#0, #2#1, "zzzzzz";
     be;
     NULL, BorraEl905;
|FIN;

|PROCESO BorraEl2;
     |BUCLE tmpdsm05B;

     |BORRA 020#2a;
     |LIBERA #2;
|FPRC;

|DEFBUCLE tmp00071B;
     #2#1;
     ;
     #1#52, #1#0, 001;
     #1#52, #1#0, 999;
     be;
     NULL, BorraEl2;
|FIN;

|PROCESO Juntalos;
     |SALVA_FICHA #1;

     |SELECT #1#1;
     #1#52 = #1#86;
     #1#0  = #1#87;
     |LEE 101#1=;
     |SI FSalida = 0;
         |BUCLE tmp00071B;
         |BORRA 020#1a;
         |LIBERA #1;
     |FINSI;

     |REPON_FICHA #1;

     |SELECT #2#1;
     |LEE 101#1=;
     |SI FSalida = 0;
         |HAZ Param_Divisas14;
         |BUCLE tmp00071S;
         |HAZ ActualizaFicha;
         |GRABA 020#1a;
         |LIBERA #1;
     |FINSI;
|FPRC;

|PROCESO Junta;
     |SI #1#85 ! "E";  |ACABA;   |FINSI;
     |HAZ Juntalos;
|FPRC;

|DEFBUCLE tmp00010Junta;
     #1#1;
     ;
     #0#9,  #0#2;
     #0#10, #0#3;
     ;
     NULL, Junta;
|FIN;

|PROCESO alimcon;|TIPO 0;
          |ERROR;
|FPRC;

|PROCESO trabajo;
     dtrab = #44#2;      || DESCRIPCION TRABAJO.
     |PRINT;
|FPRC;

|PROCESO escanlinea;
    unid    = #16#4 * #2#5;
    descrip = #16#3;
    codigo  = "";
    dto     = 0;
    precio  = 0;
    imptot  = 0;
    tiva    = 0;
    linea   = 1;

     aArti = #16#2;
     |HAZ IdiomaArticulo;
     |SI aAlfa ! "";
          #16#3 = aAlfa;
          descrip = aAlfa;
     |FINSI;

     |PRINT;
|FPRC;

|PROCESO xx;|TIPO 0;
     codigo  = "";
     descrip = "";

     dto    = "";
     dto1   = "";
     precio = "";
     unid   = "";
     imptot = "";
     tiva   = "";
     indtope=0
     |PARA ind=6;|SI ind>0;|HACIENDO ind=ind-1;
          descrip = #13ind;  |QBF descrip;
          |SI descrip ! vacio;
              indtope = ind + 1;
              ind=0;
          |FINSI;
     |SIGUE;

     |PARA ind=1;|SI ind<indtope;|HACIENDO ind=ind+1;
           descrip=#13ind;
           linea=0;
           |PRINT;
     |SIGUE;
|FPRC;

|PROCESO impdesam;|TIPO 0;
     |ABRE #13;
     #13#0=#2#27;
     |LEE 101#13=;
     |SI FSalida = 0;  |HAZ xx;  |FINSI;
     |LIBERA #13;
     |CIERRA #13;
|FPRC;

|PROCESO DesAmpli;
     |DDEFECTO #12;

     #12#3 = 0;      || Almacen
     #12#4 = #53#5;
     unid    = 0;
     dto     = 0;
     precio  = 0;
     imptot  = 0;
     tiva    = 0;
     codigo = "";
     descrip = #12#4;
     nSwDefecto  = 1;
     enSwDA = 1;
     |PRINT;
     enSwDA = 0;
     nSwDefecto  = 0;
|FPRC;

|DEFBUCLE DesAmpli;
     #53#1;
     ;
     "A", #2#29, #2#0, #2#1, 0001;
     "A", #2#29, #2#0, #2#1, 9999;
     ;
     NULL, DesAmpli;
|FIN;

|PROCESO dsm00047;
     unid = #12#5 * #47#5;
     |PRINT;
|FPRC;

|DEFBUCLE dsm00047;
     #47#1;
     ;
     #2#29, #2#0, #2#1, 001;
     #2#29, #2#0, #2#1, 999;
     ;
     NULL, dsm00047;
|FIN;

|PROCESO IVAS;
     eaCli = #2#15;
     efFiva = #1#1;
     enTiva = 1; |HAZ IVACli; iva1 = enIva; re1 = enRec;
     enTiva = 2; |HAZ IVACli; iva2 = enIva; re2 = enRec;
     enTiva = 3; |HAZ IVACli; iva3 = enIva; re3 = enRec;
     enTiva = 4; |HAZ IVACli; iva4 = enIva; re4 = enRec;
     enTiva = 5; |HAZ IVACli; iva5 = enIva; re5 = enRec;
|FPRC;

|PROCESO LeeLote;
     eaLote = "";
     |ABRE #100;
     #100#0 = #2#29;
     #100#1 = #2#0;
     #100#8 = #2#1;
     #100#5 = "";
     |LEE 000#100];
     |SI #100#0 = #2#29; |Y #100#1 = #2#0; |Y #100#8 = #2#1;
          eaLote = #100#5;
     |FINSI;
     |CIERRA #100;
|FPRC;

|PROCESO ConverCliArt;
     |DDEFECTO #109;
     #109#0 = #1#3;
     #109#2 = #2#2;
     |LEE 000#109=;
     |SI FSalida = 0;
          enCliArt = 1;
     |SINO;
          enCliArt = 0;
          #109#3 = #109#2;    || pongo el original sino esta, asi no es
          #109#4 = #2#4;      ||/necesario condicionar la linea en el inf
     |FINSI;
|FPRC;

|PROCESO ImpreNormal;
     #8#25 = #2#31;      ||serie pedido
     #8#0 = #2#12;       ||pedido
     |LEE 041#8=;
     |SI FSalida ! 0;  |DDEFECTO #8;  |FINSI;

     |HAZ LeeLote;
     |SI nSwMataMan = 0; |HAZ LeePrv; |FINSI;

     enArtImp = #2#2; |QBF enArtImp;
     codigo  = #2#2;
     descrip = #2#4;

     dto    = #2#8;
     dto1   = #2#33;
     precio = #2#6;
     unid   = #2#5;
     imptot = #2#9;
     tiva   = #2#11;
     linea  = 1;
     digito = #2#4 % "101";
     ascii  = &digito;
     sobre  = #2#47;
     palets = #2#35;     ||Palets para el modulo de Malpesa

     |HAZ IVAS;
     |SI nSwTagloma = 0;
          |SI eaSerieTa ! #2#29; |O enCodigTa ! #2#0;
               eaSerieTa = #2#29;
               enCodigTa = #2#0;
               eaTipo = "A";
               |HAZ TagloImpBlock;
          |FINSI;
          |SI #2#13 = "FMB"; |ACABA; |FINSI;
          |HAZ ImpUniFami;
          |HAZ TagPostFormado;
          |SI aEsPostFormaso = "S"; |ACABA; |FINSI;
     |FINSI;

     |SI nSwAlbadis = 0; |Y #2#63 = -1; |ACABA; |FINSI; || Linea Promocion

     |HAZ ConverCliArt;

     |SI nSwSebaLopez = 0;
          |HAZ SebaLopezVar;
     |FINSI;

     |SI nSwOrts = 0;
          enBulto = 0; enCntrl = 0; || retorna estas 2
          eaSerie = #2#31;
          enCodigo  = #2#12;
          |SUB_EJECUTA_NP "dsz99905;IMPALB";
     |FINSI;

     |SI nSwAparecida = 0;
          eaArticulo = #2#2;
          |HAZ ImpAparecida;
     |FINSI;

     |SI nSwInforAlba = 0;
          |HAZ SacaAviso;
     |FINSI;

     |SI nSwFriesa = 0;
          |HAZ FriImpAV;      || modulo 001690
     |SINO;
          |SI nSwCoimasa = 0;
               eaCodArtIdioma = #2#2;
               eaArtIdioma = "";
               |HAZ IdiomaPedidoCoimasa;
               |SI eaArtIdioma ! ""; descrip = eaArtIdioma; |FINSI;
          |FINSI;

          aArti = #2#2;
          |HAZ IdiomaArticulo;
          |SI aAlfa ! "";
               #2#4 = aAlfa;
               descrip = aAlfa;
          |FINSI;

          |PRINT;             || estandar

          |SI nSwOrts = 0; |HAZ OrtsImp; |FINSI;
     |FINSI;

     |SI nSwSematel = 0;
          |HAZ ImpreIMEI;
     |FINSI;
     |SI nSwEvaristo = 0; |Y #1#41 ! 0; || de pedido;
          |HAZ EvaristoImp;
     |FINSI;

     |SALVA_DATOS #12;
     |BUCLE DesAmpli;
     |SI nSwMataMan = 0; |HAZ AuxiMata; |FINSI;
     |REPON_DATOS #12;

     |HAZ impdesam;

     |SI #41#16 = "S";
          eaArticulo = #2#2;
          |HAZ EsEscandallo;
          |SI FSalida = 0;
               |HAZ EsKit;
               |SI FSalida = 0;
                    enEscan = 2;
                    |BUCLE dsm00047;
               |SINO;
                    enEscan = 1;
                    |BUCLELIN 0escanlinea#15;
               |FINSI;
               enEscan = 0;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO ImpreHorizo;
     enArtImp = #2#2; |QBF enArtImp;
     eaTipo      = "AV";
     eaSerie     = #2#29;
     enCodig     = #2#0;
     enLinea     = #2#1;
     eaArticulo  = #2#2;
     eaNArticulo = #2#4;
     enUnidades  = #2#5;
     enPrecio    = #2#6;
     enImpo = #2#37;
     enDto1      = #2#8;
     enDto2      = #2#33;
     enNPedido   = #2#12;
     enImpo      = #2#37;
     |HAZ TrataCompo;
|FPRC;

|PROCESO albimprl;|TIPO 0;
     eaSerLog = #2#29;
     eaNumLog = (A\("000000" + #2#0) % -106);
     eaTipLog = "AV";
     |HAZ ImprimeLog;
     ||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
     ||No se imprimen las unidades desglosadas al 100%
     aAlfa = #2#47; |QBF aAlfa;    ||(Anna&Robert lo usa)
     |SI aAlfa ! "";
          aAlfa = #2#47 % 101;
          aAlf1 = #2#47 % 201;
          |SI aAlfa = "P";         ||Por Unidad
               |SI aAlf1 = "P";
                    aAlfa = #2#47 % 303;
                    |SI aAlfa = 100; |ACABA; |FINSI;
               |SINO;
                    aAlfa = #2#47 % 303;
                    |SI aAlfa = 0; |ACABA; |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
     ||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
     |SI #0#13 = "N"; |Y #2#5 = 0; |ACABA; |FINSI;
     |SI #0#14 = "N"; |Y #2#6 = 0; |ACABA; |FINSI;

     nSwPasa = 1;
     |SI #910#19 = "N";  |HAZ ImpreNormal;  |FINSI;
     |SI #910#19 = "S";  |HAZ ImpreHorizo;  |FINSI;
|FPRC;

|DEFBUCLE tmp00071;
     #2#1;
     ;
     #1#52, #1#0, 001;
     #1#52, #1#0, 999;
     ;
     NULL, albimprl;
|FIN;

|DEFBUCLE LinOrdArt;
     #2#1;
     ;
     #1#52, #1#0, 001;
     #1#52, #1#0, 999;
     ;
     NULL, NULL, NULL, NULL, NULL, albimprl;
     #2#2;
|FIN;

|PROCESO Marhuenda;
     #2#29 = #200#0;
     #2#0 = #200#1;
     #2#1 = #200#2;
     |LEE 020#2=;
     |HAZ albimprl;
|FPRC;

|DEFBUCLE Marhuenda;
     #200#2004;
     ;
     "          ", #1#52, #1#0, 001;
     "zzzzzzzzzz", #1#52, #1#0, 999;
     ;
     NULL, Marhuenda;
|FIN;

|PROCESO albimpr1;
     |SI #0#23 ! "T";
          #3#0 = #1#3;
          |LEE 000#3=;
          |SI #3#41 ! #0#23; |ACABA; |FINSI;
     |FINSI;

     |SI nSwPackList = 0;
          eaDoc = "AV" + #1#52 + #1#0;
          |HAZ PackListVar;
     |FINSI;

     aDivisa = #1#68;
     aMoneda = #1#70;
     |HAZ Divisas010;

     |SI #3#0 ! #1#3;
         #3#0 = #1#3;
         |LEE 111#3=;
         |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;
         |LIBERA #3;
     |FINSI;
     |SI #3#189 < #0#18; |O #3#189 > #0#19; || Ruta
          |ACABA;
     |FINSI;

     #40#26 = #1#52;
     |LEE 001#40=;
     |SI FSalida ! 0;  |DDEFECTO #40;  |FINSI;

     |SI #0#8 = "N";     ||No imprimo abonos
         |SI #1#50 = "S";
             informe = #40#3; |QBF informe;
         |SINO;
             informe = #40#4; |QBF informe;
         |FINSI;
     |SINO;
         informe = #40#5; |QBF informe;
     |FINSI;
     informe1 = (informe % 0104) + "5" + (informe % 0603); |QBF informe1;

     |SI nSwMataMan = 0; |Y Impresora = "CrystalReport";
          informe = "c" + informe % 2;
     |FINSI;

     |SI nSwFergalsan = 0;
          |SI nSwFergaPrime = 0;
               |INFOR informe;
               |SI FSalida ! 0;  |ACABA;  |FINSI;
               nSwFergaPrime = 1;
          |FINSI;
     |SINO;    || la estandar
          |INFOR informe;
          |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     |SI nSwSebaLopez = 0;
          eaCliente = #1#3
          |HAZ SebaLopezEnvaPdte;
     |FINSI;

     nCopias = #3#187;

     |SI nSwExtintor = 0;
          aAlfa = "extz0031;" + #1#52 + #1#0;
          |SUB_EJECUTA_NP aAlfa;
          |NOME_DAT #2#eaTmpExtintor#;
     |FINSI;

     |SI nSwRucomar = 0; |HAZ RucoNumLin;  |FINSI;

     |SI nSwMalpesa = 0;
          |HAZ AgruArtiIni;
          |SI eaMortero = "S"; nCopias = 3; |FINSI;
     |FINSI;

     |SI nSwSanchez = 0;
          |HAZ AgruArtiIni;
     |FINSI;

     |SI nSwMarhuenda = 0; |HAZ OrdenaMarhu; |FINSI;

     aEsEstandar = "S";
     |PARA n_copia = 0; |SI n_copia [ nCopias; |HACIENDO n_copia = n_copia + 1;
          trabajo = 0;
          nSwPasa = 0;
          |SI #910#19 = "S";  |HAZ AbreTemporales;  |FINSI;
          |SI nSwMarhuenda = 0;
               |ABRE #2;
               |BUCLE Marhuenda;
               |CIERRA #2;
               aEsEstandar = "N";
          |FINSI;
          |SI nSwDiagram = 0;
               #134#49 = #1#53;
               #134#0 = #1#39;
               |HAZ FacDetalle;
               |SI FSalida = 0; aEsEstandar = "N"; |FINSI;
          |FINSI;
          |SI aEsEstandar = "S";
               |SI #0#16 = 2;
                    |BUCLE LinOrdArt;
               |SINO;
                    |BUCLE tmp00071;
               |FINSI;
          |FINSI;

          |SI #910#19 = "S";  |HAZ ElRemate;  |FINSI;
          |SI nSwPasa = 0;
               |PIEINF; enContaLin = 0;
          |FINSI;
          ||------------------ OPCION IMPRIMIR TRABAJOS --------------;
          |SI #41#132 = "S";
               |ABRE #43;
               |SELECT #4#43;
               #43#2 = #1#52;      || Serie;
               #43#3 = #1#0;       || Albaran;
               |LEE 001#43=;
               |SI FSalida = 0;
                   trabajo = 1;
                   swt     = 1;
                   |BUCLELIN 2 trabajo #43;
               |FINSI;
               |SELECT #1#43;
               |CIERRA #43;
          |FINSI;
          swt = 0;

          |SI nSwMalpesa = 0; |HAZ MalpeImpPeso; |FINSI;||Carga Var. Peso/DPD

          |PIEINF; enContaLin = 0;

          impal = 0;
          impor = 0;
     |SIGUE;

     |SI nSwMalpesa = 0; |HAZ AgruArtiFin; |FINSI;
     |SI nSwSanchez = 0; |HAZ AgruArtiFin; |FINSI;

     |SI nSwFergalsan = 0;

     |SINO; || la estandar
          |FININF;
     |FINSI;

     #300#0 = #1#52;
     #300#1 = #1#0;
     #300#2 = #1#90;
     |GRABA 000#300n;    ||Temporal de albaranes que se imprimen

     |LEE 121#1=;
     #1#90 = "S";
     |GRABA 020#1a;
     |LIBERA #1;


     |SI nSwAlbadis = 0;
          ser_alb = #1#52;
          num_alb = #1#0;
          |HAZ AlbaImpAlb;
     |FINSI;

     |SI nSwAsertis = 0;
          |HAZ AsertiMarca;
     |FINSI;

     |SI nSwTagloma = 0;
          aAlfa = "tagz0022;" + #1#52 + (("000000" + #1#0) % -106) + "CREA";
          |SUB_EJECUTA_NP aAlfa;
     |FINSI;

     |SI nSwExtintor = 0;
          aAlfa = "extz0031;BORRA"+#1#52+(("000000"+#1#0)%-106)+eaTmpExtintor;
          |SUB_EJECUTA_NP aAlfa;
          |NOME_DAT #2#Aagifa071#;
     |FINSI;

     |SI nSwMalpesa = 0;
          aAlfa = "malpe213;" + #1#52 + (("0000000" + #1#0) % -106);
          |SUB_EJECUTA_NP aAlfa;
     |FINSI;

/* ahora lo pongo esto despues de cerrar la impresora
     |SI nSwFergalsan = 0;
          eaDefERP = "agifa010";
          eaSerieDocERP = #1#52;
          eaNumDocERP = (("0000000" + #1#0) % -106);

          aAlfa = "fergaz04";
          |SUB_EJECUTA_NP aAlfa;
     |FINSI;
*/
|FPRC;

|DEFBUCLE PorCliente;
     #1#3;
     43, 90, 88;
     #0#0, #0#4, #0#9 , #0#2, #0#8, aDRei, #0#21;
     #0#1, #0#5, #0#10, #0#3, #0#8, aHRei, #0#22;
     ;
     NULL, albimpr1;
|FIN;

|DEFBUCLE PorAlbaran;
     #1#1;
     1, 3, 43, 90, 88;
     #0#9,  #0#2, #0#4, #0#0, #0#8, aDRei, #0#21;
     #0#10, #0#3, #0#5, #0#1, #0#8, aHRei, #0#22;
     ;
     NULL, albimpr1;
|FIN;

|DEFBUCLE PorFecha;
     #1#7;
     3, 43, 90, 88;
     #0#4, #0#9 , #0#2, #0#0, #0#8, aDRei, #0#21;
     #0#5, #0#10, #0#3, #0#1, #0#8, aHRei, #0#22;
     ;
     NULL, albimpr1;
|FIN;

|DEFBUCLE AgenCliente;
     #1#3;
     43, 90, 88;
     #0#0, #0#4, #0#9 , #0#2, #0#8, aDRei, #0#21;
     #0#1, #0#5, #0#10, #0#3, #0#8, aHRei, #0#22;
     ;
     NULL, NULL, NULL, NULL, NULL, albimpr1;
     #1#88, #1#3, #1#52, #1#0;
|FIN;

|DEFBUCLE AgenAlbaran;
     #1#1;
     1, 3, 43, 90, 88;
     #0#9,  #0#2, #0#4, #0#0, #0#8, aDRei, #0#21;
     #0#10, #0#3, #0#5, #0#1, #0#8, aHRei, #0#22;
     ;
     NULL, NULL, NULL, NULL, NULL, albimpr1;
     #1#88, #1#52, #1#0;
|FIN;

|DEFBUCLE AgenFecha;
     #1#7;
     3, 43, 90, 88;
     #0#4, #0#9 , #0#2, #0#0, #0#8, aDRei, #0#21;
     #0#5, #0#10, #0#3, #0#1, #0#8, aHRei, #0#22;
     ;
     NULL, NULL, NULL, NULL, NULL, albimpr1;
     #1#88, #1#1, #1#52, #1#0;
|FIN;

|DEFBUCLE SoloUno;
     #1#1;
     90;
     #0#9,  #0#2, aDRei;
     #0#10, #0#3, aHRei;
     ;
     NULL, albimpr1;
|FIN;

|PROCESO PideImpresora;
     |HAZ MiraLogos;

     |QBF eaImpresora;        || No pide
     |QBF eaFicImpre;         || a un fichero
     |QBF eaDefImpre;         || la por defecto

     |SI nSwBaeza = 0; |Y eaDefImpre = "";
          eaDefImpre = "Crystal Reports";
     |FINSI;

     |SI eaFicImpre ! "";
          Impresora = eaFicImpre;
          |IMPRE -77;
     |SINO;
          |SI eaImpresora = "";
               |SI eaDefImpre = "";
                    |IMPRE 1;
               |SINO;
                    Impresora = eaDefImpre;
                    |IMPRE 1;
               |FINSI;
          |SINO;
               Impresora = eaImpresora;
               |IMPRE -1;
          |FINSI;
     |FINSI;
     eaImpElige = Impresora;
     eaImpre014 = Impresora;
     enErrorImp = FSalida;
|FPRC;

|PROCESO Tipo3;
     |SI #0#15 = "S";
          aDRei = " ";
          aHRei = "z";
     |SINO;
          aDRei = "N";
          aHRei = "N";
     |FINSI;
     |SI eaReimp ! "";
          aDRei = eaReimp;
          aHRei = eaReimp;
     |FINSI;

     enPantalla = 0;

     |SI swmarhu062 = 0;
          |HAZ PideImpresora;
          |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     |SI aParametro = "D";
         #0#11 = "NOTAS DE ENTREGA";
         |HAZ Temporales;
         |BUCLE tmp00010Junta;
     |FINSI;

     |ABRE #3;
     |ABRE #8;
     |ABRE #40;
     |ABRE #109; |SELECT #2#109;
     |SI ser_alb = ""; |Y num_alb = 0;
          |SI #0#17 = "N";  || Agencia
               |SI #0#12 = "C"; |BUCLE PorCliente; |FINSI;
               |SI #0#12 = "A"; |BUCLE PorAlbaran; |FINSI;
               |SI #0#12 = "F"; |BUCLE PorFecha; |FINSI;
          |SINO;
               |SI #0#12 = "C"; |BUCLE AgenCliente; |FINSI;
               |SI #0#12 = "A"; |BUCLE AgenAlbaran; |FINSI;
               |SI #0#12 = "F"; |BUCLE AgenFecha; |FINSI;
          |FINSI;
     |SINO;
         #0#8 = abono;  || Le indico si quiero imprimir abonos
         |BUCLE SoloUno;
     |FINSI;
     |CIERRA #109;
     |CIERRA #40;
     |CIERRA #8;
     |CIERRA #3;

     |SI swmarhu062 = 0;
          |SI nSwFergalsan = 0;
               |SI nSwFergaPrime = 1;
                    |FININF;
               |FINSI;
               |FINIMP;
               |LEE 000#300p;
               |PARA; |SI FSalida = 0; |HACIENDO;
                    eaDefERP = "agifa010";
                    eaSerieDocERP = #1#52;
                    eaNumDocERP = (("0000000" + #1#0) % -106);

                    aAlfa = "fergaz04";
                    |SUB_EJECUTA_NP aAlfa;

                    |LEE 000#300s;
               |SIGUE;
          |SINO; || la estandar
               |FINIMP;
          |FINSI;
     |FINSI;

     |SI aParametro = "D";
         |DELINDEX #1;   Tempo = aTempo1; |HAZ BoraTempo;
         |DELINDEX #2;   Tempo = aTempo2; |HAZ BoraTempo;
         |DELINDEX #905; Tempo = aTempo3; |HAZ BoraTempo;
     |FINSI;
|FPRC;

|PROCESO Agencia;
     |SUB_EJECUTA_NP "agifa011";
|FPRC;

|PROCESO Etiquetas;
     |SUB_EJECUTA_NP "agifa013";
|FPRC;

|PROCESO Resto;
     |SUB_EJECUTA_NP "dsy00002";
|FPRC;

|PROCESO Final;
     |CIERRA #300;

     |SI nSwQDClor = 0;
          aAlfa = "qdclor04;" + aTmp300;
          |SUB_EJECUTA_NP aAlfa;
     |FINSI;

     Tempo = aTmp300; |HAZ BoraTempo; |DELINDEX #300;

     |SI nSwMarhuenda = 0; |HAZ FinMarhu; |FINSI;
|FPRC;

|PROCESO CertiLegiplag;
     |SI nSwLegiplag = 0;
          eaSerAlbaCer = ser_alb;
          enNumAlbaCer = num_alb;
          |SUB_EJECUTA_NP "legiz005;CERTI";

          ||Para que finalice
          nSwOpcion = 0;
     |FINSI;
|FPRC;

|PROCESO VallcorbaImp;
     |DDEF aAlfa;
     aAlfa = aAlfa + "vallcm03";
     |CARGA_DEF aAlfa, refere1@;
     |SI FSalida = 0;
          |ABRE #refere1@; |LEE 000#refere1@.p; |CIERRA #refere1@;
          |PARA i = 0; |SI i [ 23; |HACIENDO i = i + 1;
               #0i = #refere1@#i#;
          |SIGUE;
          |DESCARGA_DEF #refere1@;
          |HAZ Tipo3;
     |SINO;
          |MENAV "0000Error al cargar 'vallcm03'...";
     |FINSI;
|FPRC;

|PROCESO VallcorbaDatos;
     |DDEF aAlfa;
     aAlfa = aAlfa + "vallcm03";
     |CARGA_DEF aAlfa, refere1@;
     |SI FSalida = 0;
          |ABRE #refere1@; |LEE 000#refere1@.p; |CIERRA #refere1@;
          |PARA i = 0; |SI i [ 23; |HACIENDO i = i + 1;
               #0i = #refere1@#i#;
          |SIGUE;
          |DESCARGA_DEF #refere1@;
     |SINO;
          |MENAV "0000Error al cargar 'vallcm03'...";
     |FINSI;
|FPRC;

|PROGRAMA;
     enContaLin = 0;
     |SI PRMNT_Imp ! "";
          ser_alb = PRMNT_Imp % 105; aAlfa = PRMNT_Imp % 606;
          num_alb = aAlfa;
     |FINSI;

     |HAZ EsInforpor;
     |SI FSalida = 0; |CORRE "guiz0001"; |FINSI;

     |HAZ EsPCEGroup;
     |SI FSalida = 0; |CORRE "pcegz028"; |FINSI;

     |SI ser_alb = ""; |Y num_alb = 0;
          |HAZ EsVallcorba; enSwVallcorba = FSalida;
          |SI FSalida = 0; |Y enImpVallcorba = 0; |CORRE "vallcm03"; |FINSI;
     |FINSI;

     |HAZ EsVigor; nSwVigor = FSalida;
     |HAZ EsAparecida; nSwAparecida = FSalida;
     |HAZ EsCoimasa; nSwCoimasa = FSalida;
     |HAZ EsQDClor; nSwQDClor = FSalida;
     |HAZ EsRucomar; nSwRucomar = FSalida;
     |HAZ EsEvaristo; nSwEvaristo = FSalida;
     |HAZ EsMalpesa; nSwMalpesa = FSalida;
     |HAZ EsInforAlba; nSwInforAlba = FSalida;
     |HAZ EsOrts; nSwOrts = FSalida;
     |HAZ EsTagloma; nSwTagloma = FSalida;
     |HAZ EsMarhuenda; nSwMarhuenda = FSalida;;
     |HAZ EsPackList; nSwPackList = FSalida;
     |HAZ EsAlbadis; nSwAlbadis = FSalida;
     |HAZ EsAsertis; nSwAsertis = FSalida;
     |HAZ EsBaeza; nSwBaeza = FSalida;
     |HAZ EsFriesa; nSwFriesa = FSalida;
     |HAZ EsMecanogra; nSwMecanogra = FSalida;
     |HAZ EsPCEGroup; nSwPCEGroup = FSalida;
     |HAZ EsSematel; nSwSematel = FSalida;
     |HAZ EsSebaLopez; nSwSebaLopez = FSalida;
     |HAZ EsDiagram; nSwDiagram = FSalida;
     |HAZ EsLegiplag; nSwLegiplag = FSalida;
     |HAZ EsMataMan; nSwMataMan = FSalida;
     |HAZ EsExtintor; nSwExtintor = FSalida;
     |HAZ EsFergalsan; nSwFergalsan = FSalida;
     |HAZ EsChampiEmar; nSwChampiEmar = FSalida;
     |HAZ EsSanchez; nSwSanchez = FSalida;

     |SI eaFicTmpCab ! ""; |NOME_DAT #tmp00010#eaFicTmpCab#; |FINSI;
     |SI eaFicTmpLin ! ""; |NOME_DAT #tmp00071#eaFicTmpLin#; |FINSI;

     aParametro = PARAMETRO;
     |ABRE #41;  |LEE 000#41p; |CIERRA #41;
     |ABRE #910; |LEE 000#910p; |CIERRA #910;

     eaSerieTa = "";
     enCodigTa = 0;
     |HAZ MiraLogos; || Copia Logos para el Crystal


     |SI nSwMalpesa = 0;  #0#16 = 2; |FINSI;

     |HAZ CreaTempo; |NOME_DAT #300 Tempo; |DELINDEX #300; aTmp300 = Tempo; |ABRE #300;

     |SI nSwMarhuenda = 0; |HAZ IniMarhu; |FINSI;

     |SI enDesdeX ! 0;
         #0#9  = ser_alb;
         #0#10 = ser_alb;
         #0#2  = num_alb;
         #0#3  = num_alb;
         #0#15 = "S";
         #0#23 = "T";

         |SI enDesdeX = 1;                 |HAZ Tipo3;        |FINSI;
         |SI enDesdeX = 2;                 |HAZ Agencia;      |FINSI;
         |SI enDesdeX = 3;                 |HAZ Etiquetas;    |FINSI;
         |SI enDesdeX = 4;  aQuelis = "P"; |HAZ Resto;        |FINSI;
         |SI enDesdeX = 5;  aQuelis = "T"; |HAZ Resto;        |FINSI;
         |SI enDesdeX = 6;  aQuelis = "A"; |HAZ Resto;        |FINSI;

         |HAZ Final; |ACABA;
     |FINSI;

     |SI ser_alb = ""; |Y num_alb = 0;
          |SI enImpVallcorba = 1;
               |HAZ VallcorbaImp;
               |HAZ Final; |ACABA;
          |FINSI;

         |ABRE #0;
         |LEE 101#0p;
         |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
         |SI #0#23 = " "; #0#23 = "T"; |FINSI;
         |CLS;
         |CABEZA "Imp. Albaran";
         |PINPA #0#0;
         |SI aParametro = "D";
               |ATRI R;
               |PINTA 0506, "    NOTAS  DE ENTREGA   ";
               |ATRI 0;
         |FINSI;
         |SI nSwFergalsan = 0;
             |C_M #0#10, 1, "N";
             |C_V #0#10, 1, "N";
         |FINSI;

         |PINDA #0#0;
         |ENDATOS #1#0;
         |SI FSalida = 0;

               |SI nSwFergalsan = 0; #0#10 = #0#9; |FINSI;

               |GRABA 020#0a;
               |LIBERA #0;
               |HAZ Tipo3;
         |FINSI;
         |CIERRA #0;
     |SINO;
         |SI enImpVallcorba = 1; |HAZ VallcorbaDatos; |FINSI;
         #0#9  = ser_alb;
         #0#10 = ser_alb;
         #0#2  = num_alb;
         #0#3  = num_alb;
         #0#15 = "S";
         #0#23 = "T";
         FSalida = 0;
         |SI swmarhu062 ! 0;
             |HAZ Tipo3;
             |HAZ Final; |ACABA;
         |FINSI;

         |SI enSinMenuImpAV = 1;
             |HAZ Tipo3;
             |HAZ Final; |ACABA;
         |FINSI;

         |SI eaMenuImpre = "N";
              |HAZ Tipo3;
              |HAZ Final; |ACABA;
         |FINSI;

         |SI nSwPCEGroup = 0;
             |HAZ Tipo3;
             |HAZ Final; |ACABA;
         |FINSI;

         |SI nSwLegiplag = 0;
              MenuImpre3 = "8";
              MenuImpre11 = "Certificados";
         |SINO;
              |CONFI "2400NDesea Menu de Impresion : ";
              |SI FSalida ! 0;
                    |HAZ Tipo3;
                    |HAZ Final; |ACABA;
              |FINSI;
         |FINSI;

         |SI nSwInforAlba = 0;
               MenuImpre3 = "8";
               MenuImpre11 = "Etiquetas InforAlba";
         |FINSI;

         |SI nSwChampiEmar = 0;
               MenuImpre3 = "8";
               MenuImpre11 = "Etiquetas Segn Envase";
         |FINSI;

         nSwOpcion = 1;
         |PUSHV 0501 2380;
         |PARA; |SI nSwOpcion = 1; |HACIENDO;
               ||BLANCO 0802 2062;
               |MENUG MenuImpre;
               MenuImpre2 = FSalida;
               |SI MenuImpre2 = "1";  nSwOpcion = 0;     |FINSI;
               |SI MenuImpre2 = "2";  |HAZ Tipo3;        |FINSI;
               |SI MenuImpre2 = "3";  |HAZ Agencia;      |FINSI;
               |SI MenuImpre2 = "4";  |HAZ Etiquetas;    |FINSI;
               |SI MenuImpre2 = "5";  aQuelis = "P"; |HAZ Resto;  |FINSI;
               |SI MenuImpre2 = "6";  aQuelis = "T"; |HAZ Resto;  |FINSI;
               |SI MenuImpre2 = "7";  aQuelis = "A"; |HAZ Resto;  |FINSI;
               |SI MenuImpre2 = "8";
                   |SI nSwInforAlba = 0;  |HAZ EtiInforAlba; |FINSI;
                   |SI nSwLegiplag = 0;   |HAZ CertiLegiplag; |FINSI;
                   |SI nSwChampiEmar = 0; |SUB_EJECUTA_NP "champi13"; |FINSI;
               |FINSI;
         |SIGUE;
         |POPV;
     |FINSI;

     |HAZ Final;
|FPRO;

|PROCESO BogeVariables;
     |DDEF aAlfa;
     aAlfa = aAlfa + "bogem027";
     |CARGA_DEF aAlfa, refere1@;
     |SI FSalida = 0;
          |ABRE #refere1@;
          |SELECT #2#refere1@;
          #refere1@#20 = #1#52;
          #refere1@#21 = #1#0;
          |LEE 000#refere1@.=;
          |SI FSalida = 0;
               enBogeRefe = #refere1@#0;
               enBogeAlba = #refere1@#19;
               enBogeLin = (#2#1-1 $ 3) + 1; || Multiplo de 3
          |FINSI;
          |CIERRA #refere1@;

          |DESCARGA_DEF #refere1@;
     |FINSI;
|FPRC;

|PROCESO ImpreIMEI;
     |DDEF aPath;
     aAlfa = aPath + "tlfm0001";
     |CARGA_DEF aAlfa, tlfm0001@;
     |SI FSalida ! 0;
          |MENAV "0000Error al cargar 'tlfm0001'";
     |SINO;
          aAlfa = aPath + "tlfm0002"
          |CARGA_DEF aAlfa, tlfm0002@;
          |SI FSalida ! 0;
               |MENAV "0000Error al cargar 'tlfm0002'";
          |SINO;
               eaIMEI = ""; eaABO = ""; eaICC = "";
               enSwIMEI = 0;
               |ABRE #101; |SELECT #5#101;
               |ABRE #102; |SELECT #5#102;
               #101#25 = #2#29;
               #101#26 = #2#0;
               #101#27 = #2#1;
               |LEE 000#101=;
               |SI FSalida = 0;
                    eaIMEI = #101#0;
               |FINSI;
               #102#25 = #2#29;
               #102#26 = #2#0;
               #102#27 = #2#1;
               |LEE 000#102=;
               |SI FSalida = 0;
                    eaABO = #102#3;
                    eaICC = #102#4;
               |FINSI;
               |CIERRA #101;
               |CIERRA #102;
               |SI eaIMEI ! ""; |O eaABO ! ""; |O eaICC ! "";
                    enSwIMEI = 1;
                    |PRINT;
               |FINSI;
               enSwIMEI = 0;
               |DESCARGA_DEF #tlfm0002@;
          |FINSI;
          |DESCARGA_DEF #tlfm0001@;
     |FINSI;
|FPRC;

|PROCESO SebaLopezVar;
     eaSLenvase = "";
     eaSLdesenv = "";
     enSLbruto = 0;
     enSLnumenv = 0;
     enSLtara = 0;
     enSLneto = 0;

     |DDEF aAlfa;
     aAlfa = aAlfa + "sebalo04";
     |CARGA_DEF aAlfa, refere1@;
     |SI FSalida = 0;
          |ABRE #refere1@;
          #refere1@#0 = #2#29;
          #refere1@#1 = #2#0;
          #refere1@#2 = #2#1;
          |LEE 000#refere1@.=;
          |SI FSalida = 0;
               eaSLenvase = #refere1@#3;
               eaSLdesenv = #refere1@#4;
               enSLbruto = #refere1@#8;
               enSLnumenv = #refere1@#5;
               enSLtara = #refere1@#6;
               enSLneto = #refere1@#7;
          |FINSI;
          |CIERRA #refere1@;
          |DESCARGA_DEF #refere1@;
     |FINSI;
|FPRC,

|PROCESO RucoNumLin;
     |DDEF aAlfa;
     aAlfa = aAlfa + "rucom014";
     |CARGA_DEF aAlfa, refere1@;
     |SI FSalida = 0;
          |ABRE #refere1@; |SELECT #3#refere1@;
          #refere1@#5 = #1#52;
          #refere1@#15 = #1#0;
          |LEE 000#refere1@.=;
          |SI FSalida = 0;
               enRucoLin = #refere1@#0;
          |SINO;
               enRucoLin = 0;
          |FINSI;
          |CIERRA #refere1@;
          |DESCARGA_DEF #refere1@;
     |FINSI;
|FPRC;

|PROCESO ortsm018;
     enSwDes = 0;
     |SI #refere2@#5 ! #refere3@#59; enSwDes = 2; |FINSI;
     |SI #refere2@#6 ! "    "; |Y #refere2@#6 ! #refere3@#60; enSwDes = 2; |FINSI;
     |SI enSwDes = 2;
          enLin2 = #refere2@#4;
          enSwDes = 2;
          |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE ortsm018;
     #refere2@#1005;
     ;
     #2#31, #2#12, #2#21, nLin, 1;
     #2#31, #2#12, #2#21, nLin, 999;
     ;
     NULL, ortsm018;
|FIN;

|PROCESO ortsm017;
     enSwDes = 0;
     |SI #refere1@#6 ! #refere3@#59; enSwDes = 1; |FINSI;
     |SI #refere1@#11 ! "    "; |Y #refere1@#11 ! #refere3@#60; enSwDes = 1; |FINSI;
     |SI enSwDes = 1;
          enLin1 = #refere1@#3;
          |PRINT;
     |FINSI;
     |SI #refere1@#8 = "S";
          enLin1 = #refere1@#3;
          nLin = #refere1@#3;
          |BUCLE ortsm018;
     |FINSI;
|FPRC;

|DEFBUCLE ortsm017;
     #refere1@#1004;
     ;
     #2#31, #2#12, #2#21, 000;
     #2#31, #2#12, #2#21, 999;
     ;
     NULL, ortsm017;
|FIN;

|PROCESO OrtsImp;
     |SI #2#12 = 0; |ACABA; |FINSI;

     |DDEF aPath;
     aAlfa = aPath + "ortsm016";
     |CARGA_DEF aAlfa, refere3@;
     |SI FSalida = 0;
          |ABRE #refere3@;
          #refere3@#28 = #2#31;
          #refere3@#0 = #2#12;
          #refere3@#1 = #2#21;
          |LEE 000#refere3@.=;
          |SI FSalida = 0;
               aAlfa = aPath + "ortsm017";
               |CARGA_DEF aAlfa, refere1@;
               |SI FSalida ! 0;
                    |MENAV "0000Error al cargar 'ortsm017'";
               |SINO;
                    aAlfa = aPath + "ortsm018"
                    |CARGA_DEF aAlfa, refere2@;
                    |SI FSalida ! 0;
                         |MENAV "0000Error al cargar 'ortsm018'";
                    |SINO;
                         |BUCLE ortsm017;
                         enSwDes = 0;
                         |DESCARGA_DEF #refere2@;
                    |FINSI;
                    |DESCARGA_DEF #refere1@;
               |FINSI;
          |FINSI;
          |CIERRA #refere3@;
          |DESCARGA_DEF #refere3@;
     |SINO;
          |MENAV "0000Error al cargar 'ortsm017'";
     |FINSI;
|FPRC;
