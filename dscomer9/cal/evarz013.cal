|FICHEROS;
     evarz013 #0;
     evarm005 #1;   || Historico de etiquetas.
     agifa104 #2; || pedidos c
     agifa073 #3; || pedidso l
     evarm004 #4; || resto linea pedido
     evarm006;    || Series.
     evarm021 #21;
|FIN;

|VARIABLES;
     &XVAR_DC_IMPRIME = 0;
     nFin = 0;
     tt        = "";
     barra     = "";
     numero    = "";
     linea     = "";
     lin       = 0;
     informe1  = "";
     informe2  = "";
     serie     = "00";
     &uni = 0;
     &talla = "";
     &color = "";
     &manga = "";
     &pecho = 0;
     &cintura = 0;
     &talle = 0;
     &espalda = 0;
     &lfalda = 0;
     &ltotal = 0;
     &lmanga = 0;
     &pu¤o = 0;
     &bultos = 0;
     &model = "";
     &descrip = "";
     aAlfa1 = "";
     nSwAlgoEsAlgo = 0;
|FIN;

|PROCESO ModiSituBarra;
     |ABRE #21;
     |SELECT #5#21;
     #21#0 = #1#0;
     |LEE 101#21=;
     |SI FSalida = 0;
          #21#8 = #1#3;
          |GRABA 020#21a;
     |FINSI;
     |CIERRA #21;
|FPRC;

|PROCESO escap; |TIPO 6;
     |SI FSalida = 1;
          |ERROR;
          |PTEC 807;
     |FINSI;
|FPRC;


|| IMPRIME LA ETIQUETA ......................................................
|PROCESO etiqueta;
     numero = barra % 106;
     linea  = barra % 702;    |QBF linea;
     lin = linea;
     serie = #1#1;
     |ABRE #2;
     |ABRE #3;
     |ABRE #evarm006;
     #evarm006#0 = serie;           || LEE LA SERIE PARA COGER EL INFORME.
     |LEE 000#evarm006.=;
     |SI FSalida = 0;
          informe1 = #evarm006#23;
          informe2 = #evarm006#24;
     |SINO;
          informe1 = "evaadhe1";
          informe2 = "evaadhe2";
     |FINSI;
     |SI #0#4 = "E";
          informe1 = #evarm006#26;
     |FINSI;


     |QBF informe1;
     |QBF informe2;
     #3#28 = serie;                || LEE EL PEDIDO PARA COGER LOS DATOS
     #3#0  = numero;               || DE LA ETIQUETA.
     #3#1  = lin;
     |LEE 000#3=;
     |SI FSalida = 0;
          |ABRE #4;
          #4#30 = serie;
          #4#31 = numero;
          #4#32 = lin;
          |LEE 000#4=;
          |SI FSalida ! 0;
               aAlfa1 = "0000Detalle de Pedido [" + #3#28 + "." + #3#0 + "." + #3#1 + "] inaccesible.";
               |CDEFECTO #4,1;
          |FINSI;
          |HAZ vertalla;
          |CIERRA #4;
     |SINO;
          aAlfa1 = "0000Linea de Pedido [" + #3#28 + "." + #3#0 + "." + #3#1 + "] inaccesible.";
          |MENAV aAlfa1;
     |FINSI;
     |CIERRA #2;
     |CIERRA #3;
     |CIERRA #evarm006;
|FPRC;

|PROCESO vertalla;
     nSwAlgoEsAlgo = 0;

     model   = #3#2;          || CODIGO ARTICULO.
     descrip = #3#4;          || DESCRIPCION.
     uni     = 0;
     talla   = "";
     color   = "";
     manga   = "";
     pecho   = 0;
     cintura = 0;
     talle   = 0;
     espalda = 0;
     lfalda  = 0;
     ltotal  = 0;
     lmanga  = 0;
     pu¤o    = 0;

     tt = barra % 902;
     |SI tt = "01"; uni = #4#3; talla = "80";   |HAZ printalla; |FINSI;
     |SI tt = "02"; uni = #4#4; talla = "85";   |HAZ printalla; |FINSI;
     |SI tt = "03"; uni = #4#5; talla = "90";   |HAZ printalla; |FINSI;
     |SI tt = "04"; uni = #4#6; talla = "95";   |HAZ printalla; |FINSI;
     |SI tt = "05"; uni = #4#7; talla = "100";  |HAZ printalla; |FINSI;
     |SI tt = "06"; uni = #4#8; talla = "105";  |HAZ printalla; |FINSI;
     |SI tt = "07"; uni = #4#9; talla = "110";  |HAZ printalla; |FINSI;
     |SI tt = "08"; uni = #4#10; talla = "115"; |HAZ printalla; |FINSI;
     |SI tt = "09"; uni = #4#11; talla = "120"; |HAZ printalla; |FINSI;
     |SI tt = "10"; uni = #4#12; talla = "125"; |HAZ printalla; |FINSI;
     |SI tt = "11"; uni = #4#13; talla = "130"; |HAZ printalla; |FINSI;
     |SI tt = "12"; uni = #4#14; talla = "135"; |HAZ printalla; |FINSI;
     |SI tt = "13";
          uni     = #3#15;
          talla   = "Especial";
          color   = #4#16;
          manga   = #4#17;
          pecho   = #4#18;
          cintura = #4#19;
          talle   = #4#20;
          espalda = #4#21;
          lfalda  = #4#22;
          ltotal  = #4#23;
          lmanga  = #4#24;
          pu¤o    = #4#25;
          model   = #3#2;
          descrip = #3#4;          || DESCRIPCION.
          |HAZ printalla;
     |FINSI;
     |SI tt = "14"; uni = #4#27; talla = "140"; |HAZ printalla; |FINSI;
     |SI tt = "15"; uni = #4#39; talla = "Compleme"; |HAZ printalla; |FINSI;
     |SI tt = "16"; uni = #4#40; talla = "70"; |HAZ printalla; |FINSI;
     |SI tt = "17"; uni = #4#41; talla = "75"; |HAZ printalla; |FINSI;

     |SI tt = "18"; uni = #4#41; talla = "3M"; |HAZ printalla; |FINSI;
     |SI tt = "19"; uni = #4#41; talla = "6M"; |HAZ printalla; |FINSI;
     |SI tt = "20"; uni = #4#41; talla = "9M"; |HAZ printalla; |FINSI;
     |SI tt = "21"; uni = #4#41; talla = "18M"; |HAZ printalla; |FINSI;


     |SI nSwAlgoEsAlgo = 0;
          |MENAV "0000No se encuentra ninguna talla con unidades.";
     |FINSI;
|FPRC;

|PROCESO printalla;
     nSwAlgoEsAlgo = 1;

     |SI #0#4 = "A";
          aAlfa1 = #0#2; |QBF aAlfa1;
          Impresora = aAlfa1;
     |SINO;
          Impresora = "CrystalReport";
          XVAR_DC_IMPRIME = 1;          || No previsualiza el crystal
     |FINSI;
     |IMPRE -1;

     |SI FSalida = 0;

          |INFOR informe1;    || INFORME ETIQUETAS CAJAS GRANDES.
          |SI FSalida = 0;
               |PRINT;
               |PIEINF;
               |FININF;
          |SINO;
               |QBF informe1;
               |SI informe1 ! "";
                    aAlfa1 = "0000Informe [" + informe1 + "] inaccesible.";
                    |MENAV aAlfa1;
               |FINSI;
          |FINSI;
          |SI #0#4 = "A";
               |INFOR informe2;    || INFORME ETIQUETAS PEQUE¥AS.
               |SI FSalida = 0;
                    |PRINT;
                    |PIEINF;
                    |FININF;
               |SINO;
                    |QBF informe2;
                    |SI informe2 ! "";
                         aAlfa1 = "0000Informe [" + informe2 + "] inaccesible.";
                         |MENAV aAlfa1;
                    |FINSI;
               |FINSI;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;


|PROCESO T12; |TIPO 12;
     nFin = FSalida;
     |SI nFin = 7; |O nFin = 1; |ACABA; |FINSI;

     barra = #0#0 % 112;
     #1#0 = barra;
     |LEE 101#1=;
     |SI FSalida = 0;
         #1#2 = "0";
         #1#3 = "COMPLETO                      ";
         #1#13 = ~;
         |GRABA 020#1a;
         |HAZ ModiSituBarra;
         #0#1 = 1;
         |SI FSalida = 0;
              |QBT barra;
              barra = ("000000000000" + barra) % -112;
              |HAZ etiqueta;
         |FINSI;
         |LIBERA #1;
     |SINO;
          |MENAV "0000Código inexistente ...";
     |FINSI;

     |GRABA 020#0a;
|FPRC;

|PROCESO CB; |TIPO 0;
     |SI FSalida = 1; |ACABA; |FINSI;
     |SI FSalida = 2;
          |SI #0#4 = "A";
               |C_M #0#2, 1, "S";
          |FINSI;
          |C_M #0#4, 1, "S";
     |SINO;
          barra = #0#0 % 112;
          #1#0 = barra;
          |LEE 000#1=;
          |SI FSalida ! 0;
               |MENAV "0000Código inexistente ...";
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO TipoImpre; |TIPO 0;
     |SI #0Campo ! Contenido;
          |SI #0#4 = "A";
               |C_M #0#2, 1, "S";
          |SINO;
               |C_M #0#2, 1, "N";
          |FINSI;
     |FINSI;
|FPRC;

|PROGRAMA;
     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
     #0#0 = "";
     #0#1 = "";

     |CLS;
     |CABEZA "Situacion Completo";
     |PINPA #0#0;
     |PINDA #0#0;

     |C_M #0#2, 1, "N";
     |C_M #0#4, 1, "N";
     |ABRE #1;
     |PARA; |SI nFin ! 7; |Y nFin ! 1; |HACIENDO;
          |ENDATOS #1#0;
          |C_M #0#2, 1, "N";
          |C_M #0#4, 1, "N";
     |SIGUE;
     |CIERRA #1;

/*
     |ENCAMPO #2#0;
     |SI FSalida = 0;
          |ABRE #1;
          |PARA; |SI; |HACIENDO;
                |PINDA #0#0;
                |ENCAMPO #0#0;
                |SI FSalida ! 0; |SAL; |FINSI;

                barra = #0#0 % 112;
                #1#0 = barra;
                |LEE 101#1=;
                |SI FSalida = 0;
                    #1#2 = "0";
                    #1#3 = "COMPLETO                      ";
                    #1#13 = ~;
                    |GRABA 020#1a;
                    |HAZ ModiSituBarra;
                    #0#1 = 1;
                    |SI FSalida = 0;
                         |QBT barra;
                         barra = ("000000000000" + barra) % -112;
                         |HAZ etiqueta;
                    |FINSI;
                |SINO;
                    |MENAV "0000Codigo inexistente ...";
                |FINSI;
                |LIBERA #1;
          |SIGUE;
          |CIERRA #1;
          |GRABA 020#0a;
     |FINSI;
*/
     |CIERRA #0;
|FPRO;
