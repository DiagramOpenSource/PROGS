|FICHEROS;
     golispar #0;
     gopre001 #1;
     goartive #2;
     gomantca #3;
     golispa1 #4,MANTE;
     golispa2 #5;
     gopartia #6;
     goparame #100;
|FIN;
-----------------------------------------------------------------------------
|VARIABLES;
     nHay    = 0;
     nLinpa1 = 0;
     nLinpa2 = 0;
     cFich   = "";
|FIN;
-----------------------------------------------------------------------------
|PROCESO Inicio; |TIPO 7;
     |ABRE #1;                     ||PRESUPUESTOS
     |LEE 000#1p;
     |SI FSalida = 0;
          #0#2 = #1#0;             ||SERIE PRESUPUESTO
          #0#4 = #1#1;             ||NUMERO PRESUPUESTO
     |FINSI;
     |LEE 000#1u;
     |SI FSalida = 0;
          #0#3 = #1#0;             ||SERIE PRESPUPUESTO
          #0#5 = #1#1;             ||NUMERO PRESUPUESTO
     |FINSI;
     |CIERRA #1;
     |ABRE #2;                     ||ARTICULOS I.V.E.
     |LEE 000#2p;
     |SI FSalida = 0;
          #0#6 = #2#0;             ||CODIGO ARTICULO
          #0#8 = #2#1;             ||DESCRIPCION ARTICULO
     |FINSI;
     |LEE 000#2u;
     |SI FSalida = 0;
          #0#7 = #2#0;             ||CODIGO ARTICULO
          #0#8 = #2#1;             ||DESCRIPCION ARTICULO
     |FINSI;
     |CIERRA #2;
     |ABRE #3;                     ||EXPEDIENTE
     |LEE 000#3u;
     |SI FSalida = 0;
          #0#0 = #3#0;             ||SERIE EXPEDIENTE
          #0#1 = #3#1;             ||NUMERO EXPEDIENTE
     |FINSI;
     |CIERRA #3;
     |PINDA #0#0;
|FPRC;
-----------------------------------------------------------------------------
|PROCESO Busca;
     |SELECT #2#4;
     #4#0 = #6#2;             ||SERIE EXPEDIENTE
     #4#1 = #6#3;             ||NUMERO EXPEDIENTE
     #4#3 = #6#0;             ||SERIE PRESUPUESTO
     #4#4 = #6#1;             ||NUMERO PRESUPUESTO
     #4#5 = #6#4;             ||SERIE PARTE
     #4#6 = #6#5;             ||NUMERO PARTE
     |LEE 000#4=;
     |SI FSalida ! 0;
          nLinpa1 = nLinpa1 + 1;
          #4#2 = nLinpa1;          ||LINEA
          #4#7 = #6#28;            ||FECHA PARTE
          #4#8 = #6#10;            ||UNIDADES
          |GRABA 020#4c;
     |SINO;
          #4#8 = #4#8 + #6#10;     ||UNIDADES
          |GRABA 020#4a;
     |FINSI;
     #5#0 = #6#2;             ||SERIE EXPEDIENTE
     #5#1 = #6#3;             ||NUMERO EXPEDIENTE
     #5#2 = #6#0;             ||SERIE PRESUPUESTO
     #5#3 = #6#1;             ||NUMERO PRESUPUESTO
     #5#4 = #6#4;             ||SERIE PARTE
     #5#5 = #6#5;             ||NUMERO PARTE
     #5#7 = #6#8;             ||PARTIDAS
     |LEE 000#5=;
     |SI FSalida ! 0;
          nLinpa2 = nLinpa2 + 1;
          #5#6 = nLinpa2;          ||LINEA
          #5#8 = #6#9;             ||DESCRIPCION
          #5#9 = #6#10;            ||UNIDADES
          |GRABA 020#5c;
     |SINO;
          #5#9 = #5#9 + #6#10;     ||UNIDADES
          |GRABA 020#5a;
     |FINSI;
     nHay = 1;
     ||#0#13 = #0#13 + #5#9;
     ||SISCO 12.12.2006 De la manera anterior se acumulaba dos veces
     #0#13 = #0#13 + #6#10;
|FPRC;
-----------------------------------------------------------------------------
/*
|DEFBUCLE Busca;
     #6#8;
     29;
     #0#2,#0#4,#0#0,#0#1,"     ",     1,#0#10,#0#6,"T";
     #0#3,#0#5,#0#0,#0#1,"zzzzz",999999,#0#11,#0#7,"T";
     ;
     NULL, Busca;
|FIN;
*/
|DEFBUCLE Busca;
     #6#3;
     28, 34;
     #0#0, #0#1, #0#2, #0#4, "                    ", #0#6, #0#10, "T";
     #0#0, #0#1, #0#3, #0#5, "zzzzzzzzzzzzzzzzzzzz", #0#7, #0#11, "T";
     ;
     NULL, Busca;
|FIN;
-----------------------------------------------------------------------------
||12.12.2006 SISCO Procesos para la impresion en Crystal
|DEFBUCLE golispa2;
     #5#2;
     ;
     #4#0, #4#1, #4#3, #4#4, #4#5, #4#6," "*20,1;
     #4#0, #4#1, #4#3, #4#4, #4#5, #4#6,"z"*20,999;
     ;
     NULL, ImpreLin;
|FIN;

|PROCESO golispa1;
     |BUCLE golispa2;
|FPRC;

|DEFBUCLE golispa1;
     #4#1;
     ;
     "     ",     1, "     ",     1,"     ",     1,   1;
     "zzzzz",999999, "zzzzz",999999,"zzzzz",999999,9999;
     ;
     NULL, golispa1;
|FIN;

|PROCESO ImpreRPT;
     Impresora = "CrystalReport"
     |IMPRE -1;
     |SI FSalida = 0;
          |INFOR "golispar";
          |SI FSalida = 0;
               |BUCLE golispa1;
               |PIEINF;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
-----------------------------------------------------------------------------
|PROCESO Empieza; |TIPO 3;
     nHay = 0;
     nLinpa1 = 0;
     nLinpa2 = 0;
     cFich = Usuario % 105;
     cFich = cFich + "pa1";
     #0#13 = 0;
     |NOME_DAT #4 cFich;
     |DELINDEX #4;
     |ABRE #4;
     cFich = Usuario % 105;
     cFich = cFich + "pa2";
     |NOME_DAT #5 cFich;
     |DELINDEX #5;
     |ABRE #5;
     |BUCLE Busca;
     |SI nHay = 1;
          |SI #0#12 = "P";
               |ENTLINEAL #1#4,-7,4,20,1,Min_Expe,Max_Expe;
          |SINO;
               ||HAZ Impresion;    ||12.12.2006 SISCO.Cambiado a Impresion Crystal
               |HAZ ImpreRPT;
          |FINSI;
     |FINSI;
     |PTEC 802;
     |CIERRA #4;
     |CIERRA #5;
|FPRC;
-----------------------------------------------------------------------------
|PROCESO Min_Expe;
     #4#0 = "     ";
     #4#1 = 1;
     #4#3 = "     ";
     #4#4 = 1;
     #4#5 = "     ";
     #4#6 = 1;
     #4#2 = 1;
|FPRC;
-----------------------------------------------------------------------------
|PROCESO Max_Expe;
     #4#0 = "zzzzz";
     #4#1 = 999999;
     #4#3 = "zzzzz";
     #4#4 = 999999;
     #4#5 = "zzzzz";
     #4#6 = 999999;
     #4#2 = 9999;
|FPRC;
-----------------------------------------------------------------------------
|PROCESO ImpreLin;
     |PRINT;
|FPRC;
-----------------------------------------------------------------------------
|DEFBUCLE ImpLispa1;
     #4#1;
     ;
     "     ",     1, "     ",     1,"     ",     1,   1;
     "zzzzz",999999, "zzzzz",999999,"zzzzz",999999,9999;
     ;
     NULL, ImpreLin;
|FIN;
-----------------------------------------------------------------------------
|DEFBUCLE ImpLispa2;
     #5#2;
     ;
     "     ",     1,"     ",     1,"     ",     1," "*20,1;
     "zzzzz",999999,"zzzzz",999999,"zzzzz",999999,"z"*20,999;
     ;
     NULL, ImpreLin;
|FIN;
-----------------------------------------------------------------------------
|PROCESO Impresion;
     |SUB_EJECUTA_NP "goinform;IMPgolispa1";
     |INFOR "golispa1";
     |BUCLE ImpLispa1;
     |PIEINF;
     |FININF;
     |SUB_EJECUTA_NP "goinform;ENVgolispa1";
     |SUB_EJECUTA_NP "goinform;IMPgolispa2";
     |INFOR "golispa2";
     |BUCLE ImpLispa2;
     |PIEINF;
     |FININF;
     |SUB_EJECUTA_NP "goinform;ENVgolispa2";
     |SUB_EJECUTA_NP "goinform;RUNLISTAPAR";
|FPRC;
-----------------------------------------------------------------------------
|PROCESO Tipo13; |TIPO 13;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     |SI #100#141 = "O";
          |ATRI R; |PINTA 731, " O.T......:"; |ATRI 0;
          |ATRI R; |PINTA 1204, "O.E.       "; |ATRI 0;
     |FINSI;
|FPRC;
