|FICHEROS;
     sctrz050 #0;
     sctrm012 #12;
     sctrm052 #52;
     sctrm057 #57;
     sctrm001 #100;
|FIN;

|VARIABLES;
     &enTipo = 0;
     &eaNomLogo = "";
     &enPantaLogo = 0;
     nPanta = 0;
     aAlfa = "";
     aInforme = "";
     aDFac = "";
     aHFac = "";
|FIN;

|PROCESO ReservasAnula;
     |SI #0#10 = 2; || Apis
          |SI #52#6 [ 3; |ACABA; |FINSI;
     |FINSI;

     #12#0 = #52#75;
     |LEE 000#12=;
     |SI FSalida ! 0; |DDEFECTO #12; |FINSI;

     |SI #0#8 = "N";
          |SI #52#6 = 1;
               |||ACABA;
          |SINO;
               |SI #12#5 = "A"; |ACABA; |FINSI;
          |FINSI;
     |SINO;
          |SI #52#6 = 1;
               |||SI #12#5 ! "A"; |ACABA; |FINSI;
          |FINSI;
     |FINSI;
     enTipo = 2;
     |PRINT;
|FPRC;

|DEFBUCLE ReservasAnula;
     #52#6;
     43, 6, 20, 89;
     #0#0, 0000000, #0#2, #0#4, #0#6, aDFac;
     #0#1, 9999999, #0#3, #0#5, #0#7, aHFac;
     ;
     NULL, ReservasAnula;
|FIN;

|DEFBUCLE ReservasAnulaApi;
     #52#6;
     43, 6, 20, 146;
     #0#0, 0000000, #0#2, #0#4, #0#6, aDFac;
     #0#1, 9999999, #0#3, #0#5, #0#7, aHFac;
     ;
     NULL, ReservasAnula;
|FIN;

|PROCESO ReservasVta;
     |SI #0#10 = 2; || Apis
          |SI #52#6 [ 3; |ACABA; |FINSI;
     |FINSI;

     #12#0 = #52#75;
     |LEE 000#12=;
     |SI FSalida ! 0; |DDEFECTO #12; |FINSI;

     |SI #0#8 = "N";
          |SI #52#6 = 1;
               |||ACABA;
          |SINO;
               |SI #12#5 = "A"; |ACABA; |FINSI;
          |FINSI;
     |SINO;
          |SI #52#6 = 1;
               |||SI #12#5 ! "A"; |ACABA; |FINSI;
          |FINSI;
     |FINSI;
     enTipo = 1;
     |PRINT;
|FPRC;

|DEFBUCLE ReservasVta;
     #52#5;
     43, 6, 20, 83;
     #0#0, 0000, 0000000, #0#2, #0#4, #0#6, aDFac;
     #0#1, 9999, 9999999, #0#3, #0#5, #0#7, aHFac;
     ;
     NULL, ReservasVta;
|FIN;

|DEFBUCLE ReservasVtaApi;
     #52#5;
     43, 6, 20, 143;
     #0#0, 0000, 0000000, #0#2, #0#4, #0#6, aDFac;
     #0#1, 9999, 9999999, #0#3, #0#5, #0#7, aHFac;
     ;
     NULL, ReservasVta;
|FIN;

|PROCESO T3; |TIPO 3;
     aInforme = #57#17; |QBF aInforme;
     Impresora = "CrystalReport";
     |IMPRE -1;
     |SI FSalida = 0;
          |INFOR aInforme;
          |SI FSalida = 0;
               aDFac = #0#9;
               aHFac = #0#9;
               |SI #0#9 = "T"
                    aDFac = " ";
                    aHFac = "z";
               |FINSI;
               |ABRE #12;
               |SI #0#10 = 1;
                    |BUCLE ReservasVta;
                    |BUCLE ReservasAnula;
               |SINO;
                    |BUCLE ReservasVtaApi;
                    |BUCLE ReservasAnulaApi;
               |FINSI;
               |CIERRA #12;
               |PIEINF;
               |FININF;
          |SINO;
               aAlfa = "0000Error en informe '" + aInforme + "'...";
               |MENAV aAlfa;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO Rellena; |TIPO 0;
     aAlfa = #0Campo; |QBF aAlfa;
     |SI aAlfa ! "";
          aAlfa = "000000" + aAlfa;
          aAlfa = aAlfa % -106;
          #0Campo = aAlfa; |PINTA #0Campo;
     |FINSI;
|FPRC;

|PROCESO DTipoVenta; |TIPO 0;
     |SI #0#10 = 2; |Y #0#4 [ 3;
          |MENAV "0000Tipo venta no permitido para Apis.";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO AgeApis; |TIPO 0;
     |SI #0#10 = 2;
          #0#4 = 4; |PINTA #0#4;
          #0#5 = 5; |PINTA #0#5;
     |FINSI;
|FPRC;

|PROCESO LogoPanta;
     eaNomLogo = #100#1;
     |HAZ TraeLogoPan;
     enPantaLogo = nPanta;
     |HAZ PintaLogoPan;
|FPRC;

|PROGRAMA;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     |ABRE #57; |LEE 000#57p; |CIERRA #57;
     |PINPA #0#0; nPanta = FSalida;
     |PINDA #0#0;
     |HAZ LogoPanta;
     |ENDATOS #1#0;
|FPRO;
