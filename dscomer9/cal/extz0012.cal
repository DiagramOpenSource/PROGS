|FICHEROS;
     extz0012 #0;
     extw0004 #4;   ||Tmp Marcados
     extm0013 #13;
     extm0014 #14;
     extm0018 #18;
|FIN;

|VARIABLES;
     &eaSerie = "";
     &enNumero = 0;
     &eaNumSer = "";
     aParam = "";
     aAlfa = "";
     nHay = 0;
|FIN;

|PROCESO Lineas;
     |SI aParam = "";
          aAlfa = #14#2;
          |SI aAlfa = ""; |O #14#2 = #0#2;
               |SI #14#24 = "S";
                    aAlfa = #14#2; |QBF aAlfa;
                    aAlfa = "0000N¨Reimprimir etiqueta N§ serie:" + aAlfa + "?";
                    |CONFI aAlfa;
               |SINO;
                    FSalida = 0;
               |FINSI;
               |SI FSalida = 0;
                    #14#24 = "S";
                    |PRINT;
                    |PIEINF;
               |FINSI;
          |FINSI;
     |SINO;
          #4#1 = #14#0;
          #4#2 = #14#1;
          #4#3 = #14#2;
          |LEE 000#4=;
          |SI FSalida = 0; |Y #4#0 = "*";
               |SI #14#24 = "S";
                    aAlfa = #14#2; |QBF aAlfa;
                    aAlfa = "0000N¨Reimprimir etiqueta N§ Serie:" + aAlfa + "?";
                    |CONFI aAlfa;
               |SINO;
                    FSalida = 0;
               |FINSI;
               |SI FSalida = 0;
                    #14#24 = "S";
                    |PRINT;
                    |PIEINF;
               |FINSI;
          |FINSI;
     |FINSI;
     |GRABA 020#14a;
|FPRC;

|DEFBUCLE Lineas;
     #14#1;
     ;
     #0#0, #0#1, "                    ";
     #0#0, #0#1, "zzzzzzzzzzzzzzzzzzzz";
     be;
     NULL, Lineas;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |ABRE #18; |LEE 000#18p; |CIERRA #18;

     |ABRE #4;
||     Impresora = "Crystal Reports";
     |IMPRE 0;
     |SI FSalida = 0;
          aAlfa = #18#12; |QBF aAlfa;
          |INFOR aAlfa;
          |SI FSalida = 0;
               |BUCLE Lineas;
               |FININF;
          |SINO;
               aAlfa = "0000Error en informe:" + aAlfa;
               |MENAV aAlfa;
          |FINSI;
          |FINIMP;
     |FINSI;
     |CIERRA #4;
|FPRC;

|PROCESO Min;
     #14#0 = #0#0;
     #14#1 = #0#1;
     #14#2 = "                    ";
|FPRC;

|PROCESO Max;
     #14#0 = #0#0;
     #14#1 = #0#1;
     #14#2 = "zzzzzzzzzzzzzzzzzzzz";
|FPRC;

|PROCESO Tipo66; |TIPO 66;
     |ABRE #14;
     #14#0 = #0#0;
     #14#1 = #0#1;
     #14#2 = #0#2;
     |LEE 000#14];
     |CONSULTA_F_CLAVE #1#14, Min, Max;
     |SI FSalida = 0;
          #0#2 = #14#2; |PINTA #0#2;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #14;
|FPRC;

|PROGRAMA;
     aParam = PARAMETRO;
     |SI enNumero = 0;
          |PINPA #0#0;
          |PINDA #0#0;
          |ENDATOS #1#0;
     |SINO;
          |SI aParam ! "";
               |NOME_DAT #4 aParam;
          |FINSI;
          #0#0 = eaSerie;
          #0#1 = enNumero;
          #0#2 = eaNumSer;
          |HAZ Tipo3;
     |FINSI;
|FPRO;
