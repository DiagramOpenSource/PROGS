|FICHEROS;
     palmhz03 #0;
     palmhm02 #2;
     agifa019 #19;
     agifa029 #29;  || Alma
     dsm00055 #55;
     agifa077 #77;
     agifa080 #80;
     dsm00233 #233; || Tipo Alma
     agifa502 #502;
|FIN;

|VARIABLES;
     &enTipo = 0;
     fFecha = @;
     aDFecha = "";
     aHFecha = "";
     aFechaAnt = "";
     f = @;
     aMes = "";
     aAlfa = "";
     aUltMes = "";
     nMes = 0;
     nA¤o = 0;
|FIN;

|PROCESO palmhm02;
     |PRINT;
|FPRC;

|DEFBUCLE palmhm02;
     #2#2;
     ;
     #0#1;
     #0#1;
     ;
     NULL, palmhm02;
|FIN;

|PROCESO dsm00055;
     |DDEFECTO #19;
     #19#0 = #55#0;
     |LEE 000#19=;

     |DDEFECTO #29;
     #29#0 = #19#161;    || Alma compras
     |LEE 000#29=;
     |SI #29#6 = #0#2;   || Alma banquete
          |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE dsm00055;
     #55#1;
     ;
     "     ", 000001, 00001;
     "zzzzz", 999999, 99999;
     ;
     NULL, dsm00055;
|FIN;

|PROCESO agifa080;
     |DDEFECTO #29;
     #29#0 = #80#3;
     |LEE 000#29=;
     |SI #29#6 = #0#3; |O #29#6 = #0#2;
          enTipo = 4;
     |SINO;
          enTipo = 7;
     |FINSI;
     |PRINT;
|FPRC;

|DEFBUCLE agifa077;
     #77#3;
     ;
     "      ", aDFecha, "     ", 000001;
     "zzzzzz", aHFecha, "zzzzz", 999999;
     ;
     NULL, NULL,  agifa080;
|FIN;

|PROCESO agifa502;
     |PRINT;
|FPRC;

|DEFBUCLE agifa502;
     #502#3;
     ;
     aDFecha, "   ", "                    ";
     aHFecha, "zzz", "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, agifa502;
|FIN;

|PROCESO DefA¤o; |TIPO 7;
     |SI #0#1 = 0;
          fFecha = ~;
          #0#1 = (A\(fFecha % -104));
     |FINSI;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     Impresora = "Crystal Reports";
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "palmhz03";
          |SI FSalida = 0;
               aDFecha = (A\("01.01." + #0#1));
               aHFecha = (A\("31.12." + #0#1));

               enTipo = 2;
               |BUCLE agifa502;

               |ABRE #29;

               ||enTipo =
               |BUCLE agifa077;

               enTipo = 5;
               |ABRE #19;
               |BUCLE dsm00055;
               |CIERRA #19;

               |CIERRA #29;

               |SI #0#4 = "S";
                    enTipo = 6;
                    |BUCLE palmhm02;
               |FINSI;

               |PIEINF;
               |FININF;
          |SINO;
               |MENAV "0000Error en informe 'palmhz03'";
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
