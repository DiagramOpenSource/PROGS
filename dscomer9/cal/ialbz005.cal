|FICHEROS;
     agifa010 #10;
     ialbm014 #14;
     ialbm015 #15;
     ialbm016 #16;
     agifa019 #19;
     agifa071 #71;
     agifa024 #24;
|FIN;

|VARIABLES;
     &eaSerie = "";
     &enCodigo = 0;
     nPrecio = 0;
     aAlfa = "";
     nHay = 0;
|FIN;

|PROCESO CheqLineas;
     #14#0 = #71#2;
     |LEE 000#14=;
     |SI FSalida = 0;
          nHay = 1;
     |FINSI;
|FPRC;

|PROCESO Lineas;
     #14#0 = #71#2;
     |LEE 000#14=;
     |SI FSalida = 0;
          |DDEFECTO #19;
          #19#0 = #14#1;
          |LEE 000#19=;

          #16#0 = #15#0;
          #16#1 = #15#1;
          #16#2 = #71#1;
          #16#3 = #19#0;
          #16#4 = #19#1;
          #16#5 = #71#49;
          #16#6 = #71#5;
          |SI #24#39 = 1; nPrecio = #19#18; |FINSI;
          |SI #24#39 = 2; nPrecio = #19#19; |FINSI;
          |SI #24#39 = 3; nPrecio = #19#20; |FINSI;
          |SI #24#39 = 4; nPrecio = #19#147; |FINSI;
          |SI #24#39 = 5; nPrecio = #19#148; |FINSI;
          |SI #24#39 = 6; nPrecio = #19#149; |FINSI;
          #16#7 = nPrecio;
          #16#8 = #16#6 * #16#7;
          |GRABA 020#16n;
     |FINSI;
|FPRC;

|PROCESO Cabecera;
     #15#0 = #10#52;
     #15#1 = #10#0;
     #15#2 = #10#1;
     #15#3 = #10#3;
     #15#4 = #10#6;
     |GRABA 020#15b;
|FPRC;

|PROCESO Imprime;
     |PRINT;
|FPRC;

|PROGRAMA;
     |ABRE #15;
     #15#0 = eaSerie;
     #15#1 = enCodigo;
     |LEE 101#15=;
     |SI FSalida = 0;
          |BUCLELIN 1 NULL #15;
          |BORRA 020#15a;
     |FINSI;
     |SI PARAMETRO ! "BAJA";
          |ABRE #19;
          |ABRE #16;
          |ABRE #14;
          |ABRE #10;
          |ABRE #24;
          #10#52 = eaSerie;
          #10#0 = enCodigo;
          |LEE 020#10=;
          |SI FSalida = 0;
               |DDEFECTO #24;
               #24#0 = #10#3;
               |LEE 000#24=;

               nHay = 0;
               |BUCLELIN 2 CheqLineas #10;
               |SI nHay ! 0;
                    |HAZ Cabecera;
                    |BUCLELIN 2 Lineas #10;

                    |LIBERA #15;
                    |SI PARAMETRO ! "NOIMP";
                         aAlfa= "0000NSe ha generado una propuesta de mantenimiento."+&13+"¿Desea imprimirla?";
                         |CONFI aAlfa;
                         |SI FSalida = 0;
                              |IMPRE 0;
                              |SI FSalida = 0;
                                   |INFOR "ialbm015";
                                   |SI FSalida = 0;
                                        |BUCLELIN 2 Imprime #15;
                                        |PIEINF;
                                        |FININF;
                                   |SINO;
                                        |MENAV "0000No existe informe 'ialbm015'";
                                   |FINSI;
                                   |FINIMP;
                              |FINSI;
                         |FINSI;
                    |FINSI;
               |FINSI;
          |FINSI;
          |CIERRA #24;
          |CIERRA #10;
          |CIERRA #14;
          |CIERRA #16;
          |CIERRA #19;
     |FINSI;
     |CIERRA #15;
|FPRO;
