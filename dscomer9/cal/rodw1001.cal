|FICHEROS;
     rodw0001 #0;
     rodm0001 #1;
     rodm0002 #2;
     rodm0003 #3;
     rodw0007 #6;
     agifa007 #7;
     agifa010 #10;
     agifa019 #19;
     agifa017 #17;
     agifa024 #24;
     agifa027 #27;
     dsm00043 #43;
     dsm00044 #44;
     agifa065 #65;
     agifa071 #71;
     agifa142 #142;
     agif0041 #1000;

     refer10@ #1010;
     refer71@ #1071;
|FIN;

|CAMPOS;
     #19#15  art_pser;  #17#42  alm_pser;
     #19#182 art_pser2; #17#44  alm_pser2;
     #19#16  art_prec;  #17#43  alm_prec;
     #19#183 art_prec2; #17#45  alm_prec2;
     #19#17  art_pval;  #17#4   alm_pval;
     #19#11  art_nece;  #17#50  alm_nece;
     #19#12  art_rese;  #17#8   alm_rese;
     #19#14  art_depo;  #17#10  alm_depo;
     #19#184 art_depo2; #17#46  alm_depo2;
     #19#13  art_fabr;  #17#9   alm_fabr;
     #19#10  art_vsto;  #17#3   alm_vsto;
     #19#7   art_mini;  #17#6   alm_mini;
     #19#8   art_maxi;  #17#7   alm_maxi;
     #19#6   art_tota;  #17#5   alm_tota;
     #19#185 art_tota2; #17#47  alm_tota2;
     #19#104 art_disp;  #17#39  alm_disp;
     #19#193 art_disp2; #17#48 alm_disp2;
     #19#9   art_pcm;   #17#69 alm_pcm;
|FIN;

|VARIABLES;
     &eaParametro = "";
     &enSwEjecuta = 0;
     &enEmpresa = 0;
     &enSwNoCopia = 0;  || Para el control de empresas
     &eaSerRodAnt = "";
     &eaTipRodAnt = "";
     &enError = 0;

     &enSwMenu = 0;
     &eaSerie = "";
     &enCodigo = 0;
     &enModo = 0;
     &enForma = 0;

     &enImpCliPen = 0;
     &efFecha = @;
     &eaCliente = "";

     &eaTag = "";

     aExpor = "";
     nPideDatos = 0;
     nModo = 0;
     aSer = "";
     aNum = "";
     aParam = "";
     aEmp = "";
     nEmp = 0;
     aAlfa = "";
     aAlf1 = "";
     aAlf2 = "";
     aDef = "";
     nError = 0;
     aPathDes = "";
     aPathOrg = "";
     nAbo = 0;
     nImpo = 0;
     nUni = 0;
     nUni0 = 0;
     nUni2 = 0;
     nNume = 0;
     nReg = 0;
|FIN;

|PROCESO Stock_ESSS;
     |SI #44#7 = "E"; nUni = #44#4;   |SINO; nUni  = -#44#4;  |FINSI;
     |SI #44#7 = "E"; nUni2 = #44#12; |SINO; nUni2 = -#44#12; |FINSI;
     nUni = nUni * enForma;
     nUni2 = nUni2 * enForma;
     |SI #19#196 = 1; nUni0 = nUni; |SINO; nUni0 = nUni2; |FINSI;

     art_tota = art_tota + nUni;
     art_tota2 = art_tota2 + nUni2;
     art_disp = art_disp + nUni;
     art_disp2 = art_disp2 + nUni2;

     alm_tota = alm_tota + nUni;
     alm_tota2 = alm_tota2 + nUni2;
     alm_disp = alm_disp + nUni;
     alm_disp2 = alm_disp2 + nUni2;

     aAlfa = #44#5 % 402;
     nNume = aAlfa;
     nNume = (nNume - 1) * 2;
     |SI #44#7 = "E";
          |SI #19#196 = 1; nUni0 = nUni; |SINO; nUni0 = nUni2; |FINSI;
          nNume = nNume + 12;
          #17#36 = #17#36 + nUni0;
     |SINO;
          |SI #19#194 = 1; nUni0 = -nUni; |SINO; nUni0 = -nUni2; |FINSI;
          nNume = nNume + 11;
          #17#35 = #17#35 + nUni0;
     |FINSI;
     #17nNume = #17nNume + nUni0;
|FPRC;

|PROCESO Histo_ESSS;
     |ABRE #65;
     |DDEFECTO #65;
     #65#0 = #44#0;
     #65#1 = #44#5;
     |SI #44#7 = "E";
          #65#2 = "ES";
          #65#6 = #44#4;
          #65#17 = #44#12;
     |SINO;
          #65#2 = "SS";
          #65#6 = -#44#4;
          #65#17 = -#44#12;
     |FINSI;
     #65#3 = #44#18;
     #65#4 = #44#8;
     #65#5 = #44#1;
     #65#7 = #19#6;
     #65#8 = #19#9;
     #65#11 = #44#21;
     #65#18 = #44#13;
     #65#19 = #44#14;
     |SI enForma = 1;
          |GRABA 020#65n;
     |SINO;
          |BORRA 020#65c;
     |FINSI;
     |CIERRA #65;
|FPRC;

|PROCESO LinRegu;
     |DDEFECTO #19;
     #19#0 = #71#2;
     |LEE 101#19=;
     |SI FSalida ! 0; |GRABA 020#19b; |FINSI;
     |DDEFECTO #17;
     #17#0 = #71#2;
     #17#1 = #71#3;
     |LEE 101#17=;
     |SI FSalida ! 0; |GRABA 020#17b; |FINSI;
     |DDEFECTO #44;
     #44#0 = #71#2;
     #44#1 = #71#3;
     #44#2 = #71#4;
     #44#3 = #17#39;
     #44#4 = #71#5;
     #44#5 = #43#1;
     #44#6 = #19#6;
     #44#7 = "S";
     #44#8 = #71#1;
     #44#12 = #71#48;
     #44#13 = #71#49;
     #44#14 = #71#50;
     #44#15 = #71#51;
     #44#16 = #71#52;
     #44#17 = #71#53;
     #44#18 = #43#0;
     #44#19 = #17#5;
     #44#20 = #19#104;
     #44#21 = #43#4;
     #44#22 = #19#185;
     #44#23 = #17#47;
     #44#24 = #19#193;
     #44#25 = #17#48;
     |GRABA 020#44n;
     |HAZ Histo_ESSS;
|FPRC;

|PROCESO BloqRegu;
     |DDEFECTO #43;
     #43#4 = #0#1;
     #43#0 = #0#5;
     #43#1 = #10#1;
     |GRABA 000#43b;
     nError = FSalida;
     |SI FSalida ! 0;
          aAlfa = ("000000" + #43#0) % -106;
          aAlfa = "0000Movimiento de Regularizacion Existente:" + #43#4 + "/" + aAlfa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO NuevaLin;
     |SALVA_DATOS #71;
     |REPON_DATOS #refer71@;
     #refer71@#29 = #refer10@#52;
     #refer71@#0 = #refer10@#0;
     |SI aExpor = "S";
          #refer71@#11 = 0;
     |FINSI;
     #refer71@#19 = "N";           ||Quitamos marca adj. pedido!!!
     |GRABA 020#refer71@.n;

     |SALVA_DATOS #refer71@;
     |REPON_DATOS #71;
     enForma = 1;
     |HAZ AcumulaAV;
|FPRC;

|PROCESO NuevaCab;
     |SALVA_DATOS #10;
     |REPON_DATOS #refer10@;
     #refer10@#52 = #0#1;
     #refer10@#0 = #0#5;
     |DFICE aAlf1;
     aAlf1 = aAlf1 % -205;
     aAlf2 = ("00000" + #43#0) % -106;
     aAlfa = aAlf1 + "/" + #43#4 + "/" + aAlf2;
     #refer10@#57 = aAlfa;
     #refer10@#41 = 0;             ||Quitamos marca adj. pedido!!!
     |GRABA 000#refer10@.b;
     nError = FSalida;
     |SI FSalida ! 0;
          aAlfa = ("000000" + #refer10@#0) % -106;
          aAlfa = "0000Existe el Albaran en la empresa destino:" + #refer10@#52 + "/" + aAlfa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO CopiaAlb;
     |SI #0#2 = "M";
          #0#5 = #10#0;  || Contador
     |SINO;
          |SALVA_DATOS #10;
          |CIERRA #10;
          |PATH_DAT #10 aPathDes;
          |PATH_DAT #27 aPathDes;
          |PATH_DAT #142 aPathDes;
          |ABRE #10;
          #10#52 = #0#1;
          enSwMenu = 1;
          |HAZ ContaAV7;
          #0#5 = #10#0;  || Contador
          |CIERRA #10;
          |PATH_DAT #10 aPathOrg;
          |PATH_DAT #27 aPathOrg;
          |PATH_DAT #142 aPathOrg;
          |ABRE #10;
          |REPON_DATOS #10;
          |LEE 121#10=;
     |FINSI;

     |DDEF aDef;
     aAlfa = aDef + "agifa010";
     |CARGA_DEF aAlfa, refer10@;
     |SI FSalida = 0;
          aAlfa = aDef + "agifa071";
          |CARGA_DEF aAlfa, refer71@;
          |SI FSalida = 0;
               |PATH_DAT #7 aPathDes;
               |ABRE #7;
               #7#26 = #0#1;
               |LEE 000#7=;
               |CIERRA #7;
               |PATH_DAT #7 aPathOrg;
               aExpor = #7#30;

               |PATH_DAT #1010 aPathDes;
               |PATH_DAT #1071 aPathDes;
               |ABRE #refer71@;
               |ABRE #refer10@;

               |HAZ BloqRegu;
               |SI nError = 0;
                    |HAZ NuevaCab;
                    |SI nError = 0;
                         |BUCLELIN 2 NuevaLin #10;
                    |SINO;
                         |BORRA 020#43c; ||Borra Regu.
                    |FINSI;
               |FINSI;
               |CIERRA #refer10@;
               |CIERRA #refer71@;
               |DESCARGA_DEF #refer71@;
          |FINSI;
          |DESCARGA_DEF #refer10@;
     |FINSI;
|FPRC;

|PROCESO Traspaso;
     enForma = 1;
     |ABRE #43;
     |PATH_DAT #65 aPathDes;
     |PATH_DAT #19 aPathDes;
     |PATH_DAT #17 aPathDes;
     |HAZ CopiaAlb;
     |PATH_DAT #65 aPathOrg;
     |PATH_DAT #19 aPathOrg;
     |PATH_DAT #17 aPathOrg;
     |SI nError = 0;
          |ABRE #44;
          |ABRE #19;
          |ABRE #17;
          |BUCLELIN 2 LinRegu #10;
          |CIERRA #17;
          |CIERRA #19;
          |CIERRA #44;
     |FINSI;
     |CIERRA #43;

     |SI nError = 0;
          |ABRE #2;
          #2#0 = #10#52;
          #2#1 = #10#0;
          #2#2 = #10#1;
          #2#3 = ~;
          #2#4 = #0#0;
          #2#5 = #0#1;
          #2#6 = #0#5;
          #2#7 = "T";
          |GRABA 020#2n;
          |CIERRA #2;
     |FINSI;
|FPRC;

|PROCESO BorLinea;
     |BORRA 020#71a;

     #65#0 = #71#2;
     #65#1 = #10#1;
     |SI #10#43 = "S";
          #65#2 = "BV";
     |SINO;
          #65#2 = "AV";
     |FINSI;
     #65#3 = #71#0;
     #65#4 = #71#1;
     #65#11 = #71#29;
     |BORRA 020#65c;
|FPRC;

|PROCESO AcumuCli;
     |SI #10#15 ] 0;
          nAbo = 1;
     |SINO;
          nAbo = -1;
          #10#15 = -#10#15;
     |FINSI;
     nImpo = #10#15 < #10#5;
     nImpo = nImpo < #10#32;
     nImpo = nImpo < #10#7;
     nImpo = nImpo * nAbo * enForma;

     |ABRE #24;
     #24#0 = #10#3;
     |LEE 101#24=;
     |SI FSalida ! 0; |GRABA 020#24b; |FINSI;
     |SI #10#43 = AN;
          #24#50 = #24#50 + nImpo;    || es albaran
     |SINO;
          #24#50 = #24#50 - nImpo;    || es abono
     |FINSI;
     |GRABA 020#24a;
     |CIERRA #24;

     |SI #10#43 = "N";
          enImpCliPen = nImpo;
     |SINO;
          enImpCliPen =  -nImpo;
     |FINSI;
     eaCliente = #10#3;
     efFecha = #10#1;
||     |HAZ AcumulaCli;  NO FUNCIONA AL GRABAR EL DESTINO
|FPRC;

|PROCESO RecalNueAlb;
|FPRC;

|PROCESO Alta;
     enError = 1;

     aEmp = #1#1;
     |HAZ CheqEmp;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SI #10#38 = "S";
          |MENAV "0000Albaran Facturado...";
          |ACABA;
     |FINSI;

     |HAZ RodCheqAlb;
     |SI FSalida ! 0;
          #0#1 = #7#26;
          #0#2 = #1#3;
          #0#0 = #1000#0;
          #0#3 = #1000#1;
          #0#4 = #7#27;
          #0#6 = eaSerie;
          #0#7 = enCodigo;

          nPideDatos = 0; || Solo pide datos en el 1 albaran

          |SI enSwEjecuta = 1;     || cuando llama rodw0004
               #0#1 = eaSerRodAnt;
               #0#2 = eaTipRodAnt;
               nPideDatos = 1;
          |FINSI;

          |SI aParam = "MASIVO"; |Y eaSerRodAnt ! "";
               nPideDatos = 1;
               #0#1 = eaSerRodAnt;
               #0#2 = eaTipRodAnt;
          |FINSI;
          |SI nPideDatos = 0;
               |BLANCO 713 1771;
               |PINPA #0#0;
               |PINDA #0#0;
               |ENDATOS #1#0;
               nError = FSalida;
          |SINO;
               FSalida = 0;
          |FINSI;

          |SI FSalida = 0;
               |SI aParam = "MASIVO";eaSerRodAnt=#0#1;eaTipRodAnt=#0#2;|FINSI;
               |DBASE aPathDes;
               aAlfa = ("00000" + #0#0) % -105;
               aPathDes = aPathDes + "fich/" + aAlfa + "/";
               |HAZ Traspaso;
               |SI nError = 0; ||Todo OK, se borra el albaran
                    enError = 0;
                    |BORRA 020#10a;
                    |ABRE #65;
                    |BUCLELIN 0 BorLinea #10;
                    |CIERRA #65;

                    enForma = -1; |HAZ AcumuCli;

                    |CIERRA #10;
                    |PATH_DAT #24 aPathDes;
                    |PATH_DAT #10 aPathDes;
                    |PATH_DAT #71 aPathDes;
                    |PATH_DAT #19 aPathDes;
                    |ABRE #10;
                    #10#52 = #0#1;
                    #10#0 = #0#5;
                    |LEE 121#10=;
                    |SI FSalida = 0;
                         |HAZ LimCabAgifa010
                         |BUCLELIN 0 CalCabAgifa010 #10;
                         |GRABA 020#10a;
                    |FINSI;
                    enForma = 1; |HAZ AcumuCli;
                    |CIERRA #10;
                    |PATH_DAT #24 aPathOrg;
                    |PATH_DAT #10 aPathOrg;
                    |PATH_DAT #71 aPathOrg;
                    |PATH_DAT #19 aPathOrg;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO ModiLinReg;
     |SI enForma = 1;
          |HAZ LinRegu;
     |SINO;
          #44#21 = #43#4;
          #44#18 = #43#0;
          #44#8 = #71#1;
          |LEE 000#44=;
          |SI FSalida = 0;
               |HAZ Histo_ESSS;
               FSalida = 0;
          |FINSI;
     |FINSI;
     |SI FSalida ! 0; |ACABA; |FINSI;

     #19#0 = #71#2;
     |LEE 101#19=;
     |SI FSalida ! 0; |GRABA 020#19b; |FINSI;
     #17#0 = #71#2;
     #17#1 = #71#3;
     |LEE 101#17=;
     |SI FSalida ! 0; |GRABA 020#17b; |FINSI;
     |HAZ Stock_ESSS;
     |HAZ ValoraStock;
     |GRABA 020#19a;
     |GRABA 020#17a;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Borrados;
     aEmp = ("00000" + enEmpresa) % -105;
     |DBASE aPathDes;
     aPathDes = aPathDes + "fich/" + aEmp + "/";

     |PATH_DAT #6 aPathDes;

     |ABRE #6;
     |LEE 000#6];
     |SI FSalida = 0; nReg = #6#0 + 1; |SINO; nReg = 1; |FINSI;
     #6#0 = nReg;
     #6#1 = eaSerie;
     #6#2 = enCodigo;
     |GRABA 040#6n;
     |CIERRA #6;
     enError = 0;
|FPRC;

|PROCESO Modi;
     nModo = enModo;
     aAlfa = #10#57; |QBF aAlfa;
     |SI aAlfa = ""; |ACABA; |FINSI;
     aEmp = aAlfa % 105;
     aSer = aAlfa % 705;
     aNum = aAlfa % 1306;

     |HAZ CheqEmp;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |DBASE aPathDes;
     aPathDes = aPathDes + "fich/" + aEmp + "/";

     |PATH_DAT #2 aPathDes;
     |PATH_DAT #43 aPathDes;
     |PATH_DAT #44 aPathDes;
     |PATH_DAT #19 aPathDes;
     |PATH_DAT #17 aPathDes;
     |PATH_DAT #65 aPathDes;
     |ABRE #2;
     |SELECT #2#2;
     #2#5 = aSer;
     #2#6 = aNum;
     |LEE 101#2=;
     |SI FSalida = 0; |Y nModo = 3;
          #2#7 = "B";
          |GRABA 020#2a;
     |FINSI;
     |CIERRA #2;
     |ABRE #43;
     |ABRE #44;
     |ABRE #19;
     |ABRE #17;
     #43#4 = aSer;
     #43#0 = aNum;
     |LEE 101#43=;
     |SI enForma = 1;
          |SI FSalida ! 0; |GRABA 020#43n; |FINSI;
          |ABRE #44;
          |BUCLELIN 2 ModiLinReg #10;
          |CIERRA #44;
     |SINO;
          |SI FSalida = 0;
               |ABRE #44;
               |BUCLELIN 0 ModiLinReg #10;
               |CIERRA #44;
               |BUCLELIN 1 NULL #43;
               |SI nModo = 3;
                    |BORRA 020#43a;
               |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #17;
     |CIERRA #19;
     |CIERRA #44;
     |CIERRA #43;
     |PATH_DAT #2 aPathOrg;
     |PATH_DAT #43 aPathOrg;
     |PATH_DAT #44 aPathOrg;
     |PATH_DAT #19 aPathOrg;
     |PATH_DAT #17 aPathOrg;
     |PATH_DAT #65 aPathOrg;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO CheqEmp;
     nEmp = aEmp;
     aEmp = ("00000" + nEmp) % -105;
     |DBASE aAlfa; aAlfa = aAlfa + "fich/";
     |PATH_DAT #1000 aAlfa;
     |ABRE #1000;
     #1000#0 = aEmp;
     |LEE 000#1000=;
     aAlf1 = FSalida;
     |SI FSalida ! 0;
          aAlfa = "0000No existe Empresa Traspaso: " + aEmp;
          |MENAV aAlfa;
     |FINSI;
     |CIERRA #1000;
     FSalida = aAlf1;
|FPRC;

|PROCESO GrabaCola;
     |SI aParam = "MODI";
          aAlfa = #10#57; |QBF aAlfa;
          |SI aAlfa = ""; |ACABA; |FINSI;
          aEmp = aAlfa % 105;
          |HAZ CheqEmp;
          |SI FSalida ! 0; |ACABA; |FINSI;
     |SINO;
          enModo = 1;
          enForma = 1;
          aEmp = #1#1;
          |HAZ CheqEmp;
          |SI FSalida ! 0; |ACABA; |FINSI;
          |SI #10#38 = "S";
               |MENAV "0000Albaran Facturado...";
               |ACABA;
          |FINSI;
          |HAZ RodCheqAlb;
          |SI FSalida = 0; |ACABA; |FINSI;

          #0#1 = #7#26;
          #0#2 = #1#3;
          #0#0 = #1000#0;
          #0#3 = #1000#1;
          #0#4 = #7#27;
          #0#6 = eaSerie;
          #0#7 = enCodigo;
          nPideDatos = 0; || Solo pide datos en el 1 albaran
          |SI aParam = "MASIVO"; |Y eaSerRodAnt ! "";
               nPideDatos = 1;
               #0#1 = eaSerRodAnt;
               #0#2 = eaTipRodAnt;
          |FINSI;
          |SI nPideDatos = 0;
               |BLANCO 713 1771;
               |PINPA #0#0;
               |PINDA #0#0;
               |ENDATOS #1#0;
               |SI FSalida ! 0; |ACABA; |FINSI;
          |FINSI;
     |FINSI;
     |SI aParam = "MASIVO";eaSerRodAnt=#0#1;eaTipRodAnt=#0#2;|FINSI;
     |ABRE #3;
     |LEE 000#3u;
     |SI FSalida = 0; nReg = #3#13 + 1; |SINO; nReg = 1; |FINSI;
     |DDEFECTO #3;
     #3#0 = eaSerie;
     #3#1 = enCodigo;
     #3#2 = aParam;
     aAlfa = Usuario % 810;
     #3#3 = aAlfa;
     #3#4 = ~;
     |HORA aAlfa;
     #3#5 = aAlfa;
     #3#6 = #0#1;
     #3#7 = #0#2;
     #3#12 = aEmp;
     #3#13 = nReg;
     #3#14 = enModo;
     #3#15 = enForma;

     |DFICE aAlfa;
     aAlfa = aAlfa % 205;
     |SI aAlfa = aEmp;
          |MENAV "0000ERROR,la empresa destino es la original...";
     |SINO;
          |GRABA 020#3n;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO Inicio;
     aParam = PARAMETRO;

     |ABRE #1; |LEE 000#1p; |CIERRA #1;

     |ABRE #7;
     #7#26 = #1#2;
     |LEE 000#7=;
     |CIERRA #7;

     |DFICE aPathOrg;

     |ABRE #10;
     #10#52 = eaSerie;
     #10#0 = enCodigo;
     |LEE 101#10=;
     enError = FSalida;
     |SI FSalida ! 0;
          ||enSwEjecuta = 1 cuando llama rodw0004
          |SI enSwEjecuta = 1;
               |SI aParam = "MODI"; |HAZ Borrados; |FINSI;
          |FINSI;
     |SINO;
          |SI #1#4 = "N"; |Y enSwEjecuta = 0;
               |HAZ GrabaCola;
          |SINO;
               enSwNoCopia = 1; || Desactiva la copia de cliente y articulo
                                || del control de empresas (dsz99948, dsz99949)
               || Llamada desde agifa010, agifa210
               |SI aParam = "ALTA"; |HAZ Alta; |FINSI;

               || Llamada desde agifa010
               |SI aParam = "MODI"; |HAZ Modi; |FINSI;

               || Llamada desde agifa057
               |SI aParam = "MASIVO"; |HAZ Alta; |FINSI;

               enSwNoCopia = 0; || Activa otra vez
          |FINSI;
     |FINSI;
     |CIERRA #10;
|FPRC;


|PROCESO Inicio1;             || Llamado por rodw0004
     aParam = eaParametro;

     |ABRE #1; |LEE 000#1p; |CIERRA #1;

     |ABRE #7;
     #7#26 = #1#2;
     |LEE 000#7=;
     |CIERRA #7;

     |DFICE aPathOrg;

     |ABRE #10;
     #10#52 = eaSerie;
     #10#0 = enCodigo;
     |LEE 101#10=;
     enError = FSalida;
     |SI FSalida ! 0;
          ||enSwEjecuta = 1 cuando llama rodw0004
          |SI enSwEjecuta = 1;
               |SI aParam = "MODI"; |HAZ Borrados; |FINSI;
          |FINSI;
     |SINO;
          |SI #1#4 = "N"; |Y enSwEjecuta = 0;
               |HAZ GrabaCola;
          |SINO;
               enSwNoCopia = 1; || Desactiva la copia de cliente y articulo
                                || del control de empresas (dsz99948, dsz99949)
               || Llamada desde agifa010, agifa210
               |SI aParam = "ALTA"; |HAZ Alta; |FINSI;

               || Llamada desde agifa010
               |SI aParam = "MODI"; |HAZ Modi; |FINSI;

               || Llamada desde agifa057
               |SI aParam = "MASIVO"; |HAZ Alta; |FINSI;

               enSwNoCopia = 0; || Activa otra vez
          |FINSI;
     |FINSI;
     |CIERRA #10;
|FPRC;
