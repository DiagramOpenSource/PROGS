|FICHEROS;
     malpz002 #0;
     malpe001 #1;
     malpe087 #87;
     malpe088 #88;
|FIN;

|VARIABLES;
     nPend = 0;
     aReg = "";
     aTitulo = "";
     aTexto = "";
     aAlfa = "";
     aFic = "";
     aDato = "";
     aRelleno = "";
     nHandle = 0;
     nPos = 0;
     nLon = 0;
|FIN;

|PROCESO PonDato;
     aRelleno = " " * nLon;
     nPos = -1 * (100 + nLon);
     aDato = aRelleno + aAlfa;
     aDato = aDato % nPos;

     aReg = "<" + aTexto + ">" + aDato + "</" + aTexto + ">";
     |XGRABA nHandle, aReg;
|FPRC;

|PROCESO Obras;
     aReg = "<OBRA>";
     |XGRABA nHandle, aReg;

     aAlfa = ("0000" + #1#1) % -104;
     aTexto = "CODIGO";
     nLon = 4;
     |HAZ PonDato;

     aAlfa = #1#2;
     aTexto = "NOMBRE";
     nLon = 40;
     |HAZ PonDato;

     aAlfa = #1#0;
     aTexto = "CLIENTE";
     nLon = 6;
     |HAZ PonDato;

     aAlfa = #1#12;
     aTexto = "RESPONSABLE";
     nLon = 30;
     |HAZ PonDato;

     aAlfa = #1#31;
     aTexto = "JEFEGRUPO";
     nLon = 2;
     |HAZ PonDato;

     aAlfa = #1#11;
     aTexto = "REFERENCIA";
     nLon = 20;
     |HAZ PonDato;

     aAlfa = #1#22;
     aTexto = "TIPOTRANS";
     nLon = 5;
     |HAZ PonDato;

     aAlfa = #1#5;
     aTexto = "DIRECCION";
     nLon = 30;
     |HAZ PonDato;

     aAlfa = #1#25;
     aTexto = "CODPOSTAL";
     nLon = 5;
     |HAZ PonDato;

     aAlfa = #1#6;
     aTexto = "POBLACION";
     nLon = 30;
     |HAZ PonDato;

     aAlfa = #1#7;
     aTexto = "PROVINCIA";
     nLon = 15;
     |HAZ PonDato;

     aAlfa = #1#17;
     aTexto = "DIRFAC";
     nLon = 35;
     |HAZ PonDato;

     aAlfa = #1#26;
     aTexto = "CODPOSTALFAC";
     nLon = 5;
     |HAZ PonDato;

     aAlfa = #1#18;
     aTexto = "POBLACIONFAC";
     nLon = 35;
     |HAZ PonDato;

     aAlfa = #1#19;
     aTexto = "PROVINCIAFAC";
     nLon = 15;
     |HAZ PonDato;

     aAlfa = #1#13;
     aTexto = "TELEFONO";
     nLon = 15;
     |HAZ PonDato;

     aAlfa = #1#14;
     aTexto = "FAX";
     nLon = 15;
     |HAZ PonDato;

     aAlfa = #1#32;
     aTexto = "MOVIL";
     nLon = 15;
     |HAZ PonDato;

     aAlfa = #1#10;
     aTexto = "TELEFONOFAC";
     nLon = 15;
     |HAZ PonDato;

     aAlfa = #1#34;
     aTexto = "FAXFAC";
     nLon = 15;
     |HAZ PonDato;

     aAlfa = #1#35;
     aTexto = "MOVILFAC";
     nLon = 15;
     |HAZ PonDato;

     aAlfa = #1#29;
     aTexto = "MAXSIN1";
     nLon = 6;
     |HAZ PonDato;

     aAlfa = #1#30;
     aTexto = "MAXSIN2";
     nLon = 6;
     |HAZ PonDato;

     aAlfa = #1#16;
     aTexto = "OBSERVACIONES";
     nLon = 40;
     |HAZ PonDato;

     aAlfa = ("000000" + #1#36) % -106;
     aTexto = "EMPRESACRM";
     nLon = 6;
     |HAZ PonDato;

     aAlfa = ("000" + #1#39) % -103;
     aTexto = "OFICINA";
     nLon = 3;
     |HAZ PonDato;

     aAlfa = #1#37;
     aTexto = "COMERCIALCRM";
     nLon = 3;
     |HAZ PonDato;

     aAlfa = #1#38;
     aTexto = "SITUACION";
     nLon = 1;
     |HAZ PonDato;

     aReg = "</OBRA>";
     |XGRABA nHandle, aReg;
|FPRC;

|PROCESO Pedidos;
     nPend = #88#5 - #88#43;

     |SI nPend [ 0; |ACABA; |FINSI;

     aReg = "<PEDIDO>";
     |XGRABA nHandle, aReg;

     aAlfa = #87#4;
     aTexto = "CLIENTE";
     nLon = 6;
     |HAZ PonDato;

     aAlfa = ("0000" + #87#63) % -104;
     aTexto = "OBRA";
     nLon = 4;
     |HAZ PonDato;

     aAlfa = #87#1;
     aTexto = "FECHA";
     nLon = 10;
     |HAZ PonDato;

     aAlfa = #88#2;
     aTexto = "ARTICULO";
     nLon = 20;
     |HAZ PonDato;

     aAlfa = #88#4;
     aTexto = "DESCRIPCION";
     nLon = 50;
     |HAZ PonDato;

     aAlfa = ("00000" + #88#3) % -105;
     aTexto = "ALMACEN";
     nLon = 5;
     |HAZ PonDato;

     aAlfa = #88#5;
     aTexto = "UNIDADES";
     nLon = 9;
     |HAZ PonDato;

     aAlfa = #88#61;
     aTexto = "FENTREGA";
     nLon = 10;
     |HAZ PonDato;

     aAlfa = #88#45;
     aTexto = "LOTE";
     nLon = 15;
     |HAZ PonDato;

     aAlfa = #88#57;
     aTexto = "PALETS";
     nLon = 9;
     |HAZ PonDato;

     aReg = "</PEDIDO>";
     |XGRABA nHandle, aReg;
|FPRC;

|DEFBUCLE Obras;
     #1#1;
     ;
     #0#6, #0#8;
     #0#7, #0#9;
     ;
     NULL, Obras;
|FIN;

|DEFBUCLE Pedidos;
     #87#1;
     1;
     "     ", 000001, #0#5;
     "zzzzz", 999999, "31.12.9999";
     ;
     NULL, NULL, Pedidos;
|FIN;

|PROCESO Inicio;
     |SI #0#3 = "S";
          aFic = #0#1; |QBF aFic;
          |XABRE "CW", aFic, nHandle;
          |SI FSalida ] 0;
               aReg = "<INICIO>";
               |XGRABA nHandle, aReg;
               aReg = "<TITULO>Lineas de Pedidos</TITULO>";
               |XGRABA nHandle, aReg;

               |BUCLE Pedidos;

               aReg = "</INICIO>";
               |XGRABA nHandle, aReg;
               |XCIERRA nHandle;
          |SINO;
               |MENAV "0000No puedo crear el fichero de pedidos.";
          |FINSI;
     |FINSI;
     |SI #0#4 = "S";
          aFic = #0#2; |QBF aFic;
          |XABRE "CW", aFic, nHandle;
          |SI FSalida ] 0;
               aReg = "<INICIO>";
               |XGRABA nHandle, aReg;
               aReg = "<TITULO>Obras</TITULO>";
               |XGRABA nHandle, aReg;

               |BUCLE Obras;
               aReg = "</INICIO>";
               |XGRABA nHandle, aReg;

               |XCIERRA nHandle;
          |SINO;
               |MENAV "0000No puedo crear el fichero de obras.";
          |FINSI;
     |FINSI;
|FPRC;

|PROGRAMA;
     |CLS;
     |ABRE #0;
     |LEE 000#0p;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
     #0#3 = "N";
     #0#4 = "S";
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |HAZ Inicio;
          |GRABA 020#0a;
     |FINSI;
     |CIERRA #0;
|FPRO;
