|FICHEROS;
     odoo0001 #0;
     odoo0004 #4,MANTE;
|FIN;

|VARIABLES;
     nSwInforpor = 0;
     nBtnCarpeta = 0;
     aAlfa = "";
     aRuta = "";
     nConta = 0;
     nHandle = 0;
     aMas = "";
     aMarca = "";
|FIN;

|PROCESO MarcaDefecto;
     |SALVA_FICHA #4;
     |LEE 101#4p;
     |PARA; |SI FSalida = 0; |HACIENDO;
          aMas = #4#0; |QBF aMas;
          aMarca = "";
          |SI aMas = "agifa024"; aMarca = "*"; |FINSI; || Clientes
          |SI aMas = "dsm00003"; aMarca = "*"; |FINSI; || Di.Entrega
          |SI aMas = "agifa091"; aMarca = "*"; |FINSI; || Forma Pago
          |SI aMas = "odoo0005"; aMarca = "*"; |FINSI; || Tipo Facturacion
          ||SI aMas = "agifm001"; aMarca = "*"; |FINSI; || Zonas
          ||SI aMas = "agifm002"; aMarca = "*"; |FINSI; || Rutas

          |SI aMas = "agifa019"; aMarca = "*"; |FINSI; || Articulos
          |SI aMas = "dsl00001"; aMarca = "*"; |FINSI; || CB
          |SI aMas = "agifa553"; aMarca = "*"; |FINSI; || Linea
          |SI aMas = "agifa060"; aMarca = "*"; |FINSI; || Familias
          |SI aMas = "agifa120"; aMarca = "*"; |FINSI; || Subfamilias
          |SI aMas = "agi00063"; aMarca = "*"; |FINSI; || Marca
          |SI aMas = "dsm00116"; aMarca = "*"; |FINSI; || Grupo
          |SI aMas = "agifa220"; aMarca = "*"; |FINSI; || Des. Ampliada Vta
          |SI aMas = "dsm00081"; aMarca = "*"; |FINSI; || Des. Ampliada Com

          |SI aMas = "agifa025"; aMarca = "*"; |FINSI; || Representantes

          |SI aMas = "agifa112"; aMarca = "*"; |FINSI; || Proveedores

          |SI aMas = "agifa091"; aMarca = "*"; |FINSI; || F.Pago
          |SI aMas = "agifa184"; aMarca = "*"; |FINSI; || Bancos
          |SI aMas = "dsm00020"; aMarca = "*"; |FINSI; || Agencias


          |SI nSwInforpor = 0;
               |SI aMas = "infom003"; aMarca = "*"; |FINSI; || Agencias
          |FINSI;

          #4#2 = aMarca;
          |GRABA 020#4a;
          |LIBERA #4;
          |LEE 101#4s;
     |SIGUE;
     |REPON_FICHA #4;
|FPRC;

|PROCESO DesMarcaTodo;
     |SALVA_FICHA #4;
     |LEE 101#4p;
     |PARA; |SI FSalida = 0; |HACIENDO;
          #4#2 = "";
          |GRABA 020#4a;
          |LIBERA #4;
          |LEE 101#4s;
     |SIGUE;
     |REPON_FICHA #4;
|FPRC;

|PROCESO Funcion; |TIPO 11;
     |SI FSalida = 13; ||F5
          |HAZ MarcaDefecto;
          |PONCONTROL 23, "SI";
     |FINSI;
     |SI FSalida = 16; ||F8
          |HAZ DesMarcaTodo;
          |PONCONTROL 23, "SI";
     |FINSI;
|FPRC;

|PROCESO Marca; |TIPO 0;
     |SI #4#0 = Contenido; |Y FSalida = 0;
          |SI #4#2 = "*";
               #4#2 = "";
          |SINO;
               #4#2 = "*";
          |FINSI;
          |GRABA 020#4a;
          |PINTA #4#2;
     |FINSI;
|FPRC;

|PROCESO Carpeta; |TIPO 0;
     |SI FSalida = 13;
          |HAZ BtnCarpeta;
          |ERROR; |ACABA;
     |FINSI;
     |SI FSalida = 0;
          |ENTLINEAL #1#4, 1, 4, 22, 0, Min, Max;
     |FINSI;
|FPRC;

|PROCESO Min;
     #4#0 = "        ";
|FPRC;

|PROCESO Max;
     #4#0 = "zzzzzzzz";
|FPRC;

|PROCESO BtnCarpeta;
     aRuta = "D*.*";

     |BROWSE aRuta;

     aRuta = aRuta % 2; |QBF aRuta;
     |SI aRuta = "D"; aRuta = ""; |FINSI;

     |QBF aRuta;
     |SI aRuta = "";
          |ERROR;
     |SINO;
          #0#1 = aRuta;
          |PINTA #0#1;
     |FINSI;
|FPRC;

|PROCESO T12; |TIPO 12;
|FPRC;

|PROCESO CargaMas;
     |DBASE aAlfa;
     aAlfa = aAlfa + "fich/dscomer9.dir";
     |XABRE "", aAlfa, nHandle;
     |SI FSalida ] 0;
          |PARA; |SI; |HACIENDO;
               |XLEE nHandle, 250, aAlfa;
               |SI FSalida < 0; |SAL; |FINSI;
               |SI nConta = 0;
                    |DDEFECTO #4;
                    #4#0 = aAlfa;
                    |LEE 101#4=;
                    |SI FSalida ! 0; |GRABA 020#4b; |FINSI;
               |FINSI;
               |SI nConta = 1;
                    #4#1 = aAlfa;
                    |GRABA 040#4a;
                    |LIBERA #4;
               |FINSI;
               nConta = (nConta + 1) $ 5;
          |SIGUE;
          |XCIERRA nHandle;
     |FINSI;
|FPRC;

|PROGRAMA;
     |HAZ EsInforpor; nSwInforpor = FSalida;

     |HAZ LlenaTipoFactu;

     |ABRE #4;
     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;

     ||CONTROL_SIMPLE 0, "BOTON, Carpeta", 1102, 1110, BtnCarpeta;

     |PINPA #0#0;
     |PINDA #0#0;
     |HAZ CargaMas;
     |ENTLINEAL #1#4, 1, 7, 22, 0, Min, Max;
     |ENDATOS #1#0;
     |SI FSalida = 0; |GRABA 020#0a; |FINSI;
     |CIERRA #0;
     |CIERRA #4;

     ||FIN_CONTROL_WINDOWS nBtnCarpeta;
|FPRO;
