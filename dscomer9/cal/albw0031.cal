|FICHEROS;
     albm0003 #3;
     albm0035 #35,MANTE;
     albw0031 #902,MANTE;
     agifa029 #29;
     agifa067 #67;
     agifa077 #77;
     agifa112 #112;
     agifa142 #142;
     dsm00024 #224;
|FIN;

|VARIABLES;
     &enAlbeAlm = 0;
     &eaTipoMov = "";
     &eaAlbePar = "";

     aClave        = "";
     nVentana1     = 0;

     &eaSw2Stock    = "";
     &eaDocu        = "";
     &eaDespreciar1 = "";
     &eaDespreciar2 = "";
     &enRechazar    = 0;
|FIN;

|PROCESO SacaPartida;  |TIPO 7;
     |SI #902#29 ! "               ";  |ACABA;  |FINSI;

     enAlbeAlm = #902#32;
     eaTipoMov = "entrada";
     |HAZ AlbeDamePartida;
     #902#29 = eaAlbePar;
     |PINTA #902#29;

     |ABRE #224;
     #224#0 = #902#30;
     #224#1 = #902#32;
     #224#2 = #902#29;
     |LEE 101#224=;
     |SI FSalida ! 0;
         |DDEFECTO #224;
         #224#0  = #902#30;
         #224#1  = #902#32;
         #224#2  = #902#29;
         |GRABA 020#224b;
     |FINSI;
     #224#3  = #902#4;
     #224#35 = #902#6;
     #224#36 = #902#7;
     |GRABA 020#224a;
     |LIBERA #224;
     |CIERRA #224;
|FPRC;

|PROCESO ComparaP1;
     |SI eaDespreciar1 = "X";  eaDespreciar1 = "N";  |ACABA;  |FINSI;

     |ABRE #142;
     |LEE 040#142p;
     |CIERRA #142;

     eaDespreciar1 = "N";

     |SI #902#17 > #902#13;  |O #902#18 > #902#14;
         |CONFI "2400NEsta recibiendo mas de lo Pedido, Continuar : ";
         |SI FSalida = 0;
             eaDespreciar1 = "S";
         |SINO;
             eaDespreciar1 = "X";
             |PTEC 808;
             |PTEC 808;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #902#17 < #902#13;  |O #902#18 < #902#14;
         |SI #142#211 = "E";
             |AVISO;
             |CONFI "2400NEsta recibiendo menos de lo Pedido, Despreciar : ";
         |FINSI;
         |SI #142#211 = "D"; FSalida = 0; |FINSI;
         |SI #142#211 = "P"; FSalida = 1; |FINSI;
         |SI FSalida = 0;
             eaDespreciar1 = "S";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO ComparaP2;
     |SI eaDespreciar2 = "X";  eaDespreciar2 = "N";  |ACABA;  |FINSI;

     |ABRE #142;
     |LEE 040#142p;
     |CIERRA #142;

     eaDespreciar2 = "N";

     |SI #902#24 > #902#20;  |O #902#25 > #902#21;
         |CONFI "2400NEsta recibiendo mas de lo Pedido, Continuar : ";
         |SI FSalida = 0;
             eaDespreciar2 = "S";
         |SINO;
             eaDespreciar2 = "X";
             |PTEC 808;
             |PTEC 808;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #902#24 < #902#20;  |O #902#25 < #902#21;
         |SI #142#211 = "E";
             |AVISO;
             |CONFI "2400NEsta recibiendo menos de lo Pedido, Despreciar : ";
         |FINSI;
         |SI #142#211 = "D"; FSalida = 0; |FINSI;
         |SI #142#211 = "P"; FSalida = 1; |FINSI;
         |SI FSalida = 0;
             eaDespreciar2 = "S";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo7w31;  |TIPO 7;
     |ABRE #77;
     #77#50 = #902#0;
     #77#0  = 999999;
     |LEE 040#77];
     |SI FSalida = 0;
         |LEE 040#77a;
     |SINO;
         |LEE 040#77u;
     |FINSI;

     #902#1 = 1;
     |SI FSalida = 0;  |Y  #77#50 = #902#0;
         #902#1 = #77#0 + 1;
     |FINSI;

     |CIERRA #77;

     |PINTA #902#1;
|FPRC;

|PROCESO Tipo0w31;  |TIPO 0;
     |ABRE #77;
     #77#50 = #902#0;
     #77#0  = #902#1;
     |LEE 040#77=;
     |SI FSalida = 0;
         |MENAV "0000 El Albaran ya existe.";
         |ERROR;
     |FINSI;
     |CIERRA #77;
|FPRC;

|PROCESO AFacturar;
     #902#26 = #902#17 + #902#24;  |PINTA #902#26;
     #902#27 = #902#18 + #902#25;  |PINTA #902#27;
|FPRC;

|PROCESO Incidenciasw31;  |TIPO 0;
     |SI #902Campo = Contenido;  |ACABA;  |FINSI;
     |SI #902#37 ! "S";          |ACABA;  |FINSI;

     |ABRE #35;
     |VENTANA 0501, 3299, -1, -1, "";
     nVentana1 = FSalida;

     |ABRE #29;
     #29#0 = #3#3;
     |LEE 040#29=;
     |SI FSalida ! 0;  |DDEFECTO #29;  |FINSI;
     |CIERRA #29;

     |ABRE #112;
     #112#0 = #3#7;
     |LEE 040#112=;
     |SI FSalida ! 0;  |DDEFECTO #112;  |FINSI;
     |CIERRA #112;

     #35#0 = #3#4;
     #35#2 = #3#3;
     #35#4 = #902#29;
     |LEE 101#35=;
     |SI FSalida ! 0;
         |DDEFECTO #albm0035;
         #35#0 = #3#4;
         #35#2 = #3#3;
         #35#4 = #902#29;
         |GRABA 020#35b;
      |FINSI;

      #35#1  = #3#5;
      #35#3  = #29#1;
      #35#5  = #3#7;
      #35#6  = #112#1;

      #35#40 = "N";  |C_M #35#40, 1, "N";

      |PINPA #0#35;
      |PINDA #0#35;
      |ENDATOS #1#35;
      |SI FSalida = 0;
         |GRABA 020#35a;
      |FINSI;
      |LIBERA #35;
      |CIERRA #35;

      |FINVENTANA nVentana1;
|FPRC;

|PROCESO Tipo3w31;  |TIPO 3;
     |ABRE #77;
     #77#50 = #902#0;
     #77#0  = #902#1;
     |LEE 040#77=;
     |SI FSalida = 0;
         |MENAV "0000 El Albaran ya existe.";
         |ERROR;
     |FINSI;
     |CIERRA #77;
|FPRC;
