     || Quitado el conz011a.cal y puesto el con0g0a3.cal


|FICHEROS;
   conz0011 #0;

   con0g003 #10;
   agifa007 #11;
|FIN;

|VARIABLES;
   &enSwError = 0;
   &enSwMasiva = 0;

   aAlfa      = "";

   nCuentaGar = 0;
   nCuentaErr = 0;
|FIN;

|PROCESO Exportacion;
   |SI #con0g003#12 = "SI"; |ACABA; |FINSI;

   #agifa007#26 = #con0g003#37;
   |LEE 000#agifa007.=;
   |SI FSalida ! 0; |DDEFECTO #agifa007; |FINSI;
   |SI #agifa007#48 ! "S"; |ACABA; |FINSI;

   enSwError = 0; |HAZ Exporta;

   |SI enSwError = 0; nCuentaGar = nCuentaGar + 1; |FINSI;
   |SI enSwError = 1;
      |SI nCuentaErr = 0;
         |MENAV "0000Carpeta no informada en parametros del modulo";
         nCuentaErr = 1;
      |FINSI;
   |FINSI;
   |SI enSwError = 2;
      aAlfa = #con0g003#37; |QBT aAlfa;
      aAlfa = aAlfa + (("000000" + #con0g003#0) % -106) + ".txt";
      aAlfa = "00000Error al crear el fichero " + aAlfa + " ....";
      |MENAV aAlfa;
   |FINSI;
|FPRC;

|DEFBUCLE Exportacion;
#con0g003#1;
31;
#conz0011#0, #conz0011#1, #conz0011#2;
#conz0011#3, #conz0011#4, #conz0011#5;
;
NULL, Exportacion;
|FIN;

|PROGRAMA;
   enSwMasiva = 1;

   |HAZ TallerDeci;

   |CLS;
   |CABEZA "EXPORTACION MASIVA DE GARANTIAS";

   |ABRE #conz0011;
   |LEE 000#conz0011.p;
   |SI FSalida ! 0;
      |GRABA 020#conz0011.c;
   |FINSI;
   |DDEFECTO #conz0011;

   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      |GRABA 020#conz0011.a;

      nCuentaGar = 0; |ABRE #agifa007;
      |BUCLE Exportacion;
      |CIERRA #agifa007;

      |SI nCuentaGar = 1;
          aAlfa  = "0000Garantia Exportada:" + nCuentaGar;
      |SINO;
          aAlfa  = "0000Garantias Exportadas:" + nCuentaGar;
      |FINSI;
      |MENAV aAlfa;
   |FINSI;
   |CIERRA #conz0011;
|FPRO;
