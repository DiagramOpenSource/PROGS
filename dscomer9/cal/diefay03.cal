|FICHEROS;
     diefay03 #0;
     diefa013 #13;
     agifa065 #65;
     diefaw11 #11;
     agifa019 #19;
     agi00063 #63;
     agifa112 #112;
|FIN;

|VARIABLES;
     aAlf1 = "";
     aAlf2 = "";
     nNu1 = 0;
     nNu2 = 0;
     aInforme  = "diefay03";
     nCampo    = 0;
     nMes      = 0;
     nUni      = 0;
     nHay      = 0;
     nAno1     = 0;
     nAno2     = 0;
     aAlfa     = "";
     fDesde    = @;
     fHasta    = @;
     nDesde    = 0;
     nDMes     = 0;
     nHMes     = 0;
     nInc      = 0;
     i         = 0;
     nAno      = 0;
|FIN;

|PROCESO diefaw11;
     |DDEFECTO #19;
     #19#0 = #11#2;
     |LEE 000#19=;

     |DDEFECTO #63;
     #63#0 = #11#1;
     |LEE 000#63=;

     |DDEFECTO #112;
     #112#0 = #11#0;
     |LEE 000#112=;

     #11#16 = #11#3+#11#4+#11#5+#11#6+#11#7+#11#8+#11#9+#11#10+#11#11+#11#12+#11#13+#11#14+#11#15;

     |PRINT;
     nHay = 1;
|FPRC;

|DEFBUCLE diefaw11;
     #11#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, diefaw11;
|FIN;

|PROCESO agifa019;
     |PARA i = nDMes; |SI i [ nHMes; |HACIENDO i = i + 1;
          |DDEFECTO #11;
          #11#0 = #19#27;
          #11#1 = #19#126;
          #11#2 = #19#0;
          |LEE 101#11=;
          |SI FSalida ! 0; |GRABA 020#11b; |FINSI;

          nMes = (i - 1) * 5 + 34;
          nUni = #19nMes;

          nCampo = i - nDMes + 3 + nInc;

          #11nCampo = #11nCampo + nUni;
          |GRABA 020#11a;
          |LIBERA #11;
     |SIGUE;
|FPRC;

|DEFBUCLE agifa019;
     #19#1;
     126, 3, 27;
     #0#5, #0#1, #0#3, #13#1;
     #0#6, #0#2, #0#4, #13#1;
     ;
     NULL, agifa019;
|FIN;

|PROCESO diefa013;
     |BUCLE agifa019;
|FPRC;

|DEFBUCLE diefa013;
     #13#1;
     ;
     #0#7, "      ";
     #0#7, "zzzzzz";
     ;
     NULL, diefa013;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     aAlfa = Usuario; |QBF aAlfa;
     |NOME_DAT #11 aAlfa;
     |DELINDEX #11;

     ||컴컴컴컴컴컴컴 Resta 12 Meses
     aAlfa = #0#7;
     aAlf1 = aAlfa % 402;
     aAlf2 = aAlfa % -104;
     nNu1 = aAlf1;
     nNu2 = aAlf2 - 1;
     aAlfa = "01." + (("00" + nNu1) % -102) + "." + (("0000" + nNu2) % -104);
     ||컴컴컴컴컴컴컴
     fHasta = #0#7;
     fDesde = aAlfa; ||contando el mes actual es un periodo de 13 meses

     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR aInforme;
          |SI FSalida = 0;
               |ABRE #11;
               |DBASE aAlfa;
               aAlfa = aAlfa + "fich/" + (("00000" + #0#0) % -105) + "/";
               |PATH_DAT #19 aAlfa;
               aAlfa = fDesde; aAlfa = aAlfa % 402;
               nDMes = aAlfa;
               nHMes = 12;
               nInc = 0;
               |BUCLE diefa013;

               |DFICE aAlfa;
               |PATH_DAT #19 aAlfa;
               nInc = nHMes - nDMes +1;
               aAlfa = fHasta; aAlfa = aAlfa % 402;
               nHMes = aAlfa;
               nDMes = 1;
               nAno = 1;
               |BUCLE diefa013;
               |CIERRA #11;

               |ABRE #112;
               |ABRE #63;
               |ABRE #19;
               |BUCLE diefaw11;
               |CIERRA #19;
               |CIERRA #112;
               |CIERRA #63;
               |SI nHay ! 0;
                    |PIEINF;
               |FINSI;
               |FININF;
          |SINO;
               aInforme = "0000No existe informe " + aInforme;
               |MENAV aInforme;
          |FINSI;
          |FINIMP;
     |FINSI;
     |DELINDEX #11;
|FPRC;
