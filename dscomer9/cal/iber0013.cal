|FICHEROS;
     iber0013 #0; ||Este Def.
     iber0031 #31,MANTE;
     iber0032 #32,MANTE;
     iber0033 #33,MANTE;
     agifa019 #19;
     agifa142 #142;
     dsm00241 #241;
|FIN;

|VARIABLES;
     aAlfa     = "";
     dArti     = "";
     hArti     = "";
     nModo     = 0;
     nForma    = 0;
     nSwCarga  = 0;
     nSwCarga1 = 0;
|FIN;

|PROCESO LeeArti13;
     |ABRE #19;
     #19#0 = #0#0;
     |LEE 000#19=;
     |CIERRA #19;
|FPRC;

|PROCESO MinMulti;
     #241#0 = #19#5;
     #241#1 = 1;
|FPRC;

|PROCESO MaxMulti;
     #241#0 = #19#5;
     #241#1 = 999;
|FPRC;

|PROCESO Medida13_66; |TIPO 66;
     |HAZ LeeArti13;
     |ABRE #241;
     |CONSULTA_F_CLAVE #1#241, MinMulti, MaxMulti;
     |SI FSalida = 0;
          #0#12 = #241#2; |PINTA #0#12;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #241;
|FPRC;

|PROCESO Medida13_0; |TIPO 0;
     |HAZ LeeArti13;
     |SI #19#204 = "N"; |ACABA; |FINSI;
     |ABRE #241;
     |SELECT #2#241;
     #241#0 = #19#5;
     #241#2 = #0#12;
     |LEE 000#241=;
     |SI FSalida ! 0;
          |MENAV "0000Codigo no definido...";
          |ERROR;
     |FINSI;
     |CIERRA #241;
|FPRC;

|PROCESO Medida13_7; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |HAZ LeeArti13;
     |SI #19#204 = "N";
          |C_M #0#12, 1, "N";
          #0#12 = #19#5;
     |SINO;
          |C_M #0#12, 1, "S";
          |SI #0#12 = "     ";
               #0#12 = #19#5;
          |SINO;
               |SI nModo = 1;
                    #0#12 = #19#5;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Plato; |TIPO 7;
     |SI #0#1 = "PT";
          |C_M #0#10, 1, "S";
     |SINO;
          #0#10 = "0";
          |C_M #0#10, 1, "N";
     |FINSI;
     |PINTA #0#10;
|FPRC;

|PROCESO vernatu; |TIPO 0;
     |SI #0#1 = "MP";
          |C_M #0#2 , 1 , "N";
          |C_M #0#7 , 1 , "N";
          #0#2 = "N";
          #0#7 = "N";
     |SINO;
          |C_M #0#2 , 1 , "S";
          |C_M #0#7 , 1 , "S";
     |FINSI;
|FPRC;

|PROCESO Borra33;
     |BORRA 020#33a;
|FPRC;

|DEFBUCLE Borra33;
     #33#1;
     ;
     #32#0, #32#1, dArti;
     #32#0, #32#1, hArti;
     be;
     NULL, Borra33;
|FIN;

|PROCESO Borra32;
     |BUCLE Borra33;
     |BORRA 020#32a;
|FPRC;

|PROCESO Borra31;
     |BORRA 020#31a;
|FPRC;

|DEFBUCLE Borra32;
     #32#1;
     ;
     #0#0, dArti;
     #0#0, hArti;
     be;
     NULL, Borra32;
|FIN;

|DEFBUCLE Borra31;
     #31#1;
     ;
     #0#0, dArti;
     #0#0, hArti;
     be;
     NULL, Borra31;
|FIN;

|PROCESO Tipo2; |TIPO 2;
     nModo = (FEntrada / 100)  ! 0;
     |SI nModo = 3;
          |BUCLE Borra31;
          |BUCLE Borra32;
     |FINSI;
|FPRC;

|RUTINA inf33;
     #33#0 = #32#0;
     #33#1 = #32#1;
     #33#2 = dArti;
|FRUT;

|RUTINA sup33;
     #33#0 = #32#0;
     #33#1 = #32#1;
     #33#2 = hArti;
|FRUT;

|RUTINA inf32;
     #32#0 = #0#0;
     #32#1 = "   ";
|FRUT;

|RUTINA sup32;
     #32#0 = #0#0;
     #32#1 = "zzz";
|FRUT;

|RUTINA inf31;
     #31#0 = #0#0;
     #31#1 = dArti;
|FRUT;

|RUTINA sup31;
     #31#0 = #0#0;
     #31#1 = hArti;
|FRUT;

|RUTINA inf;
     #0#0 = dArti;
|FRUT;

|RUTINA sup;
     #0#0 = hArti;
|FRUT;

|PROCESO MiraFam; |TIPO 0;
     |ABRE #19;
     #19#0 = #33#2;
     |LEE 000#19=;
     |SI #19#3 ! #33#1;
          |MENAV "0000Subfamilia Incorrecta...";
          |ERROR;
     |FINSI;
     |CIERRA #19;
|FPRC;

|PROCESO Carga; |TIPO 11;
     |SI FSalida = 13;
          nSwCarga1 = 1;
          |PTEC 807;
     |FINSI;
|FPRC;

|PROCESO CargaSub;
     #33#0 = #32#0;
     #33#1 = #32#1;
     #33#2 = #19#0;
     #33#3 = #19#1
     |GRABA 000#33n;
|FPRC;

|DEFBUCLE CargaSub;
     #19#1;
     3;
     dArti, #32#1;
     hArti, #32#1;
     ;
     NULL, CargaSub;
|FIN;

|PROCESO Configu; |TIPO 2;
     nForma = 0 +. 1;
     nModo = (FEntrada / 100)  ! 0;
     |SI nForma = 1;
          |PUSHV 0501 2380;
          |PARA nSwCarga1 = 1; |SI nSwCarga1 = 1; |HACIENDO;
               nSwCarga1 = 0;
               |ENTLINEAL #1#33 , -1 , 2 , 22 , 1 , inf33 , sup33;
               |SI nSwCarga1 = 1;
                    |ABRE #33;
                    |BUCLE CargaSub;
                    |CIERRA #33;
               |FINSI;
          |SIGUE;
          |POPV;
     |FINSI;
     |SI nModo = 3;
          |BUCLE Borra33;
     |FINSI;
|FPRC;

|PROCESO TeclaSub; |TIPO 11;
     |SI FSalida = 12;
           |PUSHV 0501 2380;
           |ENTLINEAL #1#33 , -1 , 4 , 22 , 1 , inf33 , sup33;
           |POPV;
           |ERROR;
     |FINSI;
|FPRC;

|PROCESO Producto;
     |SI #0#7 ! Contenido;
          |BUCLE Borra31;
          |BUCLE Borra32;
     |FINSI;

     |SI #0#7 = "F";
          |PUSHV 0501 2380;
          |ENTLINEAL #1#31 , -1 , 2 , 22 , 1 , inf31 , sup31;
          |POPV;
     |FINSI;
     |SI #0#7 = "P";
          |PUSHV 0501 2380;
          |ENTLINEAL #1#32 , -1 , 2 , 22 , 1 , inf32 , sup32;
          |POPV;
     |FINSI;
|FPRC;

|PROCESO TeclaF2; |TIPO 11;
     |SI FSalida = 10;
          |CONFI "2400NCargar articulos...";
          |SI FSalida = 0;
               nSwCarga = 1;
               |PTEC 807;
          |SINO;
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO agifa019;
     |DDEFECTO #0;
     #0#0 = #19#0;
     |LEE 101#0=;
     |SI FSalida ! 0;
          #0#4 = #19#1;
          #0#12 = #19#5;
          |GRABA 020#0n;
     |SINO;
          #0#4 = #19#1;
          #0#12 = #19#5;
          |GRABA 020#0a;
     |FINSI;
     |LIBERA #0;
|FPRC;

|DEFBUCLE agifa019;
     #19#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, agifa019;
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROGRAMA;
     aAlfa = PARAMETRO; |QBF aAlfa;
     |SI aAlfa = "";
          dArti = " " * 20;
          hArti = "z" * 20;
          |CLS;
          |CABEZA "PARAMETROS ARTICULOS";
          |PARA nSwCarga = 1; |SI nSwCarga = 1; |HACIENDO;
               nSwCarga = 0;
               |ENTLINEAL #1#0 , -1 , 2 , 20 , 1 , inf , sup;
               |SI nSwCarga = 1;
                    |ABRE #0;
                    |BUCLE agifa019;
                    |CIERRA #0;
               |FINSI;
          |SIGUE;
     |FINSI;
|FPRO;
