|FICHEROS;
     web10010 #0;
     dsm00003 #3;
     web10007 #7;
     web10008 #8;
     web10009 #9,MANTE;   ||Tmp
     web10013 #13,MANTE;  ||Tmp
     agifa019 #19;
     agifa024 #24;
     agifa025 #25;
     agifa073 #73;  ||Pedidos lineas
     agifa104 #104; ||Pedidos cabecera
     agifa091 #91;
     agifa321 #321;
     agifa324 #324;
     agifa142 #142;

     dsm00246 #140; ||Control Riesgo Por Usuarios.
     dsm00247 #141; ||Pantalla Informe Riesgo.
     dsm00248 #143; ||Auditoria.

     web10057 #1057; ||Historico PrePedidos P800 CAB
     web10058 #1058; ||Historico PrePedidos P800 LIN

     agifa007 #70;

     agifa048 #480;
     dsm00046 #46;
     agifa017 #17;
|FINSI;


|VARIABLES;
     &eaSerie = "";

     &Tempo = "";
     nAlmaSer = 0;
     nAlmaDoc = 0;
     nLinKit = 0;
     aTipo = "";
     aCodUsuario = "";
     &enPideImpre = 0;
     &eaImpresora = "";
     &ser_ped = "";
     &num_ped = 0;
     aTodos = "";
     nPrime = 0;
     nTotalPed = 0;
     nCalc = 0;
     &enDirEnt      = 0;
     &enUniMarhu    = 0;
     &enDescuento1  = 0;
     &enDescuento2  = 0;
     &enComision    = 0;
     &eaRepre       = "";
     &eaCliente     = "";
     &eaArticulo    = "";
     &eaTComision   = "";
     &efFecha       = @;
     uni_dt = 0;
     nSwError = 0;

     &eaCodCliente = "";
     &eaNomCliente = "";
     &aRieBloqu = "";
     &aBloquead = "";
     nError = 0;
     &nMasRies  = 0;
     &eaTag     = "";
     &nRieUtili = 0;
     &nRieTotal = 0;
     aUs        = "";
     nAudito    = 0;
     nConAu     = 0;
     nHay = 0;
     i = 0;
     aAlfa = "";
     &aMoneda  = "";
     &aDivisa  = "";
     &enSwMenu = 0;
     &enForma  = 1;
     nLin      = 0;
     nCambio   = 0;
|FIN;

|INCLUYE i_escank;

|PROCESO LinKit;
     |DDEFECTO #19;
     #19#0 = aEscan;
     |LEE 101#19=;
     |SI FSalida ! 0; |GRABA 020#19b; |FINSI;

     |DDEFECTO #46;
     nLinKit = nLinKit + 1;
     #46#0 = #73#28;
     #46#1 = #73#0;
     #46#2 = #73#1;
     #46#3 = aEscan;
     #46#4 = nAlmaDoc;
     |SI #142#215 = "E"; #46#4 = nAlmaEscan; |FINSI;
     |SI #142#215 = "S"; #46#4 = nAlmaSer; |FINSI;
     #46#5 = #46#5 + nCantiEscan;
     #46#6 = nLinKit;
     #46#7 = "";
     #46#8 = #19#9;
     |GRABA 020#46n;

     #19#15 = #19#15 + (nCantiEscan * #73#5);

     #17#0 = #46#3;
     #17#1 = #46#4;
     |LEE 101#17=;
     |SI FSalida ! 0; |GRABA 020#17b; |FINSI;
     #17#42 = #17#42 + (nCantiEscan * #73#5);

     |HAZ ValoraStock;

     |GRABA 020#19a;
     |LIBERA #19;

     |GRABA 020#17a;
     |LIBERA #17;

|FPRC;

|PROCESO MontaKit;
     aTipo = #142#12;
     |SI aTipo = "X";
          |ABRE #480;
          #480#0 = #73#2;
          |LEE 000#480=;
          |SI FSalida = 0;
               aTipo = #480#33;
          |FINSI;
          |CIERRA #480;
     |FINSI;
     |SI aTipo ! "K"; |ACABA; |FINSI;

     |ABRE #70;
     #70#26 = #73#28;
     |LEE 020#70=;
     |CIERRA #70;

     nAlmaSer = #70#29;
     nAlmaDoc = #73#3;

     aEscan = #73#2;
     nCantiEscan = 1;
     nMaxNivel = 1;
     nLinKit = 0;
     |ABRE #17;
     |ABRE #19;
     |ABRE #46;
     |HAZ DesglosaKit;
     |CIERRA #46;
     |CIERRA #19;
     |CIERRA #17;
|FPRC;

|PROCESO DesBloquea;
     #7#0 = #9#0;
     #7#1 = #9#1;
     #7#2 = #9#2;
     #7#21 = #9#30;
     |LEE 101#7=
     |SI FSalida = 0;
          aAlfa = #7#26; |QBF aAlfa;
          |SI aCodUsuario = aAlfa;
               #7#25 = "N";
               #7#26 = "";
               #7#27 = "";
               |GRABA 020#7a;
          |FINSI;
          |LIBERA #7;
     |FINSI;
|FPRC;

|DEFBUCLE DesBloquea;
     #9#2;
     ;
     "*";
     "*";
     ;
     NULL, DesBloquea;
|FIN;

|PROCESO mira_riesgop;
     |SI aRieBloqu = "S";
          aAlfa = "    Riesgo bloqueado. Referencia : " + aBloquead;
          |MENAV aAlfa;
          nError = 2; |ACABA;
     |FINSI;
     |SI #agifa142#166 = "S";
          |SI nRieTotal ! 0;
               |PUSHV 0501 2380;
               |BLANCO 0948 1672;
               |CUADRO 1148 1672;
               |CUADRO 0948 1672;
               |ATRI R; |PINTA 1049, "  < CONTROL RIESGOS >  "; |ATRI 0;
               |ATRI I;
               |PINTA 1250, "Concedido:";
               |PINTA 1350, "Total ...:";
               |PINTA 1261, nRieTotal;
               |PINTA 1361, nRieUtili;
               |ATRI 0;
               |PAUSA;
               |POPV;
               nError = 1;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Riesgo;
     nMasRies   = 0;
     eaCodCliente = #9#0;
     eaNomCliente = #9#3;
     eaTag = "";  |HAZ SacaRiesgo;
     nError = 0;
     |SI #agifa142#166 = "S";
          |SI nRieUtili ] nRieTotal; |Y nRieTotal ! 0;
               nError = 1;
               |SI #agifa142#167 = "N";
                    |MENAV "0000Superado Riesgo Cliente";
                    |BLIN 4;
               |FINSI;
               |SI #agifa142#167 = "S";
                    |HAZ AvisaRiesgo;
               |FINSI;
               |SI #agifa142#167 = "P";
                    |ABRE #140;
                    aUs = Usuario % 0810;
                    #140#0 = "P";
                    #140#1 = aUs;
                    |LEE 000#140=;
                    |SI FSalida ! 0;
                         |CIERRA #140;
                         |HAZ mira_riesgop;
                         nError = 2; |ACABA;
                    |FINSI;
                    |CIERRA #140;
                    |DDEFECTO #141;
                    #141#0 = nRieTotal;
                    #141#1 = nRieUtili;
                    #141#2 = #140#2;
                    #141#5 = nRieUtili;
                    #141#3 = (nRieTotal % #140#2);
                    #141#4 = #140#3;
                    |SI #141#3 < #141#4;|Y #141#3 ! 0;
                         #141#6 = nRieTotal + #141#3;
                         nMasRies  = #141#3;
                    |SINO;
                         #141#6 = nRieTotal + #141#4;
                         nMasRies  = #141#4;
                    |FINSI;
                    |SI #141#6 [ #141#5;
                         #141#7 = "DENEGADA ";
                         nAudito = 1;
                         nMasRies = 0;
                    |SINO;
                         #141#7 = "PERMITIDA";
                         nAudito = 0;
                         |ABRE #143;
                         |LEE 000#143u;
                         |SI FSalida = 0;
                              nConAu = #143#0 + 1;
                         |SINO;
                              nConAu = 1;
                         |FINSI;
                         |DDEFECTO #143;
                         #143#0 = nConAu;
                         #143#12 = "WPEDIDO";
                         ||#143#1 =      ;   ||Serie
                         ||#143#2 =     ;    ||Numero
                         #143#3 = #9#1;    ||Fecha
                         #143#4 = #9#0;    ||Cliente
                         #143#5 = #9#3;    ||Nombre
                         #143#6 = aUs;
                         #143#7 = #141#0;
                         #143#8 = #141#1;
                         #143#9 = #141#2;
                         #143#10 = #141#3;
                         #143#11 = #141#4;
                         |GRABA 020#143n;
                         |CIERRA #143;
                    |FINSI;
                    |PUSHV 0501 2380;
                    |PINPA #0#141;
                    |PINDA #0#141;
                    |PAUSA;
                    |POPV;
                    |SI nAudito = 1;
                         nError = 2;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
     |HAZ mira_riesgop;
|FPRC;

|PROCESO LeeDiv;
     |ABRE #324;
     #324#0 = aDivisa;
     |LEE 000#324=;
     |CIERRA #324;
     nCambio = #324#2;
|FPRC;

|PROCESO FinCab;
     |HAZ CalCabAgifa104;

     #104#51 = "";
     nMasRies = 0;
     eaSerie = #104#25; eaTag = "PE";  |HAZ SacaRiesgo;
     |SI nRieUtili ] nRieTotal; |Y nRieTotal ! 0;
          #104#51 = "RIESGO";
     |FINSI;
     |SI aRieBloqu = "S";
          #104#51 = "RIESGO";
     |FINSI;
     |GRABA 020#104a;

     #7#14 = #104#25;
     #7#15 = #104#0;
     |GRABA 020#7a;
|FPRC;

|PROCESO Lin;
     #13#0 = #8#0;  ||El segundo Tmp
     #13#1 = #8#1;
     #13#2 = #8#2;
     #13#16 = #8#15;
     #13#3 = #8#3;
     |LEE 020#13=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     |SI #13#13 ! "*"; aTodos = "N"; |ACABA; |FINSI;

     nLin = nLin + 1;

     |DDEFECTO #19;
     |ABRE #19;
     #19#0 = #8#4;
     |LEE 000#19=;
     |CIERRA #19;

     #73#28 = #104#25;
     #73#0 = #104#0;
     #73#1 = nLin;
     #73#2 = #19#0;
     #73#3 = #8#14;
     #73#4 = #8#5;
     #73#6 = #13#8;
     #73#8 = #13#10; ||descuento
     #73#5 = #8#7;  ||unidades
     #73#42 = #8#7;  ||unidades
     |SI #70#30 = "S";
          #73#14 = 0;
     |SINO;
          #73#14 = #19#30;
     |FINSI;
     #73#17 = #104#16; ||Tipo Comi
     #73#38 = #13#8;
     #73#10 = #13#14; ||Comision
     #73#27 = #13#15; ||DA
     |HAZ MontaKit;
     |GRABA 020#73n;
     enForma = 1;
     |HAZ AcumulaPV;

     |HAZ HistoricoLin;
|FPRC;

|PROCESO Cab;
     |DDEFECTO #24;
     #24#0 = #7#0;
     |LEE 000#24=;

     |DDEFECTO #25;
     #25#0 = #7#19;
     |LEE 000#25=;

     aDivisa = #24#192;
     aMoneda = #24#194;
     |HAZ Divisas104;

     nLin = 0;
     #104#25 = #9#22;
     enSwMenu = 1;
     |HAZ ContaPV7;
     |GRABA 020#104b;


     |DDEFECTO #70;
     |ABRE #70;
     #70#26 = #104#25;
     |LEE 000#70=;
     |CIERRA #70;

     #104#1 = #9#27;
     #104#3 = #9#30; || Su pedido
     #104#4 = #24#0;
     #104#8 = #24#2;
 ||-----------------------------
     #104#60 = #7#24;
     aAlfa = #7#21; |QBF aAlfa;
     #104#15 = aAlfa + " " + #7#17;
     #104#5 = #24#37;
     #104#6 = #24#38;
     #104#7 = #9#19;
     #104#9 = #9#23;
     #104#16 = #25#7;
     #104#17 = #24#156;
     #104#18 = #24#4;
     #104#23 = #24#41;
     #104#35 = "EUR";
     |HAZ LeeDiv;
     #104#36 = nCambio;
     #104#37 = "B";
     aDivisa = #agifa321#9;
     |HAZ LeeDiv;
     #104#40 = aDivisa;
     #104#41 = nCambio;

     #104#57 = #3#1;
     #104#19 = #3#10;
     #104#14 = #3#2;
     #104#20 = #3#3;
     #104#21 = #3#7;
     #104#59 = #3#6;
  ||   #104#7 = #3#14;
|FPRC;

|PROCESO Tmp;
     |DDEFECTO #0;
     #3#0 = #9#0;
     #3#1 = #9#25;
     |LEE 000#3=;

     #7#0 = #9#0;
     #7#1 = #9#1;
     #7#2 = #9#2;
     #7#21 = #9#30;
     |LEE 121#7=
     |SI FSalida = 0;
          aTodos = "S";
          |HAZ Cab;
          |BUCLELIN 2 Lin #7;
          |HAZ FinCab;
          |HAZ HistoricoCab;

          enPideImpre = 1;
          ser_ped = #104#25;
          num_ped = #104#0;
          |SUB_EJECUTA_NP "agifa105";
     |FINSI;
     |LIBERA #7;
|FPRC;

|PROCESO HistoricoLin;
     |DDEFECTO #web10058;
     #web10058#0 = #web10008#0;
     #web10058#1 = #web10008#1;
     #web10058#2 = #web10008#2;
     #web10058#14 = #web10008#15;
     #web10058#3 = #web10008#3;
     |LEE 101#web10058.=;
     |SI FSalida ! 0; |GRABA 020#web10058.b; |FINSI;
     #web10058#4 = #web10008#4;
     #web10058#5 = #web10008#5;
     #web10058#6 = #web10008#6;
     #web10058#7 = #web10008#7;
     #web10058#8 = #web10008#8;
     #web10058#9 = #web10008#9;
     #web10058#10 = #web10008#10;
     #web10058#11 = #web10008#11;
     #web10058#12 = #web10008#12;
     |GRABA 020#web10058.a;
     |LIBERA #web10058;

     |BORRA 020#web10008.a;
|FPRC;

|PROCESO HistoricoCab;
     |DDEFECTO #web10057;
     #web10057#0 = #web10007#0;
     #web10057#1 = #web10007#1;
     #web10057#2 = #web10007#2;
     #web10057#21 = #web10007#21;
     |LEE 101#web10057.=;
     |SI FSalida ! 0; |GRABA 020#web10057.b; |FINSI;
     #web10057#3 = #web10007#3;
     #web10057#4 = #web10007#4;
     #web10057#5 = #web10007#5;
     #web10057#6 = #web10007#6;
     #web10057#7 = #web10007#7;
     #web10057#8 = #web10007#8;
     #web10057#9 = #web10007#9;
     #web10057#10 = #web10007#10;
     #web10057#11 = #web10007#11;
     #web10057#12 = #web10007#12;
     #web10057#13 = #web10007#13;
     #web10057#14 = #web10007#14;
     #web10057#15 = #web10007#15;
     #web10057#16 = #web10007#16;
     #web10057#17 = #web10007#17;
     #web10057#18 = #web10007#18;
     #web10057#19 = #web10007#19;
     #web10057#20 = #web10007#20;
     |GRABA 020#web10057.a;
     |LIBERA #web10057;

     |SI aTodos = "S";
          |BORRA 020#web10007.a;
     |FINSI;
|FPRC;

|DEFBUCLE Tmp;
     #9#2;
     ;
     "*";
     "*";
     ;
     NULL, Tmp;
|FIN;

|PROCESO web10007;
     |PARA i = 0; |SI i [ 20; |HACIENDO i = i + 1;
          #9i = #7i;
     |SIGUE;
     #9#30 = #7#21;

     |DDEFECTO #24;
     #24#0 = #9#0;
     |LEE 000#24=;
     #9#23 = #24#20; ||F.Pago

     |DDEFECTO #91;
     #91#0 = #24#20;
     |LEE 000#91=;
     #9#24 = #91#1;

     |DDEFECTO #3;
     #3#0 = #9#0;
     #3#1 = #7#22;
     |LEE 000#3=;
     #9#25 = #7#22;     ||Dir Entrega
     #9#26 = #3#2;

     |DDEFECTO #25;
     #25#0 = #9#19;
     |LEE 000#25=;
     #9#29 = #25#7; ||Tipo Comision

     |GRABA 020#9n;
     nHay = 1;
|FPRC;

|DEFBUCLE web10007;
     #7#1;
     ;
     #0#0, #0#2, "        ", "             ";
     #0#1, #0#3, "zzzzzzzz", "zzzzzzzzzzzzz";
     ;
     NULL, web10007;
|FIN;

|PROCESO Min;
     #9#0 = "      ";
     #9#1 = "01.01.0000";
     #9#2 = "        ";
     #9#30 = "             ";
|FPRC;

|PROCESO Max;
     #9#0 = "zzzzzz";
     #9#1 = "31.31.9999";
     #9#2 = "zzzzzzzz";
     #9#30 = "zzzzzzzzzzzzz";
|FPRC;

|PROCESO Min13;
     #13#0 = #9#0;
     #13#1 = #9#1;
     #13#2 = #9#2;
     #13#16 = #9#30;
     #13#3 = 1;
|FPRC;

|PROCESO Max13;
     #13#0 = #9#0;
     #13#1 = #9#1;
     #13#2 = #9#2;
     #13#16 = #9#30;
     #13#3 = 999;
|FPRC;

|PROCESO Comision;
     enDescuento1 = #13#10;
     enDescuento2 = 0;||#13#12;
     eaTComision  = #9#29;
     eaCliente    = #9#0;
     eaRepre      = #9#19;
     eaArticulo   = #13#4;
     efFecha      = #9#27;
     enDirEnt     = #9#25;
     uni_dt = #13#7;
     |HAZ Comisiones;
     #13#14 = enComision;
|FPRC;

|PROCESO CambiaComi; |TIPO 0;
     |SI #13Campo ! Contenido;
          |HAZ Comision;
     |FINSI;
|FPRC;

|PROCESO Carga13;
     |DDEFECTO #13;
     |PARA i = 0; |SI i [ 12; |HACIENDO i = i + 1;
          #13i = #8i;
     |SIGUE;
     #13#15 = #8#13; ||DA
     #13#16 = #8#15;
     |LEE 000#13=;
     |SI FSalida ! 0;
          |HAZ Comision;
          |GRABA 000#13n;
     |FINSI;
|FPRC;

|DEFBUCLE Carga13;
     #8#1;
     ;
     #9#0, #9#1, #9#2, #9#30, 001;
     #9#0, #9#1, #9#2, #9#30, 999;
     ;
     NULL, Carga13;
|FIN;

|PROCESO Tecla13; |TIPO 0;
     |SI #13Campo = Contenido; |Y FSalida = 0;
          |SI #13#13 = "*";
               #13#13 = "";
               #9#28 = #9#28 - 1;
               nTotalPed = nTotalPed - #13#9;
               |GRABA 020#13a;
          |SINO;
             |ET E10;
               |ENCAMPO #15#13;
               |SI FSalida ! 0; |VETE Sal1; |FINSI;
             |ET E11;
               |ENCAMPO #8#13;
               |SI FSalida = 2; |VETE E10; |FINSI;
               |SI FSalida ! 0; |VETE Sal1; |FINSI;
             |ET E12;
               |ENCAMPO #10#13;
               |SI FSalida = 2; |VETE E11; |FINSI;
               |SI FSalida ! 0; |VETE Sal1; |FINSI;
               |ENCAMPO #14#13;
               |SI FSalida = 2; |VETE E12; |FINSI;
             |ET Sal1;
               |SI FSalida = 0;
                    |SI #agifa142#166 = "S";
                         nCalc = nRieTotal - (nRieUtili + (nTotalPed + #13#9));
                    |SINO;
                         nCalc = 0;
                    |FINSI;
                    |SI nCalc < 0;
                         |AVISO;
                         |MENAV "    Riesgo sobrepasado";
                    |FINSI;
                    nTotalPed = nTotalPed + #13#9;
                    #9#28 = #9#28 + 1;
                    #13#13 = "*";
                    |GRABA 020#13a;
               |SINO;
                    |LEE 000#13=;
               |FINSI;
          |FINSI;
          |PINTA #13#13;
          |PINTA #13#14;
     |FINSI;
|FPRC;

|PROCESO PideDatosPed;
   |ET E1;
     |ENCAMPO #27#9;
     |SI FSalida ! 0; |VETE Sal; |FINSI;
   |ET E2;
     |ENCAMPO #22#9;
     |SI FSalida = 2; |VETE E1; |FINSI;
     |SI FSalida ! 0; |VETE Sal; |FINSI;
   |ET E3;
     |ENCAMPO #23#9;
     |PINTA #9#24;
     |SI FSalida = 2; |VETE E2; |FINSI;
     |SI FSalida ! 0; |VETE Sal; |FINSI;
   |ET E4;
     |ENCAMPO #25#9;
     |PINTA #9#26;
     |SI FSalida = 2; |VETE E3; |FINSI;
     |SI FSalida ! 0; |VETE Sal; |FINSI;
     |ENCAMPO #30#9;
     |SI FSalida = 2; |VETE E4; |FINSI;
   |ET Sal;
     |SI FSalida = 0; |O FSalida = 6;
          |GRABA 020#9a;
     |SINO;
          |LEE 000#9=;
     |FINSI;
     |PINTA #9#27;
     |PINTA #9#22;
     |PINTA #9#23;
     |PINTA #9#24;
     |PINTA #9#25;
     |PINTA #9#26;
     |PINTA #9#30;
|FPRC;

|PROCESO Tecla;
     |SI nPrime = 0;     ||Parche, la relacion modifica el Contenido
          nPrime = 1;
          Contenido = #9#0;
     |FINSI;

     |SI #9#0 = Contenido; |Y FSalida = 0;
          |SI #9#21 ! "*";
               |ABRE #7;
               #7#0 = #9#0;
               #7#1 = #9#1;
               #7#2 = #9#2;
               #7#21 = #9#30;
               |LEE 121#7=;
               |SI FSalida = 0;
                    |SI #7#25 = "S";
                         aAlfa = "0000Pedido gestionado por usuario '"+ #7#27 + "'";
                         |MENAV aAlfa;
                         |LIBERA #7;
                         |CIERRA #7;
                         |ERROR;
                         |ACABA;
                    |SINO;
                         #7#25 = "S";
                         #7#26 = aCodUsuario;
                         #7#27 = Usuario % 810;
                         |GRABA 020#7a;
                    |FINSI;
               |FINSI;
               |LIBERA #7;
               |CIERRA #7;

               nError = 0;
               |PUSHV 0501 2380;
               |HAZ Riesgo;
               |POPV;
               |SI nError ! 0;
                    |||||SI nError > 1; |ERROR; |ACABA; |FINSI;
                    |CONFI "0000NDesea generar el pedido";
                    nError = FSalida;
               |FINSI;
               |SI nError ! 0; |ERROR; |ACABA; |FINSI;
          |FINSI;
          |ABRE #13;
          |BUCLE Carga13;
          |CIERRA #13;

          |PUSHV 0501 2380;
          |PINPA #0#13;
          |C_V #9#22, 1, "S"; |PINTA #9#22;
          |C_V #9#23, 1, "S"; |PINTA #9#23;
          |C_V #9#24, 1, "S"; |PINTA #9#24;
          |C_V #9#25, 1, "S"; |PINTA #9#25;
          |C_V #9#26, 1, "S"; |PINTA #9#26;
          |C_V #9#27, 1, "S"; |PINTA #9#27;
          |C_V #9#30, 1, "S"; |PINTA #9#30;
          |ENTLINEAL #1#13, 5, 4, 18, 0, Min13, Max13;
          |SI #9#28 = 0;
               #9#21 = "";
          |SINO;
               #9#21 = "*";
               |GRABA 020#9a;
               |HAZ PideDatosPed;
          |FINSI;
          |GRABA 020#9a;
          |C_V #9#22, 1, "N";
          |C_V #9#23, 1, "N";
          |C_V #9#24, 1, "N";
          |C_V #9#25, 1, "N";
          |C_V #9#26, 1, "N";
          |C_V #9#27, 1, "N";
          |C_V #9#30, 1, "N";
          |POPV;
          |PINTA #9#21;

          |ABRE #7;
          #7#0 = #9#0;
          #7#1 = #9#1;
          #7#2 = #9#2;
          #7#21 = #9#30;
          |LEE 121#7=;
          |SI FSalida = 0;
               |SI #9#21 = " ";
                    #7#25 = "N";
               |SINO;
                    #7#25 = "S";
               |FINSI;
               |GRABA 020#7a;
          |FINSI;
          |CIERRA #7;
     |FINSI;
|FPRC;

|PROCESO linf;
     #3#0 = #9#0;
     #3#1 = 1;
|FPRC;

|PROCESO lsup;
     #3#0 = #9#0;
     #3#1 = 9999;
|FPRC;

|PROCESO DirEnt; |TIPO 66;
     |ABRE #3;
     #3#0 = #9#0;
     #3#1 = #9#25;
     |LEE 000#3=;
     |CONSULTA_F_CLAVE #1#3,linf,lsup;
     |SI FSalida = 0;
          #9#25 = #3#1;
          #9#26 = #3#10;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     aCodUsuario = Usuario;

     |ABRE #agifa321; |LEE 000#agifa321.p; |CIERRA #agifa321;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;

     aAlfa = Usuario; aAlfa = "1" + aAlfa;
     |NOME_DAT #9 aAlfa;
     |DELINDEX #9;
     aAlfa = Usuario; aAlfa = "2" + aAlfa;
     |NOME_DAT #13 aAlfa;
     |DELINDEX #13;

     |ABRE #9;
     |ABRE #24;
     |ABRE #91;
     |ABRE #3;
     |ABRE #25;
     |BUCLE web10007;
     |CIERRA #25;
     |CIERRA #3;
     |CIERRA #91;
     |CIERRA #24;
     |CIERRA #9;
     |SI nHay = 0;
          |MENAV "0000No hay registros...";
     |SINO;
          |C_V #9#22, 1, "N";
          |C_V #9#23, 1, "N";
          |C_V #9#24, 1, "N";
          |C_V #9#25, 1, "N";
          |C_V #9#26, 1, "N";
          |C_V #9#27, 1, "N";
          |PINPA #0#9;
          |ENTLINEAL #1#9, 1, 4, 22, 0, Min, Max;
          |CONFI "0000NCorrecto con la seleccion...";
          |SI FSalida = 0;
               |ABRE #104;
               |ABRE #73;
               |ABRE #24;
               |ABRE #25;
               |ABRE #7;
               |ABRE #web10057;
               |ABRE #web10058;
               |ABRE #13;
               |ABRE #3;
               |BUCLE Tmp;
               |CIERRA #3;
               |CIERRA #13;
               |CIERRA #web10058;
               |CIERRA #web10057;
               |CIERRA #7;
               |CIERRA #25;
               |CIERRA #24;
               |CIERRA #73;
               |CIERRA #104;
          |FINSI;

          |ABRE #7;
          |BUCLE DesBloquea;
          |CIERRA #7;
     |FINSI;
     |DELINDEX #13;
     |DELINDEX #9;
|FPRC;

|PROGRAMA;
     |CLS;
     |HAZ DecimalesBase;
     |HAZ Tipo3;
|FPRO;
