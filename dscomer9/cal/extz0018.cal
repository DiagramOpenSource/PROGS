|FICHEROS;
     agifa104 #104,MANTE;
|FIN;

|VARIABLES;
     aCli = "";
     nDir = 0;
     nModo = 0;
     aAlfa = "";
     nBloquea = 0;
     aFic = "";
     nHandle = 0;
     aDato = "";
|FIN;

|PROCESO Edita;
     |CLS;
     |PINPA #0#104;
     |PINDA #0#104;
     |SI nModo = 1;
          |DDEFECTO #104;
          FEntrada = 101;
          |HAZ DefSerVta;
          |ENCAMPO #25#104;
          |SI FSalida = 0;
               FEntrada = 101;
               |HAZ ContaPV7;
               |ENCAMPO #0#104;
               |SI FSalida = 0;
                    nBloquea = 1;
                    |GRABA 020#104b;
                    |SI aCli ! ""; #104#4 = aCli; |FINSI;
                    |SI nDir ! 0; #104#57 = nDir; |FINSI;
                    |ENDATOS #1#104;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI nModo = 2; |ENDATOS #2#104; |FINSI;
     aAlfa = FSalida;
     |SI FSalida ! 0; |Y nModo = 1;
          |SI nBloquea = 1; |BORRA 020#104c; |FINSI;
     |FINSI;
     FSalida = aAlfa;
|FPRC;

|PROGRAMA;
     |ABRE #104;
     aAlfa = PARAMETRO % 105; #104#25 = aAlfa;
     aAlfa = PARAMETRO % 606; #104#0 = aAlfa;
     aAlfa = PARAMETRO % 1206; aCli = aAlfa;
     aAlfa = PARAMETRO % 1804; nDir = aAlfa;
     aFic = PARAMETRO % 22;
     |LEE 101#104=;
     |SI FSalida = 0;
          nModo = 2; |HAZ Edita;
     |SINO;
          nModo = 1; |HAZ Edita;
     |FINSI;
     aDato = #104#25 + (("000000" + #104#0) % -106);
     |SI FSalida = 0;
          |GRABA 020#104a;
     |SINO;
          |SI nModo = 1; aDato = ""; |FINSI;
     |FINSI;
     |CIERRA #104;

     |DFICE aAlfa;
     aFic = aAlfa + aFic;
     |XABRE "W", aFic, nHandle;
     |SI FSalida = 0;
          |XGRABA nHandle, aDato;
          |XCIERRA nHandle;
     |FINSI;
|FPRO;
