|FICHEROS;
     coima039 #0;
     agifa010 #10;
     coima038 #38;
     agifa084 #84;
     agifa134 #134;
|FIN;

|VARIABLES;
     aPathFin = "";
     &enMenuArchi = 0;
     &eaReimp = "";
     &enErrorImp = 0;
     &eaMenuImpre = "";
     &eaImpresora = "";
     &eaImprime = "";
     &ser_alb = "";
     &num_alb = 0;
     &ser_fac = "";
     &num_fac = 0;
     &reimp = "";
     &serie = "";
     &numero = 0;
     &eaTipoImp = "";

     aAlfa = "";
     aFic = "";
     aOrg = "";
     aDes = "";
     aPathOrg = "";
     aPathDes = "";
     aIP = "";
     {1}aBaseLocal = "";
     aImp = "";
|FIN;

|PROCESO Documentos;
     aAlfa = (#38#3 % 102) + (#38#3 % 402) + (#38#3 % 704);
     aFic = #38#0 + #38#1; |QBF aFic;
     aFic = aFic + #38#2 + aAlfa + ".pdf";

     aPathFin = aPathDes + (#38#3 % 704) + (#38#3 % 402) + "/";
     |MKDIR aPathFin;

     aOrg = aPathOrg + aFic;
     aDes = aPathFin + aFic;

     enMenuArchi = 2;     || Selecciona papel de dsarchi
     aImp = "N";
     enErrorImp = -1;
     |SI #38#0 = "AV";
          eaImpresora = "CrystalReport;" + aOrg;
          ser_alb = #38#1;
          num_alb = #38#2;
          eaMenuImpre = "N";
          eaReimp = "S";
          |SUB_EJECUTA_NP "agifa014";

          |ABRE #10;
          #10#52 = #38#1;
          #10#0 = #38#2;
          |LEE 000#10=;
          |SI FSalida = 0;
               aImp = #10#90;
          |FINSI;
          |CIERRA #10;
     |FINSI;
     |SI #38#0 = "FV";
          eaImprime = "CrystalReport;" + aOrg;
          ser_fac = #38#1;
          num_fac = #38#2;
          reimp = "S";
          |SUB_EJECUTA_NP "agifa136";

          |ABRE #134;
          #134#49 = #38#1;
          #134#0 = #38#2;
          |LEE 000#134=;
          |SI FSalida = 0;
               aImp = #134#45;
          |FINSI;
          |CIERRA #134;
     |FINSI;
     |SI #38#0 = "FD";
          eaImpresora = "CrystalReport;" + aOrg;
          serie = #38#1;
          numero = #38#2;
          eaTipoImp = "P";
          eaReimp = "S";
          |SUB_EJECUTA_NP "agifa086";

          |ABRE #84;
          #84#48 = #38#1;
          #84#0 = #38#2;
          |LEE 000#84=;
          |SI FSalida = 0;
               aImp = #84#10;
          |FINSI;
          |CIERRA #84;
     |FINSI;

     |SI enErrorImp  = 0; |Y aImp = "S";
          |SI aIP ! "";
               |RECIBE_FICHERO aOrg, aDes;
               enErrorImp = FSalida;
               |RFBORRA aOrg;
          |FINSI;
          #38#4 = "S";
          |GRABA 020#38a;
          |LIBERA #38;
     |FINSI;

     enMenuArchi = 0;
|FPRC;

|DEFBUCLE Documentos;
     #38#1;
     4;
     "  ", "     ", 000001, "N";
     "zz", "zzzzz", 999999, "N";
     be;
     NULL, Documentos;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |SI #0#0 = "SI";
          aIP = "";
          |IP_REMOTO aIP;

          |DBASE aPathDes;
          aPathDes = aPathDes + "docweb/";
          |MKDIR aPathDes;
          |SI aIP = "";
               aPathOrg = aPathDes;
          |SINO;
               |ESPECIFICA "RBASS", aBaseLocal;
               aPathOrg = aBaseLocal1 + "crystal/";
               |RMKDIR aPathOrg;
          |FINSI;

          |BUCLE Documentos;
     |FINSI;
|FPRC;

|PROGRAMA;
     |SI PARAMETRO = "menu";
          |MANTE #0;
     |SINO;
          #0#0 = "SI";
          |HAZ Tipo3;
     |FINSI;
|FPRO;
