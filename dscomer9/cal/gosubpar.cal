|FICHEROS;
     gosubpar #0;
     gosubpa1 #1;
     gosubdes #2;
     gosubcap #3;
     goartive #4;
|FIN;

|VARIABLES;
     &enPos = 0;
     nModo          = 0;
     nVariable      = 0;
     nBaffer        = 0;
     nTotalLinea    = 0;
     nTope          = 0;
     nVari1         = 0;
     nVari2         = 0;

     &enCuadroIni   = 0;
     &enCuadroFin   = 0;
     &enCampoAncho  = 0;
     &enModoEdita   = 0;
     &enTotalVaria  = 0;
     &eaNombreList  = "";
{100}&epPuntEdita   = "";

     cMensa         = "";
     cDesc          = "";
     aAlfa          = "";
|FIN;
------------------------------------------------------------------------------
|PROCESO GrabaSecuencial;
     IepPuntEdita  = epPuntEdita1 <-;
     |PARA nTotalLinea = 0;  |SI nTotalLinea [ enTotalVaria;  |HACIENDO nTotalLinea = nTotalLinea + 1;
          |AL_BUF nBaffer, nTotalLinea, epPuntEdita;
          IepPuntEdita = IepPuntEdita + 1;
     |SIGUE;
|FPRC;
------------------------------------------------------------------------------
|PROCESO Edicion;
     nTope  = nTotalLinea - 1;
     nVari1 = 0;
     nVari2 = 0;
     enModoEdita = enModoEdita + 100;
     |EDITA nBaffer, 0, nTope, enCuadroIni, enCuadroFin, enModoEdita, eaNombreList, enCampoAncho, nVari1, nVari2;
     enModoEdita = enModoEdita $ 100;
|FPRC;
------------------------------------------------------------------------------
|PROCESO CogePuntero;
     IepPuntEdita  = epPuntEdita1 <-;
     |PARA nTotalLinea = 0;  |SI nTotalLinea [ enTotalVaria;  |HACIENDO nTotalLinea = nTotalLinea + 1;
          |DEL_BUF nBaffer, nTotalLinea, epPuntEdita;
          IepPuntEdita = IepPuntEdita + 1;
     |SIGUE;
|FPRC;
------------------------------------------------------------------------------
|PROCESO Edita;
     |PUSHV 0501 2380;
     |DIMENSIONA  200, nBaffer, 0;

     |HAZ GrabaSecuencial;
     |HAZ Edicion;
     |HAZ CogePuntero;

     |FINDIM nBaffer;
     |POPV;
|FPRC;
------------------------------------------------------------------------------
|PROCESO Descri;
     |ABRE #4;
     #4#0 = #0#3;
     |LEE 000#4=;
     |CIERRA #4;
     #4#4 = #4#1; |PINTA #4#4;
|FPRC;

|PROCESO Ampliada; |TIPO 0;


     |SI FSalida ! 10; |HAZ Descri; |ACABA; |FINSI;

     enTotalVaria  = 100;
     eaNombreList  = "";
     enCuadroIni   = 0811;
     enCuadroFin   = 2071;
     enCampoAncho  = 60;
     enModoEdita   = 0;

     |ABRE #1;
     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita  = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           #1#0 = #0#0;
           #1#1 = #0#1;
           #1#2 = #0#2;
           #1#3 = nVariable;
           |LEE 101#1=;
           |SI FSalida ! 0;
               epPuntEdita  = "";
           |SINO;
               epPuntEdita  = #1#4;
               |BORRA 020#1a;
           |FINSI;
     |SIGUE;
     |CIERRA #1;

     |PUSHV  0501 2380;
     |COLOR 0, 2; |ATRI 0;
     |BLANCO 0506 2176;
     cDesc = #0#4 % 130;
     cMensa = #0#3 + "-" + cDesc;
     |COLOR 0, 7;|ATRI N;
     |PINTA 0611, "Concepto: ";
     |COLOR 9, 7;|ATRI N;
     |PINTA 0621, cMensa;
     |ATRI 0;
     |HAZ Edita;
     |POPV;

     |ABRE #1;
     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           |DDEFECTO #1;
           #1#0 = #0#0;
           #1#1 = #0#1;
           #1#2 = #0#2;
           #1#3 = nVariable;
           |LEE 101#1=;
           |SI FSalida ! 0;  |GRABA 020#1b;  |FINSI;
           #1#4 = epPuntEdita;
           |GRABA 020#1a;
           |LIBERA #1;
     |SIGUE;

     |PARA nVariable = 100;  |SI nVariable ] 1;  |HACIENDO nVariable = nVariable - 1;
           #1#0 = #0#0;
           #1#1 = #0#1;
           #1#2 = #0#2;
           #1#3 = nVariable;
           |LEE 000#1=;
           aAlfa = #1#4;  |QBF aAlfa;

           |SI aAlfa ! "";  |SAL;  |FINSI;

           |BORRA 020#1a;
     |SIGUE;
     |CIERRA #1;
     |ERROR;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO BorraDes;
     |BORRA 020#2a;
|FPRC;

|DEFBUCLE BorraDes;
     #2#1;
     ;
     #0#0, #0#1, #0#3, 001;
     #0#0, #0#1, #0#3, 999;
     be;
     NULL, BorraDes;
|FIN;

|PROCESO BajaPar; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
          |BUCLE BorraDes;
     |FINSI;
     #3#11 = #3#11 +. #0#12;
     |SI enPos > 0;
          |ATRI I; |PINTA enPos, #3#11; |ATRI 0;
     |FINSI;
|FPRC
