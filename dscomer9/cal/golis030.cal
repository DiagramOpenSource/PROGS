|FICHEROS;
     golis030 #0;
     goptrbli #1;
     gotrabaj #2;
     gomaw006 #6; ||Tmp
     agifa007 #7;
     referen@ #10;
|FIN;

|VARIABLES;
     &Tempo = "";
     aDepa = "";
     nTrab = 0;
     aExpe = "";
     nHora = 0;
     aAlfa = "";
|FIN;

|PROCESO PonPorTra;
     #referen@#4 = #referen@#3 * 100 / nHora;
     |GRABA 020#referen@.a;
|FPRC;

|DEFBUCLE PonPorTra;
     #referen@#1003;
     ;
     nTrab, "  ", "           ";
     nTrab, "zz", "           ";
     ;
     NULL, PonPorTra;
|FIN;

|PROCESO FCalPorTra;
     |SI nTrab ] 0;
          |BUCLE PonPorTra;
     |FINSI;
|FPRC;

|PROCESO CalPorTra;
     |SI nTrab ! #6#0;
          |HAZ FCalPorTra;
          nTrab = #6#0;
          nHora = 0;
     |FINSI;
     nHora = nHora + #6#3;
|FPRC;

|DEFBUCLE CalPorTra;
     #6#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, CalPorTra;
|FIN;

|PROCESO PonPorExp;
     #referen@#6 = #referen@#5 * 100 / nHora;
     |GRABA 020#referen@.a;
|FPRC;

|DEFBUCLE PonPorExp;
     #referen@#1003;
     ;
     nTrab, aDepa, "           ";
     nTrab, aDepa, "zzzzzzzzzzz";
     ;
     NULL, PonPorExp;
|FIN;

|PROCESO FCalPorExp;
     |SI aDepa ! "";
          |BUCLE PonPorExp;
          |ABRE #referen@;
          |DDEFECTO #referen@;
          #referen@#0 = nTrab;
          #referen@#1 = aDepa;
          #referen@#2 = "";
          #referen@#3 = nHora;
          |GRABA 020#referen@.n;
     |FINSI;
|FPRC;

|PROCESO CalPorExp;
     |SI nTrab ! #6#0; |O aDepa ! #6#1;
          |HAZ FCalPorExp;
          nTrab = #6#0;
          aDepa = #6#1;
          nHora = 0;
     |FINSI;
     nHora = nHora + #6#5;
|FPRC;

|DEFBUCLE CalPorExp;
     #6#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, CalPorExp;
|FIN;

|PROCESO goptrbli;
     |DDEFECTO #7;
     #7#26 = #1#0;
     |LEE 000#7=;

||     aDepa = #1#0 % 102;
     aDepa = #7#43;

     aExpe = #1#0 + (("000000" + #1#1) % -106);
     |DDEFECTO #6;
     #6#0 = #1#4;
     #6#1 = aDepa;
     #6#2 = aExpe;
     |LEE 101#6=;
     |SI FSalida ! 0; |GRABA 020#6b; |FINSI;
     #6#5 = #6#5 + #1#11;
     |GRABA 020#6a;
     |LIBERA #6;
|FPRC;

|DEFBUCLE goptrbli;
     #1#6;
     ;
     #0#0, "     ", 000001;
     #0#1, "zzzzz", 999999;
     ;
     NULL, goptrbli;
|FIN;

|PROCESO Tmp;
     |DDEFECTO #2;
     #2#0 = #6#0;
     |LEE 000#2=;
     |PRINT;
|FPRC;

|DEFBUCLE Tmp;
     #6#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     Impresora = "Crystal Reports";
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "golis030";
          |SI FSalida = 0;
               |DDEF aAlfa;
               aAlfa = aAlfa + "gomaw006";
               |CARGA_DEF aAlfa, referen@;
               |SI FSalida = 0;
                    |HAZ CreaTempo; |NOME_DAT #6 Tempo; |DELINDEX #6;
                    |NOME_DAT #referen@#Tempo#;
                    |ABRET #6;
                    |ABRE #7;
                    |BUCLE goptrbli;
                    |CIERRA #7;
                    aDepa = "";
                    |BUCLE CalPorExp;
                    |HAZ FCalPorExp;
                    nTrab = -1;
                    |BUCLE CalPorTra;
                    |HAZ FCalPorTra;
                    |DESCARGA_DEF #referen@;
                    |ABRE #2;
                    |BUCLE Tmp;
                    |CIERRA #2;
                    |CIERRAT #6;
                    |HAZ BoraTempo; |DELINDEX #6;

                    |PIEINF;
                    |FININF;
               |FINSI;
          |SINO;
               |MENAV "0000Error en informe 'golis030'";
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
