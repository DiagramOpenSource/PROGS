|FICHEROS;
     agifa061 #0;

     agifa010 #6;        ||Albaranes
     expor010@ #56;       ||Albaran Fantasma

     agifa071 #7;        ||Lineas Albaran
     expor071@ #57;       ||Lineas Albaran Fantasma

     agifa134 #8;        ||Facturas
     expor134@ #58;       ||Facturas fantasma

     agifa059 #9;        ||Lineas Facturas
     expor059@ #59;       ||Lineas Facturas Fantasma

     agifa133 #11;       ||Vencimientos Factura
     expor133@ #61;       ||Vencimientos Factura Fantasma

     agifa104 #12;       ||Pedidos
     expor104@ #62;       ||Pedidos Fantasma

     agifa073 #13;       ||Lineas de Pedidos
     expor073@ #63;       ||Lineas de Pedidos Fantasma

     agifa036 #14;       ||Depositos
     expor036@ #64;       ||Depositos Fantasma

     agifa070 #15;       ||Lineas Depositos
     expor070@ #65;       ||Lineas Depositos Fantasma

     agifa084 #16;       ||Facturas Contado
     expor084@ #66;       ||Facturas Contado

     agifa069 #17;       ||Lineas Facturas Contado
     expor069@ #67;       ||Lineas Facturas Contado Fantasma

     agifa079 #18;       ||Facturas Compra
     expor079@ #68;       ||Facturas Compra Fantasma

     agifa072 #19;       ||Lineas Facturas Compra
     expor072@ #69;       ||Lineas Facturas Compra Fantasma

     agifa077 #21;       ||Albaranes Compra
     expor077@ #71;       ||Albaranes Compra Fantasma

     agifa080 #22;       ||Lineas Albaran Compra
     expor080@ #72;       ||Lineas Albaran Compra Fantasma

     agifa081 #23;       ||Pedidos Compras
     expor081@ #73;       ||Pedidos Compras Fantasma

     agifa067 #24;       ||Lineas Pedidos Compras
     expor067@ #74;       ||Lineas Pedidos Compras Fantasma

     agifa722 #500;

     iber0112@;

     dsm00005 #4;
     expord05@ #5;

     referen@;
     dsm00053 #53;

     agis0002 #20;

     orgkit@;
     expkit@;

     refeaux1@;
     conz0018@;
|FIN;

|VARIABLES;
     &enSalida = 0;
     nSwTaller = 0;
     nSwEvaristo = 0;
     &aDivisa = "";
     &aMoneda = "";
     nSwJamaica = 0;
     nSwAparece = 0;
     &efDFecha = @;
     &efHFecha = @;
     nSwAparecida = 0;
     aOrgKit = "";
     aExpKit = "";
     aCopia = "";
     aBorra = "";
     &eaErrorEmp = "";
     &nDeci_Base = 0;
     &enTotaEntre = 0;
     &eaTipoEntre = "";
     &eaSer = "";
     &enNum = 0;
     &eaDEjer = "";
     &eaHEjer = "";
     nCopia = 0;
     nDescri = 0;
     &SPedido = "";
     &NPedido = 0;
     &BAdela  = 0;
     &TipoCta = "A";

     &eaNomDef = "";
     &enCamposDef = 0;

     aClv1 = ""; aClv2 = "";

     nCampo = 0;
     nNume = 0;
     aParam = "";
     i = 0;
     j = 0;
     long = "";
     long1 = 0;
     mandato = "";
     origen = "";
     factura = 0;
     adj = "S"
     blanco = "                         ";
     blanco1 = "                    ";
     texto = "";
     codigo = "";
     temporal1 = "";
     temporal2 = "";

     aTipoEnl = "";

     ddx = "";
     fich = "";
     org = "";
     num = 0;
     bufer = 0;
     fdes = "";
     des = "";
     fdef = "";
     def = "";
     exp = 0;
     nTope010  = 87;
     nTope036  = 59;
     nTope059  = 38;
     nTope067  = 38;
     nTope069  = 29;
     nTope070  = 27;
     nTope071  = 47;
     nTope072  = 38;
     nTope073  = 43;
     nTope077  = 71;
     nTope079  = 128;
     nTope080  = 33;
     nTope081  = 43;
     nTope084  = 77;
     nTope104  = 52;
     nTope133  = 8;
     nTope134  = 111;
     nVertical = 0;
     aTip      = "";
     nCamDa    = 0;
     aTipoDA   = "";
     aSer      = "";
     nNum      = 0;
     nLin      = 0;
     aAlfa     = "";

     &cierre = 0;
     &descie = @;
     &hascie = @;

     aMensa = "";
     aPath = "";
     swErr = 0;
     aDef     = "";
     aDef1    = "";
     aDef2    = "";
     aDef3    = "";
     aDef4    = "";
     aDef5    = "";
     aDef6    = "";
     aDef7    = "";
     aDef8    = "";
     aDef9    = "";
     aDef10   = "";
     aDef11   = "";
     aDef12   = "";
     aDef13   = "";
     aDef14   = "";
     aDef15   = "";
     aDef16   = "";
     aDef17   = "";
     aDef18   = "";
     aDef19   = "";
     aDef20   = "";
|FIN;

|PROCESO aparm016;
     #6#52 = #refeaux1@#0;
     #6#0 = #refeaux1@#1;
     |LEE 000#6=;
     |SI FSalida ! 0;
          |BORRA 020#refeaux1@.a;
     |FINSI;
     |LIBERA #refeaux1@;
|FPRC;

|DEFBUCLE aparm016;
     #refeaux1@#1002;
     ;
     "     ", 000000;
     "zzzzz", 999999;
     ;
     NULL, aparm016;
|FIN;

|PROCESO GrabaKit;
     |SALVA_DATOS #expkit@;
     |REPON_DATOS #orgkit@;
     |GRABA 020#orgkit@.n;
|FPRC;

|DEFBUCLE GrabaKit;
     #expkit@#1004;
     ;
     aSer, nNum, nLin, 001;
     aSer, nNum, nLin, 999;
     ;
     NULL, GrabaKit;
|FIN;

|PROCESO CargaKit;
     |DDEF aPath;
     aAlfa = aPath + aOrgKit;
     |CARGA_DEF aAlfa, orgkit@;
     |SI FSalida ! 0;
          aAlfa = "0000Error al cargar:" + aOrgKit;
          aOrgKit = "";
     |SINO;
          aAlfa = aPath + aOrgKit;
          |CARGA_DEF aAlfa, expkit@;
          |SI FSalida ! 0;
               aAlfa = "0000Error al cargar:" + aOrgKit;
               aExpKit = "";
          |SINO;
               |NOME_DAT #orgkit@#aOrgKit#;
               |NOME_DAT #expkit@#aExpKit#;
               |ABRE #orgkit@;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO DescargaKit;
     |SI aOrgKit ! ""; |DESCARGA_DEF #orgkit@; |FINSI;
     |SI aExpKit ! ""; |CIERRA #expkit@; |DESCARGA_DEF #expkit@; |FINSI;
|FPRC;

|PROCESO BorraDA;
     FSalida = 1;
     |SI #53#0 = "P";
          #13#28 = #53#1;
          #13#0 = #53#1;
          #13#1 = #53#1;
          |LEE 000#13=;
     |FINSI;
     |SI #53#0 = "A";
          #7#29 = #53#1;
          #7#0 = #53#2;
          #7#1 = #53#3;
          |LEE 000#7=;
     |FINSI;
     |SI #53#0 = "F";
          #17#20 = #53#1;
          #17#0 = #53#2;
          #17#1 = #53#3;
          |LEE 000#17=;
     |FINSI;
     |SI #53#0 = "D";
          #15#22 = #53#1;
          #15#0 = #53#2;
          #15#1 = #53#3;
          |LEE 000#17=;
     |FINSI;
     |SI FSalida ! 0;
          |BORRA 020#53a;
     |FINSI;
|FPRC;

|DEFBUCLE BorraDA;
     #53#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, BorraDA;
|FIN;

|PROCESO BorraHistEnl;
   |BORRA 020#agifa722.a;
|FPRC;

|DEFBUCLE BorraHistEnl;
#agifa722#1;
;
aTipoEnl,aClv1,aClv2,"          ",000000,00000,0;
aTipoEnl,aClv1,aClv2,"zzzzzzzzzz",999999,99999,9;
be;
NULL,BorraHistEnl;
|FIN;

|CALCULO mayus;
 #0Campo = #0Campo > " ";
 |PINTA #0Campo;
|FCAL;

|PROCESO GrabaVertical;
     |PARA i = 0; |SI i [ nVertical; |HACIENDO i = i + 1;
          #4i = #5i;
     |SIGUE;
     |GRABA 021#4n;
|FPRC;

|DEFBUCLE GrabaVertical;
     #5#1005;
     ;
     aTip, aSer, nNum, nLin, "      ";
     aTip, aSer, nNum, nLin, "zzzzzz";
     ;
     NULL, GrabaVertical;
|FIN;

|DEFBUCLE PasaVertical;
     #5#1005;
     ;
     aTip, "  ", 000001, 00001, "      ";
     aTip, "zz", 999999, 99999, "zzzzzz";
     ;
     NULL, GrabaVertical;
|FIN;
||========================= BORRADO DE ALBARANES ===========================
|PROCESO linalba;
     |PARA i = 0; |SI i [ nTope071; |HACIENDO i = i + 1;
          #7i = #57i;
     |SIGUE;
     |GRABA 021#7n;
     |LIBERA #7;
     |LIBERA #57;
     aTip = "AV";
     aSer = #7#29;
     nNum = #7#0;
     nLin = #7#1;
     |BUCLE GrabaVertical;
     |SI aOrgKit ! ""; |Y aExpKit ! ""; |BUCLE GrabaKit; |FINSI;
|FPRC;

|DEFBUCLE linalba;
     #57#1003;
     ;
     #56#52, #56#0, 000;
     #56#52, #56#0, 999;
     ;
     NULL, linalba;
|FIN;

|PROCESO JamaEntrega;
     |SI #20#32 = "S";
          enTotaEntre = (enTotaEntre + #20#9) ! 2;
     |FINSI;
|FPRC;

|DEFBUCLE JamaEntrega;
     #20#1;
     ;
     eaTipoEntre, eaSer, enNum, 01;
     eaTipoEntre, eaSer, enNum, 99;
     ;
     NULL, JamaEntrega;
|FIN;

|PROCESO TotalEntrega;
     |SI nSwJamaica = 0;
          enTotaEntre = 0;
          |BUCLE JamaEntrega;
     |SINO;
          || la estandar
          |HAZ TotaRecEntrega;
     |FINSI;
|FPRC;

|PROCESO CheckAlb;    ||Grabo las no facturadas
     nCopia = 0;
     |SI #56#1 ] #0#2; |Y #56#1 [ #0#3;      ||Si el albaran se puede borrar
          |SI #0#7 = "S";          ||Mantengo los no facturados
               factura = #56#39;
               |SI factura ! 000000;   ||Si esta facturado
                    nCopia = 1;
               |FINSI;
          |SINO;
               nCopia = 1;
          |FINSI;
          |SI #0#21 = "S"; |Y nCopia = 1;
               eaSer = #56#52;
               enNum = #56#0;
               eaTipoEntre = "A";
               eaDEjer = #56#1;
               eaHEjer = #56#1;
               |HAZ TotalEntrega;

               nNume = #56#67 ! 2;
               enTotaEntre = (nNume - enTotaEntre) ! 2;
               |SI nNume ] 0;
                    |SI enTotaEntre > 0;
                         nCopia = 0;         || Se copia
                    |FINSI;
               |SINO;
                    |SI enTotaEntre < 0;
                         nCopia = 0;         || Se copia
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;

     |SI nCopia = 1;
          BAdela = 1; TipoCta = "A";
          SPedido = #56#52; NPedido = #56#0;
/*
   Segun Tiquet: 001901/00342   Thu Feb 15 12:28:49 CET 2007
          |SUB_EJECUTA_NP "agis0002.tab;NOMEQUITESQUETECORTOLASMANOS";
*/
          |ACABA;
     |FINSI;

|FPRC;

|PROCESO BorraEntrega;
     |BORRA 020#20a;
     |LIBERA #20;
|FPRC;

|DEFBUCLE BorraEntrega;
     #20#1;
     ;
     "A", eaSer, enNum, 01;
     "A", eaSer, enNum, 99;
     be;
     NULL, BorraEntrega;
|FIN;

|PROCESO cabalb;
     aDivisa = #56#68;
     aMoneda = #56#70;
     |HAZ Divisas010;

     aCopia = "N";
     |SI #56#38 = "S"; ||Facturado
          #8#49 = #56#53;
          #8#0 = #56#39;
          |LEE 000#8=;
          |SI FSalida = 0; || Si existe la factura no se puede borrar
               aCopia = "S";
          |FINSI;
     |FINSI;

     |SI aCopia = "N";
          |HAZ CheckAlb;
          |SI nCopia = 1;
               eaSer = #56#52;
               enNum = #56#0;
               |BUCLE BorraEntrega;
               |ACABA;
          |FINSI;
     |FINSI;

     || los que se copian son los que se quedan

     |PINTA 2145 , blanco1;
     codigo = #56#52 + "/" + #56#0;
     |PINTA 2145 , codigo;

     |PARA i = 0; |SI i [ nTope010; |HACIENDO i = i + 1;
          #6i = #56i;
     |SIGUE;
     |GRABA 021#6n;
     |LIBERA #6;
     |BUCLE linalba;
|FPRC;

|DEFBUCLE borralba;
#56#1002;
;
"     " ,      0;
"zzzzz" , 999999;
e;
NULL, cabalb;
|FIN;

||======================= BORRADO DE FACTURAS ==============================
|PROCESO linfact;
     |PARA i = 0; |SI i [ nTope059; |HACIENDO i = i + 1;
          #9i = #59i;
     |SIGUE;
     |GRABA 021#9n;
     |LIBERA #9;
|FPRC;

|DEFBUCLE linfact;
     #59#1003;
     ;
     #58#49, #58#0, 000;
     #58#49, #58#0, 999;
     ;
     NULL, linfact;
|FIN;

|PROCESO CheckAlb2; || igual que CheckAlb pero con el #6
     nCopia = 0;
     |SI #6#1 ] #0#2; |Y #6#1 [ #0#3;      ||Si el albaran se puede borrar
          |SI #0#7 = "S";          ||Mantengo los no facturados
               factura = #6#39;
               |SI factura ! 000000;   ||Si esta facturado
                    nCopia = 1;
               |FINSI;
          |SINO;
               nCopia = 1;
          |FINSI;
          |SI #0#21 = "S"; |Y nCopia = 1;
               eaSer = #6#52;
               enNum = #6#0;
               eaTipoEntre = "A";
               eaDEjer = #6#1;
               eaHEjer = #6#1;
               |HAZ TotalEntrega;

               nNume = #6#67 ! 2;
               enTotaEntre = (nNume - enTotaEntre) ! 2;
               |SI nNume ] 0;
                    |SI enTotaEntre > 0;
                         nCopia = 0;         || Se copia
                    |FINSI;
               |SINO;
                    |SI enTotaEntre < 0;
                         nCopia = 0;         || Se copia
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO CheqLinFac;
     |ABRE #6;
     #6#52 = #59#15;
     #6#0 = #59#2;
     |LEE 000#6=;
     |SI FSalida = 0;
          |HAZ CheckAlb2;
          |SI nCopia = 0;
               aBorra = "N";
          |FINSI;
     |FINSI;
     |CIERRA #6;
|FPRC;

|DEFBUCLE CheqLinFac;
     #59#1003;
     ;
     #58#49, #58#0, 001;
     #58#49, #58#0, 999;
     ;
     NULL, CheqLinFac;
|FIN;

|PROCESO cabfact;
     aDivisa = #58#58;
     aMoneda = #58#60;
     |HAZ Divisas134;

     |SI #58#1 ] #0#2; |Y #58#1 [ #0#3;
          aBorra = "S";
          |BUCLE CheqLinFac;
          |SI aBorra = "S";
               aTipoEnl = "FV";
               aClv1 = #58#49; aClv1 = aClv1 + (" " * 10); aClv1 = aClv1 % 0110;
               aClv2 = #58#0;  aClv2 = aClv2 + (" " * 10); aClv2 = aClv2 % 0110;
               |BUCLE BorraHistEnl; |ERROR; |ACABA;
          |FINSI;
     |FINSI;
     |PINTA 2145 , blanco1;
     codigo = #58#49 + "/" + #58#0;
     |PINTA 2145 , codigo;
     |PARA i = 0; |SI i [ nTope134; |HACIENDO i = i + 1;
          #8i = #58i;
     |SIGUE;
     |HAZ grabavenci;
     |GRABA 021#8n;
     |LIBERA #8;
     |BUCLE linfact;
|FPRC;

|PROCESO grabavenci;     ||Se graban los vencimientos si existen
     #61#4 = #58#49;
     #61#0 = #58#0;
     #61#1 = 0;
     |LEE 001#61];
     |PARA ; |SI FSalida = 0; |Y #61#0 = #58#0; |Y #61#4 = #58#49;
                              |HACIENDO;
             |PARA i = 0; |SI i [ nTope133; |HACIENDO i = i + 1;
                   #11i = #61i;
             |SIGUE;
             |GRABA 021#11n;
             |LIBERA #11;
             |LEE 001#61s;
     |SIGUE;
|FPRC;

|DEFBUCLE borrfact;
#58#1002;
;
"     " ,      0;
"zzzzz" , 999999;
e;
NULL , cabfact;
|FIN;

||=========================== BORRADO DE PEDIDOS ===========================
|PROCESO linpedi;
     |PARA i = 0; |SI i [ nTope073; |HACIENDO i= i + 1;
          #13i = #63i;
     |SIGUE;
     |GRABA 021#13n;
     |LIBERA #13;
     aTip = "PV";
     aSer = #13#28;
     nNum = #13#0;
     nLin = #13#1;
     |BUCLE GrabaVertical;
     |SI aOrgKit ! ""; |Y aExpKit ! ""; |BUCLE GrabaKit; |FINSI;
|FPRC;

|DEFBUCLE linpedi;
     #63#1003;
     ;
     #62#25, #62#0, 000;
     #62#25, #62#0, 999;
     ;
     NULL, linpedi;
|FIN;

|PROCESO miralinpe;      ||miro si el pedido esta por adjudicar
     nNume = #63#5 - #63#43;
     |SI nNume ! 0;
          adj = "N";
          |ERROR;
     |FINSI;
|FPRC;

|DEFBUCLE miralinpe;
     #63#1003;
     ;
     #62#25, #62#0, 000;
     #62#25, #62#0, 999;
     ;
     NULL, miralinpe;
|FIN;

|PROCESO cabpedi;
     aDivisa = #62#35;
     aMoneda = #62#37;
     |HAZ Divisas104;

     |SI #62#1 ] #0#2; |Y #62#1 [ #0#3;
          |SI #0#5 = "S";
               adj = "S";
               |BUCLE miralinpe;
               |SI adj = "S";      ||Si todas las lineas estan adjudicadas
                                   ||no lo copio
                    BAdela = 1; TipoCta = "P";
                    SPedido = #62#25; NPedido = #62#0;
/*
   Segun Tiquet: 001901/00342   Thu Feb 15 12:28:49 CET 2007
                    |SUB_EJECUTA_NP "agis0002.tab;NOMEQUITESQUETECORTOLASMANOS";
*/
                    |ERROR;
                    |ACABA;
               |FINSI;
          |SINO;
               BAdela = 1; TipoCta = "P";
               SPedido = #62#25; NPedido = #62#0;
/*
   Segun Tiquet: 001901/00342   Thu Feb 15 12:28:49 CET 2007
               |SUB_EJECUTA_NP "agis0002.tab;NOMEQUITESQUETECORTOLASMANOS";
*/
               |ERROR;             ||Si no quiere mantener los pedidos
               |ACABA;             ||Tampoco los copio
          |FINSI;
     |FINSI;
     |PINTA 2145 , blanco1;
     codigo = #62#25 + "/" + #62#0;
     |PINTA 2145 , codigo;
     |PARA i = 0; |SI i [ nTope104; |HACIENDO i = i + 1;
          #12i = #62i;
     |SIGUE;
     |GRABA 021#12n;
     |LIBERA #12;
     |BUCLE linpedi;
|FPRC;

|DEFBUCLE borrpedi;
#62#1002;
;
"     " ,       0;
"zzzzz" ,  999999;
e;
NULL , cabpedi;
|FIN;

||=========================== BORRADO DE DEPOSITOS =========================
|PROCESO lindepo;
     |PARA i = 0; |SI i [ nTope070; |HACIENDO i= i + 1;
          #15i = #65i;
     |SIGUE;
     |GRABA 021#15n;
     |LIBERA #15;
     aTip = "DP";
     aSer = #15#22;
     nNum = #15#0;
     nLin = #15#1;
     |BUCLE GrabaVertical;
     |SI aOrgKit ! ""; |Y aExpKit ! ""; |BUCLE GrabaKit; |FINSI;
|FPRC;

|DEFBUCLE lindepo;
     #65#1003;
     ;
     #64#46, #64#0, 000;
     #64#46, #64#0, 999;
     ;
     NULL, lindepo;
|FIN;

|PROCESO miralinde;      ||miro si el deposito esta por adjudicar
|SI #65#5 ! 0;
     adj = "N";
     |ERROR;
|FINSI;
|FPRC;

|DEFBUCLE miralinde;
     #65#1003;
     ;
     #64#46, #64#0, 000;
     #64#46, #64#0, 999;
     ;
     NULL, miralinde;
|FIN;

|PROCESO cabdepo;
     aDivisa = #64#49;
     aMoneda = #64#51;
     |HAZ Divisas036;

     |SI #64#1 ] #0#2; |Y #64#1 [ #0#3;
          |SI #0#10 = "S";
               adj = "S";
               |BUCLE miralinde;
               |SI adj = "S";      ||Si todas las lineas estan adjudicadas
                    |ERROR;        ||no lo copio
                    |ACABA;
               |FINSI;
          |SINO;
               |ERROR;             ||Si no quiere mantener los depositos
               |ACABA;             ||Tampoco los copio
          |FINSI;
     |FINSI;
     |PINTA 2145 , blanco1;
     codigo = #64#46 + "/" + #64#0;
     |PINTA 2145 , codigo;
     |PARA i = 0; |SI i [ nTope036; |HACIENDO i = i + 1;
          #14i = #64i;
     |SIGUE;
     |GRABA 021#14n;
     |LIBERA #14;
     |BUCLE lindepo;
|FPRC;

|DEFBUCLE borrdepo;
#64#1002;
;
"     " ,       0;
"zzzzz" ,  999999;
e;
NULL , cabdepo;
|FIN;

||===================== BORRAD FACTURAS CONTADO ============================
|PROCESO lincont;
     |PARA i = 0; |SI i [ nTope069; |HACIENDO i = i + 1;
          #17i = #67i;
     |SIGUE;
     |GRABA 021#17n;
     |LIBERA #17;
     aTip = "FC";
     aSer = #17#20;
     nNum = #17#0;
     nLin = #17#1;
     |BUCLE GrabaVertical;
     |SI aOrgKit ! ""; |Y aExpKit ! ""; |BUCLE GrabaKit; |FINSI;
|FPRC;

|DEFBUCLE lincont;
     #67#1003;
     ;
     #66#48, #66#0, 000;
     #66#48, #66#0, 999;
     ;
     NULL, lincont;
|FIN;

|PROCESO cabcont;
     aDivisa = #66#65;
     aMoneda = #66#67;
     |HAZ Divisas084;

     |SI #66#1 ] #0#2; |Y #66#1 [ #0#3;
        aTipoEnl = "FD";
        aClv1 = #66#48; aClv1 = aClv1 + (" " * 10); aClv1 = aClv1 % 0110;
        aClv2 = #66#0;  aClv2 = aClv2 + (" " * 10); aClv2 = aClv2 % 0110;
        |BUCLE BorraHistEnl; |ERROR; |ACABA;
     |FINSI;
     |PINTA 2145 , blanco1;
     codigo = #66#48 + "/" + #66#0;
     |PINTA 2145 , codigo;
     |PARA i = 0; |SI i [ nTope084; |HACIENDO i = i + 1;
          #16i = #66i;
     |SIGUE;
     |GRABA 021#16n;
     |LIBERA #16;
     |BUCLE lincont;
|FPRC;

|DEFBUCLE borrcont;
#66#1002;
;
"     " ,      0;
"zzzzz" , 999999;
e;
NULL , cabcont;
|FIN;

|| *******************************************************
||======================= BORRADO FACTURAS COMPRA =========================
|PROCESO linfcom;
     |PARA i = 0; |SI i [ nTope072; |HACIENDO i = i + 1;
          #19i = #69i;
     |SIGUE;
     |GRABA 021#19n;
     |LIBERA #19;
|FPRC;

|DEFBUCLE linfcom;
     #69#1003;
     ;
     #68#66, #68#0, 000;
     #68#66, #68#0, 999;
     ;
     NULL, linfcom;
|FIN;

|PROCESO cabfcom;
     aDivisa = #68#75;
     aMoneda = #68#77;
     |HAZ Divisas079;

     |SI #68#1 ] #0#2; |Y #68#1 [ #0#3;
        aTipoEnl = "FC";
        aClv1 = #68#66; aClv1 = aClv1 + (" " * 10); aClv1 = aClv1 % 0110;
        aClv2 = #68#0;  aClv2 = aClv2 + (" " * 10); aClv2 = aClv2 % 0110;
        |BUCLE BorraHistEnl; |ERROR; |ACABA;
     |FINSI;
     |PINTA 2145 , blanco1;
     |PINTA 2145 , #68#0;
     |PARA i = 0; |SI i [ nTope079; |HACIENDO i = i + 1;
          #18i = #68i;
     |SIGUE;
     |GRABA 021#18n;
     |LIBERA #18;
     |BUCLE linfcom;
|FPRC;

|DEFBUCLE borrcomp;
#68#1002;
;
"     " ,       0;
"zzzzz" ,  999999;
e;
NULL , cabfcom;
|FIN;

||===================== BORRADOS ALBARANES COMPRAS ========================
|PROCESO linacom;
     |PARA i = 0; |SI i [ nTope080; |HACIENDO i = i + 1;
          #22i = #72i;
     |SIGUE;
     |GRABA 021#22n;
     |LIBERA #22;
     aTip = "AC";
     aSer = #22#27;
     nNum = #22#0;
     nLin = #22#1;
     |BUCLE GrabaVertical;
     |SI aOrgKit ! ""; |Y aExpKit ! ""; |BUCLE GrabaKit; |FINSI;
|FPRC;

|DEFBUCLE linacom;
     #72#1003;
     ;
     #71#50, #71#0, 000;
     #71#50, #71#0, 999;
     ;
     NULL, linacom;
|FIN;

|PROCESO cabacom;
     aDivisa = #71#56;
     aMoneda = #71#57;
     |HAZ Divisas077;

     |SI #71#1 ] #0#2; |Y #71#1 [ #0#3;
          |SI #0#14 = "S";
               factura = #71#39;
               |SI factura ! 0;        ||Esta facturado, por lo tanto no
                    |ERROR;             || lo copio
                    |ACABA;
               |FINSI;
          |SINO;
               |ERROR;
               |ACABA;
          |FINSI;
     |FINSI;
     |PINTA 2145 , blanco1;
     |PINTA 2145 , #71#0;
     |PARA i = 0; |SI i [ nTope077; |HACIENDO i = i + 1;
          #21i = #71i;
     |SIGUE;
     |GRABA 021#21n;
     |LIBERA #21;
     |BUCLE linacom;
|FPRC;

|DEFBUCLE borracomp;
#71#1002;
;
"     " ,       0;
"zzzzz" ,  999999;
e;
NULL , cabacom;
|FIN;

||======================== BORRADO PEDIDOS COMPRAS =========================
|PROCESO linpcom;
     |PARA i = 0; |SI i [ nTope067; |HACIENDO i = i + 1;
          #24i = #74i;
     |SIGUE;
     |GRABA 021#24n;
     |LIBERA #24;
     aTip = "PC";
     aSer = #24#28;
     nNum = #24#0;
     nLin = #24#1;
     |BUCLE GrabaVertical;
     |SI aOrgKit ! ""; |Y aExpKit ! ""; |BUCLE GrabaKit; |FINSI;
|FPRC;

|DEFBUCLE linpcom;
     #74#1003;
     ;
     #73#25, #73#0, 000;
     #73#25, #73#0, 999;
     ;
     NULL, linpcom;
|FIN;

|PROCESO mirapcom;
     nNume = #74#5 - #74#38;
     |SI nNume ! 0 ;
          adj = "N";
          |ERROR;
     |FINSI;
|FPRC;

|DEFBUCLE mirapcom;
     #74#1003;
     ;
     #73#25, #73#0, 000;
     #73#25, #73#0, 999;
     ;
     NULL, mirapcom;
|FIN;

|PROCESO cabpcom;
     aDivisa = #73#27;
     aMoneda = #73#29;
     |HAZ Divisas081;

     |SI #73#1 ] #0#2; |Y #73#1 [ #0#3;
          |SI #0#16 = "S";
               adj = "S";
               |BUCLE mirapcom;
               |SI adj = "S";
                    |ERROR;
                    |ACABA;
               |FINSI;
          |SINO;
               |ERROR;
               |ACABA;
          |FINSI;
     |FINSI;
     |PINTA 2145 , blanco1;
     |PINTA 2145 , #73#0;
     |PARA i = 0; |SI i [ nTope081; |HACIENDO i = i + 1;
          #23i = #73i;
     |SIGUE;
     |GRABA 021#23n;
     |LIBERA #23;
     |BUCLE linpcom;
|FPRC;

|DEFBUCLE borrapcomp;
#73#1002;
;
"     " ,      0;
"zzzzz" , 999999;
e;
NULL , cabpcom;
|FIN;

|PROCESO CorrigeEntregas;
     |SI #20#20 = "P";
          #13#28 = #20#20;
          #13#0 = #20#17;
          #13#1 = #20#18;
          |LEE 000#13=;
     |SINO;
          #7#29 = #20#20;
          #7#0 = #20#17;
          #7#1 = #20#18;
          |LEE 000#7=;
     |FINSI;
     |SI FSalida ! 0;
          |BORRA 020#20a;
     |FINSI;
     |LIBERA #20;
|FPRC;

|DEFBUCLE CorrigeEntregas;
     #20#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, CorrigeEntregas;
|FIN;

||==========================================================================
||=================== INICIO DE PROGRAMA , LLAMADA A PROCESOS ==============
||==========================================================================


|PROCESO inicio;|TIPO 3;
     |SI #0#0 ! "SI"; |ACABA; |FINSI;

     |HAZ CheqEmp;
     |SI eaErrorEmp = "S"; |ACABA; |FINSI;
     |HAZ CopiaEmp;

     |HAZ DecimalesBase;

     |HAZ BusCampos;
     |PINPA #0#0;
     |PINDA #0#0;

     |HAZ CargaDefs;
     |SI swErr ! 0;
          aMensa = "0000Error al cargar:" + aDef;
          |MENAV aMensa;
          |HAZ DesCargaDef;
          |ACABA;
     |FINSI;
     |HAZ NomeDat;

     |SI nSwAparecida = 0;
          efDFecha = #0#2;
          efHFecha = #0#3;
          |SUB_EJECUTA_NP "aparz007;EJECUTA";
          |BLANCO 1904 2252;
     |FINSI;

     |SI #0#1 = "S";               ||Borrar maestros
          |PUSHV 0101 2380;
          |SUB_EJECUTA_NP "agifa051.run";
          |POPV;
     |FINSI;

     aAlfa = "|NC";
     aAlfa = #dsm00005#aAlfa#;
     nVertical = aAlfa; nVertical = nVertical - 1;
     |HAZ MueveVertical;
     |ABRE #4;
     |ABRE #5;

     |SI #0#8 = "S";          ||Borrar Facturas
          |PINTA 2113 , blanco;
          |PINTA 2113 , "Facturas Ventas";
          |HAZ factu;
          |ABRE #8;
          |ABRE #9;
          |ABRE #11;     |ABRE #61;

          |BUCLE borrfact;
          |CIERRA #8;
          |CIERRA #9;
          |CIERRA #11;   |CIERRA #61;

          |DELINDEX #58;
          |DELINDEX #59;
          |DELINDEX #61;
     |FINSI;

     |SI #0#6 = "S";          ||Borrar Albaranes
          |PINTA 2113 , blanco;
          |PINTA 2113 , "Albaranes Ventas";
          |HAZ albar;
          |HAZ CargaKit;
          |ABRE #6;
          |ABRE #7;
          |ABRE #8;
          |BUCLE borralba;
          |CIERRA #8;
          |CIERRA #6;
          |CIERRA #7;
          |HAZ DescargaKit;

          |DELINDEX #56;
          |DELINDEX #57;

          |SI nSwAparecida = 0;
               |DDEF aAlfa;
               aAlfa = aAlfa + "aparm016";
               |CARGA_DEF aAlfa, refeaux1@;
               |SI FSalida = 0;
                    |ABRE #6;
                    |BUCLE aparm016;
                    |CIERRA #6
                    |DESCARGA_DEF #refeaux1@;
               |FINSI;
          |FINSI;
     |SINO;
          aTip = "AV";
          |BUCLE PasaVertical;
     |FINSI;

     |SI #0#4 = "S";
          |PINTA 2113 , blanco;
          |PINTA 2113 , "Pedidos Ventas";
          |HAZ pedi;
          |HAZ CargaKit;
          |ABRE #12;
          |ABRE #13;
          |BUCLE borrpedi;
          |CIERRA #13;
          |CIERRA #12;
          |HAZ DescargaKit;

          |DELINDEX #62;
          |DELINDEX #63;
     |SINO;
          aTip = "PV";
          |BUCLE PasaVertical;
     |FINSI;

     |SI #0#9 = "S";
          |PINTA 2113 , blanco;
          |PINTA 2113 , "Depositos";
          |HAZ depo;
          |HAZ CargaKit;
          |ABRE #14;
          |ABRE #15;
          |BUCLE borrdepo;
          |CIERRA #14;
          |CIERRA #15;
          |HAZ DescargaKit;

          |DELINDEX #64;
          |DELINDEX #65;
     |SINO;
          aTip = "DE";
          |BUCLE PasaVertical;
     |FINSI;

     |SI #0#11 = "S";
          |PINTA 2113 , blanco;
          |PINTA 2113 , "Facturas Contado";
          |HAZ facon;
          |HAZ CargaKit;
          |ABRE #16;
          |ABRE #17;
          |BUCLE borrcont;
          |CIERRA #16;
          |CIERRA #17;
          |HAZ DescargaKit;

          |DELINDEX #66;
          |DELINDEX #67;
     |SINO;
          aTip = "FC";
          |BUCLE PasaVertical;
     |FINSI;

     |SI #0#12 = "S";
          |PINTA 2113 , blanco;
          |PINTA 2113 , "Facturas Compras";
          |HAZ faccomp;
          |ABRE #18;
          |ABRE #19;
          |BUCLE borrcomp;
          |CIERRA #18;
          |CIERRA #19;

          |DELINDEX #68;
          |DELINDEX #69;
     |FINSI;

     |SI #0#13 = "S";
          |PINTA 2113 , blanco;
          |PINTA 2113 , "Albaranes Compras";
          |HAZ albcom;
          |HAZ CargaKit;
          |ABRE #21;
          |ABRE #22;
          |BUCLE borracomp;
          |CIERRA #21;
          |CIERRA #22;
          |HAZ DescargaKit;

          |DELINDEX #71;
          |DELINDEX #72;
     |SINO;
          aTip = "AC";
          |BUCLE PasaVertical;
     |FINSI;

     |SI #0#15 = "S";
          |PINTA 2113 , blanco;
          |PINTA 2113 , "Pedidos Compras";
          |HAZ pedcomp;
          |HAZ CargaKit;
          |ABRE #23;
          |ABRE #24;
          |BUCLE borrapcomp;
          |CIERRA #23;
          |CIERRA #24;
          |HAZ DescargaKit;

          |DELINDEX #73;
          |DELINDEX #74;
     |SINO;
          aTip = "PC";
          |BUCLE PasaVertical;
     |FINSI;

     |CIERRA #4;
     |CIERRA #5;
     |DELINDEX #5;  || BorraVertical

     |HAZ DesCargaDef;

     ||....borra todas los registros que no tengan alb/pedidos
     |ABRE #7;
     |ABRE #13;
     |BUCLE CorrigeEntregas;
     |CIERRA #13;
     |CIERRA #7;

     |SI #0#4 = "S"; |O #0#9 = "S"; |O #0#6 = "S"; |O #0#11 = "S";
          aAlfa = "|NC";
          aAlfa = #dsm00053#aAlfa#;
          nCamDa = aAlfa; nCamDa = nCamDa - 1;
          |ABRE #13;
          |ABRE #7;
          |ABRE #17;
          |ABRE #15;
          |BUCLE BorraDA;
          |CIERRA #15;
          |CIERRA #17;
          |CIERRA #7;
          |CIERRA #13;
     |FINSI;

     |SI nSwEvaristo = 0;
          |SUB_EJECUTA_NP "evarz033";
     |FINSI;


     |SI #0#17 = "S";         ||Borrar Historico
          |PINTA 2113 , blanco;
          |PINTA 2113 , "Fichero Historico";
          cierre = 1;
          descie = #0#2;
          hascie = #0#3;
          |SI nSwTaller = 0;
               descie = #conz0018@#34;
               hascie = #conz0018@#35;
          |FINSI;
          |SUB_EJECUTA_NP "agifa064.run";
     |FINSI;

     |SI #0#20 = "S";
          |PINTA 2113 , blanco;
          |PINTA 2113 , "Documentos TPV  ";
          |HAZ TPV;
     |FINSI;

     |SI #0#18 = "S";         ||Recalcular Pendientes
          |PINTA 2113 , blanco;
          |PINTA 2113 , "Recalculando Acumulados";
          cierre = 1;
          |SUB_EJECUTA_NP "agifa026.run";
     |FINSI;
|FPRC;

||======================= CAMBIOS DE NOMBRE DE FICHERO =====================

|PROCESO albar;
     origen = "010";     |HAZ mover;
     origen = "071";     |HAZ mover;
     aOrgKit = "dsm00047"; |HAZ MueveKit;
|FPRC;

|PROCESO pedi;
     origen = "104";     |HAZ mover;
     origen = "073";     |HAZ mover;
     aOrgKit = "dsm00046"; |HAZ MueveKit;
|FPRC;

|PROCESO depo;
     origen = "036";     |HAZ mover;
     origen = "070";     |HAZ mover;
     aOrgKit = "dsm00049"; |HAZ MueveKit;
|FPRC;

|PROCESO factu;
     origen = "134";     |HAZ mover;
     origen = "059";     |HAZ mover;
     origen = "133";     |HAZ mover;
|FPRC;

|PROCESO faccomp;
     origen = "079";     |HAZ mover;
     origen = "072";     |HAZ mover;
|FPRC;

|PROCESO facon;
     origen = "084";     |HAZ mover;
     origen = "069";     |HAZ mover;
     aOrgKit = "dsm00048"; |HAZ MueveKit;
|FPRC;

|PROCESO albcom;
     origen = "077";     |HAZ mover;
     origen = "080";     |HAZ mover;
     aOrgKit = "dsm00066"; |HAZ MueveKit;
|FPRC;

|PROCESO pedcomp;
     origen = "081";     |HAZ mover;
     origen = "067";     |HAZ mover;
     aOrgKit = "dsm00065"; |HAZ MueveKit;
|FPRC;

|PROCESO mover;
  |DFICE fich;
  temporal1 = fich + "agifa" + origen + ".ixx";
  temporal2 = fich + "expor" + origen + ".ixx";
  |COPIA_FICHERO temporal1,temporal2;
  |SI FSalida ! 0;  |ACABA;  |FINSI;
  |FBORRA temporal1;
  temporal1 = fich + "agifa" + origen + ".dat";
  temporal2 = fich + "expor" + origen + ".dat";
  |COPIA_FICHERO temporal1,temporal2;
  |SI FSalida ! 0;
      temporal2 = fich + "expor" + origen + ".ixx";
      |FBORRA temporal2;
      |ACABA;
  |FINSI;
  |FBORRA temporal1;
  temporal1 = fich + "agifa" + origen + ".ddx";
  temporal2 = fich + "expor" + origen + ".ddx";
  |COPIA_FICHERO temporal1,temporal2;
  |FBORRA temporal1;
|FPRC;

|PROCESO MueveVertical;
     |DFICE fich;

     temporal1 = fich + "dsm00005.ixx";
     temporal2 = fich + "expord05.ixx";
     |COPIA_FICHERO temporal1,temporal2;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FBORRA temporal1;

     temporal1 = fich + "dsm00005.dat";
     temporal2 = fich + "expord05.dat";
     |COPIA_FICHERO temporal1,temporal2;
     |SI FSalida ! 0;
         temporal2 = fich + "expord05.ixx";
         |FBORRA temporal2;
         |ACABA;
     |FINSI;
     |FBORRA temporal1;

     temporal1 = fich + "dsm00005.ddx";
     temporal2 = fich + "expord05.ddx";
     |COPIA_FICHERO temporal1,temporal2;
     |FBORRA temporal1;
|FPRC;

|PROCESO MueveKit;
     aExpKit = aOrgKit - "dsm";
     aExpKit = "exp" + aExpKit;

     |DFICE fich;
     temporal1 = fich + aOrgKit + ".ixx";
     temporal2 = fich + aExpKit + ".ixx";
     |COPIA_FICHERO temporal1,temporal2;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FBORRA temporal1;

     temporal1 = fich + aOrgKit + ".dat";
     temporal2 = fich + aExpKit + ".dat";
     |COPIA_FICHERO temporal1,temporal2;
     |SI FSalida ! 0;
         temporal2 = fich + aExpKit + ".ixx";
         |FBORRA temporal2;
         |ACABA;
     |FINSI;
     |FBORRA temporal1;

     temporal1 = fich + aOrgKit + ".ddx";
     temporal2 = fich + aExpKit + ".ddx";
     |COPIA_FICHERO temporal1,temporal2;
     |FBORRA temporal1;
|FPRC;

||========================= CAMPOS MODIFICABLES ============================
|PROCESO ped;
     |SI #0#4 = "N";
          |CAMPO_MODIFICA #0#5 , 1 , "N";
     |SINO;
          |CAMPO_MODIFICA #0#5 , 1 , "S";
     |FINSI;
|FPRC;

|PROCESO alb;
     |SI #0#6 = "N";
          |CAMPO_MODIFICA #0#7 , 1 , "N";
          |CAMPO_MODIFICA #0#21 , 1 , "N";
     |SINO;
          |CAMPO_MODIFICA #0#7 , 1 , "S";
          |CAMPO_MODIFICA #0#21 , 1 , "S";
     |FINSI;
|FPRC;

|PROCESO dep;
     |SI #0#9 = "N";
          |CAMPO_MODIFICA #0#10 , 1 , "N";
     |SINO;
          |CAMPO_MODIFICA #0#10 , 1 , "S";
     |FINSI;
|FPRC;

|PROCESO alc;
     |SI #0#13 = "N";
          |CAMPO_MODIFICA #0#14 , 1 , "N";
     |SINO;
          |CAMPO_MODIFICA #0#14 , 1 , "S";
     |FINSI;
|FPRC;

|PROCESO pec;
     |SI #0#15 = "N";
          |CAMPO_MODIFICA #0#16 , 1 , "N";
     |SINO;
          |CAMPO_MODIFICA #0#16 , 1 , "S";
     |FINSI;
|FPRC;
=======================================================================
|PROCESO BusCampos;
     |DFICE org; |QBF org;
     |DBASE des; |QBF des;
     |DDEF  def; |QBF def;
     eaNomDef = "agifa010"; |HAZ CamposDef; nTope010 = enCamposDef;
     eaNomDef = "agifa071"; |HAZ CamposDef; nTope071 = enCamposDef;
     eaNomDef = "agifa134"; |HAZ CamposDef; nTope134 = enCamposDef;
     eaNomDef = "agifa059"; |HAZ CamposDef; nTope059 = enCamposDef;
     eaNomDef = "agifa133"; |HAZ CamposDef; nTope133 = enCamposDef;
     eaNomDef = "agifa104"; |HAZ CamposDef; nTope104 = enCamposDef;
     eaNomDef = "agifa073"; |HAZ CamposDef; nTope073 = enCamposDef;
     eaNomDef = "agifa036"; |HAZ CamposDef; nTope036 = enCamposDef;
     eaNomDef = "agifa070"; |HAZ CamposDef; nTope070 = enCamposDef;
     eaNomDef = "agifa084"; |HAZ CamposDef; nTope084 = enCamposDef;
     eaNomDef = "agifa069"; |HAZ CamposDef; nTope069 = enCamposDef;
     eaNomDef = "agifa079"; |HAZ CamposDef; nTope079 = enCamposDef;
     eaNomDef = "agifa072"; |HAZ CamposDef; nTope072 = enCamposDef;
     eaNomDef = "agifa077"; |HAZ CamposDef; nTope077 = enCamposDef;
     eaNomDef = "agifa080"; |HAZ CamposDef; nTope080 = enCamposDef;
     eaNomDef = "agifa081"; |HAZ CamposDef; nTope081 = enCamposDef;
     eaNomDef = "agifa067"; |HAZ CamposDef; nTope067 = enCamposDef;
|FPRC;

|PROCESO CargaDefs;
     |DBASE aPath;

     aDef1 = aPath + "def/" + "agifa010"; aDef  = aDef1;
     |CARGA_DEF aDef, expor010@;
     |SI FSalida ! 0;
          swErr = 1; aDef1 = ""; |ACABA;
     |FINSI;
     aDef2 = aPath + "def/" + "agifa071"; aDef  = aDef2;
     |CARGA_DEF aDef, expor071@;
     |SI FSalida ! 0;
          swErr = 1; aDef2 = ""; |ACABA;
     |FINSI;
     aDef3 = aPath + "def/" + "agifa134"; aDef  = aDef3;
     |CARGA_DEF aDef, expor134@;
     |SI FSalida ! 0;
          swErr = 1; aDef3 = ""; |ACABA;
     |FINSI;
     aDef4 = aPath + "def/" + "agifa059"; aDef  = aDef4;
     |CARGA_DEF aDef, expor059@;
     |SI FSalida ! 0;
          swErr = 1; aDef4 = ""; |ACABA;
     |FINSI;
     aDef6 = aPath + "def/" + "agifa133"; aDef  = aDef6;
     |CARGA_DEF aDef, expor133@;
     |SI FSalida ! 0;
          swErr = 1; aDef6 = ""; |ACABA;
     |FINSI;
     aDef7 = aPath + "def/" + "agifa104"; aDef  = aDef7;
     |CARGA_DEF aDef, expor104@;
     |SI FSalida ! 0;
          swErr = 1; aDef7 = ""; |ACABA;
     |FINSI;
     aDef8 = aPath + "def/" + "agifa073"; aDef  = aDef8;
     |CARGA_DEF aDef, expor073@;
     |SI FSalida ! 0;
          swErr = 1; aDef8 = ""; |ACABA;
     |FINSI;
     aDef9 = aPath + "def/" + "agifa036"; aDef  = aDef9;
     |CARGA_DEF aDef, expor036@;
     |SI FSalida ! 0;
          swErr = 1; aDef9 = ""; |ACABA;
     |FINSI;
     aDef10 = aPath + "def/" + "agifa070"; aDef  = aDef10;
     |CARGA_DEF aDef, expor070@;
     |SI FSalida ! 0;
          swErr = 1; aDef10 = ""; |ACABA;
     |FINSI;
     aDef11 = aPath + "def/" + "agifa084"; aDef  = aDef11;
     |CARGA_DEF aDef, expor084@;
     |SI FSalida ! 0;
          swErr = 1; aDef11 = ""; |ACABA;
     |FINSI;
     aDef12 = aPath + "def/" + "agifa069"; aDef  = aDef12;
     |CARGA_DEF aDef, expor069@;
     |SI FSalida ! 0;
          swErr = 1; aDef12 = ""; |ACABA;
     |FINSI;
     aDef13 = aPath + "def/" + "agifa079"; aDef  = aDef13;
     |CARGA_DEF aDef, expor079@;
     |SI FSalida ! 0;
          swErr = 1; aDef13 = ""; |ACABA;
     |FINSI;
     aDef14 = aPath + "def/" + "agifa072"; aDef  = aDef14;
     |CARGA_DEF aDef, expor072@;
     |SI FSalida ! 0;
          swErr = 1; aDef14 = ""; |ACABA;
     |FINSI;
     aDef16 = aPath + "def/" + "agifa077"; aDef  = aDef16;
     |CARGA_DEF aDef, expor077@;
     |SI FSalida ! 0;
          swErr = 1; aDef16 = ""; |ACABA;
     |FINSI;
     aDef17 = aPath + "def/" + "agifa080"; aDef  = aDef17;
     |CARGA_DEF aDef, expor080@;
     |SI FSalida ! 0;
          swErr = 1; aDef17 = ""; |ACABA;
     |FINSI;
     aDef18 = aPath + "def/" + "agifa081"; aDef  = aDef18;
     |CARGA_DEF aDef, expor081@;
     |SI FSalida ! 0;
          swErr = 1; aDef18 = ""; |ACABA;
     |FINSI;
     aDef19 = aPath + "def/" + "agifa067"; aDef  = aDef19;
     |CARGA_DEF aDef, expor067@;
     |SI FSalida ! 0;
          swErr = 1; aDef19 = ""; |ACABA;
     |FINSI;
     aDef20 = aPath + "def/" + "dsm00005"; aDef  = aDef20;
     |CARGA_DEF aDef, expord05@;
     |SI FSalida ! 0;
          swErr = 1; aDef20 = ""; |ACABA;
     |FINSI;
|FPRC;

|PROCESO DesCargaDef;
     |SI aDef20 ! ""; |DESCARGA_DEF #expord05@; |FINSI;
     |SI aDef19 ! ""; |DESCARGA_DEF #expor067@; |FINSI;
     |SI aDef18 ! ""; |DESCARGA_DEF #expor081@; |FINSI;
     |SI aDef17 ! ""; |DESCARGA_DEF #expor080@; |FINSI;
     |SI aDef16 ! ""; |DESCARGA_DEF #expor077@; |FINSI;
     |SI aDef14 ! ""; |DESCARGA_DEF #expor072@; |FINSI;
     |SI aDef13 ! ""; |DESCARGA_DEF #expor079@; |FINSI;
     |SI aDef12 ! ""; |DESCARGA_DEF #expor069@; |FINSI;
     |SI aDef11 ! ""; |DESCARGA_DEF #expor084@; |FINSI;
     |SI aDef10 ! ""; |DESCARGA_DEF #expor070@; |FINSI;
     |SI aDef9  ! ""; |DESCARGA_DEF #expor036@; |FINSI;
     |SI aDef8  ! ""; |DESCARGA_DEF #expor073@; |FINSI;
     |SI aDef7  ! ""; |DESCARGA_DEF #expor104@; |FINSI;
     |SI aDef6  ! ""; |DESCARGA_DEF #expor133@; |FINSI;
     |SI aDef4  ! ""; |DESCARGA_DEF #expor059@; |FINSI;
     |SI aDef3  ! ""; |DESCARGA_DEF #expor134@; |FINSI;
     |SI aDef2  ! ""; |DESCARGA_DEF #expor071@; |FINSI;
     |SI aDef1  ! ""; |DESCARGA_DEF #expor010@; |FINSI;
|FPRC;

|PROCESO NomeDat;
     |NOME_DAT #74  "expor067";
     |NOME_DAT #73  "expor081";
     |NOME_DAT #72  "expor080";
     |NOME_DAT #71  "expor077";
     |NOME_DAT #69  "expor072";
     |NOME_DAT #68  "expor079";
     |NOME_DAT #67  "expor069";
     |NOME_DAT #66  "expor084";
     |NOME_DAT #65  "expor070";
     |NOME_DAT #64  "expor036";
     |NOME_DAT #63  "expor073";
     |NOME_DAT #62  "expor104";
     |NOME_DAT #61  "expor133";
     |NOME_DAT #59  "expor059";
     |NOME_DAT #58  "expor134";
     |NOME_DAT #57  "expor071";
     |NOME_DAT #56  "expor010";
     |NOME_DAT #5   "expord05";
|FPRC;

|PROGRAMA;
     aParam = PARAMETRO; |QBF aParam;

     |HAZ EsJamaica; nSwJamaica = FSalida;
     |HAZ EsAparecida; nSwAparecida = FSalida;
     |HAZ EsEvaristo; nSwEvaristo = FSalida;
     |HAZ EsTaller; nSwTaller = FSalida;


     |SI aParam = "iber21";
          |DDEF aDef;
          aDef = aDef + "iber0112";
          |CARGA_DEF aDef, iber0112@;
          |SI FSalida = 0;
               |ABRE #iber0112@;
               |LEE 000#iber0112@.p;
               |CIERRA #iber0112@;
               |PARA i = 1; |SI i [ 20; |HACIENDO i =  i + 1;
                    #0i = #iber0112@#i#;
               |SIGUE;
               |DESCARGA_DEF #iber0112@;
          |SINO;
               aDef = "0000 Error al cargar " + aDef;
               |MENAV aDef;
               |ACABA;
          |FINSI;

          |SI #0#1 = "S"; ||Maestros
               |PTEC 802; |PTEC 802; |PTEC 802; |PTEC 802;
          |FINSI;
          |SI #0#17 = "S"; ||Histo
               |PTEC 802; |PTEC 802; |PTEC 802;
          |FINSI;

          #0#0 = "SI";    ||Correcto
          |PINPA #1#0;
          |PINDA #1#0;
          |HAZ inicio;
          |ACABA;
     |FINSI;

     |SI nSwTaller = 0;
          |SUB_EJECUTA_NP "conz0018;PANTA";
          |SI enSalida = 0;
               |DDEF aAlfa; aAlfa = aAlfa + "conz0018";
               |CARGA_DEF aAlfa, conz0018@;
               |SI FSalida = 0;
                    |ABRE #conz0018@; |LEE 000#conz0018@.p; |CIERRA #conz0018@;
                    |PARA i = 0; |SI i [ 24; |HACIENDO i = i + 1;
                         #0i = #conz0018@#i#;
                    |SIGUE;
                    |SI #0#0 = "SI";
                         |PINPA #0#0;
                         |PINDA #0#0;
                         |HAZ inicio;
                         |SUB_EJECUTA_NP "conz0018";
                    |FINSI;
                    |DESCARGA_DEF #conz0018@;
               |FINSI;
          |FINSI;
          |ACABA;
     |FINSI;

     |MANTE #0;
|FPRO;

|PROCESO AparecePinta;
     |DDEF aAlfa;
     aAlfa = aAlfa + "aparz007";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |ABRE #referen@;
          |LEE 000#referen@.p;
          |CIERRA #referen@;
          |PINPA #0#referen@;
          |PINDA #0#referen@;
          |DESCARGA_DEF  #referen@;
     |FINSI;
|FPRC;

|PROCESO Tipo14; |TIPO 14;
     |SI nSwAparecida = 0; |Y nSwAparece = 0;
          |SUB_EJECUTA_NP "aparz007;INI";
          |HAZ AparecePinta;
          nSwAparece = 1;
     |FINSI;
|FPRC;

|PROCESO HastaFecha; |TIPO 0;
     |SI nSwAparecida = 0;
          |SUB_EJECUTA_NP "aparz007;ENTRA";
          |HAZ AparecePinta;
     |FINSI;
|FPRC;
