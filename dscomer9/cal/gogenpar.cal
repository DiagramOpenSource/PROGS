|FICHEROS;
     gogenpar #0;
     goartive #1;
     gofamive #5;
     gosubive #6;
     goapaive #7;
     gotmpptd #8;
     gosecive #9;
     goparame #10;
     agifa060 #15;
     agifa120 #16;
     agifa553 #19;
     gotmpcod #20,MANTE;
     agifa019 #21;
|FIN;
----------------------------------------------------------------------
|VARIABLES;
     &eaConsulta = "";
     &eaArticulo = "";
     dArt      = "";
     hArt      = "";
     &qAlta    = "";
     swVic     = 0;
     cCodigo   = "";
     cParti    = "";
     cSepara   = "";
     cFich     = "";
     aFich     = "";
     nCon      = 0;
     nCampo    = 0;
|FIN;
----------------------------------------------------------------------
|PROCESO Tecla0; |TIPO 0;
     |SI eaConsulta ! "S"; |ACABA; |FINSI;
     |SI FSalida = 0; |Y #20Campo = Contenido;
          eaArticulo = #20#0;
          |PTEC 807;
     |FINSI;
|FPRC;

|PROCESO Tecla7; |TIPO 7;
     |SI eaConsulta ! "S"; |ACABA; |FINSI;
     |MENSA "0000<ENTER> Aceptar articulo";
|FPRC;
----------------------------------------------------------------------
|PROCESO GenParti; |TIPO 0;
     |ABRE #10; |LEE 000#10p; |CIERRA #10;

     |SI Campo = 1;
          cParti = #0#1;
          |SI #10#90 = "S"; |Y #10#141 = "O";
               #0#3 = #0#1; |PINTA #0#3;
          |FINSI;
     |FINSI;
     |SI Campo = 3;
          cParti = #0#3;
     |FINSI;
     |SI Campo = 5;
          cParti = #0#5;
          |SI #10#90 = "S"; |Y #10#141 = "O";
               #0#7 = #0#5; |PINTA #0#7;
          |FINSI;
     |FINSI;
     |SI Campo = 7;
          cParti = #0#7;
     |FINSI;
     cCodigo = #0#9;
     cSepara = #0#10;
     |QBF cCodigo;
     |QBF cSepara;
     |QBF cParti;
     #0#0 = cParti + cSepara + cCodigo;
     |PINTA #0#0;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO CamDat; |TIPO 0;
     |SI Contenido ! #0Campo;
          nCampo = Campo + 2;
          |PARA nCon = nCampo; |SI nCon [ 9; |HACIENDO nCon = nCon + 1;
               #0nCon = "";
               |PINTA #0nCon;
          |SIGUE;
     |FINSI;
     |SI #10#90 = "S"; |Y #10#141 = "O";
          #0#3 = #0#1; |PINTA #0#3;
          #0#7 = #0#5; |PINTA #0#7;
     |FINSI;
|FPRC;

|PROCESO agifa019_par;
     #20#0 = #21#0;
     #20#1 = #21#1;
     |GRABA 020#20n;
|FPRC;

|DEFBUCLE agifa019_par;
     #21#1;
     ;
     dArt;
     hArt;
     ;
     NULL,agifa019_par;
|FIN;

-------------------------------------------------------------------------------
|PROCESO LisPtd; |TIPO 0;
     |SI qAlta = "P";
          |ENTLINEAL #9#8, 2, 4, 22, 0, cParMin, cParMax;
     |SINO;
          aFich = Usuario;
          |NOME_DAT #20 aFich;
          |DELINDEX #20;
          |ABRE #20;
          dArt = #0#7;
          hArt = #0#7;
          |QBF dArt;
          |QBF hArt;
          dArt = (dArt + "                    ") % 120;
          hArt = (hArt + "zzzzzzzzzzzzzzzzzzzz") % 120;
          |BUCLE agifa019_par;
          |CIERRA #20;
          |ENTLINEAL #1#20, 1, 4, 22, 0, cArtMin, cArtMax;
     |FINSI;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO cArtMin;
     #20#0  = "zzzzzzzzzzzzzzzzzzzz";
|FPRC;
-------------------------------------------------------------------------------
|PROCESO cArtMax;
     #20#0  = "                    ";
|FPRC;
------------------------------------------------------------------------------
|PROCESO cParMin;
     #8#13 = #0#7;
     #8#0  = "zzzzzzzzzzzzzzzzzzzz";
|FPRC;
-------------------------------------------------------------------------------
|PROCESO cParMax;
     #8#13 = #0#7;
     #8#0  = "                    ";
|FPRC;
-------------------------------------------------------------------------------
|PROCESO BusPtd; |TIPO 0;
     |ABRE #8;
     #8#0 = #0#0;
     |LEE 000#8=;
     |SI FSalida = 0;
          |MENAV "0000LA PARTIDA YA EXISTE EN EL BANCO DE DATOS";
          |ERROR;
     |FINSI;
     |CIERRA #8;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO EntPtd; |TIPO 13;
     |ENTLINEAL #5#8, 2, 7, 22, 0, cParMin, cParMax;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO AltaFam; |TIPO 0;
     |ABRE #5;
     #5#0 = #0#3;
     |LEE 101#5=;
     |SI FSalida ! 0;
          |C_M #5#2 , 1 , "N";
          #5#2 = #0#1;
          #5#3 = #0#2;
          #5#1 = "";
          |SI #10#90 = "S"; |Y #10#141 = "O";
               #5#1 = #0#2;
          |FINSI;
          |PUSHV 0501 2380;
          |PINPA #0#5;
          |PINDA #0#5;
          |ENDATOS #1#5;
          |SI FSalida = 0;
               |GRABA 020#5n;
               |HAZ alta060;
               #5#0 = #0#3;
               |LEE 101#5=;
          |SINO;
               |ERROR;
          |FINSI;
          |POPV;
     |FINSI;
     #0#3 = #5#0;
     #0#4 = #5#1;
     |PINTA #0#3;
     |PINTA #0#4;
     |LIBERA #5;
     |CIERRA #5;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO AltaSub; |TIPO 0;
     |ABRE #6;
     #6#0 = #0#5;
     |LEE 000#6=;
     |SI FSalida ! 0;
          |C_M #6#2 , 1 , "N";
          #6#2 = #0#3;
          #6#3 = #0#4;
          #6#1 = "";
          |PUSHV 0501 2380;
          |PINPA #0#6;
          |PINDA #0#6;
          |ENDATOS #1#6;
          |SI FSalida = 0;
            |GRABA 020#6n;
            |HAZ alta120;
            #6#0 = #0#5;
            |LEE 000#6=;
          |SINO;
               |ERROR;
          |FINSI;
          |POPV;
     |FINSI;
     #0#5 = #6#0;
     #0#6 = #6#1;
     |PINTA #0#5;
     |PINTA #0#6;
     |LIBERA #6;
     |CIERRA #6;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO AltaCap; |TIPO 0;
     |ABRE #7;
     #7#0 = #0#7;
     |LEE 000#7=;
     |SI FSalida ! 0;
          |C_M #7#2 , 1 , "N";
          #7#2 = #0#5;
          #7#3 = #0#6;
          #7#1 = "";
          |SI #10#90 = "S"; |Y #10#141 = "O";
               #7#1 = #0#6;
          |FINSI;
          |PUSHV 0501 2380;
          |BLANCO 1007 1776;
          |CUADRO 1007 1776;
          |PINPA #0#7;
          |PINDA #0#7;
          |ENDATOS #1#7;
          |SI FSalida = 0;
            |GRABA 020#7n;
          |SINO;
               |ERROR;
          |FINSI;
          |POPV;
     |FINSI;
     #0#7 = #7#0;
     #0#8 = #7#1;
     |PINTA #0#7;
     |PINTA #0#8;
     |LIBERA #7;
     |CIERRA #7;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO Consulfam; |TIPO 66;
     |ABRE #5;
     |DDEFECTO #5;
     |CONSULTA_F_CLAVE #4#5 , minf , maxf;
     |SI FSalida = 0;
          #0#3 = #5#0;
          #0#4 = #5#1;
          |PINTA #0#3;
          |PINTA #0#4;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #5;
|FPRC;

|PROCESO minf;
     #5#2 = #0#1;
     #6#2 = #0#3;
     #7#2 = #0#5;
|FPRC;

|PROCESO maxf;
     #5#2 = #0#1;
     #6#2 = #0#3;
     #7#2 = #0#5;
|FPRC;

|PROCESO Consulsub; |TIPO 66;
     |ABRE #6;
     |DDEFECTO #6;
     |CONSULTA_F_CLAVE #4#6 , minf , maxf;
     |SI FSalida = 0;
          #0#5 = #6#0;
          #0#6 = #6#1;
          |PINTA #0#5;
          |PINTA #0#6;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #6;
|FPRC;

|PROCESO Consulcap; |TIPO 66;
     |ABRE #7;
     |DDEFECTO #7;
     |CONSULTA_F_CLAVE #4#7 , minf , maxf;
     |SI FSalida = 0;
          #0#7 = #7#0;
          #0#8 = #7#1;
          |PINTA #0#7;
          |PINTA #0#8;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #7;
|FPRC;

|PROCESO gosubive;
     #16#0 = #6#0;
     |LEE 101#16=;
     |SI FSalida ! 0;
          #16#1 = #6#1;
          |GRABA 020#16n;
     |FINSI;
     |LIBERA #16;
|FPRC;

|DEFBUCLE gosubive;
     #6#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL,gosubive;
|FIN;

|PROCESO gofamive;
     #15#0 = #5#0;
     |LEE 101#15=;
     |SI FSalida ! 0;
          #15#1 = #5#1;
          |GRABA 020#15n;
     |FINSI;
     |LIBERA #15;
|FPRC;

|DEFBUCLE gofamive;
     #5#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL,gofamive;
|FIN;

|PROCESO gosecive;
     #19#0 = #9#0;
     |LEE 101#19=;
     |SI FSalida ! 0;
          #19#1 = #9#1;
          |GRABA 020#19n;
     |FINSI;
     |LIBERA #19;
|FPRC;

|DEFBUCLE gosecive;
     #9#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL,gosecive;
|FIN;

|PROCESO altasva; |TIPO 0;
     |ABRE #19;
     #19#0 = #0#1;
     |LEE 101#19=;
     |SI FSalida ! 0;
          #19#1 = #0#2;
          |GRABA 020#19n;
     |FINSI;
     |LIBERA #19;
     |CIERRA #19;
|FPRC;

|PROCESO alta060;
     |ABRE #15;
     |BUCLE gofamive;
     |CIERRA #15;
|FPRC;

|PROCESO alta120;
     |ABRE #16;
     |BUCLE gosubive;
     |CIERRA #16;
|FPRC;
