|FICHEROS;
     agifa010 #10,MANTE;
|FIN;

|VARIABLES;
     aCli = "";
     nDir = 0;
     nModo = 0;
     aAlfa = "";
     nBloquea = 0;
     aFic = "";
     nHandle = 0;
     aDato = "";
|FIN;

|PROCESO Edita;
     |CLS;
     |PINPA #0#10;
     |PINDA #0#10;
     |SI nModo = 1;
          |DDEFECTO #10;
          FEntrada = 101;
          |HAZ DefSerVta;
          |ENCAMPO #52#10;
          |SI FSalida = 0;
               FEntrada = 101;
               |HAZ ContaAV7;
               |ENCAMPO #0#10;
               |SI FSalida = 0;
                    nBloquea = 1;
                    |GRABA 020#10b;
                    |SI aCli ! ""; #10#3 = aCli; |FINSI;
                    |SI nDir ! 0; #10#84 = nDir; |FINSI;
                    |ENDATOS #1#10;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI nModo = 2; |ENDATOS #2#10; |FINSI;
     aAlfa = FSalida;
     |SI FSalida ! 0; |Y nModo = 1;
          |SI nBloquea = 1; |BORRA 020#10c; |FINSI;
     |FINSI;
     FSalida = aAlfa;
|FPRC;

|PROGRAMA;
     |ABRE #10;
     aAlfa = PARAMETRO % 105; #10#52 = aAlfa;
     aAlfa = PARAMETRO % 606; #10#0 = aAlfa;
     aAlfa = PARAMETRO % 1206; aCli = aAlfa;
     aAlfa = PARAMETRO % 1804; nDir = aAlfa;
     aFic = PARAMETRO % 22;
     |LEE 101#10=;
     |SI FSalida = 0;
          nModo = 2; |HAZ Edita;
     |SINO;
          nModo = 1; |HAZ Edita;
     |FINSI;
     aDato = #10#52 + (("000000" + #10#0) % -106);
     |SI FSalida = 0;
          |GRABA 020#10a;
     |SINO;
          |SI nModo = 1; aDato = ""; |FINSI;
     |FINSI;
     |CIERRA #10;

     |DFICE aAlfa;
     aFic = aAlfa + aFic;
     |XABRE "W", aFic, nHandle;
     |SI FSalida = 0;
          |XGRABA nHandle, aDato;
          |XCIERRA nHandle;
     |FINSI;
|FPRO;
