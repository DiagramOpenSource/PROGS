|FICHEROS;
     visem007 #0;
     visem008 #1,MANTE;
     visem009 #2,MANTE; || = visem008
     agifa017 #17;
     agifa019 #19;
     agifa065 #65;
     goartmer #10;
|FIN;

|VARIABLES;
     nHay = 0;
     nForma = 0;
     nModo = 0;
     aSerie = "";
     nConta = 0;
     {-1}aMenu = "";
     aMenu1 = "2400";
     aMenu2 = "1";
     aMenu3 = "";
     aMenu4 = "IAES";
     aMenu5 = " Imprimir ";
     aMenu6 = " Actualizar ";
     aMenu7 = " Entradas ";
     aMenu8 = " Salidas ";
|FIN;

|PROCESO Tipo12; |TIPO 12;
|FPRC;

|PROCESO DefAlma7; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          #0#2 = #0#0; |PINTA #0#2;
     |FINSI;
|FPRC;

|PROCESO Tipo7; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          aSerie = #0#0;
          #0#1 = 999999;
          |LEE 000#0];
          |SI FSalida = 0;
               |LEE 000#0a;
          |SINO;
               |LEE 000#0u;
          |FINSI;
          |SI FSalida = 0; |Y #0#0 = aSerie;
               nConta = #0#1 + 1;
          |SINO;
               nConta = 1;
          |FINSI;
          |DDEFECTO #0;
          #0#0 = aSerie;
          #0#1 = nConta;
     |FINSI;
|FPRC;

|PROCESO Min;
     #1#0 = #0#0;
     #1#1 = #0#1;
     #1#2 = "FB";
     #1#3 = 1;

     #2#0 = #0#0;
     #2#1 = #0#1;
     #2#2 = "SF";
     #2#3 = 1;
|FPRC;

|PROCESO Max;
     #1#0 = #0#0;
     #1#1 = #0#1;
     #1#2 = "FB";
     #1#3 = 999;

     #2#0 = #0#0;
     #2#1 = #0#1;
     #2#2 = "SF";
     #2#3 = 999;
|FPRC;

|PROCESO BorraLin;
     |BORRA 020#1a;
|FPRC;

|DEFBUCLE BorraLin;
     #1#1;
     ;
     #0#0, #0#1, "  ", 001;
     #0#0, #0#1, "zz", 999;
     be;
     NULL, BorraLin;
|FIN;

|PROCESO Tipo2; |TIPO 2;
     nForma = 0 +. 1;
     nModo = (FEntrada / 100) ! 0;
     |SI #0#5 = "S";
          |SI nForma = -1;
               |MENAV "0000Registro actualizado...";
          |FINSI;
          |ERROR; |ACABA;
     |FINSI;
     |SI nForma = 1;
          |ENTLINEAL #1#1, 4, 2, 14, 0, Min, Max;
          |ENTLINEAL #1#2, 4, 2, 21, 0, Min, Max;
          |CONFI "0000NImprimir Documento...";
          |SI FSalida = 0; |HAZ Imprimir; |FINSI;
     |FINSI;
     |SI nModo = 3;
          |BUCLE BorraLin;
     |FINSI;
|FPRC;

|PROCESO Tipo13; |TIPO 13;
     |ENTLINEAL #1#1, 4, 7, 14, 0, Min, Max;
     |ENTLINEAL #1#2, 4, 7, 21, 0, Min, Max;
|FPRC;

|PROCESO PrecioFB; |TIPO 0;
     |SI #1Campo ! Contenido;
/*
          |DDEFECTO #10;
          |ABRE #10;
          #10#0 = #1#4;
          |LEE 000#10=;
          |CIERRA #10;
          #1#7 = #10#1;
          |PINTA #1#7;
*/
          |DDEFECTO #19;
          |ABRE #19;
          #19#0 = #1#4;
          |LEE 000#19=;
          |CIERRA #19;
          #1#7 = #19#9;
          |PINTA #1#7;
     |FINSI;
|FPRC;

|PROCESO PrecioSF; |TIPO 0;
     |SI #2Campo ! Contenido;
          |ABRE #19;
          #19#0 = #2#4;
          |LEE 020#19=;
          |CIERRA #19;
          #2#7 = #19#18;
          |SI #2#7 = 0; #2#7 = #19#9; |FINSI;
          |PINTA #2#7;
     |FINSI;
|FPRC;

|PROCESO Tipo20; |TIPO 20;
     |SI FSalida = "OPCION";
          FSalida = "Opciones";
     |SINO;
          |LEE 101#0=;
          |SI FSalida ! 0; |ACABA; |FINSI;
          |MENU aMenu;
          aMenu2 = FSalida;
          |SI aMenu2 = 1; |HAZ Imprimir; |FINSI;
          |SI aMenu2 = 2; |HAZ Actualizar; |FINSI;
          |SI #0#5 = "S"; nModo = 4; |SINO nModo = 2; |FINSI;
          |SI aMenu2 = 3;
               |ENTLINEAL #1#1, 2, nModo, 14, 0, Min, Max;
          |FINSI;
          |SI aMenu2 = 4;
               |ENTLINEAL #1#2, 2, nModo, 21, 0, Min, Max;
          |FINSI;
          |LIBERA #0;
     |FINSI;
|FPRC;

|PROCESO Imprime;
     |PRINT;
     nHay = 1;
|FPRC;

|DEFBUCLE Imprime;
     #1#1;
     ;
     #0#0, #0#1, "  ", 001;
     #0#0, #0#1, "zz", 999;
     ;
     NULL, Imprime;
|FIN;

|PROCESO Imprimir;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "visem007";
          |SI FSalida ! 0;
               |MENAV "0000No existe informe 'visem007'";
          |SINO;
               nHay = 0;
               |BUCLE Imprime;
               |SI nHay = 0; |PRINT; |FINSI;
               |PIEINF;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO Actualiza;
     #19#0 = #1#4;
     |LEE 101#19=;
     |SI FSalida = 0;
          #17#0 = #1#4;
          #17#1 = #0#2;
          |LEE 101#17=;
          |SI FSalida = 0;
               |SI #1#2 = "FB";
                    #17#5 = #17#5 + #1#6;
                    #17#39 = #17#39 + #1#6;
                    #17#9 = #17#9 - #1#6;

                    #19#6 = #19#6 + #1#6;
                    #19#104 = #19#104 + #1#6;
                    #19#13 = #19#13 - #1#6;
               |SINO;
                    #17#5 = #17#5 - #1#6;
                    #17#39 = #17#39 - #1#6;
                    #19#6 = #19#6 - #1#6;
                    #19#104 = #19#104 - #1#6;
               |FINSI;
               |SI #17#9 < 0; #17#9 = 0; |FINSI;
               |SI #19#13 < 0; #19#13 = 0; |FINSI;
               |GRABA 020#17a;
               |LIBERA #17;
               |GRABA 020#19a;
          |FINSI;
          |LIBERA #19;
     |FINSI;

     |DDEFECTO #65;
     #65#0 = #1#4;
     #65#1 = #0#3;
     #65#2 = #1#2;
     #65#3 = #1#1;
     #65#4 = #1#3;
     #65#5 = #0#2;
     |SI #1#2 = "FB";
          #65#6 = #1#6;
     |SINO;
          #65#6 = -#1#6;
     |FINSI;
     #65#7 = #19#6;
     #65#8 = #19#9;
     #65#9 = #1#7;
     #65#11 = #1#0;
     #65#14 = #65#9;
     |GRABA 020#65n;
|FPRC;

|DEFBUCLE Actualiza;
     #1#1;
     ;
     #0#0, #0#1, "  ", 001;
     #0#0, #0#1, "zz", 999;
     ;
     NULL, Actualiza;
|FIN;

|PROCESO Actualizar;
     |SI #0#5 = "S";
          |MENAV "0000El registro ya esta actualizado...";
     |SINO;
          |ABRE #19;
          |ABRE #17;
          |ABRE #65;
          |BUCLE Actualiza;
          |CIERRA #65;
          |CIERRA #17;
          |CIERRA #19;
          #0#5 = "S";
          |GRABA 020#0a;
          |PINTA #0#5;
          |MENAV "0000Registro actualizado...";
     |FINSI;
|FPRC;

|PROCESO Tipo8_2; |TIPO 2;
     nForma = 0 +. 1;
     |SI #1#7 = 0; |Y nForma = 1;
          |MENAV "0000El precio no puede ser 0";
          |ERROR;
     |FINSI;
|FPRC;
