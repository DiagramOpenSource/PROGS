|FICHEROS;
     dsm00013 #0;
     dsm00011 #11;
     dsm00012 #12;
     dsm00010 #910;
     dsw00101 #101; ||Tmp
     dsw00102 #102; ||Tmp
|FIN;

|VARIABLES;
     aCod1 = "";
     aDCod2 = "";
     aHCod2 = "";
     aAlfa = "";
     nNume = 0;
     &enSwMalo = 0;
     &eAlfa    = "";
     &Tempo = "";
|FIN;

|PROCESO LongiCod13;   |TIPO 13;
     |ABRE #910;
     |LEE 040#910p;
     |SI FSalida ! 0;  |DDEFECTO #910;  |FINSI;
     |CIERRA #910;

     |PINTA 1220, #910#3;
     |PINTA 1320, #910#7;
     |PINTA 1420, #910#11;

     |ATRI R;
     |PINTA 1020, #910#11;
     |ATRI r;

     nNume = #910#4;
     aAlfa = "\" + #910#6 + "+#";
     |CAMPO_ANCHO  #0#0, 1, nNume;
     |CAMPO_MAXIMO #0#0, 1, aAlfa;

     nNume = #910#8;
     aAlfa = "\" + #910#10 + "+#";
     |CAMPO_ANCHO  #0#1, 1, nNume;
     |CAMPO_MAXIMO #0#1, 1, aAlfa;

     nNume = #910#12;
     aAlfa = "\" + #910#14 + "+#";
     |CAMPO_ANCHO  #0#2, 1, nNume;
     |CAMPO_MAXIMO #0#2, 1, aAlfa;
|FPRC;

|PROCESO Caracter13;  |TIPO 0;
     |ABRE #910;
     |LEE 040#910p;
     |SI FSalida ! 0;  |DDEFECTO #910;  |FINSI;
     |CIERRA #910;

     |SI #910#13 ! "N";  |ACABA;  |FINSI;

     eAlfa = #0Campo;  |QBF eAlfa;  |SUB_EJECUTA_NP "dsz99990;C";
     |SI enSwMalo = 1;
         |MENAV "     Introduccion Erronea";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO LlenaTmp;
     #11#0 = #0#0;
     |LEE 000#11=;
     |SI FSalida ! 0; |DDEFECTO #11; |FINSI;

     #12#0 = #0#0;
     #12#1 = #0#1;
     |LEE 000#12=;
     |SI FSalida ! 0; |DDEFECTO #12; |FINSI;

     #102#0 = #0#0;
     #102#1 = #11#1;
     #102#2 = #0#1;
     #102#3 = #12#2;
     #102#4 = #0#2;
     #102#5 = #0#3;
     |GRABA 020#102n;
|FPRC;

|DEFBUCLE LlenaTmp2;
     #0#1;
     ;
     aCod1, aDCod2, "                    ";
     aCod1, aHCod2, "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, LlenaTmp;
|FIN;

|PROCESO LlenaTmp1;
     #11#0 = #12#0;
     |LEE 000#11=;
     |SI FSalida ! 0; |DDEFECTO #11; |FINSI;

     #101#0 = #12#0;
     #101#1 = #11#1;
     #101#2 = #12#1;
     #101#3 = #12#2;
     |GRABA 020#101n;
|FPRC;

|DEFBUCLE LlenaTmp1;
     #12#1;
     ;
     #0#0, "                    ";
     #0#0, "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, LlenaTmp1
|FIN;

|PROCESO Tecla; |TIPO 6;
     |SI FSalida ! 12; |ACABA; |FINSI;  ||F4

     |SI Campo = 0;
          |ABRE #11;
          #11#0 = #0#0;
          |LEE 000#11];
          |CONSULTA_CLAVE #1#11;
          |SI FSalida = 0;
               #0#0 = #11#0; |PINTA #0#0;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #11;
     |FINSI;
     |SI Campo = 1;
          |HAZ CreaTempo; |NOME_DAT #101 Tempo; |DELINDEX #101;
          |ABRE #101;

          |SALVA_FICHA #0;
          |ABRE #11;
          |BUCLE LlenaTmp1;
          |CIERRA #11;
          |REPON_FICHA #0;
          #101#0 = #0#0;
          #101#2 = #0#1;
          |LEE 000#101];
          |CONSULTA_CLAVE #1#101;
          |SI FSalida = 0;
               #0#0 = #101#0; |PINTA #0#0;
               #0#1 = #101#2; |PINTA #0#1;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #101;

          |HAZ BoraTempo; |DELINDEX #101;
     |FINSI;
     |SI Campo = 2;
          |HAZ CreaTempo; |NOME_DAT #102 Tempo; |DELINDEX #102;
          |ABRE #102;

          |SALVA_FICHA #0;
          |ABRE #11;
          |ABRE #12;
          aCod1 = #0#0;
          aDCod2 = #0#1;
          aHCod2 = #0#1;
          |BUCLE LlenaTmp2;
          |CIERRA #11;
          |CIERRA #12;
          |REPON_FICHA #0;

          #102#0 = #0#0;
          #102#2 = #0#1;
          #102#4 = #0#2;
          |LEE 000#102];
          |CONSULTA_CLAVE #1#102;
          |SI FSalida = 0;
               #0#0 = #102#0; |PINTA #0#0;
               #0#1 = #102#2; |PINTA #0#1;
               #0#2 = #102#4; |PINTA #0#2;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #102;
          |HAZ BoraTempo; |DELINDEX #102;
     |FINSI;
|FPRC;

|DEFBUCLE LlenaTmp;
     #0#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, LlenaTmp;
|FIN;

|PROCESO Consulta; |TIPO 66;
     |HAZ CreaTempo; |NOME_DAT #102 Tempo; |DELINDEX #102;
     |ABRE #102;

     |SALVA_FICHA #0;
     |ABRE #11;
     |ABRE #12;
     |BUCLE LlenaTmp;
     |CIERRA #11;
     |CIERRA #12;
     |REPON_FICHA #0;

     #102#0 = #0#0;
     #102#2 = #0#1;
     #102#4 = #0#2;
     |LEE 000#102];
     |CONSULTA_CLAVE #1#102;
     |SI FSalida = 0;
          #0#0 = #102#0; |PINTA #0#0;
          #0#1 = #102#2; |PINTA #0#1;
          #0#2 = #102#4; |PINTA #0#2;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #102;
     |HAZ BoraTempo; |DELINDEX #102;
|FPRC;
