|FICHEROS;
     gestrz03 #0;
     gestrm01 #1;
     agifa019 #19;
     agifa060 #60;
     agi00063 #63;
     agifa120 #120;
|FIN;

|VARIABLES;
     aAlfa = "";
     aArti = "";
     nConta = 0;
|FIN;

|PROCESO Actualiza;
     #1#38 = #19#125;
     #1#39 = #19#5;
     #1#40 = #19#180;
     #1#41 = #19#179;
     #1#42 = #19#201;
     |GRABA 020#1a;
|FPRC;

|PROCESO Conta7; |TIPO 7;
     aArti = #0#0 + #0#1 + #0#2;
     |ABRE #19;
     #19#0 = aArti + "99";
     |LEE 000#19];
     |SI FSalida = 0;
          |LEE 000#19a;
     |SINO;
          |LEE 000#19u;
     |FINSI;
     aAlfa = #19#0 % 109;
     |SI aAlfa = aArti;
          aAlfa = #19#0 % 1002;
          nConta = aAlfa;
          nConta = nConta + 1;
     |SINO;
          nConta = 1;
     |FINSI;
     |CIERRA #19;
     #0#3 = nConta;
|FPRC;

|PROCESO Conta0; |TIPO 0;
     |SI FSalida = 2; |ACABA; |FINSI;
     aArti = #0#0 + #0#1 + #0#2 + (("00" + #0#3) % -102);
     |ABRE #19;
     #19#0 = aArti;
     |LEE 000#19=;
     |SI FSalida = 0;
          |MENAV "0000Art¡culo existente...";
          |ERROR;
     |FINSI;
     |CIERRA #19;
|FPRC;

|PROCESO Des; |TIPO 0;
     |ABRE #60;
     #60#0 = #0#0;
     |LEE 020#60=;
     |CIERRA #60;
     aAlfa = #60#1; |QBF aAlfa;
     |ABRE #120;
     #120#0 = #0#1;
     |LEE 020#120=;
     |CIERRA #120;
     aAlfa = aAlfa + " " + #120#1; |QBF aAlfa;
     |ABRE #63;
     #63#0 = #0#2;
     |LEE 020#63=;
     |CIERRA #63;
     aAlfa = aAlfa + " " + #63#1; |QBF aAlfa;
     #0#4 = aAlfa; |PINTA #0#4;
|FPRC;

|PROCESO Fam; |TIPO 6;
     |ABRE #60;
     #60#0 = #0#0;
     |LEE 000#60=;
     |SI FSalida ! 0;
          aAlfa = "*gestrz04;F" + #0#0;
          |SUB_EJECUTA_NP aAlfa;
          |LEE 000#60=;
          |SI FSalida ! 0; |ERROR; |FINSI;
     |FINSI;
     |CIERRA #60;
|FPRC;

|PROCESO Sub; |TIPO 6;
     |ABRE #120;
     #120#0 = #0#1;
     |LEE 000#120=;
     |SI FSalida ! 0;
          aAlfa = "*gestrz04;S" + #0#1;
          |SUB_EJECUTA_NP aAlfa;
          |LEE 000#120=;
          |SI FSalida ! 0; |ERROR; |FINSI;
     |FINSI;
     |CIERRA #120;
|FPRC;

|PROCESO Mar; |TIPO 6;
     |ABRE #63;
     #63#0 = #0#2;
     |LEE 000#63=;
     |SI FSalida ! 0;
          aAlfa = "*gestrz04;M" + #0#2;
          |SUB_EJECUTA_NP aAlfa;
          |LEE 000#63=;
          |SI FSalida ! 0; |ERROR; |FINSI;
     |FINSI;
     |CIERRA #63;
|FPRC;

|PROCESO T12; |TIPO 12;
|FPRC;

|PROGRAMA;
     |ABRE #1;
     |LEE 101#1p;
     |SI FSalida ! 0; |GRABA 020#1b; |FINSI;
     |PINPA #0#0;
     |PINDA #0#0;
     |PARA; |SI; |HACIENDO;
          |ENDATOS #1#0;
          |SI FSalida = 0;
               aArti = #0#0 + #0#1 + #0#2 + (("00" + #0#3) % -102);
               aAlfa = "*gestrz04;A" + aArti + #0#4;
               |SUB_EJECUTA_NP aAlfa;
               |ABRE #19;
               #19#0 = aArti;
               |LEE 000#19=;
               |SI FSalida = 0;
                    |HAZ Actualiza;
               |FINSI;
               |CIERRA #19;
          |SINO;
               |SAL;
          |FINSI;
     |SIGUE;
     |CIERRA #1;
|FPRO;
