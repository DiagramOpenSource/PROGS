|FICHEROS;
     iberca06 #0;
     agifa120 #1;
|FIN;

|VARIABLES;
     nSal   = 0;
     nForma = 0;
     nModo  = 0;
     aLon   = "";
|FIN;

|PROCESO Longi; |TIPO 0;
     aLon = #0#0; |QBF aLon;
     aLon = aLon % A0;
     |SI aLon ! 4;
          |MENAV "0000El Codigo debe ser de 4 digitos...";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tipo2ca6;  |TIPO 2;
     nForma = 0 +. 1;
     nModo  = (FEntrada / 100) ! 0;

     |SI nModo = 3;
         |ABRE #1;
         #1#0 = #0#0;
         |LEE 101#1=;
         |SI FSalida = 0;
             |BORRA 020#1a;
             |LIBERA #1;
         |FINSI;
         |CIERRA #1;
         |ACABA;
     |FINSI;

     |SI nForma = 1;
         |ABRE #1;
         #1#0 = #0#0;
         |LEE 101#1=;
         |SI FSalida ! 0;
             |DDEFECTO #1;
             #1#0 = #0#0;
             |GRABA 020#1b;
         |FINSI;
         #1#1 = #0#1;
         |GRABA 020#1a;
         |LIBERA #1;
         |CIERRA #1;
     |FINSI;
|FPRC;

|PROCESO agifa120;
     |DDEFECTO #0;
     #0#0 = #1#0;
     |LEE 101#0=;
     nSal = FSalida;
     #0#0 = #1#0;
     #0#1 = #1#1;
     |SI nSal = 0; |GRABA 000#0a; |FINSI;
     |SI nSal ! 0; |GRABA 000#0n; |FINSI;
     |LIBERA #0;
|FPRC;

|DEFBUCLE agifa120;
     #1#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL,agifa120;
|FIN;

|PROCESO carga; |TIPO 8;
     |BUCLE agifa120;
|FPRC;
