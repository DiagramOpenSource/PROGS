|FICHEROS;
     agitp001 #1;
     agifa007 #7;
     agifa017 #17;
     agifa019 #19;
     agifa024 #24;
     dsm00043 #43;
     dsm00044 #44;
     agifa071 #71;
     guerm211@;
     agifa067 #67;
     agifa081 #81;
|FIN;

|VARIABLES;
     &eaSerieTra = "";
     &enNumeroTra = 0;
     &enLineaTra = 0;

     &eaMovimi = "";
     &enCodigo = 0;
     &eaSerie = "";
     &enLinea = 0;
     &efFecha = @;
     &enForma = 0;
     &enModo = 0;

     aAlfa = "";
     aDef = "";
|FINS;

|PROCESO GueDepoRegula;
     |ABRE #24;
     #24#0 = #71#15;
     |LEE 000#24=;
     |CIERRA #24;

     |ABRE #43;
     |ABRE #44;
     |DDEFECTO #43;
     |DDEFECTO #44;
     #43#4 = #71#29;
     #43#0 = #71#0;
     |LEE 101#43=;
     |SI FSalida ! 0; |GRABA 020#43b; |FINSI;
     #43#1 = efFecha;
     #43#2 = #24#0;
     #43#3 = #24#2;

     #44#21 = #43#4;
     #44#18 = #43#0;
     #44#8 = #71#1;
     |LEE 101#44=;
     |SI FSalida ! 0; |GRABA 020#44b; |FINSI;

     #44#0 = #71#2;
     #44#1 = #71#3;
     #44#4 = #71#5;
     #44#5 = #43#1;
     #44#6 = #19#185;
     #44#7 = "E";
     #44#12 = #71#48;
     #44#13 = #71#49;
     #44#14 = #71#50;
     #44#15 = #71#51;
     #44#16 = #71#52;
     #44#17 = #71#53;
     #44#20 = #19#104;

||     enCodigo = #44#18;
||     |HAZ AcumulaES_SS;        || Con esto da procesos dublicados;
     |GRABA 020#43a;
     |GRABA 020#44a;
     |LIBERA #44;
     |LIBERA #43;
     eaMovimi = "ES_SS";
     eaSerie = #44#21;
     enCodigo = #44#18;
     enLinea = #44#8;
     |SUB_EJECUTA_NP "dsz90001"; || lo hago con un sub_ejecuta
     |LEE 121#44=;
     |LEE 121#43=;

     #44#3 = #17#39;
     #44#19 = #17#5;

     |SI enModo = 3;
          |BORRA 020#44a;
          #44#8 = 1;
          |LEE 000#44];
          |SI FSalida ! 0; |O #44#21 ! #43#4; |O #44#18 ! #43#0;
               #43#4 = #71#29;
               #43#0 = #71#0;
               |BORRA 020#43c;
          |FINSI;
     |SINO;
          |GRABA 020#44a;
          |GRABA 020#43a;
     |FINSI;

     |CIERRA #44;
     |CIERRA #43;
|FPRC;

|PROCESO GueCreaLinPed;
     |DDEF aDef;
     aAlfa = aDef + "guerm211";
     |CARGA_DEF aAlfa, guerm211@
     |SI FSalida ! 0;
          |MENAV "0000Error al cargar 'guerm211'"; |ACABA;
     |FINSI;
     |ABRE #guerm211@;
     #guerm211@#0 = eaSerieTra;
     #guerm211@#1 = enNumeroTra;
     #guerm211@#2 = enLineaTra;
     |LEE 020#guerm211@.=;
     |CIERRA #guerm211@;

     |ABRE #1;
     #1#0 = #81#4;
     #1#1 = #guerm211@#3;
     |LEE 000#1=;
     |CIERRA #1;

     |ABRE #19;
     #19#0 = #guerm211@#3;
     |LEE 000#19=;
     |CIERRA #19;

     |ABRE #7;
     #7#26 = #81#25;
     |LEE 000#7=;
     |CIERRA #7;

     #67#2 = #guerm211@#3;
     #67#3 = 1;
     #67#4 = #guerm211@#4;
     #67#5 = #guerm211@#8;
     #67#6 = #1#9;
     #67#8 = #1#4;
     #67#13 = #81#2;
     |SI #7#30 = "S";
          #67#14 = 0;
     |SINO;
          #67#14 = #19#30;
     |FINSI;
     #67#18 = #19#2;
     #67#20 = #81#4;
     #67#23 = #81#5;
     #67#24 = #81#6;
     #67#25 = #81#17;
     #67#26 = #81#9;
     #67#27 = #1#5;
     #67#57 = #1#10;
     #67#33 = #1#9;
     |DESCARGA_DEF #guerm211@;
|FPRC;
