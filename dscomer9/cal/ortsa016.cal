|FICHEROS;
     ortsm015 #15;  ||Ped Cab
     ortsm016 #16;  ||Ped Lin
     ortsm017 #17,MANTE;  ||Ped Combi
     ortsm018 #18,MANTE;  ||Ped Combi Uni
     ortsm019 #19;  ||Aux Escan
     ortsm020 #20;  ||Aux Excan Lin
     ortsm027 #27;
     ortsm028 #28;
     ortsm029 #29,MANTE;
     ortsm030 #30,MANTE;
     ortsm031 #31,MANTE;
     ortsm032 #32,MANTE;
     ortsm037 #37;
     agifa049 #49;
     agifa048 #480;
     agifa019 #190;
     ortsz016 #160,MANTE;
     ortsz017 #170,MANTE;
     ortsw009 #109,MANTE;
     referen@;
|FIN;

|VARIABLES;
     &eaTecla = "";
     &Tempo = "";
     aArti = "";
     nHay = 0;
     nMarca = 0;
     aAlfa = "";
     nLin = 0;
     nLinSel = 0;
     nCoste = 0;
     nModoLin = 0;
     &enModo = 0;
     &enInkey = 0;
     nBtnHerraje = 0;
     nBtnCanteado = 0;
     &eaTira = "";
     &eaCombi = "";
     &eaArticulo = "";
     nModo = 0;
     aVer = "";
     i = 0;
     nSwCombi = 0;
     nSwTira = 0;
     aDCombi = "";
     aHCombi = "";
     aDTira = "";
     aHTira = "";
|FIN;

|PROCESO Bortsm031;
     |BORRA 020#31a;
|FPRC;

|PROCESO Bortsm032;
     |BORRA 020#32a;
|FPRC;

|DEFBUCLE Bortsm031;
     #31#1;
     ;
     #16#28, #16#0, #16#1, "                    ";
     #16#28, #16#0, #16#1, "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, Bortsm031;
|FIN;

|DEFBUCLE Bortsm032;
     #32#1;
     ;
     #16#28, #16#0, #16#1, 001;
     #16#28, #16#0, #16#1, 999;
     ;
     NULL, Bortsm032;
|FIN;

|PROCESO BorraAuxOrts;
     |BUCLE Bortsm031;
     |BUCLE Bortsm032;
|FPRC;

|PROCESO Min31;
     #31#0 = #16#28;
     #31#1 = #16#0;
     #31#2 = #16#1;
     #31#3 = "                    ";
|FPRC;

|PROCESO Max31;
     #31#0 = #16#28;
     #31#1 = #16#0;
     #31#2 = #16#1;
     #31#3 = "zzzzzzzzzzzzzzzzzzzz";
|FPRC;

|PROCESO Min32;
     #32#0 = #16#28;
     #32#1 = #16#0;
     #32#2 = #16#1;
     #32#3 = 001;
|FPRC;

|PROCESO Max32;
     #32#0 = #16#28;
     #32#1 = #16#0;
     #32#2 = #16#1;
     #32#3 = 999;
|FPRC;

|PROCESO TeclaOrts;
     |SI enInkey = 16; ||F7
          |PUSHV 0501 2380;
          |ENTLINEAL #1#32, 4, enModo, 22, 1, Min32, Max32;
          |POPV;
          |ERROR; |ACABA;
     |FINSI;
     |SI enInkey = 17; ||F8
          |PUSHV 0501 2380;
          |ENTLINEAL #1#31, 4, enModo, 22, 1, Min31, Max31;
          |POPV;
          |ERROR; |ACABA;
     |FINSI;
|FPRC;

|PROCESO Min29;
     #29#0 = #17#0;
     #29#1 = #17#1;
     #29#2 = #17#2;
     #29#3 = #17#3;
     #29#4 = "                    ";
|FPRC;

|PROCESO Max29;
     #29#0 = #17#0;
     #29#1 = #17#1;
     #29#2 = #17#2;
     #29#3 = #17#3;
     #29#4 = "zzzzzzzzzzzzzzzzzzzz";
|FPRC;

|PROCESO Min30;
     #30#0 = #17#0;
     #30#1 = #17#1;
     #30#2 = #17#2;
     #30#3 = #17#3;
     #30#4 = 0;
     #30#5 = " ";
     #30#16 = 0;
|FPRC;

|PROCESO Max30;
     #30#0 = #17#0;
     #30#1 = #17#1;
     #30#2 = #17#2;
     #30#3 = #17#3;
     #30#4 = 9;
     #30#5 = "z";
     #30#16 = 99;
|FPRC;

|PROCESO TecOrt11; |TIPO 11;
     |HAZ TecOrt17;
|FPRC;

|PROCESO LargoAncho; |TIPO 0;
     |SI #160Campo ! Contenido;
          |SI Campo = 16;
               #160#14 = #160#16; |PINTA #160#14;
          |SINO;
               #160#13 = #160#17; |PINTA #160#13;
          |FINSI;
          |SI #160#13 ! 0; |Y #160#14 ! 0;
               #160#15 = "S";
          |SINO;
               #160#15 = "N";
          |FINSI;
          |PINTA #160#15;
     |FINSI;
|FPRC;

|PROCESO CodCompo; |TIPO 0;
     |SI #160Campo ! Contenido;
          |ABRE #190;
          #190#0 = #160#4;
          |LEE 000#190=;
          |SI FSalida = 0;
               #160#13 = #190#116; |PINTA #160#13;
               #160#14 = #190#115; |PINTA #160#14;
               #160#16 = #190#116; |PINTA #160#16;
               #160#17 = #190#115; |PINTA #160#17;
               #160#18 = #190#114; |PINTA #160#18;

               |SI #160#13 ! 0; |Y #160#14 ! 0;
                    #160#15 = "S";
               |SINO;
                    #160#15 = "N";
               |FINSI;
               |PINTA #160#15;

          |FINSI;
          |CIERRA #190;
     |FINSI;
|FPRC;

|PROCESO TecOrt17; |TIPO 6;
     |SI FSalida = 14;
          |PUSHV 0501 2380;
          |ENTLINEAL #1#29, 4, nModoLin, 20, 1, Min29, Max29;
          |POPV;
          |ERROR; |ACABA;
     |FINSI;
     |SI FSalida = 15;
          |PUSHV 0501 2380;
          |ENTLINEAL #1#30, 5, nModoLin, 20, 1, Min30, Max30;
          |POPV;
          |ERROR; |ACABA;
     |FINSI;
|FPRC;

|PROCESO CheqModi18;
     |SI #18#5 ! eaCombi;
          nSwCombi = 1;
     |FINSI;

     #17#0 = #18#0;
     #17#1 = #18#1;
     #17#2 = #18#2;
     #17#3 = #18#3;
     |LEE 000#17=;
     |SI FSalida = 0;
          #20#0 = #16#2;
          #20#1 = #17#3;
          |LEE 000#20=;
          |SI FSalida = 0; |Y #20#2 = "T";
               |SI #18#6 ! eaTira;
                    nSwTira = 1;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE CheqModi18;
     #18#1;
     ;
     #16#28, #16#0, #16#1, 000, 000;
     #16#28, #16#0, #16#1, 999, 999;
     be;
     NULL, CheqModi18;
|FIN;

|PROCESO CheqModi17;
     |SI #17#6 ! eaCombi;
          nSwCombi = 1;
     |FINSI;
     #20#0 = #16#2;
     #20#1 = #17#3;
     |LEE 000#20=;
     |SI FSalida = 0; |Y #20#2 = "T";
          |SI #17#11 ! eaTira;
               nSwTira = 1;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE CheqModi17;
     #17#1;
     ;
     #16#28, #16#0, #16#1, 000;
     #16#28, #16#0, #16#1, 999;
     ;
     NULL, CheqModi17;
|FIN;

|PROCESO Actua18;
     #18#5 = #16#59;

     #17#0 = #18#0;
     #17#1 = #18#1;
     #17#2 = #18#2;
     #17#3 = #18#3;
     |LEE 000#17=;
     |SI FSalida = 0;
          #20#0 = #16#2;
          #20#1 = #17#3;
          |LEE 000#20=;
          |SI FSalida = 0; |Y #20#2 = "T";
               #18#6 = #16#60;    ||Tirador
          |FINSI;
     |FINSI;
     |GRABA 020#18a;
|FPRC;

|DEFBUCLE Actua18;
     #18#1;
     5, 6;
     #16#28, #16#0, #16#1, 000, 000, aDCombi, aDTira;
     #16#28, #16#0, #16#1, 999, 999, aHCombi, aHTira;
     be;
     NULL, Actua18;
|FIN;

|PROCESO Actua17;
     #17#6 = #16#59;
     |SI #17#12 = "H"; #17#6 = "";|FINSI;

     #190#0 = #17#4;
     |LEE 000#190=;
     |SI FSalida ! 0; |DDEFECTO #190; |FINSI;
     |SI #190#125 = "K "; #17#6 = "MET"; |FINSI;

     #20#0 = #16#2;
     #20#1 = #17#3;
     |LEE 000#20=;
     |SI FSalida = 0; |Y #20#2 = "T";
          #17#11 = #16#60;    ||Tirador
     |FINSI;
     |GRABA 020#17a;
|FPRC;

|DEFBUCLE Actua17;
     #17#1;
     6, 11;
     #16#28, #16#0, #16#1, 000, aDCombi, aDTira;
     #16#28, #16#0, #16#1, 999, aHCombi, aHTira;
     be;
     NULL, Actua17;
|FIN;

|PROCESO Borra18;
     |BORRA 020#18a;
|FPRC;

|DEFBUCLE Borra18;
     #18#1;
     ;
     #17#0, #17#1, #17#2, #17#3, 1;
     #17#0, #17#1, #17#2, #17#3, 999;
     be;
     NULL, Borra18;
|FIN;

|PROCESO Borra17;
     |BUCLE Borra18;
     |BORRA 020#17a;
|FPRC;

|DEFBUCLE Borra17;
     #17#1;
     ;
     #16#28, #16#0, #16#1, 000;
     #16#28, #16#0, #16#1, 999;
     be;
     NULL, Borra17;
|FIN;

|PROCESO Borra29;
     |BORRA 020#29a;
|FPRC;

|DEFBUCLE Borra29;
     #29#1;
     ;
     #16#28, #16#0, #16#1, 000, "                    ";
     #16#28, #16#0, #16#1, 999, "zzzzzzzzzzzzzzzzzzzz";
     be;
     NULL, Borra29;
|FIN;

|PROCESO Borra30;
     |BORRA 020#30a;
|FPRC;

|DEFBUCLE Borra30;
     #30#1;
     ;
     #16#28, #16#0, #16#1, 001, 0, " ", 00;
     #16#28, #16#0, #16#1, 999, 9, "z", 99;
     be;
     NULL, Borra30;
|FIN;

|PROCESO Crea18;
     |ABRE #37;
     |PARA i = 1; |SI i [ #17#7; |HACIENDO i = i + 1;
          #37#0 = #16#2;
          #37#1 = #17#3;
          #37#2 = i;
          |LEE 000#37=;
          |SI FSalida ! 0; |DDEFECTO #37; |FINSI;

          #18#0 = #17#0;
          #18#1 = #17#1;
          #18#2 = #17#2;
          #18#3 = #17#3;
          #18#4 = i;
          #18#5 = #17#6;
          #18#6 = #17#11;
          #18#7 = #37#3;
          #18#8 = #37#4;
          #18#9 = #37#5;
          #18#10 = #37#6;
          #18#11 = #37#7;
          #18#12 = #37#8;
          #18#13 = #37#9;
          #18#14 = #37#10;
          #18#15 = #37#11;
          #18#16 = #37#12;
          #18#17 = #37#13
          |GRABA 020#18n;
     |SIGUE;
     |CIERRA #37;
|FPRC;

|PROCESO Desglose0; |TIPO 0;
     |PARA i = 0; |SI i [ 26; |HACIENDO i = i + 1;
          #17i = #160i;
     |SIGUE;
     |SI #17#8 = "S";
          |SI Contenido = "N";
               |HAZ Crea18;
          |FINSI;
          |PUSHV 0501 2380;
          |ENTLINEAL #1#18, 5, 2, 22, 1, Min18, Max18;
          |POPV;

          #17#6 = #16#59; ||PINTA #17#6;
          |SI #17#12 = "H"; #17#6 = "";|FINSI;

          |ABRE #190;
          #190#0 = #17#4;
          |LEE 000#190=;
          |SI FSalida ! 0; |DDEFECTO #190; |FINSI;
          |CIERRA #190;
          |SI #190#125 = "K "; #17#6 = "MET"; |FINSI;

          |SI #17#12 = "T";
               #17#11 = #16#60; |||PINTA #17#11;
          |FINSI;
     |SINO;
          |BUCLE Borra18;
     |FINSI;
|FPRC;

|PROCESO Desglose7; |TIPO 7;
     |SI #160#7 > 1;
          |C_M #160#8, 1, "S";
     |SINO;
          |C_M #160#8, 1, "N";
     |FINSI;
|FPRC;

|PROCESO Cambia18;
     |SI Campo = 6; || Combinacion
          #18#5 = #160#6;
     |FINSI;
     |SI Campo = 11; || Tirador
          #18#6 = #160#11;
     |FINSI;
     |GRABA 020#18a;
|FPRC;

|DEFBUCLE Cambia18;
     #18#1;
     ;
     #17#0, #17#1, #17#2, #17#3, 1;
     #17#0, #17#1, #17#2, #17#3, 999;
     be;
     NULL, Cambia18;
|FIN;

|PROCESO Cambia160; |TIPO 0;
     |SI #160Campo ! Contenido;
          |BUCLE Cambia18;
     |FINSI;
|FPRC;

|PROCESO NoBaja; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3; |AVISO; |ERROR; |FINSI;
|FPRC;

|PROCESO T12; |TIPO 12;
|FPRC;

|PROCESO NoAlta; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI FSalida = 0; |Y nModo = 4;
          |PARA i = 0; |SI i [ 33; |HACIENDO i = i + 1;
               #160i = #17i;
          |SIGUE;
          |PUSHV 0501 2380;
          |PINPA #0#160;
          |PINDA #0#160;
          |PAUSA;
          |POPV;
     |FINSI;

     |SI nModo = 1; |AVISO; |ERROR; |FINSI;
     |C_M #17#6, 1, "S";
|FPRC;

|PROCESO Componentes; |TIPO 7;
     |C_M #17#6, 1, "N";
     |PARA i = 0; |SI i [ 33; |HACIENDO i = i + 1;
          #160i = #17i;
     |SIGUE;
     |PUSHV 0501 2380;
     |PINPA #0#160;
     |PINDA #0#160;
     |ENDATOS #2#160;
     |PARA i = 0; |SI i [ 33; |HACIENDO i = i + 1;
          #17i = #160i;
     |SIGUE;
     |POPV;
|FPRC;

|PROCESO Min18;
     #18#0 = #17#0;
     #18#1 = #17#1;
     #18#2 = #17#2;
     #18#3 = #17#3;
     #18#4 = 001;
|FPRC;

|PROCESO Max18;
     #18#0 = #17#0;
     #18#1 = #17#1;
     #18#2 = #17#2;
     #18#3 = #17#3;
     #18#4 = 999;
|FPRC;

|PROCESO CombUni; |TIPO 11;
     |SI FSalida = 10;   ||F2
          |HAZ ConsultaPed;
          |ERROR;
     |FINSI;
     |SI FSalida = 13;   ||F5
          |SI #17#8 = "S";
               |PUSHV 0501 2380;
               |SI aVer = "S";
                    |ENTLINEAL #1#18, 5, 4, 22, 1, Min18, Max18;
               |SINO;
                    |ENTLINEAL #1#18, 5, 2, 22, 1, Min18, Max18;
               |FINSI;
               |POPV;
          |SINO;
               |MENAV "0000No tiene desglose de unidades...";
          |FINSI;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Min17;
     #17#0 = #16#28;
     #17#1 = #16#0;
     #17#2 = #16#1;
     #17#3 = 001;
|FPRC;

|PROCESO Max17;
     #17#0 = #16#28;
     #17#1 = #16#0;
     #17#2 = #16#1;
     #17#3 = 999;
|FPRC;

|PROCESO ortsm028;
     #30#0 = #16#28;
     #30#1 = #16#0;
     #30#2 = #16#1;
     #30#3 = #28#1;
     #30#4 = #28#2;
     #30#5 = #28#3;
     #30#6 = #28#10;
     #30#8 = #28#6;
     #30#9 = #28#7;
     #30#10 = #28#8;
     #30#11 = #28#9;
     #30#12 = #28#10; ||#28#5;
     #30#13 = #28#11;
     #30#14 = #28#12;
     #30#15 = #28#13;
     #30#16 = #28#14;
     |GRABA 020#30n;
|FPRC;

|DEFBUCLE ortsm028;
     #28#1;
     ;
     #49#0, #49#1, 0, " ", 0;
     #49#0, #49#1, 9, "z", 99;
     ;
     NULL, ortsm028;
|FIN;

|PROCESO ortsm027;
     #29#0 = #16#28;
     #29#1 = #16#0;
     #29#2 = #16#1;
     #29#3 = #27#1;
     #29#4 = #27#2;
     #29#5 = #27#3;
     #29#6 = #27#4;
     #29#7 = #27#5;
     #29#8 = #27#6;
     #29#9 = #27#7;
     #29#10 = #27#8;
     #29#11 = #27#9;
     |GRABA 020#29n;
|FPRC;

|DEFBUCLE ortsm027;
     #27#1;
     ;
     #49#0, #49#1, "                    ";
     #49#0, #49#1, "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, ortsm027;
|FIN;

|PROCESO LinKit;
     #20#0 = #49#0;
     #20#1 = #49#1;
     |LEE 000#20=;
     |SI FSalida = 0;
          |SI #20#2 = "S"; |O #20#2 = "T"; |O #20#2 = "H";
               |ABRE #29;
               |BUCLE ortsm027;
               |CIERRA #29;
               |ABRE #30;
               |BUCLE ortsm028;
               |CIERRA #30;

               #190#0 = #49#2;
               |LEE 000#190=;
               |SI FSalida ! 0; |DDEFECTO #190; |FINSI;

               #19#0 = #49#0;
               |LEE 000#19=;
               |SI FSalida ! 0; |DDEFECTO #19; |FINSI;

               #20#0 = #49#0;
               #20#1 = #49#1;
               |LEE 000#20=;
               |SI FSalida ! 0; |DDEFECTO #20; |FINSI;

               |SELECT #7#17;
               #17#0 = #16#28;
               #17#1 = #16#0;
               #17#2 = #16#1;
               #17#26 = #20#14;
               #17#24 = #20#3;
               |LEE 101#17=;
               |SI FSalida ! 0; |O #19#2 = "N";
                    |DDEFECTO #17;
                    #17#0 = #16#28;
                    #17#1 = #16#0;
                    #17#2 = #16#1;
                    #17#3 = #49#1;
                    |GRABA 020#17b;
               |FINSI;
               #17#4 = #49#2;
               #17#5 = #49#3;
               #17#6 = #16#59;
               |SI #20#2 = "H"; #17#6 = ""; |FINSI;

               #190#0 = #17#4;
               |LEE 000#190=;
               |SI FSalida ! 0; |DDEFECTO #190; |FINSI;
               |SI #190#125 = "K "; #17#6 = "MET"; |FINSI;

               |SI #19#2 = "N";
                    #17#7 = #49#4;
               |SINO;
                    #17#7 = #17#7 + #20#22;
               |FINSI;
               #17#8 = #20#21;
               #17#9 = #49#9;
               #17#10 = #49#10;
               |SI #20#2 = "T";
                    #17#11 = #16#60;
               |SINO;
                    #17#11 = "";
               |FINSI;
               #17#12 = #20#2;

               #17#13 = #20#5;
               #17#14 = #20#4;
               #17#16 = #20#7;
               #17#17 = #20#8;
               #17#18 = #20#6;
               |SI #17#13 = 0;
                    #17#13 = #190#115;
                    #17#17 = #190#115;
               |FINSI;
               |SI #17#14 = 0;
                    #17#14 = #190#116;
                    #17#16 = #190#116;
               |FINSI;
               |SI #17#18 = 0;
                    #17#18 = #190#114;
               |FINSI;

               |SI #17#16 = 0;
                    #17#16 = #17#14;
               |FINSI;
               |SI #17#17 = 0;
                    #17#17 = #17#13;
               |FINSI;

               #17#19 = #20#10;
               #17#20 = #20#11;
               #17#21 = #20#12;
               #17#22 = #20#13;
               #17#23 = #20#9;
               #17#24 = #20#3;
               #17#26 = #20#14;

               |SI #17#13 ! 0; |Y #17#14 ! 0;
                    #17#15 = "S";
               |SINO;
                    #17#15 = "N";
               |FINSI;
               nCoste = 0;  || Falta Calcular el coste !!!!
               #17#25 = #17#25 + nCoste;
               #17#27 = #20#15;
               #17#28 = #20#16;
               #17#29 = #20#3;
               #17#30 = #20#17;
               #17#31 = #20#18;
               #17#32 = #17#32 + #20#19;
               #17#33 = #17#33 + #20#20;
               #17#35 = #20#23;
               #17#36 = #20#24;
               #17#37 = #20#25;
               #17#38 = #20#26
               |GRABA 020#17a;
               |LIBERA #17;

               |SELECT #1#17;

               |SI #17#8 = "S";
                    |HAZ Crea18;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE LinKit;
     #49#1;
     ;
     #16#2, 001;
     #16#2, 999;
     ;
     NULL, LinKit;
|FIN;

|PROCESO BtnHerraje;
     |PTEC 828;
|FPRC;

|PROCESO BtnCanteado;
     |PTEC 829;
|FPRC;

|PROCESO SacaKitOrts;
     |ABRE #19;
     #19#0 = #16#2;
     |LEE 000#19=;
     |SI FSalida = 0; |Y #19#1 = "S";
          nModo = (FEntrada / 100) ! 0;
          |ABRE #20;
          |ABRET #17;
          |ABRET #18;
          |SI nModo = 1; |O #16#2 ! eaArticulo;
               |HAZ BorraKitOrts;
               |ABRE #190;
               |ABRE #18;
               |ABRE #19;
               |ABRE #20;
               |BUCLE LinKit;
               |CIERRA #20;
               |CIERRA #19;
               |CIERRA #18;
               |CIERRA #190;
          |FINSI;
          |SI nModo = 2;
               |SI #16#59 ! eaCombi; |O #16#60 ! eaTira; |O eaTecla = 13;
                    |SI eaTecla  ! 13;
                         |CONFI "0000S¿Actualizar desglose escandallo?";
                    |SINO;
                         FSalida = 1;
                    |FINSI;
                    |SI FSalida = 0;
                         |ABRE #20;
                         |ABRE #49;
                         |ABRET #17;
                         nSwCombi = 0;
                         nSwTira = 0;
                         |BUCLE CheqModi17;
                         |BUCLE CheqModi18;
                         |SI nSwCombi ! 0;
                              |CONFI "0000SDesglose con combinaciones diferentes de la línea del pedido, ¿actualizamos todos?";
                              nSwCombi = FSalida;
                         |FINSI;
                         |SI nSwTira ! 0;
                              |CONFI "0000SDesglose con tiradores diferentes de la línea del pedido, ¿actualizamos todos?";
                              nSwTira = FSalida;
                         |FINSI;

                         |SI nSwCombi = 0;
                              aDCombi = "   ";
                              aHCombi = "zzz";
                         |SINO;
                              aDCombi = eaCombi;
                              aHCombi = eaCombi;
                         |FINSI;
                         |SI nSwTira = 0;
                              aDTira = "    ";
                              aHTira = "zzzz";
                         |SINO;
                              aDTira = eaTira;
                              aHTira = eaTira;
                         |FINSI;

                         |ABRE #190;
                         |BUCLE Actua17;
                         |CIERRA #190;

                         |BUCLE Actua18;
                         |CIERRAT #17;
                         |CIERRA #49;
                         |CIERRA #20;
                    |FINSI;
               |FINSI;
          |FINSI;
          #17#0 = #16#28;
          #17#1 = #16#0;
          #17#2 = #16#1;
          #17#3 = 1;
          |LEE 000#17];
          |SI FSalida = 0; |Y #17#0 = #16#28; |Y #17#1 = #16#0;
                    |Y #17#2 = #16#1;
               nModoLin = 2;
               |PUSHV 0501 2380;
               |CONTROL_SIMPLE 0, "BOTON, F6.-Herrajes", 1303, 1315, BtnHerraje; nBtnHerraje = FSalida;
               |CONTROL_SIMPLE 0, "BOTON, F7.-Canteado", 1316, 1328, BtnCanteado; nBtnCanteado = FSalida;
               |ENTLINEAL #1#17, 4, 2, 20, 1, Min17, Max17;
               |FIN_CONTROL_WINDOWS nBtnHerraje;
               |FIN_CONTROL_WINDOWS nBtnCanteado;
               |POPV;
          |FINSI;
          |CIERRAT #18;
          |CIERRAT #17;
          |CIERRA #20;
     |SINO;
          |HAZ BorraKitOrts;
     |FINSI;
     |CIERRA #19;
|FPRC;

|PROCESO BorraKitOrts;
     |BUCLE Borra17;
     |BUCLE Borra29;
     |BUCLE Borra30;
|FPRC;

|PROCESO VerKitOrts;
     aVer = "S";
     |ABRE #17;
     #17#0 = #16#28;
     #17#1 = #16#0;
     #17#2 = #16#1;
     |LEE 000#17];
     |SI FSalida = 0; |Y #17#0 = #16#28; |Y #17#1 = #16#0; |Y #17#2 = #16#1;
          nModoLin = 4;
          |PUSHV 0501 2380;
          |CONTROL_SIMPLE 0, "BOTON, F6.-Herrajes", 1303, 1315, BtnHerraje; nBtnHerraje = FSalida;
          |CONTROL_SIMPLE 0, "BOTON, F7.-Canteado", 1316, 1328, BtnCanteado; nBtnCanteado = FSalida;
          |ENTLINEAL #1#17, 4, 4, 20, 1, Min17, Max17;
          |FIN_CONTROL_WINDOWS nBtnHerraje;
          |FIN_CONTROL_WINDOWS nBtnCanteado;
          |POPV;
     |SINO;
          |MENAV "0000No hay desglose de lineas combinables...";
     |FINSI;
     |CIERRA #17;
     aVer = "N";
|FPRC;

|PROCESO Ort17_2; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
          |ABRE #29;
          #29#0 = #17#0;
          #29#1 = #17#1;
          #29#2 = #17#2;
          #29#3 = #17#3;
          #29#4 = 0;
          |LEE 101#29];
          |PARA; |SI FSalida = 0; |Y #29#0 = #17#0; |Y #29#1 = #17#1;
                    |Y #29#2 = #17#2; |Y #29#3 = #17#3; |HACIENDO;
               |BORRA 020#29a;
               |LIBERA #29;
               |LEE 101#29s;
          |SIGUE;
          |CIERRA #29;

          |ABRE #30;
          #30#0 = #17#0;
          #30#1 = #17#1;
          #30#2 = #17#2;
          #30#3 = #17#3;
          #30#4 = 0;
          #30#5 = "";
          #30#16 = 0;
          |LEE 101#30];
          |PARA; |SI FSalida = 0; |Y #30#0 = #17#0; |Y #30#1 = #17#1;
                    |Y #30#2 = #17#2; |Y #30#3 = #17#3; |HACIENDO;
               |BORRA 020#30a;
               |LIBERA #30;
               |LEE 101#30s;
          |SIGUE;
          |CIERRA #30;
     |FINSI;
|FPRC;

|PROCESO LlenaPedCli;
     |SALVA_DATOS #15;
     |REPON_DATOS #referen@;
     |GRABA 020#referen@.n;
|FPRC;

|DEFBUCLE LlenaPedCli;
     #15#6;
     ;
     #15#4, 0000;
     #15#4, 9999;
     ;
     NULL, LlenaPedCli;
|FIN;

|PROCESO Min16;
     #referen@#28 = #170#0;
     #referen@#0 = #170#1;
     #referen@#1 = 1;
|FPRC;

|PROCESO Max16;
     #referen@#28 = #170#0;
     #referen@#0 = #170#1;
     #referen@#1 = 999;
|FPRC;

|PROCESO Min109;
     #109#0 = "     ";
     #109#1 = 000000;
     #109#2 = 000;
     #109#3 = 000;
|FPRC;

|PROCESO Max109;
     #109#0 = "zzzzz";
     #109#1 = 999999;
     #109#2 = 999;
     #109#3 = 999;
|FPRC;

|PROCESO MarcaCompo; |TIPO 0;
     |SI FSalida = 0;
          |SI #109#45 = "*";
               #109#45 = "";
               nMarca = nMarca - 1;
          |SINO;
               #109#45 = "*";
               nMarca = nMarca + 1;
          |FINSI;
          |GRABA 020#109a;
          |PINTA #109#45;
     |FINSI;
|FPRC;

|PROCESO Llena109;
     |PARA i = 0; |SI i [ 38; |HACIENDO i = i + 1;
          #109i = #referen@#i#;
     |SIGUE;
     #109#45 = "";
     #109#46 = aArti;
     |GRABA 020#109n;
     nHay = 1;
|FPRC;

|DEFBUCLE Llena109;
     #referen@#1004;
     ;
     #170#0, #170#1, nLinSel, 001;
     #170#0, #170#1, nLinSel, 999;
     ;
     NULL, Llena109;
|FIN;

|PROCESO CargaCombUni;
     #18#0 = #16#28;
     #18#1 = #16#0;
     #18#2 = #16#1;
     #18#3 = nLin;
     |GRABA 020#18n;
|FPRC;

|DEFBUCLE CargaCombUni;
     #18#1;
     ;
     #109#0, #109#1, #109#2, #109#3, 0;
     #109#0, #109#1, #109#2, #109#3, 999;
     ;
     NULL, CargaCombUni;
|FIN;

|PROCESO CargaCompoMarcado;
     |SI #109#45 = "*";
          #17#0 = #16#28;
          #17#1 = #16#0;
          #17#2 = #16#1;
          #17#3 = 999;
          |LEE 000#17];
          |SI FSalida = 0;
               |LEE 000#17a;
          |SINO;
               |LEE 000#17u;
          |FINSI;
          |SI FSalida = 0; |Y #17#0 = #16#28; |Y #17#1 = #16#0; |Y #17#2 = #16#1;
               nLin = #17#3 + 1;
          |SINO;
               nLin = 1;
          |FINSI;
          |DDEFECTO #17;
          #17#0 = #16#28;
          #17#1 = #16#0;
          #17#2 = #16#1;
          #17#3 = nLin;
          |PARA i = 4; |SI i [ 38; |HACIENDO i = i + 1;
               #17i = #109i;
          |SIGUE;
          #17#39 = "S";
          #17#40 = #170#0;
          #17#41 = #170#1;
          #17#42 = nLinSel;
          #17#43 = #109#46; || -> art¡culo pedido
          #17#44 = #109#3;
          |GRABA 020#17n;
          |BUCLE CargaCombUni;

          || Actualiza el 16
          aAlfa = "Ref: " + #17#43; |QBF aAlfa;
          aAlfa = aAlfa + "-" + #17#5;
          #16#4 = aAlfa;
          #16#59 = #17#6;
          #16#60 = #17#11;
     |FINSI;
|FPRC;

|DEFBUCLE CargaCompoMarcado;
     #109#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, CargaCompoMarcado;
|FIN;

|PROCESO ConsultaPed;
     nLinSel = 0;
     |PUSHV 0501 2380;
     |BLANCO 1430 1955;
     |DDEFECTO #170;
     |PINPA #0#170;
     |PINDA #0#170;
     |ENDATOS #1#170;
     |SI FSalida = 0;
          |DDEF aAlfa;
          aAlfa = aAlfa + "ortsm016";
          |SI FSalida = 0;
               |CARGA_DEF aAlfa, referen@;
               |SI FSalida = 0;
                    |ABRE #referen@;
                    |CONSULTA_F_CLAVE #1#referen@, Min16, Max16;
                    |SI FSalida = 0;
                         aArti = #referen@#2;
                         nLinSel = #referen@#1;
                    |SINO;
                         |ERROR;
                    |FINSI;
                    |CIERRA #referen@;
                    |DESCARGA_DEF #referen@;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI nLinSel > 0;
          |DDEF aAlfa;
          aAlfa = aAlfa + "ortsm017";
          |CARGA_DEF aAlfa, referen@;
          |SI FSalida = 0;
               nMarca = 0;
               |HAZ CreaTempo; |NOME_DAT #109Tempo; |DELINDEX #109; |ABRE #109;
               nHay = 0;
               |BUCLE Llena109;
               |SI nHay > 0;
                    |ENTLINEAL #1#109, 4, 4, 20, 1, Min109, Max109;
               |SINO;
                    |MENAV "0000Linea sin componentes...";
               |FINSI;
               |SI nMarca > 0;
                    #17#0 = #16#28;
                    #17#1 = #16#0;
                    #17#2 = #16#1;
                    #17#3 = 1;
                    |BORRA 000#17c;
                    |BUCLE CargaCompoMarcado;
                    |PONCONTROL 23, "SI";
                    |PTEC 809;
                    |PTEC 816;
                    |PTEC 812;
                    #16#65 = "S";
               |FINSI;
               |CIERRA #109; |DELINDEX #109; |HAZ BoraTempo;
               |DESCARGA_DEF #referen@;
          |FINSI;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO PedCli; |TIPO 66;
     |DDEF aAlfa;
     aAlfa = aAlfa + "ortsm015";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |HAZ CreaTempo;
          |NOME_DAT #referen@#Tempo#; |DELINDEX #referen@; |ABRE #referen@;

          |SALVA_FICHA #15;
          |BUCLE LlenaPedCli;
          |REPON_FICHA #15;

          |CONSULTA_CLAVE #1#referen@;
          |SI FSalida = 0;
               #170#0 = #referen@#25; |PINTA #170#0;
               #170#1 = #referen@#0; |PINTA #170#1;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #referen@; |DELINDEX #referen@;
          |HAZ BoraTempo;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;
