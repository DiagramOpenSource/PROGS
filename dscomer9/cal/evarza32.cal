          ||Proceso Etiquetas

|FICHEROS;
     evarm004 #0;
     evarm005 #2;
     evarm021 #21;
     agifa073 #73;
     agifa104 #104;
|FIN;

|VARIABLES;
     i = 0;
     nUni = 0;
     aBase = "";
     aPrime = "";
     aUlti = "";
     uni = 0;
     talla = "";
     tt = "";
     etiq = "";
     bultos = 0;
     cta1 = "";
     cta = "";
|FIN;

|PROCESO CreaSinTalla;
     |DDEFECTO #21;
     #21#4 = #73#28;
     #21#5 = #73#0;
     #21#6 = #73#1;
     #21#0 = "";
     |LEE 101#21=;
     |SI FSalida ! 0; |GRABA 020#21b; |FINSI;
     #21#1 = #73#2;
     #21#3 = #73#2;
     #21#9 = #104#1;
     #21#10 = #104#4;
     #21#11 = "N";
     #21#12 = #73#5;
     #21#13 = #73#5;
     |GRABA 020#21a;
     |LIBERA #21;
|FPRC;

|PROCESO BorraSobra;
     |BORRA 020#2a;

     #21#4 = #73#28;
     #21#5 = #73#0;
     #21#6 = #73#1;
     #21#0 = #2#0;
     |LEE 101#21=;
     |SI FSalida = 0;
          |BORRA 020#21a;
     |FINSI;
|FPRC;

|DEFBUCLE BorraSobra;
     #2#1001;
     ;
     aPrime;
     aUlti;
     be;
     NULL, BorraSobra;
|FIN;

|PROCESO EvaEtiqueta;
     |DDEFECTO #2;
     #2#0 = etiq;
     |LEE 000#2=;
     |SI FSalida ! 0;
          #2#1 = #73#28; || Serie Pedido....
          #2#2 = "4";
          #2#3 = "PREVIO";
          #2#4 = talla;
          #2#5 = bultos;
          #2#6 = #73#0;  || N§ Pedido...
          #2#7 = #73#1;  || N§ Linea....
          #2#8 = ~;
          |GRABA 020#2n;
     |FINSI;

     |DDEFECTO #21;
     #21#4 = #73#28;
     #21#5 = #73#0;
     #21#6 = #73#1;
     #21#0 = #2#0;
     |LEE 101#21=;
     |SI FSalida ! 0; |GRABA 020#21b; |FINSI;
     #21#1 = #73#2;
     #21#2 = #2#4;
     #21#3 = #0#29;
     #21#7 = #0#28;
     #21#8 = #2#3;
     #21#9 = #104#1;
     #21#10 = #104#4;
     #21#11 = "N";
     #21#12 = 1;
     #21#13 = 1;
     |GRABA 020#21a;
     |LIBERA #21;
|FPRC;

|PROCESO EtiquetaBase;
     etiq = #agifa073#0;
     etiq = "000000" + etiq;
     etiq = etiq % "-106";

     cta1 = #agifa073#1;
     cta = "00" + cta1;
     cta = cta % "-102";

     etiq = etiq + cta;
     etiq = etiq + tt;

     aBase = etiq;
|FPRC;

|PROCESO EvaEtiqueta0;
     |HAZ EtiquetaBase;

     aPrime = aBase;
     aUlti = aBase + "zz";
     |ABRE #2;
     uni = uni + 1;
     |PARA bultos = 1; |SI bultos [ uni;|HACIENDO bultos = bultos + 1;
          etiq = aBase;
          cta1 = bultos;
          cta = "00" + cta1;
          cta = cta % "-102";
          etiq = etiq + cta;
          aPrime = etiq;
          |SI bultos ! uni;
               |HAZ EvaEtiqueta;
          |FINSI;
     |SIGUE;
     |CIERRA #2;
     |BUCLE BorraSobra;
|FPRC;

|PROCESO CreaEtiquetas;
     uni = #0#3; talla = "80";  tt = "01"; |HAZ EvaEtiqueta0;
     uni = #0#4; talla = "85";  tt = "02"; |HAZ EvaEtiqueta0;
     uni = #0#5; talla = "90";  tt = "03"; |HAZ EvaEtiqueta0;
     uni = #0#6; talla = "95";  tt = "04"; |HAZ EvaEtiqueta0;
     uni = #0#7; talla = "100"; tt = "05"; |HAZ EvaEtiqueta0;
     uni = #0#8; talla = "105"; tt = "06"; |HAZ EvaEtiqueta0;
     uni = #0#9; talla = "110"; tt = "07"; |HAZ EvaEtiqueta0;
     uni = #0#10; talla = "115"; tt = "08"; |HAZ EvaEtiqueta0;
     uni = #0#11; talla = "120"; tt = "09"; |HAZ EvaEtiqueta0;
     uni = #0#12; talla = "125"; tt = "10"; |HAZ EvaEtiqueta0;
     uni = #0#13; talla = "130"; tt = "11"; |HAZ EvaEtiqueta0;
     uni = #0#14; talla = "135"; tt = "12"; |HAZ EvaEtiqueta0;
     uni = #0#27; talla = "140"; tt = "14"; |HAZ EvaEtiqueta0;
     uni = #0#15; talla = "Especial"; tt = "13"; |HAZ EvaEtiqueta0;
|FPRC;

|PROCESO Etiquetas; ||Copiado de evarm004
     |ABRE #21;
     |HAZ CreaEtiquetas;
/*
     |ABRE #22;
     |BUCLE ActServidas;
     |CIERRA #22;
*/
     nUni = #0#27;
     |PARA i = 3; |SI i [ 15; |HACIENDO i = i + 1;
          nUni = nUni + #0i;
     |SIGUE;
     |SI nUni = 0;
          |HAZ CreaSinTalla;
     |SINO;
          #21#4 = #73#28;
          #21#5 = #73#0;
          #21#6 = #73#1;
          #21#0 = "";
          |LEE 101#21=;
          |SI FSalida = 0; |BORRA 020#21a; |FINSI;
     |FINSI;
     |CIERRA #21;
|FPRC;
