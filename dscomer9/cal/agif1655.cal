               PROCESO BorraCartera
|FICHEROS;
     agifa655 #0;
     dscam003@;
     dscam004@;
     dscam008@;
     dscam009@;
     dscam067@;
     dscamrec@;
     dscam045@;
     dscam000@;
     dscam013@;
     dscam050@;
     dscam047@;
     dscam022@;
|FIN;

|VARIABLES;
     aD = "";
     aH = "";
     aTipo = "";
     aAlfa45 = "";
     aAlfa03 = "";
     aAlfa04 = "";
     aAlfa08 = "";
     aAlfa09 = "";
     aAlfa67 = "";
     aAlfarec = "";
     aAlfa00 = "";
     aAlfa13 = "";
     aAlfa50 = "";
     aAlfa47 = "";
     aAlfa22 = "";

     swSi      = 0;
     aParam    = "";
     aNume1    = "";
     aNume2    = "";

     nCont     = 0;
     aSerie    = "";
     aAlfa     = "";
     aAlfa1    = "";
     &aCPath    = "";
     &aCNome    = "";
     aConta     = "agicont";

     nEmpresa = 0;
     nPeriodo = 0;
|FIN;

|PROCESO dscam067;
     |BORRA 020#dscam067@.a;
|FPRC;

|DEFBUCLE dscam067;
     #dscam067@#1007;
     ;
     aTipo, aNume1, aNume2, aD, 000000, 00000, 0;
     aTipo, aNume1, aNume2, aH, 999999, 99999, 9;
     be;
     NULL, dscam067;
|FIN;

|PROCESO Remesas;
     aTipo = "RM";
     aNume1 = #dscam013@#0;
     aNume2 = #dscam013@#1;
     |BUCLE dscam067;

     |BORRA 020#dscam013@.a;
|FPRC;

|DEFBUCLE Remesas;
     #dscam013@#3005;
     ;
     00, aSerie, 000000, 000, 000000001;
     99, aSerie, 999999, 999, 999999999;
     be;
     NULL, Remesas;
|FIN;

|PROCESO Pagares;
     aTipo = "PA";
     aNume1 = #dscam022@#0;
     aNume2 = #dscam022@#1;
     |BUCLE dscam067;

     |BORRA 020#dscam022@.a;
|FPRC;

|DEFBUCLE Pagares;
     #dscam022@#3005;
     ;
     00, aSerie, 000000, 000, 000000001;
     99, aSerie, 999999, 999, 999999999;
     be;
     NULL, Pagares;
|FIN;

|PROCESO Talones;
     aTipo = "TA";
     aNume1 = #dscam047@#0;
     aNume2 = #dscam047@#1;
     |BUCLE dscam067;

     |BORRA 020#dscam022@.a;
|FPRC;

|DEFBUCLE Talones;
     #dscam047@#3005;
     ;
     00, aSerie, 000000, 000, 000000001;
     99, aSerie, 999999, 999, 999999999;
     be;
     NULL, Talones;
|FIN;

|PROCESO Confirmes;
     aTipo = "CR";
     aNume1 = #dscam050@#0;
     aNume2 = #dscam050@#1;
     |BUCLE dscam067;

     |BORRA 020#dscam050@.a;
|FPRC;

|DEFBUCLE Confirmes;
     #dscam050@#3005;
     ;
     00, aSerie, 000000, 000, 000000001;
     99, aSerie, 999999, 999, 999999999;
     be;
     NULL, Confirmes;
|FIN;

|PROCESO HistorPagos;
     aTipo = "PG";
     aNume1 = #dscam009@#14;
     aNume2 = #dscam009@#3;
     |BUCLE dscam067;

     |BORRA 020#dscam009@.a;
|FPRC;

|DEFBUCLE HistorPagos;
     #dscam009@#1002;
     ;
     #dscam008@#40, 001;
     #dscam008@#40, 999;
     be;
     NULL,HistorPagos;
|FIN;

|PROCESO RecibosCompra;
     |BUCLE HistorPagos;
     |BORRA 020#dscam008@.a;
|FPRC;

|DEFBUCLE RecibosCompra;
     #dscam008@#2004;
     ;
     00, aSerie, 000000, 000;
     99, aSerie, 999999, 999;
     ;
     NULL,RecibosCompra;
|FIN;

|PROCESO HistorCobros;
     aTipo = "CB";
     aNume1 = #dscam004@#17;
     aNume2 = #dscam004@#3;
     |BUCLE dscam067;

     |BORRA 020#dscam004@.a;
|FPRC;

|DEFBUCLE HistorCobros;
     #dscam004@#1002;
     ;
     #dscam003@#40, 001;
     #dscam003@#40, 999;
     be;
     NULL,HistorCobros;
|FIN;

|PROCESO RecibosVenta;
     |BUCLE HistorCobros;
     |BORRA 020#dscam003@.a;
|FPRC;

|DEFBUCLE RecibosVenta;
     #dscam003@#9005;
     ;
     00, aSerie, 000000, 000, 000000001;
     99, aSerie, 999999, 999, 999999999;
     be;
     NULL, RecibosVenta;
|FIN;

|PROCESO Cartera;
     #dscam000@#0 = #dscam045@#6;
     |LEE 000#dscam000@.=;
     |SI FSalida ! 0; |DDEFECTO #dscam000@; |FINSI;

     |PARA nCont = 0; |SI nCont [ 7; |HACIENDO nCont = nCont + 1;
          |SI #dscam045@#4 [ #agifa655#nCont#; |Y #agifa655#nCont# [ #dscam045@#5;
               |DBASS aAlfa; |QBF aAlfa; aAlfa = aAlfa + "dscarter/fich/";
               aAlfa1 = aAlfa + (("00000" + #dscam045@#6) % -105) + "/";
               |PATH_DAT #dscam003@#aAlfa1#; |PATH_DAT #dscam004@#aAlfa1#;
               |PATH_DAT #dscam008@#aAlfa1#; |PATH_DAT #dscam009@#aAlfa1#;
               |PATH_DAT #dscam067@#aAlfa1#;
               |PATH_DAT #dscam013@#aAlfa1#;
               |PATH_DAT #dscam050@#aAlfa1#;
               |PATH_DAT #dscam047@#aAlfa1#;
               |PATH_DAT #dscam022@#aAlfa1#;
               aCPath = aAlfa1;         |PATH_DAT #dscamrec@#aCPath#;
               aCNome = "pb" + Usuario; |NOME_DAT #dscamrec@#aCNome#;
               |ABRE #dscam067@;
               aSerie = #agifa655#nCont#;
               |SI #dscam045@#2 = "V";
                    |MENSA "0000Cartera (venta)...";
                    |BUCLE RecibosVenta;
                    |BUCLE Remesas;
               |FINSI;
               |SI #dscam045@#2 = "C";
                    |MENSA "0000Cartera (compra)...";
                    |BUCLE RecibosCompra;
                    |BUCLE Pagares;
                    |BUCLE Talones;
                    |BUCLE Confirmes;
               |FINSI;
               |CIERRA #dscam067@;
          |FINSI;
     |SIGUE;
|FPRC;

|DEFBUCLE Cartera;
     #dscam045@#1002;
     ;
     nEmpresa, 001;
     nEmpresa, 999;
     ;
     NULL,Cartera;
|FIN;

|PROCESO BorraCartera;
     |MENSA "0000Cartera...";
     aD = " " * 50;
     aH = "z" * 50;

     |DBASS aAlfa; |QBF aAlfa; aAlfa = aAlfa + "dscarter/def/";

     aAlfa45 = aAlfa + "dscam045.mas";
     |CARGA_DEF aAlfa45, dscam045@;
     |SI FSalida ! 0; aAlfa45 = ""; |VETE Final; |FINSI;

     aAlfa03 = aAlfa + "dscam003.mas";
     |CARGA_DEF aAlfa03, dscam003@;
     |SI FSalida ! 0; aAlfa03 = ""; |VETE Final; |FINSI;

     aAlfa04 = aAlfa + "dscam004.mas";
     |CARGA_DEF aAlfa04, dscam004@;
     |SI FSalida ! 0; aAlfa04 = ""; |VETE Final; |FINSI;

     aAlfa08 = aAlfa + "dscam008.mas";
     |CARGA_DEF aAlfa08, dscam008@;
     |SI FSalida ! 0; aAlfa08 = ""; |VETE Final; |FINSI;

     aAlfa09 = aAlfa + "dscam009.mas";
     |CARGA_DEF aAlfa09, dscam009@;
     |SI FSalida ! 0; aAlfa09 = ""; |VETE Final; |FINSI;

     aAlfa67 = aAlfa + "dscam067.mas";
     |CARGA_DEF aAlfa67, dscam067@;
     |SI FSalida ! 0; aAlfa67 = ""; |VETE Final; |FINSI;

     aAlfarec = aAlfa + "dscamrec.mas";
     |CARGA_DEF aAlfarec, dscamrec@;
     |SI FSalida ! 0; aAlfarec = ""; |VETE Final; |FINSI;

     aAlfa00 = aAlfa + "dscam000.mas";
     |CARGA_DEF aAlfa00, dscam000@;
     |SI FSalida ! 0; aAlfa00 = ""; |VETE Final; |FINSI;

     aAlfa13 = aAlfa + "dscam013.mas";
     |CARGA_DEF aAlfa13, dscam013@;
     |SI FSalida ! 0; aAlfa13 = ""; |VETE Final; |FINSI;

     aAlfa50 = aAlfa + "dscam050.mas";
     |CARGA_DEF aAlfa50, dscam050@;
     |SI FSalida ! 0; aAlfa50 = ""; |VETE Final; |FINSI;

     aAlfa47 = aAlfa + "dscam047.mas";
     |CARGA_DEF aAlfa47, dscam047@;
     |SI FSalida ! 0; aAlfa47 = ""; |VETE Final; |FINSI;

     aAlfa22 = aAlfa + "dscam022.mas";
     |CARGA_DEF aAlfa22, dscam022@;
     |SI FSalida ! 0; aAlfa22 = ""; |VETE Final; |FINSI;

     |DBASS aAlfa; |QBF aAlfa; aAlfa = aAlfa + "dscarter/fich/";
     |PATH_DAT #dscam045@#aAlfa#; |PATH_DAT #dscam000@#aAlfa#;
     nEmpresa = #48#0;

     |ABRE #dscam000@;
     |BUCLE Cartera;
     |CIERRA #dscam000@;

|ET Final;
     |SI aAlfa22 ! ""; |DESCARGA_DEF #dscam022@; |FINSI;
     |SI aAlfa47 ! ""; |DESCARGA_DEF #dscam047@; |FINSI;
     |SI aAlfa50 ! ""; |DESCARGA_DEF #dscam050@; |FINSI;
     |SI aAlfa13 ! ""; |DESCARGA_DEF #dscam013@; |FINSI;
     |SI aAlfa00 ! ""; |DESCARGA_DEF #dscam000@; |FINSI;
     |SI aAlfarec ! ""; |DESCARGA_DEF #dscamrec@; |FINSI;
     |SI aAlfa67 ! ""; |DESCARGA_DEF #dscam067@; |FINSI;
     |SI aAlfa09 ! ""; |DESCARGA_DEF #dscam009@; |FINSI;
     |SI aAlfa08 ! ""; |DESCARGA_DEF #dscam008@; |FINSI;
     |SI aAlfa04 ! ""; |DESCARGA_DEF #dscam004@; |FINSI;
     |SI aAlfa03 ! ""; |DESCARGA_DEF #dscam003@; |FINSI;
     |SI aAlfa45 ! ""; |DESCARGA_DEF #dscam045@; |FINSI;
|FPRC;
