|FICHEROS;
     gocercap #0;
     gocerlip #1;
     gopre001 #2;
     gopre003 #3;
     gocerhip #4,MANTE;
     agifa027 #5;
     agifa084 #6;
     agifa069 #7;
     gopre001 #10;
     gopre002 #11;
     gopre003 #12;

     gopartia #25;
     goceradp #26;
     gomantca #27;
     gocermed #30,MANTE;

     agifa142 #41;        || Parametros Generales

     gocercab #50;
     gocerlin #51;
     gocerhis #52;
     gomantl1 #53;

     goparame #100;
     godeprel #202;

     gopre021;
     gopre022;
     referen@;
|FIN;
-----------------------------------------------------------------------------
|VARIABLES;
     aDef = "";
     aAlfa          = "";
     aAlfa1         = "";
     swCompro       = 0;
     swRecal        = 0;
     aPa            = "";
     aCa            = "";
     &aTipCer       = "";
     &cCodMonBase   = "";
     &cDesMonBase   = "";
     &cCodMonTrab   = "";
     &cDesMonTrab   = "";
     &reimpr        = "";
     &serie         = "";

     &nDeci_PBase   = 0;
     &nDeci_TBase   = 0;
     &nDeci_PTrab   = 0;
     &nDeci_TTrab   = 0;
     &nDeci_TotVis  = 0;
     &nEurComTrab   = 0;
     &nEurComBase   = 0;
     &nEurVenTrab   = 0;
     &nEurVenBase   = 0;
     &nError        = 0;
     &numero        = 0;

     nModo          = 0;
     nTipo          = 0;
     nSw            = 0;
     nBotAmpli      = 0;
     nAmp           = 0;
     nLinea         = 0;
     nSwich         = 0;
     nHay           = 0;
     nCont          = 0;

     cTexto         = "";
     cCadena        = "";
     contador       = "";

     {-1}Menu       = "";
     Menu1          = "2400";
     Menu2          = "1";
     Menu3          = "Contador:  ";
     Menu4          = "AM";
     Menu5          = " Automatico ";
     Menu6          = " Manual ";

     fFecIni        = @;
     fFecFin        = @;

     &nCAPITULO = 0;
     nCAPITULO_ANT = 0;
     &nSUBCAPITULO = 0;
     nAlgo = 0;
|FIN;
-----------------------------------------------------------------------------
|PROCESO Mone; |TIPO 14;
     cCodMonTrab = #0#6;
     |HAZ MonBas;
     |HAZ Consulta;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO BuscaPre; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;

     |SI nModo = 1;
          |C_M #0#7, 1, "S";
     |FINSI;

     |ABRE #2;
     #2#0 = #0#0;
     #2#1 = #0#1;
     |LEE 010#2=;

     |SI FSalida = 0;

          |SI #2#17 = " ";
               |MENAV "0000Presupuesto NO asignado a expediente";
               |ERROR;
               |ACABA;
          |FINSI;

     |FINSI;

     |CIERRA #2;

     aTipCer = #2#36;
     #0#15 = #2#18;
     #0#12 = #0#11 - #0#10;

     |ABRE #27;
     #27#0 = #0#4;                                ||Serie Exp.
     #27#1 = #0#5;                                ||No. Exped.
     |LEE 000#27=;

     |SI FSalida = 0;
          #0#16 = #27#11;                         ||Almacen.
     |FINSI;

     |CIERRA #27;
     |PINTA #0#12;
     |PINTA #0#15;
     |PINTA #0#16;

|FPRC;
-----------------------------------------------------------------------------
|PROCESO ModCon; |TIPO 0;
     nModo = (FEntrada/100)!0;
     |SI nModo = 4;
          |ENTLINEAL #1#4,-4,4,21,1,minimo,maximo;
     |FINSI;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO Consulta; |TIPO 7;

     |SI #0#15 = "A";
          |ENTLINEAL #1#26,-4,7,22,1,minimo,maximo;
     |SINO;
          |ENTLINEAL #1#4,-4,7,21,1,minimo,maximo;
     |FINSI;

     |C_M #1#8, 1, "S";
     |C_M #1#9, 1, "S";
     |C_M #1#3, 1, "S";

|FPRC;
-----------------------------------------------------------------------------
|PROCESO Titulo; |TIPO 7;
     cTexto = #1#10;
     |QBF cTexto;

     |SI cTexto = "";

          |SI #0#15 ! "A";
               cTexto = #1#1;
               |QBF cTexto;
               cTexto = "000000" + cTexto;
               cTexto = cTexto % -106;
               cTexto = #1#0 + "-" + cTexto;
               cCadena = "CERTIFICACION No: ";
               cCadena = cCadena + #1#2 + "  REFERENTE PTO. No: " + cTexto;
               cTexto = #1#8;
               cTexto = " CORRESPONDIENTE AL PERIODO DEL " + cTexto;
               cCadena = cCadena + cTexto;
               cTexto = #1#9;
               cTexto = " AL " + cTexto;
               cCadena = cCadena + cTexto;
               #1#10 = cCadena;
               |PINTA #1#10;
          |SINO;
               cTexto = #1#8;
               cTexto = " CORRESPONDIENTE AL PERIODO DEL " + cTexto;
               cCadena = cCadena + cTexto;
               cTexto = #1#9;
               cTexto = " AL " + cTexto;
               cCadena = "FACTURACION ADMINISTRACION" + cCadena + cTexto;
               #1#10 = cCadena;
               |PINTA #1#10;
          |FINSI;

     |FINSI;

|FPRC;
-----------------------------------------------------------------------------
|PROCESO recalmed;
     |SI swRecal = 0;
          aPa  = #4#4;
          aCa  = #4#14;
          #3#0 = #1#0;                                 ||Serie Pre.
          #3#1 = #1#1;                                 ||Numero Pre.
          #3#2 = #4#14;                                ||Capitulo.
          #3#4 = #4#4;                                 ||Partida.
          |LEE 101#3=;
          #3#23 = 0;
          #3#24 = 0;
          |GRABA 020#3a;
          |LIBERA #3;
          swRecal = 1;
     |FINSI;
     |SI aPa ! #4#4; |O aCa ! #4#14;
          aPa = #4#4;
          aCa = #4#14;
          #3#0 = #1#0;                                 ||Serie Pre.
          #3#1 = #1#1;                                 ||Numero Pre.
          #3#2 = #4#14;                                ||Capitulo.
          #3#4 = #4#4;                                 ||Partida.
          |LEE 101#3=;
          #3#23 = 0;
          #3#24 = 0;
          |GRABA 020#3a;
          |LIBERA #3;
     |FINSI;

     #3#0 = #1#0;                                 ||Serie Pre.
     #3#1 = #1#1;                                 ||Numero Pre.
     #3#2 = #4#14;                                ||Capitulo.
     #3#4 = #4#4;                                 ||Partida.
     |LEE 101#3=;
     #4#7  = #4#20 - #3#23;
     #3#23 = #3#23 +  #4#7;                  ||Unidades Certificadas.
     #3#24 = #3#7  -  #3#23;                 ||Unidades Pendientes.
     |GRABA 020#3a;
     |GRABA 020#4a;
     |LIBERA #3;
|FPRC;

|DEFBUCLE recalmed;
     #4#5;
     ;
     #1#0,#1#1,"                    ","                    ",001;
     #1#0,#1#1,"zzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzz",999;
     ;
     NULL,recalmed;
|FIN;


|PROCESO Alta; |TIPO 0;

     |SI #0#15 = "A";
          |SI #1#7 = "S";
               |ENTLINEAL #1#26,-4,4,22,1,minimo,maximo;
          |SINO;
               |ENTLINEAL #1#26,-4,2,22,1,minimo,maximo;
          |FINSI;
     |SINO;
          |SI #1#7 = "S";
               |ENTLINEAL #1#4 ,-4,4,21,0,minimo,maximo;
          |SINO;
               |ENTLINEAL #1#4 ,-4,2,21,0,minimo,maximo;
          |FINSI;
          swRecal = 0;
          |ABRE #3;
          |SELECT #2#3;
          |BUCLE recalmed;
          |CIERRA #3;
     |FINSI;

     |HAZ Consulta;
||     |PINTA #1#6;

|FPRC;
-----------------------------------------------------------------------------
|PROCESO minimo;
     #4#0 = #1#0;
     #4#1 = #1#1;
     #4#2 = #1#2;
     #4#3 = 1;

     #26#0 = #1#0;
     #26#1 = #1#1;
     #26#2 = #1#2;
     #26#3 = 1;
     #26#15 = #1#8;
|FPRC;
-----------------------------------------------------------------------------
|PROCESO maximo;
     #4#0 = #1#0;
     #4#1 = #1#1;
     #4#2 = #1#2;
     #4#3 = 999;

     #26#0 = #1#0;
     #26#1 = #1#1;
     #26#2 = #1#2;
     #26#3 = 999;
     #26#15 = #1#9;
|FPRC;
-----------------------------------------------------------------------------
/*                           ARREGLAR
|PROCESO BorraPart;

     |SELECT #4#3;
     #3#0 = #4#0;                                 ||Serie Pres.
     #3#1 = #4#1;                                 ||N.Presupuesto
     #3#4 = #4#4;                                 ||Partida
     |LEE 000#3=;

||     |SI FSalida = 0;
||          #3#19 = #3#19 + #4#12;                 ||% Pendiente.
||          #3#20 = #3#20 + #4#10;                 ||Importe Pendiente.
||          |GRABA 020#3a;
||     |FINSI;

     |BORRA 020#4a;

|FPRC;

|PROCESO ActuPart;
||     #25#31 = "N";
||     |GRABA 020#25a;
|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE ActuPart;
     #25#6;
     8,20,31;
     #26#0, #26#1, #0#4, #0#5, #1#8, #26#4, #26#16, "S";
     #26#0, #26#1, #0#4, #0#5, #1#9, #26#4, #26#16, "S";
     ;
     NULL, ActuPart;
|FIN;

-------------------------------------------------------------------------------
|PROCESO BorraAdmi;
     |BUCLE ActuPart;
     |BORRA 020#26a;
|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE BorraAdmi;
     #26#1;
     ;                                          ||Campos Extras.
     #1#0, #1#1, #1#2,   1;
     #1#0, #1#1, #1#2, 999;
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, BorraAdmi;
|FIN;
-------------------------------------------------------------------------------
|DEFBUCLE BorraPart;
     #4#1;
     ;                                          ||Campos Extras.
     #1#0, #1#1, #1#2,   1;
     #1#0, #1#1, #1#2, 999;
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, BorraPart;
|FIN;
*/
-------------------------------------------------------------------------------
|PROCESO BorraMedi;
     |BORRA 020#30a;
|FPRC;

|DEFBUCLE BorraMedi;
     #30#1;
     ;
     #1#0, #1#1, #1#2, 001, 001;
     #1#0, #1#1, #1#2, 999, 999;
     be;
     NULL, BorraMedi;
|FIN;

|PROCESO buclecompro;
     swCompro = 1;
     |ERROR10;
|FPRC;

|DEFBUCLE buclecompro;
     #4#1;
     ;
     #0#0,#0#1,#1#2,  1;
     #0#0,#0#1,#1#2,999;
     ;
     NULL,buclecompro;
|FIN;

|PROCESO Baja; |TIPO 2;

     nModo = (FEntrada/100)!0;
     nTipo = 0 +. 1

     |SI nModo = 3;
          swCompro = 0;
          |BUCLE buclecompro;
          |SI swCompro = 1;
               |MENAV "0000No se puede dar de Baja existen Mediciones";
               |ERROR;
               |ACABA;
          |FINSI;

          |ABRE #3;

          |SI #0#15 ! "A";
   ||            |BUCLE BorraPart;            ARREGLAR
          |SINO;
  ||             |BUCLE BorraAdmi;
          |FINSI;

          |SI #1#7 = "S";
             ||  |HAZ BorraFact;
               |PINPA #0#0;
               |PINDA #0#0;
          |FINSI;

          |CIERRA #3;

          |BUCLE BorraMedi;
     |FINSI;

     |SI nModo = 2;

          |SI #0#15 = "A";
               |C_M #1#8, 1, "N";
               |C_M #1#9, 1, "N";
          |FINSI;

          |C_M #1#3, 1, "N";
     |FINSI;

||     #0#10 = #0#10 +. #1#6;
||     #0#12 = #0#11 - #0#10;
||     #0#13 = (#0#10*100)/#0#11;
||     #0#14 = 100 - #0#13;

||     ||PINTA #0#10; |PINTA #0#11;
||     ||PINTA #0#12; |PINTA #0#13;
||     ||PINTA #0#14;

|FPRC;
-----------------------------------------------------------------------------
|PROCESO MiraFecha;
     |SI fFecIni ] #1#8; |Y fFecIni [ #1#9;
          nHay = 1;
     |FINSI;
|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE MiraFecha;
     #1#1;
     ;                                          ||Campos Extras.
     #0#0, #0#1,   1;
     #0#0, #0#1, 999;
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, MiraFecha;
|FIN;
-------------------------------------------------------------------------------
|PROCESO MiraUlt;
     fFecIni = #1#9;
|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE MiraUlt;
     #1#1;
     ;                                          ||Campos Extras.
     #0#0, #0#1,   1;
     #0#0, #0#1, 999;
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, MiraUlt;
|FIN;
-------------------------------------------------------------------------------

|PROCESO UltFec; |TIPO 7;
     nModo = (FEntrada/100)!0;

     |ABRE #53; |SELECT #3#53;
     #53#3 = #0#0;
     #53#4 = #0#1;
     |LEE 020#53=;
     |CIERRA #53;
     fFecIni = #53#7;

     |SI nModo = 1; |Y Campo = 8;
          |SALVA_FICHA #1;
          |BUCLE MiraUlt;
          |REPON_FICHA #1;
          #1#8 = fFecIni;
          |PINTA #1#8;
     |FINSI;

|FPRC;
-------------------------------------------------------------------------------
|PROCESO MirFec; |TIPO 0;
     nModo = (FEntrada/100)!0;
     nHay = 0;

     |SI nModo = 1; |Y Campo = 8;
          |SALVA_FICHA #1;
          fFecIni = #1#8;
          |BUCLE MiraFecha;

          |SI nHay = 1;
               |REPON_FICHA #1;
               cTexto = fFecIni;
               cTexto = "0000EXISTE UN PERIDO CON LA FECHA " + cTexto;
               |MENAV cTexto;
               #1#8 = ~;
               |ERROR;
               |ACABA;
          |FINSI;

          |REPON_FICHA #1;
          #1#9 = #1#8 + 1;
     |FINSI;

     |SI Campo = 9; |Y #1#8 > #1#9;
          |MENAV "0000LA FECHA DEBE SE SUPERIOR A LA INICIAL";
          |ERROR;
          #1#9 = #1#8 + 1;
     |FINSI;

|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE buclecompro2;
     #4#1;
     ;
     #0#0,#0#1,001,  1;
     #0#0,#0#1,999,999;
     ;
     NULL,buclecompro;
|FIN;

|PROCESO BajaCer; |TIPO 2;

     nModo = (FEntrada/100)!0;

     |SI nModo = 3;
          swCompro = 0;
          |BUCLE buclecompro2;
          |SI swCompro = 1;
               |MENAV "0000No se puede dar de Baja existen Mediciones";
               |ERROR;
               |ACABA;
          |FINSI;

          ||BUCLELIN 2 Borr #0;

          |SI nError = 1;
               |ERROR;
          |FINSI;

     |FINSI;

|FPRC;
-----------------------------------------------------------------------------
|PROCESO Borr;
     |HAZ Baja;
     |SI nError ! 1;
          |BORRA 020#1a;
     |FINSI;
|FPRC;
-----------------------------------------------------------------------------
|PROCESO Imprime;
     |PRINT;
|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE gocerhip;
     #4#1;
     ;                                          ||Campos Extras.
     #0#0, #0#1,   1,   1;
     #0#0, #0#1, 999, 999;
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, Imprime;
|FIN;
-------------------------------------------------------------------------------
|DEFBUCLE gocerlip;
     #1#1;
     ;                                          ||Campos Extras.
     #0#0, #0#1,   1;
     #0#0, #0#1, 999;
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, Imprime;
|FIN;
-------------------------------------------------------------------------------
|DEFBUCLE gocerhis;
     #52#1;
     ;                                          ||Campos Extras.
     #0#0, #0#1,   1,   1;
     #0#0, #0#1, 999, 999;
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, Imprime;
|FIN;
-------------------------------------------------------------------------------
|DEFBUCLE gocerlin;
     #51#1;
     ;                                          ||Campos Extras.
     #0#0, #0#1,   1;
     #0#0, #0#1, 999;
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, Imprime;
|FIN;
-------------------------------------------------------------------------------
|DEFBUCLE gopartia;
     #25#3;
     ;
     #0#4, #0#5, #0#0, #0#1, "                    ", "                    ";
     #0#4, #0#5, #0#0, #0#1, "zzzzzzzzzzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, Imprime;
|FIN;

-------------------------------------------------------------------------------
|PROCESO ImpCapi;
     nAlgo = 1;
     |PRINT;
|FPRC;

|DEFBUCLE gopre022;
     #gopre022#1;
     ;
     #0#0, #0#1, 001, 001;
     #0#0, #0#1, 999, 999;
     ;
     NULL, ImpCapi;
|FIN;

|PROCESO AnyadeCero;
     #gopre021#0 = #0#0;
     #gopre021#1 = #0#1;
     #gopre021#2 = 999;
     #gopre021#3 = "Sin Agrupacion";
     |PRINT;
|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE gopre021;
     #gopre021#1;
     ;
     #0#0, #0#1, 001;
     #0#0, #0#1, 999;
     ;
     NULL, ImpCapi, , ,AnyadeCero;
|FIN;
-------------------------------------------------------------------------------
|PROCESO gopre100;
     |SI #gopre002#14 ! nCAPITULO_ANT; |O #gopre002#14 = 0;
          nSUBCAPITULO = 0;
          nCAPITULO = nCAPITULO + 1;
     |FINSI;
     |SI #gopre002#14 = 0;
          nSUBCAPITULO = 0;
     |SINO;
          nSUBCAPITULO = nSUBCAPITULO + 1;
     |FINSI;
     nCAPITULO_ANT = #gopre002#14;

     |PRINT;
|FPRC;

|DEFBUCLE gopre100;
     #gopre002#1;
     ;
     #0#0, #0#1, 001;
     #0#0, #0#1, 999;
     ;
     NULL, gopre100;
|FIN;
-------------------------------------------------------------------------------
|PROCESO Recibos; |TIPO 4;
     /* MEDICIONES PRODUCCION */

     |SUB_EJECUTA_NP "goinform;IMPgocercap";
     |INFOR "gocercap";
     |PRINT;
     |PIEINF;
     |FININF;
     |SUB_EJECUTA_NP "goinform;ENVgocercap";

     |SUB_EJECUTA_NP "goinform;IMPgocerlip";
     |INFOR "gocerlip";
     |BUCLE gocerlip;
     |PIEINF;
     |FININF;
     |SUB_EJECUTA_NP "goinform;ENVgocerlip";

     |SUB_EJECUTA_NP "goinform;IMPgocerhip";
     |INFOR "gocerhip";
     |BUCLE gocerhip;
     |PIEINF;
     |FININF;
     |SUB_EJECUTA_NP "goinform;ENVgocerhip";

     /* MEDICIONES CERTIFICACION CLIENTES */

     |SUB_EJECUTA_NP "goinform;IMPgocercab";
     |ABRE #50;
     #50#0 = #0#0;
     #50#1 = #0#1;
     |LEE 000#50=;
     |SI FSalida = 0;
          |INFOR "gocercab";
          |PRINT;
          |PIEINF;
          |FININF;
     |FINSI;
     |CIERRA #50;
     |SUB_EJECUTA_NP "goinform;ENVgocercab";

     |SUB_EJECUTA_NP "goinform;IMPgocerlin";
     |INFOR "gocerlin";
     |BUCLE gocerlin;
     |PIEINF;
     |FININF;
     |SUB_EJECUTA_NP "goinform;ENVgocerlin";

     |SUB_EJECUTA_NP "goinform;IMPgocerhis";
     |INFOR "gocerhis";
     |BUCLE gocerhis;
     |PIEINF;
     |FININF;
     |SUB_EJECUTA_NP "goinform;ENVgocerhis";

     /* MEDICIONES ESTIMADAS-PRESUPUESTADAS */

     |SUB_EJECUTA_NP "goinform;IMPgoparlin";
     |INFOR "goparlin";
     |ABRE #10;
     #10#0 = #0#0;
     #10#1 = #0#1;
     |LEE 000#10=;
     |SI FSalida = 0;
         |BUCLELIN 2ImpParti#10;
         |PIEINF;
         |FININF;
     |FINSI;
     |CIERRA #10;
     |SUB_EJECUTA_NP "goinform;ENVgoparlin";

     /* CONSUMOS EXPEDIENTES - SUBCONTRATAS */

     |SUB_EJECUTA_NP "goinform;IMPgopartia";
     |INFOR "gopartia";
     |BUCLE gopartia;
     |PIEINF;
     |FININF;
     |SUB_EJECUTA_NP "goinform;ENVgopartia";

     |SUB_EJECUTA_NP "goinform;IMPgopre021";
     |INFOR "gopre021";
     nAlgo = 0;
     |BUCLE gopre021;
     |SI nAlgo = 0;
          |HAZ AnyadeCero;
     |FINSI;
     |PIEINF;
     |FININF;
     |SUB_EJECUTA_NP "goinform;ENVgopre021";

     |SUB_EJECUTA_NP "goinform;IMPgopre022";
     |INFOR "gopre022";
     |BUCLE gopre022;
     |PIEINF;
     |FININF;
     |SUB_EJECUTA_NP "goinform;ENVgopre022";

     |SUB_EJECUTA_NP "goinform;IMPgopre100";
     |INFOR "gopre100";
     nCAPITULO = 0;
     nSUBCAPITULO = 0;
     |BUCLE gopre100;
     |PIEINF;
     |FININF;
     |SUB_EJECUTA_NP "goinform;ENVgopre100";

     |SUB_EJECUTA_NP "goinform;RUNPRODUCCION";
     |CIERRA #6;
|FPRC;
-----------------------------------------------------------------------------
|PROCESO ImpAmp;
     |PRINT;
|FPRC;
-----------------------------------------------------------------------------
|DEFBUCLE ImpAmp;
     #202#1;
     ;
     #12#4, #11#0, #11#1, #11#12,  1;
     #12#4, #11#0, #11#1, #11#12, 999;
     ;
     NULL, ImpAmp;
|FIN;
-----------------------------------------------------------------------------
|PROCESO ImpPartida;
     |SI #gopre002#14 = 0;
          #gopre002#14 = 999;
     |FINSI;
     |BUCLE ImpAmp;
|FPRC;
-----------------------------------------------------------------------------
|DEFBUCLE ImpPartida;
     #12#1;
     ;
     #10#0, #10#1, #11#12,   1;
     #10#0, #10#1, #11#12, 999;
     ;
     NULL,ImpPartida;
|FIN;
-----------------------------------------------------------------------------
|PROCESO ImpParti;
     |BUCLE ImpPartida;
|FPRC;
-----------------------------------------------------------------------------
|PROCESO Escape; |TIPO 11;

     |SI FSalida = 7; |Y Campo ! 2;
          |MENAV "0000DEBE COMPLETAR LA LINEA";
          |ERROR10;
     |FINSI;

|FPRC;
-------------------------------------------------------------------------------
/*                       ARREGLAR
|PROCESO MiraDatos;

     |SI nSwich = 1;
          |SELECT #3#26;
          |DDEFECTO #26;
          #26#0  = #25#0;                              ||Serie Presupuesto.
          #26#1  = #25#1;                              ||Nº Presupuesto.
          #26#15 = #25#28;                             ||Fecha Documento.
          #26#16 = #25#20;                             ||Articulo.
          #26#8  = #25#11;                             ||Precio Venta.
          |LEE 000#26=;

          |SI FSalida ! 0;
               #26#2 = #1#2;                           ||Nº Cerificacion.
               nLinea = nLinea + 1;
               #26#3 = nLinea;                         ||Linea.
               |GRABA 020#26c;
          |FINSI;

          #26#12 = 100;                                ||Tanto Porcien.
          #26#4  = #25#8;                              ||Partida.
          #26#5  = #25#9;                              ||Desc. Partida.
          #26#18 = #26#18 + #25#10;                    ||Cantidad.
          #26#9  = #26#18 * #26#8;                     ||Importe.
          #26#10 = #26#9 ;                             ||Importe Certificado.
          #26#17 = #25#30;                             ||Descripcion Articulo.
          #26#19 = #25#29;                             ||Tipo Articulo.
          |GRABA 020#26a
          #1#6 = #1#6 + (#25#10*#25#11);
||          #25#31 = "S";
||          |GRABA 020#25a;
     |FINSI;

     #0#11 = #0#11 + (#25#10*#25#11);
     nHay = 1;

|FPRC;
------------------------------------------------------------------------------
|DEFBUCLE Partidas;
     #25#7;
     28,31;
     #0#0, #0#1, #0#4, #0#5, #1#8, "N";
     #0#0, #0#1, #0#4, #0#5, #1#9, "N";
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, NULL, NULL, NULL, NULL, MiraDatos;
     #25#28;
|FIN;
*/
-------------------------------------------------------------------------------
|PROCESO Admin; |TIPO 0;

     nHay = 0;

     |SI #1#7 = "N"; |Y #0#15 = "A";
          nModo = (FEntrada/100)!0;
          nSwich = 1;

          |SI nModo = 2;
               |CONFI "0000N¿DESEA ACTUALIZAR LAS LINEAS DE ARTICULOS?";

               |SI FSalida = 0;
                 ||   |BUCLE BorraAdmi;         ARREGLAR
                    #1#6 = 0;
                    nSwich = 1;
               |SINO;
                    nSwich = 0;
                    nHay = 1;
               |FINSI;

          |FINSI;

          |ABRE #26;
          #0#11 = 0;
   ||       |BUCLE Partidas;       ARREGLAR
          |CIERRA #26;

          |SI nHay = 0;
               |MENAV "0000NO EXISTEN DATOS EN EL PERIODO SOLICITADO";
               |PTEC 806;
               |ACABA;
          |FINSI;

     |FINSI;

|FPRC;
------------------------------------------------------------------------------
|PROCESO DatFac; |TIPO 0;

     |SI #1#7 = "S";



          |SI FSalida = 2;
               |C_M #1#4, 1, "S";
               |C_M #1#5, 1, "S";
               nCont = 1;
          |FINSI;

     |FINSI;

|FPRC;

|PROCESO Tipo13; |TIPO 13;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     |SI #100#141 = "O";
          |PINTA 602, "O.E........:";
          |PINTA 702, "O.T........:";
     |FINSI;
|FPRC;
