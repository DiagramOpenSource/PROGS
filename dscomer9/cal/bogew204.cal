|FICHEROS;
     bogem027 #27,MANTE; || Albaran Venta C
     bogem028 #28,MANTE; || Albaran Venta L
     bogem005 #5,MANTE;
     bogem006 #6,MANTE;
     bogem007 #7,MANTE; || Pedido Venta C
     bogem009 #9,MANTE; || Confirma Entrega C
     bogem010 #10,MANTE; || Confirma Entrega L
     bogem011 #11,MANTE; || Orden Salida C
     bogem012 #12,MANTE; || Orden Salida L
     bogem013 #13,MANTE; || Control Calidad
     bogem015 #15,MANTE;
     bogem016 #16,MANTE;

     agifa019 #19;

     bogew020 #20,MANTE;
     bogew021 #21,MANTE;
     bogew022 #22,MANTE;

     bogem023 #23;

     bogem026 #26,MANTE; || Pedido Venta L

     bogem030 #30;

     bogew010 #55,MANTE;  || Tmp Marca confirma entrega
     bogew011 #56,MANTE;  || Tmp Albaran Venta
     bogew013 #58,MANTE;  || Tmp Orden Salida
     bogew014 #59,MANTE;  || Tmp selec confirma recge/entrega

     bogez006 #60,MANTE;  || Tmp seleccion (PRINCIPAL)

     agifa112 #112;
     agifa142 #142;

     bogem020 #200,MANTE;  ||Compra (principal)
     agifa060 #600;
     agifa112@;
     agifa010 #210;
     bogem006@;
|FIN;

|VARIABLES;
     aTmp6 = "";
     nPend = 0;
     nError = 0;
     aTmp21 = "";
     aTmp22 = "";
     nPrimeLin = 0;
     nPrimeRec = 0;
     nPedido = 0;
     &enMenuAuto = 0;
     aInfOrdSal = "bordsali";
     nPenCaja = 0;
     nPenPale = 0;
     nHayLin = 0;
     &eaTransporte = "";
     &nBoton2 = 0;
     &nBoton3 = 0;
     &nBoton4 = 0;
     &nBoton5 = 0;
     &nBoton6 = 0;
     &nBoton7 = 0;
     &nBoton8 = 0;
     &nBoton9 = 0;
     &nBoton10 = 0;
     &Tempo = "";
     &eaBorCab = "";
     &eaNueva = "";
     nHayReg = 0;
     &enEntrega = 0;
     nLin = 0;
     aGuarda = "";
     aConEntrega = "";
     aCampos = "";
     aDef = "";
     nNume = 0;
     aAlfa = "";
     i = 0;
     aEstado = "";
     aTmp55 = "";
     aTmp56 = "";
     aTmp58 = "";
     aTmp59 = "";
     nModo = 0;
     nTecla = 0;
     aNueva = "";
     nUltNumero = 0;
     nSal = 0;

  {-1}aMenu = "";
     aMenu1 = "2400";
     aMenu2 = "1";
     aMenu3 = "";
     aMenu4 = "MBI";
     aMenu5 = " Modificacion ";
     aMenu6 = " Baja ";
     aMenu7 = " Imprimir ";

  {-1}aMenuc = "";
     aMenuc1 = "2400";
     aMenuc2 = "1";
     aMenuc3 = "";
     aMenuc4 = "MBLI";
     aMenuc5 = " Modificacion ";
     aMenuc6 = " Baja ";
     aMenuc7 = " Lineas ";
     aMenuc8 = " Imprimir ";
     fiac      = "  ";
     guarda    = "  ";
     relleno   = "                                       ";
     aponer    = "  ";
     aSirviendo = "";
     nPen = 0;
     nHay = 0;
     nLinea = 0;
     nPrime = 0;
|FIN;
----------------------------------------------
|PROCESO ImpOrdSalLin;
     nHayLin = 1;
     |PRINT;
|FPRC;

|DEFBUCLE ImpOrdSalLin;
     #12#1;
     ;
     #11#0, #11#31, 001;
     #11#0, #11#31, 999;
     ;
     NULL, ImpOrdSalLin;
|FIN;

|RUTINA ImpOrdSal;
     Impresora = "Crystal Reports";
     |IMPRE 0;
     |SI FSalida = 0;
          aInfOrdSal = #30#2; |QBF aInfOrdSal;
          |INFOR aInfOrdSal;
          |SI FSalida ! 0;
               aAlfa = "0000Error en informe:" + aInfOrdSal;
               |MENAV aAlfa;
          |SINO;
               nHayLin = 0;
               |BUCLE ImpOrdSalLin;
               |SI nHayLin = 0;
                    |DDEFECTO #12;
                    |PRINT;
               |FINSI;
               |PIEINF;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FRUT;
---------------------------------------------- bogew010
|PROCESO HayMarcaEnt;
     |SI #59#13 = "*";
          nHay = 1;
     |FINSI;
|FPRC;

|DEFBUCLE HayMarcaEnt;
     #59#1;
     ;
     #55#0, #55#25, 001;
     #55#0, #55#25, 999;
     ;
     NULL, HayMarcaEnt;
|FIN;

|PROCESO Min59_2;
     #59#0 = #55#0;
     #59#1 = #55#25;
     #59#2 = 001;
|FPRC;

|PROCESO Max59_2;
     #59#0 = #55#0;
     #59#1 = #55#25;
     #59#2 = 999;
|FPRC;

|PROCESO Tipo55_0; |TIPO 0;
     |SI #55Campo = Contenido; |Y FSalida = 0;
          |PUSHV 0501 2380;
          |ENTLINEAL #1#59, 3, 4, 22, 1, Min59_2, Max59_2;
          |POPV;
          nHay = 0;
          |BUCLE HayMarcaEnt;
          |SI nHay ! 0;
               #55#36 = "*";
          |SINO;
               #55#36 = "";
          |FINSI;
          |PINTA #55#36;
          |GRABA 020#55a;
     |FINSI;
|FPRC;
---------------------------------------------- bogem012
|PROCESO DefeAlma12; |TIPO 0;
     #12#16 = #11#2;
|FPRC;

|PROCESO Palet12_0; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;

     |SI nModo = 1; |Y #11#39 ! 0;  ||con conf.entrega
          |MENAV "0000Alta no permitida...";
          |ERROR; |ACABA;
     |FINSI;

     |SI nModo = 2; |O #11#39 = 0;
          |ABRE #16;
          |SELECT #2#16;
          #16#17 = #11#2;
          #16#3 = #12#3
          |LEE 000#16=;
          |SI FSalida ! 0;
               |MENAV "0000No existe el palet en camara...";
               |ERROR; |ACABA;
          |SINO;
               |ABRE #15;
               #15#0 = #16#0;
               #15#24 = #16#1;
               |LEE 020#15=;
               |CIERRA #15;
               |SI #11#11 ! #15#14;
                    |MENAV "0000Articulo distinto al de entrada de camara...";
                    |ERROR; |ACABA;
               |FINSI;
               |CIERRA #15;

               |SI #12Campo ! Contenido;
                    #12#4 = #16#4; |PINTA #12#4;
                    #12#12 = #16#11; |PINTA #12#12;
                    #12#13 = #16#12; |PINTA #12#13;
                    #12#14 = #16#13; |PINTA #12#14;
                    #12#5 = #16#5; |PINTA #12#5;
                    #12#6 = #16#6 - #16#15; |PINTA #12#6;
               |FINSI;
          |FINSI;
          |CIERRA #16;
     |FINSI;
|FPRC;

|PROCESO Palet12_7; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;

     |SI nModo = 1; |Y #11#39 = 0;  ||sin conf.entrega
          aAlfa = (("000000" + #12#0) % -106) + (("000000" + #12#1) % -102) + (("000" + #12#2) % -102);
          #12#3 = aAlfa; |PINTA #12#3;

          |ABRE #26;
          #26#0 = #11#0;
          #26#1 = #11#32;
          #26#2 = #11#38;
          |LEE 000#26=;
          |SI FSalida = 0
               #12#6 = #26#5 - #26#18; |PINTA #12#6;
               #12#7 = #26#6; |PINTA #12#7;
          |FINSI;
          |CIERRA #26;
     |FINSI;
|FPRC;

|PROCESO Total12; |TIPO 0;
     #12#8 = #12#7 * #12#6; |PINTA #12#8;

     |SI #12Campo ! Contenido; |Y Campo = 6;
          #12#9 = #11#27 / #12#6; |PINTA #12#9;
     |FINSI;
|FPRC;

|PROCESO Uni12; |TIPO 0;
     |SI #11#39 ! 0;  ||sin conf.entrega
          |ABRE #10;
          #10#0 = #12#0;
          #10#1 = #12#1;
          #10#2 = #12#2;
          |LEE 000#10=;
          |SI FSalida = 0;
               #10#13 = #10#13 + #12#6;
               |SI #10#13 > #10#6;
                    nNume = #10#13 - #10#6;
                    aAlfa = "0000Se superan las unidades en:" + nNume;
                    |MENAV aAlfa;
                    |ERROR; |ACABA;
               |FINSI;
          |SINO;
               |MENAV "0000Alta no permitida...";
               |ERROR; |ACABA;
          |FINSI;
          |CIERRA #10;
     |SINO;    || de pedido
          |ABRE #26;
          #26#0 = #11#0;
          #26#1 = #11#32;
          #26#2 = #11#38;
          |LEE 000#26=;
          |SI FSalida = 0
               #26#18 = #26#18 + #12#6;
               |SI #26#18 > #26#5;
                    nNume = #26#18 - #26#5;
                    aAlfa = "0000Se superan las unidades en:" + nNume;
                    |MENAV aAlfa;
                    |ERROR; |ACABA;
               |FINSI;
          |FINSI;
          |CIERRA #26;
     |FINSI;

     |ABRE #16;
     |SELECT #2#16;
     #16#17 = #11#2;
     #16#3 = #12#3
     |LEE 101#16=;
     |SI FSalida ! 0;
          |MENAV "0000No existe el palet en camara...";
          |ERROR; |ACABA;
     |SINO;
          nNume = (#16#6 - #16#15) ! 3;
          |SI nNume < #12#6;
               aAlfa = "0000Los kilos del palet superan a los que hay en la camara:" + nNume;
               |MENAV aAlfa;
               |ERROR; |ACABA;
          |FINSI;
     |FINSI;
     |CIERRA #16;
|FPRC;

|PROCESO Tipo12_2; |TIPO 2;
     #12#8 = #12#7 * #12#6;
     #11#13 = #11#13 +. #12#6; || Kilos
     #11#14 = #11#14 +. #12#10;|| Coste Alma
     #11#33 = #11#33 +. #12#8; || Total
     #11#15 = #11#33 + (#11#25 * #11#40) + (#11#26 * #11#41);

     |SI #11#39 ! 0;     || Con confirmacion
          |ABRE #10;
          #10#0 = #12#0;
          #10#1 = #12#1;
          #10#2 = #12#2;
          |LEE 101#10=;
          |SI FSalida = 0;
               #10#13 = #10#13 +. #12#6;
               |GRABA 020#10a;
               |LIBERA #10;
          |SINO;
               |MENAV "0000Alta no permitida...";
               |ERROR;
          |FINSI;
          |CIERRA #10;
     |FINSI;
     |ABRE #26;
     #26#0 = #11#0;
     #26#1 = #11#32;
     #26#2 = #11#38;
     |LEE 101#26=;
     |SI FSalida = 0;
          #26#18 = #26#18 +. #12#6;
          |GRABA 020#26a;
     |FINSI;
     |CIERRA #26;

     |ABRE #16;
     |SELECT #2#16;
     #16#17 = #11#2;
     #16#3 = #12#3;
     |LEE 101#16=;
     |SI FSalida = 0;
          #16#15 = #16#15 +. #12#6;
          #16#16 = #16#16 +. #12#8;
          |GRABA 020#16a;
          |LIBERA #16;
     |FINSI;
     |CIERRA #16;
|FPRC;
---------------------------------------------- bogem011
|PROCESO Almacen11_0; |TIPO 0;
     |ABRE #112;
     #112#0 = #11#2;
     |LEE 000#112=;
     |SI FSalida ! 0;
          |MENAV "0000No existe proveedor...";
          |ERROR; |ACABA;
     |SINO;
          |SI #112#42 ! "A "; |Y #112#42 ! "AT";
               |MENAV "0000No pertenece al Grupo 'A ' ó 'AT'";
               |ERROR; |ACABA;
          |FINSI;
     |FINSI;
     |CIERRA #112;
|FPRC;

|PROCESO Almacen66;
     |HAZ CreaTempo;
     |DDEF aDef;
     aAlfa = aDef + "agifa112";
     |CARGA_DEF aAlfa, agifa112@;
     |SI FSalida = 0;
          |NOME_DAT #agifa112@#Tempo#;
          |DELINDEX #agifa112@;
          aAlfa = "|NC";
          aCampos = #112#aAlfa#;
          |ABRE #agifa112@;
          |ABRE #112;
          |LEE 000#112p;
          |PARA; |SI FSalida = 0; |HACIENDO;
               |SI #112#42 = "A "; |O #112#42 = "AT";
                    |PARA i = 0; |SI i < aCampos; |HACIENDO i = i + 1;
                         #agifa112@#i# = #112i;
                    |SIGUE;
                    |GRABA 020#agifa112@.n;
               |FINSI;
               |LEE 000#112s;
          |SIGUE;
          #agifa112@#0 = eaTransporte;
          |LEE 000#agifa112@.];
          |CONSULTA_CLAVE #1#agifa112@;
          |SI FSalida = 0;
               eaTransporte = #agifa112@#0;
          |SINO;
               eaTransporte = "";
          |FINSI;
          |CIERRA #112;
          |DELINDEX #agifa112@;
          |DESCARGA_DEF #agifa112@;
     |FINSI;
     |HAZ BoraTempo;
|FPRC;

|PROCESO Almacen11_66; |TIPO 66;
     eaTransporte = #11#2;
     |HAZ Almacen66;
     |SI eaTransporte = "";
          |ERROR;
     |SINO;
          #11#2 = eaTransporte;
          |PINTA #11#2;
     |FINSI;
|FPRC;

|PROCESO DefectoPe11; |TIPO 0;
     |SI FSalida = 2; |ACABA; |FINSI;

     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 1; |ACABA; |FINSI;

     |C_M #11#38, 1, "S";
     |SI #11#32 = 0;
          |C_M #11#38, 1, "N";
          |ABRE #200;
          #200#0 = #60#0;
          #200#33 = #60#9;
          |LEE 020#200=;
          |CIERRA #200;
          #11#38 = #200#33; |PINTA #11#38;
          #11#11 = #200#7; |PINTA #11#11;
          #11#12 = #200#8; |PINTA #11#12;
          #11#25 = #200#21; |PINTA #11#21;
          #11#26 = #200#22; |PINTA #11#22;
          |ACABA;
     |FINSI;


     |SI Campo = 32; |O Campo = 38;
          |ABRE #7;
          #7#0 = #11#0;
          #7#19 = #11#32;
          |LEE 000#7=;
          |SI FSalida ! 0;
               |MENAV "0000No existe pedido de ventas...";
               |ERROR;
          |SINO;
               |SI Campo = 38;
                    |ABRE #26;
                    #26#0 = #11#0;
                    #26#1 = #11#32;
                    #26#2 = #11#38;
                    |LEE 000#26=;
                    |SI FSalida ! 0;
                         |MENAV "0000No existe lines de pedido de ventas...";
                         |ERROR;
                    |SINO;
                         #11#4 = #7#4;
                         #11#5 = #7#5
                         #11#6 = #7#6;
                         #11#7 = #7#7;
                         #11#16 = #7#17;
                         #11#18 = #7#12;
                         #11#10 = #7#10;

                         #26#0 = #11#0;
                         #26#1 = #11#32;
                         #26#2 = #11#38;
                         |LEE 020#26=;
                         |SI FSalida = 0;
                              #11#11 = #26#3;
                              #11#12 = #26#4;
                              #11#25 = #26#8;
                              #11#27 = #26#10;
                              #11#29 = #26#12;
                              #11#40 = #26#16;
                              #11#26 = #26#9;
                              #11#28 = #26#11;
                              #11#30 = #26#13;
                              #11#41 = #26#17;
                         |FINSI;
                         |PINDA #0#11;
                    |FINSI;
                    |CIERRA #26;
               |FINSI;
          |FINSI;
          |CIERRA #7;
     |FINSI;
|FPRC;

|PROCESO Minz7;
     #7#0 = #11#0;
     #7#19 = 001;
|FPRC;

|PROCESO Maxz7;
     #7#0 = #11#0;
     #7#19 = 999;
|FPRC;

|PROCESO Minz26;
     #26#0 = #11#0;
     #26#1 = #11#32;
     #26#2 = 001;
|FPRC;

|PROCESO Maxz26;
     #26#0 = #11#0;
     #26#1 = #11#32;
     #26#2 = 999;
|FPRC;

|PROCESO ConsultaPe11; |TIPO 66;
     |SI Campo = 32;
          |ABRE #7;
          #7#0 = #11#0;
          #7#19 = #11#32;
          |LEE 000#7];
          |CONSULTA_F_CLAVE #1#7, Minz7, Maxz7;
          |SI FSalida = 0;
               #11#32 = #7#19; |PINTA #11#32;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #7;
     |SINO; || = 38;
          |ABRE #26;
          #26#0 = #11#0;
          #26#1 = #11#32;
          #26#2 = #11#38;
          |LEE 000#26];
          |CONSULTA_F_CLAVE #1#26, Minz26, Maxz26;
          |SI FSalida = 0;
               #11#38 = #26#2; |PINTA #11#38;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #26;
     |FINSI;
|FPRC;

|PROCESO Defecto11; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 1; |ACABA; |FINSI;

     |ABRE #9;
     #9#0 = #11#0;
     #9#25 = #11#39;
     |LEE 000#9=;
     |SI FSalida = 0;
          #11#32 = #9#35;
          #11#38 = #9#36;
          |C_M #11#32, 1, "N";
          |C_M #11#38, 1, "N";
     |SINO;
          |SI #11#39 ! 0;
               |MENAV "0000No existe confirmacion de entrega, (introduzca '000' para continuar).";
               |ERROR;
          |SINO;
               |C_M #11#32, 1, "S";
               |C_M #11#38, 1, "S";
          |FINSI;
     |FINSI;
     |CIERRA #9;
|FPRC;

|PROCESO Minz9;
     #9#0 = #11#0;
     #9#25 = 1;
|FPRC;

|PROCESO Maxz9;
     #9#0 = #11#0;
     #9#25 = 999;
|FPRC;

|PROCESO Consulta11; |TIPO 66;
     |ABRE #9;
     #9#0 = #11#0;
     #9#25 = #11#39;
     |LEE 000#7];
     |CONSULTA_F_CLAVE #1#9, Minz9, Maxz9;
     |SI FSalida = 0;
          #11#39 = #9#25; |PINTA #11#39;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #9;
|FPRC;

|PROCESO Total11; |TIPO 0;
     #11#15 = #11#33 + (#11#25 * #11#40) + (#11#26 * #11#41);
     |PINTA #11#15;
|FPRC;
---------------------------------------------- bogew013
|PROCESO Tecla58_11; |TIPO 11;
     |SI FSalida ! 1; |Y FSalida ! 7; |Y FSalida ! 0;
               |Y FSalida ! 2; |Y FSalida ! 3;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tecla58_0; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     nTecla = FSalida;
     |DDEFECTO #11;
     #11#0 = #58#0;
     #11#31 = #58#1;
     |LEE 000#11=;
     |SI FSalida ! 0; |Y nTecla = 0;
          aNueva = "S";
          |HAZ OrdSal0;
          |SI aNueva = ""; |ERROR; |FINSI;
     |SINO;
          aNueva = "N";
          |HAZ OrdSal0;
          |PTEC 809;     || Abajo
          |ERROR;
          |PONCONTROL 23, "SI";
     |FINSI;
|FPRC;

|PROCESO Borra12;
     |SI #11#39 ! 0;
          #10#0 = #12#0;
          #10#1 = #12#1;
          #10#2 = #12#2;
          |LEE 101#10=;
          |SI FSalida = 0;
               #10#13 = #10#13 - #12#6;
               |GRABA 020#10a;
               |LIBERA #10;
          |FINSI;
     |FINSI;
     #26#0 = #11#0;
     #26#1 = #11#32;
     #26#2 = #11#38;
     |LEE 101#26=;
     |SI FSalida = 0;
          #26#18 = #26#18 - #12#6;
          |GRABA 020#26a;
          |LIBERA #26;
     |FINSI;

     |SELECT #2#16;
     #16#17 = #11#2;
     #16#3 = #12#3;
     |LEE 101#16=;
     |SI FSalida = 0;
          #16#15 = #16#15 - #12#6;
          #16#16 = #16#16 - #12#8;
          |GRABA 020#16a;
          |LIBERA #16;
     |FINSI;

     |BORRA 020#12a;
     |LIBERA #12;
|FPRC;

|DEFBUCLE Borra12;
     #12#1;
     ;
     #11#0, #11#31, 001;
     #11#0, #11#31, 999;
     be;
     NULL, Borra12;
|FIN;

|PROCESO Min12;
     #12#0 = #11#0;
     #12#1 = #11#31;
     #12#2 = 1;
|FPRC;

|PROCESO Max12;
     #12#0 = #11#0;
     #12#1 = #11#31;
     #12#2 = 999;
|FPRC;

|PROCESO Llena12;
     |DDEFECTO #12;
     #12#0 = #11#0;
     #12#1 = #11#31;
     |PARA i = 2; |SI i [ 8; |HACIENDO i = i + 1;
          #12i = #10i;
     |SIGUE;
     #12#12 = #10#14;
     #12#13 = #10#15;
     #12#14 = #10#16;
     #12#16 = #11#2;
     #12#6 = #10#6 - #10#13;
     |SI #12#6 > 0;
          |GRABA 020#12n;
          |HAZ Tipo12_2;
     |FINSI;
|FPRC;

|DEFBUCLE Llena12;
     #10#1;
     ;
     #11#0, #11#39, 001;
     #11#0, #11#39, 999;
     be;
     NULL, Llena12;
|FIN;

|PROCESO CheqPaletCamara;
     |SELECT #2#16;
     #16#17 = #11#2;
     #16#3 = #10#3
     |LEE 000#16=;
     |SI FSalida ! 0;
          aAlfa = "0000No existe el palet " + #10#3;
          |MENAV aAlfa;
          nError = 1;
     |SINO;
          nNume = #16#6 - #16#15;
          |SI nNume < #10#6;
               aAlfa = "0000Los kilos del palet " + #10#3; |QBF aAlfa;
               aAlfa = aAlfa + " superan a los que hay en la camara";
               |MENAV aAlfa;
               nError = 1;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE CheqPaletCamara;
     #10#1;
     ;
     #11#0, #11#39, 001;
     #11#0, #11#39, 999;
     be;
     NULL, CheqPaletCamara;
|FIN;

|RUTINA OrdSal0;
     |PUSHV 0501 2380;
     |SI aNueva = "S";
          #11#0 = #60#0;
          #11#31 = 9999;
          |LEE 000#11];
          |SI FSalida = 0;
               |LEE 000#11a;
          |SINO;
               |LEE 000#11u;
          |FINSI;
          |SI FSalida = 0; |Y #11#0 = #60#0;
               nUltNumero = #11#31 + 1;
          |SINO;
               nUltNumero = 1;
          |FINSI;

          |DDEFECTO #11;
          #11#0 = #60#0;
          #11#31 = nUltNumero;
          |GRABA 020#11b;

          |PINPA #0#11;
          |PINDA #0#11;
          |C_M #11#39, 1, "S";
          |ENDATOS #1#11;
          |SI FSalida = 0;
               nError = 0;
               |SI #11#39 ! 0;
                    |ABRE #16;
                    |BUCLE CheqPaletCamara;
                    |CIERRA #16;
                    |SI nError ! 0;
                         aNueva = "";
                         |BORRA 020#11c;
                         |MENAV "0000Proceso anulado...";
                         |POPV;
                         |ACABA;
                    |FINSI;
               |FINSI;

               |ABRE #12;
               |ABRE #16;
               |BUCLE Llena12;
               |CIERRA #16;
               |CIERRA #12;
               |ENTLINEAL #1#12, 3, 1, 22, 1, Min12, Max12;
               |GRABA 020#11a;
               |CONFI "0000NImprimir Orden Salida Camara?";
               |SI FSalida = 0;
                    |HAZ ImpOrdSal;
               |FINSI;
               |HAZ LlenaOrdSalida;
          |SINO;
               aNueva = "";
               |BORRA 020#11c;
          |FINSI;
     |SINO;
          #11#0 = #58#0;
          #11#31 = #58#1;
          |LEE 121#11=;

          |PINPA #0#11;
          |PINDA #0#11;
          |MENU aMenuc;
          nSal = FSalida;
          |SI nSal = 1;
               |C_M #11#39, 1, "N";
               |ENDATOS #2#11;
               |SI FSalida = 0;
                    |ENTLINEAL #1#12, 3, 2, 22, 1, Min12, Max12;
                    |GRABA 020#11a;
                    |SI FSalida = 0;
                         |CONFI "0000NImprimir Orden Salida Camara?";
                         |SI FSalida = 0;
                              |HAZ ImpOrdSal;
                         |FINSI;
                    |FINSI;
               |FINSI;
          |FINSI;
          |SI nSal = 2;
               |CONFI "0000NBorrar Confirmacion Entrega?";
               |SI FSalida = 0;
                    |BORRA 020#58a;
                    |BORRA 020#11a;
                    |ABRE #10;
                    |ABRE #26;
                    |ABRE #16;
                    |BUCLE Borra12;
                    |CIERRA #16;
                    |CIERRA #26;
                    |CIERRA #10;
               |FINSI;
          |FINSI;
          |SI nSal = 3;
               |ENTLINEAL #1#12, 3, 2, 22, 1, Min12, Max12;
               |GRABA 020#11a;
          |FINSI;
          |SI nSal = 4;
               |HAZ ImpOrdSal;
          |FINSI;
     |FINSI;
     |POPV;
|FRUT;

|PROCESO LlenaOrdSalida;
     #58#0 = #11#0;
     #58#1 = #11#31;
     #58#2 = #11#32;
     #58#3 = #11#38;
     #58#4 = #11#2;
     #58#5 = #11#3;
     #58#6 = #11#5;
     #58#7 = #11#6;
     |GRABA 020#58n;
|FPRC;

|DEFBUCLE LlenaOrdSalida;
     #11#1;
     ;
     #60#0, 001;
     #60#0, 999;
     ;
     NULL, LlenaOrdSalida;
|FIN;

|PROCESO Min58;
     #58#0 = #60#0;
     #58#1 = 1;
|FPRC;

|PROCESO Max58;
     #58#0 = #60#0;
     #58#1 = 999;
|FPRC;

|PROCESO OrdSal;
     |ABRE #7;
     #7#0 = #60#0;
     #7#19 = 0;
     |LEE 000#7];
     |SI FSalida ! 0; |O #7#0 ! #60#0;
          |MENAV "0000No existe pedido de ventas";
     |FINSI;
     |CIERRA #7;

     |MENSA "0000Orden Salida Camara";
     |HAZ QuitaBoton;

     |HAZ CreaTempo; aTmp58 = Tempo; |NOME_DAT #58#Tempo#; |DELINDEX #58;

     |PUSHV 0501 2380;
     |ABRE #11;
     #11#0 = #60#0;
     #11#31 = 0;
     |LEE 000#11];
     |SI FSalida = 0; |Y #11#0 = #60#0;
          |ABRE #58;
          |BUCLE LlenaOrdSalida;
          |CIERRA #58;
          |PINPA #0#58;
          |PINTA 714, #11#0;
          |ENTLINEAL #1#58, 2, 1, 22, 0, Min58, Max58;
     |SINO;
          |ABRE #58;
          aNueva = "S";
          |HAZ OrdSal0;
          |CIERRA #58;
     |FINSI;
     |CIERRA #11;
     Tempo = aTmp58; |HAZ BoraTempo; |DELINDEX #58;

     |POPV;
     |HAZ PonBoton;
|FPRC;

|PROCESO Min28;
     #28#0 = #27#0;
     #28#1 = #27#19;
     #28#2 = 1;
|FPRC;

|PROCESO Max28;
     #28#0 = #27#0;
     #28#1 = #27#19;
     #28#2 = 999;
|FPRC;

|PROCESO BusRegSaniPed;
     #28#25 = #23#2; |PINTA #28#25;
     |ERROR10;
|FPRC;

|DEFBUCLE BusRegSaniPed;
     #23#1;
     ;
     #28#0, 000, #28#2;
     #28#0, 999, #28#2;
     ;
     NULL, BusRegSaniPed;
|FIN;

|PROCESO CargaLinAlbaV;
     |SI  #59#13 ! "*";
          |ACABA;
     |FINSI;

     |DDEFECTO #9;
     #9#0 = #59#0;
     #9#25 = #59#1;
     |LEE 000#9=;

     nLin = nLin + 1;
     |DDEFECTO #28;
     #28#0 = #27#0;
     #28#1 = #27#19;
     #28#2 = nLin;
     #28#3 = #9#15;
     #28#4 = #9#16;
     #28#5 = #59#6;
     #28#6 = #59#7;
     |SI nPrimeLin = #59#2; |Y nPrimeRec = #59#1;
          #28#8 = #9#19;      ||Solo asigna las cajas y palets al
          #28#9 = #9#20;      ||primer lote (la 1§ linea de la confirmacion)
     |FINSI;
     #28#20 = #9#38;
     #28#21 = #9#39;
     #28#7 = (#28#5 * #28#6) + (#28#8 * #28#20) + (#28#9 * #28#21);
     #28#10 = #9#21;
     #28#11 = #9#22;
     #28#12 = #9#23;
     #28#13 = #9#24;
     #28#14 = #9#35;
     #28#15 = #9#36;
     #28#16 = #59#1;
     #28#17 = #59#2;
     #28#18 = #59#3;
     #28#19 = #59#4; #28#22 = #59#15; #28#23 = #59#16; #28#24 = #59#17;
     #28#20 = #9#38;
     #28#21 = #9#39;

     #26#0 = #28#0;
     #26#1 = #28#14;
     #26#2 = #28#15;
     |LEE 000#26=;
     |SI FSalida = 0;
          #28#25 = #26#23;
     |SINO;
          |BUCLE BusRegSaniPed;
     |FINSI;

     |GRABA 020#28n;

     #10#0 = #28#0;
     #10#1 = #28#16;
     #10#2 = #28#17;
     |LEE 101#10=;
     |SI FSalida = 0;
          #10#12 = #10#12 + #28#5;
          |GRABA 020#10a;
          |LIBERA #10;

          #9#0 = #10#0;
          #9#1 = #10#1;
          |LEE 101#9=;
          |SI FSalida = 0;
               #26#0 = #9#0;
               #26#1 = #9#35;
               #26#2 = #9#36;
               |LEE 101#26=;
               |SI FSalida = 0;
                    #26#14 = #26#14 + #28#5;
                    #26#19 = #26#19 + #28#8;
                    #26#20 = #26#20 + #28#9;
                    |GRABA 020#26a;
                    |LIBERA #26;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE CargaLinAlbaV;
     #59#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, CargaLinAlbaV;
|FIN;

|PROCESO Borra28;
     |SI #27#22 = "N";
          #26#0 = #28#0;
          #26#1 = #28#14;
          #26#2 = #28#15;
          |LEE 101#26=;
          |SI FSalida = 0;
               #26#14 = #26#14 - #28#5;
               #26#19 = #26#19 - #28#8;
               #26#20 = #26#20 - #28#9;
               |GRABA 020#26a;
               |LIBERA #26;
          |FINSI;
     |SINO;
          #10#0 = #28#0;
          #10#1 = #28#16;
          #10#2 = #28#17;
          |LEE 101#10=;
          |SI FSalida = 0;
               #10#12 = #10#12 - #28#5;
               |GRABA 020#10a;
               |LIBERA #10;

               #9#0 = #10#0;
               #9#1 = #10#1;
               |LEE 101#9=;
               |SI FSalida = 0;
                    #26#0 = #9#0;
                    #26#1 = #9#35;
                    #26#2 = #9#36;
                    |LEE 101#26=;
                    |SI FSalida = 0;
                         #26#14 = #26#14 - #28#5;
                         #26#19 = #26#19 - #28#8;
                         #26#20 = #26#20 - #28#9;
                         |GRABA 020#26a;
                         |LIBERA #26;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;

     |BORRA 020#28a;
     |LIBERA #28;
|FPRC;

|DEFBUCLE Borra28;
     #28#1;
     ;
     #27#0, #27#19, 001;
     #27#0, #27#19, 999;
     be;
     NULL, Borra28;
|FIN;

|PROCESO BusPediVta;
     |SI #59#13 = "*";
          nPedido = #59#14;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE BusPediVta;
     #59#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, BusPediVta;
|FIN;

|RUTINA AlbVta0;
     aGuarda = FEntrada;
     |PUSHV 0501 2380;

     |DDEFECTO #210;
     |ABRE #210;
     #210#52 = #27#20;
     #210#0 = #27#21;
     |LEE 000#210=;
     |CIERRA #210;

     |ABRE #9;
     #9#0 = #60#0;
     #9#25 = #60#9;
     |LEE 000#9];
     |SI FSalida ! 0; |O #9#0 ! #60#0;
          aConEntrega = "N";
     |SINO;
          aConEntrega = "S";
     |FINSI;
     |CIERRA #9;

     |PINPA #0#27;
     |SI aNueva = "S";
          |HAZ CreaTempo; aTmp55 = Tempo; |NOME_DAT #55#Tempo#; |DELINDEX #55;
          |HAZ CreaTempo; aTmp59 = Tempo; |NOME_DAT #59#Tempo#; |DELINDEX #59;
          |SI aConEntrega = "N";
               |MENAV "0000No existe confirmacion de entrega";
               enEntrega = -1;
          |SINO;
               |HAZ EligeEntrega;
          |FINSI;
          |SI enEntrega ! 0;
               #27#0 = #60#0;
               #27#19 = 999;
               |LEE 000#27];
               |SI FSalida = 0;
                    |LEE 000#27a;
               |SINO;
                    |LEE 000#27u;
               |FINSI;
               |SI FSalida = 0; |Y #27#0 = #60#0;
                    nUltNumero = #27#19 + 1;
               |SINO;
                    nUltNumero = 1;
               |FINSI;

               |SI enEntrega = -1;
                    |ABRE #200;
                    #200#0 = #60#0;
                    #200#33 = #60#9;
                    |LEE 020#200=;
                    |CIERRA #200;

                    |DDEFECTO #27;
                    #27#0 = #60#0;
                    #27#19 = nUltNumero;
                    #27#22 = "N";

                    #27#16 = #200#31;
                    #27#8 = #20#12;
                    #27#9 = #20#13;

                    |GRABA 020#27b;
               |SINO;
                    |DDEFECTO #7;
                    |ABRE #7;
                    #7#0 = #60#0;
                    |SI aConEntrega = "N";
                         #7#19 = 0;     || Lee el primer pedido de esa referencia
                         |LEE 000#7];
                    |SINO;
                         |BUCLE BusPediVta;
                         #7#19 = nPedido;
                         |LEE 000#7=;
                    |FINSI;
                    |CIERRA #7;

                    |DDEFECTO #27;
                    #27#0 = #60#0;
                    |PARA i = 2; |SI i [ 18; |HACIENDO i = i + 1;
                         #27i = #7i;
                    |SIGUE;
                    #27#19 = nUltNumero;
                    #27#22 = aConEntrega;
                    |GRABA 020#27b;
               |FINSI;

               |PINDA #0#27;
               |ENTLINEAL #1#28, 3, 7, 23, 0, Min28, Max28;
               |C_M #27#2, 1, "S";
               |C_M #27#20, 1, "S";
               |C_M #27#21, 1, "S";
               |ENDATOS #1#27;
               |SI FSalida = 0;
                    |SI aConEntrega = "S";
                         nLin = 0;
                         |ABRE #28;
                         |ABRE #10;
                         |ABRE #9;
                         |ABRE #26;
                         |BUCLE CargaLinAlbaV;
                         |CIERRA #26;
                         |CIERRA #9;
                         |CIERRA #10;
                         |CIERRA #28;
                    |FINSI;
                    |ENTLINEAL #1#28, 3, 1, 23, 0, Min28, Max28;
                    eaNueva = "S";
                    |HAZ CreaAlbVta;
                    |GRABA 020#27a;

                    |HAZ LlenaAlbVta;

                    |CONFI "0000NImprimir Albaran de Ventas";
                    |SI FSalida = 0;
                         |HAZ ImpAlbVta;
                    |FINSI;
               |SINO;
                    aNueva = "";
                    |ABRE #26;
                    |ABRE #10;
                    |ABRE #9;
                    |BUCLE Borra28;
                    |CIERRA #9;
                    |CIERRA #10;
                    |CIERRA #26;
                    |BORRA 020#27c;
               |FINSI;
          |FINSI;
          Tempo = aTmp55; |HAZ BoraTempo; |DELINDEX #55;
          Tempo = aTmp59; |HAZ BoraTempo; |DELINDEX #59;
     |SINO;
          |PINDA #0#27;
          |ENTLINEAL #1#28, 3, 7, 23, 0, Min28, Max28;
          |MENU aMenuc;
          nSal = FSalida;
          |SI nSal = 1;       || Modi
               |C_M #27#2, 1, "N";
               |C_M #27#20, 1, "N";
               |SI #27#21 ! 0;
                    |C_M #27#21, 1, "N";
               |FINSI;
               |SI #210#38 = "S";
                    |ENDATOS #4#27;
               |SINO;
                    |ENDATOS #2#27;
               |FINSI;
               |SI FSalida = 0;
                    |SI #210#38 = "S";
                         |ENTLINEAL #1#28, 3, 4, 23, 0, Min28, Max28;
                    |SINO;
                         |ENTLINEAL #1#28, 3, 2, 23, 0, Min28, Max28;
                         eaBorCab = "N";
                         |HAZ BorraAlbVta;
                         eaNueva = "N";
                         |HAZ CreaAlbVta;
                         |GRABA 020#27a;
                    |FINSI;
                    |CONFI "0000NImprimir Albaran de ventas?";
                    |SI FSalida = 0;
                         |HAZ ImpAlbVta;
                    |FINSI;
               |FINSI;
          |FINSI;
          |SI nSal = 2; || Baja
               |CONFI "0000NBorrar albaran de ventas?";
               |SI FSalida = 0;
                    |SI #210#38 = "S";
                         |MENAV "0000Albaran facturado...";
                    |SINO;
                         eaBorCab = "S";
                         |HAZ BorraAlbVta;
                         |ABRE #26;
                         |ABRE #10;
                         |ABRE #9;
                         |BUCLE Borra28;
                         |CIERRA #9;
                         |CIERRA #10;
                         |CIERRA #26;
                         |BORRA 020#27a;
                         |BORRA 020#56a;
                    |FINSI;
               |FINSI;
          |FINSI;
          |SI nSal = 3;
               |SI #210#38 = "S";
                    |ENTLINEAL #1#28, 3, 4, 23, 0, Min28, Max28;
               |SINO;
                    |ENTLINEAL #1#28, 3, 2, 23, 0, Min28, Max28;
                    eaBorCab = "N";
                    |HAZ BorraAlbVta;
                    eaNueva = "N";
                    |HAZ CreaAlbVta;
                    |GRABA 020#27a;
               |FINSI;
          |FINSI;
          |SI nSal = 4; || Impresion
               |HAZ ImpAlbVta;
          |FINSI;
     |FINSI;

     |POPV;
     FEntrada = aGuarda;
|FRUT;

|PROCESO LlenaAlbVta;
     #56#0 = #27#0;
     #56#1 = #27#19;
     #56#2 = #27#2;
     #56#3 = #27#3;
     #56#4 = #27#20;
     #56#5 = #27#21;
     |GRABA 020#56n;
|FPRC;

|DEFBUCLE LlenaAlbVta;
     #27#1;
     ;
     #60#0, 001;
     #60#0, 999;
     ;
     NULL, LlenaAlbVta;
|FIN;

|PROCESO Min56;
     #56#0 = #60#0;
     #56#1 = 1;
|FPRC;

|PROCESO Max56;
     #56#0 = #60#0;
     #56#1 = 999;
|FPRC;

|PROCESO AlbVta;
     |ABRE #7;
     #7#0 = #60#0;
     #7#19 = 0;
     |LEE 000#7];
     |SI FSalida ! 0; |O #7#0 ! #60#0;
          |MENAV "0000No existe pedido de ventas...";
          ||ACABA;
     |FINSI;
     |CIERRA #7;

     |MENSA "0000Albaran de ventas";
     |HAZ QuitaBoton;
     |PUSHV 0501 2380;
     |HAZ CreaTempo; aTmp56 = Tempo; |NOME_DAT #56#Tempo#; |DELINDEX #56;
     |ABRE #56;

     |ABRE #27;
     #27#0 = #60#0;
     #27#19 = 0;
     |LEE 000#27];
     |SI FSalida = 0; |Y #27#0 = #60#0;
          |BUCLE LlenaAlbVta;
          |PINPA #0#56;
          |PINTA 714, #56#0;
          |ENTLINEAL #1#56, 2, 1, 22, 0, Min56, Max56;
     |SINO;
          aNueva = "S";
          |HAZ AlbVta0;
     |FINSI;
     |CIERRA #27;

     |CIERRA #56;
     Tempo = aTmp56; |HAZ BoraTempo; |DELINDEX #56;
     |POPV;
     |HAZ PonBoton;
|FPRC;

---------------------------------------------- bogem027
|PROCESO DefSerie27; |TIPO 7;
     nModo = (FEntrada / 100) !0;
     |SI nModo = 1; |Y #142#185 = "S";
          #27#20 = #142#188;
     |FINSI;
|FPRC;

|PROCESO Contador27_7; |TIPO 7;
     nModo = (FEntrada / 100) !0;
     |SI nModo = 1; |O #27#21 = 0;
          |ABRE #210;
          #210#52 = #27#20;
          |HAZ ContaAV7;
          #27#21 = #210#0; |PINTA #27#21;
          |CIERRA #210;

          |SI enMenuAuto = 2; || menu auto = 1
               |C_M #27#21, 1, "S";
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Contador27_0; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |ABRE #210;
          #210#52 = #27#20;
          #210#0 = #27#21;
          |LEE 000#210=;
          |SI FSalida = 0;
               |MENAV "0000Albaran existente...";
               |ERROR;
          |SINO;
               |C_M #27#20, 1, "N";
               |C_M #27#21, 1, "N";
          |FINSI;
          |CIERRA #210;
     |FINSI;
|FPRC;

|PROCESO Transporte27_66; |TIPO 66;
     eaTransporte = #27#5;
     |HAZ Transporte66;
     |SI eaTransporte = "";
          |ERROR;
     |SINO;
          #27#5 = eaTransporte;
          |PINTA #27#5;
     |FINSI;
|FPRC;

|PROCESO Transporte27_0; |TIPO 0;
     eaTransporte = #27#5;
     |HAZ Transporte0;
|FPRC;
---------------------------------------------- bogem028
|PROCESO Modicam28; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
/*
          |SI #27#22 = "S";
               |MENAV "0000Alta no permitida...";
               |ERROR; |ACABA;
          |FINSI;
*/
          |C_M #28#14, 1, "S";
          |C_M #28#15, 1, "S";

          |C_M #28#5, 1, "N";
          |C_M #28#6, 1, "N";
          |C_M #28#8, 1, "N";
          |C_M #28#9, 1, "N";
          |C_M #28#12, 1, "N";
          |C_M #28#13, 1, "N";
          |C_M #28#20, 1, "N";
          |C_M #28#21, 1, "N";
          |C_M #28#18, 1, "N";
          |C_M #28#19, 1, "N";
          |C_M #28#22, 1, "N";
          |C_M #28#23, 1, "N";
          |C_M #28#24, 1, "N";
     |SINO;
          |SI #28#14 = 0;
               |C_M #28#14, 1, "S";
               |C_M #28#15, 1, "S";
          |SINO;
               |C_M #28#14, 1, "N";
               |C_M #28#15, 1, "N";
          |FINSI;

          |C_M #28#5, 1, "S";
          |C_M #28#6, 1, "S";
          |C_M #28#8, 1, "S";
          |C_M #28#9, 1, "S";
          |C_M #28#12, 1, "S";
          |C_M #28#13, 1, "S";
          |C_M #28#20, 1, "S";
          |C_M #28#21, 1, "S";
          |C_M #28#18, 1, "S";
          |C_M #28#19, 1, "S";
          |C_M #28#22, 1, "S";
          |C_M #28#23, 1, "S";
          |C_M #28#24, 1, "S";
     |FINSI;
|FPRC;

|PROCESO Total28; |TIPO 0;
     #28#7 = (#28#5 * #28#6) + (#28#8 * #28#20) + (#28#9 * #28#21);
     |PINTA #28#7;
|FPRC;

|PROCESO ModiCaja28; |TIPO 0;
     |SI #28#8 = 0;
          |C_M #28#10, 1, "N";
          |C_M #28#12, 1, "N";
     |SINO;
          |C_M #28#10, 1, "S";
          |C_M #28#12, 1, "S";
     |FINSI;
|FPRC;

|PROCESO ModiPale28; |TIPO 0;
     |SI #28#9 = 0;
          |C_M #28#11, 1, "N";
          |C_M #28#13, 1, "N";
     |SINO;
          |C_M #28#11, 1, "S";
          |C_M #28#13, 1, "S";
     |FINSI;
|FPRC;

|PROCESO Minc7;
     #7#0 = #28#0;
     #7#19 = 1;
|FPRC;

|PROCESO Maxc7;
     #7#0 = #28#0;
     #7#19 = 999;
|FPRC;

|PROCESO Minc26;
     #26#0 = #28#0;
     #26#1 = #28#14;
     #26#2 = 1;
|FPRC;

|PROCESO Maxc26;
     #26#0 = #28#0;
     #26#1 = #28#14;
     #26#2 = 999;
|FPRC;

|PROCESO Consulta28; |TIPO 66;
     |SI Campo = 14;
          |ABRE #7;
          #7#0 = #28#0;
          #7#19 = #28#14;
          |LEE 000#7];
          |CONSULTA_F_CLAVE #1#7, Minc7, Maxc7;
          |SI FSalida = 0;
               #28#14 = #7#19; |PINTA #28#14;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #7;
     |SINO;
          |ABRE #26;
          #26#0 = #28#0;
          #26#1 = #28#14;
          #26#2 = #28#15;
          |LEE 000#26];
          |CONSULTA_F_CLAVE #1#26, Minc26, Maxc26;
          |SI FSalida = 0;
               #28#14 = #26#1; |PINTA #28#14;
               #28#15 = #26#2; |PINTA #28#15;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #26;
     |FINSI;
|FPRC;

|PROCESO NoAtras28; |TIPO 0;
     |SI FSalida = 2; |ERROR; |FINSI;
|FPRC;

|PROCESO Tipo2_28; |TIPO 2;
     |C_M #28#3, 1, "N";

     |SI aSirviendo = "S";
          aSirviendo = "N"; |ACABA;
     |FINSI;

     |SI #27#22 = "N";
          |ABRE #26;
          #26#0 = #28#0;
          #26#1 = #28#14;
          #26#2 = #28#15;
          |LEE 101#26=;
          |SI FSalida = 0;
               #26#14 = #26#14 +. #28#5;
               #26#19 = #26#19 +. #28#8;
               #26#20 = #26#20 +. #28#9;
               |GRABA 020#26a;
          |FINSI;
          |CIERRA #26;
     |SINO;
          |ABRE #10;
          #10#0 = #28#0;
          #10#1 = #28#16;
          #10#2 = #28#17;
          |LEE 101#10=;
          |SI FSalida = 0;
               #10#12 = #10#12 +. #28#5;
               |GRABA 020#10a;
               |LIBERA #10;

               |ABRE #9;
               #9#0 = #10#0;
               #9#1 = #10#1;
               |LEE 101#9=;
               |SI FSalida = 0;
                    |ABRE #26;
                    #26#0 = #9#0;
                    #26#1 = #9#35;
                    #26#2 = #9#36;
                    |LEE 101#26=;
                    |SI FSalida = 0;
                         #26#14 = #26#14 +. #28#5;
                         #26#19 = #26#19 +. #28#8;
                         #26#20 = #26#20 +. #28#9;
                         |GRABA 020#26a;
                    |FINSI;
                    |CIERRA #26;
               |FINSI;
               |CIERRA #9;
          |FINSI;
          |CIERRA #10;
     |FINSI;
|FPRC;

|PROCESO SirvePedVta;
     nPen = #26#5 - #26#14;
     nPenCaja = #26#8 - #26#19;
     nPenPale = #26#9 - #26#20;
     |SI nPen > 0; |O nPenCaja > 0; |O nPenPale > 0;
          #26#14 = #26#14 + nPen;
          #26#19 = #26#19 + nPenCaja;
          #26#20 = #26#20 + nPenPale;
          |GRABA 020#26a;
          nHay = 1;

          |DDEFECTO #28;
          |PARA i = 2; |SI i [ 13; |HACIENDO i = i + 1;
               #28i = #26i;
          |SIGUE;
          #28#0 = #27#0;
          #28#1 = #27#19;
          #28#2 = nLinea;
          #28#5 = nPen;
          #28#8 = nPenCaja;
          #28#9 = nPenPale;
          #28#14 = #26#1;
          #28#15 = #26#2;
          #28#20 = #26#16;
          #28#21 = #26#17;
          #28#25 = #26#23;

          |PARA FSalida = 1; |SI FSalida ! 0; |HACIENDO;
               #28#2 = nLinea;
               |SI nPrime = 0;
                    nPrime = 1;
                    |GRABA 040#28a;
               |SINO;
                    |GRABA 040#28n;
               |FINSI;
               nLinea = nLinea + 1;
          |SIGUE;
     |FINSI;
     |LIBERA #28;
|FPRC;

|DEFBUCLE SirvePedVta;
     #26#1;
     ;
     #7#0, #7#19, 001;
     #7#0, #7#19, 999;
     ;
     NULL, SirvePedVta;
|FIN;


|PROCESO Asigna28; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 1; |O FSalida = 2; |ACABA; |FINSI;
     |SI #28#14 = 0;
          |ABRE #200;
          #200#0 = #28#0;
          #200#33 = #28#2;
          |LEE 000#200=;
          |SI FSalida ! 0;
               aAlfa = "0000NNo existe referencia." + &13+&13 + "¿Es una devolucion?";
               |CONFI aAlfa;
               |SI FSalida ! 0;
                    |ERROR; |ACABA;
               |SINO;
                    |C_M #28#3, 1, "S";
                    |C_M #28#5, 1, "S";
                    |C_M #28#6, 1, "S";
                    |C_M #28#8, 1, "S";
                    |C_M #28#9, 1, "S";
                    |C_M #28#12, 1, "S";
                    |C_M #28#13, 1, "S";
                    |C_M #28#20, 1, "S";
                    |C_M #28#21, 1, "S";
                    |C_M #28#18, 1, "S";
                    |C_M #28#19, 1, "S";
                    |C_M #28#22, 1, "S";
                    |C_M #28#23, 1, "S";
                    |C_M #28#24, 1, "S";
                    |ACABA;
               |FINSI;
          |FINSI;
          |CIERRA #200;
          #28#3 = #200#7; |PINTA #28#3;
          #28#4 = #200#8; |PINTA #28#4;
          #28#8 = #200#21; |PINTA #28#8;
          #28#9 = #200#22; |PINTA #28#9;
          |BUCLE BusRegSaniPed;
          |C_M #28#5, 1, "S";
          |C_M #28#6, 1, "S";
          |C_M #28#8, 1, "S";
          |C_M #28#9, 1, "S";
          |C_M #28#12, 1, "S";
          |C_M #28#13, 1, "S";
          |C_M #28#20, 1, "S";
          |C_M #28#21, 1, "S";
          |C_M #28#18, 1, "S";
          |C_M #28#19, 1, "S";
          |C_M #28#22, 1, "S";
          |C_M #28#23, 1, "S";
          |C_M #28#24, 1, "S";
          |ACABA;
     |FINSI;

     |ABRE #7;
     #7#0 = #28#0;
     #7#19 = #28#14;
     |LEE 000#7=;
     |SI FSalida ! 0;
          |MENAV "0000No existe pedido de ventas...";
          |ERROR;
     |SINO;
          aponer = Asino;
          |HAZ poncontrV;
          nLinea = #28#2;
          nHay = 0;
          nPrime = 0;
          |SI #28#15 = 0;
               |BUCLE SirvePedVta;
               |SI nHay = 0;
                    |MENAV "0000No quedan lineas pendientes de asignar...";
                    |ERROR;
               |SINO;
                    aSirviendo = "S";
                    |PTEC 815;
               |FINSI;
          |SINO;
               |ABRE #26;
               #26#0 = #28#0;
               #26#1 = #28#14;
               #26#2 = #28#15;
               |LEE 101#26=;
               |SI FSalida ! 0;
                    |MENAV "0000No existe linea de pedido de ventas...";
                    |ERROR;
               |SINO;
                    |HAZ SirvePedVta;
                    |SI nHay = 0;
                         |MENAV "0000Linea pedido de ventas servida...";
                         |ERROR;
                    |SINO;
                         aSirviendo = "S";
                         |PTEC 815;
                    |FINSI;
               |FINSI;
               |CIERRA #26;
          |FINSI;

          aponer = Anosi;
          |HAZ poncontrV;
     |FINSI;
     |CIERRA #7;
|FPRC;

---------------------------------------------- bogew011
|PROCESO Tipo56_11; |TIPO 11;
     |SI FSalida ! 1; |Y FSalida ! 7; |Y FSalida ! 0;
               |Y FSalida ! 2; |Y FSalida ! 3;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tipo56_0; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     nTecla = FSalida;
     |DDEFECTO #27;
     #27#0 = #56#0;
     #27#19 = #56#1;
     |LEE 000#27=;
     |SI FSalida ! 0; |Y nTecla = 0;
          aNueva = "S";
          |HAZ AlbVta0;
          |SI aNueva = ""; |ERROR; |FINSI;
     |SINO;
          aNueva = "N";
          |HAZ AlbVta0;
          |PTEC 809;     || Abajo
          |ERROR;
          |PONCONTROL 23, "SI";
     |FINSI;
|FPRC;
----------------------------------------------
|PROCESO PonBoton;
     aEstado = "SHOW";
     |HAZ EstadoBoton;
|FPRC;

|PROCESO QuitaBoton;
     aEstado = "HIDE";
     |HAZ EstadoBoton;
|FPRC;

|PROCESO EstadoBoton;
     |ESTADO_CONTROL  nBoton2, aEstado;
     |ESTADO_CONTROL  nBoton3, aEstado;
     |ESTADO_CONTROL  nBoton4, aEstado;
     |ESTADO_CONTROL  nBoton5, aEstado;
     |ESTADO_CONTROL  nBoton6, aEstado;
     |ESTADO_CONTROL  nBoton7, aEstado;
     |ESTADO_CONTROL  nBoton8, aEstado;
     |ESTADO_CONTROL  nBoton9, aEstado;
     |ESTADO_CONTROL  nBoton10, aEstado;
|FPRC;

|PROCESO Transporte0;
     |ABRE #112;
     #112#0 = eaTransporte;
     |LEE 000#112=;
     |SI FSalida ! 0;
          |MENAV "0000No existe proveedor...";
          |ERROR;
     |SINO;
          |SI #112#42 ! "T "; |Y #112#42 ! "AT";
               |MENAV "0000No pertenece al Grupo 'T ' ó 'AT'";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #112;
|FPRC;

|PROCESO Transporte66;
     |HAZ CreaTempo;
     |DDEF aDef;
     aAlfa = aDef + "agifa112";
     |CARGA_DEF aAlfa, agifa112@;
     |SI FSalida = 0;
          |NOME_DAT #agifa112@#Tempo#;
          |DELINDEX #agifa112@;
          aAlfa = "|NC";
          aCampos = #112#aAlfa#;
          |ABRE #agifa112@;
          |ABRE #112;
          |LEE 000#112p;
          |PARA; |SI FSalida = 0; |HACIENDO;
               |SI #112#42 = "T "; |O #112#42 = "AT";
                    |PARA i = 0; |SI i < aCampos; |HACIENDO i = i + 1;
                         #agifa112@#i# = #112i;
                    |SIGUE;
                    |GRABA 020#agifa112@.n;
               |FINSI;
               |LEE 000#112s;
          |SIGUE;
          #agifa112@#0 = eaTransporte;
          |LEE 000#agifa112@.];
          |CONSULTA_CLAVE #1#agifa112@;
          |SI FSalida = 0;
               eaTransporte = #agifa112@#0;
          |SINO;
               eaTransporte = "";
          |FINSI;
          |CIERRA #112;
          |DELINDEX #agifa112@;
          |DESCARGA_DEF #agifa112@;
     |FINSI;
     |HAZ BoraTempo;
|FPRC;

|RUTINA poncontrV;
     fiac = Control % A109;
     fiac = fiac + relleno;
     guarda = fiac % A109;
     fiac = Control % A1001;
     Control = Control + fiac;
     Control = Control + relleno;
     Control = Control % A120;
     Control = Control + aponer;
|FRUT;

-----------
|PROCESO TmpConEntregaLin;
     |SI nPrimeLin = 0; nPrimeLin = #10#2; |FINSI;
     nNume = #10#6 - #10#12;
     |SI nNume > 0;
          |DDEFECTO #59;
          |PARA i = 0; |SI i [ 12; |HACIENDO i = i + 1;
               #59i = #10i;
          |SIGUE;
          #59#6 = nNume;
          #59#14 = #9#35;
          #59#15 = #10#14;
          #59#16 = #10#15;
          #59#17 = #10#16;
          |GRABA 020@#59n;
          nHay = 1;
     |FINSI;
|FPRC;

|PROCESO InTmpEntrega;
     nPrimeLin = 0;
     nPrimeRec = 0;
|FPRC;

|DEFBUCLE TmpConEntregaLin;
     #10#1;
     ;
     #9#0, #9#25, 001;
     #9#0, #9#25, 999;
     ;
     NULL, TmpConEntregaLin;
|FIN;

|PROCESO TmpConEntrega;
     |SI nPrimeRec = 0; nPrimeRec = #9#25; |FINSI;
     nHay = 0;
     |BUCLE TmpConEntregaLin;
     |SI nHay ! 0;
          |DDEFECTO #55;
          |PARA i = 0; |SI i [ 31; |HACIENDO i = i + 1;
               #55i = #9i;
          |SIGUE;
          |GRABA 020#55n;
          nHayReg = 1;
     |FINSI;
|FPRC;

|DEFBUCLE TmpConEntrega;
     #9#1;
     ;
     #60#0, 000001;
     #60#0, 999999;
     ;
     InTmpEntrega, TmpConEntrega;
|FIN;

|PROCESO Min55;
     #55#0 = #60#0;
     #55#25 = 1;
|FPRC;

|PROCESO Max55;
     #55#0 = #60#0;
     #55#25 = 999;
|FPRC;

|PROCESO EligeEntrega;
     enEntrega = 0;
     |PUSHV 0501 2380;

     |ABRE #9;
     #9#0 = #60#0;
     #9#25 = 0;
     |LEE 000#9];
     |SI FSalida = 0; |Y #9#0 = #60#0;
          |ABRE #55;
          |ABRE #59;
          nHayReg = 0;
          |BUCLE TmpConEntrega;
          |CIERRA #59;
          |CIERRA #55;

          |SI nHayReg = 0;
               |MENAV "0000No quedan confirmaciones pendientes de asignar...";
               aNueva = "";
          |SINO;
               |ENTLINEAL #1#55, 2, 4, 22, 1, Min55, Max55;
          |FINSI;

     |SINO;
          |MENAV "0000No existen confirmaciones de entrega";
     |FINSI;
     |CIERRA #9;
     |POPV;
|FPRC;

---------------------------------------------- bogew020
|PROCESO Transporte20_0; |TIPO 0;
     eaTransporte = #20#5;
     |HAZ Transporte0;
|FPRC;

|PROCESO Transporte20_66; |TIPO 66;
     eaTransporte = #20#5;
     |HAZ Transporte66;
     |SI eaTransporte = "";
          |ERROR;
     |SINO;
          #20#5 = eaTransporte;
          |PINTA #20#5;
     |FINSI;
|FPRC;

|PROCESO Mind7;
     #7#0 = #20#0;
     #7#19 = 1;
|FPRC;

|PROCESO Maxd7;
     #7#0 = #20#0;
     #7#19 = 999;
|FPRC;

|PROCESO Consulta20; |TIPO 66;
     |ABRE #7;
     #7#0 = #20#0;
     #7#19 = #20#35;
     |LEE 000#7];
     |CONSULTA_F_CLAVE #1#7, Mind7, Maxd7;
     |SI FSalida = 0;
          #20#35 = #7#19; |PINTA #20#35;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #7;
|FPRC;

|PROCESO CheqPenPedVta20;
     |SI #26#15 < #26#5;
          nPend = 1;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE CheqPenPedVta20;
     #26#1;
     ;
     #20#0, #20#35, 000;
     #20#0, #20#35, 999;
     ;
     NULL, CheqPenPedVta20;
|FIN;

|PROCESO Defecto20; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 1; |ACABA; |FINSI;

     nPend = 0;
     |BUCLE CheqPenPedVta20;
     |SI nPend = 0;
          |MENAV "0000No quedan unidades pendientes de asignar...";
          |ERROR; |ACABA;
     |FINSI;

     |ABRE #7;
     #7#0 = #20#0;
     #7#19 = #20#35;
     |LEE 000#7=;
     |SI FSalida = 0;
          #20#2 = #7#2; |PINTA #20#2;
          #20#3 = #7#3; |PINTA #20#3;
          #20#5 = #7#5; |PINTA #20#5;
          #20#6 = #7#6; |PINTA #20#6;
          #20#7 = #7#12; |PINTA #20#7;
          #20#26 = #7#16; |PINTA #20#26;
     |SINO;
          |MENAV "0000No existe pedido ventas...";
          |ERROR;
     |FINSI;
     |CIERRA #7;
|FPRC;

|PROCESO Mina21;
     #21#0 = 1;
|FPRC;

|PROCESO Maxa21;
     #21#0 = 999;
|FPRC;

|PROCESO UltEntrega;
     #9#0 = #20#0;
     #9#25 = 999999;
     |LEE 000#9];
     |SI FSalida = 0;
          |LEE 000#9a;
     |SINO;
          |LEE 000#9u;
     |FINSI;
     |SI FSalida = 0; |Y #9#0 = #20#0;
          nUltNumero = #9#25 + 1;
     |SINO;
          nUltNumero = 1;
     |FINSI;
     |DDEFECTO #9;
     #9#0 = #20#0;
     #9#25 = nUltNumero;
     |GRABA 020#9b;
|FPRC;

|PROCESO Llena21;
     |DDEFECTO #19;
     #19#0 = #26#3;
     |LEE 000#19=;

     |DDEFECTO #600;
     #600#0 = #19#2;
     |LEE 000#600=;

     |DDEFECTO #21;
     #21#0 = #26#2;
     #21#1 = #600#0;
     #21#2 = #600#1;
     #21#3 = #26#3;
     #21#4 = #26#4;
     #21#5 = #26#8;
     #21#6 = #26#9;
     #21#7 = #26#10;
     #21#8 = #26#11;
     #21#9 = #26#12;
     #21#10 = #26#13;
     #21#15 = #26#16;
     #21#16 = #26#17;
     |HAZ UltEntrega;
     #21#17 = #9#25;
     |GRABA 020#21n;

     #9#1 = #20#1;
     #9#2 = #20#2;
     #9#3 = #20#3;
     #9#4 = #20#4;
     #9#5 = #20#5;
     #9#6 = #20#6;
     #9#7 = #20#7;
     #9#8 = #20#8;
     #9#9 = #20#9;
     #9#10 = #20#10;
     #9#11 = #20#11;
     #9#12 = #20#12;
     #9#13 = #21#1;
     #9#14 = #21#2;
     #9#15 = #21#3;
     #9#16 = #21#4;
     #9#19 = #21#5;
     #9#20 = #21#6;
     #9#21 = #21#7;
     #9#22 = #21#8;
     #9#23 = #21#9;
     #9#24 = #21#10;
     #9#26 = #20#26;
     #9#27 = #20#27;
     #9#28 = #20#28;
     #9#29 = #20#29;
     #9#30 = #20#30;
     #9#31 = #20#31;
     #9#35 = #20#35;
     #9#36 = #21#0;
     #9#37 = #20#37;
     |GRABA 020#9a;
     |LIBERA #9;
|FPRC;

|DEFBUCLE Llena21;
     #26#1;
     ;
     #20#0, #20#35, 001;
     #20#0, #20#35, 999;
     ;
     NULL, Llena21;
|FIN;

|PROCESO AdjConEnt;
     |HAZ CreaTempo; aTmp21 = Tempo;
     |HAZ CreaTempo; aTmp22 = Tempo;
     |NOME_DAT #21 aTmp21;
     |NOME_DAT #22 aTmp22;
     |DELINDEX #21;
     |DELINDEX #22;

     |PUSHV 0501 2380;

     #20#0 = #60#0;

     |PINPA #0#20;
     |PINDA #0#20;
     |ENTLINEAL #1#21, 1, 7, 22, 0, Mina21, Maxa21;
     |ENDATOS #1#20;
     |SI FSalida = 0;
          |ABRE #19;
          |ABRE #600;
          |ABRE #9;
          |ABRE #21;
          |BUCLE Llena21;
          |CIERRA #21;
          |CIERRA #600;
          |CIERRA #19;
          |ABRE #10;
          |ENTLINEAL #1#21, 1, 4, 22, 0, Mina21, Maxa21;
          |CIERRA #9;
          |CIERRA #10;
     |FINSI;

     |POPV;
     Tempo = aTmp21; |HAZ BoraTempo;
     Tempo = aTmp22; |HAZ BoraTempo;
     |DELINDEX #21;
     |DELINDEX #22;
|FPRC;

|PROCESO Min22;
     #22#0 = #21#0;
     #22#1 = 1;
|FPRC;

|PROCESO Max22;
     #22#0 = #21#0;
     #22#1 = 999;
|FPRC;

---------------------------------------------- bogew021
|PROCESO Tipo21_0; |TIPO 0;
     |SI FSalida = 0; |Y #21Campo = Contenido;
          |PUSHV 0501 2380;
          |ENTLINEAL #1#22, 2, 1, 22, 1, Min22, Max22;
          |POPV;
     |FINSI;
|FPRC;
---------------------------------------------- bogew022
|PROCESO Palet22_0; |TIPO 0;
     |SI #10#3 ! Contenido;
          |ABRE #16;
          |SELECT #2#16;
          #16#17 = #20#28;
          #16#3 = #22#2;
          |LEE 000#16=;
          |SI FSalida = 0;
               #22#3 = #16#4; |PINTA #22#3;
               #22#9 = #16#11; |PINTA #22#9;
               #22#10 = #16#12; |PINTA #22#10;
               #22#11 = #16#13; |PINTA #22#11;
               #22#4 = #16#5; |PINTA #22#4;
               #22#5 = #16#6 - #16#15; |PINTA #22#5;
          |SINO;
               |ABRE #6;
               |SELECT #3#6;
               #6#3 = #22#2;
               |LEE 000#6=;
               |SI FSalida = 0;
                    #22#3 = #6#4; |PINTA #22#3;
                    #22#9 = #6#14; |PINTA #22#9;
                    #22#10 = #6#15; |PINTA #22#10;
                    #22#11 = #6#16; |PINTA #22#11;
                    #22#4 = #6#5; |PINTA #22#4;
                    #22#5 = #6#6; |PINTA #22#5;
               |SINO;
                    |MENAV "0000El palet no existe...";
               |FINSI;
               |CIERRA #6;
          |FINSI;
          |CIERRA #16;
          |HAZ Total22;
     |FINSI;
|FPRC;

|PROCESO LlenaTmpConRec1;
     |PARA i = 0; |SI i [ 16; |HACIENDO i = i + 1;
          #bogem006@#i# = #6i;
     |SIGUE;
     |GRABA 020#bogem006@.n;
|FPRC;

|DEFBUCLE LlenaTmpConRec1;
     #6#1;
     ;
     #20#0, 001, 001;
     #20#0, 999, 999;
     ;
     NULL, LlenaTmpConRec1;
|FIN;

|PROCESO Consulta22; |TIPO 0;
     |SI FSalida = 13;   || F5
          |DDEF aAlfa;
          aAlfa = aAlfa + "bogem006";
          |CARGA_DEF aAlfa, bogem006@;
          |SI FSalida = 0;
               |HAZ CreaTempo; aTmp6 = Tempo; |NOME_DAT #bogem006@#Tempo#;
               |DELINDEX #bogem006@;
               |ABRE #bogem006@;
               |BUCLE LlenaTmpConRec1;
               |LEE 000#bogem006@.p;
               |CONSULTA_CLAVE #1#bogem006@;
               |SI FSalida = 0;
                    #22#2 = #bogem006@#3; |PINTA #22#2;
                    #22#3 = #bogem006@#4; |PINTA #22#3;
                    #22#4 = #bogem006@#5; |PINTA #22#4;
                    #22#5 = #bogem006@#6; |PINTA #22#5;
                    #22#6 = #bogem006@#7; |PINTA #22#6;
                    #22#7 = #bogem006@#8; |PINTA #22#7;
                    #22#8 = #bogem006@#9; |PINTA #22#8;
                    #22#9 = #bogem006@#14; |PINTA #22#9;
                    #22#10 = #bogem006@#15; |PINTA #22#10;
                    #22#11 = #bogem006@#16; |PINTA #22#11;
               |SINO;
                    |ERROR;
               |FINSI;
               |CIERRA #bogem006@;
               Tempo = aTmp6; |HAZ BoraTempo;
               |DELINDEX #bogem006@;
               |DESCARGA_DEF #bogem006@;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo22_7; |TIPO 7;
     #22#12 = #21#3; |PINTA #22#12;
     #22#13 = #21#4; |PINTA #22#13;
|FPRC;

|PROCESO Tipo22_0; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          aAlfa = (("000000" + #20#0) % -106) + (("000000" + #21#17) % -102) + (("000" + #22#1) % -102)
          #22#2 = aAlfa; |PINTA #22#2;
          |ABRE #26;
          #26#0 = #20#0;  ||Refe
          #26#1 = #20#35; ||Pedido
          #26#2 = #21#0; ||subr
          |LEE 121#26=;
          |SI FSalida = 0;
               #22#5 = #26#5 - #26#15; |PINTA #22#5;
               #22#6 = #26#6; |PINTA #22#6;
          |FINSI;
          |CIERRA #26;
     |FINSI;
|FPRC;

|PROCESO Tipo22_2; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;

     #9#0 = #20#0;
     #9#1 = #21#17;
     |LEE 121#9=;

     |DDEFECTO #10;
     #10#0 = #20#0;
     #10#1 = #21#17;
     #10#2 = #22#1;
     |LEE 101#10=;
     |SI FSalida ! 0; |GRABA 020#10b; |FINSI;

     #10#3 = #22#2;
     #10#4 = #22#3;
     #10#5 = #22#4;
     #10#6 = #22#5;
     #10#7 = #22#6;
     #10#8 = #22#7;
     #10#9 = #22#8;

     #10#14 = #22#9;
     #10#15 = #22#10;
     #10#16 = #22#11;

     #9#32 = #9#32 +. #10#6;
     #9#33 = #9#33 +. #10#8;
     #9#34 = #9#34 +. #10#9;

     #10#9 = #9#27 / #10#6;

     |SI nModo = 3;
          |BORRA 020#10c;
     |SINO;
          |GRABA 020#10a;
     |FINSI;
     |LIBERA #10;

     |GRABA 020#9a;
     |LIBERA #9;

     |ABRE #26;
     #26#0 = #20#0;  ||Refe
     #26#1 = #20#35; ||Pedido
     #26#2 = #21#0; ||subr
     |LEE 121#26=;
     |SI FSalida = 0;
          #26#15 = #26#15 +. #22#5;
          |GRABA 020#26a;
     |FINSI;
     |CIERRA #26;
|FPRC;

|PROCESO Total22; |TIPO 0;
     #22#7 = #22#6 * #22#5; |PINTA #22#7;
|FPRC;

|PROCESO CheqUni22; |TIPO 0;
     |ABRE #26;
     #26#0 = #20#0;  ||Refe
     #26#1 = #20#35; ||Pedido
     #26#2 = #21#0; ||subr
     |LEE 121#26=;
     |SI FSalida = 0;
          #26#15 = #26#15 + #22#5;
          |SI #26#15 > #26#5;
               nNume = #26#15 - #26#5;
               aAlfa = "0000Se superan las unidades pedidas en: " + nNume;
               |MENAV aAlfa;
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #26;
|FPRC;
