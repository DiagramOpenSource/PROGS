|FICHEROS;
     aparm016 #0;
     agifm006 #6;
|FIN;

|VARIABLES;
     &enModoCab10 = 0;
     &enError = 0;
     aAlfa = "";
     nUlt = 0;
     aSer = "";
     aNum = "";
     aCli = "";
     aBaja = "";
     nEntra = 0;
     nSale = 0;
     nTiempo = 0;
     nMinu = 0;
     nHora = 0;
|FIN;

|PROCESO Contacto;
     aAlfa = "agifm006;ALTA" + #0#2 + (("000" + nUlt)% -103);
     |SUB_EJECUTA_NP aAlfa;
     |SI enError = 0;
          #0#3 = nUlt; |PINTA #0#3;
     |FINSI;
|FPRC;

|PROCESO Min;
     #6#0 = #0#2;
     #6#1 = 001;
|FPRC;

|PROCESO Max;
     #6#0 = #0#2;
     #6#1 = 999;
|FPRC;

|PROCESO Contacto66; |TIPO 66;
     |ABRE #6;
     #6#0 = #0#2;
     #6#1 = #0#3;
     |LEE 000#6];
     |CONSULTA_F_CLAVE #1#6, Min, Max;
     |SI FSalida = 0;
          #0#3 = #6#1; |PINTA #0#3;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #6;
|FPRC;

|PROCESO Contacto0; |TIPO 0;
     |ABRE #6;
     #6#0 = #0#2;
     #6#1 = #0#3;
     |LEE 020#6=;
     |SI FSalida = 0;
          #0#4 = #6#3; |PINTA #0#4;
          #0#5 = #6#9; |PINTA #0#5;
     |FINSI;
     |CIERRA #6;
|FPRC;

|PROCESO Contacto6; |TIPO 6;
     |SI FSalida = 12;
          |ABRE #6;
          #6#0 = #0#2;
          #6#1 = 999;
          |LEE 000#6];
          |SI FSalida = 0;
               |LEE 000#6a;
          |SINO;
               |LEE 000#6u;
          |FINSI;
          |SI FSalida = 0; |Y #6#0 = #0#2;
               nUlt = #6#1 + 1;
          |SINO;
               nUlt = 1;
          |FINSI;
          |PUSHV 05012380;
          |HAZ Contacto;
          |POPV;
          |CIERRA #6;
          |SI enError = 0;
               |PINTA #0#3;
          |SINO;
               |ERROR;
          |FINSI;
     |SINO;
          |ABRE #6;
          #6#0 = #0#2;
          #6#1 = #0#3;
          |LEE 000#6=;
          |SI FSalida ! 0;
               |PUSHV 0501 2380;
               nUlt = #0#3;
               |PINPA #0#6;
               |PINDA #0#6;
               |CONFI "0000SDesea dar de alta S/N.:";
               |SI FSalida = 0;
                    |HAZ Contacto;
               |SINO;
                    |ERROR;
               |FINSI;
               |POPV;
          |FINSI;
          |CIERRA #6;
     |FINSI;
|FPRC;

|PROGRAMA;
     |SI PARAMETRO = "menu";
          |ABRE #0;
          |CONSULTA_CLAVE #1#0;
          |CIERRA #0;
     |SINO;
          |BLIN 24;
          aSer = PARAMETRO % 105;
          aNum = PARAMETRO % 606;
          aCli = PARAMETRO % 1206;
          aBaja = PARAMETRO % 1804;
          |ABRE #0;
          #0#0 = aSer;
          #0#1 = aNum;
          |LEE 101#0=;
          |SI aBaja = "BAJA";
               |SI FSalida = 0; |BORRA 020#0a; |FINSI;
          |SINO;
               |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
               #0#2 = aCli;
               |PINPA #0#0;
               |PINDA #0#0;
               |SI enModoCab10 = 1;
                    |ENDATOS #1#0;
                    |SI FSalida = 0; |GRABA 020#0a; |FINSI;
               |SINO;
                    |SI enModoCab10 = 2;
                         |ENDATOS #2#0;
                         |SI FSalida = 0; |GRABA 020#0a; |FINSI;
                    |SINO;
                         |PAUSA;
                    |FINSI;
               |FINSI;
          |FINSI;
          |CIERRA #0;
     |FINSI;
|FPRO;
