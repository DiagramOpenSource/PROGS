|FICHEROS;
     champi13 #0;
     champi04 #4;
     champi06 #6;
     agifa010 #10;
     champi12 #12;
     dsm00053 #53;
     agifa071 #71;
     champi15 #15;
|FIN;

|VARIABLES;
     aSwImpreLin = "";
     nSwCoimasa = 0;
     &enSwDA = 0;
     &eaChampiEmarInf = "";
     nSwChampiEmar = 0;
     aAlfa = "";
     nBulto = 0;
     sw = 0;
     desde = "                               ";
     hasta = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     informe = "";
     informe1 = "agifa013";
     etiq = 1;
     nombre = "";
     &num_eti = 0;
     &nombre1 = "";
     &direc1 = "";
     &pobla1 = "";
     &provi1 = "";
     &etiqueta1 = 0;
     &bultos1 = 0;
     &serie1 = "";
     &factura1 = 0;
     &fecha1 = @;
     &nombre2 = "";
     &direc2 = "";
     &pobla2 = "";
     &provi2 = "";
     &etiqueta2 = 0;
     &bultos2 = 0;
     &serie2 = "";
     &factura2 = 0;
     &fecha2 = @;

     &ser_alb     = "";
     &num_alb     = 0;
     &eaImpreEti = "";
     &enLinea = 0;
|FIN;

|PROCESO DesAmpli;
     aAlfa = #53#5; |QBF aAlfa;
     |SI aAlfa ! "";
          enSwDA = 1;
          |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE DesAmpli;
     #53#1;
     ;
     "A", #71#29, #71#0, #71#1, 0001;
     "A", #71#29, #71#0, #71#1, 9999;
     ;
     NULL, DesAmpli;
|FIN;

|CALCULO carga1;
     nombre = #10#29;
     |QBF nombre;
     |SI nombre = "";
          nombre1 = #10#4;
     |SINO;
          nombre1 = #10#29;
     |FINSI;
     direc1 = #10#30;
     pobla1 = #10#31;
     provi1 = #10#33;
     etiqueta1 = etiq;
     bultos1 = #10#2;
     factura1 = #10#0;
     fecha1 = #10#1;
|FCAL;

|CALCULO descarga1;
     nombre1 = "";
     direc1 = "";
     pobla1 = "";
     provi1 = "";
     etiqueta1 = 1;
     bultos1 = 0;
     serie1 = "";
     factura1 = 0;
|FCAL;

|PROCESO ChampEmarAlb;
     aAlfa = #71#2; |QBF aAlfa;
     |SI aAlfa = ""; |ACABA; |FINSI;

     #15#0 = #71#2;
     |LEE 000#15=;
     |SI FSalida ! 0; |DDEFECTO #15; |FINSI;

     #4#0 = #71#29;
     #4#1 = #71#0;
     #4#2 = #71#1;
     |LEE 000#4=;
     |SI FSalida ! 0; |DDEFECTO #4; |FINSI;

     #6#0 = #4#6;
     |LEE 000#6=;
     |SI FSalida ! 0; |DDEFECTO #6; |FINSI;

     #12#0 = #6#3;
     |LEE 000#12=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     informe = #12#2; |QBF informe;
     |SI informe = ""; |ACABA; |FINSI;

     |INFOR informe;
     |SI FSalida = 0;
          etiq = 1;
          |HAZ carga1;
          enSwDA = 0;
          |PRINT;
          |BUCLE DesAmpli;
          |PIEINF;
          |FININF;
          |HAZ descarga1;
     |SINO;
          aAlfa = "0000Error en informe '" + informe + "' ...";
          |MENAV aAlfa;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE ChampEmarAlb;
     #10#3;
     43;
     #0#0 , #0#4 , #0#6 , #0#2, "N";
     #0#1 , #0#5 , #0#7 , #0#3, "N";
     ;
     NULL, NULL, ChampEmarAlb;
|FIN;

|CALCULO Tipo3;  |TIPO 3;
     |ABRE #4;
     |ABRE #6;
     |ABRE #12;
     |ABRE #15;

     |SI eaImpreEti = "";
          |IMPRE 1;
     |SINO;
          Impresora = eaImpreEti;
          |IMPRE -1;
     |FINSI;
     |SI FSalida = 0;
          |BUCLE ChampEmarAlb;
          |FINIMP;
     |FINSI;

     |CIERRA #15;
     |CIERRA #12;
     |CIERRA #6;
     |CIERRA #4;
|FCAL;

|PROGRAMA;
     |HAZ SacaIVA;
     |HAZ MiraLogos; || Copia Logos para el Crystal

     |SI ser_alb = ""; |Y num_alb = 0;
         |CLS;
         |CABEZA "Emitir Etiquetas Agencia";
         |PINPA #0#0;
         |PINDA #0#0;
         |ENDATOS #1#0;
         |SI FSalida = 0;  |HAZ Tipo3;  |FINSI;
     |SINO;
         |DDEFECTO #0;
         #0#6  = ser_alb;
         #0#7  = ser_alb;
         #0#2  = num_alb;
         #0#3  = num_alb;
         #0#4 = "01.01.0000";
         #0#5 = "31.12.9999";
         |HAZ Tipo3;
     |FINSI;
|FPRO;
