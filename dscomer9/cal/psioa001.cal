|FICHEROS;
     psioa001 #0;   || Este def.
     psioa035 #35,MANTE;
     psioa032 #32;
     psioa060 #60;
|FIN;

|VARIABLES;
     nSwCoimasa = 1;
     nSal = 0;
     &eaArticulo = "";
     aRuta = "";
     aAlfa = "";
     aMsg = "";
     aLon = "";
     aCar = "";
     aPath = "";
     aBarra = "";
     nPos = 0;
     i = 0;
     nModo = 0;
     nForma = 0;
|FIN;

|PROCESO T80; |TIPO 80;
     FSalida = 3199;
|FPRC;

|PROCESO hacecli; |TIPO 0;
     |SI #0#1 = "N";
          |CAMPO_MODIFICA #0#2, 1, "N";
          |CAMPO_MODIFICA #0#3, 1, "N";
          |CAMPO_MODIFICA #0#4, 1, "N";
          |CAMPO_MODIFICA #0#5, 1, "N";
          |CAMPO_MODIFICA #0#31, 1, "N";
          |CAMPO_MODIFICA #0#32, 1, "N";
          |CAMPO_MODIFICA #0#33, 1, "N";
          |CAMPO_MODIFICA #0#34, 1, "N";
          |CAMPO_MODIFICA #0#39, 1, "N";
          |CAMPO_MODIFICA #0#40, 1, "N";
          |CAMPO_MODIFICA #0#51, 1, "N";
          |CAMPO_MODIFICA #0#52, 1, "N";
     |SINO;
          |CAMPO_MODIFICA #0#2, 1, "S";
          |CAMPO_MODIFICA #0#3, 1, "S";
          |CAMPO_MODIFICA #0#4, 1, "S";
          |CAMPO_MODIFICA #0#5, 1, "S";
          |CAMPO_MODIFICA #0#31, 1, "S";
          |CAMPO_MODIFICA #0#32, 1, "S";
          |CAMPO_MODIFICA #0#33, 1, "S";
          |CAMPO_MODIFICA #0#34, 1, "S";
          |CAMPO_MODIFICA #0#39, 1, "S";
          |CAMPO_MODIFICA #0#40, 1, "S";
          |CAMPO_MODIFICA #0#51, 1, "S";
          |CAMPO_MODIFICA #0#52, 1, "S";
     |FINSI;
|FPRC;

|PROCESO haceart; |TIPO 0;
     |SI FSalida = 13; |Y Campo = 6;
          |SI #0#59 = 3;
               |MENAV "0000Opcion no permitida para tablet...";
               |ERROR;
          |SINO;
               |HAZ EditaCampoArt;
          |FINSI;
     |FINSI;
     |SI #0#6 = "N";
          |CAMPO_MODIFICA #0#7,  1, "N";
          |CAMPO_MODIFICA #0#8,  1, "N";
          |CAMPO_MODIFICA #0#9,  1, "N";
          |CAMPO_MODIFICA #0#10, 1, "N";
          |CAMPO_MODIFICA #0#27, 1, "N";
          |CAMPO_MODIFICA #0#36, 1, "N";
          |CAMPO_MODIFICA #0#37, 1, "N";
     |SINO;
          |CAMPO_MODIFICA #0#7,  1, "S";
          |CAMPO_MODIFICA #0#8,  1, "S";
          |CAMPO_MODIFICA #0#9,  1, "S";
          |CAMPO_MODIFICA #0#10, 1, "S";
          |CAMPO_MODIFICA #0#27, 1, "S";
          |CAMPO_MODIFICA #0#36, 1, "S";
          |CAMPO_MODIFICA #0#37, 1, "S";
     |FINSI;
|FPRC;

|PROCESO hacecont; |TIPO 0;
     |SI #0#11 = "N";
          |CAMPO_MODIFICA #0#12, 1, "N";
          |CAMPO_MODIFICA #0#13, 1, "N";
          |CAMPO_MODIFICA #0#14, 1, "N";
          |CAMPO_MODIFICA #0#15, 1, "N";
          |CAMPO_MODIFICA #0#16, 1, "N";
          |CAMPO_MODIFICA #0#17, 1, "N";
          |CAMPO_MODIFICA #0#18, 1, "N";
          |CAMPO_MODIFICA #0#19, 1, "N";
          |CAMPO_MODIFICA #0#23, 1, "N";
          |CAMPO_MODIFICA #0#24, 1, "N";
          |CAMPO_MODIFICA #0#25, 1, "N";
          |CAMPO_MODIFICA #0#26, 1, "N";
     |SINO;
          |CAMPO_MODIFICA #0#12, 1, "S";
          |CAMPO_MODIFICA #0#13, 1, "S";
          |CAMPO_MODIFICA #0#14, 1, "S";
          |CAMPO_MODIFICA #0#15, 1, "S";
          |CAMPO_MODIFICA #0#16, 1, "S";
          |CAMPO_MODIFICA #0#17, 1, "S";
          |CAMPO_MODIFICA #0#18, 1, "S";
          |CAMPO_MODIFICA #0#19, 1, "S";
          |CAMPO_MODIFICA #0#23, 1, "S";
          |CAMPO_MODIFICA #0#24, 1, "S";
          |CAMPO_MODIFICA #0#25, 1, "S";
          |CAMPO_MODIFICA #0#26, 1, "S";
     |FINSI;
|FPRC;

|PROCESO Llena001; |TIPO 6;
     eaArticulo = #0Campo;
     |HAZ LlenaArticulo;
     |SI FSalida = 0;
          #0Campo = eaArticulo;
          |PINTA #0Campo;
     |SINO;
          |ERROR; |ACABA;
     |FINSI;
|FPRC;

|PROCESO CreaDir; |TIPO 0;
     |SI FSalida = 10;
          |HAZ Browser;
          |ERROR; |ACABA;
     |FINSI;
     aAlfa = #0Campo; |QBF aAlfa;
     aBarra = aAlfa % -101;
     |SI aBarra ! "/"; |Y aBarra ! "\";
          aAlfa = aAlfa + "\";
          #0Campo = aAlfa;
     |FINSI;
     aPath = aAlfa;
     aMsg = "";
     aAlfa = "";
     aLon = aPath % A0;
     |PARA i = 1; |SI aAlfa ! aPath; |HACIENDO i = i + 1;
          |PARA; |SI i [ aLon; |HACIENDO i = i + 1;
               nPos = i * 100 + 1;
               aCar = aPath % nPos;
               aAlfa = aAlfa + aCar;
               |SI aCar = "/"; |O aCar = "\";
                    |SI i > 1; |SAL; |FINSI;
               |FINSI;
          |SIGUE;
          |SI #0#74 = "C"; |RMKDIR aAlfa; |SINO; |MKDIR aAlfa; |FINSI;
          |SI FSalida = 0;
               |SI #0#74 = "C"; |RRMDIR aAlfa; |SINO; |RMDIR aAlfa; |FINSI;
               aMsg = "0000No existe directorio: [" + aAlfa + "]";
               |MENAV aMsg;
               aMsg = "0000SCrear directorio: [" + aAlfa + "]";
               |CONFI aMsg;
               |SI FSalida = 0;
                    |SI #0#74 = "C"; |RMKDIR aAlfa; |SINO; |MKDIR aAlfa; |FINSI;
               |SINO;
                    |ERROR;|ACABA;
               |FINSI;
          |FINSI;
     |SIGUE;
     #0Campo = aAlfa;
     |PINTA #0Campo;
     |SI aMsg ! ""; |ERROR; |FINSI;
|FPRC;

|PROCESO Min;
     #35#0 = #0#0;
     #35#1 = "      ";
|FPRC;

|PROCESO Max;
     #35#0 = #0#0;
     #35#1 = "zzzzzz";
|FPRC;

|PROCESO CargaRutas;
     |DDEFECTO #35;
     #35#0 = #0#0;
     #35#1 = #32#0;
     |LEE 101#35=;
     |SI FSalida ! 0; |GRABA 020#35b; |FINSI;
     #35#2 = #32#1;
     |GRABA 020#35a;
     |LIBERA #35;
|FPRC;

|DEFBUCLE CargaRutas;
     #32#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, CargaRutas;
|FIN;

|PROCESO Rutas; |TIPO 0;
     |SI FSalida = 0; |Y #0Campo = "S";
          |PUSHV 0501 2380;
          |BLANCO 818 2354;
          |ABRE #35;
          |BUCLE CargaRutas;
          |CIERRA #35;
          |ENTLINEAL #1#35, 2, 4, 21, 1, Min, Max;
          |POPV;
     |FINSI;
|FPRC;

|PROCESO Tecla; |TIPO 0;
     |SI FSalida = 0; |Y #35#1 = Contenido;
          |SI #35#3 = " ";
               #35#3 = "*";
          |SINO;
               #35#3 = " ";
          |FINSI;
          |GRABA 000#35a;
          |PINTA #35#3;
     |FINSI;
|FPRC;

|PROCESO ModiCam; |TIPO 0;
     |SI #0#59 = 1;
          |C_M #0#61, 1, "N";
          |C_M #0#62, 1, "N";
          |C_M #0#67, 1, "N";
          #0#61 = "N"; |PINTA #0#61;
          #0#62 = "N"; |PINTA #0#62;
          #0#67 = "C"; |PINTA #0#67;
     |SINO;
          |C_M #0#61, 1, "S";
          |C_M #0#62, 1, "S";
          |C_M #0#67, 1, "S";
     |FINSI;
     |SI #0#59 = 3;
          |C_M #0#77, 1, "S";
     |SINO;
          |C_M #0#77, 1, "N";
     |FINSI;
|FPRC;

|PROCESO ModiParti; |TIPO 7;
     |C_M #0#60, 1, "N";
     |SI #0#59 ] 2; |O #0#58 = 30;
          |C_M #0#60, 1, "S";
     |FINSI;
|FPRC;

|PROCESO Browser;
     aRuta = "D" + #0Campo;
     |QBF aRuta;
     |BROWSE aRuta;

     aRuta = aRuta % 299;
     |QBF aRuta;
     |SI aRuta ! "";
          #0Campo = aRuta;
          |PINTA #0Campo;
     |FINSI;
|FPRC;

|PROCESO ModiPrv; |TIPO 0;
     aAlfa = #0#63;
     |C_M #0#64, 1, aAlfa;
     |C_M #0#65, 1, aAlfa;
|FPRC;

|PROCESO EditaCampoArt;
     |PUSHV 0101 2380;
     |BLANCO 606 2177;
     |DDEFECTO #60;
     |ABRE #60;
     #60#0 = #0#0;
     |LEE 000#60=;
     nSal = FSalida;
     |PINPA #0#60;
     |PINDA #0#60;
     |ENDATOS #1#60;
     |SI FSalida = 0
          |SI nSal = 0;
               |GRABA 020#60a;
          |SINO;
               |GRABA 020#60n;
          |FINSI;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO AyudaVta; |TIPO 0;
     aAlfa = #0#61;
     |C_M #0#69, 1, aAlfa;
|FPRC;

|PROCESO AlmaGeneral; |TIPO 7;
     |SI #0#60 = "N";
          |C_M #0#70, 1, "N";
     |SINO;
          |C_M #0#70, 1, "S";
     |FINSI;
|FPRC;

|PROCESO DesArti; |TIPO 7;
     |SI #0#59 ] 2;
          |C_M #0#72, 1, "N";
          #0#72 = "S"; |PINTA #0#72;
     |SINO;
          |C_M #0#72, 1, "S";
     |FINSI;
|FPRC;

|PROCESO Tipo20; |TIPO 20;
     |SI FSalida = "OPCION";
          |HAZ EsCoimasa; nSwCoimasa = FSalida;
          |SI nSwCoimasa = 0;
               FSalida = "Auxiliar";
          |SINO;
               FSalida = "";       || la estandar
          |FINSI;
     |SINO;
          |SI nSwCoimasa = 0;
               aAlfa = "coima046;" + #0#0 + "MODI";
               |SUB_EJECUTA_NP aAlfa;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo2; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     nForma = 0 +. 1;

     |SI nSwCoimasa = 0;
          |SI nModo = 3;
               aAlfa = "coima046;" + #0#0 + "BAJA";
               |SUB_EJECUTA_NP aAlfa;
          |FINSI;
          |SI nForma = 1;
               aAlfa = "coima046;" + #0#0 + "ALTA";
               |SUB_EJECUTA_NP aAlfa;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO ReciboPL; |TIPO 0;
     |SI #0#85 = "L";
          |C_M #0#86, 1 , "S";
          |C_M #0#87, 1 , "S";
          |C_M #0#88, 1 , "N";
          |C_M #0#90, 1 , "N";
          |C_M #0#89, 1 , "N";
          |C_M #0#91, 1 , "N";
          |C_M #0#92, 1 , "N";
          |C_M #0#93, 1 , "N";
          |C_M #0#94, 1 , "N";
          |C_M #0#95, 1 , "N";
          |C_M #0#96, 1 , "N";
          |C_M #0#97, 1 , "N";
     |SINO;
          |C_M #0#86, 1 , "N";
          |C_M #0#87, 1 , "N";
          |C_M #0#88, 1 , "S";
          |C_M #0#89, 1 , "S";
          |C_M #0#90, 1 , "S";
          |C_M #0#91, 1 , "S";
          |C_M #0#92, 1 , "S";
          |C_M #0#93, 1 , "S";
          |C_M #0#94, 1 , "S";
          |C_M #0#95, 1 , "S";
          |C_M #0#96, 1 , "S";
          |C_M #0#97, 1 , "S";
     |FINSI;
|FPRC;
