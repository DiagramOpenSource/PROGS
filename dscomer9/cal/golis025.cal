|FICHEROS;
     golis025 #0;

     goptrbca #100;      ||Partes Trabajad.(CA)
     goptrbli #101;      ||Partes Trabajad.(LI)

     agifa722 #722;      ||Historico Enlaces
     goparame #1000;     ||Parametros Obras
|FIN;

|VARIABLES;
     nExiste = 0;
     aMensaje = "";
     aInforme = "";
     nSwPie = 0;
     aAlfa = "";
|FIN;

|PROCESO Parilla; |TIPO 0;
     |SI #golis025#1 = "S";
          |C_M #golis025#2, 1, "N";
          |C_M #golis025#3, 1, "N";
          |C_M #golis025#5, 1, "S";
          |C_M #golis025#6, 1, "S";
          |C_M #golis025#7, 1, "S";
          |C_M #golis025#8, 1, "S";
          |C_M #golis025#9, 1, "S";
          |C_M #golis025#10, 1, "S";
          |C_M #golis025#11, 1, "S";
          |C_M #golis025#12, 1, "S";
          |C_M #golis025#13, 1, "S";
          |C_M #golis025#14, 1, "S";
          |C_M #golis025#15, 1, "S";
          |C_M #golis025#16, 1, "S";
          |C_M #golis025#17, 1, "S";
          |C_M #golis025#18, 1, "S";
          |C_M #golis025#19, 1, "S";
          |C_M #golis025#20, 1, "S";
          |C_M #golis025#21, 1, "S";
          |C_M #golis025#22, 1, "S";
          |C_M #golis025#23, 1, "S";
          |C_M #golis025#24, 1, "S";
          #golis025#2 = 1;
          #golis025#3 = 99;
     |SINO;
          |C_M #golis025#2, 1, "S";
          |C_M #golis025#3, 1, "S";
          |C_M #golis025#5, 1, "N";
          |C_M #golis025#6, 1, "N";
          |C_M #golis025#7, 1, "N";
          |C_M #golis025#8, 1, "N";
          |C_M #golis025#9, 1, "N";
          |C_M #golis025#10, 1, "N";
          |C_M #golis025#11, 1, "N";
          |C_M #golis025#12, 1, "N";
          |C_M #golis025#13, 1, "N";
          |C_M #golis025#14, 1, "N";
          |C_M #golis025#15, 1, "N";
          |C_M #golis025#16, 1, "N";
          |C_M #golis025#17, 1, "N";
          |C_M #golis025#18, 1, "N";
          |C_M #golis025#19, 1, "N";
          |C_M #golis025#20, 1, "N";
          |C_M #golis025#21, 1, "N";
          |C_M #golis025#22, 1, "N";
          |C_M #golis025#23, 1, "N";
          |C_M #golis025#24, 1, "N";
          #golis025#5 = 0;
          #golis025#6 = 0;
          #golis025#7 = 0;
          #golis025#8 = 0;
          #golis025#9 = 0;
          #golis025#10 = 0;
          #golis025#11 = 0;
          #golis025#12 = 0;
          #golis025#13 = 0;
          #golis025#14 = 0;
          #golis025#15 = 0;
          #golis025#16 = 0;
          #golis025#17 = 0;
          #golis025#18 = 0;
          #golis025#19 = 0;
          #golis025#20 = 0;
          #golis025#21 = 0;
          #golis025#22 = 0;
          #golis025#23 = 0;
          #golis025#24 = 0;
     |FINSI;
     |PINTA #golis025#2;
     |PINTA #golis025#3;
     |PINTA #golis025#5;
     |PINTA #golis025#6;
     |PINTA #golis025#7;
     |PINTA #golis025#8;
     |PINTA #golis025#9;
     |PINTA #golis025#10;
     |PINTA #golis025#11;
     |PINTA #golis025#12;
     |PINTA #golis025#13;
     |PINTA #golis025#14;
     |PINTA #golis025#15;
     |PINTA #golis025#16;
     |PINTA #golis025#17;
     |PINTA #golis025#18;
     |PINTA #golis025#19;
     |PINTA #golis025#20;
     |PINTA #golis025#21;
     |PINTA #golis025#22;
     |PINTA #golis025#23;
     |PINTA #golis025#24;
|FPRC;

|PROCESO LeeCabecera;
     |DDEFECTO #goptrbca;
     #goptrbca#0 = #goptrbli#0;
     #goptrbca#1 = #goptrbli#1;
     #goptrbca#2 = #goptrbli#2;
     #goptrbca#16 = #goptrbli#20;
     #goptrbca#17 = #goptrbli#21;
     |LEE 000#goptrbca.=;

     |DDEFECTO #agifa722;
     #agifa722#0 = "TR";
     #agifa722#1 = #goptrbli#20;
     aAlfa = (("000000" + #goptrbli#21) % -106) + (("000" + #goptrbli#3) % -103);
     #agifa722#2 = aAlfa;
     #agifa722#3 = #goptrbli#2;
     #agifa722#11 = 1;
     #agifa722#8 = #goparame#85;
     #agifa722#9 = #goparame#86;
     |LEE 000#agifa722.=;
     |SI FSalida ! 0;
          |DDEFECTO #agifa722;
          #agifa722#1 = "No tiene";
          #agifa722#2 = "Asiento";
          #agifa722#3 = "Contable";
     |FINSI;
|FPRC;

|PROCESO goptrbli;
     |SI #golis025#1 = "N";
          |SI #goptrbli#26 ] #golis025#2; |Y #goptrbli#26 [ #golis025#3;
               |HAZ LeeCabecera;
               |PRINT;
               nSwPie = 1;
          |FINSI;
     |SINO;
          |SI #goptrbli#26 ! 0;
               |SI #goptrbli#26 = #golis025#5;  |O #goptrbli#26 = #golis025#6;
                |O #goptrbli#26 = #golis025#7;  |O #goptrbli#26 = #golis025#8;
                |O #goptrbli#26 = #golis025#9;  |O #goptrbli#26 = #golis025#10;
                |O #goptrbli#26 = #golis025#11; |O #goptrbli#26 = #golis025#12;
                |O #goptrbli#26 = #golis025#13; |O #goptrbli#26 = #golis025#14;
                |O #goptrbli#26 = #golis025#15; |O #goptrbli#26 = #golis025#16;
                |O #goptrbli#26 = #golis025#17; |O #goptrbli#26 = #golis025#18;
                |O #goptrbli#26 = #golis025#19; |O #goptrbli#26 = #golis025#20;
                |O #goptrbli#26 = #golis025#21; |O #goptrbli#26 = #golis025#22;
                |O #goptrbli#26 = #golis025#23; |O #goptrbli#26 = #golis025#24;
                    |HAZ LeeCabecera;
                    |PRINT;
                    nSwPie = 1;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE goptrbli;
 #goptrbli#1;
 ;
 INICIO;
 FINAL;
 ;
 NULL, NULL, NULL, NULL, NULL, goptrbli;
 #goptrbli#26;
|FIN;

|PROCESO Principal;
     |IMPRE 0;
     |SI FSalida = 0;
          aInforme = "golis025";
          |INFOR aInforme;
          |SI FSalida = 0;
               |ABRE #goptrbca;
               |ABRE #agifa722;
               |BUCLE goptrbli;
               |CIERRA #agifa722;
               |CIERRA #goptrbca;
               |SI nSwPie = 1;
                    |PIEINF;
               |FINSI;
               |FININF;
          |SINO;
               aMensaje = "0000Informe " + aInforme + " inaccesible.";
               |MENAV aMensaje;
          |FINSI;
          |FINIMP;
     |SINO;
          |MENAV "0000Proceso cancelado.";
     |FINSI;
|FPRC;

|PROGRAMA;
     |ABRE #goparame;
     |LEE 000#goparame.p;
     |SI FSalida ! 0;
        |MENAV "    Parametros Obras no definidos";
        |CIERRA #goparame;
        |ACABA;
     |FINSI;
     |CIERRA #goparame;

     |CLS;
     |ABRE #0;
     |DDEFECTO #0;
     |LEE 101#0p;
     nExiste = FSalida;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |SI nExiste = 0;
               |GRABA 020#0a;
          |SINO;
               |GRABA 020#0n;
          |FINSI;
          |HAZ Principal;
     |FINSI;
     |LIBERA #0;
     |CIERRA #0;
|FPRO;
