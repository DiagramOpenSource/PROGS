|FICHEROS;
     infoz008 #0;
     infom000 #1;
     infoz003 #3;
     infoz004 #4;
|FIN;

|VARIABLES;
     aLon = "";
     nLon = 0;
     aFic = "";
     aPath = "";
     aPathOrg = "";
     aAlfa = "";
     aCar = "";
     aIzq = "";
     aDer = "";
     nPos = 0;
     nNume = 0;
     aOrg = "";
     aDes = "";
|FIN;

|PROCESO Mueve;
     aLon = aPathOrg % A0;
     nLon = aLon + 1;
     aFic = aFic % nLon;

     |PINTA 1504, "                                                  ";
     |PINTA 1504, aFic;

     ||saca la parte izq y der del "."
     aAlfa = aFic - ".";
     |SI FSalida > 0;
          aAlfa = (("0000" + FSalida) % -104) % 102;
          nPos = aAlfa;
          nLon = 100 + nPos - 1;
          aIzq = aFic % nLon;
          aDer = aFic % nPos;
     |SINO;
          aIzq = aFic;
          aDer = "";
     |FINSI;

     ||comprueba el 1§ caracter sea alfa
     aLon = aIzq % A0;
     aCar = aIzq % 101;
     aAlfa = aCar > "";
     aAlfa = "0123456789" - aAlfa;
     |SI FSalida > 0;
          nNume = aIzq;
          aCar = "";
     |SINO;
         aIzq = aIzq - aCar;
         nNume = aIzq;
     |FINSI;
     nNume = nNume - (nNume $ #1#22);
     aAlfa = aPathOrg + nNume;
     |MKDIR aAlfa;

     aDes = aPathOrg + nNume + "/" + aCar + aIzq + aDer;

     |RENOMBRA_FICHERO aPath, aDes;
|FPRC;

|PROCESO Copialo;
     |QBF aPathOrg;
     |SI aPathOrg = ""; |ACABA; |FINSI;

     aAlfa = aPathOrg % -101;
     |SI aAlfa ! "/"; |Y aAlfa ! "\"; aPathOrg = aPathOrg + "/"; |FINSI;

     aPath = aPathOrg;
     |_PDIR aPath;
     |PARA; |SI FSalida = 0; |HACIENDO;
          aFic = aPath;
          |HAZ Mueve;
          |_SDIR aPath;
     |SIGUE;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |SI #0#2 = "SI";
          aPathOrg = #0#0; |HAZ Copialo;
          aPathOrg = #0#1; |HAZ Copialo;
     |FINSI;
|FPRC;

|PROGRAMA;
     |ABRE #1; |LEE 000#1p; |CIERRA #1;
     |ABRE #3; |LEE 000#3p; |CIERRA #3;
     |ABRE #4; |LEE 000#4p; |CIERRA #4;
     #0#0 = #3#6;
     #0#1 = #4#6;
     |SI #1#21 = "S";
          |PINPA #0#0;
          |PINDA #0#0;
          |ENDATOS #1#0;
     |SINO;
          |MENAV "0000Parametros no definido como subcarpetas...";
     |FINSI;
|FPRO;
