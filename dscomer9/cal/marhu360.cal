|FICHEROS;
     marhu360 #0;
     agist001 #1;
     agist002 #2;
     agifa077 #77;
     agifa080 #80;
     marhu323 #323;
     marhu324 #324;
     agifa019 #19;
|FIN;

|VARIABLES;
     nLin = 0;
|FIN;

|PROCESO LeeIni;
     |ABRE #1;
     #1#0 = #0#4;
     |LEE 000#1=;
     |SI FSalida = 0;
          |MENAV "0000AVISO, Codigo Existente...";
     |FINSI;
     |CIERRA #1;
|FPRC;

|PROCESO UltLin;
     #2#0 = #1#0;
     #2#1 = 9999;
     |LEE 000#2];
     |SI FSalida = 0;
          |LEE 000#2a
     |SINO;
          |LEE 000#2u;
     |FINSI;
     |SI FSalida = 0; |Y #2#0 = #1#0;
          nLin = #2#1 + 1;
     |SINO;
          nLin = 1;
     |FINSI;
|FPRC;

|PROCESO LeeArti;
     #19#0 = #2#2;
     |LEE 000#19=;
     |SI FSalida ! 0; |DDEFECTO #19; |FINSI;
|FPRC;

|PROCESO marhu324;
     |HAZ UltLin;

     |DDEFECTO #2;
     #2#0 = #1#0;
     #2#1 = nLin;
     #2#2 = #324#2;
     #2#3 = #80#3;
     #2#4 = #80#5 * #324#4;
     |HAZ LeeArti;
     #2#5 = #19#9;
     #2#6 = #19#1;
     |GRABA 020#2n;
|FPRC;

|PROCESO agifa080;
     #323#0 = #80#2;
     |LEE 000#323=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |HAZ UltLin;

     |DDEFECTO #2;
     #2#0 = #1#0;
     #2#1 = nLin;
     #2#2 = #80#2;
     #2#3 = #80#3;
     #2#4 = -#80#5;
     |HAZ LeeArti;
     #2#5 = #19#9;
     #2#6 = #19#1;
     |GRABA 020#2n;
     |BUCLELIN 2 marhu324 #323;
|FPRC;

|DEFBUCLE agifa077;
     #77#1;
     ;
     #0#0, #0#2;
     #0#1, #0#3;
     ;
     NULL, NULL, agifa080;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |ABRE #1;
     |ABRE #2;
     |ABRE #323;
     |ABRE #19;

     #1#0 = #0#4;
     |LEE 101#1=;
     #1#1 = #0#5;
     |SI FSalida = 0;
          |GRABA 020#1a;
     |SINO;
          |GRABA 020#1n;
     |FINSI;

     |BUCLE agifa077;

     |CIERRA #19;
     |CIERRA #1;
     |CIERRA #2;
     |CIERRA #323;
|FPRC;
