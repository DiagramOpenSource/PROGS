|FICHEROS;
     agifa079 #1;
     dsz99984 #11;
     agifa177 #177;
     agifa091 #10;
|FIN;

|VARIABLES;
     &PRMNT_SerFac = "";
     &PRMNT_NumFac = 0;
     i = 0;
     nCamImp = 0;
     nNumRecibos = 0;
     nCamFec = 0;

|FIN;

|PROGRAMA;
     |ABRE #agifa079;

     #agifa079#66 = PRMNT_SerFac;
     #agifa079#0 = PRMNT_NumFac;
     |LEE 000#agifa079.=;
     |SI FSalida ! 0;
          |ACABA;
     |FINSI;

     |ABRE #10;
     #10#0 = #1#11;
     |LEE 000#10=;
     |SI 0 ! FSalida;
        |DDEFECTO #10;
     |FINSI;
     |CIERRA #10;

     |ABRE #11;
     |DDEFECTO #11;
     #11#0 = #1#0;
     #11#17 = #1#66;
     |PARA i = 1;|SI i [ 12; |HACIENDO i = i + 1;
          nCamImp = i + 32;
          |SI #1nCamImp ! 0; nNumRecibos = i; |FINSI;
     |SIGUE;
     |SI #1#146 ! 0; nNumRecibos = nNumRecibos + 1; |FINSI;

     |HAZ AbreRecCompra;
     |PARA i = 1;|SI i [ 12; |HACIENDO i = i + 1;
          nCamImp = i + 32;
          ||SI #1nCamImp = 0; |O i > 12; |ACABA; |FINSI;
          |SI #1nCamImp = 0; |O i > 12; |SAL; |FINSI;
          |SI i [ 6;
               nCamFec = i + 67;
          |SINO;
               nCamFec = i + 122;
          |FINSI;
          #11#7 = #1#1;
          #11#8 = #1nCamFec;
          #11#9 = #1nCamImp;
          #11#1 = i;
          #11#2 = #1#2;
          #11#3 = #1#3;
          #11#4 = #1#9;
          #11#12 = #1#12;
          #11#18 = #10#69;      ||Tipo de Recibo
          #11#21 = #10#69;
          #11#23 = nNumRecibos;
          #11#24 = #10#0;
          #11#25 = #10#1;

          |ABRE #177;
          #177#0 = #11#18;
          |LEE 000#177=;
          |CIERRA #177;

          #11#15 = #177#3;      ||Cuenta
          |HAZ RecCompra;
     |SIGUE;
     |SI #1#146 ! 0;
          #11#7 = #1#1;
          #11#8 = #1#147;
          #11#9 = #1#146;
          #11#1 = i;
          #11#2 = #1#2;
          #11#3 = #1#3;
          #11#4 = #1#9;
          #11#12 = #1#12;
          #11#18 = #10#73;      ||Tipo de Recibo
          #11#21 = #10#73;
          #11#23 = nNumRecibos;
          #11#24 = #10#0;
          #11#25 = #10#1;

          |ABRE #177;
          #177#0 = #11#18;
          |LEE 000#177=;
          |CIERRA #177;

          #11#15 = #177#3;      ||Cuenta

          |HAZ RecCompra;
     |FINSI;
     |HAZ CierraRecCompra;

     |CIERRA #11;
     |CIERRA #agifa079;
|FPRO;
