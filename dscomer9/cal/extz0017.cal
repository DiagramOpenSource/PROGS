|FICHEROS;
     extz0017 #0;
     extm0003 #3;
     extm0004 #4;
     extm0011 #11;
     extm0013 #13;
     extm0014 #14;
     extm0020 #20;
     extm0021 #21;
     agifa024 #24;
     dsm00003 #30;
     extz0020 #120,MANTE; ||Pan Cab
     extz0021 #121,MANTE; ||Pan Lin
     extz0027 #127,MANTE;

     referC1@;
     referC2@;
     referC3@;
     referL1@;
     referL2@;
     referL3@;
|FIN;

|VARIABLES;
     &Tempo = "";
     &eaCliInci = "";
     &eaSerPresu = "";
     &enNumPresu = 0;
     &eaSerPedi = "";
     &enNumPedi = 0;
     &eaSerAlba = "";
     &enNumAlba = 0;
     &eaSerParte = "";
     &enNumParte = 0;
     &eaProg = "";
     &eaTitulo = "";
     &enCtrFin = 0;
     aPath = "";
     aAlfa = "";
     nPanta0 = 0;
     nPanta1 = 0;
     nPanta2 = 0;
     nPanta3 = 0;
     nGridC1 = 0;
     nGridC2 = 0;
     nGridC3 = 0;
     nGridL1 = 0;
     nGridL2 = 0;
     nGridL3 = 0;
     nRango = 0;
     nModo = 0;
     nModoLin = 0;
     nConta = 0;
     i = 0;
     aConte = "";
     nSw = 0;
     nPestana = 0;
     nHay = 0;
     aParam = "";
     aFic = "";
     nHandle = 0;
     aSerie = "";
     nNumero = 0;
|FIN;

|PROCESO ImpLineas;
     nHay = 1;
     |PRINT;
|FPRC;

|DEFBUCLE ImpLineas;
     #21#1;
     ;
     #20#0, 001;
     #20#0, 999;
     ;
     NULL, ImpLineas;
|FIN;

|PROCESO BtnImpCli;
     |SI nPestana = 0;
          #20#0 = #referC1@#0;
          #20#1 = #referC1@#1;
     |FINSI;
     |SI nPestana = 1;
          #20#0 = #referC2@#0;
          #20#1 = #referC2@#1;
     |FINSI;
     |SI nPestana = 2;
          #20#0 = #referC3@#0;
          #20#1 = #referC3@#1;
     |FINSI;
     |LEE 000#20=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     |SI FSalida = 0;
          Impresora = "CrystalReport";
          |IMPRE -1;
          |SI FSalida = 0;
               |INFOR "extmcl20";
               |SI FSalida = 0;
                    |ABRE #3;
                    #3#0 = #20#23;
                    |LEE 000#3=;
                    |CIERRA #3;
                    |ABRE #30;
                    #30#0 = #20#4;
                    #30#1 = #20#21;
                    |LEE 000#30=;
                    |CIERRA #30;
                    nHay = 0;
                    |BUCLE ImpLineas;
                    |SI nHay = 0; |PRINT; |FINSI;
                    |PIEINF;
                    |FININF;
               |SINO;
                    |MENAV "0000Error en informe 'extmcl20'";
               |FINSI;
               |FINIMP;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO BtnImpInt;
     |SI nPestana = 0;
          #20#0 = #referC1@#0;
          #20#1 = #referC1@#1;
     |FINSI;
     |SI nPestana = 1;
          #20#0 = #referC2@#0;
          #20#1 = #referC2@#1;
     |FINSI;
     |SI nPestana = 2;
          #20#0 = #referC3@#0;
          #20#1 = #referC3@#1;
     |FINSI;
     |LEE 000#20=;

     |SI FSalida ! 0; |ACABA; |FINSI;
     |SI FSalida = 0;
          Impresora = "CrystalReport";
          |IMPRE -1;
          |SI FSalida = 0;
               |INFOR "extmin20";
               |SI FSalida = 0;
                    |ABRE #3;
                    #3#0 = #20#23;
                    |LEE 000#3=;
                    |CIERRA #3;
                    |ABRE #30;
                    #30#0 = #20#4;
                    #30#1 = #20#21;
                    |LEE 000#30=;
                    |CIERRA #30;
                    nHay = 0;
                    |BUCLE ImpLineas;
                    |SI nHay = 0; |PRINT; |FINSI;
                    |PIEINF;
                    |FININF;
               |SINO;
                    |MENAV "0000Error en informe 'extmin20'";
               |FINSI;
               |FINIMP;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO EditaL;
     |SI nModoLin = 1; |VENTANA 2101, 3199, -1, 17, "Alta l¡nea incidencia"; |FINSI;
     |SI nModoLin = 2; |VENTANA 2101, 3199, -1, 17, "Modifica l¡nea incidencia"; |FINSI;
     |HAZ PushVenModal;

     |SI nModoLin = 1;
          #21#0 = #referC1@#0;
          #21#1 = 999;
          |LEE 000#21];
          |SI FSalida = 0;
               |LEE 000#21a;
          |SINO;
               |LEE 000#21u;
          |FINSI;
          |SI FSalida = 0; |Y #21#0 = #referC1@#0;
               nConta = #21#1 + 1;
          |SINO;
               nConta = 1;
          |FINSI;
          #21#0 = #referC1@#0;
          #21#1 = nConta;
          |GRABA 020#21b;

          |DDEFECTO #121;
          #121#0 = #21#0;
          #121#1 = #21#1;
          #121#3 = Usuario % 810;
          #121#9 = #20#3;
     |SINO;
          |PARA i = 0; |SI i [ 8; |HACIENDO i = i + 1;
               #121i = #21i;
          |SIGUE;
          #121#9 = #20#3;
     |FINSI;
     |PINPA #0#121;
     |PINDA #0#121;
     |SI nModoLin = 1;
          |ENDATOS #1#121;
     |SINO;
          |ENDATOS #2#121;
     |FINSI;
     |SI FSalida = 0;
          |PARA i = 0; |SI i [ 8; |HACIENDO i = i + 1;
               #21i = #121i;
          |SIGUE;
          |GRABA 020#21a;

          #20#3 = #121#9;
          |GRABA 020#20a;
          |LIBERA #20;

          #referL1@#0 = #21#0;
          #referL1@#1 = #21#1;
          |LEE 020#referL1@.=;

          |REFRESCACONTROL nGridC1;
          |REFRESCACONTROL nGridC3;
          |PULSATECLA;

          |REFRESCACONTROL nGridL1;
     |SINO;
          |SI nModoLin = 1;
               |BORRA 020#21c;
          |FINSI;
     |FINSI;

     |HAZ PopVenModal;
|FPRC;

|PROCESO Dir0; |TIPO 0;
     |ABRE #30;
     #30#0 = #120#4;
     #30#1 = #120#21;
     |LEE 000#30=;
     |SI FSalida = 0;
          #120#6 = #30#13; |PINTA #120#6;
     |SINO;
          |MENAV "0000No existe direcci¢n...";
          |ERROR;
     |FINSI;
     |CIERRA #30;
|FPRC;

|PROCESO Min3;
     #30#0 = #120#4;
     #30#1 = 0001;
|FPRC;

|PROCESO Max3;
     #30#0 = #120#4;
     #30#1 = 9999;
|FPRC;

|PROCESO Dir66; |TIPO 66;
     |ABRE #30;
     #30#0 = #120#4;
     #30#1 = #120#21;
     |LEE 000#30];
     |CONSULTA_F_CLAVE #1#30, Min3, Max3;
     |SI FSalida = 0;
          #120#21 = #30#1; |PINTA #120#21;
          #120#6 = #30#13; |PINTA #120#6;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #30;
|FPRC;

|PROCESO Edi0; |TIPO 0;
     |ABRE #4;
     #4#0 = #120#4;
     #4#1 = #120#21;
     #4#2 = #120#22;
     |LEE 000#4=;
     |SI FSalida ! 0;
          |MENAV "0000No existe c¢digo edificio...";
          |ERROR;
     |FINSI;
     |CIERRA #4;
|FPRC;

|PROCESO Min4;
     #4#0 = #120#4;
     #4#1 = #120#21;
     #4#2 = "                    ";
|FPRC;

|PROCESO Max4;
     #4#0 = #120#4;
     #4#1 = #120#21;
     #4#2 = "zzzzzzzzzzzzzzzzzzzz";
|FPRC;

|PROCESO Edi66; |TIPO 66;
     |ABRE #4;
     #4#0 = #120#4;
     #4#1 = #120#21;
     #4#2 = #120#22;
     |LEE 000#4];
     |CONSULTA_F_CLAVE #1#4, Min4, Max4;
     |SI FSalida = 0;
          #120#22 = #4#2; |PINTA #120#22;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #4;
|FPRC;

|PROCESO Sistema; |TIPO 0;
     |ABRE #3;
     #3#0 = #120#23;
     |LEE 000#3=;
     |SI FSalida = 0;
          #120#50 = #3#1; |PINTA #120#50;
     |SINO;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo de sistema...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO NumPro; |TIPO 0;
     aAlfa = #120#24; |QBF aAlfa;
     |SI aAlfa ! "";
          |ABRE #11;
          #11#0 = #120#24;
          |LEE 000#11=;
          |SI FSalida ! 0;
               |MENAV "0000No existe n§ serie producto...";
               ||ERROR;
          |FINSI;
          |CIERRA #11;
     |FINSI;
|FPRC;

|PROCESO Cliente; |TIPO 0;
     |SI nModo = 1; |O aConte ! #120Campo;
          |ABRE #24;
          #24#0 = #120#4;
          |LEE 000#24=;
          |SI FSalida = 0;
               #120#5 = #24#1; |PINTA #120#5;
               #120#21 = 1;
               |ABRE #30;
               #30#0 = #120#4;
               #30#1 = #120#21;
               |LEE 000#30=;
               |SI FSalida ! 0; |DDEFECTO #30; |FINSI;
               |CIERRA #30;
               #120#6 = #30#13; |PINTA #120#6;
          |SINO;
               |SI nSw = 0;
                    |MENAV "0000No existe c¢digo cliente...";
                    |ERROR;
               |FINSI;
          |FINSI;
          |CIERRA #24;
     |FINSI;
|FPRC;

|PROCESO Conte; |TIPO 7;
     aConte = #120Campo;
|FPRC;

|PROCESO EditaC;
     |SI nModo = 1; |VENTANA 0501, 3199, -1, 17, "Alta incidencia"; |FINSI;
     |SI nModo = 2; |VENTANA 0501, 3199, -1, 17, "Modifica incidencia"; |FINSI;
     |HAZ PushVenModal;

     |C_M #120#4, 1, "S";
     |C_M #120#5, 1, "S";
     |C_M #120#6, 1, "S";
     |C_M #120#16, 1, "S";
     |SI nModo = 1;
          |LEE 000#20u;
          |SI FSalida = 0;
               nConta = #20#0 + 1;
          |SINO;
               nConta = 1;
          |FINSI;
          #20#0 = nConta;
          |GRABA 020#20b;

          |DDEFECTO #120;
          #120#0 = nConta;
          #120#2 = Usuario % 810;
          |SI aParam ! "";
               #120#4 = #13#4;
               #120#5 = #13#5;
               #120#21 = #13#6;
               #120#22 = #13#7;
               #120#23 = #14#4;
               #120#24 = #14#2;
               nSw = 1;
               |HAZ Sistema;
               |HAZ Cliente;
               nSw = 0;
          |FINSI;
     |SINO;
          |PARA i = 0; |SI i [ 49; |HACIENDO i = i + 1;
               #120i = #20i;
          |SIGUE;
          nSw = 1;
          |HAZ Sistema;
          nSw = 0;
     |FINSI;
     |PINPA #0#120;
     |PINDA #0#120;
     |SI nModo = 1; |ENDATOS #1#120; |FINSI;
     |SI nModo = 2; |ENDATOS #2#120; |FINSI;
     |SI FSalida = 0;
          |PARA i = 0; |SI i [ 49; |HACIENDO i = i + 1;
               #20i = #120i;
          |SIGUE;
          |GRABA 020#20a;
          |SI aParam ! "";
               #14#26 = #20#0;
               |GRABA 020#14a;
          |FINSI;

          #referC1@#0 = #20#0;
          |LEE 020#referC1@.=;
          |REFRESCACONTROL nGridC1;
          |REFRESCACONTROL nGridC3;
     |SINO;
          |SI nModo = 1;
               |BORRA 020#20c;
          |FINSI;
     |FINSI;

     |HAZ PopVenModal;
|FPRC;

|PROCESO BtnSelec;
     |LEE 000#referC3@.=;
     |SI FSalida = 0;
          |SI #referC3@#15 = "A";
               #referC1@#0 = #referC3@#0;
               |LEE 020#referC1@.=;
               |REFRESCACONTROL nGridC1;
               |FOCOTECLADO nGridC1;
          |SINO;
               #referC2@#0 = #referC3@#0;
               |LEE 020#referC2@.=;
               |REFRESCACONTROL nGridC2;
               |FOCOTECLADO nGridC2;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO BtnBorra;
     |LEE 000#referL1@.=;
     |SI FSalida = 0;
          #21#0 = #referL1@#0;
          #21#1 = #referL1@#1;
          |LEE 121#21=;
          |SI FSalida = 0;
               #20#0 = #21#0;
               |LEE 121#20=;
               |SI FSalida = 0; |Y #20#15 = "A";
                    aAlfa = "0000N¨Borrar l¡nea:" + (("000" + #21#1)%-103) + "?";
                    |CONFI aAlfa;
                    |SI FSalida = 0;
                         |BORRA 020#21a;
                         |REFRESCACONTROL nGridL1;
                         |REFRESCACONTROL nGridC3;
                    |FINSI;
                    |LIBERA #20;
               |FINSI;
               |LIBERA #21;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO BtnModiL;
     |LEE 000#referL1@.=;
     |SI FSalida = 0;
          #21#0 = #referL1@#0;
          #21#1 = #referL1@#1;
          |LEE 121#21=;
          |SI FSalida = 0;
               #20#0 = #21#0;
               |LEE 121#20=; |Y #20#15 = "A";
               |SI FSalida = 0;
                    nModoLin = 2; |HAZ EditaL;
                    |LIBERA #20;
               |FINSI;
               |LIBERA #21;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO BtnAltaInci;
     #20#0 = #referC1@#0;
     |LEE 101#20=;
     |SI FSalida = 0; |Y #20#15 = "A";
          nModoLin = 1; |HAZ EditaL;
          |LIBERA #20;
     |FINSI;
|FPRC;

|PROCESO BtnAlba;
     |LEE 000#referC1@.=;
     |SI FSalida = 0; |Y #referC1@#15 = "A";
          #20#0 = #referC1@#0;
          |LEE 121#20=;
          |SI FSalida = 0;
               |HAZ CreaTempo;  ||Serie+Numero+Cliente+Dir+Tempo
               aAlfa = #20#13 + (("0000000" + #20#14) % -106) + #20#4 + "    " + Tempo;
               aAlfa = "*extz0019;" + aAlfa;
               |SUB_EJECUTA_NP aAlfa;
               |HAZ LeeTempo; |HAZ BoraTempo;
               #20#13 = aSerie;
               #20#14 = nNumero;
               |GRABA 020#20a;
               |LIBERA #20;
               |REFRESCACONTROL nGridC1;
               |REFRESCACONTROL nGridC3;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO BtnPedido;
     |LEE 000#referC1@.=;
     |SI FSalida = 0; |Y #referC1@#15 = "A";
          #20#0 = #referC1@#0;
          |LEE 121#20=;
          |SI FSalida = 0;
               |HAZ CreaTempo;  ||Serie+Numero+Cliente+Dir+Tempo
               aAlfa = #20#11 + (("0000000" + #20#12) % -106) + #20#4 + "    " + Tempo;
               aAlfa = "*extz0018;" + aAlfa;
               |SUB_EJECUTA_NP aAlfa;
               |HAZ LeeTempo; |HAZ BoraTempo;
               #20#11 = aSerie;
               #20#12 = nNumero;
               |GRABA 020#20a;
               |LIBERA #20;
               |REFRESCACONTROL nGridC1;
               |REFRESCACONTROL nGridC3;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO BtnPresu;
     |LEE 000#referC1@.=;
     |SI FSalida = 0; |Y #referC1@#15 = "A";
          #20#0 = #referC1@#0;
          |LEE 121#20=;
          |SI FSalida = 0;
               |HAZ CreaTempo;  ||Serie+Numero+Cliente+Dir+Tempo
               aAlfa = #20#9 + (("0000000" + #20#10) % -106) + #20#4 + "    " + Tempo;
               aAlfa = "*extz0014;" + aAlfa;
               |SUB_EJECUTA_NP aAlfa;
               |HAZ LeeTempo; |HAZ BoraTempo;
               #20#9 = aSerie;
               #20#10 = nNumero;
               |GRABA 020#20a;
               |LIBERA #20;
               |REFRESCACONTROL nGridC1;
               |REFRESCACONTROL nGridC3;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO BtnParte;
     |LEE 000#referC1@.=;
     |SI FSalida = 0; |Y #referC1@#15 = "A";
          #20#0 = #referC1@#0;
          |LEE 121#20=;
          |SI FSalida = 0;
               eaCliInci = #20#4;
               eaSerParte = #20#7;
               enNumParte = #20#8;
               |ABRE #13;
               |SI #20#7 ! 0;
                    #13#0 = eaSerParte;
                    #13#1 = enNumParte;
                    |LEE 121#13=;
                    |SI FSalida = 0;
                         |HAZ ModiParte;
                         |GRABA 020#13a;
                    |SINO;
                         #20#7 = "";
                         #20#8 = 0;
                    |FINSI;
               |FINSI;
               |SI #20#7 = 0;
                    |HAZ NuevoParte;
                    #20#7 = eaSerParte;
                    #20#8 = enNumParte;
                    |GRABA 020#20a;
               |FINSI;
               |GRABA 020#20a;
          |FINSI;
          |LIBERA #20;
          |REFRESCACONTROL nGridC1;
          |REFRESCACONTROL nGridC3;
     |FINSI;
|FPRC;

|PROCESO VenFechaActua;
     |VENTANA 1634, 2265, -1, 17, "Cambio fecha actuaci¢n";
     |HAZ PushVenModal;

     #127#0 = #referC1@#3;
     |PINPA #0#127;
     |PINDA #0#127;
     |ENDATOS #1#127;
     |SI FSalida = 0;
          #referC1@#3 = #127#0;
          |GRABA 020#referC1@.a;
          |REFRESCACONTROL nGridC1;
          |REFRESCACONTROL nGridC3;
     |FINSI;

     |HAZ PopVenModal;
|FPRC;

|PROCESO BtnFecha;
     |LEE 101#referC1@.=;
     |SI FSalida = 0; |Y #referC1@#15 = "A";
          |HAZ VenFechaActua;
     |FINSI;
     |LIBERA #referC1@;
|FPRC;

|PROCESO BtnModiC;
     |LEE 000#referC1@.=;
     |SI FSalida = 0; |Y #referC1@#15 = "A";
          #20#0 = #referC1@#0;
          |LEE 121#20=;
          |SI FSalida = 0;
               nModo = 2; |HAZ EditaC;
               |LIBERA #20;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO BtnCerrar;
     |LEE 000#referC1@.=;
     |SI FSalida = 0; |Y #referC1@#15 = "A";
          aAlfa = "0000N¨Cerrar incidencia n§:" + (("000000" + #referC1@#0)%-106) + "?";
          |CONFI aAlfa;
          |SI FSalida = 0;
               #20#0 = #referC1@#0;
               |LEE 121#20=;
               |SI FSalida = 0;
                    #20#15 = "C";
                    |GRABA 020#20a;
                    |LIBERA #20;
               |FINSI;
               #referC1@#0 = "";;
               |REFRESCACONTROL nGridL1;
               |REFRESCACONTROL nGridC1;
               |REFRESCACONTROL nGridC2;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO BtnNueva;
     nModo = 1; |HAZ EditaC;
|FPRC;

|PROCESO BtnActua;
     |REFRESCACONTROL nGridC1;
     |REFRESCACONTROL nGridC2;
     |REFRESCACONTROL nGridC3;
|FPRC;

|PROCESO EvtC1;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#referC1@.=;
          |REFRESCACONTROL nGridL1;
     |FINSI;
     |SI FSalida = 4;
          |HAZ BtnModiC;
     |FINSI;
|FPRC;

|PROCESO EvtC2;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#referC2@.=;
          |REFRESCACONTROL nGridL2;
     |FINSI;
     |SI FSalida = 4;
     |FINSI;
|FPRC;

|PROCESO EvtC3;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#referC3@.=;
          |REFRESCACONTROL nGridL3;
     |FINSI;
     |SI FSalida = 4;
          |HAZ BtnSelec;
     |FINSI;
|FPRC;

|PROCESO EvtL1;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#referL1@.=;
     |FINSI;
     |SI FSalida = 4;
          |HAZ BtnModiL;
     |FINSI;
|FPRC;

|PROCESO EvtL2;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#referL2@.=;
     |FINSI;
     |SI FSalida = 4;
     |FINSI;
|FPRC;

|PROCESO EvtL3;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#referL3@.=;
     |FINSI;
     |SI FSalida = 4;
     |FINSI;
|FPRC;

|PROCESO EvtFoco3;
     nPestana = 2;
|FPRC;

|PROCESO EvtFoco2;
     nPestana = 1;
|FPRC;

|PROCESO EvtFoco1;
     nPestana = 0;
|FPRC;

|PROCESO MinC1;
     #referC1@#15 = "A";
     #referC1@#0 = 0;
|FPRC;

|PROCESO MaxC1;
     #referC1@#15 = "A";
     #referC1@#0 = 999999;
|FPRC;

|PROCESO MinC2;
     #referC2@#15 = "C";
     #referC2@#0 = 0;
|FPRC;

|PROCESO MaxC2;
     #referC2@#15 = "C";
     #referC2@#0 = 999999;
|FPRC;

|PROCESO MinC3;
     #referC3@#0 = 0;
|FPRC;

|PROCESO MaxC3;
     #referC3@#0 = 999999;
|FPRC;

|PROCESO MinL1;
     #referL1@#0 = #referC1@#0;
     #referL1@#1 = 1;
|FPRC;

|PROCESO MaxL1;
     #referL1@#0 = #referC1@#0;
     #referL1@#1 = 999;
|FPRC;

|PROCESO MinL2;
     #referL2@#0 = #referC2@#0;
     #referL2@#1 = 1;
|FPRC;

|PROCESO MaxL2;
     #referL2@#0 = #referC2@#0;
     #referL2@#1 = 999;
|FPRC;

|PROCESO MinL3;
     #referL3@#0 = #referC3@#0;
     #referL3@#1 = 1;
|FPRC;

|PROCESO MaxL3;
     #referL3@#0 = #referC3@#0;
     #referL3@#1 = 999;
|FPRC;

|PROGRAMA;
     aParam = PARAMETRO;
     |DDEF aPath;
     aAlfa = aPath + "extm0020"; |CARGA_DEF aAlfa, referC1@;
     aAlfa = aPath + "extm0020"; |CARGA_DEF aAlfa, referC2@;
     aAlfa = aPath + "extm0020"; |CARGA_DEF aAlfa, referC3@;
     aAlfa = aPath + "extm0021"; |CARGA_DEF aAlfa, referL1@;
     aAlfa = aPath + "extm0021"; |CARGA_DEF aAlfa, referL2@;
     aAlfa = aPath + "extm0021"; |CARGA_DEF aAlfa, referL3@;

     |ABRET #referC1@;
     |ABRET #referC2@;
     |ABRET #referC3@;
     |ABRET #referL1@;
     |ABRET #referL2@;
     |ABRET #referL3@;
     |ABRET #20;
     |ABRET #21;

     |SI aParam ! "";
          |ABRE #13;
          |ABRE #14;
          aAlfa = aParam % 105; #14#0 = aAlfa;
          aAlfa = aParam % 606; #14#1 = aAlfa;
          aAlfa = aParam % 1220; #14#2 = aAlfa;
          |LEE 101#14=;
          |SI FSalida = 0;
               #13#0 = #14#0;
               #13#1 = #14#1;
               |LEE 000#13=;
               |SI FSalida = 0;
                    aAlfa = aParam % 3206; #20#0 = aAlfa;
                    |LEE 101#20=;
                    |SI FSalida = 0;
                         nModo = 2;
                    |SINO;
                         nModo = 1;
                    |FINSI;
                    |HAZ EditaC;
               |FINSI;
          |FINSI;
          |CIERRA #14;
          |CIERRA #13;
     |SINO;
          |PINPA #0#0; nPanta0 = FSalida;
          |CONTROL_SIMPLE nPanta0, "BOTON,{{137}}Actualizar", 0616, 0628, BtnActua;
          |CONTROL_SIMPLE nPanta0, "BOTON,{{193}}Nueva", 0630, 0642, BtnNueva;
          |CONTROL_SIMPLE nPanta0, "BOTON,{{205}}Imprimir interna", 0666, 0681, BtnImpInt;
          |CONTROL_SIMPLE nPanta0, "BOTON,{{205}}Imprimir cliente", 0683, 0698, BtnImpCli;


          |PINPA #1#0; nPanta1 = FSalida;
          |CONTROL_SIMPLE nPanta1, "EVENTOPAN", 0000, 0000, EvtFoco1;
          |CONTROL_SIMPLE nPanta1, "BOTON,{{137}}Cerrar", 0602, 0614, BtnCerrar;
          |CONTROL_SIMPLE nPanta1, "BOTON,{{197}}Modificar", 0616, 0628, BtnModiC;
          |CONTROL_SIMPLE nPanta1, "BOTON,{{137}}F.Actuaci¢n", 0630, 0642, BtnFecha;
          |CONTROL_SIMPLE nPanta1, "BOTON,{{137}}Parte Rev.", 0644, 0656, BtnParte;
          |CONTROL_SIMPLE nPanta1, "BOTON,{{137}}Presupuesto", 0658, 0670, BtnPresu;
          |CONTROL_SIMPLE nPanta1, "BOTON,{{137}}Pedido", 0672, 0684, BtnPedido;
          |CONTROL_SIMPLE nPanta1, "BOTON,{{137}}Albar n", 0686, 0698, BtnAlba;

          |CONTROL_SIMPLE nPanta1, "BOTON,{{193}}Alta", 1802, 1814, BtnAltaInci;
          |CONTROL_SIMPLE nPanta1, "BOTON,{{197}}Modificar", 1816, 1828, BtnModiL;
          |CONTROL_SIMPLE nPanta1, "BOTON,{{199}}Borrar", 1830, 1842, BtnBorra;
          nRango = 4 + 8 + 16 + 32;
          |LINEAL_SIMPLE #1#referL1@, nRango, 1902, 2998, MinL1, MaxL1, EvtL1;
          nGridL1 = FSalida;
          |LINEAL_SIMPLE #2#referC1@, nRango, 0702, 1698, MinC1, MaxC1, EvtC1;
          nGridC1 = FSalida;


          |PINPA #2#0; nPanta2 = FSalida;
          |CONTROL_SIMPLE nPanta2, "EVENTOPAN", 0000, 0000, EvtFoco2;
          |LINEAL_SIMPLE #1#referL2@, nRango, 1902, 2998, MinL2, MaxL2, EvtL2;
          nGridL2 = FSalida;
          |LINEAL_SIMPLE #2#referC2@, nRango, 0602, 1798, MinC2, MaxC2, EvtC2;
          nGridC2 = FSalida;


          |PINPA #3#0; nPanta3 = FSalida;
          |CONTROL_SIMPLE nPanta3, "EVENTOPAN", 0000, 0000, EvtFoco3;
          |CONTROL_SIMPLE nPanta3, "BOTON,{{137}}Seleccionar", 0602, 0614, BtnSelec;
          |LINEAL_SIMPLE #1#referL3@, nRango, 1902, 2998, MinL3, MaxL3, EvtL3;
          nGridL3 = FSalida;
          |LINEAL_SIMPLE #1#referC3@, nRango, 0702, 1798, MinC3, MaxC3, EvtC3;
          nGridC3 = FSalida;

          enCtrFin = nGridC1;
          |HAZ EsperaFin;
     |FINSI;

     |CIERRAT #21;
     |CIERRAT #20;
     |CIERRAT #referL3@;
     |CIERRAT #referL2@;
     |CIERRAT #referL1@;
     |CIERRAT #referC3@;
     |CIERRAT #referC2@;
     |CIERRAT #referC1@;

     |PULSATECLA;

     |DESCARGA_DEF #referL3@;
     |DESCARGA_DEF #referL2@;
     |DESCARGA_DEF #referL1@;
     |DESCARGA_DEF #referC3@;
     |DESCARGA_DEF #referC2@;
     |DESCARGA_DEF #referC1@;
|FPRO;

|PROCESO LeeTempo;
     |DFICE aFic;
     aFic = aFic + Tempo;
     |XABRE "", aFic, nHandle;
     |SI FSalida = 0;
          |XLEE nHandle, 250, aAlfa;
          aSerie = aAlfa % 105;
          aAlfa = aAlfa % 6;
          nNumero = aAlfa;
          |XCIERRA nHandle;
          |FBORRA aFic;
     |FINSI;
|FPRC;
