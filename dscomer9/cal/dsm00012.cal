|FICHEROS;
     dsm00012 #0;
     dsm00011 #11;
     dsw00101 #101; ||Tmp
     dsm00010 #910;
|FIN;

|VARIABLES;
     aAlfa = "";
     nNume = 0;
     aCod = "";
     &enSwMalo = 0;
     &eAlfa    = "";
     &Tempo = "";
|FIN;

|PROCESO LongiCod12;   |TIPO 13;
     |ABRE #910;
     |LEE 040#910p;
     |SI FSalida ! 0;  |DDEFECTO #910;  |FINSI;
     |CIERRA #910;

     |PINTA 1220, #910#3;
     |PINTA 1320, #910#7;

     |ATRI R;
     |PINTA 1020, #910#7;
     |ATRI r;

     nNume = #910#4;
     aAlfa = "\" + #910#6 + "+#";
     |CAMPO_ANCHO  #0#0, 1, nNume;
     |CAMPO_MAXIMO #0#0, 1, aAlfa;

     nNume = #910#8;
     aAlfa = "\" + #910#10 + "+#";
     |CAMPO_ANCHO  #0#1, 1, nNume;
     |CAMPO_MAXIMO #0#1, 1, aAlfa;
|FPRC;

|PROCESO Caracter12;  |TIPO 0;
     |ABRE #910;
     |LEE 040#910p;
     |SI FSalida ! 0;  |DDEFECTO #910;  |FINSI;
     |CIERRA #910;

     |SI #910#9 ! "N";  |ACABA;  |FINSI;

     eAlfa = #0Campo;  |QBF eAlfa;  |SUB_EJECUTA_NP "dsz99990;C";
     |SI enSwMalo = 1;
         |MENAV "     Introduccion Erronea";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO LlenaTmp;
     #11#0 = #0#0;
     |LEE 000#11=;
     |SI FSalida ! 0; |DDEFECTO #11; |FINSI;

     #101#0 = #0#0;
     #101#1 = #11#1;
     #101#2 = #0#1;
     #101#3 = #0#2;
     |GRABA 020#101n;
|FPRC;

|DEFBUCLE LlenaTmp1;
     #0#1;
     ;
     aCod, "                    ";
     aCod, "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, LlenaTmp;
|FIN;

|PROCESO Tecla; |TIPO 6;
     |SI FSalida ! 12; |ACABA; |FINSI;  ||F4

     |SI Campo = 0;
          |ABRE #11;
          #11#0 = #0#0;
          |LEE 000#11];
          |CONSULTA_CLAVE #1#11;
          |SI FSalida = 0;
               #0#0 = #11#0; |PINTA #0#0;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #11;
     |SINO;
          |HAZ CreaTempo; |NOME_DAT #101 Tempo; |DELINDEX #101;

          |ABRE #101;

          |SALVA_FICHA #0;
          |ABRE #11;
          aCod = #0#0;
          |BUCLE LlenaTmp1;
          |CIERRA #11;
          |REPON_FICHA #0;

          #101#0 = #0#0;
          #101#2 = #0#1;
          |LEE 000#101];
          |CONSULTA_CLAVE #1#101;
          |SI FSalida = 0;
               #0#0 = #101#0; |PINTA #0#0;
               #0#1 = #101#2; |PINTA #0#1;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #101;
          |HAZ BoraTempo; |DELINDEX #101;
     |FINSI;
|FPRC;

|DEFBUCLE LlenaTmp;
     #0#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, LlenaTmp;
|FIN;

|PROCESO Consulta; |TIPO 66;
     |HAZ CreaTempo; |NOME_DAT #101 Tempo; |DELINDEX #101;

     |ABRE #101;

     |SALVA_FICHA #0;
     |ABRE #11;
     |BUCLE LlenaTmp;
     |CIERRA #11;
     |REPON_FICHA #0;

     #101#0 = #0#0;
     #101#2 = #0#1;
     |LEE 000#101];
     |CONSULTA_CLAVE #1#101;
     |SI FSalida = 0;
          #0#0 = #101#0; |PINTA #0#0;
          #0#1 = #101#2; |PINTA #0#1;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #101;
     |HAZ BoraTempo; |DELINDEX #101;
|FPRC;
