|FICHEROS;
   agifa725 #0;
   agifa724 #1,MANTE;

   agifa019 #10;
|FIN;

|VARIABLES;
    &endigC   = 0;
    &eaCta    = "";
    &eswCta   = 0;
{-1}aMenu = "";
    aMenu1 = "2400";
    aMenu2 = "2";
    aMenu3 = "";
    aMenu4 = "SEC";
    aMenu5 = "Sustituir";
    aMenu6 = " Editar  ";
    aMenu7 = "Cancelar ";

    nOpcion = 0;
    SwGraba = 0;
|FIN;

|PROCESO MCta725; |TIPO 0;
  eaCta = #0Campo;
  |HAZ MFiltraPtos;
  #0Campo = eaCta; |PINTA #0Campo;

  |HAZ MCtaContable;
  |SI eswCta = 1;
      |MENAV "    Error. Longitud de Cuenta fuera de Nivel";
      |ERROR;
  |FINSI;
|FPRC;

|PROCESO MCta724; |TIPO 0;
  eaCta = #1Campo;
  |HAZ MFiltraPtos;
  #1Campo = eaCta; |PINTA #1Campo;

  |HAZ MCtaContable;
  |SI eswCta = 1;
      |MENAV "    Error. Longitud de Cuenta fuera de Nivel";
      |ERROR;
  |FINSI;
|FPRC;


|PROCESO MiraArt; |TIPO 11;
   |SI FSalida = 10;
      |ABRE #agifa019;
      #agifa019#0 = #agifa724#0;
      |LEE 000#agifa019.];
      |CONSULTA_CLAVE #1#agifa019;
      #agifa724#0 = #agifa019#0; |PINTA #agifa724#0;
      #agifa724#1 = #agifa019#1; |PINTA #agifa724#1;
      |LEE 000#agifa724.];
      |CIERRA #agifa019;
      |ERROR; |PTEC 809;
      |PONCONTROL 23, "SI";
   |FINSI;
|FPRC;

|PROCESO Articulos;
    SwGraba = 0;
    #agifa724#0 = #agifa019#0;
    |LEE 101#agifa724.=;
    |SI FSalida = 0;
       |SI #agifa724#2 ] #agifa725#2; |Y #agifa724#2 [ #agifa725#3;
          #agifa724#2 = #agifa725#4;
          SwGraba = 1;
       |FINSI;
       |SI #agifa724#3 ] #agifa725#5; |Y #agifa724#3 [ #agifa725#6;
          #agifa724#3 = #agifa725#7;
          SwGraba = 1;
       |FINSI;
    |SINO;
       |DDEFECTO #agifa724;
       #agifa724#0 = #agifa019#0;
       #agifa724#1 = #agifa019#1;
       |GRABA 020#agifa724.b;
       #agifa724#2 = #agifa725#0;
       #agifa724#3 = #agifa725#1;
       SwGraba = 1;
    |FINSI;
    |SI SwGraba = 1; |GRABA 020#agifa724.a; |LIBERA #agifa724; |FINSI;
|FPRC;

|DEFBUCLE Articulos;
#agifa019#1;
;
"                    ";
"zzzzzzzzzzzzzzzzzzzz";
;
NULL,Articulos;
|FIN;

|PROCESO Sustituye;
   |BUCLE Articulos;
|FPRC;

|RUTINA inf724;
   #agifa724#0 = "                    ";
|FRUT;

|RUTINA sup724;
   #agifa724#0 = "zzzzzzzzzzzzzzzzzzzz";
|FRUT;

|PROGRAMA;
   |CLS;
   |CABEZA " Sustitucion masiva cuentas desglose contable articulos "
   |ABRE #agifa724;
   |PARA; |SI; |HACIENDO;
      |PINPA #0#0; |PINDA #0#0;
      |MENU aMenu;
      nOpcion = FSalida;
      |SI nOpcion < 1; |O nOpcion > 3; |SAL; |FINSI;
      |SI nOpcion = 1;
         |ENDATOS #1#agifa725;
         |SI FSalida = 0;  |Y #agifa725#8 = "SI";
               |HAZ Sustituye;
         |FINSI;
      |FINSI;
      |SI nOpcion = 2;
         |ENTLINEAL #1#agifa724,-1,2,19,1,inf724,sup724;
      |FINSI;
      |SI nOpcion = 3; |SAL; |FINSI;
   |SIGUE;
   |CIERRA #agifa724;
|FPRO;
