|FICHEROS;
     cafe0002 #0;
     cafe0001 #1;
     cafe0003 #3,MANTE;
     dscamrec@ #600;     || Fichero puente cartera
     agifa010;
     agifa024;
     agifa025;
     agifa324;
     agis0002 #148;
     dsm00289 #289;
|FIN;

|VARIABLES;
     aOpe = "";
     aSubProg = ":dscarter/dsrecibo";
     CambioDiv = 0;
     CambioBase = 0;
     &nDeci_Div = 0;
     aPath = "";
     aDef00 = "";
     aTempo600 = "";
     &Tempo = "";
     &aCPath = "";
     &aCNome = "";
     Comodin = "";
     aFic      = "";
     aAlfa     = "";
     nCampos   = 0;
     i         = 0;
     nHay      = 0;
 {-1}menu      = "";
     menu1     = "2400";
     menu2     = "1";
     menu3     = " Opciones: ";
     menu4     = "RCAI";
     menu5     = " Repasar ";
     menu6     = " Cancelar ";
     menu7     = " Aceptar ";
     menu8     = " Imprimir ";

     aInforme  = "cafe0002";
|FIN;

|PROCESO Tecla; |TIPO 0;
     |SI FSalida = 0; |Y #3Campo = Contenido;
          |SI #3#32 = "*";
               #3#32 = "";
          |SINO;
               #3#32 = "*";
          |FINSI;
          |GRABA 020#3a;
          |PINTA #3#32;
     |FINSI;
|FPRC;

|PROCESO agifa148;
     |SI #148#13 = "S";
          |SI #0#4 = "N"; |ACABA; |FINSI;
     |SINO;
          |SI #0#4 = "S"; |ACABA; |FINSI;
     |FINSI;

     aAlfa = #148#33 % 104;   ||Entidad
     #1#5 = aAlfa;
     #1#0 = #148#31;
     |LEE 000#1=;
     |SI FSalida = 0;
          |SI #1#3 < #0#6; |O #1#3 > #0#3; |ACABA; |FINSI;
          aAlfa = "S";
     |SINO;
          |SI #148#8 < #0#6; |O #148#8 > #0#3; |ACABA; |FINSI;
          aAlfa = "N";
     |FINSI;

     |PARA i = 0; |SI i < nCampos; |HACIENDO i = i + 1;
          #3i = #148i;
     |SIGUE;
     |SI #0#0 = "S";
          #3#32 = "*";
     |SINO;
          #3#32 = "";
     |FINSI;
     #3#33 = #148#32;
     #3#34 = aAlfa;
     |GRABA 020#3n;
     nHay = 1;
|FPRC;

|DEFBUCLE agifa148;
     #148#3;
     2, 22;
     "     ",000000,#0#1,2;
     "zzzzz",999999,#0#2,2;
     ;
     NULL, agifa148;
|FIN;

|PROCESO Min;
     #3#30 = " ";
     #3#20 = "  ";
     #3#17 = 000000;
     #3#18 = 00;
|FPRC;

|PROCESO Max;
     #3#30 = "z";
     #3#20 = "zz";
     #3#17 = 999999;
     #3#18 = 99;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Imprimir;
     |PRINT;
|FPRC;

|DEFBUCLE Imprimir;
     #3#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Imprimir;
|FIN;

|PROCESO Imprime;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR aInforme;
          |SI FSalida = 0;
               |BUCLE Imprimir;
               |PIEINF;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO EnlazaCartera;
     |SI #148#22 ! 2; |ACABA; |FINSI;

     |DBASS aPath;
     aPath = aPath + "dscarter/";
     aDef00 = aPath + "def/dscamrec";

     |CARGA_DEF aDef00, dscamrec@;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |HAZ CreaTempo; aTempo600 = Tempo;
     |PATH_DAT #600 aPath; |NOME_DAT #600 aTempo600; |DELINDEX #600;
     |ABRE #600;
     aCPath = aPath; aCNome = aTempo600;

     |DFICE Comodin;
     Comodin = Comodin % -106;
     Comodin = Comodin % 0105;

     |ABRE #agifa010; |ABRE #agifa025;
     #agifa010#52 = #148#20;
     #agifa010#0  = #148#17;
     |LEE 101#agifa010.=;
     |SI FSalida ! 0; |DDEFECTO #agifa010; |FINSI;
     #agifa025#0 = #agifa010#6;
     |LEE 000#agifa025.=;
     |SI FSalida ! 0; |DDEFECTO #agifa025; |FINSI;
     |CIERRA #agifa010; |CIERRA #agifa025;

     |ABRE #agifa324;
     |ABRE #agifa024;
     #agifa324#0 = #agifa010#68;
     #agifa024#0 = #148#2;   ||cli
     |LEE 020#agifa324.=;
     |LEE 020#agifa024.=;
     |CIERRA #agifa324;
     |CIERRA #agifa024;
     nDeci_Div = #agifa324#7;


     |DDEFECTO #dscamrec@;
     ||#600#0  =              ||Libro
     #600#1  = #agifa010#52;||Serie
     #600#2  = #agifa010#0; ||Fact
     #600#3  = #148#18;||N Rec
     #600#4  = #148#8; ||F.V
     #600#5  = #148#7; ||F.E
     #600#6  = #148#12;||Cuenta Cli
     #600#7  = #148#3; ||Nom Cli
     #600#8  = #148#4; ||Nom Banco
     #600#9  = #agifa024#32;      ||Entidad
     #600#10 = #agifa024#33;      ||Sucursal
     #600#11 = #agifa024#31;      ||DC
     #600#12 = #agifa024#30;      ||Cuenta
     #600#13 = #148#22;||Tipo Rec
     ||#600#14 =      ||Departa
     #600#15 = #148#9; ||Importe
     #600#16 = #148#15;||A aceptar
     #600#17 = #148#6; ||Aceptado
     #600#18 = #148#2; ||Cliente
     |SI #148#30 = "A";
          #600#19 = #agifa010#6; ||Representante
          #600#20 = #agifa025#1; || Nombre representante
     |FINSI;
     #600#21 = #agifa024#3; ||Zona
     #600#22 = 1;           ||Documento
     ||#600#23 =      ||Empresa Contable
     ||#600#24 =      ||Periodo
     #600#25 = Comodin;       ||Empresa ges
     ||#600#26 =      ||A cuenta
      #600#27 = "V";         ||Tipo
      #600#28 = aOpe;         ||Ope
     #600#29 = #agifa324#0;      ||Divisa
     #600#30 = #agifa324#1;      ||Nombre
     #600#31 = #agifa010#69;
     #600#32 = #agifa010#74;
     #600#33 = #agifa024#203;
     #600#34 = 0;
     #600#35 = "A";
     #600#36 = #148#28;
     #600#37 = #3#31;
     #600#38 = #148#16;
     #600#39 = #148#10;
     aAlfa = "|NC"; aAlfa = #600#aAlfa#;
     |SI aAlfa > 48;
          #600#48 = #agifa024#215;
          #600#49 = #agifa024#216;
     |FINSI;
     |SI aAlfa > 50;
          #600#50 = #agifa024#217;
          |ABRE #289;
          #289#0 = #agifa024#0;
          |LEE 000#289=;
          |SI FSalida ! 0; |DDEFECTO #289; |FINSI;
          |CIERRA #289;
          #600#51 = #289#1;
     |FINSI;

     |GRABA 020#600n;
     |CIERRA #600;

     |SUB_EJECUTA_NP aSubProg;

     |DELINDEX #600;
     |DESCARGA_DEF #dscamrec@;
|FPRC;

|PROCESO Cobrar;
     #148#30 = #3#30;
     #148#20 = #3#20;
     #148#17 = #3#17;
     #148#18 = #3#18;
     |LEE 121#148=;
     |SI FSalida = 0;
          |SI #148#13 ! "S"; |Y #3#32 = "*";
               aOpe = "A";
               |HAZ EnlazaCartera;
               #148#13 = "S";
               #148#32 = "S";
          |FINSI;
          |SI #148#13 = "S"; |Y #3#32 = " ";
               aOpe = "B";
               |HAZ EnlazaCartera;
               #148#13 = "N";
               #148#32 = "N";
          |FINSI;
          |GRABA 020#148a;
     |FINSI;
     |LIBERA #148;
|FPRC;

|DEFBUCLE Cobrar;
     #3#2;
     ;
     #0#1;
     #0#2;
     ;
     NULL, Cobrar;
|FIN;

|PROCESO Cobra;
     |ABRE #148;
     |BUCLE Cobrar;
     |CIERRA #148;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO Tipo3; |TIPO 3;
     aAlfa = "|NC";
     aAlfa = #3#aAlfa#;
     nCampos = aAlfa;
     nCampos = nCampos - 1;

     aFic = Usuario; |QBF aFic;
     |NOME_DAT #3 aFic;
     |DELINDEX #3;
     |ABRE #3;
     |ABRE #1;
     |BUCLE agifa148;
     |CIERRA #1;
     |CIERRA #3;

     |SI nHay = 0;
          |MENAV "0000Seleccion Vacia...";
     |SINO;
          |PARA; |SI; |HACIENDO;
               |PINPA #0#3;
               |ENTLINEAL #1#3, -2, 4, 22, 0, Min, Max;
               |MENU menu;
               menu2 = FSalida;
               |SI menu2 = "1";       |FINSI;              ||Repa
               |SI menu2 = "2"; |SAL; |FINSI;              ||Cance
               |SI menu2 = "3"; |HAZ Cobra; |SAL; |FINSI;  ||Acep
               |SI menu2 = "4"; |HAZ Imprime;  |FINSI;
          |SIGUE;
     |FINSI;

     |DELINDEX #3;
|FPRC;
