|FICHEROS;
   agifa717 #0;
   agifa718 #1,MANTE;
   agifa700 #2;
   agifa702 #3;
   agifa720 #4,MANTE;
   agifa719 #5;
|FIN;

|VARIABLES;
   Salir   = 0;
   Calc    = 0;
   Linea   = 0;
   Puntero = 0;
   aAlfa      = "";
   NombreMemo = "";
   TipoCampo1 = "";
   TipoCampo2 = "";
   Comodin1 = "";
   Comodin2 = "";
   CodEnlace = "";
   Comodin = "";
   Expresion = "";
   Caracter  = "";

   nBaffer     = 0;
   NumLinea    = 0;
   nCont       = 0;
   LinCmps     = 0;
   ModoEntrada = 0;
   nTotalLinea = 0; nTope = 0; nVari1 = 0; nVari2 = 0;

   &enModoEdita  = 0;
   &enTotalVaria = 0;
   &enCampoAncho = 0;
   &eaNombreList  = "";
   &enCuadroIni   = 0;
   &enCuadroFin   = 0;

{100}&epPuntEdita   = "";
|FIN;

|PROCESO BajaLin717;
   |BORRA 020#agifa718.a;
|FPRC;

|DEFBUCLE BajaLin717;
#agifa718#1;
;
#agifa717#0,#agifa717#1,001;
#agifa717#0,#agifa717#1,999;
;
NULL,BajaLin717;
|FIN;

|RUTINA inf1717;
   #agifa718#0 = #agifa717#0;
   #agifa718#1 = #agifa717#1;
   #agifa718#2 = 1;
|FRUT;

|RUTINA sup1717;
   #agifa718#0 = #agifa717#0;
   #agifa718#1 = #agifa717#1;
   #agifa718#2 = 999;
|FRUT;

|PROCESO Campos717;

   #agifa700#0 = #agifa702#1;
   |LEE 000#agifa700.=;

   |DDEFECTO #agifa720;

   #agifa720#0 = Linea;  Linea = Linea + 1;
   #agifa720#1 = #agifa702#1;
   #agifa720#2 = #agifa700#1;
   #agifa720#3 = #agifa702#4;
   #agifa720#4 = #agifa702#2;
   #agifa720#5 = #agifa702#3;
   #agifa720#6 = #agifa702#5;
   |GRABA 020#agifa720.n;
|FPRC;

|DEFBUCLE Ficheros717;
#agifa702#1;
4,5;
001,"  ",TipoCampo1;
999,"zz",TipoCampo2;
;
NULL,Campos717;
|FIN;

|PROCESO Edic; |TIPO 3;
    CodEnlace  = #agifa717#0;
    NombreMemo = #agifa717#1;
    |ENTLINEAL #1#agifa718,-3,1,20,1,inf1717,sup1717;
    ||HAZ Edit;
|FPRC;

|RUTINA inf708;
   #agifa720#0 = 001;
|FRUT;

|RUTINA sup708;
   #agifa720#0 = 999;
|FRUT;

|PROCESO Vuelca;
   Comodin = #agifa719#2; |QBF Comodin;
   |SI Comodin ! "";
      Expresion = Expresion + Comodin;
   |SINO;
      Expresion = Expresion + #agifa719#1; |QBF Expresion;
   |FINSI;
   Expresion = Expresion + " ";
|FPRC;

|DEFBUCLE Vuelca;
#agifa719#1;
;
#agifa717#0,#agifa717#1,001;
#agifa717#0,#agifa717#1,999;
;
NULL,Vuelca;
|FIN;

|PROCESO Prueba;
   |SI FSalida = 10;
      aAlfa = "ic" + Usuario; |NOME_DAT #agifa720#aAlfa#;
      |DELINDEX #agifa720;
      |ABRE #agifa720; |ABRE #agifa719;
      TipoCampo1 = "I"; TipoCampo2 = "I"; Linea = 1;
      |ABRE #agifa700;
      |BUCLE Ficheros717;
      |CIERRA #agifa700;

      |PUSHV 0501 2380;
      |ENTLINEAL #1#agifa719,-3,7,22,1,inf3717,sup3717;
      |ENTLINEAL #1#agifa720,-1,4,13,1,inf708,sup708;
      |POPV;
      |CIERRA #agifa719; |CIERRA #agifa720;

      |BUCLE BajaLin717;
      |BUCLE Vuelca; |HAZ Reparte;
   |FINSI;
|FPRC;

|PROCESO PintaLineas; |TIPO 13;
    |ENTLINEAL #1#agifa718,-3,7,20,1,inf1717,sup1717;
|FPRC;

|PROCESO Baja; |TIPO 1;
   ModoEntrada = (FEntrada / 100) ! 0;
   |SI ModoEntrada = 3;
      |ABRE #agifa718; |BUCLE BajaLin717; |CIERRA #agifa718;
   |FINSI;
|FPRC;

*/**************************************************************************
*********************** PROCESO DE EDICION DE LINEAS ***********************
**************************************************************************/*

|PROCESO GrabaSecuencial;
     IepPuntEdita  = epPuntEdita1 <-;
     |PARA nTotalLinea = 0;  |SI nTotalLinea [ enTotalVaria;  |HACIENDO nTotalLinea = nTotalLinea + 1;
          |AL_BUF nBaffer, nTotalLinea, epPuntEdita;
          IepPuntEdita = IepPuntEdita + 1;
     |SIGUE;
|FPRC;

|PROCESO Edicion;
     nTope  = nTotalLinea - 1;
     nVari1 = 0;
     nVari2 = 0;
     enModoEdita = enModoEdita + 100;
     |EDITA nBaffer, 1, nTope, enCuadroIni, enCuadroFin, enModoEdita, eaNombreList, enCampoAncho, nVari1, nVari2;
     enModoEdita = enModoEdita $ 100;
|FPRC;

|PROCESO CogePuntero;
     IepPuntEdita  = epPuntEdita1 <-;
     |PARA nTotalLinea = 0;  |SI nTotalLinea [ enTotalVaria;  |HACIENDO nTotalLinea = nTotalLinea + 1;
          |DEL_BUF nBaffer, nTotalLinea, epPuntEdita;
          IepPuntEdita = IepPuntEdita + 1;
     |SIGUE;
|FPRC;

|PROCESO Edita;
     |PUSHV 0501 2380;
     |DIMENSIONA  200, nBaffer, 0;

     |HAZ GrabaSecuencial;
     |HAZ Edicion;
     |HAZ CogePuntero;

     |FINDIM nBaffer;
     |POPV;
|FPRC;

|PROCESO Edit;
   enTotalVaria = 100;
   enModoEdita  = 0;
   enCampoAncho = 60;
   eaNombreList  = "";
   enCuadroIni   = 0619;
   enCuadroFin   = 2079;

   |ABRE #agifa718;
   |PARA Puntero = 1; |SI Puntero [ 100; |HACIENDO Puntero = Puntero + 1;
      IepPuntEdita  = epPuntEdita1 <-;
      IepPuntEdita = IepPuntEdita + (Puntero - 1);

      #agifa718#0 = CodEnlace;
      #agifa718#1 = NombreMemo;
      #agifa718#2 = Puntero;
      |LEE 101#agifa718.=;
      |SI FSalida ! 0;
         epPuntEdita  = "";
      |SINO;
         epPuntEdita  = #agifa718#3;
         |BORRA 020#agifa718.a;
         |LIBERA #agifa718;
      |FINSI;
   |SIGUE;
   |CIERRA #agifa718;

   |PUSHV  0501 2380;
||   |BLANCO 0811 2071;
   Comodin = " Expresion memoria " + NombreMemo;
   |ATRI R;  |PINTA 0530, Comodin;  |ATRI 0;

   |HAZ Edita;
   |POPV;

   |ABRE #agifa718;
   |PARA Puntero = 1;  |SI Puntero [ 100;  |HACIENDO Puntero = Puntero + 1;
      IepPuntEdita  = epPuntEdita1 <-;
      IepPuntEdita = IepPuntEdita + (Puntero - 1);

      |DDEFECTO #agifa718;
      #agifa718#0 = CodEnlace;
      #agifa718#1 = NombreMemo;
      #agifa718#2 = Puntero;
      |LEE 101#agifa718.=;
      |SI FSalida ! 0;
         Comodin = epPuntEdita; |QBF Comodin;
         |SI Comodin ! "";
            #agifa718#3 = epPuntEdita;
            |GRABA 020#agifa718.n;
         |FINSI;
      |SINO;
         Comodin = epPuntEdita; |QBF Comodin;
         |SI Comodin ! "";
            #agifa718#3 = epPuntEdita;
            |GRABA 020#agifa718.a;
         |FINSI;
      |FINSI;
   |SIGUE;
   |CIERRA #agifa718;
|FPRC;

|PROCESO EditaLineas717; |TIPO 13;
   |SI FSalida = 10;
      |ENTLINEAL #1#agifa719,-3,1,22,1,inf3717,sup3717;
      |ENTLINEAL #1#agifa719,-3,7,22,1,inf3717,sup3717;
   |FINSI;
|FPRC;

|PROCESO LinFichero717; |TIPO 0;
   LinCmps = 0;
   |SALVA_FICHA #agifa719;
   #agifa719#0 = 1;
   #agifa719#3 = #agifa717#1;
   #agifa719#4 = #agifa717#0;
   |LEE 000#agifa719.];
   |SI FSalida = 0; |Y #agifa719#3 = #agifa717#1;
    |Y #agifa719#4 = #agifa717#0;
      |PARA; |SI FSalida = 0; |Y #agifa719#3 = #agifa717#1;
       |Y #agifa719#4 = #agifa717#0; |HACIENDO;
         LinCmps = #agifa719#0 + 10;
         |LEE 010#agifa719.s;
      |SIGUE;
   |SINO;
      LinCmps = 10;
   |FINSI;
   |REPON_FICHA #agifa719;

   |DDEFECTO #agifa719;
   #agifa719#0 = LinCmps;
   Comodin = "[" + #agifa720#2; |QBF Comodin;
   Comodin = Comodin + "][" + #agifa720#5; |QBF Comodin;
   Comodin = Comodin + "]";
   #agifa719#1 = Comodin;
   Comodin = "[" + #agifa720#1; |QBF Comodin;
   Comodin1 = ("000" + #agifa720#4) % -103;
   Comodin = Comodin + "][" + Comodin1 + "]";
   #agifa719#2 = Comodin;
   #agifa719#3 = #agifa717#1;
   #agifa719#4 = #agifa717#0;
   |GRABA 020#agifa719.n;
   |ENTLINEAL #1#agifa719,-3,7,22,1,inf3717,sup3717;
|FPRC;

|RUTINA inf3717;
   #agifa719#0 = 1;
   #agifa719#3 = #agifa717#1;
   #agifa719#4 = #agifa717#0;
|FRUT;

|RUTINA sup3717;
   #agifa719#0 = 999;
   #agifa719#3 = #agifa717#1;
   #agifa719#4 = #agifa717#0;
|FRUT;

|PROCESO Reparte;
   NumLinea = 1;
   |PARA; |SI Expresion ! ""; |HACIENDO;
      |PARA nCont = 53; |SI nCont > 0; |HACIENDO nCont = nCont - 1;
         Calc = (nCont * 100) + 1;
         Caracter = Expresion % Calc;
         |SI Caracter = " ";
            Calc = 100 + nCont;
            Comodin = Expresion % Calc;
            |SAL;
         |FINSI;
      |SIGUE;
      |DDEFECTO #agifa718;
      #agifa718#0 = #agifa717#0;
      #agifa718#1 = #agifa717#1;
      #agifa718#2 = NumLinea; NumLinea = NumLinea + 1;
      #agifa718#3 = Comodin;
      Expresion   = Expresion - Comodin;
      |GRABA 020#agifa718.n;
   |SIGUE;
|FPRC;
