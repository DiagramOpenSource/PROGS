|FICHEROS;
     marhu330 #0;
     agifa010 #10;
     agifa134 #134;
     agifa059 #59;
|FIN;

|VARIABLES;
     qCampo   = 0;
     dCampo   = 0;
     nCampo   = 0;
     qAlbar   = 0;
     &eaSecu1 = "";
     &eaSecu2 = "";
     &eaCampo = "";
     aInforme = "marhu330";
     &enBultos  = 0;
     &eaImprime = "";
     &ser_alb = "";
     &abo_alb = "";
     &ser_fac = "";
     &fec_alb = @;
     &num_alb = 0;
     &num_fac = 0;
     &imp_alb = 0;
     aAlfa    = "";
     aAlf1    = "";
     aAlf2    = "";
     aAlf3    = "";
     aAlf4    = "";
     aAlf5    = "";
     aAlf6    = "";
     i        = 0;
     nCam     = 0;
|FIN;

|PROCESO Comprueba;
     eaCampo = #0Campo;
     |HAZ comprueba;
|FPRC;

|PROCESO Bultos;
     #10#52 = #59#15;
     #10#0 = #59#2;
     |LEE 020#10=;
     |SI FSalida = 0;
          enBultos = enBultos + #10#2;
     |FINSI;
|FPRC;

|PROCESO Tipo3;
     |PARA i = 0; |SI i [ 68; |HACIENDO i = i + 2;
          nCam = i + 1;
          nCampo = i;
          qCampo = (nCampo/2) ! 0;
          qCampo = qCampo + 149;
          |ABRE #10;
          #10#52 = #0i;
          #10#0 = #0nCam;
          |LEE 101#10=;
          ser_fac = "";num_fac = 0;
          |SI FSalida = 0;
               #10#2 = #0qCampo;
               |GRABA 020#10a;
               |CIERRA #10;
               ser_alb = #10#52;
               num_alb = #10#0;
               fec_alb = #0#148;   ||Fecha Factura
               abo_alb = #10#43;
               imp_alb = 1;
               |SUB_EJECUTA_NP "agifa057";       ||Facturar Albaranes
          |FINSI;
          nCam = i + 71;   #0nCam = ser_fac;
          nCam = nCam + 1; #0nCam = num_fac;
          |CIERRA #10;
     |SIGUE;

     |PARA i = 71; |SI i [ 139; |HACIENDO i = i + 2;
          nCam = i + 1;
          |ABRE #134;
          #134#49 = #0i;
          #134#0 = #0nCam;
          |LEE 000#134=;
          |SI FSalida = 0;
               enBultos = 0;
               |ABRE #10;
               |BUCLELIN 2 Bultos #134;
               |CIERRA #10;
               |CIERRA #134;

               eaImprime = #0#146; |QBF eaImprime;
               ser_fac = #134#49;
               num_fac = #134#0;
               |SUB_EJECUTA_NP "agifa136";
          |FINSI;
          |CIERRA #134;
     |SIGUE;
|FPRC;

|PROGRAMA;
     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida = 0;
          aAlf1 = #0#146;
     |SINO;
          |GRABA 020#0b;
     |FINSI;
     |DDEFECTO #0;
     #0#146 = aAlf1;

     |CLS;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |HAZ Tipo3;
          |GRABA 020#0a;
     |FINSI;
     |CIERRA #0;
|FPRO;

|PROCESO verbultos; |TIPO 0;
     nCampo = Campo;
     qCampo = (nCampo/2) ! 0;
     dCampo = nCampo / 2;
     |SI qCampo = dCampo; |ACABA; |FINSI;
     |ABRE #10;
     qCampo = qCampo - 1;
     qCampo = qCampo + 149;
     qAlbar = nCampo + 1;
     #10#52 = #0qAlbar;
     #10#0  = #0nCampo;
     |LEE 000#10=;
     |SI  FSalida = 0;
          #0qCampo = #10#2;
     |FINSI;
     |PINTA #0qCampo;
     |CIERRA #10;
|FPRC;
