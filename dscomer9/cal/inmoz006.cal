|FICHEROS;
     inmoz006 #0;
     inmom001 #1;
     inmom008 #8;
|FINS;

|VARIABLES;
     &enError = 0;
     &enXls = 0;

     nSwCheq = 0;
     nError = 0;
     nHay = 0;
     aCbAnt = "";
     nLinAnt = 0;
     nPrime = 0;
     nInfor = 0;
     nImpre = 0;
|FIN;

|PROCESO Imprime;
     |SI nPrime = 0;
          nPrime = 1;
          |IMPRE 0;
          nImpre = FSalida;
          |SI FSalida ! 0; |ACABA; |FINSI;
          |INFOR "inmoz006";
          nInfor = FSalida;
          |SI FSalida ! 0;
               |MENAV "0000Error en informe 'inmoz006'";
          |FINSI;
     |FINSI;
     |SI nImpre = 0; |Y nInfor = 0;
          enError = nError;
          enXls = nLinAnt;
          |PRINT;
     |FINSI;
|FPRC;

|PROCESO inmom008;
     |SI nSwCheq = 1
          |SI aCbAnt = #8#1;
               nError = 1;
               |HAZ Imprime;
          |FINSI;
          aCbAnt = #8#1;
          nLinAnt = #8#2;

          #1#0 = #8#1;
          |LEE 000#1=;
          |SI FSalida = 0;
               nError = 2;
               |HAZ Imprime;
          |FINSI;
     |SINO;
          |DDEFECTO #1;
          #1#0 = #8#1;
          #1#2 = #8#3;
          #1#4 = #8#4;
          #1#18 = #8#5;
          #1#7 = #0#0;
          #1#28 = #8#7;
          #1#1 = #8#8;
          #1#33 = #8#9;
          #1#34 = #8#10;
          #1#35 = #8#11;
          #1#36 = #8#12;
          #1#37 = #8#13;
          #1#38 = #8#14;
          #1#39 = #8#15;

          |GRABA 020#1n;

          #8#6 = "P";
          |GRABA 020#8a;
     |FINSI;

     |LIBERA #8;
     nHay = 1;
|FPRC;

|DEFBUCLE inmom008;
     #8#1;
     6;
     #0#0, "                    ", 00000, " ";
     #0#0, "zzzzzzzzzzzzzzzzzzzz", 99999, " ";
     be;
     NULL, inmom008;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |ABRE #1;
     nSwCheq = 1;
     |BUCLE inmom008;
     |SI nError = 0;
          nSwCheq = 0;
          |BUCLE inmom008;
     |SINO;
          |SI nImpre = 0; |Y nInfor = 0;
               |PIEINF; |FININF; |FINIMP;
          |FINSI;
          |MENAV "0000Se han encontrado errores, proceso cancelado";
     |FINSI;
     |CIERRA #1;

     |SI nHay = 0;
          |MENAV "0000No hay registros a procesar...";
     |FINSI;
|FPRC;
