|FICHEROS;
 psion004 #98; || Cabecera revision psion.
 psion005 #99; || Lineas revision psion.
 agifa071 #0;  || LINEAS DE ALBARAN
 agifa010 #1;  || CABECERA DE ALBARAN
 agifa019 #2;  || ARTICULOS
 agifa024 #6;  || CLIENTES
 agifa017 #8;
 agifa065 #9;  || HISTORICO
 agifa038 #11;
 agifa025 #12; || REPRESENTANTES
 agifa048 #13;
 agifa049 #14;
 agifa142 #42; ||PARAMETROS GENERALES
 agifa321 #44;  || Divisas-Parametros.
 agifa324 #45;  || Divisas-Divisas.
 dsm00024 #24;
 psion030 #30;   || Ayuda a Ventas
 agifa023 #23;  || Cli/Art
 agifa020 #20;
 dsw00074 #74;
 agifa029 #29;
 cafe0013@;
|FIN;

|CAMPOS;
   #2#11 nec;     #2#15 sps;
   #2#16 spr;     #2#7 stmia;
   #2#104 stdia;  #2#17 pdva;
   #2#13 stfa;    #2#12 stres;
|FIN;

|INCLUYE i_varart;

|VARIABLES;
     nSwGuillen = 0;
     nSwAlbadis = 0;
     nSwJamaica = 0;
     &enIncPre = 0; || lo envia cafe0012
     &enIncRedo = 0;||
     nPre = 0;
     nRedo = 0;
     nDif = 0;
     nMulti = 0;
     aAlfa = "";
     nContaPromo = 0;
     nLinAnt = 0;
     &nDeci_IVA = 0;
     nUniEnt = 0;
     nUniSal = 0;
     nUniTot = 0;
     &enDescuento1 = 0;
     &enDescuento2 = 0;
     &eaTComision  = "";
     &enComision   = 0;
     &eaTag        = "";

 aSerie = "";
 aTipo  = "";
 nNume  = 0;
 nPrim  = 0;

 resto = 0;
 neto = 0;
 diferencia = 0;
 sw = 0;
 numero = "";
 vacio = "                    ";
 totalba = 0;
 descu = 0;
 tf = 0;
 pc = 0;
 pc1 = 0;
 imneto = 0;
 asto = 0;
 margen = 0;
 wimneto = 0;
 wmargen = 0;
operacion1 = "AV";
operacion2 = "BV";
operacion = "  ";
a = 0;
||modo = 0;
cantidad = 0;
articulo = " ";
fmes = "  ";
mes = 0;
me  = 0;
kl  = 0;
mescli = " ";
mensaje1 = "0000Esta linea proviene de un Pedido (use la opcion adecuada)";
mensaje2 = "0000Esta linea proviene de un Deposito (use la opcion adecuada)";
mensaje3 = "0410 Stock Disponible Almacen :             Stock Minimo : ";
mensaje4 = "0000 Supera el Stock disponible";
mensaje5 = "0000 Albaran para Exportacion. Tipo IVA = 0  !!!";
mensaje12 = "0000Este albaran esta FACTURADO";
totbu = 0;
flag = 0;
primera = 0;
swescan = 0;
alfa1 = "";
     &avisa_st = "S";
     &n_dec = 0;
     &n_pre = 0;
     &ext1 = "";
     sal_campo = 0;
     aviso = "";
     ok = "";
     tbruto = 0;
     &aMoneda = "";
     &aDivisa = "";
|FIN;

|CALCULO mirespor;
   |SI #6#28 = AS;|Y #0#11 ! 0;
       #0#11 = 0;
   |FINSI;
|FCAL;

|PROCESO ActPartida;
     |ABRE #24;
     #24#0 = #8#0;
     #24#1 = #8#1;
     #24#2 = #0#49;
     |LEE 101#24=;
     |SI FSalida ! 0; |GRABA 020#24b; |FINSI;
     #24#11 = #24#11 + nUniSal;
     #24#9 = #24#9 + nUniEnt;
     #24#22 = #24#22 + nUniTot;
     |HAZ ValoraStock;
     |SI #24#5 < #1#1;
          #24#5 = #1#1;
     |FINSI;
     |GRABA 020#24a;
     |CIERRA #24;
|FPRC;

|CALCULO defecli;
|ABRE #12;
#12#0 = #98#10;
|LEE 000#12=;
|SI FSalida ! 0;
    |GRABA 000#12c;
|FINSI;
|LIBERA #12;
|CIERRA #12;
#0#15 = #1#3;
#0#16 = #12#7;
#1#34 = #12#7;
#0#17 = #6#4;

|SI #0#2 ! #2#0;
    |ABRE #2;
    #2#0 = #0#2;
    |LEE 100#2=;
    |LIBERA #2;
    |CIERRA #2;
|FINSI;

#0#13 = #2#2;

|SI #0#15 ! #6#0;
    |ABRE #6;
    #6#0 = #0#15;
    |LEE 001#6=;
    |LIBERA #6;
    |CIERRA #6;
|FINSI;
|FCAL;

|CALCULO lisubcom;
    enDescuento1 = #0#8;
    enDescuento2 = #0#33;
    eaTComision  = #0#16;
    eaCliente    = #1#3;
    eaArticulo   = #0#2;
    eaRepre      = #1#6;
    |HAZ Comisiones;
    #0#10 = enComision;

    mes = imneto % #0#10;
    #1#26 = #1#26 + mes;
|FCAL;

|CALCULO totli;
/*
     |SI FSalida = 1;
         sal_campo = 1;
     |SINO;
         sal_campo = 0;
     |FINSI;
     #0#7 = #0#5 * #0#6;
     #0#9 = #0#7 < #0#8;
     #0#9 = #0#9 < #0#33;
     #0#9 = #0#9 ! #45#7;
*/
|FCAL;

|CALCULO liacarti;
   |HAZ defecli;

   |HAZ TotalLin71;

   imneto = #0#9 < #1#5;
   imneto = imneto < #1#32;
   imneto = imneto < #1#7;
   imneto = imneto ! #45#7;            || puesto el 01-02-90 .Javier

   |DDEFECTO #29;
   |ABRE #29;
   #29#0 = #0#3;
   |LEE 000#29=;
   |CIERRA #29;

   |DDEFECTO #2;
   |ABRE #2;
   #2#0 = #0#2;
   |LEE 101#2=;
   |SI FSalida ! 0; |GRABA 020#2b; |FINSI;

   |DDEFECTO #8;
   |ABRE #8;
   #8#0 = #0#2;
   #8#1 = #0#3;
   |LEE 101#8=;
   #8#40 = #2#1;
   #8#41 = #29#1;
   |SI FSalida ! 0; |GRABA 020#8b; |FINSI;

/****************************
   |SI #1#43 = AN;               || caso albaran
       stdia = stdia - #0#5;
       #2#6 = #2#6 - #0#5;
   |SINO;                        || caso abono
       stdia = stdia + #0#5;
       #2#6 = #2#6 + #0#5;
   |FINSI;
   asto = #2#6 - #2#17;
   |SI asto > 0;
       #2#10 = asto * #2#9;
   |SINO;
       #2#10 = 0;
   |FINSI;

   nec = sps + stmia; nec = nec - spr; nec = nec - stdia;
   nec = nec - pdva;  nec = nec - stfa;nec = nec - stres ;

   fmes = #1#1 % A402;
   mes = fmes - 1;
   mes = mes * 5;
   mes = mes + 34;
   |SI #1#43 = AN;              || caso albaran
       #2mes = #2mes + #0#5;
       margen = #0#5 * #2#9;
       #0#14 = margen; || coste de la linea
       margen = imneto - margen;
       #1#37 = #1#37 + margen;
       #2#94 = #2#94 + #0#5;

       #8#39 = #8#39 - #0#5;
       #8#5 = #8#5 - #0#5;
       asto = #8#5 - #8#4;
       |SI asto > 0;
           #8#3 = asto * #2#9;
       |SINO;
           #8#3 = 0;
       |FINSI;
       mes = fmes - 1;
       mes = mes * 2;
       mes = mes + 11;
       #8mes = #8mes + #0#5;
       #8#35 = #8#35 + #0#5;
   |SINO;                      || caso abono
       #2mes = #2mes - #0#5;
       margen = #0#5 * #2#9;
       #0#14 = margen; || coste de la linea
       margen = imneto - margen;
       #1#37 = #1#37 + margen;
       #2#94 = #2#94 - #0#5;

       #8#39 = #8#39 + #0#5;
       #8#5 = #8#5 + #0#5;
       asto = #8#5 - #8#4;
       |SI asto > 0;
           #8#3 = asto * #2#9;
       |SINO;
           #8#3 = 0;
       |FINSI;
       mes = fmes - 1;
       mes = mes * 2;
       mes = mes + 11;
       #8mes = #8mes - #0#5;
       #8#35 = #8#35 - #0#5;
   |FINSI;
   #2#24 = #1#1;
   #2#25 = #0#5;

   #8#50 = #8#42 + #8#6 - #8#43 - #8#39; || necesidades
   #8#50 = #8#50 - #8#4 - #8#9 - #8#8;

   |SI #1#43 = "N";
       nUniEnt = 0;
       nUniSal = #0#5;
   |SINO;
       nUniEnt = #0#5;
       nUniSal = 0;
   |FINSI;
   nUniTot = #0#5;
   |HAZ ActPartida;

   |GRABA 040#2a;
   |LIBERA #2;
   |GRABA 040#8a;
   |LIBERA #8;

   |HAZ altahis;
*****************************/
                    || 001928/00477 -> 18.05.2011
   enForma = 1;
   eaProgVta = "agifa010";
   |HAZ AcumulaAV;

||************

   |SI #1#43 = "N";
       enUniSal = #0#5;
       enUniVta = #0#5;
       enImpMar = margen;
   |SINO;
       enUniSal = -#0#5;
       enUniVta = -#0#5;
       enImpMar = -margen;
   |FINSI;

   efFecha = #1#1;
   eaArticulo = #0#2;
   enAlmacen = #0#3;
   |HAZ AcumulaArt;
   |HAZ AcumulaAlm;

   |LIBERA #8;
   |CIERRA #8;
   |LIBERA #2;
   |CIERRA #2;
|FCAL;

|CALCULO miraques;
|SI #1#43 = AN;
    a = -1;
    operacion = operacion1;
|SINO;
    a = 1;
    operacion = operacion2;
|FINSI;
|FCAL;

|CALCULO altahis;
     |ABRE #9;
     |DDEFECTO #9;
     #0#2 = #99#4;       || Cod. Articulos
     #9#0 = #0#2;
     #9#11= #0#29;
     #9#1 = #1#1;
     #9#2 = operacion;
     #9#3 = #0#0;
     #9#4 = #0#1;
     #9#5 = #0#3;        || almacen
     #9#6 = #0#5 *  a;   || stock
     #9#7 = #2#6;
     #9#8 = #2#9;
     #9#9 = #0#6;
     #1#3 = #98#4;       || Cod. Cliente
     #9#10 = #1#3;
     #9#12 = #0#8;
     #9#13 = #0#33;
     #9#14 = #0#6 < #9#12;
     #9#14 = #9#14 < #9#13;
     #9#18 = #0#49;
     |GRABA 121#9n;
     |LIBERA #9;
     |CIERRA #9;
     swescan = 1;
     |SI #42#12 = "S";
         |HAZ actualiz;
     |FINSI;
|FCAL;

|CALCULO altaescan;
|ABRE #9;
|DDEFECTO #9;
#9#0 = #14#2;
#9#11= #0#29;
#9#1 = #1#1;
#9#2 = operacion;
#9#3 = #0#0;
#9#4 = #0#1;
#9#5 = #0#3;        || almacen
#9#6 = #0#5 *  a * #14#4;   || stock
#9#7 = #2#6 - #0#5 * #14#4;
#9#8 = #2#9;
#9#9 = #0#6;
#9#10 = #1#3;
#9#12 = #0#8;
#9#13 = #0#33;
#9#14 = #0#6 < #9#12;
#9#14 = #9#14 < #9#13;
#9#18 = #0#49;
|GRABA 121#9n;
|LIBERA #9;
|HAZ artialta;
|FCAL;

||***************************** CALCULO ESCANDALLOS *******************;
|CALCULO linescan;
     #2#0 = #14#2;
     |LEE 140#2=;
     |LIBERA #2;
     |SI swescan = 1;
         |HAZ altaescan;
     |FINSI;
|FCAL;

|CALCULO actualiz;
        |ABRE #13;
        #13#0 = #0#2;
        |LEE 140#13=;
        |LIBERA #13;
        |SI FSalida = 0;
            #2#0 = #13#0;
            |LEE 140#2=;
            |LIBERA #2;
            |BUCLELIN 0linescan#13;
        |FINSI;
        |LIBERA #13;
        |CIERRA #13;
|FCAL;

|CALCULO artialta;
   mes = 0 + 1;
   wimneto = #0#9 < #1#5;
   wimneto = wimneto < #1#32;
   wimneto = wimneto < #1#7;
   wimneto = wimneto ! #45#7;            || puesto el 01-02-90 Javier

   |DDEFECTO #8;
   #8#0 = #14#2; ||Articulo;
   #8#1 = #14#9; ||Almacen;
   |LEE 140#8=;
   |LIBERA #8;
   |SI FSalida = 0;
       wimneto = (wimneto * #14#6) /  #13#9;
       cantidad = #0#5 * #14#4
       |SI #1#43 = AN;               || caso albaran
           stdia = stdia - cantidad;
           #2#6 = #2#6 - cantidad;
       |SINO;                        || caso abono
           stdia = stdia + cantidad;
           #2#6 = #2#6 + cantidad;
       |FINSI;
       asto = #2#6 - #2#17;
       |SI asto > 0;
           #2#10 = asto * #2#9;
       |SINO;
           #2#10 = 0;
       |FINSI;
       nec = sps + stmia; nec = nec - spr; nec = nec - stdia;
       nec = nec - pdva;  nec = nec - stfa;nec = nec - stres ;

       fmes = #1#1 % A402;
       mes = fmes - 1;
       mes = mes * 5;
       mes = mes + 34;
       |SI #1#43 = AN;              || caso albaran
           #2mes = #2mes + cantidad;
           margen = cantidad * #2#9;
           margen = wimneto - margen;
           mes = mes + 1;
           #2mes = #2mes + wimneto;
           mes = mes + 1;
           #2mes = #2mes + margen;

           #2#94 = #2#94 + cantidad;
           #2#95 = #2#95 + wimneto;
           #2#96 = #2#96 + margen;

           #8#39 = #8#39 - cantidad;
           #8#5 = #8#5 - cantidad;
           asto = #8#5 - #8#4;
           |SI asto > 0;
               #8#3 = asto * #2#9;
           |SINO;
               #8#3 = 0;
           |FINSI;
           mes = fmes - 1;
           mes = mes * 2;
           mes = mes + 11;
           #8mes = #8mes + cantidad;
           #8#35 = #8#35 + cantidad;
           enImpVta = wimneto;
           enImpMar = margen;
           enUniVta = cantidad;
           enUniSal = cantidad;
       |SINO;                      || caso abono
           #2mes = #2mes - cantidad;
           margen = cantidad * #2#9;
           margen = wimneto - margen;
           mes = mes + 1;
           #2mes = #2mes - wimneto;
           mes = mes + 1;
           #2mes = #2mes - margen;

           #2#94 = #2#94 - cantidad;
           #2#95 = #2#95 - wimneto;
           #2#96 = #2#96 - margen;

           #8#39 = #8#39 + cantidad;
           #8#5 = #8#5 + cantidad;
           asto = #8#5 - #8#4;
           |SI asto > 0;
               #8#3 = asto * #2#9;
           |SINO;
               #8#3 = 0;
           |FINSI;
           mes = fmes - 1;
           mes = mes * 2;
           mes = mes + 11;
           #8mes = #8mes - cantidad;
           #8#35 = #8#35 - cantidad;

           enImpVta = -wimneto;
           enImpMar = -margen;
           enUniVta = -cantidad;
           enUniSal = -cantidad;
       |FINSI;

       #8#50 = #8#42 + #8#6 - #8#43 - #8#39; || necesidades
       #8#50 = #8#50 - #8#4 - #8#9 - #8#8;

       |SI #1#43 = "N";
           nUniEnt = cantidad;
           nUniSal = 0;
       |SINO;
           nUniEnt = 0;
           nUniSal = cantidad;
       |FINSI;
       nUniTot = cantidad;
       |HAZ ActPartida;

       |GRABA 141#8a;
       |GRABA 141#2a;
       |LIBERA #8;
       |LIBERA #2;

       efFecha = #1#1;
       eaArticulo = #14#2;
       enAlmacen = #14#9;
       |HAZ AcumulaArt;
       |HAZ AcumulaAlm;
   |FINSI;
|FCAL;

|PROCESO linalb;
     numero = "";
     numero = "000000" + #99#1;
     numero = numero % -106;
     |SI numero ! #0#0; |O #99#2 ! #0#29;
         |SI sw = 1;
             |HAZ totalalb;
         |FINSI;
         nContaPromo = 0;
     |FINSI;

     sw = 1;
     |DDEFECTO #0;
     #0#0 = numero;      || Numero.
     #0#29 = #99#2;      || serie albaran
     |HAZ leecabeza;
     #0#1 = #99#3;       || Linea.
     #0#2 = #99#4;       || Cod. Articulo
     |ABRE #2;
     #2#0 = #99#4;
     |LEE 141#2=;
     |LIBERA #2;
     |CIERRA #2;
     #0#3 = #99#11;      || Almacen.
     #0#33 = #99#13;     || Dto2
     #0#4 = #99#5;       || Descripcion
     #0#5 = #99#6;       || Unidades
     #0#6 = #99#7;       || Precio
     |SI enIncPre ! 0; |Y nSwJamaica = 0;
          |HAZ IncrementaPre;
     |FINSI;
     #0#7 = #99#10;      || Importe
     #0#8 = #99#8;       || Dto
     #0#9 = 0;           || Importe total
     #0#11 = #99#9;      || Tipo iva
     #0#12 = 0;          || n.pedido
     #0#13 = #2#2;       || familia
     #0#14 = #2#9;       || coste
     |HAZ BusPartida;
     #0#49 = #99#12;
     #0#34 = #99#15;     || envase
     #0#35 = #99#16;     || uni envase
     #0#64 = #99#18;     || Importe Dto. Promo.
     |ABRE #98;
     #98#0 = #99#0;
     #98#1 = #99#1;
     #98#2 = #99#2;
     |LEE 141#98=;       || LEE CABECERA REVISION PSION
     |LIBERA #98;

     nContaPromo = nContaPromo + 1;
     |SI #98#38 = "S";   || Con Promocion
          nNume = nContaPromo $ 2;
          |SI nNume = 0;
               |SI #0#5 = 0; || Linea promocion sin unidades
                    |ACABA;
               |FINSI;
               |SALVA_FICHA #0;
               #0#1 = nLinAnt;
               |LEE 121#0=;
               |SI FSalida = 0;
                    #0#63 = #99#3;
                    #0#66 = #99#6;
                    |GRABA 020#0a;
               |FINSI;
               |REPON_FICHA #0;
               #0#63 = -1;
               #0#64 = 0;
          |SINO;
               nLinAnt = #0#1;
          |FINSI;
     |FINSI;

     |CIERRA #98;
     #0#15 = #98#4;      || cliente
     |HAZ totli;         || Calcula el total de la linea y albaran
     #0#36 = #0#6;
     #0#37 = #0#9;
     #0#38 = #0#6;
     #0#39 = #0#9;
     |ABRE #6;
     #6#0 = #98#4;
     |LEE 141#6=;
     |LIBERA #6;
     |CIERRA #6;
     #0#17 = #6#4;       || tipo cliente
     |HAZ miraques;
     |HAZ SacaKitPsion;
     |HAZ liacarti;
     |HAZ defecli;
     |HAZ lisubcom;
     |HAZ mirespor;
     |HAZ totli;
     |HAZ AyudaVta;
     |HAZ ActCliArt;
     |GRABA 141#0n;
     |LIBERA #0;
     |GRABA 141#1a;
     |LIBERA #1;
     |SI FSalida ! 0;
         aviso = "0000Linea " + #0#1 + " albaran / EXISTE";
     |FINSI;
     numero = #0
     tbruto = tbruto + #0#9;
|FPRC;

|DEFBUCLE leelin;
     #99#1;
     ;
     "A","     ",000000,000;
     "A","zzzzz",999999,999;
     be;
     NULL,linalb;
|FIN;

|PROCESO Lineas;
     |HAZ CalCabAgifa010;
|FPRC;

|DEFBUCLE Lineas;
     #0#1;
     ;
     #1#52, #1#0, 001;
     #1#52, #1#0, 999;
     ;
     NULL, Lineas;
|FIN;

|PROCESO totalalb;
     |SI nSwAlbadis = 0; |HAZ AlbaLinAutoAlta; |FINSI;
     |SI nSwGuillen = 0; |HAZ GuiLinAutoAlta; |FINSI;

     |HAZ LimCabAgifa010;
     |BUCLE Lineas;
     |GRABA 020#1a;
     eaTag = "AV";  |HAZ Riesgos;
|FPRC;

|PROCESO leecabeza;
     #1#52 = #0#29;
     #1#0  = #0#0;
     |LEE 121#1=;
     |SI FSalida = 0;
          |LIBERA #1;
          aMoneda = #1#70;
          aDivisa = #1#68;
          |HAZ Divisas010;
     |FINSI;
|FPRC;

|PROGRAMA;
     |HAZ EsJamaica; nSwJamaica = FSalida;
     |HAZ EsAlbadis; nSwAlbadis = FSalida;
     |HAZ EsGuillen; nSwGuillen = FSalida;

     |ABRE #42; |LEE 000#42p; |CIERRA #42;
     ||modo = 1;
     |ABRE #0;
     |ABRE #1;
     |BUCLE leelin;
     |SI sw ! 0;
          |HAZ totalalb;
     |FINSI;
     |CIERRA #0;
     |CIERRA #1;
|FPRO;

|PROCESO AyudaVta;
     |ABRE #30;
     |DDEFECTO #30;
     #30#0 = #1#3;
     #30#1 = #1#84;
     #30#2 = #0#2;
     |LEE 101#30=;
     |SI FSalida ! 0; |GRABA 020#30b; |FINSI;
     #30#3 = #1#1;
     #30#4 = #0#4;
     #30#5 = #0#5;
     #30#6 = #0#6;
     #30#7 = #0#8;
     #30#8 = #30#8 + #30#5;
     |GRABA 020#30a;
     |CIERRA #30;
|FPRC;

|PROCESO Confirma;
     |SI #42#79 = "S";
          FSalida = 0;
     |SINO;
          #74#0 = #0#2;
          #74#1 = #0#4;
          #74#2 = #1#3;
          #74#3 = #1#4;
          #74#4 = #23#2;
          #74#5 = #23#32;
          #74#6 = #0#6;
          #74#7 = #0#8;
          |SI #74#4 = #74#6; |Y #74#5 = #74#7;
               FSalida = 1;
          |SINO;
               |PUSHV 05012380;
               |CLS;
               |PINPA #0#74;
               |PINDA #0#74;
               |CONFI "0000NActualizar Precio y Dto Cliente/Articulo:";
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO ActCliArt;
     |SI #42#79 = "N"; |ACABA; |FINSI;

     |DDEFECTO #23;
     |ABRE #23;
     #23#0 = #1#3;
     #23#1 = #0#2;
     |LEE 101#23=;
     |SI FSalida = 0;
          |HAZ Confirma;
          |SI FSalida = 0;
               #23#2 = #0#6;
               #23#32 = #0#8;
               |GRABA 020#23a;

               |DDEFECTO #20;
               |ABRE #20;
               #20#0 = #23#0;
               |LEE 000#20=;
               |SI FSalida ! 0; |GRABA 020#20n; |FINSI;
               |CIERRA #20;
          |FINSI;
     |SINO;
          |HAZ Confirma;
          |SI FSalida = 0;
               #23#2 = #0#6;
               #23#32 = #0#8;
               #23#34 = #0#4;
               |GRABA 020#23n;

               |DDEFECTO #20;
               |ABRE #20;
               #20#0 = #23#0;
               |LEE 000#20=;
               |SI FSalida ! 0; |GRABA 020#20n; |FINSI;
               |CIERRA #20;
          |FINSI;
     |FINSI;
     |CIERRA #23;
|FPRC;

|PROCESO IncrementaPre;  || Modulo 001901
     |DDEF aAlfa;
     aAlfa = aAlfa + "cafe0013";
     |CARGA_DEF aAlfa, cafe0013@;
     |SI FSalida ! 0; |ACABA; |FINSI;
          |ABRE #cafe0013@;
          #cafe0013@#0 = #0#2;
          |LEE 000#cafe0013@.=;
          |SI FSalida = 0;
          nPre = #0#6 + (#0#6 * enIncPre / 100);
          |SI enIncRedo ! 0;
               aAlfa = "0" * 2; || * 2 poque #cafe0012#6 tiene 2 decimales
               aAlfa = "1" + aAlfa;
               nMulti = aAlfa;
               nRedo = enIncRedo * nMulti;
               nPre = (nPre * nMulti) ! 0;
               nDif = nPre $ nRedo;
               |SI nDif ! 0;
                    nPre = nPre + (nRedo - nDif);
               |FINSI;
               nPre = nPre / nMulti;
          |FINSI;
          #0#6 = nPre;
     |FINSI;
     |CIERRA #cafe0013@;
     |DESCARGA_DEF #cafe0013@;
|FPRC;
