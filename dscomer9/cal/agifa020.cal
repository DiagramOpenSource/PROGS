|FICHEROS;
     agifa020 #0;  ||Este Def.
     agifa023 #1;  ||Tarifa Clientes/Articulos
     agifa019 #19;  ||Articulos
     agifa024 #24; ||Cliente
     agifa321 #321;
     agifa324 #324;
|FIN;

|VARIABLES;
     nNume = 0;
     aMensaje = "";
     aAlfa = "";
     &nDeci_PreVis  = 0;
     &precio_divisa  = 0;
     &precio_base    = 0;
     &decim_base     = 0;
|FIN;


|PROCESO agifa023;
     #0#0 = #1#0;
     |LEE 101#0=;
     |SI FSalida ! 0;
          |GRABA 020#0n;
     |FINSI;
     |LIBERA #0;
     #19#0 = #1#1;
     |LEE 000#19=;
     #1#35 = #19#1;
     |GRABA 020#1a;
|FPRC;


|DEFBUCLE agifa023;
     #1#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL,agifa023;
|FIN;

|PROCESO cargadat; |TIPO 8;
     |ABRE #0;
     |ABRE #19;
     |LEE 000#0p;
     |SI FSalida = 0; |CIERRA #0; |ACABA; |FINSI;
     |BUCLE agifa023;
     |CIERRA #0;
     |CIERRA #19;
|FPRC;

|PROCESO LeeMon0; |TIPO 0; ||Lee los parametros de la moneda base
     |HAZ LeeMon;
|FPRC;

|PROCESO LeeMon; |TIPO 13; ||Lee los parametros de la moneda base
     |ABRE #24;
     |SELECT #1#24;
     #24#0 = #0#0;
     |LEE 000#24=;
     |CIERRA #24;

     |C_A #24#1, 0, nNume;
     |C_A #24#1, 1, 57;
     |ATRI I;
     |PINTA 722, #24#1;
     |C_A #24#1, 1, nNume;

     |HAZ LeeMonBase;
     |ABRE #agifa324;
     |SI #0#1 = "S";
          #agifa324#0 = #0#2;
     |SINO;
          #agifa324#0 = #24#192;
     |FINSI;
     |LEE 001#agifa324.=;          || Leo la divisa
     |CIERRA #agifa324;
     precio_divisa = #agifa324#9;  || Decimales en el precio de la divisa

     |SI #24#193 = "B";           || Si trabajo con la moneda base ...
          nDeci_PreVis   = precio_base;
     |SINO;                        || Si trabajo con la divisa ...
          nDeci_PreVis   = precio_divisa;
     |FINSI;

     |ATRI R;
     |SI #0#1 = "N";
          |PINTA 1048, "      Precio";
     |SINO;
          aAlfa = " Precio(" + #0#2 + ")";
          |PINTA 1048, aAlfa;
     |FINSI;
     |ATRI 0;
|FPRC;

|PROCESO LeeMonBase; ||Lee los parametros de la moneda base
     |ABRE #agifa321;
     |ABRE #agifa324;
     |LEE 010#agifa321.p;         ||Leo parametros de divisa
     #agifa324#0 = #agifa321#9;
     |LEE 010#agifa324.=;         ||Leo la ficha de la moneda base en Divisas
     decim_base = #agifa324#7;    ||Asigno los decimales de la moneda base
     precio_base = #agifa324#9;   ||Asigno los decimales del precio en la mon. base
     |CIERRA #agifa324;
     |CIERRA #agifa321;
|FPRC;

|PROCESO Divisa7; |TIPO 7;
     |SI #0#1 = "N";
          |C_M #0#2, 1, "N";
          #0#2 = ""; |PINTA #0#2;
     |SINO;
          |C_M #0#2, 1, "S";
          |SI #0#2 = "   ";
               #0#2 = #321#9;
          |FINSI;
     |FINSI;
|FPRC;
