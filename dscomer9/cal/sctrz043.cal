|FICHEROS;
     sctrz043 #0;
     sctrm021 #21;
     sctrm022 #22;
     sctrm052 #52;
     sctrm046 #46;
     sctrm057 #57;
     sctrm001 #100;
|FIN;

|VARIABLES;
     &eaNomLogo = "";
     &enPantaLogo = 0;
     &enTipo = 0;
     nPanta = 0;
     aAlfa = "";
     aInforme = "";
     &enTiva = 0;
     &efFiva = @;
     &enIva = 0;
     &eaDiva = "";
     fFecha = @;
|FIN;

|PROCESO TrayectoKms;
     |SELECT #2#21;
     #21#2 = #52#8;
     #21#4 = #52#12;
     |LEE 000#21=;
     |SI FSalida ! 0;
          #21#2 = #52#12;
          #21#4 = #52#8;
          |LEE 000#21=;
     |FINSI;
     |SI FSalida ! 0;
          |DDEFECTO #21;
          |DDEFECTO #22;
     |SINO;
          |SELECT #2#22;
          #22#0 = #21#0;
          #22#1 = #21#2;
          #22#2 = #21#4;
          #22#4 = #100#23;
          |LEE 000#22=;
          |SI FSalida ! 0; |DDEFECTO #22; |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tiva;
     enTiva = #100#24;
     efFiva = fFecha;
     |HAZ SacaIVA;
     |SI eaDiva = "";
          aAlfa = "0000No existe tipo iva para esta fecha:" + fFecha;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO Reservas_3;
     #46#0 = #52#4;
     |LEE 000#46=;
     |SI FSalida = 0; |Y #46#16 = #0#0;
          fFecha = #52#117; |HAZ Tiva;
          |HAZ TrayectoKms;
          enTipo = 3;
          |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE Reservas_3;
     #52#7;
     3, 127, 6, 160;
     #0#6, 0000000, #0#4, #0#2, 1, #0#8;
     #0#7, 9999999, #0#5, #0#3, 2, #0#9;
     ;
     NULL, Reservas_3;
|FIN;

|PROCESO Reservas_2;
     #46#0 = #52#4;
     |LEE 000#46=;
     |SI FSalida = 0; |Y #46#16 = #0#0;
          fFecha = #52#64; |HAZ Tiva;
          |HAZ TrayectoKms;
          enTipo = 2;
          |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE Reservas_2;
     #52#6;
     3, 4, 6, 160;
     #0#6, 0000000, #0#4, #0#2, 1, #0#8;
     #0#7, 9999999, #0#5, #0#3, 2, #0#9;
     ;
     NULL, Reservas_2;
|FIN;

|PROCESO Reservas_1;
     #46#0 = #52#4;
     |LEE 000#46=;
     |SI FSalida = 0; |Y #46#16 = #0#0;
          fFecha = #52#1; |HAZ Tiva;
          |HAZ TrayectoKms;
          enTipo = 1;
          |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE Reservas_1;
     #52#5;
     3, 4, 6, 160;
     #0#6, 0000, 0000000, #0#4, #0#2, 1, #0#8;
     #0#7, 9999, 9999999, #0#5, #0#3, 2, #0#9;
     ;
     NULL, Reservas_1;
|FIN;

|PROCESO T3; |TIPO 3;
     aInforme = #57#10; |QBF aInforme;
     Impresora = "CrystalReport";
     |IMPRE -1;
     |SI FSalida = 0;
          |INFOR aInforme;
          |SI FSalida = 0;
               |ABRE #46;
               |ABRE #21;
               |ABRE #22;
               |BUCLE Reservas_1;
               |BUCLE Reservas_2;
               |BUCLE Reservas_3;
               |CIERRA #22;
               |CIERRA #21;
               |CIERRA #46;
               |PIEINF;
               |FININF;
          |SINO;
               aAlfa = "0000Error en informe '" + aInforme + "'...";
               |MENAV aAlfa;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO LogoPanta;
     eaNomLogo = #100#1;
     |HAZ TraeLogoPan;
     enPantaLogo = nPanta;
     |HAZ PintaLogoPan;
|FPRC;

|PROGRAMA;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     |ABRE #57; |LEE 000#57p; |CIERRA #57;
     |PINPA #0#0; nPanta = FSalida;
     |PINDA #0#0;
     |HAZ LogoPanta;
     |ENDATOS #1#0;
|FPRO;
