|FICHEROS;
     guerz012 #0;
     guerw021 #21,MANTE;  ||Tmp
     guerm025 #25;
     goparame #10;
     cacuenta@ #1;
     agifa142 #142;
     dsm00054 #54;
     dsm00055 #55;
|FIN;

|VARIABLES;
     aAlfa = "";
     &eaFicImpre = "";
     &eaPrograma = "";
     &Tempo    = "";
     nHay      = 0;
     nAlmaObra = 0;
     nAlmaComp = 0;
     nAlmaDepo = 0;
     nConta    = 0;
     fFecha    = @;
     nLin      = 0;
     nUni      = 0;
     i         = 0;

     &xSerie        = "";
     &xCodArti      = "";
     &xDesArti      = "";
     &xDocTras      = 0;
     &xLinDocu      = 0;
     &xCanArti      = 0;
     &xAlmEntr      = 0;
     &xAlmSali      = 0;
     &xForma        = 0;
     &xFecDocu      = @;

     &enEvento = 1;
     &eaTipo   = "";
     &eaAsunto = "";
     &eaOrigen = "";
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Tmp;
     |SI #21#14 ! "*"; |ACABA; |FINSI;

     #25#0 = #21#0;
     #25#1 = #21#1;
     |BORRA 020#25c;

     xForma = 1;
   ||xDocTras
     xLinDocu = 0;
     xSerie   = #0#0;
     xFecDocu = fFecha;
     xCodArti = #21#7;
     xDesArti = #21#8;
     xAlmEntr = nAlmaComp;
     xAlmSali = nAlmaDepo;
     xCanArti = #21#9;
     |SUB_EJECUTA_NP "gomoval1";

     enEvento = 7; eaTipo = "07";
     eaAsunto = "Modificacion Reserva Almacen. '" + #25#0 + "/" + (("000000" + #25#1) % -106);
     eaAsunto = eaAsunto + "' por Usuario: '" + (Usuario % 810);
     eaOrigen = #25#13;
     eaPrograma = "guerz012" + xSerie + xDocTras;
     |HAZ FicEnvio;
     |HAZ EnviaEvento;
|FPRC;

|DEFBUCLE Tmp;
     #21#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp;
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO guerm025;
     nHay = 1;
     |PARA i = 0; |SI i [ 13; |HACIENDO i = i + 1;
          #21i = #25i;
     |SIGUE;
     |GRABA 020#21n;
|FPRC;

|DEFBUCLE guerm025;
     #25#3;
     ;
     "                    ", #0#0, #0#1;
     "zzzzzzzzzzzzzzzzzzzz", #0#0, #0#1;
     ;
     NULL, guerm025;
|FIN;

|PROCESO Tecla; |TIPO 0;
     |SI FSalida = 0;
          |SI #21#14 = "*";
               #21#14 = "";
          |SINO;
               #21#14 = "*";
          |FINSI;
          |GRABA 020#21a;
          |PINTA #21#14;
     |FINSI;
|FPRC;

|PROCESO Min;
     #21#7 = "                    ";
|FPRC;

|PROCESO Max;
     #21#7 = "zzzzzzzzzzzzzzzzzzzz";
|FPRC;

|PROCESO Inicio; |TIPO 3;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;
     |ABRE #10; |LEE 000#10p; |CIERRA #10;
     fFecha = ~;
     nAlmaObra = #0#0;
     nAlmaComp = #10#22;
     nAlmaDepo = #10#51;

     |HAZ CreaTempo; |NOME_DAT #21 Tempo; |DELINDEX #21;
     |ABRE #21;
     |BUCLE guerm025;
     |CIERRA #21;

     |SI nHay ! 0;
          |PINPA #0#21;
          |ENTLINEAL #2#21, 1, 4, 22, 0, Min, Max;

          |CONFI "0000NEs Correcto";
          |SI FSalida = 0;
               |ABRE #25;
               |BUCLE Tmp;
               |CIERRA #25;
          |FINSI;
     |FINSI;

     |DELINDEX #21; |HAZ BoraTempo;
|FPRC;

|PROCESO dsm00055Imp;
     |PRINT;
|FPRC;

|DEFBUCLE dsm00054;
     #54#1;
     ;
     xSerie, xDocTras;
     xSerie, xDocTras;
     ;
     NULL, NULL, dsm00055Imp;
|FIN;

|PROCESO FicEnvio;
     |DBASS aAlfa;
     eaFicImpre= aAlfa + "spool/";
     aAlfa = Usuario;
     eaFicImpre = eaFicImpre + aAlfa;
     Impresora = eaFicImpre;
     |IMPRE -77;
     |SI FSalida = 0;
          |INFOR "dsm00054";   ||*Correo
          |SI FSalida = 0;
               |BUCLE dsm00054;
               |PIEINF;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
