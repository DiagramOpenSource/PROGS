|FICHEROS;
     marhu329 #0;
     marhu329@ #1;
     agifa010 #10;
     agifa059 #59;
     agifa024 #24;
     marhu343 #343;
     marhu344 #344;
|FIN;

|VARIABLES;
     &Tempo    = "";
     aTempo0   = "";
     nLin      = 0;
     aAlfa     = "";
     aInforme  = "marhu329";
     i         = 0;
|FIN;

|PROCESO Registro;
     #343#0 = #0#3;
     |LEE 000#343=;
     |SI FSalida ! 0; |GRABA 020#343n; |FINSI;

     #344#0 = #343#0;
     #344#1 = 9999;
     |LEE 000#344];
     |SI FSalida = 0;
          |LEE 000#344a;
     |SINO;
          |LEE 000#344u;
     |FINSI;
     |SI FSalida = 0; |Y #344#0 = #343#0;
          nLin = #344#1 + 1;
     |SINO;
          nLin = 1;
     |FINSI;
     |DDEFECTO #344
     #344#0 = #343#0;
     #344#1 = nLin;
     #344#2 = #0#1;
     #344#3 = #0#2;
     #344#4 = #0#6;
     #344#5 = #0#7;
     #344#6 = "S";
     |GRABA 020#344n;
|FPRC;

|PROCESO marhu329;
     |HAZ Registro;

     #24#0 = #0#7;
     |LEE 000#24=;
     |SI FSalida ! 0; |DDEFECTO #24; |FINSI;

     #59#14 = #0#1;
     #59#0 = #0#2;
     #59#1 = 1;
     |LEE 000#59];
     |PARA; |SI FSalida = 0; |Y #59#14 = #0#1; |Y #59#0 = #0#2; |HACIENDO;
          #10#52 = #59#15;
          #10#0 = #59#2;
          |LEE 121#10=;
          |SI FSalida = 0;
               #10#2 = #0#4;       || Bultos
               |GRABA 020#10a;
               |LIBERA #10;
          |FINSI;
          |LEE 000#59s;
     |SIGUE;

     |PARA i = 1; |SI i [ #0#4; |HACIENDO i = i + 1;
          |PRINT; |PIEINF;
     |SIGUE;
|FPRC;

|DEFBUCLE marhu329;
     #0#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, marhu329;
|FIN;

|PROCESO Tipo2; |TIPO 2;
     #1#1 = #0#1;
     #1#2 = #0#2;
     |LEE 000#1=;
     |SI FSalida = 0;
          aAlfa = "0000Factura introducida en linea [" + #1#0 + "]";
          |MENAV aAlfa;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Min;
     #0#0 = 1;
|FPRC;

|PROCESO Max;
     #0#0 = 999;
|FPRC;

|PROGRAMA;
     |DBASE aAlfa;
     aAlfa = aAlfa + "def/marhu329";
     |CARGA_DEF aAlfa, marhu329@;
     |SI FSalida = 0;
          |HAZ CreaTempo; aTempo0 = Tempo;
          |NOME_DAT #0 aTempo0; |DELINDEX #0;
          |NOME_DAT #1 aTempo0;

          |ABRE #1;
          |SELECT #2#1;
          |CLS;
          |PINPA #0#0;
          |ENTLINEAL #1#0, -1, 1, 22, 0, Min, Max;
          |CIERRA #1;

          |CONFI "0000SImprimir estiquetas";
          |SI FSalida = 0;
               |PUSHV 0501 2380;
               |BLANCO 1028 1653;
               |CUADRO 1028 1653;
               |CUADRO 1129 1552;
               |ATRI I; |PINTA 1331, "Informe: "; |ATRI 0;
               E_inf = "";
               E_sup = 8;
               aInforme = 1341 ? 0; |QBF aInforme;
               |POPV;
               |IMPRE 0;
               |SI FSalida = 0;
                    |INFOR aInforme;
                    |SI FSalida = 0;
                         |ABRE #59;
                         |ABRE #10;
                         |ABRE #343;
                         |ABRE #344;
                         |BUCLE marhu329;
                         |CIERRA #343;
                         |CIERRA #344;
                         |CIERRA #59;
                         |CIERRA #10;
                         |PIEINF;
                         |FININF;
                    |FINSI;
                    |FINIMP;
               |FINSI;
          |FINSI;
          |DESCARGA_DEF #marhu329@;
          |DELINDEX #0; Tempo = aTempo0; |DELINDEX #0;
     |SINO;
          aAlfa = "0000ERROR al cargar " + aAlfa;
          |MENAV aAlfa;
     |FINSI;
|FPRO;
