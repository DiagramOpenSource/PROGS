|FICHEROS;
     champ010 #0;
     champ011 #11,MANTE;
     champ012 #12,MANTE;
     agifa017 #17;
     agifa019 #19;
     dsm00043 #43;
     dsm00044 #44;
|FIN;

|VARIABLES;
     &enForma = 0;
     &enCodigo = 0;
     &eaArticulo = "";
     &Tempo = "";
     &aDivisa = "";
     &aMoneda = "";
     aTmp11 = "";
     aTmp12 = "";
     nUni = 0;
     nModo = 0;
     aAlfa = "";
     nLin = 0;
     aSerie = "";
     {-1}aMenu = "";
     aMenu1 = "2400";
     aMenu2 = "1";
     aMenu3 = "Opciones: ";
     aMenu4 = "RAC";
     aMenu5 = " Repasar ";
     aMenu6 = " Aceptar ";
     aMenu7 = " Cancelar ";
|FIN;

|PROCESO LlenaArti; |TIPO 6;
     eaArticulo = #0Campo;
     |HAZ LlenaArticulo;
     |SI FSalida = 0;
          #0Campo = eaArticulo;
          |PINTA #0Campo;
     |SINO;
          |ERROR; |ACABA;
     |FINSI;
|FPRC;

|PROCESO Tmp12;
     |SI #12#5 > 0;
          #19#0 = #12#3;
          |LEE 000#19=;
          |SI FSalida ! 0; |DDEFECTO #19; |FINSI;

          #17#0 = #12#3;
          #17#1 = #12#2;
          |LEE 000#17=;
          |SI FSalida ! 0; |DDEFECTO #17; |FINSI;

          nLin = nLin + 1;
          #44#21 = #43#4;
          #44#18 = #43#0;
          #44#8 = nLin;

          #44#0 = #12#3;
          #44#1 = #12#2;
          #44#2 = #19#1;
          #44#3 = #17#39;
          #44#4 = #12#5;
          #44#5 = #43#1;
          #44#6 = #19#6;
          #44#7 = "E";
          #44#19 = #17#5;
          #44#20 = #19#104;
          |GRABA 020#44n;
          enForma = 1;
          enCodigo = #44#18;
          |HAZ AcumulaES_SS;
     |FINSI;
|FPRC;

|DEFBUCLE Tmp12;
     #12#1;
     ;
     #11#0, 1;
     #11#0, 99999;
     ;
     NULL, Tmp12;
|FIN;

|PROCESO Tmp11;
     |SI #11#5 > 0;
          #19#0 = #11#2;
          |LEE 000#19=;
          |SI FSalida ! 0; |DDEFECTO #19; |FINSI;

          #17#0 = #11#2;
          #17#1 = #11#1;
          |LEE 000#17=;
          |SI FSalida ! 0; |DDEFECTO #17; |FINSI;

          nLin = nLin + 1;
          #44#21 = #43#4;
          #44#18 = #43#0;
          #44#8 = nLin;

          #44#0 = #11#2;
          #44#1 = #11#1;
          #44#2 = #19#1;
          #44#3 = #17#39;
          #44#4 = #11#5;
          #44#5 = #43#1;
          #44#6 = #19#6;
          #44#7 = "S";
          #44#19 = #17#5;
          #44#20 = #19#104;
          |GRABA 020#44n;
          enForma = 1;
          enCodigo = #44#18;
          |HAZ AcumulaES_SS;

          |BUCLE Tmp12;
     |FINSI;
|FPRC;

|DEFBUCLE Tmp11;
     #11#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp11;
|FIN;

|PROCESO Actualiza;
     |ABRET #17;
     |ABRE #43;
     |ABRE #44;
     #43#4 = aSerie; aSerie = #43#4;
     #43#0 = 999999;
     |LEE 000#43];
     |SI FSalida = 0;
          |LEE 000#43a;
     |SINO;
          |LEE 000#43u;
     |FINSI;
     |SI FSalida = 0; |Y #43#4 = aSerie;
          nLin = #43#0 + 1;
     |SINO;
          nLin = 1;
     |FINSI;
     |DDEFECTO #43;
     #43#4 = aSerie;
     #43#0 = nLin;
     #43#1 = #0#0;
     #43#2 = "Transformacion";
     |GRABA 020#43b;
     nLin = 0;
     |BUCLE Tmp11;
     |SI nLin = 0; |BORRA 020#43c; |FINSI;
     |CIERRA #44;
     |CIERRA #43;
     |CIERRAT #17;
|FPRC;

|PROCESO Cuenta;
     nUni = nUni + #12#5;
|FPRC;

|DEFBUCLE Cuenta;
     #12#1;
     ;
     #11#0, 1;
     #11#0, 99999;
     ;
     NULL, Cuenta;
|FIN;

|PROCESO Borra12;
     |BORRA 020#12a;
|FPRC;

|DEFBUCLE Borra12;
     #12#1;
     ;
     #11#0, 1;
     #11#0, 99999;
     ;
     NULL, Borra12;
|FIN;

|PROCESO Min12;
     #12#0 = #11#0;
     #12#1 = 1;
|FPRC;

|PROCESO Max12;
     #12#0 = #11#0;
     #12#1 = 99999;
|FPRC;

|PROCESO Tipo2; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
          |BUCLE Borra12;
     |SINO;
          |SI #11#5 > 0;
               |ABRE #12;
               #12#0 = #11#0;
               #12#1 = 1;
               |LEE 000#12];
               |SI FSalida ! 0; |O #12#0 ! #11#0;
                    #19#0 = #11#6;
                    |LEE 000#19=;
                    |SI FSalida ! 0; |DDEFECTO #19; |FINSI;
                    |DDEFECTO #12;
                    #12#0 = #11#0;
                    #12#1 = 1;
                    #12#2 = #0#1;
                    #12#3 = #19#0;
                    #12#4 = #19#1;
                    #12#5 = #11#5;
                    |GRABA 020#12n;
               |FINSI;
               |PUSHV 0501 2380;
               |PINPA #0#12;
               |PARA; |SI; |HACIENDO;
                    |ENTLINEAL #1#12, 2, 2, 22, 0, Min12, Max12;
                    nUni = 0;
                    |BUCLE Cuenta;
                    |SI nUni ! #11#5;
                         aAlfa = "0000NTransformadas:" + #11#5 + " introducidas:" + nUni + ". ¿Continuar?";
                         |CONFI aAlfa;
                         |SI FSalida = 0; |SAL; |FINSI;
                    |SINO;
                         |SAL;
                    |FINSI;
               |SIGUE;
               |POPV;
               |CIERRA #12;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO agifa017;
     |SI #17#5 > 0;
          #19#0 = #17#0;
          |LEE 000#19=;
          |SI FSalida ! 0; |DDEFECTO #19; |FINSI;
          nLin = nLin + 1;
          #11#0 = nLin;
          #11#1 = #17#1;
          #11#2 = #17#0;
          #11#3 = #19#1;
          #11#4 = #17#5;
          #11#6 = #19#112;
          |GRABA 020#11n;
     |FINSI;
|FPRC;

|DEFBUCLE agifa017;
     #17#1;
     ;
     #0#2, #0#1;
     #0#3, #0#1;
     ;
     NULL, agifa017;
|FIN;

|PROCESO Min11;
     #11#0 = 1;
|FPRC;

|PROCESO Max11;
     #11#0 = 99999;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |HAZ CreaTempo; |NOME_DAT #11 Tempo; aTmp11 = Tempo; |DELINDEX #11;
     |HAZ CreaTempo; |NOME_DAT #12 Tempo; aTmp12 = Tempo; |DELINDEX #12;
     |ABRE #11;
     |ABRE #12;
     |ABRET #19;
     |BUCLE agifa017;
     |LEE 000#11];
     |SI FSalida = 0;
          |PINPA #0#11;
          |PARA; |SI; |HACIENDO;
               |ENTLINEAL #1#11, 1, 2, 22, 0, Min11, Max11;
               |MENU aMenu;
               |SI FSalida = 2; |HAZ Actualiza; |SAL; |FINSI;
               |SI FSalida = 3; |SAL; |FINSI;
          |SIGUE;
     |SINO;
          |MENAV "0000No hay registros...";
     |FINSI;
     |CIERRAT #19;
     |CIERRA #11; Tempo = aTmp11; |HAZ BoraTempo; |DELINDEX #11;
     |CIERRA #12; Tempo = aTmp12; |HAZ BoraTempo; |DELINDEX #12;
|FPRC;
