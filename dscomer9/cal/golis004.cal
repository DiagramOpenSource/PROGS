|FICHEROS;
     golis004 #0;
     gotrabaj #1;
     gopre001 #2;
     goptrbli #5;
     gomantho #6;
     guerm017 #17;
     guerm018 #18;
     guerm019 #19;
     guerw025 #25;  ||Tmp

     gopartia #10;
     gopartca #20;
     gopartll #21;
     gopartli #22;
     goptrbca #23;
|FIN;

|VARIABLES;
     aInforme1 = "golis004";
     aInforme2 = "golis0a4";
     aInforme  = "";
     i         = 0;
     aAlfa     = "";
     nConta    = 0;
     nHP       = 0;
     nHA       = 0;
     nHE       = 0;
|FIN;

|PROCESO Impre;
     nConta = 1;
     |DDEFECTO #6;
     #6#0 = #25#13;
     #6#1 = #25#14;
     |LEE 000#6=;
     |PRINT;
|FPRC;

|DEFBUCLE Tmp;
     #25#2;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Impre;
|FIN;

|PROCESO guerm018;
     |SI #18#10 < #0#6; |O #18#10 > #0#7; |ACABA; |FINSI; ||Exp.
     |SI #18#11 < #0#9; |O #18#11 > #0#10; |ACABA; |FINSI; ||Exp.

     |DDEFECTO #1;
     #1#0 = #17#3;
     |LEE 000#1=;
     |SI #1#3 < #0#4; |O #1#3 > #0#5; |ACABA; |FINSI; ||Cate

     |DDEFECTO #19;
     #19#0 = #17#0;
     |LEE 000#19=;
     |SI #19#2 ! "M"; |ACABA; |FINSI;

     |DDEFECTO #2;
     #2#15 = #18#10;
     #2#16 = #18#11;
     |LEE 000#2=;

     nHP = 0; nHA = 0; nHE = 0;
     |SI #2#18 = "P"; nHP = #18#5; |FINSI;
     |SI #2#18 = "A"; nHA = #18#5; |FINSI;
     |SI #2#18 = "E"; nHE = #18#5; |FINSI;

     |SI #0#8 = "N";
          nConta = nConta + 1;
     |FINSI;
     |DDEFECTO #25;
     #25#0 = nConta;
     #25#1 = #17#1;
     #25#2 = #17#3;
     |LEE 101#25=;
     |SI FSalida ! 0; |GRABA 020#25b; |FINSI;
     #25#3 = #1#1;
     #25#4 = #1#3;
     #25#5 = #1#25;
     #25#6 = #18#9;
     #25#7 = #25#7 + nHA;
     #25#8 = #25#8 + nHP;
     #25#9 = #25#9 + nHE;
     #25#10 = #25#10 + nHA + nHP + nHE;
     #25#11 = #25#11 + (#18#6 * (nHA + nHP + nHE));
     #25#12 = #25#12 + (#18#16 * (nHA + nHP + nHE));
     #25#13 = #18#10;
     #25#14 = #18#11;
     #25#15 = #17#12;
     |GRABA 020#25a;
     |LIBERA #25;
|FPRC;

|DEFBUCLE guerm017;
     #17#2;
     ;
     #0#2, #0#0;
     #0#3, #0#1;
     ;
     NULL, NULL, guerm018;
|FIN;

|PROCESO gopartia;
     #25#12 = #25#12 + #10#25;
|FPRC;

|DEFBUCLE gopartia;
     #10#1;
     ;
     "T", #23#15, #23#3, #5#3, 1;
     "T", #23#15, #23#3, #5#3, 999;
     ;
     NULL, gopartia;
|FIN;

|PROCESO goptrbli;
     |SI #5#4 < #0#0; |O #5#4 > #0#1; ||Trabajador=Operario
          |ACABA;
     |FINSI;
     |SI #5#6 < #0#4; |O #5#6 > #0#5; ||Categoria
          |ACABA;
     |FINSI;

     |SI #0#8 = "N";
          nConta = nConta + 1;
     |FINSI;
     |DDEFECTO #25;
     |BUCLE gopartia;
     #25#0 = nConta;
     #25#1 = #5#2;
     #25#2 = #5#4;
     |LEE 101#25=;
     |SI FSalida ! 0; |GRABA 020#25b; |FINSI;
     #25#3 = #5#5;
     #25#4 = #5#6;
     #25#5 = #5#7;
     #25#6 = #5#26;
     #25#7 = #25#7 + #5#9;
     #25#8 = #25#8 + #5#8;
     #25#9 = #25#9 + #5#10;
     #25#10 = #25#10 + #5#11;
     #25#11 = #25#11 + #5#16;
  |||   #25#12 = #25#12 + #5#17;
     #25#13 = #5#0;
     #25#14 = #5#1;
     #25#15 = "";
     |GRABA 0 20#25a;
     |LIBERA #25;
|FPRC;
/*                  (*) MAL
|DEFBUCLE goptrbli;
     #5#2;
     6;
     #0#6, #0#9, #0#2, 0001, #0#0, #0#4;
     #0#7, #0#10, #0#3, 9999, #0#1, #0#5;
     ;
     NULL, goptrbli;
|FIN;
*/
|DEFBUCLE goptrbca;
     #23#1;
     ;
     #22#14, #22#15, #22#3, #22#0, #22#1;
     #22#14, #22#15, #22#3, #22#0, #22#1;
     ;
     NULL, NULL, goptrbli;
|FIN;

|PROCESO gopartli;
     |BUCLE goptrbca;
|FPRC;

|DEFBUCLE gopartli;
     #22#1;
     3;
     #21#4, #21#5, 1   , #0#2;
     #21#4, #21#5, 9999, #0#3;
     ;
     NULL, gopartli;
|FIN;

|PROCESO gopartll;
     |BUCLE gopartli;
|FPRC;

|DEFBUCLE gopartca;
     #20#1;
     ;
     #0#6, #0#9;
     #0#7, #0#10
     ;
     NULL, NULL, gopartll;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |SI #0#8 = "N";
          aInforme = aInforme1;
     |SINO;
          aInforme = aInforme2;
     |FINSI;

     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR aInforme;
          |SI FSalida ! 0;
               aInforme = "0000No existe informe: + " aInforme;
               |MENAV aInforme;
          |SINO;
               aAlfa = Usuario; |QBF aAlfa;
               |NOME_DAT #25 aAlfa;
               |DELINDEX #25;

               |ABRE #25;
               |ABRE #1;
               |ABRE #2; |SELECT #4#2;
               |ABRE #19;
               |BUCLE guerm017;
               |||BUCLE goptrbli; (*) MAL
               |BUCLE gopartca;
               |CIERRA #19;
               |CIERRA #2;
               |CIERRA #1;
               |CIERRA #25;

               |ABRE #6;
               |BUCLE Tmp;
               |CIERRA #6;

               |DELINDEX #25;
               |SI nConta ! 0; |PIEINF; |FINSI;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROGRAMA;
     |HAZ MiraLogos; || Copia Logos para el Crystal
     |MANTE #0;
|FPRO;
