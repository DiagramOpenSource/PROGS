|FICHEROS;
     gesiz029 #0;
     gesim002 #2;
     gesiw005 #5,MANTE; ||Tmp
     agifa010 #10;
     agifa019 #19;
     agifa071 #71;
     agifa077 #77;
     agifa080 #80;
     agifa041 #41;
|FIN;

|VARIABLES;
     &enCopia = "";
     &eaNomEmp = "";
     &eaTlf = "";
     &Tempo = "";
     &enCtrFin = 0;
     &eaCtrTxt = "";
     &enTeclaOK = 0;
     nRango = 0;
     nUni = 0;
     i = 0;
     aAlfa = "";
     aEmp = "";
|FIN;

|PROCESO Tmp;
     #2#0 = #5#0;
     |LEE 020#2=;

     #19#0 = #2#20;
     |LEE 000#19=;
     |SI FSalida ! 0; |DDEFECTO #19; |FINSI;

     |PARA i = 1; |SI i  [ #5#3; |HACIENDO i = i + 1;
          enCopia = i;
          |PRINT;
          |PIEINF;
     |SIGUE;
|FPRC;

|DEFBUCLE Tmp;
     #5#1;
     2;
     "                              ", "S";
     "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzz", "S";
     ;
     NULL, Tmp;
|FIN;

|PROCESO Imprime;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "gesiz029";
          |SI FSalida = 0;
               |ABRE #19;
               |ABRE #2;
               |BUCLE Tmp;
               |CIERRA #2;
               |CIERRA #19;
               |FININF;
          |SINO;
               |MENAV "0000Error en informe 'gesiz029'...";
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO Matri0; |TIPO 0;
     |ABRE #2;
     #2#0 = #5#0;
     |LEE 000#2=;
     |SI FSalida = 0;
          #5#1 = #2#1; |PINTA #5#1;
     |SINO;
          |MENAV "0000No existe c¢digo de Matr¡cula...";
          |ERROR;
     |FINSI;
     |CIERRA #2;
|FPRC;

|PROCESO Matri66; |TIPO 66;
     |ABRE #2;
     #2#0 = #5#0;
     |LEE 000#2=;
     |CONSULTA_CLAVE #1#2;
     |SI FSalida = 0;
          #5#0 = #2#0; |PINTA #5#0;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #2;
|FPRC;

|PROCESO BtnCancela;
     enTeclaOK = 1; |PTEC 807;
|FPRC;

|PROCESO GraTmp;
     #5#0 = #2#0;
     |LEE 000#5=;
     |SI FSalida ! 0;
          #5#1 = #2#1;
          #5#2 = #0#11;
          #5#3 = nUni * #0#8;
          |GRABA 020#5n;
     |SINO;
          #5#3 = #5#3 + (nUni * #0#8);
          |GRABA 020#5a;
     |FINSI;
|FPRC;

|PROCESO gesim002;
     #19#0 = #2#20;
     |LEE 000#19=;
     |SI FSalida = 0;
          |SI #19#128 ] #0#2; |Y #19#128 [ #0#3;
                    |Y #19#2 ] #0#15; |Y #19#2 [ #0#16;
                    |Y #19#3 ] #0#17; |Y #19#3 [ #0#18;
               nUni = 1;
               |HAZ GraTmp;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE gesim002;
     #2#1;
     20, 6, 2;
     #0#24, #0#0, #0#26, #0#19;
     #0#25, #0#1, #0#27, #0#20;
     ;
     NULL, gesim002;
|FIN;

|PROCESO agifa071
     #2#0 = #71#49;
     |LEE 000#2=;
     |SI FSalida = 0;
          nUni = #71#5;
          |HAZ GraTmp;
     |FINSI;
|FPRC;

|DEFBUCLE agifa010;
     #10#1;
     ;
     #0#4, #0#6;
     #0#5, #0#7;
     ;
     NULL, NULL, agifa071;
|FIN;

|PROCESO agifa080;
     #2#0 = #80#37;
     |LEE 000#2=;
     |SI FSalida = 0;
          nUni = #80#5;
          |HAZ GraTmp;
     |FINSI;
|FPRC;

|DEFBUCLE agifa077;
     #77#1;
     ;
     #0#4, #0#6;
     #0#5, #0#7;
     ;
     NULL, NULL, agifa080;
|FIN;

|PROCESO T3; |TIPO 3;
     |DFICE aAlfa;
     aEmp = aAlfa % -205;
     |DBASE aAlfa;
     aAlfa = aAlfa + "fich/";
     |PATH_DAT #41 aAlfa;
     |ABRE #41;
     #41#0 = aEmp;
     |LEE 020#41=;
     |CIERRA #41;
     eaNomEmp = #41#1;
     eaTlf = #41#6;


     |HAZ CreaTempo; |NOME_DAT #5 Tempo; |DELINDEX #5; |ABRE #5;

     |SI #0#9 = 1;
          |ABRE #19;
          |BUCLE gesim002;
          |CIERRA #19;
     |FINSI;
     |SI #0#9 = 2;
          |ABRE #2;
          |BUCLE agifa077;
          |CIERRA #2;
     |FINSI;
     |SI #0#9 = 3;
          |ABRE #2;
          |BUCLE agifa010;
          |CIERRA #2;
     |FINSI;
     |LEE 000#5p;

     |VENTANA 0901, 3098, -1, 17, "Impresi¢n Etiquetas C¢digo de Barras";
     |HAZ PushVenModal;
     |CONTROL_SIMPLE 0, "BOTON,{{207}}Cancelar", 3072, 3082, BtnCancela;
     nRango = 1 + 4 + 8 + 16 + 32;
     |LINEAL_SIMPLE #1#5, nRango, 902, 2897, NULL, NULL, NULL;
     enCtrFin = FSalida; eaCtrTxt = "{{205}}Imprimir"; |HAZ EsperaFin;
     |HAZ PopVenModal;

     |SI enTeclaOK = 0;
          |HAZ Imprime;
     |FINSI;

     |CIERRA #5; |DELINDEX #5; |HAZ BoraTempo;
|FPRC;

|PROCESO Tipo; |TIPO 0;
     |SI #0#9 = 1;
          |C_M #0#24, 1, "S"; |PINTA #0#24;
          |C_M #0#25, 1, "S"; |PINTA #0#25;
          |C_M #0#0, 1, "S"; |PINTA #0#0;
          |C_M #0#1, 1, "S"; |PINTA #0#1;
          |C_M #0#2, 1, "S"; |PINTA #0#2;
          |C_M #0#3, 1, "S"; |PINTA #0#3;
          |C_M #0#15, 1, "S"; |PINTA #0#15;
          |C_M #0#16, 1, "S"; |PINTA #0#16;
          |C_M #0#17, 1, "S"; |PINTA #0#17;
          |C_M #0#18, 1, "S"; |PINTA #0#18;
          |C_M #0#19, 1, "S"; |PINTA #0#19;
          |C_M #0#20, 1, "S"; |PINTA #0#20;
          |C_M #0#26, 1, "S"; |PINTA #0#26;
          |C_M #0#27, 1, "S"; |PINTA #0#27;

          |C_M #0#4, 1, "N"; |PINTA #0#4;
          |C_M #0#5, 1, "N"; |PINTA #0#5;
          |C_M #0#6, 1, "N"; |PINTA #0#6;
          |C_M #0#7, 1, "N"; |PINTA #0#7;
     |SINO;
          |C_M #0#24, 1, "N"; |PINTA #0#24;
          |C_M #0#25, 1, "N"; |PINTA #0#25;
          |C_M #0#0, 1, "N"; |PINTA #0#0;
          |C_M #0#1, 1, "N"; |PINTA #0#1;
          |C_M #0#2, 1, "N"; |PINTA #0#2;
          |C_M #0#3, 1, "N"; |PINTA #0#3;
          |C_M #0#15, 1, "N"; |PINTA #0#15;
          |C_M #0#16, 1, "N"; |PINTA #0#16;
          |C_M #0#17, 1, "N"; |PINTA #0#17;
          |C_M #0#18, 1, "N"; |PINTA #0#18;
          |C_M #0#19, 1, "N"; |PINTA #0#19;
          |C_M #0#20, 1, "N"; |PINTA #0#20;
          |C_M #0#26, 1, "N"; |PINTA #0#26;
          |C_M #0#27, 1, "N"; |PINTA #0#27;

          |C_M #0#4, 1, "S"; |PINTA #0#4;
          |C_M #0#5, 1, "S"; |PINTA #0#5;
          |C_M #0#6, 1, "S"; |PINTA #0#6;
          |C_M #0#7, 1, "S"; |PINTA #0#7;
     |FINSI;
|FPRC;

|PROCESO Alba66; |TIPO 66;
     |SI #0#9 = 2;
          |ABRE #77;
          |SI Campo = 6;
               #77#50 = #0#4;
               #77#0 = #0#6;
               |LEE 000#77];
               |CONSULTA_CLAVE #1#77;
               |SI FSalida = 0;
                    #0#4 = #77#50; |PINTA #0#4;
                    #0#6 = #77#0; |PINTA #0#6;
               |SINO;
                    |ERROR;
               |FINSI;
          |SINO;
               #77#50 = #0#5;
               #77#0 = #0#7;
               |LEE 000#77];
               |CONSULTA_CLAVE #1#77;
               |SI FSalida = 0;
                    #0#5 = #77#50; |PINTA #0#5;
                    #0#7 = #77#0; |PINTA #0#7;
               |SINO;
                    |ERROR;
               |FINSI;
          |FINSI;
          |CIERRA #77;
     |SINO;
          |ABRE #10;
          |SI Campo = 6;
               #10#52 = #0#4;
               #10#0 = #0#6;
               |LEE 000#10];
               |CONSULTA_CLAVE #1#10;
               |SI FSalida = 0;
                    #0#4 = #10#52; |PINTA #0#4;
                    #0#6 = #10#0; |PINTA #0#6;
               |SINO;
                    |ERROR;
               |FINSI;
          |SINO;
               #10#52 = #0#5;
               #10#0 = #0#7;
               |LEE 000#10];
               |CONSULTA_CLAVE #1#10;
               |SI FSalida = 0;
                    #0#5 = #10#52; |PINTA #0#5;
                    #0#7 = #10#0; |PINTA #0#7;
               |SINO;
                    |ERROR;
               |FINSI;
          |FINSI;
          |CIERRA #10;
     |FINSI;
|FPRC;

|PROCESO Cb66; |TIPO 66;
     |ABRE #19;
     |SELECT #4#19;
     #19#128 = #0Campo;
     |LEE 000#19];
     |CONSULTA_CLAVE #4#19;
     |SI FSalida = 0;
          #0Campo = #19#128; |PINTA #0Campo;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #19;
|FPRC;

|PROGRAMA;
     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |GRABA 020#0a;
     |FINSI;
     |CIERRA #0;
|FPRO;
