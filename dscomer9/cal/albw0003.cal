|FICHEROS;
     albm0003 #3;
     albm0035 #35,MANTE;
     albw0003 #901,MANTE;
     agifa029 #29;
     agifa067 #67;
     agifa077 #77;
     agifa112 #112;
     agifa142 #142;
     dsm00024 #224;
|FIN;

|VARIABLES;
     &enAlbeAlm = 0;
     &eaTipoMov = "";
     &eaAlbePar = "";

     aClave = "";
     nVentana1     = 0;

     &eaSw2Stock   = "";
     &eaDocu       = "";
     &eaDespreciar = "";
     &enRechazar   = 0;
|FIN;

|PROCESO Conversion;  |TIPO 0;
     ||컴컴컴컴컴컴 Doble/Multi

     |SI #901#8 = "               ";

         enAlbeAlm = #albm0003#3;
         eaTipoMov = "entrada";
         |HAZ AlbeDamePartida;
         #901#8 = eaAlbePar;

         |ABRE #224;
         #224#0 = #3#4;
         #224#1 = #3#3;
         #224#2 = #901#8;
         |LEE 101#224=;
         |SI FSalida ! 0;
             |DDEFECTO #224;
             #224#0 = #3#4;
             #224#1 = #3#3;
             #224#2 = #901#8;
             #224#3 = #3#7;
             |GRABA 020#224n;
             |LIBERA #224;
         |FINSI;
         |CIERRA #224;
     |FINSI;

     eaDocu = "agifa080";
     #67#41 = 0;
     #67#5  = #3#6;
     #67#42 = #901#8;
     |HAZ DobleUni;
     |SI eaSw2Stock = "S";
         |C_M #901#5, 1, "N";

         #901#4 = #67#41;  |PINTA #901#4;
         #901#5 = #67#5;   |PINTA #901#5;
         #901#8 = #67#42;
         |ACABA;
     |FINSI;

     |C_M #901#5, 1, "S";
|FPRC;

|PROCESO Compara;
     |ABRE #142;
     |LEE 040#142p;
     |CIERRA #142;

     eaDespreciar = "N";
     |SI #901#5 > #901#3;
         |CONFI "2400NEsta recibiendo mas de lo Pedido, Continuar : ";
         |SI FSalida = 0;
             eaDespreciar = "S";
         |SINO;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #901#5 < #901#3;
         |SI #142#211 = "E";
             |AVISO;
             |CONFI "2400NEsta recibiendo menos de lo Pedido, Despreciar : ";
         |FINSI;
         |SI #142#211 = "D"; FSalida = 0; |FINSI;
         |SI #142#211 = "P"; FSalida = 1; |FINSI;
         |SI FSalida = 0;
             eaDespreciar = "S";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO MiraDifer;
     |SI eaSw2Stock = "S";
         |SI Campo = 7;  |HAZ Compara;  |FINSI;
     |SINO;
         |SI Campo = 5;  |HAZ Compara;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo7w3;  |TIPO 7;
     |ABRE #77;
     #77#50 = #901#0;
     #77#0  = 999999;
     |LEE 040#77];
     |SI FSalida = 0;
         |LEE 040#77a;
     |SINO;
         |LEE 040#77u;
     |FINSI;

     #901#1 = 1;
     |SI FSalida = 0;  |Y  #77#50 = #901#0;
         #901#1 = #77#0 + 1;
     |FINSI;

     |CIERRA #77;

     |PINTA #901#1;
|FPRC;

|PROCESO Tipo0w3;  |TIPO 0;
     |ABRE #77;
     #77#50 = #901#0;
     #77#0  = #901#1;
     |LEE 040#77=;
     |SI FSalida = 0;
         |MENAV "0000 El Albaran ya existe.";
         |ERROR;
     |FINSI;
     |CIERRA #77;
|FPRC;

|PROCESO Incidencias;  |TIPO 0;
     |SI #901Campo = Contenido;  |ACABA;  |FINSI;
     |SI #901#9 ! "S";           |ACABA;  |FINSI;

     |ABRE #35;
     |VENTANA 0501, 3299, -1, -1, "";
     nVentana1 = FSalida;

     |ABRE #29;
     #29#0 = #3#3;
     |LEE 040#29=;
     |SI FSalida ! 0;  |DDEFECTO #29;  |FINSI;
     |CIERRA #29;

     |ABRE #112;
     #112#0 = #3#7;
     |LEE 040#112=;
     |SI FSalida ! 0;  |DDEFECTO #112;  |FINSI;
     |CIERRA #112;

     #35#0 = #3#4;
     #35#2 = #3#3;
     #35#4 = #901#8;
     |LEE 101#35=;
     |SI FSalida ! 0;
         |DDEFECTO #albm0035;
         #35#0 = #3#4;
         #35#2 = #3#3;
         #35#4 = #901#8;
         |GRABA 020#35b;
      |FINSI;

      #35#1  = #3#5;
      #35#3  = #29#1;
      #35#5  = #3#7;
      #35#6  = #112#1;

      |PINPA #0#35;
      |PINDA #0#35;
      |ENDATOS #1#35;
      |SI FSalida = 0;
         |GRABA 020#35a;
         enRechazar = 0;
         |SI #35#40 = "S";
             |CONFI "0000SSe ha rechazado la Partida. No puedo pasarlo a Albaranes. Borro el Pendiente de Recibir";
             |SI FSalida = 0;
                 enRechazar = 1;
             |FINSI;
             |PTEC 807;
         |FINSI;
      |FINSI;
      |LIBERA #35;
      |CIERRA #35;

      |FINVENTANA nVentana1;
|FPRC;

|PROCESO Tipo3w3;  |TIPO 3;
     |ABRE #77;
     #77#50 = #901#0;
     #77#0  = #901#1;
     |LEE 040#77=;
     |SI FSalida = 0;
         |MENAV "0000 El Albaran ya existe.";
         |ERROR;
     |FINSI;
     |CIERRA #77;
|FPRC;
