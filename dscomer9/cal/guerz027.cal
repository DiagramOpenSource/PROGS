|FICHEROS;
     guerz027 #0;
     gopartll #1;
     gopartli #2;
     goptrbli #3;
     gopartca #4;
     guerz028 #28,MANTE;
|FIN;

|VARIABLES;
     aAlfa = "";
     nHay = 0;
     i = 0;
     nTotal = 0;
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Recal03;
     #2#9 = #2#9 + #3#17;
     #2#10 = #2#10 + #3#16;
     #2#11 = #2#11 + #3#19;
     #2#12 = #2#12 + #3#18;
|FPRC;

|DEFBUCLE Recal03;
     #3#1;
     ;
     #2#0, #2#1, #2#3, 0001;
     #2#0, #2#1, #2#3, 9999;
     ;
     NULL, Recal03;
|FIN;

|PROCESO Recal02;
     #2#9 = 0;
     #2#10 = 0;
     #2#11 = 0;
     #2#12 = 0;
     |BUCLE Recal03;
     #1#9 = #1#9 + #2#9;
     #1#10 = #1#10 + #2#10;
     #1#11 = #1#11 + #2#11;
     #1#12 = #1#12 + #2#12;
     |GRABA 020#2a;
     |LIBERA #2;
|FPRC;

|DEFBUCLE Recal02;
     #2#1;
     ;
     #1#4, #1#5, 0001;
     #1#4, #1#5, 9999;
     be;
     NULL, Recal02;
|FIN;

|PROCESO Recal01;
     #1#9 = 0;
     #1#10 = 0;
     #1#11 = 0;
     #1#12 = 0;
     |BUCLE Recal02;
     #4#2 = #4#2 + #1#6;
     #4#3 = #4#3 + #1#7;
     #4#4 = #4#4 + #1#8;
     #4#5 = #4#5 + #1#13;
     #4#6 = #4#6 + #1#9;
     #4#7 = #4#7 + #1#10;
     #4#8 = #4#8 + #1#11;
     #4#9 = #4#9 + #1#12;
     |GRABA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE Recal01;
     #1#1;
     ;
     #4#0, #4#1, 001;
     #4#0, #4#1, 999;
     be;
     NULL, Recal01;
|FIN;

|PROCESO Recalcula;
     |ABRE #4;
     #4#0 = #28#0;
     #4#1 = #28#1;
     |LEE 121#4=;
     |SI FSalida = 0;
          #4#2 = 0;
          #4#3 = 0;
          #4#4 = 0;
          #4#5 = 0;
          #4#6 = 0;
          #4#7 = 0;
          #4#8 = 0;
          #4#9 = 0;
          |BUCLE Recal01;
          |GRABA 020#4a;
     |FINSI;
     |CIERRA #4;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO goptrbli2;
     #2#6 = #2#6 + #3#11;
|FPRC;

|DEFBUCLE goptrbli2;
     #3#1;
     ;
     #2#0, #2#1, #2#3, 0001;
     #2#0, #2#1, #2#3, 9999;
     ;
     NULL, goptrbli2;
|FIN;

|PROCESO gopartli2;
     #2#6 = 0;
     #2#7 = 0;
     #2#8 = 0;
     |BUCLE goptrbli2;
     #2#13 = #2#6 + #2#7 + #2#8;

     #1#6 = #1#6 + #2#6;;
     #1#7 = #1#7 + #2#7;
     #1#8 = #1#8 + #2#8;
     |GRABA 020#2a;
     |LIBERA #2;
|FPRC;

|DEFBUCLE gopartli2;
     #2#1;
     ;
     #1#4, #1#5, 0001;
     #1#4, #1#5, 9999;
     be;
     NULL, gopartli2;
|FIN;

|PROCESO TMP;
     |ABRE #1;
     #1#0 = #28#0;
     #1#1 = #28#1;
     #1#2 = #28#2;
     |LEE 121#1=;
     |SI FSalida = 0;
          #1#6 = 0;
          #1#7 = 0;
          #1#8 = 0;
          |BUCLE gopartli2;
          #1#13 = #1#6 + #1#7 + #1#8;
          |GRABA 020#1a;
          |LIBERA #1;
     |FINSI;
     |CIERRA #1;
     |HAZ Recalcula;
|FPRC;

|DEFBUCLE TMP;
     #28#2;
     ;
     "*";
     "*";
     ;
     NULL, TMP;
|FIN;

|PROCESO goptrbli;
     #28#20 = #28#20 + (#3#11 ! 2);
|FPRC;

|DEFBUCLE goptrbli;
     #3#1;
     ;
     #2#0, #2#1, #2#3, 0001;
     #2#0, #2#1, #2#3, 9999;
     ;
     NULL, goptrbli;
|FIN;

|PROCESO gopartli;
     #28#16 = #28#16 + #2#6;
     #28#17 = #28#17 + #2#7;
     #28#18 = #28#18 + #2#8;
     |BUCLE goptrbli;
|FPRC;

|DEFBUCLE gopartli;
     #2#1;
     ;
     #1#4, #1#5, 0001;
     #1#4, #1#5, 9999;
     ;
     NULL, gopartli;
|FIN;

|PROCESO gopartll;
     |DDEFECTO #28;
     |PARA i = 0; |SI i [ 14; |HACIENDO i = i + 1;
          #28i = #1i;
     |SIGUE;

     |BUCLE gopartli;

     |SI #28#6 ! #28#16; |O #28#7 ! #28#17; |O #28#8 ! #28#18; |O #28#6 ! #28#20;
          |GRABA 020#28n;
          nHay = 1;
     |FINSI;
|FPRC;

|DEFBUCLE gopartll;
     #1#1;
     4, 5;
     #0#0, #0#2, 0001, #0#4, #0#6;
     #0#1, #0#3, 9999, #0#5, #0#7;
     ;
     NULL, gopartll;
|FIN;

|PROCESO Tecla; |TIPO 0;
     |SI FSalida = 0;
          |SI #28#15 = "*";
               #28#15 = "";
          |SINO;
               #28#15 = "*";
          |FINSI;
          |GRABA 020#28a;
     |FINSI;
|FPRC;

|PROCESO Min;
     #28#0 = "      ";
     #28#1 = 000001;
     #28#2 = 0001;
|FPRC;

|PROCESO Max;
     #28#0 = "zzzzzz";
     #28#1 = 999999;
     #28#2 = 9999;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     aAlfa = Usuario;
     |NOME_DAT #28 aAlfa; |DELINDEX #28;

     |MENSA "0000Cargando temporal...";
     |ABRE #28;
     |BUCLE gopartll;
     |CIERRA #28;
     |SI nHay = 0;
          |MENAV "0000No hay registros...";
     |SINO;
          |PINPA #0#28;
          |ENTLINEAL #1#28, 3, 4, 22, 0, Min, Max;
          |CONFI "0000NCorregir registros marcados";
          |SI FSalida = 0;
               |BUCLE TMP;
          |FINSI;
     |FINSI;
     |DELINDEX #28;
|FPRC;
