|FICHEROS;
     dsm00236 #0;
     dsm00209 #209;
     dsm00210 #210;
     dsm00211 #211;
     dsm00212 #212;
     agifa023 #23;
     agifa024 #24;
     agifa020 #20;
|FIN;

|VARIABLES;
     aGrp = "";
     aCli = "";
     i    = 0;
|FIN;

||INC-LUYE llena_c;

|PROCESO CliGru; |TIPO 0;
     |C_M #0#1, 1, "S";
     |C_M #0#2, 1, "S";
     |C_M #0#3, 1, "S";
     |C_M #0#4, 1, "S";
     |SI #0#0 = "G";
          |C_M #0#1, 1, "N";
          |C_M #0#2, 1, "N";
     |FINSI;
     |SI #0#0 = "C";
          |C_M #0#3, 1, "N";
          |C_M #0#4, 1, "N";
     |FINSI;
|FPRC;

|PROCESO dsm00212;
     |DDEFECTO #23;
     #23#0 = #24#0;    ||Cliente
     #23#1 = #212#1;   ||Articulo
     |LEE 101#23=;
     #23#2  = #212#3;  ||Precio
     #23#32 = #212#4;  ||Descuento
     #23#34 = #212#7;  ||Comision
     #23#28 = #212#5;  ||Desde F.
     #23#29 = #212#6;  ||Hasta F.
     #23#35 = #212#2;
     |SI FSalida = 0;
          |GRABA 020#23a;
     |SINO;
          |GRABA 020#23n;
     |FINSI;
     |LIBERA #23;

     #20#0 = #23#0;
     |LEE 000#20=;
     |SI FSalida ! 0; |GRABA 020#20n; |FINSI;
|FPRC;

|PROCESO agifa024;
     |BUCLELIN 2 dsm00212 #211;
|FPRC;

|DEFBUCLE agifa024;
     #24#1;
     158;
     "      ", aGrp;
     "zzzzzz", aGrp;
     ;
     NULL, agifa024;
|FIN;

|PROCESO dsm00211;
     |SI #0#5 = "P"; |Y #211#25 ! "PENDIENTE"; |ACABA; |FINSI;
     |SI #0#5 = "G"; |Y #211#25 ! "GENERADA "; |ACABA; |FINSI;

     #211#25 = "GENERADA";
     |GRABA 020#211a;
     |PARA i = 1; |SI i [ 24; |HACIENDO i = i + 1;
          aGrp = #211i; |QBF aGrp;
          |SI aGrp ! "";
               |BUCLE agifa024;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO dsm00210;
     |DDEFECTO #23;
     #23#0 = aCli;     ||Cliente
     #23#1 = #210#1;   ||Articulo
     |LEE 101#23=;
     #23#2  = #210#3;  ||Precio
     #23#32 = #210#4;  ||Descuento
     #23#34 = #210#7;  ||Comision
     #23#28 = #210#5;  ||Desde F.
     #23#29 = #210#6;  ||Hasta F.
     |SI FSalida = 0;
          |GRABA 020#23a;
     |SINO;
          |GRABA 020#23n;
     |FINSI;
     |LIBERA #23;

     #20#0 = #23#0;
     |LEE 000#20=;
     |SI FSalida ! 0; |GRABA 020#20n; |FINSI;
|FPRC;

|PROCESO dsm00209;
     |SI #0#5 = "P"; |Y #209#25 ! "PENDIENTE"; |ACABA; |FINSI;
     |SI #0#5 = "G"; |Y #209#25 ! "GENERADA "; |ACABA; |FINSI;

     #209#25 = "GENERADA";
     |GRABA 020#209a;
     |PARA i = 1; |SI i [ 24; |HACIENDO i = i + 1;
          aCli = #209i;
          |BUCLELIN 2 dsm00210 #209;
     |SIGUE;
|FPRC;

|DEFBUCLE dsm00211;
     #211#1;
     ;
     #0#3;
     #0#4;
     be;
     NULL, dsm00211;
|FIN;

|DEFBUCLE dsm00209;
     #209#1;
     ;
     #0#1;
     #0#2;
     be;
     NULL, dsm00209;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |SI #0#6 = "S";
          |DELINDEX #20;
          |DELINDEX #23;
     |FINSI;

     |ABRE #20;
     |ABRE #23;
     |SI #0#0 = "A"; |O #0#0 = "C";
          |BUCLE dsm00209;
     |FINSI;
     |SI #0#0 = "A"; |O #0#0 = "G";
          |BUCLE dsm00211;
     |FINSI;
     |CIERRA #20;
|FPRC;
