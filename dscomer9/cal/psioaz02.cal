|FICHEROS;
     psioaz02 #0;
     dsm00003 #3;
     agifa019 #19;
     agifa023 #23;
     agifa024 #24;
     psioa032 #32;
     psioa033 #33;
     agifa091 #91;
|FIN;

|VARIABLES;
     aInf = "";
|FIN;

|PROCESO agifa023;
     |DDEFECTO #32;
     #32#0 = #33#0;
     |LEE 000#32=;

     |DDEFECTO #24;
     #24#0 = #33#1;
     |LEE 000#24=;

     |DDEFECTO #91;
     #91#0 = #24#20;
     |LEE 000#91=;

     |DDEFECTO #3;
     #3#0 = #33#1;
     #3#1 = #33#2;
     |LEE 000#3=;

     |DDEFECTO #19;
     #19#0 = #23#1;
     |LEE 000#19=;

     |PRINT;
|FPRC;

|DEFBUCLE agifa023;
     #23#1;
     ;
     #33#1, "                    ";
     #33#1, "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, agifa023;
|FIN;

|PROCESO psioa033Ord;
     |BUCLE agifa023;
|FPRC;

|PROCESO psioa033;
     |DDEFECTO #32;
     #32#0 = #33#0;
     |LEE 000#32=;

     |DDEFECTO #24;
     #24#0 = #33#1;
     |LEE 000#24=;

     |DDEFECTO #3;
     #3#0 = #33#1;
     #3#1 = #33#2;
     |LEE 000#3=;
|FPRC;

|DEFBUCLE psioa033;
     #33#1;
     ;
     #0#0, "      ", 0001;
     #0#1, "zzzzzz", 9999;
     ;
     NULL, psioa033, NULL, NULL, NULL, psioa033Ord;
     #33#0, #33#3, #3#3, #24#2; ||Ruta, Orden, Poblacion, Nombre Comercial
|FIN;

|PROCESO Tipo3; |TIPO 3;
     Impresora = "CrystalReport";
     |IMPRE -1;
     |SI FSalida = 0;
          aInf = #0#2; |QBF aInf;
          |INFOR aInf;
          |SI FSalida = 0;
               |ABRE #3;
               |ABRE #19;
               |ABRE #23;
               |ABRE #24;
               |ABRE #32;
               |ABRE #91;
               |BUCLE psioa033;
               |CIERRA #91;
               |CIERRA #32;
               |CIERRA #24;
               |CIERRA #23;
               |CIERRA #19;
               |CIERRA #3;
               |PIEINF;
               |FININF;
          |SINO;
               aInf = "0000Error en informe '" + aInf + "'";
               |MENAV aInf;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;


|PROGRAMA;
     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
     #0#0 = "";
     #0#1 = "zzzzzz";
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0; |GRABA 020#0a; |FINSI;
     |CIERRA #0;
|FPRO;
