|FICHEROS;
     inmoz011 #0;
     inmom001 #1;
|FIN;

|VARIABLES;
     aRuta = "";
     nBoton = 0;
     aAlfa = "";
     nHandle = 0;
     aTab = "";
     aFic = "";
|FIN;

|PROCESO inmom001;
     aAlfa = #1#7 + aTab + #1#0;
     |XGRABA nHandle, aAlfa;
|FPRC;

|DEFBUCLE inmom001;
     #1#2;
     ;
     #0#3, "                    ";
     #0#3, "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, inmom001;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |SI #0#2 ! "SI"; |ACABA; |FINSI;

     |ESTADO_CONTROL nBoton, "DISABLE";

     aRuta = #0#1; |QBF aRuta;
     aAlfa = aRuta % -101;
     |SI aAlfa ! "/"; |Y aAlfa ! "\";
          aRuta = aRuta + "/";
     |FINSI;

     aTab = &9;
     aAlfa = #0#3; |QBF aAlfa;

     aFic = aRuta + aAlfa;
     |XABRE "CW", aFic, nHandle;
     |SI FSalida ] 0;
          |BUCLE inmom001;
          |XCIERRA nHandle;
     |SINO;
          |MENAV "0000Error al crear el fichero";
     |FINSI;

|FPRC;

|PROCESO Tipo0; |TIPO 0;
     |SI FSalida ! 13; |ACABA; |FINSI;
     |ESTADO_CONTROL nBoton, "DISABLE";

     aRuta = #0#1;  |QBF aRuta;
     |SI aRuta = "";
         aRuta = "*.*";
     |FINSI;
     aRuta = "D" + aRuta;

     |BROWSE aRuta;

     aRuta = aRuta % 2;
     |SI aRuta ! "D";
          #0#1 = aRuta;
     |FINSI;
     |PINTA #0#1;

     |ESTADO_CONTROL nBoton, "SHOW";
     |ERROR;
|FPRC;

|PROCESO Boton;
     |PTEC 827;
|FPRC;

|PROGRAMA;
     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
     |CLS;
     #0#2 = "NO";
     |PINPA #0#0;
     |PINDA #0#0;
     |CONTROL_SIMPLE 0, "BOTON, Carpeta", 1010, 1018, Boton;
     nBoton = FSalida;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |GRABA 020#0a;
     |FINSI;
     |CIERRA #0;
     |FIN_CONTROL_WINDOWS nBoton;
|FPRO;
