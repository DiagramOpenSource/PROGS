|FICHEROS;
    agifa571 #0;
    agifa517 #2;
    agifa573 #3;
    agifa517 #4;
    agifa024 #31;
|FIN;

|VARIABLES;
     nGuarda   = 0;
     &forma    = "";
     &impr_tpv = "";
     &impr_dis = "";
     &cier_dis  = "";
     &mens_dis  = "";
     modo = 0;
     nu2 = 0;
     nu1 = 0;
     &alfa = "";
     alf1 = "";
     i = 0;
|FIN;

|PROCESO Tipo5; |TIPO 5;
     FSalida = "SINBARRA";
|FPRC;

|PROCESO inf;
     #3#0 = #2#0;
     #3#1 = #2#1;
     #3#2 = 1;
|FPRC;

|PROCESO sup;
     #3#0 = #2#0;
     #3#1 = #2#1;
     #3#2 = 99;
|FPRC;

|PROCESO Tipo13; |TIPO 13;
     |ENTLINEAL #1#3,-3,7,22,0,inf,sup;
|FPRC;

||INC-LUYE llena_c1;

|PROCESO noalta; |TIPO 0;
     modo = (FEntrada / 100) ! 0;
     |SI modo = 1;
          |MENAV "0000No se permite el alta en esta Opcion";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Clave2;
     |BLIN 24;
     |PINTA 2425, "Entre la Clave:";
     alfa = "";
     E_sup = 10;
     E_inf = "";
     alfa = 2441 ? -1;
     |BLIN 24;
     nu2 = 0;
     |PARA i = 101; |SI i [ 1100; |HACIENDO i = i + 100;
          alf1 = alfa % i;
          nu1 = &alf1 * i;    || Encripta la clave
          nu2 = nu2 + nu1;
     |SIGUE;
     alfa = nu2;
     |QBF alfa;
|FPRC;

|PROCESO tipo1; |TIPO 1;
     |ABRE #2;
     |LEE 000#2p;
     |CIERRA #2;
     modo = (FEntrada / 100) ! 0;
     |SI modo = 3; |Y #2#15 = "S";
          |HAZ Clave2;
          alf1 = #2#16; |QBF alf1;
          |SI alf1 ! alfa;
               |MENAV "0000Clave incorrecta...";
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO tipo2; |TIPO 2;
     modo = (FEntrada / 100) ! 0;
     |SI modo = 3;
          |AVISO;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Min;
     #31#0 = "      ";
|FPRC;

|PROCESO Max;
     #31#0 = "zzzzzz";
|FPRC;

|PROCESO Tipo66; |TIPO 66;
     |ABRE #4; |LEE 000#4p; |CIERRA #4;

     ||HAZ llena_c1;
     |PUSHV 0101 2380;
     |CLS;
     nGuarda = FEntrada;
     |ABRE #31;
     #31#0 = #0#0;
     |LEE 000#31=;

     |SI #4#23 = "T";
        ||  |PINPA #0#31;
          |PINDA #0#31;
          |CONSULTA #0#31;
          |SI FSalida = 0;
               #0#0 = #31#0;
          |FINSI;
     |SINO;
          |CONSULTA_F_CLAVE #1#31, Min, Max;
          |SI FSalida = 0;
               #0#0 = #31#0;
           ||    |PINPA #0#31;
               |PINDA #0#31;
               |PAUSA;
          |FINSI;
     |FINSI;
     |POPV;
     |ERROR;
     FEntrada = nGuarda;
|FPRC;
