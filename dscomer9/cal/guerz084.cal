Calculo llamado por aojentr3, aojentr5 del modulo 003774 de laboral

|FICHEROS;
     gomantho #0;
     gomantl1 #1;
     gosubcoc #2;
     gopre001 #6;
     goparame #10;
|FIN;

|VARIABLES;
     &eaSerExp = "";
     &enNumExp = 0;
     &eaSerPre = "";
     &enNumPre = 0;
     &enSubcon = 0;

     aAlfa = "";
     aSerExp = "";
     nNumExp = "";
     aSerPre = "";
     nNumPre = "";
     fFec = @;
     aSub = "";
     nError = 0;
     aEstado = "";
|FIN;

|PROCESO LinExpe;
     aSerPre = #1#3;
     nNumPre = #1#4;
     aEstado = #1#10;
     |SI #1#10 = "C"; |ERROR10; |FINSI;
|FPRC;

|PROGRAMA;
     aAlfa = PARAMETRO % 105; aSerExp = aAlfa;
     aAlfa = PARAMETRO % 606; nNumExp = aAlfa;
     aAlfa = PARAMETRO % 1210; fFec = aAlfa;
     aAlfa = PARAMETRO % 2206; aSub = aAlfa;

     |ABRE #10; |LEE 000#10p; |CIERRA #10;

     |ABRE #0;
     #0#0 = aSerExp;
     #0#1 = nNumExp;
     |LEE 020#0=;
     |SI FSalida = 0;
          |BUCLELIN 2 LinExpe #0;
          |SI aEstado = "E";
               |MENAV "0000Obra en estado de ESPERA...";
               nError = 1;
          |FINSI;
          |SI aEstado = "P";
               |SI #10#72 = "S"; |MENAV "0000Obra en estado PARADA..."; |FINSI;
               |SI #10#73 = "N"; nError = 1; |FINSI;
          |FINSI;
          |SI aEstado = "T";
               |SI #10#74 = "S"; |MENAV "0000Obra en estado TERMINADA..."; |FINSI;
               |SI #10#75 = "N"; nError = 1; |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #0;

     |SI nError ! 0; |ACABA; |FINSI;

     |ABRE #2;
     #2#0 = aSub;
     |SI #2#0 ! 0;
          |LEE 020#2=;
          |SI FSalida ! 0;
               aSerPre = #2#4;
               nNumPre = #2#5;
          |FINSI;
     |FINSI;
     |CIERRA #2;

     |ABRE #6;
     #6#0 = aSerPre;
     #6#1 = nNumPre;
     |LEE 020#6=;
     |CIERRA #6;

     eaSerExp = #0#0;
     enNumExp = #0#1;
     eaSerPre = #6#0;
     enNumPre = #6#1;
     enSubcon = #2#0;

     |SI #2#0 = 0;
          |SUB_EJECUTA "godiaman";
     |SINO;
          |SUB_EJECUTA "godiaman;subcontratista";
     |FINSI;
|FPRO;
