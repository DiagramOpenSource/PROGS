|FICHEROS;
     platm024 #0;
     platm011 #1;
     platm012 #2;
     platm020 #3;
|FIN;

|VARIABLES;
     nCampo = 0;
     nCanti = 0;
     nModo = 0;
|FIN;

|PROCESO pDesde;
     #0#5 = 1;
|FPRC;

|PROCESO pHasta;
     #0#5 = 9999;
|FPRC;

|PROGRAMA;
     |CLS;
     |CABEZA "Mtos.Mercancia";
     |PINPA #0#1;
     |ENTLINEAL #1#0, 1, 1, 22 ,1, pDesde, pHasta;
|FPRO;

|CALCULO MiraSer;
     |ABRE #1;
     #1#0 = #0#0;
     |LEE 000#1=;
     |SI FSalida = 0;
          |SI #1#8 ! "O";
               |MENAV "0000 ESTE PROCESO NO ES PARA NUMEROS DE SERIE";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #1;
|FCAL;

|CALCULO tipo2024; |TIPO 2;
     |ABRE #1;
     #1#0 = #0#0;
     |LEE 101#1=;
     |SI FSalida = 0;
          |ABRE #2;
          #2#0 = #1#2;
          |LEE 101#2=;
          |SI FSalida = 0;

               nCanti = #0#6;
               |SI #0#2 = "S";     nCanti = #0#6 * -1; |FINSI;

               |SI #0#3 = 1;
                    #2#2 = #2#2 +. nCanti;   || almacen
               |FINSI;
               |SI #0#3 = 3;
                    #2#2 = #2#2 -. nCanti;   || almacen
                    #2#4 = #2#4 +. nCanti;   || averiados
               |FINSI;
               |SI #0#3 = 4;
                    #2#2 = #2#2 +. nCanti;   || almacen
                    #2#5 = #2#5 +. nCanti;   || reparadas
               |FINSI;
               |SI #0#3 = 5;
                    #2#2 = #2#2 -. nCanti;   || almacen
                    #2#7 = #2#7 +. nCanti;   || env.plataforma
               |FINSI;
               #2#6 = #2#2 + #2#3 + #2#4 + #2#5 + #2#7;
               |GRABA 020#2a;
          |FINSI;
          |LIBERA #2;
          |CIERRA #2;
     |FINSI;
     |LIBERA #1;
     |CIERRA #1;
|FCAL;

|PROCESO NoTipo2; |TIPO 0;
     |SI #platm024#3 = 2;
          |MENAV "0000Error de entrada.";
          |ERROR;
     |FINSI;
|FPRC;
