|FICHEROS;
     extz0007 #0;
     extm0001 #1;
     extm0002 #2;
     extm0003 #3;
     extm0004 #4;
     extm0011 #11;
     extm0013 #13;
     extm0014 #14;
     extm0017 #17;
     agifa024 #24;
     extm0026 #26;
     dsm00003 #30;
     tmp00000 #100; ||Tmp Impresion
     extm0024 #124;
|FIN;

|VARIABLES;
     &eaMensaje = "";
     &Tempo = "";
     f = @;
     aAlfa = "";
     aMes = "";
     aAno = "";
     aCli = "";
     nDir = 0;
     aEdi = "";
     aSis = "";
     nLin = 0;
     aTmp100 = "";
     fTeorica = @;
     nNume = 0;
     aSer = "";
|FIN;

|PROCESO CreaCara;
     #26#0 = #14#0;
     #26#1 = #14#1;
     #26#2 = #14#2;
     #26#3 = #124#0;
     #26#4 = #124#1;
     #26#5 = #124#3;
     #26#6 = #124#7;
     |GRABA 020#26n;
|FPRC;

|DEFBUCLE CreaCara;
     #124#2;
     ;
     #1#10;
     #1#10;
     ;
     NULL, CreaCara;
|FIN;

|PROCESO CreaLin;
     #14#0 = #13#0;
     #14#1 = #13#1;
     #14#2 = #11#0;
     #14#3 = #11#7;
     #14#4 = #11#5;
     #14#5 = #11#4;
     #14#6 = #11#6;
     #14#7 = #11#38;
     #14#8 = #11#23;
     #14#9 = #11#27;     ||F.Teor = F.Prox
     #14#10 = "01.01.0000";
     #14#11 = #11#33;
     #14#12 = #11#37;    ||F.Teor = F.Prox
     #14#13 = "01.01.0000";
     #14#16 = #11#4;
     #14#19 = #11#15;
     #14#20 = #11#16;
     #14#21 = #11#17;
     #14#22 = #11#18;
     #14#23 = #11#19;
     |GRABA 020#14n;
|FPRC;

|PROCESO CreaCab;
     aSer = #3#2; |QBF aSer;
     aSer = aSer % 103;
     aAlfa = ("0000" + #0#1) % -104;
     aSer = aSer + (aAlfa % -102);

     #13#0 = aSer; aSer = #13#0;
     #13#1 = 999999;
     |LEE 000#13];
     |SI FSalida = 0;
          |LEE 000#13a;
     |SINO;
          |LEE 000#13u;
     |FINSI;
     |SI FSalida = 0; |Y #13#0 = aSer;
          nLin = #13#1 + 1;
     |SINO;
          nLin = 1;
     |FINSI;

     #24#0 = #11#1;
     |LEE 000#24=;
     |SI FSalida ! 0; |DDEFECTO #24; |FINSI;

     #2#0 = #11#1;
     #2#1 = #11#2;
     |LEE 000#2=;
     |SI FSalida ! 0; |DDEFECTO #2; |FINSI;

     |DDEFECTO #13;
     #13#0 = aSer;
     #13#1 = nLin;
     #13#2 = #0#14;
     #13#3 = #0#14;
     #13#4 = #11#1;
     #13#5 = #24#2;
     #13#6 = #11#2;
     #13#7 = #11#3;
     #13#8 = #11#5;
     #13#9 = "A";
     #13#10 = 0;
     #13#11 = #2#2;
     #13#17 = #11#39;
     #13#18 = #2#4;
     #13#19 = #2#5;
     #13#20 = #2#6;
     #13#21 = #2#7;
     #13#22 = #2#8;
     #13#28 = #3#1;

     #17#0 = #13#10;
     |LEE 000#17=;
     |SI FSalida ! 0; |DDEFECTO #17; |FINSI;
     #13#29 = #17#1;

     #24#0 = #13#11;
     |LEE 000#24=;
     |SI FSalida ! 0; |DDEFECTO #24; |FINSI;

     #13#30 = #24#2;
     #13#37 = #4#7;
     |GRABA 020#13n;

     #100#0 = #13#0;
     #100#1 = #13#1;
     |GRABA 020#100n;
|FPRC;

|PROCESO Articulos;
     #30#0 = #11#1;
     #30#1 = #11#2;
     |LEE 000#30=;
     |SI FSalida ! 0; |DDEFECTO #30; |FINSI;
     |SI #30#4 < #0#8; |O #30#4 > #0#10; |ACABA; |FINSI;
     |SI #30#5 < #0#9; |O #30#4 > #0#11; |ACABA; |FINSI;

     #24#0 = #11#1;
     |LEE 000#24=;
     |SI FSalida ! 0; |DDEFECTO #24; |FINSI;
     |SI #24#111 = "S"; |ACABA; |FINSI;      ||Bloqueado
     |SI #24#25 < #0#19; |O #24#25 > #0#20; |ACABA; |FINSI;

     #2#0 = #11#1;
     #2#1 = #11#2;
     |LEE 000#2=;
     |SI FSalida ! 0; |DDEFECTO #2; |FINSI;
     |SI #2#2 < #0#17; |O #2#2 > #0#18; |ACABA; |FINSI;

     aAlfa = #11#27;
     aMes = aAlfa % 402; aAno = aAlfa % 704;
     |SI aMes ! #0#0; |O aAno ! #0#1;
          aAlfa = #11#37;
          aMes = aAlfa % 402; aAno = aAlfa % 704;
          |SI aMes ! #0#0; |O aAno ! #0#1; |ACABA; |FINSI;
     |FINSI;

     #4#0 = #11#1;
     #4#1 = #11#2;
     #4#2 = #11#3;
     |LEE 000#4=;
     |SI FSalida ! 0; |DDEFECTO #4; |FINSI;
     |SI #4#5 < #0#15; |O #4#5 > #0#16; |ACABA; |FINSI;

     |DDEFECTO #3;
     #3#0 = #11#5;
     |LEE 000#3=;
     |SI FSalida ! 0; |DDEFECTO #3; |FINSI;

     |SI aCli ! #11#1; |O nDir ! #11#2; |O aEdi ! #11#3; |O aSis ! #11#5;
          |HAZ CreaCab;
          aCli = #11#1;
          nDir = #11#2;
          aEdi = #11#3;
          aSis = #11#5;
     |FINSI;
     |HAZ CreaLin;

     #1#0 = #11#4;
     |LEE 000#1=;
     |SI FSalida = 0;
          |BUCLE CreaCara;
     |FINSI;

     #11#45 = #13#0;
     #11#46 = #13#1;
     |GRABA 020#11a;
     |LIBERA #11;
|FPRC;

|DEFBUCLE Articulos;
     #11#2;
     46;
     #0#2, #0#4, #0#6, #0#12, "                    ", 0;
     #0#3, #0#5, #0#7, #0#13, "zzzzzzzzzzzzzzzzzzzz", 0;
     be;
     NULL, Articulos;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |HAZ CreaTempo;
     |NOME_DAT #100Tempo; |DELINDEX #100; |ABRE #100; aTmp100 = Tempo;
     eaMensaje = "Generando partes...";
     |HAZ IniMensaje;
     |ABRE #30;
     |ABRE #24;
     |ABRE #26;
     |ABRE #17;
     |ABRE #13;
     |ABRE #14;
     |ABRE #4;
     |ABRE #3;
     |ABRE #2;
     |ABRE #1;
     |BUCLE Articulos;
     |CIERRA #1;
     |CIERRA #2;
     |CIERRA #3;
     |CIERRA #4;
     |CIERRA #13;
     |CIERRA #14;
     |CIERRA #17;
     |CIERRA #26;
     |CIERRA #24;
     |CIERRA #30;
     |HAZ FinMensaje;
     |LEE 000#100p;
     |SI FSalida = 0;
          |CONFI "0000S¨Imprimir partes de revisi¢n creados?";
          |SI FSalida = 0;
               aAlfa = "extz0008;" + aTmp100;
               |SUB_EJECUTA_NP aAlfa;
          |FINSI;
     |FINSI;
     Tempo = aTmp100; |HAZ BoraTempo; |CIERRA #100; |DELINDEX #100;
|FPRC;


Puesto como calculo porque como relacion trata de dar
de alta al cliente
|PROCESO Edifi66; |TIPO 66;
     |ABRE #4;
     |SI Campo = 6;
          #4#0 = #0#2;
          #4#1 = #0#4;
          #4#2 = #0#6;
          |LEE 000#4];
          |CONSULTA_CLAVE #1#4;
          |SI FSalida = 0;
               #0#2 = #4#0; |PINTA #0#2;
               #0#4 = #4#1; |PINTA #0#4;
               #0#6 = #4#2; |PINTA #0#6;
          |SINO;
               |ERROR;
          |FINSI;
     |SINO;
          #4#0 = #0#3;
          #4#1 = #0#5;
          #4#2 = #0#7;
          |LEE 000#4];
          |CONSULTA_CLAVE #1#4;
          |SI FSalida = 0;
               #0#3 = #4#0; |PINTA #0#2;
               #0#5 = #4#1; |PINTA #0#4;
               #0#7 = #4#2; |PINTA #0#6;
          |SINO;
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #4;
|FPRC;

|PROGRAMA;
     f = ~;
     aAlfa = f % 402; #0#0 = aAlfa;
     aAlfa = f % 704; #0#1 = aAlfa;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
|FPRO;
