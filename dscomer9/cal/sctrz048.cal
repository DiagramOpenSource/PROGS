|FICHEROS;
     sctrz048 #0;
     sctrm008 #8;
     sctrm023 #23;
     sctrm052 #52;
     sctrm057 #57;
     sctrm001 #100;
     referen@;
|FIN;

|VARIABLES;
     &enTipo = 0;
     &Tempo = "";
     &eaNomLogo = "";
     &enPantaLogo = 0;
     nPanta = 0;
     aAlfa = "";
     aInforme = "";
     aTemporada = "";
     aDTempo = "";
     aHTempo = "";
     fFecha = @;
|FIN;

|PROCESO Reservas_2;
     |SI #0#6 = #52#101;
          enTipo = 2;
          |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE Reservas_2;
     #52#6;
     ;
     #0#0, 0000000;
     #0#1, 9999999;
     ;
     NULL, Reservas_2;
|FIN;

|PROCESO Reservas_1;
     |SI #0#6 = #52#101;
          enTipo = 1;
          |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE Reservas_1;
     #52#5;
     ;
     #0#0, 0000, 0000000;
     #0#1, 9999, 9999999;
     ;
     NULL, Reservas_1;
|FIN;

|PROCESO T3; |TIPO 3;
     aInforme = #57#15; |QBF aInforme;
     Impresora = "CrystalReport";
     |IMPRE -1;
     |SI FSalida = 0;
          |INFOR aInforme;
          |SI FSalida = 0;
               |BUCLE Reservas_1;
               |BUCLE Reservas_2;
               |PIEINF;
               |FININF;
          |SINO;
               aAlfa = "0000Error en informe '" + aInforme + "'...";
               |MENAV aAlfa;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO sctrm023;
     |SALVA_DATOS #23;
     |REPON_DATOS #referen@;
     |GRABA 020#referen@.n;
|FPRC;

|DEFBUCLE sctrm023;
     #23#1;
     ;
     aDTempo, #0#2, #0#6, 000000;
     aHTempo, #0#3, #0#6, 999999;
     ;
     NULL, sctrm023;
|FIN;

|PROCESO BuscaTempo;
     |SI fFecha ] #8#2; |Y fFecha [ #8#3;
          aTemporada = #8#0;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE BuscaTempo;
     #8#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, BuscaTempo;
|FIN;

|PROCESO Servicio; |TIPO 66;
     fFecha = #0#0; |BUCLE BuscaTempo; aDTempo = aTemporada;
     fFecha = #0#1; |BUCLE BuscaTempo; aHTempo = aTemporada;
     |DDEF aAlfa;
     aAlfa = aAlfa + "sctrm023";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |HAZ CreaTempo; |NOME_DAT #referen@#Tempo#; |DELINDEX #referen@;
          |ABRE #referen@;
          |BUCLE sctrm023;
          |LEE 000#referen@.p;
          |SI FSalida = 0;
               |CONSULTA_CLAVE #1#referen@;
               |SI FSalida = 0;
                    #0Campo = #referen@#5; |PINTA #0Campo;
               |SINO;
                    |ERROR;
               |FINSI;
          |SINO;
               |MENAV "0000No existen registros...";
               |ERROR;
          |FINSI;
          |CIERRA #referen@;
          |HAZ BoraTempo; |DELINDEX #referen@;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO LogoPanta;
     eaNomLogo = #100#1;
     |HAZ TraeLogoPan;
     enPantaLogo = nPanta;
     |HAZ PintaLogoPan;
|FPRC;

|PROGRAMA;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     |ABRE #57; |LEE 000#57p; |CIERRA #57;
     |PINPA #0#0; nPanta = FSalida;
     |PINDA #0#0;
     |HAZ LogoPanta;
     |ENDATOS #1#0;
|FPRO;
