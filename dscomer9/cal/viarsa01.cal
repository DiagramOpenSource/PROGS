|FICHEROS;
     viarsa01 #0;

     dscam000@ #10;
     dscam045@ #11;
     canempre@ #12;
     anm00001@ #13;
|FIN;

|VARIABLES;
     &eaViaSer = "";
     &enViaNum = 0;
     &enViaLin = 0;

     aAlfa  = "";
     aAlfa1 = "";

     nTecla = 0;
|FIN;

|PROCESO Viarda1_12; |TIPO 12;
|FPRC;

|PROCESO MiraCtaAnalit;
   nTecla = FSalida;

   |DBASS aAlfa; |QBF aAlfa;
   aAlfa1 = aAlfa + "dscarter/def/dscam000.mas";
   |CARGA_DEF aAlfa1, dscam000@;
   |SI FSalida = 0;
      aAlfa1 = aAlfa + "dscarter/def/dscam045.mas";
      |CARGA_DEF aAlfa1, dscam045@;
      |SI FSalida = 0;
         aAlfa1 = aAlfa + "dscarter/fich/";
         |PATH_DAT #dscam000@#aAlfa1#; |PATH_DAT #dscam045@#aAlfa1#;
         |ABRE #dscam000@; |ABRE #dscam045@;
         aAlfa1 = aAlfa + "contagen/def/canempre.mas";
         |CARGA_DEF aAlfa1, canempre@;
         |SI FSalida = 0;
            aAlfa1 = aAlfa + "contagen/def/anm00001.mas";
            |CARGA_DEF aAlfa1, anm00001@;
            |SI FSalida = 0;
               #dscam045@#0 = #48#0;
               #dscam045@#1 = 1;
               |LEE 000#dscam045@.];
               |PARA; |SI FSalida = 0; |Y #dscam045@#0 = #48#0; |HACIENDO;
                  #dscam000@#0 = #dscam045@#6;
                  |LEE 000#dscam000@.=;
                  |SI FSalida = 0;
                     aAlfa1 = aAlfa + "contagen/fich/"; |PATH_DAT #canempre@#aAlfa1#;
                     |ABRE #canempre@;
                     #canempre@#2 = #dscam000@#14;
                     #canempre@#3 = #dscam000@#19;
                     |LEE 000#canempre@.=;
                     |SI FSalida = 0;
                        aAlfa1 = aAlfa + "contagen/fich/" + (("00000" + #dscam000@#14) % -105) + #dscam000@#19 + "/";
                        |PATH_DAT #anm00001@#aAlfa1#;
                        |ABRE #anm00001@;
                        |SI nTecla = 10;
                           |CONSULTA_CLAVE #1#anm00001@;
                           |SI FSalida = 0;
                              #viarsa01#3 = #anm00001@#0; |PINTA #viarsa01#3;
                              |ERROR;
                           |FINSI;
                        |FINSI;
                        #anm00001@#0 = #viarsa01#3;
                        |LEE 000#anm00001@.=;
                        |SI FSalida ! 0;
                           |MENAV "    Cuenta analitica inexistente";
                           |ERROR;
                        |FINSI;
                        |SAL;
                        |CIERRA #anm00001@;
                     |FINSI;
/*
                     |PARA; |SI FSalida = 0; |Y #canempre@#2 = #dscam000@#14; |HACIENDO;
                        |SI #canempre@#26
                     |SIGUE;
*/
                     |CIERRA #canempre@;
                  |FINSI;
                  |LEE 000#dscam045@.s;
               |SIGUE;
               |CIERRA #dscam000@; |CIERRA #dscam045@;
               |DESCARGA_DEF #anm00001@;
            |FINSI;
            |DESCARGA_DEF #canempre@;
         |FINSI;
         |DESCARGA_DEF #dscam045@;
      |FINSI;
      |DESCARGA_DEF #dscam000@;
   |FINSI;
|FPRC;

|PROGRAMA;
     |ABRE #0;
     #0#0 = eaViaSer;
     #0#1 = enViaNum;
     #0#2 = enViaLin;
     |LEE 101#0=;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
     |ENDATOS #1#0;
     |GRABA 020#0a;
     |CIERRA #0;
|FPRO;
