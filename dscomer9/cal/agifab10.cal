Modifica Cliente en entregas a cuenta: ModCliEntre y CheqCliEntre

|FICHEROS;
     agifa010 #0;
     agis0002 #2;
     dsm00003 #3,MANTE;
     agifa024 #24;
     agifa025 #25;
     agifa091 #91;
     dscam045@;
     dscam003@;
     dscam067@ #1;
|FIN

|VARIABLES;
     nNum = 0;
     aAlfa = "";
     aEmpre = "";
     aPath = "";
     aPathDat = "";
     aPathDef = "";
     aNumEmp = "";
     nNumEmp = 0;
     nError = 0;
     nSw = 0;
|FIN;

|PROCESO Recibos;
     |SI nSw = 1;
          |DDEFECTO #dscam067@;
          #dscam067@#0 = "CB";
          #dscam067@#1 = #dscam003@#40;
          |LEE 000#dscam067@.];
          nNum = #dscam067@#1;
          |SI FSalida = 0; |Y #dscam067@#0 = "CB"; |Y #dscam003@#40 = nNum;
               |MENAV "0000Existen recibos de entregas a cuenta contabilizados...";
               nError = 1; |ERROR10;
          |FINSI;
     |SINO;
          #dscam003@#5 = #24#16;
          #dscam003@#6 = #24#1;
          #dscam003@#7 = #24#29;
          #dscam003@#8 = #24#32;
          #dscam003@#9 = #24#33;
          #dscam003@#10 = #24#31;
          #dscam003@#11 = #24#30;
          #dscam003@#32 = #24#0;
          #dscam003@#33 = #25#0;
          #dscam003@#34 = #25#1;
          #dscam003@#39 = #3#11;
          #dscam003@#80 = #91#0;
          #dscam003@#81 = #91#1;
          #dscam003@#91 = #3#1;
          #dscam003@#92 = #3#10;
          |GRABA 020#dscam003@.a;
     |FINSI;
     |LIBERA #dscam003@;
|FPRC;

|DEFBUCLE Recibos;
     #dscam003@#12006;
     69;
     #0#52, #0#0, 000, "01.01.0000", "            ", "      ", "A";
     #0#52, #0#0, 999, "31.12.9999", "zzzzzzzzzzzz", "zzzzzz", "A";
     be;
     NULL, Recibos;
|FIN;

|PROCESO ConfiRec;
     |SI #dscam045@#2 = "V";
          aEmpre = ("00000" + #dscam045@#6) % -105;
          aPathDat = aPath + aEmpre + "/";

          |PATH_DAT #dscam003@#aPathDat#;
          |PATH_DAT #dscam067@#aPathDat#;
          |ABRE #dscam067@;
          |BUCLE Recibos;
          |CIERRA #dscam067@;
     |FINSI;
|FPRC;

|DEFBUCLE ConfiRec;
     #dscam045@#1002;
     ;
     nNumEmp, 001;
     nNumEmp, 999;
     ;
     NULL, ConfiRec;
|FIN;

|PROCESO Entregas;
     |BUCLE ConfiRec;
     |SI nSw = 2;
          #2#2 = #24#0;
          #2#3 = #24#1;
          #2#4 = #24#29;
          |GRABA 020#2a;
     |FINSI;
     |LIBERA #2;
|FPRC;

|DEFBUCLE Entregas;
     #2#1;
     ;
     "A", #0#52, #0#0, 01;
     "A", #0#52, #0#0, 99;
     be;
     NULL, Entregas;
|FIN;

|PROCESO CliEntre;
     nError = 0;
     |DBASS aPath;
     aPath = aPath + "dscarter/";
     aPathDef = aPath + "def/";
     aAlfa = aPathDef + "dscam045";
     |CARGA_DEF aAlfa, dscam045@;
     |SI FSalida = 0;
          |DFICE aAlfa;
          aNumEmp = aAlfa % -205;
          nNumEmp = aNumEmp;
          aPath = aPath + "fich/";
          |PATH_DAT #dscam045@#aPath#;

          aAlfa = aPathDef + "dscam003";
          |CARGA_DEF aAlfa, dscam003@;
          |SI FSalida ! 0; |MENAV "0000Error al cargar 'dscam003'"; |FINSI;

          aAlfa = aPathDef + "dscam067";
          |CARGA_DEF aAlfa, dscam067@;
          |SI FSalida ! 0; |MENAV "0000Error al cargar 'dscam067'"; |FINSI;

          |BUCLE Entregas;

          |DESCARGA_DEF #dscam067@;
          |DESCARGA_DEF #dscam003@;
          |DESCARGA_DEF #dscam045@;
     |FINSI;
     FSalida = nError;
|FPRC;

|PROCESO ModCliEntre;
     |GRABA 020#0a;      || 1901/1026 22/7/2013

     |ABRE #24;
     #24#0 = #0#3;
     |LEE 020#24=;
     |CIERRA #24;

     |ABRE #25;
     #25#0 = #0#6;
     |LEE 020#25=;
     |CIERRA #25;

     |ABRE #3;
     #3#0 = #0#3;
     #3#1 = #0#84;
     |LEE 020#3=;
     |CIERRA #3;

     |ABRE #91;
     #91#0 = #0#8;
     |LEE 000#91=;
     |CIERRA #91;

     nSw = 2; |HAZ CliEntre;
|FPRC;

|PROCESO CheqCliEntre;
     nSw = 1; |HAZ CliEntre;
|FPRC;
