|FICHEROS;
     tecay001 #0;
     dsm00053 #53;
     dsm00083 #83;

     agifa024 #24;
     agifa112 #112;
     agifa019 #19;
     agifa010 #10;
     agifa071 #71;
     agifa104 #104;
     agifa073 #73;
     agifa036 #36;
     agifa070 #70;
     agifa084 #84
     agifa069 #69;
     agi00027 #27;
     agi00028 #28;
     agifa077 #77;
     agifa080 #80;
     agifa081 #81;
     agifa067 #67;
|FIN;

|VARIABLES;
     &efFecha  = @;
     &eaTipo   = "";
     nHay      = 0;
     i         = 0;
     nPos      = 0;
     aReg      = "";
     aDato     = "";
     aLon      = "";
     aAlfa     = "";
     aCual     = "";
     aArt      = "";
     aCod      = "";
|FIN;

|PROCESO Lee;
     #19#0 = aArt;
     |LEE 000#19=;
     |SI eaTipo = "V";
          #24#0 = aCod;
          |LEE 000#24=;
     |SINO;
          #112#0 = aCod;
          |LEE 000#112=;
     |FINSI;
|FPRC;

|PROCESO LeeDocu;
     |SI eaTipo = "V";
          |SI aCual = "A";
               #10#52 = #53#1;
               #10#0 = #53#2;
               |LEE 000#10=;
               #71#29 = #53#1;
               #71#0 = #53#2;
               #71#1 = #53#3;
               |LEE 000#71=;
               efFecha = #10#1;
               aCod = #10#3;
               aArt = #71#2;
          |FINSI;
          |SI aCual = "D";
               #36#46 = #53#1;
               #36#0 = #53#2;
               |LEE 000#36=;
               #70#22 = #53#1;
               #70#0 = #53#2;
               #70#1 = #53#3;
               |LEE 000#70=;
               efFecha = #36#1;
               aCod = #36#3;
               aArt = #70#2;
          |FINSI;
          |SI aCual = "F";
               #84#48 = #53#1;
               #84#0 = #53#2;
               |LEE 000#84=;
               #69#20 = #53#1;
               #69#0 = #53#2;
               #69#1 = #53#3;
               |LEE 000#69=;
               efFecha = #84#1;
               aCod = #84#3;
               aArt = #69#2;
          |FINSI;
          |SI aCual = "P";
               #104#25 = #53#1;
               #104#0 = #53#2;
               |LEE 000#104=;
               #73#28 = #53#1;
               #73#0 = #53#2;
               #73#1 = #53#3;
               |LEE 000#73=;
               efFecha = #104#1;
               aCod = #104#4;
               aArt = #73#2;
          |FINSI;
          |HAZ Lee;
     |SINO;
          |SI aCual = "A";
               #77#50 = #83#1;
               #77#0 = #83#2;
               |LEE 000#77=;
               #80#27 = #83#1;
               #80#0 = #83#2;
               #80#1 = #83#3;
               |LEE 000#80=;
               efFecha = #77#1;
               aCod = #77#3;
               aArt = #80#2;
          |FINSI;
          |SI aCual = "P";
               #81#25 = #83#1;
               #81#0 = #83#2;
               |LEE 000#81=;
               #67#28 = #83#1;
               #67#0 = #83#2;
               #67#1 = #83#3;
               |LEE 000#67=;
               efFecha = #81#1;
               aCod = #81#4;
               aArt = #67#2;
          |FINSI;
          |SI aCual = "X";
               #27#0 = #83#2;
               |LEE 000#27=;
               #28#0 = #83#2;
               #28#1 = #83#3;
               |LEE 000#28=;
               efFecha = #27#1;
               aCod = #28#4;
               aArt = #28#2;
          |FINSI;
          |HAZ Lee;
     |FINSI;
|FPRC;

|PROCESO Busca;
     |QBF aAlfa;
     aLon = aAlfa % A0;
     aReg = "";
     |PARA i = 1; |SI i [ aLon; |HACIENDO i = i + 1;
          nPos = i * 100 + 1;
          aDato = aAlfa % nPos;
          |SI aDato = "|";
               |SI aReg ] #0#0; |Y aReg [ #0#1;
                    nHay = 1;
                    |HAZ LeeDocu;
                    |PRINT;
                    |SAL;
               |FINSI;
               aReg = "";
          |SINO;
               aReg = aReg + aDato;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO dsm00053;
     aCual = #53#0;
     aAlfa = #53#5;
     |HAZ Busca;
|FPRC;

|DEFBUCLE dsm00053;
     #53#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dsm00053;
|FIN;

|PROCESO dsm00083;
     aCual = #83#0;
     aAlfa = #83#5;
     |HAZ Busca;
|FPRC;

|DEFBUCLE dsm00083;
     #83#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dsm00083;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "tecay001";
          |SI FSalida ! 0;
               |MENAV "0000No existe Informe 'tecay001'";
          |SINO;
               |ABRE #24;
               |ABRE #112;
               |ABRE #19;
               |ABRE #10;
               |ABRE #71;
               |ABRE #104;
               |ABRE #73;
               |ABRE #36;
               |ABRE #70;
               |ABRE #84
               |ABRE #69;
               |ABRE #27;
               |ABRE #28;
               |ABRE #77;
               |ABRE #80;
               |ABRE #81;
               |ABRE #67;

               eaTipo = "V";
               |BUCLE dsm00053;

               eaTipo = "C";
               |BUCLE dsm00083;
               |SI nHay ! 0; |PIEINF; |FINSI;
               |FININF;

               |CIERRA #24;
               |CIERRA #112;
               |CIERRA #19;
               |CIERRA #10;
               |CIERRA #71;
               |CIERRA #104;
               |CIERRA #73;
               |CIERRA #36;
               |CIERRA #70;
               |CIERRA #84
               |CIERRA #69;
               |CIERRA #27;
               |CIERRA #28;
               |CIERRA #77;
               |CIERRA #80;
               |CIERRA #81;
               |CIERRA #67;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
