|FICHEROS;
     guery009 #0;
     guerm205 #1;
     guerm206 #2;
     guerw026 #26;
     guerw027 #27;
     agifa019 #19;
|FIN;

|VARIABLES;
     aImpre    = "";
     aInforme  = "";
     aInforme1 = "guery009";
     aInforme2 = "guery109";
     aInforme3 = "guery209";
     aAlfa     = "";
     nHay      = 0;
     dTipo     = "";
     hTipo     = "";
|FIN;

|PROCESO Imprime;
     #27#0 = #26#0;
     #27#1 = #26#1;
     |LEE 020#27=;

     #26#7 = #26#4 * 100 / #27#2;

     nHay = 1;
     |PRINT;
|FPRC;

|DEFBUCLE Imprime;
     #26#2;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Imprime;
|FIN;

|PROCESO guerm002;
     |SI #2#2 < #0#8; |O #2#2 > #0#9;   ||Articulo
          |ACABA;
     |FINSI;

     |DDEFECTO #27;
     #27#0 = #1#3;  ||Cli
     #27#1 = #1#29; ||Ob
     |SI #0#7 = 2; #27#1 = ""; |FINSI;
     |SI #0#7 = 3; #27#0 = ""; #27#1 = ""; |FINSI;
     |LEE 101#27=;
     |SI FSalida ! 0; |GRABA 020#27b; |FINSI;

     #27#2 = #27#2 + (#2#4/1000);
     |GRABA 020#27a;
     |LIBERA #27;

     |ABRE #19;
     #19#0 = #2#2;
     |LEE 000#19=;
     |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;
     |CIERRA #19;

     |DDEFECTO #26;
     #26#0 = #1#3;  ||Cli
     #26#1 = #1#29; ||Ob
     #26#2 = #2#2;  ||Art
     |SI #0#7 = 2; #26#1 = ""; |FINSI;
     |SI #0#7 = 3; #26#0 = ""; #26#1 = ""; |FINSI;
     |LEE 101#26=;
     |SI FSalida ! 0; |GRABA 020#26b; |FINSI;

     #26#3  = #2#3;
     #26#4  = #26#4  + (#2#7/1000);  ||Tone
     #26#13 = #26#13 + #2#7;         ||Total Unidades
     #26#6  = #26#6  + #2#6;         ||Impo
     #26#5  = #26#6  / #26#4;        ||Precio en Toneladas
     #26#10 = #26#6  / #26#13;       ||Precio sin Toneladas

     #26#8 = #1#4;
     #26#9 = #1#30;

     |SI #19#2 = "TN ";
         #26#11 = #26#11 + #2#7;         ||Total Unidades
     |FINSI;

     |SI #19#2 = "H  ";
         #26#12 = #26#12 + #2#7;         ||Total Unidades
     |FINSI;

     |GRABA 020#26a;
     |LIBERA #26;
|FPRC;

|DEFBUCLE guerm001;
     #1#9;
     15;
     #0#4, #0#0, #0#2, dTipo;
     #0#5, #0#1, #0#3, hTipo;
     ;
     NULL, NULL, guerm002;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |SI #0#6 = "X";
          dTipo = " ";
          hTipo = "z";
     |SINO;
          dTipo = #0#6;
          hTipo = #0#6;
     |FINSI;

  |ET Otra;
     |SI #0#7 = 1; aInforme = aInforme1; |FINSI;
     |SI #0#7 = 2; aInforme = aInforme2; |FINSI;
     |SI #0#7 = 3; aInforme = aInforme3; |FINSI;
     |SI aImpre ! "";
          Impresora = aImpre;
          |IMPRE -1;
     |SINO;
          |IMPRE 0;
     |FINSI;

     |SI FSalida = 0;
          aImpre = Impresora;
          |INFOR aInforme;
          |SI FSalida ! 0;
               aInforme = "0000 No existe informe " + aInforme;
               |MENAV aInforme;
          |SINO;
               aAlfa = Usuario; |QBF aAlfa;
               aAlfa = aAlfa + "1";
               |NOME_DAT #26 aAlfa;
               |DELINDEX #26;
               aAlfa = Usuario; |QBF aAlfa;
               aAlfa = aAlfa + "2";
               |NOME_DAT #27 aAlfa;
               |DELINDEX #27;

               |ABRE #26;
               |ABRE #27;
               |BUCLE guerm001;
               |CIERRA #27;
               |CIERRA #26;

               |ABRE #27;
               |BUCLE Imprime;
               |CIERRA #27;

               |DELINDEX #26;
               |DELINDEX #27;
               |SI nHay ! 0; |PIEINF; |FINSI;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
/*
     |SI #0#7 ! 3; |Y nHay ! 0;
          #0#7 = 3;
          |VETE Otra;
     |FINSI;
*/
|FPRC;

|PROGRAMA;
     |ABRE #0;
     |LEE 101#0=;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
     |CLS;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |GRABA 020#0a;
     |FINSI;
     |CIERRA #0;
|FPRO;
