|FICHEROS;
     dsy00012 #0;
     dsm00138 #1;
     dsm00139 #2;
     agifa112 #3;
     agifa007 #40;
     dsm00010 #910;
     dsm00083 #83;
|FIN;

|INCLUYE i_varart;

|VARIABLES;
     &eaImpElige = "";
     &enNumero = 0;

     &eaSerieDelega = "";

     &eaDoc = "";

     &enSwi    = 0;
     &eaImpre  = "";

     &aDivisa     = "";
     &aMoneda     = "";
     &enCodig     = 0;
     &eaNArticulo = "";

     &ser_ped     = "";
     &num_ped     = 0;
     &enPantalla  = 0;

     informe = "";
     &iva1 = 0;
     &iva2 = 0;
     &iva3 = 0;
     &iva4 = 0;
     &iva5 = 0;
     &re1 = 0;
     &re2 = 0;
     &re3 = 0;
     &re4 = 0;
     &re5 = 0;
     &bl  = "                              ";
|FIN;

|PROCESO DesAmpli;
     enSwi = 1;
     enSwDA = 1;
     |PRINT;
     enSwDA = 0;
     enSwi = 0;
|FPRC;

|DEFBUCLE DesAmpli;
     #83#1;
     ;
     "A", #2#27, #2#0, #2#1, 001;
     "A", #2#27, #2#0, #2#1, 999;
     ;
     NULL, DesAmpli;
|FIN;

|PROCESO IVAS;
     eaPrv = #1#3;
     efFiva = #1#1;
     enTiva = 1;  |HAZ IVAPrv; iva1 = enIva; re1 = enRec;
     enTiva = 2;  |HAZ IVAPrv; iva2 = enIva; re2 = enRec;
     enTiva = 3;  |HAZ IVAPrv; iva3 = enIva; re3 = enRec;
     enTiva = 4;  |HAZ IVAPrv; iva4 = enIva; re4 = enRec;
     enTiva = 5;  |HAZ IVAPrv; iva5 = enIva; re5 = enRec;
|FPRC;

|PROCESO prnalb1;|TIPO 0;
     eaSerLog = #1#50;
     eaNumLog = (A\("000000" + #1#0) % -106);
     eaTipLog = "DC";
     |HAZ ImprimeLog;

     |HAZ IVAS;
     aDivisa = #1#56;
     aMoneda = #1#58;
     |HAZ Divisas077;

     |SI #3#0 ! #1#3;
         #3#0 = #1#3;
         |LEE 021#3=;
         |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;
     |FINSI;

     #40#26 = #1#50;
     |LEE 001#40=;
     |SI FSalida ! 0;  |DDEFECTO #40;  |FINSI;

     informe = #40#47; |QBF informe;


     |INFOR informe;
     |SI FSalida ! 0;  |ERROR10;  |FINSI;

     |SI #910#19 = "S";  |HAZ AbreTemporales;  |FINSI;
|FPRC;

|PROCESO prnalbl;|TIPO 0;
     enArtImp = #2#2; |QBF enArtImp;

     |HAZ EsAparecida;
     |SI FSalida = 0;
          eaArticulo = #2#2;
          |HAZ ImpAparecida;
     |FINSI;

     |SI #910#19 = "N";
          |PRINT;

          |BUCLE DesAmpli;
          |ACABA;
     |FINSI;

     eaTipo      = "AC";
     eaSerie     = #2#27;
     enCodig     = #2#0;
     enLinea     = #2#1;
     eaArticulo  = #2#2;
     eaNArticulo = #2#4;
     enUnidades  = #2#5;
     enPrecio    = #2#6;
     enDto1      = #2#8;
     enDto2      = #2#26;
     |HAZ TrataCompo;
|FPRC;

|PROCESO prnalb2;|TIPO 0;
     |SI #910#19 = "S";  |HAZ ElRemate;  |FINSI;

     |PIEINF;
     |FININF;
|FPRC;

|DEFBUCLE agifa077;
     #1#3;
     ;
     #0#0, #0#4, #0#8, #0#2;
     #0#1, #0#5, #0#9, #0#3;
     e;
     NULL,  prnalb1,  prnalbl,  prnalb2;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |SI eaFicImpre = "";
        |SI eaImpre ! ""
           Impresora = eaImpre;
           |IMPRE -1;
        |SINO;
           |IMPRE 1;
        |FINSI;
     |SINO;
          Impresora = eaFicImpre;
          |IMPRE -77;
     |FINSI;
     eaImpElige = Impresora;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #3;
     |ABRE #40;
     |BUCLE agifa077;
     |CIERRA #40;
     |CIERRA #3;

     |FINIMP;
|FPRC;

|PROGRAMA;
     |HAZ MiraLogos; || Copia Logos para el Crystal

     enPantalla  = 0;

     |ABRE #910;
     |LEE 040#910p;
     |SI FSalida ! 0;  |DDEFECTO #910;  |FINSI;
     |CIERRA #910;

     |SI ser_ped = ""; |Y num_ped = 0;
         |CLS;
         |CABEZA "Imp.Albaranes";
         |PINPA #0#0;
         |PINDA #0#0;
         |ENDATOS #1#0;
         |SI FSalida = 0;  |HAZ Tipo3;  |FINSI;
     |SINO;
         #0#8 = ser_ped;
         #0#9 = ser_ped;
         #0#2 = num_ped;
         #0#3 = num_ped;
         |HAZ Tipo3;
     |FINSI;
|FPRO;
