|FICHEROS;
     agifa069 #69;
     agifa071 #71;
     agifa080 #80;
     referen@;
|FIN;

|VARIABLES;
     &eaViaSer = "";
     &enViaNum = 0;
     &enViaLin = 0;
     aFic = "";
     aDef = "";
|FIN;

|PROCESO CargaFic;
     |DDEF aDef;
     aDef = aDef + aFic;
     |CARGA_DEF aDef, referen@;
     |SI FSalida ! 0;
          aDef = "0000ERROR al Cargar: " + (aDef % -108);
          |MENAV aDef;
     |FINSI;
|FPRC;

|PROCESO ViaBajaAlbVta;
     aFic = "viarsa01"; |HAZ CargaFic;
     |SI FSalida = 0;
          |ABRE #referen@;
          #referen@#0 = #71#29;
          #referen@#1 = #71#0;
          #referen@#2 = #71#1;
          |BORRA 000#referen@.c;
          |CIERRA #referen@;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO ViaModiAlbVta;
     eaViaSer = #71#29;
     enViaNum = #71#0;
     enViaLin = #71#1;
     |SUB_EJECUTA_NP "viarsa01";
     |HAZ ViaPinAlbVta;
|FPRC;

|PROCESO ViaPinAlbVta;
     aFic = "viarsa01"; |HAZ CargaFic;
     |SI FSalida = 0;
          |DDEFECTO #referen@;
          |ABRE #referen@;
          #referen@#0 = #71#29;
          #referen@#1 = #71#0;
          #referen@#2 = #71#1;
          |LEE 000#referen@.=;
          |CIERRA #referen@;
          |ATRI R; |PINTA 1236, "Cuenta ³De³Sub "; |ATRI 0;
          |PINTA #referen@#3;
          |PINTA #referen@#4;
          |PINTA #referen@#5;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO ViaBajaAlbCom;
     aFic = "viarsa02"; |HAZ CargaFic;
     |SI FSalida = 0;
          |ABRE #referen@;
          #referen@#0 = #80#27;
          #referen@#1 = #80#0;
          #referen@#2 = #80#1;
          |BORRA 000#referen@.c;
          |CIERRA #referen@;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO ViaModiAlbCom;
     eaViaSer = #80#27;
     enViaNum = #80#0;
     enViaLin = #80#1;
     |SUB_EJECUTA_NP "viarsa02";
     |HAZ ViaPinAlbCom;
|FPRC;

|PROCESO ViaPinAlbCom;
     aFic = "viarsa02"; |HAZ CargaFic;
     |SI FSalida = 0;
          |DDEFECTO #referen@;
          |ABRE #referen@;
          #referen@#0 = #80#27;
          #referen@#1 = #80#0;
          #referen@#2 = #80#1;
          |LEE 000#referen@.=;
          |CIERRA #referen@;
          |ATRI R; |PINTA 1228, "Cuenta ³De³Sub "; |ATRI 0;
          |PINTA #referen@#3;
          |PINTA #referen@#4;
          |PINTA #referen@#5;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO ViaBajaFac;
     aFic = "viarsa03"; |HAZ CargaFic;
     |SI FSalida = 0;
          |ABRE #referen@;
          #referen@#0 = #69#20;
          #referen@#1 = #69#0;
          #referen@#2 = #69#1;
          |BORRA 000#referen@.c;
          |CIERRA #referen@;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO ViaModiFac;
     eaViaSer = #69#20;
     enViaNum = #69#0;
     enViaLin = #69#1;
     |SUB_EJECUTA_NP "viarsa03";
     |HAZ ViaPinFac;
|FPRC;

|PROCESO ViaPinFac;
     aFic = "viarsa03"; |HAZ CargaFic;
     |SI FSalida = 0;
          |DDEFECTO #referen@;
          |ABRE #referen@;
          #referen@#0 = #69#20;
          #referen@#1 = #69#0;
          #referen@#2 = #69#1;
          |LEE 000#referen@.=;
          |CIERRA #referen@;
          |ATRI R; |PINTA 1236, "Cuenta ³De³Sub "; |ATRI 0;
          |PINTA #referen@#3;
          |PINTA #referen@#4;
          |PINTA #referen@#5;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;
