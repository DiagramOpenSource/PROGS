|FICHEROS;
     agifa311 #0;
     agifa312 #1;   || Tmp
     agifa104 #2;   || Ped. Ventas (C)
     agifa073 #3;   ||             (L)
     agifa081 #4;   || Ped. Com    (C)
     agifa067 #5;   ||             (L)
     agifa010 #6;   || Alb Ventas  (C)
     agifa071 #7;   ||             (L)
     agifa077 #8;   || Alb  Com    (C)
     agifa080 #9;   ||             (L)
     agifa019 #10;  || Arti
     agifa321 #55;
     agifa324 #66;
|FIN;

|VARIABLES;
     &nDeci_Base = 0;
     &nDeci_PreBase = 0;
     &nDeci_PreBaseMx = 0;
     &Tempo    = "";
     aTempo1   = "";
     fichero   = "";
     informe   = "agifa311";
     hay       = 0;
|FIN;

|PROCESO mayus; |TIPO 0;
     #0Campo = #0Campo > #0Campo;
     |PINTA #0Campo;
|FPRC;
----------------------------------------------------------------
|PROCESO agifa402;
     #10#0 = #1#3;
     |LEE 000#10=;
     |SI FSalida ! 0; |DDEFECTO #10; |FINSI;
     |PRINT;
|FPRC;

|DEFBUCLE agifa402;
     #1#1;
     ;
     "     ",        0, 001;
     "zzzzz",   999999, 999;
     ;
     NULL, agifa402;
|FIN;
----------------------------------------------------------------
|PROCESO agifa073;
     |DDEFECTO #1;
     #1#0 = #3#28;        || S. PV
     #1#1 = #3#0;         || N. PV
     #1#2 = #3#1;         || Lin
     #1#3 = #3#2;         || Arti
     #1#4 = #3#5;         || Cant
     #1#5 = #3#6;         || Pre
     #1#6 = #3#7;         || Impo

     #5#30 = #1#0;       || Se
     #5#29 = #1#1;       || Nu
     #5#31 = #1#2;       || Li
     |LEE 000#5=;        ||                  Pedido Compras (L)
     |SI FSalida ! 0; |DDEFECTO #5; |FINSI;

     #4#25 = #5#28;
     #4#0 = #5#0;
     |LEE 000#4=;        ||                  Pedidos Compras (C)
     |SI FSalida ! 0; |DDEFECTO #4; |FINSI;

     #9#29 = #5#28;
     #9#12 = #5#0;
     #9#21 = #5#1;
     |LEE 000#9=;        ||                  Alb Compras (L)
     |SI FSalida ! 0; |DDEFECTO #9; |FINSI;

     #7#31 = #1#0;
     #7#12 = #1#1;
     #7#21 = #1#2;
     |LEE 000#7=;        ||                  Alb Ventas (L)
     |SI FSalida ! 0; |DDEFECTO #7; |FINSI;

     #6#52 = #7#29;
     #6#0 = #7#0;
     |LEE 000#6=;        ||                  Alb Ventas (C)
     |SI FSalida ! 0; |DDEFECTO #6; |FINSI;

     #1#7 = #9#6;        || Pre. Venta (Coste)
     #1#8 = #1#5 - #1#7; || Dife
     #1#9 = #6#52;       || S.Ab V
     #1#10 = #6#0;       || N.Ab V
     #1#11 = #6#53;      || S.Fac V
     #1#12 = #6#39;      || N.Fac V
     #1#13 = #9#27;      || S.Ab C
     #1#14 = #9#0;       || N.Ab C
     #1#15 = #6#38;       || Facturado
     |SI #0#8 = "A";
          |GRABA 021#1n;
          hay = hay + 1;
     |SINO;
          |SI #0#8 = "S";
               |SI #1#15 = "S";
                    |GRABA 021#1n;
                    hay = hay + 1;
               |FINSI;
          |SINO;
               |SI #1#15 = "N";
                    |GRABA 021#1n;
                    hay = hay + 1;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE agifa104;
     #2#1;
     1, 4;
     #0#0, #0#2, #0#4, #0#6;
     #0#1, #0#3, #0#5, #0#7;
     ;
     NULL, NULL, agifa073;
|FIN;
----------------------------------------------------------------
|PROCESO tipo3; |TIPO 3;
     |HAZ LeeDecimBaseLi;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR informe;
          |SI FSalida = 0;
               |HAZ CreaTempo; aTempo1 = Tempo;
               |NOME_DAT #1 aTempo1; |DELINDEX #1;
               |ABRE #1;
               |ABRE #4;
               |ABRE #5;
               |ABRE #6;
               |ABRE #7;
               |ABRE #9;
               |SELECT #4#5;
               |SELECT #4#7;
               |SELECT #3#9;
               |BUCLE agifa104;
               |CIERRA #1;
               |CIERRA #4;
               |CIERRA #5;
               |CIERRA #6;
               |CIERRA #7;
               |CIERRA #9;
               |SI hay = 0;
                    |MENAV "0000Seleccion Vacia...";
               |SINO;
                    |ABRE #10;
                    |BUCLE agifa402;
                    |CIERRA #10;
                    |PIEINF;
                    |FININF;
               |FINSI;
               |DELINDEX #1; Tempo = aTempo1; |HAZ BoraTempo;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO LeeDecimBaseLi;
     |ABRE #agifa321;
     |ABRE #agifa324;
     |LEE 001#agifa321.p;
     #agifa324#0 = #agifa321#9; ||Igualo a moneda base
     |LEE 001#agifa324.=;
     nDeci_Base = #agifa324#7;  ||Decimales moneda base
     nDeci_PreBase = #agifa324#9;  ||Decimales precio de moneda base
     nDeci_PreBaseMx = #agifa324#9;  ||Decimales precio de moneda base
     |CIERRA #agifa321;
     |CIERRA #agifa324;
|FPRC;
