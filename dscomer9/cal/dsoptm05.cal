|FICHEROS;
     dsoptm05 #0;
     agifa024 #24,MANTE;
     dsm00003 #3,MANTE;
     agifa025 #25;
     agifa027 #27;
     agifm001 #101;
     agifm002 #102;
     agifa142 #142;

     psioa076 #76;
|FIN;

|VARIABLES;
     nNume = 0;
     nHandle = 0;
     aFic = "";
     aTablet = "";
     aAlfa = "";
     aParam = "";
     aCli = "";
     aDir = "";
     aTipo = "";
     nCliente = 0;
     aCliente = "";

     {-1}menu = "";
     menu1 = "2400";
     menu2 = "1";
     menu3 = "Contador:  ";
     menu4 = "AM";
     menu5 = " Automatico ";
     menu6 = " Manual ";
|FIN;

|PROCESO Menu;
     |MENU menu;
     |SI FSalida = 1;    ||Automatico
          |HAZ EsVipei;
          |SI FSalida = 0;
               |LEE 000#24u;
               |SI FSalida = 0;
                    nCliente = #24#0;
                    nCliente = nCliente + 1;
               |SINO;
                    nCliente = 1;
               |FINSI;
               aCliente = ("000000" + nCliente) % -106;
          |SINO;
               |ABRE #27;
               #27#0 = "clientes";
               |LEE 101#27=;
               |SI FSalida = 0;
                    #27#1 = #27#1 + 1;
                    nCliente = #27#1;
                    |GRABA 021#27a;
               |SINO;
                    nCliente = 1;
                    #27#1 = 1;
                    |GRABA 021#27n;
               |FINSI;
               |CIERRA #27;
               aCliente = ("000000" + nCliente) % -106;
          |FINSI;
          FSalida = 0;
     |FINSI;
|FPRC;

|PROCESO AltaCliPotencial;
     |DFICE aFic; aFic = aFic + Usuario;
     |FBORRA aFic;

     |ABRE #76;
     #76#0 = aCli;
     #76#13 = aTablet;
     |LEE 121#76=;
     |SI FSalida = 0;
          |ABRE #24;
          |PINPA #0#24;
          |PINDA #0#24;
          aCliente = "000000";
          |SI #142#1 = "S";
               |HAZ Menu;
          |SINO;
               FSalida = 0;
          |FINSI;
          |SI FSalida = 0;
               |C_P #24#0, 0, nNume;
               |C_P #0#0, 1, nNume;

               |PULSATECLA;

               #0#0 = aCliente;
               |ENCAMPO #0#0;
               |SI FSalida [ 0;
                    |DDEFECTO #24;
                    #24#0 = #0#0;
                    |LEE 000#24=;
                    |SI FSalida = 0;
                         |MENAV "0000El cliente ya existe...";
                    |SINO;
                         #24#1 = #76#1;
                         #24#2 = #76#2;

                         #24#5 = #76#3; #24#8 = #24#5; #24#11 = #24#5;
                         #24#6 = #76#4; #24#9 = #24#6; #24#12 = #24#6;
                         #24#7 = #76#6; #24#10 = #24#7; #24#13 = #24#7;
                         #24#178 = #76#5; #24#181 = #24#178; #24#184 = #24#178;
                         aAlfa = #76#5 % 303;
                         #24#179 = aAlfa; #24#182 = #24#179; #24#185 = #24#179;
                         #24#180 = #76#5; #24#183 = #24#180; #24#186 = #24#180;

                         #24#15 = #76#7;
                         #24#17 = #76#8;
                         #24#196 = #76#9;
                         #24#197 = #76#10;
                         #24#36 = #76#11;
                         #24#53 = #76#12;
                         |GRABA 020#24b;
                         |PINDA #0#24;
                         |ENDATOS #1#24;
                         |SI FSalida = 0;
                              |GRABA 020#24a;

                              aAlfa = #24#0;
                              |XABRE "W", aFic, nHandle;
                              |XGRABA nHandle, aAlfa;
                              |XCIERRA nHandle;

                         |SINO;
                              |BORRA 020#24c;
                         |FINSI;
                    |FINSI;
               |FINSI;
          |FINSI;
          |CIERRA #24;
     |FINSI;
     |CIERRA #76;
|FPRC;

|PROCESO Graba1_Dir;
     |ABRE #101;
     #101#0 = #24#3;
     |LEE 000#101=; || Zona
     |CIERRA #101;
     |ABRE #102;
     #102#0 = #24#189;
     |LEE 000#102=; ||Ruta
     |CIERRA #102;
     |ABRE #25;
     #25#0 = #24#25;
     |LEE 000#25=;
     |CIERRA #25;

     |ABRE #3;
     |DDEFECTO #3;
     #3#0 = #24#0;
     #3#1 = 1;
     |LEE 101#3=;
     |SI FSalida ! 0; |GRABA 021#3b; |FINSI;
     #3#2 = #24#5;
     #3#3 = #24#6;
     #3#4 = #24#178;
     #3#5 = #24#179;
     #3#6 = #24#180;
     #3#7 = #24#7;
     #3#8 = #24#14;
     #3#10 = #24#2;
     #3#11 = #24#3;
     #3#12 = #101#1;
     #3#13 = #24#17;
     #3#14 = #24#25;
     #3#15 = #25#1;
     #3#16 = #24#189;
     #3#17 = #102#1;
     #3#19 = #24#205;
     #3#20 = #24#196;
     #3#21 = #24#18;
     #3#22 = #24#36;
     #3#23 = #24#211;
     |GRABA 021#3a;
     |CIERRA #3;
|FPRC;

|PROCESO AltaCli;
     |ABRE #24;
     #24#0 = aCli;
     |GRABA 020#24b;
     |SI FSalida ! 0;
          |MENAV "0000Cliente existente...";
          |ACABA;
     |FINSI;

     |PINPA #0#24;
     |PINDA #0#24;
     |ENDATOS #1#24;
     |SI FSalida = 0;
          |GRABA 020#24a;
          |HAZ Graba1_Dir;
     |SINO;
         |BORRA 020#24c;
     |FINSI;
     |CIERRA #24;
|FPRC;

|PROCESO ModiCli;
     |ABRE #24;
     #24#0 = aCli;
     |LEE 101#24=;
     |SI FSalida ! 0;
          |MENAV "0000Cliente inexistente...";
          |ACABA;
     |FINSI;
     |PINPA #0#24;
     |PINDA #0#24;
     |ENDATOS #2#24;
     |SI FSalida = 0;
          |GRABA 020#24a;
          |HAZ Graba1_Dir;
     |FINSI;
     |CIERRA #24;
|FPRC;

|PROCESO DefeDir;
     |ABRE #24;
     #24#0 = aCli;
     |LEE 000#24=;
     |CIERRA #24;
     |ABRE #101;
     #101#0 = #24#3;
     |LEE 000#101=; || Zona
     |CIERRA #101;
     |ABRE #102;
     #102#0 = #24#189;
     |LEE 000#102=; ||Ruta
     |CIERRA #102;
     |ABRE #25;
     #25#0 = #24#25;
     |LEE 000#25=;
     |CIERRA #25;

     #3#2 = #24#5;
     #3#3 = #24#6;
     #3#4 = #24#178;
     #3#5 = #24#179;
     #3#6 = #24#180;
     #3#7 = #24#7;
     #3#8 = #24#14;
     #3#10 = #24#2;
     #3#11 = #24#3;
     #3#12 = #101#1;
     #3#13 = #24#17;
     #3#14 = #24#25;
     #3#15 = #25#1;
     #3#16 = #24#189;
     #3#17 = #102#1;
     #3#19 = #24#205;
     #3#20 = #24#196;
     #3#21 = #24#18;
     #3#22 = #24#36;
     #3#23 = #24#211;
|FPRC;

|PROCESO AltaDir;
     |ABRE #3;
     #3#0 = aCli;
     #3#1 = aDir;
     |GRABA 020#3b;
     |SI FSalida ! 0;
          |MENAV "0000Cliente existente...";
          |ACABA;
     |FINSI;

     |HAZ DefeDir;

     |PINPA #0#3;
     |PINDA #0#3;
     |ENDATOS #1#3;
     |SI FSalida = 0;
          |GRABA 020#3a;
     |SINO;
         |BORRA 020#3c;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROGRAMA;
     |PULSATECLA;

     |ABRE #142; |LEE 000#142p; |CIERRA #142;

     |CLS;
     aTipo = PARAMETRO % 101;
     aCli = PARAMETRO % 206;
     |SI aTipo = "C";
          |HAZ AltaCli;
     |SINO;
          |SI aTipo = "M";
               |HAZ ModiCli;
          |SINO;
               |SI aTipo = "P";
                    aTablet = PARAMETRO % 815;
                    |HAZ AltaCliPotencial;
               |SINO;
                    aDir = PARAMETRO % 804;
                    |HAZ AltaDir;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRO;
