|FICHEROS
     porm0005 #0;
|FIN;

|VARIABLES;
||para el digito de control
 {-1}nPesos = 0;
   nPesos1 = 1;
   nPesos2 = 2;
   nPesos3 = 4;
   nPesos4 = 8;
   nPesos5 = 5;
   nPesos6 = 10;
   nPesos7 = 9;
   nPesos8 = 7;
   nPesos9 = 3;
   nPesos10= 6;

   i=0;
   nValor  = 0;
   aAlfa1="";
   aAlfa2="";
   aAlfa3 = "";
   nNume1=0;
   nNume2 = 0;
   nNume3 = 0;
   aBuf  = "";
   aDigi1 = "";
   aDigi2 = "";
|FIN;

|PROCESO Tipo12x;|TIPO 12;

|FPRC;

|PROCESO Calculax;
     nValor = 0;
     |PARA i=1;|SI i[10;|HACIENDO i=i+1;
          nNume2 = (i * 100);
          nNume2 = nNume2 + 1;
          aAlfa3 = nNume2;
          aAlfa2 = aBuf % aAlfa3;
          nNume3 = aAlfa2;
          InPesos = nPesos1<-;                ||Posiciono el array al pri$
          InPesos = InPesos + (i - 1);        ||Avanzo las posiciones nec$
          nValor = nValor + (nNume3 * nPesos);
     |SIGUE;
     nNume1=11 - (nValor $ 11);
     aAlfa1=nNume1;
|FPRC;

|PROCESO Digito1x;
     aBuf = #0#8;            || entidad o codigo de banco
     |QBF aBuf;
     aBuf=aBuf+#0#9;         || sucursal
     |QBF aBuf;
     aBuf="00"+aBuf;
     |HAZ Calculax;
     aDigi1=aAlfa1 % 101;
     #0#10 = aDigi1 + aDigi2;
     |PINTA #0#10;            || DC
|FPRC;

|PROCESO Digito2x;
     aBuf = #0#11;            || N§ Cuenta
     |QBF aBuf;
     |HAZ Calculax;
     aDigi2 = aAlfa1;
     #0#10 =  aDigi1 + aDigi2;
     |PINTA #0#10;
|FPRC;
