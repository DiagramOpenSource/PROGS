|FICHEROS;
     malpe169 #0;
     dscam000@ #1;

     origen@;
     destino@;
|FIN;

|VARIABLES;
     aBase = "";
     aAlfa = "";
     aFic = "";
     aDef = "";
|FIN;

|PROCESO Cambia;
     |BORRA 020#origen@.a;
     |SALVA_DATOS #origen@;
     |REPON_DATOS #destino@;
     |BORRA 040#destino@.c;
     |GRABA 020#destino@.n;
|FPRC;

|DEFBUCLE dscam003;
     #origen@#1001;
     0;
     000000001, #0#1;
     999999999, #0#1;
     be;
     NULL, Cambia;
|FIN;

|DEFBUCLE dscam004;
     #origen@#1002;
     0;
     000000001, 01, #0#1;
     999999999, 99, #0#1;
     be;
     NULL, Cambia;
|FIN;

|DEFBUCLE dscam013;
     #origen@#1002;
     4;
     00001, 01, #0#1;
     99999, 99, #0#1;
     be;
     NULL, Cambia;
|FIN;

|PROCESO Tipo66; |TIPO 66;
     |DBASS aAlfa;
     aAlfa = aAlfa + "dscarter/def/dscam000";
     |CARGA_DEF aAlfa, dscam000@;
     |SI FSalida ! 0;
          |MENAV "0000Error al cargar 'dscam000'";
          |ACABA;
     |FINSI;

     |DBASS aAlfa;
     aAlfa = aAlfa + "dscarter/fich/";
     |PATH_DAT #1 aAlfa;
     |ABRE #1;
     #1#0 = #0Campo;
     |LEE 000#1];
     |CONSULTA_CLAVE #1#1;
     |SI FSalida = 0;
          #0Campo = #1#0; |PINTA #0Campo;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #1;

     |DESCARGA_DEF #dscam000@;
|FPRC;

|PROCESO Tipo0; |TIPO 0;
     |DBASS aAlfa;
     aAlfa = aAlfa + "dscarter/def/dscam000";
     |CARGA_DEF aAlfa, dscam000@;
     |SI FSalida ! 0;
          |MENAV "0000Error al cargar 'dscam000'";
          |ACABA;
     |FINSI;

     |DBASS aAlfa;
     aAlfa = aAlfa + "dscarter/fich/";
     |PATH_DAT #1 aAlfa;
     |ABRE #1;
     #1#0 = #0Campo;
     |LEE 000#1=;
     |SI FSalida ! 0;
          |MENAV "0000No existe Empresa Cartera...";
          |ERROR;
     |SINO;
          |SI #0#2 = #0#0; |Y Campo = 0;
               |MENAV "0000La empresa destino no puede ser la actual...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #1;

     |DESCARGA_DEF #dscam000@;
|FPRC;

|PROCESO Carga;
     |DBASS aDef;
     aDef = aDef + "dscarter/def/";

     aAlfa = aDef + aFic;
     |CARGA_DEF aAlfa, origen@;
     |SI FSalida ! 0;
          aAlfa = "0000ERROR al cargar: " + aAlfa;
          |MENAV aAlfa; |ACABA;
     |FINSI;
     aAlfa = aDef + aFic;
     |CARGA_DEF aAlfa, destino@;
     |SI FSalida ! 0;
          aAlfa = "0000ERROR al cargar: " + aDef;
          |MENAV aAlfa; |ACABA;
     |FINSI;

     |DBASS aBase;
     aAlfa = aBase + "dscarter/fich/" + (("00000" + #0#0) % -105) + "/";
     |PATH_DAT #destino@#aAlfa#;
     |ABRE #destino@;

     aAlfa = aBase + "dscarter/fich/" + (("00000" + #0#2) % -105) + "/";
     |PATH_DAT #origen@#aAlfa#;
|FPRC;

|PROCESO Descarga;
     |CIERRA #destino@;
     |DESCARGA_DEF #destino@;
     |DESCARGA_DEF #origen@;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     aFic = "dscam003";
     |HAZ Carga;
     |SI FSalida = 0;
          |BUCLE dscam003;
          |HAZ Descarga;
     |FINSI;

     aFic = "dscam004";
     |HAZ Carga;
     |SI FSalida = 0;
          |BUCLE dscam004;
          |HAZ Descarga;
     |FINSI;

     aFic = "dscam013";
     |HAZ Carga;
     |SI FSalida = 0;
          |BUCLE dscam013;
          |HAZ Descarga;
     |FINSI;
|FPRC;
