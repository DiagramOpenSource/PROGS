|FICHEROS;
foto0102 #0;
agift561 #1;
foto0075 #2;
|FIN;

|VARIABLES;
  ip_serv = "";
  serv_correo = "";
  from = "";
  to = "";
  subject = "";
  mensaje = "";
  ficheros = "";
  prim = 0;
  &errorenv = 0;
|FIN;

|PROGRAMA;
|CONFI "0000SEsta seguro de que desea enviar los datos";
|SI FSalida = 0;
  errorenv = 0;
  |ABRE #0;
  |ABRE #1;
  |LEE 010#1p;
  |SI FSalida ! 0;
    |MENAV "0000No se han establecido los parametros de envio";
  |SINO;
    ip_serv = #1#1+"."+#1#2+"."+#1#3+"."+#1#4;
    serv_correo = #1#5;
    from = #1#6;
    prim = 0;
    to = #1#7;
    subject = #1#8;
    mensaje = #1#9;
    ficheros = #1#10;
    |QBT ip_serv ;
    |QBF serv_correo;
    |QBF from;
    |QBF to;
    |QBF subject;
    |QBF mensaje;
    |QBF ficheros;
    |MENSA "0000Enviando fichero ...";
    |DSCORREO_ENVIA ip_serv,serv_correo,from,to,subject,mensaje,ficheros;
    |SI FSalida ! 0;
      |MENAV "0000Ha habido un error durante el envio.";
      errorenv = 1;
    |SINO;
      |MENSA "000Mensaje enviado."
    |FINSI;
  |FINSI;
  |CIERRA #1;
  |CIERRA #0;
|FINSI;
|FPRO;
