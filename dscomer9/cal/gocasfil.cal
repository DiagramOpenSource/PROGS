|FICHEROS;
     gocasfil #0;
     gocasres #1,MANTE;
     agifa321 #2;
     agifa112 #3;
     gomantca #4;
     gopre001 #5;
     goparame #100;
|FIN;
----------------------------------------------------------------------
|VARIABLES;
     nHay           = 0;

     cUsuario       = "";

     &cCodMonBase   = "";
     &cDesMonBase   = "";
     &cCodMonTrab   = "";
     &cDesMonTrab   = "";

     &nDeci_PBase   = 0;
     &nDeci_TBase   = 0;
     &nDeci_PTrab   = 0;
     &nDeci_TTrab   = 0;
     &nDeci_TotVis  = 0;
     &nEurComTrab   = 0;
     &nEurComBase   = 0;
     &nEurVenTrab   = 0;
     &nEurVenBase   = 0;

|FIN;
----------------------------------------------------------------------
----------------------------------------------------------------------
|PROGRAMA;
     |CLS;
     |CABEZA "CONSULTA DE CASETAS";
     nHay = 0;
     |ABRE #0;
     #0#13 = 0;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |HAZ Salida;
     |FINSI;
|FPROG;
----------------------------------------------------------------------
|PROCESO GrabCasePart;
     |SI #1#15 = "C";
          #0#13 = #0#13 + #1#16;                  ||Cantidad Cargos;
     |FINSI;
     |SI #1#15 = "A";
          #0#14 = (#0#14 - #1#16);                ||Cantidad Abonos;
     |FINSI;
     |SI #1#15 = "D";
          #0#15 = #0#15 + #1#16;                  ||Cantidad Devoluciones;
     |FINSI;
     #0#16 = #0#16 + #1#17;                       ||Total Venta Trabajo.
     #0#17 = #0#17 + #1#19;                       ||Total Coste Trabajo.
     nHay = 1;
|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE MiraCasePart;
     #1#2;
     ;                                          ||Campos Extras.
        1, #0#0, #0#2, #0#4, #0#6, #0#8, #0#10, #0#19;
     9999, #0#1, #0#3, #0#5, #0#7, #0#9, #0#11, #0#20;
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, GrabCasePart;
|FIN;
-------------------------------------------------------------------------------
|PROCESO Salida;
     |ABRE #2;
     #2#0 = "A";
     |LEE 000#2=;
     |SI FSalida = 0;
          cCodMonTrab = #2#9;
          ||SUB_EJECUTA_NP "gomoneda";
          |HAZ MonBas;
     |FINSI;
     |CIERRA #2;
     cUsuario = Usuario % 810;
     |ABRE #1;
     #1#18 = cUsuario;
     |LEE 101#1=;
     |SI FSalida ! 0;
          |GRABA 020#1c;
     |FINSI;
     |DDEFECTO #1;
     |BUCLE MiraCasePart;
     |SI nHay = 1;
          |SI #0#12 = "P";
               |ENTLINEAL #2#1, 1, 4, 19, 1, MinCase, MaxCase;
          |SINO;
               |HAZ Impresora;
          |FINSI;
     |SINO;
          |MENAV "0000SELECCION VACIA";
     |FINSI;
     |CIERRA #1;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO MinCase;
     #1#0 = 1;
     #1#1 = #0#0;
     #1#2 = #0#2;
     #1#3 = #0#4;
     #1#4 = #0#6;
     #1#7 = #0#8;
     #1#12 = #0#10;
     #1#25 = #0#19;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO MaxCase;
     #1#0 = 9999;
     #1#1 = #0#1;
     #1#2 = #0#3;
     #1#3 = #0#5;
     #1#4 = #0#7;
     #1#7 = #0#9;
     #1#12 = #0#11;
     #1#25 = #0#20;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO Imprime;
     |PRINT;
|FPRC;
-----------------------------------------------------------------------------
|DEFBUCLE Imprime;
     #1#2;
     ;
     1   ,#0#0,#0#2,#0#4,#0#6,#0#8,#0#10,#0#19;
     9999,#0#1,#0#3,#0#5,#0#7,#0#9,#0#11,#0#20;
     ;
     NULL,Imprime;
|FIN;
-----------------------------------------------------------------------------
|PROCESO Impresora;
     |SUB_EJECUTA_NP "goinform;IMPgocaseta";
     |INFOR "gocaseta";
     |BUCLE Imprime;
     |PIEINF;
     |FININF;
     |SUB_EJECUTA_NP "goinform;ENVgocaseta";
     |SUB_EJECUTA_NP "goinform;RUNgocaseta";
|FPRC;
-----------------------------------------------------------------------------
|PROCESO Posicion; |TIPO 7;
     |ABRE #3;
     |LEE 010#3p;
     |SI FSalida = 0;
          #0#8 = #3#0;
          #0#21 = #3#1;
     |FINSI;
     |LEE 010#3u;
     |SI FSalida = 0;
          #0#9 = #3#0;
          #0#22 = #3#1;
     |FINSI;
     |CIERRA #3;
     |ABRE #4;
     |LEE 000#4p;
     |SI FSalida = 0;
          #0#0 = #4#0;
          #0#2 = #4#1;
     |FINSI;
     |LEE 000#4u;
     |SI FSalida = 0;
          #0#1 = #4#0;
          #0#3 = #4#1;
     |FINSI;
     |CIERRA #4;
     |ABRE #5;
     |LEE 000#5p;
     |SI FSalida = 0;
          #0#4 = #5#0;
          #0#6 = #5#1;
     |FINSI;
     |LEE 000#5u;
     |SI FSalida = 0;
          #0#5 = #5#0;
          #0#7 = #5#1;
     |FINSI;
     |CIERRA #5;
     |PINDA #0#0;
|FPRC;
-----------------------------------------------------------------------------

|PROCESO Tipo13; |TIPO 13;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     |SI #100#141 = "O";
          |ATRI R; |PINTA 1304, "   O.T.    "; |ATRI 0;
          |ATRI R; |PINTA 1504, "   O.E.    "; |ATRI 0;
     |FINSI;
|FPRC;
