/*
|FICHEROS;
     tagz0020 #0;
     tagm0030 #30;
     tagm0031 #31;
     tagw0036 #36;        || Tmp Grid
     tagw0038 #38;        || Tmp Lin ped
     tagw0039 #39,MANTE;  || Ver ped
     tagw0044 #44,MANTE;  || Maquina
     agifa073 #73;
     tagm0079 #79;
     tagm0080 #80;
     tagm0081 #81;
     tagm0083 #83;
     tagm0084 #84;
     tagm0085 #85;
     tagm0087 #87;
     agifa104 #104;
     agifa142 #142;
|FIN;

|VARIABLES;
     nSwAuto = 0;
     aTecla1 = "";
     aHora1 = "";
     &eaCodCB = "";
     aConte = "";
     nHandle = 0;
     aItem = "";
     aRojo = "0,0,0;233,150,122";
     aAmarillo = "0,0,0;250,250,210";
     aVerde = "0,0,0;152,251,152";
     aColor = "0,0,0;0,0,0";
     {2}nNivel = 0;
     aEsc1 = "";
     aEsc2 = "";
     aRetu = "";
     aTecla = "";

     &Tempo = "";
     aTmp36 = "";
     aTmp38 = "";
     nRango = 0;
     i = 0;
     nOk = 0;
     aAlfa = "";
     nTipo = 0;
     aBoton = "";
     aID = "";
     nBoton = 0;
     nSwBoton = 0;
     aEstado = "";
     nError = 0;
     nHora1 = 0;
     nHora2 = 0;
     nTiempo = 0;
     nTotalTiempo = 0;
     nDias = 0;
     nHora = 0;
     nMinu = 0;
     nSegu = 0;
     aHora = "";
     nLinTime = 0;

     nVentana = 0;
     nVenLector = 0;
 {-1}aVent = "";
     aVent1 = 0;
     aVent2 = 0;
     aVent3 = 0;
     aVent4 = 0;
     aVent5 = "";
     nPanta = 0;
     nPanta1 = 0;
     nGrid = -1;
     nGrid1 = 0;
     nBtnVerPed = 0;
     nBtnFabPed = 0;
     nBtnFinPro = 0;
     nBtnParoPro = 0;
     nBtnBusca = 0;
     nBtnSal = 0;
     nLabel0 = 0;
     nLabel1 = 0;
     nLabel2 = 0;
     nLabel3 = 0;
     nLabel4 = 0;
     nLabel5 = 0;
     nLabel6 = 0;
     nLabel7 = 0;
     nLabel8 = 0;
     nLabel9 = 0;
     nLabel10 = 0;
     nLabel11 = 0;
     nLabel12 = 0;
     nLabel13 = 0;
     nLabel14 = 0;
     nLabel15 = 0;
     nLabel16 = 0;
     nCampo = 0;
     aFin1 = ""; aFin2 = ""; aFin3 = "";
     nId = 0;
     nPrime = 0;
     nSal = 0;
|FIN;

|PROCESO Min83;
     #83#0 = #44#2;
     #83#1 = 00;
|FPRC;

|PROCESO Max83;
     #83#0 = #44#2;
     #83#1 = 99;
|FPRC;

|PROCESO Maquina0; |TIPO 0;
     |SI FSalida = 0;
          |PTEC 806;
     |FINSI;
|FPRC;

|PROCESO Maquina66; |TIPO 66;
     |ABRE #83;
     #83#0 = #44#2;
     #83#1 = #44#0;
     |LEE 000#83];
     |CONSULTA_F_CLAVE #1#83, Min83, Max83;
     |SI FSalida = 0;
          #44#0 = #83#1; |PINTA #44#0;
          #44#1 = #83#2; |PINTA #44#1;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #83;
|FPRC;

|PROCESO SumaTodo;
     nHora = #85#7;
     nMinu = #85#8;
     nHora1 = nMinu + (nHora * 60);
     nHora = #85#10;
     nMinu = #85#11;
     nHora2 = nMinu + (nHora * 60);
     nDias = #85#9 - #85#6;
     nTiempo = ((nDias * 24 * 60) + nHora2 - nHora1);

     nTotalTiempo = nTotalTiempo + nTiempo;
|FPRC;

|DEFBUCLE SumaTodo;
     #85#1;
     ;
     #36#0, #36#1, #0#0, 000;
     #36#0, #36#1, #0#0, 999;
     ;
     NULL, SumaTodo;
|FIN;

|PROCESO CtrlTmpFin;
     |ABRE #85;
     |DDEFECTO #85;
     #85#0 = #36#0;
     #85#1 = #36#1;
     #85#2 = #0#0;
     #85#3 = nLinTime;
     |LEE 121#85=;
     |SI FSalida = 0;
          |HORA aHora;
          #85#9 = ~;
          aAlfa = aHora % 102; #85#10 = aAlfa;
          aAlfa = aHora % 402; #85#11 = aAlfa;
          #85#12 = aEstado;
          |GRABA 020#85a;
     |FINSI;
     |CIERRA #85;
     nTotalTiempo = 0;
     |BUCLE SumaTodo;

     nMinu = nTotalTiempo $ 60;
     nHora = (nTotalTiempo - nMinu) / 60;
|FPRC;

|PROCESO CtrlTmpIni;
     |ABRE #85;
     #85#0 = #36#0;
     #85#1 = #36#1;
     #85#2 = #0#0;
     #85#3 = 999;
     |LEE 000#85];
     |SI FSalida = 0;
          |LEE 000#85a;
     |SINO;
          |LEE 000#85u;
     |FINSI;
     |SI FSalida = 0; |Y #85#0 = #36#0; |Y #85#1 = #36#1;  |Y #85#2 = #0#0;
          nLinTime = #85#3 + 1;
     |SINO;
          nLinTime = 1;
     |FINSI;
     |DDEFECTO #85;
     #85#0 = #36#0;
     #85#1 = #36#1;
     #85#2 = #0#0;
     #85#3 = nLinTime;
     #85#4 = #39#9;
     #85#13 = #39#10;
     #85#5 = Usuario % 810;
     #85#6 = ~;
     |HORA aHora;
     aAlfa = aHora % 102; #85#7 = aAlfa;
     aAlfa = aHora % 402; #85#8 = aAlfa;
     |GRABA 020#85n;
     |CIERRA #85;
|FPRC;

|PROCESO BtnFinPro;
     nSwBoton = 1;
     |PTEC 806;
|FPRC;

|PROCESO BtnParoPro;
     nSwBoton = 2;
     |PTEC 806;
|FPRC;

|PROCESO Min38;
     #38#0 = 1;
|FPRC;

|PROCESO Max38;
     #38#0 = 999;
|FPRC;

|PROCESO LlenaFabB;
     |DDEFECTO #80;
     #80#0 = #36#0;
     #80#1 = #36#1;
     |LEE 000#80=;
     |SI #0#0 = 4;
          #39#5 = #80#6;
          #39#6 = #80#7;
          #39#7 = #80#8;
          #39#8 = #80#9;
          #39#9 = #80#16;

          #39#12 = #80#15;
          #39#13 = #80#10;
          #39#14 = #80#13;
          #39#18 = #80#5;
     |FINSI;
     |SI #0#0 = 5;
          #39#5 = #80#10;
          #39#6 = #80#11;
          #39#7 = #80#12;
          #39#8 = #80#13;
          #39#9 = #80#17;

          #39#12 = #80#14;
          #39#13 = #80#6;
          #39#14 = #80#9;
          #39#18 = #80#4;
     |FINSI;
     |DDEFECTO #83;
     |ABRE #83;
     #83#0 = #0#0;
     #83#1 = #39#9;
     |LEE 000#83=;
     |CIERRA #83;
     #39#10 = #83#2;
|FPRC;

|PROCESO LlenaLinB;
     #38#0 = #31#2;
     #38#1 = #31#38;
     #38#2 = 1;
     #38#3 = #31#39;
     #38#4 = #31#3;
     |GRABA 020#38n;
|FPRC;

|PROCESO LlenaCabB;
     #39#0 = #30#0;
     #39#1 = #30#1;
     #39#2 = #30#3;
     #39#3 = #30#6;
     #39#4 = #30#11;
     #39#11 = #0#0;
|FPRC;

|DEFBUCLE LlenaTmpB;
     #30#1;
     ;
     #36#0, #36#1;
     #36#0, #36#1;
     ;
     NULL, LlenaCabB, LlenaLinB;
|FIN;

|PROCESO LlenaFab;
     |DDEFECTO #79;
     #79#0 = #36#0;
     #79#1 = #36#1;
     |LEE 000#79=;
     |SI #0#0 = 1;
          #39#5 = #79#7;
          #39#6 = #79#8;
          #39#7 = #79#9;
          #39#8 = #79#16;
          #39#9 = #79#22;

          #39#12 = #79#20;
          #39#13 = #79#10;
          #39#14 = #79#17;
          #39#15 = #79#21;
          #39#16 = #79#13;
          #39#17 = #79#18;
          #39#18 = #79#5;
          #39#19 = #79#6;
     |FINSI;
     |SI #0#0 = 2;
          #39#5 = #79#10;
          #39#6 = #79#11;
          #39#7 = #79#12;
          #39#8 = #79#17;
          #39#9 = #79#23;

          #39#12 = #79#19;
          #39#13 = #79#7;
          #39#14 = #79#16;
          #39#15 = #79#21;
          #39#16 = #79#13;
          #39#17 = #79#18;
          #39#18 = #79#4;
          #39#19 = #79#6;
     |FINSI;
     |SI #0#0 = 3;
          #39#5 = #79#13;
          #39#6 = #79#14;
          #39#7 = #79#15;
          #39#8 = #79#18;
          #39#9 = #79#24;

          #39#12 = #79#19;
          #39#13 = #79#7;
          #39#14 = #79#16;
          #39#15 = #79#20;
          #39#16 = #79#10;
          #39#17 = #79#17;
          #39#18 = #79#4;
          #39#19 = #79#5;
     |FINSI;
     |DDEFECTO #83;
     |ABRE #83;
     #83#0 = #0#0;
     #83#1 = #39#9;
     |LEE 000#83=;
     |CIERRA #83;
     #39#10 = #83#2;
|FPRC;

|PROCESO LlenaLin;
     #38#0 = #73#1;
     #38#1 = #73#2;
     #38#2 = #73#3;
     #38#3 = #73#4;
     #38#4 = #73#5;
     |GRABA 020#38n;
|FPRC;

|PROCESO LlenaCab;
     #39#0 = #104#25;
     #39#1 = #104#0;
     #39#2 = #104#4;
     #39#3 = #104#8;
     #39#4 = #104#15;
     #39#11 = #0#0;
|FPRC;

|DEFBUCLE LlenaTmp;
     #104#1;
     ;
     #36#0, #36#1;
     #36#0, #36#1;
     ;
     NULL, LlenaCab, LlenaLin;
|FIN;

|PROCESO QuitaBoton; |TIPO 7;
     aBoton = "|X000"; aID = #39#aBoton#; nBoton = aID;
     |ESTADO_CONTROL nBoton, "HIDE";
     aBoton = "|X001"; aID = #39#aBoton#; nBoton = aID;
     |ESTADO_CONTROL nBoton, "HIDE";
|FPRC;

|PROCESO FinFab;
     nLabel5 = -1; nLabel6 = -1; nLabel7 = -1;

     |VENTANA 1001, 3098, -1, 17, "Fabricar pedido";
     nVentana = FSalida;
     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PINPA #0#39; nPanta1 = FSalida;
     |PINDA #0#39;
     nRango = 4 + 8 + 16 + 32;
     |LINEAL_SIMPLE #1#38, nRango, 1602, 2298, Min38, Max38, NULL;
     nGrid1 = FSalida;
     |CONTROL_SIMPLE nPanta1, "LABEL,{{005}}Fabricando", 1202, 1333, NULL;
     nLabel0 = FSalida;

     |SI #0#0 = 1;
          |C_V #39#15, 1, "S"; |C_V #39#16, 1, "S"; |C_V #39#17, 1, "S";
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Chapado PVC", 0940, 0951, NULL;
          nLabel2 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Descripci¢n", 0956, 0966, NULL;
          nLabel3 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Ubicaci¢n", 1056, 1066, NULL;
          nLabel4 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Mecanizado", 1240, 1251, NULL;
          nLabel5 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Descripci¢n", 1256, 1266, NULL;
          nLabel6 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Ubicaci¢n", 1356, 1366, NULL;
          nLabel7 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{004}}Proceso Corte", 1502, 1550, NULL;
     |FINSI;
     |SI #0#0 = 2;
          |C_V #39#15, 1, "S"; |C_V #39#16, 1, "S"; |C_V #39#17, 1, "S";
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Corte", 0940, 0951, NULL;
          nLabel2 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Descripci¢n", 0956, 0966, NULL;
          nLabel3 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Ubicaci¢n", 1056, 1066, NULL;
          nLabel4 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Mecanizado", 1240, 1251, NULL;
          nLabel5 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Descripci¢n", 1256, 1266, NULL;
          nLabel6 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Ubicaci¢n", 1356, 1366, NULL;
          nLabel7 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{004}}Proceso Chapado PVC", 1502, 1550, NULL;
     |FINSI;
     |SI #0#0 = 3;
          |C_V #39#15, 1, "S"; |C_V #39#16, 1, "S"; |C_V #39#17, 1, "S";
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Corte", 0940, 0951, NULL;
          nLabel2 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Descripci¢n", 0956, 0966, NULL;
          nLabel3 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Ubicaci¢n", 1056, 1066, NULL;
          nLabel4 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Chapado PVC", 1240, 1251, NULL;
          nLabel5 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Descripci¢n", 1256, 1266, NULL;
          nLabel6 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Ubicaci¢n", 1356, 1366, NULL;
          nLabel7 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{004}}Proceso Mecanizado", 1502, 1550, NULL;
     |FINSI;
     |SI #0#0 = 4;
          |C_V #39#15, 1, "N"; |C_V #39#16, 1, "N"; |C_V #39#17, 1, "N";
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Montaje", 0940, 0951, NULL;
          nLabel2 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Descripci¢n", 0956, 0966, NULL;
          nLabel3 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Ubicaci¢n", 1056, 1066, NULL;
          nLabel4 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{004}}Proceso Block", 1502, 1550, NULL;
     |FINSI;
     |SI #0#0 = 5;
          |C_V #39#15, 1, "N"; |C_V #39#16, 1, "N"; |C_V #39#17, 1, "N";
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Block", 0940, 0951, NULL;
          nLabel2 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Descripci¢n", 0956, 0966, NULL;
          nLabel3 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Ubicaci¢n", 1056, 1066, NULL;
          nLabel4 = FSalida;
          |CONTROL_SIMPLE nPanta1, "LABEL,{{004}}Proceso Montaje", 1502, 1550, NULL;
     |FINSI;
     nLabel1 = FSalida;
     |CONTROL_SIMPLE nPanta1, "BOTON,Fin Proceso", 2302, 2322, BtnFinPro;
     nBtnFinPro = FSalida;
     |CONTROL_SIMPLE nPanta1, "BOTON,Paro Proceso", 2324, 2344, BtnParoPro;
     nBtnParoPro = FSalida;
     |PTEC 802; |PAUSA;
     nSwBoton = 0;
     |PTEC 806; |ENDATOS #2#39;
     |HORA aHora1;
     nSwAuto = 0;
     |PARA; |SI nSwBoton = 0; |HACIENDO;
          |PARA i = 0; |SI i [ 1000; |HACIENDO i = i + 1; |SIGUE;
          |PULSATECLA;
          |HORA aAlfa;
          |SI aAlfa ! aHora1;
               || Esto esta esperando por si adjudica el pedido
               || ver TagModiFabri del agifa098 o TagloActPed del agifa211
               || lee sin errores por si el "Proceso" es Block
               #79#0 = #36#0;
               #79#1 = #36#1;
               |LEE 000#79=;
               |SI FSalida = 0;
                    |SI #0#0 = 1; |Y #79#19 = "A"; nSwAuto = 1; nSwBoton = 1; |SAL; |FINSI;
                    |SI #0#0 = 2; |Y #79#20 = "A"; nSwAuto = 1; nSwBoton = 1; |SAL; |FINSI;
                    |SI #0#0 = 3; |Y #79#21 = "A"; nSwAuto = 1; nSwBoton = 1; |SAL; |FINSI;
               |FINSI;
          |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBtnFinPro;
     |FIN_CONTROL_WINDOWS nBtnParoPro;
     |FIN_CONTROL_WINDOWS nLabel0;
     |FIN_CONTROL_WINDOWS nLabel1;
     |FIN_CONTROL_WINDOWS nLabel2;
     |FIN_CONTROL_WINDOWS nLabel3;
     |FIN_CONTROL_WINDOWS nLabel4;
     |SI nLabel5 ! -1; |FIN_CONTROL_WINDOWS nLabel5; |FINSI;
     |SI nLabel6 ! -1; |FIN_CONTROL_WINDOWS nLabel6; |FINSI;
     |SI nLabel7 ! -1; |FIN_CONTROL_WINDOWS nLabel7; |FINSI;
     |DESTRUYECONTROL nGrid1;
     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |FINVENTANA nVentana;
     |PULSATECLA;
|FPRC;

|PROCESO PideMaq;
     |VENTANA 1324, 2074, -1, 17, "M quina";
     nVentana = FSalida;
     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DDEFECTO #44;
     |PINPA #0#44; nPanta1 = FSalida;
     |PINDA #0#44;
     |SI #0#0 = 1; |CONTROL_SIMPLE nPanta1, "LABEL,{{004}}Proceso Corte", 0603, 0630, NULL; |FINSI;
     |SI #0#0 = 2; |CONTROL_SIMPLE nPanta1, "LABEL,{{004}}Proceso Chapado PVC", 0603, 0630, NULL; |FINSI;
     |SI #0#0 = 3; |CONTROL_SIMPLE nPanta1, "LABEL,{{004}}Proceso Mecanizado", 0603, 0630, NULL; |FINSI;
     |SI #0#0 = 4; |CONTROL_SIMPLE nPanta1, "LABEL,{{004}}Proceso Block", 0603, 0630, NULL; |FINSI;
     |SI #0#0 = 5; |CONTROL_SIMPLE nPanta1, "LABEL,{{004}}Proceso Maquina", 0603, 0630, NULL; |FINSI;
     nLabel1 = FSalida;
     #44#2 = #0#0;
     |ENDATOS #1#44;
     nError = FSalida;
     |FIN_CONTROL_WINDOWS nLabel1;
     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |FINVENTANA nVentana;
     |PULSATECLA;
|FPRC;

|PROCESO GraItemDoc;
     aAlfa = #87#1; |QBF aAlfa;
     aItem = aAlfa % -101;
     |SI aItem ! "/"; |Y aItem ! "\"; aAlfa = aAlfa + "/"; |FINSI;

     aItem = "1642001|50/30" + (#36#0 % 102) + (("000000"+#36#1)%-106) + "|";

     aAlfa = aAlfa + (#36#0 % 102) + (("000000" + #36#1) % -106) + ".txt";
     |QBT aAlfa;
     |XABRE "CW", aAlfa, nHandle;
     |SI FSalida ] 0;
          |XGRABA nHandle, aItem;
          |XCIERRA nHandle;
     |SINO;
          aAlfa = (#36#0 % 102) + (("000000" + #36#1) % -106) + ".txt";
          |QBT aAlfa;
          aAlfa = "0000Error al grabar ItemDoc:" + aAlfa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO IniciaFab;
     ||** Inicia
     |HAZ CtrlTmpIni;
     |HAZ FinFab;
     |SI nSwBoton = 0;
          || ** Restaura estado
          |SI #36#2 = "N";
               #79#0 = #36#0;
               #79#1 = #36#1;
               |LEE 121#79=;
               |SI FSalida = 0;
                    |SI #0#0 = 1; #79#19 = aEstado; |FINSI;
                    |SI #0#0 = 2; #79#20 = aEstado; |FINSI;
                    |SI #0#0 = 3; #79#21 = aEstado; |FINSI;
                    |GRABA 020#79a;
               |FINSI;
          |SINO;
               #80#0 = #36#0;
               #80#1 = #36#1;
               |LEE 121#80=;
               |SI FSalida = 0;
                    |SI #0#0 = 4; #80#14 = aEstado; |FINSI;
                    |SI #0#0 = 5; #80#15 = aEstado; |FINSI;
                    |GRABA 020#80a;
               |FINSI;
          |FINSI;
          |ABRE #85;
          #85#0 = #36#0;
          #85#1 = #36#1;
          #85#2 = #0#0;
          #85#3 = nLinTime;
          |BORRA 020#85c;
          |CIERRA #85;
     |SINO;
          ||** Finaliza
          |SI nSwBoton = 1; aEstado = "F"; |SINO; aEstado = "P"; |FINSI;
          |SI nSwAuto = 1; aEstado = "A"; |FINSI;
          aFin1 = ""; aFin2 = ""; aFin3 = "";
          |HAZ CtrlTmpFin;
          |SI #36#2 = "N";
               #79#0 = #36#0;
               #79#1 = #36#1;
               |LEE 121#79=;
               |SI FSalida = 0;
                    |SI #0#0 = 1; #79#7 = #39#5; #79#25 = nHora; #79#26 = nMinu; #79#16 = #39#8; #79#19 = aEstado; |FINSI;
                    |SI #0#0 = 2; #79#10 = #39#5; #79#27 = nHora; #79#28 = nMinu; #79#17 = #39#8; #79#20 = aEstado; |FINSI;
                    |SI #0#0 = 3; #79#13 = #39#5; #79#29 = nHora; #79#30 = nMinu; #79#18 = #39#8; #79#21 = aEstado; |FINSI;
                    |GRABA 020#79a;
                    aFin1 = #79#19; aFin2 = #79#20; aFin3 = #79#21;
                    |SI #79#4 = "N"; aFin1 = "F"; |FINSI;
                    |SI #79#5 = "N"; aFin2 = "F"; |FINSI;
                    |SI #79#6 = "N"; aFin3 = "F"; |FINSI;
               |FINSI;
          |SINO;
               #80#0 = #36#0;
               #80#1 = #36#1;
               |LEE 121#80=;
               |SI FSalida = 0;
                    |SI #0#0 = 4; #80#6 = #39#5; #80#18 = nHora; #80#19 = nMinu; #80#9 = #39#8; #80#14 = aEstado; |FINSI;
                    |SI #0#0 = 5; #80#10 = #39#5; #80#20 = nHora; #80#21 = nMinu; #80#13 = #39#8; #80#15 = aEstado; |FINSI;
                    |GRABA 020#80a;
                    aFin1 = #80#14; aFin2 = #80#15; aFin3 = "F";
                    |SI #80#4 = "N"; aFin1 = "F"; |FINSI;
                    |SI #80#5 = "N"; aFin2 = "F"; |FINSI;
               |FINSI;
          |FINSI;
          |SI aFin1 = "F"; |Y aFin2 = "F"; |Y aFin3 = "F";
               |HAZ GraItemDoc;
          |FINSI;
          |SI aEstado = "F";
               |BORRA 020#36a;
               |REFRESCACONTROL nGrid;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO BtnFabPed;
     |LEE 000#36=
     |SI FSalida = 0;
          aAlfa = #36#8; |QBF aAlfa;
          |SI aAlfa = aRojo;
               |AVISO;
               |MENAV "0000Pedido fabricado...";
               |ACABA;
          |FINSI;

          nError = 0;
          |SI #0#0 = 1; |O #0#0 = 2; |O #0#0 = 3;
               |ABRE #79;
               #79#0 = #36#0;
               #79#1 = #36#1;
               |LEE 000#79=;
               |SI FSalida ! 0; |ACABA; |FINSI;
               |SI #0#0 = 1;
                    aEstado = #79#19;
                    |SI #79#19 ! "X"; |Y #79#19 ! "P"; nError = 1; |FINSI;
               |FINSI;
               |SI #0#0 = 2;
                    aEstado = #79#20;
                    |SI #79#20 ! "X"; |Y #79#20 ! "P"; nError = 1; |FINSI;
               |FINSI;
               |SI #0#0 = 3;
                    aEstado = #79#21;
                    |SI #79#21 ! "X"; |Y #79#21 ! "P"; nError = 1; |FINSI;
               |FINSI;
               |CIERRA #79;
          |SINO;
               |ABRE #80;
               #80#0 = #36#0;
               #80#1 = #36#1;
               |LEE 000#80=;
               |SI FSalida ! 0; |ACABA; |FINSI;
               |SI #0#0 = 4;
                    aEstado = #80#14;
                    |SI #80#14 ! "X"; |Y #80#14 ! "P"; nError = 1; |FINSI;
               |FINSI;
               |SI #0#0 = 5;
                    aEstado = #80#15;
                    |SI #80#15 ! "X"; |Y #80#15 ! "P"; nError = 1; |FINSI;
               |FINSI;
               |CIERRA #80;
          |FINSI;
          |SI nError = 1;
               |SI aEstado = "X"; |MENAV "0000Proceso en estado 'X'. Pendiente."; |FINSI;
               |SI aEstado = "I"; |MENAV "0000Proceso en estado 'I'. Iniciado."; |FINSI;
               |SI aEstado = "P"; |MENAV "0000Proceso en estado 'P'. Parado."; |FINSI;
               |SI aEstado = "F"; |MENAV "0000Proceso en estado 'F'. Finalizado."; |FINSI;
               |ACABA;
          |FINSI;

          |HAZ CreaTempo; |NOME_DAT #38 Tempo; |DELINDEX #38; aTmp38 = Tempo;
          |ABRE #79;
          |ABRE #80;
          |ABRET #38;
          |SI #36#2 = "N";
               |BUCLE LlenaTmp;
               |HAZ LlenaFab;
          |SINO;
               |BUCLE LlenaTmpB;
               |HAZ LlenaFabB;
          |FINSI;
          |LEE 000#38p;
          |SI FSalida = 0;
               |HAZ PideMaq;
               |SI nError = 0;
                    #39#9 = #44#0;
                    #39#10 = #44#1;
                    #39#11 = #44#2;
                    |SI #36#2 = "N";
                         #79#0 = #36#0;
                         #79#1 = #36#1;
                         |LEE 121#79=;
                         |SI FSalida = 0;
                              |SI #79#19 = "I";
                                   |SI #0#0 = 1;
                                        |MENAV "0000Proceso Corte iniciado...";
                                        nError = 1;
                                   |SINO;
                                        |CONFI "N0000Proceso Corte iniciado. ¿Continuar?";
                                        nError = FSalida;
                                   |FINSI;
                              |FINSI;
                              |SI #79#20 = "I";
                                   |SI #0#0 = 2;
                                        |MENAV "0000NProceso Chapado PVC iniciado...";
                                        nError = 1;
                                   |SINO;
                                        |CONFI "0000NProceso Chapado PVC iniciado. ¿Continuar?";
                                        nError = FSalida;
                                   |FINSI;
                              |FINSI;
                              |SI #79#21 = "I";
                                   |SI #0#0 = 3;
                                        |MENAV "0000NProceso Mecanizado iniciado...";
                                        nError = 1;
                                   |SINO;
                                        |CONFI "0000NProceso Mecanizado iniciado. ¿Continuar?";
                                        nError = FSalida;
                                   |FINSI;
                              |FINSI;
                              |SI nError = 0;
                                   |SI #0#0 = 1; #79#19 = "I"; #79#22 = #39#9; |FINSI;
                                   |SI #0#0 = 2; #79#20 = "I"; #79#23 = #39#9; |FINSI;
                                   |SI #0#0 = 3; #79#21 = "I"; #79#24 = #39#9; |FINSI;
                                   |GRABA 020#79a;
                              |FINSI;
                              |LIBERA #79;
                         |FINSI;
                    |SINO;
                         #80#0 = #36#0;
                         #80#1 = #36#1;
                         |LEE 121#80=;
                         |SI FSalida = 0;
                              |SI #80#14 = "I";
                                   |SI #0#0 = 4;
                                        |MENAV "0000Proceso Block iniciado...";
                                        nError = 1;
                                   |SINO;
                                        |CONFI "N0000Proceso Block iniciado. ¿Continuar?";
                                        nError = FSalida;
                                   |FINSI;
                              |FINSI;
                              |SI #80#15 = "I";
                                   |SI #0#0 = 5;
                                        |MENAV "0000NProceso Montaje iniciado...";
                                        nError = 1;
                                   |SINO;
                                        |CONFI "0000NProceso Montaje iniciado. ¿Continuar?";
                                        nError = FSalida;
                                   |FINSI;
                              |FINSI;
                              |SI nError = 0;
                                   |SI #0#0 = 4; #80#14 = "I"; #80#16 = #39#9; |FINSI;
                                   |SI #0#0 = 5; #80#15 = "I"; #80#17 = #39#9; |FINSI;
                                   |GRABA 020#80a;
                              |FINSI;
                              |LIBERA #80;
                         |FINSI;
                    |FINSI;
                    |SI nError = 0;
                         |HAZ IniciaFab;
                    |FINSI;
               |FINSI;
          |FINSI;
          |CIERRAT #38;
          |CIERRA #80;
          |CIERRA #79;
          Tempo = aTmp38; |HAZ BoraTempo; |DELINDEX #38;
     |FINSI;
     |HAZ Lector;
|FPRC;

|PROCESO BtnVerPed;
     |LEE 000#36=
     |SI FSalida = 0;
          nLabel5 = -1; nLabel6 = -1; nLabel7 = -1;

          |HAZ CreaTempo; |NOME_DAT #38 Tempo; |DELINDEX #38; aTmp38 = Tempo;
          |ABRE #79;
          |ABRE #80;
          |ABRET #38;
          |SI #36#2 = "N";
               |BUCLE LlenaTmp;
               |HAZ LlenaFab;
          |SINO;
               |BUCLE LlenaTmpB;
               |HAZ LlenaFabB;
          |FINSI;
          |LEE 000#38p;
          |SI FSalida = 0;
               |VENTANA 1001, 3098, -1, 17, "Ver pedido";
               nVentana = FSalida;
               aVent1 = -1;
               aVent2 = -1;
               aVent3 = 0;
               aVent4 = nVentana;
               aVent5 = "MODAL";
               |ESPECIFICA "ESTADO_VENTANA", aVent;
               |PINPA #0#39; nPanta1 = FSalida;
               nRango = 4 + 8 + 16 + 32;
               |LINEAL_SIMPLE #1#38, nRango, 1602, 2398, Min38, Max38, NULL;
               nGrid1 = FSalida;
               |CONTROL_SIMPLE nPanta1, "LABEL,{{005}}Consulta", 1202, 1333, NULL;
               nLabel0 = FSalida;
               |SI #0#0 = 1;
                    |C_V #39#15, 1, "S"; |C_V #39#16, 1, "S"; |C_V #39#17, 1, "S";
                    |C_V #39#19, 1, "S";
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Chapado PVC", 0940, 0951, NULL;
                    nLabel2 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Descripci¢n", 0956, 0966, NULL;
                    nLabel3 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Ubicaci¢n", 1056, 1066, NULL;
                    nLabel4 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Mecanizado", 1240, 1251, NULL;
                    nLabel5 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Descripci¢n", 1256, 1266, NULL;
                    nLabel6 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Ubicaci¢n", 1356, 1366, NULL;
                    nLabel7 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{004}}Proceso Corte", 1502, 1550, NULL;
               |FINSI;
               |SI #0#0 = 2;
                    |C_V #39#15, 1, "S"; |C_V #39#16, 1, "S"; |C_V #39#17, 1, "S";
                    |C_V #39#19, 1, "S";
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Corte", 0940, 0951, NULL;
                    nLabel2 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Descripci¢n", 0956, 0966, NULL;
                    nLabel3 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Ubicaci¢n", 1056, 1066, NULL;
                    nLabel4 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Mecanizado", 1240, 1251, NULL;
                    nLabel5 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Descripci¢n", 1256, 1266, NULL;
                    nLabel6 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Ubicaci¢n", 1356, 1366, NULL;
                    nLabel7 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{004}}Proceso Chapado PVC", 1502, 1550, NULL;
               |FINSI;
               |SI #0#0 = 3;
                    |C_V #39#15, 1, "S"; |C_V #39#16, 1, "S"; |C_V #39#17, 1, "S";
                    |C_V #39#19, 1, "S";
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Corte", 0940, 0951, NULL;
                    nLabel2 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Descripci¢n", 0956, 0966, NULL;
                    nLabel3 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Ubicaci¢n", 1056, 1066, NULL;
                    nLabel4 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Chapado PVC", 1240, 1251, NULL;
                    nLabel5 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Descripci¢n", 1256, 1266, NULL;
                    nLabel6 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Ubicaci¢n", 1356, 1366, NULL;
                    nLabel7 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{004}}Proceso Mecanizado", 1502, 1550, NULL;
               |FINSI;
               |SI #0#0 = 4;
                    |C_V #39#15, 1, "N"; |C_V #39#16, 1, "N"; |C_V #39#17, 1, "N";
                    |C_V #39#19, 1, "N";
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Montaje", 0940, 0951, NULL;
                    nLabel2 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Descripci¢n", 0956, 0966, NULL;
                    nLabel3 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Ubicaci¢n", 1056, 1066, NULL;
                    nLabel4 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{004}}Proceso Block", 1502, 1550, NULL;
               |FINSI;
               |SI #0#0 = 5;
                    |C_V #39#15, 1, "N"; |C_V #39#16, 1, "N"; |C_V #39#17, 1, "N";
                    |C_V #39#19, 1, "N";
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Block", 0940, 0951, NULL;
                    nLabel2 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Descripci¢n", 0956, 0966, NULL;
                    nLabel3 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{001}}Ubicaci¢n", 1056, 1066, NULL;
                    nLabel4 = FSalida;
                    |CONTROL_SIMPLE nPanta1, "LABEL,{{004}}Proceso Montaje", 1502, 1550, NULL;
               |FINSI;
               nLabel1 = FSalida;
               |PINDA #0#39;

               aEsc1 = &255 + "806";
               aEsc2 = &255 + "807";
               aRetu = &255 + "802";
               |PARA; |SI;  |HACIENDO;
                   FSalida = "::{{001}}Salir," + nGrid1;
                   |LEETECLA aTecla;
                   |SI aTecla = aEsc1; |SAL;  |FINSI;
                   |SI aTecla = aEsc2; |SAL;  |FINSI;
                   |SI aTecla = aRetu; |SAL;  |FINSI;
               |SIGUE;

               |FIN_CONTROL_WINDOWS nLabel0;
               |FIN_CONTROL_WINDOWS nLabel1;
               |FIN_CONTROL_WINDOWS nLabel2;
               |FIN_CONTROL_WINDOWS nLabel3;
               |FIN_CONTROL_WINDOWS nLabel4;
               |SI nLabel5 ! -1; |FIN_CONTROL_WINDOWS nLabel5; |FINSI;
               |SI nLabel6 ! -1; |FIN_CONTROL_WINDOWS nLabel6; |FINSI;
               |SI nLabel7 ! -1; |FIN_CONTROL_WINDOWS nLabel7; |FINSI;
               |DESTRUYECONTROL nGrid1;
               aVent1 = -1;
               aVent2 = -1;
               aVent3 = 0;
               aVent4 = nVentana;
               aVent5 = "MODELESS";
               |ESPECIFICA "ESTADO_VENTANA", aVent;
               |FINVENTANA nVentana;
               |PULSATECLA;
          |FINSI;
          |CIERRAT #38;
          |CIERRA #80;
          |CIERRA #79;
          Tempo = aTmp38; |HAZ BoraTempo; |DELINDEX #38;
     |FINSI;
     |HAZ Lector;
|FPRC;

|PROCESO BtnSal;
     |PTEC 807;
|FPRC;

|PROCESO Pinta20;
     |SI FSalida = 0;
          |SI #36#2 = "N";
               |DDEFECTO #79;
               |ABRE #79;
               #79#0 = #36#0;
               #79#1 = #36#1;
               |LEE 000#79=;
               |CIERRA #79;

               #0#2 = #79#4;
               #0#3 = #79#19;
               #0#4 = #79#7;
               #0#5 = #79#16;

               #0#6 = #79#5;
               #0#7 = #79#20;
               #0#8 = #79#10;
               #0#9 = #79#17;

               #0#10 = #79#6;
               #0#11 = #79#21;
               #0#12 = #79#13;
               #0#13 = #79#18;

               |HAZ Color79;
          |SINO;
               |DDEFECTO #80;
               |ABRE #80;
               #80#0 = #36#0;
               #80#1 = #36#1;
               |LEE 000#80=;
               |CIERRA #80;

               #0#2 = #80#4;
               #0#3 = #80#14;
               #0#4 = #80#6;
               #0#5 = #80#9;

               #0#6 = #80#5;
               #0#7 = #80#15;
               #0#8 = #80#10;
               #0#9 = #80#13;

               |HAZ Color80;
          |FINSI;
          #36#8 = aColor;
          |GRABA 020#36a;
     |SINO;
          |PARA i = 2; |SI i  [ 13; |HACIENDO i = i + 1;
               #0i = "";
          |SIGUE;
     |FINSI;
     |PARA i = 2; |SI i [ 13; |HACIENDO i = i + 1;
          |PINTA #0i;
     |SIGUE;
     |SI nLabel8 ! -1; |FIN_CONTROL_WINDOWS nLabel8; |FINSI;
     |SI nLabel9 ! -1; |FIN_CONTROL_WINDOWS nLabel9; |FINSI;
     |SI nLabel10 ! -1; |FIN_CONTROL_WINDOWS nLabel10; |FINSI;
     |SI nLabel11 ! -1; |FIN_CONTROL_WINDOWS nLabel11; |FINSI;
     |SI nLabel12 ! -1; |FIN_CONTROL_WINDOWS nLabel12; |FINSI;
     |SI nLabel13 ! -1; |FIN_CONTROL_WINDOWS nLabel13; |FINSI;
     |SI nLabel14 ! -1; |FIN_CONTROL_WINDOWS nLabel14; |FINSI;
     |SI nLabel15 ! -1; |FIN_CONTROL_WINDOWS nLabel15; |FINSI;
     |SI nLabel16 ! -1; |FIN_CONTROL_WINDOWS nLabel16; |FINSI;

     |SI #36#2 = "N"; |Y #0#0 [ 3;
          |C_V #0#10, 1, "S"; |C_V #0#11, 1, "S"; |C_V #0#12, 1, "S"; |C_V #0#13, 1, "S";
          |CONTROL_SIMPLE nPanta, "LABEL,{{001}}Corte", 2304, 2318, NULL;
          nLabel8 = FSalida;
          |CONTROL_SIMPLE nPanta, "LABEL,{{001}}Chapado PVC", 2504, 2518, NULL;
          nLabel9 = FSalida;
          |CONTROL_SIMPLE nPanta, "LABEL,{{001}}Mecanizado", 2704, 2718, NULL;
          nLabel10 = FSalida;
          |CONTROL_SIMPLE nPanta, "LABEL,{{001}}Descripci¢n", 2326, 2337, NULL;
          nLabel11 = FSalida;
          |CONTROL_SIMPLE nPanta, "LABEL,{{001}}Ubicaci¢n", 2426, 2437, NULL;
          nLabel12 = FSalida;
          |CONTROL_SIMPLE nPanta, "LABEL,{{001}}Descripci¢n", 2526, 2537, NULL;
          nLabel13 = FSalida;
          |CONTROL_SIMPLE nPanta, "LABEL,{{001}}Ubicaci¢n", 2626, 2637, NULL;
          nLabel14 = FSalida;
          |CONTROL_SIMPLE nPanta, "LABEL,{{001}}Descripci¢n", 2726, 2737, NULL;
          nLabel15 = FSalida;
          |CONTROL_SIMPLE nPanta, "LABEL,{{001}}Ubicaci¢n", 2826, 2837, NULL;
          nLabel16 = FSalida;
     |SINO;
          |C_V #0#10, 1, "N"; |C_V #0#11, 1, "N"; |C_V #0#12, 1, "N"; |C_V #0#13, 1, "N";
          |CONTROL_SIMPLE nPanta, "LABEL,{{001}}Block", 2304, 2318, NULL;
          nLabel8 = FSalida;
          |CONTROL_SIMPLE nPanta, "LABEL,{{001}}Montaje", 2504, 2518, NULL;
          nLabel9 = FSalida;
          |CONTROL_SIMPLE nPanta, "LABEL,{{001}}Descripci¢n", 2326, 2337, NULL;
          nLabel11 = FSalida;
          |CONTROL_SIMPLE nPanta, "LABEL,{{001}}Ubicaci¢n", 2426, 2437, NULL;
          nLabel12 = FSalida;
          |CONTROL_SIMPLE nPanta, "LABEL,{{001}}Descripci¢n", 2526, 2537, NULL;
          nLabel13 = FSalida;
          |CONTROL_SIMPLE nPanta, "LABEL,{{001}}Ubicaci¢n", 2626, 2637, NULL;
          nLabel14 = FSalida;
     |FINSI;
     |PULSATECLA;
|FPRC;

|PROCESO Evento;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#36=;

          |SI #0#0 = 1; |O #0#0 = 2; |O #0#0 = 3;
               |DDEFECTO #79;
               |ABRE #79;
               #79#0 = #36#0;
               #79#1 = #36#1;
               |LEE 000#79=;
               |SI #0#0 = 1;
                    aEstado = #79#19;
               |FINSI;
               |SI #0#0 = 2;
                    aEstado = #79#20;
               |FINSI;
               |SI #0#0 = 3;
                    aEstado = #79#21;
               |FINSI;
               |CIERRA #79;
          |SINO;
               |DDEFECTO #80;
               |ABRE #80;
               #80#0 = #36#0;
               #80#1 = #36#1;
               |LEE 000#80=;
               |SI #0#0 = 4;
                    aEstado = #80#14;
               |FINSI;
               |SI #0#0 = 5;
                    aEstado = #80#15;
               |FINSI;
               |CIERRA #80;
          |FINSI;

          aAlfa = #36#8; |QBF aAlfa;
          |SI aAlfa = aRojo; |O aEstado = "F";
               |ESTADO_CONTROL nBtnFabPed, "DISABLE";
          |SINO;
               |ESTADO_CONTROL nBtnFabPed, "ENABLE";
          |FINSI;

          |LEE 000#36=;
          |HAZ Pinta20;
     |FINSI;
|FPRC;

|PROCESO Min;
     #36#0 = "     ";
     #36#1 = 000001;
|FPRC;

|PROCESO Max;
     #36#0 = "zzzzz";
     #36#1 = 999999;
|FPRC;


|PROCESO Color80;
     aColor = aAmarillo;
     |SI #80#4 = "S"; |Y #80#5 = "S";
          |SI #80#14 = "X"; |Y #80#15 = "X"; aColor = aVerde; |FINSI;
          |SI #80#14 = "F"; |Y #80#15 = "F"; aColor = aVerde; |FINSI;
     |FINSI;
     |SI #80#4 = "S"; |Y #80#5 = "N";
          |SI #80#14 = "X"; aColor = aVerde; |FINSI;
          |SI #80#14 = "F"; aColor = aVerde; |FINSI;
     |FINSI;
     |SI #80#4 = "N"; |Y #80#5 = "S";
          |SI #80#15 = "X"; aColor = aVerde; |FINSI;
          |SI #80#15 = "F"; aColor = aVerde; |FINSI;
     |FINSI;
|FPRC;

|PROCESO Color79;
     aColor = aAmarillo;
     |SI #79#4 = "S"; |Y #79#5 = "S"; |Y #79#6 = "S";
          |SI #79#19 = "X"; |Y #79#20 = "X"; |Y #79#21 = "X"; aColor = aVerde; |FINSI;
          |SI #79#19 = "F"; |Y #79#20 = "F"; |Y #79#21 = "F"; aColor = aRojo; |FINSI;
     |FINSI;
     |SI #79#4 = "S"; |Y #79#5 = "S"; |Y #79#6 = "N";
          |SI #79#19 = "X"; |Y #79#20 = "X"; aColor = aVerde; |FINSI;
          |SI #79#19 = "F"; |Y #79#20 = "F"; aColor = aRojo; |FINSI;
     |FINSI;
     |SI  #79#4 = "S"; |Y #79#5 = "N"; |Y #79#6 = "S";
          |SI #79#19 = "X"; |Y #79#21 = "X"; aColor = aVerde; |FINSI;
          |SI #79#19 = "F"; |Y #79#21 = "F"; aColor = aRojo; |FINSI;
     |FINSI;
     |SI #79#4 = "N"; |Y #79#5 = "S"; |Y #79#6 = "S";
          |SI #79#20 = "X"; |Y #79#21 = "X"; aColor = aVerde; |FINSI;
          |SI #79#20 = "F"; |Y #79#21 = "F"; aColor = aRojo; |FINSI;
     |FINSI;
     |SI #79#4 = "N"; |Y #79#5 = "S"; |Y #79#6 = "N";
          |SI #79#20 = "X"; aColor = aVerde; |FINSI;
          |SI #79#20 = "F"; aColor = aRojo; |FINSI;
     |FINSI;
     |SI  #79#4 = "N"; |Y #79#5 = "N"; |Y #79#6 = "S";
          |SI #79#21 = "X"; aColor = aVerde; |FINSI;
          |SI #79#21 = "F"; aColor = aRojo; |FINSI;
     |FINSI;
|FPRC;

|PROCESO tagm0080;
     nOk = 0;
|| antes del color, no entran los fabricados
||     |SI #84#4 = "S"; |Y #80#4 = "S"; |Y #80#14 ! "F"; |Y #0#0 = 4; nOk = 1; |FINSI;
||     |SI #84#5 = "S"; |Y #80#5 = "S"; |Y #80#15 ! "F"; |Y #0#0 = 5; nOk = 1; |FINSI;

     |SI #84#4 = "S"; |Y #80#4 = "S"; |Y #0#0 = 4; nOk = 1; |FINSI;
     |SI #84#5 = "S"; |Y #80#5 = "S"; |Y #0#0 = 5; nOk = 1; |FINSI;

     |HAZ Color80;

     |SI nOk = 1;
          #30#0 = #80#0;
          #30#1 = #80#1;
          |LEE 000#30=;
          |SI FSalida = 0;
               nOk = 0;
               |SI #0#1 = "P";
                    |SI #30#24 = " "; nOk = 1; |FINSI;
               |SINO;
                    |SI #30#24 ! " "; nOk = 1; |FINSI;
               |FINSI;
               |SI nOk = 1;
                    |DDEFECTO #36;
                    #36#0 = #30#0;
                    #36#1 = #30#1;
                    #36#2 = "S";
                    #36#3 = #30#2;
                    #36#4 = #30#3;
                    #36#5 = #30#6;
                    #36#6 = #80#2;
                    #36#7 = #80#3;
                    #36#8 = aColor;
                    |GRABA 020#36n;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE tagm0080;
     #80#2;
     ;
     "N", "     ", 000001;
     "N", "zzzzz", 999999;
     ;
     NULL, tagm0080;
|FIN;

|PROCESO tagm0079;
     nOk = 0;
|| antes del color, no entran los fabricados
||     |SI #84#1 = "S"; |Y #79#4 = "S"; |Y #79#19 ! "F"; |Y #0#0 = 1; nOk = 1; |FINSI;
||     |SI #84#2 = "S"; |Y #79#5 = "S"; |Y #79#20 ! "F"; |Y #0#0 = 2; nOk = 1; |FINSI;
||     |SI #84#3 = "S"; |Y #79#6 = "S"; |Y #79#21 ! "F"; |Y #0#0 = 3; nOk = 1; |FINSI;

     |SI #84#1 = "S"; |Y #79#4 = "S"; |Y #0#0 = 1; nOk = 1; |FINSI;
     |SI #84#2 = "S"; |Y #79#5 = "S"; |Y #0#0 = 2; nOk = 1; |FINSI;
     |SI #84#3 = "S"; |Y #79#6 = "S"; |Y #0#0 = 3; nOk = 1; |FINSI;

|| condicion de corte
||     |SI #0#0 = 2; |O #0#0 = 3;
||          |SI #79#4 = "S";
||               |SI #79#19 = "X"; |O #79#19 = "I";
||                    nOk = 0;
||               |FINSI;
||          |FINSI;
||     |FINSI;

     |HAZ Color79;

     |SI nOk = 1;
          #104#25 = #79#0;
          #104#0 = #79#1;
          |LEE 000#104=;
          |SI FSalida = 0; |Y #104#34 = "N";
               nOk = 0;
               |SI #0#1 = "P";
                    |SI #104#46 > 5; nOk = 1; |FINSI;
               |SINO;
                    |SI #104#46 [ 5; nOk = 1; |FINSI;
               |FINSI;

               |SI nOk = 1;
                    |DDEFECTO #36;
                    #36#0 = #104#25;
                    #36#1 = #104#0;
                    #36#2 = "N";
                    #36#3 = #104#1;
                    #36#4 = #104#4;
                    #36#5 = #104#8;
                    #36#6 = #79#2;
                    #36#7 = #79#3;
                    #36#8 = aColor;
                    |GRABA 020#36n;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE tagm0079;
     #79#2;
     ;
     "N", "     ", 000001;
     "N", "zzzzz", 999999;
     ;
     NULL, tagm0079;
|FIN;

|PROCESO Refresca;
     |SI nGrid ! -1; |DESTRUYECONTROL nGrid; |FINSI;
     |CIERRAT #36; |DELINDEX #36; |ABRE #36;

     |ABRE #104;
     |BUCLE tagm0079;
     |CIERRA #104;
     |ABRE #30;
     |BUCLE tagm0080;
     |CIERRA #30;

     |LEE 000#36p;
     |HAZ Pinta20;
     nRango = 4 + 8 + 16 + 32;
     |LINEAL_SIMPLE #1#36, nRango, 1102, 2198, Min, Max, Evento;
     nGrid = FSalida;
|FPRC;

|PROCESO Tipo7; |TIPO 7;
     |SI nPrime = 0;
          |HAZ Lector;
          nPrime = 1;
     |FINSI;
|FPRC;

|PROCESO Tipo0; |TIPO 0;
     |SI #0Campo ! Contenido;
          |HAZ Refresca;
          |HAZ Lector;
     |FINSI;
|FPRC;

|PROCESO Lector;
     |PULSATECLA;
     |PARA; |SI; |HACIENDO;
          |HAZ LectorCB;
          |SI eaCodCB = "";
               |SAL;
          |SINO;
               aAlfa = #36#1;
               |SELECT #2#36;
               #36#1 = eaCodCB;
               |LEE 000#36=;
               nSal = FSalida;
               |SI FSalida ! 0;
                    #36#1 = aAlfa;
                    |LEE 000#36=;
               |FINSI;
               |SELECT #1#36;
               |LEE 000#36=;
               |REFRESCACONTROL nGrid;
               |PULSATECLA;
               |SI nSal = 0;
                    aAlfa = "0000Ultima busqueda:" + eaCodCB;
                    |MENSA aAlfa;
                    |SAL;
               |SINO;
                    aAlfa = "0000Pedido no encontrado:" + eaCodCB;
                    |MENAV aAlfa;
               |FINSI;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO BtnBusca; |TIPO 0;
     |HAZ Lector;

     aAlfa = "|C000WID";
     aAlfa = #0#aAlfa#;
     nId = aAlfa;
     |FOCOTECLADO nId;
|FPRC;

|PROCESO Tipo80; |TIPO 80;
     FSalida = 3299;
|FPRC;

|PROCESO Tipo12; |TIPO 12;
|FPRC;

|PROGRAMA;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;
     |ABRE #87; |LEE 000#87p; |CIERRA #87;

     |CLS;
     |PINPA #0#0;  nPanta = FSalida;

     |ABRE #84;
     #84#0 = Usuario % 810;
     |LEE 000#84=;
     |SI FSalida ! 0;
          |MENAV "0000Usuario no creado en 'Usuarios secciones'";
          |ACABA;
     |FINSI;
     |CIERRA #84;

     nOk = 0;
     |SI nOk = 0; |Y #84#1 = "S"; #0#0 = 1; nOk = 1; |FINSI;
     |SI nOk = 0; |Y #84#2 = "S"; #0#0 = 2; nOk = 1; |FINSI;
     |SI nOk = 0; |Y #84#3 = "S"; #0#0 = 3; nOk = 1; |FINSI;
     |SI nOk = 0; |Y #84#4 = "S"; #0#0 = 4; nOk = 1; |FINSI;
     |SI nOk = 0; |Y #84#5 = "S"; #0#0 = 5; nOk = 1; |FINSI;

     |CONTROL_SIMPLE nPanta, "BOTON,Ver Pedido", 3002, 3022, BtnVerPed;
     nBtnVerPed = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Iniciar Fabricaci¢n", 3024, 3044, BtnFabPed;
     nBtnFabPed = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Buscar Pedido", 3046, 3066, BtnBusca;
     nBtnBusca = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{001}} Salir", 3288, 3298, BtnSal;
     nBtnSal = FSalida;

     |HAZ CreaTempo; |NOME_DAT #36 Tempo; aTmp36 = Tempo; |DELINDEX #36;
     |ABRET #36;

     |HAZ Refresca;

     |PINDA #0#0;
     |PARA FSalida = 0; |SI FSalida = 0; |HACIENDO;
          |ENDATOS #1#0;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBtnVerPed;
     |FIN_CONTROL_WINDOWS nBtnFabPed;
     |FIN_CONTROL_WINDOWS nBtnBusca;
     |FIN_CONTROL_WINDOWS nBtnSal;
     |DESTRUYECONTROL nGrid;

     |CIERRAT #36; Tempo = aTmp36; |HAZ BoraTempo; |DELINDEX #36;
     |PULSATECLA;
|FPRO;
*/
