|FICHEROS;
 ortig008 #0;
 ortig001 #1;
 ortig002 #2;
 ortig007 #3;
 ortig009 #4; ||temporal impresion tarifa
 agifa019 #5;
|FIN;

|VARIABLES;
 alto = 0;
 el_campo = 0;
 i = 0;
 j = 0;
 &modelo = "";
 codigo = "";
 &vengo_de = "";
 &ancho = 0;
 &largo = 0;
 importe = 0;
 &importe2 = 0;
 &importe3 = 0;
 &intervalo = 0;
 &empezar = 0;
 &nDeci_Impbase = 0;
 &decim_base = 0;
 &precio_base = 0;
 &nDeci_Prebase = 0;
 &nDeci_prebase = 0;
 &nDeci_impbase = 0;
|FIN;

|CALCULO metros2;
 |SI #2#9 = "2";
   #2#10 = ancho + largo;
 |FINSI;
 |SI #2#9 = "L";
   #2#10 = largo;
 |FINSI;
 |SI #2#9 = "A";
   #2#10 = ancho;
 |FINSI;
 |SI #2#9 = "N";
   #2#10 = 1;
 |FINSI;
 |SI #2#9 = "F";
   #2#10 = (largo * ancho)+(ancho*#2#3);
 |FINSI;
 |SI #2#9 ! "F"; ||NO ES FORMULA
   #2#10 = #2#10 * #2#2 * #2#3;
 |SINO;
   #2#10 = #2#10 * #2#2;
 |FINSI;
 |HAZ importe2;
|FCAL;

|CALCULO importe2;
 |ABRE #agifa019;
 #agifa019#0 = #ortig002#11;
 |LEE 010#agifa019.=;
 |SI FSalida ! 0;|DDEFECTO #agifa019;|FINSI;
 |LIBERA #agifa019;
 |CIERRA #agifa019;
 #2#4 = #agifa019#133;
 #2#5 = #1#7;
 #2#12 = #2#10 * #2#4;
 #2#6 = #2#12 > #2#5;
 |SI #2#6 < #2#14;
   #2#6 = #2#14;
 |FINSI;
|FCAL;


|PROCESO limodelo;
|HAZ metros2;
importe = importe + #2#12;
importe2 = importe2 + #2#6;
importe3 = importe;
|SI vengo_de = "ortig001";
  |GRABA 001#2a;
  |LIBERA #2;
|FINSI;
|FPRC;

|PROCESO recalculo;
|ABRE #1;
importe = 0;
importe2 = 0;
#1#0 = codigo;
|LEE 010#1=;
|SI FSalida = 0;
  |SI vengo_de = "ortig001"; ||SI VENGO DEL ESCANDALLO
    ancho = #1#3;
    largo = #1#2;
  |FINSI;
  |BUCLELIN 0limodelo#1;
  |SI vengo_de = "ortig001";
    #1#12 = importe;
    #1#13 = importe2;
  |FINSI;
  importe = importe + #1#9 + #1#10;
  || importe2 = importe2 + (#1#9>#1#7) + (#1#10>#1#7);
  importe2 = importe2 + #1#9 + #1#10;
  |SI vengo_de = "ortig001";
    #1#8 = importe
    #1#5 = importe2;
    |PINTA #1#8;
    |PINTA #1#5;
    |GRABA 001#1a;
    |LIBERA #1;
  |FINSI;
|FINSI;
|CIERRA #1;
|FPRC;

|PROGRAMA;
|SI modelo = "";
  |PINPA #0#0;
  |DDEFECTO #1;
  |PINDA #0#0;
  |ENDATOS #1#0;
  |SI FSalida = 0;
    codigo = #0#0;
    |HAZ recalculo;
  |FINSI;
|SINO;
    |SI vengo_de = "ortig001";|O vengo_de = "ortig011";
      codigo = modelo;
      |HAZ recalculo;
    |SINO;
      |ABRE #4;
      |DDEFECTO #4;
      codigo = modelo;
      |PARA i = 1;|SI i [ 25;|HACIENDO i = i + 1;
        ancho = (i-1) * intervalo + empezar;
        ancho = ancho / 100;
        |PARA j = 1;|SI j [ 25;|HACIENDO j = j + 1;
            largo = (j-1) * intervalo + empezar;
            largo = largo / 100;
            |HAZ recalculo;
            el_campo = j;
            #4el_campo = importe2; ||precio venta
            |CAMPO_VISUAL #0#2, 1, "S";
            |CAMPO_VISUAL #0#3, 1, "S";
            #0#2 = ancho;
            #0#3 = #4el_campo;
            |PINTA #0#2;
            |PINTA #0#3;
        |SIGUE;
        alto = ancho*100;
        #4#0 = alto;
        |GRABA 001#4n;
        |LIBERA #4;
      |SIGUE;
      |CIERRA #4;
    |FINSI;
|FINSI;
|FPRO;
