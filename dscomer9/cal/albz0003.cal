|FICHEROS;
   albz0003 #0;
   albw0006 #1;
   agifa019 #2;

   albm0020 #10;
   albm0021 #11;
   albm0022 #12;
   albm0023 #13;
   albm0024 #14;

   Referen@ #100;
|FIN;

|VARIABLES;
   aIni      = "";
   aFin      = "";
   aAlfa     = "";
   aDesc     = "";
   aDescAb   = "";
   aEquFam   = "";
   aEquSbFam = "";
|FIN;

|PROCESO Referencia;
   |DDEFECTO #albw0006;
   #albw0006#0 = #Referen@#0;
   #albw0006#1 = #Referen@#1;
   #albw0006#2 = #Referen@#4;
   |GRABA 020#albw0006.n;
|FPRC;

|DEFBUCLE Referencia;
#Referen@#1001;
;
aIni;
aFin;
;
NULL,Referencia;
|FIN;

|RUTINA infw05;
   #albw0006#0 = "    ";
|FRUT;

|RUTINA supw05;
   #albw0006#0 = "zzzz";
|FRUT;

|PROCESO Lineal; |TIPO 7;
   aAlfa = "li" + Usuario; |NOME_DAT #1 aAlfa;
   |DELINDEX #albw0006; |ABRE #albw0006;
   |DBASE aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "def/";
   |SI Campo = 0; aAlfa = aAlfa + "albm0020.mas"; aIni = "    "; aFin = "zzzz"; |FINSI;
   |SI Campo = 1; aAlfa = aAlfa + "albm0021.mas"; aIni = "   ";  aFin = "zzz";  |FINSI;
   |SI Campo = 2; aAlfa = aAlfa + "albm0022.mas"; aIni = "   ";  aFin = "zzz";  |FINSI;
   |SI Campo = 3; aAlfa = aAlfa + "albm0023.mas"; aIni = "   ";  aFin = "zzz";  |FINSI;
   |CARGA_DEF aAlfa, Referen@;
   |SI FSalida = 0;
      |BUCLE Referencia;
      |DESCARGA_DEF #Referen@;
   |FINSI;
   |ENTLINEAL #1#albw0006,1,7,21,1,infw05,supw05; |PINDA #0#albz0003;
   |CIERRA #albw0006; |DELINDEX #albw0006;
|FPRC;

|PROCESO Descr;
   aDesc   = "";
   aDescAb = "";

   |ABRE #albm0020; |ABRE #albm0021;
   |ABRE #albm0022; |ABRE #albm0023;

   #albm0020#0 = #albz0003#0;
   |LEE 000#albm0020.=;
   |SI FSalida = 0;
      aAlfa = #albm0020#1; |QBF aAlfa; aDesc   = aDesc   + aAlfa + " ";
      aAlfa = #albm0020#4; |QBF aAlfa; aDescAb = aDescAb + aAlfa + " ";
   |FINSI;

   #albm0021#0 = #albz0003#1;
   |LEE 000#albm0021.=;
   |SI FSalida = 0;
      aAlfa = #albm0021#1; |QBF aAlfa; aDesc   = aDesc   + aAlfa + " ";
      aAlfa = #albm0021#4; |QBF aAlfa; aDescAb = aDescAb + aAlfa + " ";
   |FINSI;

   #albm0022#0 = #albz0003#2;
   |LEE 000#albm0022.=;
   |SI FSalida = 0;
      aAlfa = #albm0022#1; |QBF aAlfa; aDesc   = aDesc   + aAlfa + " ";
      aAlfa = #albm0022#4; |QBF aAlfa; aDescAb = aDescAb + aAlfa + " ";
   |FINSI;

   #albm0023#0 = #albz0003#3;
   |LEE 000#albm0023.=;
   |SI FSalida = 0;
      aAlfa = #albm0023#1; |QBF aAlfa; aDesc   = aDesc   + aAlfa + " ";
      aAlfa = #albm0023#4; |QBF aAlfa; aDescAb = aDescAb + aAlfa + " ";
   |FINSI;

   |CIERRA #albm0020; |CIERRA #albm0021;
   |CIERRA #albm0022; |CIERRA #albm0023;

   #albz0003#4 = aDesc;   |PINTA #albz0003#4;
   #albz0003#5 = aDescAb; |PINTA #albz0003#5;
|FPRC;

|PROGRAMA;
   |CLS;
   |CABEZA " Creacion articulos ventas ";
   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;
     |ABRE #albm0024; |LEE 000#albm0024.p; |CIERRA #albm0024;

     |ABRE #albm0020;
     #albm0020#0 = #albz0003#0;
     |LEE 000#albm0020.=;
     |SI FSalida ! 0; |DDEFECTO #albm0020; |FINSI;
     |CIERRA #albm0020;

     |ABRE #albm0021;
     #albm0021#0 = #albz0003#1;
     |LEE 000#albm0021.=;
     |SI FSalida ! 0; |DDEFECTO #albm0021; |FINSI;
     |CIERRA #albm0021;

     aAlfa =         #albz0003#0; |QBF aAlfa;
     aAlfa = aAlfa + #albz0003#1; |QBF aAlfa;
     aAlfa = aAlfa + #albz0003#2; |QBF aAlfa;
     aAlfa = aAlfa + #albz0003#3; |QBF aAlfa;

     |DDEFECTO #agifa019;
     |ABRE #agifa019;
     #agifa019#0 = aAlfa;
     |LEE 101#agifa019.=;
     |SI FSalida = 0;
          |CONFI "0000NEl Articulo existe. Actualizar";
          |SI FSalida ! 0;
               |CIERRA #agifa019; |ACABA;
          |FINSI;
     |SINO;
          #agifa019#134 = aAlfa; ||Arti Prov.
          |GRABA 020#agifa019.b;
     |FINSI;
     #agifa019#125 = #albm0024#0; ||Linea
     #agifa019#20 = #albm0024#1;  ||Tipo IVA
     #agifa019#5 = #albm0024#2;   ||Uni Med
     #agifa019#180 = #albm0024#3; ||Partida
     #agifa019#179 = #albm0024#4; ||Doble Stock
     #agifa019#201 = #albm0024#5; ||Codigo Unidades;

     #agifa019#2 = #albm0021#2;   ||Familia
     #agifa019#3 = #albm0020#2;   ||Subfamilia
     #agifa019#126 = #albm0022#2;   ||Marca
     #agifa019#200 = #albm0023#2;   ||Grupo

     #agifa019#1 = #albz0003#4;    || Normal
     #agifa019#195 = #albz0003#5;  || Abreviada

     |GRABA 020#agifa019.a;
     |CIERRA #agifa019;
   |FINSI;
|FPRO;
