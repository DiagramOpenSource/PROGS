|FICHEROS;
     agi00100 #0;
     agifa292 #0;
     dsm00010 #910;
|FIN;

|VARIABLES;
     &eaArticulo = "";
     &eAlfa    = "";
     &eAlfa1   = "";
     &eAlfa2   = "";
     &eAlfa3   = "";
     &eAlfa4   = "";
     nCaracSep = 0;
     nSuma     = 0;
     aAlfa = "";
     nNume = 0;
|FIN;

|PROCESO Calc6;  |TIPO 6;
     eaArticulo = #0Campo;
     |HAZ LlenaArticulo;
     |SI FSalida = 0;
          #0Campo = eaArticulo;
          |PINTA #0Campo;
     |SINO;
          |ERROR; |ACABA;
     |FINSI;
|FPRC;

|PROCESO PideArt;  |TIPO 7;
     |ABRE #910;
     |LEE 040#910p;
     |SI FSalida ! 0;  |DDEFECTO #910;  |FINSI;
     |CIERRA #910;

     |SI #910#2 [ 2;    |ACABA;  |FINSI;

     eAlfa = #0Campo;
     |SUB_EJECUTA_NP "dsz99990";                 || Por Pantalla
     |SI eAlfa = "-1";  |PTEC 807;  |ACABA;  |FINSI;
     |SI eAlfa = "-2";              |ACABA;  |FINSI;

     eaArticulo = eAlfa;      ||  700000-4215

     #0Campo = eAlfa;
     |PINTA #0Campo;
     |PTEC 802;
|FPRC;

|PROCESO TipoLote;  |TIPO 0;
     |SI #0#9 = "U";
          |C_M #0#10, 1, "N";      || pone no modificable los campos del
          |C_M #0#11, 1, "N";      || apartado Tipo Meses
          |C_M #0#12, 1, "N";
          |C_M #0#13, 1, "N";
          |C_M #0#14, 1, "N";
          |C_M #0#15, 1, "N";
          |C_M #0#16, 1, "N";
          |C_M #0#17, 1, "N";

          |C_M #0#3, 1, "S";       || deja modificar los campos del apartado
          |C_M #0#4, 1, "S";       || Tipo Unidades
          |C_M #0#5, 1, "S";
          |C_M #0#6, 1, "S";
          |C_M #0#7, 1, "S";
          |C_M #0#8, 1, "S";
     |FINSI;
     |SI #0#9 = "M";
          |C_M #0#3, 1, "N";       || pone no modificable los campos del
          |C_M #0#4, 1, "N";       || apartado Tipo Unidades
          |C_M #0#5, 1, "N";
          |C_M #0#6, 1, "N";
          |C_M #0#7, 1, "N";
          |C_M #0#8, 1, "N";

          |C_M #0#10, 1, "S";      || deja modificar los campos del apartado
          |C_M #0#11, 1, "S";      || Tipo Meses
          |C_M #0#12, 1, "S";
          |C_M #0#13, 1, "S";
          |C_M #0#14, 1, "S";
          |C_M #0#15, 1, "S";
          |C_M #0#16, 1, "S";
          |C_M #0#17, 1, "S";
     |FINSI;
|FPRC;

|PROCESO Mes_SN;   |TIPO 0;
  |SI #0#9 = "M";
     |SI #0#10 = "S";
          |C_M #0#11, 1, "S";
          |C_M #0#12, 1, "S";
     |SINO;
          |C_M #0#11, 1, "N";
          |C_M #0#12, 1, "N";
          #0#11 = 0;
     |FINSI;
  |FINSI;
|FPRC;

|PROCESO PosiMes;   |TIPO 0;
  |SI #0#9 = "M";
     |SI #0#12 = 1;
          #0#15 = 2;
     |SINO;
          #0#15 = 1;
     |FINSI;
     |PINTA #0#15;
  |FINSI;
|FPRC;

|PROCESO A¤o_SN;   |TIPO 0;
  |SI #0#9 = "M";
     |SI #0#13 = "S";
          |C_M #0#14, 1, "S";
          |C_M #0#15, 1, "S";
     |SINO;
          |C_M #0#14, 1, "N";
          |C_M #0#15, 1, "N";
          #0#14 = 0;
     |FINSI;
  |FINSI;
|FPRC;

|PROCESO PosiA¤o;   |TIPO 0;
  |SI #0#9 = "M";
     |SI #0#15 = 1;
          #0#12 = 2;
     |SINO;
          #0#12 = 1;
     |FINSI;
     |PINTA #0#12;
  |FINSI;
|FPRC;

|PROCESO Separador_SN;   |TIPO 0;
  |SI #0#9 = "M";
     |SI #0#17 = "S";
          |C_M #0#16, 1, "S";
          nCaracSep = 1;
     |SINO;
          |C_M #0#16, 1, "N";
          nCaracSep = 0;
     |FINSI;
  |FINSI;
|FPRC;

|PROCESO Comprueba; |TIPO 3;
  |SI #0#9 = "M";
     nSuma = #0#11 + #0#14 + nCaracSep;
     |SI nSuma > 8;
          |MENAV "    La Suma de Digitos de Mes, A¤o y Separador NO puede ser superior a 8 ...";
          |ERROR;
     |FINSI;
     |SI #0#10 = "N"; |Y #0#13 = "N";
          |MENAV "    En el Lote tiene que haber Mes o A¤o....";
          |ERROR;
     |FINSI;
     |SI #0#10 = "S"; |Y #0#11 = 0;
          |MENAV "    Si el Lote aparece el Mes los digitos no pueden ser 0....";
          |ERROR;
     |FINSI;
     |SI #0#13 = "S"; |Y #0#14 = 0;
          |MENAV "    Si el Lote aparece el A¤o los digitos no pueden ser 0....";
          |ERROR;
     |FINSI;
  |FINSI;
|FPRC;

|PROCESO UniActual; |TIPO 0;
     |SI #0#5 ] #0#4;
          nNume = #0#4 - 1;
          aAlfa = "0000Las unidades del lote actual no pueden ser superior a " + nNume + " unidades";
          |MENAV aAlfa;
          |ERROR;
     |FINSI;
|FPRC;
