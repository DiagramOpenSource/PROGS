|FICHEROS;
     coimy002 #0;

     agifa019 #19;
     agifa017 #17;
     agifa065 #65;
     coima027 #927;
|FIN;

|VARIABLES;
     nExiste = 0;
     aMensaje = "";
     aRespuesta = "";

     aInforme = "";
     nSwPie = 0;
     nImprime = 0;
     nPendServir = 0;
     nMinimoAlmacen = 0;

     &enTotalVentas = 0;
     &enStockUno = 0;
     &enStockMinimo = 0;
     &enUnidadesDisUno = 0;
     &enUnidadesDisDos = 0;
     &enStockTres = 0;
     &enStockCuatro = 0;
|FIN;

|PROCESO agifa065;
     enTotalVentas = enTotalVentas + #agifa065#6;
|FPRC;

|DEFBUCLE agifa065;
 #agifa065#5;
 2;
 #agifa019#0, 00001, #coimy002#11, "AV";
 #agifa019#0, 99999, #coimy002#12, "AV";
 ;
 NULL, agifa065;
|FIN;

|PROCESO agifa019;
     ||Familia
     |SI #agifa019#2 < #coimy002#3; |O #agifa019#2 > #coimy002#4;
          |ACABA;
     |FINSI;
     ||Linea
     |SI #agifa019#125 < #coimy002#5; |O #agifa019#125 > #coimy002#6;
          |ACABA;
     |FINSI;
     ||Subfamilia
     |SI #agifa019#3 < #coimy002#7; |O #agifa019#3 > #coimy002#8;
          |ACABA;
     |FINSI;
     ||Num.Orden
     |SI #agifa019#127 < #coimy002#9; |O #agifa019#127 > #coimy002#10;
          |ACABA;
     |FINSI;

     nImprime = 0;
     nPendServir = #agifa019#15;
     enTotalVentas = 0;
     |BUCLE agifa065;

     |SI nPendServir > 0;
          nImprime = 1;
     |SINO;
          |SI enTotalVentas = 0;
               |DDEFECTO #agifa017;
               #agifa017#0 = #agifa019#0;
               #agifa017#1 = 1;
               |LEE 000#agifa017.=;
               nMinimoAlmacen = #agifa017#6;
               |SI nMinimoAlmacen ! 0;
                    nImprime = 1;
               |FINSI;
          |SINO;
               nImprime = 1;
          |FINSI;
     |FINSI;

     |SI nImprime = 1;
          |DDEFECTO #agifa017;
          #agifa017#0 = #agifa019#0;
          #agifa017#1 = 1;
          |LEE 000#agifa017.=;
          |SI #agifa019#135 = "S";
               enStockUno = #agifa017#5;
          |SINO;
               enStockUno = #agifa017#9;
          |FINSI;
          enStockMinimo = #agifa017#6;

          |DDEFECTO #coima027;
          #coima027#0 = #agifa019#0;
          #coima027#1 = 1;
          |LEE 000#coima027.=;
          enUnidadesDisUno = #coima027#4;
          enUnidadesDisDos = #coima027#5;

          |DDEFECTO #agifa017;
          #agifa017#0 = #agifa019#0;
          #agifa017#1 = 3;
          |LEE 000#agifa017.=;
          enStockTres = #agifa017#5;

          |DDEFECTO #agifa017;
          #agifa017#0 = #agifa019#0;
          #agifa017#1 = 4;
          |LEE 000#agifa017.=;
          enStockCuatro = #agifa017#5;

          |PRINT;
          nSwPie = 1;
     |FINSI;
|FPRC;

|DEFBUCLE agifa019;
 #agifa019#1;
 ;
 #coimy002#1;
 #coimy002#2;
 ;
 NULL, agifa019;
|FIN;

|PROCESO Principal;
     |IMPRE 0;
     |SI FSalida = 0;
          aInforme = #coimy002#13;
          |QBF aInforme;
          |INFOR aInforme;
          |SI FSalida = 0;
               |ABRE #agifa017;
               |ABRE #coima027;
               |BUCLE agifa019;
               |SI nSwPie = 1;
                    |PIEINF;
               |FINSI;
               |FININF;
               |CIERRA #coima027;
               |CIERRA #agifa017;
          |SINO;
               aMensaje = "0000Informe " + aInforme + " inaccesible.";
               |MENAV aMensaje;
          |FINSI;
          |FINIMP;
     |SINO;
          |MENAV "0000Proceso cancelado.";
     |FINSI;
|FPRC;

|PROGRAMA;
     |CLS;
     |ABRE #0;
     |DDEFECTO #0;
     |LEE 101#0p;
     nExiste = FSalida;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |SI nExiste = 0;
               |GRABA 020#0a;
          |SINO;
               |GRABA 020#0n;
          |FINSI;
          |HAZ Principal;
     |FINSI;
     |LIBERA #0;
     |CIERRA #0;
|FPRO;
