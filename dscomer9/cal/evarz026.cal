|FICHEROS;
     evarz026 #0;
     evarz027 #1,MANTE;
     evarz028 #2,MANTE;
     dsm00010 #10;
     dsm00014 #14;
     dsm00015 #15;
     dsm00016 #16;
     dsm00071 #71;
     dsm00072 #72;
     dsm00073 #73;
     agifa321 #321;
     agifa324 #324;

     evarz002 #20;
     evarz003 #21;
|FIN;

|VARIABLES;
     &eaTmp1 = "";
     &eaTmp2 = "";
     &eaTmp7 = "";
     &eaTmp8 = "";
     &eaTmp9 = "";
     &nDeci_PreBase = 0;
     &eaModelo = "";
     nUno = 1;
     aAlfa = "";
     nNume = 0;
     nNume1 = 0;
     nForma = 0;
     nModo = 0;
     nExiste = 0;
     aCod0 = "";
     aHCod = "";
     aDCod = "";
|FIN;

|PROCESO Tallas;
     #2#0 = #1#0;
     #2#1 = #1#1;
     #2#2 = #1#3;
     #2#3 = #16#3;
     #2#4 = #16#4;
     |GRABA 000#2n;
|FPRC;

|DEFBUCLE Tallas;
     #16#1;
     ;
     aCod0, aDCod, aDCod, aDCod, aDCod;
     aCod0, aHCod, aHCod, aHCod, aHCod;
     ;
     NULL, Tallas;
|FIN;

|PROCESO Color;
     #1#0 = #20#3;
     #1#1 = #20#0;
     #1#2 = #20#1;
     #1#3 = #21#0;
     #1#4 = #21#1;
     |GRABA 000#1n;

     aDCod = " " * 20;
     aHCod = "z" * 20;
     aCod0 = (#0#2 + aDCod) % 120;
     |BUCLE Tallas;
|FPRC;

|DEFBUCLE Color;
     #21#1;
     ;
     #20#3, "                    ";
     #20#3, "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, Color;
|FIN;

|PROCESO Crealo;
     |BUCLE Color;
|FPRC;

|DEFBUCLE Crealo;
     #20#1;
     ;
     eaModelo, "                    ";
     eaModelo, "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, Crealo;
|FIN;

|PROCESO Borra2;
     |BORRA 020#2a;
|FPRC;

|DEFBUCLE Borra2;
     #2#1;
     ;
     #1#0, #1#1, #1#3, "      ";
     #1#0, #1#1, #1#3, "zzzzzz";
     ;
     NULL, Borra2;
|FIN;

|DEFBUCLE BorraTallas;
     #2#1;
     ;
     #1#0, "                    ", "                    ", "      ";
     #1#0, "zzzzzzzzzzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzz", "zzzzzz";
     ;
     NULL, Borra2;
|FIN;

|PROCESO Tipo7_1; |TIPO 7;
     |ENTCOLUMNA #1#2, 4, 7, 5, 0, Min2, Max2;
|FPRC;

|PROCESO Tipo2_1; |TIPO 2;
     nForma = 0 +. 1;
     nModo = (FEntrada / 100) ! 0;
     |SI nForma = 1;
          |ENTCOLUMNA #1#2, 4, 2, 5, 0, Min2, Max2;
     |FINSI;
     |SI nModo = 3;
          |BUCLE Borra2;
     |FINSI;
     |ABRE #20;
     #20#3 = #1#0;
     #20#0 = #1#1;
     |LEE 000#20=;
     |SI FSalida ! 0;
          #20#1 = #1#2;
          |GRABA 020#20n;
     |FINSI;
     |CIERRA #20;
     |ABRE #21;
     #21#3 = #1#0;
     #21#0 = #1#3;
     |LEE 000#21=;
     |SI FSalida ! 0;
          #21#1 = #1#4;
          |GRABA 020#21n;
     |FINSI;
     |CIERRA #21;
|FPRC;

|PROCESO Tabla0; |TIPO 0;
     |SI nExiste = 0; |Y #0Campo ! Contenido;
          |CONFI "0000SBorrar tallas existentes S/N:";
          |SI FSalida = 0;
               |BUCLE BorraTallas;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tabla66; |TIPO 66;
     |ABRE #15;
     #15#0 = #0#2;
     |LEE 000#15];
     |CONSULTA_CLAVE #1#15;
     |SI FSalida = 0;
          #0#2 = #15#0; |PINTA #0#2;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #15;
|FPRC;

|PROCESO T12; |TIPO 12;
|FPRC;

|PROCESO Min2;
     #2#0 = #1#0;
     #2#1 = #1#1;
     #2#2 = #1#3;
     #2#3 = "      ";
|FPRC;

|PROCESO Max2;
     #2#0 = #1#0;
     #2#1 = #1#1;
     #2#2 = #1#3;
     #2#3 = "zzzzzz";
|FPRC;

|PROCESO Min1;
     #1#0 = eaModelo;
     #1#1 = "                    ";
     #1#3 = "                    ";
|FPRC;

|PROCESO Max1;
     #1#0 = eaModelo;
     #1#1 = "zzzzzzzzzzzzzzzzzzzz";
     #1#3 = "zzzzzzzzzzzzzzzzzzzz";
|FPRC;

|PROGRAMA;
     |NOME_DAT #20 eaTmp1;
     |NOME_DAT #21 eaTmp2;
     |NOME_DAT #0 eaTmp7;
     |NOME_DAT #1 eaTmp8;
     |NOME_DAT #2 eaTmp9;

     |ABRE #10; |LEE 000#10p; |CIERRA #10;
     |ABRE #321; |LEE 000#321p; |CIERRA #321;
     |ABRE #324;
     #324#0 = #321#9;
     |LEE 000#324=;
     |SI FSalida ! 0;  |DDEFECTO #324;  |FINSI;
     nDeci_PreBase = #324#9;
     |CIERRA #324;

     |ABRE #0;
     #0#0 = eaModelo;
     |LEE 101#0=;
     nExiste = FSalida;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
     |ABRE #71;
     #71#0 = eaModelo;
     |LEE 020#71=;
     |CIERRA #71;
     #0#1 = #71#1;
     |ABRE #15;
     #15#0 = #0#2;
     |LEE 000#15=;
     |CIERRA #15;
     #0#3 = #15#4;

     |PINPA #0#0;
     |ATRI R;
     aAlfa = #10#3; |PINTA 904, aAlfa;
     |ATRI 0;
     nNume = #10#4; aAlfa = "\" + #10#7 + "+#";
     |C_A #0#0, 1, nNume; |CAMPO_MAXIMO #0#0, 1, aAlfa;
     nNume = nNume + 1104; |C_P #0#1, nNume, 1;

     |ATRI R;
     aAlfa = #10#7; |PINTA 1204, aAlfa;
     aAlfa = #10#7; |PINTA 1204, aAlfa;
     |ATRI 0;
     nNume = #10#8; aAlfa = "\" + #10#10 + "+#";
     |C_A #1#1, 1, nNume; |CAMPO_MAXIMO #1#1, 1, aAlfa;
     nNume = nNume + 1305; |C_P #1#2, 1, nNume;
     nNume1 = #10#12; aAlfa = "\" + #10#14 + "+#";
     |C_A #1#3, 1, nNume1; |CAMPO_MAXIMO #1#3, 1, aAlfa;
     nNume = nNume + nNume1 + 12; |C_P #1#3, 1, nNume;
     |ATRI R;
     nNume1 = nNume - 100;
     aAlfa = #10#11; |PINTA nNume1, aAlfa;
     |ATRI 0;
     nNume = nNume + #10#12 + nUno; |C_P #1#4, 1, nNume;

     |ENTLINEAL #1#1, 2, 7, 20, 0, Min1, Max1;

     |ATRI R;
     aAlfa = #10#20;
     nNume1 = nNume + 13; |PINTA nNume1, aAlfa;
     |ATRI I;
     nNume1 = nNume1 + 200; |PINTA nNume1, "Pvp_1.....";
     nNume1 = nNume1 + 100; |PINTA nNume1, "Pvp_2.....";
     nNume1 = nNume1 + 100; |PINTA nNume1, "Pvp_3.....";
     nNume1 = nNume1 + 100; |PINTA nNume1, "Pvp_4.....";
     nNume1 = nNume1 + 100; |PINTA nNume1, "Pvp_5.....";
     nNume1 = nNume1 + 100; |PINTA nNume1, "Pvp_6.....";
     |ATRI 0;

     nNume1 = nNume + 24; |C_P #2#3, 1, nNume1;
     nNume1 = nNume1 + 100; |C_P #2#4, 1, nNume1;
     nNume1 = nNume1 + 100; |C_P #2#5, 1, nNume1;
     nNume1 = nNume1 + 100; |C_P #2#6, 1, nNume1;
     nNume1 = nNume1 + 100; |C_P #2#7, 1, nNume1;
     nNume1 = nNume1 + 100; |C_P #2#8, 1, nNume1;
     nNume1 = nNume1 + 100; |C_P #2#9, 1, nNume1;
     nNume1 = nNume1 + 100; |C_P #2#10, 1, nNume1;

     nNume = #10#21; aAlfa = "\" + #10#23 + "+#";
     |C_A #2#3, 1, nNume; |CAMPO_MAXIMO #2#3, 1, aAlfa;
     |ENTCOLUMNA #1#2, 4, 7, 5, 0, Min2, Max2;

     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |ABRE #1;
          |ABRE #2;
          |BUCLE Crealo;
          |CIERRA #2;
          |CIERRA #1;

          |ABRE #15;
          #15#0 = #0#2;
          |LEE 000#15=;
          |CIERRA #15;
          #0#3 = #15#4; |PINTA #0#3;
          |GRABA 020#0a;
          |ENTLINEAL #1#1, 2, 2, 20, 0, Min1, Max1;
     |FINSI;

     |CIERRA #0;
|FPRO;
