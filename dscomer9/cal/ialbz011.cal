|FICHEROS;
     ialbm004 #4,MANTE;
     ialbm005 #5;
     ialbm009 #9,MANTE;
     ialbm010 #10;
     agifa019 #19;
     dsw00098 #98;  || Agrupa Art
|FIN;

|VARIABLES;
     &Tempo = "";
     aTip = "";
     aAcc = "";
     aCli = "";
     aMat = "";
     aArt = "";
|FIN;

|PROCESO EditaC;
     |CLS;
     |PINPA #0#9;
     |PINDA #0#9;
     |SI aAcc = "V";
          |ENDATOS #4#9;
     |FINSI;
     |SI aAcc = "M";
          |ENDATOS #2#9;
          |SI FSalida = 0; |GRABA 020#9a; |FINSI;
     |FINSI;
     |SI aAcc = "N";
          |ENCAMPO #0#9;
          |SI FSalida = 0;
               |LEE 101#9=;
               |SI FSalida = 0;
                    |PINDA #0#9;
                    |MENAV "0000Registro existente...";
                    |PAUSA;
               |SINO;
                    |GRABA 020#9b;
                    |ENDATOS #1#9;
                    |SI FSalida = 0;
                         |GRABA 020#9a;
                    |SINO;
                         |BORRA 020#9c;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO EditaF;
     |CLS;
     |PINPA #0#4;
     |PINDA #0#4;
     |SI aAcc = "V";
          |ENDATOS #4#4;
     |FINSI;
     |SI aAcc = "M";
          |ENDATOS #2#4;
          |SI FSalida = 0; |GRABA 020#4a; |FINSI;
     |FINSI;
     |SI aAcc = "N";
          |SI #4#0 = "000000";
               |ENCAMPO #0#4;
               |SI FSalida ! 0; |ACABA; |FINSI;
          |FINSI;
          |ENCAMPO #1#4;
          |SI FSalida = 0;
               |ENCAMPO #2#4;
               |SI FSalida = 0;
                    |LEE 101#4=;
                    |SI FSalida = 0;
                         |PINDA #0#4;
                         |MENAV "0000Registro existente...";
                         |PAUSA;
                    |SINO;
                         |GRABA 020#4b;
                         |ENDATOS #1#4;
                         |SI FSalida = 0;
                              |GRABA 020#4a;
                         |SINO;
                              |BORRA 020#4c;
                         |FINSI;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Imprimir;
     |PRINT;
|FPRC;

|PROCESO Agrupar;
     |DDEFECTO #19;
     #19#0 = #10#2;
     |LEE 000#19=;

     |DDEFECTO #98;
     #98#0 = #10#2;
     #98#1 = #10#4;
     |SI #19#215 ! "S";
          #98#2 = #10#0;
     |FINSI;
     |LEE 101#98=;
     |SI FSalida ! 0; |GRABA 020#98b; |FINSI;
     #98#6 = #10#0;
     #98#8 = #98#8 + #10#11;
     #98#9 = #98#9 + #10#12;
     |GRABA 020#98a;
     |LIBERA #98;
|FPRC;

|PROCESO Impresion;
     #10#1 = #9#0;
     #10#0 = #98#6;
     |LEE 020#10=;
     #10#11 = #98#8;
     #10#12 = #98#9;
     |PRINT;
|FPRC;

|DEFBUCLE Impresion;
     #98#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Impresion;
|FIN;

|PROCESO ImprimirC;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "ialbm009";
          |SI FSalida = 0;
               |HAZ CreaTempo; |NOME_DAT #98 Tempo; |DELINDEX #98;
               |ABRE #19;
               |ABRE #98;
               |BUCLELIN 2Agrupar#9;
               |CIERRA #19;
               |CIERRA #98;
               |ABRE #10;
               |BUCLE Impresion;
               |CIERRA #10;
               |HAZ BoraTempo; |DELINDEX #98;

               |PIEINF;
               |FININF;
          |SINO;
               |MENAV "0000No existe informe 'cartont'";
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO Imp;
     |PRINT;
|FPRC;

|PROCESO ImprimirF;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "ialbm004";
          |SI FSalida = 0;
               |BUCLELIN 2 Imp #4;
               |PIEINF;
               |FININF;
          |SINO;
               |MENAV "0000No existe informe 'ialbm004'";
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROGRAMA;
     aTip = PARAMETRO % 101;
     aAcc = PARAMETRO % 201;
     aCli = PARAMETRO % 306;
     aMat = PARAMETRO % 915;
     aArt = PARAMETRO % 2420;

     |SI aTip = "F";    || Fotocopiadoras
          |ABRE #4;
          #4#0 = aCli;
          #4#1 = aMat;
          #4#2 = aArt;
          |SI aAcc = "N";     || Nueva
               #4#1 = "";
               #4#2 = "";
               |HAZ EditaF;
          |FINSI;
          |SI aAcc = "I";     || Imprimir
               |LEE 020#4=;
               |SI FSalida = 0;
                    |HAZ ImprimirF;
               |FINSI;
          |FINSI;
          |SI aAcc = "M";     || Modificar
               |LEE 121#4=;
               |SI FSalida = 0;
                    |HAZ EditaF;
               |FINSI;
          |FINSI;
          |SI aAcc = "V";     || Ver
               |LEE 020#4=;
               |SI FSalida = 0;
                    |HAZ EditaF;
               |FINSI;
          |FINSI;
          |CIERRA #4;
     |FINSI;
     |SI aTip = "C";         || Carton
          |ABRE #9;
          #9#0 = aCli;
          |SI aAcc = "N";     || Nueva
               |HAZ EditaC;
          |FINSI;
          |SI aAcc = "I";     || Imprimir
               |LEE 020#9=;
               |SI FSalida = 0;
                    |HAZ ImprimirC;
               |FINSI;
          |FINSI;
          |SI aAcc = "M";     || Modificar
               |LEE 121#9=;
               |SI FSalida = 0;
                    |HAZ EditaC;
               |FINSI;
          |FINSI;
          |SI aAcc = "V";     || Ver
               |LEE 020#9=;
               |SI FSalida = 0;
                    |HAZ EditaC;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRO;
