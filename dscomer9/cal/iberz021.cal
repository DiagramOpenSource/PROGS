|FICHEROS;
   iberz021 #0;

   iberw011 #1;
   iberw014 #4;

   agifa501 #2;
   agifa502 #3;
|FIN;

|VARIABLES;
   aAlfa = "";

   nCalc    = 0;
   nCaja1   = 0;
   nCaja2   = 0;
   nAjuste1 = 0;
   nAjuste2 = 0;
|FIN;

|PROCESO Cuadre;
   |SI #iberw011#9 = 0; |Y #iberw011#10 = 0; |ACABA; |FINSI;

   nCaja1 = 0; nCaja2 = 0;
   #iberw014#1 = 1;
   #iberw014#2 = #iberw011#0;
   |LEE 000#iberw014.=;
   |SI FSalida = 0; nCaja1 = #iberw014#0; |FINSI;
   #iberw014#1 = 2;
   #iberw014#2 = #iberw011#0;
   |LEE 000#iberw014.=;
   |SI FSalida = 0; nCaja2 = #iberw014#0; |FINSI;
   nAjuste1 = #iberw011#9;
   nAjuste2 = #iberw011#10;


   #agifa501#14 = #iberw011#1;
   #agifa501#1  = "      ";
   #agifa501#35 = "F"
   #agifa501#57 = (("000" + #iberw011#0) % -103) + "  ";
   #agifa501#58 = 1;
   |LEE 000#agifa501.];
   |PARA; |SI FSalida = 0; |Y #agifa501#14 = #iberw011#1; |HACIENDO;
      |SI #agifa501#12 = nCaja1; |Y #agifa501#58 ! 0; |Y nAjuste1 ! 0;
         |SI #agifa501#35 = "F"; |O #agifa501#35 = "T";
            aAlfa = #agifa501#57; |QBF aAlfa; aAlfa = aAlfa % 0103; nCalc = aAlfa;
            |SI nCalc = #iberw011#0;
               |SI nAjuste1 ] 0;
                  |SI #agifa501#38 ! 0;
                     |SI #agifa501#38 ] nAjuste1;
                        #agifa501#38 = #agifa501#38 - nAjuste1;
                        #agifa501#40 = #agifa501#40 + nAjuste1;
                        nAjuste1 = 0;
                     |SINO;
                        #agifa501#40 = #agifa501#40 + #agifa501#38;
                        nAjuste1 = nAjuste1 - #agifa501#38;
                        #agifa501#38 = 0;
                     |FINSI;
                     |GRABA 020#agifa501.a;
                  |FINSI;
               |SINO;
                  |SI #agifa501#40 ! 0;
                     nCalc = 0 - nAjuste1;
                     |SI #agifa501#40 ] nCalc;
                        #agifa501#38 = #agifa501#38 - nAjuste1;
                        #agifa501#40 = #agifa501#40 + nAjuste1;
                        nAjuste1 = 0;
                     |SINO;
                        #agifa501#38 = #agifa501#38 + #agifa501#40;
                        nAjuste1 = nAjuste1 + #agifa501#40;
                        #agifa501#40 = 0;
                     |FINSI;
                     |GRABA 020#agifa501.a;
                  |FINSI;
               |FINSI;
            |FINSI;
         |FINSI;
      |FINSI;
      |SI #agifa501#12 = nCaja2; |Y #agifa501#58 ! 0; |Y nAjuste2 ! 0;
         |SI #agifa501#35 = "F"; |O #agifa501#35 = "T";
            aAlfa = #agifa501#57; |QBF aAlfa; aAlfa = aAlfa % 0103; nCalc = aAlfa;
            |SI nCalc = #iberw011#0;
               |SI nAjuste2 ] 0;
                  |SI #agifa501#38 ! 0;
                     |SI #agifa501#38 ] nAjuste2;
                        #agifa501#38 = #agifa501#38 - nAjuste2;
                        #agifa501#40 = #agifa501#40 + nAjuste2;
                        nAjuste2 = 0;
                     |SINO;
                        #agifa501#40 = #agifa501#40 + #agifa501#38;
                        nAjuste2 = nAjuste2 - #agifa501#38;
                        #agifa501#38 = 0;
                     |FINSI;
                     |GRABA 020#agifa501.a;
                  |FINSI;
               |SINO;
                  |SI #agifa501#40 ! 0;
                     nCalc = 0 - nAjuste2;
                     |SI #agifa501#40 ] nCalc;
                        #agifa501#38 = #agifa501#38 - nAjuste2;
                        #agifa501#40 = #agifa501#40 + nAjuste2;
                        nAjuste2 = 0;
                     |SINO;
                        #agifa501#38 = #agifa501#38 + #agifa501#40;
                        nAjuste2 = nAjuste2 + #agifa501#40;
                        #agifa501#40 = 0;
                     |FINSI;
                     |GRABA 020#agifa501.a;
                  |FINSI;
               |FINSI;
            |FINSI;
         |FINSI;
      |FINSI;
      |SI nAjuste1 = 0; |Y nAjuste2 = 0; |SAL; |FINSI;
      |LEE 000#agifa501.s;
   |SIGUE;
|FPRC;

|DEFBUCLE Cuadre;
#iberw011#1;
;
INICIO;
FINAL;
;
NULL,Cuadre;
|FIN;

|PROGRAMA;
   |CLS;
   |CABEZA " Cuadre de tarjetas/efectivo";
   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0; |Y #0#0 = "S";
      |ABRE #agifa501; |ABRE #agifa502;
      |ABRE #iberw014;
      |SELECT #3#agifa501; |SELECT #2#iberw014;
      |BUCLE Cuadre;
      |SELECT #1#agifa501; |SELECT #1#iberw014;
      |CIERRA #iberw014;
      |CIERRA #agifa501; |CIERRA #agifa502;
   |FINSI;
|FPRO;
