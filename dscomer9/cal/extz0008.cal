|FICHEROS;
     extz0008 #0;
     extm0003 #3;
     extm0013 #13;
     extm0014 #14;
     tmp00000 #100;
|FIN;

|VARIABLES;
     aAlfa = "";
     aInfor = "";
     nInfor = 0;
|FIN;

|PROCESO Lineas;
     |SI nInfor = 0;
          |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE Lineas;
     #14#1;
     ;
     #13#0, #13#1, "                    ";
     #13#0, #13#1, "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, Lineas;
|FIN;

|PROCESO RevisionCab;
     #3#0 = #13#8;
     |LEE 000#3=;
     |SI FSalida ! 0; |DDEFECTO #3; |FINSI;

     aAlfa = #3#3; |QBF aAlfa;
     |SI aAlfa ! aInfor;
          |SI aInfor ! ""; |PIEINF; |FININF; |FINSI;

          aInfor = aAlfa;
          |INFOR aInfor;
          nInfor = FSalida;
          |SI FSalida ! 0;
               aAlfa = "0000Error en informe:" + aAlfa;
               |MENAV aAlfa;
          |SINO;
               #13#13 = "S";
               |GRABA 020#13a;
          |FINSI;
     |FINSI;
     |LIBERA #13;
     |BUCLE Lineas;
|FPRC;

|DEFBUCLE Revision;
     #13#1;
     ;
     #0#0, #0#1;
     #0#2, #0#3;
     be;
     NULL, NULL, NULL, NULL, NULL, RevisionCab;
     #13#8, #13#0, #13#1,
|FIN;

|PROCESO Tmp;
     #13#0 = #100#0;
     #13#1 = #100#1;
     |LEE 121#13=;
     |SI FSalida = 0;
          |HAZ RevisionCab;
          |BUCLE Lineas;
     |FINSI;
|FPRC;

|PROCESO Ord;
     #13#0 = #100#0;
     #13#1 = #100#1;
     |LEE 020#13=;
|FPRC;

|DEFBUCLE Tmp;
     #100#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Ord, NULL, NULL, NULL, Tmp;
     #13#8, #13#0, #13#1,
|FIN;

|PROCESO Tipo3; |TIPO 3;
     Impresora = "Crystal Reports";
     |IMPRE 0;
     |SI FSalida = 0;
          |ABRE #3;
          |SI PARAMETRO = "";
               |BUCLE Revision;
          |SINO;
               |ABRE #13;
               |BUCLE Tmp;
               |CIERRA #13;
          |FINSI;
          |CIERRA #3;
          |SI aInfor ! ""; |Y nInfor = 0;
               |PIEINF; |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROGRAMA;
     |SI PARAMETRO = "";
          |PINPA #0#0;
          |PINDA #0#0;
          |ENDATOS #1#0;
     |SINO;
          aAlfa = PARAMETRO;
          |NOME_DAT #100 aAlfa;
          |HAZ Tipo3;
     |FINSI;
|FPRO;
