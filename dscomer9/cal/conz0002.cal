|FICHEROS;
   conz0002 #0;

   con00625 #10;
   con00626 #11;
   conm0001 #12;
   conm0002 #13;
   con00601 #14;

   conw0001 #100;
|FIN;

|VARIABLES;
   &Tempo = "";
   &eaD11 = ""; &eaD21 = ""; &eaD31 = ""; &eaD41 = ""; &eaD51 = "";
   &eaD61 = ""; &eaD71 = ""; &eaD81 = ""; &eaD91 = ""; &eaD01 = "";
   &eaD12 = ""; &eaD22 = ""; &eaD32 = ""; &eaD42 = ""; &eaD52 = "";
   &eaD62 = ""; &eaD72 = ""; &eaD82 = ""; &eaD92 = ""; &eaD02 = ""
   &enSw  = 0;

   DNombre  = ""; HNombre = ""; aAlfa   = "";
   aAntCli  = ""; aAntMat = "";

   nCoord   = 0;
   nMes     = 0;
   nLinea   = 0;
   nCalc    = 0;
   nPrimero = 0;
   nAntTInf = 0;
|FIN;

|PROCESO MiraTipo;
   |ABRE #conm0001;
   #conm0001#0 = #conz0002#6;
   |LEE 000#conm0001.=;
   |SI FSalida = 0;
      |PINTA nCoord, #conm0001#1;
   |FINSI;
   |CIERRA #conm0001;
|FPRC;

|PROCESO PintaTipoInf;
   |C_M #conz0002#0,1,"N"; |C_V #conz0002#0,1,"N";
   |C_M #conz0002#1,1,"N"; |C_V #conz0002#1,1,"N";
   |C_M #conz0002#2,1,"N"; |C_V #conz0002#2,1,"N";
   |C_M #conz0002#3,1,"N"; |C_V #conz0002#3,1,"N";
   |C_M #conz0002#4,1,"N"; |C_V #conz0002#4,1,"N";
   |C_M #conz0002#5,1,"N"; |C_V #conz0002#5,1,"N";
   |C_M #conz0002#6,1,"N"; |C_V #conz0002#6,1,"N";
   |C_M #conz0002#7,1,"N"; |C_V #conz0002#7,1,"N";
   #conz0002#0 = "      ";     #conz0002#1 = "zzzzzz";
   #conz0002#2 = "          "; #conz0002#3 = "zzzzzzzzzz";
   #conz0002#4 = "01.01.2000"; #conz0002#5 = "31.12.2099";
   #conz0002#6 = " ";          #conz0002#7 = "z";

   |PINTA 0750, "                       ";
   |BLANCO 0933 1668;
   |SI #conz0002#8 = "1";
      |ATRI R; |PINTA 0750, " Por cliente/matricula "; |ATRI N;
      |CUADRO 0933 1668;
      |ATRI R; |PINTA 1034, "           "; |PINTA 1046, "   DESDE      HASTA   "; |ATRI N;
      |PINTA 1134, " Cliente   "; |PINTA 1234, " Matricula ";
      |PINTA 1334, " Fecha ";     |PINTA 1434, " Tipo informe ";
      |C_P #conz0002#0,1,1148; |C_P #conz0002#1,1,1159;
      |C_M #conz0002#0,1,"S";  |C_V #conz0002#0,1,"S";
      |C_M #conz0002#1,1,"S";  |C_V #conz0002#1,1,"S";
      |C_P #conz0002#2,1,1246; |C_P #conz0002#3,1,1257;
      |C_M #conz0002#2,1,"S";  |C_V #conz0002#2,1,"S";
      |C_M #conz0002#3,1,"S";  |C_V #conz0002#3,1,"S";
      |C_P #conz0002#4,1,1346; |C_P #conz0002#5,1,1357;
      |C_M #conz0002#4,1,"S";  |C_V #conz0002#4,1,"S";
      |C_M #conz0002#5,1,"S";  |C_V #conz0002#5,1,"S";
      |C_P #conz0002#6,1,1451; ||C_P #conz0002#7,1,1462;
      |C_M #conz0002#6,1,"S";  |C_V #conz0002#6,1,"S";
||      |C_M #conz0002#7,1,"S";  |C_V #conz0002#7,1,"S";
      |PINTA #conz0002#0; |PINTA #conz0002#1;
      |PINTA #conz0002#2; |PINTA #conz0002#3;
      |PINTA #conz0002#4; |PINTA #conz0002#5;
      |PINTA #conz0002#6; ||PINTA #conz0002#7;
      nCoord = 1536;
   |FINSI;
   |SI #conz0002#8 = "2";
      |ATRI R; |PINTA 0750, " Por cliente/mes "; |ATRI N;
      |CUADRO 0933 1468;
      |ATRI R; |PINTA 1034, "           "; |PINTA 1046, "   DESDE      HASTA   "; |ATRI N;
      |PINTA 1134, " Cliente      ";
      |PINTA 1234, " Tipo informe ";
      |C_P #conz0002#0,1,1148; |C_P #conz0002#1,1,1159;
      |C_M #conz0002#0,1,"S";  |C_V #conz0002#0,1,"S";
      |C_M #conz0002#1,1,"S";  |C_V #conz0002#1,1,"S";
      |C_P #conz0002#6,1,1251; ||C_P #conz0002#7,1,1262;
      |C_M #conz0002#6,1,"S";  |C_V #conz0002#6,1,"S";
||      |C_M #conz0002#7,1,"S";  |C_V #conz0002#7,1,"S";
      |PINTA #conz0002#0; |PINTA #conz0002#1;
      |PINTA #conz0002#6; ||PINTA #conz0002#7;
      nCoord = 1336;
   |FINSI;
   |SI #conz0002#8 = "3";
      |ATRI R; |PINTA 0750, " Por matricula/fecha "; |ATRI N;
      |CUADRO 0933 1568;
      |ATRI R; |PINTA 1034, "           "; |PINTA 1046, "   DESDE      HASTA   "; |ATRI N;
      |PINTA 1134, " Matricula "; |PINTA 1234, " Fecha "; |PINTA 1334, " Tipo informe ";
      |C_P #conz0002#2,1,1146; |C_P #conz0002#3,1,1157;
      |C_M #conz0002#2,1,"S";  |C_V #conz0002#2,1,"S";
      |C_M #conz0002#3,1,"S";  |C_V #conz0002#3,1,"S";
      |C_P #conz0002#4,1,1246; |C_P #conz0002#5,1,1257;
      |C_M #conz0002#4,1,"S";  |C_V #conz0002#4,1,"S";
      |C_M #conz0002#5,1,"S";  |C_V #conz0002#5,1,"S";
      |C_P #conz0002#6,1,1351; ||C_P #conz0002#7,1,1362;
      |C_M #conz0002#6,1,"S";  |C_V #conz0002#6,1,"S";
||      |C_M #conz0002#7,1,"S";  |C_V #conz0002#7,1,"S";
      |PINTA #conz0002#2; |PINTA #conz0002#3;
      |PINTA #conz0002#4; |PINTA #conz0002#5;
      |PINTA #conz0002#6; ||PINTA #conz0002#7;
      nCoord = 1436;
   |FINSI;
|FPRC;

|PROCESO TempoTiposInf;
    || Busco en el conm0002 la asignacion de posicion del tipo
    ||    de parte/tipo informe
    #conm0002#0 = #conm0001#0;
    #conm0002#4 = #con00626#10;
    |LEE 000#conm0002.=;
    |SI FSalida = 0;
       |DDEFECTO #conw0001;
       |SI #conz0002#8 = "1";
          |SELECT #2#conw0001;
          #conw0001#0  = #con00625#11;   || Codigo cliente
          #conw0001#13 = #conm0001#0;    || Tipo de informe
          #conw0001#1  = #con00625#3;    || Matricula
          |LEE 000#conw0001.=;
          |SELECT #1#conw0001; |LEE 000#conw0001.=;
       |FINSI;
       |SI #conz0002#8 = "2";
          |SELECT #3#conw0001;
          #conw0001#0  = #con00625#11;   || Codigo cliente
          #conw0001#13 = #conm0001#0;    || Tipo de informe
          aAlfa = #con00625#2; |QBF aAlfa; aAlfa = aAlfa % 0402;
          #conw0001#16 = aAlfa;          || Mes fecha apertura
          |LEE 000#conw0001.=;
          |SELECT #1#conw0001; |LEE 000#conw0001.=;
       |FINSI;
       |SI #conz0002#8 = "3";
          |SELECT #4#conw0001;
          #conw0001#1  = #con00625#3;    || Matricula
          #conw0001#13 = #conm0001#0;    || Tipo de informe
          #conw0001#14 = #con00625#2;    || Fecha apertura
          |LEE 000#conw0001.=;
          |SELECT #1#conw0001; |LEE 000#conw0001.=;
       |FINSI;
       |SI FSalida ! 0;
          |SALVA_FICHA #conw0001;
          |LEE 000#conw0001.u;
          nLinea = #conw0001#15 + 1;
          |REPON_FICHA #conw0001; |DDEFECTO #conw0001;
          #conw0001#0  = #con00625#11;   || Codigo cliente
          #conw0001#13 = #conm0001#0;    || Tipo de informe
          #conw0001#1  = #con00625#3;    || Matricula
          #conw0001#14 = #con00625#2;    || Fecha apertura
          #conw0001#15 = nLinea;         || Clave Primaria
          aAlfa = #con00625#2; |QBF aAlfa; aAlfa = aAlfa % 0402;
          #conw0001#16 = aAlfa;          || Mes fecha apertura
          #conw0001#2  = #con00625#30;   || Marca
          #conw0001#3  = #con00625#21;   || Descripcion modelo
          #conw0001#12 = #con00625#19;   || Nombre cliente

          |SI #conw0001#16 = 1;  #conw0001#17 = "Enero     "; |FINSI;
          |SI #conw0001#16 = 2;  #conw0001#17 = "Febrero   "; |FINSI;
          |SI #conw0001#16 = 3;  #conw0001#17 = "Marzo     "; |FINSI;
          |SI #conw0001#16 = 4;  #conw0001#17 = "Abril     "; |FINSI;
          |SI #conw0001#16 = 5;  #conw0001#17 = "Mayo      "; |FINSI;
          |SI #conw0001#16 = 6;  #conw0001#17 = "Junio     "; |FINSI;
          |SI #conw0001#16 = 7;  #conw0001#17 = "Julio     "; |FINSI;
          |SI #conw0001#16 = 8;  #conw0001#17 = "Agosto    "; |FINSI;
          |SI #conw0001#16 = 9;  #conw0001#17 = "Septiembre"; |FINSI;
          |SI #conw0001#16 = 10; #conw0001#17 = "Octubre   "; |FINSI;
          |SI #conw0001#16 = 11; #conw0001#17 = "Noviembre "; |FINSI;
          |SI #conw0001#16 = 12; #conw0001#17 = "Diciembre "; |FINSI;

          |GRABA 020#conw0001.c;
       |FINSI;

       nCalc = #conm0002#1;
       |SI nCalc [ 7;
           nCalc = nCalc + 3;
       |SINO;
           nCalc = nCalc + 10;
       |FINSI;
       #conw0001#nCalc# = #conw0001#nCalc# + #con00626#8;

       #conw0001#11 = #conw0001#4  + #conw0001#5 + #conw0001#6 + #conw0001#7;
       #conw0001#11 = #conw0001#11 + #conw0001#8 + #conw0001#9 + #conw0001#10;
       #conw0001#12 = #conw0001#11 + #conw0001#18 + #conw0001#19 + #conw0001#20;

       |GRABA 020#conw0001.a;
    |FINSI;
|FPRC;

|DEFBUCLE TempoTiposInf;
#conm0001#1;
;
#conz0002#6;
#conz0002#7;
;
NULL,TempoTiposInf;
|FIN;

|PROCESO TempoLin;
   |BUCLE TempoTiposInf;
|FPRC;

|DEFBUCLE TempoLin;
#con00626#1;
;
#con00625#0, #con00625#1, 0001;
#con00625#0, #con00625#1, 9999;
;
NULL,TempoLin;
|FIN;

|PROCESO Temporal;
   |BUCLE TempoLin;
|FPRC;

|DEFBUCLE Temporal;
#con00625#3;
3;
#conz0002#0, #conz0002#4, DNombre, #conz0002#2;
#conz0002#1, #conz0002#5, HNombre, #conz0002#3;
;
NULL,Temporal;
|FIN;

|PROCESO CuadraMes;
   |SI nAntTInf = #conw0001#13; |Y aAntCli = #conw0001#0; |ACABA; |FINSI;
   nAntTInf = #conw0001#13; aAntCli = #conw0001#0;
   |SALVA_FICHA #conw0001;

   |PARA nMes = 1; |SI nMes [ 12; |HACIENDO nMes = nMes + 1;
      #conw0001#0  = aAntCli;
      #conw0001#13 = nAntTInf;
      #conw0001#16 = nMes;
      |LEE 000#conw0001.=;
      |SI FSalida ! 0;
          |SELECT #1#conw0001;
          |LEE 000#conw0001.u; nLinea = #conw0001#15 + 1;
          |SELECT #3#conw0001;

          |REPON_FICHA #conw0001; |SALVA_FICHA #conw0001;

          #conw0001#4  = 0; #conw0001#5  = 0; #conw0001#6 = 0;
          #conw0001#7  = 0; #conw0001#8  = 0; #conw0001#9 = 0;
          #conw0001#10 = 0; #conw0001#11 = 0; #conw0001#18 = 0;
          #conw0001#19 = 0; #conw0001#20 = 0;

          #conw0001#14 = "00.00.0000";   || Fecha apertura
          #conw0001#15 = nLinea;         || Clave Primaria
          #conw0001#16 = nMes;           || Mes fecha apertura
          |SI #conw0001#16 = 1;  #conw0001#17 = "Enero     "; |FINSI;
          |SI #conw0001#16 = 2;  #conw0001#17 = "Febrero   "; |FINSI;
          |SI #conw0001#16 = 3;  #conw0001#17 = "Marzo     "; |FINSI;
          |SI #conw0001#16 = 4;  #conw0001#17 = "Abril     "; |FINSI;
          |SI #conw0001#16 = 5;  #conw0001#17 = "Mayo      "; |FINSI;
          |SI #conw0001#16 = 6;  #conw0001#17 = "Junio     "; |FINSI;
          |SI #conw0001#16 = 7;  #conw0001#17 = "Julio     "; |FINSI;
          |SI #conw0001#16 = 8;  #conw0001#17 = "Agosto    "; |FINSI;
          |SI #conw0001#16 = 9;  #conw0001#17 = "Septiembre"; |FINSI;
          |SI #conw0001#16 = 10; #conw0001#17 = "Octubre   "; |FINSI;
          |SI #conw0001#16 = 11; #conw0001#17 = "Noviembre "; |FINSI;
          |SI #conw0001#16 = 12; #conw0001#17 = "Diciembre "; |FINSI;
          |GRABA 020#conw0001.n;
      |FINSI;
   |SIGUE;
   |REPON_FICHA #conw0001;
|FPRC;

|DEFBUCLE CuadraMes;
#conw0001#3;
;
INICIO;
FINAL;
;
NULL,CuadraMes;
|FIN;

|PROCESO Impresion1;
   |SI nAntTInf ! #conw0001#13; |O aAntCli ! #conw0001#0;
      |SI nPrimero = 0;
         |SI aAntCli ! #conw0001#0; enSw  = 1; |SINO; enSw  = 0; |FINSI;
         |PIEINF;
      |SINO;
         nPrimero = 0;
      |FINSI;
   |FINSI;
   nAntTInf = #conw0001#13; aAntCli = #conw0001#0; |PRINT;
|FPRC;

|DEFBUCLE Impresion1;
#conw0001#2;
;
INICIO;
FINAL;
;
NULL,Impresion1;
|FIN;

|DEFBUCLE Impresion2;
#conw0001#3;
;
INICIO;
FINAL;
;
NULL,Impresion1;
|FIN;

|PROCESO Impresion3;
   |SI nAntTInf ! #conw0001#13; |O aAntMat ! #conw0001#1;
      |SI nPrimero = 0;
         enSw  = 1; |PIEINF;
      |SINO;
         nPrimero = 0;
      |FINSI;
   |FINSI;
   nAntTInf = #conw0001#13; aAntMat = #conw0001#1;
   |PRINT;
|FPRC;

|DEFBUCLE Impresion3;
#conw0001#4;
;
INICIO;
FINAL;
;
NULL,Impresion3;
|FIN;

|PROGRAMA;
   DNombre = " " * 30;
   HNombre = "z" * 30;
   |CLS;
   |CABEZA " Informe estadisticas ";
   |PINPA #0#0; |PINDA #0#0;
   |HAZ PintaTipoInf;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      #conz0002#7 = #conz0002#6;
      |IMPRE 0;
      |SI FSalida = 0;
         |HAZ CreaTempo;
         |NOME_DAT #conw0001#Tempo#; |DELINDEX #conw0001;
         |ABRE #con00625;   |ABRE #con00626;
         |ABRE #conm0002;   |ABRE #conw0001;
         nLinea = 1; |BUCLE Temporal;

         |DDEFECTO #conm0002;
         #conm0002#0 = #conz0002#6;
         |LEE 000#conm0002.];
         |PARA; |SI FSalida = 0; |Y #conm0002#0 = #conz0002#6; |HACIENDO;
            |SI #conm0002#1 = 1; eaD11 = #conm0002#2; eaD12 = #conm0002#3; |FINSI;
            |SI #conm0002#1 = 2; eaD21 = #conm0002#2; eaD22 = #conm0002#3; |FINSI;
            |SI #conm0002#1 = 3; eaD31 = #conm0002#2; eaD32 = #conm0002#3; |FINSI;
            |SI #conm0002#1 = 4; eaD41 = #conm0002#2; eaD42 = #conm0002#3; |FINSI;
            |SI #conm0002#1 = 5; eaD51 = #conm0002#2; eaD52 = #conm0002#3; |FINSI;
            |SI #conm0002#1 = 6; eaD61 = #conm0002#2; eaD62 = #conm0002#3; |FINSI;
            |SI #conm0002#1 = 7; eaD71 = #conm0002#2; eaD72 = #conm0002#3; |FINSI;
            |SI #conm0002#1 = 8; eaD81 = #conm0002#2; eaD82 = #conm0002#3; |FINSI;
            |SI #conm0002#1 = 9; eaD91 = #conm0002#2; eaD92 = #conm0002#3; |FINSI;
            |SI #conm0002#1 =10; eaD01 = #conm0002#2; eaD02 = #conm0002#3; |FINSI;
            |LEE 000#conm0002.s;
         |SIGUE;

         |CIERRA #con00625; |CIERRA #con00626;
         aAlfa = #conz0002#8; |QBF aAlfa; aAlfa = "conz002" + aAlfa;
         FSalida = 0;
         |INFOR aAlfa;
         |SI FSalida = 0;
            nPrimero = 1;
            |SI #conz0002#8 = "1";                   |BUCLE Impresion1; |FINSI;
            |SI #conz0002#8 = "2"; |BUCLE CuadraMes; |BUCLE Impresion2; |FINSI;
            |SI #conz0002#8 = "3";                   |BUCLE Impresion3; |FINSI;
            |SI nPrimero ! 1;
               enSw = 1; |PIEINF; |FININF;
            |FINSI;
         |SINO;
            aAlfa = "    Error.... No se encuentra el informe " + aAlfa; |MENAV aAlfa;
         |FINSI;
         |CIERRA #conw0001; |CIERRA #conm0002;
         |FINIMP;
         |HAZ BoraTempo; |DELINDEX #conw0001;
      |SINO;
         |MENAV "    Proceso abortado ....";
      |FINSI;
   |FINSI;
|FPRO;
