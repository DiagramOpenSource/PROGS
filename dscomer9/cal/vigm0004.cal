|FICHEROS;
     vigm0004 #0;
     vigm0005 #1;
|FIN;

|VARIABLES;
     nModo = 0;
     nConta = 0;
     nPrecio = 0;
|FIN;

|PROCESO Conta; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |LEE 000#0u;
          |SI FSalida = 0;
               nConta = #0#0 + 1;
          |SINO;
               nConta = 1;
          |FINSI;
          |DDEFECTO #0;
          #0#0 = nConta;
     |FINSI;
|FPRC;

|PROCESO RecalCab;
     #0#3 = #0#3 + #1#4;
     #0#8 = #0#8 + (#1#4 * #1#5);
     nPrecio = nPrecio + (#1#4 * #1#5);
|FPRC;

|DEFBUCLE RecalCab;
     #1#1;
     ;
     #0#0, 001;
     #0#0, 999;
     ;
     NULL, RecalCab;
|FIN;

|PROCESO Tipo2Lin; |TIPO 2;
     nPrecio = #0#6 * #0#3;
     #0#8 = #0#8 +. (#1#4 * #1#5);
     #0#3 = #0#3 +. #1#4;
     |PINTA #0#3;
     |PINTA #0#8;
     nPrecio = nPrecio +. (#1#4 * #1#5);
     nPrecio = nPrecio / #0#3;
     #0#6 = nPrecio;
     |PINTA #0#6;
|FPRC;

|PROCESO Tipo2Cab; |TIPO 2;
     #0#3 = 0;
     #0#8 = 0;
     nPrecio = 0;
     |BUCLE RecalCab;
     #0#6 = nPrecio / #0#3;
     |PINTA #0#3;
     |PINTA #0#8;
     |PINTA #0#6;
|FPRC;
