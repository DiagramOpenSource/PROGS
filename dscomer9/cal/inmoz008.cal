|FICHEROS;
     inmoz008 #0;
     inmom001 #1;
     inmom004 #4;
     inmow010 #10; ||Tmp
|FIN;

|VARIABLES;
     &enLeido1 = 0;
     &enCorrecto1 = 0;
     &enNuevo1 = 0;
     &enNoReci1 = 0;

     &enLeido = 0;
     &enCorrecto = 0;
     &enError = 0;
     &enNuevo = 0;
     &enNoProse = 0;

     &enSw = 0;

     aAlfa = "";
|FIN;

|PROCESO inmom004P;
     |SI enSw = 2;            || Erroneos
          aAlfa = #4#9; |QBF aAlfa;
          |SI #4#8 = " "; |Y aAlfa ! "";
               |PRINT;
          |FINSI;
     |FINSI;
     |SI enSw = 3;            || Nuevos
          |SI #4#8 = "N";
               |PRINT;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE inmom004P;
     #4#2;
     ;
     #0#0;
     #0#0;
     ;
     NULL, inmom004P;
|FIN;

|PROCESO inmom001;
     enLeido1 = enLeido1 + 1;
     |SI #1#13 = "S";
          enCorrecto1 = enCorrecto1 + 1;
     |FINSI;
     |SI #1#13 = "N";
          aAlfa = #1#18; |QBF aAlfa;
          |SI #1#4 = 0; |O aAlfa = "";
               enNuevo1 = enNuevo1 + 1;
          |FINSI;
     |FINSI;
     aAlfa = #1#18; |QBF aAlfa;
     |SI #1#13 = "N"; |Y #1#4 ! 0; |Y aAlfa ! "";
          enNoReci1 = enNoReci1 + 1;
     |FINSI;

     |DDEFECTO #10;
     #10#0 = #1#1;
     |LEE 101#10=;
     |SI FSalida ! 0; |GRABA 020#10b; |FINSI;
     #10#1 = #10#1 + 1;
     #10#2 = #10#2 + #1#33;
     #10#3 = #10#2 + #1#34;
     |GRABA 020#10a;
     |LIBERA #10;
|FPRC;

|DEFBUCLE inmom001;
     #1#2;
     ;
     #0#0, "                    ";
     #0#0, "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, inmom001;
|FIN;

|PROCESO inmom004;            || Aux
     enLeido = enLeido + 1;
     |SI #4#8 = "S"; |O #4#8 = "E";
          enCorrecto = enCorrecto + 1;
     |FINSI;
     |SI #4#8 = "N";
          enNuevo = enNuevo + 1;
     |FINSI;
     |SI #4#8 = " ";
          enNoProse = enNoProse + 1;
     |FINSI;
     aAlfa = #4#9; |QBF aAlfa;
     |SI #4#8 = " "; |Y aAlfa ! "";
          enError = enError + 1;
     |FINSI;
|FPRC;

|DEFBUCLE inmom004;
     #4#2;
     ;
     #0#0;
     #0#0;
     ;
     NULL, inmom004;
|FIN;

|PROCESO inmoz108;
     |PRINT;
|FPRC;

|DEFBUCLE inmoz108;
     #10#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, inmoz108;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "inmoz008";
          |SI FSalida = 0;
               aAlfa = Usuario; |NOME_DAT #10 aAlfa;
               |DELINDEX #10;
               |ABRE #10;

               |BUCLE inmom004;
               |BUCLE inmom001;

               |CIERRA #10;

               |DDEFECTO #4;
               enSw = 0; |PRINT;

               enSw = 2; |BUCLE inmom004P; || Erroneos

               enSw = 3; |BUCLE inmom004P; || Nuevos

               enSw = 0;
               |PIEINF;
               |FININF;
          |SINO;
               |MENAV "0000Error en informe 'inmoz008'";
          |FINSI;

          |INFOR "inmoz108";
          |SI FSalida = 0;
               |BUCLE inmoz108;
               |PIEINF;
               |FININF;
          |SINO;
               |MENAV "0000Error en informe 'inmoz108'";
          |FINSI;

          |FINIMP;
     |FINSI;
|FPRC;
