|FICHEROS;
     evarz011 #0;
     evarm005 #1;
     evarm021 #21;
|FIN;

|VARIABLES;
  barra = "";
  alfa = "";
  modista = "";
|FIN;

|PROCESO ModiSituBarra;
     |ABRE #21;
     |SELECT #5#21;
     #21#0 = #1#0;
     |LEE 101#21=;
     |SI FSalida = 0;
          #21#8 = #1#3;
          |GRABA 020#21a;
     |FINSI;
     |CIERRA #21;
|FPRC;

|PROGRAMA;
  |CLS;
  |CABEZA "Situacion Entregado a";
  |ABRE #1;
  |DDEFECTO #0;
  |PINPA #0#0;
  |PINDA #0#0;
  |ENCAMPO #2#0;
  modista = #0#2;
  |PARA; |SI; |HACIENDO;
        |DDEFECTO #0;
        |PINDA #0#0;
        #0#2 = modista;
        |PINTA #0#2;
        |ENCAMPO #0#0;
        |SI FSalida ! 0; |SAL; |FINSI;

        barra = #0#0 % 112;
        #1#0 = barra;
        |LEE 101#1=;
        |SI 0 = FSalida;
                #1#2 = "2";
                alfa = "ENTREGADO A ";
                alfa = alfa + #0#2;
                #1#3 = alfa;
                #1#11 = ~;
                #1#14 = #0#2;
            |GRABA 020#1a;
            |HAZ ModiSituBarra;
            #0#1 = 1;
        |SINO;
            |MENAV "    Inexistente ...";
        |FINSI;
        |LIBERA #1;
  |SIGUE;
  |CIERRA #1;
|FPRO;
