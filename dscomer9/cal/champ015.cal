|FICHEROS;
     champ015 #0;
     champ009 #9;
     agifa010 #10;
     champ016 #16;
     agifa071 #71;
|FIN;

|VARIABLES;
     &Tempo = "";
     &aDivisa = "";
     &aMoneda = "";
     aTmp16 = "";
     aTmp9 = "";
     aSer = "";
     nNum = 0;
     {-1}aMenu = "";
     aMenu1 = "2400";
     aMenu2 = "1";
     aMenu3 = "Opciones: ";
     aMenu4 = "RAC";
     aMenu5 = " Repasar ";
     aMenu6 = " Aceptar ";
     aMenu7 = " Cancelar ";
|FIN;

|PROCESO Recalcula;
     |SI aSer ! "";
          |SI aSer ! #9#0; |O nNum ! #9#1;
               #10#52 = aSer;
               #10#0 = nNum;
               |LEE 121#10=;
               |SI FSalida = 0;
                    aDivisa = #10#68;
                    aMoneda = #10#70;
                    |HAZ Divisas010;
                    |HAZ LimCabAgifa010;
                    |BUCLELIN 2 CalCabAgifa010 #10;
                    |GRABA 020#10a;
                    |LIBERA #10;
               |FINSI;
          |FINSI;
     |FINSI;
     aSer = #9#0;
     nNum = #9#1;
|FPRC;

|PROCESO Tmp9;
     #16#0 = #9#3;
     |LEE 020#16=;

     #71#29 = #9#0;
     #71#0 = #9#1;
     #71#1 = #9#2;
     |LEE 121#71=;
     |SI FSalida = 0;
          #71#6 = #16#2;
          |HAZ TotalLin71;
          |GRABA 020#71a;
     |FINSI;

     |HAZ Recalcula;
|FPRC;

|DEFBUCLE Tmp9;
     #9#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp9;
|FIN;

|PROCESO Actualiza;
     |ABRE #10;
     |ABRE #71;
     |ABRE #16;
     |BUCLE Tmp9;
     |HAZ Recalcula;
     |CIERRA #16;
     |CIERRA #71;
     |CIERRA #10;
|FPRC;

|PROCESO agifa071;
     #16#0 = #71#2;
     |LEE 101#16=;
     |SI FSalida ! 0; |GRABA 020#16b; |FINSI;
     #16#1 = #71#4;
     #16#2 = #71#6;
     |GRABA 020#16a;
     |LIBERA #16;

     #9#0 = #71#29;
     #9#1 = #71#0;
     #9#2 = #71#1;
     #9#3 = #71#2;
     |GRABA 020#9n;
|FPRC;

|DEFBUCLE agifa010;
     #10#3;
     38;
     #0#0, #0#2, "     ", 000001, "N";
     #0#1, #0#3, "zzzzz", 999999, "N";
     ;
     NULL, NULL, agifa071;
|FIN;

|PROCESO Min;
     #16#0 = "                    ";
|FPRC;

|PROCESO Max;
     #16#0 = "zzzzzzzzzzzzzzzzzzzz";
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |HAZ CreaTempo; |NOME_DAT #16 Tempo; aTmp16 = Tempo; |DELINDEX #16;
     |HAZ CreaTempo; |NOME_DAT #9 Tempo; aTmp9 = Tempo; |DELINDEX #9;
     |ABRE #16;
     |ABRE #9;
     |BUCLE agifa010;
     |LEE 000#16];
     |SI FSalida = 0;
          |PINPA #0#16;
          |PARA; |SI; |HACIENDO;
               |ENTLINEAL #1#16, 1, 2, 22, 0, Min, Max;
               |MENU aMenu;
               |SI FSalida = 2; |HAZ Actualiza; |SAL; |FINSI;
               |SI FSalida = 3; |SAL; |FINSI;
          |SIGUE;
     |SINO;
          |MENAV "0000No hay registros...";
     |FINSI;
     |CIERRA #16; Tempo = aTmp16; |HAZ BoraTempo; |DELINDEX #16;
     |CIERRA #9; Tempo = aTmp9; |HAZ BoraTempo; |DELINDEX #9;
|FPRC;
