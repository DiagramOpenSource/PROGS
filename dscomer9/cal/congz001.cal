|FICHEROS;
     congz001 #0;
     cong0005 #5;
|FIN;

|VARIABLES;
     nRango = 0;
     aPath = "";
     aAlfa = "";
     aIP = "";
  {1}aContiene = "";
  {1}aLocal = "";
     aOrg = "";
     aMd5Org = "";
     aDes = "";
     aMd5Des = "";
     aFile = "";
     aFin = "";
     nPausa = 0;
     aBase = "";
|FIN;

|PROCESO EjecuataExeRemoto;
     aContiene = aOrg;
     |ESPECIFICA "MD5", aContiene;
     aMd5Org = FSalida;
     aContiene = aDes;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aMd5Des = FSalida;
     |SI aMd5Org ! aMd5Des; |ENVIA_FICHERO aOrg, aDes; |FINSI;
     aAlfa = aDes + " " + aFile + " " + aFin;
     |RSYSTEM aAlfa;
/*
     |PARA; |SI; |HACIENDO;
          |PARA nPausa = 1; |SI nPausa < 10000; |HACIENDO nPausa = nPausa + 1;
          |SIGUE;
          |XABRE "CE", aFin, 0;
          |SI FSalida ] 0; |SAL; |FINSI;
          |PULSATECLA;
     |SIGUE;
*/
|FPRC;

|PROCESO EjecuataExe;
     aContiene = aOrg;
     |ESPECIFICA "MD5", aContiene;
     aMd5Org = FSalida;
     aContiene = aDes;
     |ESPECIFICA "MD5", aContiene;
     aMd5Des = FSalida;
     |SI aMd5Org ! aMd5Des; |COPIA_FICHERO aOrg, aDes; |FINSI;
     aAlfa = aDes + " " + aFile + " " + aFin;
     |SYSTEM aAlfa;
/*
     |PARA; |SI; |HACIENDO;
          |PARA nPausa = 1; |SI nPausa < 10000; |HACIENDO nPausa = nPausa + 1;
          |SIGUE;
          |XABRE "E", aFin, 0;
          |SI FSalida ] 0; |SAL; |FINSI;
          |PULSATECLA;
     |SIGUE;
*/
|FPRC;

|PROCESO VerFichero;
     |LEE 000#5=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |DFICE aPath;
     aPath = aPath + "europastry/";
     |SI #5#0 = "E"; aPath = aPath + "entregas/"; |FINSI;
     |SI #5#0 = "P"; aPath = aPath + "pedidos/"; |FINSI;
     |SI #5#0 = "S"; aPath = aPath + "seguimiento/"; |FINSI;

     aFile = aPath + #5#1; |QBF aFile;

     |XABRE "E", aFile, 0;
     |SI FSalida < 0;
          aAlfa = "0000No existe fichero:" + aFile;
          |MENAV aAlfa;
          |ACABA;
     |FINSI;

     |DBASE aAlfa;
     aOrg = aAlfa + "plugins/dsabreextension.exe";
     aIP = ""; |IP_REMOTO aIP; |QBF aIP;
     |SI aIP = "";
          |DBASS aBase;
          aAlfa = aBase + "bin/";
          aDes = aAlfa + "dsabreextension.exe";
          |HAZ EjecuataExe;
     |SINO;
          |ESPECIFICA "RBASS", aLocal;
          aBase = aLocal;

          aDes = aBase + "tmp/";
          |MKDIR aDes;
          aDes = aDes + #5#1; |QBF aDes;
          |ENVIA_FICHERO aFile, aDes;
          aFile = aDes;

          aAlfa = aBase + "bin/";
          aDes = aAlfa + "dsabreextension.exe";
          |HAZ EjecuataExeRemoto;

          ||RFBORRA aFile;
     |FINSI;
     |PULSATECLA;
|FPRC;

|PROCESO EvtE;
     |SI FSalida = 1; |O FSalida = 2;
          |SELECT #1#5;
          |LEE 000#5=;
     |FINSI;
     |SI FSalida = 4;
          |HAZ VerFichero;
     |FINSI;
|FPRC;

|PROCESO MinE;
     #5#0 = "E";
     #5#1 = "z" * 40;
|FPRC;

|PROCESO MaxE;
     #5#0 = "E";
     #5#1 = " " * 40;
|FPRC;

|PROCESO EvtP;
     |SI FSalida = 1; |O FSalida = 2;
          |SELECT #1#5;
          |LEE 000#5=;
     |FINSI;
     |SI FSalida = 4;
          |HAZ VerFichero;
     |FINSI;
|FPRC;

|PROCESO MinP;
     #5#0 = "P";
     #5#1 = "z" * 40;
|FPRC;

|PROCESO MaxP;
     #5#0 = "P";
     #5#1 = " " * 40;
|FPRC;

|PROCESO EvtS;
     |SI FSalida = 1; |O FSalida = 2;
          |SELECT #1#5;
          |LEE 000#5=;
     |FINSI;
     |SI FSalida = 4;
          |HAZ VerFichero;
     |FINSI;
|FPRC;

|PROCESO MinS;
     #5#0 = "S";
     #5#1 = "z" * 40;
|FPRC;

|PROCESO MaxS;
     #5#0 = "S";
     #5#1 = " " * 40;
|FPRC;

|PROGRAMA;
     nRango = 4 + 8 + 16 + 32;
     |ABRE #5;
     |PINPA #0#0;
     |PINPA #1#0;
     |LINEAL_SIMPLE #2#5, nRango, 0701, 2698, MinE, MaxE, EvtE;
     |PINPA #2#0;
     |LINEAL_SIMPLE #2#5, nRango, 0701, 2698, MinP, MaxP, EvtP;
     |PINPA #3#0;
     |LINEAL_SIMPLE #2#5, nRango, 0701, 2698, MinS, MaxS, EvtS;
     |PAUSA;
     |CIERRA #5;
|FPRO;
