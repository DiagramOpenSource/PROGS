|FICHEROS;
     agifa011 #0;
     agifa010 #1;
     agifa007 #40;
     referen@;
|FIN;

|VARIABLES;
     &eaBulInfAlb = "";
     &eaImpoInfAlb = "";
     &enImpoInfAlb = 0;
     nSwInforAlba = "";
     aAlfa = "";
     informe1 = "agifa011";
     informe = "";
     &ser_alb     = "";
     &num_alb     = 0;
     &eaImpreAge = "";
|FIN;

|PROCESO InforAlba;
     eaBulInfAlb = ("000" + #1#2) % -103;
     enImpoInfAlb = #1#67;
     |DDEF aAlfa;
     aAlfa = aAlfa + "ialbm026";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |ABRE #referen@;
          #referen@#0 = #1#52;
          #referen@#1 = #1#0;
          |LEE 000#referen@.=;
          |SI FSalida = 0;
               enImpoInfAlb = enImpoInfAlb + #referen@#2;
          |FINSI;
          |CIERRA #referen@;
          |DESCARGA_DEF #referen@;
     |FINSI;

     enImpoInfAlb = (enImpoInfAlb * 100) ! 0;
     eaImpoInfAlb = ("0000000000" + enImpoInfAlb) % -110;
     eaImpoInfAlb = (eaImpoInfAlb % 108) + "," + (eaImpoInfAlb % -102);
|FPRC;

|CALCULO albagpr1;
     |HAZ mirainf;
     |INFOR informe;
     |SI FSalida ! 0; |ERROR; |ACABA; |FINSI;

     |SI nSwInforAlba = 0;
          |HAZ InforAlba;
     |FINSI;

     |PRINT;
|FCAL;

|CALCULO albagpr2;
     |PIEINF;
     |FININF;
|FCAL;

|DEFBUCLE agifa407g0;
     #1#3;
     43, 2;
     #0#2, #0#4, #0#6, #0#0, "N",           1;
     #0#3, #0#5, #0#7, #0#1, "N", 99999999999;
     ;
     NULL, albagpr1,NULL, albagpr2;
|FIN;

|DEFBUCLE agifa407g1;
     #1#3;
     43, 2;
     #0#2, #0#4, #0#6, #0#0, "N",           1;
     #0#3, #0#5, #0#7, #0#1, "N", 99999999999;
     ;
     NULL, albagpr1, NULL , NULL, NULL, albagpr2;
     #1#3, #1#1, #1#52, #1#0;
|FIN;


|PROCESO mirainf;
     #40#26 = #1#52;
     |LEE 001#40=;
     |SI FSalida = 0;
          informe = #40#12; |QBF informe;
     |SINO;
          informe = informe1;
     |FINSI;
|FPRC;

|CALCULO Tipo3;|TIPO 3;
     |SI eaImpreAge = "";
          |IMPRE 1;
     |SINO;
          Impresora = eaImpreAge;
          |IMPRE -1;
     |FINSI;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |ABRE #40;
     |SI #0#8 = "A";
          |BUCLE agifa407g0;
     |SINO;
          |BUCLE agifa407g1;
     |FINSI;
     |FINIMP;
     |CIERRA #40;
     |FINIMP;
|FCAL;

|PROGRAMA;
     |HAZ SacaIVA;
     |HAZ MiraLogos; || Copia Logos para el Crystal

     |HAZ EsInforAlba;
     nSwInforAlba = FSalida;

     |SI ser_alb = ""; |Y num_alb = 0;
         |CLS;
         |CABEZA "Emitir Albaranes Agencia";
         |PINPA #0#0;
         |PINDA #0#0;
         |ENDATOS #1#0;
     |SINO;
         #0#6  = ser_alb;
         #0#7  = ser_alb;
         #0#0  = num_alb;
         #0#1  = num_alb;
         #0#4 = "01.01.0000";
         #0#5 = "31.12.9999";
         FSalida = 0;
     |FINSI;
     |SI FSalida = 0;  |HAZ Tipo3;  |FINSI;
|FPRO;
