     ContaOf0, ContaOf7

|FICHEROS;
     pcegm002 #0;
     agifa027 #27;
     agifa142 #142;
|FIN;

|VARIABLES;
     nSalMenu = 0;
     nModo = 0;
     aAlfa = "";
     nConta = 0;
     nNume = 0;
     aSerie = "";
     aClave = "";

     &enSwSimula = 0;
     &enSwMenu = 0;
     &enDesdeX = 0;
     &enMenuAuto = 0;
 {-1}aMenu          = "";
     aMenu1         = "2400";
     aMenu2         = "1";
     aMenu3         = " Contador: ";
     aMenu4         = "AM";
     aMenu5         = " Automatico ";
     aMenu6         = " Manual ";
|FIN;

|PROCESO CompruContaOfe;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 1; |ACABA; |FINSI;

     |SI #142#137 = "F"; |ACABA; |FINSI;

     |SI #142#136 ! "S";
          aAlfa = ("000000" + nConta ) % -106;
          |SI #142#136 = "N";
               |SI nNume > nConta;
                    aAlfa = "0000Numero incorrecto. No puede ser mayor de " + aAlfa;
                    |MENAV aAlfa;
                    |ERROR;
               |FINSI;
          |SINO;
               |SI nNume > nConta;
                    aAlfa = "0000Numero superior a " + aAlfa;
                    |MENAV aAlfa;
                    |CONFI "0000N¿Esta Seguro?";
                    |SI FSalida ! 0; |ERROR; |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;


|PROCESO ContadorFicOfe;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;

     |SI enSwMenu = 0;
          |SI enDesdeX = 1;
               aMenu1 = "2800";
          |FINSI;
          |MENU aMenu
          nSalMenu = FSalida;
          enMenuAuto = FSalida;
          |SI nSalMenu ! 1; |ACABA; |FINSI;
     |FINSI;

     |SI #142#137 = "F";
          |ABRE #27;
          #27#2 = aSerie;
          #27#0 = aClave;
          |LEE  101#27=;
          |SI FSalida ! 0;
               #27#1 = 1;
               |GRABA 020#27b;
          |FINSI;
          nConta = #27#1;
          |SI enSwSimula = 0;       ||Lo usa la adj. de facturas ventas
               #27#1 = #27#1 + 1;
               |GRABA 020#27a;
          |FINSI;
          |CIERRA #27;
     |FINSI;
|FPRC;

|PROCESO ContaOf7; |TIPO 7;
     |SI enSwMenu = 0;
          nModo = (FEntrada/100) !  0;
          |SI nModo ! 1; |ACABA; |FINSI;
     |FINSI;

     nConta = 1;
     aSerie = #0#48;
     #0#0 = 999999;
     |LEE 000#0];
     |SI FSalida = 0;
          |LEE 000#0a;
     |SINO;
          |LEE 000#0u;
     |FINSI;
     |SI FSalida  = 0; |Y #0#48 = aSerie;
          nConta = #0#0 + 1;
     |FINSI;

     aClave = "vfacprof";
     |HAZ ContadorFicOfe;

     |DDEFECTO #0;
     #0#48 = aSerie;
     |SI enSwMenu = 0;
          |SI nSalMenu = 1;
               #0#0 = nConta;
               |PTEC 802;
          |SINO;
               #0#0 = 1;
          |FINSI;
     |SINO;
          #0#0 = nConta;
     |FINSI;
     enSwMenu = 0;
|FPRC;

|PROCESO ContaOf0; |TIPO 0;
     nNume = #0#0;
     |HAZ CompruContaOfe;
     || El defecto tambien esta en Propuesta7
     #0#92 = "Importante: Este equipo no cuenta con protección ATEX, por lo que no debe ser usado en ambientes explosivos.";
|FPRC;
