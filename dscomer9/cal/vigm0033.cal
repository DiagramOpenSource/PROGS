|FICHEROS;
     vigm0033 #0;
     vigm0034 #1;
     vigm0002 #2;
     vigm0032 #32,MANTE;
|FIN;

|VARIABLES;
     &enPorce = 0;
     aAlfa = "";
     aAlf1 = "";
     aAlf2 = "";
     aHora = "";
     aMinu = "";
     nHora = 0;
     nMinu = 0;
     i = 0;
     nDesde = 0;
     nHasta = 0;
|FIN;

|PROCESO CheqHora;
     aAlf1 = #1Campo + "      ";
     aMinu = "";
     aHora = "";
     |PARA i = 101; |SI i [ 501; |HACIENDO i = i + 100;
          aAlf2 = aAlf1 % i;
          |SI aAlf2 = ":";
               aMinu = " ";
          |SINO;
               |SI aMinu = "";
                    aHora = aHora + aAlf2;
               |SINO;
                    aMinu = aMinu + aAlf2;
               |FINSI;
          |FINSI;
     |SIGUE;
     nMinu = (A\(aMinu % 202));
     nHora = (A\(aHora % 102));
     aAlfa = (("00" + nHora) % -102) + ":" + (("00" + nMinu) % -102);
     #1Campo = aAlfa;
     |PINTA #1Campo;
     |SI nMinu < 0; |O nMinu ] 60;
          |MENAV "0000Hora Incorrecta...";
          |ERROR;
     |SINO;
          |SI nHora < 0; |O nHora ] 24;
               |MENAV "0000Hora Incorrecta...";
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Lineas;
     aHora = (#1#5 % 102);
     aMinu = (#1#5 % 402);
     nHora = aHora; nMinu = aMinu;
     nDesde = nHora + nMinu / 60;

     aHora = (#1#6 % 102);
     aMinu = (#1#6 % 402);
     nHora = aHora; nMinu = aMinu;
     nHasta = nHora + nMinu / 60;

     |SI nDesde > nHasta; nHasta = nHasta + 24; |FINSI;

     enPorce = #1#8 / (nHasta - nDesde)

     |PRINT;
|FPRC;

|DEFBUCLE Lineas;
     #1#1;
     ;
     #0#0, 001;
     #0#0, 999;
     ;
     NULL, NULL, NULL, NULL, NULL, Lineas;
     #1#2;
|FIN;

|PROCESO Tipo4; |TIPO 4;
     Impresora = "Crystal Reports";
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "vigm0033";
          |SI FSalida = 0;
               |BUCLE Lineas;
               |PIEINF;
               |FININF;
          |SINO;
               |MENAV "0000Error en informe 'vigm0033'";
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO CheqMatriz; |TIPO 0;
     |ABRE #32;
     #32#0 = #1#7;
     |LEE 121#32=;
     |SI FSalida ! 0; |O #32#1 = "      "; |O #32#5 = "        ";
          |MENAV "0000Fichero de matrices incompleto.";
          |PUSHV 0501 2380;
          |PINPA #0#32;
          |PINDA #0#32;
       |ET Otro;
          |ENDATOS #2#32;
          |SI FSalida = 0;
               |SI #32#1 = "      "; |O #32#5 = "        ";
                    |MENAV "0000Fichero de matrices incompleto.";
                    |VETE Otro;
               |FINSI;
               |GRABA 020#32a;
          |SINO;
               |ERROR;
          |FINSI;
          |POPV;
     |FINSI;
     |CIERRA #32;
|FPRC;


|PROCESO Pienso0; |TIPO 0;
     |ABRE #2;
     |SELECT #2#2;
     #2#1 = #1#3;
     |LEE 000#2=;
     |SI FSalida ! 0;
          |MENAV "0000No existe Formula...";
          |ERROR;
     |SINO;
          #1#4 = #2#2; |PINTA #1#4;
     |FINSI;
     |CIERRA #2;
|FPRC;

|PROCESO Pienso66; |TIPO 66;
     |ABRE #2;
     |SELECT #2#2;
     #2#1 = #1#3;
     |LEE 000#2];
     |CONSULTA_CLAVE #2#2;
     |SI FSalida = 0;
          #1#3 = #2#1;
          |PINTA #1#3;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #2;
|FPRC;
