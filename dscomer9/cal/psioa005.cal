|FICHEROS;
     psioa005 #0;   || Lineas revision.
     psioa004 #1;   || Cabecera revision.
     agifa024 #3;   || Clientes.
     agifa007 #4;   || Series.
     agifa321 #14;  || Divisas-Parametros.
     agifa324 #15;  || Divisas-Divisas.
     agifa019 #19;
     dsm00024 #24;
|FIN;

|VARIABLES;
     aAlfa = "";
     &enTiva = 0;
     &efFiva = @;
     &eaDiva = "";
     &enIva = 0;
     &enRec = 0;
     nBruto = 0;
     nError = 0;
     nCamBase = 0;
     nCamIva = 0;
     nCamRec = 0;
     nBase = 0;
     liquid = 0;
     base  = 0;
     base2 = 0;
     impue = 0;
|FIN;

|PROCESO calculo;
|FPRC;

|PROCESO totalb; |TIPO 2;
     |SI #0#11 = 0; #0#11 = 1; |FINSI;
     |HAZ LeeSerie;
     |HAZ LeeDivisa;
     |HAZ lee;

     |HAZ RecalLin;

     |PINTA #1#8;
     |PINTA #1#9;
|FPRC;

|PROCESO lee;
     enTiva = #0#9;
     efFiva = #1#3;
     |HAZ SacaIVA;

     |ABRE #3;
     #3#0 = #1#4;
     |LEE 141#3=;
     |SI FSalida ! 0;
         |GRABA 121#3c;
     |FINSI;
     |CIERRA #3;
|FPRC;

|CALCULO LeeSerie;
     |ABRE #4;
     #4#26 = #0#2;
     |LEE 000#4=;
     |LIBERA #4;
     |CIERRA #4;
|FCAL;

|PROCESO Alma7; |TIPO 7;
     |SI #0#11 = 0; #0#11 = 1; |FINSI;
|FPRC;

|PROCESO Arti; |TIPO 0;
     |ABRE #19;
     #19#0 = #0#4;
     |LEE 000#19=;
     |SI FSalida ! 0; |DDEFECTO #19; |FINSI;
     |CIERRA #19;
     aAlfa = #19#180;
     |C_M #0#12, 1, aAlfa;
|FPRC;

|PROCESO Min24;
     #24#0 = #0#4;
     #24#1 = #0#11;
     #24#2 = " " * 30;
|FPRC;

|PROCESO Max24;
     #24#0 = #0#4;
     #24#1 = #0#11;
     #24#2 = "z" * 30;
|FPRC;

|PROCESO Parti66; |TIPO 66;
     |ABRE #24;
     #24#0 = #0#4;
     #24#1 = #0#11;
     #24#2 = #0#12;
     |LEE 000#24];
     |CONSULTA_F_CLAVE #1#24, Min24, Max24;
     |SI FSalida = 0;
          #0#12 = #24#2; |PINTA #0#12;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #24;
|FPRC;
