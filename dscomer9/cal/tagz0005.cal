|FICHEROS;
     tagz0005 #0;
     agifa065 #65;
     agifa069 #69;
     agifa071 #71;
     agifa080 #80;
|FIN;

|VARIABLES;
     &enSw = 0;
     nAbo = 0;
     nUni1 = 0;
     nUni2 = 0;
|FIN;

|PROCESO Historico;
     nAbo = 1;
     |SI #65#2 = "BV"; |O #65#2 = "BC";
          nAbo = -1;
     |FINSI;
     nUni1 = #65#6 * nAbo;
     nUni2 = #65#17 * nAbo;

     |SI #65#2 = "AV"; |O #65#2 = "BV";
          nUni1 = -nUni1;
          nUni2 = -nUni2;
          #71#29 = #65#11;
          #71#0 = #65#3;
          #71#1 = #65#4;
          |LEE 000#71=;
          |SI FSalida ! 0;
               enSw = 1;
               |SI #0#1 = "S"; |BORRA 020#65a; enSw = 3; |FINSI;
               |PRINT;
          |SINO;
               |SI nUni1 ! #71#5; |O nUni2 ! #71#48;
                    enSw = 4;
                    |SI #0#2 = "S";
                         enSw = 5;
                         #65#6 = -(#71#5 * nAbo);
                         #65#17 = -(#71#48 * nAbo);
                         |GRABA 020#65a;
                    |FINSI;
                    |PRINT;
               |FINSI;
               |SI #71#2 ! #65#0;
                    enSw = 2;
                    |SI #0#1 = "S"; |BORRA 020#65a; enSw = 3; |FINSI;
                    |PRINT;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI #65#2 = "FC";
          nUni1 = -nUni1;
          nUni2 = -nUni2;
          #69#20 = #65#11;
          #69#0 = #65#3;
          #69#1 = #65#4;
          |LEE 000#69=;
          |SI FSalida ! 0;
               enSw = 1;
               |SI #0#1 = "S"; |BORRA 020#65a; enSw = 3; |FINSI;
               |PRINT;
          |SINO;
               |SI nUni1 ! #69#5; |O nUni2 ! #69#30;
                    enSw = 4;
                    |SI #0#2 = "S";
                         enSw = 5;
                         #65#6 = -#69#5;
                         #65#17 = -#69#30;
                         |GRABA 020#65a;
                    |FINSI;
                    |PRINT;
               |FINSI;
               |SI #69#2 ! #65#0;
                    enSw = 2;
                    |SI #0#1 = "S"; |BORRA 020#65a; enSw = 3; |FINSI;
                    |PRINT;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI #65#2 = "AC"; |O #65#2 = "BC";
          #80#27 = #65#11;
          #80#0 = #65#3;
          #80#1 = #65#4;
          |LEE 000#80=;
          |SI FSalida ! 0;
               enSw = 1;
               |SI #0#1 = "S"; |BORRA 020#65a; enSw = 3; |FINSI;
               |PRINT;
          |SINO;
               |SI nUni1 ! #80#5; |O nUni2 ! #80#36;
                    enSw = 4;
                    |SI #0#2 = "S";
                         enSw = 5;
                         #65#6 = #80#5 * nAbo;
                         #65#17 = #80#36 * nAbo;
                         |GRABA 020#65a;
                    |FINSI;
                    |PRINT;
               |FINSI;
               |SI #80#2 ! #65#0;
                    enSw = 2;
                    |SI #0#1 = "S"; |BORRA 020#65a; enSw = 3; |FINSI;
                    |PRINT;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE Historico;
     #65#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, Historico;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |SI #0#0 = "N"; |ACABA; |FINSI;

     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "tagz0005";
          |SI FSalida = 0;
               |ABRE #69;
               |ABRE #71;
               |ABRE #80;
               |BUCLE Historico;
               |CIERRA #80;
               |CIERRA #71;
               |CIERRA #69;
               |SI enSw ! 0; |PIEINF; |FINSI;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
