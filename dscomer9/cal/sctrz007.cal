|FICHEROS;
     sctrz007 #0;
     sctrm002 #2;
     sctrm003 #3;
     sctrm007 #7;
     sctrm008 #8;
     sctrm017 #17;
     sctrm012 #12;
     sctrm020 #20;
     sctrm021 #21;
     sctrm059 #59;
     sctrm001 #100;
     sctrw001 #101,MANTE;     ||Tmp Zona
     sctrw002 #102,MANTE;     ||Tmp Pobla
     sctrw003 #103,MANTE;     ||Tmp Tari
     sctrw004 #104,MANTE;     ||Tmp Tari Por
     sctrz008 #108,MANTE;     ||Pan Tarifas Trayectos
     sctrz009 #109,MANTE;     ||Pan Generar Tarifas
     sctrz010 #110,MANTE;     ||Pan Duplicar Tarifas
     sctrz011 #111,MANTE;     ||Pan Duplicar Tarifas Por
     sctrz067 #167,MANTE;     ||Pan Busqueda
     agifa324 #324;
     agifa321 #321;
     busqueda@;
     refere1@;
     refere2@;
     referen@;
|FIN;

|VARIABLES;
     &eaMensaje = "";
     &enLinServi = 0;
     &eaNomLogo = "";
     &enPantaLogo = 0;
     &enCtrFin = 0;
     &Tempo = "";
     aAlfa = "";
     nModo = 0;
     nModoCab = 0;
     nPanta = 0;
     nRango = 0;
     nGrid = 0;
     nGridZona = 0;
     nGridPobla = 0;
     nGridTari = 0;
     nGridBus = 0;
     nBtnAlta = 0;
     nBtnModi = 0;
     nBtnBaja = 0;
     nBtnCons = 0;
     nBtnBus = 0;
     nBtnTodos = 0;
     nBtnCreaTari = 0;
     nBtnDupliTari = 0;
     nBtnDupliTariPor = 0;
     nBtnAltaBus = 0;
     nBtnModiBus = 0;
     nBtnBajaBus = 0;
     nBtnConsBus = 0;
     i = 0;
     nReg0 = 0;
     aReg1 = "";
     nReg2 = 0;
     nReg3 = 0;
     aReg4 = "";
     aReg5 = "";
     aReg6 = "";
     nBloquea = 0;
     nId = 0;
     nSw = 0;
     nSwFin = 0;
     aTmp101 = "";
     aTmp102 = "";
     aTmp103 = "";
     aTmp104 = "";
     aTmpBus = "";
     aTipo = "";
     nPre = 0;
     aDec = "";
     nRedon = 0;
     nMulti = 0;
     nNume = 0;
     nLin = 0;
     nPrime = 0;
     aGenerar = "";
     nPrecioI = 0;
     nPrecioV = 0;
     aPath = "";
     nError = 0;
     nSwAltaBus = 0;
     aTempo = "";
     nGrupo = 0;
     nTipo = 0;
     aDivisa = "";
     aPobOrg = "";
     aPobDes = "";
     nHay = 0;
     aExiste = "";
     nSwCheq = 0;
|FIN;

|PROCESO CheqLinea1;
     |SI #referen@#3 ! #109#3;
          nHay = 0;
     |FINSI;
|FPRC;

|DEFBUCLE CheqLinea1;
     #referen@#1007;
     ;
     aTempo, nGrupo, nTipo, 000, aDivisa, aPobOrg, aPobDes;
     aTempo, nGrupo, nTipo, 999, aDivisa, aPobOrg, aPobDes;
     ;
     NULL, CheqLinea1;
|FIN;

|PROCESO CheqLinea;
     nHay = 1;
     |DDEF aAlfa;
     aAlfa = aAlfa + "sctrm020";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |BUCLE CheqLinea1;
          |DESCARGA_DEF #referen@;
     |FINSI;
     FSalida = nHay;     || = 0 Si existe
|FPRC;

|PROCESO BtnAltaBus;
     nSwAltaBus = 1;
     |HAZ BtnAlta;
     nSwAltaBus = 0;
     |SI nError = 0;
          |SALVA_DATOS #20;
          |REPON_DATOS #busqueda@;
          |GRABA 020#busqueda@.n;
          |REFRESCACONTROL nGridBus;
     |FINSI;
|FPRC;

|PROCESO BtnModiBus;
     #20#0 = #busqueda@#0;
     #20#1 = #busqueda@#1;
     #20#2 = #busqueda@#2;
     #20#3 = #busqueda@#3;
     #20#4 = #busqueda@#4;
     #20#5 = #busqueda@#5;
     #20#6 = #busqueda@#6;
     |HAZ BtnModi;
     |SI nError = 0;
          |BORRA 020#busqueda@.c;
          |SALVA_DATOS #20;
          |REPON_DATOS #busqueda@;
          |GRABA 020#busqueda@.n;
          |REFRESCACONTROL nGridBus;
     |FINSI;
|FPRC;

|PROCESO BtnBajaBus;
     #20#0 = #busqueda@#0;
     #20#1 = #busqueda@#1;
     #20#2 = #busqueda@#2;
     #20#3 = #busqueda@#3;
     #20#4 = #busqueda@#4;
     #20#5 = #busqueda@#5;
     #20#6 = #busqueda@#6;
     |HAZ BtnBaja;
     |SI nError = 0;
          |BORRA 020#busqueda@.c;
     |FINSI;
|FPRC;

|PROCESO BtnConsBus;
     #20#0 = #busqueda@#0;
     #20#1 = #busqueda@#1;
     #20#2 = #busqueda@#2;
     #20#3 = #busqueda@#3;
     #20#4 = #busqueda@#4;
     #20#5 = #busqueda@#5;
     #20#6 = #busqueda@#6;
     |HAZ BtnCons;
|FPRC;

|PROCESO TieneLineasBus;
     |DDEF aAlfa;
     aAlfa = aAlfa + "sctrm020";
     |CARGA_DEF aAlfa, refere1@;
     |SI FSalida = 0;
          |NOME_DAT #refere1@#Tempo#;
          |ABRE #refere1@;
          |LEE 000#refere1@.p;
          |SI FSalida = 0;
               |ESTADO_CONTROL nBtnModiBus, "ENABLE";
               |ESTADO_CONTROL nBtnBajaBus, "ENABLE";
               |ESTADO_CONTROL nBtnConsBus, "ENABLE";
          |SINO;
               |ESTADO_CONTROL nBtnModiBus, "DISABLE";
               |ESTADO_CONTROL nBtnBajaBus, "DISABLE";
               |ESTADO_CONTROL nBtnConsBus, "DISABLE";
          |FINSI;
          |CIERRA #refere1@;
          |DESCARGA_DEF #refere1@;
     |FINSI;
|FPRC;

|PROCESO EvtBus;
     |SI FSalida = 1; |O FSalida = 2;
          |SELECT #1#busqueda@;
          |LEE 000#busqueda@.=;
          |HAZ TieneLineasBus;
     |FINSI;
     |SI FSalida = 4;
          |HAZ BtnConsBus;
     |FINSI;
|FPRC;

|PROCESO VenBusqueda;
     |VENTANA 1101, 3098, -1, 17, "Busqueda Precios Tarifas Trayectos";
     |HAZ PushVenModal;

     |CONTROL_SIMPLE 0, "BOTON,{{193}}Alta", 1202, 1212, BtnAltaBus;
     nBtnAltaBus = FSalida;
     |CONTROL_SIMPLE 0, "BOTON,{{197}}Modificar", 1214, 1224, BtnModiBus;
     nBtnModiBus = FSalida;
     |CONTROL_SIMPLE 0, "BOTON,{{199}}Baja", 1226, 1236, BtnBajaBus;
     nBtnBajaBus = FSalida;
     |CONTROL_SIMPLE 0, "BOTON,{{155}}Consulta", 1238, 1248, BtnConsBus;
     nBtnConsBus = FSalida;
     |HAZ TieneLineasBus;
     nRango = 4 + 8 + 16 + 32;
     |LINEAL_SIMPLE #1#busqueda@, nRango, 1302, 2998, NULL, NULL, EvtBus;
     nGridBus = FSalida;
     enCtrFin = nGridBus;
     |HAZ EsperaFin;

     |HAZ PopVenModal;
|FPRC;

|PROCESO Busca;
     |SALVA_DATOS #20;
     |REPON_DATOS #busqueda@;
     |GRABA 020#busqueda@.n;
|FPRC;

|DEFBUCLE Busca;
     #20#3;
     ;
     #167#0, #167#1, #167#2, "          ", 00, 0000, 000;
     #167#0, #167#1, #167#2, "zzzzzzzzzz", 99, 9999, 999;
     ;
     NULL, Busca;
|FIN;

|PROCESO Busqueda;
     |SALVA_DATOS #20;

     |VENTANA 1115, 1785, -1, 17, "Busqueda Precios Tarifas Trayectos";
     |HAZ PushVenModal;
     |DDEFECTO #167;
     #167#0 = #321#9;
     |ABRE #324;
     #324#0 = #167#0;
     |LEE 000#324=;
     |CIERRA #324;
     #167#3 = #324#1;
     |PINPA #0#167;
     |PINDA #0#167;
     |ENDATOS #1#167;
     |SI FSalida = 0;
          |DDEF aAlfa;
          aAlfa = aAlfa + "sctrm020";
          |CARGA_DEF aAlfa, busqueda@;
          |SI FSalida = 0;
               |HAZ CreaTempo;
               aTmpBus = Tempo; |NOME_DAT #busqueda@#Tempo#;
               |DELINDEX #busqueda@;
               |ABRE #busqueda@;
               |BUCLE Busca;
               |LEE 000#busqueda@.p;
               |SI FSalida = 0;
                    |HAZ VenBusqueda;
               |SINO;
                    |MENAV "0000No hay registros...";
               |FINSI;
               |CIERRA #busqueda@;
               |DELINDEX #busqueda@;
               Tempo = aTmpBus; |HAZ BoraTempo;
               |DESCARGA_DEF #busqueda@;
          |FINSI;
     |FINSI;
     |HAZ PopVenModal;

     |REPON_DATOS #20;
     |LEE 000#20=;
|FPRC;

|PROCESO TariInversa;
     #refere2@#0 = #20#0;
     #refere2@#1 = #20#1;
     #refere2@#2 = #20#2;
     #refere2@#3 = #20#3;
     #refere2@#4 = #20#4;
     #refere2@#5 = #20#6;
     #refere2@#6 = #20#5;
     |LEE 101#refere2@.=;
     |SI FSalida ! 0; |GRABA 020#refere2@.b; |FINSI;
     #refere2@#7 = #20#7;
     #refere2@#8 = #20#8;
     |GRABA 020#refere2@.a;
     |LIBERA #refere2@;

     #59#0 = #refere2@#0;
     #59#1 = #refere2@#1;
     #59#2 = #refere2@#2;
     #59#3 = #refere2@#3;
     #59#4 = #refere2@#4;
     #59#5 = #refere2@#5;
     #59#6 = #refere2@#6;
     |LEE 101#59=;
     |SI FSalida ! 0; |GRABA 020#59b; |FINSI;
     #59#7 = #refere2@#7;
     #59#8 = #refere2@#8;
     |GRABA 020#59a;
     |LIBERA #59;
|FPRC;

|PROCESO TmpTariPor;
     nPre = nPrecioI;
     |SI #104#2 = "A";
          nPre = nPre + (nPre * #104#3 / 100);
     |SINO;
          nPre = nPre - (nPre * #104#3 / 100);
     |FINSI;
     aDec = "1" + ("0" * #111#10);
     nPre = (nPre * aDec) ! 0;
     nPre = nPre / aDec;
     #20#7 = nPre;

     nPre = nPrecioV;
     |SI #104#2 = "A";
          nPre = nPre + (nPre * #104#3 / 100);
     |SINO;
          nPre = nPre - (nPre * #104#3 / 100);
     |FINSI;

     nPre = nPre ! #111#10;
     #20#8 = nPre;

     |SI nSwCheq = 1;
          aTempo = #20#0;
          nGrupo = #104#4;
          nTipo = #104#0;
          aDivisa = #20#4;
          aPobOrg = #20#5;
          aPobDes = #20#6;
          |HAZ CheqLinea;
          |SI FSalida = 0;
               aExiste = "S";
          |FINSI;
          |ACABA;
     |FINSI;
     #20#1 = #104#4;
     #20#2 = #104#0;
     |GRABA 000#20n;
     |SI FSalida ! 0;
          |SI nPrime = 0;
               nPrime = 1;
               |MENAV "0000La tarifa ya existe, se actualiza...";
          |FINSI;
          |BORRA 020#20c;
          |GRABA 020#20n;
     |FINSI;
     |HAZ TariInversa;
|FPRC;

|DEFBUCLE TmpTariPor;
     #104#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, TmpTariPor;
|FIN

|PROCESO DuplicaTarifaPor0;
     nPrecioI = #20#7;
     nPrecioV = #20#8;
     |BUCLE TmpTariPor;
|FPRC;

|DEFBUCLE DuplicaTarifaPor0;
     #20#1;
     ;
     #111#0, #111#1, #111#9, 000, "   ", #102#1, #3#0;
     #111#0, #111#1, #111#9, 999, "zzz", #102#1, #3#0;
     ;
     NULL, DuplicaTarifaPor0;
|FIN;

|PROCESO TmpPoblaDesP;
     #3#0 = #refere1@#1;
     |LEE 020#3=;

     |SI #111#7 = "S";
          #101#0 = #refere1@#0;
          #101#1 = #3#12;
          |LEE 000#101=;
          |SI FSalida = 0; |Y #101#3 = "S";
               |BUCLE DuplicaTarifaPor0;
          |FINSI;
     |SINO;
          |BUCLE DuplicaTarifaPor0;
     |FINSI;
|FPRC;

|DEFBUCLE TmpPoblaDesP;
     #refere1@#1002;
     3;
     "D", "    ", "S";
     "D", "zzzz", "S";
     ;
     NULL, TmpPoblaDesP;
|FIN;

|PROCESO TmpPoblaOrgP;
     #3#0 = #102#1;
     |LEE 020#3=;

     |SI #111#5 = "S";
          #101#0 = #102#0;
          #101#1 = #3#12;
          |LEE 000#101=;
          |SI FSalida = 0; |Y #101#3 = "S";
               |BUCLE TmpPoblaDesP;
          |FINSI;
     |SINO;
          |BUCLE TmpPoblaDesP;
     |FINSI;
|FPRC;

|DEFBUCLE TmpPoblaOrgP;
     #102#1;
     3;
     "O", "    ", "S";
     "O", "zzzz", "S";
     ;
     NULL, TmpPoblaOrgP;
|FIN;

|PROCESO DupliTarifaPor;
     |ABRE #3;
     |DDEF aPath;
     aAlfa = aPath + "sctrw002";
     |CARGA_DEF aAlfa, refere1@;
     |SI FSalida = 0;
          |NOME_DAT #refere1@#aTmp102#;
          aAlfa = aPath + "sctrm020";
          |CARGA_DEF aAlfa, refere2@;
          |SI FSalida = 0;
               |ABRE #refere2@;
               |ABRE #59;
               |BUCLE TmpPoblaOrgP;
               |CIERRA #59;
               |CIERRA #refere2@;
               |DESCARGA_DEF #refere2@;
          |FINSI;
          |DESCARGA_DEF #refere1@;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO TmpTari;
     |SI nSwCheq = 1;
          aTempo = #20#0;
          nGrupo = #103#2;
          nTipo = #103#0;
          aDivisa = #20#4;
          aPobOrg = #20#5;
          aPobDes = #20#6;
          |HAZ CheqLinea;
          |SI FSalida = 0;
               aExiste = "S";
          |FINSI;
          |ACABA;
     |FINSI;
     #20#1 = #103#2;
     #20#2 = #103#0;
     |GRABA 000#20n;
     |SI FSalida ! 0;
          |SI nPrime = 0;
               nPrime = 1;
               |MENAV "0000La tarifa ya existe, se actualiza...";
          |FINSI;
          |BORRA 020#20c;
          |GRABA 020#20n;
     |FINSI;
     |HAZ TariInversa;
|FPRC;

|DEFBUCLE TmpTari;
     #103#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, TmpTari;
|FIN

|PROCESO DuplicaTarifa0;
     |BUCLE TmpTari;
|FPRC;

|DEFBUCLE DuplicaTarifa0;
     #20#1;
     ;
     #110#0, #110#1, #110#9, 000, "   ", #102#1, #3#0;
     #110#0, #110#1, #110#9, 999, "zzz", #102#1, #3#0;
     be;
     NULL, DuplicaTarifa0;
|FIN;

|PROCESO TmpPoblaDesD;
     #3#0 = #refere1@#1;
     |LEE 020#3=;

     |SI #110#7 = "S";
          #101#0 = #refere1@#0;
          #101#1 = #3#12;
          |LEE 000#101=;
          |SI FSalida = 0; |Y #101#3 = "S";
               |BUCLE DuplicaTarifa0;
          |FINSI;
     |SINO;
          |BUCLE DuplicaTarifa0;
     |FINSI;
|FPRC;

|DEFBUCLE TmpPoblaDesD;
     #refere1@#1002;
     3;
     "D", "    ", "S";
     "D", "zzzz", "S";
     ;
     NULL, TmpPoblaDesD;
|FIN;

|PROCESO TmpPoblaOrgD;
     #3#0 = #102#1;
     |LEE 020#3=;

     |SI #110#5 = "S";
          #101#0 = #102#0;
          #101#1 = #3#12;
          |LEE 000#101=;
          |SI FSalida = 0; |Y #101#3 = "S";
               |BUCLE TmpPoblaDesD;
          |FINSI;
     |SINO;
          |BUCLE TmpPoblaDesD;
     |FINSI;
|FPRC;

|DEFBUCLE TmpPoblaOrgD;
     #102#1;
     3;
     "O", "    ", "S";
     "O", "zzzz", "S";
     ;
     NULL, TmpPoblaOrgD;
|FIN;

|PROCESO DupliTarifa;
     |ABRE #3;
     |DDEF aPath;
     aAlfa = aPath + "sctrw002";
     |CARGA_DEF aAlfa, refere1@;
     |SI FSalida = 0;
          |NOME_DAT #refere1@#aTmp102#;
          aAlfa = aPath + "sctrm020";
          |CARGA_DEF aAlfa, refere2@;
          |SI FSalida = 0;
               |ABRE #refere2@;
               |BUCLE TmpPoblaOrgD;
               |CIERRA #refere2@;
               |DESCARGA_DEF #refere2@;
          |FINSI;
          |DESCARGA_DEF #refere1@;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO CreaTarifa0;
/*
     #21#0 = #109#3;
     #21#2 = #102#1
     #21#4 = #3#0;
     |LEE 000#21=;
*/
     |SELECT #2#21;
     #21#2 = #102#1
     #21#4 = #3#0;
     |LEE 000#21=;
     |SI FSalida ! 0;
          #21#2 = #3#0;
          #21#4 = #102#1;
          |LEE 000#21=;
     |FINSI;
     |SI FSalida ! 0; |O #21#6 = 0;
          aAlfa = "No est n creados los kil¢mnetros del origen " + #21#2 + " al destino " + #21#4 + " ...";
          |MENAV aAlfa;
     |SINO;
          |SI nSwCheq = 1;
               aTempo = #109#0;
               nGrupo = #109#1;
               nTipo = #109#2;
               aDivisa = #109#4;
               aPobOrg = #102#1;
               aPobDes = #3#0;
               |HAZ CheqLinea;
               |SI FSalida = 0;
                    aExiste = "S";
               |FINSI;
               |ACABA;
          |FINSI;

          |DDEFECTO #20;
          #20#0 = #109#0;
          #20#1 = #109#1;
          #20#2 = #109#2;
          #20#3 = #109#3;
          #20#4 = #109#4;
          #20#5 = #102#1;
          #20#6 = #3#0;
          |LEE 101#20=;
          |SI FSalida = 0; |Y nPrime = 0;
               nPrime = 1;
               |MENAV "0000La tarifa ya existe, se actualiza...";
          |FINSI;
          |SI FSalida ! 0; |GRABA 020#20b; |FINSI;
          #20#7 = #109#9;
          #20#8 = #109#10;
          |GRABA 020#20a;
          |LIBERA #20;

          ||TariInversa
          aAlfa = #20#5;
          #20#5 = #20#6;
          #20#6 = aAlfa;
          |LEE 101#20=;
          |SI FSalida ! 0; |GRABA 020#20b; |FINSI;
          #20#7 = #109#9;
          #20#8 = #109#10;
          |GRABA 020#20a;
          |LIBERA #20;
     |FINSI;
|FPRC;

|PROCESO TmpPoblaDesC;
     #3#0 = #refere1@#1;
     |LEE 020#3=;

     |SI #109#7 = "S";
          #101#0 = #refere1@#0;
          #101#1 = #3#12;
          |LEE 000#101=;
          |SI FSalida = 0; |Y #101#3 = "S";
               |HAZ CreaTarifa0;
          |FINSI;
     |SINO;
          |HAZ CreaTarifa0;
     |FINSI;
|FPRC;

|DEFBUCLE TmpPoblaDesC;
     #refere1@#1002;
     3;
     "D", "    ", "S";
     "D", "zzzz", "S";
     ;
     NULL, TmpPoblaDesC;
|FIN;

|PROCESO TmpPoblaOrgC;
     #3#0 = #102#1;
     |LEE 020#3=;

     |SI #109#5 = "S";
          #101#0 = #102#0;
          #101#1 = #3#12;
          |LEE 000#101=;
          |SI FSalida = 0; |Y #101#3 = "S";
               |BUCLE TmpPoblaDesC;
          |FINSI;
     |SINO;
          |BUCLE TmpPoblaDesC;
     |FINSI;
|FPRC;

|DEFBUCLE TmpPoblaOrgC;
     #102#1;
     3;
     "O", "    ", "S";
     "O", "zzzz", "S";
     ;
     NULL, TmpPoblaOrgC;
|FIN;

|PROCESO CreaTarifa;
     |ABRE #3;
     |ABRE #20;
     |ABRE #21;
     |DDEF aAlfa;
     aAlfa = aAlfa + "sctrw002";
     |CARGA_DEF aAlfa, refere1@;
     |SI FSalida = 0;
          |NOME_DAT #refere1@#aTmp102#;
          aExiste = "N";
          nSwCheq = 1; |BUCLE TmpPoblaOrgC;
          |SI aExiste = "S";
/*

               |CONFI "0000NYa existe registro con otra linea de servicio. ¨Desea continuar?";
               |SI FSalida = 0;
                    nSwCheq = 0; |BUCLE TmpPoblaOrgC;
               |FINSI;
*/
               |MENAV "0000Ya existe registro con otra linea de servicio...";

          |SINO;
               nSwCheq = 0; |BUCLE TmpPoblaOrgC;
          |FINSI;
          |DESCARGA_DEF #refere1@;
     |FINSI;
     |CIERRA #21;
     |CIERRA #20;
     |CIERRA #3;
|FPRC;

|PROCESO CargaPobla;
     #101#0 = aTipo;
     #101#1 = #3#12;
     |LEE 000#101=;
     |SI FSalida = 0; |Y #101#3 = "S";
          #102#0 = aTipo;
          #102#1 = #3#0;
          #102#2 = #3#1;
          #102#3 = "S";
          |GRABA 020#102n;
     |FINSI;
|FPRC;

|DEFBUCLE CargaPobla;
     #3#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, CargaPobla;
|FIN;

|PROCESO CargaZona;
     #101#0 = aTipo;
     #101#1 = #2#0;
     #101#2 = #2#1;
     #101#3 = aGenerar;
     |GRABA 020#101n;
|FPRC;

|DEFBUCLE CargaZona;
     #2#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, CargaZona;
|FIN;

|PROCESO GrupoTariPor0; |TIPO 0;
     |ABRE #7;
     #7#0 = #104#4;
     |LEE 000#7=;
     |SI FSalida = 0;
          #104#5 = #7#1; |PINTA #104#5;
     |SINO;
          |MENAV "0000No existe c¢digo grupo tarifa...";
          |ERROR;
     |FINSI;
     |CIERRA #7;
|FPRC;

|PROCESO GrupoTariPor66; |TIPO 66;
     |ABRE #7;
     #7#0 = #104#4;
     |LEE 000#7];
     |CONSULTA_CLAVE #1#7;
     |SI FSalida = 0;
          #104#4 = #7#0; |PINTA #104#4;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #7;
|FPRC;

|PROCESO TipTariPor0; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |ABRE #17;
     #17#0 = #111#0;
     #17#2 = #104#4;
     #17#4 = #104#0;
     |LEE 000#17=;
     |SI FSalida = 0;
          #104#1 = #17#5; |PINTA #104#1;
     |SINO;
          |MENAV "0000No existe c¢digo tipo tarifa...";
          |ERROR;
     |FINSI;
     |CIERRA #17;
|FPRC;

|PROCESO MinPor17;
     #17#0 = #111#0;
     #17#2 = #104#4;
     #17#4 = 0000;
|FPRC;

|PROCESO MaxPor17;
     #17#0 = #111#0;
     #17#2 = #104#4;
     #17#4 = 9999;
|FPRC;

|PROCESO TipTariPor66; |TIPO 66;
     |ABRE #17;
     #17#0 = #111#0;
     #17#2 = #104#4;
     #17#3 = #104#0;
     |LEE 000#17];
     |CONSULTA_F_CLAVE #1#17, MinPor17, MaxPor17;
     |SI FSalida = 0;
          #104#0 = #17#4; |PINTA #104#0;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #17;
|FPRC;

|PROCESO GrupoTari0; |TIPO 0;
     |ABRE #7;
     #7#0 = #103#2;
     |LEE 000#7=;
     |SI FSalida = 0;
          #103#3 = #7#1; |PINTA #103#3;
     |SINO;
          |MENAV "0000No existe c¢digo grupo tarifa...";
          |ERROR;
     |FINSI;
     |CIERRA #7;
|FPRC;

|PROCESO GrupoTari66; |TIPO 66;
     |ABRE #7;
     #7#0 = #103#2;
     |LEE 000#7];
     |CONSULTA_CLAVE #1#7;
     |SI FSalida = 0;
          #103#2 = #7#0; |PINTA #103#2;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #7;
|FPRC;

|PROCESO TipTari0; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |ABRE #17;
     #17#0 = #110#0;
     #17#2 = #103#2;
     #17#4 = #103#0;
     |LEE 000#17=;
     |SI FSalida = 0;
          #103#1 = #17#5; |PINTA #103#1;
     |SINO;
          |MENAV "0000No existe c¢digo tipo tarifa...";
          |ERROR;
     |FINSI;
     |CIERRA #17;
|FPRC;

|PROCESO Min17;
     #17#0 = #110#0;
     #17#2 = #103#2;
     #17#4 = 0000;
|FPRC;

|PROCESO Max17;
     #17#0 = #110#0;
     #17#2 = #103#2;
     #17#4 = 9999;
|FPRC;

|PROCESO TipTari66; |TIPO 66;
     |ABRE #17;
     #17#0 = #110#0;
     #17#2 = #103#2;
     #17#4 = #103#0;
     |LEE 000#17];
     |CONSULTA_F_CLAVE #1#17, Min17, Max17;
     |SI FSalida = 0;
          #103#0 = #17#4; |PINTA #103#0;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #17;
|FPRC;

|PROCESO Pobla; |TIPO 0;
     |ABRE #3;
     #3#0 = #102#1;
     |LEE 000#3=;
     |SI FSalida = 0;
          #102#2 = #3#1; |PINTA #102#2;
     |SINO;
          |MENAV "0000No existe c¢digo poblaci¢n...";
          |ERROR;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO Zona; |TIPO 0;
     |ABRE #2;
     #2#0 = #101#1;
     |LEE 000#2=;
     |SI FSalida = 0;
          #101#2 = #2#1; |PINTA #101#2;
     |SINO;
          |MENAV "0000No existe c¢digo zona...";
          |ERROR;
     |FINSI;
     |CIERRA #2;
|FPRC;

|PROCESO TipoTariIni111; |TIPO 0;
     |ABRE #17;
     #17#0 = #111#0;
     #17#2 = #111#1;
     #17#4 = #111#9;
     |LEE 000#17=;
     |SI FSalida = 0;
          |PINTA 831, #17#5;
     |SINO;
          |DDEFECTO #17;
          |PINTA 831, #17#5;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo tipo tarifa...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #17;
|FPRC;

|PROCESO Carga111; |TIPO 0;
     |SI #111Campo = "S";
          |SI Campo = 5; |O Campo = 7;
               |SI Campo = 5; aTipo = "O"; |SINO; aTipo = "D"; |FINSI;
               #101#0 = aTipo;
               #101#1 = "";
               |LEE 000#101];
               |SI FSalida ! 0; |O #101#0 ! aTipo;
                    aGenerar = "S";
                    |BUCLE CargaZona;
                    |LEE 000#101p;
                    |REFRESCACONTROL nGridZona;
               |FINSI;
          |SINO;
               |SI Campo = 6; aTipo = "O"; |SINO; aTipo = "D"; |FINSI;
               #102#0 = aTipo;
               #102#1 = "";
               |LEE 000#102];
               |SI FSalida ! 0; |O #102#0 ! aTipo;
                    |SALVA_FICHA #101;
                    |BUCLE CargaPobla;
                    |REPON_FICHA #101;
                    |LEE 000#102p;
                    |REFRESCACONTROL nGridPobla;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Temporada111; |TIPO 0;
     |ABRE #8;
     #8#0 = #111#0;
     |LEE 000#8=;
     |SI FSalida = 0;
          |PINTA 631, #8#1;
     |SINO;
          |DDEFECTO #8;
          |PINTA 631, #8#1;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo temporada...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #8;
|FPRC;

|PROCESO Grupo111; |TIPO 0;
     |ABRE #7;
     #7#0 = #111#1;
     |LEE 000#7=;
     |SI FSalida = 0;
          |PINTA 731, #7#1;
     |SINO;
          |DDEFECTO #7;
          |PINTA 731, #7#1;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo grupo tarifa...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #7;
|FPRC;

|PROCESO DefLin104; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |LEE 000#104u;
          |SI FSalida = 0;
               nLin = #104#6 + 1;
          |SINO;
               nLin = 1;
          |FINSI;
          |DDEFECTO #104;
          #104#6 = nLin;
     |FINSI;
|FPRC;

|PROCESO PintaCampos111;
     nSw = 1;
     |HAZ Temporada111;
     |HAZ Grupo111;
     |HAZ TipoTariIni111;
     nSw = 0;
|FPRC;

|PROCESO BtnDupliTariPor;
     |VENTANA 0501, 3098, -1, 17, "Duplicar Tarifas aplicando % aumento/disminuci¢n";
     |HAZ PushVenModal;

     |HAZ CreaTempo; |NOME_DAT #101 Tempo; aTmp101 = Tempo;
     |HAZ CreaTempo; |NOME_DAT #102 Tempo; aTmp102 = Tempo;
     |HAZ CreaTempo; |NOME_DAT #104 Tempo; aTmp104 = Tempo;
     |DELINDEX #101; |ABRE #101;
     |DELINDEX #102; |ABRE #102;
     |DELINDEX #104; |ABRE #104;

     |DDEFECTO #111;
     |PINPA #0#111;
     |PINDA #0#111;
     |HAZ PintaCampos111;
     nRango = 1 + 4 + 8 + 16 + 32;
     |LINEAL_SIMPLE #1#104, nRango, 1002, 1598, NULL, NULL, NULL;
     nGridTari = FSalida;
     |LINEAL_SIMPLE #1#101, nRango, 1702, 2298, NULL, NULL, NULL;
     nGridZona = FSalida;
     |LINEAL_SIMPLE #1#102, nRango, 2402, 2998, NULL, NULL, NULL;
     nGridPobla = FSalida;
     |ENDATOS #1#111;
     |SI FSalida = 0;
          eaMensaje = "Duplicando tarifas..."; |HAZ IniMensaje;
          nPrime = 0;
          aExiste = "N";
          nSwCheq = 1; |HAZ DupliTarifaPor;
          |SI aExiste = "S";
/*
               |CONFI "0000NYa existe registro con otra linea de servicio. ¨Desea continuar?";
               |SI FSalida = 0;
                    nSwCheq = 0; |HAZ DupliTarifaPor;
               |FINSI;
*/
               |MENAV "0000Ya existe registro con otra linea de servicio...";
          |SINO;
               nSwCheq = 0; |HAZ DupliTarifaPor;
          |FINSI;
          |HAZ FinMensaje;
          |REFRESCACONTROL nGrid;
     |FINSI;

     |CIERRA #101; Tempo = aTmp101; |HAZ BoraTempo; |DELINDEX #101;
     |CIERRA #102; Tempo = aTmp102; |HAZ BoraTempo; |DELINDEX #102;
     |CIERRA #104; Tempo = aTmp104; |HAZ BoraTempo; |DELINDEX #104;

     |HAZ PopVenModal;
|FPRC;

|PROCESO TipoTariIni110;
     |ABRE #17;
     #17#0 = #110#0;
     #17#2 = #110#1;
     #17#4 = #110#9;
     |LEE 000#17=;
     |SI FSalida = 0;
          |PINTA 831, #17#5;
     |SINO;
          |DDEFECTO #17;
          |PINTA 831, #17#5;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo tipo tarifa...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #17;
|FPRC;

|PROCESO Carga110; |TIPO 0;
     |SI #110Campo = "S";
          |SI Campo = 5; |O Campo = 7;
               |SI Campo = 5; aTipo = "O"; |SINO; aTipo = "D"; |FINSI;
               #101#0 = aTipo;
               #101#1 = "";
               |LEE 000#101];
               |SI FSalida ! 0; |O #101#0 ! aTipo;
                    aGenerar = "S";
                    |BUCLE CargaZona;
                    |LEE 000#101p;
                    |REFRESCACONTROL nGridZona;
               |FINSI;
          |SINO;
               |SI Campo = 6; aTipo = "O"; |SINO; aTipo = "D"; |FINSI;
               #102#0 = aTipo;
               #102#1 = "";
               |LEE 000#102];
               |SI FSalida ! 0; |O #102#0 ! aTipo;
                    |BUCLE CargaPobla;
                    |LEE 000#102p;
                    |REFRESCACONTROL nGridPobla;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Temporada110; |TIPO 0;
     |ABRE #8;
     #8#0 = #110#0;
     |LEE 000#8=;
     |SI FSalida = 0;
          |PINTA 631, #8#1;
     |SINO;
          |DDEFECTO #8;
          |PINTA 631, #8#1;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo temporada...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #8;
|FPRC;

|PROCESO Grupo110; |TIPO 0;
     |ABRE #7;
     #7#0 = #110#1;
     |LEE 000#7=;
     |SI FSalida = 0;
          |PINTA 731, #7#1;
     |SINO;
          |DDEFECTO #7;
          |PINTA 731, #7#1;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo grupo tarifa...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #7;
|FPRC;

|PROCESO DefLin103; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |LEE 000#103u;
          |SI FSalida = 0;
               nLin = #103#4 + 1;
          |SINO;
               nLin = 1;
          |FINSI;
          |DDEFECTO #103;
          #103#4 = nLin;
     |FINSI;
|FPRC;

|PROCESO PintaCampos110;
     nSw = 1;
     |HAZ Temporada110;
     |HAZ Grupo110;
     |HAZ TipoTariIni110;
     nSw = 0;
|FPRC;

|PROCESO BtnDupliTari;
     |VENTANA 0501, 3098, -1, 17, "Duplicar Tarifas";
     |HAZ PushVenModal;

     |HAZ CreaTempo; |NOME_DAT #101 Tempo; aTmp101 = Tempo;
     |HAZ CreaTempo; |NOME_DAT #102 Tempo; aTmp102 = Tempo;
     |HAZ CreaTempo; |NOME_DAT #103 Tempo; aTmp103 = Tempo;
     |DELINDEX #101; |ABRE #101;
     |DELINDEX #102; |ABRE #102;
     |DELINDEX #103; |ABRE #103;

     |DDEFECTO #110;
     |PINPA #0#110;
     |PINDA #0#110;
     |HAZ PintaCampos110;
     nRango = 1 + 4 + 8 + 16 + 32;
     |LINEAL_SIMPLE #1#103, nRango, 1002, 1598, NULL, NULL, NULL;
     nGridTari = FSalida;
     |LINEAL_SIMPLE #1#101, nRango, 1702, 2298, NULL, NULL, NULL;
     nGridZona = FSalida;
     |LINEAL_SIMPLE #1#102, nRango, 2402, 2998, NULL, NULL, NULL;
     nGridPobla = FSalida;
     |ENDATOS #1#110;
     |SI FSalida = 0;
          eaMensaje = "Duplicando tarifas..."; |HAZ IniMensaje;
          nPrime = 0;
          aExiste = "N";
          nSwCheq = 1; |HAZ DupliTarifa;
          |SI aExiste = "S";
/*
               |CONFI "0000NYa existe registro con otra linea de servicio. ¨Desea continuar?";
               |SI FSalida = 0;
                    nSwCheq = 0; |HAZ DupliTarifa;
               |FINSI;
*/
               |MENAV "0000Ya existe registro con otra linea de servicio.";

          |SINO;
               nSwCheq = 0; |HAZ DupliTarifa;
          |FINSI;
          |HAZ FinMensaje;
          |REFRESCACONTROL nGrid;
     |FINSI;

     |CIERRA #101; Tempo = aTmp101; |HAZ BoraTempo; |DELINDEX #101;
     |CIERRA #102; Tempo = aTmp102; |HAZ BoraTempo; |DELINDEX #102;
     |CIERRA #103; Tempo = aTmp103; |HAZ BoraTempo; |DELINDEX #103;

     |HAZ PopVenModal;
|FPRC;

|PROCESO Carga109; |TIPO 0;
     |SI #109Campo = "S";
          |SI Campo = 5; |O Campo = 7;
               |SI Campo = 5; aTipo = "O"; |SINO; aTipo = "D"; |FINSI;
               #101#0 = aTipo;
               #101#1 = "";
               |LEE 000#101];
               |SI FSalida ! 0; |O #101#0 ! aTipo;
                    aGenerar = "N";
                    |BUCLE CargaZona;
                    |LEE 000#101p;
                    |REFRESCACONTROL nGridZona;
               |FINSI;
          |SINO;
               |SI Campo = 6; aTipo = "O"; |SINO; aTipo = "D"; |FINSI;
               #102#0 = aTipo;
               #102#1 = "";
               |LEE 000#102];
               |SI FSalida ! 0; |O #102#0 ! aTipo;
                    |BUCLE CargaPobla;
                    |LEE 000#102p;
                    |REFRESCACONTROL nGridPobla;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Temporada109; |TIPO 0;
     |ABRE #8;
     #8#0 = #109#0;
     |LEE 000#8=;
     |SI FSalida = 0;
          |PINTA 631, #8#1;
     |SINO;
          |DDEFECTO #8;
          |PINTA 631, #8#1;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo temporada...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #8;
|FPRC;

|PROCESO Grupo109; |TIPO 0;
     |ABRE #7;
     #7#0 = #109#1;
     |LEE 000#7=;
     |SI FSalida = 0;
          |PINTA 731, #7#1;
     |SINO;
          |DDEFECTO #7;
          |PINTA 731, #7#1;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo grupo tarifa...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #7;
|FPRC;

|PROCESO TipoTari109; |TIPO 0;
     |ABRE #17;
     #17#0 = #109#0;
     #17#2 = #109#1;
     #17#4 = #109#2;
     |LEE 000#17=;
     |SI FSalida = 0;
          |PINTA 831, #17#5;
     |SINO;
          |DDEFECTO #17;
          |PINTA 831, #17#5;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo tipo tarifa...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #17;
|FPRC;

|PROCESO LinServi109; |TIPO 0;
     |ABRE #12;
     #12#0 = #109#3;
     |LEE 000#12=;
     |SI FSalida = 0;
          |PINTA 931, #12#1;
     |SINO;
          |DDEFECTO #12;
          |PINTA 931, #12#1;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo l¡nea servicio...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #12;
|FPRC;

|PROCESO Divisa109; |TIPO 0;
     |ABRE #324;
     #324#0 = #109#4;
     |LEE 000#324=;
     |SI FSalida = 0;
          |PINTA 1031, #324#1;
     |SINO;
          |DDEFECTO #324;
          |PINTA 1031, #324#1;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo divida...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #324;
|FPRC;

|PROCESO PintaCampos109;
     nSw = 1;
     |HAZ Temporada109;
     |HAZ Grupo109;
     |HAZ TipoTari109;
     |HAZ LinServi109;
     |HAZ Divisa109;
     nSw = 0;
|FPRC;

|PROCESO BtnCreaTari; |TIPO 0;
     |VENTANA 0501, 3098, -1, 17, "Creaci¢n Tarifas";
     |HAZ PushVenModal;

     |HAZ CreaTempo; |NOME_DAT #101 Tempo; aTmp101 = Tempo;
     |HAZ CreaTempo; |NOME_DAT #102 Tempo; aTmp102 = Tempo;
     |DELINDEX #101; |ABRE #101;
     |DELINDEX #102; |ABRE #102;

     |DDEFECTO #109;
     |PINPA #0#109;
     |PINDA #0#109;
     |HAZ PintaCampos109;
     nRango = 1 + 4 + 8 + 16 + 32;
     |LINEAL_SIMPLE #1#101, nRango, 1302, 2098, NULL, NULL, NULL;
     nGridZona = FSalida;
     |LINEAL_SIMPLE #1#102, nRango, 2202, 2998, NULL, NULL, NULL;
     nGridPobla = FSalida;
     |ENDATOS #1#109;
     |SI FSalida = 0;
          eaMensaje = "Creando tarifas..."; |HAZ IniMensaje;
          nPrime = 0;
          |HAZ CreaTarifa;
          |HAZ FinMensaje;
          |REFRESCACONTROL nGrid;
     |FINSI;

     |CIERRA #101; Tempo = aTmp101; |HAZ BoraTempo; |DELINDEX #101;
     |CIERRA #102; Tempo = aTmp102; |HAZ BoraTempo; |DELINDEX #102;

     |HAZ PopVenModal;
|FPRC;

|PROCESO Temporada; |TIPO 0;
     |ABRE #8;
     #8#0 = #108#0;
     |LEE 000#8=;
     |SI FSalida = 0;
          |PINTA 633, #8#1;
     |SINO;
          |DDEFECTO #8;
          |PINTA 633, #8#1;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo temporada...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #8;
|FPRC;

|PROCESO Grupo; |TIPO 0;
     |ABRE #7;
     #7#0 = #108#1;
     |LEE 000#7=;
     |SI FSalida = 0;
          |PINTA 733, #7#1;
     |SINO;
          |DDEFECTO #7;
          |PINTA 733, #7#1;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo grupo tarifa...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #7;
|FPRC;

|PROCESO TipoTari; |TIPO 0;
     |ABRE #17;
     #17#0 = #108#0;
     #17#2 = #108#1;
     #17#4 = #108#2;
     |LEE 000#17=;
     |SI FSalida = 0;
          |PINTA 833, #17#5;
     |SINO;
          |DDEFECTO #17;
          |PINTA 833, #17#5;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo tipo tarifa...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #17;
|FPRC;

|PROCESO LinServi; |TIPO 0;
     |ABRE #12;
     #12#0 = #108#3;
     |LEE 000#12=;
     |SI FSalida = 0;
          |PINTA 933, #12#1;
     |SINO;
          |DDEFECTO #12;
          |PINTA 933, #12#1;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo l¡nea servicio...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #12;
|FPRC;

|PROCESO Divisa; |TIPO 0;
     |ABRE #324;
     #324#0 = #108#4;
     |LEE 000#324=;
     |SI FSalida = 0;
          |PINTA 1033, #324#1;
     |SINO;
          |DDEFECTO #324;
          |PINTA 1033, #324#1;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo divida...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #324;
|FPRC;

|PROCESO PobOrg; |TIPO 0;
     |ABRE #3;
     #3#0 = #108#5;
     |LEE 000#3=;
     |SI FSalida = 0;
          |PINTA 1133, #3#1;
     |SINO;
          |DDEFECTO #3;
          |PINTA 1133, #3#1;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo poblaci¢n...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO PobDes; |TIPO 0;
     |ABRE #3;
     #3#0 = #108#6;
     |LEE 000#3=;
     |SI FSalida = 0;
          |PINTA 1233, #3#1;
          |SI nModoCab = 1; |Y nBloquea = 0; |Y nSw = 0;
               aTempo = #108#0;
               nGrupo = #108#1;
               nTipo = #108#2;
               aDivisa = #108#4;
               aPobOrg = #108#5;
               aPobDes = #108#6;
               |HAZ CheqLinea;
               |SI FSalida = 0;
                    |MENAV "0000NYa existe registro con otra linea de servicio...";
                    |ERROR; |ACABA;
/*
                    |CONFI "0000NYa existe registro con otra linea de servicio. ¨Desea continuar?";
                    |SI FSalida ! 0;
                         |ERROR;  |ACABA;
                    |FINSI;
*/
               |FINSI;

               |DDEFECTO #20
               #20#0 = #108#0;
               #20#1 = #108#1;
               #20#2 = #108#2;
               #20#3 = #108#3;
               #20#4 = #108#4;
               #20#5 = #108#5;
               #20#6 = #108#6;
               |GRABA 000#20b;
               |SI FSalida ! 0;
                    |MENAV "0000Registro existente...";
                    |ERROR;
               |SINO;
                    |C_M #108#0, 1, "N";
                    |C_M #108#1, 1, "N";
                    |C_M #108#2, 1, "N";
                    |C_M #108#3, 1, "N";
                    |C_M #108#4, 1, "N";
                    |C_M #108#5, 1, "N";
                    |C_M #108#6, 1, "N";
                    nBloquea = 1;

                    aAlfa  = "|X000"; aAlfa = #108aAlfa; nId = aAlfa;
                    |ESTADO_CONTROL nId, "ENABLE";
               |FINSI;
          |FINSI;
     |SINO;
          |DDEFECTO #3;
          |PINTA 1233, #3#1;
          |SI nSw = 0;
               |MENAV "0000No existe c¢digo poblaci¢n...";
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO Valida7; |TIPO 7;
     |SI nModoCab = 1;
          aAlfa  = "|X000"; aAlfa = #108aAlfa; nId = aAlfa;
          |ESTADO_CONTROL nId, "DISABLE";
     |FINSI;
|FPRC;

|PROCESO PintaCampos;
     nSw = 1;
     |HAZ Temporada;
     |HAZ Grupo;
     |HAZ TipoTari;
     |HAZ LinServi;
     |HAZ Divisa;
     |HAZ PobOrg;
     |HAZ PobDes;
     nSw = 0;
|FPRC;

|PROCESO Edita;
     nReg0 = #20#0;
     aReg1 = #20#1;
     nReg2 = #20#2;
     nReg3 = #20#3;
     aReg4 = #20#4;
     aReg5 = #20#5;
     aReg6 = #20#6;

     |SI nModoCab = 1; |VENTANA 1901, 3098, -1, 17, "Nueva Tarifas Trayectos"; |FINSI;
     |SI nModoCab = 2; |VENTANA 1901, 3098, -1, 17, "Modifica Tarifa Trayectos"; |FINSI;
     |SI nModoCab = 4; |VENTANA 1901, 3098, -1, 17, "Consulta Tarifa Trayectos"; |FINSI;
     |HAZ PushVenModal;

     |SI nModoCab = 1;
          |DDEFECTO #108;
          |C_M #108#0, 1, "S";
          |C_M #108#1, 1, "S";
          |C_M #108#2, 1, "S";
          |C_M #108#3, 1, "S";
          |C_M #108#4, 1, "S";
          |C_M #108#5, 1, "S";
          |C_M #108#6, 1, "S";
          |SI nSwAltaBus = 1;
               #108#4 = #167#0;
               #108#5 = #167#1;
               #108#6 = #167#2;
          |FINSI;
     |SINO;
          |PARA i = 0; |SI i [ 8; |HACIENDO i = i + 1;
               #108i = #20i;
          |SIGUE;
          |C_M #108#0, 1, "N";
          |C_M #108#1, 1, "N";
          |C_M #108#2, 1, "N";
          |C_M #108#3, 1, "N";
          |C_M #108#4, 1, "N";
          |C_M #108#5, 1, "N";
          |C_M #108#6, 1, "N";
     |FINSI;

     |PINPA #0#108; nPanta = FSalida;
     |PINDA #0#108;
     |HAZ PintaCampos;

     nBloquea = 0;
     |SI nModoCab = 1; |ENDATOS #1#108; |FINSI;
     |SI nModoCab = 2; |ENDATOS #2#108; |FINSI;
     |SI nModoCab = 4; |PAUSA; |FINSI;
     nError = FSalida;
     |SI FSalida = 0; |Y nModoCab ! 4;
          #20#0 = #108#0;
          #20#1 = #108#1;
          #20#2 = #108#2;
          #20#3 = #108#3;
          #20#4 = #108#4;
          #20#5 = #108#5;
          #20#6 = #108#6;
          |LEE 121#20=;
          |PARA i = 0; |SI i [ 8; |HACIENDO i = i + 1;
               #20i = #108i;
          |SIGUE;
          |GRABA 020#20a;
          nReg0 = #20#0;
          aReg1 = #20#1;
          nReg2 = #20#2;
          nReg3 = #20#3;
          aReg4 = #20#4;
          aReg5 = #20#5;
          aReg6 = #20#6;
     |SINO;
          |SI nBloquea = 1;
               #20#0 = #108#0;
               #20#1 = #108#1;
               #20#2 = #108#2;
               #20#3 = #108#3;
               #20#4 = #108#4;
               #20#5 = #108#5;
               #20#6 = #108#6;
               |BORRA 020#20c;
          |FINSI;
     |FINSI;
     |LIBERA #20;

     |HAZ PopVenModal;

     #20#0 = nReg0;
     #20#1 = aReg1;
     #20#2 = nReg2;
     #20#3 = nReg3;
     #20#4 = aReg4;
     #20#5 = aReg5;
     #20#6 = aReg6;
     |LEE 000#20=;
     |REFRESCACONTROL nGrid;
|FPRC;

|PROCESO BtnAlta;
     nModoCab = 1; |HAZ Edita;
     |HAZ TieneLineas;
|FPRC;

|PROCESO BtnModi;
     |LEE 100#20=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     nModoCab = 2; |HAZ Edita;
|FPRC;

|PROCESO BtnBaja;
     |LEE 100#20=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     aAlfa = "0000N¨Borrar precio tarifa trayectos: " + #20#0 + "/" + #20#1 + "/" + #20#2 + "/" + #20#3 + "/" + #20#4 + "/" + #20#5 + "/" + #20#6 + "?";
     |CONFI aAlfa;
     nError = FSalida;
     |SI FSalida = 0;
          |BORRA 020#20a;
          |HAZ TieneLineas;
          |REFRESCACONTROL nGrid;
     |FINSI;
     |LIBERA #20;
|FPRC;

|PROCESO BtnCons;
     |LEE 000#20=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     nModoCab = 4; |HAZ Edita;
|FPRC;

|PROCESO BtnBus;
     |HAZ Busqueda;
|FPRC;

|PROCESO Evento20;
     |SI FSalida = 1; |O FSalida = 2;
          |SI enLinServi = 0;
               |SELECT #1#20;
          |SINO;
               |SELECT #2#20;
          |FINSI;
          |LEE 000#20=;
          |HAZ TieneLineas;
     |FINSI;
     |SI FSalida = 4;
          |HAZ BtnCons;
     |FINSI;
|FPRC;

|PROCESO TieneLineas;
     |DDEF aAlfa;
     aAlfa = aAlfa + "sctrm020";
     |CARGA_DEF aAlfa, refere1@;
     |SI FSalida = 0;
          |ABRE #refere1@;
          |SI enLinServi = 0;
               |LEE 000#refere1@.p;
          |SINO;
               |SELECT #2#refere1@;
               |DDEFECTO #refere1@;
               #refere1@#3 = enLinServi;
               |LEE 000#refere1@.];
               |SI FSalida ! 0; |O #refere1@#3 ! enLinServi;
                    FSalida = "1";
               |FINSI;
          |FINSI;
          |SI FSalida = 0;
               |ESTADO_CONTROL nBtnModi, "ENABLE";
               |ESTADO_CONTROL nBtnBaja, "ENABLE";
               |ESTADO_CONTROL nBtnCons, "ENABLE";
               |ESTADO_CONTROL nBtnBus, "ENABLE";
          |SINO;
               |ESTADO_CONTROL nBtnModi, "DISABLE";
               |ESTADO_CONTROL nBtnBaja, "DISABLE";
               |ESTADO_CONTROL nBtnCons, "DISABLE";
               |ESTADO_CONTROL nBtnBus, "DISABLE";
          |FINSI;
          |CIERRA #refere1@;
          |DESCARGA_DEF #refere1@;
     |FINSI;
|FPRC;

|PROCESO LogoPanta;
     eaNomLogo = #100#1;
     |HAZ TraeLogoPan;
     enPantaLogo = nPanta;
     |HAZ PintaLogoPan;
|FPRC;

|PROCESO BtnTodos;
     nSwFin = 1;
     enLinServi = 0;
     |PTEC 807;
|FPRC;

|PROCESO Min20;
     #20#0 = "          ";
     #20#1 = 00;
     #20#2 = 0000;
     #20#3 = enLinServi;
     #20#4 = "   ";
     #20#5 = "    ";
     #20#6 = "    ";
|FPRC;

|PROCESO Max20;
     #20#0 = "zzzzzzzzzz";
     #20#1 = 99;
     #20#2 = 9999;
     #20#3 = enLinServi;
     #20#4 = "zzz";
     #20#5 = "zzzz";
     #20#6 = "zzzz";
|FPRC;

|PROGRAMA;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     |ABRE #321; |LEE 000#321p; |CIERRA #321;

     |PINPA #0#0; nPanta = FSalida;
     |PINDA #0#0;
     |HAZ LogoPanta;

     |CONTROL_SIMPLE nPanta, "BOTON,{{193}}Alta", 1202, 1212, BtnAlta;
     nBtnAlta = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Modificar", 1214, 1224, BtnModi;
     nBtnModi = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,{{199}}Baja", 1226, 1236, BtnBaja;
     nBtnBaja = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,{{155}}Consulta", 1238, 1248, BtnCons;
     nBtnCons = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,{{163}}Busqueda", 1250, 1260, BtnBus;
     nBtnBus = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{137}}Creaci¢n Tarifa", 2902, 2922, BtnCreaTari;
     nBtnCreaTari = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,{{137}}Duplicar Tarifa", 2924, 2944, BtnDupliTari;
     nBtnDupliTari = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,{{137}}Duplicar Tarifa aplicando % aumento/disminuci¢n", 2946, 2988, BtnDupliTariPor;
     nBtnDupliTariPor = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{230}}Todos", 1288, 1298, BtnTodos;
     nBtnTodos = FSalida;

     |ABRET #20;
     |PARA nSwFin = 1; |SI nSwFin = 1; |HACIENDO;
          |HAZ TieneLineas;
          nSwFin = 0;
          nRango = 4 + 8 + 16 + 32;
          |SI enLinServi = 0;
               |ESTADO_CONTROL nBtnTodos, "DISABLE";
               |LINEAL_SIMPLE #1#20, nRango, 1302, 2799, NULL, NULL, Evento20;
          |SINO;
               |LINEAL_SIMPLE #2#20, nRango, 1302, 2799, Min20, Max20, Evento20;
          |FINSI;
          nGrid = FSalida;
          enCtrFin = nGrid;
          |HAZ EsperaFin;
          |PULSATECLA;
          |DESTRUYECONTROL nGrid;
     |SIGUE;
     |CIERRAT #20;
|FPRO;
