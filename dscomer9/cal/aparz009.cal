|FICHEROS;
     aparz009 #0;
     aparw007 #7;
     aparm017 #17;
     aparm035 #35;
|FIN;

|VARIABLES;
     nSwAcaba = 0;
     aMensaje = "";
     aAlfa = "";
     fHoy = @;
     &eaMes = "";
     &enMes = 0;
     &efDFecha = @;
     &efHFecha = @;
     f = @;
     nMeses = 0;
     nNume = 0;
     nCampo = 0;
     i = 0;
     aMes = "";
     nMes = 0;
     aA¤o = "";
|FIN;

|PROCESO TmpR;
     |PRINT;
|FPRC;

|DEFBUCLE TmpR;
     #7#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, TmpR;
|FIN;

|PROCESO KmDiaR;
     aMes = #35#1 % 402;
     aA¤o = #35#1 % -104;
     |SI #0#4 = #0#5; |O #0#4 = aA¤o;
          nMes = aMes;
          nMes = nMes - #0#6 + 1;
     |SINO;
          nMes = aMes;
          nMes = nMes + 12 - #0#6 + 1;
     |FINSI;

     |DDEFECTO #17;
     #17#0 = #35#0;
     |LEE 000#17=;

     |DDEFECTO #7;
     #7#0 = #17#0;
     |LEE 101#7=;
     |SI FSalida ! 0;
          #7#1 = #17#1;
          |GRABA 020#7b;
     |FINSI;
     nMes = nMes + 1;
     #7nMes = #7nMes + #35#2;
     |GRABA 020#7a;
     |LIBERA #7;
|FPRC;

|DEFBUCLE KmDiaR;
     #35#1;
     ;
     #0#0, efDFecha;
     #0#1, efHFecha;
     ;
     NULL, KmDiaR;
|FIN;

|PROCESO KmDiaD;
     aAlfa = #35#1 % 402;
     enMes = aAlfa;
     i = enMes; |HAZ NomMes; eaMes = aAlfa;
     |QBT eaMes;
     |PRINT;
|FPRC;

|DEFBUCLE KmDiaD;
     #35#1;
     ;
     #0#0, efDFecha;
     #0#1, efHFecha;
     ;
     NULL, KmDiaD;
|FIN;

|PROCESO Tipo12; |TIPO 12;
     |SI FSalida = 7; |ACABA; |FINSI;

     |SI #0#4 ! #0#5;
          nNume = #0#4 + 1;

          |SI nNume > #0#5;
               |MENAV "0000No se puede listar mas de un a¤o...";
               |ERROR;
               |ACABA;
          |SINO;
               nNume = 12 - #0#6 + #0#7;
               |SI nNume ] 12;
                    |MENAV "0000No se puede listas mas de un a¤o...";
                    |ERROR;
                    |ACABA;
               |FINSI;
          |FINSI;
     |FINSI;

     aMensaje = "0000SES CORRECTO?";
     |CONFI aMensaje;
     |SI FSalida ! 0;
          nSwAcaba = 1;
     |FINSI;
|FPRC;

|PROCESO Defecto; |TIPO 7;
     |SI #0#4 = 0;
          fHoy = ~;
          aAlfa = fHoy % 704; #0#4 = aAlfa; |PINTA #0#4;
          aAlfa = fHoy % 704; #0#5 = aAlfa; |PINTA #0#5;
          aAlfa = fHoy % 402; #0#6 = aAlfa; |PINTA #0#6;
          aAlfa = fHoy % 402; #0#7 = aAlfa; |PINTA #0#7;
     |FINSI;
|FPRC;

|PROCESO UltDiaMes;
     |PARA f = efHFecha; |SI; |HACIENDO f = f + 1;
          aAlfa = f % 402;
          |SI aAlfa ! #0#7; |SAL; |FINSI;
          efHFecha = f;
     |SIGUE;
|FPRC;

|PROCESO NomMes;
     |SI i = 1; aAlfa = "     ENERO"; |FINSI;
     |SI i = 2; aAlfa = "   FEBRERO"; |FINSI;
     |SI i = 3; aAlfa = "     MARZO"; |FINSI;
     |SI i = 4; aAlfa = "     ABRIL"; |FINSI;
     |SI i = 5; aAlfa = "      MAYO"; |FINSI;
     |SI i = 6; aAlfa = "     JUNIO"; |FINSI;
     |SI i = 7; aAlfa = "     JULIO"; |FINSI;
     |SI i = 8; aAlfa = "    AGOSTO"; |FINSI;
     |SI i = 9; aAlfa = "SEPTIEMBRE"; |FINSI;
     |SI i = 10; aAlfa = "   OCTUBRE"; |FINSI;
     |SI i = 11; aAlfa = " NOVIEMBRE"; |FINSI;
     |SI i = 12; aAlfa = " DICIEMBRE"; |FINSI;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |SI nSwAcaba = 1;
          |ACABA;
     |FINSI;

     nCampo = 9;
     |SI #0#4 = #0#5;
          |PARA i = #0#6; |SI i [ #0#7; |HACIENDO i = i + 1;
               |HAZ NomMes;
               #0nCampo = aAlfa;
               nCampo = nCampo + 1;
          |SIGUE;
     |SINO;
          |PARA i = #0#6; |SI i [ 12; |HACIENDO i = i + 1;
               |HAZ NomMes;
               #0nCampo = aAlfa;
               nCampo = nCampo + 1;
          |SIGUE;
          |PARA i = 1; |SI i [ #0#7; |HACIENDO i = i + 1;
               |HAZ NomMes;
               #0nCampo = aAlfa;
               nCampo = nCampo + 1;
          |SIGUE;
     |FINSI;

     aAlfa = Usuario;
     |IMPRE 0;
     |SI FSalida = 0;
          aAlfa = "01." + (("00" + #0#6) % -102) + ".";
          aAlfa = aAlfa + (("0000" + #0#4) % -104);
          efDFecha = aAlfa;
          aAlfa = "01." + (("00" + #0#7) % -102) + ".";
          aAlfa = aAlfa + (("0000" + #0#5) % -104);
          efHFecha = aAlfa;
          |HAZ UltDiaMes;

          |ABRE #17;
          |SI #0#8 = "R";
               |INFOR "aparz0r9";
               |SI FSalida = 0;
                    aAlfa = Usuario; |NOME_DAT #7 aAlfa; |DELINDEX #7;
                    |ABRE #7;
                    |BUCLE KmDiaR;
                    |CIERRA #7;
                    |BUCLE TmpR;
                    |PIEINF;
                    |FININF;
                    |DELINDEX #7;
               |SINO;
                    aAlfa = "0000Error en informe 'aparz0r9'";
                    |MENAV aAlfa;
               |FINSI;
          |SINO;
               |INFOR "aparz0d9";
               |SI FSalida = 0;
                    |BUCLE KmDiaD;
                    |PIEINF;
                    |FININF;
               |SINO;
                    aAlfa = "0000Error en informe 'aparz0d9'";
                    |MENAV aAlfa;
               |FINSI;
          |FINSI;
          |CIERRA #17;

          |FINIMP;
     |FINSI;
|FPRC,
