|FICHEROS;
     agifa007;
     agifa140;
     agifa142;
     agifa024;
     agifa112;
     dsm00003;

     canempre@;
     caclipro@;
     gadm0005@;
|FIN;

|VARIABLES;
     nAnyo               = 0;
     nConta              = 0;
     nOk                 = 0;

     aAlfa               = "";
     aEmpr               = "";
     aPer                = "";
     aPathConta          = "";
     aMas                = "";
     aFic                = "";
     aAnyo               = "";
     aCod                = "";
     aCodCli             = "";
     aCodPro             = "";
     aCtaCble            = "";
     aPassword           = "";

     fFechaSys           = @;
|FIN;

|PROCESO agifa024Bus;
     aCodCli = #agifa024#0;
     |ERROR10;
|FPRC;

|DEFBUCLE agifa024Bus;
     #agifa024#1;
     16;
     "      ", aCtaCble;
     "zzzzzz", aCtaCble;
     ;
     NULL, agifa024Bus;
|FIN;

|PROCESO agifa024C;
     aCodCli  = "";
     aCtaCble = #caclipro@#10;
     |BUCLE agifa024Bus;

     |SI aCodCli ! "";
         |SI #agifa140#4 = "S";
             |ACABA;
         |FINSI;
     |FINSI;

     |SELECT #1#agifa024;
     |SI aCodCli = "";
         aCod = #caclipro@#10 - "43"; |QBT aCod;
         aCod = ("000000" + aCod) % -106;

         #agifa024#0 = aCod;
         |LEE 000#agifa024.=;
         |SI FSalida ! 0;
             aCodCli = aCod;
         |FINSI;
     |FINSI;

     |SI aCodCli = "";
         |PARA nConta = 1;  |SI nConta [ 999999;  |HACIENDO nConta = nConta + 1;
               aCodCli = ("000000" + nConta) % -106;

               #agifa024#0 = aCodCli;
               |LEE 000#agifa024.=;
               |SI FSalida ! 0;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |PINTA 2249, "              ";
     |PINTA 2249, aCtaCble;

     #agifa024#0 = aCodCli;
     |LEE 101#agifa024.=;
     |SI FSalida ! 0;
         |DDEFECTO #agifa024;

         #agifa024#0 = aCodCli;
         |GRABA 020#agifa024.b;
     |FINSI;

     #agifa024#1   = #caclipro@#1;
     #agifa024#8   = #caclipro@#2;
     #agifa024#181 = #caclipro@#3;
     #agifa024#182 = #caclipro@#4;
     #agifa024#10  = #caclipro@#5;
     #agifa024#9   = #caclipro@#6;
     #agifa024#17  = #caclipro@#7;
     #agifa024#18  = #caclipro@#8;
     #agifa024#15  = #caclipro@#9;
     #agifa024#16  = #caclipro@#10;
     #agifa024#29  = #caclipro@#13;
     #agifa024#34  = #caclipro@#14;
     #agifa024#30  = #caclipro@#17;
     #agifa024#162 = #caclipro@#19;
     #agifa024#20  = #caclipro@#20;
     #agifa024#183 = #caclipro@#25;
     #agifa024#205 = #caclipro@#24;
     #agifa024#203 = #caclipro@#28;
     #agifa024#32  = #caclipro@#29;
     #agifa024#33  = #caclipro@#30;
     #agifa024#31  = #caclipro@#31;
     #agifa024#30  = #caclipro@#32;
     #agifa024#3   = #caclipro@#33;
     #agifa024#22  = #caclipro@#34;
     #agifa024#23  = #caclipro@#35;
     #agifa024#24  = #caclipro@#36;
     #agifa024#215 = #caclipro@#40;
     #agifa024#216 = #caclipro@#41;
     #agifa024#11  = #caclipro@#44;
     #agifa024#184 = #caclipro@#45;
     #agifa024#185 = #caclipro@#46;
     #agifa024#13  = #caclipro@#47;
     #agifa024#12  = #caclipro@#48;
     #agifa024#27  = #caclipro@#49;
     #agifa024#186 = #caclipro@#50;
     #agifa024#197 = #caclipro@#51;

     #agifa024#8   = #caclipro@#2;
     #agifa024#181 = #caclipro@#3;
     #agifa024#182 = #caclipro@#4;
     #agifa024#10  = #caclipro@#5;
     #agifa024#9   = #caclipro@#6;

     aAlfa = #agifa024#5;  |QBF aAlfa;
     |SI aAlfa = "";
         #agifa024#5   = #agifa024#8;
         #agifa024#178 = #agifa024#181;
         #agifa024#179 = #agifa024#182;
         #agifa024#7   = #agifa024#10;
         #agifa024#6   = #agifa024#9;
     |FINSI;

     aAlfa = #agifa024#11;  |QBF aAlfa;
     |SI aAlfa = "";
         #agifa024#11  = #agifa024#8;
         #agifa024#184 = #agifa024#181;
         #agifa024#185 = #agifa024#182;
         #agifa024#13  = #agifa024#10;
         #agifa024#12  = #agifa024#9;
     |FINSI;

     |GRABA 020#agifa024.a;
     |LIBERA #agifa024;

     #dsm00003#0 = #agifa024#0;
     #dsm00003#1 = 1;
     |LEE 101#dsm00003.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsm00003;
         #dsm00003#0 = #agifa024#0;
         #dsm00003#1 = 1;
         |GRABA 020#dsm00003.b;
     |FINSI;

     #agifa024#180 = (("00" + #agifa024#178) % -102) + (("000" + #agifa024#179) % -103);

     #dsm00003#2  = #agifa024#5;
     #dsm00003#3  = #agifa024#6;
     #dsm00003#4  = #agifa024#178;
     #dsm00003#5  = #agifa024#179;
     #dsm00003#6  = #agifa024#180;
     #dsm00003#7  = #agifa024#7;
     #dsm00003#8  = #agifa024#14;
     #dsm00003#10 = #agifa024#2;
     #dsm00003#11 = #agifa024#3;
     #dsm00003#13 = #agifa024#17;
     #dsm00003#14 = #agifa024#25;
     #dsm00003#16 = #agifa024#189;
     #dsm00003#19 = #agifa024#205;
     #dsm00003#20 = #agifa024#196;
     #dsm00003#21 = #agifa024#18;
     #dsm00003#22 = #agifa024#36;
     #dsm00003#23 = #agifa024#211;
     #dsm00003#24 = #agifa024#197;

     |GRABA 020#dsm00003.a;
     |LIBERA #dsm00003;
|FPRC;

|PROCESO agifa112Bus;
     aCodPro = #agifa112#0;
     |ERROR10;
|FPRC;

|DEFBUCLE agifa112Bus;
     #agifa112#1;
     10;
     "      ", aCtaCble;
     "zzzzzz", aCtaCble;
     ;
     NULL, agifa112Bus;
|FIN;

|PROCESO agifa112C;
     aCodPro  = "";
     aCtaCble = #caclipro@#10;
     |BUCLE agifa112Bus;

     |SI aCodPro = "";
         |SELECT #6#agifa112;
         #agifa112#9  = #caclipro@#9;
         |LEE 000#agifa112.=;
         |SI FSalida = 0;
             aCodPro = #agifa112#0;
         |FINSI;
     |FINSI;

     |SI aCodPro ! "";
         |SI #agifa140#4 = "S";
             |ACABA;
         |FINSI;
     |FINSI;

     |SELECT #1#agifa112;
     |SI aCodPro = "";
         aCod = #caclipro@#10 - "40"; |QBT aCod;
         aCod = ("000000" + aCod) % -106;

         #agifa112#0 = aCod;
         |LEE 000#agifa112.=;
         |SI FSalida ! 0;
             aCodPro = aCod;
         |FINSI;
     |FINSI;

     |SI aCodPro = "";
         |PARA nConta = 1;  |SI nConta [ 999999;  |HACIENDO nConta = nConta + 1;
               aCodPro = ("000000" + nConta) % -106;

               #agifa112#0 = aCodPro;
               |LEE 000#agifa112.=;
               |SI FSalida ! 0;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |PINTA 2249, "              ";
     |PINTA 2249, aCtaCble;

     #agifa112#0 = aCodPro;
     |LEE 101#agifa112.=;
     |SI FSalida ! 0;
         |DDEFECTO #agifa112;

         #agifa112#0 = aCodPro;
         |GRABA 020#agifa112.b;
     |FINSI;

     #agifa112#10  = #caclipro@#10;
     #agifa112#1   = #caclipro@#1;
     #agifa112#3   = #caclipro@#2;
     #agifa112#74  = #caclipro@#3;
     #agifa112#75  = #caclipro@#4;
     #agifa112#76  = #caclipro@#25;
     #agifa112#89  = #caclipro@#24;
     #agifa112#5   = #caclipro@#5;
     #agifa112#4   = #caclipro@#6;
     #agifa112#6   = #caclipro@#7;
     #agifa112#7   = #caclipro@#8;
     #agifa112#9   = #caclipro@#9;
     #agifa112#11  = #caclipro@#13;
     #agifa112#16  = #caclipro@#14;
     #agifa112#12  = #caclipro@#17;
     #agifa112#57  = #caclipro@#19;
     #agifa112#17  = #caclipro@#20;
     #agifa112#98  = #caclipro@#28;
     #agifa112#14  = #caclipro@#29;
     #agifa112#15  = #caclipro@#30;
     #agifa112#13  = #caclipro@#31;
     #agifa112#12  = #caclipro@#32;
     #agifa112#92  = #caclipro@#33;
     #agifa112#19  = #caclipro@#34;
     #agifa112#20  = #caclipro@#35;
     #agifa112#21  = #caclipro@#36;
     #agifa112#99  = #caclipro@#37;
     #agifa112#94  = #caclipro@#38;
     #agifa112#95  = #caclipro@#39;
     #agifa112#96  = #caclipro@#40;
     #agifa112#97  = #caclipro@#41;
     #agifa112#101 = #caclipro@#44;
     #agifa112#102 = #caclipro@#45;
     #agifa112#103 = #caclipro@#46;
     #agifa112#104 = #caclipro@#47;
     #agifa112#105 = #caclipro@#48;
     #agifa112#106 = #caclipro@#49;
     #agifa112#107 = #caclipro@#50;

     |GRABA 020#agifa112.a;
     |LIBERA #agifa112;
|FPRC;

|PROCESO cacliproC;
     aAlfa = #caclipro@#10 % 102;

     nOk = 0;
     |SI aAlfa = "43";  nOk = 1;  |FINSI;
     |SI aAlfa = "40";  nOk = 1;  |FINSI;

     |SI nOk = 0;
         |ACABA;
     |FINSI;

     |SI #caclipro@#23 = "C";
         |HAZ agifa024C;
     |FINSI;

     |SI #caclipro@#23 = "P";
         |HAZ agifa112C;
     |FINSI;
|FPRC;

|DEFBUCLE cacliproC;
     #caclipro@#1002;
     ;
     " ", "            ";
     "z", "zzzzzzzzzzzz";
     ;
     NULL, cacliproC;
|FIN;

|PROCESO agifa024A;
     aCodCli  = "";
     aCtaCble = #caclipro@#10;
     |BUCLE agifa024Bus;

     |SI aCodCli = "";
         |SELECT #4#agifa024;
         #agifa024#15 = #caclipro@#9;
         |LEE 000#agifa024.=;
         |SI FSalida = 0;
             aCodCli = #agifa024#0;
         |FINSI;
     |FINSI;

     |SI aCodCli ! "";
         |SI #agifa140#4 = "S";
             |ACABA;
         |FINSI;
     |FINSI;

     |SELECT #1#agifa024;
     |SI aCodCli = "";
         aCod = #caclipro@#10 - "43"; |QBT aCod;
         aCod = ("000000" + aCod) % -106;

         #agifa024#0 = aCod;
         |LEE 000#agifa024.=;
         |SI FSalida ! 0;
             aCodCli = aCod;
         |FINSI;
     |FINSI;

     |SI aCodCli = "";
         |PARA nConta = 1;  |SI nConta [ 999999;  |HACIENDO nConta = nConta + 1;
               aCodCli = ("000000" + nConta) % -106;

               #agifa024#0 = aCodCli;
               |LEE 000#agifa024.=;
               |SI FSalida ! 0;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |PINTA 2249, "              ";
     |PINTA 2249, aCtaCble;

     #agifa024#0 = aCodCli;
     |LEE 101#agifa024.=;
     |SI FSalida ! 0;
         |DDEFECTO #agifa024;

         #agifa024#0 = aCodCli;
         |GRABA 020#agifa024.b;
     |FINSI;

     #agifa024#1   = #caclipro@#1;
     #agifa024#8   = #caclipro@#2;
     #agifa024#181 = #caclipro@#3;
     #agifa024#182 = #caclipro@#4;
     #agifa024#10  = #caclipro@#5;
     #agifa024#9   = #caclipro@#6;
     #agifa024#17  = #caclipro@#7;
     #agifa024#18  = #caclipro@#8;
     #agifa024#15  = #caclipro@#9;
     #agifa024#16  = #caclipro@#10;
     #agifa024#29  = #caclipro@#13;
     #agifa024#34  = #caclipro@#14;
     #agifa024#30  = #caclipro@#17;
     #agifa024#162 = #caclipro@#19;
     #agifa024#20  = #caclipro@#20;
     #agifa024#183 = #caclipro@#25;
     #agifa024#205 = #caclipro@#24;
     #agifa024#203 = #caclipro@#28;
     #agifa024#32  = #caclipro@#30 % 504;
     #agifa024#33  = #caclipro@#30 % 904;
     #agifa024#31  = #caclipro@#30 % 1302;
     #agifa024#30  = #caclipro@#30 % 1510;
     #agifa024#215 = #caclipro@#30;
     #agifa024#216 = #caclipro@#29;

     #agifa024#8   = #caclipro@#2;
     #agifa024#181 = #caclipro@#3;
     #agifa024#182 = #caclipro@#4;
     #agifa024#10  = #caclipro@#5;
     #agifa024#9   = #caclipro@#6;

     aAlfa = #agifa024#5;  |QBF aAlfa;
     |SI aAlfa = "";
         #agifa024#5   = #agifa024#8;
         #agifa024#178 = #agifa024#181;
         #agifa024#179 = #agifa024#182;
         #agifa024#7   = #agifa024#10;
         #agifa024#6   = #agifa024#9;
     |FINSI;

     aAlfa = #agifa024#11;  |QBF aAlfa;
     |SI aAlfa = "";
         #agifa024#11  = #agifa024#8;
         #agifa024#184 = #agifa024#181;
         #agifa024#185 = #agifa024#182;
         #agifa024#13  = #agifa024#10;
         #agifa024#12  = #agifa024#9;
     |FINSI;

     |GRABA 020#agifa024.a;
     |LIBERA #agifa024;

     #dsm00003#0 = #agifa024#0;
     #dsm00003#1 = 1;
     |LEE 101#dsm00003.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsm00003;
         #dsm00003#0 = #agifa024#0;
         #dsm00003#1 = 1;
         |GRABA 020#dsm00003.b;
     |FINSI;

     #dsm00003#2  = #agifa024#5;
     #dsm00003#3  = #agifa024#6;
     #dsm00003#4  = #agifa024#178;
     #dsm00003#5  = #agifa024#179;
     #dsm00003#6  = #agifa024#180;
     #dsm00003#7  = #agifa024#7;
     #dsm00003#8  = #agifa024#14;
     #dsm00003#10 = #agifa024#2;
     #dsm00003#11 = #agifa024#3;
     #dsm00003#13 = #agifa024#17;
     #dsm00003#14 = #agifa024#25;
     #dsm00003#16 = #agifa024#189;
     #dsm00003#19 = #agifa024#205;
     #dsm00003#20 = #agifa024#196;
     #dsm00003#21 = #agifa024#18;
     #dsm00003#22 = #agifa024#36;
     #dsm00003#23 = #agifa024#211;
     #dsm00003#24 = #agifa024#197;

     |GRABA 020#dsm00003.a;
     |LIBERA #dsm00003;
|FPRC;

|PROCESO agifa112A;
     aCodPro  = "";
     aCtaCble = #caclipro@#10;
     |BUCLE agifa112Bus;

     |SI aCodPro = "";
         |SELECT #6#agifa112;
         #agifa112#9  = #caclipro@#9;
         |LEE 000#agifa112.=;
         |SI FSalida = 0;
             aCodPro = #agifa112#0;
         |FINSI;
     |FINSI;

     |SI aCodPro ! "";
         |SI #agifa140#4 = "S";
             |ACABA;
         |FINSI;
     |FINSI;

     |SELECT #1#agifa112;
     |SI aCodPro = "";
         aCod = #caclipro@#10 - "40"; |QBT aCod;
         aCod = ("000000" + aCod) % -106;

         #agifa112#0 = aCod;
         |LEE 000#agifa112.=;
         |SI FSalida ! 0;
             aCodPro = aCod;
         |FINSI;
     |FINSI;

     |SI aCodPro = "";
         |PARA nConta = 1;  |SI nConta [ 999999;  |HACIENDO nConta = nConta + 1;
               aCodPro = ("000000" + nConta) % -106;

               #agifa112#0 = aCodPro;
               |LEE 000#agifa112.=;
               |SI FSalida ! 0;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |PINTA 2249, "              ";
     |PINTA 2249, aCtaCble;

     #agifa112#0 = aCodPro;
     |LEE 101#agifa112.=;
     |SI FSalida ! 0;
         |DDEFECTO #agifa112;

         #agifa112#0 = aCodPro;
         |GRABA 020#agifa112.b;
     |FINSI;

     #agifa112#10  = #caclipro@#10;
     #agifa112#1   = #caclipro@#1;
     #agifa112#3   = #caclipro@#2;
     #agifa112#74  = #caclipro@#3;
     #agifa112#75  = #caclipro@#4;
     #agifa112#76  = #caclipro@#25;
     #agifa112#89  = #caclipro@#24;
     #agifa112#5   = #caclipro@#5;
     #agifa112#4   = #caclipro@#6;
     #agifa112#6   = #caclipro@#7;
     #agifa112#7   = #caclipro@#8;
     #agifa112#9   = #caclipro@#9;
     #agifa112#11  = #caclipro@#13;
     #agifa112#16  = #caclipro@#14;
     #agifa112#12  = #caclipro@#17;
     #agifa112#57  = #caclipro@#19;
     #agifa112#17  = #caclipro@#20;
     #agifa112#98  = #caclipro@#28;

     #agifa112#14  = #caclipro@#30 % 504;
     #agifa112#15  = #caclipro@#30 % 904;
     #agifa112#13  = #caclipro@#30 % 1302;
     #agifa112#12  = #caclipro@#30 % 1510;
     #agifa112#96  = #caclipro@#30;
     #agifa112#97  = #caclipro@#29;

     |GRABA 020#agifa112.a;
     |LIBERA #agifa112;
|FPRC;

|PROCESO cacliproA;
     aAlfa = #caclipro@#10 % 102;

     nOk = 0;
     |SI aAlfa = "43";  nOk = 1;  |FINSI;
     |SI aAlfa = "40";  nOk = 1;  |FINSI;

     |SI nOk = 0;
         |ACABA;
     |FINSI;

     |SI #caclipro@#23 = "C";
         |HAZ agifa024A;
     |FINSI;

     |SI #caclipro@#23 = "P";
         |HAZ agifa112A;
     |FINSI;
|FPRC;

|DEFBUCLE cacliproA;
     #caclipro@#1003;
     ;
     " ", "            ", 0;
     "z", "zzzzzzzzzzzz", 9;
     ;
     NULL, cacliproA;
|FIN;

|PROCESO ImportaCuentas;
     aMas = aPathConta + "def/caclipro.mas";
     |CARGA_DEF aMas, caclipro@;

     aFic = aPathConta + "fich/" + (("00000" + #agifa140#2) % -105) + #agifa140#3 + "/";
     |PATH_DAT #caclipro@#aFic#;

     |ABRE #agifa024;
     |ABRE #agifa112;
     |ABRE #dsm00003;

     |SI #agifa140#0 = "C";
         |BUCLE cacliproC;
     |FINSI;

     |SI #agifa140#0 = "A";
         |BUCLE cacliproA;
     |FINSI;

     |CIERRA #agifa024;
     |CIERRA #agifa112;
     |CIERRA #dsm00003;

     |DESCARGA_DEF #caclipro@;
|FPRC;

|PROCESO gadm0005;
     #agifa007#26 = #gadm0005@#1;
     |LEE 101#agifa007.=;
     |SI FSalida = 0;
         |SI #agifa140#5 = "S";
             |LIBERA #agifa007;
             |ACABA;
         |FINSI;
     |SINO;
         |DDEFECTO #agifa007;

         #agifa007#26 = #gadm0005@#1;
         |GRABA 020#agifa007.b;
     |FINSI;

     #agifa007#27 = #gadm0005@#2;
     |GRABA 020#agifa007.a;
     |LIBERA #agifa007;
|FPRC;

|DEFBUCLE gadm0005;
     #gadm0005@#1002;
     ;
     00, "     ";
     99, "zzzzz";
     ;
     NULL, gadm0005;
|FIN;

|PROCESO ImportaSeries;
     aMas = aPathConta + "def/gadm0005.mas";
     |CARGA_DEF aMas, gadm0005@;

     aFic = aPathConta + "fich/" + (("00000" + #agifa140#2) % -105) + #agifa140#3 + "/";
     |PATH_DAT #gadm0005@#aFic#;

     |ABRE #agifa007;
     |BUCLE gadm0005;
     |CIERRA #agifa007;

     |DESCARGA_DEF #gadm0005@;
|FPRC;

|PROCESO T12;  |TIPO 12;
     |SI FSalida = 7;
         |ACABA;
     |FINSI;

     |CONFI "0000NImportamos los datos a la gestion comercial";
     |SI FSalida ! 0;
         |ACABA;
     |FINSI;

     |SI #agifa140#4 ! "N";
         |HAZ ImportaCuentas;
     |FINSI;

     |SI #agifa140#5 ! "N";
         |HAZ ImportaSeries;
     |FINSI;
|FPRC;

|PROCESO T0C3;  |TIPO 0;
     |ABRE #canempre@;
     |SELECT #1#canempre@;
     #canempre@#2  = #agifa140#2;
     #canempre@#3  = #agifa140#3;
     |LEE 000#canempre@.=;
     |SI FSalida ! 0;
         |MENAV "0000Acceso contabilidad inexistente.";
         |ERROR;
     |FINSI;
     |CIERRA #canempre@;
|FPRC;

|PROCESO BuscaPerContagen;
     |ABRE #canempre@;
     |SELECT #4#canempre@;
     #canempre@#2  = #agifa140#2;
     #canempre@#26 = nAnyo;
     |LEE 000#canempre@.=;
     |SI FSalida = 0;
         #agifa140#3 = #canempre@#3;

         |PINTA #agifa140#3;
     |FINSI;
     |CIERRA #canempre@;
|FPRC;

|PROCESO canempreA;
     #agifa140#3 = #canempre@#3;

     |ERROR10;
|FPRC;

|DEFBUCLE canempreA;
     #canempre@#1002;
     26;
     #agifa140#2, 0, nAnyo;
     #agifa140#2, 9, nAnyo;
     ;
     NULL, canempreA;
|FIN;

|PROCESO BuscaPerAgicont;
     |BUCLE canempreA;
|FPRC;

|PROCESO T7C3;  |TIPO 7;
     |SI #agifa140#0 = "C";
         |HAZ BuscaPerContagen;
     |FINSI;

     |SI #agifa140#0 = "A";
         |HAZ BuscaPerAgicont;
     |FINSI;
|FPRC;

|PROGRAMA;
     |CUADRO 0501 2380;
     |BLANCO 0602 2279;
     |PINTA 1320, "Introduzca Password : ";
     E_inf = "";
     E_sup = "20";
     aPassword = 1342 ? -1;
     |SI aPassword ! "<MYPASWD>     ";
         |MENAV "     Permiso denegado.";
         |ACABA;
     |FINSI;

     fFechaSys = ~;
     aAnyo     = fFechaSys % -102;
     nAnyo     = aAnyo;

     |ABRE #agifa142;
     |LEE 000#agifa142.p;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #agifa142;

     aAlfa = #agifa142#151;  |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000Rellene los Controles Contables en Parametros Generales";
         |ACABA;
     |FINSI;

     |DDEFECTO #agifa140;
     #agifa140#0 = "C";

     aAlfa = #agifa142#151 < "";
     aAlfa = aAlfa - "agicont";
     |SI FSalida ! 0;
         #agifa140#0 = "A";
     |FINSI;

     |C_M #agifa140#5, 1, "S";
     |SI #agifa140#0 = "A";
         |C_M #agifa140#5, 1, "N"; #agifa140#5 = "N";
     |FINSI;

     aAlfa = ("000000" + #agifa142#152) % -106;
     aEmpr = aAlfa % 105;
     aPer  = aAlfa % 601;

     |C_M #agifa140#2, 1, "N";

     #agifa140#1 = #agifa142#151;
     #agifa140#2 = #48#0;
     #agifa140#3 = aPer;

     |SI #agifa142#182 = "S";
         |C_M #agifa140#2, 1, "S";

         #agifa140#2 = aEmpr;
         #agifa140#3 = aPer;
     |FINSI;

     aPathConta = #agifa140#1;  |QBF aPathConta;

     aMas = aPathConta + "def/canempre.mas";
     |CARGA_DEF aMas, canempre@;

     aFic = aPathConta + "fich/";
     |PATH_DAT #canempre@#aFic#;

     |PINPA #0#agifa140;
     |PINDA #0#agifa140;
     |ENDATOS #1#agifa140;

     |DESCARGA_DEF #canempre@;
|FPRO;
