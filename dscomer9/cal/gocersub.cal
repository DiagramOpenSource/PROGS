|FICHEROS;
     gocersub #0;       ||Este Def.
     gocersul #1;       ||
     gocersuh #2,MANTE; ||
     gosubpar #3;       ||
|FIN;

|VARIABLES;
     nPen = 0;
     nMod = 0;
     nSal = 0;
     &cCodMonBase   = "";
     &cDesMonBase   = "";
     &cCodMonTrab   = "";
     &cDesMonTrab   = "";
     &nDeci_PBase   = 0;
     &nDeci_TBase   = 0;
     &nDeci_PTrab   = 0;
     &nDeci_TTrab   = 0;
     &nDeci_TotVis  = 0;
     &nEurComTrab   = 0;
     &nEurComBase   = 0;
     &nEurVenTrab   = 0;
     &nEurVenBase   = 0;
|FIN;

|PROCESO gosubpar;
     nPen = #3#5 - #3#9;
     |SI nPen [ 0; |ACABA; |FINSI;
     |DDEFECTO #2;
     #2#0  = #3#0;
     #2#11 = #1#1;
     #2#1  = #3#1;
     #2#2  = #3#2;
     |LEE 101#2=;
     nSal  = FSalida;
     #2#0  = #3#0;
     #2#11 = #1#1;
     #2#1  = #3#1;
     #2#2  = #3#2;
     #2#3  = #3#3;
     #2#4  = #3#4;
     #2#5  = #3#5;
     #2#6  = #3#6;
     #2#7  = #3#7;
     #2#8  = #3#8;
     #2#12 = #3#10;
     #2#13 = #3#11;
     |SI nSal = 0; |GRABA 020#2a; |FINSI;
     |SI nSal ! 0; |GRABA 020#2n; |FINSI;
     |LIBERA #2;
|FPRC;

|DEFBUCLE gosubpar;
     #3#1;
     ;
     #0#0,"                    ",  1;
     #0#0,"zzzzzzzzzzzzzzzzzzzz",999;
     ;
     NULL,gosubpar;
|FIN;

|PROCESO entrapar; |TIPO 0;
     nMod = (FEntrada / 100) ! 0;
     |SI nMod = 1;
          |ABRE #2;
          |BUCLE gosubpar;
          |CIERRA #2;
     |FINSI;
     |ENTLINEAL #1#2 , -4 , nMod , 22 , 0 , inf , sup;
|FPRC;

|PROCESO verpan; |TIPO 13;
     |ENTLINEAL #1#2 , -4 , 7 , 22 , 0 , inf , sup;
|FPRC;

|RUTINA inf;
     #2#0  = #0#0;
     #2#11 = #1#1;
     #2#1  = "                   ";
     #2#2  = 1;
|FRUT;

|RUTINA sup;
     #2#0  = #0#0;
     #2#11 = #1#1;
     #2#1  = "zzzzzzzzzzzzzzzzzzz";
     #2#2  = 999;
|FRUT;

|PROCESO tipo11; |TIPO 7;
     |ABRE #3;
     #3#0 = #2#0;
     #3#1 = #2#1;
     #3#2 = #2#2;
     |LEE 000#3=;
     |SI FSalida = 0;
          #2#10 = #3#5 - #3#9;
     |SINO;
          #2#10 = 0;
     |FINSI;
     |PINTA 1068 , #2#10;
     |CIERRA #3;
|FPRC;

|PROCESO gocerbuh;
     #1#4 = #1#4 +. (#2#9 * #2#7);                ||Importe Coste.
     #1#5 = #1#5 +. (#2#9 * #2#12);               ||Importe Venta.
     |SI nMod = 3;
          |BORRA 020#2a;
          |ABRE #3;
          #3#0 = #2#0;
          #3#1 = #2#1;
          #3#2 = #2#2;
          |LEE 101#3=;
          |SI FSalida = 0;
               #3#9 = #3#9 - #2#9;
               |GRABA 020#3a;
          |FINSI;
          |LIBERA #3;
          |CIERRA #3;
     |FINSI;
|FPRC;

|DEFBUCLE gocerbuh;
     #2#1;
     ;
     #0#0,#1#1,"                    ",  1;
     #0#0,#1#1,"zzzzzzzzzzzzzzzzzzzz",999;
     ;
     NULL,gocerbuh;
|FIN;

|PROCESO tipo2;  |TIPO 2;
     nMod = (FEntrada / 100) ! 0;
     #1#4 = 0;
     |BUCLE gocerbuh;
|FPRC;

|PROCESO tipo22; |TIPO 2;
     |ABRE #3;
     #3#0 = #2#0;
     #3#1 = #2#1;
     #3#2 = #2#2;
     |LEE 101#3=;
     |SI FSalida = 0;
          #3#9 = #3#9 +. #2#9;
          |GRABA 020#3a;
     |FINSI;
     |LIBERA #3;
     |CIERRA #3;
|FPRC;

|PROCESO control; |TIPO 0;
     nPen = #2#5 - (#2#10 + #2#9);
     |SI nPen < 0;
          |ERROR;
          |ACABA;
     |FINSI;
|FPRC;
