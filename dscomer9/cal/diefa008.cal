/*
Cabfac.txt un registro por factura.
Dtofac.txt un registro por factura que tenga descuento pronto pago.
Impfac.txt un registro por factura.
Linfac.txt tantos registros como lineas de albaran incluya la factura.
Dtolfac.txt tantos registros como lineas de albaran tengan descuento.
*/
|FICHEROS;
     diefa008 #0;
     agifa134 #1;
     diefa009 #2;
     diefa010 #3;
     agifa010 #4;
     agifa059 #5;
     agifa024 #6;
     agifa071 #71;
     agifa133 #133;
     agifa019 #19;
|FIN;

|VARIABLES;
     &enTiva = 0;
     &efFiva = @;
     &eaDiva = "";
     &enIva = 0;
     &enRec = 0;
     nConta    = 0;
 {10}a         = 0;
 {10}b         = 0;
 {10}c         = 0;
 {10}d         = "";
     aVto      = "";
     nLin      = 0;
     nNume     = 0;
     nHandle   = 0;
     nDec      = 0;
     aFinReg   = "";
     nSw       = 0;
     i         = 0;
     aFic      = "";
     aPath     = "";
     nHanCab   = 0;
     nHanDto   = 0;
     nHanImp   = 0;
     nHanLin   = 0;
     nHanDtol  = 0;
     nAbre1    = 0;
     nAbre2    = 0;
     nAbre3    = 0;
     nAbre4    = 0;
     nAbre5    = 0;
     aTipo     = "";
     nLon      = 0;
     aAlfa     = "";
     nVto      = 0;
     nNu1      = 0;
     nNu2      = 0;
     nPos      = 0;
|FIN;

|PROCESO Relleno;
     |SI aTipo = "A";
          aAlfa = aAlfa + "                                             ";
          nPos = nLon + 100;
          aAlfa = aAlfa % nPos;
     |SINO;
          |SI nNume < 0; nNume = nNume * - 1; |FINSI;
          nNu1 = nNume ! 0;
          |SI nNu1 > nNume; nNu1 = nNu1 - 1; |FINSI;
          nNu2 = nNume - nNu1;
          |SI nDec = 0;
               aAlfa = nNu1;
          |SINO;
               aAlfa = nNu2;
               aAlfa = aAlfa + "00000000000000000000000000";
               nPos = nDec + 300;
               aAlfa = aAlfa % nPos;
               aAlfa = nNu1 + "." + aAlfa;
          |FINSI;
          aAlfa = "000000000000000000000000000000000000000000000" + aAlfa;
          nPos = -1 * (nLon + 100);
          aAlfa = aAlfa % nPos;
     |FINSI;
     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO Vto;
     |DDEFECTO #133;
     #133#4 = #1#49;
     #133#0 = #1#0;
     #133#1 = nVto;
     |LEE 000#133=;
     |SI FSalida = 0; |Y #133#2 ! 0;
          aVto = #133#3;
     |SINO;
          aVto = "                           ";
     |FINSI;
|FPRC;

|PROCESO DtolFac;
     nConta = 0;
     nHandle = nAbre5;

     |SI #71#8 ! 0;
          nConta = nConta + 1;
||NUMFAC:X15
          aAlfa = #1#0;
          aTipo = "A"; nLon = 15; |HAZ Relleno;
||NUMLIN
          nNume = nLin;
          aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;
||NUMDTO
          nNume = nConta;
          aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;
||CALIF
          aAlfa = "A";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUE
          nNume = nConta;
          aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO
          aAlfa = "TD";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN
          nNume = #71#8;
          aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDES
          nNume = #71#5 * #71#36 * #71#8 / 100;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

          |XGRABA nHandle, aFinReg;
     |FINSI;
     |SI #71#33 ! 0;
          nConta = nConta + 1;
||NUMFAC:X15
          aAlfa = #1#0;
          aTipo = "A"; nLon = 15; |HAZ Relleno;
||NUMLIN
          nNume = nLin;
          aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;
||NUMDTO
          nNume = nConta;
          aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;
||CALIF
          aAlfa = "A";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUE
          nNume = nConta;
          aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO
          aAlfa = "TD";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN
          nNume = #71#33;
          aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDES
          nNume = (#71#5 * #71#36 * #71#8)  / 100;
          nNume = ((#71#5 * #71#36) - nNume) * #71#33 / 100;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

          |XGRABA nHandle, aFinReg;
     |FINSI;
|FPRC;

|PROCESO LinFac;
     nHandle = nAbre4;
     nLin = nLin + 1;

     #19#0 = #71#2;
     |LEE 020#19=;

     enTiva = #71#11;
     efFiva = #4#1;
     |HAZ SacaIVA;

     |SI #19#115 = 0; |ACABA; |FINSI;

||NUMFAC:X15
     aAlfa = #1#0;
     aTipo = "A"; nLon = 15; |HAZ Relleno;
||NUMLIN
     nNume = nLin;
     aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;
||REFEAN
     aAlfa = #19#115;
     aTipo = "A"; nLon = 17; |HAZ Relleno;
||REFCLI
     aAlfa = ""; aTipo = "A"; nLon = 35; |HAZ Relleno;
||REFPRO
     aAlfa = ""; aTipo = "A"; nLon = 35; |HAZ Relleno;
||VP
     aAlfa = ""; aTipo = "A"; nLon = 2; |HAZ Relleno;
||DUN14
     aAlfa = ""; aTipo = "A"; nLon = 14; |HAZ Relleno;
||DES
     aAlfa = #71#4;
     aTipo = "A"; nLon = 70; |HAZ Relleno;
||CFAC
     nNume = #71#5;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||MEDIDA
     nNume = 0; aTipo = "N"; nLon = 10; nDec = 0; |HAZ Relleno;
||UMEDIDA
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||PRECIOB
     nNume = #71#6;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||PRECION
     nNume = (#71#6 < #71#8) < #71#33;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

||TIPOIMP1
     aAlfa = ""; ||VAT
     aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASA1
     nNume = 0;
     aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPTASA1
     nNume = 0;  ||#71#9 * enIva / 100;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TIPOIMP2
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASA2
     nNume = 0; aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPTASA2
     nNume = 0; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TIPOIMP3
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASA3
     nNume = 0; aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPTASA3
     nNume = 0; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

     |SI #71#8 ! 0;
||CALIF1
          aAlfa = "A";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN1
          nNume= 1;
          aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO1
          aAlfa = "TD";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN1
          nNume = #71#8;
          aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDTO1
          nNume = #71#7 * #71#8 / 100;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
     |SINO;
||CALIF1
          aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN1
          nNume= 0; aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO1
          aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN1
          nNume = 0; aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDTO1
          nNume = 0
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
     |FINSI;

     |SI #71#33 ! 0;
||CALIF2
          aAlfa = "A";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN2
          nNume= 1;
          aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO2
          aAlfa = "TD";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN2
          nNume = #71#33;
          aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDTO2
          nNume = (#71#7 < #71#8) * #71#33 / 100;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
     |SINO;
||CALIF2
          aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN2
          nNume= 0; aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO2
          aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN2
          nNume = 0; aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDTO2
          nNume = 0; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
     |FINSI;
||CALIF3
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN3
     nNume= 0; aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO3
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN3
     nNume = 0; aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDTO3
     nNume = 0; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||CALIF4
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN4
     nNume= 0; aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO4
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN4
     nNume = 0; aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDTO4
     nNume = 0; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||CBONI
     nNume = 0; aTipo = "N"; nLon = 15; nDec = 0; |HAZ Relleno;
||NETO
     nNume = #71#9;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||PVERDE
     nNume = 0;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||PEDIDO
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||ALBARAN
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||LOTE
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;

     |XGRABA nHandle, aFinReg;

     |SI #71#8 ! 0; |O #71#33 ! 0;
          |HAZ DtolFac;
     |FINSI;
|FPRC;

|PROCESO ImpFac;
     nHandle = nAbre3;
     nConta = 0;
     |SI #1#21 ! 0;
          nConta = nConta  + 1;
||NUMFAC:X15
          aAlfa = #1#0;
          aTipo = "A"; nLon = 15; |HAZ Relleno;
||NUMIMP:N5
          nNume = nConta;
          aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;
||BASEIMP:N15,3
          nNume = #1#21;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TIPO:X3
          aAlfa = "VAT";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASA:N8,3
          nNume = #1#39;
          aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPORTE:N15,3
          nNume = #1#22;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

          |XGRABA nHandle, aFinReg;
     |FINSI;
     |SI #1#24 ! 0;
          nConta = nConta + 1;
||NUMFAC:X15
          aAlfa = #1#0;
          aTipo = "A"; nLon = 15; |HAZ Relleno;
||NUMIMP:N5
          nNume = nConta;
          aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;
||BASEIMP:N15,3
          nNume = #1#24;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TIPO:X3
          aAlfa = "VAT";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASA:N8,3
          nNume = #1#41;
          aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPORTE:N15,3
          nNume = #1#25;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

          |XGRABA nHandle, aFinReg;
     |FINSI;
     |SI #1#27 ! 0;
          nConta = nConta + 1;
||NUMFAC:X15
          aAlfa = #1#0;
          aTipo = "A"; nLon = 15; |HAZ Relleno;
||NUMIMP:N5
          nNume = nConta;
          aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;
||BASEIMP:N15,3
          nNume = #1#27;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TIPO:X3
          aAlfa = "VAT";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASA:N8,3
          nNume = #1#43;
          aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPORTE:N15,3
          nNume = #1#28;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

          |XGRABA nHandle, aFinReg;
     |FINSI;
|FPRC;

|PROCESO DtoFac;
     nHandle = nAbre2;

||NUMFAC:X15
     aAlfa = #1#0;
     aTipo = "A"; nLon = 15; |HAZ Relleno;
||NUMDTO:N5
     nNume = 1;
     aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;
||CALDTO:X3
     aAlfa = "A";
     aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN:N2
     nNume = 1;
     aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO:X3
     aAlfa = "EAB";
     aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN:N8,3
     nNume = #1#6;
     aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDES:N15,3
     nNume = #1#18 * #1#6 / 100;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

     |XGRABA nHandle, aFinReg;
|FPRC;

|PROCESO CabFac;
     nHandle = nAbre1;

||NUMFAC
     aAlfa = #1#0;
     aTipo = "A"; nLon = 15; |HAZ Relleno;
||VENDEDOR: X17
     aAlfa = #2#0;
     aTipo = "A"; nLon = 17; |HAZ Relleno;
||EMISOR: X17
     aAlfa = #2#6;
     aTipo = "A"; nLon = 17; |HAZ Relleno;
||COBRADOR (*)
     aAlfa = #2#0; aTipo = "A"; nLon = 17; |HAZ Relleno;
||COMPRADOR: X17
     aAlfa = #3#7;
     aTipo = "A"; nLon = 17; |HAZ Relleno;
||DEPTO
     aAlfa = ""; aTipo = "A"; nLon = 13; |HAZ Relleno;
||RECEPTOR:X17
     aAlfa = #3#1;
     aTipo = "A"; nLon = 17; |HAZ Relleno;
||CLIENTE: X17
     aAlfa = #3#3;
     aTipo = "A"; nLon = 17; |HAZ Relleno;
||PAGADOR (*)
     aAlfa = #3#5; aTipo = "A"; nLon = 17; |HAZ Relleno;
||PEDIDO:X17
     aAlfa = #4#55;
     aTipo = "A"; nLon = 17; |HAZ Relleno;
||FECHA:X12 'YYYYMMDDhhmm'
     aAlfa = #1#1;
     aAlfa = (aAlfa %  -104) + (aAlfa % 402) + (aAlfa % 102) + "0000";
     aTipo = "A"; nLon = 12; |HAZ Relleno;
||NODO:X3
     |SI #1#101 < 0; aAlfa = "381"; |SINO; aAlfa = "380"; |FINSI;
     aTipo = "A"; nLon = 3; |HAZ Relleno;
||FUNCION
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||RAZON SOCIAL:X70
     aAlfa = #6#1;
     aTipo = "A"; nLon = 70; |HAZ Relleno;
||CALLE:X35
     aAlfa = #6#8;
     aTipo = "A"; nLon = 35; |HAZ Relleno;
||CIUDAD:X35
     aAlfa = #6#9;
     aTipo = "A"; nLon = 35; |HAZ Relleno;
||CP:N5
     nNume = #6#183;
     aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;
||NIF:X17;
     aAlfa = #6#15;
     aTipo = "A"; nLon = 17; |HAZ Relleno;
||RAZON
     |SI #1#101 < 0; aAlfa = "1A"; |SINO; aAlfa = ""; |FINSI;
     aTipo = "A"; nLon = 3; |HAZ Relleno;
||ALBARAN:X17
     aAlfa = #5#2;
     aTipo = "A"; nLon = 17; |HAZ Relleno;
||CONTRATO
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||NFACSUS
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||FPAGO
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||DIVISA
     aAlfa = "EUR"; aTipo = "A"; nLon = 3; |HAZ Relleno;
||SUMBRUTO
     nNume = 0; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||SUMNETOS:N15,3
     nNume = #1#18 - #1#17;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||CARGOS:N15,3
     nNume = 0;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||DESCUEN:N15,3
     nNume = #1#17;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

     a1 = 0; a2 = 0; a3 = 0; a4 = 0; a5 = 0; a6 = 0;
     b1 = 0; b2 = 0; b3 = 0; b4 = 0; b5 = 0; b6 = 0;
     c1 = 0; c2 = 0; c3 = 0; c4 = 0; c5 = 0; c6 = 0;
     d1 = "";d2 = "";d3 = "";d4 = "";d5 = "";d6 = "";
     Ia = a1<-; Ib = b1<-; Ic = c1<-; Id = d1<-;
     |SI #1#91 ! 0;
          a = #1#91; b = #1#92; c = #1#39; d = "VAT";
          Ia = Ia + 1; Ib = Ib + 1; Ic = Ic + 1; Id = Id + 1;
     |FINSI;
     |SI #1#94 ! 0;
          a = #1#94; b = #1#95; c = #1#41; d = "VAT";
          Ia = Ia + 1; Ib = Ib + 1; Ic = Ic + 1; Id = Id + 1;
     |FINSI;
     |SI #1#97 ! 0;
          a = #1#97; b = #1#98; c = #1#43; d = "VAT";
          Ia = Ia + 1; Ib = Ib + 1; Ic = Ic + 1; Id = Id + 1;
     |FINSI;
     |SI #1#102 ! 0;
          a = #1#102; b = #1#103; c = #1#50; d = "VAT";
          Ia = Ia + 1; Ib = Ib + 1; Ic = Ic + 1; Id = Id + 1;
     |FINSI;
     |SI #1#105 ! 0;
          a = #1#105; b = #1#106; c = #1#52; d = "VAT";
          Ia = Ia + 1; Ib = Ib + 1; Ic = Ic + 1; Id = Id + 1;
     |FINSI;
     |SI #1#47 ! 0;
          a = #1#47; b = 0; c = 0; d = "EXT";
          Ia = Ia + 1; Ib = Ib + 1; Ic = Ic + 1; Id = Id + 1;
     |FINSI;

||BASEIMP1:N15,3
     nNume = a1;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TIPOIMP1:X3
     aAlfa = d1;
     aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASAIMP1:N8,3
     nNume = c1;
     aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPIMI1:N15,3
     nNume = b1;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||BASEIMP2:N15,3
     nNume = a2;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TIPOIMP2:X3
     aAlfa = d2;
     aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASAIMP2:N8,3
     nNume = c2;
     aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPIMI2:N15,3
     nNume = b2;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||BASEIMP3:N15,3
     nNume = a3;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TIPOIMP3:X3
     aAlfa = d3;
     aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASAIMP3:N8,3
     nNume = c3;
     aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPIMI3:N15,3
     nNume = b3;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||BASEIMP4:N15,3
     nNume = a4;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TIPOIMP4:X3
     aAlfa = d4;
     aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASAIMP4:N8,3
     nNume = c4;
     aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPIMI4:N15,3
     nNume = b4;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||BASEIMP5:N15,3
     nNume = a5;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TIPOIMP5:X3
     aAlfa = d5;
     aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASAIMP5:N8,3
     nNume = c5;
     aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPIMI5:N15,3
     nNume = b5;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||BASEIMP6:N15,3
     nNume = a6;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TIPOIMP6:X3
     aAlfa = d6;
     aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASAIMP6:N8,3
     nNume = c6;
     aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPIMI6:N15,3
     nNume = b6;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

||BASEIMP:N15,3
     nNume = #1#21 + #1#24 + #1#27 + #1#47;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TOTIMP:N15,3
     nNume = #1#29;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TOTAL:N15,3
     nNume = #1#31;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

     nVto = 1; |HAZ Vto;
||VTO1:X8 'YYYYMMDD'
     aAlfa = aVto;
     aAlfa = (aAlfa %  -104) + (aAlfa % 402) + (aAlfa % 102);
     aTipo = "A"; nLon = 8; |HAZ Relleno;
||IMPVTO1:N15,3
     nNume = #133#2;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

     nVto = 2; |HAZ Vto;
||VTO2:X8 'YYYYMMDD'
     aAlfa = aVto;
     aAlfa = (aAlfa %  -104) + (aAlfa % 402) + (aAlfa % 102);
     aTipo = "A"; nLon = 8; |HAZ Relleno;
||IMPVTO2:N15,3
     nNume = #133#2;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

     nVto = 3; |HAZ Vto;
||VTO3:X8 'YYYYMMDD'
     aAlfa = aVto;
     aAlfa = (aAlfa %  -104) + (aAlfa % 402) + (aAlfa % 102);
     aTipo = "A"; nLon = 8; |HAZ Relleno;
||IMPVTO3:N15,3
     nNume = #133#2;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

||TPVERDE:N15,3
     nNume = 0;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

     |SI #1#6 ! 0;
||CALIF1
          aAlfa = "A";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN1
          nNume = 1;
          aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO1
          aAlfa = "EAB";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN1
          nNume = #1#6;
          aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDES1
          nNume = #1#17;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
     |SINO;
||CALIF1
          aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN1
          nNume = 0; aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO1
          aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN1
          nNume = 0; aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDES1
          nNume = 0; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
     |FINSI;
||CALIF2
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN2
     nNume = 0; aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO2
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN2
     nNume = 0; aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDES2
     nNume = 0; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||CALIF3
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN3
     nNume = 0; aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO3
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN3
     nNume = 0; aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDES3
     nNume = 0; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||CALIF4
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN4
     nNume = 0; aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO4
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN4
     nNume = 0; aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDES4
     nNume = 0; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||CALIF5
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN5
     nNume = 0; aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO5
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN5
     nNume = 0; aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDES5
     nNume = 0; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

||ERSOCIAL:X70
     aAlfa = #2#1;
     aTipo = "A"; nLon = 70; |HAZ Relleno;
||ECALLE:X35
     aAlfa = #2#3;
     aTipo = "A"; nLon = 35; |HAZ Relleno;
||EPOBLAC:X35
     aAlfa = #2#4;
     aTipo = "A"; nLon = 35; |HAZ Relleno;
||ECP:N5
     nNume = #2#5;
     aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;
||ENIF:X17
     aAlfa = #2#13;
     aTipo = "A"; nLon = 17; |HAZ Relleno;
||EMERCA:X70
     aAlfa = #2#15;
     aTipo = "A"; nLon = 70; |HAZ Relleno;
||NOTAC
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||NUMREL
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
     |XGRABA nHandle, aFinReg;
|FPRC;

|PROCESO agifa134;
     nSw = 1;
     |SI #0#11 ! 0;
          nSw = 0;
          |PARA i = 11; |SI i [ 30; |HACIENDO i = i + 1;
               |SI #0i = #1#2;
                    nSw = 1;
               |FINSI;
          |SIGUE;
     |FINSI;
     |SI #0#31 ! 0; |Y nSw = 1;
          nSw = 0;
          |PARA i = 31; |SI i [ 50; |HACIENDO i = i + 1;
               |SI #0i = #1#0;
                    nSw = 1;
               |FINSI;
          |SIGUE;
     |FINSI;

     #3#0 = #1#2;
     |LEE 000#3=;
     |SI FSalida ! 0; |O nSw = 0;
          |ERROR; |ACABA;
     |FINSI;

     |DDEFECTO #6;
     #6#0 = #1#2;
     |LEE 020#6=;

     #5#14 = #1#49;
     #5#0 = #1#0;
     #5#1 = 0;
     |LEE 020#5];
     |SI FSalida = 0; |Y #5#14 = #1#49; |Y #5#0 = #1#0;
          #4#52 = #5#15;
          #4#0 = #5#2;
          |LEE 020#4=;
          |SI FSalida = 0;
               |HAZ CabFac;
               |SI #1#6 ! 0;
                    |HAZ DtoFac;
               |FINSI;
               |HAZ ImpFac;

               nLin = 0;
               |BUCLELIN 2 LinFac #4;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE agifa134;
     #1#1;
     2, 1, 101;
     #0#9,  #0#2, #0#0, #0#4, #0#7;
     #0#10, #0#3, #0#1, #0#5, #0#8;
     ;
     NULL, agifa134;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     aFinReg = &13;
     aFinReg = aFinReg + & 10;

     aPath = #0#51; |QBF aPath;
     aPath = aPath + "/";
     aFic = aPath + "cabfac.txt";
     |XABRE "WB", aFic, nHanCab;
     nAbre1 = FSalida;
     |SI FSalida < 0;
          aAlfa = "0000ERROR " + aFic;
          |MENAV aAlfa;
     |FINSI;

     aFic = aPath + "dtofac.txt";
     |XABRE "WB", aFic, nHanDto;
     nAbre2 = FSalida;
     |SI FSalida < 0;
          aAlfa = "0000ERROR " + aFic;
          |MENAV aAlfa;
     |FINSI;

     aFic = aPath + "impfac.txt";
     |XABRE "WB", aFic, nHanImp;
     nAbre3 = FSalida;
     |SI FSalida < 0;
          aAlfa = "0000ERROR " + aFic;
          |MENAV aAlfa;
     |FINSI;

     aFic = aPath + "linfac.txt";
     |XABRE "WB", aFic, nHanLin;
     nAbre4 = FSalida;
     |SI FSalida < 0;
          aAlfa = "0000ERROR " + aFic;
          |MENAV aAlfa;
     |FINSI;

     aFic = aPath + "dtolfac.txt";
     |XABRE "WB", aFic, nHanDtol;
     nAbre5 = FSalida;
     |SI FSalida < 0;
          aAlfa = "0000ERROR " + aFic;
          |MENAV aAlfa;
     |FINSI;

     |SI nAbre1 ] 0; |Y nAbre2 ] 0; |Y nAbre3 ] 0; |Y nAbre4 ] 0; |Y nAbre5 ] 0;
          |ABRE #2; |LEE 000#2p; |CIERRA #2;
          |ABRE #3;
          |ABRE #4;
          |ABRE #5;
          |ABRE #6;
          |ABRE #19;
          |ABRE #133;
          |BUCLE agifa134;
          |CIERRA #3;
          |CIERRA #4;
          |CIERRA #5;
          |CIERRA #6;
          |CIERRA #19;
          |CIERRA #133;
     |FINSI;

     |XCIERRA nHanCab;
     |XCIERRA nHanDto;
     |XCIERRA nHanImp;
     |XCIERRA nHanLin;
     |XCIERRA nHanDtol;
|FPRC;
