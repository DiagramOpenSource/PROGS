|FICHEROS;
     goparcop #0;
     paramge@ #1;
     paramds@ #2;
     goparame #3;
     goinform #4;
     agifa007 #5,MANTE;
     agi00063 #6,MANTE;
     agifa029 #7;
     agifa019 #8,MANTE;
|FIN;
----------------------------------------------------------------------
|VARIABLES;
     nBotParti = 0;
     nCampo    = 0;

     aDirBase  = "";
     aMas      = "";
     base      = "";
     aAlfa     = "";
     cEmpresa  = "";
|FIN;
----------------------------------------------------------------------
|PROCESO Copia; |TIPO 3;
     |DBASE aDirBase;
     |DFICB base;
     cEmpresa = #0#0;
     cEmpresa = "00000" + cEmpresa;
     cEmpresa = cEmpresa % -105;
     base = base + cEmpresa + "/";
     |QBF base;

     |SI #0#2 = "S";
          aMas = aDirBase + "def/" + "goparame";
          |CARGA_DEF aMas, paramge@;

          |SI FSalida ! 0;
               aAlfa = "0000NO PUEDO CARGAR " + aMas;
               |MENAV aAlfa;
               |ACABA;
          |SINO;
               |PATH_DAT #1 base;
               |ABRE #1;
               |ABRE #3;
               #1#0 = "A";
               |LEE 000#1=;

               |SI FSalida = 0;
                    #3#0 = #1#0;
                    |LEE 000#3=;

                    |SI FSalida ! 0;
                         |GRABA 020#3c;
                    |FINSI;

                    |PARA nCampo = 1; |SI nCampo [ 32; |HACIENDO nCampo = nCampo + 1;
                         #3nCampo = #1nCampo;
                    |SIGUE;

                    |GRABA 020#3a;
               |FINSI;

               |CIERRA #3;
               |CIERRA #1;
               |HAZ Comprueba;
          |FINSI;

          |DESCARGA_DEF #paramge@;

     |FINSI;

     |SI #0#3 = "S";
          aMas = aDirBase + "def/" + "goinform";
          |CARGA_DEF aMas, paramds@;

          |SI FSalida ! 0;
               aAlfa = "0000NO PUEDO CARGAR " + aMas;
               |MENAV aAlfa;
               |ACABA;
          |SINO;
               |PATH_DAT #2 base;
               |ABRE #2;
               |ABRE #4;
               |LEE 000#2p;

               |PARA; |SI FSalida = 0; |HACIENDO;
                    #4#0 = #2#0;
                    |LEE 000#4=;

                    |SI FSalida ! 0;
                         |GRABA 020#4c;
                    |FINSI;

                    #4#1 = #2#1;#4#2 = #2#2;#4#3 = #2#3;#4#4 = #2#4;#4#5 = #2#5;
                    |GRABA 020#4a;
                    |LEE 000#2s;
               |SIGUE;

               |CIERRA #4;
               |CIERRA #2;
          |FINSI;

          |DESCARGA_DEF #paramds@;

     |FINSI;

|FPRC;
-------------------------------------------------------------------------------
|PROGRAMA;

     |CLS;
     |CONTROL_SIMPLE 0, "BOTON,F2 - Relación Empresas", 2430, 2450, F2par;
     nBotParti = FSalida;
     |ESTADO_CONTROL nBotParti, "HIDE"; ||"SHOW""HIDE""ENABLE""DISABLE".

     |ABRE #48;
     |LEE 000#48p;

     |SI FSalida = 0;
          #0#0 = #48#0;
          #0#1 = #48#1;
     |FINSI;

     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;

     |CIERRA #48;

     |PULSATECLA;
     |FIN_CONTROL_WINDOWS nBotParti;
     |PULSATECLA;

|FPRO;
-------------------------------------------------------------------------------
|PROCESO Empresas; |TIPO 0;

     |SI FSalida = 10;
          |DDEFECTO #48;
          |CONSULTA_CLAVE #1#48;

          |SI FSalida = 0;
               #0#0 = #48#0;
               #0#1 = #48#1;
               |PINTA #0#0; |PINTA #0#1;
          |SINO;
               |ERROR;
               |ACABA;
          |FINSI;

     |FINSI;

     |ESTADO_CONTROL nBotParti, "HIDE"; ||"SHOW""HIDE""ENABLE""DISABLE".
|FPRC;
-------------------------------------------------------------------------------
|PROCESO BusEmp; |TIPO 0;

     #48#0 = #0#0;
     |LEE 000#48=;

     |SI FSalida ! 0;
          |MENAV "0000LA EMPRESA ORIGEN NO EXISTE";
          |ERROR;
          |ACABA;
     |SINO;
          #0#1 = #48#1;
          |PINTA #0#1;
     |FINSI;

     |ESTADO_CONTROL nBotParti, "HIDE"; ||"SHOW""HIDE""ENABLE""DISABLE".
|FPRC;
------------------------------------------------------------------------------
|PROCESO BSpar; |TIPO 7;
     |ESTADO_CONTROL nBotParti, "SHOW"; ||"SHOW""HIDE""ENABLE""DISABLE".
|FPRC;
-------------------------------------------------------------------------------
|PROCESO BHpar; |TIPO 0;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO F2par;
     |PTEC 824;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO Comprueba;
     |ABRE #5;
     |DDEFECTO #5;
     #5#26 = #3#1;                                ||Serie Albaranes.
     |LEE 000#5=;

     |SI FSalida ! 0;
          #5#27 = #3#2;                           ||Descricpcion Serie.
          |PUSHV 01012380;
          |CLS;
          |PINPA #0#5;
          |PINDA #0#5;
          |ENDATOS #1#5;

          |SI FSalida = 0;
               |GRABA 020#5c;
          |FINSI;

          |POPV;
     |FINSI;

     #5#26 = #3#3;                                 ||Serie Partes Trabajo.
     |LEE 000#5=;

     |SI FSalida ! 0;
          #5#27 = #3#4;                            ||Descricpcion Serie.
          |PUSHV 01012380;
          |CLS;
          |PINPA #0#5;
          |PINDA #0#5;
          |ENDATOS #1#5;

          |SI FSalida = 0;
               |GRABA 020#5c;
          |FINSI;

          |POPV;
     |FINSI;

     #5#26 = #3#13;                                 ||Serie Certificaciones.
     |LEE 000#5=;

     |SI FSalida ! 0;
          #5#27 = #3#14;                            ||Descricpcion Serie.
          |PUSHV 01012380;
          |CLS;
          |PINPA #0#5;
          |PINDA #0#5;
          |ENDATOS #1#5;

          |SI FSalida = 0;
               |GRABA 020#5c;
          |FINSI;

          |POPV;
     |FINSI;

     #5#26 = #3#29;                                 ||Serie Cert. Subc.
     |LEE 000#5=;

     |SI FSalida ! 0;
          #5#27 = #3#30;                            ||Descricpcion Serie.
          |PUSHV 01012380;
          |CLS;
          |PINPA #0#5;
          |PINDA #0#5;
          |ENDATOS #1#5;

          |SI FSalida = 0;
               |GRABA 020#5c;
          |FINSI;

          |POPV;
     |FINSI;

     |CIERRA #5;

     |ABRE #6;
     |DDEFECTO #6;
     #6#0 = #3#5;                                 ||Cod. MO.
     |LEE 000#6=;

     |SI FSalida ! 0;
          #6#1 = #3#9;                           ||Descricpcion.
          |PUSHV 01012380;
          |CLS;
          |PINPA #0#6;
          |PINDA #0#6;
          |ENDATOS #1#6;

          |SI FSalida = 0;
               |GRABA 020#6c;
          |FINSI;

          |POPV;
     |FINSI;

     #6#0 = #3#6;                                 ||Cod. Materiales.
     |LEE 000#6=;

     |SI FSalida ! 0;
          #6#1 = #3#10;                          ||Descricpcion.
          |PUSHV 01012380;
          |CLS;
          |PINPA #0#6;
          |PINDA #0#6;
          |ENDATOS #1#6;

          |SI FSalida = 0;
               |GRABA 020#6c;
          |FINSI;

          |POPV;
     |FINSI;

     #6#0 = #3#7;                                 ||Cod. Maquinaria.
     |LEE 000#6=;

     |SI FSalida ! 0;
          #6#1 = #3#11;                           ||Descricpcion.
          |PUSHV 01012380;
          |CLS;
          |PINPA #0#6;
          |PINDA #0#6;
          |ENDATOS #1#6;

          |SI FSalida = 0;
               |GRABA 020#6c;
          |FINSI;

          |POPV;
     |FINSI;

     #6#0 = #3#8;                                 ||Cod. Auxiliares.
     |LEE 000#6=;

     |SI FSalida ! 0;
          #6#1 = #3#12;                           ||Descricpcion.
          |PUSHV 01012380;
          |CLS;
          |PINPA #0#6;
          |PINDA #0#6;
          |ENDATOS #1#6;

          |SI FSalida = 0;
               |GRABA 020#6c;
          |FINSI;

          |POPV;
     |FINSI;
     #6#0 = #3#25;                                 ||Sin Clasificar.
     |LEE 000#6=;

     |SI FSalida ! 0;
          #6#1 = #3#26;                           ||Descricpcion.
          |PUSHV 01012380;
          |CLS;
          |PINPA #0#6;
          |PINDA #0#6;
          |ENDATOS #1#6;

          |SI FSalida = 0;
               |GRABA 020#6c;
          |FINSI;

          |POPV;
     |FINSI;

     |CIERRA #6;

     |ABRE #7;
     |DDEFECTO #7;
     #7#0 = #3#22;                                ||Cod. Almacen.
     |LEE 000#7=;

     |SI FSalida ! 0;
          #7#1 = #3#23;                           ||Descricpcion.
          |PUSHV 01012380;
          |CLS;
          |PINPA #0#7;
          |PINDA #0#7;
          |ENDATOS #1#7;

          |SI FSalida = 0;
               |GRABA 020#7c;
          |FINSI;

          |POPV;
     |FINSI;

     |CIERRA #7;

     |ABRE #8;
     |DDEFECTO #8;
     #8#0 = #3#31;                                ||Cod. Art Subc.
     |LEE 000#8=;

     |SI FSalida ! 0;
          |PUSHV 01012380;
          |CLS;
          |PINPA #0#8;
          |PINDA #0#8;
          |ENDATOS #1#8;

          |SI FSalida = 0;
               |GRABA 020#8c;
          |FINSI;

          |POPV;
     |FINSI;

     |CIERRA #8;
|FPRC;
