|FICHEROS;
     agifa007 #0;
     agifa142 #1;   || P. Generales - Alejandro 09/02/2000 Ref: DOCTO 85/6
     dsw00068 #68;
     referen@ #100;
     dsm00010 #910;
     dsm00131 #131,MANTE;
     agifa029 #29;
     agifa027 #27;
     CtaAnal@;
|FIN;

|VARIABLES;
     nSal = 0;
 {100}aValor = "";
     i = 0;
     &eaSerie = "";
     nAlma = 0;
     nNume = 0;
     aClave = "";
 {-1}aMenu = "";
     aMenu1 = "2400";
     aMenu2 = "1";
     aMenu3 = "Opciones: ";
     aMenu4 = "AM";
     aMenu5 = " Importar ";
     aMenu6 = " Contadores ";

     aDef = "";
     aActual = "";
     xLon = "";
     aAlfa1 = "";
     aSalida = "";
     nPos = 0;
     aAlfa = "";
     aMensaje = "";
     alfa1 = "";
     alfa2 = "";
     dbase = "";

     inkey = 0;
     aginform   = ":/ut/aginfo";
     empresa    = "agifa041";

     aplicacion = "";
     orden      = "";  || Editor de Informes
     alinforme  = "";
     fichero1   = "";
     fichero2   = "";
     comando    = "";
     nModo = 0;

     aCopia1 = "";
     aCopia2 = "";
     nFormato = 0;
     aPathOrigen = "";
     aPathDestin = "";
     nOpcion = 0;
 {-1}pMenu = "";
     pMenu1 = "2400";
     pMenu2 = "3";
     pMenu3 = " Version origen: ";
     pMenu4 = "678";
     pMenu5 = " DSCOMER6 ";
     pMenu6 = " DSCOMER7 ";
     pMenu7 = " DSCOMER8 ";
     nCam = 0;
     aSer = "";
     nError = 0;
     aPath = "";
|FIN;

|| *****************************************************************
|PROCESO s_tipo8; |TIPO 8;
     |ABRE #1; |LEE 000#1p; |CIERRA #1;

     |DIRECTORIO dbase;   || Directorio Base /agi/agitra/ ...
     |DBASE aplicacion;   || Directorio de la Aplicacion
     aplicacion = aplicacion - dbase; || Aplicacion

     |VERSIONRTME alfa1;  || Segun Version aginform aginfobx ...
     orden = "";
     alfa1 = alfa1 % 101;      || en AGISYSTEM-VI cambia el aginform

     |SI alfa1 ] "6";
       |QUE_SISTEMA alfa2;
       |SI alfa2 = "ESSCO"; orden = aginform + "sx"; |FINSI;
       |SI alfa2 = "ESBSD"; orden = aginform + "bx"; |FINSI;
       |SI alfa2 = "ESDOS"; orden = aginform + "nt"; |FINSI;
     |FINSI;

     |SI alfa1 = "9";  orden = ":/ut/aginfont";  |FINSI;

     |SI orden = "";  orden = aginform + "rm"; |FINSI;
|FPRC;


|PROCESO mayus; |TIPO 0;
 #0Campo = #0Campo > " ";
 |PINTA #0Campo;
|FPRC;


|PROCESO infor; |TIPO 0;
 inkey = FSalida;

 alinforme = #0Campo; |QBF alinforme;

 |SI inkey = 9;     |HAZ s_edita;    |FINSI;
 |SI inkey = 10;    |HAZ s_copia;    |FINSI;
 |SI inkey = 11;    |HAZ s_restaura; |FINSI;

 |SI inkey ] 9;|Y inkey [ 12;
     |ERROR;
 |FINSI;
|FPRC;

|PROCESO s_edita;
 |INFOR alinforme;
 |SI FSalida ! 0;
     |CONFI "2400SNo existe Informe. Crear Nuevo S/N: ";
     |SI FSalida ! 0;
         |ACABA;
     |FINSI;
     |CONFI "2400SCopiar Informe Standar S/N: ";
     |SI FSalida = 0;
         |HAZ s_copstand;
     |FINSI;
 |FINSI;
 |FININF;

 |ATRI R;
 alfa1 = "    Ejecutando [" + orden + "] ...";
 |MENSA alfa1;
 |ATRI 0;
 |SLEEP 2;

 comando = orden + " " + aplicacion + "def/" + " " + empresa + " " + alinforme;
 |SYSTEM comando;
|FPRC;

|PROCESO s_restaura;
 |ATRI P;
 |MENSA "    Restaurando desde extension '.seg' ...";
 |ATRI 0;

 alfa1 = alinforme;
 |QBF alfa1;

 fichero1 = dbase + aplicacion + "def/" + alfa1 + ".seg";
 fichero2 = dbase + aplicacion + "def/" + alfa1 + ".inf";
 |COPIA_FICHERO fichero1, fichero2;
 |SI FSalida ! 0;
     alfa1 = "    Error [" + FSalida + "] en copia de ficheros ...";
     |MENAV alfa1;
 |FINSI;
 |ATRI R;
 |BLIN 4;
 |ATRI 0;
|FPRC;

|PROCESO s_copia;
 |ATRI P;
 |MENSA "    Copiando a extension '.seg' ...";
 |ATRI 0;

 alfa1 = alinforme;
 |QBF alfa1;

 fichero1 = dbase + aplicacion + "def/" + alfa1 + ".inf";
 fichero2 = dbase + aplicacion + "def/" + alfa1 + ".seg";
 |COPIA_FICHERO fichero1, fichero2;
 |SI FSalida ! 0;
     alfa1 = "    Error [" + FSalida + "] en copia de ficheros ...";
     |MENAV alfa1;
 |FINSI;

 |ATRI R;
 |BLIN 4;
 |ATRI 0;
|FPRC;

|PROCESO s_copstand;
 |SALVA_DATOS #0;
 |DDEFECTO #0;

 |ATRI P;
 |MENSA "    Copiando Standard ...";
 |ATRI 0;

 alfa1 = #0Campo;   |QBF alfa1;  || Fichero Standard
 alfa2 = alinforme; |QBF alfa2;  || Fichero Personalizado

 fichero1 = dbase + aplicacion + "def/" + alfa1 + ".inf";
 fichero2 = dbase + aplicacion + "def/" + alfa2 + ".inf";
 |COPIA_FICHERO fichero1, fichero2;
 |SI FSalida ! 0;
     alfa1 = "    Error [" + FSalida + "] en copia de ficheros ...";
     |MENAV alfa1;
 |FINSI;

 |ATRI R;
 |BLIN 4;
 |ATRI 0;
 |REPON_DATOS #0;
|FPRC;

____________________________________/
|PROCESO e_mensa; |TIPO 7;
    |MENSA "2400 (F1) Editar; (F2) Realizar Copia Seguridad; (F3) Reponer Copia Seguridad";
|FPRC;

|PROCESO s_mensa; |TIPO 6;
    |MENSA "2400 ";
|FPRC;

|PROCESO Defectos;  |TIPO 7;
     |ABRE #910;
     |LEE 040#910p;
     |SI FSalida ! 0;  |DDEFECTO #910;  |FINSI;
     |CIERRA #910;

     |SI #910#19 = "N";
         |SI Campo = 0;
             |SI #0Campo = "ds000104";  #0Campo = "agifa104";  |FINSI;
         |FINSI;
         |SI Campo = 1;
             |SI #0Campo = "ds000081";  #0Campo = "agifa081";  |FINSI;
         |FINSI;
         |SI Campo = 2;
             |SI #0Campo = "ds000036";  #0Campo = "agifa036";  |FINSI;
         |FINSI;
         |SI Campo = 3;
             |SI #0Campo = "ds001010";  #0Campo = "agif1010";  |FINSI;
         |FINSI;
         |SI Campo = 4;
             |SI #0Campo = "ds000010";  #0Campo = "agifa010";  |FINSI;
         |FINSI;
         |SI Campo = 5;
             |SI #0Campo = "ds002010";  #0Campo = "agif2010";  |FINSI;
         |FINSI;
         |SI Campo = 6;
             |SI #0Campo = "ds000017";  #0Campo = "agifa017";  |FINSI;
         |FINSI;
         |SI Campo = 7;
             |SI #0Campo = "ds001017";  #0Campo = "agif1017";  |FINSI;
         |FINSI;
         |SI Campo = 20;
             |SI #0Campo = "ds000146";  #0Campo = "agifa146";  |FINSI;
         |FINSI;
     |SINO;
         |SI Campo = 0;
             |SI #0Campo = "agifa104";  #0Campo = "ds000104";  |FINSI;
         |FINSI;
         |SI Campo = 1;
             |SI #0Campo = "agifa081";  #0Campo = "ds000081";  |FINSI;
         |FINSI;
         |SI Campo = 2;
             |SI #0Campo = "agifa036";  #0Campo = "ds000036";  |FINSI;
         |FINSI;
         |SI Campo = 3;
             |SI #0Campo = "agif1010";  #0Campo = "ds001010";  |FINSI;
         |FINSI;
         |SI Campo = 4;
             |SI #0Campo = "agifa010";  #0Campo = "ds000010";  |FINSI;
         |FINSI;
         |SI Campo = 5;
             |SI #0Campo = "agif2010";  #0Campo = "ds002010";  |FINSI;
         |FINSI;
         |SI Campo = 6;
             |SI #0Campo = "agifa077";  #0Campo = "ds000077";  |FINSI;
         |FINSI;
         |SI Campo = 7;
             |SI #0Campo = "agif1077";  #0Campo = "ds001077";  |FINSI;
         |FINSI;
         |SI Campo = 20;
             |SI #0Campo = "agifa146";  #0Campo = "ds000146";  |FINSI;
         |FINSI;
     |FINSI;

     |HAZ EsPCEGroup;
     |SI FSalida = 0;
          |SI Campo = 0;
               |SI #0Campo = "agifa104";  #0Campo = "pcegm004";  |FINSI;
          |FINSI;
          |SI Campo = 20;
               |SI #0Campo = "agifa146";  #0Campo = "pcegm002";  |FINSI;
          |FINSI;
          |SI Campo = 4; |O Campo = 3; |O Campo = 5;
               |SI #0Campo = "agifa010";  #0Campo = "pcegm010";  |FINSI;
               |SI #0Campo = "agif1010";  #0Campo = "pcegm010";  |FINSI;
               |SI #0Campo = "agif2010";  #0Campo = "pcegm010";  |FINSI;
          |FINSI;
     |FINSI;

     |PINTA #0Campo;
|FPRC;

||----------------------------------------------------------------------
||        Modificacion Ref.: DOCTO 85/6 - Alejandro 09/02/200
||----------------------------------------------------------------------
|PROCESO UnAlmacen; |TIPO 7;

     |SI #1#99 = "S";              || si solo se permite un almacen en PG
          |C_M #0#29, 1, "N";      || no deja colocar otro almacen distinto
          |C_M #0#31, 1, "N";      || del 01 en almacen de ventas y compras.
     |FINSI;
     |SI #1#99 = "N";              || lo contrario del anterior ...
          |C_M #0#29, 1, "S";
          |C_M #0#31, 1, "S";
     |FINSI;
|FPRC;

|PROCESO LimiteSerie; |TIPO 0;
     nSal = FSalida;
     |ABRE #1; |LEE 000#1p; |CIERRA #1;

     aAlfa = #0#26; |QBF aAlfa;
     xLon = aAlfa % A0;
     |SI xLon > #1#155;
          |MENAV "0000Longitud de la serie no permitida.";
          |ERROR;
          |ACABA;
     |FINSI;

     nPos = 100 + #1#155;
     #0#26 = aAlfa % nPos;
     |PINTA #0#26;
     FSalida = nSal;
|FPRC;

|PROCESO InfDef; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |DDEF aDef; aDef = aDef + "agifa007";
          |CARGA_DEF aDef, referen@;
          |SI FSalida = 0;
               aActual = #0#26;
               |ABRE #100;
               #100#26 = #1#214;
               |LEE 000#100=;
               |CIERRA #100;
               |SALVA_DATOS #100;
               |REPON_DATOS #0;
               #0#26 = aActual;
               |DESCARGA_DEF #referen@;
               |PINDA #0#0;
          |FINSI;

          |MODULO aAlfa;
          |SI aAlfa = "gomantho";
               |HAZ EsConstru;
               |SI FSalida = 0;
                    |DDEF aDef; aDef = aDef + "goparame";
                    |CARGA_DEF aDef, referen@;
                    |SI FSalida = 0;
                         |ABRE #100; |LEE 000#100p; |CIERRA #100;
                         |SI #100#94 = "E";
                              nAlma = #0#26;
                              |SI nAlma = 0;
                                   |HAZ ContaSerAlma;
                                   #0#29 = nAlma; |PINTA #0#29;
                                   #0#31 = nAlma; |PINTA #0#31;
                              |SINO;
                                   #0#29 = #0#26; |PINTA #0#29;
                                   #0#31 = #0#26; |PINTA #0#31;
                                   |HAZ ActSerAlma;
                              |FINSI;
                         |FINSI;
                    |FINSI;
                    |DESCARGA_DEF #referen@;
               |FINSI;
          |FINSI;

          |HAZ EsDefelino;
          |SI FSalida = 0; |Y #0#51 = "agifa090";
               #0#51 = "defelz02"; |PINTA #0#51;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Serie2; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |ABRE #1; |LEE 000#1p; |CIERRA #1;
     |SI #1#169 = "N"; |Y nModo = 1;
          |MENAV "0000Alta de Serie NO Permitida...";
          |ERROR;
     |FINSI;
     |SI nModo = 3;
          |HAZ CheqDocu;
          |SI nError = 1;
               |CONFI "0000N¿ Dar de baja la serie: ?";
               |SI FSalida ! 0; |ERROR; |FINSI;
          |FINSI;
          |HAZ EsRavenida;
          |SI FSalida = 0;
               |SUB_EJECUTA_NP "ravem003;BORRA";
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO CopiaFormato;
     aAlfa = #agifa007#nFormato#;
     |QBF aAlfa;
     |SI aAlfa = "";     |ACABA;   |FINSI;
     aAlfa = aAlfa + ".inf";

     aCopia1 = aPathOrigen + aAlfa;
     aCopia2 = aPathDestin + aAlfa;
     |COPIA_FICHERO aCopia1, aCopia2;
     |SI FSalida ! 0;
          aMensaje = "0000[" + aAlfa + "] inaccesible en [" + aPathOrigen + "]";
          |MENAV aMensaje;
     |FINSI;
|FPRC;

|PROCESO Formatos; |TIPO 20;
     aSalida = FSalida;
     |HAZ Tipo7007;

     |HAZ EsProduccion;
     |SI FSalida = 0;
          |HAZ Opciones;
          |ACABA;
     |FINSI;

     |HAZ ImpFormato;
|FPRC;


|PROCESO Opciones;
     aAlfa = aSalida;
     |SI aAlfa = "OPCION";
         FSalida = "Opciones";
         |ACABA;
     |FINSI;
  |ET Sigue;
     |MENU aMenu;
     aMenu2 = FSalida;
     |SI FSalida = 1; |HAZ ImpFormato; |FINSI;
     |SI FSalida = 2; |HAZ Series; |VETE Sigue; |FINSI;
|FPRC;

|PROCESO ImpFormato;
     aAlfa = aSalida;
     |SI aAlfa = "OPCION";
         FSalida = "Importar";
         |ACABA;
     |FINSI;

     |AVISO;
     |CONFI "0000NImportar formatos de la serie en pantalla desde otra version de DSCOMER";
     |SI FSalida = 0;
          |MENU pMenu;
          nOpcion = FSalida;
          |SI nOpcion ] 1;|Y nOpcion [ 3;
               aAlfa = "";
               |DBASS aAlfa;
          |SINO;
               |ACABA;
          |FINSI;
          |SI nOpcion = 1;    aPathOrigen = aAlfa + "dscomer6/def/";  |FINSI;
          |SI nOpcion = 2;    aPathOrigen = aAlfa + "dscomer7/def/";  |FINSI;
          |SI nOpcion = 3;    aPathOrigen = aAlfa + "dscomer8/def/";  |FINSI;
          aPathDestin = aAlfa + "dscomer9/def/";
          nFormato = 0;  |HAZ CopiaFormato;
          nFormato = 1;  |HAZ CopiaFormato;
          nFormato = 4;  |HAZ CopiaFormato;
          nFormato = 3;  |HAZ CopiaFormato;
          nFormato = 5;  |HAZ CopiaFormato;
          nFormato = 6;  |HAZ CopiaFormato;
          nFormato = 7;  |HAZ CopiaFormato;
          nFormato = 19; |HAZ CopiaFormato;
          nFormato = 41; |HAZ CopiaFormato;
          nFormato = 42; |HAZ CopiaFormato;
          nFormato = 2;  |HAZ CopiaFormato;
          nFormato = 8;  |HAZ CopiaFormato;
          nFormato = 9;  |HAZ CopiaFormato;
          nFormato = 17; |HAZ CopiaFormato;
          nFormato = 18; |HAZ CopiaFormato;
          nFormato = 10; |HAZ CopiaFormato;
          nFormato = 16; |HAZ CopiaFormato;
          nFormato = 11; |HAZ CopiaFormato;
          nFormato = 12; |HAZ CopiaFormato;
          nFormato = 13; |HAZ CopiaFormato;
          nFormato = 15; |HAZ CopiaFormato;
          nFormato = 20; |HAZ CopiaFormato;
          nFormato = 21; |HAZ CopiaFormato;
          nFormato = 34; |HAZ CopiaFormato;
          nFormato = 32; |HAZ CopiaFormato;
          nFormato = 35; |HAZ CopiaFormato;
          nFormato = 33; |HAZ CopiaFormato;
          nFormato = 36; |HAZ CopiaFormato;
     |FINSI;
|FPRC;

|PROCESO Tipo7007; |TIPO 7;
|FPRC;

|PROCESO Tipo0007;
   |SI FSalida = 10;
      aAlfa = #agifa142#151; |QBF aAlfa;
      aAlfa1 = aAlfa + "def/anm00001.mas";
      |CARGA_DEF aAlfa1, CtaAnal@;
      |SI FSalida = 0;
         aAlfa = aAlfa + "fich/" + (("000000" + #agifa142#152) % -106) + "/";
         |PATH_DAT #CtaAnal@#aAlfa#;
         |ABRE #CtaAnal@;
         #CtaAnal@#0 = #agifa007#43;
         |LEE 000#CtaAnal@.];
         |SI FSalida ! 0; |LEE 000#CtaAnal@.u; |FINSI;
         |CONSULTA_CLAVE #1#CtaAnal@;
         |SI FSalida = 0;
            #agifa007#43 = #CtaAnal@#0; |PINTA #agifa007#43;
         |FINSI;
         |CIERRA #CtaAnal@; |DESCARGA_DEF #CtaAnal@;
         |ERROR;
      |FINSI;
      |ACABA;
   |FINSI;
   |HAZ AltaCta;

   |HAZ EsAlbadis;
   |SI FSalida = 0;
        aAlfa = "albad044;" + #0#26;
        |SUB_EJECUTA_NP aAlfa;
        |HAZ Serie13;
   |FINSI;
   |HAZ EsGuillen;
   |SI FSalida = 0;
        aAlfa = "guillm02;" + #0#26;
        |SUB_EJECUTA_NP aAlfa;
        |HAZ Serie13;
   |FINSI;
|FPRC;

|PROCESO Min131;
     #131#0 = #0#26;
     #131#1 = aClave;
     #131#2 = 1;
|FPRC;

|PROCESO Max131;
     #131#0 = #0#26;
     #131#1 = aClave;
     #131#2 = 999;
|FPRC;

|PROCESO Series;
     |PUSHV 0501 2380;
     |HAZ Carga68;
     |ABRE #68;
     |LEE 000#68p;
     |CONSULTA_CLAVE #1#68;
     |SI FSalida = 0;
          aClave = #68#0;
          |PINPA #0#131;
          |PINTA 515, #68#1;
          |ATRI R; |PINTA 547, " SERIE:";|ATRI 0;
          |PINTA 555, #0#26;
          |C_A #0#27, 0, nNume;
          |C_A #0#27, 1, 19;
          |PINTA 561, #0#27;
          |ENTLINEAL #1#131, 3, 2, 22, 0, Min131, Max131;
          |C_A #0#27, 1, nNume;
     |FINSI;
     |CIERRA #68;
     |POPV;
|FPRC;

|PROCESO FinSerie; |TIPO 3;
     |ABRE #27;
     #27#2 = #0#26;
     #27#0 = "";
     |LEE 000#27];
     |SI FSalida ! 0; |O #27#2 ! #0#26;
          #27#1 = 1;
          #27#2 = #0#26;
          #27#3 = "";
          #27#0 = "vpedido"; |GRABA 020#27n;
          #27#0 = "vpedcom"; |GRABA 020#27n;
          #27#0 = "vdepo"; |GRABA 020#27n;
          #27#0 = "valbaran"; |GRABA 020#27n;
          #27#0 = "valbaco"; |GRABA 020#27n;
          #27#0 = "vfactura"; |GRABA 020#27n;
          #27#0 = "vfacturo"; |GRABA 020#27n;
          #27#0 = "vfactuco"; |GRABA 020#27n;
          #27#0 = "vfacprof"; |GRABA 020#27n;
          #27#0 = "remesa"; |GRABA 020#27n;
          #27#0 = "desglos"; |GRABA 020#27n;
          #27#0 = "vpresup"; |GRABA 020#27n;
          #27#0 = "ordenfab"; |GRABA 020#27n;
          #27#0 = "vtiquet"; |GRABA 020#27n;
     |FINSI;
     |CIERRA #27;


     |HAZ EsProduccion;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |DDEFECTO #131;
     |ABRE #131;
     #131#0 = #0#26;
     |LEE 000#131];
     |SI FSalida ! 0; |O #131#0 ! #0#26;
          |CONFI "0000SCrear Contadores Automaticamente:";
          |SI FSalida = 0;
               |HAZ CreaConAuto;
          |FINSI;
     |FINSI;
     |CIERRA #131;
|FPRC;

|PROCESO CreaConAuto;
     |DDEFECTO #131;
     #131#0 = #0#26;
     #131#2 = 1;
     #131#5 = "01.01.1900";
     #131#6 = "31.12.2099";
     #131#9 = "S";
     #131#1 = "vpedido"; #131#3 = "Pedidos Ventas";  |GRABA 020#131n;
     #131#1 = "vpedcom"; #131#3 = "Pedidos Compras";|GRABA 020#131n;
     #131#1 = "vdepo";   #131#3 = "Depositos";  |GRABA 020#131n;
     #131#1 = "valbaran";#131#3 = "Albaranes Ventas"; |GRABA 020#131n;
     #131#1 = "valbaco"; #131#3 = "Albaranes Compras"; |GRABA 020#131n;
     #131#1 = "vfactura";#131#3 = "Facturas Ventas (o Directas)"; |GRABA 020#131n;
     #131#1 = "vfacturo";#131#3 = "Facturas Compras";  |GRABA 020#131n;
     #131#1 = "vfactuco";#131#3 = "Facturas Directas";  |GRABA 020#131n;
     #131#1 = "vfacprof";#131#3 = "Facturas Proforma"; |GRABA 020#131n;
     #131#1 = "remesa";  #131#3 = "Remesas"; |GRABA 020#131n;
     #131#1 = "desglos"; #131#3 = "Desgloses";|GRABA 020#131n;
     #131#1 = "vpresup"; #131#3 = "Presupuestos";|GRABA 020#131n;
     #131#1 = "ordenfab";#131#3 = "Ordenes de Fabricacion"; |GRABA 020#131n;
     #131#1 = "vtiquet"; #131#3 = "Tiquets"; |GRABA 020#131n;
|FPRC;

|PROCESO Carga68;
     |ABRE #68;
     #68#0 = "vpedido";  #68#1 = "Pedidos Ventas";
     |LEE 000#68=; |SI FSalida ! 0; |GRABA 020#68n; |FINSI;
     #68#0 = "vpedcom";  #68#1 = "Pedidos Compras";
     |LEE 000#68=; |SI FSalida ! 0; |GRABA 020#68n; |FINSI;
     #68#0 = "vdepo";    #68#1 = "Depositos";
     |LEE 000#68=; |SI FSalida ! 0; |GRABA 020#68n; |FINSI;
     #68#0 = "valbaran"; #68#1 = "Albaranes Ventas";
     |LEE 000#68=; |SI FSalida ! 0; |GRABA 020#68n; |FINSI;
     #68#0 = "valbaco";  #68#1 = "Albaranes Compras";
     |LEE 000#68=; |SI FSalida ! 0; |GRABA 020#68n; |FINSI;
     #68#0 = "vfactura"; #68#1 = "Facturas Ventas";
     |LEE 000#68=; |SI FSalida ! 0; |GRABA 020#68n; |FINSI;
     #68#0 = "vfacturo"; #68#1 = "Facturas Compras";
     |LEE 000#68=; |SI FSalida ! 0; |GRABA 020#68n; |FINSI;
     #68#0 = "vfactuco"; #68#1 = "Facturas Directas";
     |LEE 000#68=; |SI FSalida ! 0; |GRABA 020#68n; |FINSI;
     #68#0 = "vfacprof"; #68#1 = "Facturas Proforma";
     |LEE 000#68=; |SI FSalida ! 0; |GRABA 020#68n; |FINSI;
     #68#0 = "remesa";   #68#1 = "Remesas";
     |LEE 000#68=; |SI FSalida ! 0; |GRABA 020#68n; |FINSI;
     #68#0 = "desglos";  #68#1 = "Desgloses";
     |LEE 000#68=; |SI FSalida ! 0; |GRABA 020#68n; |FINSI;
     #68#0 = "vpresup";  #68#1 = "Presupuestos";
     |LEE 000#68=; |SI FSalida ! 0; |GRABA 020#68n; |FINSI;
     #68#0 = "ordenfab"; #68#1 = "Ordenes de Fabricacion";
     |LEE 000#68=; |SI FSalida ! 0; |GRABA 020#68n; |FINSI;
     #68#0 = "vtiquet";  #68#1 = "Tiquets";
     |LEE 000#68=; |SI FSalida ! 0; |GRABA 020#68n; |FINSI;
     |CIERRA #68;
|FPRC;

|PROCESO ActSerAlma;
     nAlma = #0#29;
     |DDEFECTO #29;
     |ABRE #29;
     #29#0 = nAlma;
     |LEE 000#29=;
     |SI FSalida ! 0;
          aAlfa = ("00000" + nAlma) % -105;
          aAlfa = #0#26 + "/" + aAlfa;
          #29#1 = aAlfa;
          |GRABA 020#29n;
     |FINSI;
     |CIERRA #29;
|FPRC;

|PROCESO ContaSerAlma;
     |ABRE #29;
     |LEE 000#29u;
     |SI FSalida = 0;
          nAlma = #29#0 + 1;
     |SINO;
          nAlma = 1;
     |FINSI;
     |DDEFECTO #29;
     #29#0 = nAlma;
     aAlfa = ("00000" + nAlma) % -105;
     aAlfa = #0#26 + "/" + aAlfa;
     #29#1 = aAlfa;
     |GRABA 020#29n;
     |CIERRA #29;
|FPRC;


|PROCESO Serie13; |TIPO 13;
     aAlfa = #agifa142#151;
     aAlfa = aAlfa - "contagen";
     |SI FSalida ! 0;
        |PINTA 1016, "Cuenta analitica";
        |C_M #agifa007#43,1,"S"; |C_V #agifa007#43,1,"S";
        |PINTA #agifa007#43;
     |SINO;
        ||PINTA 1016, "                ";
        |C_M #agifa007#43,1,"N"; |C_V #agifa007#43,1,"N";
        #agifa007#43 = "";
     |FINSI;
     |PINTA 1102, "ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´";

     |HAZ EsAlbadis;
     |SI FSalida = 0;
          |C_V #0#22, 1, "S";
          |PINTA 1203, " Albaran Vta Promocion ";
          |PINTA 1227, "             ";

          |DDEF aAlfa;
          aAlfa = aAlfa + "albad044";
          |CARGA_DEF aAlfa, referen@;
          |SI FSalida = 0;
               |DDEFECTO #referen@;
               |ABRE #referen@;
               #referen@#0 = #0#26;
               |LEE 000#referen@.=;
               |PINTA 1102, "³Art.Auto S/N:                        ³";
               |PINTA #referen@#1;
               |PINTA #referen@#2;
               |CIERRA #referen@;
               |DESCARGA_DEF #referen@;
          |FINSI;
     |FINSI;
     |HAZ EsGuillen;
     |SI FSalida = 0;
          |DDEF aAlfa;
          aAlfa = aAlfa + "guillm02";
          |CARGA_DEF aAlfa, referen@;
          |SI FSalida = 0;
               |DDEFECTO #referen@;
               |ABRE #referen@;
               #referen@#0 = #0#26;
               |LEE 000#referen@.=;
               |PINTA 1102, "³Art.Auto S/N:                        ³";
               |PINTA #referen@#1;
               |PINTA #referen@#2;
               |CIERRA #referen@;
               |DESCARGA_DEF #referen@;
          |FINSI;
     |FINSI;
     |HAZ EsTaller;
     |SI FSalida = 0;
          |C_V #0#48, 1, "S"; |C_V #0#50, 1, "S";
          |PINTA 1102, "³Exporta Garantia S/N:     Seccion    ³";
     |FINSI;
     |HAZ EsQDClor;
     |SI FSalida = 0;
          |C_V #0#22, 1, "S";
          |PINTA 1203, " Boletin Analisis      ";
          |PINTA 1227, "             ";
          aAlfa = #0#22; |QBF aAlfa;
          |SI aAlfa = ""; #0#22 = "boletin"; |FINSI;
     |FINSI;
|FPRC;

|PROCESO Interna; |TIPO 0;
     |SI #0Campo = "S";
          #0#28 = "N"; |PINTA #0#28; |C_M #0#28,1,"N";
          #0#30 = "S"; |PINTA #0#30; |C_M #0#30,1,"N";
     |SINO;
          |C_M #0#28,1,"S";
          |C_M #0#30,1,"S";
     |FINSI;
/*************
     |SI #0Campo = "S";
          |PUSHV 0501 2380;
          |BLANCO 0909 1379;
          |CUADRO 0909 1379;
          |ATRI R; |PINTA 0913, " Opciones Serie Interna "; |ATRI 0;
          |PINTA 1012, "El albar n de ventas generar  movimientos de almac‚n S/N.......:";
          |PINTA 1112, "El pedido de venta reservar  stock en el almac‚n de ventas S/N.:";
          |PINTA 1212, "El pedido de venta reservar  stock en el almac‚n de compras S/N:";
          |C_V #0#44, 1, "S"; |PINTA #0#44;
          |C_V #0#45, 1, "S"; |PINTA #0#45;
          |C_V #0#46, 1, "S"; |PINTA #0#46;
        |ET E1;
          |ENCAMPO #44#0;
          |SI FSalida ! 0; |Y FSalida ! 3; |VETE Sal; |FINSI;
        |ET E2;
          |ENCAMPO #45#0;
          |SI FSalida = 2; |VETE E1; |FINSI;
          |SI FSalida ! 0; |Y FSalida ! 3; |VETE Sal; |FINSI;
          |ENCAMPO #46#0;
          |SI FSalida = 2; |VETE E2; |FINSI;
        |ET Sal;
          |POPV;
     |FINSI;
*/
     |C_V #0#44, 1, "N";
     |C_V #0#45, 1, "N";
     |C_V #0#46, 1, "N";
|FPRC;

|PROCESO CheqDocu;
     aValor1 = "025agifa104";
     aValor2 = "050agifa077";
     aValor3 = "046agifa036";
     aValor4 = "052agifa010";
     aValor5 = "049agifa134";
     aValor6 = "048agifa084";
     aValor7 = "048agifa146";
     aValor8 = "002agist001";
     aValor9 = "002dsm00056";
     aValor10 = "004dsm00043";
     aValor11 = "002dsm00054";
     aValor12 = "025agifa081";
     aValor13 = "050dsm00138";
     aValor14 = "050agifa077";
     aValor15 = "066agifa079";
     aValor16 = "020agifa090";
     aValor17 = "";

     nError = 0;
     IaValor = aValor1<-;
     |PARA; |SI; |HACIENDO;
          aAlfa = aValor; |QBF aAlfa;
          |SI aAlfa = ""; |SAL; |FINSI;
          aSer = aAlfa % 103; nCam = aSer;
          aDef = aAlfa % 4;
          |DDEF aPath;
          aAlfa = aPath + aDef;
          |CARGA_DEF aAlfa, referen@;
          |SI FSalida = 0;
               |DDEFECTO #referen@;
               |ABRE #referen@;
               #referen@#nCam# = #0#26;
               |LEE 000#referen@.];
               |SI FSalida = 0; |Y #referen@#nCam# = #0#26;
                    |MENAV "0000Existen documentos con esta serie...";
                    nError = 1;
               |FINSI;
               |CIERRA #referen@;
               |DESCARGA_DEF #referen@;
          |FINSI;
          |SI nError = 1; |SAL; |FINSI;
          IaValor = IaValor + 1;
     |SIGUE;
|FPRC;

|PROCESO AltaCta;
     aAlfa = #agifa142#151; |QBF aAlfa;
     aAlfa1 = aAlfa + "def/anm00001.mas";
     |CARGA_DEF aAlfa1, CtaAnal@;
     |SI FSalida = 0;
          aAlfa = aAlfa + "fich/" + (("000000" + #agifa142#152) % -106) + "/";
          |PATH_DAT #CtaAnal@#aAlfa#;
          |ABRE #CtaAnal@;
          |DDEFECTO #CtaAnal@;
          #CtaAnal@#0 = #agifa007#43;
          |LEE 000#CtaAnal@.=;
          |SI FSalida ! 0;
               #CtaAnal@#1 = #agifa007#27;
               aAlfa = #agifa142#151; |QBF aAlfa; aAlfa = aAlfa + "pan/";
               |PATH_PAN #CtaAnal@#aAlfa#;
               |PUSHV 0501 2380;
               |PINPA #0#CtaAnal@;
               |PINDA #0#CtaAnal@;
               |CONFI "0000SConfirma alta (S/N).:";
               |SI FSalida = 0;
                    |GRABA 020#CtaAnal@.b;
                    |ENDATOS #1#CtaAnal@;
                    |SI FSalida = 0;
                         |GRABA 020#CtaAnal@.a;
                    |SINO;
                         |BORRA 020#CtaAnal@.c;
                         |ERROR;
                    |FINSI;
               |SINO;
                    |ERROR;
               |FINSI;
               |POPV;
          |FINSI;
          |CIERRA #CtaAnal@;
          |DESCARGA_DEF #CtaAnal@;
     |FINSI;
|FPRC;

|PROCESO SerModulo; |TIPO 0;
     |SI FSalida = 0; |O FSalida = 5;
          |HAZ EsVigor;
          |SI FSalida = 0;
               eaSerie = #0#26;
               |SUB_EJECUTA_NP "vigm0008";
               |SI eaSerie = "";
                    |ERROR; |PTEC 807;
               |SINO;
                    |PTEC 802;
               |FINSI;
          |FINSI;

          |HAZ EsRavenida;
          |SI FSalida = 0;
               eaSerie = #0#26;
               |SUB_EJECUTA_NP "ravem003";
               |SI eaSerie = "";
                    |ERROR; |PTEC 807;
               |SINO;
                    |PTEC 802;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;
